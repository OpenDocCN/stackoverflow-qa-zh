# StackOverflow 问答 000716000-000716999

# html - 如何使 HTML 表格列尽可能紧密地挤压？（或者，尽可能地增长？）

> ID：716005
> 
> 赞同：6
> 
> 时间：2009-04-03T22:52:31.370
> 
> 标签：html, css

我有一张这样的桌子：

```
<table border=1 style="width: 100%">
 <tbody>
    <tr>
      <td>
        squish this one
      </td>
      <td>
        expand this one
      </td>
    </tr>
  </tbody>
</table> 
```

我希望左栏尽可能窄，右栏占据屏幕的其余部分。这可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T22:55:34.700

```
<table border=1 style="width: 100%">
<tbody>
    <tr>
      <td width="1">
        squish this one
      </td>
      <td width="*">
        expand this one
      </td>
    </tr>
  </tbody>
</table> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T22:54:36.263

也给出第二列`style="width:100%"`。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-03T22:55:29.660

“尽可能窄”是零宽度或一个像素。您可以使用 width=0 或 1px 来实现。你的意思是不同的吗？

# python - OptionParser - 支持命令行末尾的任何选项

> ID：716006
> 
> 赞同：5
> 
> 时间：2009-04-03T22:52:46.267
> 
> 标签：python, optparse

我正在编写一个应该在远程服务器上执行命令的小程序（假设是一个相当愚蠢的包装器`ssh [hostname] [command]`）。

我想这样执行它：

```
./floep [命令]
```

但是，我需要不时传递某些命令行：

```
./floep -v [命令]
```

所以我决定为此使用 optparse.OptionParser 。问题是，我有时命令也有参数，如果我这样做可以正常工作：

```
./floep -v "uname -a"
```

但我也希望它在我使用时起作用：

```
./floep -v uname -a
```

这个想法是，一旦我遇到第一个非选项参数，之后的所有内容都应该成为我命令的一部分。

然而，这给了我：

```
用法：floep [选项]

浮动：错误：没有这样的选项：-a
```

OptionParser 是否支持这种语法？如果是这样：如何？如果不是：解决此问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-03T23:33:45.123

尝试使用[`disable_interspersed_args()`](http://docs.python.org/library/optparse.html#other-methods)

```
#!/usr/bin/env python
from optparse import OptionParser

parser = OptionParser()
parser.disable_interspersed_args()
parser.add_option("-v", action="store_true", dest="verbose")
(options, args) = parser.parse_args()

print "Options: %s args: %s" % (options, args) 
```

运行时：

```
$ ./options.py foo -v bar
选项：{'verbose': None} 参数：['foo', '-v', 'bar']
$ ./options.py -v foo bar
选项：{'verbose': True} 参数：['foo', 'bar']
$ ./options.py foo -a bar
选项：{'verbose': None} 参数：['foo', '-a', 'bar']

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T23:29:02.077

OptionParser 实例实际上可以在复杂情况的解析操作期间进行操作。但是，在这种情况下，我相信您描述的场景是开箱即用的（如果属实，这将是个好消息！这种情况多久发生一次？？）。请参阅文档中的此部分：[查询和操作您的选项解析器](http://docs.python.org/library/optparse.html#querying-and-manipulating-your-option-parser)。

引用上面的链接：

> disable_interspersed_args()
> 
> 将解析设置为在第一个非选项上停止。如果您有一个命令处理器运行另一个具有自己的选项的命令，并且您希望确保这些选项不会混淆，请使用此选项。例如，每个命令可能有一组不同的选项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T23:43:06.880

```
from optparse import OptionParser
import subprocess
import os
import sys

parser = OptionParser()
parser.add_option("-q", "--quiet",
                  action="store_true", dest="quiet", default=False,
                  help="don't print output")
parser.add_option("-s", "--signal",
                  action="store_true", dest="signal", default=False,
                  help="signal end of program and return code")

parser.disable_interspersed_args()
(options, command) = parser.parse_args()

if not command:
    parser.print_help()
    sys.exit(1)

if options.quiet:
    ret = subprocess.call(command, stdout=open(os.devnull, 'w'), 
                             stderr=subprocess.STDOUT)
else:
    ret = subprocess.call(command)

if options.signal:
    print "END OF PROGRAM!!! Code: %d" % ret 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-03T23:03:02.280

您可以使用这样的 bash 脚本：

```
#!/bin/bash
while [ "-" == "${1:0:1}" ] ; do
  if [ "-v" == "${1}" ] ; then
    # do something
    echo "-v"
  elif [ "-s" == "${1}" ] ; then
    # do something
    echo "-s"
  fi
  shift
done
${@} 
```

${@} 为您提供了班次调用未使用的命令行的其余部分。要使用 ssh，您只需将行从 ${@} 更改为 ssh ${user}@${host} ${@}

test.sh echo bla
bla

test.sh -v echo bla
-v
bla

test.sh -v -s echo bla
-v
-s
bla

# python - 为什么python中设置的环境变量不能持久化？

> ID：716011
> 
> 赞同：59
> 
> 时间：2009-04-03T22:55:29.707
> 
> 标签：python, persistence, environment-variables

我希望通过在我将执行一些模拟代码的任何目录中运行脚本来编写一个 python 脚本来创建一些适当的环境变量，并且我已经读到我无法编写脚本来使这些环境变量持续存在mac 操作系统终端。所以有两件事：

这是真的？

和

看起来这将是一件有用的事情；为什么一般来说不可能？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-04-03T23:08:47.383

你不能从 python 中做到这一点，但一些聪明的 bash 技巧可以做类似的事情。基本推理是这样的：环境变量存在于每个进程的内存空间中。当使用 fork() 创建一个新进程时，它会继承其父进程的环境变量。当您在 shell（例如 bash）中设置环境变量时，如下所示：

```
export VAR="foo" 
```

您正在做的是告诉 bash 将其进程空间中的变量 VAR 设置为“foo”。当你运行一个程序时，bash 使用 fork() 然后 exec() 来运行程序，所以你从 bash 运行的任何东西都会继承 bash 环境变量。

现在，假设您要创建一个 bash 命令，该命令使用当前目录中名为“.data”的文件中的内容设置一些环境变量 DATA。首先，您需要有一个命令来从文件中获取数据：

```
cat .data 
```

打印数据。现在，我们要创建一个 bash 命令来在环境变量中设置该数据：

```
export DATA=`cat .data` 
```

该命令获取 .data 的内容并将其放入环境变量 DATA 中。现在，如果你把它放在一个别名命令中，你就有一个 bash 命令来设置你的环境变量：

```
alias set-data="export DATA=`cat .data`" 
```

您可以将该别名命令放在主目录中的 .bashrc 或 .bash_profile 文件中，以使该命令在您启动的任何新 bash shell 中可用。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-04-04T00:38:24.827

一种解决方法是输出`export`命令，并让父 shell 对此进行评估。

`thescript.py`：

```
import pipes
import random
r = random.randint(1,100)
print("export BLAHBLAH=%s" % (pipes.quote(str(r)))) 
```

..和 bash 别名（在大多数 shell 中都可以这样做。甚至 tcsh！）：

```
alias setblahblahenv="eval $(python thescript.py)" 
```

用法：

```
$ echo $BLAHBLAH

$ setblahblahenv
$ echo $BLAHBLAH
72 
```

您可以输出任意 shell 代码，包括多个命令，例如：

```
export BLAHBLAH=23 SECONDENVVAR='something else' && echo 'everything worked' 
```

请记住要小心转义任何动态创建的输出（该`pipes.quote`模块对此很有用）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-03T23:00:56.030

如果您在 python 脚本（或任何其他脚本或程序）中设置环境变量，它不会影响父 shell。

编辑说明：所以你的问题的答案是肯定的，这是真的。但是，您可以从 shell 脚本中导出并使用点调用来获取它

在 fooexport.sh

```
export FOO="bar" 
```

在命令提示符下

```
$ . ./fooexport.sh
$ echo $FOO
bar 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-03T22:59:09.467

这通常是不可能的。为 python 创建的新进程不能影响其父进程的环境。父母也不能影响孩子，但父母可以将孩子的环境设置为新流程创建的一部分。

也许您可以将它们设置为`.bashrc`，`.profile`或 MacOS 中等效的“登录时运行”或“在每个新终端会话上运行”脚本。

您还可以让 python 使用所需的环境启动模拟程序。（使用`env`subprocess.Popen 的参数（[http://docs.python.org/library/subprocess.html](http://docs.python.org/library/subprocess.html)））

```
import subprocess, os
os.chdir('/home/you/desired/directory')
subprocess.Popen(['desired_program_cmd', 'args', ...], env=dict(SOMEVAR='a_value') ) 
```

或者你可以让 python 将这样的 shell 脚本写到一个带有`.sh`扩展名的文件中：

```
export SOMEVAR=a_value
cd /home/you/desired/directory
./desired_program_cmd 
```

然后`chmod +x`它并从任何地方运行它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-03T23:22:30.783

当我发现自己处于类似情况时，我喜欢做的是在 shell 脚本中使用 /usr/bin/env 来“包装”我的命令行：

```
#!/bin/bash

/usr/bin/env NAME1="VALUE1" NAME2="VALUE2" ${*} 
```

所以让我们称这个脚本为“myappenv”。我把它放在我的 $PATH 中的 $HOME/bin 目录中。

现在我可以使用该环境调用任何命令，只需在前面加上“myappenv”即可：

```
myappenv dosometask -xyz 
```

其他发布的解决方案也可以，但这是我个人的偏好。一个优点是环境是瞬态的，所以如果我在 shell 中工作，那么只有我调用的命令会受到改变的环境的影响。

**基于新评论的修改版本**

```
#!/bin/bash

/usr/bin/env G4WORKDIR=$PWD ${*} 
```

您也可以将这一切都包装在别名中。我更喜欢包装脚本方法，因为我也倾向于在其中准备其他环境，这使我更容易维护。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-09-13T08:39:56.013

正如 Benson 所回答的那样，但最好的解决方法是创建一个简单的 bash 函数来保留参数：

```
upsert-env-var (){ eval $(python upsert_env_var.py $*); } 
```

您可以使用参数在 python 脚本中做任何您想做的事情。要简单地添加变量，请使用以下内容：

```
var = sys.argv[1]
val = sys.argv[2]
if os.environ.get(var, None):
    print "export %s=%s:%s" % (var, val, os.environ[var])
else:
    print "export %s=%s" % (var, val) 
```

用法：

```
upsert-env-var VAR VAL 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-05-10T10:40:11.427

正如其他人指出的那样，这不起作用的原因是环境变量存在于每个进程的内存空间中，因此在 Python 进程退出时会死掉。

他们指出，解决这个问题的方法是定义一个别名`.bashrc`来做你想做的事情，比如：

```
alias export_my_program="export MY_VAR=`my_program`" 
```

但是，还有另一种（有点骇人听闻的）方法不需要您修改`.bachrc`，也不需要您拥有（或在别名中指定它的完整路径）`my_program`。`$PATH`这个想法是，如果程序被正常调用，则在 Python 中运行程序`./my_program`（`source my_program`（`source`在脚本上使用不会产生新进程，因此不会杀死其中创建的环境变量。）您可以按以下方式执行此操作：

`my_program.py`：

```
#!/usr/bin/env python3

_UNUSED_VAR=0
_UNUSED_VAR=0 \
<< _UNUSED_VAR
#=======================
# Bash code starts here
#=======================
'''
_UNUSED_VAR
export MY_VAR=`$(dirname $0)/my_program.py`
echo $MY_VAR
return
'''

#=========================
# Python code starts here
#=========================
print('Hello environment!') 
```

在 Python 中运行它`./my_program.py`（

在 bash ( `source my_program.py`) 中获取此信息，heredoc ( `<< _UNUSED_VAR`) 是一种用于“注释掉”第一个三引号的 hack，否则会出现语法错误。脚本在到达第二个三引号之前返回，避免了另一个语法错误。将Python`export`中运行的结果从正确的目录（由 给出）分配给环境变量。在命令行上打印结果。`my_program.py``$(dirname $0)``MY_VAR``echo $MY_VAR`

示例用法：

```
$ source my_program.py
Hello environment!
$ echo $MY_VAR
Hello environment! 
```

但是，脚本仍然会执行它之前所做的一切，除了导出环境变量（如果正常运行）：

```
$ ./my_program.py
Hello environment!
$ echo $MY_VAR
                                <-- Empty line 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-04-20T18:18:11.797

正如其他作者所指出的，当 Python 进程退出时，内存会被丢弃。但是在python过程中，可以编辑运行环境。例如：

```
>>> os.environ["foo"] = "bar"
>>> import subprocess
>>> subprocess.call(["printenv", "foo"])
bar
0
>>> os.environ["foo"] = "foo"
>>> subprocess.call(["printenv", "foo"])
foo
0 
```

# css - 最常遇到的 CSS 错误/问题

> ID：716013
> 
> 赞同：5
> 
> 时间：2009-04-03T22:57:19.360
> 
> 标签：css

请列出您遇到的 CSS 错误/问题以及如何解决它们或指向解决它们的站点的链接。

请投票选出您认为人们会遇到最多的错误。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-03T23:00:27.607

[Internet Explorer 盒子模型](http://en.wikipedia.org/wiki/Internet_Explorer_box_model_bug)错误。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-03T23:12:48.340

[双倍保证金错误](http://haslayout.net/css/doublemargin) (< IE7)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-03T23:12:22.833

IE6 不支持最小高度。

您可以使用条件注释来设置高度，IE6 将其视为最小高度。

或者，您可以使用 IE6 无法读取的 CSS 中的子选择器来恢复 height: auto 在除 IE6 之外的所有内容上。

```
.myDiv {
height: 100px;
min-height: 100px;
}

.parentElement > .myDiv {
height: auto;
} 
```

使用这样的技术可能会有问题，但所有流行的现代浏览器都以这样一种方式工作，它是一种有效的技术。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-04T00:05:58.977

您将遇到的几乎所有 HTML/CSS 错误都会出现在 Internet Explorer 中。IE6 有很多，IE7 少一点，而 IE8 则少得多。

有一个适当的[文档](http://www.w3.org/QA/2002/04/valid-dtd-list.html)类型是必须的。没有它，页面将以怪异模式呈现，尤其是对于糟糕的 IE。它或多或少地像 IE5 那样呈现页面，带有[框模型错误](http://en.wikipedia.org/wiki/Internet_Explorer_box_model_bug)和所有内容。

以下是一些常见的 IE 错误：

*   使每个元素的内容至少高一个字符。（可以使用溢出修复。）

*   扩展每个元素以包含它的子元素，即使它是浮动元素。（可以使用溢出修复。）

*   未定位但具有布局的元素会获得 z-index，尽管它们不应该。（可以通过使其定位并给它一个特定的 z-index 来修复它，并对需要它的同一级别上的所有元素执行相同的操作。）

*   边距未正确折叠。（如果可能，请使用填充。）

*   消失的浮动元素。（给他们一个特定的大小。）

*   [更多...](http://www.positioniseverything.net/explorer.html)（包括修复建议）

大多数错误最稳定的修复方法是重新排列布局以避免它们，或者指定更严格的样式（例如特定大小）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-30T06:35:39.530

这里列出了所有 IE 已知错误以及如何修复它的链接： [PositionsEverything.net](http://www.positioniseverything.net/explorer.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-04T00:21:10.080

为 IE6 再写一个： [DropDownList 和 DIV 重叠问题](http://www.codeproject.com/KB/dotnet/Overlapping.aspx)，带有屏幕截图。文章中提到了 iframe 修复。我不确定是否存在在所有浏览器中具有一致的错误行为的 CSS 错误。

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2009-04-03T23:18:36.453

有传言说 IE8 将不允许您将元素与 居中`text-align: center;`，仅允许元素本身内的文本居中。相反，您必须使用`margin: 0 auto;`. 如果情况确实如此，几乎所有的互联网都会崩溃。

# svn - 如何降级 SVN 工作副本的版本？

> ID：716021
> 
> 赞同：37
> 
> 时间：2009-04-03T22:59:31.990
> 
> 标签：svn

SVN 目录很容易在计算机之间移动，但这可能会导致工作副本和安装的 svn 客户端之间的版本不匹配，从而导致错误

```
svn: This client is too old to work with working copy '.';  
  please get a newer Subversion client 
```

在一个完美的世界中，可以安装更新版本的 SVN 客户端，但是当这不可能或不方便时，能够将工作副本降级到安装的客户端版本会很好——尤其是当你知道没有正在使用更高版本的功能。

仅当有问题的工作副本没有任何更改并且不会太大而造成不便时，才可以使用旧客户端签出新的工作副本。

可以想象的场景类似于：Joe 向您发送一个包含大量嵌套目录（以及相关的版本化 .svn 文件夹）的大型工作副本。你工作。当你尝试提交它时，svn 会告诉你你的客户端太旧了。没有必要把它寄回给乔。不需要检查新的工作副本，并且在任何情况下合并更改都是不方便的。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-04-03T23:02:00.753

简短的回答：这不是微不足道的。

幸运的是，开发人员预见到了这个问题并在一个常见问题解答中处理了它： [http](http://subversion.apache.org/faq.html#working-copy-format-change)
://subversion.apache.org/faq.html#working-copy-format-change 下载并使用他们的脚本的结果是： [http ://svn.apache.org/repos/asf/subversion/trunk/tools/client-side/change-svn-wc-format.py](http://svn.apache.org/repos/asf/subversion/trunk/tools/client-side/change-svn-wc-format.py)

请注意，该脚本只需要客户端的主要版本号，因此如果您的客户端版本为 1.4.4，则命令为：

```
python change-svn-wc-format.py <WC_PATH> 1.4 [...other options...] 
```

**更新：**

上述脚本仅适用于降级 1.6 及以下版本。从 1.7+ 降级显然是不可能的。来源的注释：

```
# Downgrading from format 11 (1.7) to format 10 (1.6) is not possible,
# because 11 does not use has-props and cachable-props (but 10 does).
# Naively downgrading in that situation causes properties to disappear
# from the wc.
#
# Downgrading from the 1.7 SQLite-based format to format 10 is not
# implemented. 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-28T17:59:58.133

我刚刚删除了 1.7 创建的项目文件中的 .svn 文件夹，并使用 1.6 重新添加了解决方案。这对我有用，希望它可以帮助其他人。

# c# - Http Post 请求消息正文中的 C# Xml

> ID：716024
> 
> 赞同：12
> 
> 时间：2009-04-03T23:00:05.720
> 
> 标签：c#, xml, httpwebrequest, httpwebresponse

我正在寻找一个示例，说明如何在 C# 中将 xml 文档放入 http 请求的消息正文中，然后解析响应。我已经阅读了文档，但如果有可用的示例，我只想看一个示例。有人有例子吗？

谢谢

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-06-18T18:46:15.823

```
private static string WebRequestPostData(string url, string postData)
{
    System.Net.WebRequest req = System.Net.WebRequest.Create(url);

    req.ContentType = "text/xml";
    req.Method = "POST";

    byte[] bytes = System.Text.Encoding.ASCII.GetBytes(postData);
    req.ContentLength = bytes.Length;

    using (Stream os = req.GetRequestStream())
    {
        os.Write(bytes, 0, bytes.Length);
    }

    using (System.Net.WebResponse resp = req.GetResponse())
    {
        if (resp == null) return null;

        using (System.IO.StreamReader sr = new System.IO.StreamReader(resp.GetResponseStream()))
        {
            return sr.ReadToEnd().Trim();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-03T23:27:07.213

你应该使用这个`WebRequest`类。

这里有一个带注释的示例可用于发送数据：

[http://msdn.microsoft.com/en-us/library/debx8sh9.aspx](http://msdn.microsoft.com/en-us/library/debx8sh9.aspx)

# c# - 客户端用户确认后调用 ASPX 服务器端函数？

> ID：716027
> 
> 赞同：0
> 
> 时间：2009-04-03T23:01:12.347
> 
> 标签：c#, javascript, asp.net

也许我正在使用错误的关键字进行搜索，但我找不到解决方案。

我有一个 ASPX 页面，`<asp:Repeater>`我想在其中插入一个按钮（每个项目），它将：

1.  询问（JS“确认”）用户是否真的想继续，然后
2.  调用页面类上的方法，传入该项目的 ID (Guid)。

我可以做 1 或 2，但不知道如何从 JavaScript 回调到页面方法。

我尝试在 ScriptManager 中打开 EnablePageMethods，但这似乎没有达到我的预期——调用`PageMethods.Blah(...)`似乎没有*任何*效果。

有现成的例子吗？事实上，每个条目的确认字符串都是相同的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T23:13:15.080

[您可以使用按钮的OnClientClick](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.button.onclientclick.aspx)属性执行确认：

```
<asp:Button runat="server" ID="DeleteButton" CommandName="Delete"
 Text="Delete" OnClientClick="return confirm('Are you sure ?');" /> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T23:14:25.653

这是你需要做的：

1.  确保您的按钮具有 runat="server"
2.  在该按钮中，添加 onClientClick="javascript:return confirm('Are you sure?');"
3.  甚至从按钮的 onClick 调用您的服务器端代码

    ```
    <asp:Button id="Button1" Text="Do Stuff" OnClick="YOUR SERVER SIDE METHOD"    
      onClientClick="javascript: return confirm('Are you sure?');" runat="server"/> 
    ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T23:22:26.447

```
<asp:Repeater ID="YourRepeater" runat="server">
    <ItemTemplate>
        <asp:Button ID="btnDelete" runat="server" OnClientClick="javascript:return confirm('Are you sure ?');" OnClick="btnDelete_OnClick" />
    </ItemTemplate>
</asp:Repeater> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T23:53:40.363

这是您需要做的：

1.  启用脚本管理器（你做了）

2.  创建一个 Web 服务，它将处理您代码中的回调：

    ```
    [WebService]
    [ScriptService]
    public class MyWebService : System.Web.Services.WebService 
    {
        [WebMethod]
        public int SomeCallbackFunction() 
        { .... }
    } 
    ```

3.  将指向 Web 服务代理的链接放入脚本管理器（由 [ScriptService] 生成）：

    ```
    <asp:ScriptManager runat="server" ID="scriptManagerId">
        <Services>
            <asp:ServiceReference  Path="WebService.asmx" />
        </Services>
    </asp:ScriptManager> 
    ```

4.  在您的 JavaScript 中，您将能够使用回调：

    ```
    function Blablabla() 
    {
        MyWebService.SomeCallbackFunction()
    } 
    ```

这只是一个大概的想法，当然，这段代码可能还需要一些润色。[您可以在此处](http://msdn.microsoft.com/en-us/library/bb398995.aspx)查找更多示例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-10T14:58:36.430

最终我决定在客户端做。我省略了**OnClick**，但将**onclientclick**属性设置为确认函数，然后使用**添加**参数重定向到页面，该参数是相关表行的 ID。

为什么？好吧，我的数据源是从几个表创建的只读列表，因此 (IIUC) 它是在处理按钮单击*之前创建的。*因此，在没有用户刚刚添加的数据的情况下刷新了页面。

相反，**add=***ID* 参数会导致添加成功（或错误）消息并突出显示新插入的行。不利的一面是，如果用户要刷新页面，当然，但在这种情况下，它在 IFRAME 内，所以我认为这不太可能。

那谢谢啦。你回答了我的问题，我只是没有意识到我的问题不是针对我想去的地方。

顺便说一句，我让他们在数据库中添加一行。确认的原因是它会在服务器上产生长达一个小时的处理时间！

# opengl - 寻找 Linux/Windows 可部署的 OpenGL 窗口和操作系统库

> ID：716035
> 
> 赞同：0
> 
> 时间：2009-04-03T23:03:56.787
> 
> 标签：opengl, cross-compiling

我想在 Linux 中建立一个 OpenGL 开发环境，我也可以为 Windows 交叉编译。看起来 GLFW + OpenGL 会给我我需要的东西。

我尝试为 Ubuntu 8.10 安装 GLFW 开发包，但我遇到了依赖问题。不过，我可能会坚持下去。

有人在 Linux 上使用过 GLFW 吗？有没有人尝试过 Windows 的交叉编译？是否有另一种使用 OpenGL 处理窗口可能更好的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T23:19:00.073

我第二个 SDL。我也建议使用 Glee 或 GLEW 进行扩展管理

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T23:17:18.393

我会尝试 SDL，它非常易于使用。对于交叉编译，我会使用 MinGW 或 Cygwin。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T23:18:30.667

我建议您结合使用[Qt 和 OpenGL](http://doc.trolltech.com/4.5/qt-embedded-opengl.html)来满足您的窗口化需求。从 4.5 开始，Qt 现在是 LGPL，并且开箱即用地支持 Linux、Windows 和 Mac。

# sharepoint-2007 - 域内的 Sharepoint 数据库访问

> ID：716043
> 
> 赞同：1
> 
> 时间：2009-04-03T23:08:22.843
> 
> 标签：sharepoint-2007, database-connection

我在一个域中有两台服务器。Web 服务器和数据库服务器。我有许多标准的 .net 网站可以毫无问题地访问 SQL Server，每个数据库都使用 SQL 用户名/密码组合。

Sharepoint 将访问配置为 Integrated Security=True

当我运行配置向导时，我“简要”地看到了管理员顶部站点。短暂浏览后，我失去了连接。[我什么都没碰/改变！！！！]

我现在得到“无法连接到配置数据库”。

问题似乎很明显是对数据库的访问权限之一，但我看不到它。

IIS 网站使用 Sharepoint AppPool，后者又使用成功创建 SharePoint_Config 数据库和 & 内容数据库的域帐户。他们显然继续使用该帐户。

事件查看器显示多个实例：“无法连接到 [数据库计算机] 上的数据库 SharePoint_Config。检查数据库连接信息并确保数据库服务器正在运行..”

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-04T02:03:54.607

这发生在：

*   SQL 数据库或服务未联机/未运行。
*   Internet 信息服务 (IIS) 配置为在 IIS 5.0 隔离模式下运行。
*   应用程序池使用的帐户没有 SQL Server 数据库所需的权限。
*   Windows SharePoint Services 服务器和 Microsoft SQL Server 服务器之间的网络连接已丢失。

检查所有这些，如果所有这些都设置好了，请检查您的 sql server。确保您的配置数据库未标记为“可疑”或其他内容未关闭。尝试重置您的 SQL 服务。

更改应用程序池帐户时，我也发生过这种情况。即使应用程序池在线，有时也可以回收它。或者，确认应用程序池帐户：

1.  打开服务器管理器。
2.  单击角色。
3.  选择 Web 服务器 (IIS)
4.  选择 IIS。
5.  在“连接”面板中打开服务器。
6.  选择应用程序池。
7.  对于应用程序池中的每个项目，单击一次，然后选择高级设置。
8.  在 Process Model, Identity 下，更改它，选择“Custom Account”。
9.  输入具有大量权限的帐户的帐户和密码。我使用了系统管理员。
10.  重新启动 Web 服务器。

另外，32位还是64位？确保 IIS 以正确的模式运行，有时额外的软件安装可能会改变一些事情：

首先，修复 IIS：

```
\inetpub\AdminScripts\cscript.exe adsutil.vbs set W3SVC/AppPools/Enable32BitAppOnWin64 False 
```

其次，重新注册 .Net isapi 过滤器：

```
\windows\microsoft.net\Framework64\v2.0.50727\aspnet_reg
iis.exe -i 
```

如果以上都不是，是否有任何 DNS 或 NETBIOS 更改？这也是一个常见的原因。

如果没有其他方法，只需尝试重新启动您的服务器。

# java - JavaDB 连接问题；未找到数据库

> ID：716048
> 
> 赞同：4
> 
> 时间：2009-04-03T23:09:20.500
> 
> 标签：java, derby, javadb

我遇到了 Java DB 的问题，我只是不知道如何解决。我正在创建一个数据库并使用 Java DB 的本机 JDBC 驱动程序连接到它。如果我物理地重新定位该数据库并尝试使用它的新路径连接到它，我总是会收到 XJ004 错误：

```
ERROR XJ004: Database 'blahblah' not found. 
```

我确定我使用了正确的连接字符串。数据库是否有可能以某种方式损坏？或者数据库中的数据库路径是否存在某种编码，这样如果您重新定位 Java 数据库，它会感到困惑？

我在这里真的很茫然。：（ 请帮忙！

吉姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T23:39:10.460

您是否验证了当主机上没有侦听器时也不会使用此错误消息......并且在重定位之前您是否在本地计算机上使用了 JavaDB？出于安全原因，许多数据库系统（我对 JavaDB 不太熟悉）都设置为仅允许来自本地主机的连接。例如，在 PostgreSQL 上，您必须允许 TCP 连接并反弹守护程序以获取远程连接。

无论如何...既然问题在您远程时就开始了，请先查找与该问题相关的问题！（如果你可以在远程机器上运行你的应用程序，那行得通吗？）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-04T00:48:29.187

必须有一个名为`derby.log`某处的文件。检查那里的错误。如果不够详细，请尝试设置`derby.stream.error.logSeverityLevel`为较低的值。有关详细信息，请参阅[手册](http://db.apache.org/derby/docs/10.4/tuning/rtunproper33027.html)。

# asp.net - IIS7 中的“经典”和“集成”管道模式有什么区别？

> ID：716049
> 
> 赞同：511
> 
> 时间：2009-04-03T23:10:49.420
> 
> 标签：asp.net, asp.net-mvc, iis, iis-7, integrated-pipeline-mode

昨晚我正在部署一个 ASP.NET MVC 应用程序，发现将 IIS7 设置为集成模式进行部署的工作量较少。我的问题是有什么区别？使用其中一种有何影响？

* * *

## 回答 #1

> 赞同：658
> 
> 时间：2009-04-03T23:22:14.153

经典模式（IIS6 及以下的唯一模式）是 IIS 仅直接与 ISAPI 扩展和 ISAPI 过滤器一起使用的模式。实际上，在这种模式下，ASP.NET 只是一个 ISAPI 扩展（aspnet_isapi.dll）和一个 ISAPI 过滤器（aspnet_filter.dll）。IIS 只是将 ASP.NET 视为在 ISAPI 中实现的外部插件，并像黑盒子一样使用它（并且仅当它需要向 ASP.NET 发出请求时）。在这种模式下，ASP.NET 与 PHP 或其他 IIS 技术没有太大区别。

另一方面，集成模式是 IIS7 中的一种新模式，其中 IIS 管道与 ASP.NET 请求管道紧密集成（即完全相同）。ASP.NET 可以看到它想要处理的每个请求并在此过程中进行操作。ASP.NET 不再被视为外部插件。它完全混合并集成在 IIS 中。在这种模式下，ASP.NET`HttpModule`基本上具有与 ISAPI 过滤器几乎一样的功能，并且 ASP.NET`HttpHandler`可以具有与 ISAPI 扩展几乎相同的功能。在这种模式下，ASP.NET 基本上是 IIS 的一部分。

* * *

## 回答 #2

> 赞同：122
> 
> 时间：2012-12-28T09:42:43.847

> **集成应用池模式**
> 
> 当应用程序池处于集成模式时，您可以利用 IIS 和 ASP.NET 的集成请求处理体系结构。当应用程序池中的工作进程接收到请求时，该请求会通过一个有序的事件列表。每个事件调用必要的本地和托管模块来处理请求的一部分并生成响应。
> 
> 在集成模式下运行应用程序池有几个好处。首先将 IIS 和 ASP.NET 的请求处理模型集成到一个统一的进程模型中。此模型消除了以前在 IIS 和 ASP.NET 中重复的步骤，例如身份验证。此外，集成模式使托管功能可用于所有内容类型。
> 
> **经典应用池模式**
> 
> 当应用程序池处于经典模式时，IIS 7.0 会像在 IIS 6.0 工作进程隔离模式中一样处理请求。ASP.NET 请求首先通过 IIS 中的本机处理步骤，然后被路由到 Aspnet_isapi.dll 以在托管运行时中处理托管代码。最后，请求通过 IIS 路由回以发送响应。
> 
> IIS 和 ASP.NET 请求处理模型的这种分离导致一些处理步骤的重复，例如身份验证和授权。此外，托管代码功能（例如表单身份验证）仅适用于 ASP.NET 应用程序或您已为其脚本映射所有请求以由 aspnet_isapi.dll 处理的应用程序。
> 
> 在将生产环境升级到 IIS 7.0 并将应用程序分配到集成模式下的应用程序池之前，请务必在集成模式下测试现有应用程序的兼容性。如果应用程序无法在集成模式下工作，您应该只将应用程序添加到经典模式下的应用程序池中。例如，您的应用程序可能依赖于从 IIS 传递到托管运行时的身份验证令牌，并且由于 IIS 7.0 中的新体系结构，该过程会破坏您的应用程序。

摘自：[IIS7 中的 DefaultAppPool 和 Classic .NET AppPool 有什么区别？](https://stackoverflow.com/a/863588/63011)

原文出处：[IIS架构简介](http://www.iis.net/learn/get-started/introduction-to-iis/introduction-to-iis-architecture)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2015-09-25T15:25:56.950

> **IIS 6.0 和以前的版本：**

ASP.NET 通过 ISAPI 扩展、C API（基于 C 编程语言的 API）与 IIS 集成，并公开了自己的应用程序和请求处理模型。

这有效地暴露了两个独立的服务器（请求/响应）管道，一个用于本地 ISAPI 过滤器和扩展组件，另一个用于托管应用程序组件。ASP.NET 组件将完全在 ASP.NET ISAPI 扩展气泡内执行*，并且仅* 适用于在 IIS 脚本映射配置中映射到 ASP.NET 的请求。

对非 ASP.NET 内容类型的请求：图像、文本文件、HTML 页面和无脚本 ASP 页面，由 IIS 或其他 ISAPI 扩展处理，对 ASP.NET 不可见。

**此模型的主要限制是 ASP.NET 模块和自定义 ASP.NET 应用程序代码提供的服务不适用于非 ASP.NET 请求**

**什么是脚本映射？**

脚本映射用于将文件扩展名与请求该文件类型时执行的 ISAPI 处理程序相关联。脚本映射还有一个可选设置，在允许处理请求之前验证与请求关联的物理文件是否存在

一个很好的例子可以是[**`seen here`**](http://www.iis.net/learn/application-frameworks/install-and-configure-php-on-iis/configuring-the-fastcgi-extension-for-iis-60)

> **IIS 7 及更高版本**

IIS 7.0 及更高版本已从头开始重新设计，以提供全新的基于 C++ API 的 ISAPI。

IIS 7.0 及更高版本将 ASP.NET 运行时与 Web 服务器的核心功能集成在一起，提供了一个统一的（单一）请求处理管道，该管道暴露给称为模块 (IHttpModules) 的本机和托管组件

*这意味着 IIS 7 处理到达任何内容类型的请求，`NON ASP.NET Modules / native IIS modules`并`ASP.NET modules`在所有阶段提供请求处理* **这就是非 ASP.NET 内容类型（.html、静态文件）可以由 .NET 模块处理的原因.**

*   您可以构建能够执行所有应用程序内容的新托管模块 ( [**`IHttpModule`**](https://msdn.microsoft.com/en-us/library/system.web.ihttpmodule%28v=vs.110%29.aspx))，并为您的应用程序提供一组增强的请求处理服务。
*   添加新的托管处理程序 ( [**`IHttpHandler`**](https://msdn.microsoft.com/en-us/library/system.web.ihttphandler%28v=vs.110%29.aspx))

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-04-17T16:11:31.190

在经典模式下，IIS 直接工作 h ISAPI 扩展和 ISAPI 过滤器。并使用两条管道，一条用于本机代码，另一条用于托管代码。您可以简单地说，在经典模式下，IIS 7.x 的工作方式与 IIS 6 一样，并且您不会从 IIS 7.x 功能中获得额外的好处。

在集成模式下，IIS 和 ASP.Net 紧密耦合，而不是像经典模式那样仅依赖于 Asp.net 上的两个 DLL。

# c# - C#、Outlook 插件、在 Outlook 中打开网页

> ID：716066
> 
> 赞同：0
> 
> 时间：2009-04-03T23:19:10.323
> 
> 标签：c#, outlook, vsto

我想知道如何使用 C# 以编程方式在 Outlook 2007 中打开网站？

并且仍然保留 ToDo 栏。

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-02-11T15:31:11.307

**选项 A（Outlook 内置浏览器）：**

```
(Office.CommandBarComboBox)this.Application.ActiveExplorer().CommandBars.FindControl(Office.MsoControlType.msoControlComboBox, 1740, missing, missing); 
```

**选项 B（customPanel（保留 todobar））：**

```
Globals.ThisAddIn.CustomTaskPanes.Add(new TaskPanel(), "Browser", explorer); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T08:57:34.140

ricardojferreira 答案中的选项 A 在 Outlook 2007 和 2010 中效果很好。但在 2013 年不起作用。

2013年有没有方便的方法呢？

我知道 MapiFolder 的 WebViewURL 属性，但为了让它正常工作，我需要创建一个专门用于浏览 url 的文件夹。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T04:12:43.347

我不确定，但我敢打赌你可以显示一个 Windows 窗体，对吧？在该表单上放置一个 WebBrowser 控件，一切就绪。

# gps - 通过wap页面轮询GPS位置

> ID：716072
> 
> 赞同：0
> 
> 时间：2009-04-03T23:26:31.693
> 
> 标签：gps, wap

我正在编写一个 Web 驱动的项目，该应用程序的一部分将是由我们的警卫团队执行的数据记录练习。我需要知道的是：有没有办法编写 WAP 页面来轮询手机的 GPS 系统以获取位置，并将其传递到数据库字段之一？我不介意我们是否必须坚持使用特定品牌的手机，例如诺基亚。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-12T02:37:37.210

您可能想看看：[银色 GPS](http://blogs.msdn.com/jbarnes/archive/2008/12/02/silver-gps-complete-demo-code-and-updated-silverlight-project.aspx)

抽象的：

如何使用 .NET Compact Framework、WCF、LINQ、Silverlight、Deep Zoom 和 Virtual Earth 创建端到端移动 GPS 跟踪应用程序。

受最近在 Microsoft.com 网站上发布的真实移动案例研究的启发，本次会议将引导您了解如何使用 .NET Compact Framework、Windows Mobile SDK 和 Compact SQL 创建移动 GPS 跟踪应用程序。

在 Web 主机层，我们将创建一个 Windows Communication Foundation 服务并生成一个 Compact 框架客户端代理，以将 GPS 轨迹发送到主机 Web 服务器 - 最后，可以使用 LINQ、Silverlight、Deep Zoom、和虚拟地球。

包括所有源代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T23:30:38.453

可能不是。

您可以编写一个通过 HTTP 传输坐标的小型 J2ME 应用程序；大多数支持 GPS 的现代手机也支持[JSR179 Location API](http://jcp.org/en/jsr/detail?id=179)，这使得它变得非常简单。

# c# - 哪个 Linux 发行版最适合在虚拟机中开发 Mono 应用程序？

> ID：716077
> 
> 赞同：13
> 
> 时间：2009-04-03T23:27:52.767
> 
> 标签：c#, linux, mono

从那以后我一直是 Windows 用户，现在我需要 Linux 来使用 Mono 创建应用程序。哪个 Linux 发行版最适合我？我将在虚拟机中使用它。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-04-03T23:43:24.040

Mono 主要是在 openSUSE 上编写和测试的。我们发布的软件包是针对 openSUSE 的。事实上，我们发布了一个 openSUSE 的 VMWare 镜像，新版本的 Mono 已全部设置好并准备就绪：

[http://www.go-mono.com/mono-downloads/download.html](http://www.go-mono.com/mono-downloads/download.html)

话虽如此，我们有一个很棒的社区，他们致力于确保 Mono 运行良好，并打包在所有主要发行版上，例如 Fedora 和 Ubuntu。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-03T23:30:28.733

没有任何分布通常比其他任何分布都好。从网上下载发行版的 Live CD，在您的 VM 中运行它们并使用您最喜欢的那个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T23:36:01.653

对于 Mono 开发来说，并不是任何发行版都比其他发行版“更好”，但是由于您使用的是 VM，我会寻找资源使用率低的发行版。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-04T00:53:54.730

简单的答案显然是 OpenSuse，它可以提供快速、轻松且轻松的开发人员体验。但是，如果您不需要最新最好的单声道位并且正在设置网络服务器，您可能希望使用具有更多企业理念的发行版（SLES、RHEL、Ubuntu LTS）。或者，如果你喜欢极简主义的发行版，你可能想试试 gentoo 的内核，它只做你需要的东西。

就我个人而言，我在 OpenSuse 上进行开发是为了拥有最新的工具，但目标是 redhat，因为这是一个与我共事的人都知道和信任的品牌。这不是技术原因，而是政治原因。你的其他虚拟机在运行什么？Mono 甚至可以在 Windows、Mac 和 Solaris 上运行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T23:38:15.737

任何基于 Gnome 的东西都应该对你有用（因为 Gnome 正在转向单声道）。Ubuntu 具有很大的吸引力，非常出色的支持基础和 Gnome 支持。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-03T23:40:09.570

我想说更容易使用和更完整（免费）的发行版是 Fedora、Debian 和 Ubuntu。

从那以后我一直是 RedHat 用户……永远。当该项目开始时，我切换到了 Fedora（它只是 RedHat 的免费、开放版本）。有些版本不稳定，有些还不错，但平均而言，与我尝试过的其他发行版相比，我遇到的严重问题要少得多。现在我正在使用 Fedora 10，因为我妈妈已经能够使用它，我想他们在用户界面和可用性方面取得了真正的进步！;)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-04T00:34:07.270

我建议您下载某种风格的预制虚拟机。至于哪个发行版，如果是客户端应用程序，请使用 Ubuntu。如果它是一个服务器应用程序，那没关系，所以选择 Ubuntu。;P

这是我过去用于测试的一个很好的预制虚拟机：http: [//www.vmware.com/appliances/directory/95733](http://www.vmware.com/appliances/directory/95733)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-06-02T20:42:38.057

VirtualBox + 任何 Ubuntu + mono/MonoDevelop = 对我来说开箱即用。

# asp.net - ASP.NET 中没有会话状态的用户身份验证

> ID：716078
> 
> 赞同：7
> 
> 时间：2009-04-03T23:28:09.443
> 
> 标签：asp.net, authentication, session, cookies, session-state

为 ASP.NET 应用程序提出的要求之一是我们在全局范围内禁用会话状态。（这是没有商量余地的。）

另一个要求是我们有一些用户身份验证的方法。我正在考虑使用 ASP.NET 的成员提供程序模型。

是否可以在没有会话状态的情况下进行用户身份验证？

我们正在寻找的特定用户身份验证示例是：

*   用户未经身份验证访问网站
*   用户输入注册信息（联系方式等）
*   在剩余的会话中，用户可以访问某些内容，这要归功于他们的注册状态

有没有办法用 cookie 做到这一点？

这可以安全地完成，所以cookie不容易被欺骗吗？

ASP.NET 中是否有内置功能来支持这一点，还是我们需要推出自己的方法？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-03T23:30:11.653

ASP.NET Forms 身份验证不使用`SessionState`. 它使用 cookie 来存储身份验证票证。

`web.config`您还可以通过编辑文件来强制通过 SSL 通道发送身份验证票证。

您需要的所有功能都内置在 ASP.NET 中。

[http://msdn.microsoft.com/en-us/library/aa480476.aspx](http://msdn.microsoft.com/en-us/library/aa480476.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T23:38:20.353

当然，cookie 会做到这一点。

想想基本面。无论如何，会话状态由 cookie 管理。

这就是你要做的。

当他们登录时，您会获取他们的用户 ID 和超时时间（因此登录仅持续 30 分钟或其他时间）。

取那个字符串，然后散列它。

（java，不重要）

```
String cookie = userid + ":" + timeString + ":" + md5(userid + ":" + timeString + ":" + "secretpassword"); 
```

然后，当请求到达您的站点时，检查 cookie。首先检查它的完整性。

```
String parts[] = cookie.split(":");
String newHash = md5(parts[0] + ":" + parts[1] + ":" + "secret password");
if (!newHash.equals(parts[2])) {
    // boom, cheater!
} 
```

然后检查时间字符串，看看他们是否仍然“登录”，然后从那里开始。

确保您是否及时更新每个请求的 cookie。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T23:36:57.627

是的，您可以使用 cookie。

cookie 的问题在于，您无法向它们保留大量数据。对于向导类型注册，我将数据存储在数据库中，然后将行键/ID 存储在加密的 cookie 中。这样，当用户进入下一步时，您可以从数据库中检索数据。

对于 cookie，您可以为 cookie 值加上时间戳和加密。我通常不管理用户的身份验证状态。我使用内置的 FormsAuthentication 类来管理我的 Web 应用程序的这方面。

大型网站，例如：Myspace 和 Live Search Club，完全依赖 cookie 作为状态管理。

# mysql - MySQL 内存引擎 + 初始化文件

> ID：716079
> 
> 赞同：0
> 
> 时间：2009-04-03T23:28:32.170
> 
> 标签：mysql

我正在尝试建立一个 MySQL 数据库，以便这些表由内存引擎运行。我并不真正关心丢失一些填充的数据，但我想每天转储它（通过 cronjob 中的 mysqldump）并将 init-file 设置为此转储。但是我似乎无法弄清楚如何让 mysqldump 与 init 文件希望 SQL 语句的格式兼容。

我只是错过了一些完全明显的尝试以这种方式设置数据库的东西吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T23:40:16.933

MySQL 转储正是如此——将 MySQL 数据库内容转储为 SQL。因此，没有任何方法可以直接将其作为数据库文件读取。

您可以做的是修改 MySQL 的 init 脚本，以在每次 MySQL 启动时自动加载最后一次转储（通过命令行）。

更好的解决方案是使用 ramdisk 将数据库的全部内容保存在内存中，然后定期将其复制到安全位置作为备份。

虽然，如果您想维护数据库的内容，最好只使用基于磁盘的存储引擎（InnoDB 或 MyISAM）之一，并为您的服务器提供大量 RAM 用作缓存.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-01-12T18:20:04.653

这个[解决方案](https://stackoverflow.com/a/1451941/1146074)几乎很棒，但是当表数据中的字符串值包含分号时会导致问题——所有分号都被换行符替换。

这是我如何实现的：

```
 mysqldump --comments=false --opt dbname Table1 Table2 > /var/lib/mysql/mem_tables_init.tmp1
    #Format dump file - each statement into single line; semicolons in table data are preserved
            grep -v -- ^-- /var/lib/mysql/mem_tables_init.tmp1 | sed ':a;N;$!ba;s/\n/THISISUNIQUESTRING/g' | sed -e 's/;THISISUNIQUESTRING/;\n/g' | sed -e 's/THISISUNIQUESTRING//g' > /var/lib/mysql/mem_tables_init.tmp2

    #Add "USE database_name" instruction
    cat /var/lib/mysql/mem_tables_init.tmp2 |sed -e 's/DROP\ TABLE/USE\ `dbname`;\nDROP\ TABLE/' > /var/lib/mysql/mem_tables_init.sql

    #Cleanup
    rm -f /var/lib/mysql/mem_tables_init.tmp1 /var/lib/mysql/mem_tables_init.tmp2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-20T20:27:22.283

我偶然发现了这个，所以我会告诉你我在做什么。首先，我在内存表中有一个 ip->country db。没有理由尝试“保存”它，它可以轻松且定期地删除和重新创建，但是当它丢失并且仅计划每周更新时，php 将如何操作可能是不可预测的。其次，我还有一堆其他的内存表。没有理由保存这些，因为它们更加不稳定，寿命在几分钟内。它们会很快被刷新，但陈旧的数据总比没有好。此外，如果您使用任何单独的密钥缓存，它们可能（在某些情况下）需要先加载，否则您将无法加载它们。最后，如果您不打包完整的数据库，请务必在其中添加“使用”语句，

```
cat << EOF > /var/lib/mysql/initial_load.tmp
use fieldsave_db;                 
cache index fieldsave_db.search in search_cache;
EOF

mysqldump --comments=false -udrinkin -pbeer@  fieldsave_db ip2c \
    >> /var/lib/mysql/initial_load.tmp                  
mysqldump --comments=false -ufields -pavenue  -B memtables \
    >> /var/lib/mysql/initial_load.tmp

grep -v -- ^-- /var/lib/mysql/initial_load.tmp |tr -d '\012' \
   |sed -e 's/;/;\n/g' > /var/lib/mysql/initial_load.sql 
```

一如既往，YMMV，但它对我有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-04T00:56:21.353

我的理解是 --init-file 期望每个 SQL 语句都在一行中，并且文件中没有注释。

您应该能够通过以下方式清除评论：

```
mysqldump --comments=false 
```

至于一行中的每个 SQL 语句，我不熟悉执行此操作的 mysqldump 选项，但您可以做的是一行 Perl 删除所有换行符：

```
perl -pi -w -e 's/\n//g;' theDumpFilename 
```

我不知道 --init-file 是否喜欢它，但值得一试。

您可以做的另一件事是从脚本启动 mysql，该脚本也加载到常规 mysqldump 文件中。不是您正在寻找的解决方案，但它可能会达到您所追求的效果。

# asp.net - 墙贴的 Asp.Net Sql 自动增量

> ID：716088
> 
> 赞同：0
> 
> 时间：2009-04-03T23:32:07.420
> 
> 标签：asp.net, sql

我有一个包含三列的表。

“UserId”类型-nvarchar

“PostAuthorId”类型-nvarchar

“发布”类型文本

该表将包含每个用户页面的“墙”帖子，例如在 facebook 中。我将在每个用户的页面上使用 gridview 来显示帖子。问题是我想以最新（最新）的帖子排在第一位，最早的帖子排在最后来显示它们。

我以前从未使用过自动增量，我不确定这是否是答案。如果是，我不知道如何使用它。我想过添加一个发布日期列，然后按日期排序。

如果我最终使用日期列，我还可以在帖子上显示日期。有没有办法将日期转换为可读格式？

实现这种排序的最佳方式是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-04T00:06:20.723

如果您使用 AutoIcrement，第一条记录将从 1 开始，每条记录将从那里递增。（默认设置）

如果您想按最新的排序它们首先做一个 ORDER BY ID DESC 我建议创建一个名为 wallPostID 的列，然后将其设置为 AutoIncrement 以及您的主键

日期格式：如果您在 gridView 中显示此数据

1.  转到网格视图上的编辑列
2.  单击左下角“选定字段”下的日期字段
3.  在右侧的“BoundField properties”下转到 Data -> DataFormatString
4.  `{0:d}`将显示为 1/1/2010

这个网站有更多关于字符串格式的信息

[http://msdn.microsoft.com/en-us/library/fht0f5be.aspx](http://msdn.microsoft.com/en-us/library/fht0f5be.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T23:40:04.953

日期时间列肯定适用于这样的事情。[假设您使用的是 MS-SQL，您还可以使用GETDATE()](http://msdn.microsoft.com/en-us/library/aa258905(SQL.80).aspx)等内置函数将默认值附加到列。这样，您只需输入重要的数据，数据库将负责添加日期时间列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T23:50:56.207

要将日期时间转换为可读格式，请尝试：

```
DateTime postDate;
string value = postDate.ToShortDateString(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T23:59:59.273

我建议使用 DateTime 字段而不是自动增量，因为它不仅可以用作有效的排序字段，还可以保留您可能想要显示的信息。如果您想要最近的第一个，您将使用日期和“DESC”修饰符进行排序：

```
Select ... Order By [Date] DESC; 
```

检索数据时，可以将其作为 DateTime 检索并使用 C# 对其进行修改。如果您只想显示日期，可以使用 mdresser 建议的“ToShortDateString()”，如果还想显示时间，可以使用 ToString("...")。您还可以在检索之前使用 SQL 将其转换为字符串：

```
convert(Varchar(10), @mydatetime, 101) 
```

如果您查看[MSDN](http://msdn.microsoft.com/en-us/library/ms187928.aspx)，您会看到各种转换代码（101 是上面使用的代码），可用于以各种方式转换日期。

**更新**：您可能希望为您的应用程序使用自动递增字段，而不是出于对墙条目进行排序的明确需要。它们易于使用 - 如果使用 SQL Server，只需将该字段标记为*身份*（其他数据库类似）。至于在您的程序中使用它们，只需将该字段视为您无需设置的 Int 字段。

现在，为什么要使用自动递增字段？也许最直接的原因是它们为您提供了一种识别每条记录的简单方法。例如，如果您允许人们更改或删除他们的墙条目，则自动递增字段是理想的，因为它为您提供了一种轻松查找每条记录的方法（每条记录将被分配其自己的唯一值）。您可以像 StackOverflow 那样在记录旁边放一个“x”，并使用 UID（自动增量）值进行回调。请注意，如果要执行此操作，则应在 UID 字段上设置主键。

现在，*如果您发现它们因此有用，*那么您也可以按 UID 排序。我仍然会存储日期，以便您可以提供有关何时在墙上创建条目的日期和时间反馈，但这将不再是您的索引或排序字段。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-04T00:13:22.843

您应该始终使用自动递增的 ID 字段。也可以作为你的PK

# php - CodeIgniter 路线：我不断收到 404

> ID：716091
> 
> 赞同：4
> 
> 时间：2009-04-03T23:34:55.120
> 
> 标签：php, codeigniter

我有一个 application/controller/login.php 文件，其中包含以下内容

```
class Login extends Controller {

  function Login()
  {
    parent::Controller();  
  }

  function index()
  {
    $this->mysmarty->assign('title', 'Login');
    $this->mysmarty->assign('site_media', $this->config->item('site_media'));
    $this->mysmarty->display('smarty.tpl');
  }
} 
```

我的路线定义如下所示：

```
$route['default_controller'] = "welcome";
$route['login'] = 'login';
$route['scaffolding_trigger'] = ""; 
```

问题是当我尝试访问[http://localhost/myapp/login](http://localhost/myapp/login)时，我不断收到 404 。我做错什么了？我检查了 CI 路由文档，但找不到任何东西。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-03T23:39:11.460

这应该没有什么问题 - 没有路线它可以工作吗？另外，您是否正确设置了 .htaccess（即[http://localhost/myapp/index.php/login](http://localhost/myapp/index.php/login)是否可以正常工作）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T18:11:40.737

要记住的另一点是，如果您将“enable_query_strings”设置为 true 并且未使用 .htaccess mod_rewrite 规则：

在 config/config.php 中：

```
$config['enable_query_strings'] = TRUE;
$config['controller_trigger']   = 'c';
$config['function_trigger']     = 'm';
$config['directory_trigger']    = 'd'; 
```

正确路由您的请求的 URL 如下所示：

```
http://localhost/myapp/index.php?c=login 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-04T10:27:52.693

如果您没有`index.php`使用该`.htaccess`文件从您的应用程序中删除您的应用程序，那么这本身就是另一个球类游戏。但是你可以做的是：

设置`controller`不是`welcome`文件的默认值，如果您希望欢迎文件成为默认值，请以这种方式使用链接

```
http://localhost/myapp/index.php/login 
```

请记住，这种方式仅在`index.php`未使用`.htaccess`文件删除文件时有效。

同时打开`apllication/config/config.php`并使用此代码`baseurl`

```
$config['base_url'] = 'http://localhost/myapp'; 
```

那应该总能解决问题。

# wcf - 使用 WCF 和 System.AddIn 的应用程序架构

> ID：716101
> 
> 赞同：1
> 
> 时间：2009-04-03T23:39:33.190
> 
> 标签：wcf, architecture, add-in

一点背景知识——我们正在设计一个使用客户端/服务器架构的应用程序，包括：

*   加载服务器端模块的服务器，可能由其他团队开发。
*   加载相应客户端模块的客户端（也可能由其他团队开发；每个客户端模块对应一个服务器模块）。
*   客户端与服务器端通信以进行一般协调，以及模块特定任务。（此时，我认为这意味着客户端与服务器对话，客户端模块与服务器模块对话。）
*   环境是.NET 3.5，客户端是WPF。

部署方案引入了独立升级服务器、任何服务器端模块、客户端和任何客户端模块的潜力。但是，需要能够使用不匹配的版本“工作”。因此，我担心版本控制问题。

到目前为止我的想法：

*   服务器的 Windows 服务。
*   使用 System.AddIn 为服务器加载和与服务器模块通信将在服务器和服务器模块之间的版本兼容性方面为我们提供最大的灵活性。
*   服务器和各个服务器模块提供 WCF 服务与客户端进行通信；服务器和服务器模块之间或两个服务器模块之间的通信使用 AddIn 合同。（这样做的一个优点是模块可以在服务器内部和外部公开不同的接口。）
*   同样，客户端使用 System.AddIn 来查找、加载客户端模块并与之通信。
*   客户端与客户端模块的通信是通过 AddIn 接口进行的；从客户端和从客户端模块到服务器端的通信是通过 WCF 进行的。
*   为了获得最大的弹性，每个模块将在单独的应用程序域中运行。
*   一般来说，系统的性能要求适中，因此编组和跨越进程边界预计不会成为性能问题。（性能要求基本上总结为：不要妨碍此处未描述的系统其他部分。）

我的问题是关于使用两种不同的通信和版本控制模型的想法，这将给我们的开发人员增加负担。System.AddIn 看起来很强大，但也有点笨拙。（我也不确定微软在未来对它的承诺。）另一方面，我对 WCF 的版本控制能力并不感到兴奋。我有一种感觉，可以在 WCF 中实现 System.AddIn 视图/适配器/合同系统，但是对于这两种技术来说都是相当新的，我不知道从哪里开始。

所以...我在正确的轨道上吗？我这样做很难吗？在这条路上我需要注意什么问题吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-04T03:51:40.743

这听起来太复杂了。考虑一个架构，其中每个添加的模块都包含客户端代码（如果您愿意，可以使用 System.AddIn），但服务器端模块是一个新的 service.svc 文件。客户端会知道相应服务的 URL。

或者，您应该查看 Microsoft 可扩展性框架 (MEF) 的加载项功能。这就是他们将在即将发布的版本中开始用于 Visual Studio 可扩展性的内容。

# ruby - 为直方图分组数字

> ID：716118
> 
> 赞同：2
> 
> 时间：2009-04-03T23:54:18.023
> 
> 标签：ruby, grouping, histogram

我有一堆数字，我想用它来生成标准分数的直方图。

因此，我计算数字的平均值和标准差，并用这个公式对每个 x 进行归一化

x' = (x-mean)/std_dev

结果是一个介于 -4 和 4 之间的数字。我想绘制该结果的图表。我正在寻找一种对数字进行分组的方法，以避免出现小条。

我的计划是让区间 [-4,4] 中的 bin 以连续四分之一单位为中心，即 [-4,-3.75,...,3.75,4]

示例：0.1 => bin "0.0", 0.3 => bin "0.25", -1.3 => bin "-1.5"

实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-04T14:01:14.540

这是一个不使用任何第三方库的解决方案。数字应该在 Array 中`vals`。

```
MULTIPLIER  = 0.25 
multipliers = []
0.step(1, MULTIPLIER) { |n| multipliers << n }

histogram = Hash.new 0

# find the appropriate "bin" and create the histogram
vals.each do |val|
  # create an array with all the residuals and select the smallest
  cmp = multipliers.map { |group| [group, (group - val%1).abs] }
  bin = cmp.min { |a, b| a.last <=> b.last }.first
  histogram[val.truncate + bin] += 1
end 
```

我认为它执行了适当的舍入。但我只尝试过：

```
vals = Array.new(10000) { (rand * 10) % 4 * (rand(2) == 0 ? 1 : -1) } 
```

并且分布有点倾斜，但这可能是随机数生成器的错。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-04T00:10:30.683

Rails 提供 Enumerable#group_by - 在这里查看源代码，假设您没有使用 Rails：[http ://api.rubyonrails.org/classes/Enumerable.html](http://api.rubyonrails.org/classes/Enumerable.html)

假设您的列表名为 xs，您可以执行以下操作（未经测试）：

```
bars = xs.group_by {|x| #determine bin here} 
```

然后你会有一个看起来像这样的哈希：

```
bars = { 0 => [elements,in,first,bin], 1 => [elements,in,second,bin], etc } 
```

# c# - 从 C-Sharp / C# 上的 Active Directory 获取用户帐户状态（锁定/解锁）

> ID：716128
> 
> 赞同：5
> 
> 时间：2009-04-03T23:58:40.803
> 
> 标签：c#, active-directory

我需要找到一种方法来检查 Active Directory UserAccount 的帐户是否被锁定。

我已经在 Windows 2000 AD 中尝试了 userAccountControl 属性，但是当我强制锁定帐户时该属性不会更改一个字节（通过尝试登录到为该特定用户提供错误密码的工作站）我可以通过使用半神制作的[ADExplorer.exe实用程序 -> Russinovich 先生](http://live.sysinternals.com/adexplorer.exe)

我已经看到在 3.5 框架中他们使用方法 .InvokeGet("userLockedOut"); 但我正在尝试在用.Net Framework 1.1 编写的企业应用程序中执行此操作，并且没有机会使用较新的应用程序（如果您想建议这样做）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-04T02:14:34.457

这是包含有关 Active Directory 内容的所有信息的链接...

[http://www.codeproject.com/KB/system/everythingInAD.aspx](http://www.codeproject.com/KB/system/everythingInAD.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-04T03:06:24.830

发现这一点，它比我过去所做的多一点（找不到确切的片段），尽管关键是根据返回的用户的锁定时间进行目录搜索和限制。此外，对于特定用户，您可以使用其他属性进一步限制您的搜索。我相信上面的代码项目链接具有特定的逻辑（用于搜索限制）。

```
class Lockout : IDisposable
{
  DirectoryContext context;
  DirectoryEntry root;
  DomainPolicy policy;

  public Lockout(string domainName)
  {
    this.context = new DirectoryContext(
      DirectoryContextType.Domain,
      domainName
      );

    //get our current domain policy
    Domain domain = Domain.GetDomain(this.context);

    this.root = domain.GetDirectoryEntry();
    this.policy = new DomainPolicy(this.root);      
  }

  public void FindLockedAccounts()
  {
    //default for when accounts stay locked indefinitely
    string qry = "(lockoutTime>=1)";

    TimeSpan duration = this.policy.LockoutDuration;

    if (duration != TimeSpan.MaxValue)
    {
      DateTime lockoutThreshold =
        DateTime.Now.Subtract(duration);

      qry = String.Format(
        "(lockoutTime>={0})",
        lockoutThreshold.ToFileTime()
        );
    }

    DirectorySearcher ds = new DirectorySearcher(
      this.root,
      qry
      );

    using (SearchResultCollection src = ds.FindAll())
    {
      foreach (SearchResult sr in src)
      {
        long ticks =
          (long)sr.Properties["lockoutTime"][0];

        Console.WriteLine(
          "{0} locked out at {1}",
          sr.Properties["name"][0],
          DateTime.FromFileTime(ticks)
          );
      }
    }
  }

  public void Dispose()
  {
    if (this.root != null)
    {
      this.root.Dispose();
    }
  }
} 
```

代码是从这篇文章中提取的：http: [//social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/5e0fadc2-f27b-48f6-a6ac-644e12256c67/](http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/5e0fadc2-f27b-48f6-a6ac-644e12256c67/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-04T05:28:29.153

看到 .NET 1.1 后，请查看此线程：[http](http://forums.asp.net/t/434077.aspx) : //forums.asp.net/t/434077.aspx，使用过滤器中的锁定时间仍然可以解决问题。

特别是在线程中（在提供大量语法的较大代码帖子之后）：

```
(&(objectClass=user)(objectCategory=person)(lockoutTime>=1)); 
```

另一件事是，如果您使用的是 .NET v.1.1，那么 S.DS 会为您正确地将 Integer8 转换为长整数（不适用于 1.0）——这意味着您可以取消反射代码（在文中）：

```
//use the filter from above

SearchResultCollection src = ds.FindAll();  

foreach(SearchResult sr in src)

{

     DateTime lockoutTime = DateTime.FromFileTime((long)sr.Properties["lockoutTime][0]);

     Response.Output.Write("Locked Out on: {0}", lockoutTime.ToString());

} 
```

# amazon-web-services - 使用 Amazon AWS 按价格排序

> ID：716129
> 
> 赞同：3
> 
> 时间：2009-04-03T23:59:06.093
> 
> 标签：amazon-web-services

作为使用 Amazon AWS 的 ItemSearch 操作的一部分，可以按价格对结果进行排序。有谁知道排序的实际价格是多少？销售价格？正常价格？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-04T00:51:42.283

假设您按从低到高的顺序对它们进行排序，它会按每件商品的最低可用价格列出它们。有标价、新价（促销价）和二手价可供选择。如果我没记错的话，您可以自定义查询以包含任何或所有这些价格。这三个中最低的一个决定了项目的排序位置。有关示例，请参阅[ThriftCart.com](http://www.thriftcart.com/)上的结果（由 AWS 查询生成）。

# c# - 为什么我的数组抛出超出范围异常错误？

> ID：716130
> 
> 赞同：1
> 
> 时间：2009-04-03T23:59:22.253
> 
> 标签：c#, arrays

为什么下面的代码会抛出异常？

```
for (int i = 0; i <= Items.Length-1; i++)
{
    Console.WriteLine(Items[i,1]);
} 
```

例外：

```
System.IndexOutOfRangeException was unhandled
  Message="Index was outside the bounds of the array."
  Source="Es"
  StackTrace:
       at Es.Program.Main(String[] args) in C:\Users\Fero\Documents\Visual Studio 2005\Projects\Es\Es\Program.cs:line 19
       at System.AppDomain._nExecuteAssembly(Assembly assembly, String[] args)
       at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
       at System.Threading.ThreadHelper.ThreadStart() 
```

物品申报：

获取字符串数组的函数：

```
static string[,] ReadFromFile(string filename, int rowsF)
{
    StreamReader SR;
    string S;
    string[] S_split;

    SR = File.OpenText(filename);
    S = SR.ReadLine();

    string[,] myItems = new String[rowsF, 2];
    int row_number = 0;
    while (S != null)
    {
        S_split = S.Split('"');
        //temp_items[row_number,0] = 
        myItems[row_number,0] = S_split[1];
        myItems[row_number,1] = S_split[2];

        row_number++;
        S = SR.ReadLine();
    }
    SR.Close();
    return myItems;
}

string[,] Items = ReadFromFile(myFile, rowsF); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-04T00:01:35.743

你有一个直接的二维数组。Length 为您提供数组[中元素的总数](http://msdn.microsoft.com/en-us/library/system.array.length.aspx)，但您使用它来计算单个维度的索引。你想要的是：

```
for (int i = 0; i < Items.GetLength(0); i++)
{
    Console.WriteLine(Items[i,1]);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-04T00:02:14.337

检查 Items[i] 的长度。它似乎是一个二维数组，而且它显然不是空的，因为你会得到一个不同的例外，所以它可能只是 Items[i] 处的一个空数组，或者只包含一个项目。

检查：

```
Items[i] == null
Items[i].Length > 0 
```

**编辑**：您的附加代码有所帮助。当您拆分字符串以初始化项目时，对于给您带来麻烦的项目，请检查您在索引 1 处存储的内容。除此之外，我看不出它有什么问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T00:05:17.433

它抛出异常是因为`Items[i].Length`< 2

您需要`(Items[i].Length >= 2)`在尝试访问之前检查`Items[i,1]`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-04T00:15:03.790

据我所知，其中一条线不符合您要求的格式的可能性很小。看起来您正在检索基于引号 (") 分隔的文本，并且 S_split[] 可能并不总是具有这些字段数。

例如，文件末尾的空行将触发异常。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-04T00:19:31.893

> ```
>  S_split = S.Split('"');
>     //temp_items[row_number,0] = 
>     myItems[row_number,0] = S_split[1];
>     myItems[row_number,1] = S_split[2]; 
> ```

您确定不想要 S_Split[0] 和 S_Split[1]？

应该看到输入文件。

# performance - Intel x86 处理器的 L1 内存缓存记录在哪里？

> ID：716145
> 
> 赞同：52
> 
> 时间：2009-04-04T00:08:22.433
> 
> 标签：performance, intel, cpu-architecture, cpu-cache

我正在尝试分析和优化算法，我想了解缓存对各种处理器的具体影响。对于最近的 Intel x86 处理器（例如 Q9300），很难找到有关高速缓存结构的详细信息。特别是，大多数发布处理器规格的网站（包括[Intel.com](http://www.intel.com/products/processor/core2quad/specifications.htm)）不包含对 L1 缓存的任何引用。这是因为 L1 缓存不存在还是由于某种原因这些信息被认为不重要？有没有关于消除 L1 缓存的文章或讨论？

[编辑] 在运行各种测试和诊断程序（主要是在下面的答案中讨论的那些）之后，我得出结论，我的 Q9300 似乎有一个 32K L1 数据缓存。我仍然没有找到一个明确的解释来解释为什么这些信息如此难以获得。我目前的工作理论是，L1 缓存的细节现在被英特尔视为商业机密。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-04-04T01:05:07.260

几乎不可能找到有关英特尔缓存的规格。去年我在教一门关于缓存的课程时，我问了英特尔内部的朋友（在编译器组中），*他们*找不到规范。

**可是等等！！！** [保佑他的灵魂的Jed](https://stackoverflow.com/users/33208/jed)告诉我们，在 Linux 系统上，您可以从内核中挤出大量信息：

```
grep . /sys/devices/system/cpu/cpu0/cache/index*/* 
```

这将为您提供关联性、集合大小和一堆其他信息（但不是延迟）。例如，我了解到虽然 AMD 宣传他们的 128K L1 高速缓存，但我的 AMD 机器有一个分离的 I 和 D 高速缓存各 64K。

* * *

多亏了 Jed，现在大部分已经过时的两个建议：

*   AMD 发布了有关其缓存的更多信息，因此您至少可以获得一些有关现代缓存的信息。例如，去年的 AMD L1 高速缓存每个周期（峰值）提供两个字。

*   这个开源工具[`valgrind`](http://valgrind.org/)里面有各种各样的缓存模型，它对于分析和理解缓存行为是非常宝贵的。它带有一个非常好的可视化工具`kcachegrind`，它是 KDE SDK 的一部分。

* * *

例如：在 2008 年第三季度，AMD [K8](http://www.7-cpu.com/cpu/K8.html) / [K10](http://www.7-cpu.com/cpu/K10.html) CPU 使用 64 字节缓存线，每个 L1I/L1D 拆分缓存为 64kB。L1D 与 L2 是 2 路关联和排他的，延迟为 3 个周期。L2 缓存是 16 路关联的，延迟约为 12 个周期。

[AMD Bulldozer 系列 CPU](https://en.wikipedia.org/wiki/Bulldozer_(microarchitecture)#Bulldozer_core)使用一个拆分 L1，每个集群有一个 16kiB 4 路关联 L1D（每个内核 2 个）。

英特尔 CPU 长期以来一直保持 L1 不变（从 Pentium M 到[Haswell](http://www.realworldtech.com/haswell-cpu/5/)再到 Skylake，大概在此之后的许多代）：每个 I 和 D 缓存拆分 32kB，L1D 是 8 路关联的。64 字节高速缓存行，与 DDR DRAM 的突发传输大小相匹配。负载使用延迟约为 4 个周期。

另请参阅[x86](/questions/tagged/x86 "显示标记为“x86”的问题")标签 wiki 以获取更多性能和微架构数据的链接。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2013-11-02T21:38:45.630

本英特尔手册：**英特尔® 64 和 IA-32 架构优化参考手册**对缓存注意事项进行了很好的讨论。

![在此处输入图像描述](https://i.stack.imgur.com/01ksT.png)

第 46 页，第 2.2.5.1 节[**英特尔® 64 和 IA-32 架构优化参考手册**](http://www.intel.com/content/dam/www/public/us/en/documents/manuals/64-ia-32-architectures-optimization-manual.pdf)

甚至 MicroSlop 也意识到需要更多工具来监控缓存使用和性能，并且有一个[GetLogicalProcessorInformation() 函数](http://msdn.microsoft.com/en-us/library/ms683194.aspx)示例（......同时在过程中创建可笑的长函数名称开辟了新的道路）我想我会编码向上。

**更新 I：Hazwell 将缓存加载性能提高[了 2 倍，来自 Tock 内部；哈斯韦尔的建筑](http://www.hardwarecanucks.com/forum/hardware-canucks-reviews/61451-intel-haswell-i7-4770k-i5-4670k-review-2.html)**

如果对充分利用缓存的重要性有任何疑问，那么前 Azul 的 Cliff Click 的[这次演示](http://www.infoq.com/presentations/click-crash-course-modern-hardware)应该可以消除所有疑问。用他的话来说，“内存就是新磁盘！”。

![Haswell's URS（统一预订站）](https://i.stack.imgur.com/HPjro.png)

**更新二：SkyLake 显着改进的缓存性能规格。**

[![SkyLake 缓存规格](https://i.stack.imgur.com/5rYVX.png)](https://i.stack.imgur.com/5rYVX.png)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-04T01:06:21.860

您正在查看消费者规范，而不是开发人员规范。 [这是您想要的文档。](http://www.intel.com/products/processor/manuals/)缓存大小因处理器系列子型号而异，因此它们通常不在 IA-32 开发手册中，但您可以在 NewEgg 等上轻松查找它们。

**编辑：**更具体地说：第 3A 卷（系统编程指南）的第 10 章，优化参考手册的第 7 章，以及可能在 TLB 页面缓存手册中的某些内容，尽管我认为其中一个离 L1 比你关心的更远关于。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-04-04T19:03:28.650

我又做了一些调查。苏黎世联邦理工学院的一个小组建立了一个[内存性能评估工具](http://www.cs.inf.ethz.ch/cops/ECT/)，该工具可能能够获取有关 L1 和 L2 缓存的大小（也可能是关联性）的信息。该程序通过实验尝试不同的读取模式并测量产生的吞吐量来工作。[Bryant 和 O'Hallaron](http://csapp.cs.cmu.edu/public/students.html)的流行教科书使用了简化版本。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-04T00:11:34.160

这些平台上存在 L1 缓存。在内存和前端总线速度超过 CPU 的速度之前，这几乎肯定会保持不变，这很可能还有很长的路要走。

在 Windows 上，您可以使用[GetLogicalProcessorInformation](http://msdn.microsoft.com/en-us/library/ms683194.aspx)获取某种级别的缓存信息（大小、行大小、关联性等）。Win7 上的 Ex 版本将提供更多数据，例如哪些内核共享哪些缓存。 [CpuZ](http://www.cpuid.com/cpuz.php)也提供此信息。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-04T00:59:37.850

[参考局部性对](http://en.wikipedia.org/wiki/Locality_of_reference)某些算法的性能有重大影响；L1、L2（以及较新的 CPU 上的 L3）缓存的大小和速度显然在其中发挥了重要作用。矩阵乘法就是这样一种算法。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-08-17T12:53:19.727

英特尔手册卷。2 指定以下公式来计算缓存大小：

> 此缓存大小（以字节为单位）
> 
> = (Ways + 1) * (Partitions + 1) * (Line_Size + 1) * (Sets + 1)
> 
> = (EBX[31:22] + 1) * (EBX[21:12] + 1) * (EBX[11:0] + 1) * (ECX + 1)

使用with set to查询`Ways`、`Partitions`和`Line_Size`的位置。`Sets``cpuid``eax``0x04`

提供头文件声明

`x86_cache_size.h`：

```
unsigned int get_cache_line_size(unsigned int cache_level); 
```

实现如下所示：

```
;1st argument - the cache level
get_cache_line_size:
    push rbx
    ;set line number argument to be used with CPUID instruction
    mov ecx, edi 
    ;set cpuid initial value
    mov eax, 0x04
    cpuid

    ;cache line size
    mov eax, ebx
    and eax, 0x7ff
    inc eax

    ;partitions
    shr ebx, 12
    mov edx, ebx
    and edx, 0x1ff
    inc edx
    mul edx

    ;ways of associativity
    shr ebx, 10
    mov edx, ebx
    and edx, 0x1ff
    inc edx
    mul edx

    ;number of sets
    inc ecx
    mul ecx

    pop rbx

    ret 
```

在我的机器上工作如下：

```
#include "x86_cache_size.h"

int main(void){
    unsigned int L1_cache_size = get_cache_line_size(1);
    unsigned int L2_cache_size = get_cache_line_size(2);
    unsigned int L3_cache_size = get_cache_line_size(3);
    //L1 size = 32768, L2 size = 262144, L3 size = 8388608
    printf("L1 size = %u, L2 size = %u, L3 size = %u\n", L1_cache_size, L2_cache_size, L3_cache_size);
} 
```

# c# - 重定向到 clickonce 应用程序后关闭 aspx 页面

> ID：716146
> 
> 赞同：0
> 
> 时间：2009-04-04T00:09:11.590
> 
> 标签：c#, javascript, clickonce, response.redirect

我在我的 aspx 页面部分后面的代码中有代码。在按钮单击时，会调用一个函数，以便加载 clickonce 应用程序。最初我是在 javascript 中完成所有这些工作的。js 将 window.location 设置为我的 clickonce 应用程序的 url，并通过超时关闭。在我将应用程序安装在另一台服务器上之前，这一直很好。IE 不允许 clickonce 应用程序通过客户端脚本加载。我现在被迫重定向到 clickonce 应用程序的 url。我现在遇到的问题是无法关闭启动重定向的窗口。在任何 js 可以运行之前，重定向首先触发。我基本上需要一种方法来减慢重定向，以便我可以运行我的 js。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-04T03:48:41.843

您可以重定向到将包含您之前拥有的 JavaScript 的页面 - 关闭窗口并重定向到 clickonce 应用程序。您可以在查询字符串中将应用程序的 URL 传递到此页面。该页面可以是纯 html。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-13T03:50:23.183

你可以做这样的事情。我正在使用 jquery，但你也没有..

webmethod = GetUrlToApplication，基本上是返回路径。

```
<script type="text/javascript">
    $(document).ready(function() {
        $.ajax({
            type: "POST",
            url: "Default.aspx/GetUrlToApplication",
            data: "{}",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: ajaxSucceededFn, 
            error: errorFn                  
        });
    });

     function errorFn ()  
     {   
        alert('Error:-Unable to launch Application.');  
     }
     function ajaxSucceededFn (result)  
     {
         window.location = result;
         setTimeout(function() { window.open('', '_self', ''); window.close(); }, 1000);
     }

</script> 
```

# asp.net - 使用第三方 Web.UI 控件（如 Component Art）的经验

> ID：716147
> 
> 赞同：1
> 
> 时间：2009-04-04T00:10:26.237
> 
> 标签：asp.net, asp.net-ajax, ajaxcontroltoolkit

有人用过 Component Arts Web.UI 控件吗？

它们看起来像是一套很棒的工具，但它们收取的 998 美元是否值得？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-04T00:20:57.927

控制是体面的。我已经使用网格、树视图、拆分器和对话框一年了。最大的问题是他们缺乏文档；但是，他们的支持团队非常擅长解决问题并弥补他们缺乏文档的情况。

我也使用了他们的回调控件；哪个比asp更新面板更好

# apache-flex - CFC 和 Flex 之间的嵌套类强制失败

> ID：716149
> 
> 赞同：1
> 
> 时间：2009-04-04T00:11:09.603
> 
> 标签：apache-flex, coldfusion, nested, remoteobject, coercion

我有两个 AS3 类，A 和 B。A 类包含一个 ArrayCollection，它将保存 B 类的多个实例。

在 ColdFusion 中，我有匹配的 CFC，具有相同顺序的同名变量，以及每个变量的 cfproperty 标记。

AS3 类都使用 RemoteClass 元数据将它们与对应的 CFC 相关联。

问题是，虽然 A.cfc 从 CF 返回并适当地填充 A.as 实例，但我无法填充任何嵌套的 B.as 实例。相反，我收到此错误：

```
TypeError: Error #1034: Type Coercion failed: cannot convert []@2f4465f1 to mx.collections.ArrayCollection. 
```

除了嵌套的 B 实例的集合之外，为什么 A 实例可以正常工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-06T18:48:24.970

问题是对象作为数组从 ColdFusion 返回，而 Flex 不想为我将其转换为 ArrayCollection。Flex 会将 ColdFusion 查询转换为 ArrayCollection，但 ColdFusion 数组显然只能是 Flex 中的 Array（自动）。

我将 Flex 中的 ArrayCollection 更改为 Array，一切正常。

# java - Java 命令行参数

> ID：716153
> 
> 赞同：24
> 
> 时间：2009-04-04T00:13:45.230
> 
> 标签：java, command-line, arguments

我正在尝试检测是否输入了“a”作为第一个字符串参数。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-04-04T01:02:45.113

如果您打算将其扩展到单个 arg之外，请使用[apache commons cli 。](http://commons.apache.org/cli/)

“Apache Commons CLI 库提供了一个 API，用于解析传递给程序的命令行选项。它还能够打印帮助消息，详细说明命令行工具可用的选项。”

Commons CLI 支持不同类型的选项：

*   类似 POSIX 的选项（即 tar -zxvf foo.tar.gz）
*   GNU 喜欢长选项（即 du --human-readable --max-depth=1）
*   类似 Java 的属性（即 java -Djava.awt.headless=true -Djava.net.useSystemProxies=true Foo）
*   附加价值的空头期权（即 gcc -O2 foo.c）
*   带有单个连字符的长选项（即 ant -projecthelp）

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-04-04T00:16:51.027

```
public class YourClass {
    public static void main(String[] args) {
        if (args.length > 0 && args[0].equals("a")){
            //...
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-04-04T00:17:52.990

每个 Java 程序都以

```
public static void main(String[] args) { 
```

作为参数的类型数组保存`String`程序的命令行参数。`main()`如果用户将您的程序运行为

```
$ java myProgram a 
```

然后`args[0]`将保存字符串“a”。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-04T00:17:23.473

命令行参数在第一个`String[]`参数中传递给`main()`，例如

```
public static void main( String[] args ) {
} 
```

在上面的示例中，`args`包含所有命令行参数。

对所提出问题的简短而甜蜜的回答是：

```
public static void main( String[] args ) {
    if( args.length > 0 && args[0].equals( "a" ) ) {
        // first argument is "a"
    } else {
        // oh noes!?
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-04T00:17:26.033

命令行参数可以通过方法`String[] args`的参数访问`main`。

对于第一个参数，您可以检查`args[0]`

整个代码看起来像

```
public static void main(String[] args) {
    if ("a".equals(args[0])) {
         // do something
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-04T00:16:34.973

你的`main`方法有一个`String[]`论点。其中包含已传递给您的应用程序的参数（通常称为`args`，但这不是必需的）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-10-22T06:12:39.973

尝试传递值 a 并使用 equals 方法进行比较，如下所示：

```
public static void main(String str[]) {

    boolean b = str[0].equals("a");

    System.out.println(b);

} 
```

按照此链接了解有关[Java 中命令行参数的更多信息](http://javawebtutorial.blogspot.in/2013/10/command-line-argument-command-line.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-04T00:56:06.347

正如其他人所说... .equals 方法是您所需要的。

万一你使用了类似的东西：

```
if(argv[0] == "a") 
```

然后它不起作用，因为 == 比较两个对象的位置（物理相等）而不是内容（逻辑相等）。

由于命令行中的“a”和程序源代码中的“a”被分配在两个不同的位置，因此不能使用 ==。您必须使用 equals 方法来检查两个字符串是否具有相同的字符。

另一个注意事项... "a" == "a" 在很多情况下都可以使用，因为字符串在 Java 中是特殊的，但 99.99999999999999% 的时间你想使用 .equals。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-12-18T17:44:42.030

命令行参数作为字符串存储在`String`数组`String[] args that is passed to`main()` 中。

```
java [program name] [arg1,arg2 ,..] 
```

命令行参数是在运行程序时从命令提示符接受的输入。传递的参数可以是任何东西。它存储在`args[]`数组中。

```
//Display all command line information
         class ArgDemo{
            public static void main(String args[]){
            System.out.println("there are "+args.length+"command-line arguments.");
            for(int i=0;i<args.length;i++)
            System.out.println("args["+i+"]:"+args[i]);
    }
    } 
```

例子：

```
java Argdemo one two 
```

输出将是：

```
there are 2 command line arguments:
they are:
arg[0]:one
arg[1]:two 
```

# c# - 转换字典 到字典 使用 LINQ？

> ID：716170
> 
> 赞同：17
> 
> 时间：2009-04-04T00:25:41.347
> 
> 标签：c#, .net, linq, dictionary

我正在尝试找到一个接受 Dictionary<String,Int> 并返回 Dictionary<String,SomeEnum>...的 LINQ oneliner。这可能是不可能的，但会很好。

有什么建议么？

编辑： ToDictionary() 是显而易见的选择，但是你们中的任何一个人实际尝试过吗？在字典上，它与在 Enumerable 上的工作方式不同......您不能将键和值传递给它。

编辑＃2：Doh，我在这条线上方有一个错字，搞砸了编译器。一切都很好。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-04-04T00:44:23.003

它通过简单的演员表直接工作。

```
Dictionary<String, Int32> input = new Dictionary<String, Int32>();

// Transform input Dictionary to output Dictionary

Dictionary<String, SomeEnum> output =
   input.ToDictionary(item => item.Key, item => (SomeEnum)item.Value); 
```

* * *

我使用了这个测试，它没有失败。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Diagnostics;

namespace DictionaryEnumConverter
{
    enum SomeEnum { x, y, z = 4 };

    class Program
    {
        static void Main(string[] args)
        {           
            Dictionary<String, Int32> input =
               new Dictionary<String, Int32>();

            input.Add("a", 0);
            input.Add("b", 1);
            input.Add("c", 4);

            Dictionary<String, SomeEnum> output = input.ToDictionary(
               pair => pair.Key, pair => (SomeEnum)pair.Value);

            Debug.Assert(output["a"] == SomeEnum.x);
            Debug.Assert(output["b"] == SomeEnum.y);
            Debug.Assert(output["c"] == SomeEnum.z);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-04T00:48:05.943

```
var result = dict.ToDictionary(kvp => kvp.Key,
               kvp => (SomeEnum)Enum.ToObject(typeof(SomeEnum), kvp.Value)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-21T18:08:45.053

```
var collectionNames = new Dictionary<Int32,String>();
Array.ForEach(Enum.GetNames(typeof(YOUR_TYPE)), name => 
{ 
  Int32 val = (Int32)Enum.Parse(typeof(YOUR_TYPE), name, true); 
  collectionNames[val] = name; 
}); 
```

# wpf - 如何在 ViewModel 之间进行通信

> ID：716175
> 
> 赞同：1
> 
> 时间：2009-04-04T00:27:56.350
> 
> 标签：wpf, mvvm, viewmodel

我有一个带有 TabPage1 和 TabPage2 的 TabControl，在 TabPage1 中，还有另一个带有 2 个项目 TabPage11 和 TabPage12 的 TabControl1。
在 TabPage2 中，还有另一个 TabControl2，其中包含 2 个项目 TabPage21 和 TabPage22。

每个项目（TabPage11、TabPage12、TabPage21 和 TabPage22）都有自己的 View（以 UserControl 的形式）和 ViewModel。每个视图上都有 dataGrid。

现在我想为每个 dataGrid 实现 ExportToExcel 函数。我可以在每个 tabItem 上放置一个 ExportToExcel 按钮，但它看起来不太好。所以我在主窗口上放了一个按钮，这样当用户单击该按钮时，所选 tabItem 上的 dataGrid 就会得到处理。

问题是 mainWindow 上的按钮不知道如何告诉
所选 tabItem 的 ViewModel 将其导出。

有什么建议么？提前致谢！史蒂夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-04T03:09:22.220

主要功能应该整理来自选项卡控制器的信息，如果我理解正确，他们应该整理来自其子选项卡控制器的信息，这将从正确的视图模型中提取信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-07-29T16:22:20.187

假设您正在使用`ICommand`绑定到导出按钮，为什么不通过绑定指定命令参数：

```
<Button Command="{Binding ExportToExcelCommand}" CommandParameter="{Binding SelectedItem, ElementName=MyTabControl}">Export</Button> 
```

然后，选定的选项卡将作为参数传递到`Execute`命令的方法中

# objective-c - 将 NSInteger 附加到 NSMutableData

> ID：716181
> 
> 赞同：12
> 
> 时间：2009-04-04T00:32:59.333
> 
> 标签：objective-c

如何将 NSInteger 附加到 NSMutableData。类似的东西...

```
NSMutableData *myData = [[NSMutableData alloc] init];
NSInteger myInteger = 42;

[myData appendBytes:myInteger length:sizeof(myInteger)]; 
```

这样 0x0000002A 将被附加到 myData。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-04T01:09:05.347

传递整数的地址，而不是整数本身。 `appendBytes:length:`需要一个指向数据缓冲区的指针和数据缓冲区的大小。在这种情况下，“数据缓冲区”是整数。

```
[myData appendBytes:&myInteger length:sizeof(myInteger)]; 
```

但请记住，这将使用您计算机的字节序对其进行编码。如果您打算将数据写入文件或通过网络发送，则应使用已知的字节顺序。例如，要将主机（您的机器）转换为网络字节序，请使用[`htonl()`](http://linux.die.net/man/3/htonl)：

```
uint32_t theInt = htonl((uint32_t)myInteger);
[myData appendBytes:&theInt length:sizeof(theInt)]; 
```

# gzip - Yslow 无法识别我的 gzip

> ID：716186
> 
> 赞同：3
> 
> 时间：2009-04-04T00:35:41.450
> 
> 标签：gzip, yslow

我的网站全部按照以下方式进行了 Gzip 压缩：

[http://www.gidnetwork.com/tools/gzip-test.php](http://www.gidnetwork.com/tools/gzip-test.php)

但是，当我通过 Yslow 运行它时，我得到了一个 Gzip 的 F 并且它将我的所有脚本列为未压缩的组件。

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-08-11T07:59:50.403

查看 Firebug 中的标头并检查浏览器是否正在发送

```
Accept-Encoding     gzip,deflate 
```

在请求标头中

```
Content-Encoding    gzip 
```

正在由服务器在响应标头中发送（表明已应用 gzipping）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-04T00:41:49.093

如果您使用链接页面中的方法对您的站点进行 gzip 压缩，它不会对脚本产生任何影响，因为它们不是通过 PHP 运行的。您需要：

1) 配置您选择的网络服务器（apache2 使用 mod_deflate）

2) 通过 php 提供您的 .js 文件：

```
<?php ob_start('ob_gzhandler'); echo file_get_contents('whatever.js'); ?> 
```

# asp.net - 刷新时的 Asp.Net 按钮事件再次触发？？？图形用户界面？

> ID：716187
> 
> 赞同：1
> 
> 时间：2009-04-04T00:36:08.890
> 
> 标签：asp.net, sql, button, refresh, guid

这里明显的问题是，在刷新时会调用按钮事件并在数据库中创建重复的帖子。我已经阅读了这个网站上关于同样问题的其他问题。

显然答案是为每个帖子创建一个 GUID 并检查以确保 GUID 是唯一的？我不确定如何实现这一点。

这是否意味着在刷新时，它将尝试创建具有相同 GUID 的重复帖子？

如何在数据库中实现 GUID？或者，如果这不是答案，那是什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-04T01:17:09.757

这个想法是您为表单创建一个唯一编号，当表单发布时，您将此唯一编号保存在您正在编辑/创建的记录中的数据库中。在保存之前检查该号码是否已被使用，在这种情况下，它是通过刷新重新发布的表格。

如果您正在更新记录，您只需检查该记录是否已使用相同的唯一编号保存，但如果您要添加新记录，则必须检查是否有任何其他记录具有该编号。

Guid 是一个很好的数字，因为您不太可能得到重复。该类可以生成的 31 位随机数`Random`也不太可能产生重复，但 Guid 的 128 位使得它更不可能出现。

您不必在数据库中创建 Guid 值，只需`Guid.NewGuid()`在初始化表单的代码中使用即可。您可以将 Guid 放在表单中的隐藏字段中。在数据库中，您只需要一个可以存储 Guid 值的字段，可以是 Guid 数据类型（如果可用），或者只是一个足够大以保存 Guid 的文本表示的文本字段。

您可以使用该`ToString`方法获取 Guid 值的字符串表示形式（以便您可以将其放入表单中）。Using`id.ToString("N")`给出了最紧凑的格式，即没有分隔符的 32 个十六进制数字。使用`id.ToString("B")`给出更易识别的格式“{xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx}”。要从字符串（任何一种格式）中取回 Guid，您只需使用`new Guid(str)`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T02:28:48.197

这是我使用的 RefreshValidator 控件。只需将其放在您的页面上，并在保存到数据库之前检查 Page.IsValid。您可以像其他验证器一样添加错误消息，或者如果您想做一些特别的事情，可以捕获 Refreshed 事件。由于它是一个验证器，GridViews 等已经注意到它 - 除了删除或取消操作（是的，我有一个自定义的 GridView 也可以解决这个问题......）

代码非常简单——将 GUID 存储到 ControlState 中，并将副本存储在 Session 中。在加载时，比较 2。如果它们不一样 - 那么它是一个刷新。冲洗、重复并创建一个新的 GUID 并重新开始。

```
''' <summary>
''' A validator control that detects if the page has been refreshed
''' </summary>
''' <remarks>If <see cref="SessionState.HttpSessionState" /> is not available or is reset, validator will return Valid</remarks>
Public Class RefreshValidator
   Inherits BaseValidator

   Private isRefreshed As Boolean

   Protected Overrides Sub OnInit(ByVal e As System.EventArgs)
      MyBase.OnInit(e)
      Page.RegisterRequiresControlState(Me)
   End Sub

   Protected Overrides Function SaveControlState() As Object
      Dim obj As Object = MyBase.SaveControlState()
      Return New System.Web.UI.Pair(_pageHashValue, obj)
   End Function

   Protected Overrides Sub LoadControlState(ByVal savedState As Object)
      Dim pair As System.Web.UI.Pair = TryCast(savedState, System.Web.UI.Pair)
      If pair IsNot Nothing Then
         _pageHashValue = TryCast(pair.First, String)
         MyBase.LoadControlState(pair.Second)
      Else
         MyBase.LoadControlState(savedState)
      End If
   End Sub

   Private _pageHashValue As String

   Protected Overrides Sub OnLoad(ByVal e As System.EventArgs)
      MyBase.OnLoad(e)
      If HttpContext.Current Is Nothing OrElse HttpContext.Current.Session Is Nothing Then
          isRefreshed = False
          Return
      End If

      ' Get hash value from session
       Dim currHashValue As String = CType(HttpContext.Current.Session(Me.UniqueID & ":pageHashValue"), String)

       If _pageHashValue Is Nothing OrElse currHashValue Is Nothing Then
           ' No page hash value - must be first render
           ' No current hash value. Session reset?
           isRefreshed = False
       ElseIf currHashValue = _pageHashValue Then
           ' Everything OK
           isRefreshed = False
       Else
           ' Was refreshed
           isRefreshed = True
       End If

       ' Build new values for form hash
       Dim newHashValue As String = Guid.NewGuid().ToString()
       _pageHashValue = newHashValue
       HttpContext.Current.Session(Me.UniqueID & ":pageHashValue") = newHashValue
   End Sub

   Protected Overrides Function ControlPropertiesValid() As Boolean
       Return True
   End Function

   Protected Overrides Function EvaluateIsValid() As Boolean
       If isRefreshed Then OnRefreshed(EventArgs.Empty)
       Return Not isRefreshed
   End Function

   Protected Overridable Sub OnRefreshed(ByVal e As EventArgs)
       RaiseEvent Refreshed(Me, e)
   End Sub

   ''' <summary>
   ''' Fires when page is detected as a refresh
   ''' </summary>
   Public Event Refreshed As EventHandler
End Class 
```

# billing - 例行站点更新的合理每小时费用是多少？

> ID：716197
> 
> 赞同：1
> 
> 时间：2009-04-04T00:46:53.480
> 
> 标签：billing

您认为对于您的普通站点的日常更新/管理（即信息、维护、数据库管理）而言，公平但有利可图的小时工资是多少？

你用什么因素来设定这个比率？

作为参考...我通常报价 25 美元/小时左右...我被撕了吗？

编辑：最初我希望这对一般人来说也能成为一个很好的参考……但自从有人问到 - 我在亚利桑那州图森地区。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-04T00:54:01.310

这主要取决于您在哪里/为谁工作。如果您必须经常使用大量信息对其进行更新，请按通常的方式收费。如果是一次性的，请比平时多收费一点。

PS 当对要收取多少费用有疑问时...过度充电！$$$

;-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-04T00:52:43.483

从你认为可以接受的年薪中抽取数千部分，然后加倍或三倍；这将成为您的每小时费率。我会从三倍（或更多）开始，然后从那里下降。你最好以高报价进来并逐步降低，因为（a）提高你的利率比降低它要困难得多；(b) 当他们让你失望时，客户会感到更快乐，因为他们觉得他们得到了一笔交易。

因此，每小时 25 美元对你来说很开心，每年赚 12,000 美元。

首先告诉他们你通常会报 100 美元/小时（或任何你觉得舒服的价格），如果他们不同意，就接着说，“但既然我真的很喜欢为你工作并想要你的生意，我会立即下降 10%。”

不要因为多收了他们的费用而感到难过——只要您为获得的报酬做好工作，您和您的客户都会受益。走进会议室并询问您认为是一笔惊人的金额是很困难的，但这是因为大多数极客（包括我自己！）都有一个习惯，认为我们的价值低于我们的实际价值。

而且，谁知道呢，您实际上可能会获得更高的报价。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-04T01:00:53.150

这是一个开放式问题，有很多“好吧，你可以做”，但一般来说，你会找到一个相当典型的公式（下面的天数和小时数有很多变化，所以根据你自己的指导方针选择） ：

取214天（每年节假日、假期、病假等后的工作日）。每天花8小时。将两者相乘。这是你每年的总工作时间。根据你的技能或市场价值，计算你每年想赚/觉得自己值多少钱。将该数字除以您每年的总小时数。那是你的费率。

您还可以调整利润/税收等或工作量（例如维护合同与正常的自由职业时间）。

记住，时间就是时间，不管你在做什么。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-04T01:10:00.197

我认为 25 美元/小时是一个非常低的报价，尽管这也取决于您的经验、您实际在做什么以及您住在哪里。我曾与那些急于寻找50美元以下外包的好人的公司一起工作。

公平的是，客户愿意在不觉得自己被敲诈的情况下支付的最大金额。你怎么找到这个号码？嗯，我不知道。我所见过的最有效的方法是，一家公司批量购买一段小时的时间，然后他们可以随意挖掘资源，直到时间耗尽。

# 编辑

请记住，如果您有其他工作可以赚更多钱，您需要放弃他们作为客户或提高费率。除非您愿意冒失去他们的风险，否则不要将现有客户率提高太多。

如果您确实放弃了它们，我建议您尽可能专业地进行，您永远不知道未来会怎样

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-04T01:04:34.593

IMO 进行维护我想这在很大程度上取决于您的技能/经验以及客户信任您的责任。即，一个富有的客户可能更愿意花 10 倍的钱在可以完全按照预期完成的事情上，甚至不必仔细检查它是否已完成，而小公司则更愿意省钱并花更多时间监督......

如果您想要一个准确的答案，您需要说出您所在的位置，不同地方的费率非常不同！

# drupal - Drupal 通知 - 接收重复电子邮件的用户

> ID：716205
> 
> 赞同：1
> 
> 时间：2009-04-04T00:53:34.557
> 
> 标签：drupal, email, notifications, drupal-5

我们正在使用 Drupal (5.x) 通知模块。

我们的用户收到重复的电子邮件（与论坛帖子有关）

第一封电子邮件的主题为：“Your Daily xyz Discussion Digest” 第二封电子邮件的主题为：“UserABC 的 xyz 订阅更新”

内容有些相似。（格式不同）。

试图谷歌寻求解决方案。还没有运气。

有人见过这个问题吗？有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-04T05:42:09.060

听起来像消息欺骗：

> **重复数据删除**
> 
> 也可能有多个订阅为同一事件生成多个通知。即，如果您订阅了“故事更新”并订阅了特定的线程“我的故事 1”，那么更新“我的故事 1”实际上会产生两个通知，每个订阅一个。这些在发送出去之前会经过一些重复数据删除过程，将同一事件的通知合并到一个通知中。但是，如果（且仅当）两个订阅都使用相同的发送方法和相同的发送间隔，则可以这样做。否则，您将收到两个或多个针对同一事件的不同通知。

见[http://drupal.org/node/318577](http://drupal.org/node/318577)

# javascript - 在 javascript 中测试私有函数

> ID：716207
> 
> 赞同：17
> 
> 时间：2009-04-04T00:53:47.427
> 
> 标签：javascript, unit-testing

我在 Javascript 中使用模块模式将我的公共接口与私有实现分开。为了简化我正在做的事情，我的代码生成了一个图表。该图表由多个部分（轴、标签、绘图、图例等）组成。我的代码如下所示：

```
var Graph = function() {
  var private_data;
  function draw_legend() { ... }
  function draw_plot() { ... }
  function helper_func() { ... }
  ...

  return {
    add_data: function(data) {
      private_data = data;
    },
    draw: function() {
      draw_legend()
      draw_plot()
    }
  }
} 
```

有些人主张只测试你的类的公共接口，这是有道理的，但我真的很想参加一些测试来分别测试每个组件。如果我搞砸了我的 draw_legend() 函数，我希望该测试失败，而不是对公共 draw() 函数的测试。我在这里走错了吗？

我可以将每个组件分成不同的类，例如创建一个 Legend 类。但是为有时只有 5-10 行代码创建一个类似乎很愚蠢，而且会更丑陋，因为我需要传入一堆私有状态。而且我将无法测试我的辅助功能。我应该这样做吗？我应该接受它并只测试公共draw（）吗？还是有其他解决方案？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-05T19:42:19.623

无法从外部范围访问内部函数（私有）。如果您想测试内部函数，您可能会考虑添加一个仅用于测试目的的公共方法。如果您使用某种构建环境，例如 ant，您可以预处理用于生产的 javascript 文件并删除这些测试功能。

实际上 Javascript 是一种面向对象的语言。它只是不是一个统计类型的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-29T08:44:04.143

我的解决方案只是一点点技巧。QUnit 示例：

在 Qunit 测试 html 的顶部，我已经声明：

```
var TEST_AVAILABLE = true; 
```

在可测试的类中，我有一个这样的片段：

```
if(TEST_AVAILABLE){
   this.test={
      hasDraft:hasDraft,
      isInterpIdIn:isInterpIdIn,
      // other private methods
   };
} 
```

在 QUnit 中，您可以验证

```
test( "hello booth", function() {
  var b = new Booth();
  ok(b);
  ok(b.test);
  ok(!b.test.hasDraft());
}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-08T02:46:22.750

我有一个类似的问题。我想出的解决方案不是我喜欢的，但它确实有效，而且我找不到更好的解决方案。

```
function Graph()
{
    this.Test = function _Test(expressionStr) { return eval(expressionStr); }

    var private_data;
    function draw_legend() { ... }
    function draw_plot() { ... }
    function helper_func() { ... }
    ...
} 
```

去测试：

```
var g = new Graph();
g.Test("helper_func()") == something;
g.Test("private_data") == something2 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-24T15:35:50.780

其实有一个简单的方法。您可以使用 ajax 加载脚本并注入一个公开私有函数的函数。我在[这里](http://www.sjeiti.com/unit-testing-private-functions/)有一个使用 qUnit 和 jQuery 的示例。但我确信使用纯 Javascript 也可以轻松完成相同的任务。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-04T01:05:14.687

在面向对象的语言中，您通常会通过让测试类从它正在测试的类继承来对**受保护的方法进行单元测试。**

当然，Javascript 并不是真正的面向对象语言，而且这种模式不允许继承。

我认为您要么需要公开您的方法，要么放弃对它们进行单元测试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-12-06T16:13:42.060

只有一个正确的选择：**用于测试和生产的不同构建**

1) 仅标记开发部分

```
/* test-code */
api._foo = foo
/* end-test-code */ 
```

2）稍后剥离它们......;）

```
grunt.registerTask("deploy", 
  [
    "concat",
    "strip-code",
    ... 
```

@philwalton 写了漂亮的文章：

*   如何：[https ://philipwalton.com/articles/how-to-unit-test-private-functions-in-javascript/](https://philipwalton.com/articles/how-to-unit-test-private-functions-in-javascript/)
*   为什么：[https ://philipwalton.com/articles/why-i-test-private-functions-in-javascript/](https://philipwalton.com/articles/why-i-test-private-functions-in-javascript/)

# winsock - C++ Winsock API如何在接受连接之前获取连接客户端IP？

> ID：716209
> 
> 赞同：4
> 
> 时间：2009-04-04T00:54:27.287
> 
> 标签：winsock

我正在使用 Winsock API（不是 CAsyncSocket）来创建一个侦听传入连接的套接字。

当有人尝试连接时，我怎样才能在接受连接之前获取他们的 IP 地址？我试图让它只接受来自某些 IP 地址的连接。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-09T02:07:21.500

SO_CONDITIONAL_ACCEPT 套接字选项。[这里](http://msdn.microsoft.com/en-us/library/dd264794(VS.85).aspx)

此外，很确定它在 XP 和 Server 2003 中可用，而不仅仅是在 Vista 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T18:42:45.873

使用 ATM 时，CONNECT ACK 数据包将来自最近的交换机，而不是最终客户端。因此，您必须在套接字上调用 accept()，然后查看地址（基于传递的 addr_family），然后关闭套接字。当它到达请求者时，它可能只会失败。

而且我不确定您认为这会占用多少资源，但接受连接处于非常低的水平，并且不会成为真正的问题。丢弃它们很容易。

如果您受到 DoS 攻击，您的代码可以在预设的时间内退出侦听，因此如果您非常担心，攻击者只会失败。

客户端是否知道有一个套接字正在侦听真的很重要吗？尝试使用 telnet 连接到端口 137 上的本地主机，看看 Windows 中的文件共享断开连接的速度有多快......（如果你启用了它，并且我记得正确的端口号......呵呵......）

但是，在 SOCKET 级别，您将无法做您想做的事。您正在谈论深入到 TCP 级别，查看传入的连接请求，并在那里处理它们。

这是可以做到的，但是您正在谈论一个内核驱动程序来做到这一点。我不确定您是否可以在用户模式下执行此操作。

如果您需要内核帮助，请告诉我。我也许可以给你一些例子，或者指导。

只有我自己的两分钱，而且 IMVHO ......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-04T01:45:24.260

我不想接受连接以检查远程 IP 地址的两个原因：

1）。客户端会看到此端口上有一个侦听套接字。如果我决定拒绝客户端连接，我不希望他们知道有一个套接字正在侦听此端口。

2）。这种技术效率不高，需要更多的 CPU、RAM 和网络使用；所以在拒绝服务攻击的情况下是不好的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-04T00:57:24.017

接受连接，查看IP，如果不允许，关闭连接

**编辑**：

我假设你在谈论 TCP 连接。当您侦听端口并且连接来自客户端时，API 将执行 TCP 3 次握手，并且客户端将知道正在侦听此端口。

我不确定是否有办法阻止发送任何数据包（即接受连接），以便您可以先查看 IP 地址然后再决定。

我能想到的唯一方法是在网络层根据源IP进行包过滤（例如使用防火墙）。

# forms - 如何在 SharePoint 中创建修改查询字符串的表单

> ID：716216
> 
> 赞同：1
> 
> 时间：2009-04-04T00:58:04.173
> 
> 标签：forms, sharepoint, get

我的要求很简单。

我想在 Sharepoint 页面上放置一个表单（比方说是一个文本字段），并带有一个提交按钮。

当我提交时，我希望将 URL 与`s="textfromtextfield"`.

假设我在一个 url`http://site/site.aspx?p=x`点击提交将带我到：

```
http://site/site.aspx?p=x&s="textfromtextfield" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-04T01:36:13.113

您很可能希望在 SharePoint Designer 中打开页面并添加/播放表单操作。检查此页面以获取详细信息（而不是尝试逐步传达它）：

~~[http://office.microsoft.com/en-us/sharepointdesigner/HA101191121033.aspx](http://office.microsoft.com/en-us/sharepointdesigner/HA101191121033.aspx)~~

供参考。SharePoint Designer 现在可以从 Microsoft 免费下载。

如果您从未在 SharePoint Designer 中编辑过表单，这可能会有所帮助：

[http://office.microsoft.com/en-us/sharepointdesigner/HA101191141033.aspx](http://office.microsoft.com/en-us/sharepointdesigner/HA101191141033.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-12-05T11:26:19.277

如果此按钮“完全属于您”并且不是共享点控件之一，您可以尝试在服务器端的按钮单击处理方法上编写以下代码。

```
Page.Response.Redirect(newUrl, true); 
```

# c++ - 用于磁盘支持的关联阵列的 Sqlite？

> ID：716221
> 
> 赞同：1
> 
> 时间：2009-04-04T00:59:46.913
> 
> 标签：c++, sql, database, sqlite, persistence

我想将 SQLite 用作保存到磁盘的关联数组。

这是一个好主意吗？我担心每次执行以下操作时都必须解析 SQL：

**database["someindex"]**必须被翻译成类似的东西

**select value from db where index = 'someindex'**这又必须被翻译成 SQL 内部语言。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-04T01:06:45.070

如果您担心 SQL 开销并且只需要一个简单的关联数组，那么可能像 GDBM 或 Berkeley DB 这样的 dbm 亲戚是一个不错的选择？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T01:29:32.897

查看 sqlite 参数以获得变量 <-> sql 的简单方法

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-04T01:50:38.693

SQLite 作为基于磁盘的关联数组应该非常快。请记住使用[准备好的语句](http://www.sqlite.org/c3ref/stmt.html)，它会解析和编译一次 SQL 以多次调用；它们对[SQL 注入攻击](http://en.wikipedia.org/wiki/SQL_injection)也更安全。如果你这样做，你应该从 SQLite 中获得相当不错的性能。

对于简单的基于磁盘的关联阵列，另一种选择是文件系统；这是一个非常流行的基于磁盘的关联阵列。在文件系统上创建一个目录，每个条目使用一个密钥。如果您需要超过几百个，则为每个键的两个字符前缀创建一个目录，以使每个目录的文件数量保持在合理范围内。如果您的密钥作为文件名不安全，请使用 SHA-1 或 SHA-256 或其他方式对它们进行哈希处理。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-04T01:33:42.167

这真的取决于你的实际问题。您的问题陈述非常通用，并且高度依赖于哈希表的大小。

对于小型哈希表，您只打算在您实际上更喜欢文本文件（便于调试）时读取和写入。

例如，如果您的哈希表小于 25meg，那么 SQLite 可能对您很有效

# javascript - 如何使 DIV 无法聚焦？

> ID：716235
> 
> 赞同：16
> 
> 时间：2009-04-04T01:08:09.763
> 
> 标签：javascript, html, focus

我遇到了一个关于 HTML 渲染的问题。

在 IE7 的 dir="rtl" 文档中，当 JavaScript 尝试将焦点设置到 DIV 元素（使用 oElement.focus() 方法）时，呈现变得混乱。上下文非常复杂，所以我想最简单的解决方法是让 DIV 无法聚焦？

有什么办法可以让 DIV 不被聚焦？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-04-04T01:40:57.330

**除非您添加了tabIndex**，`<div>`否则不应获得焦点。

 **如果已添加`tabIndex`，则应通过以下方式将其删除

```
document.getElementById("yourElement").removeAttribute("tabIndex"); 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-02-02T10:03:10.080

**此外**，如果您想将可聚焦元素（表单输入元素等）设为不可聚焦。您可以设置：

```
tabIndex = "-1"

document.getElementById("yourElement").setAttribute("tabIndex", "-1"); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-04T01:17:44.123

我不确定您是否可以使元素“不可聚焦”，但您当然可以使用它的[`blur`](https://developer.mozilla.org/En/DOM:element.blur)方法在特定时间点将其取消聚焦：

```
document.getElementById("myElement").blur(); 
```

**编辑：**

我认为您可以通过在每次聚焦时散焦来使元素“无法聚焦”。您可以通过以下方式完成此操作：

```
document.getElementById("myElement").onfocus = function() {
    this.blur();
}; 
```

...或（在您的 HTML 中使用内联 Javascript）：

```
<div onfocus="this.blur();"></div> 
```

史蒂夫

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-20T09:49:41.647

**下面是使用 jquery 使 DIV 无法聚焦的一些方法。**

```
 //  Set the tabindex atribute to -1.
        1)$("divid").attr('tabindex','-1');
    //  Remove the tabindex atribute if exists.
        2) $("divid").removeAttr('tabindex');
   //   This is third way.
        3) $("divid").blur(); 
```

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2019-11-19T17:09:20.137

一个简单的修复可以通过添加 CSS 来完成：

```
div_selector{
    pointer-events: none;
} 
```

或者通过 jQuery 添加相同的 css：

`$(div_selector).css('pointer-events', 'none');`

# c# - 迭代器和枚举器的区别

> ID：716238
> 
> 赞同：80
> 
> 时间：2009-04-04T01:09:33.113
> 
> 标签：c#, .net, iterator, generator, enumeration

.NET 3.5 工作的面试问题是“迭代器和枚举器有什么区别”？

这是一个核心区别，LINQ 等等。

无论如何，有什么区别？我似乎无法在网上找到一个可靠的定义。毫无疑问，我可以找到这两个术语的含义，但我得到的答案略有不同。面试的最佳答案是什么？

IMO 一个迭代器“迭代”一个集合，而一个枚举器提供了迭代的功能，但这必须被调用。

此外，据说使用 yield 关键字可以保存状态。这个状态究竟是什么？有这种好处发生的例子吗？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-04-04T01:16:45.157

迭代意味着重复一些步骤，而枚举意味着遍历值集合中的所有值。所以枚举通常需要某种形式的迭代。

这样，枚举是迭代的一种特殊情况，其中步骤从集合中获取值。

请注意“通常”——枚举也可以递归执行，但递归和迭代是如此密切相关，以至于我不会关心这个微小的差异。

您还可以枚举未明确存储在集合中的值。例如，您可以枚举自然数、素数或其他任何内容，但您将在枚举期间计算这些值，而不是从物理集合中检索它们。您将这种情况理解为枚举一个虚拟集合，其值由某些逻辑定义。

* * *

我认为 Reed Copsey 明白了这一点。在 C# 中有两种主要的枚举方式。

1.  实现`Enumerable`和类实现`IEnumerator`
2.  `yield`使用语句实现迭代器

第一种方法更难实现，并且使用对象进行枚举。第二种方式更容易实现并使用延续。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2009-04-04T01:18:22.797

在 C# 2+ 中，[迭代器](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/iterators)是编译器为您自动生成 IEnumerable 和/或 IEnumerable<T> 接口的一种方式。

如果没有迭代器，您将需要创建一个实现[IEnumerator](http://msdn.microsoft.com/en-us/library/78dfe2yb(VS.80).aspx)的类，包括 Current、MoveNext 和 Reset。这需要相当多的工作。通常，您将创建一个为您的类型实现 IEnumerator<T> 的私有类，然后 yourClass.GetEnumerator() 将构造该私有类并返回它。

迭代器是编译器使用简单语法（yield）自动为您生成它的一种方式。这使您可以直接在您的类中实现 GetEnumerator()，而无需您指定第二个类（IEnumerator）。该类及其所有成员的构造已为您完成。

迭代器对开发人员非常友好——事情以一种非常有效的方式完成，而且工作量少得多。

当您使用 foreach 时，两者的行为将相同（前提是您正确编写了自定义 IEnumerator）。迭代器只是让生活变得更简单。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-10-27T11:50:48.387

C# 所称的**迭代器**更常见（在 C# 世界之外）称为[**生成器**](http://en.wikipedia.org/wiki/Generator_(computer_science))或**生成器函数**（例如在 Python 中）。生成器函数是[**协程**](http://en.wikipedia.org/wiki/Coroutine)的一种特殊情况。**AC#迭代器（生成器）是枚举**器（实现`IEnumerable`接口的数据类型）的一种特殊形式。

我不喜欢将术语迭代器用于 C# 生成器的这种用法，因为它既是一个枚举器，也是一个迭代器。微软改变主意为时已晚。

相比之下，在 C++ 中，迭代器是一个值，主要用于访问集合中的顺序元素。可以对其进行高级、取消引用以检索值，并对其进行测试以查看是否已到达集合的末尾。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2014-07-23T01:28:12.960

“而 foreach 语句是枚举器的消费者，而迭代器是枚举器的生产者。”

以上是“C# 5.0 In A NutShell”的解释，对我很有帮助。

换句话说，foreach 语句使用 MoveNext() 和 IEnumerator 的 Current 属性来迭代序列，而迭代器用于生成将由 foreach 语句使用的 IEnumerator 的实现。在 C# 中，当您编写包含 yield 语句的迭代器方法时，编译器将为您生成一个私有枚举器。当您遍历序列中的项目时，它将调用私有枚举器的 MoveNext() 和 Current 属性。这些方法/属性由迭代器方法中的代码实现，迭代器方法将被重复调用以产生值，直到没有值可供产生。

这是我对 C# 如何定义枚举器和迭代器的理解。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-04-04T01:25:23.687

要了解迭代器，我们首先需要了解枚举器。

枚举器是专门的对象，它为人们提供了一次通过一个有序的项目列表的方法（同一类型的东西有时称为“光标”）。.NET 框架提供了两个与枚举器相关的重要接口：IEnumerator 和 IEnumerable。实现 IEnumerator 的对象本身就是枚举器；他们支持以下成员：

*   属性 Current，它指向列表中的一个位置

*   方法 MoveNext，它将当前项目沿列表移动一个

*   方法 Reset，将当前项目移动到其初始位置（在第一个项目之前）。

另一方面，迭代器实现了枚举器模式。.NET 2.0 引入了迭代器，它是一个编译器显示的枚举器。当可枚举对象直接或间接调用 GetEnumerator 时，编译器会生成并返回适当的迭代器对象。可选地，迭代器可以是可枚举和枚举器对象的组合。

迭代器块的基本组成部分是 yield 语句。迭代器和枚举器之间有一个很大的区别：迭代器不实现 Reset 方法。在迭代器上调用 Reset 方法会导致异常。

迭代器的重点是允许简单地实现枚举器。如果一个方法需要返回一个枚举数或一个可枚举类来返回一个有序的项目列表，它被编写成使用'yield'语句以正确的顺序返回每个项目。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2011-02-02T18:28:42.847

由于没有给出例子，这里有一个对我有帮助的例子。

枚举器是在实现 IEnumerator 接口的类或类型上调用 .GetEnumerator() 时获得的对象。实现此接口时，您已创建编译器所需的所有代码，以使您能够使用`foreach`“迭代”您的集合。

不要把“迭代”这个词与迭代器混淆。枚举器和迭代器都允许你“迭代”。枚举和迭代基本上是相同的过程，但实现方式不同。枚举意味着你已经实现了 IEnumerator 接口. 迭代意味着您已经在您的类中创建了迭代器构造（如下所示），并且您正在调用`foreach`您的类，此时编译器会自动为您创建枚举器功能。

另请注意，您不必对枚举器进行深蹲。你可以`MyClass.GetEnumerator()`整天打电话，什么也不做（例如：

`IEnumerator myEnumeratorThatIWillDoNothingWith = MyClass.GetEnumerator()`）。

还要注意，您的类中的迭代器构造只有在您实际使用它时才会真正使用，即您已经调用`foreach`了您的类。

[这是来自msdn](http://msdn.microsoft.com/en-us/library/dscyy5s0.aspx)的迭代器示例：

```
public class DaysOfTheWeek : System.Collections.IEnumerable
{

     string[] days = { "Sun", "Mon", "Tue", "Wed", "Thr", "Fri", "Sat" };

     //This is the iterator!!!
     public System.Collections.IEnumerator GetEnumerator()
     {
         for (int i = 0; i < days.Length; i++)
         {
             yield return days[i];
         }
     }

}

class TestDaysOfTheWeek
{
    static void Main()
    {
        // Create an instance of the collection class
        DaysOfTheWeek week = new DaysOfTheWeek();

        // Iterate with foreach - this is using the iterator!!! When the compiler
        //detects your iterator, it will automatically generate the Current, 
        //MoveNext and Dispose methods of the IEnumerator or IEnumerator<T> interface
        foreach (string day in week)
        {
            System.Console.Write(day + " ");
        }
    }
}
// Output: Sun Mon Tue Wed Thr Fri Sat 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-04-04T01:12:30.003

“迭代器是 C# 2.0 中的一项新功能。迭代器是一种方法、get 访问器或运算符，使您能够支持类或结构中的 foreach 迭代，而无需实现整个 IEnumerable 接口。相反，您只提供一个迭代器，它简单地遍历你类中的数据结构，当编译器检测到你的迭代器时，它会自动生成IEnumerable或IEnumerable接口的Current、MoveNext和Dispose方法。[-msdn](http://msdn.microsoft.com/en-us/library/dscyy5s0(VS.80).aspx) _

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-04T01:11:34.437

枚举处理对象，而迭代只处理值。当我们使用向量哈希表等时会使用枚举，而在 while 循环中使用迭代时会使用 for 循环等。我从未使用过 yield 关键字，所以我无法告诉你。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-06-27T19:21:00.687

迭代处理**数组**和**字符串**，而枚举处理**对象**

在 JavaScript 中，您可以使用以下命令迭代数组或字符串：

*   *forEach*循环
*   *for*循环
*   *for*循环
*   *做while*循环
*   *while*循环

你可以枚举一个对象：

*   *for in*循环
*   *Object.keys()*方法
*   *Object.values()*方法
*   *Object.entries()*方法

# version-control - 变更的受控集成与持续集成

> ID：716242
> 
> 赞同：2
> 
> 时间：2009-04-04T01:11:18.883
> 
> 标签：version-control, continuous-integration, visual-sourcesafe, release-management

我有一个我们之前使用 nAnt 脚本构建的 NSIS 安装程序，它复制一些文件并通过 exec 任务运行 makensis.exe 来构建安装程序 exe。在 nant 脚本完成后，我有了 CD 的完整结构和下载。

我只是从 sourcesafe 获取到一个未使用的桌面并将其用作构建框，在那里编译。有时我们会检查几个文件来修复一些关键问题。在这些情况下，我会去构建框，并且非常有选择地只获取那些文件，以避免获取我们尚未准备好发布的其他已更改文件。基本上，我能够允许开发继续并有选择地将某些更改的文件包含到安装程序中以供发布。

现在我们不再有免费的盒子，需要从我们的服务器构建。所以我正在设置 CI 工厂，以便开发人员可以在不远程连接到服务器的情况下启动构建。我正在努力解决的一个问题是继续允许这种选择性变更控制发生的最佳方式。CI Factory 实现的默认 CI 概念非常适合内部开发“负责人”。但是，我还想为这种“公开发布”类型的构建设置一个仅通过强制构建按需运行的 CCNet 项目。

到目前为止，这就是我的头脑风暴，但不确定它的效果如何，如果有的话（仍在弄清楚 CCNet 和 CI 工厂的全部内容）。将设置“公开发布”CCNet 项目配置/构建，使其**不会**最新。修改**不会**触发构建。由于另一个 CCNet 项目使用默认的 CI 方法（我们将其称为“CI 项目”）在检测到更改时获取最新信息，因此这两个项目不能共享同一个工作目录。所以“公开发布”需要一个不同的工作副本，这样当 CI 项目的构建被触发时，它的文件就不会被更新。开发人员需要远程访问服务器，一个 VSS，有选择地进入“公共发布”的工作副本，然后通过 CI 工厂强制构建。

我看到的缺点是
1) 必须远程访问才能有选择地进行获取。
2) 我不知道如何允许单个 CI 工厂项目拥有 Product 文件夹的两个不同工作副本，以便每个项目配置块都有自己的。
3）我担心这可能会导致什么样的奇怪。我还不太确定如何在 CCNet 项目配置块中指定源代码控制块，但要防止它在构建时执行最新操作。我仍在逐渐弄清楚脚本中的内容，并且可以在不破坏其他内容的情况下轻松取出，而不是那些不应该被弄乱和/或不可配置的东西。

如果您有类似的情况，我真的很想听听其他人如何处理选择性发布更改的问题。我受限于 VSS，所以我迫切需要考虑到这一点来解决这个问题，但同时我很想听听您如何使用其他源代码控制系统来管理这个问题。我猜你可能会有一个分支是你最新的开发分支，然后在你想发布它们时将更改合并到主干中？我真的不相信 VSS 进行分支/合并，我认为分支概念对于这家商店来说可能有点过多的开销和学习曲线。就像我说的那样，其他源代码控制系统的故事对我来说是有用的未来知识。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-04T01:17:05.453

您需要在存储库中使用分支结构来促进这一点。类似于发布分支方法。只有选择的个人可以提交到这个分支（或者有一个发布/稳定版）。设置您的手动 CI 启动以从发布分支中提取，因为每晚发布从那里提升到里程碑或最终版本。我不喜欢在你的构建机器上手动修改东西的想法。在版本控制中设置更改，在一个安全的地方准备发布并让 CI 从那里构建，但手动触发。

查看这些[分支模式](http://www.cmcrossroads.com/bradapp/acme/branching/)。我建议使用 C3，即每次发布的代码行，通常称为发布分支。

这是[一篇](http://www.kevingao.net/sourcesafe/branch-in-sourcesafe-vss.html)关于 VSS 分支的文章，其中包含一个合并链接。

这个[问题](https://stackoverflow.com/questions/404948/practical-way-to-commit-changes-in-source-control-to-multiple-branches)看起来很相似。

也许你可以转移到另一个对这种事情有更好支持的源代码控制系统。那里的MS人员有什么建议吗？

# c# - LINQ：从 IQueryable 中删除项目

> ID：716247
> 
> 赞同：5
> 
> 时间：2009-04-04T01:14:06.287
> 
> 标签：c#, linq, linq-to-sql, collections, iterator

我想在使用它进行数据绑定之前从 LINQ 查询的结果中删除一个项目。这样做的正确方法是什么？

我插图中的 foreach 是我的问题的主题。插图：

```
var obj =
    (from a in dc.Activities
    where a.Referrer != null
    && a.Referrer.Trim().Length > 12
    && a.Session.IP.NumProblems == 0
    && (a.Session.UID == null || a.Session.UID < 1 || a.Session.User.BanLevel < 1)
    select a)
    .Take(int.Parse(ConfigurationManager.AppSettings["RecentItemQty"]));
foreach (Activity act in obj)
    if (isDomainBlacklisted(ref dc, act.Referrer))
        obj.Remove(act); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-04T01:24:30.350

您不需要 foreach 就可以使用它...

```
obj.RemoveAll(act => isDomainBlackListed(ref dc, act.Referrer)); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-04T01:44:54.950

您可以将其放在查询的末尾以在它们最终出现在结果之前将它们过滤掉：

```
var obj =
   (from a in dc.Activities
   where a.Referrer != null
   && a.Referrer.Trim().Length > 12
   && a.Session.IP.NumProblems == 0
   && (a.Session.UID == null || a.Session.UID < 1 || a.Session.User.BanLevel < 1)
   select a)
   .Take(int.Parse(ConfigurationManager.AppSettings["RecentItemQty"]))
   .Where(a => !isDomainBlacklisted(ref dc, a.Referrer)); 
```

如果您希望其他项目替换过滤掉的项目，您可以将其放在`Where`前面，但这当然意味着对 isDomainBlacklisted 的更多调用。`Take`

# deployment - 如何编写可部署的软件？

> ID：716248
> 
> 赞同：3
> 
> 时间：2009-04-04T01:15:21.947
> 
> 标签：deployment, installation

我是一名 Unix 系统管理员出身的程序员，因为目前这对我来说很重要，所以想听听一些最好和最差的实践，在编写软件方面，以便于部署、升级，并保持长期。我不是在谈论代码本身的长期维护；相反，您使用什么准则来防止您的软件变成无法安装的烂摊子？

我目前最讨厌的是硬编码配置。我正在与我们的开发团队进行全职工作，以简化我们的应用程序的部署，以便我可以完全自动化部署过程的每一步。这些应用程序的大部分配置实际上都是硬编码的，无论是在构建时还是在代码库中，这使得在服务器上实际设置软件的过程非常非常痛苦。

幸运的是，我全职演出的团队很有才华，并且和我一样希望看到这个问题得到解决，所以事情进展顺利。

至于“最佳实践”，从 Unix 的角度来看，当软件是或可以是自包含的时，我真的很喜欢它。因此，我应该能够将应用程序安装到目录中，然后能够移动该目录而不会导致应用程序完全失控。这实际上只需要一点启动路径检测，它让我作为系统管理员的生活变得更加美好。

有哪些方法可以简化服务器类型应用程序的部署过程（在 Windows 和 Unix 上），同样，在推送代码时，您遇到的哪些事情变成了真正的噩梦出门？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-04T01:19:38.677

1-管理您的外部依赖 - 如果您假设文件必须位于 x，则使 x 可配置。或者以相对路径为例。

2-不要硬编码配置。

3-避免二进制依赖（来自 Windows 的 COM 和 DLL 地狱日）

4-自动化它或让它变得如此简单，一只脑死亡的猴子可以在睡梦中完成它。例如，现在我要做的就是解压缩一个文件并部署我的 Web 应用程序，我有一个需要运行的 sql 脚本并处理数据库。只需单击几下...并且绝对不需要进行任何配置更改，这都应该是脚本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-04T01:40:07.440

遵循[文件系统层次标准](http://www.pathname.com/fhs/pub/fhs-2.3.html)。让应用程序完全独立（二进制文件、配置、头文件、库都在一个目录中）打破了该标准，这使得处理许多事情变得更加痛苦。

`./configure`, `make`, `make install`（如果您需要不同的构建系统，则为适当的变体）应该是安装程序的步骤。`configure`应该找到任何依赖项，启用或禁用任何可选功能，并允许设置`--prefix`（和`exec-prefix`、、`bindir`等）为各种组件选择适当的安装位置。有关更多信息，请参阅[GNU 编码标准](http://www.gnu.org/prep/standards/standards.html#Managing-Releases)（我不同意所有 GNU 编码标准，但关于`configure`应该如何工作的建议很好）。

包括`man`描述程序采用的所有命令行选项的页面。您可以在其他地方获得更好的文档（`info`、HTML 等），但我应该能够将其`man`用作命令行选项的快速参考。不要像`GNU`在某些页面中只放置存根`man`，并带有指向`info`文档的指针以获取更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T08:46:34.107

忏悔：我点击了这个问题，上面写着“如何编写*可悲*的软件？” 但现在我来了，我应该拍一拍……

我想知道从敏捷书中学习是否会有所帮助？在较短的迭代中工作（比如一到四个星期），并确保在每次迭代结束时进行部署。这样，您就会被驱使真正擅长部署您的应用程序 - 如果花费的时间太长，您将无法完成其他任何事情。已部署应用程序的问题在遇到时会从用户社区反馈，并且可以优先处理后续迭代。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-04T01:43:55.217

软件设计和环境的稳定性都很大程度上决定了软件的可部署性。每个应用程序都应该是可配置的，并使应用程序习惯于拥有一个启动脚本来验证其环境并产生有意义的错误消息。控制对服务器的访问，并坚持修改这些服务器的团队已在稳定的测试环境中完成了应有的测试。成为测试环境的拥护者。应用程序团队所做的更改应尽可能编写脚本，包括实施计划、验证计划、撤销计划和撤销验证计划。提供一个可以自动清理临时文件和工件的地方。/u/spool/01 每天都会被清理干净。/u/spool05 每五天清理一次。/u/spool30 每三十天清理一次。如果许多应用程序共享同一个服务器，Consier 静态链接共享代码。避免老鼠窝的链接。避免共享安装。冠军伐木标准。将您的测试系统与生产系统隔离开来。创建标准以不写入当前目录或一组固定目录之外。在部署的二进制文件和它所来自的源管理系统之间建立清晰的联系。监控服务器的失控进程、填充磁盘和网络连接。对权限位严格要求。找出奖励系统正常运行时间的方法。创建标准以不写入当前目录或一组固定目录之外。在部署的二进制文件和它所来自的源管理系统之间建立清晰的联系。监控服务器的失控进程、填充磁盘和网络连接。对权限位严格要求。找出奖励系统正常运行时间的方法。创建标准以不写入当前目录或一组固定目录之外。在部署的二进制文件和它所来自的源管理系统之间建立清晰的联系。监控服务器的失控进程、填充磁盘和网络连接。对权限位严格要求。找出奖励系统正常运行时间的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-04T02:14:23.380

我建议您将部署和维护都视为需要测试的场景，就像测试软件的操作方面一样。

当发现一个错误时，应该创建一个回归测试，也许还有单元测试。同样，当客户对软件的部署或维护有问题时，如果它更多的是软件问题而不是文档或培训问题，则应在测试计划中添加测试以确保问题不再发生。

当然，就这些测试可以自动化的程度而言，它们至少应该在每晚构建之后运行；充其量在每个持续集成构建中。至少，产品的安装脚本或安装程序应该在将应用程序部署到将要测试的 QA 机器上时运行。

# c# - 在 C# 中创建循环链表？

> ID：716256
> 
> 赞同：28
> 
> 时间：2009-04-04T01:18:33.593
> 
> 标签：c#, linked-list, addressbook

在 C# 中创建循环链表的最佳方法是什么。我应该从 LinkedList< T> 集合中派生它吗？我正计划使用此链接列表创建一个简单的地址簿来存储我的联系人（这将是一个糟糕的地址簿，但我不在乎，因为我将是唯一使用它的人）。我主要只是想创建关键链接列表，以便我可以在其他项目中再次使用它。

如果您认为链接列表不是正确的方法，请告诉我哪种方法会更好。

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2010-04-19T19:29:42.870

由于这些答案中的大多数实际上并没有真正解决问题的实质，而仅仅是意图，因此也许这会有所帮助：

据我所知，链接列表和循环链接列表之间的唯一区别是迭代器在到达列表末尾或开头时的行为。支持循环链接列表行为的一种非常简单的方法是为 LinkedListNode 编写扩展方法，如果不存在此类节点，则返回列表中的下一个节点或第一个节点，类似地用于检索前一个节点或最后一个节点如果不存在这样的节点，则为一个。下面的代码应该可以做到这一点，虽然我还没有测试过：

```
static class CircularLinkedList {
    public static LinkedListNode<T> NextOrFirst<T>(this LinkedListNode<T> current)
    {
        return current.Next ?? current.List.First;
    }

    public static LinkedListNode<T> PreviousOrLast<T>(this LinkedListNode<T> current)
    {
        return current.Previous ?? current.List.Last;
    }
} 
```

现在您可以只调用 myNode.NextOrFirst() 而不是 myNode.Next，您将拥有循环链表的所有行为。您仍然可以在列表中的所有节点之前和之后进行恒定时间删除和插入等。如果我缺少循环链表的其他关键位，请告诉我。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-04T01:23:06.593

从 BCL LinkedList 类派生可能不是一个好主意。该类被设计为一个非循环列表。试图让它循环只会给你带来问题。

你自己写可能会好得多。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-04T01:22:04.737

我不认为循环链表是联系人列表的正确数据结构。一个简单的 List<> 或 Collection<> 就足够了。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-04T01:23:31.007

您是否有使用循环链表（即作业）的特定要求？如果没有，我建议使用简单`List<T>`类来存储您的联系人。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-04T02:52:04.677

循环链接列表通常使用数组实现，这使得它们非常快，并且本质上不需要动态调整大小。您只需要快速检查读取和写入索引，看看它们是否从末端脱落，如果是，请将其重置为零（或一，等等）。

但是，它们通常用于输入缓冲区之类的东西，其中数据一旦读取就没有实际价值。联系人列表具有持久的价值，一旦列表填满，新联系人将覆盖旧联系人，这可能没问题，除非你覆盖你的祖母，她会给你留下一大笔现金。

* * *

我不认为链表是循环缓冲区的最有效方法（原始问题）。

循环缓冲区的目的是提高速度，而在循环缓冲区的上下文中，数组根本无法超越速度。即使您保留指向上次访问的链表项的指针，数组仍然会更有效。列表具有循环缓冲区不需要的动态调整大小功能（开销）。话虽如此，我认为循环缓冲区可能不是您提到的应用程序（联系人列表）的正确结构。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-02-26T19:18:13.817

```
class CircularArray<T> : IEnumerator<T>
{
    private readonly T[] array;
    private int index = -1;
    public T Current { get; private set; }

    public CircularArray(T[] array)
    {
        Current = default(T);
        this.array = array;
    }

    object IEnumerator.Current
    {
        get { return Current; }
    }

    public bool MoveNext()
    {
        if (++index >= array.Length)
            index = 0;
        Current = array[index];
        return true;
    }

    public void Reset()
    {
        index = -1;
    }

    public void Dispose() { }
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-05-19T08:38:46.900

基于模数的解决方案。

如果循环缓冲区被实现为原始数组（或任何其他类型的集合）

```
T[] array; 
```

并且我们存储到`int current_index`当前项的索引中，我们可以循环上下缓冲区如下：

```
T NextOrFirst()
{
    return array[(current_index + 1) % array.Length];
}

T PreviousOrLast()
{
    return array[(current_index + array.Length - 1) % array.Length];
} 
```

相同的方法可用于任何 XAML 绑定集合。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-04T01:24:31.863

[这个基于 CList 的循环列表](http://www.dotnetheaven.com/Uploadfile/bulentozkir/jose04202005072901AM/jose.aspx)怎么样。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-11-13T01:34:43.503

我认为这个问题最正确的数据结构是循环双向链表。使用此数据结构，您可以通过联系人列表自由上下

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-03-31T04:09:22.090

```
class Program
{
    static void Main(string[] args)
    {
        int[] numbers = { 1, 2, 3, 4, 5, 6, 7 };

        IEnumerable<int> circularNumbers = numbers.AsCircular();

        IEnumerable<int> firstFourNumbers = circularNumbers
            .Take(4); // 1 2 3 4

        IEnumerable<int> nextSevenNumbersfromfourth = circularNumbers
            .Skip(4).Take(7); // 4 5 6 7 1 2 3 
    }
}

public static class CircularEnumerable
{
    public static IEnumerable<T> AsCircular<T>(this IEnumerable<T> source)
    {
        if (source == null)
            yield break; // be a gentleman

        IEnumerator<T> enumerator = source.GetEnumerator();

        iterateAllAndBackToStart:
        while (enumerator.MoveNext()) 
            yield return enumerator.Current;

        enumerator.Reset();
        if(!enumerator.MoveNext())
            yield break;
        else
            yield return enumerator.Current;
goto iterateAllAndBackToStart;
    }
} 
```

如果您想走得更远，请制作 a`CircularList`并按住相同的枚举器以跳过`Skip()`示例中的旋转时的 。

# python - Python中的矩阵

> ID：716259
> 
> 赞同：6
> 
> 时间：2009-04-04T01:21:36.767
> 
> 标签：python, matrix

昨天我需要 Python 中的矩阵类型。

显然，对这种需求的一个简单的答案是使用`numpy.matrix()`，但我遇到的另一个问题是我想要一个矩阵来存储具有混合类型的任意值，类似于列表。`numpy.matrix`不执行此操作。一个例子是

```
>>> numpy.matrix([[1,2,3],[4,"5",6]])
matrix([['1', '2', '3'],
        ['4', '5', '6']], 
       dtype='|S4')
>>> numpy.matrix([[1,2,3],[4,5,6]])
matrix([[1, 2, 3],
        [4, 5, 6]]) 
```

如您所见，`numpy.matrix`内容必须是同质的。如果我的初始化中存在字符串值，则每个值都会隐式存储为字符串。这也可以通过访问单个值来确认

```
>>> numpy.matrix([[1,2,3],[4,"5",6]])[1,1]
'5'
>>> numpy.matrix([[1,2,3],[4,"5",6]])[1,2]
'6' 
```

现在，Python 列表类型可以改为接受混合类型。您可以拥有一个包含整数和字符串的列表，两者都保留它们的类型。我需要的是类似于列表的东西，但以类似矩阵的行为运行。

因此，我必须实现自己的类型。对于内部实现，我有两种选择：包含列表的列表和字典。两种解决方案都有缺点：

*   列表列表需要仔细同步各种列表的大小。交换两行很容易。交换两列不太容易。删除一行也很容易。
*   字典（以元组作为键）稍好一些，但您必须定义键的限制（例如，如果您的矩阵是 3x3，则不能插入元素 5,5），并且它们使用起来更复杂、删除或交换列或行。

编辑：澄清。我需要这个功能的具体原因是因为我正在阅读 CSV 文件。从 CSV 文件中收集值（可以是字符串、整数、浮点数）后，我想执行交换、删除、插入和其他类似操作。出于这个原因，我需要一个“矩阵列表”。

我的好奇心是：

*   您知道提供此服务的 Python 数据类型是否已经存在（可能在“不包含电池”的库中）？
*   为什么标准库中没有提供这种数据类型？可能是太受限的兴趣？
*   你会如何解决这个需求？字典、列表或其他更智能的解决方案？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-04T01:38:21.347

如果你`dtype`是，你可以有不均匀的类型`object`：

```
In [1]: m = numpy.matrix([[1, 2, 3], [4, '5', 6]], dtype=numpy.object)
In [2]: m
Out[2]: 
matrix([[1, 2, 3],
        [4, 5, 6]], dtype=object)
In [3]: m[1, 1]
Out[3]: '5'
In [4]: m[1, 2]
Out[4]: 6 
```

除了花哨的索引之外，我不知道这对你有什么好处，因为正如 Don 指出的那样，你不能用这个矩阵做数学运算。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-04T01:27:36.567

我很好奇你为什么想要这个功能；据我了解，拥有矩阵（在 numpy 中）的原因主要是为了进行线性数学（矩阵变换等）。

我不确定小数和字符串乘积的数学定义是什么。

在内部，您可能希望查看稀疏矩阵实现（[http://www.inf.ethz.ch/personal/arbenz/pycon03_contrib.pdf](http://www.inf.ethz.ch/personal/arbenz/pycon03_contrib.pdf)）。有很多方法可以做到这一点（散列、列表、链表），每种方法都有自己的优点和缺点。如果您的矩阵不会有很多空值或零，那么您可以放弃稀疏实现。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-04T02:37:53.120

你看过 numpy.recarray 功能吗？

例如这里：http://docs.scipy.org/doc/numpy/reference/generated/numpy.recarray.html

它旨在允许具有混合数据类型的数组。

我不知道数组是否适合您的目的，或者您是否真的需要矩阵 - 我没有使用过 numpy 矩阵。但是如果一个数组足够好，recarray 可能会起作用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-11-06T11:49:11.083

也许这是一个迟到的答案，但是，为什么不使用[pandas](http://pandas.pydata.org/)呢？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-03-20T20:28:20.750

看看 sympy——它在矩阵的多态性方面做得很好，你可以对 col_swap、col_insert、col_del 等 sympy.matrices.Matrix 对象进行操作......

```
在 [2] 中：将 sympy 导入为 s
在 [6] 中：将 numpy 导入为 np

在 [11] 中：npM = np.array([[1,2,3.0], [4,4,"abc"]], dtype=object)
在 [12] 中：npM
输出[12]：
 [[1 2 3.0]
 [4 4 abc]]

在 [14] 中：类型（npM[0][0]）
出[14]：
在 [15] 中：类型（npM[0][2]）
出[15]：
在 [16] 中：类型（npM[1][2]）
出[16]：

在 [17] 中：M = s.matrices.Matrix(npM)
在[18]中：M
出[18]：
⎡1 2 3.0⎤
⎢ ⎥
⎣4 4 abc⎦

在 [27] 中：类型（ M[0,2] ）
出[27]：
在[28]中：类型（M[1,2]）
出[28]：

在 [29] 中：sym= M[1,2]
在 [32] 中：打印 sym.name
美国广播公司

在 [34] 中：sym.n
出[34]：
在 [40] 中： sym.n(subs={'abc':45} )
输出[40]：45.0000000000000

```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-04T11:32:13.367

您是否考虑过使用 csv 模块来处理 csv 文件？

[用于 csv 模块的 Python 文档](http://docs.python.org/library/csv.html)

# c# - 如何在 C# 中最大化我的应用程序使用的功率？

> ID：716261
> 
> 赞同：2
> 
> 时间：2009-04-04T01:22:34.707
> 
> 标签：c#, process, cpu, maximize

因为我创建的应用程序难以计算 -> 有很多工作要做，而不是非常复杂的计算 -> 计算它需要很长时间，并且该过程仅占用 CPU 的 45%。我可以以某种方式最大化它吗？：达到 90%？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-04T01:24:17.043

如果你有一台双核机器（我猜你有），你最希望在单线程中获得 50% 的 CPU 使用率。

要获得 90% 的 CPU 使用率，您很可能需要线程化计算。这可能非常简单，也可能非常困难，具体取决于您要线程化的算法的性质。

如果您可以将工作集分成多个组，我建议您考虑使用[ThreadPool](http://msdn.microsoft.com/en-us/library/system.threading.threadpool.aspx)，甚至可能使用[Task Parallel Library](http://blogs.msdn.com/pfxteam/)，具体取决于您的发布时间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-04T01:25:30.487

您很可能拥有双核 CPU，如果您的应用程序是单线程的，那么它将使用的最大 CPU 为 50%（全部为一个核）。为了更好地使用，您需要利用多个线程，但这也意味着找出某种方法将您的计算分解为多个部分，以便它们可以由多个内核处理。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-04T01:28:41.557

检查这个：

1.  您在计算时是否从磁盘读取？如果是这样，请尝试在计算之前读取内存中的数据。
2.  计算时是否将结果写入磁盘或控制台？如果是这样，试着推迟写作，直到计算结束，然后再写作。
3.  如果您有多核处理器，请尽可能尝试创建多线程算法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-04T01:26:08.723

如果您只有一个简单的循环进行计算，那么您的计算机很可能有两个内核/处理器。单线程应用程序最多只能使用 50% 的 CPU。

您需要多个线程才能在多核机器上使用整个 CPU。

# c# - 我应该如何创建回调

> ID：716274
> 
> 赞同：2
> 
> 时间：2009-04-04T01:27:00.063
> 
> 标签：c#, callback

编写回调的最佳方法是什么？我只需要调用 1 个具有 void (string, int) 信号的函数；这需要调用一个类，因为我有需要处理的成员 obj。写这个的最好方法是什么？在 C 中，我会传递一个 func 指针和一个 void*obj。我不喜欢这样，我怀疑在 C# 中有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-04T01:32:31.670

C#3.0 引入了 lambda，它允许您放弃回调（或委托）签名的声明。它允许您执行以下操作：

```
static void GiveMeTheDate(Action<int, string> action)
{
  var now = DateTime.Now;
  action(now.Day, now.ToString("MMMM"));
}

GiveMeTheDate((day, month) => Console.WriteLine("Day: {0}, Month: {1}", day, month));
// prints "Day: 3, Month: April" 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-04T01:32:35.523

在 C# 中处理（或替换需要）回调的标准方法是使用委托或事件。 [有关详细信息，请参阅本教程。](http://www.akadia.com/services/dotnet_delegates_and_events.html)

这提供了一种非常强大、干净的回调处理方式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-04T01:34:01.607

你是这个意思吗？

```
thatfunc(params, it, wants, Func<myObject> myCallbackFunc)
{
    myObject obj = new Object(); 

    myCallbackFunc.Invoke(obj);

//or

    myCallbackFunc.Invoke(this);

//I wasn't sure what if myObject contained thatFunc or not...
} 
```

# python - 我的第一个 python 程序：你能告诉我我做错了什么吗？

> ID：716278
> 
> 赞同：6
> 
> 时间：2009-04-04T01:27:46.143
> 
> 标签：python

我希望这个问题被认为适合stackoverflow。如果没有，我会立即删除问题。

我刚刚编写了我的第一个 python 程序。这个想法是你可以发出一个命令，它被并行发送到几个服务器。

这仅用于个人教育目的。该程序有效！我真的很想在 python 上做得更好，因此我想问以下问题：

1.  与 PHP（我习惯的）相比，我的风格看起来很凌乱。你对风格改进有什么建议吗？
2.  我在使用正确的库吗？我是否正确使用它们？
3.  我使用了正确的数据类型吗？我是否正确使用它们？

我有很好的编程背景，但是我花了很长时间才为 PHP 开发出一种体面的风格（PEAR 编码标准，知道使用什么工具以及何时使用）。

源码（一个文件，92行代码）

[http://code.google.com/p/floep/source/browse/trunk/floep](http://code.google.com/p/floep/source/browse/trunk/floep)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-04T01:46:23.587

通常最好将句子末尾之后的`:`内容放在单独的一行中（也不要在它之前添加空格）

```
if options.verbose:
  print "" 
```

代替

```
if options.verbose : print "" 
```

如果要迭代列表，则无需检查列表的 len

```
if len(threadlist) > 0 : 
  for server in threadlist :
    ... 
```

是多余的，更“可读”的是（python足够聪明，不会遍历空列表）：

```
for server in threadlist:
  ... 
```

还有一个更“pythonistic”的方法是使用列表的理解（但肯定是一个有争议的观点）

```
server = []
for i in grouplist : servers+=getServers(i) 
```

可以缩短为

```
server = [getServers(i) for i in grouplist] 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-04T02:37:51.797

在卸载任何批评之前，首先让我祝贺你的第一个 Python 程序工作。从一种语言迁移到另一种语言可能是一件苦差事，不断地在语法问题上摸索并在不熟悉的库中寻找。

引用最多的风格指南是[PEP-8](http://www.python.org/dev/peps/pep-0008/)，但这只是一个指南，至少它的一部分被忽略了......不，我的意思是在充分尊重指南作者和贡献者的情况下被认为不适用于某些特定情况： -)。

我无法将它与 PHP 进行比较，但与其他 Python 应用程序相比，很明显您正在遵循其他语言的样式约定。我并不总是同意其他开发人员说你**必须**做的许多事情，但随着时间的推移，我认识到为什么使用约定有助于传达应用程序正在做什么，并将帮助其他开发人员帮助你。

* * *

引发异常，而不是字符串。

```
raise 'Server or group ' + sectionname + ' not found in ' + configfile
```

变成

```
raise RuntimeError('Server or group ' + sectionname + ' not found in ' + configfile)
```

* * *

'if' 或 'for' 结尾的 ':' 之前没有空格，并且不要将多个语句放在同一行，并且在运算符周围放置空格时要保持一致。对对象使用变量名，并坚持使用`i`and `j`for 循环索引变量（就像我们精湛的 FORTRAN 前辈一样）：

```
对于组列表中的 i ：servers+=getServers(i)
```

变成：

```
对于组列表中的部分：
    服务器 += getServers（部分）
```

* * *

可以在不获取容器长度的情况下测试容器的内容：

```
而 len(threadlist) > 0 ：
```

变成

```
而线程列表：
```

和

```
如果 command.strip() == "" ：
```

变成

```
如果 command.strip():
```

* * *

拆分元组通常不会放在语句左侧的括号中，命令逻辑有点复杂。如果没有参数，那么 " ".join(...) 将是一个空字符串：

```
(options,args) = parser.parse_args()

如果 options.verbose ：打印“floep 0.1”

命令 = " ".join(args)

if command.strip() == "" : parser.error('no command given')

```

变成

```
选项，args = parser.parse_args()
如果 options.verbose：
    打印“floep 0.1”

如果不是参数：
    parser.error('没有给出命令')
命令 = " ".join(args)

```

* * *

python for 循环有一个不寻常的“else”子句，如果循环遍历所有元素而没有“break”，则执行该子句：

```
    对于线程列表中的服务器：
        foundOne = False
        如果不是 server.isAlive() ：
            ……剪……
            foundOne = 真

        如果没有找到一个：
            时间.睡眠（0.010）

```

变成

```
    对于线程列表中的服务器：
        如果不是 server.isAlive()：
            ……剪……
            休息
    别的：
        时间.睡眠（0.010）

```

* * *

获取行列表，然后将它们重新组合在一起有点冗长：

```
        结果 = proc.readlines()
        str结果 = ''
        结果中的行：strresult+=line
        self.result = strresult

```

变成

```
        self.result = proc.read()

```

* * *

您的库使用良好，请查看 subprocess 模块，它是最新的。

你的数据类型很好。

你会得到很多其他的答案:-)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-04T02:22:43.063

在 Python 中不推荐使用字符串异常，所以这一行：

```
if not config.has_section(sectionname): 
    raise 'Server or group ' + sectionname + ' not found in ' + configfile 
```

应该改写成这样的：

```
if not config.has_section(sectionname):
    raise ConfigNotFoundError(
        "Server or group" + sectionname + "not found in" + configfile)

class ConfigNotFoundError(Exception):
    pass 
```

[编辑以反映评论中 dangph 的建议]

它的代码行数更多，但更适合未来的升级。

为了可读性，像这样：

```
parser.add_option('-q','--quiet',action="store_false", help="Display only server output", dest="verbose", default=True) 
```

可以这样改写：

```
parser.add_option('-q',
                  '--quiet',
                  action="store_false",
                  help="Display only server output", 
                  dest="verbose", 
                  default=True) 
```

您可能更喜欢另一种拆分方法调用的方法，但想法是长行可能难以阅读。

您还应该阅读[PEP 8](http://www.python.org/dev/peps/pep-0008/)以了解 Python 风格。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-04T11:58:15.880

通常，出于重用的目的，我们会执行以下操作，从您程序的第 48 行开始

```
def main():
    config = ConfigParser.RawConfigParser()
    etc.

if __name__ == "__main__":
    main() 
```

这只是一个起点。

完成此操作后，您会意识到 main() 实际上是两部分：解析命令行界面和完成工作。然后，您希望将事物重构为如下所示。

```
def serverWork(group,...):
    servers = getServers(group)
    etc.

def main():
    config = ConfigParser.RawConfigParser()

    if command.strip() == "":
        parser.error('no command given')
    else:
        serverWork( options.group, options.etc., ... ) 
```

现在，您已将实际工作提升到此模块中的功能。您的 serverWork 函数现在可以很容易地被其他程序或脚本重用。

# c# - 如果我无法预测它的长度，如何计算出一维数组？

> ID：716293
> 
> 赞同：0
> 
> 时间：2009-04-04T01:39:06.490
> 
> 标签：c#, arrays, initialization

### 复制

> [C#中未知长度的数组](https://stackoverflow.com/questions/599369/array-of-an-unknown-length-in-c)

如何在不需要初始化长度的情况下初始化 string[]？我希望它是动态数组，所以当我添加一些东西时，长度会增加并且不会引发异常？

我应该只使用某种列表吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-04T01:51:07.553

如果您需要一个未知长度的数组`strings`，请使用命名空间中`List<T>`的a `System.Collections.Generic`。

```
List<string> myList = new List<string>();
myList.Add("First");
myList.Add("Second");
myList.Add("Third");
myList.Count // = 3 
```

这在幕后使用了一个固定大小的数组，但它隐藏了这样一个事实，即它会使数组变大并在空间不足时移动所有元素。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-04T01:51:55.027

[List<T>](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx)会做你想做的事。这有一个[ToArray()](http://msdn.microsoft.com/en-us/library/x303t819.aspx)方法，当您完成添加项目时将返回一个数组（如果您仍然需要一个数组）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-04T01:44:19.723

我认为很多语言都会预先将整个数组分配为一个块。您可能需要使用提供此功能的包装类。在没有指定语言的情况下，例如 Java 和 C++，int[] 将是一个连续的内存块。您必须分配一个新块并复制旧内容，或者使用一个为您管理它的包装器，要么做同样的事情，要么使用指向对象的指针。那将是Java中的ArrayList或类似的东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-04T01:45:37.973

在大多数语言中，数组具有固定长度。如果您需要动态长度，则必须使用动态数据类型，如列表。

如果语言本身不支持列表，它们通常用数组实现。如果内容变得太长而无法放入数组，则分配更长的数组，将内容从旧数组复制到新数组，最后释放旧数组。

我很确定您的语言或其库之一中存在动态长度类型。

**更新**

对于 C#，集合类位于`System.Collections`命名空间中。`System.Collections.Generic`如果可能，您应该关注泛型类。四个你的情况，通用`List<String>`可能最适合。但也`Stack<String>`或`Queue<String>`可能很有趣。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-04T01:45:48.923

什么语言？

C#、Java 和许多其他高级语言具有`ArrayList`允许您添加和删除元素而无需设置特定大小的数据结构（或类似的东西）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-04T01:46:46.910

好吧，在 fortran 中你可以使用 ALLOCATE。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-04T01:44:22.657

如果您使用 C#，请使用 ArrayList。它会根据您的需要动态扩展，它也可以容纳任何东西（这可能是好的也可能是坏的）。所以是的，你应该使用某种列表。还记得包括这个 using 语句：

```
using System.Collections; 
```

# wpf - ViewBox 是在 WPF 中实现分辨率独立性的最佳选择吗？

> ID：716298
> 
> 赞同：10
> 
> 时间：2009-04-04T01:41:55.830
> 
> 标签：wpf, resolution-independence

我正在开发一个需要独立于分辨率的应用程序。该应用程序将始终是全屏的，因此我必须设计我的 UI，以便显示器分辨率不会影响应用程序的使用。我一直在花大量时间尝试使用 WPF 来实现这一点。今天我发现了 Viewbox。它似乎解决了我所有的问题。我所要做的就是将用于布局每个屏幕的网格放置在 Viewboxes 中，就像魔术一样，我有一个独立于分辨率的应用程序。

然而，这似乎很容易。感觉不对。我应该使用 Viewboxes 吗？如果不是，我应该怎么做？在我发现 Viewbox 之前，我很难想出一种方法来根据分辨率缩放字体大小。有了 Viewbox，我就不必担心这个了。因此，如果 Viewbox 使用错误，我该如何调整文本大小？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-04T08:17:32.570

WPF 的核心是分辨率独立性。它的默认测量单位是与设备无关的像素 (DIP)，而不是像素。您能否解释一下这对您不起作用，或者提供一个非常简单的未正确缩放的 XAML 示例？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-05T21:08:43.817

其实你说的很对。WPF与**分辨率**无关，但问题在于如何控制字体大小。

应避免使用 ViewBox，因为它们具有成本效益，但我认为单个不应伤害任何人。

但请注意：它现在可能看起来，但您无法在 640x480 上显示与 1600x1200 一样多的信息.​​.....最优雅的解决方案是使用在[Photo Suru 应用程序](http://www.photosuru.com/)中演示的分辨率相关模板。

# sifr - sIFR 和 LavaLamp 可以一起工作吗？

> ID：716299
> 
> 赞同：1
> 
> 时间：2009-04-04T01:42:00.947
> 
> 标签：sifr, lavalamp

我有一段时间让 sIFR 和 LavaLamp 一起玩得很好。

LavaLamp 的简史：

LavaLamp：一个 jQuery 插件

由

1.  加载 LavaLamp 和 jQuery 支持 JS 文件添加 LavaLamp css
2.  创建一个未排序的列表并将“lavaLamp”类添加到其中
3.  将包含锚标记的列表成员添加到 url

示例 CSS

```
.lavaLamp {
        position: absolute;
        height: 29px;
        padding: 15px;
        margin: 24px 0 0 0;
        }

.lavaLamp li {

        float: left;
        list-style: none;
        }

.lavaLamp li.back {

        background: url(../images/lava.png) no-repeat right -30px
        width: 9px;
        height: 30px;
        z-index: 8;
        position: absolute;
        }

.lavaLamp li.back .left {

        background: url(../images/lava.png) no-repeat top left
        height: 30px;
        margin-right: 9px;
        }

.lavaLamp li a {

        font-size: 20px;
        position: relative;
        overflow: hidden;
        text-decoration: none;
        color: #000000;
        outline: none;
        text-align: center;
        height: 30px;
        top: 4px;
        z-index: 10;
        letter-spacing: 0;
        float: left;
        display: block;
        padding:0px 10px;
        } 
```

示例 HTML：

> ```
> <div id="menu">
>    <ul class="lavaLamp">
>       <li><a href="somewhere.html">Some Where</a></li>
>       <li><a href="somewhereelse.html">Some Where Else</a></li>
>    </ul>
> </div> 
> ```

让 sIFR 初始化菜单的最初尝试是将选择器设置为“选择器：'#menu'。这根本不起作用。慢慢地，我开始越来越深入地进入 div 的巢穴。

最后，当我这样做时：选择器：'.lavaLamp li a'，LavaLamp 正确初始化并开始正确显示字体和翻转。

问题：

1.  直接单击应处于活动状态的文本时，锚标记不起作用。但是，如果您单击 LavaLamp 用作翻转的图像的最左侧或最右侧，它将单击锚点。
2.  当您滚动菜单中的其他项目时，有时当您将鼠标悬停时，最后滚动的项目会保持突出显示，而不是返回到当前活动的菜单项。

在此先感谢您的帮助...

-一个

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-06T16:25:32.443

替换`<li>`而不是`<a>`，这让 sIFR 可以处理 Flash 影片中的点击和悬停效果。

# model-view-controller - MVC 成员资格和 RC 1.0？

> ID：716308
> 
> 赞同：2
> 
> 时间：2009-04-04T01:45:51.920
> 
> 标签：model-view-controller, membership

该项目 - [https://github.com/TroyGoode/MembershipStarterKit](https://github.com/TroyGoode/MembershipStarterKit) - 是否适用于最新版本的 RC 1.0？

有谁知道它是否升级或？ie似乎有一段时间没有升级源，我认为它正在积极开发中？

只是想知道是否有人实现了它，让它工作 - 关心更新源代码（但我是 MVC 的新手，不知道以前的版本和 1.0 中存在什么）？

任何想法/帮助？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-04T01:48:28.917

你考虑过给作者发邮件吗？主页上有一个电子邮件链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-04T02:01:12.257

您是否只是尝试下载代码并检查与其捆绑的 MVC DLL？

我就是这样做的，发现 System.Web.Mvc.dll 上的版本是 1.0.40112.0。我相信这个版本是 RC1 或 Beta。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T02:12:01.840

我还没用过。但是，MVC RC2 和发布版本之间几乎没有什么变化。我有一个在 RC1 期间开始构建的 MVC 应用程序，它不受 RC2 或 v1.0 的影响

阅读 v1.0 发行说明以获取更多信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-22T23:52:32.043

它于 2009 年 8 月 7 日更新以使用 MVC 1.0

# ieee-754 - 哪些语言可以正确获得 IEEE 754？

> ID：716311
> 
> 赞同：11
> 
> 时间：2009-04-04T01:47:39.387
> 
> 标签：ieee-754

我只是花了我一周的时间来处理这个主题，并没有发现*任何*语言可以使 IEEE 754 规范正确。

甚至 GCC 也不尊重相关的 C99 部分（它忽略了 FENV_ACCESS 杂注，有人告诉我，我的工作示例纯属运气）。

使用库函数来尊重规范是不可能的（AFAIK），您需要语言的支持，因为当您使用标志或舍入时，一些常见的优化是被禁止的。

所以这是我真正的问题：是否有语言（来自 C/C++ 或原始程序集）可以让我访问舍入模式、异常标志和微积分？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-04T09:55:22.103

由于您在谈论 IEEE 754 的“硬”部分，我猜您最好的选择是使用[Fortran](http://en.wikipedia.org/wiki/Fortran)。根据维基百科文章 Fortran 2003 至少支持浮点异常处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-04T08:53:48.957

AFAIK，即使是 FPU 硬件单元也没有完全实现完整的 IEEE-754 规范。因此，根据您的需要，您可能会不走运。也许这就是为什么没有语言能完全正确的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-07T16:53:47.987

我看起来像[Factor](http://factor-language.blogspot.com/2009/09/advanced-floating-point-features.html)一样，并且链接声称 D 也是 SBCL。

# c# - 如何在 Vista 中测试 C# SmtpClient 代码

> ID：716330
> 
> 赞同：1
> 
> 时间：2009-04-04T02:02:10.540
> 
> 标签：c#, iis-7, smtp, windows-vista

我必须测试一些通过 SMTP 服务器发送带有附件的简单 HTML 内容的 C# 代码。如何确保我的代码有效。我的机器是 Vista 并且有 IIS-7，我不想连接到任何外部 SMTP

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-04T02:06:50.200

请参见：

[使用 SmtpClient 时如何保存电子邮件而不是发送？](https://stackoverflow.com/questions/567765/how-can-i-save-an-email-instead-of-sending-when-using-smtpclient)

[我可以在调用 client.Send() 之前测试 SmtpClient 吗？](https://stackoverflow.com/questions/372742/can-i-test-smtpclient-before-calling-client-send/372794)

[SmtpClient 向垃圾邮件发送电子邮件](https://stackoverflow.com/questions/510748/c-smtpclient-sends-email-to-junk)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T06:56:00.130

如何使用像[http://ndumbster.sourceforge.net/default.html这样的“假”SMTP 服务器](http://ndumbster.sourceforge.net/default.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T02:30:16.477

如果您想通过实际发送电子邮件进行测试，您可以在 Vista 上安装[免费的 SMTP 服务器。](http://www.softaward.com/1036.html)如果您不希望邮件去任何地方，您可以考虑在诊断程序中至少实现部分[SMTP 。](http://en.wikipedia.org/wiki/Simple_Mail_Transfer_Protocol)我最近这样做了——如果您只想捕获消息而不是尝试编写真正的服务器，这并不难。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-04T03:52:29.837

我通常安装[Apache James](http://james.apache.org/)进行测试，它有一个功能齐全的 smtp 和 pop3 服务器，它是一个 java 服务器，所以你只需要安装 JRE。我将它安装在我正在调试的同一台机器上，但我建议您必须遵循其 wiki 上的一些教程才能正确安装它，它的安装并不是那么直观。

# php - 如何使用 Symfony 将数据数组保存在 cookie 中？

> ID：716337
> 
> 赞同：4
> 
> 时间：2009-04-04T02:05:54.507
> 
> 标签：php, cookies, symfony1

首先，我对 cookie 不是很熟悉，但我知道它们是如何工作的。我已经看过很多使用纯 PHP 代码的不同教程，但我正在寻找一个可靠的示例，说明如何使用 symfony 语法将数组存储在 cookie 中：

```
$this->getResponse()->setCookie('myCookie', $data); 
```

您不能只传入一个数组，因为它需要一个字符串。是首先序列化数组的唯一方法吗？

在 cookie 中存储数据时还有其他选择吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-16T14:15:26.553

如果您确实需要将其存储在 cookie 中而不是会话中，则可以使用序列化：

```
$this->getResponse()->setCookie('myCookie', serialize($data));

$data = unserialize($this->getRequest()->getCookie('myCookie')); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-04T02:21:47.043

您可以将数组转换为 cookie 中的一组键/值，以防数组是唯一要存储的主题：

```
$this->getResponse()->setCookie('myCookie[0]', $data1);
$this->getResponse()->setCookie('myCookie[1]', $data2); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-04T02:12:29.673

您可能应该将数据存储在会话中，而不是 cookie。

PHP 自动支持这一点；只需将您的数据放入`$_SESSION['key']`，它就会在该用户的页面加载中持续存在。

在幕后，PHP`PHPSESSID`在客户端设置一个 cookie，并使用它在您的 Web 服务器上查找数据。与使用 cookie 相比，这有两个明显的好处。

1.  数据不可篡改。客户端可以更改、删除或以其他方式破坏 Cookie。您不应该使用它们来存储重要信息。
2.  您的存储空间是无限的。
3.  您有不同的会话数据存储选项。它们可以放在磁盘上，也可以放在内存缓存中，或其他任何地方。
4.  您可以存储复杂类型，如数组，甚至对象实例。

有关更多信息，请参阅[有关会话的 PHP 文档](http://us.php.net/session)。

# algorithm - Prim 算法时间复杂度

> ID：716341
> 
> 赞同：11
> 
> 时间：2009-04-04T02:07:18.373
> 
> 标签：algorithm, graph-theory, time-complexity, prims-algorithm

我正在查看 Prim 算法的[Wikipedia 条目](http://en.wikipedia.org/wiki/Prim%27s_algorithm)，我注意到它与邻接矩阵的时间复杂度为 O(V^2)，而其与堆和邻接列表的时间复杂度为 O(E lg(V))，其中 E 是边数和 V 是图中的顶点数。

由于 Prim 算法用于更密集的图中，E 可以接近 V^2，但是当它接近时，堆的时间复杂度变为 O(V^2 lg(V))，大于 O(V^2)。显然，与仅搜索数组相比，堆将提高性能，但时间复杂度另有说明。

算法实际上是如何随着改进而变慢的？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-04T02:15:15.733

即使堆使您免于搜索数组，它也会减慢算法的“更新”部分：数组更新是 O(1)，而堆更新是 O(log(N))。

从本质上讲，你用算法的一个部分的速度来换取另一部分的速度。

无论如何，您都必须搜索 N 次。但是，在密集图中，您需要更新很多 (~V^2)，而在稀疏图中，您不需要。

我想到的另一个例子是在数组中搜索元素。如果你只做一次，线性搜索是最好的——但如果你做很多查询，最好每次都对它进行排序并使用二分搜索。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-12-08T06:48:58.287

从算法导论（卡门）

**时间= Θ(V)·T(EXTRACT-MIN) + Θ(E)·T(DECREASE-KEY)**

```
                   T(EXTRACT-MIN) T(DECREASE-KEY) 总计

1\. 数组 O(V) O(1) O(V^2)
2.二叉堆 O(lgV) O(lgV) O(E lgV)
3\. 斐波那契堆 O(lgV) O(1) O(E + VlgV)

```

使用不同的数据结构会导致不同的时间复杂度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T02:40:25.923

我认为你在某种程度上读错了。对于密集图，文章讨论了使用时间复杂度为 O(E + V log V) 的斐波那契堆，这要好得多。

# iphone - Quartz 2D drawRect 方法 (iPhone)

> ID：716351
> 
> 赞同：32
> 
> 时间：2009-04-04T02:15:07.060
> 
> 标签：iphone, ios, cocoa-touch, quartz-graphics

我面前有 4 种不同的**iPhone/Cocoa/Core Animation/Objective-C书籍，以及来自网络的大量示例代码。**然而不知何故，我仍然觉得我缺少对**Quartz 2D**中绘图工作原理的一些基本理解。

是否`drawRect()`只是一个执行绘图代码的钩子？或者这种方法是否应该也重绘“损坏”的区域，需要重绘？我可以只画一次然后它“粘”起来，还是我必须随时通过重新绘制整个场景`drawRect()`？Java 的 Graphics2D 对象以这种方式工作 - 每次调用 paint() 时都必须绘制整个“图像”，因此您必须随时准备重新构建它（或缓存它）。

你将如何实现一个简单的绘图程序？您是否必须“记住”用户绘制的每条线/点/笔划，并在每次`drawRect()`调用时复制它们？“离屏”渲染怎么样？你能画完所有的画，然后打电话`[self setNeedsDisplay]`让你的写入刷新到屏幕上吗？

假设为了响应用户的触摸，我想在他触摸的屏幕上放置一个“X”。X 应该保留在那里，并且每次新的触摸都会产生另一个 X。我是否需要记住所有这些修饰坐标，然后将它们全部绘制出来`drawRect()`？

**编辑：**

除非我误解了，否则 joconor 和 Hector Ramos 在下面的回答是相互矛盾的。这很好地证明了我对这个主题的困惑。:-)

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-04-04T15:11:05.977

各种 Cocoa 引用之间的一些混淆来自于 Leopard 中层支持视图的引入。在 iPhone 上，所有 UIView 都是 layer-backing，而 Leopard 视图需要手动启用 layer-backing。

对于支持图层的视图，内容会使用您在 中提供的任何内容绘制一次`drawRect()`，然后缓冲到图层中。该层就像一个矩形纹理，所以当你移动或覆盖它时，不需要重绘，纹理只是通过 GPU 移动到那个位置。除非您将图层设置为`needsDisplayOnBoundsChange property`，否则`YES`更改图层（或其包含的视图）的大小只会缩放内容。这可能会导致您的视图或图层中的图形模糊，因此您可能希望在这种情况下强制重绘。`setNeedsDisplay`将触发视图或图层内容的手动重绘，以及随后在图层中重新缓存该内容。

为了获得最佳性能，建议您避免频繁调用`drawRect`，因为在图层中绘制和重新缓存 Quartz 是昂贵的操作。最好尝试使用可以移动或缩放的单独图层来制作动画。

您看到的与桌面相关的基于 Cocoa 的引用可能假定非图层支持的视图，它们确实调用 drawRect：任何时候需要更新视图，无论是来自移动、缩放还是拥有部分视图模糊不清。正如我所说，所有 UIView 都是有层支持的，所以 iPhone 上不是这种情况。

也就是说，对于您的绘图应用程序，一种方法是维护一个绘制对象数组并调用 drawRect：每次用户添加新内容时，按顺序迭代每个先前绘制的对象。我可能会建议另一种方法，为每个绘图操作创建一个新的 UIView 或 CALayer。该绘制操作的内容（线、弧、X 等）将由单个视图或图层绘制。这样，您就不必重新绘制所有内容，并且您可以通过独立移动每个绘制的元素来进行一些简洁的矢量样式编辑。对于复杂的绘图，这可能会有一些内存折衷，但我敢打赌它会有更好的绘图性能（最小的 CPU 使用率和闪烁）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-04T04:26:59.193

drawRect() 将绘制到屏幕外缓冲区。当区域“损坏”本身时，您无需重新绘制，因为 iPhone OS 负责处理视图的分层。您只需向缓冲区写入一次，然后让操作系统处理其余部分。这与其他编程环境不同，在其他编程环境中，只要有东西越过您的视图，您就需要继续重绘。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-04T05:14:01.297

始终准备好在`drawRect:`调用时绘制视图的适当区域。

尽管系统可能会缓冲您的视图，但这只会避免`drawRect:`被调用。如果由于某种原因，系统必须使缓冲区无效，则`drawRect:`可能会再次调用您的方法。此外，`drawRect:`将在视图的不同区域因滚动和其他影响视图区域可见性的操作而变得可见时调用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-10-21T20:14:30.073

> drawRect() 是否只是一个执行绘图代码的钩子？

它旨在使用当前图形上下文堆栈重绘传递给您的区域（矩形）。不再。

> 或者这种方法是否应该也重绘“损坏”的区域，需要重绘？

不会。如果脏区不重叠，您可能会收到多个调用，`drawRect:`其中传递给您的不同矩形。使用 使矩形无效`setNeedsDisplayInRect:`。如果只需要重新绘制视图表面的一部分，那么当需要绘制时，您将被要求绘制该部分。

> 我可以只画一次然后它“粘住”，还是必须随时通过 drawRect() 重新绘制整个场景？

它不“粘”。矩形在您的应用执行期间变得无效，并且当视图系统需要更新屏幕时，您需要重新绘制这些矩形。您只重绘请求的矩形。

在某些情况下，一个简单的实现可能（相当懒惰地）使视图的整个矩形无效，只要一部分无效。这通常很糟糕，因为它通常需要比必要更多的绘图，并且当视图不透明时尤其浪费。

> Java 的 Graphics2D 对象以这种方式工作 - 每次调用 paint() 时都必须绘制整个“图像”，因此您必须随时准备重新构建它（或缓存它）。

AppKit 或 UIKit 并非如此。

> 你将如何实现一个简单的绘图程序？您是否必须“记住”用户绘制的每条线/点/笔划，并在每次调用 drawRect() 时复制它们？

您必须记住绘制视图所需的上下文（例如，每条线/点/笔划）。您只需要绘制所请求的区域。从技术上讲，如果您要在该矩形之外绘制，图形系统不会抱怨，但这可能会导致伪影。

对于复杂的渲染，绘制到外部缓冲区（例如位图）可能更容易或更有效，然后使用预渲染的位图表示在`drawrect:`. （另请参阅 Brad 对图层的回答）

> “离屏”渲染怎么样？你能完成所有的绘图然后调用 [self setNeedsDisplay] 将你的写入刷新到屏幕上吗？

是的，你可以这么做。具体来说，您将渲染到外部缓冲区（例如位图），当您完成对位图的渲染时，使您希望绘制的矩形无效，然后在`drawRect:`调用时使用位图中的数据绘制到屏幕。

> 假设为了响应用户的触摸，我想在他触摸的屏幕上放置一个“X”。X 应该保留在那里，并且每次新的触摸都会产生另一个 X。我是否需要记住所有这些修饰坐标，然后将它们全部绘制在 drawRect() 中？

好吧，你有几个选择。您的建议是一个（假设您在传递给您的矩形内绘制）。另一种方法是创建一个“X”视图，如果您需要这些 X 在启动过程中持续存在，只需记住重建视图所需的点即可。在许多情况下，您可以轻松地将复杂的问题分成几层（简单的 2D 游戏）：

*   1）具有地平线的背景图像。
*   2）前台的一些东西不经常改变。
*   3) 用户用于在游戏中导航的角色。

因此，大多数问题都可以轻松划分，因此您不必一直渲染所有内容。如果做得好，这会降低复杂性并提高性能。如果做得不好，可能会更糟。

# c++ - 新的必须总是跟着删除吗？

> ID：716353
> 
> 赞同：11
> 
> 时间：2009-04-04T02:15:27.153
> 
> 标签：c++, new-operator

我想我们都明白`delete`重新分配动态分配的指针以防止内存泄漏的必要性。但是，我很好奇，C++ 在多大程度上要求使用`delete`? 例如，采取以下程序

```
int main()
{
     int* arr = new int[5];
     return 0;
} 
```

虽然出于所有意图和目的，这里没有发生泄漏（因为您的程序正在结束并且操作系统将在它返回后清理所有内存），但标准是否仍然需要 - 或推荐 -`delete[]`在这种情况下使用？如果没有，你会在这里有什么其他原因`delete[]`吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-04T02:20:44.537

标准中没有任何要求`delete[]`- 但是，我会说这是一个非常好的指导方针。

但是，最好将 a `delete`or`delete[]`与每个`new`or`new[]`操作一起使用，即使内存将被程序终止清理。

许多自定义对象将有一个析构函数，它执行其他逻辑而不仅仅是清理内存。在这些情况下，使用`delete`保证了破坏。

此外，如果您在您的例程中移动，您不太可能在代码中的其他位置导致内存泄漏。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-04T02:22:21.007

当程序退出时，[是否有理由在 C++ 中调用 delete？](https://stackoverflow.com/questions/677812/is-there-a-reason-to-call-delete-in-c-when-a-program-is-exiting-anyway)

答案是由于需要运行析构函数，有时需要在退出程序之前删除对象。此外，如果您不这样做，许多内存泄漏检测工具会抱怨，因此为了更容易找到真正的内存泄漏，您应该在退出之前尝试删除所有对象。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-04T02:19:50.637

请参见：

[在 C++ 中何时使用“新”，何时不使用？](https://stackoverflow.com/questions/679571/when-to-use-new-and-when-not-to-in-c)

[关于 C++ 中自定义对象的构造函数/析构函数和 new/delete 运算符](https://stackoverflow.com/questions/392455/about-constructors-destructors-and-new-delete-operators-in-c-for-custom-objects)

[在Visual C++ 中delete 和delete [] 一样吗？](https://stackoverflow.com/questions/301357/delete-and-delete-the-same-in-visual-c)

[为什么数组有特殊的new和delete？](https://stackoverflow.com/questions/659270/why-is-there-a-special-new-and-delete-for-arrays)

[如何在 C++ 中跟踪内存分配（尤其是新建/删除）](https://stackoverflow.com/questions/438515/how-to-track-memory-allocations-in-c-especially-new-delete)

[结构数组和新/删除](https://stackoverflow.com/questions/434140/array-of-structs-and-new-delete)

[new/delete 和 malloc/free 有什么区别？](https://stackoverflow.com/questions/240212/what-is-the-difference-between-new-delete-and-malloc-free)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-04T02:19:43.087

这里没有。但是随着程序变得越来越大和越来越复杂，我会管理我的内存，以便我可以更快地追踪错误。该标准只说在较小的情况下养成良好的习惯会导致长期更好的代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-04T02:18:51.497

您完全可以忘记删除内容。

你喜欢浪费内存吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-04T02:22:06.590

我不知道标准，但是围绕这个问题有一个完整的编程风格：[crash-only softxare](http://en.wikipedia.org/wiki/Crash-only_software) 理论上数据库或操作系统内核应该这样开发，但通常这样使用它们并不实际，因为重启时会有一些可能很长的清理工作。此外，从属系统（操作系统或数据库客户端内的程序）可能不是仅崩溃的。

# c# - 为什么我在 SQL Server 中收到此数据库连接错误？

> ID：716355
> 
> 赞同：0
> 
> 时间：2009-04-04T02:17:24.700
> 
> 标签：c#, sql-server

我是数据库编程的初学者，无法连接到我的数据库。我使用以下代码进行连接。

```
public class dbOpnClse
{
    SqlConnection con = new SqlConnection();
    public SqlConnection openConnection()
    {
        con.ConnectionString ="server=SERVERNAME;database=Test;uid=###;pwd=#####";
        con.Open();
        return con;
    }
    public void closeConnection()
    {
        con.Close();
    }
} 
```

问题是我收到异常“不允许更改 'ConnectionString' 属性。连接的当前状态是打开的。” 此连接代码是否有任何错误？请帮忙！我正在使用 C#.net 2005 和 SQL Server 2000

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-04T02:23:09.863

我最好的猜测是你第二次调用 openConnection 时你还没有关闭它，所以你尝试设置一个已经打开的连接的 connectionstring 属性。这是不允许的。

相反，在 .Net 中，您希望您的`openConnection()`-style 方法在每次调用它们时实际创建一个新连接，按照工厂模式的路线，以便可以正确处理连接。更像这样的东西：

```
private SqlConnection CreateConnection()
{
    //even better if the connection string is pulled from a config file
    var result = new SqlConnection("Your connection string here");
    result.Open();
    return result;
} 
```

不会有相应的“关闭”方法。相反，我们将依赖 IDisposable 模式来确保连接始终正确关闭。然后，您将以如下方法使用该函数和连接：

```
public DataTable GetRecords(int SomeValue)
{
    var result = new DataTable();

    string sql = "SELECT * FROM [MyTable] WHERE [SomeIntColumn]= @SomeValue";

    using (var cn = CreateConnection() )
    using (var cmd = new SqlCommand(sql, cn) )   
    {
        cmd.Parameters.Add("@SomeValue", SqlDbType.Int).Value =  SomeValue;

        using (var rdr = cmd.ExecuteReader() )
        {
           result.Load(rdr);
        }
    }
    return result;  
} 
```

这些`using`语句适用于实现 IDisposable 接口的任何对象，并且即使引发异常，它们也能保证您的连接已关闭。

另请注意，我将 CreateConnection() 方法设为私有。这是因为这个类将成为你的数据访问层。通过将连接设为私有，您将实施一个良好的数据库层，其中与数据库对话的唯一方法是通过此类。 *任何*需要与数据库对话的代码都应该放在这里。如果这个类开始变得太大，您可以将此方法标记为`internal`而不是私有，并将您的数据访问层移动到它自己的程序集中（Visual Studio 中的单独项目）。现在的关键是将您的方法限制为接受参数的强类型输入。不要试图构建一个让你直接传入 sql 的通用方法。那就是疯狂。

最后，**永远不要**通过 sa 帐户从您的应用程序连接到数据库，并且将您的 sa 帐户详细信息发布到公共网站并不是那么明亮。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T02:27:52.053

比努，

您的代码中存在各种问题。首先，您不应该将连接字符串嵌入代码中 - 您应该从配置文件中提取它，以便在部署时可以更改它。二、**千万不要用sa账号登录你的数据库！！** 只是不要这样做-相信我这个。

第三，我强烈建议您使用 IDisposable 接口和 Using 块来确保您的连接*始终*处于关闭状态。实际上，您依赖于调用 closeConnection 的消费代码。

试试这个示例代码：

```
public class MyConnClass : IDisposable
{
    public static string ConnectionString { get; set; }
    protected SqlConnection conn;

    public MyConnClass()
    {
        conn = new SqlConnection(ConnectionString);
        conn.Open();
    }

    public void Dispose()
    {
        conn.Close();
    }
 } 
```

在您的初始化代码（例如 Web 应用程序中的 Global.asax.cs）中设置静态连接字符串，如下所示：

```
 MyConnClass.ConnectionString = ConnectionString; 
```

在您的消费类中，您将使用以下内容：

```
using (MyConnClass myConn = new MyConnClass())
{

    // Database code

} 
```

**更新**：我建议您考虑的另一件事是修改上述代码，使其构成数据访问层 (DAL) 的基础，而不仅仅是连接。也就是说，在其中也放置一个 SQL 命令对象并创建代码以简化您的整体数据访问策略。也就是说，只是将*Connection*放在一个单独的类中有点没用，因为正如 Joel 指出的那样，SqlConnection 对象本身就是 Disposable。成熟的 DAL 的优势在于它可以从根本上简化您的数据访问。例如，我的 DAL 让我编写如下内容：

```
using (MyQueryClass myQuery = new MyQueryClass())
{
   myQuery.Command("Update...").ParamVal("@P1", 1).ParamVal("@P2", 2).Execute();
   return myQuery.Command("Select ...").ParamVal("@Param", SomeVal).ReturnList<SomeType>();
} 
```

你不会得到我所做的类，但希望你能看到一些东西：连接字符串在我的代码中从来不是问题（它被封装），我可以运行多个命令而无需所有设置和拆除通常需要，整体语法更流畅。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T02:22:44.327

大概您正试图在代码的其他地方这样做（即更改“ConnectionString”属性）。

最好的做法是在使用连接的代码块完成后立即打开连接并再次关闭它们（使用`using`语句），并让连接池处理连接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-04T02:24:13.747

```
 namespace databaseOp 
{ 
public class dbOpnClse 
{ 
SqlConnection con; 

public SqlConnection openConnection() 
{ 
    //Try this...
    con = new SqlConnection("server=CHEMPAKASSERIL;database=Test;uid=sa;pwd=jeevan");

    //Not this...
    //con.ConnectionString ="server=CHEMPAKASSERIL;database=Test;uid=sa;pwd=jeevan"; 
    con.Open(); 
    return con; 
} 

public void closeConnection() 
{ 
    con.Close(); 
}

    }

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-04T02:26:10.683

您收到此错误是因为您的某些代码在连接已打开时第二次调用 openConnection。

您应该阅读[这篇关于 ADO.NET 最佳实践的文章](http://msdn.microsoft.com/en-us/library/ms971481.aspx)

# asp.net - 有条件地排除 ASP.NET WebForms 中的一个 html 块

> ID：716361
> 
> 赞同：38
> 
> 时间：2009-04-04T02:20:34.643
> 
> 标签：asp.net, html, webforms

这只是一个简单的问题：基于服务器端评估，如何排除服务器返回的 aspx web 表单上的一段 html？

我不是专门谈论控件，因为它们往往具有可见参数，而只是一些原始 html。

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-04-04T02:49:45.183

有些人反对以下方法，但它没有人回答，我觉得它应该作为一个选项显示。如果使用得当，它会很方便。

```
<% if (ShowLabel) {%>
<label>This will not be shown if the ShowLabel property evaluates false</label>
<%}%> 
```

为了完成这项工作，您将在页面上拥有一个名为 ShowLabel 的公共或受保护属性，该属性返回一个布尔值。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-04-04T02:27:27.420

```
<div id="divYourDiv" runat="server">
    your stuff goes here...
</div>

//Server side code...
public void ShowYourDiv(bool visible)
{
    this.divYourDiv.Visible = visible;
} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-04-04T02:48:04.283

在代码周围放置一个`PlaceHolder`控件。它不会为自己呈现任何代码（例如 a `Panel`），因此它在可见时不会干扰 html 代码。

如果将 的`Visible`属性设置`PlaceHolder`为 false，`PlaceHolder`则不会将 里面的代码渲染到页面上。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-04T02:23:51.547

通过它/在隐藏的 div 或面板中设置它（如果使用 div，标记 runat=server，两者都呈现为 div）。然后根据您的评估使 div/面板可见或隐藏。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-04T02:25:29.203

您可以将 html 包装在 asp 面板中，并在服务器端设置面板的可见属性。

否则，Html 是客户端，你需要使用 javascript 来操作。您可能能够在服务器端代码中呈现一些 javascript，但这通常不是一个好主意。

# jquery - 动态 UI 样式/主题

> ID：716373
> 
> 赞同：0
> 
> 时间：2009-04-04T02:23:53.543
> 
> 标签：jquery, css, ajax

我正在做一个电子商务类型的网站，它有一个 CMS，管理员用户可以在其中创建主题并更改当前的主题设计。我使用jQuery。样式/主题属性存储在数据库中并检索到 xml。

我使用 jquery 使用 xml 的属性来操作页面的 CSS 属性。

这是进行动态主题/造型的实用方法吗？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-04T03:27:23.003

恕我直言，不。

如果您想让用户完全控制您网站上的 CSS，我可能会让他们上传自己的 CSS 文件，然后将它们列在数据库中。选择适当的文件服务器端并加载它。没有凌乱的“无样式内容闪现”或 JS 依赖项。

如果您只想让用户编辑一些特定元素，那么*也许*您可以将这些特定元素存储在数据库中，但您仍然应该动态生成 CSS 文件（通过 PHP 或您拥有的）并将其发送到客户端.

哦，你为什么要使用 XML？据我所知，您只是毫无理由地增加了一层额外的复杂性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T10:57:43.420

在我工作的一个网站上，我开始使用 jQuery 进行奇数/偶数表行样式设置，因为语法和其他一些表样式一样简单。但是对于更大的表，我开始对它进行性能测试，并且在 Firefox 3（对于现代浏览器来说这是合理的性能）我花费了 200-500 毫秒（根据 YSlow）来渲染页面，这是不可接受的高。

您想在服务器上做尽可能多的事情——基本上是在渲染页面时您可以在服务器上做的任何事情。这样会快**很多。**

将 jQuery 保存为您在服务器上无法执行的操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T05:21:39.967

正如其他人已经评论的那样，如果您希望管理员完全控制网站的样式（正如大多数流行的 CMS 所提供的那样），那么您需要允许管理员上传他们自己的样式表甚至 html 模板。您还可以为不能或不想创建自己的用户的用户提供几个预制样式表和模板。

我知道一些像 LiveJournal 和 Xanga 这样的网络服务有限制性的主题系统，只允许用户更改他们个人页面的颜色和字体样式。但恕我直言，这种类型的主题系统不适合商业网站。它使站点管理员对其站点的外观/布局的控制太少。无论您的核心模板多么出色。如果你让你的用户做的只是改变一些颜色和字体样式，那么你最终还是会得到一堆看起来几乎一样的千篇一律的网站。

至少，管理员应该能够将他们自己的 CSS 模板应用到商店，这样，如果企业决定他们想要一个专业设计的布局，他们可以在他们的网站上实现一个。

但是，您可以做的是在 CMS 中包含一个 CSS 生成器，供那些不知道如何编写自己的 CSS 的管理员使用。它可能只是一个向导界面，引导用户逐步完成生成基本自定义样式表的过程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-04T02:27:22.007

jQuery UI - [http://jqueryui.com/themeroller/](http://jqueryui.com/themeroller/)

该库提供了一组标准的小部件和效果，您可以使用它们来构建您的 UI。它还支持多个主题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-04T02:35:10.523

为什么不像大多数 CMS 那样在服务器上进行主题化？当您可以简单地发送适当的 css 时，不确定我是否了解将动态重新主题代码下载到浏览器的实用性。

您还需要考虑某些浏览器中没有可用的 JavaScript 的情况，以及非常依赖浏览器和用户电脑的速度来运行这些东西。core 2 duo 的主题本身可能又好又快，但我的基于 atom 的上网本不是那么快

# actionscript-3 - Actionscript3：如何列出形状的像素？

> ID：716385
> 
> 赞同：0
> 
> 时间：2009-04-04T02:31:34.370
> 
> 标签：actionscript-3

检查了文档，但我找不到任何东西。我想将任何形状的填充像素的坐标列出到一个数组中。

该函数如下所示：

> 函数 listShapePixels(shape:Shape):Array

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-04T02:38:47.283

简要地 ：

*   使用 draw() 方法将形状转换为 bitmapData
*   使用 getPixel32 扫描位图数据以收集填充像素并将其坐标存储到数组中。

# python - 为什么我的 PyObjc Cocoa 视图类忘记了它的字段？

> ID：716386
> 
> 赞同：1
> 
> 时间：2009-04-04T02:33:10.823
> 
> 标签：python, xcode, macos, pyobjc

我试图破解一个工具来可视化我的游戏的着色器，我想我会尝试使用 python 和 cocoa。不过，我遇到了各种各样的砖墙。也许它是我对目标 c 的理解有点差，但我似乎无法为我试图编写的视图获取此代码：

```
from objc import YES, NO, IBAction, IBOutlet
from Foundation import *
from AppKit import *
import gv

class SceneView(NSOpenGLView):
    def __init__(self):
        NSOpenGLView.__init__(self)
        self.renderer = None

    def doinit(self):
        self.renderer = gv.CoreRenderer()

    def initWithFrame_(self, frame):
        self = super(SceneView, self).initWithFrame_(frame)

        if self:
            self.doinit()
            print self.__dict__

        return self

    def drawRect_(self, rect):
        clearColor = [0.0,0.0,0.0,0.0]
        print self.__dict__
        self.renderer.clear(CF_Target|CF_ZBuffer,clearColor) 
```

它在执行时输出：

```
{'renderer': <gv.CoreRenderer; proxy of <Swig Object of type 'GV::CoreRenderer *' at 0x202c7d0> >}
{}
2009-04-03 19:13:30.941 geom-view-edit[50154:10b] An exception has occured:
Traceback (most recent call last):
  File "/System/Library/Frameworks/Python.framework/Versions/2.5/Extras/lib/python/PyObjCTools/AppHelper.py", line 235, in runEventLoop
  File "/mnt/gilead/amcharg/projects/geom-view-edit/build/Debug/geom-view-edit.app/Contents/Resources/SceneView.py", line 37, in drawRect_
    self.renderer.clear(CF_Target|CF_ZBuffer,clearColor)
AttributeError: 'SceneView' object has no attribute 'renderer' 
```

它似乎丢失了我的渲染器变量，考虑到 initWithFrame_ 代码有多时髦，这并不奇怪，但这是 xcode 似乎写的东西，我认为这是有道理的，因为目标 C 的 init 与 alloc 习语分开。然而，看到它 python 仍然很奇怪。

有没有办法挽救这个，或者我应该在代码棚后面把它拿出来拍摄它并使用 QT 或 wxPython？我考虑过使用objective-c，但我想测试我刚刚编译的这些漂亮的swig绑定=）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-04T11:14:01.040

根据您的应用程序中其他地方发生的情况，您的实例实际上可能会被复制。

在这种情况下，实现该`copyWithZone`方法以确保新副本也获得渲染器。（警告，虽然我是一名 Python 开发人员，也是一名 Objective-C 可可开发人员，但我自己没有使用过 PyObjC，所以我不能确定你是否应该实现`copyWithZone`or `__copy__`）。

事实上，`copyWithZone`通过 print 将方法推入类中，您可以判断该方法是否正在被调用，以及这是否是渲染器似乎消失的原因。

* * *

**编辑**：根据您的反馈，我已将您的代码粘贴到一个空白的 xcode python 项目中（只是用其他东西代替 gv.CoreRenderer，因为我没有那个），并且通过一些小的修改它可以正常工作。你是如何实例化你的 SceneView 的？

就我而言，我：

*   使用 Cocoa-Python 模板创建了一个空白的 xcode 项目
*   创建了一个名为`SceneView.py`. 我粘贴在你的代码中。
*   打开`MainMenu.xib`文件，然后将一个 NSOpenGLView 框拖到窗口上。
*   选择 NSOpenGLView 框后，我转到属性检查器并将框的类更改为`SceneView`
*   回到 xcode，我添加`import SceneView`了导入，`main.py`以便在加载 xib 文件时可以使用该类
*   我实现了一个`awakeFromNib`方法`SceneView.py`来处理设置`self.renderer`。请注意，在程序执行期间不会为 nib 对象调用 , 和 ......它们被认为是“序列化”到 nib 文件中，因此已经实例化`__init__`。`initWithFrame`我在掩饰一些细节，但这就是 awakeFromNib 存在的原因。
*   一切正常运行。在调用`__dict__`中有适当的值`drawRect_`，等等。

这是 awakeFromNib 函数：

```
def awakeFromNib(self):
    print "Awake from nib"
    self.renderer = gv.CoreRenderer() 
```

所以，我猜在你的对象如何被实例化和/或添加到视图中的某个地方只有一些交叉线。您是为对象使用 Interface Builder，还是手动创建它并稍后将其添加到视图中？我很想知道您从 initWithFrame 获取登录输出，这就是为什么我要问您是如何创建 SceneView 的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-04T19:28:33.223

即使它们没有被序列化，ObjectiveC 桥也不支持 python 的 __init__ 构造函数。所以需要重载例如 initWithFrame: 用于自创视图。

# asp.net-mvc - ASP.NET MVC - 窗体上的多个按钮

> ID：716395
> 
> 赞同：4
> 
> 时间：2009-04-04T02:47:20.837
> 
> 标签：asp.net-mvc

我想在此表单上有多个按钮作为图像：

```
<% Html.BeginForm("Create", "Foos", FormMethod.Post); %>

    <!-- html form elements -->
    <%=Html.SubmitImage("Button", "save-button.gif", new { alt = "Save" })%>

<% Html.EndForm(); %> 
```

我正在阅读有关 Html.ActionImage 的信息，但我在 Microsoft.Web.Mvc 中没有看到它，我猜它已被删除，还有其他添加按钮的方法吗？

我想要一个表单上的保存、删除、发布、取消等按钮，作为图像，最好每个在控制器中调用自己的操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-04T12:26:07.373

您可以使用好的 ole html：

```
<input type="button" name="CancelButton" id="CancelButton" value="Cancel" /> 
```

或者

```
<button name="CancelButton" id="CancelButton">Cancel</button> 
```

或其中一位帮手

```
<%= Html.Button("CancelButton", "Cancel", "MyJavascriptFunction()") %> 
```

在任何情况下，除非您只想使用取消链接，否则您可能需要编写一些 javascript。

这是关于助手的一个小[博客条目。](http://blog.wekeroad.com/blog/aspnet-mvc-preview-using-the-mvc-ui-helpers/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-28T00:07:46.180

当然，一种选择是为每个按钮设置单独的表单。如果没有 Javascript 或格式错误的 HTML，这通常是不可能的或容易的。这很容易让您将每个请求发送到不同的操作方法。

这是我为多个图像提交按钮提出的解决方案。我对此并不特别满意，但它可以工作，并且如果框架中内置了替代方案，以后可以很容易地重构出来。

**在您的 HTML 中：**

```
<%= Html.SubmitImage("Dog", "~/images/dog.jpg")%>
<%= Html.SubmitImage("Cat", "~/images/cat.jpg")%> 
```

**在表单的控制器操作方法中：**

*（这是一个动作方法。由您决定如何实现每个按钮）*

```
 public ActionResult Index(FormCollection form)
    {
        // get the name of the button that was clicked (sent via either Dog.x or Cat.x since its an image button)
        var buttonName = form.GetSubmitButtonName();

        if (buttonName == "Remove" || buttonName == "Skip")
        {
           Remove(form);
        }
        else if (buttonName == "Add")
        {
           Add(form);
        }
     } 
```

**扩展方法：**

*（这会找到一个名为 Remove.x 或 Skip.x 或 Add.x 的表单参数，并去掉 .x 部分）*

```
public static class FormCollectionExtensions
{
    public static string GetSubmitButtonName(this FormCollection formCollection)
    {
        var button = formCollection.Keys.OfType<string>().Where(x => x.EndsWith(".x")).SingleOrDefault();

        // we got something like AddToCart.x
        if (button != null)
        {
            return button.Substring(0, button.Length - 2);
        }

        throw new ApplicationException("No image button found");
    }
} 
```

注意：一种替代方法是使用 CSS 将背景图像放在常规 Html.SubmitButton 按钮类型（常规 HTML 按钮而不是 HTML 图像按钮）上，但由于不同浏览器的方式不同，我觉得这并不令人满意表现（[见这个问题](https://stackoverflow.com/questions/1140014/can-i-use-a-csssprite-on-a-submit-button)）。

# c# - 您如何获得变量的名称，因为它是在其声明中物理键入的？

> ID：716399
> 
> 赞同：36
> 
> 时间：2009-04-04T02:51:55.490
> 
> 标签：c#, variables, reflection

> **可能重复：**
> [在 C# 中查找传递给函数的变量名称](https://stackoverflow.com/questions/72121/finding-the-variable-name-passed-to-a-function-in-c-sharp)

下面的类包含字段城市。

我需要动态确定在类声明中键入的字段名称，即我需要从对象 city 的实例中获取字符串“city”。

我试图通过在 DoSomething() 中检查它的类型来做到这一点，但是在调试器中检查类型的内容时找不到它。

可能吗？

```
public class Person
{
  public string city = "New York";

  public Person()
  {
  }

  public void DoSomething()
  {
    Type t = city.GetType();

    string field_name = t.SomeUnkownFunction();
    //would return the string "city" if it existed!
  }
} 
```

有些人在下面的答案中问我为什么要这样做。这就是为什么。

在我的现实世界中，城市上方有一个自定义属性。

```
[MyCustomAttribute("param1", "param2", etc)]
public string city = "New York"; 
```

我在其他代码中需要这个属性。为了获得属性，我使用反射。在反射代码中，我需要输入字符串“city”

```
MyCustomAttribute attr;
Type t = typeof(Person);

foreach (FieldInfo field in t.GetFields())
{

  if (field.Name == "city")
  {
    //do stuff when we find the field that has the attribute we need
  }

} 
```

现在这不是类型安全的。如果我在 Person 的字段声明中将变量“city”更改为“workCity”，除非我知道要更新字符串，否则此行将失败

```
if (field.Name == "workCity")
//I have to make this change in another file for this to still work, yuk!
{
} 
```

因此，我试图找到某种方法将字符串传递给此代码，而无需实际键入它。

是的，我可以将它声明为 Person 中的字符串常量（或类似的东西），但仍然需要输入两次。

呸！这很难解释！！

**谢谢**

感谢所有回答这个问题的人*很多*。它让我走上了一条更好地理解 lambda 表达式的新道路。它提出了一个新问题。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-09-04T23:58:23.730

也许你需要这个。工作正常。

我在[这里](http://www.dreamincode.net/forums/showtopic53253.htm)找到了这个。

```
static void Main(string[] args)
{
    var domain = "matrix";
    Check(() => domain);
    Console.ReadLine();
}

static void Check<T>(Expression<Func<T>> expr)
{
    var body = ((MemberExpression)expr.Body);
    Console.WriteLine("Name is: {0}", body.Member.Name);
    Console.WriteLine("Value is: {0}", ((FieldInfo)body.Member)
   .GetValue(((ConstantExpression)body.Expression).Value));
} 
```

输出将是：

```
名称是：'域'
值为：'矩阵'

```

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2010-04-19T01:09:00.283

我知道这是个老问题，但我试图实现同样的目标，谷歌把我送到了这里。几个小时后，我终于找到了方法。我希望其他人会发现这很有用。

实际上还有更多方法可以做到这一点：

```
static void Main(string[] args) 
{
  GetName(new { var1 });
  GetName2(() => var1);
  GetName3(() => var1);
}

static string GetName<T>(T item) where T : class 
{
  return typeof(T).GetProperties()[0].Name;
}

static string GetName2<T>(Expression<Func<T>> expr) 
{
  return ((MemberExpression)expr.Body).Member.Name;
}

static string GetName3<T>(Func<T> expr) 
{
  return expr.Target.GetType().Module.ResolveField(BitConverter.ToInt32(expr.Method.GetMethodBody().GetILAsByteArray(), 2)).Name;
} 
```

第一个是最快的。最后两个比第一个慢大约 20 倍。

[http://abdullin.com/journal/2008/12/13/how-to-find-out-variable-or-parameter-name-in-c.html](http://abdullin.com/journal/2008/12/13/how-to-find-out-variable-or-parameter-name-in-c.html)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-04T02:54:50.023

`city`在这种情况下是type的一个*实例*`string`。当您调用时，`.GetType()`您会返回实际的字符串类型，它完全*不知道*您的特定城市实例。

如果您需要的话，我很难理解为什么您不能在代码中将“city”作为字符串文字在这里输入。如果您分享了您想将此值用于什么以及在什么情况下调用您的`DoSomething()`函数，也许会有所帮助。

目前，我最好的猜测是，您真正想要做的是反映整个`Person`类以获取该类中的字段列表：

```
public void DoSomething()
{
    MemberInfo[] members = this.GetType().GetMembers();

    // now you can do whatever you want with each of the members,
    // including checking their .Name properties.
} 
```

* * *

好的，根据您的编辑，我还有更多内容要给您。

您可以在运行时找到用您的属性修饰的字段的名称，如下所示：

```
Type t = typeof(Person);
foreach (MemberInfo member in t.GetMembers()
          .Where(m => 
                m.GetCustomAttributes(typeof(MyCustomAttribute)).Any()  ) )
{
    // "member" is a MemberInfo object for a Peson member that is 
    // decorated with your attribute
} 
```

如果需要，您还可以在第一个 GetMembers() 调用中使用绑定标志将其限制为仅字段。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-04T06:40:50.183

您提到“即我需要从对象城市的实例中获取字符串“城市”。您是否希望从字段的值中获取字段名称。例如：如果有 2 个 Person 对象，一个与城市“纽约”，另一个与城市“伦敦”，您是否正在寻找返回“城市”的函数。这就是你所说的动态吗？

* * *

对于您当前的设计，您将始终需要将 FieldInfo 中的字段名称与字符串进行比较。如果您改为将其解耦，以便在反射期间将用于比较目的的标识符作为属性的一部分保存，该怎么办。像这样的东西：

```
 public enum ReflectionFields
{
    CITY = 0,
    STATE,
    ZIP,    
    COUNTRY

}

[AttributeUsage(AttributeTargets.Field,AllowMultiple=false)]
public class CustomFieldAttr : Attribute
{
    public ReflectionFields Field { get; private set; }
    public string MiscInfo { get; private set; }

    public CustomFieldAttr(ReflectionFields field, string miscInfo)
    {
        Field = field;
        MiscInfo = miscInfo;
    }
}

public class Person
{
    [CustomFieldAttr(ReflectionFields.CITY, "This is the primary city")]
    public string _city = "New York";

    public Person()
    {
    }
    public Person(string city)
    {
        _city = city;
    }

}

public static class AttributeReader<T> where T:class
{
    public static void Read(T t)
    {
        //get all fields which have the "CustomFieldAttribute applied to it"
        var fields = t.GetType().GetFields().Where(f => f.GetCustomAttributes(typeof(CustomFieldAttr), true).Length == 1);

        foreach (var field in fields)
        {
            var attr = field.GetCustomAttributes(typeof(CustomFieldAttr), true).First() as CustomFieldAttr;
            if (attr.Field == ReflectionFields.CITY)
            {
                //You have the field and you know its the City,do whatever processing you need.
                Console.WriteLine(field.Name);
            }
        }            
    }
}

public class Program
{
    public static void Main(string[] args)
    {
        PPerson p1 = new PPerson("NewYork");
        PPerson p2 = new PPerson("London");
        AttributeReader<PPerson>.Read(p1);
        AttributeReader<PPerson>.Read(p2);

}
 } 
```

您现在可以自由地将 Person 的 _city 字段重命名为其他名称，并且您的调用代码仍然可以工作，因为使用反射的代码正在尝试使用 ReflectionFields 枚举值设置来识别字段，该值设置为字段上属性集的初始化的一部分。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-11-24T10:19:01.673

是的，有可能！！！

试试这个...

```
 public string DoSomething(object city)
  {
       return city.GetType().GetProperty("Name",typeof(string)).GetValue(city,null);
  } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-04T22:11:25.810

这里有两件事。

第一，正如上面有人指出的那样，你得到的类型是字符串，而不是人。因此 typeof(Person).GetMembers() 将为您提供成员列表。

第二，更重要的是，您似乎误解了属性的用途。通常，属性用于标记成员以进行特定处理或添加附加信息。在这里，您使用名称来指示您想要什么处理，并使用属性来指定参数，这是隐喻的混合，或其他东西。

Abhijeet 的回答更合适，您将该字段标记为*城市*字段，然后用它做您喜欢的事情。我不同意的地方是我会使用不同的属性类，而不是枚举。

就像是：

```
 public class MyAttribute : Attribute
    {

    }

    [AttributeUsage(AttributeTargets.Field)]
    public class MyCityAttribute : MyAttribute
    {
    }

    [AttributeUsage(AttributeTargets.Field]
    public class MyNameAttribute: MyAttribute
    {
    }

    public class Person
    {

        [MyCity]
        public string city = "New York";

        [MyCity]
        public string workCity = "Chicago";

        [MyName]
        public string fullName = "John Doe";

        public Person()
        {
        }

        public void DoSomething()
        {
            Type t = typeof(Person);
            FieldInfo[] fields = t.GetFields(BindingFlags.Instance | BindingFlags.Public);

            foreach (var field in fields)
            {
                MyAttribute[] attributes = field.GetCustomAttributes(typeof(MyAttribute));
                if (attributes.Count > 0)
                {
                    if (attributes[0] is MyCityAttribute)
                    {
                        //Dosomething for city
                        break;
                    }

                    if (attributes[0] is MyNameAttribute)
                    {
                        //Dosomething for names
                        break;
                    }
                }
            }
        }
    } 
```

这将允许您为 MyCity 与 MyName 使用不同的参数，这在处理每个参数的上下文中会更有意义。

我认为您在上面的“yuk”评论中，您一针见血。如果重命名变量，则必须更改字符串常量表明您做错了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-04T03:59:34.203

看看这篇文章，因为它看起来类似于你正在尝试做的事情：

[查找传递给函数的变量名](https://stackoverflow.com/questions/72121/finding-the-variable-name-passed-to-a-function-in-c)

（尤其是 Konrad Rudolph 的回答）另一种方法可能是将“城市”添加为属性中的参数之一，然后再将其删除。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-04T04:08:20.563

您已经在循环遍历`FieldInfo`对象集合。在这些上查找您的属性，当您找到`FieldInfo`包含您的属性的属性时，您就拥有了您想要的属性。然后调用`.Name`它。

[system.reflection.fieldinfo.attributes](http://msdn.microsoft.com/en-us/library/system.reflection.fieldinfo.attributes.aspx)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-04T03:02:24.653

```
t.GetField("city", BindingFlags.Public | BindingFlags.Instance); 
```

或者您可以调用 GetFields() 来获取所有字段

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-04T03:05:18.437

您需要在 Person 类上调用 get 类型。迭代类的字段，如下面的答案

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-04T03:07:34.470

这是不可能的（我认为实际上是这样，但涉及一些黑客和使用 lambdas）。如果您想存储关于 a 的属性`Person`并能够轻松获取属性的名称，我建议使用命名空间中`Dictionary<TKey, TValue>`的a `System.Collections.Generic`。

而且您始终可以创建包装字典的公共属性。

```
public class Person
{
  Dictionary<string, string> attributes = new Dictionary<string, string();
  public string City
  {
    get { return attributes["city"]; }
    set { attributes["city"] = value; }
  }

  public Person()
  {
    City = "New York";
  }
} 
```

您可以使用 获取所有属性的列表`attributes.Keys`。

# jquery - 什么时候可以使用 jQuery？

> ID：716403
> 
> 赞同：8
> 
> 时间：2009-04-04T02:53:19.480
> 
> 标签：jquery

我最近一直在思考在哪里划清界限，我想从你们那里有经验的开发人员那里得到一些答案。什么时候可以在 Web 应用程序中引用 jQuery？

**Always Using jQuery**的一些支持论点：

*   您可以从 Google 的存储库中引用 jQuery，它可能已经缓存在客户端上，从而消除了额外的大量请求
*   您不必处理常见的跨浏览器问题，因为它们已经得到处理
*   您喜欢编写代码，因为它对开发人员友好

**从不使用 jQuery**的一些支持论点：

*   令人不安的第三方库依赖，可能包含代价高昂的错误，并可能导致不合理的低性能
*   您必须学习一种新语法（就在您认为自己已经掌握了常规 Javascript 的时候......）
*   由于框架固有的复杂性，即使是最简单的任务也可能表现不佳

我将论点列为问题的一部分，因为我不希望得到权衡双方论点的答案。我希望总是/从不回答，最好是测试用例场景（模糊*或*详细）。

例如：“如果我需要在我的网络应用程序中执行任何 AJAX 请求，我总是使用 jQuery”。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-04-04T02:58:33.680

如果我需要在我的 Web 应用程序中执行 document.getElementById() 之后的任何操作，我总是使用 jQuery。

老实说，我发现您反对 jQuery 的大多数反对论点都很薄弱，尤其是最后一个：

> 由于框架固有的复杂性，即使是最简单的任务也可能表现不佳。

完全不同意这一点。jQuery 非常简单而强大，这就是我喜欢它的地方。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-04-04T03:31:52.663

> 令人不安的第三方库依赖，可能包含代价高昂的错误，并可能导致不合理的低性能

累积起来，jQuery 开发人员在消除各种浏览器上的错误和性能问题方面投入的精力远远超过您或任何其他小型团队所能承受的。

Not-Invented-Here 综合症是在浪费你的时间。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-04T03:31:07.347

没关系——你可以写好代码或烂代码，有或没有 jquery。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-04T02:58:19.390

当您需要 DOM 中没有的额外灵活性时，这是可以接受的。默认情况下，我不包括 JQUERY；但是，一旦我需要进行任何客户端提升，我就会转移到 JQUERY。

我什至会同时使用 JQUERY 和 MSAjax（主要是在我正在远离 MSAjax 的遗留页面上）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-04T02:59:13.303

我想说，只要您不想浪费时间处理不同的 Javascript 实现，使用 jQuery 是可以接受的。这可能非常接近总是..

如果您所做的只是一件相当小而琐碎的事情，那么引入 jQuery（缩小 19KB）作为依赖项可能有点矫枉过正。

如果没有必要，不要重新发明轮子！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-04T03:31:47.797

我发现 javascript 对 jQuery 没有简化的有用的东西并不多。

对于数据验证，我更喜欢只有一个实现，因为无论如何我都必须让服务器验证所有内容，所以还不如使用 AJAX 进行表单验证。jQuery 在这方面非常擅长。

对于 DOM 操作，jQuery 提供了一种简洁的方式来表达我可能需要的内容。当然比我原本需要的 3 到 10 个函数调用更短且可能更清晰。

很少需要视觉效果。它们也很难便携。为了利益，如果我找不到预包装的视觉效果，我可能没有它会更好。jQuery UI 和几个已建立的插件符合要求。

还有很多其他的 JavaScript 库，我相信其中很多都很棒，但除非它们提供绝对不可或缺的功能（例如，Google API），否则我可能也可以让 jQuery 做得很好，而且我已经熟悉jQuery。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-04T03:41:32.907

我从不使用 jQuery ......至于为什么？从来没有真正想过它，我想我只是没有找到使用纯 Javascript 之外的任何东西的理由。另外，我不喜欢依赖我不理解的抽象层。（当然，我用 Javascript 做的事情并不是特别复杂，所以在我的情况下，也许 jQuery 确实比它的价值更麻烦。）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-04T04:02:57.287

今天我在一个页面上添加了一个 Javascript 补丁，我必须将一个 div 从其在 DOM 树中的原始位置移出，并使其成为 body 的子级，以便它可以正确定位。我知道它只需要在启动时针对特定的 id div 发生一次，并且该页面不会使用任何其他 JS 行为。所以我就手写了。

对于更复杂的东西，它是 jQuery。高级 API 为我节省了很多时间，否则我将不得不花时间与计算机“交谈”。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-07-09T14:50:52.157

好吧，至少在[EcmaScript 5](http://www.youtube.com/watch?v=Kq4FpMe6cRs)出来之前，直到浏览器在其 JavaScript 引擎中实现一套通用规范之前，jQuery 是我们必须解决跨浏览器问题的最佳工具。不久前，每次启动 js 文件时，都必须从[浏览器检测](http://www.quirksmode.org/js/detect.html)功能开始。我使用了原型、mootools、dojo 和最近的 jQuery，我对他们提供的帮助非常满意。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-08-09T00:37:25.633

仅仅为了浏览器兼容性而使用 jQuery 并不是我使用 jQuery 的充分理由。现在大多数 javascript 框架已经能够解决这个问题。至于我，如果我需要一个非常简单的支持 Ajax 的 DOM 操作工具，我会使用 jQuery。如果我需要除此之外的东西，我会使用其他 javascript 框架。如果我需要 Javascript 面向对象的支持，我会使用[Mootools](http://mootools.net/) ，如果我需要大量的内置小部件，我会使用[Ext-JS 。](http://extjs.com/)

# php - 为什么在基本功能上使用 PHP OOP？何时使用？

> ID：716412
> 
> 赞同：58
> 
> 时间：2009-04-04T03:00:23.410
> 
> 标签：php, oop

有一些关于这个问题的帖子，但我没有清楚地知道何时使用面向对象编码以及何时在包含中使用编程函数。也有人跟我提过，OOP 运行起来非常繁重，而且工作量更大。这是正确的吗？

假设我有一个包含 50 个函数的大文件。为什么我要在课堂上调用这些？而不是通过function_name（）？我应该切换并创建一个包含我所有功能的对象吗？有什么优势或具体区别？它给 PHP 中的 OOP 代码带来了什么好处？模块化？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-04-04T03:24:29.810

在很多情况下，过程式编程就可以了。为使用它而使用 OO 是没有用的，特别是如果您最终要使用[POD](http://en.wikipedia.org/wiki/Plain_old_data_structure)对象（普通旧数据）。

OO的强大主要来自于继承和多态。如果您使用类，但从不使用这两个概念中的任何一个，那么您可能一开始就不需要使用类。

OO 最出色的地方之一是 IMO，它允许您摆脱开机类型代码。考虑：

```
function drive($the_car){

    switch($the_car){

      case 'ferrari':
          $all_cars->run_ferrari_code();
          break;

      case 'mazerati':
          $all_cars->run_mazerati_code();
          break;

      case 'bentley':
          $all_cars->run_bentley_code();
          break;
    }
} 
```

使用它的 OO 替代方案：

```
function drive($the_car){

    $the_car->drive();
} 
```

多态性将允许基于运行时信息发生正确类型的“驱动”。

* * *

多态性注意事项：

这里的第二个例子有一些前提：所有的汽车类要么扩展一个[抽象](http://php.net/manual/en/language.oop5.abstract.php)类，要么实现一个[接口](http://php.net/manual/en/language.oop5.interfaces.php)。

两者都允许您强制扩展或实现类以定义特定功能，例如`drive()`. 这是非常强大的，因为它可以让你在`drive()`不知道你驾驶哪一辆的情况下驾驶所有汽车；那是因为他们正在扩展一个包含该`drive()`方法的抽象类或实现一个强制`drive()`定义该方法的接口。

因此，只要您确保所有特定的汽车要么扩展抽象类`car`或实现一个接口，例如`canBeDriven`（两者都必须*声明*该`drive()`方法），您就可以`drive()`在您知道是汽车的对象上调用该方法（但不是什么类型的汽车）而不用担心它没有被定义，因为 PHP 会向你抛出致命错误，直到你在特定的汽车类中定义这些方法。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-04T03:59:07.497

我会尽量保留我的答案作为补充，因为 Majd Taby 和 Coobird 的答案非常好。

几年来，我主要是一名程序程序员，并没有反对 OOP 编程，但从未真正看到太多相关性……直到我开始在一个团队中工作并构建更重要和更复杂的项目。

在我看来，当您需要为更复杂的应用程序编写精简、易于维护的代码时，OOP 真的很出色。请注意，并非在所有情况下，但在某些情况下，程序就不能很好地工作。

我的大多数优秀 OOP 实现示例都是针对我有几件相关但略有不同的项目的项目。具有大量表单、大量用户、大量产品等的网站。

它们都有类似的行为名称，例如 print()、update() 等……但是通过将它们封装为对象并在类中改变方法的实现，我可以使我的代码在运行时在整个站点中非常简单和干净。此外，这一点很关键，尽管有不同的行为，但我可以**在整个应用程序中使用相同的方法调用来**处理不同的对象。它允许第二个开发人员在我处理更深层次的代码时进行实际实现。

我不知道这是否有帮助，但作为不久前处于你这种情况的人来说，我喜欢 OOP。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-04-04T03:13:34.127

在程序中使用面向对象的编程方法而不是过程式编程方法实际上并不取决于语言（无论是否是 PHP），而是取决于您要解决的问题的类型。

（我将在我的示例中使用伪代码，因为我对 PHP 不太熟悉。）

例如，如果您有一个程序，您只是按顺序执行一堆功能，那么程序就可以了。例如，如果它是一个简单的字符串操作程序，那么程序方法就足够了：

```
perform_truncation(my_string, 10)
to_upper(my_string)
perform_magic(my_string, hat, rabbit) 
```

但是，如果您要处理许多不同的项目（例如文件，或者对象的任何其他表示形式），那么面向对象的方法会更好。

例如，如果您有一堆`Car`s 并希望它们成为 s `drive`，那么在程序上，您可以执行以下操作：

```
drive_car(first_car)
drive_car(second_car) 
```

而在 OOP 中，`Car`可以自行驱动：

```
RedCar myRedCar();
BlueCar myBlueCar();

myRedCar.drive();
myBlueCar.drive(); 
```

而且，由于每辆车都是不同的类别，它们的行为可以有不同的定义。此外，它们可能都是子类，`Car`也可能具有共同的功能。

这实际上归结为使任何一种程序方法都比面向对象更好的问题类型，反之亦然。

抛开程序或面向对象的问题不谈，一个源文件有很多功能可能是一种“代码味道”。对于包含许多功能的类也可以这样说，这些功能可以作为单独类中的单独功能更好地执行。

这里的问题可能是代码组织而不是决定选择过程或面向对象的编程。将函数组织到单独的源文件中可能是这里需要的，而不是放弃编写程序的过程方法。

毕竟，有很多程序是用过程式编程方法编写的，这些程序编写得很好并且易于维护。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-01-23T11:27:39.850

> 假设我有一个包含 50 个函数的大文件，为什么要在一个类中调用这些函数？而不是 function_name()。我应该切换并创建包含我所有功能的对象吗？

迁移到 OOP 不应被视为您上面描述的简单“切换”。

OOP 需要一种完全不同的编程思维方式，这涉及重新连接你的大脑。由于大脑的重新布线不会在一夜之间发生，因此许多人不愿意将自己暴露在所需的重新布线过程中。不幸的是，重新布线将花费时间和精力：研究、教程、反复试验。

它确实涉及退后一步并了解 OOP 背后的概念，但作为在 www 之前经历过这个过程的人来说，回报将是非常值得的。

在您“了解”并在日常生活中遵循 OOP 最佳实践之后，您将告诉其他人您的编程生活如何变得更好。

一旦你真正理解了 OOP，你就会回答你自己的问题。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-04T03:07:50.663

如果你在 Utilities 类中有 50 个函数而不是 50 个静态方法，那么你“污染”了全局命名空间。

使用具有 50 个静态方法的类，方法名称对您的类来说是本地的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-04T03:43:41.590

我不能说哪个更好。但根据我的经验，您可以使用 OOP 进行更好的代码管理。你知道哪些代码在哪里，在哪个文件中定义了哪些功能等等。关于我在某处读到的 OOP 的运行时开销（我认为这是真的），如果你在经典函数中编写了错误的代码，以及相同的错误代码在 OOP 中，函数版本效果更好。因此，如果您的代码写得不错，则没有证据表明 OOP 会使您的应用程序运行缓慢。还要记住，这些“慢”和“开销”的东西都以毫秒为单位。因此，如果您的应用程序没有为大量用户提供服务（例如一分钟内超过 100 个用户），您可能不会感觉到任何差异。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-07T11:59:11.110

OOP 允许您创建结构化的代码容器，称为类，它们可以是彼此的父/子。这有助于构建应用程序，因为它更易于维护，并且如果操作得当，可以减少代码冗余。OOP 确实增加了一些开销，但它并不明显，并且被程序代码的不可维护性所抵消。如果您编写一个大型应用程序，请务必使用 OO，尤其是当它要由很多人开发时。

例如，假设您正在设计一个简单的网站。您可以创建一个 Page 对象。页面对象负责访问数据库并获取页面的各种设置，例如元数据、标题标签，甚至页面上某些“组件”的数量及其类型（例如日历控件、小部件， ETC）。

然后，您可以创建另一个类，例如 Index，它扩展 Page。索引将是索引或主页。如果您有产品目录，则可以有目录类扩展页面。由于您的目录部分和主页都需要从数据库中获取有关页面元数据和页面基本结构的数据，因此拥有 1 个已经为您执行此操作的对象会有所帮助。在这两种情况下，页面都会完成所有工作并从数据库中获取页面数据，将其加载到变量中，然后在您的索引类和目录类中都可以访问这些变量。您不必编写代码即可进入数据库并在您编写的每个页面中再次获取它。

现在还有其他方法可以在程序上执行此操作，例如使用包含。但是，您会发现自己犯的错误和错误更少。例如，您可以在 Page 类中定义一个抽象方法。这意味着这个方法必须在任何扩展它的对象中定义。假设您在 Page 类中创建了一个 setPageAttributes() 函数作为抽象函数。当你这样做时，你会创建一个空函数。当您创建索引类时，您必须创建一个 setPageAttributes() 函数（用于填充它，例如访问 Page 类中定义的变量并使用它来设置页面、模板或查看您正在使用的视图）或您收到 PHP 错误。

如果您正在与其他人一起编写您的项目，抽象方法会告诉该人，“嘿，您需要在您编写的任何代码中定义这些函数”。这迫使应用程序保持一致。

最后，如果你不做 OOP，你就不能去诸如 MVC 格式之类的框架。虽然没有必要使用 MVC 并且存在一些争论，但它确实分离了应用程序的所有组件，并且在许多人（设计师、编码人员、营销人员）在同一代码上工作的环境中是必要的。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-04-01T20:05:27.493

使用 oop 可为您带来以下好处：

1.  结构化
2.  可重用性
3.  易于维护
4.  数据封装

到了用50个函数制作大文件的地步。你可以这样做，但是当涉及到函数的流程以及如何在每个函数之间绑定数据数据时，将是一个最大的问题。

此外，如果您想替换最大的流程块，那么对于未来的维护，相信我，您必须访问每个功能并围绕它进行操作。此外，您永远不知道您的函数如何在代码的其他部分中使用。所以面向对象编程总是可取的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-01-17T04:18:50.593

接受的答案似乎忽略了说明可以根据变量名称调用函数，例如此处的示例：

```
function drive($the_car){
    $the_car();
} 
```

诚然，在这种情况下，每辆车都需要一个函数，但它比建议的 switch 语句更有效。

* * *

可以像这样轻松地提供其他变量：

```
function operate($the_car,$action){
    $the_car($action);
}

function ferrari($action){
    switch($action){
        case 'drive':
            echo 'Driving';
            break;

        case 'stop':
            echo 'Stopped';
            break;

        default: return;
    }
}

operate('ferrari','drive'); 
```

这里有一个 switch 语句，但它提供了原始示例中没有的附加功能，所以这绝不是矛盾的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-07-03T08:32:00.147

PHP中使用了OOPs概念，以保护代码。由于所有查询都写在函数文件而不是代码文件中，所以没有人可以轻易破解我们的代码。所以最好在 PHP 中使用类而不是直接编写查询。

# php - PHP in_array 触发内部服务器错误

> ID：716417
> 
> 赞同：2
> 
> 时间：2009-04-04T03:03:58.800
> 
> 标签：php, apache

这真的不应该这么复杂，这表明我做错了什么，但是在检查了文档后我不知道是什么。

我正在尝试使用这段代码（$level 作为参数传入）进行简单检查，以查看“标记”的类型是否在此操作期间要使用的类型列表中：

```
$filter = $this->levels[isset($this->levels[$level])?$level:'max'];
foreach($this->tags as $name => $tag)
{
    $firephp->warn($tag);
    if(in_array($tag->type , $filter) == false) continue;
    // code omitted (this is where it dies)
} 
```

检查 FirePHP 报告发生 500 Internal Server Error，我有 99.9% 的把握它在这里（就像我说的，这是 PHP 执行停止时的行）。所以我认为这是两个问题：我如何进行这项工作，以及为什么会发生这种情况？

另外，如果重要的话，我在 Windows Vista（32 位）上使用 Apache 2.2.11 和 PHP 5.2.9-1 和 MySQL 5.1

**更新：**没关系 - 原来是语法错误。如果有人可以关闭这个问题，那就太好了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-04T03:05:53.257

为什么不打开 error_reporting 以获得更详细的错误信息？

```
error_reporting(E_ALL);
ini_set('display_errors', 1); 
```

# c# - 根据 GridView 中绑定的数据更改 ASP 按钮的属性？

> ID：716418
> 
> 赞同：2
> 
> 时间：2009-04-04T03:04:32.933
> 
> 标签：c#, .net, asp.net

我正在处理一个带有 GridView 的表单，从 SQL Express 数据库中提取数据。最后一列将是一个按钮，我希望能够根据绑定到该列的数据进行更改。

该按钮将用作“启用/禁用”切换。基本上，如果启用了用户，我希望按钮说“禁用”并让 OnClientClick 属性指向禁用功能；如果用户被禁用，我希望按钮读取“启用”并指向启用功能。

我的google-fu今天很弱，希望大家能有所帮助。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-04T03:21:24.920

试试这个，我假设你的启用/禁用是数据库中的一个位值

```
<asp:TemplateField>
  <ItemTemplate>
    <asp:Button runat="server" ID="btn" Text='<%# "1".Equals(Eval("Enabled").ToString()) ? "Enabled" : "Disabled" %>' OnClick='<%# "1".Equals(Eval("Enabled").ToString()) ? "DISABLE_METHOD" : "ENABLE_METHOD" %>' />
  </ItemTemplate>
</asp:TemplateField> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-04T03:21:56.930

在用于绑定网格的数据集中设置文本“启用/禁用”。

然后，利用模板列，将按钮定义为：

```
<asp:button text='<%# Eval("IsEnabled") %>' runat=server commandname='<%# Eval("IsEnabled") %>' commandargument ='<%# Eval("UserId") %>' id="myButton" /> 
```

然后，在网格的 RowCommand 事件上，执行以下操作：

```
dim btn as button = e.item.findcontrol("myButton")
select case e.Command
  case "Enable"
    myDisableFunction(e.commandargument)
    btn.Text = 'Disable'
    btn.Cmmand = 'Disable'
  case "Disable"
    myEnableFunction(e.commandArgument)
   btn.Text = "Enable"
    btn.Commandname="Enable"
end case 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-04T03:11:53.930

使用 OnRowDatabound 事件（假设 .net 2.0 以上）作为您的起点。然后，您将可以访问该行的行数据，并可以根据需要更改您的按钮。我会看看我是否可以为你挖掘一个具体的例子。

# c - 在 C 中使用 USB (Windows)

> ID：716421
> 
> 赞同：0
> 
> 时间：2009-04-04T03:06:23.880
> 
> 标签：c, windows, usb

这是几个问题汇编成一篇文章。

1) 判断 USB 大容量存储设备是否已插入的最佳方法是什么。

2) 将数据写入 USB 驱动器的最佳方法是什么

3）你能像对待普通内存一样对待 USB 驱动器上的内存吗？（我可以像 malloc 一样使用，或者直接用值 / 写两个它，或者将它归零吗？）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-04T03:34:32.563

USB 驱动器显示为驱动器号。[`GetDriveType`您可以使用API](http://msdn.microsoft.com/en-us/library/aa364939.aspx)检测到它可能是 USB 设备。然而，这只告诉你它是可移动的，而不是它实际上是一个 USB 驱动器。要说明这一点，您可能需要查看[SetupDiGetDeviceRegistryProperty](http://msdn.microsoft.com/en-us/library/ms792967.aspx)函数（引用自`GetDriveType`MSDN 参考）。此外，安装的磁盘可能不是驱动器号，或者驱动器号不代表磁盘安装，因此要查找所有 USB 驱动器，您需要查看其他一些 SetupDi... 功能。

因为它是一个驱动器号，所以读取和写入 USB 驱动器的常用方法是使用文件系统函数，例如`fopen`Windows `CreateFile`. 如果您想像记忆一样直接写入它，您可以创建一个跨越整个设备的文件，然后对该文件进行内存映射。但是，我不建议这样做，除非在专门的应用程序中，因为如果出现 I/O 错误（包括例如用户拔出驱动器），那么您的程序将得到一个 SEH 异常，这会带来很多复杂性最好避免。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T08:09:31.613

你可能想看看`HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum\USBSTOR`。它会告诉您哪些 USB 存储设备是已知的。这些条目都包含一个 ParentIdPrefix。如果驱动器当前存在，则可以在`HKEY_LOCAL_MACHINE\SYSTEM\MountedDevices`值的数据部分中找到。

# ruby-on-rails - 防止市场应用程序欺诈的最佳方法？

> ID：716423
> 
> 赞同：9
> 
> 时间：2009-04-04T03:07:32.363
> 
> 标签：ruby-on-rails, aggregation, marketplace, fraud-prevention

我正在开发一个市场网站，导师和学生可以在其中找到彼此。我正在建立一个在线支付系统（很像 elance 或 guru.com），导师可以在其中获得报酬，我们可以从中分得一杯羹。

几个问题：

1.  阻止来自某些国家（如尼日利亚）的 IP 地址的最佳方法是什么？（注意，我使用的是 Ruby on Rails，因此任何特定于此的建议都会更好，但如果不是也可以。）

2.  除了阻止某些 IP，我还可以使用哪些其他技术？（我已经在做 AVS 和正常的网关检查）。

3.  我需要检查哪些常见的骗局？

例如，我能想到的一个人使用该系统为自己付款，他们收到资金作为付款（减去​​我们的费用），然后对信用卡进行退款。

我想这些类似于 Paypal 或 Google Checkout 等网站（有些人称这些聚合网站）所面临的问题，因为它们收取一小部分费用 - 所以如果失去原始资金来源，那将是巨大的损失（很多倍的与正常的高利润产品不同，所涉及的利润）。

几个附加说明：

1.  我的用户帐户已经需要电子邮件验证 - 这是最低要求，我正在寻找超出此范围的内容
2.  直接存款有 3-5 天的等待期 - 这是银行要求的 - 但仍然没有回答如何在这 3-5 天内确定是否是欺诈以便可以取消的问题
3.  我宁愿避免一种既惩罚好人又惩罚坏人的解决方案-例如收取注册费用或让他们将资金留在那里直到要求提款（例如Paypal）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-07T18:19:47.917

这是我到目前为止所做的，如果人们有更多建议，请回复：

1.  设置一个“欺诈审查”标志，如果设置需要某人（我）在发送直接存款资金之前手动查看它
2.  如果发送的金额 > 300 美元，则自动欺诈审查
3.  如果导师和学生请求的ip地址相同，则欺诈审查
4.  检查他们的姓名和地址，看看他们是否“基本匹配”——即他们都可以有名字“约翰”，因此有一个阈值，即有多少“匹配”构成了举报欺诈审查的理由

该函数看起来有点像这样（注意这不包括检查 IP 地址的代码）

```
 def fraud_review invoice
    return true if invoice.total > 300

    #try to find out if they are the same person!
    client = invoice.client
    tutor = invoice.tutor

    count = 0
    client.full_name.split.each do |piece|
      count += 1 if tutor.full_name.include? piece
    end
    client.name_on_card.split.each do |piece|
      count += 1 if tutor.full_name.include? piece
    end
    client.street.split.each do |piece|
      count += 1 if tutor.street.include? piece
    end

    return true if count > 2
    false
  end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-04T03:42:19.347

我认为有几种方法可以添加额外的层来抑制这些行为。

1.  所有付款均由确认的用户帐户进行（通过电子邮件确认）
2.  根据银行清算延迟付款 3 - 5 天。
3.  付款不是直接应用到用户的信用卡/银行帐户，而是可以以类似于 PayPal 的方式“在线”存储，并且用户必须手动请求提款。
4.  对于 IP 阻止，我实际上会转到服务器级别并设置 IP 表。我不是系统管理员，所以我不知道来龙去脉。
5.  我已经阅读并参与了几个试图通过收取象征性注册费来减少恶意行为的网站。它令人惊讶地降低了网站上存在的呆小症水平。

一般来说，有志者事竟成。密切关注网站上的活动，并制定一些系统化的标记规则，提示网站管理员仔细查看帐户或活动。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-04T03:45:13.460

对于国家/地区封锁，您需要一个 IP 地理定位数据库，其中有许多免费和商业可用的数据库。我建议根据维护的好坏来评估潜在的候选数据库。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-05-01T22:54:11.410

我将从一般的欺诈检测策略而不是专注于 Ruby-On-Rails 的答案中回答这个问题。相对当前的欺诈检测系统通常包括以下一些：

1.  [持久性 cookie](https://stackoverflow.com/questions/3869821/how-do-i-create-a-persistent-vs-a-non-persistent-cookie) - 将 cookie 存储在用户的硬盘中。您可以使用它来比较来自伪装成不同人的同一设备的流量。
2.  [指纹设备](https://stackoverflow.com/questions/3869821/how-do-i-create-a-persistent-vs-a-non-persistent-cookie)- 这只能使用 JavaScript 解决。您可以使用它来比较来自伪装成不同人的同一设备的流量。
3.  寻找自动脚本的签名。如果有人试图将来自其他服务的被盗凭据填充到您的服务中，这可能会有所帮助。我相信您知道，用户永远不会重复使用凭据！
4.  IP 信誉 - Tor 出口节点？（开源信息）。根据您的应用程序，可能存在允许来自 tor 的流量的合法案例，但如果用户需要告诉您他们将使用您的服务的是谁，那么就没有匿名的案例。
5.  [混淆尝试](https://en.wikipedia.org/wiki/P0f)- UA 是否匹配机器？如果有人试图混淆他们的起源，他们很可能没有好处。您可以根据自己的舒适程度阻止此流量。

该解决方案优于公认答案的优势在于，这与用户帐户无关。缺点是，如果您是唯一一个构建整个应用程序的人，那么构建起来要复杂得多。根据我的经验，持久性 cookie 通常很容易实现，并且可以阻止一些低级别的欺诈者。

需要考虑的事情：您提到您设置了 3,000 美元的硬编码障碍。我想一个坚定的欺诈者会弄清楚并尝试像 2999.99 美元这样的东西来绕过你的控制。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-04T03:13:54.143

要阻止来自特定国家/地区的 ip，您必须弄清楚那里的 ip 地址范围。然后您所要做的就是配置您的防火墙以拒绝来自这些范围的流量。

# webserver - 在网络服务器上存储文档 - 最佳方法

> ID：716431
> 
> 赞同：3
> 
> 时间：2009-04-04T03:14:22.643
> 
> 标签：webserver, filesystems

我正在做一个项目，其中一项要求是文件上传和查看。我决定将文档存储在 Web 服务器上而不是数据库中。我的问题是……在服务器上存储大量文档的好方法是什么？上传的文档将与数据库中的主记录 ID 相关联，因此我考虑创建一个与主记录具有相同日期的文件夹，然后在文件名前面加上这样的 ID

2009-4-3
 234
  234-document.pdf
  234-courtrecord.pdf

这看起来可靠和直观吗？我将 ID 添加到文件中，以防它因任何特定原因被移出文件夹。以这种方式存储它们会有什么缺点吗？

只是寻找反馈，也许是一个更好的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-04T03:56:39.453

我会使用一个平面文件系统，通过一些（生成的？）标签和记录 ID 组合来命名文件。不需要文件夹。如果要实现版本控制，可以使用日期时间戳。我已经看到有几个这样构建的系统运行良好。

如果您确实选择使用文件夹系统，请非常务实地执行文件夹命名、放置。您也可以将这两个选项结合起来。

就个人而言，我会将您的存储过程/实施与您的应用程序/访问过程分开，而不是让一个决定驱动另一个决定。使用应用程序逻辑访问文件。尽可能有效地存储它们。

例如，您可以根据需要集中存储文件，然后使用语义层以多种方式（名称、主题、类型等）查找文件。想想 wiki 系统是如何工作的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T03:47:13.733

与大型存储库相比，将文件存储在单独的、过时的文件夹中是否有任何价值？我建议使用单个目录存储库并使用通用文件处理程序。加班它会被证明是有用的。

如果记录 ID 与文件相关，则在文件名前面加上记录 ID 是个好主意。我经常在前面加上时间戳。

我们已经使用语言 (PHP) 中的本地 FTP 函数构建了几个文件存储系统，并使用了时间戳前置方法，它被证明是非常有效的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T03:15:45.870

那么像[OpenCMS这样的](http://www.opensourcecms.com/)[内容管理系统呢？](http://en.wikipedia.org/wiki/Content_management_system)

检查[此列表](http://en.wikipedia.org/wiki/List_of_content_management_systems)以获取其他人。

# .net - 是否有正确的方法来处理 httpwebrequest？

> ID：716436
> 
> 赞同：41
> 
> 时间：2009-04-04T03:23:08.037
> 
> 标签：.net, httpwebrequest

我正在使用`HttpWebRequest`, 并且正在处理响应流。是否有正确的处理方法`HttpWebRequest`，因为它不包含 close 或 dispose 方法？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2017-02-15T05:40:32.643

我有一个类似的问题，这里的答案没有给我我需要的信息。因此，即使有一个公认的答案，我也会添加我学到的知识来帮助下一个人。

1）正如其他一些答案所提到的，您可以使用`using`从 HttpWebRequest/WebRequest 返回的流。这只是很好的标准 c# 编程。

但它并没有真正解决 OP 的问题（或我的问题），即关于处理 HttpWebRequest 对象本身的问题。

2) 尽管获取 HttpWebRequest 的函数名为“Create”，但没有匹配的 Destroy、Close、Dispose 或任何其他可用于从创建的对象中释放资源的机制。

这基本上是目前公认的答案。

3）但是这里的所有答案都暗示（除了流）没有任何重要的东西*需要*关闭。这并不完全正确。

使用[ProcMon](https://technet.microsoft.com/en-us/sysinternals/processmonitor.aspx)，您可以看到`TCP Connect`,`TCP Send`和`TCP Receive`调用时发生的情况`GetResponse()`。这是我希望看到的。但是什么时候`TCP Disconnect`发生呢？我的假设是，这会在您完成接收响应之后发生，或者最坏的情况是在对象被 GC 处理时发生。但现实更有趣。

相反，TCP 连接在调用后恰好保持活动 2 分钟。我的第一个想法是 GC 需要多长时间才能解决它，但不。您可以在 GC.Collect() 循环中坐在那里 2 分钟，直到 2 分钟结束才放手。这会在客户端和服务器上保持连接打开，并在这 2 分钟内导致（一些）额外的网络流量以保持连接处于活动状态。

另一个有趣的事情是，即使您调用“创建”，这并不意味着必须创建另一个 TCP 连接。例如，考虑一下：

```
static void Doit(string domain)
{
    HttpWebRequest hr = (HttpWebRequest)WebRequest.Create(domain);

    using (HttpWebResponse response = (HttpWebResponse)hr.GetResponse())
        using (Stream receiveStream = response.GetResponseStream())
            using (StreamReader readStream = new StreamReader(receiveStream, Encoding.UTF8))
                Console.WriteLine(readStream.ReadToEnd());
} 
```

现在，如果我用以下方式调用它：

```
Doit("http://www.foo.bar"); 
```

它将创建 1 个 TCP 连接。它将保持活动状态 2 分钟（或直到程序退出）。但是，如果我这样做：

```
Doit("http://www.foo.bar");
Thread.Sleep(20000);
Doit("http://www.foo.bar"); 
```

现在它将为第一次调用创建一个连接，然后为第二次调用*重用*该连接。这意味着 TCP 连接将保持活动状态总共 2:20 分钟。因此，即使我们调用“创建”，它也不是从头开始创建连接。

大多数情况下，这是一件好事。建立连接（尤其是 HTTPS 连接）可能是一个昂贵的过程。自动为您避免这种情况的系统（可能）是一件好事。这样，您可以有效地检索网页的 html，然后检索任何相关的支持文件（css、img 文件等），而无需每次都经过连接过程。

但是，如果您要连接的服务器只支持有限数量的连接怎么办？像这样无缘无故地将连接捆绑起来可能是一个真正的问题。或者可能出于安全原因，您不能长时间保持连接打开？或者，也许您只是肛门，并且想在完成后立即关闭它。

对于这些情况，您可以尝试使用`HttpWebRequest.KeepAlive`. 将此设置为`false`（默认值为`true`）会导致上面的每个示例都使用自己的连接，一旦完成就关闭它们。因此，整个连接/发送/接收/断开过程可以在不到一秒的时间内完成。

供参考：

*   虽然您可以使用 WebRequest.InitializeLifetimeService 来获取 ILease，但更改租约上的值不会影响此处的超时。
*   您可以使用支持 Dispose 的 WebClient，而不是使用 WebRequest。然而，即使在调用 Dispose 之后，底层 TCP 连接仍会挂起 2 分钟。

总之：说您不需要担心关闭 HttpWebClient 可能通常是正确的，但您可能需要注意其中的一些含义。这种行为有充分的理由，但如果您不知道这种情况正在发生，您无法确定这是否对您的特定应用程序有利。

FWIW

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2009-04-04T03:31:43.180

如果该类有特殊的处理要求，它会实现 IDisposable。由于它没有实现 IDisposable，您可能会认为您不需要做任何特别的事情。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-04T03:36:27.597

httpwebRequest 没有实现 IDisposable，因为它可以创建一个 Stream，它实现了 IDisposable。因此，您不必担心将其丢弃。

如果您担心，您可能想要使用 IDisposable 的 WebClient：

```
using (WebClient c = new WebClient())
{
using (Stream stream = c.OpenRead(url))
{
//
}
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-05-04T22:02:51.200

您可以使用：

```
 var webRequest = WebRequest.Create(ActionUrl)
    using (var webResponse = webRequest.GetResponse())
    {} 
```

为您的实施。当我使用 WebRequest 类在很短的时间内触发多个请求时，将 GetResponse() 包装在 using 块中可以防止应用程序挂起。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2009-04-04T03:31:36.597

HttpWebRequest 没有实现 IDisposable 所以它不需要处理。完成后，只需将 httprequest 对象设置为 null 即可。

希望能帮助到你

# asp.net - 使用 asp.net 进行多因素登录

> ID：716439
> 
> 赞同：2
> 
> 时间：2009-04-04T03:24:53.303
> 
> 标签：asp.net, login

有没有人创建或阅读过有关为 asp.net 创建多因素登录系统的文章？这些想法是在登录后有一个安全问题来验证用户。安全问题将是他们会产生的东西。有点类似于一些网上银行的做法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-04T03:27:33.890

好吧，您将无法使用 ASP.NET 的内置登录控件，但滚动您自己的登录控件很容易。您只需延迟调用 FormsAuthentication.SetAuthCookie(...); 直到第二页之后。

# html - CSS 单元格边距

> ID：716442
> 
> 赞同：109
> 
> 时间：2009-04-04T03:28:09.177
> 
> 标签：html, css, cell, margin, css-tables

在我的 HTML 文档中，我有一个包含两列和多行的表格。如何使用 css 增加第一列和第二列之间的空间？我试过应用“margin-right：10px;” 到左侧的每个单元格，但没有效果。

* * *

## 回答 #1

> 赞同：158
> 
> 时间：2010-06-07T02:35:24.330

一句警告：虽然`padding-right`可能会解决您的特定（视觉）问题，但这不是在表格单元格**之间添加间距的正确方法。**对单元格的作用与`padding-right`对大多数其他元素的作用相似：它在单元格**内**增加了空间。如果单元格没有边框或背景颜色或其他让游戏消失的东西，这可以模仿设置单元格之间的空间的效果，但不是其他的。

正如有人指出的那样，表格单元格的边距规格被忽略：

[CSS 2.1 规范 – 表格 – 表格内容的可视化布局](http://www.w3.org/TR/CSS2/tables.html#table-layout)

> 内部表格元素生成带有内容和边框的矩形框。单元格也有填充。内部表格元素没有边距。

那么什么是“正确”的方式呢？如果您正在寻找替换`cellspacing`表的属性，那么`border-spacing`(with `border-collapse`disabled) 是一个替换。但是，如果需要每个单元格的“边距”，我不确定如何使用 CSS 正确实现。我能想到的唯一技巧是`padding`如上所述使用，避免单元格的任何样式（背景颜色、边框等），而是在单元格内使用容器 DIV 来实现这种样式。

我不是 CSS 专家，所以我很可能在上面说错了（很高兴知道！我也想要一个表格单元格边距 CSS 解决方案）。

干杯!

* * *

## 回答 #2

> 赞同：104
> 
> 时间：2009-04-04T03:32:25.673

将此应用于您的第一个`<td>`：

```
padding-right:10px; 
```

***HTML 示例：***

```
<table>
   <tr>
      <td style="padding-right:10px">data</td>
      <td>more data</td>
   </tr>
</table> 
```

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2013-02-19T14:11:13.553

如果你不能使用填充（例如你在 td 中有边框）试试这个

```
table { 
           border-collapse: separate;
           border-spacing: 2px;
} 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-07-23T14:47:27.700

我意识到这已经很晚了，但是为了记录，您也可以使用 CSS 选择器来执行此操作（消除对内联样式的需要。）此 CSS 将填充应用于每一行的第一列：

```
table > tr > td:first-child { padding-right:10px } 
```

这将是您的 HTML，没有 CSS！：

```
<table><tr><td>data</td><td>more data</td></tr></table> 
```

这允许更优雅的标记，尤其是在您需要使用 CSS 进行大量特定格式设置的情况下。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2011-04-07T13:33:38.387

不幸的是，边距在单个单元格上不起作用，但是您可以在要在其之间放置空格的两个单元格之间添加额外的列...另一种选择是使用与背景颜色相同的边框...

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2013-04-05T21:21:43.680

你可以简单地这样做：

```
<html>
<table>
    <tr>
        <td>one</td>
        <td width="10px"></td>
        <td>two</td>
    </tr>
</table>
</html> 
```

不需要 CSS :) 这 10 像素是您的空间。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2009-04-04T03:32:15.800

试试`padding-right`。不允许`margin`在单元格之间放置 '。

```
<table>
   <tr>
      <td style="padding-right: 10px;">one</td>
      <td>two</td>
   </tr>
</table> 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2014-02-04T11:19:08.537

该解决方案适用于`td`既需要样式`border`又需要`padding`样式的人。
（在 Chrome 32、IE 11、Firefox 25 上测试）

```
CSS:
table {border-collapse: separate; border-spacing:0; }   /*  separate needed      */
td { display: inline-block; width: 33% }  /*  Firefox need inline-block + width  */
td { position: relative }                 /*  needed to make td move             */
td { left: 10px; }                        /*  push all 10px                      */
td:first-child { left: 0px; }             /*  move back first 10px               */
td:nth-child(3) { left: 20px; }           /*  push 3:rd another extra 10px       */

/*  to support older browsers we need a class on the td's we want to push
    td.col1 { left: 0px; }
    td.col2 { left: 10px; }
    td.col3 { left: 20px; }
*/

HTML:
<table>
    <tr>
        <td class='col1'>Player</td>
        <td class='col2'>Result</td>
        <td class='col3'>Average</td>
    </tr>
</table> 
```

* * *

**2016 年更新**

Firefox 现在支持它没有`inline-block`和一套`width`

```
table {border-collapse: separate; border-spacing:0; }
td { position: relative; padding: 5px; }
td { left: 10px; }
td:first-child { left: 0px; }
td:nth-child(3) { left: 20px; }
td { border: 1px solid gray; }

/* CSS table */
.table {display: table; }
.tr { display: table-row; }
.td { display: table-cell; }

.table { border-collapse: separate; border-spacing:0; }
.td { position: relative; padding: 5px; }
.td { left: 10px; }
.td:first-child { left: 0px; }
.td:nth-child(3) { left: 20px; }
.td { border: 1px solid gray; }
```

```
<table>
  <tr>
    <td>Player</td>
    <td>Result</td>
    <td>Average</td>
  </tr>
</table>

<div class="table">
  <div class="tr">
    <div class="td">Player</div>
    <div class="td">Result</div>
    <div class="td">Average</div>
  </div>
</div>
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2014-10-28T22:58:57.363

使用**边框折叠：分离；**对我不起作用，因为我只需要表格单元格之间的边距而不是表格的两侧。

我想出了下一个解决方案：

- **CSS**

```
.tableDiv{
    display: table;
}

.cellSeperator {
    display: table-cell;
    width: 20px;
}

.cell1 {
    display: table-cell;
    width: 200px;
}

.cell2 {
    display: table-cell;
    width: 50px;
} 
```

- **HTML**

```
<div class="tableDiv">
    <div class="cell1"></div>
    <div class="cellSeperator"></div>
    <div class="cell2"></div>
</div> 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-04-04T03:32:58.230

您不能以这种方式挑出单元格中的各个列。在我看来，您最好的选择是`style='padding-left:10px'`在第二列添加 a 并将样式应用于内部 div 或元素。这样你就可以实现更大空间的错觉。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-03-05T22:41:54.607

如果您可以控制表格的宽度，请在所有表格单元格上插入一个 padding-left 并在整个表格上插入一个负 margin-left。

```
table {
    margin-left: -20px;
    width: 720px;
}

table td {
    padding-left: 20px;
} 
```

请注意，表格的宽度需要包括填充/边距宽度。以上面为例，表格的视觉宽度将为 700px。

如果您在表格单元格上使用边框，这不是最佳解决方案。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2013-07-03T03:32:19.137

## 解决方案

我发现解决这个问题的最好方法是反复试验并阅读我之前写的内容：

[http://jsfiddle.net/MG4hD/](http://jsfiddle.net/MG4hD/)

正如你所看到的，我有一些非常棘手的事情正在发生......但让这个看起来不错的主要因素是：

父元素（UL）：边框折叠：分离；边框间距：0.25em；左边距：-.25em；
子元素（LI）：显示：表格单元；垂直对齐：中间；

**HTML**

```
<ul>
<li><span class="large">3</span>yr</li>
<li>in<br>stall</li>
<li><span class="large">9</span>x<span class="large">5</span></li>
<li>on<br>site</li>
<li>globe</li>
<li>back<br>to hp</li>
</ul> 
```

**CSS**

```
ul { border: none !important; border-collapse: separate; border-spacing: .25em; margin: 0 0 0 -.25em; }
li { background: #767676 !important; display: table-cell; vertical-align: middle; position: relative; border-radius: 5px 0; text-align: center; color: white; padding: 0 !important; font-size: .65em; width: 4em; height: 3em; padding: .25em !important; line-height: .9; text-transform: uppercase; } 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2013-01-01T02:43:25.083

按照 Cian 设置边框代替边距的解决方案，我发现您可以将边框颜色设置为透明以避免必须与背景颜色匹配。适用于 FF17、IE9、Chrome v23。如果您也不需要实际的边框，这似乎是一个不错的解决方案。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2015-12-17T07:00:28.973

```
<!DOCTYPE html>
<html>
<head>
<style>
table{
border-spacing: 16px 4px;
}

 td {
    border: 1px solid black;
}
</style>
</head>
<body>

<table style="width:100%">
  <tr>
    <td>Jill</td>
    <td>Smith</td>		
    <td>50</td>
  </tr>
  <tr>
    <td>Eve</td>
    <td>Jackson</td>		
    <td>94</td>
  </tr>
  <tr>
    <td>John</td>
    <td>Doe</td>		
    <td>80</td>
  </tr>
</table>

</body>
</html>
```

使用填充不是正确的做法，它可能会改变外观，但这不是你想要的。这可能会解决您的问题。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2016-05-19T11:16:00.257

您可以同时使用它们：

```
padding-right:10px;

padding-right:10%; 
```

但最好与**%**一起使用。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2016-06-17T02:52:35.517

如果填充不适合您，另一种解决方法是添加额外的列并使用`<colgroup>`. 上面的填充解决方案都不适合我，因为我试图给单元格边框本身留出边距，这就是最终解决问题的方法：

```
<table>
  <colgroup>
    <col>
    <col width="20px">
    <col>
  </colgroup>
  <tr>
     <td>data</td>
     <td></td>
     <td>more data</td>
   </tr>
</table> 
```

使用 :nth-child 设置表格单元格的边框样式，以便第二列和第三列看起来是单列。

```
table tr td:nth-child(2) { border: 1px solid black; border-right:0; }
table tr td:nth-child(3) { border: 1px solid black; border-left:0; } 
```

# arrays - F# array_chunk 用于序列

> ID：716452
> 
> 赞同：6
> 
> 时间：2009-04-04T03:34:17.587
> 
> 标签：arrays, f#, sequence, chunking

我在制作序列时遇到了一些麻烦。基本上我需要将一个序列切成一系列数组。Seq.windowed 几乎做到了，但我不想要重复的元素。

我可以通过先将所有内容读入数组来获得我想要的东西，但我宁愿使用序列。

```
let array_chunk s (a:int[]) =
    Array.init (a.Length / s) (fun i -> Array.sub a (i * s) s)

someSequence |> Seq.to_array |> array_chunk 5 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-02-06T22:41:52.617

这个答案可能会被埋没，但这是我对这个问题的看法：

```
let chunk n xs = 
    xs 
    |> Seq.mapi(fun i x -> i/n, x)
    |> Seq.groupBy fst
    |> Seq.map (fun (_, g) -> Seq.map snd g) 
```

优点：

*   仅使用 seq，不使用数组
*   O(n) 运行时。不像 Seq.skip/take 解决方案那样 O(n^2)
*   Seq.length 不必是 n 的倍数
*   小而易懂？

缺点：

*   可能不如命令式/可变循环高效

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-04T05:45:47.927

这是一个很好的命令，它可以与 seq 一起使用并生成任何大小的数组。如果序列甚至不是 n，最后一个会更小。

```
let chunk n xs = seq {
    let i = ref 0
    let arr = ref <| Array.create n (Unchecked.defaultof<'a>)
    for x in xs do
        if !i = n then 
            yield !arr
            arr := Array.create n (Unchecked.defaultof<'a>)
            i := 0 
        (!arr).[!i] <- x
        i := !i + 1
    if !i <> 0 then
        yield (!arr).[0..!i-1] } 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-04T17:47:45.150

我喜欢`Seq.take`和`Seq.skip`解决方案。它很漂亮，简单且易读，但我会使用这样的东西：

```
let chunks n (sequence: seq<_>) =
    let fold_fce (i, s) value = 
        if i < n then (i+1, Seq.append s (Seq.singleton value))
                 else (  1, Seq.singleton value)
    in sequence
    |> Seq.scan (fold_fce) (0, Seq.empty)
    |> Seq.filter (fun (i,_) -> i = n)
    |> Seq.map (Seq.to_array << snd ) 
```

它不是命令式代码，它应该比使用 Seq.skip 的解决方案更有效。另一方面，它将输入序列修剪为可被 n 整除的长度。如果这种行为是不可接受的，它可以通过简单的修改来修复：

```
let chunks n (sequence: seq<_>) =
    let fold_fce (i, s) value = 
        if i < n then (i+1, Seq.append s (Seq.singleton value))
                 else (  1, Seq.singleton value)
    in sequence
    |> Seq.map (Some)
    |> fun s -> Seq.init_finite (n-1) (fun _ -> None) |> Seq.append s
    |> Seq.scan (fold_fce) (0, Seq.empty)
    |> Seq.filter (fun (i,_) -> i = n) 
    |> Seq.map (Seq.to_array << (Seq.choose (id)) << snd ) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-04T04:47:23.030

怎么样：

```
let rec chunks n sq =
  if not (Seq.is_empty sq) then 
    seq {
      yield Seq.take n sq |> Seq.to_array
      yield! chunks n (Seq.skip n sq)
    }
  else
    Seq.empty 
```

请注意，这要求 sq 有许多可以被 n 整除的元素（因为 Seq.take 和 Seq.skip 与 LINQ 的 Take 和 Skip 扩展方法不同，要求序列至少包含 n 个元素）。此外，这不像显式使用枚举器那样有效，但它更优雅。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-07T08:14:53.753

接受/跳过答案的更正版本，作为扩展功能。应该适用于不均匀的长度。虽然不能保证性能...

```
 module Seq = 
    let rec chunks n (s:#seq<_>) =
        seq {
                 if Seq.length s <= n then
                    yield s
                 else
                    yield Seq.take n s
                    yield! chunks n (Seq.skip n s)           
            } 
```

（代码取自我[在这里](https://stackoverflow.com/questions/441651/f-breaking-a-list-into-concatenated-strings-by-an-interval/446020#446020)的回答）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-04T23:27:15.160

这很好，简洁：

```
let chunk size (arr : 'a array) =
    [| for a in 0 .. size .. arr.Length - size -> arr.[a..a + size - 1] |] 
```

但是，这会丢失数组中的最后一个 (arr.Length % size) 元素。您可以通过抓取缺失的元素并使用 Array.append 来解决此问题：

```
let chunk2 size (arr : 'a array) = 
    let first = [| for a in 0 .. size .. arr.Length - size -> arr.[a..a + size - 1] |]
    let numberOfMissingElements = arr.Length - (first.Length * size)
    if numberOfMissingElements > 0 then
        let last = [| arr.[arr.Length - numberOfMissingElements..] |]
        Array.append first last
    else first 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-06T05:20:48.393

这是另一种模式匹配的方法 - 它看起来更像 *.iter，我让它吐出列表而不是数组，因为这就是我通常喜欢我的数据的方式。

```
let sequence_in_lists_of_length_n_with_acc (s: seq<'a>) n acc = seq {
use e = s.GetEnumerator()
let rec next_with_acc acc =
  match e.MoveNext(), acc with
  | true, a when List.length a + 1 = n ->  
    yield (List.rev (e.Current :: a))
    next_with_acc []
  | true, _ -> next_with_acc (e.Current :: acc)
  | false, _ ->
    f(List.rev acc)
  ()
next_with_acc [] 
```

}

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-06T20:12:00.450

我更喜欢这个解决方案。它从现有序列生成一个新序列（这意味着它不需要遍历整个序列来获得结果 - 如果您正在执行诸如日志处理之类的事情，而您不能调用诸如 Length 之类的事情，这一点至关重要）。

我最终写了[一篇博客文章](http://jamesmoorecode.blogspot.com/2009/04/f-converting-sequences-to-lists-on-fly.html)，详细介绍了我是如何到达这里的。

```
module Seq = 
```

let grouped_by_with_leftover_processing f (f2: 'a list -> list<'a> option) (s: seq<'a>)= let rec grouped_by_with_acc (f: 'a -> 'a list -> 'a list option * 'a list) acc (ie: IEnumerator<'a>) = seq { if ie.MoveNext() then let nextValue, leftovers = f ie.Current acc if nextValue.IsSome then yield nextValue.Value yield！grouped_by_with_acc f leftovers ie else let rems = f2 acc if rems.IsSome then yield rems.Value } seq { yield！grouped_by_with_acc f [] (s.GetEnumerator()) }

let YieldReversedLeftovers (f: 'a list) = if f.IsEmpty then None else Some (List.rev f)

让 grouped_by fs = grouped_by_with_leftover_processing f YieldReversedLeftovers s

let group_by_length_n ns = let grouping_function newValue acc = let newList = newValue :: acc // 如果我们有正确的长度，则返回 // a Some 作为第一个值。那将 // 由序列产生。if List.length acc = n - 1 then Some (List.rev newList), [] // 如果我们没有正确的长度， // 使用 None （所以不会产生任何结果） else None, newList
grouped_by grouping_function s

大序列不是问题：

seq { for i in 1..1000000000 -> i} |> Seq.group_by_length_n 3;; 验证它： seq<int list> = seq [[1; 2；3]; [4; 5个；6]; [7; 8个；9]; [10; 11; 12]；...] >

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-07T05:25:03.910

来自 Princess 的 Nice 版本已修复获取 tail 并转换为 seq

```
let array_chunk size (arr : 'a array) = 
    let maxl = arr.Length - 1
    seq { for a in 0 .. size .. maxl -> arr.[a .. min (a + size - 1) maxl ] } 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-11-21T17:18:44.693

这个怎么样 ：

```
let grouped n = 
   Seq.unfold(fun s -> if not (Seq.isEmpty s) then 
                           Some (Seq.take n s, Seq.skip n s) 
                       else None) 
```

这与kvb的答案相同。

我以某种方式记得（链接？）序列不记得位置，因此连续拍摄/跳过不会是最佳的。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-03-21T19:49:27.303

这是修复了 Seq.skip/take 限制的@kvb 解决方案。它小巧、优雅且 O(n)。

```
let eSkip n s = System.Linq.Enumerable.Skip(s, n)

let rec seq_chunks n sq =
  if (Seq.isEmpty sq) 
  then Seq.empty
  else seq {
      yield Seq.truncate n sq
      yield! seq_chunks n (eSkip n sq)
 } 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-08-01T20:42:43.303

这是我的版本，将数组作为输入和输出：

```
 let chunk chunkNumber (array : _ array) =
    let chunkSize = array.Length/chunkNumber
    let mutable startIndex = 0
    [|
        let n1 = array.Length % chunkNumber
        for i = 1 to n1 do
            yield Array.sub array startIndex (chunkSize+1)
            startIndex <- startIndex + chunkSize+1

        let n2 = chunkNumber - n1
        for i = 1 to n2 do
            yield Array.sub array startIndex chunkSize
            startIndex <- startIndex + chunkSize
    |] 
```

该函数尝试制作大小相似的块（而不是获得一个非常小的最后一个块）并以与构建序列相同的方式构建输出（使其易于重写以获得序列作为输出）

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-03-02T10:55:28.897

总结以上对序列、列表或数组的分块或缓冲或分段。两种形式：

```
let rec chunk size xs = seq {
    yield Seq.take size xs
    yield! chunk size (Seq.skip size xs)
    } 
```

或者

```
let chunk size = Seq.unfold (fun xs ->
    match Seq.isEmpty xs with
    | false -> Some(Seq.take size xs, Seq.skip size xs)
    | _ -> None
    ) 
```

注意：如果 Seq 像游标一样正常运行（正如我所期望的那样是一个惰性求值），Seq.take 将推进位置 Seq.skip 将是不必要的。然而，事实并非如此。

# sql - 比较 SQL 中的元组

> ID：716463
> 
> 赞同：4
> 
> 时间：2009-04-04T03:48:19.223
> 
> 标签：sql, comparison, operators, sql-order-by, tuples

有没有比做这样的事情更方便的方法来比较 T-SQL 中的数据元组：

```
SELECT TOP 100 A, B
FROM MyTable
WHERE (A > @A OR (A = @A AND B > @B))
ORDER BY A, B 
```

基本上我正在寻找具有 (A, B) > (@A, @B) 的行（与我在 order by 子句中的顺序相同）。我有一些案例，我有 3 个字段，但它变得更加丑陋。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-04T07:07:28.730

不，这很简单。事实上，你可以通过绘制一个真值表来证明这是最简单的。（设置 3 列：A<@A、A=@A 和 A>@A。设置 3 行：B<@B、B=@B、B>@B。）

```
 A<@A | A=@A | A>@A
--------------------------
B<@B |  F   |  F   |  T
--------------------------
B=@B |  F   |  F   |  T
--------------------------
B>@B |  F   |  T   |  T 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-04T11:39:25.050

不，但是您可以将元组的成员组合成可直接比较的东西。例如，如果 A 和 B 都是 0..99 之间的数字，则添加 A*100+B 和 @A*100+@B 并比较它们。如果它们都是字符串，则用空格填充到最大长度并连接。

这是一个讨厌的技巧，你有时可以用来让自己摆脱困境，但最好不要使用它。一方面，它会破坏索引，因此您将对每个查询进行全表扫描。

# php - 使用 php ob_gzhandler 压缩内存缓存内容

> ID：716468
> 
> 赞同：1
> 
> 时间：2009-04-04T03:56:12.713
> 
> 标签：php, memcached, gzip

我最近使用 php 的 ob_gzhandler 函数实现了我的内容的 gzip 压缩，这让事情变得非常简单。

我现在正在尝试将此内容添加到我的内存缓存中，并希望也有一种简单的方法可以做到这一点，但我无法在网上找到任何关于完成此操作的信息。

我过去只使用 memcache 来存储保存在变量中的数据，但是使用 ob_gzhandler，我没有包含数据的变量。所以不幸的是，我什至不知道从哪里开始。

谢谢皮特

-----编辑以获取更多信息------------- 正如科迪在下面评论的那样，显然我的问题是/含糊不清。很抱歉，我正在尝试提供尽可能多的信息，但在这个过程中我真的有点迷失了。

当我之前使用过 memcache 时，我根据 url 请求的哈希检查了数据是否存在于 memcache 中。如果有匹配，我会抓取缓存的数据。如果没有，那么我会制作页面并将其存储在缓存中。

现在我正在尝试做同样的事情，但使用 php ob_gzhandler 压缩数据。

但正如 Ciaran 所说，仅仅存储非 gzip 压缩数据可能更有意义。

同时，存储 gzip 压缩的版本会更好，因为它更小，所以我可以在缓存中存储更多，而且不是几乎所有的浏览器都兼容 gzip 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-04T04:42:25.957

听起来您在询问被动缓存，其中您有一些查询缓存的代码，并且在缓存未命中时，它会生成数据，将其插入缓存然后返回。简而言之，您的代码将始终返回一大块数据，但是无论它是通过计算还是通过访问缓存来返回，好吧，被调用者代码并不关心。

这个对吗？

最终，您的问题很模糊，并且没有包含足够的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T11:33:23.147

ob_gzhandler() 将返回一个字符串或 false，这取决于客户端浏览器是否支持 gzip、deflate 或无编码。您可能正在通过 ob_start() 或类似方法使用此功能。

因为每个客户端的结果不同，所以尝试缓存结果并不是一个好主意（即在某些情况下它会是 FALSE，在某些情况下它会是一个“放气”编码的响应，而在其他情况下它是将是一个“gzip”编码的响应）。

缓存正在被 gzip 压缩的内容似乎更有意义，并在每个请求中重新压缩它——实际上这不应该是一个巨大的开销。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T16:54:44.450

如果只是为了减少传输到存储中的字节数，那么有许多客户端可以在将数据发送到 memcache 之前对其进行压缩 - 取决于大小（压缩 50K 很有用，5 字节，不多）。正如@Ciaran 所说，为最终交付重新压缩的开销（如果需要）并没有那么多。

# c# - 如何在后台加载图像？

> ID：716472
> 
> 赞同：3
> 
> 时间：2009-04-04T03:57:41.620
> 
> 标签：c#, wpf, image, delegates

我正在尝试在后台加载图像，然后更新 UI。我整天都在玩这个，我不知道我错过了什么。我不断收到以下错误：

> “调用线程无法访问此对象，因为不同的线程拥有它。”

我一直在寻找一个又一个例子，但我似乎找不到答案。我还将接触 UI 的代码封装在另一个 BeginInvoke 中。

更新3：故事的寓意。ImageSource 不是线程安全的访问。

更新 2：这必须是一个简单的解决方案:)。我尝试了克隆，但这并没有成功，但我确实得到了一个不同的错误：“调用目标抛出了异常。”

更新 1：我尝试了 BackgroundWorker，但仍然收到相同的错误，但它发生在 Brush.ImageSource.Height 上。我是否正确地向 UI 发出信号？有什么建议么？

这是我的 XAML：

```
<Window x:Class="Slideshow.Show"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <DockPanel>
        <Canvas Background="Black" Name="canvas">
            <Viewbox Name="background" Stretch="Uniform">
                <Rectangle name="background" />
            </Viewbox>
        </Canvas>
    </DockPanel>
</Window> 
```

这是后面的一些代码：

```
namespace Slideshow
{
    public class Show 
    {
        public Show()
        {
            BackgroundWorker bw = new BackgroundWorker();
            bw.DoWork += new DoWorkEventHandler(bw_DoWork);
            bw.RunWorkerCompleted += 
                new RunWorkerCompletedEventHandler(bw_RunWorkerCompleted);
            bw.RunWorkerAsync();
        }

        void bw_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
        {
            BitmapSource bitmap = e.Result as BitmapSource;

            if (bitmap != null)
            {
                this.Dispatcher.BeginInvoke(DispatcherPriority.Normal 
                    (ThreadStart)delegate()
                {
                    Image image = new Image();
                    image.Source = bitmap;
                    background.Child = image;
                 });
            }
        }

        void bw_DoWork(object sender, DoWorkEventArgs e)
        {
            BitmapSource bitmapSource = CreateBrush(GetRandomFile());
            e.Result = bitmapSource;
         }
    }
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-04T04:53:53.247

我倾向于使用来加载图像，然后当操作完成时，我使用线程安全对象[`ThreadPool.QueueUserWorkItem`](http://msdn.microsoft.com/en-us/library/system.threading.threadpool.queueuserworkitem.aspx)回调 UI 线程。[`Dispatcher`](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcherobject.aspx)图像源不是线程安全的，你将不得不使用类似的东西`JpegBitmapDecoder`，还有一个`PngBitmapDecoder`.

例如：

```
public Window()
{
    InitializeComponent();

    ThreadPool.QueueUserWorkItem(LoadImage,
         "http://z.about.com/d/animatedtv/1/0/1/m/simp2006_HomerArmsCrossed_f.jpg");
}

public void LoadImage(object uri)
{
    var decoder = new JpegBitmapDecoder(new Uri(uri.ToString()), BitmapCreateOptions.PreservePixelFormat, BitmapCacheOption.OnLoad);
    decoder.Frames[0].Freeze();
    this.Dispatcher.Invoke(DispatcherPriority.Send, new Action<ImageSource>(SetImage), decoder.Frames[0]);
}

public void SetImage(ImageSource source)
{
    this.BackgroundImage.Source = source;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-08T07:16:33.073

我们在项目中还有一件事。由于 ImageSource 被放置在 UI 中，因此您必须检查它是否被冻结：

```
public void SetImage(ImageSource source)
{
   ImageSource src = null;
   if(!source.IsFrozen)
       src = source.GetAsFrozen();
   else
       src = source; 
   this.BackgroundImage.Source = src;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-04T04:11:39.667

您想在 WPF 应用程序中合并多个线程。如下文所述，WPF 强制您在创建 UI 的线程上完成所有 UI 工作。

看看这个： http: [//pjbelfield.wordpress.com/2007/10/29/worker-threads-and-the-dispatcher-in-wpf/](http://pjbelfield.wordpress.com/2007/10/29/worker-threads-and-the-dispatcher-in-wpf/)

对于密集的 UI 工作：

[http://eprystupa.wordpress.com/2008/07/28/running-wpf-application-with-multiple-ui-threads/](http://eprystupa.wordpress.com/2008/07/28/running-wpf-application-with-multiple-ui-threads/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-04T04:16:48.890

您将图像 (.jpg) 加载到内存中的代码应该在后台完成。将图像从内存加载到 WPF 控件的代码必须在普通 UI WPF 线程中完成。只有慢速/长时间运行的任务才应该放入后台线程。一旦长任务完成，它必须向 UI 线程发出信号，用长任务的结果更新视图。

我最喜欢的方法是使用 BackgroundWorker 类：

```
var bg = new System.ComponentModel.BackgroundWorker();
bg.DoWork += Work_Function;
bg.RunWorkerCompleted += UI_Function;
bg.RunWorkerAsync();

void Work_Function(object sender, DoWorkEventArgs e) { ... }
void UI_Function(object sender, RunWorkerCompletedEventArgs e) { ... } 
```

当您调用 RunWorkerAsync() 时，首先调用 Work_Function()。完成后，调用 UI_Function()。工作函数可以在 DoWorkEventArgs.Result 属性中放置一个变量，该变量可从 RunWorkerCompletedEventArgs.Result 属性访问。

我想你可能也对这篇文章感兴趣：http: [//www.codeproject.com/KB/WPF/WPF_Explorer_Tree.aspx](http://www.codeproject.com/KB/WPF/WPF_Explorer_Tree.aspx)它展示了如何在 WPF 的树形视图中设置延迟加载。我认为基本概念（添加一个虚拟节点，通过加载下一个图像来拦截虚拟节点的显示）将适用于您的工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-04T04:52:37.820

你现在得到的错误是个好消息，这意味着它`BackgroundWorker`正在工作。您可以尝试将其克隆到`RunWorkerCompleted`with 中`brush.Clone();`。

尝试删除 Dispatcher.BeingInvoke 部分。BackgroundWorker 的全部意义在于，该事件会自动为您编组回 UI 线程，因此您不必担心。

# python - 加入python中的列表列表

> ID：716477
> 
> 赞同：424
> 
> 时间：2009-04-04T04:00:35.980
> 
> 标签：python

将列表列表加入python中的单个列表（或迭代器）的简短语法是什么？

例如，我有一个如下列表，我想遍历 a、b 和 c。

```
x = [["a","b"], ["c"]] 
```

我能想到的最好的方法如下。

```
result = []
[ result.extend(el) for el in x] 

for el in result:
  print el 
```

* * *

## 回答 #1

> 赞同：619
> 
> 时间：2009-04-04T04:11:17.670

```
import itertools
a = [['a','b'], ['c']]
print(list(itertools.chain.from_iterable(a))) 
```

* * *

## 回答 #2

> 赞同：273
> 
> 时间：2009-04-04T04:15:15.930

```
x = [["a","b"], ["c"]]

result = sum(x, []) 
```

* * *

## 回答 #3

> 赞同：242
> 
> 时间：2009-04-04T08:21:14.653

如果您只深入一层，嵌套理解也将起作用：

```
>>> x = [["a","b"], ["c"]]
>>> [inner
...     for outer in x
...         for inner in outer]
['a', 'b', 'c'] 
```

在一条线上，它变成：

```
>>> [j for i in x for j in i]
['a', 'b', 'c'] 
```

* * *

## 回答 #4

> 赞同：42
> 
> 时间：2010-07-24T01:04:51.320

```
l = []
map(l.extend, list_of_lists) 
```

最短！

* * *

## 回答 #5

> 赞同：33
> 
> 时间：2009-04-04T04:04:21.527

这被称为扁平化，并且有很多实现。

这个怎么样，虽然它只适用于 1 级深度嵌套：

```
>>> x = [["a","b"], ["c"]]
>>> for el in sum(x, []):
...     print el
...
a
b
c 
```

从这些链接中，显然最完整的快速优雅等实现如下：

```
def flatten(l, ltypes=(list, tuple)):
    ltype = type(l)
    l = list(l)
    i = 0
    while i < len(l):
        while isinstance(l[i], ltypes):
            if not l[i]:
                l.pop(i)
                i -= 1
                break
            else:
                l[i:i + 1] = l[i]
        i += 1
    return ltype(l) 
```

* * *

## 回答 #6

> 赞同：23
> 
> 时间：2012-03-18T18:50:11.113

如果您需要列表，而不是生成器，请使用`list():`

```
from itertools import chain
x = [["a","b"], ["c"]]
y = list(chain(*x)) 
```

* * *

## 回答 #7

> 赞同：19
> 
> 时间：2014-01-10T00:48:17.800

性能比较：

```
import itertools
import timeit
big_list = [[0]*1000 for i in range(1000)]
timeit.repeat(lambda: list(itertools.chain.from_iterable(big_list)), number=100)
timeit.repeat(lambda: list(itertools.chain(*big_list)), number=100)
timeit.repeat(lambda: (lambda b: map(b.extend, big_list))([]), number=100)
timeit.repeat(lambda: [el for list_ in big_list for el in list_], number=100)
[100*x for x in timeit.repeat(lambda: sum(big_list, []), number=1)] 
```

生产：

```
>>> import itertools
>>> import timeit
>>> big_list = [[0]*1000 for i in range(1000)]
>>> timeit.repeat(lambda: list(itertools.chain.from_iterable(big_list)), number=100)
[3.016212113769325, 3.0148865239060227, 3.0126415732791028]
>>> timeit.repeat(lambda: list(itertools.chain(*big_list)), number=100)
[3.019953987082083, 3.528754223385439, 3.02181439266457]
>>> timeit.repeat(lambda: (lambda b: map(b.extend, big_list))([]), number=100)
[1.812084445152557, 1.7702404451095965, 1.7722977998725362]
>>> timeit.repeat(lambda: [el for list_ in big_list for el in list_], number=100)
[5.409658160700605, 5.477502077679354, 5.444318360412744]
>>> [100*x for x in timeit.repeat(lambda: sum(big_list, []), number=1)]
[399.27587954973444, 400.9240571138051, 403.7521153804846] 
```

这是在 Windows XP 32 位上使用 Python 2.7.1，但上面评论中的 @temoto`from_iterable`必须比 快`map+extend`，因此它非常依赖于平台和输入。

保持距离`sum(big_list, [])`

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2009-04-04T09:20:27.740

这对无限嵌套的元素递归地起作用：

```
def iterFlatten(root):
    if isinstance(root, (list, tuple)):
        for element in root:
            for e in iterFlatten(element):
                yield e
    else:
        yield root 
```

结果：

```
>>> b = [["a", ("b", "c")], "d"]
>>> 列表（iterFlatten（b））
['A B C D']

```

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2010-12-21T03:19:45.840

派对迟到了，但是...

我是 python 新手，来自 lisp 背景。这就是我想出的（查看 lulz 的 var 名称）：

```
def flatten(lst):
    if lst:
        car,*cdr=lst
        if isinstance(car,(list,tuple)):
            if cdr: return flatten(car) + flatten(cdr)
            return flatten(car)
        if cdr: return [car] + flatten(cdr)
        return [car] 
```

似乎工作。测试：

```
flatten((1,2,3,(4,5,6,(7,8,(((1,2))))))) 
```

返回：

```
[1, 2, 3, 4, 5, 6, 7, 8, 1, 2] 
```

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-04-04T04:08:45.757

您所描述的内容被称为展**平**列表，有了这些新知识，您将能够在 Google 上找到许多解决方案（没有内置的展平方法）。这是其中之一，来自[http://www.daniel-lemire.com/blog/archives/2006/05/10/flattening-lists-in-python/](http://www.daniel-lemire.com/blog/archives/2006/05/10/flattening-lists-in-python/)：

```
def flatten(x):
    flat = True
    ans = []
    for i in x:
        if ( i.__class__ is list):
            ans = flatten(i)
        else:
            ans.append(i)
    return ans 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-04-04T04:16:16.723

总是有减少（被 functools 弃用）：

```
>>> x = [ [ 'a', 'b'], ['c'] ]
>>> for el in reduce(lambda a,b: a+b, x, []):
...  print el
...
__main__:1: DeprecationWarning: reduce() not supported in 3.x; use functools.reduce()
a
b
c
>>> import functools
>>> for el in functools.reduce(lambda a,b: a+b, x, []):
...   print el
...
a
b
c
>>> 
```

不幸的是，用于列表连接的加号运算符不能用作函数——或者幸运的是，如果您希望 lambdas 变得丑陋以提高可见性。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2010-01-02T16:42:13.370

或递归操作：

```
def flatten(input):
    ret = []
    if not isinstance(input, (list, tuple)):
        return [input]
    for i in input:
        if isinstance(i, (list, tuple)):
            ret.extend(flatten(i))
        else:
            ret.append(i)
    return ret 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2012-01-29T02:51:41.137

对于一级展平，如果您关心速度，在我尝试的所有条件下，这都比以前的任何答案都快。（也就是说，如果您需要将结果作为列表。如果您只需要动态迭代它，那么链示例可能会更好。）它通过预先分配最终大小的列表并将部分复制到按切片（这是比任何迭代器方法都低级的块副本）：

```
def join(a):
    """Joins a sequence of sequences into a single sequence.  (One-level flattening.)
    E.g., join([(1,2,3), [4, 5], [6, (7, 8, 9), 10]]) = [1,2,3,4,5,6,(7,8,9),10]
    This is very efficient, especially when the subsequences are long.
    """
    n = sum([len(b) for b in a])
    l = [None]*n
    i = 0
    for b in a:
        j = i+len(b)
        l[i:j] = b
        i = j
    return l 
```

带注释的排序时间列表：

```
[(0.5391559600830078, 'flatten4b'), # join() above. 
(0.5400412082672119, 'flatten4c'), # Same, with sum(len(b) for b in a) 
(0.5419249534606934, 'flatten4a'), # Similar, using zip() 
(0.7351131439208984, 'flatten1b'), # list(itertools.chain.from_iterable(a)) 
(0.7472689151763916, 'flatten1'), # list(itertools.chain(*a)) 
(1.5468521118164062, 'flatten3'), # [i for j in a for i in j] 
(26.696547985076904, 'flatten2')] # sum(a, []) 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-04-04T04:11:30.883

遗憾的是，Python 没有一种简单的方法来展平列表。试试这个：

```
def flatten(some_list):
    for element in some_list:
        if type(element) in (tuple, list):
            for item in flatten(element):
                yield item
        else:
            yield element 
```

这将递归地展平列表；然后你可以做

```
result = []
[ result.extend(el) for el in x] 

for el in flatten(result):
      print el 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2012-07-31T21:11:24.073

当我必须创建一个包含数组元素及其计数的字典时，我遇到了类似的问题。答案是相关的，因为我展平了一个列表列表，获取我需要的元素，然后进行分组和计数。我使用 Python 的 map 函数来生成一个元素元组，它是数组上的 count 和 groupby。请注意，groupby 将数组元素本身作为 keyfunc。作为一个相对较新的 Python 编码器，我发现它对我来说更容易理解，同时也是 Pythonic。

在我讨论代码之前，这里有一个我必须先展平的数据示例：

```
{ "_id" : ObjectId("4fe3a90783157d765d000011"), "status" : [ "opencalais" ],
  "content_length" : 688, "open_calais_extract" : { "entities" : [
  {"type" :"Person","name" : "Iman Samdura","rel_score" : 0.223 }, 
  {"type" : "Company",  "name" : "Associated Press",    "rel_score" : 0.321 },          
  {"type" : "Country",  "name" : "Indonesia",   "rel_score" : 0.321 }, ... ]},
  "title" : "Indonesia Police Arrest Bali Bomb Planner", "time" : "06:42  ET",         
  "filename" : "021121bn.01", "month" : "November", "utctime" : 1037836800,
  "date" : "November 21, 2002", "news_type" : "bn", "day" : "21" } 
```

这是来自 Mongo 的查询结果。下面的代码展平了这些列表的集合。

```
def flatten_list(items):
  return sorted([entity['name'] for entity in [entities for sublist in  
   [item['open_calais_extract']['entities'] for item in items] 
   for entities in sublist]) 
```

首先，我将提取所有“实体”集合，然后对于每个实体集合，遍历字典并提取名称属性。

# .net - 创建您自己的 .NET 程序集缓存

> ID：716483
> 
> 赞同：4
> 
> 时间：2009-04-04T04:11:21.897
> 
> 标签：.net, caching, assemblies

在我正在编写的 .net 应用程序中，我需要在本地缓存来自不同位置的程序集，以便即使原始位置不可用，我的应用程序也可以使用它们。我不能使用 GAC（主要是因为我想要可移植性，还因为程序集可能没有签名）。

有谁知道已经支持此功能的任何 .net 代码？我需要缓存能够告诉我特定程序集是否已经在缓存中，并且还可以处理不同版本的程序集。我可能不得不求助于编写自己的程序集缓存，但我想我会问这个问题，因为如果已经完成，我真的不想“重新发明轮子”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-04T17:01:38.753

[Mono 项目](http://www.mono-project.com/Main_Page)必须（重新）实现 GAC，它可以在 Windows 上运行。我会从那里开始。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-07T20:38:34.963

我最终不得不编写自己的程序集缓存......

以下是它的工作原理，以便在其他人需要实现自己的程序集缓存时帮助他们：

*   缓存是应用程序中具有相应包装类的文件夹。
*   在缓存中安装程序集的方法会返回一个字符串“token”（安装程序集的名称），调用者可以保存该字符串并在以后检索该程序集。
*   检索程序集的方法获取令牌并返回一个对象，该对象封装了缓存的程序集信息。

安装程序集时，首先将传入程序集的位与每个已缓存程序集的位进行比较，并确定该程序集是否已安装（如果所有位都相同，则它们显然必须做同样的事情）。如果程序集已安装，则返回先前缓存的程序集的名称。如果尚未安装，则通过在缓存文件夹中查找程序集名称的可用变体来允许安装多个版本（例如，程序集.dll、程序集 - (2).dll、程序集 - (3).dll 等） ，将程序集缓存在文件夹中，并将其缓存名称返回给调用者。

就安全性和强命名而言，在我的应用程序中进行强名称验证是没有意义的，因为这就是 Bruce Payette 所说的“草坪侏儒缓解”（攻击者只能四处走动的安全对策）。如果攻击者决定毒化程序集，他还可以访问存储强名称的位置，并且可以轻松地将其更改为他的强名称。最终用户有责任仅使用来自他信任的来源的程序集。如果用户安装了恶意程序集，那是他的错，不是我的。尽管如此，为了给用户提供更多的保护，我的应用程序中外部程序集的使用将默认禁用。但是，对于其他应用程序，将强名称验证作为额外的安全层可能是有意义的。

# perl - 如何在 Perl 中跳过不是空格或数字的行？

> ID：716490
> 
> 赞同：1
> 
> 时间：2009-04-04T04:15:31.390
> 
> 标签：perl, arrays, string

我正在从这样的文件中读取数据

```
while (<$fh>)
{
        @tmp = split; # <-- ?
        push @AoA, [@tmp];
} 
```

我对此有几个问题。标记线有什么作用？它是否按行拆分文件并将每行的元素存储到一个数组中？如果是这样，是否可以将@tmp 转换为字符串或在@tmp 上执行正则表达式？

基本上，如果我在文件中发现除空格或整数以外的任何内容，我想停止将数据推送到 AoA。我已经有了它的正则表达式：\^[\s\d]*$\

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-04T04:21:43.277

[ `@tmp = split;`] 是以下的简写：

```
@tmp = split " ", $_, 0; 
```

这类似于

```
@tmp = split /\s+/, $_, 0; 
```

但忽略任何前导空格，因此`" foo bar baz"`变为.`("foo", "bar", "baz")``("", "foo", "bar", "baz")`

它获取文件处理程序中的每一行`$fh`并将其拆分，使用空格作为分隔符。

关于你想要做什么，你为什么不`$_`开始运行正则表达式呢？那是一个字符串。

你可以这样做：

```
while (<$fh>) {
    last unless  /^[\s\d]*$/; # break if a line containing something 
                              # other than whitespace or a number is found
    @tmp = split;
    push @AoA, [@tmp];
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-04T12:34:32.720

当您想知道 Perl 内置函数的作用时，请阅读它的文档。您得到的大多数答案只是重述文档。使用任何语言的关键是学习如何使用其文档。如果您已阅读文档但不理解，请在您的问题中提及 :)

*   您可以查看[perlfunc](http://perldoc.perl.org/perlfunc.html)页面以查看所有内置函数。

*   在命令行中，您可以使用 -f 开关切换到 perldoc 来仅提取内置文档：`perldoc -f split`

祝你好运， ：）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-04T04:22:48.063

[ `@tmp = split;`] 在空白处拆分文件的每一行，并将单词作为数组存储在@tmp 中。（while() 循环遍历文件中的每一行。）然后将包含@tmp 的数组引用推送到@AoA。

完成“将@tmp 转换为字符串”的最佳方法是，如果您想在此处对其进行处理，则永远不要将其转换*为*字符串；**拆分**在**$_**上运行，它是一个字符串（while 循环隐式设置它）。如果您在该循环中执行 s/foo/bar/ 之类的正则表达式操作，它们将自动对 $_ 进行操作。

因此，完成您所说的（代码稍微简化）的一种方法是：

```
while(<$fh>) {
    last
        if /[^\s\d]/;
    push @AoA, [split];
} 
```

如果您真的想将 @tmp 重新转换为字符串，您可以这样做：

```
my $tmp = join ' ', @tmp; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-04T04:27:29.770

```
while(<$fh>) { 
```

这将逐行读取文件。文件的当前行存储在`$_`. 它与 基本相同`while($_ = <$fh>) {`。从技术上讲，它扩展为`while(defined($_ = <$fh>)) {`，但它们非常接近同一事物（无论哪种方式，它都是自动的，因此您无需担心）。

```
 @tmp = split; 
```

没有参数的“ `split`”（大部分）等价于“ `split /\s+/, $_`”。它将当前行拆分为空格之间的项目列表。因此，它将当前行拆分为一个单词列表（或多或少）并将该列表存储在一个数组中。但是，这条线很糟糕。`@tmp`应该符合`my`. 如果你有`use strict;`并且`use warnings;`在顶部，Perl 会捕捉到这一点。

```
 push @AoA, [@tmp];
} 
```

这会推送对包含 in 元素的匿名数组的引用`@tmp`，`@AoA`这是一个数组数组（您可能已经知道）。

所以最后，你有一个列表`@AoA`，其中列表中的每个元素对应于文件的一行，列表中的每个元素是该行中单词的另一个列表。

简而言之，`@tmp`应该*真的*用声明`my`，你应该`use strict;`和`use warnings;`。事实上，如前所述，您可以`@tmp`完全取消：

```
while(<$fh>) { push @AoA, [split] } 
```

但是对于以后必须添加到此代码的任何人来说，使用临时数组可能会更好。

编辑：我错过了你想添加的正则表达式：

```
while(<$fh>) {
  last unless /^[\d\s]*$/;
  push @AoA, [split];
} 
```

但是，`/^[\d\s]*$/`不会捕获所有整数 - 具体来说，它不会匹配`-1`. 如果您希望它匹配负数，请使用`/^[\d\s-]*$/`. 另外，如果你想匹配非整数（浮点数），你可以使用`/^[\d\s\.-]*$/`，但我不知道你是否想匹配那些。但是，这些正则表达式将匹配无效条目，例如`1-3`and `5.5.5`，它们不是整数或数字。如果您想对此更严格，请尝试以下操作：

```
LOOP: while(<$fh>) {
  my @tmp = split;
  for(@tmp) {
    # this line for floating points:
    last LOOP unless /^-?\d+(?:\.\d+|)$/;
    # this line for just integers:
    last LOOP unless /^-?\d+$/;
  }
  push @AoA, [@tmp];
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-04T04:53:54.933

实际上，该`while (<$fh>)`行将文件逐行拆分；循环的每次迭代都会有一个新行存储在`$_`.

`$_`标记的行将存储在空格中的行分开。因此，`@tmp`将是一个包含该行所有单词的数组：如果该行包含`foo bar baz`，`@tmp`将是`('foo', 'bar', 'baz')`。

如果您想在有问题的行上进行正则表达式匹配，那么您应该在拆分行之前执行此操作。perl 中的正则表达式默认与 $_ 匹配，因此该行非常简单：

```
while (<$fh>)
{
    last unless /^[\s\d]*$/;
    @tmp = split;
    push @AoA, [@tmp];
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-04T05:09:50.807

警告，`\d`并不意味着`[0-9]`在 Perl 5.8 和 5.10 中（除非你使用[`bytes`](http://perldoc.perl.org/bytes.html)编译指示）。这意味着任何具有数字属性的[UNICODE](http://en.wikipedia.org/wiki/Unicode)字符，例如 MONGOLIAN DIGIT FIVE U+1815 (᠕)，如果您想将其限制为仅可以进行数学运算的空格和数字，则需要说`/^[\s0-9]$/`.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-04T04:24:39.963

第一行和其他任何一样都是一个while循环，但它的“条件”从文件句柄$fh中读取一行输入到默认变量$_中。如果读取成功（即我们不在文件末尾），则执行主体。它本质上是“对于文件 $fh 中的每一行”。

下一行是用空格（默认分隔符）分割 $_ 中的项目（默认变量，记住，所以它被排除在 split 调用之外），并将结果存储在 @tmp 中。最后一行将@tmp 的REFERENCE 添加到@AoA，这是一个数组引用数组。

所以，你想做的是说（在循环的顶部）

```
last if $_ =~ <apropriate regex here>; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-04T04:24:54.097

`split`获取给定的字符串并通过在空格上拆分将其转换为数组 - 由于没有给出参数，它将拆分变量（依次`$_`从文件中给出每一行。`$fh`

不必转换`@tmp`为字符串，因为该字符串已经在`$_`变量中。

为了在匹配任何非空格或数字的单个字符时停止循环：

```
last if /[\s\d]/; 
```

这与您的版本略有不同，它将匹配仅包含非空白和/或非数字的任何完整行。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-04T04:25:20.883

嗯不错！

速记解释了很多。

所以我可以这样做..

```
while (<$fh>)
{
        if( /^[/s/d]*$/ ){
          //do something
        }else{
          //do something else;
        }

        @tmp = split;
        push @AoA, [@tmp];
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-04T12:53:46.993

核心问题已经很好地涵盖了，但是`@tmp`没有明确提到“转回字符串”子问题的一个方面：

`$_`并且`join ' ', @tmp`不*等价*。 `$_`将包含最初读取的行。 `join ' ', @tmp`将包含在该行中找到的单词，由单个空格连接。如果该行包含非空格空格（例如制表符）、由多个空格分隔的单词或前导空格，那么“完整”行的两个版本将不同。

# xml - 重命名 XML 命名空间前缀

> ID：716493
> 
> 赞同：1
> 
> 时间：2009-04-04T04:18:58.637
> 
> 标签：xml, xaml, xml-namespaces

我有一个类似于以下内容的 XML (XAML) 字符串：

```
<Zot xmlns="clr-namespace:A.B;assembly=A"
     xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
</Zot> 
```

Silverlight XamlReader 类无法加载此字符串，它需要一个特定的默认命名空间：

```
<z:Zot 
     xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
     xmlns:z="clr-namespace:A.B;assembly=A"
     xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
</z:Zot> 
```

（WPF XamlReader 不会显示这种烦人的行为）

原始格式的 XML 字符串以原始格式存储在数据库中。我需要将它们转换为后一种形式，并将其序列化为字符串。

关于实现这一目标的最简单方法的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-05T02:59:42.437

这是我的破解，使用 Python SAX 过滤器。

```
导入系统，字符串

从 xml.sax 导入 saxutils、处理程序、make_parser

第一个元素 = 真

类 ContentGenerator（handler.ContentHandler）：

    def __init__(self, out = sys.stdout):
        handler.ContentHandler.__init__(self)
        self._out = out

    def startDocument(self):
        经过

    def startElement(self, name, attrs):
        全局第一元素
        如果是第一个元素：
            属性 = 字典（属性）
            名称 = "z:" + 名称
            如果 attrs 中有“xmlns”：
                attrs['xmlns:z'] = attrs['xmlns']
            attrs['xmlns'] = "http://schemas.microsoft.com/winfx/2006/xaml/presentation"
            第一个元素 = 假
        elif ':' 不在名称中：
            名称 = "z:" + 名称
        self._out.write('<' + name)
        attrs.items() 中的（名称，值）：
            self._out.write(' %s="%s"' % (name, saxutils.escape(value)))
        self._out.write('>')

    def endElement（自我，姓名）：
        如果'：'不在名称中：
            名称 = "z:" + 名称
        self._out.write('</%s>' % name)

    def 字符（自我，内容）：
        self._out.write(saxutils.escape(content))

    def ignorableWhitespace(self, content):
        self._out.write(内容)

    def processingInstruction（自我，目标，数据）：
        self._out.write('<?%s %s?>' % (target, data))

解析器 = make_parser()
parser.setContentHandler(ContentGenerator())
parser.parse(sys.argv[1])

```

它跳转到第一个元素，处理属性，并继续在文档的其余部分中查找具有默认命名空间的所有元素。但是，您对文档有多个 xmlns="" 属性的评论意味着这需要一些帮助。通用技术还不错，SAX 管道是我们的朋友 :-)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-04T04:56:54.083

这可能没有多大帮助，但似乎所说的读者从根本上被打破了。使用的命名空间前缀应该是无关紧要的，除非如果属性值为 QNAmes，则必须正确绑定它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T05:05:26.620

这可能会有所帮助。

```
 using System;
    using System.Linq;
    using System.Collections;
    using System.Collections.Generic;
    using System.Xml;
    using System.Xml.Linq;

    public class MainClass 
    {
        public static void Main() 
        {
            XNamespace nameSpace = "http://www.microsoft.com";

            XElement xBooks = new XElement(nameSpace + "Books",
              new XAttribute(XNamespace.Xmlns + "linqdev", nameSpace),
            new XElement(nameSpace + "BookParticipant"));

            XmlDocument xdoc = new XmlDocument();
            xdoc.LoadXml(xBooks.ToString());
            xdoc.Save("c:\\xmloutput.xml");

        }
    } 
```

这将输出（来自 XmlDocument xdoc，虽然实际上不需要 XmlDocument 行，但我只是将它们包含在示例中以显示使用）：

```
<linqdev:Books xmlns:linqdev="http://www.microsoft.com">
  <linqdev:BookParticipant />
</linqdev:Books> 
```

您可以使用一些 xml 读取技术从原始字符串中提取其他名称空间，然后使用上述技术创建新字符串。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T20:42:31.220

也许你可以用这个： [http ://www.cnblogs.com/sheva/archive/2006/08/28/488915.html](http://www.cnblogs.com/sheva/archive/2006/08/28/488915.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-05T00:17:32.687

我能想到的最好的方法是为任何具有默认 xmlns 属性的元素提供不同的命名空间前缀的样式表。由于我的文档有多个 xmlns="..." 属性，因此将递归地应用到树中。

如果它对其他人有用，这里是......虽然我的 XSL 技能主要基于谷歌：

```
<?xml version="1.0" encoding="UTF-8"?>

<xsl:stylesheet 
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0"
    xmlns:ms="urn:schemas-microsoft-com:xslt"   
    >
    <xsl:output method="xml" version="1.0" encoding="UTF-8" indent="yes"/>    

    <xsl:variable name="root_default_ns" select="namespace-uri(/*)" />

    <xsl:template match="node()|text()">
        <xsl:copy>
            <xsl:copy-of select="@*"/>
            <xsl:apply-templates select="node() | text()"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="*">
        <xsl:param name="old_default_ns" select="$root_default_ns"/>
        <xsl:param name="new_default_ns" />

        <!-- match any element in the source default namespace -->
    <xsl:if test="namespace-uri() = $old_default_ns">
          <xsl:element name="ns_{$new_default_ns}:{local-name()}" namespace="{$old_default_ns}">
              <xsl:copy-of select="@*"/>
               <xsl:apply-templates select="node() | text()">
                   <xsl:with-param name="old_default_ns" select="$old_default_ns" />
                   <xsl:with-param name="new_default_ns" select="$new_default_ns" />
           </xsl:apply-templates>
          </xsl:element>
        </xsl:if>

        <!-- match any element with a prefix qualified namespace -->
        <xsl:if test="namespace-uri() != $old_default_ns and contains(name(), ':')"> 
          <xsl:element name="{name()}" namespace="{namespace-uri()}">
               <xsl:copy-of select="@*"/>
               <xsl:apply-templates select="node() | text()">
                   <xsl:with-param name="old_default_ns" select="$old_default_ns" />
                   <xsl:with-param name="new_default_ns" select="$new_default_ns" />
           </xsl:apply-templates>
          </xsl:element>
    </xsl:if>

        <!-- match any element *without* a prefix qualified namespace -->
        <xsl:if test="namespace-uri() != $old_default_ns and contains(name(), ':') = false"> 
      <xsl:variable name="new_ns" select="count(ancestor::*)" />

          <xsl:element name="ns_{$new_ns}:{name()}" namespace="{namespace-uri()}" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" >
               <xsl:copy-of select="@*"/>
               <xsl:apply-templates select="node() | text()">
                   <xsl:with-param name="old_default_ns" select="namespace-uri()" />
                   <xsl:with-param name="new_default_ns"><xsl:value-of select="$new_ns" /></xsl:with-param>
           </xsl:apply-templates>
          </xsl:element>
        </xsl:if>

    </xsl:template>

    <!-- match root element only, and inject Silverlight namespace -->
    <xsl:template match="/*">
       <xsl:element name="ns_root:{local-name()}" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" namespace="{$root_default_ns}">
          <!-- inject the Silverligth ns -->
         <xsl:variable name="dummy">
           <Dummy/>
         </xsl:variable>
         <xsl:copy-of select="ms:node-set($dummy)/*/namespace::*"/>
         <xsl:copy-of select="@*"/>
         <xsl:apply-templates select="node() | text()">
           <xsl:with-param name="old_default_ns" select="$root_default_ns" />
           <xsl:with-param name="new_default_ns">root</xsl:with-param>
         </xsl:apply-templates>
      </xsl:element>
    </xsl:template>

 </xsl:stylesheet> 
```

不幸的是，在跳过这个圈之后，我得到了一个 XAML 字符串，它现在符合 XamlReader 期望的约定，但会产生一个 System.ExecutionEngineException （WPF XamlReader 仍然可以很好地处理字符串）

# asp.net - 开始调试时阻止 Visual Studio 启动新的浏览器窗口？

> ID：716494
> 
> 赞同：418
> 
> 时间：2009-04-04T04:20:14.297
> 
> 标签：asp.net, visual-studio, debugging, internet-explorer, browser

我已经在我正在调试的网站上打开了一个窗口。每次我需要调试时，我都不需要 VS 为我启动另一个。

有没有办法阻止这种行为？

* * *

## 回答 #1

> 赞同：462
> 
> 时间：2009-04-04T08:17:08.500

打开启动项目的属性（*Project → {ProjectName} Properties...*从主菜单或右键单击*解决方案资源管理器*中的项目并选择*Properties*），然后导航到*Web*选项卡并在*Start Action*下选择*Don't open a page . 等待来自外部应用程序的请求*。

您仍然可以使用任何浏览器（或 Fiddler，等等）来访问正在运行的应用程序，但它不会自动打开浏览器窗口，它只会在后台启动并等待任何请求。

* * *

## 回答 #2

> 赞同：205
> 
> 时间：2018-06-06T20:41:22.330

对于 VS 15.7.1 `Tools`→ `Options`→ `Projects and Solutions`→ `Web Projects`→ 取消选中`Stop debugger when browser window is closed`。

* * *

## 回答 #3

> 赞同：117
> 
> 时间：2017-09-14T06:21:39.077

.NET Core Web Api 项目的更新答案...

右键单击您的项目，选择“属性”，转到“调试”并取消选中“启动浏览器”复选框（默认启用）。

[![在此处输入图像描述](https://i.stack.imgur.com/C2FQH.png)](https://i.stack.imgur.com/C2FQH.png)

* * *

## 回答 #4

> 赞同：56
> 
> 时间：2016-04-11T16:58:40.727

在 ASP.Net 5 项目中，现在可以为每个启动配置文件进行设置。

打开Startup Project Properties 文件夹下的文件**launchsettings.json**`"launchBrowser": false`并添加到您正在配置的配置文件中，例如：

```
"profiles": {
    "IIS Express": {
      "commandName": "IISExpress",
      "launchBrowser": false,
      "environmentVariables": {
        "Hosting:Environment": "Development"
      }
    }
} 
```

* * *

## 回答 #5

> 赞同：24
> 
> 时间：2019-06-03T09:09:54.020

我已经按照以下步骤解决了我的问题。转到工具>>单击选项>>单击项目和解决方案>>网络项目>>取消选中“关闭浏览器时停止调试”选项[![在此处输入图像描述](https://i.stack.imgur.com/U5TOa.png)](https://i.stack.imgur.com/U5TOa.png)

* * *

## 回答 #6

> 赞同：20
> 
> 时间：2019-12-05T10:36:38.397

此解决方法适用于 VS 2019

> 工具 => 选项

然后`Projects and solutions`在搜索框中输入。

选择`Web Projects`.

然后取消选择下面的选项。

> 关闭浏览器窗口时停止调试器，调试停止时关闭浏览器。

这对我有用。希望这会有所帮助。

* * *

## 回答 #7

> 赞同：19
> 
> 时间：2020-10-12T08:14:16.090

在 Visual Studio 2019 中，我解决了以下相同的问题：

转到您的 Visual Studio 选项**工具**>>>**选项**>>>**项目和解决方案**>>> **Web 项目**然后最后**取消**勾选选项 >>>**停止调试器浏览器窗口已关闭，调试停止时关闭浏览器**

**第1步：**

[![在此处输入图像描述](https://i.stack.imgur.com/cg3jq.png)](https://i.stack.imgur.com/cg3jq.png)

**第二步：** 取消勾选选项>>>**停止调试器浏览器窗口关闭，调试停止时关闭浏览器**

[![在此处输入图像描述](https://i.stack.imgur.com/BTjfg.png)](https://i.stack.imgur.com/BTjfg.png)

**第 3 步：**

然后最后点击 >>> **OK**按钮，这些都是解决问题的步骤。

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2009-04-04T04:40:43.857

您可以使用附加到进程功能，而不是按`F5`。

这也可以让您在已知的工作部分中导航，而不会降低下面加载的 VS 调试器的速度。

* * *

## 回答 #9

> 赞同：12
> 
> 时间：2018-08-24T10:56:57.793

由于我的 VS 中没有提到的选项，即 Visual Studio Enterprise 2017，我不得不寻找其他选项。

这是我发现的：

转到工具 -> 选项 -> 调试选项卡（常规）并取消选中“为 Asp.Net（Chrome 和 IE）启用 JavaScript 调试。

[![在此处输入图像描述](https://i.stack.imgur.com/EQIep.png)](https://i.stack.imgur.com/EQIep.png)

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2009-04-04T05:16:19.793

当你第一次打开一个 web/app 项目时，做一个`Ctrl`- `F5`，这是在不调试的情况下启动应用程序的快捷方式。然后，当您随后点击`F5`并启动调试器时，它将使用该 IE 实例。然后在 Visual Studio 中停止并启动调试，而不是关闭 IE。

它适用于我的机器。我正在使用内置的开发网络服务器。不知道这是否有区别。

Firefox 也将保持打开状态，因此您可以同时调试其中一个或两个。

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2013-08-26T10:46:11.410

似乎有一种情况，上述情况均无济于事，但以下情况有所帮助。我正在为 Windows Azure 云平台开发一个项目，并且我有一个 Web 角色。确实有一个单选按钮*Don't open page* in *Project -> {Project name} properties...*正如 Pawel Krakowiak 所指出的那样，但它对我的情况没有任何影响。但是，解决方案资源管理器中有主云项目，其下有*Roles*文件夹。如果我在此文件夹中右键单击我的 Web 角色并选择*Properties*，我会得到另一组设置，并且在*Configuration*选项卡上有*Launch browser for* flag，取消选中它后，在应用程序启动时不会打开新的浏览器窗口。

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2020-11-27T05:48:27.160

这是为我做的：

转到**项目属性>调试>取消选中“启动浏览器”>保存**。

[![在此处输入图像描述](https://i.stack.imgur.com/vQduk.png)](https://i.stack.imgur.com/vQduk.png)

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2018-05-06T11:42:58.350

Joao Costa 的回答也适用于 .Net core 2 项目。

launchsettings.json --> "launchBrowser": **false**

```
"profiles": {
    "IIS Express": {
      "commandName": "IISExpress",
      "launchBrowser": false,
      "environmentVariables": {
        "Hosting:Environment": "Development"
      }
    }
} 
```

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2016-04-15T07:25:29.597

我查看了答案，没有看到我找到的解决方案。如果是，我很抱歉。在我的情况下，当前使用 Visual Studio 2015。在解决方案资源管理器中，右键单击项目文件并单击属性。转到“调试”选项卡，这应该包含有关您如何为前两个下拉菜单启动“IIS Express 或 Web（DNX）”的信息，然后应该有一个用于“启动 URL：”的复选标记框。取消选中此选项，您的浏览器将不会在您每次调试应用程序时自动启动。希望这可以帮助某人。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2017-12-04T14:01:41.673

虽然有几个很好的答案，从[常见的嫌疑人](https://stackoverflow.com/a/716757/5040900)到[较新](https://stackoverflow.com/a/46211917/5040900)的解决方案，但我想再提供一个来解决**当您处理具有多个项目的解决方案时应该做什么**。

在我找到这个解决方案之前，我一直在查看**`bindingInformation`**解决方案的 applicationhost.config，不知疲倦地寻找任何关于为什么事情根本不起作用的线索。

> 事实证明，我忽略了一个**简单**的事情是不同的项目也有单独的设置。
> 
> 所以，除了`Project > {Project-Name} Properties... > Web > Start Action`我的后端项目，我还必须去`Website > Start Options... > Start Action`我的前端项目。一到那里，我就选择`Don't open a page. Wait for a request from an external application`了，从那以后我就一直很开心！

[![后端设置](https://i.stack.imgur.com/MDjGF.png)](https://i.stack.imgur.com/MDjGF.png) [![前端设置](https://i.stack.imgur.com/h0w9A.png)](https://i.stack.imgur.com/h0w9A.png)

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2018-09-23T07:30:21.080

您可以右键单击您的项目，然后选择`Properties`，在`Debug`选项卡上您应该取消选中`launch browser`复选框。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2015-10-22T11:53:53.763

`CTRL`+ `ALT`+`ENTER`如果你的修改只是前端

[http://blogs.msdn.com/b/webdev/archive/2013/06/28/browser-link-feature-in-visual-studio-preview-2013.aspx](http://blogs.msdn.com/b/webdev/archive/2013/06/28/browser-link-feature-in-visual-studio-preview-2013.aspx)

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2020-07-20T22:48:13.397

如果您在 IIS 中使用 Web 发布功能，那么我找到的解决方案是编辑发布配置并`Destination URL`从配置中删除（留空）。

如果已定义，则每次发布项目时都会打开 中指定的 URL `Destination URL`（这是一个重定向 URL）。

参考： https: [//support.winhost.com/kb/a1604/visual-studio-publish-web-deploy.aspx](https://support.winhost.com/kb/a1604/visual-studio-publish-web-deploy.aspx)

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2020-05-13T08:59:44.287

您现在还可以通过单击“运行”按钮旁边的下拉箭头来访问 Web 属性！

1.  单击“运行”旁边的下拉按钮
2.  *{ 项目名称 }* *属性*
3.  点击左侧列表中的“Web”
4.  在“开始操作”部分下，点击不打开页面。

你都准备好了！

PS：这对我有用，我使用的是 VS Professional 2019 的 16.5.5 版 :)

# java - 在java中获取模式值

> ID：716496
> 
> 赞同：4
> 
> 时间：2009-04-04T04:22:36.647
> 
> 标签：java

知道如何从数组中获取模式值吗？例如，如果我有一个数字不同的数组，我如何使用 Java 来搜索出现最多的数字？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-04T05:05:45.107

在 O(n) 中完成，而不是 O(n^2)。需要长度 > 0 的数组。

```
public static int getMode(int[] values) {
  HashMap<Integer,Integer> freqs = new HashMap<Integer,Integer>();

  for (int val : values) {
    Integer freq = freqs.get(val);
    freqs.put(val, (freq == null ? 1 : freq+1));
  }

  int mode = 0;
  int maxFreq = 0;

  for (Map.Entry<Integer,Integer> entry : freqs.entrySet()) {
    int freq = entry.getValue();
    if (freq > maxFreq) {
      maxFreq = freq;
      mode = entry.getKey();
    }
  }

  return mode;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-04T06:40:56.703

这有点小，我不知道它的性能，但如果你愿意在你的 Java 中尝试一点 Groovy ......

```
static int modal( ArrayList values ) {
    use(Collections){
        values.max{ values.frequency(it) } 
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T04:35:29.033

一个基本的，虽然效率低下的算法是这样的：

```
static int modal( int[] values ) {
    int modal = 0;
    int mfreq = 0;
    for( int i : values ) {
        // Is this value the most frequent we've found so far?
        int freq = 0;
        for( int j : values ) {
            if( j == i ) {
                freq++;
            }
        }
        if( freq > mfreq ) {
            modal = i;
            mfreq = freq;
    }
    return modal;
} 
```

您可以通过预先计算每个值的频率并将它们存储在地图或类似物中来做得更好，尽管这仍然需要遍历值，并且仍然需要另一个循环来确定哪个具有最高频率。

# c++ - 损坏的 COM 对象注册

> ID：716498
> 
> 赞同：3
> 
> 时间：2009-04-04T04:24:07.173
> 
> 标签：c++, windows, com

[这是com 接口的 Register 实现的](https://stackoverflow.com/questions/712691/registering-implementation-of-a-com-interface)延续；直到现在我才得到需要调试的实际代码。

我有两个 COM 对象，一个实现 IAudioSessionEvents，一个实现 IClassFactory 并生成第一个对象。

以下代码注册了那些对象（根据我对COM注册的理解）：

```
BOOL RegisterClassManually(WCHAR* szGuid, WCHAR* szDllPath)
{
WCHAR szKeyName[1024];
wsprintf(szKeyName, TEXT("Software\\Classes\\CLSID\\%s"), szGuid);

if(!RegisterKeyValue(HKEY_CURRENT_USER, szKeyName, NULL, TEXT(DESCRIPTION_CONST))) return false;

wsprintf(szKeyName, TEXT("Software\\Classes\\CLSID\\%s\\InprocServer32"), szGuid);

if(!RegisterKeyValue(HKEY_CURRENT_USER, szKeyName, NULL, szDllPath)) return false;
if(!RegisterKeyValue(HKEY_CURRENT_USER, szKeyName, TEXT("ThreadingModel"), TEXT("Apartment"))) return false;

return true;
}

STDAPI DllRegisterServer()
{
//Write data to HKEY_CURRENT_USER\\Software\\Classes\\CLSID\\{GUID}
// Also ""\\InProcServer32
// Also "".ThreadingModel = "Apartment"

WCHAR* szGuid;
WCHAR szDllPath[512];
StringFromCLSID(CLSID_AudioEventsFactory, &szGuid);

if(g_dllModule == NULL) return SELFREG_E_CLASS;

GetModuleFileName(g_dllModule, szDllPath, 512);

if(!RegisterClassManually(szGuid, szDllPath)) return SELFREG_E_CLASS;

StringFromCLSID(CLSID_AudioEvents, &szGuid);

if(!RegisterClassManually(szGuid, szDllPath)) return SELFREG_E_CLASS;

return S_OK;
} 
```

我省略了 RegisterKeyValue(...)，我确认它的简单注册表代码可以按预期工作。

此代码尝试使用这些 COM 对象：

```
IAudioSessionEvents* listener = NULL;

IClassFactory* factory = NULL;

//Fails on this call
hr = CoGetClassObject(CLSID_AudioEventsFactory, CLSCTX_ALL, NULL, __uuidof(IClassFactory), (void**)&factory);

if(hr != S_OK)
{
    ... Report Error ...
}

hr = factory->CreateInstance(NULL, __uuidof(IAudioSessionEvents), (void**)&listener); 
```

对 CoGetClassObject(...) 的调用返回 hr = 0x80040111（ClassFactory 无法提供请求的类）。

DllGetClassObject 的实现（每 1800 条信息指出 ommision）：

```
STDAPI DllGetClassObject(const CLSID& clsid,
                     const IID& iid,
                     void** ppv)
{

if (clsid == __uuidof(IClassFactory))
{
    AudioEventsFactory *pFact = new AudioEventsFactory;
    if (pFact == NULL)
        return E_OUTOFMEMORY;
    else
    {
        return pFact->QueryInterface(iid , ppv);
    }
}

return CLASS_E_CLASSNOTAVAILABLE;
} 
```

我在这里做错了什么？我怀疑它在 COM 注册中，但找不到任何实际列出注册表中所需内容的内容。我已经对我目前存储的内容进行了逆向工程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-04T04:51:38.527

这篇文章[COM in plain C](http://www.codeproject.com/KB/COM/com_in_c1.aspx#CLASS)很好地描述了如何在不使用 ATL 的情况下实现 COM dll。正如 1800 所指出的，将调用 DllGetClassObject 来创建 COM 对象。[COM Programmer's Cookbook](http://msdn.microsoft.com/en-us/library/ms809982.aspx)也是关于 COM 的很好的参考。

# count - 可数性问题（理论）

> ID：716511
> 
> 赞同：1
> 
> 时间：2009-04-04T04:35:05.883
> 
> 标签：count, computer-science, theory, set

我明天要考GRE，有一个问题。根据答案键，这个练习测试表明从 N 到 {0, 1} 的所有函数的集合是不可数的。

您不能将自然数映射到这些函数，如下所示？

```
 i   1 2 3 4 5 6 7 8 ...
f0 = 0 0 0 0 0 0 0 0 ...
f1 = 1 0 0 0 0 0 0 0 ...
f2 = 0 1 0 0 0 0 0 0 ...
f3 = 1 1 0 0 0 0 0 0 ...
f4 = 0 0 1 0 0 0 0 0 ... 
```

也就是说，f4(1)=0，f4(2)=0，f4(3)=1，f4(其他)=0。这最终不会涵盖所有可能的这些功能吗？我们绝对可以将自然数映射到这个集合。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-04T04:53:39.207

您列表中的所有条目将包含有限数量的条目。在您的列表中，所有偶数返回 0 但所有赔率返回 1 的函数会出现在列表的哪个位置，或者总是返回 1 的函数？对角化参数可以表明没有其他编号方案也可以工作。为此，考虑一个在位置 i 处返回 1-(fi(i)) 的函数。那么这个函数至少在一个地方与列表中的每个条目不同，所以它不在列表中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T04:42:57.097

这是康托尔定理的一部分。见[这篇论文](http://www.math.ucla.edu/~hbe/comp/8countable.pdf)（接近尾声。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-04T04:44:31.070

如果这是可数的，那么非理性也必须是可数的。想想你列出的每个二进制十进制函数，你可以将它们与实数 [0, 1) 1:1

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-04T05:01:56.987

由该算法构造的任何函数 f_k 都有有限数量的值 n，使得 f_k(n)=1，但您有函数 f(odd)=1, f(even)=0，这是一个有效的函数并且不在此算法可以生成的函数列表中。

一般来说，您可以应用康托尔的对角线论证，如 Dan 所述。如果这样的集合是可数的，那么你有一个可数的函数族 g_1，g_2，...，它们涵盖了整个集合。但是你可以构造一个新函数 h 使得 h(n) != g_n(n)，通过构造 h 不能等于任何 g_k，荒谬！

# command-line - 列出回收站中的文件

> ID：716521
> 
> 赞同：6
> 
> 时间：2009-04-04T04:49:54.240
> 
> 标签：command-line, windows-vista, cmd, recycle-bin

我想从命令行列出 Vista 中回收站中的文件。到目前为止，我有这个：

```
dir C:\$Recycle.Bin /s /b >> recyclebin.txt 
```

这工作正常，我得到的输出是这样的：

> `C:\$Recycle.bin\S-1-5-21-931442927-344369455-2477061601-1000\$I2H8K48.zip` `C:\$Recycle.bin\S-1-5-21-931442927-344369455-2477061601-1000\$IE94UAG.exe` `C:\$Recycle.bin\S-1-5-21-931442927-344369455-2477061601-1000\$IR4P99W.rar` `C:\$Recycle.bin\S-1-5-21-931442927-344369455-2477061601-1000\$R2H8K48.zip` `C:\$Recycle.bin\S-1-5-21-931442927-344369455-2477061601-1000\$RE94UAG.exe` `C:\$Recycle.bin\S-1-5-21-931442927-344369455-2477061601-1000\$RR4P99W.rar`

而且我的回收站中只有 3 个文件名为`auto-it-v3-setup.exe`,`fcleanerportable.rar`和`Reinstall.rar`.

有没有办法将这些名称放入`.txt`文件列表，而不是上面的那些代号文件？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-01-04T19:07:09.803

To list files in Recycle Bin by their original location using PowerShell (save as file.ps1, remove line breaks before | so that you get only two lines):

```
(New-Object -ComObject Shell.Application).NameSpace(0x0a).Items()
|select @{n="OriginalLocation";e={$_.ExtendedProperty("{9B174B33-40FF-11D2-A27E-00C04FC30871} 2")}},Name
| export-csv -delimiter "\" -path C:\Users\UserName\Desktop\recycleBinFiles.txt -NoTypeInformation

(gc C:\Users\UserName\Desktop\recycleBinFiles.txt | select -Skip 1)
| % {$_.Replace('"','')}
| set-content C:\Users\UserName\Desktop\recycleBinFiles.txt 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T05:46:01.873

[我在这里](https://www.cc-community.net/threads/papierkorb-nach-zeit-leeren.65620/#post-625774)找到了这个脚本。并使用我的批处理文件中的这个命令来调用它

```
cscript recyclebin.vbs >> "logs\recyclebin.txt" 
```

* * *

将以下内容另存为`recyclebin.vbs`：

```
Option Explicit

Dim g_objWshShell, g_objFSO, g_sLogFile, g_objWshNetwork, g_sScriptName, g_sComputerName, g_sUserName
Dim g_sVer, g_objLogFile, g_sLogDir

'Setup main variables and objects
Set g_objWshShell = WScript.CreateObject("WScript.Shell")     'Create a Shell Object
Set g_objFSO = CreateObject("Scripting.FileSystemObject")     'create a File System Object
Set g_objWshNetwork = WScript.CreateObject("WScript.Network") 'Create Network Object
g_sComputerName = g_objWshNetwork.Computername                'Gets machine Computer name
g_sUserName = g_objWshNetwork.UserName                        'Gets logged-on username
g_sScriptName=UCase(WScript.ScriptName)                       '*** Name of the script

' *** START LogFile Information - use Delete or Append info below; don't use both ***
Const FORREADING = 1, FORWRITING = 2, FORAPPENDING = 8        'Setup constants for writing, appending, etc
g_sLogDir = "C:\TEMP"
If Not (g_objFSO.FolderExists(g_sLogDir)) Then
    g_objFSO.CreateFolder(g_sLogDir)
End If
g_sLogFile = g_sLogDir & "\" & Left(g_sScriptName, Len(g_sScriptName) - 3) & "LOG" 'Makes log file the SCRIPTNAME.Log
g_sVer = "1.0"

'To delete a logfile and create a new one each time script is ran
If g_objFSO.FileExists(g_sLogFile) Then
    g_objFSO.DeleteFile(g_sLogFile) 'Delete logfile if it exists.
End If
Set g_objLogFile = g_objFSO.CreateTextFile(g_sLogFile, FORWRITING) 'Setup the logfile for writing

Call Main()
Call ExitScript()

'Start main script HERE ***
Sub Main()
    Dim objRecycleBin, objFolderItems, objItem, strSpecialFolderName
    strSpecialFolderName = "Recycle Bin"
    'Call WriteLine("Starting " & g_sScriptName & " at " & Date & " " & Time, g_objLogFile)
    Set objRecycleBin = GetSpecialFolderObject(strSpecialFolderName)    'Get Special Folder based upon input name
    Set objFolderItems = objRecycleBin.Items()                'Get items within Recycle Bin
    For Each objItem In objFolderItems                        'Delete all items within Special Folder
        If (objItem.Type = "File Folder") Then                'Check for file type
            g_objFSO.DeleteFolder(objItem.Path)               'Delete Folders
        Else
            g_objFSO.DeleteFile(objItem.Path)                 'Delete Files
        End If
        WScript.Echo "Deleted " & objItem.Name
    Next
End Sub

'*-*-*-*-*- Start Subroutines here *-*-*-*-*-
'Returns SpecialFolder based upon name of folder
Function GetSpecialFolderObject(NameOfFolder)
    Dim objShellApp, i, objSpecialFolder
    Set objShellApp = CreateObject("Shell.Application")
    On Error Resume Next
    For i=0 To 40   '40 is highest value for special folders
        Set objSpecialFolder = objShellApp.NameSpace(i)
        If (StrComp(objSpecialFolder.Title, NameOfFolder, vbTextCompare) = 0) Then
            Set GetSpecialFolderObject = objSpecialFolder
            Exit For
        End If
    Next
    Err.Clear
End Function

'Closes logfile and exits script
Sub ExitScript()
    'Call WriteLine(Date & " " & Time & "; Completed " & g_sScriptName, g_objLogFile)
    If IsObject(g_objLogFile) Then
        g_objLogFile.Close
    End If
    Wscript.Quit
End Sub

Sub EndOnError(sErrorString)
    WScript.Echo sErrorString & vbCrLf & "Check " & Chr(34) & g_sLogFile & Chr(34) & " for details"
    Call WriteLine (sErrorString, g_objLogFile)
    WScript.Quit()
End Sub

'Shows usage if input is wrong
Sub ShowUsage()
    WScript.Echo g_sScriptName & " v" & g_sVer & " Empties Recycle Bin for logged on user" & vbCrLf _
        & vbCrLf & "USAGE: [CSCRIPT] " & g_sScriptName
    WScript.Quit
End Sub

'Writes to log
Sub WriteLine(ByVal strMessage, ByVal objFile)
    On Error Resume Next
    If IsObject(objFile) Then        'objFile should be a file object
        objFile.WriteLine strMessage
    Else
        Call Wscript.Echo(strMessage)
    End If
End Sub 
```

# python - 打包 Ruby 或 Python 应用程序以进行分发？

> ID：716524
> 
> 赞同：4
> 
> 时间：2009-04-04T04:52:53.233
> 
> 标签：python, ruby, deployment

*除了 JVM 之外，还有其他*好的选择来打包 Python 或 Ruby 应用程序以分发给最终用户吗？具体来说，我正在寻找能够编写和测试用 Ruby 或 Python 编写的基于 Web 的应用程序的方法，并配有一个后端数据库，然后我可以将其封装在一组方便的独立于平台的包中（某种类型的）部署在 Windows、Linux、OS X 和 FreeBSD 上？

**编辑：**我所说的“基于 Web 的应用程序”是指最终用户可以在其公司的服务器上运行的 Web 应用程序，在内部为其最终用户提供 Web 服务。有很多方法可以通过 JPython 或 JRuby 在 JVM 上执行此操作，但我很好奇是否存在带有备用 VM 或解释器的非 JVM 路由。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-04T05:08:36.097

对于 Python，有[distutils](http://docs.python.org/library/distutils.html)，并且 Ars Technica不久前有一篇关于打包跨平台 PyQt 应用程序的[非常好的文章。](http://arstechnica.com/open-source/guides/2009/03/how-to-deploying-pyqt-applications-on-windows-and-mac-os-x.ars)这将使您进行设置，因此您至少可以将东西捆绑到可以部署在多个平台上的包中，这对于免费的东西来说是合理的。

如果您尝试分发专有代码，我不确定这是否真的是比使用 JVM 更好的分发方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-04T14:10:28.150

我不确定我在这里理解你。您想创建一个基于 Web 的应用程序并将其发送给最终用户吗？我不确定如何解释：

*   您想创建一个具有自定义 GUI 的应用程序，该应用程序使用网络连接来获取数据并将一些信息本地存储在数据库中？
*   您想创建一个用户可以安装在网络服务器上的 RoR/Django 类型的应用程序，然后通过浏览器访问他们自己的实例？

我不会说 python，但是您可以使用[Shoes](http://wiki.github.com/why/shoes)为 Ruby（跨平台）创建和打包自定义 GUI。为了打包一个基于 webserver/browser-GUI 的应用程序，我认为 Ruby on Rails 社区已经为此构建了一些工具 - 可能是[Capistrano](http://www.capify.org) - 但话又说回来，我没有做很多 RoR 开发。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-05T02:22:44.617

您不能以一般的跨平台方式严格执行此操作（创建单个安装程序/可执行文件），因为不同的平台使用不同的可执行格式。JVM 依赖于已经在目标计算机上安装了特定于平台的 JVM；如果*没有*安装了一个，那么除非您以特定于平台的方式安装 JVM，否则您的 JAR 将无法运行。或许更重要的是，任何依赖二进制扩展的第三方 Python 包都不能很好地与 Jython 配合使用，除非专门在 Jython 版本中发布，这是不寻常的。（我认为 Ruby 包也有类似的情况，尽管我没有直接的了解，也不知道 Ruby 包使用二进制扩展有多普遍......）你可以使用整个 Java 范围库，但很少使用 Python/Ruby 库。还值得注意的是，JVM 版本的语言往往落后于标准版本，提供更少的语言功能和更少的错误修复。

如果您的代码是纯 Python，那么只要目标机器已经安装了 Python，它就已经是跨平台的，就像 Java 一样……但至少在 Windows 中，假设安装了 Python 比假设安装了 Python 更不安全安装了Java。第三方元素（数据库等）也可能是特定于平台的二进制文件。用户对什么是合理的安装过程的期望也因平台而异——如果你的应用程序使用第三方库或工具，你最好为 Windows 用户包括所有这些，但 *nix 用户往往更容忍下载依赖关系。（然而，对包管理器自动处理的期望越来越高......）

确实，如果这是一个大型应用程序堆栈，并且您希望能够拥有一个可以部署在几乎任何服务器上的嵌入式捆绑包，那么最简单的方法可能是将其作为完整的 VMWare 虚拟机分发——播放器软件是免费的（至少适用于 Windows 和 *nix，但我想也适用于 Mac），它允许您创建一个专门为您的应用程序完全配置的专用 Linux/BSD 系统。（我说 Linux/BSD 是因为你不需要担心操作系统许可费用......）

（如果它是一个较小的应用程序，您希望允许在客户端现有的网络服务器上运行，那么我怀疑跨操作系统兼容性将比跨网络服务器兼容性更受关注——虽然 Apache*确实*有 Windows 版本，但大多数 Windows 网络服务器都运行 IIS，并且拥有与这两个网络服务器都兼容的单个包分发（甚至是应用程序的单个版本）可能是不切实际的。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-08-09T20:00:27.463

您可以将应用程序作为虚拟机分发，也可以创建包含所有依赖项的安装程序，就像 GitHub 人员为他们的本地版本所做的那样。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-12-26T04:43:23.750

试试[https://packager.io/](https://packager.io/)，如果你的代码是公开的，它是免费的。

引用他们的网站：

> 分发和安装现代 Web 应用程序很痛苦。我们会自动打包它们，因此您不必这样做。Packager.io 是一项服务，可自动将您的应用程序打包为 DEB 或 RPM 包，适用于许多目标发行版。
> 
> 目前，您可以打包用 Ruby、NodeJS 或 Go 编写的应用程序。
> 
> 过程如下：
> 
> *   使用您的 GitHub 帐户注册。
> *   启用您要打包的应用程序之一。
> *   每次您将新代码推送到 GitHub 存储库时，都会在我们的服务器上启动构建。您还可以从用户界面手动启动构建。
> *   在构建过程中，您的代码被获取，并通过一个构建包列表运行，这些构建包负责获取您的应用程序所需的所有依赖项，然后生成一个 DEB 或 RPM 包，并托管在您自己的 APT 或 YUM 存储库中.
> *   您现在可以登录您的服务器，并使用简单的 apt-get install 或 yum install 安装您的应用程序。

用法是这样的

```
my-app run ruby -v
my-app run rake db:migrate
my-app run console
#Inspect your application's logs:    
my-app logs
#Set configuration variables for your application:
my-app config:set DATABASE_URL=...
#Start/Stop/Restart the application, in a distribution-independent way:
my-app start|stop|restart [web|worker] 
```

# .net - 如何使用 .NET 对 XML 文件进行排序？

> ID：716525
> 
> 赞同：4
> 
> 时间：2009-04-04T04:53:15.387
> 
> 标签：.net, xml, sorting

因此，您有一个第三方 Web 服务，它喜欢滥用 XML 并以使您的编程完全痛苦的顺序返回内容。例如...

```
<file>
  <node1>Foo</node1>
  <price>4.99</price>
  <node2>
    <key>XX999</key>
  </node2>
</file> 
```

大约有一千种按价格排序。

**如何通过键值重新排序这个 XML 文档？**

我需要结果是一个排序的 XML 文件。谢谢！

**编辑：** .NET 2.0 版（无 LINQ）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-04T04:56:16.283

以下是使用 XSLT 的方法：

假设您的数据采用这种形式（file.xml）：

```
<?xml version="1.0"?>
<listing>
<file>
  <node1>Foo</node1>
  <price>4.99</price>
  <node2>
    <key>XX999</key>
  </node2>
</file>
<file>
  <node1>Bar</node1>
  <price>5.67</price>
  <node2>
    <key>aa743</key>
  </node2>
</file>
<file>
  <node1>Was</node1>
  <price>5.67</price>
  <node2>
    <key>rr321</key>
  </node2>
</file>
</listing> 
```

这个转换（stylesheet.xsl）：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:strip-space elements="*"/>
  <xsl:output method="xml" indent="yes"/>

  <xsl:template match="listing">
    <xsl:copy>
      <xsl:apply-templates select="file">
        <xsl:sort select="node2/key" data-type="text"/>
      </xsl:apply-templates>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="@* | node()">
    <xsl:copy>
      <xsl:apply-templates select="@* | node()"/>
    </xsl:copy>
  </xsl:template>

</xsl:stylesheet> 
```

与此 .Net 代码一起使用时（需要添加`using System.Xml;):`

```
XslCompiledTransform xslt= new XslCompiledTransform();
xslt.Load(@"c:\stylesheet.xsl");

xslt.Transform(@"C:\file.xml", @"c:\sorted.xml"); 
```

在 sorted.xml 中产生此输出：

```
<?xml version="1.0" encoding="utf-8"?>
<listing>
  <file>
    <node1>Bar</node1>
    <price>5.67</price>
    <node2>
      <key>aa743</key>
    </node2>
  </file>
  <file>
    <node1>Was</node1>
    <price>5.67</price>
    <node2>
      <key>rr321</key>
    </node2>
  </file>
  <file>
    <node1>Foo</node1>
    <price>4.99</price>
    <node2>
      <key>XX999</key>
    </node2>
  </file>
</listing> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-04T05:01:54.087

应用 Xml 样式表将源 XML 转换为适合您使用的 XML 格式。您可以在 xsl 转换期间轻松按值对元素进行排序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-04T06:42:30.287

当然，XSLT 规则，但我会使用 LINQ To XML（即`System.Xml.Linq`名称空间中的内容）。具体来说，您需要做的是这样的事情：

```
newElement = new XElement(oldElement.Elements().OrderBy(x => x.Whatever); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-04T05:54:09.530

Linq to XML 会为您处理这个问题吗？

# actionscript-3 - Actionscript3：如何从外部类访问舞台上的元素？

> ID：716530
> 
> 赞同：2
> 
> 时间：2009-04-04T04:56:50.540
> 
> 标签：actionscript-3

我在 .as 文件中有一个外部类，我的问题是我无法访问舞台上的元素。像 stage.txtfield.text 或 this.parent.txtfield.text 这样的代码不起作用。txtfield 是动态文本字段的实例名称。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-04T15:37:51.453

这有点取决于外部类。

如果它扩展了 DisplayObject（或 DisplayObject 的任何孙子），则只要将它添加到显示列表（即添加到舞台或显示列表上的任何其他 DisplayObjectContainer 时），您就可以使用 stage 属性进行访问。

要监听它，请在外部类中使用以下代码：

```
addEventListener(Event.ADDED_TO_STAGE, AddedToStage);

//...

private function AddedToStage(e:Event):void
{
    trace("TextField text" + TextField(stage["textfield"]).text);
} 
```

如果它不是 displayObject 或者它不会出现在显示列表中，那么最好的办法是在构造函数或单独的方法调用中为其提供它需要访问的对象（如 TextField）。您可以给它一个对它自己的舞台的引用，但是如果您需要该类来操作 MovieClip 中的 TextField，那将不是很通用。

您可以使用以下代码提供对 TextField 的引用：

```
//In any DisplayObject on the display list (could be inside a MovieClip or on the Stage itself)

var manipulator:MyClass = new MyClass(TextField(stage["textfield"]));

//In the external class

public class MyClass
{
    publich function MyClass(txt:TextField)
    {
        trace("TextField text" + txt.text);
    }
} 
```

请注意，此代码不会检查文本字段是否确实存在。您应该首先检查并抛出适当的错误以使调试更容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T05:23:35.907

root 和 stage 不再是全局的，因此如果您希望在外部类中使用它们，则需要通过文档根类公开它们。

一些参考：[http ://www.kirupa.com/forum/showthread.php?p=1952513](http://www.kirupa.com/forum/showthread.php?p=1952513)

# java - Hibernate、iBatis、Java EE 或其他 Java ORM 工具

> ID：716532
> 
> 赞同：67
> 
> 时间：2009-04-04T04:57:35.047
> 
> 标签：java, hibernate, orm, jakarta-ee, ibatis

我们正在规划一个大型企业应用程序。在经历了 J2EE 的痛苦之后，我们正集中精力评估 hibernate。

看起来新的 Java EE API 更简单。我还阅读了一些关于 Hibernate 和 iBatis 的好东西。我们的团队对任何框架都没有什么经验。

我想确定 5 个主要比较点

*   学习曲线/易用性
*   生产率
*   可维护性/稳定性
*   性能/可扩展性
*   易于故障排除

如果您要管理一个由大约 6 名具有 J2EE 经验的开发人员组成的团队，您会使用哪个 ORM 工具，为什么？

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2009-04-04T10:51:50.203

让我来看看这个。首先，我在[Using an ORM or plain SQL?](https://stackoverflow.com/questions/494816/using-an-orm-or-plain-sql/494853#494853) . 专门针对您的观点：

**学习曲线/易用性**

Ibatis 是关于 SQL 的。如果您了解 SQL，则 ibatis 的学习曲线很简单。Ibatis 在 SQL 之上做了一些事情，例如：

*   通过...分组;
*   区分类型；和
*   动态 SQL。

你仍然需要学习，但最大的障碍是 SQL。

另一方面，JPA（包括 Hibernate）试图与 SQL 保持距离，并以对象而不是关系的方式呈现事物。然而，正如 Joel 所指出的，[抽象是有漏洞的](http://www.joelonsoftware.com/articles/LeakyAbstractions.html)，JPA 也不例外。要进行 JPA，您仍然需要了解关系模型、SQL、查询的性能调整等。

Ibatis 只会让您应用您知道或正在学习的 SQL，而 JPA 将要求您了解其他内容：如何配置它（XML 或注释）。我的意思是弄清楚外键关系是某种关系（一对一，一对多或多对多），类型映射等。

如果您了解 SQL，我会说学习 JPA 的障碍实际上更高。如果您不这样做，那么 JPA 的结果就是混合的结果，允许您有效地推迟学习 SQL 一段时间（但它不会无限期地推迟学习）。

使用 JPA，一旦您设置了实体及其关系，其他开发人员就可以简单地使用它们，而无需学习有关配置 JPA 的所有内容。这可能是一个优势，但开发人员仍然需要了解实体管理器、事务管理、托管与非托管对象等。

值得注意的是，JPA 也有自己的查询语言 (JPA-SQL)，无论您是否了解 SQL，都需要学习它。您会发现 JPA-SQL 不能做 SQL 可以做的事情的情况。

**生产率**

这是一个很难判断的。就我个人而言，我认为我在 ibatis 中的工作效率更高，但我对 SQL 也很满意。有些人会争辩说他们使用 Hibernate 的效率更高，但这可能是由于——至少部分是因为不熟悉 SQL。

此外，使用 JPA 的生产力具有欺骗性，因为您偶尔会遇到数据模型或查询的问题，当您打开日志记录并查看您的 JPA 提供程序正在生成和工作的 SQL 时，您需要花费半天到一天的时间来解决输出设置和调用的组合，使其产生既正确又高效的东西。

使用 Ibatis 就没有这种问题，因为您自己编写了 SQL。您可以通过在 PL/SQL Developer、SQL Server Management Studio、Navicat for MySQL 或其他任何工具中运行 SQL 来测试它。查询正确后，您所做的就是映射输入和输出。

我还发现 JPA-QL 比纯 SQL 更尴尬。您需要单独的工具来运行 JPA-QL 查询以查看结果，这是您必须学习的更多内容。实际上，我发现 JPA 的整个部分相当笨拙和笨拙，尽管有些人喜欢它。

**可维护性/稳定性**

Ibatis 的危险在于扩散，这意味着您的开发团队可能只是在需要时继续添加值对象和查询，而不是寻求重用，而 JPA 每个表都有一个实体，一旦您拥有该实体，就是这样。命名查询倾向于在该实体上进行，因此很难错过。临时查询仍然可以重复，但我认为这不是一个潜在的问题。

然而，这是以刚性为代价的。通常在应用程序中，您需要来自不同表的点点滴滴的数据。使用 SQL 很容易，因为您可以编写单个查询（或少量查询）以一次性获取所有数据并将其放入自定义值对象中。

使用 JPA，您可以将该逻辑上移到您的业务层中。实体基本上全有或全无。现在严格来说这不是真的。各种 JPA 提供程序将允许您部分加载实体等，但即使在那里您谈论的是相同的离散实体。如果您需要来自 4 个表的数据，您要么需要 4 个实体，要么需要将所需的数据组合到业务或表示层中的某种自定义值对象中。

我喜欢 ibatis 的另一件事是您的所有 SQL 都是外部的（在 XML 文件中）。有些人会认为这是一个缺点，但我不是。然后，您可以通过搜索 XML 文件相对容易地找到表和/或列的用途。将 SQL 嵌入代码中（或者根本没有 SQL 的地方）可能会更难找到。您还可以将 SQL 剪切并粘贴到数据库工具中并运行它。这些年来这对我有用多少次，我怎么夸大都不为过。

**性能/可扩展性**

在这里，我认为 ibatis 胜出。它是直接的 SQL 和低成本。从本质上讲，JPA 根本无法管理相同级别的延迟或吞吐量。现在 JPA 的目标是延迟和吞吐量很少出现问题。然而，高性能系统确实存在，并且倾向于不喜欢 JPA 等更重量级的解决方案。

加上使用 ibatis，您可以编写一个查询，该查询使用您需要的确切列准确返回您想要的数据。从根本上说，JPA 在返回离散实体时无法击败（甚至匹配）它。

**易于故障排除**

我认为这也是 Ibatis 的胜利。就像我上面提到的，使用 JPA，您有时会花费半天时间来获取查询或实体生成您想要的 SQL，或者诊断事务失败的问题，因为实体管理器试图持久化非托管对象（可能是批处理的一部分）您已经投入了大量工作的工作，因此找到它可能并不容易）。

如果您尝试使用不存在的表或列，它们都会失败，这很好。

**其他标准**

现在您没有提到可移植性是您的要求之一（意味着在数据库供应商之间移动）。值得注意的是，这里 JPA 有优势。注释的可移植性不如 Hibernate XML（例如标准 JPA 注释没有 Hibernate 的“本机”ID 类型的等效项），但它们都比 ibatis / SQL 更可移植。

此外，我还看到 JPA / Hibernate 用作可移植 DDL 的一种形式，这意味着您运行一个小型 Java 程序，该程序从 JPA 配置创建数据库模式。使用 ibatis，您需要为每个支持的数据库编写一个脚本。

可移植性的缺点是 JPA 在某些方面是最低公分母，这意味着支持的行为在很大程度上是广泛的数据库供应商所支持的常见行为。如果你想在 ibatis 中使用 Oracle Analytics，没问题。在 JPA 中？嗯，这是个问题。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-04T05:02:52.413

iBatis 和 Hibernate 之间的一个简单的经验法则是，如果您想要更多的 SQL/关系视图，iBatis 更适合；而对于更复杂的继承链，以及不太直接的 SQL 视图，Hibernate。两者都是广泛使用且可靠的良好框架。所以我认为两者都可能运作良好。也许阅读两者的教程，看看一个听起来是否比另一个好，然后选择一个。

在您列出的内容中，我认为性能差别不大——瓶颈几乎总是数据库，而不是框架。对于其他事情，我认为不同的开发人员会更喜欢其中一个，即没有普遍接受的优先级（对于 iBatis 与 Hibernate）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-06T18:36:37.637

您使用哪种解决方案还取决于您选择（或要求）与 Java EE 规范的兼容程度。JPA 是 Java EE 系统中数据访问的“标准”，因此如果您特别想遵守它，则应该使用它（有一些警告）。

JPA 是对象关系映射系统的标准化。因此，它不提供实现，它只是定义了一种标准化的方法。Hibernate Entity Manager 就是这样一种实现。

由于 JPA 是跨多个供应商的标准，并且由于它仍然相当新，因此它缺少一些在某些用例中有价值的更深奥的功能（例如，用于生成动态 SQL 的 Criteria API）。如果您在需要直接使用 Hibernate 甚至直接使用 JDBC 的情况下使用 JPA 计划。对于这种情况，通用的 DAO 模式非常有用；你可以修改这个：[Generic Data Access Objects](http://www.hibernate.org/328.html) for use in JPA & JDBC 很容易。

JPA 有一些困难的限制（特别是如果您习惯于 Hibernate），并且对您施加了某些方法，这些方法对于更习惯于编写直接 JDBC 的开发人员来说是困难的。如果您支持将其作为一种方法，请务必做好有关 ORM 与 JDBC 的优缺点的功课。

如果您使用 JPA，一旦您达到学习曲线，它将在简单开发方​​面获得回报（特别是如果您正确实施上述 DAO 模式），而且还可以获得查询结果的多层缓存。如果做得好（我知道这是一个很大的“如果”），我已经看到这提供了可观的好处。

最后，如果你有一个没有什么灵活性的遗留数据模型，那么 Hibernate（和 JPA）会给你带来更多的麻烦，而不是值得。例如：

*   如果数据库没有候选主键（对于有效的 hashCode 和 equals 实现），您将需要预先分析哪些列唯一地定义了一行——可能很简单，也可能很复杂，具体取决于架构的复杂性；
*   如果您无法添加版本或时间戳列，您将失去 Hibernate 进行乐观锁定的能力，最终不得不在更新之前进行查询。

> *（针对第一条评论添加）* 如果您有幸重新设计数据库，那么如果您要使用 ORM，有两个非常重要的考虑因素：
> 
> *   为所有相关表添加版本号列以支持乐观锁定。
> *   在您的数据分析期间，决定开发人员应该将其用于&的不可为空的“[备用键](http://en.wikipedia.org/wiki/Alternate_key)”列。不要在这些方法中使用 PK 列。`hashCode()``equals()`

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-11-11T10:48:15.260

要向列表中添加另一个选项......请查看：

Ebean ORM ( [http://ebean-orm.github.io](http://ebean-orm.github.io) )。

它的主要主张是比 JPA 或 Hibernate 更简单、更直观的编程模型。具体来说，它没有 Hibernate Session 或 JPA EntityManager，没有分离/附加对象（没有合并、持久、刷新），延迟加载正常工作。

...也更易于使用和理解。

您还可以将您自己的 SQL 与 Ebean 一起使用（用于查询、更新、存储过程）和 IMO，它在使用您自己的 SQL 时与 Ibatis 相匹配，易于使用。

如果您希望在 Java SE 中使用 ORM，那么我建议您检查一下。

*   LGPL 许可证
*   使用 JPA 注释进行映射（@Entity、@OneToMany 等）
*   无会话 API（没有合并、持久化、刷新 ... save() 和 delete() 代替）
*   “部分对象”支持
*   大型查询支持（每个对象图持久化上下文）
*   后台查询
*   对批处理的良好支持
*   自动查询调优（通过“Autofetch”）

干杯，罗布。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2011-09-13T19:14:18.377

我们目前正在开发一个同时使用 Hibernate 和 ibatis 的项目。为什么要使用休眠？它支持我们的领域模型、关系和继承。我们有一个非常复杂的域模型，hiberante 很好地支持它。无需担心编写插入、更新等。Ibatis 仅用于查看。有查询，我们有与查询映射的视图对象（类似于域模型但不是域模型）。Ibatis 在视图对象中返回您想要的数据，而不用担心从结果集中读取，您必须在 Spring JDBC 中进行管理。为什么我们不使用 HQl 或 Spring JDBC 呢？域是如此复杂，在渲染视图时，我们会进行计算、分组和大量的原生 SQL 函数。我们在查询中完成所有这些，使用动态查询，在 ibatis 中管理条件并获得一个干净的轻量级对象。如果您必须遍历多个层以在休眠中获取数据，则更有意义因此，根据您的情况，您可能只想使用一个，两者都使用，也可能不使用。但毫无疑问，hibernate 不是你不能没有的东西。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2010-01-14T14:01:35.023

请注意，在非平凡的多线程应用程序中使用 JPA/Hibernate（可能还有大多数其他 ORM 解决方案）可以很快成为真正的 PITA，因为数据库会话需要被限制在一个线程中（会话对象不是线程安全的）。添加延迟加载以及持久实体最多可以属于一个活动会话的事实......您将陷入困境......

您可能想看看在[*多线程* Swing 应用程序中使用 Hibernate 的会话管理](https://stackoverflow.com/questions/1664446/session-management-using-hibernate-in-a-multi-threaded-swing-application)（或仅搜索“休眠多线程”）。

我的经验法则 (YMMV)：如果应用程序不适合某种请求/响应周期（例如 Web 服务），那么使用其他东西可能会更好。

当然，另一种解决方案是以规避上述框架限制的方式设计应用程序。更改应用程序的设计以便我可以让框架 XYZ 工作，但会留下不好的回味。

无论如何，只要我的 0.02 美元

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-05-24T10:52:38.523

我认为我们应该考虑我们使用 Java（或 OO）的主要原因。

系统必须灵活并允许不断修改规范（这在现实生活中经常发生）。否则我们应该用 C 编程，因为它要快得多。

我认为 Web 应用程序的最佳堆栈将是 Java EE：JPA - EJB - JSF（具有扩展的持久性上下文对话范围）。

JSF 也比纯 JSP/Servlet 慢，但它的开发速度更快。

JPA 更难学习，但开发速度更快（您知道：RAD），并且更改不会产生很大（容易出错的复制粘贴）影响。在您最常用的实体中添加一个新列，您将不得不更新 iBatis 中的所有语句...

JPA 并不是在所有情况下都能很好地工作，但它涵盖了大多数情况，并且它还允许您插入 Native Query 而不是 JPQL，而无需更改任何代码。但是如果你发现自己写了太多的 Native Query，你的项目可能更适合 iBatis。

至于性能，如果你了解事物是如何转换为 SQL 的，JPA 也是高性能的，如果你把它做他最擅长的事情，如果你把它做他不喜欢的事情，它会产生太多的查询. 没有魔法！您必须了解生成的查询，而不是一味地希望在可能出现一些复杂情况时能够采取简单的方法。

此外，如果开发人员拥有 SQL 的所有功能，他们将编写过于复杂的查询来处理业务逻辑，而不是将其放在一个集中的地方，您将在 SQL 中拥有一些业务逻辑，在 EJB 中拥有一些。JPA 应该用于持久化您的模型，而不是用于业务逻辑。

Criteria Query 也不适合构建安全的复杂动态查询。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-06-08T16:51:32.767

如果您确实有一个未开发项目，您可以使用 hibernate，但请注意学习曲线非常陡峭。

如果你有一个现有的数据库，那么使用 iBatis 会好得多，因为一天后你就很有效率，再过两天你就可以了解它了。

您必须考虑的一件事是，休眠条件 api 非常适合创建自定义查询，这取决于您的应用程序，这可能是一个很好的论据。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-04T15:53:38.433

如果你没有一个好的对象模型，我看不到 Hibernate 的好处。你当然有 ORM 中的“关系”，因为你有一个关系数据库，但“对象”是关键。没有对象，没有 ORM。我认为对象和表之间的 1:1 映射，没有更丰富的对象行为，并不能证明 ORM 的合理性。如果那是您的情况，请坚持使用 JDBC 或 iBatis。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-04-06T18:38:59.707

我建议使用 JPA 并取决于（严重！）您项目的持续时间/范围，您不妨研究一下 JPA2，因为它提供了 JPA 的一些缺失功能（例如，一个非常好的查询 API）。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-04-04T12:12:53.737

与休眠一起去。您的项目以后肯定会变得更大，并且投资（学习休眠）将以一种或另一种方式得到回报。

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2009-04-04T10:56:59.257

在决定使用哪一个之前，您是否尝试过回答为什么还要使用 ORM 工具？如果您的团队中有了解 SQL 的人员，请参阅坚持使用 JDBC。

# java - 如何从嵌入式软件开发过渡到 Web 开发？

> ID：716540
> 
> 赞同：5
> 
> 时间：2009-04-04T05:09:23.943
> 
> 标签：java, c++, mysql, asp.net-ajax, embedded

我是一名嵌入式软件开发人员，拥有大约 5 年以上的移动设备工作经验。我最近失去了工作，嵌入式领域的大多数工作（我遇到的）都需要安全许可，我没有资格获得安全许可。因此，出于这个原因，也只是为了学习新知识，我计划转向 Web 开发（Web 服务或任何使用数据库的有意义的应用程序等）。

请指导我应该考虑哪些因素来决定我应该选择哪种技术（MSFT / Java 相关 / LAMP）。如果可能的话，还为在现实生活中可能有一些应用的项目提供建议，以及我应该为此分配多少时间（因为这些天我有很多计划外的时间:)）。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-04T17:17:42.943

你考虑过linux内核开发吗？消费电子领域有许多公司需要具有 linux 驱动程序开发知识的软件工程师。对于具有良好嵌入式体验的人来说，这是一个相当容易的过渡，而且也很有趣！

更好的是，[Linux 驱动程序开发](http://lwn.net/Kernel/LDD3/)书可在线免费获得。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-04T08:41:34.807

我通常会说你应该利用你在为功率不足和内存不足的机器编程的经验。然而，Web 开发是一个非常不同的野兽。Web 服务器通常具有更多的计算能力和内存。

采用 LAMP 或其他方式，需要不同的计算范式。您通常会花更多时间在集成多个进程（数据库、脚本语言、Web 服务器）上，而不是实际提高速度和效率。过渡并不是那么容易。

因此，就像之前的回答所说的那样，您可能需要考虑走移动 Web 开发路线。您可以获得 openmoko/iphone/gphone 开发套件并开始试验。无论你能得到什么（并且在你的预算范围内）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-06T11:10:21.780

我也是一名嵌入式软件开发人员，正在考虑转向 Web 开发。不是因为我丢了工作（在我居住的德国，有足够多的嵌入人员的机会），而是因为在该领域工作了 9 年后，我想尝试其他的东西。

意识到你不只是在这里换工作，你在换行业。如果您在该领域缺乏经验，没有人会雇用您作为 Web 开发人员——尤其是在当前的经济环境中。

您可能会尝试在更大的互联网公司（例如服务提供商）找到一份工作，您的嵌入式技能会受到重视。我最近看到一个 ISP 的 VoIP 开发人员职位的招聘信息。他们正在寻找熟悉 C 和 C++ 的人，因为他们正在使用一些用这些语言编写的开源库。对于寻求转换行业的嵌入式开发人员来说，这听起来是一个很好的切入点。

一旦你进入这个新行业，你可能会有很多机会学习 Web 开发：关于新 Web 技术的内部培训、向经验丰富的同事学习、内部工作机会......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-04T13:57:19.913

首先，意识到如果你切换，你将完全重新开始。你可以过渡到 iPhone、Android 或 Symbian，但除非你习惯于自由职业者的工资和付款，否则我不会把你的生计押在上面。取决于你的个性和机会。

其次，在您希望受雇的地区建立和工作网络。友善、安静、具体：您的机会很可能与您认识的人以及他们想帮助您的程度有关。太多在屏幕前度过一生的程序员忘记了雇主和客户不是编译器。对人好点！

从一个全新的角度来看，您可能会查看本书中的 PHP/MySQL winestore：

[使用 PHP 和 MySQL 的 Web 数据库应用程序](http://books.google.com/books?id=WuxxvP7RZasC)

这是一个相当循序渐进（如果较旧）的方法来学习基于 Web 的程序的功能，以及如何完成它的方法。在掌握基础知识之前，不要担心 AJAX 和其他 web 2.0 的东西；在我看来，这只会令人困惑。

Atlassian 构建了用 Java 编写的基于 Web 的问题跟踪软件，它有一个开源开发工具包和一个 30 天的试用期。如果您想查看一些代码并在相当发达的领域工作，您可以尝试一下：

[http://confluence.atlassian.com/display/DEVNET/](http://confluence.atlassian.com/display/DEVNET/)

Web 开发是与嵌入式不同的技能组合，尽管如果您使用 Python 或 Ruby 工作，您可能会找到一种方法来利用您专注于细节和故障排除的能力。Web 编程本质上是将一堆不同的系统和协议连接在一起，我认为嵌入式可能会这样做，但在一个更加受限的环境中，选择更少，恶作剧的统治也有限。

通常，基于厨房水槽语言（PHP、Java、C#）的 Web 编程似乎可以解决问题，因此您最好找到一种方法来利用您所获得的技能，使用一种基于性能而不是铃声的语言和口哨。不过，Java 和 C# 的职位比 Python 多得多，所以请谨慎挑选（痛苦的）毒药。

如果您希望进入启动/中低端领域，PHP 是不错的选择，而 Java/C# 会更好，但情况通常大不相同（企业/商业环境是什么）。

您可能会考虑获得 Java 或 C# 认证（PHP 证书是个笑话）。他们不会让你找到工作，但由于你已经知识渊博，只是不在你想要改进的领域，证书课程将帮助你转换你的工具集和术语，并解释目的。一些雇主也很在意。

[Java认证（太阳学校）](http://www.sun.com/training/certification/java/index.xml)

[C# 认证](http://www.microsoft.com/learning/mcp/default.mspx)

对于一些有趣的和类似 Python/Ruby 的东西，可以考虑使用 Groovy，一种基于 Java 的解释语言。

[http://groovy.codehaus.org/](http://groovy.codehaus.org/)

如果您要进入 Java，这是一个很好的资源列表：

[基本 Java 资源](http://www.ibm.com/developerworks/java/library/j-javaresources.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-04T05:14:27.113

一个好的下一步可能是走 iPhone 开发者路线，因为您很可能有处理客户好奇心（内存泄漏、cpu 受限等）的经验。iPhone/iPod Touch 还受益于拥有相当强大的基于 webkit 的浏览器，该浏览器可以运行您可以编写的大多数 AJAX，并且可以与服务器端组件交互。

为了保持便宜，您可以在 EC2 服务器或其他可以充当应用程序服务器端部分的 VPS 上运行 java 堆栈。

开发者许可证的投资为 99 美元，开发人员的廉价 VPS 每月需要 5 美元，但如果风向正确，并且在您启动应用程序时有满月，回报可能会很高。

（哦，便宜的令人上瘾的游戏可以从长尾带来可观的收入，但谁知道这会持续多久，因为像 EA 这样的主要玩家在 iPhone 上推出了严肃的游戏）

# mysql - 在一台机器上运行多个 MySQL 服务器

> ID：716542
> 
> 赞同：18
> 
> 时间：2009-04-04T05:13:12.623
> 
> 标签：mysql

我们可以在一台机器上运行多个 MySQL 服务器吗？

谢谢。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-04T05:16:38.263

是的，您只需要在不同的端口上运行它们并将它们指向不同的 lib 目录以获取它们的数据。

这是一个很好的参考：[http ://dev.mysql.com/doc/refman/5.1/en/mutiple-servers.html](http://dev.mysql.com/doc/refman/5.1/en/multiple-servers.html)

（如果你想用它来测试，我建议检查[MySQL Sandbox](https://github.com/datacharmer/mysql-sandbox)，它现在被[dbdeployer](https://github.com/datacharmer/dbdeployer)取代）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2017-09-18T19:24:35.177

有多种方法可以在同一台机器上运行多个 mysql 实例（在不同的端口上）。在这里，我使用了相同的二进制文件并使用了单独的配置文件（具有单独的端口、pid、套接字和数据目录）。我们需要为我们的 datadir 和 log 文件夹（如果使用）创建新目录。我们还需要为这些文件夹分配适当的权限：

```
# mkdir /var/lib/mysql2
  # chown -R mysql.mysql /var/lib/mysql2/
  # mkdir /var/log/mysql2
  # chown -R mysql.mysql /var/log/mysql2 
```

接下来，我们需要一个与默认 mysql 配置文件相同的单独配置文件。因此，首先复制现有的并更改所需的值。

```
 # cp /etc/my.cnf /etc/my2.cnf 
```

（或为您的配置文件在不同的位置适当更改路径）。

接下来，我们需要编辑我们的新配置文件，使用不同的mysql端口（默认为3306）、pid和socket而不是默认的，并将数据和日志文件夹指向之前创建的文件夹。

```
# cd /etc
  # sed -i ‘s/3306/3307/g’ my2.cnf
  # sed -i ‘s/mysqld.sock/mysqld2.sock/g’ my2.cnf
  # sed -i ‘s/mysqld.pid/mysqld2.pid/g’ my2.cnf
  # sed -i ‘s/var\/lib\/mysql/var\/lib\/mysql2/g’ my2.cnf
  # sed -i ‘s/var\/log\/mysql/var\/log\/mysql2/g’ my2.cnf 
```

最后我们需要初始化默认的dbs：

```
# mysql_install_db –user=mysql –datadir=/var/lib/mysql2/ 
```

最后，我们可以使用以下命令启动新的 mysql 实例：

```
# mysqld_safe – -defaults-file=/etc/my2.cnf & 
```

我们可以使用以下方法连接到我们的新实例：

```
# mysql -S /var/run/mysqld/mysqld2.sock 
```

或者

```
# mysql -h 127.0.0.1 -P 3307 
```

如果我们不再需要它，请停止它：

```
# mysqladmin -S /var/run/mysqld/mysqld2.sock shutdown 
```

参考网站：[https ://linuxinpakistan.com/start-multiple-instances-mysql-machine](https://linuxinpakistan.com/start-multiple-instances-mysql-machine)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2020-07-18T09:18:44.440

我的步骤`Windows 10`：

1.  复制`C:\ProgramData\MySQL\MySQL Server 8.0\my.ini`到`C:\ProgramData\MySQL\MySQL Server 8.0\my1.ini`
2.  打开`my1.ini`并修改：
    *   端口=3307（在客户端和服务器部分）
    *   datadir=C:/ProgramData/MySQL/MySQL 服务器 8.0/Data1
    *   报告端口=3307
3.  复制`C:\ProgramData\MySQL\MySQL Server 8.0\Data`到`C:\ProgramData\MySQL\MySQL Server 8.0\Data1`
4.  在`cmd`提示符下运行：（必要时使用管理员权限）
    `C:\Program Files\MySQL\MySQL Server 8.0\bin>mysqld --install MySQL80-1 --defaults-file="C:\ProgramData\MySQL\MySQL Server 8.0\my1.ini"`

如果一切顺利，您将看到：
`Service successfully installed.`

5.  `Win+R`
    键入`services.msc`，找到服务名称`MySQL80-1`，右键单击它并单击`Start`。

如果一切顺利，您将看到`Status`更改为`Running`.
如果不顺利，请打开`xxx.err`找到的文件`C:\ProgramData\MySQL\MySQL Server 8.0\Data1`以检查原因。

如果您不再需要该*服务*：

*   停下来
*   使用where is your service name根据`cmd`提示删除它。`sc delete MySQL80-1``MySQL80-1`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-01-05T11:49:36.060

对于 Windows，如果 mysql 服务器的版本不同，则使用 MYSQL Installer 下载并安装不同版本的 MYSQL 服务器。

[![MYSQL 安装程序窗口](https://i.stack.imgur.com/wU5a2.png)](https://i.stack.imgur.com/wU5a2.png)

为每个 MYSQL 服务器选择**重新配置并以不同的方式配置 PORT。**通过单击下一步完成配置步骤，直到完成

[![端口配置窗口](https://i.stack.imgur.com/C9Rfq.png)](https://i.stack.imgur.com/C9Rfq.png)

# ruby - SAP 新的 Ruby 实现对 Ruby 程序员有什么意义？

> ID：716543
> 
> 赞同：8
> 
> 时间：2009-04-04T05:13:36.553
> 
> 标签：ruby, compilation, jruby, implementation

SAP 发布了[Blue Ruby](https://www.sdn.sap.com/irj/scn/wiki?path=/display/Research/BlueRuby)，这是在 ABAP 虚拟机中运行的 Ruby 版本。

这似乎增加了 Ruby 语言的可信度，但是除了 SAP 开发人员之外，这对 Ruby 社区的其他人是否适用？

我只是想知道这可能还有什么其他意义。Ruby 开发人员可能会获得额外的工作机会来从事 SAP 项目的工作？

Ruby 程序员还有其他潜在的好处吗？

另外，我还不清楚：除了 MRI 和 JRuby，还有多少不同的实现，为什么我作为 Ruby 程序员需要除 MRI 之外的任何实现？我知道如果我想与 Java 库集成，我可能需要 JRuby。除了 MRI 或 JRuby 之外，我是否还需要研究其他实现？

我注意到 Blue Ruby 已编译。这是一个很大的好处吗？这会是 Ruby 的第一个编译版本吗？

抱歉 - 可能有太多问题，但这是一个大问题，但我不确定为什么/如果真的是这样。如果能从比我更了解 Ruby（和 IT）的人那里得到一些反馈，我将不胜感激。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-04T06:23:17.277

实际上有相当多的替代实现。有这么多版本的部分原因是虽然 Ruby 本身有很多粉丝，但 MRI 通常被认为不如它所承载的语言那么好。

这是我知道的所有其他 Ruby 实现的列表：

*   核磁共振

*   用于 Java 的 JRuby。Ruby 1.9 发布后，它的速度优势不再那么大，但它仍然是与 Java 集成的重要参与者。

*   .NET 的 IronRuby（仍在开发中）

*   MacRuby 用于制作本机 Mac OS X 应用程序。它目前基于 Ruby 1.9，但他们将为下一个版本发布一个新的基于 LLVM 的虚拟机，它看起来提供了一个主要的速度提升，并有望移植到其他 LLVM 目标平台。

*   MagLev（仍在开发中）用于大容量 Web 应用程序。它可能会成为商业产品。

*   Rubinius 是一种全新的重新实现，旨在替代 MRI，具有更清洁的基础。

我怀疑 Blue Ruby 是否会对一般软件开发领域产生很大影响。由于 Ruby 比 ABAP 更受欢迎，这对 SAP 程序员来说可能是件好事，并允许他们为潜在的员工投下更大的网。

当前所有的 Ruby 实现都被编译为字节码。与 SAP 的说法相反，从 Ruby 1.9 开始，MRI 本身包括一个字节码编译器，尽管在合并 YARV 虚拟机的过程中，将编译后的字节码保存到磁盘的能力消失了。JRuby 被编译成 Java .class 文件。我没有太多关于 MagLev 的细节，但可以肯定地说它也会走这条路。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-04T05:44:45.357

每个实现都有自己的用例。JRuby 之所以有用，原因与 Jython 的原因大致相同。当 IronRuby 处于可用状态时，它在 .NET 环境中将很有用。

这样的事情使 Ruby 在企业级上更容易被接受，并加速了良好编程语言的传播。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-07T18:53:17.343

当然，Blue Ruby 是为 SAP 相关人员准备的。我认为这不会对 Ruby 社区产生更大的影响，因为大多数 Ruby 开发人员与 ABAP 开发无关。

Blue Ruby 的主要目的是将强大的脚本语言带入 ABAP 世界，为 ABAP 开发人员提供更多工具。

你可以阅读我关于 Blue Ruby 的博客，它提供了一个 SE16（数据表浏览器）模拟器。

[https://weblogs.sdn.sap.com/pub/wlg/14222](https://weblogs.sdn.sap.com/pub/wlg/14222)

问候，

阿尔瓦罗“布拉格”特哈达加林多。

高级 ABAP 顾问 - SAP 导师。

# events - YUI：在页面加载后在某些事件队列的顶部添加事件？

> ID：716546
> 
> 赞同：0
> 
> 时间：2009-04-04T05:15:59.840
> 
> 标签：events, yui

如何在页面加载后将新事件放在链接到对象的所有附加事件的顶部？

实际上，我有一个使用一些 YUI 函数来激活其行为的手风琴，现在在不修改 YUI 主函数的情况下，我需要一些用于调用 AJAX 例程的新函数。目前我正在尝试使用 Event.getListeners，但我不知道如何处理返回的对象。

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-07T18:07:27.463

您从 Event.getListeners 获得的响应是​​传递给 Event.addListener 的所有参数。根据[Event.getListeners](http://developer.yahoo.com/yui/docs/YAHOO.util.Event.html#method_getListeners)的文档，它返回

> ```
> the listener. Contains the following fields:   
>     type: (string) the type of event   
>     fn: (function) the callback supplied to addListener   
>     obj: (object) the custom object supplied to addListener   
>     adjust: (boolean|object) whether or not to adjust the default context   
>     scope: (boolean) the derived context based on the adjust parameter 
>     index: (int) its position in the Event util listener cache 
> ```

因此，使用该对象，您可能只需使用 Event.removeListener 删除侦听器，然后使用[Event.addListener](http://developer.yahoo.com/yui/docs/YAHOO.util.Event.html#method_removeListener)按照您想要的顺序重新添加它们。对象的属性与 Event.addListener 的参数 1:1 映射，因此不会丢失任何内容。

# sql - “政党模式”背后的原则和好处是什么？

> ID：716549
> 
> 赞同：36
> 
> 时间：2009-04-04T05:17:14.440
> 
> 标签：sql, database-design, orm, data-modeling

“党模型”是关系数据库设计的“模式”。至少其中一部分涉及找到许多实体之间的共性，例如客户、员工、合作伙伴等，并将其分解到一些更“抽象”的数据库表中。

我想了解您对以下方面的想法：

1.  党的模式背后的核心原则和动力是什么？
2.  它规定你对数据模型做什么？（我上面的那一点水平很高，在某些方面很可能不正确。我一直在使用它的项目中，但我正在与一个专注于其他问题的单独团队合作）。
3.  你的经历让你有什么感受？你用过吗，如果用过，你会再用吗？有什么好处和坏处？
4.  派对模型是否限制了您对 ORM 的选择？例如，您是否必须消除某些 ORM，因为它们不允许在您的域对象和您的物理数据模型之间有足够的“抽象层”？

我确信每一个回复都不会解决这些问题中的每一个……但任何涉及其中一个或多个问题的事情都会帮助我做出我面临的一些决定。

谢谢。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-04-04T06:15:52.677

> 1.  党的模式背后的核心原则和动力是什么？

就我使用它而言，它主要是关于代码重用和灵活性。我们之前在来宾/用户/管理员模型中使用过它，当您需要将用户从一个组移动到另一个组时，它确实证明了它的价值。将此扩展到让组织和公司代表其下的用户，它实际上提供了一种抽象形式，这种抽象形式在 SQL 中并不是特别固有的。

> 2.  它规定你对数据模型做什么？（我上面的那一点水平很高，在某些方面很可能不正确。我一直在使用它的项目中，但我正在与一个专注于其他问题的单独团队合作）。

您在上面的部分中是非常正确的，尽管它需要更多细节。您可以想象这样一种情况，数据库中的一个实体（称为一方）外包给另一方，而另一方可能反过来分包工作。一方可能是雇员、承包商或公司，是一方的所有子类。据我了解，您将有一个 Party 表，然后是每个子类的更具体的表，然后可以进一步细分（Party -> Person -> Contractor）。

> 3.  你的经历让你有什么感受？你用过吗，如果用过，你会再用吗？有什么好处和坏处？

如果您需要灵活地向系统添加新类型并在您一开始没有预料到的类型和架构之间创建关系（用户移动到一个新的水平，公司雇用其他公司等），它有它的好处。它还为您提供了运行单个查询并为多种类型的各方（公司、员工、承包商）检索数据的好处。另一方面，您正在添加额外的抽象层以获取您实际需要的数据，并且在查询特定类型时增加了数据库上的负载（或至少连接数）。如果您的抽象太过分，您可能需要运行多个查询来检索数据，因为复杂性将开始对可读性和数据库负载有害。

> 4.  派对模型是否限制了您对 ORM 的选择？例如，您是否必须消除某些 ORM，因为它们不允许在您的域对象和您的物理数据模型之间有足够的“抽象层”？

这是一个我承认有点薄弱的领域，但我发现在应用程序层中使用视图和镜像抽象并没有造成太大的问题。当我想直接读取数据源时，对我来说真正的问题一直是“数据 X 在哪里”（对于系统上的新开发人员来说，这也不总是直观的）。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-09-27T19:20:49.843

参与方模型（又名实体模式）背后的想法是定义一个利用无模式数据库的一些可扩展性优势的数据库。参与方模型通过将其实体定义为参与方类型记录来做到这一点，而不是每个实体一个表。结果是一个非常规范化的数据库，只有很少的表，而且对它存储的数据的语义含义知之甚少。所有这些知识都被推送到代码中的数据访问中。使用派对模型的数据库升级很少甚至没有，因为模式永远不会改变。它本质上是一个美化的键值对数据模型结构，带有一些花哨的名称和一些额外的属性。

优点：

*   踢屁股的水平可扩展性。一旦在实体模型中定义了 5-6 个表，您就可以去海滩喝玛格丽塔酒。您可以以最小的努力虚拟地尽可能多地扩展此数据库。
*   数据库支持你扔给它的任何数据结构。您还可以在不影响您的应用程序的情况下即时更改数据结构和方/实体定义。这是非常非常强大的。
*   您可以通过添加记录而不更改架构来对任意数据实体进行建模。这意味着您可以告别架构迁移脚本。
*   这是程序员的天堂，因为他们编写的代码将定义他们在代码中使用的实际实体，并且没有从对象到表的映射或类似的东西。您可以将 Party 表视为您选择的框架的基础对象（System.Object for .NET）

缺点：

*   Party/Entity 模型永远无法与 ORM 很好地配合，因此请忘记使用 EF 或 NHibernate 从实体数据库中获取语义上有意义的实体。
*   很多加盟。性能调优挑战。这个“骗局”与您用来定义实体的实践相关，但可以肯定地说，您将执行更多那些会让您在晚上做噩梦的令人费解的查询。
*   更难消费。不熟悉您的业务的开发人员和数据库专业人员将很难适应这些模型所暴露的实体。由于一切都是抽象的，因此您无法在数据库之上构建图表或可视化来向其他人解释存储的内容。
*   Heavy data access models or business rules engines will be needed. Basically you have to do the work of understanding what the heck you want out of your database at some point, and your database model is not going to help you this time around.

If you are considering a party or entity schema in a relational database, you should probably take a look at other solutions like a NoSql data store, BigTable or KV Stores. There are some great products out there with massive deployments and traction such as MongoDB, DynamoDB, and Cassandra that pioneered this movement.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-08T23:56:28.597

当我在 1980 年代初参与实施这些想法的团队时，它并没有限制我们对 ORM 的选择，因为它们还没有被发明出来。

我随时都会依赖这些想法，因为那个特定项目是我见过的关于“革命性”想法（当时肯定是）最令人信服的概念证明之一。

它迫使你一事无成。它不会阻止你做任何事情（我的意思是任何错误）。定义您自己的信息模型的人就是您自己。

各方都有很多共同点。他们有一个名字等等的事实（我们称之为“signaletics”）。他们具有称为“地址”的主要/主要位置的事实。在某种意义上，他们都参与了业务合同的事实。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-04T10:31:42.393

这是一个很大的话题，我推荐阅读Len Silverston 和 Paul Agnew[的 The Data Model Resource Book Volume 3 - Universal Patterns for Data Modeling](https://rads.stackoverflow.com/amzn/click/com/0470178450)。

我刚收到我的副本，它非常好 - 它为您提供了许多数据建模方法的概览，包括混合上下文角色模式等。它对每种方法都有详细的优点和缺点。

有很多方法可以对政党关系和角色进行建模，所有这些都具有其优点和缺点。被接受为答案的问题仅涵盖“政党模式”的一个实例。

例如，在许多方法中，“员工”、“项目经理”等概念是一方可以在特定上下文中扮演的**角色。**回到家后，我会尽力为您提供更好的细分。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-09-25T06:13:46.877

根据我的理解，作为一个简单的谈话：Party 建模提供了灵活性并且需要更多的努力（如 T-sql join 和......）来实现。
我还想指出，“使用派对建模（序列化/泛化）使您能够拥有与其他表的**FK-Relation ”。**例如：考虑将不同类型的用户（管理员、用户、...）概括为`User`表格，您可以`UserID`在`Authorization`表格中拥有。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-04-04T19:07:41.167

我不确定，但派对模式听起来像是泛化-专业化模式的一个特例。搜索“泛化专业化关系建模”发现一些有趣的文章。

# c# - 你能创建一个简单的'EqualityComparer ' 使用 lambda 表达式

> ID：716552
> 
> 赞同：49
> 
> 时间：2009-04-04T05:21:31.543
> 
> 标签：c#, linq, distinct

**简短的问题：**

LINQ to objects 中是否有一种简单的方法可以根据对象的键属性从列表中获取不同的对象列表。

**长问题：**

我正在尝试对具有键作为其属性之一的**对象**[`Distinct()`](http://www.hookedonlinq.com/DistinctOperator.ashx)列表进行操作。

 **```
class GalleryImage {
   public int Key { get;set; }
   public string Caption { get;set; }
   public string Filename { get; set; }
   public string[] Tags {g et; set; }
} 
```

我有一个`Gallery`包含`GalleryImage[]`.

由于网络服务的工作方式[原文如此]，我有该 `GalleryImage`对象的副本。我认为使用它`Distinct()`来获得一个不同的列表是一件简单的事情。

这是我要使用的 LINQ 查询：

```
var allImages = Galleries.SelectMany(x => x.Images);
var distinctImages = allImages.Distinct<GalleryImage>(new 
                     EqualityComparer<GalleryImage>((a, b) => a.id == b.id)); 
```

问题是这`EqualityComparer`是一个抽象类。

我不想：

*   实现 IEquatable on`GalleryImage`因为它是生成的
*   必须编写一个单独的类来实现`IEqualityComparer`，如下[所示](http://www.hookedonlinq.com/DistinctOperator.ashx)

`EqualityComparer`我缺少某个地方的具体实现吗？

我原以为会有一种简单的方法可以根据键从集合中获取“不同”的对象。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-04-04T06:38:51.670

（这里有两种解决方案 - 第二种解决方案见末尾）：

我的[MiscUtil](http://pobox.com/~skeet/csharp/miscutil)库有一个`ProjectionEqualityComparer`类（和两个使用类型推断的支持类）。

这是一个使用它的例子：

```
EqualityComparer<GalleryImage> comparer = 
    ProjectionEqualityComparer<GalleryImage>.Create(x => x.id); 
```

这是代码（已删除评论）

```
// Helper class for construction
public static class ProjectionEqualityComparer
{
    public static ProjectionEqualityComparer<TSource, TKey>
        Create<TSource, TKey>(Func<TSource, TKey> projection)
    {
        return new ProjectionEqualityComparer<TSource, TKey>(projection);
    }

    public static ProjectionEqualityComparer<TSource, TKey>
        Create<TSource, TKey> (TSource ignored,
                               Func<TSource, TKey> projection)
    {
        return new ProjectionEqualityComparer<TSource, TKey>(projection);
    }
}

public static class ProjectionEqualityComparer<TSource>
{
    public static ProjectionEqualityComparer<TSource, TKey>
        Create<TKey>(Func<TSource, TKey> projection)
    {
        return new ProjectionEqualityComparer<TSource, TKey>(projection);
    }
}

public class ProjectionEqualityComparer<TSource, TKey>
    : IEqualityComparer<TSource>
{
    readonly Func<TSource, TKey> projection;
    readonly IEqualityComparer<TKey> comparer;

    public ProjectionEqualityComparer(Func<TSource, TKey> projection)
        : this(projection, null)
    {
    }

    public ProjectionEqualityComparer(
        Func<TSource, TKey> projection,
        IEqualityComparer<TKey> comparer)
    {
        projection.ThrowIfNull("projection");
        this.comparer = comparer ?? EqualityComparer<TKey>.Default;
        this.projection = projection;
    }

    public bool Equals(TSource x, TSource y)
    {
        if (x == null && y == null)
        {
            return true;
        }
        if (x == null || y == null)
        {
            return false;
        }
        return comparer.Equals(projection(x), projection(y));
    }

    public int GetHashCode(TSource obj)
    {
        if (obj == null)
        {
            throw new ArgumentNullException("obj");
        }
        return comparer.GetHashCode(projection(obj));
    }
} 
```

**第二种解决方案**

要为 Distinct 执行此操作，您可以使用[MoreLINQ](http://code.google.com/p/morelinq/)[`DistinctBy`](http://code.google.com/p/morelinq/source/browse/trunk/MoreLinq/DistinctBy.cs)中的扩展：

```
 public static IEnumerable<TSource> DistinctBy<TSource, TKey>
        (this IEnumerable<TSource> source,
         Func<TSource, TKey> keySelector)
    {
        return source.DistinctBy(keySelector, null);
    }

    public static IEnumerable<TSource> DistinctBy<TSource, TKey>
        (this IEnumerable<TSource> source,
         Func<TSource, TKey> keySelector,
         IEqualityComparer<TKey> comparer)
    {
        source.ThrowIfNull("source");
        keySelector.ThrowIfNull("keySelector");
        return DistinctByImpl(source, keySelector, comparer);
    }

    private static IEnumerable<TSource> DistinctByImpl<TSource, TKey>
        (IEnumerable<TSource> source,
         Func<TSource, TKey> keySelector,
         IEqualityComparer<TKey> comparer)
    {
        HashSet<TKey> knownKeys = new HashSet<TKey>(comparer);
        foreach (TSource element in source)
        {
            if (knownKeys.Add(keySelector(element)))
            {
                yield return element;
            }
        }
    } 
```

在这两种情况下，`ThrowIfNull`看起来像这样：

```
public static void ThrowIfNull<T>(this T data, string name) where T : class
{
    if (data == null)
    {
        throw new ArgumentNullException(name);
    }
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-04T05:53:20.170

基于 Charlie Flowers 的回答，您可以创建自己的扩展方法来做您想做的事情，在内部使用分组：

```
 public static IEnumerable<T> Distinct<T, U>(
        this IEnumerable<T> seq, Func<T, U> getKey)
    {
        return
            from item in seq
            group item by getKey(item) into gp
            select gp.First();
    } 
```

您还可以创建一个从 EqualityComparer 派生的泛型类，但听起来您想避免这种情况：

```
 public class KeyEqualityComparer<T,U> : IEqualityComparer<T>
    {
        private Func<T,U> GetKey { get; set; }

        public KeyEqualityComparer(Func<T,U> getKey) {
            GetKey = getKey;
        }

        public bool Equals(T x, T y)
        {
            return GetKey(x).Equals(GetKey(y));
        }

        public int GetHashCode(T obj)
        {
            return GetKey(obj).GetHashCode();
        }
    } 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-04T05:36:43.393

对于手头的问题，这是我能想到的最好的方法。仍然很好奇是否有一种很好的方式来创建`EqualityComparer`动态。

```
Galleries.SelectMany(x => x.Images).ToLookup(x => x.id).Select(x => x.First()); 
```

创建查找表并从每个表中获取“顶部”

注意：这与@charlie 建议的相同，但使用的是 ILookup - 我认为无论如何都是一个组必须的。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-04T05:46:59.377

扔掉的`IEqualityComparer`泛型类呢？

```
public class ThrowAwayEqualityComparer<T> : IEqualityComparer<T>
{
  Func<T, T, bool> comparer;

  public ThrowAwayEqualityComparer(Func<T, T, bool> comparer)   
  {
    this.comparer = comparer;
  }

  public bool Equals(T a, T b)
  {
    return comparer(a, b);
  }

  public int GetHashCode(T a)
  {
    return a.GetHashCode();
  }
} 
```

所以现在您可以使用`Distinct`自定义比较器。

```
var distinctImages = allImages.Distinct(
   new ThrowAwayEqualityComparer<GalleryImage>((a, b) => a.Key == b.Key)); 
```

您可能可以摆脱`<GalleryImage>`，但我不确定编译器是否可以推断类型（现在无法访问它。）

并且在一个额外的扩展方法中：

```
public static class IEnumerableExtensions
{
  public static IEnumerable<TValue> Distinct<TValue>(this IEnumerable<TValue> @this, Func<TValue, TValue, bool> comparer)
  {
    return @this.Distinct(new ThrowAwayEqualityComparer<TValue>(comparer);
  }

  private class ThrowAwayEqualityComparer...
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-04T05:29:44.270

您可以按键值分组，然后从每个组中选择顶部的项目。这对你有用吗？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-04T06:35:49.477

这是一篇有趣的文章，为此目的扩展了 LINQ... [http://www.singingeels.com/Articles/Extending_LINQ__Specifying_a_Property_in_the_Distinct_Function.aspx](http://www.singingeels.com/Articles/Extending_LINQ__Specifying_a_Property_in_the_Distinct_Function.aspx)

默认 Distinct 根据其哈希码比较对象 - 为了轻松使您的对象与 Distinct 一起使用，您可以覆盖 GetHashcode 方法.. 但您提到您正在从 Web 服务检索您的对象，因此您可能无法做到这一点在这种情况下。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-02-20T02:43:37.503

[这里](https://github.com/dotnet/corefx/issues/25928)正在讨论这个想法，虽然我希望 .NET Core 团队采用一种方法`IEqualityComparer<T>`从 lambda 生成 s，但我建议您对该想法进行投票和评论，并使用以下内容：

用法：

```
IEqualityComparer<Contact> comp1 = EqualityComparerImpl<Contact>.Create(c => c.Name);
var comp2 = EqualityComparerImpl<Contact>.Create(c => c.Name, c => c.Age);

class Contact { public Name { get; set; } public Age { get; set; } } 
```

代码：

```
public class EqualityComparerImpl<T> : IEqualityComparer<T>
{
  public static EqualityComparerImpl<T> Create(
    params Expression<Func<T, object>>[] properties) =>
    new EqualityComparerImpl<T>(properties);

  PropertyInfo[] _properties;
  EqualityComparerImpl(Expression<Func<T, object>>[] properties)
  {
    if (properties == null)
      throw new ArgumentNullException(nameof(properties));

    if (properties.Length == 0)
      throw new ArgumentOutOfRangeException(nameof(properties));

    var length = properties.Length;
    var extractions = new PropertyInfo[length];
    for (int i = 0; i < length; i++)
    {
      var property = properties[i];
      extractions[i] = ExtractProperty(property);
    }
    _properties = extractions;
  }

  public bool Equals(T x, T y)
  {
    if (ReferenceEquals(x, y))
      //covers both are null
      return true;
    if (x == null || y == null)
      return false;
    var len = _properties.Length;
    for (int i = 0; i < _properties.Length; i++)
    {
      var property = _properties[i];
      if (!Equals(property.GetValue(x), property.GetValue(y)))
        return false;
    }
    return true;
  }

  public int GetHashCode(T obj)
  {
    if (obj == null)
      return 0;

    var hashes = _properties
        .Select(pi => pi.GetValue(obj)?.GetHashCode() ?? 0).ToArray();
    return Combine(hashes);
  }

  static int Combine(int[] hashes)
  {
    int result = 0;
    foreach (var hash in hashes)
    {
      uint rol5 = ((uint)result << 5) | ((uint)result >> 27);
      result = ((int)rol5 + result) ^ hash;
    }
    return result;
  }

  static PropertyInfo ExtractProperty(Expression<Func<T, object>> property)
  {
    if (property.NodeType != ExpressionType.Lambda)
      throwEx();

    var body = property.Body;
    if (body.NodeType == ExpressionType.Convert)
      if (body is UnaryExpression unary)
        body = unary.Operand;
      else
        throwEx();

    if (!(body is MemberExpression member))
      throwEx();

    if (!(member.Member is PropertyInfo pi))
      throwEx();

    return pi;

    void throwEx() =>
      throw new NotSupportedException($"The expression '{property}' isn't supported.");
  }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-04T14:40:40.887

> 在 GalleryImage 上实现 IEquatable，因为它是生成的

一种不同的方法是将 GalleryImage 生成为部分类，然后拥有另一个具有继承和 IEquatable、Equals、GetHash 实现的文件。

# firefox - Firefox 如何知道该页面是 Atom 提要？

> ID：716557
> 
> 赞同：2
> 
> 时间：2009-04-04T05:23:50.727
> 
> 标签：firefox, atom-feed

我正在创建一个网站，但无法让 Firefox 在我打开它时询问我在哪里添加提要。我使用该标签添加了 RSS 图标，它指向一个页面，该页面根据 W3C 验证器提供了有效的 Atom 提要。

当内容类型为“ `text/html`”时，我得到连接的 XML 标记的内容。当我提供“ `application/atom+xml`”时，Firefox 会询问我是否要将文件保存到我的桌面。Safari 识别了该提要并采取了适当的行动。

提要中是否有另一个标题或标签告诉 Firefox 像提要一样行事？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-04T05:51:37.320

这个页面的提要是一个 Atom 提要，Firefox 将其识别为 Atom 提要。也许您应该将内容类型标头设置为“application/xhtml+xml”，这就是 stackoverflow 正在做的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-04T05:55:03.367

好吧，您的提要只需要符合 Atom 规范。如果它符合 Firefox 将显示它。您是否输入了正确的标题和命名空间？

```
<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"> 
```

如果您这样做，我认为您不必担心更改标题。我过去使用过 RSS（不是 Atom）提要，只要提要的格式正确，就不必更改标题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T05:52:53.230

Firefox 应该从服务器的 "Content-Type: application/atom+xml; charset=UTF-8" http 标头中获取。什么 http headers firefox 你可以用这个插件检查：http: [//livehttpheaders.mozdev.org/](http://livehttpheaders.mozdev.org/)

# algorithm - 在面板上放置随机不重叠的矩形

> ID：716558
> 
> 赞同：15
> 
> 时间：2009-04-04T05:24:40.660
> 
> 标签：algorithm, random, 2d, puzzle

我有一个 X x Y 大小的面板。我想在这个面板上放置最多 N 个随机大小的矩形，但我不希望它们中的任何一个重叠。我需要知道这些矩形的 X、Y 位置。

算法，有人吗？

**编辑**：所有 N 个矩形一开始都是已知的，可以按任何顺序选择。这会改变程序吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-04T05:36:45.470

您可以通过一组“自由”矩形对此进行建模，从坐标为 0,0、大小 (x, y) 的单个矩形开始。每次您需要再添加一个矩形时，选择剩余的“空闲”矩形之一，生成新矩形（具有左上角的坐标和大小，以便完全包含），然后拆分该矩形以及任何其他重叠的“ free”矩形，这样孩子们就可以表达剩余的可用空间。这将产生 0 到 4 个新矩形（如果新矩形正好是旧的空闲矩形的大小，则为 0；如果它在中间，则为 4，依此类推）。随着时间的推移，您将获得越来越小的空闲区域，因此您创建的矩形也会越来越小。

好的，不是很详细的解释，在白板上显示更容易。但是该模型是我用来寻找新剪切粘贴的 gui 组件的起始位置的模型；跟踪可用的屏幕块很容易，并选择（例如）左侧或最上方的此类区域。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-04T05:40:24.227

这是一篇关于 2d 打包算法的不错的文章：http: [//www.devx.com/dotnet/Article/36005](http://www.devx.com/dotnet/Article/36005)

您通常需要某种使用启发式的算法来获得不错的结果。一个简单（但非最佳）的解决方案将是首次拟合算法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-04T15:21:26.000

我在我的一个应用程序中使用了这个[Rectangle Packing 算法](https://web.archive.org/web/20090611075719/http://www.nuclex.org/pages/framework/rectangle-packing)，以 C# 源文件的形式提供。

该算法使用面板的大小进行初始化，然后遍历所有矩形并获取它们的位置。矩形的顺序可能会影响结果，具体取决于打包程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-03-08T07:00:30.137

我建议你使用 StaxMans 的建议。

这是我的2c：

随机添加一大堆矩形（相互重叠）。删除重叠的矩形：

```
for rectangle in list of rectangles:
    if rectangle not deleted:
        delete all rectangles touching rectangle. 
```

要查找接触特定矩形的所有矩形，您可以使用四叉树或基于 x1,y1 x2,y2 值的不等式。

编辑：事实上，大多数游戏引擎（如 pygame 等）都包含矩形碰撞检测，这是一个常见问题。

* * *

## 回答 #5

> 赞同：-6
> 
> 时间：2009-04-04T05:56:32.050

或者维护一个已经添加的矩形列表，并创建一个算法，根据该列表确定新矩形的放置位置。您可以创建一个基本的 Rectangle 类来保存有关您的矩形的信息。

创建自定义算法不应该那么难。

# iphone - iPhone音频流 - 保存状态？

> ID：716559
> 
> 赞同：1
> 
> 时间：2009-04-04T05:25:32.687
> 
> 标签：iphone, audio-streaming

如何保存我的应用程序当前正在流式传输的音频文件的当前状态。我想在用户离开它的同一个地方开始播放歌曲（就像潘多拉在听歌时所做的那样）

现在我正在播放数据包号。从数据包编号中，我得到字节编号并将其发送到 Range 标头字段中。但这不起作用，并从头开始返回整首歌曲。

我正在使用 AudioFileStream 和 CFHTTPStream 流式传输音频。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T03:16:27.750

我们就是这样做的（尽管我们使用 NSURLConnection）。听起来您的服务器不尊重范围标头。从那里开始调试——问题是您的服务器不支持范围标头或您的客户端未正确发送它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-05T00:25:39.513

这在很大程度上取决于流媒体服务器的功能。大多数常见的流媒体服务器不支持范围 - 例如 Shoutcast 或 Icecast。

# asp.net - asp.net 会话管理

> ID：716563
> 
> 赞同：1
> 
> 时间：2009-04-04T05:33:17.693
> 
> 标签：asp.net

我正在使用存储在 asp.net 的 stateserver 中的 sessionstate。我在标题上有一个链接，显示用户登录 ID。

问题：

当 stateserver 中的 session 过期时，我的应用程序仍然显示 loginid，并且在遇到取决于 session 中存储的值的代码时会引发错误。

看起来 asp.net 不知道状态服务器上的会话何时过期，并继续使用保存在用户浏览器的 cookie 中的值处理同一会话。

为了在另一个应用程序中解决这个问题，我正在检查每个请求的会话，如果它在会话状态中过期，则使用户的会话过期。

我不确定我在这里做对了。asp.net 不是假设将保存在 cookie 中的会话数据与 stateserver 中的会话同步吗？

您能否解释一下处理此问题的最佳做法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-04T05:38:56.057

正确的做法是在每次收到回发时“找到”用户的会话。然后当场，如果你找不到它，报告一个错误，他们的会话已过期，他们需要重新登录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-04T05:51:25.590

如果您使用的是 ASP.Net Webforms，则可以考虑页面或控件的 Load 事件来检查会话是否已过期。这是相关代码

```
if(Session["yourvar"] == null)
  ShowError(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-05T08:19:25.477

感谢所有的答案，

默认情况下，我的表单身份验证会话超时值高于会话状态。这使得 sessionstate 上的会话过期并导致问题。我认为保持表单身份验证值略低于 sessionstate 将是最佳实践。

# c# - 无法在 .net 3.5 中保存应用程序设置

> ID：716564
> 
> 赞同：1
> 
> 时间：2009-04-04T05:33:38.127
> 
> 标签：c#, application-settings

我正在创建一个应用程序，它使用用户范围在应用程序设置中存储基本数据库连接信息，如主机、用户、密码和默认数据库名称。

我在 Visual Studio 2008 中使用 .net 3.5

我在用户控件中放置了 4 个文本框，并将它们的文本属性绑定到应用程序设置的各个属性。

```
// 
        // textBox_database
        // 
        this.textBox_database.Location = new System.Drawing.Point(103, 101);
        this.textBox_database.Margin = new System.Windows.Forms.Padding(3, 4, 3, 4);
        this.textBox_database.Name = "textBox_database";
        this.textBox_database.Size = new System.Drawing.Size(255, 27);
        this.textBox_database.TabIndex = 5;
        this.textBox_database.Text = global::PHP_Code_Generator_2.Properties.Settings.Default.mysql_database;
        // 
        // textBox_password
        // 
        this.textBox_password.Location = new System.Drawing.Point(103, 69);
        this.textBox_password.Margin = new System.Windows.Forms.Padding(3, 4, 3, 4);
        this.textBox_password.Name = "textBox_password";
        this.textBox_password.Size = new System.Drawing.Size(255, 27);
        this.textBox_password.TabIndex = 4;
        this.textBox_password.Text = global::PHP_Code_Generator_2.Properties.Settings.Default.mysql_password;
        this.textBox_password.UseSystemPasswordChar = true;
        // 
        // textBox_user
        // 
        this.textBox_user.Location = new System.Drawing.Point(103, 37);
        this.textBox_user.Margin = new System.Windows.Forms.Padding(3, 4, 3, 4);
        this.textBox_user.Name = "textBox_user";
        this.textBox_user.Size = new System.Drawing.Size(255, 27);
        this.textBox_user.TabIndex = 7;
        this.textBox_user.Text = global::PHP_Code_Generator_2.Properties.Settings.Default.mysql_user;
        // 
        // textBox_server
        // 
        this.textBox_server.Location = new System.Drawing.Point(103, 5);
        this.textBox_server.Margin = new System.Windows.Forms.Padding(3, 4, 3, 4);
        this.textBox_server.Name = "textBox_server";
        this.textBox_server.Size = new System.Drawing.Size(255, 27);
        this.textBox_server.TabIndex = 6;
        this.textBox_server.Text = global::PHP_Code_Generator_2.Properties.Settings.Default.mysql_server; 
```

这些文本框将从用户那里获取用户数据以设置自己的数据库信息。我有一个按钮，可以将修改后的信息保存回设置文件

```
private void button_save_Click(object sender, EventArgs e)
{
   Properties.Settings.Default.Save();
} 
```

但设计并没有被保存。有什么帮助吗？

问候，安詹

**致西里尔：是的，我有代码在属性中分配修改后的值，但后来甚至将范围设置为“用户”，它说只读。所以我删除了属性分配代码。现在我把代码带回来并重新启动 VS，它现在完美运行：D 傻我，我应该尝试过这个旧程序。谢谢西里尔。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-04T05:49:17.297

嗯...我记得几个月前在我的一个项目中遇到了同样的问题。不幸的是，我不记得我是如何解决它的。

一些检查...

1.  尝试在项目属性中将属性范围设置为用户。
2.  在您列出的代码中，我看不到您设置属性的位置（只看到您检索属性）。你在哪里设置的？

# vbscript - VBS 计算机信息脚本

> ID：716571
> 
> 赞同：0
> 
> 时间：2009-04-04T05:43:44.673
> 
> 标签：vbscript, wmi

有人可以帮我修改吗？

不是在开始时出现询问计算机 ID/名称的对话框，而是自动输入，所以它是自动的？最后，不要打开文件，只是将其存储在硬盘上（与脚本相同的目录）

```
On Error Resume Next
Const HKEY_CURRENT_USER = &H80000001
Const HKEY_LOCAL_MACHINE = &H80000002

Dim strComputer, objWMIService, propValue, objItem
Dim strUserName, strPassword, colItems, SWBemlocator

' This section queries for the workstation to be scanned.
strComputer = inputbox ("Workstation", "Enter the workstation ID to scan.",".")
UserName = ""
Password = ""
ImgDir = "C:\Scripts\images\"

'Sets up the connections and objects to be used throughout the script.
Set SWBemlocator = CreateObject("WbemScripting.SWbemLocator")
Set objWMIService = SWBemlocator.ConnectServer(strComputer,"root\CIMV2",strUserName,strPassword)

'This determines the current date and time of the PC being scanned.
Set colItems = objWMIService.ExecQuery("SELECT * FROM Win32_LocalTime", "WQL", wbemFlagReturnImmediately + wbemFlagForwardOnly)
For Each objItem in colItems
    If objItem.Minute < 10 Then
        theMinutes = "0" & objItem.Minute
    Else
        theMinutes = objItem.Minute
    End If
    If objItem.Second < 10 Then
        theSeconds = "0" & objItem.Second
    Else
        theSeconds = objItem.Second
    End If
    DateTime = objItem.Month & "/" & objItem.Day & "/" & objItem.Year & " - " & objItem.Hour & ":" & theMinutes & ":" & theSeconds
Next

'Gets some information about the operating system including service pack level.
Set colItems = objWMIService.ExecQuery("Select * from Win32_OperatingSystem",,48)
For Each objItem in colItems
    WKID = objItem.CSName
    WKOS = objItem.Caption
    ServicePack = objItem.ServicePackMajorVersion & "." & objItem.ServicePackMinorVersion
Next

'This section returns the Video card and current resolution.
Set colItems = objWMIService.ExecQuery("Select * from Win32_DisplayConfiguration",,48)
For Each objItem in colItems
    VideoCard = objItem.DeviceName
    Resolution = objItem.PelsWidth & " x " & objItem.PelsHeight & " x " & objItem.BitsPerPel & " bits"
Next

'This section returns the Video card memory.
Set objWMIService = GetObject("winmgmts:\\" & strComputer & "\root\cimv2")
Set colItems = objWMIService.ExecQuery ("Select * from Win32_VideoController")
For Each objItem in colItems
    VideoMemory = objItem.AdapterRAM/1024/1024
Next

'This returns various system information including current logged on user, domain, memory, manufacture and model.
Set colItems = objWMIService.ExecQuery("Select * from Win32_ComputerSystem",,48)
For Each objItem in colItems
    UserName = objItem.UserName
    Domain = objItem.Domain
    TotalMemory = int((objItem.TotalPhysicalMemory/1024)/1024+1)
    Manufacturer = objItem.Manufacturer
    Model = objItem.Model
Next

'This determines the total hard drive space and free hard drive space.
Set colItems = objWMIService.ExecQuery("Select * from Win32_LogicalDisk Where Name='C:'",,48)
For Each objItem in colItems
    FreeHDSpace = Fix(((objItem.FreeSpace/1024)/1024)/1024)
    TotalHDSpace = Fix(((objItem.Size/1024)/1024)/1024)
Next

'This section returns the default printer and printer port.
Set colItems = objWMIService.ExecQuery("SELECT * FROM Win32_Printer where Default=True", "WQL", wbemFlagReturnImmediately + wbemFlagForwardOnly)
For Each objItem in colItems
    Printer = objItem.Name
    PortName = objItem.PortName
Next

'This returns the CPU information.
Set colItems = objWMIService.ExecQuery("SELECT * FROM Win32_Processor", "WQL", wbemFlagReturnImmediately + wbemFlagForwardOnly)
For Each objItem in colItems
    CPUDesc = LTrim(objItem.Name)
Next

'This returns the current uptime (time since last reboot) of the system.
Set colOperatingSystems = objWMIService.ExecQuery ("Select * from Win32_OperatingSystem")
For Each objOS in colOperatingSystems
    dtmBootup = objOS.LastBootUpTime
    dtmLastBootupTime = WMIDateStringToDate(dtmBootup)
    dtmSystemUptime = DateDiff("h", dtmLastBootUpTime, Now)
    Uptime = dtmSystemUptime
Next
Function WMIDateStringToDate(dtmBootup)
    WMIDateStringToDate = CDate(Mid(dtmBootup, 5, 2) & "/" & Mid(dtmBootup, 7, 2) & "/" & Left(dtmBootup, 4) & " " & Mid (dtmBootup, 9, 2) & ":" & Mid(dtmBootup, 11, 2) & ":" & Mid(dtmBootup,13, 2))
End Function

'This sets up the Internet Explorer window in order to show the results.
Set objExplorer = WScript.CreateObject("InternetExplorer.Application", "IE_")
With objExplorer
    .Navigate "about:Blank"
    .Toolbar = 0
    .StatusBar = 0
    .Width = 800
    .Height = 600
    .Left = 75
    .Top = 0
    .Visible = 1
End With
Set fileOutput = objExplorer.Document

'This is the code for the web page to be displayed.
fileOutput.Open
fileOutput.WriteLn "<html>"
fileOutput.WriteLn "    <head>"
fileOutput.WriteLn "        <title>System Information for '" & WKID & "' </title>"
fileOutput.WriteLn "    </head>"
fileOutput.WriteLn "    <body bgcolor='#FFFFFF' text='#000000' link='#0000FF' vlink='000099' alink='#00FF00'>"
fileOutput.WriteLn "        <center>"
fileOutput.WriteLn "            <h3>Workstaion/Server Information for " & WKID & "</h3>"
fileOutput.WriteLn "            <table border='0' cellspacing='1' cellpadding='1' width='95%'>"
fileOutput.WriteLn "                <tr><td background='" & ImgDir & "blue_spacer.gif'>"
fileOutput.WriteLn "                    <table border='0' cellspacing='0' cellpadding='0' width='100%'>"
fileOutput.WriteLn "                        <tr><td>"
fileOutput.WriteLn "                            <table border='0' cellspacing='0' cellpadding='0' width='100%'>"
fileOutput.WriteLn "                                <tr>"
fileOutput.WriteLn "                                    <td width='5%' align='left' valign='middle' background='" & ImgDir & "blue_spacer.gif'><img src='" & ImgDir & "write.gif'></td>"
fileOutput.WriteLn "                                    <td width='95%' align='left' valign='middle' background='" & ImgDir & "blue_spacer.gif'> <font color='#FFFFFF' size='5'>WKInfo - </font><font color='#FFFFFF' size='3'>General information on the Workstation.</font></td>"
fileOutput.WriteLn "                                </tr>"
fileOutput.WriteLn "                                <tr><td colspan='2' bgcolor='#FFFFFF'>"
fileOutput.WriteLn "                                    <TABLE width='100%' cellspacing='0' cellpadding='2' border='1' bordercolor='#c0c0c0' bordercolordark='#ffffff' bordercolorlight='#c0c0c0'>"
fileOutput.WriteLn "                                        <TR><TD align='center' bgcolor='#d0d0d0' colspan='2'><b><i>Last Scanned</i></b></TD></TR>"
fileOutput.WriteLn "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Date/Time</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & DateTime & "</i></td></tr>"
fileOutput.WriteLn "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>System Uptime</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & Uptime & " hours</i></td></tr>"
fileOutput.WriteLn "                                        <TR><TD align='center' bgcolor='#d0d0d0' colspan='2'><b><i>General Information</i></b></TD></TR>"
fileOutput.WriteLn "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Workstation ID</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & WKID & "</i></td></tr>"
fileOutput.WriteLn "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Domain</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & Domain & "</i></td></tr>"
fileOutput.WriteLn "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>UserName</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & UserName & "</i></td></tr>"
fileOutput.WriteLn "                                        <TR><TD align='center' bgcolor='#d0d0d0' colspan='2'><b><i>General OS Information</i></b></TD></TR>"
fileOutput.WriteLn "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Operating System</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & WKOS & "</i></td></tr>"
fileOutput.WriteLn "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Service Pack</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & ServicePack & "</i></td></tr>"
fileOutput.WriteLn "                                        <TR><TD align='center' bgcolor='#d0d0d0' colspan='2'><b><i>General Computer Information</i></b></TD></TR>"
fileOutput.WriteLn "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Manufacturer</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & Manufacturer & "</i></td></tr>"
fileOutput.WriteLn "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Model</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & Model & "</i></td></tr>"
fileOutput.WriteLn "                                        <TR><TD align='center' bgcolor='#d0d0d0' colspan='2'><b><i>General Hardware Information</i></b></TD></TR>"
fileOutput.WriteLn "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>CPU</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & CPUDesc & "</i></td></tr>"
fileOutput.WriteLn "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Memory</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & TotalMemory & " MB</i></td></tr>"
fileOutput.WriteLn "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Total HD Space</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & TotalHDSpace & " GB</i></td></tr>"
fileOutput.WriteLn "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Free HD Space</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & FreeHDSpace & " GB</i></td></tr>"
fileOutput.WriteLn "                                        <TR><TD align='center' bgcolor='#d0d0d0' colspan='2'><b><i>General Video Card Information</i></b></TD></TR>"
fileOutput.WriteLn "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Video Card</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & VideoCard & "</i></td></tr>"
fileOutput.WriteLn "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Resolution</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & Resolution & "</i></td></tr>"
fileOutput.WriteLn "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Memory</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & VideoMemory & " MB</i></td></tr>"
fileOutput.WriteLn "                                        <TR><TD align='center' bgcolor='#d0d0d0' colspan='2'><b><i>Default Printer Information</i></b></TD></TR>"
fileOutput.WriteLn "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Printer</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & Printer & "</i></td></tr>"
fileOutput.WriteLn "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Port Name</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & PortName & "</i></td></tr>"
fileOutput.WriteLn "                                        <TR><TD align='center' bgcolor='#d0d0d0' colspan='2'><b><i>Shared Directories</i></b></TD></TR>"
'This sextion lists all the current shares enabled on the PC.
fileOutput.WriteLn "                                        <tr><td colspan='2' bgcolor='#f0f0f0'>"
fileOutput.WriteLn "                                            <TABLE width='100%' cellspacing='0' cellpadding='2' border='1' bordercolor='#c0c0c0' bordercolordark='#ffffff' bordercolorlight='#c0c0c0'>"
fileOutput.WriteLn "                                                <TR><TD width='30%' align='center' bgcolor='#e0e0e0'><b>Name</b></td><TD width='40%' align='center' bgcolor='#e0e0e0'><b>Path</b><TD width='40%' align='center' bgcolor='#e0e0e0'><b>Description</b></td><tr>"
Set colShares = objWMIService.ExecQuery("Select * from Win32_Share")
For each objShare in colShares
    fileOutput.WriteLn "                                                <TR><TD width='30%' align='left' bgcolor='#f0f0f0'><i>" & objShare.Name & "</i></TD><td bgcolor=#f0f0f0 align=left><i>" & objShare.Path & "</i></TD><td bgcolor=#f0f0f0 align=left><i>" & objShare.Caption & "</i></td></tr>"
Next
fileOutput.WriteLn "                                            </table>"
fileOutput.WriteLn "                                        </td></tr>"
'This section lists all the current services and their status.
fileOutput.WriteLn "                                        <TR><TD align='center' bgcolor='#d0d0d0' colspan='2'><b><i>Current Service Information</i></b></TD></TR>"
fileOutput.WriteLn "                                        <tr><td colspan='2' bgcolor='#f0f0f0'>"
fileOutput.WriteLn "                                            <TABLE width='100%' cellspacing='0' cellpadding='2' border='1' bordercolor='#c0c0c0' bordercolordark='#ffffff' bordercolorlight='#c0c0c0'>"
fileOutput.WriteLn "                                                <TR><TD width='70%' align='center' bgcolor='#e0e0e0'><b>Service Name</b></td><TD width='30%' align='center' bgcolor='#e0e0e0'><b>Service State</b></td><tr>"
Set colRunningServices = objWMIService.ExecQuery("Select * from Win32_Service")
For Each objService in colRunningServices
fileOutput.WriteLn "                                            <TR><TD align='left' bgcolor='#f0f0f0'>" & objService.DisplayName & "</TD><td bgcolor=#f0f0f0 align=center><i>" & objService.State & "</i></td></tr>"
Next
fileOutput.WriteLn "                                            </table>"
fileOutput.WriteLn "                                        </td></tr>"
'This section lists all the current running processes and some information.
fileOutput.WriteLn "                                        <TR><TD align='center' bgcolor='#d0d0d0' colspan='2'><b><i>Current Process Information</i></b></TD></TR>"
fileOutput.WriteLn "                                        <tr><td colspan='2' bgcolor='#f0f0f0'>"
fileOutput.WriteLn "                                            <TABLE width='100%' cellspacing='0' cellpadding='2' border='1' bordercolor='#c0c0c0' bordercolordark='#ffffff' bordercolorlight='#c0c0c0'>"
fileOutput.WriteLn "                                                <TR><TD width='10%' align='center' bgcolor='#e0e0e0'><b>PID</b></td><TD width='35%' align='center' bgcolor='#e0e0e0'><b>Process Name</b></td><TD width='40%' align='center' bgcolor='#e0e0e0'><b>Owner</b></td><TD width='15%' align='center' bgcolor='#e0e0e0'><b>Memory</b></td></tr>"
Set colProcessList = objWMIService.ExecQuery("Select * from Win32_Process")
For Each objProcess in colProcessList
colProperties = objProcess.GetOwner(strNameOfUser,strUserDomain)
fileOutput.WriteLn "                                                <TR><TD align='center' bgcolor='#f0f0f0'>" & objProcess.Handle & "</td><TD align='center' bgcolor='#f0f0f0'>" & objProcess.Name & "</td><TD align='center' bgcolor='#f0f0f0'>" & strUserDomain & "\" & strNameOfUser & "</td><TD align='center' bgcolor='#f0f0f0'>" & objProcess.WorkingSetSize/1024 & " kb</td><tr>"
Next
fileOutput.WriteLn "                                            </table>"
fileOutput.WriteLn "                                        </td></tr>"
'This section lists all the currently installed software on the machine.
fileOutput.WriteLn "                                        <TR><TD align='center' bgcolor='#d0d0d0' colspan='2'><b><i>Installed Software</i></b></TD></TR>"
fileOutput.WriteLn "                                        <tr><td colspan='2' bgcolor='#f0f0f0'>"
Set colSoftware = objWMIService.ExecQuery ("Select * from Win32_Product")
For Each objSoftware in colSoftware
    fileOutput.WriteLn"                                            <TABLE width='100%' cellspacing='0' cellpadding='2' border='1' bordercolor='#c0c0c0' bordercolordark='#ffffff' bordercolorlight='#c0c0c0'>"
    fileOutput.WriteLn"                                                <tr><td align=left bgcolor='#e0e0e0'><b>Caption:</b></td><td colspan=2 bgcolor=#f0f0f0>" & objSoftware.Caption & "</td></tr>"
    fileOutput.WriteLn"                                                <tr><td align=left bgcolor='#e0e0e0'><b>Install Location:</b></td><td colspan=2 bgcolor=#f0f0f0>" & objSoftware.InstallLocation & "</td></tr>"
    fileOutput.WriteLn"                                                <tr><td width=30% align=center bgcolor='#e0e0e0'><b>Name</b></td><td width=30% align=center bgcolor='#e0e0e0'><b>Vendor</b></td><td width=30% align=center bgcolor='#e0e0e0'><b>Version</b></td></tr>"
    fileOutput.WriteLn"                                                <tr><td align=center bgcolor=#f0f0f0>" & objSoftware.Name & "</td><td align=center bgcolor=#f0f0f0>" & objSoftware.Vendor & "</td><td align=center bgcolor=#f0f0f0>" & objSoftware.Version & "</td></tr>"
    fileOutput.WriteLn"                                                <tr height=2><td height=10 align=center bgcolor=midnightblue colspan=3></td></tr>"
    fileOutput.WriteLn"                                            </table>"
Next
fileOutput.WriteLn "                                        </td></tr>"
fileOutput.WriteLn "                                    </table>"
fileOutput.WriteLn "                                </td></tr>"
fileOutput.WriteLn "                            </table>"
fileOutput.WriteLn "                        </td></tr>"
fileOutput.WriteLn "                    </table>"
fileOutput.WriteLn "                </td></tr>"
fileOutput.WriteLn "            </table>"
fileOutput.WriteLn "            <p><small></small></p>"
fileOutput.WriteLn "        </center>"
fileOutput.WriteLn "    </body>"
fileOutput.WriteLn "<html>"
fileOutput.close
WScript.Quit 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T16:01:44.110

这是您的代码稍作修改的版本。它将要查询的工作站名称以及两个可选参数（用户名和密码）作为命令行参数。我没有将结果输出到 IE 窗口，而是稍作更改，使用 File System 对象将您的 html 代码输出到名为：workstation.html 的文件，其中工作站是在传递给脚本时被扫描的实际工作站名称.

我添加的代码部分位于两个位置，在顶部和 IE 窗口部分之前的右侧，我在两个位置都放置了 ' ************* 注释，以便您可以快速发现它们。我留下了您的 fileoutput var，但将其从 fileOutput.writeln 修改为 fileOutput.writeline。

有关[**FileSystemObject 的更多详细信息，请查看此处的 MSDN 文章。**](http://msdn.microsoft.com/en-us/library/z9ty6h50(VS.85).aspx)

有关[**cscript.exe 命令行选项的详细信息，请查看此 MSDN 文章。**](http://msdn.microsoft.com/en-us/library/0fs17b0s(VS.85).aspx)

这是一个 MS TechNet 页面，其中包含有关[**在 VBS 中使用命令行参数的详细信息。**](http://www.microsoft.com/technet/scriptcenter/guide/sas_wsh_ywsa.mspx?mfr=true)

```
On Error Resume Next
Const HKEY_CURRENT_USER = &H80000001
Const HKEY_LOCAL_MACHINE = &H80000002

Dim strComputer, objWMIService, propValue, objItem
Dim strUserName, strPassword, colItems, SWBemlocator

ImgDir = "C:\Scripts\images\"

' *******************************************************************
' This section gets workstation name, username and password from the command prompt.
Set objArgs = WScript.Arguments

If objArgs.Count = 1 then
    strComputer = objArgs(0)
    UserName = ""
    Password = ""
ElseIf objArgs.Count = 3 then
    strComputer = objArgs(0)
    UserName = objArgs(1)
    Password = objArgs(2)
Else
    wscript.echo "SYNTAX:  cscript scan.vbs [machinename] [username] [password]"
    wscript.echo "Parameter: Machinename - required"
    wscript.echo "Parameter: username - optional"
    wscript.echo "Parameter: password- required if username provided."
    wscript.quit
End If
' *******************************************************************

'Sets up the connections and opjects to be used throughout the script.
Set SWBemlocator = CreateObject("WbemScripting.SWbemLocator")
Set objWMIService = SWBemlocator.ConnectServer(strComputer,"root\CIMV2",strUserName,strPassword)

'This determines the current date and time of the PC being scanned.
Set colItems = objWMIService.ExecQuery("SELECT * FROM Win32_LocalTime", "WQL", wbemFlagReturnImmediately + wbemFlagForwardOnly)
For Each objItem in colItems
    If objItem.Minute < 10 Then
        theMinutes = "0" & objItem.Minute
    Else
        theMinutes = objItem.Minute
    End If
    If objItem.Second < 10 Then
        theSeconds = "0" & objItem.Second
    Else
        theSeconds = objItem.Second
    End If
    DateTime = objItem.Month & "/" & objItem.Day & "/" & objItem.Year & " - " & objItem.Hour & ":" & theMinutes & ":" & theSeconds
Next

'Gets some ingomation about the Operating System including Service Pack level.
Set colItems = objWMIService.ExecQuery("Select * from Win32_OperatingSystem",,48)
For Each objItem in colItems
    WKID = objItem.CSName
    WKOS = objItem.Caption
    ServicePack = objItem.ServicePackMajorVersion & "." & objItem.ServicePackMinorVersion
Next

'This section returns the Video card and current resolution.
Set colItems = objWMIService.ExecQuery("Select * from Win32_DisplayConfiguration",,48)
For Each objItem in colItems
    VideoCard = objItem.DeviceName
    Resolution = objItem.PelsWidth & " x " & objItem.PelsHeight & " x " & objItem.BitsPerPel & " bits"
Next

'This section returns the Video card memory.
Set objWMIService = GetObject("winmgmts:\\" & strComputer & "\root\cimv2")
Set colItems = objWMIService.ExecQuery ("Select * from Win32_VideoController")
For Each objItem in colItems
    VideoMemory = objItem.AdapterRAM/1024/1024
Next

'This returns various system information including current logged on user, domain, memory, manufacture and model.
Set colItems = objWMIService.ExecQuery("Select * from Win32_ComputerSystem",,48)
For Each objItem in colItems
    UserName = objItem.UserName
    Domain = objItem.Domain
    TotalMemory = int((objItem.TotalPhysicalMemory/1024)/1024+1)
    Manufacturer = objItem.Manufacturer
    Model = objItem.Model
Next

'This determines the total hard drive space and free hard drive space.
Set colItems = objWMIService.ExecQuery("Select * from Win32_LogicalDisk Where Name='C:'",,48)
For Each objItem in colItems
    FreeHDSpace = Fix(((objItem.FreeSpace/1024)/1024)/1024)
    TotalHDSpace = Fix(((objItem.Size/1024)/1024)/1024)
Next

'This section returns the default printer and printer port.
Set colItems = objWMIService.ExecQuery("SELECT * FROM Win32_Printer where Default=True", "WQL", wbemFlagReturnImmediately + wbemFlagForwardOnly)
For Each objItem in colItems
    Printer = objItem.Name
    PortName = objItem.PortName
Next

'This returns the CPU information.
Set colItems = objWMIService.ExecQuery("SELECT * FROM Win32_Processor", "WQL", wbemFlagReturnImmediately + wbemFlagForwardOnly)
For Each objItem in colItems
    CPUDesc = LTrim(objItem.Name)
Next

'This returns the current uptime (time since last reboot) of the system.
Set colOperatingSystems = objWMIService.ExecQuery ("Select * from Win32_OperatingSystem")
For Each objOS in colOperatingSystems
    dtmBootup = objOS.LastBootUpTime
    dtmLastBootupTime = WMIDateStringToDate(dtmBootup)
    dtmSystemUptime = DateDiff("h", dtmLastBootUpTime, Now)
    Uptime = dtmSystemUptime
Next
Function WMIDateStringToDate(dtmBootup)
    WMIDateStringToDate = CDate(Mid(dtmBootup, 5, 2) & "/" & Mid(dtmBootup, 7, 2) & "/" & Left(dtmBootup, 4) & " " & Mid (dtmBootup, 9, 2) & ":" & Mid(dtmBootup, 11, 2) & ":" & Mid(dtmBootup,13, 2))
End Function

' *******************************************************************
Const TristateFalse = 0
Const ForReading = 1
Const ForWriting = 2
Const ForAppending = 8

Set objFSO = CreateObject("Scripting.FileSystemObject")
Set fileOutput = objFSO.OpenTextFile("c:\scan_results\" & strComputer & ".html", ForWriting, True, TristateFalse)
' *******************************************************************

'This is the code for the web page to be displayed.
fileOutput.writeline "<html>"
fileOutput.writeline "    <head>"
fileOutput.writeline "        <title>System Information for '" & WKID & "' </title>"
fileOutput.writeline "    </head>"
fileOutput.writeline "    <body bgcolor='#FFFFFF' text='#000000' link='#0000FF' vlink='000099' alink='#00FF00'>"
fileOutput.writeline "        <center>"
fileOutput.writeline "            <h3>Workstaion/Server Information for " & WKID & "</h3>"
fileOutput.writeline "            <table border='0' cellspacing='1' cellpadding='1' width='95%'>"
fileOutput.writeline "                <tr><td background='" & ImgDir & "blue_spacer.gif'>"
fileOutput.writeline "                    <table border='0' cellspacing='0' cellpadding='0' width='100%'>"
fileOutput.writeline "                        <tr><td>"
fileOutput.writeline "                            <table border='0' cellspacing='0' cellpadding='0' width='100%'>"
fileOutput.writeline "                                <tr>"
fileOutput.writeline "                                    <td width='5%' align='left' valign='middle' background='" & ImgDir & "blue_spacer.gif'><img src='" & ImgDir & "write.gif'></td>"
fileOutput.writeline "                                    <td width='95%' align='left' valign='middle' background='" & ImgDir & "blue_spacer.gif'> <font color='#FFFFFF' size='5'>WKInfo - </font><font color='#FFFFFF' size='3'>General information on the Workstation.</font></td>"
fileOutput.writeline "                                </tr>"
fileOutput.writeline "                                <tr><td colspan='2' bgcolor='#FFFFFF'>"
fileOutput.writeline "                                    <TABLE width='100%' cellspacing='0' cellpadding='2' border='1' bordercolor='#c0c0c0' bordercolordark='#ffffff' bordercolorlight='#c0c0c0'>"
fileOutput.writeline "                                        <TR><TD align='center' bgcolor='#d0d0d0' colspan='2'><b><i>Last Scanned</i></b></TD></TR>"
fileOutput.writeline "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Date/Time</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & DateTime & "</i></td></tr>"
fileOutput.writeline "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>System Uptime</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & Uptime & " hours</i></td></tr>"
fileOutput.writeline "                                        <TR><TD align='center' bgcolor='#d0d0d0' colspan='2'><b><i>General Information</i></b></TD></TR>"
fileOutput.writeline "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Workstation ID</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & WKID & "</i></td></tr>"
fileOutput.writeline "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Domain</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & Domain & "</i></td></tr>"
fileOutput.writeline "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>UserName</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & UserName & "</i></td></tr>"
fileOutput.writeline "                                        <TR><TD align='center' bgcolor='#d0d0d0' colspan='2'><b><i>General OS Information</i></b></TD></TR>"
fileOutput.writeline "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Operating System</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & WKOS & "</i></td></tr>"
fileOutput.writeline "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Service Pack</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & ServicePack & "</i></td></tr>"
fileOutput.writeline "                                        <TR><TD align='center' bgcolor='#d0d0d0' colspan='2'><b><i>General Computer Information</i></b></TD></TR>"
fileOutput.writeline "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Manufacturer</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & Manufacturer & "</i></td></tr>"
fileOutput.writeline "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Model</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & Model & "</i></td></tr>"
fileOutput.writeline "                                        <TR><TD align='center' bgcolor='#d0d0d0' colspan='2'><b><i>General Hardware Information</i></b></TD></TR>"
fileOutput.writeline "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>CPU</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & CPUDesc & "</i></td></tr>"
fileOutput.writeline "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Memory</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & TotalMemory & " MB</i></td></tr>"
fileOutput.writeline "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Total HD Space</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & TotalHDSpace & " GB</i></td></tr>"
fileOutput.writeline "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Free HD Space</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & FreeHDSpace & " GB</i></td></tr>"
fileOutput.writeline "                                        <TR><TD align='center' bgcolor='#d0d0d0' colspan='2'><b><i>General Video Card Information</i></b></TD></TR>"
fileOutput.writeline "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Video Card</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & VideoCard & "</i></td></tr>"
fileOutput.writeline "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Resolution</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & Resolution & "</i></td></tr>"
fileOutput.writeline "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Memory</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & VideoMemory & " MB</i></td></tr>"
fileOutput.writeline "                                        <TR><TD align='center' bgcolor='#d0d0d0' colspan='2'><b><i>Default Printer Information</i></b></TD></TR>"
fileOutput.writeline "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Printer</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & Printer & "</i></td></tr>"
fileOutput.writeline "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Port Name</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & PortName & "</i></td></tr>"
fileOutput.writeline "                                        <TR><TD align='center' bgcolor='#d0d0d0' colspan='2'><b><i>Shared Directories</i></b></TD></TR>"
'This sextion lists all the current shares enabled on the PC.
fileOutput.writeline "                                        <tr><td colspan='2' bgcolor='#f0f0f0'>"
fileOutput.writeline "                                            <TABLE width='100%' cellspacing='0' cellpadding='2' border='1' bordercolor='#c0c0c0' bordercolordark='#ffffff' bordercolorlight='#c0c0c0'>"
fileOutput.writeline "                                                <TR><TD width='30%' align='center' bgcolor='#e0e0e0'><b>Name</b></td><TD width='40%' align='center' bgcolor='#e0e0e0'><b>Path</b><TD width='40%' align='center' bgcolor='#e0e0e0'><b>Description</b></td><tr>"
Set colShares = objWMIService.ExecQuery("Select * from Win32_Share")
For each objShare in colShares
    fileOutput.writeline "                                                <TR><TD width='30%' align='left' bgcolor='#f0f0f0'><i>" & objShare.Name & "</i></TD><td bgcolor=#f0f0f0 align=left><i>" & objShare.Path & "</i></TD><td bgcolor=#f0f0f0 align=left><i>" & objShare.Caption & "</i></td></tr>"
Next
fileOutput.writeline "                                            </table>"
fileOutput.writeline "                                        </td></tr>"
'This section lists all the current services and their status.
fileOutput.writeline "                                        <TR><TD align='center' bgcolor='#d0d0d0' colspan='2'><b><i>Current Service Information</i></b></TD></TR>"
fileOutput.writeline "                                        <tr><td colspan='2' bgcolor='#f0f0f0'>"
fileOutput.writeline "                                            <TABLE width='100%' cellspacing='0' cellpadding='2' border='1' bordercolor='#c0c0c0' bordercolordark='#ffffff' bordercolorlight='#c0c0c0'>"
fileOutput.writeline "                                                <TR><TD width='70%' align='center' bgcolor='#e0e0e0'><b>Service Name</b></td><TD width='30%' align='center' bgcolor='#e0e0e0'><b>Service State</b></td><tr>"
Set colRunningServices = objWMIService.ExecQuery("Select * from Win32_Service")
For Each objService in colRunningServices
fileOutput.writeline "                                            <TR><TD align='left' bgcolor='#f0f0f0'>" & objService.DisplayName & "</TD><td bgcolor=#f0f0f0 align=center><i>" & objService.State & "</i></td></tr>"
Next
fileOutput.writeline "                                            </table>"
fileOutput.writeline "                                        </td></tr>"
'This section lists all the current running processes and some information.
fileOutput.writeline "                                        <TR><TD align='center' bgcolor='#d0d0d0' colspan='2'><b><i>Current Process Information</i></b></TD></TR>"
fileOutput.writeline "                                        <tr><td colspan='2' bgcolor='#f0f0f0'>"
fileOutput.writeline "                                            <TABLE width='100%' cellspacing='0' cellpadding='2' border='1' bordercolor='#c0c0c0' bordercolordark='#ffffff' bordercolorlight='#c0c0c0'>"
fileOutput.writeline "                                                <TR><TD width='10%' align='center' bgcolor='#e0e0e0'><b>PID</b></td><TD width='35%' align='center' bgcolor='#e0e0e0'><b>Process Name</b></td><TD width='40%' align='center' bgcolor='#e0e0e0'><b>Owner</b></td><TD width='15%' align='center' bgcolor='#e0e0e0'><b>Memory</b></td></tr>"
Set colProcessList = objWMIService.ExecQuery("Select * from Win32_Process")
For Each objProcess in colProcessList
colProperties = objProcess.GetOwner(strNameOfUser,strUserDomain)
fileOutput.writeline "                                                <TR><TD align='center' bgcolor='#f0f0f0'>" & objProcess.Handle & "</td><TD align='center' bgcolor='#f0f0f0'>" & objProcess.Name & "</td><TD align='center' bgcolor='#f0f0f0'>" & strUserDomain & "\" & strNameOfUser & "</td><TD align='center' bgcolor='#f0f0f0'>" & objProcess.WorkingSetSize/1024 & " kb</td><tr>"
Next
fileOutput.writeline "                                            </table>"
fileOutput.writeline "                                        </td></tr>"

'This section lists all the currently installed software on the machine.
fileOutput.writeline "                                        <TR><TD align='center' bgcolor='#d0d0d0' colspan='2'><b><i>Installed Software</i></b></TD></TR>"
fileOutput.writeline "                                        <tr><td colspan='2' bgcolor='#f0f0f0'>"
Set colSoftware = objWMIService.ExecQuery ("Select * from Win32_Product")
For Each objSoftware in colSoftware
    fileOutput.writeline"                                            <TABLE width='100%' cellspacing='0' cellpadding='2' border='1' bordercolor='#c0c0c0' bordercolordark='#ffffff' bordercolorlight='#c0c0c0'>"
    fileOutput.writeline"                                                <tr><td align=left bgcolor='#e0e0e0'><b>Caption:</b></td><td colspan=2 bgcolor=#f0f0f0>" & objSoftware.Caption & "</td></tr>"
    fileOutput.writeline"                                                <tr><td align=left bgcolor='#e0e0e0'><b>Install Location:</b></td><td colspan=2 bgcolor=#f0f0f0>" & objSoftware.InstallLocation & "</td></tr>"
    fileOutput.writeline"                                                <tr><td width=30% align=center bgcolor='#e0e0e0'><b>Name</b></td><td width=30% align=center bgcolor='#e0e0e0'><b>Vendor</b></td><td width=30% align=center bgcolor='#e0e0e0'><b>Version</b></td></tr>"
    fileOutput.writeline"                                                <tr><td align=center bgcolor=#f0f0f0>" & objSoftware.Name & "</td><td align=center bgcolor=#f0f0f0>" & objSoftware.Vendor & "</td><td align=center bgcolor=#f0f0f0>" & objSoftware.Version & "</td></tr>"
    fileOutput.writeline"                                                <tr height=2><td height=10 align=center bgcolor=midnightblue colspan=3></td></tr>"
    fileOutput.writeline"                                            </table>"
Next

fileOutput.writeline "                                        </td></tr>"
fileOutput.writeline "                                    </table>"
fileOutput.writeline "                                </td></tr>"
fileOutput.writeline "                            </table>"
fileOutput.writeline "                        </td></tr>"
fileOutput.writeline "                    </table>"
fileOutput.writeline "                </td></tr>"
fileOutput.writeline "            </table>"
fileOutput.writeline "            <p><small></small></p>"
fileOutput.writeline "        </center>"
fileOutput.writeline "    </body>"
fileOutput.writeline "<html>"
fileOutput.close 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-04T08:23:46.130

这是一个完整的文件，它写入当前文件夹中的 x.html：

```
Const HKEY_CURRENT_USER = &H80000001
Const HKEY_LOCAL_MACHINE = &H80000002

Dim strComputer, objWMIService, propValue, objItem
Dim strUserName, strPassword, colItems, SWBemlocator

' This section queries for the workstation to be scanned.
UserName = ""
Password = ""
strComputer = "127.1.1.1"
ImgDir = "C:\Scripts\images\"

'Sets up the connections and opjects to be used throughout the script.
Set SWBemlocator = CreateObject("WbemScripting.SWbemLocator")
Set objWMIService = SWBemlocator.ConnectServer(,"root\CIMV2",strUserName,strPassword)

'This determines the current date and time of the PC being scanned.
Set colItems = objWMIService.ExecQuery("SELECT * FROM Win32_LocalTime", "WQL", wbemFlagReturnImmediately + wbemFlagForwardOnly)
For Each objItem in colItems
    If objItem.Minute < 10 Then
        theMinutes = "0" & objItem.Minute
    Else
        theMinutes = objItem.Minute
    End If
    If objItem.Second < 10 Then
        theSeconds = "0" & objItem.Second
    Else
        theSeconds = objItem.Second
    End If
    DateTime = objItem.Month & "/" & objItem.Day & "/" & objItem.Year & " - " & objItem.Hour & ":" & theMinutes & ":" & theSeconds
Next

'Gets some ingomation about the Operating System including Service Pack level.
Set colItems = objWMIService.ExecQuery("Select * from Win32_OperatingSystem",,48)
For Each objItem in colItems
    WKID = objItem.CSName
    WKOS = objItem.Caption
    ServicePack = objItem.ServicePackMajorVersion & "." & objItem.ServicePackMinorVersion
Next

'This section returns the Video card and current resolution.
Set colItems = objWMIService.ExecQuery("Select * from Win32_DisplayConfiguration",,48)
For Each objItem in colItems
    VideoCard = objItem.DeviceName
    Resolution = objItem.PelsWidth & " x " & objItem.PelsHeight & " x " & objItem.BitsPerPel & " bits"
Next

'This section returns the Video card memory.
Set objWMIService = GetObject("winmgmts:root\cimv2")
Set colItems = objWMIService.ExecQuery ("Select * from Win32_VideoController")
For Each objItem in colItems
    VideoMemory = objItem.AdapterRAM/1024/1024
Next

'This returns various system information including current logged on user, domain, memory, manufacture and model.
Set colItems = objWMIService.ExecQuery("Select * from Win32_ComputerSystem",,48)
For Each objItem in colItems
    UserName = objItem.UserName
    Domain = objItem.Domain
    TotalMemory = int((objItem.TotalPhysicalMemory/1024)/1024+1)
    Manufacturer = objItem.Manufacturer
    Model = objItem.Model
Next

'This determines the total hard drive space and free hard drive space.
Set colItems = objWMIService.ExecQuery("Select * from Win32_LogicalDisk Where Name='C:'",,48)
For Each objItem in colItems
    FreeHDSpace = Fix(((objItem.FreeSpace/1024)/1024)/1024)
    TotalHDSpace = Fix(((objItem.Size/1024)/1024)/1024)
Next

'This section returns the default printer and printer port.
Set colItems = objWMIService.ExecQuery("SELECT * FROM Win32_Printer where Default=True", "WQL", wbemFlagReturnImmediately + wbemFlagForwardOnly)
For Each objItem in colItems
    Printer = objItem.Name
    PortName = objItem.PortName
Next

'This returns the CPU information.
Set colItems = objWMIService.ExecQuery("SELECT * FROM Win32_Processor", "WQL", wbemFlagReturnImmediately + wbemFlagForwardOnly)
For Each objItem in colItems
    CPUDesc = LTrim(objItem.Name)
Next

'This returns the current uptime (time since last reboot) of the system.
Set colOperatingSystems = objWMIService.ExecQuery ("Select * from Win32_OperatingSystem")
For Each objOS in colOperatingSystems
    dtmBootup = objOS.LastBootUpTime
    dtmLastBootupTime = WMIDateStringToDate(dtmBootup)
    dtmSystemUptime = DateDiff("h", dtmLastBootUpTime, Now)
    Uptime = dtmSystemUptime
Next
Function WMIDateStringToDate(dtmBootup)
    WMIDateStringToDate = CDate(Mid(dtmBootup, 5, 2) & "/" & Mid(dtmBootup, 7, 2) & "/" & Left(dtmBootup, 4) & " " & Mid (dtmBootup, 9, 2) & ":" & Mid(dtmBootup, 11, 2) & ":" & Mid(dtmBootup,13, 2))
End Function

dim objFSO
Set objFSO = CreateObject("Scripting.FileSystemObject")

' -- The heart of the create file script -----------------------
' -- Creates the file using the value of strFile on Line 11
' --------------------------------------------------------------
Set fileOutput = objFSO.CreateTextFile( "x.html", true )

'Set fileOutput = objExplorer.Document

'This is the code for the web page to be displayed.

fileOutput.WriteLine "<html>"
fileOutput.WriteLine "    <head>"
fileOutput.WriteLine "        <title>System Information for '" & WKID & "' </title>"
fileOutput.WriteLine "    </head>"
fileOutput.WriteLine "    <body bgcolor='#FFFFFF' text='#000000' link='#0000FF' vlink='000099' alink='#00FF00'>"
fileOutput.WriteLine "        <center>"
fileOutput.WriteLine "            <h3>Workstaion/Server Information for " & WKID & "</h3>"
fileOutput.WriteLine "            <table border='0' cellspacing='1' cellpadding='1' width='95%'>"
fileOutput.WriteLine "                <tr><td background='" & ImgDir & "blue_spacer.gif'>"
fileOutput.WriteLine "                    <table border='0' cellspacing='0' cellpadding='0' width='100%'>"
fileOutput.WriteLine "                        <tr><td>"
fileOutput.WriteLine "                            <table border='0' cellspacing='0' cellpadding='0' width='100%'>"
fileOutput.WriteLine "                                <tr>"
fileOutput.WriteLine "                                    <td width='5%' align='left' valign='middle' background='" & ImgDir & "blue_spacer.gif'><img src='" & ImgDir & "write.gif'></td>"
fileOutput.WriteLine "                                    <td width='95%' align='left' valign='middle' background='" & ImgDir & "blue_spacer.gif'> <font color='#FFFFFF' size='5'>WKInfo - </font><font color='#FFFFFF' size='3'>General information on the Workstation.</font></td>"
fileOutput.WriteLine "                                </tr>"
fileOutput.WriteLine "                                <tr><td colspan='2' bgcolor='#FFFFFF'>"
fileOutput.WriteLine "                                    <TABLE width='100%' cellspacing='0' cellpadding='2' border='1' bordercolor='#c0c0c0' bordercolordark='#ffffff' bordercolorlight='#c0c0c0'>"
fileOutput.WriteLine "                                        <TR><TD align='center' bgcolor='#d0d0d0' colspan='2'><b><i>Last Scanned</i></b></TD></TR>"
fileOutput.WriteLine "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Date/Time</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & DateTime & "</i></td></tr>"
fileOutput.WriteLine "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>System Uptime</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & Uptime & " hours</i></td></tr>"
fileOutput.WriteLine "                                        <TR><TD align='center' bgcolor='#d0d0d0' colspan='2'><b><i>General Information</i></b></TD></TR>"
fileOutput.WriteLine "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Workstation ID</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & WKID & "</i></td></tr>"
fileOutput.WriteLine "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Domain</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & Domain & "</i></td></tr>"
fileOutput.WriteLine "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>UserName</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & UserName & "</i></td></tr>"
fileOutput.WriteLine "                                        <TR><TD align='center' bgcolor='#d0d0d0' colspan='2'><b><i>General OS Information</i></b></TD></TR>"
fileOutput.WriteLine "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Operating System</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & WKOS & "</i></td></tr>"
fileOutput.WriteLine "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Service Pack</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & ServicePack & "</i></td></tr>"
fileOutput.WriteLine "                                        <TR><TD align='center' bgcolor='#d0d0d0' colspan='2'><b><i>General Computer Information</i></b></TD></TR>"
fileOutput.WriteLine "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Manufacturer</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & Manufacturer & "</i></td></tr>"
fileOutput.WriteLine "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Model</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & Model & "</i></td></tr>"
fileOutput.WriteLine "                                        <TR><TD align='center' bgcolor='#d0d0d0' colspan='2'><b><i>General Hardware Information</i></b></TD></TR>"
fileOutput.WriteLine "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>CPU</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & CPUDesc & "</i></td></tr>"
fileOutput.WriteLine "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Memory</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & TotalMemory & " MB</i></td></tr>"
fileOutput.WriteLine "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Total HD Space</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & TotalHDSpace & " GB</i></td></tr>"
fileOutput.WriteLine "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Free HD Space</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & FreeHDSpace & " GB</i></td></tr>"
fileOutput.WriteLine "                                        <TR><TD align='center' bgcolor='#d0d0d0' colspan='2'><b><i>General Video Card Information</i></b></TD></TR>"
fileOutput.WriteLine "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Video Card</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & VideoCard & "</i></td></tr>"
fileOutput.WriteLine "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Resolution</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & Resolution & "</i></td></tr>"
fileOutput.WriteLine "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Memory</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & VideoMemory & " MB</i></td></tr>"
fileOutput.WriteLine "                                        <TR><TD align='center' bgcolor='#d0d0d0' colspan='2'><b><i>Default Printer Information</i></b></TD></TR>"
fileOutput.WriteLine "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Printer</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & Printer & "</i></td></tr>"
fileOutput.WriteLine "                                        <TR><TD width='30%' align='left' bgcolor='#e0e0e0'>Port Name</TD><td width='70%' bgcolor=#f0f0f0 align=left><i>" & PortName & "</i></td></tr>"
fileOutput.WriteLine "                                        <TR><TD align='center' bgcolor='#d0d0d0' colspan='2'><b><i>Shared Directories</i></b></TD></TR>"
'This sextion lists all the current shares enabled on the PC.
fileOutput.WriteLine "                                        <tr><td colspan='2' bgcolor='#f0f0f0'>"
fileOutput.WriteLine "                                            <TABLE width='100%' cellspacing='0' cellpadding='2' border='1' bordercolor='#c0c0c0' bordercolordark='#ffffff' bordercolorlight='#c0c0c0'>"
fileOutput.WriteLine "                                                <TR><TD width='30%' align='center' bgcolor='#e0e0e0'><b>Name</b></td><TD width='40%' align='center' bgcolor='#e0e0e0'><b>Path</b><TD width='40%' align='center' bgcolor='#e0e0e0'><b>Description</b></td><tr>"
Set colShares = objWMIService.ExecQuery("Select * from Win32_Share")
For each objShare in colShares
    fileOutput.WriteLine "                                                <TR><TD width='30%' align='left' bgcolor='#f0f0f0'><i>" & objShare.Name & "</i></TD><td bgcolor=#f0f0f0 align=left><i>" & objShare.Path & "</i></TD><td bgcolor=#f0f0f0 align=left><i>" & objShare.Caption & "</i></td></tr>"
Next
fileOutput.WriteLine "                                            </table>"
fileOutput.WriteLine "                                        </td></tr>"
'This section lists all the current services and their status.
fileOutput.WriteLine "                                        <TR><TD align='center' bgcolor='#d0d0d0' colspan='2'><b><i>Current Service Information</i></b></TD></TR>"
fileOutput.WriteLine "                                        <tr><td colspan='2' bgcolor='#f0f0f0'>"
fileOutput.WriteLine "                                            <TABLE width='100%' cellspacing='0' cellpadding='2' border='1' bordercolor='#c0c0c0' bordercolordark='#ffffff' bordercolorlight='#c0c0c0'>"
fileOutput.WriteLine "                                                <TR><TD width='70%' align='center' bgcolor='#e0e0e0'><b>Service Name</b></td><TD width='30%' align='center' bgcolor='#e0e0e0'><b>Service State</b></td><tr>"
Set colRunningServices = objWMIService.ExecQuery("Select * from Win32_Service")
For Each objService in colRunningServices
fileOutput.WriteLine "                                            <TR><TD align='left' bgcolor='#f0f0f0'>" & objService.DisplayName & "</TD><td bgcolor=#f0f0f0 align=center><i>" & objService.State & "</i></td></tr>"
    wscript.echo  "                                            <TR><TD align='left' bgcolor='#f0f0f0'>" & objService.DisplayName & "</TD><td bgcolor=#f0f0f0 align=center><i>" & objService.State & "</i></td></tr>"
Next
fileOutput.WriteLine "                                            </table>"
fileOutput.WriteLine "                                        </td></tr>"
'This section lists all the current running processes and some information.
fileOutput.WriteLine "                                        <TR><TD align='center' bgcolor='#d0d0d0' colspan='2'><b><i>Current Process Information</i></b></TD></TR>"
fileOutput.WriteLine "                                        <tr><td colspan='2' bgcolor='#f0f0f0'>"
fileOutput.WriteLine "                                            <TABLE width='100%' cellspacing='0' cellpadding='2' border='1' bordercolor='#c0c0c0' bordercolordark='#ffffff' bordercolorlight='#c0c0c0'>"
fileOutput.WriteLine "                                                <TR><TD width='10%' align='center' bgcolor='#e0e0e0'><b>PID</b></td><TD width='35%' align='center' bgcolor='#e0e0e0'><b>Process Name</b></td><TD width='40%' align='center' bgcolor='#e0e0e0'><b>Owner</b></td><TD width='15%' align='center' bgcolor='#e0e0e0'><b>Memory</b></td></tr>"
Set colProcessList = objWMIService.ExecQuery("Select * from Win32_Process")
For Each objProcess in colProcessList
colProperties = objProcess.GetOwner(strNameOfUser,strUserDomain)
fileOutput.WriteLine "                                                <TR><TD align='center' bgcolor='#f0f0f0'>" & objProcess.Handle & "</td><TD align='center' bgcolor='#f0f0f0'>" & objProcess.Name & "</td><TD align='center' bgcolor='#f0f0f0'>" & strUserDomain & "\" & strNameOfUser & "</td><TD align='center' bgcolor='#f0f0f0'>" & objProcess.WorkingSetSize/1024 & " kb</td><tr>"
Next
fileOutput.WriteLine "                                            </table>"
fileOutput.WriteLine "                                        </td></tr>"
'This section lists all the currently installed software on the machine.
fileOutput.WriteLine "                                        <TR><TD align='center' bgcolor='#d0d0d0' colspan='2'><b><i>Installed Software</i></b></TD></TR>"
fileOutput.WriteLine "                                        <tr><td colspan='2' bgcolor='#f0f0f0'>"
Set colSoftware = objWMIService.ExecQuery ("Select * from Win32_Product")
For Each objSoftware in colSoftware
    fileOutput.WriteLine"                                            <TABLE width='100%' cellspacing='0' cellpadding='2' border='1' bordercolor='#c0c0c0' bordercolordark='#ffffff' bordercolorlight='#c0c0c0'>"
    fileOutput.WriteLine"                                                <tr><td align=left bgcolor='#e0e0e0'><b>Caption:</b></td><td colspan=2 bgcolor=#f0f0f0>" & objSoftware.Caption & "</td></tr>"
    fileOutput.WriteLine"                                                <tr><td align=left bgcolor='#e0e0e0'><b>Install Location:</b></td><td colspan=2 bgcolor=#f0f0f0>" & objSoftware.InstallLocation & "</td></tr>"
    fileOutput.WriteLine"                                                <tr><td width=30% align=center bgcolor='#e0e0e0'><b>Name</b></td><td width=30% align=center bgcolor='#e0e0e0'><b>Vendor</b></td><td width=30% align=center bgcolor='#e0e0e0'><b>Version</b></td></tr>"
    fileOutput.WriteLine"                                                <tr><td align=center bgcolor=#f0f0f0>" & objSoftware.Name & "</td><td align=center bgcolor=#f0f0f0>" & objSoftware.Vendor & "</td><td align=center bgcolor=#f0f0f0>" & objSoftware.Version & "</td></tr>"
    fileOutput.WriteLine"                                                <tr height=2><td height=10 align=center bgcolor=midnightblue colspan=3></td></tr>"
    fileOutput.WriteLine"                                            </table>"
Next
fileOutput.WriteLine "                                        </td></tr>"
fileOutput.WriteLine "                                    </table>"
fileOutput.WriteLine "                                </td></tr>"
fileOutput.WriteLine "                            </table>"
fileOutput.WriteLine "                        </td></tr>"
fileOutput.WriteLine "                    </table>"
fileOutput.WriteLine "                </td></tr>"
fileOutput.WriteLine "            </table>"
fileOutput.WriteLine "            <p><small></small></p>"
fileOutput.WriteLine "        </center>"
fileOutput.WriteLine "    </body>"
fileOutput.WriteLine "<html>"
fileOutput.close
WScript.Quit 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T05:53:17.987

如果你看

[SWbemLocator.ConnectServer 方法](http://msdn.microsoft.com/en-us/library/aa393720.aspx)

您将看到计算机名称是可选的，因此只需使用 , 从运行脚本的计算机获取详细信息。

IE：

```
Set objWMIService = SWBemlocator.ConnectServer( ,"root\CIMV2",strUserName,strPassword) 
```

然后不要打开ie文档，只打开并写入文件，使用writeLine而不是writeLn。

还要更改此行：

```
Set objWMIService = GetObject("winmgmts:\\" & strComputer & "\root\cimv2") 
```

至

设置 objWMIService = GetObject("winmgmts:root\cimv2")

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-04T06:11:13.013

这是一个修改后的副本，显示了在计算机名称中“硬编码”的三种不同方法，或者只使用本地计算机（通过“.”、“127.0.0.1”或“PCNAME”）。它还将保存一个带有结果的“MyFile.log”。

```
On Error Resume Next
Const HKEY_CURRENT_USER = &H80000001
Const HKEY_LOCAL_MACHINE = &H80000002

Dim strComputer, objWMIService, propValue, objItem
Dim strUserName, strPassword, colItems, SWBemlocator

' This section queries for the workstation to be scanned.
strComputer = "." ' . = local computer, you can substitute it by name, or ip
strComputer = "REMOTEPC" ' example of a remote pc by computername
strComputer = "127.0.0.1" ' local computer pulled up via ip
UserName = ""
Password = ""
ImgDir = "C:\Scripts\images\"

'Sets up the connections and objects to be used throughout the script.
Set SWBemlocator = CreateObject("WbemScripting.SWbemLocator")
Set objWMIService = SWBemlocator.ConnectServer(strComputer,"root\CIMV2",strUserName,strPassword)

'This determines the current date and time of the PC being scanned.
Dim DateTime
Set colItems = objWMIService.ExecQuery("SELECT * FROM Win32_LocalTime", "WQL", wbemFlagReturnImmediately + wbemFlagForwardOnly)
For Each objItem in colItems
    If objItem.Minute < 10 Then
        theMinutes = "0" & objItem.Minute
    Else
        theMinutes = objItem.Minute
    End If
    If objItem.Second < 10 Then
        theSeconds = "0" & objItem.Second
    Else
        theSeconds = objItem.Second
    End If
    DateTime = objItem.Month & "/" & objItem.Day & "/" & objItem.Year & " - " & objItem.Hour & ":" & theMinutes & ":" & theSeconds
Next

Dim fso, MyFile
Set fso = CreateObject("Scripting.FileSystemObject")
Set MyFile = fso.CreateTextFile("MyFile.log", True)
MyFile.WriteLine(strComputer & " -> " & DateTime)
MyFile.Close

If Err.Number <> 0 Then
  WScript.Echo Err.Description
End if 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-04T06:11:40.563

嘿，我实际上一开始就摆脱了登录框，只是在这里删除了这些行..

```
' This section queries for the workstation to be scanned.
strComputer = inputbox ("Workstation", "Enter the workstation ID to scan.",".")
UserName = ""
Password = ""
ImgDir = "C:\Scripts\images\" 
```

现在，如果我知道如何修改它，以便将 html 保存到硬盘驱动器而不是仅仅打开它。我不是 VB 脚本编写者，我只做 HTML 哈哈

# git - 如何发现差异由哪些提交组成？

> ID：716572
> 
> 赞同：3
> 
> 时间：2009-04-04T05:44:01.177
> 
> 标签：git

`git diff rev^ rev`如果我要接收使用类似or even生成的补丁文件`git show -p rev`，我如何才能发现哪些提交正在被区分？

我不肯定这个用例甚至与 git 相关，但是注意到 cvs/svn 中包含的补丁头中的文件路径和/或修订号给我一个温暖的模糊，我收到或创建的补丁是与正确的来源或修订版本不同。

具体来说，如果我们检查一个 git diff 标头：

```
diff --git a/lib/blueprint/semantic_class_names.rb b/lib/blueprint/semantic_class_names.rb
index 41bd496..c17af1d 100644
--- a/lib/blueprint/semantic_class_names.rb
+++ b/lib/blueprint/semantic_class_names.rb 
```

我找不到有关此差异中涉及的提交的区别信息。有一个索引行，我只能假设它不是缩写的提交哈希，而是文件差异部分的哈希。它肯定与相关的提交签名不匹配。

如果我比较了几个文件，并决定通过电子邮件发送补丁去老学校，那么在发送我制作的补丁之前，我没有办法快速仔细检查我是否区分了正确的文件/修订版本。在标题？我知道由于分布式的性质，在 git 中的修订不如在 cvs/svn 中有意义，但我是唯一一个不介意在标题中至少看到文件的缩写提交签名的人吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-04T06:27:27.327

diff 中提供的散列实际上是 blob 的散列。

因此，您可以使用此问题中提供的方法找到包含该 blob 的提交：[Git: Which commit has this blob?](https://stackoverflow.com/questions/223678/git-which-commit-has-this-blob)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T06:33:54.910

如果您使用`git show <rev>`,（或`git show -p <rev>`），您将获得一个包含提交标识符以及作者、日期和提交消息的补丁。

```
$ git 显示 rel
提交 82bf5b5df1e0308939a6e91cf4c7d2dae8088d99
作者：布赖恩坎贝尔
日期：2009 年 3 月 5 日星期四 14:00:54 -0500

    更新另一个文件

diff --git a/another b/another
索引 2102854..4083e0c 100644
--- 一个/另一个
+++ b/另一个
@@ -1 +1,3 @@
 完后还有
+
+更多线路
\ 文件末尾没有换行符

```

补丁实用程序通常会忽略补丁开头的额外内容，因此它的整个输出应该是有效的，可以用作补丁。您还可以使用`git format-patch`获取格式化为更易于自动发送的内容，例如使用`git send-email`或`git imap-send`.

正如 htanata 指出的那样，您在单个文件的 diff 标头本身中看到的是 blob 标识符；虽然您可以使用它来查找它可能来自的修订版，但这会很慢并且不一定正确。如果您需要参考提交，最好将提及提交的标题与补丁一起保留。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T14:10:05.703

您可以很容易地挑选出在树中的已知路径中引入特定 blob id 的提交。

例如，`blob_path`设置为补丁影响的树中的路径并且是补丁`blob_sha1`中的缩写 sha1（即紧跟补丁中差异行之后的“索引”之后的内容），这个简短的脚本将找到哪个提交引入了该版本文件。

```
for h in $(git log --pretty=format:%H "$blob_path")
do
    test "$(git rev-parse "$h:$blob_path")" = "$(git rev-parse "$blob_sha1")" &&
        echo $h
done 
```

当然，您可能想要仍然具有该文件版本的最新提交，在这种情况下，您希望提交的父级紧接在`git log --pretty=format:%H "$blob_path"`.

# c - Windows API 中的 C 注册表函数

> ID：716579
> 
> 赞同：0
> 
> 时间：2009-04-04T05:47:58.797
> 
> 标签：c, winapi, readability

RegOpenKeyEx()

我想 printf("Success") 或 printf("Failure") 取决于函数是失败还是成功

我将如何在保持整洁和易读的同时做这样的条件？

我想远离这个：

```
if (RegOpenKeyEx(HKEY_LOCAL_MACHINE,"HUGE LONG KYEY STRUCTURE HERE",0,KEY_SET_VALUE) != 0 )
{
   //CODE 
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-04T05:59:26.273

您是在问如何检查它失败的原因吗？

“Winerror.h 中定义的非零错误代码表示失败。要获取错误的一般描述，请调用设置了 FORMAT_MESSAGE_FROM_SYSTEM 标志的 FormatMessage。”

所以.. ERROR_SUCCESS 如果成功，错误代码如果失败。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-05T18:44:18.827

您可以使用换行符，或命名事物或两者兼而有之，

```
 LONG result = RegOpenKeyEx(HKEY_LOCAL_MACHINE,
                            "HUGE LONG KYEY STRUCTURE HERE",
                             0,KEY_SET_VALUE);
 if(result != 0 ) {
    ... 
```

也许

```
 LPCTSTR keypath = "HUGE LONG KYEY STRUCTURE HERE";
 if( RegOpenKeyEx(HKEY_LOCAL_MACHINE,keypath,0,KEY_SET_VALUE) != 0 ) {
     ... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-04T06:15:14.410

检查未编辑的问题后，我认为您唯一能做的就是将语句分解为多个语句，如下所示：

```
const char* regKey = "BIG_STRING......";
DWORD errorCode = RegOpenKeyEx(...);
if(ERROR_SUCCESS == errorCode)
{ 
  //Rest of the code
}
else
{
  //Error handling
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-04T07:43:05.367

您可以改为使用三元运算符：

```
bool success = (RegKeyOpenEx(...) == ERROR_SUCCESS);
printf("%s\n", success ? "Success" : "Failure"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-04T05:57:58.973

不成功时不返回 ERROR_SUCCESS。你是这个意思吗？

对于错误代码的多次检查，请使用：

```
LONG errors = 0;

errors += abs( RegKeyOpenEx(HKEY_LOCAL_MACHINE,"HUGE LONG KYEY STRUCTURE HERE",0,KEY_SET_VALUE) );
errors += abs( RegKeyOpenEx(HKEY_LOCAL_MACHINE,"HUGE LONG KYEY STRUCTURE HERE",0,KEY_SET_VALUE) );
errors += abs( RegKeyOpenEx(HKEY_LOCAL_MACHINE,"HUGE LONG KYEY STRUCTURE HERE",0,KEY_SET_VALUE) );
errors += abs( RegKeyOpenEx(HKEY_LOCAL_MACHINE,"HUGE LONG KYEY STRUCTURE HERE",0,KEY_SET_VALUE) );
errors += abs( RegKeyOpenEx(HKEY_LOCAL_MACHINE,"HUGE LONG KYEY STRUCTURE HERE",0,KEY_SET_VALUE) );

if( errors > 0 )
{
  print( "OMG It went wrong!\n" );
}
else
{
  print( "Hero!\n" );
} 
```

# .net - 用 VB 在 Silverlight 中编写 XML

> ID：716590
> 
> 赞同：1
> 
> 时间：2009-04-04T05:53:22.823
> 
> 标签：.net, xml, vb.net, silverlight

是否可以用vb在silverlight中编写xml

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-04T12:33:50.613

是的，您可以在 silverlight 中编写 XML。Silverlight 的 System.Xml dll 支持 XmlWriter，它允许您将 XML 写入 Stream、TextWriter 或 StringBuilder。

如果您正在寻找标准的 XML DOM 实现，您将找不到它，Silverlight 没有，也没有 XPath。相反，如果您希望在内存中构建 XML 文档，您可以使用 System.Xml.Linq。使用 XDocument、XElement 和 XAttribute 创建您的文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T06:03:02.940

是的，您可以使用 VB(.NET) 编写 Silverlight 应用程序和网页，并且它们可以保存 XML 文件，但是它们将受到 Silverlight 的安全/沙盒的限制。

所以，你可以做到，但你必须使用隔离存储的东西。

[http://www.danielmoth.com/Blog/2008/04/isolatedstorage-in-siverlight-2-beta-1.html](http://www.danielmoth.com/Blog/2008/04/isolatedstorage-in-siverlight-2-beta-1.html)

我很抱歉这个答案并不好，所以我将其标记为社区维基。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-04T13:33:36.337

在我的应用程序中，模型层是基于 XML 的，我使用 LINQ To XML（由 SL 支持）非常好的东西（如果您正在处理低于一些 Mb 的 XML，就像 DOM 在内存中构建树一样）。

另一方面，将 XML 存储在隔离存储中，或者在服务器中我只是将 XML 转换为字符串，非常标准的参数 :)，仅在使用服务配置参数时要小心 tu 支持超过 64 K 的字符串参数（如果你在那种情况下）。

高温高压

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-04T13:50:48.387

其他用户已经涵盖了物理 XML 的实际编写，因此请参阅他们的答案。

不过我想知道，您是在谈论 VB XML 文字吗？如果是这样，那么可以在 Silverlight 应用程序中使用 VB XML 文字。这扩展到了 XML 文字和 XLINQ 的使用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-26T09:03:45.043

例如，您可以使用 XMLSerialization 从对象轻松创建 XML。

# java - Java 中的数组或列表。哪个更快？

> ID：716597
> 
> 赞同：380
> 
> 时间：2009-04-04T05:57:28.337
> 
> 标签：java, arrays, list, performance

我必须在内存中保留数千个字符串，以便在 Java 中连续访问。我应该将它们存储在数组中还是应该使用某种 List ？

由于数组将所有数据保存在连续的内存块中（与列表不同），使用数组存储数千个字符串会导致问题吗？

* * *

## 回答 #1

> 赞同：387
> 
> 时间：2009-04-04T06:18:14.120

我建议您使用分析器来测试哪个更快。

我个人的意见是你应该使用列表。

我在一个大型代码库上工作，以前的一组开发人员**到处都**使用数组。它使代码非常不灵活。将其中的大部分更改为列表后，我们注意到速度没有差异。

* * *

## 回答 #2

> 赞同：176
> 
> 时间：2009-04-04T06:34:32.070

Java 方法是您应该考虑最适合您需要的数据*抽象。*请记住，在 Java 中，List 是抽象的，而不是具体的数据类型。您应该将字符串声明为 List，然后使用 ArrayList 实现对其进行初始化。

```
List<String> strings = new ArrayList<String>(); 
```

抽象数据类型和具体实现的这种分离是面向对象编程的关键方面之一。

ArrayList 使用数组作为其底层实现来实现 List 抽象数据类型。访问速度几乎与数组相同，具有额外的优势，即能够在 List 中添加和减去元素（尽管这是使用 ArrayList 的 O(n) 操作），并且如果您决定稍后更改底层实现你可以。例如，如果您意识到需要同步访问，则可以将实现更改为 Vector，而无需重写所有代码。

事实上，ArrayList 专门设计用于在大多数情况下替换低级数组构造。如果今天设计 Java，则完全有可能完全忽略数组以支持 ArrayList 构造。

> 由于数组将所有数据保存在连续的内存块中（与列表不同），使用数组存储数千个字符串会导致问题吗？

在 Java 中，所有集合都只存储对对象的引用，而不是对象本身。数组和 ArrayList 都会在一个连续的数组中存储几千个引用，因此它们本质上是相同的。您可以认为，在现代硬件上始终可以轻松获得数千个 32 位引用的连续块。这并不能保证您不会完全耗尽内存，当然，只是保证连续块的内存要求不难满足。

* * *

## 回答 #3

> 赞同：121
> 
> 时间：2013-05-15T12:45:28.903

尽管建议使用 ArrayList 的答案在大多数情况下确实有意义，但相对性能的实际问题还没有真正得到回答。

你可以用数组做一些事情：

*   创造它
*   设置一个项目
*   得到一个项目
*   克隆/复制它

## 一般结论

**尽管 ArrayList 上的 get 和 set 操作稍微慢一些**（在我的机器上每次调用分别为 1 和 3 纳秒），**但对于任何非密集使用而言，使用 ArrayList 与使用数组相比开销很小。**但是，有几点需要记住：

*   调整列表的大小操作（调用时`list.add(...)`）代价高昂，应该尽可能将初始容量设置在适当的水平（请注意，使用数组时会出现同样的问题）
*   在处理原语时，数组可以明显更快，因为它们可以避免许多装箱/拆箱转换
*   仅在 ArrayList 中获取/设置值的应用程序（不是很常见！）通过切换到数组可以看到超过 25% 的性能提升

## 详细结果

以下是我在标准 x86 桌面机器上使用[jmh 基准测试库（以纳秒为单位）和 JDK 7 测量这三个操作的结果。](http://openjdk.java.net/projects/code-tools/jmh/)请注意，在测试中永远不会调整 ArrayList 的大小以确保结果具有可比性。[基准代码可在此处获得](https://bitbucket.org/assylias/performance/src/06d31f92c240/src/main/java/com/assylias/performance/ArrayVsList.java?at=master)。

## 数组/数组列表创建

我运行了 4 个测试，执行以下语句：

*   创建数组1：`Integer[] array = new Integer[1];`
*   创建列表1：`List<Integer> list = new ArrayList<> (1);`
*   创建数组10000：`Integer[] array = new Integer[10000];`
*   创建列表10000：`List<Integer> list = new ArrayList<> (10000);`

结果（每次调用以纳秒为单位，95% 置信度）：

```
a.p.g.a.ArrayVsList.CreateArray1         [10.933, 11.097]
a.p.g.a.ArrayVsList.CreateList1          [10.799, 11.046]
a.p.g.a.ArrayVsList.CreateArray10000    [394.899, 404.034]
a.p.g.a.ArrayVsList.CreateList10000     [396.706, 401.266] 
```

**结论：没有明显差异**。

## 获取操作

我运行了 2 个测试，执行以下语句：

*   获取列表：`return list.get(0);`
*   获取数组：`return array[0];`

结果（每次调用以纳秒为单位，95% 置信度）：

```
a.p.g.a.ArrayVsList.getArray   [2.958, 2.984]
a.p.g.a.ArrayVsList.getList    [3.841, 3.874] 
```

**结论：从数组**获取比从 ArrayList 获取快约 25%，尽管差异仅在 1 纳秒量级。

## 集合操作

我运行了 2 个测试，执行以下语句：

*   设置列表：`list.set(0, value);`
*   设置数组：`array[0] = value;`

结果（每次调用以纳秒为单位）：

```
a.p.g.a.ArrayVsList.setArray   [4.201, 4.236]
a.p.g.a.ArrayVsList.setList    [6.783, 6.877] 
```

**结论：数组上的集合操作**比列表快 40%，但是，对于 get，每个集合操作需要几纳秒 - 所以要达到 1 秒的差异，需要在列表/数组中设置数百个项目数百万次！

# 克隆/复制

ArrayList 的复制构造函数委托给`Arrays.copyOf`因此性能与数组复制相同（通过复制数组`clone`，`Arrays.copyOf`或`System.arrayCopy` [在性能方面没有实质性差异](https://stackoverflow.com/questions/12157300/clone-or-arrays-copyof)）。

* * *

## 回答 #4

> 赞同：106
> 
> 时间：2009-04-04T06:36:14.390

您应该更喜欢泛型类型而不是数组。正如其他人所提到的，数组是不灵活的，并且没有泛型类型的表达能力。（然而，它们确实支持运行时类型检查，但这与泛型类型混为一谈。）

但是，与往常一样，在优化时，您应该始终遵循以下步骤：

*   **在你的代码有一个漂亮、干净和工作**的版本之前，不要进行优化。在这一步很可能已经激发了更改为泛型类型的动机。
*   当您有一个干净整洁的版本时，请确定它是否足够快。
*   如果不够快，**请测量其性能**。这一步很重要，有两个原因。如果您不进行测量，您将不会 (1) 知道您所做的任何优化的影响以及 (2) 知道在哪里进行优化。
*   优化代码中最热门的部分。
*   **再次测量。**这与之前的测量一样重要。如果优化没有改善，请**恢复它**。请记住，*没有*优化的代码是**干净、漂亮且有效的。**

* * *

## 回答 #5

> 赞同：24
> 
> 时间：2009-04-04T13:11:54.330

我猜原始海报来自 C++/STL 背景，这引起了一些混乱。在 C++`std::list`中是一个双向链表。

在 Java`[java.util.]List`中是一个无实现接口（C++ 术语中的纯抽象类）。`List`可以是双向链表 -`java.util.LinkedList`提供。但是，100 次中有 99 次在您想要 make a new`List`时，您想要使用`java.util.ArrayList`它，这与 C++ 大致相当`std::vector`。还有其他标准实现，例如`java.util.Collections.emptyList()`and返回的那些`java.util.Arrays.asList()`。

从性能的角度来看，必须通过接口和额外的对象对性能的影响很小，但是运行时内联意味着这很少有任何意义。还要记住，`String`它通常是一个对象加数组。因此，对于每个条目，您可能还有另外两个对象。在 C++`std::vector<std::string>`中，尽管按值复制而不使用指针，但字符数组将形成一个字符串对象（这些通常不会被共享）。

如果此特定代码对性能非常敏感，您可以为所有字符串的所有字符创建一个`char[]`数组（甚至`byte[]`），然后创建一个偏移量数组。IIRC，这就是 javac 的实现方式。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2012-09-16T01:50:56.230

我同意在大多数情况下，您应该选择 ArrayLists 的灵活性和优雅性而不是数组 - 在大多数情况下，对程序性能的影响可以忽略不计。

但是，如果您正在为软件图形渲染或自定义虚拟机进行持续、大量迭代而结构变化很小（没有添加和删除），我的顺序访问基准测试表明**ArrayLists 比**我的数组慢 1.5 倍系统（我一岁的 iMac 上的 Java 1.6）。

一些代码：

```
import java.util.*;

public class ArrayVsArrayList {
    static public void main( String[] args ) {

        String[] array = new String[300];
        ArrayList<String> list = new ArrayList<String>(300);

        for (int i=0; i<300; ++i) {
            if (Math.random() > 0.5) {
                array[i] = "abc";
            } else {
                array[i] = "xyz";
            }

            list.add( array[i] );
        }

        int iterations = 100000000;
        long start_ms;
        int sum;

        start_ms = System.currentTimeMillis();
        sum = 0;

        for (int i=0; i<iterations; ++i) {
          for (int j=0; j<300; ++j) sum += array[j].length();
        }

        System.out.println( (System.currentTimeMillis() - start_ms) + " ms (array)" );
        // Prints ~13,500 ms on my system

        start_ms = System.currentTimeMillis();
        sum = 0;

        for (int i=0; i<iterations; ++i) {
          for (int j=0; j<300; ++j) sum += list.get(j).length();
        }

        System.out.println( (System.currentTimeMillis() - start_ms) + " ms (ArrayList)" );
        // Prints ~20,800 ms on my system - about 1.5x slower than direct array access
    }
} 
```

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2009-04-04T13:46:11.377

那么首先值得澄清的是，您是指经典 comp sci 数据结构意义上的“列表”（即链表）还是 java.util.List？如果您的意思是 java.util.List，它是一个接口。如果您想使用数组，只需使用 ArrayList 实现，您将获得类似数组的行为和语义。问题解决了。

如果您的意思是数组与链表，这是一个稍微不同的论点，我们回到大 O （如果这是一个不熟悉的术语，这里是一个[简单的英语解释。](https://stackoverflow.com/questions/487258/plain-english-explanation-of-big-o/487278#487278)

大批;

*   随机访问：O(1)；
*   插入：O(n)；
*   删除：O(n)。

链表：

*   随机访问：O(n)；
*   插入：O(1)；
*   删除：O(1)。

因此，您可以选择最适合您调整阵列大小的方式。如果您调整大小、插入和删除很多，那么链表可能是更好的选择。如果随机访问很少见，情况也是如此。你提到串行访问。如果您主要是进行很少修改的串行访问，那么您选择哪个可能并不重要。

链接列表的开销略高，因为就像您说的那样，您正在处理可能不连续的内存块和（有效地）指向下一个元素的指针。但是，除非您处理数百万个条目，否则这可能不是一个重要因素。

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2009-04-04T14:44:33.343

我写了一个小基准来比较 ArrayLists 和 Arrays。在我的老式笔记本电脑上，遍历 5000 个元素的数组列表 1000 次的时间比等效的数组代码慢了大约 10 毫秒。

所以，如果你除了迭代列表什么都不做，而且你做了很多，那么*也许*值得优化。*否则我会使用列表，因为当您确实*需要优化代码时它会更容易。

注意，我*确实*注意到 using`for String s: stringsList`比使用旧式 for 循环访问列表要慢 50%。去图...这是我计时的两个功能；数组和列表填充了 5000 个随机（不同）字符串。

```
private static void readArray(String[] strings) {
    long totalchars = 0;
    for (int j = 0; j < ITERATIONS; j++) {
        totalchars = 0;
        for (int i = 0; i < strings.length; i++) {
            totalchars += strings[i].length();

        }
    }
}

private static void readArrayList(List<String> stringsList) {
    long totalchars = 0;
    for (int j = 0; j < ITERATIONS; j++) {
        totalchars = 0;
        for (int i = 0; i < stringsList.size(); i++) {
            totalchars += stringsList.get(i).length();
        }
    }
} 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2009-04-04T06:02:00.183

不，因为从技术上讲，数组只存储对字符串的引用。字符串本身分配在不同的位置。对于一千个项目，我会说一个列表会更好，它更慢，但它提供了更大的灵活性并且更容易使用，特别是如果你要调整它们的大小。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2009-04-05T00:55:14.297

如果您有数千个，请考虑使用 trie。trie 是一种树状结构，它合并了存储字符串的公共前缀。

例如，如果字符串是

```
intern
international
internationalize
internet
internets 
```

特里将存储：

```
intern
 -> \0
 international
 -> \0
 -> ize\0
 net
 ->\0
 ->s\0 
```

字符串需要 57 个字符（包括空终止符，'\0'）用于存储，加上保存它们的字符串对象的大小。（实际上，我们可能应该将所有大小四舍五入到 16 的倍数，但是......）大致称它为 57 + 5 = 62 字节。

trie 需要 29 个（包括空终止符，'\0'）用于存储，加上 trie 节点的大小，它们是数组的引用和子 trie 节点的列表。

对于此示例，结果可能大致相同；对于数千人来说，只要你有共同的前缀，它可能会更少出现。

现在，当在其他代码中使用 trie 时，您必须转换为 String，可能使用 StringBuffer 作为中介。如果许多字符串同时用作字符串，那么在 trie 之外，这是一种损失。

但是，如果您当时只使用几个——例如，在字典中查找内容——则 trie 可以为您节省大量空间。绝对比将它们存储在 HashSet 中的空间更少。

您说您正在“串行”访问它们——如果这意味着按字母顺序排列，那么如果您以深度优先的方式进行迭代，那么 trie 显然也可以免费为您提供字母顺序。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2016-11-03T18:51:37.330

由于这里已经有很多很好的答案，我想给你一些实际观点的其他信息，即**插入和迭代性能比较：Java中的原始数组与链表。**

这是实际的简单性能检查。
因此，结果将取决于机器性能。

用于此的源代码如下：

```
import java.util.Iterator;
import java.util.LinkedList;

public class Array_vs_LinkedList {

    private final static int MAX_SIZE = 40000000;

    public static void main(String[] args) {

        LinkedList lList = new LinkedList(); 

        /* insertion performance check */

        long startTime = System.currentTimeMillis();

        for (int i=0; i<MAX_SIZE; i++) {
            lList.add(i);
        }

        long stopTime = System.currentTimeMillis();
        long elapsedTime = stopTime - startTime;
        System.out.println("[Insert]LinkedList insert operation with " + MAX_SIZE + " number of integer elapsed time is " + elapsedTime + " millisecond.");

        int[] arr = new int[MAX_SIZE];

        startTime = System.currentTimeMillis();
        for(int i=0; i<MAX_SIZE; i++){
            arr[i] = i; 
        }

        stopTime = System.currentTimeMillis();
        elapsedTime = stopTime - startTime;
        System.out.println("[Insert]Array Insert operation with " + MAX_SIZE + " number of integer elapsed time is " + elapsedTime + " millisecond.");

        /* iteration performance check */

        startTime = System.currentTimeMillis();

        Iterator itr = lList.iterator();

        while(itr.hasNext()) {
            itr.next();
            // System.out.println("Linked list running : " + itr.next());
        }

        stopTime = System.currentTimeMillis();
        elapsedTime = stopTime - startTime;
        System.out.println("[Loop]LinkedList iteration with " + MAX_SIZE + " number of integer elapsed time is " + elapsedTime + " millisecond.");

        startTime = System.currentTimeMillis();

        int t = 0;
        for (int i=0; i < MAX_SIZE; i++) {
            t = arr[i];
            // System.out.println("array running : " + i);
        }

        stopTime = System.currentTimeMillis();
        elapsedTime = stopTime - startTime;
        System.out.println("[Loop]Array iteration with " + MAX_SIZE + " number of integer elapsed time is " + elapsedTime + " millisecond.");
    }
} 
```

性能结果如下：

[![在此处输入图像描述](https://i.stack.imgur.com/V8ALj.png)](https://i.stack.imgur.com/V8ALj.png)

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2018-07-03T13:29:05.660

我来到这里是为了更好地了解使用列表而不是数组对性能的影响。我必须为我的场景调整代码：~1000 个整数的数组/列表，主要使用 getter，这意味着 array[j] 与 list.get(j)

采取最好的 7 对它不科学（前几个列表慢 2.5 倍）我得到这个：

```
array Integer[] best 643ms iterator
ArrayList<Integer> best 1014ms iterator

array Integer[] best 635ms getter
ArrayList<Integer> best 891ms getter (strange though) 
```

- 所以，使用数组大约快 30%

现在发布的第二个原因是没有人提到如果您使用*嵌套*循环进行数学/矩阵/模拟/优化代码的影响。

假设您有三个嵌套级别，并且内部循环的速度是您查看 8 倍性能影响的两倍。可以在一天内运行的东西现在需要一周时间。

*编辑这里很震惊，我试着声明 int[1000] 而不是 Integer[1000]

```
array int[] best 299ms iterator
array int[] best 296ms getter 
```

使用 Integer[] 与 int[] 代表双倍的性能损失，带有迭代器的 ListArray 比 int[] 慢 3 倍。真的认为Java的列表实现类似于原生数组......

参考代码（多次调用）：

```
 public static void testArray()
    {
        final long MAX_ITERATIONS = 1000000;
        final int MAX_LENGTH = 1000;

        Random r = new Random();

        //Integer[] array = new Integer[MAX_LENGTH];
        int[] array = new int[MAX_LENGTH];

        List<Integer> list = new ArrayList<Integer>()
        {{
            for (int i = 0; i < MAX_LENGTH; ++i)
            {
                int val = r.nextInt();
                add(val);
                array[i] = val;
            }
        }};

        long start = System.currentTimeMillis();
        int test_sum = 0;
        for (int i = 0; i < MAX_ITERATIONS; ++i)
        {
//          for (int e : array)
//          for (int e : list)          
            for (int j = 0; j < MAX_LENGTH; ++j)
            {
                int e = array[j];
//              int e = list.get(j);
                test_sum += e;
            }
        }

        long stop = System.currentTimeMillis();

        long ms = (stop - start);
        System.out.println("Time: " + ms);
    } 
```

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2009-04-04T06:04:15.543

列表比数组慢。如果你需要效率使用数组。如果你需要灵活性使用列表。

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2013-05-24T08:35:04.733

更新：

正如 Mark 所指出的，在 JVM 预热（几次测试通过）之后没有显着差异。检查重新创建的数组或什至从新的矩阵行开始的新通道。这很有可能标志着具有索引访问的简单数组不适合用于集合。

仍然是前 1-2 次通过简单数组的速度要快 2-3 倍。

原帖：

主题太多的话太简单了，无法检查。**毫无疑问，数组比任何类容器快几倍**。我在这个问题上运行，为我的性能关键部分寻找替代方案。这是我为检查实际情况而构建的原型代码：

```
import java.util.List;
import java.util.Arrays;

public class IterationTest {

    private static final long MAX_ITERATIONS = 1000000000;

    public static void main(String [] args) {

        Integer [] array = {1, 5, 3, 5};
        List<Integer> list = Arrays.asList(array);

        long start = System.currentTimeMillis();
        int test_sum = 0;
        for (int i = 0; i < MAX_ITERATIONS; ++i) {
//            for (int e : array) {
            for (int e : list) {
                test_sum += e;
            }
        }
        long stop = System.currentTimeMillis();

        long ms = (stop - start);
        System.out.println("Time: " + ms);
    }
} 
```

这是答案：

基于数组（第 16 行处于活动状态）：

```
Time: 7064 
```

基于列表（第 17 行处于活动状态）：

```
Time: 20950 
```

还有关于“更快”的评论吗？这个很好理解。问题是什么时候比 List 的灵活性快 3 倍对你来说更好。但这是另一个问题。顺便说一句，我也根据手动构建的`ArrayList`. 结果几乎一样。

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2009-04-04T11:42:25.573

请记住，ArrayList 封装了一个数组，因此与使用原始数组相比几乎没有区别（除了 List 在 java 中更容易使用这一事实）。

几乎只有当您存储原始数组（即字节、整数等）并且您需要通过使用原始数组获得的特定空间效率时，才会更喜欢数组而不是 ArrayList 才有意义。

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2009-04-04T14:29:45.157

在存储字符串对象的情况下，数组与列表的选择并不那么重要（考虑性能）。因为数组和列表都将存储字符串对象引用，而不是实际对象。

1.  如果字符串的数量几乎是恒定的，则使用数组（或 ArrayList）。但如果数量变化太大，那么你最好使用 LinkedList。
2.  如果需要（或将需要）在中间添加或删除元素，那么您当然必须使用 LinkedList。

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2012-10-19T11:10:24.480

如果您可以使用固定大小，数组将更快并且需要更少的内存。

如果您需要 List 接口的灵活性来添加和删除元素，那么问题仍然是您应该选择哪种实现。通常建议使用 ArrayList 并将其用于任何情况，但如果必须删除或插入列表开头或中间的元素，则 ArrayList 也存在性能问题。

因此，您可能想查看介绍 GapList的[http://java.dzone.com/articles/gaplist-%E2%80%93-lightning-fast-list 。](http://java.dzone.com/articles/gaplist-%E2%80%93-lightning-fast-list)这种新的列表实现结合了 ArrayList 和 LinkedList 的优势，从而为几乎所有操作带来了非常好的性能。

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2009-04-04T06:00:50.917

如果您事先知道数据有多大，那么数组会更快。

List 更灵活。您可以使用由数组支持的 ArrayList。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2009-04-04T06:41:18.700

“千”并不是一个大数字。几千个段落长度的字符串大小约为几兆字节。如果您只想连续访问这些，请使用[不可变的单链表](http://www.functionaljava.org/javadoc/4.5/functionaljava/fj/data/List.html)。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2010-09-11T14:57:15.457

取决于实施。原始类型数组可能比 ArrayList 更小、更高效。这是因为数组将值直接存储在连续的内存块中，而最简单的 ArrayList 实现将存储指向每个值的指针。尤其是在 64 位平台上，这会产生巨大的差异。

当然，对于这种情况，jvm 实现可能有一个特殊情况，在这种情况下性能将是相同的。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2013-12-04T22:54:25.910

List 是 java 1.5 及更高版本中的首选方式，因为它可以使用泛型。数组不能有泛型。数组也有一个预定义的长度，不能动态增长。初始化一个大尺寸的数组不是一个好主意。ArrayList 是用泛型声明数组的方式，它可以动态增长。但是如果删除和插入的使用频率更高，那么链表是最快的数据结构。

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2014-02-19T06:37:00.327

在任何地方都推荐使用数组而不是列表，尤其是在您知道项目数量和大小不会改变的情况下。

请参阅 Oracle Java 最佳实践：[http ://docs.oracle.com/cd/A97688_16/generic.903/bp/java.htm#1007056](http://docs.oracle.com/cd/A97688_16/generic.903/bp/java.htm#1007056)

当然，如果您需要多次从集合中添加和删除对象，则易于使用列表。

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2014-10-30T16:14:17.293

此处给出的许多微基准测试发现，对于数组/ArrayList 读取等操作只需几纳秒。如果所有内容都在您的 L1 缓存中，这是非常合理的。

更高级别的高速缓存或主内存访问可以具有类似 10nS-100nS 的数量级时间，而 L1 高速缓存更像是 1nS。访问 ArrayList 有一个额外的内存间接性，在实际应用程序中，您可以支付任何费用，从几乎从不到每次都支付，具体取决于您的代码在访问之间执行的操作。而且，当然，如果您有很多小的 ArrayList，这可能会增加您的内存使用量，并使您更有可能出现缓存未命中。

原贴好像只用了一个，短时间内就访问了很多内容，应该没什么大不了的。但是对于其他人来说可能会有所不同，在解释微基准时你应该小心。

然而，Java 字符串非常浪费，特别是如果您存储大量小字符串（只需使用内存分析器查看它们，对于几个字符的字符串来说似乎 > 60 字节）。一个字符串数组间接指向 String 对象，另一个间接指向 String 对象指向包含字符串本身的 char[]。如果有什么东西会破坏你的 L1 缓存，那就是这个，再加上成千上万个字符串。所以，如果你是认真的——真的是认真的——尽可能多地消除性能，那么你可以考虑以不同的方式去做。例如，您可以保存两个数组，一个 char[] 包含所有字符串，一个接一个，一个 int[] 与开头的偏移量。这将是一个可以做任何事情的 PITA，你几乎肯定不需要它。如果你这样做，你'

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2016-06-01T20:00:14.173

没有一个答案包含我感兴趣的信息 - 多次重复扫描同一阵列。必须为此创建一个 JMH 测试。

**结果**（Java 1.8.0_66 x32，迭代普通数组至少比 ArrayList 快 5 倍）：

```
Benchmark                    Mode  Cnt   Score   Error  Units
MyBenchmark.testArrayForGet  avgt   10   8.121 ? 0.233  ms/op
MyBenchmark.testListForGet   avgt   10  37.416 ? 0.094  ms/op
MyBenchmark.testListForEach  avgt   10  75.674 ? 1.897  ms/op 
```

**测试**

```
package my.jmh.test;

import java.util.ArrayList;
import java.util.List;
import java.util.concurrent.TimeUnit;
import org.openjdk.jmh.annotations.Benchmark;
import org.openjdk.jmh.annotations.BenchmarkMode;
import org.openjdk.jmh.annotations.Fork;
import org.openjdk.jmh.annotations.Measurement;
import org.openjdk.jmh.annotations.Mode;
import org.openjdk.jmh.annotations.OutputTimeUnit;
import org.openjdk.jmh.annotations.Scope;
import org.openjdk.jmh.annotations.State;
import org.openjdk.jmh.annotations.Warmup;

@State(Scope.Benchmark)
@Fork(1)
@Warmup(iterations = 5, timeUnit = TimeUnit.SECONDS)
@Measurement(iterations = 10)
@BenchmarkMode(Mode.AverageTime)
@OutputTimeUnit(TimeUnit.MILLISECONDS)
public class MyBenchmark {

    public final static int ARR_SIZE = 100;
    public final static int ITER_COUNT = 100000;

    String arr[] = new String[ARR_SIZE];
    List<String> list = new ArrayList<>(ARR_SIZE);

    public MyBenchmark() {
        for( int i = 0; i < ARR_SIZE; i++ ) {
            list.add(null);
        }
    }

    @Benchmark
    public void testListForEach() {
        int count = 0;
        for( int i = 0; i < ITER_COUNT; i++ ) {
            for( String str : list ) {
                if( str != null )
                    count++;
            }
        }
        if( count > 0 )
            System.out.print(count);
    }

    @Benchmark
    public void testListForGet() {
        int count = 0;
        for( int i = 0; i < ITER_COUNT; i++ ) {
            for( int j = 0; j < ARR_SIZE; j++ ) {
                if( list.get(j) != null )
                    count++;
            }
        }
        if( count > 0 )
            System.out.print(count);
    }

    @Benchmark
    public void testArrayForGet() {
        int count = 0;
        for( int i = 0; i < ITER_COUNT; i++ ) {
            for( int j = 0; j < ARR_SIZE; j++ ) {
                if( arr[j] != null )
                    count++;
            }
        }
        if( count > 0 )
            System.out.print(count);
    }

} 
```

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2020-11-04T08:21:10.180

使用哪一个取决于问题。我们需要看看大O。

[![列表和数组的大 O 值](https://i.stack.imgur.com/kQ9c5.png)](https://i.stack.imgur.com/kQ9c5.png)

图片来源：[https ://github.com/egonSchiele/grokking_algorithms](https://github.com/egonSchiele/grokking_algorithms)

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2009-04-04T06:39:46.987

如果没有适当的基准测试，不要陷入优化的陷阱。正如其他人建议的那样，在做出任何假设之前使用分析器。

您列举的不同数据结构有不同的用途。列表在开头和结尾插入元素非常有效，但在访问随机元素时会受到很多影响。阵列具有固定存储，但提供快速随机访问。最后，ArrayList 通过允许其增长来改进与数组的接口。通常，要使用的数据结构应该由如何访问或添加存储的数据来决定。

关于内存消耗。你似乎在混合一些东西。数组只会为您拥有的数据类型提供连续的内存块。不要忘记 java 有固定的数据类型：boolean、char、int、long、float 和 Object（这包括所有对象，甚至数组也是 Object）。这意味着如果您声明一个 String 字符串 [1000] 或 MyObject myObjects [1000] 的数组，您只会获得 1000 个足够大的内存盒来存储对象的位置（引用或指针）。您没有 1000 个足够大的内存盒来容纳对象的大小。不要忘记您的对象首先是用“new”创建的。这是当内存分配完成后，一个引用（它们的内存地址）存储在数组中。该对象不会被复制到数组中，只是它的引用。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2009-04-04T08:49:47.517

我不认为这对字符串有真正的影响。字符串数组中连续的是对字符串的引用，字符串本身存储在内存中的随机位置。

数组与列表可以对原始类型产生影响，而不是对象。*如果*您事先知道元素的数量，并且不需要灵活性，那么数百万个整数或双精度数的数组在内存中的效率和速度都比列表更有效，因为它们确实会被连续存储并立即访问。这就是为什么 Java 仍然使用字符数组作为字符串，使用整数数组作为图像数据等。

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2009-04-04T14:35:12.710

数组更快——所有内存都是预先分配好的。

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2012-07-25T21:53:41.880

这取决于您必须如何访问它。

存储后，如果您主要想做搜索操作，很少或没有插入/删除，然后选择 Array（因为在数组中搜索是在 O(1) 中完成的，而添加/删除可能需要重新排序元素） .

存储后，如果您的主要目的是添加/删除字符串，很少或没有搜索操作，那么选择 List。

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2016-02-22T06:24:49.800

> ArrayList 在内部使用数组对象来添加（或存储）元素。换句话说，ArrayList 由 Array 数据结构支持。ArrayList 的数组是可调整大小的（或动态的）。

**Array 比 ArrayList 快，**因为 ArrayList 内部使用数组。如果我们可以直接在 Array 中添加元素，并通过 ArrayList 间接在 Array 中添加元素，那么直接机制总是比间接机制更快。

ArrayList 类中有两个重载的 add() 方法：

1.  `add(Object)`: 将一个对象添加到列表的末尾。
2.  `add(int index, Object )`: 在列表中的指定位置插入指定对象。

**ArrayList 的大小如何动态增长？**

```
public boolean add(E e)        
{       
     ensureCapacity(size+1);
     elementData[size++] = e;         
     return true;
} 
```

上面代码中需要注意的重要一点是，在添加元素之前，我们正在检查 ArrayList 的容量。ensureCapacity() 确定当前占用元素的大小以及数组的最大大小。如果填充元素的大小（包括要添加到 ArrayList 类的新元素）大于数组的最大大小，则增加数组的大小。但是数组的大小不能动态增加。所以内部发生的是使用容量创建的新数组

直到 Java 6

```
int newCapacity = (oldCapacity * 3)/2 + 1; 
```

（更新）从 Java 7

```
 int newCapacity = oldCapacity + (oldCapacity >> 1); 
```

此外，旧数组中的数据被复制到新数组中。

在 ArrayList 中有开销方法，这就是 Array 比`ArrayList`.

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2016-06-09T20:12:32.273

数组 - 当我们必须更快地获取结果时总是会更好

列表 - 执行插入和删除的结果，因为它们可以在 O(1) 中完成，这也提供了轻松添加、获取和删除数据的方法。更容易使用。

但请始终记住，当存储数据的数组中的索引位置已知时，数据的获取会很快。

这可以通过对数组进行排序来很好地实现。因此，这增加了获取数据的时间（即，存储数据 + 排序数据 + 寻找找到数据的位置）。因此，这增加了从数组中获取数据的额外延迟，即使它们可能擅长更快地获取数据。

因此，这可以通过 trie 数据结构或三元数据结构来解决。如上所述，trie 数据结构在搜索数据时非常有效，可以在 O(1) 量级内完成对特定单词的搜索。当时间很重要时，即；如果您必须快速搜索和检索数据，您可以使用 trie 数据结构。

如果您希望减少内存空间的消耗并且希望获得更好的性能，那么请使用三元数据结构。这两者都适合存储大量字符串（例如，字典中包含的单词）。

* * *

## 回答 #32

> 赞同：-4
> 
> 时间：2009-04-04T06:28:53.033

List 更灵活.... List 比数组更好

# iphone - 如何使用纹理中的 z 坐标？

> ID：716600
> 
> 赞同：0
> 
> 时间：2009-04-04T05:59:37.520
> 
> 标签：iphone

如何在 iphone openGl 中使用纹理中的 z 坐标。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-04T08:05:21.617

z 坐标仅对 3d 纹理（相当不寻常）或立方体贴图有用，后者更为流行（用于创建环境映射、反射等）。

对于后一种情况，三个坐标代表一个单位矢量，指向单位球面上的一个点；正确的纹素会自动检索。

# asp.net - WebForms 应用程序中的 ASP.Net MVC 视图

> ID：716606
> 
> 赞同：3
> 
> 时间：2009-04-04T06:09:01.303
> 
> 标签：asp.net, asp.net-mvc

我正在向 ASP.Net webforms 应用程序添加功能，我们决定新的开发将通过 MVC 完成，以期最终将所有功能转移。

显然，在通过 URL 访问 MVC 操作时，MVC 和 WebForms 可以很好地配合使用。但是，我想在 WebForm 页面上的现有选项卡 (telerik) 控件中显示 MVC 视图。此视图将使用 js/css 文件，因此也需要考虑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-04T13:12:32.033

好吧，我会使用 jquery/js 在页面加载/选择选项卡上动态加载选项卡。如果将 js 函数添加到所需的处理程序，您可以触发 ajaxGet 以从 MVC 操作 URL 检索 html。

如果需要，我可以获得一些示例代码。您在 ASP.Net 应用程序或 MSAJAX 中使用 jQuery 吗？

干杯伊恩

# c# - 用于填充 WinForms ListView 的初学者实体框架查询

> ID：716607
> 
> 赞同：1
> 
> 时间：2009-04-04T06:09:39.227
> 
> 标签：c#, winforms, entity-framework, listview

我刚刚开始学习如何使用实体框架来编写一个非常简单的 C# 网络监控程序 - 这是一个学习练习，尝试“开车回家”我迄今为止只读过的内容。我也是 C# 和 LINQ 的新手（只是为了让事情进一步复杂化。）

我相信我已经对数据模型进行了适当的规范化，但我可能错了。Visual Studio 生成一个看起来不错的概念模型。我已经在必要时对关联和实体集进行了复数化，但我正在努力执行我认为对数据进行的相当基本的查询/投影。

该数据库包含 3 个表：

```
[Server]    - A server defined by the user that should be pinged.
ServerID    - primary key
HostAddress - IP or hostname

[Result]    - A result containing data about the last server test
ResultID    - primary key
ServerID    - foreign key on [Server].[ServerID]
StateID     - an integer used to lookup one of 3 possible Server states
TimeStamp   - Time stamp of last ping

[State]     - A lookup table containing an integer -> string mapping.
StateID     - a unique key
StateLabel  - human-readable string like "unreachable" or "OK" or "timeout" 
```

我已经使用一些简单的条目手动填充了数据库 - 足以给我一些可以使用的东西。

对于初学者，我想在 WinForm 上的 ListView 中显示所有结果数据。ListView 包含以下静态列：

状态 | 服务器地址 | 最后检查

理论上，ListView 的数据需要通过对 3 个表中的每一个进行投影（？）来生成：

*   “State”列应显示从 [Result].[StateID] 链接的人类可读的 [State].[StateLabel]
*   “服务器地址”列应显示从 [Result].[ServerID] 链接的 [Server].[HostAddress]
*   “上次检查”列应显示 [Result].[TimeStamp]

**由于我不需要 ObjectServices 的对象实现和/或更改跟踪功能，我是否认为使用 Entity SQL/EntityClient 和 DbDataReader 会更有效/正确？如果是这样，合适的 Entity SQL 查询应该是什么样的？**

对于它的价值，我尝试在一个方法中使用 LINQ to Entities 和匿名类型，但由于对合适的返回类型缺乏理解而受阻：

```
var results = from r in _context.Result
select new
{
    State = (from s in _context.State
         where s.StateId == r.StateId
         select s.StateLabel),
    r.ServerReference.Value.HostAddress,
    r.TimeStamp
};

return results.ToList(); // <- No can do. 
```

谢谢你的帮助！

史蒂夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-04T06:29:41.363

`object`好吧，除非您将它们强制转换为并让签名将返回类型定义为`List<object>`（或合适的接口），否则您将无法返回匿名类型列表。您的另一个问题是 State 的子查询实际上将返回一个`IQueryable`而不是单个条目（您可以使用`First`使用 EF 的扩展方法来获取第一个匹配项。）尽管如果您具有外键关系，则模型也应该为状态设置导航属性，并且您应该能够使用附加的属性而不是子查询。因此，如果您希望将此作为返回对象列表的方法调用，则必须创建一个表示转换或向下转换为对象的类型。否则，您可以在尝试绑定列表的表单级别执行此操作（这完全取决于您的需要）。

```
public List<object> GetStuff()
{
    var results = from r in _context.Result
    select new
    {
        State = r.StateNavigationProperty.StateLabel, //If FK
        State = _context.State.First(state => state.StateId == r.StateId), //If Not FK
        HostAddress = r.ServerReference.Value.HostAddress,
        TimeStamp = r.TimeStamp
    };

    return results.Cast<object>().ToList();
}

...

myListView.DataSource = GetStuff(); 
```

就像我说的那样，另一种选择是为转换创建一个类或将列表直接绑定到查询。

```
public class SimpleStuff
{
    public string State { get; set; }
    public string HostAddress { get; set; }
    public DateTime TimeStamp { get; set; }
} 
```

然后只需将类添加到`select new`ala`select new SimpleStuff`并更改方法签名以反映类并删除返回中的强制转换。

# c# - 在 C# 中将“this”参数命名为扩展方法时，您更喜欢用什么习惯用法（如果有），为什么？

> ID：716609
> 
> 赞同：11
> 
> 时间：2009-04-04T06:11:10.487
> 
> 标签：c#, .net, c#-3.0, extension-methods, idioms

C# 扩展方法的第一个参数是调用扩展方法的实例。我采用了一个习惯用法，在别处没有看到它，称该变量为“自我”。如果其他人也使用它，我一点也不感到惊讶。这是一个例子：

```
public static void Print(this string self)
{
   if(self != null) Console.WriteLine(self);
} 
```

但是，我开始看到其他人将该参数命名为“@this”，如下所示：

```
public static void Print(this string @this)
{
   if(@this != null) Console.WriteLine(@this);
} 
```

作为第三种选择，有些人根本不喜欢任何成语，说“self”和“@this”不提供任何信息。我想我们都同意，*有时*参数有一个明确、有意义的名称，特定于它的目的，这比“self”或“@this”更好。有些人走得更远，说你*总能*想出一个更有价值的名字。所以这是另一个有效的观点。

**你还见过哪些成语？你喜欢什么成语，为什么？**

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-04T06:26:53.087

根据用途，我很正常地命名它。因此，“source”表示 LINQ 运算符的源序列，或“argument”/“parameter”表示进行参数/参数检查的扩展等。

我不认为它必须与“this”或“self”特别相关——这并没有提供关于参数*含义*的任何额外信息。当然这是最重要的。

编辑：即使在没有很多明显含义的情况下，我更喜欢*some* meaning to *none*。“self”或“@this”赋予了哪些信息？仅仅是它是扩展方法中的第一个参数 - 并且该信息已经通过参数装饰的事实显而易见`this`。`theStringToPrint`在给出/选项的示例情况下`self`，我会改用`outputText`它 - 它传达了您需要了解的有关参数 IMO 的所有信息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-04T13:48:07.627

如果它是一个普通的旧静态方法，我会准确地命名变量。原因是它仍然可以作为静态方法调用，您必须在代码中考虑该用例。

看待这一点的最简单方法是参数验证。考虑将 null 传递到您的方法中的情况。您应该进行参数检查并抛出 ArgumentNullException。如果它实施得当，您需要像这样将“this”作为参数名称。

```
public static void Print(this string @this) {
  if ( null == @this ) {
    throw new ArgumentNullException("this");
  }
  ...
} 
```

现在有人正在对你的库进行编码，突然得到一个异常对话框，上面写着“这是空的”。他们会最困惑:)

这是一个人为的例子，但总的来说，我对待扩展方法与普通的旧静态方法没有什么不同。我发现这让他们更容易推理。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-04T06:15:30.150

我见过使用 obj 和 val 。我不喜欢这个。我们应该尽量避免使用关键字。我从未见过自己，但我喜欢它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-04T07:13:57.387

我称它为“目标”，因为扩展方法将对该参数进行操作。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-04T13:25:37.540

我认为应该避免使用 @this，因为它使用了有史以来最无用的语言特定功能 (@)。事实上，应该避免任何可能导致混淆或降低可读性的事情，例如关键字出现在它们不是关键字的地方。self 让我想起了 python，但可能有利于一致的命名约定，因为很明显它指的是正在使用的实例，而不需要一些讨厌的句法技巧。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-04T06:22:10.960

你可以做这样的事情......

```
public static void Print(this string extended)
{
   if(extended != null) Console.WriteLine(extended);
} 
```

# php - 您在 joomla 中是否有每个用户模块的下载命中计数器？

> ID：716611
> 
> 赞同：0
> 
> 时间：2009-04-04T06:11:24.590
> 
> 标签：php, javascript, performance, joomla

在我的项目中，有一个下载按钮。如果用户点击下载按钮，我将显示下载次数。

是否有任何模块用于下载命中计数器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-04T06:43:59.363

这 2 个模块支持下载计数器，但需要以特定方式托管内容：

*   [http://www.rocketwerx.com/products/rokdownloads/overview](http://www.rocketwerx.com/products/rokdownloads/overview)
*   [http://extensions.joomla.org/extensions/directory-&-documentation/downloads/3115/details](http://extensions.joomla.org/extensions/directory-&-documentation/downloads/3115/details)

# .net - 如何制作 .Net 或 JVM 语言？

> ID：716613
> 
> 赞同：13
> 
> 时间：2009-04-04T06:12:57.223
> 
> 标签：.net, compiler-construction, jvm

我看到了所有这些用于 .NET 和 JVM 的新语言。一个人如何开始制作一个？

我找不到任何关于 JVM 或 MSIL 规范的好的文档。

**编辑**

我已经知道如何解析，我更感兴趣的是如何有这么多人制作基于这些平台的新语言。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-04T06:19:30.437

你有点走运。为 .NET 开发的语言呈爆炸式增长，并且有针对像您这样的个人的文章/资源（不仅仅是有大量资金可以投资的大公司）。

搜索“动态语言运行时”，然后从那里开始。

以下是一些链接：

[IronPython 背后的大脑家伙的博客](http://blogs.msdn.com/hugunin/archive/2007/04/30/a-dynamic-language-runtime-dlr.aspx)

[动态语言运行时之家](http://www.codeplex.com/dlr)

[一篇关于 IronPython 是如何实现的文章](http://msdn.microsoft.com/en-us/magazine/cc163344.aspx)

[一篇关于抽象语法树和 DLR 的博文](http://blogs.msdn.com/mmaly/archive/2008/01/14/building-a-dlr-language-trees.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-04T06:16:25.827

[Java 虚拟机规范，第二版](http://java.sun.com/docs/books/jvms/second_edition/html/VMSpecTOC.doc.html)可在线获取。

可以通过编写一个生成 Java 字节码（在 JVM 规范中定义）的编译器来定位 JVM。

或者，通过利用[Apache BCEL](http://jakarta.apache.org/bcel/)等现有库，可以通过 Java 程序生成有效`class`文件，而无需在字节级别实际操作字节码。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-04T06:35:20.787

MSIL 不再称为 MSIL，作为公共标准，它是 CIL（通用中间语言），是 CLI（通用语言基础设施）标准的一部分。

这是[ECMA-335 CLI](http://www.ecma-international.org/publications/standards/Ecma-335.htm)标准规范。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-04T07:53:51.443

回答更新的问题：

> 我已经知道如何解析，我更感兴趣的是如何有这么多人制作基于这些平台的新语言。

使这么多人能够为这些平台开发语言的原因可能是有几个非常完整的示例以及可公开获得的源代码。

平台的规范可供下载，并且已经有编写编译器经验的人很快就会为他们现有的编译器生成针对新平台的新后端。

微软自己发布了[Rotor](http://www.c-sharpcorner.com/UploadFile/kristoferkrause/GuidetoMSsharedSourceCLI11302005232759PM/GuidetoMSsharedSourceCLI.aspx)，当然也有[Mono](http://www.mono-project.com/Main_Page)。还有许多流行的运行时代码生成技术，它们可以即时构建简单的包装类——这些也是迷你编译器。

C# 编译器非常快，并且以直接的方式公开了 CLR 的大部分功能，因此您可以编写一个编译器来简单地生成临时 C# 文件，然后让 C# 编译器完成这项工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-04T07:04:52.153

对于 .NET，您可以使用 DLR 的表达式树，甚至可以编译为现有的高级语言，如 C# 或 Java，然后对其进行编译。一些高级非 VM 语言（如 Haskell 和 Eiffel）编译为 C。如果您想编译为 MSIL 或 JVM 字节码，您可以使用[Mono.Cecil](http://www.mono-project.com/Cecil)或[BCEL](http://jakarta.apache.org/bcel/)使这更容易做到。

# .net - UDP、NAT 和设置“连接”

> ID：716620
> 
> 赞同：13
> 
> 时间：2009-04-04T06:19:21.967
> 
> 标签：.net, udp, nat, nat-traversal

我知道“连接”这个词在谈论 UDP 时并不合适，但是......

服务器（具有已知 IP 的服务器）如​​何通过 Internet 将其 UDP 数据包发送到位于 NAT 后面的客户端？

例如：假设客户端使用 TCP 上的一些消息连接并验证服务器。此时，服务器已准备好开始通过 UDP 将数据流式传输到客户端，但服务器如何知道将 UDP 数据包寻址到何处，以便它们可以通过任何 NAT 路由器到达客户端？

如果客户端通过 UDP 发送“我已准备好进行流式传输”消息，NAT 路由器是否会保持端口打开，以便服务器可以使用其 UDP 数据流进行响应？

还是我在这里偏离轨道？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-04T08:52:46.013

忽略在您的路由器（提供 NAT）中提供已知端口转换（即*此*端口上的数据*到此*地址），您可以使用[UDP Hole Punching](http://en.wikipedia.org/wiki/UDP_hole_punching)。

我假设您不是在谈论[多播](http://en.wikipedia.org/wiki/Multicast)，其中每个对等方都加入一个组并向感兴趣的各方（在这种情况下是路由器）宣布，然后可以执行适当的路由。尽管这通常用于将流量有效地路由到多个主机，但按组路由机制将适用于您在上面描述的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T08:54:26.150

通常，客户端前面的 TCP 级别的 NAT 将能够确定 UDP 上的连接已创建。话虽如此，客户端的 NAT 必须配置为接受来自 SRC 服务器端口的 UDP 数据包，然后将它们转发到内部目标 IP（客户端）。如果 NAT 是谁是呼叫者，谁是被呼叫者，请记住重要的事情。NAT 在实现和功能上有所不同，因此您可能想要实现一个易于实现的通用解决方案，具体取决于您的需要。

我认为，您的假设是正确的，在您的情况下，客户端将无法接收信息中的 UDP 流。在您的情况下，您的客户端必须将其 WAN IP 发送到您的服务器以启动 UDP 连接。找到您的客户 WAN IP 可能会很棘手，但是有些网站可以通过在文本页面中返回它来帮助您确定您的 WAN IP。

如果 UDP 连接是在 TCP 连接之后由服务器向客户端打开一个已知 UDP 端口的套接字创建的，那么 UPnP 可能值得研究一下，它将允许您在 NAT 上自动设置端口转发，这只是如果您的 NAT 像 DSL 路由器一样支持 UPnP。

一个工作是让客户端打开服务器的 TCP 和 UDP 套接字。由于 NAT 后面的客户端发起了连接，因此 TCP 和 UDP 连接的状态都将添加到 NAT 的连接表中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-04T09:32:20.347

如果您在谈论像 SIP 或 RTSP 这样的流协议，那么它的工作方式是客户端希望服务器发送到的 UDP 端口在呼叫建立请求中指定。

服务器将发送到该端口，流量可能会或可能不会通过客户端，这取决于 NAT 是否已将客户端选择的端口转换为不同的数字。

当服务器从客户端接收到它的第一个 UDP 流数据包时，如果它在与它发送的端口不同的端口上，那么它将切换到它。这使得来自服务器的 UDP 可以通过 NAT，因为客户端已经通过发送到服务器来创建 NAT 映射。

# c# - 如何制作可调整大小的矩形选择工具？

> ID：716626
> 
> 赞同：6
> 
> 时间：2009-04-04T06:24:03.780
> 
> 标签：c#, user-interface, qt, qt4

我正在尝试使用 C# 2008 或 QT4 编写一个非常简单的照片编辑器。

如何制作像 Photoshop 一样的可调整大小的矩形选择工具？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-04T06:50:27.350

如果您谈论的是“经典”“橡皮筋”类型的选择矩形，请查看[如何在 Visual C# 中绘制橡皮筋矩形或焦点矩形](http://support.microsoft.com/kb/314945)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-04T07:14:50.367

WPF 代码示例：[http ://www.codeproject.com/KB/WPF/wpfmarchingants.aspx?display=Print](http://www.codeproject.com/KB/WPF/wpfmarchingants.aspx?display=Print)

这个有点复杂，因为它涉及到图像裁剪，但是如果你向下滚动到选择矩形，你可以看到计算矩形的基本公式：http: [//69.10.233.10/KB/WPF/ImageCropper.aspx](http://69.10.233.10/KB/WPF/ImageCropper.aspx)

最后，另一个使用 GDI：[http ://codelog.blogial.com/2008/10/31/rubber-band-selection-rectangle-in-c/](http://codelog.blogial.com/2008/10/31/rubber-band-selection-rectangle-in-c/)

如果您提供更多细节，我相信我们可以为您提供更多帮助。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-04T19:40:00.217

Qt 有一个类：

[http://doc.trolltech.com/4.5-snapshot/qrubberband.html](http://doc.trolltech.com/4.5-snapshot/qrubberband.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-04T06:54:01.820

我不知道具体的电话，但想法是这样的：

您想绘制一个带有不透明或虚线边框的透明矩形。单击鼠标按钮时会出现矩形。按住按钮时，矩形的尺寸会随着鼠标的移动而改变，左上角的点位于单击按钮的位置，右下角跟随鼠标移动。释放按钮会使矩形在选择区域上固定其位置。

您应该能够从 C# 命名空间上的资源中找出详细信息`Drawing`。

# javascript - 在 JavaScript 库中不抛出错误

> ID：716628
> 
> 赞同：1
> 
> 时间：2009-04-04T06:25:43.167
> 
> 标签：javascript, error-handling, mootools

在[MooTools](http://mootools.net/)的首页上，它说：

> MooTools 代码遵守严格的标准，不会发出任何警告。

我喜欢 MooTools，但最近阅读[了 The art of throwing JavaScript errors](http://www.nczonline.net/blog/2009/03/03/the-art-of-throwing-javascript-errors/)，我有点困惑为什么“不抛出任何警告”是一项功能。如果库在出现错误时没有告诉您（这可能是因为您使用不正确造成的），您将如何解决问题？

为什么不希望库抛出错误？

谢谢，

史蒂夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-04T06:28:16.657

由于规则被弯曲以实现跨浏览器支持，一些 javascript 框架会抛出警告。我相信 MooTools 的说法是他们不会在这个意义上向浏览器发出任何警告，而不是你做错了什么。

例如[http://groups.google.com/group/jquery-dev/browse_thread/thread/f2926d95fcafb18](http://groups.google.com/group/jquery-dev/browse_thread/thread/f2926d95fcafb18)

# c# - 如何在 ASP.NET MVC 控制器中访问 Request.cookies？

> ID：716636
> 
> 赞同：29
> 
> 时间：2009-04-04T06:29:43.657
> 
> 标签：c#, asp.net-mvc

我正在尝试通过一个通用控制器文件获取存储在 cookie 中的用户 ID，我可以在整个站点中访问该文件。

我创建`FunctionsController`了一个控制器，内容如下：

```
public static int loggedinUser()
{
    return Convert.ToInt32(  request.Cookies["userid"].Value);
} 
```

即使我尝试了以下方法，我也无法请求任何 cookie 项：

```
HttpRequestBase request = controllerContext.HttpContext.Request; 
```

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-04-04T06:36:19.007

使用标准访问语句访问 ASP.NET MVC 中的 cookie 没有问题，例如：

```
Request.Cookies["someCookie"] 
```

您的样本在“request.Cookies”中有一个小写的“r”。那会是你的问题吗？

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2011-08-07T15:43:50.157

删除`static`方法声明的一部分，然后使用`Request.Cookies["userId"]`

# orm - 为什么使用数据库迁移而不是版本控制模式

> ID：716637
> 
> 赞同：16
> 
> 时间：2009-04-04T06:30:19.303
> 
> 标签：orm, migration

迁移无疑比仅仅启动 phpMyAdmin 并随意更改模式（就像我在 php 时代所做的那样）要好，但在使用它们一段时间后，我认为它们存在致命缺陷。

**版本控制是一个已解决的问题。**迁移的主要功能是保留数据库更改的历史记录。但是为每个更改存储一个不同的文件是一种笨拙的跟踪它们的方法。`post.rb`当您想要添加新的*虚拟*属性时，您不会创建新版本（或表示增量的文件） - 为什么要在想要添加新的非虚拟属性时创建新的迁移？

换句话说，就像您签`post.rb`入版本控制一样，为什么不将 schema.rb 签入版本控制并直接对文件进行更改？

这在功能上与为每个 delta 保留一个文件相同，但使用起来要容易得多。我的心智模型是“我希望表 X 有这样那样的列（或者说真的，我希望模型 X 有这样那样的属性）”——你为什么要从现有的模式中推断出如何到达那里？只需打开`schema.rb`并为表 X 提供正确的列！

但即使是类包装表的想法也是一个实现细节！为什么我不能敞开心扉`post.rb`说：

```
 Class Post
    t.string :title
    t.text :body
 end 
```

如果您使用这样的模型，您必须决定如何处理现有数据。`down`但即便如此，迁移还是过大了——当你迁移数据时，当你使用迁移的方法时，你会失去保真度。

无论如何，我的问题是，**即使你想不出更好的方法，迁移是不是有点恶心？**

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-04T06:58:11.200

> 为什么不将 schema.rb 检查到版本控制中并直接对文件进行更改？

因为数据库本身与版本控制不同步。

例如，您可能正在使用源代码树的头部。但是您正在连接到一个被定义为某个过去版本的数据库，而不是您已签出的版本。迁移允许您以增量方式将数据库模式从任何版本升级或降级到任何版本。

但要回答你的最后一个问题，是的，迁移有点恶心。他们在另一个版本控制系统之上实施了一个冗余版本控制系统。然而，这些版本控制系统都没有真正与数据库同步。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-04T15:21:14.737

套用其他人所说的话：迁移允许您在架构发展时保护**数据。**`schema.rb`仅在您的应用程序投入生产之前，维护单个文件的概念才有吸引力。此后，您将需要一种在架构更改时*迁移现有用户数据的方法。*

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-04T07:26:38.137

还有一些与数据相关的问题需要考虑，迁移可以解决这些问题。

假设我的架构的旧版本有一个`feet`and`inches`列。出于效率目的，我想将其组合成一个`inches`列，以使排序和搜索更容易。

我的迁移可以在更新数据库时（即在删除`feet`列之前）将所有英尺和英寸数据合并到英寸列（英尺 * 12 + 英寸）

显然，这是在迁移中，当您稍后将更改应用到生产数据库时，它会自动工作。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-04T08:39:11.053

就目前而言，它们令人讨厌且不足，但很可能是我们目前可用的最佳选择。相当多的聪明人已经花费了相当多的时间来解决这个问题，到目前为止，这是他们所能想到的最好的。经过大约 20 年的手动编码数据库版本更新，当我发现 ActiveRecord 时，我很快意识到迁移是一项重大改进。

正如您所说，版本控制是一个已解决的问题。在某种程度上，我同意：特别是对于文本文件，它非常适合，对于其他文件类型则不太适用，对于数据库等资源来说，根本不是很多。

如果您将迁移视为数据库的版本控制增量，迁移看起来如何？它们是从一个版本到另一个版本所必须应用的增量的总和。我不知道即使 git 具有超强的功能，也可以获取两个模式文件并生成必要的 DDL 来执行此操作。

至于在模型中声明表格内容，我相信这就是 DataMapper 所做的（没有个人经验）。我认为那里可能还有一些 DDL 推理功能。

“就算你想不出更好的办法，迁移是不是有点恶心？”

是的。但它们比我们拥有的任何其他东西都少。请在您完成非毛替代方案后告知我们。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-04T07:30:06.820

我想考虑到“即使你想不出更好的方法”，那么是的，从总体上看，迁移有点恶心。Ruby、Rails、ORM、SQL、Web 应用程序也是如此……

迁移具有它们存在的（并非微不足道的）优势。粗略但存在往往胜过愉快但不存在。我敢肯定，迁移数据可能有令人愉快且不存在的方法，但我不确定这意味着什么。:-)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-04T15:12:33.743

好的，我将在这里进行疯狂的猜测，并说您可能正在独自工作。在一个小组开发项目中，每个人对他/她对开发人员正在编写的代码所需的数据库的更改负责的权力要重要得多。

另一种选择是，更大的程序员群体（例如，我工作的 10-15 名 Java 开发人员）最终依靠几个专门的全职数据库管理员来完成这项工作以及他们的其他维护、优化等职责。

# c++ - 将 C++ LPCWSTR 打印到文件

> ID：716653
> 
> 赞同：3
> 
> 时间：2009-04-04T06:41:58.340
> 
> 标签：c++, windows

我正在尝试将 LPCWSTR 值打印到文件中，但它只打印地址，而不是值。

我试过取消引用变量（使用*）来获取值，但这也不起作用。

如何打印值？

```
void dump(LPCWSTR text){

  ofstream myfile("C:\\myfile.txt", ios::app );
  myfile << text << endl;
  myfile.close();

} 
```

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-04T06:46:00.933

使用`wofstream`(basic_ofstream)。这将起作用的原因是因为`w`std 流的版本旨在处理宽字符串和数据。您使用的窄版本会看到一个宽字符串，其中可能包含一些嵌入的空值，并且会认为它是字符串的结尾。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T07:12:04.320

wofstream 将生成一个也是 unicode（没有 BOM）的输出。这可能不是布赖恩想要的。

不幸的是，如果您希望文件是 8 位字符，那么您将跳出 C++ 字符串并将 unicode 字符串转换为 8 位字符。

您可以使用[wcstombs](http://msdn.microsoft.com/en-us/library/s7wzt4be(VS.80).aspx)将字符串转换为 8 位字符。转换是在当前语言环境中完成的，因此请确保您使用[setlocale](http://msdn.microsoft.com/en-us/library/x99tb11d(VS.80).aspx)以确保您的转换发生在正确的语言环境中。不幸的是，setlocale 的文档表明它无法转换为 UTF-8 :(

# php - PHP - 在 MySQL 数据库中存储文本

> ID：716656
> 
> 赞同：6
> 
> 时间：2009-04-04T06:42:52.907
> 
> 标签：php, mysql, text, html-encode

我的网站上有一个文本框，我需要存储用户输入到我的数据库中的任何内容，并在以后检索它。我需要完全按照用户输入的方式存储它，包括特殊字符、回车符等。

我应该在 PHP 中使用什么过程将其存储在我的数据库字段（这是一个“文本”字段）中？我应该使用 PHP 的 html_encode 还是类似的东西？

谢谢你。

编辑：我还需要存储正确的格式，即制表符和多个空格。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-04T06:52:43.943

使用[mysql_real_escape_string()](http://us2.php.net/manual/en/function.mysql-real-escape-string.php)：

```
$safetext = mysql_real_escape_string($_POST['text']);
$query = "INSERT INTO my_table (`my_field`) VALUES ('$safetext')";
mysql_query($query); 
```

那应该行得通。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-04T07:02:03.907

在将数据写入数据存储时，您不应该对数据进行 html 编码 - 这样您也可以将数据用于其他用途（例如电子邮件、PDF 文档等）。正如[Assaf](https://stackoverflow.com/questions/716656/php-storing-text-in-mysql-database/716661#716661)已经说过的：通过转义输入或使用参数化插入查询来避免 SQL 注入是强制性的。

您应该，不，比方说，在 HTML 页面上显示数据时**必须对数据进行 html 编码！**这将使危险的 HTML 或 Javascript 代码变得无用，因为数据中存在的 HTML 标记将不再被浏览器识别为 HTML 标记。

当您允许用户发布带有 HTML 标记的数据时，该过程会稍微复杂一些。然后，您必须跳过输出编码以支持输入清理，这可能是任意复杂的，具体取决于您的需要（例如允许的标签）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-04T06:48:33.783

您不必对其*进行*编码即可将其存储在 mysql 中。

确保使用参数化插入命令，以避免 SQL 注入。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-04T06:50:58.067

以下应该有效：

```
if (get_magic_quotes_gpc()) {
  $content = stripslashes($content);
}
$content = mysql_real_escape_string($content); 
```

如果您的列是 utf8，那么特殊字符应该不会有问题。正确格式化内容后，您可以使用标准插入方法将其提供给 mysql。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-04-01T15:36:02.137

除了格式之外，要正确存储用户文本，您所要做的就是使用 . 将所有换行符转换为换行符`nl2br($inputtext)`。在过滤输入后执行此操作。

# c++ - 重载 = 在 C++ 中

> ID：716658
> 
> 赞同：1
> 
> 时间：2009-04-04T06:44:37.990
> 
> 标签：c++, operator-overloading

我正在尝试重载赋值运算符，如果可以的话，我想清除一些事情。

我有一个非成员函数，`bool operator==( const MyClass& obj1, const myClass& obj2 )`定义在我的班级之外。

由于显而易见的原因，我无法接触到我的任何私人成员。

所以我认为我需要做的是重载赋值运算符。并在非成员函数中进行赋值。

话虽如此，我认为我需要执行以下操作：

1.  使用我的功能并使用`strcpy`or复制信息`strdup`。我用过`strcpy`。
2.  转到赋值运算符， bool MyClass::operator=( const MyClass& obj1 );
3.  现在我们转到函数重载 (==) 并将 obj2 分配给 obj1。

我没有复制构造函数，所以我坚持这些：

```
class Class
{
private:
m_1;
m_2;
public:
..
};

void Class::Func1(char buff[]) const
{   
    strcpy( buff, m_1 );
    return;
}
void Class::Func2(char buff[]) const
{
    strcpy( buff, m_2 );
    return;
}

bool Class& Class::operator=(const Class& obj)
{ 
    if ( this != &obj ) // check for self assignment.
    {
        strcpy( m_1, obj.m_1 ); 
        // do this for all other private members.
    }
    return *this;
}

bool operator== (const Class& obj1, const Class& obj2)
{
         Class MyClass1, MyClass2;
    MyClass1 = obj1;
    MyClass2 = obj2;

         MyClass2 = MyClass1;
         // did this change anything?
// Microsofts debugger can not get this far.
    return true;
} 
```

因此，您可能会说，我完全迷失在这种超载中。有小费吗？我确实有一个完整的版本重载了相同的运算符，只有`::`，所以我的私人成员不会失去作用域。我将我的作业返回为 true，它适用于`main`. 这是我书中的例子。

重载赋值运算符然后在`operator==`非成员函数中进行转换是否有效？完成该步骤后，我能否在 main 中相互分配对象？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-04T07:02:28.977

您在这里有几个明显的错误，并且对您实际尝试实现的目标有些困惑。首先，赋值运算符`operator =`旨在将值从一个实例复制到另一个实例。赋值运算符的返回值几乎总是对副本目标的非常量引用，因此您可以链接赋值：

```
Class & operator=(const Class &rhs)
{
  // copy the members

  return *this;
} 
```

比较运算符`operator ==`旨在执行两个实例的比较。如果它们相等，则返回布尔值 true：

```
boolean operator==(const Class &rhs) const
{
  // check if they are equal
  return something;
} 
```

令人困惑的是，您为什么要尝试复制值，或者分配给比较运算符中的实例？

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-04T06:58:57.627

Op== 不是赋值运算符。T& Op= (const T&) 是。

bool operator==(const T& lhs, const T& rhs) 是比较两个T的操作。如果 lhs 等于 rhs，它返回 true，无论你想编写什么“等于”定义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T07:06:27.890

我不确定我是否正确理解了这个问题。但是，如果您尝试使用非成员函数检查相等性并且仅因为您无法访问类的私有成员而不能这样做，那么您可以将非成员函数声明为友元函数并使用它像这样：

```
class Test
{
public:
    Test(int i) : m_i(i){}
private:
    int m_i;

    friend bool operator==(Test&  first, Test& second);
};

bool operator==(Test&  first, Test& second)
{
    return first.m_i == second.m_i;
}

int main()
{
   Test t1(10), t2(10);
   bool b = (t1 == t2);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-04T07:42:54.777

我猜你想比较这两个对象。在这种情况下，您可以在“Class”类中重载运算符 ==。您不需要赋值运算符。

```
 class Class
    {
    public:
        Class(int i) : m_i(i){}

         bool operator==( const Class& rhs)
         {
            return m_i == rhs.m_i;
         }
    private:
        int m_i;

    };

int main()
{
   Class t1(10), t2(10);
   bool b = (t1 == t2);
} 
```

# java - 带有 j2me 客户端套接字的 Java tcp 套接字服务器

> ID：716662
> 
> 赞同：2
> 
> 时间：2009-04-04T06:48:52.910
> 
> 标签：java, sockets

我想创建可以相互通信的 java 服务器套接字和 j2me 客户端套接字。

有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-04T12:55:49.377

您是否尝试在一部手机上运行的两个 MIDlet 之间共享数据？

您是否正在尝试在手机和远程服务器之间交换数据？

您是否阅读过 javax.microedition.io 包的文档？

# msbuild - 如何使用 MSBuild 运行 MSUnit 测试

> ID：716668
> 
> 赞同：5
> 
> 时间：2009-04-04T06:53:48.200
> 
> 标签：msbuild, mstest

我有一个类似于以下内容的 MSBuild 脚本：

```
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    <Target Name="Build">

        <MSBuild Projects="MyProject.UnitTest.sln" Targets="Build" />

    </Target>
</Project> 
```

如何运行解决方案中的 MSTest 单元测试？

我正在寻找类似于可以在 TFS Build 中使用的东西：

```
<TestContainerInOutput Include="%2a%2a\%2aTest.dll" /> 
```

# csv - 使用多个工作表从 .csv 上传数据

> ID：716671
> 
> 赞同：0
> 
> 时间：2009-04-04T06:55:19.757
> 
> 标签：csv, spreadsheet

谁能告诉我如何将 .csv 文件中的数据上传到一个网页上，该网页有 4 个具有不同数量和行数据的工作表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-04T07:46:21.320

您必须编写一个 PHP 脚本或另一种编程语言的脚本，该脚本将读取 .csv，然后`<table>s`在网页上显示数据。

# c# - 如何从 DICOM 图像的原始数据创建图像

> ID：716673
> 
> 赞同：1
> 
> 时间：2009-04-04T06:56:19.100
> 
> 标签：c#, dicom

我有一个`byte[]`来自 DICOM 图像的原始像素数据。现在我想把它转换`byte[]`成一个`Image`对象。

我试过：

```
Image img = Image.FromStream(new MemoryStream(byteArray)); 
```

但这对我不起作用。我还应该使用什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-04T07:08:34.313

要注意的一件事是，dicom“图像”不一定只是图像数据。dicom 文件格式包含的不仅仅是原始图像数据。这可能是你被挂断的地方。考虑查看 dicom 文件标准，您应该能够在 dicom 的维基百科文章中找到链接。这应该可以帮助您弄清楚如何解析出您真正感兴趣的信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-05-13T07:05:03.410

您必须执行以下操作

1.  从文件中识别 PIXEL DATA 标记。您可以使用 FileStream 逐字节读取。
2.  读取像素数据
3.  将其转换为 RGB
4.  从 RGB 创建一个 BitMap 对象
5.  使用 Graphics 类在面板上绘制位图。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-04T14:03:12.610

您应该使用 GDCM。

Grassroots DiCoM 是一个用于 DICOM 医疗文件的 C++ 库。它会自动包装到 python/C#/Java（使用 swig）。它支持 RAW、JPEG 8/12/16 位（有损/无损）、JPEG 2000、JPEG-LS、RLE 和放气 (zlib)。

它是可移植的，并且可以在大多数系统（Win32、linux、MacOSX）上运行。

*   [http://gdcm.sourceforge.net/wiki/index.php/GDCM_Release_2.4](http://gdcm.sourceforge.net/wiki/index.php/GDCM_Release_2.4)

参见例如：

*   [http://gdcm.sourceforge.net/html/DecompressImage_8cs-example.html](http://gdcm.sourceforge.net/html/DecompressImage_8cs-example.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-09-12T22:30:18.913

像素数据通常（如果不总是）在 DICOM 数据的末尾结束。如果您能计算出宽度、高度、步幅和颜色深度，则应该可以跳到 (7FE0,0010) 数据元素值并获取后续字节。这是大多数普通图像查看器在显示 DICOM 图像时使用的技巧。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-03-09T00:01:44.653

有一个名为 EvilDicom ( [http://rexcardan.com/evildicom/](http://rexcardan.com/evildicom/) ) 的 C# 库可用于从 DICOM 文件中提取图像。它有一个关于如何在网站上做到这一点的教程。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-15T11:55:35.533

您正在使用**纯标准**DICOM 文件吗？两年多来，我一直在维护一个 DICOM 解析器，我遇到了一些非常奇怪的 DICOM 文件，这些文件并不完全符合标准（公司实现了他们“自己的”扭曲的标准 DICOM 文件）。将您的字节数组刷新到文件中并测试您的图像查看器（irfanview、picassa 或其他）是否可以显示它。如果您的代码正在使用普通的 JPEG 流，那么根据我的经验，99.9999% 的可能性仅仅是因为该文件以某种奇怪的方式违反了标准（相信我，医疗公司经常这样做）

另请注意，DICOM 标准支持 JPEG 标准的多种变体。可能是 Bitmap 类不支持您从 DICOM 文件中获取的数据。你能写下转移语法吗？

欢迎你把文件发给我（如果文件不大的话）yossi1981@gmail.com，我可以看看，有段时间我一直在十六进制编辑DICOM文件半年。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-10-23T22:52:43.137

DICOM 是一个荒谬的规范，我真诚地希望它在不久的将来得到彻底改革。也就是说，Offis 有一个软件套件“DCMTK”，它非常擅长使用各种流行的编码转换 dicom。只是尝试在文件 x-bytes 中向前跳过对于单个文件可能没问题，但如果您有一个或多个卷，则需要更强大的策略。我使用了 DCMTK 的转换代码，只是在图像位进入 pnm 之前抓取了它们。您将在 DCMTK 中查找的文件是 dcm2pnm 或可能是 dcmj2pnm，具体取决于编码方案。

我用运行时标志之一修复的缩放窗口有问题。DCMTK 是开源的，并带有相当简单的构建说明。

# http - Content-Range 和 Range 标头之间的区别？

> ID：716680
> 
> 赞同：79
> 
> 时间：2009-04-04T07:02:35.560
> 
> 标签：http, http-headers

HTTP 标头 Content-Range 和 Range 有什么区别？什么时候应该使用每个？

我正在尝试从特定字节偏移量流式传输音频文件。我应该使用 Content-Range 还是 Range 标头？

谢谢

* * *

## 回答 #1

> 赞同：137
> 
> 时间：2011-07-15T18:19:22.687

实际上，接受的答案并不完整。Content-Range 不仅用于响应。在提供实体主体的请求中也是合法的。

例如，一个 HTTP PUT 提供一个实体主体，它可能只提供一个实体的一部分。因此，PUT 请求可以包括一个 Content-Range 标头，向服务器指示部分实体主体应在何处合并到实体中。

例如，让我们先创建一个文件，然后使用 HTTP 附加到一个文件：

请求 1：

```
PUT /file HTTP/1.1
Host: server
Content-Length: 1

a 
```

要求 2：

```
PUT /file HTTP/1.1
Host: server
Content-Range: bytes 1-2/*
Content-Length: 1

a 
```

怎么样，让我们​​看看文件的内容...

要求 3：

```
GET /file HTTP/1.1
Host: server

HTTP/1.1 200 OK
Content-Length: 2

aa 
```

这允许随机文件访问，包括通过 HTTP 读取和写入。我只是想澄清一下，因为我正在研究我正在开发的 WebDAV 客户端中 Content-Range 的使用，所以也许这些扩展信息对其他人有用。

* * *

## 回答 #2

> 赞同：85
> 
> 时间：2009-04-04T07:14:17.327

[Range](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.35)用于请求中，以请求特定范围（或多个范围）的字节。[Content-Range](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.16)用于响应中，以指示服务器给您的字节数（可能与您请求的范围不同），以及整个内容的长度（如果已知）。

# c# - IQueryable 中的 HtmlEncode 字符串而不更改绑定数据

> ID：716682
> 
> 赞同：1
> 
> 时间：2009-04-04T07:05:30.437
> 
> 标签：c#, asp.net, linq-to-sql, data-binding, iqueryable

我将 ASP.NET 控件绑定到 LINQ 查询的结果。我想在绑定到控件之前对包含的对象的属性之一进行 HtmlEncode，但我想在不更改数据的情况下这样做，因为我稍后会执行 DataContext.SubmitChanges()。如何才能做到这一点？

不起作用的代码：

```
var ds = (from s in dc.SearchResults
    orderby s.datetime descending
    select s)
    .Take(int.Parse(ConfigurationManager.AppSettings["RecentItemQty"]));
foreach (SearchResult sr in ds)
    sr.Query = Server.HtmlEncode(sr.Query);
rSearches.DataSource = ds;
rSearches.DataBind(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-04T07:15:49.443

当您进行绑定时，您可以对其进行编码...

```
<asp:YourDataBoundControl>
    <ItemTemplate>
        Query: <span><%# Server.HtmlEncode((string)Eval("Query")) %></span>
    </ItemTemplate>
</asp:YourDataBoundControl> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-04T07:08:58.570

骗我。我只需要在 OnItemDataBound() 事件中对其进行 HtmlEncode。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T07:09:43.187

有两个数据副本：

```
from s in dc.SearchResults
orderby s.datetime descending
select new {
  Original = s,
  Encoded = Server.HtmlEncode(s.Query)
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-04T07:38:23.523

或者你可以使用 HttpUtility.HtmlEncode('string');

两者都是有效的，但上面的一个在应用程序中的任何地方都可用，比加载 HttpContext.Current.Server.HtmlEncode 更容易。

# mysql - 枢轴概念

> ID：716683
> 
> 赞同：1
> 
> 时间：2009-04-04T07:06:04.863
> 
> 标签：mysql, pivot-table

嗨，

我有一个数据库设计：

```
Table File (FileID, Name, Details)

Table Attributes (AttID, AttName, AttType)

Table AttValues (FileID, AttID, AttValue) 
```

直到运行时，才知道 a 中有多少`Attributes`个`File`以及什么名称。

我想在前端插入后以如下方式显示：

```
FileID, FileName, Details, (Rows of Attribute Table as Column here). 
```

即，任何人都可以提供一段Java 或MySQL 中的代码来实现这个Pivoting Result。

非常感谢您宝贵的时间。

或者有没有其他更好的方法来存储数据，这样我就可以很容易地得到想要的结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-04T07:17:42.760

这需要两个查询。首先选择`File`：

```
SELECT * FROM File WHERE (...) 
```

然后，获取`Attributes`：

```
SELECT *
FROM AttValues
     JOIN Attributes ON (Attributes.AttId = AttValues.AttId)
WHERE FileId = $id 
```

后一个查询将为您提供每行`Attribute`，您可以通过编程方式将其转轴以在前端显示：

```
foreach(row in result) {
    table.AddColumn(Header = row['AttName'], Value = row['AttValue']);
} 
```

根据需要适应您的本地编程环境。

* * *

当然，这只适用于具有相同属性的单个`File`或s。`File`如果要显示多个不同的文件，`Attributes`可以改为预取所有`AttName`s：

```
SELECT Attributes.AttId, Attributes.AttName
FROM Attributes 
     JOIN AttValues ON (Attributes.AttId = AttValues.AttId)
WHERE FileId IN ( $list_of_ids ) 
```

然后像这样加载值：

```
SELECT *
    FROM AttValues
WHERE FileId IN ( $list_of_ids ) 
```

并使用本地关联数组从`AttId`s 映射到列索引。

作为最终优化，您可以将最后两个查询组合成一个`OUTER JOIN`以避免第三次往返。虽然这可能会增加传输的数据量，但如果您的类库支持命名列，它也会使填充表更容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T10:28:02.303

我最近回答了一个类似的问题：[How to pivot a MySQL entity-attribute-value schema](https://stackoverflow.com/questions/649802/how-to-pivot-a-mysql-entity-attribute-value-schema/652748#652748)。答案是特定于 MySQL 的，但我想这没关系，因为问题是用 mysql 标记的。

# http - 带有 J2ME 的 WebDAV

> ID：716686
> 
> 赞同：1
> 
> 时间：2009-04-04T07:08:20.320
> 
> 标签：http, sockets, java-me, webdav, midp

有没有办法将 WebDAV 与 J2ME（一些库或手动编码）一起使用？

我尝试过：
- [javax.microedition.io.HttpConnection](http://java.sun.com/javame/reference/apis/jsr118/javax/microedition/io/HttpConnection.html)，但那里不支持“SEARCH”方法
-带有[Http 请求的](http://www.onjava.com/pub/a/onjava/2003/04/23/java_webserver.html)[javax.microedition.io.SocketConnection](http://java.sun.com/javame/reference/apis/jsr118/javax/microedition/io/SocketConnection.html) - 没有任何返回响应 可能我的代码或 HTTP 标头有问题：

```
 String response = "";
    String query = "<?xml version='1.0'?> " 
            + "<g:searchrequest xmlns:g='DAV:'> "
            + "<g:sql> "
            + "SELECT 'DAV:displayname' "
            + "FROM 'http://exchangeserver.com/Public/' "
            + "</g:sql> "
            + "</g:searchrequest> ";
    String len = String.valueOf(query.length());
    SocketConnection hc = (SocketConnection) Connector
            .open("socket://exchangeserver.com:8080");
    DataOutputStream dout = 
            new DataOutputStream(hc.openOutputStream());
    DataInputStream din = new DataInputStream(hc.openInputStream());
    String userPass = "username" + ":" + "password";
    byte[] encoded = 
            Base64OutputStream.encode(userPass.getBytes(), 0,
            userPass.length(), false, false);
    ByteArrayOutputStream bos = new ByteArrayOutputStream();
    String request = "SEARCH /Public/ HTTP/1.1\r\n"
            +"Content-Type:text/xml\r\nContent-Length:"
            + len
            + "\r\nAuthorization:Basic "
            + new String(encoded)
            + "\r\n\r\n";
    bos.write(request.getBytes());
    bos.write(query.getBytes());
    dout.write(bos.toByteArray());
    dout.flush();
    dout.close();
    byte[] bs = new byte[900];
    din.readFully(bs);
    bos = new ByteArrayOutputStream();
    bos.write(bs);
    din.close();
    hc.close();
    response = bos.toString(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-04T08:07:47.710

“没有回报”是什么意思？没有响应体？没有状态码？

我建议追踪“电线”上发生的事情......

更新：您是否尝试过添加主机标头？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-04T16:48:54.027

Julian +1 你是正确的 Host 属性，QRSO +1，谢谢大家！所以，
- 我找到了免费的 WebDAV 服务[MyDisk.se](https://mydisk.se/web/main.php?show=home)（不允许搜索，所以我使用了 PROPFIND）
- 使用[WFetch](http://www.microsoft.com/downloads/details.aspx?familyid=9bfa49bc-376b-4a54-95aa-73c9156706e7&displaylang=en)来处理 WebDAV 请求
- 使用[网络监视器](http://www.microsoft.com/downloads/details.aspx?familyid=f4db40af-1e08-4a21-a26b-ec2f4dc4190d&displaylang=en)来比较来自 WFetch 和我的应用程序的请求。
:) 最后它的工作！结果代码：

```
String response = "";
String query = "<?xml version='1.0' encoding='UTF-8'?>\r\n"
        + "<d:propfind xmlns:d='DAV:'>\r\n"
        + "<d:prop><d:getcontenttype/></d:prop>\r\n"
        + "<d:prop><d:getcontentlength/></d:prop>\r\n"
        + "</d:propfind>\r\n";

String len = String.valueOf(query.length());
SocketConnection hc = (SocketConnection) Connector
        .open("socket://79.99.7.153:80");
DataOutputStream dout = new DataOutputStream(hc.openOutputStream());
DataInputStream din = new DataInputStream(hc.openInputStream());
String userPass = "login" + ":" + "password";
byte[] encoded = Base64OutputStream.encode(userPass.getBytes(), 0,
        userPass.length(), false, false);
ByteArrayOutputStream bos = new ByteArrayOutputStream();
String request = "PROPFIND /mgontar/ HTTP/1.1\r\n" 
        + "Depth: 1\r\n"
        + "Host: mydisk.se:80\r\n" 
        + "Accept: */*\r\n"
        + "Content-Type: text/xml\r\n" 
        + "Content-Length: " + len
        + "\r\nAuthorization: Basic " + new String(encoded)
        + "\r\n\r\n";
bos.write(request.getBytes());
bos.write(query.getBytes());
dout.write(bos.toByteArray());
dout.flush();
dout.close();
byte[] bs = new byte[900];
din.readFully(bs);
bos = new ByteArrayOutputStream();
bos.write(bs);
din.close();
hc.close();
response = bos.toString(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-04T12:47:26.697

仅供参考如果您在实际的手机上进行测试，那么您的移动网络运营商很有可能会阻止非 HTTP 流量。

您可能需要先检查是否可以先向服务器发出 GET 和 POST 请求。

# caching - 关于文件系统缓存的问题

> ID：716697
> 
> 赞同：1
> 
> 时间：2009-04-04T07:16:43.527
> 
> 标签：caching, operating-system, filesystems

当我在文件系统中读取一个大文件时，缓存能提高运行速度吗？

我认为有两个不同的答案：

1.是的。因为缓存可以预取，所以性能得到了提高。

2.没有。因为从缓存中读取的速度比从磁盘读取的速度要快，最后我们会发现缓存没有帮助，所以读取速度也是从磁盘读取的速度。

哪一个是正确的？我如何证明答案？

[编辑]

另一个问题是：

我不确定的是，当您打开缓存时，带宽用于

1.预取

2.预取和读取

哪一个是正确的？

而如果关闭缓存，则磁盘带宽仅用于读取。

如果我关闭缓存并随机访问磁盘，所需的时间是否与打开缓存时顺序读取的时间相当？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-04T07:20:28.700

1绝对正确。当您的代码正在处理它已经收到的数据时，操作系统可以从磁盘获取缓存。是的，磁盘很可能仍然是瓶颈——但你不会读、处理、读、处理、读、处理，而是读+处理、读+处理、读+处理。例如，假设我们的处理需要一半的阅读时间。代表页面向下的时间，我们可能会在没有预取的情况下进行这种活动：

```
Read
Read
Process
Read
Read
Process
Read
Read
Process 
```

而通过预取，这被优化为：

```
Read
Read
Read     Process
Read
Read     Process
Read
         Process 
```

基本上总时间将是“读取整个文件的时间+处理最后一条数据的时间”而不是“读取整个文件的时间+处理整个文件的时间”。

测试它很棘手 - 您需要有一个可以调整或关闭缓存的操作系统。另一种选择是更改您打开文件的方式 - 例如，在 .NET 中，如果您使用[FileOptions.SequentialScan](http://msdn.microsoft.com/en-us/library/system.io.fileoptions.aspx)打开文件，则缓存更有可能做正确的事情。尝试使用和不使用该选项。

这主要是关于预取 - 通用缓存（即使在将数据传递给应用程序之后仍保留数据）是另一回事，如果您想多次使用相同的数据，显然会起到很大的作用。还有“介于两者之间的东西”，应用程序只请求了少量数据，但磁盘已读取整个块 - 操作系统不会主动预取尚未请求的块，但可以缓存整个块所以如果应用程序随后从同一块请求更多数据，它可以从缓存中返回该数据。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-04T07:20:47.857

第一个答案是正确的。

磁盘具有固定的基础性能——但该固定的基础性能在不同情况下有所不同。当您读取较长的数据段时，您可以从驱动器获得更好的实际性能 - 例如，当您提前缓存时。因此，缓存允许驱动器真正提高其实际性能。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-04T09:28:14.103

在一般情况下，使用缓存会更快。需要考虑的几点：

*   磁盘上的数据以表面（也称为磁头）、磁道和块的形式进行组织。磁盘需要一些时间来定位读取头，以便您可以开始读取磁道。现在你需要从那条轨道上走五个街区。不幸的是，您要求 then 的顺序与它们在物理媒体上出现的顺序不同。通过将整个轨道读入内存（比您需要的块多得多），然后重新索引它们（当磁头开始读取时，它可能会在*任何地方），缓存将有很大帮助*在赛道上，而不是在第一个街区的起点）。没有这个，您必须等到磁道的第一个块在磁头下方旋转并开始读取 -> 读取磁道的时间将有效加倍。因此，使用缓存，您可以按任何顺序读取磁道的块，并且在磁头到达磁道上方时立即开始读取。

*   如果文件系统已满，操作系统将开始将您的数据压缩到各种空白空间中。想象一下，第 1 块在第 5 轨上，第 2 块在第 7 轨上，第 3 块又在第 5 轨上。如果没有缓存，您会浪费很多时间来定位磁头。使用高速缓存，磁道 5 被读取，并在磁头进入磁道 7 时保存在 RAM 中，当您请求块 3 时，您会立即得到它。

*   大文件需要大量的元数据，即文件的数据块在哪里。在这种情况下，缓存将在您读取文件时保持这些数据处于活动状态，从而使您免于更多的头部垃圾。

*   缓存将允许其他程序在您占用磁盘时以有效的方式访问其数据。所以整体性能会更好。当您阅读时开始*编写第二个程序时，这一点非常重要。*在这种情况下，缓存会在中断您的读取之前收集一些写入。此外，大多数程序读取数据、处理数据然后将其写回。如果没有缓存，程序要么进入自己的方式，要么必须实现自己的缓存方案以避免头部垃圾。

*   缓存允许操作系统重新排序磁盘 I/O。假设您在磁道 5、7 和 13 上有块，但文件顺序要求磁道 5、13 和 7。显然，在到 13 的途中读取磁道 7 比一直到 13 然后返回更有效到 7。

因此，虽然从理论上讲，如果没有缓存，读取大量数据会更快，但只有当您的文件是磁盘上唯一的文件并且所有元数据都被完美排序时，这才是正确的，数据的物理布局是这样的读取头总是在第一个块的开头开始读取磁道，等等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-04T07:23:01.487

[Jon Skeet](https://stackoverflow.com/users/22656/jon-skeet)对这个主题有一个[非常有趣的 .NET 基准测试。](http://msmvps.com/blogs/jon_skeet/archive/2009/03/24/buffering-vs-streaming-benchmark-first-results.aspx)基本结果是，预取有帮助，你必须做的每单位读取的处理越多。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-04T07:22:21.317

如果文件大于您的内存，那么它肯定没有任何帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-04T09:43:06.547

另一点：很可能，经常使用的文件在一个甚至开始读取其中一个之前就已经在缓存中了。

# filesystems - 刚刚开始进行大规模删除的完整 UFS 上的 open() 非常慢（超过 6 秒）？

> ID：716712
> 
> 赞同：1
> 
> 时间：2009-04-04T07:25:27.267
> 
> 标签：filesystems, solaris

我们在 solaris 上有一个 UFS 分区。

音量已满。我们仍在尝试写入它 - 自然 open() 立即返回 -1。

当启动执行大规模删除的 cronjob 时，看起来 open() 没有及时返回 - 它至少需要六秒钟，因为这是看门狗杀死进程之前的时间。

现在，显而易见的想法是删除使文件系统保持忙碌，而 open() 只需要永远......但是有关于这种行为的具体知识吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-17T10:16:08.623

批量删除会导致随机 IO 风暴，这确实会损害性能。它使尽可能多的日志/日志事务提交（尝试使用`nologging`选项？）。此外，如果您的 fs 快满了，那么 open 无论如何都需要一些时间来为新的 inode 寻找空间。

更频繁地删除文件，一次更少，可以帮助您缩短响应时间。或者干脆更慢地删除它们，在 rm 之间休眠。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-04T22:24:52.910

也许可以更改执行“批量删除”的程序以在有问题的文件系统上更顺畅地运行。如果它确实查询以查找要删除的文件，则可能不是打开调用超时。为了测试这个理论，有没有办法设置一个 cron 作业，在磁盘满状态下简单地删除一个具有已知名称的文件？“批量删除”程序如何决定要进行什么“打开”调用？

还可以在写入停止工作之前控制磁盘利用率的百分比。您也可以尝试将其设置为较低的百分比。如果您通过等待文件创建步骤返回 -1 来检测“磁盘已满”状态，那么您应该考虑向您的代码添加显式检查，以便如果文件系统已满某个百分比以上，请采取纠正措施。

# c - 基于格式字符串的智能可变参数扩展

> ID：716736
> 
> 赞同：4
> 
> 时间：2009-04-04T07:58:02.260
> 
> 标签：c, string, tokenize, variadic

我有一个读取配置文件的守护程序，以便知道在哪里写东西。在配置文件中，存在这样的一行：

```
output = /tmp/foo/%d/%s/output 
```

或者，它可能看起来像这样：

```
output = /tmp/foo/%s/output/%d 
```

...或者只是这样：

```
output = /tmp/foo/%s/output 
```

...或者最后：

```
output = /tmp/output 
```

我在我的程序中将该行作为 cfg->pathfmt 。我现在要做的是想出一些巧妙的使用方法。

再解释一下，路径最多可以包含两个要格式化的组件。%d 将扩展为作业 ID (int)，%s 将扩展为作业名称（字符串）。用户可能希望在配置文件中使用一个、两个或一个都不使用。在我最终将其传递给 snprintf() 之前，我需要知道他们想要什么以及按什么顺序。我可以缩小范围，但我一直想与 strtok() 交谈，这看起来很难看。

我想给用户这种灵活性，但是我迷失了寻找一种明智的、可移植的方式来实现它。我也完全不知道如何开始搜索这个。

如果出现以下情况，我会非常高兴：

*   有人可以帮我缩小搜索词组的范围以找到好的例子
*   有人可以发布一个链接到一些实现这个的 OSS 项目
*   有人可以发布一些伪代码

我不想要为我编写的代码，我只是真的坚持（我认为）应该是非常简单的东西，并且需要一些帮助才能吃第一口。我真的觉得我想多了，忽略了显而易见的事情。

最终结果应该是这样的布尔函数：

```
bool output_sugar(const char *fmt, int jobid, const char *jobname, struct job *j); 
```

然后它将在 j->outpath 上调用 snprintf()（明智地），如果某种垃圾（即 % 后跟不是 s、d 或 % 的东西）在配置行中（或其 null），则返回 false。健全性检查很容易，我只是花一点时间来获取参数的数量（和顺序）以正确格式化。

提前致谢。另外，如果您有声誉，请随时编辑此标题，正如我所说，我不太确定如何在一行中提出问题。我认为我需要的是一个[解析器](http://www.hwaci.com/sw/lemon/)，但是使用成熟的词法分析器/解析器来处理一个简单的字符串感觉很尴尬。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-05T05:06:24.817

是的，您需要某种解析器。不过，它不必很复杂：

```
void format_filename(const char *fmt, int jobid, const char *jobname,
                     char *buffer, size_t buflen)
{
    char *end = buffer + buflen - 1;
    const char *src = fmt;
    char *dst = buffer;
    char c;
    assert(buffer != 0 && fmt != 0 && buflen != 0 && jobname != 0);
    while ((c = *src++) != '\0')
    {
        if (dst >= end)
            err_exit("buffer overflow in %s(): format = %s\n",
                     __func__, fmt);
        else if (c != '%')
            *dst++ = c;
        else if ((c = *src++) == '\0' || c == '%')
        {
            *dst++ = '%';
            if (c == '\0')
                break;
        }
        else if (c == 's')
        {
            size_t len = strlen(jobname);
            if (len > end - dst)
                err_exit("buffer overflow on jobname in %s(): format = %s\n",
                         __func__, fmt);
            else
            {
                strcpy(dst, jobname);
                dst += len;
            }
        }
        else if (c == 'd')
        {
             int nchars = snprintf(dst, end - dst, "%d", jobid);
             if (nchars < 0 || nchars >= end - dst)
                 err_exit("format error on jobid in %s(); format = %s\n",
                          __func__, fmt);
             dst += nchars;
        }
        else
            err_exit("invalid format character %d in %s(): format = %s\n",
                     c, __func__, fmt);
    }
    *dst = '\0';
} 
```

现在测试代码。请注意，它支持 '%%' 表示法以允许用户在输出中嵌入单个 '%'。此外，它将字符串末尾的单个 '%' 视为有效并等效于 '%%'。出错时调用 err_exit()；您可以选择适合您系统的替代错误策略。我只是假设您已经包含`<assert.h>`,`<stdio.h>`和（可变参数）函数`<string.h>`的标头。`err_exit()`

* * *

测试代码...

```
#include <stdio.h>
#include <string.h>
#include <stdarg.h>
#include <assert.h>

static void err_exit(const char *fmt, ...)
{
    va_list args;
    va_start(args, fmt);
    vfprintf(stderr, fmt, args);
    va_end(args);
    exit(1);
} 
```

...然后`format_filename()`如上所述，然后...

```
#define DIM(x) (sizeof(x)/sizeof(*(x)))

static const char *format[] =
{
    "/tmp/%d/name/%s",
    "/tmp/%s/number/%d",
    "/tmp/%s.%d%%",
    "/tmp/%",
};

int main(void)
{
    char buffer[64];
    size_t i;

    for (i = 0; i < DIM(format); i++)
    {
        format_filename(format[i], 1234, "job-name", buffer, sizeof(buffer));
        printf("fmt = %-20s; name = %s\n", format[i], buffer);
    }

    return(0);
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-04T08:21:12.047

使用 strtok 容易出错。您可以使用 (fl)lex 和 yacc 将变量视为迷你语言。 [这里有简单的教程](http://ds9a.nl/lex-yacc/cvs/lex-yacc-howto.html)

```
%{
#include <stdio.h>
%}

%%
%d                      printf("%04d",jobid);
%s                      printf("%s",stripspaces(dirname));
%% 
```

我制作了一个 ODBC 包装器，可以让您执行类似 dbprintf("insert into blah values %s %D %T %Y", stuff here...); 之类的操作。但那是很多年前的事了，我咬了它并使用 strtok 解析了格式字符串。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-05T04:15:48.963

如果选项数量很少，并且您不希望/不需要解析器的额外灵活性和复杂性，您可以简单地使用 strstr() 搜索每个潜在的替换子字符串。

如果你只有这两个选项，你可以容忍地创建一个四分支的 if/else 结构（只有 A，只有 B，在 B 之前都有 A，在 A 之前都有 B），在其中以正确的顺序调用 sprintf()论据。否则，进行多个 sprintf() 调用，每个调用仅替换格式字符串中的第一个替换标记。（这意味着建立一个需要替换的列表并按外观顺序对它们进行排序......）

# c# - 学习设计模式的资源

> ID：716738
> 
> 赞同：9
> 
> 时间：2009-04-04T08:02:40.533
> 
> 标签：c#, asp.net, design-patterns

最近我想到了设计模式这个概念，并且对此感到非常热情。你们能推荐一些资源来帮助我深入了解设计模式吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-04T08:07:13.437

你知道，对我来说，最好的书之一是[Head First Design Patterns](https://rads.stackoverflow.com/amzn/click/com/0596007124)。我个人喜欢他们用来交流材料的风格。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-04T08:07:04.467

Wikipedia, the [Gang of Four](https://rads.stackoverflow.com/amzn/click/com/0201633612) book，如果您对 C# 实现特别感兴趣，[这里](http://dofactory.com/Patterns/Patterns.aspx)有一个不错的站点。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-09T18:32:49.793

最好的书之一是（如上所述）**Head First**系列，因为它提供了很好的类比和现实世界的例子。

还有其他不错的 Java 设计模式书籍可用。此外，专门研究该主题的网站（请参阅上面的一些帖子）

虽然《**四人帮**》是我第一次读到这个主题，但我认为你应该避免它，尤其是在你刚开始的时候。当时这是参考，但今天有很多书籍可供您选择。

但是，我清楚地强调这一点……实践是最终的学习工具。在阅读了几本关于该主题的书籍后，我 100% 确信知道和理解这些模式。当我尝试实际实施其中一些时，我很快意识到我的知识主要是“理论”，而我的理解甚至还不够接近。对我的自我是一个巨大的打击！

我开始测试和挑战我的同龄人，并很快了解到他们和我在同一条船上。我发现 99% 的程序员都声称知道模式，但是当真正进行测试时，只有大约 1/3 的程序员真正了解该主题。

我着手在一个或多个复杂系统中实现尽可能多的模式。我把理论付诸实践，我学到的是一座金矿。

我的经验中最具挑战性的方面之一是每个模式看起来都很简单。但有时将一堆模式联系在一起可能更具挑战性。

我鼓励你把理论付诸实践！

杰奇！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-04T08:10:47.860

这是一个非常好的关于[DnrTV上的设计模式的截屏视频系列](http://www.dnrtv.com)

[第 1](http://www.dnrtv.com/default.aspx?showNum=63) [部分 第 2](http://www.dnrtv.com/default.aspx?showNum=65) [部分 第 3](http://www.dnrtv.com/default.aspx?showNum=68) [部分 第 4](http://www.dnrtv.com/default.aspx?showNum=71) [部分 第 5 部分](http://www.dnrtv.com/default.aspx?showNum=92)

希望这更有吸引力；）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-04T08:07:54.530

四种[设计模式书](https://rads.stackoverflow.com/amzn/click/com/0201633612)的帮派是标准。如果您对 C++ 感到满意，我推荐它。

[Head first 设计模式](https://rads.stackoverflow.com/amzn/click/com/0596007124)也很好，特别是如果您喜欢视觉辅助工具并且想要感觉自己正在 50 年代的小餐馆学习设计模式。示例在 Java 中。

有时有多种方法可以在给定的编程语言中实现模式（例如，参见[关于在 C# 中实现单例模式的选项的讨论](http://www.yoda.arachsys.com/csharp/singleton.html)），因此可能值得一本书简洁地描述常见模式，另一本书建议以您喜欢的语言实现它们的最佳方法。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-04T09:02:13.243

我经常参考这个网站：[设计模式](http://sourcemaking.com/design_patterns)。它有一个很好的文章，包括免费的所有流行设计模式的示例。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-10-01T15:07:36.150

Head first design patterns book 是一本很好的读物。

如果你想测试你对设计模式的了解，这里是[设计模式测验](http://www.skill-guru.com/skill/login/testDetails.faces?testId=40&testName=GOF-Design-pattern)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-07T12:05:32.483

这是我不久前找到的两个

[http://www.dofactory.com/Patterns/Patterns.aspx](http://www.dofactory.com/Patterns/Patterns.aspx)

[http://amazedsaint.blogspot.com/2008/01/design-patterns-part-i-and-ii.html](http://amazedsaint.blogspot.com/2008/01/design-patterns-part-i-and-ii.html)

ASP.NET 对 DP 有很好的参考。

[http://wiki.asp.net/page.aspx/276/design-patterns](http://wiki.asp.net/page.aspx/276/design-patterns)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-04T08:06:43.033

[Microsoft 模式和实践开发人员中心](http://msdn.microsoft.com/en-us/practices/default.aspx)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-04T08:08:19.550

真的，我认为学习它们的最好方法是深入理解你的语言（基于你的标签的 C#），然后真正致力于实现良好的关注点分离、低耦合和高内聚的目标。[我会阅读和研究 Robert Martin 关于 SOLID 原则的著作。](http://blog.objectmentor.com/articles/2009/02/12/getting-a-solid-start)

然后（这是最重要的部分），在开发软件时尝试遵循这些原则。你会发现你开始做某些事情，然后它会打击你，“哦！那是策略模式。” 这确实是“模式运动”所展示的......人们使用某种语言工作，试图实现良好的软件设计，会发现自己得到遵循某些通用模式的解决方案。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-04T08:09:18.987

我喜欢这2个...

[http://www.amazon.com/Design-Patterns-Object-Oriented-Addison-Wesley-Professional/dp/0201633612](https://rads.stackoverflow.com/amzn/click/com/0201633612)

[http://www.amazon.com/Refactoring-Patterns-Addison-Wesley-Signature-Kerievsky/dp/0321213351](https://rads.stackoverflow.com/amzn/click/com/0321213351)

这确实有助于采用现有代码并实现设计模式。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-10-01T15:18:31.237

去年，我购买并阅读了[Judith Bishop的](http://patterns.cs.up.ac.za/)[C# 3.0 Design Patterns](http://oreilly.com/catalog/9780596527730/)，我对此非常满意，之前曾尝试过 Go4 和 C# 中的设计模式。

这涵盖了按相似性分组的标准模式集，以增加复杂性的顺序，但也将它们与 C# 3.0 的语言特性联系起来，因此您可以从接口和抽象类的简单案例开始，然后通过扩展方法向上移动，泛型、匿名类型、函数等 - 学习这两者的好方法。

所有内容都以易于阅读的格式呈现，并带有相当多的真实示例和方便的源代码。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-04-04T08:50:05.770

我发现[Design Patterns Explained](https://rads.stackoverflow.com/amzn/click/com/0321247140)是一个很好的介绍性文本。《四人帮》一书可供那些已经了解模式的人参考。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-04-04T08:51:51.817

Martin Fowler 的网站有很多信息：[http](http://martinfowler.com/articles.html) ://martinfowler.com/articles.html 。[他的《企业应用程序架构模式》](https://rads.stackoverflow.com/amzn/click/com/0321127420)一书中也涵盖了大部分内容。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-04-04T09:30:03.677

对于那些使用 C# 的人，我发现*C# 中的设计模式*比 GoF 的书更容易阅读。这些示例当然是用 C# 编写的，并且与 Microsoft 对模式的命名有关。

# c# - 反向IP域检查？

> ID：716748
> 
> 赞同：12
> 
> 时间：2009-04-04T08:08:43.997
> 
> 标签：c#, dns

您可以使用域查询一个网站，它将返回该 IP 上托管的所有网站的列表。我记得 C# 中有一个方法类似于 ReturnAddresses 或类似的东西。有谁知道这是怎么做到的？查询主机名或 IP 并返回主机名列表，也就是托管在同一服务器上的其他网站？

该网站是：[http ://www.yougetsignal.com/tools/web-sites-on-web-server/](http://www.yougetsignal.com/tools/web-sites-on-web-server/)

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-04T08:15:26.413

看完评论，bobince绝对是对的，这两个应该一起使用。为获得最佳结果，您应该在此处使用反向 DNS 查找以及使用被动 DNS 复制。

```
string IpAddressString = "208.5.42.49"; //eggheadcafe

try 
{
   IPAddress hostIPAddress = IPAddress.Parse(IpAddressString);
   IPHostEntry hostInfo = Dns.GetHostByAddress(hostIPAddress);
   // Get the IP address list that resolves to the host names contained in 
   // the Alias property.
   IPAddress[] address = hostInfo.AddressList;
   // Get the alias names of the addresses in the IP address list.
   String[] alias = hostInfo.Aliases;

   Console.WriteLine("Host name : " + hostInfo.HostName);
   Console.WriteLine("\nAliases :");
   for(int index=0; index < alias.Length; index++) {
     Console.WriteLine(alias[index]);
   } 
   Console.WriteLine("\nIP address list : ");
   for(int index=0; index < address.Length; index++) {
      Console.WriteLine(address[index]);
   }
}
catch(SocketException e) 
{
     Console.WriteLine("SocketException caught!!!");
   Console.WriteLine("Source : " + e.Source);
   Console.WriteLine("Message : " + e.Message);
}
catch(FormatException e)
{
     Console.WriteLine("FormatException caught!!!");
   Console.WriteLine("Source : " + e.Source);
   Console.WriteLine("Message : " + e.Message);
}
catch(ArgumentNullException e)
{
     Console.WriteLine("ArgumentNullException caught!!!");
   Console.WriteLine("Source : " + e.Source);
   Console.WriteLine("Message : " + e.Message);
}
catch(Exception e)
{
    Console.WriteLine("Exception caught!!!");
    Console.WriteLine("Source : " + e.Source);
    Console.WriteLine("Message : " + e.Message);
} 
```

由[http://www.eggheadcafe.com/community/aspnet/2/83624/system-dns-gethostbyaddre.aspx提供](http://www.eggheadcafe.com/community/aspnet/2/83624/system-dns-gethostbyaddre.aspx)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-04T11:08:36.450

Jeremy 的答案基于[Reverse DNS](http://en.wikipedia.org/wiki/Reverse_DNS)，这是查找 IP-> 主机名的常规编程方式。它依赖于为该服务器设置的 PTR 记录；这通常但并不总是设置为有用的东西。

例如查找 thedailywtf.com，您将获得 74.50.106.245，但由于“245.106.50.74.in-addr.arpa”没有 PTR 记录，Dns.GetHostEntry() 不会返回任何有用的信息。

同样，许多服务器场只会为您提供一个通用主机名，例如 123.45.67.89-dedicated.bigexamplehost.com。

yougetsignal 所做的不同，它是“被动 DNS 复制”。他们运行一些人们正在查询的 DNS 服务器，并记住每个被查找的主机名。然后你可以通过返回的地址查询他们过去的查找记录。将 74.50.106.245 放入 yougetsignal 中，您将获得一个主机名列表，这些主机名在人们查询它们时之前解析到 dailywtf 服务器，与反向 DNS PTR 条目无关。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-04T12:15:23.153

反向 DNS 与您所要求的不同（*哪些站点托管在同一台服务器上*）。反向 DNS 通常不会像您期望的那样工作（请参阅 bobince 的回答）。

为了能够识别主机中的其他网站，您需要建立一个庞大的数据库并尽可能多地存储 DNS 记录，然后关联 IP 地址。

查看： http: [//www.domaintools.com/reverse-ip/](http://www.domaintools.com/reverse-ip/)

他们正在按照我说的方式这样做，这是获得准确结果的唯一方法。显然，关联和抓取/生成该数据需要时间、CPU、带宽和空间。

# iphone - 为什么在 viewWillAppear 之前调用 UITableView 方法？

> ID：716756
> 
> 赞同：1
> 
> 时间：2009-04-04T08:16:20.513
> 
> 标签：iphone, objective-c, cocoa-touch

我期待找到导致我的应用程序在某个时候崩溃的原因，我发现 UITableView 的方法在调用 viewWillAppear 之前或同时被调用。

在 viewWillAppear 中，我有代码初始化每个部分中的行数，但是在我完成设置每个部分中包含行数的数组之前调用 numberOfRowsInSection。

我相信 viewDidLoad 不适合我的情况，因为它在启动应用程序后只被调用一次。我对吗？每次屏幕上出现视图时，我都需要调用我的初始化函数。

我怎样才能克服这个失败？

先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-04T08:25:29.697

好吧，我认为这个“问题”与多个线程正在运行处理视图和 UITableView 有关。

调用该视图的视图可以（在切换到该视图之前）调用该视图上收集数据的方法。

1.  用户按下按钮
2.  您在目标视图上触发一个方法，收集信息
3.  切换查看

您可以与委托合作以了解目标视图何时准备好加载您需要的数据，这样您就可以切换到该视图。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2011-12-02T09:25:25.350

我认为正确的答案是“[super viewWillAppear:animated]”会调用UITableView的方法。所以有必要把这段代码放在初始化tableView的代码之后。

# c++ - C++ STL：哪种迭代 STL 容器的方法更好？

> ID：716762
> 
> 赞同：12
> 
> 时间：2009-04-04T08:22:56.553
> 
> 标签：c++, stl, iterator, containers

这对你们中的一些人来说可能看起来很无聊，但是以下两种在 STL 容器上的**迭代方法中哪一种更好？****为什么**？

```
class Elem;
typedef vector<Elem> ElemVec;
ElemVec elemVec;

// Method 0
for (ElemVec::iterator i = elemVec.begin(); i != elemVec.end(); ++i)
{
    Elem& e = *i;
    // Do something
}

// Method 1
for (int i = 0; i < elemVec.size(); ++i)
{
    Elem& e = elemVec.at(i);
    // Do something
} 
```

方法 0 看起来像更干净的 STL，但方法 1 用更少的代码实现了相同的效果。*对容器的*简单迭代在任何源代码中随处可见。所以，我倾向于选择方法 1，它似乎可以减少视觉混乱和代码大小。

PS：我知道迭代器可以做的不仅仅是一个简单的索引。但是，请让回复/讨论集中在容器上的简单迭代上，如上所示。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-04T08:30:21.293

第一个版本适用于任何容器，因此在将任何容器作为参数的模板函数中更有用。即使对于向量，它也可能稍微更有效。

第二个版本仅适用于向量和其他整数索引容器。对于那些容器来说，它会更惯用一些，C++ 新手很容易理解，如果你需要对索引做其他事情，这很有用，这并不罕见。

像往常一样，恐怕没有简单的“这个更好”的答案。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-04T08:38:30.383

如果您不介意（非常？）小的效率损失，我建议使用[Boost.Foreach](http://www.boost.org/doc/libs/1_35_0/doc/html/foreach.html)

```
BOOST_FOREACH( Elem& e, elemVec )
{
    // Your code
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-04T08:59:00.567

方法 0 更快，因此推荐。

方法 1 使用允许为 O(1) 的 size()，具体取决于容器和 stl 实现。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-04-29T01:09:10.033

以下在标准库容器上的迭代方法是最好的。

将[c++11](/questions/tagged/c%2b%2b11 "显示标记为“c++11”的问题")（及更高版本）的[基于范围的`for`循环](http://en.cppreference.com/w/cpp/language/range-for)与说明[`auto`符](http://en.cppreference.com/w/cpp/language/auto)一起使用：

```
// Method 2
for (auto& e: elemVec)
{
    // Do something with e...
} 
```

这与您的类似，但需要更少的输入，更少的维护，并且适用于任何与and`Method 0`兼容的容器，*包括*普通的旧数组。[`std::begin()`](http://en.cppreference.com/w/cpp/iterator/begin)[`std::end()`](http://en.cppreference.com/w/cpp/iterator/end)

 ** * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-04T08:35:15.103

方法0的更多优点：

*   如果您从向量移动到另一个容器，则循环保持不变，
*   如果需要，很容易从迭代器移动到 const_iterator，
*   当 c++0x 到来时，自动输入将减少一些代码混乱。

主要缺点是在许多情况下您扫描两个容器，在这种情况下，索引比保留两个迭代器更干净。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-04T09:25:50.287

巧合的是，我最近做了一个速度测试（用 rand() 填充 10 * 1024 * 1024 个整数）。
这些是 3 次运行，时间以纳秒为单位

```
vect[i] time      : 373611869  
vec.at(i) time    : 473297793  
*it = time        : 446818590  
arr[i] time       : 390357294  
*ptr time         : 356895778 
```

更新：添加了 stl 算法 std::generate，由于特殊的迭代器优化 (VC++2008)，它似乎运行得最快。时间以微秒为单位。

```
vect[i] time      : 393951
vec.at(i) time    : 551387
*it = time        : 596080
generate = time   : 346591
arr[i] time       : 375432
*ptr time         : 334612 
```

结论：使用标准算法，它们可能比显式循环更快！（也是很好的做法）

更新：上述时间处于 I/O-bound 情况，我对 CPU-bound 进行了相同的测试（迭代一个相对较短的向量，它应该重复适合缓存，将每个元素乘以 2 并写回向量)

```
//Visual Studio 2008 Express Edition
vect[i] time      : 1356811
vec.at(i) time    : 7760148
*it = time        : 4913112
for_each = time   : 455713
arr[i] time       : 446280
*ptr time         : 429595

//GCC
vect[i] time      : 431039
vec.at(i) time    : 2421283
*it = time        : 381400
for_each = time   : 380972
arr[i] time       : 363563
*ptr time         : 365971 
```

有趣的是，与 for_each 相比，VC++ 中的迭代器和运算符 [] 速度要慢得多（这似乎通过一些模板魔术将迭代器降级为指针以提高性能）。
在 GCC 中，at() 的访问时间更短，这是正常的，因为它是测试的唯一范围检查函数。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-04T11:11:58.503

方法0，有几个原因。

*   它更好地表达了您的意图，这有助于编译器优化和可读性
*   一个错误的可能性较小
*   即使您将向量替换为没有运算符 [] 的列表，它也可以工作

当然，最好的解决方案通常是解决方案 2：std 算法之一。std::for_each、std::transform、std::copy 或您需要的任何其他内容。这有一些进一步的优点：

*   它更好地表达了您的意图，并允许进行一些重要的编译器优化（MS 的安全 SCL 对您的方法 0 和 1 执行边界检查，但会在 std 算法上跳过它）
*   它的代码更少（至少在调用站点。当然，您必须编写一个仿函数或其他东西来替换循环体，但是在使用站点，代码会被清理很多，这可能是最重要的地方.

一般来说，避免过度指定您的代码。准确指定您想要完成的操作，仅此而已。std 算法通常是去那里的方式，但即使没有它们，如果你不需要 index `i`，为什么要有它？在这种情况下，请改用迭代器。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-04T09:20:47.053

这取决于哪种类型的容器。对于 a `vector`，您使用哪个可能并不重要。方法 0 变得更加地道，但正如大家所说，它们并没有太大的区别。

如果您决定使用 a `list`，则方法 1 原则上将是`O(N)`，但实际上没有 list`at()`方法，因此您甚至不能那样做。（所以在某种程度上，你的问题堆积了甲板。）

但这本身就是方法 0 的另一个论点：它对不同的容器使用相同的语法。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-02-14T15:51:49.433

上面没有考虑的一种可能性：根据“做某事”的细节，可以同时具有方法0和方法1，您不必选择：

```
for (auto i = elemVec.begin(), ii = 0; ii < elemVec.size(); ++i, ++ii)
{
    // Do something with either the iterator i or the index ii
} 
```

这样，无论是查找索引还是访问相应的成员，都非常简单。

# ruby - 如何将单个反斜杠字符添加到 Ruby 中的字符串？

> ID：716767
> 
> 赞同：13
> 
> 时间：2009-04-04T08:26:10.257
> 
> 标签：ruby, string

我想在“儿童世界”字符串中的撇号前插入反斜杠。有简单的方法吗？

```
irb(main):035:0> s = "children's world"
=> "children's world"
irb(main):036:0> s.gsub('\'', '\\\'')
=> "childrens worlds world" 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-04T13:13:52.920

来自[ruby​​-doc.org](http://www.ruby-doc.org/core/classes/String.html#M000832)关于以下的替换模式`gsub`：

> 序列 \1、\2 等可用于插入匹配中的连续组

这包括 sequence `\'`，这意味着“一切都遵循我匹配的内容”。

要么要么`"\\'"`都`'\\\''`产生`\'`（请记住，`\`必须在双引号*和*单引号字符串`'`中进行转义，并且必须在单引号字符串中进行转义，因此在这种情况下使用单引号实际上会使事情*变得更加*冗长）。例如：

```
puts "before*after".gsub("*", "\\'")
"beforeafterafter"

puts "before*after".gsub("*", '\\\'')
"beforeafterafter" 
```

你想`gsub`看到的其实是和`\\'`都可以产生。所以：`"\\\\'"``'\\\\\''`

```
puts s.gsub("'", "\\\\'")
children\'s world

puts s.gsub("'", '\\\\\'')
children\'s world 
```

或者，如果您必须做很多事情，`\`您可以利用这样一个事实，即当您使用`/.../`(or `%r{...}`) 时，您不必双重转义反斜杠：

```
puts s.gsub("'", /\\'/.source)
children\'s world 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-04T08:39:52.690

```
>> puts s.gsub("'", "\\\\'")
children\'s world 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-04T08:38:50.460

您的问题是字符串 "\'" 对替换字符串中的 gsub 有意义。为了让它按照你想要的方式工作，你必须使用块形式。

```
s.gsub("'") {"\\'"} 
```

# linq-to-sql - 在实体框架中返回普通对象以进行序列化

> ID：716770
> 
> 赞同：4
> 
> 时间：2009-04-04T08:31:00.167
> 
> 标签：linq-to-sql, json, entity-framework, serialization, poco

我一直在我的 ASP.NET MVC 应用程序中尝试 Linq to Sql 和 EF。切换到 EF 后，我意识到我的 XML/JSON 序列化输出有多余的东西。

XML:

```
<Test xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <EntityKey>
    <EntitySetName>Persons</EntitySetName>
    <EntityContainerName>PersonEntities</EntityContainerName>
    <EntityKeyValues>
      <EntityKeyMember>
        <Key>Id</Key>
        <Value xsi:type="xsd:int">1</Value>
      </EntityKeyMember>
    </EntityKeyValues>
  </EntityKey>
  <Id>1</Id>
  <Name>John</Name>
</Test> 
```

JSON：

```
{"Id":1,"Name":"John","EntityState":2,"EntityKey"{"EntitySetName":"Persons","EntityContainerName":"PersonEntities","EntityKeyValues":[{"Key":"Id","Value":1}],"IsTemporary":false}} 
```

相反，我希望我的输出是：

```
{"Id":1, "Name":"John"} 
```

我检索对象的 EF 查询是：

```
Tests.First(t => t.Id == testId); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-04T09:04:01.790

您可以像这样在控制器中塑造 JSON 结果：

```
public JsonResult Person(int id)
{
  var person = PersonRepository.FindByID(id);
  var result = new { Id = person.Id, Name = person.Name };
  return Json(result);
} 
```

这将限制被序列化的 DTO 只包含您想要的值。

编辑：作为对您的评论问题的部分回答；您可以创建一个更简单的 PersonViewModel 类 (DTO)，您可以将属性映射到该类。正如 John Saunders 在他的回答 Automapper 中提到的那样，Automapper 是一种简化从 EF Person 实例中复制属性值的好方法：

修改后的 Action 方法可能如下所示：

```
public JsonResult Person(int id)
{
  var person = PersonRepository.FindByID(id);
  var dto = Mapper.Map<Person, PersonViewModel>(person);
  return Json(dto);
} 
```

我能想到的唯一其他选择是使用反射来修改 Person 实体上的 DataMemberAttributes 以抑制 EntityKey 属性。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-05T12:42:41.210

解决此问题的另一种方法是使用 JavascriptSerializer 的 ScriptIgnore 属性并为相关对象创建部分类，新建 EntityKey、EntityState 属性并向它们添加 ScriptIgnore 属性：

```
public partial class Person
{
    [ScriptIgnore]
    public new System.Data.EntityKey EntityKey { get; set; }

    [ScriptIgnore]
    public new System.Data.EntityState EntityState { get; set; }
} 
```

当 Person 类通过 JavascriptSerializer 序列化时，它将忽略这些属性。但是，这不切实际，因为 EF 使用状态信息来跟踪对象，这会造成严重破坏。

如果有一种方法可以动态添加属性，那么就不需要仅仅为了添加属性就重写这些`[ScriptIgnore]`属性。但是，由于无法动态添加属性，因此该解决方案可能没有那么有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-04T11:42:22.470

到目前为止，我发现的最好的技术涉及代码生成。我在一个使用[Service Factory的项目中执行了此操作，但您可以直接使用](http://www.codeplex.com/servicefactory/)[T4 Text 模板](http://msdn.microsoft.com/en-us/library/bb126445.aspx)“手动”执行相同操作。

另外，请留意[AutoMapper](http://www.codeplex.com/AutoMapper)。它仍然足够新，我认为它是新兴技术，但我希望它很快就会出现！

# .net - 计算文件 HASH 返回不同的值

> ID：716771
> 
> 赞同：0
> 
> 时间：2009-04-04T08:34:59.377
> 
> 标签：.net, hash, sha512

有谁知道，为什么下面的代码在某些机器上返回不同的结果？

```
Private Shared Function ComputeHashValue(ByVal Data As String) As String
    Dim HashAlgorithm As SHA512 = SHA512.Create
    Dim HashValue() As Byte = HashAlgorithm.ComputeHash(Encoding.ASCII.GetBytes(Data))
    ' Looping over the array and ANDing each byte with 0111111
    For i As Integer = 0 To HashValue.Length - 1
        HashValue(i) = HashValue(i) And Convert.ToByte(127)
    Next
    Return Encoding.ASCII.GetString(HashValue)
End Function

Private Shared Function AreByteArraysEqual(ByVal array1 As Byte(), ByVal array2 As Byte()) As Boolean
    If array1.Length <> array2.Length Then Return False
    For i As Integer = 0 To array1.Length - 1
        If array1(i) <> array2(i) Then Return False
    Next
    Return True
End Function

Private Shared Sub SomeMethod()
    Dim t_prvBytes() As Byte = New Byte() {SOME VALUES} 'Previously computed HASH
    Dim t_dllStream As New IO.FileStream("C:\myfile.txt", IO.FileMode.Open, IO.FileAccess.Read, IO.FileShare.Read)

    Dim t_reader As New IO.StreamReader(t_dllStream)

    Dim t_dllHash() As Byte = System.Text.Encoding.Unicode.GetBytes(ComputeHashValue(t_reader.ReadToEnd))

    MsgBox(AreByteArraysEqual(t_dllHash, t_prvBytes))

    t_dllStream.Close()
End Function 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-04T08:51:46.077

您不应该通过`Encoding.ASCII`. 它*不是*ASCII 文本。（根本不是文本。）您还对原始文本进行 ASCII 编码的结果进行哈希处理，您使用`Encoding.Unicode`. 为什么？

您正在文本和二进制形式之间进行各种转换 - 您可能不应该做*任何*. 只需散列二进制数据（使用[`HashAlgorithm.ComputeHash(Stream)`](http://msdn.microsoft.com/en-us/library/xa627k19.aspx)），并将结果也保存为二进制。如果您*确实*需要将二进制数据转换为文本，请使用[`Convert.ToBase64String`](http://msdn.microsoft.com/en-us/library/system.convert.tobase64string.aspx).

此外，您正在将数据与先前计算的值进行比较 - 但您尚未解释先前计算的值的来源。

# php - 使用php脚本在任何网站的搜索框中输入关键字

> ID：716772
> 
> 赞同：1
> 
> 时间：2009-04-04T08:35:03.747
> 
> 标签：php, javascript

我是一个初学者，我想知道我们是否可以用 PHP 编写代码，通过它我们可以在任何网站的搜索框中输入关键字并提交。

所以这个php函数会有2个输入：

```
function enter_keyword($website_url, $keyword)
{

}

function enter_keyword($website_url, $keyword) { } 
```

这将是一个很大的帮助提前谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-04T08:41:52.527

您需要提供要在其上使用的每个网站的搜索页面的 url，并且您还必须提供包含关键字的文本字段的名称。例如，在；

```
<form method='post' action='http://site.com/search.php'> 
<input type='text' name='keyword'> 
```

url 是“ [http://site.com/search.php](http://site.com/search.php) ”，字段名称是“keyword”。

然后，使用 PHP 中的[CURL](http://au2.php.net/curl)库，您可以向该 url 发出 GET 或 POST 请求。

# linux - 在 *nix 上，有没有办法在未来的日期和时间触发进程？

> ID：716782
> 
> 赞同：2
> 
> 时间：2009-04-04T08:44:26.330
> 
> 标签：linux, scheduled-tasks

我希望允许用户输入日期和时间以通过 PHP 发送大量电子邮件，尽管我认为最好使用 *nix 命令来触发 PHP 进程。我想知道 *nix 上是否有一种方法可以做到这一点，而无需添加每 15 分钟运行一次的 cronjob 来检查是否有大量电子邮件要发送。并不是说这是一个密集的过程，但是如果有一个 cronjob 来添加和管理它会更漂亮。我认为这有点类似于具有结束日期的 Windows 计划任务，如果它没有再次计划，则设置为删除。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-04T08:49:41.107

您正在寻找[at](http://www.oreillynet.com/linux/cmd/cmd.csp?path=a/at)命令。

> 在 [选项] 时间 [日期]
> 
> 在指定时间和可选日期执行命令。命令从标准输入或文件中读取。（另见批处理。）以 EOF 结束输入。time 可以形成为数字小时（带有可选的分钟和修饰符）或关键字。它可以包含可选的日期，以月份和日期、星期几或特殊关键字（今天或明天）的形式形成。也可以指定增量。
> 
> at 命令始终可以由特权用户发出。其他用户必须在文件 /etc/at.allow 中列出（如果存在）；否则，它们不得列在 /etc/at.deny 中。如果两个文件都不存在，则只有特权用户可以发出命令。
> 
> 在典型用法中，您在特定时间运行并输入要执行的命令，然后是 EOF。
> 
> $ at 1:00 am tomorrow at> ./total_up > output at> mail joe < output at> 在 2003-03-19 01:00 按 Ctrl-D 输入作业 1
> 
> 这两个命令也可以放在一个文件中并按如下方式提交：
> 
> 明天凌晨 1:00 美元 < 脚本文件

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-04T08:47:17.493

你可以使用[`at`](http://www.computerhope.com/unix/uat.htm).

# python - 在python中定位（文件/行）构造函数的调用

> ID：716795
> 
> 赞同：1
> 
> 时间：2009-04-04T08:58:33.003
> 
> 标签：python, exception, event-handling, stack-trace

我正在实现一个事件系统：各种代码将事件发布到一个中心位置，在那里它们将分发给所有侦听器。这种方法的主要问题是：当事件处理过程中发生异常时，我无法再知道是谁发布了该事件。

所以我的问题是：有没有一种有效的方法来找出谁调用了构造函数并在 Python 2.5 中记住这一点？

更多信息：简单的方法是使用 traceback 模块在构造函数中获取堆栈的副本并记住这一点。唉，我很少需要这些信息，所以我想知道是否有办法缓存这些信息，或者我是否可以记住最顶层的堆栈帧并在我真正需要这些数据的极少数情况下工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-04T09:41:55.083

```
import sys
def get_caller(ext=False):
    """ Get the caller of the caller of this function. If the optional ext parameter is given, returns the line's text as well. """
    f=sys._getframe(2)
    s=(f.f_code.co_filename, f.f_lineno)
    del f
    if ext:
        import linecache
        s=(s[0], s[1], linecache.getline(s[0], s[1]))

    return s

def post_event(e):
    caller=get_caller(True)
    print "Event %r posted from %r"%(e, caller)

## Testing the functions.

def q():
    post_event("baz")

post_event("foo")
print "Hello!"
q() 
```

结果是

```
Event 'foo' posted from ('getcaller.py', 20, 'post_event("foo")\n')
Hello!
Event 'baz' posted from ('getcaller.py', 17, '\tpost_event("baz")\n') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T10:15:51.460

您可以简单地存储对调用者框架对象的引用，但这可能是个坏主意。这使帧保持活动状态，并且还保存对所有使用的局部变量的引用，因此如果它们碰巧使用大块内存，它可能会影响性能，并且如果它们（错误地）依赖于终结，则可能会产生更糟糕的影响超出范围时销毁锁和文件句柄等资源。

这意味着您需要保留堆栈跟踪的字符串表示形式，这对于您的目的来说并不理想（需要实际进行一些处理才能获得它，即使它很少需要）。不幸的是，似乎没有什么办法可以解决这个问题，尽管您可以考虑禁用它，直到您设置一些配置选项。这样，您可以在常见情况下获得更好的性能，但在尝试诊断故障时仍然可以启用该设置。

如果您的调用函数单独（或少数父调用者）足以区分路由（即通过 func1() 调用时跟踪始终相同，并且没有 func2 -> func1() vs func3() - > func1() 来区分），您可以根据调用帧（或最后两个调用帧等）的文件名和行号维护哈希。但是，这可能与您的情况不匹配，如果不匹配，您最终会得到虚假的堆栈跟踪。

请注意，如果您确实想要调用者的框架，使用[`inspect.currentframe(depth)`](http://docs.python.org/library/inspect.html#inspect.currentframe)可能是获取它的更好方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-05T02:37:33.830

我认为*最简单*的方法是向相关事件添加一个 ID 字段，并让每个事件源（通过此处适当的“事件源”定义）在发布时提供唯一标识符事件。您确实会获得更多的开销，但可能不足以成为问题，而且我怀疑您会找到其他方法来了解事件的来源会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-04T09:06:57.617

将堆栈跟踪的散列附加到事件的构造函数并将实际内容以散列作为键存储在内存缓存中可能是值得的。

# .net - .NET 可达到的最大内存？

> ID：716798
> 
> 赞同：16
> 
> 时间：2009-04-04T09:01:36.973
> 
> 标签：.net, memory

在 .NET 托管代码中可以实现的最大内存量是多少？它是否取决于实际架构（32/64 位）？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-04T09:09:14.990

.NET 代码没有确切的数字。

如果您在 32 位 Windows 上运行；如果在 Windows Server 2003 上使用 /3GB 开关，您的*进程*最多可以寻址 2 GB，3 GB。

如果您在 64 位机器上运行 64 位进程，则您的*进程*可以寻址多达 8 TB 的地址空间（如果存在那么多 RAM）。

然而，这并不是全部，因为 CLR 会为每个进程占用一些开销。同时，.NET 会尝试分块分配新内存；如果地址空间是碎片化的，这可能意味着您无法分配更多内存，即使有些内存可用。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-04T09:52:41.530

在 C# 2.0 和 3.0 中，托管代码中单个对象的大小也有 2G 的限制。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-04T13:35:24.773

.NET 进程可以处理的内存量取决于它是否在 32/64 位机器上运行，以及它是否作为 CPU 不可知进程或 CPU 特定进程运行。

默认情况下，.NET 进程与 CPU 无关，因此它将以 Windows 版本自然的进程类型运行。在 64 位中它将是一个 64 位进程，而在 32 位中它将是一个 32 位进程。您可以强制 .NET 进程以特定 CPU 为目标，并使其在 64 位机器上作为 32 位进程运行。

如果排除大地址感知设置，以下是各种细分

*   32位进程可以寻址2GB
*   64位进程可以寻址8TB

这是基于 Windows 提供的各种选项的可寻址空间的完整细分的链接。

[http://msdn.microsoft.com/en-us/library/aa366778.aspx](http://msdn.microsoft.com/en-us/library/aa366778.aspx)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-04T11:48:38.290

对于 64 位 Windows，虚拟内存大小为 16 TB，在用户模式和内核模式之间平均分配，因此用户进程可以寻址 8 TB (8192 GB)。这比 64 位可寻址的整个 16 [EB](http://en.wikipedia.org/wiki/Exabyte)空间要小，但它仍然比我们习惯的 32 位要多得多。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-12-15T22:51:09.193

我最近一直在对 .NET 中 32 位进程的内存限制进行广泛的分析。我们都被我们可以在 .NET 应用程序中分配高达 2.4GB (2^31) 的想法轰炸了，但不幸的是，这不是真的 :(。应用程序进程有这么多的空间可以使用，并且操作系统做得很好然而，为我们管理它的工作，.NET 本身似乎有自己的开销，对于推动内存限制的典型现实世界应用程序，它大约占 600-800MB。这意味着，一旦你分配一个整数数组，大约需要1.4GB，您应该会看到 OutOfMemoryException()。

显然，在 64 位中，这个限制发生得更晚（让我们在 5 年后聊聊 :)），但是由于字长增加，内存中所有内容的一般大小也会增长（我发现它是 ~1.7 到 ~2 倍）。

我可以肯定的是，操作系统的虚拟内存理念绝对不会在一个进程中为您提供几乎无限的分配空间。只有这样才能将全部 2.4GB 的内存分配给一次运行的所有（许多）应用程序。

我希望这种见解有所帮助。

我最初在这里回答了一些相关的问题（我还是个新手，所以不确定我应该如何做这些链接）：

[单个 .NET 进程是否有内存限制](https://stackoverflow.com/questions/200348/is-there-a-memory-limit-for-a-single-net-3-5-process/1910974#1910974)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-04T13:02:21.293

.NET 运行时可以为其宿主中的用户模式程序分配所有可用内存。请注意，这并不意味着所有内存都将专用于您的程序，因为某些（相对较小的）部分将专用于内部 CLR 数据结构。在 32 位系统中，假设设置为 4GB 或更多（即使启用了 PAE），您应该能够获得最多大约 2GB 分配给您的应用程序。在 64 位系统上，您应该能够获得 1TB。有关 Windows 内存限制的更多信息，请查看[此页面](http://msdn.microsoft.com/en-us/library/aa366778.aspx)。这里提到的每个数字都必须除以 2，因为 Windows 保留地址空间的上半部分供内核模式下运行的代码使用（环 0）。另外，请注意，当 32 位系统的限制超过 4GB 时，使用[PAE](http://en.wikipedia.org/wiki/Physical_Address_Extension)是隐含的，因此除非操作系统支持 4gt，否则您仍然不能真正超过 2GB 限制，在这种情况下，您可以达到 3GB。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-04T09:07:56.787

是的，在 32 位环境中，您被限制为 4GB 地址空间，但 Windows 声称大约有一半。在 64 位架构上，它要大得多。我相信是4G * 4G

在 Compact Framework 上，它通常是几百 MB 的数量级

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-04T10:10:31.800

我认为其他答案非常幼稚，在现实世界中，在消耗 2GB 内存之后，您的应用程序将表现得非常糟糕。根据我的经验，GUI 通常会变得非常笨重，在大量内存消耗后无法使用。

这是我的经验，显然造成这种情况的实际原因可能是对象变得太大，因此对这些对象的所有操作都需要太多时间。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-11T22:03:21.530

以下博客文章详细介绍了 x86 和 x64 最大内存。它还有一个小工具（可用源），可以轻松地对不同的内存选项进行东移：http: [//www.guylangston.net/blog/Article/MaxMemory](http://www.guylangston.net/blog/Article/MaxMemory)。

# sharepoint - 获取 Sharepoint 门户站点的（公共）Internet URL

> ID：716799
> 
> 赞同：3
> 
> 时间：2009-04-04T09:02:04.647
> 
> 标签：sharepoint, sharepoint-2007

我有一个自定义信息路径工作流程，允许用户提交 expesne 报告。每当有人在表单库中提交费用报告时，就会启动工作流。工作流检查 weburl 并使用通用方法创建指向工作流项的链接，并将此链接通过邮件发送给提交者和批准者。

现在我想要实现的是我需要一种使用公共 url 指向工作流项目的方法，因此即使用户从 Intranet 或 Internet 提交请求，链接也将指向 Internet url，因此用户可以打开当 Intranet 不可用时，使用 Internet url 从他们的邮箱中获取项目。

所以我想简而言之，我需要一种方法来获取网站的公共网址。还要记住，网站可以通过一些安全设置扩展到互联网。什么是最简单和最有效的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T11:52:00.967

您可以通过创建新的 SPSite 对象并在构造函数中为其指定区域来确保始终从特定区域获取 URL。在您的情况下，您可以尝试使用*默认*区域（例如，SharePoint 在发送电子邮件时使用来自该区域的 URL）或*Internet*区域。您在下面有一个小样本：

```
using(SPSite site = new SPSite(currentSiteId, SPUrlZone.Default)
{
    string publicUrl = site.MakeFullUrl(serverRelativeUrl);
    // note that MakeFullUrl takes a server relative url not a site relative one
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-16T07:23:45.040

无论用户从哪个区域访问网站，您的页面或链接的相对路径都是相同的。您需要在 URL 中更改的只是主机名部分。

您可以使用以下代码获取任何区域的 URL

```
SPContext.Current.Site.WebApplication.GetResponseUri(Microsoft.SharePoint.Administration.SPUrlZone.Default).AbsoluteUri 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T16:21:18.560

如果我了解您的尝试，您需要一种可通过 Internet 访问的方法来访问 SharePoint 工作流对象。如果我错了，请纠正我。

这是我要做的：我将建立一个带有 DNS 的简单网站，该网站有一个公开工作流对象的页面。这样，您就可以将此站点用作通知中链接的基础。

示例：我有一个不久前编写的 HTML 表单引擎。一位客户刚刚要求它也可以在互联网上访问。我在 IIS 中创建了一个新站点，反向代理了 IP 地址，瞧，我的 Intranet 应用程序暴露在 Internet 上。当然，还有一些安全问题和内部网的小问题需要处理，但没什么大不了的。

希望有帮助。

# development-environment - 使用笔记本电脑作为第二个编程监视器

> ID：716809
> 
> 赞同：13
> 
> 时间：2009-04-04T09:18:19.570
> 
> 标签：development-environment, vnc, multiple-monitors, kvm

多显示器编程的乐趣数不胜数，我认为仅关于 Coding Horror 主题的博文就大约有 5 篇！我经常在我的主机上用 Windows 编写代码，并将我的 Mac 笔记本电脑放在一边。我使用 Mac 既可以编译 Mac 版本，也可以作为我的“参考网络浏览器”。没有KVM或任何东西。

然而在一次会议上的一次随意交谈让我想到了一个问题，我可以使用两台独立的机器来**共享**窗口吗？从字面上将一些窗口从一台机器移动到另一台机器，所以我可以使用一台 PC 的显示器作为另一台电脑的“溢出”。

一些谷歌搜索突然表明这在某些情况下是可能的：

[Synergy](http://symless.com/synergy/second-screen)和[Maxivista](http://www.maxivista.com/)

我的问题是是否有**程序员**尝试过这样的设置。我们有独特的需求，尤其是多个文本窗口和编辑器，这种工具可能是一个巨大的胜利或巨大的麻烦。

这个解决方案感觉就像是简单的 KVM 切换和多台显示器的组合……听​​起来像是一个编程梦！因此，在我投资于相当复杂的设置之前，建议或特别是编程环境中的实际经验报告将非常有用。

跟进：听起来我在要求一些不存在的东西！它是一种软件 KVM**和**VNC 的组合。但是 VNC 需要打破应用程序窗口并允许单独操作（例如 maxivista 商业工具，它仅适用于 Vista）。

感谢所有的反馈。如果有人有动力成为这个新领域的第一人，那么看起来就需要一个很酷的应用程序！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-04T09:28:59.543

Synergy 不允许您在机器之间移动窗口（这将需要在幕后进行大量工作），但它确实允许您在两台机器之间共享键盘和鼠标，因此它们“看起来”都是一台机器，但实际上是分开运行的。

我个人使用[Input Director](http://www.inputdirector.com/)，因为我发现它比 Synergy 更稳定。我的笔记本电脑右侧有一个外接显示器，左侧是我的桌面作为输入控制器从属设备。我的桌面运行不同的操作系统，基本上是我的豚鼠盒子，用于测试东西以及我离开办公室时需要继续运行的任何东西。剪切 + 粘贴非常无缝，因此我可以很高兴地在我的桌面上启动一个到服务器的 RDP 会话，然后从该服务器上剪切 + 粘贴 SQL 脚本到我的笔记本电脑。

如果您有几个物理盒子和显示器，这是一件非常有用的事情:)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-02T13:32:31.533

我实际上已经设法使用备用笔记本电脑作为台式电脑的第二台显示器。这允许将 Windows 移动到第二台 PC，但反之亦然。

解决方案基本上适用于任何操作系统。

唯一的要求是服务器 PC 上的备用 VGA（或 DVI-I/DVI-A）端口。

1.  制作一个虚拟 VGA 插头[http://www.overclock.net/t/384733/the-30-second-dummy-plug](http://www.overclock.net/t/384733/the-30-second-dummy-plug) 这也适用于 DVI-I/DVI-A 端口 + DVI-VGA 适配器
2.  使用您的操作系统检测虚拟监视器。监视器将被检测为非常通用的监视器，因此您可以设置任何分辨率。将其设置为从 PC 分辨率。
3.  使用任何远程控制软件从从机连接到服务器 PC。将其设置为仅显示“虚拟”监视器。

就这样。您的从属 PC 是服务器 PC 的第二台显示器。

我在 Windows 7 + TeamViewer 上使用过它。我还设置了 Mouse Without Borders（Microsoft Synergy 模拟），以便能够使用具有相同鼠标和键盘的从属 PC，但如果您打算将其转换为仅显示器，则不需要这样做。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-08-11T11:54:04.090

[Xdmx - 分布式多头 X 项目](http://dmx.sourceforge.net/)（仅限 Linux）

在外部机器上提供本机 X 显示，没有 VNC 缺点。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-04T12:18:15.550

以下内容并不完全是您想要的，但非常接近：

您可以在 Windows 机器上启动[VNC](http://en.wikipedia.org/wiki/Vnc)服务器，这将让您“导出”其图形屏幕。

然后，从 Windows 机器上拔下显示器，并将其用作外部笔记本电脑显示器，与您的 Mac 笔记本电脑一起使用。

[在那里，在您的 Mac 上，您只需使用 VNC的 Chicken](http://sourceforge.net/projects/cotvnc/)连接到 VNC 会话，这将为您提供 Windows 机器的图形屏幕内容作为 Mac 窗口（以交互方式，因此您可以实际控制 Windows 机器，就好像您是直接处理）。你可以把它放在外接显示器上，你也可以把其他窗口放在那里，这样你就真的有一个共享的环境了。

我相信这个解决方案还可以让您将内容从 Windows 屏幕复制并粘贴到 Mac 窗口，反之亦然。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-06T02:13:07.593

我在编程时在 WinXP 上使用 MaxiVista。它工作得非常好，让我可以在我的多显示器配置中添加第三个屏幕。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-03-14T08:41:00.097

Windows 用户在这里有希望：http: [//virtualmonitor.github.io/](http://virtualmonitor.github.io/) 看起来像一个正在进行中的工作，只支持 windows 2000 - windows 7，但他正在寻找 windows 7 - 8 的帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-04T09:30:38.993

不幸的是，协同目前不允许跨屏幕移动窗口。它仅将鼠标和键盘事件从一组物理设备转发到不同的计算机。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-08-24T17:24:28.397

是的，我喜欢它。它可以让你在笔记本电脑上通过 2 个屏幕，我真的发现 3 个很多。

如果您的主机是 Mac，您需要[ScreenRecycler](http://www.screenrecycler.com/ScreenRecycler.html)。然后，您可以在其他 Mac、Windows 和 Linux 机器（任何带有 VNC 客户端的机器）上使用监视器。不过，你会想要比 Mac 糟糕的 Windows 管理更好的东西。我推荐Many Tricks' [Moom](http://manytricks.com/moom/) and [Witch](http://manytricks.com/witch/)。

正如@LachlanG 所说，在 Windows 上，[MaxiVista](http://www.maxivista.com/)运行良好。它支持从 Windows、Mac 和 Linux 机器添加监视器。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-12-24T07:32:33.500

我正在重复使用我的旧笔记本电脑作为第二台显示器，以便在编码时查看实时预览。我正在使用[SpaceDesk](http://spacedesk.ph/)，它是免费的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-11-27T01:14:26.847

我使用协同的屏障和开源分支。它有点难用，但效果很好。（要找到它，只需在 google 搜索“barrier github”）。

# c++ - BOOST_FOREACH：使用这个 STL 容器有什么错误？

> ID：716810
> 
> 赞同：4
> 
> 时间：2009-04-04T09:18:48.150
> 
> 标签：c++, visual-c++, boost

有谁知道为什么下面会在 VC9 上产生错误？

```
class Elem;
class ElemVec : public vector<Elem>
{
    public:
        void foo();
};

void ElemVec::foo()
{
    BOOST_FOREACH(Elem& elem, *this)
    {
        // Do something with elem
    }
    return;
} 
```

我得到的错误是：

```
error C2355: 'this' : can only be referenced inside non-static member functions 
```

我现在唯一可以正确编译的（hack）解决方案是：

```
void ElemVec::foo()
{
    ElemVec* This = this;
    BOOST_FOREACH(Elem& elem, *This)
    {
        // Do something with elem
    }
    return;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-04T09:51:23.140

您不应该从 STL 容器继承。这些不是多态类，这是`BOOST_FORACH`无法处理您的派生类的原因。

尝试改用聚合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T10:01:50.323

您使用的是哪个编译器/Boost 版本？我可以毫无问题地编译以下内容（VS2005/Boost 1.38）：

```
#include <boost/foreach.hpp>
using namespace std;
struct xxx : std::vector<int>
{
    void test()
    {
        BOOST_FOREACH(int x, *this)
        {
        }
    }
}; 

int main(void) {
    xxx x;
    x.test();
    return 0;
} 
```

如果您想了解更多详细信息，请搜索 Boost[错误库。](https://svn.boost.org/trac/boost/search?ticket=on)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T09:34:15.587

我从未见过那个错误。我猜它来自于 BOOST_FOREACH 宏的实现。

请问您为什么要创建一个基于 vector<...> 的类而没有 vector 成员变量？

**编辑** 在[这个线程](http://lists.boost.org/Archives/boost/2006/04/103992.php)之后，我发现这实际上是一个视觉工作室错误。您找到的解决方案似乎是最简单的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-04T10:01:22.947

嗯，在我的 msvc (2005) 编译器上全部编译成功。

也许您有一些错误，但在创建示例时已修复或避免它。

# mstest - MSTest 和自定义消息

> ID：716818
> 
> 赞同：1
> 
> 时间：2009-04-04T09:28:36.083
> 
> 标签：mstest

最近我开始使用 mstest 进行测试。

1.  如果测试成功，有什么方法可以将消息写入测试窗口？我看不到路，只有在测试失败时才允许发送消息。如果我想说，打印一点测试的描述，这样我就可以看到测试的含义而无需打开测试。或者，就像现在的情况一样，我正在测量一些测试的执行时间，我想打印出那个时间。

2.  有没有办法扩展测试方法，以便轻松选择是否需要时间测量的测试，选择测试执行模式？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-04T09:36:06.813

右键单击测试结果窗口中的列，然后选择“添加/删除列”。添加“持续时间”和“输出 (StdOut)”列。这将为您提供测试时间并让您查看测试打印的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-04T11:00:02.167

为什么不给你的测试起描述性的名字呢？

```
[Test]
public void AddsTwoNumbersTogether() {...}

[Test]
public void DividesFirstNumberBySecondNumber() {...} 
```

等等

# c# - 如何从 .NET 1.1 发送短信？

> ID：716826
> 
> 赞同：0
> 
> 时间：2009-04-04T09:38:00.273
> 
> 标签：c#, sms, .net-1.1

### 复制

> [C# && 短信标签](https://stackoverflow.com/questions/tagged/c%23%20sms)

我在 .net 框架 1.1 中工作 .. 从我的应用程序中我需要向手机发送短信。可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-04T10:08:14.007

大量短信发送者有很多短信网关服务。它们都提供了一个（自定义）API。通常，您只需制作一个特殊的 HTTP 请求。这些 API 可以用于任何语言，.net 也是如此。

每个运营商都有自己的费率，因此请进行一些价格比较。我不知道你在哪个国家（斯堪的纳维亚？）所以我不能推荐任何人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-04T09:45:00.863

如果您需要向手机发送短信，您可能需要[短信网关](http://en.wikipedia.org/wiki/SMS_gateway)的服务。但是，如果您需要发送的消息量不是很高，并且您可以自己支付每条 SMS 的费用，您可以查看如何通过 USB 或 COM 将手机用作调制解调器并以这种方式发送消息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-09T19:47:37.023

您将需要使用一个 HTTP API，使您能够从您的应用程序发送短信。类似[http://sms.yuboto.com/http-api](http://sms.yuboto.com/http-api)

# asp.net - jQuery Click 事件在 asp:button 上

> ID：716827
> 
> 赞同：5
> 
> 时间：2009-04-04T09:39:51.157
> 
> 标签：asp.net, jquery

我有一个服务器端按钮

```
<asp:Button ID="btnSummary" runat="server" OnClick="btnSummary_Click" Text="Next" /> 
```

我想使用其 ID 附加 jQuery Click 事件，而不是使用替代类属性方式。

我试图将点击事件附加为：

```
$("#btnSummary").click(function() 
        {
            alert("1");
        }); 
```

但是，它的点击事件不会被触发。另外，我也试过了`$("id[$btnSummary]")`。

有什么方法可以在没有按钮类属性的情况下使用 jQuery 在 asp:button 上附加点击事件？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-04T09:52:21.267

您可以在这里找到一些选项

[如何阻止 ASP.NET 更改 ID 以使用 jQuery](https://stackoverflow.com/questions/497802/how-to-stop-asp-net-from-changing-ids-in-order-to-use-jquery/498972#498972)

**编辑：**

在阅读了您对其他答案的评论后，听起来您需要在 ASP.NET AJAX 的[pageLoad](http://www.asp.net/ajax/documentation/live/overview/AJAXClientEvents.aspx)中绑定 onclick 事件处理程序，以便它绑定在每个回发上，包括异步回发。另一方面， $(document).ready() 在初始页面加载时仅绑定一次

```
function pageLoad(sender, args)
{
     $("#<%=btnSummary.ClientID %>").click(function() 
    {
        alert("1");
    });
} 
```

Dave Ward 写了[一篇关于 pageLoad 和 $(document).ready() 之间区别的好文章](http://encosia.com/2009/03/25/document-ready-and-pageload-are-not-the-same/)。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2011-08-11T21:52:37.563

将 ClientIDMode="Static" 添加到您的 asp:button 中，如下所示：

```
<asp:Button ID="Button1" runat="server" ClientIDMode="Static" Text="Button" /> 
```

这将使 ID 保持不变。它禁用此控件的自动生成名称。

这是对此的参考：http: [//msdn.microsoft.com/en-us/library/system.web.ui.control.clientid.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.control.clientid.aspx)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-04T09:44:42.220

1.  运行站点时检查 id 属性是否在 html 源代码中。

2.  您是否在文档就绪功能中具有单击功能？

-

```
$(document).ready(function() {
    // put all your jQuery goodness in here.
}); 
```

编辑：

由于它是服务器端控件并且 ID 更改，因此您需要在每个页面加载时使用变量动态更新 javascript。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-04T09:50:08.357

ASP.NET 为客户端的东西生成一个 UniqueID，您可以使用它来绑定事件。该 ID 是根据该控件在 ControlCollection 和不同 INamingContainers 中的位置生成的，它很难看，你猜不到......

在页面的某处添加此类代码以连接该按钮。

```
<script type="text/javascript">
  $(function() { $("#<%=btnSummary.ClientID%>") }).click(function(){/*...*/});
</script> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-15T19:49:03.757

我现在有点困惑。让我解释：

```
1\. I added a button on the page:
<form id="form1" runat="server">
<div>
<asp:Button ID="Button1" runat="server"  Text="Button" />
<div>

2\. Then I added a JavaScript and jQuery:
<script type="text/javascript">
                    $(document).ready(function() {
                    $("#Button1").click(function() {
                        alert("Hello world!");
                    });

                    });
                </script>

3\. The generated html is this:
<div>
  <input type="submit" name="Button1" value="Button" id="Button1" />
<div> 
```

现在，我没有看到 ASP.NET (asp.net 3.5) 更改了 ID。为什么我会看到不同的行为？

顺便提一句。当我按下按钮时，这确实有效！

谢谢。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-09-09T16:31:02.630

将选择器分配给班级对我有用。

```
<asp:Button ID="Button1" runat="server" OnClick="Button1_Click" Text="My Button" CssClass="myButton"/>

<script>
    jQuery(".myButton").click(function () {
        alert("clicked");
    });
</script> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-08-29T08:00:12.503

请使用以下语法：`$("[id*=Button1]")`引用任何 asp 控件

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-10-12T21:58:46.577

ASP.NET 给你添加 id（例如：id " `selectButton`" 变成

```
"ctl00_middleContent_gvPeople_ctl04_selectButton"); 
```

使用**jquery**语法搜索 id 中不变的部分。

```
$("[id='_selectButton']") 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-11-07T14:10:44.983

在使用 updatepanels 时使用 pageLoad，因为 document.ready 仅在页面初始化时运行一次，并且在部分回发时失去其绑定。PageLoad 每次都会运行，因此会重新绑定每个部分回发。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-03-05T07:51:23.933

我有同样的问题，这对我有用

```
<asp:Button ID="Button1" runat="server" Text="ASP Button" OnClientClick="return false;" /> 
```

它的添加 return false 似乎有所作为。希望这可以帮助。

问候

彼得

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-11-23T10:49:42.173

请尝试以下：

```
document.getElementById("<%=button1.ClientID %>").click(); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-10-09T20:31:36.493

将其包装`<asp:Button/>`在 html`<div>`容器中。

```
<div id="testG">  
   <asp:Button ID="btn1" runat="server" Text="TestButton" />
</div> 
```

```
$(document).ready(function () {
    $("#testG").click(function () {
                alert("1");
                //your code 
     });
}); 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2016-02-16T16:26:33.273

你已经到达那里。我猜有两种方法，

1.  从浏览器检查控件并查看控件 ID，看起来像`ct1000_ btnSummary`. 在 jQuery 的 Click 事件上使用此 ID。

替换代码

```
 $("#ctl00_contentplcedholder_btnSummary").click(function() 
    {
        alert("1");
    }); 
```

2.  下一个非常简单，只需将属性 ClientIdMode="static" 添加到您的控件并使用它将触发的实际 Jquery 单击事件。

# flex3 - 在 flex 中引用组件内的控件

> ID：716838
> 
> 赞同：2
> 
> 时间：2009-04-04T09:53:15.290
> 
> 标签：flex3, air

我在访问组件内的控件时遇到问题。场景是我有一个数据网格，其中有一个组件，其中有一个文本区域。现在通过选择一个菜单选项，我需要关注 textarea。请帮助我参考文本区域。我需要在那个文本区域中设置焦点。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-06T21:44:03.223

你可以说

```
myDataGrid.editedItemPosition = {rowIndex:4, columnIndex:1};
myDataGrid.editedItemRenderer.myTextArea.text = "blah"; 
```

这可能仅在您的组件设置为 itemEditor 而不是 itemRenderer 时才有效。

# iphone - iPhone-SDK 的最佳 SQLite 3 教程在哪里？

> ID：716839
> 
> 赞同：17
> 
> 时间：2009-04-04T09:55:14.193
> 
> 标签：iphone, sqlite

我正在寻找一个完整的教程，它不仅告诉我如何执行查询，还告诉我如何设置整个事情，包括设置库、创建数据库等等。

我在哪里可以找到它？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-04T11:01:52.363

在 iPhone 上使用 SQLite 3 与在任何其他平台上使用它并没有什么不同。您应该阅读[一般 SQLite 文档](http://www.sqlite.org/docs.html)。

在您的 iPhone 应用程序中，您通常在`applicationDidFinishLaunching:`应用程序委托的方法中打开您的 SQLite 数据库。之后，您就可以使用您的数据库了。

我在 iPhone 上使用了[Gus Mueller 的 FMDatabase](http://www.gusmueller.com/blog/archives/2005/3/22.html)类。它们为 SQLite 提供了一个精简的包装器。

[最后一点： CoreData](http://developer.apple.com/macosx/coredata.html)似乎将在 OS 版本 3 的 iPhone 上可用。您可以通过 CoreData 框架使用 SQLite。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-03-17T23:32:43.417

**斯坦福的 cs193p *iPhone 应用程序开发*上学期展示了如何在 iphone 上设置和使用 sqlite3。**

我还没有查看最新的讲座，但最近学期有对 sqlite 的参考。iTunesU 中有讲义和视频 - 查看[cs193p 网站](http://www.stanford.edu/class/cs193p/cgi-bin/drupal/)以获取链接/参考/示例代码/讲义。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-03-17T18:30:37.163

我的[Delicious](http://en.wikipedia.org/wiki/Delicious_%28website%29)书签中有一些 iPhone [SQLite 链接。](http://delicious.com/iggymwangi/SQLite)那里应该有足够的链接来教你所有你需要的 SQLite。许多教程非常简单易懂。那里也有一些包装纸。我没有使用任何包装器，但它们看起来很有趣。此外，请查看 Delicious 上标记为 SQLite 的其他书签项目。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-04T12:02:38.223

除了 Peter Quade 的出色回答之外，我还建议您查看[http://www.iphonekicks.com/tags/SQLite](http://www.iphonekicks.com/tags/SQLite) - 在这里您会找到许多 SQLite 主题的书签。

仅供参考，[iPhone Kicks](http://iphonekicks.com/)是一个社交图书标记网站，一个[Digg](http://www.google.com/search?q=site:en.wikipedia.org%20digg%20&ie=utf-8&oe=utf-8)克隆，但纯粹用于 iPhone SDK 链接 :-)

# php - 通过ajax将多个数组传递给javascript

> ID：716850
> 
> 赞同：0
> 
> 时间：2009-04-04T10:09:27.827
> 
> 标签：php, javascript, ajax, arrays, json

要通过 ajax 将数组从 PHP 传递到 javascript，我将使用 json_encode，并在 javascript 端接收它。但是，我将从我的 MySQL 数据库返回多行，并且需要返回多个 JSON 格式的数组。我想到的一种方法是在 php 中使用一些晦涩的字符（例如管道字符）将 JSON 数组串在一起，然后在 javascript 端将它们分开。但是有没有更优雅的方法来做到这一点？

编辑：[这篇文章](https://stackoverflow.com/questions/515684/how-to-use-json-with-jquery)解释了我想要做什么。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-04T10:13:09.610

只需将它们作为 JSON 编码的数组发送即可。

```
<?php
$row=array('foo'=>'bar','baz'=>'quux');
echo json_encode(array($row,$row,$row,$row));
?> 
```

结果是

```
[
 {"foo":"bar","baz":"quux"},
 {"foo":"bar","baz":"quux"},
 {"foo":"bar","baz":"quux"},
 {"foo":"bar","baz":"quux"}
] 
```

然后可以像客户端上的数组一样处理它。

# java - 使用 Java 和 SQLite 的递归数据处理性能

> ID：716857
> 
> 赞同：5
> 
> 时间：2009-04-04T10:18:59.127
> 
> 标签：java, android, sqlite, recursion

*如果您的答案与 Java / SQLite 无关，我很乐意阅读。*

## 环境

我使用以下方案将项目存储在数据库中：

```
###################
#       Item      #    
###################
#      _id        #    This is the primary key
#    parent_id    #    If set, it the ID of the item containing this item
#      date       #    An ordinary date
#  geocontext_id  #    Foreign key to a pair of named coordinates
###################

###################
#   Geocontext    #    
###################
#       _id       #    This is the primary key
#       name      #    Way for the user to label a pair of coordinates (e.g : "home", "work")
#         x       #    One of the coordinate
#         y       #    The other one
################### 
```

## 问题

我必须根据地理环境和日期过滤项目。如果项目都在同一级别，这将是一件容易的事，但诀窍是它是递归的。例如：

```
root
      |_item 1
      |_item 2 
      |      |_item 4
      |      |_item 5
      |             |_item 6
      |_item 3
      |      |_item 8
      |             |_item 10
      |_item 11
      |       |_item 12
      |_item 7 
```

递归深度没有明确的限制。

现在，如果我们在任何节点中并使用日期“4 月 1 日”进行过滤，我们不仅必须看到直接包含在与日期匹配的节点中的**项目，而且还必须看到包含与日期匹配的项目的项目**.

EG：我们在“Items 2”中，如果“item 6”匹配日期，那么我们认为“item 5”也匹配日期，我们必须保留它。如果我们位于根目录，则必须显示第 2 项。

地理环境也是如此，但更难，因为：

*   它存储在另一个表中。
*   匹配上下文是一项昂贵的数学计算。

当然，强制匹配会导致软件运行缓慢，用户体验非常差。

注意：**我不需要显示树**。我从树中显示过滤数据的列表。我们必须只看到顶级元素的平面列表。挑战在于根据所有子层级决定是否显示每个元素。

## 我是如何尝试解决的

我想我可以通过使用更多的表来缓存平面数据来缓解这个问题：

```
###################
# Geocontex_cache #    
###################
#     item_id     #     I can Join the items table on this field
#     child_id    #     I can delete / update a child, and so delete / update the cache
#  geocontext_id  #     I can delete / update a geocontext, and so delete / update the cache
#        x        #      Here, I can brute force :-)
#        y        # 
###################

###################
#    Date_cache   #    
###################
#     item_id     #     
#     child_id    #    
#       date      #    
################### 
```

这似乎是合理的，但我还没有尝试过。尽管如此，它应该有以下缺点：

*   我将代价高昂的过程移至必须管理缓存日期的 get/set/create/delete 方法。这将是一个难以编写和维护的代码。一个五个深度级别的项目将触发一个递归地影响五个父母的过程。

*   数据库的大小可能会变得巨大。五个深度级别的项目存储五个父母的缓存数据。不知道它是否相关，因为这是一个带有手动输入的单用户应用程序。我认为没有人会插入超过 1000 个深度超过 10 级的项目。

现在好消息是我们从金字塔的底部到顶部，而不是相反，所以它并不像看起来那样可怕。当我必须处理删除父项时，这将是另一个令人头疼的问题，但我将其保存为另一个问题；-)。

## 现在我的问题

您将如何以最佳方式存储数据和处理过滤？

*选修的 ：*

我应该定义一个明确的递归深度限制吗？我应该使用 SQL 还是 Java 执行过滤？SQL 肯定会更快，但在 Java 中匹配地理上下文要容易得多。

当我在 Android 平台上工作时，我有以下限制：

*   Java 是唯一可用的语言，而不是整个标准库。

*   SQLite 是唯一可用的 DBMS。

*   性能和内存是重要的问题。如果您必须选择，电池寿命和性能是重中之重。

*   Exotics 外部库可能无法使用。

PS：我挖掘了 SO 并发现了一些有趣的信息（特别[是什么是最有效/优雅的方法来将平面表解析成树？](https://stackoverflow.com/questions/192220/what-is-the-most-efficientelegant-way-to-parse-a-flat-table-into-a-tree)）。这是一个提示，但不是问题解决者。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-07T15:56:15.593

**1）**首先，让我们看一下简单地将所有内容都放入内存中。这是简单、灵活、最重要的是快速的解决方案。缺点包括您必须在启动时将所有内容读入内存（给用户一个漂亮的加载栏，他们甚至不会注意到），并且可能需要做一些额外的工作以确保所有内容都反映到磁盘用户认为是这样，因此数据不会丢失。

在这个分析中，我对 Android/Dalvik 做了一些一般性的假设，我不太了解，所以希望它有点准确:) 请记住 G1 有 192MB 的 RAM。此外，您上面的假设是最多大约 1000 个项目。

```
Object superclass ~ 8 bytes
parent/child pointer ~ 4 bytes
date (long) ~ 8 bytes
name (non interned string avg 32 chars) ~ 64 bytes
x point (int) ~ 4 bytes
y point (int) ~ 4 bytes

Total = 92 bytes + possible memory alignment + fudge factor = 128 bytes
1000 items = 125kB
10000 items = 1.22MB 
```

注意：我意识到虽然孩子只能有一个指针，但父母可以有多个孩子。但是，parent->child 指针的数量是 (elements - 1)，因此 parent->child 指针的平均成本是 (elements - 1)/elements ~ 1 个元素或 4 个字节。这假定一个不分配未使用内存的子结构，例如 LinkedList（与 ArrayList 相对）

**2)**我的书呆子说，这将是一个有趣的地方来分析 B+ 树，但我认为这对于你目前想要的东西来说有点过分了 :) 然而，无论你最终采用什么解决方案，如果你没有把所有东西都放在里面内存，您肯定希望尽可能多地在内存中缓存树的顶层。这可能会大大减少磁盘活动量。

**3）**如果您不想占用所有内存，另一种可能的解决方案可能如下。Bill Karwin 提出了一种相当优雅的[RDBMS 结构，称为闭包表](https://stackoverflow.com/questions/192220/what-is-the-most-efficient-elegant-way-to-parse-a-flat-table-into-a-tree/192462#192462)，用于优化基于树的读取，同时使写入更加复杂。将此与顶级缓存相结合可能会给您带来性能优势，尽管我会在相信之前对此进行测试：

在评估视图时，使用您记忆中的任何内容来评估尽可能多的孩子。对于那些不匹配的子节点，使用适当的 where 子句在闭包表和平面表之间使用 SQL 连接来确定是否有任何匹配的子节点。如果是这样，您将在结果列表中显示该节点。

希望这一切都有意义，并且似乎可以满足您的需求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T10:28:34.160

这可能是题外话，但是..您是否考虑过使用序列化？

Google Protocol Buffers 可用于以非常有效的方式（时间和空间）序列化数据，然后您必须创建合适的树结构（查看任何 CS 书籍）来帮助搜索。

我提到了协议缓冲区，因为作为一个 Google 库，它们可能在 Android 上可用。

只是一个想法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T15:58:17.117

我听了Soonil，试了一下《闭包表》。我添加了下表：

```
################
#   Closure    #
################
# ancestor_id  #
#   item_id    #
################ 
```

如果像我一样，您以前从未使用过该模型，那么它可以这样工作：

您为层次结构中的每个直接或间接关系添加一行。如果 C 是 B 的孩子，而 B 是 A 的孩子，那么您有：

```
ancestor    item
   B         C
   A         B
   A         C      # you add the indirect relationship   
   A         A
   B         B
   C         C      # don't forget any item is in relation with himself 
```

然而，在这个方案中，您错过了一个重要信息：直接关系是什么？如果您只想要一个项目的直接子级怎么办？

为此，您可以`is_direct`在闭包表中添加一个带有 bool 的列，或者您可以只将该列保留`parent_id`在`item`表中。我这样做是因为它阻止了我重写很多以前的代码。

好的部分是我现在可以在一个查询中检查项目是否与日期或地理上下文匹配。

例如，如果我正在浏览项目编号 4 中包含的所有项目，并且只想获取匹配或包含与日期 D 匹配的子项的项目：

```
SELECT ti.parent_id, ti.id, ti.title 
FROM item AS di                                  # item to filter with the date
              JOIN closure AS c                  # closure table
                  ON (di.id = c.item_id) 
              JOIN item AS ti 
                  ON (c.ancestor_id = ti.id)     # top item to display
WHERE di.date = D                                # here you filter by date   
AND ti.parent_id = 4                             # here you ensure you got only the top items 
```

所以我可以扔掉我所有的`*_cache`桌子。我还有很多工作要做**UPDATE / DELETE / CREATE**，但一切都是集中的，而且大部分都是程序性的，而不是递归的。很酷。

唯一的痛苦是我必须递归地将一个项目添加到它的所有祖先。但是得到祖先是一问一答的，所以真的很合理。当然，闭包表占用了很多空间，但就我而言，我不在乎。如果您正在寻找性能，请不要忘记对其进行索引...

喜欢这个 SQL 技巧，非常感谢大家！乍一看有点棘手，但一旦完成就很明显了。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-04T16:35:47.990

AFAICT，您可以在 SQLite 中使用分层查询（google for "CONNECT BY" "START WITH"）...

# c# - 如何更新数据库中的dataGrid

> ID：716860
> 
> 赞同：0
> 
> 时间：2009-04-04T10:22:58.493
> 
> 标签：c#

在我的 C# 项目中，我从 DataTable 填充了 DataGrid 中的值。现在，如果我对 DataGrid 中的值进行更改，我需要在数据库中更新它们。我正在使用 MS 访问。这是我如何在 DataGrid 中填充值的代码片段。

```
 while (myReader.Read())
                {
                    frmBind.dr = frmBind.dtResults.NewRow();
                    frmBind.dr["ClassName"] = myReader.GetString(0);

                    frmBind.dr["MethodSignature"] = myReader.GetString(1);

                    frmBind.dr["ParameterValues"] = myReader.GetString(2);
                    frmBind.dr["ExpectedResults"] = myReader.GetString(3);

                    frmBind.dtResults.Rows.Add(frmBind.dr);

                }

                frmBind.dataGrid2.DataSource = frmBind.dtResults; 
```

其中，dtResults 是 DataTable，frmBind 是 Class Object，dataGrid2 是 DataGrid，myReader.Read() 用于从 DataBase 中获取值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-04T10:33:33.897

我建议你放弃数据阅读器。

将 SQLDataSource 拖到页面上并使用您的查询对其进行配置。它可以让您阅读/更新，而无需编写任何代码。

# c++ - C++ Boost：BOOST_FOREACH 有什么陷阱吗？

> ID：716865
> 
> 赞同：22
> 
> 时间：2009-04-04T10:30:25.793
> 
> 标签：c++, boost, loops

这是为 Boost 专家准备的。程序员在进入并将所有旧的 C/C++ 样式循环替换为简洁明了的循环之前，是否有任何陷阱或细节需要注意`BOOST_FOREACH`？

（这个问题部分来源于[这里](https://stackoverflow.com/questions/716810)。）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-04T10:34:43.163

看一眼：

*   [有条件](http://www.artima.com/cppsource/foreach.html)的爱文章了解基本原理
*   文档的[陷阱](http://www.boost.org/doc/libs/1_35_0/doc/html/foreach/pitfalls.html)部分
*   [可移植性](http://www.boost.org/doc/libs/1_35_0/doc/html/foreach/portability.html)部分，以防您正在开发跨平台产品
*   [BOOST_FOREACH](https://svn.boost.org/trac/boost/search?q=BOOST_FOREACH&noquickjump=1&ticket=on)的错误页面

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-04T10:37:10.490

BOOST_FOREACH - 宏，我不喜欢宏，更喜欢使用 STL 算法 + lambda + 绑定。

[C++0x](http://en.wikipedia.org/wiki/C%2B%2B0x)也将包含类似 BOOST_FOREACH[的 for 循环：](http://en.wikipedia.org/wiki/C%2B%2B0x#Range-based_for-loop)

```
int my_array[5] = {1, 2, 3, 4, 5};
for(int &x : my_array)
{
  x *= 2;
} 
```

这是不使用部分死的 BOOST_FOREACH 的另一个原因。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-04T10:35:31.850

因为它只是一个宏，所以你不能在类型名中使用逗号，所以
`BOOST_FOREACH(pair<int,int> A, mapB){}`
它不起作用。
对于其他缺点，我会参考[BOOST_FOREACH() 文档](http://www.boost.org/doc/libs/1_38_0/doc/html/foreach/pitfalls.html)。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-04-05T06:29:43.757

我`BOOST_FOREACH`对手动编码循环进行了分析。 `BOOST_FOREACH`在一个增加大小为 100,000 的向量的元素的简单循环中，速度降低了大约 30%。所以，如果你正在编写一个小循环，它不会那么快。一旦你的循环进行了主要处理，阿姆达尔定律就会生效，并且由于它的损失`BOOST_FOREACH`可以忽略不计。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-04T10:34:26.440

看看 BOOST_FOREACH 宏的源代码（在 foreach.hpp 中）——这不是我所说的“精益求精”:-)

# asp.net-mvc - 为什么我无法在下拉列表中获取所选值？

> ID：716880
> 
> 赞同：0
> 
> 时间：2009-04-04T10:40:53.397
> 
> 标签：asp.net-mvc

NET MVC 1.0。

我用

```
ViewData["DeptID"] = new SelectList(DeptID, "ID", "Name", course.DeptID); 
```

我将选定的值`DeptID`作为第四个参数传递，但它不起作用。当我调试时，上面的选择列表对于所选值是正确的。

我用

```
<%= Html.DropDownList("DeptID", (SelectList)ViewData["DeptID"]) %> 
```

在视图中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-04T12:20:19.400

尝试使用：

```
<%= Html.DropDownList("DeptID") %> 
```

这是[一篇](http://blog.wekeroad.com/blog/asp-net-mvc-dropdownlist-and-html-attributes/)关于它的文章。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-04T12:44:54.923

当您说“如果我进行调试，那么选择列表上方的选定值也是正确的”，您是说这在调试模式下有效但在发布时无效，还是您说您在第 4 个参数中看到了正确的值但是它似乎仍然没有选择列表中的项目？

要检查的一件事，第一个和第四个参数（`DeptID`和`course.DeptID`）是什么类型？这些将需要兼容 - 例如，如果`DeptID`是字符串集合，则`course.DeptID`需要是字符串。

# active-directory - 为什么公司不使用 LDAP 作为用户以外的中央存储库？

> ID：716898
> 
> 赞同：9
> 
> 时间：2009-04-04T10:58:56.020
> 
> 标签：active-directory, ldap, adam

在我工作过的每一家大公司中，他们都使用 LDAP 作为访问用户信息中央存储库的一种方式，但是很少有人努力扩展模式以包含不是从 inetOrgPerson 派生的 objectClasses。

Microsoft 的 Active Directory 进行了广泛的模式扩展，但很少有商业产品利用 LDAP 的功能。

是因为大多数 LDAP 开发人员不知道如何在用户之外建模吗？在其中找到价值，但还没有深入思考？尝试过并遇到性能问题？别的东西？l

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-04T12:22:54.900

*   我一直认为 LDAP对于网络管理员来说级别太高，而*对于*软件开发人员来说级别*太低。*他们俩似乎都对此感到不自在。
*   有一种看法是，由于几乎每个企业应用程序都将使用关系数据库，因此添加一个数据源会降低应用程序的可用性和可靠性。
*   在 LDAP 中创建自定义模式的障碍仍然很高。在 LDAP 服务器中，您必须将架构文件放在架构目录中，通常使用 root 或管理权限重新启动 LDAP 服务器；而当前的 ORM 可以在应用程序启动时创建、更新或验证关系数据库模式。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-04T12:34:15.903

我个人认为这是因为 LDAP 是一个*目录*，而不是数据库。目录有利于查找人员及其相关数据，但它们对于跟踪高度相关的数据并不是特别好——这就是我们其他大部分数据的样子。事实上，我们对 LDAP 的使用实际上是作为“人”数据的前端，将大量数据流合并到单个目录视图中。我们仍然在后端数据库中拥有“人员”数据以及我们的其他机构数据，并且只选择 LDAP（在我们的例子中为 ADAM）作为前端，以便方便地查找合并的“人员”数据。现在我们正在转向使用 Web 服务作为访问这些数据的一种方式，我不确定继续使用 LDAP 路由是否有意义（除了支持尚未更新的现有服务）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-07T14:10:11.403

我们已经为一些拥有 6500 万条 LDAP 记录的公司完成了工作，但这些记录都不是针对人的。

数据是主要用于设备的各种项目，包括：* DHCP * DNS * Mac 地址 * 位置 * SN * 品牌 * 型号 * 等....

-吉姆

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-04T12:09:22.577

我认为这是由于 A）使用 LDAP 的复杂性（远高于 SQL）和 B）您的产品将完全与之绑定的事实。也就是说，它在运行 LDAP 的大型组织之外没有市场。用更少的钱和精力，我可以构建一个可以在任何地方运行的应用程序。

现在，专门为需要访问其他 LDAP 数据的组织编写的*内部应用程序是另一回事。*但是您显然会很少听到有关它们的信息，因为它们没有进行商业销售。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-04T15:50:03.933

我认为 LDAP 针对快速、频繁的读取进行了高度优化。我认为它们不会扩展到事务系统。

关系模型及其在 SQL 中的表达是一个强大的东西。我认为它不会被 LDAP 或对象数据库轻易取代。

# c++ - 为下一个 C++ 标准做准备

> ID：716904
> 
> 赞同：15
> 
> 时间：2009-04-04T11:03:52.983
> 
> 标签：c++, boost, c++11

一连串的问题`BOOST_FOREACH`促使我询问 Boost 库的用户他们正在做什么（如果有的话）来准备他们的代码以移植到提议的新 C++ 标准（又名 C++0x）。例如，如果您使用以下代码，您是否会编写这样的代码`shared_ptr`：

```
#ifdef CPPOX
#include <memory>
#else
#include "boost/shared_ptr.hpp"
#endif 
```

还有命名空间问题——将来，`shared_ptr`将成为`std`命名空间的一部分——你如何处理这个问题？

我对这些问题很感兴趣，因为我决定硬着头皮开始认真学习 boost，并且我想在我的代码中使用最佳实践。

**不完全是大量的答案——这是否意味着这不是问题？无论如何，感谢那些回答; 我接受 jalfs 的回答，因为我喜欢被建议什么都不做！**

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-04T11:21:17.340

简单的答案是“什么都不做”。Boost 不会删除被 0x 采用的库。所以 boost::shared_ptr 仍然存在。所以你不需要做任何事情来保持可移植性。

当然，一旦 0x 出现了，很多代码都可以被简化、清理和优化，但由于还没有出现，所以这项工作还不能真正开始。你所能做的就是确保你的代码在 0x 命中时仍然可以编译......它应该，就像那样。Boost 不会删除他们一半的库。（我没猜到。他们之前在邮件列表中已经说明了这一点）

（如果你想切换到标准的 shared_ptr，我会说在时机成熟时进行简单的搜索/替换可能更容易。替换`#include <boost/shared_ptr.hpp>`为`#include <memory>`,`boost::shared_ptr`和`std::shared_ptr`）

或者，当然，您可以决定要继续使用 Boost 的项目`shared_ptr`。毕竟，仅仅因为它已被添加到标准库并不意味着您*必须*使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-04T11:36:02.890

由于命名空间，什么都不需要做。如果您想使用 boost 实现，您仍将使用 boost 命名空间。

我认为他们不会冒险以如此大的方式破坏与以前版本的兼容性。

在这里查看我之前的类似问题：[一旦 C++0x 成为主流，boost 的重叠部分会发生什么？](https://stackoverflow.com/questions/405175/what-will-happen-with-the-overlapping-portion-of-boost-once-c0x-becomes-mainstr)

但当然，如果您在代码中大量使用命名空间，您可能会有一些重叠的定义。您必须在每次使用时重新明确指定命名空间。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-05-01T14:09:12.717

在 C++0x 和 Boost 之间使用共享部分的最好方法是使用 Boost.TR1，即；如果技术报告已被接受，则执行。Boost.TR1 将在可用时使用编译器提供的实现，否则将使用 Boost 提供的实现。这是 Boost.TR1 的主要目标

“TR1 库提供了 C++ 标准库扩展技术报告的实现。这个库本身并不实现 TR1 组件，而是一个瘦包装器，将包含您的标准库的 TR1 实现（如果有的话），否则它将包括 Boost 库等价物，并将它们导入命名空间 std::tr1。"

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-04T11:10:15.900

不，到目前为止，鉴于以下事实，我们还没有：

*   对 C++0x 的支持尚未在各种平台上达到标准（我们需要）和
*   *尚未*正式宣布为标准

但是，是的，我们确实在需要时使用 Boost（当然，只有在发布经过清理阶段后我们才会使用它），就像我们使用的任何其他第三方库一样。此外，我们根据需要使用源表单。

然而，在产品设计阶段（例如 move-ctor 等）正在努力更严格地采用驱动原则。

当 C++0x 标准化时肯定会有一些工作；但这也将要求我们继续使用一些较新的编译器（vc10？），并且继续使用新的编译器始终是它自己*的任务*。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-07T15:26:38.567

您实际上可能很长时间都喜欢使用 Boost 版本。特别是如果您需要在多个平台上编译。

Boost 库在多个平台上进行了移植和测试，并且在那里（大多数时候）表现相同。

新 C++ 库的第一个供应商实现可能仍然包含小错误和性能差异，就像添加 STL 和 std 命名空间时那样一团糟。

# c# - 在 C# winform 中，如何确定应用程序显示在哪个监视器上

> ID：716907
> 
> 赞同：4
> 
> 时间：2009-04-04T11:05:50.483
> 
> 标签：c#

[如何在 C# 中找到应用程序在哪个屏幕上运行的](https://stackoverflow.com/questions/549751/how-do-i-find-what-screen-the-application-is-running-on-in-c/549789#549789)副本

在 C# winform 中，如何确定应用程序在三监视器设置中显示在哪个监视器上。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-04T11:13:28.030

```
System.Windows.Forms.Screen.FromControl() 
```

检索包含指定控件最大部分的显示器的屏幕。

而且这个属性可能会有所帮助：

```
System.Windows.Forms.Screen.AllScreens 
```

获取系统上所有显示器的数组。

# php - 打印 Smarty 模板中可用的所有变量

> ID：716916
> 
> 赞同：35
> 
> 时间：2009-04-04T11:13:32.680
> 
> 标签：php, smarty

如何打印 Smarty 模板上下文中可用的所有变量？类似于 Django 调试跟踪，它列出了所有正在传递的内容。

谢谢

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2009-04-04T11:57:30.687

使用`{debug}` [手册](http://www.smarty.net/docs/en/language.function.debug.tpl)：

> `{debug}`将调试控制台转储到页面。无论 php 脚本中的调试设置如何，这都有效。由于这是在运行时执行的，因此只能显示分配的变量；不是正在使用的模板。但是，您可以在模板范围内查看所有当前可用的变量。

`$debugging = true`必须在您的设置或课程中启用，并且必须取消阻止站点弹出窗口才能看到窗口

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-04T11:23:00.190

```
var_dump($Smarty->_tpl_vars); 
```

来自 Smarty 代码 :)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-04-24T15:38:27.580

Smarty 3 的更新答案：[getTemplateVars](http://www.smarty.net/docs/en/api.get.template.vars.tpl)

```
// If no parameter is given, an array of all assigned variables are returned. 
$all_tpl_vars = $smarty->getTemplateVars(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-09-18T12:15:14.517

$all_tpl_vars = $smarty->getTemplateVars(); var_dump($all_tpl_vars);

//在推送到模板之前

出口;

# java - 禁用 Struts 将 HTML 标记转换为实体

> ID：716922
> 
> 赞同：3
> 
> 时间：2009-04-04T11:20:29.340
> 
> 标签：java, jakarta-ee, struts

嗨，我正在使用 Struts 1.2 并安装了 TinyMCE。问题是struts 将所有HTML 标记转换为实体。如何禁用或配置它以仅允许选定的标签？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-04T12:04:52.883

使用过滤器参数 ( [taglib](http://struts.apache.org/1.x/struts-taglib/tagreference.html#bean:write) )。

```
<bean:write name="someField" filter="false"/> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-08-07T20:03:04.733

谢谢，我一直在寻找这个，但在 Struts 2 中，这有帮助，它是相似的：

```
<s:property value="variable" escape="false" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-01-24T15:45:14.517

我不认为这是对 struts 2 的正确响应。至少在以后的版本中

逃逸属性不存在。

需要明确提及 html、csv、javascript 和 xml 的转义。例如 html，它必须是 escapeHtml

```
<s:property value="%{somefield}" escapeHtml="false"/> 
```

# iphone - 锚定一个 UIView

> ID：716923
> 
> 赞同：1
> 
> 时间：2009-04-04T11:20:48.387
> 
> 标签：iphone, cocoa-touch

我在 UINavigationController 中有一个 UITableViewController。

我想让 UIView 出现在表格视图的顶部，但不受表格视图滚动的影响。

即如果表格视图被滚动，UIView 应该保持在相对于屏幕的相同位置，而不是相对于表格视图。它应该看起来锚定在某个位置。

实现这一目标的最佳方法是什么？

编辑：为了澄清，视图应该透明地漂浮在表格视图的顶部。

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T03:39:18.593

我还想在我的 tableView 上有一个浮动 UIView。
所以，在我的 RootViewController（这是一个 UITableViewController）中，这对我有用

```
- (void)viewDidLoad {
    /* mylabel is a UILabel set in this class */
    [self.mylabel setUserInteractionEnabled:NO];

    /* navigationController comes from higher up in the navigation chain */
    [self.navigationController.view addSubview:self.mylabel]; 
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T17:04:26.243

与 Peter 所说的类似，创建一个包含 TableView 和子类 UIView 的 UIView。如：

```
UIView *view = [[UIView alloc] initWithFrame:frame]; // Define frame as you like

[view addSubview:myTableView]; // This is the reference to your tableView
[view addSubview:myAnchoredView]; // This is the reference to your UIView "floating" subclass 
```

您还需要关闭浮动视图的用户交互。我不知道这是否会专门将触摸传递给底层的 UIView：

```
[myAnchoredView setUserInteractionEnabled:NO]; 
```

如果这阻止了对 tableView 的触摸，则可能需要在初始化时将对 tableView 的引用传递给锚定视图，然后传递触摸事件。您可以通过覆盖 UIResponder 中的触摸响应方法来做到这一点。（如果有更好的方法，请有人说出来。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-11T17:00:39.777

I investigated how UIScrollView keeps its scrollIndicator above the UIScrollView's content and yet unmoving by examining a UIScrollView in the debugger.

The scrollIndicators are UIImageViews. And you can see they are direct descendants of the UIScrollView itself. You can also see that any scrolled content is also a direct descendent. So how is it that the scroll indicators don't move?

I tried updating the position of my static content constantly in `- (void)scrollViewDidScroll:(UIScrollView *)scrollView` this, surprisingly, works. I'm not sure if it is how UIScrollView itself does it, but without some private magic, it must be something like this.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-04T11:34:22.770

你的意思是锚定视图应该在 UITableView 上显示为透明，或者就在上面，即锚定视图使用前 20% 的可用空间，表格视图使用其余空间？

在任何情况下，创建一个包含锚定视图和表格视图的 UIView。如果您希望锚定视图在表格视图上透明，这有点棘手，因为要滚动表格视图，触摸必须通过锚定视图。

将周围视图的视图控制器添加到导航控制器，而不仅仅是 tableview。

# java - 将正则表达式应用于 Java I/O 流

> ID：716927
> 
> 赞同：8
> 
> 时间：2009-04-04T11:24:01.390
> 
> 标签：java, regex, sockets, network-programming, stream

我寻求一个将正则表达式应用于 Java I/O 流的示例，该示例不会简单地将流转换为字符串，因为我想保留二进制数据。互联网上的大多数例子都集中在文本数据上......

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-04T11:43:58.660

Java 标准中不存在所需的功能。您将不得不使用[jakarta regexp](http://jakarta.apache.org/regexp/index.html)，特别是[StreamCharacterIterator](http://jakarta.apache.org/regexp/apidocs/org/apache/regexp/StreamCharacterIterator.html)类。此类封装了一个 InputStream 以用于正则表达式操作。

如果你想使用标准的正则表达式包，我建议在[这里获取上一个类的源代码，并通过实现](http://svn.apache.org/repos/asf/jakarta/regexp/tags/RELEASE_1_5/src/java/org/apache/regexp/StreamCharacterIterator.java)[CharSequence](http://java.sun.com/javase/6/docs/api/java/lang/CharSequence.html)而不是[CharacterIterator](http://jakarta.apache.org/regexp/apidocs/org/apache/regexp/CharacterIterator.html)来更改合同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-04T11:30:42.483

将流转换为字节数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-17T07:01:42.233

尝试使用[Ragel](http://www.complang.org/ragel/) - 带有转换回调的正则表达式工具。

可以应用于流和块。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-04-04T11:32:56.237

必须对字符串执行正则表达式操作，字符串是二进制数据的编码字节。您无法对不知道它们代表什么的数据字节执行正则表达式操作。

# python - 如何在我的网络应用程序中启用短信通知？

> ID：716946
> 
> 赞同：1
> 
> 时间：2009-04-04T11:47:00.743
> 
> 标签：python, sms, notifications

我有一个 Web 应用程序，我想向应用程序的用户启用实时 SMS 通知。

注意：我目前无法使用 Twitter API，因为我住在西非，而且 Twitter 不向我的国家发送 SMS。

email2sms 也不是一个选项，因为移动运营商在我的国家不允许这样做。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-04T12:05:42.383

有几个选项。

*   获取某种 SMS 调制解调器或连接，并通过[smslib](http://smslib.org/)使用您自己的手机。很抱歉我不提供 python 接口，但我的经验是 Java。不利的一面是您将支付全额消费费。你必须在你的数据中心安装一部手机。
*   连接到[SMPP](http://en.wikipedia.org/wiki/Short_message_peer-to-peer_protocol)网关。您必须与移动运营商交谈才能完成这项工作。这里有一个名为[jsmpp](http://code.google.com/p/jsmpp/)的库。再次，我很抱歉它不是 python。
*   如果太麻烦，您可以使用提供 HTTP-SMS 网关的中介，例如[这个](http://www.ericsson.com/solutions/ipx/)。这很容易，因为您不需要使用 SMPP，而且您的系统管理员不会因为将手机放入数据中心而对您大吼大叫。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-07-01T21:30:54.813

另一个带有 Python 接口的 SMS 网关是 TextMagic。他们的 Python API 可从 Google 代码项目[textmagic-sms-api-python 获得](https://github.com/dfstrauss/textmagic-sms-api-python)。他们也有可用于其他语言的库；都包装了一个简单的 HTTPS API。

来自项目网站的代码示例：

如何发送短信：

```
import textmagic.client
client = textmagic.client.TextMagicClient('your_username', 'your_api_password')
result = client.send("Hello, World!", "1234567890")
message_id = result['message_id'].keys()[0] 
```

并检索其交付状态：

```
response = client.message_status(message_id)
status = response[message_id]['status'] 
```

（完全披露：我是 Python 包装库的作者）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-04T12:01:38.680

使用适当的短信网关怎么样。这些人获得了多种语言的 API：

[http://www.clickatell.com/developers/php.php](http://www.clickatell.com/developers/php.php)

还有一个非官方的 Python API

[http://www.arnebrodowski.de/projects/clickatell/](http://www.arnebrodowski.de/projects/clickatell/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-03-24T03:38:58.757

最简单的方法是使用第三方 API。我知道一些效果很好的是：

*   休息短信
*   Twilio.com
*   Clicatell.com

我已经使用了所有这些，它们最容易/最便宜的实现是restSms.me

希望有帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-04T11:58:09.653

我没有这方面的任何知识。但我认为您必须与移动运营商交谈，看看他们是否有任何用于发送 SMS 消息的 API。您可能必须向他们付款，或者有一些计划让客户付款。或者，可能有一些第 3 方实现了此功能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-03-09T22:27:46.177

警告：非常优雅的解决方案！（安卓应用）

如果您想以发送电子邮件一样简单的方式向任何号码发送短信：

```
mail('configuredEMail@configuredDomain', '0981122334', 'SMS message'); // PHP 
```

甚至：

```
echo 'SMS message' | mail -s '0981234567' configuredEMail@configuredDomain.com 
```

甚至来自 GUI 邮件客户端，然后继续阅读。

跳过解释谷歌 Evorion SMS 网关。

它有什么作用？它将电子邮件转发到带有内置电池保护程序的 SMS。要发送 SMS，您只需发送电子邮件至“configuredEMail@configuredDomain.com”，主题为“phoneNumberToForwardTo”。

欢迎代码贡献。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-03-16T10:28:38.877

如果您所在的国家/地区在[此列表中](https://www.twilio.com/international)，则 Twilio 是一个非常易于使用的 API :)

# iphone - 如何在大小检查器中设置文本字段的高度

> ID：716950
> 
> 赞同：6
> 
> 时间：2009-04-04T11:50:23.480
> 
> 标签：iphone, objective-c

我使用Interface Builder创建了一个圆形文本字段类型的UITextField，因此为了设置文本字段的高度，它的窗口在SizeInspector中被禁用（不手动设置任何高度）。所以如果我们想手动设置高度，应该执行什么程序我们跟随。

我想提一提的是，我们可以在编码部分做到这一点，但我想知道的是，我们如何在 interfacebuilder 中实现这一点。

您的回答总是受到赞赏。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2014-03-06T10:23:59.457

更改边框样式，如下所示：

![截屏](https://i.stack.imgur.com/cMrc8.png)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-04T16:24:26.380

不幸的是，您不能使用 Interface Builder 设置 UITextField 的高度。您必须以编程方式设置它，并确保它不会违反[iPhone 人机界面指南中的任何规则](http://developer.apple.com/iphone/library/documentation/UserExperience/Conceptual/MobileHIG/Introduction/Introduction.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-12-10T09:39:59.533

`UITextField`您可以通过编辑 .xib 文件来更改高度。只需使用 Textedit 或 Dashcode 打开它并搜索`IBUITextField`. 编辑`NSFrame`参数到你想要的任何大小。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-05-26T00:17:00.673

增加字体的大小，盒子的高度会增加

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-08-04T11:09:58.603

将文本字段的边框样式属性更改为圆角矩形以外的其他内容。之后，您可以自由设置盒子的高度。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-05-23T08:42:44.090

右键单击 .xib 文件，然后单击“打开方式”->“源代码”。然后搜索 UITextField 的 NSFrame。根据需要更改高度。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-10-28T18:37:19.697

以我的情况成功解决：在尝试了以上所有方法后，我无法改变`UITextField`. 最后，我发现我放入`UITextField`了堆栈视图（或者它受到了一些约束）。

因此，我添加`Height Constraint`了 for`UITextField`然后将我的预期高度放入`Constant`Constraint。它有效。特别是，它适用于所有边框样式（None、Line、Bezel、RoundedRect）。不需要代码。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-03-28T21:06:35.410

玩了一会儿之后，我意识到 UITextField 可以被认为是一个 UIButton（圆角矩形样式），上面有一个 UILabel。或者，它是 UIButton Rounded rect 样式之上的 UITextView。按钮内标签的行数、尺寸和位置可以在 IB 中轻松调整。

就我而言，我想要一个只读文本字段，所以我在 UIButton 之上使用了 UILabel。我根据要求调整了按钮的大小以及标签大小。我还必须取消选中 IB 中按钮的“启用”框，以便在触摸时不会突出显示。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-06-30T21:07:18.450

您可以使用源代码轻松更改它。只需右键单击您的故事板，将其作为源代码打开，然后搜索您的文本字段并更改高度。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-07-03T19:51:38.227

我发现完成此操作的最简单方法是更改​​边框样式，然后根据自己的喜好编辑其他属性。这是一个例子。

```
emailField.layer.borderColor = [[UIColor blackColor] CGColor];
emailField.layer.borderWidth = 2.0f;
emailField.layer.cornerRadius = 8.0f;
emailField.alpha = .75f;
emailField.layer.backgroundColor = [[UIColor whiteColor] CGColor]; 
```

！![在此处输入图像描述](https://i.stack.imgur.com/EP1Hp.png)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-05-31T14:03:09.913

我解决了文本字段（圆角矩形）高度问题。您必须为您的文本字段对象定义高度约束。

定义文本字段的高度约束。

![](https://i.stack.imgur.com/NXpEl.png)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-07-18T08:36:44.910

我们可以通过简单的拖动来更改具有圆角矩形以外的任何类型边框样式的文本字段的高度。但是对于圆角矩形文本字段，这是不可能的......当然我们可以使用一些代码来改变高度。

在这里我找到了一个简单的方法。它对我有用

1.  选择文本字段，在右下角我们可以看到引脚选项..

2.  在那里选择高度约束它是30个预定义的......

3.  选择该高度，您可以看到“添加 1 个约束”已启用。
4.  单击那个..因此我们为该文本字段添加了高度约束。
5.  现在去找尺寸检查员。在“约束”中找到高度约束...高于“内容拥抱优先级”
6.  您可以在那里编辑高度...给出您想要给出的任何值。现在看到它更改为您给定的高度的文本字段。

它对我有用:) 可以将此场景用于 UISwitch、Segment 等。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-05-18T11:52:52.850

正如@peterdoesco.de 所说，只需添加一个高度约束并更改它的值，这可以正常工作。

# .net - 快速获得群组成员资格

> ID：716951
> 
> 赞同：4
> 
> 时间：2009-04-04T11:57:26.507
> 
> 标签：.net, windows, membership, active-directory-group

我试图弄清楚当前的 Windows 用户是本地管理员还是可以使用 UAC 来“获得”该组成员身份。

到目前为止，我想出的是这样的：

```
var adminIdentifier = new SecurityIdentifier("S-1-5-32-544");
var current = WindowsIdentity.GetCurrent();
bool isAdmin = current.Groups.Contains(adminIdentifier);
bool canBeAdmin = isAdmin;

if (!isAdmin)
{
    var adminGroupName = adminIdentifier.Translate(typeof(NTAccount)).Value;
    adminGroupName = adminGroupName.Substring(adminGroupName.LastIndexOf('\\'));
    string path = "WinNT://./" + adminGroupName + ",group";

    using (DirectoryEntry groupEntry = new DirectoryEntry(path))
    {
      foreach (object member in (IEnumerable)groupEntry.Invoke("Members"))
      {
        using (DirectoryEntry memberEntry = new DirectoryEntry(member))
        {
              object obVal = memberEntry.Properties["objectSid"].Value;
              SecurityIdentifier sid = null;
              if (null != obVal)
              {
                 sid = new SecurityIdentifier((Byte[])obVal,0);
              }

              canBeAdmin = Equals(current.User, sid);
              if (canBeAdmin)
                break;
        }
     }
   }
 }
 Console.WriteLine(canBeAdmin +" "+isAdmin); 
```

此解决方案需要几毫秒的时间来计算。比我之前尝试过的基于 System.DirectoryServices.AccountManagement 的方法快得多。

不过，还有最后一件事困扰着我。我必须将管理组的 SecurityIdentifier 转换为名称。应该有一种方法可以通过使用 SID 直接获取 DirectoryEntry。根据谷歌的说法，这应该有效：

```
string path = "LDAP://<SID=" + adminIdentifier.ToString() + ">"; 
```

但是，这似乎不起作用。知道语法应该是什么样子吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-05T12:41:16.407

您是否尝试过[WindowsPrincipal.IsInRole](http://msdn.microsoft.com/en-us/library/system.security.principal.windowsprincipal.isinrole.aspx)？

```
WindowsPrincipal wp = new WindowsPrincipal(WindowsIdentity.GetCurrent());
wp.IsInRole(new SecurityIdentifier("S-1-5-32-544"));
wp.IsInRole(WindowsBuiltInRole.Administrator); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T12:14:37.790

您是否尝试过在与当前用户对应的 UserPrincipal 对象上使用[GetAuthorizationGroups ？](http://msdn.microsoft.com/en-us/library/system.directoryservices.accountmanagement.userprincipal.getauthorizationgroups.aspx)如果 GetAuthorizationGroups 不包含机器本地组，您可能必须检查用户是否直接在本地管理员组中，或者本地管理员组是否包含用户所在的任何授权组。我没有在机器上下文中尝试过这个，所以我不确定如果它在使用时不使用域/全局/通用组计算本地组成员身份，是否还需要搜索域上下文以查找后一个匹配项机器上下文。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-05T12:19:29.657

这应该是你想要的，除非我误解：

```
var groupName = adminIdentifier.Translate(typeof(NTAccount)).Value; 
```

# struts2 - Struts2 示例，未在 mysql 数据库中插入记录，因为连接对象为空

> ID：716955
> 
> 赞同：0
> 
> 时间：2009-04-04T11:59:50.103
> 
> 标签：struts2

此代码适用于简单的应用程序，因此驱动程序很好。那么为什么连接对象无法使用驱动程序进行初始化。

导入java.sql.Connection；

导入 java.sql.DriverManager；

导入java.sql.SQLException；

导入 java.sql.Statement；

导入 com.opensymphony.xwork2.ActionSupport；

公共类插入扩展 ActionSupport {

```
public String execute() throws Exception, SQLException {

    String sql = "";

    String url = "jdbc:mysql://localhost:3306/test";

    //String dbName = "test";

    String driverName = "org.gjt.mm.mysql.Driver";

    String userName = "root";

    String password = "root";

    Connection con=null;

    Statement stmt=null;

    try {

        Class.forName(driverName).newInstance();

        con = DriverManager.getConnection(url, userName, password);

        stmt = con.createStatement();

    } catch (Exception e) {

        System.out.println(e.getMessage());

    } 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-04T12:11:17.407

异常说明了什么？createStatement 上的 NullPointerException？

无论如何，该类是否已加载；是类路径上的类（即类路径上的 MySQL jar？）

检查从 Class.forName() 返回的对象以检查是否已找到该类。

在您发表评论后，很明显您遇到了类路径问题。mysql jar 不在类路径中。我假设您正在谈论 Web 应用程序可交付成果（war 文件），因为在 eclipse 中更改构建路径是微不足道的。

在部署在例如 tomcat 中的 Web 应用程序中，您可以查看 <webapp-name>/WEB-INF/lib。文件 WEB-INF/lib/mysql-connector-java-5.0.5.jar 或类似的文件应该在那里。

如果你有一个war文件（尚未部署），你可以使用命令行工具“jar”解压它，或者从中获取文件列表。如果你这样做（在命令行上）jar tf | grep mysql jarfile 应该是可见的。如果您使用窗户；WinRAR（可能还有 WinZip）也可以打开战争文件。在 WEB-INF/lib 中，一个 MySQL jar 应该是可见的。

如果您使用 maven 构建您的网络应用程序；不要忘记向 mysql jar 添加依赖项。如果你使用ant来构建；在创建 war 文件之前不要忘记将 mysql jar 文件复制到 WEB-INF/lib 中。

请注意，目前推荐的驱动程序是“com.mysql.driver.Driver”，而不是“org.gjt.mm.mysql.Driver”。您可以尝试加载该驱动程序类而不是旧驱动程序；更远; 检查这个驱动程序是否真的在mysql jar中（jar tf mysq.jar | grep Driver 左右）。如果 Driver 在 mysql jar 中**并且**mysql jar 在 webapp 的类路径中（在 WEB-INF/lib 中）**并且**那里只有一个 mysql jar（版本冲突不好玩），它仍然不起作用我真的不知道有什么问题。我想我会再次从 MySQL 下载驱动程序 jar 并再试一次。

# java - Java 网络服务

> ID：716957
> 
> 赞同：1
> 
> 时间：2009-04-04T12:01:53.373
> 
> 标签：java, web-services

我在哪里可以找到好的 Java Web 服务实践和教程（我是 JWS 的新手，所以我更喜欢从头开始）。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-04T12:10:45.117

我一直在阅读（尽管我从未遵循过）[Sun 教程](http://java.sun.com/javaee/5/docs/tutorial/doc/bnayl.html)。写得对我来说足够好了。

不过，我建议使用像[CXF](http://cxf.apache.org/)或[Spring Web 服务](http://static.springsource.org/spring-ws/sites/1.5/)这样的框架来避免样板文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-04T12:10:54.320

试试[Sun 教程](http://java.sun.com/webservices/docs/1.6/tutorial/doc/)。这些通常非常好

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T12:31:35.347

我在学习某事时使用[了这个。](http://www.developer.com/services/article.php/3613896)关于网络服务。

但我确信现在有更新的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-04T14:27:35.177

我支持 Spring Web 服务的投票。一个优点是您的服务可以在不修改的情况下从一个堆栈迁移到另一个堆栈。如果您已经在使用 Spring，那么这是一个不错的选择。

# django - 删除某些元素时模型继承的问题

> ID：716963
> 
> 赞同：0
> 
> 时间：2009-04-04T12:06:37.967
> 
> 标签：django, inheritance, model

我使用[http://www.djangosnippets.org/snippets/1034/](http://www.djangosnippets.org/snippets/1034/)中的一个片段来继承我的模型。一开始它工作得很好。但是，在我删除数据库中的一些元素后，代码会出错。在调试时，我发现问题出在方法中：as_leaf_class。在以下代码中：

```
if (model == Meal):
    return self
return model.objects.get(id=self.id) 
```

删除元素时，最后一行将引发异常。任何人都可以为此提供解决方案吗？

具有内容类型和继承感知管理器的模型继承

```
from django.db import models
from django.contrib.contenttypes.models import ContentType
from django.db.models.query import QuerySet

class SubclassingQuerySet(QuerySet):
    def __getitem__(self, k):
        result = super(SubclassingQuerySet, self).__getitem__(k)
        if isinstance(result, models.Model) :
            return result.as_leaf_class()
        else :
            return result
    def __iter__(self):
        for item in super(SubclassingQuerySet, self).__iter__():
            yield item.as_leaf_class()

class MealManager(models.Manager):
    def get_query_set(self):
        return SubclassingQuerySet(self.model)

class Meal (models.Model) :
    name = models.TextField(max_length=100)
    content_type = models.ForeignKey(ContentType,editable=False,null=True)
    objects = MealManager()

    def save(self, *args, **kwargs):
        if(not self.content_type):
            self.content_type = ContentType.objects.get_for_model(self.__class__)
            super(Meal, self).save(*args, **kwargs)

    def as_leaf_class(self):
        content_type = self.content_type
        model = content_type.model_class()
        if (model == Meal):
            return self
        return model.objects.get(id=self.id)

class Salad (Meal) :
    too_leafy = models.BooleanField(default=False)
    objects = MealManager() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-06T15:16:30.223

第一个答案：您为什么要在已删除的对象上调用 as_leaf_class ？如果这样做时会感到疼痛，请不要这样做。

第二个答案是你可以用 try...except Meal.DoesNotExist 包裹失败的行，并返回 None 或 self 或其他东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-04T22:47:44.803

我不知道现在您可以使用[抽象基类，该片段是否仍然相关。](http://docs.djangoproject.com/en/dev/topics/db/models/#abstract-base-classes)

这使您可以声明一个不是 db 表但其他模型可以继承的模型。

# jquery - 如何在 jQuery 中有条件地设置 div 的类？

> ID：716967
> 
> 赞同：0
> 
> 时间：2009-04-04T12:11:00.200
> 
> 标签：jquery

### CSS：

```
 #outer{
    background-color:#FFFF99;            
   }

   #inner1{
      float : left;
   }

    .New1{
      width: 62%; 
    }

   .New2{
     width: 72% 
   } 
```

* * *

我需要能够`div`在事件处理程序中的条件之后更改 a 的类。

### 逻辑：

```
 case '1': <div id="outer" class="New1"> 
                   </div>
         case '2': <div id="outer" class="New2">
                    </div> 
```

* * *

为此，我编写了以下 jQuery：

```
$("#generate").click(function(){
     // here I wrote code for case '1'
     $("#outer").addClass("New1");
});
$("#choice").click(function(){
     // here I wrote code for case '2'
     $("#outer").addClass("New2");
}); 
```

*   我需要删除我之前添加到其中的类吗？

*   我需要在两种状态之间切换。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-04T12:15:33.310

```
$("#generate").toggle(function() {
    $("#outer").removeClass("New2").addClass("New1");
}, function() {
    $("#outer").removeClass("New1").addClass("New2");
}); 
```

或者

```
$("#generate").click(function() {
    $("#outer").removeClass("New2").addClass("New1");
});
$("#choice").click(function() {
    $("#outer").removeClass("New1").addClass("New2");
}); 
```

# css - 使用 CSS 转换旋转表格标题文本

> ID：716970
> 
> 赞同：35
> 
> 时间：2009-04-04T12:11:34.333
> 
> 标签：css, cross-browser

这看起来应该可以通过以下方式实现：

```
.verticalText 
{           
    /* IE-only DX filter */
    writing-mode: tb-rl;
    filter: flipv fliph;

    /* Safari/Chrome function */
    -webkit-transform: rotate(270deg);

    /* works in latest FX builds */
    -moz-transform: rotate(270deg);
} 
```

这适用于 IE。

它在 Safari、Chrome 和 FX 中以一种奇怪的方式出错 - 单元格的大小是在文本旋转*之前计算的！*

![错误截图](https://i.stack.imgur.com/QT50z.png)

这是一个演示：http: [//jsfiddle.net/HSKws/](http://jsfiddle.net/HSKws/)

我使用动态图像作为一种解决方法，尽管这[也有它的问题](https://stackoverflow.com/questions/388677)。我很高兴将其作为后备，但似乎应该有一种方法可以使这个 CSS 工作 - 它几乎就在那里。

任何人都知道在应用转换后使单元格适合内容的方法吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-04T13:40:09.940

'transform' 改变你声明它的整个元素的方向，而不是它里面的文本内容。它更像是 IE 的“矩阵”属性，而不是“写作模式”。

至关重要的是，转换元素不会改变其内容大小的计算方式（或者其父级布局如何受该大小影响）。CSS 的垂直和水平尺寸算法是不同的，而且很难适应；没有真正一致的方式可以容纳任意旋转的内容。所以'变换'就像使用'位置：相对'：它改变了内容的呈现位置，但与布局大小无关。

因此，如果您想在表格中包含一个，您需要明确设置单元格的“高度”以适应预期的旋转“宽度”。如果你事先不知道这一点，你可能会用 JavaScript 破解它，也许。

FWIW：对我来说，在 Fx3.1b3 上，跨度也像其他人一样旋转。然而，在具有仅水平抗锯齿 (ClearType) 的 Windows 上，渲染看起来并不好……渲染良好的图像可能会好得多。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2010-08-18T18:57:46.083

可以在 XHTML 文档中使用内联 SVG（我只测试了 Safari 和 Firefox）：

```
<html xmlns="http://www.w3.org/1999/xhtml">
  <body>
    <table border="1">
        <tr>
            <td>&#160;</td>
            <td>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="150">
                  <text id="thetext" transform="rotate(270, 12, 0) translate(-140,0)">Example column header</text>
                </svg>
            </td>
            <td>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="150">
                  <text id="thetext" transform="rotate(270, 12, 0) translate(-140,0)">Example column header</text>
                </svg>
            </td>
            <td>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="150">
                  <text id="thetext" transform="rotate(270, 12, 0) translate(-140,0)">Example column header</text>
                </svg>
            </td>
        </tr>
        <tr>
            <td>Example row header</td>
            <td>1</td>
            <td>2</td>
            <td>3</td>
        </tr>
    </table>
  </body>
</html> 
```

不幸的是，您必须明确设置表格单元格的宽度和高度以及使用 SVG 呈现的文本的翻译。此外，文件扩展名必须是`xhtml`.

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2011-12-07T00:37:46.877

Webkit 增加了：

```
-webkit-writing-mode:vertical-rl; 
```

您可以将其应用于`div`.

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-08-25T20:57:19.753

正如我对[类似问题的回答](https://stackoverflow.com/questions/7076052/vertically-rotate-text-inside-an-html-table-header-cell/12125570)，我使用[David Votrubec 的 jQuery 插件](http://davidjs.com/2011/07/rotate-table-cell-content-jquery/)和 Mike 在博客文章下方的评论解决了这个问题。

把它放在一个 .js 文件中：

```
(function ($) {
  $.fn.rotateTableCellContent = function (options) {
  /*
Version 1.0
7/2011
Written by David Votrubec (davidjs.com) and
Michal Tehnik (@Mictech) for ST-Software.com
*/

var cssClass = ((options) ? options.className : false) || "vertical";

var cellsToRotate = $('.' + cssClass, this);

var betterCells = [];
cellsToRotate.each(function () {
var cell = $(this)
, newText = cell.text()
, height = cell.height()
, width = cell.width()
, newDiv = $('<div>', { height: width, width: height })
, newInnerDiv = $('<div>', { text: newText, 'class': 'rotated' });

newInnerDiv.css('-webkit-transform-origin', (width / 2) + 'px ' + (width / 2) + 'px');
newInnerDiv.css('-moz-transform-origin', (width / 2) + 'px ' + (width / 2) + 'px');
newDiv.append(newInnerDiv);

betterCells.push(newDiv);
});

cellsToRotate.each(function (i) {
$(this).html(betterCells[i]);
});
};
})(jQuery); 
```

这在您的页面顶部：

```
<script src="rotatetablecellcontent.js" type="text/javascript"></script>
<script type="text/javascript">
    $(document).ready(function(){
        $('.yourtableclass').rotateTableCellContent();
    });
</script> 
```

这在你的 CSS 中：

```
/* Styles for rotateTableCellContent plugin*/
table div.rotated {
    -webkit-transform: rotate(270deg);
    -moz-transform: rotate(270deg);
    writing-mode:tb-rl;
    white-space: nowrap;
}

thead th {
    vertical-align: top;
}

table .vertical {
    white-space: nowrap;
} 
```

然后确保您的表具有“yourtableclass”类，并且您要旋转的所有 TD 都具有“vertical”类。

这是[在 jsFiddle 中运行的演示](http://jsfiddle.net/9pUu4/)。

希望它对某人有所帮助，即使我迟到了两年！

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-01-29T20:32:58.577

为了在表格标题中旋转文本：

1.  将标题内容放在 div 中 - 旋转这些 div 而不是标题本身
2.  在表头上设置 position:relative ，`th`在旋转的 div 上设置 position:absolute 。
3.  `th`也设置标题的高度

完毕。

你可以在这里看到它：

![在此处输入图像描述](https://i.stack.imgur.com/NOo3E.png)

如果您使窗口变窄（小于 1000 像素并旋转表格标题），您可以在此页面上看到它 - [http://www.rugbydata.com/](http://www.rugbydata.com/)

这是我使用的代码：

```
div.rotatabletext {
-webkit-transform: rotate(-90deg);
/* Firefox */
-moz-transform: rotate(-90deg);
/* IE */
-ms-transform: rotate(-90deg);
/* Opera */
-o-transform: rotate(-90deg);
/* Internet Explorer */
filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=3);
width:0px;
text-align:left;
height:0px;
margin-left:0px;
margin-top:0px;
bottom:2px;
position:absolute;
}
table.tournamentresults > * > tr > td {
padding:1px;
}
table.tournamentresults > thead > tr:nth-child(1) > th:nth-child(1) {
height:70px;
position:relative;
}
table.tournamentresults > thead > tr:nth-child(2) th {
height:70px;
position:relative;
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-02-14T06:57:13.393

这个工具为我做了所有的思考......

[http://www.boogdesign.com/examples/transforms/matrix-calculator.html](http://www.boogdesign.com/examples/transforms/matrix-calculator.html)

# iphone - 发布 NSMutableDictionary 的问题

> ID：716972
> 
> 赞同：0
> 
> 时间：2009-04-04T12:13:27.513
> 
> 标签：iphone, objective-c, cocoa-touch

当我尝试发布字典时，我得到了一个例外。

这是我的代码：

```
- (void)viewWillAppear:(BOOL)animated {
    [super viewWillAppear:animated];
    if (!tableDataDictionary)
{
    DebugLog(@"initializing tableDataDictionary");
    tableDataDictionary = [ [NSMutableDictionary alloc] init];
}
}

-(void)viewWillDisappear:(BOOL)animated {
    [super viewWillDisappear:animated];
    [mainTableView deselectRowAtIndexPath: [mainTableView indexPathForSelectedRow] animated:NO];

    [tableDataDictionary release];
} 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-04T13:26:15.417

您很可能需要清除 tableDataDictionary 实例变量。否则，这些方法中的每一个第一次运行时都可以正常工作，但第二次，tableDataDictionary 将不会为 nil，并且将指向一个 dealloc'd 指针；因此不会进行 alloc 调用，并且当 viewWillDisappear: 被调用时，它将尝试再次释放该指针。所以，要修复它：

```
`-(void)viewWillDisappear:(BOOL)animated {
    [super viewWillDisappear:animated];
    [mainTableView deselectRowAtIndexPath: [mainTableView indexPathForSelectedRow] animated:NO];

```
[tableDataDictionary release];
tableDataDictionary = nil; 
```

}` 
```

# `domain-driven-design - 这个功能在哪里？`

 `> ID：716977
> 
> 赞同：0
> 
> 时间：2009-04-04T12:16:28.580
> 
> 标签：domain-driven-design, repository

上下文：代码的结构是 WCF 服务（服务器大小）与域模型对话，域模型与数据层对话。当实体中的某些值发生变化时，我需要创建工作分配（针对真实的人）。

目前，我已将该逻辑放在 WCF 服务中，但这让我觉得有点恶心。然后我继续将逻辑移动到存储库中，但这也让我感到恶心。现在我没有地方放它了。

我没有的是在 WCF 服务和域存储库之间进行中介的域服务！这是我应该创建并将这个逻辑放在那里的东西吗？你还有其他建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-04T12:29:51.623

您的域模型应该理解当这些属性值发生变化时需要采取特殊操作。操作的细节应该被分离出来 - 可能是使用 Windows Workflow Foundation 的工作流。这允许轻松定制、异步处理，甚至是人工工作流程（需要在工作流程完成之前批准某事的人）。

当然，如果您觉得有需要，使用 WCF 创建工作流服务很容易。甚至还有模板，这就是即将推出的都柏林功能的目标方向。

# iphone - 如何以与应用程序启动器相同的方式在 iPhone 上“点亮”png？

> ID：716978
> 
> 赞同：2
> 
> 时间：2009-04-04T12:17:55.910
> 
> 标签：iphone

我想向用户展示当应用启动器转换为普通的“闪亮”图标时，他们的方形平面 .png 图像会是什么样子。

例如圆角和玻璃效果。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-04T12:23:22.310

看看这个教程：

[http://www.keepthewebweird.com/iphone-style-icon-tutorial/](http://www.keepthewebweird.com/iphone-style-icon-tutorial/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-07T17:00:04.023

对于图标上“闪耀”的应用程序内表示，您可以使用[此处](https://stackoverflow.com/questions/422066/gradients-on-uiview-and-uilabels-on-iphone/422208#422208)的代码创建一个绘制闪耀渐变的自定义 UIView （调整渐变颜色以匹配 Apple 的）。当您想将“闪耀”应用到预览图标时，只需将此自定义 UIView 覆盖在其 UIImageView （或您托管它的任何东西）之上。

矩形剪裁可能有点棘手。如果您有纯黑色背景，则可以覆盖一个框架 UIImageView，该框架有一个黑色区域，其中心有一个圆角矩形透明区域。您还可以通过 Core Graphics 以更通用的方式执行此操作，方法是将您的图像和光泽度绘制到视图中，然后使用带有圆角矩形的 CGContextClip 来雕刻圆形内部。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-08T17:55:31.417

如果您想在 iPhone 本身上执行此操作，[这里有一个快速的方法来查看使用网站图标的外观。](https://stackoverflow.com/questions/725791/how-can-i-shine-a-png-on-the-iphone-in-code/731061#731061)

# c# - 你用过ngen.exe吗？

> ID：716983
> 
> 赞同：47
> 
> 时间：2009-04-04T12:20:59.257
> 
> 标签：c#, .net, optimization, clr, ngen

这里有人用过ngen吗？在哪里？为什么？是否有任何性能改进？何时何地使用它有意义？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-04-04T12:24:16.660

我不是每天都使用它，但它被想要提高性能的工具使用；例如，Paint.NET 在安装过程中使用 NGEN（或者可能是第一次使用）。一些 MS 工具也有可能（尽管我不确定）。

基本上，NGEN 预先为装配执行大部分 JIT，因此冷启动几乎没有延迟。当然，在最典型的用法中，不会达到 100% 的代码，所以在某些方面这会做很多*不必要*的工作——但它不能提前告诉你。

IMO 的缺点是您需要使用 GAC 才能使用 NGEN；我尽量避免使用 GAC，以便我可以使用 robocopy-deployment（到服务器）和 ClickOnce（到客户端）。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-04-04T12:37:23.633

是的，我看到了性能改进。我的测量结果表明，如果我也将我的程序集放入 GAC，它确实提高了启动性能，因为我的程序集都是强命名的。如果您的程序集是强命名的，则 NGen 不会在不使用 GAC 的情况下产生任何影响。这样做的原因是，如果您有不在 GAC 中的强命名程序集，则 .NET 运行时通过从磁盘加载整个托管程序集来验证您的强命名程序集没有被篡改，因此它可以验证它绕过NGen 的主要优势之一。

这对我的应用程序来说不是一个很好的选择，因为我们依赖于我们公司的通用程序集（它们也是强命名的）。通用程序集被许多使用许多不同版本的产品使用，将它们放入 GAC 意味着如果我们的应用程序之一没有说“使用特定版本”的通用程序集之一，它将加载 GAC 版本，无论什么版本在其执行目录中。我们认为 NGen 的好处不值得冒险。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-04T12:49:09.627

Ngen 主要减少 .NET 应用程序和应用程序工作集的启动时间。但它有一些缺点（来自 Jeffrey Richter 的 CLR 通过 C#）：

没有知识产权保护

NGen 的文件可能会不同步

较差的加载时间性能（变基/绑定）

较差的执行时间性能

由于刚才列出的所有问题，您在考虑使用 NGen.exe 时应该非常谨慎。对于服务器端应用程序，NGen.exe 几乎没有意义，因为只有第一个客户端请求会受到性能影响；未来的客户请求高速运行。此外，对于大多数服务器应用程序，只需要一个代码实例，因此没有工作集优势。

对于客户端应用程序，如果多个应用程序同时使用程序集，NGen.exe 可能有助于缩短启动时间或减少工作集。即使在一个程序集没有被多个应用程序使用的情况下，NGen 一个程序集也可以改进工作集。此外，如果 NGen.exe 用于所有客户端应用程序的程序集，CLR 将根本不需要加载 JIT 编译器，从而进一步减少工作集。当然，如果只有一个程序集不是 NGen 的，或者如果一个程序集的 NGen 文件不能使用，JIT 编译器将加载，并且应用程序的工作集增加。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-04-04T12:23:40.107

`ngen`主要以改善启动时间（通过消除 JIT 编译）而闻名。它可能会改善（通过减少 JIT 时间）或降低应用程序的整体性能（因为某些 JIT 优化将不可用）。

.NET Framework 本身`ngen`在安装时用于许多程序集。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-04T12:29:37.893

我用过它，但只是为了研究目的。仅当您确定部署环境的 cpu 架构时才使用它（它不会改变）

但让我告诉你 JIT 编译还不错，如果你有跨多个 cpu 环境的部署（例如经常更新的 Windows 客户端应用程序），那么不要使用 NGEN。那是因为有效的 ngen 缓存取决于许多属性。如果其中一个失败，您的程序集会再次退回到 jit

在这种情况下，JIT 显然是赢家，因为它根据运行的 cpu 架构动态优化代码。（例如，它可以检测是否有超过 1 个 cpu）

并且 clr 在每个版本中都在变得更好，所以简而言之，除非您对部署环境非常确定，否则请坚持使用 JIT - 即使这样，您的性能提升也很难证明使用 ngen.exe 是合理的（可能会在几百毫秒内获得收益） - 恕我直言 -它不值得努力

还检查这个关于这个主题的真正好的链接 - [JIT Compilation and Performance - To NGen or Not to NGen？](http://www.codeguru.com/columns/experts/article.php/c4651)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-05-28T08:09:52.970

是的。用于 WPF 应用程序以加快启动时间。启动时间从 9 秒变为 5 秒。[在我的博客](http://morten.bravonet.no/ngen)中阅读它：

> 我最近发现 NGEN 的性能有多么出色。我目前处理的应用程序有一个生成的数据访问层 (DAL)。数据库模式非常大，我们还直接将一些数据（值列表）生成到 DAL 中。结果：具有许多字段和许多方法的许多类。分析应用程序时经常会出现 JIT 开销，但在搜索 JIT 编译和 NGEN 之后，我认为这不值得。安装时间开销以及管理是我的主要关注点，这让我忽略了这些迹象，而是专注于为应用程序添加更多功能。当我们将架构更改为在 64 位机器上运行的“任何 CPU”时，情况变得更糟：我们的应用程序在单个语句上挂起长达 10 秒，而分析器仅显示问题区域的 JIT 开销。NGEN 解决了​​这个问题：语句从 10 秒缩短到 1 毫秒。这个声明不是启动过程的一部分，所以我很想知道 NGEN 对整个应用程序的启动时间有什么影响。它从 8 秒变为 3.5 秒。
> 
> 结论：我真的建议在您的应用程序上尝试一下 NGEN！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-10-02T15:58:12.723

作为 Mehrdad Afshari 关于 JIT 编译的评论的补充。如果通过 XmlSerializer 序列化具有许多属性的类并在 64 位系统上使用 SGEN，则 NGEN 组合具有潜在的**巨大**影响（在我们的例子中是千兆字节和分钟）。

更多信息在这里： [XmlSerializer 启动在 64 位系统上的巨大性能损失，](https://stackoverflow.com/questions/4137335/xmlserializer-startup-huge-performance-loss-on-64bit-systems)尤其是看到 Nick Martyshchenko 的回答。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-05-18T10:32:49.917

是的，我用一个小型的单个 CPU 密集型 exe 进行了尝试，使用 ngen 时它稍微慢了一点！

我多次安装和卸载 ngen 映像并运行基准测试。

我总是得到以下可重现的 +/- 0.1 秒：没有 33.9 秒，有 35.3 秒

# c# - 如何使用 GDI+ 绘制环形（甜甜圈）？

> ID：716984
> 
> 赞同：4
> 
> 时间：2009-04-04T12:21:56.570
> 
> 标签：c#, .net, gdi+, shapes, drawing2d

我一直在尝试在 C# 中绘制一个带有透明孔和渐变边缘的[环](http://en.wikipedia.org/wiki/Annulus_(mathematics))（有厚度的环），但收效甚微。有人对如何做到这一点有任何建议吗？

这是一个不错的[混合实用程序](http://www.codeproject.com/KB/miscctrl/ColorBlender.aspx?fid=1524852&df=90&mpp=25&noise=3&sort=Position&view=Quick)

这是最终结果 - 感谢 BlueMonkMN

```
 Rectangle GetSquareRec(double radius, int x, int y)
    {
        double r = radius;
        double side = Math.Sqrt(Math.Pow(r, 2) / 2);
        Rectangle rec = new Rectangle(x - ((int)side), y - ((int)side), (int)(side * 2) + x, (int)(side * 2) + y);

        return rec;
    }
    void Form1_Paint(object sender, PaintEventArgs e)
    {

        Graphics gTarget = e.Graphics;
        gTarget.SmoothingMode = SmoothingMode.AntiAlias;

        GraphicsPath pTemp = new GraphicsPath();

        Rectangle r = GetSquareRec(200, 225, 225);
        pTemp.AddEllipse(r);
        pTemp.AddEllipse(GetSquareRec(50, 225, 225));

        Color[] colors = new Color[5];
        colors[0] = Color.FromArgb(192, 192, 192);
        colors[1] = Color.FromArgb(105, 0, 0);
        colors[2] = Color.FromArgb(169, 169, 169);
        colors[3] = Color.FromArgb(0, 0, 0);
        colors[4] = Color.FromArgb(0, 0, 0);

        float[] positions = new float[5];
        positions[0] = 0f;
        positions[1] = 0.1f;
        positions[2] = 0.35f;
        positions[3] = 0.5f;
        positions[4] = 1f;

        ColorBlend Cb = new ColorBlend();
        Cb.Colors = colors;
        Cb.Positions = positions;

        PathGradientBrush pgb = new PathGradientBrush(pTemp);
        pgb.InterpolationColors = Cb;
        pgb.CenterPoint = new PointF(r.X + (r.Width / 2), r.Y + (r.Height / 2));
        gTarget.FillPath(pgb, pTemp);

    } 
```

[http://www.freeimagehosting.net/uploads/th.515733e62e.jpg](http://www.freeimagehosting.net/uploads/th.515733e62e.jpg)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-04T12:41:14.903

这就是我在[Scrolling Game Development Kit](http://sgdk2.sf.net/)中的做法：

```
pTemp = new GraphicsPath();
pTemp.AddEllipse(Start.X, Start.Y, End.X - Start.X, End.Y - Start.Y);
pTemp.AddEllipse((Start.X * 3 + End.X) / 4f,
                 (Start.Y * 3 + End.Y) / 4f,
                 (End.X - Start.X) / 2f,
                 (End.Y - Start.Y) / 2f);
PathGradientBrush pgb = new PathGradientBrush(pTemp);
Blend b = new Blend();
b.Factors = new float[] { 0, 1, 1 };
b.Positions = new float[] { 0, .5F, 1 };
pgb.Blend = b;
pgb.CenterColor = ((SolidBrush)CurrentBrush).Color;
pgb.SurroundColors = new Color[] {CurrentPen.Color};
gTarget.FillPath(pgb, pTemp);
pgb.Dispose();
pTemp.Dispose(); 
```

[![环截图](https://i.stack.imgur.com/n3FVg.png)](https://i.stack.imgur.com/n3FVg.png)
[（来源：[enigmadream.com](http://enigmadream.com/pri/annulus.PNG)）]

我为此示例编辑了原始 SGDK 代码，因为最初我不够聪明，无法缩放渐变以排除孔，但现在我想我是 :)。

如果您希望看到这样的渐变：

[![替代文字](https://i.stack.imgur.com/75viG.png)](https://i.stack.imgur.com/75viG.png)
[（来源：[enigmadream.com](http://enigmadream.com/pri/annulus2.PNG)）]

然后将混合代码更改为如下所示：

```
Blend blend = new Blend();
blend.Factors = new float[] { 0, 1, 0, 0 };
blend.Positions = new float[] { 0, 0.25F, .5F, 1 };
pgb.Blend = blend; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-04T13:06:19.820

您可以组合使用两次对 Graphics.DrawArc 的调用，一次绘制一个环的顶部和底部或左侧和右侧部分。`*****