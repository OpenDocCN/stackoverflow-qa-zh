# StackOverflow 问答 000837000-000837999

# ruby-on-rails - 仅将缓存资金用于单个模型？

> ID：837007
> 
> 赞同：4
> 
> 时间：2009-05-07T20:58:14.827
> 
> 标签：ruby-on-rails, ruby, memcached, cache-money

我想使用缓存资金，但我不想开始自动缓存所有内容（我正在使用大型生产应用程序、TB 级数据等）。如何仅将其用于我指定的模型？现在我有：

```
# initializers/cache_money.rb
require 'cache_money'

config = (cfg = YAML.load(IO.read(File.join(RAILS_ROOT, "config", "memcached.yml"))))[RAILS_ENV] || cfg["defaults"]
$memcache = MemCache.new(config)
$memcache.servers = config['servers']

$local = Cash::Local.new($memcache)
$lock = Cash::Lock.new($memcache)
$cache = Cash::Transactional.new($local, $lock) 
```

然后在我想用缓存钱缓存的模型中：

```
# my_model.rb
class MyModel < ActiveRecord::Base
  is_cached :repository => $cache
  # ...
end 
```

但这不起作用；对 is_cached 的调用给出以下错误：NoMethodError: undefined method `create' for Config:Module

有任何想法吗？如果做不到这一点，我可以在任何地方寻求缓存资金的帮助吗？我找不到邮件列表或任何东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-10-18T18:29:36.783

我认为这是 cache_money 代码中的一个错误。

在 github 上有可以修复这个 bug 的分支，例如：http: [//github.com/quake/cache-money](http://github.com/quake/cache-money)

通过此提交可以看到修复：

[http://github.com/quake/cache-money/commit/54c3d12789f31f2904d1fe85c102d7dbe5829590](http://github.com/quake/cache-money/commit/54c3d12789f31f2904d1fe85c102d7dbe5829590)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T11:21:28.960

我刚刚在尝试部署应用程序时遇到了同样的问题。在我的开发机器上运行它很好，但是在生产机器上它失败了这个错误。

除了架构（OSX 与 CentOS）之外，我能看到的唯一区别是 ruby​​ 版本不同（1.8.6 p114 与 1.8.6 p0）。将服务器升级到最新的 1.8 版本 (1.8.7 p160) 后，此错误消失了。

# c# - (C#) 如何检查路径是否是 Windows 中需要提升才能修改的受保护路径？

> ID：837009
> 
> 赞同：0
> 
> 时间：2009-05-07T20:58:35.013
> 
> 标签：c#, uac, protected-folders

我们有一个文件夹，我们的应用程序可能会在其中读取、写入和创建/删除文件，虽然我们可以默认到一个安全的位置，但我们允许用户选择不同的目录。我们如何检查他们选择的目录是否“安全”？

我们希望在运行时不需要管理员提升，并且此路径将用于应用程序的后续启动，因此我们检查我们的进程当前是否能够写入该位置是不够的，因为它可能是应用程序第一次以管理员权限启动（实际上它是由安装程序启动时，因为安装程序运行提升），如果他们选择受保护的位置，下次他们尝试运行应用程序时，他们将无权访问目录。可能 GB 的持久性数据存储在此位置，因此请求新位置并移动文件并不是理想的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T21:03:03.457

由于任何文件夹都可以设置管理员认为合适的权限，因此唯一真正的方法是知道它将以哪个用户身份运行（当前登录用户？），然后进行访问检查以查看该用户是否具有对该目录的适当访问。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T21:20:12.467

任何文件夹不仅可以拥有任何权限，而且可以随时更改，*包括在您检查文件和使用文件之间*。所以真的，你唯一能做的就是使用一个文件并在它失败时处理异常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T21:29:40.633

关于随时更改权限的其他建议是有效的，但在安装时检查仍然比根本不检查要好。

由于第一次运行将被提升，您可能想要做的是启动一个单独的非提升进程来测试该位置，然后原始实例可以继续知道该位置将工作，除非/直到其他人更改权限。

# visual-studio - 编辑 aspx/母版页时 Visual Studio 2008 冻结

> ID：837013
> 
> 赞同：17
> 
> 时间：2009-05-07T20:59:20.830
> 
> 标签：visual-studio, visual-studio-2008

当我编辑母版页或 aspx 文件时，Visual Studio 不断冻结。这是我尝试过的但没有帮助的方法：

*   重启VS
*   一次只打开几个文件
*   禁用所有插件（resharper 等）
*   删除 .suo 和 .user 文件
*   将默认编辑器从 Web 表单编辑器和母版页编辑器更改为 HTML 编辑器
*   已安装 SP1

我没有大量文件 - 3 个母版页和 30 个 aspx 文件。这是一个 asp.net mvc 项目。要让 VS 冻结，我所要做的就是输入一些文本，甚至只是粘贴。冻结持续5-10秒。我的机器有 4GB 的 RAM 和快速磁盘。

它与asp.net mvc有什么关系吗？解决方案中其他项目的数量和大小会影响编辑器吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2010-03-31T04:42:21.843

我通过从我的机器上卸载“Microsoft Visual Studio Web 创作组件”解决了这个问题。它可以从控制面板中的“添加/删除程序”选项中卸载。什么样的恶梦！

现在一切都按预期进行。我很惊讶微软无法弄清楚问题和解决方案是什么。他们又在研发和问答上花了多少钱？？？？？？

希望这对其他人有帮助。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-07-16T18:51:13.920

我有一个类似的问题，并找到了[一篇](http://abdullin.com/journal/2009/5/12/visual-studio-2008-locks-or-freezes-in-aspx.html)关于该问题的文章，而不是重新安装 Office 来检查，我只是将 setup.exe 重命名为 setup.exe.old 并解决了它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-06-16T16:19:50.823

我终于弄清楚我的问题是什么。我的母版页中有一个协议相关脚本参考，它在我的编辑器上散发着恶臭。希望微软很快会修复一个错误。

这是我所拥有的：

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"   
type="text/javascript"></script> 
```

我必须做些什么来解决它：

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js" 
type="text/javascript"></script> 
```

希望对某人有所帮助

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-07T21:04:57.837

我不确定，但我想如果你在解决方案中有很多（可能是巨大的）项目，这*肯定会*减慢 VS，因为它会解析代码为你提供最新的智能菜单...无论如何，母版页有点慢，尤其是 VS 在呈现 HTML 元素时并没有那么快，更不用说母版页了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-09-19T10:49:45.060

如果您有标记问题，也可能发生这种情况。例如，如果您有一个标签控件并添加类似`Text="<%# TranslateLabel("lblSearch") %>"`页面的内容，即使在源模式下尝试保存它时也会冻结。正确的语法应该是`Text='<%# TranslateLabel("lblSearch") %>'`. 我知道这不是你的问题，但也许它对其他人有用......

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-06-12T20:42:50.940

使用 VS2005，我发现问题出在我输入的 javascript 文件（位于母版页中）的链接上

```
<script src="../../js/file.js" type="text/javascript" /> 
```

当我将其更改为`<script src="/js/file.js" ... >`

问题消失了。

注意虽然这个“坏链接”在母版页中，但即使我没有将母版页作为打开文档，VS2005 也会挂起。基本上，当我尝试编辑任何东西（甚至构建应用程序）时，VS 就挂了。我不得不关闭 VS，在记事本中更改有问题的文件并再次打开 VS。然后一切都很好。

非常奇怪的是我昨晚将此链接添加到文件中并且VS仍然表现良好，直到今天早上重新启动后文件才导致问题。

我希望这可以帮助某人德里克

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-08-04T18:54:22.040

我已经断断续续地遇到这个问题几个星期了。我今天终于解决了。问题的根源（很好的双关语）是源代码控制。我目前正在使用 Visual Source Safe 2005（我知道，我很快就会放弃它），但我认为这可能是任何源代码控制包的问题。

当我能够使用未连接到 VSS 的机器在设计视图中毫无问题地编辑 ASPX 页面时，我首先怀疑 VSS。如果我从项目中删除源代码控制，一切正常。

然后我发现不知何故我的 VSS 连接设置从使用文件夹连接更改为 Web 连接。我不确定这是怎么发生的，因为我是唯一一个使用 VSS 的人，而且我当然没有改变它。无论如何，我将其重置回来，一切又开始正常工作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-09-19T10:20:30.580

重命名对我有用，即将 setup.exe 更改为 setiup.exe.old

C:\Program Files (x86)\Common Files\microsoft shared\OFFICE12\Office Setup Controller\Setup.exe

希望我能先找到这篇文章——我花了很多工时

谢谢 -j

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-11-02T16:29:13.350

我遇到了 Visual Studio 2008 SP1 的示例问题。是的，它也是一个母版页。我找到的解决方案是重新启动 Visual Studio 2008 并使用 ASPX 文件的源模式 :)

我想这里的问题是母版页。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-11-25T10:28:14.887

当我删除 Office 2007 以安装 Office 2010 测试版时，我遇到了同样的问题。我在 Windows 7 上安装了 Office 2010 64 位

我使用了 Robert MacLean 的解决方案，它对我有用，我只是重命名了文件。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-07-08T13:28:15.367

我不确定这是否会对任何人有所帮助，但在尝试了所有答案无济于事之后，我在我的 ASPX 页面上删除了一大块注释代码，并且行为消失了。我不太确定为什么一大段带注释的代码会导致 VS 在每次编辑操作后冻结，但这似乎就是发生的事情。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-11-21T11:24:34.420

我有一个类似的问题，即 Visual Studio 在打开母版页文件时会无限期挂起。我通过在记事本+中打开母版页文件，删除html，然后从Visual Studio放回它来解决它。

希望这对某人有帮助！

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-03-05T15:46:04.063

有趣的是，“Visual Studio Web Authoring”程序的卸载和Office setup.exe 的重命名似乎都相关。我在卸载 Web Authoring 时查看了 setup.exe，卸载的副作用是删除了 setup.exe 和目录的所有其他内容。此外，当我将 setup.exe 重命名为其他内容（例如“setup.exe.renamed”）时，我在尝试卸载 Web 创作时遇到了错误。当我将 setup.exe.renamed 重命名回 setup.exe 时，这些错误就消失了。反正就是在这里省了别人一倍的功夫。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-03-27T02:41:36.337

我通过安装此修补程序解决了这个问题：

[http://blogs.msdn.com/b/webdev/archive/2008/02/09/downloadable-hotfix-performance-and-editor-fixes-for-microsoft-visual-studio-2008-and-visual-web-开发人员快递 2008.aspx](http://blogs.msdn.com/b/webdev/archive/2008/02/09/downloadable-hotfix-performance-and-editor-fixes-for-microsoft-visual-studio-2008-and-visual-web-developer-express-2008.aspx)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-07-10T14:48:58.883

尝试删除 ReflectedSchemas 文件夹（C:\Documents and Settings[用户名]\Application Data\Microsoft\VisualStudio\9.0\ReflectedSchemas）。这个文件夹增长很快（经过 4 年的编程，我的文件夹是 2.6 GB）并且增长会大大减慢 VS。例如关闭 asx 或 ascx 文件后 10-20 秒的无响应 UI。我还没有等他们打开，我在等他们关门。显然打开很容易，关闭部分是困难的工作！

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2011-11-14T14:01:59.007

卸载“Visual Studio Web 创作工具”解决了这个问题。

# mysql - 实现标签的多对一关系：如何计算标签的使用次数？

> ID：837015
> 
> 赞同：0
> 
> 时间：2009-05-07T20:59:45.447
> 
> 标签：mysql

我正在试验一个多对一关系的标记系统。我的架构是：

**物品**表：

*   item_id
*   评论

**评论_标签**：

*   item_id
*   tag_id

**标签**表：

*   tag_id
*   标签名称

我一直在阅读底部链接的实现设计，但被卡住了。我可以毫无问题地插入标签。

如何获取已使用的每个标签**并**获取它已应用于**评论_标签**表中的项目的次数？

[http://www.pui.ch/phred/archives/2005/04/tags-database-schemas.html](http://www.pui.ch/phred/archives/2005/04/tags-database-schemas.html)

[产品标签关系的 SQL 查询](https://stackoverflow.com/questions/388687/sql-query-for-product-tag-relationship)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T21:04:47.917

```
SELECT t.tag_name, COUNT(*)
FROM tags AS t
    INNER JOIN comment_tags AS c_t ON c_t.tag_id = t.tag_id
GROUP BY c_t.tag_id
ORDER BY t.tag_name; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T21:06:27.053

不是正确的名称，但大多是正确的语法

```
select TagName, count(TagName)
from TagTable
group by TagName 
```

# jquery - 如何仅使用 url 触发 jquery 函数？

> ID：837023
> 
> 赞同：4
> 
> 时间：2009-05-07T21:00:18.207
> 
> 标签：jquery, url, function, triggers, hyperlink

这是我的第一个问题.. 所以，我们开始吧。

我有一个网站，100% xhtml/css 和一些 ajax 功能感谢 jquery。

问题是..对于所有“子页面”.. url 保持不变（index.php）..

**我的问题是..**

jquery 是否允许某些 url 参数触发特定功能？

**例如：** www.mypage.com -> 主页.. 如果我点击.. 假设产品.. url 将是相同的.. 如果我尝试将 url 发送给朋友（复制和粘贴）它会是 www.mypage.com.. 所以.. 如果我的朋友点击链接，他将被重定向到主页而不是产品页面，这是我想与他分享的部分。

有没有设置像.. www.mypage.com?s=products 这样的url 来触发jquery 事件而不使用php？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T21:03:38.403

[jquery 查询字符串插件](http://plugins.jquery.com/node/7491)提供了一种解析查询字符串的简单方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T21:06:50.873

在我看来，您想在不重新加载页面的情况下更改查询字符串。这是不可能的。您可以做的是更改 url 的#anchor 部分，因此您的 ajax 链接会将位置设置为 mysite.com/#products，然后使用 jquery 在加载时进行检测并采取相应措施。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-07T21:09:21.710

通常，AJAX 应用程序中的假页面通过在 a 之后添加一些内容来更改查询字符串`#`，例如`www.mypage.com/#products`. 如果您尝试在 JavaScript 中将 URL 更改为不同的 URL，浏览器将重定向到该页面。但是，如果更改在 a 之后`#`，它将保留在页面上（并尝试将具有该 ID 的元素放在浏览器窗口的顶部）。

因此，您可以尝试使用以下 JavaScript 来设置 URL：

```
window.location.hash = 'products'; 
```

然后您可以在加载页面时查找它，以便您知道要检索哪个页面。

还有一些现成的 JavaScript 库可以让历史记录在这些场景中正常工作，尽管我不知道足以推荐一个特定的库。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-07T21:10:27.433

[http://blog.rebeccamurphey.com/2007/12/04/anchor-based-url-navigation-with-jquery/](http://blog.rebeccamurphey.com/2007/12/04/anchor-based-url-navigation-with-jquery/)

从来没有这样做过，但是这个网站有非常直接的方法。

基本上，您为拥有的每个逻辑页面指定一个锚标记，并在用户导航到该逻辑页面时相应地更新 url。

当新用户到达时，您解析查询字符串（如上所述），然后执行适当的导航操作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-07T21:15:25.067

有很多插件可用于这种功能。找到它们的关键词是“历史”

*   [历史插件](http://plugins.jquery.com/project/history)
*   [jquery.history](http://www.mikage.to/jquery/jquery_history.html)插件
*   [历史/远程](http://stilbuero.de/jquery/history/)插件。

# visual-studio - Visual Studio 中的“转到定义”仅显示元数据

> ID：837037
> 
> 赞同：150
> 
> 时间：2009-05-07T21:02:41.273
> 
> 标签：visual-studio

我在 Visual Studio 2008 中的一个 Web 项目中工作。当我按 F12（或右键单击并选择转到定义）时，Visual Studio 始终会转到元数据文件而不是转到源文件。

几点：

*   所有源代码都是C#，没有VB.Net
*   所有项目都在同一个解决方案中
*   一切都是项目参考而不是文件参考（检查和双重检查）
*   我已经尝试过清理/重建解决方案方法（甚至清除临时目录、临时 ASP.NET 文件目录等）。

有没有其他人看到过这种行为和/或知道如何解决它？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-05-08T13:11:14.200

好吧，另一位开发人员找到了答案。我们遇到问题的特定项目最初是作为文件引用添加的，然后被删除并添加为项目引用。然而，Visual Studio 将两者都保存在网站的 csproj 文件中，从而导致了问题。他进入并手动编辑了csproj文件以删除对问题项目的文件引用，现在一切都已修复

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2009-05-08T01:10:54.033

当您没有将引用添加为项目但使用“添加引用”对话框中的“浏览”选项卡指向 dll 或 exe 时，就会发生这种情况。如果您使用 Projects 选项卡添加引用，您应该在选择 Go To Definition 时直接转到源代码。

但是，如果您安装[ReSharper](http://www.jetbrains.com/resharper/index.html)，即使您使用浏览选项卡添加了对 dll/exe 的引用，您也会转到源代码。

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2015-08-27T21:08:39.427

看起来它也需要在 Resharper 中进行设置。在我在 Resharper 中启用它之前，我的 Visual Studio 不会导航到 .NET Framework 源代码。

[![Resharper 设置以允许导航到外部源](https://i.stack.imgur.com/2qffc.png)](https://i.stack.imgur.com/2qffc.png)

* * *

## 回答 #4

> 赞同：37
> 
> 时间：2016-01-14T07:13:45.087

**1.**关闭你的解决方案。

**2.**删除解决方案的.sln 文件`<name of the solution>`所在文件夹中隐藏的 .suo 文件。`<name of the solution>`

**3.**打开你的解决方案。

**4.**重建你的解决方案。

* * *

## 回答 #5

> 赞同：24
> 
> 时间：2017-09-28T18:00:31.523

对于那些使用 VS 2017（我现在是 15.3.4 版）的人来说，这里是简单的步骤：

1.  在 Windows 资源管理器中打开您的解决方案并关闭 Visual Studio
2.  在资源管理器菜单中，选择查看并确保选中“隐藏项目”复选框
3.  导航到子文件夹`.vs\[your solution name]\v15`
4.  删除`.suo`文件
5.  重新启动 VS 并构建您的解决方案

这为我解决了这个问题：F12 打开了实际的源文件，而不是“来自元数据”的版本。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2010-07-16T10:23:22.820

如果您移动构建项目的位置，Visual Studio 经常会遇到转到元数据而不是您的项目的问题，即您可能有多个版本来测试。

只需删除引用并立即将其添加回来，一切都会得到解决。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2012-02-29T12:57:31.913

标记的解决方案并不总是有效。您必须确保项目文件中引用的项目 GUID 是您尝试引用的项目的正确 GUID。Visual Studio 确实允许它们在某些情况下不同步。您可以使用文本编辑器从项目文件中获取项目 GUID。因此，如果项目 A 引用项目 B。在文本编辑器中打开项目 B.csproj，从标签中复制项目 GUID。然后在文本编辑器中打开项目 A.csproj，并确保您使用的是正确的 GUID。在这种情况下搜索项目名称“B”。它应该在 . 将标签中的 GUID 替换为正确的 GUID。保存并重新加载。当然，还要确保删除对项目的基于文件的引用。您只需要项目引用。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2014-06-20T15:26:08.720

我已经杀死了所有 VS 实例，删除了 SUO，启动了 sln，它对我有用......

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2013-11-12T15:01:00.590

删除引用 dll，构建（将出现错误），添加引用（您已删除）然后再次构建...然后您的函数上的 F12 应该可以工作（对我有用）。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2020-05-05T22:47:01.037

# #1

检查“查看 - 对象浏览器”，如果您看到多个具有相同名称的程序集 - 这就是您收到此错误的原因。

对我们来说，这是 VS 2019 中的一个错误：

如果`App_Code`文件夹中有 ASP.NET “Razor helpers”，Visual Studio 2019 会将其解释为不同的程序集但具有相同的名称，这会隐藏实际的程序集。

除了将这些帮助程序重写为部分视图或 HTML 帮助程序（如果您计划迁移到 .NET Core，您无论如何都必须这样做）之外，没有其他解决方法。

请在 MS 的网站上查看此解决方法，并请在那里为该错误投票，以便 MS 修复它

[https://developercommunity.visualstudio.com/solutions/1008795/view.html](https://developercommunity.visualstudio.com/solutions/1008795/view.html)（请点赞）

# #2

同一个程序集可以在对象浏览器中加载两次的另一个原因是，如果您有一个启动 iis-express 进程并且永远不会正确终止它的单元测试项目。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2010-11-01T05:46:51.357

我想出了如何[从这篇文章](http://social.msdn.microsoft.com/Forums/en/csharpide/thread/e843f3d1-3a4c-4739-81a8-ca2d91b5f5e0)中解决我的问题，也许它也适用于你们中的一些人。

我按照以下步骤操作：

1.  关闭解决方案。
2.  删除解决方案的智能感知数据库文件：.ncb
3.  打开解决方案。
4.  重建解决方案。

（我相信第 3 步或第 4 步会在丢失时重新生成智能感知数据库文件）

Intellisense、“去定义”和“查找所有参考”应该再次工作。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2017-07-14T10:40:12.673

就我而言，（使用 Visual Studio Professional 2015），当我禁用 XAML 设计器时，F12 停止工作。一旦我恢复更改并重新启动 Visual Studio，F12 就会再次工作。

多次检查模式以确认，然后发布。希望它可以帮助某人。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2012-01-24T21:51:50.093

症状：

在使用“转到定义”或“转到声明”或“查找所有引用”功能时，Visual Studio 2010 Ultimate 反复找不到对函数、#defines、包含等的引用——奇怪的是 Intellisense 正在工作。

使固定：

1.  关闭 Visual Studio
2.  删除（如果您想保守一点，重命名）解决方案 .sdf 文件
3.  重新打开 Visual Studio

.sdf 文件将通过解析解决方案中的包含文件自动重建

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2012-10-29T18:52:12.917

对我来说，GUID 解决方案不起作用，我找不到我的 .ncb 文件。（或者也许我很懒，看起来不够努力，但这并不重要。）重建和重新启动视觉工作室也没有帮助。

我所做的是关闭 Visual Studio 并删除我的智能感知一直链接到的元数据文件顶部引用的 .dll 和 .pdb。就我而言，这意味着我从 Utilities/bin/Release 中删除了我的 .dll 和 .pdb 文件。（Utilities 是我遇到问题的 .dll 项目的名称。）然后我重新启动了 Visual Studio 并重建了 .dll，然后是整个解决方案。没有更多的问题！

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2013-07-25T16:06:35.657

刚刚找到另一个原因。我将我的 Web 项目升级到 4.0，但将类库保留在 2.0。那时，我的解决方案中的所有类库都被视为来自我的 Web 项目的文件引用。可能会帮助别人...

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2015-11-27T10:32:57.883

我遇到了同样的问题，一位同事给了我以下解决方案，它奏效了！如果以上都不适合你，

1.  删除所有引用并将它们添加回来（确保路径正确）
2.  转到**解决方案**属性，然后重新检查所有项目的项目依赖关系。确保您将使用的项目作为依赖项添加到您正在处理的项目中。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2016-02-01T15:23:58.460

我做了所有建议的步骤，但没有任何改变，
最后右键单击并添加参考菜单，项目选项卡

1.  只需取消选择参考项目。
2.  保存解决方案。
3.  选择同一个项目。
4.  重建解决方案。

问题排序。希望这对某人有所帮助。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2017-11-22T10:41:06.593

以下步骤对我有用。

1.  转到 .csproj 文件
2.  在记事本中打开它转到引用 dll 的行。`<Reference Include="">`
3.  删除行

    ```
    <SpecificVersion>False</SpecificVersion> 
    or 
    <SpecificVersion>True</SpecificVersion> 
    ```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2018-09-20T12:24:16.440

首先从 Visual Studio 中删除 dll 文件并从解决方案资源管理器中手动添加它们 --> 网站 --> 添加 --> 参考并在 IIS 中启用 32 位应用程序为我修复了它。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2021-01-27T00:50:49.460

VS2017 VB.Net Windows 10 Pro - 我使用一个程序集名称“SharedCollection”，其中包括一个名为 MyGlobals 的 VB 模块。全局变量之一是 FileVersion。引用显示元数据，并且引用它的 Windows 服务具有过时的设置。我已经尝试了上面的一些 SUO 补救措施，但都没有奏效。

**这有效**

我在 References 中删除并重新创建了 ShareCollection 的项目参考。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2010-04-29T07:03:27.420

1.  单击 VS 中的网站菜单。
2.  添加参考...
3.  从对话框中单击项目选项卡
4.  选择ddl
5.  点击确定按钮

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2014-03-06T15:20:16.023

就我而言，我最近刚换了

```
<mvcBuildViews> 
```

在我网站的 .csproj 文件中设置为“true”（在我的 Razor 视图文件中查找编译错误：[http ://forums.asp.net/t/1909113.aspx?How+to+have+Visual+Studio+2012+returned +compile+errors+on+razor+syntax+error+in+asp+net+web+page+2+](http://forums.asp.net/t/1909113.aspx?How+to+have+Visual+Studio+2012+returned+compile+errors+on+razor+syntax+error+in+asp+net+web+page+2+) )，然后当我构建时，我从站点的 /obj/Debug/ 目录中收到错误。从任何这些文件（已过期）中，右键单击并选择“转到定义”将为我提供 [元数据] 版本。

所以对我来说，这里的解决方案都不起作用，因为我不是从我项目中实际存在的文件开始的。删除了整个 /obj/Debug/ 目录，错误消失了，并且从任何正常文件中我都可以正确使用 Go To Definition。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2014-09-23T21:00:22.377

我刚刚在 VS 2013 上遇到了这个问题。我可以（做了吗？）不能隔离的事情是更改 CSPROJ 文件中的 GUID。由于 CSPROJ 文件已签入 SVN，因此我无法简单地更改本地开发人员的 GUID。相反，每次发生本地更改时，我都会不断地通过 SVN 还原本地更改。

首先，我必须解决不断变化的 GUID 问题。

1.  将 CSPROJ 恢复为签入版本。
2.  通过文本编辑器打开 CSPROJ，而不是 VS。
3.  从原始 CSPROJ 文件中提取值。

    {B1234567-5123-4AAE-FE43-8465767788ED}

4.  通过文本编辑器打开 SLN 文件，而不是 VS。

5.  在解决方案中找到项目引用。

    项目（“{FAE12345-3210-1357-B3EB-00CA4F396F7C}”）=“Some.Project”，“....\assemblies\Some.Project\Some.Project.csproj”，“{B7654321-5321-4AAE- FE3D-ED20900088ED}" 结束项目

6.  列出的第一个 GUID 是解决方案 GUID。对于 SLN 中引用的每个项目，您应该看到在第一个参数处重复该值。.csproj 后面的 GUID 是您要替换为原始 GUID 的 GUID。

这应该解决了第一个问题，但是元数据中的“Go to Definition”落地并没有解决。在我们的 SLN 文件中，有一个主项目（我们的网站），因此它在 SLN 文件中的条目应该包含一个具有多个 GUID 值的 ProjectSection 条目。这是一个例子：

```
ProjectSection(ProjectDependencies) = postProject
{AC50D230-24C4-4DCA-BAAD-355E6AF5EFBD} = {AC50D230-24C4-4DCA-BAAD-355E6AF5EFBD}
EndProjectSection 
```

请注意，此集合中缺少的 GUID 是我原始项目中的一个。

1.  添加缺少的 GUID 作为 ProjectSection 和 EndProjectSection 之间的最后一个条目。格式似乎是每行，它是 {GUID} = {GUID}。
2.  保存文件。
3.  打开您的解决方案。
4.  右键单击新添加项目中的引用并“转到定义”。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2015-01-19T05:17:31.423

我在所涉及的两个项目之间有一个**循环引用（这是一个禁忌）。**不得不稍微重构我的代码以解决它，因为这两个项目确实相互依赖。删除其中一个引用解决了智能感知问题。它在逻辑上是有缺陷的，如果没有这个错误，我可能不会注意到！

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2015-08-04T02:48:58.720

这个对我有用：

1.  右键单击解决方案资源管理器中参考文件夹中的 dll
2.  删除dll文件
3.  右键单击参考文件夹，然后
4.  再次添加对dll文件的引用

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2019-11-20T22:08:17.693

如果您尝试跳转到已卸载（不可用）项目中的定义，则可能会发生这种情况。右键单击卸载的项目并选择“重新加载项目”。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2020-12-07T08:52:16.690

我修改了`.csproj`文件并在 Reference -> HinPath 中将 obj 更改为 bin 并解决了问题。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2022-01-05T17:41:58.860

我有这个问题的一个变体，当我加载我的解决方案时，我的引用项目有错误，直到我编译它所引用的项目。那时错误消失了，但 F12 将我带到了元数据。

问题是被引用项目中的依赖项与引用项目中的依赖项冲突。我从被引用的项目中手动删除了依赖项，直到其中一个解决了引用项目中的错误。之后，我能够 F12 到实际代码，并且项目将加载而不会出现错误。

如果有人确切知道为什么会发生这种情况，我有兴趣在评论中知道。

* * *

## 回答 #29

> 赞同：-1
> 
> 时间：2009-05-07T22:08:26.827

最好的猜测是您没有调试信息。也许您在磁盘上有多个程序集副本，但它没有 .pdb 文件。

从您的项目中搜索您的程序集名称并将它们全部删除并重建。

# ruby-on-rails - 为什么这个 ActiveRecord 方法会引发 NameError？

> ID：837044
> 
> 赞同：1
> 
> 时间：2009-05-07T21:04:30.850
> 
> 标签：ruby-on-rails, ruby

谁能告诉我这段代码有什么问题？

```
class Dataset < ActiveRecord::Base
  has_many  :dataitems  

def self.get_hash(dataset_id) 
  @dataitems = Dataset.find_by_id(24).dataitems
  @dataitems.each do |di|
    dataset_hash[di.axis0value] = di.axis1value #assign value for each category value
  end
  return dataset_hash
end 
```

在开发环境中运行时，在 development.log 中会出现以下错误：

```
rocessing BleeController#refresh_my_graph (for
127.0.0.1 at 2009-05-07 21:58:54) [GET]   Session ID: 8179153011071621ae181e852b03fbe1   Parameters: {"dataset_id"=>"24", "action"=>"refresh_my_graph", "controller"=>"blee"}   [4;36;1mDataset Columns (0.005285)[0m   [0;1mSHOW FIELDS FROM datasets[0m   [4;35;1mDataset Load (0.001132)[0m   [0mSELECT * FROM datasets WHERE (datasets.`id` = 24) LIMIT 1[0m   [4;36;1mDataitem Load (0.000646)[0m   [0;1mSELECT * FROM dataitems WHERE (dataitems.dataset_id = 24) [0m

NameError (undefined local variable or method `dataset_hash' for Dataset:Class):
    /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/gems/1.8/gems/activerecord-1.15.3/lib/active_record/base.rb:1235:in `method_missing'
    /app/models/dataset.rb:12:in `get_hash' 
```

有趣的是，它在通过控制台运行时完全可以正常工作。非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T22:17:15.840

看起来你需要`dataset_hash`在你的方法中定义。像这样的东西：

```
def self.get_hash(dataset_id)
  dataset_hash = {}
  @dataitems = Dataset.find_by_id(24).dataitems
  @dataitems.each do |di|
    dataset_hash[di.axis0value] = di.axis1value #assign value for each category value
  end
  return dataset_hash
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T08:41:20.567

或者你可以“注入”：

```
def self.get_hash(dataset_id)
  Dataset.find_by_id(dataset_id).dataitems.inject({}) do |dataset_hash,di|
    dataset_hash.merge(di.axis0value => di.axis1value)
  end
end 
```

# asp.net-mvc - 我应该在哪里放置可能重定向请求的检查？

> ID：837046
> 
> 赞同：6
> 
> 时间：2009-05-07T21:04:53.873
> 
> 标签：asp.net-mvc, authorization, redirect, routes

如果用户的密码已过期，我需要将用户重定向到更改密码页面。

我想将此代码放在一个地方，以便可以将任何请求重定向到更改密码页面。

我已经研究过扩展 AuthorizeAttribute 并覆盖 OnActionExecuting，但两者都不起作用/不允许我短路路由逻辑以重定向到密码更改页面。

稍微澄清一下，逻辑是：

未经授权的请求：
-> 任何 URL -> AuthorizeAttribute -> Login.aspx -> 密码过期 -> ChangePassword.aspx

授权请求：
-> 任何 URL -> **?????????** -> 更改密码.aspx

就是那个 ？？？？我不知道该怎么做的部分。

* * *

我想我将继续扩展 AuthorizeAttribute。***除了***密码更改控制器方法 外，我将在任何地方使用它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-07-04T00:47:33.613

```
public class DenyExpiredPasswordAttribute : AuthorizeAttribute
{

    public override void OnAuthorization(AuthorizationContext filterContext)
    {
        IPrincipal user = filterContext.HttpContext.User;

        if(user != null)
        {
            if (user.Identity.IsAuthenticated)
            {

                if (CurrentUser.PasswordExpired) // your checking of password expiration
                {
                    filterContext.HttpContext.Response.Redirect("~/Account/ChangePassword?reason=expired");
                }
            }
        }
        base.OnAuthorization(filterContext);
    }
} 
```

这很好用，只需使用此属性标记每个控制器，排除“帐户”一个。这样，在更改密码之前，没有具有过期属性的用户能够继续。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T21:43:50.660

您可以查看在 global.asax 中为 PostAuthenticateRequest 事件添加事件处理程序。

```
protected void Application_Start(object sender, EventArgs e) {
  this.PostAuthenticateRequest += new EventHandler(Global_PostAuthenticateRequest);
}

void Global_PostAuthenticateRequest(object sender, EventArgs e)
{
 if (passwordExpired) {
   Context.Response.Redirect("~/ChangePassword.aspx");
   }
} 
```

# vb6 - 关键路径分析

> ID：837053
> 
> 赞同：4
> 
> 时间：2009-05-07T21:06:03.077
> 
> 标签：vb6

我正在尝试编写一个VB6程序（为了笑），它将计算事件时间+仅基于优先表的关键路径。我希望我的学生将其用作检查机制，即。在不绘制活动网络的情况下做所有事情。我很高兴一旦我为每项活动设置了开始和结束事件，我就可以完成这一切。如何在不绘制网络的情况下分配事件。我想出的所有东西都适用于特定示例，然后不适用于另一个示例。我需要一个更通用的算法，它让我精神抖擞。帮助！

我不是专业的程序员——我在业余时间这样做是为了创建教学资源——简单的英语真的很感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-07T22:04:35.120

好的，所以你有一个优先表，我认为它是一个成对表，例如

A→B
B→C

以此类推，对于活动 {A,B,C}。每个活动还有一个持续时间和（可能）持续时间的分布，所以你知道 A 需要 3 天，B 需要 2 天，依此类推。这将被解释为“A 必须在 B 之前完成，而 B 必须在 C 之前完成”。

正确的？

现在，要做的显而易见的事情是构建活动图和箭头图——事实上，你基本上已经有了关联列表形式的图。关键部分是最大权重（最大的时间总和）路径。这是一个[最长路径问题](http://en.wikipedia.org/wiki/Longest_path_problem)，假设您的图表不是循环的（无论如何都会很糟糕），它可以通过[拓扑排序](http://en.wikipedia.org/wiki/Topological_sort)或[传递闭包](http://en.wikipedia.org/wiki/Transitive_closure)来解决。

# sql - 返回字段的 DISTINCT 第一个字符（MySQL）

> ID：837058
> 
> 赞同：24
> 
> 时间：2009-05-07T21:06:53.433
> 
> 标签：sql, mysql

我想为我的数据库中列的所有首字母生成一个字符列表。下面的 SQL 说明了我想要返回的内容。

```
从我的数据库中选择 DISTINCT first_character(name)

```

有没有办法在 MySQL 中做到这一点？

**编辑** 使用 SUBSTRING 而不是 LEFT 有什么好处，反之亦然？

**编辑** 目前表中有大约 1700 条记录并且还在增长。

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2009-05-07T21:12:57.257

很抱歉这样做，但我现在确切地知道我需要做什么。

```
SELECT DISTINCT LEFT(name, 1) FROM mydatabase

```

这返回了列中每行开头的第一个不同的单个字符的列表。我添加了将其更改为以下内容，以使其按字母数字顺序排列：

```
SELECT DISTINCT LEFT(name, 1) as letter FROM mydatabase ORDER BY letter

```

奇迹般有效。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-07T21:09:56.297

听起来很简单：

```
select distinct substring(field,1,1) as char
from mytable 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-05-07T21:42:46.717

对于您当前的`1,700`行表，您的解决方案是可以的。

如果您将拥有类似`100,000`的行，则`DISTINCT`可能会变得低效。

这是我博客中的文章，展示了如何有效地做到这一点：

*   [**选择首字母**](http://explainextended.com/2009/05/08/selecting-first-letters/)

此解决方案使用 上的索引`name`。它将跳过索引键，最多选择每个第一个字母一次。

首先，您需要创建一个函数：

```
CREATE FUNCTION fn_get_next_code(initial INT) RETURNS INT
NOT DETERMINISTIC
READS SQL DATA
BEGIN
        DECLARE _next VARCHAR(200);
        DECLARE EXIT HANDLER FOR NOT FOUND RETURN NULL;
        SELECT  ORD(SUBSTRING(name, 1, 1))
        INTO    _next
        FROM    t_names
        WHERE   name >= CHAR(initial + 1)
        ORDER BY
                name
        LIMIT 1;
        RETURN _next;
END 
```

这个函数，给定一个起始字母的代码，返回表中给定值旁边的第一个起始字母。

其次，在查询中使用此函数：

```
SELECT  CHAR(@r) AS starting,
        @r := fn_get_next_letter(@r) AS next
FROM    (
        SELECT @r := ORD(LEFT(MIN(name), 1))
        ) vars, mytable
WHERE   @r IS NOT NULL 
```

在每次迭代中，会话变量`@r`将使用索引跳到下一个起始字母。

这将非常快，但只有当您拥有数十万行时它才会物有所值。

否则只需使用`DISTINCT`.

# java - OpenGL中的平滑线

> ID：837060
> 
> 赞同：1
> 
> 时间：2009-05-07T21:06:54.027
> 
> 标签：java, opengl, jogl

我正在尝试在 OpenGL 中绘制一条或多或少平滑的多段线。但是我发现如果线的厚度超过 3 左右，那么线段之间的连接就不是无缝的。他们之间有时会有差距。有没有一种使这些连接平滑无间隙的好方法？我正在寻找类似于 Java 中的 BasicStroke.JOIN_MITER 的东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-11T13:38:24.060

使用 OpenGL 绘制思维线的最一致和最便携的方法是使用相机对齐（也称为广告牌）多边形。OpenGL API 的不同实现以不同方式处理线的端点，并`GL_LINE_SMOOTH`根据平台产生截然不同的结果。一些实现认为厚度大于 1 的线定义不明确。如 glLineWidth 联机帮助页中所述：[对于消除锯齿线] 仅保证支持宽度 1；其他的取决于实施。

话虽如此，我已经使用了一个简单的 2 pass hack 来解决这个问题。

1.  禁用写入深度缓冲区 glDepthMask(GL_FALSE)
2.  绘制所需厚度的平滑线
3.  在所有线的端点处绘制相同大小的平滑点。（可能不需要此步骤来填补空白，但它应该使线条相交的点变圆并使一切看起来更平滑）
4.  重新启用深度缓冲区以写入 glDepthMask(GL_TRUE)

您可能还想尝试使用深度缓冲区设置。行之间的“间隙”可能是由于第二行未能对已与背景混合的 alpha 像素进行深度测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T21:12:03.203

根据 OpenGL 实现的质量，结果可能会有所不同。我注意到不同实现上的平滑线有很多差异。

您可能希望使用不同的策略来绘制线段，例如使用细多边形。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T21:16:10.477

使用 GL_LINE_SMOOTH 启用抗锯齿会稍微改变线条的绘制方式。你可以试试。另请注意，需要启用混合才能使其正常工作。

主要的是，您将无法控制使用细矩形绘制线条的各个方面可能会更好，并且在您编写自己的 DrawThickLine 函数之后，它将不再起作用......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-02-18T15:53:58.780

绘制四边形，并使用纹理或片段着色器进行点画。片段着色器也可以提供抗锯齿。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-07T21:09:42.163

在每一端过度绘制线的一半厚度。这应该消除“间隙”，尽管它会提供更清晰的线连接而不是更平滑的连接。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-07T21:51:54.167

要获得平滑的效果，您可能需要使用贝塞尔曲线或其他形式的样条曲线。我很惊讶这不是 OpenGL 内置的，但是该网站有一个[示例程序可以使用 OpenGL 生成 Bezier 曲线](http://www.opengl.org/resources/code/samples/redbook/bezcurve.c)。

# javascript - 如何从 JavaScript 检测 HTTP 状态

> ID：837064
> 
> 赞同：17
> 
> 时间：2009-05-07T21:08:35.300
> 
> 标签：javascript, http, dom

我想在一个脚本中检测，该脚本可以在我的控制之外部署，页面是否以 200、404 或 500 等的 HTTP 状态交付。

这不能做，对吧？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-18T08:39:29.497

让页面向自身发出 XMLHttpRequest（使用`location.href`or `document.URL`）并检查您获得的 HTTP 状态。对我来说似乎是一种非常便携的方式。为什么你会做这样的事情超出了我的理解；）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T21:24:35.857

页面 A 可以是通过 AJAX 加载页面 B 并使用 document.write 或在弹出窗口中或但是显示它的 Javascript。

在这样的策略中，您可以在 AJAX 处理程序中检查成功/失败的返回代码，并根据状态将不同的内容发送到输出窗口。

大多数 Ajax 库都提供了一种检查返回码的方法......

例如，在 Prototype.js 中使用 Ajax.Request 参见“transport.status”

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-05-07T21:27:10.560

为什么javascript需要知道这一点？听起来将其嵌入自定义 404 页面会更有意义。无需检测父页面的 HTTP 状态（我认为这不可能——可能在每次加载后对自身进行 ajax 调用，但这很愚蠢）。如果代码正在执行，它保证是 404

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-06-18T08:20:34.293

我最近发现了怎么做（学分：[hunlock](http://www.hunlock.com/blogs/AJAX_for_n00bs)）

AJAX.getAllResponseHeaders() -- 以字符串形式返回所有当前正在使用的标头。AJAX.getResponseHeader("headerLabel") -- 返回请求的标头的值。

# internet-explorer - 使用背景颜色打印网页

> ID：837065
> 
> 赞同：2
> 
> 时间：2009-05-07T21:08:38.373
> 
> 标签：internet-explorer, printing, webpage, background-color

我的网页上有一个 javascript 支持的“打印”按钮，用户可以在其中打印网页。

除了不打印各种元素的背景颜色外，这可以正常工作。

有没有一种打印网页的方法，可以打印各种元素的背景颜色？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-07T21:10:46.747

打印背景是浏览器设置，而不是您可以通过客户端脚本以编程方式控制的东西。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-05-07T21:15:59.637

即使可以，也不应该。浏览器默认在打印时忽略背景是有原因的——墨水很贵！

根据“背景”的[定义](http://answers.com/background)：相对不显眼或不重要的位置或区域。

不重要。推翻本地用户省钱的决定还不够重要。如果需要打印，它实际上并不是背景的一部分。

# c - 如何将内存数据库文件打开到 sqlite3

> ID：837067
> 
> 赞同：13
> 
> 时间：2009-05-07T21:09:34.003
> 
> 标签：c, sqlite, in-memory

我在一个无法访问磁盘的系统上。我的 C 程序在内存中有一个有效的、小的 sqlite3 文件（通过网络接收）的内容。我想使用 sqlite3 的 C API 来打开和访问这个文件（只读的很好）。

我该怎么做呢？我知道我可以创建一个空的内存数据库

`sqlite3_open(":memory:", &foo)`

但是有什么方法可以打开我现有的数据库吗？我没有创建 ram 磁盘的权限，但也许有类似的东西？谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-07T21:27:00.483

此处的代码示例（在 C 中）：

[http://www.mail-archive.com/sqlite-users@sqlite.org/msg15929.html](http://www.mail-archive.com/sqlite-users@sqlite.org/msg15929.html)

# c++ - 在 GCC 4.1.1 中优化文件中单个函数的方法是什么？

> ID：837070
> 
> 赞同：3
> 
> 时间：2009-05-07T21:09:51.070
> 
> 标签：c++, optimization, visual-c++, gcc, pragma

各种 C/C++ 编译器都有`#pragma`s 来控制优化。

例如：

**代码战士**

```
#pragma optimization_level 0
void func_no_opt()
{
    // Some Work - not optimized
}

#pragma optimization_level 3
void func_full_opt()
{
    // Some Work - optimized
} 
```

**MSVC**

```
#pragma optimize("g", off)
void func_no_opt()
{
    // Some Work - not optimized
}

#pragma optimize("g", on)
void func_full_opt()
{
    // Some Work - optimized
}

#pragma optimize("", on)
void func_default_opt()
{
    // Some Work - default optimizations
} 
```

纯粹出于性能原因，我有几个功能需要在所有构建中进行优化，包括在其他方面未优化的调试构建。

GCC（特别是 4.1.1）有没有办法做一些类似于这些其他编译器的事情？不幸的是，我的目标平台（专有硬件）不支持 GCC 4.4，所以我不能使用优化属性——即`__attribute__((optimize(...)))`.

此外，在此目标平台的工具链上，还有一个自动批量构建工具；因此也不可能只将函数拆分为单独的文件并更改优化参数，因为项目中的文件可以自动组合以提高编译和链接速度。我必须为这些函数创建一个单独的库，并链接它以执行拆分方法。这可能比它的价值要痛苦得多——尤其是如果有一种更简单的方法可以实现这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-07T21:34:42.057

看起来这`__attribute__((optimize(...)))`是在 GCC 中控制按功能优化的唯一方法。因此，使用 GCC 4.1.1 分离出一个单独的函数库进行优化确实是您唯一的选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-08T11:29:05.490

使用 GCC 4.4 及更高版本，您可以使用优化编译指示，详见 [http://gcc.gnu.org/onlinedocs/gcc/Function-Specific-Option-Pragmas.html#Function-Specific-Option-Pragmas](http://gcc.gnu.org/onlinedocs/gcc/Function-Specific-Option-Pragmas.html#Function-Specific-Option-Pragmas)

```
#pragma GCC push_options
#pragma GCC optimize ("-O0")
int foo() {
  return bar;
}
#pragma GCC pop_options 
```

# c++ - 错误 C1047：使用比其他对象更旧的编译器创建的对象文件

> ID：837073
> 
> 赞同：35
> 
> 时间：2009-05-07T21:10:43.347
> 
> 标签：c++, visual-studio-2008

我有一个项目，我在 Windows 7 上的 Visual Studio 2008 SP1 的发布模式下用 C++ 构建，当我构建它时，我不断得到：

> 致命错误 C1047：对象或库文件 '.\Release\foobar.obj' 是使用比其他对象更旧的编译器创建的；重建旧对象和库。

链接时发生错误。

我试过删除特定的目标文件并重建，但这并不能解决它。我也试过吹走整个发布构建文件夹并重建，但这也没有解决它。有任何想法吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-07-02T15:36:49.637

我遇到了这个问题，但我的解决方案不同：

对我来说，罪魁祸首是一个包含的外部库是用

```
/GL (=Enable link-time code generation under
      C/C++/ Optimization / Whole Program Optimization) 
```

使用较旧的视觉工作室（2005）。我在 2005 年在没有 /GL 的情况下重建了所述库，并且链接器错误在 2008 年消失了。正如 MSDN 所说，它与 /LTCG 设置有关，这是由 /GL 标志自动设置的：http: [//msdn.microsoft.com/ zh-CN/库/ms173554%28v=vs.80%29.aspx](http://msdn.microsoft.com/en-us/library/ms173554%28v=vs.80%29.aspx)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-10T00:33:46.997

我建议重新安装 VS 2008 SP1。您是否同时安装了不同的 VS（例如 VS Express）？众所周知，这会干扰现有的 VS 安装。

`cl.exe`您可以尝试通过运行并`link.exe`从 Visual Studio 命令提示符检查编译器和链接器版本。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2018-05-08T17:48:23.527

我能够通过以下步骤在 VS 2015 中解决此问题。

[1]（不确定是否有必要）关闭所有组件中的 /GL

> C/C++ > 优化 > 整个程序优化 > 否

在 .VCXPROJ 文件中，它是：

```
<WholeProgramOptimization>false</WholeProgramOptimization> 
```

关闭/LTCG

> 图书管理员 > 常规 > 链接时间码生成

```
<LinkTimeCodeGeneration>false</LinkTimeCodeGeneration> 
```

[2] 更重要的一步，确保所有组件都来自相同的目录。我的主要 EXE 正在使用：

```
Release Include
$(WindowsSdkDir)include\um;$(WindowsSdkDir)include\shared;$(UniversalCRT_IncludePath);$(VCInstallDir)include;$(VCInstallDir)atlmfc\include;$(WindowsSdkDir)include;$(FrameworkSDKDir)\include
Release Library
$(VC_LibraryPath_x86);$(WindowsSdk_71A_LibraryPath_x86); 
```

.lib 使用不同的目录（错误）：

```
Release Include
$(VC_IncludePath);$(WindowsSDK_IncludePath);
Release Library
$(VC_LibraryPath_x86);$(WindowsSDK_LibraryPath_x86);$(NETFXKitsDir)Lib\um\x86 
```

我把.lib目录改成和.exe一样，编译错误消失了。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-08-18T13:00:45.187

两种方式：

1.更新到Sp1来构建lib

2.请检查您的构建以确保禁用整个程序优化。对于静态库项目，进入属性页，将“配置属性->C/C++->优化->整个程序优化”更改为“否”。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-09-12T17:39:06.670

任何找到这个线程寻找答案的人......我也遇到了这个问题，但它不是 SP1 问题、重建问题或 PCH 问题......它最终成为一个使用更新版本构建的库的 VS 试图链接到旧 VS 上的项目。虽然这听起来很明显，但奇怪的是 VS2008 报告**说它编译**的一个对象是问题的原因，这让我大吃一惊......

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-10-28T20:39:45.800

也可能是有问题的库是使用不同的“平台工具集”设置构建的（在项目属性->常规中）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-02-03T09:33:05.710

我也遇到了同样的问题，我的 Visual Studio About 框报告说我安装了 SP1。显然这并不完全正确。对我具体出现此问题的调查揭示了资源编译器似乎是罪魁祸首。它碰巧是旧版本，导致上述错误消息。我安装的修补程序（Windows 更新）没有解决这个问题。也许我错过了一个关键的......

希望我们曾经体验过开发人员在他们生成的错误消息中真正传达真正问题的那一天。:-) '旧版本的编译器....' 来吧，伙计们，你可以做得更好 ;-)

不管怎样，这里是我用来解决这个问题的 VS2008 的最新 SP1 的下载链接。

[http://www.microsoft.com/downloads/en/confirmation.aspx?FamilyId=FBEE1648-7106-44A7-9649-6D9F6D58056E&displaylang=en](http://www.microsoft.com/downloads/en/confirmation.aspx?FamilyId=FBEE1648-7106-44A7-9649-6D9F6D58056E&displaylang=en)

快乐编码。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-11-08T09:14:25.523

我在这里尝试一切......我的错误成为一个糟糕的参考和重复的 GUID（在 2010 年和 2015 年项目之间......复制/过去项目的地狱）

在项目从 VS2008 迁移到 2010 和 2015 期间。我们保留所有项目版本 XXX.vxproj（适用于 VS2010）和 XXX_2015.vxproj（适用于 VS2015）。

在其中一个 2015 解决方案中，我们得到了 2010 项目的参考！

所以检查 REFERENCE... 并且永远不要重复 GUID。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-10-28T16:17:57.140

我有同样的问题，但是直接重新安装并没有解决它。我使用的是我在这里找到的版本

[https://www.dreamspark.com/Products/Product.aspx?ProductId=9](https://www.dreamspark.com/Products/Product.aspx?ProductId=9)

但是，在搜索论坛后，我发现安装 VS2008 SP1 Express 可以消除这个问题。. . .

[http://www.microsoft.com/downloads/en/details.aspx?displaylang=en&FamilyID=f3fbb04e-92c2-4701-b4ba-92e26e408569](http://www.microsoft.com/downloads/en/details.aspx?displaylang=en&FamilyID=f3fbb04e-92c2-4701-b4ba-92e26e408569)

您必须注意从哪个位置下载 VS2008，因为可以下载同一 Express 产品的不同版本。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-11-02T12:10:49.973

参考[MSDN](https://msdn.microsoft.com/en-us/library/ms173554(v=vs.80).aspx)，此错误 **对象或库文件“文件”是使用比其他对象更旧的编译器创建的；当使用 /LTCG 构建的对象文件或库链接在一起时，会导致重建旧的对象和库** ，但这些对象文件或库是使用不同版本的 Visual C++ 工具集构建的。
如果您开始使用新版本的编译器但没有对现有目标文件或库进行干净的重建，则可能会发生这种情况。
**要解决此问题，请重建所有目标文件或库。**

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-05-07T21:51:21.267

检查项目目录中某处是否有`.pch`（预编译头文件）文件并将其删除。然后重建项目。
获得干净构建的最佳方法是使用 Build->Clean 或 Build->Rebuild All

**编辑：**您可以尝试的另一件非常安全的事情是仅从源文件在新目录中重新创建项目文件。
如果可行，那么您可以逐步将旧项目与新项目进行比较，看看哪里出了问题。

# c# - LINQ to Entity 实体初始化

> ID：837075
> 
> 赞同：4
> 
> 时间：2009-05-07T21:10:46.840
> 
> 标签：c#, .net, asp.net-mvc, linq, linq-to-entities

在 ASP.Net MVC 教程中，LINQ to Entities 代码如下所示：

```
public class MyController : Controller
{
    private Models db;

    public ActionResult Index()
    {
        db = new Models();
        var foo = (from f in db.foo select f).ToList();
        return View(foo);
    }
} 
```

我猜这与线程安全/连接池有关，但我只是想知道是否有人知道不这样做的任何充分理由：

```
public class MyController : Controller
{
    private readonly Models db = new Models();

    public ActionResult Index()
    {
        var foo = (from f in db.foo select f).ToList();
        return View(foo);
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-07T23:41:41.143

我只是整理了一个包含很多细节的技巧。

您对线程的有根据的猜测只是为什么在需要它的方法中构造/处置 Context 通常更好的众多原因之一。

在某些情况下，这个经验法则不成立，但它们非常罕见。

请参阅：[技巧 18 - 如何决定 ObjectContext 的生命周期](http://blogs.msdn.com/alexj/archive/2009/05/07/tip-18-how-to-decide-on-a-lifetime-for-your-objectcontext.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T21:21:58.717

从我看到的代码示例中，您应该编写您要查找的代码，如下所示：

```
public class MyController : Controller{
    public ActionResult Index()
    {
        using (var db = new Models())
        {
            var foo = db.Foo.ToList();
            return View(foo);
        }
    }
} 
```

这里有两个主要变化。

1.  EF 模型是一个 IDisposable 对象，应妥善处理。如果你不这样做，它不会破坏你的应用程序（GC 稍后会清理它），但如果可以的话，最好尽早清理它。
2.  LINQ 中确实不需要 from/select 的东西，在这种情况下它什么也没做。

尽管您应该将您的应用程序架构作为一个整体来考虑，并考虑将您的数据访问抽象到您的控制器之外。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T21:23:57.620

将其保留在方法中可确保仅在需要时实例化数据库，并在需要时将其添加到连接池中。我什至会采取下一步并在 using 语句中实例化它。

```
public class MyController : Controller
{
    public ActionResult Index()
    {
        using (Models db = new Models())
        {
            var foo = (from f in db.foo select f).ToList();
            return View(foo);
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T21:16:47.280

第一个代码段不应该编译。您在不是构造函数的方法中分配只读字段。你确定这是一个MVC样本吗？

# .net - 错误记录：源错误和源文件

> ID：837076
> 
> 赞同：0
> 
> 时间：2009-05-07T21:11:56.043
> 
> 标签：.net, error-handling

在开发 .Net Web 应用程序时，如果生成运行时错误，它会显示一些我在 Exception 类中找不到的“额外”调试信息。

它显示了“源错误”部分，其中显示了代码摘录，其中行号显示了错误的确切生成位置，并显示了“源文件”，即引发异常的实际页面。

[![替代文字](https://i.stack.imgur.com/SsFRC.png)](https://i.stack.imgur.com/SsFRC.png)

能否以编程方式收集和记录这些信息？

仅供参考，我没有使用错误日志框架，该应用程序只是捕获 Global.asax.cs 文件中的错误并将异常的内容写入数据库表。也许这就是我要去错的地方。让我知道我是否需要采用一个框架来支持质量日志记录。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T21:19:26.447

你应该看看[ELMAH](https://elmah.github.io/)项目，它可以让你自动捕获和记录所有未处理的异常，包括记录黄屏死机。

对于每个错误，除了记录 YSOD 和堆栈跟踪之外，它还将记录服务器变量，以便您可以查看诸如 http 引用、请求的页面等信息。

它可以在各种数据库或 xml 文件中记录异常，并在记录异常时向您发送电子邮件。它可以集成到正在运行的 .Net Web 应用程序中，而无需更改一行代码，只需将条目添加到 web.config

您还可以以编程方式在日志中记录条目，以便在您想要捕获异常但仍将其记录下来时。

完整的详细信息在ELMAH 网站上，以及[Elmah.io](https://elmah.github.io/)网站[上的入门指南](http://blog.elmah.io/elmah-tutorial/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T21:13:44.867

引发错误的页面应该在 Exception.StackTrace 属性中

[http://msdn.microsoft.com/en-us/library/system.exception.stacktrace.aspx](http://msdn.microsoft.com/en-us/library/system.exception.stacktrace.aspx)

我不确定你提到的代码片段来自哪里。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T21:19:37.973

[ELMAH](http://code.google.com/p/elmah/)是一个非常酷的、插入式的、未处理的错误记录组件。它甚至可以让您查看黄屏死机（包括您所追求的信息）以及发布数据。

# benchmarking - 给定以下基准数据，我如何以秒为单位测量响应时间？

> ID：837082
> 
> 赞同：0
> 
> 时间：2009-05-07T21:13:32.340
> 
> 标签：benchmarking

我们最近从软件供应商那里得到了一些关于基准测试的数据，我认为我遗漏了一些明显的东西。

如果每秒有 17 个事务（我假设它们的意思是成功完成的请求），并且这些请求中的 1500 个可以在 5 分钟内处理，那么我如何获得单个用户的响应时间？这种事情甚至可以通过基准测试来实现吗？我从他们那里得到了很多其他数据，包括 apache 配置设置，但我不确定如何进行所有数学运算。

鉴于他们发送的服务器设置，我想知道如何推断用户响应时间。我查看了其他类似的基准测试，但我无法测量响应时间的请求。我需要在此处提供哪些其他数据才能获得此信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T21:28:32.837

如果每 5 分钟只能处理其中的 1500 个事务，则： 1500 / 5 = 每分钟可以处理 300 个事务 300 / 60 = 每秒可以处理 5 个事务

那么他们如何获得每秒 17 个已完成的交易呢？上次我检查 5 < 17 ！

这似乎不适合。还是我看错了？

我假设是用户响应时间，您的意思是为单个事务提供服务所需的时间：

如果他们每秒可以服务 5 次，则每笔交易需要 200 毫秒 (1/5) 如果他们每秒可以服务 17 次，则每笔交易需要 59 毫秒 (1/17)

这就是我们可以从给定的数据中看出的全部内容。也许澄清每秒有多少事务正在完成。

# c# - C# - 将大文件加载到 WPF RichTextBox 中？

> ID：837086
> 
> 赞同：7
> 
> 时间：2009-05-07T21:15:20.137
> 
> 标签：c#, wpf, richtextbox

我需要将 10MB 范围的文本文件加载到 WPF RichTextBox 中，但我当前的代码正在冻结 UI。我尝试让后台工作人员进行加载，但这似乎也不太好用。

这是我的加载代码。有什么方法可以提高它的性能吗？谢谢。

```
 //works well for small files only
    private void LoadTextDocument(string fileName, RichTextBox rtb)
    {
        System.IO.StreamReader objReader = new StreamReader(fileName);

        if (File.Exists(fileName))
        {
                rtb.AppendText(objReader.ReadToEnd());
        }
        else rtb.AppendText("ERROR: File not found!");
        objReader.Close();
    }

    //background worker version. doesnt work well
    private void LoadBigTextDocument(object sender, DoWorkEventArgs e)
    {
        BackgroundWorker worker = sender as BackgroundWorker;
        System.IO.StreamReader objReader = new StreamReader(   ((string[])e.Argument)[0]  );
        StringBuilder sB = new StringBuilder("For performance reasons, only the first 1500 lines are displayed. If you need to view the entire output, use an external program.\n", 5000);

            int bigcount = 0;
            int count = 1;
            while (objReader.Peek() > -1)
            {
                sB.Append(objReader.ReadLine()).Append("\n");
                count++;
                if (count % 100 == 0 && bigcount < 15)
                {
                    worker.ReportProgress(bigcount, sB.ToString());

                    bigcount++;
                    sB.Length = 0;
                }
            }
        objReader.Close();
        e.Result = "Done";
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-05-28T06:32:54.983

WPF RichTextBox 控件使用流文档显示富文本，然后将流文档附加到 RTB 控件，而 Windows 窗体 RichTextBox 控件直接显示富文本。这就是 WPF RTB 超级慢的原因。如果您可以使用 WinForm RTB，只需将其托管在您的 wpf 应用程序中即可。xml：

```
<Window x:Class="WpfHostWfRTB.MainWindow"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:wf="clr-namespace:System.Windows.Forms;assembly=System.Windows.Forms"
Title="MainWindow" Height="350" Width="525" Loaded="Window_Loaded">
<Grid>
    <Grid>
        <WindowsFormsHost Background="DarkGray" Grid.row="0" Grid.column="0">
            <wf:RichTextBox x:Name="rtb"/>
        </WindowsFormsHost>
    </Grid>
</Grid>
</Window> 
```

C# 代码

```
private void LoadTextDocument(string fileName, RichTextBox rtb)
{
    System.IO.StreamReader objReader = new StreamReader(fileName);
        if (File.Exists(fileName))
        {
            rtb.AppendText(objReader.ReadToEnd());
        }
        else rtb.AppendText("ERROR: File not found!");
        objReader.Close();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-26T21:38:02.577

我正在做一个非常相似的项目。

该项目需要加载一个大文本文件（最大大小约为：120MB，但我们想要更大），然后在树中构建文本文件的轮廓。单击树中的节点会将用户滚动到文本文件的该部分。

在与很多人交谈后，我认为最好的解决方案是创建一种“滑动窗口”查看器，在该查看器中，您一次只将用户可以看到的文本加载到 rtb.Text 中。

所以..说将整个文件加载到一个列表中，但只将其中的 100 行放入 rtb.Text。如果用户向上滚动删除底线并在顶部添加一行文本。如果他们向下滚动删除顶行并在底部添加一行文本。我用这个解决方案获得了相当不错的性能。（加载 120MB 文件需要 50 秒）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-07T21:30:14.297

图形控件并非旨在处理此类数据，仅仅是因为它会变得不可用。即使控件可以处理大字符串，但与整个文本相比，控件中可见的内容太少了，以至于滚动条实际上​​变得毫无用处。要找到文本中的特定行，您必须将滑块移动到它可以指定的最近位置，然后一次滚动一行几分钟...

与其将您的用户提交给这样无用的东西，您应该重新考虑如何显示数据，以便您可以以一种实际上可以使用的方式进行操作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-12T15:01:49.223

我注意到使用 RichTextboxes 时，当您添加更多“行”时，它开始变慢。如果您可以在不附加 '\n' 的情况下执行此操作，它将为您加快速度。请记住，每个 '\n' 都是 RichTextbox 的新段落对象块。

这是我加载 10 MB 文件的方法。加载大约需要 30 秒。我使用进度条对话框让我的用户知道加载需要时间。

```
// Get Stream of the file
fileReader = new StreamReader(File.Open(this.FileName, FileMode.Open));

FileInfo fileInfo = new FileInfo(this.FileName);

long bytesRead = 0;

// Change the 75 for performance.  Find a number that suits your application best
int bufferLength = 1024 * 75;

while (!fileReader.EndOfStream)
{
    double completePercent = ((double)bytesRead / (double)fileInfo.Length);

    // I am using my own Progress Bar Dialog I left in here to show an example
    this.ProgressBar.UpdateProgressBar(completePercent);

    int readLength = bufferLength;

    if ((fileInfo.Length - bytesRead) < readLength)
    {
        // There is less in the file than the lenght I am going to read so change it to the 
        // smaller value
        readLength = (int)(fileInfo.Length - bytesRead);
    }

    char[] buffer = new char[readLength];

    // GEt the next chunk of the file
    bytesRead += (long)(fileReader.Read(buffer, 0, readLength));

    // This will help the file load much faster
    string currentLine = new string(buffer).Replace("\n", string.Empty);

    // Load in background
    this.Dispatcher.BeginInvoke(new Action(() =>
        {
            TextRange range = new TextRange(textBox.Document.ContentEnd, textBox.Document.ContentEnd);
            range.Text = currentLine;

        }), DispatcherPriority.Normal);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-07T21:17:46.933

为什么不添加到字符串变量（或者甚至使用 StringBuilder），然后在完成解析后将值分配给 .Text 属性？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-06-29T01:37:50.233

你可以试试这个它对我有用。

```
private void backgroundWorker1_DoWork(object sender, DoWorkEventArgs e)
{
    // Create new StreamReader
    StreamReader sr = new StreamReader(openFileDialog1.FileName, Encoding.Default);
    // Get all text from the file
    string str = sr.ReadToEnd();
    // Close the StreamReader
    sr.Close();

    // Show the text in the rich textbox rtbMain
    backgroundWorker1.ReportProgress(1, str);
}

private void backgroundWorker1_ProgressChanged(object sender, ProgressChangedEventArgs e)
{
    // richTextBox1.Text = e.ProgressPercentage.ToString() + " " + e.UserState.ToString();
    richTextBox1.Text = e.UserState.ToString();
} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-05-07T21:27:40.433

您是否考虑过尝试使应用程序多线程？

您需要一次查看多少文本文件？您可能想研究 .NET 或 C# 中的延迟加载

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2013-10-24T10:13:46.913

我没有提高加载的性能，但我用它来异步加载我的richtextbox。我希望这可以帮助你。

XAML：

```
<RichTextBox Helpers:RichTextBoxHelper.BindableSource="{Binding PathFileName}" /> 
```

帮手：

```
public class RichTextBoxHelper
{
private static readonly ILog m_Logger = LogManager.GetLogger(MethodBase.GetCurrentMethod().DeclaringType);

public static readonly DependencyProperty BindableSourceProperty =
    DependencyProperty.RegisterAttached("BindableSource", typeof(string), typeof(RichTextBoxHelper), new UIPropertyMetadata(null, BindableSourcePropertyChanged));

public static string GetBindableSource(DependencyObject obj)
{
  return (string)obj.GetValue(BindableSourceProperty);
}

public static void SetBindableSource(DependencyObject obj, string value)
{
  obj.SetValue(BindableSourceProperty, value);
}

public static void BindableSourcePropertyChanged(DependencyObject o, DependencyPropertyChangedEventArgs e)
{
  var thread = new Thread(
    () =>
    {
      try
      {
        var rtfBox = o as RichTextBox;
        var filename = e.NewValue as string;
        if (rtfBox != null && !string.IsNullOrEmpty(filename))
        {
          System.Windows.Application.Current.Dispatcher.Invoke(
            System.Windows.Threading.DispatcherPriority.Background,
            (Action)delegate()
            {
              rtfBox.Selection.Load(new FileStream(filename, FileMode.Open), DataFormats.Rtf);
            });
        }
      }
      catch (Exception exception)
      {
        m_Logger.Error("RichTextBoxHelper ERROR : " + exception.Message, exception);
      }
    });
  thread.Start();
}
} 
```

# c++ - 静态初始化的问题

> ID：837088
> 
> 赞同：0
> 
> 时间：2009-05-07T21:15:33.007
> 
> 标签：c++, visual-c++

我在静态初始化方面遇到了一些奇怪的问题。我正在使用代码生成器为我编写的消息传递系统生成结构和序列化代码。为了有一种基于消息 ID 轻松分配消息的方法，我的代码生成器为每种消息类型输出类似于以下内容的内容：

```
MessageAllocator s_InputPushUserControllerMessageAlloc(INPUT_PUSH_USER_CONTROLLER_MESSAGE_ID, (AllocateMessageFunc)Create_InputPushUserControllerMessage); 
```

MessageAllocator 类基本上如下所示：

```
MessageAllocator::MessageAllocator( uint32_t messageTypeID, AllocateMessageFunc func )
{
    if (!s_map) s_map = new std::map<uint32_t, AllocateMessageFunc>();
    if (s_map->insert(std::make_pair(messageTypeID, func)).second == false)
    {
        //duplicate key!
        ASSERT(false, L"Nooooo!");
    }
    s_count++;
}

MessageAllocator::~MessageAllocator()
{
    s_count--;
    if (s_count == 0) delete s_map;
} 
```

其中 s `_`map 和 s `_`count 是 MessageAllocator 的静态成员。这在大多数情况下都有效，但有时消息不会添加到地图中。例如，除非我`_`在启动代码中的某处调用 Create InputPushUserControllerMessage()，否则不会添加此特定消息，但是其他消息工作正常。我认为这可能与链接器错误地认为类型未引用并删除它有关，因此我使用 /OPT:NOREF 开关（我使用的是 Visual Studio 2008 SP1）禁用了它，但这没有效果。

我知道“静态初始化顺序惨败”的问题，但据我所知，创建这些对象的顺序不应该改变结果，所以这对我来说似乎没问题。

这里的任何见解将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T23:58:24.723

将静态放入类中，使其成为类的静态成员

```
struct InputPushUserControllerMessageAlloc { static MessageAllocator s_obj; };

MessageAllocator InputPushUserControllerMessageAlloc::s_obj(
    INPUT_PUSH_USER_CONTROLLER_MESSAGE_ID, 
    (AllocateMessageFunc)Create_InputPushUserControllerMessage); 
```

该标准允许它延迟初始化具有命名空间范围的对象，直到使用其翻译单元中的任何函数/对象。如果初始化有副作用，则无法优化。但这并不禁止延迟它。

具有类范围的对象并非如此。所以这可能会禁止它在那里优化一些东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T22:24:37.257

我会将 s_map 从静态类成员更改为静态方法成员：

```
std::map<uint32_t,AllocateMessageFunc>& MessageAllocator::getMap()
{
    // Initialized on first use and destroyed correctly on program termination.
    static std::map<uint32_t,AllocateMessageFunc>   s_map;

    return s_map;
}
MessageAllocator::MessageAllocator( uint32_t messageTypeID, AllocateMessageFunc func )
{
    if (getMap().insert(std::make_pair(messageTypeID, func)).second == false)
    {
         //duplicate key!
         ASSERT(false, L"Nooooo!");
    }
} 
```

不需要析构函数或计数。

如果您的全局对象位于延迟加载的单独 DLL（或共享库）中。这可能会导致与您的描述类似的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T22:25:16.490

您没有将指针设置回空值。

```
MessageAllocator::~MessageAllocator()
{
    s_count--;
    if (s_count == 0) 
    {
          delete s_map;
          s_map = 0;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-11T03:02:32.477

结果发现链接器没有包含包含静态初始化程序的目标文件，因为没有任何内容引用其中的任何函数。为了解决这个问题，我对生成的函数之一进行外部“C”编辑，以便它具有可预测的非损坏名称，然后对每条消息使用这样的编译指示强制引用它

```
#pragma comment(linker, "/include:Create_GraphicsDynamicMeshCreationMessage") 
```

我将其放入生成的头文件中，该头文件随后包含在所有其他非生成文件中。它只是 MSVC 和一种 hack，但我认为一旦我最终移植它，我可以在 GCC 上做类似的事情。

# powershell - 为什么Powershell的“return”关键字会导致类型错误？

> ID：837095
> 
> 赞同：4
> 
> 时间：2009-05-07T21:17:08.823
> 
> 标签：powershell

```
$xml = [xml] '<node>foo</node>'
function foo2 { return "foo2" }

# all of these fail with the message:
# **Cannot set "foo" because only strings can be used as values to set XmlNode properties.**
$xml.node = foo2
$xml.node = foo2 -as [string]  # because of this issue[1]
$xml.node = (foo2)  

# these work
$xml.node = (foo2).tostring()
$xml.node = (foo2) -as [string]
$xml.node = [string] (foo2)

# yet, these two statements return the same value
(foo2).gettype()
(foo2).tostring().gettype() 
```

1：[PowerShell 函数返回行为](https://stackoverflow.com/questions/149191/powershell-functions-return-behavior)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-09-11T16:13:24.437

PowerShell 团队对此进行了一些确认。这似乎是 XML 适配器中的一个错误。如果您在调试器中查看由 foo2 吐出的对象，则它是一个 PSObject。如果您不使用 return 关键字而只输出字符串“foo2”，则该函数将返回一个字符串对象。

XML 适配器中的错误是它没有打开 PSObject 以获取基础对象。因此，当它尝试将 PSObject 分配给 $xml.node 时，它​​会失败。现在，作为一种解决方法，您可以像这样手动解开 psobject（或者只是强制转换为 [string]）：

```
$xml = [xml] '<node>foo</node>'
function foo2 { return "foo2" }
$xml.node = (foo2).psobject.baseobject
$xml

node
----
foo2 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T22:25:38.720

根据上下文，函数可能会返回一个数组（长度为 1），其中您的预期结果位于数组中的索引 0 处。为确保在返回包含在数组中的单个元素时始终获得标量，请使用以下语法：

```
$xml.node = $( myfunc ) 
```

希望这可以帮助，

-Oisin

ps 我知道其他人不能复制这个，我也不能，但我怀疑你的演示代码是从其他一些更大的脚本中删除的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-07T20:07:31.627

根据[这篇文章](http://keithhill.spaces.live.com/Blog/cns!5A8D2641E0963A97!811.entry)，我假设编译器认为它不知道 foo2 的输出类型足以接受它，尽管它“显然”它总是一个字符串我假设有一些代码路径能够添加一些东西更多的是从未行使过的输出......

更新：基思希尔的答案是正确的，不是这个

# silverlight - Sivlerlight Spy 无法加载“System.Windows.Controls.ChildWindow”

> ID：837104
> 
> 赞同：0
> 
> 时间：2009-05-07T21:20:14.680
> 
> 标签：silverlight, spy

我目前正在试用 Silverlight Spy ( [http://silverlightspy.com](http://silverlightspy.com) )，但是当我使用 ChildWindow 控件时它显示一个奇怪的错误。

只有当我在 Silverlight Spy 中打开我的 Silverlight 应用程序时，才会出现此错误。

我正在使用 Silverlight 3 Beta。

我已经为那些想要检查的人上传了一个重现错误的项目：http: [//cid-095521bcc7670693.skydrive.live.com/self.aspx/Public/Code/SilverlightSpyTest.zip](http://cid-095521bcc7670693.skydrive.live.com/self.aspx/Public/Code/SilverlightSpyTest.zip)

谢谢！

以下是错误消息： [警告] 第 1 行发生脚本错误：Silverlight 应用程序中的未处理错误无法从程序集“System.Windows.Controls，版本=2.0.5.0，文化”加载类型“System.Windows.Controls.ChildWindow” =中性，PublicKeyToken=31bf3856ad364e35'。在 SilverlightSpyTest.MainPage.myButton_Click（对象发送者，RoutedEventArgs e）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-08T16:26:58.097

我已联系 Silverlight Spy 的所有者，这是一个已知问题。这将在他们的下一个版本中修复。

# ruby - 将目录添加到 $LOAD_PATH (Ruby)

> ID：837123
> 
> 赞同：100
> 
> 时间：2009-05-07T21:26:51.047
> 
> 标签：ruby, rubygems, load-path

我已经看到了两种常用的技术，用于将当前正在执行的文件的目录添加到 $LOAD_PATH（或 $:)。如果您不使用 gem，我会看到这样做的好处。显然，一个似乎比另一个更冗长，但是有理由选择一个而不是另一个吗？

第一种，冗长的方法（可能是矫枉过正）：

```
$LOAD_PATH.unshift(File.expand_path(File.dirname(__FILE__))) unless $LOAD_PATH.include?(File.expand_path(File.dirname(__FILE__))) 
```

和更直接，快速和肮脏的：

```
$:.unshift File.dirname(__FILE__) 
```

有什么理由选择一个而不是另一个？

* * *

## 回答 #1

> 赞同：156
> 
> 时间：2009-09-21T21:01:50.273

Ruby 加载路径通常写成 $: ，但仅仅因为它很短，并不能使它变得更好。如果你更喜欢清晰而不是聪明，或者如果简洁本身就让你发痒，那么你不需要仅仅因为其他人都这样做。打招呼 ...

```
$LOAD_PATH 
```

……和……说再见

```
# I don't quite understand what this is doing...
$: 
```

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2009-05-07T23:44:19.890

我会说选择`$:.unshift File.dirname(__FILE__)`另一个，只是因为我在代码中看到它的使用比`$LOAD_PATH`另一个要多得多，而且它也更短！

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2009-07-11T03:26:14.753

我不太喜欢“快速而肮脏”的方式。任何刚接触 Ruby 的人都会思考它是什么`$:.`。

我觉得这更明显。

```
libdir = File.dirname(__FILE__)
$LOAD_PATH.unshift(libdir) unless $LOAD_PATH.include?(libdir) 
```

或者，如果我关心拥有完整路径...

```
libdir = File.expand_path(File.dirname(__FILE__))
$LOAD_PATH.unshift(libdir) unless $LOAD_PATH.include?(libdir) 
```

**更新**2009/09/10

最近我一直在做以下事情：

```
$:.unshift(File.expand_path(File.dirname(__FILE__))) unless
    $:.include?(File.dirname(__FILE__)) || $:.include?(File.expand_path(File.dirname(__FILE__))) 
```

在浏览 GitHub 时，我在一大堆不同的 ruby​​ 项目中看到了它。

好像是约定？

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-12-06T19:41:37.087

如果您输入`script/console`Rails 项目并输入`$:`，您将获得一个数组，其中包含加载 Ruby 所需的所有目录。这个小练习的要点是这`$:`是一个数组。既然如此，您可以在其上执行功能，例如在其他目录中添加`unshift`方法或`<<`运算符。正如你在你的陈述中暗示的那样`$:`，`$LOAD_PATH`都是一样的。

正如您提到的那样以快速而肮脏的方式执行此操作的缺点是：如果您的引导路径中已经有该目录，它将重复自己。

例子：

我创建了一个名为 todo 的插件。我的目录结构如下：

```
/ - -小贩
  |
  |---/插件
        |
        |---/待办事项
              |
              |---/库
                    |
                    |---/应用
                          |
                          |---/型号
                          |---/控制器
              |
              |---/导轨
                    |
                    |---init.rb

```

在 init.rb 文件中，我输入了以下代码：

```
## In vendor/plugins/todo/rails/init.rb
    %w{ models controllers models }.each do |dir|
      path = File.expand_path(File.join(File.dirname(__FILE__), '../lib', 'app', dir))
      $LOAD_PATH << path
      ActiveSupport::Dependencies.load_paths << path
      ActiveSupport::Dependencies.load_once_paths.delete(path)
    end 
```

请注意我如何告诉代码块对字符串“models”、“controllers”和“models”执行块内的操作，在此处重复“models”。（仅供参考，`%w{ ... }`这只是告诉 Ruby 保存字符串数组的另一种方式）。当我运行时`script/console`，我输入以下内容：

```
>> puts $: 
```

我输入这个是为了更容易阅读字符串中的内容。我得到的输出是：

```
...
...
./Users/Me/mySites/myRailsApp/vendor/plugins/todo/lib/app/models
./Users/Me/mySites/myRailsApp/vendor/plugins/todo/lib/app/controllers
./Users/Me/mySites/myRailsApp/vendor/plugins/todo/lib/app/models

```

如您所见，虽然这是我在使用我目前正在处理的项目时可以创建的一个简单示例，但如果您不小心，快速而肮脏的方式将导致重复路径。更长的方法将检查重复的路径并确保它们不会发生。

如果您是一位经验丰富的 Rails 程序员，您可能非常清楚自己在做什么，并且可能不会犯重复路径的错误。如果您是新手，我会走更长的路，直到您真正了解自己在做什么。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2015-11-05T04:09:51.590

最好我在使用 Rspec 时通过相对路径添加目录。我发现它足够冗长，但仍然是一个不错的衬里。

```
$LOAD_PATH.unshift(File.join(File.dirname(__FILE__), '..', 'lib')) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-09-26T01:11:21.443

有一个 gem 可以让你用更好更干净的代码设置你的加载路径。看看这个：[https](https://github.com/nayyara-samuel/load-path) ://github.com/nayyara-samuel/load-path 。

它也有很好的文档

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2018-10-24T19:12:19.963

我知道自从第一次提出这个问题以来已经有很长时间了，但我还有一个额外的答案想要分享。

我有几个 Ruby 应用程序是由另一位程序员在几年内开发的，它们在不同的应用程序中重复使用相同的类，尽管它们可能访问同一个数据库。由于这违反了 DRY 规则，我决定创建一个类库以供所有 Ruby 应用程序共享。我本可以将它放在主 Ruby 库中，但这会将自定义代码隐藏在我不想做的公共代码库中。

我遇到了一个问题，我在已经定义的名称“profile.rb”和我正在使用的类之间存在名称冲突。在我尝试创建公共代码库之前，这种冲突不是问题。通常，Ruby 首先搜索应用程序位置，然后转到 $LOAD_PATH 位置。

application_controller.rb 找不到我创建的类，并在原始定义上抛出错误，因为它不是类。由于我从应用程序的 app/models 部分中删除了类定义，Ruby 无法在那里找到它，并在 Ruby 路径中寻找它。

因此，我修改了 $LOAD_PATH 变量以包含我正在使用的库目录的路径。这可以在初始化时在 environment.rb 文件中完成。

即使将新目录添加到搜索路径中，Ruby 也会抛出错误，因为它优先获取系统定义的文件。$LOAD_PATH 变量中的搜索路径优先搜索 Ruby 路径。

因此，我需要更改搜索顺序，以便 Ruby 在搜索内置库之前在我的公共库中找到该类。

这段代码是在 environment.rb 文件中完成的：

```
Rails::Initializer.run do |config|

* * * * *

path = []
path.concat($LOAD_PATH)
$LOAD_PATH.clear
$LOAD_PATH << 'C:\web\common\lib'
$LOAD_PATH << 'C:\web\common'
$LOAD_PATH.concat(path)

* * * * *

end 
```

我不认为您可以在此级别使用之前给出的任何高级编码结构，但如果您想在应用程序的初始化时设置一些东西，它就可以正常工作。在将原始 $LOAD_PATH 变量添加回新变量时，您必须保持其原始顺序，否则一些主要的 Ruby 类会丢失。

在 application_controller.rb 文件中，我只使用了一个

```
require 'profile'
require 'etc' #etc 
```

这会加载整个应用程序的自定义库文件，也就是说，我不必在每个控制器中都使用 require 命令。

对我来说，这是我正在寻找的解决方案，我想我会将它添加到这个答案中以传递信息。

# java - 将支持 bean 实例作为参数传递给另一个支持 bean 方法

> ID：837128
> 
> 赞同：0
> 
> 时间：2009-05-07T21:28:26.237
> 
> 标签：java, jsf, parameters, javabeans

在用户通过表单用信息填充我的支持 bean 之后，我想在 Java 代码中处理实例（例如 JAXB 编组）。

所以目前我正在这样做：

```
<% OtherBean.method(myBackingBean); %> 
```

这是 - 如果我是对的 - 不是一个最新的解决方案:) 那么我怎样才能以“更好”的方式实现这一点？

在此先感谢，丹尼尔。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T22:52:32.867

一种解决方案是向 bean 添加一个操作方法 - 可以让它自己处理。

例如，这个简单的 bean：

```
public class SimpleBean {

  private String forename;
  private String surname;

  public String processData() {
    // TODO: real work
    System.out.println("forename=" + forename);
    System.out.println("surname=" + surname);
    return null; // optional navigation rule
  }

  public String getForename() {
    return forename;
  }

  public void setForename(String forename) {
    this.forename = forename;
  }

  public String getSurname() {
    return surname;
  }

  public void setSurname(String surname) {
    this.surname = surname;
  }

} 
```

...在 WEB-INF/faces-config.xml 中定义：

```
<managed-bean>
    <managed-bean-name>simpleBean</managed-bean-name>
    <managed-bean-class>simplebean.SimpleBean</managed-bean-class>
    <managed-bean-scope>session</managed-bean-scope>
</managed-bean> 
```

...可以使用此 JSP 进行处理：

```
<?xml version="1.0" encoding="UTF-8" ?>
<jsp:root xmlns:jsp="http://java.sun.com/JSP/Page" version="2.0"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:f="http://java.sun.com/jsf/core">
  <jsp:directive.page language="java"
    contentType="text/html; charset=UTF-8" pageEncoding="UTF-8" />
  <jsp:text>
    <![CDATA[<?xml version="1.0" encoding="UTF-8" ?>]]>
  </jsp:text>
  <jsp:text>
    <![CDATA[<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">]]>
  </jsp:text>
  <html xmlns="http://www.w3.org/1999/xhtml">
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>Enter Name</title>
  </head>
  <body>
  <f:view>
    <h:form>
      <h:panelGrid columns="2">
        <h:outputText value="forename:" />
        <h:inputText id="it1" value="#{simpleBean.forename}" />
        <h:outputText value="surname:" />
        <h:inputText id="it2" value="#{simpleBean.surname}" />
      </h:panelGrid>
      <h:commandButton action="#{simpleBean.processData}"
        value="process" />
    </h:form>
  </f:view>
  </body>
  </html>
</jsp:root> 
```

注意方法绑定#{simpleBean.processData}。这必须是一个不带参数并返回 String 参数的公共方法（如果需要，可用于页面导航）。

这不是解决此问题的唯一方法，但它相当简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T21:47:00.047

您可以将一个支持 bean 作为另一个 bean 的实例变量。并在 spring 或任何你使用的东西中配置它。

# web-config - 在 asp.net 中创建自定义 .config 文件

> ID：837133
> 
> 赞同：11
> 
> 时间：2009-05-07T21:29:45.703
> 
> 标签：web-config

有没有办法可以在 asp.net 中创建一个 blah.config 文件，并以与访问常规 web.config 文件中的项目相同的方式访问节点的名称/值对？

（想法是不必为此编写任何自定义代码）。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-08T05:27:08.503

Chris 展示了一种“外部化”部分配置的方法。这适用于某些场景。如果您需要更多，则需要更深入地挖掘。

为此，您绝对应该在 CodeProject 上查看 Jon Rista 关于 .NET 2.0 配置的三部分系列。

*   [揭开 .NET 2.0 配置的奥秘](http://www.codeproject.com/KB/dotnet/mysteriesofconfiguration.aspx)
*   [解读 .NET 2.0 配置的奥秘](http://www.codeproject.com/KB/dotnet/mysteriesofconfiguration2.aspx)
*   [破解 .NET 2.0 配置的奥秘](http://www.codeproject.com/KB/dotnet/mysteriesofconfiguration3.aspx)

强烈推荐，写得很好，非常有帮助！他展示了如何创建和使用自定义配置部分，并继续解释如何使用您自己的部分`blah.config`来代替标准 .NET 配置文件或在标准 .NET 配置文件之外使用。

马克

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-07T21:40:12.650

使用 appSettings 块的“文件”属性，如下所示：

```
<appSettings file="user.config">
    <add key="Test1" value="Generic1" />
    <add key="Test2" value="Generic2" />
</appSettings> 
```

[可在此处](http://diablopup.blogspot.com/2007/07/file-attribute-in-webconfig.html)获得进一步的解释。

# c# - 为什么 C#/CLR 不支持方法覆盖协/逆变？

> ID：837134
> 
> 赞同：13
> 
> 时间：2009-05-07T21:29:57.700
> 
> 标签：c#, .net, clr, overriding, covariance

有很多关于破解 C# 的限制的问题和答案，不允许方法返回（和参数）类型在覆盖时更改为兼容类型，但*为什么*在 C# 编译器或 CLR 中存在此限制？如我所见，如果允许协方差，没有什么可以破坏的，那么它背后的原因是什么？

可以询问类似的问题来扩大访问参数 - 例如用公共方法覆盖受保护的内部方法（Java支持的东西，IIRC）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T21:41:01.103

Eric Lippert 已经比我更好地回答了这个问题。

查看他关于[C# 中的协变和逆变的系列文章](http://blogs.msdn.com/ericlippert/archive/2007/10/16/covariance-and-contravariance-in-c-part-one.aspx)

和

[C# 4.0 Generic Covariance & Contra-variance 是如何实现的？](https://stackoverflow.com/questions/245607/how-does-c-40-generic-covariance-contra-variance-implmeneted)

编辑：埃里克指出他没有谈论返回类型的协变，但我决定在这个答案中保留链接，因为这是一个很酷的系列文章，如果查找这个主题，有人可能会发现它很有用。

此功能已被[请求](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=90909)，大约 5 年前，Microsoft 已回复“感谢您记录此功能。我们经常听到此请求。我们将在下一个版本中考虑它。”

现在我将引用 Jon Skeet，因为如果没有 Jon Skeet 的回答，它就不是 StackOverflow 上的正确答案。[协方差和 void 返回类型](http://msmvps.com/blogs/jon_skeet/archive/2007/12/13/covariance-and-void-return-types.aspx)

> 我强烈怀疑答案在于 CLR 的实现，而不是任何深层的语义原因 - CLR 可能需要知道是否会有返回值，以便对堆栈执行适当的操作。即便如此，就优雅而言，这似乎有点可惜。我不能说我在现实生活中曾经觉得需要这样做，而且只需编写一个从`Func<X>`to 到 to等的转换器`Action<X>`，在 .NET 3.5 中伪造（最多四个参数）是相当容易的。它很琐碎虽然有点:)`Func<X,Y>``Action<X,Y>`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-07-05T14:08:42.520

这个答案不是在谈论 C#，但它帮助我更好地理解了这些问题，也许它会帮助其他人：[为什么没有用于覆盖的参数逆变？](https://stackoverflow.com/q/2995926/367464)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-13T05:20:58.860

引入返回值协方差的 Seams 没有 Java 和 C++ 使用过的本质缺陷。然而，引入形式参数的逆变会引起真正的混乱。我认为 C++ 中的这个答案[https://stackoverflow.com/a/3010614/1443505](https://stackoverflow.com/a/3010614/1443505)也适用于 C#。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-07T21:30:48.307

确实如此，您只需要等待 VS2010/.Net 4.0。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-07T21:40:36.597

为了扩展 Joel 的答案 - CLR 长期以来一直支持有限的变化，但 C# 编译器直到 4.0 才使用它们，并在通用接口和委托上使用新的“in”和“out”修饰符。原因很复杂，我会陷入混乱试图解释，但这并不像看起来那么简单。

将“受保护的内部”方法重新制作为“公共”方法；你可以通过隐藏方法来做到这一点：

```
public new void Foo(...) { base.Foo(...); } 
```

（只要论点等都是公开的） - 有什么用吗？

# c# - C# 简单的开源应用程序

> ID：837141
> 
> 赞同：5
> 
> 时间：2009-05-07T21:31:12.890
> 
> 标签：c#, open-source

C#简单的开源桌面应用可以借鉴吗？

我正在尝试学习 C#，但大多数时候我发现非程序员的教程很无聊，或者与其他语言比较。

我试图编译一个看起来足够漂亮以引起我注意并且足够简单（乍一看）以使我理解的应用程序，但事实证明它[是用 Mono 开发的](https://stackoverflow.com/questions/836767/using-mono-on-windows)。

我以前下载过 VS for C# express edition，但不知道下一步该做什么。

所以我的问题是：

有人知道我可以学习的用 C# 开发的简单开源 Windows 应用程序吗？

它不必太简单，但到目前为止我看过的大多数都非常复杂，因为它们已经准备好生产了。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T21:38:04.577

如果您不介意 wpf，请尝试[BabySmash](http://www.hanselman.com/babysmash/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T21:35:25.080

这些不是桌面应用程序，但它们是很好的开源 Web 应用程序，主要使用 C# 完成，您可以从中学习。

[http://www.asp.net/community/projects/](http://www.asp.net/community/projects/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T21:36:59.790

您是否尝试过查看[SourceForge](http://www.sourceforge.net)或[Code Project](http://www.codeproject.com)？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-07T21:37:41.237

查看[http://www.codeplex.com](http://www.codeplex.com)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-07T21:41:51.773

[windowsclient.net](http://windowsclient.net/)上有很多适用于[winforms](http://windowsclient.net/downloads/folders/applications/default.aspx)和[WPF](http://windowsclient.net/downloads/folders/wpfsamples/default.aspx)的示例应用程序。我不确定我是否会将它们中的任何一个称为参考应用程序，但肯定有很多。:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-10T02:34:55.347

我放在google代码上的一个非常简单的[命令行grep工具。](http://code.google.com/p/jgrep/)你可能会觉得这很有趣。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-07T22:14:17.313

我在 Microsoft 的 SharePoint 上获得了巨大的运气，并且扩展它非常有趣且非常有教育意义 WRT c# 并学习使用它。查看[Pilothouseconsulting 的](http://www.pilothouseconsulting.com/)开发 dvd，了解有关设置调试器等的大量良好初始信息。

# c# - 在 C# 中生成 Excel 列字母的最快函数

> ID：837155
> 
> 赞同：38
> 
> 时间：2009-05-07T21:35:05.767
> 
> 标签：c#, excel, performance

什么是最快的 c# 函数，它接受和 int 并返回一个包含一个或多个字母的字符串以在 Excel 函数中使用？例如，1 返回“A”，26 返回“Z”，27 返回“AA”等。

这被调用了数万次，需要花费 25% 的时间来生成包含许多公式的大型电子表格。

```
public string Letter(int intCol) {

    int intFirstLetter = ((intCol) / 676) + 64;
    int intSecondLetter = ((intCol % 676) / 26) + 64;
    int intThirdLetter = (intCol % 26) + 65;

    char FirstLetter = (intFirstLetter > 64) ? (char)intFirstLetter : ' ';
    char SecondLetter = (intSecondLetter > 64) ? (char)intSecondLetter : ' ';
    char ThirdLetter = (char)intThirdLetter;

    return string.Concat(FirstLetter, SecondLetter, ThirdLetter).Trim();
} 
```

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-08-06T06:56:49.977

我目前在 Excel 2007 中使用它

```
public static string ExcelColumnFromNumber(int column)
        {
            string columnString = "";
            decimal columnNumber = column;
            while (columnNumber > 0)
            {
                decimal currentLetterNumber = (columnNumber - 1) % 26;
                char currentLetter = (char)(currentLetterNumber + 65);
                columnString = currentLetter + columnString;
                columnNumber = (columnNumber - (currentLetterNumber + 1)) / 26;
            }
            return columnString;
        } 
```

和

```
public static int NumberFromExcelColumn(string column)
        {
            int retVal = 0;
            string col = column.ToUpper();
            for (int iChar = col.Length - 1; iChar >= 0; iChar--)
            {
                char colPiece = col[iChar];
                int colNum = colPiece - 64;
                retVal = retVal + colNum * (int)Math.Pow(26, col.Length - (iChar + 1));
            }
            return retVal;
        } 
```

正如其他帖子中提到的，结果可以被缓存。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-05-07T21:43:44.827

我可以告诉你，最快的函数不会是最漂亮的函数。这里是：

```
private string[] map = new string[]
    { 
        "A", "B", "C", "D", "E" .............
    };

public string getColumn(int number)
{
    return map[number];
} 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-05-08T00:19:00.507

根本不要转换它。Excel 可以在 R1C1 表示法和 A1 表示法中工作。

所以（很抱歉使用 VBA 而不是 C#）：

```
Application.Worksheets("Sheet1").Range("B1").Font.Bold = True 
```

可以很容易地写成：

```
Application.Worksheets("Sheet1").Cells(1, 2).Font.Bold = True 
```

该`Range`属性采用 A1 表示法，而该`Cells`属性采用（行号，列号）。

选择多个单元格：（`Range(Cells(1, 1), Cells(4, 6))`如果不使用活动工作表，NB 将需要某种对象限定符）而不是`Range("A1:F4")`

该`Columns`属性可以采用字母（例如 F）或数字（例如 6）

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-02-07T11:49:01.717

这是我的版本：这没有任何限制，例如 2 个字母或 3 个字母。只需传入所需的数字（从 0 开始）将返回 Excel 列标题，如传入数字的字母序列：

```
private string GenerateSequence(int num)
{
    string str = "";
    char achar;
    int mod;
    while (true)
    {
        mod = (num % 26) + 65;
        num = (int)(num / 26);
        achar = (char)mod;
        str = achar + str;
        if (num > 0) num--;
        else if (num == 0) break;
    }
    return str;
} 
```

我没有对此进行性能测试，如果有人能做到这一点对其他人来说会很好。（抱歉懒惰）:)

干杯!

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-07T21:42:05.533

您可以将所有值预先生成到字符串数组中。这将占用很少的内存，并且可以在第一次调用时计算出来。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2011-12-29T18:06:18.190

这是使用 LINQ 的简洁实现。

```
static IEnumerable<string> GetExcelStrings()
{
    string[] alphabet = { string.Empty, "A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z" };

    return from c1 in alphabet
           from c2 in alphabet
           from c3 in alphabet.Skip(1)                    // c3 is never empty
           where c1 == string.Empty || c2 != string.Empty // only allow c2 to be empty if c1 is also empty
           select c1 + c2 + c3;
} 
```

这会生成`A`to `Z`，然后`AA`to `ZZ`，然后`AAA`to `ZZZ`。

在我的电脑上，通话`GetExcelStrings().ToArray()`大约需要 30 毫秒。此后，如果您需要数千次，则可以引用此字符串数组。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-07T21:43:08.573

绝对最快的方法是将 Excel 电子表格大写固定数量的列，因此您将做一个查找表。声明一个包含 256 个条目的常量字符串数组，并使用从“A”到“IV”的字符串预填充它。然后你只需做一个直接的索引查找。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-07T21:47:42.290

试试这个功能。

```
// Returns name of column for specified 0-based index.
public static string GetColumnName(int index)
{
    var name = new char[3]; // Assumes 3-letter column name max.
    int rem = index;
    int div = 17576; // 26 ^ 3

    for (int i = 2; i >= 0; i++)
    {
        name[i] = alphabet[rem / div];
        rem %= div;
        div /= 26;
    }

    if (index >= 676)
        return new string(name, 3);
    else if (index >= 26)
        return new string(name, 2);
    else
        return new string(name, 1);
} 
```

*现在，*为每个索引预先生成每个列名并将它们存储在一个巨大的数组中，不应该占用太多内存，因此您不需要查找任何列的名称两次。

如果我能想到任何进一步的优化，我稍后会添加它们，但我相信这个功能应该很快，如果你进行预生成，我怀疑你甚至需要这种速度。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-07T21:49:45.110

函数运行后，让它将结果缓存到字典中。这样，它就不必再次进行计算。

例如，Convert(27) 将检查 27 是否被映射/存储在字典中。如果不是，请进行计算并将“AA”对 27 存储在字典中。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-08T05:30:55.390

您的第一个问题是您在方法中声明了 6 个变量。如果一个方法要被调用数千次，仅仅将它们移动到类范围而不是函数范围可能会立即将您的处理时间缩短一半以上。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2011-11-18T02:53:11.553

这是用Java编写的，但基本上是一样的。

下面是计算列标签的代码，大写，索引从 0 开始：

```
public static String findColChars(long index) {
    char[] ret = new char[64];
    for (int i = 0; i < ret.length; ++i) {
        int digit = ret.length - i - 1;
        long test = index - powerDown(i + 1);
        if (test < 0)
            break;
        ret[digit] = toChar(test / (long)(Math.pow(26, i)));
    }
    return new String(ret);
}

private static char toChar(long num) {
    return (char)((num % 26) + 65);
} 
```

这是从大写标签计算列的基于 0 的索引的代码：

```
public static long findColIndex(String col) {
    long index = 0;
    char[] chars = col.toCharArray();
    for (int i = 0; i < chars.length; ++i) {
        int cur = chars.length - i - 1;
        index += (chars[cur] - 65) * Math.pow(26, i);
    }
    return index + powerDown(chars.length);
}

private static long powerDown(int limit) {
    long acc = 0;
    while (limit > 1)
        acc += Math.pow(26, limit-- - 1);
    return acc;
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2011-11-10T16:40:54.347

@Neil N - 不错的代码我认为 thirdLetter 应该有 +64 而不是 +65 ？我对吗？

```
public string Letter(int intCol) {

    int intFirstLetter = ((intCol) / 676) + 64;
    int intSecondLetter = ((intCol % 676) / 26) + 64;
    int intThirdLetter = (intCol % 26) + 65;  ' SHOULD BE + 64?

    char FirstLetter = (intFirstLetter > 64) ? (char)intFirstLetter : ' ';
    char SecondLetter = (intSecondLetter > 64) ? (char)intSecondLetter : ' ';
    char ThirdLetter = (char)intThirdLetter;

    return string.Concat(FirstLetter, SecondLetter, ThirdLetter).Trim();
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2013-07-09T14:09:46.120

我们为什么不尝试阶乘？

```
public static string GetColumnName(int index)
{
    const string letters = "ZABCDEFGHIJKLMNOPQRSTUVWXY";

    int NextPos = (index / 26);
    int LastPos = (index % 26);
    if (LastPos == 0) NextPos--;

    if (index > 26)
        return GetColumnName(NextPos) + letters[LastPos];
    else
        return letters[LastPos] + "";
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-07-11T13:04:37.140

对不起，有一个转变。更正。

```
class ToolSheet
{

    //Not the prettyest but surely the fastest :
    static string[] ColName = new string[676];

    public ToolSheet()
    {

        for (int index = 0; index < 676; ++index)
        {
            Recurse(index, index);
        }

    }

    private int Recurse(int i, int index)
    {
        if (i < 1)
        {
            if (index % 26 == 0 && index > 0) ColName[index] = ColName[index - 1].Substring(0, ColName[index - 1].Length - 1) + "Z";

            return 0;
        }

        ColName[index] = ((char)(64 + i % 26)).ToString() + ColName[index];

        return Recurse(i / 26, index);
    }

    public string GetColName(int i)
    {
        return ColName[i - 1];
    }

} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-07-11T11:22:11.580

它是递归的。快速，正确：

```
class ToolSheet
{

    //Not the prettyest but surely the fastest :
    static string[] ColName = new string[676];

    public ToolSheet()
    {
        ColName[0] = "A";
        for (int index = 1; index < 676; ++index) Recurse(index, index);

    }

    private int Recurse(int i, int index)
    {
        if (i < 1) return 0;
        ColName[index] = ((char)(65 + i % 26)).ToString() + ColName[index];

        return Recurse(i / 26, index);
    }

    public string GetColName(int i)
    {
        return ColName[i - 1];
    }

} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-07-03T07:06:31.577

缓存确实将 10,000,000 次随机调用的运行时间减少到其值的 1/3：

```
 static Dictionary<int, string> LetterDict = new Dictionary<int, string>(676);
    public static string LetterWithCaching(int index)
    {
        int intCol = index - 1;
        if (LetterDict.ContainsKey(intCol)) return LetterDict[intCol];
        int intFirstLetter = ((intCol) / 676) + 64;
        int intSecondLetter = ((intCol % 676) / 26) + 64;
        int intThirdLetter = (intCol % 26) + 65;
        char FirstLetter = (intFirstLetter > 64) ? (char)intFirstLetter : ' ';
        char SecondLetter = (intSecondLetter > 64) ? (char)intSecondLetter : ' ';
        char ThirdLetter = (char)intThirdLetter;
        String s = string.Concat(FirstLetter, SecondLetter, ThirdLetter).Trim();
        LetterDict.Add(intCol, s);
        return s;
    } 
```

我认为在最坏的情况下缓存（命中每个值）不能超过 250kb（17576 个可能值 * (sizeof(int)=4 + sizeof(char)*3 + string overhead=2)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2013-09-16T17:33:09.147

```
private String columnLetter(int column) {
    if (column <= 0) 
        return "";
    if (column <= 26){
        return (char) (column + 64) + "";
    }

    if (column%26 == 0){
        return columnLetter((column/26)-1) + columnLetter(26) ;        
    }

    return columnLetter(column/26) + columnLetter(column%26) ;        
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2012-11-29T18:42:54.127

我的解决方案：

```
static class ExcelHeaderHelper
{
    public static string[] GetHeaderLetters(uint max)
    {
        var result = new List<string>();
        int i = 0;
        var columnPrefix = new Queue<string>();
        string prefix = null;
        int prevRoundNo = 0;
        uint maxPrefix = max / 26;

        while (i < max)
        {
            int roundNo = i / 26;
            if (prevRoundNo < roundNo)
            {
                prefix = columnPrefix.Dequeue();
                prevRoundNo = roundNo;
            }
            string item = prefix + ((char)(65 + (i % 26))).ToString(CultureInfo.InvariantCulture);
            if (i <= maxPrefix)
            {
                columnPrefix.Enqueue(item);
            }
            result.Add(item);
            i++;
        }
        return result.ToArray();
    }
} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2013-02-15T10:56:12.767

barrowc 的想法比任何转换函数都方便快捷！我已将他的想法转换为我使用的实际 c# 代码：

```
 var start = m_xlApp.Cells[nRow1_P, nCol1_P];
  var end = m_xlApp.Cells[nRow2_P, nCol2_P];
  // cast as Range to prevent binding errors
  m_arrRange = m_xlApp.get_Range(start as Range, end as Range);
  object[] values = (object[])m_arrRange.Value2; 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2018-10-29T05:29:08.753

我提供的代码不是 C#（而是 python），但逻辑可以用于任何语言。

以前的大多数答案都是正确的。这是将列号转换为 excel 列的另一种方法。如果我们将此视为基本转换，则解决方案相当简单。只需将列号转换为基数 26，因为只有 26 个字母。您可以这样做：

**脚步：**

*   将列设置为商

*   从商变量中减去一个（来自上一步），因为我们需要以97 为 a 的[ascii 表结束。](http://www.asciitable.com/)

*   除以 26 得到余数。

*   将 +97 添加到余数并转换为 char（因为 97 在 ASCII 表中是“a”）
*   商成为新的商/ 26（因为我们可能会超过 26 列）
*   继续这样做直到商大于0然后返回结果

这是执行此操作的代码:)

```
def convert_num_to_column(column_num):
    result = ""
    quotient = column_num
    remainder = 0
    while (quotient >0):
        quotient = quotient -1
        remainder = quotient%26
        result = chr(int(remainder)+97)+result
        quotient = int(quotient/26)
    return result

print("--",convert_num_to_column(1).upper()) 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2017-05-31T20:39:18.223

[根据 Allen Wyatt ( https://excel.tips.net/T003254_Alphabetic_Column_Designation.html](https://excel.tips.net/T003254_Alphabetic_Column_Designation.html) ) ，只需使用 Excel 公式而不是用户定义函数 (UDF) 或其他程序：

```
=SUBSTITUTE(ADDRESS(ROW(),COLUMN(),4),ROW(),"") 
```

（在我的组织中，使用 UDF 会非常痛苦。）

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2021-10-11T19:37:22.167

如果您需要生成不仅从 A1 开始的字母

```
private static string GenerateCellReference(int n, int startIndex = 65)
            {
                string name = "";
                n += startIndex - 65;

                while (n > 0)
                {
                    n--;
                    name = (char)((n % 26) + 65) + name;
                    n /= 26;
                }

                return name + 1;
            } 
```

# sql-server - 传递默认参数值与根本不传递参数？

> ID：837158
> 
> 赞同：0
> 
> 时间：2009-05-07T21:35:57.247
> 
> 标签：sql-server, stored-procedures, parameters, default

这是我想要做的：

给定一张桌子

```
PeopleOutfit (id int primary key, boots int, hat int) 
```

和一个存储过程

```
UpdateOutfit @id int, @newBoots int = null, @newHat = null 
```

有没有办法判断我是否将此程序称为

```
exec UpdateOutfit @id=1, @newBoots=null, @newHat=5 
```

有效地告诉 id 为 1 的人现在必须赤脚并戴上第五顶帽子

```
exec UpdateOutfit @id=1, @newHat=5 
```

指示这个人戴上第五顶帽子，保持他现在的靴子？

换句话说，我想（在存储过程中）告诉（在存储过程中）是否“使用了默认值，因为它没有被指定”，来自“我明确地调用了这个过程，传递了恰好与默认值相同的值”。

我知道有几种方法可以完成我想做的事情，例如传递 XML 或正在更新的字段的位掩码，但目前我只想确定这种确切的技术是否可行。

编辑：传递保留值不适用于具有小范围类型的字段，例如位。重载过程也是一个不可接受的选项。创建使用附加“NotAValue”值扩展 NULL 范式的用户定义类型可能是一个答案，但我需要更多关于如何实现它的指导。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T21:38:39.770

不，默认的 null “看起来”与传入的 null 相同

可能将您的默认值设为 -1 并使用逻辑来做一些不同的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T21:38:57.117

我的猜测是不，你不能把这两件事区分开来。

我的建议是使用您永远不会作为参数传入的默认值。即，如果默认值是`null`，那么也许你可以`0`作为值传入`@newBoots`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T21:39:36.350

严格来说，不，没有真正的设施可以做到这一点。但是，您可以尝试为参数使用某种保留值（例如，一个非常小的负数）来表明这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T21:57:26.870

我自己从来没有这样做过；在一些代码中引入了 3 状态位（使用整数）来处理位情况。我无法访问 sql 服务器，但有时我确实喜欢后期思考；但我认为您可能能够通过某些管理视图/功能找出 ysubg 字符串操作。你需要以很多特权运行，但如果它绝对有必要，我不明白为什么你不能使用类似这样的东西从 st.text 解决它

```
SELECT  
    st.text
FROM
    sys.dm_exec_requests r
CROSS APPLY 
    sys.dm_exec_sql_text(sql_handle) AS st
WHERE
    r.session_id = @@SPID 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-07T22:20:45.160

如前所述，TSQL 不区分提供默认值和不提供值。我认为引擎基本上用默认值替换任何缺少的参数（或使用 DEFAULT 关键字调用的参数。）

相反，使用 0 作为“No Hat”，使用 NULL 作为未指定参数。这是 NULL 的首选用法，它表示值未知或未指定。通过将 NULL 用作“No Hat”，您已经选择将它添加到您的数据类型范围中添加一个额外的值。

根据 BIT 数据类型来考虑它。数据类型被定义为表示二进制值（1 或 0，或 T/F，如果您更愿意将其视为布尔值。）通过将 NULL 视为有效值，您已将数据类型扩展到二进制选项之外（现在有三个选项，1/0/NULL。）我的建议始终是，如果您发现当前数据类型中的值已用完，则说明您使用的类型太小。

回到存储过程调用；如果您将默认值设置为 NULL，并将 NULL 视为未设置或未指定，则调用者在调用 proc 时应始终指定非空值。如果你得到一个 NULL，假设他们没有提供一个值，提供了一个 NULL，或者使用了 DEFAULT 关键字。

# c# - 这是一个合适的 MonoState 设计吗？

> ID：837160
> 
> 赞同：1
> 
> 时间：2009-05-07T21:37:27.697
> 
> 标签：c#, oop, monostate

我有一个`Person`班级，并且基于我在这篇文章中收到的一些帮助。

[MonoState、Singleton 或派生形式：CRUD 应用程序的最佳方法？](https://stackoverflow.com/questions/825617/passing-objects-and-the-singleton-pattern/825820)

我有一`CurrentPerson`堂课（？？）它，我通过它访问数据。

我想我理解这应该如何工作，但似乎我做得*不太*对。

问题：

1.  对于初学者来说，`Person`它的所有成员变量不应该是**私有**的吗？

2.  为什么`Person`在声明时是`CurrentPerson`静态的？是对的吗？

3.  `Person`实际上有子对象`Address`,`Enrollment`和`CaseNote`. 我如何合并它们？一个`CurrentEnrollment`包装`Enrollment`？

作为一门*应用*科学，我对 OOP 相当陌生，因此其中一些概念对我来说很难想象。

代码很长，请见谅。

* * *

```
class Person
{
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public string MiddleName { get; set; }
    public string SuffixID { get; set; }
    public string TitleID { get; set; }
    public string SocialSn { get; set; }
    public string Gender { get; set; }
    public string DlNumber { get; set; }
    public string DlStateID { get; set; }
    public string PrimaryRace { get; set; }
    public string SecondaryRace { get; set; }
    public string EmailAddress { get; set; }
    public string MaritalStatus { get; set; }
    public string InsertProgram { get; set; }
    public string InsertUserID { get; set; }
    public string UpdateProgram { get; set; }
    public string UpdateUserID { get; set; }
    public string LockID { get; set; }

    public int PersonID { get; set; }
    public int ClientID { get; set; }
    public int ResidencyCountyID { get; set; }
    public int ResponsibilityCountyID { get; set; }

    public bool HispanicOriginFlag { get; set; }
    public bool CitizenFlag { get; set; }
    public bool VeteranFlag { get; set; }

    public DateTime BirthDate { get; set; }
    public DateTime DeathDate { get; set; }
    public DateTime InsertDateTime { get; set; }
    public DateTime UpdateDateTime { get; set; }

}

class CurrentPerson
{
    public static Person Person { get; set; }

    public string FirstName
    {
        get { return CurrentPerson.Person.FirstName; }
        set { CurrentPerson.Person.FirstName = value; }
    }

    public string LastName
    {
        get { return CurrentPerson.Person.LastName; }
        set { CurrentPerson.Person.LastName = value; }
    }

    public string MiddleName
    {
        get { return CurrentPerson.Person.MiddleName; }
        set { CurrentPerson.Person.MiddleName = value; }
    }

    public string SuffixID
    {
        get { return CurrentPerson.Person.SuffixID; }
        set { CurrentPerson.Person.SuffixID = value; }
    }

    public string TitleID
    {
        get { return CurrentPerson.Person.TitleID; }
        set { CurrentPerson.Person.TitleID = value; }
    }

    public string SocialSn
    {
        get { return CurrentPerson.Person.SocialSn; }
        set { CurrentPerson.Person.SocialSn = value; }
    }

    public string Gender
    {
        get { return CurrentPerson.Person.Gender; }
        set { CurrentPerson.Person.Gender = value; }
    }

    public string DlNumber
    {
        get { return CurrentPerson.Person.DlNumber; }
        set { CurrentPerson.Person.DlNumber = value; }
    }

    public string DlStateID
    {
        get { return CurrentPerson.Person.DlStateID; }
        set { CurrentPerson.Person.DlStateID = value; }
    }

    public string PrimaryRace
    {
        get { return CurrentPerson.Person.PrimaryRace; }
        set { CurrentPerson.Person.PrimaryRace = value; }
    }

    public string SecondaryRace
    {
        get { return CurrentPerson.Person.SecondaryRace; }
        set { CurrentPerson.Person.SecondaryRace = value; }
    }

    public string EmailAddress
    {
        get { return CurrentPerson.Person.EmailAddress; }
        set { CurrentPerson.Person.EmailAddress = value; }
    }

    public string MaritalStatus
    {
        get { return CurrentPerson.Person.MaritalStatus; }
        set { CurrentPerson.Person.MaritalStatus = value; }
    }

    public string InsertProgram
    {
        get { return CurrentPerson.Person.InsertProgram; }
        set { CurrentPerson.Person.InsertProgram = value; }
    }

    public string InsertUserID
    {
        get { return CurrentPerson.Person.InsertUserID; }
        set { CurrentPerson.Person.InsertUserID = value; }
    }

    public string UpdateProgram
    {
        get { return CurrentPerson.Person.UpdateProgram; }
        set { CurrentPerson.Person.UpdateProgram = value; }
    }

    public string UpdateUserID
    {
        get { return CurrentPerson.Person.UpdateUserID; }
        set { CurrentPerson.Person.UpdateUserID = value; }
    }

    public string LockID
    {
        get { return CurrentPerson.Person.LockID; }
        set { CurrentPerson.Person.LockID = value; }
    }

    public int PersonID
    {
        get { return CurrentPerson.Person.PersonID; }
        set { CurrentPerson.Person.PersonID = value; }
    }

    public int ClientID
    {
        get { return CurrentPerson.Person.ClientID; }
        set { CurrentPerson.Person.ClientID = value; }
    }

    public int ResidencyCountyID
    {
        get { return CurrentPerson.Person.ClientID; }
        set { CurrentPerson.Person.ClientID = value; }
    }

    public int ResponsibilityCountyID
    {
        get { return CurrentPerson.Person.ResponsibilityCountyID; }
        set { CurrentPerson.Person.ResponsibilityCountyID = value; }
    }

    public bool HispanicOriginFlag
    {
        get { return CurrentPerson.Person.HispanicOriginFlag; }
        set { CurrentPerson.Person.HispanicOriginFlag = value; }
    }

    public bool CitizenFlag
    {
        get { return CurrentPerson.Person.CitizenFlag; }
        set { CurrentPerson.Person.CitizenFlag = value; }
    }

    public bool VeteranFlag
    {
        get { return CurrentPerson.Person.VeteranFlag; }
        set { CurrentPerson.Person.VeteranFlag = value; }
    }

    public DateTime BirthDate
    {
        get { return CurrentPerson.Person.BirthDate; }
        set { CurrentPerson.Person.BirthDate = value; }
    }

    public DateTime DeathDate
    {
        get { return CurrentPerson.Person.DeathDate; }
        set { CurrentPerson.Person.DeathDate = value; }
    }

    public DateTime InsertDateTime
    {
        get { return CurrentPerson.Person.InsertDateTime; }
        set { CurrentPerson.Person.InsertDateTime = value; }
    }

    public DateTime UpdateDateTime
    {
        get { return CurrentPerson.Person.UpdateDateTime; }
        set { CurrentPerson.Person.UpdateDateTime = value; }
    }

} 
```

* * *

PS 如果 Daniel Brückner 碰巧读到了这篇文章，请不要冒犯，因为我不是在猜测你的答案；我只需要对某些项目进行更深入的说明，以便正确理解单态在我的应用程序中的使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T21:50:46.900

关于字段是否应该是私有的，这只是在没有支持变量的情况下声明属性的新方法（C# 3.0？）。一个常见的变化是

```
public string SomeProperty { get; protected set } 
```

'当然，一旦你想在 setter 中做类似验证的事情，这不起作用，你必须回去编写 setter 和 getter，并声明一个支持变量。

我不确定静态`CurrentPerson.Person()`方法的意图是什么，或者它是如何设置的。

对于第三个问题，如果我理解你的话，你会给`Person`类一个类型的属性`Address`并像这样访问它：

```
Console.WriteLine(somePerson.HomeAddress.City); 
```

# c# - 如何从 C# 中的字符串中删除所有不在括号内的逗号？

> ID：837164
> 
> 赞同：0
> 
> 时间：2009-05-07T21:38:43.107
> 
> 标签：c#, regex

我有一个可以执行“IntPow(3,2)”之类的函数的数学解析器。如果用户粘贴“1,000,000”然后添加一个加号，使完整的等式“1,000,000+IntPow(3,2)”解析器失败，因为它不适用于包含逗号的数字。

我需要从“1,000,000”中删除逗号，而不是从“IntPow(3,2)”中删除逗号，因为 IntPow 有两个由逗号分隔的参数。最终等式将是“1000000+IntPow(3,2)”。方程式存储在一个字符串中。如何仅删除括号外的逗号？我假设并说包含逗号的数字不会放在 IntPow 参数列表中。

当我说“删除逗号”时，我的意思是删除“CultureInfo.CurrentCulture.NumberFormat.NumberGroupSeparator”，这可能是逗号或句点，具体取决于本地。这部分很容易，因为我假设将使用 RegEx，并且我可以在 RegEx 逗号位置连接该值。

我有这个 RegEx: (.*?) 用于在其中查找括号和值，但我不确定如何仅删除 RegEx 匹配项之外的逗号。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-07T21:54:37.280

最简单的方法是不要尝试使用正则表达式来执行此操作。一次只循环一个字符。如果你读到一个'（'，增加一个计数器。如果你读到一个'）'，减少那个计数器。如果读到逗号，如果计数器为 0，则将其删除，否则不理会。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T21:48:34.847

但是如果用户粘贴：

```
1,000+IntPow(3,000,2,000) 
```

现在 3,000 在逗号之间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T22:06:03.323

```
Sub Main()

    '
    '   remove Commas from a string containing expression-like syntax
    '       (eg.  1,000,000 + IntPow(3,2) - 47 * Greep(9,3,2) $ 5,000.32 )
    '       should become:  1000000 + IntPow(3,2) - 47 * Greep(9,3,2) $ 5000.32
    '

    Dim tInput As String = "1,000,000 + IntPow(3,2) - 47 * Greep(9,3,2) $ 5,000.32"
    Dim tChar As Char = Nothing
    Dim tResult As StringBuilder = New StringBuilder(tInput.Length)
    Dim tLevel As Integer = 0

    For Each tChar In tInput
        Select Case tChar
            Case "("
                tLevel += 1
                tResult.Append(tChar)

            Case ")"
                tLevel -= 1
                tResult.Append(tChar)

            Case ","   '  Change this to your separator character.
                If 0 < tLevel Then
                    tResult.Append(tChar)
                End If

            Case Else
                tResult.Append(tChar)

        End Select
    Next

    Console.ForegroundColor = ConsoleColor.Cyan
    Console.WriteLine(tInput)
    Console.WriteLine(String.Empty)
    Console.ForegroundColor = ConsoleColor.Yellow
    Console.WriteLine(tResult.ToString)
    Console.WriteLine()
    Console.ResetColor()
    Console.WriteLine(" -- PRESS ANY KEY -- ")
    Console.ReadKey(True)

End Sub 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-07T22:16:08.760

我认为使用正则表达式是不可能的。区分内括号和外括号不是常规语言。它是一种上下文不敏感的语言，无法使用常规状态机（表达式）来决定。您需要一台堆栈机（即由乍得决定的链接）

# search - 我想找到一种具有通用名称的计算机语言

> ID：837167
> 
> 赞同：3
> 
> 时间：2009-05-07T21:39:43.697
> 
> 标签：search, programming-languages

大约 10 年前，我在古代 Prime 上使用了一种名为 INFO 的计算机语言。它是一种时髦但非常有用的语言，我想了解更多关于它的信息。例如，我可以得到一个可以在 PC 上运行的副本吗？但是，如果我用谷歌搜索“信息”和“计算机语言”，我就找不到了。我试过了。我认为创建它的公司是在英国。

它很容易学习，以至于我第一天就在编程，但却能做到真正的古怪。程序有行号，如果数字以奇数开头，则命令类似于 SQL 并适用于整个集合。如果它们以偶数开头，则命令是一个块，一次处理集合中的每个项目。

所以，一个简单类型的程序可能是这样的（我也不记得语法）

```
100  select * from user_table
110  join with address_table
120  exclude duplicate addresses
200  for each record in set
205    print firstname, lastname
210    print addressLine1
220    print City, State, Zip
300  display "address labels printed" 
```

它能够快速和令人印象深刻的应用程序，几乎易于理解，但具有我在工作两年后才开始理解的鬼鬼祟祟的力量。

我如何找到它？我可以得到一份可以在 PC 上运行的副本吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T21:45:19.847

我认为正确的名称是“主要信息”。搜索该短语可能会得到一些稍微相关的结果。

[你可以在这里](http://www.malch.com/prime/primefaq.htm#L2_27)找到一些信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-07T21:45:48.473

我相信这就是 Pr1me 信息语言；它现在隐藏在[IBM Universe](http://www-01.ibm.com/software/data/u2/universe/)中。它是[Pick](http://en.wikipedia.org/wiki/Pick_operating_system)的竞争对手。

# php - MySQL 时间戳 - 为什么全为零？

> ID：837190
> 
> 赞同：6
> 
> 时间：2009-05-07T21:43:10.523
> 
> 标签：php, mysql, timestamp, phpmyadmin

我正在使用 PHPMyAdmin，并且我有一个名为“时间戳”的 MySQL 表列。类型（惊喜！）是`TIMESTAMP`，并且在“属性”中我将其设置为`ON UPDATE CURRENT_TIMESTAMP`。

但是，每条新记录都会获得一个如下所示的时间戳：

```
0000-00-00 00:00:00 
```

我已将默认值明确设置为无，但是当我保存并返回查看时，它被设置为如上所述的全零。

相关的 PHP 记录页面使用此查询命中：

```
$query = "INSERT INTO `pagehit` (user_id, pageurl)
VALUES ('" . $userid . "', '" . $pageurl . "')"; 
```

整个事情都在 XAMPP 下运行。

我错过了什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-07T21:46:52.883

尝试将默认值设置为`CURRENT_TIMESTAMP`而不是将其放入属性中。

[MySQL 参考](http://dev.mysql.com/doc/refman/5.0/en/timestamp.html)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-07T21:46:52.917

> 我错过了什么？

你不更新:)

`DEFAULT CURRENT_TIMESTAMP`一起使用`ON UPDATE CURRENT_TIMESTAMP`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-08T05:36:19.120

如果您的`timestamp`列仅捕获插入时间，则仅使用

```
timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP 
```

否则，如果是修改时间，则使用如下

```
timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-05-29T15:32:43.990

在我的情况下是这样的：

在 phpMyAdmin 中：

```
ALTER TABLE `name_table`  ADD  `name_row` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP; 
```

在行的 PHP sintax 中：

```
date('Y-m-d H:i:s') 
```

# python - 在没有名称属性的 Python 中提交表单

> ID：837195
> 
> 赞同：2
> 
> 时间：2009-05-07T21:44:49.067
> 
> 标签：python, forms, urllib2, urllib

背景：

在 Python 中使用 urllib 和 urllib2 可以进行表单提交。

您首先创建一个字典。

```
formdictionary = { 'search' : 'stackoverflow' } 
```

然后你使用 urllib 的 urlencode 方法来转换这个字典。

```
params = urllib.urlencode(formdictionary) 
```

您现在可以使用 urllib2 发出 url 请求，并将变量 params 作为辅助参数传递，第一个参数是 url。

```
open = urllib2.urlopen('www.searchpage.com', params) 
```

据我了解，urlencode 会自动将字典编码为 html 并添加输入标签。它将键作为名称属性。它需要字典中的值作为名称属性的值。Urllib2 通过 HTTP POST 请求发送此 html 代码。

问题：

如果您提交的 html 代码以标准方式格式化，并且 html 标记输入具有 name 属性，这没关系。

```
<input id="32324" type="text" name="search" > 
```

但是，存在html代码格式不正确的情况。并且 html 输入标签只有一个 id 属性没有 name 属性。是否有另一种方法可以通过 id 属性访问输入标签？还是可能有另一种方式？

解决方案：

?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T22:05:09.127

根据[W3 标准](http://www.w3.org/TR/html401/interact/forms.html#successful-controls)，对于要提交的输入字段，它必须具有 name 属性。对 Firefox 3 和 Safari 3.2 的快速测试表明，缺少 name 属性但具有 id 属性的输入字段未提交。

话虽如此，如果您有一个要提交的表单，并且它的某些字段具有 id 但没有 name 属性，则使用 id 属性似乎是唯一可用的选项。可能是其他浏览器使用了 id 属性，或者可能有一些 JavaScript 代码处理提交事件，而不是让浏览器去做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T22:11:59.657

没有名称的输入标签不会作为表单参数提交。

例如，创建一个仅包含以下内容的 HTML 页面：

```
<form>
    <input type="text" name="one" value="foo"/>
    <input type="text" value="bar"/>
    <input type="submit"/>
</form> 
```

您可以看到第二个文本字段缺少一个`name`属性。如果单击“提交”，页面将刷新查询字符串：

```
test.html?one=foo 
```

* * *

一个好的策略是查看浏览器发送的实时 POST 请求，然后从模拟它开始。使用 Firefox 的 FireBug 扩展等工具来查看浏览器发送的 POST 请求和参数。那里可能有你以前没有注意到的参数——可能是因为它们是隐藏的表单元素或者它们是由 JavaScript 创建/设置的。

# javascript - jQuery错误？？如何在所有可见的行中获取第一个“td”

> ID：837202
> 
> 赞同：7
> 
> 时间：2009-05-07T21:45:51.280
> 
> 标签：javascript, jquery

我有一张桌子，我隐藏了一些行。我想在所有显示的行中获得第一个 td 。我有以下声明

```
$("table.SimpleTable tbody tr:visible td:first-child"); 
```

这适用于 FireFox 但不适用于 IE 有什么想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-07T21:52:02.357

那*应该*行得通。使用如下所示的 HTML：

```
<table class='SimpleTable'> 
  <tr style='display: none;'> 
    <td>test1</td> 
  </tr> 
  <tr> 
    <td>test2</td> 
  </tr> 
  <tr> 
    <td>test3</td> 
  </tr> 
  <tr style='display: none;'> 
    <td>test4</td> 
  </tr> 
  <tr> 
    <td>test5</td> 
  </tr> 
  <tr> 
    <td>test6</td> 
  </tr>   
</table> 
```

这样做：

```
$("table.SimpleTable tbody tr:visible td:first-child").css('color','red'); 
```

在我的 Firefox 和 IE7 中使颜色变为红色。你的 HTML 是什么样的？

[这是我在上面测试的](http://jsbin.com/ekuyu)

**编辑**：对我来说，你需要做你现在正在做的事情对我来说很奇怪。你应该能够用这个替换你现在拥有的东西：

```
var serials = [];
$("table.SimpleTable tbody tr:visible td:first-child").each(function() {
    serials.push($.trim($(this).text()));
});
var serials = serials.join(','); 
```

如果 TD 是从选择器中填充的，它们应该只是可见的。如果您在连续剧中获得隐藏的 TD（我必须强调，这真的不应该发生，并且是某个地方的错误或错误迹象），请尝试使用此选择器：

```
$("table.SimpleTable tbody tr:not(:hidden) td:first-child") 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-07T22:10:12.953

我在点击事件上运行代码。您编写的 html 几乎是正确的，但由于某些我不知道的原因，它无法正常工作。不过，我找到了解决方法。（我试图在第一个 td 中为可见行获取所有值的逗号分隔字符串）无论如何，以下工作可以完成工作。

```
 var notfirst = false;
    var serials = "";
    var tds = $("table.SimpleTable tbody tr:visible td:first-child");
    for (var i = 0; i < tds.length; i++) {
        var td = $(tds[i]);
        if (td.is(":hidden"))
            continue;
        if (notfirst)
            serials += ",";
        else
            notfirst = true;

        serials += $.trim(td.text());
    } 
```

由于某种原因， :hidden 标记可以正常工作，但 :visible 在 IE7 中不能正常工作

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-07T22:02:56.310

从文档：

> “ :visible 的计算方式在 jQuery 1.3.2 中发生了变化。如果元素及其父元素占用文档中的空间，则假定元素为可见。不考虑 CSS 可见性。”

也许这与它有关。尝试使用类选择器或其他东西而不是 tr:visible

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-07T22:04:25.433

你为什么不把它分开一点？

```
$("table.SimpleTable").find("tr:visible").find("td:first-child").text() 
```

?

# c++ - 使用 Hash Maps 表示一个非常大的数据源

> ID：837203
> 
> 赞同：1
> 
> 时间：2009-05-07T21:46:12.263
> 
> 标签：c++, stl, hashmap, hash

我有一个非常大的可能数据集，我正试图立即可视化。该集合本身由数十万个段组成，每个段都映射到一个 id。

我收到了第二个数据源，它为每个段提供了更多实时信息，但 id 与我拥有的 id 不对应。

我有一个 1:1 的数据 id（9 个字符的字符串）映射到当前的 id（长整数）。问题是有很多 id，并且进来的数据没有特定的顺序。

我想出的解决方案是有一个哈希映射，将字符串映射到道路 ID。问题是我不知道哈希映射是否足够高效以拥有所有 166k 数据条目。

有没有人可以为此使用任何建议和/或散列算法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T21:49:08.590

[Judy 数组](http://judy.sourceforge.net/)是为这类事情而设计的：“Judy 的主要优点是可扩展性、高性能和内存效率。[...] Judy 可以替换许多常见的数据结构，例如数组、稀疏数组、哈希表、B 树、二叉树、线性列表、跳过列表、其他排序和搜索算法以及计数函数。”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T21:56:40.630

如果您只处理数十万个数据点，那么采用幼稚的方式并坚持使用哈希映射可能不会有问题。

即使您有 500,000 个 9 字符的字符串和相同数量的`long`s，每个项目仍然只有 16 个字节，或总共 8,000,000 个字节。即使您将开销翻倍，16 MB 也不会太大而无法一次存储在内存中。

基本上，首先尝试简单的方法，只有当您的分析告诉您它花费的时间太长时才担心它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T23:31:00.310

由于对该问题的评论表明主要问题可能是内存使用情况：

*   使用**池化或其他小对象优化分配器**；假设您可以使用[boost](http://www.boost.org/)，您可能会在[Pool](http://www.boost.org/doc/libs/1_38_0/libs/pool/doc/index.html)中找到一个替代品。使用更好的小对象分配器可能是您会发现的最大的内存胜利。
*   如果您知道您的字符串是固定宽度的，您可能需要确保**只分配足够的空间**来存储它们。例如，使用自定义比较运算符包裹在固定长度 char[] 周围的结构可能比 std::string 更好。std::string 带有额外的动态分配（并为相应的指针使用空间）以及一些额外的大小和容量跟踪开销。（一般来说，尽量**减少保留的分配数量**；它会减少开销。）
*   （假设 STL）查看 std::map 和 std::unordered_map 之间的开销差异（后者目前可能对您可用，也可能不可用）；基于**RBtree 的 std::map**可能与您的“哈希图”的查找性能特征足够接近，并且可能（或可能不会）更节省内存，具体取决于您的标准库实现。

您采取的路线应该受到您可以收集的信息的影响——尝试了解分配的数量和分配大小/对齐开销。

您可以检测您的分配器或插入一些元素，并与您认为在内存使用方面应该做的相比，看看您的表现如何。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T12:20:24.947

由于您的字符串是预先知道的并且具有固定长度，因此理论上和实际上最好的解决方案是*完美*的哈希。您可以使用[cmph](http://cmph.sourceforge.net/index.html)来生成它。

根据 Wikipedia，您的密钥需要 2.5 位/密钥，或大约 50KB。与 664KB 的值相比，这可以忽略不计。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-01-11T21:27:20.173

虽然 166k 数据条目是相当小的 IMO 你可以看看[google-sparsehash](http://code.google.com/p/google-sparsehash/)

# asp.net - 登录页面的问题

> ID：837208
> 
> 赞同：0
> 
> 时间：2009-05-07T21:47:02.680
> 
> 标签：asp.net

我有这个问题；我正在使用 ASP.Net 2005 开发一个站点，我使用的数据库是 MySQL，Web 服务器是 Cassini，我还使用 Forms Authentication 来处理对页面的访问。

我正在对访问该站点的所有计算机进行测试，但是昨天当我从 PC 访问该站点时，会显示登录页面，但是当我按下按钮进行身份验证时，我仍停留在同一登录页面中。

我不知道发生了什么，因为我可以访问服务器中的页面，但是从任何其他终端访问它会使我保持在登录页面中，而无需访问站点（程序）本身。

这里有什么问题？

这是登录按钮的代码

```
 qfh.User user = qfh.Global.Login(txtUserName.Text, txtPassword.Text, null, null);
        if (user != null)
        {
            // Initialize FormsAuthentication, for what it's worth
            FormsAuthentication.Initialize();

            // Create a new ticket used for authentication
            FormsAuthenticationTicket ticket = new FormsAuthenticationTicket(
               1, // Ticket version
               user.UserName, // Username associated with ticket
               DateTime.Now, // Date/time issued
               DateTime.Now.AddMinutes(30), // Date/time to expire
               true, // "true" for a persistent user cookie
               string.Join(",", user.GetRoles()), // User-data, in this case the roles
               FormsAuthentication.FormsCookiePath);// Path cookie valid for

            //Fill the complementary data
            Profile.User = user.UserName;
            Profile.Name = user.Name;
            //Profile.Enterprise = user.Enterprise.EnterpriseCode; // enterprise.EnterpriseCode;
            //Profile.Period = user.Enterprise.GetActivePeriod().PeriodCode; //enterprise.GetActivePeriod().PeriodCode;

            Session["Enterprise"] = user.Enterprise.EnterpriseCode;
            Session["Period"] = user.Enterprise.GetActivePeriod().PeriodCode;

            // Encrypt the cookie using the machine key for secure transport
            string hash = FormsAuthentication.Encrypt(ticket);
            HttpCookie cookie = new HttpCookie(
               FormsAuthentication.FormsCookieName, // Name of auth cookie
               hash); // Hashed ticket

            // Set the cookie's expiration time to the tickets expiration time
            if (ticket.IsPersistent) cookie.Expires = ticket.Expiration;

            // Add the cookie to the list for outgoing response
            Response.Cookies.Add(cookie);

            // Redirect to requested URL, or homepage if no previous page
            // requested
            string returnUrl = Request.QueryString["ReturnUrl"];
            if (returnUrl == null) returnUrl = "/";

            // Don't call FormsAuthentication.RedirectFromLoginPage since it
            // could
            // replace the authentication ticket (cookie) we just added
            Response.Redirect(returnUrl);
        }
        else
        {
            lblStatusMessage.Text = Utilities.JSAlert("Access denied");
            return;
        } 
```

这是 web.config

```
<?xml version="1.0"?>
<!-- 
    Note: As an alternative to hand editing this file you can use the 
    web admin tool to configure settings for your application. Use
    the Website->Asp.Net Configuration option in Visual Studio.
    A full list of settings and comments can be found in 
    machine.config.comments usually located in 
    \Windows\Microsoft.Net\Framework\v2.x\Config 
-->
<configuration>

  <configSections>
    <section name="activerecord" type="Castle.ActiveRecord.Framework.Config.ActiveRecordSectionHandler, Castle.ActiveRecord"/>
  </configSections>

  <appSettings>
    <add key="QFH" value="QFH2009" />
  </appSettings>

  <activerecord isWeb="true">
    <config>
      <add key="hibernate.connection.driver_class" value="NHibernate.Driver.MySqlDataDriver"/>
      <add key="hibernate.dialect" value="NHibernate.Dialect.MySQLDialect"/>
      <add key="hibernate.connection.provider" value="NHibernate.Connection.DriverConnectionProvider"/>
      <add key="hibernate.connection.connection_string" value="Server=localhost;Database=qfh;User ID=root;Password=admin;Pooling=false;Min Pool Size=5;Max Pool Size=100;"/>
    </config>
  </activerecord>

  <connectionStrings>
    <!--<add name="QFHConnectionString" connectionString="Dsn=QFH" providerName="System.Data.Odbc"/>-->
    <add name="QFHConnectionString" connectionString="Server=localhost;Database=qfh;User ID=root;Password=admin;Pooling=false;Min Pool Size=5;Max Pool Size=100;"/>
  </connectionStrings>

  <system.web>

    <roleManager defaultProvider="MySqlRoleProvider"
        enabled="true"
        cacheRolesInCookie="true"
        cookieName=".ASPROLES"
        cookieTimeout="30"
        cookiePath="/"
        cookieRequireSSL="false"
        cookieSlidingExpiration="true"
        cookieProtection="All" >

      <providers>
        <clear />
        <add
            name="MySqlRoleProvider"
            type="Andri.Web.MySqlRoleProvider"
            connectionStringName="QFHConnectionString"
            applicationName="QFH"
            writeExceptionsToEventLog="true"
        />
      </providers>

    </roleManager>

    <membership defaultProvider="MySqlMembershipProvider" userIsOnlineTimeWindow="15">

      <providers>
        <clear />
        <add
            name="MySqlMembershipProvider"
            type="Andri.Web.MySqlMembershipProvider"
            connectionStringName="QFHConnectionString"
            applicationName="QFH"
            enablePasswordRetrieval="false"
            enablePasswordReset="true"
            requiresQuestionAndAnswer="true"
            requiresUniqueEmail="true"
            passwordFormat="Hashed"
            writeExceptionsToEventLog="true"
            />
      </providers>

    </membership>

    <!-- 
            Set compilation debug="true" to insert debugging 
            symbols into the compiled page. Because this 
            affects performance, set this value to true only 
            during development.

        -->

    <httpModules>
      <add name="ar.sessionscope" type="Castle.ActiveRecord.Framework.SessionScopeWebModule, Castle.ActiveRecord"/>
    </httpModules>

    <compilation debug="true">
      <assemblies>
        <add assembly="MySql.Data, Version=5.1.7.0, Culture=neutral, PublicKeyToken=C5687FC88969C44D"/>
        <add assembly="System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
        <add assembly="System.Design, Version=2.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A"/>
        <add assembly="System.Transactions, Version=2.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
        <add assembly="Microsoft.VisualBasic, Version=8.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A"/>
      </assemblies>
    </compilation>

    <!--
            The <authentication> section enables configuration 
            of the security authentication mode used by 
            ASP.NET to identify an incoming user. 
        -->
    <!--<roleManager enabled="false"/>-->

    <authentication mode="Forms">
      <forms name="QFHWEBAPP.ASPXAUTH" loginUrl="Login.aspx" defaultUrl="Default.aspx" />
    </authentication>

    <authorization>
      <!-- Do not allow all users come in -->
      <deny users="?"/>
    </authorization>

    <anonymousIdentification enabled="true"/>

    <!-- Temporary fields for the session -->
    <profile defaultProvider="MySQLProfileProvider">
      <providers>
        <!--<add name="MySqlProfileProvider"
     type="Malachi.MySqlProviders.MySqlProfileProvider"-->
        <add name="MySQLProfileProvider"
             type="Ezim.MySql.Web.Profile.MySqlProfileProvider"
             connectionStringName="QFHConnectionString"
             applicationName="QFH"/>
      </providers>
      <properties>
        <add name="User" allowAnonymous="true" type="System.String"/>
        <add name="Name" allowAnonymous="true" type="System.String"/>
        <add name="Period" allowAnonymous="true" type="System.Int32"/>
        <add name="Enterprise" allowAnonymous="true" type="System.Int32"/>
      </properties>
    </profile>
    <!--
            The <customErrors> section enables configuration 
            of what to do if/when an unhandled error occurs 
            during the execution of a request. Specifically, 
            it enables developers to configure html error pages 
            to be displayed in place of a error stack trace.

        <customErrors mode="RemoteOnly" defaultRedirect="GenericErrorPage.htm">
            <error statusCode="403" redirect="NoAccess.htm" />
            <error statusCode="404" redirect="FileNotFound.htm" />
        </customErrors>
        -->
    <customErrors mode="Off" />
  </system.web>

  <!--This code is used to make available the css-->
  <location path="css">
    <system.web>
      <authorization>
        <allow users="*"/>
      </authorization>
    </system.web>
  </location>
</configuration> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-07T22:16:35.030

首先排除 PC 的问题，您可以在 PC 上运行 fiddler（谷歌它是一些 MS 开发人员编写的）来检查提交是否正在被服务器处理。如果它不去网络服务器，那么它可能是一个代理问题阻止了 pc 看到你的站点，或者是一个 javascript 权限问题阻止了按钮被提交。

如果它正在连接，那么我会检查数据库查询是否正在通过（我希望你确实在上面的 web.config 中更改了用户名和密码。）如果没问题；您的页面权限设置是否正确；我的网站 web.config 中有更多的授权设置。

```
<location path="css">
    <system.web>
      <authorization>
        <allow users="*"/>
      </authorization>
    </system.web>
  </location>
</configuration> 
```

# asp.net - 使用具有重叠属性的多个配置文件提供程序

> ID：837210
> 
> 赞同：0
> 
> 时间：2009-05-07T21:48:27.297
> 
> 标签：asp.net, asp.net-membership, profile, asp.net-profiles

我正在使用需要使用两个不同的 asp.net 配置文件提供程序的站点。它们都添加到 web.config 中，并且它们中的每一个的属性也都列在那里。当我尝试在每个提供程序中启用具有相同名称的属性时遇到问题。注释掉一个，网站至少会加载。将两者都保留，我会收到如下错误：

项目已添加。字典中的键：'myfieldname' 正在添加的键：'MyFieldName'

这些属性是完全不同的（甚至是不同的类型），但我错过了如何允许两者同时使用。

我一定有某种方式遗漏了，因为这似乎是一个常见问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-07T22:32:33.523

我只用一个 Web 应用程序项目实现了一个配置文件系统。使用网站模板，功能是开箱即用的。配置文件允许您在使用 ASP.NET 成员系统时为每个用户存储一些额外的信息。当我们将此额外信息添加到 web.config 文件时，配置文件会自动存储在数据库中。

如果您使用具有相同名称的配置文件属性，则存在冲突是有道理的 - 一种可能的解决方案是创建自己的表映射 - 例如，在 web.config 中给“MyFieldName”一个别名，但将其映射到代码中的真实属性名称。由于网站模板的大部分功能都是开箱即用的，因此您可以执行的自定义数量可能会受到限制。

以下链接可能会有所帮助：

[http://code.msdn.microsoft.com/WebProfileBuilder](http://code.msdn.microsoft.com/WebProfileBuilder)

[http://weblogs.asp.net/joewrobel/archive/2008/02/03/web-profile-builder-for-web-application-projects.aspx](http://weblogs.asp.net/joewrobel/archive/2008/02/03/web-profile-builder-for-web-application-projects.aspx)

[http://weblogs.asp.net/jgalloway/archive/2008/01/19/writing-a-custom-asp-net-profile-class.aspx](http://weblogs.asp.net/jgalloway/archive/2008/01/19/writing-a-custom-asp-net-profile-class.aspx)

# c - 整数溢出

> ID：837215
> 
> 赞同：0
> 
> 时间：2009-05-07T21:49:12.707
> 
> 标签：c, overflow

我有一个 unsigned long long 用于跟踪音量。音量增加另一个 unsigned long long。每 5 秒我打印出这个值，当该值达到 32 位无符号最大值时， printf 给我一个负值。代码片段如下：

```
unsigned long long vol, vold;
char               voltemp[10];

vold = 0; 
```

之后...

```
while (TRUE) {
    vol = atoi(voltemp);
    vold += vol;    
    fprintf(fd2, "volume = %llu);
} 
```

我究竟做错了什么？这在 RedHat 4 2.6.9-78.0.5.ELsmp gcc 版本 3.4.5 下运行

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T22:06:40.793

既然您说它打印的是负值，那么除了您使用 of`atoi`而不是之外，肯定还有其他问题`strtoull`。格式说明`%llu`符只是不打印负值。

看起来问题出在`fprintf`电话上。检查您是否包含`stdio.h`以及参数列表确实是源代码中的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T21:53:17.363

好吧，我真的不能说，因为你的代码有语法错误，但这里有一个猜测：

```
vol = atoi(voltemp); 
```

atoi 将 ascii 转换为整数。您可能想尝试[atol](http://www.cplusplus.com/reference/clibrary/cstdlib/atol/)但这只会让它变得很长，而不是很长。

您的 C 标准库可能有[atoll](http://www.codecogs.com/reference/stdlib.h/atol.php?alias=atoll)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T21:58:33.793

如果数字可以超过有符号整数的范围，则不能使用 atoi。

编辑：如建议的那样，[环礁](http://www.opengroup.org/onlinepubs/009695399/functions/atol.html)（显然是标准的）是另一个不错的选择。请记住，这限制了你的`signed`长。实际上，最简单的选项是[strtoull](http://www.opengroup.org/onlinepubs/000095399/functions/strtoul.html)，这也是标准的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T21:59:47.300

您确定 fprintf 可以将 longlong 作为参数而不是指向它的指针吗？看起来它正在将您的 longlong 转换为 int 在传递之前。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-07T22:15:42.473

我猜问题是 printf 没有像你想象的那样处理 %llu 。它可能只从堆栈中取出 32 位，而不是 64 位。

%llu 是自 C99 以来的唯一标准。也许您的编译器更喜欢 %LU？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-08T02:04:21.377

为了澄清 fprintf 语句被错误地复制（我的错误，对不起）。fprintf 语句实际上应该是：

```
 fprintf(fd2, "volume = %llu\n", vold); 
```

此外，虽然不可否认，数组 voltemp 的最大长度是 9 个字节（数字），这完全在 32 位整数的范围内。

当我将这段代码从程序中提取出来并在测试程序中运行时，我得到了我期望的结果，这令人费解。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-09T01:38:09.630

如果`voltemp`真的很大，您将需要使用`strtoull`，而不是`atoi`。

# apache-flex - Flex/AS3 监听从单例类派发的事件的问题

> ID：837219
> 
> 赞同：0
> 
> 时间：2009-05-07T21:49:53.267
> 
> 标签：apache-flex, actionscript-3, events, flex3, singleton

我有一个用于全局访问配置信息的单例类。这个名为 ConfigurationData 的单例类扩展了 EventDispatcher。这是类（请注意，我省略了一些东西，比如变量声明以保持简短）：

```
/**
* Dispatched when the config file has been loaded.
*/
[Event (name="configurationLoaded", type="flash.events.Event")]

/**
* Dispatched when the config file has been loaded.
*/
[Event (name="configurationLoadFailed", type="flash.events.Event")]

public class ConfigurationData extends EventDispatcher{
    // Event name constants.
    public static const CONFIGURATION_LOADED:String = "configurationLoaded";
    public static const CONFIGURATION_LOAD_FAILED:String = "configurationLoadFailed";

    // The singleton instance.
    private static var singleton:ConfigurationData;

    /**
    * Don't call the constructor directly, use getInstance() instead.
    */
    public function ConfigurationData(pvt:PrivateClass){
        // init
    }

    /**
     * Get the singleton ConfigurationData. 
     * @return The ConfigurationData instance.
     */
    public static function getInstance():ConfigurationData{
           if ( !ConfigurationData.singleton ) ConfigurationData.singleton = new ConfigurationData(new PrivateClass());
           return ConfigurationData.singleton;
       }

       public function initialize():void{
        var configureService:HTTPService = new HTTPService;
        configureService.url = _config_base_url + _config_path;
        configureService.addEventListener(FaultEvent.FAULT, onConfigureFault);
        configureService.addEventListener(ResultEvent.RESULT, onConfigureResult);
        configureService.send();
       }

       private function onConfigureResult(event:ResultEvent):void{
        var i:int = 0;
        for(i=0; i<event.result.carriers.carrier.length; i++){
            _mobile_carriers.addItem({label:event.result.carriers.carrier[i].name, data:event.result.carriers.carrier[i].id});
        }
        dispatchEvent(new Event(CONFIGURATION_LOADED));
    }

    private function onConfigureFault(event:FaultEvent):void{
        _mobile_carriers = _default_carriers as ArrayCollection;
        dispatchEvent(new Event(CONFIGURATION_LOAD_FAILED));
    }
}

// This class is used to ensure that the ConfigurationData constructor can't be called directly,
// getInstance() must be used instead. 
class PrivateClass {
    public function PrivateClass() {}
} 
```

然后我有一个 MXML 组件来监听 CONFIGURATION_LOADED 事件：

```
ConfigurationData.getInstance().addEventListener(Event.CONFIGURATION_LOADED, onConfigurationLoaded); 
```

出于某种原因，这会产生以下错误：1119：通过静态类型 Class 的引用访问可能未定义的属性 CONFIGURATION_LOADED。

有谁知道如何解决这个问题，以便我可以收听该事件？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-07T22:00:22.120

您正在尝试访问 Event 类上不存在的静态 const: `Event.CONFIGURATION_LOADED`。

在这种情况下，您需要创建一个自定义 Event 类：

```
public class ConfigurationEvent extends Event
{   
    public static const CONFIGURATION_LOADED:String = "configurationLoaded";
    public static const CONFIGURATION_LOAD_FAILED:String = "configurationLoadFailed";

    public function ConfigurationEvent(type:String)
    {
         super(type);
    }
} 
```

调度和收听这些自定义事件，而不是`Event.CONFIGURATION_LOADED`：

```
dispatchEvent(new ConfigurationEvent(ConfigurationEvent.CONFIGURATION_LOAD_FAILED));

ConfigurationData.getInstance().addEventListener(ConfigurationEvent.CONFIGURATION_LOADED, onConfigurationLoaded); 
```

# c# - 在 C++ 和 C# 中，多个条件检查是按预定顺序还是随机顺序执行的？

> ID：837226
> 
> 赞同：7
> 
> 时间：2009-05-07T21:51:56.070
> 
> 标签：c#, c++, deterministic, non-deterministic

情况：在 C++ 或 C# 中使用许多条件检查条件：

```
if (condition1 && condition2 && condition3)
{
    // Do something
} 
```

我一直认为执行这些检查的顺序并不能保证。所以不一定是第一个条件1，然后是条件2，然后才是条件3。我在使用 C++ 的时候就学会了它。我想我被告知或在某处读过它。

直到知道我一直编写安全代码来解释以下情况下可能出现的空指针：

```
if ((object != null) && (object.SomeFunc() != value))
{
    // A bad way of checking (or so I thought)
} 
```

所以我在写：

```
if (object != null)
{
    if (object.SomeFunc() != value)
    {
        // A much better and safer way
    }
} 
```

因为我不确定非空检查是否会首先运行，然后才会调用实例方法来执行第二次检查。

现在，我们最伟大的社区人士告诉我，这些检查的执行顺序保证以从左到右的顺序运行。

我很惊讶。C++ 和 C# 语言真的如此吗？

有人听过我以前听过的版本吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-07T21:55:12.163

短路评估是从左到右的简短答案。顺序是可以预测的。

```
// perfectly legal and quite a standard way to express in C++/C#
if( x != null && x.Count > 0 ) ... 
```

某些语言在分支之前评估条件中的所有内容（例如 VB6）。

```
// will fail in VB6 if x is Nothing. 
If x Is Not Nothing And x.Count > 0 Then ... 
```

参考：MSDN [C# 运算符](http://msdn.microsoft.com/en-us/library/6a71f45d.aspx)及其顺序或优先级。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T21:55:48.993

它们被定义为从左到右进行评估，**并**在其中一个评估为假时停止评估。在 C++ 和 C# 中都是如此。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T21:56:43.267

我认为没有或曾经有任何其他方式。这就像编译器决定无缘无故地乱序运行语句。:) 现在，某些语言（如 VB.NET）具有用于短路和不短路的不同逻辑运算符。但是，顺序总是在编译时很好地定义。

这是C# 语言规范中的[运算符优先级。](http://msdn.microsoft.com/en-us/library/aa691323(VS.71).aspx)从规格...

> 除赋值运算符外，所有二元运算符都是左结合的，这意味着运算是从左到右执行的。例如，x + y + z 被计算为 (x + y) + z。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T21:57:25.760

它们必须从左到右进行。这允许短路评估工作。

有关更多信息，请参阅[维基百科文章](http://en.wikipedia.org/wiki/Short-circuit_evaluation)。

# django - 如何检查 Django 模板中的最后一个循环迭代？

> ID：837237
> 
> 赞同：114
> 
> 时间：2009-05-07T21:55:30.557
> 
> 标签：django, for-loop, django-templates

我有一个基本问题，在 Django 模板语言中，你如何判断你是否处于循环中的最后一个循环迭代`for`？

* * *

## 回答 #1

> 赞同：250
> 
> 时间：2009-05-07T21:59:12.700

你会使用[`forloop.last`](http://docs.djangoproject.com/en/dev/ref/templates/builtins/#for). 例如：

```
<ul>
{% for item in menu_items %}
    <li{% if forloop.last %} class='last'{% endif %}>{{ item }}</li>
{% endfor %}
</ul> 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-07T22:00:06.940

{{ forloop.last }}

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-07-21T19:23:02.620

您基本上可以在`for`循环中使用此逻辑：

```
{% if forloop.last %}
   # Do something here
{% endif %} 
```

例如，如果您需要在除最后一项之外的每个项目之后放置一个逗号，则可以使用以下代码段：

```
 {% for item in item_list %}
    {% if forloop.last %}
        {{ item }}
    {% else %}
         {{ item }},
    {% endif %}
  {% endfor %} 
```

这将成为一个包含三个项目的列表：

```
first_item, second_item, third_item 
```

# antivirus - 模仿类似病毒的行为？

> ID：837248
> 
> 赞同：4
> 
> 时间：2009-05-07T21:57:08.740
> 
> 标签：antivirus, virus, emulation

我正在寻找一种方法来模拟类似病毒的行为，以测试防病毒软件中的排除项。谁能推荐一些我可以放在一个快速脚本中的行为来触发典型的实时反病毒扫描程序？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-07T22:11:25.463

您是否正在寻找类似[Eicar 测试文件](http://www.eicar.org/anti_virus_test_file.htm)的内容？

如果您想手动编写类似病毒的行为，我可以告诉您，我在使用防病毒应用程序以及[LowLevelKeyboardProc()](http://msdn.microsoft.com/en-us/library/ms644985(VS.85).aspx)和[SetWindowsHookEx()](http://msdn.microsoft.com/en-us/library/ms644990(VS.85).aspx)函数时遇到了问题。如果防病毒应用程序使用启发式方法，它通常会警告类似键盘记录器的操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-07T22:02:04.673

大多数防病毒程序都在签名数据库上工作，而不是启发式检测，因此大多数防病毒程序根本不会注意到任何事情，除非您编写的程序与他们正在寻找的签名具有相同的签名。

如果您确实有基于启发式的检测程序，只需尝试一些明显的病毒行为，例如修改控制启动时启动哪些程序的设置、检查进程以获取常见的防病毒程序名称等。您可以查找特定程序的文档并准确找出它用于根据行为尝试检测病毒的启发式方法。仅仅盲目地触发“病毒可能会做这样的事情”行为将很难找到很多用处。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T22:09:25.640

早在 2000 年就出现了[ILOVEYOU](http://en.wikipedia.org/wiki/ILOVEYOU)病毒（love bug），它只是一个 VBScript，它用自身的副本覆盖受感染机器上的文件，并通过 Outlook 将自身通过电子邮件发送出去。Outlook 漏洞已得到修复，但是关于在特定扩展名的所有文件上复制自身的部分是一个很好的尝试和复制的启发式方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-07T22:44:02.497

这是一篇关于基于行为的检测的有趣文章，它很旧，但听起来这可能是您想要做的。

[http://www.securityfocus.com/infocus/1557](http://www.securityfocus.com/infocus/1557)

您还可以查看[SARC](http://www.symantec.com/business/security_response/index.jsp)（赛门铁克防病毒研究中心）。如果您查看一些最新的威胁，技术细节和删除说明会提示您它们在感染系统时会做什么。

这是一个例子：

[http://www.symantec.com/business/security_response/writeup.jsp?docid=2009-050707-0639-99](http://www.symantec.com/business/security_response/writeup.jsp?docid=2009-050707-0639-99)

# wpf - 如何全局存储一些对象？

> ID：837249
> 
> 赞同：2
> 
> 时间：2009-05-07T21:57:23.407
> 
> 标签：wpf

我是 WPF 新手，习惯于 ASP.NET。我有一个需要登录屏幕的 WPF 应用程序。通过应用程序的其余部分，我希望能够访问包含一些凭据信息的“会话”对象。如何存储它以便我的应用程序中的任何视图都可以访问该对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T22:06:19.327

Application 对象有一个 Properties 属性，允许您存储和检索应用程序范围的对象。

在这里更好地解释： [如何：获取和设置应​​用程序范围属性](http://msdn.microsoft.com/en-us/library/aa348545.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T22:06:26.427

有几种方法可以做到这一点。

1.  您可以创建一个静态类，也许您可​​以将其称为“会话”，其中包含您感兴趣的数据。会话可能有一个包含您感兴趣的数据的字典。

2.  您可以在主窗体中保存数据，并让主窗体将数据容器传递给每个视图。

如果您可以提供有关实现和用例的更多详细信息，则可能有更好的方法来执行此操作，这些方法更符合您的设计目标。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T06:07:05.740

您还可以使用轻量级容器以松散耦合的方式全局存储对象，并使用依赖注入模式检索这些对象。

轻量级容器的实现之一是来自 Microsoft ( [http://www.codeplex.com/unity](http://www.codeplex.com/unity) ) 的 Unity Application Block，因此您可以从那里开始并[在此处](http://msdn.microsoft.com/en-us/magazine/cc163739.aspx)和[此处](http://mokosh.co.uk/post/2009/04/18/prism-2-wpf-and-silverlight-inversion-of-control/)阅读更多内容。

# python - 如何从 Ruby 调用 Python 代码？

> ID：837256
> 
> 赞同：5
> 
> 时间：2009-05-07T21:59:01.717
> 
> 标签：python, ruby

是否存在易于使用的 Ruby 到 Python 的桥接器？还是我最好使用 system()？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-07T22:12:39.470

您可以尝试[Masaki Fukushima 的](http://www.goto.info.waseda.ac.jp/~fukusima/ruby/python-e.html)将 python 嵌入到 ruby​​ 中的库，尽管它似乎没有得到维护。YMMV

> 有了这个库，Ruby 脚本可以直接调用任意 Python 模块。扩展模块和 Python 编写的模块都可以使用。

来自巧妙的为什么幸运的僵硬也可能有用的有趣地命名为[Unholy ：](http://github.com/why/unholy/tree/master)

> 将 Ruby 编译为 Python 字节码。
> 此外，
> 使用 Decompyle（包括在内）将该字节码转换回 Python 源代码。
> 
> 需要 Ruby 1.9 和 Python 2.5。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-03-16T20:00:02.640

宝石安装 ruby​​python

[rubypython 主页](http://rubypython.rubyforge.org/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-07T22:08:15.453

我认为没有任何方法可以在不通过 system() 或其他方式分叉进程的情况下从 Ruby 调用 Python。语言运行时间完全不同，无论如何它们都需要在单独的进程中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-31T01:52:50.533

如果您想使用 Python 代码，就像您的 Python 脚本是一个函数一样，请尝试 IO.popen 。

如果您想使用 python 脚本“reverse.py”反转数组中的每个字符串，您的 ruby​​ 代码将如下所示。

```
strings = ["hello", "my", "name", "is", "jimmy"]
#IO.popen: 1st arg is exactly what you would type into the command line to execute your python script.
#(You can do this for non-python scripts as well.)
pythonPortal = IO.popen("python reverse.py", "w+")
pythonPortal.puts strings #anything you puts will be available to your python script from stdin
pythonPortal.close_write

reversed = []
temp = pythonPortal.gets #everything your python script writes to stdout (usually using 'print') will be available using gets
while temp!= nil
    reversed<<temp
    temp = pythonPortal.gets
end 

puts reversed 
```

然后你的 python 脚本看起来像这样

```
import sys

def reverse(str):
    return str[::-1]

temp = sys.stdin.readlines() #Everything your ruby programs "puts" is available to python through stdin
for item in temp:
    print reverse(item[:-1]) #Everything your python script "prints" to stdout is available to the ruby script through .gets
    #[:-1] to not include the newline at the end, puts "hello" passes "hello\n" to the python script 
```

输出：olleh ym eman si ymmij

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-08T01:35:03.053

要运行 python 代码，解释器需要作为进程启动。所以 system() 是你最好的选择。

为了调用 python 代码，你可以使用 RPC 或网络套接字，得到最简单的可能工作的东西。

# sql - 存储/计算用户分数的最佳方法是什么？

> ID：837257
> 
> 赞同：7
> 
> 时间：2009-05-07T21:59:10.127
> 
> 标签：sql, mysql, database, database-design

我正在为一个网站设计一个数据库，用户将能够通过执行某些活动获得积分（声誉），并且正在努力进行数据库设计。

我计划记录用户所做的事情，这样他们提交的项目可能有 25 分，他们发表的 30 条评论每人 1 分，另外 10 分因为很棒！

显然，所有数据都将在那里，但似乎很多或查询以获得我想在他们的用户名旁边显示的每个用户的总分（以级别的形式）。例如，查询提交的项目表以从该用户获取每个项目的分数，查询评论表等。如果所有这些都需要为页面上提到的每个用户完成......很多查询！

我曾考虑在用户表中保留一个分数，这样查找起来似乎要快得多，但我已经意识到存储可以从其他数据中计算出来的数据是**不好的！**

我见过很多做类似事情的网站（甚至堆栈溢出也类似），所以我认为必须遵循“最佳实践”。谁能建议它可能是什么？

任何建议或意见都会很棒。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-07T23:41:23.780

我认为这绝对是一个很好的问题。我必须构建具有与此类似行为的系统 - 特别是当经常访问其中包含分数的表时（就像在您的场景中一样）。这是我给你的建议：

首先，创建一些如下所示的表（我使用的是 SQL Server 最佳实践，但可以随意命名它们）：

```
UserAccount          UserAchievement
 -Guid (PK)           -Guid (PK)
 -FirstName           -UserAccountGuid (FK)
 -LastName            -Name
 -EmailAddress        -Score 
```

完成此操作后，继续创建一个如下所示的视图（不，我尚未验证此 SQL，但它应该是一个好的开始）：

```
SELECT [UserAccount].[FirstName]      AS FirstName,
       [UserAccount].[LastName]       AS LastName,
       SUM([UserAchievement].[Score]) AS TotalPoints
FROM [UserAccount]
INNER JOIN [UserAchievement]
     ON [UserAccount].[Guid] = [UserAchievement].[UserAccountGuid]
GROUP BY [UserAccount].[FirstName],
         [UserAccount].[LastName]
ORDER BY [UserAccount].[LastName] ASC 
```

我知道您已经提到了对性能和大量查询的一些担忧，但是如果您构建这样的视图，您将永远不需要超过一个。我建议不要将其作为物化视图；相反，只需索引您的表，以便您需要的查找（本质上是 UserAccountGuid）将启用整个表的快速求和。

我还要补充一点——如果你的 UserAccount 表变得很大，你可以考虑一个稍微更智能的查询，它将包含你需要汇总的帐户的名称。当您只在页面上显示 3-10 个用户的信息时，这将使您不会将大量数据集返回到您的网站。我必须更多地考虑如何优雅地做到这一点，但我建议远离“IN”语句，因为这将调用表的线性搜索。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T22:05:15.790

对于非常高的读/写比率，非规范化是一个非常有效的选项。您可以使用索引视图，并且数据将以声明方式保持同步（因此您永远不必担心有坏分数数据）。缺点是它保持同步。所以对商店总数的更新是提交分数操作的同步方面。这通常会很快，但这是一个设计决定。如果您对自己进行非规范化，您可以选择是否想要某种延迟更新系统。

就我个人而言，我会使用索引视图作为开始，然后如果你需要的话，你可以用一个具体的表相当无缝地替换它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T22:22:55.513

过去，我们总是使用某种夜间或定期 cron 作业来计算当前分数并将其保存在数据库中 - 有点像活动表上 SUM 的持久视图。像大多数“最佳实践”一样，它们只是指导方针，在非常特定的领域偏离特定的硬性实践通常会更好、更实用。

另外，如果您使用 cron 作业，这实际上并没有太大的偏差，因为它最好被视为存储在数据库中的缓存。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T23:11:33.820

如果您有一个单独的分数表，您可以在每次提交项目或用户发表评论时更新它。您可以使用触发器或在站点代码中执行此操作。

用户分数会不断更新，可以快速查询显示。

# c++ - 为什么 C/C++ 中没有 ^^ 运算符？

> ID：837265
> 
> 赞同：16
> 
> 时间：2009-05-07T22:00:53.053
> 
> 标签：c++, c, operators, language-design, xor

`&`有`&&`。`|`有`||`。为什么`^`没有`^^`？

我知道它不会短路，但它会有不同的语义。在 C 中，`true`实际上是任何非零值。按位异或并不总是与逻辑异或相同：

```
int a=strcmp(str1,str2);// evaluates to 1, which is "true"
int b=strcmp(str1,str3);// evaluates to 2, which is also "true"
int c=a ^^ b; // this would be false, since true ^ true = false
int d=a ^ b; //oops, this is true again, it is 3 (^ is bitwise) 
```

既然你不能总是依赖一个真正的价值是`1`or `-1`，那么`^^`运算符不是很有帮助吗？我经常不得不做这样奇怪的事情：

```
if(!!a ^ !!b) // looks strange 
```

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-05-07T22:44:09.550

[Dennis Ritchie answers](https://web.archive.org/web/20100213061432/http://www.it.usyd.edu.au/%7Edasymond/mirror/c-faq/misc/xor.dmr.html)

> There are both historical and practical reasons why there is no `^^` operator.
> 
> The practical is: there's not much use for the operator. The main point of `&&` and `||` is to take advantage of their short-circuit evaluation not only for efficiency reasons, but more often for expressiveness and correctness.
> [...]
> By contrast, an `^^` operator would always force evaluation of both arms of the expression, so there's no efficiency gain. Furthermore, situations in which `^^` is really called for are pretty rare, though examples can be created. These situations get rarer and stranger as you stack up the operator--
> 
> ```
> if (cond1() ^^ cond2() ^^ cond3() ^^ ...) ... 
> ```
> 
> does the consequent exactly when an odd number of the `condx()`s are true. By contrast, the `&&` and `||` analogs remain fairly plausible and useful.

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-05-07T22:04:23.623

从技术上讲，一个已经存在：

```
a != b 
```

因为如果操作数的真值不同，这将评估为真。

### 编辑：

[沃尔特](https://stackoverflow.com/users/89709/volte)的评论：

```
(!a) != (!b) 
```

是正确的，因为我上面的答案不适用于`int`类型。如果他添加他的答案，我将删除我的。

### 再次编辑：

Maybe I'm forgetting something from C++, but the more I think about this, the more I wonder why you would ever write `if (1 ^ 2)` in the first place. The purpose for `^` is to exclusive-or two numbers together (which evaluates to another number), not convert them to boolean values and compare their truth values.

This seems like it would be an odd assumption for a language designer to make.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-07T22:04:01.813

对于非`bool`操作数，我想你想要的是`a ^^ b`被评估为：

```
(a != 0) ^ (b != 0) 
```

好吧，您有上述选项，并且您在其他答案中列出了一些选项。

运算符`^^`对于操作数来说是多余的`bool`。仅谈论布尔操作数，为了争论，让我们假设它`^`是按位的并且`^^`以逻辑 XOR 的形式存在。然后，您有以下选择：

*   `&` - 按位与 -- 总是计算两个操作数
*   `&&`- 逻辑与 - 并不总是评估两个操作数
*   `|` - 按位或 - 总是计算两个操作数
*   `||`- 逻辑或 - 并不总是评估两个操作数
*   `^` - 按位异或 - 必须始终评估两个操作数
*   `^^`- 逻辑异或 - 必须始终评估两个操作数

他们为什么不创建`^^`本质上将数值转换为`bool`s 然后充当 s `^`？这是个好问题。也许是因为它比`&&`and更容易混淆，也许是因为你可以很容易地用其他运算符`||`构造等价的运算符。`^^`

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-07T22:28:59.210

I can't say what was in the heads of Kernighan and Ritchie when they invented C, but you made a brief reference to "wouldn't be short-circuiting", and I'm guessing that's the reason: It's not possible to implement it consistently. You can't short-circuit XOR like you can AND and OR, so ^^ could not fully parallel && and ||. So the authors might well have decided that making an operation that sort of kind of looks like its parallel to the others but isn't quite would be worse than not having it at all.

Personally, the main reason I use && and || is for the short-circuit rather than the non-bitwise. Actually I very rarely use the bitwise operators at all.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-08T05:59:30.500

Another workaround to the ones posted above (even if it requires another branch in the code) would be:

```
if ( (a? !b : b ) ) 
```

that is equivalent to xor.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-08T07:40:05.330

In Java the `^` operator indeed does do logical XOR when used on two boolean operands (just like `&` and `|` in Java do non-short-circuiting logical AND and OR, respectively, when applied to booleans). The main difference with C / C++ is that C / C++ allows you to mix integers and booleans, whereas Java doesn't.

But I think it's bad practice to use integers as booleans anyway. If you want to do logical operations, you should stick to either `bool` values, or integers that are either 0 or 1\. Then `^` works fine as logical XOR.

An analogous question would be to ask, how would you do non-short-circuiting logical AND and OR in C / C++? The usual answer is to use the `&` and `|` operators respectively. But again, this depends on the values being `bool` or either 0 or 1\. If you allow any integer values, then this does not work either.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-08T07:51:50.263

Regardless of the case for or against `^^` as an operator, you example with `strcmp()` sucks. It does not return a truth value (true or false), it returns a relation between its inputs, encoded as an integer.

Sure, any integer can be interpreted as a truth value in C, in which case 0 is "false" and all other values are "true", but that is the opposite of what `strcmp()` returns.

Your example should begin:

```
int a = strcmp(str1, str2) == 0; // evaluates to 0, which is "false"
int b = strcmp(str1, str3) == 0; // evaluates to 0, which is also "false" 
```

You must compare the return value with 0 to convert it to a proper boolean value indicating if the strings were equal or not.

With "proper" booleans, represented canonically as 0 or 1, the bitwise `^` operator works a lot better, too ...

# c++ - 安全存储 list::iterator 供以后使用吗？

> ID：837267
> 
> 赞同：9
> 
> 时间：2009-05-07T22:02:10.633
> 
> 标签：c++, list, stl, iterator

假设我有一个列表，其中没有添加或删除新节点。但是，节点可能会被打乱。

保存一个迭代器，指向列表中的一个节点，并在以后任意时间访问它是否安全？

编辑（后续问题）： list::splice() 的文档说它从参数列表中删除了元素。这是否意味着如果我调用 splice，使用与函数参数相同的列表，现有的迭代器将失效？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-07T22:06:22.353

是的。
除非从列表中删除他们指向的项目（比喻地说），否则迭代到列表中的标准受让人不会失效。

从这个页面： [http ://www.sgi.com/tech/stl/List.html](http://www.sgi.com/tech/stl/List.html)

```
Lists have the important property that insertion and splicing do not
invalidate iterators to list elements, and that even removal invalidates
only the iterators that point to the elements that are removed. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T22:06:35.037

是的，`std::list`迭代器只是指向节点的指针。您可以在列表中插入、删除（其他节点）和重新排列节点，并且迭代器不会失效。

# c# - 如何通过代码更改代理服务器

> ID：837269
> 
> 赞同：3
> 
> 时间：2009-05-07T22:02:25.797
> 
> 标签：c#, proxy

要更改代理服务器，我必须转到 IE->Internet 选项->LAN 设置，然后单击“为 LAN 使用代理服务器”。我相信有一些方法可以通过代码做到这一点。有人知道怎么做（C#）吗？

非常感谢。

真诚的，弗拉德

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T23:14:19.150

如果您要创建一个批处理文件，然后在桌面上创建一个指向它的快捷方式，然后使用 ctrl+alt+n 之类的东西进行热链接怎么办？

这批看起来像这样：

[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet 设置] "ProxyEnable"=dword:00000001 "ProxyServer"="10.22.40.6:3128"

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T22:14:58.870

如果您想设置代理以供您的代码使用，您可以通过[GlobalProxySelection.Select](http://msdn.microsoft.com/en-us/library/system.net.globalproxyselection.select.aspx)属性进行设置。

但是，Microsoft 不建议手动设置代理，并建议始终使用默认代理。

# asp.net - 在asp.net中向客户端导出大量数据

> ID：837273
> 
> 赞同：5
> 
> 时间：2009-05-07T22:03:25.280
> 
> 标签：asp.net, sql-server, dataset

我需要通过网络将大量数据（~100mb）从 sql 表导出给用户。这样做的最佳解决方案是什么？一种想法是将数据导出到数据库服务器上的文件夹，压缩它（通过某种方式），然后为用户提供下载链接。还有其他方法吗？另外，我们可以从 sql server 中压缩数据吗？

欢迎任何方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-23T19:05:09.890

即使对于高速用户，我也不会占用数据库等待用户下载 100Mb。当用户请求文件时，让他们指定一个电子邮件地址。然后调用异步进程来提取数据，将其写入临时文件（毕竟内存中不希望 > 100mb），然后将临时文件压缩到存储位置，然后向用户发送一封包含下载链接的电子邮件文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-07T22:24:57.677

您可以使用文件响应页面请求：

```
Response.AddHeader("Content-Disposition", 
    "attachment; filename=yourfile.csv");
Response.ContentType = "text/plain"; 
```

请务必关闭缓冲，以便 IIS 可以在您构建第二部分时开始发送文件的第一部分：

```
Response.BufferOutput = false; 
```

之后，您可以开始编写文件，如下所示：

```
Response.Write("field1,field2,field3\r\n"); 
```

文件完全写入后，结束响应，因此 ASP.NET 不会将网页附加到您的文件中：

```
Response.End(); 
```

这样，您不必在 Web 服务器上写入文件，只需在内存中创建文件并将它们发送给您的用户。

如果需要压缩，你可以用同样的方法写一个 ZIP 文件。这是一个不错的[免费库](http://www.icsharpcode.net/OpenSource/SharpZipLib/)，用于创建 ZIP 文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T22:16:48.053

下载链接是一个完全有效且合理的解决方案。另一种方法是自动将用户重定向到该文件，这样他们就不需要单击链接。这实际上取决于您的工作流程和 UI 体验。

我建议不要在 SQL Server 引擎中实现压缩。而是查看 DotNetZip 库（或 System.IO.Conpression，如果您认为您的用户具有解压缩 gzip 存档的能力）并在 Web 应用程序中实现压缩。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T22:19:44.803

如果 XML 可以，一种方法是选择数据“FOR XML”，如下所示： [http ://www.sqljunkies.ddj.com/Article/296D1B56-8BDD-4236-808F-E62CC1908C4E.scuk](http://www.sqljunkies.ddj.com/Article/296D1B56-8BDD-4236-808F-E62CC1908C4E.scuk)

然后将原始 XML 作为 content-type: text/xml 直接输出到浏览器。还要确保在您的 Web 服务器上为具有 XML 扩展名的文件设置 Gzip 压缩。 [http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/502ef631-3695-4616-b268-cbe7cf1351ce.mspx?mfr=true](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/502ef631-3695-4616-b268-cbe7cf1351ce.mspx?mfr=true)

这会将 XML 文件缩小到传输大小的 1/3 或 1/4。由于 XML 文件中固有的浪费空间，这不是性能最高的选项，但很大程度上取决于您最终要寻找的格式。

另一种选择是使用免费的 CSharpZipLib 将 XML（或您想要的任何格式）压缩成用户可以下载的 zip 文件。沿着这些思路，如果这是经常使用的东西，您可能需要考虑缓存并将 zip 文件存储在具有某种到期时间的 Web 服务器上，以便不会为每个请求重新生成它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-07T22:26:42.057

您的方法效果很好。如果您需要多次执行此过程，SSIS + 7zip 可能对自动化流程很有用。

# wcf - 在 WCF 中是否可以将委托传递给远程对象？

> ID：837274
> 
> 赞同：1
> 
> 时间：2009-05-07T22:03:39.570
> 
> 标签：wcf, .net-3.5, delegates

是否可以将委托从客户端传递给 WCF 远程对象并让远程对象执行委托？

我猜不会，因为 delgate 是客户端进程的函数指针。

我的目标是有一个接口结构，我可以“订阅”从客户端到接口的事件。我会将一个委托从客户端传递到接口，并且我希望接口能够执行该事件。

这个想法是让界面能够以程序集或远程方式加载，并使代码工作相同。

如果我不能通过委托，我该如何实现事件结构？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-07T22:15:42.863

C# 本身不是“委托”，但在 WCF 中，您有双工绑定以启用从服务端到客户端的回调

[http://msdn.microsoft.com/en-us/library/system.servicemodel.wsdualhttpbinding.aspx](http://msdn.microsoft.com/en-us/library/system.servicemodel.wsdualhttpbinding.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T05:25:02.847

我怀疑你能否想出一种有凝聚力的方法来将委托从 C# 客户端传递到 Java 服务实现并让它正确执行......

WCF**不是**严格的 .NET 实现，因此必须处理互操作问题。它不能依赖于会话的两端都在 .NET 中的假设——这就是为什么你不应该在服务器和客户端之间抛出自定义异常（异常是 .NET 构造）——你需要使用 SOAP 错误（其中是可互操作的）。

所以我不认为你想做的事情可以通过一个代表来完成——你必须想出另一种方法来实现你的目标。

马克

# java - 如何应对无能的管理

> ID：837276
> 
> 赞同：7
> 
> 时间：2009-05-07T22:04:11.737
> 
> 标签：java, oop

我正在做的一个项目已经完成，所以我被转移到我雇主的一些新任务上。以前的工作非常敏捷，团队小，程序进度等等。

所以无论如何，我正在进行的新项目 - 我发现自己对如何处理管理感到困惑。他们对面向对象编程、当前技术或方法没有真正的了解。他们似乎害怕改变，就在最近我们搬到了最新的 JRE

我们进行这些代码审查，我必须听“灰胡子”说它在 ADA 中有多好，或者他们过去是如何用 C 来做事的。但是当他们尝试进行代码审查时——他们甚至缺乏对OOP 设计和开发。他们更关注代码的风格；间距; 方法名称；等等

一位资深人士说，我们应该编写自己的记录器，而不是使用 log4j，因为很久以前在学术 PDF 中对 log4j 的一篇负面评论。

我该如何处理？我如何向他们解释他们的设计是错误的，或者他们真的落后于时代，而不会让人觉得他们是个混蛋。我只在这个组织工作了大约一年——所以我不知道我会有多少可信度。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-07T22:15:42.427

关于代码审查，我想说让他们高兴。以他们喜欢的方式命名和分隔事物。当然，将您的时间集中在更好的设计上，并享受对 ADA 的回忆，它仍然可以为您提供一些关于当今事物的背景以及它们如何到达那里的背景。

换句话说，不要太认真地对待那部分。担心什么对完成工作很重要。在这种情况下，工作是让那些重要的人觉得你为项目做出了积极的贡献。

关于 Log4j，我只是建议一个不同的框架。内置的 JDK 日志记录（不能抱怨，它是内置的 API）或类似 SLF 的东西，它可以让你插入任何你想要的东西（包括你自己的，我猜，然后你可以扔掉并替换它当他们意识到这是一个错误时，用一些真实的东西，你只需要更改类路径）。

现在会有重要的时候。在这种情况下，尽可能地让它听起来是他们的想法。例如，在日志中，声明有许多日志框架代表很多代码行，你想知道是否有其他方法可以在这个项目中利用这些工作，然后让他们“弄清楚”解决方案。

有时您必须将某些东西作为您的想法来推动-没有其他方法。在这种情况下，坚持证据，通过与那些在良好信誉中具有影响力的人保持关系，尽可能多地与军事盟友保持关系，并意识到你每打一场战斗，你就会失去位置，即使你赢了（也许特别是如果你赢了） .

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-07T22:10:31.517

我建议将您的担忧作为“建议”来处理。提出建议并征求他们的意见，即使你已经播下种子并指导谈话，他们也会觉得他们仍然在控制之中。

不管你在一个组织工作了多久，你在那里并且你在那里是有原因的（他们雇用你是为了你的意见）。找到您的声音以及如何最好地向您的团队成员提出建议和/或疑虑。这是成为团队成员的关键部分，会增加你的价值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-07T22:16:11.177

获得一个好的格式化程序并为您创建他们无法抱怨的方法名称，然后您的讨论可以转移到实际问题上。

有些人在审查过程中无法克服这些小细节，所以你需要让它成为一个非问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-07T22:37:58.940

你的工作必须获得可信度，然后他们才会听你的。所以是的，按照其他人的建议去做，并确保遵守不重要的格式规则。但也要做如此高质量的工作，他们不能忽视或边缘化你。尝试以使他们认为想法来自他们的方式来引导他们。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-07T22:33:05.253

我不同意除 log4j 之外的另一个日志框架的建议。引用一篇旧评论，没有任何个人经验，不应该在这里赢得胜利。

但是，可能有一种方法可以将其转化为您的优势。如果您同意并推荐 JDK 或 Apache Commons 日志中内置的日志，您会发现两者非常相似，并且实际上可以使用 log4j 作为其底层实现。

如果您的对手没有给予太多关注，您可能会因屈服和避免自行车棚争论而赢得积分，并且仍然会得到您想要的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-21T21:05:14.877

我说尊重你的长辈！:)

不过真的，请记住，当你穿着尿布时，很多这些灰胡子可能正在编程。这并不能使他们成为最新技术的专家，但至少应该赢得您的尊重。有时，如果您能找到一种方法来超越所有的折边和折边以及“回到我的时代”的东西，您可以从那些老狗那里获得一些智慧的珍珠！

现在从编程的角度来看，似乎 Yishai 是对的。符合他们想要的编码风格应该很容易，一旦你让他们满意，你就可以按照你想要的方式运行代码。

如果您必须提出相反的意见，请支持它。如果您想使用 log4j 之类的东西，请谈谈您过去使用过的特定项目并且它运行良好，并提供帮助任何人解决他们遇到的任何问题等。

请记住，虽然您认为老灰胡子不知道如何进行一些很酷的新编程，但他们可能会将您视为一个年轻的吹毛求疵的人，有很多疯狂的想法来改变世界。一盎司的耐心会让你得到一磅的尊重。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-10-08T15:58:45.723

我是一个老灰胡子，但我在 35 年前放弃了 COBOL，并使用 dotNET C# 编写代码，并且一直在跟上年轻的 wippersnappers 并尝试指导他们。话虽如此，我看到很多像 VB6 这样仍处于黑暗时代的经理和程序员不能接受网络农场、网络服务，其中一些灰胡子和年轻的 wippersnappers 无法将数据库表标准化为 3NF，更不用说编码 nTier、WCF 或有线索。更糟糕的是，一些经理落后了 30 年，最多只能依靠 VB6 和使用 Access97 的平面文件。

# asp.net - 跟踪广告链接点击但保持对 SEO 友好的链接？

> ID：837281
> 
> 赞同：4
> 
> 时间：2009-05-07T22:04:31.533
> 
> 标签：asp.net, seo

我有一个网站会吐出指向第三方网站的链接。现在这些第三方希望我的网站跟踪他们的点击。如何在不破坏普通链接的 SEO 友好性质的情况下做到这一点？

目前，广告链接只是一个锚点：

```
<a href="http://adsiteA.com">Come Visit Site A!</a> 
```

我可以轻松地将链接更改为以下内容：

```
http://mysite.com/clicktracker.aspx?redirect=adsiteA.com 
```

但这不会扼杀链接到他们网站的任何搜索引擎好处吗？如果没有，我会很乐意这样做......我还有什么其他选择？一个劫持点击并进行回发然后重定向的onmousedown脚本？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-08T00:36:03.180

您的第三方网站是否希望您报告所有爬过您的网站并跟踪链接的机器人和蜘蛛，或者只是“真实”的人？

如果是后者，您可以按照 google 用于搜索结果的方式做一些事情。

基本上，您正常渲染链接，但添加一个 OnMouseDown 事件，以便不使用鼠标的蜘蛛跟随标准链接，但普通浏览器将首先触发 JS 事件。

你最终会是这样的：

```
<a onmousedown="return trackMe(this)" href="http://example.com/"> 
```

然后 trackMe 方法执行重定向到跟踪页面，然后发出 302 重定向到第三方站点。

您显然想检查这对于通过键盘或类似方式导航的用户是如何工作的（即使用 Space 或 Return 来跟踪链接）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T23:01:10.913

如果它们是付费链接，Google 表示它们不应该使您的广告客户的 PageRank 受益。（事实上​​，你可能会因为试图颠覆这一点而受到惩罚）

[http://www.google.com/support/webmasters/bin/answer.py?hl=en&answer=66736](http://www.google.com/support/webmasters/bin/answer.py?hl=en&answer=66736)

# asp.net - 如何在 x64 中使用 WebDev.WebServer.exe (VS Web Server)？

> ID：837285
> 
> 赞同：16
> 
> 时间：2009-05-07T22:05:23.137
> 
> 标签：asp.net, oracle, 64-bit, webdev.webserver

Visual Studio 是 x86 直到~~至少 2010 版本~~ **更新：**这在 VS2010 中仍然是一个问题，没有原生 64 位 Cassini 支持。我的问题是任何人都可以想到一种方法或知道一个独立的 ASP.NET 调试服务器，它是 2008 年或 2010 年的 x64 吗？

背景：我们的 ASP.NET 应用程序针对 Oracle 作为数据库运行。由于稍后我们在 64 位服务器上处理内存问题，因此我们需要使用 Oracle 的 64 位驱动程序（Instant Client）。

设置：

*   x64 操作系统（XP 或 Windows 7）
*   IIS（6 或 7，均为 x64 应用程序池）
*   [Oracle 64 位即时客户端](http://www.oracle.com/technology/software/tech/oci/instantclient/htdocs/winx64soft.html)（单独的目录，在 PATH 中）
*   ~~视觉工作室 2008 SP1~~视觉工作室 2010

在 IIS 中，应用程序池以 64 位运行，按预期使用 Oracle 驱动程序，但是由于**WebDev.WebServer.exe**是 32 位，因此您将收到**BadImageFormatException**，因为它试图以 32 位加载 64 位驱动程序 DLL环境。我们所有的开发人员都希望能够通过 Visual Studio 2008 使用快速调试服务器，但由于它以 32 位运行，我们无法做到。我们遇到的一些问题是在应用程序启动期间，所以虽然我们有时会附加到 IIS 进程，但这还不足以追踪问题。

是否有任何替代方案或解决方法？我们希望尽可能地匹配我们的 Dev/Val/Prod 层，所以在 x64 中运行的一切都是理想的。

* * *

## **VS 2010 的更新**

自从首次发布以来，对这个问题进行了很多更改，第一个 VS2010 现在已经发布，这里仍然存在相同的问题，但是我所在的项目没有。我们经历了 2 处更改来解决这个问题，所以我将发布这些内容，希望它可以减轻其他人的痛苦：

第一个解决方案是在 32 位以上加载 Oracle x86，在 64 位模式下加载 x64，我们通过 web.config 在 64 位下运行时替换程序集引用来做到这一点，如下所示：

```
<configuration>
  <runtime>
    <assemblyBinding>
      <dependentAssembly>
        <assemblyIdentity name="Oracle.DataAccess" publicKeyToken="89b483f429c47342" processorArchitecture="amd64" />
          <bindingRedirect oldVersion="2.0.0.0-10.9.9.9" newVersion="2.102.3.2" />
      </dependentAssembly>
    </assemblyBinding>
  </runtime>
</configuration> 
```

这里的关键是`processorArchitecture="amd64"`，这意味着只有在 64 位下运行时才会发生替换。

请注意，这些版本现在可能已经过时了（如果您正在阅读这篇特别关注 Oracle 的文章），这已经是前一阵子了。除了配置之外，我们还将 32 位和 64 位版本加载`Oracle.DataAccess` [到 GAC](http://msdn.microsoft.com/en-us/library/dkkx7f79.aspx)中。32 位版本适用`10.xxx`于 Oracle 10g，64 位版本适用于`2.1xxx`，因此只需使用[works](http://msdn.microsoft.com/en-us/library/7wd6ex19(VS.71).aspx)[交换绑定`<assemblyBinding>`](http://msdn.microsoft.com/en-us/library/7wd6ex19(VS.71).aspx)即可。

第二个更长期的解决方案是完全脱离 Oracle 客户端，我们现在将[dotConnect for Oracle](http://www.devart.com/dotconnect/oracle/)用于我们的 Linq-to-SQL 提供程序，并且由于它是使用直接 TCP 连接的完全托管代码，我们没有更多的 32应用程序中的 /64 位特定代码，**更**易于维护。

我希望任何发现这一点的人也会发现后续工作也很有用。如果您对我最终使用的任一解决方案有疑问，请发表评论，我将尝试更详细地解释。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-08-14T07:43:59.413

两个想法：

1.  [用Mono](http://www.mono-project.com/)项目 中的 XSP 拼凑一些东西。
2.  在完全 32 位环境中测试，部署到 64 位环境。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-13T18:38:56.863

[您可以尝试从source](http://blogs.msdn.com/dmitryr/archive/2009/04/23/cassini-support-for-friendly-urls-routing.aspx)编译 64 位 Cassini 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-15T00:42:12.177

在本地计算机上使用 IIS。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-04-12T12:51:46.497

即使您使用的是 64 位环境，在 Visual Studio 中临时引用 32 位 dll（或手动将其复制到 BIN 文件夹中）以便您可以调试它。请记住，每次编译代码时，它都会重新复制 BIN 文件夹中的 64 位程序集。

# parameters - 两个函数，还是一个具有不同参数的函数？

> ID：837293
> 
> 赞同：4
> 
> 时间：2009-05-07T22:06:55.253
> 
> 标签：parameters, function

这是一个非常通用的“最佳实践”问题，但这里有一个例子。

假设我有一个电影编目应用程序。我想让我的用户有机会为他们的概要/评级信息指定 IMDb 或 Metacritic。

我这样做：

```
if (preferredSupplier == "imdb"){
      getIMDbRating(movieName);
}else{
      getMetacriticRating(movieName);
} 
```

或这个：

```
getRating(movieName, preferredSupplier); 
```

我更喜欢第二个，但这意味着函数必须遵循完全不同的逻辑，具体取决于第二个参数的值（例如 Metacritic 可能需要屏幕抓取，而 IMDb 可能有一个不错的 API）。

或者我应该把它们结合起来？在 getRating() 中充当包装函数，并根据第二个参数的值调用 getIMDbRating() 或 getMetacriticRating()。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-07T22:10:18.897

第二个允许您随着时间的推移扩展首选供应商的数量，您仍然可以（在内部）将它们作为两种单独的方法实现。

如果这是我的话，我会看两个类（Imdb 和 Metacritic），它们都派生自 RatingProvider 基类，并以不同的方式实现 getRating。

或者，如果我戴上我的 Patterns 帽子，我会看 Bridge 模式。

只有您知道系统中可能发生的变化，因此您知道是否需要为此进城，但是对我来说，无论它们实际来自何处，您都可以以统一的方式获取评级的 API 将是一个比你必须通过选择一种方法或另一种方法来做出这些决定的 API 更好的 API。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-07T22:11:52.310

拥有一个带有 getRating 方法的 RatingProvider 类可能是个好主意。

您可以将不同的评级提供者作为其子类，它们将有自己的实现来获取/处理评级。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T22:13:20.153

这两种解决方案都不是理想的。您真正应该做的是使用 GetRating(string moviename) 函数将 preferredSupplier 实现为接口或抽象类。

然后实现类 IMDBSupplier 和 MetaCriticSupplier 的接口，并让每个类放入它自己的逻辑以获得评级。这使得 getRating() 函数完全独立于使用它的任何代码，这是一个很好的松散耦合设计。

在消耗供应商的类中，它不关心它是哪种类型 - 它只是调用 GetRating()。GetRating() 与消费者无关。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-07T22:14:14.800

我将定义一个名为 MovieDatabase 的抽象类和一个名为 getRating 的抽象方法，然后为各种提供者（如 IMDb、Metacritic）提供实现 getRating 方法的子类。

使用此设置，您可以编写与提供程序无关的代码，即不了解特定提供程序的任何内容。它只需要一个 MovieDatabase 实例并对其调用 getRating 操作，而不用担心提供者或实现细节。

这种方法的优点是它更具可扩展性。如果您想添加更多提供程序或操作，您可以在一个地方（MovieDatabase 类及其子类）执行此操作，其余代码应该可以正常工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-07T22:10:43.623

我会把它们结合起来。正如您所说，两者可能需要完全不同的实现，并且将实现代码分成不同的函数可以使事情更具可读性和易于维护。但是有一个单一的呼叫点也很好。您可以考虑将它放在一个类中，将实现函数标记为私有，并将包装器标记为公共。这样，包装是唯一的接触点。通过使包装器显然是这些函数的单个调用点，它将进一步提高可维护性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-07T22:10:56.633

我更喜欢你的最后一个想法：两者都用。拥有一个将源作为参数的函数可以很容易地编写大量代码，这些代码通过简单的值更改（可能来自 UI）从供应商切换到供应商。如果/当您打算与固定的、已知的供应商通话时，您还可以使用方便的单一供应商功能进行通话。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-07T22:11:31.343

第二个选项是最好的（顺便说一句，在 OO 中它被称为工厂）。给它一个默认行为，并在其中为每个提供者调用不同的函数，所有这些 if 都没有意义。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-07T22:12:50.297

我相信这取决于您使用方法的频率、从哪里使用以及代码的不同之处。*请记住，编写routine*的主要原因是它们是——没错*——routine*。也就是说，例程应该包含您想要重用的代码，并且应该以易于重用的方式编写。

话虽如此，如果我面对您的示例案例（并且正在使用 C# 进行编码），我可能最终会`enum`为不同类型的数据库搜索创建一个，然后让一个包装器方法接受这样`enum`的参数，并从包装器方法调用不同的数据收集方法 - 类似于您在帖子末尾建议的方法，但不是使用字符串作为输入。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-07T22:13:17.767

这不是取决于您使用它的频率吗？如果您在整个代码中一遍又一遍地进行基本检查，那么一个函数将使您免于重复该代码块。

但是，如果您只在这里和那里使用该逻辑几次，那么以第一种方式使用它可能会更清楚。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-07T22:14:01.400

如果您的函数返回相同类型的响应，则在单个函数中重载是有意义的。

如果你的函数根据输入返回非常不同的东西，你可能应该使用两个函数来区分它们返回不同的东西。

例如，如果 IMDB 评级是 5 星等级，而 Metacritic 评级是 4 星等级，您需要明确它们应该以不同的方式处理。

使用单独的类将有助于澄清，而不是拥有所有这些功能。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-07T22:14:31.680

为什么你不能做类似的事情

```
public interface IRating{

  public Rating getRating();
}

public IMDBRating extends Rating

public MetacriticRating extends Rating 
```

# javascript - 有没有办法通过 Javascript 操作 Processing.js 生成的代码？

> ID：837294
> 
> 赞同：2
> 
> 时间：2009-05-07T22:06:57.750
> 
> 标签：javascript, canvas, processing

解析Processing.js代码后，我想调用一些函数或更改一些变量。目前唯一的方法是操作源代码，然后将源重新加载到处理中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-13T21:34:13.483

我开始怀疑这个问题目前没有直接的答案。就目前而言，我正在和你一样做。我正在使用 Django Web 框架。我让 Django 通过其模板处理程序将每一行 Processing.js 代码写入页面。Django 首先编写 HTML 脚本元素，然后是定义草图参数的 Processing.js 赋值语句，然后是草图的主体代码，然后是特定草图所需的 Processing.js 库函数和类，然后是结束脚本标记。我正在遍历多个草图并完成一个循环初始化例程。

通过这个方案，我可以很好地控制 HTML，因为 Django 的模板处理程序让我可以控制包含草图和画布元素的 div 元素的 id 和类。这相当于粗略的动态行为；每次用户发布表单时，草图都会更新。Python 正在读取大量文件，每个文件都包含很多位，并且这些位在到达浏览器的过程中会经过几手，与简单的数据更新相比，这必须减慢速度。

我对使用可能由 jQuery 介导的表单实现真正的客户端动态行为的可能性很感兴趣。请参阅David Yeiser 在 Design Intellection 上的这篇[引人入胜的帖子。](http://designintellection.com/integrating-jquery-with-processingjs/)所以，jQuery 可以与 Processing.js 对话，这很了不起，但也不算太奇怪，因为它们都是 JavaScript。我不是专家，但我认为这种技术会发生一些全局名称空间滥用。说到全局命名空间滥用，请查看*Irrational Exuberance*上的这两篇文章，“[通过 Ajax 更新 Processing.js 图形](http://lethain.com/entry/2008/may/20/updating-processing-js-graphics-via-ajax/)”和“[使用 Javascript 控制处理](http://lethain.com/entry/2008/may/11/using-javascript-to-control-processing/)”。如果你可以用 PHP 来做，你可以用你选择的风格来做。

显然，Processing.js 有一个可能对您有用的“内部”AJAX 函数。请参阅此[缓存帖子](http://74.125.155.132/search?q=cache:U6-VL5KUy7MJ:processingjs.org/blog/%3Ftag%3Dajax+%22Processing.js%22+AJAX&cd=2&hl=en&ct=clnk&gl=us)，由 Google 提供。与当前经过[彻底编辑的版本相比](http://processingjs.org/blog/?p=122)，几天前才更改。因此，Processing.js 的合作者已经完成了加载草图并将其与画布相关联的任务，只需两行代码，但加载各种零碎（包括可变数据）的更一般任务是没有播出时间。也许他们正在重写整个 AJAX。我想知道是否可以使用 p.ajax 函数以灵活的方式加载和连接多个 Processing.js 资产，如数据分配、setup()、draw() 以及函数和类，从而形成一个完整的草图。

我的 CS 儿子说我可以使用 JavaScript 本机 API 重新编写我的 Processing.js 代码，然后它将是纯 JavaScript，并且可以使用普通脚本标签而不是 type="application/processing" 加载。他认为我会拥有更大的灵活性以及使用最小化/混淆的选项。这是ProDevTips 中[使用 JSON的示例。](http://www.prodevtips.com/2009/08/25/loading-json-rendering-text-and-using-the-js-api/)JSON 与 Django 一起使用非常方便。我在网上到处都看到过 API。它看起来很简单，但我不知道它是否记录在任何地方。你可以在 Github 上挑选源代码。否则，我喜欢这种方法。

所以，我没有一个简洁的答案，但我怀疑情况正在迅速发展。最后一种可能性是使用 XHR。请参阅此[StackOverflow 帖子](https://stackoverflow.com/questions/881146/processing-js-loading-external-files)以及 Hyper-Metrix 网站上可下载文件的链接。一个著名的 Processing.js 专家 Alistair MacDonald (F1LT3R) 发布了许多初始化 Processing.js 草图的方法。他可能和任何人一样知道如何做我们想做的事。

如果一个消息灵通的人（即 Processing.js 内部人员）能解决这个问题，我会非常高兴。

# c# - 如何在 C# 中重新分配 Windows 快捷方式？

> ID：837302
> 
> 赞同：2
> 
> 时间：2009-05-07T22:09:18.183
> 
> 标签：c#, windows, keyboard-shortcuts

如何在 C# 中重新分配默认键盘快捷键（例如`Win`+`E`打开资源管理器窗口）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T23:15:42.720

您必须使用 3rd 方应用程序，例如 WinKey：

[http://www.pcworld.com/downloads/file/fid,5506-order,1-page,1-c,alldownloads/description.html](http://www.pcworld.com/downloads/file/fid,5506-order,1-page,1-c,alldownloads/description.html)

哦，是的......呃......在C＃中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T23:59:10.820

你可以看看这个程序：

[http://www.autohotkey.com/](http://www.autohotkey.com/)

它似乎是一个可以执行您所描述的并且是开源的程序。你可以打开他们的源码看看。我的钱在他们身上监控按键。

# user-interface - 如何呈现和组织复杂的分类和分组？

> ID：837304
> 
> 赞同：1
> 
> 时间：2009-05-07T22:09:34.547
> 
> 标签：user-interface, taxonomy

这是一个更通用的问题：

我正在尝试找到一种方法来对具有重叠或有时具有多个“广泛类别”的数据段进行分类。

我尝试使用“标签”作为允许某种粒度的一种方式，但我没有办法传达更多“顶级”类别供人们浏览。

例如，我试图分类的供应商之一是“信息管理”，它本身并不是一个真正的类别，它支持“商业智能”，但它不是真正的商业智能。

不确定人们是否有想法或者只是看看其他人如何在类似目录中对这些供应商进行分类......但想知道人们是否知道一种方式，特别是一种表示层/UI可以这么说，“连接点”更容易。

注意：这个线程是我所要求的一个子集，因此额外的详细说明会有所帮助：

[用于分类项目的最优雅的 UI？](https://stackoverflow.com/questions/281300/most-elegant-ui-for-categorizing-items)

一个更具体的方向：创建这样的关系的非专有方式：

[http://www.thebrain.com/](http://www.thebrain.com/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-12T17:34:31.120

[标签云](http://en.wikipedia.org/wiki/Tag_cloud)是显示顶级标签的最普遍方式。根据您的使用情况，它们可能会通过受欢迎程度或由[Folksonomy](http://en.wikipedia.org/wiki/Folksonomy)确定的其他一些指标来突出显示。想想 Flickr 或 Del.icio.us

# oracle - 我可以在 Oracle 中有一个可延迟的唯一功能索引吗？

> ID：837306
> 
> 赞同：3
> 
> 时间：2009-05-07T22:10:04.890
> 
> 标签：oracle, indexing, unique, ora-00904

我想在 Oracle 10g 中创建一个可延迟的唯一功能索引。

我知道如何创建一个唯一的功能索引：

```
create unique index LIST_ITEM_ENTRY_NO_UNIQ
on LIST_ITEM (case status when 'cancel' then null else LIST_KEY end,
              case status when 'cancel' then null else ENTRY_NO end); 
```

我知道如何创建一个可延迟的唯一索引：

```
alter table LIST_ITEM add constraint LIST_ITEM_ENTRY_NO_UNIQ
unique (LIST_KEY,ENTRY_NO) deferrable initially deferred; 
```

知道这两件事，我尝试了这个：

```
alter table LIST_ITEM add constraint LIST_ITEM_ENTRY_NO_UNIQ
unique (case STATUS when 'cancel' then null else LIST_KEY end,
        case STATUS when 'cancel' then null else ENTRY_NO end)
deferrable initially deferred; 
```

但我收到“ORA-00904：无效标识符”错误。要么我的语法错误，要么 Oracle 不支持可延迟的功能索引？有人可以为我提供解决方案或明确的答案吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-08T03:25:27.970

不错的尝试，但根据 Oracle 10g 文档，在这方面 CREATE INDEX 和 ALTER TABLE ADD CONSTRAINT 的语法不可互换，这就是您收到该语法错误的原因：

```
CREATE INDEX ::=

    CREATE [ UNIQUE | BITMAP ] INDEX [ schema. ]index
      ON { cluster_index_clause
         | table_index_clause
         | bitmap_join_index_clause
         } ;

table_index_clause ::=

    [ schema. ]table [ t_alias ]
    (index_expr [ ASC | DESC ]
      [, index_expr [ ASC | DESC ] ]...)
    [ index_properties ]

index_expr ::= { column | column_expression } 
```

因此 CREATE INDEX 允许 column_expression，它基本上是一个“基于函数的索引”。

另一方面：

```
ALTER TABLE ::=
ALTER TABLE [ schema. ]table
  [ alter_table_properties
  | column_clauses
  | constraint_clauses
  | alter_table_partitioning
  | alter_external_table_clauses
  | move_table_clause
  ]
  [ enable_disable_clause
  | { ENABLE | DISABLE }
    { TABLE LOCK | ALL TRIGGERS }
    [ enable_disable_clause
    | { ENABLE | DISABLE }
      { TABLE LOCK | ALL TRIGGERS }
    ]...
  ] ;

constraint_clauses ::=
{ ADD { out_of_line_constraint
        [ out_of_line_constraint ]...
      | out_of_line_REF_constraint
      }
| MODIFY { CONSTRAINT constraint
         | PRIMARY KEY
         | UNIQUE (column [, column ]...)
         }
         constraint_state
| RENAME CONSTRAINT old_name TO new_name
| drop_constraint_clause
}

out_of_line_constraint ::=
[ CONSTRAINT constraint_name ]
{ UNIQUE (column [, column ]...)
| PRIMARY KEY (column [, column ]...)
| FOREIGN KEY (column [, column ]...)
     references_clause
| CHECK (condition)
}
[ constraint_state ] 
```

因此，一个 UNIQUE 约束定义只能是列名，而不能是列表达式。

您可以在 11g 中使用虚拟列来做到这一点，在 10g 和更早的版本中，大多数人倾向于创建派生列（以及以编程方式使它们保持最新的负担）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T23:17:13.043

我认为您需要 11g[虚拟列](http://download.oracle.com/docs/cd/B28359_01/server.111/b28286/statements_7002.htm#sthref7275)功能。您将函数创建为虚拟列，然后在其上添加 cosntraint。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-05-07T23:54:03.780

[问汤姆](http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:1500734400346690148)解决了这个问题。答案是否定的，您不能基于功能索引创建唯一约束。

# c++ - 使用 MSVC++ 编译器打包枚举

> ID：837319
> 
> 赞同：1
> 
> 时间：2009-05-07T22:11:36.070
> 
> 标签：c++, enums, packing

使用 GCC，我可以使用**属性**(( **packed** )) 对枚举进行打包，但似乎 MSVC 中最接近的东西 #pragma pack 不适用于枚举。有谁知道将枚举打包成 1 个字节而不是通常的整数大小的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T22:23:49.020

这是特定于 MSVC 的：

```
// instances of this enum are packed into 1 unsigned char
// warning C4480: nonstandard extension used
enum foo : unsigned char { first, second, last }; 
assert(sizeof(foo) == sizeof(unsigned char));

// instances of this enum have the common size of 1 int
enum bar { alpha, beta, gamma };
assert(sizeof(bar) == sizeof(int)); 
```

有关参考，请参见此处： [MSDN -> 枚举](http://msdn.microsoft.com/en-us/library/2dzy4k6e(VS.71).aspx)

# java - 是否有一个 Log4J 布局/格式化程序可以为异常修剪堆栈跟踪？

> ID：837320
> 
> 赞同：3
> 
> 时间：2009-05-07T22:11:43.667
> 
> 标签：java, exception, log4j

我正在寻找一个 Log4J 布局/格式化程序，它可以帮助我修剪异常中的堆栈跟踪，比默认设置好一点。堆栈执行在 main() 之下的某处是非常明显的，我不需要知道，并且异常发生在其他库的深处，我真的无能为力。

我想要的是一个将堆栈跟踪修剪为的布局，例如我自己代码中方法的最后 5 个方法调用，通过包含 jar 文件、包或其他内容来标识。

有没有沿着这些思路，或者我必须自己写一些魔法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T22:49:57.647

我问了一个[类似的问题（关于完全抑制堆栈跟踪](https://stackoverflow.com/questions/348582/how-can-i-configure-log4j-to-not-print-the-exception-stacktrace)一段时间。

不幸的是，没有设置，你需要继承 PatternLayout 来做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T13:46:41.620

logback-classic（log4j 的后继者）中的“ex”或“exception”转换词支持打印指定数量的堆栈跟踪行。“ex”转换词与[其余的转换词](http://logback.qos.ch/manual/layouts.html#conversionWord)一起记录。您需要向下滚动一点。

如果您需要有关此主题的更多信息，请联系 logback-user 邮件列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-02-22T09:51:02.227

我也尝试寻找它，但没有找到任何令人满意的东西，所以我编写了一个自定义的 ThrowableRenderer 来修剪无关的堆栈帧。我已经开源了代码供其他人使用。查看我的[博客文章](http://blog.delphix.com/zubair/log4j-stack-trace-pruning/)；你可以在那里找到代码的链接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T22:15:06.123

有三种方法可以做到这一点：

1.  查找其他人所做的库或代码
2.  自己写（扩展/实现）
3.  使用默认布局，但在将异常的堆栈传递给记录器之前对其进行修剪

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-07T22:29:23.017

您可以编写一个具有您需要的特殊逻辑的自定义 Appender。这可能是一个很好的方法。

# c++ - 调试 Intel 的 TBB 容器

> ID：837323
> 
> 赞同：2
> 
> 时间：2009-05-07T22:12:02.573
> 
> 标签：c++, visual-studio, multithreading, tbb

最近我们开始与英特尔的 TBB 合作，发现在调试容器时我们无法真正观察元素及其数据。

是否有标志设置、插件或棘手的方法来启用它？（也许是 Visual 使用的脚本片段）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T11:59:34.823

您正在寻找的是一个[表达式评估器](http://msdn.microsoft.com/en-us/library/8fwk67y3%28VS.80%29.aspx)。你不能用一个简单的标志来做到这一点，因为有无限数量的数据结构。但是表达式求值器确实是一种插件，它绝对是代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-05T09:53:03.813

我不回答你的问题“有没有”，因为我不知道，但我不使用表达式评估器，而是使用自定义可视化器。它们写起来很痛苦，但之后工作得相对较好。

最好的资源是： [http ://www.virtualdub.org/blog/pivot/entry.php?id=120](http://www.virtualdub.org/blog/pivot/entry.php?id=120)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-21T14:34:34.060

TBB 是一个相对较新（但令人兴奋）的库，我不希望现在有大量的调试工具。您可能会尝试实现一个简单的环形缓冲区 ( [http://www.ibm.com/developerworks/aix/library/au-buffer/index.html](http://www.ibm.com/developerworks/aix/library/au-buffer/index.html) ) 用于日志记录和调试。

# c# - C# 中的 Lambda 示例

> ID：837324
> 
> 赞同：1
> 
> 时间：2009-05-07T22:12:21.233
> 
> 标签：c#, c#-3.0, lambda

我还在学习 C# 3.0 的一些特性，想知道以下是否可以简化为 lambda 表达式。

```
var SomeObject = Combo.EditValue;
var ObjectProperty = SomeObject.Property; 
```

要在一行中从 combo.editvalue 获取 ObjectProperty？

此外，如果您能向我提供有关 Lambda 表达式的任何好的参考资料，我们将不胜感激。

编辑：好的，发布的答案很棒，看来该示例不需要 Lambda 来满足解决方案。不过，我会看一下参考链接。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-07T22:15:16.467

你真的不需要 lambdas 来做你需要做的就是

```
var ObjectProperty = Combo.EditValue.Property; 
```

我不确定 lambda 是否会让您更具可读性。

以下是一些您可能想要查看的书籍，以更详细地学习 Lambda，以及您使用它们的原因：

[更有效的 C#](https://rads.stackoverflow.com/amzn/click/com/0321485890)

[C# 深入了解](http://www.manning.com/skeet/)

[MSDN 参考](http://msdn.microsoft.com/en-us/library/bb397687.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T22:16:56.573

将这些组合到一行中，通过检查 EditValue 上的 Property 属性，您将面临 NullReferenceException 的风险。:) 但是，这里有一个关于 C# 3.0 和函数式编程[的非常棒的教程。](http://blogs.msdn.com/ericwhite/pages/FP-Tutorial.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T22:18:22.467

这似乎不需要 lambda。
你不能只用

```
var ObjectProperty = Combo.EditValue.Property 
```

至于 lambda 引用，请尝试[101 LINQ 示例](http://msdn.microsoft.com/en-us/vcsharp/aa336746.aspx)作为初学者。

# sharepoint - CAML 查询帮助？

> ID：837330
> 
> 赞同：0
> 
> 时间：2009-05-07T22:13:31.200
> 
> 标签：sharepoint, moss, sharepoint-2007, wss-3.0, caml

有没有办法使用 CAML 查询获取所有版本的列表项？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T00:38:46.933

我认为这不会直接暴露在任何将 CAML 查询作为参数的 API 中。您可能需要使用 CAML 查询获取 ListItem 的当前版本，然后再次调用以获取该项目的所有版本。

# c# - 如何为 RichTextBox 创建查找表单？

> ID：837331
> 
> 赞同：1
> 
> 时间：2009-05-07T22:13:45.050
> 
> 标签：c#, winforms, find

如果可能的话，我想向上、向下搜索并匹配大小写。即使是让我开始的链接也将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T11:12:39.093

您可以在富文本框本身上使用“查找”方法。

如果您设置了一个带有“Match Case”复选框和“Search Up”复选框的表单，并在您的查找表单上添加了一个名为 ControlToSearch 的属性，该属性采用 RichTextBox 控件，您可以执行以下操作：

```
RichTextBoxFinds options = RichTextBoxFinds.None;

int from = ControlToSearch.SelectionStart;
int to = ControlToSearch.TextLength - 1;

if (chkMatchCase.Checked)
{
    options = options | RichTextBoxFinds.MatchCase;
}
if (chkSearchUp.Checked)
{
    options = options | RichTextBoxFinds.Reverse;
    to = from;
    from = 0;
}

int start = 0;
start = ControlToSearch.Find(txtSearchText.Text, from, to, options);

if (start > 0)
{
    ControlToSearch.SelectionStart = start;
    ControlToSearch.SelectionLength = txtSearchText.TextLength;
    ControlToSearch.ScrollToCaret();
    ControlToSearch.Refresh();
    ControlToSearch.Focus();
}
else
{
    MessageBox.Show("No match found", "Error", MessageBoxButtons.OK, MessageBoxIcon.Exclamation);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T22:33:11.150

不确定向上搜索，但只要找到你可以使用这样的东西

```
int selStart = ControltoSearch.SelectionStart;
int selLength = ControltoSearch.SelectionLength;
int newLength = SearchFor.Length;

int newStart = searchIn.IndexOf(SearchFor, selStart + selLength, compareType);

ControltoSearch.SelectionStart = newStart >= 0 ? newStart : 0;
ControltoSearch.SelectionLength = newLength;
ControltoSearch.ScrollToCaret();
ControltoSearch.Focus();

return newStart; 
```

对于匹配的大小写，您可以`String.ToLowerInvariant()`在文本搜索和文本搜索中使用，否则`String.Contains()`区分大小写

```
searchIn.ToLowerInvariant().Contains(SearchFor.ToLowerInvariant()) 
```

# ruby-on-rails - ActiveResource 错误响应标头不返回正文

> ID：837344
> 
> 赞同：0
> 
> 时间：2009-05-07T22:16:09.773
> 
> 标签：ruby-on-rails, activeresource

我之前问过类似的问题，但从未得到答案，这是一个简短的版本

我有一个用户活动资源模型。我在我的客户上对服务进行了简单的调用

```
response = User.find(id).put(:activate, :activation_code => activation_code) 
```

如果服务出现错误（即activation_code 不匹配），我会返回

```
render :xml => @user.errors, :status => :unprocessable_entity 
```

所以显然任何带有activeresource的错误响应都必须由resue处理

```
rescue ActiveResource::ResourceInvalid 
```

这一切都很好，很花哨，只是初始调用中的响应没有设置。我根本没有该响应的正文，因此永远不会返回@user.errors。我需要什么才能取回正确的对象？除了返回 200。任何“成功”响应代码都会很好地填充响应变量。但总是返回 200 似乎是一个错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T16:05:49.070

所以我有点误会了，在救援区

```
rescue ActiveResource::ResourceInvalid => e 
```

e 被填充。服务返回

```
render :xml => @user.errors, :unprocessable_entity 
```

所以 e.response.body 包含错误 xml。然后我在我的客户端只是说

```
user.errors.from_xml(e.response.body) 
```

并且用户现在填充了正确的错误。

# java - 如何在 Eclipse 中保存堆（转储到文件）？

> ID：837351
> 
> 赞同：5
> 
> 时间：2009-05-07T22:17:19.550
> 
> 标签：java, memory-leaks, heap-memory

从 MyEclipse 运行或调试 GA/AI 时出现此错误：

线程“主”java.lang.OutOfMemoryError 中的异常：Java 堆空间

eclipse.ini 看起来像这样：

```
-showsplash com.genuitec.myeclipse.product
--launcher.XXMaxPermSize 256m
-vmargs
-Xms128m
-Xmx512m
-Duser.language=en 
-XX:PermSize=128M 
-XX:MaxPermSize=256M 
```

MyEclipse 是这样调用的：

```
"C:\Program Files\MyEclipse 6.0\eclipse\eclipse.exe" -vm "C:\Program Files\MyEclipse 6.0\jre\bin\javaw.exe"  -vmargs -Xms1448M -Xmx1448M 
```

从这里提高 vm 设置：

```
"C:\Program Files\MyEclipse 6.0\eclipse\eclipse.exe" -vm "C:\Program Files\MyEclipse 6.0\jre\bin\javaw.exe"  -vmargs -Xms80M -Xmx1024M 
```

没有效果。所以我试图让它将堆转储到一个文件中，但是放置这些：

```
-XX:+HeapDumpOnCtrlBreak
-XX:+HeapDumpOnOutOfMemoryError 
```

在程序参数中没有任何效果。如何通过更多的内存使用分析得到一些东西？例如，jstack 目前在 Windows 平台上不可用。并且使用 SendSignal 没有我能看到的效果。

![屏幕截图](https://imgur.com/KV4d.jpg)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-08T04:56:22.307

有多种方法可以获取堆转储。以下是我用过的一些：

1.  `-XX:+HeapDumpOnOutOfMemoryError` *如果您遇到OOM，*应该会让您倾倒。**
**   连接[VisualVM](https://visualvm.dev.java.net/)（免费）并使用其 GUI 强制进行堆转储*   使用众多优秀的商业分析器之一（JProfiler、YourKit，...）*   使用 jmap（见下文）从正在运行的进程中强制转储*

 *如果您运行的是 Java 6，[jmap](http://java.sun.com/javase/6/docs/technotes/tools/share/jmap.html)应该可以在 Windows 上运行。如果您想转储堆并且您没有遇到 OOM，这可能很有用。使用 Windows 任务管理器查找 Java 应用程序的 pid，然后在控制台中运行以下命令：

```
jmap -dump:format=b,file=c:\heap.bin <pid> 
```

除了 VisualVM，[Eclipse 内存分析器](http://www.eclipse.org/mat/)（也是免费的）可以帮助您分析在获得转储后占用所有空间的原因。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T09:34:12.350

`-XX:+HeapDumpOnOutOfMemoryError`应该放在“ `VM Arguments`”而不是“ `Program Arguments`”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T04:15:19.160

您可以使用 JConsole 监控内存使用情况。

[jstat](http://java.sun.com/j2se/1.5.0/docs/tooldocs/share/jstat.html)也会有所帮助。

# sql - SQL CREATE LOGON - 不能使用@parameter 作为用户名

> ID：837358
> 
> 赞同：7
> 
> 时间：2009-05-07T22:20:26.453
> 
> 标签：sql, stored-procedures, login, saas

我是一名开发人员，我很擅长 SQL :) 请在这里帮助我。

我想创建自己的存储过程，在我的 SaaS 数据库中创建租户。为此，我需要为租户创建一个新的 SQL 登录名，然后将其添加到预定义的 SQL 角色中。

我已经为尝试创建登录名感到难过。这是我尝试过的...

```
CREATE PROCEDURE [MyScheme].[Tenants_InsertTenant]
    @username nvarchar(2048),
    @password nvarchar(2048)

AS
BEGIN
    -- SET NOCOUNT ON added to prevent extra result sets from
    -- interfering with SELECT statements.
    SET NOCOUNT ON;

    CREATE LOGIN @username WITH PASSWORD = @password
END 
```

> 消息 102，级别 15，状态 1，过程 Tenants_InsertTenant，第 16 行“@username”附近的语法不正确。
> 
> 消息 319，级别 15，状态 1，过程 Tenants_InsertTenant，第 16 行关键字“with”附近的语法不正确。如果此语句是公用表表达式、xmlnamespaces 子句或更改跟踪上下文子句，则前面的语句必须以分号结束。

我意识到这应该很简单，但是当您的 SQL 新手和 SQL 管理器错误对我来说似乎很神秘时，最好寻求帮助:)

谢谢，贾斯汀

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-07T22:25:04.510

显然 CREATE LOGIN 只接受文字。您可以尝试将其包装在 exec 中并将其构建为字符串：

```
EXEC('CREATE LOGIN' + quotename(@username) + ' WITH PASSWORD = ' + quotename(@password, ''''))

```

编辑：添加引号名称以防止 sql 注入攻击

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-08T07:51:37.410

可能的解决方案：

```
sp_addlogin @loginame = '测试'，@passwd = '测试'，@defdb = '测试'

```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T22:28:38.870

试试这个：

```
declare @t nvarchar(4000)
set @t = N'CREATE LOGIN ''''' + @username + ''''' WITH PASSWORD = ''''' + @password
exec sys.sp_executesql @t 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-03-04T13:51:10.023

基于@codeulike 和@Galkin 的答案，我最终做到了：

```
DECLARE @t nvarchar(4000)
SET @t = N'CREATE LOGIN ' + QUOTENAME(@username) + ' WITH PASSWORD = ' + QUOTENAME(@password, '''') + ', default_database = ' + QUOTENAME(@DatabaseName)
EXEC(@t) 
```

我正在运行 SQL Server 2019 并将 EXEC(--> 与 QUOTENAME() 内 <--) 组合在同一行上不起作用。

如果我了解使用引号名称构建字符串的[microsoft sql 注入文档，那么执行可以保护您免受 SQL 注入。](https://docs.microsoft.com/en-us/sql/relational-databases/security/sql-injection?view=sql-server-ver15#wrapping-parameters-with-quotename-and-replace)

# c# - 我可以有强大的异常安全和事件吗？

> ID：837366
> 
> 赞同：5
> 
> 时间：2009-05-07T22:22:21.380
> 
> 标签：c#, exception, events

假设我有一个方法可以更改对象的状态，并触发一个事件以通知侦听器此状态更改：

```
public class Example
{
   public int Counter { get; private set; }

   public void IncreaseCounter()
   {
      this.Counter = this.Counter + 1;
      OnCounterChanged(EventArgs.Empty);
   }

   protected virtual void OnCounterChanged(EventArgs args)
   {
      if (CounterChanged != null)
         CounterChanged(this,args);
   }

   public event EventHandler CounterChanged;
} 
```

即使`IncreaseCounter`成功完成状态更改，事件处理程序也可能引发异常。所以我们在这里没有很强的[异常安全性](http://www.boost.org/community/exception_safety.html)：

> 强有力的保证：操作要么成功完成，要么抛出异常，使程序状态完全保持在操作开始之前的状态。

当您需要引发事件时，是否可以具有强大的异常安全性？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T22:48:16.683

为了防止处理程序中的异常传播到事件生成器，答案是手动调用 try-catch 内的 MultiCast 委托（即事件处理程序）中的每个项目

所有处理程序都将被调用，并且异常不会传播。

```
public EventHandler<EventArgs> SomeEvent;

protected void OnSomeEvent(EventArgs args)
{
    var handler = SomeEvent;
    if (handler != null)
    {
        foreach (EventHandler<EventArgs> item in handler.GetInvocationList())
        {
            try
            {
                item(this, args);
            }
            catch (Exception e)
            {
                // handle / report / ignore exception
            }
        }                
    }
} 
```

剩下的就是让您实现当一个或多个事件接收者抛出而其他事件接收者不抛出时做什么的逻辑。如果有意义，catch() 也可以捕获特定异常并回滚任何更改，从而允许事件接收者向事件源发出异常情况发生的信号。

正如其他人指出的那样，不建议使用异常作为控制流。如果它确实是一个例外情况，那么一定要使用例外。如果您遇到很多异常，您可能想要使用其他东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T22:29:08.947

您将看到的框架的一般模式是：

```
public class Example
{
   public int Counter { get; private set; }

   public void IncreaseCounter()
   {
      OnCounterChanging(EventArgs.Empty);
      this.Counter = this.Counter + 1;
      OnCounterChanged(EventArgs.Empty);
   }

   protected virtual void OnCounterChanged(EventArgs args)
   {
      if (CounterChanged != null)
         CounterChanged(this, args);
   }

   protected virtual void OnCounterChanging(EventArgs args)
   {
      if (CounterChanging != null)
         CounterChanging(this, args);
   }

   public event EventHandler<EventArgs> CounterChanging;
   public event EventHandler<EventArgs> CounterChanged;
} 
```

如果用户想要抛出异常以防止更改值，那么他们应该在 OnCounterChanging() 事件而不是 OnCounterChanged() 中进行。根据名称的定义（过去时，-ed 的后缀），表示值已更改。

**编辑：**

请注意，您通常希望远离大量额外的 try..catch/finally 块，因为异常处理程序（包括 try..finally）的成本取决于语言实现。即win32 堆栈框架模型或PC 映射异常模型都有其优点和缺点，但是如果这些框架太多，它们都会很昂贵（无论是空间还是执行速度）。创建框架时要记住的另一件事。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T22:33:24.333

好吧，如果它很关键，你可以补偿：

```
public void IncreaseCounter()
{
  int oldCounter = this.Counter;
  try {
      this.Counter = this.Counter + 1;
      OnCounterChanged(EventArgs.Empty);
  } catch {
      this.Counter = oldCounter;
      throw;
  }
} 
```

显然，如果您可以与该字段交谈，这会更好（因为分配字段不会出错）。您也可以将其包装在 bolierplate 中：

```
void SetField<T>(ref T field, T value, EventHandler handler) {
    T oldValue = field;
    try {
         field = value;
         if(handler != null) handler(this, EventArgs.Empty);
    } catch {
         field = oldField;
         throw;
    }
} 
```

并致电：

```
SetField(ref counter, counter + 1, CounterChanged); 
```

或类似的东西...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T22:28:07.607

不会简单地交换两行的顺序以`IncreaseCounter`强制执行强异常安全吗？

或者，如果您*需要*`Counter`在引发事件之前增加：

```
public void IncreaseCounter()
{
    this.Counter += 1;

    try
    {
        OnCounterChanged(EventArgs.Empty);
    }
    catch
    {
        this.Counter -= 1;

        throw;
    }
} 
```

在您进行更复杂的状态更改（副作用）的情况下，它会变得相当复杂（例如，您可能必须克隆某些对象），但在此示例中，这似乎很容易。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-07T22:29:28.710

在这种情况下，我认为您应该从 Workflow Foundation 中获得启发。在 OnCounterChanged 方法中，使用通用 try-catch 块包围对委托的调用。在 catch 处理程序中，您必须执行有效的补偿操作——回滚计数器。

# wpf - WPF Textblock，Text属性中的换行符

> ID：837367
> 
> 赞同：102
> 
> 时间：2009-05-07T22:22:33.627
> 
> 标签：wpf, textblock

有没有办法在`\n`a 中换行`TextBlock`？

```
<TextBlock Text="line1\nLine2" /> 
```

`Text`或者有没有更好的方法在属性内强制中间换行？

```
<LineBreak /> 
```

这对我不起作用，它必须是`Text`属性的值，因为文本字符串是从外部来源设置的。

我很熟悉，`LineBreak`但这不是我正在寻找的答案。

* * *

## 回答 #1

> 赞同：134
> 
> 时间：2009-05-07T22:24:04.870

试试这个：

```
<TextBlock>
    line1
    <LineBreak />
    line2
</TextBlock> 
```

* * *

## 回答 #2

> 赞同：121
> 
> 时间：2009-10-28T16:05:43.980

我知道这是在复活一个老问题，但我遇到了同样的问题。我的解决方案是使用 HTML 编码的换行符 ( `&amp;#10;`)。

```
Line1&amp;#10;Line2 
```

好像

> 线1 线
> 2

有关更多 HTML 编码字符，请查看[w3schools](http://www.w3schools.com/TAGS/ref_ascii.asp)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-01-09T03:33:54.473

最简单的方法是

`<TextBlock> blabla <LineBreak /> coucou <LineBreak /> coucou 2 </TextBlock>`

因此，您只需编写 XAML 代码，在 HTML 中或 C# 中的“\n”`<LineBreak />`具有完全相同的含义。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-07T22:23:40.660

`<LineBreak/>`

[http://www.longhorncorner.com/UploadFile/mahesh/XamlLineBreak06092005152257PM/XamlLineBreak.aspx](http://www.longhorncorner.com/UploadFile/mahesh/XamlLineBreak06092005152257PM/XamlLineBreak.aspx)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2014-05-29T22:12:59.967

<LineBreak/> 如果它位于 Grid 或 StackPanel 等集合中，它将不起作用。在这种情况下，如下所示将起作用：

![集合内的换行符](https://i.stack.imgur.com/CuzE4.png)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-05-08T00:13:23.907

将行分成两个标签怎么样？

```
<StackPanel>
    <TextBlock Text="Line1" />
    <TextBlock Text="Line2" />
</StackPanel> 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2012-04-10T14:15:46.370

正确的使用方法可能如下：

```
<TextBlock>  
    <Span>text1</Span>  
    <LineBreak/>  
    <Span>text2</Span>  
</TextBlock> 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2012-08-31T08:24:43.700

```
 <HyperlinkButton 
        Content="Apply and restart this pplication!&#10;&#13;Note that modifying these settings requires the application to be restarted."   /> 
```

CRLF 简单方法 =`!&#10;&#13;`

`!&#10;&#13;` - 处理所有 wpf、xaml、silverlight 控件，如 TextBlock、HyperlinkText 等

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2021-01-13T22:35:17.143

对我来说在同一个文本块中处理多行的最佳方法是：

```
<TextBlock>  
    text1  
    <LineBreak/>  
    text2  
</TextBlock> 
```

确保不使用 TextWrapping="Wrap"。使用 TextWrapping="NoWrap" 或不使用任何内容。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2013-03-10T20:43:20.907

如果您正在绑定 TextBlock 的文本，则其他答案都不起作用。只需将 '\n' 添加到要中断的绑定文本中。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2014-03-26T06:46:44.630

我迟到了，但是..这或多或少是我做的，（请注意我的 ItemSources 是纯字符串，没有格式化，我不需要'convertBack'任何东西）

```
public class SpaceToLineBreakConverter : IValueConverter
{   
    public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {            
        return (!String.IsNullOrEmpty(value as string)) 
        ? new Regex(@"\s").Replace(value as string, "\n") 
        : value;            
    }

    public object ConvertBack(object value, Type targetType, object parameter,System.Globalization.CultureInfo culture)
    {
        throw new NotImplementedException();
    }
} 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2019-02-08T14:38:36.050

这也可以正常工作：

```
<TextBlock>
    <Run Text="My nice text"/>
    <LineBreak/>
    <LineBreak/>
    <Run Text="After some linebreaks, I'm back!"/>
</TextBlock> 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2020-06-25T15:34:37.807

当我使用绑定时，这`&amp;#10;`对我不起作用。但这有效：

```
$"first line {Environment.NewLine} second line" 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2012-12-04T12:58:53.917

只需使用 AccessText 控件。您可以像使用标签一样使用它，并且您拥有 TextWrapping="WrapWithOverflow" 属性

例如。

我的就是这样，而且工作正常。此外，您在动态更改文本方面没有任何问题。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2011-04-08T09:23:30.347

我遇到了类似的问题，想将 xaml 标记的字符串绑定到 TextBlock。本质上将声明性标记存储在字符串中的 TextBlock 中以供以后使用。

[我就是这样做](https://stackoverflow.com/questions/5565885/how-to-bind-a-textblock-to-a-resource-containing-formatted-text)的：我将 TextBlock 子类化以使 InlineCollection 可绑定，并在字符串和 InlineCollection 之间编写了一个转换器（或者实际上是一个通用的内联列表。）

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2021-09-27T05:24:15.187

这也很好用。

使用这种方法，我们可以根据需要修改每一行中的文本属性。

```
<TextBlock>
    <StackPanel>
        <TextBlock FontSize="12" FontWeight="Bold" >My Text One</TextBlock>
        <TextBlock FontFamily="Times New Roman" FontStyle="Italic">
            - My Text Two
        </TextBlock>
    </StackPanel>
</TextBlock> 
```

# apache - htaccess 文件限制

> ID：837371
> 
> 赞同：0
> 
> 时间：2009-05-07T22:24:03.170
> 
> 标签：apache, .htaccess

我的网络服务器上有一个目录。它没有索引页。因此，当您通过 Web 浏览器访问该目录时，它会列出其中的文件。现在我想创建一个可以阻止目录列表的 htaccess 文件，这样当您通过 Web 浏览器访问它时，目录中的文件不会被列出，但可以通过附加文件名来访问文件您希望访问 url 使其成为文件的完整部分。此外，htaccess 文件应该能够限制除具有特定扩展名的文件之外的所有文件的访问。谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-07T22:28:05.330

```
Options -Indexes

Order allow,deny
Deny from all

<Files "*.gif">
    Allow from all
    Deny from none
</Files> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T22:26:52.117

您可以关闭目录的 .htaccess 中特定目录的文件列表

```
Options -Indexes 
```

或者

您可以在要保护的目录中放置一个空的 index.html 文件。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-07T22:31:41.153

在您目录中的 .htaccess 文件中，只需放入

```
Options -Indexes 
```

如前所述。

编辑删除了错误的 htaccess 设置。再次抱歉

# sql - 如何让 SQL Server 忽略检查？

> ID：837382
> 
> 赞同：2
> 
> 时间：2009-05-07T22:26:11.060
> 
> 标签：sql, sql-server, validation

我有一个 SQL 脚本，它填充一个临时列，然后在脚本末尾删除该列。第一次运行时，它工作正常，因为该列存在，然后它被删除。该脚本第二次中断，因为该列不再存在，即使 IF 语句确保它不会再次运行。如何绕过对该字段的 SQL 检查？

```
IF EXISTS (SELECT name FROM syscolumns 
             WHERE name = 'COLUMN_THAT_NO_LONGER_EXISTS')
BEGIN
   INSERT INTO TABLE1
   (
     COLUMN_THAT_NO_LONGER_EXISTS,
     COLUMN_B,
     COLUMN_C
   )
   SELECT 1,2,3 FROM TABLE2

   ALTER TABLE TABLE1 DROP COLUMN COLUMN_THAT_NO_LONGER_EXISTS
END 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-07T22:34:46.437

我曾经遇到过类似的问题，并通过将所有查询构建为字符串并使用 Exec() 调用执行它们来解决它。这样查询（选择、插入或其他）在执行之前不会被解析。

虽然它并不漂亮或优雅。

例如

```
exec('INSERT INTO TABLE1(COLUMN_THAT_NO_LONGER_EXISTS,COLUMN_B,COLUMN_C) 从表 2 中选择 1,2,3')

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T22:41:12.130

您是否正在检查该列不在另一张桌子上？如果不是，您可能还要检查表格，看看下面的 if 语句。

如果您已经这样做了，它是否在单个事务中运行并且没有拾取已删除的列？

```
IF Not EXISTS (SELECT name FROM sys.columns 
             WHERE name = 'COLUMN_THAT_NO_LONGER_EXISTS' and Object_Name(object_id) = 'Table1') 
```

为此创建了一个快速脚本程序；您能否确认这与您尝试执行的操作相匹配，因为在 SQL 2007 中，至少这不会返回错误。如果我创建表并使用 teh alter table 添加 colc 它可以工作；如果我然后运行 ​​if / insert 即使在删除表后也可以工作。

```
create table tblTests
(
TestID int identity (1,1),
TestColA int null,
TestColB int null
)

go -- Ran this on its own

insert into tblTests (TestColA, TestColB)
Select 1,2
go 10
-- Insert some initial data

alter table tblTests
add TestColC Int
go -- alter the table to add new column

-- Run this with column and then after it has removed it

IF EXISTS (SELECT name FROM sys.columns a 
             WHERE name = 'TestColC' AND
             OBJECT_NAME(object_id) = 'tblTests')
Begin
    insert into tblTests (TestColA, TestColB, testcolc)
    select 1,2,3

    alter table tblTests
    drop column TestColC
End 
```

# sql-server - 在 TSQL 中将 PascalCase 字符串转换为“友好名称”

> ID：837384
> 
> 赞同：3
> 
> 时间：2009-05-07T22:26:32.650
> 
> 标签：sql-server, tsql, user-defined-functions

我有一个表，其中有一列的值来自枚举。我需要创建一个 TSQL 函数，以便在检索时将这些值转换为“友好名称”。

**例子：**

```
 'DateOfBirth' --> 'Date Of Birth'
 'PrincipalStreetAddress' --> 'Principal Street Address' 
```

我需要一个直接的 TSQL UDF 解决方案。我没有安装扩展存储过程或 CLR 代码的选项。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-07T23:16:44.573

```
/*
 Try this.  It's a first hack - still has problem of adding extra space
 at start if first char is in upper case.
*/
create function udf_FriendlyName(@PascalName varchar(max))
returns varchar(max)
as
begin

    declare @char char(1)
    set @char = 'A'

    -- Loop through the letters A - Z, replace them with a space and the letter
    while ascii(@char) <= ascii('Z')
    begin
        set @PascalName = replace(@PascalName, @char collate Latin1_General_CS_AS, ' ' + @char) 
        set @char = char(ascii(@char) + 1)
    end

    return LTRIM(@PascalName) --remove extra space at the beginning

end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T22:43:33.543

如果您使用的是 SQL Server 2005，则可以编写本机 CLR 过程：

```
static string ToFriendlyCase(this string PascalString)
{
    return Regex.Replace(PascalString, "(?!^)([A-Z])", " $1");
} 
```

输出：

> 将我的疯狂帕斯卡案例句子转换为友好案例

如果您*不*使用 2005，那么您必须手动解析它或使用扩展过程引用正则表达式对象。一篇好文章可以在这里找到：

[http://www.codeproject.com/KB/mcpp/xpregex.aspx](http://www.codeproject.com/KB/mcpp/xpregex.aspx)

**编辑：** UDF 不能影响数据库，所以你不能注册正则表达式 com 对象，这样就放弃了这个想法。但是，存储过程可以 - 所以这可能是一条路线。

为了进行区分大小写的比较，您必须将查询的排序规则设置为区分大小写，然后使用我认为的替换...这里有一篇文章可能有助于在正确的方向：

[http://www.mssqltips.com/tip.asp?tip=1032](http://www.mssqltips.com/tip.asp?tip=1032)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T23:22:27.367

```
 declare @arg varchar(20)
set @arg = 'DateOfBirthOnMonday'

declare @argLen int
set @argLen = len(@arg)

declare @output varchar(40)
set @output = ''

declare @i int
set @i = 1

declare @currentChar varchar(1)
declare @currentCharASCII int

while (1 = 1)
begin
set @currentChar = substring(@arg, @i, 1)
set @currentCharASCII = ascii(@currentChar)

if (@currentCharASCII >= 65 and @currentCharASCII <= 90)
set @output = @output + ' ' 

set @output = @output + @currentChar

set @i = @i+ 1

if (@i > @argLen) break
end

set @output = ltrim(rtrim(@output))
print @output 

```

将 @arg 的值更改为您想要测试的值。

此外，您可能需要更改@output 声明以适应长度与@arg + 可能需要的空格数相同的字符串。在我的例子中，我把它翻了一番。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-07T23:28:05.420

不是最优雅的解决方案，但它有效：

```
declare @pascalCasedString nvarchar(max) = 'PascalCasedString'
declare @friendlyName nvarchar(max) = ''
declare @currentCode int;
declare @currentChar nvarchar;

while (LEN(@pascalCasedString) > 0)
    begin
        set @currentCode = UNICODE(@pascalCasedString)
        set @currentChar = NCHAR(@currentCode)

        if ((@currentCode >= 65) AND (@currentCode <= 90))
        begin
            set @friendlyName += SPACE(1)
        end
        set @friendlyName +=  @currentChar
        set @pascalCasedString = RIGHT(@pascalCasedString,LEN(@pascalCasedString) - 1)
    end

select @friendlyName 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-12-03T11:03:41.883

我发现这完全符合要求。由[SqlAuthority.com](http://blog.sqlauthority.com/2007/02/01/sql-server-udf-function-to-convert-text-string-to-title-case-proper-case/)提供：

```
CREATE FUNCTION dbo.udf_TitleCase (@InputString VARCHAR(4000) )
RETURNS VARCHAR(4000)
AS
BEGIN
DECLARE @Index INT
DECLARE @Char CHAR(1)
DECLARE @OutputString VARCHAR(255)
SET @OutputString = LOWER(@InputString)
SET @Index = 2
SET @OutputString =
STUFF(@OutputString, 1, 1,UPPER(SUBSTRING(@InputString,1,1)))
WHILE @Index <= LEN(@InputString)
BEGIN
SET @Char = SUBSTRING(@InputString, @Index, 1)
IF @Char IN (' ', ';', ':', '!', '?', ',', '.', '_', '-', '/', '&','''','(')
IF @Index + 1 <= LEN(@InputString)
BEGIN
IF @Char != ''''
OR
UPPER(SUBSTRING(@InputString, @Index + 1, 1)) != 'S'
SET @OutputString =
STUFF(@OutputString, @Index + 1, 1,UPPER(SUBSTRING(@InputString, @Index + 1, 1)))
END
SET @Index = @Index + 1
END
RETURN ISNULL(@OutputString,'')
END 
```

用法：

```
SELECT dbo.udf_TitleCase('This function will convert this string to title case!') 
```

输出：

```
This Function Will Convert This String To Title Case! 
```

# silverlight - 棱镜（银光）

> ID：837387
> 
> 赞同：-1
> 
> 时间：2009-05-07T22:27:50.307
> 
> 标签：silverlight, prism

要么我遗漏了一些东西，要么（[WPF 和 Silverlight 的模式和实践复合应用程序指南](http://www.codeplex.com/CompositeWPF)）没有附带任何模板或“指导包”来生成代码。有人可以确认我是否没有正确安装它，或者它与 SCSF 完全不同并且没有任何代码生成器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-11T12:42:34.077

您可能会发现David Hill 创建的[Prism 快速入门套件很有用。](http://blogs.msdn.com/dphill/archive/2009/06/15/prism-quick-start-kit-update.aspx)在那里您会找到不同的 Visual Studio 模板（用于 WPF 和 Silverlight 的 Shell 和 Module 模板）。

请让我知道这可不可以帮你，

埃齐奎尔·贾迪布

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T22:33:56.437

没有模板，也没有带有复合应用指南的“指南包”，也就是 Prism。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-07T22:34:54.143

您可以在此处找到参考实现、可重用库代码（名为 Composite Application Library）、文档、快速入门教程和动手实验：

[WPF 和 Silverlight 的复合应用程序指南 - 2009 年 2 月](http://www.microsoft.com/downloads/details.aspx?FamilyID=fa07e1ce-ca3f-4b9b-a21b-e3fa10d013dd&DisplayLang=en)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-03T12:19:08.253

安装 Prism 时，会有一个包含示例和教程的文件夹，因此它们可以为您提供更好的思路。

# jquery - 浏览器支持

> ID：837400
> 
> 赞同：0
> 
> 时间：2009-05-07T22:31:22.187
> 
> 标签：jquery, internet-explorer

我需要让这个功能**在任何地方都能工作，除了 IE6-7**

```
$(function(){
    window.scrollTo(0,300);
}) 
```

请帮忙。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-07T22:37:16.040

您可以链接[浏览器检测](http://davecardwell.co.uk/javascript/jquery/plugins/jquery-browserdetect/)，然后执行以下操作：

```
$(function() {
   if (!($.browser.msie() && $.browser.version.number() < 8)) {
      window.scrollTo(0,300);
   }
} 
```

我想更好的问题是你为什么需要这个？请阅读有关[对象检测](http://www.quirksmode.org/js/support.html)的更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T22:39:35.737

我认为这是您所追求的结构：

if (!(jQuery.browser.msie)) { window.scrollTo(0,300); }

# c++ - 如何在 C++ 中模拟 ADO for SQLite 的编辑/更新机制？

> ID：837404
> 
> 赞同：3
> 
> 时间：2009-05-07T22:32:36.207
> 
> 标签：c++, sqlite, ado

我有一个使用 ADO 与 Oracle 数据库通信的 C++ 应用程序。我正在更新应用程序以支持离线文档。我决定在本地实施 SQLite。

我已经围绕将调用适当代码的 ADO 类实现了一个包装器。但是，ADO 的添加/编辑/删除行的方式对于 SQLite 来说实现起来有点困难。

对于 ADO，我会写如下内容：

```
CADODatabase db;
CADORecordset rs( &db );
db.Open( "connection string" );
rs.Open( "select * from table1 where table1key=123" );
if (!rs.IsEOF())
{
    int value;
    rs.GetFieldValue( "field", value );
    if (value == 456)
    {
        rs.Edit();
        rs.SetFieldValue( "field", 456 );
        rs.Update();
    }
}
rs.Close();
db.Close(); 
```

对于这个简单的示例，我意识到我可以发布一个更新，但实际代码要复杂得多。

我将如何在`Edit()`和之间拨打电话`Update()`以实际更新数据？我的第一个想法是`Edit()`构建一个单独的查询并`Update()`实际运行它，但我不确定哪些字段将被更改，也不确定表中的哪些键将更新查询限制为。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-11-04T09:23:09.263

“但我不确定哪些字段将被更改，也不确定表中的哪些键将更新查询限制为。”

仅选择 ROWID 与其余字段然后基于此构建更新怎么样？

# php - 将数组加密为字符串

> ID：837417
> 
> 赞同：0
> 
> 时间：2009-05-07T22:36:24.887
> 
> 标签：php, encryption

我正在寻找一种双向加密算法来将数组编码为字符串，以便我可以安全地将一些数据存储在 cookie 中。该算法不应该只是内爆数组，我也希望它被混淆。我的数据包含所有可打印的字符。

一个链接就足够了，我似乎无法在谷歌上挖掘任何东西。也许我应该用一些不起眼的字符来内爆数组，然后以某种方式加密它？我不确定用什么方法来加密它……它不太安全，cookie 数据不是*那么*敏感。

哦...是的，加密算法应该让我使用密钥/盐。mcrypt_encrypt 似乎返回了凌乱的长结果，但也许我没有使用正确的密码。哪个是最简单的密码（产生干净的短字符串）？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-07T22:44:32.137

[serialize()](http://us.php.net/serialize)会将您的信息从数组获取到字符串 -如果您只是想要混淆，您可以通过[base64_encode()传递它 - 但不是安全性。](http://us.php.net/base64_encode)

如果您想要一些安全性 - 查看 mcrypt 和河豚：[河豚示例](http://www.chilkatsoft.com/p/php_blowfish.asp)

关于 [`mcrypt`](http://php.net/manual/en/function.mcrypt-encrypt.php)

> 警告 自 PHP 7.1.0 起，该函数已被弃用。强烈建议不要依赖此功能。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-07T23:14:35.810

根据 gnarf 的回答，这应该可以解决问题：

```
function encode_arr($data) {
    return base64_encode(serialize($data));
}

function decode_arr($data) {
    return unserialize(base64_decode($data));
} 
```

以防万一其他人想要复制和粘贴解决方案。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-07T22:53:13.553

使用[serialize()](http://www.php.net/manual/en/function.serialize.php)将数组转换为字符串，使用 unserialize() 将其转回数组。它远远优于内爆和手动解析。对于简单的混淆（任何程序员都可以看穿），您可以使用简单的 base64 编码，但您应该真正研究[mcrypt](http://php.net/manual/en/book.mcrypt.php)库以提供一些真正的安全性。

最好的办法可能是根本不将数组存储在 cookie 中。将数组存储在会话变量中，以便用户看到的只是会话 ID。当然，这仅在您在会话期间需要数组时才有效。

您在评论中说这是为了“记住我”cookie，所以这是关于身份验证的。在这种情况下，不要在数组中存储任何敏感内容。只需存储一个盐渍哈希并使用它。例如，您的 cookie 可能包含用户名和（数据库密码哈希 + ip 地址范围）的加盐哈希。当用户访问网站时，读取 cookie 并根据数据库中的信息构建散列。如果它与 cookie 中的哈希匹配，则自动登录。如果没有，请删除 cookie 并假装它不存在。

这样，cookie 中就不会存储敏感数据，您也不需要对其进行加密。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-07T22:40:17.983

我只是内爆然后使用 Blowfish 或（为了一般的安全性）DES 或其他东西加密[......](http://us2.php.net/manual/en/book.mcrypt.php)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-07T22:38:21.623

如果安全性无关紧要，请使用 JSON 对数组进行编码，然后对字符串进行 rot13 编码；-)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-07T22:39:18.953

尝试对数组中的所有元素进行异或运算，将结果字符存储在字符串中——与解密相反。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-07T22:39:45.910

如果它不需要保护普通 base64 或 rot13，可能值得一看。

# sql-server - ORM 和数据库索引

> ID：837419
> 
> 赞同：1
> 
> 时间：2009-05-07T22:36:37.260
> 
> 标签：sql-server, sql-server-2005, nhibernate, hibernate, orm

在使用诸如 NHibernate/Hibernate 之类的 ORM 时，您有什么方法来创建和维护数据库索引。

由于 ORM 正在生成查询，您是否可以推荐任何工具来分析这些查询计划并建议应该创建的索引类型？

我目前的方法是……等到某些东西运行缓慢，然后找到慢查询并优化它……但这有点蹩脚，不是吗？我的目标不是最终​​得到数十或数百个索引，其中没有人知道系统实际使用了哪些索引，哪些没有。所以再次索引维护。

我的环境是 NHibernate + SQL Server 2005。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T22:45:35.660

我发现需要索引的列通常是“显而易见的”。我的意思是，如果您创建诸如“select p from Person p where p.surname = :surname”之类的查询，那么 surname 所指的任何列都需要索引。

同样，每个外键都应该被索引。

不，我不会等到性能实际上是一个问题。索引只是我从一开始就做的事情。

哦，我想补充的另一件事是大多数（如果不是全部）ORM 都能够打开语句日志记录。这些通常不是特别可读（单行，表名 t0、t1、t2 等），但这可以告诉您运行了哪些查询以及运行频率。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T23:04:16.507

无论您是否使用 ORM，用于分析慢查询/不良索引的标准工具都适用。您可以使用 sql server profiler 检查针对您的数据库运行的 sql 语句，然后使用 sql server management studio / sql query analyzer 查询窗口中的索引计划功能来查看查询计划的详细信息并了解您可能需要添加哪些索引。

您还可以在 sql management studio 中使用数据库引擎优化顾问，尽管该工具是否真的比简单地花一些时间考虑您的数据库设计和查询模式更有用还有待商榷。

# c# - 将图像的一部分渲染到位图 C# Winforms

> ID：837423
> 
> 赞同：2
> 
> 时间：2009-05-07T22:37:27.303
> 
> 标签：c#, winforms, xna, image-manipulation, textures

我正在为我在空闲时间设计的 XNA 游戏开发地图编辑器。地图中使用的艺术品存储在单个纹理上，矩形存储有坐标和宽度等。

在 winforms 应用程序中，我可以通过从列表框中选择我想要的段来添加段，该列表框是从可能的段数组中填充的。

问题是我希望能够显示所选片段的预览，并且由于它存储在通用纹理上，因此我不能简单地设置一个图片框来显示图像。

无论如何使用矩形信息（.x，.y，.width，.height）来仅显示图片框中的图像部分，或者将部分位图并显示？

非常感谢

迈克尔·艾伦

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-07T22:58:23.213

您可能想查看 GDI 库。一起使用 Image 或 Bitmap 对象和 Graphics.DrawImage() 将获得您要查找的内容。

```
private void DrawImageRectRect(PaintEventArgs e)
{

    // Create image.
    Image newImage = Image.FromFile("SampImag.jpg");

    // Create rectangle for displaying image.
    Rectangle destRect = new Rectangle(100, 100, 450, 150);

    // Create rectangle for source image.
    Rectangle srcRect = new Rectangle(50, 50, 150, 150);
    GraphicsUnit units = GraphicsUnit.Pixel;

    // Draw image to screen.
    e.Graphics.DrawImage(newImage, destRect, srcRect, units);
} 
```

您也可能对在 WinForm 中使用 XNA 而不是使用 PictureBoxes 和 GDI 感兴趣。它还不是 100% 支持，但可以在[此处](http://creators.xna.com/en-US/sample/winforms_series1)找到相关教程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T22:43:13.110

您可以使用 Graphics.DrawImage()，它将接受一个 Rectangle。

# java - 如何在 Hibernate 中将元素添加到延迟加载的集合而不导致集合加载？

> ID：837433
> 
> 赞同：6
> 
> 时间：2009-05-07T22:40:30.150
> 
> 标签：java, hibernate, jpa, lazy-loading

锡纸上写着什么；我想在不强制加载集合的情况下修改 Hibernate 中的集合，因为它是大量数据（约 100,000 条记录，单调增加）。

现在，我通过调用添加一个元素到这个列表中，`getEvents ().add (newEvent)`这当然会导致`events`被填充。

这是映射：

```
<bag name = "events" inverse = "true" cascade = "all-delete-orphan"
 order-by = "event_date desc" lazy = "true">
  <key>
<column name = "document_id" length = "64" not-null = "true" />
  </key>
  <one-to-many class = "EventValue" />
</bag> 
```

我应该怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-07T23:06:18.903

实现此目的的一种方法是在父对象（我们称其为父对象）和事件之间创建双向关联，并配置您的休眠映射，以便该关系由事件管理。

为此，您的 Hibernate 映射将如下所示：

```
<class name="Parent"...>
    ...
    <bag name="events" lazy="true" inverse="true"...>...</bag>
    ...
</class>

<class name="Event"...> 
    <many-to-one name="parent">
    ...
</class> 
```

你的代码看起来像：

```
myEvent.setParent(parentObject);
eventDao.save(myEvent); 
```

希望这可以帮助。祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T18:02:41.503

只需插入事件。

例如 ：

```
@Entity
public Document
{
    @ManyToOne
    Set<Event> events;

    public void addEvent( Event event )
    {
        events.add( event )
    }

}

@Entity
public Event
{
    @id
    private long id;

    @OneToMany
    private Document  doc;

    ....
} 
```

可以读取所有事件的选项：

```
document.add( event );
update( document ); 
```

不会触及集合的选项：

```
 event = new Event();
    event.setDocument( document );
    insert( event ); 
```

然后，当您调用 document.getEvents() 时，它也会查询并获取新事件。唯一的问题是如果集合已被读取，然后您通过选项 2 插入事件。在这种情况下，getEvents() 将不包含新事件，因为集合已被读取。

# objective-c - 数据源对象属于哪里？控制器还是模型？

> ID：837443
> 
> 赞同：2
> 
> 时间：2009-05-07T22:43:53.170
> 
> 标签：objective-c, cocoa, cocoa-touch, datasource

我正在为 UIScrollView 实现数据源对象。那是控制器的一部分，还是模型的一部分？我认为控制器，但不确定。它提供数据。但是数据可能在sqlite3，文件中，来自网络。所以实际上我会说它不是来自数据部分，因为它应该灵活地处理数据的来源。你怎么看？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-07T22:47:01.227

任何视觉控件的数据源都应该是您的控制器。您的控制器应该从模型中获取/处理数据，然后将其交给视图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T22:47:21.383

我会说实际上两者都不是。您的 UIScrollView 数据源只是格式化您的数据以供显示。

除非您有执行“业务逻辑”的特定操作，否则您的 UIScrollView 数据源将参与视图。

控制器将包含以任何方式修改或处理数据的逻辑，您的滚动视图仅允许显示数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T23:06:13.240

Cocoa 的 MVC 范式鼓励“模型控制器”和“视图控制器”对象。数据源对象属于视图控制器类别；它根据 UI 元素的需要从数据存储中请求模型对象，重新格式化数据以适应，然后将其传递给 UI。通常同一个对象也会处理 UI 事件和委托方法。

# c# - 使第二个和第三个 OpenFileDialog 出现在 .NET/C# 中的控制台上方？

> ID：837454
> 
> 赞同：0
> 
> 时间：2009-05-07T22:46:31.057
> 
> 标签：c#, .net, winforms, console, openfiledialog

我正在编写一个可以接受 1 到 3 个文件的控制台程序。我使用`OpenFileDialog`了三次来接受文件，但第二次和第三次文件对话框位于控制台窗口后面，很难注意到。有什么办法让它出现在上面吗？

问题的图像：

![在此处输入图像描述](https://i.stack.imgur.com/PiqmW.png)

相关代码为：

```
static bool loadFile(ref List<string> ls)
{
    OpenFileDialog f = new OpenFileDialog();
    if (f.ShowDialog() == DialogResult.OK)
    {
        Console.WriteLine("Loaded file {0}", f.FileName);
        ls.Add(f.FileName);
        return true;
    }
    else
    {
        return false;
    }
}

[STAThread]
static void Main(string[] args)
{
    // sanity check
    if (args.Length > 3)
    {
        Console.WriteLine("Sorry, this program currently supports a maximum of three different reports to analyze at a time.");
        return;
    }
    else if (args.Length == 0) 
    {
        List<string> fL = new List<string>();

        for (int k = 0; k < 3; k++)
        {
            if (!loadFile(ref fL)) break;
        }

        if (fL.Count == 0)
        {
            InfoDisplay.HelpMessage();
            return;
        }
        else
        {
            args = fL.ToArray();
        }
    }

    // main program
    ...
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-09T09:36:27.970

我在控制台应用程序中遇到了同样的问题。

可以使用“父窗口”句柄参数调用 OpenFileDialog.ShowDialog。我创建了一个虚拟表单并将其用作父窗口参数（虚拟表单是不可见的，因为我没有在其上调用 Show()）。

以下代码适用于我：

```
Form dummyForm = new System.Windows.Forms.Form();

OpenFileDialog myOpenFileDialog1 = new OpenFileDialog();  
if (myOpenFileDialog1.ShowDialog(dummyForm) == DialogResult.OK) {  
    fileName1 = myOpenFileDialog1.FileName;  
}

OpenFileDialog myOpenFileDialog2 = new OpenFileDialog();
if (myOpenFileDialog2.ShowDialog(dummyForm) == DialogResult.OK) {
    fileName2 = myOpenFileDialog2.FileName;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T23:29:40.157

我知道这并不能直接回答问题，但 OpenFileDialog 有一个名为“MultiSelect”的属性，它指示用户是否可以选择多个文件。一旦用户选择了文件，属性 FileNames (string[]) 就会填充所有文件名。然后，您可以像这样进行检查：

```
if(dialog.FileNames.Length > 3)
{
   //only 3 are allowed
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-01-09T10:00:44.403

对我来说，虚拟表格和标签仍然没有解决问题。[CodeProject 在http://www.codeproject.com/KB/WPF/MessageBox.aspx](http://www.codeproject.com/KB/WPF/MessageBox.aspx)有部分解决方案

然后你可以`Process.GetCurrent.Process.MainWindowHandle`在上面文章中的类的构造函数中使用，然后将实例传递给文件对话框，它似乎工作得很好（至少对我来说）。

```
Process p = Process.GetCurrentProcess();
WindowWrapper w = new WindowWrapper(p.MainWindowHandle);
OpenFileDialog ofd = new OpenFileDialog();
var ret = ofd.ShowDialog(w);
... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T22:58:19.797

[在这里](http://social.microsoft.com/Forums/en-US/vblanguage/thread/e8433d49-442c-4fc0-bef3-031f126b01c6/)找到了一个类似的帖子。未经测试，但试一试，让我知道。

```
foreach(Process p in Process.GetProcesses)
{
    if(p.MainWindowTitle = <the main UI form caption>)
    {
        if(IsIconic(p.MainWindowHandle.ToInt32) != 0)
        {
            ShowWindow(p.MainWindowHandle.ToInt32, &H1);
            ShowWindow(f.Handle.ToInt32, &H1);
        }
        else
        {
            SetForegroundWindow(p.MainWindowHandle.ToInt32);
            SetForegroundWindow(f.Handle.ToInt32);
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-12-16T19:51:57.707

> 可以使用“父窗口”句柄参数调用 OpenFileDialog.ShowDialog。我创建了一个虚拟表单并将其用作父窗口参数（虚拟表单是不可见的，因为我没有在其上调用 Show()）。

Form 有点重，也许是一个标签，因为它只需要一个 IWin32Window？

```
OpenFileDialog.ShowDialog(new Label()); 
```

它似乎工作。

如果有人能为这个（现在）复活的问题提出一个合理的解决方案，那就太好了。

亚伦

# c++ - 获取文本和语言环境

> ID：837461
> 
> 赞同：1
> 
> 时间：2009-05-07T22:49:16.917
> 
> 标签：c++, c, gettext

我从一个相对可靠的消息来源听说 gettext 不需要系统语言环境就可以工作。但是我已经尝试了一些教程，除非我有 locale-gen'd (in arch) fi_FI.utf8，否则我无法显示任何翻译。

```
root@junior:~/programming/Projects/Cpp/web/test# LANG=fi_FI.utf8 bin/hello
你好世界！
这是包：web-cms
root@junior:~/programming/Projects/Cpp/web/test# sed -i 's/#fi_FI.UTF-8/fi_FI.UTF-8/' /etc/locale.gen && locale-gen
正在生成语言环境...
  en_GB.UTF-8... 完成
  en_US.UTF-8... 完成
  fi_FI.UTF-8... 完成
生成完成。
root@junior:~/programming/Projects/Cpp/web/test# LANG=fi_FI.utf8 bin/hello
特维邮件
paketti 上的 Tämä：web-cms

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T22:58:38.377

你没听错吗？据我所知，您确实需要系统语言环境才能使 gettext 工作。但是，您不需要为这些系统语言环境安装所有翻译，只是为了让您的“hello world”正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T18:05:10.433

```
setenv("LANGUAGE", languagecode); 
```

如果语言代码是“fr”，并且您在 bindtextdomain 指向的目录中有一个“fr/LC_MESSAGES/.mo”文件，它应该可以工作。

# .net - 正在读取或访问数据行上的事件？

> ID：837468
> 
> 赞同：0
> 
> 时间：2009-05-07T22:53:45.843
> 
> 标签：.net, datatable, datarow

我正在寻找在访问数据表中的一行时会触发的方法或事件。

我有一个包含数千行的数据表，以及至少其中一列中的图像。我想在访问时从行中动态加载和卸载图像。

我还没有看到任何文件表明它在那里，但我想我会发布，看看是否有人知道。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T00:39:02.113

问题是您必须定义“已访问”。如果您在谈论“显示”，那么您可能并不是真的想绑定到 DataTable，而是绑定到网格（或列表或任何显示 DataTable 的东西）。如果你的意思是“感动”，那么你有一个更棘手的问题。DataTable 或 DataRow 对象上没有可供您绑定的事件，但 DataRow 中的项目都是对象。这意味着您可能可以在“单元格”级别上做一些事情，特别是如果您使用 WPF 并且可以替换为 System.Windows.Controls.Image 对象。

不过我会小心的。这听起来可能是过早优化的情况。

# objective-c - 当我在 Obj-C 方法调用中将它作为参数传递时，为什么我的 NSInteger 从 12345 变为 -1758050543？

> ID：837472
> 
> 赞同：2
> 
> 时间：2009-05-07T22:57:03.887
> 
> 标签：objective-c, parameters, arguments, nslog

这是 AlertTableView 中的代码：

```
- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex{
    NSInteger index = 12345;
    NSLog(@"AlertTableView: selecting row at index %d", index);
    [self.caller didSelectRowAtIndex:index withContext:self.context];
} 
```

在 self.caller 中：

```
- (void)didSelectRowAtIndex:(NSInteger)row withContext:(id)context {
    NSLog(@"Selected row at index %d with context %@", index, context);
} 
```

控制台输出：

```
2009-05-07 15:51:30.619 Whiteboard[15165:20b] AlertTableView: selecting row at index 12345
2009-05-07 15:51:30.620 Whiteboard[15165:20b] Selected row at index -1758050543 with context <Picker: 0x587c20> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-07T23:13:07.950

看起来您的方法范围内没有“索引”，请尝试以下操作：

```
- (void)didSelectRowAtIndex:(NSInteger)row withContext:(id)context {
  NSLog(@"Selected row at index %d with context %@", row, context);
} 
```

只是看起来像一个错字:)

# java - hashCode/equals 合约的 JUnit 理论

> ID：837484
> 
> 赞同：22
> 
> 时间：2009-05-07T23:03:05.743
> 
> 标签：java, unit-testing, junit

以下类用作 equals/hashCode 合约的通用测试器。它是本地测试框架的一部分。

*   你有什么想法？
*   我如何（强）测试这门课？
*   是很好地利用了 Junit 理论吗？

班上：

```
@Ignore
@RunWith(Theories.class)
public abstract class ObjectTest {

    // For any non-null reference value x, x.equals(x) should return true
    @Theory
    public void equalsIsReflexive(Object x) {
        assumeThat(x, is(not(equalTo(null))));
        assertThat(x.equals(x), is(true));
    }

    // For any non-null reference values x and y, x.equals(y) 
    // should return true if and only if y.equals(x) returns true.
    @Theory
    public void equalsIsSymmetric(Object x, Object y) {
        assumeThat(x, is(not(equalTo(null))));
        assumeThat(y, is(not(equalTo(null))));
        assumeThat(y.equals(x), is(true));
        assertThat(x.equals(y), is(true));
    }

    // For any non-null reference values x, y, and z, if x.equals(y)
    // returns true and y.equals(z) returns true, then x.equals(z) 
    // should return true.
    @Theory
    public void equalsIsTransitive(Object x, Object y, Object z) {
        assumeThat(x, is(not(equalTo(null))));
        assumeThat(y, is(not(equalTo(null))));
        assumeThat(z, is(not(equalTo(null))));
        assumeThat(x.equals(y) && y.equals(z), is(true));
        assertThat(z.equals(x), is(true));
    }

    // For any non-null reference values x and y, multiple invocations
    // of x.equals(y) consistently return true  or consistently return
    // false, provided no information used in equals comparisons on
    // the objects is modified.
    @Theory
    public void equalsIsConsistent(Object x, Object y) {
        assumeThat(x, is(not(equalTo(null))));
        boolean alwaysTheSame = x.equals(y);

        for (int i = 0; i < 30; i++) {
            assertThat(x.equals(y), is(alwaysTheSame));
        }
    }

    // For any non-null reference value x, x.equals(null) should
    // return false.
    @Theory
    public void equalsReturnFalseOnNull(Object x) {
        assumeThat(x, is(not(equalTo(null))));
        assertThat(x.equals(null), is(false));
    }

    // Whenever it is invoked on the same object more than once 
    // the hashCode() method must consistently return the same 
    // integer.
    @Theory
    public void hashCodeIsSelfConsistent(Object x) {
        assumeThat(x, is(not(equalTo(null))));
        int alwaysTheSame = x.hashCode();

        for (int i = 0; i < 30; i++) {
            assertThat(x.hashCode(), is(alwaysTheSame));
        }
    }

    // If two objects are equal according to the equals(Object) method,
    // then calling the hashCode method on each of the two objects
    // must produce the same integer result.
    @Theory
    public void hashCodeIsConsistentWithEquals(Object x, Object y) {
        assumeThat(x, is(not(equalTo(null))));
        assumeThat(x.equals(y), is(true));
        assertThat(x.hashCode(), is(equalTo(y.hashCode())));
    }

    // Test that x.equals(y) where x and y are the same datapoint 
    // instance works. User must provide datapoints that are not equal.
    @Theory
    public void equalsWorks(Object x, Object y) {
        assumeThat(x, is(not(equalTo(null))));
        assumeThat(x == y, is(true));
        assertThat(x.equals(y), is(true));
    }

    // Test that x.equals(y) where x and y are the same datapoint instance
    // works. User must provide datapoints that are not equal.
    @Theory
    public void notEqualsWorks(Object x, Object y) {
        assumeThat(x, is(not(equalTo(null))));
        assumeThat(x != y, is(true));
        assertThat(x.equals(y), is(false));
    }
} 
```

用法：

```
import org.junit.experimental.theories.DataPoint;

public class ObjectTestTest extends ObjectTest {

    @DataPoint
    public static String a = "a";
    @DataPoint
    public static String b = "b";
    @DataPoint
    public static String nullString = null;
    @DataPoint
    public static String emptyString = "";
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-08T03:45:56.267

需要考虑的一件事：测试对象是否符合 equals 契约应该涉及其他类型的实例。特别是，子类或超类的实例可能会出现问题。[Joshua Bloch 对Effective Java](http://java.sun.com/developer/Books/effectivejava/Chapter3.pdf)中的相关陷阱给出了很好的解释（我正在重用 duffymo 的链接，所以他应该为此获得荣誉）——请参阅涉及 Point 和 ColorPoint 类的传递性部分。

诚然，您的实现不会阻止某人编写涉及子类实例的测试，但由于`ObjectTest`是一个泛型类，它给人的印象是所有数据点都应该来自一个类（被测试的类）。完全删除类型参数可能会更好。只是思考的食物。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-07T23:42:13.840

[Joshua Bloch 在“Effective Java”的第 3 章中](http://java.sun.com/developer/Books/effectivejava/Chapter3.pdf)列出了 hash code 和 equals 的约定。看起来你涵盖了很多。检查文档，看看我是否遗漏了什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-07-01T09:44:52.357

也许我遗漏了一些东西，但实际上只有在必须使用具有相同值的 DataPoints 时才能正确测试 equalsIsSymmetric 测试（例如 String a = "a"; String a2 = "a";）否则这个测试只完成当 2 个参数是一个实例时（即 equalsIsSymmetric(a, a);）。实际上，您再次测试 equals 是否遵守“反射”要求而不是对称要求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-08-22T12:49:41.163

notEqualsWorks(Object x, Object y) 理论是错误的：根据 equals 方法，两个不同的实例在逻辑上可能仍然相等；如果它们是不同的引用，您假设实例在逻辑上是不同的。

使用上面您自己的示例，下面的两个不同数据点 (a != a2) 仍然相等，但未通过 notEqualsWorks 测试：

```
@DataPoint
public static String a = "a";
@DataPoint
public static String a2 = new String("a"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-06-04T05:16:47.597

该`equalsWorks(Object x, Object y)`方法正在执行与`equalsIsReflexive(Object x)`. 它应该被删除。

我还认为`notEqualsWorks(Object x, Object y)`应该删除它，因为它阻止了一个人用相等的数据点做其他理论，即使整个测试都是关于拥有这样的对象。

没有这些数据点，反身性是唯一需要测试的东西。

# c# - 如何在 .NET 控制台应用程序中获取应用程序的路径？

> ID：837488
> 
> 赞同：1072
> 
> 时间：2009-05-07T23:05:09.640
> 
> 标签：c#, .net, console, console-application

如何在控制台应用程序中找到应用程序的路径？

在[Windows Forms](http://en.wikipedia.org/wiki/Windows_Forms)中，我可以`Application.StartupPath`用来查找当前路径，但这似乎在控制台应用程序中不可用。

* * *

## 回答 #1

> 赞同：1294
> 
> 时间：2009-05-07T23:09:06.277

[`System.Reflection.Assembly.GetExecutingAssembly()`](https://docs.microsoft.com/en-us/dotnet/api/system.reflection.assembly.getexecutingassembly). ¹[`Location`](https://docs.microsoft.com/en-us/dotnet/api/system.reflection.assembly.location)

[`System.IO.Path.GetDirectoryName`](https://docs.microsoft.com/en-us/dotnet/api/system.io.path.getdirectoryname)如果您想要的只是目录，请将其结合起来。

> ¹*根据 Mr.Mindor 的评论：*
> `System.Reflection.Assembly.GetExecutingAssembly().Location`返回执行程序集当前所在的位置，该位置可能是也可能不是程序集未执行时所在的位置。在卷影复制程序集的情况下，您将获得临时目录中的路径。[`System.Reflection.Assembly.GetExecutingAssembly().CodeBase`](https://docs.microsoft.com/en-us/dotnet/api/system.reflection.assembly.codebase)将返回程序集的“永久”路径。

* * *

## 回答 #2

> 赞同：448
> 
> 时间：2009-05-08T19:03:47.270

您可以使用以下代码获取当前应用程序目录。

```
AppDomain.CurrentDomain.BaseDirectory 
```

* * *

## 回答 #3

> 赞同：204
> 
> 时间：2011-10-14T18:27:47.700

您有两个选项可用于查找应用程序的目录，您的选择将取决于您的目的。

```
// to get the location the assembly is executing from
//(not necessarily where the it normally resides on disk)
// in the case of the using shadow copies, for instance in NUnit tests, 
// this will be in a temp directory.
string path = System.Reflection.Assembly.GetExecutingAssembly().Location;

//To get the location the assembly normally resides on disk or the install directory
string path = System.Reflection.Assembly.GetExecutingAssembly().CodeBase;

//once you have the path you get the directory with:
var directory = System.IO.Path.GetDirectoryName(path); 
```

* * *

## 回答 #4

> 赞同：90
> 
> 时间：2011-05-21T13:27:27.373

可能有点晚了，但值得一提：

```
Environment.GetCommandLineArgs()[0]; 
```

或更正确地获取目录路径：

```
System.IO.Path.GetDirectoryName(Environment.GetCommandLineArgs()[0]); 
```

**编辑：**

不少人指出，`GetCommandLineArgs`不保证返回程序名。请参阅[命令行上的第一个单词是程序名，只是按照惯例](http://blogs.msdn.com/b/oldnewthing/archive/2006/05/15/597984.aspx)。该文章确实指出“尽管极少数 Windows 程序使用此怪癖（我自己不知道）”。所以“欺骗”是可能的`GetCommandLineArgs`，但我们谈论的是控制台应用程序。控制台应用程序通常又快又脏。所以这符合我的 KISS 理念。

* * *

## 回答 #5

> 赞同：51
> 
> 时间：2011-10-06T19:42:16.337

对于任何对 asp.net 网络应用程序感兴趣的人。这是我的 3 种不同方法的结果

```
protected void Application_Start(object sender, EventArgs e)
{
  string p1 = System.IO.Path.GetDirectoryName(System.Reflection.Assembly.GetExecutingAssembly().Location);
  string p2 = System.Web.Hosting.HostingEnvironment.ApplicationPhysicalPath;
  string p3 = this.Server.MapPath("");
  Console.WriteLine("p1 = " + p1);
  Console.WriteLine("p2 = " + p2);
  Console.WriteLine("p3 = " + p3);
} 
```

结果

```
p1 = C:\Windows\Microsoft.NET\Framework64\v4.0.30319\Temporary ASP.NET Files\root\a897dd66\ec73ff95\assembly\dl3\ff65202d\29daade3_5e84cc01
p2 = C:\inetpub\SBSPortal_staging\
p3 = C:\inetpub\SBSPortal_staging 
```

该应用程序是从“C:\inetpub\SBSPortal_staging”物理运行的，所以第一个解决方案绝对不适合网络应用程序。

* * *

## 回答 #6

> 赞同：47
> 
> 时间：2012-04-13T20:20:44.323

上面的答案是我需要的 90%，但为我返回了 Uri 而不是常规路径。

如 MSDN 论坛帖子中所述，[如何将 URI 路径转换为普通文件路径？](http://social.msdn.microsoft.com/Forums/ar/csharplanguage/thread/9341a48b-5c23-4b54-a354-2e21732cbea5)，我使用了以下内容：

```
// Get normal filepath of this assembly's permanent directory
var path = new Uri(
    System.IO.Path.GetDirectoryName(
        System.Reflection.Assembly.GetExecutingAssembly().CodeBase)
    ).LocalPath; 
```

* * *

## 回答 #7

> 赞同：32
> 
> 时间：2009-05-07T23:10:02.687

您可能希望这样做：

```
System.IO.Path.GetDirectoryName(
    System.Reflection.Assembly.GetExecutingAssembly().GetName().CodeBase) 
```

* * *

## 回答 #8

> 赞同：32
> 
> 时间：2018-02-02T02:14:02.597

如果您正在寻找与 .NET Core 兼容的方式，请使用

```
System.AppContext.BaseDirectory 
```

这是在 .NET Framework 4.6 和 .NET Core 1.0（和 .NET Standard 1.3）中引入的。请参阅：[AppContext.BaseDirectory 属性](https://docs.microsoft.com/en-us/dotnet/api/system.appcontext.basedirectory?view=netframework-4.7.1)。

根据[这个页面](http://www.anotherchris.net/csharp/6-ways-to-get-the-current-directory-in-csharp/)，

> 这是 .NET Core 中 AppDomain.CurrentDomain.BaseDirectory 的首选替代品

* * *

## 回答 #9

> 赞同：24
> 
> 时间：2012-11-15T20:06:43.180

你可以改用这个。

```
System.Environment.CurrentDirectory 
```

* * *

## 回答 #10

> 赞同：21
> 
> 时间：2014-06-18T21:34:34.553

对于控制台应用程序，您可以尝试以下操作：

```
System.IO.Directory.GetCurrentDirectory(); 
```

输出（在我的本地机器上）：

> c:\users\xxxxxxx\documents\visual studio 2012\Projects\ImageHandler\GetDir\bin\Debug

或者您可以尝试（最后有一个额外的反斜杠）：

```
AppDomain.CurrentDomain.BaseDirectory 
```

输出：

> c:\users\xxxxxxx\documents\visual studio 2012\Projects\ImageHandler\GetDir\bin\Debug\

* * *

## 回答 #11

> 赞同：17
> 
> 时间：2017-01-31T08:17:40.380

我已经使用了这段代码并得到了解决方案。

```
AppDomain.CurrentDomain.BaseDirectory 
```

* * *

## 回答 #12

> 赞同：13
> 
> 时间：2018-02-23T19:24:42.163

以下行将为您提供应用程序路径：

```
var applicationPath = Path.GetDirectoryName(Process.GetCurrentProcess().MainModule.FileName) 
```

上述解决方案在以下情况下正常工作：

*   简单的应用程序
*   在 Assembly.GetEntryAssembly() 将返回 null 的另一个域中
*   DLL 作为字节数组从嵌入式资源加载并作为 Assembly.Load(byteArrayOfEmbeddedDll) 加载到 AppDomain
*   使用 Mono 的`mkbundle`捆绑包（没有其他方法有效）

* * *

## 回答 #13

> 赞同：9
> 
> 时间：2016-04-26T10:26:09.210

您可以简单地添加到您的项目引用中`System.Windows.Forms`，然后`System.Windows.Forms.Application.StartupPath` 像往常一样使用 .

因此，不需要更复杂的方法或使用反射。

* * *

## 回答 #14

> 赞同：8
> 
> 时间：2014-04-07T16:57:01.990

我用过

```
System.AppDomain.CurrentDomain.BaseDirectory 
```

当我想找到相对于应用程序文件夹的路径时。这适用于 ASP.Net 和 winform 应用程序。它也不需要对 System.Web 程序集的任何引用。

* * *

## 回答 #15

> 赞同：7
> 
> 时间：2014-07-24T20:56:42.093

我的意思是，为什么不使用 ap/invoke 方法？

```
 using System;
    using System.IO;
    using System.Runtime.InteropServices;
    using System.Text;
    public class AppInfo
    {
            [DllImport("kernel32.dll", CharSet = CharSet.Auto, ExactSpelling = false)]
            private static extern int GetModuleFileName(HandleRef hModule, StringBuilder buffer, int length);
            private static HandleRef NullHandleRef = new HandleRef(null, IntPtr.Zero);
            public static string StartupPath
            {
                get
                {
                    StringBuilder stringBuilder = new StringBuilder(260);
                    GetModuleFileName(NullHandleRef, stringBuilder, stringBuilder.Capacity);
                    return Path.GetDirectoryName(stringBuilder.ToString());
                }
            }
    } 
```

您可以像 Application.StartupPath 一样使用它：

```
 Console.WriteLine("The path to this executable is: " + AppInfo.StartupPath + "\\" + System.Diagnostics.Process.GetCurrentProcess().ProcessName + ".exe"); 
```

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2012-03-29T12:41:00.607

`Assembly.GetEntryAssembly().Location`或者`Assembly.GetExecutingAssembly().Location`

与 结合使用`System.IO.Path.GetDirectoryName()`以仅获取目录。

`GetEntryAssembly()`来自和的路径`GetExecutingAssembly()`可以不同，即使在大多数情况下目录是相同的。

`GetEntryAssembly()`您必须注意，`null`如果入口模块是非托管的（即 C++ 或 VB6 可执行文件），这可能会返回。在这些情况下，可以`GetModuleFileName`从 Win32 API 使用：

```
[DllImport("kernel32.dll", CharSet = CharSet.Auto)]
public static extern int GetModuleFileName(HandleRef hModule, StringBuilder buffer, int length); 
```

* * *

## 回答 #17

> 赞同：6
> 
> 时间：2013-02-15T18:19:39.760

如果应该通过双击来调用exe，我会使用它

```
var thisPath = System.IO.Directory.GetCurrentDirectory(); 
```

* * *

## 回答 #18

> 赞同：6
> 
> 时间：2015-04-12T12:08:30.987

在 VB.net

```
My.Application.Info.DirectoryPath 
```

为我工作（应用程序类型：类库）。不确定 C#... 以字符串形式返回不带文件名的路径

* * *

## 回答 #19

> 赞同：5
> 
> 时间：2014-07-14T06:43:49.480

```
AppDomain.CurrentDomain.BaseDirectory 
```

将解决问题，以使用安装包引用第 3 方参考文件。

* * *

## 回答 #20

> 赞同：5
> 
> 时间：2018-02-07T19:03:49.133

我没有看到有人将 .Net Core 反射提供的 LocalPath 转换为可用的 System.IO 路径，所以这是我的版本。

```
public static string GetApplicationRoot()
{
   var exePath = new Uri(System.Reflection.
   Assembly.GetExecutingAssembly().CodeBase).LocalPath;

   return new FileInfo(exePath).DirectoryName;

} 
```

这将返回`C:\\xxx\\xxx`您的代码所在位置的完整格式化路径。

* * *

## 回答 #21

> 赞同：4
> 
> 时间：2017-11-20T09:42:03.820

试试这个简单的代码行：

```
 string exePath = Path.GetDirectoryName( Application.ExecutablePath); 
```

* * *

## 回答 #22

> 赞同：4
> 
> 时间：2021-03-05T15:22:50.240

使用 .NET Core 3 及更高版本，您将获得 .dll 而不是 .exe 文件。要获取您可以使用的 .exe 文件路径。

```
var appExePath = Process.GetCurrentProcess().MainModule.FileName; 
```

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2017-02-05T08:54:41.953

这些方法在特殊情况下都不起作用，例如使用指向 exe 的符号链接，它们将返回链接的位置而不是实际的 exe。

所以可以使用[QueryFullProcessImageName](https://msdn.microsoft.com/en-us/library/ms684919(v=vs.85).aspx)来解决这个问题：

```
using System;
using System.IO;
using System.Runtime.InteropServices;
using System.Text;
using System.Diagnostics;

internal static class NativeMethods
{
    [DllImport("kernel32.dll", SetLastError = true)]
    internal static extern bool QueryFullProcessImageName([In]IntPtr hProcess, [In]int dwFlags, [Out]StringBuilder lpExeName, ref int lpdwSize);

    [DllImport("kernel32.dll", SetLastError = true)]
    internal static extern IntPtr OpenProcess(
        UInt32 dwDesiredAccess,
        [MarshalAs(UnmanagedType.Bool)]
        Boolean bInheritHandle,
        Int32 dwProcessId
    );
}

public static class utils
{

    private const UInt32 PROCESS_QUERY_INFORMATION = 0x400;
    private const UInt32 PROCESS_VM_READ = 0x010;

    public static string getfolder()
    {
        Int32 pid = Process.GetCurrentProcess().Id;
        int capacity = 2000;
        StringBuilder sb = new StringBuilder(capacity);
        IntPtr proc;

        if ((proc = NativeMethods.OpenProcess(PROCESS_QUERY_INFORMATION | PROCESS_VM_READ, false, pid)) == IntPtr.Zero)
            return "";

        NativeMethods.QueryFullProcessImageName(proc, 0, sb, ref capacity);

        string fullPath = sb.ToString(0, capacity);

        return Path.GetDirectoryName(fullPath) + @"\";
    }
} 
```

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2020-06-18T12:40:14.103

`Path.GetDirectoryName(System.Diagnostics.Process.GetCurrentProcess().MainModule.FileName)` 在我尝试过的每一种情况下，它都是唯一对我有用的。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2021-11-24T13:26:42.707

对于 .NET 6，有 Environment.ProcessPath。

请参阅[https://docs.microsoft.com/en-us/dotnet/api/system.environment.processpath?view=net-6.0](https://docs.microsoft.com/en-us/dotnet/api/system.environment.processpath?view=net-6.0)

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2021-09-29T09:34:22.267

我将它用于控制台 + 网络 6

```
Path.GetDirectoryName(System.Reflection.Assembly.GetExecutingAssembly().Location) 
```

* * *

## 回答 #27

> 赞同：-1
> 
> 时间：2016-03-09T10:35:58.967

这是一个适用于**32 位**和**64 位**应用程序的可靠解决方案。

添加这些参考：

> 使用 System.Diagnostics；
> 
> 使用 System.Management；

将此方法添加到您的项目中：

```
public static string GetProcessPath(int processId)
{
    string MethodResult = "";
    try
    {
        string Query = "SELECT ExecutablePath FROM Win32_Process WHERE ProcessId = " + processId;

        using (ManagementObjectSearcher mos = new ManagementObjectSearcher(Query))
        {
            using (ManagementObjectCollection moc = mos.Get())
            {
                string ExecutablePath = (from mo in moc.Cast<ManagementObject>() select mo["ExecutablePath"]).First().ToString();

                MethodResult = ExecutablePath;

            }

        }

    }
    catch //(Exception ex)
    {
        //ex.HandleException();
    }
    return MethodResult;
} 
```

现在像这样使用它：

```
int RootProcessId = Process.GetCurrentProcess().Id;

GetProcessPath(RootProcessId); 
```

注意，如果你知道进程的id，那么这个方法会返回对应的ExecutePath。

**另外，对于那些感兴趣的人：**

```
Process.GetProcesses() 
```

...将为您提供所有当前正在运行的进程的数组，并且...

```
Process.GetCurrentProcess() 
```

...将为您提供当前进程，以及他们的信息，例如 Id 等，以及有限的控制，例如 Kill 等。*

* * *

## 回答 #28

> 赞同：-6
> 
> 时间：2012-05-28T11:36:12.690

您可以使用解决方案资源管理器在项目中创建一个文件夹名称为资源，然后您可以在资源中粘贴一个文件。

```
private void Form1_Load(object sender, EventArgs e) {
    string appName = Environment.CurrentDirectory;
    int l = appName.Length;
    int h = appName.LastIndexOf("bin");
    string ll = appName.Remove(h);                
    string g = ll + "Resources\\sample.txt";
    System.Diagnostics.Process.Start(g);
} 
```

# silverlight - 如何从 Silverlight 中的 BitmapImage 读取像素的颜色？

> ID：837499
> 
> 赞同：1
> 
> 时间：2009-05-07T23:08:21.287
> 
> 标签：silverlight, pixels, bitmapimage

我在 Silverlight 中有一个 BitmapImage 实例，我试图找到一种方法来读取图像中每个像素的颜色信息。我怎样才能做到这一点？我看到这个类上有一个`CopyPixels()`方法可以将像素信息写入您传递的数组中，但我不知道如何从该数组中读取颜色信息。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-10-22T13:42:24.547

在 Silverlight 3 中查找`WriteableBitmap`该类。该类有一个成员`Pixels`，它以 int 数组形式返回位图的像素数据。

带有变换的示例。`bi`是一个`BitmapImage`对象。

```
Image img = new Image();
img.source = bi;

img.Measure(new Size(100, 100));
img.Arrange(new Rect(0, 0, 100, 100));

ScaleTransform scaleTrans = new ScaleTransform();
double scale = (double)500 / (double)Math.Max(bi.PixelHeight, bi.PixelWidth);
scaleTrans.CenterX = 0;
scaleTrans.CenterY = 0;
scaleTrans.ScaleX = scale;
scaleTrans.ScaleY = scale;

WriteableBitmap writeableBitmap = new WriteableBitmap(500, 500);
writeableBitmap.Render(img, scaleTrans);

int[] pixelData = writeableBitmap.Pixels; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T23:49:25.663

对于当前发布的 Silverlight 3 beta 中的当前位图 API，这是不可能的。

Silverlight BitmapImage 文件没有 CopyPixels 方法。请在[此处](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.bitmapimage(VS.96).aspx)查看 MSDN 文档。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-23T10:02:33.373

首先，您应该使用`WritableBitmap`来获取像素集合：`WriteableBitmap bmp = new WriteableBitmap(bitmapImageObj);`. 每个像素都表示为 32 位整数。我已经制作了结构，它只是有助于将整数拆分为四个字节（ARGB）。

```
struct BitmapPixel
{
    public byte A;
    public byte R;
    public byte G;
    public byte B;

    public BitmapPixel(int pixel)
        : this(BitConverter.GetBytes(pixel))
    {
    }

    public BitmapPixel(byte[] pixel)
        : this(pixel[3], pixel[2], pixel[1], pixel[0])
    {
    }

    public BitmapPixel(byte a, byte r, byte g, byte b)
    {
        this.A = a;
        this.R = r;
        this.G = g;
        this.B = b;
    }

    public int ToInt32()
    {
        byte[] pixel = new byte[4] { this.B, this.G, this.R, this.A };
        return BitConverter.ToInt32(pixel, 0);
    }
} 
```

以下是如何使用它来更改红色值的示例：

```
BitmapPixel pixel = new BitmapPixel(bmp.Pixels[0]);
pixel.R = 255;
bmp.Pixels[0] = pixel.ToInt32(); 
```

另外我想提一下[WriteableBitmap.Pixels](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.writeablebitmap.pixels%28v=vs.95%29.aspx)是预乘 RGB 格式。[本文](http://nokola.com/blog/post/2010/01/27/The-Most-Important-Silverlight-WriteableBitmap-Gotcha-Does-It-LoseChange-Colors.aspx)将解释它的含义。以下是使用 BitmapPixel 结构进行补偿的方法：

```
public static void CompensateRGB(int[] pixels)
{
    for (int i = 0; i < pixels.Length; i++)
    {
        BitmapPixel pixel = new BitmapPixel(pixels[i]);

        if (pixel.A == 255 || pixel.A == 0)
            continue;

        if (pixel.R == 0 && pixel.G == 0 && pixel.B == 0)
        {
            // color is unrecoverable, get rid of this
            // pixel by making it transparent
            pixel.A = 0;
        }
        else
        {
            double factor = 255.0 / pixel.A;

            pixel.A = 255;
            pixel.R = (byte)(pixel.R * factor);
            pixel.G = (byte)(pixel.G * factor);
            pixel.B = (byte)(pixel.B * factor);
        }

        pixels[i] = pixel.ToInt32();
    }
} 
```

# java - Substance 中的 JTree 连接线

> ID：837505
> 
> 赞同：2
> 
> 时间：2009-05-07T23:10:44.633
> 
> 标签：java, swing, look-and-feel

使用新版本的 Java 实质外观和感觉，典型 JTree 中的连接线不会被绘制（父 - 子线）。

在 java.net 的官方论坛中，有人问过[同样](https://substance.dev.java.net/servlets/ProjectForumMessageView?forumID=1484&messageID=26733)的问题，开发人员对此的回答是，这是基于较新 UI 的选择，并且没有计划在未来实施该选项。

他的回答还说，您可以通过继承 SubstanceUI 类并实现 paintHorizo​​ntalPartOfLeg / paintVerticalPartOfLeg 方法自己实现这一点。

有人可以解释所需的过程或者给我一个例子吗？我确信一定有人这样做了，因为代表开发人员选择不画这些线是一个非常奇怪的选择。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-08T02:46:06.940

这一切都来自记忆。如果我明天发现有任何问题，我会编辑。

查看 BasicTreeUI 或 MetalTreeUI。我相信他们都画线。

您需要做的是创建一个新类，该类扩展（我在这里猜测名称）SubstanceTreeUI 并覆盖paintHorizo​​ntalPartOfLeg() 和paintVerticalPartOfLeg()。然后你有一个选择：

1.  您可以调用 myTree.setUI( new MyTreeUI() )
2.  UIManager.getDefaults().put("TreeUI", MyTreeUI.class.getName() ) 在您制作 JTree 之前的某个时间点

如果您不想子类化，请尝试 UIManager.getDefaults().put("TreeUI", BasicTreeUI.class.getName() ) 看看是否可以。

编辑 2：经过进一步审查，在创建树之前调用 JTree 上的 .setUI(new BasicTreeUI()) 或调用 UIManager.getDefaults().put("TreeUI", BasicTreeUI.class.getName() ) 会更容易.

编辑：
SubstanceTreeUI 是 BasicTreeUI 的子类。它已经覆盖了paintXXXPartOfLeg()。

水平：

```
@Override
protected void paintHorizontalPartOfLeg(Graphics g, Rectangle clipBounds,
        Insets insets, Rectangle bounds, TreePath path, int row,
        boolean isExpanded, boolean hasBeenExpanded, boolean isLeaf) {
    boolean toPaint = (!this.tree.isEnabled())
            || this.isInside
            || !FadeConfigurationManager.getInstance().fadeAllowed(
                    SubstanceLookAndFeel.TREE_DECORATIONS_ANIMATION_KIND,
                    tree);
    if (FadeTracker.getInstance().isTracked(this.tree, SubstanceLookAndFeel.TREE_DECORATIONS_ANIMATION_KIND)) {
        Graphics2D graphics = (Graphics2D) g.create();
        graphics.setComposite(TransitionLayout
                .getAlphaComposite(this.tree,
                        FadeTracker.getInstance()
                            .getFade10(this.tree,SubstanceLookAndFeel.TREE_DECORATIONS_ANIMATION_KIND) / 10.0f,
                            g));
        super.paintHorizontalPartOfLeg(graphics, clipBounds, insets,
                bounds, path, row, isExpanded, hasBeenExpanded, isLeaf);
        graphics.dispose();
    } else if (toPaint) {
        super.paintHorizontalPartOfLeg(g, clipBounds, insets, bounds, path,
                row, isExpanded, hasBeenExpanded, isLeaf);
    }
} 
```

看起来只有以下任一情况为真时才会绘制线条：

*   树未启用，鼠标位于树边界 [this.inside] 并且树上不允许淡入 (?) [!FadeConfigurationManager.getInstance().fadeAllowed(...)]
*   FadeTracker 正在跟踪 JTree [FadeTracker.getInstance().isTracked(...)]

弄清楚如何确保 FadeTracker 正在跟踪 JTree，或者尝试这个非常粗略的 hack（见下文）：

您还可以将 BasicTreeUI 的 paintXXXPartOfLeg 方法中的代码剪切并粘贴到子类中。

```
public MyTree extends JTree {
    private boolean overrideIsEnable = false;
    public void setOverrideIsEnable(boolean b) { overrideIsEnabeld=true; }
    public boolean isOverrideIsEnable(boolean b) { return overrideIsEnabeld; }
    public boolean isEnabled() {
        if(overrideIsEnabled) return false;
        return super.isEnabled();
    }
}

class MyTreeUI extends SubstanceTreeUI {
protected void paintHorizontalPartOfLeg(Graphics g, Rectangle clipBounds,
        Insets insets, Rectangle bounds, TreePath path, int row,
        boolean isExpanded, boolean hasBeenExpanded, boolean isLeaf) {
if(this.tree instanceof MyTree)
try {
   Field f = SubstanceTreeUI.class.getDeclaredField("inside");
   f.setAccessible(true);
   Boolean v = (Boolean)f.get(this);
   f.set(this,Boolean.true);
   ((MyTree)this.tree).setOverrideIsEnable(true);
} catch(Throwable t) {
   //want to default back to substanceUI if this fails.
}
super.paintHoriz.....();
try{
    f.set(this,v);
    ((MyTree)this.tree).setOverrideIsEnable(true);
}catch(Throwable t) {
   //see above
}
}
//repeat for Vertical
} 
```

# iphone - 一次将 UiImageView 添加到 UiScrollView ......但是如何？

> ID：837510
> 
> 赞同：2
> 
> 时间：2009-05-07T23:11:40.857
> 
> 标签：iphone, cocoa-touch

我的问题是我的 300 张图像被添加到 UiScrollView 并在完成 addsubview: 调用后显示出来。

如何设置它以添加一个子视图，谁在屏幕上..并继续添加？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T23:40:03.737

您可以仅向 UIScrollView 添加适合屏幕的前几张图片，然后根据请求添加其他图片，当用户滚动时，您必须检查边界并添加新图片（如果它会显示）。

我不确定代码细节。

我确信带有 3 张图像的 UIScrollView 显示在[斯坦福 CS193P 课程关于 iPhone 开发的](http://www.stanford.edu/class/cs193p/cgi-bin/index.php)第 8 讲（包括源代码）的演示中，演示者（来自 Apple 的人）在视频（在 iTunesU 上）中提到，你可以按需加载其他图像-他只是给出了一般性的指示，而不是实际的解决方案。

但是，如果您需要显示充满图标大小图像的屏幕（有点像 iphone 图像库），那么尝试 UITableView 可能会更好（我还没有为此目的使用它，但试一试）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T23:54:33.593

stefanB 的回答很好。有关代码详细信息，我建议您查看`- [UIView drawRect:]`. 给定每行的大小，您可以轻松计算传递的矩形何时表示由于滚动而进入视野的新单元格，然后相应地使用新图像进行更新。

你有没有想过把你的图像不放在 UIScrollView 中，而是放在 UITableView 中，并让它为你处理所有的缓存和延迟加载？处理您想做的事情听起来更专业。

# smalltalk - perform 的性能开销：在 Smalltalk 中（特别是 Squeak）

> ID：837518
> 
> 赞同：6
> 
> 时间：2009-05-07T23:14:21.753
> 
> 标签：smalltalk, squeak

平均而言，我可以合理地期望`perform:`比发送文字消息慢多少？我是否应该避免`perform:`在循环中发送，类似于对 Perl/Python 程序员的警告，以避免在循环中调用`eval("...")`（`Compiler evaluate:`在 Smalltalk 中）？

我主要关心 Squeak，但也对其他 Smalltalks 感兴趣。此外，`perform:with:`变体的开销是否更大？谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-07T23:57:05.223

`#perform:`不像`eval()`。（无论如何，在性能方面）的问题`eval()`在于它必须编译您在运行时发送的代码，这是一个非常缓慢的操作。`#perform:`另一方面，Smalltalk等价于 Ruby`send()`或 Objective-C `performSelector:`（事实上，这两种语言都深受 Smalltalk 的启发）。像这样的语言已经根据它们的名称查找方法——`#perform:`只允许您在运行时而不是在写入时指定名称。它不必解析任何语法或编译任何类似`eval()`.

它会慢一点（至少一个额外的方法调用的成本），但它不像`eval()`. 此外，具有更多参数的变体不应该显示速度与简单的任何差异`perform:whatever`。我不能专门谈论关于 Squeak 的太多经验，但这就是它通常的工作方式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-08-25T12:34:52.830

这是我机器上的一些数字（它是 Smalltalk/X，但我想这些数字是可比的——至少比率应该是）：

被调用的方法 "foo" 和 "foo:" 是一个 noops（即由一个 ^self 组成）：

```
self foo                               ...  3.2 ns
self perform:#foo                      ...  3.3 ns
[self foo] value                       ... 12.5 ns (2 sends and 2 contexts)
[ ] value                              ...  3.1 ns (empty block)
Compiler valuate:('TestClass foo')     ...  1.15 ms

self foo:123                           ...  3.3 ns
self perform:#foo: with:123            ...  3.6 ns
[self foo:123] value                   ...   15 ns (2 sends and 2 contexts)
[self foo:arg] value:123               ...   23 ns (2 sends and 2 contexts)
Compiler valuate:('TestClass foo:123') ...  1.16 ms 
```

注意“执行：”和“评估：”之间的巨大区别；评估是调用编译器来解析字符串，生成一个丢弃的方法（字节码），执行它（它在第一次调用时被jited）并最终被丢弃。编译器实际上主要用于 IDE 并从外部流中归档代码；它具有用于错误报告、警告消息等的代码。通常，当性能至关重要时，eval 不是您想要的。

来自戴尔 Vostro 的计时；您的里程可能会有所不同，但比率不会。我试图通过测量空循环时间并减去来获得净执行时间；此外，我运行了 10 次测试并利用了最好的时间，以消除操作系统/网络/磁盘/电子邮件或任何干扰。但是，我并不真正关心无负载机器。测量代码是（用上面的东西替换了第二次重复参数）：

```
callFoo2
    |t1 t2|

    t1 :=
        TimeDuration toRun:[
            100000000 timesRepeat:[]
        ].

    t2 :=
        TimeDuration toRun:[
            100000000 timesRepeat:[self foo:123]
        ].

    Transcript showCR:t2-t1 
```

编辑： PS：我忘了提：这些是 IDE 内部的时间（即字节码抖动执行）。由于更好的寄存器分配算法，静态编译的代码（使用 stc 编译器）在这些低级微基准测试中通常会更快一些（20-30%）。

编辑：前几天我试图重现这些数字，但得到了完全不同的结果（简单调用为 8ns，而执行为 9ns）。所以要非常小心这些微定时，因为它们完全耗尽了一级缓存（空消息甚至会忽略上下文设置，或者被内联）——它们通常不能很好地代表整体性能。

# c++ - 二进制数据的 C++ STL 字符串等效项

> ID：837521
> 
> 赞同：28
> 
> 时间：2009-05-07T23:14:51.130
> 
> 标签：c++, string, stl, binary

我正在编写一个 C++ 应用程序，我想知道 C++ 在内存中存储字节数组的传统方式是什么。

有没有类似字符串的东西，除了专门为二进制数据制作的。

现在我正在使用 *unsigned char** 数组来存储数据，但更像 STL/C++ 的东西会更好。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-05-07T23:48:02.890

我会用`std::vector<unsigned char>`. 您需要的大多数操作都可以使用带有迭代器范围的 STL 来完成。另外，请记住，如果您确实需要原始数据`&v[0]`，则保证会提供指向底层数组的指针。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-05-07T23:17:24.227

您也`std::string`可以用于二进制数据。中数据的长度`std::string`是显式存储的，而不是由空终止确定的，因此空字节在 a 中没有特殊含义`std::string`。

`std::string`通常比它更方便，`std::vector<char>`因为它提供了许多对处理二进制数据有用但由`vector`. `substr()`要解析/创建二进制数据，拥有诸如, 重载之`+`类的东西是很有用`std::stringstream`的。在向量上，算法`<algorithm>`可以用来实现相同的效果，但它比字符串方法更笨拙。如果您只是对“字符序列”进行操作，`std::string`则可以为您提供通常想要的方法，即使这些序列恰好包含“二进制”数据。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-05-07T23:58:15.627

您应该使用`std::vector<unsigned char>`or `std::vector<uint8_t>`（如果您有现代`stdint.h`标头）。使用`unsigned char[]`或`uint8_t[]`使用固定大小的缓冲区没有任何问题。当`std::vector`您需要经常增长或附加到缓冲区时，真正的亮点是。STL 迭代器与指针具有相同的语义，因此 STL 算法同样适用于`std::vector`普通旧数组。

正如CAdaker 指出的那样，该表达式`&v[0]`保证为您提供指向向量缓冲区的基础指针（并且保证它是一个连续的内存块）。此保证已添加到 C++ 标准的附录中。

就个人而言，我会避免使用`std::string`来操纵任意字节缓冲区，因为我认为这可能会造成混淆，但这并不是一种闻所未闻的做法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-04-30T05:16:20.333

有多种解决方案，但最接近的一个（我觉得）是 `std::vector<std::byte>>`因为它直接在代码中表达了意图。

来自：[https ://en.cppreference.com/w/cpp/types/byte](https://en.cppreference.com/w/cpp/types/byte)

> std::byte 是一种独特的类型，它实现了 C++ 语言定义中指定的字节概念。
> 
> 与 char 和 unsigned char 一样，它可用于访问其他对象占用的原始内存（对象表示），但与那些类型不同，它不是字符类型，也不是算术类型。字节只是位的集合，为它定义的唯一运算符是按位运算符。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-04-30T05:02:43.213

怎么样`std::basic_string<uint8_t>`？

# .net - 协议缓冲区：我应该使用 int64 还是 fixed64 来表示 .NET DateTime 值？

> ID：837537
> 
> 赞同：7
> 
> 时间：2009-05-07T23:21:19.850
> 
> 标签：.net, serialization, protocol-buffers

我需要在协议缓冲区消息中序列化一个 .NET DateTime 值。

我的计划是使用 DateTime.ToBinary() 然后在消息中传递 64 位返回值。但我不确定选择什么作为协议缓冲区数据类型来表示它。

我想我对**何时应该使用 fixed64（或 sfixed64）数据类型感到困惑。**

我假设在这种情况下我会使用带符号的类型，因为 DateTime.ToBinary() 返回的值可以是负数也可以是正数。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-07T23:31:54.317

好吧，您肯定想要`int64`或`sfixed64`处理正在签名的值。

刚刚做了一个快速测试，`DateTime.Now.ToBinary()`使用 10 个字节编码，`int64`而`sfixed64`总是使用 8 个字节。基本上，可变长度编码对于小数字非常有用，但对于大数字来说变得比固定编码更大。（这与使用 UTF-8 而不是 UTF-16 是一种折衷 - ASCII 字符可以在 UTF-8 中以单个字节编码，但后来代码点最终被编码为 2 个字节，然后是 3 个字节，而 UTF -16 总是使用 2 个字节作为 BMP 中的字符。）

我的猜测是`DateTime.ToBinary()`值*可能*非常大（不知道它究竟做了什么的细节），所以`sfixed64`更合适。

那有意义吗？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-08T04:28:06.743

在[protobuf-net](http://code.google.com/p/protobuf-net/)中，我使用分级方法（实际上，如果您简单地使用它，它会为您处理所有这些`DateTime`） - 等效的 .proto 是这样的：

```
message DateTime {
  optional sint64 value = 1; // the offset (in units of the selected scale)
                             // from 1970/01/01
  optional TimeSpanScale scale = 2 [default = DAYS]; // the scale of the
                                                     // timespan
  enum TimeSpanScale {
    DAYS = 0;
    HOURS = 1;
    MINUTES = 2;
    SECONDS = 3;
    MILLISECONDS = 4;

    MINMAX = 15; // dubious
  }
} 
```

即，如果`DateTime`可以用一整天来表示，我只发送自 1970 年以来的天数，等等 - 再加上一个小标记。这意味着可以更有效地发送日期，但对于其他规模而言，它的成本并不高。

就个人而言，我不会使用`ToBinary()`- 我会明确使用已知时代（例如 unix 时代）的已知比例的偏移量。这使其在平台之间更具可移植性。但是，如果您（例如）仅发送毫秒偏移量，那么固定比例通常比变体长度比例更有效。您是否需要签名或未签名取决于您是否需要时代之前的日期；-p

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T23:27:29.057

您应该使用有符号的 64 位数字，不是因为`DateTime`可以为负数，而是因为该`ToBinary`方法返回一个`Int64`，它是一个有符号的 64 位数字。

# c# - SVN 即时转 ZIP

> ID：837541
> 
> 赞同：3
> 
> 时间：2009-05-07T23:22:47.677
> 
> 标签：c#, svn, zip

我已经在我的 Windows 2003 服务器上安装了 VisualSVN，并将其配置为提供匿名读取访问。据我了解，VisualSVN 只使用 apache 和下面的官方 SVN 存储库服务器。

现在，我想扩展 SVN 网页以提供“将 HEAD 下载为 ZIP”功能。[SourceForge](http://svn-web-control.svn.sourceforge.net/viewvc/svn-web-control/trunk/ "sourceforge - 下载 GNU 压缩包")和[Codeplex](http://downloadsvn.codeplex.com/SourceControl/ListDownloadableCommits.aspx "CodePlex - 下载")等 Web 门户确实提供了此功能。

SVN 存储库服务器有这个插件吗？或者可能是一个单独的 Web 客户端（最好是 ASP.NET）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-09T04:58:39.227

我找到了一个解决方案，并想与您分享，以防其他人想要实现相同的解决方案。

在分析[WebSvn](http://websvn.tigris.org/)之后，我发现他们使用 SVN 导出目录功能将源下载到本地文件夹，然后即时压缩目录。性能相当不错。

我在下面的 C# 中的解决方案是使用[SharpSVN](http://sharpsvn.open.collab.net/)和[DotNetZip](http://dotnetzip.codeplex.com/)。完整的源代码可以在[我的 SVN 存储库](http://www.activesoft.nl:8080/svn/blog/trunk/SvnExportDirectory/)中找到。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using SharpSvn;
using Ionic.Zip;
using System.IO;
using SharpSvn.Security;

namespace SvnExportDirectory
{
    public class SvnToZip
    {
        public Uri SvnUri { get; set; }
        public string Username { get; set; }
        public string Password { get; set; }

        private bool passwordSupplied;

        public SvnToZip() { }

        public SvnToZip(Uri svnUri)
        {
            this.SvnUri = svnUri;
        }

        public SvnToZip(string svnUri)
            : this(new Uri(svnUri)) { }

        public void ToFile(string zipPath)
        {
            if (File.Exists(zipPath))
                File.Delete(zipPath);

            using (FileStream stream = File.OpenWrite(zipPath))
            {
                this.Run(stream);
            }
        }

        public MemoryStream ToStream()
        {
            MemoryStream ms = new MemoryStream();
            this.Run(ms);
            ms.Seek(0, SeekOrigin.Begin);
            return ms;
        }

        private void Run(Stream stream)
        {
            string tmpFolder =
                Path.Combine(Path.GetTempPath(), Guid.NewGuid().ToString());

            try
            {
                using (SvnClient client = new SvnClient())
                {
                    //client.Authentication.Clear();
                    client.Authentication.UserNamePasswordHandlers += Authentication_UserNamePasswordHandlers;

                    SvnUpdateResult res;
                    bool downloaded = client.Export(SvnTarget.FromUri(SvnUri), tmpFolder, out res);
                    if (downloaded == false)
                        throw new Exception("Download Failed");
                }

                using (ZipFile zipFile = new ZipFile())
                {
                    zipFile.AddDirectory(tmpFolder, GetFolderName());
                    zipFile.Save(stream);
                }
            }
            finally
            {
                if (File.Exists(tmpFolder))
                    File.Delete(tmpFolder);
            }
        }

        private string GetFolderName()
        {
            foreach (var potential in SvnUri.Segments.Reverse())
            {
                if (string.Equals(potential, "trunk", StringComparison.InvariantCultureIgnoreCase) == false)
                    return potential;
            }
            return null;
        }

        void Authentication_UserNamePasswordHandlers(object sender, SvnUserNamePasswordEventArgs e)
        {
            if (passwordSupplied)
            {
                e.Break = true;
            }
            else
            {
                if (this.Username != null)
                    e.UserName = this.Username;

                if (this.Password != null)
                    e.Password = this.Password;

                passwordSupplied = true;
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T04:07:44.107

我不知道“内置”，但您可以尝试编写一个使用 SharpSVN 和#ZipLib 来完成这项工作的页面......

如果这太慢了，您大概可以使用提交挂钩或计划作业（每隔几分钟或其他时间）将预先准备好的 zip 放在可以返回的地方 - 使用“创建为不同的名称然后重命名准备就绪时”技巧，以最大限度地减少锁定/不可用的时间。或者用修订号命名。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T04:24:59.137

TortoiseSVN 注册了一些浏览器可以识别的可插入协议。svn://blahblahblah ...你可以调查一下。但是你必须使用 TortoiseSVN ......

# vb.net - 如何使用 VB.NET 2005 实现非缓存文件副本？

> ID：837543
> 
> 赞同：0
> 
> 时间：2009-05-07T23:23:02.153
> 
> 标签：vb.net, file

我有一个我编写的程序，可以将选择的文件从一台远程计算机复制到另一台计算机。我用于测试的设置是，一台运行程序的计算机（a）在家中通过 VPN 连接到我的工作网络，两台计算机（b，c）在同一网络上并排工作。我正在尝试将计算机 b 上的文件复制到计算机 c，而程序正在计算机 a 上运行。

唯一的问题是，文件似乎缓存到计算机 a 上的临时文件夹，然后转到计算机 c。什么时候应该直接从计算机 b 到计算机 c。有没有办法阻止文件尝试缓存在运行应用程序的计算机上？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-08T04:13:57.447

好吧，您可以尝试几件事……我不知道它们是否完全适合您；

*   通过 RDC、VNC 或类似的方式远程访问其中一台工作计算机，例如 B，然后将文件从 B 复制到 C，然后直接从 B 上复制。

*   查看工具 psexec。这是 sysinternals 作为其 pstools 套件的一部分发布的。[http://technet.microsoft.com/en-us/sysinternals/bb896649.aspx](http://technet.microsoft.com/en-us/sysinternals/bb896649.aspx)。这允许您通过命令提示符连接到远程机器并从您的机器直接在远程机器上运行命令。

HTH - 加油！

# c# - 向菜单项添加快捷键时如何处理多个控件的复制？

> ID：837545
> 
> 赞同：1
> 
> 时间：2009-05-07T23:24:41.183
> 
> 标签：c#, winforms, forms, copy

如果我**不**创建“编辑->复制”菜单项并为其分配快捷键“CTRL+C”，那么我可以选择一个控件（RichTextBox、DataGridView 等）并点击“CTRL+C”然后控制本身将处理副本。我可以将文本复制出来，并将其粘贴到记事本等中。

现在，在我的整个表单中，我有很多控件。但是我有一个自定义控件，我想明确说明我为它处理复制功能。所以我在 Edit->Copy 中添加了 ShortcutKey CTRL+C，默认设置为 Enabled。

现在，我必须为该菜单项上的“单击”事件实现一个事件处理程序。如果我明确输入代码来处理副本，那么它可以工作：

```
public void menuEditCopy_Click(object sender, EventArgs e)
{
    myCustomControl.Copy();
} 
```

但是，现在 Copy 不适用于任何其他类型的控件。我的第一个倾向是找出具有焦点的控件类型，并为每个控件实现一组有限的复制代码：

```
public void menuEditCopy_Click(object sender, EventArgs e)
{
    if (this.ActiveControl is MyCustomControl)
    {
        ((MyCustomControl)this.ActiveControl).Copy();
    }
    else if (this.ActiveControl is RichTextBox)
    {
        ((RichTextBox)this.ActiveControl).Copy();
    }
} 
```

ETC...

但是，我的控件被添加到 SplitContainer，调试显示 this.ActiveControl 设置为 splitcontainer 实例，而不是控件，即使我知道该控件已被选中。

所以我最后的想法是检查每个控件是否都有焦点：

```
public void menuEditCopy_Click(object sender, EventArgs e)
{
    if (myCustomControl.Focused)
    {
        myCustomControl.Copy();
    }
    else if (richTextBox1.Focused)
    {
        richTextBox1.Copy();
    }
} 
```

如果可能的话，我想避免这种情况，它有很多控件，如果我添加一个新控件，我需要更新它。有没有更好的方法来做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T00:10:01.793

A `SplitContainer`implements `ContainerControl`，因此您可以检查其中一个并寻找它`ActiveControl`。`ContainerControl`是基类，所以我会这样做 - 你也可能会捕获另一种类型的容器：

```
private void DoCopy(Control control)
{
    if(control is ContainerControl)
        DoCopy(control.SelectedControl);
    else if(control is MyCustomControl)
        ((MyCustomControl)control).Copy();
    else if(control is RichTextBox)
        ((RichTextBox)control).Copy();
    else
        throw new NotSupportedException("The selected control can't copy!");
}

void menuEditCopy_Click(object sender, EventArgs e)
{
    DoCopy(this.ActiveControl);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T14:56:41.823

您可以尝试将表单的 KeyPreview 属性设置为 true。然后，您可以为表单的 KeyDown 事件设置一个处理程序，如下所示：

```
private void Form_KeyDown(object sender, KeyEventArgs e)
{
    if(e.Modifiers == Keys.Control && e.KeyCode == Keys.C)
    {
        if (ActiveControl.GetType() == typeof(MyCustomControl))
        {
            ((MyCustomControl)ActiveControl).Copy();
            e.Handled = true;
        }
    }
} 
```

在这里，您通过将 event args Handled 属性设置为 true 来指定您已经处理了 Ctrl-C 事件。否则，如果您将其保留为 false，则每个单独的控件将照常处理 Ctrl-C 按键。

因为我们已经将 KeyPreview 设置为 true，所以表单的处理程序可以在它包含的任何其他控件之前看到每个按键，并且可以决定自己处理按键，或者允许以与表单相同的方式处理它从来没有预览过。

我认为也有必要从菜单项中删除快捷键（尽管您仍然可以手动将文本“Ctrl+C”放在菜单项名称旁边）才能正常工作，否则您的菜单项将劫持击键。

# php - 正则表达式语法在PHP中提取格式的所有实例

> ID：837550
> 
> 赞同：0
> 
> 时间：2009-05-07T23:26:10.620
> 
> 标签：php, regex, extract

我正在尝试从字符串中提取特定格式的所有实例：

> 我想知道我的新索尼 [PT# 123456ABC; Sony] 有这个功能，但我的朋友说是新的 Toshiba [PT# AD-3232hjk; 东芝]有这个功能。

我想提取：

> [PT# 123456ABC；索尼]
> 
> [PT# AD-3232hjk；东芝]

正如您在此处看到的，唯一处于一致位置的项目是：

*   [PT#
*   ;
*   ]

我试图使用各种类型的 strpos() 但由于部件号和制造商名称的长度和格式不同，我无法可靠地从更大的字符串中提取这些实例。我一直在尝试各种方法来使用正则表达式来解决这个问题，但是我对它们的了解相当有限。在我将这些表达式提取并放入变量后，我需要将部件号和制造商名称与表达式分开。这也可能更容易使用正则表达式来完成。

任何帮助表示赞赏。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T23:46:58.383

```
$matches = array();
preg_match_all( "/\[PT#([^\];]+);([^\]]+)\]/", $input, $matches,  PREG_SET_ORDER);

foreach ($matches as $match) {
  echo "id=", trim($match[1]), " brand=", trim($match[2]), "\n";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T23:29:37.163

我认为这会做到

```
preg_match_all( "/(\[PT#\s+.*?;\s+.*?\])/", $input, $matches );

print_r( $matches ); 
```

或者，如果您只是想捕获独特的信息

```
preg_match_all( "/\[PT#\s+(.*?);\s+(.*?)\]/", $input, $matches ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T23:38:32.040

我认为您将从包含大量这些条目的文本文件中读取。你可以做的是：

```
preg_match_all("/\[PT#(.*?);[.*]?(.*?)\]/i", $text, $result); 
```

它会将所有匹配项放入数组 $result 中，您可以这样访问它们：

```
echo $result[1][0]; //echos first occurrence's serial 
```

$result 是排序的主要列，匹配的第一个条目是完整的匹配字符串

```
echo $result[0][0]; // would print [PT# 123456ABC; Sony]
echo $result[1][0]; // would print 123456ABC
echo $result[2][0]; // would print Sony 
```

希望有帮助

编辑：修复了正则表达式，现在应该可以工作（仍然未经测试）

# wpf - 通过 ItemsSource 添加项目时，如何为 ListView 的高度设置动画？

> ID：837552
> 
> 赞同：0
> 
> 时间：2009-05-07T23:26:42.583
> 
> 标签：wpf, listview, animation

我有一个设置了 MinHeight 和 MaxHeight 的 ListView。最终高度由列表中的项目数决定。

此刻，当 ListView 的 ItemsSource 属性添加一个列表时，高度会跳到最终高度。有没有办法为这种高度变化设置动画，使其平滑？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T00:13:16.013

这是一个做你想做的事情的例子（据我所知）。我会称其为“又快又脏”，并没有声称对此进行了很多思考。

```
 public class CustomListView : ListView
    {
        public bool IsAttached
        {
            get { return (bool)GetValue(IsAttachedProperty); }
            set { SetValue(IsAttachedProperty, value); }
        }

        // Using a DependencyProperty as the backing store for IsAttached.  
        // This enables animation, styling, binding, etc...
        public static readonly DependencyProperty IsAttachedProperty =
            DependencyProperty.Register("IsAttached", 
                typeof(bool), 
                typeof(CustomListView), 
                new UIPropertyMetadata(false));
    }

    public class ViewModel : INotifyPropertyChanged
    {
        public void PopulateItems()
        {
            Items = new List<string>();

            for (var i = 0; i < 200; i++ )
            {
                Items.Add("The quick brown fox jumps over the lazy dog.");
            }
            InvokePropertyChanged(new PropertyChangedEventArgs("Items"));

            IsAttached = true;
            InvokePropertyChanged(new PropertyChangedEventArgs("IsAttached"));
        }

        public List<string> Items { get; private set; }
        public bool IsAttached { get; private set; }

        public event PropertyChangedEventHandler PropertyChanged;

        private void InvokePropertyChanged(PropertyChangedEventArgs e)
        {
            var changed = PropertyChanged;

            if (changed != null)
            {
                changed(this, e);
            }
        }
    }

<Window x:Class="AnimateHeight.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:AnimateHeight"
    Title="Window1" Height="300" Width="300">
    <StackPanel>
        <Button Width="100" Content="Add Items" Click="OnClickAddItems"/>
        <local:CustomListView x:Name="VariableListView" ItemsSource="{Binding Items}" IsAttached="{Binding IsAttached}" >
            <local:CustomListView.Style>
                <Style TargetType="{x:Type local:CustomListView}">
                    <Setter Property="MinHeight" Value="50" />
                    <Setter Property="MaxHeight" Value="50" />
                    <Style.Triggers>
                        <Trigger Property="IsAttached" Value="true">
                            <Trigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation 
                                            Storyboard.TargetProperty="(ListView.MaxHeight)" 
                                            To="150" 
                                            Duration="0:0:5"/>
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.EnterActions>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </local:CustomListView.Style>
        </local:CustomListView>
    </StackPanel>
</Window>

    /// <summary>
    /// Interaction logic for Window1.xaml
    /// </summary>
    public partial class Window1 : Window
    {
        public Window1()
        {
            InitializeComponent();

            DataContext = new ViewModel();
        }

        private void OnClickAddItems(object sender, RoutedEventArgs e)
        {
            ((ViewModel)DataContext).PopulateItems();
        }
    } 
```

更新：您应该能够将其复制到 .cs 和 .xaml 文件中并将其作为示例应用程序运行。总结一下我在做什么：将 MaxHeight 属性设置为人为的低值，在我的例子中，我只是将它设置为与 MinHeight 相同的值。然后，您可以创建一个故事板，将 MaxHeight 设置为真实值，从而为您提供平滑的过渡效果。诀窍是指示何时开始动画，我在子类 ListView 中使用依赖属性只是因为这似乎是匆忙实现的最简单的选项。我只需要将依赖属性绑定到我的 ViewModel 中的一个值，我就可以通过更改该值来触发动画（因为我不知道基于对顶部 ListView ItemsSource 的更改来触发动画的简单方法我的头）。

# iphone - 什么时候在实例变量前面加下划线？

> ID：837559
> 
> 赞同：30
> 
> 时间：2009-05-07T23:28:10.397
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch

> **可能重复：**
> [可可objective-c 类中变量前面的下划线如何工作？](https://stackoverflow.com/questions/822487/how-does-an-underscore-in-front-of-a-variable-in-a-cocoa-objective-c-class-work)

我在 Apple 的 UIPickerView.h 中看到了这个：

```
id<UIPickerViewDataSource> _dataSource; 
```

为什么那里有下划线？它有什么特殊含义吗？我必须知道的公约？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-05-07T23:31:58.343

很多人将其用于私有变量，以区分对象中的私有变量和公共变量。

这是一种完全可选的工作方式。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-05-08T05:13:29.910

您看到的是使用下划线来区分实例变量和属性。所以一个类声明可能是：

```
@interface Foo {
  NSString* _label;
  ....
}

@property (nonatomic, retain) NSString* label; // notice: no underline 
```

然后在实现文件中，您将拥有：

```
@synthesize label=_label; // the property is matched with the ivar 
```

现在，当在实现内部时，如果您想直接访问实例变量，您可以使用`_label`，但要通过属性访问器方法（负责保留/释放和一堆其他簿记任务），您将使用`self.label`. 从外面看，你总是想穿过这处`{object}.label`房产。

另一种方法是不使用下划线，只需使用：

```
NSString* label;
@property (nonatomic, retain) NSString* label;
...
@synthesize label; 
```

它的工作原理相同，但可能会使阅读代码并试图跟踪`label`vs的人感到困惑`self.label`。我个人发现 Apple 约定（带有下划线）更容易阅读，但这是一个偏好问题。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-08T00:28:30.547

正如人们已经说过的那样，_someVar 用于表示变量是私有的。这是一个简单的约定问题，并不重要。

另一种用途是在 C 中的回程机器中旅行， _function() 表示一个不可平台移植的函数，而 __function() 表示一个编译器不可移植的函数。因此，在标准 C 库中，您有时会看到名称前带有 _ 或 __ 的变量，这就是这些函数所代表的含义。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-07T23:32:12.787

它有时用于表示私有变量。更一般地说，它只是意味着“这个变量在某种程度上是不同的”。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-08T14:06:54.940

难道是……（慢跑记忆）……

我依稀记得读过一个 ADC 文档，解释苹果保留使用下划线前缀的成员变量？并且不鼓励第 3 方开发人员使用此约定以避免冲突？

|K<

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-09T00:12:27.403

我使用下划线来表示一个变量是一个成员，类似于匈牙利符号中的“m”前缀（我完全鄙视这种符号，但那是另一回事了）。*当然，这些天你会得到颜色编码的编辑器，但我的观点是，前缀让你在输入变量之前*考虑变量是成员/实例，而不仅仅是在之后的某个时候，当它被你的编辑器进行颜色编码时。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-07T23:33:12.893

通常它表示开发人员不应该直接接触变量。这不是一个真正的要求，但如果你不能避免在一个你不想弄乱的类中有一个公共变量，这是一个很好的做法。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-01-30T07:19:53.113

我选择对 ivars 使用下划线，因为我经常遇到以下情况：

```
@interface MyClass:NSObject
{
    NSUInteger count;
}

@property(nonatomic) NSUInteger count;  

-(id) initWithCount(NSUInteger) count;

@end

(...)

@implementation MyClass
@synthesize count;

-(id) initWithCount(NSUInteger) count
{
    if((self = [super init])){
        self.count = count; // Parameter name collides with ivar name!
    }
    return self;
}

@end 
```

所以我这样做：

```
@interface MyClass:NSObject
{
    NSUInteger _count;
}

@property(nonatomic) NSUInteger count;  

-(id) initWithCount(NSUInteger) count;

@end

(...)

@implementation MyClass
@synthesize count = _count;

-(id) initWithCount(NSUInteger) count
{
    if((self = [super init])){
        _count = count; // No name collision
    }
    return self;
}

@end 
```

当然，我也可以将参数名称更改为“newCount”或“aCount”（我讨厌那个）。我认为这是一个品味问题。

# c# - 为什么 DrawString 在 C# Winforms 中表现出意外行为？

> ID：837565
> 
> 赞同：6
> 
> 时间：2009-05-07T23:31:03.757
> 
> 标签：c#, winforms, controls, onpaint, drawstring

我在 C# WinForms 中对控件进行了子类化，并且在我的`OnPaint()`处理程序中自定义了绘图文本。在我的表单中使用以下代码将字体设置为 Courier New：

```
FontFamily family = new FontFamily("Courier New");
this.myControl.Font = new Font(family, 10); 
```

在控件本身中，字符串存储在 中`realText`，我使用以下代码将其绘制到屏幕上：

```
protected override void OnPaint(PaintEventArgs e)
{
    base.OnPaint(e);

    e.Graphics.DrawString(realText, Font, new SolidBrush(ForeColor), ClientRectangle);
} 
```

一些随机示例文本的结果如下所示：http: [//img219.imageshack.us/img219/1778/courier.png](http://img219.imageshack.us/img219/1778/courier.png)

例如，如果放大，您可以看到第一个“as”之间的空间与第二个“as”之间的空间不同（1 个像素对 2 个像素）。有谁知道可能导致这种情况的原因，或者我如何防止它发生？当我用不同的字体绘制时，间距有更多类似的怪异，但我认为它们都是同一个问题的结果。

提前感谢您的任何想法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-08T00:26:57.070

我猜这是因为您使用[`Graphics.DrawString()`](http://msdn.microsoft.com/en-us/library/system.drawing.graphics.drawstring.aspx)的是[`TextRenderer.DrawText()`](http://msdn.microsoft.com/en-us/library/system.windows.forms.textrenderer.drawtext%28v=vs.110%29.aspx). 前者使用 GDI+ 绘制文本，这有点蹩脚和过时。后者使用更现代的 GDI（在文本渲染方面）。我相信这是上一个答案（WinForms 与 Windows）所指出的区别。

您也可以尝试`Graphics.DrawString()`使用[`StringFormat`](http://msdn.microsoft.com/en-us/library/system.drawing.stringformat%28v=vs.110%29.aspx)对象的重载并指定`StringFormat.GenericTypographic`. 但是，这确实是解决问题的一个技巧。如果您使用的是 .NET 2.0 或更高版本，您应该使用`TextRenderer`该类而不是糟糕的`Graphics`类来满足您的所有文本呈现需求。 `Graphics.MeasureString()`并`Graphics.DrawString()`严格存在与 .NET 1.0 和 1.1 的向后兼容性。

编辑：哦，是的，您的代码在每个绘制周期都会泄漏一个 GDI 对象。Brush 对象是围绕非托管资源的托管包装器，因此必须显式处理它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T23:55:11.970

我必须说实话，但这从未发生在我身上。但是，尝试将 SmoothingMode 设置为 Antialiasing：

```
e.Graphics.SmoothingMode = System.Drawing.Drawing2D.SmoothingMode.AntiAlias; 
```

除了另一件事，请确保您使用的 DoubleBuffer 设置为 true。另外，尽量不要在每个 OnPaint 调用中创建一个新的 SolidBrush ..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T00:22:39.530

我使用 WinForms 将文本绘制到子类控件的经验是，它使用的文本渲染引擎（GDI+？）不如 Windows 自己的字体引擎，即使它运行良好，也肯定会给出不同的结果。

我是 Visual Studio 插件 ( [http://entrian.com/source-search](http://entrian.com/source-search) ) 的作者，该插件需要在 Visual Studio 中绘制控件，并且为了使字体看起来与 Visual Studio 中的标准控件相同 (列表视图、树视图等）我必须绕过 WinForms 并使用 Win32 API 绘制文本：

```
[DllImport("gdi32.dll")]
public static extern bool ExtTextOut(IntPtr hdc, int X, int Y,
   uint fuOptions, [In] ref RECT lprc, string lpString, uint cbCount,
   [In] int[] lpDx); 
```

...和家人。

可能不是你想听到的，但它确实存在。

# javascript - 如何将通用 JavaScript 对象序列化为 XML

> ID：837577
> 
> 赞同：8
> 
> 时间：2009-05-07T23:36:10.733
> 
> 标签：javascript, xml, serialization

主流 JavaScript 库（YUI、jQuery、Dojo）是否提供了一种将 JavaScript 对象序列化为 XML（作为文本）的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-05-22T01:48:24.403

没有原生 API 用于 XML 序列化的原生对象**；**但是，有 3rd 方库，例如这个将输出 XML： [http ://code.google.com/p/x2js/](http://code.google.com/p/x2js/)

[请参阅有关该主题的其他线程。](https://stackoverflow.com/questions/19772917/how-to-convert-or-serialize-javascript-data-object-or-model-to-xml-using-ext)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-02-08T07:49:56.977

这似乎是最好的一个，特别是如果您需要在 Node.js 中执行此操作[https://github.com/wankdanker/node-object-to-xml](https://github.com/wankdanker/node-object-to-xml)

# objective-c - Mac OS X 语音转文本 API。如何？

> ID：837582
> 
> 赞同：9
> 
> 时间：2009-05-07T23:39:08.840
> 
> 标签：objective-c, cocoa, macos, audio, speech-recognition

我有一个程序从 TCP/IP 接收音频（单声道）比特流。我想知道 Mac OS X 中的语音（语音识别）API 是否能够为我进行语音到文本的转换。

（我不介意先将音频保存到 .wav 中，然后将其读取为反对即时进行转换）。

我已经在线阅读了官方文档，这有点令人困惑。我找不到任何关于这个话题的好例子。

另外，我应该用 Cocoa/Carbon/Java 还是 Objective-C 来做呢？

有人可以阐明一下吗？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-08T19:03:28.237

安装 XCode 时，在 /Developer/Examples/Speech/Recognition 下复制了许多示例。

用于语音识别的 Cocoa 类是[NSSpeechRecognizer](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSSpeechRecognizer_Class/index.html)。我没有使用过它，但据我所知，语音识别需要您构建一个语法来帮助引擎从多个选项中进行选择，而不是允许您传递自由格式的输入。这在上面提到的例子中都有解释。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-11-03T05:07:21.920

这可能有点晚了，但我还是会插话的。

OS X 中的语音识别工具（在 Carbon 和 Cocoa 方面）用于语音命令识别，这意味着它们将识别已加载到语音系统语言模型中的单词（或短语、命令）。我用小字典做了一些东西，效果很好，但如果你想识别任意语音，事情可能会变得更复杂。

还有一点要记住的是，OS X 中的语音 API 提供的功能不是一对一的。Carbon 的东西提供了尚未实现的功能`NSSpeechRecognizer`（文档对此有所提及）。

我不了解 Cocoa，但 Carbon 语音识别管理器确实允许您指定麦克风以外的输入，因此声音流可以正常工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T23:47:30.957

这是一篇[很好的 O'Reilly 文章](http://www.oreillynet.com/pub/a/mac/2004/03/17/speech.html)，可以帮助您入门。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-07-07T12:58:51.453

您可以使用 ApplicationServices 的 SpeechSynthesis (10.0+)

```
CFStringRef cfstr = CFStringCreateWithCString(NULL,"Hello World!", kCFStringEncodingMacRoman);
Str255 pstr;    
CFStringGetPascalString(cfstr, pstr, 255, kCFStringEncodingMacRoman);   
SpeakString(pstr); 
```

或 AppKit 的 NSSpeechSynthesizer (10.3+)

```
NSSpeechSynthesizer *synth = [[NSSpeechSynthesizer alloc] initWithVoice:@"com.apple.speech.synthesis.voice.Alex"];
[synth startSpeakingString:@"Hello world!"]; 
```

# linq-to-sql - 是否 linq 是否使用 SQL...这是个问题？

> ID：837590
> 
> 赞同：1
> 
> 时间：2009-05-07T23:43:02.077
> 
> 标签：linq-to-sql

我们的团队现在开始考虑从 2.0 升级到 3.5，并且一直在审查所有新内容......

那么，在未来整个 Linq to SQL 没有得到大幅度改进的情况下，我们应该完全忽略它吗？

看起来它可能非常适合我们的需求，但我想实体框架也可以，即使它可能会增加更多复杂性。

因此，避免 Linq To SQL 喜欢困扰并转而使用实体框架或跳进去，即使没有改进，Linq To SQL 在 4.0 和未来版本中也会很好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T23:50:14.727

我读过的所有内容似乎都表明 Linq2SQL 还会存在一段时间。如果我是你，我会选择最适合你要解决的问题的那个。我可能有点偏向于使用实体框架，因为它更抽象，并且可能对您和您的团队来说是一个很好的功能，并且因为 Visual Studio 2008 有一个设计器。

我只是不认为这几年有什么大不了的。只需选择您现在最喜欢的一个。

**更新**：以免有任何混淆 - 使用 EF 并不意味着放弃 Linq。Linq 已经可以与 EF 一起使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T23:52:09.743

非常类似于我的问题[@Switching to LINQ](https://stackoverflow.com/questions/806159/switching-to-linq)

可能会提供进一步的见解/意见。

就个人而言，我将开始关注 EF，因为我从 MS 看到的一切都是 LINQ 只是 EF 基础的开始和重要组成部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T00:35:59.967

我会选择 LINQ 只是因为它更简单，并且当您完成应用程序并正在考虑优化和重构时，您可以尝试 Entities，看看您是否有任何性能改进，或者它是否使代码更好。

我倾向于从更简单、开发速度更快的方法开始，完成功能，然后重构，然后优化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T01:06:13.530

无论如何，我都会选择EF。我从不喜欢 LINQ to SQL 直接映射到数据库结构的想法。我非常喜欢 EF 的想法，我可以在其中决定要向用户呈现哪些实体，然后根据需要将它们映射到数据库表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-08T01:11:27.887

LINQ to SQL 和 Entity 框架不是擦肩而过的彗星。它们是真正的编码革命！

我们现在可以在 1 小时内查询数据库，而之前我们需要 1 天！

不要犹豫跳。如果 .Net 4.0 不支持 LINQ to SQL 或 Entity 框架，请坚持使用 3.5 ！

:o)

一切顺利，西尔万。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-08T01:17:09.197

如果 LINQ to SQL 符合您的需求，那就去吧。它确实是一个非常强大的 RAD 工具。

EF 会给你更多的灵活性，但也可能是不必要的复杂性。

遗憾的是 LINQ to SQL 不再向前发展，但我会坚持下去，直到 EF 真正成熟并允许平等的 RAD 开发，当然，除非您现在需要 EF 功能。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-08T01:22:35.533

我会说这取决于。到目前为止，其他人都把事情做得很好。

如果您不介意最终的对象模型将非常紧密地镜像您的数据库，请使用 LINQ-to-SQL。如果您发现想要以不同的方式对事物进行建模，那么您可以对 LINQ-to-SQL 模型做很多事情。

如果您想潜在地使用相同的框架来指向多种类型的数据，或者如果您想比 LINQ-to-SQL 更抽象您的数据库模型，请使用 EF。

不幸的是，我没有任何关于这两种模型之间性能差异的数据。

我不会说 MS 没有在 LINQ-to-SQL 上进行大量积极开发这一事实一定会吓跑你。它是一个非常好的、非常、非常基本的对象映射解决方案。

# c# - C#：正确释放线程

> ID：837591
> 
> 赞同：2
> 
> 时间：2009-05-07T23:43:32.167
> 
> 标签：c#, multithreading

我有一个抽象类，它在其构造函数中生成一个无限循环线程。确保在使用完类后中止该线程的最佳方法是什么？

我应该实现 IDisposable 并简单地使用它吗？

```
public void Dispose()
{
    this.myThread.Abort();
} 
```

我读到 Abort() 是邪恶的。我是否应该让 Dispose() 设置一个私有 bool 标志，线程检查是否为 true 以退出其循环？

```
public void Dispose()
{
    this.abort = true;
} 
```

// 在线程的循环中...

```
if (this.abort)
{
    break;
} 
```

改用 BackgroundWorker 类？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-07T23:58:10.200

我想扩展“lc”提供的答案（否则很好）。

要使用他的方法，您还需要将布尔标志标记为“易失性”。这将引入一个“内存屏障”，它将确保每次您的后台线程读取变量时，它都会从内存（而不是寄存器）中获取它，并且当变量被写入时，数据会在 CPU 缓存之间传输.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-07T23:45:55.470

不要使用无限循环，而是使用可由主类设置的布尔标志作为循环条件。完成后，设置标志以便循环可以正常退出。如果您实现`IDisposable`，请设置标志并等待线程在返回之前终止。

你可以实现一个可取消的`BackgroundWorker`类，但本质上它会完成同样的事情。

如果你真的想要，你可以在发送信号后给它一个时间窗口来完成它自己。如果它没有终止，您可以像 Windows 在关机时一样中止线程。

我认为`Thread.Abort`被认为是“邪恶”的原因是它使事物处于未定义的状态。然而，与杀死整个进程不同的是，剩余的线程会继续运行并且可能会遇到问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T23:56:36.787

我建议使用 BackgroundWorker 方法。实施和清理起来相对简单。

# vbscript - 如果 VBScript 中出现错误，如何关闭 Word（或其他应用程序）？

> ID：837603
> 
> 赞同：2
> 
> 时间：2009-05-07T23:48:45.963
> 
> 标签：vbscript, error-handling, ms-word

我编写了一个 VBScript 应用程序来打开 Word 和 Excel 文档并搜索和替换文本块和各个部分，从纯文本文件中提取新文本。我故意避免任何错误检查，主要是因为我当时无法弄清楚（无论如何脚本运行可靠）。现在几个月后，在我的本地计算机上，我莫名其妙地收到有关 Normal.dot 被更改的错误消息和一个消息框，询问我想对此做什么（这需要另外三个对话框才能最终回答）。当然，这会扼杀我运行脚本并简单地走开的能力，因为它会导致脚本失败。目前，当这种情况发生时，我必须打开任务管理器，找到 Winword.exe（其中的 GUI 没有运行）并杀死它然后重新运行我的脚本。

什么是捕获错误并成功关闭 Word（或 Excel）的合理方法。基于这个[问题](https://stackoverflow.com/questions/157747/vbscript-using-error-handling)，我正在尝试这个：

```
Set objDoc = objWord.Documents.Open(curDir1 + "\docs\template_spec.dot")

If Err.Number <> 0 Then
WScript.Echo "Error in Word Open:" & Err.Description
objWord.Quit
Else
Set objSelection = objWord.Selection

'Do replacement activities'
ReplaceText(objSelection)

objDoc.SaveAs(curDir1 + "\docs\mynewdocument.doc")
objWord.Quit
End If

Set objShell = Nothing
Set objWord = Nothing
Set objExcel = Nothing 
```

当然，就像命运一样，我无法复制这个问题，所以它正常工作。这个解决方案看起来合理吗？还有一个附带问题：我到底如何让 Word 停止抱怨 Normal.dot（或让脚本来处理它）？在某些情况下，当我关闭 GUI 后，Word 就好像在后台保持打开状态一样。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T20:47:49.580

您是否考虑过将所有内容包装到“On Error Resume Next”语句中，以便您的脚本忽略所有错误并在调用 objWord.quit 之前尽可能地继续运行，无论成功还是失败。

如果您想了解有关正确使用“On Error Resume Next”的更多信息，请查看[有关它的 msdn 文章！](http://msdn.microsoft.com/en-us/library/aa266173(VS.60).aspx)

希望这可以帮助！

保罗

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T00:29:40.660

我同意使用“on error resume next”。

如果确实需要强制终止 Word，可以使用 WMI 和 Win32_Process 类来查找并终止该进程。如果其他一切都失败了，这应该是最后的手段。

```
Set objWMIService = GetObject("winmgmts:{impersonationLevel=impersonate}!\\.\root\cimv2")

Set colProcess = objWMIService.ExecQuery("Select * from Win32_Process Where Name = 'winword.exe'")
For Each objProcess in colProcess
  objProcess.Terminate()
Next 
```

这是一个修改过的例子：http: [//www.computerperformance.co.uk/vbscript/wmi_process_stop.htm](http://www.computerperformance.co.uk/vbscript/wmi_process_stop.htm)

此外，在终止进程之前，请确保您对 Word 自动化对象的所有引用都已关闭和/或设置为空。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T23:55:54.167

恐怕

```
WScript.Echo "..." 
```

如果它触发，将会停止你的脚本。除此之外，一切看起来都不错。我回家后会和它一起玩。

编辑：Word 确实经常在后台挂出。一方面，如果您使用 Outlook，并使用 Word 作为 Outlook 编辑器，那么在 Outlook 消失之前，Word 不会消失。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-06T19:10:46.707

终止所有 ActiveX 实例、清理垃圾和释放资源的最可靠方法是将用于该目的的代码放入`Sub Class_Terminate()`一个虚拟类中，创建的类实例允许处理脚本退出事件。

```
Option Explicit
Dim objBeforeQuitHandler, objWord

' create a dummy class instance
Set objBeforeQuitHandler = New clsBeforeQuitHandler

' create word app instance
Set objWord = CreateObject("Word.Application")
objWord.Visible = True
objWord.Documents.Add.ActiveWindow.Selection.TypeText "80040000 error was raised. About to terminate the script." & vbCrLf & "Word will be quitted without saving before script termination just you close popped up error message."

' your code here...

' raise an error
Err.Raise vbObjectError

Class clsBeforeQuitHandler
    ' dummy class for wrapping script quit event handler
    Private Sub Class_Terminate()
        Dim objDoc
        On Error Resume Next ' to prevent errors in case of unexpected word app termination
        If TypeName(objWord) <> "Object" Then ' word app has not been closed yet
            objWord.DisplayAlerts = False
            For Each objDoc In objWord.Documents
                objDoc.Saved = True ' to prevent save as dialog popping up
                objDoc.Close
            Next
            objWord.Quit
        End If
    End Sub
End Class 
```

# python - 在目录中查找最旧的文件（递归）

> ID：837606
> 
> 赞同：12
> 
> 时间：2009-05-07T23:50:50.793
> 
> 标签：python, linux, file-io

我正在编写一个 Python 备份脚本，我需要在一个目录（及其子目录）中找到最旧的文件。我还需要仅将其过滤为 *.avi 文件。

该脚本将始终在 Linux 机器上运行。有没有办法在 Python 中做到这一点，或者运行一些 shell 命令会更好？

目前我正在运行`df`以获取特定分区上的可用空间，如果可用空间少于 5 GB，我想开始删除最旧的`*.avi`文件，直到满足该条件。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-08T01:24:55.123

嗯。Nadia 的回答更接近您的*意思*；但是，要在树中查找（单个）最旧的文件，请尝试以下操作：

```
import os
def oldest_file_in_tree(rootfolder, extension=".avi"):
    return min(
        (os.path.join(dirname, filename)
        for dirname, dirnames, filenames in os.walk(rootfolder)
        for filename in filenames
        if filename.endswith(extension)),
        key=lambda fn: os.stat(fn).st_mtime) 
```

稍作修改，您可以获得`n`最旧的文件（类似于 Nadia 的回答）：

```
import os, heapq
def oldest_files_in_tree(rootfolder, count=1, extension=".avi"):
    return heapq.nsmallest(count,
        (os.path.join(dirname, filename)
        for dirname, dirnames, filenames in os.walk(rootfolder)
        for filename in filenames
        if filename.endswith(extension)),
        key=lambda fn: os.stat(fn).st_mtime) 
```

请注意，使用该`.endswith`方法允许调用如下：

```
oldest_files_in_tree("/home/user", 20, (".avi", ".mov")) 
```

选择多个分机。

最后，如果您想要按修改时间排序的完整文件列表，以便删除所需数量以释放空间，这里有一些代码：

```
import os
def files_to_delete(rootfolder, extension=".avi"):
    return sorted(
        (os.path.join(dirname, filename)
         for dirname, dirnames, filenames in os.walk(rootfolder)
         for filename in filenames
         if filename.endswith(extension)),
        key=lambda fn: os.stat(fn).st_mtime),
        reverse=True) 
```

并注意`reverse=True`将最旧的文件放在列表的末尾，因此对于要删除的下一个文件，您只需执行`file_list.pop()`.

顺便说一句，对于您的问题的完整解决方案，因为您在 Linux 上运行，如果`os.statvfs`可用，您可以执行以下操作：

```
import os
def free_space_up_to(free_bytes_required, rootfolder, extension=".avi"):
    file_list= files_to_delete(rootfolder, extension)
    while file_list:
        statv= os.statvfs(rootfolder)
        if statv.f_bfree*statv.f_bsize >= free_bytes_required:
            break
        os.remove(file_list.pop()) 
```

`statvfs.f_bfree`是设备空闲块并且`statvfs.f_bsize`是块大小。我们采用`rootfolder`statvfs，因此请注意指向其他设备的任何符号链接，我们可以在其中删除许多文件而无需实际释放该设备中的空间。

更新（复制胡安的评论）：

根据操作系统和文件系统的实现，您可能希望将 f_bfree 乘以 f_frsize 而不是 f_bsize。在一些实现中，后者是首选的 I/O 请求大小。例如，在我刚刚测试的 FreeBSD 9 系统上，f_frsize 是 4096，f_bsize 是 16384。POSIX 说块计数字段是“以 f_frsize 为单位”（参见[http://pubs.opengroup.org/onlinepubs/9699919799// basedefs/sys_statvfs.h.html](http://pubs.opengroup.org/onlinepubs/9699919799//basedefs/sys_statvfs.h.html) )

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-08T00:00:52.830

要在 Python 中执行此操作，您可以使用[`os.walk(path)`](http://docs.python.org/library/os.html)递归遍历文件，并使用`st_size`和的`st_mtime`属性[`os.stat(filename)`](http://docs.python.org/library/os.html)来获取文件大小和修改时间。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-08T00:01:00.613

您可以一起使用[stat](http://docs.python.org/library/stat.html#module-stat)和[fnmatch](http://docs.python.org/library/fnmatch.html#module-fnmatch)模块来查找文件

ST_MTIME 指上次修改时间。如果需要，您可以选择其他值

```
import os, stat, fnmatch
file_list = []
for filename in os.listdir('.'):
    if fnmatch.fnmatch(filename, '*.avi'):
        file_list.append((os.stat(filename)[stat.ST_MTIME], filename)) 
```

然后您可以按时间排序列表并根据它删除。

```
file_list.sort(key=lambda a: a[0]) 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-08T00:04:04.863

我认为最简单的方法是使用 find 和 ls -t （按时间排序文件）。

沿着这些线的东西应该可以解决问题（删除指定目录下最旧的 avi 文件）

```
find / -name "*.avi" | xargs ls -t | tail -n 1 | xargs rm 
```

一步步....

**find / -name "*.avi"** - 从根目录开始递归查找所有 avi 文件

**xargs ls -t** - 按修改时间对找到的所有文件进行排序，从最新到最旧。

**tail -n 1** - 抓取列表中的最后一个文件（最旧的）

**xargs rm** - 并删除它

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-08T02:56:00.990

这是另一个 Python 公式，与其他公式相比，它有点老派，但很容易修改，并且可以处理没有匹配文件的情况而不会引发异常。

```
import os

def find_oldest_file(dirname="..", extension=".avi"):
    oldest_file, oldest_time = None, None
    for dirpath, dirs, files in os.walk(dirname):
        for filename in files:
            file_path = os.path.join(dirpath, filename)
            file_time = os.stat(file_path).st_mtime
                if file_path.endswith(extension) and (file_time<oldest_time or oldest_time is None):
                oldest_file, oldest_time = file_path, file_time
    return oldest_file, oldest_time

print find_oldest_file() 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-07T23:53:02.130

查看 linux 命令[`find`](http://content.hccfl.edu/pollock/Unix/FindCmd.htm)。

或者，[此帖子](http://www.linuxforums.org/forum/debian-linux-help/70289-remove-oldest-file-directory.html)将 ls 和 tail 连接在一起以删除目录中最旧的文件。这可以在没有足够可用空间的情况下循环完成。

作为参考，这是执行此操作的 shell 代码（点击链接获取更多替代方案和讨论）：

```
ls -t -r -1 /path/to/files | head --lines 1 | xargs rm 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-08T00:02:53.400

[os 模块](http://docs.python.org/library/os.html#files-and-directories)提供了在 Python 中获取目录列表和文件信息所需的功能。我发现[os.walk](http://docs.python.org/library/os.html?highlight=walk#os.walk)对于递归遍历目录特别有用，并且 os.stat 将为您提供每个条目的详细信息（包括修改时间）。

您可以使用简单的 shell 命令更轻松地完成此操作。这是否对您更有效取决于您想要对结果做什么。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-08-30T13:32:55.030

使用标准库的`pathlib`：

```
from pathlib import Path

def creation_time(path: Path):
    return path.stat().st_ctime

working_dir = Path()
avi_files = working_dir.glob("**/*.avi")
sorted_avi_files = sorted(avi_files, key=creation_time)
print(sorted_avi_files[0]) 
```

或者，如果您喜欢单线：

```
min(Path().glob("**/*.avi"), key=lambda p: p.stat().st_ctime) 
```

# c# - 设置我的显示分辨率

> ID：837613
> 
> 赞同：1
> 
> 时间：2009-05-07T23:55:03.530
> 
> 标签：c#, .net-3.5

我是一名 C# 开发人员，我必须定期更改我的显示分辨率。

有很多关于如何读取当前显示分辨​​率的示例： [SystemInformation.PrimaryMonitorSize](http://msdn.microsoft.com/en-us/library/system.windows.forms.systeminformation.primarymonitorsize.aspx)

我找到了[ChangeDisplaySettingsEx 函数](http://msdn.microsoft.com/en-us/library/dd183413(VS.85).aspx)

在 C# 中执行此操作的唯一方法是使用[PInvoke](http://www.pinvoke.net/default.aspx/user32/ChangeDisplaySettings.html) ???

我觉得很奇怪，获取这些信息很容易，但很难设置它......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T00:03:21.043

您必须对 ChangedisplaySetting 进行 PInvoke 调用。

这是一个包含一些示例代码的链接，[http://www.xtremedotnettalk.com/printthread.php?t=73184](http://www.xtremedotnettalk.com/printthread.php?t=73184)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T00:17:18.233

我还建议您查看 Jared Parsons PInvoke Toolkit。你可以在这里下载：

[http://www.codeplex.com/clrinterop/Release/ProjectReleases.aspx?ReleaseId=14120](http://www.codeplex.com/clrinterop/Release/ProjectReleases.aspx?ReleaseId=14120)

它使向您的代码中添加 pinvoke 签名变得轻而易举。它并不总是选择正确的互操作类型，但通常非常接近，即使您必须进行一些更改，它通常仍然比手动翻译所有内容要快。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T18:23:02.657

简单的回答：是的。您应该使用 PInvoke。

# sql-server - 为什么sql server使用带字符串的sp_executesql语句生成存储过程？

> ID：837615
> 
> 赞同：14
> 
> 时间：2009-05-07T23:55:24.730
> 
> 标签：sql-server

当我手动生成 sql 模式创建脚本时，我通常只调用“创建过程...”，但是我注意到当您使用“任务/生成脚本”选项生成脚本时，它使用“spexecutesql @statement = ..”，例如

```
 EXEC dbo.sp_executesql @statement = N'-- =============================================
    -- Author:      Me
    -- Create date: 20/03/2009
    -- Description: Does stuff
    -- =============================================
    CREATE PROCEDURE [dbo].[MyProc]
        -- Add the parameters for the stored procedure here
        @StartDate datetime
    AS
    BEGIN
        -- SET NOCOUNT ON added to prevent extra result sets from
        -- interfering with SELECT statements.
        SET NOCOUNT ON;
    ...
END
' 
```

为什么是这样？是关于保留评论吗？谢谢

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-08T00:01:29.457

它与评论无关。只有当您告诉它“如果不存在时包含”，它才会这样做。原因是它只能以编程方式包含或排除动态执行的对象。

您可以通过在 Options\SQL Server Object Explorer\Scripting - Check for object exist 中选择“False”来禁用此存储过程。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-05T18:20:51.970

我意识到这是旧的，但是修复程序被埋葬在SQL 2012中。MichaelHaren是正确的，当需要选项中需要对象存在检查时，渲染Sprocs的方法会更改。要更改此设置，请转到选项、Sql Server 对象资源管理器、脚本、对象脚本选项，然后将“检查对象是否存在”设置为 false。Sprocs 现在呈现“正常”，而不使用 sp_executesql。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-08-29T10:32:21.347

sql server 2012，设置工具=>选项=>SQL Server对象探索=>脚本，检查对象存在= false

可以解决这个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T04:59:31.503

我想这与能够在没有 GO 的情况下在同一个脚本文件中创建多个存储过程有关吗？如果您直接执行 create sproc ...，则必须分批完成（以 GO 完成）。使用 sp_executesql，您不必在对象之间生成脚本。虽然我不记得了，但也许无论如何都有一个..（我面前没有分贝）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-07-14T16:48:01.010

使用 spexecutesql 是最佳实践。通过隔离/限制变量的范围等来防止 sql 注入等。更多信息在这里：http: [//msdn.microsoft.com/en-us/library/ms188001.aspx](http://msdn.microsoft.com/en-us/library/ms188001.aspx)

你不必使用 spexecutesql——EXEC 也可以——很多人只是使用普通的旧 EXEC——它只是不那么安全。

# wpf - 在 WPF 中使用 MS ReportViewer

> ID：837625
> 
> 赞同：32
> 
> 时间：2009-05-07T23:59:01.070
> 
> 标签：wpf, reportviewer

我将通过将 ReportViewer 放置在 WindowsFormsHost 中来开始在 WPF 应用程序中使用 MS ReportViewer。

这是正确的方法吗？设计报告的最佳方法是什么，因为您不能在 WindowsFormsHost 的设计时使用 ReportViewer。

最好在 SQL Server 中创建 RDL 报告，然后将其转换为 RDLC，或者创建新的 Winforms 应用程序以在 WinForms 框架中创建 RDLC 文件，然后将其复制到 WPF 应用程序。

我将需要通过下拉列表过滤报告，因此也需要考虑这一方面。如果有人已经在 WPF 中使用 ReportViewer，我将不胜感激有关最佳方法的一些反馈.....非常感谢。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2010-02-18T18:47:28.343

是的，这行得通，我在 wpf 项目中使用 WindowsFormsHost 来包装 ReportViewer。

在 ViewModel 中，我正在创建 WindowsFormsHost 和 ReportViewer：

```
WindowsFormsHost windowsFormsHost = new WindowsFormsHost();
reportViewer = new ReportViewer();
windowsFormsHost.Child = reportViewer;
this.Viewer = windowsFormsHost 
```

在视图中，我使用 ContentPresenter 通过绑定到包含 WindowsFormsHost 的属性来显示它。

```
 <ContentPresenter Content="{Binding Viewer}" ... 
```

我们正在使用 Business Intelligence Studio（它是一个带有用于编辑报告的模板的 Visual Studio 2008）来创建报告。[http://msdn.microsoft.com/en-us/library/ms173767.aspx](http://msdn.microsoft.com/en-us/library/ms173767.aspx)

保重，
马丁

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-05-08T00:17:07.080

仅使用 WindowsFormsHost，我们肯定已经取得了成功。我自己没有参与创建 RDLC 文件，但我相信它们是在 WinForms 项目中设计的（如您所说），然后被复制。

请注意，如果您不需要本地报告，您可以使用 WPF 框架控件并将其指向基于服务器的报告的 URL（它会像 Web 浏览器一样呈现它）。这对我们也很有效。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-12-16T08:06:45.603

请注意，您可以在同一应用程序中同时使用 WPF-Windows 和 Windows-Form-Windows。

因此，如果您将 ReportViewer 放在一个单独的 Windows-Forms-Window 中，您可以避免使用 WindowsFormsHost，您可以使用 ShowDialog 从 WPF 窗口打开该窗口。

然后您也可以在设计时使用 ReportViewer。

# windows - 在 Windows 中为远程资源创建驱动器？

> ID：837635
> 
> 赞同：0
> 
> 时间：2009-05-08T00:02:16.740
> 
> 标签：windows, drives

似乎没有任何好的软件可以将 FTP 挂载到本地驱动器号（有关详细信息，请参阅此处[SF Question](https://serverfault.com/questions/6079/how-can-i-mount-an-ftp-to-a-drive-letter-in-windows)）所以我在想为什么不自己写它，但我对处理 Windows 的经验很少（在编程时）水平）那么做这样的事情会涉及什么？需要做什么才能在“我的电脑”下获得一个新的“驱动器”？需要做什么才能获取列出“驱动器”的 FTP（或其他远程资源）的内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T03:14:07.857

我最初的想法是您需要编写一个 shell 扩展来显示您的 FTP 站点，并且最好将它显示为 Windows 资源管理器中的一个[特殊文件夹](http://en.wikipedia.org/wiki/Special_Folders)。您的扩展最好用支持 COM（C++、VB 6 等）的非托管语言编写。它需要响应以下事件：

*   用户突出显示服务器上的文件夹
*   用户双击服务器上的文件夹
*   用户从服务器拖放文件
*   想要从服务器断开/重新连接的用户

当您拦截这些事件时，您将发出适当的 FTP 命令来完成任务（使用 LIST 获取目录的内容，使用 MKD 创建目录，使用 STOR 上传文件等）。您必须获取这些命令的结果并将它们显示在 Windows 资源管理器中的文件夹视图和列表视图中，为此您可能需要近距离接触 Win32 API。为此，您可以参考 Charles Petzold 的经典[Programming Windows](https://rads.stackoverflow.com/amzn/click/com/157231995X)等书籍。另请查看有关编写 shell 扩展的本[教程。](http://www.codeproject.com/KB/shell/shellextguide1.aspx)

这听起来像是一个有趣的项目。

# code-coverage - 有没有办法将 lcov 代码覆盖率报告集中到一个或两个目录？

> ID：837639
> 
> 赞同：31
> 
> 时间：2009-05-08T00:03:41.700
> 
> 标签：code-coverage, gcov, lcov

我最近开始使用 lcov 来可视化我的代码覆盖率。这是一个很棒的工具。

我注意到的一件事是，它会为我正在使用的所有文件生成代码覆盖率报告——包括那些我不感兴趣的文件。例如，它会为我提供 boost 和 mysql++ 文件的代码覆盖率报告。

有没有一种简单的方法可以强制 lcov 只为特定文件生成覆盖率报告？

我尝试过使用 -k 参数，如下所示：

```
/usr/bin/lcov -q -c -i -b 。-d .obj -k src/ -k 包含/ -o app_base.info

{现在运行单元测试}

/usr/bin/lcov -q -c -b 。-d .obj -k src/ -k 包含/ -o app_test.info
/usr/bin/lcov -q -a app_base.info -a app_test.info -o app_total.info
/usr/bin/genhtml -q -o lcov_output_directory app_total.info

```

（这意味着我只想要“include”和“src”目录的覆盖文件。）

但是，这似乎不起作用。该报告仍然向我显示所有无关文件。任何建议都非常感谢。谢谢！

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-02-12T15:19:30.387

我将`--no-external`标志与标志一起使用`--directory`以排除不需要的文件。

从人的外部定义：

> 外部源文件是不在 --directory 或 --base-directory 指定的目录之一中的文件。

所以我的命令看起来像这样：

```
$ lcov  --directory src -c -o report.info --no-external
Capturing coverage data from src
Found gcov version: 4.2.1
Scanning src for .gcda files ...
Found 4 data files in src
Processing src/C####.gcda
  ignoring data for external file /usr/include/c++/4.2.1/bits/allocator.h 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-05-08T02:09:24.983

[lcov](http://ltp.sourceforge.net/coverage/lcov/lcov.1.php)支持命令行参数*--remove*以完全按照您的要求进行操作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-16T12:43:46.763

一种可能的方法是使用覆盖标志 (-fprofile-arcs -ftest-coverage) 来限制编译哪些文件。如果您不想设计您的 make 文件系统以选择性地使用测试工具构建哪些文件，那么以下技巧可能对您有用：

*   无需仪器即可构建您的应用程序。
*   删除要检测的源的 .o 文件
*   打开仪器并重建。只有已删除的目标文件将通过检测重建。
*   运行 lcov

这将导致仅目标区域发出 gcov 伪影，这些伪影被 lcov 脚本盲目消耗。

# iphone - 扫描 iPhone 范围内的蓝牙设备需要多长时间？

> ID：837644
> 
> 赞同：8
> 
> 时间：2009-05-08T00:05:04.347
> 
> 标签：iphone, bluetooth

我知道 iPhone 蓝牙功能在 3.0 之前无法通过 SDK 访问，但需要多长时间才能找到该区域的设备？它是否取决于该区域的设备数量？如果范围内大约有 5 台设备，扫描以发现所有设备需要 <5 秒还是 >30 秒？

我知道有很多未知因素，但我正在尝试确定如果时间很短，我是否可以在启动时进行蓝牙扫描，或者我是否必须告诉用户它即将进行扫描并且可能是一个很长的延迟。由于其他蓝牙设备不可用，我无法在现实世界中对此进行测试，但我试图了解它的设计方式。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-08T14:29:05.463

不确定 API 将允许您做什么，但基于此的蓝牙主机控制器接口 (HCI) 命令是“查询命令”

这将使您可以在固定时间和/或固定数量的响应内查询设备。

我是蓝牙新手，不是专家，但...

从处于低功耗模式的蓝牙设备获得至少 1 个响应需要 1.28 秒，因此查询时间是该周期的倍数，最长可达 61.44 秒（48 个周期），因此时间范围为 1（1.28秒）到 48（61.44 秒）。

不过，可能有多个设备可以在 1.28 秒的时间内做出响应。

您还可以指定将接受的响应数 (1..255) 或 0 表示无限制，例如直到时间用完。

如果您找到了您正在寻找的特定设备，您也可以取消查询。

在我的办公桌上使用带有蓝牙 2.1 + EDR 固件的 CSR 蓝牙芯片在芯片上运行查询并通过芯片 UART 进行调试输出的不科学测试。每个查询运行 10 次，取结果的平均值：

*   1 个周期查询时间（1.28 秒）平均产生 10 个唯一的蓝牙地址。
*   5 周期查询时间（6.4 秒）平均产生 23 个唯一蓝牙地址。
*   10 周期查询时间（12.8 秒）平均产生 29 个唯一的蓝牙地址。

我说“唯一”，实际上结果一遍又一遍地重复了很多相同的地址，但这可能取决于实现，Apple API 可能只返回唯一地址。

然而，这并不代表“现实世界”，因为这里（我的办公室）周围的大多数蓝牙设备都没有处于低功耗模式。我想，我可以按设备类别过滤掉 PC、笔记本电脑和测试套件。那将获得可发现的手机，耳机等...

查询也可以与 RSSI 结合来获得信号最强的设备，但它们不一定是最近的。

对于您的方案，您可能希望根据时间和设备数量进行查询，例如 4 * 1.28 秒或 10 个设备。

总结一下：您可以进行查询的最短时间是 1.28 秒，这可能是 10+/-？区域中的设备（如果它们醒着且在附近）。

如果您有一个饱和的蓝牙环境或（微波炉在同一个房间里），则可能需要更长的时间才能找到范围内的所有设备。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-04-26T21:53:27.300

我知道这是一个老问题，但我想我可能会为以后发现这个问题的任何人添加一些东西。

正如[Simon Peverett](https://stackoverflow.com/a/840059/1321293)提到的，设备发现是由蓝牙主机控制器接口执行的底层“查询命令”执行的。在蓝牙规范 V4.0，第 2 卷，E 部分，第 6.1.4 节中，规范说：

> 当蓝牙设备发起一般查询时，查询状态应持续 TGAP(100) 或更长时间，除非查询器收集到足够的响应并决定提前中止查询状态。

在其他地方，TGAP(100) 被解释为 10.24 秒，并被描述为蓝牙设备执行设备发现的时间跨度的推荐值。

换句话说，执行查询的最短时间的良好基准是 10.24 秒，或查询命令测量时间的 1.28 秒周期中的 8 个。

# javascript - 如何使用按钮按下事件增加 JavaScript 变量

> ID：837648
> 
> 赞同：23
> 
> 时间：2009-05-08T00:07:26.090
> 
> 标签：javascript

当我按下按钮（不提交表单）时，我可以创建一个 javascript 变量并增加该变量吗？谢谢！

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-05-08T00:10:56.767

是的：

```
<script type="text/javascript">
var counter = 0;
</script> 
```

和

```
<button onclick="counter++">Increment</button> 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-08T05:04:39.837

执行此操作的最纯粹方法是将事件处理程序添加到按钮，而不是将行为与内容混合（LSM，分层语义标记）

```
<input type="button" value="Increment" id="increment"/>

<script type="text/javascript">
    var count = 0;
    // JQuery way
    $('#increment').click(function (e) {
        e.preventDefault();
        count++;
    });
    // YUI way
    YAHOO.util.Event.on('increment', 'click', function (e) {
        YAHOO.util.Event.preventDefault(e);
        count++;
    });
    // Simple way
    document.getElementById('increment').onclick = function (e) {
        count++;
        if (e.preventDefault) {
            e.preventDefault();
        }
        e.returnValue = false;
    };
</script> 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-08T00:11:25.610

```
<script type="text/javascript">
var i=0;

function increase()
{
    i++;
    return false;
}</script><input type="button" onclick="increase();"> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-05-20T15:52:44.997

我需要查看此脚本的结果，并且能够通过合并以下内容来做到这一点：

```
var i=0;

function increase()
{
i++;
document.getElementById('boldstuff').innerHTML= +i;
}

<p>var = <b id="boldstuff">0</b></p>
<input type="button" onclick="increase();"> 
```

首先添加“脚本”标签，并在函数结束大括号下方添加一个结束脚本标签。当我尝试它时，返回 false 导致 Firefox 挂起。根据我的经验，所有其他解决方案都没有显示增量的结果。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-08T00:12:59.477

使用`type = "button"`代替`"submit"`，然后为它添加一个`onClick`处理程序。

例如：

```
<input type="button" value="Increment" onClick="myVar++;" /> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-08T00:11:36.000

是的。

```
<head>
<script type='javascript'>
var x = 0;
</script>
</head>
<body>
  <input type='button' onclick='x++;'/>
</body> 
```

[伪代码，上帝，我希望这是对的。]

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-08T00:12:03.567

是的，假设您的变量在全局命名空间中：

```
<button onclick="myVar += 1;alert('myVar now equals ' + myVar)">Increment!!</button> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-08T00:21:47.957

我相信您需要类似于以下内容的内容：

```
<script type="text/javascript">
var count;
function increment(){
    count++;
}
</script>

... 
```

和

```
<input type="button" onClick="increment()" value="Increment"/> 
```

或者

```
<input type="button" onClick="count++" value="Increment"/> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-05-22T21:40:29.790

有类似的问题。需要将用户想要的尽可能多的文本输入附加到表单中。它使用 jQuery 的功能是问题的答案：

```
<div id='inputdiv'>
<button id='mybutton'>add an input</button>
</div>

<script>
var thecounter=0; //declare and initialize the counter outside of the function
$('#mybutton').on('click', function(){
thecounter++;
$('#inputdiv').append('<input id="input'+thecounter+'" type="text/>);
});
</script> 
```

将计数添加到每个新的输入 id 会产生唯一的 id，这使您可以使用 jQuery serialize() 函数获取所有值。

# php - PHP SPL 操作递归菜单

> ID：837649
> 
> 赞同：2
> 
> 时间：2009-05-08T00:07:33.373
> 
> 标签：php, recursion, spl

我在数据库中有一个包含类别数据的表：

```
id 标题 父级
1 类 1 0
2 类 2 2
3 类 3 3
4 类 4 0

```

每个父级都可能具有父级行 ID。

例如，类别 3 是类别 2 的子类别，类别 2 是类别 1 的子类别。

```
第一类
   第 2 类
      第 3 类

第 4 类

```

1 - 有没有更好的方法来操纵这种技术？2 - 我的实现是在一个 SQL 查询中获取所有行，然后使用递归函数来构建一个多维数组，然后我使用多级 foreach 遍历它来构建一个菜单或其他任何东西。我需要使用 PHP SPL 的更好方法。

我想创建一个完整的菜单或一个项目路径，如：

```
类别 1 -> 类别 2 -> 等等。

```

并创建一个网格，其中包含每行中的类别级别。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T03:20:28.853

如果您的数据是严格分层的，并且看起来确实如此，我建议您使用 Modified Preorder Tree Traversal 方法来存储您的数据。

[Sitepoint](http://www.sitepoint.com/article/hierarchical-data-database/1/)上有一篇很棒的文章讨论了这个确切的问题。您似乎正在使用第一页讨论的邻接列表模型，但 MPTT 对于此类数据的大量读取存储更有效。

查看[第 2 页](http://www.sitepoint.com/article/hierarchical-data-database/2/)以查看示例。这确实是一个非常优秀的建筑。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T01:37:57.493

我最近使用单个查询和单个 while 循环完成了类似的操作。它使用引用通过平面结构（数组）构建树数据结构（数组）。没有涉及 SPL，因为我觉得没有必要。[**GitHub 上**](http://gist.github.com/104357)有一个更好的配色方案的要点 :)

```
/**
* Each element in the return array has a 'data' key, holding category data,
* like name, and a 'children' key holding its subcategories.
*
* @param resource $resource MySQL resource resulted from mysql_query
* @param string $id_key Name of the 'id' field
* @param string $parent_id_key Name of the 'parent_id' field
* @param boolean $use_cache Use cached result from previous calls. Defaults to TRUE
* @return array
*/
function categories($resource, $id_key, $parent_id_key, $use_cache = true) {
    // Cache the categories in a static local variable. This way, the query
    // will be executed just for the first function call. Subsequent calls
    // will return imediatelly, unless you tell it not to.
    static $tree = array();

    if ($tree && $use_cache) {
        return $tree;
    }

    // Flat representation of the categories for fast retrieval using array
    // keys. Each element will be referenced in the $tree array. This
    // allows to build a tree data structure using a flat one.
    $flat = array();

    // Reset the $tree, in case $use_cache=false in a subsequent call
    $tree = array();

    while ($row = mysql_fetch_object($resource)) {
        $flat[$row->$id_key] = array(
            'data' => $row,
            'children' => array(),
        );

        if (array_key_exists($row->$parent_id_key, $flat)) {
            // Assign children by reference so that possible subcategories of
            // this one will appear in the tree structure ($tree)
            $flat[$row->$parent_id_key]['children'][] =& $flat[$row->$id_key];
        }

        if ($row->$parent_id_key == 0) {
            // Assign by reference for synchronizing $flat with $tree;
            $tree[] =& $flat[$row->$id_key];
        }
    }

    return $tree;
} 
```

此外，该功能与数据库的结构分离。您需要向它传递一个 mysql_query 资源、一个表示 id 字段的字符串和一个表示 parent_id 字段的字符串。不好的部分是它与 PHP mysql 扩展耦合，因为它使用对 mysql_fetch_object 的调用。它可能会得到改进。

其他一些优点是它会缓存后续调用的结果，除非您告诉它使缓存无效，这是第四个（布尔值）参数。

看看它是否对您有帮助。

# asp.net - 路由中的自定义包罗万象参数

> ID：837656
> 
> 赞同：2
> 
> 时间：2009-05-08T00:12:27.013
> 
> 标签：asp.net, asp.net-mvc, url-routing

我最近想要一个特殊的路由规则：{*whatever}/details/{Id}/{itemName}

我知道一旦我运行应用程序就会抛出异常。在我的应用程序中，例如我的 url 模式是 www.domain.com/root/parent/child/.../child/details/30/itemname

但目前的路由不支持这一点。如何自定义路由处理程序以使其工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-01-12T11:35:11.717

## 已经编写了一个支持这个的类

我已经编写了这样一个类，它可以处理 URL 中任何地方的包罗万象的段。它有相当多的代码，但它按预期工作，我已经在一个真实的项目中使用它。

[自己检查一下](http://erraticdev.blogspot.com/2011/01/custom-aspnet-mvc-route-class-with.html)，看看它是否满足您的需求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-05T21:53:59.883

问题是......它如何知道何时停止？

{*whatever} 段将匹配：

```
/foo/
/foo/bar
/foo/bar/details/4/moreFoo
/foo/bar/andmore/details/4/moreFoo 
```

因为 catch-all 参数包含任何内容，所以它永远不会停止。

实现这一点的唯一方法是为您使用细节的每个地方创建不同的路线......

例如：

```
games/details/{id}/{itemName}
widgets/details/{id}/{itemName}
books/details/{id}/{itemName} 
```

当然，这已经在默认的 {controller}/{action}/{id} 路由中提供了

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-06T21:18:37.310

我想你可能想看看扩展 System.Web.Routing.RouteBase 类并覆盖 GetRouteData() 方法。有了它，您可以查看请求的 url 并确定是否与您的模式匹配，如果匹配，则构造并返回一个新的 RouteData 实例，该实例指向您要处理请求的控制器和操作。否则，如果您与请求的 url 不匹配，则返回 null。

有关示例，请参见以下内容：

[史蒂夫·桑德森的 Pro ASP.NET MVC 框架](http://books.google.com/books?id=Xb3a1xTSfZgC&pg=PA251&lpg=PA251&dq=asp.net+mvc+Custom+RouteBase&source=bl&ots=J9GeSapcjr&sig=T_dVgDpETzHwvxKm0iPP-7AZIFc&hl=en&ei=7dsqSt62DaCJtgesp9HGCA&sa=X&oi=book_result&ct=result&resnum=3#PPA249,M1)

[自定义路由库](http://blogs.securancy.com/post/ASPNET-MVC-Subdomain-Routing.aspx)

# ruby - 在 Ruby 函数中，“at”符号 (@) 的作用域是什么？

> ID：837665
> 
> 赞同：1
> 
> 时间：2009-05-08T00:15:08.893
> 
> 标签：ruby, scope, sigils

自从我上次进行 Ruby 编程以来已经有一段时间了——查看别人的代码，我在一个函数（*不是*`@`方法——任何类定义的外部）中看到了印记，我理解它的范围仅限于实例成员。

 *模块是隐含`self`在功能中的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T01:08:37.690

在顶级函数（实际上仍然是一个方法）中，您处于一个稍微奇怪的地方：全局“主”空间（请参阅运行时的提示`irb`，或尝试查看`self`此类函数内部），还有这些函数被定义为`Object`类内部的私有方法。

```
$ cat foo
def foo
  p self
  p self.class
  puts 'foo'
end

foo
Object.foo

$ ruby foo
main
Object
foo
foo:8: private method `foo' called for Object:Class (NoMethodError)
$ 
```

你可以通过显式声明这些方法来绕过这个`public`，但我不确定我是否喜欢这个！奇怪的是，如果您在 内部定义了一个顶级方法`irb`，那么您可以通过类方法调用它，`Object#foo`而无需将其声明为 public。

所以这是一种“隐含的主命名空间被入侵`Object`（但嘘不要告诉任何人）”。`@foo`在顶级函数中定义的对象在 Object 中可用，作为普通的旧属性。有点。如果您的顶级方法集`@foo`并且您在没有作用域的情况下调用它，则它在类似特征的`main`命名空间中声明，但如果您通过调用类方法，`Object`则`@foo`出现在`Object`.

另一个例子：

```
public
def set_foo
  @foo = 'foo'
end

def get_foo
  @foo
end

def Object.get_foo_again
  @foo
end

set_foo
p get_foo
p Object.get_foo_again

Object.set_foo
p Object.get_foo_again 
```

给

```
"foo"  # @foo set in main
nil    # @foo nil in Object  
"foo"  # @foo in Object 
```

反之亦然。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T00:42:05.973

认为这是“一个函数，而不是一个方法”的假设是错误的。所有 Ruby 代码都出现在某个对象的上下文中。“全局”上下文是一个名为的对象（如果您不相信，请`main`尝试）。`ruby -e "puts self"`在顶层范围内定义的方法成为 Object 的实例方法。这意味着该方法将在*任何地方*可用，`self`具体取决于调用方法的位置（以及实例变量所属的上下文）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T00:33:39.490

我认为它的范围是一个模块。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-08T01:05:14.017

@ 使变量成为实例变量。听起来它不是显式声明的类的一部分，因此正如 Chuck 指出的那样，它将在主对象中可用。通过示例更容易说明：

```
$ irb
irb(main):001:0> @var = 1
=> 1
irb(main):002:0> class New
irb(main):003:1>   def test
irb(main):004:2>     puts @var
irb(main):005:2>   end
irb(main):006:1> end
=> nil
irb(main):007:0> test = New.new
=> #<New:0xb7ccbc14>
irb(main):008:0> test.test
nil
=> nil
irb(main):009:0> def test2
irb(main):010:1>   puts @var
irb(main):011:1> end
=> nil
irb(main):012:0> test2
1
=> nil 
```

# flex3 - itemRenderer 导致未定义的方法

> ID：837668
> 
> 赞同：0
> 
> 时间：2009-05-08T00:16:56.503
> 
> 标签：flex3

我有一个 mxml 文件，其中包含脚本标记中的一堆函数，以及一个使用自定义 itemRender 将图像添加到每个列表条目的列表组件。但是，当我在单击图像时添加对函数的调用时，会出现“调用未定义的方法”错误。即使我的功能就在同一页面上......这就是它的样子：

```
<mx:List x="10" y="38" width="358" height="231" id="audioPlaylist" change="playSong(event)" alternatingItemColors="[#7DC1F0, #4DAEF1]" color="#000000" labelField="title" fontSize="10" themeColor="#FFFFFF">
    <mx:itemRenderer>
        <mx:Component>
            <mx:HBox width="100%" height="20" horizontalAlign="left">
                <mx:HBox width="100%" height="100%" horizontalAlign="left">
                    <mx:Text text="{data.title}"/>
                </mx:HBox>
                <mx:HBox width="100%" height="100%" horizontalAlign="right">
                    <mx:Image id="iTunesButton" source="@Embed(source='assets/iTunes.png')" toolTip="Click to buy this song on iTunes"  click="iTunesLink(data.buyLink)"/>
                </mx:HBox>                           
            </mx:HBox>
        </mx:Component>
    </mx:itemRenderer>                                               
    </mx:List> 
```

函数 iTunesLink() 就在页面上，还有一堆其他调用没问题的函数，但为什么它返回未定义？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-08T00:37:29.823

试试 outerDocument.iTunesLink(data.buyLink)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T23:26:08.337

项目渲染器实际上被转换为单独的类，因此“this”运算符指的是组件，而不是包含文件。

处理此问题的最佳方法是使用冒泡事件。创建一个自定义事件，将冒泡设置为 true，然后从您的组件中调度它。然后，在包含列表的文件中，侦听该事件（在包含的类上！） - （您需要在 actionscript 中执行此操作，除非您想扩展列表并添加 [Event(name="myCustomEvent",type ="me.MyEvent")] 到扩展）。然后你可以调用你的函数。

我通常在单独的文件中定义项目渲染器......更容易理解发生了什么。

# c++ - 哪些库必须与协议缓冲区生成的 C++ 代码链接

> ID：837671
> 
> 赞同：4
> 
> 时间：2009-05-08T00:18:06.173
> 
> 标签：c++, protocol-buffers

我有来自 mytest.proto 文件的 mytest.cc 和 mytest.h 输出，但我找不到任何关于如何为此使用 g++ 编译对象的参考。（.proto 很好，因为我可以使用 Python）

g++ mytest.cc -l???????

要包括哪些库？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-08T00:27:24.527

我认为您可能需要链接到 libprotobuf

```
g++ mytest.cc -lprotobuf -o mytest 
```

# database - 首先是 RDO，后来是 ADO，再后来是 ADO.NET，现在是 LINQ。LINQ 是下一个标准还是我应该等待？

> ID：837672
> 
> 赞同：1
> 
> 时间：2009-05-08T00:18:40.383
> 
> 标签：database, linq, ado

在我看来，微软每四五年就会改变一次关于数据库管理的规则。我记得以前 RDO 是连接到 SQL Server 的解决方案。我更新了使用 ADO 的知识，因为 RDO 已经过时了。ADO 非常好用且有效，但不久前，我发现自己正在编程并再次刷新我的知识以使用 ADO.NET。现在我正在使用 LINQ 进行我的第一个项目。

你怎么看？LINQ 是否准备好成为下一个标准，或者我应该等待并继续使用 ADO.NET，就像在 .NET 2.0 中一样？我需要根据您自己的经验知道，与它提供的好处相比，改用 LINQ 是否不会太贵。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-08T00:41:38.813

你应该等待什么？如果您考虑一下，您过去编写的任何代码在今天都将与当时一样运行良好。LINQ 是否比大多数早期方法更有效率？在我看来，是的，但是我真的很喜欢 LINQ。Linq To Entity 更好吗？不，它只是不同，老实说，在许多情况下，它的工作量要大得多。LINQ 的 IJW（它只是有效！）因素确实令人难以置信，它是很长一段时间内来自 Microsoft 的最优雅的技术之一。未来会不会有更好的东西？最有可能的。但是我们活在当下并编码，等待未来是一件愚蠢的事，因为总会有更好的东西在地平线上。

也就是说，这是抽象的一个很好的论据。当你设计你的类时，问问自己，我可以在我的数据层中替换 X（Linq、ADO.Net 等）而不破坏我的应用程序的其余部分吗？如果你能回答是，你可能有一个很好的设计。做一个合适的数据层真的不是那么难，它允许你灵活地从 Linq 切换到任何其他 ORM（链接到实体、nHibernate 等），甚至切换到一个完全不同的后端，比如Web 服务，或者下一个伟大的事物是什么。

此外，如果它让您放心，LINQ 也无济于事。它是语言的一部分，正在单声道中实现，并且正在添加更多的 linq 提供程序。即使微软转向不同的技术，你仍然会看到人们使用和支持 Linq。见鬼，它已经在某种程度上发生在 Linq to Entities 中，你仍然看到大多数使用 Linq 的开发人员大多会忽略 L2E。今天使用 LINQ 的唯一主要缺点是缺乏可免费获得的可靠 MySQL/PostOgre linq 提供程序，但有一些正在开发中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T00:27:32.500

应该澄清ado用于检索数据，linq是一种查询语言，您必须同时使用它们，它们不一样。Linq to Sql 为您提供了一个数据访问层，这可能就是您所说的，但微软已经宣布放弃对它的支持并使用 Linq to Entities。如果你等一下，不。他们明天就会推出 LinqToEntitiesADO.NET#！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-08T00:29:42.977

LINQ 只是偶然地与数据库有关。总体而言，这确实是 Microsoft 对结构化数据访问进行更全面抽象的想法。但由于它的第一个表现形式是 LINQ-to-SQL，所以这是人们的第一个看法。当然，开发人员，尤其是那些对 SQL 不太熟悉的开发人员，都喜欢它。

但我认为它更像是 SQL 的替代品，而不是你提到的其他项目。

你应该开始使用 LINQ 吗？我想说首先阅读微软网站信息，看看你是否在概念上同意它。我认为这是一个很好的概念想法，微软有聪明的人在做这件事，而且没有太多的竞争。因此，只要您坚定地加入 .NET 组织，您就可能会喜欢它。有迹象表明，非微软世界最终也将加入，时间未定。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-08T00:44:32.647

LINQ 作为一种语言功能将“永远”（永远不会说永远不对）消失，所以学习它。它可能允许您查询任何数据结构。即您可以使用 LINQ 来查询 LINQtoSQL 实体、XML、数据集等。

但是，如果您专门谈论 LINQ to SQL，那么我有点同意您的看法。

不到 2 年前，LINQ to SQL 就一直存在。现在它被放弃了，取而代之的是实体框架。

现在，是的，他们已经说过很多 LINQ to SQL 功能将被集成到实体框架中，但尽管如此，LINQ to SQL，正如许多人所采用的那样，已经被放弃了，而且肯定还有很大的空间改进。

检查[此处](http://blogs.msdn.com/adonet/archive/2008/10/31/clarifying-the-message-on-l2s-futures.aspx)的评论是否存在类似问题。

# f# - 无效的 IL 代码 - F#

> ID：837676
> 
> 赞同：4
> 
> 时间：2009-05-08T00:20:35.947
> 
> 标签：f#, mono

我是 F# 的新手，我正在尝试编写一个计算幂集的函数。

我从下面的 Mono（在 Mac 上运行）收到一个错误。

例如，我会通过 calcPowerSet ([1;2;3], []) 来启动函数。关于如何解决这个问题的任何想法？

```
System.InvalidProgramException：FSI_0010 中的无效 IL 代码：calcPowerSet（Microsoft.FSharp.Collections.List`1，Microsoft.FSharp.Collections.List`1）：IL_005d：stind.r4  

  在 FSI_0010.calcPowerSet[Int32]（Microsoft.FSharp.Collections.List`1 _arg1_0，Microsoft.FSharp.Collections.List`1 _arg1_1）[0x00000]
  在 .$FSI_0011._main () [0x00000]
  在（包装器托管到本机） System.Reflection.MonoMethod:InternalInvoke (object,object[],System.Exception&)
  在 System.Reflection.MonoMethod.Invoke（System.Object obj，BindingFlags invokeAttr，System.Reflection.Binder binder，System.Object[] 参数，System.Globalization.CultureInfo 文化）[0x00000]
因错误而停止

```

代码：

```
让 rec calcPowerSet = 函数
 | ([], []) -> [[]]
 | （（头：：尾），（cHead：：cTail））->
  calcPowerSet (tail, (cHead::cTail)) @ calcPowerSet (tail, (head::cHead::cTail))
 | ((头::尾), []) ->
  calcPowerSet (tail, []) @ calcPowerSet (tail, [head])
 | ([], 收集) -> [收集];;

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T05:28:34.490

我不知道为什么它不起作用（我得到了相同的结果）但是如果你将它重写为：

```
let calcPowerSet =
   let rec innerCalc = 
      function
      | ([], []) -> [[]]
      | ((head::tail), (cHead::cTail)) -> 
         innerCalc (tail, (cHead::cTail)) @ innerCalc (tail, (head::cHead::cTail))
      | ((head::tail), []) -> 
         innerCalc (tail, []) @ innerCalc (tail, [head])
      | ([], collect) -> [collect]
   innerCalc 
```

它似乎在 Mac (intel) 下使用 Mono 2.4 和 F# 1.9.6.2 工作正常

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T19:59:20.177

仅供参考，事实证明 F# 团队知道这个错误，这是 Mono 团队知道的 Mono 2.4 中的一个错误（不知道是否已经修复）。

# iphone - iPhone 2.2.1 到 3.0 过渡最佳实践

> ID：837679
> 
> 赞同：5
> 
> 时间：2009-05-08T00:21:16.400
> 
> 标签：iphone, cocoa-touch, app-store

Apple 现在要求应用程序开发人员提交针对 2.2.1 但也为 3.0 构建的应用程序。我（我想大多数小型/兼职开发人员）只有一部 iPhone，并且由于升级到 3.0 是不可逆转的，我想就在过渡期间最小化风险的一些最佳实践提出一些想法.

我知道在这两种操作系统上进行全面回归测试没有万无一失的方法，但是任何关于如何最小化回归的想法都会有所帮助。

这是Apple的确切文本：

> 今年夏天，数以百万计的 iPhone 和 iPod touch 用户将转向 iPhone OS 3.0。从今天开始，所有提交到 App Store 的内容都将在 iPhone OS 3.0 的最新测试版上进行审核。如果您的应用提交与 iPhone OS 3.0 不兼容，将不会被批准。
> 
> App Store 中的现有应用程序应该已经在 iPhone OS 3.0 上运行而无需修改，但您应该使用 iPhone OS 3.0 测试现有应用程序以确保不存在兼容性问题。在 iPhone OS 3.0 可供客户使用后，任何与 iPhone OS 3.0 不兼容的应用程序都可能会从 App Store 中删除。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T07:02:25.217

You really can't test on a device against both 2.21 and 3.0 unless you have two devices. If that's really important, you can think about an iPod Touch (assuming your app doesn't require an iPhone).

As far as the simulator, once you install the 3.0 sdk you won't be able to build targeting 2.2.1 any longer. The old 2.2.1 build target gets replaced by a 3.0 target. To support both, you should think about building a virtual machine that retains the 2.2.1 sdk.

However, I agree with Alex... not much need to think about supporting both platforms. 3.0 is solid, and it's clear from today's Apple mail that it's now the major focus, as far as testing & compatibility.

Edit 5/17/09: One thing I learned after this post is that on the Mac, you can't virtualize the Leopard client OS. Apple only allows you to run the server version of OS X in a virtual machine. IMHO, this really limits software developers as a group, among others, and I hope this is changed eventually.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T02:01:06.143

您对将手机从 2.2.1 升级到 3.0 有什么顾虑？最新的修订版似乎或多或少是可靠的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T01:04:46.590

我在 iPhone Dev Central 上看到了可能有用的这个文档：[技术说明 TN2246](http://adcdownload.apple.com/iphone/iphone_sdk_3.0_beta_4/technical_note_getting_ready_for_iphone_os_3.0.pdf)

# jquery - Visual Studio jQuery IntelliSense 修复 KB958502 无法识别 Visual Studio 2008 安装在 Windows Server 2008 x64 上

> ID：837686
> 
> 赞同：0
> 
> 时间：2009-05-08T00:24:27.123
> 
> 标签：jquery, visual-studio, visual-studio-2008, windows-server-2008, intellisense

所以就在本周，我有机会重新构建我的开发机器，我选择使用**Windows Server 2008 x64**版本作为我的操作系统。我重新安装了**Visual Studio 2008**以及我所有的其他开发工具。我惊讶地发现[**KB958502 修补程序**](http://code.msdn.microsoft.com/KB958502/Release/ProjectReleases.aspx?ReleaseId=1736)无法识别我安装的**Visual Studio 2008**。我想知道是否有解决方案，或者是否有手动启用**jQuery**智能感知的替代方法。

谢谢你。

**更新**： [Stuart Dunkeld](https://stackoverflow.com/users/43846/stuart-dunkeld)是正确的，我忘记安装[**Visual Studio 2008 SP1**](http://www.microsoft.com/downloads/details.aspx?FamilyId=FBEE1648-7106-44A7-9649-6D9F6D58056E&displaylang=en)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T00:41:49.640

您是否安装了 Visual Studio 2008 SP1，这是此修补程序的先决条件？另请参阅[此页面](http://mwtech.blogspot.com/2009/05/how-to-get-jquery-intellisense-working.html)..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T00:38:36.543

如果您尝试了这些：[VS 2008 中的 jQuery Intellisense](http://weblogs.asp.net/scottgu/archive/2008/11/21/jquery-intellisense-in-vs-2008.aspx) 和 [Add reference to javascript file](http://igurr.com/blogs/programming/archive/2009/02/22/add-reference-to-javascript-file.aspx) 但没有希望，请尝试在 JS 文件的第一行中添加此行：

```
/// <reference path="jquery-1.3.2-vsdoc.js" /> 
```

并确保[jquery-1.3.2-vsdoc.js](http://code.google.com/p/jqueryjs/downloads/detail?name=jquery-1.3.2-vsdoc2.js)文件位于您的 JS 文件的同一目录中。

# debugging - 在 Silverlight 应用程序中启动调试和不启动调试有什么区别？

> ID：837690
> 
> 赞同：0
> 
> 时间：2009-05-08T00:24:39.900
> 
> 标签：debugging, silverlight-3.0, silverlight.fx

我有一个问题，其中我在 Silverlight.FX 样本的一些样本中得到了 AmbiguousMatchException。

例如，当我运行开始调试时，TaskList.aspx 示例演示了这个问题，异常在 ListView.cs 的第 202 行被命中

```
FrameworkElement uiItem = itemTemplate.LoadContent() as FrameworkElement; 
```

除了当我在不调试的情况下启动时没有出现这个问题。如果我正在调试它不会成功并创建一个项目。但是如果没有调试它会。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-08T00:54:32.980

我猜想异常是在堆栈的某个位置被捕获，如果没有附加调试器，你就看不到它。在 Debug>Exceptions 下，有一些选项可以更改在调试下运行时处理异常的方式。

# javascript - 使用 jQuery 获取 div 的背景图像。是否有一种内置方法可以去除 url() 部分？

> ID：837694
> 
> 赞同：8
> 
> 时间：2009-05-08T00:26:54.310
> 
> 标签：javascript, jquery

我正在使用此代码来获取`div`.

```
var bgImage = $('#content').css('backgroundImage'); 
```

这是回归`url%28http://example.com/images/layout/content-trans.png%29`

我知道您可以在不附加`element.height()`的情况下获取元素的高度（也可以），所以我想知道 jQuery 是否有类似的方法来获取实际背景图像减去元数据。`px``parseInt()``url()`

我想我可以使用正则表达式，例如`/url\((.*)\)/`，但我宁愿先知道是否有内置方式。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-08T00:33:59.567

url() 是背景图像值的一部分，所以我猜你需要使用正则表达式替换。

```
var bgImage = $('#content').css('background-image').replace(/^url|[\(\)]/g, ''); 
```

参考：[http ://groups.google.com/group/jquery-en/browse_thread/thread/d866997cb206b35f](http://groups.google.com/group/jquery-en/browse_thread/thread/d866997cb206b35f)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T00:34:50.390

就像是：

```
var imgUrl = 'http://example.com/images/layout/image.png';
var i = imgUrl.lastIndexOf("/"); 
var filename = imgUrl.substring(i, imgUrl.length - 1);
alert(filename); 
```

在纯 JS 术语中

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T00:35:50.233

这个简单的解决方案怎么样：

```
bgImage.slice(bgImage.lastIndexOf('/')+1, bgImage.length - 3) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-13T00:21:54.180

```
var url = /url\(\s*(['"]?)(.*?)\1\s*\)/g.exec(str)[2]; 
```

取自[waitForImages jQuery 插件](https://github.com/alexanderdickson/waitForImages/blob/master/src/jquery.waitforimages.js#L67)。我也是作者。

# .net - 数据集应该驻留在 n 层（多层）架构中的什么位置？

> ID：837697
> 
> 赞同：4
> 
> 时间：2009-05-08T00:27:26.710
> 
> 标签：.net, architecture, dataset, n-tier-architecture

我们目前正在讨论数据集应该放在数据层还是业务层？

我的朋友认为所有 ADO.NET 组件都应该放在数据层中。对我来说，这似乎不正确，原因如下：

*   如果您创建一个胖数据层客户端，例如将所有内容迁移到不同的数据源将会更加困难。
*   除非您跳过业务层逻辑，否则您无法绑定控件。

我认为数据集和数据表应该在业务逻辑中，因为它们对所有数据提供者都是通用的。数据层应该有一个提供者工厂来实例化正确的提供者的对象（连接、数据适配器、事务、数据读取器等）。对我来说，这是要走的路，原因如下：

*   迁移到不同的数据层非常简单。
*   您可以将控件绑定到丰富的业务对象

有没有n级的大师能帮我们弄清楚该走哪条路？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-08T00:37:06.593

在我看来，根本不要使用 DataSet。甚至不要使用类型化的 DataSet。这些是在 LINQ 之前创建的旧结构。跳过古代历史，进入现在时：使用 LINQ to Entities 和实体框架 (EF)。两者密切相关，但并不相同。

不要跨服务边界公开 EF 实体。不幸的是，微软选择在序列化实体时公开实现细节。除此之外，使用 EF 并获得比使用 DataSet 更多的乐趣。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T00:45:53.407

好吧，隔离数据访问并不是什么新鲜事：我们在 15 年前就这样做了（是的，15 年前！）。

我在很多地方工作过，我看到了很多孤立的数据层。

但我从来没有——从来没有！-- 看到一个数据源被替换了！

是的，我看过两次：而且两次，我们还更换了过期的数据层和所有顶级软件......

我的回答很简单：除非你正在为搁置软件工作，否则你可以尽可能多地隔离数据层，你将一无所获。

没有人会因为改变而改变 SQL Server 或 Oracle。并且因为有一天有人会这样做，他们要么会重写他们的软件，要么会确保他们购买的产品与他们离开的产品兼容。

在我的书中，任何数据层都是愚蠢的。

如果您不同意，请告诉我在您的生活中，这一层何时会为某人节省 $$...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T00:35:33.167

我在哪里，我们将数据集、数据表、数据行和数据读取器从数据层返回到业务层。

理由是这些类型不是特定于 db-flavor 的。无论您使用 mysql、access、sql server、oracle 还是任何数据集都是数据集，因此可以从根级数据层返回。

然后，业务层获取这些原始数据并将其转换为强类型业务对象——应用任何必要的业务规则——交给表示层。

* * *

**编辑：**当我查看一些代码时，我们并没有太多使用完整的数据集。它主要是数据表和数据读取器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T00:42:04.087

一种典型的方法是在您的业务逻辑层/域中公开一个聚合根（如客户）存储库接口，并在您的数据访问层/基础设施中实现具体的存储库。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-08T00:54:21.810

我对 DataSet 的基本问题是它们的结构是数据库模式的精确镜像。

如果您将 DataSet 暴露给实际的页面呈现代码，那么您实际上是将数据库模式（产品的最终后端）暴露给表示层。现在可能会出现明显的问题：稍后您将需要重新构建底层数据模式，并且由于设计原因，您需要将更改应用于系统中的所有其他层。这是一个真正应该使用的封装没有被使用的典型例子。

如果您打算使用数据集，请将数据集直接隐藏在数据访问层中，并向表示层公开一组概念业务对象。您公开的业务对象集应根据良好的面向对象原则设计，这与良好的关系数据库设计原则完全不同。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-05-08T00:44:13.427

我必须同意根本不使用数据集。我在其中工作的应用程序之一是数据层和应用程序层中的数据集。DataLayer 数据集与数据库相匹配，其中应用层数据集对信息进行了非规范化处理，以使其更适合前端使用。

# java - 如何从 java.lang.String 获取 java.io.InputStream？

> ID：837703
> 
> 赞同：96
> 
> 时间：2009-05-08T00:30:44.893
> 
> 标签：java, string, inputstream

我有一个`String`我想用作`InputStream`. 在 Java 1.0 中，您可以使用[`java.io.StringBufferInputStream`](http://java.sun.com/javase/6/docs/api/java/io/StringBufferInputStream.html)，但这已经是`@Deprecrated`（有充分的理由——您不能指定字符集编码）：

> 此类没有正确地将字符转换为字节。从 JDK 1.1 开始，从字符串创建流的首选方法是通过`StringReader` 类。

您可以创建一个[`java.io.Reader`](http://java.sun.com/javase/6/docs/api/java/io/Reader.html)with [`java.io.StringReader`](http://java.sun.com/javase/6/docs/api/java/io/StringReader.html)，但没有适配器可以使用 a`Reader`和创建一个`InputStream`。

我发现了一个[古老的错误](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4217782)，要求找到合适的替代品，但据我所知，不存在这样的东西。

经常建议的解决方法是[`java.lang.String.getBytes()`](http://java.sun.com/javase/6/docs/api/java/lang/String.html#getBytes(java.lang.String))用作以下内容的输入[`java.io.ByteArrayInputStream`](http://java.sun.com/javase/6/docs/api/java/io/ByteArrayInputStream.html)：

```
public InputStream createInputStream(String s, String charset)
    throws java.io.UnsupportedEncodingException {

    return new ByteArrayInputStream(s.getBytes(charset));
} 
```

但这意味着将`String`内存中的整个实体化为一个字节数组，并且违背了流的目的。在大多数情况下，这没什么大不了的，但我一直在寻找能够保留流意图的东西——尽可能少的数据在内存中（重新）物化。

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2013-01-02T23:19:58.617

**更新：**这个答案正是 OP 不想要的。请阅读其他答案。

对于那些我们不关心在内存中重新实现数据的情况，请使用：

```
new ByteArrayInputStream(str.getBytes("UTF-8")) 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2011-11-07T20:48:24.643

如果您不介意对[commons-io](http://commons.apache.org/io/)包的依赖，那么您可以使用[IOUtils.toInputStream(String text)](http://commons.apache.org/io/apidocs/src-html/org/apache/commons/io/IOUtils.html#line.1190)方法。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-09-06T09:45:12.320

有一个来自 Apache Commons-IO 的适配器，它从 Reader 适配到 InputStream，它被命名为[ReaderInputStream](https://commons.apache.org/proper/commons-io/javadocs/api-release/org/apache/commons/io/input/ReaderInputStream.html)。

示例代码：

```
@Test
public void testReaderInputStream() throws IOException {
    InputStream inputStream = new ReaderInputStream(new StringReader("largeString"), StandardCharsets.UTF_8);
    Assert.assertEquals("largeString", IOUtils.toString(inputStream, StandardCharsets.UTF_8));
} 
```

参考：[https ://stackoverflow.com/a/27909221/5658642](https://stackoverflow.com/a/27909221/5658642)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-08T14:31:07.830

在我看来，最简单的方法是通过 Writer 推送数据：

```
public class StringEmitter {
  public static void main(String[] args) throws IOException {
    class DataHandler extends OutputStream {
      @Override
      public void write(final int b) throws IOException {
        write(new byte[] { (byte) b });
      }
      @Override
      public void write(byte[] b) throws IOException {
        write(b, 0, b.length);
      }
      @Override
      public void write(byte[] b, int off, int len)
          throws IOException {
        System.out.println("bytecount=" + len);
      }
    }

    StringBuilder sample = new StringBuilder();
    while (sample.length() < 100 * 1000) {
      sample.append("sample");
    }

    Writer writer = new OutputStreamWriter(
        new DataHandler(), "UTF-16");
    writer.write(sample.toString());
    writer.close();
  }
} 
```

我使用的 JVM 实现以 8K 块的形式推送数据，但是您可以通过减少一次写入的字符数并调用 flush 来对缓冲区大小产生一些影响。

* * *

编写自己的 CharsetEncoder 包装器以使用 Writer 对数据进行编码的替代方法，尽管正确地做是一件痛苦的事情。这应该是一个可靠（如果效率低下）的实现：

```
/** Inefficient string stream implementation */
public class StringInputStream extends InputStream {

  /* # of characters to buffer - must be >=2 to handle surrogate pairs */
  private static final int CHAR_CAP = 8;

  private final Queue<Byte> buffer = new LinkedList<Byte>();
  private final Writer encoder;
  private final String data;
  private int index;

  public StringInputStream(String sequence, Charset charset) {
    data = sequence;
    encoder = new OutputStreamWriter(
        new OutputStreamBuffer(), charset);
  }

  private int buffer() throws IOException {
    if (index >= data.length()) {
      return -1;
    }
    int rlen = index + CHAR_CAP;
    if (rlen > data.length()) {
      rlen = data.length();
    }
    for (; index < rlen; index++) {
      char ch = data.charAt(index);
      encoder.append(ch);
      // ensure data enters buffer
      encoder.flush();
    }
    if (index >= data.length()) {
      encoder.close();
    }
    return buffer.size();
  }

  @Override
  public int read() throws IOException {
    if (buffer.size() == 0) {
      int r = buffer();
      if (r == -1) {
        return -1;
      }
    }
    return 0xFF & buffer.remove();
  }

  private class OutputStreamBuffer extends OutputStream {

    @Override
    public void write(int i) throws IOException {
      byte b = (byte) i;
      buffer.add(b);
    }

  }

} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-08T00:40:54.650

好吧，一种可能的方法是：

*   创建一个[`PipedOutputStream`](http://java.sun.com/javase/6/docs/api/java/io/PipedOutputStream.html)
*   通过管道将其连接到[`PipedInputStream`](http://java.sun.com/javase/6/docs/api/java/io/PipedInputStream.html)
*   环绕（你可以[`OutputStreamWriter`](http://java.sun.com/javase/6/docs/api/java/io/OutputStreamWriter.html)在`PipedOutputStream`构造函数中指定编码）
*   等等，你写的任何东西`OutputStreamWriter`都可以从`PipedInputStream`!

当然，这似乎是一种相当老套的方式，但至少它是一种方式。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-08T00:52:51.300

一种解决方案是自己动手，创建一个`InputStream`可能用于将每个或 s 块`java.nio.charset.CharsetEncoder`编码为字节数组的实现。`char``char``InputStream`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-06-28T11:07:44.127

您可以借助 org.hsqldb.lib 库。

```
public StringInputStream(String paramString)
  {
    this.str = paramString;
    this.available = (paramString.length() * 2);
  } 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2013-08-22T13:38:13.783

我知道这是一个老问题，但我今天自己也遇到了同样的问题，这是我的解决方案：

```
public static InputStream getStream(final CharSequence charSequence) {
 return new InputStream() {
  int index = 0;
  int length = charSequence.length();
  @Override public int read() throws IOException {
   return index>=length ? -1 : charSequence.charAt(index++);
  }
 };
} 
```

# sql-server - SQL Server - 表的最后插入行的日期/时间是什么？

> ID：837709
> 
> 赞同：3
> 
> 时间：2009-05-08T00:33:10.037
> 
> 标签：sql-server, timestamp

我的程序员同事并没有考虑为我们优秀数据库的每个表添加时间戳。

结果，有些表似乎已经过时，但很难说是哪些表。

对于每个表，有什么方法可以获取对它执行的最后一个插入命令的日期/时间？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T01:01:03.527

这取决于您使用的 SQL Server 版本。SQL server 2005 或更新版本你试试看[这里](https://sqlblog.org/2008/05/06/when-was-my-database-table-last-accessed)。如果它是一个较旧的服务器引擎，除非有人足够主动地使用存储过程和记录更新，否则您可能会不走运。

# hql - 使用 Castle ActiveRecord 进行聚合查询

> ID：837714
> 
> 赞同：0
> 
> 时间：2009-05-08T00:34:14.213
> 
> 标签：hql, castle-activerecord, aggregate-functions

我正在尝试执行一个简单的聚合查询，该查询返回聚合的结果加上一个额外的列。This post -> [Custom query with Castle ActiveRecord](https://stackoverflow.com/questions/308203/custom-query-with-castle-activerecord)有一个很好的例子来说明如何实现这一点，但我似乎无法让它工作。似乎 ActiveRecordMediator.ExecuteQuery 返回一个对象的 ArrayList（而不是我所期望的 object[] 的 ArrayList）。此外，如果我尝试将其强制转换为 ICollection，我会收到一个运行时错误，抱怨强制强制转换无效。下面的代码，任何帮助表示赞赏（不想使用手写 sql）。

```
HqlBasedQuery query = new HqlBasedQuery(typeof(Something), @"select count(1),  
  p.Name from Something p 
  where p.SomeDate > :date
  order by p.Name
  group by p.Name");

query.SetParameter("date", new DateTime(2009, 1, 1));

var results = from summary in 
    (ICollection<object[]>)ActiveRecordMediator.ExecuteQuery(query)
    select new {
        Count = (int)summary[0], Name= (string)summary[1]
    }; 
```

“from summary in”之后的行是引发无效转换异常的行。

（忘了说：使用 VS2008、.NET 3.5SP1、ActiveRecord 1.0RC3、NHibernate 1.2）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T03:43:40.420

1.  我认为你的意思是`count(*)`而不是`count(1)`（这就是为什么你只得到 1-col 行）
2.  ActiveRecordMediator.ExecuteQuery（至少在 RC3 中）返回一个`ArrayList`（不是泛型`ICollection`的）`object[]`
3.  小心将`count`结果转换为 int。一些数据库返回计数为`long`（例如 SQL Server）

# ios - iphone应用被拒绝但没有通知电子邮件

> ID：837715
> 
> 赞同：2
> 
> 时间：2009-05-08T00:34:23.013
> 
> 标签：ios, appstore-approval

我最近拒绝了我的应用程序，但他们还没有通过“解释”电子邮件发送。有没有人在没有串联解释或应用审查推理的情况下被拒绝？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T00:43:35.223

当您的应用在没有一封信的情况下被拒绝时，通常意味着它崩溃了。再次检查并重新提交。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T15:10:18.327

可能是应用程序与 OS 3.0 不兼容。

检查这个：[techradar.com - 新的 iPhone 应用程序必须兼容 3.0](http://www.techradar.com/news/phone-and-communications/mobile-phones/new-iphone-apps-must-by-3-0-compatible-597287)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-10T11:35:50.367

同样的事情发生在我身上，我的应用程序昨晚某个时候被拒绝了，但我没有收到任何通知。如果是与 3.0 兼容的问题，那就太糟糕了，因为我的应用程序是在该电子邮件发出前将近一周提交的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-03T09:04:10.373

放轻松，我们在 3 月份有一个应用被拒绝，现在是 7 月份，我们从来没有得到任何解释：有时他们只是不发送任何东西

# c# - 在 C# 中创建动态属性并绑定哈希表

> ID：837728
> 
> 赞同：1
> 
> 时间：2009-05-08T00:39:48.867
> 
> 标签：c#

我正在尝试将 Row 绑定到 gridview，它不仅包含 Category 表的字段，还包含其他表。所以我为所有这些字段设置了属性。但是由于表中的列可能会经常更改，因此我也需要动态更改属性。我找到了以下一种方法（使用哈希表）。但我无法将哈希表值绑定到 gridview。

如何更好地解决这个问题？

```
public partial class Form1 : Form
{
    public class Row
    {
        // properties
        public Hashtable Properties = new Hashtable();

    }
    public Form1()
    {
        InitializeComponent();
        DataClasses1DataContext context = new DataClasses1DataContext();
        var st = from c in context.Categories
                 select c;
        var p = from pr in context.Products
                 select p;

        Row r = new Row();
        //List<Row> listrow = new List<Row>();
        foreach (var item in st)
        {
            r.Properties.Add(item.Description, item.Description);
        }

        this.gridControl1.DataSource = r.Properties.Values;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T04:04:17.610

`Hashtable.Values`是`ICollection`- 但你需要`IList`绑定数据。理想情况下，您确实需要一个*类型化*的列表。为什么要`Hashtable`在这里使用？我怀疑你有足够的行来需要它......

相反，请使用类型列表（`List<T>`或`BindingList<T>`）。请注意，您只能绑定到网格中的单个类型。我根本不清楚您想在网格中显示什么，因为目前您只是添加描述，但在最简单的级别：

```
this.gridControl1.DataSource = context.Categories.ToList(); 
```

或更好）：

```
this.gridControl1.DataSource = context.Categories.ToBindingList(); 
```

这不会帮助您将两者都`Products`放入`Categories`一个网格中……但是，如果它们不是同一类型，则*什么都不会。**可能*起作用的一件事是公共属性的匿名类型：

```
var query = (from c in context.Categories
             select new {Id = c.CategoryId, Name = c.Category,
                   Description = c.Description }).Concat(
             from p in context.Products
             select new {Id = p.ProductId, Name = p.Product,
                   Description = p.ProductDescription });

this.gridControl1.DataSource = query.ToList(); 
```

但是请注意，匿名类型是不可变的（不可编辑） - 因此使用`ToBindingList()`. 另一种选择是为此目的声明您自己的类，这意味着它也可以是可编辑的。

# javascript - 如何从内部获取 Mootools 类的名称

> ID：837729
> 
> 赞同：5
> 
> 时间：2009-05-08T00:39:49.677
> 
> 标签：javascript, mootools

我想得到类的变量名。

```
var Poop = new Class({ 
    getClassName: function() { 
        return arguments.callee._owner.name;
    } 
});
var a = new Poop();
a.getClassName(); //want 'Poop' 
```

我正在将其实现到其他类中，并且我想构建一个 SQL 查询，该查询使用表的类名（复数形式）。

我尝试了上述示例的各种组合来尝试获取名称，但无法弄清楚（如果考虑到 MooTools 类系统甚至可能的话）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-08T06:52:06.897

找到了解决方案。 [Hash 有一个 keyOf 函数](http://mootools.net/docs/core/Native/Hash#Hash:keyOf)，它会给我保存一个值的变量名。于是我做了一个window的Hash，然后求类构造函数的key。

```
var Poop = new Class({
    name: function() {
        var w = $H(window);
        return w.keyOf(this.constructor);
    }
});
var a = new Poop();
a.name(); // returns 'Poop' 
```

当然，这只是因为我在全局窗口命名空间中创建了类（这在 MooTools 中很常见）。如果您在某个命名空间中创建了类，那么您只需要对那个命名空间进行散列即可。

编辑：对于任何感兴趣的 MooToolers，[我写了](http://mcarthurgfx.com/blog/article/get-class-of-an-instance)关于如何使用这个解决方案以及如何让它在命名空间中自动工作的文章。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-04T19:42:28.653

我遇到了 Extends 的问题，但找到了解决方法：

```
var getClassNameFromKeys = function (obj, instance) {
        var i = 0, keys = Object.keys(obj);
        for (i; i < keys.length; i++) {
        if ('Ext' !== keys[i] && typeOf(obj[keys[i]]) === 'class' && instance instanceof obj[keys[i]]) {
                return keys[i];
            }
        }
    },
    Ext = new Class(),
    WhatsMyName = new Class({
        Extends: Ext
    }),
    whatsMyNameInstance = new WhatsMyName(),
    cName = getClassNameFromKeys(this, whatsMyNameInstance);

console.log(cName); 
```

如果您遵循以下模式，则可以避免检查扩展名称：

```
var O = {},
    whatsMyNameInstance;

(function () {
    var SUBCLASS_KEYS;

    O.Ext = new Class({
        _className: null,
        getClassName: function () {
            var i = 0;

            SUBCLASS_KEYS = SUBCLASS_KEYS || Object.keys(O.subclasses);

            for (i; i < SUBCLASS_KEYS.length; i++) {
            if (this instanceof O.subclasses[SUBCLASS_KEYS[i]]) {
                    return SUBCLASS_KEYS[i];
                }
        }
        }        
    });
})();

O.subclasses = {};

O.subclasses.WhatsMyName = new Class({
    Extends: O.Ext
});

whatsMyNameInstance = new O.subclasses.WhatsMyName();

whatsMyNameInstance.getClassName(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T02:59:57.000

由于语言面向原型的性质，我认为这在 Javascript 中是不可能的。您可以做几件事来确定一个对象是否属于您知道的现有类，例如：

```
if (a.constructor == Poop) {
     alert("This will work, but I don't really want any Poop.");
} 
```

但是，这对于确定未知对象的类别并不起作用。您可以执行其他原型操作来检查涉及的类`toString()`，但它们仅适用于内置对象，而不适用于自定义类，这是原型设计的一个缺点，它并非特定于 MooTools。

如果您查看[Javascript 的第 5 版，权威指南](http://books.google.ca/books?id=2weL0iAfrEMC)，第 174 页，第 9.7 章，那里有一个很好的讨论。基本上，建议是使用属性填充自定义类，并在自定义类上调用它时`classname`覆盖默认的基 Object 类方法以检查此属性。`toString()`

# php - 这个 SQL 的 Active Record 实现？

> ID：837733
> 
> 赞同：0
> 
> 时间：2009-05-08T00:41:20.750
> 
> 标签：php, sql, activerecord, codeigniter

我正在使用 CodeIgniter。我的数据库是 MySQL 5。下面的 SQL 语句工作正常，但我认为它不会真正与 MSSQL、PG 等兼容。我想知道是否可以使用 CI 中的 Active Record 类来实现该语句，从而使其完全跨数据库？

我认为“GROUP_CONCAT”是我会摔倒的地方......

编辑 - 在 CodeIgniter 板上找到

> “然而，应该注意的是，CONCAT 是特定于数据库的。它实际上并不是活动记录库的一部分，尽管我确信它被大多数（如果不是所有）数据库引擎支持。”

我可能不得不重新考虑这一点，因为使用纯 Active Record 似乎是不可能的。

```
SELECT system.system_id,
       system.uuid,
       system.hostname,
       system.man_description,
       system.man_ip_address,
       system.os_short_name,
       system.os_full_name,
       system.man_type,
       system.man_icon,
       GROUP_CONCAT(DISTINCT '<a href="', oa_group.group_id, '">', oa_group.group_description, '</a>' ORDER BY group_description SEPARATOR ', ') as tag
FROM system,
       oa_group,
       oa_group_sys
WHERE system.system_id IN (
               SELECT system.system_id
               FROM system,
                       oa_group_sys,
                       oa_group,
                       oa_group_user
               WHERE system.man_status = 'production' AND
                       system.system_id = oa_group_sys.system_id AND
                       oa_group_sys.group_id = oa_group.group_id AND
                       oa_group.group_id = oa_group_user.group_id AND
                       oa_group_user.user_id = '1' ) AND
       system.system_id = oa_group_sys.system_id AND
       oa_group_sys.group_id = oa_group.group_id
GROUP BY system.system_id 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T06:25:20.110

您肯定必须重新考虑是的...为什么以所有神圣的名义，您滥用 group_concat 将某些内容从 SQL 内爆到 HTML 中？如果您要连接的字段中有 " 字符会怎样？

好的经验法则是： 使用您的数据库进行存储 使用您的 PHP 获取数据并将其转换为 HTML 或 PDF，或您想要的任何类型的输出。

另外，您可能想阅读有关使用 JOINS 的信息？您现在正在运行 2 个查询，其中一个具有一些连接和一个精心构建的 where 子句就足够了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-11T14:59:57.420

我的怀疑是，您会发现在数据库之外进行字符串操作会更快、更清晰。从长远来看，这条道路将充满可维护性问题。

# javascript - jQuery css() 函数更改“a”属性而不是“a:hover”属性

> ID：837741
> 
> 赞同：7
> 
> 时间：2009-05-08T00:43:03.930
> 
> 标签：javascript, jquery, html, css, dynamic-css

目前我在使用 jQuery`css()`函数时遇到了一些麻烦。它在悬停时更改锚元素的css值，`border-top-color`而不仅仅是锚元素的值。`border-top-color`下面是我的代码。

```
$("#header #headerlist li a:hover").css("border-top-color","rgb(225, 149, 79)"); 
```

为什么它会更改`#header #headerlist li a`边框顶部颜色和`#header #headerlist li a:hover`属性而不仅仅是`#header #headerlist li a:hover`属性？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-08T01:07:33.697

您的示例不起作用的原因是因为选择器无法检测 :hover 因为那是纯 CSS 的东西。相反，您可以尝试使用实际的[jquery hover 方法](http://docs.jquery.com/Events/hover)：

```
$("#header #headerlist li a").hover(
  function () {
    $(this).css("border-top-color", "#FF0000");
  }, 
  function () {
    $(this).css("border-top-color", "#000000");
  }
); 
```

或者，您也可以使用 addclass 方法：

```
$("#header #headerlist li a").hover(
  function () {
    $(this).addClass('hover-highlight');
  }, 
  function () {
    $(this).removeClass('hover-highlight');
  }
); 
```

这可以进一步简化为：

```
$("#header #headerlist li a").hover(function () {
    $(this).toggleClass('hover-highlight');
}); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-08T00:55:11.310

我不知道为什么，但是这种类型的更改最好在 CSS 中完成，所以我建议，如果你真的需要通过 JS 更改它，创建一个 CSS 类，然后在 JS 中更改它。

### CSS

```
#header #headerlist li a.fancy-border:hover{
  border-top-color: rgb(225, 149, 79);
} 
```

### JS

```
$("#header #headerlist li a").addClass("fancy-border"); 
```

这样，您可以更好地将功能与演示分开。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T04:35:46.613

它不起作用的原因是该`:hover`位实际上并未向选择器提供有关元素的任何信息。

`a:hover`在 CSS 匹配与 相同的元素时 `a`，它只是为用户将鼠标悬停在这些元素上时定义了一组不同的属性。

jQuery 选择器旨在查找（选择）元素，而不是设置它们的样式。

该`css()`方法只是在所选元素上设置内联样式，它不会**添加**或更改任何实际的 CSS 声明。

正如其他人所提到的，您可以使用该`hover()`事件来获得相同的行为。不过，正如另一位回答者所描述的那样，动态添加一个类可能会更好。

但是，如果您不需要即时更改，我建议使用普通的旧 CSS，因为它更快并且不需要用户启用 javascript。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-10T20:35:25.813

此代码自 1.9 以来已损坏

```
if($('...').is(':hover')){
  $(this).css('set','your styles here')
} 
```

改用这个

```
var class = '...';
if($(class+':hover').length>0){
  $(class).css('set','your styles here');
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-10T03:42:29.907

将 !important 添加到悬停 CSS 以避免样式被覆盖。例如：

```
test:hover {
    border: 1.5px solid white !important;
    color: white !important;
}
```

# c# - 如何为整个应用程序配置本地化？

> ID：837744
> 
> 赞同：1
> 
> 时间：2009-05-08T00:44:14.080
> 
> 标签：c#, asp.net, localization

我知道我可以在 Application_BeginRequest 事件中设置具有指定文化的 CultureInfo 对象，如此处所述，但我不想为每个请求执行此操作，而是在应用程序启动时执行此操作[。](https://stackoverflow.com/questions/300841/how-do-you-globally-set-the-date-format-in-asp-net/300853#300853)

我所能想象的只是我可以使用 Application_Start 事件，但我不知道如何设置全球文化。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T02:02:04.627

在你的 web.config 中设置它：

```
<globalization uiCulture="es" culture="es-MX" /> 
```

更多信息在这里：[http://msdn.microsoft.com/en-us/library/bz9tc508.aspx](http://msdn.microsoft.com/en-us/library/bz9tc508.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T01:12:53.280

Thread.CurrentThread.CurrentUICulture

请记住，这会覆盖 WinForm 应用程序将从计算机获得的设置。例如，如果用户定义了自定义日期格式，这将替换该格式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T21:44:43.340

gattaca 的回答是对的，但是如果你想真正根据用户的偏好或浏览器的语言设置动态地改变文化信息，最好的地方是重写 Page 类的 InitializeCulture 方法。所以你可以为此编写一个基类。

受保护的覆盖无效 InitializeCulture() {

```
LanguageHelper.RestoreUserLangugagePreferrenceIfAvailabe(); 
```

}

当然，这似乎有点过头了，因为您需要更改基类。还有其他地方可以放置，比如使用模块注入代码，但我尝试了所有这些解决方案，page_load 事件，但它们都不能 100% 使用 .net 本地化架构。试试本地资源文件，全局资源文件，你就会明白我的意思了。

# .net - 如何：具有传输安全性+服务器证书身份验证的 WCF。没有客户证书？

> ID：837748
> 
> 赞同：0
> 
> 时间：2009-05-08T00:44:49.697
> 
> 标签：.net, wcf, ssl, wcf-security, x509

我是否正确理解可以使用“传输安全性”、“证书身份验证”设置 WCF 服务并且***没有***安装“客户端证书”客户端？

我的情况是：

*   远程服务器上的 WCF 服务
*   Windows Forms 客户端可能向数百名用户发送（验证用户（针对 DB）并通过 WCF 服务方法执行操作）

我希望我的消息通过 SSL 加密，这就是我选择“传输”方法的原因，我相信为什么我还需要服务器证书。

我遵循了一个演练，它给了我以上所有内容，但包括安装客户端证书的必要性？如果我将此 Windows 窗体应用程序发送给客户，如果我被迫要求他们如何安装证书？似乎我在这里遗漏了一个重要点，因为我认为将证书安装到用户机器上将是一个很大的问题。

*PS。可能从我在[这里阅读](https://stackoverflow.com/questions/783807/wcf-security-and-certificates)的内容来看，我手头的任务是否过于复杂？我是否只需要在我们的 Web 服务器中安装 SSL 证书并通过 HTTPS 访问 WCF 服务，并且可能只需要使用 basicHttpBinding？实际上不需要担心“证书认证”机制？*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T01:10:46.623

您不需要客户端证书，它只是 ssl。如果您使用 IIS 来托管服务，这很简单，只需安装证书即可。消息级别的安全性变得有点棘手，但你应该在 ssl 证书上没问题。

如果您使用 basicHttpBinding，则不需要关闭身份验证，默认情况下 WSHttpBinding 会打开消息级别身份验证，您可以通过将身份验证模式（我相信）设置为无，在 Web 配置中将其关闭。如果您只需要 ssl，请使用基本的。如果您想要 ssl 和 Windows 身份验证，请使用 WSHttpBinding。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T09:49:03.850

正如 Joshua 所说，如果您要使用用户名来验证您的客户端，则不需要客户端证书。在这种情况下，客户端传递用户名和密码，服务器提供证书用于相互认证/握手过程。

我最近刚刚为一个类似的系统设置了一个 wcf 安全系统（通过 www 赢得表格），我使用了[CodePlex](http://wcfsecurityguide.codeplex.com/Wiki/View.aspx?title=Ch%2015%20-%20Internet%20%u2013%20Windows%20Forms%20Client%20to%20Remote%20WCF%20Using%20Message%20Security%20%28Original%20Caller%2c%20HTTP%29)的指导，它提供了一个分步检查列表，以帮助确保你准备好一切。您不必遵循每一步，例如我们没有使用角色功能，但我们使用的是会员商店。

下面是使用用户名和服务器证书使用 wsHttpBinding 进行设置/配置的简要总结：

客户端配置：

```
 <security mode="Message">
        <message clientCredentialType="UserName" negotiateServiceCredential="true"
          algorithmSuite="Default" establishSecurityContext="false" />
      </security> 
```

在代理上设置的用户名密码：

```
'ClientCredentials added to service call for authentication
    objServiceClient.ClientCredentials.UserName.UserName = MyAppContext.Username
    objServiceClient.ClientCredentials.UserName.Password = MyAppContext.Password 
```

服务器配置：

*   捆绑：

    ```
     <wsHttpBinding>
            <binding name="MyApp.wsHttpBindingMessageUname">
                <security mode="Message">
                    <message clientCredentialType="UserName" negotiateServiceCredential="true"
                      establishSecurityContext="false" />
                </security>
            </binding>
            </wsHttpBinding> 
    ```

*   行为：

    ```
     <serviceBehaviors>
            <behavior name="MyApp.DefaultServiceBehavior">
                <serviceCredentials>
                    <serviceCertificate findValue="localhost" storeLocation="LocalMachine"
                     storeName="My" x509FindType="FindBySubjectName" />
                    <userNameAuthentication userNamePasswordValidationMode="MembershipProvider"
                     membershipProviderName="AspNetSqlMembershipProvider" />
                </serviceCredentials>
            </behavior>
        </serviceBehaviors> 
    ```

希望对您有所帮助，如果您有任何问题，请告诉我。

# jquery - 当用户关闭弹出窗口时，刷新父级下拉菜单

> ID：837750
> 
> 赞同：0
> 
> 时间：2009-05-08T00:45:53.483
> 
> 标签：jquery, ajax, ssl, popup

我有一个三步注册过程，全部在一个页面上，最后一个要求用户选择保存的付款方式或输入新的付款方式。

显然，我想通过 SSL 收集新数据。该过程的第 2 步涉及向用户显示 Google 地图，而 GMaps API 不能很好地与 SSL 配合使用。

我的解决方案是使用带有通过 SSL 提供的小型“新付款方式”页面的弹出窗口。用户输入信息，并给新的支付方式一个昵称。当他们单击提交按钮时，我在关闭窗口之前使用 ajax 调用将信息保存到数据库中。

我的问题是如何使用新方法的昵称更新父页面，以便用户完成注册过程？

我正在使用 jQuery，所以任何使用 jQuery 的解决方案都会很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T00:51:06.763

您可以使用 javascript 使用 opener 访问原始窗口，包括对该窗口中定义的任何函数的调用。

例如：

```
window.opener.addValue(newValue); 
```

应该做你想做的。

# winforms - 在 Visual Studio 中设置许多表单控件的 TabIndex 属性？

> ID：837752
> 
> 赞同：54
> 
> 时间：2009-05-08T00:48:53.820
> 
> 标签：winforms

在 Visual Studio 中设置/重新排序许多表单控件的 TabIndex 属性的最有效方法是什么？当我更改大型表单的布局时，甚至是初始设计时，我经常想知道是否有比单击每个单独的控件然后在属性窗口中设置 TabIndex 更快的方法。

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2009-05-08T00:57:37.857

在设计器模式下，从“视图”菜单中选择“Tab Order”，然后按所需顺序单击每个控件。然后**记得在完成后关闭 Tab Order**，否则当您选择一个控件来执行其他操作时，您会丢失刚刚完成的工作（我希望 Tab Order 在您保存时关闭..）

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-08T01:00:36.443

在设计模式下调出表单。

单击查看菜单 -> 选项卡顺序

然后一个小数字将显示在每个表单上，代表其标签顺序。现在按您希望设置其标签顺序的顺序单击每个项目。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-22T05:14:41.973

在设计视图中调出 VS2012 中的标签顺序 点击实际表单然后转到 VIEW / TAB ORDER 然后这将启用标签顺序窗口。

完成更改标签顺序后，返回 VIEW / TAB ORDER 这将停用标签顺序布局

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-10T12:12:13.573

万一其他人也有同样的问题（您可能还会在链接中看到打印屏幕）： 第一步：当您在菜单中表单的设计视图中时，请转到查看并选择 Tab Order。第二步：在你的控件上会出现一个数字，代表你的控件的 Tab Order。要重新设置标签顺序，请按升序单击想要成功的控件，包括标签（即使它们不可选择）。我希望这一步对你来说也很直观。打印屏幕位于：[http ://how-to-code-net.blogspot.ro/2013/06/how-to-set-tab-order-for-controls-in.html](http://how-to-code-net.blogspot.ro/2013/06/how-to-set-tab-order-for-controls-in.html)

# .net - 从.Net调用访问模块中的例程？

> ID：837754
> 
> 赞同：3
> 
> 时间：2009-05-08T00:48:57.893
> 
> 标签：.net, ms-access, automation

我无法从 .Net（VB 或 C#）自动化 Access 2007。我要做的就是从.Net 调用Access 模块中的子例程。

最终，我必须让它在 VB 中工作，但我一直在尝试两者，结果相同。

下面是我的 VB 测试表单中的代码。它导致错误：

System.Runtime.InteropServices.COMException (0x800A9D9F)：来自 HRESULT 的异常：Microsoft.Office.Interop.Access.ApplicationClass.Run 中的 0x800A9D9F（字符串过程，对象和 Arg1，对象 &Arg2，...，对象 &Arg30）

我在 Access 中的测试 Sub 名为“MyTest”，是名为“Module1”的模块。它所做的只是在表中插入一条记录。它在 Access 中运行良好。我尝试了“Module1.MyTest”、“MyTest()”、“Call MyTest”等的各种排列，但没有成功。

我在自动化 Access（和其他 Office 应用程序）的网络上找到了一些其他示例，但似乎无法正常工作。如果有人能指出一个可行的例子，我将不胜感激。

示例代码：

```
Imports Access = Microsoft.Office.Interop.Access
Imports Microsoft.Office.Core

Public Class FormTest
    Private Sub cmdTest_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cmdTest.Click

        Dim aa As New Access.Application()

        Try
            aa.OpenCurrentDatabase("c:\Test.accdb")
            aa.Run("MyTest")
        Catch ex As Exception
            MsgBox(ex.ToString())
        Finally
            If aa IsNot Nothing Then
                aa.Quit(Access.AcQuitOption.acQuitSaveNone)
            End If
            Me.Close()
        End Try

    End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T10:00:34.277

这是安全。在 Access 中，我不得不关闭所有安全检查。一旦我这样做了，它工作得很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T00:54:16.927

尝试查看 InnerException（错误的实际原因）。

此外，如果您了解 VB6 - 尝试在 VB6 中编写相同的代码并查看是否可行。
如果您没有遇到任何错误，它应该在 VB.net 中工作相同

编辑： MyTest 是公共方法吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T10:01:44.740

如果您的访问过程的目标是操作访问文件中的表，为什么不打开与 .mdb 文件的 ODBC 或 OLEDB 连接，然后直接在表上执行工作，或者通过打开记录集并操作它，还是通过发送相应的SQL指令？

您至少将节省创建 Access 的新实例所需的所有时间。

# css - 为什么我的 ul 和 ol 列表在 IE7 中无法正常显示？

> ID：837762
> 
> 赞同：3
> 
> 时间：2009-05-08T00:52:00.427
> 
> 标签：css, internet-explorer-6, internet-explorer-7, list

某些东西似乎破坏了IE7中列表 (`ul`和) 的显示。`ol`它们在 IE8、FF、Safari 等中运行良好，但在 IE7 和 IE6 中运行良好。

我只希望它们正常显示：`ul`列表应该显示项目符号，`ol`列表应该显示数字。

我已将其范围缩小到`styles_layout.css`...中的前 1000 行代码；）

实际上，我认为它与以下样式有关：

```
* { margin: 0; } 

html, body { height: 100%; } 

.wrapper 
{ 
  min-height: 100%; 
  height: auto !important; 
  height: 100%; 
  margin: 0 auto -39px; 
} 
```

看看这里：[http](http://www.olvarwood.com.au/olvarwoodonline/mod/forum/discuss.php?d=2) ://www.olvarwood.com.au/olvarwoodonline/mod/forum/discuss.php?d=2 ，登录为`guest`

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-09T12:40:22.340

IE7 及以下样式的 ul 元素如下：

```
ul {
  margin-left: 40px
} 
```

好的浏览器样式 ul 元素是这样的：

```
ul {
  padding-left: 40px
} 
```

Eric Meyer 在这里更好地解释了这一点： [https](https://developer.mozilla.org/en/Consistent_List_Indentation) ://developer.mozilla.org/en/Consistent_List_Indentation 和“查找一致性”部分会告诉你你做了什么。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-08T08:34:01.673

这是因为 ul/li 元素继承了零边距属性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T01:02:23.320

我通过反复试验自己解决了这个问题：

```
* {
    margin: 0;
} 
```

这会阻止 Ol's 和 Ul's 在 IE7 和 IE6 中正确显示。我不知道为什么...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T01:01:34.897

我什至不会假装是css专家，我一直被它踢屁股，但我只是碰巧遇到了这个，虽然我的情况有点不同。

我最终不得不指定一个绑定到 ul 的类并设置列表类型。

```
.classname ul { list-style disc inside } 
```

试试看是否有帮助。

# asp.net - SVN 新手，如何设置？

> ID：837764
> 
> 赞同：2
> 
> 时间：2009-05-08T00:52:04.047
> 
> 标签：asp.net, iis, tortoisesvn, visualsvn-server

我有一个带有 IIS 的 Windows 2003 服务器，我在上面安装了 VisualSVN 服务器。

我有两个开发人员，他们将使用 TortoiseSVN。

由于这是我第一次设置 SVN 服务器，我对这一切如何工作感到有点困惑。在我看来，每个开发人员都会在他或她的本地 PC 上拥有存储库的副本，是否每个人都需要在他们的 PC 上安装 IIS 并在签出之前测试他们的副本？

我应该在服务器上创建一个测试文件夹，然后准备好生产吗？似乎这会导致副本出现更多问题？

你会怎么办？

**编辑**

我不知道我在想什么，我在调试时忘记了 VS 有一个内置的 IIS，所以关于在客户端或服务器上设置 IIS 的问题现在不是问题。但我很困惑，我将该网站导入到 repo 中，它说它是在修订版 2 上，但我没有看到 repo 文件夹中的任何文件。我是否在 IIS 中创建一个指向我创建的存储库的虚拟文件夹？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-08T00:56:39.543

不，每个开发人员都使用您的存储库，并签出他们自己的副本来完成他们的工作。他们不需要在他们的系统上安装 IIS 或 svn 等。

我建议阅读[Subversion 常见问题解答](http://subversion.tigris.org/faq.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T01:25:48.117

您的开发人员没有本地存储库，他们的 PC 上有工作副本。通常，这是应用程序的最新版本，开发人员已进行了任何更改但尚未提交。

由于这是一个 Web 应用程序，因此您的开发人员将需要某种类型的本地 Web 服务器来对其进行测试——这可能是 IIS 或 Visual Studio 的内置 Web 服务器（尽管它的行为与 IIS 有细微的不同）。

你在评论中说：“我的问题是我不希望开发人员提交到现场网站，以防万一出现错误。”。

开发人员提交到服务器上的 SVN 存储库：在某些时候，您会希望将存储库中最新版本的副本导出（也称为“发布”）到您的实时站点。为了确保它有效，您可以从服务器检查特定版本，对其进行测试，如果它通过测试上传它：开发人员将始终检查有错误的代码（即使它构建），因为最好检查频繁地编写代码而不是在本地构建大量更改然后提交它们，因为肯定会与其他开发人员所做的工作发生冲突。

分支和标记在这里是有用的概念：当您有一个几乎正确的版本时，您将它“分支”远离源代码树的主“主干”，修复分支中的任何问题（向后移植到主干根据需要），然后当你有一个工作版本时，你“标记”它（作为版本 xyz）并上传它。通过这种方式，您始终可以参考您上传的代码的特定版本，从而更容易识别生产中出现的错误。正如其他人所建议的，请阅读 SVN 文档以获取更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T00:56:21.150

这取决于你的工作方式。还有[其他](https://stackoverflow.com/questions/16829/structure-of-projects-in-version-control)关于文件夹结构等的讨论直接影响了您如何使用版本控制。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T00:57:25.563

呃，不，没有本地存储库。设置 SVN 很简单，差不多。您需要查找 svn windows 安装程序并将其设置在服务器上。您需要安装 Apache，然后设置 http.conf 文件以通过 http 公开 svn 会遇到一些障碍。设置安全性有点复杂，所以使用 Windows 身份验证，你需要 WebDav，谷歌它。

一旦完成，任何 svn 客户端都可以点击它并签出副本并正常使用 SVN。如果您真的卡住了，请在此处发表评论，我会为您获取我们的安装和配置副本。

好消息是它坚如磐石，一旦设置好，它将永远运行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-08T01:09:36.097

[“Pragmatic Version Control Using Subversion”](https://rads.stackoverflow.com/amzn/click/com/0977616657)和[SVN red-bean](http://svnbook.red-bean.com/)是您需要查看的两个来源。

在单个服务器上设置 SVN，并让所有开发人员指向它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-08T01:24:19.070

我已经在服务器上安装了乌龟，并对发布网站进行了更新/检查。有些人不喜欢签入已编译的代码，但我喜欢在 SVN 中拥有生产编译站点。

如果您在服务器上使用 tortoise，请对 inetpub/website 目录进行初始签出，然后在推出时您只需要使用 tortoise->update 更新目录

当然，如果没有先在登台服务器上进行部署和测试，签入到部署被认为是不好的做法，但这取决于您的团队规模。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-08T01:27:23.480

否 - 您的中央服务器将维护存储库。您的开发人员将获得存储库的副本，进行更改，然后将它们提交到您的存储库。

如果你想成功部署颠覆，你实际上有很多事情要弄清楚。

关于在 Windows 上设置 subversion 的一篇非常好的文章 - [https://blog.codinghorror.com/setting-up-subversion-on-windows/](https://blog.codinghorror.com/setting-up-subversion-on-windows/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-08T07:22:35.730

我使用以下资源来学习 SVN：

[http://www.polymorphicpodcast.com/shows/subversion/](http://www.polymorphicpodcast.com/shows/subversion/)

[http://www.dimecasts.net/Casts/ByTag/SVN](http://www.dimecasts.net/Casts/ByTag/SVN)

发现两者都很好，并且通过观看学习可以更容易，尤其是对于入门而言。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-05-08T00:59:53.187

不可以，SVN 服务器必须安装在单台计算机上。每个开发人员都指向这台计算机并在本地（最终）获得存储库的完整副本或部分副本。

你也可以从 O'Reilly 购买一本关于 Subversion 的书。不记得标题了，对不起，但它对我很有帮助。

祝一切顺利 ！西尔万。

# c - 传递二维数组时发出警告

> ID：837766
> 
> 赞同：1
> 
> 时间：2009-05-08T00:52:27.243
> 
> 标签：c, arrays, pointers

我有以下功能

```
void initBoard(int * board[BOARD_ROWS][BOARD_COLS]){
  int z = 0;
  for( z = 0; z<10; z+=1){
     int l;
     for( l = 0; l<10; l+=1){
        board[z][l] = 0;
     }
  }
} 
```

从主要我称之为

```
 int plBoard[10][10];
  initBoard(&pcBoard); 
```

编译时它可以工作，但我收到一条警告：警告：从不兼容的指针类型传递“initBoard”的参数 1。array 是一个整数，并且函数需要一个 int 指针，我正在传递 int 的地址。它有什么问题？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-08T00:57:27.437

除了您的问题中明显的错字（定义`plBoard`但使用`pcBoard`）之外，您不需要使用地址运算符（`&`）传递数组，因为它们会自动转换为地址。

但是您的`incompatible type`问题是由以下原因引起的：

```
int * board[BOARD_COLS][BOARD_ROWS] 
```

这实际上是一个 2d`int` *指针*数组（技术上是指向 的指针数组`int`），而不是您期望的整数。

你应该使用：

```
void initBoard(int board[BOARD_COLS][BOARD_ROWS]) {  // <-- remove "*"
: : :
}
int plBoard[10][10];
initBoard(plBoard);                                  // <-- remove "&" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T00:55:21.747

我不完全确定，但我相信这是因为：

**initBoard 需要一个指向整数**s的指针数组。

然而，plBoard 是一个**指向****整数**数组数组的指针

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T01:32:44.200

从技术上讲，您将指针的内存地址发送到 initBoard()。当您声明一个数组（在本例中为 plBoard）时，它指向一个内存地址，其中连续内存保存您的数据项......所以说这个是多余的......

```
int plBoard[10][10];  initBoard(&pcBoard); 
```

Pax 有你的答案，我只是在澄清，因为你还没有将它标记为答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T05:40:03.887

只是在同一页上..我完全同意 Pax ..

> 块引用 int pcBoard[10][10]; 块引用 initBoard(&pcBoard);

现在假设 pcBoard[0][0] 指向第 101 个位置（32 位地址）等等。您所传递的意思是 &pcBoard 是 pcBoard[0][0] 的 32 位地址。所以当函数

> Blockquote void initBoard(int * board[BOARD_ROWS][BOARD_COLS]){

使用它..它显示一个错误，说它需要一个二维数组，而它在一个 32 位地址中得到的是 4 个字节（int）。

只是一个提示，你不需要在传递时同时指定board[BOARD_ROWS][BOARD_COLS]。你可以方便地消除BOARD_ROWS，只指定BOARD_COLS。

# c++ - 如何将对象列表从 C++ 传递到 Lua？

> ID：837772
> 
> 赞同：12
> 
> 时间：2009-05-08T00:54:15.633
> 
> 标签：c++, object, lua

我是[Bitfighter](http://bitfighter.org/)的首席开发人员，并且正在使用 Lua 添加用户脚本机器人。我正在使用 C++ 和 Lua 使用 Lunar 将它们粘合在一起。

我正在尝试做一些我认为应该非常简单的事情：我在 Lua 中有一个 C++ 对象（下面的代码中的机器人），我在它上面调用了一个方法（findItems），它导致 C++ 搜索周围的区域机器人并返回它找到的对象列表（TestItems 和此处未显示的其他对象）。我的问题只是我如何在 C++ 中组装并返回找到的项目列表，然后在 Lua 中迭代它们？

基本上，我想填写*<<<< 创建项目列表，将其返回到*下面的 lua >>>> 块，并在 Lua 代码本身中进行我可能需要的任何更正，包括在下面。

我试图保持代码简单但完整。希望这里没有太多！谢谢！

**C++ 头文件**

```
class TestItem : public LuaObject
{

public:
   TestItem();     // C++ constructor

   ///// Lua Interface

   TestItem(lua_State *L) { } ;             //  Lua constructor

   static const char className[];
   static Lunar<TestItem>::RegType methods[];

   S32 getClassID(lua_State *L) { return returnInt(L, TestItemType); }
};

class LuaRobot : public Robot
{
   LuaRobot();     // C++ constructor

   ///// Lua Interface

   LuaRobot(lua_State *L) { } ;             //  Lua constructor

   static const char className[];
   static Lunar<LuaRobot>::RegType methods[];

   S32 findItems(lua_State *L);
} 
```

**C++ .cpp 文件**

```
const char LuaRobot::className[] = "Robot";      // Class name in Lua
// Define the methods we will expose to Lua
Lunar<LuaRobot>::RegType LuaRobot::methods[] =
{
   method(LuaRobot, findItems),
   {0,0}    // End method list
};

S32 LuaRobot::findItems(lua_State *L)
{
   range = getIntFromStack(L, 1);    // Pop range from the stack
   thisRobot->findObjects(fillVector, range);  // Put items in fillVector

   <<<< Create list of items, return it to lua >>>>

   for(int i=0; i < fillVector.size(); i++)
      do something(fillVector[i]);    // Do... what, exactly?

   return something;
}

/////
const char TestItem::className[] = "TestItem";      // Class name in Lua

// Define the methods we will expose to Lua
Lunar<TestItem>::RegType TestItem::methods[] =
{
   // Standard gameItem methods
   method(TestItem, getClassID),
   {0,0}    // End method list
}; 
```

**Lua 代码**

```
bot = LuaRobot( Robot ) -- This is a reference to our bot

range = 10
items = bot:findItems( range )

for i, v in ipairs( items ) do
    print( "Item Type: " .. v:getClassID() )
end 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-08T15:39:03.300

所以你需要填充一个向量并将其推送到 Lua。下面是一些示例代码。*应用程序*是一个*std::list*。

```
typedef std::list<std::string> Applications; 
```

我创建了一个表格并用列表中的数据填充它。

```
int ReturnArray(lua_State* L) {
    lua_createtable(L, applications.size(), 0);
    int newTable = lua_gettop(L);
    int index = 1;
    Applications::const_iterator iter = applications.begin();
    while(iter != applications.end()) {
        lua_pushstring(L, (*iter).c_str());
        lua_rawseti(L, newTable, index);
        ++iter;
        ++index;
    }
    return 1;
} 
```

这让我在堆栈中有一个数组。如果它返回到 Lua，那么我可以编写以下内容：

```
for k,v in ipairs( ReturnArray() ) do
    print(v)
end 
```

当然到目前为止，这只是给我一个 Lua*字符串*数组。*要获取 Lua对象*数组，我们只需稍微调整您的方法：

```
S32 LuaRobot::findItems(lua_State *L)
{
    range = getIntFromStack(L, 1);    // Pop range from the stack
    thisRobot->findObjects(fillVector, range);  // Put items in fillVector

    // <<<< Create list of items, return it to lua >>>>

    lua_createtable(L, fillVector.size(), 0);
    int newTable = lua_gettop(L);
    for(int i=0; i < fillVector.size(); i++) {
        TestItem* item = fillVector[i];
        item->push(L);  // put an object, not a string, in Lua array
        lua_rawseti(L, newTable, i + 1);
    }
    return 1;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T08:23:29.630

这完美地工作。为了向正在阅读本文的其他人澄清，该方法

```
item->push(L) 
```

是

```
void push(lua_State *L) {  Lunar<TestItem>::push(L, this); } 
```

通过将其封装在一个方法中，可以使 findItems 与它的发现无关。

感谢您的帮助！

# iphone - 导航控制器疯狂

> ID：837774
> 
> 赞同：1
> 
> 时间：2009-05-08T00:54:19.347
> 
> 标签：iphone, objective-c

问候。我有一个行为不端的导航栏应用程序。我有两个按钮，一个显示来自我的数据库的所有结果，另一个显示我的数据库的一个子集。当然，每个按钮都有自己的操作方法。这两种方法都实例化了同一类的视图控制器对象。

如果我启动应用程序并仅单击“所有结果”按钮，我会看到所有结果。愚蠢的是，当我单击结果子集的按钮（并查看结果子集）时，单击导航栏上的返回，然后单击整个集合的第一个按钮，我又看到了子集。

在到处使用断点进行调试时，我注意到我的结果视图控制器的 dealloc 方法没有被调用。但是，当我单击返回然后单击所有结果按钮时，确实为我的结果视图控制器再次调用了 alloc/init 方法。

因此，即使我有明显的内存泄漏，我新分配/初始化的视图控制器对象怎么可能与先前实例化的视图具有相同的数据？单步执行代码使这个问题看起来更加奇怪，因为它似乎表现得很好……只是产生了旧数据。

任何建议都会很棒。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T01:09:43.723

在表视图上调用“reloadTableData”应该确保数据被刷新。在操作方法中调用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T02:47:14.690

为什么你的按钮反复实例化视图控制器？为什么不将指向视图控制器的指针作为实例变量，您只需设置一次即可随意使用？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T03:39:39.650

这只是一个疯狂的猜测，但它可能与 tableViewCells 的重用有关。尝试始终创建 UITableViewCell，避免重用标识符以查看旧数据是否仍然存在。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-17T20:36:26.480

不久前我弄清楚出了什么问题，并认为我会回答我自己的愚蠢问题。:)

我忘记了我将我的数据库类设为单例，并在应用程序委托类中放置了一个指向“allResults”的主指针。

无论如何感谢您的意见。每一点都帮助我更好地了解这个新环境。

# c# - 在 C# 中调用另一个窗体上的方法

> ID：837788
> 
> 赞同：1
> 
> 时间：2009-05-08T00:58:11.020
> 
> 标签：c#, winforms

我正在构建一个基本的图像编辑器。在我的应用程序中，如果用户想要调整图像大小，则会弹出一个新表单并要求用户输入图像的新宽度和高度。

```
public partial class Form1 : Form
{
...
    private void resizeToolStripMenuItem_Click(object sender, EventArgs e)
    {
        resize resizeForm = new resize();
        resizeForm.ShowDialog();
    }
...
} 
```

我想知道如何从中获取值`resizeForm`并使用它们来更改父表单（`Form1`实例）上的图像。

如果这个问题需要澄清，请告诉我。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-08T01:02:53.787

我认为有很多方法可以做到这一点。我可能会在 resizeForm 上使用公共属性，然后在 resizeForm.ShowDialog() 返回时获取这些属性。

```
if (resizeForm.ShowDialog() == DialogResult.OK) // or whatever
{
   myVal = resizeForm.Val;
   ...
} 
```

或类似的东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-08T01:01:25.117

在“调整大小”类中为要检索的值设置属性。例如，如果您添加一个宽度属性：

```
public int Width { get; set; } 
```

您将能够从 Form1 类中获取宽度。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-08T01:01:56.003

向调整大小的表单添加属性，在关闭调整大小的表单后，您的主表单可以查询这些属性，例如...

```
DialogResult dr = resizeForm.ShowDialog();

if( dr != DialogResult.Cancel )
{
  var newH = resizeForm.Height;
  var newW = resizeForm.Width;

  // do something with new vals.
} 
```

# ruby-on-rails - 覆盖 Rails 中的属性并获取底层值

> ID：837789
> 
> 赞同：0
> 
> 时间：2009-05-08T00:59:51.843
> 
> 标签：ruby-on-rails, overriding, attributes, setter

对于我的生活，我无法弄清楚如何做到这一点。我有一个模型，它的存储值是文件系统上资源的路径。我希望模型从文件系统中写入和获取资源，所以我自然想覆盖 getter 和 setter 来执行此操作。然后我如何获得数据库中的基础价值？

```
class MyModel < ActiveRecord::Base
  require 'fileutils'
  def myThing=(val)
    handle = File.open(_____, 'w')
    handle.write(val)
  end
end 
```

下划线在哪里？我见过'write_attribute'曾经这样做过，但它似乎已被弃用。有任何想法吗？当然，吸气剂也是如此。

另外，如果我在覆盖方面说错了，我很想听听更好的技术。唯一不能选择的是将值直接存储在数据库中。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T01:06:21.033

这应该这样做：

```
handle = File.open(attributes["myThing"]) 
```

不过，我会考虑将列重命名为“my_thing_path”（或 myThingPath，如果必须的话）。

# wcf - BizTalk 2006 ESB - 是否有 WcfCustom 适配器？

> ID：837798
> 
> 赞同：0
> 
> 时间：2009-05-08T01:01:52.590
> 
> 标签：wcf, biztalk, esb

我们正在 BizTalk 2006 之上实施 Microsoft ESB 指南。我们在业务中的主要参与者之一是 SAP，它使用 BizTalk 的 WcfCustom 适配器开箱即用地提供服务。

是否有人对使用 ESBG 适配器连接到 SAP 以提交 iDocs 有任何建议或经验？

我是否需要编写自己的 ESB 适配器提供程序来实现 Wcf-Custom 行为，或者是否有开源替代方案？

干杯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T01:09:39.567

感谢 Bryan，我们最终选择了一个消息传递解决方案，该解决方案与我们最初的概念验证一起工作，但在 SAP 发送端口和 iDoc 消息格式之间留给我们 1:1 的关系，因为我们需要注入 iDoc发送端口中的特定 SOAP 标头。我会进一步调查。

# javascript - Javascript 中的关键代码检查不适用于 IE

> ID：837803
> 
> 赞同：1
> 
> 时间：2009-05-08T01:04:26.763
> 
> 标签：javascript, javascript-events

我厌倦了编写一个用javascript检查关键代码的函数。它适用于 Firefox，但不适用于 IE。有谁知道我的代码出了什么问题？请参阅下面的代码以获取更多详细信息。

```
function textCheck(e)
{
 var e = window.event || e
 alert("CharCode value: "+e.charCode)
 alert("Character: "+String.fromCharCode(e.charCode))
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T01:07:01.047

切换你的第一行代码：

...

```
var e = e || window.event; 
```

...

看看是否有帮助。

此外，如果它是 unicode 字符，请尝试以下操作：

```
function displayunicode(e) {
    var unicode=e.keyCode? e.keyCode : e.charCode
    alert(unicode)
} 
```

如果您正在处理`keydown`而不是`keypress`，那么事情会变得更加复杂......请参阅：[http ://unixpapa.com/js/key.html](http://unixpapa.com/js/key.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-02-13T19:50:10.263

keyCode 和 charCode 值在不同浏览器中的行为略有不同，并为各种事件返回不同的值。特别是旧版本的 IE 不支持 charCode。我的第一个建议是使用像 jQuery 这样的工具来处理跨浏览器的键值的规范化。使用 jQuery，您可以使用事件对象上的 e.which 属性来获取标准化值。

另一件事是使用关键代码检查器来比较每个浏览器的每个事件返回的值。我构建了一个方便的在线工具来执行此操作，并发现一目了然地显示每个事件的所有键码/字符码非常有用：

[http://www.west-wind.com/WestwindWebToolkit/samples/Ajax/html5andCss3/keycodechecker.aspx](http://www.west-wind.com/WestwindWebToolkit/samples/Ajax/html5andCss3/keycodechecker.aspx)

使试验不同的组合键并查看它们在不同浏览器上的比较变得非常容易。jQuery 的 which 和 keypress 往往是最一致的。

# sql - 有没有办法在 SSIS 的数据流中执行 T-SQL 代码？

> ID：837811
> 
> 赞同：3
> 
> 时间：2009-05-08T01:08:16.037
> 
> 标签：sql, tsql, ssis, business-intelligence

### 背景

我有一个维度表，每天都有一条记录。每条记录都有一个主键，因此示例数据为：

```
尺寸表
---------------

---------------------------------
| 身份证 | 日期时间 |
---------------------------------
| 1083 | 2008 年 4 月 10 日晚上 10:02:00 |
---------------------------------

```

我要做的是获取具有 SQL 日期时间值（例如`04/10/2008 10:02:00 PM`）的源数据列，并让 SSIS 从维度表中派生主键应该是什么（`1083`在上面的示例中）。我试图将其放入我的包中的数据流中，并避免使用临时表。

我想在我的数据流期间调用一个数据库函数，让我的 SSIS 包发现`timeid`记录`datetime`。我尝试过使用`DeriveColumn`，但这似乎不允许使用 T-SQL；而只是内置在 ANSI SQL 中的函数。

### 问题

在数据流中是否有另一种方法可以做到这一点？或者我是否需要使用临时表并使用`SQLTask`数据流外部来操作我的数据？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-08T01:38:47.820

如果我理解您，您有一个具有时间维度的数据集市，并且您需要获取与特定时间对应的 timeId。

如果这是正确的，那么您想使用查找组件。对于参考表使用类似的东西`SELECT timeId, timeStamp FROM TimeDimension`，然后查找包含时间戳的输入列。使用 timeId 作为输出列，现在数据流中的每一行都将具有与其时间戳对应的 timeId。

# c# - 在编辑模式下启动 DataForm

> ID：837813
> 
> 赞同：1
> 
> 时间：2009-05-08T01:08:55.053
> 
> 标签：c#, silverlight

DataFrom 可以很好地使用 AutoGenerateFields 并且没有样式，但是当我像这样向 DataFormTextField 的 EditingElementStyle 添加文本框样式时

```
Style x:Key="FieldTextBoxStyle" TargetType="TextBox">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="TextBox">
                <Grid x:Name="RootElement">
                              <Grid.Resources>
                                    <Storyboard x:Key="Normal State"/>
                                    <Storyboard x:Key="Focused State"/>
                                </Grid.Resources>
                                <ScrollViewer x:Name="ContentElement"  Background="Transparent" Padding="{TemplateBinding Padding}" Margin="1,1,1,1">

                                </ScrollViewer>

                </Grid>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

还有这个

```
DataForm dForm = new DataForm() { AutoGenerateFields = false, AutoEdit = true, AutoCommit = true, CommandButtonsVisibility = DataFormCommandButtonsVisibility.None, Foreground = new SolidColorBrush(Colors.Black), Header = "Basic Infomation" };

dForm.Fields.Add(new DataFormTextField() { FieldLabelContent = "Company Name", Binding = new Binding("Name"), EditingElementStyle = Resources["FieldTextBoxStyle"] as Style }); 
```

我希望表单以编辑模式启动，而无需单击按钮。但是由于 Name 是必需的

```
[Required] 
```

公共字符串名称；

Binding 会触发错误，因为 Name 默认为空...我的样式是否错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-26T06:07:56.850

后来我发现了我的错误，它对我有用，修复它你的类应该继承实体类......

```
 public class FixError : System.Windows.Ria.Data.Entity
{
    private string _Name;

    [Required]
    public string Name
    {
        get
        {
            return this._Name;
        }
        set
        {
            if ((this._Name != value))
            {
                this.ValidateProperty("Name", value);
                this.RaiseDataMemberChanging("Name");
                this._Name = value;
                this.RaiseDataMemberChanged("Name");
            }
        }
    }
} 
```

那样的东西...

# search - Drupal hook_search 函数位置

> ID：837816
> 
> 赞同：0
> 
> 时间：2009-05-08T01:10:35.437
> 
> 标签：search, drupal, function, hook

我一生都无法弄清楚 drupal 中的 hook_search 函数的位置。我需要添加到文件中才能访问吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T01:42:38.327

钩子函数不按名称存在——它们表示可以遵循的命名约定来响应那个特定的“钩子”......

一个例子是[node_search()](http://api.drupal.org/api/function/node_search)函数。当搜索模块调用 module_invoke_all('search') 时，将调用所有名为*foo* _search() 的函数，其中*foo*是启用的模块的名称。可以在[api.drupal.org](http://api.drupal.org/api/function/hook_search/6)上找到搜索钩子的详细信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-11-11T08:27:07.073

```
function hook_search($op = 'search', $keys = null) {
  switch ($op) {
    case 'name':
      return t('content');
    case 'reset':
      variable_del('node_cron_last');
      return;
    case 'search':
      $find = do_search($keys, 'node', 'INNER JOIN {node} n ON n.nid = i.sid '. node_access_join_sql() .' INNER JOIN {users} u ON n.uid = u.uid', 'n.status = 1 AND '. node_access_where_sql());
      $results = array();
      foreach ($find as $item) {
        $node = node_load(array('nid' => $item));
        $extra = node_invoke_nodeapi($node, 'search result');
        $results[] = array('link' => url('node/'. $item),
                           'type' => node_invoke($node, 'node_name'),
                           'title' => $node->title,
                           'user' => theme('username', $node),
                           'date' => $node->changed,
                           'extra' => $extra,
                           'snippet' => search_excerpt($keys, check_output($node->body, $node->format)));
      }
      return $results;
  }
} 
```

# c# - 目录服务组查询随机变化

> ID：837824
> 
> 赞同：1
> 
> 时间：2009-05-08T01:15:18.797
> 
> 标签：c#, .net, active-directory, directoryservices

我在我的 asp.net 应用程序中收到异常行为。我有代码使用目录服务来查找给定的经过身份验证的用户的 AD 组。代码类似于...

```
string username = "user";
string domain = "LDAP://DC=domain,DC=com";
DirectorySearcher search = new DirectorySearcher(domain);
search.Filter = "(SAMAccountName=" + username + ")"; 
```

然后我查询并获取给定用户的组列表。问题是代码接收组列表作为字符串列表。随着我们最新版本的软件，我们开始以字节[] 的形式接收组列表。

系统将返回字符串，突然返回 byte[]，然后重新启动它再次返回字符串。

有人有想法么？

(marc_s) 添加了代码示例：

```
DirectoryEntry dirEntry = new DirectoryEntry("LDAP://" + ldapSearchBase); 
DirectorySearcher userSearcher = new DirectorySearcher(dirEntry) 
  { SearchScope = SearchScope.Subtree, 
    CacheResults = false, 
    Filter = ("(" + txtLdapSearchNameFilter.Text + "=" + userName + ")")
  }; 

userResult = userSearcher.FindOne(); 
ResultPropertyValueCollection valCol = userResult.Properties["memberOf"]; 

foreach (object val in valCol) 
{ 
    if (val is string) 
    {
        distName = val.ToString();
    } 
    else 
    { 
        distName = enc.GetString((Byte[])val); 
    }
} 
```

# vbscript - 如何在 Powerdesigner 中使用 VBScript？

> ID：837825
> 
> 赞同：3
> 
> 时间：2009-05-08T01:16:16.080
> 
> 标签：vbscript, sybase, powerbuilder

在 Powerdesign 中想创建一个 VBscript 来重命名/修改 powerdesigner 中的以下名称-概念或物理模型

**替代/唯一键名：**

> > *UQ {table_name} {tablecolumnname}* /////// **示例**= UQ_Account_AccountNumber

**关系名称：**

> > *FK_{table_name}_{reference_table_name}_{reference_column_name}* //////**示例**= FK_Account_AccountPhone_HomePhoneID

问题是，**如何获得“table_column_name”和“reference_column_name”？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T02:12:06.913

这是我用来重命名“友好”名称的东西，以及我所有引用的约束名称。也许它会帮助你。

```
Option Explicit
ValidationMode  = True
InteractiveMode = im_Batch

Dim mdl 
Set mdl = ActiveModel
If (mdl Is Nothing) Then
   MsgBox "There is no current Model"
ElseIf Not mdl.IsKindOf(PdPDM.cls_Model) Then
   MsgBox "The current model is not a Physical Data model."
Else
   ProcessFolder mdl
End If

Private sub ProcessFolder(folder)
   Dim Tab, Key, Rel
   for each Rel in Folder.References
      Rel.ForeignKeyConstraintName = "FK_" + UCASE(Rel.ParentTable.Name) + "_" + UCASE(Rel.ParentKeyColumnList) + "_" + UCASE(Rel.ChildTable.Name) + "_" + UCASE(Rel.ForeignKeyColumnList)
      Rel.Name = "FK_" + UCASE(Rel.ParentTable.Name) + "_" + UCASE(Rel.ParentKeyColumnList) + "_" + UCASE(Rel.ChildTable.Name) + "_" + UCASE(Rel.ForeignKeyColumnList)
   next
end sub 
```

# python - 如何在 Django 中创建 slug？

> ID：837828
> 
> 赞同：240
> 
> 时间：2009-05-08T01:17:11.053
> 
> 标签：python, django, django-models, slug

我正在尝试`SlugField`在 Django 中创建一个。

我创建了这个简单的模型：

```
from django.db import models

class Test(models.Model):
    q = models.CharField(max_length=30)
    s = models.SlugField() 
```

然后我这样做：

```
>>> from mysite.books.models import Test
>>> t=Test(q="aa a a a", s="b b b b")
>>> t.s
'b b b b'
>>> t.save()
>>> t.s
'b b b b' 
```

我期待着`b-b-b-b`。

* * *

## 回答 #1

> 赞同：446
> 
> 时间：2009-05-08T01:22:34.240

您将需要使用[slugify](https://docs.djangoproject.com/en/3.1/ref/utils/#django.utils.text.slugify)功能。

```
>>> from django.template.defaultfilters import slugify
>>> slugify("b b b b")
u'b-b-b-b'
>>> 
```

您可以`slugify`通过覆盖`save`方法自动调用：

```
class Test(models.Model):
    q = models.CharField(max_length=30)
    s = models.SlugField()

    def save(self, *args, **kwargs):
        self.s = slugify(self.q)
        super(Test, self).save(*args, **kwargs) 
```

`q`请注意，在编辑字段时，上述内容会导致您的 URL 发生变化，从而[导致链接断开](http://www.w3.org/Provider/Style/URI.html)。当您创建一个新对象时，最好只生成一次 slug：

```
class Test(models.Model):
    q = models.CharField(max_length=30)
    s = models.SlugField()

    def save(self, *args, **kwargs):
        if not self.id:
            # Newly created object, so set slug
            self.s = slugify(self.q)

        super(Test, self).save(*args, **kwargs) 
```

* * *

## 回答 #2

> 赞同：113
> 
> 时间：2012-08-31T09:05:21.163

有一些 utf-8 字符的特殊情况

例子：

```
>>> from django.template.defaultfilters import slugify
>>> slugify(u"test ąęśćółń")
u'test-aescon' # there is no "l" 
```

这可以通过[Unidecode解决](http://pypi.python.org/pypi/Unidecode/0.04.9)

```
>>> from unidecode import unidecode
>>> from django.template.defaultfilters import slugify
>>> slugify(unidecode(u"test ąęśćółń"))
u'test-aescoln' 
```

* * *

## 回答 #3

> 赞同：68
> 
> 时间：2009-09-26T04:36:35.140

对 Thepeer 答案的一个小修正：要覆盖`save()`模型类中的函数，最好为其添加参数：

```
from django.utils.text import slugify

def save(self, *args, **kwargs):
    if not self.id:
        self.s = slugify(self.q)

    super(test, self).save(*args, **kwargs) 
```

否则，`test.objects.create(q="blah blah blah")`将导致`force_insert`错误（意外参数）。

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2009-05-09T07:26:29.480

`ModelAdmin`如果您正在使用管理界面添加模型的新项目，您可以在您的模型中设置一个`admin.py`并使用[`prepopulated_fields`](https://docs.djangoproject.com/en/dev/ref/contrib/admin/#django.contrib.admin.ModelAdmin.prepopulated_fields)它来自动输入一个 slug：

```
class ClientAdmin(admin.ModelAdmin):
    prepopulated_fields = {'slug': ('name',)}

admin.site.register(Client, ClientAdmin) 
```

在这里，当用户在管理表单中为该`name`字段输入一个值时，`slug`将自动填充正确的 slugified `name`。

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2009-05-09T10:10:12.487

在大多数情况下，slug 不应该改变，所以你真的只想在第一次保存时计算它：

```
class Test(models.Model):
    q = models.CharField(max_length=30)
    s = models.SlugField(editable=False) # hide from admin

    def save(self):
        if not self.id:
            self.s = slugify(self.q)

        super(Test, self).save() 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2010-12-14T15:26:49.690

如果您不想将 slugfield 设置为不可编辑，那么我相信您需要将 Null 和 Blank 属性设置为 False。否则，当您尝试在 Admin 中保存时会出现错误。

因此，对上述示例的修改将是：

```
class test(models.Model):
    q = models.CharField(max_length=30)
    s = models.SlugField(null=True, blank=True) # Allow blank submission in admin.

    def save(self):
        if not self.id:
            self.s = slugify(self.q)

        super(test, self).save() 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2011-02-04T08:14:47.780

[`prepopulated_fields`](https://docs.djangoproject.com/en/stable/ref/contrib/admin/#django.contrib.admin.ModelAdmin.prepopulated_fields)在您的管理类中使用：

```
class ArticleAdmin(admin.ModelAdmin):
    prepopulated_fields = {"slug": ("title",)}

admin.site.register(Article, ArticleAdmin) 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2015-02-15T13:58:37.550

我正在使用 Django 1.7

在您的模型中创建一个 SlugField，如下所示：

```
slug = models.SlugField() 
```

然后在`admin.py`定义`prepopulated_fields`;

```
class ArticleAdmin(admin.ModelAdmin):
    prepopulated_fields = {"slug": ("title",)} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-08-14T07:05:12.247

您可以查看[文档，`SlugField`](https://docs.djangoproject.com/en/2.1/ref/models/fields/#slugfield)以便以更具描述性的方式了解更多信息。

# asp.net-mvc - MVC 与 WebForms

> ID：837831
> 
> 赞同：13
> 
> 时间：2009-05-08T01:18:21.580
> 
> 标签：asp.net-mvc, webforms

在我看来，似乎有很多事情正在发生，每个人都加入了 MVC 的潮流。几乎每个人都在毫无说服力地宣称 WebForms 是邪恶的和撒旦的。然后他们继续说控件是邪恶的，它们不应该出现在 Web 应用程序中。您将如何在没有任何控件的情况下显示任何内容？

我记得当 WebForms 第一次问世时，每个人都喜欢它们。我想几年后，人们会继续关注下一件事并宣布 MVC 是邪恶的，因为您必须实际创建控件才能使用 MVC，他们会说您必须开发应用程序而不用担心控件。

我看到 MVC 的方式可以在 WebForms 中通过不在 Form 标签中包含 RunAt 来实现。然后，如果您想检索数据，只需使用 Ajax。

有人可以说服我为什么我应该使用 MVC 而不是 WebForms 吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-08T01:30:30.197

您不应该随意决定其中一个；不要仅仅因为 MVC 框架是新来的，而且每个人都在赞美它，特别是如果你对使用 Web 窗体做事感到满意，就不要对 MVC 框架感到满意。实际上，每个现有系统都将使用更老、更成熟的技术，这并没有错。

虽然 MVC 框架确实允许更轻松地分离关注点（毕竟，这就是 MVC 模式的用途），但它也带来了编写更多 HTML 的责任，我认为对如何更好地理解网络作品；不一定是不合理的要求，但您可能会争辩说，在您开始使用它的最初几次时，它会稍微减慢您的速度。

老实说，我同意 Web Forms 有很多不应有的缺陷。诚然，在后台发生了很多魔法，您对某些 HTML 输出的控制较少，但使用 CSS 设置样式并非完全不可能（您最终`!important`可能会使用很多），而且也并非不可能得到一些关注点分离，即使它不符合纯粹主义者的观点。您仍然可以使用 MVC 框架编写非常糟糕的代码。如果您希望快速组合一些东西，并且您擅长 Web 表单，那么您将能够非常快速地实现这一目标，这没什么好羞耻的，不是吗？

当然，这并不是说您也应该坚持自己的立场并忽略 MVC。它是一个很好的框架（事实上，它是一个*非常*好的框架），它确实提供了一些你可能希望从长远来看利用的好处。您还必须记住，它也不会自动取消您学到的关于 ASP.NET 2.0 的所有内容。许多支持架构都包含在 MVC 框架中，包括成员资格提供程序之类的东西。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-08T01:42:35.330

在**网络表单**中：

> Viewstate 和 Postbacks 都带来了很多问题，并增加了 Web 应用程序开发的复杂性。许多网页具有数百 KB 大小的 Viewstate，有时会影响应用程序的性能。
> 
> 开发人员无法控制 Web 表单的呈现 HTML，以及呈现具有混合内联样式和不符合标准的弃用标签的 html 的服务器控件。
> 
> Web 窗体的页面生命周期过于复杂，并且在 ASP.net 框架中的所有事物之间紧密耦合，并且使用单个类来显示输出和处理用户输入。
> 
> 单元测试几乎是一项不可能完成的任务。今天，单元测试在现代软件开发中非常重要，尤其是当我们遵循敏捷方法和实践时。由于 web 是一个无状态的东西，Events、Postbacks 和 Viewstate 不是一个好方法。

使用**asp.net MVC**，所有这些事情都被**简化了**

如果这些事情不适用于您并且您喜欢使用 Webforms，那么请坚持您最擅长的事情。*不要试图修复没有损坏的东西。*

更详细的参考：[石菊的 ASP.net MVC Vs ASP.net Web Form 的博客](http://weblogs.asp.net/shijuvarghese/archive/2008/07/09/asp-net-mvc-vs-asp-net-web-form.aspx)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-08T02:22:09.027

我认为 MVC 的主要优点是：

*   更清洁和更简单的架构。无需再猜测您可以处理哪个事件来正确连接您的数据。不再需要插入一个钩子来“修复”数据绑定问题，因为框架并不能完全按照您的意愿行事。
*   该框架并不能满足您的需求。
*   解耦架构使更多代码更容易测试。
*   与网络架构更紧密地结合在一起。对于来自 WebForms 背景的人来说，这似乎不是一个优势，除非您接受它并为它设计而不是尝试在 MVC 中编写类似 WebForms 的应用程序。幸运的是，在使用 ASP.NET MVC 之前，我已经对 Ruby on Rails 进行了一些探索，并且已经开始以更 RESTful 的方式编写我的 WebForms 应用程序。
*   历史/无处不在——尽管微软刚刚推出它，但 MVC 是一种众所周知且备受推崇的模式。它被广泛用于许多框架中的许多 Web 应用程序。如果您需要切换到他们也在做 MVC 的不同技术——比如 RoR 或 Java/Struts，学习 MVC 将为您提供帮助。

缺点：

*   微软的实施是新的，并不成熟。
*   很少有第三方“控件”/插件可供往返使用——通用网格等，尽管客户端通过 jQuery 有很多插件。
*   需要从 WebForms 中学习一些范式才能有效地使用它。
*   该框架不会为您做太多繁重的工作。你必须学习一些 Javascript 并编写更多的客户端代码，因为框架不会为你注入它。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-22T18:45:53.120

WebForms 是一个很棒的框架，但它确实需要您深入了解它。是的，您仍然应该是 HTML 和 JavaScript 方面的专家。我所听到的关于 WebForms 的每一个抱怨都来自那些没有花时间去理解 WebForms 的人。以下是我对其中一些的回答。

**ViewState 是邪恶的，会减慢页面速度**

这让我想起了那些把所有东西都变成全局变量的程序员。你当然可以这样做，但你不应该！WebForms 和 ViewState 也是如此。除非需要，否则不要使用 ViewState，而且要谨慎使用。将 1000 个字符的视图状态添加到 html 并没有错，如果它会带来更好的用户体验和/或加快开发时间。您可以在 MVC 中通过使用数百个隐藏的输入控件乱扔页面来遇到相同的问题，是的，我已经看到了。顺便说一句，ViewState 并不“神奇”，它只是将一些数据存储在单个输入控件中，并对其进行加密以进行良好的测量。

**WebForms 生成“丑陋”的 html 并且到处都是长 id**

好吧，首先，实际上没有人会查看生成的 hmtl（例如，您是否查看了 google.com，这是一团糟？！）。其次，如果您真的关心生成特定的 html，只需不到一个小时就可以使用您选择的 html 创建自己的可重用组件或控件。或者，您可以采用现有控制，覆盖渲染并改用该控制。再一次，你必须知道去哪里以及如何去做，但是一旦你知道了，这将是一个巨大的生产力提升，没有任何牺牲。自动生成长 ID 以确保整个页面的唯一性。如果您有机会开发复杂的 MVC 视图，您会注意到您将发明自己的长 id 模式，以便在发布时正确解析表单字段。

**WebForms 不允许每页有多个表单**

我已经开发了 10 年，只有一次我需要多种形式。然后我发现我没有。您确实必须了解 HTTP 请求和响应以及如何使用 WebForms 来实现它们，但如果您这样做了，您将永远不需要多个表单，也根本不会考虑“表单”。

**WebForms 页面不可测试**

绝对不是真的。即使您不喜欢 MVP（我不喜欢），也有其他技术可以测试您想要测试的任何内容。确实，如果您只是按原样使用 WebForms 中的页面并将所有逻辑隐藏在代码中，那么它可能无法测试，也不是一个好主意。但是，就像在 MVC 或 Windows 窗体应用程序中一样，您可以而且应该至少对于复杂的视图创建中间层，例如视图和控制器。我更喜欢将功能封装到实现接口或继承基类的用户控件中。然后用户控件所在的页面就像一个“主控制器”。在这种情况下，可以测试单个视图或用户控件，因为它们都实现了接口或基类。

**JavaScript 在 WebForms 中很难实现**

JavaScript 实际上在 WebForms 中比在 MVC 中更容易实现。你肯定有更多选择！但是再一次，您必须非常了解 WebForms 才能实现这一点。在 WebForms 中，您可以“注入”带有可重用组件和控件的 javacript。或者，您可以在更改页面上的设置以保持 ASP 实现 id 命名方案后，像在 MVC 或纯 HTML 中一样使用它。

说了这么多，WebForms 有什么 MVC 没有的？在我看来，表示组件的封装和可重用性是迄今为止最大的。对于复杂的视图，我开发单独的组件（服务器或用户控件），然后自定义控制器或表示工厂将它们全部编织到位。此外，WebForms 中的设计时 html 比 MVC 中的要干净得多，这使得经过适当培训的图形设计师更容易进行设计和样式设计。它更干净，因为在设计时 html 中没有编程代码，只有标记（我不使用数据绑定表达式）。当然，在 WebForms 中进行原型设计要容易得多。对于原型，我通常会忽略所有最佳实践，而求助于直接访问数据库的向导和丑陋的代码隐藏代码。

我可以继续说下去，但我想说的主要一点是，WebForms 和 MVC 是非常不同的模式，需要不同的知识和思维方式来提供出色的解决方案。两者都需要尽可能多的 Web/HTTP/CSS 知识。如果我必须对高流量的公共网站（例如博客）提出一项建议，但并非总是如此，我可能会倾向于 MVC。对于复杂的 Web 应用程序，无论是内部/Intranet 还是会员外部/Internet 应用程序，我都会倾向于 WebForms。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-08T01:24:46.200

WebForms 工作正常，如果您喜欢它们，请继续使用它们。

在我看来，MVC 模型的三大优势是：

ViewState 消失了，这可能会在网络上产生相当大的流量。URL 可以重新映射为现在风靡一时的含义。脚手架。我不知道，我个人认为这是撒旦并鼓励糟糕的编程习惯，但其他人似乎认为这是一个美丽的想法。

它还通过强制执行模型-视图-控制器模式来鼓励业务逻辑和表示之间的适当分离，但是好的 WebForm 代码也可以做到这一点。

所以，真的，如果你对 WebForms 的开销感到满意，并且对丑陋的 URL 没问题并且不想要脚手架，那么坚持使用 WebForms。

编辑：哦，我确实错过了“干净”网址的一个主要优势。MVC 应用程序对 SEO 更友好。它还使您可以很好地控制 HTML，但坦率地说，我不认为这是向前迈出的一大步。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-08T04:38:21.367

我认为部分问题在于许多人没有意识到 MVC 不是 M$ 发明，也不是 Web 表单的替代品。当然，人们喜欢“新”事物，人们喜欢到处乱说流行语，尤其是为了改善他们的简历……

最后，.NET 开发人员有了一些选择，并且有了这个选择，他们就被赋予了对他们做出的决定一定程度的责任。许多网络表单开发人员对这一责任感到紧张，我并不感到惊讶。它以前不在那里。最终，它可以让你成为一个更好的开发者，或者一个更差的开发者。现在由你决定。

人们喜欢网络表单，因为它比 ASP（经典）更好。是的，在 5 到 10 年内，我确信比我聪明得多的某个人/团体将发展出一种新的范式/模式。
小心羊标签，在某种程度上，通过坚持供应商特定的模式（网络表单），你可能是一只更大的“羊”。
MVC 现在跨各种平台，这意味着您开发有意义且稳定的问题解决方案的潜力可以大大增加。或减少。这最终取决于你。如果你还没有准备好，那就等待 ASP.NET MVC 成熟。但是不要对任何事情闭上思绪，尤其是已经非常成熟的模式！

我推荐阅读 Rob Connery[极具煽动性的博客](http://blog.wekeroad.com/blog/i-spose-ill-just-say-it-you-should-learn-mvc/)。他肯定用手指拨弄着我的疼痛！然后去阅读 RoR 的东西、Cake 和 Struts。所有这些都将开始向您展示将 MVC 引入 .NET 的人的愿景（~ish），并希望能激发您以不同的方式看待问题！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-08-10T14:10:27.420

这里有几个更详细的答案，所以我不会重复他们所说的任何内容，我会尽量让我的答案更简洁。你不应该，一定要使用 MVC 而不是 webforms，就像你不应该使用 webforms 而不是 MVC - 它们都是工具，或多或少地适用于不同的情况。几年前，我在 J2EE 上第一次接触到 MVC，当时 .NET 刚刚问世（我不确定当时 ASP.NET MVC 是否可用）。它提供了一个非常好的、干净的框架并提供了更多的“web”应用程序（即请求/响应），但您也可以使用 AJAX 添加更多客户端功能 - 我在 php 上使用 AJAX 做了一些非常时髦的事情我前段时间写的应用程序，在 MVC 下都可以使用。

有些事情 MVC 做得更好，有些事情 Web 表单做得更好，但如果你不了解这两种技术，你就无法为你正在做的当前项目选择最好的技术，所以请不要伤害自己- 去学习 MVC。即使您从不直接使用它，它仍然可以为您提供有用的“理论”知识，您可以将其应用于其他工具。我尝试尽可能多地学习不同的东西，因为我的弓弦越多，我无法解决问题的可能性就越小（例如，在那个 php 应用程序中，我使用了 php，连接到一点 ASP，甚至让 DOS 和 *NIX 批处理/脚本文件执行某些功能——每个工具都有它的位置，最适合分配给它的工作）。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-05-08T01:31:21.097

不是我。MVC 在简历中非常酷，但对于我们的客户（那些为我们的工作付费的人）来说，它并不是一个展示者。

他们通常需要正确、快速和安全的应用程序。就这样。他们不会想在三年内改变第三层的客户端部分！三年后，他们将改变一切，或根本不改变。

层对于架构和编码来说很有趣，但它们的创建和维护成本很高，而且它们与我们的客户无关。MVC 非常酷，但确实没用且昂贵。

当然，除非您正在为 4 个操作系统和 3 个平台开发应用程序……但是您将成为少数。

:o)

* * *

## 回答 #9

> 赞同：-11
> 
> 时间：2009-05-08T05:46:04.183

这是一个愚蠢的讨论——它们是*不同*的，ASP.NET MVC 和 WebForms 是不同的技术！我在所有新项目中都使用 MVC，但是当我需要 RAD 时，我使用 WinForms，因为它很简单，并且已经有很多大师编写的控件。

别讨论这个了。谁想了解差异？只需尝试这两种技术，您就会自己理解。

# c# - .NET 的新星

> ID：837832
> 
> 赞同：1
> 
> 时间：2009-05-08T01:20:28.190
> 
> 标签：c#, astronomy

有天文学家吗？我想知道是否有人制作或偶然发现了[美国海军 Observatoru Vector Astrometry Subroutines (NOVAS)](http://aa.usno.navy.mil/software/novas/novas_info.php)的 .NET（最好是 C#）实现。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T01:30:15.827

我对天文学一无所知，对 NOVAS 也一无所知，所以请持保留态度。

但是，我确实看过网站，看起来他们有一个 C 实现。您总是可以采用 C 实现，通过 pinvoke 访问它，然后围绕它编写一个 C# 包装器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T18:55:21.050

您是否只对该库的一个端口或任何可从 C# 用于天文学的东西感兴趣？

第一部分我没有任何东西，但第二部分我会看看 AGI 的[Components](http://www.agi.com/products/components/)。他们的库提供了计算各种天文数据的方法。[动态几何库](http://www.agi.com/products/components/main.cfm?tab=overview)让您可以轻松地对包括行星在内的所有事物进行建模。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-06-09T03:34:19.373

此下载包含一个非常有用的 C# 天文库。抱歉，我不记得我在哪里得到它，但也许它记录在某个地方。 [http://www.planet-source-code.com/vb/scripts/ShowCode.asp?txtCodeId=8399&lngWId=10](http://www.planet-source-code.com/vb/scripts/ShowCode.asp?txtCodeId=8399&lngWId=10)

旁注：NOVAS 库不是很完整。您最好从国际天文学联合会追求 SOFA 库。这是链接： [http ://www.iasofa.org/](http://www.iausofa.org/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-09-20T17:07:12.623

Urania 是 C# 中的天文学库：
[http ://www.smokycogs.com/blog/tutorials/astronomical-calculations-in-c-sharp/](http://www.smokycogs.com/blog/tutorials/astronomical-calculations-in-c-sharp/)

下载是页面上不明显的“此处”链接，它将所有示例代码组合到一个名为 Urania 的应用程序中。

下载后，您还需要修改 Urania.sln 文件以修复他使用的不同库（MathLib、UraniaLib 等）的路径，然后它将正确编译。
（在记事本中打开 Urania.sld 并从 3 个项目路径中删除：“..\Libs\”）

# .net - 如何从 .NET 中的 .eps 和 .ai 文件生成缩略图？

> ID：837834
> 
> 赞同：0
> 
> 时间：2009-05-08T01:22:21.773
> 
> 标签：.net, image, thumbnails, eps

一位潜在客户问我是否可以从 .eps 和 .ai 文件生成缩略图。标准的 .NET Image 类不能做到这一点，所以我想我需要一个 3rd 方 API，但我不确定什么是最好的方法。有任何想法吗？

罗杰

[图库服务器专业版](http://www.galleryserverpro.com)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-08T07:54:40.833

您想要一些扩展[GDI+](http://msdn.microsoft.com/en-us/library/ms533798(VS.85).aspx)或[WIC](http://msdn.microsoft.com/en-us/library/ms737408.aspx)（[及其可能](https://stackoverflow.com/questions/455018/extending-the-list-of-supported-image-formats-in-gdi)）的第 3 方，这样您就不会被绑定到第 3 方 API。

# c# - 此代码如何引发 NullReferenceException？

> ID：837843
> 
> 赞同：4
> 
> 时间：2009-05-08T01:26:17.677
> 
> 标签：c#, nunit

我一定是疯了，因为我的单元测试失败了，因为下面的代码抛出了一个空引用异常：

```
int pid = 0;
if (parentCategory != null)
{
    Console.WriteLine(parentCategory.Id);
    pid = parentCategory.Id;
} 
```

抛出它的行是：

```
pid = parentCategory.Id; 
```

console.writeline 只是在 NUnit GUI 中调试，但输出一个有效的 int。

*编辑：*它是单线程的，因此不能从其他线程分配给 null ，并且 Console.WriteLine 成功打印出该值的事实表明它不应该抛出。

*编辑：*类别类的相关片段：

```
public class Category
{
    private readonly int id;

    public Category(Category parent, int id)
    {
        Parent = parent;
        parent.PerformIfNotNull(() => parent.subcategories.AddIfNew(this));
        Name = string.Empty;
        this.id = id;
    }
    public int Id
    {
        get { return id; }
    }
} 
```

好吧，如果有人想查看完整的代码，请访问[http://code.google.com/p/chefbook/source/checkout的 Google 代码](http://code.google.com/p/chefbook/source/checkout)

我想我会尝试重新启动计算机...我已经看到通过重新启动修复的非常奇怪的事情。重启后会更新。

*更新：*谜团解开了。看起来 NUnit 将错误行显示为最后一个成功执行的语句...将测试复制/粘贴到新的控制台应用程序并在 VS 中运行表明它是包含空引用的 if 语句块（未显示）之后的行。感谢大家的所有想法。对所有回答的人 +1。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-08T01:49:22.070

根据到目前为止的所有信息，我认为“抛出的线”是错误的（是什么让你这么认为），或者你的“来源”可能与你构建的程序集不同步。

这看起来是不可能的，所以一些“理所当然的假设”是错误的，并且可能是“您正在查看的源代码与您正在调试的过程相匹配”的假设。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-08T01:57:21.520

当事情表面上看起来正确时，您可能会忽略它。您是否 350% 肯定您的 DLL/PDB 与您的源代码匹配，从而为您提供正确的线路？

*   尝试手动删除您的程序集并运行您正在运行的任何程序。它会失败吗？
*   尝试清理您的解决方案并重新编译。将程序集复制到任何地方并再次运行。这次有用吗？空参考在同一个地方？
*   调试周围的行以获得您期望的值。parentCategory 等应该符合您的想法。
*   通过抛出异常修改代码。堆栈跟踪行是否与代码中的行完全匹配？

就像这样，我有过一些非常令人难以置信的经历，因为我的一个假设是错误的。典型的是陈旧的程序集。质疑所有假设。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-08T01:38:22.487

但是，没有意义的是 OP 声明 console.writeline 输出一个有效的 int 并且它调用与他声明错误被抛出的行相同的属性。

堆栈跟踪会很有帮助，或者能够查看实际的单元测试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-08T01:36:34.597

是的，我们可以看到类别类的代码.. 特别是 Id 属性吗？假设 Id 属性是一个 int（而不是一个可为空的 int），get 方法必须访问一个 NULL 对象。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-08T01:41:57.233

Id 可能是一个可以为空的 int 类型（int？），没有值，但是我觉得属性 Id 必须做的不仅仅是返回一个 int，而且里面的东西是空的。

**编辑**您的编辑表明这不仅仅是奇特的，您能给我们提供一个堆栈跟踪吗？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-08T01:53:41.340

我不是 C# 方面的专家，我不确定它是否会有所不同，但您是在调试模式还是发布模式下进行调试？如果您处于发布模式，那么您的 IDE 指向的行和问题实际所在的行可能会有所不同（我知道使用 Visual Studio 时在 C++ 中就是这种情况）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-08T01:56:08.310

我不得不同意布赖恩的观点……也许您使用的是过时的 .pdbs 并且您在调试模式下看到的代码与实际调试的代码不符。

尝试清理项目，并在调试模式下重建它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-08T02:17:25.090

看起来 NUnit 将错误行显示为最后一个成功执行的语句...将测试复制/粘贴到新的控制台应用程序并在 VS 中运行表明它是包含空引用的 if 语句块（未显示）之后的行。感谢大家的所有想法。对所有回答的人 +1。

# ruby-on-rails - 使用集群最佳策略进行扩展

> ID：837847
> 
> 赞同：2
> 
> 时间：2009-05-08T01:28:22.743
> 
> 标签：ruby-on-rails, database, scalability, cluster-computing

我正在考虑使用服务器集群进行扩展的最佳策略。我知道没有硬性规定，但我很好奇人们对这些场景的看法：

1.  使用 dnsmadeeasy 进行循环（带故障转移）平衡的组合应用程序/数据库服务器集群。数据库使用复制同步。优点是可以通过向集群添加另一台服务器来轻松增加容量，并且它自然是故障安全的。

2.  应用服务器集群，再次使用 dnsmadeeasy 循环负载平衡（带故障转移），所有都向后面的大型数据库服务器报告。易于添加应用服务器，但单个数据库服务器会创建单个故障点。可以通过复制添加热备用。

3.  使用两个数据库的应用服务器集群（如上），一个只处理读取，一个只处理写入。

另外，如果您有其他想法，请提出建议。数据大多是非规范化和非关系型的，数据库是 50/50 读写。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T07:33:00.200

Take 2 physical machines and make them [Xen](http://www.xen.org/ "Xen") servers

*   A. Xen Base alpha
*   B. Xen Base beta

In each one do three virtual machines:

1.  "web" server for statics(css,jpg,js...) + load balanced proxy for dynamic request (apache+mod-proxy-balancer,nginx+fair)
2.  "app" server (mongrel,thin,passenger) for dynamic requests
3.  "db" server (mySQL, PostgreSQL...)

Then your distribution of functions can be like this:

*   A1 owns your public ip and handle requests to A2 and B2
*   B1 pings A1 and takes over if ping fails
*   A2 and B2 take dynamic request querying A3 for data
*   A3 is your dedicated data server
*   B3 backups A3 second to second and offer readonly access to make copies, backups etc. B3 pings A3 and become master if A3 becomes unreachable

Hope this can help you some way, or at least give you some ideas.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T15:27:31.157

这实际上取决于您的应用程序。

我花了一些时间为我的公司使用各种技术，我们（目前）确定的是在所有指向单个主数据库的 Web 服务器集群前运行反向代理/负载均衡器。理想情况下，我们想要一个解决方案，在主/从配置中设置数据库，如果有任何问题，我们可以将从属提升为主。所以选项2，但有一个从数据库。同样对于高可用性，两个作为 DNS 循环的反向代理会很好。我建议使用具有“公平”算法的负载均衡器，而不是简单的循环；您将获得更好的吞吐量。甚至有一些解决方案可以对您的数据库进行负载平衡，但这些解决方案可能会有些复杂，我会避免使用它们，直到您需要它为止。

Rightscale 在这里有一些关于这类东西的很好的文档：[http](http://wiki.rightscale.com/) ://wiki.rightscale.com/ 他们为云托管解决方案提供这些类型的服务。

我认为这两个带有图片的条目特别有用，可以为您提供很好的视觉表现。

“简单”设置：
[http ://wiki.rightscale.com/1._Tutorials/02-AWS/02-Website_Edition/2._Deployment_Setup](http://wiki.rightscale.com/1._Tutorials/02-AWS/02-Website_Edition/2._Deployment_Setup)

“高级”设置：
[http ://wiki.rightscale.com/1._Tutorials/02-AWS/02-Website_Edition/How_do_I_set_up_Autoscaling%3f](http://wiki.rightscale.com/1._Tutorials/02-AWS/02-Website_Edition/How_do_I_set_up_Autoscaling%3f)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T16:07:12.390

我只会在数据库方面发表评论：

对于普通的 RDBMS，数据库的 50/50 读/写负载将使复制在开销方面“昂贵”。对于几乎所有情况，拥有一个简单的故障转移解决方案都比实施复制的主动/主动数据库设置成本更低。在管理/维护和许可成本（如果适用）方面。

由于您的数据“大部分是非规范化且非关系的”，您可以查看[HBase](http://hadoop.apache.org/hbase/ "HBase")，它是[Google Bigtable](http://research.google.com/archive/bigtable.html "谷歌大表")的 OSS 实现，一个基于列的键/值数据库系统。HBase 再次建立在 Hadoop 之上，[Hadoop](http://hadoop.apache.org/core/ "Hadoop")是[Google GFS](http://labs.google.com/papers/gfs.html "谷歌 GFS")的 OSS 实现。

使用哪种解决方案取决于您预期的容量增长，其中 Hadoop 旨在扩展到潜在的 1000 个节点，但也应该在更少的节点上运行。

我管理过主动/主动复制数据库、单写/多读数据库和简单的故障转移集群。超越简单的故障转移集群会打开一个新的潜在问题维度，您在故障转移设置中永远不会看到。

如果您要使用传统的 SQL RDBMS，我建议您使用具有大量内存的相对“大铁”服务器，并将其作为故障转移集群。如果您的写入比率缩小，您可以使用故障转移写入集群和只读服务器场。

答案在于细节。您的应用程序 CPU 或 I/O 是否受限？您需要 TB 的存储空间还是仅需要几 GB 的存储空间？

# iphone - 想模仿iphone通讯录搜索（在界面&交互方面）

> ID：837850
> 
> 赞同：0
> 
> 时间：2009-05-08T01:29:36.453
> 
> 标签：iphone, search, uitableview

当您在通讯簿中进行搜索时，流程是：

1) 选择搜索栏

2) 最右边最透明的 az 索引被移除

3) 在当前 UITableView 上放置一个透明的黑色窗口

4）当你开始输入时，一个新的 UITableView 被加载，没有数据

5) UITableView 会在您键入时填充数据。

6）如果您选择一个项目，您将被带到它面前

7) 如果您取消搜索，您将返回主 UITalbeView

我的第一个真正问题是，当用户开始搜索时，如何加载新的 UITableView？就像在堆栈上弹出一个新视图一样简单吗？那么它会是一个单独的 .m/.h 文件，有自己的实现吗？

第二个问题是如何删除最右边的索引？或者当您渲染新的（空白）UITableView 时，它就消失了？

我已经让搜索工作了，但我的在同一个 UITableView 中进行，当你开始时，它包含 2K 的结果，被分组（A 标题下的结果等）并且具有最正确的索引。

如果可以的话，我很乐意将结果留在表格中；

1) 删除最右边的 az 索引

2）删除表分组

3）告诉视图我只有 N 个搜索结果，所以它会正确构建滚动条。

感谢您的输入;

*   sk

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-08T06:55:10.460

Use the new iPhone SDK 3.0 where this is provided for free by a new controller.

I can't say more because the iPhone SDK 3.0 is still under NDA.

# sharepoint - 无法显示列表中的图像

> ID：837852
> 
> 赞同：1
> 
> 时间：2009-05-08T01:30:05.970
> 
> 标签：sharepoint

我正在尝试显示`ListItems`在`GridView`.

我可以访问列表项，但我的图像显示为 url 。

我在用：

```
dr["Category"] = SPEncode.HtmlEncode(Convert.ToString(oListItem["Category"])); 
```

上面的代码行显示了列表项，但是当我尝试显示图像时，它呈现为`http://server/images/xyz.jpg`在 gridview 中。

请帮助我访问列表图像。

**更新：**

关于[艾伦的回答](https://stackoverflow.com/questions/837852/cannot-display-image-from-list/837932#837932)：

我试过这个：

```
foreach (SPListItem oListItem in collListItems) {
    dr["Category"] = 
         SPEncode.HtmlEncode(Convert.ToString(oListItem["Category"]));
} 
```

但是当我尝试显示图像时：

```
dr["ProductImage"] = 
       SPEncode.HtmlEncode(Convert.ToString(oListItem["ProductImage"])); 
```

它仍然呈现为：`http://server/images/xyz.jpg`在gridview中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T05:51:15.550

您可以尝试此处提供的解决方案：

> [http://cipriangrosu.blogspot.com/2009/05/display-item-type-icon-in-spgridview.html](http://cipriangrosu.blogspot.com/2009/05/display-item-type-icon-in-spgridview.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T02:00:36.737

这个问题可以使用更多细节。了解 oListItem[key] 和 dr[key] 是什么数组会有所帮助。不管它是什么，看起来`oListItem[].ToString()`方法只是返回一个 URL。

难道你不能只是新建一个 Image 控件，设置 ImageSrc 属性，然后将它添加到 GridView 中吗？您需要为每一行实例化一个新图像（不要重复使用图像）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T08:40:48.197

您使用的是 ASP.NET GridView 吗？在这种情况下，您可以将您的图像列的归档属性设置为图像字段。然后，您可以将转换后的 oListItem["ProductImage"] 字段的值分配给 PictureUrl 字段。

这是一个帮助您入门的示例：

[http://msdn.microsoft.com/en-us/library/aa479350.aspx](http://msdn.microsoft.com/en-us/library/aa479350.aspx)

# version-control - Mercurial 简介

> ID：837858
> 
> 赞同：13
> 
> 时间：2009-05-08T01:31:32.533
> 
> 标签：version-control, mercurial, dvcs

我刚刚开始研究一个使用 Mercurial 作为版本控制系统的项目，我需要一些关于如何使用它的基本技巧。请使用此问题提供有关此技术的一些介绍性提示。

*   [Mercurial 官方网站](https://www.mercurial-scm.org)

特别是，我正在寻找有关使用的最佳程序和最佳技术的提示（分支、进出检查等。我需要学习最佳实践！）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-08T02:36:41.050

我知道您已经拥有 Mercurial 网站，但对我来说最有用的资源是[Mercurial 书](https://www.mercurial-scm.org/wiki/MercurialBook)。这是对该程序及其使用方法的出色概述。

我发现学习 Mercurial 的最佳方式就是在项目中使用它。我将一个从 subversion 导出的项目导入 Mercurial，并用它进行了一些常规开发。我确保为不同的变更集克隆存储库，以便我可以习惯合并和更新。我还没有学会所有的高级用法，但我现在已经站稳了脚跟，还没有切换回 Subversion。

许多项目有不同的提交工作流技术。有些更改是从开发人员那里推送的，例如集中式系统，有些会从贡献者那里提取更改（例如 Linux）。在不了解项目流程的情况下很难概括太多。

这就是我的开发方式：

*   `project-trunk`文件共享或http 上的集中树，称为`project`最终项目版本
*   我系统上的一棵干净的树，我从远程存储库克隆并用于推送回存储库。然后我从这棵树中克隆以进行更改。我称这棵树`project-local`
*   为我的每个更改克隆`project-local`树：例如。`project-addusers`,`project-141`等。
*   在完成对树的提交后，我将更改推送到`project-local`存储库
*   最后，将更改推`project-local`送到`project-trunk`

我有干净的`project-local`树，因为这样我可以一次将所有变更集推回主干，如果有一组相关的更改需要一起推回，这将很有帮助。

至于工具，这取决于您的平台。我只是使用香草命令行工具。来自 TortoiseSVN，进入命令行有点变化。但我现在很好。我尝试使用 TortoiseHg，但它在我的 Windows 7 x64 虚拟机上运行不佳。我听说它在受支持的 32 位平台上要好得多。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2010-03-05T02:11:54.010

这是由[Joel Spolsky](http://www.joelonsoftware.com/)撰写的关于 Mercurial的[有用教程](http://hginit.com/)。

它涵盖了基本用法和命令，以及如何在概念层面上使用 Mercurial。如果您已经熟悉 SVN，那么第一部分绝对值得一读：它讨论了 SVN 和 Mercurial 之间的主要概念差异，因为尝试以与使用 SVN 相同的方式使用 Mercurial 是自找麻烦。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-08T02:27:34.537

看看[Mercurial 的书](http://hgbook.red-bean.com/)，或者这个[Mercurial 教程](https://www.mercurial-scm.org/wiki/Tutorial)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-08T05:24:23.050

如果您使用最新的[TortoiseHG](https://tortoisehg.bitbucket.io/)客户端并将安装目录包含在您的 PATH 环境中，您将能够使用它们提供的漂亮 GUI 和命令行“hg”

我不建议过多地使用 mq 扩展。它们构成了一个很棒的“工作存储库”环境。

我使用队列来管理针对颠覆存储库的本地更改。我进行本地短期更改并使用 mercurial 与 subversion 和团队的其他成员保持同步。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-10T12:54:02.280

根据您使用其他源代码控制工具的背景，我还建议使用特定的 SCM——无论是 Mercurial 指南。例如，看看[这个 Subversion 用户指南](http://wiki.pylonshq.com/display/pylonscookbook/Mercurial+for+Subversion+Users)。

另一个让您了解整个“分布式”源代码控制理念的好资源是：[http](http://betterexplained.com/articles/intro-to-distributed-version-control-illustrated/) ://betterexplained.com/articles/intro-to-distributed-version-control-illustrated/ ...带有有用的图表！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-12-29T05:20:39.933

Steve Losh 的一些博客文章很不错，尽管它们现在已经有几年了。他们主要处理如何使用分支。

*   [Mercurial 分支指南](http://stevelosh.com/blog/2009/08/a-guide-to-branching-in-mercurial/)
*   [分支工作流 - 根据需要进行分支](http://stevelosh.com/blog/2010/02/mercurial-workflows-branch-as-needed/)
*   [分支工作流 - 稳定和默认](http://stevelosh.com/blog/2010/05/mercurial-workflows-stable-default/)

[他的hgtip.com](http://hgtip.com/)网站也值得一看。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-12-26T16:06:34.443

除了 Mercurial Book 和 Hg Init 教程之外，我还想提一下我编写的示例驱动指南：

*   [Mercurial 启动](http://mercurial.aragost.com/kick-start/)

它展示了如何开始使用 Mercurial，还涵盖了一些更高级的概念，例如命名分支和 hgsubversion。我在向新用户教授 Mercurial 时使用过它，他们似乎很喜欢它。

# c# - 如何实现树结构，但仍然可以通过索引将其作为平面数组引用？

> ID：837859
> 
> 赞同：2
> 
> 时间：2009-05-08T01:31:46.370
> 
> 标签：c#, tree

我想在内存中有一棵树，每个节点可以有多个子节点。我还需要通过索引将此树引用为平面结构。例如：

```
    a1
       b1
       b2
       b3
    c1
       d1
          e1
          e2
       d2
          f1

```

将被表示为我布置的平面结构（即；a1=0、b1=1、d1=5 等。）

理想情况下，我希望按索引查找 O(1)，并支持插入、添加、删除等。它的好处是线程安全，但如果这不可能，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T01:53:26.880

如果您有一个合理平衡的树，您可以在 O(log n) 时间内获得索引引用 - 只需在每个节点中存储其下节点数的计数，并在执行时更新沿路径的计数到修改后的叶子插入、删除等。然后，您可以通过查看从根下降时每个子节点的节点计数来计算索引访问。索引引用是 O(1) 而不是 O(log n) 对您来说有多重要？

如果对访问的修改不频繁，则可以在完成一组修改后通过树遍历来计算指向节点的指针的侧向量。然后，您可以通过引用边向量来获得对单个节点的 O(1) 访问权限，直到您下次修改树。代价是您必须在进行修改后进行 O(n) 树遍历，然后才能返回 O(1) 节点查找。您的访问模式是否适合您？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T02:18:24.823

我在我使用的通用红黑树中使用了类似的东西。从本质上讲，您需要一个像 Tree 这样的包装类，其中包含实际的节点。

这是基于能够通过索引引用树

因此，您可以执行以下操作来设置具有 Key、Value 的树

```
class Tree<K, V>
{
    //constructors and any methods you need

    //Access the Tree like an array
    public V this[K key]
    {
        get {
            //This works just like a getter or setter
            return SearchForValue(key);
        }
        set {
            //like a setter, you can use value for the value given
            if(SearchForValue(key) == null)
            {
                // node for index doesn't exist, add it
                AddValue(key, value);
            } else { /* node at index already exists... do something */ }
     }
} 
```

这样做的前提是您已经知道如何创建树，但希望能够执行诸如按索引访问树之类的事情。现在你可以这样做：

```
Tree<string,string> t = new Tree<string,string>();
t["a"] = "Hello World";
t["b"] = "Something else";
Console.Writeline("t at a is: {0}", t["a"]); 
```

最后，为了线程安全，您可以在 Tree 类中添加一个对象，并且在任何暴露给外界的方法上只需调用

```
Lock(threadsafetyobject) { /*Code you're protecting */ } 
```

最后，如果您想要更酷的线程安全性，我会在树中使用一个名为[ReaderWriterLockSlim](http://msdn.microsoft.com/en-us/library/system.threading.readerwriterlockslim.aspx)的对象，它允许多次读取，但在您想要执行写入时锁定，如果您正在更改树的结构，例如执行旋转，而另一个线程正在尝试读取。

最后一件事，我重写了代码以从内存中执行此操作，因此它可能无法编译，但应该很接近:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T02:38:23.510

您总是可以使用[Joe Celko 的](http://www.celko.com/)使用[嵌套集来表示树](http://www.intelligententerprise.com/001020/celko.jhtml)的技术。他专注于 Sql，但嵌套集之间存在相似之处，并且将树表示为平面数组，这对于您想要首先使用数组的最终原因可能很有用。

但正如其他人所指出的那样，大多数情况下，直接作为链接节点遍历树会更容易。经常引用的树的数组实现是二叉搜索树，因为对于一个节点`n`，父节点是`(n-1)/2`，左孩子是`2n+1`，右孩子是`2n+2`

使用数组的缺点是插入、删除、修剪和嫁接所有（通常）都需要在树更改时修改数组。

你也可以阅读[B-trees](http://en.wikipedia.org/wiki/B-tree)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T02:47:50.040

不确定这是否好。但是通过将树级别计算为幂然后添加偏移量，可以将平面数组作为二叉树进行寻址。但这仅在树是二叉树时才有效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-08T01:40:45.490

如果您为每棵树定义了数量的子树（例如，[二叉树](http://en.wikipedia.org/wiki/Binary_Tree#Methods_for_storing_binary_trees)），那么这并不太难（尽管您可能会浪费大量空间）。

如果它有可变数量的子节点，您可能不得不想出一些复杂的方式来存储节点的第一个子节点的索引。

不过，我没有看到这样做会有什么用处。树的要点是能够存储和检索特定节点下的项目。如果您想要按索引进行恒定时间查找，那么听起来您根本不想要一棵树。通过将其存储在数组中，您必须考虑这样一个事实，即如果您在中间添加一个元素，那么您最初存储的所有索引都将无效。

但是，如果您确实想要一棵树，并且仍然想要恒定时间插入/查找，只需将对父节点的引用存储在变量中，然后将子节点插入它下面。那*是*恒定的时间。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-08T02:05:20.890

这可以通过一些工作来实现，但是您的插入和删除方法将变得更加昂贵。为了保持数组正确排序，您需要移动大量数据以创建或填充空间。唯一明显的优势是非常快速的遍历（最小的缓存未命中）。

无论如何，一种解决方案是在每个节点中存储子节点的数量，如下所示：

```
struct TreeNode
{
    int numChildren;
    /* whatever data you like */
}; 
```

这是一个如何遍历树的示例...

```
TreeNode* example(TreeNode* p)
{
    /* do something interesting with p */

    int numChildren = p->numChildren;
    ++p;
    for(int child = 1; child <= numChildren; ++child)
       p = example(p);
    return p;
} 
```

希望您可以自己派生插入、删除等。

:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-07-21T08:58:07.823

有一个二叉树的解决方案，你不必索引任何东西。如果每个节点都有确切数量的子节点，则解决方案可能会更新为非二叉树
复杂度是 θ(h)，其中 h 是树的高度 [如何按索引插入删除或更新二叉树的值？](https://stackoverflow.com/questions/68466600/how-to-insert-delete-or-update-a-value-of-binary-tree-by-index/68466601#68466601)

# vba - 如何将水平滚动条添加到 VBA 列表框

> ID：837860
> 
> 赞同：4
> 
> 时间：2009-05-08T01:32:41.547
> 
> 标签：vba

我想向 VBA ListBox 添加一个水平滚动条。

似乎内置的 ListBox 不会自动添加水平滚动条。我有许多字段的内容超出了 ListBox 的宽度，因此用户无法阅读。

我找到[了这篇文章](http://support.microsoft.com/kb/192184)，但是由于访问 ListBox 的 hwnd （这在 VBA 中显然不可用），代码失败了。我宁愿不编写本机 DLL 来完成此操作，因为我怀疑有更好的方法。

关于如何将水平滚动条添加到 VBA 列表框的任何想法？

我对使用替代控件而不是让它专门与 ListBox 一起工作的想法持开放态度。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-08T21:56:14.063

您是否尝试过 ColumnWidths 属性？我有带有水平滚动条的列表框。我只需要添加 ColumnWidths 属性。

例如我有

米`e.Listbox1.Columnwidts ="0.5 in;0.2 in;1.5 in;0.75 in;0.5 in"`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-08T07:33:35.143

除非我遗漏了某些东西，否则如果 VBA 列表框的`ColumnWidths`属性总和超过了它自己的宽度，它将自动获得一个水平滚动条。

我所知道的没有影响这种行为的属性，即我不知道如何强制或禁用水平滚动条的显示。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-22T18:43:25.000

如果列宽超过列表框的宽度，Access 将自动添加水平滚动条。但是，如果您使用多列，则第一列不能设置为 0。您必须至少有一些值，即使它只是 0.1" 希望这会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T01:46:49.127

在那篇文章中，它获得 ScaleMode 的唯一原因是设置水平滚动条的宽度。你不必那样做。

```
SendMessageByNum List1.hwnd, LB_SETHORIZONTALEXTENT, 800, 0 
```

其中 800 是您希望列表框能够向右滚动到的像素宽度。

您仍然需要 hWnd。最好的办法是使用一个外部 DLL（用 VB 编写），它可以枚举进程的子窗口，直到找到列表框的 windows 类（您需要找到某种方法来唯一标识其父级，例如窗口标题/文本或其他东西）。同一个 DLL 也可以执行上面的 SendMessage 调用来设置水平文本范围（也许它也可以测量包含的列表项的宽度）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-08T10:45:55.700

可以按如下方式获取列表框的句柄：-

将 ListHwnd 调暗为整数 lstboxName.SetFocus ListHwnd = GetFocus()

将此 ListHwnd 用作 sendmessage 函数的第一个参数...

我们需要提供下面的声明，因为 GetFocus 函数在 VBA 中默认不存在

Private Declare Function GetFocus Lib "user32" () As Integer

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2018-10-05T22:39:33.663

在 Visual Studio 2017 中，您可以单击列表框，然后转到属性面板，然后（向下滚动到）找到“Horizo​​ntailScrollbar”属性。默认情况下 this 属性设置为 false，因此您应该将其设置为 true。

当一个小三角形出现在列表框的右上角时，您就知道您已经正确设置了滚动条。

希望这可以帮助。

# solaris - mmap 会使用连续内存吗？（在太阳能系统上）

> ID：837863
> 
> 赞同：2
> 
> 时间：2009-05-08T01:35:07.017
> 
> 标签：solaris, mmap

我使用 mmap（只是想了解 mmap 的工作原理）分配 96k 匿名内存，但看起来它将 96k 拆分为 64k 和 32k。但是当分配 960k 时，它只分配一个大小为 960k 的块。solaris 什么时候将 allocate mem 分成几部分？代码：

```
#define PROT PROT_READ | PROT_WRITE
#define MAP  MAP_ANON  | MAP_PRIVATE
if ((src = mmap(0, 88304, PROT, MAP, -1, 0)) == MAP_FAILED)
    printf("mmap error for input");

if ((src = mmap(0, 983040, PROT, MAP, -1, 0)) == MAP_FAILED)
    printf("mmap error for input");

if ((src = mmap(0, 98304, PROT, MAP, -1, 0)) == MAP_FAILED)
    printf("mmap error for input"); 
```

桁架：

```
mmap(0x00000000, 88304, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANON, -1, 0)
    = 0xFFFFFFFF7E900000
mmap(0x00000000, 983040, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANON, -1, 0)
    = 0xFFFFFFFF7E800000
mmap(0x00000000, 98304, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANON, -1, 0)
    = 0xFFFFFFFF7E700000 
```

地图：

```
FFFFFFFF7E700000         64     -          -          - rw---    [anon]
    ==> strange is that for 96k, it was broken into 2 part.
FFFFFFFF7E710000         32     -          -          - rw---    [anon]
FFFFFFFF7E800000        960     -          -          - rw---    [anon]
FFFFFFFF7E900000         64     -          -          - rw---    [anon]
FFFFFFFF7E910000         24     -          -          - rw---    [anon]
FFFFFFFF7EA00000         64     -          -          - rw---    [anon]
FFFFFFFF7EA10000         32     -          -          - rw---    [anon] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T02:17:57.273

那*是*连续的内存，您可以通过地址来判断，`(F...700000 + 64K = F...710000)`所以我认为您不必担心。我很确定 mmap 需要在您的地址空间中为您提供连续的内存。否则它将毫无用处，因为它只给你一个基地址。对于两个不连续的块，将无法找到第二个块。

所以我想你的问题是：为什么这在 pmap 中显示为两个块？

我的回答是，“如果我知道的话，我会很高兴”。但我可以做出明智的猜测，在早上的这个时候（咖啡前），任何人都可以从我这里得到最好的结果。

我建议这些块之前已分配给另一个（或两个）进程，并已释放回 mmap 内存管理器。我可以看到关于内存管理器如何合并块以生成更大的空闲块的两种可能性：

*   它会在内存释放后立即执行（不是您的输出显示*没有*发生的情况）。
*   它会定期执行它，并且在您请求 96K 块之前它还没有解决；或者
*   它一点也不麻烦，因为它足够聪明，可以在为你分配块的过程中做到这一点。

我怀疑是后者仅仅是因为内存管理器没有问题给你两个块来满足你的请求，所以它显然是为了处理它而构建的。960K 块可能没有被分段，因为它来自一个更大的块。

请记住，这是猜测（知情，但仍然是猜测）。我已经看到了很多 UNIX 的内部结构（真正的 UNIX，而不是那个新人 :-)，但我从来没有需要深入研究 mmap。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-08T02:35:38.230

我不记得它的术语（条纹？切片？楔子？啊），但 Solaris 从各种大小的池中分配不同的页面大小。事实证明，这比统一页面大小更有效，因为它更好地使用了内存映射。我相信其中一个尺寸是 32K，另一个是 64K，另一个是 1024K。要获得 96K，您需要 64 和 32，要获得 960，您可以获得 1024K 的大部分。

这个魔法的核心资源是[Solaris Internals](http://www.solarisinternals.com/wiki/index.php/Solaris_Internals_and_Performance_FAQ)书。我的，不幸的是，在妈妈的车库里的一个盒子里。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-17T17:24:28.513

答案取决于您所说的连续。Solaris 和所有现代 Unix 和类 unix 系统（可能所有现代操作系统）都将物理内存划分为页面，并且“页面”内的内存在物理级别上是连续的。大多数现代系统都有一个硬件 MMU（内存管理单元），它将虚拟地址转换为物理地址。因此 mmap 系统调用将返回一个连续的虚拟地址空间，但该虚拟地址将由 MMU 管理，该 MMU 可能使用多个页面，具体取决于页面的大小和内存映射的大小。

虽然所有虚拟地址都是连续的（在映射内），但“页面”内的地址也将是物理上连续的，但页面和页面之间的转换甚至可能在物理上彼此不接近。

# java - Java重载与覆盖

> ID：837864
> 
> 赞同：17
> 
> 时间：2009-05-08T01:35:42.600
> 
> 标签：java, overloading, overwrite

嗨，我只是想确保我有正确的这些概念。Java 中的重载意味着您​​可以拥有具有不同数量参数或不同数据类型的构造函数或方法。IE

```
public void setValue(){
   this.value = 0;
}
public void setValue(int v){
   this.value = v;
} 
```

这个方法怎么样？由于它返回不同的数据类型，它是否仍会被视为重载？

```
public int setValue(){
   return this.value;
} 
```

* * *

第二个问题是：java 中的覆盖是什么？是否与继承有关。让我有以下内容：

```
public class Vehicle{
  double basePrice = 20000;
  //constructor defined
  public double getPrice(){
     return basePrice;
   }
}

public class Truck extends Vehicle{
  double truckPrice = 14000;
  //constructor defined
  public double getPrice(){
     return truckPrice;
   }
} 
```

所以现在假设我有以下

```
Truck truck = new Truck(); 
```

如果我打电话

```
truck.super.getPrice() 
```

这将返回 Vehicle 类的价格，20,000

如果我打电话

```
truck.getPrice() 
```

这将返回卡车类的价格，14,000

**我的知识对这两个问题都正确吗？**

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-05-08T01:50:18.853

你基本上是对的。重载是在单个类中具有多个方法，其中方法具有相同的名称。但是，返回值不被视为方法*签名*的一部分。因此，您不能仅通过更改返回值来重载方法。从您的示例中，您不能拥有以下代码：

```
public void setValue() {
   this.value = 0;
}

public int setValue() {
   return this.value;
} 
```

这将无法编译。

正如 Rob 所指出的，我相信您的意思是**覆盖**，并且您说得对。注意覆盖，您不能更改返回类型。从 Java 5 开始，您可以返回基类方法返回的派生类型。在 Java 5 之前，它必须是相同的类型。也就是说，在 Java 5 及更高版本之前，您无法执行以下操作：

```
public class AnimalNoise {}
public class Miaw extends AnimalNoise {}

public class Animal {
    public AnimalNoise makeNoise() {
        return new AnimalNoise();
    }
}

public class Cat extends Animal {
    public Miaw makeNoise() {
        return new Miaw ();
    }
} 
```

但是，即使在 Java 5 及更高版本中，您*也不能*执行以下操作：

```
public class Animal {
    public String makeNoise() {
        return "silence";
    }
}

public class Cat extends Animal {
    public Miaw makeNoise() {
        return new Miaw ();
    }
}
public class Miaw {} 
```

最后，重载和重载之间经常被忽略的一个很大区别是重载是在编译时决定的，而重载是在运行时决定的。当他们期望在运行时决定重载时，这让许多人感到惊讶。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-08T01:40:23.417

正确的; 重载为同一方法提供多个签名。

覆盖，这就是我认为“覆盖”的意思，是提供从基类型继承的方法的不同实现的行为，基本上是继承的多态性，即

```
public class Bicycle implements Vehicle {
    public void drive() { ... }
}

public class Motorcycle extends Bicycle {
    public void drive() {
        // Do motorcycle-specific driving here, overriding Bicycle.drive()
        // (we can still call the base method if it's useful to us here)
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T01:50:52.503

你所描述的是正确的。

如需更多说明，请查看多态性概念。维基百科有一篇很好的文章

[http://en.wikipedia.org/wiki/Polymorphism#Computing](http://en.wikipedia.org/wiki/Polymorphism#Computing)

[http://en.wikipedia.org/wiki/Polymorphism_in_object-oriented_programming](http://en.wikipedia.org/wiki/Polymorphism_in_object-oriented_programming)

# objective-c - Objective-C中的二维整数数组

> ID：837867
> 
> 赞同：0
> 
> 时间：2009-05-08T01:36:30.120
> 
> 标签：objective-c, arrays

我正在使用 C 风格的 2d 整数数组。

这在我的主类文件中很好，我可以通过引用其他类来传递我的数组。当我尝试检索指向数组的指针并使用它时遇到了问题。

我的问题是：除了使用 C 风格的二维数组，还有更好的方法吗？也许是我不知道的可可类？我注意到 NSMatrix，但这似乎适用于单元格，而不是普通的整数。

我到处都有这种格式的调用：`items[x][y]`，所以引用数组位置的速记方式会很棒。

更多细节：

我将数组设置为实例变量，并尝试像这样访问：

```
-(void) setItems: (int [15][24])items
{
    (*pitems)[24] = **items;
}

-(int) getItems
{
    return (*pitems)[24];
} 
```

当我尝试使用 检索时`getItems`，我收到了关于创建没有强制转换的引用的编译器警告。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T02:00:29.827

这里有一个有趣的讨论：[http ://www.idevapps.com/forum/archive/index.php/t-244.html](http://www.idevapps.com/forum/archive/index.php/t-244.html)

基本上，建议是将您的二维数组转换为多个一维数组。例如：

int array[20][8] 变为

```
int** array = (int*)malloc(20 * sizeof(int*));

unsigned int i = 0;
for (i = 0; i < 20; ++i)
{
    array[i] = (int)malloc(8 * sizeof(int));
}

and your method returns int** and variable is of type int**. 
```

这具有正常二维数组索引按预期工作的优点。

链接中未建议的另一个选项是使用 NSMutableArray 类型的 NSMutableArray。这将比标准 C 数组慢，但更容易传递和引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T04:19:49.727

如果您知道第一个维度的确切大小，则只能传递二维静态数组：

```
// OK, even though we don't know the size of the second dimension
- (void) doStuff: (int [15][])array { ... }
...
int array[15][24];
[self doStuff:array];

// ERROR: don't know size of first dimension (second dimension is irrelevant)
- (void) doStuff: (int [][])array { ... } 
```

当然，那么您的函数仅适用于第一维中的一个特定数组大小。如果在运行时之前不知道第一个维度的大小，则必须将数组展平为一维数组，或者使用动态分配的指向一维数组的指针数组，如[KiwiBastard 的答案](https://stackoverflow.com/questions/837867/2d-arrays-of-ints-in-objective-c/837930#837930)。

# .net - VS中是否有“当前线程中的下一条语句”的快捷方式？

> ID：837869
> 
> 赞同：4
> 
> 时间：2009-05-08T01:37:45.903
> 
> 标签：.net, visual-studio, debugging

在 VS (2008) 中调试多线程 .NET 应用程序时，我经常想单步执行代码。当我经常按 F10 时，我发现 VS 跳转到另一个线程中的语句。它真的很混乱，总是让我失望。

我可以通过插入一百万个断点来解决它。

有没有更简洁的方法让 VS 调试器转到当前线程中的下一条语句？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T01:39:34.870

可能更简单的方法是冻结您对跟踪不感兴趣的任何线程（在“线程”窗口中单击鼠标右键）。这可能意味着您需要进行一些手动操作，并且不会准确地表示线程交互，但您不会从一个线程跳转到下一个线程。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-13T08:31:19.893

Windows 调试权威 John Robbins[刚刚发布了一个宏](http://www.wintellect.com/CS/blogs/jrobbins/archive/2009/07/17/automatically-freezing-threads-brrrrr.aspx)，允许您在 VS 2008 中批量冻结和解冻线程。

这无疑使事情变得容易得多。线程间的依赖关系最终可能会导致问题，但在大多数情况下这是一个可行的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T01:57:17.870

同意@Alan McBee。我认为在 VS 2010 中，他们正在添加一个“冻结除此之外的所有线程”命令，这也将使这更容易。但我认为没有其他方法可以实现您的目标（例如必须冻结线程或设置断点）。

# java - 当您在java中知道经度和纬度时，以米为单位计算距离

> ID：837872
> 
> 赞同：77
> 
> 时间：2009-05-08T01:38:08.057
> 
> 标签：java, distance, latitude-longitude

> **可能重复：**
> [在 Java 中使用纬度/经度值](https://stackoverflow.com/questions/120283/working-with-latitude-longitude-values-in-java)

### 复制：

*   [在 Java 中处理纬度/经度值](https://stackoverflow.com/questions/120283/)
*   [如何计算两个经纬度点之间的距离？](https://stackoverflow.com/questions/27928/)

我需要计算两个坐标给出的两点之间的距离。我正在做的项目是一个Java项目，所以Java代码会很棒，但也可以给出伪代码，然后我可以自己实现:)

您可能知道，有三种表示坐标的方法：

*   度：分：秒（49°30'00"N，123°30'00"W）
*   度数：十进制分 (49°30.0', -123°30.0'), (49d30.0m,-123d30.0')
*   十进制度数（49.5000°，-123.5000°），一般有 4-6 个十进制数字。

这是我的坐标给出的第三种方式，所以这个值的代码将是首选的:)

* * *

## 回答 #1

> 赞同：192
> 
> 时间：2009-05-08T02:11:22.140

基于关于[stackoverflow 的另一个问题](https://stackoverflow.com/questions/120283/)，我得到了这段代码。它以米为单位计算结果，而不是以英里为单位:)

```
 public static float distFrom(float lat1, float lng1, float lat2, float lng2) {
    double earthRadius = 6371000; //meters
    double dLat = Math.toRadians(lat2-lat1);
    double dLng = Math.toRadians(lng2-lng1);
    double a = Math.sin(dLat/2) * Math.sin(dLat/2) +
               Math.cos(Math.toRadians(lat1)) * Math.cos(Math.toRadians(lat2)) *
               Math.sin(dLng/2) * Math.sin(dLng/2);
    double c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
    float dist = (float) (earthRadius * c);

    return dist;
    } 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2011-12-12T01:26:15.973

您可以使用[Java Geodesy Library for GPS](http://www.gavaghan.org/blog/free-source-code/geodesy-library-vincentys-formula-java/)，它使用考虑了地球表面曲率的文[森蒂公式。](http://en.wikipedia.org/wiki/Vincenty%27s_formulae)

实现是这样的：

```
import org.gavaghan.geodesy.*;

...

GeodeticCalculator geoCalc = new GeodeticCalculator();

Ellipsoid reference = Ellipsoid.WGS84;  

GlobalPosition pointA = new GlobalPosition(latitude, longitude, 0.0); // Point A

GlobalPosition userPos = new GlobalPosition(userLat, userLon, 0.0); // Point B

double distance = geoCalc.calculateGeodeticCurve(reference, userPos, pointA).getEllipsoidalDistance(); // Distance between Point A and Point B 
```

结果距离以米为单位。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-12-10T13:58:54.930

在 C++ 中，它是这样完成的：

```
#define LOCAL_PI 3.1415926535897932385 

double ToRadians(double degrees) 
{
  double radians = degrees * LOCAL_PI / 180;
  return radians;
}

double DirectDistance(double lat1, double lng1, double lat2, double lng2) 
{
  double earthRadius = 3958.75;
  double dLat = ToRadians(lat2-lat1);
  double dLng = ToRadians(lng2-lng1);
  double a = sin(dLat/2) * sin(dLat/2) + 
             cos(ToRadians(lat1)) * cos(ToRadians(lat2)) * 
             sin(dLng/2) * sin(dLng/2);
  double c = 2 * atan2(sqrt(a), sqrt(1-a));
  double dist = earthRadius * c;
  double meterConversion = 1609.00;
  return dist * meterConversion;
} 
```

# database - 有人可以解释一下LDAP吗？

> ID：837876
> 
> 赞同：65
> 
> 时间：2009-05-08T01:39:36.257
> 
> 标签：database, ldap, protocols

我经常听到诸如“我们可以使用 LDAP 加载我们的员工信息吗？”之类的话。然而，标题“轻量级目录访问协议”让我将其视为一种协议，而不是像 Oracle 或 MSSQL 这样的物理数据库管理系统。

那么有人可以向我解释一下 LDAP 是什么，它是如何使用的，以及它是如何工作的？LDAP 仅仅是从各种 DBMS 中提取数据的标准协议吗？在架构图中，LDAP 是否只是在数据库和应用程序服务器之间绘制的箭头？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-05-08T01:43:58.040

LDAP 是一种用于查询用户目录的协议。例如，Active Directory 或 Novell eDirectory 都支持 LDAP。在某种程度上，它也是进行此类查询的一种语法，就像 SQL 是一种用于查询数据库的查询语言一样。

LDAP 命令可能看起来像

（给定名称=迈克）

它会返回目录中的所有 Mikes。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-05-08T02:06:59.780

LDAP 通常用作身份验证数据库。假设您拥有作为软件即服务销售的 CMS 产品。所以用户得到 CMS，你维护它等等。

因此，您将其安装到 examplecustomer1.com、examplecustomer2.org、examplecustomer3.net（每个域一个软件）。现在您需要维护三个用户数据库。因此，您也可以将自己作为管理员和客户帐户添加到所有系统中。

然后您会发现 LDAP。您将 LDAP 支持添加到您的产品中，现在您拥有一个中央用户数据库。您可以使用自己的 ONE 用户名和密码以管理员身份登录所有系统。CMS 系统仍然包含用户数据库和每个用户的权限，但用户名现在用作 LDAP 数据库的参考，并且密码字段已从 CMS 数据库模式中删除。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-05-08T08:40:18.727

是的，LDAP（轻量级目录访问协议）是一种在 TCP/IP 上运行的协议。

它用于访问目录服务，例如 Microsoft 的 Active Directory 或 Sun ONE Directory Server。

目录服务是一种数据库或数据存储，但不一定是关系数据库。该结构通常要简单得多，存储名称-值对的分层集合，例如 lastName=Smith, firstName=John。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-08T01:53:47.237

LDAP 是一种协议，但我认识的许多人喜欢将其含义重载为包括“任何能够响应 LDAP 查询的存储”。Active Directory 就是这样一个商店，还有很多其他商店。当建筑师并不真正关心商店是什么时使用它。当您不在乎它是 MySql 还是 Oracle 或 SQL Server 时，它的使用就像您说“将其存储在 SQL 中”一样。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2014-10-10T12:41:01.160

LDAP 代表轻量级目录访问协议。这是一个可扩展的开放网络协议标准，提供对分布式目录服务的访问。LDAP 是在 TCP/IP 上运行的目录服务的 Internet 标准。在 OpenLDAP 和相关服务器下，有两台服务器 - slapd，将查询发送到的 LDAP 守护进程和 slurpd，将来自一台服务器的数据推送到一台或多台从属服务器的复制守护进程。通过让多台服务器托管相同的数据，您可以提高可靠性、可扩展性和可用性。

它定义了可以执行的操作，例如搜索、添加、删除、修改、更改名称。它定义了操作和数据的传输方式。

LDAP 具有整合所有现有应用程序特定信息（如用户、公司电话和电子邮件列表）的潜力。这意味着在 LDAP 服务器上所做的更改将对使用此用户信息的每个基于目录服务的应用程序生效。可以通过单个界面添加有关新用户的各种信息，该界面可供 Unix 帐户、NT 帐户、电子邮件服务器、Web 服务器、作业特定新闻组等使用。当用户离开他的帐户时，可以禁用一次操作中的所有服务。

因此，LDAP 在提供“白页”（例如姓名、电话号码、角色等）和“黄页”​​（例如打印机的位置、应用程序服务器等）之类的服务方面最有用。通常在 J2EE 应用程序环境中，它将用于对用户进行身份验证和授权。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-08T02:01:46.860

LDAP 是为响应 X.500 系列协议的复杂性而创建的协议。它旨在表示分层目录结构。X.500 标准最初旨在用于完整的 OSI 层堆栈，旨在满足电信行业的要求。LDAP 旨在使用 TCP/IP 来提供类似的功能，而无需额外的开销。您可以在 wikipedia 上找到有关 X.500、OSI 和 LDAP 的信息。X.500 和 OSI 都包含在大多数数据通信教科书中。

*   [http://en.wikipedia.org/wiki/X.500](http://en.wikipedia.org/wiki/X.500)
*   [http://en.wikipedia.org/wiki/Open_Systems_Interconnection](http://en.wikipedia.org/wiki/Open_Systems_Interconnection)
*   [http://en.wikipedia.org/wiki/Lightweight_Directory_Access_Protocol](http://en.wikipedia.org/wiki/Lightweight_Directory_Access_Protocol)

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2015-09-15T09:12:17.853

什么是 LDAP：

All LDAP 是 Microsoft 为 Active Directory 目录服务实施的一种通信协议，用于其他 NTDS.DIT​​ 文件。让我们摆脱混乱。NTDS.DIT​​ 包含 Active Directory 数据库。要访问数据库，您需要通信协议 LDAP。而已。所以再次NTDS.DIT​​ 是一个简单的数据库即ADDS 数据库（Active Director 目录服务）我们如何访问它？

我们使用 LDAP 访问它。

让我们使用 LDAP 快速示例。
C:/users/data.doc

或者

> LDAP 语法
> 
> CN=Bob,OU=Users,DC=Youtube,DC=Com
> 
> CN = 规范名称（对象或名称）
> 
> OU = 组织单位（Active Directory 中的文件夹）
> 
> DC = 域控制器（在哪里）

其他信息：Active Directory 是基于 X.500 标准的数据库，其中包含所有 AD 对象，即 NTDS.DIT​​ 文件。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-06-09T10:26:31.663

LDAP 是一种互联网协议，用于从服务器查找数据，该协议用于存储和检索分层目录结构中的信息。LDAP 也遵循分层类型的数据模型。简单来说，我们可以说它是一个分层数据库，其中数据存储在树状结构中，叶节点保存实际数据。

LDAP 从未定义程序如何在客户端或服务器上运行，但它更多地解释了将用于在客户端和服务器之间进行通信的消息类型。消息可以是客户端请求的信息、服务器响应和数据格式。这些消息通过 TCP/IP 协议传递。所以应该有一些操作会在客户端和服务器之间的操作完成后建立会话连接并断开它。LDAP可用于需要大量读取操作和较少写入操作的情况。例如，我们知道用户名和密码不会经常更改的用户身份验证。

LDAP 操作流程

要开始通信，客户端需要创建与服务器的会话。这个过程称为绑定。要绑定到服务器，客户端必须指定服务器所在的 IP 地址或主机名和 TCP/IP 端口号。客户端还可以提供用户名和密码等凭据，以确保与服务器进行正确的身份验证。或者，客户端也可以使用默认访问权限创建匿名会话。或者双方可以建立一个会话，该会话使用更强大的安全过程，如数据加密。一旦建立了会话，客户端就会对目录数据执行其预期的操作。在 LDAP 中，可以管理和查询目录信息，因为它提供读取和更新功能。客户端在完成请求后关闭会话。这个过程称为解除绑定。LDAP 模式 LDAP 主要依赖于数据模型，如

信息模型 目录包括信息的基本单元，称为条目，它代表一个真实世界的对象，如服务器、人等。条目包括定义关于对象的信息的属性集合。每个属性包括与语法相关的类型，以及一个或多个值。下图说明了条目及其属性及其类型和值之间的关系：

命名模型 LDAP 的命名模型表示如何识别和组织条目。在 LDAP 中，条目以分层或树状结构组织，称为 DIT（目录信息树）。条目在 DIT 中根据它们的 DN（可分辨名称）进行排序，DN 是一个唯一的名称，可以清楚地标识单个条目。

功能模型
LDAP 定义了客户端请求的操作，可以分为三类。他们是：

```
 1\.  Query which is used to fetch information from a directory. Include operations like search and                   compare.

   2\. Update which is used to update the information stored in the directory. Include operations like                add, modify and delete.

   3\. Authentication which is  used to connect and disconnect with a server, create access rights and                preserve information. Include operations like bind, unbind and abandon. 
```

安全模型

```
In LDAP, the security model relies on the bind operation. Three different bind operations are                possible according to the security mechanisms applied. They are: 
```

1.  无身份验证

    最简单的方法，但只能在数据安全不成问题并且没有访问控制权限纠结的情况下应用。例如，该目录包括任何人都可以浏览的通讯录。如果用户在绑定 API 调用期间将 DN 和密码字段留空，服务器将自动采用匿名用户会话，并授予访问权限以及针对此类访问描述的相应访问控制。

2.  基本认证

    基本身份验证是 LDAP 中使用的另一种简单的安全机制，它被用于其他几种面向 Web 的协议中，例如 HTTP。在这种方法中，客户端必须通过输入以明文形式通过网络传输的密码和 DN 来向 LDAP 服务器验证自己的身份。另一方面，服务器将 DN 和密码与目录中的条目进行比较。如果密码匹配，则授予访问权限。而且明文形式的密码不能保证机密性；因此，可能会导致密码泄露给未授权方。

3.  SASL（简单身份验证和安全层）

    此框架已添加到 LDAP V3，它为面向连接的协议添加了额外的身份验证方法。该机制指定了一个质询和响应协议，客户端和服务器在该协议中交换一些数据以确保身份验证并建立安全层，随后将在该安全层上进行通信。使用 SASL，LDAP 协议可以支持 LDAP 客户端和 LDAP 服务器批准的任何类型的身份验证。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-06-16T18:03:26.383

是的，LDAP 本身通常需要较低级别的数据库存储。我建议你在这里弄脏你的手：

如果您只是安装 OpenLDAP 并使用它... [http://www.openldap.org/doc/admin22/install.html](http://www.openldap.org/doc/admin22/install.html)

...您将被迫考虑依赖关系。

在这种情况下，其中之一是 SleepyCat。

玩得开心。

为了更有趣，这里是关于分类的一个很好的哲学讨论：http: [//archive.oreilly.com/pub/post/ldap_is_not_a_database.html](http://archive.oreilly.com/pub/post/ldap_is_not_a_database.html)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-07-28T06:44:24.377

LDAP 基本上是一种访问目录的协议。这里的目录基本上是指具有组织中存在的用户信息的目录。目录的示例包括 Microsoft 的 Active Directory (AD) 和 Oracle 的 Internet Directory (OID)。该目录主要用于通过集中用户身份验证和授权来实现组织的单点登录功能。有关更多详细信息，请参阅以下链接：

1.  [http://searchmobilecomputing.techtarget.com/definition/LDAP](http://searchmobilecomputing.techtarget.com/definition/LDAP)
2.  [https://eagledatagistics.com/what-is-enterprise-user-security-eus/](https://eagledatagistics.com/what-is-enterprise-user-security-eus/)

# asp.net - Request.Params [ASP.NET] 的任何问题

> ID：837887
> 
> 赞同：1
> 
> 时间：2009-05-08T01:43:55.920
> 
> 标签：asp.net, query-string

希望答案是否定的，但是使用 Request.Params 而不是 Request.QueryString 来检索 asp.net 中查询字符串中的数据有什么问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T01:49:51.443

不，除非您碰巧拥有与 Query 集合中的参数名称相同的字段名称的 Forms 集合字段，否则当您只需要一个键/值对时，您将获得一个数组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T01:48:39.387

不是这样的问题，但请注意 request.querystring 要轻得多 - request.params 返回 cookie、表单变量、服务器变量和查询字符串，而 request.querystring 当然只返回查询字符串值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T01:49:43.487

已在[Request.Params 和 Request.Form 何时不同？](https://stackoverflow.com/questions/5706/when-do-request-params-and-request-form-differ)

它谈论 request.form 但它与 request.querystring 相同

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T01:50:28.463

没有陷阱。Request.Params 只是功能更全。

现在，如果您将其序列化并将其保存到数据库中，那将浪费字节，但仅此而已。

# apache - gzipping 服务器响应更糟

> ID：837895
> 
> 赞同：0
> 
> 时间：2009-05-08T01:48:07.283
> 
> 标签：apache, gzip

根据雅虎性能团队的建议，我决定在 Apache 上启用 mod_deflate。在检查结果时（使用 HTTPWatch），压缩后的响应平均比未压缩的响应多 100 毫秒？

服务器平均负载使用 <5% 的 CPU。压缩级别最低？

你们有没有经历过这样的结果或读过它？我非常感谢任何意见。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T02:52:46.550

我不认为雅虎的观点是 gzipping 会更快。也就是说，如果您查看带宽的边际成本与 CPU 功率，如果它允许您使用更少的带宽，您最好使用更多的 CPU。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T01:49:58.557

您要发送什么样的回复？您不会注意到压缩某些类型的二进制数据有任何好处，例如图像、Flash 动画和其他此类资产；GZip 最适合文本。

此外，压缩数据会在服务器和客户端上产生轻微的性能开销，但您希望如此，对吧？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T02:58:57.410

我同意 Rob 的观点，您需要弄清楚延迟是否是由于 Apache 没有尽快提供文件，因为它必须经过压缩，或者是否有其他原因。仅仅观察 HTTP 响应并不能告诉你为什么它更慢，只是它确实如此。

# jquery - 使用 jQuery 获取已被删除的元素的值？

> ID：837908
> 
> 赞同：0
> 
> 时间：2009-05-08T01:51:50.237
> 
> 标签：jquery

我有以下 jQuery：

```
$(document).ready(function () {
    $(".element").draggable();
    $(".element").droppable({
        drop: function () {
            alert('dropped');
        }
    });
}); 
```

任何具有“元素”类的东西都可以在页面上进行操作和拖动。我希望能够找到被拖动元素的 HTML 内容和被丢弃的元素，并在“alert('dropped');”中使用它们 是，所以我可以做类似的事情：

```
alert(firstelement+ ' was dropped on ' +secondelement); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-08T01:57:22.300

您需要在 drop 回调中添加参数。

```
drop : function(event, ui) {
   var droppable = $(this);
   var draggable = ui.draggable;

   alert(droppable.attr('id') + " was dropped on " + draggable.attr('id'));
} 
```

[http://jqueryui.com/demos/droppable/#event-drop](http://jqueryui.com/demos/droppable/#event-drop)

# java - java servlets：传递带有空格的url变量值

> ID：837915
> 
> 赞同：1
> 
> 时间：2009-05-08T01:54:52.727
> 
> 标签：java, servlets, url-rewriting

我正在构建一个简单的 java Servlet，它使用 URL 变量将类别传递到另一个 Servlet。

例如，在下面的代码中

```
ResultSet rs = qw.DBquery("select distinct manufacturer from Products order by manufacturer asc");
try {
    while (rs.next()) {
        table+= "<tr><td><a href=\"getItems?manufacturer="
                + rs.getString("Manufacturer") + "\">"
                + rs.getString("Manufacturer") + "</a></td></tr>\n";
    }
} 
```

其输出包括：

```
Adobe 
Adobe Acrobat 
IBM 
IBM - Workstations 
```

如果我单击一个，链接会以如下方式到达 URL：

```
http://localhost/getItems?getItems?manufacturer=Adobe%20Acrobat 
```

但是，当我得到制造商变量及其值时

```
String manufacturer = request.getParameter( "manufacturer" );
ResultSet rs1 = qw.DBquery("select * from products where Manufacturer like '"
                           + manufacturer + "'"); 
```

如果制造商的值中有空格，则查询输出失败并且不会产生任何内容。关于如何将其转换回来的任何想法或解决方法？我需要做某种 urldecode 吗？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T02:11:18.960

将 URL 中的空格编码为 %20 是正确的，并且 Web 应用程序容器负责 URL 解码。

```
String manufacturer = request.getParameter( "manufacturer" ); 
```

因此，程序中的字符串`manufacturer`应包含“Adobe Acrobat”（带有空格）。您可以验证（通过将其记录到某个地方）吗？

```
"select * from products where Manufacturer like '"+ manufacturer + "'" 
```

另外，请使用绑定变量。直接将查询参数（也无需任何验证！）插入 SQL 会使您完全容易受到 SQL 注入攻击。这对性能也不利。

```
"select * from products where Manufacturer like ? " 
```

# python - python random.random() 在自定义模板标签中使用时导致“'模块'对象不可调用”

> ID：837916
> 
> 赞同：8
> 
> 时间：2009-05-08T01:55:26.750
> 
> 标签：python, django, random, templatetags

如果我从命令行启动 python 并输入：

```
import random
print "Random: " + str(random.random()) 
```

它给我打印了一个随机数（预期，非常好）。

如果我在我的 django 应用程序的 models.py 中包含上述两行并使用 runserver 启动我的 django 应用程序，我会在命令行上看到一个随机数的输出（太棒了！）

如果我采用自定义标签，否则效果很好，但我包括

```
import random
print "Random: " + str(random.random()) 
```

作为自定义标记的 .py 文件的前 2 行，每当我尝试打开使用该自定义标记的模板时都会收到错误消息：

```
TypeError at /help/
'module' object is not callable 
```

请记住，如果我去掉这两行，我的自定义标签的行为与预期相同，并且不会引发错误。不幸的是，我的模板标签内需要一些随机行为。

问题是如果在自定义标签中我这样做：

```
import random 
```

在自定义模板标签上，它导入

```
<module 'django.templatetags.random' from '[snip path]'> 
```

并不是

```
<module 'random' from 'C:\\Program Files\\Python26\\lib\\random.pyc'> 
```

通常是从其他地方进口的

Django 模板库有一个称为随机的过滤器，不知何故，它的优先级高于系统的随机。

任何人都可以推荐如何显式导入正确的 python 随机数吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-08T03:39:10.027

答案是……奇怪。

当我最初编写自定义标签时，我将其命名为`random.py`. 我很快意识到这个名字可能不好，并重命名`randomchoice.py`并删除了我的`random.py`文件。Python 保留了编译后的`random.pyc`文件，每当我这样做时，它就会被加载`import random`。我删除了我的 random.pyc 文件，问题就消失了。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-02-21T19:39:35.120

是的，这种错误很容易。基本上不要命名您的任何文件名或您创建的任何与您将要使用的任何可能的 Python 模块同名的名称。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-08T02:28:47.607

自从我修补 Django 以来已经有一段时间了，但是如果 random.random 是一个“模块”，那么请尝试 random.random.random()。或者也许只是尝试随机（）。你只是不知道幕后发生了什么样的黑客行为。

**编辑**

试试这个：

```
sys.path = [r"C:\Program Files\Python26\lib\"] + sys.path
import random
sys.path.pop(0) 
```

# linux - 外壳中的 GtkDialog

> ID：837925
> 
> 赞同：0
> 
> 时间：2009-05-08T01:58:43.777
> 
> 标签：linux, user-interface, shell, gtk

我在 shell 脚本中使用 gtkdialog 但我卡住了。我尝试“使用标记”来格式化字体，但它似乎不起作用。没有类似的东西吗？如果程序有几个小部件，布局总是混乱......有解决方案吗？或者关于 gtkdialog 的好教程？（我搜索但除了用户手册之外找不到一个）。编辑：我正在尝试更改字体，为其着色。我已经解决了布局混乱的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T19:47:44.873

use-markup 意味着文本将使用[Pango Text Attribute Markup Language](http://library.gnome.org/devel/pango/stable/PangoMarkupFormat.html)设置样式。您必须相应地标记您的文本以获得所需的字体/样式/颜色/等。

# jquery - JQuery - 通过 JQuery 触发 MVC 控制器操作的最佳方法是什么？

> ID：837929
> 
> 赞同：0
> 
> 时间：2009-05-08T01:59:51.357
> 
> 标签：jquery, ajax

基本上，我在过滤列中有几个单选按钮。例如，如果我在 \Catalog\Flooring\Harwood 部分，我有 [Area Rugs]、[Carpet] 和 [Stone & Tile] 的单选按钮。所以，我想要做的是，而不是在单选按钮下嵌入标签，我想触发一个 JQuery 事件并定期发回服务器。我认为 $.post() 应该这样做，但我没有让它正常工作。

PS：无论如何要在我的 JS 文件中嵌入/包含 jquery-1.3.2-vsdoc.js 文件，以便获得完整的智能感知？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T02:07:02.387

这是一个使用 MVC 控制器操作上下移动项目的 ajax 调用：

```
 [ActionName("item-reorder")]
    [AcceptVerbs(HttpVerbs.Post)]
    public string ItemReorder(Guid id, string direction)
    {
        ReorderDirection dir = (ReorderDirection)Enum.Parse(typeof(ReorderDirection), direction, true);
        int newSequence = this.WebServiceProxy.MoveItem(id, dir);
        if (newSequence >= 0)
            return ConfigurationManager.AppSettings["Ajax:Success"];
        else
            return ConfigurationManager.AppSettings["Ajax:Fail"];
    } 
```

和javascript：

```
AjaxMoveItem: function(row, direction) {
    //get the id from the attribute
    var itemId = row.attr('itemId');
    //update server
    $.ajax({
        type: 'POST',
        url: '/item-reorder',
        //data: ({ id: itemId, direction: direction }), //didn't work .. vars passed as null
        data: ({ id: itemId, direction: direction }),
        success: function(responseText) {
            if (responseText == 'success') {

                alert('moved');
            } else {
                alert('error: ' + responseText);
            }
        },
        error: function() {
            alert('unknown error');
        }
    });
}, 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T02:38:05.337

您可以使用 GET - 这将获取 /Catalog/Flooring/Harwood/

```
$(function() {
   $('input[type=radio]').click( function() {
       location.href = '<%= Url.Action( "Harwood", "Catalog/Flooring" ) %>' + '/' + $(this).val();
   });
});

<input type='radio' id='rugsRadio' name='typeRadio' value='AreaRugs' />
<input type='radio' id='carpetRadio' name='typeRadio' value='Carpet' />
... 
```

或者您可以使用 POST——这将使用所选 typeRadio 作为表单参数来发布 /Catalog/Flooring/Harwood：

```
$(function() {
    $('input[name=typeRadio]').click( function() {
        $('form#typeForm').submit();
    });
});

<% using (Html.BeginForm("Flooring","Catalog", new { id = "Harwood" })) { %>
    <input type='radio' id='rugsRadio' name='typeRadio' value='AreaRugs' />
    <input type='radio' id='carpetRadio' name='typeRadio' value='Carpet' />
    ...
<% } %> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T07:20:32.040

初始化：

```
$(document).ready(function() {
    // Bind actions...
    $("#Navigation li[title]").live("click", function(e) { e.preventDefault; this.blur(); return updateNavigation($(this).attr('title')); });
    $("#ItemsPerPage").change(function(e) { return updatePaging(); });

    $('input[name=ProductType]').click(function() { return updateRadio(); });  //{ $('form#typeForm').submit(); });
    $(":checkbox").change(function(e) { return updateCheck(); });
}); 
```

响应 ProductType 单选按钮事件：

```
function updateRadio() {
    var productGroup = $("#valProductGroup").attr('title');
    var productType = $("input:radio[checked]").val();
    var url = "/Catalog/" + productGroup + "/" + productType;

    window.location = url;
    return false;
} 
```

谢谢大家。

# javascript - jQuery 事件处理程序未在 IE 中触发

> ID：837931
> 
> 赞同：6
> 
> 时间：2009-05-08T02:00:33.413
> 
> 标签：javascript, jquery, javascript-events, jquery-1.3

我在页面上有一个项目列表，其中包含一组用于 MoveUp、MoveDown 和 Delete 的控件。

默认情况下，控件位于隐藏列表的顶部。当您将鼠标悬停在项目行上时，我使用 jquery 选择控件

```
//doc ready function:
..
var tools = $('#tools');
$('#moveup').click(MoveUp);
$('#movedn').click(MoveDn);
$('#delete').click(Delete);
..
$('li.item').mouseover(function(){
    $(this).prepend(tools);
}); 
```

这在 Firefox 中效果很好。工具移动到当前行，点击事件调用 ajax 函数。但是，在 IE6 和 IE7 中 .. 没有点击发生。我尝试在鼠标悬停时取消绑定并在每次鼠标悬停时重新绑定......但无济于事。

我还调查了 javascript 之外的各种原因（例如透明 png 冲突、z-index、位置：绝对）.. 也没有找到解决方案。

我最终需要为每个项目添加一个工具行，并在鼠标悬停/移出时显示/隐藏。效果一样好——唯一令人沮丧的是我的页面上有更多的“工具”标记。

有谁知道为什么 IE 在移动对象后会忽略/丢弃/杀死鼠标事件（使用前置）？为什么事后重新绑定事件也没有效果？在我放弃之前，让我恼火了将近 2 个小时。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-08T02:06:42.230

IE 将丢失事件，具体取决于您向 DOM 添加内容的方式。

```
var ele = $("#itemtocopy");

$("#someotheritem").append( ele ); // Will not work and will lose events

$("#someotheritem").append( ele.clone(true) ); 
```

我还建议在点击事件上使用 .live() 来稍微简化您的代码。Live 尚不支持鼠标悬停/移出。[http://docs.jquery.com/Events/live](http://docs.jquery.com/Events/live)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-02-10T05:10:06.253

我只是花了一整天的时间来排除事件没有触发附加到 DOM 的项目（IE7，jQuery 1.4.1），这不是因为我需要使用 live()（不过，很高兴知道，Chad），也不是这是因为我需要克隆这些项目。

这是因为我选择了其中有“#”的锚标签，如下所示：

```
var myitem = $('a[href=#top]'); 
```

我的解决方案是像这样使用“属性包含选择器”：

```
var myitem = $('a[href*=top]'); 
```

幸运的是，我有足够的控制权来控制它在未来不太可能破坏的一切。这在技术上与附加对象无关，但希望它可以节省一些时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-14T04:50:11.207

我有一个类似的问题。尝试使用 .ready 在初始页面加载时加载 div。在 FF 中运行良好，但在 ie7 中运行良好。

我发现了一个似乎可以解决这个问题的黑客。

我有负载调用回调，divLoaded()。

在 divLoaded 我检查 $('#targetdiv').innerText.length < 50 或任何你认为会表明它没有加载的东西。如果我检测到这种情况，我只需调用函数 taht 再次加载该 div。

奇怪的是，我还添加了一个“。” 在我回忆起 ajax 函数之前到 innerText。似乎有时我们在 ajax 加载最终需要之前要经过 3 或 4 个循环。

这让我认为 document.ready 在 IE7 中工作得非常完美，这似乎消除了一些关于它不可靠的神话。真正“似乎”发生的是 .load 有点不稳定，并且在刚刚加载页面时无法正常工作。

我对所有 jQuery 的东西还是有点绿，所以把这个和一粒盐一起吃吧。有兴趣听听任何人对我的小假设的看法。

干杯

格雷格

# security - 如何防止虚假高分出现在全球高分榜上？

> ID：837935
> 
> 赞同：14
> 
> 时间：2009-05-08T02:01:11.010
> 
> 标签：security, networking

假设您正在设计一个记录高分的 PC 游戏。除了保持本地分数外，还设置了一个全球高分服务器，游戏可以通过互联网访问该服务器。玩家应该能够在完成游戏后立即将他们的高分提交到全球高分列表，或者稍后从他们的本地高分列表中提交。这一定是一个普遍的问题；现代游戏机上的街机游戏通常具有这样的全球高分榜。

我的问题归结为：**您如何防止某人提交虚假的高分？**或者，换一种说法，全球高分服务器如何确定提交的分数确实是通过游戏运行产生的？

我越想越觉得这可能是一个无法解决的问题。

验证消息是否来自某个来源的通常做法是让来源对消息进行数字签名。在这种情况下，您当然可以这样做，但真正的问题是播放器拥有该软件，也拥有该软件的私钥。不管它多么模糊，它都可以被逆向工程，甚至只是从记忆中提取出来。

另一种选择是将玩家游戏的回放发送到高分服务器，该服务器将快速运行回放并验证提交的分数是否与回放的结果匹配。这并不能解决问题，但如果你还必须制作一个非常复杂的回放来“证明”它，那么它肯定会让伪造一个虚假的高分变得更加困难。

这是一个有解决方案的问题，还是真的无法解决？家用游戏机开发人员是否使用了技术来防止这种漏洞利用，或者他们只是依靠控制台来防止未经授权的代码运行？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-08T02:37:41.657

“另一种选择是发送玩家游戏的回放……这并不能解决问题，”

真的吗？为什么不？

“你还必须制作一个非常复杂的回放来“证明”[分数]。”

你是在暗示有人可以伪造回放吗？在没有实际玩游戏的情况下推理出一个超高分的解决方案？伪造时间戳和一切？拉唐纳德克[劳赫斯特](http://en.wikipedia.org/wiki/Donald_Crowhurst)？

为什么不只是玩游戏而不是试图伪造玩游戏的日志？

或者……如果很容易伪造导致超高分数的游戏历史，那么可能是游戏设计错误。如果游戏是“硬”的，那么这个人必须做出所有正确的选择。如果游戏很简单，那么分数并不能反映玩家的选择并且是伪造的。

这样想吧。选择任何游戏或运动。有人说——比如说——瑞士在游艇比赛中击败了新西兰。您将通过寻求有关场地、船只、团队和个人比赛的详细信息来挑战他们，以说服自己这是真的。当然，他们可以伪造，但如果他们有丰富的比赛细节，那么……那怎么不是“证据”？

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-08T02:05:53.840

据我所知，这是无法解决的。

我见过很多人试图混淆加密密钥。我见过一些人包括其他健全性检查，例如经过的时间或剩余的敌人。我从来没有见过一个发送重播的，当然这是可能的。

在一个未命名的网站中，他们设置了一个很容易找到的虚假发送高分例程。如果犯罪者使用它，他们的 IP 地址将被自动禁止未来更新。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-08T02:21:25.377

对于由客户端生成分数的 PC 游戏，这不是一个可解决的问题，因为客户端本质上是不可信的。

您唯一可以尝试做的就是让某人更难提交假分数。

一些想法：

*   保护内存中的分数。您可以使用[CryptProtectMemory](http://msdn.microsoft.com/en-us/library/aa380262.aspx)之类的 API将分数隐藏在内存中 - 简单的内存写入将不起作用。但是，使用附加的调试器或通过将代码注入您的进程，他们仍然可以修改分数。您可以查看各种尝试击败调试器的方案。

*   在通往服务器的途中保护分数。您可以按照您的建议对发送到服务的数据进行加密，但是由于不受信任的一方可以控制密钥，因此这只是混淆，并没有提供可靠的保护。

*   在服务中验证分数。除了非常简单的检查之外，我不愿意这样做。此处的错误将导致您拒绝有效分数。将不可能区分作弊者和强者。

在这一点上，你真的要问问自己，工程上的努力是否真的值得。如果有人发布无效分数怎么办？你实际上失去了什么？我会做最起码的事情来用一个简单的脚本来保护一个孩子。即，不要让您的分数提交只是：

```
http://myservice.com/submitscore.aspx?PlayerName=Michael&Score=999999999 
```

我会在内存中使用简单的保护来防止偶然的窥探，在网络上进行一些简单的混淆（使用服务器 cookie 散列分数）并完成。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-08T02:10:05.873

忘记密码学问题；如果您的代码可以在本地机器上被黑客入侵，您如何防止有人人为地设置疯狂的高分，然后使用现有的可信机制进行传输？

在您可以建立对代码本身的信任之前，用于通信的加密机制不会成为真正的问题。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-05-08T03:32:06.907

将（软件+随机盐）的哈希与分数一起发送。使用服务器检查此哈希。如果匹配（意味着软件未更改）接受它。否则，分数来自游戏的“修改”版本。拒绝它。每次生成哈希时随机盐应该改变（当前系统时间或类似的时间）

查看 Quake III Arena 源代码。他们的版本非常简单。不幸的是，我现在不记得链接了。

# wpf - 将网格行的高度绑定到 WPF 中的内容

> ID：837936
> 
> 赞同：13
> 
> 时间：2009-05-08T02:01:22.320
> 
> 标签：wpf, itemscontrol, resize, wrappanel, binding-expressions

我有一个有几行的网格。在第一行，我有一个 ItemsControl，它动态绑定到一个集合并使用 DataTemplateSelector 和 ItemsPanelTemplate（带有一个水平排列的 WrapPanel）。这是我迄今为止所拥有的精简版：

```
<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="40" />
        <RowDefinition Height="2" />
        <RowDefinition Height="*" />
    </Grid.RowDefinitions>
    <GridSplitter Background="#666" Grid.Row="1" Height="Auto" Width="Auto" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" />
    <ItemsControl x:Name="items" Background="#DDD" Grid.Row="0" ItemTemplateSelector="{StaticResource itemTemplateSelector}">
        <ItemsControl.ItemsPanel>
            <ItemsPanelTemplate>
                <WrapPanel Orientation="Horizontal" />
            </ItemsPanelTemplate>
        </ItemsControl.ItemsPanel>
    </ItemsControl>
</Grid> 
```

我不想将第一行的高度设置为 40，而是根据 ItemsControl 必须适合其所有内容的最小高度动态设置它。由于 ItemsControl 的高度受 Grid Row 的高度限制，我无法确定我应该绑定哪个元素以及我应该将它绑定到哪个元素的属性。

将网格行的高度绑定到 ItemsControl 的“所需高度”是有意义的。因此，我找到了 DesiredSize 属性并将我的 RowDefinition 的高度绑定到 ItemsControl 的 DesiredSize.Height。这在它第一次加载时有效，但在我调整控件大小时不会更新（请记住，我使用 WrapPanel 作为我的 ItemsPanelTemplate，所以当我调整窗口大小时，ItemsControl 的高度应该会改变）。

有谁知道绑定框架是否支持这种情况，或者我是否需要添加事件处理程序代码来完成此操作？

谢谢。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-05-08T08:28:46.523

您是否尝试将高度设置为 Auto 以实现您想要的：

```
<RowDefinition Height="Auto"/> 
```

（或者我在这里想得太简单了..？）

# multithreading - 杀死 JavaME 1.2 线程的最佳实践？

> ID：837948
> 
> 赞同：2
> 
> 时间：2009-05-08T02:07:17.017
> 
> 标签：multithreading, blackberry, java-me, kill

**问：**`WorkerThread`我很想知道在 Java 1.2中终止作为后台线程（让我们称之为这个线程）运行的长期操作的最佳实践。

### 设想

具体来说，我正在为 Blackberry 设备开发一个应用程序，通过该应用程序进行 HTTP 连接。大图：如果将 URL 请求转发到后台线程 ( `WorkerThread`)，则该线程发出请求并使用回调返回结果。

### 场景详情

现在存在这样一种情况，即在连接时存在数据连接，**但**由于某种原因（驱动通过隧道），该连接不再存在。由于 Blackberry 设计架构的限制，实际连接将挂起，因为超时固定为 2 分钟。因此，迫切需要终止已挂起相对（15 秒）长一段时间的连接。

### 我当前的解决方案 - 2 Theads？

现在我目前的解决方案是`WorkerThread`在另一个线程中运行（让我们称之为这个新线程`MonitorThead`）。`MonitorThread`开始`WorkerThread`，休眠 1000 毫秒，然后定期检查是否`WorkerThread`还活着。如果 15 秒后 WorkerThread 仍然存在，MonitorThread 将 WorkerThread 置于睡眠状态并退出。这真的是最好的方法吗？

## 问题总结及要点

总之，以下是与该问题相关的核心问题和关键限制。干杯!

***如何成功杀死卡在特定操作中的 java 后台线程？***

### 场景限制：

*   无法控制操作暂停并检查线程请求状态
*   特定于 Blackberry 的 Java ME 1.2 实现及其 [线程 API](http://www.blackberry.com/developers/docs/4.2api/java/lang/Thread.html)，因此没有显式 的**kill()**方法
*   最关心的是最佳实践以及如何最安全地杀死持有线程。

* * *

**跟进/编辑**
Neil Coffey 建议我只保留对连接对象的引用，然后在该对象上调用**close()**。我目前正在研究这个...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T02:20:03.650

如何杀死一个线程是一个难题。没有保证能够停止或中断线程的方法。但是，如果您采用当前架构并且在超时时，只需关闭流（而不是[Connection](http://www.blackberry.com/developers/docs/4.2api/javax/microedition/io/Connection.html#close())），这应该会导致 I/O 异常发生在卡在 I/O 中的线程上。如果它不会导致 IOException，那么它至少应该导致读取或写入返回 EOF。

请注意，关闭 Connection 无济于事，正如 JavaDoc 所说：

> 任何打开的流都将导致连接保持打开状态，直到它们本身关闭。

您必须关闭从 Connection 派生的流。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T02:20:34.973

好吧，最佳实践通常是关闭连接，然后让其后果波及线程，让它干净地退出。

你是如何建立联系的？与其等待它超时，你有什么机会强迫它关闭？你能得到一些连接对象吗？黑莓是否有其他命令可以执行来终止给定的连接？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T14:56:46.083

我一直认为在原子事务中将标志传递给后台线程是要求线程停止的最佳方式。如果它没有停止一段时间，杀死它。

好吧，除此之外，如果您认为 2 分钟很长，那对您有好处。我会让用户决定取消按钮的时间长。

# winforms - 如何处理复杂的winform对象数据绑定？

> ID：837950
> 
> 赞同：1
> 
> 时间：2009-05-08T02:08:00.743
> 
> 标签：winforms, data-binding

关于将数据绑定到对象的最佳实践或技巧是什么？

我有一个复杂的数据绑定场景，其中我的 winform 将 BindingSource 设置为一个对象。该对象是 Customer 类型的类，表单绑定了客户的属性，如“firstName”、“lastName”等。

每个属性都有以下模式（伪代码）

*   获取：返回 mProperty
*   设置：mProperty = 值；PropertyHasChanged()

对某些属性的某些更改需要自动设置其他值。例如：

*   选择一个国家将加载第二个下拉列表，其中包含州/省列表
*   选中复选框（数据绑定到布尔属性）会将国家和州/省设置为特定值

我应该将根据复选框设置国家和州/省的代码放在哪里？如果我以错误的顺序设置属性，（国家的省份）更改国家将强制更改省份列表并覆盖所选省份，因为它不会在列表中（这是一个简单的例子，但反映了时间问题）。

关于将数据绑定到对象的最佳实践或技巧是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-08T20:03:43.443

Binding doesn't have to be one to one. You can listen on a Country or Checkbox change to determine the province for example.

What you have though looks like a state flow, in a given state, do X. Add a 'hidden' property that correctly represents the state you want to use for your bindings: PreDefined, Normal, Advanced and then the binding can also act on this as a 'tip' to know how to properly display itself.

I hope this helps.

# java - 有没有一种优雅的方式来处理二十一点中的王牌？

> ID：837951
> 
> 赞同：15
> 
> 时间：2009-05-08T02:08:49.730
> 
> 标签：java, blackjack

我的孩子有一个家庭作业是用 Java 编写 Blackjack。我帮助了他一点，但大部分都是他自己做的，而且实际上打得很好。他甚至在计算手牌价值时发现了一个我没有看到的错误。然而，有一个他没有处理过的问题，而且我能想到的每一个解决方案都非常复杂，远远超出了他能够用他仍然初级的 Java 技能轻松编写代码的能力。

王牌。事实上，不仅仅是一张 A，还有四张 A，而且你可以在一手牌中拿到全部四张。当有一个或多个 A 时，你如何优雅地计算一手牌的价值，每个 A 的价值可能为 1 或 11。我觉得应该有一个优雅的算法，但我没有看到它。当然，部分原因可能是我累了，但也许你可以帮忙。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-08T02:15:43.863

只需将每个 A 视为 11。然后当值超过 21 时，从您手中的每个 A 的总数中减去 10。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-08T02:38:09.813

您将只使用 1 个 ace 来获得 11 分。因此，除最后一个 ace 以外的所有点都计算为 1，如果点数为 10 或更少，则最后一个 ace 计为 10。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-09-16T22:13:25.977

Only 1 Ace ever counts as 11.

So, an alternative method to treating each Ace as 11 would be to treat every Ace as 1. Then add 10 to the total value ( carried regardless of Ace on hand ) and keep that in a separate "high" variable ( value + 10 ). Also create a boolean of ~ ace:true if (any) ace comes up.

And so when checking the score against the dealer; check if the players' hand has (any) Ace, in which case you ( can ) use the "high" value, otherwise ( no Ace ) use the "low" value.

That way King + 9 + Ace ( bad example perhaps ) would be ~ low:20 & high:30 & ace:true - With that information you can check if 30 - 10 will "win the game". So, King + 5 + 5 ( low:20 high:30 ace:false ) will not use it's high value of 30.

I'm using this method so I know when to show an alt. Ace score onscreen; like 3/13 ( Ace + 2 ), using the same ace:true|false boolean I already have. This is surely the same answer as the first one given, but this makes more sense to me :)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-08T02:22:19.867

不管每个 ace 应该算什么总和为 11，然后当总和超过 21 时，从手上减去 10，但问题是你必须确保你记下你减去 10 的次数和多少次加 11（一张 ace）的次数，

加 11 >= 减 10 -*必须始终满足*

**算法示例：**

```
int sum=0;
int ace=0;
int subtract=0;
while(!busted or !stay)
{
  Hitme(value);
  if(value=11)ace++;
  sum+=value;
  if(sum>21) 
  {
      if(ace>=1)
      {
         if(ace>=subtract)
         {
           sum-=10
           subtract++;
         }
         else
         {
            busted;
         }
      }
      else
      {
          busted;
      }
  }
  else
  {
    hit or stay;
    //of course if sum== 21 then force stay

  }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-10-17T20:16:58.463

类似于elundmark的回答......

您很可能有一种评估二十一点手牌价值的方法。始终在某一时刻重视 A。如果一手牌中有一张 A，计算一个硬值（所有 A 都是 1，+10）和一个软值（所有 A 都是）。

如果硬值不是半身像，则返回硬值。如果硬值是半身像，则返回软值。

示例 1
2, A, A
硬值 2 + 1 + 1 + 10 = 14
软值 = 2 + 1 + 1 = 4

hard value < 21, 所以返回 hard value (hand value 是 14)

例子 2
2, A, A, 8
硬值 = 2 + 1 + 1 + 8 + 10 = 22 (胸围)
软值 = 2 + 1 + 1 + 8 = 12

硬值 > 21，所以返回软值（手值是 12）

对规则和游戏方式的传统思考是，A 的值是有条件的，可以有两个值，1 或 11。这个概念很难实现。对于程序员来说，将所有 A 计为 1 并有条件地在手牌值上加 10 点要容易得多。这样，您的卡的等级或价值实施可以保持僵化和直接。我之前通过返回一组值和其他几种方法对此进行了试验。这是一种痛苦，不值得仅仅为了一个 Ace 等级。

如果您想在屏幕上显示一个 alt（如 2/12），而不是返回一个整数，只需返回一个“BlackjackValue”对象，其中包含一个整数和一个字符串对象，该对象是您在评估您的手牌价值的方法中创建的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-06-26T13:20:13.557

```
short aces_count = 0;
short non_aces_sum = 0;
short global_sum = 0;

foreach card in _card:{
    if( card.value != 11 ){ // assuming ace value is 11
        if( card.value > 10 ) 
            non_aces_sum += 10;
        else
            non_aces_sum += card.value
    }else
        aces_count += 1;
}

short aces_sum = 0;
if( aces_count > 0) aces_sum = 11;

for(int i=0 ; i < aces_count - 1; i++){ // - 1 cuz already asigned first ace
    aces_sum += 1; // 2x aces == 22 so max 1 ace has value 11
}
if(aces_sum + non_aces_sum > 21)
    aces_sum = aces_count; // no need for an 11 value ace, so all are 1

global_sum = non_aces_sum + aces_sum; 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-05-08T02:12:25.943

问题是它不是确定的：你可以将一张 A 算作 1 或 11（根据我的理解规则）。但你知道你不会每次都算作 11，因为你会破产。

我认为唯一的解决方案是计算总和 <= 21 的 ace 的每个可能值的分数。

# random - CUDA 中的随机数生成器

> ID：837955
> 
> 赞同：14
> 
> 时间：2009-05-08T02:10:07.790
> 
> 标签：random, cuda, prng

我整天都在为此苦苦挣扎，我试图在我的 CUDA 代码中为线程获取一个随机数生成器。我浏览了所有论坛，是的，这个话题出现了很多，但我花了几个小时试图解开各种代码，但无济于事。如果有人知道一个简单的方法，可能是一个可以调用的**设备内核返回一个介于 0 和 1 之间的随机浮点数，或者一个我可以转换的整数，我将不胜感激。**

同样，我希望在内核中使用随机数，就像 rand() 一样。

提前致谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-11T14:51:32.517

对于任何有兴趣的人，您现在可以通过[cuRAND](http://developer.nvidia.com/curand)进行操作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-08T02:18:29.970

我不确定我理解你为什么需要一些特别的东西。任何传统的 PRNG 都应该或多或少地直接移植。[线性同余](http://en.wikipedia.org/wiki/Linear_congruential_generator)应该可以正常工作。你有一些你想要建立的特殊属性吗？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-11-20T15:33:15.100

根据您的应用程序，您应该谨慎使用 LCG，而不考虑流（每个线程一个流）是否会重叠。您可以使用 LCG 实现跨越式，但是您需要有足够长的周期 LCG 以确保序列不会重复。

一个跳跃式示例可能是：

```
template <typename ValueType>
__device__ void leapfrog(unsigned long &a, unsigned long &c, int leap)
{
    unsigned long an = a;
    for (int i = 1 ; i < leap ; i++)
        an *= a;
    c = c * ((an - 1) / (a - 1));
    a = an;
}

template <typename ValueType>
__device__ ValueType quickrand(unsigned long &seed, const unsigned long a, const unsigned long c)
{
    seed = seed * a;
    return seed;
}

template <typename ValueType>
__global__ void mykernel(
    unsigned long *d_seeds)
{
    // RNG parameters
    unsigned long a = 1664525L;
    unsigned long c = 1013904223L;
    unsigned long ainit = a;
    unsigned long cinit = c;
    unsigned long seed;

    // Generate local seed
    seed = d_seeds[bid];
    leapfrog<ValueType>(ainit, cinit, tid);
    quickrand<ValueType>(seed, ainit, cinit);
    leapfrog<ValueType>(a, c, blockDim.x);

    ...
} 
```

但是在大多数情况下，该发电机的周期可能是不够的。

老实说，我会考虑使用第三方库，例如[NAG](http://www.nag.co.uk/numeric/gpus/)。SDK 中也有一些批处理生成器，但在这种情况下，这可能不是您想要的。

**编辑**

由于这刚刚获得投票，我认为值得更新的是[cuRAND](http://developer.nvidia.com/curand)，正如该问题的最新答案所提到的那样，它是可用的，并提供了许多生成器和分布。这绝对是最容易开始的地方。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-09-01T18:11:33.900

最好的方法是编写自己的**设备**函数，这是一个

```
void RNG()
{   
    unsigned int m_w = 150;
    unsigned int m_z = 40;

    for(int i=0; i < 100; i++)
    {
        m_z = 36969 * (m_z & 65535) + (m_z >> 16);
        m_w = 18000 * (m_w & 65535) + (m_w >> 16);

        cout <<(m_z << 16) + m_w << endl;  /* 32-bit result */
    }
} 
```

它会给你 100 个随机数和 32 位结果。

如果你想要一些 1 到 1000 之间的随机数，你也`result%1000`可以在消费点或生成点取 ：

```
((m_z << 16) + m_w)%1000 
```

更改 m_w 和 m_z 起始值（在示例中为 150 和 40）可以让您每次都获得不同的结果。您可以将`threadIdx.x`其用作其中之一，这应该每次都会为您提供不同的伪随机序列。

我想补充一点，它的工作速度比 rand() 函数快 2 倍，而且效果很好；）

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-07-15T19:56:34.157

我认为对这个问题的任何讨论都需要回答 Zenna 的原始请求，那就是**线程级** 实现。特别是可以从**内核或线程中调用的****设备函数**。对不起，如果我过度使用“粗体”短语，但我真的认为到目前为止的答案并没有完全解决这里所寻求的内容。

 **cuRAND 库是您最好的选择。我很欣赏人们想要重新发明轮子（它让人欣赏并更正确地使用第 3 方库），但高性能高质量数字生成器数量众多且经过良好测试。我可以推荐的最佳信息是这里不同生成器上 GSL 库的文档：[http ://www.gnu.org/software/gsl/manual/html_node/Random-number-generator-algorithms.html](http://www.gnu.org/software/gsl/manual/html_node/Random-number-generator-algorithms.html)

对于任何严肃的代码，最好使用数学家/计算机科学家一遍又一遍地寻找系统弱点的主要算法之一。“mersenne twister”是一个周期（重复循环）大约为 10^6000（MT19997 算法意味着“Mersenne Twister 2^19997”）的东西，它特别适合 Nvidia 在线程级别使用使用线程 ID 调用作为种子的相同经纱。请参阅此处的论文：http: [//developer.download.nvidia.com/compute/cuda/2_2/sdk/website/projects/MersenneTwister/doc/MersenneTwister.pdf](http://developer.download.nvidia.com/compute/cuda/2_2/sdk/website/projects/MersenneTwister/doc/MersenneTwister.pdf)。我实际上正在努力使用这个库来实现一些东西，如果我让它正常工作，我会发布我的代码。Nvidia 在其文档站点上有一些当前 CUDA 工具包的示例。

注意：为了记录，我不为 Nvidia 工作，但我承认他们为 CUDA 的文档和抽象设计是迄今为止我印象深刻的东西。

* * *

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-08T02:25:38.737

这里有一个 MDGPU 包 (GPL)，其中包括 CUDA 的 GNU rand48() 函数的[实现](http://www-old.amolf.nl/~vanmeel/mdgpu/licence.html)。

[我在此处](http://forums.nvidia.com/index.php?showtopic=42165)的 NVidia 论坛上找到了它（很容易，使用 Google，我假设您尝试过 :-) 。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-15T20:06:01.477

我还没有为 CUDA 找到一个好的并行数生成器，但是我确实找到了一个基于学术研究的并行随机数生成器：http: [//sprng.cs.fsu.edu/](http://sprng.cs.fsu.edu/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-07-16T15:20:27.673

你可以试试[用于 GPU 的 Mersenne Twister](http://www.math.sci.hiroshima-u.ac.jp/~%20m-mat/MT/MTGP/index.html)

它基于面向 SIMD 的 Fast Mersenne Twister (SFMT)，这是一种非常快速且可靠的随机数生成器。它通过了随机数生成器的 Marsaglias DIEHARD 测试。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-02-07T15:10:48.983

如果您在 Numba for Python 中使用 cuda.jit，这个[随机数生成器](http://numba.pydata.org/numba-doc/0.33.0/cuda/random.html)很有用。

# javascript - 自动完成搜索字符串的多个部分，然后返回最可能的部分

> ID：837958
> 
> 赞同：3
> 
> 时间：2009-05-08T02:12:11.610
> 
> 标签：javascript, autocomplete

[有点像这个问题](https://stackoverflow.com/questions/824144/how-do-i-use-jquery-autocomplete-for-multiple-words)

我有很多文本片段，我每天使用很多很多次。我想构建一些可以搜索数据库的东西/最好是一个充满句子长度字符串的javascript数组，返回最有可能的一个。大多数自动完成功能会按照您输入的顺序返回您输入的内容。我不记得看到我描述的内容。

例如; 假设我的数组中有这个项目：“黄色香蕉”

当我搜索“香蕉”时，它不会显示任何东西。它仅在我输入“ayello”时才有效……等等。

当一个项目的名称中存在多个单词但在不同的位置时，是否也可以返回匹配项？

因此，例如，当我输入“ **fox quick dog** ”时，它会返回：

“**敏捷**的棕**狐**跳过懒惰的**狗**”

[从 actb.js 得到想法和问题](http://www.codeproject.com/KB/scripting/jsactb.aspx)

谢谢你帮我变得更懒

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T02:20:07.410

也许这会有所帮助：**[jQuery 快速搜索](http://rikrikrik.com/jquery/quicksearch/)**

# ruby-on-rails - 在服务器请求中幸存的 Rails 变量

> ID：837962
> 
> 赞同：1
> 
> 时间：2009-05-08T02:16:05.220
> 
> 标签：ruby-on-rails, ruby

我有一个底层的 ruby​​ 游戏引擎代码，我想使用 Web 界面让用户知道正在发生的事情并与底层动态创建的数据进行交互。

为此，我想在按下链接时创建一个新的游戏变量，并且我希望该变量在用户离开页面之前一直存在，就像 flash 对象将在用户离开页面之前及其所有内容一样存活.

我可以在控制器的显示动作中创建变量

```
 def show
    @game = $site.new_game_of_type(params[:id])
    @game.start
  end 
```

但是每当我对页面进行任何 AJAX 更新或对服务器进行任何其他请求时，变量都会消失，因此我已经开始的游戏会在我脚下消失。

我无法将这些变量设为全局变量，因为它们是在每次不同用户点击游戏链接时动态创建的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T02:38:01.203

您可以将变量放在用户的会话中，它会在请求周期之后存在。

# objective-c - ICMP 和 iPhone SDK

> ID：837964
> 
> 赞同：5
> 
> 时间：2009-05-08T02:17:05.513
> 
> 标签：objective-c, iphone, cocoa-touch

我希望在 Cocoa-Touch 中实现一个 Ping 类。从我所做的谷歌搜索和我看过的旧 c 代码来看，使用 ICMP 协议似乎是最好的方法。

我想我的问题是，iPhone SDK 是否支持 ICMP，如果不支持，CoreFoundation Network 类中是否有任何我可以使用的东西？我已经查看了 CFHost 和 CFHostStartInfoResolution(host, kCFHostReachability, &error) 但这更多的是检查主机是否存在而不是获得响应时间等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T01:04:51.910

是的，理论上你可以做到这一点。但是，上次我检查您需要以 root 身份运行才能访问发送 ICMP 跟踪所需的“原始”BSD 套接字。至少在 Mac 上是这样，所以我认为在 iPhone 上也是如此。

您可能希望查看 SystemConfiguration 框架和 SCReachability API 作为替代方案。这些都是异步的，因此您可以跟踪了解网络延迟所需的时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T02:24:39.393

不确定 CFNetwork 的东西，但不要忘记你仍然可以使用所有常见的 BSD 网络东西。

# java - 确定何时关闭 Java 中的声音播放线程

> ID：837974
> 
> 赞同：0
> 
> 时间：2009-05-08T02:21:56.623
> 
> 标签：java, multithreading, audio

我正在用 Java 播放声音文件，并且正在寻找一种简单的方法来确定声音文件何时完成播放，以便我可以终止线程。有没有一种简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-09-13T00:52:23.857

抱歉，这有点晚了，但我今天遇到了一个问题，这个问题听起来很熟悉。在一些游戏代码中，我使用 javax.sound.sampled.Clip 播放各种声音，我发现如果我没有在完成后显式调用 line.close() ，分析器中的本机线程数就会飙升-rocket 直到我收到 OutOfMemory 错误。

```
// this just opens a line to play the sample
Clip clip = AudioSystem.getClip();
clip.open( audioFormat, sounddata, 0, sounddata.length);
clip.start();

// at this point, there is a native thread created 'behind the scenes'
// unless I added this, it never goes away:
clip.addLineListener( new LineListener() {
  public void update(LineEvent evt) {
    if (evt.getType() == LineEvent.Type.STOP) {
      evt.getLine().close();
    }
  }
}); 
```

我的假设是剪辑创建了一个线程来计量将样本字节放入行中，但是在此之后线程会挂起，以防您想再次重新使用剪辑。我的第二个假设是，我的代码中的某处必须引用剪辑，反之亦然，但无论如何，上面的代码片段已经记录了问题。

希望这对某人有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-05T19:11:15.437

## 注释

您可以同步或异步播放声音。

如果你同步播放它（阻塞调用线程），你知道声音何时结束播放——然后你的代码获得控制权。

如果您异步播放它（允许创建不同的线程），辅助线程将在完成播放后立即终止。

## 附言

请分享您对内存泄漏的观察以及问题下方的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-09-03T12:48:48.167

我不使用剪辑，加载内存需要更多时间，具体取决于您正在阅读的文件的大小。我更喜欢读取字节，并使用我创建的这个方法：

```
public void play(File file) throws UnsupportedAudioFileException, IOException, LineUnavailableException, InterruptedException
{

    AudioInputStream encoded = AudioSystem.getAudioInputStream(file);
    AudioFormat encodedFormat = encoded.getFormat();
    AudioFormat decodedFormat = this.getDecodedFormat(encodedFormat);

    line = AudioSystem.getSourceDataLine(decodedFormat);
    currentDecoded = AudioSystem.getAudioInputStream(decodedFormat, encoded);
    line.open(decodedFormat);
    line.start();
    byte[] b = new byte[this.bufferSize];
    int i = 0;
    synchronized(lock){
        while(true)
        {
            i = currentDecoded.read(b, 0, b.length);
            if(i == -1)
                break;

            line.write(b, 0, i);
            if(paused == true)
            {
                line.stop();
                lock.wait();
                line.start();
            }
        }
    }
    line.drain();
    line.stop();
    line.close();
    currentDecoded.close();
    encoded.close();
} 
```

它使用这种方法：

```
protected AudioFormat getDecodedFormat(AudioFormat format)
{
    AudioFormat decodedFormat = new AudioFormat(
            AudioFormat.Encoding.PCM_SIGNED,  // Encoding to use
            format.getSampleRate(),           // sample rate (same as base format)
            16,               // sample size in bits (thx to Javazoom)
            format.getChannels(),             // # of Channels
            format.getChannels()*2,           // Frame Size
            format.getSampleRate(),           // Frame Rate
            false                 // Big Endian
    );
    return decodedFormat;    
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T02:25:24.073

为什么要杀死线程？一旦终止，它将自行消失。

如果您坚持，请设置一个可以调用的同步方法来设置“立即死亡”标志；定期检查该标志。

# php - 如何打印隐藏在 Zend_Form_Element_Select 中的 HTML 元素？

> ID：837991
> 
> 赞同：0
> 
> 时间：2009-05-08T02:30:46.883
> 
> 标签：php, zend-framework, zend-form

我有一个手动创建的表单（里面有很多 JavaScript ......）。我在服务器端使用 Zend_Form 类来验证输入等等。

有没有办法在不渲染整个 Zend_Form 对象的情况下渲染 Zend_Form_Element_Select（或任何其他元素）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T02:44:54.260

你的意思是像，

```
$element = new Zend_Form_Element_Select(...);
echo $element->render(); 
```

?

这将只呈现一个 Select 元素，而不是整个表单。

该方法在 Zend_Form_Element 类中定义，该类是所有 Zend_Form_Element_* 类的父类。有关更多信息，请参阅[API](http://framework.zend.com/apidoc/core/Zend_Form/Element/Zend_Form_Element.html#render)。

# c++ - 在 OSX 上更新 GCC

> ID：837992
> 
> 赞同：65
> 
> 时间：2009-05-08T02:31:00.533
> 
> 标签：c++, macos, gcc, compiler-construction, g++

所以我是一个新程序员，我刚刚在我的 Macbook 上安装了 XCode 来获取 GCC。我认为 Xcode 是在 OSX 上获取 GCC 的唯一方法。现在，当我在 C++ 中运行我的 Hello World 应用程序时，g++ 出现说它是 4.0.1 版，但是当我查找以 g 开头的命令时，我也看到了 g++-4.2。有没有办法让 4.2 默认而不是 4.0.1，还有没有办法将 gcc 更新到最新版本 4.4.0？

编辑：好的，所以我安装了 macports 并安装了 gcc4.4，它在终端上显示为 gcc-mp-4.4，我如何使用 gcc_select 使其默认，比如命令和东西是什么。谢谢。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-05-08T02:34:37.780

如果你安装 macports 你可以安装 gcc select，然后选择你的 gcc 版本。

```
/opt/local/bin/port install gcc_select 
```

要查看您的版本，请使用

```
port select --list gcc 
```

要选择版本，请使用

```
sudo port select --set gcc gcc40 
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2012-01-27T13:05:11.330

我知道这是一个古老的要求。但它可能对某些人仍然有用。使用当前版本的 MacPorts，您可以使用 port 命令选择默认的 gcc 版本。要列出 gcc 的可用版本，请使用：

> $ sudo 端口选择 --list gcc
> 
> ```
> Available versions for gcc:
> gcc42
> llvm-gcc42
> mp-gcc46
> none (active) 
> ```

要将 gcc 设置为 MacPorts 版本：

> $ sudo 端口选择 --set gcc mp-gcc46

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2010-09-04T18:06:00.483

我只是顺便说一下，使用软链接来实现这一点是一个可怕的、不好的、可怕的想法。

编写软件的关键之一是可重现性——您希望每次都能获得相同的结果。这些系统非常复杂，以至于您希望减少所有不可见的错误来源。

拥有软链接是一个不可见的错误来源。这是你在一个月内会忘记的事情，然后转移到另一台机器上，想知道为什么你会得到不同的结果 - 或者，你会尝试升级你的系统，你会得到奇怪的错误，因为它不是期待那里的软链接。

此外，这不能保证有效 - 特别是，不清楚您是否会获得正确的系统包含文件，这些文件在 gcc 的迭代之间肯定会发生变化。

gcc_select 是一种系统化的方式来做同样的事情，可以预测地工作，或者在最坏的情况下，您可以提交错误报告并获得最终修复或自己修复。

不幸的是:-( gcc_select 不会影响 XCode 使用哪个编译器，所以如果你需要在 XCode 中工作（我这样做），这不是要走的路。我仍然不知道那可能是什么。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-07-02T15:13:47.720

以下使用[Homebrew](http://mxcl.github.io/homebrew/)的配方帮助我更新到 gcc/g++ 4.7：

```
$ brew tap SynthiNet/synthinet
$ brew install gcc47 
```

[在此处](http://arvindrao.wordpress.com/2012/12/31/installing-latest-gccg-via-homebrew/)的帖子上找到它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-01-17T03:13:15.263

使用“gcc_select -l”

> > gcc_select -l
> 
> gcc40 mp-gcc44
> 
> > gcc_select mp-gcc44

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-08T03:11:21.437

您可以在您的机器上安装多个版本的 GCC，以选择您要使用的版本，使用完整路径调用它，例如，而不是在命令行上`g++`使用完整路径`/usr/bin/g++`（取决于您的 gcc 所在的位置）。

对于编译项目，这取决于您使用什么系统，我不确定 Xcode（我对默认 atm 很满意）但是当您使用 Makefiles 时，您可以设置 GXX=/usr/bin/g++ 等等。

*编辑*

现在有一个`xcrun`脚本可以查询以在 mac 上选择适当版本的构建工具。除了`man xcrun`我用谷歌搜索了这个关于[xcode 和命令行工具](http://www.cocoanetics.com/2012/07/you-dont-need-the-xcode-command-line-tools/)的解释之外，它几乎总结了如何使用它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-08-12T20:17:48.877

在`/usr/bin`类型

`sudo ln -s -f g++-4.2 g++`

`sudo ln -s -f gcc-4.2 gcc`

那应该这样做。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-10-14T12:54:45.383

您可以手动安装 GCC

要么通过

```
sudo port install gcc46 
```

或者您从[这里](https://gcc.gnu.org/mirrors.html)的一个镜像下载源代码，例如[这里](https://bigsearcher.com/mirrors/gcc/releases/gcc-8.1.0/)

tar xzvf gcc-4.6.0.tar.gz cd gcc-4.6.0 ./configure make

好吧，如果您有多个版本，那么您可以选择一个

```
port select --list gcc 
```

记住`port`在 mac 上称为 macport`https://www.macports.org/install.php`并将 bin 添加到您的路径中`export PATH=$PATH:/opt/local/bin`

* * *

## 回答 #9

> 赞同：-8
> 
> 时间：2010-08-14T00:06:11.460

无论 Apple 作为 xcode 中的默认 gcc（10.6 上的 4.2.1，之前的 4.0.1）提供的任何东西都经过了苹果公司的良好测试（和维护），并且是在 OS X 上构建软件的“标准”。其他一切都不是，因此，如果您想开发软件或成为 gcc/OS X beta 测试人员，请三思而后行。

# wpf - 如何删除自定义选定样式列表框项目的左侧蓝线？

> ID：837993
> 
> 赞同：1
> 
> 时间：2009-05-08T02:31:10.097
> 
> 标签：wpf, xaml, listbox

我发现这段代码将默认选择样式替换为 ListBox 中选择 ListBoxItem 的自定义样式。但是，默认样式的左侧仍然有一条蓝色的小线，我无法通过任何填充或边距更改来删除它。

如何删除该蓝线并完全确定所选 ListBoxItem 的样式？

[替代文字 http://tanguay.info/web/external/blueLineLeft.png](http://tanguay.info/web/external/blueLineLeft.png)

```
<Window x:Class="CodingContext.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:CodingContext"
    Title="Window1" Height="300" Width="300">
    <Window.Resources>

        <DataTemplate x:Key="ItemTemplate" DataType="{x:Type local:Person}">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0" Text="{Binding Path=Name, StringFormat=Name: \{0\}}" />
                <TextBlock Grid.Column="1" Text="{Binding Path=Age, StringFormat=Age: \{0\}}" />
            </Grid>
        </DataTemplate>

        <DataTemplate x:Key="SelectedTemplate" DataType="{x:Type local:Person}">
            <Grid Background="Yellow">

                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition />
                    <RowDefinition />
                    <RowDefinition />
                    <RowDefinition />
                </Grid.RowDefinitions>

                <TextBlock Foreground="Black" Grid.Row="0" Grid.Column="0" Text="Person" FontSize="14" FontWeight="Bold" />
                <TextBlock Grid.Row="1" Grid.Column="0" Text="{Binding Path=Name, StringFormat=Name: \{0\}}" />
                <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding Path=Age, StringFormat=Age: \{0\}}" />

                <TextBlock Grid.Row="2" Grid.Column="0" Text="Address" FontSize="14" FontWeight="Bold" />
                <StackPanel Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="2" Orientation="Horizontal">
                    <TextBlock Text="{Binding Address}" />
                    <TextBlock Text="{Binding City, StringFormat= \{0\}}" />
                    <TextBlock Text="{Binding State, StringFormat= \{0\}}" />
                    <TextBlock Text="{Binding Zip, StringFormat= \{0\}}" />
                </StackPanel>
            </Grid>
        </DataTemplate>

        <Style TargetType="{x:Type ListBoxItem}" x:Key="ContainerStyle">
            <Setter Property="ContentTemplate" Value="{StaticResource ItemTemplate}" />
            <Setter Property="Margin" Value="5" />
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="ContentTemplate" Value="{StaticResource SelectedTemplate}" />
                </Trigger>
            </Style.Triggers>
        </Style>

    </Window.Resources>

    <ListBox HorizontalContentAlignment="Stretch" Margin="10" x:Name="lstPeople" ItemsSource="{Binding People}" ItemContainerStyle="{StaticResource ContainerStyle}" />

</Window> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-08T05:52:37.460

我很确定这是一个错误，因为有几个人在 ListBoxItem 模板中遇到过这个问题。

要修复，只需添加：

```
<Setter Property="Padding" Value="0,0,0,0"/> 
```

到您的`ContainerStyle`模板。原来是`2,0,0,0`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T02:46:43.663

看看[这个对类似问题的回答](https://stackoverflow.com/questions/388232/wpf-listbox-image-selected-the-saga-continues/388313#388313)。基本上，如果您想重新设置 ListBox 的样式，使所选项目具有不同的背景颜色，只需更改“HighlightBrush”颜色，以便所选项目使用您想要的颜色，就更容易了。****