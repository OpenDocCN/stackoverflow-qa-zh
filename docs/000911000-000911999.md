# StackOverflow 问答 000911000-000911999

# asp.net - 从网页录制音频

> ID：911008
> 
> 赞同：9
> 
> 时间：2009-05-26T14:32:13.020
> 
> 标签：asp.net, flash, silverlight, audio-recording

我正在寻找一种解决方案，用于从用户的麦克风捕获音频并将其（最好是 MP3）发布到服务器。我需要一些可以嵌入网页的东西。

我已经看到 Flash 在哪里可以做到这一点，但我知道这种方法需要 Adob​​e 提供的昂贵的服务器端软件。我不知道 Silverlight 是否可以提供任何功能来帮助解决此问题。

我很好奇其他人做了什么。任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-26T15:17:38.593

您可以使用 Flash 和[Red5](http://osflash.org/red5)或[haXeVideo](http://www.haxevideo.com/)或服务器，两者都是开源的。关于向用户提供最终 MP3，您将需要其他东西，因为这两个工具仅记录为 FLV 格式，因为编码 MP3 需要许可证。您可以在服务器上使用诸如[FFMPEG](http://www.ffmpeg.org/)之类的东西进行转换，但仍然可以阅读有关 MP3 的小字。

祝你好运

胡安

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-12-21T16:29:21.353

SilverLight 4 现在可以录制音频了。 [http://blog.ondrejsv.com/post/Audio-recorder-Silverlight-4-sample.aspx](http://blog.ondrejsv.com/post/Audio-recorder-Silverlight-4-sample.aspx)显示将 PCM 编码为 WAV

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-26T14:34:58.023

Silverlight 目前（或在他们即将发布的 3.0 版本中）没有此功能。Flash将是要走的路。

# subsonic - SUBSONIC MYSQL SharedDbConnectionScope TransactionScope

> ID：911018
> 
> 赞同：1
> 
> 时间：2009-05-26T14:33:26.950
> 
> 标签：subsonic

**下一个代码在 SQLSERVER 中正常运行，但是当我在loadbykey**之后将 web.config 更改为使用 mySQL 运行时，连接关闭。

是否有任何配置可以在 MYSQL 中进行更改？

感谢任何帮助！

```
 //-----------------------------------------------------------
    string tipoBanco = System.Configuration.ConfigurationManager.AppSettings["tipoBanco"];
    string conexao = System.Configuration.ConfigurationManager.ConnectionStrings[tipoBanco].ToString();

    using (SharedDbConnectionScope scope = new SharedDbConnectionScope(conexao))
    {
        //-----------------------------------------------------------
        using (TransactionScope ts = new TransactionScope())
        {
            Cargo c = new Cargo();
            c.LoadByKey(9999);

            SubSonic.StoredProcedure sp = null;
            sp = new SubSonic.StoredProcedure("sp_test");
            sp.Command.AddParameter("paramTabela", "zzz", DbType.AnsiStringFixedLength, null, null);

            Convert.ToInt32(sp.ExecuteScalar());
        }
    } 
```

**web.config**

```
<SubSonicService defaultProvider="mysql" enableTrace="false" templateDirectory="">
    <providers>
        <clear/>
  <add name="mysql" type="SubSonic.MySqlDataProvider, SubSonic"
             regexDictionaryReplace="Empresaendereco,EmpresaEndereco;Empresacontato,EmpresaContato;Franqueadoendereco,FranqueadoEndereco;Franqueadocontato,FranqueadoContato;Funcionarioacesso,FuncionarioAcesso;Funcionarioendereco,FuncionarioEndereco;Funcionariocontato,FuncionarioContato;Clienteendereco,ClienteEndereco;Clientecontato,ClienteContato;Clientehistorico,ClienteHistorico;Agendastatus,AgendaStatus;Historicostatus,HistoricoStatus"
             fixDatabaseObjectCasing="true" connectionStringName="mysql"
             generateRelatedTablesAsProperties="true"
             fixPluralClassNames="false"
             generatedNamespace="ModeloDados"
             regexIgnoreCase="true"
             removeUnderscores="false"
             setPropertyDefaultsFromDatabase="true"
             generateNullableProperties="true"
             useExtendedProperties="true"
             useUtc="true" />

</providers>
</SubSonicService> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T14:47:22.850

我认为您的 TransactionScope() 和 SharedDbConnectionScope() 是错误的方式。您可以按照它们在 SubSonic 网站上的文档中列出的顺序来获取它们，但是在旧的 SubSonic 论坛上有一个讨论暗示它们应该是相反的。

当然，我将它们颠倒使用（我刚刚将我的代码摘录发布到此处的另一个答案），但我不得不说我只使用 MSSQL ATM，不能对 MySQL 发表评论。

# asp.net-mvc - 为什么强类型 Html.ActionLink 不在 ASP.NET MVC 1 中

> ID：911019
> 
> 赞同：4
> 
> 时间：2009-05-26T14:33:27.807
> 
> 标签：asp.net-mvc

好的，微软从测试版的主要 ASP.NET MVC 程序集中删除了[强类型 HTML.ActionLink](https://stackoverflow.com/questions/218256/strongly-typed-actionlink-with-asp-net-mvc-beta)，因为“[某些功能在 ASP.NET MVC 的未来版本中仍然可以发展](http://forums.asp.net/p/1335215/2689139.aspx#2689139)”

但是现在MVC正式发布了，为什么强类型`HTML.ActionLink`还没有回来呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T14:36:33.463

这是答案：[http ://haacked.com/archive/2008/08/29/how-a-method-becomes-an-action.aspx](http://haacked.com/archive/2008/08/29/how-a-method-becomes-an-action.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T14:37:00.500

我相信它被转移到了期货包中。

我认为强类型方法无论如何都会产生误导，记住，在幕后它只是一堆字符串操作，毕竟 URL 只是字符串！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T16:02:07.410

两个原因：

1.  它们目前不支持 ActionNameAttribute，因此可以说它们已损坏。
2.  没有缓存，因此它们目前比框架方法慢 10 倍。

另外，我同意 matt 的观点，即我们不应该假装 URI 不是字符串。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-09T22:02:24.263

Matt 提供的链接已移至“ [http://haacked.com/archive/2008/08/29/how-a-method-becomes-an-action.aspx](http://haacked.com/archive/2008/08/29/how-a-method-becomes-an-action.aspx) ”。而且我同意“强类型 ActionLink() 的类型化性质跳过了您更喜欢的更多内部 MVC”；但我觉得解决这个问题的方法不是放弃它并使用魔术字符串，而是改进 ActionLink() 以生成一个将映射考虑在内的链接！

# java - 您如何将每个 Collection 的项目与另一个 Collection 的项目相关联？

> ID：911023
> 
> 赞同：1
> 
> 时间：2009-05-26T14:33:58.867
> 
> 标签：java, collections, permutation

我有两个 Collection 对象，我想以一种可读的方式关联这两个对象中的每个对象（HashMap，有意创建的对象，您可以选择）。

我在考虑两个循环，一个嵌套到另一个，但也许这是一个众所周知的问题，并且有一个普遍可以理解的解决方案......

如果 Collection 对象的数量超过两个怎么办？

Joseph Daigle 评论后编辑： Collection 对象的项目都是同一类型，它们是在特定条件下可预订的酒店房间。

```
Collection<Room> roomsFromA = getRoomsFromA();
Collection<Room> roomsFromB = getRoomsFromB();
for(Room roomA : roomsFromA){
    for(Room roomB : roomsFromB){
        //add roomA and roomB to something, this is not important for what I need
        //the important part is how you handle the part before
        //especially if Collection objects number grows beyond two
    }
} 
```

编辑2：我会尽力解释得更好，抱歉问题不清楚。举个例子：一个用户要求一个双人间和一个单人间。酒店拥有 3 间双人间和 4 间单人间。

我需要将每个“双人房”与每个“单人房”关联起来，这是因为每个房间都有自己的特点，比如互联网、更宜人的景观等等。所以我需要给用户所有的组合让他选择。

这是一个简单的案例，其中只涉及两个房间对象集合，当酒店和用户都可以提供/请求更多房间类型时，您如何管理问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T15:25:50.837

您在这里尝试做的是从一组 Y 中选择 X 的所有可能排列。这是离散数学中的一个众所周知的问题，我认为它只是称为组合数学。

要解决您的问题，您需要创建一个包含所有房间类型的超级集合。如果这是一个数组或列表，您可以使用[此示例](http://docs.google.com/Doc?id=ddd8c4hm_5fkdr3b)计算从 Y 集合中选择 X 的所有可能方式。该示例将为您提供列表/数组中的索引。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T14:37:58.093

收藏品是否准确排列？

```
HashMap map = new HashMap();
for (int i=0; i<c1.Size(); i++) {
   map.put(c1[i], c2[i]);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T14:45:04.897

好吧，因为我不知道你是否需要搜索它们只有一个，所以 HashMap 不起作用。

我会创建一个接收 Pair.. 的类：

```
private static class Pair<K, T> {
    private K one;
    private T two;

    public Pair(K one, T two) {
        this.one = one;
        this.two = two;
    }

    /**
     * @return the one
     */
    public K getOne() {
        return one;
    }

    /**
     * @return the two
     */
    public T getTwo() {
        return two;
    }
} 
```

并与他们一起创建一个列表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T14:52:33.557

您的示例暗示“roomsFromB”的返回值是“roomsFromA”返回值的子集合，因此以这种方式建模会更自然：

```
class Room {
   public Collection<Room> getRoomsFromB { ... 
} 
```

然后让你这样做：

//收藏室

```
for (Room a: rooms)
{ 
   for(Room b a.getRoomsFromB){ ... 
```

当然，这是假设它们是分层建模的。如果不是，那么这是不合适的，但是在我看来，您要问的问题实际上是如何对它们之间的关系进行建模，而您尚未明确说明。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T14:54:54.817

我假设：

*   1 中的每个元素将匹配2`collection`中的单个元素 `collection`
*   集合具有相同的大小
*   集合可以排序，并且顺序匹配两个集合中的每个元素

* * *

1.  按标识每个对象的属性对两个集合进行排序（以相同的顺序）。
2.  用一个循环遍历两个集合，构建一个关系对象并将其添加到一个新集合中。

看看这是否对您有帮助：

```
public static class Room {
    private int number;
    private String name;

    public Room(int number, String name) {
        super();
        this.number = number;
        this.name = name;
    }

    public int getNumber() {
        return number;
    }

    public String getName() {
        return name;
    }
}

public static class RoomRelation {
    private Room a;
    private Room b;

    public RoomRelation(Room a, Room b) {
        super();
        this.a = a;
        this.b = b;
    }

    public Room getA() {
        return a;
    }

    public Room getB() {
        return b;
    }

    @Override
    public String toString() {
        return a.getName() + "(" + a.getNumber() + ") " + b.getName() + "(" + b.getNumber() + ")";
    }
}

public static void main(String[] args) {

    List<Room> roomsFromA = new ArrayList<Room>();
    List<Room> roomsFromB = new ArrayList<Room>();

    roomsFromA.add(new Room(1,"Room A"));
    roomsFromA.add(new Room(2,"Room A"));

    roomsFromB.add(new Room(1,"Room B"));
    roomsFromB.add(new Room(2,"Room B"));

    Comparator<Room> c = new Comparator<Room>() {
        @Override
        public int compare(Room o1, Room o2) {
            return o1.getNumber() - o2.getNumber();
        } };

    Collections.sort(roomsFromA, c);
    Collections.sort(roomsFromB, c);

    List<RoomRelation> relations = new ArrayList<RoomRelation>();

    for (int i = 0; i < roomsFromA.size(); i++) {
        relations.add(new RoomRelation(roomsFromA.get(i), roomsFromB.get(i)));
    }

    for (RoomRelation roomRelation : relations) {
        System.out.println(roomRelation);
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-26T14:59:00.767

您可能会重新考虑是否需要这个逻辑。您正在引入一个 O(n^2) 操作，它很快就会失控。（技术上 O(mn)，但我猜 m 和 n 的顺序大致相同。）

您的问题有其他解决方案吗？也许您可以创建一个包含所有 A 和所有 B 的“集合”，然后 A 和 B 中的每个对象都可以指向这个集合，而不是？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-26T15:13:23.890

你的问题很不清楚。据我了解，您想列出所有房间组合，减去重复项。这里我们使用一些代码来构建所有房间组合的二维数组。对于更多种类的房间，请放入另一个嵌套循环。

```
Collection<Room> roomsFromA = getRoomsFromA();
Collection<Room> roomsFromB = getRoomsFromB();

Room[][] combinations = new Room[roomsFromA .size()][roomsFromB .size()];

int a = 0;
int b = 0;

for(Room roomA : roomsFromA){

   for(Room roomB : roomsFromB){
      combinations [a][b] = [roomA][roomB]; //Build up array
      b++; 
   }
   a++;
}

return combinations; 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-05-26T15:20:10.973

这是一个常见的问题。它被称为[笛卡尔积](http://en.wikipedia.org/wiki/Cartesian_product)。如果您有两个像您这样的集合，我会毫不犹豫地拥有两个嵌套循环。否则，请参阅[此问题](https://stackoverflow.com/questions/714108/cartesian-product-of-arbitrary-sets-in-java/714547)。

# windows-installer - RPM 到 MSI 包装器？

> ID：911025
> 
> 赞同：1
> 
> 时间：2009-05-26T14:34:09.600
> 
> 标签：windows-installer, rpm

我想知道是否已经努力从 rpm 规范文件创建 MSI 文件，或者是否有任何好的 RPM 端口到 Windows。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T23:44:23.937

MSI 与 RPM 完全不同的架构和思维方式，所以我要问一个显而易见的问题——为什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-26T15:40:20.813

如果您想要的只是一种跨平台的方式来放置文件并执行一些操作，请查看[NSIS](http://nsis.sourceforge.net/Main_Page)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-26T15:21:19.103

也许可以在 Cygwin 包中转换 deb ？setup.hint 与 debian 包中的 controle 文件没有太大区别！

开发中...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-31T00:25:35.757

Acresso 的 InstallAnywhere 专为跨平台安装而设计： [http ://www.acresso.com/products/ia/installanywhere-overview.htm](http://www.acresso.com/products/ia/installanywhere-overview.htm)

> InstallAnywhere 为软件开发人员提供了一种快速简便的方法来编写适用于 Solaris、HP-UX、AIX、Linux、IBM i、Mac OS X、Windows 等的专业软件安装。它通过创建单个项目文件来为您的目标平台生成可靠的安装程序，从而节省您的时间。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-12-15T10:08:28.507

Cpack是您的选择之一[。](http://www.vtk.org/Wiki/CMake%3aPackaging_With_CPack)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-01-11T18:48:08.190

RPM 是为 *Nix 系统构建的。不是窗户。

# ruby-on-rails - 闪烁的图像

> ID：911027
> 
> 赞同：0
> 
> 时间：2009-05-26T14:34:22.547
> 
> 标签：ruby-on-rails, duplicates

我有来自数据库的动态图像...我希望将几张图像放在一起...就像横幅广告一样，当一个图像褪色时，另一个图像会显示...

当您单击图像时，它应该重定向到特定链接

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T14:43:50.360

此解决方案使用[jQuery](http://jquery.com)和 jQuery [Cycle 插件](http://malsup.com/jquery/cycle/)。它基本上以幻灯片放映的形式运行，一次显示一个图像。CSS 在它周围设置了一个漂亮的边框，但您可以通过调整 CSS 来消除它。循环插件有许多选项可用于调整图像的过渡方式。

```
<style>
.pics
{
    padding: 0;
    margin: 0;
    margin-left: 48px;
}

.pics img
{
    padding: 15px;
    border: 1px solid #ccc;
    background-color: #eee;
    top: 0;
    left: 0;
}
</style>
<script type="text/javascript">
    $(function() {
       $(window).load( function() { $(".pics").cycle() } );
    });
</script>

<div class="pics">
     <img alt="Banner Ad" onclick="location.href='/url/to/ad-site1.htm';" src="/url/to/img1.jpg" />
     <img alt="Banner Ad" onclick="location.href='/url/to/ad-site2.htm';" src="/url/to/img2.jpg" style="display: none;" />

     <img alt="Banner Ad" onclick="location.href='/url/to/ad-site3.htm';" src="/url/to/img3.jpg" style="display: none;" />
</div> 
```

# regex - 匹配 Switch Case 语句的正则表达式模式

> ID：911032
> 
> 赞同：0
> 
> 时间：2009-05-26T14:35:04.090
> 
> 标签：regex

我们需要根据一些业务规则识别并处理代码中的 switch/case 语句。

一个典型的 switch 语句：

`switch (a)
{
case "A":
case "B":
result = "T";
result1 = "F";
default: result = "F";
}`

我已经能够创建两种模式来匹配第一步中的开关主体以及第二步中的案例标签和正文，但是我正在寻找一个允许我提取案例标签和正文的正则表达式。

我们没有嵌套开关。

亲切的问候，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T14:42:21.533

由于 switch 语句可以嵌套，因此传统的正则表达式无法处理它们（哎呀，即使`{}`可以嵌套的事实也会破坏它们）。正则表达式只能解析[Regular Languages](http://en.wikipedia.org/wiki/Regular_language)。您需要某种形式的解析器来解析不规则的语言。根据您使用的语言（它看起来像 C，但做很多事情），可能已经有一个您可以使用的解析器（例如 C 的[Sparse](http://www.kernel.org/pub/software/devel/sparse/)）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T15:07:48.317

这里有一些东西可以开始，但它远非完美 - 表达式不识别默认值和 switch 语句的结尾（并且可能包含一些其他错误）。

```
(?sn:(case (?<label>[^:]+):[ \r\n\t]*)+(?<body>((?!case).)*)) 
```

**更新**

`case`如果正文包含作为字符串或标识符的一部分，它也会失败。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T15:36:48.723

查斯。欧文斯的评论是正确的。但对于简单的情况，您也许可以使用以下正则表达式：

```
switch\s*\((?<expression>[^\)]+)\)\s*\{\s*((default(?<case>)|case\s*(?<case>"[^"]*"|'[^']*'|\w+))\s*:\s*(?<body>((?!\s*(case\b|default\b|\}))("[^"]*"|'[^']*'|[^\}]))*)\s*)+\} 
```

要使用它，您正在使用的正则表达式引擎应该支持显式的多个命名捕获和前瞻（例如 .NET 正则表达式引擎）。请注意，除了命名组之外的所有组都可以设为非捕获组，但为了使正则表达式更易于理解，我没有在组开始处添加“？：”以使它们成为非捕获组。

然后，您将`switch`通过以下捕获为每个已识别的语句获得一个匹配项：

*   表达式：用于开关的表达式（1 个捕获）

*   case：case 标签，默认为空（但捕获成功）

*   body：案例主体，每个案例一个

case 和 body 将始终成对出现，以便您可以枚举捕获。

# java - 如何调试 JNI/C 库？

> ID：911034
> 
> 赞同：8
> 
> 时间：2009-05-26T14:35:17.507
> 
> 标签：java, c, debugging, solaris, java-native-interface

我们这里有使用 Java JNI 调用 C 库中的函数的系统。一切都在 Solaris 上运行。

我在字符串编码的某个地方遇到问题。用 C 编写的函数返回一个阿拉伯字符，但 JNI 方法接收具有另一种编码的字符串。我已经尝试设置 $NLS_LANG 和 vm 参数以相同的方式进行编码，但没有任何效果。所以我需要能够同时调试 C 代码和 Java JNI。

调试它的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T15:13:00.397

dbx 调试器（Sun Studio 的一部分）可以附加到 JVM 进程，让您在 Java 代码和本机代码之间单步执行。该功能的代号为“jdbx”，尽管它都是 dbx 的一部分。它还没有被大力推广，所以它可能有错误。当 IDE 有两个调试引擎都处理 Java 时会出现问题，但使用命令行 dbx 可以避免这些问题。

当然，可能有许多更传统的方法来调试您的特定问题，而不必使用可以混合 Java 和 C 代码的源代码级调试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T17:47:50.187

带有最新 Android 插件的 Eclipse Juno 版本支持调试。

[如何使用 Eclipse 调试 JNI 代码（Java & C/C++）](https://stackoverflow.com/questions/2762916/how-to-use-eclipse-to-debug-jni-code-java-c-c)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-12T07:53:01.570

ADT Bundle 现在直接支持这一点。任何告诉您除单击 Debug As-> Android Native Application 之外的其他操作的代码在 2013 年 5 月 12 日都已过时，除非您使用的是较旧的开发系统，否则您会感到头疼。如果是这种情况，请下载并安装最新的 ADT 包，因为它会省去很多麻烦。

# c++ - “Uint32”、“int16”等；它们是标准的 C++ 吗？

> ID：911035
> 
> 赞同：29
> 
> 时间：2009-05-26T14:35:43.823
> 
> 标签：c++

我对 c++ 很陌生，但我掌握了基础知识。在阅读其他人的代码时，我遇到了“Uint32”（各种大写形式）和类似数据类型的使用，但我找不到任何提及它们的文档。我知道“Uint32”是一个 32 位的无符号整数，但我的编译器没有。我正在使用visual c++ express，它无法识别出我所知道的任何形式。

是否有一些编译器默认读取这些数据类型，或者这些程序员将它们自己声明为类或#define 常量？

我可以看到使用它们来确切地知道你的整数有多长，因为正常的声明似乎因系统而异。使用它们还有其他优点或缺点吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-26T15:16:59.530

Unix 平台在**stdint.h**中定义了这些类型，这是在编写可移植代码时确保类型大小的首选方法。

微软的平台没有定义这个header，跨平台的时候是个问题。如果您尚未使用[Boost Integer Library](http://www.boost.org/doc/libs/1_38_0/libs/integer/index.html)，我建议您获取 Paul Hsieh 的此标头的[可移植 stdint.h](http://www.azillionmonkeys.com/qed/pstdint.h)实现，以便在 Microsoft 平台上使用。

**更新：** Visual Studio 2010 及更高版本确实定义了此标头。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-26T14:41:08.573

C99 头文件 stdint.h 定义了这种形式的 typedef `uint32_t`。据我所知，标准 C++ 没有提供带有命名空间 std 中符号的 cstdint 版本，但一些编译器可能会，而且您通常可以从 C++ 代码中包含 C99 标头。下一版本的 C++ 将提供 cstdint 标头。

您经常会看到其他人使用此主题的非标准形式（例如`Uint32_t`or`Uint32`或`uint32`等）的代码。他们通常只提供一个在项目中定义这些类型的标头。可能这段代码最初是很久以前开发的，当 C99 编译器变得普遍时，他们从不费心用 sed 替换定义。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-05-26T14:43:23.623

Visual c++ 不支持固定宽度整数类型，因为它不支持 C99。查看[我关于此主题](https://stackoverflow.com/questions/734802/fixed-width-integers-in-c)的问题的答案，了解您使用它们的各种选项。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-26T14:43:52.340

使用它们的主要原因是您不必担心在 64 位和 32 位操作系统之间切换时可能出现的任何问题。

此外，如果您要与任何新的 32 位甚至 16 位旧代码进行交互，那么它也可以避免潜在的问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-26T14:41:30.677

试试微软的 UINT32。

大写清楚地表明这被定义为宏。如果您尝试使用尚未包含该宏的其他编译器进行编译，您可以自己定义它并且您的代码不必更改。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-26T15:19:53.377

uint32*等。*由宏定义。它们解决了一个历史性的可移植性问题，即当您要求一个 int 或一个 short 时，您将获得多少位跨平台（当有比现在更多的平台选项时）几乎没有保证。（为 Mac 提供的一个现已失效的 C 编译提供了 8 位短裤！）。

# jquery - jQuery中大表的部分渲染

> ID：911039
> 
> 赞同：0
> 
> 时间：2009-05-26T14:36:35.383
> 
> 标签：jquery

我有一个大约 5,000 行的表，我使用 jQyuery 动态构建。我想知道是否有一种方法可以在构建表时以块的形式显示行，直到最终显示所有行？

我试过这个，但没有运气。到目前为止，我已经尝试了以下方法：

a）创建存根 b）获取总行并将它们分成更小的块。c) 将第一个块注入表中，并在最后一行嵌入对函数的调用，以调用下一批要加载的数据）。

不幸的是，即使这样，它也想等到一切都呈现出来。有没有解决的办法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T14:43:58.753

使用 setTimeout 生成表的下一个块，通过稍微放弃 UI 线程，它会在生成表部分时显示它们。

通过在生成代码的底部调用生成代码，您永远不会放弃线程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T14:41:45.543

为什么要在 webapp 中使用 5K 行？我强烈建议您使用分页。

否则，解决方案 c) 似乎是最好的并且应该有效。也许你只需要一些小的调整。你是用 ajax 调用来调用下一批数据吗？当它加载下一批数据时，你看到了什么？浏览器卡住了吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T14:43:34.247

分页将是最好的解决方案。现场已经有许多优秀的 jquery datagrid 插件，例如[flexigrid](http://code.google.com/p/flexigrid/)和[jqgrid](http://www.trirand.com/blog/)。检查那些。

# html - 网络上有免费提供的 HTML URL 编码功能吗？（在 C 中实现）

> ID：911040
> 
> 赞同：1
> 
> 时间：2009-05-26T14:36:39.423
> 
> 标签：html, character-encoding

我想为我的 C 程序使用 URL 编码器。我想知道是否有任何用 C （在网络上）实现的免费可用的 URL 编码功能？？？我试着搜索它，但找不到一个:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T14:57:08.603

如果您正在使用 C 进行任何认真的开发，您应该真正考虑使用 Apache 的[Apache](http://apr.apache.org/) [Portable Runtime](http://apr.apache.org/docs/apr/1.3/modules.html)和[APR Utilities](http://apr.apache.org/docs/apr-util/1.3/group___a_p_r___util___u_r_i.html)库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T14:54:00.947

我发现[URL 的标准](http://www.faqs.org/rfcs/rfc1738.html)并不难。在大多数情况下，您甚至可以限制自己使用 HTTP URL。创建自己的 urlencoder 非常简单。

# javascript - AJAX & ASP.net，在外部文件中引用服务器控件

> ID：911042
> 
> 赞同：3
> 
> 时间：2009-05-26T14:37:18.953
> 
> 标签：javascript, ajax, asp.net-ajax, parameters, clientid

我在 ASP.NET 页面中有一些 JavaScript，如下所示：

```
var list = $get('<%=Topics.ClientID %>'); 
```

我现在编写了许多使用这种语法的函数，我想集中我的 JavaScript 并将其移动到外部 JavaScript 文件中。但是，这会中断，因为找不到“主题”。

让它发挥作用的最佳策略是什么？我假设我应该将控制/控制信息作为参数传递给函数，但我似乎无法让语法正常工作。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T14:41:27.120

您应该从返回客户端元素的 usercontol 内部创建一个 javascript 方法。然后在您的其他页面/控件中，只需访问该方法

在用户控制中

```
 <script language="javascript">
     function GetTopics() {
          return = $get('<%=Topics.ClientID %>');
     } 
 </script> 
```

在其他页面/控件中

```
 <script language="javascript">
     var list = GetTopics();
 </script> 
```

编辑-您面临的问题是您需要 Topics.ClientID 不存在的地方。因此，弥合这一差距的唯一真正方法是将其放在一个共同的地方。如果您真的不想这样做，您可以尝试通过其他一些标准来选择您的元素。如果你使用 jQuery，你可以用一个 Topics 类标记一个元素，然后用 $(".Topics") 找到它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-10T10:29:37.210

这是 ASP.NET JS 开发的常见问题。至于我，我每次都使用相同的方法，看起来不错。

我习惯了 Javascript 中的 OOP，所以我的大多数 JS 外部文件看起来像：

```
function CouponManager()
{
} 
```

在 .aspx 代码中，我这样做：

```
<script language="javascript">
    var couponManager = new CouponManager();
</script> 
```

如果我需要传递一些参数，我将类的声明更改为：

```
function CouponManager(params)
{
    // .. stuff here

    this.initialize = function(initParams)
    {
       // .. accessing initParams variable for server control IDs
    };

    this.initialize(params);
} 
```

从 .aspx 代码中，我执行以下操作：

```
<script language="javascript">
    var couponManager = new CouponManager
    ({
        txtCouponNameId = '<%= txtCouponName.ClientID %>',
        txtCouponDescriptionId = '<%= txtCouponDescription.ClientID %>'
    });
</script> 
```

这种方法允许我将 JS 与 .aspx 页面分开，并将所有服务器控件依赖项放在一个标记中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-04T13:05:58.733

如果您知道每页只有一个名为“Topics”的服务器控件，并且您使用命名约定，您可以从任何控件 Topics 继承（也许它是一个 HiddenField？您没有指定）并覆盖其 ClientId getter 以返回它的服务器ID是这样的：

[http://andreascode.wordpress.com/2009/04/27/tiny-drips-of-aspnet-juice/](http://andreascode.wordpress.com/2009/04/27/tiny-drips-of-aspnet-juice/)

然后您可以在您的 javascript 文件中知道页面中将有一个隐藏字段，其 id 设置为“主题”并直接使用它。

根据您的域/情况，这可以为您节省大量时间，也可以让您花很多时间。

# java - 实例化 Oracle 驱动程序导致 InvocationTargetException

> ID：911052
> 
> 赞同：0
> 
> 时间：2009-05-26T14:39:11.197
> 
> 标签：java, oracle, jdbc, instantiation

我有一个使用 oracle 数据库的简单 Web 服务。但是，当我在内部测试该服务时，它可以正常工作，但是，通过我的客户端（在同一台机器上但在不同的 WAR 中）调用 Web 服务会引发 invocationtargetexception。我终于发现这是实例化 OracleDriver 的问题。它根本不会抛出任何异常，所以我无法找出错误是什么。

谷歌搜索只提供了使用 oracle.jdbc.driver.OracleDriver 而不是 oracle.jdbc.OracleDriver 的解决方案，但这似乎没有解决任何问题。我正在使用的 jar 是 ojdbc14.jar，据我所知，它正确地包含在 Web 服务的类路径中……因为当我使用简单的 main 方法测试服务时它可以工作。

编辑： InvocationTargetException 由来自 Axis 服务器的 AxisFault 生成。invocationtargetexception 是一个包装类，我尝试使用 .getCause() 提取异常的尝试总是返回 null。

我正在使用 jboss 部署服务，并将驱动程序 JAR 文件包含在库中用于源但不用于服务器。在 /jboss/server/default/lib 中包含驱动程序解决了它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T15:08:56.660

没有更多的信息，很难提供具体的建议；然而，我有使用 Oracle 驱动程序的经验，该驱动程序尝试通过本机 OCI 库进行连接，无法找到系统上安装的那些库，并引发 InvocationTargetException。这一切都来自非常模糊的记忆，因此您的里程几乎肯定会有所不同。

已经有一段时间了，但如果我没记错的话，我遇到了一个连接 URL 配置不正确的情况，OracleDriver（或其包装器之一）迭代了一组可能的连接方法，试图找到一个有效的方法。在正确配置 URL 的情况下，它永远不会进行 OCI 尝试（首先尝试精简连接方法），但如果连接 URL 配置错误，则精简尝试将失败，导致 OCI 尝试，然后也失败因为主机上没有安装 OCI 客户端（导致 InvocationTargetException。）

因此，需要检查一些事项：

1.  连接 URL 是否有效？如果您在两个地方使用相同的连接 URL，您确定两个进程都绑定到同一个 NIC 吗？如果它们绑定到不同的 NIC，则可能会导致连接异常，即使在同一主机上也是如此。
2.  两种情况下的环境是否相同 - 如果 OCI 客户端在您的开发环境中使用，它可能依赖于几个环境变量。如果这些环境变量在 servlet 容器运行的环境中的设置不同，我预计会有不同的行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T15:17:25.533

2 战争？我想您的 ojdbc.jar 位于 Web 服务的 WAR 的 WEB-INF/lib 内。

也许您的 WAR 在 EAR 中，因此您应该在 MANIFEST.MF 中引用驱动程序。

更多信息：http: [//java.sun.com/j2ee/verified/packaging.html](http://java.sun.com/j2ee/verified/packaging.html)

# windows - 如何在 VBScript 中使用内部 Windows XP 选项解压缩文件

> ID：911053
> 
> 赞同：15
> 
> 时间：2009-05-26T14:39:19.200
> 
> 标签：windows, scripting, vbscript, zip

我想使用 VBScript 解压缩一个 .zip 文件，只是它始终是一台没有外部应用程序的新计算机。现在我知道 Windows XP 和 2003 有一个内部 .zip 文件夹选项，所以我想我可以通过 VBScript 使用它来提取文件。

我该怎么做？

我试过：

```
Set objShell = CreateObject("Shell.Application")

Set SrcFldr = objShell.NameSpace(fileName)
Set DestFldr = objShell.NameSpace(appDir)
DestFldr.CopyHere(SrcFldr) 
```

这没有用。可能是什么问题呢？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-05-26T17:20:25.787

只需设置 ZipFile = zip 文件的位置，并将 ExtractTo = 设置为 zip 文件应该被提取到的位置。

```
'The location of the zip file.
ZipFile="C:\Test.Zip"
'The folder the contents should be extracted to.
ExtractTo="C:\Test\"

'If the extraction location does not exist create it.
Set fso = CreateObject("Scripting.FileSystemObject")
If NOT fso.FolderExists(ExtractTo) Then
   fso.CreateFolder(ExtractTo)
End If

'Extract the contants of the zip file.
set objShell = CreateObject("Shell.Application")
set FilesInZip=objShell.NameSpace(ZipFile).items
objShell.NameSpace(ExtractTo).CopyHere(FilesInZip)
Set fso = Nothing
Set objShell = Nothing 
```

# asp.net - ASP.NET 3.5：在 Page_Load() 期间显示 UpdateProgress

> ID：911059
> 
> 赞同：2
> 
> 时间：2009-05-26T14:40:57.137
> 
> 标签：asp.net, pageload, updateprogress

我正在使用 Visual Studio 2008 构建一个 ASP.NET 站点，并有一个看起来像这样的页面（东西被剪断了）

```
<asp:Content ID="Content2" ContentPlaceHolderID="PageContentPlaceHolder" runat="server">
    <asp:UpdatePanel ID="UpdatePanel1" runat="server" UpdateMode="Conditional">
        <ContentTemplate>
            the page here..
        </ContentTemplate>
    </asp:UpdatePanel>
    <asp:UpdateProgress ID="UpdateProgress1" runat="server" DisplayAfter="100">
        <ProgressTemplate>
            <div>
                <asp:Image ID="AjaxImage" runat="server" ImageUrl="Ajax.gif" />
            </div>
        </ProgressTemplate>
    </asp:UpdateProgress>
</asp:Content> 
```

page_load 启动一个长（>5s）的过程

```
protected void Page_Load(object sender, EventArgs e)
{            
  if (!IsPostBack)            
  {
    LongRunningProcess();                
  }
} 
```

如何在 LongRunningProcess 运行时显示 UpdateProgress？当我将 LongRunningProcess() 调用移动到按钮 onclick 处理程序时，它确实有效。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T19:34:21.013

1.  Move your page_load code into a new function.
2.  Add a AJAX timer into the ContentTemplate section of your page. Set the interval to 500\. (1/2 second)
3.  Double-click on the Timer object in Design view to create a _tick handler.
4.  In the _tick handler created in the previous step, call the following code

    ```
    protected void My_Timer_Tick(object sender, EventArgs e)
    {
        My_Timer_Name.Enabled = false;
        My_Page_Load_Function(); // Function created in step 1 above)
    }

    protected void My_Page_Load_Function()
    {
        System.Threading.Thread.Sleep(5000); // A delay to simulate doing something.
        lblMyLabel.Text = "Done!";  // Write output to page. 
    } 
    ```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T16:03:29.810

我会在页面上放置一个 Ajax 计时器并将其设置为不到一秒钟......它只会运行一次，并且在第一次滴答之后您需要禁用它，否则它将再次触发。（您不想多次启动长时间运行的进程......）

然后在 OnTimerTick 事件中，我将开始您的长时间运行过程，这样您的页面就会完全呈现，并且您可以在运行时显示您的 UpdateProgress。

you out to be able to move the code that you had for your button click to the time tick...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-16T21:46:23.643

Create a normal div that shows the Ajax.gif so it shows "processing" by default.

In the javascript pageLoad() function, make a call back to the page using Ajax's PageMethods.

```
 function pageLoad(sender, args) {
                PageMethods.getVersions(LoadVersionsCallback);
    } 
```

The method you are calling in your .aspx.cs file has to be static, it can take parameters and looks something like:

```
 [System.Web.Services.WebMethod]
    public static string getVersions()
    {
      StringBuilder sb = new StringBuilder();
       ... etc.
      return sb.ToString();

    } 
```

The javascript function that you specified when you called the method will run when the method completes. It will be passed the results. At the end of this function you hide the Ajax.gif div.

```
 function LoadVersionsCallback(result) {
    // do something with the results - I load a dropdown list box.

   ...etc. 
    // here is where you hide your div holding the Ajax.gif  

   } 
```

And then you work on making whatever it is you are doing run in less than 1 second....

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-03-11T01:58:47.030

I used JBrooks idea above (i.e. showing the progress indicator as part of a Panel that also includes the Iframe, so that it shows even before the Iframe first loads), but simplified it: style the iframe so that when it does appear it is on top of the animated GIF.

Requires no Javascript or C# code-behind.

Here's the relevant ASPX, followed by the CSS. You'll have to noodle with the "top" setting in the style to cover the image you use.

```
 <asp:Panel ID="DetailPanel" runat="server" CssClass="submitBox detailPanel">
                <asp:Table ID="Table1" runat="server" Width="100%">
                    <asp:TableHeaderRow ID="TableHeaderRow10" runat="server">
                        <asp:TableCell ID="TableHeaderCell" runat="server"
                            Font-Bold="true" HorizontalAlign="Center">
                        Title Text
                        </asp:TableCell>
                    </asp:TableHeaderRow>
                    <asp:TableRow>
                        <asp:TableCell HorizontalAlign="Center">
                            <asp:Image ID="Image1" runat="server" ImageUrl="~/Images/animated_progress.gif" />
                        </asp:TableCell>
                    </asp:TableRow>
                </asp:Table>
                <div class="iframeOverlay">
                    <iframe id="IframeDetail" runat="server" style="width: 100%; height: 100%;" />
                </div>
            </asp:Panel> 
```

.iframeOverlay { z-index: 2; position: relative; top: -50px; }

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-06T19:24:34.650

With Jquery.

```
<script>
 $(document).ready(function() {
 $('#<%= UpdateProgress1.ClientID %>').show(); 
 });
</script> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-03-19T23:57:01.887

```
<script>  $(document).ready(function() {  $('#<%=
UpdateProgress1.ClientID %>').show();   }); </script> 
```

This worked well for me, just had to add it to the end of the BODY section and works like a charm.

# google-search - 谷歌网站搜索：设置为不搜索导航？

> ID：911063
> 
> 赞同：0
> 
> 时间：2009-05-26T14:41:21.147
> 
> 标签：google-search

我正在使用谷歌网站搜索，这是我购买的一个 API，我可以向它发送查询，它会向我返回一个 XML，其中包含来自我的网站的搜索结果。

它运作良好，但我想知道是否有办法限制它不在我的全局页面导航中搜索。例如，如果有人搜索品牌，并且品牌名称在我的全局导航中，那么搜索结果会返回我网站的每个页面。

我的导航带有一个 id 为“css_dropdown_menu”的 div 元素我想知道是否有办法告诉引擎忽略该元素中的任何内容？有人知道吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T14:50:28.180

我不知道任何“非常好的”解决方案，但也许（不确定它是否真的可行）您可以检测到您何时被蜘蛛用于站点搜索目的（而不是“常规谷歌搜索蜘蛛”）并提供服务当进行站点搜索爬虫（与正常访问和“常规搜索”爬虫相反）时，页面会有所不同（省略您不想编入索引的部分）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T14:46:59.230

据我所知，谷歌没有提供从搜索索引中排除某些部分的方法。不过，它非常擅长找出在许多页面上重复的内容位并减轻这些部分的权重。

# javascript - Javascript：在输入键按下时阻止表单提交

> ID：911071
> 
> 赞同：1
> 
> 时间：2009-05-26T14:42:40.783
> 
> 标签：javascript, forms, submit

我有一个网页，当我单击 Enter 键时，我有 2 个表单，我正在调用 javascript 函数来强制页面加载另一个页面。我的代码是

```
function SearchUser()
{
var text = document.getElementById("searchItem").value;
text = text == "" ? -1 : text;
var by = document.getElementById("listBy").value;   
var on="";
if(by==1)
{
    on="USERNAME";
}
else if(by==2)
{
    on="FIRSTNAME";
}
else if(by==3)
{
    on="EMAIL_ID";
}

gotoUrl="userlist.php?searchItem="+text+"&onSearch="+on; 
    alert(gotoUrl); 
window.navigate=gotoUrl; 
```

}

和

```
$(document).ready(function()
{
 $("#frmUserListSearch").keyup(function(event)
 {
  if(event.keyCode == 13)
  { 
    SearchUser();
  }
 }); 
```

});

但是当调用 SearchUSer 函数时，页面正在提交表单。我在警报中得到了正确的 url。但是页面没有在浏览器中加载

有任何想法吗 ？？？

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T14:46:24.847

```
if (document.addEventListener) {
    document.getElementById('strip').addEventListener('keypress',HandleKeyPress,false);
} else {
    document.getElementById('strip').onkeypress = HandleKeyPress;
}

function HandleKeyPress(e) {
    switch (e.keyCode) {
        case e.DOM_VK_ENTER:
        if (e.preventDefault)
            e.preventDefault();
    else e.returnValue = false;
    }
} 
```

编辑由于原始问题编辑：

所有你需要的是：

```
$(document).ready(function()
{
    $("#frmUserListSearch").keyup(function(event)
        {
            if(event.keyCode == 13)
            {     
                SearchUser();
                if (e.preventDefault)
                    e.preventDefault();
                else e.returnValue = false;
            }
        });
}); 
```

编辑以反映评论

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T14:45:36.237

返回 false 通常可以解决问题。

[http://javascript.about.com/library/bldisdef.htm](http://javascript.about.com/library/bldisdef.htm)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T15:11:35.343

我有两个建议。首先，使用 keydown 事件而不是 keyup （它在提交之前捕获“输入”更好）。其次，在 SearchUser() 函数中，使用**window.location**而不是**window.navigate**转到另一个页面。

```
$(document).ready(function() {
  $("#frmUserListSearch").keydown(function(event) {
     if(event.keyCode == 13){    
       SearchUser();
       return false;
     }
  });
}); 
```

**注意：**不要忘记删除 SearchUser() 函数中的“alert()”，因为它会导致表单在离开页面之前提交。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-20T23:26:21.483

您可以通过使用表单的 action 属性来执行此操作，而无需处理关键事件，前提是您稍后需要 javascript 对提交表单的控件执行操作。

```
 <html>
     <head>
        <script type="text/javascript">
           function donothing() {}
        </script>
     <body>
        <form action='javascript:donothing()'>
           ...
        </form>
     </body>
  </html> 
```

# c++ - 从进程监视器中隐藏的进程

> ID：911073
> 
> 赞同：4
> 
> 时间：2009-05-26T14:43:00.533
> 
> 标签：c++, mfc

我需要创建一个将读取和写入文件（C++/MFC）的应用程序。但我需要该进程不要出现在进程监视器中（SysInternals 附带）。

从其他人的反应来看，我现在确认这似乎是“非法的”。但这是我正在处理的客户的要求。所以，我想我只需要满足客户的要求。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-26T14:49:02.893

[Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)的用途之一是查找并删除试图对用户隐藏的恶意软件：

> Process Monitor 是用于 Windows 的高级监控工具，可显示实时文件系统、注册表和进程/线程活动。它结合了两个传统 Sysinternals 实用程序 Filemon 和 Regmon 的功能，并添加了广泛的增强功能列表，包括丰富的无损过滤、会话 ID 和用户名等综合事件属性、可靠的进程信息、具有集成符号支持的完整线程堆栈对于每个操作，同时记录到文件等等。**其独特的强大功能将使 Process Monitor 成为系统故障排除和恶意软件搜寻工具包中的核心实用程序。**

我并不是说你想做的事情是不可能的，而是说你正在尝试做一些感觉有点不诚实的事情。

话虽如此，我希望您考虑这样一个事实，即您正试图从一个实用程序中隐藏一个进程，该实用程序是由比您和我聪明得多的人编写的，用于查找任何东西。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-05-26T14:54:56.093

我假设您不打算做任何恶意的事情。如果是这种情况，重要的是不要将应用程序隐藏在诊断工具中。您不能保证您的应用程序没有错误。即使是这样，您也无法预测它与其他应用程序的交互。因此，您应该让它可见，以便其他技术人员可以在出现问题时进行故障排除。

关于您的评论，“所以，我想我只需要满足客户的要求” - 如果这对他们来说是非法的或技术上危险的话。您需要保护自己和他们免受错误判断。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-05-26T15:21:29.550

PM 在非常低的级别读取数据，因此要隐藏它，您必须实际接管某些 NT 内核结构和方法来向 PM 报告与 Windows 本身看到的不同的信息。这样做取决于平台和版本（即，Windows XP SP1 与 Windows XP SP2 不同，与 Vista x64 不同，等等）。如果不产生数量惊人的系统不稳定问题，几乎不可能做到正确。

虽然这并不是严格意义上的违法行为，但每家做过并被发现（你会发现）的公司都受到了用户和安全专业人士的强烈反对和批评。同样，虽然不是明显非法的，但所需的更改类型可能会在最终用户的机器上打开严重的安全漏洞。如果他们有严重的系统崩溃或暴露于黑客/病毒，您可能要对损害承担法律责任。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-26T17:11:54.897

可能的半合法（尽管我不希望我的名字与他们相关联）应用程序是 DRM 执法者和儿童和错误配偶的保姆式监控器。

也就是说，我不认为你的客户真的希望你颠覆如此重要的系统。他们可能想要一些不像 rootkit 的东西，但他们拿起了观看“24”的词汇，并且未能充分表达他们想要做什么。

我的建议是回到他们那里进行澄清。如果他们确实希望某些事情完全无法察觉，那么您需要根据自己的良心决定是继续还是离开客户。

# python - Django/Python 环境错误？

> ID：911085
> 
> 赞同：2
> 
> 时间：2009-05-26T14:45:21.653
> 
> 标签：python, django, django-syncdb

当我尝试使用时出现错误`syncdb`：

```
python manage.py syncdb 
```

错误信息：

```
File "/usr/local/lib/python2.6/dist-packages/django/conf/__init__.py", line 83, in __init__
raise EnvironmentError, "Could not import settings '%s' (Is it on sys.path? Does it have syntax errors?): %s" % (self.SETTINGS_MODULE, e)
EnvironmentError: Could not import settings '/home/simi/workspace/hssn_svn/hssn' (Is it on sys.path? Does ti have syntax errors?): Import by filename is not supported. 
```

我是 Django/Python 的新手，但在网上研究了一段时间后，我无法弄清楚这个错误。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-26T15:04:41.003

您的跟踪表明：

```
Import by filename is not supported. 
```

这可能表明您尝试导入（或设置 DJANGO_SETTINGS_MODULE）为完整的 python 文件名，它应该是一个模块路径：`your.module.settings`

您也可以尝试直接从命令行指定您的 DJANGO_SETTINGS_MODULE，例如：

```
$ DJANGO_SETTINGS_MODULE=your.module.settings ./manage.py syncdb 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-11T20:44:36.443

导致此错误的另一件事是权限 - 很难追踪。

我的解决方案是移动`<myproject>`到 /var/www/`<myproject>` 并执行 chown -R root:root /var/www/`<myproject>`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T14:52:23.057

确保您的 settings.py 文件与 manage.py 位于同一目录中（您还必须从该目录运行 manage.py，即 ./manage.py syncdb），或使环境变量 DJANGO_SETTINGS_MODULE 指向它。

# python - python监控串口

> ID：911089
> 
> 赞同：2
> 
> 时间：2009-05-26T14:46:20.027
> 
> 标签：python, pyserial

下午好，

我会询问一些有关通过串行端口监视事件的最佳方法的建议。

我正在使用 PySerial 通过串行端口向某些设备写入“命令​​”，并且

我想收到有关此设备状态的反馈。

这是最好的方法：1）填充管道并读入，2）委托为只读的新线程，还是什么？

我还可以要求一个简单的代码来实现该解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T17:13:46.423

有关使用 pyserial 的一般提示，请查看评论中建议的搜索 S.Lott。

关于实现您的应用程序的最佳策略 - 这完全取决于您的协议是如何定义的。设备是否会立即响应查询？还是他们不断发送必须监控的数据？定义这一点很重要，因为它肯定会影响您处理通信的方式。

一般来说，我发现让一个单独的线程从串行端口读取所有内容并将数据泵入`Queue`. 然后，主应用程序逻辑可以在需要时查询此队列并读取数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T07:32:21.653

选择的策略是使用 python 多处理和队列参见：

1.  [http://www.ibm.com/developerworks/aix/library/au-threadingpython/index.html](http://www.ibm.com/developerworks/aix/library/au-threadingpython/index.html) 和

2.  [http://www.ibm.com/developerworks/aix/library/au-multiprocessing/index.html?ca=dgr-lnxw9dPython-Multi&S_TACT=105AGX59&S_CMP=grsitelnxw9d](http://www.ibm.com/developerworks/aix/library/au-multiprocessing/index.html?ca=dgr-lnxw9dPython-Multi&S_TACT=105AGX59&S_CMP=grsitelnxw9d)

以供参考

# asp.net - 我可以通过 Visual Studio 从 ASP.NET 网站导出生成的 html 页面吗？

> ID：911095
> 
> 赞同：5
> 
> 时间：2009-05-26T14:47:01.133
> 
> 标签：asp.net, html, visual-studio, export

我的朋友使用 Visual Studio 在 ASP.NET 中开发网站。她只使用母版页工具，除了它是 100% 正常的 HTML 和 CSS。

有没有办法根据母版页将网站导出到 HTML 页面？

如果没有，它要么手动加载每个页面并保存 HTML，要么我编写一个小应用程序来完成它。

或者，有没有人知道实现类似目标的工具？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T14:51:06.507

我真的不知道如何将整个站点导出到本地副本。

然而，有工具 - 网站下载器。我知道一个 - TeleportPro，应该还有其他的。检查它们是否听起来是您的选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T14:52:20.857

Visual Studio 没有开箱即用的这种能力。但是，应该可以编写一个遍历站点地图的工具，从响应对象中捕获呈现的 html，然后将其写入文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T15:04:22.597

如果您想尝试一下，可以试试 Macromedia Dreamweaver。它适用于客户端和服务器端页面开发。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T15:10:08.327

使用 MasterPages 时，MasterPage 的内容与服务器端的内容页面合并（在预编译或页面的第一个请求时）。因此，您需要在某些时候通过 aspnet_compile 编译内容页面和 MasterPage。[请参阅此 MSDN 文章](http://msdn.microsoft.com/en-us/library/wtxbf3hh.aspx)的“运行时行为”部分。

您的朋友可能想要使用老式的服务器端包含（这基本上是 MasterPage 为您所做的）：

```
<!--#include virtual="/includes/header.html" -->
<!--#include virtual="/includes/nav.html" -->

<p> content </p>

<!--#include virtual="includes/footer.html" --> 
```

如果这被您选择的 Web 服务器/主机阻止（有些出于安全原因禁用它），那么我将创建一个主索引页面并使用 Ajax 调用来填充内容 DIV。当然，如果禁用 Javascript，您的访问者将看不到任何内容。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-26T15:40:18.467

我认为您需要为此推出自己的产品。这个函数访问一个 url 并获取内容：

```
 Public Shared Function GetHTTPContent(ByVal url As String) As String
    Dim req As WebRequest = System.Net.HttpWebRequest.Create(url)
    Dim encode As System.Text.Encoding = System.Text.Encoding.GetEncoding("utf-8")
    Dim sr As New StreamReader(req.GetResponse().GetResponseStream(), encode)
    Dim HTTPContent As String = sr.ReadToEnd

    sr.Close()
    sr.Dispose()

    Return HTTPContent

End Function 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T15:52:15.747

其中有很多，这里有一个：

[HTTrack 网站复印机](http://www.httrack.com/)

这也称为爬虫，因为它与搜索引擎所做的相同。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-14T19:41:32.710

这是我的快速解决方案，它在您的本地网站上抓取 .aspx 文件并在 html 旁边生成 .html 文件。

```
protected void ButtonGenerate_Click(object sender, EventArgs e)
{
    RecursivelyGenerateHtmlFiles(Server.MapPath("~/"), new DirectoryInfo(Server.MapPath("~/")));
}

private void RecursivelyGenerateHtmlFiles(string root, DirectoryInfo folder)
{
    foreach (var aspxPage in folder.GetFiles("*.aspx"))
    {
        var destination = aspxPage.FullName.Substring(0, aspxPage.FullName.Length - 4) + "html";

        if (File.Exists(destination))
            File.Delete(destination);

        var url = "http://" + Request.Url.Authority + "/" + aspxPage.FullName.Replace(root, "");
        var request = HttpWebRequest.Create(url);

        File.WriteAllText(destination, new StreamReader(request.GetResponse().GetResponseStream()).ReadToEnd());
    }

    foreach (var subDirectory in folder.GetDirectories())
    {
        RecursivelyGenerateHtmlFiles(root, subDirectory);
    }
} 
```

为我工作。

此外，您可以编辑 .bat 文件以生成包含您站点中所有 .html 文件的文件夹。这在为创意提供平面副本时很有用。

```
set folder="Generated"
cd /d %folder%
for /F "delims=" %%i in ('dir /b') do (rmdir "%%i" /s/q || del "%%i" /s/q)
cd /d ..
xcopy /r /d /i /s /y /exclude:exclude.txt PAHtml Generated 
```

这是要使用的 exclude.txt 文件

```
.dll
.cs\
.aspx
.pdb
.csproj
.user
.vspscc
.config 
```

# perl - 为什么我的 CGI 标头打印为正文的一部分？

> ID：911098
> 
> 赞同：0
> 
> 时间：2009-05-26T14:47:38.153
> 
> 标签：perl, apache, cgi

我遇到了一个奇怪的问题，可能与 Apache 而不是 Perl 有关。在我写的代码中：

```
print "content-type: text/html\n\n"; 
```

它与代码一起打印。但是当我输入：

```
$c = new CGI; $c->header(); 
```

它工作正常并显示 HTML 呈现的输出。

问题可能是什么？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T14:50:00.783

“内容类型：文本/html”是输出的第一件事吗？使用 wget 或类似方法来验证实际输出；不要相信你的眼睛或浏览器的视图源。

另请注意，在 mod_perl 下，CGI 调用请求的 send_cgi_header 方法，而不是仅打印标题。

您是否有可能在多个地方使用 CGI 的 header() ？这是无害的，但是仅用显式打印标题替换一个 header() 调用会得到您看到的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T15:10:06.657

请记住，HTTP RFC 指定

```
\r\n 
```

用于行分隔符，而不是

```
\n 
```

所以你想发射

```
print "Content-Type: text/html\r\n\r\n"; 
```

反而。

您应该只使用`->headers`though 来为您执行此操作。

另外，请注意我使用 Camel-Case 而不是小写。虽然两者都应该工作，但骆驼案例是规范中使用的符号，所以这是首选并且更有可能在奇怪的 UA 上工作。

# java - 从泛型函数返回泛型类型

> ID：911104
> 
> 赞同：3
> 
> 时间：2009-05-26T14:48:52.457
> 
> 标签：java, generics, super, return-type

我们有一个或多或少类似于以下的方法。但是我们目前返回 List ，函数 bla() 将`List<Bar>`在运行时返回。

我正在寻找一种方法来使两者

```
List<Interface> =  troubleFuction(foo, bar.getCLass());; 
```

和

```
List<Bar> = troubleFuction(foo, bar.getCLass());; 
```

可能的。基本上我希望它返回与接口兼容的 List 但这会产生以下错误

*类型不匹配：无法转换`List<capture#3-of ? extends Bar>`为`List<Interface>*`

有什么方法可以使这种返回类型成为可能，或者运行时擦除是否使这成为不可能

```
public <T1 extends Interface, T2 extends Interface> List<"problem"> troubleFunction( T1 in, Class<T2> clazz) {
  return in.doStuffWhichGeneratesAlistOF(clazz)
}

public void bla() {
  Foo foo = new Foo(); // implements interface
  Bar bar = new Bar(); // implements interface
  List<Interface> ifaces = toubleFuction(foo, bar.getCLass());
  List<Bar> mustAlsoWork = toubleFuction(foo, bar.getCLass());
} 
```

编辑：在很多现有的代码库中，该方法被称为

```
List<Bar> result = troubleFunction(List<Interface> list, Bar.class); 
```

因此这个返回类型必须保持兼容（重写/重构不是一个选项）

本质上我希望该方法返回 List`<? super Bar>`如果调用为

```
troublefunction(foo, Bar.class); 
```

当被 `List<? super Foo>`称为

```
troublefunction(foo, Bar.class); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T18:19:11.953

你没有给我们足够的信息来真正告诉你需要做什么。例如，您没有给我们类型签名`doStuffWhichGeneratesAlistOF()`或告诉我们它的作用。而且你没有告诉我们 " `in`" 参数的类型与所有这些有什么关系。

当然，方法的返回类型可以是泛型的*。*例如，

```
public <T extends Interface> List<T> troubleFunction(Interface in, Class<? extends T> clazz) {
  List<T> result = new ArrayList<T>();
  result.add(clazz.newInstance());
  return result;
} 
```

然后您可以像这样直接调用该方法并且它会起作用（您不需要显式指定类型参数，因为它是从赋值中推断出来的）：

```
List<Interface> iface = this.troubleFunction(foo, bar.getCLass()); 
```

但是看到你在上面的代码中如何返回结果`in.doStuffWhichGeneratesAlistOF(clazz)`，你可能还必须使该方法的返回类型也通用。但我真的无法帮助你，因为我们没有关于该方法的任何信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T14:53:11.277

一般来说，在这种情况下，您需要显式传递一个用于返回值的 Class 对象（一般参数化）。

但是，在您的情况下，您似乎已经这样做了，所以`troubleFunction`被宣布返回是否行不通`List<T2>`？或者，如果你想让它保持一般性，那么让它 return `List<? extends Interface>`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-16T10:32:09.183

我又看了一遍，问题是我想使用“超级”返回类型，我正在寻找的签名或多或少：

```
 public <T1 extends interface, T2 super T1> List<T2> getAList(Class<T1> clazz); 
```

这是不可能的

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T15:00:00.140

据我了解，在目标类型之前查看参数类型以推断通用参数。所以，我想你需要明确指定泛型参数，我认为它是这样的：

```
List<Interface> iface = this.<Interface>troubleFunction(foo, bar.getCLass()); 
```

在哪里

```
public <T extends Interface> List<T> troubleFunction(
    T in, Class<? extends T> clazz
) { 
```

# ms-access - MS Access 中的表单/报告事件的顺序是什么？

> ID：911113
> 
> 赞同：7
> 
> 时间：2009-05-26T14:50:28.913
> 
> 标签：ms-access, events

MS Access 中的表单、报表和子表单的事件顺序是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-26T14:56:22.770

这篇文章描述了MS Access 中[表单和子表单的事件顺序，就像这篇文章一样：](https://support.office.com/en-us/article/Order-of-events-for-database-objects-e76fbbfe-6180-4a52-8787-ce86553682f9#bm3)[表单事件](http://www.simply-access.com/Form-Events.html)。

MS Access 编程的最佳参考之一是这本书：[Access 2002 Desktop Developer's Handbook](https://rads.stackoverflow.com/amzn/click/com/0782140092)。我的 Access 97 版本有 Access 的 Event Model 的详细描述。

# windows - Windows 安全中心使用了哪些类型的控件？

> ID：911118
> 
> 赞同：0
> 
> 时间：2009-05-26T14:51:25.820
> 
> 标签：windows, controls, uicomponents, securitycenter

控制面板 -> 安全中心

我真的很喜欢用于显示是否启用了防火墙或自动更新的组件/控件。这些是 C# 或 Delphi 中的可重用控件吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T15:59:26.183

这些组件是 Windows 内部的，不能在操作系统之外使用（并且是用 C++ 编写的）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T15:05:59.613

这些是不可重复使用的。它们内置在 Windows 中，因此您需要制作您自己的这些控件的自定义版本，或者如果您想模仿它们的外观，请找到已经拥有的人。

如果您发布一个新问题（或只是添加到这个问题中）询问如何制作类似的东西，并说明您想在哪种语言/环境中进行操作，我相信我们可以为您指明正确的方向。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T15:33:12.493

是的，它们是可重复使用的（当然，因为它们在第 3 环中！！！）
只需从 ATL.DLL 加载它们（C 代码几年前已在 BBS 上发布......）
一些错误和新手的答案令人难以置信...... .

# asp.net - 如何将表单值从一个 asp.net 页面传输到另一个页面？

> ID：911129
> 
> 赞同：2
> 
> 时间：2009-05-26T14:54:07.657
> 
> 标签：asp.net

当我单击提交按钮时，我想将一个 asp.net 页面表单值传输到另一个页面。但是你知道，每个 asp.net 页面都回发给它自己。你知道有什么办法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-26T14:57:45.277

看看：[跨页发帖](http://msdn.microsoft.com/en-us/library/ms178139.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T14:57:55.760

从请求对象中检索值，或者如果需要，将表单值存储在会话中。

# perforce - 在 perforce 中恢复不在工作区中的文件

> ID：911132
> 
> 赞同：6
> 
> 时间：2009-05-26T14:54:47.810
> 
> 标签：perforce, workspace

我正在尝试从我们的 perforce 安装中删除旧用户。以前的管理员已经删除了他们所有的活动工作区/客户端，所以我们现在应该能够删除用户，但是当我运行时

```
p4 user -f -d auser
User auser has file(s) open on 1 client(s) and can't be deleted. 
```

但是，用户不再有任何关联的客户端，如果我在 P4V 中过滤挂起的更改列表视图，它会显示用户在默认更改列表中签出了一个文件，但没有指定客户端。即使我以用户身份登录，我似乎也无法恢复或对文件执行任何操作。任何提示我可以如何解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-06-07T10:47:51.817

虽然这两个命令都没有返回：

```
$ p4 clients -u <USER>

$ p4 changes -s pending -u <USER> 
```

此命令向我显示打开了哪个文件：

```
$ p4 opened -u <USER>
//depot/path/to/file#1 - edit default change (text) by <USER>@<CLIENT> 
```

此命令不起作用：

```
$ p4 -u <USER> -H <CLIENT> revert -k //depot/path/to/file
//depot/path/to/file#1 - belongs to user <USER>, not reverted 
```

删除客户端会：

```
$ p4 client -o <CLIENT> > <CLIENT>.txt
$ p4 client -d -f <CLIENT>
$ p4 opened -u <USER>
File(s) not opened anywhere. 
```

FTW！\o/

如果需要，您可以使用以下命令重新创建客户端：

```
$ p4 client 
```

然后读入`<CLIENT>.txt`您使用输出创建的文件`p4 client -o <CLIENT>`并保存。

更多信息：http: [//answers.perforce.com/articles/KB_Article/Reverting-Another-User-s-Files](http://answers.perforce.com/articles/KB_Article/Reverting-Another-User-s-Files)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T10:02:05.110

解决了。

有点奇怪，但这就是我所做的。我得到了包含该文件的默认更改列表的详细信息。它的工作区名称是机器的名称。我登录到机器，然后以用户身份进入 perforce。此时我可以看到挂起的更改列表并恢复文件。现在我可以删除用户了。

这怎么发生的？

我认为必然发生的是客户的混乱。不久前，我更改了该机器（其构建服务器）上相当多客户端的所有者，其中一些客户端必须为旧用户打开文件。这是我能想到的唯一解释。

# ios - 创建类似于邮件应用程序菜单的 iPhone 弹出菜单

> ID：911137
> 
> 赞同：21
> 
> 时间：2009-05-26T14:56:02.723
> 
> 标签：ios, objective-c, cocoa-touch, uiview

当您想回复消息时，我想创建一个类似于邮件应用程序中的弹出菜单。我在不止一个应用程序中看到过这种情况，所以我不确定框架中是否有内置的东西或一些示例代码。

![UIActionSheet 示例](https://i.stack.imgur.com/ia15x.jpg)

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2015-10-07T12:18:36.127

# 在 Swift 中创建操作表

*代码已经用 Swift 5 测试过*

[![在此处输入图像描述](https://i.stack.imgur.com/PgnaK.png)](https://i.stack.imgur.com/PgnaK.png)

从 iOS 8 开始，使用`UIAlertController`组合 with `UIAlertControllerStyle.ActionSheet`。`UIActionSheet`已弃用。

这是在上图中生成操作表的代码：

```
class ViewController: UIViewController {

    @IBOutlet weak var showActionSheetButton: UIButton!

    @IBAction func showActionSheetButtonTapped(sender: UIButton) {

        // Create the action sheet
        let myActionSheet = UIAlertController(title: "Color", message: "What color would you like?", preferredStyle: UIAlertController.Style.actionSheet)

        // blue action button
        let blueAction = UIAlertAction(title: "Blue", style: UIAlertAction.Style.default) { (action) in
            print("Blue action button tapped")
        }

        // red action button
        let redAction = UIAlertAction(title: "Red", style: UIAlertAction.Style.default) { (action) in
            print("Red action button tapped")
        }

        // yellow action button
        let yellowAction = UIAlertAction(title: "Yellow", style: UIAlertAction.Style.default) { (action) in
            print("Yellow action button tapped")
        }

        // cancel action button
        let cancelAction = UIAlertAction(title: "Cancel", style: UIAlertAction.Style.cancel) { (action) in
            print("Cancel action button tapped")
        }

        // add action buttons to action sheet
        myActionSheet.addAction(blueAction)
        myActionSheet.addAction(redAction)
        myActionSheet.addAction(yellowAction)
        myActionSheet.addAction(cancelAction)

        // present the action sheet
        self.present(myActionSheet, animated: true, completion: nil)
    }
} 
```

还需要帮助吗？观看此视频教程。我就是这样学会的。

*   [Swift 中的 UIActionSheet 示例](https://www.youtube.com/watch?v=bgyR_IIYqLA)（与名称相反，它实际上使用新的`UIAlertController`操作表而不是`UIActionSheet`.）

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-05-26T15:00:29.860

它[`UIAlertController`](https://developer.apple.com/documentation/uikit/uialertcontroller)在 iOS 8+ 上是 a，[`UIActionSheet`](https://developer.apple.com/documentation/uikit/uiactionsheet)在早期版本上是 a。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-05-26T15:23:42.213

查看 Apple 网站上的 UICatalog 示例。“警报”部分提供了有关如何使用 UIActionSheet 来完成您正在尝试做的事情的示例。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2014-04-22T16:38:28.620

您需要使用 UIActionSheet。

首先，您需要将 UIActionSheetDelegate 添加到您的 ViewController .h 文件中。

然后你可以参考一个动作表：

```
 UIActionSheet *popup = [[UIActionSheet alloc] initWithTitle:@"Select Sharing option:" delegate:self cancelButtonTitle:@"Cancel" destructiveButtonTitle:nil otherButtonTitles:
                        @"Share on Facebook",
                        @"Share on Twitter",
                        @"Share via E-mail",
                        @"Save to Camera Roll",
                        @"Rate this App",
                        nil];
   popup.tag = 1;
  [popup showInView:self.view]; 
```

然后您必须处理每个呼叫。

```
- (void)actionSheet:(UIActionSheet *)popup clickedButtonAtIndex:(NSInteger)buttonIndex {

  switch (popup.tag) {
    case 1: {
        switch (buttonIndex) {
            case 0:
                [self FBShare];
                break;
            case 1:
                [self TwitterShare];
                break;
            case 2:
                [self emailContent];
                break;
            case 3:
                [self saveContent];
                break;
            case 4:
                [self rateAppYes];
                break;
            default:
                break;
        }
        break;
    }
    default:
        break;
 }
} 
```

从 iOS 8.x 开始，这已被弃用。

[https://developer.apple.com/Library/ios/documentation/UIKit/Reference/UIAlertController_class/index.html](https://developer.apple.com/Library/ios/documentation/UIKit/Reference/UIAlertController_class/index.html)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2015-12-03T12:52:12.713

这就是你在 iOS 8+ 上的 Objective-C 中的做法：

```
 UIAlertController *alert = [UIAlertController alertControllerWithTitle:@"Directions"
                                                                           message:@"Select mode of transportation:"
                                                                    preferredStyle:UIAlertControllerStyleActionSheet];
    UIAlertAction *drivingAction = [UIAlertAction actionWithTitle:@"Driving" style:UIAlertActionStyleDefault handler:^(UIAlertAction * _Nonnull action) {
        // this block runs when the driving option is selected
    }];
    UIAlertAction *walkingAction = [UIAlertAction actionWithTitle:@"Walking" style:UIAlertActionStyleDefault handler:^(UIAlertAction * _Nonnull action) {
        // this block runs when the walking option is selected
    }];
    UIAlertAction *defaultAction = [UIAlertAction actionWithTitle:@"Cancel" style:UIAlertActionStyleCancel handler:nil];
    [alert addAction:drivingAction];
    [alert addAction:walkingAction];
    [alert addAction:defaultAction];
    [self presentViewController:alert animated:YES completion:nil]; 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-09-08T08:44:51.997

致所有在 Swift 中寻找解决方案的人：

1.  采用`UIActionSheetDelegate`协议

2.  创建并显示 ActinSheet：

    ```
    let sheet: UIActionSheet = UIActionSheet()

    sheet.addButtonWithTitle("button 1")
    sheet.addButtonWithTitle("button 2")
    sheet.addButtonWithTitle("button 3")
    sheet.addButtonWithTitle("Cancel")
    sheet.cancelButtonIndex = sheet.numberOfButtons - 1
    sheet.delegate = self
    sheet.showInView(self.view) 
    ```

3.  委托功能：

    ```
    func actionSheet(actionSheet: UIActionSheet!, clickedButtonAtIndex buttonIndex: Int){
    switch buttonIndex{
        case 0:
            NSLog("button1");
        case 1:
            NSLog("button2");
        case 2:
            NSLog("button3");
        case actionSheet.cancelButtonIndex:
            NSLog("cancel");
            break;
        default:
            NSLog("blub");
            break;
      }
    } 
    ```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-07-21T14:35:39.207

我试图在我的视图中添加 ActionSheet。所以我一直在努力寻找完美的解决方案，但有些答案让我感到困惑。因为关于Action sheet的大部分问题都是很久以前写的。而且还没有更新。无论如何...我将编写旧版本的 ActionSheet 和更新版本的 ActionSheet。我希望我的回答能够让你的大脑平静下来。

- - - - - 更新后的版本 - - - - -

```
 UIAlertController * alertController = [UIAlertController alertControllerWithTitle:@"Action Sheet" message:@"writeMessageOrsetAsNil" preferredStyle:UIAlertControllerStyleActionSheet];

    UIAlertAction* actionSheet01 = [UIAlertAction actionWithTitle:@"OK" style:UIAlertActionStyleDefault
                                                               handler:^(UIAlertAction * action) {  NSLog(@"OK click");}];

    UIAlertAction* actionSheet02 = [UIAlertAction actionWithTitle:@"No" style:UIAlertActionStyleDefault
                                                                 handler:^(UIAlertAction * action) {NSLog(@"OK click");}];

    UIAlertAction* actionSheet03 = [UIAlertAction actionWithTitle:@"Cancel" style:UIAlertActionStyleCancel
                                                                 handler:^(UIAlertAction * action) {
                                                                     NSLog(@"Cancel click");}];

    [browserAlertController addAction:actionSheet01];
    [browserAlertController addAction:actionSheet02];
    [browserAlertController addAction:actionSheet03];

    [self presentViewController:browserAlertController animated:YES completion:nil]; 
```

- - - -旧版 - - -

```
UIActionSheet *actionSheet= [[UIActionSheet alloc] initWithTitle:@"Select Sharing option:" delegate:self cancelButtonTitle:@"Cancel" destructiveButtonTitle:nil otherButtonTitles:@“OK”, @“NO”,@“Cancel”,
                        nil];
  actionSheet.tag = 100;
  [actionSheet showInView:self.view];

- (void)actionSheet:(UIActionSheet *)actionShee clickedButtonAtIndex:(NSInteger)buttonIndex {

  if( actionSheet.tag  == 100){
        switch (buttonIndex) {
            case 0:
                [self doSomething];
                break;
            case 1:
                [self doAnything];
                break;
            case 2:
                [self doNothing];
                break;
             default:
                break;
        }
        break;
    }

} 
```

# unit-testing - 如何针对 Active Directory 对 NextPasswordChangeDate 函数进行单元测试

> ID：911142
> 
> 赞同：0
> 
> 时间：2009-05-26T14:56:33.190
> 
> 标签：unit-testing, active-directory, mocking

我正在密集地使用 Active Directory 开展一个项目。我针对 AD 为几件事设置了一些单元测试，其中一些是我使用模拟对象实现的，一些是我通过对 AD 的真实调用来实现的。

作为我项目的功能之一，我必须检索所谓的“用户配置文件”。此用户配置文件主要由简单的属性组成，例如“cn”、“company”、“employeeid”等。但是，我要填写的一个属性不是简单的“NextPasswordChangeDate”。

据我所知，获得此信息的唯一方法是获取域策略的 maxPwdAge 并将此信息与 pwdLastSet 一起使用。

现在我的问题是：如何以智能的方式对此进行单元测试？我想出了三个选项，都不是很好：

1.  使用我自己的账号作为搜索账号，通过其他方式找出日期并在单元测试中硬编码。通过这种方式，我可以很好地对我的代码进行单元测试，但是每个月我都必须更改单元测试，因为我更改了我的密码。
2.  使用一些设置了密码永不过期的帐户。这有点毫无意义，因为我无法真正测试我的代码的正确性。
3.  使用模拟对象并确保发生正确的 API 调用。这个选项允许测试函数行为的正确性，但是测试的逻辑实际上是在单元测试中，因此我不能确定它是否在做正确的事情，即使测试通过了。

你建议哪三个？或者也许你有更好的选择？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T18:06:21.933

从 1 和 2 开始，对我来说，依赖 AD 存在并具有已知值似乎更像是集成测试。

我通常认为任何非确定性行为都应该尽可能地被接口和模拟（#3）。正如您所指出的，这将始终留下大量不可单元测试的实际实现代码，但随后会被针对已知 AD 系统运行的集成测试所覆盖。

[相关问题/答案](https://stackoverflow.com/questions/876715/unit-tests-for-code-accessing-activedirectory)

# sql - SQL优化查询

> ID：911145
> 
> 赞同：1
> 
> 时间：2009-05-26T14:57:35.823
> 
> 标签：sql, sql-server, performance

下面的 MSSQL2005 查询很慢。我觉得他们应该是一种加快速度的方法，但我不确定如何。请注意，我编辑了内部连接以使用 select 语句，以使其更明显（对于阅读此问题的人）正在发生的事情，尽管这对速度没有影响（可能执行计划是相同的）。有趣的是，我实际上从未将关键字值组用于计数之外的任何事情，但我不确定是否有办法利用这一点。

```
select top 1 cde.processPath as 'keywordValue', count(*) as 'total'
from dbo.ClientDefinitionEntry AS cde INNER JOIN dbo.KeywordValueGroups  AS kvg
ON cde.keywordGroupId = kvg.keywordValueGrpId
where kvg.[name] = @definitionName
group by cde.processPath
order by total desc 
```

编辑：显然，人们一直在抱怨我使用子查询。事实上，这并没有什么区别。我在发布这个问题之前添加了它们，以便更容易看到发生了什么。但是它们只会让事情变得更加混乱，所以我将其更改为不使用它们。

编辑：使用中的索引：

```
ClientDefinitionEntry:
IX_ClientDefinitionEntry   |nonclustered located on PRIMARY|clientId, keywordGroupId

KeyWordValueGroups
IX_KeywordValueGroups      |nonclustered located on PRIMARY|keywordValueGrpId
IX_KeywordValueGroups_2    |nonclustered located on PRIMARY|version
IX_KeywordValueGroups_Name |nonclustered located on PRIMARY|name 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T15:11:28.510

执行计划如何？通过查看它，您将了解查询的哪个部分占用最多的时间/资源。

您是否在过滤的列上建立了索引？您是否对用于加入的列进行了索引？您是否对用于排序的列进行了索引？

看完这个，查询还是很慢，可以看看你的数据库/表是怎么分片的（dbcc showcontig），看看是否需要重建索引。
制定一个定期重建索引的维护计划可能会有所帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T15:14:16.400

使用此选项运行查询：

设置 SHOWPLAN_TEXT ON

并将结果添加到问题中。

还要检查您的统计数据是否是最新的：

```
SELECT 
    object_name = Object_Name(ind.object_id),
    IndexName = ind.name,
    StatisticsDate = STATS_DATE(ind.object_id, ind.index_id)
FROM SYS.INDEXES ind
order by STATS_DATE(ind.object_id, ind.index_id) desc 
```

有关索引、表定义和外键的信息会很有帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T15:15:32.997

确实没有足够的信息可以确定。如果您在该查询中遇到性能问题，那么这些表必须包含大量数据，并且您必须缺少重要的索引。

哪些索引肯定会有所帮助，这在很大程度上取决于表的大小，并且在较小程度上取决于 KeywordGroupId 和 KeywordValueGrpId 字段中的值分布。

缺乏任何其他信息，我会说你想确保它`dbo.KeywordValueGroups.[name]`被索引，以及`dbo.ClientDefinitionEntry.[keywordGroupId]`.

由于查询的编写方式，`dbo.KeywordValueGroups.[keywordValueGrpId]`单独的索引无济于事，但复合索引`[name], [keywordValueGrpId]`可能会有帮助。如果您有该索引，则不需要在`[name]`.

仅凭直觉，我可能会冒险认为 index on`[name]`是*必须*的，并且 cde.keywordGroupId 可能很重要。复合索引是否 `[name], [keywordValueGrpId]`会有所帮助，这取决于有多少记录具有相同的 [name]。

唯一确定的方法是添加索引并查看会发生什么。

您还需要考虑此查询的运行频率（因此，使其快速运行有多重要）以及基础数据更改的频率。根据您的特定情况，速度的提高可能无法证明维护索引的额外成本是合理的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-26T15:18:01.180

我会确保你有以下索引。

KeywordValueGroups 上的 ID。

KeywordValueGroups 上的名称。

ClientDefinitionEntry 上的 ID，带有 processPath 的 INCLUDE。

```
CREATE INDEX [IX_ClientDefinitionEntry_Id_ProcessPath] ON [dbo].[ClientDefinitionEntry] ( [keywordGroupId] ASC ) INCLUDE ( [processPath]) ON [PRIMARY]
CREATE INDEX [IX_KeywordValueGroups_Id] ON [dbo].[KeywordValueGroups] ( [keywordValueGrpId] ASC )
CREATE INDEX [IX_KeywordValueGroups_Name] ON [dbo].[KeywordValueGroups] ( [name] ASC ) 
```

我还将查询更改为以下内容。

```
select top 1
    cde.processPath as 'keywordValue',
    count(*) as 'total'
from
    dbo.ClientDefinitionEntry AS cde
INNER JOIN
    dbo.KeywordValueGroups  AS kvg
ON
    cde.keywordGroupId = kvg.keywordValueGrpId
where
    kvg.[name] = @definitionName
group by
    processPath
order by
    total desc 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T15:32:44.973

不确定我们在谈论多少条记录，但这是：order by total desc 在计算列上，这意味着必须先完成每一行的每次计算，然后才能完成排序。可能这是减慢速度的原因之一，但我认为没有办法解决这个特定问题。如果您在加入后只有几条记录，这不是问题，但如果有很多记录，则可能会出现问题。

我会先专注于索引。我们经常忘记，当我们创建外键时，它们不会自动索引。检查连接的两个部分是否都已编入索引。

由于您在参数中传递值，因此您可能还会遇到参数嗅探问题。谷歌这个技术来解决这个问题。

# sharepoint - 是否还有其他类，例如 SPBuiltInFieldId 和 SPBuiltInContentTypeId？

> ID：911154
> 
> 赞同：0
> 
> 时间：2009-05-26T14:59:52.277
> 
> 标签：sharepoint, moss, wss

是否还有其他类似于[SPBuiltInFieldId](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spbuiltinfieldid_fields.aspx)和[SPBuiltInContentTypeId](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spbuiltinfieldid_fields.aspx)的内置类？

我正在创建一个将部署到英语和波兰语网站集的功能。它**使用自定义 Web 服务**- 当我需要访问某个列表或 Web 部件时，**我必须检查当前语言并使用正确的名称**（“Site Template Gallery”或“Galeria szablonów witryn”、“Site Image”或“Obraz机智”）。

有更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T16:03:17.330

```
SPList list = pubSite.RootWeb.GetCatalog(SPListTemplateType.MasterPageCatalog); 
```

是不是像你要找的东西？

[http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.splisttemplatetype.aspx](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.splisttemplatetype.aspx)

否则，如果您正在寻找一种通过内部名称获取列表的方法，您可以查看此帖子：http://johanleino.spaces.live.com/blog/cns!6BE273C70C45B5D1! [294.entry](http://johanleino.spaces.live.com/blog/cns!6BE273C70C45B5D1!294.entry)

**更新：**

如果您需要从 12\Template\Resources 获取资源，您可以使用以下内容：

```
SPUtility.GetLocalizedString("$Resources: dcl_schema_view_allitems", "core", 1053); 
```

这将从具有瑞典语言环境的 core.resx 中的键**dcl_schema_view_allitems**获取值。编辑以满足您的需求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T16:52:44.747

因此，您的问题更像是**“我如何才能找到另一种语言的 SharePoint 工件的名称？”**

主要有两个位置：

1.  `C:\Program Files\Common Files\Microsoft Shared\web server extensions\12\Resources`
2.  SharePoint 正在使用的 IIS 网站的 App_GlobalResources 子文件夹。例如：`C:\Inetpub\wwwroot\wss\VirtualDirectories\80\App_GlobalResources`

资源文件都是 XML。用您最熟悉的语言找到您需要的文本，并记下 XML 节点的详细信息。然后打开其他语言的文件并使用 XPath、LINQ 或您喜欢的 XML 技术读取该语言的相应值。

# php - 如何清除 APC 缓存条目？

> ID：911158
> 
> 赞同：171
> 
> 时间：2009-05-26T15:00:21.967
> 
> 标签：php, performance, caching, apc

当我部署新版本的站点时，我需要清除所有 APC 缓存条目。APC.php 有一个用于清除所有操作码缓存的按钮，但我没有看到用于清除所有用户条目、所有系统条目或所有每个目录条目的按钮。

是否可以通过命令行或其他方式清除所有缓存条目？

* * *

## 回答 #1

> 赞同：146
> 
> 时间：2009-05-26T15:14:02.903

您可以使用 PHP 函数`apc_clear_cache`。

调用`apc_clear_cache()`将清除系统缓存，调用`apc_clear_cache('user')`将清除用户缓存。

* * *

## 回答 #2

> 赞同：117
> 
> 时间：2010-08-27T02:30:26.600

我不相信这些答案中的任何一个实际上都适用于从命令行清除 APC 缓存。正如[Frank Farmer](https://stackoverflow.com/questions/911158/how-to-clear-apc-cache-entries/911219#911219)上面评论的那样，CLI 在与 Apache 不同的进程中运行。

我从命令行清除的解决方案是编写一个脚本，将 APC 清除脚本复制到`web`目录并访问它，然后将其删除。该脚本仅限于从 localhost 访问。

1.  **apc_clear.php**

    这是脚本复制到 Web 目录、访问和删除的文件。

    ```
    <?php
    if (in_array(@$_SERVER['REMOTE_ADDR'], array('127.0.0.1', '::1')))
    {
      apc_clear_cache();
      apc_clear_cache('user');
      apc_clear_cache('opcode');
      echo json_encode(array('success' => true));
    }
    else
    {
      die('SUPER TOP SECRET');
    } 
    ```

2.  **缓存清除脚本**

    此脚本将 apc_clear.php 复制到 web 目录，访问它，然后将其删除。这是基于 Symfony 任务的。在 Symfony 版本中，调用 Symfony 形式的复制和取消链接，它们处理错误。您可能需要添加检查以确保它们成功。

    ```
    copy($apcPaths['data'], $apcPaths['web']); //'data' is a non web accessable directory

    $url = 'http://localhost/apc_clear.php'; //use domain name as necessary
    $result = json_decode(file_get_contents($url));

    if (isset($result['success']) && $result['success'])
    {
      //handle success
    }
    else
    {
      //handle failure
    }

    unlink($apcPaths['web']); 
    ```

* * *

## 回答 #3

> 赞同：68
> 
> 时间：2011-07-13T16:15:03.787

我知道这并不适合所有人，但是：为什么不优雅地重新启动 Apache？

例如，在 Centos/RedHat Linux 的情况下：

```
sudo service httpd graceful 
```

Ubuntu：

```
sudo service apache2 graceful 
```

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2010-06-15T20:14:49.207

这在文档中没有说明，但是要清除操作码缓存，您必须执行以下操作：

```
apc_clear_cache('opcode'); 
```

编辑：这似乎只适用于一些旧版本的 APC ..

无论您使用什么版本，您都无法从 php cli 脚本中清除 mod_php 或 fastcgi APC 缓存，因为 cli 脚本将从 mod_php 或 fastcgi 的不同进程运行。您必须从要为其清除缓存的进程（或子进程）中调用 apc_clear_cache()。使用 curl 运行一个简单的 php 脚本就是这样一种方法。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2014-01-21T13:24:01.450

如果要在命令中清除 apc 缓存：（如果需要，请使用 sudo）

亚太铜

```
php -r "apcu_clear_cache();" 
```

装甲运兵车

```
php -r "apc_clear_cache(); apc_clear_cache('user'); apc_clear_cache('opcode');" 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2013-04-23T19:47:09.420

如果您在 NGINX / PHP-FPM 堆栈上运行，最好的选择可能是重新加载 php-fpm

`service php-fpm reload`（或者你的系统上的任何重载命令）

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-02-01T13:26:58.923

命令行使用的另一种可能性（尚未提及）是使用 curl。

如果您使用库存 apc.php 脚本，这并不能解决所有缓存条目的问题，但它可以调用改编脚本或您已放置的另一个脚本。

这将清除操作码缓存：

```
curl --user apc:$PASSWORD "http://www.example.com/apc.php?CC=1&OB=1&`date +%s`" 
```

将 OB 参数更改为 3 以清除用户缓存：

```
curl --user apc:$PASSWORD "http://www.example.com/apc.php?CC=1&OB=3&`date +%s`" 
```

将这两行都放在脚本中，并在您的环境中使用 $PASSWORD 调用它。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2014-09-23T14:12:02.077

apc_clear_cache() 仅适用于您希望清除缓存的同一 php SAPI。如果你有 PHP-FPM 并且想要清除 apc 缓存，你必须通过一个 php 脚本来完成，而不是命令行，因为这两个缓存是分开的。

我已经编写了[CacheTool](http://gordalina.github.io/cachetool/)，这是一个命令行工具，可以完全解决这个问题，并且使用一个命令，您可以从命令行清除您的 PHP-FPM APC 缓存（它为您连接到 php-fpm，并执行 apc 函数）

它也适用于 opcache。

在这里查看它是如何工作的：http: [//gordalina.github.io/cachetool/](http://gordalina.github.io/cachetool/)

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2015-08-06T06:17:43.743

如 APC 文档中所定义：

要清除缓存运行：

```
php -r 'function_exists("apc_clear_cache") ? apc_clear_cache() : null;' 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2015-10-13T10:25:29.877

如果你想通过 json 监控结果，你可以使用这种脚本：

```
<?php

$result1 = apc_clear_cache();
$result2 = apc_clear_cache('user');
$result3 = apc_clear_cache('opcode');
$infos = apc_cache_info();
$infos['apc_clear_cache'] = $result1;
$infos["apc_clear_cache('user')"] = $result2;
$infos["apc_clear_cache('opcode')"] = $result3;
$infos["success"] = $result1 && $result2 && $result3;
header('Content-type: application/json');
echo json_encode($infos); 
```

如其他答案中所述，必须通过 http 或 curl 调用此脚本，如果它暴露在应用程序的 Web 根目录中，则必须确保它的安全。（通过 ip，令牌...）

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2014-07-01T00:12:30.930

如果你在ubuntu下运行fpm，需要运行下面的代码（勾选12和14）

```
service php5-fpm reload 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-11-14T05:26:43.037

APC 的马厩可以选择清除其接口本身的缓存。要清除这些条目，您必须登录到 apc 界面。

APC 可以选择在 apc.php 文件中设置用户名和密码。

![在此处输入图像描述](https://i.stack.imgur.com/16fDK.png)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2014-01-27T23:14:50.107

apc.ini

apc.stat = "1" 将强制 APC 统计（检查）每个请求的脚本，以确定它是否已被修改。如果它已被修改，它将重新编译并缓存新版本。

如果此设置关闭，APC 将不检查，这通常意味着要强制 APC 重新检查文件，必须重新启动 Web 服务器或手动清除缓存。请注意，FastCGI Web 服务器配置可能不会在重新启动时清除缓存。在脚本文件很少更改的生产服务器上，禁用统计信息可以显着提高性能。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2014-07-04T01:47:47.437

新的 APC 管理界面具有添加/清除用户缓存和操作码缓存的选项，一个有趣的功能是从操作码缓存添加/刷新/删除目录

[APC 管理员文档](http://www.techzonemind.com/apc-admin-new-generation-admin-interface-php-apc/)

![在此处输入图像描述](https://i.stack.imgur.com/3GsEW.png)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-10-05T10:25:49.353

创建 APC.php 文件

```
foreach(array('user','opcode','') as $v ){
    apc_clear_cache($v);
} 
```

从浏览器运行它。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2012-12-12T15:24:27.930

对我来说一个好的解决方案是在部署后不再使用过时的用户缓存。

如果为每个键添加前缀，则可以在更改缓存条目的数据结构时更改前缀。这将帮助您在部署时获得以下行为：

1.  仅部署更新的结构后不要使用过时的缓存条目
2.  不要在部署时清理整个缓存，以免降低页面速度
3.  恢复部署后可以重复使用一些旧的缓存条目（如果条目尚未自动删除）
4.  APC 将在过期**或**缺少缓存空间后删除旧缓存条目

这仅适用于用户缓存。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-06-07T06:51:50.293

我为 Symfony 构建在同一服务器上拥有大量实例的解决方法：

**步骤 1.** 创建触发器或设置文件标志的东西（例如 Symfony 命令）然后创建`marker file`..

```
file_put_contents('clearAPCU','yes sir i can buggy') 
```

**步骤 2.** 在索引文件上开始添加清除代码并删除`marker file`.

```
if(file_exists('clearAPCU')){
    apcu_clear_cache();
    unlink('clearAPCU');
} 
```

**步骤 2.** 运行应用程序。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-12-20T15:40:44.050

**TL;DR：**删除缓存文件`/storage/framework/cache/data/`

我启用了 APC，但它没有安装（也无法安装），所以它抛出了`Call to undefined function Illuminate\Cache\apc_store()`.

“好的，我只是禁用它，它应该可以工作”。

嗯，不。然后我被困住了`Call to undefined function Illuminate\Cache\apc_delete()`

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2010-06-17T06:42:30.087

我们在 APC 和文件符号链接的符号链接方面遇到了问题——它似乎忽略了文件本身的变化。不知何故，对文件本身进行触摸有所帮助。我不知道修改文件和触摸它有什么区别，但不知何故这是必要的......

# java - db4o 保留对象的身份

> ID：911166
> 
> 赞同：0
> 
> 时间：2009-05-26T15:03:02.630
> 
> 标签：java, db4o

有没有办法在 db4o.xml 中保留对象身份？

假设我将 BigDecimal 存储在嵌入式 db4o 中。

当我阅读它两次时，我得到两个具有相同值的不同对象（这很明显）。

是否有任何设置强制 db4o 缓存查询结果，以便两个查询返回对同一实例的引用，还是我必须自己做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-06-08T00:34:03.760

根据我的经验，在同一个 ObjectContainer 上运行两次相同的查询应该每次都返回相同的（相同的）对象。

如果您需要对象的身份，则不应在查询之间关闭并重新打开 ObjectContainer。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-13T11:07:33.997

Db4o 确实在内部使用[ID 和 UUID](http://developer.db4o.com/Resources/view.aspx/Reference/Implementation_Strategies/IDs_and_UUIDs)，如果需要，您可以访问它们。另外值得一读的是[这个](http://developer.db4o.com/Resources/view.aspx/Reference/Basic_Concepts/Object_Identity/Unique_Identity_Concept)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-06-05T09:00:21.180

您可以使用它的 UUID 为您的每个对象创建一个 ID，我的意思是为该对象添加一个属性 ID 并为其赋予 UUID 值并存储它，要更新一个对象，您可以通过该 ID 检索它并更新它

# python - Python 和 Qt (PyQt) - 在调整大小事件之前调用方法

> ID：911167
> 
> 赞同：1
> 
> 时间：2009-05-26T15:03:22.177
> 
> 标签：python, constructor, pyqt

我有个问题。我的程序中有应用程序类。它继承自 QtGui.QMainWindow。在**ini**中，我调用了我自己的与图形一起使用的方法。它应该在调整大小事件之前调用。我怎样才能做到这一点？谢谢。

编辑：你可以[在这里](http://doc.trolltech.com/4.2/qevent.html)看到 resize 事件的值是 14，显示事件是 17。所以我应该找到值小于 14 的事件。

我发现了我的问题。在创建图像句柄之前的构造函数中，我将窗口移动到某个位置......所以在该操作期间 resizeEvent 调用。对不起这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T15:47:47.547

您可以在您的类中覆盖该`resizeEvent`方法（`QMainWindows`继承自`QWidget`），请参阅[http://doc.trolltech.com/4.4/qwidget.html#resizeEvent](http://doc.trolltech.com/4.4/qwidget.html#resizeEvent) - 在您的覆盖中，调用您的其他代码，然后委派其余的工作到方法的父版本。

# bash - 如何检测我的 shell 脚本是否通过管道运行？

> ID：911168
> 
> 赞同：298
> 
> 时间：2009-05-26T15:03:29.027
> 
> 标签：bash, shell, pipe

如何从 shell 脚本中检测其标准输出是否正在发送到终端或是否通过管道传输到另一个进程？

恰当的例子：我想添加转义码来为输出着色，但仅限于交互运行时，而不是在管道时，类似于什么`ls --color`。

* * *

## 回答 #1

> 赞同：461
> 
> 时间：2009-05-26T15:13:32.313

在纯 POSIX shell 中，

```
if [ -t 1 ] ; then echo terminal; else echo "not a terminal"; fi 
```

返回“终端”，因为输出被发送到您的终端，而

```
(if [ -t 1 ] ; then echo terminal; else echo "not a terminal"; fi) | cat 
```

返回“不是终端”，因为括号元素的输出通过管道传输到`cat`.

* * *

该`-t`标志在手册页中描述为

> -t fd 如果文件描述符 fd 已打开并指向终端，则为真。

...其中`fd`可以是通常的文件描述符分配之一：

*   0：[标准输入](https://en.wikipedia.org/wiki/Standard_streams#Standard_input_(stdin))
*   1：[标准输出](https://en.wikipedia.org/wiki/Standard_streams#Standard_output_(stdout))
*   2：[标准误差](https://en.wikipedia.org/wiki/Standard_streams#Standard_error_(stderr))

* * *

## 回答 #2

> 赞同：142
> 
> 时间：2015-05-29T02:48:25.000

没有*万无一失*的方法来确定 STDIN、STDOUT 或 STDERR 是否正在通过管道传输到您的脚本/从您的脚本传输，这主要是因为`ssh`.

## “正常”工作的东西

例如，以下 bash 解决方案在交互式 shell 中可以正常工作：

```
[[ -t 1 ]] && \
    echo 'STDOUT is attached to TTY'

[[ -p /dev/stdout ]] && \
    echo 'STDOUT is attached to a pipe'

[[ ! -t 1 && ! -p /dev/stdout ]] && \
    echo 'STDOUT is attached to a redirection' 
```

## 但它们并不总是有效

但是，当将此命令作为非 TTY`ssh`命令执行时，STD 流*总是*看起来像是在通过管道传输。为了证明这一点，使用 STDIN 因为它更容易：

```
# CORRECT: Forced-tty mode correctly reports '1', which represents
# no pipe.
ssh -t localhost '[[ -p /dev/stdin ]]; echo ${?}'

# CORRECT: Issuing a piped command in forced-tty mode correctly
# reports '0', which represents a pipe.
ssh -t localhost 'echo hi | [[ -p /dev/stdin ]]; echo ${?}'

# INCORRECT: Non-tty mode reports '0', which represents a pipe,
# even though one isn't specified here.
ssh -T localhost '[[ -p /dev/stdin ]]; echo ${?}' 
```

## 为什么重要

这是一个相当大的问题，因为它意味着 bash 脚本无法判断非 tty`ssh`命令是否正在通过管道传输。请注意，当最近版本的`ssh`非 TTY STDIO 开始使用管道时，引入了这种不幸的行为。以前的版本使用套接字，可以通过使用`[[ -S ]]`.

## 重要的时候

当您要编写行为类似于已编译实用程序（例如`cat`. 例如，`cat`在同时处理各种输入源时允许以下灵活行为，并且无论使用非 TTY 还是强制 TTY 都足够聪明地确定它是否正在接收管道输入`ssh`：

```
ssh -t localhost 'echo piped | cat - <( echo substituted )'
ssh -T localhost 'echo piped | cat - <( echo substituted )' 
```

如果您可以可靠地确定是否涉及管道，您只能执行类似的操作。否则，当管道或重定向没有可用输入时执行读取 STDIN 的命令将导致脚本挂起并等待 STDIN 输入。

## 其他不起作用的东西

在尝试解决这个问题时，我研究了几种无法解决问题的技术，包括以下技术：

*   检查 SSH 环境变量
*   使用`stat`/dev/stdin 文件描述符
*   通过检查交互模式`[[ "${-}" =~ 'i' ]]`
*   `tty`通过和检查 tty 状态`tty -s`
*   通过检查`ssh`状态`[[ "$(ps -o comm= -p $PPID)" =~ 'sshd' ]]`

请注意，如果您使用的是支持`/proc`虚拟文件系统的操作系统，您可能会幸运地按照 STDIO 的符号链接来确定是否正在使用管道。但是，`/proc`它不是跨平台的、与 POSIX 兼容的解决方案。

我对解决这个问题非常感兴趣，所以如果您想到任何其他可能有效的技术，请告诉我，最好是在 Linux 和 BSD 上工作的基于 POSIX 的解决方案。

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2009-05-26T15:14:57.333

该命令[`test`](https://ss64.com/bash/test.html)（内置在 Bash 中）具有检查文件描述符是否为 tty 的选项。

```
if [ -t 1 ]; then
    # Standard output is a tty
fi 
```

请参阅“ [`man test`](https://linux.die.net/man/1/test)”或“ [`man bash`](https://linux.die.net/man/1/bash)”并搜索“ `-t`”。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-05-26T15:21:07.697

你没有提到你正在使用哪个 shell，但是在 Bash 中，你可以这样做：

```
#!/bin/bash

if [[ -t 1 ]]; then
    # stdout is a terminal
else
    # stdout is not a terminal
fi 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2015-06-12T20:41:57.933

在[Solaris](https://en.wikipedia.org/wiki/Solaris_%28operating_system%29)上，[Dejay Clayton 的建议](https://stackoverflow.com/questions/911168/how-can-i-detect-if-my-shell-script-is-running-through-a-pipe/30520299#30520299)最有效。`-p`没有按预期响应。

文件*bash_redir_test.sh*看起来像：

```
[[ -t 1 ]] && \
    echo 'STDOUT is attached to TTY'

[[ -p /dev/stdout ]] && \
    echo 'STDOUT is attached to a pipe'

[[ ! -t 1 && ! -p /dev/stdout ]] && \
    echo 'STDOUT is attached to a redirection' 
```

在 Linux 上，它工作得很好：

```
:$ ./bash_redir_test.sh
STDOUT is attached to TTY

:$ ./bash_redir_test.sh | xargs echo
STDOUT is attached to a pipe

:$ rm bash_redir_test.log
:$ ./bash_redir_test.sh >> bash_redir_test.log

:$ tail bash_redir_test.log
STDOUT is attached to a redirection 
```

在 Solaris 上：

```
:# ./bash_redir_test.sh
STDOUT is attached to TTY

:# ./bash_redir_test.sh | xargs echo
STDOUT is attached to a redirection

:# rm bash_redir_test.log
bash_redir_test.log: No such file or directory

:# ./bash_redir_test.sh >> bash_redir_test.log
:# tail bash_redir_test.log
STDOUT is attached to a redirection

:# 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-02-13T11:13:22.763

以下代码（仅在 Linux Bash 4.4 中测试）*不应被视为可移植也不推荐*，但为了完整起见，这里是：

```
ls /proc/$$/fdinfo/* >/dev/null 2>&1 || grep -q 'flags:    00$' /proc/$$/fdinfo/0 && echo "pipe detected" 
```

[我不知道为什么，但是当 Bash 函数具有标准输入](https://en.wikipedia.org/wiki/Standard_streams#Standard_input_(stdin))管道时，似乎以某种方式创建了文件描述符“3” 。

# asp.net - 将标签绑定到 SiteMap 当前节点

> ID：911172
> 
> 赞同：0
> 
> 时间：2009-05-26T15:04:04.203
> 
> 标签：asp.net, sitemap

我想做的是这样的：

```
<asp:Label ID="titleLabel" runat="server" 
        **Text='<%# SiteMap.CurrentNode.Title %>'**></asp:Label> 
```

我可以将站点地图中当前页面节点的名称绑定到该页面上的标题标签。我们这样做是因为，在我们最终确定这些名称之前，它们可能会经常更改。上面的代码不起作用，至少对我来说；它什么也不显示。

任何想法表示赞赏。

编辑：显然我可以在后面的代码中执行此操作（即页面加载事件或类似的东西），但我真的更愿意在 aspx 代码中执行此操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T15:16:35.910

作为使用标签的替代方法，您还可以使用[SiteMapPath 控件](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.sitemappath%28VS.80%29.aspx)并隐藏父节点：

```
<asp:SiteMapPath ID="SiteMapPath1" runat="server" ParentLevelsDisplayed="0"> 
```

属性**ParentLevelsDisplayed**允许您指定要显示的当前站点地图节点的父节点数量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T15:57:32.363

它确实适用于

```
<span><%= SiteMap.CurrentNode.Title %></span> 
```

这与 asp:Label 的输出相同

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T15:10:07.297

已经有一段时间了，但我相信它的 <%= #Eval(SiteMap.CurrentNode.Title) %>

编辑：

文本='<%= SiteMap.CurrentNode.Title%>'

希望它的工作方式和它一样

### <%= SiteMap.CurrentNode.Title%>

.

# c# - 带有列枚举的 LINQ 表枚举

> ID：911175
> 
> 赞同：0
> 
> 时间：2009-05-26T15:04:23.377
> 
> 标签：c#, linq

您如何获得所有表的列表并使用该列表来枚举列？我找到了描述其中之一的帖子，但不是两者都有。

我的最终结果是我想生成一个静态类，其中包含每个表中所有列的名称，例如，我可以这样做：

```
comboBoxFoo.DisplayMember = SomeNamespace.SomeTable.SomeDisplayColumnName;
comboBoxFoo.ValueMember = SomeNamespace.SomeTable.SomeIDColumnName;
comboBoxFoo.DataSource = dingo; 
```

我目前正在使用[这种](https://stackoverflow.com/questions/360990/how-would-i-get-the-column-names-from-a-model-linq/363746#363746)方法，虽然它有效，但这意味着我必须在列表中手动创建我的表。

我有一个单独的命令行项目，它手动生成 SomeNameSpace.SomeTable 类，并将生成的类文件添加到项目中。

理想情况下，如果我可以通过 foreach 表循环并执行以下操作：

```
foreach(var table in someTableNumerationMethodForAGivenContext())
{
    var columnList = databaseContext.ColumnNames<someTable>();
    foreach(var columnData in columnList)
    {
        DoJazz(columnData.Name);
    }
} 
```

除了手动执行 databaseContext.ColumnNames() 之外，还有更好的方法吗？

编辑 1：我们使用的是 LinqToSQL。迁移到 ADO.NET 也是一个选择，但目前我们没有迫切需要。

编辑 2：我知道 L2S 进行数据绑定，但我所追求的是从表中获取列名列表作为字符串。L2S 不提供此功能，或者在我这边并不明显。我想做类似的事情： SomeTable.SomeColumn.ToString() 什么的。亚音速有这个。

最后：谢谢大家。都是很好的答案，并引导我找到答案。你们真棒！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T15:47:27.783

纳扎杜斯，

这是你想要的？

LINQ to SQL 技巧：获取所有表 [和列] 名称：http: [//blogs.msdn.com/jomo_fisher/archive/2007/07/30/linq-to-sql-trick-get-all-table-names。 aspx](http://blogs.msdn.com/jomo_fisher/archive/2007/07/30/linq-to-sql-trick-get-all-table-names.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T15:18:04.597

你所描述的本质上是一个[ORM](http://en.wikipedia.org/wiki/Object-relational_mapping)

Linq to SQL 是一个 ORM，它将为您创建原型 c# 类，其中包含您所描述的信息。它对您所说明的那种数据绑定有很好的支持。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T15:51:43.280

我想你正在寻找[这个](http://msdn.microsoft.com/en-us/library/system.data.linq.mapping.metadatamember_members.aspx)。

```
DataContext.Mapping.GetTable(yourTable).RowType.DataMemebers() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T15:54:06.897

我可以想到两种方法来做到这一点。

A) 使用 SMO 获取数据库中的所有表/列。你需要参考：

Microsoft.SqlServer.ConnectionInfo

Microsoft.SqlServer.Management.Sdk.Sfc

微软.SqlServer.Smo

然后，您可以执行以下操作：

```
 ServerConnection connection = new ServerConnection(".");
        Server server = new Server(connection);
        Database db = server.Databases["Northwind"];
        foreach (Table table in db.Tables)
        {
            foreach (Column column in table.Columns)
            {
                Console.WriteLine("Table: {0}, Column: {1}",table.Name,column.Name);
            }
        }
    } 
```

B) 使用反射通过 Linq to Sql 生成的数据类来反映您的程序集。任何具有 Table 属性的东西都是一个表，任何具有 Column 属性的东西都是一个列。如果您需要样品，请告诉我...

# visual-studio-2008 - Silverlight、SQL Server 和 Visual Studio：在 Internet 上公开测试页面

> ID：911184
> 
> 赞同：0
> 
> 时间：2009-05-26T15:06:38.147
> 
> 标签：visual-studio-2008, silverlight, web-services, sql-server-2008-express, remote-access

我正在开发一个 SQL Server 2008 Express + silverlight 项目，到目前为止，在本地机器上一切正常。我已将其设置为 silverlight 应用程序使用服务引用和 LINQ 连接到 SQL Server 的位置，并且我相信 SQL Server 允许使用 TCP/IP 进行远程连接。

但是，由于 silverlight 应用程序是一个 .aspx 文件，因此它需要在 Web 服务器上运行。当我在 Visual Studio (2008) 中单击“运行”时，IE 会弹出地址“ [http://localhost:1437/SQLTestTestPage.aspx](http://localhost:1437/SQLTestTestPage.aspx) ”，一切正常。为了让我可以远程使用这个页面，我希望能够通过“ [http://10.215.22.57:1437/SQLTestTestPage.aspx](http://10.215.22.57:1437/SQLTestTestPage.aspx) ”访问同一个页面，其中 10.215.22.57 是本地机器的 IP。这现在不起作用，我不确定如何启用它。这甚至可以通过 SQL Server 实现，还是我需要设置一个单独的 HTTP 服务器来托管 aspx 页面？

谢谢，-罗伯特

编辑：实际上，由于我是从 Visual Studio 启动 silverlight 应用程序，我猜实际上是 VS 设置了托管 .aspx 页面的 Web 服务器，而不是 SQL 服务器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T18:39:57.200

似乎这里可能会发生很多事情。切入正题，您最好的选择可能是将 Web 项目移动到 IIS 而不是开发 Web 服务器，然后尝试从外部 IP 指向它。为此，右键单击 MySilverlightApp.Web 项目（包含 .aspx 页面的 ASP.NET 项目）并选择属性。点击 Web 选项卡，然后在服务器下选择“使用本地 IIS Web 服务器”而不是“使用 VS 开发服务器”。您应该得到一个提示，要求您创建一个虚拟目录；选择是。按 F5 在 VS 中进行调试，您应该会看到您的站点带有一个新的 url - 机会 localhost 到您的 IP，希望它仍然可以工作。它不适用于 VS 开发服务器的原因是，当您停止在 VS 中调试时，服务器会消失。还，

# c# - 混合动态和静态 XAML 菜单项

> ID：911196
> 
> 赞同：5
> 
> 时间：2009-05-26T15:09:43.193
> 
> 标签：c#, wpf, xaml

我有一个场景，我需要同时拥有静态和动态菜单项。静态项将在 XAML 中定义，动态项由视图模型提供。每个动态项本身将由一个 VieModel 表示，我们称之为 CommandViewModel。CommandViewModel 有一个显示名称，它还可以包含其他 CommandViewModel。

用作菜单数据上下文的 MainViewModel 如下：

```
public class MainMenuViewModel : INotifyPropertyChanged
{

  private ObservableCollection<CommandViewModel> m_CommandVMList;

  public MainMenuViewModel()
  {
    m_ CommandVMList = new ObservableCollection<CommandViewModel>();

    CommandViewModel cmv = new CommandViewModel();
    cmv.DisplayName = "Dynamic Menu 1";
    m_CommandVMList.Add(cmv);

    cmv = new CommandViewModel();
    cmv.DisplayName = "Dynamic Menu 2";
    m_CommandVMList.Add(cmv);

    cmv = new CommandViewModel();
    cmv.DisplayName = "Dynamic Menu 3";
    m_CommandVMList.Add(cmv);

  }

  public ObservableCollection<CommandViewModel> CommandList
  {
    get { return m_CommandVMList; }
    set
    {
      m_CommandVMList = value;
      OnPropertyChanged("CommandList");
    }
  } 
```

…………</p>

菜单 XAML：

```
<Grid>
  <Grid.Resources>
    <HierarchicalDataTemplate DataType="{x:Type Fwf:CommandViewModel}" ItemsSource="{Binding Path=CommandViewModels}">
      <MenuItem Header="{Binding Path=DisplayName}"/>
    </HierarchicalDataTemplate>
  </Grid.Resources>

  <Menu VerticalAlignment="Top" HorizontalAlignment="Stretch">
    <MenuItem Header="Static Top Menu Item 1">
      <MenuItem Header="Static Menu Item 1"/>
        <MenuItem Header="Static Menu Item 2"/>
        <MenuItem Header="Static Menu Item 3"/>
        <ItemsControl ItemsSource="{Binding Path= CommandList}"/>
        <MenuItem Header="Static Menu Item 4"/>
      </MenuItem>
  </Menu>
</Grid> 
```

除了我试图表示动态菜单列表之外，一切正常，在这种情况下，一个 ItemsControl 它在 UI 上显示为一个包含更多菜单项的菜单项，因此当您单击时，整个动态菜单项集合都会被选中在项目上。该集合得到正确表示，因为每个动态菜单项都显示为菜单项本身，但在这个更大的菜单项中。我想我明白为什么菜单只是为每个包含的项目创建一个菜单项，静态或动态它并不关心。有没有办法让每个动态菜单项在同一级别上创建并与示例中的静态菜单项一样属于父菜单项？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-26T19:32:46.160

我不会在 XAML 端硬编码您的“静态”菜单项，而是在 VM 端将它们硬编码为 CommandViewModel 对象。

由于您以任何一种方式对其进行硬编码，因此您不会失去灵活性，并且如果您将来选择以不同方式呈现它们，您将获得使静态菜单项与 HierarchicalDataTemplate 保持同步的额外好处。

请注意，您可能必须更改绑定，以便您的菜单绑定到菜单项的集合。[你可以在这里](http://karlshifflett.wordpress.com/2008/02/03/wpf-sample-series-databound-hierarchicaldatatemplate-menu-sample/)找到一个例子。

**编辑：代码示例**

我能够很快地解决这个问题，并且大多数类定义都不完整（例如 INotifyPropertyChanged），但它应该让您了解您可以做什么。我在第三个命令上添加了一些命令嵌套，以确保 Hierarchical DataTemplate 正常工作。

这是 XAML

```
<Window
    x:Class="WPFDynamicMenuItems.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:WPFDynamicMenuItems"
    Title="Window1" Height="300" Width="600">
    <Grid>
        <Grid.Resources>
            <HierarchicalDataTemplate DataType="{x:Type local:CommandViewModel}" ItemsSource="{Binding Path=CommandList}">
                <ContentPresenter
                    Content="{Binding Path=DisplayName}"
                    RecognizesAccessKey="True" />
            </HierarchicalDataTemplate>
        </Grid.Resources>
        <ToolBarTray>
            <ToolBar>
            <Menu>
                <Menu.ItemsSource>
                    <CompositeCollection>
                        <MenuItem Header="A"></MenuItem>
                        <MenuItem Header="B"></MenuItem>
                        <MenuItem Header="C"></MenuItem>

                        <CollectionContainer x:Name="dynamicMenuItems">
                        </CollectionContainer>

                        <MenuItem Header="D"></MenuItem>

                    </CompositeCollection>
                </Menu.ItemsSource>

            </Menu>
                </ToolBar>
        </ToolBarTray>
    </Grid>
</Window> 
```

这是代码隐藏：

```
using System.Collections.ObjectModel;
using System.ComponentModel;
using System.Windows;

namespace WPFDynamicMenuItems
{
    /// <summary>
    /// Interaction logic for Window1.xaml
    /// </summary>
    public partial class Window1 : Window
    {
        private MainMenuViewModel _mainMenuVM = new MainMenuViewModel();

        public Window1()
        {
            InitializeComponent();

            this.dynamicMenuItems.Collection = this._mainMenuVM.CommandList;
        }
    }

    public class MainMenuViewModel : INotifyPropertyChanged
    {
        private ObservableCollection<CommandViewModel> m_CommandVMList;

        public MainMenuViewModel()
        {
            m_CommandVMList = new ObservableCollection<CommandViewModel>();
            CommandViewModel cmv = new CommandViewModel();
            cmv.DisplayName = "Dynamic Menu 1";
            m_CommandVMList.Add(cmv);
            cmv = new CommandViewModel();
            cmv.DisplayName = "Dynamic Menu 2";
            m_CommandVMList.Add(cmv);
            cmv = new CommandViewModel();
            cmv.DisplayName = "Dynamic Menu 3";
            m_CommandVMList.Add(cmv);

            CommandViewModel nestedCMV = new CommandViewModel();
            nestedCMV.DisplayName = "Nested Menu 1";
            cmv.CommandList.Add(nestedCMV);

            nestedCMV = new CommandViewModel();
            nestedCMV.DisplayName = "Nested Menu 2";
            cmv.CommandList.Add(nestedCMV);
        }
        public ObservableCollection<CommandViewModel> CommandList
        {
            get { return m_CommandVMList; }
            set { m_CommandVMList = value; OnPropertyChanged("CommandList"); }
        }

        protected void OnPropertyChanged(string propertyName)
        {
            //  Hook up event...
        }

        #region INotifyPropertyChanged Members

        public event PropertyChangedEventHandler PropertyChanged;

        #endregion
    }

    public class CommandViewModel : INotifyPropertyChanged
    {
        private ObservableCollection<CommandViewModel> m_CommandVMList;

        public CommandViewModel()
        {
            this.m_CommandVMList = new ObservableCollection<CommandViewModel>();
        }

        public string DisplayName { get; set; }

        public ObservableCollection<CommandViewModel> CommandList
        {
            get { return m_CommandVMList; }
            set { m_CommandVMList = value; OnPropertyChanged("CommandList"); }
        }

        protected void OnPropertyChanged(string propertyName)
        {
            //  Hook up event...
        }

        #region INotifyPropertyChanged Members

        public event PropertyChangedEventHandler PropertyChanged;

        #endregion
    }
} 
```

# php - 跨 2 个表的 Mysql SQL 查询 - 不知道如何正确执行

> ID：911202
> 
> 赞同：0
> 
> 时间：2009-05-26T15:10:43.270
> 
> 标签：php, sql, mysql

我有 2 个这样设置的表（省略了不相关的行）：

```
> product
  - id
  - user_id

> thread
  - id
  - prod_id
  - user_id
  - due_date 
```

现在我想创建一个查询，从线程表中选择所有行：

1.  有一个（例如）“5”的thread.user_id
2.  有一个 prod_id，其中 product.user_id 为“5”

我假设有一种方法可以做到这一点，比如......

```
SELECT 
    thread.due_date 
FROM
    product, thread 
WHERE 
    thread.user_id='5' 
OR 
    // not sure how to finish it 
```

到目前为止，我只是使用 PHP 来执行此操作，但我真的很想将我的 SQL 知识提高一个档次，并尽可能通过 SQL 来实现它。

谢谢 -

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T15:16:30.433

您应该能够使用外部联接来执行此操作：

```
SELECT thread.* FROM thread 
LEFT OUTER JOIN product
ON thread.prod_id = product.id
WHERE thread.user_id = 5 OR product.user_id = 5 
```

您可能会发现的一个问题是，如果线程的用户 ID 为 5，但产品的用户 ID 为 5，您可能会获得重复的线程。但不确定这是否会成为您的问题。您也许可以`SELECT DISTINCT`用来删除这些（感谢 Alex Martelli）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T15:18:37.543

我会做类似的事情：

```
SELECT t.due_date
FROM thread t
INNER JOIN product p ON p.id = t.prod_id
WHERE t.user_id = 5 OR p.user_id = 5 
```

**编辑：** 我的例子是使用 SQL 92 标准。如果您想坚持使用原始帖子中的 SQL-89 样式连接，您可以执行以下操作：

```
SELECT thread.due_date
FROM product, thread
WHERE product.id = thread.prod_id
AND (thread.user_id = 5 OR product.user_id = 5) 
```

然而，请查看[Beginning MySQL——](http://books.google.com/books?id=TFrbhHHxuXUC&pg=PA11&lpg=PA11&dq=sql+92+89+standards&source=bl&ots=tgTnvQOFwl&sig=-fGy033WxWkduiqIbTtIArqo4Sk&hl=en&ei=uAwcSpFboOG2B6WQoegM&sa=X&oi=book_result&ct=result&resnum=10)它有关于这两个标准的一些很好的信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T15:24:37.063

```
SELECT thread.* LEFT OUTER JOIN product ON thread.prod_id=product.id WHERE thread.user_id=5 OR product.user_id=5; 
```

我不确定 SELECT 线程。* 但这是有道理的，因为该表。* 东西在授予权限时有效。

# unit-testing - 测试 NHibernate 的实体映射

> ID：911203
> 
> 赞同：0
> 
> 时间：2009-05-26T15:10:44.067
> 
> 标签：unit-testing, nhibernate

我正在为我流畅地映射的实体构建一些基本的 crud 方法。

我只是想知道在我运行 cud 测试方法时是否有一种简单的方法可以使事务执行回滚？

被测试的代码在里面执行提交

这是一个创建示例：

```
 public int? Create(IIdentifiable entity)
    {
        int? newId = null;
        using (ISession session = SessionFactoryProvider.NewSession)
        using (ITransaction transaction = session.BeginTransaction())
        {
            object newObj = session.Save(entity);
            newId = (int?)newObj;
            transaction.Commit();
        }

        return (int?)newId;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-15T18:02:37.780

如果您使用的是 xUnit.net，那么 contrib 项目中有一个 AutoRollback 属性。如果您愿意使用 System.Transactions，那么您可以在 session.Open() 之前创建一个新事务，并且 session 应该自动注册（除非您已将 ado.net 设置为不自动注册）。然后最后放弃。

我很久以前做过类似的事情：

```
public class TransactionalTest
{
    public TransactionalTest()
    {
        Transaction.Current = new CommittableTransaction();
    }

    ~TransactionalTest()
    {
        if (Transaction.Current != null &&
            Transaction.Current.TransactionInformation.Status !=
            TransactionStatus.Committed)
        {
            Transaction.Current.Rollback();
        }
    }
} 
```

然后让您的测试扩展 TransactionalTest。但是，我认为 NUnit、MbUnit 和 xUnit.net 都支持开箱即用或使用 contrib 项目的事务测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T16:37:36.963

检查[FUBUMVC Contrib](http://code.google.com/p/fubumvc-contrib/)以获得出色的 NHibernate CRUD 测试方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T15:13:18.647

嗯，我认为让您的方法创建会话并执行事务处理不是一个好主意....除非该方法也是服务边界。

假设您想在同一个事务中创建多个实体，您将如何处理？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-07T17:46:57.163

对于集成测试，我使用会话装饰器来自动提交和驱逐实体。您可以根据自己的情况对其进行调整：

```
public class AutoCommitAndEvictSession : SessionDecorator {

    public AutoCommitAndEvictSession(ISession session)
        : base(session) { }

    public override object Save(object obj) {
        object result;
        using (var tx = Session.BeginTransaction()) {
            result = Session.Save(obj);
            tx.Commit();
        }
        Session.Evict(obj);
        return result;
    }

    public override void Update(object obj) {
        CommitAndEvict(base.Update, obj);
    }

    public override void Delete(object obj) {
        CommitAndEvict(base.Delete, obj);
    }

    private void CommitAndEvict(Action<object> action, object entity) {
        using (var tx = Session.BeginTransaction()) {
            action.Invoke(entity);
            tx.Commit();
        }
        Session.Evict(entity);
    }
} 
```

您可以在此处通过示例找到有关使用的更多详细信息： [http ://www.agileatwork.com/integration-testing-with-nhibernate/](http://www.agileatwork.com/integration-testing-with-nhibernate/)

# php - 如何使用 javascript 从 MySQL 中检索数据

> ID：911208
> 
> 赞同：0
> 
> 时间：2009-05-26T15:12:40.020
> 
> 标签：php, javascript, ajax

我有一个用 PHP 编码的网页。此页面用于发布服务请求。所有服务与价格一起存储在两个单独的表中。

当用户选择各种服务时，我想获取所选服务的价格，并在每个服务的基础上显示它，以及所有服务的总和。

我们应该怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-26T15:15:28.627

您可以将所有变量作为隐藏变量添加到页面中，然后使用 Javascript 将它们添加起来，而不是对它们勾选的每个服务进行数据库查询。这将大大减少开销。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T15:20:52.377

我不完全确定您要做什么，但是您实际上无法使用 Javascript 从 MySQL 获取任何内容，但是您可以通过 xhr 请求一个 php 脚本来获取数据，然后处理它（将其添加等）通过javascript。

如果服务/价格的数量不是很大，您可以首先将它们全部加载到页面中，然后使用 javascript 添加内容并让服务器不理会。

有几个 javascript 框架和库可以让这种事情变得非常容易（xhr），你研究过那些吗？

[http://mootools.net](http://mootools.net) [http://dojotoolkit.com](http://dojotoolkit.com) [http://jquery.com](http://jquery.com) [http://www.prototypejs.org](http://www.prototypejs.org)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T15:30:46.130

如果您的数据太复杂而无法按照 ck 的建议进行预加载，您可以创建一个 PHP 页面，[生成 JSON 作为您的输出](http://extjs.com/learn/Tutorial:Creating_JSON_Data_in_PHP)。使用像[jQuery](http://www.jquery.org)这样的库，您可以将这些数据拉入页面进行处理。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T15:43:42.423

Ajax 一个将执行 MySQL 操作的 php 页面。确保真正保护这些东西，转义字符串，并确保检查发送的命令是否是您真正想要的命令。有些用户比其他用户更聪明，可能会使用您的 ajax 方法“删除 *”。

IMO 不是一个非常安全的想法，但如果使用 Ajax。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-10T15:09:16.987

不要在页面上预加载价格；使用 AJAX 来检索它们。您可能会做出一些在页面加载时不一定正确的假设，并且在某些情况下，您可能希望根据用户提供的数据来操纵价格。无论如何，您以后更有可能使用 AJAX。
通过 AJAX 查询数据库并不难实现，它使你的代码更加灵活，而且速度非常可靠。
去AJAX。

# javascript - 查看正在进行的 AJAX 调用的简单方法是什么？

> ID：911209
> 
> 赞同：9
> 
> 时间：2009-05-26T15:12:42.563
> 
> 标签：javascript, ajax, debugging, xmlhttprequest

我正在寻找可以让我看到所有 AJAX 子请求的东西（最好是 Firefox 扩展）。基本上，每当创建 XMLHTTPRequest() 时，我都想知道请求的 URL 以及随之传递的 GET 和 POST 变量（如果有的话）。

除非我错过了它，否则我在 Firebug 或 Web Developer Toolbar 中看不到任何类似的东西。

*（如果你很好奇，想要这个的主要原因是我想抓取一个使用 JS 加载其所有内容的网站的本地副本，我不想花几个小时挖掘他们的 JS 代码当我可以看到正在发出的子请求时。）*

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-26T15:13:39.083

[Firebug](http://getfirebug.com/)应该在 Net 面板中显示它。

**编辑**：此外，如果 Firebug 以一种使其无法使用的方式减慢 Firefox 的速度，就像有时对我一样，[WireShark](http://www.wireshark.org/)（以前称为 Ethereal）将分析您系统上的所有网络流量，包括 HTTP 和 AJAX 请求。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-26T15:13:55.713

[Fiddler 2](http://www.fiddler2.com/fiddler2/)是一个很好的查看 HTTP 流量的工具。

*** 2014 年更新 ***

自从我发表最初的帖子以来，Internet Explorer 和 Chrome 都添加了非常有用的内置开发人员工具。虽然我仍然支持和使用 Fiddler 进行非 Web 相关的 http 监控，或者当我需要真正深入挖掘并修改传输中的请求时，这些天我发现自己几乎使用 IE 或 Chrome 的内置工具，因为它们足以满足 99%我的需要。它们都有一个网络选项卡，您可以在其中监视 http 请求，以及用于调试网页的其他漂亮功能。

*   [Internet Explorer F12 工具介绍](http://msdn.microsoft.com/en-us/library/ie/gg589512(v=vs.85).aspx)
*   [Chrome 的 F12 工具的文档](https://developer.chrome.com/devtools)
*   如果您使用的是 FireFox [，上面提到的 FireBug也是一个很好的工具。](https://stackoverflow.com/a/911214/86860)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-26T15:16:59.747

我已经使用了几乎所有的大工具（fiddler、firebug、httpfox、live http headers）。如果您使用的是 Firefox ，我认为最好的一个是[HTTPFox](https://addons.mozilla.org/en-US/firefox/addon/6647)，因为它具有简单的过滤功能，允许您以原始或格式化的方式查看请求/响应的 JSON，并且整个界面非常干净。

此外，我不能没有[WFetch](http://www.microsoft.com/Downloads/details.aspx?FamilyID=b134a806-d50e-4664-8348-da5c17129210&displaylang=en)来测试 Web 服务和 AJAX 的东西。通常我会接受来自 HTTPFox 的请求并将其粘贴到 WFetch 中。这样我就不必每次都通过浏览器。我只是在 WFetch 中按 F5 来重放请求，然后直接修改请求。

旁注：在 WFetch 中，如果您有 POST 有效负载，请注意内容长度。如果您修改有效负载，则需要根据需要更改内容长度。出于这个原因，我将我的请求保存在一个文件中，并将 WFetch 指向该文件。在文件本身中，很容易知道行的长度并将内容长度更改为该长度。

[![替代文字](https://i.stack.imgur.com/HFhf3.png)](https://i.stack.imgur.com/HFhf3.png)
[（来源：[koreus.com](http://blog.koreus.com/wp-content/uploads/2008/09/httpfox.png)）]

[替代文字 http://www.port80software.com/assets/images/ld_wfetch3.gif](http://www.port80software.com/assets/images/ld_wfetch3.gif)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-26T15:15:21.420

Firebug 在 Net 面板和 Console 视图中显示它们。不过，您需要打开“显示 XMLHttpRequests”。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-26T15:22:53.730

还可以查看 Tamper Data。这是一个 Firefox 附加组件，可让您查看每个单独的 HTTP 请求（包括任何发布数据）和响应，以及两者的标头。我发现它对于调试 AJAX 问题非常有用……尽管 Firebug 工作得很好。

# c# - 插入链接表的触发器导致错误

> ID：911216
> 
> 赞同：1
> 
> 时间：2009-05-26T15:13:45.790
> 
> 标签：c#, windows-services, insert, triggers, linked-server

我遇到了一个触发器问题，该触发器将一个值插入到链接服务器上的同一个表中。这是有问题的触发器...

```
USE [localDB]
GO
/****** Object:  Trigger [dbo].[INS_New_Row]    Script Date: 05/26/2009 10:50:56 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:      <Author,,Name>
-- Create date: <Create Date,,>
-- Description: <Description,,>
-- =============================================
ALTER TRIGGER dbo.INS_New_Row
   ON  LOCALDB.dbo.WIQ
   AFTER INSERT
AS 
BEGIN
    INSERT INTO
        DRSERVER.LOCALDBCLONE.dbo.WIQ
    SELECT
              column1,
              column2,
              column3
    FROM
        inserted
END 
```

当我从我的应用程序向 LOCALDB.dbo.WIQ 中插入一行时，我收到以下错误...

> **System.Data.SqlClient.SqlException：如果语句包含没有 INTO 子句的 OUTPUT 子句，则 DML 语句的目标表“WIQ”不能有任何启用的触发器。**

问题是我在表上定义的这个（或任何其他）触发器中没有任何 OUTPUT 子句，目标表上也没有定义任何触发器。

我不确定为什么会收到此错误。奇怪的是，如果我从 SQL Server Management Studio 将值插入到列中，触发器运行正常，并且该行被复制到 DRSERVER 中，它只是来自应用程序的错误。

有问题的应用程序是用 C# 编写的 Windows 服务，可将行插入 LOCALDB.dbo.WIQ。

谢谢，

斯科特·维库斯基

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T16:40:38.813

事实证明，从我的应用程序调用的组件之一涉及一个存储过程，该过程将数据插入到表中并在其中包含一个 OUTPUT 子句。我不知道这个组件是如何运作的，我能够进行更改以减轻错误。

感谢所有阅读/思考我的问题的人。

# django - 将具有外键的 Django 模型序列化为 JSON 时设置最大递归深度

> ID：911230
> 
> 赞同：0
> 
> 时间：2009-05-26T15:15:52.167
> 
> 标签：django, google-app-engine, json

我有一个为 Google 的 App Engine 创建的 Django 模型，

```
Model A():
  propA = ReferenceProperty(B)

Model B():
  propB = ReferenceProperty(C)

Model C():
  propC = ReferenceProperty(B) 
```

我已经编写了自定义 Django 序列化程序，它将获取 ReferenceProperty(s) 的数据并沿初始模型对其进行序列化。

当我尝试序列化**Model A**的实例时会出现问题。我的自定义序列化程序将尝试获取**propA**，其中包含对**模型 C**的引用，因此序列化程序将获取**模型 C**，其中包含对**模型 B**的引用，并且递归继续进行。有什么方法可以在说 2 的深度后停止递归？

我的序列化程序是[链接文本的自定义版本](http://code.google.com/p/dojango/source/browse/trunk/dojango/util/__init__.py#97 "这个序列化器。")

**PS：**如果似乎需要，我愿意发布我的代码。我目前没有附加代码，因为我不在我的开发机器上。

谢谢，
阿伦·尚克·普拉萨德。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T18:12:03.543

只需修改您的函数以采用“深度”参数。每当您遵循 ReferenceProperty 时，以比传入的深度小 1 的深度调用函数。如果以 depth==0 调用函数，则返回 None 或任何其他适合您的情况的占位符值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T16:53:52.237

你为什么不正确地进行递归？任何递归操作都必须有一个[base case](http://en.wikipedia.org/wiki/Recursion_(computer_science)#Recursive_algorithms)，否则它将永远持续下去，正如您的问题所表明的那样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-12T05:56:03.643

我正在尝试找到一个可与 Google App Engine 一起使用并遵循关系的序列化程序。您是否可以发布您用来执行此操作的修改后的代码？

# perl - 如何在不使用 Perl 中的其他库的情况下发送电子邮件附件？

> ID：911231
> 
> 赞同：2
> 
> 时间：2009-05-26T15:15:53.853
> 
> 标签：perl, email, attachment

嘿，我想知道是否有一种方法可以在不使用[MIME::Lite](http://search.cpan.org/dist/MIME-Lite)或任何其他库的情况下将文件（特别是 .csv 文件）附加到 Perl 中的邮件消息。

现在，我有一个可以正常工作的“邮件功能”，但我不确定如何将其调整为附加文件。这是我所拥有的：

```
open(MAIL, "|/usr/sbin/sendmail -t");
print MAIL "To: cheese\@yahoo.com\n";
print MAIL "From: queso\@what.com\n";
print MAIL "Subject: Attached is $filename\n\n";
print MAIL "$message";
close(MAIL); 
```

我认为这是特定于 UNIX 的。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-26T15:29:25.277

为什么要编写已经存在的代码？解决您的任务可能有比重新创建错误和自己维护更多代码更好的方法。您在安装模块时遇到问题吗？您也可以通过多种方式将第三方模块与您的代码一起分发。

如果你想自己做，你只需要做模块为你做的同样的事情。你可以看看代码来看看他们做了什么。你就这么做。毕竟它是开源的。:)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-26T15:31:54.787

如果您的部分问题是您在共享主机上并且无法安装额外的库，那么它们通常可以安装在（并从）本地库（例如，~/lib）中使用。[此处](http://www.perlmonks.org/index.pl?node_id=128077)有相关说明（在“我无权在系统上安装模块！”下）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T15:22:07.273

让您的生活更轻松的一般风格提示：

*   [使用词法文件句柄](http://perldoc.perl.org/perlopentut.html#Indirect-Filehandles)
*   使用 3-arg-open
*   检查返回值

IE：

```
open my $mail, '|-', '/usr/sbin/sendmail', '-t'  or Carp::croak("Cant start sendmail, $! $@");

print $mail  "foo";

close $mail or Carp::croak("SendMail might have died! :( , $! $@"); 
```

[perldoc -f 打开](http://perldoc.perl.org/functions/open.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T15:23:12.497

您可以将邮件头指定为：

内容类型即：image/jpeg；name="file.jpg"
Content-Disposition（即）附件；filename="name.jpg"
Content-Transfer-Encoding (ie) base64

查看带有附件的电子邮件，这应该对您有所帮助。

诀窍是多部分边界。
[http://www.w3.org/Protocols/rfc1341/7_2_Multipart.html](http://www.w3.org/Protocols/rfc1341/7_2_Multipart.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-03-10T09:28:20.470

示例 - 通过电子邮件将压缩文件作为附件发送：

```
base64 /path/to/my/file.zip | mail -s "Subject" recipient@mydomain.com -a 'Content-Type: application/zip; name="myfile.zip"' -a 'Content-Disposition: attachment' -a 'Content-Transfer-Encoding: base64' 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2010-05-21T12:27:19.363

```
print "To: ";       my $to=<>;      chomp $to;
print "From: ";     my $from=<>;    chomp $from;
print "Attach: ";   my $attach=<>;  chomp $attach;
print "Subject: ";  my $subject=<>; chomp $subject;
print "Message: ";  my $message=<>; chomp $message;

my $mail_fh = \*MAIL;
open $mail_fh, "|uuencode $attach $attach |mailx -m -s \"$subject\" -r $from $to";
print $mail_fh $message;
close($mail_fh); 
```

# asp.net - 在 ASP:Repeater 中查找控件

> ID：911240
> 
> 赞同：2
> 
> 时间：2009-05-26T15:16:54.147
> 
> 标签：asp.net

我正在尝试访问中继器内的控件。该控件位于 <ItemTemplate> 标记内。我正在使用 FindControl，但它总是出现 Null。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T15:24:24.397

我的猜测是 FindControl 只能用于记录级事件，例如 ItemDataBound：

```
protected void Repeater1_ItemDataBound(object sender, RepeaterItemEventArgs e)
{
    (ControlTypeCast) e.Item.FindControl("myControl")).SomeProperty = "foo";
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T15:26:11.257

我猜你正试图在页面生命周期的错误点找到一个控件。ItemDataBound 事件是您需要查找的地方。

这个例子在 vb.net 中，但我相信你明白了。

```
Protected Sub rp_items_ItemDataBound(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.RepeaterItemEventArgs) Handles rp_items.ItemDataBound
    If e.Item.ItemType = ListItemType.Item OrElse e.Item.ItemType = ListItemType.AlternatingItem Then
        Dim someLiteral As Literal = e.Item.FindControl("someliteral")
    End If
End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T15:20:13.687

在大多数情况下，控件名称拼写错误:) 也可能是您正在搜索存在于另一个容器中的控件。你可以发布你的代码吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T15:21:59.927

试试这个

对于 vb.net

```
CType(e.Item.FindControl("myControl"), Literal).Text = "foo" 
```

对于 c#

```
[Literal]e.item.FindControl["myControl"].Text="foo"; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-21T11:17:03.947

```
 for (int i = 0; i <= repeater1.Items.Count - 1; i++)
         {
             Button delete = (Button)repeater1.Items[i].FindControl("btnDelete");
             delete.Visible = true;
             Button edit = (Button)repeater1.Items[i].FindControl("btnEdit");
             edit.Visible = true;
         } 
```

VB.net

```
 For i As Integer = 0 To Repeater1.Items.Count - 1

        Dim CmbTyp As DropDownList = DirectCast(Repeater1.Items(i).FindControl("DropDownList1"),DropDownList)
        Dim SeatN As Label = DirectCast(Repeater1.Items(i).FindControl("label1"), Label)

        styp = CmbTyp.SelectedItem.Text.Trim
        sNo = SeatN.Text

    Next 
```

# wpf - WPF：扩展 ListView 的 GridView 的最后一列

> ID：911243
> 
> 赞同：35
> 
> 时间：2009-05-26T15:17:13.053
> 
> 标签：wpf, listview, gridview

我有一个带有 3 列的 GridView 的 ListView。我希望最后一列占据 ListView 的剩余宽度。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-05-26T15:45:11.330

使用简单的 XAML 无法做到这一点，但有一些解决方案。看一下这个：

*   [ListView 布局管理器](http://www.codeproject.com/KB/grid/ListView_layout_manager.aspx)
*   [ListView 列的星号](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/83bd7ab9-3407-461f-a0bc-69e04870075c)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-03-11T10:54:41.977

又快又脏

xml:

```
<ListView SizeChanged="ListView_SizeChanged" Loaded="ListView_Loaded" >
    <ListView.View>
        <GridView>
            <GridViewColumn Header="col1" Width="100" />
            <GridViewColumn Header="col1" Width="Auto" />
            <GridViewColumn Header="col1" />
        </GridView>
    </ListView.View>
</ListView> 
```

CS：

```
private void ListView_SizeChanged(object sender, SizeChangedEventArgs e)
{
    UpdateColumnsWidth(sender as ListView);
}

private void ListView_Loaded(object sender, RoutedEventArgs e)
{
    UpdateColumnsWidth(sender as ListView);
}

private void UpdateColumnsWidth(ListView listView)
{
    int autoFillColumnIndex = (listView.View as GridView).Columns.Count - 1;
    if (listView.ActualWidth == Double.NaN)
        listView.Measure(new Size(Double.PositiveInfinity, Double.PositiveInfinity));
    double remainingSpace = listView.ActualWidth;
    for (int i = 0; i < (listView.View as GridView).Columns.Count; i++)
        if (i != autoFillColumnIndex)
            remainingSpace -= (listView.View as GridView).Columns[i].ActualWidth;
    (listView.View as GridView).Columns[autoFillColumnIndex].Width = remainingSpace >= 0 ? remainingSpace : 0;
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2011-06-30T02:28:28.383

有一种使用行为模式的方法

```
<ListView HorizontalAlignment="Stretch"
          Behaviours:GridViewColumnResize.Enabled="True">
        <ListViewItem></ListViewItem>
        <ListView.View>
            <GridView>
                <GridViewColumn  Header="Column *"
                                   Behaviours:GridViewColumnResize.Width="*" >
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <TextBox HorizontalAlignment="Stretch" Text="Example1" />
                        </DataTemplate>
                    </GridViewColumn.CellTemplate> 
```

请参阅以下链接以获取一些示例，并链接以阅读更多内容[http://lazycowprojects.tumblr.com/post/7063214400/wpf-c-listview-column-width-auto](http://lazycowprojects.tumblr.com/post/7063214400/wpf-c-listview-column-width-auto)

并查看源代码。查看 [https://github.com/rolfwessels/lazycowprojects/tree/master/Wpf](https://github.com/rolfwessels/lazycowprojects/tree/master/Wpf)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-07-15T20:53:40.000

如何使用样式

```
<Style x:Key="GridViewExtraStyle" TargetType="{x:Type GridViewColumnHeader}">
    <Setter Property="Background" Value="{x:Null}"/>
    <Setter Property="Foreground" Value="{x:Null}"/>
    <Setter Property="BorderBrush" Value="{x:Null}"/>
    <Setter Property="Width" Value="1000"/>
</Style>

<ListView>
    <ListView.View>
        <GridView>
            <GridViewColumn Header="Abc"/>
            <GridViewColumn Header="" HeaderContainerStyle="{DynamicResource GridViewExtraStyle}"/>
        </GridView>
    </ListView.View>
</ListView> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-26T00:43:13.167

我还没有看到单行/简单的 XAML 唯一解决方案。设置适合设计视图的宽度，然后修改窗口大小更改时的宽度，如下所示：

```
Private Sub winMain_SizeChanged(sender As Object, e As SizeChangedEventArgs) Handles Me.SizeChanged
    TryCast(lvwDownload.View, GridView).Columns(3).Width = lvwDownload.ActualWidth - 340
End Sub 
```

注意：当调整另一列的大小时，此逻辑不会更改/悬停列的宽度。用最后一列填充列表视图非常有用。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2021-05-18T14:56:15.987

仅适用于 XAML 的替代方法：创建一个相同大小的隐藏 Grid，对其进行所有调整，并将 GridView Width 绑定到各个 Grid 列的 ActualWidth。

例如，我想要一个 3 列的网格；第一列有一个固定大小的复选框，另外 2 列按 1:4 分割可用空间。

```
 <Grid Visibility="Hidden" Grid.Row="2">
        <Grid.ColumnDefinitions>
            <ColumnDefinition x:Uid="ColumnDefinition_1" Width="27" />
            <ColumnDefinition x:Uid="ColumnDefinition_2" Width="*" />
            <ColumnDefinition x:Uid="ColumnDefinition_3" Width="3*" />
        </Grid.ColumnDefinitions>
        <Grid x:Uid="col0" Grid.Column="0" x:Name="col0"/>
        <Grid x:Uid="col1" Grid.Column="1" x:Name="col1"/>
        <Grid x:Uid="col2" Grid.Column="2" x:Name="col2"/>
    </Grid> 
```

然后你可以像这样绑定宽度：

```
 <GridViewColumn DisplayMemberBinding="{Binding Name}" 
                      Header="First Name" 
                      Width="{Binding ElementName=col1, Path=ActualWidth}" /> 
```

可能需要一些额外的摆弄，以考虑边距和边框，但这是格式化 GridView 列长度的一种快速而肮脏（如果不一定优雅）的方式。

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2014-07-23T15:36:03.540

我使用了 Pale Ales 的建议，稍作改动：

```
<Style x:Key="GridViewExtraStyle" TargetType="{x:Type GridViewColumnHeader}">
    <Setter Property="Background" Value="{x:Null}"/>
    <Setter Property="Foreground" Value="{x:Null}"/>
    <Setter Property="BorderBrush" Value="{x:Null}"/>
</Style>

<ListView>
    <ListView.View>
        <GridView ColumnHeaderContainerStyle="{DynamicResource GridViewExtraStyle}">
            <GridViewColumn Header="Abc" Width="{Binding Path=mywidth}"/>
        </GridView>
    </ListView.View>
</ListView> 
```

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2015-05-30T16:45:46.170

你不能删除最后一列，但你可以做一点错觉。

```
 <ControlTemplate TargetType="GridViewColumnHeader">
                <Grid>
                    <ContentPresenter x:Name="HeaderContent"
                                          Content="{TemplateBinding Content}" ... />
                    <Thumb x:Name="PART_HeaderGripper" ... />
                </Grid>
                <ControlTemplate.Triggers>
                    <Trigger Property="HasContent"
                             Value="false">
                        <Setter Property="Visibility"
                                Value="Collapsed"
                                TargetName="PART_HeaderGripper" />
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate> 
```

# performance - 删除包含引用同一个表的列的行需要花费大量时间

> ID：911246
> 
> 赞同：2
> 
> 时间：2009-05-26T15:17:38.543
> 
> 标签：performance, postgresql, indexing, constraints

很抱歉提出一个非常具体的问题。

我有一张表（见底部），当我尝试从中删除很多记录时，我的 PostgreSQL 8.2.5 98% 的时间都在做父子约束。我试图弄清楚我应该添加什么索引以使其快速运行。我不得不说这张表上的所有列都有 0 或 null 作为`parent_block_id`：它是基本的。

我尝试添加不同的索引：just (parent_block_id); 在哪里 parent_block_id = 0; 其中 parent_block_id 为空；WHERE parent_block_id != 0。这些都没有导致严重的性能收益。

```
varshavka=> explain analyze delete from infoblocks where template_id = 112;
                                                 QUERY PLAN
-------------------------------------------------------------------------------------------------------------
 Seq Scan on infoblocks  (cost=0.00..1234.29 rows=9 width=6) (actual time=13.271..40.888 rows=40000 loops=1)
   Filter: (template_id = 112)
 Trigger for constraint $1: time=4051.219 calls=40000
 Trigger for constraint $2: time=1616.194 calls=40000
 Trigger for constraint cs_ibrs: time=2810.144 calls=40000
 Trigger for constraint cs_ibct: time=4026.305 calls=40000
 Trigger for constraint cs_ibbs: time=3517.640 calls=40000
 Trigger for constraint cs_ibreq: time=774344.010 calls=40000
 Total runtime: 790760.168 ms
(9 rows)

varshavka=> \d infoblocks
                                      Table "public.infoblocks"
     Column      |            Type             |                      Modifiers
-----------------+-----------------------------+------------------------------------------------------
 id              | integer                     | not null default nextval(('IB_SEQ'::text)::regclass)
 parent_block_id | integer                     |
 nm_id           | integer                     | default 0
 template_id     | integer                     | not null
 author_id       | integer                     |
 birthdate       | timestamp without time zone | not null
Indexes:
    "infoblocks_pkey" PRIMARY KEY, btree (id)
    "zeroparent" btree (parent_block_id) WHERE parent_block_id <> 0
Foreign-key constraints:
    "$2" FOREIGN KEY (nm_id) REFERENCES newsmakers(nm_id) ON DELETE RESTRICT
    "$5" FOREIGN KEY (author_id) REFERENCES users(user_id) ON DELETE RESTRICT
    "cs_ibreq" FOREIGN KEY (parent_block_id) REFERENCES infoblocks(id) ON DELETE CASCADE 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T15:21:15.683

您是否尝试过添加索引`template_id`？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T15:31:47.457

如果您可以暂时阻止其他人，也许可以删除约束`cs_ibreq`，删除，然后重新添加约束？

可能是因为只有一个非空值`parent_block_id`，所以在检查约束时没有使用索引？虽然这看起来有点奇怪。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T16:04:46.873

首先：当你注意到丑陋的查询时间时，你应该做的第一件事（第零个！）是确保你`VACUUM ANALYZE`最近有 d。

如果您只需要一次性删除，请参阅[araqnid 的回答](https://stackoverflow.com/questions/911246/postgresql-deleting-rows-with-column-that-references-the-same-table-takes-bizzar/911324#911324)。但是，如果您需要在某些行具有非零、非空`parent_block_id`字段时在未来继续工作的东西，请继续阅读。

`ON DELETE CASCADE`我猜测PostgreSQL 不会`EXPLAIN`将由 大概每一行都会使用索引查找 on 找到`parent_block_id`，但这仍然比单次扫描表要慢得多。

因此，您可以通过将 更改`ON DELETE CASCADE`为`ON DELETE RESTRICT`并手动编译需要在临时表中执行的所有删除的列表，然后一次将它们全部删除来获得很大的加速。 **如果层次结构的最大深度很小，这种方法将非常快。** 这是一些伪代码：

```
# Insert the top-level rows as "seed" rows.
INSERT INTO rows_to_delete
    SELECT id, 0 FROM infoblocks WHERE template_id = 112

# Gather all rows that are children of any row at depth curLevel,
# advancing curLevel until no more children are found.
curLevel = 0
while (nRowsReturnedFromLastInsert > 0) {
    INSERT INTO rows_to_delete
        SELECT ib.id, rtd.level + 1
        FROM infoblocks ib
        JOIN rows_to_delete rtd ON (ib.parent_block_id = rtd.id)
        WHERE rtd.level = curLevel

    curLevel = curLevel + 1
}

DELETE FROM infoblocks
    JOIN rows_to_delete rtd ON (infoblocks.id = rtd.id) 
```

（我不确定，但实际上您可能需要使用`ON DELETE NO ACTION`而不是`ON DELETE RESTRICT`最终`DELETE`成功 - 我不清楚是否`DELETE`允许单个语句在有效时删除父级及其所有后代`ON DELETE RESTRICT`。如果那是由于某种原因不可接受，您总是可以遍历多个`DELETE`语句，首先删除最底层，然后是下一个最底层，依此类推。）

# .net - 应用程序失去和获得焦点的 .NET 事件

> ID：911248
> 
> 赞同：3
> 
> 时间：2009-05-26T15:17:56.500
> 
> 标签：.net, winforms, focus

有没有一种简单的方法可以检测 .NET 应用程序何时获得或失去焦点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-26T15:25:28.233

您要查找的事件是[Form.Activated](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.activated.aspx)和[Form.Deactivated](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.deactivate.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T17:26:45.087

我很好奇这种技术如何在 MDI 应用程序中的各种条件下工作。事实证明，这并不适用于所有情况。

如果您的应用程序是 MDI 应用程序，则当应用程序本身失去/重新获得焦点时（如其他答案中所述），如果 MDI 表单中的非模态表单具有焦点，则主 MDI 表单将失去/获得焦点。但是，如果一个模态对话框打开（应用程序本身的模态），主 MDI 窗体不会失去/获得焦点（至少激活/停用事件似乎不会触发）。换句话说，如果您处理的只是 MDI 表单的激活/停用事件，那么如果模态表单具有焦点，您可能会错过应用程序失去/获得焦点的时间。

因此，似乎要使其正常工作，您需要处理 MDI 表单的激活/停用事件以及以模态方式打开的任何表单上的事件（通过 ShowDialog）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T15:24:33.133

采用：

```
this.LostFocus 
```

和：

```
this.GotFocus 
```

在最父窗体/窗口上

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T15:22:10.453

对于 WPF，窗口上的*FocusChanged 。*Winforms中应该有类似的事件。您可以在 Visual Studio 上使用智能感知。

*激活/停用*似乎是标准的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T15:23:37.627

在winforms中它已[激活](http://msdn.microsoft.com/en-us/library/system.windows.window.activated.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-26T15:24:10.107

处理主窗口的 Control.GotFocus 和 Control.LostFocus 事件。

# .net - 位于网站根目录时未附加 Visual Studio 调试器

> ID：911250
> 
> 赞同：4
> 
> 时间：2009-05-26T15:18:01.413
> 
> 标签：.net, asp.net, visual-studio, visual-studio-2008

当我在环境中运行时，我的 Visual Studio 2008 调试器没有附加到默认网站的根目录时出现问题。

我有一个在 Visual Studio 2008 SP1 上运行的 .NET 3.5 Web 应用程序项目。我已将项目设置为“使用本地 IIS Web 服务器”，路径为“ [http://localhost/](http://localhost/) ”。我能够创建虚拟目录并且应用程序编译得很好。

我的问题是当 Internet Explorer 启动时，调试器没有连接。我能够“附加到进程”并选择“w3wp.exe”，它会调试得很好。这是一个 PITA；为什么它不会自动附加？

我曾经在 VD 下运行这个完全相同的项目，并且从来没有遇到过调试器未附加的问题。想法？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-03T14:02:48.477

我遇到的问题与我的 web.config 中有一个标签围绕我的标签这一事实有关。这显然会导致调试器附加，然后立即出错，而没有任何警告或错误。这是我用来解决这个问题的文章：

*[无法使用顶级位置调试网站](http://www.west-wind.com/WebLog/posts/466163.aspx)*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T15:54:42.397

我会尝试使用管理员帐户运行 Visual Studio。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T16:06:08.370

您网站根目录和虚拟目录中的 Web 应用程序是否完全相同？
行为差异可能是由于您的网站项目的调试设置不正确造成的。对于不同的调试方式，有一些特殊的选项。其中之一是即时附加调试器并等待对网站的外部调用（这是您可能需要的）。
web.config 和 IIS 配置之间的差异也可能是不同行为的原因。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T02:39:03.677

我在 Visual Studio 中使用这个宏，我将它连接到 Visual Studio 中的快捷键。它基本上可以为您工作，使用调试器附加到 w3wp.exe。

我遇到了类似的问题，自动连接有时不完全按照我预期的方式工作。对我来说，这是一种享受。我也不喜欢 Internet Explorer 自动启动，因为我通常在 Firefox 中进行测试。所以这个宏不会触发我喜欢的 Internet Explorer 自动启动。

```
Imports System
Imports EnvDTE
Imports EnvDTE80
Imports EnvDTE90
Imports System.Diagnostics

Public Module AttachToWebServer

    Public Sub AttachToWebServer()

        Dim AspNetWp As String = "aspnet_wp.exe"
        Dim W3WP As String = "w3wp.exe"

        If Not (AttachToProcess(AspNetWp)) Then
            If Not AttachToProcess(W3WP) Then
                System.Windows.Forms.MessageBox.Show(String.Format("Process {0} or {1} Cannot Be Found", AspNetWp, W3WP), "Attach To Web Server Macro")
            End If
        End If
    End Sub

    Public Function AttachToProcess(ByVal ProcessName As String) As Boolean
        Try
            Dim ProcessFound As Boolean = False
            Dim dbg2 As EnvDTE80.Debugger2 = DTE.Debugger
            Dim trans As EnvDTE80.Transport = dbg2.Transports.Item("Default")
            Dim dbgeng(10) As EnvDTE80.Engine
            Dim indexer As Integer = 0

            For Each myEngine As Engine In trans.Engines
                'Possible values here could be "T-SQL","Native","Managed","Workflow" "Managed/Native", "Script"
                If myEngine.Name.Equals("Managed") Then
                    dbgeng(indexer) = myEngine
                    indexer += 1
                End If
            Next

            Dim processes As EnvDTE.Processes = dbg2.GetProcesses(trans, "localhost")
            For Each Process As EnvDTE80.Process2 In processes
                If Process.Name.Contains(ProcessName) Then
                    Process.Attach2(dbgeng)
                    ProcessFound = True
                End If
            Next
            Return ProcessFound
        Catch ex As System.Exception
            MsgBox(ex.Message)
        End Try
    End Function

End Module 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-12-29T10:37:14.337

还有另一个原因具有相同的令人讨厌的行为。

如果您的解决方案包含多个网站项目，那么 Visual Studio 将启动所有这些项目，即使您仅将其中一个网站项目设置为启动项目。但是，Visual Studio 只会附加到您已配置为启动项目的网站。

也可以将解决方案配置为具有多个启动项目。如果您以 Visual Studio 将启动所有网站项目的方式配置解决方案，那么您最终将遇到与上述相同的情况 - 即：每个网站项目都有一个正在运行的 dev-webserver - 但具有 Visual Studio 的额外优势Studio 连接到所有网络服务器。

# c# - 可以在窗口 C# 中使用 javascript

> ID：911258
> 
> 赞同：1
> 
> 时间：2009-05-26T15:19:53.453
> 
> 标签：c#, .net, javascript

我想在窗口平台中使用 AJAX 和 javascript ...我可以在 vs 05 C# 窗口中使用它吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T15:22:23.667

我知道的选项：

1.  **JSC.exe**
    您可以将 Javascript 编译为托管程序集，并像调用任何 .NET 程序集一样调用它。
2.  **COM**
    您可以将 Javascript 逻辑打包为 COM，并从 .NET 或任何 COM 环境中调用它。 [例子](https://stackoverflow.com/questions/848246/how-can-i-use-javascript-within-an-excel-macro)。

**编辑**：这允许 Javascript，但不允许 AJAX。AJAX 是一个专门适用于浏览器的术语，主要使用 Javascript 来检索信息并可能动态更新浏览器页面，而无需显式刷新页面。这在用 C# 构建的 Windows 窗体应用程序中通常没有意义，因为您有 C#，并且异步内置于 .NET 平台。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T15:23:38.407

Erm - AJAX 只是用于在 Javascript 中发出 HTTP 请求的技术和模式的名称。Javascript 本身将在任何 Javascript 引擎中运行；大多数浏览器都嵌入了一个，您也可以使用[Rhino](http://www.mozilla.org/rhino/)独立引擎（尽管很多 Javascript 会假设浏览器环境，这可能会变得不稳定）。

C# 不是 Javascript，据我所知，Visual Studio 不是 Javascript 解释器。你为什么要这样做？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T15:24:31.557

您只需将[System.Windows.Forms.WebBrowser](http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.aspx)添加到您的应用程序，将其导航到您想要的任何 HTML + JS 页面，然后在那里执行所有您想要的 AJAX。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-11T11:41:06.377

您可以使用[Rhino](http://www.mozilla.org/rhino/) javascript 引擎，在[IKVM上运行](http://www.ikvm.net/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T15:23:32.510

您不能使用 JavaScript/JScript 编写代码作为 Windows 窗体应用程序的一部分。看来您正在使用需要单独实现的异步数据传输功能 (posh ;) / AJAX。或者，如果您希望为用户提供脚本语言，请尝试[IronPython](http://codeplex.com/IronPython)

如需更详细的答案，请在问题中说明您想要使用的 JavaScript 的特定部分，我们将提供替代方案。

**编辑**：哦。你可以！看看上面的答案。

# c++ - 在 C++ 中使用服务器分配连接的点对点聊天程序的良好实现是什么？

> ID：911263
> 
> 赞同：1
> 
> 时间：2009-05-26T15:20:29.850
> 
> 标签：c++, client-server, implementation, chat, p2p

有一段时间，我一直对使用 C++ 创建一个概念验证聊天程序很感兴趣。我已经对这个想法进行了很多思考，甚至​​写下了我将如何设计系统的开始，但在实施时我遇到了一个障碍。

我想知道在 C++ 中使用服务器路由连接的点对点聊天客户端的实现是什么样的。

服务器将用作对等点的中央注册表，但不用作主要连接。除了在对等点之间分配连接以实现对等点之间的最佳路径之外，服务器不会以任何方式与客户端交互。在第一个版本中，它只是一个所有客户端都连接到的目录，然后客户端可以使用该目录连接到其他可用于聊天的客户端。（我希望这能解释得更多）。:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T15:27:23.470

你应该看看[XMPP](http://en.wikipedia.org/wiki/Extensible_Messaging_and_Presence_Protocol)的东西。这完全是关于路由和协调消息传递。它使用去中心化和类似点对点的架构。

还有很多开源实现。例如，

*   [Jabber.org](http://en.wikipedia.org/wiki/Jabber.org)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T16:59:22.397

我真的想不出比 Boost.Asio 文档中的聊天示例更好的东西。在 Boost.Asio 中搜索示例文档。

# actionscript-3 - 停止对象引用为 3

> ID：911265
> 
> 赞同：1
> 
> 时间：2009-05-26T15:20:37.540
> 
> 标签：actionscript-3, flex3, flash-cs4, flash-cs3, cs3

如果我做 tempObj = obj，我现在有一个对象和一个临时对象

并更改 tempObj 中的内容，他们更改对 obj 有影响有没有办法阻止它这样做？问候马克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T15:28:15.497

这是许多语言的标准行为。当您执行 tempObj = obj 时，您不会创建重复的对象。您正在创建对同一对象的另一个引用。

我不认为你可以改变这种行为，当然我认为你不应该:)

您需要的是创建另一个对象，即原始对象的副本。你可以实现一个函数来做到这一点。也许这可以帮助 [http://blog.comtaste.com/2007/10/improving_object_copy.html](http://blog.comtaste.com/2007/10/improving_object_copy.html)

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T03:16:32.370

您正在做的是引用原始对象而不是原始对象的副本。您应该创建对象的深层副本。似乎有人已经编写了这样做的步骤......

[http://www.as3dp.com/2008/09/23/actionscript-30-clone-a-prelude-to-the-prototype-design-pattern/](http://www.as3dp.com/2008/09/23/actionscript-30-clone-a-prelude-to-the-prototype-design-pattern/)

希望这可以帮助

# c# - COM 组件中的 Server.MapPath

> ID：911271
> 
> 赞同：4
> 
> 时间：2009-05-26T15:21:29.740
> 
> 标签：c#, com, asp-classic, vbscript

我正在将旧的 VBSCript WSC 组件重写为更好的 C# COM 组件。

由于一个可怕的原因，旧组件在一个地方被传递给服务器上下文，IServer 通过使用

```
Set objCurr = CreateObject("MTxAS.AppServer.1")
Set objCurrObjCont = objCurr.GetObjectContext()
Set component.servercontext = objCurrObjCont("Server") 
```

然后用它来做一个标准`Server.MapPath("/somelocation")`

但是，我对在 .Net COM 组件中做什么感到困惑，`System.Web.HttpContext.Current.MapPath()`由于没有 Web 上下文，因此无法按预期工作。

我尝试将上下文从 Classic ASP 传递到 COM 组件，但我不确定要包含哪个引用，因此我可以调用正确的成员，Microsoft.Active X Data Objects 2.7 似乎很常见，但这仅包括 Recordsets 等，没有对于 C++ IServer 接口，所以它就像一个`COM OBJECT`.

有谁知道这样做的方法/解决方法？以这种速度，我想我可能不得不改变组件的行为

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-28T10:10:25.330

将 ASP.dll 的互操作添加到您的 C# 项目（您将在 \system32\inetsrv 文件夹中找到它。

向由 ASP 实例化的类添加公共方法：-

```
 ASPTypeLibrary.ScriptingContext context;
 public void OnStartPage(ASPTypeLibrary.ScriptingContext sc)
 {
     context = sc;
 } 
```

现在，当您需要 MapPath 时，请使用：-

```
 context.Server.MapPath("..."); 
```

Note context 使您可以访问除 Server 之外的 Request、Response 和 Session。OnStartPage 是 ASP 使用的 pre-COM+ hack，即使在最新版本中仍然有效。ASP 执行与 COM 等效的反射（检查 COM 类类型库信息）以确定公共 OnStartPage 方法是否可用，如果可用，则调用它并传递 ScriptingContext 对象。

没有 .NET HttpContext 可用，该请求必须首先由 .NET 处理才能存在。A HttpContext 不能像“事后”那样在线程上创建。因此，如果您的组件需要与 Http 对话进行交互，则必须通过 ASP 上下文对象进行交互，因为 ASP 是实际处理请求的主机。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T15:26:34.360

我认为确实改变行为是这里最好的选择......嗯......不完全是行为，而是COM对象的接口......而不是传递服务器上下文，只需传递所需的相关信息方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T15:26:01.743

为什么不将“/somelocation”的完整路径传递给您的 C# COM 组件？这将帮助您摆脱一些丑陋的依赖关系。

* * *

更新：您可能想尝试[HostingEnvironment.MapPath](http://msdn.microsoft.com/en-us/library/system.web.hosting.hostingenvironment.mappath.aspx)。您需要在使用之前添加对 System.Web 的引用。

# python - Django/Python 用户警告错误

> ID：911273
> 
> 赞同：0
> 
> 时间：2009-05-26T15:22:09.910
> 
> 标签：python, django

我不断收到这个错误/警告，这很烦人，想看看我是否可以修复它，但我不确定从哪里开始（我是新手）：

```
/home/simi/workspace/hssn_svn/hssn/../hssn/log/loggers.py:28: UserWarning: ERROR: Could not configure logging
  warnings.warn('ERROR: Could not configure logging', UserWarning) 
```

当我这样做时，我得到了这个：

```
python manage.py runserver
python manage.py syncdb
python manane.py shell 
```

非常感谢任何指导。

谢谢，--西米

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T16:33:10.373

您是否对正在使用的应用程序中的所有文件具有写入权限。还要确保您正确设置了 settings.py 中的所有内容，确保存在指定的路径并且您拥有权限。

# java - 如何找到 TIBCO Rendezvous 消息的字节编码？

> ID：911278
> 
> 赞同：1
> 
> 时间：2009-05-26T15:22:41.950
> 
> 标签：java, character-encoding, nio, tibco

在我的 Java 应用程序中，我将 TIBCO RV 消息作为字节归档到文件中。

我正在编写一个可以回放消息的小型实用程序。这样我就可以从字节中创建一个 TibrvMsg 对象，而无需解析文件并手动构造对象。

我遇到的问题是我正在读取在 Linux 机器上创建的文件，并尝试在 Windows 机器上运行我的应用程序。由于文件写入的字符集不同，我收到错误消息。

所以现在，我想要做的是将每条消息记录在一个特定的字符集（UTF-8）中，这样我就不关心我在哪个平台上运行我的播放应用程序了。该应用程序应该只在事先知道的文件中读取写入文件的字符集。我计划为此使用 java.nio 包，将字节从一个字符集转换为另一个字符集。

我是否需要知道 TIBRV 消息字节编码的字符集以进行转换？如果是这样，我怎样才能找到这个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T17:04:44.913

您正在获取不透明的数据，并且看起来，它试图将其作为文本数据写入文件而不转义它的非文本部分（或者您将其作为原始字节写入，然后尝试读取它，就好像它是基于字符的这是相同的问题）。这从一开始就是有缺陷的。

不透明的数据应该被视为无意义的，无需修改即可简单地存储，以返回给知道如何处理它的 API。如果数据必须以文本形式存储，则必须*无损*地将字节转换为文本。适当的编码是 base64 之类的东西。如果将其应用于原始二进制数据，则字符集编码意义上的编码不是无损的。

只需将字节作为*字节*（而不是字符）存储在文件中，以及指示消息长度和发送主题的固定长度前缀就足以通过系统重播 RV 消息。

关于消息中任何基于文本的字段，如果编码很重要（我强烈建议在设计应用程序时通常避免这个问题），那么您在重播时会遇到与原始接收时间相同的问题，即转换从源编码到所需的编码（希望使用完全相同的代码），所以这对于重放应该不是问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T15:28:10.020

正如这个（诚然相当陈旧的）[邮件列表消息](https://web.archive.org/web/20091030161202/http://www.ethereal.com/lists/ethereal-users/200603/msg00092.html)所表明的那样，对该网络协议的内部结构知之甚少。这可能会给你所追求的事情带来很大的挑战。

也就是说，如果消息只是二进制数据块（从网络捕获），它们甚至不应该有字符集。Charsets 用于文本数据，它很重要，因为单个字符可以以多种不同的方式编码。二进制数据不是由字符组成的，因此在这种意义上不可能存在编码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T15:30:32.327

这可能与 Java 字符串编码有关，而不是 TIBRV。虽然文档中有这个：

```
字符串和字符编码

-------------------------------------------------- ------------------------------

Rendezvous 软件在几个角色中使用字符串：

* 消息字段内的字符串数据
* 字段名称
* 主题名称（以及其他相关的字符串不是
  严格在消息内）
* 经认证的交货通讯员姓名
* 组名（容错）

所有这些字符串（C 和有线格式）都使用字符
适合发件人的 ISO 区域设置的编码。例如，
美国是语言环境 en_US，并使用 Latin-1 字符
编码（也称为 ISO 8859-1）；日本是语言环境 ja_JP，并使用
Shift-JIS 字符编码。

当两个程序在同一语言环境中交换消息时，字符串
总是正确的。但是，当消息发送方和接收方使用
不同的字符编码，接收程序必须转换
根据需要在编码之间。集合点软件不转换
自动地。

EBCDIC
有关 EBCDIC 环境中的字符串编码的信息，
见 tibrv_SetCodePages() 。

```

因此，您可能想查看机器的语言环境。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T15:46:36.473

> 我是否需要知道 TIBRV 消息字节编码的字符集以进行转换？

是的。字符集是一种将文本转换为字节流的方法，反之亦然。您的网络数据是一个字节流，因此当您将其部分解释为文本时，您是（隐式或显式）使用字符集 - 问题是它是否正确。

将字节从一个字符集转换为另一个基本上意味着使用一个字符集将它们转换为文本，然后使用另一个字符集转换回字节。请注意，这可能会导致数据长度发生变化，因为许多字符集对某些字符使用超过 1 个字节。在网络消息的上下文中，当它使长度字段无效或导致文本字段溢出时，这可能会出现问题。最好不要进行任何转换，而是教阅读应用程序学习如何处理不同的字符集。

> 如果是这样，我怎样才能找到这个？

查看协议规范。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T18:45:57.563

从 inputStream 中读取字节 [] 中的所有内容，将字节 [] 写入到 FileOutputStream。

不应该涉及读者或作家，他们会进行字符转换，这是错误的。

在您了解 java.io 之前，请远离 java.nio。

# c - C中的内存映射文件

> ID：911296
> 
> 赞同：3
> 
> 时间：2009-05-26T15:25:23.567
> 
> 标签：c, memory, file-io, transparency, library-interposition

我正在玩 C 中的内存映射文件，想知道是否有办法用内存映射文件透明地替换 fopen 中的 FILE *。

例子：

```
FILE * fp = g_fopen(...);

//Program does things to this fp.

fclose(); 
```

但相反，是否有可能 FILE *fp = my_fopen(...)

我自己的函数会在磁盘上打开一个文件 mmap 它，可能会更改内容，然后传回 FILE *，除了新的 my_fopen() 和 my_fclose() 之外，程序没有看到任何不同。

这是否可以在不必重写程序中完成操作的方式的情况下完成？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-26T15:29:50.923

神奇的词是“图书馆介入”。这是一个很好的教程：http: ~~[//developers.sun.com/solaris/articles/lib_interposers.html](http://developers.sun.com/solaris/articles/lib_interposers.html)~~

* * *

当 Oracle 购买 sun 时，许多文章似乎已经消失和/或无法通过 Oracle 的网站访问。

以下是一些暂时可用的链接：

*   这是发表于 2001 年的原始文章：[Building Library Interposers for Fun and Profit](http://www.drdobbs.com/building-library-interposers-for-fun-and/184404926) (Dr. Dobbs)
*   developer.sun.com 链接是原作者的转贴，可能与 2001 年的文章有所不同；这是转贴：[使用库插入器进行调试和性能调整](https://web.archive.org/web/20120626005255/http://developers.sun.com/solaris/articles/lib_interposers.html)（Wayback Machine）
*   Sun Studio / Oracle Solaris Studio的[链接器和库指南](http://docs.oracle.com/cd/E19120-01/open.solaris/819-0690/chapter3-26/index.html)。它涵盖了具有更多技术细节的库插入主题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T15:34:53.097

内存映射文件 IO 的目的不是通过系统调用进行读写，而是依靠 VM/缓冲区缓存来完成工作。如果隐藏文件已被内存映射的事实，这里有什么优势？你怎么知道文件映射在哪个地址？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T15:34:14.143

我不明白。您可以对已映射的文件使用读/写，因此您的 my_fopen 看起来像这样

```
FILE * my_fopen()
{
    FILE * myfp
    myfp = fopen(...);
    mmap(fileno(myfp),...);
    return myfp;
} 
```

# c# - 林克困境

> ID：911316
> 
> 赞同：1
> 
> 时间：2009-05-26T15:30:04.667
> 
> 标签：c#, linq

我无法有效地选择我需要显示的信息。希望其他人对如何解决这个问题有更好的想法。

给定以下数据结构，

```
public class Department
{
   public int ID { get; set; }
   public string Name { get; set; }
   public IList<Product> Products{ get; set; }
}

public class Product
{
   public int ID { get; set; }
   public string Name { get; set; }
} 
```

并给出以下数据

```
Department1 = 
{
    Id=1,
    Name="D1",
    Products = {new Product{Id=1, Name="Item1"}, new Product{Id=2, Name="Item2"}
}

Department2 = 
{
    Id=2,
    Name="D2",
    Products = {new Product{Id=2, Name="Item2"}, new Product{Id=3, Name="Item3"}
} 
```

**如何选择“Item2”对“D1”和“D2”都是通用的？**

我曾尝试使用交集查询，但它似乎希望两个延迟查询执行计划相交，而不是两个 IEnumerable 列表或 IList。

对此的任何帮助将不胜感激。

编辑：看起来我试图让事情保持简单并不是很精确。

我有一个部门列表，每个部门都包含一个产品列表。鉴于这些列表，我如何根据特定标准选择另一个产品列表。在这种情况下，我的标准是我只想选择存在于我所有部门中的产品。我只想要与所有元素相交的数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T15:59:50.817

我的[相交](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.intersect.aspx)函数工作正常：

```
 Department department1 = new Department
        {
            Id = 1,
            Name = "D1",
            Products = new List<Product> () { new Product { Id = 1, Name = "Item1" }, new Product { Id = 2, Name = "Item2" } }
        };

        Department department2 = new Department
        {
            Id = 2,
            Name = "D2",
            Products = new List<Product>() { new Product { Id = 2, Name = "Item2" }, new Product { Id = 3, Name = "Item3" } }
        };

        IEnumerable<Product> products = department1.Products.Intersect(department2.Products, new ProductComparer());

        foreach (var p in products)
        {
            Console.WriteLine(p.Name);
        } 
```

**（编辑）**

```
 public class ProductComparer : IEqualityComparer<Product>
    {
        public bool Equals(Product x, Product y)
        {
            return x.Name == y.Name && x.Id == y.Id;
        }

        public int GetHashCode(Product obj)
        {
            return obj.Id.GetHashCode() ^ obj.Name.GetHashCode();
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T16:03:15.817

如果您想使用 Linq，那么您可以展平 Products 集合并将每个集合与父 Department 对象相关联（这样您就有了 (Product, Department) 对的集合），然后在 Product 上重新分组。

```
var sharedItems = new[] { department1, department2 }
                .SelectMany(d => d.Products, (dep, prod) => new { Department = dep, Product = prod })
                .GroupBy(v => v.Product)
                .Where(group => group.Count() > 1); 
```

此查询的结果是 IGroupings 的枚举，其中键是产品并包含具有该产品的部门。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T16:07:36.760

```
// Get a list of all departments.
IEnumerable<Department> departments = GetAllDepartments();

// Get a list of all products.
var products = departments.SelectMany(d => d.Products).Distinct();

// Filter out all products that are not contained in all departments.
var filteredProducts = products.
    Where(p => departments.All(d => d.Products.Contains(p))); 
```

如果合并这两个查询，您会得到以下结果。

```
var filteredProducts = departments.
    SelectMany(d => d.Products).
    Distinct().
    Where(p => departments.All(d => d.Products.Contains(p))); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T15:53:44.010

也许我不完全理解这个问题，但这会起作用吗？

```
var commonProducts = new List<Product>();

Department1.Products.ForEach(delegate(Product product)
{
    if (Department2.Products.Contains(product))
    {
        commonProducts.Add(product);
    }
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T15:59:52.093

使用 SelectMany 生成产品/部门对的扁平列表（可能在匿名类中），然后使用 GroupBy 按产品名称分组（并处理例如同一部门中同一产品的多个实例）。

以后有机会会扩大。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-26T16:43:35.330

将每个部门投影到一个`IEnumerable<Product>`. 聚合产品列表 - 使用第一个作为起点并在其余列表中相交。

```
List<Product> commonProducts = departments
  .Select(d => d.Products.AsEnumerable() )
  .Aggregate( (soFar, nextList) => soFar
    .Intersect(nextList, productComparer) )
  .ToList() 
```

您必须实现一个 ProductComparer 来解决引用相等性 - 如果 Product 是一个结构，您就不必这样做。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-05-26T16:01:39.923

LINQ 查询语法更适合这些类型的查询：

```
var q = from p1 in Department1.Products
        join p2 in Department2.Products
        on p1.Id equals p2.Id
        select p1;

foreach (Product p in q) Console.WriteLine(p.Name); 
```

# iphone - 在 iPhone 上控制自动更正视图位置

> ID：911323
> 
> 赞同：13
> 
> 时间：2009-05-26T15:31:26.613
> 
> 标签：iphone, objective-c

有没有办法控制在输入 a 时弹出的自动正确视图的位置`UITextField`？

默认情况下，它似乎总是出现在文本字段下方。然而，在像 SMS 这样的 Apple 应用程序中，它有时会出现在文本字段上方。

对于在键盘正上方对齐的文本字段，自动更正被键盘阻止并且不可用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-06-18T10:16:25.603

自动更正提示的位置由 UITextInput 协议的 firstRect... 方法确定。不幸的是 UITextField 使用一个私有类作为这个协议的委托，所以你不能继承和覆盖它。

但是，您可以通过自己绘制内容（如使用 CoreText）来实现您自己的 UITextField 替换，实现您自己的选择和放大镜处理，然后您将能够影响自动更正提示的位置。尽管它被设计为始终位于编辑后的文本下方，但您基本上必须依赖 firstRect ... 方法。

长话短说：太麻烦了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T04:21:56.980

这是一个使用私有 API 的解决方案，因为没有办法使用公共 API 来做到这一点。

*   通过应用程序的 -windows 属性查找私有 UITextEffectsWindow 窗口并找出它的框架。这是键盘
*   通过 TextView 的子视图寻找私有 UIAutocorrectInlinePrompt 视图。这是自动更正气泡。
*   将该子视图移动到单独的包装视图（添加到 TextView）中，然后移动该包装视图，使其位于上述键盘窗口的上方。

使用 swizzled layoutSubViews，

```
- (void) moveSpellingCorrection {
for (UIView *view in self.subviews)
{
    if ([[[view class] description] isEqualToString:@"UIAutocorrectInlinePrompt"])
    {
        UIView *correctionShadowView = nil; // [view correctionShadowView];

        for (UIView *subview in view.subviews)
        {
            if ([[[subview class] description] isEqualToString:@"UIAutocorrectShadowView"])
            {
                correctionShadowView = subview;
                break;
            }
        }

        if (correctionShadowView)
        {
            UIView *typedTextView = nil; //[view typedTextView];
            UIView *correctionView = nil; //[view correctionView];

            for (UIView *subview in view.subviews)
            {
                if ([[[subview class] description] isEqualToString:@"UIAutocorrectTextView"])
                {
                    if (CGRectContainsRect(correctionShadowView.frame,subview.frame))
                    {
                        correctionView = subview;
                    }
                    else
                    {
                        typedTextView = subview;
                    }
                }

            }
            if (correctionView && typedTextView)
            {

                CGRect textRect = [typedTextView frame];
                CGRect correctionRect = [correctionView frame];
                if (textRect.origin.y < correctionRect.origin.y)
                {
                    CGAffineTransform moveUp = CGAffineTransformMakeTranslation(0,-50.0);
                    [correctionView setTransform: moveUp];
                    [correctionShadowView setTransform: moveUp];

                    CGRect windowPos = [self convertRect: view.frame toView: nil ];
                    [view removeFromSuperview];
                    [self.window addSubview: view];
                    view.frame = windowPos;
                }

            }
        }

    }

} 
```

}

有关更多详细信息，[请查看](https://stackoverflow.com/questions/1977249/how-to-move-uitextview-correction-suggestion-above-text)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T11:25:05.757

对我有用的一个答案是使用 textview/textview 的 setInputAccessoryView 方法。我有一个包含 textView 的工具栏。如果我将工具栏设置为文本字段的 inputaccessoryview，并设置为工具栏的 NO clipsToBound 属性，我不知道确切原因，但气球出现在键盘上方

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-07-24T04:42:46.010

在我的例子中，自动更正视图的位置由于字体的前导（行间距）而发生了变化。

因此，我尝试使用 firstRect 函数将其移到前导 px 上，如下代码所示。

```
class CustomTextView: UITextView {
    override var font: UIFont? {
        didSet {
            if let font = font {
                leadingFont = font.leading
            } else {
                leadingFont = 0
            }
        }
    }
    var leadingFont: CGFloat = 0

    override func firstRect(for range: UITextRange) -> CGRect {
        var newRect = super.firstRect(for: range)
        newRect.origin = CGPoint(x: newRect.origin.x, y: newRect.origin.y - leadingFont)
        print("newRect: \(newRect)")
        return newRect
    }
} 
```

虽然它是 UITextView 但你可以用 UITextField 做同样的事情

# sql-server - 用于计算运行平均列的 SQL Select 语句

> ID：911326
> 
> 赞同：7
> 
> 时间：2009-05-26T15:32:07.330
> 
> 标签：sql-server, tsql, sql-server-2008, aggregate

我试图在 SELECT 语句中根据同一 SELECT 语句中前 n 行中的列创建一个运行平均列。我需要的平均值基于结果集中的前 n 行。

让我解释

```
Id        Number       Average
 1             1          NULL
 2             3          NULL
 3             2          NULL
 4             4             2 <----- Average of (1, 3, 2),Numbers from previous 3 rows
 5             6             3 <----- Average of (3, 2, 4),Numbers from previous 3 rows
 .             .             .
 .             .             . 
```

Average 列的前 3 行为空，因为没有先前的行。Average 列中的第 4 行显示前 3 行的 Number 列的平均值。

我需要一些帮助来尝试构建将执行此操作的 SQL Select 语句。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-26T15:54:12.277

这应该这样做：

```
--Test Data
CREATE TABLE    RowsToAverage
    (
    ID int NOT NULL,
    Number int NOT NULL
    )

INSERT  RowsToAverage(ID, Number)
SELECT  1, 1
UNION ALL
SELECT  2, 3
UNION ALL
SELECT  3, 2
UNION ALL
SELECT  4, 4
UNION ALL
SELECT  5, 6
UNION ALL
SELECT  6, 8
UNION ALL
SELECT  7, 10

--The query
;WITH   NumberedRows
AS
(
SELECT  rta.*, row_number() OVER (ORDER BY rta.ID ASC) AS RowNumber
FROM    RowsToAverage rta
)

SELECT  nr.ID, nr.Number,
        CASE
            WHEN nr.RowNumber <=3 THEN NULL
            ELSE (  SELECT  avg(Number) 
                    FROM    NumberedRows 
                    WHERE   RowNumber < nr.RowNumber
                    AND     RowNumber >= nr.RowNumber - 3
                )
        END AS MovingAverage
FROM    NumberedRows nr 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-26T16:51:12.240

假设 Id 列是连续的，下面是对名为“MyTable”的表的简化查询：

```
SELECT 
    b.Id,
    b.Number,
    (
      SELECT 
       AVG(a.Number) 
      FROM 
       MyTable a 
     WHERE 
       a.id >= (b.Id - 3) 
       AND a.id < b.Id
       AND b.Id > 3 
     ) as Average
FROM 
    MyTable b; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T20:04:50.133

一个简单的自连接似乎比引用子查询的行好得多

生成 10k 行测试数据：

```
drop table test10k
create table test10k (Id int, Number int, constraint test10k_cpk primary key clustered (id))

;WITH digits AS (
    SELECT 0 as Number
    UNION SELECT 1
    UNION SELECT 2
    UNION SELECT 3
    UNION SELECT 4
    UNION SELECT 5
    UNION SELECT 6
    UNION SELECT 7
    UNION SELECT 8
    UNION SELECT 9
)
,numbers as (
    SELECT 
        (thousands.Number * 1000) 
        + (hundreds.Number * 100) 
        + (tens.Number * 10) 
        + ones.Number AS Number
    FROM digits AS ones 
    CROSS JOIN digits AS tens
    CROSS JOIN digits AS hundreds
    CROSS JOIN digits AS thousands
)
insert test10k (Id, Number)
select Number, Number
from numbers 
```

我会将前 3 行的特殊情况从主查询中拉出来，如果你真的想要它在行集中，你可以 UNION ALL 回来。自加入查询：

```
;WITH   NumberedRows
AS
(
    SELECT  rta.*, row_number() OVER (ORDER BY rta.ID ASC) AS RowNumber
    FROM    test10k rta
)

SELECT  nr.ID, nr.Number,
    avg(trailing.Number) as MovingAverage
FROM    NumberedRows nr
    join NumberedRows as trailing on trailing.RowNumber between nr.RowNumber-3 and nr.RowNumber-1
where nr.Number > 3
group by nr.id, nr.Number 
```

在我的机器上，这大约需要 10 秒，Aaron Alton 演示的子查询方法大约需要 45 秒（在我更改它以反映我的测试源表之后）：

```
;WITH   NumberedRows
AS
(
    SELECT  rta.*, row_number() OVER (ORDER BY rta.ID ASC) AS RowNumber
    FROM    test10k rta
)
SELECT  nr.ID, nr.Number,
    CASE
            WHEN nr.RowNumber <=3 THEN NULL
            ELSE (  SELECT  avg(Number) 
                            FROM    NumberedRows 
                            WHERE   RowNumber < nr.RowNumber
                            AND             RowNumber >= nr.RowNumber - 3
                    )
    END AS MovingAverage
FROM    NumberedRows nr 
```

如果您执行 SET STATISTICS PROFILE ON，您可以看到自连接在表假脱机上执行了 10k。子查询在过滤器、聚合和其他步骤上执行了 10k 次。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T15:55:06.050

编辑：我错过了应该平均前三个记录的点......

对于一般的运行平均值，我认为这样的事情会起作用：

```
SELECT
    id, number, 
    SUM(number) OVER (ORDER BY ID) / 
       ROW_NUMBER() OVER (ORDER BY ID) AS [RunningAverage]
FROM myTable
ORDER BY ID 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T15:38:06.523

[在这里](https://stackoverflow.com/questions/878473/how-do-i-calculate-a-moving-average-using-mysql)查看一些解决方案。我相信你可以很容易地适应其中之一。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-26T16:06:27.277

如果您希望它真正具有高性能，并且不怕深入 SQL Server 很少使用的领域，您应该考虑编写自定义聚合函数。SQL Server 2005 和 2008 将 CLR 集成到表中，包括编写用户聚合函数的能力。到目前为止，自定义运行总聚合将是计算这样的运行平均值的最有效方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-26T18:43:47.007

或者，您可以非规范化并存储预先计算的运行值。此处描述：

[http://sqlblog.com/blogs/alexander_kuznetsov/archive/2009/01/23/denormalizing-to-enforce-business-rules-running-totals.aspx](http://sqlblog.com/blogs/alexander_kuznetsov/archive/2009/01/23/denormalizing-to-enforce-business-rules-running-totals.aspx)

选择的性能尽可能快。当然，修改速度较慢。

# c# - 在 Windows Vista 上使用 C# 的 PrintTestPage

> ID：911327
> 
> 赞同：1
> 
> 时间：2009-05-26T15:32:11.543
> 
> 标签：c#, windows-vista, printing

在网络上安装打印机后打印测试页时，我遇到了一个非常奇怪的问题。这一切都很好，当以管理员身份运行代码时……测试页也会被打印出来。但是当我“正常”运行程序时，我得到一个“访问被拒绝”。

所以这里是代码：

```
// get the printer
string path = "Win32_Printer.DeviceId='" + printerName + "'";
using (ManagementObject printer = new ManagementObject(path))
{
    // invoke the method
    object obj = printer.InvokeMethod("PrintTestPage", null);
    System.Windows.Forms.MessageBox.Show(obj.ToString());
} 
```

obj 始终为 5，表示“访问被拒绝”。

当我以同样的方式调用“SetDefaultPrinter”方法时，无论作为管理员还是非管理员都可以。

希望任何人都有线索。

谢谢，西蒙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-04T07:17:16.783

解决了。我找到了另一段相同的代码，并且在这两种情况下都有效。

WshShell 外壳 = 新的 WshShell(); string command = "RUNDLL32 PRINTUI.DLL,PrintUIEntry /k /n \"" + printerInfo.PrinterName + "\""; 对象窗口样式 = null; 对象 waitOnReturn = null; shell.Run(command, ref windowStyle, ref waitOnReturn);

就是这样了。不管怎么说，还是要谢谢你。

干杯，西蒙

# jquery - 如何仅切换 *next* .class 或 div（而不是其余部分）

> ID：911328
> 
> 赞同：2
> 
> 时间：2009-05-26T15:32:30.293
> 
> 标签：jquery, togglebutton

我想知道如何仅切换“子”div，单击在 html 上重复的按钮，如下所示：

```
<div class="button">
     <div class="hide toggle">
          Blah1
     </div>
</div>
<div class="button">
     <div class="hide toggle">
          Blah2
     </div>
</div>
<div class="button">
     <div class="hide toggle">
          Blah3
     </div>
</div> 
```

目标是只影响中间子div，并隐藏其余部分。

我不知道这是否可能。

这段代码让我切换了所有的 div：

```
<script type="text/javascript">
  $(document).ready(function(){

    $('.button').click(function() {
    $('.toggle').slideToggle();
    }, function () {
        $('.toggle').slideToggle();
    });

  });
</script> 
```

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-26T15:35:25.000

尝试

```
$(this).next('.toggle').slideToggle(); 
```

或者

```
$(this).children('.toggle:first').slideToggle(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T15:36:28.350

在 click 事件处理程序中，**this**关键字指的是被点击的元素。将您的 $('.toggle').slideToggle() 行替换为

```
$('.toggle',this).slideToggle(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-07-14T01:24:39.237

Thomas Stock 和 Russ Cam 说得对……我只是把它包好。将其粘贴到您的页面某处......通常在所有代码之后的头部或页脚中。

```
<script type="text/javascript">
    $(document).ready(function(){ 
        $(".button").click(function() {
    $(this).next('.toggle').slideToggle();
    });
    });
</script> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-11-13T10:24:25.937

如果我想要切换的 DIV 不是点击元素的子元素，我必须做什么，例如：

```
<span onclick="$(this).next('.showme').slideToggle();">Klick to show first Showme-Class</span>
<div class="showme">You've clicked the first span-element</div>

<span onclick="$(this).next('.showme').slideToggle();">Klick to show second Showme-Class</span>
<div class="showme">You've clicked the second span-element</div>

<span onclick="$(this).next('.showme').slideToggle();">Klick to show third Showme-Class</span>
<div class="showme">You've clicked the third span-element</div> 
```

# c# - 数组问题

> ID：911336
> 
> 赞同：0
> 
> 时间：2009-05-26T15:34:50.913
> 
> 标签：c#, arrays

我在下面有一个数组

```
string stringArray = new stringArray[12];

stringArray[0] = "0,1";
stringArray[1] = "1,3";
stringArray[2] = "1,4";
stringArray[3] = "2,1";
stringArray[4] = "2,4";
stringArray[5] = "3,7";
stringArray[6] = "4,3";
stringArray[7] = "4,2";
stringArray[8] = "4,8";
stringArray[9] = "5,5";
stringArray[10] = "5,6";
stringArray[11] = "6,2"; 
```

我需要像下面这样转换

```
List<List<string>> listStringArray = new List<List<string>>();

listStringArray[["1"],["3","4"],["1","4"],["7"],["3","2","8"],["5","6"],["2"]]; 
```

这怎么可能？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-26T15:40:45.363

我想你真正想要的可能是这样的：

```
var indexGroups = x.Select(s => s.Split(',')).GroupBy(s => s[0], s => s[1]); 
```

这会将元素作为分组枚举返回。

要返回一个列表列表，这是您真正要求的，然后尝试：

```
var lists = x.Select(s => s.Split(',')).GroupBy(s => s[0], s => s[1])
             .Select(g => g.ToList()).ToList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T15:39:32.340

没有这样的速记。您必须进入一个循环并拆分每个数组并添加到列表中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T15:41:02.663

非 LINQ 版本（我必须承认它更丑，但你可能别无选择）

```
 var index = new Dictionary<string, List<string>>();
        foreach (var str in stringArray) {
            string[] split = str.Split(',');
            List<string> items;
            if (!index.TryGetValue(split[0], out items)) {
                items = new List<string>();
                index[split[0]] = items;
            }
            items.Add(split[1]); 
        }

        var transformed = new List<List<string>>();
        foreach (List<string> list in index.Values) {
            transformed.Add(list); 
        } 
```

# c# - 配置 Visual Studio 以在构建时发布 WCF 服务应用

> ID：911340
> 
> 赞同：1
> 
> 时间：2009-05-26T15:35:53.813
> 
> 标签：c#, visual-studio, wcf

我创建了一个 WCF 应用程序（带有 .svc 文件的应用程序）。当我构建这个项目时，只创建了一堆 DLL，但为了能够在 IIS 中托管它，我必须使用发布选项（右键单击项目并发布）。这会生成 DLL，复制 app.config 和 .svc 文件。这堆现在可以托管在 IIS 中。

我希望 Visual Studio 在我构建项目时发布。我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-29T13:03:44.263

您还可以考虑添加一个[Web 应用程序项目](http://msdn.microsoft.com/en-us/library/bb552362.aspx)并将其与一个[Web 部署项目](http://weblogs.asp.net/scottgu/archive/2008/01/28/vs-2008-web-deployment-project-support-released.aspx)相结合，然后当您构建解决方案时，Web 部署项目的输出应该与发布操作相同 - 这种方法也更容易连续使用[Cruise control.net](http://confluence.public.thoughtworks.org/display/CCNET/Welcome+to+CruiseControl.NET)等集成环境

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-26T15:45:16.400

怎么样：构建后事件，运行**msbuild /target:Publish**。

# c# - WPF ListBoxItem(s) 在滚动后丢失以编程方式设置的样式

> ID：911342
> 
> 赞同：1
> 
> 时间：2009-05-26T15:36:41.953
> 
> 标签：c#, .net, wpf, .net-3.5

因此，我有一个使用 DataTemplate 绑定到业务对象列表的 ListBox：

```
<DataTemplate x:Key="msgListTemplate">
    <Grid Height="17">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="{Binding MaxWidth}" />
            <ColumnDefinition Width="*" />
         </Grid.ColumnDefinitions>
         <TextBlock Grid.Column="0" Foreground="Silver" Text="{Binding SequenceNo}" />
         <TextBlock Grid.Column="1" Text="{Binding MessageName}" />
    </Grid>
</DataTemplate>

<ListBox Name="msgList" 
    Grid.Column="0"
    ItemTemplate="{StaticResource msgListTemplate}"
    SelectionChanged="msgList_SelectionChanged"
    VirtualizingStackPanel.IsVirtualizing="True"
    ScrollViewer.HorizontalScrollBarVisibility="Hidden">
</ListBox> 
```

绑定后的某个时间，我想为列表中的某些项目着色以将它们与其他项目区分开来。我在后台线程上执行此操作：

```
if(someCondition)
{
    msgList.Dispatcher.BeginInvoke(new Fader(FadeListItem), DispatcherPriority.Render, request);
}

delegate void Fader(GMIRequest request);
void FadeListItem(GMIRequest request)
{
    ListBoxItem item =
           msgList.ItemContainerGenerator.ContainerFromItem(request) as ListBoxItem;

    if(item!=null)
            item.Foreground = new SolidColorBrush(Colors.Silver);
} 
```

这一切都很好，并且一些列表项按预期显示为灰色。但是，如果我滚动以使灰色项目不再显示，然后再次滚动回到它们所在的位置，它们不再是银色，而是返回到默认的黑色前景。

知道为什么会这样，或者如何解决吗？是因为我将 IsVirtualizing 设置为 true 吗？列表框通常包含许多项目（20,000 并不少见）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T15:47:35.083

> 是因为我将 IsVirtualizing 设置为 true 吗？列表框通常包含许多项目（20,000 并不少见）。

你搞定了——一旦用户滚动离开，你设置前景色的项目就会被丢弃。

虽然您有正确的总体思路，但您的处理方式是一种非常不符合 WPFy 的方法 - 一种更好的方法是在您的业务对象类中使用 bool DP（或使用BO 实现 INotifyPropertyChanged），然后通过返回的自定义 IValueConverter 将 bool 绑定到前景色（isTrue ? whiteBrush : grayBrush）。

由于您可能不想/可能无法修改您的业务对象以支持 INotifyPropChanged，这就是 MV-VM 模式的原因 - 创建一个包装对象的类，该对象是 DependencyObject 并仅公开您的属性有兴趣展示。

# bash - Bash 脚本中的参数检查问题

> ID：911349
> 
> 赞同：5
> 
> 时间：2009-05-26T15:38:11.967
> 
> 标签：bash, scripting, if-statement, arguments

所以基本上我正在尝试检查传递给脚本的参数。如果它有三个参数并且第三个参数是 1，那么我希望它继续。如果它有四个参数并且第三个参数不是 1，我也希望它继续。

所以基本上我认为我可以做...

```
if ([ $# -ne 3 ] and [ "$3" -ne "2" ])
then
exit 0
fi 
```

但是，似乎 Bash 没有并且可以用于 if，所以我想我可以只使用嵌套的 if，但是现在它仍然在抱怨。所以这就是我目前所拥有的......

```
if [ $# -ne 3 ]
then
if [ "$3" -ne "1" ]
then

echo "Improper number of arguments.
FORMAT make-csv-data <STUDY> <TAG> <MODE> <SELECT>

Select can be left off if you want all data (Mode=1)
"
exit 0

fi
fi
if [ $# -ne 4 ]
then
if [ "$3" -ne "2" ]
then

echo "Improper number of arguments.
FORMAT make-csv-data <STUDY> <TAG> <MODE> <SELECT>

Select can be left off if you want all data (Mode=1)
"
exit 0

fi
fi 
```

那么我哪里错了？我不能在 Bash 中嵌套 if 语句吗？有没有一种我完全错过的超级禅宗方式？

感谢您能给我的任何帮助。

* * *

新问题...

现在，由于某种原因，代码根本不起作用。没有错误或任何东西，它只是不起作用。它不检查参数的数量。我已经完全没有参数地运行了脚本，它只是跳过它，就像它甚至不存在一样。

奇怪的是，我*确信*代码昨天还在工作。今天回来，不多说了。关于问题是什么的任何想法？（对不起，但我必须删除已接受的答案。）

```
if [[ $# = 3 && "$3" != "1" ]]
then

echo "Improper number of arguments.
FORMAT make-csv-data <STUDY> <TAG> <MODE> <SELECT>

Select can be omitted if all data is required (Mode=1)
"
exit 0

fi

if [[ $# > 4 ]]
then

echo "Improper number of arguments.
FORMAT make-csv-data <STUDY> <TAG> <MODE> <SELECT>

Select can be omitted if all data is required (Mode=1)
"
exit 0

fi 
```

编辑二：

Bash shell 不喜欢我正在尝试做的这个脚本的一些事情。我可能最终会用另一种脚本语言重写它，并为该项目做一些我想到的更多事情。无论如何感谢您的帮助。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-26T15:48:03.303

```
if [ $# -ne 3 -a "$3" -ne "1" ]; then
  exit 0
fi 
```

以供参考

```
-a = and
-o = or 
```

或者，您可以只使用：

```
if [[ $# != 3 && "$3" != "1" ]]; then 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T16:57:37.157

请参见：

[http://bash-hackers.org/wiki/doku.php/commands/classictest#and_and_or](http://bash-hackers.org/wiki/doku.php/commands/classictest#and_and_or) 和 [http://bash-hackers.org/wiki/doku.php/syntax/ccmd/conditional_expression](http://bash-hackers.org/wiki/doku.php/syntax/ccmd/conditional_expression)

由于您只是用“if”检查退出/返回值，因此您需要提供一些东西，例如一个命令，它会根据您的测试提供有意义的东西。[ 就是这样一个命令，另一种可能是 [[ 关键字。

上面的scragar已经提到了实际正确的例子，我不想重复它们:)

# version-control - 如何在版本控制中处理网站不断变化的广告模板代码

> ID：911356
> 
> 赞同：3
> 
> 时间：2009-05-26T15:40:04.863
> 
> 标签：version-control, caching, ads

对于我从事的一个大型项目（约 310k uniq/天，大型网站，大量模板，大量内容），我们必须与客户销售网站的多个部分（每个部分具有不同的布局）以获取广告收入。有时，它的页面顶部为 900x250，有时它在导航下为 952x200，有时它需要一个具有自定义样式的新 div。广告是通过 google 的广告管理器投放的，广告购买者很少（如果有的话）同意为我们的网站定制他们的实施代码。

这个网站的所有代码都在一个 svn 仓库中，而不是我们尽量保持整洁：

1.  “在线”编辑模板（在生产服务器上）（这样的坏主意）
2.  对本地副本进行更改，推送直播（并冒着稍后恢复到旧广告代码并丢失它/必须在上线之前处理它的风险。人们错过了一些东西，不要假装你没有，并说“更努力地检查”。）

这些选择都不是特别有吸引力。你们是怎么做到的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T12:01:49.557

也许您可以考虑将广告代码从您的模板/源代码中取出，并将其放入您的数据库中。我认为广告是网站的更多“内容”，可以通过您的代码以与其他网站内容相同的方式进行管理。您仍然可以在临时站点上设置广告，然后使用这种方法将相关位复制/粘贴到您的实时站点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T15:50:40.180

我认为最好的办法是弄清楚如何将代码分成更小的部分，以将变化的代码与静态代码分开到不同的文件中。

# jquery - 如何使用 jQuery 为属性值（不是样式属性）设置动画？

> ID：911357
> 
> 赞同：2
> 
> 时间：2009-05-26T15:40:13.647
> 
> 标签：jquery, iframe, animation

我需要为 iframe 的高度属性设置动画，但似乎动画函数只接受样式属性。对此有什么想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-26T15:41:27.327

应用于 iframe 的 iframe 高度属性和 CSS 高度属性的行为方式相同。所以只需在css中设置高度而不是作为属性。

# networking - 断开并重新连接已连接的数据报套接字

> ID：911359
> 
> 赞同：3
> 
> 时间：2009-05-26T15:40:35.237
> 
> 标签：networking, sockets, udp, posix, datagram

我正在尝试创建一个基于数据报套接字（UDP）的迭代服务器。它调用连接到它从第一个 recvfrom() 调用获得的第一个客户端（是的，我知道这不是真正的连接）。在为这个客户端提供服务后，我断开 UDP 套接字（使用 AF_UNSPEC 调用连接）然后我调用 recvfrom() 从下一个客户端获取第一个数据包。

现在的问题是，在循环的第二次迭代中调用 recvfrom() 将返回 0。我的客户端从不发送空数据包，所以会发生什么。

这就是我正在做的事情（伪代码）：

```
s = socket(PF_INET, SOCK_DGRAM, 0)

bind(s)

for(;;)
{
  recvfrom(s, header, &client_address)  // get first packet from client
  connect(s,client_address)  // connect to this client
  serve_client(s);
  connect(s, AF_UNSPEC); // disconnect, ready to serve next client
} 
```

编辑：我发现我的客户端错误地发送了一个空包。现在我的问题是如何让客户端等待获得服务而不是向任何地方发送请求（服务器连接到另一个客户端并且不为任何其他客户端提供服务）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T15:46:32.887

connect() 在 SOCK_DGRAM 上真的完全没有必要。

调用连接~~不会阻止您接收来自其他主机的数据包~~，也不会阻止您发送它们。只是不要打扰，它并没有真正的帮助。

更正：是的，显然它确实会阻止您接收来自其他主机的数据包。但是在服务器中执行此操作有点愚蠢，因为当您连接（）到一个客户端时，任何其他客户端都会被锁定。此外，您仍然需要捕捉漂浮的“谷壳”。可能有一些与 DGRAM 套接字上的 connect() 相关的竞争条件 - 如果您调用 connect 并且来自其他主机的数据包已经在缓冲区中会发生什么？

此外，0 是 recvfrom() 的有效返回值，因为空（无数据）数据包是有效的并且可以存在（实际上，人们经常使用它们）。因此，您无法检查某事是否以这种方式成功。

很可能，队列中已经有一个零字节数据包。

你的协议应该被设计成最小化错误数据报被误解的机会；出于这个原因，我建议您不要使用空数据报，而是使用幻数。

UDP 应用程序必须能够识别“chaff”数据包并丢弃它们；他们迟早会出现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T15:52:13.420

`man connect`：

```
...
如果启动套接字不是连接模式，则 connect()
应设置套接字的对等地址，并且不建立连接。
对于 SOCK_DGRAM 套接字，对等地址标识所有
数据报在随后的 send() 函数中发送，并且限制
后续 recv() 函数的远程发送者。如果地址
是协议的空地址，套接字的对等地址
应重置。
...

```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-06-01T21:37:56.200

只是一个更正，以防有人像我一样绊倒。要断开连接，需要调用 sockaddr 的 sa_family 成员设置为 AF_UNSPEC。不只是通过了AF_UNSPEC。

# nunit - NUnit 不能在 Visual Studio 2003 中的 Vista x64 上运行

> ID：911366
> 
> 赞同：0
> 
> 时间：2009-05-26T15:41:57.810
> 
> 标签：nunit, 64-bit, .net-1.1, visual-studio-2003

我试图在 64 位 Vista 上的 Visual Studio 2003 中运行 NUnit，但没有成功。

我已将项目的调试模式设置为“程序”，将启动应用程序设置为“C:\Program Files (x86)\NUnit 2.4.8\bin\nunit.exe”。测试项目设置为启动项目。所有代码都在 .NET 1.1 中。与 .NET 2.0 不同，处理器架构不能作为目标（当 1.1 可执行文件加载到 x64 机器上时，它在 WoW64 中作为 32 位进程运行并利用 32 位框架）。

点击 Debug > Start 后，我​​收到错误窗口“无法直接启动具有类库输出类型的项目”。我被卡住了，无法让 NUnit 运行。

stackoverflow 上最近的相关问题涉及让 NUnit 在 Visual Studio **2005**中的 Vista x64 上运行“如果 x86 构建，Nunit.exe 无法在 Vista 64 位上运行 (stackoverflow.com/questions/208985/nunit-exe-cannot-work-on- vista-64bits-if-x86-build)。此外，NUnit 没有从 NUnit-2.4.8-net-1.1.msi 映像安装 nunit-x86.exe。

**我的开发环境**
Vista x64 和 SP1
Visual Studio 2003（版本 7.1.3088）
.NET Framework 1.1（版本 1.1.4322 SP1）
NUint 2.4.8（从 NUnit-2.4.8-net-1.1.msi 安装）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T18:38:06.237

我发现了这个问题——它与 Vista x64 无关。

我将主项目的调试模式设置为“程序”，将启动应用程序设置为“C:\Program Files (x86)\NUnit 2.4.8\bin\nunit.exe”，而不是测试项目。

即使我已将测试项目设置为启动项目，测试项目中的调试模式仍设置为默认的“项目”而不是“应用程序”。我切换了调试配置；所以主项目设置为“项目”，测试项目包含 NUnit 调试配置。

摘要：NUnit 确实在 Visual Studio 2003 的 Vista x64 上运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-01-19T23:05:48.803

如果您的应用程序是 32 位应用程序，那么您必须使用 nunit-x86.exe，它是为在 64 位系统上测试 32 位应用程序而构建的。在此处查看详细说明：[http ://www.nunit.org/index.php?p=nunit-gui&r=2.4.2](http://www.nunit.org/index.php?p=nunit-gui&r=2.4.2)

# asp.net - 无论如何要根据缓存来监视一个（类）对象吗？

> ID：911370
> 
> 赞同：0
> 
> 时间：2009-05-26T15:43:28.523
> 
> 标签：asp.net, memory, caching, performance

我正在尝试确定哪种数据结构实现最适合 Web 应用程序。基本上，我会为每个唯一用户维护一套“State”类，当用户登录时State会被缓存一段时间，经过非滑动期后，将状态保存到db中。因此，为了平衡 db 负载和 iis 内存，我必须确定缓存的最佳（预期）超时时间。

我的问题是，如何监控一组对象的特定缓存活动？我尝试了 perfmon，它大致给出了总内存限制的百分比，但不知道大小左右（也许更好，我可以获得所有缓存对象的列表以及大小和其他性能问题数据）。

最后一件事，我预计该程序将处理 100,000 多个缓存用户，并且他们每个人都可能在大约 10 到 60 秒内发出请求。所以性能对我来说很重要。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-08T18:42:05.637

你到底想在这里测量什么？如果您只想在任何给定时间获取内存中*State*实例的大小，则可以使用应用程序级计数器并在每次创建/删除*State*实例时添加/减去。所以你知道你的状态大小，你知道你有多少个状态实例。但是，如果您已经指望每分钟至少有 100.000 多个用户请求一次，那么您实际上可以进行数学计算。

# c# - Exchange 2007 不允许从控制台应用程序发送邮件

> ID：911374
> 
> 赞同：0
> 
> 时间：2009-05-26T15:43:51.580
> 
> 标签：c#, email, console, exchange-server-2007

我正在尝试使用以下代码从控制台应用程序使用 Exchange 2007 发送电子邮件，并且在 Send 调用引发的异常中收到此错误消息。

> SMTP 服务器需要安全连接或客户端未通过身份验证。服务器响应为：5.7.1 客户端未通过身份验证

```
MailMessage message = new MailMessage();
message.From = new MailAddress("from@example.com");
message.To.Add("to@domain.com");
message.Subject = "test";
SmtpClient smtp = new SmtpClient(ConfigurationUtil.SMTPServer);
smtp.Credentials = new System.Net.NetworkCredential("from@example.com", "password");
smtp.Send(message); 
```

这适用于 Exchange 2003。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T14:27:32.907

这最终成为 Exchange 2007 问题，与代码无关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T15:58:18.370

从错误消息看来，您似乎需要通过 SSL 连接到 Exchange。

```
SmtpClient smtp = new SmtpClient(ConfigurationUtil.SMTPServer, 465); 
```

将该端口号替换为 Exchange 服务器的安全连接正在侦听的端口。

# python - Python：从内置类型继承

> ID：911375
> 
> 赞同：3
> 
> 时间：2009-05-26T15:43:52.267
> 
> 标签：python, oop, graph

我有一个关于内置类型的子类型及其构造函数的问题。我希望一个类既继承自元组又继承自自定义类。

让我给你一个具体的例子。我经常使用图表，即与边相连的节点。我开始在我自己的图形框架上做一些工作。

有一个类 Edge，它有自己的属性和方法。它还应该从类 GraphElement 继承。（GraphElement 是在特定图的上下文之外没有任何意义的每个对象。）但在最基本的层面上，边只是包含两个节点的元组。如果您可以执行以下操作，那将是很好的语法糖：

```
edge = graph.create_edge("Spam","Eggs")
(u, v) = edge 
```

所以 (u,v) 将包含“Spam”和“Eggs”。它还将支持迭代，例如

```
for node in edge: ... 
```

我希望你明白我为什么要子类型元组（或其他基本类型，如集合）。

所以这是我的 Edge 类及其**init**：

```
class Edge(GraphElement, tuple):

def __init__(self, graph, (source, target)):
    GraphElement.__init__(self, graph)
    tuple.__init__((source, target)) 
```

当我打电话时

```
Edge(aGraph, (source, target)) 
```

我得到一个 TypeError: tuple() 最多接受 1 个参数（给定 2 个）。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-26T15:53:07.740

由于元组是不可变的，因此您还需要覆盖 __new__ 方法。见[http://www.python.org/download/releases/2.2.3/descrintro/#__new__](http://www.python.org/download/releases/2.2.3/descrintro/#__new__)

```
class GraphElement:
    def __init__(self, graph):
        pass

class Edge(GraphElement, tuple):
    def __new__(cls, graph, (source, target)):
        return tuple.__new__(cls, (source, target))
    def __init__(self, graph, (source, target)):
        GraphElement.__init__(self, graph) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-26T16:00:22.327

对于您的需要，我会避免多重继承，并会使用生成器实现迭代器：

```
class GraphElement:
    def __init__(self, graph):
        pass

class Edge(GraphElement):
    def __init__(self, graph, (source, target)):
        GraphElement.__init__(self, graph)
        self.source = source
        self.target = target

    def __iter__(self):
        yield self.source
        yield self.target 
```

在这种情况下，两种用法都可以正常工作：

```
e = Edge(None, ("Spam","Eggs"))
(s, t) = e
print s, t
for p in e:
    print p 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-26T15:53:59.783

您需要使用您`__new__`传递`tuple.__new__`给`Edge`.

# c# - WinForms - Form.DoubleBuffered 属性是否影响放置在该表单上的控件？

> ID：911376
> 
> 赞同：5
> 
> 时间：2009-05-26T15:44:00.690
> 
> 标签：c#, .net, winforms, doublebuffered

`Form`具有 DoubleBuffered 属性（bool，继承自 Control）。

如果设置为 true，是否所有控件都放置在窗体上，因为它们位于窗体上，所以以双缓冲方式绘制到屏幕上？还是您需要担心自己的 DoubleBuffered 属性？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-26T15:58:47.777

据我记得，不，双缓冲不会延续到子控件。您需要为每个单独设置它。我会谷歌它，看看我是否能找到证明/反驳这一点的来源......

编辑：找到这个： http: [//www.devnewsgroups.net/group/microsoft.public.dotnet.framework.windowsforms/topic17173.aspx](http://www.devnewsgroups.net/group/microsoft.public.dotnet.framework.windowsforms/topic17173.aspx)

只是想到了一个快速破解来解决这个问题。基本上，使用反射来获取“DoubleBuffered”属性，然后设置它：

```
public static class Extensions
{
    public static void EnableDoubleBuferring(this Control control)
    {
        var property = typeof(Control).GetProperty("DoubleBuffered", BindingFlags.Instance | BindingFlags.NonPublic);
        property.SetValue(control, true, null);
    }
} 
```

然后，在您的表单代码中，执行以下操作：

```
 public Form1()
    {
        InitializeComponent();
        this.DoubleBuffered = true;
        foreach (Control control in this.Controls)
        {
            control.EnableDoubleBuferring();
        }
    } 
```

# django - 如何在 Django 中跟踪视图的导入

> ID：911378
> 
> 赞同：2
> 
> 时间：2009-05-26T15:44:08.227
> 
> 标签：django

有没有办法以某种方式跟踪视图的导入？我想找出哪个坏了并且在某些情况下不导入（这导致 django 中的所有 url 解析模式都停止工作）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-05-03T20:53:10.423

没有人建议 pdb 真是太神奇了。将以下内容放在代码中的战略点中：

```
import pdb;pdb.set_trace() 
```

当执行到达那个点时，开发服务器将进入一个 shell，您可以在其中检查变量的值、跟踪执行等。

它像标准 shell 一样工作（使用任何你喜欢的 python 命令），但也有一些特殊的命令可以让你控制执行。例如`next`将转到下一行（处理上一行）。`continue`将继续执行直到下一个断点等（[pdb 命令的完整列表](http://docs.python.org/library/pdb.html#id2)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T15:50:39.117

你没有得到堆栈跟踪吗？`DEBUG`设置`True`为?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-01T03:16:52.510

好的，可以只写

`python -v manage.py <whatevercommand>`

并在生成的日志中搜索错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-05-01T14:12:00.580

我假设这意味着您收到 501 服务器错误？

如果您使用的是 Apache Web 服务器，则可以使用以下[`ErrorLog`指令](http://httpd.apache.org/docs/current/mod/core.html#errorlog)将其设置为在站点的配置中记录 python 错误：

```
ErrorLog /tmp/django_errors.log 
```

然后在终端（或通过 ssh）：

```
tail -f /tmp/djanogo_errors.log 
```

然后尝试加载有问题的网页。然后，您应该能够看到错误是什么并修复它。

# php - 整个 index.php?= 。可执行程序

> ID：911380
> 
> 赞同：-5
> 
> 时间：2009-05-26T15:45:00.317
> 
> 标签：php

我从来没有真正理解如何做到这一点。我想在哪里可以键入我的地址，然后是 /index.php?=<FTP 上的文件>.exe。从那里，我会直接进入一个页面，该页面有一个立即下载按钮，可能类似于广告。

有人有我可以看的任何教程或指南吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T15:55:12.230

我要咬...

PHP 脚本确保文件不能从外部访问，并且只能在每个请求的基础上使用可能的身份验证。当你看到：

```
download.php?file=sdjasdk.exe 
```

下载脚本看起来有点像：

```
<?php
    if( $_SESSION['auth'] == TRUE){
        $file = fileopen($whatever);
        echo "mimetype crap"
        //spit out file
    }else{
        echo "not authorized bozo"
    }
?> 
```

完毕。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T15:59:28.057

我认为他在处理简单的 $_GET 请求 >.<

```
<?php

$file = $_GET['file'];

if (file_exists($file)) {
   header('Content-Type: application/octet-stream');
   echo file_get_contents($file);
}

?> 
```

当然，这是一个非常基本的示例，根本没有安全性。不建议您在不提高安全性的情况下在生产中使用它。

# c# - 在特定位置禁用 HttpModule

> ID：911384
> 
> 赞同：5
> 
> 时间：2009-05-26T15:46:32.073
> 
> 标签：c#, .net, asp.net, ihttpmodule

[我知道这里](https://stackoverflow.com/questions/70956/exclude-certain-pages-from-using-a-httpmodule)已经问过这个问题，但是答案（使用处理程序代替）并不能解决问题，因为我使用的是不实现 IHttpHandler 的第三方组件。

那么，再一次，有没有办法在某个请求上加载/卸载 HttpModule？

编辑：我忘了提到我们正在使用 .NET 2.0。我很抱歉忘记了它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T15:57:49.277

我没有对此进行测试，但[本文中的评论](http://www.west-wind.com/weblog/posts/44979.aspx)似乎表明可以通过`<location`在 web.config 中使用 > 元素仅为某些位置注册模块，例如：

```
 <location path="some/path">
    <system.web>
      <httpModules>
        <remove name="name"/>
        <add name="name" type="type"/>
      </httpModules>
    </system.web>
  </location> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T16:55:50.767

我假设问题出在 HttpModule 的继承上，您是否需要通过第三方控件继承 web.config？

尝试在路径将存储组件的位置添加此属性；

```
<location path="/ThirdPartyComponents" inheritInChildApplications="false">
    ...
</location> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-17T10:20:31.713

你可以做到这一点的一种方法是使用包装模块。向您的应用程序注册一个 httpModule，然后在此模块中创建与运行其他模块相对应的规则。您可以访问请求对象，因此您应该能够检测到您收到的请求类型并将逻辑路由到相关（自定义）模块。

# perl - 我可以使用 Perl 获取目录的 MD5sum 吗？

> ID：911389
> 
> 赞同：0
> 
> 时间：2009-05-26T15:47:32.527
> 
> 标签：perl, md5, checksum

我正在编写一个使用 File::Find 来索引网络文件系统的 Perl 脚本（在 Windows 中）。它工作得很好，但是爬取文件系统需要很长时间。我认为在遍历目录之前以某种方式获取目录的校验和会很好，并且校验和与之前运行的校验和相匹配，不要遍历目录。这将消除大量处理，因为此文件系统上的文件不会经常更改。

在我的 AIX 机器上，我使用以下命令：

```
csum -h MD5 /directory 
```

它返回如下内容：

```
5cfe4faf4ad739219b6140054005d506  /directory 
```

该命令花费的时间很少：

```
time csum -h MD5 /directory
5cfe4faf4ad739219b6140054005d506  /directory

real    0m0.00s
user    0m0.00s
sys     0m0.00s 
```

我已经在 CPAN 中搜索了可以执行此操作的模块，但看起来所有模块都会为我提供目录中每个文件的 MD5sum，而不是目录本身。

有没有办法在 Perl 中获取目录的 MD5sum，甚至在 Windows 中，因为我可以从 Perl 调用 Win32 命令？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T16:02:35.740

您可以只读取文件和文件夹的最后修改日期吗？这肯定会比构建 MD5 更快吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T16:00:46.320

为了获得校验和，您必须读取文件，这意味着您需要遍历文件系统，这会使您回到您试图摆脱的同一条船上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T16:16:46.897

据我所知，您无法获得目录的 md5。当您提供目录时，其他系统上的 md5sum 会抱怨。csum 很可能会为您提供顶级目录的目录文件内容的哈希，而不是遍历树。

您可以通过执行以下操作获取文件的修改时间并按照您的喜好对它们进行散列：

```
sub dirModified($){
    my $dir = @_[0];
    opendir(DIR, "$dir");
    my @dircontents = readdir(DIR);
    closedir(DIR);

    foreach my $item (@dircontents){
        if( -f $item ){
            print -M $item . " : $item - do stuff here\n";
        } elsif( -d $item && $item !~ /^\.+$/ ){
            dirModified("$dir/$item");
        }
    }
} 
```

是的，它需要一些时间来运行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T22:26:08.113

除了其他好的答案，让我补充一下：如果你想要一个*校验和*，那么请使用[*校验和算法*](http://en.wikipedia.org/wiki/Checksum)而不是（[损坏的！](http://www.mscs.dal.ca/~selinger/md5collision/)）[散列函数](http://en.wikipedia.org/wiki/Hash_function)。

我认为您不需要文件索引器中的加密安全哈希函数——相反，您需要一种方法来查看目录列表中是否有更改，而无需存储整个列表。校验和算法就是这样做的：当输入改变时，它们会返回不同的输出。他们可能会做得更快，因为它们比散列函数更简单。

确实，用户可以以校验和无法发现的方式更改目录。但是，用户将不得不像这样故意更改文件名，因为文件名的正常更改将（很有可能）给出不同的校验和。那么有必要防范这种“攻击”吗？

人们应该始终考虑每次攻击的后果并选择适当的工具。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-30T07:36:15.607

如果您有兴趣，我在 python 中做了其中之一：

[http://akiscode.com/articles/sha-1directoryhash.shtml](http://akiscode.com/articles/sha-1directoryhash.shtml)

# c# - 如何使用 C# 从回收站恢复文件？

> ID：911391
> 
> 赞同：12
> 
> 时间：2009-05-26T15:47:39.763
> 
> 标签：c#, .net, file-io, recycle-bin

将文件移动到回收站并清空回收站是有据可查的，但是如何以编程方式从回收站中恢复文件呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T16:01:17.240

纯 C# 似乎没有解决方案。您很可能不得不求助于 P/Invoke。 [本文介绍了使用](http://www.codeproject.com/KB/shell/recyclebin.aspx)[SHFileOperation](http://www.pinvoke.net/default.aspx/shell32.SHFileOperation) API的 C++ 解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T16:10:37.503

除了前面提到的[codeproject](http://www.codeproject.com/KB/shell/recyclebin.aspx)链接之外，我可以看到的唯一其他引用提到了这一点：

> 通过 CSIDL_BITBUCKET 调用 SHGetFolderLocation。然后，您可以照常操作该文件夹。您必须为 SHGetFolderLocation 函数创建一个互操作。

“CSIDL_BUCKET”是虚拟 RecycleBin 文件夹的常量。引用取自[此处](http://www.developmentnow.com/g/29_2003_11_0_0_117557/Restore-files-from-Recycle-Bin.htm)，将涉及与 Windows shell 的互操作。[MSDN](http://msdn.microsoft.com/en-us/library/bb762180(VS.85).aspx)还提到此功能已被弃用，取而代之的是 Vista 中的另一个功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-06-10T09:08:23.270

希望下面的代码可以恢复文件。请确保，STA 调用仅支持 shell 调用

```
 using System;
    using System.Collections;
    using System.Windows.Forms;
    using System.IO;
    using Shell32; //Reference Microsoft Shell Controls And Automation on the COM tab.
    using System.Runtime.InteropServices;
    using Microsoft.VisualBasic.FileIO;
    using System.Threading;

 private static void Restore(object param)
    {
        object[] args = (object[])param;
        string filename = (string)args[0];
        string filepath = (string)args[1];

        Shl = new Shell();
        Folder Recycler = Shl.NameSpace(10);
        var c = Recycler.Items().Count;

        var _recycler = Recycler.Items();
        for (int i = 0; i < _recycler.Count; i++)
        {
            FolderItem FI = _recycler.Item(i);
            string FileName = Recycler.GetDetailsOf(FI, 0);
            if (Path.GetExtension(FileName) == "") FileName += Path.GetExtension(FI.Path);
            //Necessary for systems with hidden file extensions.

            string FilePath = Recycler.GetDetailsOf(FI, 1);
            if (filepath == Path.Combine(FilePath, FileName))
            {
                DoVerb(FI, "ESTORE");
                break;                 
            }
        }        
    }

    private static bool DoVerb(FolderItem Item, string Verb)
    {
        foreach (FolderItemVerb FIVerb in Item.Verbs())
        {
            if (FIVerb.Name.ToUpper().Contains(Verb.ToUpper()))
            {
                FIVerb.DoIt();
                return true;
            }
        }
        return false;
    } 
```

# vba - 将 Word 模板从 MS Word 2003 转换为 MS Word 2007

> ID：911397
> 
> 赞同：1
> 
> 时间：2009-05-26T15:49:22.037
> 
> 标签：vba, ms-word

将 Word 模板从 Word 2003 移动到 Word 2007 时遇到问题

我需要转换的代码是

```
Sub Standardbrev()

    Documents.Add Template:= _
        "p:\setup\stdbrev.DOT", NewTemplate:= _
        False

    mask "<Navn>", False
    mask "<Adresse>", False
    mask "<Postby>", False
    mask "<att>", True
    mask "<Jura Nr>", False
    mask "<Vedr>", False
    mask "<Jurist>", False
End Sub 
```

编辑，问题：当我尝试将代码复制/粘贴到 dotx 文档时，出现编译错误：

> 未定义子或函数。

如果我对 maskpart 进行注释，我可以运行宏并在新窗口中打开 stdbrev.DOT 文件

编辑：它在 2003 年做了什么：当您运行宏时，会弹出 7 个框（每个掩码 1 个），您可以在其中填写信息。信息替换文档中的掩码字段

希望这能解释我的问题

编辑：我找到了解决方案，我误解了一些代码，不知道掩码是很久以前别人写的一个函数。很抱歉发布这个无聊的问题

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T16:23:17.133

`mask`不是内置函数。此函数应在模块中的某处定义，并且您还必须将此函数复制到 Word 2007 文档（这就是您收到错误“未定义子或函数”的原因）。您可以通过右键单击`mask`然后选择*定义*来查看该函数的定义位置。

但是，最简单的“迁移”方法是在 Office 2007 中打开 Word 2003 文档，然后将其保存为 .dotm 或 .docm 文件（取决于您要创建模板还是常规文档）。

# asp.net - 让用户在上传之前查看文件

> ID：911401
> 
> 赞同：1
> 
> 时间：2009-05-26T15:49:43.427
> 
> 标签：asp.net, javascript

我正在编写一个控件，以允许我们内部网的用户将多个文件上传到我们的系统中，但具有一些附加功能。

假设您作为用户正在上传 N 个文件，当您添加 N 个文件时，Intranet 会向您显示一个如下列表：

File_name_1 ..... [查看] [删除] [上传]
File_name_2 ..... [查看] [删除] [上传]
。
.
.
File_name_n ..... [查看] [删除] [上传]

[删除所有文件] [上传所有文件]

如果您单击“查看”按钮，名为“file_name_X”的文件将被打开，以便您查看它并确保它确实是您要上传的文件。

这可能吗？，我是 Web 编程世界的新手，我发现的所有内容都表明浏览器不允许您从 Web 内部访问本地文件系统，但我不确定。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-26T15:57:49.040

做到这一点的一种方法是您最初实际上上传，但您只将其上传到“暂存”区域。因此，它实际上不会被提交给您的系统。

这就是 Gravatar 所做的，它上传文件，然后让您在保存之前裁剪和调整图像。

我见过的唯一其他方法是在 IE 或其他浏览器扩展机制中使用 ActiveX 控件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T15:59:05.373

在呈现良好的用户界面（包括上传进度报告）的同时上传文件是很困难的。

我建议使用 Yahoo UI 上传器小部件：http: [//developer.yahoo.com/yui/uploader/](http://developer.yahoo.com/yui/uploader/)

它也是 Flickr 上传器的基础，参见 YUI 博文：http: [//yuiblog.com/blog/2009/02/26/flickr-uploadr/](http://yuiblog.com/blog/2009/02/26/flickr-uploadr/)

拉里

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-26T16:06:49.443

在 IE 中，文件输入类型会将完整路径放在 value 属性中。

# powershell - 如何使用 PowerShell 将 CSV 文件中的用户添加到 Active Directory (AD) 和 Exchange？

> ID：911402
> 
> 赞同：0
> 
> 时间：2009-05-26T15:49:48.683
> 
> 标签：powershell, active-directory, exchange-server

如何使用 PowerShell 从 csv 文件将一组用户添加到 Active Directory？

csv 文件将包含用户的第一个、最后一个、电子邮件、临时密码和描述。OU、权限等可以是硬编码的。

该脚本还应添加一个 Exchange 2007 电子邮件箱。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T16:32:29.627

创建一个新用户（从[这里](http://thelazyadmin.com/blogs/thelazyadmin/archive/2007/05/14/create-an-ad-user-in-powershell.aspx)）

```
$newUser = $usersOU.Create("user","cn=MyNewUser")
$newUser.put("title", "PowerShell Test Account")
$newUser.put("employeeID", 123)
$newUser.put("description", "Test User Account for LazyAdmin Demo")
$newUser.SetInfo() 
```

[使用新邮箱 cmdlet](http://www.msexchange.org/articles-tutorials/exchange-server-2007/management-administration/user-administration-exchange-2007-powershell-cmdlets.html)

[使用 Import-CSV cmdlet](http://www.microsoft.com/technet/scriptcenter/topics/winpsh/importcsv.mspx)（它的 PowerShell 2.0，但主要与 1.0 相关）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T18:28:56.847

csv 文件应包含带有所有字段名称的标题行。

这是代码：

```
$Users = Import-Csv ".\UsersFile.csv"
foreach ($User in $Users)
{
    New-Mailbox -Name $User.Name -Alias $User.MailboxAlias `
        -OrganizationalUnit $User.OU `
        -UserPrincipalName $User.UPN -SamAccountName $User.UserName `
        -FirstName $User.First -Initials $USer.Initial -LastName $User.Last `
        -Password $User.Password -ResetPasswordOnNextLogon $false `
        -Database 'MailboxDatabaseFilename'
} 
```

# c# - Stream.Dispose 是否总是调用 Stream.Close（和 Stream.Flush）

> ID：911408
> 
> 赞同：65
> 
> 时间：2009-05-26T15:51:31.487
> 
> 标签：c#, .net, using

如果我有以下情况：

```
StreamWriter MySW = null;
try
{
   Stream MyStream = new FileStream("asdf.txt");
   MySW = new StreamWriter(MyStream);
   MySW.Write("blah");
}
finally
{
   if (MySW != null)
   {
      MySW.Flush();
      MySW.Close();
      MySW.Dispose();
   }
} 
```

`MySW.Dispose()`即使提供了关闭，我也可以直接调用并跳过关闭吗？是否有任何不能按预期工作的流实现（如 CryptoStream）？

如果不是，那么以下只是错误的代码：

```
using (StreamWriter MySW = new StreamWriter(MyStream))
{
   MySW.Write("Blah");
} 
```

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2009-05-26T15:55:49.637

> 我可以只调用 MySW.Dispose() 并跳过关闭，即使它提供了？

是的，这就是它的用途。

> 是否有任何未按预期工作的 Stream 实现（如 CryptoStream）？

可以安全地假设，如果一个对象实现了`IDisposable`，它将正确地处理自己。

如果没有，那将是一个错误。

> 如果不是，那么以下只是错误的代码：

不，该代码是处理实现`IDisposable`.

更优秀的信息在[Close and Dispose 的公认答案中 - 调用哪个？](https://stackoverflow.com/questions/61092/close-and-dispose-which-to-call)

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2009-05-26T15:57:26.983

我使用了反射器，发现它`System.IO.Stream.Dispose`看起来像这样：

```
public void Dispose()
{
    this.Close();
} 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-06-18T23:52:19.773

正如 Daniel Bruckner 所说，Dispose 和 Close 实际上是一回事。

但是 Stream 在处理/关闭时不会调用 Flush() 。FileStream （我假设任何其他具有缓存机制的 Stream ）在处置时确实调用了 Flush() 。

如果您正在扩展 Stream 或 MemoryStream 等，则需要在必要时在处置/关闭时实现对 Flush() 的调用。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-26T16:36:12.647

所有标准流（FileStream、CryptoStream）都将在关闭/处置时尝试刷新。我认为您可以将其用于任何 Microsoft 流实现。

因此，如果刷新失败，Close/Dispose 可能会引发异常。

事实上，IIRC 在 FileStream 的 .NET 1.0 实现中存在一个错误，即如果刷新引发异常，它将无法释放文件句柄。这在 .NET 1.1 中已通过向 Dispose(boolean) 方法添加 try/finally 块来解决。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-26T16:00:29.877

StreamWriter.Dispose() 和 Stream.Dispose() 都释放对象持有的所有资源。它们都关闭了底层流。

Stream.Dispose() 的源代码（注意这是实现细节，所以不要依赖它）：

```
public void Dispose()
{
    this.Close();
} 
```

StreamWriter.Dispose()（与 Stream.Dispose() 相同）：

```
protected override void Dispose(bool disposing)
{
    try
    {
        // Not relevant things
    }
    finally
    {
        if (this.Closable && (this.stream != null))
        {
            try
            {
                if (disposing)
                {
                    this.stream.Close();
                }
            }
            finally
            {
                // Not relevant things
            }
        }
    }
} 
```

尽管如此，我通常会在处理它们之前隐式关闭流/streamwriters - 我认为它看起来更干净。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-19T00:54:02.753

对于需要手动关闭的对象，应尽一切努力在 using 块中创建对象。

```
//Cannot access 'stream'
using (FileStream stream = File.Open ("c:\\test.bin"))
{
   //Do work on 'stream'
} // 'stream' is closed and disposed of even if there is an exception escaping this block
// Cannot access 'stream' 
```

通过这种方式，人们永远不会在 using 子句的上下文之外错误地访问“流”，并且文件总是关闭的。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-02-15T22:04:16.893

我查看了 Stream 类的 .net 源代码，它具有以下内容，这表明是的，您可以...

```
 // Stream used to require that all cleanup logic went into Close(),
    // which was thought up before we invented IDisposable.  However, we 
    // need to follow the IDisposable pattern so that users can write
    // sensible subclasses without needing to inspect all their base
    // classes, and without worrying about version brittleness, from a
    // base class switching to the Dispose pattern.  We're moving 
    // Stream to the Dispose(bool) pattern - that's where all subclasses
    // should put their cleanup starting in V2\. 
    public virtual void Close() 
    {
        Dispose(true); 
        GC.SuppressFinalize(this);
    }

    public void Dispose() 
    {
        Close(); 
    } 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-26T15:58:06.840

`Stream.Close`通过调用来实现，`Stream.Dispose`反之亦然 - 所以这些方法是等价的。`Stream.Close`存在只是因为关闭流听起来比处理流更自然。

此外，您应该尽量避免显式调用此方法并改用该`using`语句，以便免费获得正确的异常处理。

# wcf - WCF 和 Fluent NHibernate：我怎样才能保持“干净”的课程？

> ID：911410
> 
> 赞同：3
> 
> 时间：2009-05-26T15:51:55.513
> 
> 标签：wcf, nhibernate

我正在为一个内部项目同时调查 Nhibernate、jquery 和 WCF，我想知道为什么我不能拥有“干净”的数据类。

从我所读到的，在 nhibernate 世界中一个非常好的点是我的业务类不会链接到框架。我不会有

```
<SaveInTable("Thingie")> _
Public Class Thingie
    <ColumnName("ThingieId")> _
    Public Property Id as Integer
    ' accessors
End Class 
```

而是类似的东西

```
Public Class Thingie
Public Property Id as Integer
' etc 
```

接着

```
Public Class ThingieMapping
Inherits ClassMap(Of Thingie)
' etc, omitted for brevity's sake 
```

我不明白的是，如果我想使用*jQuery*在网页中列出*Thingie*，并且如果我想使用带有 jquery 的 WCF Web 服务（从我在各种教程中看到的当前趋势来看，它看起来像当前趋势），我发现自己必须将*DataContract*和*DataMember*属性添加到我的*Thingie*类中。 另一方面，经典的 ASMX Web 服务不会打扰我，让我检索*Thingie*类而不用担心添加属性。

 ***我觉得我在这里遗漏了部分图片；尝试保持*Thingie*类大部分独立似乎是合乎逻辑的，但到目前为止我还没有找到示例。

那么，我是否必须放弃所有希望并坚持经典的 Web 服务，或者有没有办法让我的 WCF 蛋糕也吃掉？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T05:38:55.643

我建议您使用 DTO 通过线路发送 - 然后您可以使用必要的属性装饰 DTO。

当然，这意味着您必须以某种方式将您的域类映射到 DTO，反之亦然。如果映射是微不足道的（+一些满足某些约定的其他情况），您可以使用[AutoMapper](http://www.codeplex.com/AutoMapper)。

使用 DTO 有几个好处，最好的好处是你有一个明确的关注点分离 - 你的 NHibernate 映射域模型是关于在你的域中建模的东西，你的 DTO 是用于通过网络发送数据。然后，如果一个发生变化，另一个不一定需要改变。

# asp.net - “请求超时。” 设置 debug="false" 时出错

> ID：911422
> 
> 赞同：5
> 
> 时间：2009-05-26T15:55:08.190
> 
> 标签：asp.net

我有一个需要几分钟才能运行的页面。当我在 web.config 中设置`debug="false"`标签`<compilation />`时，我得到一个“请求超时”。错误（并且我的代码中的内部 try/catch 块得到“线程被中止。”错误。

允许长页面在生产模式下运行的修复方法是什么？调试模式是否有无限超时？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-26T15:59:13.733

您可以设置最大值。web.config 中请求的持续时间：

```
<system.web>
  ...
  <httpRuntime executionTimeout="600" /> 
```

其中 executionTimeout 指定请求在被 ASP.NET 自动关闭之前允许执行的最大秒数。详细信息可以在[这里](http://msdn.microsoft.com/en-us/library/e1f13641.aspx)找到。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-26T16:02:54.337

您应该只需要增加页面执行的脚本超时时间。默认为 90 秒，因此如果您需要更多时间，请在以下 system.web 元素（executionTimeout 属性）中更改它：

```
<httpRuntime executionTimeout="seconds"
             maxRequestLength="kbytes"
             minFreeThreads="numberOfThreads"
             minLocalRequestFreeThreads="numberOfThreads"
             appRequestQueueLimit="numberOfRequests" 
             useFullyQualifiedRedirectUrl="true|false"  /> 
```

# java - 在 JBoss Seam 上实现 SOAP Web 服务的最佳方式是什么？

> ID：911424
> 
> 赞同：2
> 
> 时间：2009-05-26T15:55:38.467
> 
> 标签：java, web-services, soap, seam

我需要在 Jboss Seam 2.1.0 上实现一个 SOAP Web 服务。这个想法是将无状态 bean 方法导出为 Web 服务。

但是，我找到了两种方法。

*   第一个，是使用Seam自己的web services注解。这个问题是缺乏文档。

*   第二个，是使用 Enunciate。它的记录要好得多，但我觉得这不是标准方式。

那么，哪一个是最好的方法？我错过了什么吗？是否有更多关于 JBoss Seam “标准” SOAP Web 服务实现的文档？

在此先感谢，问候，（对不起，因为我是新来的，我不能发布超链接）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T20:03:54.133

我一直使用与 EJB3 配合得很好的 JAX-WS。用 注释你的无状态 bean，用 注释你`@WebService`的方法，用注释你`@WebMethod`的参数`@WebParam`。

让它与 Seam 一起工作的唯一技巧是您是否需要身份验证。在那种情况下，我定义了一个`SOAPHandler`in `standard-jaxws-endpoint-config.xml`。您需要从 SOAP 标头中提取用户名和密码信息并手动使用 Seam 进行身份验证。

# visual-sourcesafe - 从 VSS 获取给定日期的所有文件？

> ID：911426
> 
> 赞同：18
> 
> 时间：2009-05-26T15:56:00.323
> 
> 标签：visual-sourcesafe

有没有办法让 Visual source safe 从给定日期获取项目的所有文件？我们不使用标签，所以我不能回滚到特定标签，并希望我能以某种方式调用某个日期范围来获取特定日期存在的文件？不可能的？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-26T16:06:39.350

据我所知，您必须在命令提示符下使用[get命令，而不是 gui。](http://msdn.microsoft.com/en-us/library/661w6e3d(VS.80).aspx)这样的事情应该做：

```
ss Get "$/AFolder" -R -Vd15-03-2009;2:00a 
```

-R 选项使 get 递归，而 -vd 选项获取指定日期的版本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T16:09:03.870

使用 SourceSafe：按日期获取

[http://web.archive.org/web/20120615102028/http://brennan.offwhite.net/mtblog/archives/000282.htmll](http://brennan.offwhite.net/mtblog/archives/000282.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-06-14T23:39:38.950

您可以右键单击项目，选择**显示历史**并从历史浏览器中获取给定日期的版本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T16:07:08.693

使用命令行，使用`get`带`-Vd`参数的命令

`ss get $/Project -R -GTU -Vd**4/30/2009;3:00a**`

我不确定，但我认为没有办法用 ui 来做到这一点。

# java - 线程“主”java.lang.UnsupportedClassVersionError 中的 Tinyos 异常：.class 文件中的版本号错误

> ID：911427
> 
> 赞同：1
> 
> 时间：2009-05-26T15:56:04.363
> 
> 标签：java, tinyos

当我在 TinyOS 中使用 make 命令时，比如 make mica2。会出现以下问题：

```
Exception in thread "main" java.lang.UnsupportedClassVersionError: Bad version number in .class file
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClass(Unknown Source)
    at java.security.SecureClassLoader.defineClass(Unknown Source)
    at java.net.URLClassLoader.defineClass(Unknown Source)
    at java.net.URLClassLoader.access$100(Unknown Source)
    at java.net.URLClassLoader$1.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(Unknown Source)
    at java.lang.ClassLoader.loadClass(Unknown Source)
    at sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source)
    at java.lang.ClassLoader.loadClass(Unknown Source)
    at java.lang.ClassLoader.loadClassInternal(Unknown Source)
make: *** [exe0] Error 1 
```

我重新安装了 JAVA 并添加了环境变量，但它没有用。我使用 TinyOS 2.1 和 JAVA 1.5 u18。谁能帮我？

通过安装 JDK 1.6 解决了问题。虽然当我运行 tos-check-env 命令时，它向我显示了一个警告，告诉我它不是 JDK 1.4 或 1.5。也许这是 TinyOS 中的一个错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T16:01:58.237

UnsupportedClassVersionError 表示您正尝试在比编译它的旧版本的 JVM 上运行字节码。您可以使用类文件查看器检查源代码编译它的 JDK 版本，并确保它与JAVA 1.5 u18。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T16:05:31.083

您收到的错误意味着正在运行的 Java 版本正在尝试加载使用不兼容的 Java 版本编译的类。

根据您提供的信息，不可能比这更具体地诊断问题 - 查看您正在使用的任何 Java 库以及它们所需的 Java 版本是什么。如果您在这里找不到任何错误，您可能只需要在重新安装之前清除一些使用 Java 版本构建的缓存 *.class 文件。

最后，如果您安装了多个 JVM，请确保`make`使用的是您期望的那个。您绝对可以安装 Java 1.5u18，但应用程序仍会从某个地方查找和使用 1.4 JVM。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-06-27T02:09:50.013

我今天遇到了同样的错误，我只是通过安装java版本1.6和jre6，并将Java 1.6版本作为默认版本来解决它。

我之前也安装了 java 1.5，因为 tos-check-env 希望我安装 java 1.4 或 java 1.5 版本。

我还将 java 1.5 和 1.6 版本都包含到我的类路径中，并`make micaz`在目录中再次运行`/opt/tinyos-2.1.0/apps/Blink`，它工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T18:39:54.317

通常会有一条消息，例如

```
(Unsupported major.minor version 49.0) 
```

在异常消息的第一行。然而，你得到了

```
Bad version number in .class file 
```

那么也许您的类文件已损坏？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-23T12:13:37.877

使用 sudo update-alternatives --config java 并设置您可能想要使用的版本。

# javascript - 使用 javascript 的动态表单提交 - 如何优雅的代码？

> ID：911430
> 
> 赞同：0
> 
> 时间：2009-05-26T15:57:18.560
> 
> 标签：javascript, forms, dynamic, submission

这是问题所在：

我的页面显示一组项目。每个项目都有一个与之关联的复选框（它是表单的一部分）。用户可以选中这些复选框中的任何一个并按“删除”按钮。同一页面还有一个“上传”按钮，可以上传 Excel 项目表。目前，我的表单动作总结说：“xyzAction”，我有两个不同的处理程序（类似于 Struts Action） - 一个用于删除存储，另一个用于上传存储。

有人告诉我，做到这一点的最佳方法是通过执行以下操作之一来依赖 javascript： 1)) 在按下上传和删除按钮时切换表单操作 - 通过调用不同的操作。2）使用隐藏变量“act”将其设置为删除/上传并提交到单个表单。服务器端动作将负责识别动作并转发到相应的动作。

方法（1）-对我来说似乎很不雅。玩表单动作似乎没有必要。方法 (2) - 如果您的 javascript 被关闭并且也不是很优雅，那么显然不会工作。

一定有第三种方法可以做到这一点？这会让我开心吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T16:00:26.353

听起来您可能需要两种不同的形式来执行两种不同的操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T21:51:28.017

您需要先获取正确的 HTML。

你有两个不同的动作，所以你应该有两个表单——一个好的经验法则是每个表单应该只有一个提交按钮。这是 HTML 的最佳实践，将确保页面在没有 JS 或任何其他技巧的情况下工作。

一旦你的页面像这样工作，使用 JS 来操作 DOM 以生成你需要的 UI。这是使用 JS 向 UI 添加行为，是不显眼的 JS 的最佳实践。

（如果你真的想将你的动作合并到一个表单中，用 JS 改变表单的动作是最好的做法。但是考虑一下如果用户选中一个复选框然后改变主意并上传文件会发生什么选中复选框。您应该注意这不应该删除任何内容。）

# sql - Microsoft RAP（风险评估计划）

> ID：911436
> 
> 赞同：4
> 
> 时间：2009-05-26T15:58:00.210
> 
> 标签：sql, sql-server-2005

您认为 Microsoft 的 RAP 计划物有所值吗？有什么建议么 ？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-28T01:00:48.870

我不得不说这取决于许多因素。首先，您在配置和维护他们将要查看的特定 SQL Server 版本方面知识渊博吗？那你为什么要做SQL RAP？是真正获得良好的风险评估，向管理层证明事情正在正确地完成，还是要了解您在努力纠正问题并找到了解更多有关产品的领域的不足之处，还是没有上述的？

我在去年年底完成了一个 SQL RAP，我可以从个人经验告诉你，你只会从中得到尽可能多的东西，就像你愿意学习一样。如果您有集群，请准备好睁大眼睛看到您从未想过要看的区域。SQL RAP 访问有四个不同的阶段，或者至少我的阶段是这样。首先，他们使用 pssdiag 和其他一些简洁的工具从您的 SQL Server 中收集数据，这些工具大部分都留给您。然后他们进行分析，获取数据并对其进行非常彻底的分析，并生成报告和建议。然后，如果您愿意，他们会与您和管理层坐下来讨论所有事情，什么是好的，什么是不确定的，什么是坏的。然后最后一部分，他们作为 DBA 与您坐下来，教您如何使用他们使用的工具，并且他们可以将副本留给您。他们检查了 PAL 工具、SQL Nexus 和其他一些工具，并确保您知道如何使用这些工具进行自我分析。最重要的是，它们为您留下了这些非常详细的报告，您可以将其用作未来设置新环境的自我检查。

这值得么？在你完成它之前，你可能无法告诉它。对我来说，我会将它推荐给任何想了解更多关于运行 SQL Server 的“最佳实践”实现以及希望与高级 Microsoft 现场工程师进行一对一学习时间的人。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-11-12T04:43:36.917

哦，男孩，这就是他们对这个大肆宣传的 RAP 所做的一切。

Pssdiag 已经完成。我们做过 PAL 和 Nexus，他们以前也做过。他们使用了大约 20 Gig 大小的跟踪文件进行分析。

现在，想做RAP。神圣的cRAP，如果这又是同样的事情，那是为了什么。

我期望的不仅仅是这种级别的分析，没有它我认为这是无用的和浪费金钱。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-03-28T13:06:33.367

我参与了 SharePoint 的 2 个 RAP（两周前完成了我的第二个 RAP）。我不确定它要花多少钱（我工作的公司每年使用 MS 获得 3 次 RAP），但绝对值得。

从 2010 年开始，PFE 将保留安装在数据收集机器上的 RAP 工具。这意味着在长达一年的时间里，您可以根据需要多次重新运行完整的 RAP 并分析结果。

RAP 工具（用于 SharePoint）运行一系列测试，分类如下：

*   SQL 配置 (24)
*   服务器运行状况 (4)
*   服务器配置 (7)
*   苔藓配置 (2)

每个测试都会生成一个问题列表，其中包含有关如何解决这些问题的详细建议。

此外，一个称职的 PFE（他们也是）将帮助解决您在您的环境中遇到的任何突出问题，并让您有机会*倾听和学习*。

我会向所有 SharePoint（和 SQL）管理员推荐 MS RAP。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T01:13:18.627

如果您从未有过，那么我认为您至少会从经历中受益一次。我警告你，这可能会让人很谦卑。

# tsql - DB2 相当于 SQL 的 GO？

> ID：911439
> 
> 赞同：2
> 
> 时间：2009-05-26T15:58:36.857
> 
> 标签：tsql, syntax, db2

我编写了一个 DB2 查询来执行以下操作：

*   创建临时表
*   从怪物查询中选择/插入临时表
*   从临时表中选择/从旧表中删除
*   从临时表中选择/插入到不同的表中

在 MSSQL 中，我可以将命令作为一个长查询一个接一个地运行。如果做不到这一点，我可以用“GO”命令来分隔它们。当我在 DB2 中尝试这个时，我得到了错误：

```
DB2CLI.DLL: ERROR [42601] [IBM][CLI Driver][DB2] SQL0199N The use of the reserved
word "GO" following "" is not valid. Expected tokens may include: "". 
SQLSTATE=42601 
```

在临时表超出范围的情况下，我可以使用什么来分隔这些指令？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T16:06:33.203

GO 是在 MSSQL Studio 中使用的东西，我有自己的应用程序来运行 upates 并使用“GO”将语句分开。

DB2 是否支持分号 (;)？这是许多 SQL 实现中的标准分隔符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T16:04:07.000

我会尝试在 BEGIN 和 END 中包装您要执行的操作以设置范围。

GO 不是 SQL 命令，它甚至不是 TSQL 命令。这是解析器的指令。我不了解 DB2，但我想 GO 不是必需的。

[来自 Devx.com 提示](http://www.devx.com/tips/Tip/31213)

> 虽然 GO 不是 T-SQL 语句，但它经常在 T-SQL 代码中使用，除非你知道它是什么，否则它可能是个谜。那么它的目的是什么？好吧，它会导致脚本开头的所有语句或最后一个 GO 语句（以更接近者为准）编译成一个执行计划，并独立于任何其他批处理发送到服务器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T16:07:47.697

您是否尝试过仅使用分号而不是“GO”？

此链接表明分号应该适用于 DB2 - [http://www.scribd.com/doc/16640/IBM-DB2](http://www.scribd.com/doc/16640/IBM-DB2)

# .net - 在 2 台机器上生成的 .tlh 不同

> ID：911461
> 
> 赞同：6
> 
> 时间：2009-05-26T16:02:09.937
> 
> 标签：.net, compiler-construction, com, interop, typelib

我有一个 .NET dll，它有一些暴露给 com 的接口\类。在构建过程中会生成一个 .tlb 文件，并且该 tlb 被一些 c++ 代码引用。因此，编译器会为 tlb 生成一个 .tlh 文件。

当我在本地运行构建时，其中一个接口中的属性之一最终会在 tlh 中具有不同名称的相应方法。.net 代码中的属性称为 PropertyA，最终称为 get_propertyA，而 PropertyB 最终称为 get_PropertyB。发生这种情况时，我没有眨眼，只是使用了 tlh 中定义的方法并假设一切都是 hunky dory，但是当我提交这些更改时，构建对其他人不起作用，因为编译器生成了名为 get_PropertyA 的属性和get_PropertyB（注意 propertyA 中的大小写不匹配）。

两台机器上生成的 tlb 文件是相同的（根据十六进制比较器），并且 tlh 文件都是由相同的编译器版本生成的。

构建过程通过执行以下操作创建 tlb： regasm path\to\dll\Mydll.dll -tlb:path\to\output\mydll.tlb

任何想法为什么我的本地版本最终会出现名称不正确的属性？或者我能做些什么来解决它？

更新：我读到 tlbexp 将使用它找到的字符串的第一个版本，并且可以通过重新编译来改变。虽然我没有使用 tlbexp，但我想知道这是否是问题所在。我发现参数与我的方法（在其他方法中）同名，但开头是小写字母。所以我把这些都换了。重建，没有变化。所以我然后重命名了我的 COM 方法。重新构建并得到预期的缺失方法错误。将该方法重命名为原始名称，嘿，它似乎已修复。由于它现在似乎可以工作并且我不能让它再次失败，我无法尝试建议的解决方案，但我喜欢重命名的想法，以防将来发生这种情况。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-06-09T10:30:33.890

我有同样的问题。

通过另一个 SO 问题（[https://stackoverflow.com/questions/708721/compare-type-libraries-generated-by-tlbexp](https://stackoverflow.com/questions/708721/compare-type-libraries-generated-by-tlbexp)），我发现了这段社区内容：

[http://social.msdn.microsoft.com/Forums/en-US/clr/thread/5003c486-ed3f-4ec8-8398-a1251b0f9e74](http://social.msdn.microsoft.com/Forums/en-US/clr/thread/5003c486-ed3f-4ec8-8398-a1251b0f9e74)

引用该内容：

> 在 tlbexp 的文档中，有一个有用的社区内容：
> 
> [http://msdn2.microsoft.com/en-gb/library/hfzzah2c(VS.80).aspx](http://msdn2.microsoft.com/en-gb/library/hfzzah2c(VS.80).aspx)
> 
> 引用：
> 
> “使用 /names 选项的原因是类型库将每个标识符存储在不区分大小写的表中。遇到的第一个案例获胜。因此，如果存在具有这样名称的参数，名为 Monitor 的类最终可能会被公开为“监视器” “
> 
> 根本原因似乎是中间的一个错误，如下所述：
> 
> [http://support.microsoft.com/default.aspx?scid=kb;en-us;220137](http://support.microsoft.com/default.aspx?scid=kb;en-us;220137)
> 
> 引用：
> 
> “当有两个标识符只是大小写不同时，第二个标识符的大小写会改变以反映第一个标识符的大小写。”
> 
> 因此，作为解决方案，我在项目设置中取消选中“注册 COM 互操作”选项并添加了构建后步骤
> 
> "$(DevEnvDir)....\SDK\v2.0\Bin\tlbexp" $(TargetFileName) /names:"$(ProjectDir)Names.txt" %windir%\Microsoft.NET\Framework\v2.0.50727\ regasm $(目标文件名)
> 
> 名称文件包含定义应该如何进行大写的条目。就我而言，它只包含一行：
> 
> ID
> 
> 最好的祝福
> 
> 伯恩德·里特

使用 /names 为我解决了这个问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-27T04:39:26.177

您可以使用*导入的**重命名*属性来显式重命名属性。说你有，有时变成，有时变成。要始终拥有和使用*重命名*，如下所示：*`propA``PropA``propB``PropB``PropA``PropB`*

 **```
#import <library> rename( "propA", "PropA" ) rename( "propB", "PropB" ) 
```

小心使用它——它会导致一个简单的文本替换，它适用于它在类型库中遇到的任何标识符。在某些情况下，它可能会导致难以调试不需要的副作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T16:13:39.603

健全性检查：您绝对确定两台机器上都使用了相同的#import 指令吗？即正在编译的完全相同的源文件？

尝试在包含项目的目录上创建网络共享并在另一台机器上打开它，以便 1000% 确定这些是正在编译的相同源文件。

抱歉，我没有更具体的建议。

# java - 如何在遍历集合时安全地从集合中删除其他元素

> ID：911462
> 
> 赞同：6
> 
> 时间：2009-05-26T16:02:18.860
> 
> 标签：java, collections

我正在迭代一个 JRE `Collection`，它强制执行快速失败迭代器概念，因此`ConcurrentModificationException`如果`Collection`在迭代时修改了，则会抛出一个，而不是使用`Iterator.remove()`method 。但是，如果对象满足条件，我需要删除对象的“逻辑伙伴”。从而防止伙伴也被处理。我怎样才能做到这一点？也许为此目的使用更好的集合类型？

例子。

```
myCollection<BusinessObject>

for (BusinessObject anObject : myCollection) 
{ 
  if (someConditionIsTrue) 
  { 
    myCollection.remove(anObjectsPartner); // throws ConcurrentModificationException 
  }
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-26T16:09:39.610

这不是收藏的错，而是您使用它的方式。在迭代进行到一半时修改集合会导致此错误（这是一件好事，因为迭代通常不可能明确地继续下去）。

*编辑*：重新阅读问题后，这种方法将不起作用，尽管我将其留在这里作为在一般情况下如何避免此问题的示例。

你想要的是这样的：

```
for (Iterator<BusinessObject> iter = myCollection.iterator; iter.hasNext(); )
{
    BusinessObject anObject = iter.next();
    if (someConditionIsTrue) 
    { 
        iter.remove();
    }        
} 
```

如果您通过 Iterator 本身删除对象，它会知道删除并且一切都按您的预期工作。请注意，虽然我认为所有标准集合在这方面都可以很好地工作，但迭代器*不需要*实现 remove() 方法，因此如果您无法控制的类`myCollection`（以及返回的迭代器的实现类），您可能需要在那里进行更多的安全检查。

另一种方法（例如，如果您不能保证迭代器支持`remove()`并且您需要此功能）是创建集合的*副本*以进行迭代，然后从*原始*集合中删除元素。

*编辑*：您可能可以使用后一种技术来实现您想要的，但是您最终还是会回到迭代器首先抛出异常的原因：**如果您删除了它没有的元素，迭代应该怎么做还没有达到**？删除（或不删除）当前元素的定义相对明确，但是您谈论的是删除当前元素的*partner*，我认为它可能位于可迭代对象中的随机点。由于没有明确的处理方式，因此您需要自己提供某种形式的逻辑来应对这种情况。在这种情况下，我倾向于在迭代期间创建和填充一个新集合，然后将其分配给`myCollection`变量在最后。如果这是不可能的，那么跟踪要删除和调用的合作伙伴元素将是可行`myCollection.removeAll`的方法。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-26T16:06:48.400

您想从列表中删除一个项目并继续在同一个列表上进行迭代。您能否实施一个两步解决方案，在第 1 步中收集要在临时收集中删除的项目，并在第 2 步中识别它们后删除它们？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-26T16:11:47.623

一些想法（这取决于集合中两个对象之间的确切关系）：

1.  以对象为键，伙伴为值的 Map。
2.  一个CopyOnWriteArrayList，但是你打伙伴的时候要注意
3.  将副本复制到不同的 Collection 对象中，然后迭代一个，删除另一个。如果这个原始集合可以是一个集合，那肯定会有助于删除。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T18:24:56.107

您可以尝试先找到所有要删除的项目，然后在处理完整个列表后将其删除。找到已删除的项目时跳过它们。

```
myCollection<BusinessObject>
List<BusinessObject> deletedObjects = new ArrayList(myCollection.size());

for (BusinessObject anObject : myCollection) 
{ 
  if (!deletedObjects.contains(anObject))
  {
      if (someConditionIsTrue) 
      { 
          deletedObjects.add(anObjectsPartner);
      }
  }
}
myCollection.removeAll(deletedObjects); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-26T22:15:44.380

CopyOnWriteArrayList 会做你想做的事。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-26T16:15:55.090

为什么不使用所有原始 BusinessObject 的 Collection，然后使用一个单独的类（例如 Map）来关联它们（即创建伙伴）？将这两者作为复合元素放在它自己的类中，以便在删除业务对象时始终可以删除合作伙伴。每次需要从集合中删除 BusinessObject 时，不要让它成为调用者的责任。

IE

```
class BusinessObjectCollection implements Collection<BusinessObject> {
  Collection<BusinessObject> objects;
  Map<BusinessObject, BusinessObject> associations;

 public void remove(BusinessObject o) {
  ...
// remove from collection and dissasociate...
 }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-26T22:29:00.157

最好的答案是第二个，使用迭代器。

# .net - 如何在开始时使用 TextRenderer.DrawText 获取省略号

> ID：911475
> 
> 赞同：2
> 
> 时间：2009-05-26T16:04:36.017
> 
> 标签：.net, winforms

TextRenderer.DrawText[方法](http://msdn.microsoft.com/en-us/library/ms160657.aspx)有一个[TextFormatFlags](http://msdn.microsoft.com/en-us/library/system.windows.forms.textformatflags.aspx)参数。Using`TextFormatFlags.EndEllipsis`允许您在末尾用省略号缩写文本，以便它适合可用空间。但是，我想把省略号放在开头。奇怪的是`TextFormatFlags`，这样做没有任何价值。

我考虑过自己逐渐缩短字符串，直到它符合[TextRenderer.MeasureText](http://msdn.microsoft.com/en-us/library/system.windows.forms.textrenderer.measuretext.aspx)，但我担心性能。肯定有更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T16:25:23.370

而不是缩短，您应该以“二进制搜索”方式延长。

由于字符串可能比可见区域长得多，如果你从一个字符开始，每次迭代增长 2 倍，然后一旦超出长度限制，一次缩小几个字符，你应该有一种高性能截断算法。

# c# - 这方面有什么问题

> ID：911476
> 
> 赞同：0
> 
> 时间：2009-05-26T16:04:43.007
> 
> 标签：c#, aop, postsharp

我只希望在设置属性时调用它。为什么这不起作用？

```
[DirtyTrackingAttribute(AttributeTargetElements =
   PostSharp.Extensibility.MulticastTargets.Property)]
class Program
{

    public static string Test { get; set; }

    static void Main(string[] args)
    {
        TestIt();
        Test = "foo";
        Console.ReadKey();
    }

    private static void TestIt()
    {
      Console.WriteLine("Real method called");
    }
}

[Serializable]
public class DirtyTrackingAttribute : OnMethodInvocationAspect
{
    public override void OnInvocation(MethodInvocationEventArgs eventArgs)
    {
        Console.WriteLine("Property invoked");
        eventArgs.Proceed();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T07:20:13.810

如果您希望方面仅应用于属性设置器，您可以使用表达式“set_*”过滤方法名称：

```
[DirtyTrackingAttribute(AttributeTargetMembers="set_*")] 
```

PostSharp 1.* 不支持明确的属性；属性访问器被视为普通方法。

# sifr - sIFR onReplacement 示例

> ID：911481
> 
> 赞同：0
> 
> 时间：2009-05-26T16:05:38.883
> 
> 标签：sifr

有人可以告诉我在 sIFR.replace 中调用 onReplacement 回调的正确方法吗？

这是我当前的 sIFR.replace 方法调用：

```
sIFR.replace(mainNavFont, {
  selector: 'a.nav-item',
  css: '.sIFR-root { color: #ffffff; cursor:pointer;}',
  wmode:'transparent',
  fitExactly: true,
  tuneWidth:10,
  offsetLeft: 5,
  forceSingleLine: true
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T17:21:47.873

像这样：

```
sIFR.replace(mainNavFont, {
  selector: 'a.nav-item',
  css: '.sIFR-root { color: #ffffff; cursor:pointer;}',
  wmode:'transparent',
  fitExactly: true,
  tuneWidth:10,
  offsetLeft: 5,
  forceSingleLine: true,
  onReplacement: function(fi) {
    // Movie has been replaced
  }
}); 
```

此外，您会发现`<a>`直接替换 会破坏大多数浏览器中的链接。您必须替换父元素，以使链接最终位于 Flash 影片中。

# java - 在Java中的字段中存储类泛型

> ID：911483
> 
> 赞同：11
> 
> 时间：2009-05-26T16:06:01.740
> 
> 标签：java, generics

有什么方法可以将构造时传入的泛型参数类型存储到参数中。我的目标：

```
class generic<T> {
    Class<T> type;
    public generic() {
        super();
        this.type = //Something that gets class from T
    }
} 
```

我目前正在做的是这样的：

```
class generic<T> {
    Class<T> type;
    public generic(Class<T> type) {
        super();
        this.type = type;
    }
} 
```

必须两次指定类似乎很愚蠢，但我不确定该怎么做。我认为这可能通过反思来实现，但我还没有调查过。有没有更直接的方法？如果不是（顺便说一句）为什么会丢失信息？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-26T16:10:23.087

因为 Java 泛型是用[Type Erasure实现的](http://java.sun.com/docs/books/tutorial/java/generics/erasure.html)

> 当泛型类型被实例化时，编译器通过一种称为类型擦除的技术来转换这些类型——在这个过程中，编译器会删除与类或方法中的类型参数和类型参数相关的所有信息。类型擦除使使用泛型的 Java 应用程序能够保持与在泛型之前创建的 Java 库和应用程序的二进制兼容性。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-26T16:18:48.670

如果您使用带有类型推断的静态创建方法而不是构造函数，则不需要指定两次类型。

```
final class Generic<T> {
    private final Class<T> type;
    private Generic(Class<T> type) {
        super();
        if (type == null) {
            throw new NullPointerException();
        }
        this.type = type;
    }
    public static <T> Generic<T> newInstance(Class<T> clazz) {
        return new Generic<T>(clazz);
    }
}
...
    someFunction(Generic.newInstance(SomeType.class)); 
```

当然，如果你想将结果存储在一个变量中，你可能还是要重复这个类型！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-26T16:08:39.720

我认为你不能这样做，因为[类型擦除](http://java.sun.com/docs/books/tutorial/java/generics/erasure.html)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-26T16:15:25.277

它们的类型在运行时不会保留，因此您不能将其作为参数。Java 中的泛型严格来说是一个编译时概念（出于向后兼容的原因）。这称为[类型擦除](http://java.sun.com/docs/books/tutorial/java/generics/erasure.html)。

类对象采用类型参数的原因之一正是为了解决这个问题，因此您可以采用类对象以编程方式表示类型。

# asp.net-mvc - 如何：使用 Actionfilter 创建缩略图，如 HTTP 处理程序

> ID：911485
> 
> 赞同：0
> 
> 时间：2009-05-26T16:06:26.387
> 
> 标签：asp.net-mvc

抱歉这个蹩脚的问题，但是使用 HTTP 处理程序很容易做到这一点，只需拦截图像文件和参数，HTTP 处理程序就会为你做这件事，例如

问题是如何使用 ActionFilter 做到这一点并让它拦截任何图像？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T16:20:07.403

操作过滤器仅处理当前请求，并且仅当该请求是针对 ASP.NET MVC 控制器时。图像都由不同的、单独的请求处理。即使您可以确定向控制器发出的请求将请求哪些图像，您也无法在单个请求中返回多个文件。实际捕获对图像本身的请求并通过 get 查询生成缩略图的唯一方法是自定义 HttpHandler。

# css - IE浏览器滚动条的宽度？

> ID：911492
> 
> 赞同：3
> 
> 时间：2009-05-26T16:07:22.220
> 
> 标签：css, internet-explorer

我有一个客户端，其显示器上的分辨率宽度为 1200，我需要最大化我的网站的宽度，但我不希望客户端必须使用水平滚动条。您可以在 IE 7 屏幕分辨率为 1200 且无需使用水平滚动条的网站中使用的最大宽度是多少（其他用户将具有更大的宽度，并且所有用户必须具有相同的宽度）？

额外信息 - 该网站已经建成，不能使用 100% 的宽度，因为这在非文本网站中会产生不良后果。是的，分辨率是 1200 的宽度（客户端有一个 1920 X 1200 分辨率的监视器，设置在其一侧）。

操作系统是 Vista，由于客户是政府，他将至少在 2010 年之前拥有 Vista，并且不能更改他的主题/浏览器等。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-26T16:29:08.090

你问了两个问题，真的。要回答标题问题：

20px（IE7、Windows XP、默认主题）

其他人在回答真正的问题方面做得很好。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-26T16:21:56.433

怎么样：

```
body{
  width:100%;
} 
```

我的意思是，让用户将他们的浏览器调整到他们想要的任何大小，并使您的内容适合他们的屏幕。

***更新：***

正如用户在下面指出的那样，有时 100% 有点太多了......对于这些情况，我强烈推荐 Cameron Adams（蓝衣人）的这篇[文章](http://www.themaninblue.com/writing/perspective/2004/09/21/)和[演示](http://www.themaninblue.com/experiment/ResolutionLayout/)，它应用了重新排列内容/CSS 基础的流体布局在浏览器的宽度上。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T16:24:58.613

很简单，最大宽度是 100%。

说真的，你有什么可能的理由来设计一个单人单机规模的网站？当他们购买新电脑时会发生什么？

我将任何固定宽度的网站设计为大约 900-1000 像素并将其居中。这是大多数网站采用的一般方法，我强烈建议不要偏离它，除非您的设计能够使用百分比宽度。如果您在这些条款中解释它并向他们展示遵循此行为的数千个流行网站中的任何一个，您的客户将会理解。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T23:41:05.627

如果你不想将css中的body宽度设置为100%，那就设置为95%左右。这仍然允许页面扩展/收缩到最终用户所需的宽度，在没有水平滚动的情况下缩小到只有 400 宽度。

无论您将其用于最小页面宽度还是最大页面宽度，以下公式都应该适合您。

```
$safe_PgWidth_Percentage = (1 - (20/$minPageWidth)); 
```

虽然受限环境中的用户可能无法更改他们的操作系统、浏览器等。我无法想象他们无法抓住浏览器窗口的一角并通过拖动来缩小或放大它。

这就是您的评论者所要表达的观点。将正文编码为一个百分比，实际上尽可能接近 100%，可以解决可用性问题，包括解决您的水平滚动困境。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-26T16:10:37.207

只是不要硬编码任何像素宽度？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-26T16:14:03.767

您似乎不太可能将其精确到像素。由于用户可以更改他们的 Windows 主题，因此右侧滚动条的宽度可能会有所不同。

我见过的大多数网站都这样做允许他们的网站使用 CSS “浮动”到页面的宽度中。

# apache-flex - Flex/Flash "popup balloon" control?

> ID：911503
> 
> 赞同：1
> 
> 时间：2009-05-26T16:10:33.120
> 
> 标签：apache-flex, flash, components, widget

I'm looking for a Flash/Flex component which will create a "popup" editing balloon, similar to, for example, iCal or Google calendar:

[http://img.skitch.com/20090526-phb5mke61anjkfknaekdbjjefw.jpg](http://img.skitch.com/20090526-phb5mke61anjkfknaekdbjjefw.jpg) [![](https://i.stack.imgur.com/0F8jk.png)](https://i.stack.imgur.com/0F8jk.png)
[(source: [iusethis.com](http://osx.iusethis.com/screenshot/osx/ical.png))]

Does such a thing exist?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T16:17:32.747

The [Tooltip Control](http://livedocs.adobe.com/flex/3/langref/mx/controls/ToolTip.html) is what you're looking for. You might want to extend the class to allow for more advanced functionality.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-22T06:04:32.027

there are fallowing code for balloon popup. Atul Yadav [http://techy.limewebs.com](http://techy.limewebs.com)

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Canvas xmlns:mx="http://www.adobe.com/2006/mxml" width="294" height="104" 
    backgroundAlpha="1.0" backgroundColor="#FFFFFF" borderColor="#1B86D1" 
    borderStyle="solid" creationComplete="DrowLine()">
<mx:Script>
    <![CDATA[
        import mx.controls.Alert;
        import mx.core.Application;
        import mx.managers.PopUpManager;
        private function OnClose():void{
            PopUpManager.removePopUp(this);
        }
        private function DrowLine():void{
                var pt:Point = new Point(0, -13);
                var global:Point = Application.application.localToGlobal(pt);
                var origin:Point =global;
                var destination:Point = new Point(150,0);
                var destination1:Point = new Point(50,0);
                var lineThickness:Number = 1;
                var lineColor:Number = 0x1B86D1;
                var lineAlpha:Number = 1;
                //Alert.show(global.toString());

                var tip:Canvas = new Canvas();

                tip.graphics.clear();
                tip.graphics.beginFill(0xffffff,1);

                tip.graphics.lineStyle(lineThickness,lineColor,lineAlpha);
                tip.graphics.moveTo(origin.x,origin.y);
                tip.graphics.lineTo(destination.x,destination.y);
                tip.graphics.lineStyle(1,0xffffff,lineAlpha);
                tip.graphics.lineTo(50,0);
                tip.graphics.lineStyle(1,0x1B86D1,1);
                tip.graphics.lineTo(origin.x,origin.y);
                tip.graphics.endFill();
                addChild(tip);

            }
    ]]>
</mx:Script>
    <mx:TextArea x="10" y="25" width="274" id="txt_message" borderColor="#2487CC"/>
    <mx:Label x="10" y="75" text="Attach:" width="54" fontWeight="bold" color="#000000"/>
    <mx:Button x="58" y="73" label="Browse" cornerRadius="0" borderColor="#288ACF" color="#4DB111"/>
    <mx:Button x="219" y="73" label="Save" id="btn_save" name="btn_save" cornerRadius="0" color="#15AE11" borderColor="#308FD1"/>
    <mx:Image x="272" y="2" width="18" height="18" source="assets/Close.PNG" click="OnClose()"/>

</mx:Canvas> 
```

# linq-to-sql - Linq to Sql - 在 where 子句中使用 sum

> ID：911508
> 
> 赞同：0
> 
> 时间：2009-05-26T16:11:28.390
> 
> 标签：linq-to-sql

我正在尝试选择其中订购的产品超过或低于 2000 件的订单，具体取决于其他值。我需要从 Orders 表中选择信息，但在 OrdersProducts 表中检查该值，特别是 OrdersProducts.ProductQty 的总和。由于其他要求，我还需要使用谓词生成器来执行此操作。到目前为止，我有这个，但它没有正确返回结果。它使用嵌套的 Lambda 表达式，我不知道我可以这样做，但我尝试了它并且它有效，但它没有返回正确的结果。

```
Dim getOrders = From d In db.Orders _
                Where d.Status = OrderStatus.Approved _
                Select d

' Then a for loop adding parameters via Predicatebuilder... 

If over2000 = True Then
    ' over 2000
    predicate1 = predicate1.And(Function(d) (d.OrderProducts.Sum(Function(c) c.ProductQty > 2000)))

Else
    ' under 2000
    predicate1 = predicate1.And(Function(d) (d.OrderProducts.Sum(Function(c) c.ProductQty < 2000)))

End If

basePredicate = basePredicate.Or(predicate1)

' End For loop

getOrders = getOrders.Where(basePredicate) 
```

为简洁起见，我删除了一些代码，但我认为这很重要。我怎样才能做到这一点？？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T16:17:16.723

尝试改变这个：

```
(d.OrderProducts.Sum(Function(c) c.ProductQty > 2000)) 
```

对此：

```
(d.OrderProducts.Sum(Function(c) c.ProductQty) > 2000) 
```

我没有构建它来测试它，但它似乎正在尝试对布尔比较的结果求和，而不是对数量求和然后进行比较。

# c - 释放从 C 函数返回的内存

> ID：911517
> 
> 赞同：5
> 
> 时间：2009-05-26T16:14:20.553
> 
> 标签：c, file, free

在 C 中，在释放从函数返回的内存时，这是更好的做法：

*   提供一个“析构函数”来封装对 free() 的调用。
*   要求用户自己 free() 返回的指针。

例如，要打开和关闭文件，我们这样做：

```
FILE* f = fopen("blah", "w");
fclose(f); 
```

这是否更可取：

```
FILE* f = fopen("blah", "w");
fclose(f);
free(f); 
```

**警告：**不要在 FILE 指针上调用 free()。我在这里只使用它一个假设的实现。

那么局部变量指向返回内存的情况呢？free() 在这里有害吗？（或者也许永远不应该这样做）

```
FILE f = &fopen("blah", "w");
fclose(&f); 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-26T16:21:12.737

分配和释放内存的最佳选择是对称地进行。即如果调用者分配内存，让调用者释放它。如果您的 API 分配内存（被调用者），那么您的 API 应该释放它。

调用方 alloc/free 示例：

```
int * mymem = (int *)malloc(20 * sizeof(int));
...
a_func_to_call(mymem);
...
free(mymem); 
```

被调用者 alloc/free 的示例：

```
FILE* f = fopen("blah", "w"); // allocs a FILE struct
fclose(f); // The implementation of fclose() will do what's necessary to 
           // free resources and if it chooses to deallocate any memory
           // previously allocated 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-26T16:19:50.853

您永远不应该释放文件 - fclose 处理正确释放资源。通常，只有由 malloc 直接分配的空闲指针。大多数其他指针都有自己的资源清理功能。

话虽这么说，至于你最初的问题：

我发现提供析构函数通常是更好的做法，原因有三个。

1) 在很多情况下，免费是不合适的，这对您的最终用户来说可能并不明显。FILE* 就是一个很好的例子——你不应该在`free(f);`上面打电话......

2) 如果您在 DLL 中使用它，则取决于运行时，封装免费功能可以解决混合运行时产生的许多细微错误，尤其是在 Windows 平台上。如果您碰巧在一个平台的代码中释放了在另一个平台上分配的内存，那么尝试使用在 VS2005 中从 VS2008 编译的 DLL 可能会导致问题。拥有一个“包装器”功能来处理内存管理可以解决这个重大问题。

3) 许多 C API 函数以这种方式工作 - 例如使用 fopen/fclose 的 FILE*。这对于您图书馆的用户来说并不奇怪。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-26T16:16:33.793

您不能释放 FILE* 它不是由 malloc 分配的。
由于您不负责分配它-您不应该释放它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-26T16:19:18.763

`FILE* f`是一个指向 FILE 对象的指针，该对象用于在涉及文件的所有进一步操作中标识流。您不应该使用`free(f)`，因为内存不是由`malloc().`

`fclose`足以关闭与流关​​联的文件。

关于您关于提供析构函数来释放内存的问题：我认为如果函数不仅仅释放内存，那么提供析构函数是合适的。

```
wrapperFree(Pointer* p)
{
 //do some additional work [ other cleanup operations ]
 free(p);
} 
```

此外，对于 WrapperFree 相关的 WrapperAllocate 需要提供。

否则，我认为拇指规则将明确适用于每个`malloc()`呼叫`free()`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T16:18:52.323

`fopen`返回指向 C 库内部管理`FILE`结构的指针，该结构`free`通过调用`fclose`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-26T16:21:19.073

我猜你的意思是`malloc()`而不是`fopen()`。malloc() 分配内存并返回分配内存的地址。这必须使用`free()`调用释放。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-26T16:21:49.773

`free()`正如 mgb 所说，不需要`FILE *`. 但在典型使用中，有库调用和您自己的代码将分配内存并让您负责。以下是一些宽松的指导方针：

*   当除了`free`内存之外还需要发生某些事情时，请创建一个“析构函数”。这些`FILE *`东西是一个很好的例子：它必须处理文件本身以及处理内存。
*   `free()`当它只是一块内存时使用bare 。其他任何事情都是多余的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-26T16:23:39.537

没有上下文就没有最佳实践...

但是我想说信息隐藏的原则意味着函数使用的内存分配和释放的细节通常应该封装在函数中。

open/allocate 函数应该返回某种由 close 函数关闭/释放的不透明句柄。

FILE* 可以被认为是一个不透明的句柄。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-26T16:26:56.550

如前所述，将“管家”代码包装在相应的函数（即构造函数/析构函数）中通常是一种很好的做法，特别是在处理异常处理时，甚至在指定您自己的退出/信号处理程序时也很有用：

在这种情况下，使用析构函数助手非常有用，因为您可以简单地使用 atexit() 等函数注册它们，以便在程序终止时自动调用它们，从而可以正确清理全局状态。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-27T02:42:53.810

我不仅喜欢析构函数，而且喜欢 Dave Hanson 的约定，它获取指针的*地址并在内存被释放时将指针清零：*

```
Thing_T *Thing_new(void);
void Thing_dispose(Thing_T **p);   // free *p and set *p = NULL 
```

# linux - 如何让 Perl 等待使用 system() 在后台启动的子进程？

> ID：911520
> 
> 赞同：10
> 
> 时间：2009-05-26T16:14:51.673
> 
> 标签：linux, perl, wait, child-process

我有一些 Perl 代码为多个参数执行 shell 脚本，为了简化，我假设我的代码如下所示：

```
for $p (@a){
    system("/path/to/file.sh $p&");
} 
```

在那之后我想做更多的事情，但我找不到等待所有子进程完成后再继续的方法。

将代码转换为使用 fork() 会很困难。没有更简单的方法吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-26T16:33:32.883

使用 fork/exec/wait 还不错：

```
my @a = (1, 2, 3);
for my $p (@a) {
   my $pid = fork();
   if ($pid == -1) {
       die;
   } elsif ($pid == 0) {
      exec '/bin/sleep', $p or die;
   }
}
while (wait() != -1) {}
print "Done\n"; 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-26T16:32:31.093

您将不得不更改某些内容，更改代码以使用 fork 可能更简单，但如果您坚决反对使用 fork，您可以使用一个包装器 shell 脚本，该脚本在完成后会触及文件，然后使用您的 Perl 代码检查文件是否存在。

这是包装：

```
#!/bin/bash

$*

touch /tmp/$2.$PPID 
```

您的 Perl 代码如下所示：

```
for my $p (@a){
    system("/path/to/wrapper.sh /path/to/file.sh $p &");
}
while (@a) {
    delete $a[0] if -f "/tmp/$a[0].$$";
} 
```

但我认为分叉代码更安全、更清晰：

```
my @pids;
for my $p (@a) {
    die "could not fork" unless defined(my $pid = fork);\
    unless ($pid) { #child execs
        exec "/path/to/file.sh", $p;
        die "exec of file.sh failed";
    }
    push @pids, $pid; #parent stores children's pids
}

#wait for all children to finish
for my $pid (@pids) {
    waitpid $pid, 0;
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-26T16:29:04.860

转换为 fork() 可能很困难，但它是正确的工具。system() 是一个阻塞调用；你通过执行一个shell并告诉它在后台运行你的脚本来获得非阻塞行为。这意味着 Perl 不知道孩子的 PID 可能是什么，这意味着您的脚本不知道要等待什么。

您可以尝试将 PID 传递给 Perl 脚本，但这很快就会失控。使用叉子（）。

# java - HttpServletRequest 的属性字段如何映射到原始 HTTP 请求？

> ID：911529
> 
> 赞同：9
> 
> 时间：2009-05-26T16:17:29.190
> 
> 标签：java, http, servlets

在 Java 中，可以使用 getAttribute 方法检索 HttpServletRequest 对象的属性字段：

```
String myAttribute = request.getAttribute("[parameter name]"); 
```

HttpServletRequest 属性数据存储在原始 HTTP 请求中的什么位置？它在请求的正文中吗？

例如，我正在尝试创建一个原始的 GET HTTP 请求，该请求将使用一些客户端程序发送到我的 servlet。我的 servlet.doGet() 方法是这样的：

```
public void doGet(HttpServletRequest request, HttpServletResponse response)
{
     String myAttribute = request.getAttribute("my.username");
     ...
} 
```

我应该将“my.username”数据放在原始 HTTP 请求中的哪个位置，以便“myAttribute”字符串在归属后接收值“John Doe”？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-26T16:34:05.083

只是要清楚，因为我认为@Jon 的回答并不能完全清楚。HttpServletRequest 上的 getAttribute 和 setAttribute 的值并不存在于实际通过网络发送的内容中，它们只是服务器端的。

```
// only visible in this request and on the server
request.getAttribute("myAttribute"); 

// value of the User-Agent header sent by the client
request.getHeader("User-Agent"); 

// value of param1 either from the query string or form post body
request.getParameter("param1"); 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-26T16:55:43.137

为了添加到@gid 的答案，HTTP 请求中不存在任何属性，因为它通过网络传输。它们是在处理请求时（由您的代码）创建的。一个非常常见的用途是让服务器设置（也称为创建）一些属性，然后转发到将使用这些属性的 JSP。也就是说，一个 HTTP 请求到达并被发送到一个 Servlet。Servlet 附加了一些属性。完成额外的服务器端处理，最终将页面发送到使用属性的 JSP。响应在 JSP 中生成。HTTP 请求和 HTTP 响应不包含任何属性。属性是 100% 纯粹的服务器端信息。

当一个给定的 HTTP 请求完成后，这些属性就可用于垃圾收集（除非它们被持久化在某个其他位置，例如会话）。属性仅与单个请求对象相关联。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-09-15T10:50:16.040

我认为他真正要问的是“我如何在我的程序中获取参数”，而不是属性。如果这是问题所在，则在 GET 请求中发送参数作为 URL 的一部分（在问号之后，[http://myhost.com/myapp?name=joe&age=26](http://myhost.com/myapp?name=joe&age=26)）然后使用 request.getParameter("name ") 和 request.getParameter("age")，或者你需要的任何东西。

# c# - 内置类型，何时（不）使用？

> ID：911536
> 
> 赞同：7
> 
> 时间：2009-05-26T16:19:13.163
> 
> 标签：c#, .net, vb.net

C# 和 VB.NET 带有映射到 CLR 类型的内置类型。例如：int (C#) 和 Integer (VB) 映射到 System.Int32，long (C#) 和 Long (VB) 映射到 System.Int64。决定何时使用内置类型或不使用它们（使用 System.* 结构/类）的最佳实践是什么？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-05-26T16:23:53.637

我几乎总是使用内置别名，例如 int/short/long。它们更易于阅读，并且不需要您导入 System 或在任何地方键入 System.Int32 等。

语言清楚地定义了它们，并赋予它们特定的含义，所以我看不出有什么害处。然而，这100%是个人选择。

话虽这么说 - 我明确使用 Int32、Int16 等的一个地方是，如果我正在处理二进制存储或传输，尤其是与自定义二进制格式之间的传输。在这种情况下，让每个成员的显式位大小进出文件会使代码更具可读性和可理解性，IMO。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-05-26T16:23:03.623

语言类型（例如 string、int、char）只是 CLR 类型（System.String、System.Int32、System.Char）的别名。

它们是可以互换的，没有必要偏爱一个。

**编辑**

海报要求在两者之间进行选择时提供一些帮助，非常好。

就我个人而言，我*倾向于*选择 C# 语言类型（int、string、char 等），因为它们涉及的输入更少——我想我只是懒惰 :)

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-05-26T16:21:06.217

我唯一一次明确使用 "`System.XYZ"`而不是内置类型关键字是当我需要一个非常特定大小的整数类型，并且我希望任何阅读我的代码的人都清楚这一点（例如，我可能使用`Int32`而不是`int`if有问题的整数实际上是 4 个 8 位字段打包在一起。）

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-26T16:43:11.103

我总是使用这些`System.*`类型，因为它们在其他类之间看起来更一致——大写首字母和相同的语法突出显示。但这只是个人喜好，只是审美问题。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-26T16:28:12.693

使用“int”和“Int32”（以及其他）完全相同。通常使用关键字（int、Integer (vb.net)、bool 等），因为它更短并且在 IDE 中突出显示。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-26T16:44:26.093

与其何时使用或不使用语言类型与显式 BCL 类名称相比，更重要的是了解您打算使用的类型是否符合 CLS。

具体来说，无符号整数类型不符合 CLS，因为不要求语言支持无符号整数数学。

除了这个皱纹......我会推荐更符合您组织代码实践的成语。如果您完全命名您的类型引用，那么我将使用 System.* 命名空间继续该模式...（不过，我也建议不要这种做法，因为它增加了阅读器负载而没有随之而来的清晰度增益）。

# javascript - 带有图像的 jQuery 自动完成功能

> ID：911537
> 
> 赞同：21
> 
> 时间：2009-05-26T16:19:13.240
> 
> 标签：javascript, jquery, autocomplete

我想在我的网站中使用图像实现自动完成功能。

我想使用 jQuery 自动完成插件。

我看了一下他们的示例代码。

谁能解释一下以下代码在 $(document).ready() 事件中的含义：

```
$("#imageSearch").autocomplete("images.php", {
  width: 320,
  max: 4,
  highlight: false,
  scroll: true,
  scrollHeight: 300,
  formatItem: function(data, i, n, value) {
    return "<img src='images/" + value + "'/> " + value.split(".")[0];
  },
  formatResult: function(data, value) {
    return value.split(".")[0];
  }
}); 
```

我的最终要求是当我在文本框中键入一些字母时，我希望选项带有与之关联的图像。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-26T16:33:00.313

使用此作为参考：[http ://api.jqueryui.com/autocomplete/](http://api.jqueryui.com/autocomplete/)

* * *

```
$("#imageSearch").autocomplete("images.php", { 
```

将插入自动完成应用于所有字段#imageSearch。第一个参数我猜它是根据输入的内容生成响应的页面（images.php）；

```
 width: 320, 
```

下拉菜单的宽度

```
 max: 4, 
```

最大建议

```
 highlight: false, 
```

突出显示真/假

```
 scroll: true, 
```

滚动条又名下拉列表，或者只是一个长的 div。

```
 scrollHeight: 300, 
```

自动完成下拉的高度。

```
 formatItem: function(data, i, n, value) {
            return "<img src='images/" + value + "'/> " + value.split(".")[0];
        }, 
```

如何格式化从*images.php*返回的响应。

```
 formatResult: function(data, value) {
             return value.split(".")[0];
        } 
```

如果用户选择其中一个选项，如何返回值。

```
}); 
```

右括号：p

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-11-17T13:59:47.480

这是关于 Jquery Autocomplete PLUGIN 的，在实际的 Jquery UI Autocomplete 中没有 formatItem 和 formatValue 这样的选项。

我建议人们阅读这个[http://www.learningjquery.com/2010/06/autocomplete-migration-guide](http://www.learningjquery.com/2010/06/autocomplete-migration-guide)，它解释了如何从旧插件版本迁移到官方 UI 小部件。

要让您自动完成使用建议列表中的图像，您应该阅读此线程：http: [//forum.jquery.com/topic/using-html-in-autocomplete](http://forum.jquery.com/topic/using-html-in-autocomplete)

# javascript - 像 Windows 一样的 Javascript 时间选择器

> ID：911551
> 
> 赞同：2
> 
> 时间：2009-05-26T16:22:20.490
> 
> 标签：javascript, datetimepicker

我正在寻找某种 Javascript 时间选择器的示例，它类似于 Windows 中用于选择时间的那个......好吧，除了没有秒数。我目前有一个模型，但试图弄清楚一些用户功能应该是怎样的，因为它是两个输入和一个下拉菜单。我想我现在对此并不满意。提前感谢您的帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T16:40:05.633

有许多 jQuery 插件可用于完美的时间选择器控件。

这是一个很好的： http: [//plugins.jquery.com/project/timepicker](http://plugins.jquery.com/project/timepicker)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T16:47:08.100

Windows 时间选择器（如果您指的是更改系统时钟的选择器）基本上只是一个蒙面的编辑文本框。如果您正在寻找类似的东西，您只需要一些 JavaScript 来进行蒙版编辑，例如：

[http://digitalbush.com/projects/masked-input-plugin/](http://digitalbush.com/projects/masked-input-plugin/)

为了专门针对时间，您应该能够轻松添加逻辑以确保小时不超过 12（或 24），分钟不超过 59。

就个人而言，我更喜欢 Google 日历选择时间的方式。有一个 jQuery 插件可以在这里找到：

[http://labs.perifer.se/timedatepicker/](http://labs.perifer.se/timedatepicker/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T16:38:28.133

这是一个很酷的。

[http://www.java2s.com/Code/JavaScript/GUI-Components/FancyTimePicker.htm](http://www.java2s.com/Code/JavaScript/GUI-Components/FancyTimePicker.htm)

[此处](http://www.java2s.com/Code/JavaScriptDemo/FancyTimePicker.htm)发布了该控件的在线示例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T16:45:58.587

我很喜欢 jQuery 的东西，这里有一个相当不错[的](http://haineault.com/media/jquery/ui-timepickr/page/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T16:57:28.640

Like Dan said, if you are looking for a masked text input and if you want to use the PrototypsJS framework, there is [http://code.google.com/p/phenx-web/](http://code.google.com/p/phenx-web/) . And if you want a good date/time picker, you could use this : [http://home.jongsma.org/software/js/datepicker](http://home.jongsma.org/software/js/datepicker) (also PrototypeJS). I'm currently working on it with Jerermy Jongsma to add more features.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-09T19:11:43.993

I ended up creating a prototype time picker that for the time being is less fancy than a lot of the others out there. It shows up a regular input until you click on it then it shows a dropdown that has times in it. I can share the code if anyone is interested

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-04-26T13:39:01.547

A timepicker shouldn't slow down the user's interaction, should be pretty straightforward without having to play with it for a while, and should be keyboard-accessible for users who can't manipulate a mouse. The time-picking functionality provided by the [Any+Time™ Datepicker/Timepicker AJAX Calendar Widget with TimeZone Support](http://www.ama3.com/anytime/) meets all of these design goals, supports countless date/time formats and is easy to customize using CSS or jQuery UI.

A good test of timepicker usability is to think of an odd time (say, 10:32pm) and then see how long it takes to accurately select that time using various time pickers. You can probably do it with Any+Time™ faster than you can even write out the time by hand... how's that for speed and ease of use? :-p

# jquery - 我从未见过的jquery Bind方法的用法

> ID：911552
> 
> 赞同：3
> 
> 时间：2009-05-26T16:22:20.880
> 
> 标签：jquery

在尝试熟悉 jQuery 时，我遇到了一些我无法理解的示例代码。它指的是绑定方法和他们使用它的方式。这里是

```
$('textControl').bind(($.browser.opera ? 'keypress', 'keydown') + '.autocomplete', function(event) { code...}); 
```

我了解 keypress 或 keydown 的选择，但我不明白为什么他们将 .autocomplete 附加到偶数处理程序名称上？

如果任何人都可以提供一些启发，那就太好了

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-26T16:24:31.687

让我一步一步来解释。

```
$('textControl').bind( 
```

绑定到 textControl

```
($.browser.opera ? 'keypress', 'keydown') 
```

如果浏览器是opera，第三表达式返回keypress，否则返回keydown。

```
'.autocomplete' 
```

自动完成是 jQuery 插件添加到按键事件对象的自定义事件。所以基本上他们只是将它分组以使其更有条理，但它是一个自定义命名空间事件。

所以实际上，该事件附加到 keypress/keydown，但您可以使用命名空间绑定和取消绑定，从而保持工作空间井井有条。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-26T16:27:13.473

这是 jQuery 的一个名为**[Namespaced Eventets](http://docs.jquery.com/Namespaced_Events)**的功能，它经常在插件中使用，因为它允许插件以一种简单快捷的方式仅操作它自己的事件。

# .net - 在 SQL Server 2005 上本地开发，然后部署到共享主机

> ID：911558
> 
> 赞同：1
> 
> 时间：2009-05-26T16:23:51.313
> 
> 标签：.net, sql, sql-server, hosting, data-migration

当您将数据库设计和应用程序设计平滑然后部署到共享主机时，在本地 SQL Server 2005 机器上进行开发的最佳方法是什么？

在 MySQL / phpMyAdmin 世界中，您可以选择将表导出为 DDL 语句，其中数据表示为 DDL 后面的一堆插入。使用它，您可以删除一个表，重新创建它，然后从查询窗口中加载数据。

在微软的世界里有什么接近这个的吗？是否有任何免费/开源工具可以帮助进行这种数据迁移？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T16:37:03.127

[SQL Server Management Studio Express](http://www.microsoft.com/downloads/details.aspx?FamilyId=C243A5AE-4BD1-4E3D-94B8-5A0F62BF7796&displaylang=en)（免费）包括 TheTXI 提到的“生成脚本”选项。

[数据库发布向导](http://www.microsoft.com/downloads/details.aspx?familyid=56E5B1C5-BF17-42E0-A410-371A838E570A&displaylang=en)是一个更轻量级的产品（也是免费的），专门用于为模式和数据生成导出脚本。

**警告**——两者都不是 100% 可靠的。我有时不得不修改脚本以使它们运行，尤其是在依赖对象的顺序方面。这是一种痛苦，但仍然比从头开始好。

正如 RedBeard 所提到的，您应该跟踪您的 DDL 脚本，特别是那些将您从数据库的一个版本升级到下一个版本的“差异”脚本。在这种情况下，这些工具在正常的开发周期中将无用。但是，如果您没有以这种方式管理脚本，这些工具可以帮助您入门，并且还可以用于创建新实例、迁移实例、比较快照以及许多其他事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T16:26:14.443

生成所有数据库模式（表、存储过程、视图等）的脚本，并导出数据（如有必要），然后运行这些脚本并将数据导入共享主机。根据该主机，您可以通过 Management Studio 进行访问，这将是一个更简单的过程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T16:40:36.833

几个选项：

### 跟踪数据库的 DDL 脚本

您有一组脚本可以执行来创建或更新您的数据库。您实际上可以从 SQL Server 数据库本身中提取 DDL 语句。查看 INFORMATION_SCHEMA 系统视图。

例如，要获取有关存储过程及其定义的信息，请查看 ROUTINE_DEFINITION 字段（请记住，您会发现一些您未定义但内置于 sql server 的其他过程）：

```
SELECT SPECIFIC_SCHEMA,SPECIFIC_CATALOG, SPECIFIC_NAME, ROUTINE_DEFINITION 
FROM INFORMATION_SCHEMA.ROUTINES 
```

### 使用 Visual Studio 数据库团队版（开发团队版附带）

基本上它会为您完成上述工作并简化数据库的设置和修订控制。它允许您定义数据和结构，还具有许多单元测试功能。

### 本地数据库的备份和恢复

备份您的本地数据库，将其上传到您的主机，在那里恢复数据库。

### 复制/移动您的 MDF/LDF 文件

与备份/恢复类似，您需要分离数据库，将文件复制或移动到您的网络主机，然后重新连接到那里。

### 使用 SQL Server 引擎在 ASP.NET 的 App_Data 文件夹中附加 MDF/LDF 文件

应该有几个例子来说明如何做到这一点。它将数据库视为文件，但它确实需要在 Web 主机上安装 SQL Server 引擎。

例如，取自 ASP.NET MVC 模板 (web.config)：

```
<connectionStrings>
  <add name="ApplicationServices" connectionString="data source=.\SQLEXPRESS;Integrated Security=SSPI;AttachDBFilename=|DataDirectory|aspnetdb.mdf;User Instance=true" providerName="System.Data.SqlClient"/>
</connectionStrings> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T16:27:49.510

TheTXI的解决方案很好。进行备份和恢复也可以，有时（取决于 ISP/主机对 MS SQL 的锁定）是唯一的选择。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T17:23:20.240

您还可以选择提供 myLittleBackup (www.mylittlebackup.com) 等工具的共享托管公司，以便您可以轻松地在共享服务器上安装/恢复您的数据库。

# c++ - 非阻塞套接字上的 select()、recv() 和 EWOULDBLOCK

> ID：911565
> 
> 赞同：10
> 
> 时间：2009-05-26T16:25:19.843
> 
> 标签：c++, c, sockets

我想知道下面的场景是不是真的？！

1.  非阻塞 TCP 套接字上的 select() (RD) 表示套接字已准备好
2.  尽管调用了 select()，但随后的 recv() 将返回 EWOULDBLOCK

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-26T16:32:51.123

因为`recv()`你会得到`EAGAIN`而不是`EWOULDBLOCK`，是的，这是可能的。由于您刚刚检查过，`select()`因此发生了以下两件事之一：

*   其他东西（另一个线程）已经耗尽了 和 之间的输入`select()`缓冲区`recv()`。
*   在套接字上设置了接收超时，并且它在没有接收到数据的情况下过期。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-26T16:28:56.920

这是可能的，但仅在您有多个线程/进程试图从同一个套接字读取的情况下。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-08-23T11:23:58.150

在 Linux 上，当我读到它时，它甚至记录了这可能发生。

看到这个问题：

[选择系统调用的虚假就绪通知](https://stackoverflow.com/questions/858282/spurious-readiness-notification-for-select-system-call)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-26T22:52:01.593

我知道一个流行的桌面操作中的错误，其中`O_NONBLOCK`TCP 套接字，特别是那些在环回接口上运行的套接字，有时可以在报告套接字已准备好读取`EAGAIN`后`recv()`返回。`select()`就我而言，这发生在另一方半关闭发送流之后。

`t_nx.ml`有关更多详细信息，请参阅我的 OCaml 网络应用程序环境分发的 NX 库中的源代码。（[链接](http://sourceforge.net/project/showfiles.php?group_id=118173&package_id=278919)）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T11:40:36.457

虽然我的应用程序是单线程的，但我注意到所描述的行为在 RHEL5 中并不少见。使用设置为 O_NONBLOCK（唯一设置的套接字选项）的 TCP 和 UDP 套接字。select() 报告套接字已准备好，但随后的 recv() 返回 EAGAIN。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-02-21T01:54:18.400

是的，这是真的。这是发生这种情况的一种方式：

A future modification to the TCP protocol adds the ability for one side to "revoke" information it sent provided it hasn't been received yet by the other side's application layer. This feature is negotiated on the connection. The other side sends you some data, you get a `select` hit. Before you can call `recv`, the other side "revokes" the data using this new extension. Your `read` gets a "would block" error because no data is available to be read.

The `select` function is a status-reporting function that does not come with future guarantees. Assuming that a hit on `select` now assures that a subsequent operation won't block is as invalid as using any other status-reporting function this way. It's as bad as using `access` to try to ensure a subsequent operation won't fail due to incorrect permissions or using `statfs` to try to ensure a subsequent write won't fail due to a full disk.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-26T16:33:02.980

在两个线程从套接字读取的多线程环境中是可能的。这是一个多线程应用程序吗？

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-05-26T17:46:48.633

如果您没有在此套接字上的 select() 和 recv() 之间调用任何其他系统调用，那么 recv() 将永远不会返回 EAGAIN 或 EWOULDBLOCK。

我不知道recv-timeout 是什么意思，但是，POSIX 标准在这里没有提到它，所以你可以安全地调用recv()。

# c# - 自定义gridview - 使用非静态函数绑定

> ID：911569
> 
> 赞同：0
> 
> 时间：2009-05-26T16:26:49.560
> 
> 标签：c#, asp.net, data-binding

我目前正在尝试实现一个自定义 gridview 界面来显示从 ObjectDataSource 前端到 ASP.net 成员资格的数据。gridview 的 asp.net 代码是

```
 <asp:GridView
            id="grdUsers"
            HeaderStyle-cssclass="grid_header"
            RowStyle-cssclass="row"
            AlternatingRowStyle-cssclass="alternating"
            OnRowUpdating="grdUsers_RowUpdating"
            OnRowDeleting="grdUsers_RowDeleting"
            OnRowCancelingEdit="grdUsers_cancelEdit"
            datasourceid="srcUsers"
            autogeneratecolumns="false"
            allowsorting="true"
            AllowPaging="true"
            EmptyDataText="No users..."
            pagesize="9"
            runat="server">
            <Columns>
                <asp:CommandField
                    HeaderText="Ops"
                    ButtonType="Image"
                    ShowEditButton="true"
                    EditText="E"
                    UpdateText="U"
                    ShowCancelButton="true"
                    CancelText="X"
                    ShowDeleteButton="true"
                    DeleteText="D" />
                <asp:BoundField
                    ReadOnly="true"
                    DataField="UserName"
                    HeaderText="UserName" />
                <asp:BoundField
                    DataField="Email"
                    HeaderText="Contact Email" />
                <asp:TemplateField
                    HeaderText="Role">
                    <ItemTemplate>
                    <asp:Label 
                        ID="lblRole"
                        text="<%# namespace.Admin.getRoleOfUser( ) %>" 
                        runat="server" />
                    </ItemTemplate>
                    </asp:TemplateField>
                <asp:CheckBoxField
                    DataField="IsApproved"
                    HeaderText="User is Approved" />
                <asp:TemplateField 
                    HeaderText="UserLocked">
                    <ItemTemplate>
                    <asp:CheckBox 
                        id="grdUsers_lockCheckBox"
                        Checked='<%# Eval("IsLockedOut") %>'
                        Enabled="false"
                        runat="server" />
                    </ItemTemplate>
                    <EditItemTemplate>
                    <asp:Button 
                        id="grdUsers_unlockUser"
                        OnClick="grdUsers_unlockUser"
                        Text="Unlock"
                        runat="server" />
                    <asp:HyperLink 
                        id="grdUsers_lockInfo"
                        text="?"
                        onclick='popup("lock_info.html")'
                        runat="server" /> 
                    </EditItemTemplate>
                </asp:TemplateField>
            </Columns>
            </asp:GridView> 
```

我的代码目前正在死去，因为函数 get roleOfUser() 是一个公共函数。最好我想将用户名的字符串（从 GridView 的第二个单元格中拉出）传递给这个函数，但我不确定，以及如何调用这个非静态函数，因为我不知道如何从 asp.net 代码实例化它。

```
 public string getRoleOfUser( )
    {
        GridView users = (GridView)admin.FindControlRecursive(Page, "grdUsers");
        Int32 i = users.EditIndex;

        GridViewRow userRow = users.Rows[i];

        return userRow.Cells[1].Text;
    }

    private Control FindControlRecursive(Control root, string id)
    {
        if (root.ID == id)
        {
            return root;
        }

        foreach (Control c in root.Controls)
        {
            Control t = FindControlRecursive(c, id);
            if (t != null)
            {
                return t;
            }
        }

        return null;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T16:41:37.563

它应该只是：

```
<% getRoleOfUser( ) %> 
```

假设它是 GridView 所在页面的成员函数。

# c# - Settings.Designer 文件和静态

> ID：911573
> 
> 赞同：1
> 
> 时间：2009-05-26T16:27:34.613
> 
> 标签：c#, winforms, settings, data-access-layer

我有一个 DAL 类库，它作为 DLL 包含在我的程序中。下面的行来自 DAL，用于初始化连接。

```
DataSet ds = new DataSet("table");
        SqlConnection cnn = new SqlConnection(Settings.CMOSQLConn); 
```

当我运行它时，我收到以下错误：

```
An unhandled exception of type 'System.StackOverflowException' occurred in CMO.DAL.dll 
```

以下位于 Settings.Designer.cs 文件中，它在*get 调用*中显示错误：

```
 [global::System.Configuration.ApplicationScopedSettingAttribute()]
    [global::System.Diagnostics.DebuggerNonUserCodeAttribute()]
    [global::System.Configuration.SpecialSettingAttribute(global::System.Configuration.SpecialSetting.ConnectionString)]
    [global::System.Configuration.DefaultSettingValueAttribute("Data Source=WWCSTAGE;Initial Catalog=CMO;Persist Security Info=True;User ID=CMOWe" +
        "bService;Password=ecivreSbeWOMC")]
    public static string CMOSQLConn {
        get {
            return (CMOSQLConn);
        }
    } 
```

有人对要寻找什么有任何想法吗？是因为连接字符串存储在dll而不是我的主应用程序中吗？我真的坚持这一点，将不胜感激任何帮助！

## 编辑 1

我在下面尝试了***Greg 的***建议：

```
 public static string CMOSQLConn {
        get {
            return (Settings.CMOSQLConn);
        }
    } 
```

而且我仍然遇到同样的错误......还有什么想法吗？到目前为止感谢！

## 编辑 2

所以我遵循了重新生成下面的设置文件的建议，现在我的设置文件看起来像这样-->

```
public string CMOSQLConn {
        get {
            return ((string)(this["CMOSQLConn"]));
        }
    } 
```

不幸的是，这不会像我有这个语句的地方那样编译 -->

```
 SqlConnection cnn = new SqlConnection(Settings.CMOSQLConn); 
```

我现在收到此错误-->

```
Error   1   An object reference is required for the non-static field, method, or property 'CMO.DAL.Properties.Settings.CMOSQLConn.get'  B:\MyDocs\tmpPATRIOT\Projects\VS2008\DisConnectDAL\CMO.DAL\SupportWorker.cs 13  51  CMO.DAL 
```

这是我应该期待的吗？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-26T16:28:59.120

这是一个经典的 c# 属性错误。仔细检查您归还的财产 - 您归还财产本身！名称解析将优先选择本地名称而不是外部名称。你得到一个堆栈溢出，因为你在`CMOSQLConn.get`调用时遇到了无限递归`CMOSQLConn.get`。

考虑退货`Settings.CMOSQLConn`。额外的规范应该清楚地指出连接字符串的正确位置。

**编辑：**

哎呀！我没有注意到您是从设置设计器文件中粘贴的。无限递归显然正在发生，但恐怕您必须进行更多调查才能找出在这种情况下发生这种情况的原因。

看来您的设计器文件生成不正确（！！！）。在 VS2008 上，我的设置设计器吸气剂看起来像：

```
public bool Foo{
    get {
        return ((bool)(this["Foo"]));
    }
    // ...
} 
```

您可能需要做类似的事情。IE：

```
public string CMOSQLConn
    get {
        return ((string)(this["CMOSQLConn"]));
    }
    // ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T16:55:22.247

尝试将您的代码更改为：

```
 public static string CMOSQLConn {
        get {
            return ((string)(this["CMOSQLConn"]));
        }
    } 
```

嗯..评论中的好点。我只是查看了我的 VS 设置文件，然后不假思索地复制和粘贴。您的设置文件有问题......它不应该为设置创建静态属性。

# c# - 在没有 IIS 的情况下将 SSL 与 .net 远程端点一起使用

> ID：911585
> 
> 赞同：1
> 
> 时间：2009-05-26T16:31:09.847
> 
> 标签：c#, .net, ssl, remoting

我已经设置了一个 vanilla .net 远程端点。它位于处理 SSL 流量的负载平衡器后面，因此所有服务器端端点看到的都是普通的旧 TCP 流量。需要设置客户端配置以通过 SSL 连接到负载均衡器。

本练习的重点是从技术堆栈中删除 IIS。

客户端配置应该是什么？或者这甚至可能吗？

# javascript - 在 Vimperator 插件中模拟鼠标悬停

> ID：911586
> 
> 赞同：24
> 
> 时间：2009-05-26T16:31:10.847
> 
> 标签：javascript, dom-events, mouseover, vimperator

我正在尝试编写一个 Vimperator 插件以允许使用提示模式来模拟下拉菜单上的鼠标悬停。我有提示模式工作，可以正确选择`mouseover`附加事件的元素。问题是我模拟鼠标悬停的功能不起作用。这是我目前拥有的：

```
function SimulateMouseOver(elem)
{
    var evt = elem.ownerDocument.createEvent('MouseEvents');
    evt.initMouseEvent('mouseover',true,true,
        elem.ownerDocument.defaultView,0,0,0,0,0,
        false,false,false,false,0,null);
    var canceled = !elem.dispatchEvent(evt);
    if(canceled)
        alert('Event Cancelled');
} 
```

上面的代码适用于某些页面，但不适用于其他页面。例如，它不适用于 AccuWeather。任何想法如何模拟鼠标悬停适用于大多数页面？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-28T03:55:17.457

这是一些用于创建事件的代码，更简单并且适用于更多浏览器（如果您不需要指定精确的鼠标坐标）

```
 if( document.createEvent ) {
            var evObj = document.createEvent('MouseEvents');
            evObj.initEvent( 'mouseover', true, false );
            elem.dispatchEvent(evObj);
        } else if( document.createEventObject ) {
            elem.fireEvent('onmouseover');
        } 
```

希望有帮助

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-05-27T23:19:57.513

如果有人遇到这种情况，正在寻找一种与**框架无关**的方式来触发任何 HTML 和鼠标事件（并在需要时设置一些选项），请看这里：[如何使用 JavaScript 模拟鼠标点击？](https://stackoverflow.com/questions/6157929/how-to-simulate-mouse-click-using-javascript/6158050#6158050)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T16:35:36.173

您只能在绑定了 mouseover 事件的字段/元素上触发 mouseover 事件。你不能只是劫持鼠标。

# mysql - iconv 给出带有智能引号的“非法字符”——如何摆脱它们？

> ID：911587
> 
> 赞同：7
> 
> 时间：2009-05-26T16:31:23.327
> 
> 标签：mysql, utf-8, iso-8859-1, iconv, smart-quotes

我有一个 MySQL 表，其中 120,000 行以 UTF-8 格式存储。有一个字段，产品名称，其中包含带有许多重音符号的文本。在将第二个字段转换为对 url 友好的表单 (ASCII) 后，我需要用相同的名称填充第二个字段。

由于 PHP 不直接处理 UTF-8，我正在使用：

```
$value = iconv ('UTF-8', 'ISO-8859-1', $value);

```

将名称转换为 ISO-8859-1，然后是一个庞大的 strstr 语句，将任何重音字符替换为其非重音等效字符（例如，à 变为 a）。

但是，原始文本名称是用智能引号输入的，并且 iconv 遇到一个就会窒息——我得到：

```
未知错误类型：[8]

iconv() [function.iconv]：在输入字符串中检测到非法字符

```

为了在使用 iconv 之前摆脱智能引号，我尝试使用三个语句，例如：

```
$value = str_replace('â€™', "'", $value);

```

（â€™ 是 UTF-8 智能单引号的原始值）

因为文本文件太长，这些 str_replace 会导致脚本每次都超时。

1.  在运行 iconv 之前，从 UTF-8 字符串中去除智能引号（或任何无效字符）的最快方法是什么？

2.  或者，是否有更简单的解决方案来解决整个问题？将 UTF-8 中具有多种重音符号的名称转换为 ASCII 中没有重音符号且拼写正确的名称的最快方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-28T17:32:42.067

[Glibc](http://www.gnu.org/software/libc/)（和 GNU [libiconv](http://www.gnu.org/software/libiconv/)）[支持](http://www.gnu.org/software/libiconv/documentation/libiconv/iconv_open.3.html) `//TRANSLIT`和`//IGNORE`后缀。

因此，在 Linux 上，这工作得很好：

```
$ 回声 $'\xe2\x80\x99'
'
$ 回声 $'\xe2\x80\x99' | iconv -futf8 -tiso8859-1
iconv：位置 0 处的非法输入序列
$ 回声 $'\xe2\x80\x99' | iconv -futf8 -tiso8859-1//translit
'

```

我不确定`iconv`PHP 使用的是什么，但文档暗示了这一点，`//TRANSLIT`并且`//IGNORE`也将在那里工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T17:55:00.270

“链接友好”是什么意思？唯一对我有意义的方法，因为`<a>...</a>`标签之间的文本可以是任何东西，实际上是“URL友好的”，类似于 SO 的 URL，其中所有内容都转换为`[a-z-]`.

如果这就是您想要的，您将需要一个音译库，而不是字符集转换库。（过去我没有运气让 iconv() 完成这项工作，但我有一段时间没有尝试过。）有一个 beta PHP 扩展[translit](http://pecl.php.net/package/translit)可能[可以完成这项工作](http://derickrethans.nl/translit.php)。

如果你不能为你的 PHP 安装添加扩展，你将不得不寻找一个 PHP 库来做同样的事情。我没有使用它，但是[PHP UTF-8](http://sourceforge.net/projects/phputf8)库实现了一个[`utf8_to_ascii`](http://sourceforge.net/project/showfiles.php?group_id=142846&package_id=182244)库，我认为它可以满足您的需求。

（另外，如果 iconv() 像你说的那样失败，这意味着你的输入实际上不是有效的 UTF-8，所以用其他任何东西替换有效的 UTF-8 都不会解决这个问题。编辑：我可能会接受返回：如果[ehemient 的答案](https://stackoverflow.com/questions/911587/iconv-gives-illegal-character-with-smart-quotes-how-to-get-rid-of-them/922185#922185)是正确的，那么您看到的 iconv 错误很可能是因为目标字符集中没有直接表示该字符。所以，没关系。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T01:54:48.947

您是否考虑过使用 MySQL 的`REPLACE`字符串函数将有问题的字符串更改为撇号或其他？您也许可以将“要替换的字符串”部分放在一起，例如通过使用`CONCAT`通话`CHAR`...

# networking - 为什么 TCP 标头同时包含 ACK 和 SEQ 字段？

> ID：911589
> 
> 赞同：3
> 
> 时间：2009-05-26T16:32:00.033
> 
> 标签：networking, tcp, header

既然 TCP header 是一个比较大的开销，那我们为什么不把它压缩成 ACK 和 SEQ 共享同一个字段，并且仍然可以通过 header 中的标志来区分呢？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-26T16:35:57.497

因为它们不是专门使用的。下面是最重要的：连接协商，即三向握手：

[![三向握手](https://i.stack.imgur.com/Kz8qI.png)](https://i.stack.imgur.com/Kz8qI.png)
[（来源：[wikimedia.org](http://upload.wikimedia.org/wikipedia/commons/c/c7/300px-Tcp-handshake.png)）]

图片来自维基共享资源。它展示了如何协商 TCP 连接，并显示 ACK 和 SEQ 在同一个标​​头中一起使用以建立连接（我写这篇文章是为了确保即使图片有一天会消失，答案也会有所帮助）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-26T16:35:14.753

因为连接是全双工的 - 一个序列数据包到对等方，另一个确认来自对等方的数据包。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T16:35:08.483

因为它们可以同时出现在标题中。一个是用于标记正在发送的数据，另一个是发送方在下一个数据包中所期望的。有关更多信息，请参阅[维基百科](http://en.wikipedia.org/wiki/Transmission_Control_Protocol#TCP_segment_structure)。

# hibernate - 无法使用 Hibernate 3.3.1GA 进行多对多工作

> ID：911602
> 
> 赞同：2
> 
> 时间：2009-05-26T16:35:00.213
> 
> 标签：hibernate, many-to-many

我有一个简单的多对多映射：

```
@Entity
@Table(name="ITEM")
public static class Item
{
    @Id
    @GeneratedValue
    long id;
    @Column
    String name;
    @ManyToMany(cascade={ CascadeType.ALL })
    Set<Category> categories = new HashSet<Category> ();
}

@Entity
@Table(name="CATEGORY")
public static class Category
{
    @Id
    @GeneratedValue
    long id;
    @Column
    String name;
} 
```

而这个测试用例：

```
public void testPersist() throws Throwable
{
    Category one = new Category ();
    one.name = "one";
    em.persist (one);
    System.out.println ("one.id="+one.id);

    Category two = new Category ();
    two.name = "two";
    em.persist (two);
    System.out.println ("two.id="+two.id);

    Item item = new Item ();
    item.name = "item";
    item.categories.add (one);
    item.categories.add (two);
    em.persist (item);
    long id = item.id;
    System.out.println ("item.id="+item.id);
    System.out.println ("item.categories="+item.categories);

    em.clear ();

    item = em.find (Item.class, id);
    System.out.println ("item.categories="+item.categories);
    assertEquals (item.categories.toString (), 2, item.categories.size ());
} 
```

测试失败。在日志中，我可以看到：

```
SchemaUpdate - create table CATEGORY (id bigint generated by default as identity (start with 1), name varchar(255), primary key (id))
SchemaUpdate - create table ITEM (id bigint generated by default as identity (start with 1), name varchar(255), primary key (id))
SchemaUpdate - create table ITEM_CATEGORY (ITEM_id bigint not null, categories_id bigint not null, primary key (ITEM_id, categories_id))
SchemaUpdate - alter table ITEM_CATEGORY add constraint FK5C7030AA7C924DF7 foreign key (categories_id) references CATEGORY
SchemaUpdate - alter table ITEM_CATEGORY add constraint FK5C7030AA66304535 foreign key (ITEM_id) references ITEM 
```

所以创建了正确的表，双主键没问题，外键是正确的。

坚持`item`不做正确的事情：

```
[DEBUG] org.hibernate.SQL - insert into CATEGORY (id, name) values (null, ?)
[TRACE] org.hibernate.type.StringType - binding 'one' to parameter: 1
[DEBUG] org.hibernate.SQL - call identity()
one.id=1
[DEBUG] org.hibernate.SQL - insert into CATEGORY (id, name) values (null, ?)
[TRACE] org.hibernate.type.StringType - binding 'two' to parameter: 1
[DEBUG] org.hibernate.SQL - call identity()
two.id=2
[DEBUG] org.hibernate.SQL - insert into ITEM (id, name) values (null, ?)
[TRACE] org.hibernate.type.StringType - binding 'item' to parameter: 1
[DEBUG] org.hibernate.SQL - call identity()
item.id=1
item.categories=[ch.globus.bonus.ManyToManyTest$Category@1d532ae, ch.globus.bonus.ManyToManyTest$Category@42a6eb] 
```

如您所见，项目本身是持久化的，但不是包含类别的集合（连接表中的插入丢失）。但是集合中有值！

当它*读取*项目时，它会查询连接表：

```
[DEBUG] org.hibernate.SQL - select manytomany0_.id as id9_0_, manytomany0_.name as name9_0_ from ITEM manytomany0_ where manytomany0_.id=?
[TRACE] org.hibernate.type.LongType - binding '1' to parameter: 1
[TRACE] org.hibernate.type.StringType - returning 'item' as column: name9_0_
[DEBUG] org.hibernate.SQL - select categories0_.ITEM_id as ITEM1_1_, categories0_.categories_id as categories2_1_, manytomany1_.id as id10_0_, manytomany1_.name as name10_0_ from ITEM_CATEGORY categories0_ left outer join CATEGORY manytomany1_ on categories0_.categories_id=manytomany1_.id where categories0_.ITEM_id=?
[TRACE] org.hibernate.type.LongType - binding '1' to parameter: 1
item.categories=[] 
```

但当然，它什么也找不到。怎么了？为什么休眠考虑连接表`find()`而不考虑连接表`persist()`？

我正在使用 Hibernate 3.3.1，Hibernate Annotations 3.4.0

[编辑] 为了解决这个问题，我尝试引入双向映射。首先，我将此代码添加到`Category`：

```
 /* BEGIN FIX1: made join bidrectional */
    @ManyToMany(cascade={ CascadeType.ALL })
    Set<Item> items = new HashSet<Item> ();
    /* END FIX1: made join bidrectional */ 
```

然后，我更改了测试以更新双方：

```
 item.categories.add (two);
    /* BEGIN FIX1: made join bidrectional */
    one.items.add (item);
    two.items.add (item);
    /* END FIX1: made join bidrectional */
    em.persist (item);
    /* BEGIN FIX1: made join bidrectional */
    em.persist (one);
    em.persist (two);
    /* END FIX1: made join bidrectional */ 
```

我什至再次坚持分类。结果：什么都没有。Hibernate 很高兴地忽略了多对多映射。

作为第二个修复，我尝试按照`@JoinTable`zoidbeck 的建议添加注释：

```
 @ManyToMany(cascade={ CascadeType.ALL })
    /* BEGIN FIX2: Added JoinTable */
    @JoinTable(name = "ITEM_CATEGORY",
            joinColumns={@JoinColumn(name="itm_id")},
            inverseJoinColumns={@JoinColumn(name="cat_id")}
    )
    /* END FIX2: Added JoinTable */
    Set<Category> categories = new HashSet<Category> (); 
```

再次，什么都没有。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T07:59:07.993

原因是 Hibernate 中的优化：测试从不刷新会话。所以所发生的一切是 Hibernate 记住了它需要在其内部缓存中进行的更改，但由于事务从未提交，它永远看不到生成 SQL 来更新连接表的理由。

但是为什么我会看到该项目的插入呢？因为 Hibernate 需要它的 ID 来进行连接。所以它必须询问数据库“这个对象会得到什么ID？”。

解决方案是强制 Hibernate 刷新其缓存：

```
 Session session = (Session)em.getDelegate ();
    session.flush (); 
```

这是完整的工作测试用例：

```
@Entity
@Table(name="ITEM")
public static class Item
{
    @Id
    @GeneratedValue
    long id;
    @Column
    String name;
    @ManyToMany(cascade={ CascadeType.ALL })
    Set<Category> categories = new HashSet<Category> ();
}

@Entity
@Table(name="CATEGORY")
public static class Category
{
    @Id
    @GeneratedValue
    long id;
    @Column
    String name;
}

public void testPersist() throws Throwable
{
    final Item item = prepareDB ();

    long id = item.id;
    assertTrue ("ID: "+id, id > 0);

    // Clear cache to make sure the objects are loaded again from DB
    em.clear ();

    Item item2 = em.find (Item.class, id);
    assertEquals (item2.categories.toString (), 2, item2.categories.size ());

    delete (item2);

    item2 = em.find (Item.class, id);
    assertNull (item2);
}

public void flush ()
{
    Session session = (Session)em.getDelegate ();
    session.flush ();
}

@Transactional
public void delete (Item item2)
{
    em.remove (item2);
    // Force delete
    flush ();
}

@Transactional
public Item prepareDB ()
{
    final Category one = new Category ();
    one.name = "one";
    em.persist (one);
    System.out.println ("one.id="+one.id);

    final Category two = new Category ();
    two.name = "two";
    em.persist (two);
    System.out.println ("two.id="+two.id);

    final Item item = new Item ();
    item.name = "item";
    item.categories.add (one);
    item.categories.add (two);
    em.persist (item);

    // Force update of join table
    flush ();

    return item;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T22:04:14.543

据我所知，您必须完全指定链接表：

```
@Entity
@Table(name="ITEM")
public static class Item
{
    @Id
    @GeneratedValue
    long id;

    @Column
    String name;

    @ManyToMany(cascade={ CascadeType.ALL })
    @JoinTable(name = "ITEM_CATEGORY",
      joinColumns = { @JoinColumn(name="item_id") },
      inverseJoinColumns = { @JoinColumn(name="categories_id")}
    Set<Category> categories = new HashSet<Category> ();
} 
```

我不确定是否需要以双向方式指定 ManyToMany，但如果是这样，这将是另一方的映射：

```
@ManyToMany(mappedBy="categories")  // map info is in item class
private Set<Item> items; 
```

# .net - 我在哪里可以找到好的 .NET PDF 库？

> ID：911611
> 
> 赞同：6
> 
> 时间：2009-05-26T16:37:09.820
> 
> 标签：.net, pdf

我们正在将一个包含活动报表和水晶报表的 winforms 应用程序联网。一切都会以某种方式转换为 PDF。那里有很多工具。有人对我们可以使用的工具有经验/建议吗？

SQL 报告是一种可能性，但我想探索其他选项，而不是仅仅采用最初看起来很简单的方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-26T16:40:06.647

你看过 iTextSharp 吗？

[http://itextsharp.sourceforge.net/](http://itextsharp.sourceforge.net/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T16:40:59.797

我使用过[http://www.websupergoo.com/abcpdf-1.htm](http://www.websupergoo.com/abcpdf-1.htm)，它对我来说非常有效。您可以添加图像和所有内容。我正在使用它，我将 XML 和 XSLT 作为模板，传入转换（XSLT 转换为 HTML），PDF 生成器将正确生成我的页面。

是的，该组件是有成本的，但我发现有时候支付少量成本然后花费数小时试图让其他东西工作是值得的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T16:57:40.170

动态PDF

[http://www.cete.com/Products/GeneratorForNET/](http://www.cete.com/Products/GeneratorForNET/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T20:42:11.603

我不确定您是在寻找创建 PDF 文件的组件，还是在尝试将当前报告格式迁移到可以将数据下载为 PDF 文件的 ASP.NET 站点。对于前者，我推荐 iTextSharp。对于后者，我推荐 Devexpress XtraReports。请注意，XtraReports 支持直接导出为 PDF 格式。

[http://www.devexpress.com/Products/NET/Reporting/](http://www.devexpress.com/Products/NET/Reporting/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-26T18:18:44.543

我对[PDFsharp](http://www.pdfsharp.net/PDFsharp/)有很好的体验。它的级别相当低，并提供了一种在文档上绘制文本、图像等的熟悉方式。这是一些[示例代码](http://www.pdfsharp.net/PDFsharp/index.php?option=com_content&task=view&id=15&Itemid=29)。

它可以免费用于个人和商业项目。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-26T17:12:28.157

我不确定这是否是您要查找的内容，但 Crystal 报表可以将报表直接导出为 PDF，因此您可以直接在服务器上以 PDF 格式生成报表并将该 PDF 返回给用户。

如果您正在寻找一个允许您直接生成 PDF 文件的工具，那么就像一些同事评论的那样，一个不错的选择是 iTextSharp。使用 iTextSharp，您可以以编程方式从头开始或从 XML 文件生成 PDF 文档。

一些有用的链接：
[iTextSharp on Sourceforge](http://itextsharp.sourceforge.net/)
[ITextSharp section on iT3XT.com](http://www.1t3xt.com/products/itextsharp.php)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-26T16:40:34.617

我对 iText for Java 有一点经验，这似乎是一个被广泛接受的解决方案；有一个名为[iTextSharp的 .NET 版本](http://itextsharp.sourceforge.net/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-26T16:41:26.567

如果您只需要将报告转换为 PDF，VisualStudio 报告生成器将立即为您完成。否则我第二个 iTextSharp。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-26T17:50:21.373

[Doxygen](http://www.doxygen.nl/)几乎适用于任何事情。我将它用于我所有的 .NET 项目。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-05-26T16:51:48.323

我使用了[Expert PDF Converter](http://www.html-to-pdf.net/)，它可以让我从 HTML 创建 PDF。我基本上呈现一个 aspx 页面并将输出发送到将其转换为 pdf 的组件。很高兴我可以为用户打印所见即所得的体验。它并不完美，但对于 500 美元来说，它物有所值。

# testing - 用户故事编码

> ID：911619
> 
> 赞同：8
> 
> 时间：2009-05-26T16:39:54.667
> 
> 标签：testing, process, agile

假设我有一堆用户故事（由于我与团队一起进行的计划会议）。我的应用程序中还没有任何代码，我将从我的“A”或最高优先级故事/史诗开始

比如说

“*作为用户，我应该能够搜索更多用户，以便我可以在网站上添加更多朋友*”

那么团队应该如何在进行 TDD 时对应用程序进行编码。

*   团队从创建单元测试开始，即 .that 负责创建模型

*   然后每个人都讲一个故事并开始编写功能测试来创建我的控制器/视图（所以他们是否应该在编写功能测试时进行集成测试）

*   然后进行集成测试

我实际上很困惑集成测试如何适应。如果所有集成测试都有效（即所有功能性单元测试无论如何都应该通过）

因此，如果应用程序刚刚启动（即尚未编写代码）。当人们拿起一个故事并开始从头开始实施应用程序时，他们通常为 TDD/BDD 采取的过程是什么

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-26T17:03:07.177

非常好的问题！TDD/BDD 方式建议您获取用户故事并编写验证点（阅读高级测试）。他们使用 GWT (Given/When/Then) 说话如下。

“作为用户，我应该能够搜索更多用户，以便我可以在网站上添加更多朋友”

```
given the website URL
when the site loads
then a search field should be visible/accessible. 
```

这是您的第一条反馈，也是与产品负责人进行迭代的第一次机会。问一些问题，比如搜索栏应该去哪里？它应该自动完成吗？等等。接下来，您将“行为”分配给 UI 对象。这些也有验证点。

这将定义搜索按钮的行为：

```
given a go button next to the search field
when then button is clicked 
then a search should be performed 
```

这将描述您的搜索逻辑：

```
given a search term "John" and a user set including "John, Joan, Jim, Steve"
when a search is performed
then the results should contain "John" an "Joan" 
```

第一个验证点将描述将控制器搜索按钮链接到实现搜索算法的任意模型的行为。第二个验证点描述了搜索算法本身。优点是这些部分是独立定义的，可以并行设计。它还为您提供了一个不错的 API，并且可以轻松规划要迭代的功能。它还使您能够在不影响其余部分的情况下对拼图的任何部分进行迭代/改进。

*更新*我还想提一下，我所说的验证点可以松散地与 UAT 或用户验收测试相关联。不要挂断这些条款，因为它们无关紧要。专注于他们背后的想法。您需要将用户故事分解为规格。（可以使用 UAT 或验证点或两者或魔豆在一次或多次通过中完成，只要确保将它们分解即可。）如果您将用户故事分解成的内容可以用 FitNesse、JUnit 或然后，RSpec 使用其中一种工具，否则您需要进一步的对话（您的用户故事是否过于模糊？）或另一种传递您必须进一步分解的内容（UAT 到验证点）。不要沉迷于这些工具，并觉得你需要从一开始就自动化一切。在您完成手动过程之前，请不要理会 Selenium。最终，您希望规范可以以类似编程测试的形式编写，此时您应该能够使用像 JUnit 这样简单的东西来开始编码。当您变得更好/更高级时，您可以选择 EasyB 或 RSpec story runner 和其他东西。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-26T16:52:03.503

这是我们通常从 Sprint 0 开始的地方，在今年春天，我们将有 XP 所称的 Spike Session（或 Throw away code 会议）。在本次会议中，您可以开始原型设计。

在您的会话中编写一些用户验收测试（最好采用 BDD 格式），然后首先开始编写测试以匹配您的 UAT 之一。

例如：

假设在用户名为“testUser”的地方请求搜索，应返回 1 个结果。

有了这个，您现在有了您编写的第一个测试的目标，然后开始编写代码以使该测试通过。随着您继续前进，您应该开始了解应如何将应用程序组合在一起以完成故事。

然后，我将在下一个 sprint 构建故事/任务中开始，根据您在 sprint 0 中发现的内容根据需要完成该功能。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T16:49:39.107

首先，拆开故事。你需要：

1.  一个用户对象：它有什么作用？创建一些测试来解决这个问题并编写代码
2.  一种搜索用户的方法；也许是 SearchUserService？再次创建测试并编写代码
3.  一种连接用户的方式...

现在，你有了模型。接下来，您对控制器执行相同的操作。当它们工作时，您从视图开始。

或者，当您是专业人士并且已经这样做了一千次时，您也许可以一次滚动几个步骤。

但你必须首先将问题分解成可消化的部分。

接下来是集成测试。他们将模拟用户所做的事情。在一般情况下，您需要编写一组单元测试（它们只是称为集成测试，但您也应该能够自动运行它们）。这些测试需要像用户一样与网络应用程序对话，所以你需要一个模拟的网络浏览器等。

您可以为此尝试[httpunit](http://httpunit.sourceforge.net/)或[env.js。](http://groups.google.com/group/envjs)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-26T18:09:01.867

如果您正在执行 TDD，您首先要进行一个测试，该测试表明*系统*没有执行用户故事所描述的所需行为。当它以您期望的方式失败时，通过有用的诊断，您然后开始通过添加或修改类来实现该行为，首先进行单元测试。

因此，在 TDD 中，您在编写单元测试之前编写集成测试。

为了引导整个过程，人们通常会编写一个“行走的骨架”：一个执行最薄的现实功能切片的系统。步行骨架让我们针对简单的功能构建集成测试基础架构。

然后项目的其余部分充实了这个骨架。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-27T15:00:37.130

> “我实际上很困惑集成测试如何适应。如果所有集成测试都有效（即所有功能，单元测试无论如何都应该通过）”

这取决于。当然，可以以所有单元和功能测试都通过的方式编写集成测试。只是要困难得多。

假设您有 3 个模型、3 个控制器和 3 个视图。想象一下，所有这些都非常简单，没有条件或循环，并且每个都有一个方法。

您现在可以（单元）测试其中的每一个，总共 9 个断言并具有完整的覆盖率。您可以进行集成测试以确保所有这些东西都能很好地协同工作。

相反，如果您跳过单元/功能并需要完全覆盖，您将需要 27 个断言 (3 x 3 x 3)。

在实践中，事情当然更复杂。您需要大量的集成测试才能达到相同的覆盖率。

此外，如果您练习 TDD/BDD，则通常最终会进行大量单元测试。集成测试是为了确保所有这些部分很好地结合在一起，并按照客户的要求进行操作。这些部件本身已通过单元测试单独测试。

# asp.net - ASP.net SMTP 连接错误

> ID：911623
> 
> 赞同：1
> 
> 时间：2009-05-26T16:40:36.770
> 
> 标签：asp.net, smtp

下面的代码让我一个接一个地排除错误。

```
 MailMessage Enveloppe = new MailMessage();

        //emails is an array of strings
        foreach ( string email in emails )
            Enveloppe.To.Add(email);

        //Setup message parameters
        Enveloppe.Subject = "Documentation";
        Enveloppe.Body = "Infinitelycoolbodyhere"
        Enveloppe.From = new MailAddress("mrzombie@stuff", "Myname");

        //files is an array of strings
        foreach ( string filename in files ) { 
            //Add attachments
            Enveloppe.Attachments.Add(new Attachment(new System.Net.WebClient().OpenRead(filename),filename.Substring(filename.LastIndexOf('/'))));
        }

        //Create the smtp client, and let it do its job
        SmtpClient Mailman = new SmtpClient("mysmtphost");
        Mailman.EnableSsl = true;
        Mailman.Port = 465;
        Mailman.DeliveryMethod = SmtpDeliveryMethod.Network;
        Mailman.Credentials = new System.Net.NetworkCredential("usernamehere", "passwordhere");
        Mailman.Send(Enveloppe); 
```

碰巧它要么告诉我我的操作超时，要么告诉我“连接尝试失败，因为连接方在一段时间后没有正确响应，或者建立连接失败，因为连接的主机没有响应”。

我被难住了，我看不出我做错了哪一部分

更新：我似乎无法从 Telnet 连接到服务器，充其量只能连接到我的笔记本电脑（在 ubuntu 下），但我从未收到“200”响应。在 windows 工作站下，我得到一个永久空白的 telnet 窗口。

我可以使用 Thunderbird 在指定的服务器上发送/接收电子邮件，没有任何问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-08T18:25:45.953

终于找到了罪魁祸首——不知何故，托管公司给我的“假定正确”的 smtp 服务器和实际的 smtp 服务器之间的连接挂了。我刚刚将 mail.domain.com 的地址更改为 smtp.hostingdomain.com 并修复了所有问题。

这只是我讨厌的那些“该死的”时刻之一。正因为如此，我不得不放弃基于应用程序的邮件发送功能，但最后我和我的老板决定我们将文件托管在某个地方并在电子邮件中包含链接而不是附加附件到邮件。

所以，是的，这并不能真正回答问题，但对于那些考虑解决方案的人来说，但您可能希望将要发送的文件放在可从外部访问的位置并包含链接。那里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T16:43:08.543

该 SMTP 服务器是否已在 465 上启动并运行，是否支持 SSL？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T18:54:37.670

尝试与您的 SMTP 服务器进行通信时，听起来好像出了点问题（哈哈，没用！）。

我假设你在 Windows 上，所以转到开始 -> 运行 -> 'telnet mysmtphost 465' 并查看你在控制台中得到的响应。

你看到这样的东西吗？

```
Connected to mysmtphost.
Escape character is '^]'.
220 mysmtphost 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T14:13:36.850

尝试为 System.Net.Mail 启用跟踪（看起来您正在使用 SNM）。为此，您需要将以下内容添加到您的 .config 文件中。

```
<configuration>
  <system.diagnostics>
    <trace autoflush="true" />

    <sources>

      <source name="System.Net" >
        <listeners>
          <add name="MyTraceFile"/>
        </listeners>
      </source>

      <source name="System.Net.Sockets">
        <listeners>
          <add name="MyTraceFile"/>
        </listeners>
      </source>

    </sources>

    <sharedListeners>
      <add
        name="MyTraceFile"
        type="System.Diagnostics.TextWriterTraceListener"
        initializeData="System.Net.trace.log"                />
    </sharedListeners>

    <switches>
      <add name="System.Net" value="Verbose" />
      <add name="System.Net.Sockets" value="Verbose" />
    </switches> 
```

希望这至少应该告诉你发生了什么。

我在这里有更多信息，关于预期： [http ://systemnetmail.com/faq/4.10.aspx](http://systemnetmail.com/faq/4.10.aspx)

# c# - 在 using 块内与在 using 块外捕获异常 - 哪个更好？

> ID：911626
> 
> 赞同：32
> 
> 时间：2009-05-26T16:40:49.703
> 
> 标签：c#, c#-3.0

这两条代码之间有什么区别吗？哪种方法更好。

```
try
{
    using()
    { 
      //Do stuff
    }
}
catch
{
    //Handle exception
}

using()
{
    try
    {
         //Do stuff
    }
    catch
    {
        //Handle exception
    }
} 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-26T16:44:27.230

存在差异，但归结为 using 块创建它自己的 try 和 scope 块这一事实。

```
try
{
    using(IDisposable A = GetDisposable())
    { 
      //Do stuff
    }
}
catch
{
    //Handle exception
    // You do NOT have access to A
}

using(IDisposable A = GetDisposable())  //exception here is uncaught
{
    try
    {
         //Do stuff
    }
    catch
    {
        //Handle exception
        // You DO have access to A
    }
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-26T16:43:21.477

这些块之间存在差异。在第二种情况下，如果在 using() 行中抛出异常（例如实例化 IDisposable 对象并且构造函数抛出异常），则不会捕获异常。哪个更好将取决于您的具体需求。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-26T16:44:18.730

是的。首先，您正在“使用”的资源将在执行 catch 块之前被释放。在以后，它会在之后被处理掉。此外，“foo”语句不在 catch 子句的范围内。“使用”块*几乎*是语法糖，使得

```
using (foo)
{
} 
```

是

```
try
{
  foo;
}
finally
{
  foo.Dispose();
} 
```

没有上下文，哪种行为“更好”并不明显。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-26T18:18:40.100

最终，您可以结合这两种方法来克服这两个*缺点*：

```
IFoo f;
try{
  f = new Foo();
  f.Bar();
catch{
  // Do something exceptional with f
} finally{
  if(f != null) f.Dispose();
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-06-26T01:27:47.140

如上所述，只有第一个方法会在 IDisposable 对象的初始化中捕获异常，并且对象会在 catch 块的范围内。

此外，catch 和 finally 块的操作顺序将根据它们的嵌套而翻转。举个例子：

```
public class MyDisposable : IDisposable
{
    public void Dispose()
    {
        Console.WriteLine("In Dispose");
    }

    public static void MethodOne()
    {
        Console.WriteLine("Method One");
        using (MyDisposable disposable = new MyDisposable())
        {
            try
            {
                throw new Exception();
            }
            catch (Exception ex)
            {
                Console.WriteLine("In catch");
            }
        }
    }

    public static void MethodTwo()
    {
        Console.WriteLine("Method Two");
        try
        {
            using (MyDisposable disposable = new MyDisposable())
            {
                throw new Exception();
            }
        }
        catch (Exception ex)
        {
            Console.WriteLine("In catch");
        }
    }

    public static void Main()
    {
        MethodOne();
        MethodTwo();
    }
} 
```

这将打印：

```
Method One
In catch
In Dispose
Method Two
In Dispose
In catch 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-26T16:44:19.743

我想你的意思是：

```
using (var x = new Y(params))
{
} 
```

在这两种情况下？那么明显的区别是*x*的范围。在第二种情况下，您可以在 catch 子句中访问*x 。*在第一种情况下，你不能。

我还将借此机会提醒您不要“处理”异常，除非您真的可以对此做些什么。这包括记录异常，这没关系，除非您正在操作的环境为您进行记录（如 ASP.NET 2.0 默认情况下所做的那样）。

# c# - LoadComponent() 与。XamlReader.Load()？

> ID：911631
> 
> 赞同：1
> 
> 时间：2009-05-26T16:42:12.960
> 
> 标签：c#, wpf, xaml

[与我之前提出](https://stackoverflow.com/questions/910814/loading-xaml-at-runtime)的一个问题相关，我看到有 LoadComponent() 和 XamlReader.Load()。它们足够相似，以至于我不太确定在什么情况下应该使用哪一个。

那么，从本质上讲，两者之间有什么区别？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T16:48:33.183

**MSDN**：

*   [加载组件](http://msdn.microsoft.com/en-us/library/ms596996.aspx)
*   [XamlReader.Load()](http://msdn.microsoft.com/en-us/library/ms590398.aspx)

**推测**
我猜 LoadComponent 调用`XamlReader.Load()`. LoadComponent 看起来更像一个应用程序级别的服务，并且可能被应用程序本身用来加载所有的 xaml 资源。XamlReader 是您想要的特定库调用。

将其视为 LoadComponent 是一个应用程序服务，其中 XamlReader 是包含该功能的库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-06T11:03:50.680

Application.LoadComponent：应用程序会先将资源预加载为一个'Package'并注册到PreloadedPackage类中，调用LoadComponent方法时，wpf首先检查包是否存在和资源是否存在，然后检查resouse是xaml还是baml，最后加载资源流使用提供的 BaseUri

如果资源是 baml，LoadComponent 将使用 Baml2006Reader，否则使用 XamlReader 处理资源流。

XamlReader.Load 可以在程序集之外加载 xaml 资源。

# inheritance - (SWIG / Lua) 如何访问 swig_lua_class 中的基类/父类列表

> ID：911632
> 
> 赞同：1
> 
> 时间：2009-05-26T16:42:36.253
> 
> 标签：inheritance, types, lua, parent, swig

我注意到在为给定的一组类生成的 SWIG 包装器中，SWIG 保留了该类继承自的所有父类的 C 字符串表示形式的列表。(char ** base_names)。我知道有一个功能

```
swig_type(some_variable) 
```

这将返回给定变量数据类型的字符串表示形式。是否还有一个函数可以将父类的表作为字符串返回？如果没有，有没有简单的方法来编写这个函数？我完全不熟悉 SWIG 的内部运作。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T17:11:32.620

像这样的东西应该可以工作（未经测试，因为我不将 SWIG 与 Lua 一起使用）：

```
// insert into runtime section
// this is the C function that iterates over the base_names array 
// (I'm assuming that the array is terminated with a NULL)
%runtime %{
    /* lua callable function to get the userdata's type */
    SWIGRUNTIME int SWIG_Lua_basenames(lua_State* L)
    {
      swig_lua_userdata* usr;
      swig_lua_class* clss = NULL;
      int i = 0;
      if (lua_isuserdata(L,1))
      {
        usr=(swig_lua_userdata*)lua_touserdata(L,1);  /* get data */
        if (usr && usr->type && usr->type->clientdata) {
          // fetch the swig_lua_class struct, it contains the base_names
          clss = (swig_lua_class*)usr->type->clientdata;
        }
      }
      /* create a new table with all class base names in it
         note that I create it even if clss is NULL, that way
         an empty table -should- be returned
       */          
      lua_newtable(L);
      while(clss && clss->base_names[i]) {
         lua_pushnumber(L, i+1); /* lua tables are 1-indexed */
         lua_pushstring(L, clss->base_names[i]);
         lua_rawset(L, -3);
         i++;
      }
      return 1;
    }
%}
%init %{
  /* this goes into the user init function, register our new function with
     Lua runtime
   */
  SWIG_Lua_add_function(L,"swig_base_names",SWIG_Lua_basenames);
%} 
```

# language-agnostic - 什么是圈复杂度？

> ID：911637
> 
> 赞同：76
> 
> 时间：2009-05-26T16:43:52.083
> 
> 标签：language-agnostic, architecture, cyclomatic-complexity

我不时看到的一个术语是“循环复杂性”。在这里，我看到了一些关于“如何计算语言 X 的 CC”或“我如何用最少的 CC 做 Y”的问题，但我不确定我真的理解它是什么。

在[NDepend 网站](http://www.ndepend.com/Metrics.aspx#CC)上，我看到一个解释，基本上是说“方法中的决策数量。每个 if、for、&& 等都会在 CC“分数”上加 1。真的是这样吗？如果是，为什么是这很糟糕吗？我可以看到人们可能希望将 if 语句的数量保持在相当低的水平，以使代码易于理解，但这真的是一切吗？

还是有更深层次的概念？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2009-05-26T16:46:05.013

我不知道更深层次的概念。我相信它通常是在可维护性索引的背景下考虑的。特定方法中的分支越多，维护该方法操作的心理模型就越困难（通常）。

具有较高圈复杂度的方法也更难以在单元测试中获得完整的代码覆盖率。（感谢[马克 W](https://stackoverflow.com/users/102529/marc-w)！）

当然，这带来了可维护性的所有其他方面。错误/回归/等等的可能性。不过，核心概念非常简单。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2009-05-26T16:49:44.037

圈复杂度衡量您必须执行具有不同参数的代码块以执行通过该块的每条路径的次数。较高的计数是不好的，因为它增加了逻辑错误逃脱测试策略的机会。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2013-07-03T09:27:00.947

```
Cyclocmatic complexity = Number of decision points + 1 
```

决策点可能是您的条件语句，例如 if、if ... else、switch、for 循环、while 循环等。

下表描述了应用程序的类型。

*   圈复杂度为 1 – 10  被视为正常应用

*   圈复杂度位于 11 – 20  中等应用

*   圈复杂度在于 21 – 50  风险应用

*   圈复杂度超过 50  应用不稳定

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-05-26T16:55:12.497

维基百科可能是你的朋友：[圈复杂度的定义](http://en.wikipedia.org/wiki/Cyclomatic_complexity)

基本上，你必须把你的程序想象成一个[控制流图](https://en.wikipedia.org/wiki/Control_flow_graph)，然后

> 复杂性（...）定义为：
> 
> ```
> M = E − N + 2P 
> ```
> 
> 在哪里
> 
> *   M = 圈复杂度，
> *   E = 图的边数
> *   N = 图的节点数
> *   P = 连接组件的数量

CC 是一个试图捕捉你的程序有多复杂以及用一个整数测试它有多难的概念。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-05-26T16:47:50.953

是的，就是这样。您的代码可以采用的执行路径越多，必须测试的东西就越多，出错的可能性就越高。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-05-26T17:05:26.830

我听到的另一个有趣的观点：

代码中缩进最大的地方应该有最高的 CC。这些通常是确保测试覆盖率的最重要领域，因为预计它们将更难阅读/维护。正如其他答案所指出的，这些也是确保覆盖率的更难的代码区域。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-26T16:55:40.437

圈复杂度真的只是一个可怕的流行语。事实上，它是软件开发中用于指出更复杂的代码部分（更可能是错误的，因此必须非常仔细和彻底地测试）的代码复杂性的度量。您可以使用 E-N+2P 公式计算它，但我建议您通过插件自动计算它。我听说过一个经验法则，您应该努力将 CC 保持在 5 以下，以保持代码的良好可读性和可维护性。

我最近刚刚在我的 Java 项目中尝试了[Eclipse Metrics 插件](http://eclipse-metrics.sourceforge.net/)，它有一个非常好的简洁的帮助文件，它当然会与你的常规 Eclipse 帮助集成，你可以阅读更多关于各种复杂性度量和提示和技巧的定义关于改进你的代码。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-26T16:48:10.640

就是这样，这个想法是，具有低 CC 的方法具有更少的分叉、循环等，这些都使方法更加复杂。想象一下，使用分析器查看 500,000 行代码，并看到一些方法的 CC 量级更高。这使您可以专注于重构这些方法以更好地理解（高 CC 具有高错误率也很常见）

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-26T16:51:27.997

例程（循环、开关、if 等）中的每个决策点本质上归结为等效的 if 语句。对于每一个`if`，您都有 2 个可以采用的代码路径。因此，第一个分支有 2 个代码路径，第二个分支有 4 个可能的路径，第三个分支有 8 个，依此类推。至少有 2**N 个代码路径，其中 N 是分支数。

这使得理解代码的行为并在 N 超过某个小数字时对其进行测试变得困难。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-02-10T19:42:20.663

到目前为止提供的答案没有提到软件质量与圈复杂度的相关性。研究表明，具有较低的圈复杂度指标应该有助于开发更高质量的软件。它可以帮助提高可读性、可维护性和可移植性的软件质量属性。一般来说，应该尝试获得 5-10 之间的圈复杂度度量。

使用圈复杂度等指标的原因之一是，一般来说，一个人只能在大脑中同时跟踪大约 7 条（正负 2）条信息。因此，如果您的软件过于复杂且具有多个决策路径，那么您不太可能能够可视化您的软件的行为方式（即，它将具有较高的圈复杂度度量）。这很可能会导致开发错误或漏洞百出的软件。更多信息可以在[这里](http://www.mathworks.com/discovery/cyclomatic-complexity.html)找到，也可以在[Wikipedia](http://One%20of%20the%20reasons%20for%20using%20metrics%20like%20cyclomatic%20complexity%20is%20that%20in%20general%20a%20human%20being%20can%20only%20keep%20track%20of%20about%207%20%28plus%20or%20minus%202%29%20pieces%20of%20information%20simultaneously%20in%20your%20brain.%20%20Therefore,%20if%20your%20software%20is%20overly%20complex%20with%20multiple%20decision%20paths,%20it%20is%20unlikely%20that%20you%20will%20be%20able%20to%20visualize%20how%20your%20software%20will%20behave%20%28i.e.%20it%20will%20have%20a%20high%20cyclomatic%20complexity%20metric%29.%20This%20would%20most%20likely%20lead%20to%20developing%20erroneous%20or%20bug%20ridden%20software.%20%20More%20information%20about%20this%20can%20be%20found%20here%20and%20also%20on%20Wikipedia.)上找到。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2017-06-03T22:58:12.837

使用控制流图计算圈复杂度。通过程序源代码的线性独立路径的数量测量称为循环复杂度（ if/ if else / for / while ）

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-26T16:52:44.623

考虑你的函数的[控制流图](http://en.wikipedia.org/wiki/Control_flow_graph)，从出口到入口有一条额外的边。圈复杂度是我们可以在不将图形分成两部分的情况下进行的最大切割数。

例如：

```
function F:
    if condition1:
       ...
    else:
       ...
    if condition2:
       ...
    else:
       ... 
```

![控制流图](https://upload.wikimedia.org/wikipedia/commons/thumb/7/7f/Control_flow_graph_of_function_with_two_if_else_statements.svg/384px-Control_flow_graph_of_function_with_two_if_else_statements.svg.png)

[控制流图](http://en.wikipedia.org/wiki/File:Control_flow_graph_of_function_with_two_if_else_statements.svg)

您可能可以直观地看到为什么链接图的圈复杂度为 3。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-05-26T16:53:10.647

圈复杂度基本上是一种度量，用于找出需要更多注意以实现可维护性的代码区域。它基本上是重构的输入。在避免深度嵌套循环、条件等方面，它肯定给出了代码改进领域的指示。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-05-26T17:29:32.583

就是这样。但是，“case”或“switch”语句的每个分支都倾向于计为 1。实际上，这意味着 CC*讨厌*case 语句以及任何需要它们的代码（命令处理器、状态机等）。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-05-22T00:41:38.640

圈复杂度衡量软件单元的复杂程度。它衡量程序使用条件逻辑构造（If、while、for、switch 和 case 等）可能遵循的不同路径的数量。如果您想了解更多关于计算它的信息，这里是一个精彩的 youtube 视频，您可以观看[https://www.youtube.com/watch?v=PlCGomvu-NM](https://www.youtube.com/watch?v=PlCGomvu-NM)

它在设计测试用例时很重要，因为它揭示了程序可以采用的不同路径或场景。“为了具有良好的可测试性和可维护性，McCabe 建议程序模块的圈复杂度不应超过 10”（Marsic，2012 年，第 232 页）。

参考文献：Marsic., I.（2012 年 9 月）。*软件工程*。罗格斯大学。取自 www.ece.rutgers.edu/~marsic/books/SE/book-SE_marsic.pdf

# html - 如何使用 CSS 为 HTML 表单中的单选按钮制作多行、垂直和水平对齐的标签？

> ID：911644
> 
> 赞同：11
> 
> 时间：2009-05-26T16:44:38.650
> 
> 标签：html, css, cross-browser, radio-button, label

假设以下标记：

```
<fieldset>
    <legend>Radio Buttons</legend>
    <ol>
        <li>
            <input type="radio" id="x">
            <label for="x"><!-- Insert multi-line markup here --></label>
        </li>
        <li>
            <input type="radio" id="x">
            <label for="x"><!-- Insert multi-line markup here --></label>
        </li>
    </ol>
</fieldset> 
```

如何设置单选按钮标签的样式，使它们在大多数浏览器（IE6+、FF、Safari、Chrome）中看起来如下所示：

![单选按钮标签](https://i.stack.imgur.com/sfsfW.png)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-26T20:40:05.523

我相信这一切。但是，您没有提到它必须验证，所以我使用了 inline-block (-moz-inline-box) 显示。实际上，我的最爱之一。

[这是一份工作副本](http://ryanflorence.com/sandbox/aligned-labels.html)

在 Safari 3、FireFox 3 和 IE7 中测试。

```
 <style type="text/css">
ol{
    padding-left: 0;
    margin-left:0;
}

ol>li {
    list-style-type: none;
    margin-bottom: .5em;
}

ol>li input[type=radio] {
    display: -moz-inline-box;
    display: inline-block;
    vertical-align: middle;
}

ol>li label {
    display: -moz-inline-box;
    display: inline-block;
    vertical-align: middle;
}
</style> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-26T17:15:04.610

使用以下标记和 css，我能够生成不包含在单选按钮下的多行标签：

```
<style type="text/css">
    fieldset input, label {
      float: left;
      display: block;
    }

    fieldset li {
      clear: both;
    }
</style>

<fieldset>
  <ol>
    <li>
      <input type="radio" id="x" />
      <label for="x">
        stuff<br/>
        stuff1
      </label>
    </li>
    <li>
      <input type="radio" id="x" />
      <label for="x">
        stuff<br/>
        stuff1
      </label>
    </li>
  </ol>
</fieldset> 
```

但是我无法使用：

```
fieldset label {
  vertical-align: middle;
} 
```

将标签垂直居中在单选按钮上，即使在应用宽度时（Dmitri Farkov 的回答中的两个建议。我的主要目的是防止在单选按钮下换行，所以这个解决方案暂时可以。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-05-12T10:52:20.227

由于我在上面询问了如何处理非常长的标签，我终于自己解决了。这是*我的*问题的解决方案。也许它可以帮助你？

```
<style type="text/css">
  #master_frame { 
      background: #BBB;
      height: 300px;
      width: 300px;
  } 
  fieldset.radios { 
      border: none;
  } 
  fieldset fields { 
      clear: both;
  } 
  input { 
      float: left;
      display: block;
  } 
  label { 
      position: relative;
      margin-left: 30px;
      display: block;
  } 
</style>

<div id="master_frame">
  <fieldset class='radios'>
    <div class='field'>
      <input type="radio" id="a" />
      <label for="a">Short</label>
    </div>
    <div class='field'>
      <input type="radio" id="b" />
      <label for="b">
        A really long and massive text that does not fit on one row!
      </label>
    </div>
  </fieldset>
</div> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T16:46:52.220

输入和标记两者

```
float: left;
display: block; 
```

设置标签和输入的宽度。

* * *

申请

```
clear: both;
 vertical-align: middle; 
```

给所有的李。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-09-21T11:16:33.130

您应该`white-space: normal;`在标签中使用多行

# python - gnuplot vs Matplotlib

> ID：911655
> 
> 赞同：90
> 
> 时间：2009-05-26T16:49:02.683
> 
> 标签：python, logging, matplotlib, gnuplot, graphing

[我已经开始使用gnuplot-py](http://gnuplot-py.sourceforge.net/)绘制[Tomcat](http://en.wikipedia.org/wiki/Apache_Tomcat)日志的项目，特别是将特定请求与内存分配和垃圾收集相关联。用于 Python 绘图的 gnuplot-py 与[Matplotlib的集体智慧是什么。](http://matplotlib.sourceforge.net/)有没有我没听说过的更好的图形库？

我的一般考虑是：

*   虽然 gnuplot 有大量文档，但 gnuplot-py 没有。Matplotlib 的文档社区有多好？
*   有没有 gnuplot 可以做但 gnuplot-py 不能做的事情？
*   Matplotlib 是否有更好的 Python 支持？
*   是否有大型节目阻止错误？烦恼？
*   目前 gnuplot 正在绘制 100,000 个点，我计划将其扩展到数百万个。我应该期待问题吗？Matplotlib 处理得如何？
*   gnuplot vs Matplotlib 的易用性、周转时间？
*   将现有的 gnuplot-py 代码移植到 Matplotlib 有多容易？

您将如何处理这项任务？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-05-26T17:12:05.803

*   你可以自己查看[matplotlib 的文档](http://matplotlib.sourceforge.net/contents.html)。我觉得挺全面的。
*   我对 gnuplot-py 的经验很少，所以我不能说它是否可以做到所有 gnuplot 可以。
*   Matplotlib 是专门为 Python 编写和设计的，因此它非常适合 Python 习语等。
*   Matplotlib 是一个成熟的项目。NASA 用它来做一些事情。
*   我在 Matplotlib 中绘制了数千万个点，它仍然看起来很漂亮，反应很快。
*   除了使用 Matplotlib 的面向对象方式之外，还有 pylab 接口，它使绘图变得像在 MATLAB 中一样简单——也就是说，非常简单。
*   至于从 gnuplot-py 移植到 matplotlib，我不知道。

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2014-05-27T07:21:57.490

## Matplotlib = 易用性，Gnuplot =（稍好）性能

* * *

我知道这篇文章很旧并且已经回答，但我路过并想投入我的两分钱。这是我的结论：如果你有一个不太大的数据集，你应该使用 Matplotlib。它更容易，看起来更好。但是，如果你*真的*需要性能，你可以使用 Gnuplot。我已经添加了一些代码来在您的机器上对其进行测试，并亲自查看它是否会产生真正的影响（这不是真正的性能基准，但应该给出第一个想法）。

下图表示执行以下操作所需的时间（以秒为单位）：

*   绘制随机散点图
*   将图形保存为 png 文件

![Gnuplot VS Matplotlib](https://i.stack.imgur.com/zfCmR.png)

配置：

*   gnuplot：5.2.2
*   gnuplot-py：1.8
*   matplotlib：2.1.2

我记得在具有旧版本库的旧计算机上运行时，性能差距要大得多（大散点图的差异约为 30 秒）。

此外，正如评论中提到的，您可以获得同等质量的情节。但是你必须付出更多的努力才能使用 Gnuplot 来做到这一点。

* * *

如果你想在你的机器上试一试，[这里是生成图表的代码：](https://gist.github.com/7hibault/5d7b9a6fa29b61653974e381248073b0)

```
# -*- coding: utf-8 -*-

from timeit import default_timer as timer
import matplotlib.pyplot as plt
import Gnuplot, Gnuplot.funcutils
import numpy as np
import sys
import os

def mPlotAndSave(x, y):
    plt.scatter(x, y)
    plt.savefig('mtmp.png')
    plt.clf()

def gPlotAndSave(data, g):
    g("set output 'gtmp.png'")
    g.plot(data)
    g("clear")

def cleanup():
    try:
        os.remove('gtmp.png')
    except OSError:
        pass
    try:
        os.remove('mtmp.png')
    except OSError:
        pass

begin = 2
end = 500000
step = 10000
numberOfPoints = range(begin, end, step)
n = len(numberOfPoints)
gnuplotTime = []
matplotlibTime = []
progressBarWidth = 30

# Init Gnuplot
g = Gnuplot.Gnuplot()
g("set terminal png size 640,480")

# Init matplotlib to avoid a peak in the beginning
plt.clf()

for idx, val in enumerate(numberOfPoints):
    # Print a nice progress bar (crucial)
    sys.stdout.write('\r')
    progress = (idx+1)*progressBarWidth/n
    bar = "▕" + "▇"*progress + "▁"*(progressBarWidth-progress) + "▏" + str(idx) + "/" + str(n-1)
    sys.stdout.write(bar)
    sys.stdout.flush()

    # Generate random data
    x = np.random.randint(sys.maxint, size=val)  
    y = np.random.randint(sys.maxint, size=val)
    gdata = zip(x,y)

    # Generate string call to a matplotlib plot and save, call it and save execution time
    start = timer()
    mPlotAndSave(x, y)
    end = timer()
    matplotlibTime.append(end - start)

    # Generate string call to a gnuplot plot and save, call it and save execution time
    start = timer()
    gPlotAndSave(gdata, g)
    end = timer()
    gnuplotTime.append(end - start)

    # Clean up the files
    cleanup()

del g
sys.stdout.write('\n')
plt.plot(numberOfPoints, gnuplotTime, label="gnuplot")
plt.plot(numberOfPoints, matplotlibTime, label="matplotlib")
plt.legend(loc='upper right')
plt.xlabel('Number of points in the scatter graph')
plt.ylabel('Execution time (s)')
plt.savefig('execution.png')
plt.show() 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2009-05-26T17:09:47.540

`matplotlib`有很好的文档，而且似乎很稳定。它产生的情节很漂亮——肯定是“出版质量”。由于良好的文档和在线提供的大量示例代码，它易于学习和使用，我认为您将`gnuplot`代码翻译成它不会有太多麻烦。毕竟，科学家们正在使用 matplotlib 来绘制数据和准备报告——因此它包含了人们需要的一切。

matplotlib 的一个显着优势是您可以将它与 Python GUI（至少是[wxPython](http://eli.thegreenplace.net/2008/08/01/matplotlib-with-wxpython-guis/)和[PyQt ）集成并创建具有漂亮绘图的 GUI 应用程序。](http://eli.thegreenplace.net/2009/01/20/matplotlib-with-pyqt-guis/)

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-12-25T10:01:31.897

在使用 GNUplot（使用我自己的 Python 包装器）很长时间（并且真的不喜欢 80 年代的输出）之后，我才开始研究 matplotlib。我必须说我非常喜欢它，输出看起来非常好，文档质量高且内容广泛（尽管这也适用于 GNUplot）。我花了很长时间在 matplotlib 文档中寻找的一件事是如何写入图像文件而不是屏幕！幸运的是，这个页面解释得很好：[http ://www.dalkescientific.com/writings/diary/archive/2005/04/23/matplotlib_without_gui.html](http://www.dalkescientific.com/writings/diary/archive/2005/04/23/matplotlib_without_gui.html)

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-05-26T17:15:51.020

两者我都玩过，我更喜欢 Matplotlib 在 Python 集成、选项和图形/绘图质量方面。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2015-01-10T21:26:25.227

关于性能和绘制大量点：我使用 gnuplot* 和 matplotlib 比较了从文本文件加载并保存到 png 的 500.000 个点的散点图。

```
500.000 points scatterplot
gnuplot:      5.171 s
matplotlib: 230.693 s 
```

我只运行了一次，结果看起来并不相同，但我认为这个想法很明确：gnuplot 在性能上获胜。

*我直接使用了 gnuplot，因为 gnuplotpy 演示对我来说不能开箱即用。Matplotlib 在 Python 集成中获胜。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-03-02T14:29:39.157

Gnuplot 可以做什么 Gnuplot-Py 也可以。因为 Gnuplot 可以由管道（pgnuplot）驱动。Gnuplot-Py 只是它的一个薄层。所以你不需要担心它。

为什么我更喜欢 gnuplot 可能是多种输出格式（PDF、PS 和 LaTex），这在论文中非常有用，而且默认输出看起来更科学：）

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2020-02-24T21:40:15.057

一些专业人士的`gnuplot`（使用多年后我仍然不喜欢 matlibplot）：

*   简单地绘制*函数*`sin(x)`（无需定义数组并考虑范围）
*   直接绘制*文件*（无需导入数组）
*   绘制管道数据（即时执行 shell 命令`"<echo 1 2 3"`）
*   复制到剪贴板按钮
*   更快的绘图
*   更快的编码
*   关键字更容易记住

[gplot.py](https://github.com/mzechmeister/python/wiki/gplot.py)是 python 和 jupyter 的另一个包装器 gnuplot 包装器。

# c - 如何更安全地编写这个 C 片段？

> ID：911660
> 
> 赞同：5
> 
> 时间：2009-05-26T16:49:51.387
> 
> 标签：c, memory-management, cstring, null-terminated, strdup

我有以下 C 代码片段，必须识别错误并建议一种更安全的编写方法：

```
char somestring[] = "Send money!\n";
char *copy;

copy = (char *) malloc(strlen(somestring));

strcpy(copy, somestring);
printf(copy); 
```

所以错误是 strlen 忽略`'\0'`了字符串的尾随，因此不会为副本分配足够的内存，但我不确定他们在更安全地编写它方面的目的是什么？

我可以使用`malloc(strlen(somestring)+1))`我假设，但我认为必须有比这更好的方法？

* * *

**编辑：**好的，我已经接受了一个答案，我怀疑我们不会期望 strdup 解决方案，因为它不是 ANSI C 的一部分。这似乎是一个相当主观的问题，所以我不确定我是否有接受其实是最好的。无论如何感谢所有的答案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-26T17:49:42.153

我不能对上面的回复发表评论，但除了检查返回码和使用之外`strncpy`，你不应该这样做：

```
printf(string) 
```

但是使用：

```
printf("%s", string); 
```

参考：[http ://en.wikipedia.org/wiki/Format_string_attack](http://en.wikipedia.org/wiki/Format_string_attack)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-26T16:52:50.600

```
char somestring[] = "Send money!\n";
char *copy = strdup(something);

if (copy == NULL) {
    // error
} 
```

或者只是把这个逻辑放在一个单独的函数**xstrdup 中**：

```
char * xstrdup(const char *src) 
{
    char *copy = strdup(src);

    if (copy == NULL) {
       abort();
    }

    return copy;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-26T17:01:37.103

```
char   somestring[] = "Send money!\n";
char   *copy;
size_t copysize;

copysize = strlen(somestring)+1;
copy = (char *) malloc(copysize);
if (copy == NULL)
    bail("Oh noes!\n");

strncpy(copy, somestring, copysize);
printf("%s", copy); 
```

上述差异：

*   `malloc()`必须检查的结果！
*   计算并**存储**内存大小！
*   使用`strncpy()`因为`strcpy()`是淘气。在这个人为的例子中，它不会受到伤害，但不要养成使用它的习惯。

**编辑：**

对于那些认为我应该使用的人`strdup()`......只有在你对问题采取最狭隘的观点时才有效。这不仅愚蠢，而且忽略了一个更好的答案：

```
char somestring[] = "Send money!\n";
char *copy = somestring;
printf(copy); 
```

如果你要变得迟钝，至少要擅长它。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-26T16:59:50.647

1.  strlen + 1，用于 \0 终止符
2.  malloc 可能会失败；总是检查 malloc 返回值

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-26T17:43:20.733

Ick...`strdup()`像其他人所说的那样使用，如果需要的话自己写。既然您现在有时间考虑这个问题……请查看[Mitre 的 25 个最危险的编程错误](http://www.mitre.org/news/digest/defense_intelligence/02_09/errors.html)，然后考虑为什么该短语**不**`printf(copy)`应该出现在代码中。就彻底的糟糕而言，就在那里，更不用说追查为什么当复制类似于......**`malloc(strlen(str))``"%s%n"`**

 *** * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-27T01:56:46.617

我会评论以前的解决方案，但我没有足够的代表。在这里使用**strncpy与使用****strcpy**一样错误（因为绝对没有溢出的风险）。*<string.h>*中有一个名为**memcpy**的函数，它正是为此而生的。它不仅明显更快，而且是用于在标准 C 中复制已知长度的字符串的正确函数。

 *从接受的答案：

```
char   somestring[] = "Send money!\n";
char   *copy;
size_t copysize;

copysize = strlen(somestring)+1;
copy = (char *) malloc(copysize);
if (copy == NULL)
    bail("Oh noes!\n");

memcpy(copy, somestring, copysize); /* You don't use str* functions for this! */
printf("%s", copy); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-27T17:08:39.493

使代码更安全（更正确）的方法。

1.  不要制作不必要的副本。从示例中，没有明显要求您实际需要复制`somestring`. 可以直接输出。
2.  如果您必须复制字符串，请编写一个函数来执行此操作（或使用 strdup 如果有它）。然后你只需要在一个地方把它做好。
3.  只要有可能，在声明副本时立即初始化指向副本的指针。
4.  请记住为空终止符分配空间。
5.  记得检查来自的返回值`malloc`。
6.  记得释放`malloc`'ed 内存。
7.  不要`printf`使用不受信任的格式字符串调用。使用`printf("%s", copy)`或`puts(copy)`。
8.  使用带有字符串类的面向对象语言或任何具有内置字符串支持的语言来避免大多数这些问题。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-28T04:02:22.213

为 Adrian McCarthy 编写更安全代码的方法添加更多内容，

使用静态代码分析器，他们非常擅长发现这种错误

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-26T17:18:25.773

如果一个人真的对这样的事情感兴趣，那么更安全地编写它的最好方法就是用 Ada 编写它。

```
somestring : constant string := "Send money!";
declare
   copy : constant string := somestring;
begin
   put_line (somestring);
end; 
```

结果相同，那么有什么区别？

*   整个事情都是在堆栈上完成的（没有指针）。重新分配是自动且安全的。
*   一切都自动进行范围检查，因此没有缓冲区溢出漏洞的机会
*   两个字符串都是常量，所以没有机会搞砸和修改它们。
*   它可能会比 C*快得多*，不仅因为缺少动态分配，还因为没有对 strlen() 所需的字符串进行额外的扫描。

请注意，在 Ada 中，“字符串”不是一些特殊的动态构造。它是内置的字符数组。但是，Ada 数组可以在声明时通过您分配给它们的数组来调整大小。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2009-05-26T16:52:58.947

更安全的方法是使用`strncpy`而不是`strcpy`. 该函数接受第三个参数：要复制的字符串的长度。此解决方案不会超出 ANSI C，因此它适用于所有环境（而其他方法可能仅适用于 POSIX 兼容系统）。

```
char somestring[] = "Send money!\n";
char *copy;

copy = (char *) malloc(strlen(somestring));

strncpy(copy, somestring, strlen(somestring));
printf(copy); 
```

# php - 在 PHP 中解析巨大的 XML 文件

> ID：911663
> 
> 赞同：61
> 
> 时间：2009-05-26T16:50:50.417
> 
> 标签：php, xml, parsing, large-files, dmoz

我正在尝试将 DMOZ 内容/结构 XML 文件解析到 MySQL 中，但是所有现有的执行此操作的脚本都非常旧并且不能正常工作。如何在 PHP 中打开一个大的（+1GB）XML 文件进行解析？

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2009-05-26T16:52:45.483

只有两个 php API 真正适合处理大文件。第一个是旧的[expat](http://se2.php.net/manual/en/book.xml.php) api，第二个是较新的[XMLreader](http://se2.php.net/manual/en/book.xmlreader.php)函数。这些 api 读取连续的流，而不是将整个树加载到内存中（simplexml 和 DOM 就是这样做的）。

例如，您可能想查看 DMOZ 目录的部分解析器：

```
<?php

class SimpleDMOZParser
{
    protected $_stack = array();
    protected $_file = "";
    protected $_parser = null;

    protected $_currentId = "";
    protected $_current = "";

    public function __construct($file)
    {
        $this->_file = $file;

        $this->_parser = xml_parser_create("UTF-8");
        xml_set_object($this->_parser, $this);
        xml_set_element_handler($this->_parser, "startTag", "endTag");
    }

    public function startTag($parser, $name, $attribs)
    {
        array_push($this->_stack, $this->_current);

        if ($name == "TOPIC" && count($attribs)) {
            $this->_currentId = $attribs["R:ID"];
        }

        if ($name == "LINK" && strpos($this->_currentId, "Top/Home/Consumer_Information/Electronics/") === 0) {
            echo $attribs["R:RESOURCE"] . "\n";
        }

        $this->_current = $name;
    }

    public function endTag($parser, $name)
    {
        $this->_current = array_pop($this->_stack);
    }

    public function parse()
    {
        $fh = fopen($this->_file, "r");
        if (!$fh) {
            die("Epic fail!\n");
        }

        while (!feof($fh)) {
            $data = fread($fh, 4096);
            xml_parse($this->_parser, $data, feof($fh));
        }
    }
}

$parser = new SimpleDMOZParser("content.rdf.u8");
$parser->parse(); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2011-11-23T23:14:20.863

[这是一个与在 PHP 中处理大型 XML 的最佳方式](https://stackoverflow.com/questions/1167062/best-way-to-process-large-xml-in-php/8250302)非常相似的问题，但针对 DMOZ 目录解析的特定问题提出了一个非常好的具体答案。但是，由于这对于一般的大型 XML 来说是一个很好的谷歌命中，所以我也会从另一个问题重新发布我的答案：

我的看法：

[https://github.com/prewk/XmlStreamer](https://github.com/prewk/XmlStreamer)

一个简单的类，它将在流式传输文件时将所有子元素提取到 XML 根元素。在来自 pubmed.com 的 108 MB XML 文件上进行了测试。

```
class SimpleXmlStreamer extends XmlStreamer {
    public function processNode($xmlString, $elementName, $nodeIndex) {
        $xml = simplexml_load_string($xmlString);

        // Do something with your SimpleXML object

        return true;
    }
}

$streamer = new SimpleXmlStreamer("myLargeXmlFile.xml");
$streamer->parse(); 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-09-09T09:34:53.907

我最近不得不解析一些相当大的 XML 文档，并且需要一种方法来一次读取一个元素。

如果您有以下文件`complex-test.xml`：

```
<?xml version="1.0" encoding="UTF-8"?>
<Complex>
  <Object>
    <Title>Title 1</Title>
    <Name>It's name goes here</Name>
    <ObjectData>
      <Info1></Info1>
      <Info2></Info2>
      <Info3></Info3>
      <Info4></Info4>
    </ObjectData>
    <Date></Date>
  </Object>
  <Object></Object>
  <Object>
    <AnotherObject></AnotherObject>
    <Data></Data>
  </Object>
  <Object></Object>
  <Object></Object>
</Complex> 
```

并想返回`<Object/>`s

PHP：

```
require_once('class.chunk.php');

$file = new Chunk('complex-test.xml', array('element' => 'Object'));

while ($xml = $file->read()) {
  $obj = simplexml_load_string($xml);
  // do some parsing, insert to DB whatever
}

###########
Class File
###########

<?php
/**
 * Chunk
 * 
 * Reads a large file in as chunks for easier parsing.
 * 
 * The chunks returned are whole <$this->options['element']/>s found within file.
 * 
 * Each call to read() returns the whole element including start and end tags.
 * 
 * Tested with a 1.8MB file, extracted 500 elements in 0.11s
 * (with no work done, just extracting the elements)
 * 
 * Usage:
 * <code>
 *   // initialize the object
 *   $file = new Chunk('chunk-test.xml', array('element' => 'Chunk'));
 *   
 *   // loop through the file until all lines are read
 *   while ($xml = $file->read()) {
 *     // do whatever you want with the string
 *     $o = simplexml_load_string($xml);
 *   }
 * </code>
 * 
 * @package default
 * @author Dom Hastings
 */
class Chunk {
  /**
   * options
   *
   * @var array Contains all major options
   * @access public
   */
  public $options = array(
    'path' => './',       // string The path to check for $file in
    'element' => '',      // string The XML element to return
    'chunkSize' => 512    // integer The amount of bytes to retrieve in each chunk
  );

  /**
   * file
   *
   * @var string The filename being read
   * @access public
   */
  public $file = '';
  /**
   * pointer
   *
   * @var integer The current position the file is being read from
   * @access public
   */
  public $pointer = 0;

  /**
   * handle
   *
   * @var resource The fopen() resource
   * @access private
   */
  private $handle = null;
  /**
   * reading
   *
   * @var boolean Whether the script is currently reading the file
   * @access private
   */
  private $reading = false;
  /**
   * readBuffer
   * 
   * @var string Used to make sure start tags aren't missed
   * @access private
   */
  private $readBuffer = '';

  /**
   * __construct
   * 
   * Builds the Chunk object
   *
   * @param string $file The filename to work with
   * @param array $options The options with which to parse the file
   * @author Dom Hastings
   * @access public
   */
  public function __construct($file, $options = array()) {
    // merge the options together
    $this->options = array_merge($this->options, (is_array($options) ? $options : array()));

    // check that the path ends with a /
    if (substr($this->options['path'], -1) != '/') {
      $this->options['path'] .= '/';
    }

    // normalize the filename
    $file = basename($file);

    // make sure chunkSize is an int
    $this->options['chunkSize'] = intval($this->options['chunkSize']);

    // check it's valid
    if ($this->options['chunkSize'] < 64) {
      $this->options['chunkSize'] = 512;
    }

    // set the filename
    $this->file = realpath($this->options['path'].$file);

    // check the file exists
    if (!file_exists($this->file)) {
      throw new Exception('Cannot load file: '.$this->file);
    }

    // open the file
    $this->handle = fopen($this->file, 'r');

    // check the file opened successfully
    if (!$this->handle) {
      throw new Exception('Error opening file for reading');
    }
  }

  /**
   * __destruct
   * 
   * Cleans up
   *
   * @return void
   * @author Dom Hastings
   * @access public
   */
  public function __destruct() {
    // close the file resource
    fclose($this->handle);
  }

  /**
   * read
   * 
   * Reads the first available occurence of the XML element $this->options['element']
   *
   * @return string The XML string from $this->file
   * @author Dom Hastings
   * @access public
   */
  public function read() {
    // check we have an element specified
    if (!empty($this->options['element'])) {
      // trim it
      $element = trim($this->options['element']);

    } else {
      $element = '';
    }

    // initialize the buffer
    $buffer = false;

    // if the element is empty
    if (empty($element)) {
      // let the script know we're reading
      $this->reading = true;

      // read in the whole doc, cos we don't know what's wanted
      while ($this->reading) {
        $buffer .= fread($this->handle, $this->options['chunkSize']);

        $this->reading = (!feof($this->handle));
      }

      // return it all
      return $buffer;

    // we must be looking for a specific element
    } else {
      // set up the strings to find
      $open = '<'.$element.'>';
      $close = '</'.$element.'>';

      // let the script know we're reading
      $this->reading = true;

      // reset the global buffer
      $this->readBuffer = '';

      // this is used to ensure all data is read, and to make sure we don't send the start data again by mistake
      $store = false;

      // seek to the position we need in the file
      fseek($this->handle, $this->pointer);

      // start reading
      while ($this->reading && !feof($this->handle)) {
        // store the chunk in a temporary variable
        $tmp = fread($this->handle, $this->options['chunkSize']);

        // update the global buffer
        $this->readBuffer .= $tmp;

        // check for the open string
        $checkOpen = strpos($tmp, $open);

        // if it wasn't in the new buffer
        if (!$checkOpen && !($store)) {
          // check the full buffer (in case it was only half in this buffer)
          $checkOpen = strpos($this->readBuffer, $open);

          // if it was in there
          if ($checkOpen) {
            // set it to the remainder
            $checkOpen = $checkOpen % $this->options['chunkSize'];
          }
        }

        // check for the close string
        $checkClose = strpos($tmp, $close);

        // if it wasn't in the new buffer
        if (!$checkClose && ($store)) {
          // check the full buffer (in case it was only half in this buffer)
          $checkClose = strpos($this->readBuffer, $close);

          // if it was in there
          if ($checkClose) {
            // set it to the remainder plus the length of the close string itself
            $checkClose = ($checkClose + strlen($close)) % $this->options['chunkSize'];
          }

        // if it was
        } elseif ($checkClose) {
          // add the length of the close string itself
          $checkClose += strlen($close);
        }

        // if we've found the opening string and we're not already reading another element
        if ($checkOpen !== false && !($store)) {
          // if we're found the end element too
          if ($checkClose !== false) {
            // append the string only between the start and end element
            $buffer .= substr($tmp, $checkOpen, ($checkClose - $checkOpen));

            // update the pointer
            $this->pointer += $checkClose;

            // let the script know we're done
            $this->reading = false;

          } else {
            // append the data we know to be part of this element
            $buffer .= substr($tmp, $checkOpen);

            // update the pointer
            $this->pointer += $this->options['chunkSize'];

            // let the script know we're gonna be storing all the data until we find the close element
            $store = true;
          }

        // if we've found the closing element
        } elseif ($checkClose !== false) {
          // update the buffer with the data upto and including the close tag
          $buffer .= substr($tmp, 0, $checkClose);

          // update the pointer
          $this->pointer += $checkClose;

          // let the script know we're done
          $this->reading = false;

        // if we've found the closing element, but half in the previous chunk
        } elseif ($store) {
          // update the buffer
          $buffer .= $tmp;

          // and the pointer
          $this->pointer += $this->options['chunkSize'];
        }
      }
    }

    // return the element (or the whole file if we're not looking for elements)
    return $buffer;
  }
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-26T16:53:17.323

我建议使用基于 SAX 的解析器而不是基于 DOM 的解析器。

在 PHP 中使用 SAX 的信息：[http ://www.brainbell.com/tutorials/php/Parsing_XML_With_SAX.htm](http://www.brainbell.com/tutorials/php/Parsing_XML_With_SAX.htm)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-26T17:45:21.553

这不是一个很好的解决方案，而只是在那里抛出另一个选项：

您可以将许多大型 XML 文件分成块，尤其是那些实际上只是相似元素列表的文件（我怀疑您正在使用的文件会是）。

例如，如果您的文档看起来像：

```
<dmoz>
  <listing>....</listing>
  <listing>....</listing>
  <listing>....</listing>
  <listing>....</listing>
  <listing>....</listing>
  <listing>....</listing>
  ...
</dmoz> 
```

您可以一次读取一两个兆，人为地将`<listing>`您加载的几个完整标签包装在根级别标签中，然后通过 simplexml/domxml 加载它们（我在采用这种方法时使用了 domxml）。

坦率地说，如果您使用的是 PHP < 5.1.2，我更喜欢这种方法。在 5.1.2 及更高版本中，可以使用 XMLReader，这可能是最好的选择，但在此之前，您会被上述分块策略或旧的 SAX/expat 库所困扰。我不了解你们其他人，但我讨厌编写/维护 SAX/expat 解析器。

但是请注意，当您的文档*不*包含许多相同的底层元素时（例如，它适用于任何类型的文件列表或 URL 等，但不会使解析大型 HTML 文档的意义）

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2018-11-25T07:17:23.200

这是一个旧帖子，但首先在谷歌搜索结果中，所以我想我根据这个帖子发布另一个解决方案：

[http://drib.tech/programming/parse-large-xml-files-php](http://drib.tech/programming/parse-large-xml-files-php)

此解决方案同时使用`XMLReader`和`SimpleXMLElement`：

```
$xmlFile = 'the_LARGE_xml_file_to_load.xml'
$primEL  = 'the_name_of_your_element';

$xml     = new XMLReader();
$xml->open($xmlFile);

// finding first primary element to work with
while($xml->read() && $xml->name != $primEL){;}

// looping through elements
while($xml->name == $primEL) {
    // loading element data into simpleXML object
    $element = new SimpleXMLElement($xml->readOuterXML());

    // DO STUFF

    // moving pointer   
    $xml->next($primEL);
    // clearing current element
    unset($element);
} // end while

$xml->close(); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-01-09T10:00:38.817

为此，您可以将 XMLReader 与 DOM 结合使用。在 PHP 中，两个 API（和 SimpleXML）都基于同一个库 - libxml2。大型 XML 通常是记录列表。因此，您使用 XMLReader 来迭代记录，将单个记录加载到 DOM 中，并使用 DOM 方法和 Xpath 来提取值。关键是方法`XMLReader::expand()`。它将 XMLReader 实例中的当前节点及其后代加载为 DOM 节点。

示例 XML：

```
<books>
  <book>
    <title isbn="978-0596100087">XSLT 1.0 Pocket Reference</title>
  </book>
  <book>
    <title isbn="978-0596100506">XML Pocket Reference</title>
  </book>
  <!-- ... -->
</books> 
```

示例代码：

```
// open the XML file
$reader = new XMLReader();
$reader->open('books.xml');

// prepare a DOM document
$document = new DOMDocument();
$xpath = new DOMXpath($document);

// find the first `book` element node at any depth
while ($reader->read() && $reader->localName !== 'book') {
  continue;
}

// as long as here is a node with the name "book"
while ($reader->localName === 'book') {
  // expand the node into the prepared DOM
  $book = $reader->expand($document);
  // use Xpath expressions to fetch values
  var_dump(
    $xpath->evaluate('string(title/@isbn)', $book),
    $xpath->evaluate('string(title)', $book)
  );
  // move to the next book sibling node
  $reader->next('book');
}
$reader->close(); 
```

请注意，展开的节点永远不会附加到 DOM 文档中。它允许 GC 清理它。

这种方法也适用于 XML 名称空间。

```
$namespaceURI = 'urn:example-books';

$reader = new XMLReader();
$reader->open('books.xml');

$document = new DOMDocument();
$xpath = new DOMXpath($document);
// register a prefix for the Xpath expressions
$xpath->registerNamespace('b', $namespaceURI);

// compare local node name and namespace URI
while (
  $reader->read() &&
  (
    $reader->localName !== 'book' ||
    $reader->namespaceURI !== $namespaceURI
  )
) {
  continue;
}

// iterate the book elements 
while ($reader->localName === 'book') {
  // validate that they are in the namespace
  if ($reader->namespaceURI === $namespaceURI) {
    $book = $reader->expand($document);
    var_dump(
      $xpath->evaluate('string(b:title/@isbn)', $book),
      $xpath->evaluate('string(b:title)', $book)
    );
  }
  $reader->next('book');
}
$reader->close(); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-03-31T13:10:20.280

我已经为 XMLReader 编写了一个包装器（恕我直言），这样可以更轻松地获取所需的信息。包装器允许您关联一组数据元素的路径以及在找到此路径时运行的回调。该路径允许正则表达式并捕获也可以传递给回调的组。

该库位于[https://github.com/NigelRel3/XMLReaderReg](https://github.com/NigelRel3/XMLReaderReg)，也可以使用`composer require nigelrel3/xml-reader-reg`.

如何使用它的示例...

```
$inputFile = __DIR__ ."/../tests/data/simpleTest1.xml";
$reader = new XMLReaderReg\XMLReaderReg();
$reader->open($inputFile);

$reader->process([
    '(.*/person(?:\[\d*\])?)' => function (SimpleXMLElement $data, $path): void {
        echo "1) Value for ".$path[1]." is ".PHP_EOL.
            $data->asXML().PHP_EOL;
    },
    '(.*/person3(\[\d*\])?)' => function (DOMElement $data, $path): void {
        echo "2) Value for ".$path[1]." is ".PHP_EOL.
            $data->ownerDocument->saveXML($data).PHP_EOL;
    },
    '/root/person2/firstname' => function (string $data): void {
        echo "3) Value for /root/person2/firstname is ". $data.PHP_EOL;
    }
    ]);

$reader->close(); 
```

从示例中可以看出，您可以将要传递的数据作为 SimpleXMLElement、DOMElement 或最后一个是字符串。这将仅表示与路径匹配的数据。

路径还显示了如何使用捕获组 -`(.*/person(?:\[\d*\])?)`查找任何人员元素（包括元素数组），并`$path[1]`在回调中显示找到此特定实例的路径。

库中有一个扩展示例以及单元测试。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-04-17T06:38:42.313

我用 2 GB xml 测试了以下代码：

```
<?php
set_time_limit(0);
$reader = new XMLReader();
if (!$reader->open("data.xml"))
{
    die("Failed to open 'data.xml'");
}
while($reader->read())
{
    $node = $reader->expand();
    // process $node...
}
$reader->close();
?> 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-06-09T06:12:13.363

我的解决方案：

```
$reader = new XMLReader();
$reader->open($fileTMP);
 while ($reader->read()) {
 if ($reader->nodeType === XMLReader::ELEMENT && $reader->name === 'xmltag' && $reader->isEmptyElement === false) {
 $item = simplexml_load_string($reader->readOuterXML(), null, LIBXML_NOCDATA); 
   //operations on file
}
}
$reader->close(); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-02-23T04:06:46.403

非常高效的方式是

```
preg_split('/(<|>)/m', $xmlString); 
```

之后，只需要一个周期。

# ssis - SSIS 包作为 SQL Server 代理作业失败

> ID：911669
> 
> 赞同：1
> 
> 时间：2009-05-26T16:51:46.530
> 
> 标签：ssis

我有一个从 AS400 文件导入到 SQL 的包。包在 Visual Studio 中正确执行，但在设置为计划作业时失败。错误信息是我的密码不正确。我知道这是正确的。我还设置了一个包配置，但这不起作用。我已经搜索并尝试了很多东西。有人可以给我一些帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T17:13:19.420

您的密码不正确。

说真的，你“知道”你的密码是正确的吗？您比试图使用密码的代码更了解吗？你觉得这很可能吗？

考虑您和 SSIS 可能引用不同密码的可能性。也许你“知道”的那个实际上是正确的，但另一个不是。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T01:50:54.273

可能是一个愚蠢的答案，但你是如何连接到 AS400 的？如果它使用 ODBC 驱动程序，则需要在本地（开发）和 SQL 服务器机器上安装 AS400 驱动程序。他们对版本非常挑剔。

如果没记错的话，当您使用 AS400 驱动程序软件设置 ODBC 连接时，我认为您还需要指定连接详细信息，并且它们会明确保存在 ODBC 连接中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T21:59:37.723

上面的支持链接是正确的。把它归结为一个简单的答案。密码保护您的 SSIS 包以保存连接到 AS400 所需的凭据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-01T13:51:18.080

使用 ODBC 配置：使用系统 DSN 而不是用户 DSN，它将起作用！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-06-03T16:34:51.370

尝试使用 odbc 连接或尝试在 SSIS 服务器上重新部署包。

# python - 从 PDF 文件中提取标题？

> ID：911672
> 
> 赞同：14
> 
> 时间：2009-05-26T16:52:40.053
> 
> 标签：python, pdf

我想编写一个脚本来自动重命名下载的论文及其标题，我想知道是否有任何库或技巧可以使用？PDF 都是由 TeX 生成的，应该有一些“正式”的结构。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-26T16:58:14.723

你可以尝试使用[pyPdf](http://pybrary.net/pyPdf/)和[这个例子](http://blog.isnotworking.com/2006/08/extract-pdf-title-from-all-files-on.html)。

**例如：**

```
from pyPdf import PdfFileWriter, PdfFileReader

def get_pdf_title(pdf_file_path):
    with open(pdf_file_path) as f:
        pdf_reader = PdfFileReader(f) 
        return pdf_reader.getDocumentInfo().title

title = get_pdf_title('/home/user/Desktop/my.pdf') 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-01-24T08:45:54.893

假设所有这些论文都来自 arXiv，您可以改为提取 arXiv id（我猜想在 PDF 的文本中搜索“arXiv：”会始终将 id 显示为第一次点击）。

一旦你有了 arXiv 参考号（并且已经完成了`pip install arxiv`），你可以使用

```
paper_ref = '1501.00730'
arxiv.query(id_list=[paper_ref])[0].title 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T16:58:14.707

我可能会从 perl 开始（因为它始终是我首先要做的事情）。有[几个处理 PDF 的模块](http://search.cpan.org/search?mode=module&query=PDF)。如果你有一个一致的结构，你可以使用正则表达式来获取标题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-26T17:00:36.450

您可以尝试将[iText](http://www.lowagie.com/iText/)与[Jython一起使用](http://www.jython.org/Project/)

# c# - 多次注册脚本

> ID：911679
> 
> 赞同：0
> 
> 时间：2009-05-26T16:53:25.310
> 
> 标签：c#, asp.net

在后面的代码中，我注册了一个启动脚本，如下所示：

```
 string strFunctionName = "ShouldAdd";
  sb.Append(strFunctionName + @"((blnShouldAdd ? "true" : "false") + ", true);");

  ScriptManager.RegisterStartupScript(this, this.GetType(), "shouldAdd", sb.ToString(), true); 
```

这段代码被调用了两次，一次是在页面加载中，当`blnShouldAdd`计算结果为时`false`，在按钮的事件处理程序中，当`blnShouldAdd`计算结果为时`true`。

奇怪的是，当我调试代码并进入 ShouldAdd JS 函数时，该值始终为 false。我认为这是真的，因为事件处理程序中的第二个调用覆盖了第一个。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T12:48:41.327

页面加载也会在您单击按钮时运行，作为 asp.net 页面生命周期的一部分，它在按钮的事件处理程序之前运行。因此，当您到达按钮的事件处理程序时，您已经在页面加载中注册了脚本，因此使用相同（类型、键）对注册另一个脚本的请求将被忽略。

也许您应该将调用从 Page Load 移到页面生命周期的后期，也许 PreRender 放在更好的地方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T17:00:02.287

我认为您应该使用`IsStartupScriptBlockRegistered()`or`IsClientScriptBlockRegistered()`方法来检查脚本是否已经添加，并且只`RegisterStartupScript`在它返回时才打扰`false`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T17:00:39.477

您必须将复杂的“this”和“this.GetType()”参数传递给`RegisterStartupScript()`函数的原因是为了确保给定函数只注册一次。因此，您的代码运行一次，而不是两次。

# wpf - ComboBox 获得焦点时的 WPF 鼠标行为

> ID：911683
> 
> 赞同：2
> 
> 时间：2009-05-26T16:53:52.953
> 
> 标签：wpf, combobox, behavior

当 WPF 组合框被单击并获得焦点时，之后发生的唯一交互可能是与组合框。如果与其他任何东西交互，包括窗口函数 ( `minimize`, `restore`, `close`, `resize`) 和窗口中的任何控件，则忽略该操作并且 ComboBox 失去焦点。

此外，`MouseEnter`窗口`MouseLeave`上的按钮仍然处于活动状态，但是当`MouseEnter`出现在窗口边框（？）上时，鼠标指针不会变为调整大小指针。这种行为是有意义的，因为`ComboBox`' 使用了弹出控件。弹出控件独立于主视觉树而存在，如果窗口移动或调整大小，弹出窗口保持固定浮动在主窗口上方。

我曾尝试使用[Reflector](http://en.wikipedia.org/wiki/.NET_Reflector)来查看`ComboBox`它在做什么，但我无法找到我想要的东西。基本上，我不知道这种行为是来自窗口、组合框，还是与弹出窗口有关。我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T20:50:27.343

你的描述是对的，弹出窗口保持所有动作焦点，直到它本身失去焦点。如果您尝试更改 ComboBox 的功能，您可能需要考虑[创建自己的 ControlTemplate](http://msdn.microsoft.com/en-us/library/ms752094.aspx)，它的行为不同并且不保留弹出控件的默认操作。

希望这会有所帮助，但不完全确定您要做什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-03-17T08:34:07.590

我知道这个问题很老，但对于任何来这里寻找答案的人来说，它是使用[Mouse.Capture](https://docs.microsoft.com/en-us/dotnet/api/system.windows.input.mouse.capture?view=net-5.0)。

组合框设置`Mouse.Capture(comboBox, CaptureMode.SubTree)`为`OnIsDropDownOpenChanged`. 这可确保所有鼠标事件都被 ComboBox 捕获。当弹出窗口关闭时，`Mouse.Capture(null)`释放鼠标捕获。

# c# - 为什么密封类型更快？

> ID：911684
> 
> 赞同：37
> 
> 时间：2009-05-26T16:54:03.547
> 
> 标签：c#, .net, performance, clr

为什么密封类型更快？

我想知道为什么这是真的更深层次的细节。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-05-26T17:16:44.107

在最低级别，当您拥有密封类时，编译器可以进行微优化。

如果您在密封类上调用方法，并且在编译时将类型声明为该密封类，则编译器可以使用 call IL 指令而不是 callvirt IL 指令来实现方法调用（在大多数情况下）。这是因为方法目标不能被覆盖。Call 消除了空检查，并且比 callvirt 执行更快的 vtable 查找，因为它不必检查虚拟表。

这可能是对性能的非常非常轻微的改进。

话虽如此，在决定是否封课时，我会完全忽略这一点。将类型标记为密封确实应该是设计决策，而不是性能决策。您是否希望人们（包括您自己）现在或将来可能从您的类中继承？如果是这样，请不要密封。如果没有，请密封。这真的应该是决定因素。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-26T16:56:50.390

本质上，这与他们不必担心对虚函数表的扩展有关。密封类型不能扩展，因此，运行时不需要关心它们可能是多态的。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-06-02T14:38:31.157

决定发布小代码示例来说明 C# 编译器何时发出“call”和“callvirt”指令。

所以，这是我使用的所有类型的源代码：

```
 public sealed class SealedClass
    {
        public void DoSmth()
        { }
    }

    public class ClassWithSealedMethod : ClassWithVirtualMethod
    {
        public sealed override void DoSmth()
        { }
    }

    public class ClassWithVirtualMethod
    {
        public virtual void DoSmth()
        { }
    } 
```

我还有一种方法可以调用所有“DoSmth()”方法：

```
 public void Call()
    {
        SealedClass sc = new SealedClass();
        sc.DoSmth();

        ClassWithVirtualMethod cwcm = new ClassWithVirtualMethod();
        cwcm.DoSmth();

        ClassWithSealedMethod cwsm = new ClassWithSealedMethod();
        cwsm.DoSmth();
    } 
```

查看“Call()”方法，我们可以说（理论上）C# 编译器应该发出 2 个“callvirt”和 1 个“call”指令，对吧？不幸的是，现实有点不同——3个“callvirt”-s：

```
.method public hidebysig instance void Call() cil managed
{
    .maxstack 1
    .locals init (
        [0] class TestApp.SealedClasses.SealedClass sc,
        [1] class TestApp.SealedClasses.ClassWithVirtualMethod cwcm,
        [2] class TestApp.SealedClasses.ClassWithSealedMethod cwsm)
    L_0000: newobj instance void TestApp.SealedClasses.SealedClass::.ctor()
    L_0005: stloc.0 
    L_0006: ldloc.0 
    L_0007: callvirt instance void TestApp.SealedClasses.SealedClass::DoSmth()
    L_000c: newobj instance void TestApp.SealedClasses.ClassWithVirtualMethod::.ctor()
    L_0011: stloc.1 
    L_0012: ldloc.1 
    L_0013: callvirt instance void TestApp.SealedClasses.ClassWithVirtualMethod::DoSmth()
    L_0018: newobj instance void TestApp.SealedClasses.ClassWithSealedMethod::.ctor()
    L_001d: stloc.2 
    L_001e: ldloc.2 
    L_001f: callvirt instance void TestApp.SealedClasses.ClassWithVirtualMethod::DoSmth()
    L_0024: ret 
} 
```

原因很简单：运行时必须在调用“DoSmth()”方法之前检查类型实例是否不等于 null。 **但是**我们仍然可以编写代码，使 C# 编译器能够发出优化的 IL 代码：

```
 public void Call()
    {
        new SealedClass().DoSmth();

        new ClassWithVirtualMethod().DoSmth();

        new ClassWithSealedMethod().DoSmth();
    } 
```

结果是：

```
.method public hidebysig instance void Call() cil managed
{
    .maxstack 8
    L_0000: newobj instance void TestApp.SealedClasses.SealedClass::.ctor()
    L_0005: call instance void TestApp.SealedClasses.SealedClass::DoSmth()
    L_000a: newobj instance void TestApp.SealedClasses.ClassWithVirtualMethod::.ctor()
    L_000f: callvirt instance void TestApp.SealedClasses.ClassWithVirtualMethod::DoSmth()
    L_0014: newobj instance void TestApp.SealedClasses.ClassWithSealedMethod::.ctor()
    L_0019: callvirt instance void TestApp.SealedClasses.ClassWithVirtualMethod::DoSmth()
    L_001e: ret 
} 
```

*如果你尝试以同样的方式调用非密封类的非虚方法，你也会得到“call”指令而不是“callvirt”*

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-26T16:57:28.733

如果 JIT 编译器看到对使用密封类型的虚拟方法的调用，它可以通过以非虚拟方式调用该方法来生成更高效的代码。现在调用非虚拟方法更快，因为不需要执行[vtable](http://en.wikipedia.org/wiki/Virtual_table)查找。恕我直言，这是微优化，应该作为提高应用程序性能的最后手段。如果您的方法包含任何代码，与执行代码本身的成本相比，虚拟版本将比非虚拟版本慢得可以忽略不计。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-26T17:12:03.103

为了扩展其他人的答案，不能扩展密封类（相当于 Java 中的 final 类）。这意味着，只要编译器看到使用此类的方法，编译器就绝对知道不需要运行时分派。它不必检查类来动态地查看层次结构中哪个类的哪个方法需要被调用。这意味着可以编译分支而不是动态的。

例如，如果我有一个`Animal`具有方法的非密封类，`makeNoise()`编译器不一定知道是否有任何`Animal`实例覆盖该方法。因此，每次任何`Animal`实例调用`makeNoise()`时，都需要检查实例的类层次结构，以查看该实例是否在扩展类中覆盖了此方法。

但是，如果我有一个`AnimalFeeder`具有方法的密封类`feedAnimal()`，那么编译器肯定知道该方法不能被覆盖。它可以在分支中编译到子程序或等效指令，而不是使用虚拟调度表。

注意：您可以在类上使用*来*`sealed`防止从该类继承，并且可以在基类中声明的方法上使用以防止进一步覆盖该方法。*`sealed``virtual`*

 ** * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-02-25T13:29:25.450

要真正看到它们，您需要分析**JIT 编译**的代码e（最后一个）。

**C# 代码**

```
public sealed class Sealed
{
    public string Message { get; set; }
    public void DoStuff() { }
}
public class Derived : Base
{
    public sealed override void DoStuff() { }
}
public class Base
{
    public string Message { get; set; }
    public virtual void DoStuff() { }
}
static void Main()
{
    Sealed sealedClass = new Sealed();
    sealedClass.DoStuff();
    Derived derivedClass = new Derived();
    derivedClass.DoStuff();
    Base BaseClass = new Base();
    BaseClass.DoStuff();
} 
```

**军用代码**

```
.method private hidebysig static void  Main() cil managed
{
  .entrypoint
  // Code size       41 (0x29)
  .maxstack  8
  IL_0000:  newobj     instance void ConsoleApp1.Program/Sealed::.ctor()
  IL_0005:  callvirt   instance void ConsoleApp1.Program/Sealed::DoStuff()
  IL_000a:  newobj     instance void ConsoleApp1.Program/Derived::.ctor()
  IL_000f:  callvirt   instance void ConsoleApp1.Program/Base::DoStuff()
  IL_0014:  newobj     instance void ConsoleApp1.Program/Base::.ctor()
  IL_0019:  callvirt   instance void ConsoleApp1.Program/Base::DoStuff()
  IL_0028:  ret
} // end of method Program::Main 
```

**JIT 编译代码**

```
--- C:\Users\Ivan Porta\source\repos\ConsoleApp1\Program.cs --------------------
        {
0066084A  in          al,dx  
0066084B  push        edi  
0066084C  push        esi  
0066084D  push        ebx  
0066084E  sub         esp,4Ch  
00660851  lea         edi,[ebp-58h]  
00660854  mov         ecx,13h  
00660859  xor         eax,eax  
0066085B  rep stos    dword ptr es:[edi]  
0066085D  cmp         dword ptr ds:[5842F0h],0  
00660864  je          0066086B  
00660866  call        744CFAD0  
0066086B  xor         edx,edx  
0066086D  mov         dword ptr [ebp-3Ch],edx  
00660870  xor         edx,edx  
00660872  mov         dword ptr [ebp-48h],edx  
00660875  xor         edx,edx  
00660877  mov         dword ptr [ebp-44h],edx  
0066087A  xor         edx,edx  
0066087C  mov         dword ptr [ebp-40h],edx  
0066087F  nop  
            Sealed sealedClass = new Sealed();
00660880  mov         ecx,584E1Ch  
00660885  call        005730F4  
0066088A  mov         dword ptr [ebp-4Ch],eax  
0066088D  mov         ecx,dword ptr [ebp-4Ch]  
00660890  call        00660468  
00660895  mov         eax,dword ptr [ebp-4Ch]  
00660898  mov         dword ptr [ebp-3Ch],eax  
            sealedClass.DoStuff();
0066089B  mov         ecx,dword ptr [ebp-3Ch]  
0066089E  cmp         dword ptr [ecx],ecx  
006608A0  call        00660460  
006608A5  nop  
            Derived derivedClass = new Derived();
006608A6  mov         ecx,584F3Ch  
006608AB  call        005730F4  
006608B0  mov         dword ptr [ebp-50h],eax  
006608B3  mov         ecx,dword ptr [ebp-50h]  
006608B6  call        006604A8  
006608BB  mov         eax,dword ptr [ebp-50h]  
006608BE  mov         dword ptr [ebp-40h],eax  
            derivedClass.DoStuff();
006608C1  mov         ecx,dword ptr [ebp-40h]  
006608C4  mov         eax,dword ptr [ecx]  
006608C6  mov         eax,dword ptr [eax+28h]  
006608C9  call        dword ptr [eax+10h]  
006608CC  nop  
            Base BaseClass = new Base();
006608CD  mov         ecx,584EC0h  
006608D2  call        005730F4  
006608D7  mov         dword ptr [ebp-54h],eax  
006608DA  mov         ecx,dword ptr [ebp-54h]  
006608DD  call        00660490  
006608E2  mov         eax,dword ptr [ebp-54h]  
006608E5  mov         dword ptr [ebp-44h],eax  
            BaseClass.DoStuff();
006608E8  mov         ecx,dword ptr [ebp-44h]  
006608EB  mov         eax,dword ptr [ecx]  
006608ED  mov         eax,dword ptr [eax+28h]  
006608F0  call        dword ptr [eax+10h]  
006608F3  nop  
        }
0066091A  nop  
0066091B  lea         esp,[ebp-0Ch]  
0066091E  pop         ebx  
0066091F  pop         esi  
00660920  pop         edi  
00660921  pop         ebp  

00660922  ret 
```

虽然对象的创建是相同的，但调用密封类和派生类/基类的方法所执行的指令略有不同。将数据移入寄存器或RAM（mov指令）后，调用密封方法，执行dword ptr [ecx]，ecx（cmp指令）之间的比较，然后调用该方法，而派生/基类直接执行该方法。 .

根据 Torbj¨orn Granlund 撰写的报告，**AMD 和 Intel x86 处理器的指令延迟和吞吐量，** Intel Pentium 4 中以下指令的速度为：

*   **mov**：有 1 个周期作为延迟，处理器每个周期可以支持 2.5 条这种类型的指令
*   **cmp**：有 1 个周期作为延迟，处理器可以在这种类型的每个周期中维持 2 条指令

**链接**：[https ://gmplib.org/~tege/x86-timing.pdf](https://gmplib.org/~tege/x86-timing.pdf)

这意味着，**理想情况下**，调用密封方法所需的时间是 2 个周期，而调用派生类或基类方法所需的时间是 3 个周期。

编译器的优化使得密封类和非密封类的性能差异如此之低，以至于我们正在谈论处理器圈，因此与大多数应用程序无关。

# html - HTML 表单方法 = HASH？

> ID：911686
> 
> 赞同：1
> 
> 时间：2009-05-26T16:54:37.023
> 
> 标签：html, forms, hash

如果我将我的 Form 方法设置为 GET，它将发送如下所示的操作页面：

```
action_page.php?key=value&foo=bar 
```

但是有没有办法让它像这样发送：

```
action_page.php#key=value&foo=bar 
```

因为接收值的页面依赖于散列变量。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T17:14:11.150

您可以设置一个像这样重定向数据的“中间人”页面

**中间人.php：**

```
<?php

$string = 'realpage.php#' . $_SERVER['QUERY_STRING'];

header('location: ' . $string);

?> 
```

所以在你的表格中你会这样做：

```
<form action="middleman.php" method="get"> 
```

这将发送到 middleman.php，然后将使用哈希重定向到 realpage.php。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T16:56:09.533

您可以通过附加到以下内容使用 javascript 来做这样的事情：

```
window.location.hash 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T16:57:24.367

您可以使用 javascript 从表单值动态创建 URL 参数。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-26T21:42:32.777

您*确定*该页面依赖于“哈希变量”吗？那将是设计系统的一种非常奇怪的方式。尤其是哈希后的元素，并不能保证浏览器会发送给服务器，事实上在大多数情况下也不会。这意味着您的 PHP 脚本将永远不会收到变量。

# .net - LinqToSql 中的标量函数

> ID：911687
> 
> 赞同：2
> 
> 时间：2009-05-26T16:54:57.553
> 
> 标签：.net, linq-to-sql, scalar

在 ADO.Net/SQLClient 我经常会做这样的事情：

`SELECT COUNT(*) FROM SomeTable WHERE SomeKey = 1234`

...并使用 executescalar 触发它以返回 count 的值 - 用于简单检查是否存在某些东西。

我将如何使用 LinqToSql 做同样的事情？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-26T16:56:36.270

```
if (context.SomeTable.Any(row => row.SomeKey == 1234))
{
    DoStuff();
} 
```

你也可以使用`Count()`.

```
if (context.SomeTable.Count(row => row.SomeKey == 1234) > 0)
{
    DoStuff();
} 
```

但这需要始终遍历所有行，同时`Any()`可以在第一个匹配行之后返回 - 所以`Any()`可能会有更好的性能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T16:58:05.130

请记住，Linq to Sql 是延迟执行，这意味着，只有在您访问集合时查询才会真正执行。所以：

```
var q = (from p in db.SomeTable
        where p.SomeKey == 1234
        select p).Count(); 
```

将在 SQL 方面变成一个 SELECT Count() 。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T17:01:27.213

如果您想查看是否存在某些东西，您可以使用 any 函数：

```
if (context.SomeTable.Any(i => i.SomeKey == 1234))
{
    return true;
} 
```

或者如果您真的想知道该计数，您可以使用 where 函数和 count 函数：

```
context.SomeTable.Where(i=> i.SomeKey == 1234).Count(); 
```

# javascript - Javascript 'onkey*' 事件在链接浏览器中不起作用

> ID：911698
> 
> 赞同：1
> 
> 时间：2009-05-26T16:57:22.620
> 
> 标签：javascript, browser, hyperlink, dom-events

有人知道Links浏览器吗？我正在为使用 Linux 的终端上运行的链接（文本模式）开发应用程序。问题是没有任何“on key”事件（向下、向上或按下）将注册。这是我正在使用的 Javascript：

```
<body onload="Alert()" onkeydown="CheckKey(event.keyCode)">

    <script type="text/javascript">

       function CheckKey(keycode) {
          alert(keycode)
       }

       function Alert(){
           alert("onload is working")
       }  

    </script>

    <!--A table goes here-->

</body> 
```

onload 事件工作正常，所以我知道浏览器启用了 Javascript，但 onkeydown 事件什么也不做。问题是，我不知道这是否是链接、Javascript 的问题，甚至可能是它运行的终端的限制。是否有不支持“onkey”事件的 Javascript 版本？只是一个想法...

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T17:01:25.793

我不认为他们会工作。链接使用键命令进行自己的导航，我认为它只是没有将它们传递给您的脚本。

# sql - 远离 STI - SQL 将单表分解为新的多表结构

> ID：911703
> 
> 赞同：0
> 
> 时间：2009-05-26T16:57:32.493
> 
> 标签：sql, mysql, database, database-design, foreign-keys

我正在将使用单表继承的旧项目移动到一个更加结构化的新数据库中。我将如何编写一个 SQL 脚本来移植它？

**旧结构**

为了便于阅读，我已经简化了 SQL。

```
CREATE TABLE customers (
  id int(11),
  ...
  firstName varchar(50),
  surname varchar(50),

  address1 varchar(50),
  address2 varchar(50),
  town varchar(50),
  county varchar(50),
  postcode varchar(50),
  country varchar(50),

  delAddress1 varchar(50),
  delAddress2 varchar(50),
  delTown varchar(50),
  delCounty varchar(50),
  delPostcode varchar(50),
  delCountry varchar(50),

  tel varchar(50),
  mobile varchar(50),
  workTel varchar(50),
); 
```

**新结构**

```
CREATE TABLE users (
  id int(11),
  firstName varchar(50),
  surname varchar(50),
  ...
);

CREATE TABLE addresses (
  id int(11),

  ForeignKey(user),
  street1 varchar(50),
  street2 varchar(50),
  town varchar(50),
  county varchar(50),
  postcode varchar(50),
  country varchar(50),
  type ...,
);

CREATE TABLE phone_numbers (
  id int(11),
  ForeignKey(user),
  number varchar(50),
  type ...,
); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T17:20:51.777

如果合适，为表引用使用适当的跨数据库表示法：

```
INSERT INTO Users(id, firstname, surname, ...)
    SELECT id, firstname, surname, ...
        FROM Customers;
INSERT INTO Addresses(id, street1, street2, ...)
    SELECT id, street1, street2, ...
        FROM Customers;
INSERT INTO Phone_Numbers(id, number, type, ...)
    SELECT id, phone, type, ...
        FROM Customers; 
```

如果您想要新地址和旧地址（del* 版本），则在具有适当标记的两组源列上重复地址操作。同样，对于三个电话号码，重复电话号码操作。或者在每种情况下使用 UNION。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T17:29:57.747

首先确保备份您现有的数据！

如果您要使用原始 id 字段或生成新字段，则该过程有所不同。

假设您要使用原始的，请确保您能够在开始之前将 id 字段插入表中（如果您要自动生成数字，则 SQL Server 等效项是 Set identity Insert on，不确定 mysql 会使用什么） . 将旧表中的插入写入父表：

```
insert newparenttable (idfield, field1, field2) 
select idfield, field1, field2 from old parent table 
```

然后根据您需要的字段为所有子表编写类似的插入。例如，如果您在不同的字段中有多个电话号码，则可以使用 union all 语句作为插入选择。

```
Insert newphone (phonenumber, userid, phonetype)
select home_phone, id, 100 from oldparenttable
union all
select work_phone, id, 101 from oldparenttable
Union all
select cell_phone, id, 102 from oldparenttable 
```

如果您要生成一个新的 id，则创建一个包含旧 id 字段的表。你可以在最后放弃它（尽管我会保留它大约六个月）。然后，您可以在 oldid 上从新父表连接到旧父表，并在插入子表时从新父表中获取新 id。就像是：

```
Insert newphone (phonenumber, userid, phonetype)
select home_phone, n.id, 100 from oldparenttable o
    join newparenttable n on n.oldid = o.id
union all
select work_phone, n.id, 101 fromoldparenttable o
    join newparenttable n on n.oldid = o.id
Union all
select cell_phone, n.id, 102 from oldparenttable o
    join newparenttable n on n.oldid = o.id 
```

# asp.net - ASP.Net 中继器控件

> ID：911710
> 
> 赞同：1
> 
> 时间：2009-05-26T16:58:43.223
> 
> 标签：asp.net, repeater

我一直在尝试我所知道的一切来更改 asp:repeater 控件中一行的颜色。我想要做的是：基于一个值，我希望能够在转发器控件中设置记录的颜色。我试过 DIV 标签，不能让它工作。我该怎么做？塔克斯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-26T17:44:24.847

使用 ItemTemplate 中的 <%# %> 数据绑定语法进行条件格式化：

```
<asp:Repeater runat="server" ID="rpt">
  <ItemTemplate>
    <div class="<%# Container.ItemIndex % 2 ? "even" : "odd" %>">
    </div>
    <div class="<%# Eval("PropertyOfDataSource") %>">
    </div>
  </ItemTemplate>
</asp:Repeater> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-26T17:14:57.140

在后面的代码中尝试这样的事情

```
 protected void rpt_OnItemDataBound(object sender, RepeaterItemEventArgs e)
    {
        if (e.Item.DataItem != null)
        {
            string color = (string)DataBinder.Eval(e.Item.DataItem, "RowColor");
            HtmlTableRow rowToColor = (HtmlTableRow)e.Item.FindControl("Row");
            rowToColor.Attributes.CssStyle.Add("background-color", color );
        }
    } 
```

和类似的东西在aspx页面

```
<asp:Repeater ID="rpt" runat="server" OnItemDataBound="rpt_OnItemDataBound">
    <ItemTemplate>
        <tr id="Row" runat="server">
            <td>
            &nbsp;
            </td>
        </tr>
    </ItemTemplate>
</asp:Repeater> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T17:40:24.873

您可以通过很多不同的方式来解决这个问题，并且根据您的中继器需要的外观或您发送给它的数据，没有最佳答案。这是一个 hack 解决方法，它将评估数据并比较它以获得正确的颜色响应。

在转发器的项目模板中，用 div 将其包围。

```
<div style="background-color:<%# GetBG((string)(DataBinder.Eval(Container.DataItem,"DataField")))%>"> 
```

并且在后面的代码中有一个函数来决定

```
public string GetBG(string demo)
    {

        if (demo == "TestData2")
            return "yellow";
        return "Green";
    } 
```

这不是一个很好的方法，而且非常浪费。onDataBind 函数将是更好的方法，只是想展示另一种完成此任务的方法。

# objective-c - 如何让按钮在大纲视图中删除带有核心数据的行？

> ID：911712
> 
> 赞同：0
> 
> 时间：2009-05-26T16:59:12.287
> 
> 标签：objective-c, cocoa

我有一个大纲视图，其中显示了 2 个实体，因此它连接到 NSTreeController。我创建了一个按钮并将其绑定到可用性>已启用下的 NSTreeController 的控制器键“canRemove”。但是，当您运行应用程序时，即使在大纲视图中选择了一行，该按钮也始终处于禁用状态。如何解决此问题并删除大纲视图中的选定行？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-26T17:31:35.827

您需要将按钮的目标设置为树控制器，并将其操作设置为`remove:`. 这在 IB 中很容易：右键单击树控制器，然后从其`remove:`操作（特别是从行右边缘的圆圈）拖动到“删除”按钮。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T03:23:50.357

树控制器上是否启用了“可编辑”？

# c# - 拆分字符串，转换 ToList () 一行

> ID：911717
> 
> 赞同：230
> 
> 时间：2009-05-26T17:00:15.983
> 
> 标签：c#, list, split

我有一个有数字的字符串

```
string sNumbers = "1,2,3,4,5"; 
```

我可以拆分它然后将其转换为`List<int>`

```
sNumbers.Split( new[] { ',' } ).ToList<int>(); 
```

如何将字符串数组转换为整数列表？这样我就可以转换`string[]`为`IEnumerable`

* * *

## 回答 #1

> 赞同：555
> 
> 时间：2009-05-26T17:03:03.997

```
var numbers = sNumbers.Split(',').Select(Int32.Parse).ToList(); 
```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2014-01-17T12:33:26.430

您也可以在不需要 Linq 的情况下这样做：

```
List<int> numbers = new List<int>( Array.ConvertAll(sNumbers.Split(','), int.Parse) );

// Uses Linq
var numbers = Array.ConvertAll(sNumbers.Split(','), int.Parse).ToList(); 
```

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2018-09-26T19:00:59.507

更好地使用`int.TryParse`以避免异常；

```
var numbers = sNumbers
            .Split(',')
            .Where(x => int.TryParse(x, out _))
            .Select(int.Parse)
            .ToList(); 
```

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2014-08-11T07:22:00.440

Joze 的方式也需要 LINQ，`ToList()`是在`System.Linq`命名空间中。

通过将数组传递给 List 构造函数，您可以在没有 Linq 的情况下将 Array 转换为 List：

```
List<int> numbers = new List<int>( Array.ConvertAll(sNumbers.Split(','), int.Parse) ); 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2016-05-18T07:00:44.750

也可以通过 int 数组直接赋值。

像这样

```
int[] numbers = sNumbers.Split(',').Select(Int32.Parse).ToArray(); 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2016-10-13T10:05:06.213

您可以使用新的 C# 6.0 语言功能：

*   `(s) => { return Convert.ToInt32(s); }`用相应的方法组替换委托`Convert.ToInt32`
*   将多余的构造函数调用：替换`new Converter<string, int>(Convert.ToInt32)`为：`Convert.ToInt32`

结果将是：

```
var intList = new List<int>(Array.ConvertAll(sNumbers.Split(','), Convert.ToInt32)); 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2016-02-02T10:44:10.747

您也可以使用此扩展方法

```
public static List<int> SplitToIntList(this string list, char separator = ',')
{
    return list.Split(separator).Select(Int32.Parse).ToList();
} 
```

用法：

```
var numberListString = "1, 2, 3, 4";
List<int> numberList = numberListString.SplitToIntList(','); 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2015-11-20T03:19:06.243

在 Unity3d 上，`int.Parse`效果不佳。所以我像下面这样使用。

```
List<int> intList = new List<int>( Array.ConvertAll(sNumbers.Split(','),
 new Converter<string, int>((s)=>{return Convert.ToInt32(s);}) ) ); 
```

希望这对 Unity3d 用户有所帮助。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-04-14T17:05:36.853

我的问题很相似，但有时字符串包含字母（有时为空）带来了不便。

```
string sNumbers = "1,2,hh,3,4,x,5"; 
```

尝试遵循 Pcode Xonos 扩展方法：

```
public static List<int> SplitToIntList(this string list, char separator = ',')
{
      int result = 0;
      return (from s in list.Split(',')
              let isint = int.TryParse(s, out result)
              let val = result
              where isint
              select val).ToList(); 
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-09-30T13:40:49.453

当我们有泛型时，为什么只坚持 int ？像这样的扩展方法呢：

```
 public static List<T> Split<T>(this string @this, char separator, out bool AllConverted)
    {
        List<T> returnVals = new List<T>();
        AllConverted = true;
        var itens = @this.Split(separator);
        foreach (var item in itens)
        {
            try
            {
                returnVals.Add((T)Convert.ChangeType(item, typeof(T)));
            }
            catch { AllConverted = false; }
        }
        return returnVals;
    } 
```

进而

```
 string testString = "1, 2, 3, XP, *, 6";
 List<int> splited = testString.Split<int>(',', out _); 
```

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2016-08-01T05:52:39.167

你可以使用这个：

```
List<Int32> sNumberslst = sNumbers.Split(',').ConvertIntoIntList(); 
```

# jquery - 字符串上的 jQuery 选择器仅在被 div 包围时才有效

> ID：911718
> 
> 赞同：10
> 
> 时间：2009-05-26T17:00:21.007
> 
> 标签：jquery

为什么这行得通？

```
$('#findme', '<div><div id="findme">Hello</div></div>') 
```

这不是吗？

```
$('#findme', '<div id="findme">Hello</div>') 
```

出于某种原因，只有当我有封闭的 div 时，jQuery 才会找到 ID 为 findme 的 div。

即使将其包含在不同的标签中也不起作用。

```
$('#findme', '<html><div id="findme">Hello</div></html>') 
```

此外以下不起作用。

```
$('<div id="findme">Hello</div>').find('#findme')
$('<html><div id="findme">Hello</div></html>').find('#findme') 
```

虽然这行得通。

```
$('<div><div id="findme">Hello</div></div>').find('#findme') 
```

关于上下文的工作原理，我有些不明白。

谢谢，兰德尔

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-26T17:03:20.063

实际上这很容易。您搜索的方式是使用上下文。所以它获取字符串中最顶层的节点，并搜索它的子节点。

所以想象在 html 中具有相同的结构，并对其进行解析：

```
$('#findme', '<div><div id="findme"></div></div>') 
```

是相同的

```
$('div').find('#findme') 
```

**或者**

```
$('div').children('#findme') 
```

* * *

所以当你尝试

```
$('<div id="findme"></div>').find('#findme') 
```

它显然没有孩子。

# maven-2 - 使用 maven2 编译时将清单添加到 jar 文件

> ID：911721
> 
> 赞同：4
> 
> 时间：2009-05-26T17:00:48.650
> 
> 标签：maven-2, compiler-construction, maven-plugin

我对 POM.xml 文件进行了以下更改，以添加我保存在 \resources\META-INF 中的清单文件，但无法创建可执行的 jar 文件。

```
<build>
  <plugins>
    <plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-compiler-plugin</artifactId>
    <version>2.0.2</version>
    <configuration>
        <source>1.5</source>
        <target>1.5</target>
          <archive>
            <manifest>
            <mainClass>com.mypackage.myMainClass</mainClass>
            <!--addClasspath>false</addClasspath-->
            </manifest>
            <manifestFile>src/main/resources/META-INF/MANIFEST.MF</manifestFile>
          </archive>
        </configuration>
    </plugin>
  </plugins>
</build> 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T17:05:15.863

使用[maven-assembly-plugin](http://maven.apache.org/plugins/maven-assembly-plugin/)。

**示例**：

```
<build>
    <plugins>
        <plugin>
            <artifactId>maven-assembly-plugin</artifactId>
            <configuration>
                <descriptorRefs>
                    <descriptorRef>jar-with-dependencies</descriptorRef>
                </descriptorRefs>
                <archive>
                    <manifest>
                        <mainClass>foo.bar.Main</mainClass>
                    </manifest>
                </archive>
            </configuration>
        </plugin>
     </plugins>
</build> 
```

# sql - ms-access：运行时错误 3354

> ID：911726
> 
> 赞同：1
> 
> 时间：2009-05-26T17:02:07.600
> 
> 标签：sql, ms-access

我在 ms-access 中运行 sql 时遇到问题。我正在使用此代码：

```
SELECT readings_miu_id, ReadDate, ReadTime, RSSI, Firmware, Active, OriginCol, ColID, Ownage, SiteID, PremID, prem_group1, prem_group2  
INTO analyzedCopy2  
FROM analyzedCopy AS A 
WHERE ReadTime =  (SELECT TOP 1 analyzedCopy.ReadTime FROM analyzedCopy  WHERE analyzedCopy.readings_miu_id = A.readings_miu_id  AND analyzedCopy.ReadDate = A.ReadDate  ORDER BY analyzedCopy.readings_miu_id, analyzedCopy.ReadDate, analyzedCopy.ReadTime)
ORDER BY A.readings_miu_id, A.ReadDate ; 
```

在此之前，我正在根据特定标准从其他表中填写analyzedCopy 表。对于一组标准，此代码可以正常工作，但对于其他标准，它不断给我运行时错误“3354”。我能看到的唯一区别是，在标准有效的情况下，表格大约有 4145 条记录长，而在标准不起作用的情况下，我使用此代码的表格超过 9000 条记录。有什么建议么？

有没有办法告诉它只提取一半的信息，然后在我从中拉出的表的另一半上运行相同的选择字符串，并将这些结果添加到前半部分的先前结果中？

运行时错误'3354'的全文是“此子查询最多可以返回一条记录”。

我只是尝试在前 4000 条记录上运行此查询，但它再次失败并出现相同的错误代码，所以它不可能是我认为的记录数量。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-26T19:29:06.993

看到这个：

[http://allenbrowne.com/subquery-02.html#AtMostOneRecord](http://allenbrowne.com/subquery-02.html#AtMostOneRecord)

发生的事情是您的子查询返回两条相同的记录（基于 ORDER BY），而 TOP 1 实际上返回两条记录（是的，这就是 TOP 语句的访问方式）。您需要向 ORDER BY 添加字段以使其唯一 - 最好使用唯一 ID（您确实有唯一的 PK，不是吗？）

正如 Andomar 下面所说的 DISTINCT TOP 1 也将起作用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T21:10:29.520

运行子查询时 MS-ACCESS 返回什么？

```
SELECT TOP 1 analyzedCopy.ReadTime 
FROM analyzedCopy
WHERE analyzedCopy.readings_miu_id = A.readings_miu_id  
AND analyzedCopy.ReadDate = A.ReadDate  
ORDER BY analyzedCopy.readings_miu_id, analyzedCopy.ReadDate, 
         analyzedCopy.ReadTime 
```

如果它返回多行，也许可以用 DISTINCT 修复：

```
SELECT DISTINCT TOP 1 analyzedCopy.ReadTime 
FROM ... rest of query ... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T17:55:49.397

我不知道这是否可行（而且我不再有 Access 的副本来测试），所以如果我离开了，我先道歉。

首先，只需在analyzedCopy的主键上进行选择，即可得到中点ID。就像是：

```
SELECT TOP 4500 readings_miu_id FROM analyzedCopy ORDER BY readings_miu_id, ReadDate; 
```

然后，当您拥有中点 ID 时，您可以将其添加到原始语句的 WHERE 语句中：

```
SELECT ...
INTO ...
FROM ...
WHERE ... AND (readings_miu_id <= {ID from above}
ORDER BY ... 
```

然后选择另一半：

```
SELECT ...
INTO ...
FROM ...
WHERE ... AND (readings_miu_id > {ID from above}
ORDER BY ... 
```

再次，对不起，如果我离开了。

# c# - 如何创建带有嵌入式关闭按钮的按钮

> ID：911735
> 
> 赞同：1
> 
> 时间：2009-05-26T17:05:14.817
> 
> 标签：c#, winforms, infragistics

我正在尝试创建一个面板，上面有一组“按钮”。

这些按钮应具有以下行为：

1.  外观类似于标签（带有圆形边缘）
2.  包含一个红十字以从面板中删除过滤器/标签，类似于 Internet Explorer 选项卡具有嵌入式十字以关闭单个选项卡的方式。
3.  允许用户点击标签并像普通按钮一样响应（只要点击不在红十字内）

数字 1 没问题，这只是外观，但是，关于数字 2 和 3，我不确定是否已经有代码可以做类似的事情……如果可以避免的话，我真的不想重新发明轮子它！

我的问题是：有谁知道基础设施中是否有一些东西可以简单地做到这一点，还是我需要通过子类化winform按钮自己编写这个？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T21:56:40.517

这是对现有项目的新开发还是维护？

如果是维护，您将面临更艰难的时期。您将实现一个`UserControl`，可能被分割成两个按钮。使用对接使行为尽可能正确。最右边的按钮将包含您的十字图像；左侧（在您调整控件大小时需要自动扩展）将包含您的主要按钮行为。玩弄视觉风格，直到你把它们弄好（例如，删除边框等）。

如果这是一项新开发，并且您还没有深入了解它，您可能会*考虑*使用 Windows Presentation Framework (WPF) 而不是 WinForms。构建控件并让它看起来完全符合您的要求会更容易。WPF 包含一个极其强大的控件合成系统，它允许您将多个控件叠加在一起并让它们完全按照您的预期工作，并且它还具有允许开箱即用的完全可视控制的额外优势。

无论哪种方式，这都比放入外部组件更费力……我已经使用 Infragistics 多年了，我想不出他们有什么可比的。最接近但**仅**当您正在构建 MDI 应用程序并且这些控件用于窗口导航时，是选项卡式 MDI 窗口管理工具——在那里，只有选项卡（替换窗口标题栏）具有此行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T21:43:01.590

我不认为基础设施可以做这样的事情。UltraButton 控件不能。实现自己的控件并不难。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T18:26:50.830

您可能必须为此类工作进行服装控制。

# perforce - 如何使用 Perforce 查找上周为特定用户提交的更改列表？

> ID：911739
> 
> 赞同：9
> 
> 时间：2009-05-26T17:05:41.260
> 
> 标签：perforce

有没有办法让 Perforce 列出特定用户在特定时间范围内提交的所有更改列表？

**p4 changes @2001/04/01,@now** 这列出了从 4 月 1 日到现在提交的所有更改。

**p4 changes -m 5 -u edk** 显示用户 edk 最近提交的五个变更列表。

有没有办法将以上两者结合起来用于特定目录？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-26T17:21:32.943

您可以像这样组合它们：

**p4 更改 -m 5 -u edk -s 提交 @2001/04/01,@now**

要指定目录：

**p4 更改 -m 5 -u edk -s 提交 //depot/path/to/directory/...@2001/04/01,@now**

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-09-21T17:06:30.533

如果您使用的是 bash，则可以编写整个命令的脚本：

```
p4 changes -l -i -m 50 -u $USERNAME -s submitted @`date --date="1 week ago" +"%Y/%m/%d"`,@now 
```

（我也`-l`用来包含完整的提交消息。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-10-15T04:58:16.253

如果您想在特定时间范围内进行更改，

示例：p4 更改 -u abc -s 提交 @2015/09/01:12:02:49,2015/10/01:11:20:55

这应该列出在给定时间范围内提交的“abc”更改，即从：2015/09/01 12:02:49 到 2015/10/01 11:20:55。请注意连接日期和时间的“：”。

# c++ - 关于隐藏成员变量的警告？

> ID：911740
> 
> 赞同：9
> 
> 时间：2009-05-26T17:05:49.637
> 
> 标签：c++, gcc

下面的代码片段有一个内存泄漏，我花了太多时间追查。问题是在Foo()内部，局部变量x_隐藏了成员变量x_。这也很烦人，因为编译器可能会警告我。GCC 中是否有此类警告的标志？（出于好奇：我首先使用局部变量，然后将其更改为成员变量，但忘记删除类型声明，从而得到了错误代码。）

```
struct A {
  A() x_(NULL) {}

  ~A() {
    delete x_;
  }

  void Foo() {
    HugeThingy* x_ = new HugeThingy();
    x_->Bar("I. Need. Garbage. Collection. Now.");
  }

  HugeThingy* x_;

  DISALLOW_COPY_AND_ASSIGN(A);  // Macro to prevent copy/assign.
} 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-26T17:11:13.807

使用-Wshadow。

顺便说一句，-W 和 -Wall 都不会启用 -Wshadow。

让编译器帮助避免此类问题很好，但是如果您使用有助于避免首先创建它的约定，例如`x_`为成员变量而不是局部变量保留表单的名称，那甚至都没有必要。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-26T17:12:05.630

FWIW 我不会有这个问题，因为我使用命名约定来区分成员数据和局部变量：我的成员数据标识符总是以`m_`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T04:13:37.503

我们在名称的开头使用这些疣 - a_ 参数 d_ 数据成员 s_ 类中的静态数据 f_ 文件中的静态数据

...并且局部变量没有疣。

真的，Lakos 的书是你的朋友。

# asp.net - Web App 有 My.Application.Log 而不是 My.Log

> ID：911747
> 
> 赞同：0
> 
> 时间：2009-05-26T17:06:49.167
> 
> 标签：asp.net, logging, asp.net-3.5

根据 MSDN 文档 ( [http://msdn.microsoft.com/en-us/library/ms172987.aspx)，My.Application.Log](http://msdn.microsoft.com/en-us/library/ms172987.aspx)属性用于为客户端应用程序编写日志条目，而 My.Log 属性用于为 Web 应用程序编写日志条目。但是，我有一个 Web 应用程序，其中包含 .aspx.vb 文件中的一堆 My.Application.Log 调用。这些编译正确，但如果我将它们更改为 My.Log，则会出现编译错误。有谁知道为什么会这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-09-23T10:32:21.477

我也有这个问题。当您从一种 Windows 应用程序的库 (dll) 写入日志时，这似乎会发生。

你使用DLL吗？

# c# - 这是MVC吗？我使用了什么“设计模式”？

> ID：911752
> 
> 赞同：3
> 
> 时间：2009-05-26T17:09:18.023
> 
> 标签：c#, design-patterns, model-view-controller

对 MVC 有很多困惑，但是在浏览了 Head First 模式书之后（作为旁注，我讨厌那个品牌，虽然这个例子非常好）它声称 MVC 或模型视图控制器是多种模式的混合体 - 中介，观察者等...

在最近的一个原型中，我做了以下操作，它是 C#，但应该很简单。

```
Person : IPerson {
    public Name { get; set;}
    public Age  { get; set;}
} 
```

IPerson 只是一个定义上述内容的接口——为了简单起见，我把它省略了。

```
PersonController : IPersonController {
    public event DetailsUpdated;
    public void SetAge(int age);
    public int GetAge();
    public void SetName(string name);
    public string GetName();
} 
```

我知道上面可能是属性本身 - 但这只是一个简单的例子。每次某些数据更改时都会触发该事件 - 例如在 SetAge/SetName 中。

```
interface IView {
    void Initialize();
    void SetAgeClicked(object sender, EventArgs e);
    void SetNameClicked(object sender, EventArgs e);
} 
```

初始化电线 - 例如表单上的文本框。SetAge/SetName 是按钮事件 - 所以表单/页面等使用必须有这些方法。

```
Form : IView {

    // IView is implemented.
    // Form is wired up
    // Initialize is set etc...
} 
```

我听说 MVC 的测试是当您添加一个新视图时，是否很容易启动和运行东西 - 是的，确实如此。然而，这是 MVC 吗？这是别的吗？

任何建议/意见都会很棒。它有效——它只是想知道为什么。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T17:15:23.627

我会投票给别的东西。

我这么说的原因是关于什么是 MVC 存在大量争论。

请参阅[什么是控制器？](http://c2.com/cgi/wiki?WhatsaControllerAnyway)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T17:57:39.830

我会说你所拥有的比 MVC 更类似于 MVP（Model-View-Presenter）。MVP 有两个主要品种……监督控制器和被动视图。您在这里所拥有的似乎最接近 Passive View，这是一个非常经典的 MVP 实现，人们使用它来改进和抽象 WebForms。您可以在此处阅读有关 WebForms MVP 实现的更多信息：

[http://haacked.com/archive/2006/08/09/ASP.NETSupervisingControllerModelViewPresenterFromSchematicToUnitTestsToCode.aspx](http://haacked.com/archive/2006/08/09/ASP.NETSupervisingControllerModelViewPresenterFromSchematicToUnitTestsToCode.aspx)

同样的一般想法也适用于 Windows 窗体。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T17:53:10.260

虽然这是您那里的 MVC 实现，但它没有使用[Microsoft 制造和最近发布](http://www.asp.net/mvc/)的 . 如果您想了解历史，请从 Scott Gutherie 那里获得[概述。](http://weblogs.asp.net/scottgu/archive/2007/10/14/asp-net-mvc-framework.aspx)有些人可能将其称为 MVP，而不是 Controller，该部分称为 Presenter，通常处理业务逻辑和用户交互。

# maven-2 - maven build 执行 svn get

> ID：911757
> 
> 赞同：4
> 
> 时间：2009-05-26T17:10:53.200
> 
> 标签：maven-2, version-control, maven-plugin, maven-scm

我有一个项目构建，需要在构建过程中包含来自另一个 svn 位置的文件。我想执行一个 svn get 然后将这些文件复制到构建的适当文件夹中。研究这个问题似乎我可以使用 ant 任务，但我想找出可能是这个构建的最佳方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T17:18:51.187

您可以使用[maven-scm-plugin](http://maven.apache.org/scm/plugins/index.html)。根据[scm 矩阵](http://maven.apache.org/scm/matrix.html)，允许检出和更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-30T15:37:05.500

罗伯特的回答很好，如果项目很大，虽然你会检查很多内容来获取单个文件。

如果您想从 SCM 获取单个文件，[Maven SCM API](http://maven.apache.org/scm/maven-scm-api/index.html)允许您直接与 SCM 存储库交互以调用任意目标。在这个[相关的答案](https://stackoverflow.com/questions/1130365/maven-commit-single-artifact-to-svn-repository/1131279#1131279)中，我提供了一个提交单个文件的自定义 Mojo 示例，如果您实现该 mojo 并将命令从*add*更改为*checkout*，您将避免签出整个项目。

# flash - Papervision：Collada 对象上的 MovieMaterial

> ID：911762
> 
> 赞同：1
> 
> 时间：2009-05-26T17:12:01.573
> 
> 标签：flash, video, 3d, papervision3d, collada

是否可以将 MovieMaterial 放在 Papervision 中导入的 Collada 对象上？我在互联网上找不到任何关于此事的信息，我自己尝试的任何东西都是徒劳的......

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T19:39:49.780

DisplayObject3D 有一个“replaceMaterialByName(material:MaterialObject3D, name:String):void”方法可以让你这样做。希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-24T23:11:16.233

我认为 DisplayObject3D 也允许你说

```
DisplayObject3D.material = new MovieMaterial(new arbitraryMovieClip(), false, true); 
```

我没有看任何东西就输入了它，所以它可能有错字，我昨天只是在一个球体上做了

# rest - ATOM 为“企业”提供消息服务

> ID：911766
> 
> 赞同：4
> 
> 时间：2009-05-26T17:12:15.303
> 
> 标签：rest, jms, message-queue, atom-feed

我参加了[Jim Webber](http://jim.webber.name/)的演示，在他的演示中，他说 ATOM 在许多情况下是 JMS 的一个很好的替代品。由于 JMS 是一种消息传递服务，我对此很好奇。你们使用 ATOM 作为消息服务吗？它可靠且可扩展吗？

JMS 的最大优点是它使用 push 方法（服务器通知新消息）而不是 pull 方法（客户端每 X 毫秒不断请求新消息）。我认为对于“Web 2.0”应用程序，这种方法很酷，但对于“企业”应用程序，推送方法的可扩展性要高得多。你们有什么感想？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T19:19:19.837

为什么你认为 push 比 pull 更“可扩展”？

其次，这是一个相当广泛的问题，如果轮询间隔没有意义，一些实时应用程序必须使用推送（我需要亚秒级响应时间并且不想每 100 毫秒轮询一次）。但在大多数情况下，我总是发现 pull 更具可扩展性且更易于实现。我们将 Atom Pub/Syndication 格式用于“消息”类型的基础架构——它允许客户端赶上他们可能错过的旧消息（使用 JMS 更难做到）。将消息发布到 Atom 集合（提要），然后每当用户启动他们的客户端时，他们就可以轮询提要并查看新内容。也许他们只关心每小时、每天查看更新——所有这些都在客户端更容易完成——在发布消息的服务器和使用它们的客户端之间没有任何交互。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-10T20:19:02.247

您正在将苹果与橙子进行比较。

JMS 是 Java 程序使用可靠的点对点和发布-订阅消息传递代理的标准 API。

Atom 是一种基于 XML 的数据格式，用于表示新闻提要。

如果您愿意，可以使用 JMS 发送包含 Atom 格式数据的消息。但是，这并没有多大意义，因为 Atom 提要的内容包括让客户确定哪些提要项目是新的以及他们上次轮询时已经下载的信息。发布-订阅代理会为您执行此操作，因此发布-订阅通知可以只包含订阅者感兴趣的新信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T19:47:18.640

Push 或 Pull 是否适用于给定问题在很大程度上取决于延迟要求、正在传输的数据量、节点可用性以及问题的其他特定属性。不要让任何人告诉你任何一个总是比另一个更好。

# asp.net - 锚定到asp.net页面中的单击项目

> ID：911769
> 
> 赞同：0
> 
> 时间：2009-05-26T17:13:01.400
> 
> 标签：asp.net, html

我在 asp.net 页面“A”上有一个数据网格，它显示不同的客户订单。单击任意行/OrderId 时，用户将被重定向到显示订单详细信息的另一页“B”。当用户在页面 B 上单击“返回页面 A”时，我需要在页面 A 上具有相同的订单 ID“锚定”。如何在 asp.net 中实现此功能？

谢谢阅读。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T17:22:43.830

乔尔的回答是正确的，但是，如果您有更复杂的场景，您可以执行以下操作。

修改页面 A 上的显示以呈现`<a name="myRecord" />`网格的每一行。

在页面 B 上，您可以重定向回页面 A 并在 url 末尾传递#myRecord，以导航到特定条目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T17:18:18.303

在大多数浏览器中，后退按钮会记住您在页面中的位置。所以一个简单的`javascript:history.go(-1)`应该就可以了，任何没有启用javascript的人都可以点击后退按钮。

# javascript - 密码强度可视化工具 - Html & Javascript/Ajax

> ID：911770
> 
> 赞同：1
> 
> 时间：2009-05-26T17:13:15.050
> 
> 标签：javascript, html, ajax

我正在寻找一个简单的密码强度可视化工具（如您创建新帐户时的 gmail）。我想向用户展示他们的密码在视觉上有多好。

有没有人想分享一些源代码？:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T17:23:16.310

选择你最喜欢的一个：

[10 个密码强度计脚本，用于更好的注册界面](http://www.webresourcesdepot.com/10-password-strength-meter-scripts-for-a-better-registration-interface/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-02-18T09:27:25.077

我发现这个[https://jsfiddle.net/umesh1990/hxjf74cz/35/#](https://jsfiddle.net/umesh1990/hxjf74cz/35/#)我已经使用 javascript 实现了

```
function password_validate(txt) {
  var val1 = 0;
  var val2 = 0;
  var val3 = 0;
  var val4 = 0;
  var val5 = 0;
  var counter, color, result;
  var flag = false;
  if (txt.value.length <= 0) {
    counter = 0;
    color = "transparent";
    result = "";
  }
  if (txt.value.length < 8 & txt.value.length > 0) {
    counter = 20;
    color = "red";
    result = "Short";
  } else {
    document.getElementById(txt.id + "error").innerHTML = " ";
    txt.style.borderColor = "grey";
    var regex = /^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[^a-zA-Z0-9])(?!.*\s).{8,15}$/;
    //  document.getElementById("pass_veri").style.display="block";
    var fletter = /[a-z]/;
    if (fletter.test(txt.value)) {
      val1 = 20;

    } else {
      val1 = 0;
    }
    //macth special character
    var special_char = /[-!$%^&*()_+|~=`{}\[\]:";'<>?,.\/]/;
    if (special_char.test(txt.value)) {
      val2 = 30;
    } else {
      val = 0;
    }
    /*capital_letter*/
    var cap_lett = /[A-Z]/;
    if (cap_lett.test(txt.value)) {
      val3 = 20;
    } else {
      val = 0;
    }
    /*one numeric*/
    var num = /[0-9]/;
    if (num.test(txt.value)) {
      val4 = 20;
    } else {
      val4 = 0;
    }
    /* 8-15 character*/
    var range = /^.{8,50}$/;
    if (range.test(txt.value)) {
      val5 = 10;
    } else {
      val5 = 0;
    }
    counter = val1 + val2 + val3 + val4 + val5;

    if (counter >= 30) {
      color = "skyblue";
      result = "Fair";
    }
    if (counter >= 50) {
      color = "gold";
      result = "Good";
    }
    if (counter >= 80) {
      color = "green";
      result = "Strong";
    }
    if (counter >= 90) {
      color = "green";
      result = "Very Strong";
    }
  }
  document.getElementById("prog").style.width = counter + "%";
  document.getElementById("prog").style.backgroundColor = color;
  document.getElementById("result").innerHTML = result;
  document.getElementById("result").style.color = color;
}
```

```
body {
  font-family: 'Rajdhani', sans-serif;
  background-color: #E4E4E4;
}

/* tooltip*/

.hint {
  width: 258px;
  background: red;
  position: relative;
  -moz-border-radius: 10px;
  -webkit-border-radius: 10px;
  border-radius: 10px;
  position: absolute;
  left: 0px;
  border: 1px solid #CC9933;
  background-color: #FFFFCC;
  display: none;
  padding: 20px;
  font-size: 11px;
}

.hint:before {
  content: "";
  position: absolute;
  left: 100%;
  top: 24px;
  width: 0;
  height: 0;
  border-top: 17px solid transparent;
  border-bottom: 1px solid transparent;
  border-left: 22px solid #CC9933;
}

.hint:after {
  content: "";
  position: absolute;
  left: 100%;
  top: 26px;
  width: 0;
  height: 0;
  border-top: 14px solid transparent;
  border-bottom: 1px solid transparent;
  border-left: 20px solid #FFFFCC;
}

.parent {
  position: relative;
}

.progress {
  height: 7px;
}

#progres {
  display: block;
}

p {
  margin: 0px;
  font-weight: normal;
}

.form-control {
  width: none;
  margin-left: 260px;
  margin-top: 25px;
  width: 200px;
}
```

```
<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet"/>
<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" />
<div class="form-group col-lg-12 parent ">
  <label class="hint" id="pass-hint">
    Password Strength:<span id="result"></span>
    <br>
    <div class="progress" id="progres">
      <div class="progress-bar progress-bar-danger" role="progressbar" id="prog">
      </div>
    </div>
    <p> passowrd must have atleast 8 charatcer</p>
  </label>
  <input type="password" class="form-control" data-toggle="tooltip" data-placement="left" id="pass" onfocus="document.getElementById('pass-hint').style.display='block'" onblur="document.getElementById('pass-hint').style.display='none'" placeholder="**********"
    oninput="password_validate(this);document.getElementById('progres').style.display='block';">
  <i class=" form-control-feedback" id="passsuccess" aria-hidden="true"></i>
  <span id="passerror" class="help-block error"></span>
</div>
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T17:15:37.713

Drupal 在 Drupal 6 中内置了一个。[向后移植到 Drupal 5 的代码](http://drupal.org/project/password_strength)可能对您有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T17:18:20.563

这个看起来很棒：[http](http://www.geekwisdom.com/dyn/passwdmeter) ://www.geekwisdom.com/dyn/passwdmeter 。

根据密码分数，您可以显示绿色、黄色或红色标记，或任何您想要的。

# java - 如何定义我自己的 SelectableChannel？

> ID：911780
> 
> 赞同：5
> 
> 时间：2009-05-26T17:15:53.237
> 
> 标签：java, nio

我将如何定义一种新的类型`java.nio.channels.SelectableChannel`（比如串行端口）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T19:11:05.063

您可能想要扩展[`java.nio.channels.spi.AbstractSelectableChannel`](http://java.sun.com/javase/6/docs/api/java/nio/channels/spi/AbstractSelectableChannel.html)以创建您需要的实现。如果你要求不同的东西，你需要给出一个更详细的问题。JDK 源代码可以在几个不同的许可证下下载，具体取决于您下载的版本。您可以选择查看 JDK 实现（`java.nio.channels.Channel`、`java.nio.channels.SocketChannel`等...）以充分了解您需要实现的内容。但是，如果您这样做，请注意不要从 JDK 源代码复制代码，除非您可以遵守所下载源代码的许可。

[Java NIO](http://books.google.com/books?id=z7TQ8NSooS4C&pg=PA114&lpg=PA114&dq=%22extends+AbstractSelectableChannel%22&source=bl&ots=SVuCmT53zK&sig=Jc5N7WFBWUjyc8xl4dLd8cs3YzE&hl=en&ei=FUAcSp-kKKbOMqGl5I4P&sa=X&oi=book_result&ct=result&resnum=6)一书可能会对您有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T22:18:42.813

我的理解是java实现是基于unix `select()`c函数的（我好像记得windows的实现略有不同）

根据操作系统（和 JVM 参数！）调用不同的本机 OS 函数，但它们的共同点是它是本机代码 - 基本功能未在 Java 中实现。

如果您想创建一个访问`select()`（或类似）底层操作系统（确实依赖于文件句柄）的库，我认为您几乎被迫使用 JNI。我不相信有任何解决方法。

Java 中的 Selector/SelectableChannel 确实是一个乏善可陈的子集`select()`。

# c# - SubSonic RESTHandler 问题

> ID：911782
> 
> 赞同：1
> 
> 时间：2009-05-26T17:16:45.870
> 
> 标签：c#, subsonic

我是第一次使用 SubSonic RESTHandler，它很棒……有一个怪癖，我很好奇。

RESTHandler.cs（第 319 行）：

```
//if this column is a string, by default do a fuzzy search
if(comp == Comparison.Like || column.IsString)
{
    comp = Comparison.Like;
    paramValue = String.Concat("%", paramValue, "%");
} 
```

默认情况下，这个小小的代码模糊强制对字符串列的所有搜索都使用通配符搜索。这似乎违反直觉，因为您提供了一组很好的比较，我们可以将其添加到参数（_is、_notequal 等...）。这样做是有原因的吗？EvalComparison 默认使用“Comparison.Equals”，因此除非明确需要一个like，否则“|| column.IsString”看起来应该被删除，因为它破坏了使用不同类型比较的能力。

这让我发疯了，因为你不能在不修改代码的情况下执行“WHERE Field = X”......

只是好奇这是否更像是一个功能而不是一个错误......

谢谢！

扎克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T18:28:23.980

这是因为这是一个 LIKE 操作，对于 DB 通常允许字符串操作。当时的感觉是，如果你想要 equals，你就可以使用它。

我已经有一段时间没有接触过这段代码了——如果你愿意打开一个错误，我会看看它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T17:56:57.507

它确实看起来像一个功能。它基于这样的想法，如果我在没有通配符的列中搜索字符串，我必须完全匹配该字符串，否则我不会得到任何命中。我怀疑这样做是为了使编程搜索文本框更容易。

# regex - 正则表达式用 MS Word 中的另一个字符串替换字符串？

> ID：911784
> 
> 赞同：3
> 
> 时间：2009-05-26T17:16:56.697
> 
> 标签：regex, ms-word

谁能帮我用正则表达式转：

```
filename_author 
```

至

```
author_filename 
```

我正在使用 MS Word 2003 并尝试使用 Word 的查找和替换来做到这一点。我已经尝试过该`use wildcards`功能，但没有任何运气。

我只能以编程方式完成吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-26T17:19:51.217

这是正则表达式：

> `([^_]*)_(.*)`

这是一个 C# 示例：

```
using System;
using System.Text.RegularExpressions;

class Program
{
    static void Main()
    {
        String test = "filename_author";
        String result = Regex.Replace(test, @"([^_]*)_(.*)", "$2_$1");
    }
} 
```

这是一个 Python 示例：

```
from re import sub

test = "filename_author";
result = sub('([^_]*)_(.*)', r'\2_\1', test) 
```

* * *

**编辑：**为了在 Microsoft Word 中使用通配符执行此操作，请将其用作搜索字符串：

> `(<*>)_(<*>)`

并替换为：

> `\2_\1`

此外，请参阅[使用正则表达式](http://office.microsoft.com/en-us/help/HA010873051033.aspx)为 Word 搜索添加强大功能以了解我在上面使用的语法：

> *   星号 (*) 返回单词中的所有文本。
> *   小于和大于符号 (< >) 分别标记每个单词的开始和结束。他们确保搜索返回一个单词。
> *   括号和它们之间的空格将单词分成不同的组：（第一个单词）（第二个单词）。括号还指示您希望搜索以评估每个表达式的顺序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T17:20:14.633

干得好：

```
s/^([a-zA-Z]+)_([a-zA-Z]+)$/\2_\1/ 
```

根据上下文，这可能有点贪婪。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T17:20:56.800

搜索模式：

```
([^_]+)_(.+) 
```

更换模式：

```
$2_$1 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T17:20:42.773

在 .NET中，对于这种非常特殊的情况，您可以将`([^_]+)_([^_]+)`其用作正则表达式，然后用作替换模式。`$2_$1`如果您需要超过 2 个部分，它会变得更加复杂。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-26T17:41:34.260

由于您使用的是 MS Word，因此您可以尝试非编程方法。突出显示所有文本，选择表格 -> 转换 -> 文本到表格。将列数设置为 2。选择“分隔文本于”，选择“其他”单选，然后输入 _。那会给你一张桌子。切换两列。然后再次使用 _ 将表格转换回文本。

或者您可以将整个内容复制到 Excel，构建一个公式来拆分和重新加入文本，然后将其复制并粘贴回 Word。要么工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-26T17:28:08.873

在 C# 中，您也可以执行类似的操作。

```
string[] parts = "filename_author".Split('_');
return parts[1] + "_" + parts[0]; 
```

您当然询问了正则表达式，但这可能是一个不错的选择。

# c# - 管理 SQL Server 连接

> ID：911786
> 
> 赞同：7
> 
> 时间：2009-05-26T17:18:17.320
> 
> 标签：c#, .net, sql-server, connection-pooling, sqlconnection

SQL 连接的最佳实践是什么？

目前我正在使用以下内容：

```
using (SqlConnection sqlConn = new SqlConnection(CONNECTIONSTRING))
{
    sqlConn.Open();
    // DB CODE GOES HERE
} 
```

我读过这是一种非常有效的 SQL 连接方式。默认情况下，SQL 池是活动的，所以我的理解是，当`using`代码结束时，`SqlConnection`对象被关闭并释放，但与数据库的实际连接放在 SQL 连接池中。我错了吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-26T17:27:43.760

这是大部分。需要考虑的一些额外要点：

*   你从哪里得到你的连接字符串？您不希望到处都是硬编码，您可能需要保护它。
*   在真正使用连接之前，您通常还需要创建其他对象（`SqlCommand`、`SqlParameter`、`DataSet`、`SqlDataAdapter`），并且*您希望尽可能长时间地等待打开连接*。完整的模式需要考虑到这一点。
*   您想确保您的数据库访问被强制进入它自己的数据层类或程序集。所以一个常见的做法是将其表达为私有函数调用：

.

```
private static string connectionString = "load from encrypted config file";
private SqlConnection getConnection()
{
    return new SqlConnection(connectionString);
} 
```

然后像这样编写您的示例：

```
using (SqlConnection sqlConn = getConnection())
{
    // create command and add parameters

    // open the connection
    sqlConn.Open();

   // run the command
} 
```

该示例只能存在于您的数据访问类中。另一种方法是对其进行标记并将`internal`数据层分布在整个程序集中。主要的是严格执行数据库代码的干净分离。

真正的实现可能如下所示：

```
public IEnumerable<IDataRecord> GetSomeData(string filter)
{
    string sql = "SELECT * FROM [SomeTable] WHERE [SomeColumn] LIKE @Filter + '%'";

    using (SqlConnection cn = getConnection())
    using (SqlCommand cmd = new SqlCommand(sql, cn))
    {
        cmd.Parameters.Add("@Filter", SqlDbType.NVarChar, 255).Value = filter;
        cn.Open();

        using (IDataReader rdr = cmd.ExecuteReader())
        {
            while (rdr.Read())
            {
                yield return (IDataRecord)rdr;
            }
        }
    }
} 
```

请注意，我还能够“堆叠”`cn`和`cmd`对象的创建，从而减少嵌套并仅创建一个范围块。

最后，请注意使用`yield return`此特定示例中的代码。如果您调用该方法并且没有`DataBinding`立即完成您的或其他用途，它可能会长时间保持连接打开。这方面的一个示例是在`Load`ASP.NET 页面的事件中使用它来设置数据源。由于实际的数据绑定事件要到稍后才会发生，因此您可以使连接保持打开的时间比需要的时间长得多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T18:06:38.890

Microsoft 的[模式和实践](http://msdn.microsoft.com/en-us/practices/default.aspx)库是处理数据库连接的绝佳方法。这些库封装了打开连接所涉及的大部分机制，这反过来又会让您的生活更轻松。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T17:20:26.393

您对使用的理解是正确的，并且该使用方法是推荐的使用方法。您也可以在代码中调用 close 。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T18:08:09.637

还有：开晚了，早关了。

在调用数据库之前没有其他步骤之前不要打开连接。完成后立即关闭连接。

# c# - richtextbox selectioncolor 和 selectionbackcolor 属性

> ID：911792
> 
> 赞同：4
> 
> 时间：2009-05-26T17:19:37.550
> 
> 标签：c#, winforms, richtextbox

我想选择一个特定的文本行并用蓝色突出显示它，我希望该文本的前景色为白色。我试过了

```
 this.Select(start, length);
 this.SelectionBackColor = Color.Blue;
 this.SelectionColor = Color.White; 
```

但它不起作用。怎么了？我想模拟当我们通过鼠标选择一些文本时得到的效果，它的背景色变成浅蓝色，里面的文本变成白色。我可以做到这一点

```
 this.Select(start, length); 
```

但是一旦它失去焦点，选择就会消失，我希望它永久存在。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-08-12T14:33:57.437

有更简单的方法来为richtextbox中的文本着色：

```
richtTextBox.SelectionColor = Color.Red;
richTextBox.SelectedText = "Red text";
richtTextBox.SelectionColor = Color.Green;
richTextBox.SelectedText = "Green text"; 
```

你得到： ![在此处输入图像描述](https://i.stack.imgur.com/94H8R.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T17:34:23.527

尝试做这样的事情：

```
 this.richTextBox1.SelectionStart = start;
        this.richTextBox1.SelectionLength = length;
        this.richTextBox1.SelectionColor = Color.White;
        this.richTextBox1.SelectionBackColor = Color.Blue; 
```

# objective-c - 以编程方式创建视图与 IB 相比的效率

> ID：911804
> 
> 赞同：4
> 
> 时间：2009-05-26T17:22:09.260
> 
> 标签：objective-c, iphone, cocoa-touch, uiview, uiscrollview

我有大量在应用程序委托 applicationDidFinishLaunching 中创建并添加到 NSMutableArray 的 UIView。用户使用页面控件和滚动视图浏览这些视图。我在 IB 中创建了 UIView 及其子组件。它们连接到控制器。在 iPhone 上创建 170 个视图大约需要 30 秒。最终，我的浏览量将超过 1000 次。除了速度慢之外，它还会因为内存使用而杀死应用程序。在没有视图的情况下以编程方式创建所有内容的速度和内存效率有多高？6000 个事实类型的应用程序中的一些是如何做到的？

有没有更好的方法而不是一次创建所有内容？用户可以访问插槽#400 中的视图并从那里开始滚动。任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-26T17:53:48.387

UIViewControllers 是懒惰的。它们仅在请求时加载，并在内存紧张时自动卸载（并且很容易通过调用手动卸载它们`self.view=nil`）。

这里的“加载”意味着“读取 NIB”或“以编程方式构建”。ViewControllers 并不真正关心。以编程方式构建可能会快一点，因为您不必敲击磁盘，但这很少是瓶颈，因为您一次只显示一个视图控制器。

至于走哪条路，它更多的是风格而不是性能（UITableViewCells 除外，在大多数情况下您需要以编程方式构建它是有原因的）。

从学习[View Controller Programming Guide](http://developer.apple.com/iphone/library/featuredarticles/ViewControllerPGforiPhoneOS/Introduction/Introduction.html)开始。它将向您展示 iPhone 打算如何执行此操作。

对于 eJames 关于 NIB 是 XML 文件的评论，这可能有点误导。NIB 是通过编译 XML 的 XIB 文件生成的二进制文件。在假设NIB加载时间实际上是一个问题之前，我实际上会在手机上进行分析。就像我天生倾向于程序化布局一样，我在实践中发现 NIB 在实践中极大地简化了许多 UI 问题，并且我总是在大型项目中使用它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T17:45:32.710

在不了解您的具体问题的情况下很难提出答案，但我敢说，如果您希望显示 1000 种不同的东西，那么在 IB 中创建 1000 个单独的视图不是可行的方法。

如果你的页面共享一个共同的布局，你可以使用 UITableView 来显示每个页面的内容，并且只将每个页面的*数据*存储在你的`NSMutableArray`.

`UITableView`可以在[此处](http://icodeblog.com/2008/08/08/iphone-programming-tutorial-populating-uitableview-with-an-nsarray/)找到有关如何使用的出色教程。

如果他们不共享一个共同的布局，那么以编程方式布局将是可行的方法。这不应该比使用 IB 更占用内存或处理器，实际上它可能会更快，因为它消除了读取和解析 XML 文件的需要（实际上是 .NIB 文件）。

# java - 为 RESTLET Web 服务编写测试用例的最佳方法是什么？

> ID：911805
> 
> 赞同：8
> 
> 时间：2009-05-26T17:22:35.953
> 
> 标签：java, junit, restlet, jax-rs, testng

我有一个用 Restlet 库实现的 JAX-RS Web 服务，现在我想测试它。为了做到这一点，我想通过使用模拟服务预初始化它来在我的测试中托管这个服务。

托管此类服务和执行测试调用的最佳方式是什么？

```
@Path("/srv")
public class MyService
{
   @GET
   public void action(@Context UriInfo uri)
   { ... }
}

@Test
public void myTest()
{
   MyService service = new MyService();
   service.setSomething(...);

   // How do I host it?

   // How do I call it?
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-07-13T14:31:28.737

@[参见 http://www.restlet.org/documentation/1.1/firstSteps#part04](http://www.restlet.org/documentation/1.1/firstSteps#part04)

您应该能够以嵌入式方式运行 Restlet 服务并使用 apache HttpClient 调用方法。我已经做到了，而且很简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T02:56:15.293

Restlet 让您可以在各种服务器“连接器”上运行 Web 服务，并且从一台服务器切换到另一台服务器非常容易。我们通常在 Sun Glassfish Java EE 应用服务器集群上运行我们的 Web 服务，但为了测试它们，我们使用与 Simple HTTP Server 链接的连接器将 Web 服务作为独立应用程序运行。还有用于 AsyncWeb、Jetty、Grizzly 和内部 HTTP 服务器的服务器连接器。

在客户端，您应该考虑 Restlet 客户端库。它非常简洁，旨在与 Restlet 服务器很好地结合。我们使用 Apache HTTP 客户端连接器。

为了测试，我们创建了 Fetcher 类。这是使用 Restlet 客户端 API 实现的。要使用它，您几乎可以调用 fetch() 方法：

```
DTO person = fetch("/employee/1234");
DTO department = fetch("/department/" + person.getDepartment()); 
```

Fetch() 将给定的资源名称附加到 Web 服务的基本 URI（例如“ [http://localhost:8182](http://localhost:8182) ”），使用 Restlet 客户端 API 获取 XML 表示，然后将获取的 XML 反序列化为数据传输对象（一个 POJO）。

您可以看到这确实使单元测试变得非常容易。在进行单元测试之前，您在 Simple 或 Jetty 等独立服务器上启动 Web 服务。在单元测试期间，您使用 Fetcher 获取 DTO、DOM 树、json.org 对象或其他任何内容，然后将测试断言应用于返回的内容。如果需要更详细的测试，可以直接使用 Restlet 客户端代码。

# jquery - 如何逃避负（-1）结果jquery

> ID：911811
> 
> 赞同：0
> 
> 时间：2009-05-26T17:23:33.300
> 
> 标签：jquery

我正在为 jquery 上的 wordpress 开发一个帖子幻灯片。我得说我不是专家，这是我第一次使用 jquery 或 javascript。一切工作完美代码工作正常帖子每x秒旋转一次，有两个div在点击时向左（上一个）或右（下一个）移动帖子，它工作正常但在第一个帖子（0）上点击左（以前）它什么都没有显示，因为 0 - 1 = -1 没有 -1 帖子，应该显示的是最后一个帖子 (4)。我试过 if { } else if { } 但正如我所说我不是专家，我自己找不到解决方案。任何帮助都将不胜感激。编码...

```
$("#switch-izquierda").click(
    function() {
    $("#lista-contenedor-rotatorio li:eq("+img_actual+")").fadeOut(1600);
    img_actual = (img_actual -1) % cuenta;
    $("#lista-contenedor-rotatorio li:eq("+img_actual+")").fadeIn(2000);
    }); 
```

问题就在这里...

```
 img_actual = (img_actual -1) % cuenta; 
```

当在第一篇文章（0）结果为-1时，我需要显示最后一篇文章（4）

如果您有解决方案，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T17:30:27.217

您不需要余数运算符，而是模运算符。我不知道它是否存在于JS中。

最简单的方法可能是通过添加长度来避免负面情况：

```
img_actual = (img_actual + cuenta - 1) % cuenta; 
```

# java - 为 JERSEY Web 服务编写测试用例的最佳方式是什么？

> ID：911813
> 
> 赞同：12
> 
> 时间：2009-05-26T17:24:09.727
> 
> 标签：java, junit, jersey, jax-rs, testng

我有一个用 Jersey 库实现的 JAX-RS Web 服务，现在我想测试它。为了做到这一点，我想通过使用模拟服务预初始化它来在我的测试中托管这个服务。

托管此类服务和执行测试调用的最佳方式是什么？

```
@Path("/srv")
public class MyService
{
   @GET
   public void action(@Context UriInfo uri)
   { ... }
}

@Test
public void myTest()
{
   MyService service = new MyService();
   service.setSomething(...);

   // How do I host it?

   // How do I call it?
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-08-27T06:39:11.317

The new (revised) Jersey Test Framework which is part of the Jersey 1.1.2-ea release now supports the In-Process or In-Memory testing. In order to run your tests in-memory all you have to do is set the property *test.containerFactory* to *com.sun.jersey.test.framework.spi.container.inmemory.InMemoryTestContainerFactory*, i.e., run your tests as follows:

*mvn clean test -Dtest.containerFactory=com.sun.jersey.test.framework.spi.container.inmemory.InMemoryTestContainerFactory -DenableLogging*

For more details please go through the blog entry titled **Jersey Test Framework re-visited!** at [http://blogs.oracle.com/naresh](http://blogs.oracle.com/naresh).

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-09T07:02:51.917

我相信[Jersey 测试框架](http://blogs.oracle.com/naresh/entry/jersey%5Ftest%5Fframework%5Fmakes%5Fit)为您的需求提供了解决方案。它允许您部署单个服务并运行其所有测试。您可以使用该框架针对 Grizzly Web Container、Embedded GlassFish 和/或 HTTPServer 运行测试。

请注意，您也可以使用该框架针对 GlassFish 和 Tomcat 等常规 Web 容器运行测试。如果您有任何疑问，请随时给我或泽西岛用户邮件列表 - users@jersey.dev.java.net 发送电子邮件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-28T17:10:49.677

我还没有尝试过，但是像 HtmlUnit 或 HttpUnit 这样的 JUnit 扩展可能是测试 JAX-RS/Jersey 服务的好方法。测试用例可以使用 XPath 来查找预期的返回值并根据预期验证返回的值。请参阅： [http](http://htmlunit.sourceforge.net/gettingStarted.html) ://htmlunit.sourceforge.net/gettingStarted.html了解更多信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T19:27:27.217

您可以使用 Grizzly 托管服务，然后使用 Jersey 客户端访问它们。查看示例应用程序。例如，在 Bookstore 示例中，您可能会发现特别感兴趣的 TestSupport 类和 JerseyTest 类（在 jersey-test-framework 中找到）。

我希望这有帮助。

（不幸的是，堆栈溢出不会让我发布，直到我删除了所有超链接，所以很高兴谷歌搜索！）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-07T11:23:42.473

好的，我现在明白了。目前该框架不支持 IN PROCESS，bt 我们正在努力。我们将看到这种支持将添加到即将发布的 Jersey 测试框架版本中

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-28T22:17:39.013

您是否考虑过使用[Jersey 测试框架](http://blogs.oracle.com/naresh/entry/jersey_test_framework_makes_it "泽西测试框架")？不幸的是，它仍然是比单元测试更多的集成测试，但它可能会让你上路。

# linux - 检测 shell 脚本的输出流类型

> ID：911816
> 
> 赞同：15
> 
> 时间：2009-05-26T17:26:12.153
> 
> 标签：linux, unix, shell, scripting

我正在编写一个在命令行上使用 ANSI 颜色字符的 shell 脚本。

示例：**example.sh**

```
#!/bin/tcsh
printf "\033[31m Success Color is awesome!\033[0m" 
```

我的问题是：

```
$ ./example.sh > out 
```

或者

```
$./example.sh | grep 
```

ASCII 代码将与文本一起原始发送出去，弄乱了输出，通常会造成混乱。

我很想知道是否有办法检测到这一点，所以我可以为这种特殊情况禁用颜色。

我已经在 tcsh 手册页和网络上搜索了一段时间，但还没有找到任何特定于 shell 的内容。

我不受 tcsh 约束，这是我们的团体标准……但谁在乎呢？

**是否可以在 shell 脚本中检测您的输出是否被重定向或管道传输？**

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-26T17:39:22.097

请参阅this [previous SO question](https://stackoverflow.com/questions/911168/detect-if-shell-script-is-running-through-a-pipe)，其中涵盖 bash。Tcsh 提供了与`filetest -t 1`查看标准输出是否为终端相同的功能。如果是，则打印颜色内容，否则将其保留。这是tcsh：

```
#!/bin/tcsh
if ( -t 1 ) then
        printf "\033[31m Success Color is awesome!\033[0m"
else
        printf "Plain Text is awesome!"
endif 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-26T17:38:25.047

在 bourne shell 脚本（sh、bask、ksh、...）中，您可以将标准输出提供给程序（Unix 中的标准），该程序通过使用标志`tty`告诉您其输入是否为 tty 。`-s`

将以下内容放入“check-tty”：

```
 #! /bin/sh
    if tty -s <&1; then
      echo "Output is a tty"
    else
      echo "Output is not a tty"
    fi 
```

试试看：

```
 % ./check-tty
    Output is a tty
    % ./check-tty | cat
    Output is not a tty 
```

我不使用`tcsh`，但必须有办法将标准输出重定向到`tty`的标准输入。如果没有，请使用

```
 sh -c "tty -s <&1" 
```

作为脚本中的测试命令`tcsh`，检查它的退出状态，你就完成了。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-26T17:39:31.253

输出流类型的检测包含在问题[检测 shell 脚本是否通过管道运行中](https://stackoverflow.com/questions/911168/detect-if-shell-script-is-running-through-a-pipe/911224#911224)。

确定您正在与终端交谈后，您可以使用`tput`为您正在使用的特定终端检索正确的转义码 - 这将使代码更便携。

下面给出了一个示例脚本（`bash`恐怕`tcsh`不是我的强项）。

```
#!/bin/bash

fg_red=
fg_green=
fg_yellow=
fg_blue=
fg_magenta=
fg_cyan=
fg_white=
bold=
reverse=
attr_end=

if [ -t 1 ]; then
    fg_red=$(tput setaf 1)
    fg_green=$(tput setaf 2)
    fg_yellow=$(tput setaf 3)
    fg_blue=$(tput setaf 4)
    fg_magenta=$(tput setaf 5)
    fg_cyan=$(tput setaf 6)
    fg_white=$(tput setaf 7)
    bold=$(tput bold)
    reverse=$(tput rev)
    underline=$(tput smul)
    attr_end=$(tput sgr0)
fi

echo "This is ${fg_red}red${attr_end}"
echo "This is ${fg_green}green${attr_end}"
echo "This is ${fg_yellow}yellow${attr_end}"
echo "This is ${fg_blue}blue${attr_end}"
echo "This is ${fg_magenta}magenta${attr_end}"
echo "This is ${fg_cyan}cyan${attr_end}"
echo "This is ${fg_white}white${attr_end}"
echo "This is ${bold}bold${attr_end}"
echo "This is ${reverse}reverse${attr_end}"
echo "This is ${underline}underline${attr_end}" 
```

有关更多信息，请参阅“ `man tput`”和“ `man terminfo`” - 有各种转义码可供使用。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-05-26T17:37:04.800

据我所知，没有办法确定你的 shell 脚本输出的最终目的地；您唯一能做的就是提供一个允许在输出中抑制控制字符的开关。

# law-of-demeter - 被动视图是否违反了得墨忒耳法则？

> ID：911817
> 
> 赞同：3
> 
> 时间：2009-05-26T17:26:29.067
> 
> 标签：law-of-demeter, passive-view

我试图了解如何正确使用被动视图。在我看来，我在被动视图上看到的每个示例都违反了得墨忒耳法则：

```
//In the presenter code
myview.mytextfield.text = "whatever"; 
```

那么被动视图的更好实现是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-18T20:36:13.303

首先，得墨忒耳定律，就像大多数编程规则一样，更像是一个原则或指导方针，并且在某些情况下该原则不适用。话虽如此，得墨忒耳法则并不真正适用于*被动视图*，因为在这种情况下，法律的原因不是问题。

得墨忒耳法则试图阻止依赖链，例如：

```
objectA.objectB.objectC.DoSomething(); 
```

显然，如果 objectB 的实现更改为使用 objectD，那么它将破坏 objectA 的依赖关系并导致编译错误。如果采取极端措施，只要链条因实施更改而受到干扰，您最终都会进行霰弹枪手术。

在*被动视图的情况下*

*   演示者依赖于一个接口，因此只要接口保持不变，视图的实现就可以改变。
*   视图通常将属性公开为通用数据类型，例如系统类型和集合。这允许您在不影响演示者的情况下更改 UI。
*   对于演示者来说，视图只不过是一个数据结构，一个检索和转储数据的地方。由于视图非常简单，演示者甚至不应该能够进行依赖链。

所以你给出的例子通常会被实现：

```
//from presenter
view.MeaningfulName = "data"; 
```

虽然视图类似于：

```
//from view
public string MeaninfulName
{
    get
    {
        return someControl.text;
    }
    set
    {
        someControl.text = value;
    } 
```

希望这能澄清一些事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T17:37:01.743

好的，好的，是的，这*确实*违反了得墨忒耳定律，它基本上说对象的接口不应该揭示对象的实现。但是，第二个也为实现提供了很多提示。

我想是时候问问你是否有正确的界面了。这些文本字段*是*什么？谁在视图中设置它们？视图不应该向模型询问数据，反之亦然吗？

也许你需要观察者模式——模型保存了一个感兴趣方的列表，并在其内部状态发生变化时通知他们。

* * *

啊，*那个*被动视图。好久没看那个了。基本上，我看到了两部分：其中之一是通过让控制器（而不是模型）驱动所有更新，为了（我假设）效率，他公开了特定的字段方法来更新这些字段。这确实违反了得墨忒耳定律，毕竟它只是某种隐喻意义上的“定律”，就像墨菲定律一样。不过，这通常是个好主意。在这种情况下，我将重做 View 并将其用作外观来包装对单个字段的更新。

不过，您不需要观察者模式，因为现在您已经让控制器进行所有更新。它为整个代码增加了一些复杂性和易错性，因为现在您必须编写控制器来进行并行更新。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T18:57:40.253

更好的实现是在 Presenter 和 View 之间有一个 API。Presenter 将通过一个方法（在 View 的接口中定义）将数据推送到它的 View。视图会根据一些内部逻辑来管理新的输入。

因此，Presenter 不必对 View 有任何了解，Demeter 法则是安全的。

# .net - .NET Webservice 一半有效，一半 404

> ID：911821
> 
> 赞同：0
> 
> 时间：2009-05-26T17:28:05.770
> 
> 标签：.net, web-services, windows-services

我有一个在 Windows Server2003 R2 计算机上作为 Windows 服务运行的 .NET Web 服务。我有一个单独的 .NET/C# 2.0 应用程序正在运行，它从我们 LAN 的其他地方调用这个 web 服务。Web 服务有 2 种方法 - 其中 1 种方法调用完美无缺。但是，另一种方法总是返回 404“未找到”错误。我可以访问网络服务 URL 并查看这两种方法。我在我的项目上做了一个“更新网络参考”，它完成得很好。生成的 Web 代理可以很好地看到该方法。但它在运行时从不工作，而它的兄弟工作得很好。

服务配置文件中没有 Web 设置 - 只有您的标准连接字符串和一些 appSettings。

到底是什么导致一种方法变为 404，而另一种方法正常？

编辑：网络服务和调用代码都是 .NET 2.0，C#。这*不是*WCF，只是老派的“网络参考”。事实上，它基于 System.Web.Services.Protocols.SoapHttpClientProtocol 而不是 Microsoft.Web.Services3.WebServicesClientProtocol。

我已经确认 web 服务 url 没有被动态设置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T17:34:30.033

你没有说你使用的是什么技术，所以我假设它是 WCF。你没有说你在服务端使用的是什么版本的 .NET，所以我假设 .NET 3.5 SP1。

我建议你仔细看看。特别是，打开跟踪，看看它有什么要说的。是否收到请求？在什么时候产生响应？也许找到了服务，但是 SOAP“动作”有问题，所以第二个操作确实没有被找到。请记住，您在 Web 代理中看到的内容与 Web 代理实际请求的内容不同。*应该*是，但可能不是。打开追踪并找出答案。

您还可以考虑调试服务，以查看是否已完成操作。或许是操作中的异常被翻译成404？

此外，查看事件日志以查看是否在同一时间发生了其他有趣的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T18:37:54.943

一些代码确实可以帮助我们更好地理解您的问题。我可以问一下调用 web 服务的应用程序是 web 应用程序还是桌面应用程序还是 windows 服务？

如果它是一个 Web 应用程序，一个建议是手动调用 Web 服务并运行 fiddler 或 firebug 以查看服务器响应是什么以及正在传递和返回的数据。这可能是解决问题的起点。

# java - 如何处理 Java PrepareStatement 中的特殊字符？

> ID：911822
> 
> 赞同：2
> 
> 时间：2009-05-26T17:28:07.393
> 
> 标签：java, string, special-characters

`PreparedStatement`在使用该类的以下 SQL 查询中：

```
String query_descrip = "insert into timitemdescription (itemkey, languageid, longdesc, shortdesc) values (?, 1033, ?,?)";
PreparedStatement pstmt2 = con.prepareStatement(query_descrip); 
pstmt2.setInt(1, rs4);
pstmt2.setString(2, itemdescription);
pstmt2.setString(3, itemdescription.substring(0,39));
pstmt2.executeUpdate(); 
```

我有时会在我的项目描述中得到撇号和单引号和双引号。例如，我最近的一个项目是“Planar 22”监视器”。当然，字符串被误解了，认为描述值只是“Planar 22”。处理字符串中特殊字符的最佳方法是什么？

我读过有些人正在使用正则表达式，但是这些似乎是针对具体情况的。我正在研究的另一种方法是逐字符读取字符串数组。我希望有一种更有效、资源更少的方式来做到这一点。

更新在一些更广泛的测试之后，事实证明我的代码中出现了更多问题。这也是一个 URL 编码问题。当jsp代码填充html表单时，它会尝试将描述字段移动到在线表单，它会在表单而不是查询中截断它。jTDS 还纠正了接收特殊字符的问题。因为 jTDS 是一个 jar，它还有助于避免重新启动机器。我将奖励 jTDS 线程，因为那是我部分使用的。

提前致谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-26T17:31:05.717

由于您使用的是 PreparedStatement，因此您根本不需要做任何事情，它将由 JDBC 驱动程序为您处理。您唯一需要注意的是非 ASCII 字符，特别是您必须确保 DB 表对可以处理您将使用的所有字符的文本列使用编码。但这是一个 SQL 问题，而不是 Java 问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-29T02:52:59.907

就像其他人所说的那样，您不必做任何事情来处理特殊字符。您需要尝试不同的 JDBC 驱动程序。

尝试使用[jTDS 驱动程序](http://jtds.sourceforge.net/)，看看它是否对您的 PreparedStatement 有帮助。它是 SQL Server 的开源数据库驱动程序。我现在在工作中使用它，它像冠军一样工作，实际上符合 JDBC 规范，不像 MS 驱动程序。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-26T17:31:42.940

如果您将这些字符作为参数绑定到 PreparedStatement，则不需要特别处理这些字符，就像您正在做的那样。这是准备好的陈述方法的主要好处之一。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T12:50:25.787

I'm fairly certain the problem isn't with the code you posted. To help troubleshoot:

1.  Have you tried running the code snippet above in a debugger? What's the value of "itemdescription" before you pass it to the database call?
2.  How are you actually verifying the value in the database? Is this more Java code? Or are you looking at it with SQLCMD or something like that?

# java - 如何更改 jface 表的背景选择颜色

> ID：911834
> 
> 赞同：4
> 
> 时间：2009-05-26T17:32:53.843
> 
> 标签：java, eclipse-rcp, jface

在一个 elipse-rcp 应用程序中，我正在为 jface 表中的一行设置背景颜色，但我不希望选择更改此颜色。我希望能够为选定的行指定颜色变化。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-26T20:07:29.507

根据[这个线程](http://dev.eclipse.org/newslists/news.eclipse.platform.swt/msg41815.html)，for `JFace Viewers`( `ListViewer`, `Table`, `Tree`) 通过使用`EraseItem`和`MeasureItem`事件

[文章“自定义绘图表和树项](http://www.eclipse.org/articles/article.php?file=Article-CustomDrawingTableAndTreeItems/index.html)”中详述的一般原则

> `SWT.EraseItem`：允许客户端自定义绘制单元格的背景和/或选择，并影响是否应绘制单元格的前景

![替代文字](https://www.eclipse.org/articles/Article-CustomDrawingTableAndTreeItems/images/figure5.png)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-27T16:54:57.990

```
table.addListener(SWT.EraseItem, new Listener() {
    public void handleEvent(Event event) {
        event.detail &= ~SWT.HOT;
        if ((event.detail & SWT.SELECTED) == 0) return; /// item not selected

        Table table =(Table)event.widget;
        TableItem item =(TableItem)event.item;
        int clientWidth = table.getClientArea().width;

        GC gc = event.gc;               
        Color oldForeground = gc.getForeground();
        Color oldBackground = gc.getBackground();

        gc.setBackground(colorBackground);
        gc.setForeground(colorForeground);              
        gc.fillRectangle(0, event.y, clientWidth, event.height);

        gc.setForeground(oldForeground);
        gc.setBackground(oldBackground);
        event.detail &= ~SWT.SELECTED;
    }
}); 
```

# .net - CompileAssemblyFromSource 生成的程序集的异常没有行号

> ID：911840
> 
> 赞同：3
> 
> 时间：2009-05-26T17:35:21.200
> 
> 标签：.net, debugging, scripting

我的应用程序具有脚本功能，我使用 CodeDomProvider.CompileAssemblyFromSource 从用户脚本编译内存中的程序集。它类似于[此答案](https://stackoverflow.com/questions/614186/dynamically-generate-modules-in-same-assembly-space/622360#622360)中描述的内容。

它工作得很好，但是从脚本代码中抛出的任何异常在堆栈跟踪中都没有行号。我尝试设置 compilerParameters.IncludeDebugInformation = true，但它仍然不包括行号。

是否可以从内存程序集中获取异常的行号？

以下是我用来编译程序集的关键代码：

```
 CompilerParameters compilerParameters =
            compilerInfo.CreateDefaultCompilerParameters();
        compilerParameters.GenerateInMemory = true;
        compilerParameters.GenerateExecutable = false;
        compilerParameters.IncludeDebugInformation = true;

        ...

        CodeDomProvider codeProvider = compilerInfo.CreateProvider();
        CompilerResults compilerResults =
            codeProvider.CompileAssemblyFromSource(
                compilerParameters,
                new string[] { sourceCode }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T17:39:39.147

我们通过将源代码写入一个临时文件，然后使用该文件而不是内存中的字符串来编译代码来解决这个问题。这为我们提供了有意义的调试信息，否则我们无法获得。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T17:37:44.423

从我在[这里](https://stackoverflow.com/questions/306891/assembly-not-loading-for-asp-net-web-application/307040#307040)和[这里](http://www.eggheadcafe.com/forumarchives/NETscripting/Oct2005/post23953297.asp)找到的评论来看，在附加行号之前，程序集的 PDB 文件必须与程序集位于同一目录中。似乎这排除了内存程序集的调试信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-24T12:52:52.433

在为 .NET Framework 4 开发的应用程序中，当我运行的系统安装了 .NET Framework 4.5（或可能更高版本）时，我确实在异常堆栈跟踪中获得了行号，但是当它只有 .NET Framework 4.5 时我没有得到它们。 NET Framework 4（完整或客户端配置文件）。

所以是的，现在可以从内存中的程序集中获取异常的行号，即通过在 .NET Framework 4.5 上运行。

# reporting-services - 报表服务器 - 无法通过 Iif() 或 Switch() 显示正确的输入参数

> ID：911845
> 
> 赞同：1
> 
> 时间：2009-05-26T17:37:33.833
> 
> 标签：reporting-services, nullable, iif-function

我的文本框中有一个可以为空的布尔输入参数，其中包含以下表达式：

```
=iif(Parameters!Sorted.Value="","All",iif(Parameters!Sorted.Value="True","Sorted","Unsorted")) 
```

我正在尝试根据**Sorted**输入参数的值来显示它

空=“全部”

True =“已排序”

False = "未排序"

我还尝试了以下 switch 语句，但没有任何运气：

```
=Switch(Parameters!Sorted.Value="","All",Parameters!Sorted.Value="True","Sorted",Parameters!Sorted.Value="False","Unsorted") 
```

每次呈现报告时，我都会收到以下错误：

```
The value expression for the textbox ‘textbox7’ contains an error: Input string was not in a correct format. 
```

我正在使用 VS2003 和 SSR Designer v 8.0

编辑#1：每个请求

```
<ReportParameter Name="Sorted">
  <DataType>Boolean</DataType>
  <Nullable>true</Nullable>
  <Prompt>Sorted</Prompt>
</ReportParameter> 
```

这是您要求的代码吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T18:01:51.880

好的，我认为您的问题可能是您的 DataType 是布尔值，并且您指定了一个空白值。你不能这样做。

相反，请尝试指定关键字 Nothing：

```
=iif(Parameters!Sorted.Value=nothing,"All",iif(Parameters!Sorted.Value="True","Sorted","Unsorted")) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T18:25:41.630

如果它是布尔类型参数，则将其视为字符串进行检查在语义上是不正确的。

您可以使用`IsNothing(Parameters!Sorted.Value)`检查空值，然后`Parameters!Sorted.Value = True`（不带引号）检查第二种情况。

我承认我没有启动 Visual Studio 来检查通常是否可以将布尔参数视为字符串，但是你得到的错误听起来是这样的。该错误通常是由`Parse`方法引发的，比如如果你这样做`Int32.Parse("34.32")`，或者我似乎记得。我猜 RS 正在做一个自动解析，以便数据类型匹配并且相等运算符可以发挥它的魔力。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T18:39:32.647

为什么不更改逻辑以显式测试 True 或 False，然后直接切换到“All”？而且不用担心字符串，True vs "true" 等

```
=iif(Parameters!Sorted.Value,"Sorted",iif(NOT(Parameters!Sorted.Value), "Unsorted","All")) 
```

（无法测试并希望不是正确的:-)

# python - 使用python检测空闲时间

> ID：911856
> 
> 赞同：35
> 
> 时间：2009-05-26T17:39:35.437
> 
> 标签：python, winapi

如何使用 Python 在 Windows 上检测系统是否空闲（即没有键盘或鼠标活动）。之前已经问[过](https://stackoverflow.com/questions/217157/how-can-i-determine-the-display-idle-time-from-python-in-windows-linux-and-maco)`GetLastInputInfo`这个问题，但是模块中似乎没有 a `pywin32`。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-05-26T19:17:19.280

```
from ctypes import Structure, windll, c_uint, sizeof, byref

class LASTINPUTINFO(Structure):
    _fields_ = [
        ('cbSize', c_uint),
        ('dwTime', c_uint),
    ]

def get_idle_duration():
    lastInputInfo = LASTINPUTINFO()
    lastInputInfo.cbSize = sizeof(lastInputInfo)
    windll.user32.GetLastInputInfo(byref(lastInputInfo))
    millis = windll.kernel32.GetTickCount() - lastInputInfo.dwTime
    return millis / 1000.0 
```

调用`get_idle_duration()`以秒为单位获取空闲时间。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2015-11-17T19:27:52.393

```
import win32api
def getIdleTime():
    return (win32api.GetTickCount() - win32api.GetLastInputInfo()) / 1000.0 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2010-08-14T14:06:35.100

似乎`GetLastInputInfo`现在在 pywin32 中可用：

```
win32api.GetLastInputInfo() 
```

做的伎俩并从最后一个用户输入操作返回计时器滴答声。

这里有一个示例程序

```
import time
import win32api
for i in range(10):
   print(win32api.GetLastInputInfo())
   time.sleep(1) 
```

如果在脚本休眠时按下一个键/移动鼠标，打印的数字就会改变。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-04-19T14:10:47.283

@FogleBird 的回答非常酷且有效，但我急忙不确定它是如何工作的，所以这里有一个小测试示例。一个线程正在启​​动，每 10 秒查找最后一次空闲时间。如果在此时间窗口内进行任何移动，它将被打印出来。

```
from ctypes import Structure, windll, c_uint, sizeof, byref
import threading

//Print out every n seconds the idle time, when moving mouse, this should be < 10
def printit():
  threading.Timer(10.0, printit).start()
  print get_idle_duration()

class LASTINPUTINFO(Structure):
    _fields_ = [
        ('cbSize', c_uint),
        ('dwTime', c_uint),
    ]

def get_idle_duration():
    lastInputInfo = LASTINPUTINFO()
    lastInputInfo.cbSize = sizeof(lastInputInfo)
    windll.user32.GetLastInputInfo(byref(lastInputInfo))
    millis = windll.kernel32.GetTickCount() - lastInputInfo.dwTime
    return millis / 1000.0

printit() 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-26T18:15:37.140

实际上，您可以`GetLastInputInfo`通过`cytpes`库访问：

```
import ctypes
GetLastInputInfo = ctypes.windll.User32.GetLastInputInfo  # callable function pointer 
```

不过，这可能不是您想要的，因为它不提供整个系统的空闲信息，而只提供调用该函数的会话的信息。 [请参阅 MSDN 文档。](http://msdn.microsoft.com/en-us/library/ms646302(VS.85).aspx)

或者，您可以[检查系统是否被锁定](http://timgolden.me.uk/python/win32_how_do_i/see_if_my_workstation_is_locked.html)，或者屏幕保护程序是否已启动。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-07-21T23:32:19.377

到目前为止，基本上有两种类型的答案。一个 using `pywin32`(via`win32api`和一个 using `ctypes`。我唯一能想到的区分它们的就是执行时间，所以这里是 timeit 测试的结果：

```
# idlefuncs.py

import ctypes
from ctypes import Structure, c_uint, sizeof, byref

import win32api

user32 = ctypes.WinDLL("user32", use_last_error=True)
kernel32 = ctypes.WinDLL("kernel32", use_last_error=True)

class LASTINPUTINFO(Structure):
    _fields_ = [
        ('cbSize', c_uint),
        ('dwTime', c_uint),
    ]

def get_idle_duration():
    lastInputInfo = LASTINPUTINFO()
    lastInputInfo.cbSize = sizeof(lastInputInfo)
    user32.GetLastInputInfo(byref(lastInputInfo))
    millis = kernel32.GetTickCount() - lastInputInfo.dwTime
    return millis / 1000.0

def getIdleTime():
    return (win32api.GetTickCount() - win32api.GetLastInputInfo()) / 1000.0 
```

在 ipython 中：

```
In[1]: from idlefuncs import *

In[2]: %timeit get_idle_duration()
1.21 µs ± 12 ns per loop (mean ± std. dev. of 7 runs, 1000000 loops each)
In[4]: %timeit getIdleTime()
465 ns ± 7.69 ns per loop (mean ± std. dev. of 7 runs, 1000000 loops each) 
```

出乎我的意料，ctypes 版本的耗时是原来的 2.6 倍！

# wcf - WCF REST POST XML - 远程服务器返回错误：（400）错误请求

> ID：911859
> 
> 赞同：12
> 
> 时间：2009-05-26T17:40:32.093
> 
> 标签：wcf, rest

我已经使用 WCF 服务库公开了我的 REST API 服务并由控制台应用程序启动。当我尝试从客户端（另一个控制台应用程序）使用服务时，我收到“错误请求”异常。

请看下面的代码：-

```
[ServiceContract(Namespace = "http://www.test.com/Enrollment")]
public interface IEnrollService
{
    [OperationContract]
    [WebInvoke(Method = "POST", UriTemplate = "enroll", 
           RequestFormat = WebMessageFormat.Xml, 
           ResponseFormat = WebMessageFormat.Xml, 
           BodyStyle= WebMessageBodyStyle.Bare)]
    string EnrollData(Enroll enrData);
}

public class EnrollService : IEnrollService
{
    public string EnrollData(Enroll enrData)
    {
        return "Hello, your test data is " + enrData.AccountNumber; 
    }
} 
```

## 数据合约

```
[DataContract(Namespace = "http://www.test.com/Enrollment")]
public class Enroll
{

    [DataMember]
    public string ClientId
    {
        get;
        set;
    }

    [DataMember]
    public string AccountNumber
    {
        get; 
        set; 
    }

    [DataMember]
    public string TaxId
    {
        get; 
        set; 
    }

    [DataMember]
    public string TaxType
    {
        get; 
        set; 
    }

    [DataMember]
    public string EmailAddress
    {
        get; 
        set; 
    }

    [DataMember]
    public string Pin
    {
        get; 
        set; 
    }

    [DataMember]
    public string State
    {
        get; 
        set; 
    }

} 
```

## app.config 设置

```
<system.serviceModel>
  <services>
    <service name="OEA.REST.EnrollService" behaviorConfiguration="OEABehavior">
      <endpoint address="http://localhost:8010/OEA/Service/EnrollService" 
                binding="webHttpBinding" behaviorConfiguration="webHttp"
                contract="OEA.REST.IEnrollService" />
      <host>
        <baseAddresses>
          <add baseAddress="http://localhost:8010/OEA/Service/EnrollService" />
        </baseAddresses>
      </host>
    </service>
  </services>
  <behaviors>
    <endpointBehaviors>
      <behavior name="webHttp">
        <webHttp/>
      </behavior>
    </endpointBehaviors>
    <serviceBehaviors>
      <behavior name="OEABehavior">
        <serviceMetadata httpGetEnabled="True" />
        <serviceDebug includeExceptionDetailInFaults="True" />
      </behavior>
    </serviceBehaviors>
  </behaviors>
  <serviceHostingEnvironment aspNetCompatibilityEnabled="true" />
</system.serviceModel> 
```

## 客户端代码：

```
HttpWebRequest req = null;
HttpWebResponse res = null;
try
{
    string url = "http://localhost:8010/OEA/Service/EnrollService/enroll";
    req = (HttpWebRequest)WebRequest.Create(url);
    req.Method = "POST";
    req.ContentType = "application/xml; charset=utf-8";
    req.Timeout = 30000;
    req.Headers.Add("SOAPAction", url);              

    System.Xml.XmlDocument xmlDoc = new System.Xml.XmlDocument();
    xmlDoc.XmlResolver = null;
    xmlDoc.Load(@"d:\test.xml");
    string sXML = xmlDoc.InnerXml;
    req.ContentLength = sXML.Length;
    System.IO.StreamWriter sw = new System.IO.StreamWriter(req.GetRequestStream());
    sw.Write(sXML);
    sw.Close();

    res = (HttpWebResponse)req.GetResponse();
}
catch (Exception ex)
{
    System.Console.WriteLine(ex.Message);
} 
```

## test.xml 的内容

```
<Enroll>
    <ClientId>000</ClientId>
    <AccountNumber>123</AccountNumber>
    <TaxId>123</TaxId>
    <TaxType>123</TaxType>
    <EmailAddress>123</EmailAddress>
    <Pin>123</Pin>
    <State>122</State>
</Enroll> 
```

我在 req.GetResponse() 方法调用上收到“错误请求”异常。刚开始学习REST。我坚持使用 POST 请求。任何帮助将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-26T18:52:59.110

您的 POST 有效负载应该是：

```
<Enroll xmlns="http://www.test.com/Enrollment">
<ClientId>000</ClientId>
<AccountNumber>123</AccountNumber>
<TaxId>123</TaxId>
<TaxType>123</TaxType>
<EmailAddress>123</EmailAddress>
<Pin>123</Pin>
<State>122</State>
</Enroll> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-26T17:49:56.913

您的 XML 命名空间是错误的。我没有时间为您更正它，但需要根据您的数据合同位于“ [http://www.test.com/Enrollment ”命名空间中。](http://www.test.com/Enrollment)

# linux - malloc 是否会为 Linux（和其他平台）上的分配懒惰地创建支持页面？

> ID：911860
> 
> 赞同：75
> 
> 时间：2009-05-26T17:40:49.363
> 
> 标签：linux, malloc

如果我要在 Linux 上`malloc(1024 * 1024 * 1024)`，malloc 实际上是做什么的？

我确定它为分配分配了一个虚拟地址（通过遍历空闲列表并在必要时创建一个新映射），但它实际上是否创建了 1 GiB 的交换页？或者它`mprotect`是地址范围并在您实际触摸它们时创建页面`mmap`？

（我指定 Linux 是因为[该标准](http://www.opengroup.org/onlinepubs/009695399/functions/malloc.html)对这些细节保持沉默，但我很想知道其他平台也能做什么。）

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-05-26T17:50:18.050

Linux 确实延迟了页面分配，又名。'乐观的内存分配'。您从 malloc 返回的内存没有任何支持，当您触摸它时，您实际上可能会遇到 OOM 条件（如果您请求的页面没有交换空间），在这种情况下[，进程会被毫不客气地终止](http://linux-mm.org/OOM_Killer)。

参见例如[http://www.linuxdevcenter.com/pub/a/linux/2006/11/30/linux-out-of-memory.html](http://www.linuxdevcenter.com/pub/a/linux/2006/11/30/linux-out-of-memory.html)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-26T17:49:07.210

*[9\. 内存](http://www.win.tue.nl/~aeb/linux/lk/lk-9.html)*（Linux 内核的一部分[*，*](http://www.win.tue.nl/~aeb/linux/lk/lk.html) *Andries Brouwer 对 Linux 内核的一些评论）是一个很好的[文档](http://www.win.tue.nl/~aeb/linux/lk/lk.html)[*。*](http://www.win.tue.nl/~aeb/linux/lk/lk.html)*

 *它包含以下程序，这些程序演示了 Linux 处理物理内存与实际内存的对比，并解释了内核的内部结构。

通常，第一个演示程序会在 malloc() 返回 NULL 之前获得大量内存。第二个演示程序将获得小得多的内存，因为之前获得的内存实际上已被使用。第三个程序将获得与第一个程序相同的数量，然后在它想使用它的内存时被杀死。

演示程序1：分配内存而不使用它。

```
#include <stdio.h>
#include <stdlib.h>

int main (void) {
    int n = 0;

    while (1) {
        if (malloc(1<<20) == NULL) {
                printf("malloc failure after %d MiB\n", n);
                return 0;
        }
        printf ("got %d MiB\n", ++n);
    }
} 
```

演示程序2：分配内存并实际触摸它。

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

int main (void) {
    int n = 0;
    char *p;

    while (1) {
        if ((p = malloc(1<<20)) == NULL) {
                printf("malloc failure after %d MiB\n", n);
                return 0;
        }
        memset (p, 0, (1<<20));
        printf ("got %d MiB\n", ++n);
    }
} 
```

演示程序3：先分配，后使用。

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

#define N       10000

int main (void) {
    int i, n = 0;
    char *pp[N];

    for (n = 0; n < N; n++) {
        pp[n] = malloc(1<<20);
        if (pp[n] == NULL)
            break;
    }
    printf("malloc failure after %d MiB\n", n);

    for (i = 0; i < n; i++) {
        memset (pp[i], 0, (1<<20));
        printf("%d\n", i+1);
    }

    return 0;
} 
```

（在运行良好的系统上，如[Solaris](http://en.wikipedia.org/wiki/Solaris_%28operating_system%29)，三个演示程序获得相同数量的内存并且不会崩溃，但请参阅 malloc() 返回 NULL。）

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-26T19:16:00.857

我对同一主题的类似帖子给出了这个答案：

[有些分配器是懒惰的吗？](https://stackoverflow.com/questions/864416/are-some-allocators-lazy)

这开始有点偏离主题（然后我会将它与您的问题联系起来），但是发生的事情类似于您在 Linux 中分叉一个进程时发生的事情。分叉时有一种称为写时复制的机制，它只在内存也被写入时为新进程复制内存空间。这样，如果分叉的进程 exec 立即成为一个新程序，那么您就节省了复制原始程序内存的开销。

回到你的问题，这个想法是相似的。正如其他人指出的那样，请求内存会立即为您提供虚拟内存空间，但实际页面仅在写入时才分配。

这样做的目的是什么？它基本上使 mallocing 内存成为或多或少的恒定时间操作 Big O(1) 而不是 Big O(n) 操作（类似于 Linux 调度程序传播它的方式而不是在一大块中进行）。

为了证明我的意思，我做了以下实验：

```
rbarnes@rbarnes-desktop:~/test_code$ time ./bigmalloc

real    0m0.005s
user    0m0.000s
sys 0m0.004s
rbarnes@rbarnes-desktop:~/test_code$ time ./deadbeef

real    0m0.558s
user    0m0.000s
sys 0m0.492s
rbarnes@rbarnes-desktop:~/test_code$ time ./justwrites

real    0m0.006s
user    0m0.000s
sys 0m0.008s 
```

bigmalloc 程序分配了 2000 万个整数，但对它们不做任何事情。deadbeef 将一个 int 写入每个页面，导致 19531 次写入，而 justwrites 分配 19531 个 int 并将它们清零。如您所见， deadbeef 的执行时间比 bigmalloc 长约 100 倍，比 justwrites 长约 50 倍。

```
#include <stdlib.h>

int main(int argc, char **argv) {

    int *big = malloc(sizeof(int)*20000000); // Allocate 80 million bytes

    return 0;
} 
```

.

```
#include <stdlib.h>

int main(int argc, char **argv) {

    int *big = malloc(sizeof(int)*20000000); // Allocate 80 million bytes

    // Immediately write to each page to simulate an all-at-once allocation
    // assuming 4k page size on a 32-bit machine.

    for (int* end = big + 20000000; big < end; big += 1024)
        *big = 0xDEADBEEF;

    return 0;
} 
```

.

```
#include <stdlib.h>

int main(int argc, char **argv) {

    int *big = calloc(sizeof(int), 19531); // Number of writes

    return 0;
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-27T01:20:25.707

Malloc 从 libc 管理的块中分配内存。当需要额外的内存时，库使用 brk 系统调用进入内核。

内核将虚拟内存页面分配给调用进程。这些页面作为进程拥有的资源的一部分进行管理。当内存被 brk'd 时，不分配物理页。当进程访问 brk'd 页面之一中的任何内存位置时，就会发生页面错误。内核验证虚拟内存是否已分配并继续将物理页面映射到虚拟页面。

页面分配不限于写入，并且与写入时复制完全不同。任何访问（读取或写入）都会导致页面错误和物理页面的映射。

请注意，堆栈内存是自动映射的。也就是说，不需要显式的 brk 将页面映射到堆栈使用的虚拟内存。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-26T18:07:51.713

在 Windows 上，页面已提交（即可用的可用内存减少），但在您触摸页面（读取或写入）之前不会实际分配它们。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-26T17:49:23.480

在大多数类 Unix 系统上，它管理[brk](https://en.wikipedia.org/wiki/Sbrk)边界。VM 在处理器命中时添加页面。至少 Linux 和[BSD](http://en.wikipedia.org/wiki/Berkeley_Software_Distribution)可以做到这一点。

# oracle - 帮助优化 Oracle 查询？

> ID：911864
> 
> 赞同：1
> 
> 时间：2009-05-26T17:41:42.093
> 
> 标签：oracle, optimization

我试图从这个 Oracle 查询中获得更好的性能（这非常慢）。我是 Oracle 初学者，所以也许有人可以指出一个更好的方法来处理这个查询。

我有一张表格，上面有不同家庭的信息。我想根据关系类型提取不同的关系。我想出的解决方案使用哈希联接来查询数据库......

```
select *
from (
  with target_person as (
    select 
      p.person_id,
      p.family_number,
      p.relationship_type_id
    from 
      people p
    where
      p.relationship_type_id = 1 -- parent
  )
  select
    target_person.person_id,
    related_person.related_person_id,
    related_person.relationship_type_id
  from
    target_person,
    people related_person
  where
    target_person.person_id != related_person.person_id
    and target_person.family_number = related_person.family_number
    and related_person.relationship_type_id = 1
); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-26T17:49:24.417

你意识到这等同于这个？：

```
select *
from (
  with target_person as (
    select 
      p.person_id,
      p.family_number,
      p.relationship_type_id
    from 
      people p
    where
      p.relationship_type_id = 1 -- parent
  )
  select
    target_person.person_id,
    related_person.related_person_id,
    related_person.relationship_type_id
  from
    target_person,
    target_person related_person
  where
    target_person.person_id != related_person.person_id
    and target_person.family_number = related_person.family_number
); 
```

所以它真的很简单：

```
SELECT *
FROM people AS l
INNER JOIN people AS r
ON l.family_number = r.family_number
    AND l.relationship_type_id = 1
    AND r.relationship_type_id = 1
    AND l.person_id <> r.person_id 
```

我认为让这个速度最快的方法是在你的人员表上`relationship_type_id`建立一个索引。`family_number``person_id`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T20:30:48.943

为了帮助您进行调整，您可以发布以下信息：

1）对于涉及的表，它们的表定义和表上的索引定义。2) 每个表中大约行数的基本运行 3) 查询的解释计划。获得解释计划： a) 在 sqlplus 中运行解释计划 SET STATEMENT_ID= for < insert your query>; b) 在 sqlplus 中运行 select * from table(dbms_xplan.display('PLAN_TABLE',''));

通过解释计划和表/索引信息，我们可以帮助您更好地调整查询。仅凭查询，我们真的没有太多事情要做。如果您可以提供查询执行的 tkprof，那也会有额外的帮助。

# java - Java 编译器警告严重性

> ID：911866
> 
> 赞同：1
> 
> 时间：2009-05-26T17:41:51.327
> 
> 标签：java, compiler-construction, hudson

**简介**
一些持续集成工具（例如，Hudson）假设编译器会生成不同严重性（也称为优先级）的警告：高、正常和低。
根据编译器警告的数量和严重程度，该工具可以将构建标记为*不稳定*。
如果编译器生成高优先级警告，我希望我的构建不稳定。

我从未在我们的项目中看到任何高（和低）优先级警告——只是正常的，所以我有点怀疑它们是否真的存在。

**问题**
我在哪里可以查看javac 和/或 ecj 生成**的高优先级编译器警告列表。**
或者，也许您可​​以提供一些高优先级警告的示例。

**其他**
相关但可能不同的问题：我怀疑高优先级编译器警告实际上是错误，并且实际上不可能存在使用高优先级警告编译源代码的情况（在这种情况下构建将被破坏）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T18:05:39.720

您可以通过键入以下内容获取*所有*编译器警告的列表：

javac -X

并查看为 -Xlint 选项提供的列表。

Java 并没有真正的“高”与“低”优先级的概念，并且可以说不应该 - 特别是警告可能表明您的项目存在问题，这实际上是特定于您的特定开发模式的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T05:49:22.380

如果您想查看高优先级和低优先级警告，您可以使用 PMD、FindBug 和/或 checkstyle。Checkstyle 特别擅长产生很多非常低优先级的警告。;)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T17:59:13.600

特别提到 Hudson，看起来“扫描日志文件以获取编译器警告”选项在编译器中是通用的，而高优先级、中优先级和低优先级的选项可能适用于能够生成这些严重级别的编译器（例如gcc 或 PC-Lint 或（也许）Eclipse Java 编译器）。我不相信那`javac`有能力做到这一点。

# python - 检测 NumPy 数组是否包含至少一个非数字值？

> ID：911871
> 
> 赞同：141
> 
> 时间：2009-05-26T17:43:47.563
> 
> 标签：python, numpy

我需要编写一个函数来检测输入是否包含至少一个非数字值。如果找到非数字值，我将引发错误（因为计算应该只返回一个数字值）。输入数组的维数事先是未知的——不管 ndim 函数应该给出正确的值。作为一个额外的复杂因素，输入可能是单个浮点数，`numpy.float64`甚至是零维数组之类的奇怪东西。

解决这个问题的明显方法是编写一个递归函数，它遍历数组中的每个可迭代对象，直到找到一个非迭代对象。它将将该`numpy.isnan()`函数应用于每个不可迭代的对象。如果找到至少一个非数字值，则该函数将立即返回 False。否则，如果 iterable 中的所有值都是数字，它最终将返回 True。

这工作得很好，但速度很慢，我希望[NumPy](http://en.wikipedia.org/wiki/NumPy)有更好的方法来做到这一点。什么是更快，更麻木的替代方案？

这是我的模型：

```
def contains_nan( myarray ):
    """
    @param myarray : An n-dimensional array or a single float
    @type myarray : numpy.ndarray, numpy.array, float
    @returns: bool
    Returns true if myarray is numeric or only contains numeric values.
    Returns false if at least one non-numeric value exists
    Not-A-Number is given by the numpy.isnan() function.
    """
    return True 
```

* * *

## 回答 #1

> 赞同：245
> 
> 时间：2009-05-27T00:55:50.407

这应该比迭代更快，并且无论形状如何都可以工作。

```
numpy.isnan(myarray).any() 
```

编辑：快 30 倍：

```
import timeit
s = 'import numpy;a = numpy.arange(10000.).reshape((100,100));a[10,10]=numpy.nan'
ms = [
    'numpy.isnan(a).any()',
    'any(numpy.isnan(x) for x in a.flatten())']
for m in ms:
    print "  %.2f s" % timeit.Timer(m, s).timeit(1000), m 
```

结果：

```
 0.11 s numpy.isnan(a).any()
  3.75 s any(numpy.isnan(x) for x in a.flatten()) 
```

奖励：它适用于非数组 NumPy 类型：

```
>>> a = numpy.float64(42.)
>>> numpy.isnan(a).any()
False
>>> a = numpy.float64(numpy.nan)
>>> numpy.isnan(a).any()
True 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2015-10-09T17:13:34.257

如果无穷大是一个可能的值，我会使用[numpy.isfinite](http://docs.scipy.org/doc/numpy/reference/generated/numpy.isfinite.html#numpy.isfinite)

```
numpy.isfinite(myarray).all() 
```

如果上述计算结果为，`True`则不`myarray`包含或。`numpy.nan``numpy.inf``-numpy.inf`

`numpy.isnan`可以使用`numpy.inf`值，例如：

```
In [11]: import numpy as np

In [12]: b = np.array([[4, np.inf],[np.nan, -np.inf]])

In [13]: np.isnan(b)
Out[13]: 
array([[False, False],
       [ True, False]], dtype=bool)

In [14]: np.isfinite(b)
Out[14]: 
array([[ True, False],
       [False, False]], dtype=bool) 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2019-07-17T20:36:39.983

噗！微秒！永远不要在微秒内解决可以在纳秒内解决的问题。

请注意，接受的答案：

*   遍历整个数据，无论是否找到 nan
*   创建一个大小为 N 的临时数组，这是多余的。

更好的解决方案是在找到 NAN 时立即返回 True：

```
import numba
import numpy as np

NAN = float("nan")

@numba.njit(nogil=True)
def _any_nans(a):
    for x in a:
        if np.isnan(x): return True
    return False

@numba.jit
def any_nans(a):
    if not a.dtype.kind=='f': return False
    return _any_nans(a.flat)

array1M = np.random.rand(1000000)
assert any_nans(array1M)==False
%timeit any_nans(array1M)  # 573us

array1M[0] = NAN
assert any_nans(array1M)==True
%timeit any_nans(array1M)  # 774ns  (!nanoseconds) 
```

并适用于 n 维：

```
array1M_nd = array1M.reshape((len(array1M)/2, 2))
assert any_nans(array1M_nd)==True
%timeit any_nans(array1M_nd)  # 774ns 
```

将此与 numpy 本机解决方案进行比较：

```
def any_nans(a):
    if not a.dtype.kind=='f': return False
    return np.isnan(a).any()

array1M = np.random.rand(1000000)
assert any_nans(array1M)==False
%timeit any_nans(array1M)  # 456us

array1M[0] = NAN
assert any_nans(array1M)==True
%timeit any_nans(array1M)  # 470us

%timeit np.isnan(array1M).any()  # 532us 
```

提前退出方法是 3 个数量级或数量级的加速（在某些情况下）。对于一个简单的注释来说还不算太简陋。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-08-25T00:04:43.780

使用 numpy 1.3 或 svn 你可以做到这一点

```
In [1]: a = arange(10000.).reshape(100,100)

In [3]: isnan(a.max())
Out[3]: False

In [4]: a[50,50] = nan

In [5]: isnan(a.max())
Out[5]: True

In [6]: timeit isnan(a.max())
10000 loops, best of 3: 66.3 µs per loop 
```

比较中对 nans 的处理在早期版本中并不一致。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-05-11T20:52:37.697

`(np.where(np.isnan(A)))[0].shape[0]`将大于`0`如果`A`包含 的至少一个元素`nan`，则`A`可能是`n x m`矩阵。

例子：

```
import numpy as np

A = np.array([1,2,4,np.nan])

if (np.where(np.isnan(A)))[0].shape[0]: 
    print "A contains nan"
else:
    print "A does not contain nan" 
```

# php - 我在用 php 连接 sqlite_popen() 时遇到问题

> ID：911875
> 
> 赞同：0
> 
> 时间：2009-05-26T17:44:22.320
> 
> 标签：php, sqlite

我有 php 和 sqlite 的问题。我总是有这样的警告：

警告：sqlite_popen() [function.sqlite-open]：文件已加密或不是数据库。

我传递给连接的名称是数据库 sqlite3。我不知道如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T17:48:54.510

sqlite_open() 仅支持 sqlite2。

如果要使用 sqlite3，则必须切换到 PDO。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T17:49:38.630

我猜你有一个使用 sqlite3 创建的数据库，而方法调用需要一个 sqlite（版本 2）数据库。改用 sqlite3 PHP API；这是[文档](http://php-sqlite3.sourceforge.net/pmwiki/pmwiki.php/Main/API)。

请注意，sqlite3 支持是使用 PHP 5.3.0[编译的。](http://de2.php.net/manual/en/sqlite3.installation.php)然后像

```
$db = sqlite3_open(":memory:"); 
```

应该足够了。

# java - 是否可以在两个类之间使用 RMI 双向？

> ID：911882
> 
> 赞同：13
> 
> 时间：2009-05-26T17:46:51.473
> 
> 标签：java, connection, rmi

我想在两个类（A 和 B）之间共享一些信息，它们在不同的 java 程序中运行。我不想编写一个完整的通信协议，而是为此目的使用 java 内置 rmi 类。目前 B 类能够远程运行属于 A 类的方法。是否可以在 A 类中使用相同的“连接”来调用 B 类的方法？否则我可能不得不实施第二个 rmi 服务......

BR,

马库斯

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-26T18:16:00.777

如果`B`实现`Remote`，它可以导出并作为 RMI 调用中的参数传递给`A`. 在这种情况下，不需要`B`在 RMI 注册表中注册，因为客户端被显式地传递了对它的引用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-05T11:08:25.560

我在客户端和服务器之间实现了 2 路 RMI，服务器使用 Registry 公开其存根

1.  客户端获取服务器的存根
2.  然后客户端将其作为 Observer 的存根放入服务器的 addObserver 方法
3.  服务器使用此存根通知客户端

下面的代码将给出一个更好的主意

```
import java.rmi.*;
import java.rmi.registry.*;
import java.rmi.server.*;
import java.util.Observable;
import java.util.Observer;
import java.net.*;

import javax.rmi.ssl.SslRMIClientSocketFactory;
import javax.rmi.ssl.SslRMIServerSocketFactory;

interface ReceiveMessageInterface extends Remote
{
    /**
     * @param x
     * @throws RemoteException
     */
    void receiveMessage(String x) throws RemoteException;

    /**
     * @param observer
     * @throws RemoteException
     */
    void addObserver(Remote observer) throws RemoteException;
}

/**
 * 
 */
class RmiClient extends UnicastRemoteObject
{
    /**
     * @param args
     */
    static public void main(String args[])
    {
        ReceiveMessageInterface rmiServer;
        Registry registry;
        String serverAddress = args[0];
        String serverPort = args[1];
        String text = args[2];
        System.out.println("sending " + text + " to " + serverAddress + ":" + serverPort);
        try
        { // Get the server's stub
            registry = LocateRegistry.getRegistry(serverAddress, (new Integer(serverPort)).intValue());
            rmiServer = (ReceiveMessageInterface) (registry.lookup("rmiServer"));

            // RMI client will give a stub of itself to the server
            Remote aRemoteObj = (Remote) UnicastRemoteObject.exportObject(new RmiClient(), 0);
            rmiServer.addObserver(aRemoteObj);

            // call the remote method
            rmiServer.receiveMessage(text);
            // update method will be notified
        }
        catch (RemoteException e)
        {
            e.printStackTrace();
        }
        catch (NotBoundException e)
        {
            System.err.println(e);
        }
    }

    public void update(String a) throws RemoteException
    {
        // update should take some serializable object as param NOT Observable
        // and Object
        // Server callsbacks here
    }
}

/**
 * 
 */
class RmiServer extends Observable implements ReceiveMessageInterface
{
    String address;
    Registry registry;

    /**
     * {@inheritDoc}
     */
    public void receiveMessage(String x) throws RemoteException
    {
        System.out.println(x);
        setChanged();
        notifyObservers(x + "invoked me");
    }

    /**
     * {@inheritDoc}
     */
    public void addObserver(final Remote observer) throws RemoteException
    {
        // This is where you plug in client's stub
        super.addObserver(new Observer()
        {
            @Override
            public void update(Observable o,
                Object arg)
            {
                try
                {
                    ((RmiClient) observer).update((String) arg);
                }
                catch (RemoteException e)
                {

                }
            }
        });
    }

    /**
     * @throws RemoteException
     */
    public RmiServer() throws RemoteException
    {
        try
        {
            address = (InetAddress.getLocalHost()).toString();
        }
        catch (Exception e)
        {
            System.out.println("can't get inet address.");
        }
        int port = 3232;
        System.out.println("this address=" + address + ",port=" + port);
        try
        {
            registry = LocateRegistry.createRegistry(port);
            registry.rebind("rmiServer", this);
        }
        catch (RemoteException e)
        {
            System.out.println("remote exception" + e);
        }
    }

    /**
     * 
     * @param args
     */
    static public void main(String args[])
    {
        try
        {
            RmiServer server = new RmiServer();
        }
        catch (Exception e)
        {
            e.printStackTrace();
            System.exit(1);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T17:55:21.520

自从我使用 RMI 以来已经有一段时间了，但是 IIRC 如果 B 类实现`java.rmi.Remote`并将对自身实例的引用作为参数传递给 A 类中的方法，那么 A 类应该接收一个存根并且调用它的方法将是在原始实例上调用。

但是，如果您有很多这样的 RMI 调用来回调用，您可能会遇到性能问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T21:11:21.543

如果您将`B`作为参数传递给 in 的方法`A`，然后使用该引用调用方法，`B`我相当肯定反向连接已建立，并且我相当肯定 RMI Registry 是为`B`驻留的 JVM 创建的。在某些时候，这给我们带来了一些特别严格的防火墙规则的麻烦。我们的代码看起来有点像

*网络服务器*

```
public int uploadFile(FileItem fileItem){
    return ApplicationClassLoader
        .get(DocumentManager.class)
        .attachFile(new RemoteInputStreamImpl(fileItem.getInputStream());
    )
} 
```

*应用服务器*

```
public int attachFile(RemoteInputStream in){
    ...

    byte[] buffer;
    while((buffer = in.read(1024)) != null) // Would return null to indicate EOF
      // Do some stuff

    return documentId;       
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-26T17:49:39.673

但是，如果没有第二个 RMI 服务器，B 类如何知道 A 类呢？我认为您将需要两台服务器。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-05-26T18:09:14.503

两个 JVM 都需要实现 RMI 服务。但这确实很容易查看 java.rmi 中的各种类。

您不能以某种方式使用一个 RMI 连接并进行双向通信。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-05-26T22:04:08.100

一些 RMI 服务支持回调或侦听器，它们允许服务器异步调用同一连接下的客户端。（抱歉，我不记得执行此操作的开放库的名称，快速 google 不是很有帮助）标准 RMI 不支持这一点，相反，您还需要将客户端公开为 RMI 服务。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2010-07-24T10:52:55.557

RMI 双向：

**服务器：**

```
import java.io.IOException;
import java.rmi.Naming;
import java.rmi.RemoteException;
import java.util.logging.Level;
import java.util.logging.Logger;

public class RMISERVER {

   public RMISERVER() throws IOException {

       Thread t;
        try {
            t = new Prou_run();
            t.start();
        } catch (RemoteException ex) {
            Logger.getLogger(RMISERVER.class.getName()).log(Level.SEVERE, null, ex);
        }

   }

   public static void main(String args[]) throws IOException {
     new RMISERVER();
   }
}

import java.io.File;
import java.io.IOException;
import java.net.ServerSocket;
import java.net.Socket;
import java.rmi.Naming;
import java.rmi.Remote;
import java.rmi.registry.Registry;
import java.rmi.server.RMIClientSocketFactory;
import java.rmi.server.RMIServerSocketFactory;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.tree.DefaultMutableTreeNode;

//extends java.rmi.server.UnicastRemoteObject
public class Prou_run extends Thread implements Runnable{

            New_Object  root = null,root2=null,root3=null,root4=null,root5;
              New_Object new_root=null;
            Object xt = null, xt2=null , xt3=null;
            Registry r1,r2;
            RMIClientSocketFactory csf,csf2;
            RMIServerSocketFactory ssf,sf2;

            new_Patryk npal;

 public Prou_run() throws java.rmi.RemoteException, IOException
 {
         if (System.getSecurityManager() == null) {
            System.setSecurityManager(new SecurityManager());
                  }

//            csf = new RMIClientSocketFactory() {
//
//                public Socket createSocket(String host, int port) throws IOException {
//                    return new Socket("rmi://localhost/getchil",1080);
//                }
//            };
//            csf2 = new RMIClientSocketFactory() {
//
//                public Socket createSocket(String host, int port) throws IOException {
//                   return new Socket("rmi://localhost/getchild",1081);
//                }
//            };
//            ssf=new RMIServerSocketFactory() {
//
//                public ServerSocket createServerSocket(int port) throws IOException {
//                    return new ServerSocket(1099);
//                }
//            };// ssf.createServerSocket(1099);
//              sf2=new RMIServerSocketFactory() {
//
//                public ServerSocket createServerSocket(int port) throws IOException {
//                   return new ServerSocket(1098);
//                }
//            };//sf2.createServerSocket(1098);
       try {
         r1=java.rmi.registry.LocateRegistry.createRegistry(1098);
                 r2=java.rmi.registry.LocateRegistry.createRegistry(1099);//, csf2, ssf);
                 java.rmi.registry.LocateRegistry.createRegistry(1097);
                 java.rmi.registry.LocateRegistry.createRegistry(1095);
                 java.rmi.registry.LocateRegistry.createRegistry(1096);
         System.out.println("RMI registry ready.");
      } catch (Exception e) {
         System.out.println("Exception starting RMI registry:");
         e.printStackTrace();
      }
        this.xt = null;this.xt2 = null;this.xt3 = null;
        npal = new new_Patryk();
        System.out.println("sdmmmfxxxxxxxx");

   }

    public void run() {

//while(true){

      try{

//             root =  new_root;
//             xt=npal.getChild((File)new_root.getob(), (int)new_root.geti());
             New_ObjectIMPL sl = new New_ObjectIMPL();
             sl.i=354;
                System.out.println("sdmmmf2");
                //r2
             Naming.rebind("rmi://localhost:1099/getchild",(New_Object) sl);
                System.out.println("sdmmmf3");

         }catch (Exception e) {
       System.out.println("Trouble: " + e);
     }

        while(new_root==null){
            try{
                 //System.out.println("sdmmmf1"   +   new_root.geti());
         new_root = (New_Object) Naming.lookup("rmi://localhost:1080/getchil");
         System.out.println("sdmmmf1"   +   new_root.geti());
            }catch (Exception e) {
       System.out.println("Trouble: " + e);
     }
        }
    }

}

/**
 *
 * @author austinchuma
 */
public interface New_Object extends java.rmi.Remote {

     public int geti() throws java.rmi.RemoteException;

     public Object getob() throws java.rmi.RemoteException;

     public Object getobchild() throws java.rmi.RemoteException;

      public boolean getbbol() throws java.rmi.RemoteException;

       public byte[] getb() throws java.rmi.RemoteException;

}

public class New_ObjectIMPL extends java.rmi.server.UnicastRemoteObject implements New_Object

{
   Object ob = null,obchild = null;
    int  i=0;
    boolean bol = false;
    byte[] b = null;

    public New_ObjectIMPL() throws RemoteException{
        ob = null;obchild = null;
        i=0;
        bol = false;
        b = null;
    }

    public int geti() throws RemoteException {
       return i;
           }

    public Object getob() throws RemoteException {

       return ob;
    }

    public Object getobchild() throws RemoteException {
       return obchild;
    }

    public boolean getbbol() throws RemoteException {
      return bol;
    }

    public byte[] getb() throws RemoteException {

        return b;

    }

} 
```

# django - 如何让 Django 管理员的“现场查看”链接正常工作？

> ID：911887
> 
> 赞同：14
> 
> 时间：2009-05-26T17:48:55.540
> 
> 标签：django, django-admin, django-sites

我一直在使用 Django 应用程序，并且 Django 管理界面运行良好，*除了*“现场查看”链接不起作用。每当我尝试使用它时，我都会收到一条`OperationalError`消息：`no such table: django_site`. 我已经对此问题进行了一些研究，看来我必须设置[Django 站点框架](http://docs.djangoproject.com/en/1.0/ref/contrib/sites/)才能使此链接正常工作，但我完全确定如何做到这一点。该文档讨论了数据库表等，但没有说明如何实际设置站点。所以我的问题实际上是双重的：

1.  如何设置站点框架？我是否必须自己创建表格（并自己输入数据），还是我必须启用某些东西`./manage.py syncdb`才能自动“检测”我想要设置表格？
2.  当我在本地开发时（即仅在本地主机上运行而不是在我的实际域名上运行），设置站点框架会影响我吗？我是否必须添加一些`settings.py`喜欢的东西`SITE_ID = 2 if DEBUG else 1`，或者`manage.py`只是检测到我正在调试站点上而不对站点框架做任何事情？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-26T23:10:24.580

在模型上定义 a `get_absolute_url`。管理员使用该方法来确定如何构造对象 url。请参阅[文档](http://docs.djangoproject.com/en/dev/ref/models/instances/)。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-26T18:02:08.977

推杆

```
'django.contrib.sites', 
```

进入您的 INSTALLED_APPS 和以下内容

```
$ ./manage.py syncdb 
```

可能就足够了。

安装后，编辑站点实例（例如通过`/admin`界面）以反映您的本地主机名（例如`localhost:8000`）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-02-04T16:10:50.240

正如其他人所传达的，除了启用 view_on_site 之外，这还需要几个额外的步骤。您必须在模型中实现 get_absolute_url()，并在项目设置中启用站点。

## 设置 view_on_site 设置

将 view_on_site 设置添加到管理表单：

```
class MymodelAdmin(admin.ModelAdmin):
    ...
    view_on_site = True
...
admin.site.register(Mymodel, MymodelAdmin) 
```

## 实现 get_absolute_url()

将[get_absolute_url()](https://docs.djangoproject.com/en/1.10/ref/models/instances/#get-absolute-url)添加到您的模型中。在模型.py 中：

```
Mymodel(models.Model):
    ...
    def get_absolute_url(self):
        return "/mystuff/%i" % self.id 
```

## 启用站点

在 yourapp/settings.py 中添加站点：

```
INSTALLED_APPS = (
    ...
    'django.contrib.sites',
    ...
) 
```

然后更新数据库：

```
$ python manage.py migrate 
```

## 完毕！

查看[reverse()](https://docs.djangoproject.com/en/1.10/ref/urlresolvers/#django.urls.reverse)以获得在 get_absolute_url() 中生成路径的更复杂的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-10T19:44:27.640

当您在 settings.py 中编辑了 SITE_ID 或管理员认为的站点实例时，请不要忘记重新启动 Web 服务器以使更改生效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-11-18T17:35:40.180

在我看来，站点功能的视图仅在`get_absolute_url`引用 Django 视图时才有效。如果您尝试创建一个链接，它似乎不起作用，该链接重定向到 Django 无法控制的页面（即使它是由 apache 本身从同一个域提供的）。

在这种情况下，很容易通过覆盖 admin tempale 手动创建按钮，如下所示：

```
{% extends "admin/change_form.html" %}
{% block object-tools-items %}
{{ block.super }}
  <li>
    <a class="viewsitelink" href="{{ original.get_absolute_url }}">View on my site, out of Django's control</a>
  </li>
{% endblock %} 
```

另外，添加`view_on_site = False`到您的`ModelAdmin`班级，否则两个按钮都会出现。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-05-24T01:24:54.270

# .net - .net datapager + listview + Intelligencia.UrlRewriter

> ID：911896
> 
> 赞同：0
> 
> 时间：2009-05-26T17:50:14.227
> 
> 标签：.net, url-rewriting

我在具有列表视图控件和数据分页器的页面上使用 Intelligencia.UrlRewriter。数据分页工作正常，但分页器使用真实 URL 而不是重写一个。

如果 URL 重写是：

```
/products-page-1.aspx?page=2 
```

和真实网址：

```
/products.aspx?id=1 
```

寻呼机使用`/products.aspx?id=1&page=2`

我希望能够设置它以便寻呼机使用：

```
/products-page-1.aspx?page=2 
```

我在网上找到了一些信息，并使其与以下功能一起使用：

```
protected void VideosDataPager_PreRender(object sender, EventArgs e)
{

   DataPager pager = (DataPager)Page.FindControl("VideosDataPager");

   int count = pager.TotalRowCount;
   int pageSize = pager.PageSize;
   int pagesCount = count / pageSize + (count % pageSize == 0 ? 0 : 1);
   int pageSelected = pager.StartRowIndex / pageSize + 1;

   for (int i = 1; i <= pagesCount; ++i)
   {
       if (pageSelected != i)
       {
           HyperLink link = new HyperLink();
           link.NavigateUrl = "/products--page--" + catnameforPaging + "--1.aspx?p=" + i.ToString();
           link.Text = i.ToString();
           VideosList.Controls.Add(link);

       }
       else
       {
           Literal lit = new Literal();
           lit.Text = i.ToString();
           VideosList.Controls.Add(lit);
       }

       Literal space = new Literal();
       space.Text = " ";
       VideosList.Controls.Add(space);
   }
} 
```

但是有了这个，我得到了 2 个数据页，如果我从页面中删除 VideosDataPager，该函数将停止工作。

有什么方法可以更改数据分页器上的目标 URL？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T19:04:32.207

固定

```
protected void VideosDataPager_PreRender(object sender, EventArgs e) 
```

{

```
 DataPager pager = (DataPager)Page.FindControl("VideosDataPager");
   pager.Controls.Clear();

   int count = pager.TotalRowCount;
   int pageSize = pager.PageSize;
   int pagesCount = count / pageSize + (count % pageSize == 0 ? 0 : 1);
   int pageSelected = pager.StartRowIndex / pageSize + 1;

   if (pageSelected>1)
   {
   // first page
   HyperLink img = new HyperLink();
   img.ImageUrl = "/images/first.png";
   img.Text = "First page";
   img.NavigateUrl = "/videos--cat--" + catnameforPaging + "--1.aspx?s="+ NvUtils.GetCurrentSessionKey();
   VideosList.Controls.Add(img);
   // gap
   Literal space = new Literal();
   space.Text = " ";
   VideosList.Controls.Add(space);
   }

   // paging

   for (int i = 1; i <= pagesCount; ++i)
   {
       if (pageSelected != i)
       {
           HyperLink link = new HyperLink();
           link.NavigateUrl = "/videos--cat--" + catnameforPaging + "--1.aspx?s="+ NvUtils.GetCurrentSessionKey()+"&p=" + i.ToString();
           link.Text = i.ToString();
           VideosList.Controls.Add(link);

       }
       else
       {
           Literal lit = new Literal();
           lit.Text = i.ToString();
           VideosList.Controls.Add(lit);
       }

       Literal spaceb = new Literal();
       spaceb.Text = " ";
       VideosList.Controls.Add(spaceb);

  }
   if (pageSelected < pagesCount)
   {

       // last page
       HyperLink imgb = new HyperLink();
       imgb.ImageUrl = "/images/last.png";
       imgb.Text = "Last page";
       imgb.NavigateUrl = "/videos--cat--" + catnameforPaging + "--1.aspx?s=" + NvUtils.GetCurrentSessionKey() + "&p=" + pagesCount;
       VideosList.Controls.Add(imgb);
   } 
```

}

# wpf - Window 中的 CommandBinding 不会从 ContextMenu 捕获命令的执行

> ID：911904
> 
> 赞同：4
> 
> 时间：2009-05-26T17:53:23.753
> 
> 标签：wpf, command

一个非常简单直接的例子。

我有一个窗户。它设置了 CommandBindings 以捕获 RoutedUICommand 执行。

```
<Window
   ...
   >
   <Window.CommandBinding>
       <CommandBinding 
           Command="{x:Static local:Commands.Command1}"  
           Executed="OnCommand1Executed" 
           CanExecute="OnCanCommand1Execute" 
           />
   </Window.CommandBinding>
</Window> 
```

窗口中托管了一个 UserControl，其中声明了一个 ContextMenu。ContextMenu 项具有分配给相同 RoutedUICommand 的 Command 属性。

```
<ContextMenu>
    <MenuItem Command="{x:Static local:Commands.Command1}" />
</ContextMenu> 
```

但菜单项保持非活动状态（== 禁用）。不知何故，命令执行不会进入窗口。也许是因为 ContextMenu 在弹出窗口内？

如果我将所需的 CommandBinding 添加到 ContextMenu.CommandBindings 集合中，一切都会正常工作。但是，如果没有一个“全局”CommandBinding 的位置，这是一个糟糕的选择。

我怎样才能以最好的方式解决问题？

UPD：事实证明它并没有那么糟糕。**命令不仅在用户第一次**打开菜单时绑定。如果它关闭并重新打开一切都很好。尽管如此，这似乎是不可取的，而且是一种非常奇怪的行为。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-07T19:55:17.210

如果添加 Focus(); 是否仍然会发生这种情况？在 InitializeComponent() 之后；在 Windows 构造函数中？

这听起来像 WPF 在从上下文菜单中查找可视化树时遇到问题。将焦点设置到主窗口可能会修复它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-22T16:19:09.347

我们如何在用户控件中处理这个问题？在这种情况下，焦点似乎不起作用

更新：我在这里找到了解决方案[How to set CommandTarget for MenuItem inside a ContextMenu?](https://stackoverflow.com/questions/616206/wpf-usercontrol-and-commands-oh-my)

似乎它与CommandTarget有关

```
<MenuItem x:Name="mnuProperties" Header="_Properties"
          Command="{x:Static localcommands:TaskCommands.ViewTaskProperties}"
          CommandTarget="{Binding PlacementTarget,
          RelativeSource={RelativeSource FindAncestor,AncestorType={x:Type ContextMenu}}}"/> 
```

# python - 如果你实现 __getattribute__ 有没有办法访问形式参数

> ID：911905
> 
> 赞同：4
> 
> 时间：2009-05-26T17:53:29.917
> 
> 标签：python, python-datamodel

似乎`__getattribute__`只有 2 个参数`(self, name)`。

但是，在实际代码中，我拦截的方法实际上是带参数的。

无论如何可以访问这些论点吗？

谢谢，

查理

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-26T18:06:57.940

**__getattribute__**只返回请求的属性，如果是方法，则使用**__call__**接口调用它。

与其返回方法，不如返回一个包装器，例如：

```
def __getattribute__(self, attr):
     def make_interceptor(callble):
         def func(*args, **kwargs):
             print args, kwargs
             return callble(*args, **kwargs)
         return func
     att = self.__dict__[attr]
     if callable(att):
        return make_interceptor(att) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T18:06:50.840

Python中的方法调用是两步过程，首先查找一个函数，然后调用它。有关更复杂的讨论，请参阅我对[这个问题](https://stackoverflow.com/questions/852308/how-the-method-resolution-and-invocation-works-internally-in-python/870650#870650)的回答。

所以你需要做这样的事情：

```
def __getattribute__(self, key):
    if key == "something_interesting":
        def func(*args, **kwargs):
            # use arguments, and possibly the self variable from outer scope
        return func
    else:
        return object.__getattribute__(self, key) 
```

此外，覆盖 __getattribute__ 通常是个坏主意。因为它在所有属性访问上都被调用，所以很容易陷入无限循环，即使你做的一切正确，它最终也会对性能造成很大的影响。您确定 __getattr__ 不足以满足您的目的吗？或者甚至可能是一个返回函数的描述符对象。描述符通常更擅长重用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-10T11:08:25.400

这是 Unknown 建议的一个变体，它返回一个可调用的“包装器”实例来代替请求的函数。这不需要装饰任何方法：

```
class F(object):
   def __init__(self, func):
      self.func = func
      return
   def __call__(self, *args, **kw):
      print "Calling %r:" % self.func
      print "  args: %r" % (args,)
      print "  kw: %r" % kw
      return self.func(*args,**kw)

class C(object):
   def __init__(self):
      self.a = 'an attribute that is not callable.'
      return
   def __getattribute__(self,name):
      attr = object.__getattribute__(self,name)
      if callable(attr):
         # Return a callable object that can examine, and even
         # modify the arguments prior to calling the method.
         return F(attr)
      # Return the reference to any non-callable attribute.
      return attr
   def m(self, *a, **kw):
      print "hello from m!"
      return

>>> c=C()
>>> c.a
'an attribute that is not callable.'
>>> c.m
<__main__.F object at 0x63ff30>
>>> c.m(1,2,y=25,z=26)
Calling <bound method C.m of <__main__.C object at 0x63fe90>>:
  args: (1, 2)
  kw: {'y': 25, 'z': 26}
hello from m!
>>> 
```

[上面的 Ants Aasma](https://stackoverflow.com/questions/911905/is-there-a-way-to-access-the-formal-parameters-if-you-implement-getattribute/911943#911943)在使用`__getattribute__`. 它被 上的**所有**属性查找调用`self`，甚至是`__getattribute__`方法内部的那些。其他几个示例包括对`self.__dict__`inside 的引用，`__getattribute__`这将导致递归，直到超过最大堆栈深度！`__getattribute__`为避免这种情况，请使用（例如`object.__getattribute__(self,name)`.）的基类版本之一

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T17:58:47.643

老实说，我不确定我是否理解你的问题。如果您想要一种方法来覆盖 getattribute 并保留您可以使用的原始属性[`__dict__`](http://docs.python.org/library/stdtypes.html#object.__dict__)

```
def __getattribute__(self, attr):
    if attr in self.__dict__:
          return self.__dict__[attr]
    # Add your changes here 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-26T18:08:57.967

我不认为你可以。`__getattribute__`不拦截方法调用，只拦截方法名查找。所以它应该返回一个函数（或可调用对象），然后将使用调用站点指定的任何参数调用该函数。

特别是，如果它返回一个接受 的函数`(*args, **kwargs)`，那么在该函数中，您可以根据需要检查参数。

我认为。我不是 Python 专家。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-26T18:45:48.360

是的

```
def argumentViewer(func):
    def newfunc(*args, **kwargs):
        print "Calling %r with %r %r" % (func, args, kwargs)
        return func(*args, **kwargs)
    return newfunc

class Foo(object):
    def __getattribute__(self, name):
        print "retrieving data"
        return object.__getattribute__(self, name)

    @argumentViewer
    def bar(self, a, b):
        return a+b

# Output
>>> a=Foo()
>>> a.bar
retrieving data
<bound method Foo.newfunc of <__main__.Foo object at 0x01B0E3D0>>
>>> a.bar(2,5)
retrieving data
Calling <function bar at 0x01B0ACF0> with (<__main__.Foo object at 0x01B0E3D0>, 2, 5) {}
7 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-07-15T13:47:37.720

感谢[ASk的](https://stackoverflow.com/users/62569/ask) [回答](https://stackoverflow.com/a/911944/1322849)（非常感谢您的朋友）我设法解决了我的问题，但是我不得不更换

```
 att = self.__dict__[attr] 
```

和

```
att = type(self).__dict__[attr].__get__(self, type(self)) 
```

这是使用类装饰器的工作示例：

```
def getattribute(self, name):
    if name.startswith('__') and name.endswith('__'):
        return object.__getattribute__(self, name)
    s = '*** method "%s" of instance "%s" of class "%s" called with'\
        ' following'
    print s % (name, id(self), self.__class__.__name__),

    def intercept(call, name):
        def func(*args, **kwargs):
            print 'args: {}, kwargs: {} ***'.format(args, kwargs)
            c = call(*args, **kwargs)
            print '*** "%s" finished ***' % name
            return c
        return func
    a = type(self).__dict__[name].__get__(self, type(self))
    if callable(a):
        return intercept(a, name)
    return object.__getattribute__(self, name)

def inject(cls):
    setattr(cls, '__getattribute__', getattribute)
    return cls

@inject
class My_Str(object):
    def qwer(self, word='qwer'):
        print 'qwer done something here...' 
```

# image - 代码演示的插图

> ID：911907
> 
> 赞同：0
> 
> 时间：2009-05-26T17:53:58.387
> 
> 标签：image, dependency-injection, inversion-of-control, presentation

我收到了一个奇怪的请求，我担心它会因为离题而被关闭。就这样吧，但值得一试。

我正在创建一个关于依赖注入和控制反转的演示文稿，我想我会通过展示我以前见过的图像来强调可互换的部分服务于一个共同的目的，但有不同的实现。

基本上图像是男人或女人，但图像分为四个部分：

*   头
*   躯干
*   呃……不知道这部分的名字，胃等等。
*   腿
*   可能有五分之一的脚

对于每个部分，您都可以在几个变体中进行选择，从而在此过程中创造出奇怪的人。IE。一个男人的躯干和一个女人的头。

但是，我现在当然找不到这样的图像。有谁知道这样的图片，可以给我一个网址吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T18:02:49.727

首先，胃将包含在躯干中（除非您区分内部和外部）。我会把“武器”作为第四部分。

至于插图，有“构建自己的角色”网络应用程序来创建辛普森和南方公园的角色（可能还有很多其他角色）。你可以试试其中一种。

# asp.net - 我可以使用什么工具来分析 Asp.Net 中的 ViewState？

> ID：911916
> 
> 赞同：2
> 
> 时间：2009-05-26T17:58:41.653
> 
> 标签：asp.net, viewstate

如果已经问过同样的问题，我深表歉意。我就是找不到。请指出正确的问题，我关闭这个问题。

你能推荐任何可以帮助我分析 ASP.NET ViewState 的工具吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T18:00:27.233

[视图状态助手](http://www.iis.net/downloads/default.aspx?tabid=34&g=6&i=1342)

[ASP.NET Web 开发助手](http://projects.nikhilk.net/WebDevHelper/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-26T18:01:44.487

你可以使用[提琴手](http://www.fiddler2.com/fiddler2/)

# java - 对数组或集合中的元素进行有效的 Drools 评估

> ID：911917
> 
> 赞同：1
> 
> 时间：2009-05-26T17:58:47.143
> 
> 标签：java, drools

使用 Drools 3.0.6（旧的，我知道），在已知、固定且相当大的数组或集合中查找事实的有效评估是什么（包含的倒数，即“包含在”中）。使用 OR 系列的正常“等于”会导致 StackOverflowError，因为数组/集合可以包含几千个条目，因为 Drools 二元运算符评估是递归的。

我们有一个单一的值事实和一个要匹配的值数组。当前的“代码”如下所示：

```
$f: Fact(name="TheFact", $data)
eval(!($data.equals("1") || $data.equals("2") || $data.equals("3") ... )) 
```

对于大量固定值（1,2,3，...）。我正在寻找更像“$data in (1,2,3, ...)”的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-10-24T19:10:55.630

有时您需要（或者它更具可读性）将一些评估放入对象本身。然后你可以将 eval 语句减少到类似`eval(!$f.isInRange(1, 200))`

# windows - 如何判断是否从 .Net（托管）代码中的 Windows 服务调用方法

> ID：911921
> 
> 赞同：1
> 
> 时间：2009-05-26T18:00:03.803
> 
> 标签：windows, service, managed

如何判断我在托管代码中编写的方法是从交互式应用程序还是从 Windows 服务调用的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T18:02:37.807

您想了解 Windows 服务的哪一部分？或者您不想了解交互式应用程序的哪个部分？什么对你来说真正重要？

* * *

每当我听到这样的要求时，这几乎总是设计上的错误。我建议几个答案：

1.  让调用者告诉你使用哪个格式化程序，或者
2.  将格式化程序类的名称放入配置文件中。让所有格式化程序实现相同的接口。在运行时，第一次需要格式化程序时，创建配置文件中指定的格式化程序的实例，并通过公共接口调用它。
3.  不要重新发明轮子。使用 System.Diagnostics 中的类，事实上，它的配置很像我的 #2。

代码对调用它的上下文敏感几乎总是一个错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T18:57:20.707

我想我可能已经弄清楚了（至少这可以满足我的需要——你的里程可能会因你想要做的事情而有所不同）。有一个悬挂在 Environment 对象上的属性，称为“UserInteractive”。它会告诉您是否在可以访问桌面的上下文中运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T18:13:22.963

至少有两种方法可以做到这一点：

1.  “System.Reflection.Assembly.GetCallingAssembly().FullName”将返回调用您的代码的程序集的名称。
2.  “Environment.StackTrace”将返回调用您的代码的完整堆栈跟踪。您应该在字符串中看到您的调用方法名称。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T18:31:54.457

您可以定义两种不同的记录器：一种用于交互式应用程序，另一种用于 Windows 服务。并让客户使用配置文件选择他想使用的记录器。如果客户端选择了错误的记录器或忘记配置，您也可以使用默认记录器。我认为拥有可配置的日志记录和格式化消息等功能应该是一个更好的主意。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T19:01:08.860

不知道是否有内置的可能性，但看看`System.Diagnostics.Process`类。除其他外，它还有一种`GetService()`方法，也许会对您有所帮助。如果失败，则有`StartInfo`可能包含有用信息的成员。

如果不介意使用 PInvoke，可以获取当前进程的父进程。如果它在帐户*NT AUTHORITY\SYSTEM*下运行并且它的名称是*service.exe*，那么当前进程（很可能）是一个服务。

# python - Python 最佳实践：抽象语法树

> ID：911930
> 
> 赞同：9
> 
> 时间：2009-05-26T18:02:13.860
> 
> 标签：python, abstract-syntax-tree

## 修改抽象语法树

我希望能够构建和修改一个`ast`，然后可以选择将其写为 python 字节码，以便稍后执行而无需开销。

我一直在研究 and 的ast文档[，](http://docs.python.org/dev/py3k/library/ast.html)但我似乎找不到任何关于此类代码最佳实践的良好资源。`python3.0``python2.6`

## 问题

在 python 中修改抽象语法树有哪些最佳实践和指南？

## [编辑]

[Unknown](https://stackoverflow.com/users/57757/unknown)指出[byteplay](http://code.google.com/p/byteplay/)是此类库的一个很好的例子。

此外，本[福德](http://www.aminus.net/geniusql)还引用了[GeniuSQL](https://stackoverflow.com/users/103377/benford)，它使用抽象语法树将 Python 代码转换为 SQL。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-26T18:55:35.127

除了手册和源代码之外，你自己。这个主题和 python 字节码是非常无证的。

或者，您可以尝试使用我听说过的好消息但尚未尝试过的这个 python 字节码库：

[http://code.google.com/p/byteplay/](http://code.google.com/p/byteplay/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T16:05:56.547

我认为geniusql正在做一些事情来将ast翻译成sql...有一个关于它的讨论但我找不到它 - 而且我无论如何都不允许链接:-(

# c# - 在哪里可以找到要在 Visual Studio 2008 中使用的 C# 应用程序的分析器？

> ID：911932
> 
> 赞同：6
> 
> 时间：2009-05-26T18:02:40.880
> 
> 标签：c#, visual-studio-2008, profiling

我正在为我在 Visual Studio 2008 中开发的 C# 应用程序寻找探查器。我正在寻找价格低廉（首选开源）并且可以集成到 VS2008 中的东西。我找到了[Visual Studio Profiler](http://blogs.msdn.com/ianhu/archive/2005/02/07/368779.aspx)，但我不知道如何使用它。我安装了依赖于 Visual Studio 的独立版本（我猜不是独立的？），但是工具菜单中没有出现任何东西，就像他们的演练所说的那样。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-26T18:09:00.430

这是开源 .Net[分析器](http://csharp-source.net/open-source/profilers)的列表。

我已经使用并喜欢 Red Gate 的[Ants-Profiler](http://www.red-gate.com/products/ants_performance_profiler/index.htm)，但它确实要花钱（非常值得，恕我直言）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-26T18:07:12.463

Visual Studio Profiler 仅是 Team System 的一部分。它不包含在 Visual Studio Professional 中。

有一个名为[nprof](http://code.google.com/p/nprof/)的免费 .NET 分析器，但它尚未发布，而且它可能相当不稳定。此外，还有一些优秀的商业分析器，例如[Red Gate 的 ANTS Profiler](http://www.red-gate.com/products/ants_performance_profiler/index.htm)；然而，这些都不是低成本的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-26T18:29:28.143

查看[EQATEC 分析器](http://www.eqatec.com/tools/profiler)，免费且运行良好。也适用于 ASP.NET 和 .NET CF。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-26T18:12:05.073

我的推荐是 dotTrace。不是免费的，个人许可证的价格是 170 欧元。

[http://www.jetbrains.com/profiler/index.html](http://www.jetbrains.com/profiler/index.html)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-26T18:09:54.813

我使用[AQtime](http://www.automatedqa.com/products/aqtime/)取得了巨大的成功。

如前所述， [ANTS](http://www.red-gate.com/products/ants_performance_profiler/index.htm)也是一个不错的选择。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-26T18:14:45.647

如果您只想进行内存分析，[.NET Memory Profiler](http://memprofiler.com/)非常棒。它有一个试用期和之后的小成本 - 非常值得。如果你想花点钱，[DevPartner Studio](http://www.compuware.com/products/devpartner/studio.htm)非常好。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-27T12:05:07.157

对于性能调整，与内存诊断相反，有一种[简单的方法可以做到这一点](https://stackoverflow.com/questions/375913/what-can-i-use-to-profile-c-code-in-linux/378024#378024)。

这是违反直觉的，但您所要做的就是在 IDE 下运行程序，当它运行缓慢时，暂停它几次，检查调用堆栈以了解它为什么在做它正在做的事情。很有可能多个样本会显示它正在做一些你可以消除的事情。节省的时间大致等于包含您修复的代码的样本部分。

它“又快又脏”，但与大多数分析器不同，它指出了需要注意的实际语句，而不仅仅是包含它们的函数。它还直接粗略估计了通过修复它们可以预期的加速。它不会被递归混淆，它避免了调用树的困难，即一个问题在任何分支中可能很小，但由于分布在许多分支上而可能很大。

我取了几个样本 N，通常不超过 20 个。如果在堆栈中间的某个地方有一个热点或恶意方法调用，占用了执行时间的一小部分 F，那么将显示它的样本数是 NF +- sqrt (NF(1-F)。例如，如果 N=20 和 F=0.15，将显示它的样本数是 3 +- 1.6，所以我很有可能找到它。

通常 F 更像是 0.5，因此显示它的样本数是 10 +- 2.2，因此不会错过。

请注意，这与代码的速度或运行频率完全无关。如果优化它会为您节省一定百分比的时间，这决定了为您显示它的样本百分比。

通常有多个地方需要优化。如果问题 1 的 F1=0.5，问题 2 的 F2 = 0.1，那么如果你修复了问题 1（程序速度加倍），那么 F2 通常会增加那个因子，达到 0.2。所以你可以再做一次，并确保找到问题 2。这样，你可以解决一系列问题，直到代码实际上是最优的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-26T18:10:50.910

[在这个 stackoverflow 线程](https://stackoverflow.com/questions/3927/what-are-some-good-net-profilers)中有一些关于 .NET 分析器的讨论。我曾经使用过一些[CLR Profiler](http://www.microsoft.com/downloads/details.aspx?FamilyId=A362781C-3870-43BE-8926-862B40AA0CD0&displaylang=en)，它帮助我解决了之前软件中的一些性能问题。可能值得一试。Microsoft 已发布[有关如何使用 CLR Profiler 的指南](http://msdn.microsoft.com/en-us/library/ms979205.aspx)。

# javascript - 将任何 JavaScript 值转换为字符串的最短方法是什么？

> ID：911938
> 
> 赞同：1
> 
> 时间：2009-05-26T18:05:41.717
> 
> 标签：javascript

我有一个功能，说：

```
setValue: function(myValue) {
  ...
} 
```

调用者可能会传递一个字符串、数字、布尔值或对象。我需要确保向下传递的值是一个字符串。这样做最安全的方法是什么？我意识到有很多方法可以将某些类型（例如日期）转换为字符串，但我只是在寻找开箱即用的合理方法。

我可以写一系列 typeof 语句：

```
if (typeof myValue == "boolean") {}
else if () {}
... 
```

但这很容易出错，因为可能会丢失类型。

Firefox 似乎支持编写如下内容：

```
var foo = 10; foo.toString() 
```

但这适用于所有网络浏览器吗？我需要支持 IE 6 及更高版本。

简而言之，在涵盖每种类型的同时进行转换的最短方法是什么？

-埃里克

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-26T18:08:15.173

```
var stringValue = String(foo); 
```

甚至更短

```
var stringValue = "" + foo; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T18:08:59.307

```
value += ''; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T18:10:03.253

如果您`myValue`用作字符串，Javascript 会隐式将其转换为字符串。如果您需要向 Javascript 引擎提示您正在处理字符串（例如，使用 + 运算符），您可以在 IE6 及更高版本中安全地使用 toString。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T20:09:36.583

还有一种方式是这样的：

```
var stringValue = (value).toString(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T18:09:05.330

强制字符串上下文怎么样，例如“”+foo？

# c# - LinqToSql 中的子查询是否保证与父查询的顺序相同？

> ID：911942
> 
> 赞同：2
> 
> 时间：2009-05-26T18:06:46.410
> 
> 标签：c#, .net, linq, linq-to-sql

假设我有一个带有 DateTime 字段和一个 int 字段的表，并执行如下查询：

```
var query = context.tblSomeTable.Where(s=>s.Name == "Hello World").OrderBy(s=>s.SignUpDate); 
```

如果我随后对结果执行两个子查询，它们是否仍按日期排序？：

```
var sub1 = query.Where(s=>s.Id = 5);
var sub2 = query.Where(s=>s.Id = 8); 
```

我的直觉说它们仍然有序，但是原始查询是否已经迭代/执行是否重要？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-26T18:14:16.503

是的，但是，说它们“仍然”被订购是错误的。它们在最后被订购一次。

关于 LinqtoSql 需要注意的重要一点是，它只是构建一个查询，在*使用*时执行。在您展示的示例中，您实际上还没有使用查询。您刚刚构建了两个大查询

它们都将生成以下 SQL 语句：

```
select * from tblSomeTable s
where s.Name = 'Hello World' and s.ID == @p1
order by s.SignUpDate 
```

当你使用 sub1 时，@p1 将被设置为 5

（实际上，“Hello World”也将作为参数传递......）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T18:13:48.720

是的，它仍然保持相同的顺序。在您的情况下，第一个查询将是 IOrderedQueryable，当您进一步查询时，sub1 和 sub2 也将是 IOrderedQueryable，因此将保持排序。

# asp.net-mvc - 超时后 MVC 将授权用户重定向到错误的 url

> ID：911946
> 
> 赞同：0
> 
> 时间：2009-05-26T18:07:25.940
> 
> 标签：asp.net-mvc, security, forms-authentication

我已将我的 MVC 项目发布到 IIS 6 服务器。在应用程序 MVCapp 下运行。Web 项目获取 url：www.domain.com/MVCapp/。

我使用表单登录进行身份验证，并在发布后遇到问题。

web.config 如下：

```
<authentication mode="Forms">
<forms name="CTWebCookie" loginUrl="~/Account/Login" defaultUrl="~/Home/Index" slidingExpiration="true" protection="All" timeout="20"/>
</authentication> 
```

例如，如果我在操作中运行以下代码：

```
FormsAuthentication.SignOut();
FormsAuthentication.RedirectToLoginPage(); 
```

..一切都很好，用户被重定向到 www.domain.com/MVCapp/Account/Login。

但是，当身份验证超时时 - 在下一页请求中，用户将被重定向到 www.domain.com/Account/Login。应用程序根未路由，并且 url 指向 IIS 根。

如何让应用程序在授权超时后解析正确的 url，为什么它在以编程方式退出时起作用，而不是在自动退出时不起作用？

请指教。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T18:21:37.533

ASP.NET MVC 项目模板使用`~/Account/Login`. 检查您的 web.config：

```
<authentication mode="Forms">
    <forms loginUrl="~/Account/Login" ... />
</authentication> 
```

**更新：**

IIS 根目录 (www.domain.com/) 上是否有任何应用程序？如果是这样 - 尝试从 IIS 中删除此应用程序。您也可以在 Site.Master 中添加这一行：

```
 <%= System.Web.Security.FormsAuthentication.LoginUrl %> 
```

查看您的 loginUrl 是否正是 /MVCapp/Account/Login 或其他任何内容

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T16:12:40.807

没关系，想通了（愚蠢的错误），不过感谢您的帮助。

问题是登录页面上的 javascript 在异步请求的情况下将页面重新加载为 target.top。javascript 中的 url 未正确解析。

# ip - 在 Patricia Trie 中查找最长前缀搜索的算法/步骤

> ID：911947
> 
> 赞同：7
> 
> 时间：2009-05-26T18:07:35.957
> 
> 标签：ip, lookup, patricia-trie

我正在实施 Patricia 尝试进行 IP 前缀查找，我可以让代码为完整的键匹配工作，但遇到前缀搜索问题，当键是其他键的前缀时，例如：

```
1.2.3.0
1.2.0.0 
```

在上述情况下，任何人都可以帮助我使用前缀搜索算法我应该将它们视为单独长度的键（即/24 和 16）吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-12-18T08:51:53.180

看看 Net-Patricia。这是用于查找 IP 地址的 Patricia trie 的实现。接口是perl，但底层代码是C。这是一个链接，但许多CPAN档案应该有它：

[http://cpansearch.perl.org/src/PHILIPP/Net-Patricia-1.15_07/libpatricia/​​patricia.c](http://cpansearch.perl.org/src/PHILIPP/Net-Patricia-1.15_07/libpatricia/patricia.c)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-11-04T21:27:55.580

如果您使用此 trie 将 IP 编号存储为固定长度的元素，那么这绝对不是正确的方法。这里的重点是 PT 对于存储可变长度数据特别有用。

如果您将部分 IP 号码存储为可变长度的前缀，那么 PT 是一个不错的选择。
在这种情况下，是的，您的密钥应该具有不同的长度。
假设您将前缀“192.168”存储在二进制 0xC0 0xA8 中，您将其添加为第一个键。
然后，在搜索 192.168.1.1 之类的 IP 时，您可以获得有关您的 trie 包含 192.168 的信息，这是您要查找的内容的前缀。

您所要做的就是在遍历特里树时存储“公共部分”。 [这是对this](http://www.codeproject.com/KB/string/PatriciaTrieTemplateClass.aspx)
的一个小补充执行。只需确保在走下 trie 时，您将公共部分存储在递归函数的参数中的某个位置。
为了更好地理解 Patricia trie，我建议阅读[Robert Sedgewick 的算法书](http://www.cs.princeton.edu/~rs/)，这是一个很好的知识来源。

**编辑**：在 PT 中存储 C 字符串时存在一个问题。该 trie 旨在存储二进制数据，但您只对获取整个字节感兴趣。确保仅当前缀的大小为 8 的倍数时才存储前缀的公共部分。举个错误的例子：你的树中有键：0xC0 0xA5，你正在寻找 0xC0 0xA6。当公共部分“0xC0 0xA”时，您的遍历将停止，但您只对“0xC0”感兴趣。因此，请确保存储公共字节，而不是位。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-23T20:07:27.677

LLVM 的测试代码中有一个相当可读的 C 实现：[https ://llvm.org/svn/llvm-project/test-suite/trunk/MultiSource/Benchmarks/MiBench/network-patricia/](https://llvm.org/svn/llvm-project/test-suite/trunk/MultiSource/Benchmarks/MiBench/network-patricia/)

# git - 使用 git 安全部署网站

> ID：911959
> 
> 赞同：2
> 
> 时间：2009-05-26T18:09:24.393
> 
> 标签：git, deployment

我有一个受版本控制的网站。为了便于将其部署到服务器，我正在考虑将 repo 克隆到服务器，每当我想更新页面时，只需从服务器中提取更改。从安全的角度来看，将 .git 文件夹留在网络服务器上是一个坏主意吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T18:19:35.200

您可以在 中放置任意文件`.git`，例如`.htaccess`阻止通过 Web 服务器进行任何访问的文件。

如果您想要一个额外的安全层（`.htaccess`例如，如果您在重新克隆存储库时忘记将其放在那里），您可以让您的 Web 服务器拒绝提供其中包含`.git/`的任何 URL（如果您使用`mod_rewrite`Apache，其他 Web 服务器将使用其他机制）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-07-02T06:38:10.783

使用类似`git --git-dir=... checkout .`This 使您可以拥有`.git`html 树之外的目录。您甚至可以通过添加以下内容来使用裸仓库`--work-tree`：

```
git --git-dir=... --work-tree=... checkout 
```

使用裸仓库避免了树的冗余副本，并且更适合推入。

也可以使用环境变量指定相同的内容。`git`手册页有详细信息。

# image - 仅图像 Web 分析可以跟踪什么？

> ID：911973
> 
> 赞同：0
> 
> 时间：2009-05-26T18:13:13.323
> 
> 标签：image, analytics, web-analytics

我知道只有图像的网络分析可以跟踪访问，但它可以跟踪的只是这些吗？它是否可以跟踪唯一访问者或任何比普通访问更多的内容？假设我是第三方，试图将仅 html 分析放在诸如 myspace 之类的网站上。我究竟能追踪什么？任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T18:38:01.043

通过来自同一 IP/用户代理的重复访问，它仍然能够在一定程度上跟踪唯一性。可以获取用户代理（浏览器、操作系统等），并且站点可以将图像 URL 中的其他信息（如用户 ID、引用 URL 等）作为变量传递。

# ruby-on-rails - 负百分比大于大于百分比（即 -%> 与 %>）

> ID：911985
> 
> 赞同：8
> 
> 时间：2009-05-26T18:16:01.757
> 
> 标签：ruby-on-rails

我是 Ruby on Rails 的新手，正在学习此处发布的教程：[http ://www.tutorialspoint.com/ruby-on-rails/index.htm](http://www.tutorialspoint.com/ruby-on-rails/index.htm)

我遇到的一个问题是，我看到在整个代码示例中都很少使用它：

```
<%= link_to c.title, {:action => 'show', :id => c.id} -%> 
```

在其他时候，我看到这个：

```
<%= link_to 'Edit', {:action => 'edit', :id => c.id} %> 
```

具体来说，我想知道在结束之前是否有减号 (-) 的原因，`%>`或者它是否只是代表作者的错字。

在旁注中，我尝试在 google 和 SO 上搜索类似的问题，但`-%>`并不完全是 google 友好的搜索词。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-26T18:48:13.127

`<%-`在开始标记 ( ) 之后或结束标记 ( ) 之前的短划线`-%>`分别修剪标记之前或之后的所有空白。最常见的用途，例如您上面提到的，是用于`-%>`避免在代码后插入换行符。

# c# - 如何从文件中拆分我想要的文本？

> ID：911990
> 
> 赞同：1
> 
> 时间：2009-05-26T18:18:16.933
> 
> 标签：c#

嗨，这是我在文件中得到的内容：

```
AT+CMGL="全部"  
+CMGL: 6123,"REC 读取","+923315266206"  
B 相信上帝可以让文德看起来 2 b 没有办法。即使你的思想可能会动摇，上帝正在代表你在幕后工作。度过充满信心的一天  
+CMGL: 6122,"REC 读取","+923315266206"  
B 相信上帝可以让文德看起来 2 b 没有办法。即使你的思想可能会动摇，上帝正在代表你在幕后工作。度过充满信心的一天

-------------------------------------------------- -------------------------------------------
```

我只想从文件中获取行，即文本。比如“B自信........waver”。我该怎么做 ？

我尝试拆分但我无法让它运行.....:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-26T18:25:00.787

使用 StreamReader 读取文件并使用 ReadLine 方法，该方法将一次读取文件一行。

```
using (StreamReader reader = File.OpenText(fileName))
{
    while (!reader.EndOfStream)
    {
        string line = reader.ReadLine();
        // do something with the line
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T18:26:36.683

以下会将您的行放入字符串数组中：

```
string[] lines = File.ReadAllLines(pathToFile); 
```

所以：

```
lines[2];
lines[4]; 
```

会给你那些台词。

请参阅 ReadAllLines 的 msdn[文档](http://msdn.microsoft.com/en-us/library/s2tte0y1.aspx)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T18:39:41.647

看起来样本中不是“有效”的每一行都包含 text `"+CGML"`。在这种情况下，这应该可以解决问题：

```
public static IEnumerable<string> GetText(string filePath)
{
    using (StreamReader sr = new StreamReader(filePath))
    {
        string line;
        while ( (line = sr.ReadLine()) != null)
        {
           if (line.IndexOf("+CMGL") < 0) yield return line;
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T18:29:25.257

可以使用 streamReader 读取行并使用正则表达式匹配某些行...如果有您想要匹配的模式。

例子：

```
using System.IO;
using System.Text.RegularExpressions;

Regex pattern = new Regex("^B");
List<string> lines = new List<string>();
using (StreamReader reader = File.OpenText(fileName))
{
    while (!reader.EndOfStream)
    {
        string line = reader.ReadLine();
         Match patternMatch = pattern.Match(blah);

            if (patternMatch.Groups.Count > 0)
            {
                lines.Add(blah);
            }
    }
} 
```

# regex - 如何在不使用非贪婪字符的情况下在 1 次匹配后停止正则表达式匹配

> ID：911991
> 
> 赞同：1
> 
> 时间：2009-05-26T18:18:20.723
> 
> 标签：regex, full-text-search, search

无论如何，是否有一个正则表达式模式在一次匹配后自动停止搜索。我想将正则表达式搜索添加到我正在尝试创建的 Web 服务中，但我不希望有人能够运行需要很长时间的正则表达式，只要一个匹配就足够了。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T18:25:50.117

即使使用限制量词，您仍然可能会得到一个长时间运行的正则表达式。

实现像[这个线程](https://stackoverflow.com/questions/910740/cancelling-a-long-running-regex-match)讨论的可中断功能是另一种选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T18:24:37.373

真正糟糕的退化模式永远不会匹配。如果你找到了找到退化病例的好方法，那么你可能会得到[很多钱](http://en.wikipedia.org/wiki/Halting_problem)。超时可能会更好。在 Perl 中，我会[`alarm`](http://perldoc.perl.org/functions/alarm.html)结合使用 block [`eval`](http://perldoc.perl.org/functions/eval.html)。

您可能还在Perl 中寻找[(*COMMIT)以防止回溯。](http://perldoc.perl.org/perlre.html#%27%28%2aCOMMIT%29%27)

# checkbox - 如何使用 Firebug 跟踪不显眼的 onclick

> ID：911992
> 
> 赞同：2
> 
> 时间：2009-05-26T18:18:32.503
> 
> 标签：checkbox, jqgrid, onclick

我最近一直在使用[jqGrid 3.5](http://www.trirand.com/blog/)，但我注意到当我动态添加一个复选框输入时，它不能被点击（但它似乎没有被禁用）。所以我试图搜索作为控件一部分的大量 js 依赖项，但似乎找不到任何“不允许”我的复选框切换的东西。我的问题是 - 我如何使用 firebug 来查找可能导致此行为的任何事件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-26T18:38:58.153

jQuery 将事件存储在 DOM 元素的[jQuery 数据存储中。](http://docs.jquery.com/Internals/jQuery.data)使用控制台：

```
$("#yourelement").data("events"); 
```

单击您在控制台窗口中获得的结果。绑定到元素的事件显示为该对象的属性。点击“function”可以跳转到这个函数的源代码。在任何函数中放置一个断点以查看发生了什么。

如果元素上没有 id，请在选择器中使用 :eq(index) 以仅返回其中一个结果。 [http://docs.jquery.com/Selectors](http://docs.jquery.com/Selectors)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T18:29:29.547

我将首先使用 firebug 查看复选框的 dom 属性。

当您创建复选框时，您是否放置了任何 javascript 来响应某人切换它？

您可能想在不同的浏览器上尝试它，看看这是否是浏览器特定的功能，这将有助于故障排除。**********