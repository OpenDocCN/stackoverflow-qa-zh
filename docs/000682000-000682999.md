# StackOverflow 问答 000682000-000682999

# jquery - 使用 JQuery Validate Plugin 想要提醒字段未填写，但仍保存

> ID：682002
> 
> 赞同：0
> 
> 时间：2009-03-25T15:02:07.723
> 
> 标签：jquery, validation

我正在使用[JQuery Validation](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)插件并且对验证有疑问。如果我在表单上有 3 个文本字段，即 textboxA、textboxB 和 textboxC。我需要让 textboxA 和 textboxB 需要保存，但我想提醒 textboxC 没有填写。

例如：textboxA 和 textboxB 有数据并且表单已提交，给用户的警报会说明 textboxC 未填写，您是否要继续。如果用户单击是，则保存表单。

另一方面，如果 textboxA 和 textboxB 被填写，而 textboxB 为空白。这会在提交时提醒您无法保存，因为未填写 textboxB。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T15:18:16.280

我会尝试[自定义验证](http://jquery.bassistance.de/validate/demo/custom-methods-demo.html)，您的验证功能将如下所示：

```
$.validator.addMethod("textboxC_validation", function(value) {
    return confirm('Are you sure you dont want to enter something in textboxC?');
}, 'Please enter something in textboxC!'); 
```

然后将其设置为您输入的规则：

```
rules: {
    textboxC: "textboxC_validation",
} 
```

我以前做过类似的事情，但以上内容未经测试

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T15:10:03.213

为什么不直接禁用“保存”按钮，除非 textboxA 和 textboxB 不为空。

当两个必填字段都填写完成后按钮启用时，检查'C'是否为空，如果是，则调用confirm（'Are you sure, C is not added etc'）。

我建议使用这种方法，在页面中有一条消息告诉用户 A 和 B 是必需的，C 是可选的，而不是等待用户窒息并给他弹出错误消息。

# user-interface - 以数据为中心的 Web 应用程序设计书籍/文章推荐

> ID：682005
> 
> 赞同：2
> 
> 时间：2009-03-25T15:02:28.660
> 
> 标签：user-interface, web-applications, usability

我正在设计一个处理大量数据的 Web 应用程序。我发现很难以一种可用的、直观的方式呈现这些数据。数据必须是可排序/可搜索的，并且数据之间的关系应该是显而易见的（记录可以有“子项”）。

有没有专门解决这个问题的书？我不是在寻找一般的网页设计书籍或一般的可用性书籍。但是，如果有一般书籍特别好地处理这个主题，请务必提及。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T19:34:21.680

The books "The Visual Display of Quantitative Information" or "Envisioning Information" by Edward R. Tufte could be helpful.

They don't deal with web applications, but if I've read your question correctly you problem is more of a general nature and not specifically attached to web application development.

# asp.net - 可以在 llblgen 数据源上使用多个过滤器吗？

> ID：682011
> 
> 赞同：0
> 
> 时间：2009-03-25T15:04:21.727
> 
> 标签：asp.net, llblgenpro

我有以下（示例）代码来过滤来自 LLBLGen 数据源的搜索结果：

```
IPredicateExpression firstFilter = new PredicateExpression();
firstFilter.Add(new FieldLikePredicate(CustomerFields.FirstName, null, txtSearchFirst.Text.Trim() + "%"));
llbldsCustomer.FilterToUser = firstFilter;
llbldsCustomer.DataBind();
gridview1.DataBind(); 
```

当我触发此代码时，这可以正常工作并过滤结果。但是，如果我添加第二个过滤器，我必须按两次调用代码才能看到结果。下面是带有 2 个过滤器的片段：

```
IPredicateExpression firstFilter = new PredicateExpression();
firstFilter.Add(new FieldLikePredicate(CustomerFields.FirstName, null, txtSearchFirst.Text.Trim() + "%"));
firstFilter.Add(new FieldLikePredicate(CustomerFields.LastName, null, txtSearchLast.Text.Trim() + "%"));
llbldsCustomer.FilterToUser = firstFilter;
llbldsCustomer.DataBind();
gridview1.DataBind(); 
```

在第一次搜索之后，每次搜索都可以解决问题；但是，我需要它来处理第一个。

更新：代码位于 ASP.Net 按钮单击事件中。Page Load 事件块中也没有影响此数据源的代码。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T15:11:41.257

我无法复制您在简单测试用例中看到的行为（见下文）。此外，除非您在数据源上使用参数绑定，否则不必在 DataSource 控件上调用 DataBind，而只需在 GridView 上调用。

* * *

测试用例：

DB 包含 1 个表 Customer，其中包含两个 varchar(50) 字段：FirstName 和 LastName。

默认.aspx：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="Default.aspx.cs" Inherits="TestWebApp1._Default" %>
<%@ Register Assembly="SD.LLBLGen.Pro.ORMSupportClasses.NET20" Namespace="SD.LLBLGen.Pro.ORMSupportClasses" TagPrefix="llblgenpro" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" >
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <asp:TextBox ID="TextBox1" runat="server"></asp:TextBox>
        <asp:Button ID="Button1" runat="server" onclick="Button1_Click" Text="Button" />
        <br />
        <br />
    <asp:GridView ID="CustomersGridView" runat="server" DataSourceID="dsCustomers">
    </asp:GridView>
    </div>
    <llblgenpro:LLBLGenProDataSource ID="dsCustomers" runat="server" 
        DataContainerType="EntityCollection" 
        EntityCollectionTypeName="TestWebApp1Framework.CollectionClasses.CustomerCollection, TestWebApp1Framework">
    </llblgenpro:LLBLGenProDataSource>
    </form>
</body>
</html> 
```

默认.aspx.cs：

```
using System;
using SD.LLBLGen.Pro.ORMSupportClasses;
using TestWebApp1Framework.HelperClasses;

namespace TestWebApp1
{
    public partial class _Default : System.Web.UI.Page
    {
        protected void Button1_Click(object sender, EventArgs e)
        {
            var filter = new PredicateExpression();
            filter.Add(new FieldLikePredicate(CustomerFields.FirstName, null, TextBox1.Text.Trim() + "%"));
            filter.AddWithOr(new FieldLikePredicate(CustomerFields.LastName, null, TextBox1.Text.Trim() + "%"));
            dsCustomers.FilterToUse = filter;
            dsCustomers.DataBind();
            CustomersGridView.DataBind();
        }
    }
} 
```

测试结果：加载此页面最初会显示所有客户。在文本框中输入字母 A 并单击按钮会显示名字或姓氏以 A 开头的所有客户的列表。这表明两个过滤器都正常工作。

# svn - 如何在允许轻松分支的同时将共享 IP 合并到多个项目中？

> ID：682014
> 
> 赞同：0
> 
> 时间：2009-03-25T15:04:43.600
> 
> 标签：svn, version-control, bitkeeper

在无法访问 git 和 git-submodule 的情况下，我需要将一个共享 IP 存储库合并到两个单独的项目存储库中，同时最大限度地减少分支的开销。任何一个项目的人都需要能够轻松地分支出他们项目的主干线，同时也分支出共享 IP 存储库。如果/当用户修改共享 IP 存储库并且他们准备将他们的编辑重新合并到他们项目的主线主干中时，他们的编辑也将针对另一个项目的主线进行回归，以确保他们的编辑与两个项目兼容。

我知道用 git 做这件事相对容易（除了持续集成到项目主线中的机制——自制脚本），但是在 Subversion 和 Bitkeeper 中有没有简单的方法来做到这一点？

编辑：'svn:externals' 几乎解决了我的 subversion 问题，但如果外部存储库不在 Subversion 中怎么办。

bitkeeper 是否有相当于 'svn:externals' 或 'git-submodule' 的功能？这可以通过客户端后克隆挂钩来完成吗？如何？

编辑：好的。我想我知道如何做到这一点。如果您需要将公共 ip-reuse repo 拉入 Subversion 和 BitKeeper，您需要在 Subversion 中拥有公共重用 repo，以便您可以使用 'svn:externals' ，如 emk 所示。对于 BitKeeper，您需要创建一个传入后触发器，该触发器知道从 subversion 服务器执行结帐命令。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T15:19:14.843

在 Subversion 中，您可以使用[Subversion externals](http://svnbook.red-bean.com/en/1.1/ch07s04.html)，或者在您的 Subversion 树中简单地复制必要的目录：

```
svn cp svn+ssh://.../libs/foo/trunk svn+ssh://.../projects/bar/trunk/libs/foo 
```

要在本地修改代码，只需提交到 projects/bar/trunk/libs/foo。

有趣的部分是合并来自 lib/foo/trunk 的新更改。在这种情况下，您希望继续进行正常的 Subversion 合并。[（如果您使用的是 Subversion 1.5，](http://subversion.tigris.org/svn_1.5_releasenotes.html#merge-tracking)这会更容易。如果您使用的是 Subversion 1.4，则需要手动应用补丁。）

不幸的是，我没有使用 BitKeeper 的经验。

# c# - 从 c# 批量数据库插入的最佳方法是什么？

> ID：682015
> 
> 赞同：30
> 
> 时间：2009-03-25T15:04:44.753
> 
> 标签：c#, sql-server

我如何/进行批量数据库插入的最佳方法是什么？

在 C# 中，我遍历一个集合并为集合中的每个项目调用一个插入存储过程。

如何在一个数据库调用中发送所有数据？

例如，假设我有一个`List<Person>`包含 10 个项目的人员列表 ( )。我目前正在调用 InsertPerson 存储过程 10 次。我想将其减少到 1 个电话。

我正在使用 MS SQL Server 2005。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2010-03-30T20:15:48.857

CsharperGuyInLondon，这里是一个简单的 SqlBulkCopy 代码示例：

```
using System.Data.SqlClient;

DataTable table = new DataTable("States");
// construct DataTable
table.Columns.Add(new DataColumn("id_state", typeof(int))); 
table.Columns.Add(new DataColumn("state_name", typeof(string)));

// note: if "id_state" is defined as an identity column in your DB,
// row values for that column will be ignored during the bulk copy
table.Rows.Add("1", "Atlanta");
table.Rows.Add("2", "Chicago");
table.Rows.Add("3", "Springfield");

using(SqlBulkCopy bulkCopy = new SqlBulkCopy(connectionString))
{
  bulkCopy.BulkCopyTimeout = 600; // in seconds
  bulkCopy.DestinationTableName = "state";
  bulkCopy.WriteToServer(table);
} 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-03-25T15:10:35.410

嗯，10 件不是我所说的散装，但对于更大的套装，`SqlBulkCopy`是你的朋友。您需要做的就是提供一个`DataTable`或一个`IDataReader`（我的首选选项，因为我喜欢流式 API）。[我在这里](http://groups.google.co.uk/group/microsoft.public.dotnet.languages.csharp/msg/91c7a20056ffe8e1)做了类似的事情（你可以忽略 xml 方面 - 只是将 SimpleDataReader 子类化）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-25T15:08:29.377

.NET [SqlBulkCopy](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlbulkcopy.aspx)类运行良好。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-10-20T14:04:30.840

重新为 SqlBulkCopy 解决方案，我创建了一个类而不是`Datatable`一个或`List<T>`一个缓冲区大小（`CommitBatchSize`）。它将使用扩展名（在第二类中）将列表转换为数据表。

它工作得非常快。在我的 PC 上，我能够在 10 秒内插入超过 1000 万条复杂记录。

这是课程：

```
using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Data.SqlClient;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace DAL
{

public class BulkUploadToSql<T>
{
    public IList<T> InternalStore { get; set; }
    public string TableName { get; set; }
    public int CommitBatchSize { get; set; }=1000;
    public string ConnectionString { get; set; }

    public void Commit()
    {
        if (InternalStore.Count>0)
        {
            DataTable dt;
            int numberOfPages = (InternalStore.Count / CommitBatchSize)  + (InternalStore.Count % CommitBatchSize == 0 ? 0 : 1);
            for (int pageIndex = 0; pageIndex < numberOfPages; pageIndex++)
                {
                    dt= InternalStore.Skip(pageIndex * CommitBatchSize).Take(CommitBatchSize).ToDataTable();
                BulkInsert(dt);
                }
        } 
    }

    public void BulkInsert(DataTable dt)
    {
        using (SqlConnection connection = new SqlConnection(ConnectionString))
        {
            // make sure to enable triggers
            // more on triggers in next post
            SqlBulkCopy bulkCopy =
                new SqlBulkCopy
                (
                connection,
                SqlBulkCopyOptions.TableLock |
                SqlBulkCopyOptions.FireTriggers |
                SqlBulkCopyOptions.UseInternalTransaction,
                null
                );

            // set the destination table name
            bulkCopy.DestinationTableName = TableName;
            connection.Open();

            // write the data in the "dataTable"
            bulkCopy.WriteToServer(dt);
            connection.Close();
        }
        // reset
        //this.dataTable.Clear();
    }

}

public static class BulkUploadToSqlHelper
{
    public static DataTable ToDataTable<T>(this IEnumerable<T> data)
    {
        PropertyDescriptorCollection properties =
            TypeDescriptor.GetProperties(typeof(T));
        DataTable table = new DataTable();
        foreach (PropertyDescriptor prop in properties)
            table.Columns.Add(prop.Name, Nullable.GetUnderlyingType(prop.PropertyType) ?? prop.PropertyType);
        foreach (T item in data)
        {
            DataRow row = table.NewRow();
            foreach (PropertyDescriptor prop in properties)
                row[prop.Name] = prop.GetValue(item) ?? DBNull.Value;
            table.Rows.Add(row);
        }
        return table;
    }
} 
```

}

这是我想插入自定义对象列表`List<PuckDetection>`( `ListDetections`) 的示例：

```
var objBulk = new BulkUploadToSql<PuckDetection>()
{
        InternalStore = ListDetections,
        TableName= "PuckDetections",
        CommitBatchSize=1000,
        ConnectionString="ENTER YOU CONNECTION STRING"
};
objBulk.Commit(); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-25T15:07:29.147

您可以构建一个 BLOB（图像）并将其作为参数发送到存储过程。在存储过程中，您可以使用 substring() 获取所有项目。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-25T15:12:15.687

这是一个很好的例子`SqlBulkCopy`：

[http://blogs.msdn.com/nikhilsi/archive/2008/06/11/bulk-insert-into-sql-from-c-app.aspx](http://blogs.msdn.com/nikhilsi/archive/2008/06/11/bulk-insert-into-sql-from-c-app.aspx)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-25T16:01:46.007

我将列表构造为 xml 字符串并将其传递给存储的过程。在 SQL 2005 中，它增强了 xml 功能来解析 xml 并进行批量插入。

查看这篇文章： [使用 XML 参数将列表传递给 SQL Server 2005](http://weblogs.asp.net/jgalloway/archive/2007/02/16/passing-lists-to-sql-server-2005-with-xml-parameters.aspx)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-25T15:06:28.447

将您的数据转储到一个以管道分隔的文本文件（或者如果您的数据中有管道，则为其他内容）文本文件并使用[Bulk Insert](http://msdn.microsoft.com/en-us/library/ms188365.aspx)。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-25T15:09:03.697

您可以使用 Xml 文档进行更新，Sql 2005 与它们配合得很好。每行一个节点，但 Xml 只有一个参数。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-25T15:17:46.250

创建一个包含所有要插入的项目的 XML 文档。然后在存储过程中，使用 TSQL xml 支持 ( [OPENXML](http://msdn.microsoft.com/en-us/library/ms186918.aspx) ) 从 XML 文档中读取所有数据并将其插入到您的表中，希望每个表都有一个插入语句。

但是，如果您只是将数据插入到单个表中并且不需要任何数据库端逻辑，为什么不使用[SqlBulkCopy](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlbulkcopy.aspx)呢？

# ms-access - 如何在 VBA 代码中在运行时更改 MS Access 子窗体的视图？

> ID：682030
> 
> 赞同：5
> 
> 时间：2009-03-25T15:09:02.823
> 
> 标签：ms-access, vba

这似乎是一件简单的事情，我确信我以前做过，但是我已经有一段时间没有在 Access 中进行任何 UI 编程了。我需要做的是在表单上放置一个按钮，以便在子表单的数据表和表单视图之间切换。

我找到了一个 defaultview 属性，但是在它已经打开后，它看起来不会切换表单的视图。

本质上我需要我可以填写以下代码的属性..

```
sfEmployeeBatchEntry.Form.??? = acFormDS 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-25T15:37:45.440

我自己找到的。我错过了它，因为它使用了愚蠢而笨拙的 RunCommand 语法，而不是控件或表单类上的简单属性或方法。

它并不漂亮，但为了后代，这就是答案。

```
'You have to set focus to the subform control or the change view call will'
'fail (UGH!)'
MyForm.mySubFormControl.SetFocus

'Change to datasheet view...'
DoCmd.RunCommand acCmdSubformDatasheet

'Change to Form View...'
DoCmd.RunCommand acCmdSubformFormView 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-20T19:11:23.570

我尝试了许多在不同网站上找到的不同解决方案。有些似乎不必要地复杂。我清理了一些杂物，发现这最适合我的需求。

```
 Dim intView As Integer
 intView = Me.Form.CurrentView

 If intView = 1 Then

    DoCmd.RunCommand (acCmdSubformDatasheetView)
    Else

    DoCmd.RunCommand (acCmdSubformFormView)
    End If

Exit Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-07-05T12:32:05.563

要在连续和数据表之间切换子窗体的视图，请使用以下代码：

```
Private Sub cmdToggleView_Click()

    If Me.frmViewDetailedTransactionsSub.Form.CurrentView = 1 Then
        Me.frmViewDetailedTransactionsSub.SetFocus
        DoCmd.RunCommand acCmdSubformDatasheetView
        Exit Sub
    End If

    If Me.frmViewDetailedTransactionsSub.Form.CurrentView = 2 Then
        Me.frmViewDetailedTransactionsSub.SetFocus
        DoCmd.RunCommand acCmdSubformFormView
        Exit Sub
    End If

End Sub 
```

# iphone - iPhone RSS 阅读器 -- parseXML 不会加载一些 XML 提要

> ID：682033
> 
> 赞同：2
> 
> 时间：2009-03-25T15:09:16.257
> 
> 标签：iphone, objective-c, rss

我正在使用[http://theappleblog.com/2008/08/04/tutorial-build-a-simple-rss-reader-for-iphone/上的简单 RSS 阅读示例](http://theappleblog.com/2008/08/04/tutorial-build-a-simple-rss-reader-for-iphone/)

它使用 parseXML 加载 RSS 提要。

这是我遇到的问题。对于以下 RSS 提要示例，我无法让它加载提要。出现无法连接的错误。但是在我的 Mac RSS 阅读器上它工作正常，所以我知道链接很好。

关于为什么它无法加载此特定提要但可以正常加载其他提要的任何想法？

[http://www.okstate.com/rss.dbml?db_oem_id=200&media=news](http://www.okstate.com/rss.dbml?db_oem_id=200&media=news)

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-05-15T19:50:32.307

我刚刚发布了一个[适用于 iPhone 的开源 RSS/Atom Parser](https://github.com/mwaterfall/MWFeedParser)，希望它可能会有用。

我也很想听听你的想法！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-20T15:14:39.973

根据我的经验，在大多数情况下，HTML 标记会导致 RSS 解析器失败。我遇到过很多解析器类都遇到过这样的问题（寻找终极的，我没有找到）

我的猜测是实体如

```
&amp;#39;s 
```

对你的崩溃负责。我的崩溃通常就是这种情况。这也导致我决定创建一个“代理服务器”，在将 XML 发送到 iPhone 之前对其进行预解析（这给了我缓存、缩放和其他一些东西的优势）。我确实相信那里有可靠的解决方案，但是为如此多的 RSS 实现编写解析器总是很困难。

PS：[W3C](http://validator.w3.org/feed/check.cgi?url=http%3A%2F%2Fwww.okstate.com%2Frss.dbml%3Fdb_oem_id%3D200%26media%3Dnews)将此提要验证为“有效”，因此这确实是“我们的”问题..

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-22T15:01:00.597

您的问题可能在于：

1.  Unicode 字符（即我在提要中看到一些 o 上面有两个点）
2.  您拥有的代码没有正确尊重 CDATA 部分

要找出是哪种情况，请将提要文件保存到本地磁盘并通过代码加载它以确保发生错误。

对文件进行二分搜索以找出是否是某个特定的 RSS 条目导致了问题（即删除除第一个 rss 条目之外的所有条目并查看问题是否存在。如果存在，则问题存在，如果不存在将一半的 rss 条目放回文件中并重复）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T00:40:52.900

有许多 RSS 提要包含无效的 XML，通常是因为不了解 XML 的人使用 HTML 模板在服务器端将它们一起破解。我见过不正确地转义（或未转义）的 HTML 帖子内容、缺少关闭标签、严重嵌套的标签等等。

如果您希望能够解析任意提要，则必须清理错误的 XML。通常的方法是使用操作系统中包含的“htmlTidy”库。这可以清理 XML 以及 HTML。

您正在关注的这个示例使用 NSXMLParser——我不知道为什么。这是一个较低级别的 API，不支持整理。我建议改用 NSXMLDocument 。该 API 中有一个标志会告诉它在解析 XML 时使用 tidy。此 API 还将 XML 作为易于使用的元素树返回给您。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T20:14:06.210

我一直在遇到类似的问题。我还没有确定答案，但我注意到 RSS 2 的解析往往比其他的更成功。

# iphone - 如何进行纹理修改

> ID：682035
> 
> 赞同：0
> 
> 时间：2009-03-25T15:09:18.487
> 
> 标签：iphone, opengl-es

我正在研究 iphone opengl es。我是这个的新手。谁能指导我如何进行..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T13:27:58.270

首先，从：[Apple - 使用 OpenGL ES 绘图](http://developer.apple.com/library/ios/#documentation/3DDrawing/Conceptual/OpenGLES_ProgrammingGuide/WorkingwithEAGLContexts/WorkingwithEAGLContexts.html)开始。然后[是 GLSprite](http://developer.apple.com/iphone/library/samplecode/GLSprite/index.html#//apple_ref/doc/uid/DTS40007325)和[红皮书](http://www.glprogramming.com/red/)。

之后，这些非常方便：[来自 Molecules 的 Lessens](http://www.sunsetlakesoftware.com/2008/08/05/lessons-molecules-opengl-es)、[Apple Technical notes](http://developer.apple.com/iphone/library/technotes/tn2008/tn2230.html)和[Khronos - OpenGL ES Reference](http://www.khronos.org/opengles/sdk/1.1/docs/man/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T15:24:35.813

我建议您从 Apple 的示例代码开始。GLSprite 示例可能是一个很好的起点。

对于一般的 Open GL 编程，[红皮书](http://www.glprogramming.com/red/)也是一个很好的学习指南。

# c# - 为什么这个脚本不是从母版页运行的？

> ID：682037
> 
> 赞同：0
> 
> 时间：2009-03-25T15:10:05.990
> 
> 标签：c#, asp.net, javascript, jquery

我有一个与母版页关联的页面。在母版页中，我将 css 链接放在 head 部分中，并将 jquery 脚本标记和包含切换网格功能的脚本，但是当它不起作用时。当我点击一个项目时，看起来它甚至没有调用 showhide。

这是母版页的片段：

```
<head runat="server">
<title></title>
<link href="MainLayout.css" rel="stylesheet" type="text/css" />
<link href="ajaxtab.css" rel="stylesheet" type="text/css" />
<link href="dialog.css" rel="stylesheet" type="text/css" />
<link href="grid.css" rel="stylesheet" type="text/css" />
<link href="pager.css" rel="stylesheet" type="text/css" />
<link href="subgrid.css" rel="stylesheet" type="text/css" />
<script src="jquery-1.3.2.min.js" type="text/javascript"></script>

<script type="text/javascript">
      //master: id of div element that contains the information about master data
      //details: id of div element wrapping the details grid
      function showhide(master, detail) {
          //First child of master div is the image
          var src = $(master).children()[0].src;
          //Switch image from (+) to (-) or vice versa.
          if (src.endsWith("plus.png"))
              src = src.replace('plus.png', 'minus.png');
          else
              src = src.replace('minus.png', 'plus.png');

          //Set new image
          $(master).children()[0].src = src;

          //Toggle expand/collapse                   
          $(detail).slideToggle("normal");
      }
</script>
<asp:ContentPlaceHolder ID="head" runat="server">

</asp:ContentPlaceHolder>
</head> 
```

这是在aspx页面的onclick事件中包含showhide函数的div：

```
<div class="searchgroup" 
id='<%#String.Format("master{0}",Container.DataItemIndex)%>'
onclick='showhide(<%#String.Format("\"#master{0}\"",Container.DataItemIndex)%>
,
<%#String.Format("\"#detail{0}\"",Container.DataItemIndex) %>)'>
<asp:Image ID="imgCollapsible" 
           CssClass="first" 
           ImageUrl="plus.png" 
           Style="margin-right: 5px;"
           runat="server" />

<span class="searchheader"><%#Eval("Business")%></span>
</div> 
```

这是它为 master 和 detail div 生成的 html：

```
//master div
<div class="searchgroup"   
     id='master0'                                                     
     onclick='showhide("#master0","#detail0")'>

<img id="ctl00_ContentPanel_gvMaster_ctl02_imgCollapsible" 
     class="first" src="plus.png" 
     style="border-width:0px;margin-right: 5px;" />
     <span class="searchheader">ABC</span>
</div>

//details div
<div id='detail0' class="searchdetail">
<div>
<table class="searchgrid"
       id="ctl00_ContentPanel_gvMaster_ctl02_gvDtails">
<tr>
<th>Status</th>
<tr class="searchrow">
<td>2</td>
</tr>
</table>
</div>
</div> 
```

我无法让 JQuery 工作，而且我的时间不多了，所以现在我决定使用 ajax 控制工具包中的可折叠面板 externder。当我有时间时，我将调查 JQuery 问题，感谢您迄今为止的所有建议。如果有人还有更多，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T17:28:53.860

您的 javascript 在 src.endsWith("plus.png") 处抛出错误，因为 js 中没有内置的 endsWith 函数。用 src.substr(-8) == "plus.png" 代替它，它可以工作：

```
<script type="text/javascript">
      //master: id of div element that contains the information about master data
      //details: id of div element wrapping the details grid
      function showhide(master, detail) {
          //First child of master div is the image
          var src = $(master).children()[0].src;
          //Switch image from (+) to (-) or vice versa.
          if (src.substr(-8) == "plus.png")
              src = src.replace('plus.png', 'minus.png');
          else
              src = src.replace('minus.png', 'plus.png');

          //Set new image
          $(master).children()[0].src = src;

          //Toggle expand/collapse                   
          $(detail).slideToggle("normal");
      }
</script> 
```

编辑 - 工作示例：

**MasterPage.master**

```
<%@ Master Language="C#" AutoEventWireup="true" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title>Untitled Page</title>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
    <script type="text/javascript">
          //master: id of div element that contains the information about master data
          //details: id of div element wrapping the details grid
          function showhide(master, detail) {
              //First child of master div is the image
              var src = $(master).children()[0].src;
              //Switch image from (+) to (-) or vice versa.
              if (src.substr(-8) == "plus.png")
                  src = src.replace('plus.png', 'minus.png');
              else
                  src = src.replace('minus.png', 'plus.png');

              //Set new image
              $(master).children()[0].src = src;

              //Toggle expand/collapse                   
              $(detail).slideToggle("normal");
          }
    </script>

    <asp:ContentPlaceHolder id="head" runat="server">
    </asp:ContentPlaceHolder>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <asp:ContentPlaceHolder id="ContentPlaceHolder1" runat="server">

        </asp:ContentPlaceHolder>
    </div>
    </form>
</body>
</html> 
```

**默认2.aspx**

```
<%@ Page Language="C#" MasterPageFile="~/MasterPage.master" AutoEventWireup="true" Title="Untitled Page" %>

<asp:Content ID="Content1" ContentPlaceHolderID="head" Runat="Server">
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="ContentPlaceHolder1" Runat="Server">
    <div class="searchgroup" id='master0' onclick='showhide("#master0","#detail0")'>

    <img id="ctl00_ContentPanel_gvMaster_ctl02_imgCollapsible" class="first" src="plus.png" style="border-width:0px;margin-right: 5px;" />
     <span class="searchheader">ABC</span>
    </div>

    <div id='detail0' class="searchdetail">
        <div>
            <table class="searchgrid"
               id="ctl00_ContentPanel_gvMaster_ctl02_gvDtails">
                <tr>
                    <th>Status</th>
                </tr>
                <tr class="searchrow">
                    <td>2</td>
                </tr>
            </table>
        </div>
    </div>
</asp:Content> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T15:30:11.463

“当我点击一个项目时，看起来它甚至没有调用 showhide。” 如果您仅使用 alert() 函数简化该函数，它是否有效。

代码对我来说看起来不错。也许有一些 id 不匹配。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T15:48:17.643

您可以检查 jquery 的路径在您的页面（使用此母版页的页面）中是否正确。

要确定它是否调用 showhide()，您可以在 Firefox 中使用 Firebug，并在函数中设置断点。

此外，它还会为您提供更多调试和猜测问题所在的线索。

代码对我来说似乎也可以。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T06:30:43.503

只是一个想法，如果您在浏览器上右键单击查看源代码，您是否正确看到了 jquery 路径？我的经验告诉我您需要解析母版页上的 javascript url（它适用于 css，但不适用于 js 文件）

```
<script src="<%= ResolveUrl("~") %>jquery-1.3.2.min.js" type="text/javascript"></script> 
```

# c# - 如何使用 C#.net 将 HH:MM:SS 转换为几秒钟？

> ID：682039
> 
> 赞同：30
> 
> 时间：2009-03-25T15:10:37.080
> 
> 标签：c#, .net, datetime

有没有一种简洁的方法来做到这一点，而不是在冒号上进行拆分并将每个部分乘以相关数字来计算秒数？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2009-03-25T15:15:23.387

它看起来像一个时间跨度。如此简单地解析文本并获得秒数。

```
string time = "00:01:05";
double seconds = TimeSpan.Parse(time).TotalSeconds; 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-03-25T15:17:50.260

您可以在 aTimeSpan 上使用 parse 方法。

[http://msdn.microsoft.com/en-us/library/system.timespan.parse.aspx](http://msdn.microsoft.com/en-us/library/system.timespan.parse.aspx)

```
TimeSpan ts = TimeSpan.Parse( "10:20:30" );
double totalSeconds = ts.TotalSeconds; 
```

TotalSeconds 属性返回总秒数，如果您只想要秒然后使用 seconds 属性

```
int seconds = ts.Seconds; 
```

秒返回“30”。TotalSeconds 返回 10 * 3600 + 20 * 60 + 30

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-03-25T15:15:31.763

TimeSpan.Parse() 将解析格式化的字符串。

所以

```
TimeSpan.Parse("03:33:12").TotalSeconds; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-10-09T01:15:56.800

此代码允许小时和分钟组件是可选的。例如，

“30” -> 24 秒
“1:30” -> 90 秒
“1:1:30” -> 3690 秒

```
int[] ssmmhh = {0,0,0};
var hhmmss = time.Split(':');
var reversed = hhmmss.Reverse();
int i = 0;
reversed.ToList().ForEach(x=> ssmmhh[i++] = int.Parse(x));                           
var seconds = (int)(new TimeSpan(ssmmhh[2], ssmmhh[1], ssmmhh[0])).TotalSeconds; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-12T18:49:07.540

```
//Added code to handle invalid strings
string time = null; //"";//"1:31:00";
string rv = "0";
TimeSpan result;
if(TimeSpan.TryParse(time, out result))
{
    rv = result.TotalSeconds.ToString();
}
retrun rv; 
```

# java - JcomboBox没有边框？

> ID：682043
> 
> 赞同：0
> 
> 时间：2009-03-25T15:11:52.287
> 
> 标签：java, networking

当我的程序启动时，组合框（有 2 个有这个问题）确实出现了。但是，当我单击箭头时，会显示一个项目（应该显示 7 个项目）并且列表周围没有边框。如果我将鼠标拖到该区域上，所有其他项目都会出现，但仍然没有边框。
这只发生在我们的仓库中，该仓库距离总公司约 400 码。我们在那里有光纤，并且在同一个局域网上。我不确定这是网络问题还是 java 问题。
很感谢任何形式的帮助。

克里斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-26T14:51:04.577

今天早上我远程登录计算机亲自尝试一下，使用不同版本的软件包（一个使用 1.4.1_18 构建，一个使用 1.4.1_15 构建）。事实证明，如果我最小化程序然后最大化它，一切都很好（使用两个版本）。
我评论了`setExtendedState(getExtendedState() | MAXIMIZED_BOTH)`在框架的所有内容初始化之后出现的内容。重建，重新启动，边界与所有项目一起存在，因此它现在可以完美运行。

有谁知道为什么这会导致问题？

# sql-server - 在我的应用程序中包含 SQL Server 2008 Express 的命名实例

> ID：682047
> 
> 赞同：4
> 
> 时间：2009-03-25T15:13:21.363
> 
> 标签：sql-server, visual-studio-2008, deployment, sql-server-2008-express

大家早上好。这是我关于stackoverflow的第一个问题，所以希望这不是被打死的东西，我一直找不到它。

我正在开发一个将要分发收缩包装的应用程序。我们已经获得了使用我们的应用程序分发 SQL Server 2008 Express Edition 的权利，但具体如何做到这一点有点困难。现在我们正在使用一个标准的 Visual Studio 安装项目，我显然希望有一些非常简单的东西，比如一个可配置的合并模块，但显然不存在这样的东西，否则我不会在这里发布;)

我开始走的路是在我们的包中包含自解压 EXE，然后使用自定义安装操作来解压它并将命令行参数传递给 SQL 安装程序以创建我们的命名实例。这就是问题所在。

萃取没问题。我可以从 Windows 运行脚本，它会按原样安装 SQL Server，但我无法从我的自定义操作中运行 SQL 安装程序，因为它表示已经有另一个安装正在进行中。当然，另一个安装是我的应用程序，它不会在 SQL Server 完成之前结束，所以我们基本上处于死锁状态，直到 SQL 最终放弃并出现错误。

我想要的是我的应用程序的 SQL 服务器的命名实例，它随它一起安装并随它一起卸载。由于时间原因，编写我自己的安装程序不是一种选择，我的同事说由于复杂性，InstallShield 不是一种选择（我从未使用过它，所以我会相信他的话）。有人有想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-22T17:50:13.500

当我们尝试使用收缩包装的应用程序部署 SQL 2008 Express R2 的命名实例时，我们遇到了类似的问题。我们确实通过制作自定义引导程序使其工作。以下是我们 wiki 中描述这一点的条目的副本，希望它们对尝试这样做的其他人有用。

需要注意的重要一点是，在 VS2012/2013 中，我们尚未确定如何使用 InstallShield LE (ISLE) 进行这项工作，因此如果您现在采用此解决方案并计划升级 VS，那么这可能不值得这样做，最好找到一个也适用于 ISLE 的解决方案。

**用于安装项目的 SQL 2008 R2 先决条件引导程序**

在 VS2010 中开箱即用，无法将 SQL2008 Express R2 设置为安装项目的先决条件。这不可能的原因是 R2 没有“引导程序”，只有 2008 Express。此外，MS 不打算为 R2 添加引导程序，因为 VS 只是为发布该版本 VS 时存在的任何 SQL 版本获取引导程序（R2 是在 VS2010 之后发布的）。

由于 SQL 2008 R2 没有 MS 引导程序，因此您需要按照本文创建自己的引导程序：

[http://robindotnet.wordpress.com/2011/02/06/how-about-a-bootstrapper-package-for-sqlserver-express-2008-r2/](http://robindotnet.wordpress.com/2011/02/06/how-about-a-bootstrapper-package-for-sqlserver-express-2008-r2/)

如果不存在具有该名称的旧实例，则此引导程序将创建 SQLEXPRESS 实例，或者将名称为 SQLEXPRESS 的较早实例更新为 SQL Express 2008 R2。

注意：更改 SQL 实例的名称不能按目前的方式完成，因为 xml 文件使用的 sqlversionchk.exe 程序被编程为仅检查名为 SQLEXPRESS 的实例，并且没有办法将其传递给备用名称。我们通过创建上述文件的新变体解决了这个问题，该变体不使用 sqlversionchk exe，而是使用 reg 检查来确定是否安装了 SQL，如果安装了，则使用哪个版本：

**SQL 2008 R2 命名实例引导**

目标：使用正确的 VS 安装项目引导程序（即勾选 2008 R2 是安装项目先决条件中的先决条件），然后让安装项目安装或升级 SQL Server 的自定义命名实例。

成功：我们为我们的应用程序版本的 SQL 创建了一个自定义引导程序，它完全取消了 SQLVersionCh.exe 程序。

**我们做了什么：**

我们从上面详述的 robindotnet 的自定义 R2 引导程序开始。

然后，我们删除了对 sqlversionchk.exe 的所有引用，并将它们替换为注册表检查以检查当前版本的 sql 是什么。这不像 sqlversionchk 那样彻底，因为它还会检查 SQL 实例是否使用正确的语言以及很多关于当前是否安装了 x 版本的 sql 是否无法更新的条件。但是，就我们的目的而言，这并不重要，因为我们控制着实例（因为它是自定义实例而不是默认 SQLEXPRESS 实例）所以我们将知道它可能是什么版本，因此我们可以检查这些版本.

然后引导程序通过简单地检查以下四个场景来工作，其中只有一个应该是真实的（即四个场景应该是互斥的）

场景 1：平台：x86
注册表检查：我们的实例名称没有注册表值操作：注册表中没有任何内容，因此未安装 SQL，如果这是 x86 机器安装 SQL

场景 2：平台：x86
注册表检查：注册表值不等于我们正在使用的最新 SQL 版本
操作：将我们现有的自定义命名实例升级到我们当前使用的 SQL 版本。

如果安装的 SQL 版本比我们尝试安装的版本高（因为我们将升级到较早的版本，这会失败），这个逻辑在理论上是错误的，但除非用户决定手动安装，否则这种情况永远不会发生升级我们的 SQL 实例，这是我们无法控制的。

场景 3：平台：amd64（注意这并不意味着这是一台 amd 机器，只是它是 64 位 Windows 安装）
注册表检查：我们的实例名称没有注册表值
操作：注册表中没有任何内容，因此没有安装 SQL，如果这是一个 64 位机器安装 SQL

场景 4：平台：amd64
注册表检查：注册表值不等于我们正在使用的最新 SQL 版本操作：将我们现有的自定义命名实例升级到我们当前使用的 SQL 版本。

本文末尾详细介绍了完整的引导程序文件。

**这个自定义引导程序将来将如何变化**

我们可以在注册表中检查我们喜欢的任何版本号并确定安装的版本。然后，我们可以适当地指导执行。例如，如果您需要先升级到 2008 R2，然后才能更新到 2010，我们可以使用 bypassIf 构造并简单地在上表中引入更多变体来实现。

**我们的引导程序版本：**

请注意，自定义实例名称为“MVXBM”

```
<?xml version="1.0" encoding="utf-8" ?>

<Package

xmlns="http://schemas.microsoft.com/developer/2004/01/bootstrapper"

Name="DisplayName"

Culture="Culture"

LicenseAgreement="eula.rtf">

  <PackageFiles CopyAllPackageFiles="false">

    <PackageFile Name="SQLEXPR32_x86_ENU.EXE" HomeSite="SqlExpr32Exe"/>

    <PackageFile Name="SQLEXPR_x64_ENU.EXE" HomeSite="SqlExpr64Exe"/>

    <PackageFile Name="eula.rtf"/>

  </PackageFiles>

  <InstallChecks>

<RegistryCheck Property="SQLVersion" Key="HKLM\SOFTWARE\Microsoft\Microsoft SQL Server\MVXBM\MSSQLServer\CurrentVersion" Value="CurrentVersion" />

  </InstallChecks>

  <Commands Reboot="Defer">

    <!-- Defines a new installation (x86) -->

    <Command PackageFile="SQLEXPR32_x86_ENU.EXE"

Arguments='/q /hideconsole /action=Install /features=SQL /instancename=MVXBM /enableranu=1 /sqlsvcaccount="NT Authority\Network Service" /AddCurrentUserAsSqlAdmin /skiprules=RebootRequiredCheck /IAcceptSQLServerLicenseTerms'

EstimatedInstalledBytes="225000000"

EstimatedInstallSeconds="420">

      <InstallConditions>

        <FailIf Property="VersionNT" Compare="ValueNotExists" String="GeneralFailure"/>

        <FailIf Property="VersionNT" Compare="VersionLessThan" Value="5.1.2" String="InvalidPlatformXP"/>

        <FailIf Property="VersionNT" Compare="VersionEqualTo" Value="5.2.0" String="InvalidPlatform2K3"/>

        <FailIf Property="VersionNT" Compare="VersionEqualTo" Value="5.2.1" String="InvalidPlatform2K3"/>

        <FailIf Property="AdminUser" Compare="ValueEqualTo" Value="false" String="AdminRequired"/>

        <BypassIf Property="ProcessorArchitecture" Compare="ValueNotEqualTo" Value="Intel"/>

        <BypassIf Property="SQLVersion" Compare="ValueExists"/>

      </InstallConditions>

      <ExitCodes>

        <ExitCode Value="0" Result="Success"/>

        <ExitCode Value="1641" Result="SuccessReboot"/>

        <ExitCode Value="3010" Result="SuccessReboot"/>

        <!-- 0x84BE0BC2 (1214,3010) -->

        <ExitCode Value="-2067919934" Result="FailReboot"/>

        <!-- 0x84C10BC2 (1217,3010) -->

        <ExitCode Value="-2067723326" Result="FailReboot"/>

        <!-- 0x84BE0007 (1214,7) -->

        <ExitCode Value="-2067922937" Result="Fail" String="AdminRequired"/>

        <!-- 0x84C4001F (1220,31) -->

        <ExitCode Value="-2067529697" Result="Fail" String="AdminRequired"/>

        <!-- 0x84BE0001 (1214,1)-->

        <ExitCode Value="-2067922943" Result="Fail" String="InvalidPlatformOSServicePacks"/>

        <!-- 0x84C4000B (1220,11) -->

        <ExitCode Value="-2067529717" Result="Fail" String="AnotherInstanceRunning"/>

        <!-- 0x84BE01F8 (1214,504) -->

        <ExitCode Value="-2067922440" Result="Fail" String="BetaComponentsFailure"/>

        <!-- 0x84BE01FA (1214,506) -->

        <ExitCode Value="-2067922438" Result="Fail" String="BetaComponentsFailure"/>

        <!-- 0x84BE0202 (1214,514) -->

        <ExitCode Value="-2067922430" Result="Fail" String="InvalidPlatformArchitecture"/>

        <!-- 0x84BE0203 (1214,515) -->

        <ExitCode Value="-2067922429" Result="Fail" String="InvalidPlatformArchitecture"/>

        <ExitCode Value="216" Result="Fail" String="InvalidPlatformArchitecture"/>

        <DefaultExitCode Result="Fail" FormatMessageFromSystem="true" String="GeneralFailure" />

      </ExitCodes>

    </Command>

    <!-- Defines an upgrade installation (x86) -->

    <Command PackageFile="SQLEXPR32_x86_ENU.EXE"

Arguments="/q /hideconsole /action=Upgrade /instancename=MVXBM /skiprules=RebootRequiredCheck /IAcceptSQLServerLicenseTerms"

EstimatedInstalledBytes="225000000"

EstimatedInstallSeconds="420">

      <InstallConditions>

        <BypassIf Property="ProcessorArchitecture" Compare="ValueNotEqualTo" Value="Intel"/>

        <BypassIf Property="SQLVersion" Compare="ValueNotExists"/>

        <BypassIf Property="SQLVersion" Compare="ValueEqualTo" Value="10.50.1600.1"/>

      </InstallConditions>

      <ExitCodes>

        <ExitCode Value="0" Result="Success"/>

        <ExitCode Value="1641" Result="SuccessReboot"/>

        <ExitCode Value="3010" Result="SuccessReboot"/>

        <!-- 0x84BE0BC2 (1214,3010) -->

        <ExitCode Value="-2067919934" Result="FailReboot"/>

        <!-- 0x84C10BC2 (1217,3010) -->

        <ExitCode Value="-2067723326" Result="FailReboot"/>

        <!-- 0x84BE0007 (1214,7) -->

        <ExitCode Value="-2067922937" Result="Fail" String="AdminRequired"/>

        <!-- 0x84C4001F (1220,31) -->

        <ExitCode Value="-2067529697" Result="Fail" String="AdminRequired"/>

        <!-- 0x84BE0001 (1214,1)-->

        <ExitCode Value="-2067922943" Result="Fail" String="InvalidPlatformOSServicePacks"/>

        <!-- 0x84C4000B (1220,11) -->

        <ExitCode Value="-2067529717" Result="Fail" String="AnotherInstanceRunning"/>

        <!-- 0x84BE01F8 (1214,504) -->

        <ExitCode Value="-2067922440" Result="Fail" String="BetaComponentsFailure"/>

        <!-- 0x84BE01FA (1214,506) -->

        <ExitCode Value="-2067922438" Result="Fail" String="BetaComponentsFailure"/>

        <!-- 0x84BE0202 (1214,514) -->

        <ExitCode Value="-2067922430" Result="Fail" String="InvalidPlatformArchitecture"/>

        <!-- 0x84BE0203 (1214,515) -->

        <ExitCode Value="-2067922429" Result="Fail" String="InvalidPlatformArchitecture"/>

        <ExitCode Value="216" Result="Fail" String="InvalidPlatformArchitecture"/>

        <DefaultExitCode Result="Fail" FormatMessageFromSystem="true" String="GeneralFailure" />

      </ExitCodes>

    </Command>

    <!-- Defines a new installation (amd64) -->

    <Command PackageFile="SQLEXPR_x64_ENU.EXE"

Arguments='/q /hideconsole /action=Install /features=SQL /instancename=MVXBM /enableranu=1 /sqlsvcaccount="NT Authority\Network Service" /AddCurrentUserAsSqlAdmin /skiprules=RebootRequiredCheck /IAcceptSQLServerLicenseTerms'

EstimatedInstalledBytes="225000000"

EstimatedInstallSeconds="420">

      <InstallConditions>

        <BypassIf Property="ProcessorArchitecture" Compare="ValueNotEqualTo" Value="amd64"/>

        <BypassIf Property="SQLVersion" Compare="ValueExists"/>

      </InstallConditions>

      <ExitCodes>

        <ExitCode Value="0" Result="Success"/>

        <ExitCode Value="1641" Result="SuccessReboot"/>

        <ExitCode Value="3010" Result="SuccessReboot"/>

        <!-- 0x84BE0BC2 (1214,3010) -->

        <ExitCode Value="-2067919934" Result="FailReboot"/>

        <!-- 0x84C10BC2 (1217,3010) -->

        <ExitCode Value="-2067723326" Result="FailReboot"/>

        <!-- 0x84BE0007 (1214,7) -->

        <ExitCode Value="-2067922937" Result="Fail" String="AdminRequired"/>

        <!-- 0x84C4001F (1220,31) -->

        <ExitCode Value="-2067529697" Result="Fail" String="AdminRequired"/>

        <!-- 0x84BE0001 (1214,1)-->

        <ExitCode Value="-2067922943" Result="Fail" String="InvalidPlatformOSServicePacks"/>

        <!-- 0x84C4000B (1220,11) -->

        <ExitCode Value="-2067529717" Result="Fail" String="AnotherInstanceRunning"/>

        <!-- 0x84BE01F8 (1214,504) -->

        <ExitCode Value="-2067922440" Result="Fail" String="BetaComponentsFailure"/>

        <!-- 0x84BE01FA (1214,506) -->

        <ExitCode Value="-2067922438" Result="Fail" String="BetaComponentsFailure"/>

        <!-- 0x84BE0202 (1214,514) -->

        <ExitCode Value="-2067922430" Result="Fail" String="InvalidPlatformArchitecture"/>

        <!-- 0x84BE0203 (1214,515) -->

        <ExitCode Value="-2067922429" Result="Fail" String="InvalidPlatformArchitecture"/>

        <ExitCode Value="216" Result="Fail" String="InvalidPlatformArchitecture"/>

        <DefaultExitCode Result="Fail" FormatMessageFromSystem="true" String="GeneralFailure" />

      </ExitCodes>

    </Command>

    <!-- Defines an upgrade installation (amd64) -->

    <Command PackageFile="SQLEXPR_x64_ENU.EXE"

Arguments="/q /hideconsole /action=Upgrade /instancename=MVXBM /skiprules=RebootRequiredCheck /IAcceptSQLServerLicenseTerms"

EstimatedInstalledBytes="225000000"

EstimatedInstallSeconds="420">

      <InstallConditions>

        <BypassIf Property="ProcessorArchitecture" Compare="ValueNotEqualTo" Value="amd64"/>

        <BypassIf Property="SQLVersion" Compare="ValueNotExists"/>

        <BypassIf Property="SQLVersion" Compare="ValueEqualTo" Value="10.50.1600.1"/>

      </InstallConditions>

      <ExitCodes>

        <ExitCode Value="0" Result="Success"/>

        <ExitCode Value="1641" Result="SuccessReboot"/>

        <ExitCode Value="3010" Result="SuccessReboot"/>

        <!-- 0x84BE0BC2 (1214,3010) -->

        <ExitCode Value="-2067919934" Result="FailReboot"/>

        <!-- 0x84C10BC2 (1217,3010) -->

        <ExitCode Value="-2067723326" Result="FailReboot"/>

        <!-- 0x84BE0007 (1214,7) -->

        <ExitCode Value="-2067922937" Result="Fail" String="AdminRequired"/>

        <!-- 0x84C4001F (1220,31) -->

        <ExitCode Value="-2067529697" Result="Fail" String="AdminRequired"/>

        <!-- 0x84BE0001 (1214,1)-->

        <ExitCode Value="-2067922943" Result="Fail" String="InvalidPlatformOSServicePacks"/>

        <!-- 0x84C4000B (1220,11) -->

        <ExitCode Value="-2067529717" Result="Fail" String="AnotherInstanceRunning"/>

        <!-- 0x84BE01F8 (1214,504) -->

        <ExitCode Value="-2067922440" Result="Fail" String="BetaComponentsFailure"/>

        <!-- 0x84BE01FA (1214,506) -->

        <ExitCode Value="-2067922438" Result="Fail" String="BetaComponentsFailure"/>

        <!-- 0x84BE0202 (1214,514) -->

        <ExitCode Value="-2067922430" Result="Fail" String="InvalidPlatformArchitecture"/>

        <!-- 0x84BE0203 (1214,515) -->

        <ExitCode Value="-2067922429" Result="Fail" String="InvalidPlatformArchitecture"/>

        <ExitCode Value="216" Result="Fail" String="InvalidPlatformArchitecture"/>

        <DefaultExitCode Result="Fail" FormatMessageFromSystem="true" String="GeneralFailure" />

      </ExitCodes>

    </Command>

  </Commands>

  <Strings>

    <String Name="DisplayName">SQL Server 2008 R2 Express - MVXBM</String>

    <String Name="Culture">en</String>

    <String Name="SqlExpr32Exe">http://download.microsoft.com/download/5/1/a/51a153f6-6b08-4f94-a7b2-ba1ad482bc75/SQLEXPR32_x86_ENU.exe</String>

    <String Name="SqlExpr64Exe">http://download.microsoft.com/download/5/1/a/51a153f6-6b08-4f94-a7b2-ba1ad482bc75/SQLEXPR_x64_ENU.exe</String>

    <String Name="AdminRequired">You do not have the permissions required to install SQL Server 2008 R2 Express. Please contact your administrator.</String>

    <String Name="GeneralFailure">An error occurred attempting to install SQL Server 2008 R2 Express.</String>

    <String Name="InvalidPlatformXP">Windows XP Service Pack 2 or later is required to install SQL Server 2008 R2 Express.</String>

    <String Name="InvalidPlatform2K3">Windows 2003 Service Pack 2 or later is required to install SQL Server 2008 R2 Express.</String>

    <String Name="MissingMSXml">SQL Server 2008 R2 Express requires MSXML. Please ensure MSXML is installed properly.</String>

    <String Name="InsufficientHardware">The current system does not meet the minimum hardware requirements for SQL Server 2008 R2 Express. Contact your application vendor.</String>

    <String Name="InvalidPlatformOSServicePacks">The current operating system does not meet Service Pack level requirements for SQL Server 2008 R2 Express. Install the most recent Service Pack from the Microsoft download center at http://www.microsoft.com/downloads before continuing setup.</String>

    <String Name="InvalidPlatformIE">This version of SQL Server 2008 R2 Express requires Internet Explorer version 6.0 with SP1 or later. To proceed, install or upgrade to a required version of Internet Explorer and then run setup again.</String>

    <String Name="AnotherInstanceRunning">Another instance of setup is already running. The running instance must complete before this setup can proceed.</String>

    <String Name="BetaComponentsFailure">A beta version of the .NET Framework 2.0 or SQL Server was detected on the computer. Uninstall any previous beta versions of SQL Server 2008 R2 components, SQL Server Support Files, or .NET Framework 2.0 before continuing.</String>

    <String Name="InvalidPlatformArchitecture">This version of SQL Server 2008 R2 Express is not supported for the current processor architecture.</String>

    <String Name="InvalidUpgradeNotExpress">The instance of SQL Server 2005 named 'SQLEXPRESS' is a not an instance of SQL Server Express. It cannot be upgraded to SQL Server 2008 R2 Express.</String>

    <String Name="InvalidUpgradeNotExpressCore">The instance of SQL Server 2005 Express named 'SQLEXPRESS' contains components that are not included in SQL Server 2008 R2 Express. SQL Server 2008 R2 Express SP1 cannot upgrade this instance. Please use SQL Server 2008 R2 Express with Advanced Services instead.</String>

    <String Name="InvalidUpgradeLanguage">The instance of SQL Server 2005 Express named 'SQLEXPRESS' is a different language version than this SQL Server 2008 R2 Express. SQL Server 2008 R2 Express cannot upgrade this instance.</String>

    <String Name="InvalidUpgradeWoW">SQL Server 2008 R2 Express (x64) cannot upgrade the existing instance of SQL Server 2005 Express (x64 WoW) named 'SQLEXPRESS'. Uninstall this instance of SQL Server 2005 Express and retry installing SQL Server 2008 R2 Express (x64).</String>

  </Strings>

</Package> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T21:41:17.280

这个项目中的代码是为 SQL2005 构建的，但看起来它可以很容易地用于部署 SQL2008。

[http://www.codeproject.com/KB/applications/NET_Installer_With_SQLEXP.aspx](http://www.codeproject.com/KB/applications/NET_Installer_With_SQLEXP.aspx)

它还支持您选择的实例名称。它肯定需要一些调整，但它似乎支持你正在尝试做的基本租户。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-29T13:43:21.343

我将继续回答我自己的问题，以便其他任何人来寻找有关 SO 的此类信息......从我所能告诉的一切来看，它只是无法安装SQL Server 的自定义实例（无论如何是 2008 年，可能是 2005 年），它与自定义软件的安装相关联，而无需使用自定义引导程序或第三方安装程序产品（InstallShield 等）。听起来 SQL Server Compact 版本可能更适合。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-08-25T02:27:02.210

不知道还有没有人关注这个。也许你可以看看这个：

[http://msdn.microsoft.com/en-us/library/dd981032(SQL.100).aspx](http://msdn.microsoft.com/en-us/library/dd981032(SQL.100).aspx)

没有尝试过，但我希望解决亚当发布的完全相同的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-26T06:31:01.937

一种方法是包含 SQL Server 2008 Express 安装包，然后在 Windows 安装程序中使用自定义操作来启动 SQL Server 2008 Express 的静默后台安装。

该软件包是一个标准的 MSI 软件包 - 在安装 MSI 时，您应该能够在命令行上设置大量属性。

这是我找到的一个示例：

```
sqlexpr.exe /qb instancename="MACHINENAMESQLEXPRESS2008" 
SQLAUTOSTART=1 SAPWD="PWD" SECURITYMODE=SQL DISABLENETWORKPROTOCOLS=0" 
```

我敢肯定，命令行属性的完整列表应该可以在 Microsoft 或 SQL Server 2008 Express 的帮助文件中找到。

马克

# ado.net - 类型化的数据集是否在运行时使用反射？

> ID：682050
> 
> 赞同：-1
> 
> 时间：2009-03-25T15:14:22.780
> 
> 标签：ado.net, strongly-typed-dataset

类型化的数据集是否在运行时使用反射？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T15:18:43.487

不，它只是一个代码生成的包装器，完全编译并且在运行时没有反射。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T15:53:34.310

类型化的数据集通常由 XML Schema 和项目语言中的相应类文件组成。

类型化数据集的主要吸引力在于，该类在设计和编译时提供模式信息，允许您的代码在运行前捕获无效转换和数据输入。由于您在项目命名空间中有对象定义，因此没有理由在类型化数据集上使用反射。

# java - 从 Java 执行命令行程序

> ID：682077
> 
> 赞同：1
> 
> 时间：2009-03-25T15:19:20.477
> 
> 标签：java, ant, process

我必须通过 Java 在 Windows 中执行几个命令行可执行文件。我没有使用 Runtime.exec，而是考虑使用 Ant Tasks 来执行这些调用，希望这是一种更好的方法。

有没有其他更好的方法或任何流行的图书馆来做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T15:25:18.980

使用到底有什么问题`Runtime.exec()`？它在 API 中是有充分理由的......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T15:38:30.600

Runtime.exec 是在 Java 中执行此操作*的*方式。任何其他库都可能是特定于平台的。你需要一个很好的理由不使用 Runtime.exec。

我目前有几个使用此功能的程序，并且没有造成任何问题。

使用 Runtime.exec，您可以选择在等待调用完成时阻塞。您可以捕获返回码和命令行程序写入控制台的任何内容。而且我确信还有许多其他功能，这些只是对我有用的功能。

如果你真的想使用 ant，你总是可以让它调用一个 ant 任务！:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T15:34:02.187

我现在也有类似的情况。我使用 Runtime 和 Process 类。他们工作得很好。

# asp.net - 使用 javascript 回发时事件未触发

> ID：682079
> 
> 赞同：0
> 
> 时间：2009-03-25T15:19:53.827
> 
> 标签：asp.net, javascript, telerik

我正在尝试在用户提交某些文本时使用 Telerik 的 RadSpell 进行拼写检查。

这应该起作用的方式是停止回发，通过 javascript 触发拼写检查，然后在 spellcheckfinished 事件中手动启动真正的回发。问题是在最后一步中，Clicked 事件没有触发按钮，并且服务器端事件处理程序永远不会被调用。

这是相关的 .aspx 代码：

```
<script type="text/javascript" language="javascript">

    var spellCheckFinished = false;
    var btnClicked;

    function doSpellCheckStuff(btnTrigger) 
    {          
        btnClicked = btnTrigger;
        var spell = GetRadSpell('<%= rsMessage.ClientID %>');
     //   spell.add_clientCheckFinished(checkFinished);
        spell.startSpellCheck();
        return false;
    }

    function checkFinished(sender, args)
    {   
        args.SuppressCompleteMessage = true;
        setTimeout('MySubmit();', 100);
    }

    function MySubmit()
    {
        WebForm_DoPostBackWithOptions(
            new WebForm_PostBackOptions(btnClicked.id, '', true, '', '', false, true)
        );
    }
</script>

<tr>
            <td>
                <asp:Button ID="btnSubmit" OnClientClick="return doSpellCheckStuff(this);" Text="Submit" 
                            OnClick="btnSubmit_Click" runat="server" />
            </td>
            <telerik:RadSpell   ID="rsMessage" ControlToCheck="txtMessage" ButtonType="None" 
                                UseClassicDialogs="true" FragmentIgnoreOptions="All" 
                                OnClientCheckFinished="checkFinished" runat="server" />
        </tr> 
```

知道为什么没有调用 btnSubmit_Click 以及如何修复它吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T15:50:33.910

尝试将您的回发脚本注入为：

```
string script = @"function MySubmit(){" +
                  this.Page.ClientScript.GetPostBackEventReference(myButton, string.Empty);
                  "}";

if (!this.Page.ClientScript.IsClientScriptBlockRegistered("myPostBackScript"))
{
    this.Page.ClientScript.RegisterClientScriptBlock(typeof(MyPage), "myPostBackScript", script, true);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T15:25:27.467

最后一个 doSpellCheckStuff() 总是返回 false，这会阻止 OnClick 事件侦听器运行。

# .net - Win32_PerfFormattedData_RemoteAccess_RasPort Windows XP 上的 WMI 类

> ID：682084
> 
> 赞同：0
> 
> 时间：2009-03-25T15:21:16.117
> 
> 标签：.net, windows, windows-xp, wmi

尝试`Win32_PerfFormattedData_RemoteAccess_RasPort`在 Windows XP 上监视对类的更改时，出现“无效的类名”异常。我正在使用 [此处列出](https://stackoverflow.com/questions/565734/capturing-vpn-usage-statistics)的代码。

XP支持这个类吗？文档声称它是，尽管它是由不同的提供商提供的。如果没有，有什么好的选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T14:59:18.800

[Win32_PerfFormattedData_RemoteAccess_RASPort](http://msdn.microsoft.com/en-us/library/aa394283.aspx)格式化数据类仅在服务器操作系统上找到

# sifr - 帮助！sIFR 文本换行

> ID：682091
> 
> 赞同：1
> 
> 时间：2009-03-25T15:23:38.047
> 
> 标签：sifr

[http://doc.bigheadservices.com/my-page.php](http://doc.bigheadservices.com/my-page.php)

在导航栏中，在徽标下方，FAQ 块正在换行，切断 Q。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T17:01:42.040

在这种特殊情况下，我通过在元素周围添加 1px 填充来修复它。文本是列表项中的链接。sIFR 应用于 <li>。将 1px 填充添加到 <a> 修复它。

不确定这是否是正确的方法，但它有效，而且我还有很多工作要做。

# java - 在 Java 中创建 Generic 类实例的正确方法是什么？

> ID：682092
> 
> 赞同：1
> 
> 时间：2009-03-25T15:23:54.647
> 
> 标签：java, generics

在 Java 中初始化 Generic 类的实例时，在语句的两侧指定 Type 有什么好处？

或者换句话说，这两个有效语句之间有什么区别：

```
ArrayList<String> test = new ArrayList<String>(); 
```

和：

```
ArrayList<String> test = new ArrayList(); 
```

（似乎第二个语句不等同于：

```
ArrayList<String> test = new ArrayList<Object>(); 
```

作为无效的第三条语句并导致`incompatible types`编译错误。）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-25T15:27:55.667

第二个语句最终或多或少等同于第一个语句，但这只是因为泛型在运行时被删除。您将收到“未经检查的转换”警告，这就是我不喜欢它的原因。

更好的方法是使用这样的静态泛型方法：

```
public static <T> List<T> newList() {
    return new ArrayList<T>();
} 
```

然后做

```
List<String> test = newList(); 
```

这就是谷歌收藏所做的。

（并且您几乎应该总是将您的列表声明为`List`，而不是`ArrayList`。便于以后切换实现。）

**编辑：** dribeas 在评论中询问这两个声明之间的确切区别是什么，以及为什么我说它们“或多或少等效”。由于[类型擦除](http://java.sun.com/docs/books/tutorial/java/generics/erasure.html)，它们之间的唯一区别是警告。这是比较它们的一小段代码：

```
import java.util.*;

class GenericDeclarationTest {
    public static void main(String[] args) {
        List<String> list1 = new ArrayList<String>();
        list1.add("");
        String s1 = list1.get(0);
        List<String> list2 = new ArrayList();
        list2.add("");
        String s2 = list2.get(0);
    }
} 
```

这是生成的字节码（由 打印`javap -c GenericDeclarationTest`）：

```
Compiled from "GenericDeclarationTest.java"
class GenericDeclarationTest extends java.lang.Object{
GenericDeclarationTest();
  Code:
   0:   aload_0
   1:   invokespecial   #1; //Method java/lang/Object."<init>":()V
   4:   return

public static void main(java.lang.String[]);
  Code:
   0:   new     #2; //class java/util/ArrayList
   3:   dup
   4:   invokespecial   #3; //Method java/util/ArrayList."<init>":()V
   7:   astore_1
   8:   aload_1
   9:   ldc     #4; //String
   11:  invokeinterface #5,  2; //InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
   16:  pop
   17:  aload_1
   18:  iconst_0
   19:  invokeinterface #6,  2; //InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
   24:  checkcast       #7; //class java/lang/String
   27:  astore_2
   28:  new     #2; //class java/util/ArrayList
   31:  dup
   32:  invokespecial   #3; //Method java/util/ArrayList."<init>":()V
   35:  astore_3
   36:  aload_3
   37:  ldc     #4; //String
   39:  invokeinterface #5,  2; //InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
   44:  pop
   45:  aload_3
   46:  iconst_0
   47:  invokeinterface #6,  2; //InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;
   52:  checkcast       #7; //class java/lang/String
   55:  astore  4
   57:  return

} 
```

如您所见（如果您有耐心的话），两者是相同的。

顺便说一句，这在 Java 7 中可能会变得更容易[。Project Coin](http://openjdk.java.net/projects/coin/)中有一个[关于](http://mail.openjdk.java.net/pipermail/coin-dev/2009-February/000009.html)“用于通用实例创建的改进类型推断”的提案。如果它进行最终剪辑，则语法将是：

```
List<String> test = new ArrayList<>();
// or
Map<String, Object> test2 = new HashMap<>(); 
```

打字不会太难吧？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T16:08:41.433

这种冗余很烦人。您可能希望查看具有像这样创建s 的工厂方法的[Google Collections ：](http://code.google.com/p/google-collections/)`List`

```
List<Double> doubleList = Lists.newLinkedList(); 
```

另请注意，[Java 泛型不是协变的](http://www.ibm.com/developerworks/java/library/j-jtp01255.html)。

# api - 使用 Google Maps API 进行地址验证

> ID：682093
> 
> 赞同：76
> 
> 时间：2009-03-25T15:24:16.610
> 
> 标签：api, geolocation, street-address, postal-code

我的任务是验证输入到我当前正在创建的系统中的地址。系统要求根据有效数据源验证输入的地址。在英国，数据集来自皇家邮政，访问成本很高。

所需的数据是整个欧洲的邮政编码信息，以通过 API 访问 Web 应用程序开始。

有很多公司提供这项服务，

1.  质量保证
2.  卡普扫描
3.  任何地方的邮政编码

这些都提供了我需要的服务。然而，这是昂贵的，并且在某些情况下不是完整的数据集。例如不是爱尔兰

我还想知道是否有办法利用 Google Maps API 通过邮政编码和国家/地区验证这些数据。

谷歌地图方法是否可行，还是我必须走这些昂贵公司之一的路线？关于我应该采取什么路线的任何想法。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-03-25T21:02:04.347

答案可能取决于您获得支持和可能的定制服务对您来说有多重要。

谷歌当然可以做到这一点。查看他们的 XML 和地理编码 API。您应该能够制作一条 XML 消息，要求 Google 返回给定地址的地图坐标。如果未找到地址（无效），您将收到适当的响应。这是一个有用的页面：[http ://code.google.com/apis/maps/documentation/services.html#XML_Requests](http://code.google.com/apis/maps/documentation/services.html#XML_Requests)

请注意，Google 提供 Maps API 的目的是在实际地图上绘制地址。虽然您当然可以将这些数据用于其他目的，但如果其中一张地图不完全符合您的法律或商业地址验证需求，您将任由 Google 摆布。如果您为您提到的其中一项服务付费，如果某些地址无法按照您期望的方式解决，您可能会获得支持。

换句话说，你得到你所支付的;)。但是，如果您有时间，为什么不尝试实施基于 Google 的解决方案，然后从那里着手呢？API 看起来很漂亮，毕竟它是免费的。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-07-29T17:12:39.003

Google 的[地理编码 API 可以满足](http://code.google.com/apis/maps/documentation/geocoding/)您的需求。正如 Xerus 指出的那样，只要您不在非谷歌地图上使用地理编码点，您就应该很好（[服务条款](https://cloud.google.com/maps-platform/terms/maps-service-terms/#3-geocoding-api)）。具体来说，

```
3.1 Use without a Google Map. Customer may use Google Maps Content from the Geocoding API in Customer Applications without a corresponding Google Map.

3.3 No use with a non-Google map.  Customer must not use Google Maps Content from the Geocoding API in conjunction with a non-Google map. 
```

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2010-03-15T06:12:03.483

我既是 Web 开发人员，也是您提到的其中一家公司的前雇员。我完全理解你来自哪里。验证地址似乎是一个很容易解决的问题，但它更像是一座冰山。我想一种解决 Google 或 Yahoo! 的法律限制的方法！地图 API 是要求您的用户在地图上验证他们的地址。不过，如果我在你的位置上，我不会走那条路。

地址验证服务如此昂贵的原因是它们需要许可证以及与脾气暴躁的官僚邮政当局（包括皇家邮政）的持续关系。不幸的是，邮政当局是验证地址的最佳（通常也是唯一）数据来源，因此实际上没有任何其他方法可以解决这个问题。最重要的是，您需要权衡错误地址的成本（通常是邮件数量问题）与验证它们的软件成本。爱尔兰邮政数据比爱尔兰邮政格式（经常省略建筑物编号）更垃圾，因此您对这些地址几乎无能为力。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2011-10-13T11:40:54.900

答案取决于您对数据的信任程度以及数据的使用方式。例如，如果您将其用于邮寄或运输，您需要确信数据是正确的。如果您只是将其用作另一种欺诈预防机制，那么您可能会允许一定程度的错误潜入数据中。

如果您想要任何程度的真实准确性，则需要使用进行真实地址验证的服务，并且您将不得不为此付费。正如 Adam 所提到的，地址验证和验证起初看起来简单易行，但它是一个充满挑战的黑洞，除非您有一些基础数据可以使用，否则几乎不可能自己完成。相信我，您实际上是通过使用服务来省钱。欢迎你自己走这条路来体验我的意思，但我可以保证你会看到光明，可以这么说，即使在你转动车轮几个小时（或几天）之后。

我应该提一下，我是 SmartyStreets 的创始人。我们确实提供[验证](https://smartystreets.com/demo)和验证地址，我们也为美国和[国际](https://smartystreets.com/docs/international)提供此地址。我非常乐意亲自回答您关于地址清理、标准化和验证的任何问题。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-10-10T15:25:20.040

另一种选择是[YADDRESS](http://www.yurisw.com/YAddress.aspx)。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-04-19T20:34:58.957

根据 FedEx 的 api 验证它。他们有一个 API 可以从 XML 代码生成标签。该过程涉及验证地址的步骤。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-04-20T08:56:14.333

谷歌基础（免费）不提供地址验证（地理编码），因为没有英国邮政编码许可证。

这意味着邮政编码搜索非常不准确。邻近搜索非常差，即使是城镇搜索，通常也无法识别位置。

这就是为什么谷歌有一个首要的企业解决方案，它仍然更昂贵，不如像 bing 和 Via Michelin 这样也有 API 的商业地图专家。

作为一名自由职业开发者，如此严肃的企业会使用谷歌，因为该系统很弱，并且确实提供了一个淡化的解决方案。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-02-11T19:22:43.887

我知道这篇文章有点陈旧，但如果有人发现它仍然相关，您可能想查看南加州大学提供的免费地理编码服务。这确实包括通过 ajax 和静态调用进行地址验证。唯一的问题是他们要求返回链接，并且只提供 2500 个呼叫的分配。不仅仅是公平。 [https://webgis.usc.edu/Services/AddressValidation/Default.aspx](https://webgis.usc.edu/Services/AddressValidation/Default.aspx)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-02-09T22:28:53.270

您可以考虑使用验证国际地址的 CDYNE 的 PAV-I API。 [国际地址验证](http://cdyne.com/products/international-address-verification.aspx) 它们涵盖 240 多个国家/地区，因此它应该涵盖您要验证的所有国家/地区。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-07-23T21:35:08.480

一个很棒的博客，描述了 14 个地址查找器： [https ://www.conversion-uplift.co.uk/free-address-lookup-tools/](https://www.conversion-uplift.co.uk/free-address-lookup-tools/)

许多地址自动填充服务，包括 Google 的 Places API，似乎都提供国际地址支持，但准确性有限。

例如，新西兰地址和地理位置数据可从新西兰土地信息 (LINZ) 免费下载。当用户从 Google 或 Address Doctor 搜索地址（例如 76 Francis St Hauraki）时，将返回肯定匹配。匹配地块，但不匹配邮政/送货地址，即 76A 或 76B。这个问题在单一地块上的公寓和单元中被放大了。

为获得 100% 的准确性，请使用特定国家/地区的地址查找器，例如[https://www.addy.co.nz](https://www.addy.co.nz)用于新西兰地址自动填充。

# c# - 使用 Predicate / CreateDelegate 有什么问题？

> ID：682102
> 
> 赞同：0
> 
> 时间：2009-03-25T15:26:32.860
> 
> 标签：c#, delegates, predicate

我正在创建一个带有代表的简单代码生成器。

为什么我在运行时收到此错误：

> **绑定目标方法时出错。**

在下面的代码？

**XAML：**

```
<Window x:Class="Parser.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Loaded="Window_Loaded"
    Title="Parser" Height="600" Width="800">

        <TextBox x:Name="Output"
                 VerticalScrollBarVisibility="Visible"
                 Margin="10"/>
</Window> 
```

**代码隐藏：**

```
using System;
using System.Collections.Generic;
using System.Text;
using System.Windows;

namespace Parser
{
    public partial class Window1 : Window
    {
        private List<string> _fields;

        public Window1()
        {
            InitializeComponent();
        }

        private void Window_Loaded(object sender, RoutedEventArgs e)
        {
            _fields = new List<string> { "CustomerID", 
                "CompanyName",
                "ContactName",
                "ContactTitle",
                "Address",
                "City",
                "Region",
                "PostalCode",
                "Country",
                "Phone",
                "Fax"
            };

            Output.Text += ParseFieldsWithMethod("BuildAssignmentLines");
            Output.Text += ParseFieldsWithMethod("BuildEnabledLines");
        }

        private string ParseFieldsWithMethod(string theParseMethod)
        {
            Predicate<string> predicate = (Predicate<string>)Delegate.CreateDelegate(typeof(Predicate<string>),
                typeof(Window1).GetMethod(theParseMethod));

            StringBuilder sb = new StringBuilder();
            foreach (var field in _fields)
            {
                sb.Append(predicate.Invoke(field));
            }
            return sb.ToString();
        }

        public string BuildAssignmentLines(string field)
        {
            return String.Format("customer.{0} = Field_{0}.Text;\n", field);
        }

        public string BuildEnabledLines(string field)
        {
            return String.Format("Field_{0}.IsEnabled = false;\n", field);
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-25T15:31:47.543

Predicate 是一个函数，它接受一个字符串作为参数并返回一个布尔值。你的返回字符串。

您应该使用函数而不是谓词。

此外，您应该真正将函数作为参数发送，而不是按名称发送。

```
ParseFieldsWithMethod(x => BuildAssignmentLines(x));
ParseFieldsWithMethod(x => BuildEnabledLines(x));

private string ParseFieldsWithMethod(Func<string, string > parseMethod)
{
            StringBuilder sb = new StringBuilder();
            foreach (var field in _fields)
            {
                sb.Append(parseMethod(field));
            }
            return sb.ToString();
        } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T15:31:04.473

谓词返回`bool`- 你正在返回`string`。看起来你想要`Func<string,string>`而不是`Predicate<string>`. （或更改这些方法的返回类型和表达式。）

# crystal-reports - 打印的报告无法识别页边距

> ID：682108
> 
> 赞同：0
> 
> 时间：2009-03-25T15:28:39.547
> 
> 标签：crystal-reports, printing

我有一个使用 .net 框架在 vb 中开发的应用程序。我们正在使用 Crystal Reports XI 运行时从该应用程序运行报表。当我在 Crystal 中查看报告时，它们在页面上正确居中，但是，当我们在屏幕上查看报告时，一切看起来都是正确的，但是，当我们将其发送到打印机时，报告在页面上和左边距。谁能给我解决这个问题？我们通常先将报告打印到屏幕上，然后再打印到 Adob​​e PDF。

感谢你的协助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-13T02:44:13.903

转到文件/页面设置并确保您的边距设置正确。这也可能是打印机驱动程序问题。

# sharepoint-2007 - 在 MOSS2007 中处理会话超时的最佳实践/策略是什么？

> ID：682125
> 
> 赞同：0
> 
> 时间：2009-03-25T15:35:19.143
> 
> 标签：sharepoint-2007, session-timeout

我有一个 MOSS2007 Web 应用程序（使用发布站点模板创建）。在这个应用程序中，用户可以添加各种感兴趣的项目。这些感兴趣的项目作为一个组保存在数据库中。因此，每个用户都有不止一组的兴趣。允许用户随意添加/删除/编辑群组内的兴趣。

我的查询如下

*   当用户添加感兴趣的项目并且在 MOSS2007 会话超时之前从未将其保存在组中时，如何处理？

*   如何处理用户添加感兴趣的项目、保存并在 MOSS2007 会话超时之前添加更多的情况。

*   如何处理用户在 MOSS2007 会话超时之前添加感兴趣的项目、保存它、从已保存的项目中删除一些项目的情况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-06T12:46:52.063

I'd suggest:

> How to handle cases when user adds items of interest and never saves it in a group before MOSS2007 session times out?

Items are either stored in a local cookie, so they are there when the user logs in to MOSS again, or are lost.

> How to handle cases when user adds items of interest, saves it and then adds more before MOSS2007 session times out.

New items are either saved in cookie, or lost.

> How to handle cases when user adds items of interest, saves it, delete some items from saved ones before MOSS2007 session times out.

The deletion method should delete the records from the database. So they would be synced already. If however, you need a rollback option, you could do something similar to the Recycle bin functionality in MOSS...

Hope that helps.

# linq - VS2005 和 LINQ

> ID：682137
> 
> 赞同：1
> 
> 时间：2009-03-25T15:38:02.223
> 
> 标签：linq, .net-3.5, visual-studio-2005

如果我安装了 .NET 3.5，我可以在 VS2005 中使用 LINQ 吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-25T15:39:53.267

需要记住的是，与任何 IDE 一样，Visual Studio 的核心是一个带有集成调试器的美化文本编辑器，也许还有一些其他功能。您当然可以使用 Visual Studio 2005 输入 linq 程序的代码文本，然后使用 .Net 3.5 命令行编译器来构建它。您甚至可以找到或编写一个插件来自动化构建过程。

这意味着您的问题在技术上正确的答案是“是”。

但是，您不会获得*任何*额外的 IDE 支持：

*   智能感知不正确/损坏。
*   不正确/损坏的语法突出显示
*   无法使用 .Net 3.5+ 解决方案文件。
*   不支持调试器

结果是，如果我简单地说“不”，您可能会得到更好的服务。

如果您已经有 2005 但没有 2008，您有几个选择：

*   获取 2008 速成版
*   使用第三方工具，如#Develop
*   购买 2008 年完整版

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T15:39:53.170

VS 2005 中没有对 LINQ 的直接编译器支持。

您仍然可以使用 LINQ 命名空间和方法，但是，它不如在 VS 2008 中使用它那么优雅。

有关详细信息，请参阅[本文](http://www.codeproject.com/KB/linq/linq2005.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T15:40:08.880

Vs2005 和 C# 不直接支持扩展方法、Lambda 表达式、匿名类型或表达式树，这些都是 LINQ 的关键启用特性。一些早期的 LINQ 测试版确实适用于 VS2005 和 C#，但没有一个发布产品。

VB 可能也是如此，但我不能直接评论 VB，除非我 99.99% 肯定你不能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T15:42:47.953

简单的答案是否定的。LINQ 依赖于 VS2005 不支持的语言特性（例如扩展方法）。

# java - 更改 ZipEntry 的根目录？

> ID：682153
> 
> 赞同：0
> 
> 时间：2009-03-25T15:41:06.197
> 
> 标签：java, zip

我的项目有一些 xml 模板被修改并添加到一个 zip 文件中。问题是模板都在模板文件夹中，但 zip 文件的预期格式是将它们直接放在根目录中。

项目层次结构：模板/blah.xml

预期的 zip 文件层次结构：blah.xml

无论如何在不将 xml 文件移动到项目的根文件夹中的情况下实现这一点？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T16:20:43.417

我的大脑崩溃了……通过使用不同的名称进行输入和输出

```
 byte[] buf = new byte[1024];

    try
    {
        ZipOutputStream out = new ZipOutputStream(new FileOutputStream(targetFile));

        FileInputStream in = new FileInputStream("templates/blah.xml");

        out.putNextEntry(new ZipEntry("blah.xml"));

        int len;
        while ((len = in.read(buf)) > 0)
        {
            out.write(buf, 0, len);
        }

        out.closeEntry();
        in.close();
        out.close();
    } catch (IOException e)
    {
        e.printStackTrace();
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T15:48:33.527

你可以继承 ZipEntry 并让它做任何你想做的事情。但是，您需要了解代码是如何获取内容的，然后对其进行修改以获取正确的资源。

# informix - 您如何识别 Solaris 上的 Informix 版本？

> ID：682154
> 
> 赞同：3
> 
> 时间：2009-03-25T15:41:07.757
> 
> 标签：informix

我们在我们的 Solaris 服务器上运行 Informix，下面`/usr/informix/bin`有几个可执行文件，例如`'dbaccess'`和`'isql'`.

例如，在键入“isql -V”时，它们中的每一个都会产生不同的版本信息。

您如何识别运行的 SE 的确切版本？

**输出：**

```
'esql -V'
INFORMIX-ESQL Version 6.00.UH1

'isql -V'
INFORMIX-SQL Version 6.03.UC1

'dbaccess -V'
DB-Access Version 7.13.UC1 
```

然后在`/usr/informix/release`目录中有一个名为`"SE_7.1".`So的文件，说`Informix SE`我们正在运行的版本是准确的`7.13`吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-26T02:04:04.607

很可能，您正在运行 SE 7.13；确定的答案来自：

```
$INFORMIXDIR/lib/sqlexec -V 
```

但是，DB-Access 与 SE 一起分发，并且会提供正确的版本，除非在某个时候有 Informix Dynamic Server 的副本（或 Informix OnLine Dynamic Server，因为它当时会被标记）。

所有的软件都严重过时。ISQL 6.03 版大约在 1996 年发布；SE 7.13 会早一点，如果有的话。ESQL/C 可能是在 1995 年发布的；6.00.UE1 于 1994 年或 1995 年发布，而 UH1 的发布会稍晚一些（几个修复包）。形式上，没有任何软件保证符合 Y2K 标准；您将使用 SE 7.24 和 ISQL 6.05（或者可能是 7.20）和 ESQL/C 7.24 作为最低版本号。但是，SE 和 Y2K 的问题远没有其他版本严重。主要问题是代码会将 1900 添加到 2 位数年份，而不是 2000。

SE的当前版本是7.26；当前的 ISQL 版本是 7.50；当前版本的 ESQL/C 是（不要问）3.50。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T07:09:06.917

只是为了补充乔纳森通常详尽的答案，DB-Access 与引擎捆绑在一起，但 isql 和 esql 都是独立的产品。这就是您对版本号请求得到不同答案的原因。他们都是不同问题的正确答案;-)

# sql - 索引会吸收 SQL 吗？

> ID：682161
> 
> 赞同：5
> 
> 时间：2009-03-25T15:43:21.087
> 
> 标签：sql, indexing, partitioning

假设我有一个包含大量行的表，并且我想要索引的列之一可以具有 20 个值之一。如果我要在列上放置一个索引，它会很大吗？

如果是这样，为什么？如果我将数据分成 20 个表，每个表对应一个列的值，则索引大小将是微不足道的，但索引效果将是相同的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-25T16:51:50.893

索引（或索引）并不糟糕。在过去的几十年里，许多非常聪明的人花费了大量的时间来确保这一点。

但是，您的架构缺乏相同的专业知识和努力，可能确实非常糟糕。

在所描述的情况下，分区等同于应用聚集索引。如果表以其他方式排序（或以任意顺序），则索引必须占用更多空间。根据平台的不同，非聚集索引的大小可能会随着行相对于索引值的排序程度的增加而减小。

YMMV。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-25T15:48:26.600

糟糕的不是索引。它将索引放在错误的列上，这会很糟糕。

说真的，为什么你需要一个单列的表？该数据的含义是什么？它有什么用途？

还有20张桌子？我建议您首先阅读[数据库设计](http://en.wikipedia.org/wiki/Database_design)，或者向我们解释您的问题的背景。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-25T15:47:36.727

简短的回答：索引是否糟糕：是和否

更长的答案：如果使用得当，它们不会很烂。也许你应该开始阅读索引是如何工作的、为什么它们可以工作以及为什么它们有时不工作。

好的起点： [http ://www.sqlservercentral.com/articles/Indexing/](http://www.sqlservercentral.com/articles/Indexing/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-03-02T16:25:06.457

没有索引不烂，但是您必须注意如何使用它们，否则它们会适得其反地影响查询的性能。

**第一：架构/设计**
为什么要创建一个只有一列的表？这可能使规范化迈出了一大步。数据库设计是优化性能时要考虑的最重要的事情之一

**第二：索引**
简而言之，索引将帮助数据库对您的记录执行二进制搜索。如果没有对列（或一组列）的索引，数据库通常会退回到表扫描。表扫描非常昂贵，因为它涉及枚举每条记录。

对于索引扫描，数据库表中有多少条记录并不重要。由于（平衡）二叉树搜索将记录数量加倍只会导致一个额外的搜索步骤。

确定表的主键，SQL 会自动在该列上放置一个聚集索引。聚集索引执行得非常好。此外，您可以在 SELECT、JOIN、WHERE、GROUP BY 和 ORDER BY 语句中经常使用的列上放置非聚集索引。请记住索引有一定的重叠，尽量不要将聚集索引包含在非聚集索引中。

同样有趣的可能是索引的填充因子。你想优化你的表读取（高填充因子 - 更少的存储，更少的 IO）或写入（低填充因子更多的存储，更少重建你的数据库页面）。

**第三：分区**
使用分区的原因之一是优化您的数据访问。假设您有 100 万条记录，其中 500,000 条记录不再相关，而是出于归档目的而存储。在这种情况下，您可以决定对表进行分区并将 500,000 条旧记录存储在慢速存储上，而将其他 500,000 条记录存储在快速存储上。

**衡量就是知道**
了解发生了什么的最好方法是衡量你的 cpu 和 io 发生了什么。Microsoft SQL Server 有一些工具，例如 Management Studio 中的 Profiler 和执行计划，它们会告诉您查询的持续时间、读/写次数和 CPU 使用率。执行计划还将告诉您正在使用哪些或 IF 索引。令您惊讶的是，您可能会看到表扫描，尽管您没有预料到。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-25T15:46:29.770

> 假设我有一个包含大量行的表，并且我想要索引的一列可以具有 20 个值之一。如果我要在列上放置一个索引，它会很大吗？

索引大小将与您的行数和索引值的长度成正比。

索引不仅保留索引值，还保留某种指向行的指针（`ROWID`in `Oracle`，`LCID`in `PostgreSQL`，主键 in`InnoDB`等）。

如果您有`10,000`行和 1 个不同的值，您的索引中仍然会有`10,000`记录。

> 如果是这样，为什么？如果我将数据分成 20 个表，每个表对应一个列的值，索引大小将是微不足道的，但索引效果是一样的

在这种情况下，您将获得 20 个与原始索引大小相同的索引。

这种技术有时实际上用在所谓的分区索引中。它有它的优点和缺点。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-25T15:51:30.960

Standard b-tree indexes are best suited to fairly selective indexes, which this example would not be. 你没有说你正在使用什么 DBMS；Oracle 有另一种类型的索引，称为位图索引，它更适合 OLAP 环境中的低选择性索引（因为这些索引的维护成本很高，因此不适合 OLTP 环境）。

优化器将根据统计数据决定是否认为索引有助于在最快的时间内获取数据；如果没有，优化器将不会使用它。

分区是另一种策略。在 Oracle 中，您可以将表定义为在某些列上进行分区，并且优化器可以按照您的建议自动执行“分区消除”。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-25T15:50:52.240

抱歉，我不太清楚你所说的“大”是什么意思。

*   如果您的索引是聚集的，那么每条记录的所有数据都将位于同一叶页上，因此只要您正确编写查询，就可以为您的表创建最有效的索引。

*   如果您的索引是非聚集的，那么只有与索引相关的数据才会出现在您的叶子页面上。然后，根据您拥有的其他索引数量以及填充因子等详细信息，您的索引可能有效，也可能无效。一般来说，如果您的表上没有大量索引，那么您应该是安全的。

*   索引的效率还取决于您所说的进入列的 20 个值的数据类型。如果这些是预定义的值，那么它们的详细信息可能应该在具有简单主键数据类型（如 Int/Number）的查找表中。然后将该列作为外键添加到您的表中，并在该列上添加索引。

最终，您可以在列上拥有完美的索引。但它的最佳用途将在很大程度上取决于您编写的查询。因此，如果您的查询使用了索引，那么您就是黄金。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-25T15:46:05.793

索引纯粹是为了性能。如果索引不能提高您感兴趣的查询的性能，那么它很糟糕。

至于磁盘使用情况，您必须权衡您的担忧。不同的 SQL 提供程序以不同的方式构建索引，但作为客户，您通常相信他们会尽力而为。在您所描述的情况下，聚集索引可能对于大小和性能都是最佳的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-25T15:46:46.820

它足够大以按排序顺序保存所有行的这些值。

假设您有 20 个不同的 4 个字符的字符串和 100 万行，那么保存这些值至少需要 400 万字节（如果是 16 位 unicode，则为 8 个字节）。

# algorithm - OnLive：它是如何工作的？

> ID：682170
> 
> 赞同：4
> 
> 时间：2009-03-25T15:46:25.900
> 
> 标签：algorithm, optimization, compression, cloud

[OnLive](http://www.onlive.com/)是一款用于游戏的云计算解决方案。无论其硬件如何，它都可以将高端游戏流式传输到任何 PC。我想知道它是如何工作的：发送原始高清 res 图像和音频数据似乎不太可能。相对简单的压缩，比如 jpeg 和 mp3/ogg，能解决问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-26T05:44:53.217

你读过[这篇](http://pc.ign.com/articles/965/965535p1.html)文章吗？摘录：

> 它本质上是云计算的游戏版本——一切都是在线计算、渲染和存储的。在最简单的描述中，您的控制器输入被上传，高端服务器接收您的输入并玩游戏，然后将输出的视频流发送回您的计算机。可以把它想象成 Youtube 或 Hulu 之类的游戏。
> 
> 该服务几乎可以作为一个小型浏览器插件与任何 Windows 或 Mac 机器一起使用。或者，您还可以购买一个名为 OnLive MicroConsole 的小型设备，您可以通过 HDMI 直接连接到您的电视，但如果您的计算机支持将视频输出到您的电视，您可以这样做。当然，如果您不想将其传输到客厅的设备上，也可以只在计算机的显示器上播放。
> 
> [...]
> 
> OnLive 一直在努力克服滞后问题。第一步是创建一个尽可能快的视频压缩算法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-26T09:52:49.970

它基本上是基于 VNC 的游戏。显然他们使用视频压缩；我不确定是什么类型的。这两个明显的替代方案似乎是计算量相当轻的东西，例如运动 JPEG 甚至 MPEG 2，在运行游戏的同一服务器上运行，或者计算量更大但紧凑的东西，例如 H264，在专用硬件上运行。

就个人而言，如果我正在设计服务，我会选择后者：它允许您在不大规模升级所有服务器的情况下获得更好的压缩，而成本相对便宜的编解码器芯片。由于视频流较小，因此您可以吸引那些使用较差的编解码器连接边缘或太慢的人。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-26T06:04:42.657

这就是我的理解：它是一个基于瘦客户端的游戏解决方案。与 Wii、X-Box 或 Play Station 等游戏机不同，玩家端不需要 CPU/GPU 或任何处理。游戏通过互联网从怪物服务器流式传输，就像 HiFi 终端会话（RDP/远程桌面），但具有高清图形。控件（输入）被发送到服务器，图形被发回。它可以通过网络浏览器插件在 Mac 或 PC 上播放，也可以在带有连接服务器的小单元的电视中播放。高清需要 5mbps 连接，标清需要 1.5mbps 连接。几乎所有游戏标题都将可用或移植到该平台。无需购买游戏机或游戏。不需要高端游戏电脑……只需宽带连接（当然这应该是高端的）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-20T12:50:07.140

我认为他们正在使用类似于 HDMI 视频 h264 编码器的东西，以便直接从 hdmi 音频/视频输出流式传输视频。像这个[HDMI 编码器](http://www.oupree.com/OPR-NH100-1-Channel-HDMI-Encoder.html)或这个[h264 实时编码器](https://www.blackmagicdesign.com/products/h264prorecorder)

您也可以像这样使用图像采集卡： [http ://www.epiphan.com/products/frame-grabbers/vga2ethernet/](http://www.epiphan.com/products/frame-grabbers/vga2ethernet/)

现在还有一个解决方案。如果您拥有最新的 Nvidia 显卡，则无需额外硬件即可获得硬件加速捕获的好处。它被称为“Gamestream”你可以购买支持该协议的 Nvidia 设备之一，或者你可以下载一个名为“Moonlight”的开源应用程序[http://moonlight-stream.com](http://moonlight-stream.com)

# algorithm - 在数组中排列 0 和 1

> ID：682171
> 
> 赞同：16
> 
> 时间：2009-03-25T15:46:27.227
> 
> 标签：algorithm, language-agnostic

这是我最近遇到的一个面试问题。我想知道其他人对这个问题的看法。

**问题：**

您将获得一个包含员工详细信息的结构，其中包含`int`部门和`string`姓名两个元素。

```
struct Employee
{ 
    string Name;
    int Dept;
} 
```

给你 N 个员工的详细信息，其中 N/2 员工有`Dept == 0`，N/2 员工有`Dept == 1`，按任意顺序排列。您需要根据员工详细信息的`Dept`值对其进行排序，并且它应该是[稳定](http://en.wikipedia.org/wiki/Stable_sort#Stability)的，即应保持原始记录中 1 和 0 的顺序。

例如，给定以下示例数据：

```
名称部门

X1 0
X2 1
X3 0
X4 1
X5 0

```

排序后的结果应该是：

```
名称部门

X2 1
X4 1
X1 0
X3 0
X5 0

```

算法应该是稳定的，时间复杂度应该是 O(N)，额外变量的空间是恒定的（这意味着排序应该就地完成）。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-25T15:50:39.980

分配第二个数组 (O(N))。遍历第一个数组并按照它们出现的顺序将所有 1 移动到第二个数组。再次迭代并将剩余的 0 以相同的顺序移动到第二个数组。所有操作 O(N)。这不是原位（就地）解决方案。通过运行一次快速排序分区算法获得了一个不稳定的原位解决方案。

在进行了一些研究之后，似乎没有任何额外内存的已知 O(N) 解决方案是不稳定的。有学术研究对高效的 0-1 稳定排序原位（原位），但解决方案需要一些额外的内存。我想知道原始问题陈述是否没有以精确的方式复制。没有稳定性要求，问题很容易；无需现场要求也很容易。对于这两个要求（原位，稳定），解决方案似乎是难以捉摸的。

在此处的答案中，有一种算法可以在 O(N) 中工作并且在原位，但前提是关键字段是 (1) 可变的并且 (2) 可以包含整数而不是单个位。这可行，但不是原位 0-1 稳定排序，因为假设每个数组元素都有 O(log N) 可写内存可用。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-03-25T16:18:17.557

好的，这是我的方法。

例如 a[] = { 1,0,0,0,1,1,1,0,0,1};

**伪代码：**

1.  有两个柜台，`count1 = 0`和`count2 = (n/2)+1`
2.  遍历数组，

    ```
    if(arr[ i ] == 1) 
    { 
        arr[ i ] = count1++;
    } else { 
        arr[ i ] = count2++ 
    }; 
    ```

3.  在遍历结束时，您的数组中填充了数字 0 到 n-1，例如：

    ```
    a[ ] = { 0, 5, 6, 7, 1, 2, 3, 8, 9 4} 
    ```

4.  现在问题来了对上述结果数组进行排序，这可以在 O(N) 中完成，如下所示：

    ```
    for(j = 0; j <= 1; j++)  
    {
        for(i = 0; i<n; i++)  
        {  
            if(arr[ i ] != i)  
            {  
                swap(arr[ i ], arr[ arr[ i ] ]);  
            }  
        }  
    } 
    ```

    注意： j 循环只运行两次，与“n”无关，并且具有恒定的复杂性。整个循环的顺序是 2*n = O(n)。

5.  数组排序后，再次遍历数组并将元素设置`arr[0]`为`arr[n/2]`to`'1'`和`arr[(n/2)+1]`to `arr[n]`as `'0'`。

空间复杂度是常数，时间复杂度是 O(step2) + O(step4) + O(step5) = n + 2n +n = 4*n = O(n)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-25T15:55:46.473

`std::stable_partition`一起使用并且`std::equal_to`应该`std::binder1st`以一种很好的、​​功能性的、类似 STL 的方式来解决问题：

```
using namespace std
stable_partition(&array[0], &array[N], binder1st(equal_to(), 1)); 
```

当然，这假设数组的元素定义了一些比较运算符（即你可以说`array[i]==1`...）。如果它们只是整数，那么保持顺序没有任何意义......

至于复杂性：为了是*O(N)*，`stable_partition`需要额外的内存。如果算法未能分配额外的内存，它会在*O(N log N)*中执行。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-25T15:50:55.580

原始问题文本没有提及除整数以外的任何其他字段（此后已被编辑）。

在这种情况下，稳定性没有意义，因为两个相等的数字在其他方面是无法区分的。解决方案是遍历数组并放置 1 的 n/2 次，然后放置 0 的 n/2 次。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-25T16:19:18.490

为简单起见，使用整数而不是位，但基本概念是相同的。并不是说不同的 1 和 0 的顺序最终很重要！

```
var emps = new[] 
           {
               new Employee(X1, 0),
               new Employee(X2, 1),
               new Employee(X3, 0),
               new Employee(X4, 1),
               new Employee(X5, 0),
               new Employee(X6, 1)
           };

var sortedEmps = new Employee[bits.Length];

var oneIndex = 0;
var zeroIndex = bits.Length/2;

foreach (var employee in employees)
{
    if (employee.Dept  == 1)
        sortedEmps[oneIndex++] = employee;
    else
        sortedEmps[zeroIndex++] = employee;
} 
```

更新做员工问题。添加了一名额外的员工，因为最初的问题说每个人都有 N/2，所以必须有一个偶数才能做到这一点。否则是一样的。

*不确定现在是否可以编译，因此将其视为伪代码！*

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-26T16:54:18.727

[这将是基数排序](http://en.wikipedia.org/wiki/Radix_sort)的第一步。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-25T15:52:40.130

在抽象的术语中，您可以使用修改后的插入排序，将所有零值交换到右侧，将所有值交换到左侧。然而，这将具有大于 O(n) 的复杂性。

我有点困惑为什么排序很重要，如前所述，字节是无法区分的。

编辑：新的例子有帮助。我的算法的好处是，即使在最坏的情况下它比线性时间慢，它的内存使用量只有 O(n)。由于 1 和 0 只是较大对象（可能任意大）的键，因此内存可能是一个问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-25T18:25:36.987

到底是什么，这是整个解决方案：arr 是项目列表，item.id 是 0 或 1，存储为 int。
此代码将 0 移到前面。

```
count = { 0:0, 1:len(arr)/2 }
for ii in range(len( arr )):
  id = arr[ii].id
  arr[ii].id = count[id]
  count[id] += 1
for ii in range(len( arr )):
  while arr[ii].id != ii:
    T = arr[ii]
    arr[ii] = arr[arr[ii].id]
    arr[T.id] = T
for ii in range(len( arr )):
  arr[ii].id = (ii >= len(arr)/2) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-26T04:38:12.333

我在 Perl 中使用简单加权的实现。

```
use Modern::Perl;

my @data;
{
  use List::MoreUtils qw'natatime';
  my $iter = natatime 2, qw'
    X1  0
    X2  1
    X3  0
    X4  1
    X5  0
  ';

  while( my($a,$b) = $iter->() ){
    push @data, [$a,$b]
  }
}

my @sorted = sort {
  ($a->[1] <=> $b->[1]) * -2 + # gives more weight to second element
  ($a->[0] cmp $b->[0])
} @data;

say "Name\tDept\n";
say join "\t", @$_ for @sorted; 
```

```
名称部门

X2 1
X4 1
X1 0
X3 0
X5 0

```

`<=>`和比较的输出`cmp`是 的值`-1,0,1`。
通过将其中一个camparisons乘以2，我们得到一个`-2,0,2`。
添加另一个运算符的值后，我们得到一个`-3,-2,-1,0,1,2,3`

我想看看它会做多少比较，所以我添加了一些调试信息并想出了这个。

```
 a           b        a1      b1     a0     b0
X1,0   ->   X2,1      0   --> 1      X1 <-  X2
X3,0   ->   X4,1      0   --> 1      X3 <-  X4
X2,1  <-    X4,1      1   -   1      X2 <-  X4
X4,1  <-    X1,0      1 <--   0      X4  -> X1
X1,0  <-    X3,0      0   -   0      X1 <-  X3
X2,1 <<-    X5,0      1 <--   0      X2 <-  X5
X5,0   ->>  X4,1      0   --> 1      X5  -> X4
X5,0   ->   X1,0      0   -   0      X5  -> X1
X5,0   ->   X3,0      0   -   0      X5  -> X3

The arrows point at the earlier value. 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-05-01T13:02:41.213

这是适用于数组的解决方案`int`。你可以修改它。

```
sort (int [] a) {
   int pos = 0;
   for (int i = 1; i < a.length; i++) {
       if (a[i] == 0 && a[pos] == 1) {
           swap(a, pos, i);   // this makes all 0's go to the left.
           pos++;
       }
   } 
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-07-20T15:13:21.727

```
#include<stdio.h>
//#include<conio.h>

int main()
{
  int i,a[20]={0};
  int *ptr1,*ptr2;
  //clrscr();
  //a[2]=a[4]=a[6]=a[8]=a[16]=1;
  a[19]=a[18]=1;

  for(i=0;i<20;i++)
    printf("%d",a[i]);

  printf("\n\nafter");

  ptr1=ptr2=a;
  for(i=0;i<20;i++)
  {
    if(*ptr1==0&&*ptr2==1)
    {
      int temp=*ptr1;*ptr1=*ptr2;*ptr2=temp;
      ptr1++;ptr2++;
    }
    else if(*ptr1==1&&*ptr2==0)
    {
      ptr1++;ptr2++;
    }
    else if(*ptr1==0&&*ptr2==0)
    {
      ptr2++;
    }
    else
    {
      if(ptr1<ptr2)
        ptr1++;
      else
      {
        ptr1++;ptr2++;
      }
    }
  }

  for(i=0;i<20;i++)
  {
    printf("%d",a[i]);
  }

 // getch();

  return 0;
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-09-30T13:03:34.590

它可以一次性完成并就地完成。

1.  取两个变量进行索引。一个将指向第 0 个位置，另一个将指向
    最后一个元素位置。
2.  循环直到索引变量相等或相互交叉。
3.  从第一个位置搜索值 1，从最后一个位置搜索值 0
    ，然后交换两个元素。在一次通过中，我们可以在 O(n) 时间内对数组进行排序。

例如：#include #define N 6 int main() { int list[N]={1,1,0,0,0,0}; 整数 s，结束，tmp；s=0；结束=N-1；

```
 while(s less than end)
    {
        if(list[s]==1)
        {
            while(list[end] == 1) 
               end--;

            if(list[end] == 0 && s less than end)
            {
                tmp = list[s];
                list[s] = list[end];
                list[end] = tmp;
                s++;end--;
            }
        }
        else s++;
    }
    for(s=0;s less than N;s++)
    {
        printf("%d ",list[s]);
    }
    return;
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-08-12T09:31:15.683

```
left = 0;
right = n-1;

while(left<right){

while(left < right && array[left]==0){
    left++;
}

while(left < right && array[right]==1){
    right--;
}

while(left<right){
    array[left]=0;
    array[right]=1;
    left++;
    right--;    
}

} 
```

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2009-03-25T15:55:39.437

简单的：

```
function sort(array):
    new_array = new Array(array.length)
    x = 0
    for(i : array): if(i): new_array(x++) = 1
    return new_array 
```

如果你真的想拥有*相同的*1 和 0：

```
function sort(array):
    new_array = new Array(array.length)
    x, y = 0, array.length / 2
    for(i : array):
        if(i): new_array(x++) = i
        else:  new_array(y++) = i
    return new_array 
```

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2009-03-25T19:17:09.857

这是我在 C# 中的（完整的）尝试。它会生成列表并将随机员工加入其中，因此`numberOfEmployees`您可以随心所欲。我意识到可能有一种更简单的方法可以做到这一点，因为原始海报指定 0 部门员工的数量与 1 部门员工的数量相同，但我无法自拔。

```
struct Employee
{
    public Employee(string name, int dept)
    {
        this.name = name;
        this.dept = dept;
    }

    public string name;
    public int dept;
}

class Program
{
    static void Main(string[] args)
    {
        int numberOfEmployees = 100;
        Random r = new Random();

        Employee[] emps = new Employee[numberOfEmployees];
        var empBuf = new Employee[numberOfEmployees];
        int nextAvail = 0;

        // Initialize array of employees with random data
        for (int i = 0; i < numberOfEmployees; i++)
        {
            emps[i] = new Employee("x" + i.ToString(), r.Next(0, 2));
        }

        Console.WriteLine("Old list:");
        foreach (var e in emps)
        {
            Console.WriteLine("Name: {0}, Dept: {1}", e.name, e.dept);
        }

        // throw employees with dept == 1 in first
        for (int i = 0; i < numberOfEmployees; i++)
        {
            if (emps[i].dept == 1)
            {
                empBuf[nextAvail] = emps[i];
                nextAvail++;
            }
        }

        // stick the employees with dept == 0 in last
        for (int i = 0; i < numberOfEmployees; i++)
        {
            if (emps[i].dept == 0)
            {
                empBuf[nextAvail] = emps[i];
                nextAvail++;
            }
        }

        Console.WriteLine("New list:");
        foreach (Employee e in empBuf)
        {
            Console.WriteLine("Name: {0}, Dept: {1}", e.name, e.dept);
        }

    }
} 
```

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2011-09-30T13:08:43.213

我可以想到一个算法，它需要 O(n + i) 时间（最坏情况 O(2n-1) 和最好情况 O(n)）并且没有额外空间。我们开始从 0 到 n-1 遍历数组，每次遇到 1 时，我们都会增加一个计数器并将 1 替换为 0。现在，当我们到达数组的末尾时，我们将开始向后移动，计数器和初始化一样多每个数字加 1。

```
private static int[] foo(int[] array) {

int counter = 0;
int i;

for(i = 0; i < array.length; i++) {
if (array[i] == 1) {
    array[i] = 0;
    counter++;      
}
}

while(counter > 0) {
array[--i] = 1;
counter--;
}
return array;
} 
```

# wpf - WPF：TreeviewItem 中的组合框

> ID：682178
> 
> 赞同：0
> 
> 时间：2009-03-25T15:47:23.763
> 
> 标签：wpf, treeview, treeviewitem

我是WPF的新手，很抱歉这个愚蠢的问题。

可以与选定的 TreeViewItem 并排显示组合框吗？

我需要如下链接左图所示的内容：[http ://www.mypicx.com/03242009/Combobox_in_TreeviewItem/](http://www.mypicx.com/03242009/Combobox_in_TreeviewItem/)

我试图这样做：

`<TreeView Name="treeView1">
<TreeViewItem Header="aaa">
<ComboBox Height="19">
<ComboBoxItem Content="111" IsSelected="True"></ComboBoxItem>
<ComboBoxItem>222</ComboBoxItem>
<ComboBoxItem Content="333"></ComboBoxItem>
</ComboBox>
<TreeViewItem Header="aaa1">
</TreeViewItem>
<TreeViewItem Header="aaa2">
</TreeViewItem>
</TreeViewItem>
<TreeViewItem Header="bbb">
<TreeViewItem Header="bbb1" />
<TreeViewItem Header="bbb2" />
</TreeViewItem>
<TreeViewItem Header="ccc" />
</TreeView>`
以及您可以在右图中看到的结果。

同时我需要知道如何在视觉上做到这一点。稍后我需要对 SelectedItemChanged 事件做一些事情。

提前致谢！

PS对不起我的英语

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T17:42:07.043

你需要做的就是把你的组合框像这样放在你的 Header 中

```
<TreeView Name="treeView1">
    <TreeViewItem>
        <TreViewItem.Header>
            <StackPanel Orientation="Horizontal">
                <ComboBox Height="19">
                    <ComboBoxItem Content="111" IsSelected="True"></ComboBoxItem>
                    <ComboBoxItem>222</ComboBoxItem>
                    <ComboBoxItem Content="333"></ComboBoxItem>
                </ComboBox>
            </StackPanel>
        </TreViewItem.Header>
        <TreeViewItem Header="aaa1">
        </TreeViewItem>
        <TreeViewItem Header="aaa2">
        </TreeViewItem>
    </TreeViewItem>
    <TreeViewItem Header="bbb">
        <TreeViewItem Header="bbb1" />
        <TreeViewItem Header="bbb2" />
    </TreeViewItem>
    <TreeViewItem Header="ccc" />
</TreeView> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T17:57:31.547

使用 ItemTemplate。 [http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/ec6781bb-a81d-4204-bc13-937683110b0d/](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/ec6781bb-a81d-4204-bc13-937683110b0d/)

# windows-vista - 以编程方式禁用 UAC

> ID：682182
> 
> 赞同：19
> 
> 时间：2009-03-25T15:47:43.713
> 
> 标签：windows-vista, uac

是否可以在 Vista 中以编程方式禁用 UAC？或者，我可以让我的应用程序以任何方式不受 UAC 设置的限制吗？仅供参考，应用程序需要即时安装硬盘，这就是为什么我不能每次都请求 UAC 许可的原因......

更新：

我正在寻找与 Kosi2801 提到的内容一致的东西，基本上是要求用户始终以“提升”模式启动程序。我希望权限是 1 次，我并不是说我在没有先请求权限的情况下以编程方式禁用 UAC。我确信有很多程序需要在这种模式下运行（尤其是与硬件相关的程序），所以应该有某种方式来适应它。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2010-07-29T15:09:23.483

将 HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System 中的 EnableLUA DWORD 值设置为 0 并重新启动。

这将毫无问题地禁用 UAC，我会对您的所有用户执行此操作，无论是否允许由您决定，因为 vista UAC 太可怕了，我相信拥有它的人越少越好（仅在 vista 中） ) 现在在win7中更好。

玩我的注册表技巧:)

win7 也可以，请告诉我你是怎么处理的。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-03-25T15:51:00.273

您不能以编程方式禁用 UAC，但您可以强制程序从一开始就以提升的权限运行，因此它不会每次都提示。

这将导致它在启动时提示一次，但不是每次需要访问时都提示。

为此，您需要创建一个清单文件并设置`<requestedExecutionLevel level="requireAdministrator">`

[有关详细信息，请参阅 MSDN。](http://msdn.microsoft.com/en-us/library/bb756929.aspx)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-25T15:50:24.457

UAC 的目的是防止执行不需要的应用程序。如果可以以编程方式禁用它，那将毫无价值。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-12-25T01:21:02.747

我在这里发布了一个有点颗粒（但丑陋）的解决方案

```
http://stackoverflow.com/questions/5344021/bypass-uac-in-vbscript/34445992#34445992 
```

仅当您可以从任务计划程序启动应用程序时，它才有效。我让它在两台 Windows 7 笔记本电脑上运行。这是一个行政解决方案。您需要管理员权限才能实现它。我将它用于 powershell 和我的 UPS 电源备份应用程序。我怀疑我会找到其他用途。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-05-14T19:15:40.803

我创建了一个小应用程序来执行此操作，但基本上您需要设置 4 个注册表项。

C# 示例：

```
Microsoft.Win32.Registry.SetValue("HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System","EnableLUA", 0);

Microsoft.Win32.Registry.SetValue("HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System", "ConsentPromptBehaviorAdmin", 0);

Microsoft.Win32.Registry.SetValue("HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System", "PromptOnSecureDesktop", 0);

Microsoft.Win32.Registry.SetValue("HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Action Center\\Checks\\{C8E6F269-B90A-4053-A3BE-499AFCEC98C4}.check.0", "CheckSetting", StringToByteArray("23004100430042006C006F00620000000000000000000000010000000000000000000000"), RegistryValueKind.Binary); 
```

我的应用程序每 5 分钟作为服务运行一次，以“对抗”组策略，这对于开发人员机器来说是绝对的烦恼。

[https://github.com/zleight1/DisableUAC](https://github.com/zleight1/DisableUAC)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T15:51:49.290

以编程方式禁用 UAC 会破坏其目的，因为这也可能由恶意软件、蠕虫、特洛伊木马和病毒来完成，并且根本没有真正的安全效果。

您可能需要在管理员帐户下运行您的应用程序，或者（我认为）让 Microsoft 以某种方式签署您的应用程序。

可能还有其他我不知道的方式，但它们都不是以编程方式！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-10T05:01:17.100

UAC 是一种必要的邪恶，就像在城市中使用信号量一样。我建议适应新的范式。我个人不喜欢 UAC；但我了解目的和好处。不幸的是，我们都创造了这个怪物。让我们回到 1983 年，对这些年来的变化做一个简短的评估，然后，我们就会明白了。当然，如果意图是私人使用，那么一切皆有可能，如上所述；但这将是有风险的，并成为黑洞的责任。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-03-25T15:49:53.490

那将打败 UAC 的对象。所以不，你不能。

# python - 哪个版本的python为for循环添加了else子句？

> ID：682185
> 
> 赞同：14
> 
> 时间：2009-03-25T15:48:24.353
> 
> 标签：python, for-loop

哪个是第一个包含[for 循环 else 子句](http://docs.python.org/tutorial/controlflow.html#break-and-continue-statements-and-else-clauses-on-loops)的 python 版本？

我发现 python 文档通常可以很好地记录添加功能的时间，但我似乎无法找到有关此功能的信息。（在编程网站上搜索“for”和“else”是特别困难的术语并没有帮助）

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-03-26T01:05:03.297

它从一开始就存在。要查看这一点，请从 alt.sources 获取源代码，特别是标题为“ [Python 0.9.1 part 17/21](http://groups.google.com/group/alt.sources/browse_thread/thread/74a577bbcfc4be0a/cbaaec4fbfebbbb6) ”的消息。日期是 1991 年 2 月 21 日。这篇文章包括语法定义，其中指出：

```
for_stmt: 'for' exprlist 'in' exprlist ':' suite ['else' ':' suite] 
```

如果你比我更努力的话，你也许能找到 0.9.0 的源代码，但由于第一次公开发布是 2 月 20 日的 0.9.0，那你总有一天会回来的。0.9.1 版本是一个不影响这部分语法的小补丁。

（这是[UTSL参考还是什么？](http://catb.org/jargon/html/U/UTSL.html)*你*最后一次查看 shar 文件是什么时候？；）

顺便说一句，我重建了原始源代码并对其进行了一些调整，以便在我的 OS X 10.4 机器上的 gcc-4.0 下编译。[少数感兴趣的人的详细信息](http://www.dalkescientific.com/writings/diary/archive/2009/03/27/python_0_9_1p1.html)，包括[python-0.9.1.tar.gz](http://dalkescientific.com/Python/python-0.9.1.tar.gz)。

整个开发历史都可以从版本控制中获得，即使在两次更改版本控制系统之后也是如此。cpython Mercurial 存档中的“hg log -p -r 6:7”显示“for/else”是在 1990 年 10 月 14 日星期日 12:07:46 +0000 提交的，之前的提交是 10 月 13 日星期六 19:23 :40 1990 +0000。for/else 自 1990 年 10 月以来一直是 Python 的一部分。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-25T15:57:15.703

它至少从[1.4](http://www.python.org/doc/1.4/ref/ref7.html#HDR2)开始就存在了，这是我所知道[的文档的最旧版本。](http://www.python.org/doc/versions/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T02:11:14.303

从 1.0.1 版开始，至少..

```
Python 1.0.1 (Mar 27 2009)
Copyright 1991-1994 Stichting Mathematisch Centrum, Amsterdam
>>> for x in range(2):
...     print x
... else:
...     print "loop done"
... 
0
1
loop done 
```

# .net - 打印不带预览的 ServerReport

> ID：682188
> 
> 赞同：10
> 
> 时间：2009-03-25T15:48:50.887
> 
> 标签：.net, sql-server, reporting-services, printing

我通过 ReportViewer 控件部署了一个 SQLServer 2005 Reporting Services ServerReport，并经常被我的 Winforms 应用程序（Framework 2.0）使用。

我需要的是从应用程序的一种形式中提供一个一键式打印按钮，该按钮仅触发打印对话框，而不启动 ReportViewer。

我一直在尝试将报告呈现为字节数组，但我无法通过它。

该报告有多个页面，所以我不知道适用于本地报告的“图像”渲染是否也适用于服务器报告。

我一直在寻找 MSDN，但仅参考本地报告：

[http://msdn.microsoft.com/en-us/library/ms252091(VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms252091(VS.80).aspx)

我可以在服务器端报告中获得的少量信息是使用对 ReportServer Web 服务的 Web 引用，我不希望这样。

[http://blogs.msdn.com/bryanke/articles/71491.aspx](http://blogs.msdn.com/bryanke/articles/71491.aspx)

有没有办法使用打印对话框打印服务器报告，而不向用户显示报告查看器（我不介意它是否在幕后）？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-25T21:20:09.733

好的，终于想通了。

该博客文章几乎包含我需要的所有内容，但我将在此处发布完整答案以供参考。

我最终在幕后使用了报表查看器对象，但这只是为了方便，因为它不是必需的。

第一步是询问用户打印机设置：

```
Dim doc As New Printing.PrintDocument()
AddHandler doc.PrintPage, AddressOf PrintPageHandler
Dim dialog As New PrintDialog()
dialog.Document = doc
Dim print As DialogResult
print = dialog.ShowDialog()
doc.PrinterSettings = dialog.PrinterSettings 
```

有了这个，我们继续配置我们的报告调用：修改这个字符串，您可以在任何纸张尺寸和任何方向上打印（切换横向的高度和宽度），但报告本身必须在相同的页面布局中配置。

```
Dim deviceInfo As String = _
"<DeviceInfo>" + _
"<OutputFormat>emf</OutputFormat>" + _
"  <PageWidth>8.5in</PageWidth>" + _
"  <PageHeight>11in</PageHeight>" + _
"  <MarginTop>0.25in</MarginTop>" + _
"  <MarginLeft>0.25in</MarginLeft>" + _
"  <MarginRight>0.25in</MarginRight>" + _
"  <MarginBottom>0.25in</MarginBottom>" + _
"</DeviceInfo>"

Dim warnings() As Warning
Dim streamids() As String
Dim mimeType, encoding, filenameExtension, path As String
mimeType = "" : encoding = "" : filenameExtension = "" 
```

最后，我们渲染报告及其所有页面。

请注意，如果报表只有一页，则永远不会使用 renderStream 方法。

rpt_control 是报表查看器控件，之前配置并针对服务器报表。

请注意，在此代码中，我们将页面添加到列表中。这个列表是一个全局变量，因为它在 PrintPageHandler 方法中是必需的。

```
Dim data() As Byte
rpt_control.ServerReport.SetParameters(_parametros)
data = rpt_control.ServerReport.Render("Image", deviceInfo, mimeType, encoding, filenameExtension, streamids, warnings)
pages.Add(New Metafile(New MemoryStream(data)))

For Each pageName As String In streamids
    data = rpt_control.ServerReport.RenderStream("Image", pageName, deviceInfo, mimeType, encoding)
    pages.Add(New Metafile(New MemoryStream(data)))
Next
doc.Print() 
```

到目前为止，我们还没有进行任何打印，这实际上是由我们之前引用的 PrintPageHandler 方法处理的。

```
Dim pages As New List(Of Metafile)
Dim pageIndex As Integer = 0
Private Sub PrintPageHandler(ByVal sender As Object, ByVal e As PrintPageEventArgs)
    Dim page As Metafile = pages(pageIndex)
    pageIndex += 1
    e.Graphics.DrawImage(page, 0, 0, page.Width, page.Height)
    e.HasMorePages = pageIndex < pages.Count
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-08T09:49:56.490

上面大卫给出的答案有2个警告： -

1) SQL2005 上返回流标签的顺序通常是从第二页到最后一页，但是在负载很重的机器上（例如生产环境），它们很有可能以任意顺序返回。

流 id 采用 <reportname>_nn 的形式，其中 nn 是一个数字。这使得排序有点棘手，因为报告名称将按字母顺序排列，而数字只是简短的形式，因此页面“myreport_2”将在页面“myreport_10”之后排序。导致我的第二个警告

2) 在 SQL 2005 上，报告后缀从 2 开始，在 SQL 2008 上，它们从 1 开始（对于第 2 页）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-07-09T03:24:50.510

尝试将此代码与 SQL Server 2008 R2 一起使用的人会发现它只打印多页报告的第一页。有一个新的“行为”，其中返回到 streamids 的数组是空的。请在此处让 Microsoft 知道您的关心：

[https://connect.microsoft.com/SQLServer/feedback/details/573997/with-ssrs-2008-r2-microsoft-reporting-winforms-serverreport-render-method-returns-no-stream-identifiers-for-image-格式＃](https://connect.microsoft.com/SQLServer/feedback/details/573997/with-ssrs-2008-r2-microsoft-reporting-winforms-serverreport-render-method-returns-no-stream-identifiers-for-image-format#)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T21:19:29.890

我看到了这个示例，但不知道它是否适合您的需求： [http ://www.gotreportviewer.com/EMFPrint.zip](http://www.gotreportviewer.com/EMFPrint.zip)

# powershell - 如何让 Powershell 在计划任务中执行？

> ID：682189
> 
> 赞同：4
> 
> 时间：2009-03-25T15:49:20.840
> 
> 标签：powershell

我创建了一个 Powershell 脚本并将其设置为在 .bat 文件中运行。当我单击 .bat 文件时，Powershell 脚本会像冠军一样运行。然后，我将 .bat 文件设置为作为计划任务运行。当我右键单击它并以交互方式启动它时，它再次像冠军一样工作。问题是当计划在晚上无人看管的任务运行时它会失败。

不确定这是否重要，但我在 Windows 2003 Server 64 上使用 Powershell v.1。

在此先感谢您的帮助。

============================================ 计划任务的状态是“无法启动”。也许失败是错误的选择，因为任务可能甚至没有开始运行。

该任务设置为以我的用户身份运行，并且我设置为机器上的本地管理员。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T16:01:43.523

检查计划任务的安全设置计划任务是否可能在无权访问批处理文件的凭据下运行。

添加新任务时，系统会要求您输入凭据

![替代文字](https://farm4.static.flickr.com/3451/3385438202_4f9d1697ae_o.png)

您可以检查已创建任务的凭据 ![替代文字](https://farm4.static.flickr.com/3603/3385438204_ba445d08c1_o.png)

***[更新]***

> 计划任务的状态为“无法启动”。也许失败是错误的选择，因为任务可能甚至没有开始运行。

确保`Task Scheduler`服务正在运行
![替代文字](https://farm4.static.flickr.com/3547/3384733657_d69ab20a29_o.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T16:01:11.390

任务设置为使用您的用户帐户运行还是作为系统运行？检查 cmd.exe 和 powershell.exe 的访问权限。

此外，如果您转到已安排的任务，您可以在高级菜单中执行“查看日志”以检查错误消息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T16:01:34.663

只是一个猜测，但这可能与运行脚本的帐户/安全上下文有关吗？如果它在系统帐户上运行，那么这肯定是一个问题。（我怀疑它只是在您的用户帐户上运行。）首先检查脚本运行时是否正确设置了所有路径变量。否则，您能否提供更多关于它究竟是如何失败的信息（即任何错误消息）？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T16:03:35.627

从任务管理器运行时，当前目录可能未按预期设置。尝试从命令行运行您的 bat 文件，而您与该文件（和您的 .ps1 脚本）不在同一目录中。

否则：检查权限。

# language-agnostic - 如果函数在无限递归期间超出堆栈空间会发生什么？

> ID：682191
> 
> 赞同：1
> 
> 时间：2009-03-25T15:50:13.117
> 
> 标签：language-agnostic, recursion, operating-system

有一个函数可以无限递归地调用自己。

这个函数也有一些参数。

对于每个函数调用，参数和返回地址都被压入堆栈。

每个进程都有固定大小的堆栈空间，不能像堆一样动态增长。而且我猜每个线程也有自己的堆栈。

现在如果一个函数被无限递归调用并且进程耗尽了堆栈空间，会发生什么？

程序会崩溃吗？操作系统会处理这种情况吗？有 4GB 的地址空间，为什么操作系统不能做一些事情来增加堆栈大小。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-25T15:52:36.777

[堆栈溢出。](http://en.wikipedia.org/wiki/Stack_overflow)

在 UNIX 和兼容的情况下，该进程将被终止抛出**`SIGSEGV`**或**`SIGSTKFLT`**发出信号。

在 Windows 中，该进程将终止并抛出异常**`STATUS_STACK_OVERFLOW`**。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T15:52:27.900

至少对于 C++，你将处于“未定义行为”的领域——有点像暮光之城，任何事情都可能发生。

如果递归是无限的，增加堆栈大小有什么好处？早点失败总比晚点好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T15:58:12.333

根据语言的不同，您将获得异常（例如在 Java 中）或程序将崩溃（在 C、C++ 中）。

通常堆栈相对较小，因为这就足够了，堆栈溢出会发出错误信号。在 Java 中，如果必须，可以使用命令行选项增加堆栈空间。

另请注意，函数式语言通常将尾递归编译为循环，在这种情况下不使用堆栈空间。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-25T16:00:22.000

这与语言无关 - 它在很大程度上取决于语言/平台。

在 C#（或任何 .NET 语言）中，您将获得一个[`StackOverflowException`](http://msdn.microsoft.com/en-us/library/system.stackoverflowexception.aspx).NET 2.0 起无法捕获的 .

在 Java（或任何 JVM 语言）中，您将获得一个[`StackOverflowError`](http://java.sun.com/javase/6/docs/api/java/lang/StackOverflowError.html)（如此[处指定](http://java.sun.com/docs/books/jvms/second_edition/html/Overview.doc.html#6654)）。

我会把它留给其他答案来处理其他语言和平台:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T15:55:13.040

典型的 Unix 结果将是分段错误。不知道Windows。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T15:59:17.947

是的，你的程序会崩溃。操作系统没有办法“处理这种情况”，除了防止您的错误代码损坏其他进程（它已经在这样做）。操作系统无法知道你*真正*想要你的程序做什么，而不是你告诉它做什么。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-25T16:07:25.337

有很多答案会发生什么，但我想提一个非常简单的解决方案：

只需通过图灵机并让您的代码在其上运行。它将有足够的空间。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-03-25T15:51:37.793

程序会崩溃。通常堆栈受到操作系统的限制，以便在它们消耗所有可用内存之前捕获这样的错误。在 Linux 上，至少堆栈大小可以由用户通过`limit`在 shell 中发出命令来更改。

# windows - Windows PC 作为 USB 从设备来模拟拇指驱动器

> ID：682193
> 
> 赞同：6
> 
> 时间：2009-03-25T15:50:30.993
> 
> 标签：windows, usb, emulation

我需要创建一个允许 Windows PC (XP/Vista) 模拟拇指驱动器的应用程序。也就是说，当 PC 插入另一个 Windows 系统时，或者在这种情况下，一个允许插入 USB 拇指驱动器的硬件，计算机上的一个文件夹看起来像一个巨大的拇指驱动器。关于一个人会从哪里开始调查这个的任何想法？

**更新（更具体的描述）：** *我需要将我的 PC 连接到支持扫描到插入设备正面的 USB 拇指驱动器的较新的多功能设备之一。这些设备不支持通过通常用于连接 PC 的背面 USB 连接器的 WIA 或 TWAIN。*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T15:57:20.337

普通 PC 中的大多数 USB 控制器都无法用作 USB 从设备。所以我会从调查你将使用什么样的硬件开始。

另一种方法：有 USB Link 电缆可以通过 USB 连接 2 台电脑，也许这对你有用？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T08:35:33.483

您不能在应用程序中执行此操作。在最低级别，计算机上的 USB 端口由主机控制器接口控制。该芯片将管理多达 127 个从 USB 设备。在实现 USB 协议的从属端之前，您需要认真重新编程该芯片。当然，此时您 PC 中的任何 USB 集线器都会出现故障 - 您可能拥有的这 8 个 USB 端口通常由连接到 USB1 和 USB2 主机控制器的 2 个智能 USB 集线器实现。接下来，您的 USB 键盘和鼠标将停止工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-09-23T21:02:19.367

取一个带有两个从 USB 的 MCU。编写一个简单的固件，使一个 USB 充当特殊设备类，并等待此 USB 上的 PC 为另一个 USB 提供强制性数据（当然包括设备类）。编写一个连接到特殊设备（您的 MCU）、上传大容量存储设备类并将 I/O 重定向到专用分区的 PC 程序。MCU 上的另一个 USB 将成为模拟的大容量存储设备。

其中一些代码可以取自 Linux。

# xml - 帕斯卡 - 回复：用途

> ID：682195
> 
> 赞同：0
> 
> 时间：2009-03-25T15:50:38.543
> 
> 标签：xml, parsing, pascal

我有以下程序，它几乎可以工作，但是当我尝试编译时会产生以下错误，我不知道如何修复它！有任何想法吗？

表格，'mainform.pas'中的mainform ...

"unit1.pas(9): , or ; 预期但发现'IN'; "project1 无法编译 unit1.pas

```
 unit Unit1;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls,
  Dialogs, LibXmlParser, LibXmlComps, StdCtrls,
  Forms,
  mainform in 'mainform.pas'
  mapimail in 'mapimail.pas';

type
  TXMLRule = Record
    alert, desc, act:string;
  end;

  TForm1 = class(TForm)
    Button1: TButton;
    EasyXmlScanner1: TEasyXmlScanner;
    procedure Button1Click(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Form1: TForm1;
  Parser : TXmlParser;
  MyXMLRules:Array[1..10] of TXMLRule;
  i         :1..10;

implementation
{$R *.dfm}

procedure ProcessXML();

begin
  Parser := TXmlParser.Create;
  Parser.Normalize := TRUE;
  Parser.LoadFromFile ('c:\parser.xml');
  Parser.StartScan;

  while Parser.Scan do
    case Parser.CurPartType of
     ptStartTag,
     ptEmptyTag :
      begin

      end;

    ptContent  :
      begin
        if Parser.CurName = ('<alert>') then MyXMLRules[1].alert := Parser.CurContent;
        if Parser.CurName = ('<desc>') then MyXMLRules[1].desc := Parser.CurContent;
        if Parser.CurName = ('<action>') then MyXMLRules[1].act := Parser.Curcontent;
      end;
    end;
  Parser.Free;
end;

procedure EmailAlert();
begin
  Application.Initialize;
  Application.CreateForm(TForm1, Form1);
  Application.Run;
end;

procedure NoiseAlert();
begin
end;

procedure TForm1.Button1Click(Sender: TObject);
var
f:textFile;
data:string;
begin
   ProcessXML();

    AssignFile(f, 'c:\nmap.txt');
    reset(f);
    repeat
      readln(f, data);
      if (pos(MyXMLRules[1].alert, data)) <> 0 then

        begin
           if MyXMLRules[1].act
           = ('Email') then
                      begin
                        EmailAlert
                      end;
           if MyXMLRules[1].act
           = ('Beep') then
                      begin
                        NoiseAlert
                      end;
        end;
      until EOF(f);
end;

end. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T15:54:11.123

您在第 9 行（带有“mainform in 'mainform.pas'”的行）末尾缺少逗号。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T15:55:49.827

根据[Delphi Basics](http://www.delphibasics.co.uk/RTL.asp?Name=Uses)，“in”仅适用于程序和库，而不适用于单元。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T16:30:48.460

您正在混合单元代码和项目代码。

在 Delphi（和 freepascal）中，项目文件 (.dpr) 允许您通过指定 OS 文件来包含自定义源文件，通常是您的单位。这用于通知编译器不要查找预编译单元。

```
project MyApp;

uses
  forms,
  unit1 in 'unit1.pas'; 
```

正如您提供的那样，作为一个单位，您不能这样做。

删除 IN 和带引号的字符串，只要清除代码中的其余错误，就可以了。

# apache-flex - 使用 subversion 分支 Flex 项目的最佳方式

> ID：682197
> 
> 赞同：1
> 
> 时间：2009-03-25T15:50:43.363
> 
> 标签：apache-flex, actionscript-3, eclipse, svn

这是我们的问题，我们是使用 .NET 作为服务器端逻辑的 Flex 商店。我们在 Flex Builder 中将 subversion 用于源代码控制和 subeclipse，但对于使用源代码控制还是很陌生，更不用说 subversion。分支和合并似乎在 .NET 端运行得很好，但我们在 Flex 端遇到了问题，因为最终的 swf 是在我们的本地计算机上构建的。

问题是，使用 Flex 和 SVN 的通常工作流程是什么样的？特别是，你如何分支以及在哪里构建？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T17:08:23.677

就个人而言，我将 Flash/Flex 源代码保存在一个单独的 SVN 存储库中，该存储库与部署到任何类型的 Web 服务器的内容不同。这样我就可以专门为我的 Flash/Flex 应用程序创建分支和标签。我还倾向于将任何 SWF 直接发布到我的本地部署存储库副本中。将已发布的 SWF 置于版本控制之下对我来说没有意义，除非它是部署到服务器的一部分。我不喜欢一直将 SWF 提交到我的 Flash 源代码存储库中，因为它占用了不必要的空间，并且所有源代码都应该代表最新版本，而不是生成的 SWF。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T20:26:08.507

您可能希望将您的项目与您的 .Net 项目一起分支，以便您的 flex 版本与您的服务器逻辑一致。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-29T01:18:27.797

我们使用这样的目录结构

```
+server-side-app
--trunk
--tags
--branches

+flex-client-app
--trunk
--tags
--branches 
```

我会为自己推荐类似的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T20:30:02.817

我同意马特 W 的观点。在 AKQA，我们有四个我们的资源和资产的 svn 位置。我们为项目的 bin 文件夹设置了 svn ignore。这样我们就不会检查任何 swfs，这意味着当我们更新时，我们不会得到其他人的 swfs 或输出文件。

一个不错的选择是研究与巡航控制之类的持续集成。我们在服务器上构建输出，将所有文件生成到服务器上的一个位置。持续集成还有很多其他好处，值得拥有

# latex - LaTeX、波浪线和逐字模式

> ID：682201
> 
> 赞同：6
> 
> 时间：2009-03-25T15:51:10.570
> 
> 标签：latex

继[这个问题](https://stackoverflow.com/questions/256457/how-does-one-insert-a-backslash-or-a-tilde-into-latex/256620)之后，当我处于逐字模式时，我完全无法让 LaTeX 给我一个波浪号。它必须是波浪号，因为它是函数的类型！

```
sig symm : (Board, [(Int, Int)]) ~> Bool 
```

当然，显示波浪号的标准方法是逐字打印的。

有什么建议么？

*澄清的编辑*：在逐字模式下键入 ~ 会在空格上方显示重音。我在这句话的开头出现一个波浪号。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T17:50:51.127

如果您的输入中没有出现某些字符，您可以使用 fancyvrb 及其 commandchars 选项在逐字文本中插入 TeX 命令：

```
\documentclass{article}
\usepackage{fancyvrb}
\begin{document}
\newcommand{\mytilde}{$\sim$}
\begin{Verbatim}[commandchars=\\\{\}]
sig symm : (Board, [(Int, Int)]) \mytilde> Bool
\end{Verbatim}
\end{document} 
```

[有关更多信息，请参阅fancyvrb](http://www.tex.ac.uk/tex-archive/macros/latex/contrib/fancyvrb/)的文档。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T16:03:02.663

也许您应该看一下：[LaTeX 包，用于对各种语言的代码进行语法高亮显示，](https://stackoverflow.com/questions/300521/latex-package-to-do-syntax-highlighting-of-code-in-various-languages)其中有排版代码的建议......

* * *

我认为这[`listing`](http://www.ctan.org/tex-archive/macros/latex/contrib/listings/)会为你做这件事，但如果做不到这一点，[`alltt`](http://tug.ctan.org/cgi-bin/ctanPackageInformation.py?id=alltt)并且[`fancyvrb`](http://tug.ctan.org/cgi-bin/ctanPackageInformation.py?id=fancyvrb)是`verbatim`. 有关其他可能性，请参阅[CTAN 上的此搜索。](http://www.ctan.org/cgi-bin/search.py?metadataSearch=verbatim&metadataSearchSubmit=Search)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-11-20T16:24:17.550

如果您使用列表命令，则可以将波浪号设置为文字。喜欢这个。

```
\documentclass
\usepackage{listings}
\lstset{
    literate={~} {$\sim$}{1} % set tilde as a literal (no process)
}

\begin{document}

\begin{lstlisting}
~
\end{lstlisting}

\end{document}
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T16:45:13.497

```
\begin{verbatim}
~
\end{verbatim} 
```

# iphone - 由于 DNS 查找导致 NSURLConnection 延迟？

> ID：682207
> 
> 赞同：0
> 
> 时间：2009-03-25T15:51:53.643
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch

我想弄清楚为什么在使用基于 POST 的 NSMutableURLRequest 创建 NSURLConnection 对象时会听到三到四秒的声音。我所说的开销是在 NSURLConnection 被触发后，观察 Apache 访问日志，我看到请求在调用请求后进入的时间要长得多。在任何其他平台上，我都会在进一步解决之前解决解析 DNS 所需的延迟问题。在这种情况下，我也不应该排除 iPhone。有没有其他人注意到类似的行为？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T17:07:44.817

DNS 是您的瓶颈，这听起来似乎很合理。尝试按地址而不是名称发出请求 - 至少用于调试。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-10-13T15:02:13.750

DNS 是 iPhone 的已知瓶颈吗？我在 3G 连接上也注意到了这一点。您是否通过使用地址而不是主机名来解决问题？

# sql-server - 如何在 SQL Server 中正确地将自动填充的表与手动填充的表分开？

> ID：682208
> 
> 赞同：0
> 
> 时间：2009-03-25T15:51:59.460
> 
> 标签：sql-server, database, database-design, sql-server-2008

假设我在数据库中有以下 2 个表：

```
[Movies] (Scheme: Automatic)
----------------------------
MovieID
Name

[Comments] (Scheme: Manual)
----------------------------
CommentID
MovieID
Text 
```

“电影”表每 10 分钟由服务更新一次，“评论”表由数据库用户手动更新。

通常，您只需在具有级联更新和删除的两个表之间创建一个简单的外键关系，但在这种情况下，即使它引用的电影被删除，我也希望能够保留手动输入的数据（更新服务是不是那么可靠）。这应该只是从自动表到手动表的一对多关系中的问题。您将如何分离数据库的手动和自动填充部分？

我计划添加一个不保持引用完整性并且只级联更新而不是删除的外键。但是这样做有什么我应该注意的陷阱吗？我的意思是，除了我最终可能会得到一些实际上没有引用任何内容的手动数据。

**编辑/澄清：**

只是为了澄清。示例表是完全组成的。实际上，数据库将包含服务器、应用程序、应用说明、版本号等对象。服务器相关信息将自动填充，但一些应用程序详细信息将手动填写。它可能是特殊配置等信息。即使服务器记录被删除，该服务器上的应用笔记仍然很有价值，不应该被删除。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T15:57:38.307

我建议您使用由服务更新的导入表，然后从中填充电影表。然后，您可以将被删除的电影保留在电影表中。可能将它们标记为已删除或已过时，但您仍然可以将它们保留用于历史目的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T15:58:51.770

我认为您应该在这种情况下使用软删除。我认为您不想发表您不知道它们属于哪部电影的评论。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T16:08:23.087

同意; 一个示例路线是复制电影表并添加一个状态字段，该字段指示每条记录的当前状态（实时/检查/已删除）。然后自动导入应该进入一个临时表，将所有电影的状态设置为“检查”，然后使用临时表更新真实电影表，当在临时表中找到电影状态时将其设置为 live。完成后，将任何仍处于“检查”状态的电影设置为删除，因为在自动导入中找不到它们。在应用程序端，选择任何没有状态 = 已删除的电影。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T16:23:15.440

> “我计划添加一个不保持引用完整性的外键，只级联更新，而不是删除。”

Since you appear to be using surrogate keys, updates will not be relevant to foreign elements. Additionally, since you do not care about orphaning data, then why use the referential constraint at all? You use constraints to ensure that something exists, which you do not appear to require in this situation.

# unit-testing - 在哪里可以找到使用 ASP.NET Webforms 进行 TDD / UnitTesting 的初学者视频教程？

> ID：682213
> 
> 赞同：1
> 
> 时间：2009-03-25T15:53:14.077
> 
> 标签：unit-testing, tdd

我对改变处理应用程序以集成 TDD / UnitTesting 的方式非常感兴趣。但我还不想走 MVC 路线，并希望通过视频看到使用 TDD 的初学者指南。

你如何设置它，在VS2008等中使用它......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T15:55:54.320

[Dimecasts](http://www.dimecasts.net/Casts/ByTag/TDD)有一些关于这个主题的好视频。

我知道您提到您还不想走 MVC 道路，但我认为[Asp.Net MVC 店面系列](http://www.asp.net/learn/mvc-videos/)值得一看。店面系列更侧重于使用 TDD 和设计模式，然后是 MVC。如果您有兴趣开始使用 TDD，我强烈建议您看看。可以在[Tekpub](http://www.tekpub.com)找到一个很棒的附加视频系列。对于您获得的内容来说，它不是免费的，但非常便宜。

# design-patterns - 从 SQL 中的 LIKE 约束返回的列值之间的匹配

> ID：682221
> 
> 赞同：0
> 
> 时间：2009-03-25T15:55:18.080
> 
> 标签：design-patterns, constraints, matching, sql-like

我正在尝试匹配返回的列值，但值是作为模式匹配的结果返回的：

```
select app.employees.id, app.employees.name, app.employees.current_bp, 
app.designation.designation from app.employees, app.designation 
where app.employees.id like 'khsn?' = app.designation.desig_id like 'khsn?'; 
```

如您所见，我正在尝试检索一些列值，但 java derby 工具说：

> 错误 42884：未找到具有兼容参数的“FUNCTION”类型的名为“LIKE”的授权例程。

我该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T15:59:59.537

我认为你应该使用[JOIN](http://dev.mysql.com/doc/refman/5.0/en/join.html)。我不确定我是否理解您的目标是什么，但是您在那里编写的内容与我从未见过的 SQL 一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T16:06:04.857

正如 evilpenguin 提到的，您需要使用连接

```
 select app.employees.id, app.employees.name, app.employees.current_bp, 
app.designation.designation from app.employees, app.designation where 
app.employees.id like 'khsn?' = app.designation.desig_id like 'khsn?'; 
```

可能是（如果我理解正确的话）

```
SELECT EMP.id, EMP.name, EMP.current_bp,
       DES.designation
FROM   app.employees AS EMP
INNER JOIN app.designation AS DES
       ON SUBSTR(EMP.id,0,4) = DES.desig_id
WHERE app.employees.id like 'khsn?' 
```

请注意，这与文字“khsn？”匹配。细绳。

如果你想要一个通配符，它​​应该是 WHERE app.employees.id like 'khsn%'

这将匹配以“khsn”开头的任何内容

**编辑**

根据 OP 的评论添加了 SUBSTR

# c# - 如果启用了 Windows 更新，请从 .NET 检查

> ID：682227
> 
> 赞同：5
> 
> 时间：2009-03-25T15:56:01.667
> 
> 标签：c#, .net, windows, vb.net

如果启用了 Windows 更新，有什么方法可以从 .NET 检查？

我想在用户每次登录我的应用程序时提示他们他们的计算机可能存在风险，并为他们提供指向 Windows 更新网站（或控制面板中的 Windows 更新应用程序）的链接。

最好它应该在 XP、Vista 和 Windows 7 上运行。也许有一个注册表项，甚至更好的是 API？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-25T16:38:36.633

首先添加对WUApiLib的引用“C:\windows\system32\Wuapi.dll”

然后你可以使用这个代码片段。

```
WUApiLib.AutomaticUpdatesClass auc = new WUApiLib.AutomaticUpdatesClass();
bool active = auc.ServiceEnabled; 
```

MSDN：“ServiceEnabled 属性指示自动更新所需的所有组件是否都可用。”

Setting auc.Settings.NotificationLevel 包含有关当前模式的信息。[http://msdn.microsoft.com/en-us/library/aa385806(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa385806(VS.85).aspx)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-25T16:03:32.193

当然，这样做是您的选择，但每隔几分钟就会提示 WindowsUpdate 已关闭，这是迄今为止 XP 中最糟糕的可用性问题。

你不想激怒你的用户。你应该爱他们。绝对不要干涉他们的私人事务，比如检查 WU 是否关闭，因为老实说，这不关你的事。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-25T16:00:00.517

我相信您可以通过使用[Windows 更新代理 API 来做到这一点。](http://msdn.microsoft.com/en-us/library/aa387099(VS.85).aspx)

有关详细信息，请参阅[IAutomaticUpdates](http://msdn.microsoft.com/en-us/library/aa385821(VS.85).aspx)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-25T16:01:57.987

您可以检查以下注册表项。

```
HKEY_LOCAL_MACHINE
  SOFTWARE
   Microsoft
     Active Setup
       Installed Components
         {89820200-ECBD-11cf-8B85-00AA005B4340} 
```

如果其 IsInstalled 值为 1，则安装 Windows 更新。

这取自：

[http://windowsitpro.com/article/articleid/15266/how-can-i-detect-if-windows-update-is-installed-on-a-machine.html](http://windowsitpro.com/article/articleid/15266/how-can-i-detect-if-windows-update-is-installed-on-a-machine.html)

我真的很喜欢这个问题的[另一个答案](https://stackoverflow.com/questions/682227/check-from-net-if-windows-update-is-enabled/682255#682255)，但不幸的是，它仅在 XP SP3 上受支持，这可能不可行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T16:02:53.490

或者，您可以使用 PROCESS 对象检查 Windows 更新服务是否正在运行。

这些方面的东西：

```
Function CheckIfServiceIsRunning(ByVal serviceName As String) As Boolean
   Dim mySC As ServiceProcess.ServiceController
   mySC = New ServiceProcess.ServiceController(serviceName)
   If mySC.Status = ServiceProcess.ServiceControllerStatus.Stopped Then
      ' Service isn't running
      Return False
   ElseIf mySC.Status = ServiceProcess.ServiceControllerStatus.Running Then
      ' Service already running
      Return True
   End If
End Function 
```

如果没记错的话，适用的服务被命名为“Wuauserv”

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-11-14T17:41:37.470

Michael Piendl 的回答对我不起作用，但它为我提供了使其工作所需的信息：

```
WUApiLib.AutomaticUpdatesClass auc = new WUApiLib.AutomaticUpdatesClass();<br>
string notificationLevel = auc.Settings.NotificationLevel.ToString();<br><br> 
```

根据`notificationLevel`从“自动更新”对话框中选择的选项，字符串将等于不同的东西。

# php - MySQL 和 PHP 中的全文搜索不起作用

> ID：682237
> 
> 赞同：1
> 
> 时间：2009-03-25T15:57:33.847
> 
> 标签：php, mysql, full-text-search

我目前正在尝试使用 PHP 在我的 MySQL 表（文本类型）中执行 2 个字段的搜索。

```
SELECT  * FROM content_items WHERE MATCH (content,name) AGAINST ('".urldecode($_REQUEST['term'])."' IN BOOLEAN MODE) 
```

无论我搜索什么，我总是得到零结果（甚至试图使查询静态，但它仍然不起作用）。我在两个字段上都有全文索引。

什么会导致这种情况？

谢谢，

罗伊

ps

搜索应该适合任何长度的刺（即使是短刺）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-26T03:34:44.950

sql语句是有道理的。我认为问题出在这里：

```
urldecode($_REQUEST['term']) 
```

PHP手册中有一个关于这个的注释

> 警告
> 
> 超全局变量 $_GET 和 $_REQUEST 已经解码。在 $_GET 或 $_REQUEST 中的元素上使用 urldecode() 可能会产生意想不到的危险结果。

干杯，

标记

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-26T23:25:18.180

（假设您的查询没有引发错误）

您可能需要检查与全文搜索相关的 mysql 配置。例如，默认情况下，4 个字符以下的术语不会匹配任何内容

```
mysql> show variables like 'ft_%';
+--------------------------+----------------+
| Variable_name            | Value          |
+--------------------------+----------------+
| ft_boolean_syntax        | + -><()~*:""&| |
| ft_max_word_len          | 84             |
| ft_min_word_len          | 4              |
| ft_query_expansion_limit | 20             |
| ft_stopword_file         | (built-in)     |
+--------------------------+----------------+
5 rows in set (0.00 sec) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-29T09:06:08.470

这是索引的问题。重建它们解决了这个问题。

# c# - IKVM 和 System.Core System.Runtime.CompilerServices.ExtensionAttribute

> ID：682244
> 
> 赞同：2
> 
> 时间：2009-03-25T15:58:49.850
> 
> 标签：c#, .net, extension-methods, ikvm, build-error

我正在使用最新版本的 IKVM 将 Java .jar 文件“编译”成 .NET DLL。一切正常，现在我尝试在 .NET 3.5 C# 项目中引用 DLL。

在我的 C# 项目中，我创建了一个静态“StringExtensions”类，该类在字符串上具有扩展方法。

出于某种原因，这似乎在昨天有效，但今天，我的扩展类出现构建错误（不确定昨天是如何工作的......）。

```
Missing compiler required member System.Runtime.CompilerServices.ExtensionAttribute..ctor 
```

还有一个构建警告：

```
The predefined type 'System.Runtime.CompilerServices.ExtensionAttribute' is defined in multiple assemblies in the global alias; using definition from 'c:\TEMP\IKVM.Runtime.dll' 
```

我发现 IKVM.Runtime.dll 和 System.Core.dll（3.5 版本）都具有相同的类型：“System.Runtime.CompilerServices.ExtensionAttribute”

由于命名空间是相同的，我怎样才能让它与 ExtensionAttribute 的 System.Core 版本一起编译（或者我该如何解决这个问题）？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T11:17:25.823

更新到 IKVM 0.40.0.1 为我解决了这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T19:17:40.910

如果您以 .Net 2.0 为目标，则只能在您自己定义此属性的情况下创建扩展方法。在您迁移到 .Net 3.5 之前，这非常有效。

我不知道“IKVM”，但唯一真正的解决方法是要求他们删除属性和目标 3.5。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-05T06:14:04.077

我也有同样的问题。

在我的情况下，问题是程序集 Mono.Cecil。

从本地引用迁移到 nuget，当我添加 NHibernate 引用时，包会自动添加此引用。

此引用已被删除，并再次编译了我的项目。

您需要了解此实现才能解决您的问题。必须删除两个组件之一。

这张图片取自 ILSpy ( [http://i.stack.imgur.com/Qyd5o.png](http://i.stack.imgur.com/Qyd5o.png) )

# facebook - 脸书连接

> ID：682246
> 
> 赞同：2
> 
> 时间：2009-03-25T15:59:04.577
> 
> 标签：facebook

我已按照 [本教程](https://stackoverflow.com/questions/323019/facebook-connect-and-asp-net)进行操作。如果他登录了 Facebook，我不希望他自动登录，只有当他登录到我的网站时。如果cookie/会话设置在facebooks自己的站点或我自己的站点，有没有办法区分它？现在它会返回一个用户，如果他刚刚登录 Facebook，即使他从未登录过我的网站？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T09:20:58.060

这不是应该发生的事情。

如果 facebook 用户访问您的站点，则在单击连接按钮之前不应登录。

一旦他们“连接”，您可以在页面重新加载时自动登录，但之前不能。

否则，任何网站都可以添加 facebook 连接脚本并在用户不知情的情况下秘密连接到用户的 facebook 帐户。

# asp.net - 在数据库连接方面需要帮助

> ID：682247
> 
> 赞同：0
> 
> 时间：2009-03-25T15:59:12.843
> 
> 标签：asp.net, connection-string

我面临数据库连接问题。据我所知，如果我们创建新用户，使用 Create UserWizard 控件并在运行它之后如果我们从解决方案资源管理器中刷新刷新按钮，aspnetdb.mdf 将在 app 目录下自动生成。但在我的情况下它没有发生。我的意思是 aspnetdb.mdf没有生成。一旦我提交注册提交按钮，就会收到此错误消息“找不到存储过程'dbo.aspnet_CheckSchemaVersion'。”

这是我在 web.configfile 中的连接字符串。

```
<connectionStrings>
    <add name="BankingTransaction" connectionString="Data Source=.\SQLEXPRESS;AttachDbFilename=|DataDirectory|\Bank.mdf;integrated security=True;User Instance=True" providerName="System.Data.SqlClient"/>
</connectionStrings> 
```

请有人帮助我我的错误在哪里。

谢谢， 马苏姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T16:27:08.503

数据库需要在其上运行 regsql.exe 来添加会员 .net 使用的所有文件。

这解释了如何做到这一点

[http://msdn.microsoft.com/en-us/library/ms229862(VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms229862(VS.80).aspx)

这将安装 ASPNET 角色和成员资格所需的所有表和过程

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T16:13:49.080

听起来您正在调用的存储过程（`dbo.aspnet_CheckSchemaVersion`）在数据库中不存在。

以下是一些似乎遇到过同样问题的人：

> [http://forums.asp.net/t/940632.aspx](http://forums.asp.net/t/940632.aspx)
> [http://forums.asp.net/p/1042979/1456396.aspx#1456396](http://forums.asp.net/p/1042979/1456396.aspx#1456396) [http://social.msdn.microsoft.com/Forums/en-美国/adodotnetdataproviders/thread/7a85cf72-7f53-421f-be74-b12262c47f37/](http://social.msdn.microsoft.com/Forums/en-US/adodotnetdataproviders/thread/7a85cf72-7f53-421f-be74-b12262c47f37/)

可能值得尝试其中的一些解决方案。这听起来很有希望：

> 在您的 SQL SERVER 实例上运行以下命令：

```
Exec sp_addrolemember 'aspnet_Membership_FullAccess', 'YourUser'    
go

Exec sp_addrolemember 'aspnet_Personalization_FullAccess', 'YourUser'    
go    

Exec sp_addrolemember 'aspnet_Profile_FullAccess', 'YourUser'    
go    

Exec sp_addrolemember 'aspnet_Roles_FullAccess', 'YourUser'    
go    

Exec sp_addrolemember 'aspnet_WebEvent_FullAccess', 'YourUser'    
go 
```

# javascript - 如何通过 javascript 读取 swf 的大小

> ID：682251
> 
> 赞同：0
> 
> 时间：2009-03-25T15:59:30.800
> 
> 标签：javascript, flash

根据`swf`Adob​​e 的文档，您应该能够读取 swf 的各个字节来计算文件大小、文件尺寸（宽度和高度）、版本和文件类型（swf 或 swc）。

我正在使用 javascript 读取单个字节并将它们转换为人类可读的信息，但是在文件尺寸方面我遇到了问题。

我的第一个问题是有没有人有一个从缇（二十分之一像素）转换为像素的公式？似乎除以 20 会起作用，但我并不积极。

我的第二个问题是有没有人能够使用任何语言获得 swf 文件的文件尺寸？我正在使用 javascript，但我认为字节顺序在任何语言中都是相同的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-26T20:20:57.217

好的 - 出现了一些新信息。我得到文件尺寸值不可靠的原因是因为文件是“swc”（压缩）而不是“swf”（未压缩）。所以十六进制值不是真实值。

如果有人知道如何将 swc 解压缩为 swf - 这将很有帮助。

谢谢！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T16:02:30.760

如果你有缇，而且它们真的是二十分之一像素，那不就是：

```
pixels = twips * 20 
```

因此，您不是除以 20，而是乘以，因为 twip 是像素的一小部分。

```
1 twip = 1/20 pixel
20 twips = 1 pixel 
```

# php - 将 JSON 从 PHP 返回到 JavaScript？

> ID：682260
> 
> 赞同：148
> 
> 时间：2009-03-25T16:00:47.943
> 
> 标签：php, javascript, json

我有一个通过 jQuery AJAX 调用的 PHP 脚本。我希望 PHP 脚本以 JSON 格式将数据返回给 javascript。这是 PHP 脚本中的伪代码：

```
$json = "{";
foreach($result as $addr)
{
    foreach($addr as $line)
    {
        $json .= $line . "\n";
    }
    $json .= "\n\n";
}
$json .= "}"; 
```

基本上，我需要将两个 for 循环的结果插入到 $json 中。

* * *

## 回答 #1

> 赞同：205
> 
> 时间：2009-03-25T16:02:53.427

PHP 有一个内置的 JSON 序列化功能。

```
json_encode 
```

[json_encode](http://nz.php.net/json_encode)

**请**使用它，如果您可以并且不会遭受“此处未发明”综合症。

* * *

## 回答 #2

> 赞同：165
> 
> 时间：2015-07-01T15:13:50.703

以前的答案中缺少以下几点：

1.  在您的 PHP 中设置标题：

    ```
    header('Content-type: application/json');
    echo json_encode($array); 
    ```

2.  `json_encode()`可以返回一个 JavaScript**数组**而不是 JavaScript**对象**，请参阅：
    [从 PHP 脚本返回 JSON](https://stackoverflow.com/questions/4064444/returning-json-from-a-php-script/25062961#25062961)
    在某些情况下了解这一点可能很重要，因为数组和对象并不相同。

* * *

## 回答 #3

> 赞同：86
> 
> 时间：2009-03-25T16:03:32.833

PHP 的文档中有一个[JSON 部分](http://is.php.net/manual/en/book.json.php)。不过，您需要 PHP 5.2.0。

> 从 PHP 5.2.0 开始，JSON 扩展默认捆绑并编译到 PHP 中。

如果你不这样做，这里是你可以安装的[PECL 库。](http://pecl.php.net/package/json)

```
<?php
    $arr = array ('a'=>1,'b'=>2,'c'=>3,'d'=>4,'e'=>5);

    echo json_encode($arr); // {"a":1,"b":2,"c":3,"d":4,"e":5}
?> 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-03-25T16:07:49.953

通常你会对接收端的数据有一些结构感兴趣：

```
json_encode($result) 
```

这也将保留数组键。

请记住 json_encode 仅适用于 utf8 编码的数据。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-03-30T15:12:54.633

您可以使用[Simple JSON for PHP](https://github.com/AlexisTM/Simple-Json-PHP)。它发送标头帮助您伪造 JSON。

看起来像 ：

```
<?php
// Include the json class
include('includes/json.php');

// Then create the PHP-Json Object to suits your needs

// Set a variable ; var name = {}
$Json = new json('var', 'name'); 
// Fire a callback ; callback({});
$Json = new json('callback', 'name'); 
// Just send a raw JSON ; {}
$Json = new json();

// Build data
$object = new stdClass();
$object->test = 'OK';
$arraytest = array('1','2','3');
$jsonOnly = '{"Hello" : "darling"}';

// Add some content
$Json->add('width', '565px');
$Json->add('You are logged IN');
$Json->add('An_Object', $object);
$Json->add("An_Array",$arraytest);
$Json->add("A_Json",$jsonOnly);

// Finally, send the JSON.

$Json->send();
?> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-10-31T08:15:35.803

$msg="您输入了错误的用户名或密码"; $responso=json_encode($msg);

```
echo "{\"status\" : \"400\", \"responce\" : \"603\", \"message\" : \"You Enter Wrong Username OR Password\", \"feed\":".str_replace("<p>","",$responso). "}"; 
```

# c# - 自定义控件加载用户控件；不触发回发事件

> ID：682269
> 
> 赞同：1
> 
> 时间：2009-03-25T16:02:23.990
> 
> 标签：c#, asp.net, postback

我有一个加载用户控件的自定义控件（编译为 DLL）。（即自定义控件做了一个LoadControl） 在用户控件中是一个按钮和一个文本框。我连接了按钮的点击事件。

我在文本框中输入一个值。当我单击按钮时，页面会进行回发。我的用户控件知道发生了回发，因为 Page.IsPostBack = true。但是，按钮的单击事件从未被触发，并且我的文本框也丢失了我输入的值。

有人对可能发生的事情有任何想法吗？

编辑：我对此进行了测试，并将 SharePoint 排除在外；我能够重现它，因此我删除了对 SharePoint 的所有引用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T16:34:00.670

如果您正在动态加载用户控件，则必须在每次页面加载（回发或不回发）时重新加载它，以便.net 处理器知道在哪里连接提交事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T17:40:46.907

加载用户控件的一种方法是重写 CreateChildControl，调用 base.CreateChildControls，然后调用您的 LoadControl 方法。如果您需要将 UserControl 放置在特定位置，请在页面上放置一个 PlaceHolder 并将您的控件添加到占位符控件集合中。

您也可以直接将用户控件添加到标记中。

像这样注册控件：

```
<%@ Register Src="~/path/ControlName.ascx" TagName="tagName" TagPrefix="myPrefix" %> 
```

然后按如下方式添加：

```
<myPrefix:tagName ID="myId" runat="server"/> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T16:11:30.023

如果您正在数据绑定，则需要检查您是否只在 !Page.IsPostBack 上这样做，当您进行数据绑定时，您会从回发中清除任何“已保存”状态。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T16:33:00.593

听起来您没有在回发时重新创建控件。您需要在 Page_Init 期间添加控件才能加载视图状态。

# c# - 如何更新数据网格视图

> ID：682271
> 
> 赞同：0
> 
> 时间：2009-03-25T16:02:37.330
> 
> 标签：c#, winforms, datagridview

我在 c# 项目中工作，我需要在插入新记录后更新 datagridview 控件。当我这样做时，gridview 也会保留它的旧值，我应该怎么做才能只显示更新的记录

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T16:04:41.973

您需要显示您要绑定的数据源是什么。如果它没有任何更新功能（例如，实现 INotifyPropertyChanged），那么网格将无法判断值何时更改并自行更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T16:12:38.287

您还没有发布代码片段供我们分析，所以我最好的猜测是您忽略了在插入行后重新绑定 Data/Gridview。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T16:25:50.613

当绑定的数据源发生更改时，您需要调用[ResetBindings](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.resetbindings.aspx)，除非数据源实现了适当的通知以向网格提供更新通知。

# sharepoint - 某些 SharePoint 页面在 https 环境中用作 http

> ID：682274
> 
> 赞同：1
> 
> 时间：2009-03-25T16:03:00.277
> 
> 标签：sharepoint, ssl, sharepoint-2007, wss-3.0, isapi

我有一个使用 SSL 的 WSS 3.0 系统，其中每个页面都应该作为 https 服务。几乎所有页面都以 https 的形式出现，但在某些情况下，我单击一个链接会显示一个页面的 http 版本（不会加载）。在这些情况下，我必须手动输入“s”才能加载页面。发生这种情况的地方是：

*   /_layouts/newgrp.aspx ：当我尝试创建一个新组时，它会将我带到[http://server/_layouts/newgroup.aspx](http://server/_layouts/newgroup.aspx)，尽管它应该是 https。该页面未在 http 加载。如果我手动更改网址，它会加载。
*   /_layouts/edtgrp.aspx ：与 newgrp.aspx 相同
*   如果我进入文档库并查看文件的版本历史记录，则该文件各个版本的 URL 是 http。有趣的是，当我将鼠标悬停在浏览器状态栏上时，它们也会显示 http（因此 SharePoint 在生成链接时会感到困惑，而不是在我单击它们时）

为了解决这个问题，我尝试向 DOM 添加一些 javascript 来搜索 http 的实例并将它们替换为 https。这在某些情况下有效，但有些地方是 javascript 无法到达的，例如当 SharePoint 提供目标 URL 以响应 POST 请求时，我认为 newgrp/edtgrp.aspx 就是这种情况。

我还尝试添加 ISAPI 过滤器以将页面从 http 重定向到 https。这似乎会导致重定向循环，无论如何我都不确定这些过滤器是否会保留查询字符串或 POST 信息。

有没有人看到这个问题？

更新：我们已经从 Squid 切换到 ISA，问题在版本历史中仍然存在，但在新组或编辑组中没有。我们还没有看到更改 AAM 设置的任何改进。

ISA中发生这种情况的地方：

*   列表或文档库中的项目下的“版本历史记录”
*   列表或文档库中项目下的“管理权限”
*   列表或文档库中的项目下的“提醒我”
*   “人员和组”页面中的“添加用户”菜单项
*   “人员和组”页面中的“组设置”菜单项
*   “人员和组”页面中的“编辑组快速启动”菜单项
*   “人员和组”页面中的“设置组”菜单项
*   “人员和组”页面中的“列表设置”菜单项

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T16:32:59.580

不确定是不是这样，但您是否检查过您的备用访问映射以确保它们显示的是 https 而不是 http？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T18:45:32.283

我会回应检查您的备用访问映射的建议。SSL 是在 SharePoint 前端完成的，还是通过专用的 SSL 硬件完成的？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-02T12:34:24.487

使用**HTTP 模块**修改 SharePoint 的输出，以便始终将链接更改为`https`. 这样的模块可以插入 IIS 并修改任何呈现的 HTML。我已使用此技术使 SharePoint XHTML 兼容并且运行良好。

更好的是，几乎所有的工作都已经为你完成了。[UrlRewritingNet](http://www.urlrewriting.net/)模块是开源的，可以免费下载。它应该适用于您的 SharePoint 网站。这个工具有很好的文档，并使用正则表达式来匹配要更改的 URL。为您的情况编写一个应该很容易，例如`^http://`. 如有必要，您还可以利用许多更高级的选项。

如果您更愿意自己编写，那么在 15 Seconds 网站上有一篇名为[Rewrite.NET 的好文章——A URL Rewriting Engine for .NET 。](http://www.15seconds.com/Issue/030522.htm)

最后，如果您使用的是 IIS 7，您可以尝试它的[URL Rewrite Module](http://www.iis.net/extensions/URLRewrite)。我自己从未使用过它，也不知道它是否适用于 SharePoint，但它是可用的最受 UI 驱动的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-02T08:27:00.077

在 IIS 中添加从 http 到 https 的重定向。每次您访问该页面时，它都会将您重定向到您的 https 页面。

我还建议将 WSS 放在另一台服务器上，看看您是否有同样的问题。如果你不这样做，你可能需要重建/迁移你的东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-02T20:46:27.647

亚历克斯用我认为通常可行的方法回答了这个问题。这是我专门解决这个问题的方法。

看起来当加载 SharePoint aspx 页面时，它会填充类型为 ContextInfo（在 init.js 中定义）的 javascript 结构，该结构在变量 ctx 中实例化。该结构有一个名为 httpRoot 的成员，后来在 core.js 中用于在各种下拉菜单中构建菜单项。

出于某种原因，此 ctx.httpRoot 在 SharePoint 创建的 aspx 文件中的 javascript 中填充，如下所示：

```
    ctx.HttpRoot = "http:\u002f\u002fsubdomain.domain.com";

```

是的，它有 Unicode 斜线，它有 http 而不是 https。我不知道为什么。但是，修复这行 javascript 似乎可以解决问题。

我通过在 ISA 中添加将 http:\u002f\u002f\ 转换为 https:\u002f\u002f\ 的 URL 转换规则来更改该行。我怀疑进行相同替换的 HTTP 模块也可以工作。或者可能是一些放置良好的 javascript 在某个时候重新分配变量。

我仍然认为这并不理想，必须有更合适的方法来修复这些链接。

# asp.net-mvc - Flash FileReference 上传到 ASP.NET MVC

> ID：682278
> 
> 赞同：1
> 
> 时间：2009-03-25T16:03:09.667
> 
> 标签：asp.net-mvc, flash, flex3, upload

我在我的 ASP.NET MVC 应用程序中使用 Flash/Flex 上传组件。我的动作有一个`HttpPostedFileBase`参数。我的动作被调用，但 my`HttpPostedFileBase`被传入为`null`. 任何想法为什么它会回来`null`？

**编辑**——我相信这是在 MVC 方面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T16:07:49.750

获取您正在使用[的 Flash Player 的调试器版本，](http://www.adobe.com/support/flashplayer/downloads.html)并查看 swf 引发的错误。如果您无权访问组件的代码，我不确定是否有任何其他方法可以弄清楚会发生什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T18:12:08.937

嗯。我的表单域没有设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-11-11T19:26:19.080

如果您只是想将 FileReference 与 Asp.Net MVC Action 集成，您应该像这样设置操作参数名称 HttpPostedFileBase **Filedata**：

```
public ActionResult UploadFile(HttpPostedFileBase Filedata)
{
   ...
   ViewData["success"] = "Upload Completed!"
   return View();
} 
```

希望能帮助到你！

# java - Java 继承 - 添加的方法

> ID：682280
> 
> 赞同：0
> 
> 时间：2009-03-25T16:03:31.337
> 
> 标签：java, inheritance, methods

我想要一个基类 ，`BaseConnect`其中包含一个`OutputStream`和子类`ObjectStreamConnect`和`DataStreamConnect`。在我的`BaseConnect`班级中，我有`OutputStream os;` 并且在我的两个孩子班级中，我有分别执行“ `os = ObjectOutputStream(...)`”或“ `os = DataOutputStream(...)`”的构造函数。

由于`ObjectOutputStream`s 有一个`writeObject(Object o)`方法而`DataOutputStreams`没有，似乎我不能让我的`ObjectStreamConnect`类做一个“ `os.writeObject(object)`”，因为父类`OutputStream`没有`writeObject(Object o)`.

我确定这是代码异味，我想知道如何处理它。

我的想法：

我想制作包含`os.writeObject`抽象的方法，以便`ObjectStreamConnect`可以以不同的方式实现它，但后来我意识到这`DataStreamConnect`也必须实现它，它不需要。

我也不想仅仅摆脱父类并让两个类分别实现所有内容，因为它们确实有很多具有相同实现的相同方法。

请帮忙。出于某种原因，这个问题的答案并没有出现在我身上。

吉布

编辑：我不能粘贴整个代码，但它是这样的：

```
public class BaseConnect {
  OutputStream os;
   ...
}

public class ObjectStreamConnect extends BaseConnect {
  public ObjectStreamConnect () {
    ...
    os = new ObjectOutputStream(socket.getOutputStream);
  }

  public void writeObject(Object o) {
    os.writeObject(o);
  }
}

public class DataStreamConnect extends BaseConnect {
  public DataStreamConnect () {
    ...
    os = new DataOutputStream(socket.getOutputStream);
  }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T16:14:40.950

您似乎在说的是“我的两个对象使用了一些共享方法，并且我通过继承超类来共享它们”。

然后你会卡住，因为继承实际上说“这*是*其中之一，这个 API 也是如此”，而实际上不是 - 正如你难以实现的方法所暗示的那样。

如果您将共享方法放在某种帮助程序类中，并同时`DataStreamConnect`提供`OutputStreamConnect`帮助程序的实例，您可以共享支持代码而无需共享相同的 API。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T16:18:37.260

如果您使用的是 java 1.5 或更高版本，您可以使用泛型类：

```
public class Base<T extends OutputStream>{
    T os;
...
}

public class OutputStreamConnect extends Base<ObjectOutputStream>

    public OutputStreamConnet(){
        os = new ObjectOutputStream();
    }

    public void doWrite(Object o){
        os.writeObject(o);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T16:19:27.617

您应该使用接口来声明两个类的共享重要方法。你不应该关心基类中未来的子实现——这违反了面向对象的法则！或者您只是想要一个基类，这样您就不必编写重复的代码？正如 DanVinton 建议的那样，使用接口和辅助类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T16:07:03.217

你能在 OutputStream 上只有一个抽象方法吗

`write(Object o)`

（我猜你可以“写”到两个子类）并且两个子类都以自己的方式实现它？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T17:19:27.130

如果我正确理解了这个问题，您应该将**BaseConnect**类声明为抽象类，并将常见行为封装在其中。有问题的方法**writeObject**也应该被声明为抽象的，你应该把它留给子类中的具体实现，它如何管理所需的目标。

然后在**ObjectStreamConnect中，您可以使用****instanceof**运算符测试流的类型，然后将对象转换为**ObjectOutputStream**，然后您可以毫无问题地使用**os.writeObject(o)**。

在**DataStreamConnect**中，您必须以另一种方式实现此方法。

我的意思是这样的：

```
public abstract class BaseConnect {
  protected OutputStream os;
   ...
  public abstract void writeObject(Object o);

  // common behavior implemented in this class
}

public class ObjectStreamConnect extends BaseConnect {
  public ObjectStreamConnect () {
    ...
    os = new ObjectOutputStream(socket.getOutputStream);
  }

  public void writeObject(Object o) {
    if (os instanceof ObjectOutputStream) {
      ((ObjectOutputStream) os).writeObject(o);
    } else {
      // throw some exception here or something, because this should not happen
    }
  }
}

public class DataStreamConnect extends BaseConnect {
  public DataStreamConnect () {
    ...
    os = new DataOutputStream(socket.getOutputStream);
  }

  public void writeObject(Object o) {
    // implement writing of the object in another way here
  }
} 
```

也许您还应该将 BaseConnect 重命名为 AbstractConnect，但这取决于您的代码约定。

# javascript - Why is my RegExp construction not accepted by JavaScript?

> ID：682288
> 
> 赞同：1
> 
> 时间：2009-03-25T16:05:00.070
> 
> 标签：javascript, regex

I'm using a RegExp to validate some user input on an ASP.NET web page. It's meant to enforce the construction of a password (i.e. between 8 and 20 long, at least one upper case character, at least one lower case character, at least one number, at least one of the characters #@!$% and no use of letters L or O (upper or lower) or numbers 0 and 1\. This RegExp works fine in my tester (Expresso) and in my C# code.

This is how it looks:

```
(?-i)^(?=.{8,20})(?=.*[2-9])(?=.*[a-hj-km-np-z])(?=.*[A-HJ-KM-NP-Z])
(?=.*[#@!$%])[2-9a-hj-km-np-zA-HJ-KM-NP-Z#@!$%]*$ 
```

(Line break added for formatting)

However, when I run the code it lives in in IE6 or IE7 (haven't tried other browsers as this is an internal app and we're a Microsoft shop), I get a runtime error saying 'Syntax error in regular expression'. That's it - no further information in the error message aside from the line number.

What is it about this that JavaScript doesn't like?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T16:19:02.080

Well, there are two ways of defining a Regex in Javascript:

a. Through a Regexp object constructor:

```
var re = new RegExp("pattern","flags");
re.test(myTestString); 
```

b. Using a string literal:

```
var re = /pattern/flags; 
```

You should also note that JS does not support some of the tenets of Regular Expressions. For a non-comprehensive list of features unsupported in JS, check out the [regular-expressions.info](http://www.regular-expressions.info/javascript.html) site.

Specifically speaking, you appear to be setting some flags on the expression (for example, the case insensitive flag). I would suggest that you use the `/i` flag (as indicated by the syntax above) instead of using `(?-i)`

That would make your Regex as follows (Positive Lookahead appears to be supported):

```
/^(?=.{8,20})(?=.*[2-9])(?=.*[a-hj-km-np-z])(?=.*[A-HJ-KM-NP-Z])(?=.*[#@!$%])[2-9a-hj-km-np-zA-HJ-KM-NP-Z#@!$%]*$/i; 
```

For a very good article on the subject, check out [Regular Expressions in JavaScript](http://www.evolt.org/article/Regular_Expressions_in_JavaScript/17/36435/).

**Edit** (after Howard's comment)

* * *

If you are simply assigning this Regex pattern to a RegularExpressionValidator control, then you will not have the ability to set Regex options (such as ignore case). Also, you will not be able to use the Regex literal syntax supported by Javascript. Therefore, the only option that remains is to make your pattern intrinsically case insensitive. For example, `[a-h]` would have to be written as `[A-Ha-h]`. This would make your Regex quite long-winded, I'm sorry to say.

[Here is a solution](http://reflectedthought.com//thecoder/archive/2007/11/25/regularexpressionvalidator_ignore_case.aspx) to this problem, though I cannot vouch for it's legitimacy. Some other options that come to mind may be to turn of Client side validation altogether and validate exclusively on the Server. This will give you access to the full Regex flavour implemented by the `System.Text.RegularExpressions.Regex` object. Alternatively, use a CustomValidator and create your own JS function which applies the Regex match using the patterns that I (and others) have suggested.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T16:44:06.200

I'm not familiar with C#'s regular expression syntax, but is this (at the start)

```
(?-i) 
```

meant to turn the case insensitivity pattern modifier on? If so, that's your problem. Javascript doesn't support specifying the pattern modifiers in the expression. There's two ways to do this in javascript

```
var re = /pattern/i
var re = new RegExp('pattern','i'); 
```

Give one of those a try, and your expression should be happy.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T16:50:04.470

As Cerberus mentions, (?-i) is not supported in JavaScript regexps. So, you need to get rid of that and use /i. Something to keep in mind is that there is no standard for regular expression syntax; it is different in each language, so testing in something that uses the .NET regular expression engine is not a valid test of how it will work in JavaScript. Instead, try and look for a reference on JavaScript regular expressions, such as [this one](https://developer.mozilla.org/en/Core_JavaScript_1.5_Guide/Regular_Expressions).

Your match that looks for 8-20 characters is also invalid. This will ensure that there are at least 8 characters, but it does not limit the string to 20, since the character class with the kleene-closure (* operator) at the end can match as many characters as provided. What you want instead is to replace the * at the end with the {8,20}, and eliminate it from the beginning.

```
var re = /^(?=.*[2-9])(?=.*[a-hj-km-np-z])(?=.*[A-HJ-KM-NP-Z])(?=.*[#@!$%])[2-9a-hj-km-np-zA-HJ-KM-NP-Z#@!$%]{8,20}$/i; 
```

On the other hand, I'm not really sure why you would want to restrict the length of passwords, unless there's a hard database limit (which there shouldn't be, since you shouldn't be storing passwords in plain text in the database, but instead hashing them down to something fixed size using a secure hash algorithm with a salt). And as mentioned, I don't see a reason to be so restrictive on the set of characters you allow. I'd recommend something more like this:

```
var re = /^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])(?=.*[#@!$%])[a-zA-Z0-9#@!$%]{8,}$/i; 
```

Also, why would you forbid 1, 0, L and O from your passwords (and it looks like you're trying to forbid I as well, which you forgot to mention)? This will make it very hard for people to construct good passwords, and since you never see a password as you type it, there's no reason to worry about letters which look confusingly similar. If you want to have a more permissive regexp:

```
var re = /^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])(?=.*[#@!$%]).{8,}$/i; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T16:09:34.037

Are you enclosing the regexp in / / characters?

```
var regexp = /[]/;
return regexp.test(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T16:57:03.500

> (?-i)

Doesn't exist in [JS Regexp](http://docs.sun.com/source/816-6408-10/regexp.htm). Flags can be specified as “new RegExp('pattern', 'i')”, or literal syntax “/pattern/i”.

> (?=

Exists in [modern](https://developer.mozilla.org/En/Core_JavaScript_1.5_Reference:Global_Objects:RegExp) [implementations](http://msdn.microsoft.com/en-us/library/1400241x(VS.85).aspx) of JS Regexp, but is dangerously [buggy](http://regexadvice.com/blogs/mash/archive/2009/02/21/Looking-again-at-the-Lookahead-bug.aspx) in IE. **Lookahead assertions should be avoided in JS** for this reason.

> between 8 and 20 long, at least one upper case character, at least one lower case character, at least one number, at least one of the characters #@!$% and no use of letters L or O (upper or lower) or numbers 0 and 1.

Do you *have* to do this in RegExp, and do you *have* to put all the conditions in one RegExp? Because those are easy conditions to match using multiple RegExps, or even simple string matching:

```
if (
    s.length<8 || s.length>20 ||
    s==s.toLowerCase() || s==s.toUpperCase() ||
    s.indexOf('0')!=-1 || s.indexOf('1')!=-1 ||
    s.toLowerCase().indexOf('l')!=-1 || s.toLowerCase().indexOf('o')!=-1 ||
    (s.indexOf('#')==-1 && s.indexOf('@')==-1 && s.indexOf('!')==-1 && s.indexOf('%')==-1 && s.indexOf('%')==-1)
)
    alert('Bad password!'); 
```

(These are really cruel and unhelpful password rules if meant for end-users BTW!)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T17:00:13.337

I would use this regular expression:

```
/(?=[^2-9]*[2-9])(?=[^a-hj-km-np-z]*[a-hj-km-np-z])(?=[^A-HJ-KM-NP-Z]*[A-HJ-KM-NP-Z])(?=[^#@!$%]*[#@!$%])^[2-9a-hj-km-np-zA-HJ-KM-NP-Z#@!$%]{8,}$/ 
```

The `[^`*`a-z`*`]*[`*`a-z`*`]` will make sure that the match is made as early as possible instead of expanding the `.*` and doing backtracking.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-26T11:34:53.737

`(?-i)` is supposed to turn case-insensitivity ***off***. Everybody seems to be assuming you're trying to turn it *on*, but that would be `(?i)`. Anyway, you don't want it to be case-insensitive, since you need to ensure that there are both uppercase and lowercase letters. Since case-sensitive matching is the default, prefacing a regex with `(?-i)` is pointless even in those flavors (like .NET) that support inline modifiers.

# .net - 混淆 .NET Microsoft Office 插件的工具

> ID：682292
> 
> 赞同：2
> 
> 时间：2009-03-25T16:06:08.023
> 
> 标签：.net, ms-office, obfuscation, dotfuscator, smartassembly

我正在开发一个 .NET Microsoft Office 插件的团队。我们正在寻找混淆解决方案来帮助保护我们的许可程序。我们主要关注 Dotfuscator Professional 和 smartassembly 等工具。

我的第一个问题是，是否有人有使用带有 Office 加载项的 smartassembly 的经验？Dotfuscator 社区版不适用于这些，因此查看专业版，但在 smartassembly 的销售材料中没有提到这种皱纹。有这方面的经验吗？

我的第二个问题是是否有人通过 MSBuild 自动化了 smartassembly 的使用，也就是说，没有安装 Visual Studio 的好处。

我恭敬地想让响应者知道不要浪费他们的时间来评论混淆的相对优点。我了解有关该问题的最新线程。在过去的日子里，国王建造了城堡，但这些城堡有时会倒塌。我每天早上上班时仍然锁上前门。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T16:19:50.827

Dotfuscator 免费版不支持混淆 Office 应用程序，但专业版支持。我的雇主 (PreEmptive Solutions) 提供了 Dotfuscator 专业版的免费评估版，它没有功能限制，您当然可以对其进行测试以确保它适合您。

Dotfuscator 输出 100% 可验证的程序集，我们还没有遇到 Office 托管代码加载项的任何问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-29T12:46:14.743

如果您关闭公共成员/类型的重命名（库模式），您确定 Dotfuscator 不起作用吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-02-14T02:14:41.257

[Crypto Obfuscator](http://www.ssware.com/cryptoobfuscator/obfuscator-net.htm)支持混淆基于 .Net 的 Office 插件 - 它对此类 COM 互操作方案具有特殊支持。

它还支持 MSBuild 集成——你只需要在你的 .sln 上运行一个向导，从那时起，混淆将在构建后自动完成。

免责声明：我为 Crypto Obfuscator 的开发人员 LogicNP 工作。

# c++ - 我的环境变量中缺少什么以使我的链接器因 LNK1181 而失败？

> ID：682304
> 
> 赞同：0
> 
> 时间：2009-03-25T16:09:13.240
> 
> 标签：c++, qt, linker, nmake

我有一个 Qt 项目，我在开发时显示了一个调试控制台，我即将将产品运送到我删除了 qmake 控制台命令：CONFIG += console

但是，当我这样做时，我收到以下错误：

```
link /LIBPATH:"c:\Qt\4.5.0\lib" /NOLOGO /INCREMENTAL:NO /LTCG /MANIFEST /MANIFESTFILE:"./_obj/win32\Lynx.intermediate.manifest" /SUBSYSTEM:WINDOWS "/MANIFESTDEPENDENCY:type='win32' name='Microsoft.Windows.Common-Controls' version='6.0.0.0' publicKeyToken='6595b64144ccf1df' language='*' processorArchitecture='*'" /VERSION:4.00 /OUT:bin\win32\Lynx.exe @C:\DOCUME~1\hannentp\LOCALS~1\Temp\nm1C9.tmp 
link_.exe /LIBPATH:c:\Qt\4.5.0\lib /NOLOGO /INCREMENTAL:NO /LTCG /MANIFEST /MANIFESTFILE:./_obj/win32\Lynx.intermediate.manifest /SUBSYSTEM:WINDOWS /MANIFESTDEPENDENCY:type='win32' name='Microsoft.Windows.Common-Controls' version='6.0.0.0' publicKeyToken='6595b64144ccf1df' language='*' processorArchitecture='*' /VERSION:4.00 /OUT:bin\win32\Lynx.exe @C:\DOCUME~1\hannentp\LOCALS~1\Temp\nm1C9.tmp~
LINK_ : fatal error LNK1181: cannot open input file 'name='Microsoft.Windows.Common-Controls''
NMAKE : fatal error U1077: '"C:\Program Files\Microsoft Visual Studio 9.0\VC\Bin\link.EXE"' : return code '0x49d'
Stop. 
```

我认为缺少 lib 路径，但是我确实已经设置了大量环境变量并且已经在工作。有没有人看到这个并知道 Microsoft.Windows.Common-Controls 的位置？

我也是从 buildbot 运行这个的，所以 VS2008 的 IDE 并不是我真正需要帮助的地方。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-30T21:41:45.150

似乎命令行被低估了：

```
"/MANIFESTDEPENDENCY:type='win32' name='Microsoft.Windows.Common-Controls' version='6.0.0.0' publicKeyToken='6595b64144ccf1df' language='*' processorArchitecture='*'" 
```

在第二行，引号消失了，链接器将每个单词视为要链接的对象。您可能应该只添加引号（如果是您添加了此参数），即。`"\"`以（3 个字符代替一个引号）开头和结尾。似乎其他消息来源也表明了这一点，因此请尝试对此进行试验。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-31T00:54:59.233

不确定，如果你在这个问题上取得了任何进一步的进展。

我遇到了非常相似的错误，但使用的是 msvc2005（不是 IDE）。我没有任何 link_.exe 实例，因此无法验证您的修复。

当我启用控制台（CONFIG += 控制台）时，由于其他问题，它无法链接 - 找不到入口点：

```
Fatal Error LNK1561: Entry Point Must Be Defined 
```

我随机发现`http://support.microsoft.com/kb/140597` 其中谈到了尾随反斜杠字符，认为它是针对 msvc 4 的，后来修复了。我检查了我的代码，当在 .pro 文件中指定 LIBPATH 时，我有尾部正斜杠。我修复了这些，并得到了编译（CONFIG += 控制台）的东西。现在我删除了该选项，并且遇到了不同但有点合乎逻辑的问题：

```
MSVCRT.lib(crtexew.obj) : error LNK2001: unresolved external symbol _WinMain@16
app.exe : fatal error LNK1120: 1 unresolved externals 
```

查看您的 nmake 输出，我想知道是否混合了正斜杠和反斜杠字符

```
/MANIFESTFILE:"./_obj/win32\Lynx.intermediate.manifest" 
```

导致这个问题。虽然它可能会有所不同。

请注意，我`CONFIG -= embed_manifest_exe`的 .pro 文件中也有。我的 nmake 看起来像这样：

```
link /LIBPATH:"c:\Apps\boost\boost_1_38\lib" /NOLOGO /INCREMENTAL:NO /LTCG /SUBSYSTEM:WINDOWS "/MANIFESTDEPENDENCY:type='win32' name='Microsoft.Windows.Common-Controls' version='6.0.0.0' publicKeyToken='6595b64144ccf1df' language='*' processorArchitecture='*'" /OUT:valueForSba.exe @C:\DOCUME~1\LOCALS~1\Temp\nm398.tmp
Creating library app.lib and object app.exp
MSVCRT.lib(crtexew.obj) : error LNK2001: unresolved external symbol _WinMain@16
app.exe : fatal error LNK1120: 1 unresolved externals 
```

我也没有在这个项目中使用任何 qt 类，并且只使用 qmake 来获取 Makefile。（来自 4.5.1 商业版的 qmake）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T16:17:34.377

我的印象是 Qt 的免费版本只能用 Mingw 构建，而不是 Visual Studio。如果您使用的是 Qt 的免费版本，这可能是问题所在。如果您不熟悉 Mingw，它的 GCC 编译器工具链经过调整，可在 Windows 下使用，其 .lib 文件适用于各种 Windows 特定库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T16:22:38.187

根据我在 Microsoft 网站上找到的内容，Comctl32.dll 是您需要找到的库，并将其路径添加到构建环境中。看看这是否有效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T10:19:58.843

我一直在遭受同样的问题。原来这台电脑有两个不同的 MSVC 版本（7.1 和 8.0）。虽然 SDK 是为 8.0 构建的，但在 QtCreator Tools->Options->Qt4->Qt4 Versions 中为 7.1 选择了它。所以我将它切换到 8.0 版，现在它工作正常。

# .net - 进程类和 .NET 安全性？

> ID：682306
> 
> 赞同：0
> 
> 时间：2009-03-25T16:09:32.757
> 
> 标签：.net, security, .net-1.1, full-trust

我在我的应用程序中使用 Process 类，就在静态 Main 方法的开头。我正在使用 Process 类来了解我的应用程序的另一个实例当前是否正在运行。如果我的应用程序已经在运行，我将退出。我不是在寻找改变这一点的方法，这已经工作了多年

但是最近这在我们用户的某些计算机上不起作用，我收到错误“公共语言运行时调试服务：应用程序生成了无法处理的异常”。

我已经完全信任程序集，并且用户是系统的管理员。

任何想法都会有所帮助谢谢！

编辑：WMI 性能适配器服务在引发错误之前打开，在错误发生后关闭，我是否缺少某种权限？

这是在框架 1.1 上

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T16:15:40.370

虽然我无法推测您的进程崩溃的原因，但更好的解决方案是使用命名互斥锁：

```
static void Main()
{
  bool mutexWasCreated;
  using (Mutex mutex=new Mutex(true, AppID, out mutexWasCreated))
  {
    // check for single instance
    if (!mutexWasCreated)
      return;

    Application.Run(...);
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T16:13:27.130

您能否添加一个顶级 try catch（或使用 UnhandledException 处理程序）来查看抛出了什么类型的异常？这会有很大帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T16:17:14.423

我同意布兰。如果您不知道引发了什么异常，则很难进行故障排除。我会听[unhandledexception 事件](http://msdn.microsoft.com/en-us/library/system.appdomain.unhandledexception(VS.71).aspx)并将问题记录为解决此问题的第一步。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T17:31:54.307

我记得我正在处理的一些 .net 代码也有类似的问题。它是在一个 citrix 环境中。

用户必须是我相信的性能组的成员，才能运行 Process.GetProcessesByName()... 这真的不可取！

我认为我们有两个解决方法——第一个是在代码的开头，即从 VB 脚本运行代码，该脚本测试代码是否已经在运行。

第二个解决方法是设置窗口焦点的部分代码。在这里，我们只是在 try / catch 块中运行 AppActivate() - 我猜你可能能够做到 - 如果 AppActivate 失败，那么你需要运行应用程序。

希望这可以帮助！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T16:16:27.063

> 我正在使用 Process 类来了解我的应用程序的另一个实例当前是否正在运行。

.Net[`StartupNextInstance`](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.applicationservices.windowsformsapplicationbase.startupnextinstance(VS.80).aspx)为此提供了应用程序事件。

嗯……没关系。这看起来只能在 Visual Basic 中使用。我会在这里留下答案，以防它对其他人有用。

# sql - 选择不存在的元素

> ID：682308
> 
> 赞同：0
> 
> 时间：2009-03-25T16:10:01.600
> 
> 标签：sql, select

我正在开发一个必须为元素分配数字代码的应用程序。这些代码不是连续的，我的想法是在有相关元素之前不要将它们插入数据库中，但我想在 sql 问题中找到未分配的代码，我不知道该怎么做。

有任何想法吗？谢谢！！！

**编辑 1**

该表可以如此简单：

```
code | element 
-----------------
3    | three 
7    | seven 
2    | two 
```

我想要这样的东西：1、4、5、6。没有任何其他表。

**编辑 2**

感谢您的反馈，您的回答非常有帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-25T16:11:08.480

`NULL`如果未分配代码，这将返回：

```
SELECT  assigned_codes.code
FROM    codes 
LEFT JOIN
        assigned_codes
ON      assigned_codes.code = codes.code
WHERE   codes.code = @code 
```

这将返回所有未分配的代码：

```
SELECT  codes.code
FROM    codes 
LEFT JOIN
        assigned_codes
ON      assigned_codes.code = codes.code
WHERE   assigned_codes.code IS NULL 
```

没有纯粹`SQL`的方法可以完全按照您的意愿去做。

在`Oracle`中，您可以执行以下操作：

```
SELECT  lvl
FROM    (
        SELECT  level AS lvl
        FROM    dual
        CONNECT BY
                level <=
                (
                SELECT  MAX(code)
                FROM    elements
                )
        )
LEFT OUTER JOIN
        elements
ON      code = lvl
WHERE   code IS NULL 
```

在`PostgreSQL`中，您可以执行以下操作：

```
SELECT  lvl
FROM    generate_series(
        1,
        (
        SELECT  MAX(code)
        FROM    elements
        )) lvl
LEFT OUTER JOIN
        elements
ON      code = lvl
WHERE   code IS NULL 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-28T20:09:18.383

与使用纯 SQL 无法做到这一点的断言相反，这里有一个反例说明如何做到这一点。（请注意，我并没有说这很容易 - 但是，它是可能的。）假设表的名称`value_list`带有列`code`并且`value`如编辑中所示（为什么每个人都忘记在问题中包含表名？）：

```
SELECT b.bottom, t.top
    FROM (SELECT l1.code - 1 AS top
            FROM value_list l1
            WHERE NOT EXISTS (SELECT * FROM value_list l2
                                 WHERE l2.code = l1.code - 1)) AS t,    
         (SELECT l1.code + 1 AS bottom
            FROM value_list l1
            WHERE NOT EXISTS (SELECT * FROM value_list l2
                                 WHERE l2.code = l1.code + 1)) AS b
    WHERE b.bottom <= t.top
      AND NOT EXISTS (SELECT * FROM value_list l2
                         WHERE l2.code >= b.bottom AND l2.code <= t.top); 
```

from 子句中的两个并行查询生成的值分别位于表中值范围的间隙的顶部和底部。然后限制这两个列表的叉积，使得底部不大于顶部，并且在底部和顶部之间的原始列表中没有值。

在样本数据上，这会产生范围 4-6。当我添加一个额外的行（9，'9'）时，它还生成了 8-8 范围。显然，对于“无穷大”的合适定义，您还有另外两个可能的范围：

*   `-infinity`..`MIN(code)-1`
*   `MAX(code)+1`..`+infinity`

注意：

1.  如果您经常使用它，那么您的列表中通常不会有很多空白。
2.  仅当您从表中删除行时才会出现间隙（或者您在插入数据时忽略此查询或其亲属返回的范围）。
3.  重用标识符通常是一个坏主意，因此实际上这种努力可能是错误的。

但是，如果您想这样做，这是一种方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T16:51:35.167

这与 Quassnoi 发表的想法相同。我只是用 T-SQL 之类的代码将所有想法联系在一起。

```
DECLARE
    series @table(n int)

DECLARE
    max_n int,
    i int

SET i = 1
-- max value in elements table
SELECT
    max_n = (SELECT MAX(code) FROM elements)

-- fill @series table with numbers from 1 to n
WHILE i < max_n BEGIN
    INSERT INTO @series (n) VALUES (i)

    SET i = i + 1
END

-- unassigned codes -- these without pair in elements table
SELECT
    n
FROM
    @series AS series
    LEFT JOIN
        elements
    ON
        elements.code = series.n
WHERE
    elements.code IS NULL 
```

**编辑：** 当然，这不是理想的解决方案。如果您有很多元素或经常检查不存在的代码，这可能会导致性能问题。

# javascript - 意外地通过引用传递整数？

> ID：682315
> 
> 赞同：1
> 
> 时间：2009-03-25T16:13:17.257
> 
> 标签：javascript, jquery

我对此有一些问题。出于某种原因，`updateCurrentItem`无论如何总是使用相同的参数调用。

```
function updatePromoList(query) {
    query = query.toUpperCase();
    clearCurrentList();
    var numItems = 0;
    currentItem = 0;

    result_set = cached[query.charAt(0)][query.charAt(1)][query.charAt(2)];

    for(i in result_set){
        if(numItems >= NUMBER_MATCHES){
            $("<li/>").html("<span style='color: #aaa'>Please try to limit your search results</span>").appendTo("#possibilities").mouseover(function(event){ updateCurrentItem(numItems+1); });
            break;
        }

        promo = result_set[i];
        found_number = false;
        if (!promo.client)
            found_number = (promo.prj_number.toString().substr(0,query.length) == query) ? true : false;

        if (query.length >= MATCH_NAME) {
            if(promo.prj_name && typeof promo.prj_name == 'string'){
                found_name = promo.prj_name.toUpperCase().indexOf(query);
            } else {
                found_name = -1;
            }  
            if (promo.client)
                found_client = promo.client_name.toString().indexOf(query);
            else
                found_client = -1;
        } else {
            found_name = -1;
            found_client = -1;
        }

        if(found_client >= 0) {
            var thisIndex = numItems+1;
            console.log("setting", thisIndex);
            $("<li/>").text(promo.client_name).bind('click',function(e){ updatePromoChoice(e,promo); }).appendTo("#possibilities").mouseover(function(event){ updateCurrentItem(thisIndex); });        } else if(found_name >= 0 || found_number) {            var thisIndex = numItems+1;
            console.log("setting", thisIndex);
            $("<li/>").text(promo.prj_number+": "+promo.prj_name).bind('click',function(e){ updatePromoChoice(e,promo); }).appendTo("#possibilities").mouseover(function(event){ updateCurrentItem(thisIndex); });
        }

        if(found_number || found_client >= 0 || found_name >= 0){
            numItems++;
        }
    }
}

function updateCurrentItem(i){
    currentItem = i;
    console.log("updating to", i);
} 
```

运行结果如下：

```
setting 0
setting 1
setting 2
setting 3
setting 4
setting 5
setting 6
setting 7
setting 8
setting 9
setting 10
setting 11
setting 12
setting 13 
```

然后当我将鼠标移到包含这些事件的内容区域`<li>`时`mouseOver`，我所看到的只是：

```
updating to 4 
```

***总是***4\. 有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T16:18:45.467

您正在创建一个闭包，但它仍然绑定到 numItems 变量：

```
function(event){ updateCurrentItem(numItems+1); } 
```

你应该做的是这样的：

```
(function(numItems){return function(event){ updateCurrentItem(numItems+1); }})(numItems) 
```

编辑：我想我可能有错误的功能，但同样的原则适用：

```
function(event){ updateCurrentItem(thisIndex); } 
```

应该

```
(function(thisIndex)
{
    return function(event){ updateCurrentItem(thisIndex); }
})(thisIndex) 
```

# hibernate - Hibernate、JDBC-driver 和 OSGi 问题

> ID：682318
> 
> 赞同：5
> 
> 时间：2009-03-25T16:13:41.000
> 
> 标签：hibernate, osgi, springsource

我遇到了一个有点令人沮丧的问题。我使用 Apache Felix 作为我的 OSGi 框架，并且我还使用 Hibernate 来解决持久性问题。

我正在使用 Hibernate 的“osgi-bundle”版本（com.springsource.org.hibernate-3.2.6.ga.jar）。据我所知，这是 Hibernate Core，在 META-INF/MANIFEST.mf 中安装了一些额外的 osgi-metdata。此信息（Package-Export 和 Package-Import）对于 osgi 系统至关重要。

我的问题是 Hibernate 包找不到我的 JDBC 驱动程序。在springsource Hibernate bundle中加入Import语句感觉很不对劲。必须有一些更好的方法来解决这个问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-13T18:45:33.553

Hibernate 不是一个非常好的 OSGi 公民，因为 Hibernate 对类可见性所做的许多假设在 OSGi 容器中不再成立。

使用 JDBC 驱动程序加载的常用方法`Class.forName(<jdbc class name>)`在 OSGi 中不起作用，因为在这种情况下，Hibernate 将尝试加载驱动程序但找不到它，因为 Hibernate 不（也不应该）导入 JDBC 驱动程序包.

JDBC 驱动程序管理器还试图通过计算调用类的类加载器是否应该看到驱动程序来变得聪明，这也与 OSGi 冲突。

如果您使用 Spring 来配置 Hibernate，那么我建议您使用`SimpleDriverDataSource`该类，因为它在 OSGi 中有效，并且 Spring 允许您使用具体的数据源配置 Hibernate，而不是传递 Hibernate 需要实例化的类名。

一旦你解决了这个问题，你可能会遇到 Hibernate 看不到你的域类的问题。我只有 XML 映射方法的经验，我认为在 OSGi 中更简单，因为我认为注释方式需要某种 AOP 编织，这是 OSGi 当前的另一个痛点。

目前，除非您使用 Spring 的 dm Server 之类的东西，否则您需要更加熟悉 Java 的类加载机制以及如何使用 OSGi 的服务方法来解决 vanilla Java 和 OSGi 世界之间的不兼容问题。

具体来说，研究企业库如何使用上下文类加载器以及如何管理它。我正在使用 Spring dm 将遗留代码包装在 OSGi 服务中，因为这样可以轻松控制上下文类加载器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T17:06:57.737

您是否处理了正确的捆绑包开始订购？有一种方法可以设置每个包的启动级别，以便您的系统可以正确引导。如果某些激活器尝试直接获取服务，则可能需要正确的捆绑包启动级别。如果服务不可用，服务消费者就会被卡住。

尝试为您的捆绑包设置正确的启动级别并查看它是否有效。具体来说，您必须先使用 JDBC 驱动程序启动该包，然后再使用休眠包。

另一个问题可能是您有一些未解决的依赖项。确保一切都在那里。您可以通过获取 OSGi 控制台并询问服务列表来完成此操作。在 Equinox 中，这归结为 -console 命令行参数和 OSGi shell 中的“ss”后跟“diag”命令。

编辑（回答您的评论）：

驱动程序由它们的接口注册。然后 Hibernate 可能通过其接口查找驱动程序，无需导入特定的驱动程序类。无论如何，这会引入对实现特定类的不希望的依赖。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-07-01T12:26:21.843

在 OSGi 包中，您只能查看已导入包中的类和资源。Hibernate 包不会（也不应该）导入您的域类。因此，当 Hibernate 尝试处理 XML 映射文件时，它会抱怨找不到正在映射的类（您的域类）。

我们通过使用 Equinox 的伙伴策略解决了这个问题，因此每个提供域对象的包都是 Hibernate 的类加载伙伴。我不太喜欢这种方法，但我没有时间编写我脑海中的（希望如此）优雅的解决方案。

正如我在之前的文章中所说，对于 Hibernate 而言，操作上下文类加载器可能是最好的长期选择。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-07T17:53:42.510

我前段时间遇到过[类似的问题。](https://stackoverflow.com/questions/685269/eclipse-rcp-classnotfoundexception-or-how-to-make-other-bundle-load-my-class)解决方案是将 jdbc-provider bundle 和 jdbc-user bundle 注册为“buddies”。这是因为一个捆绑包不能使用来自另一个捆绑包的类（所以 jdbc 驱动程序也是如此），除非明确声明它。这是为 Eclipse 准备的，所以我认为它可能会对您有所帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-01-02T15:49:22.060

我还没有尝试过（因为我是反 RDBMS，因此也是反 ORM），但一种解决方案可能是使用 OSGi 片段。

创建一个包含您的域类的片段并将 Hibernate 包指定为主机。这个片段应该导出你的域类的包。

同样，您可以对要使用的 JDBC 驱动程序执行相同的操作。获取驱动程序类并将它们转换为以 Hibernate 作为主机包的 OSGi 片段。但是，您不必导出驱动程序包，因为它们只会被 Hibernate 包使用。

我怀疑Felix 9个月前没有完全支持片段，但现在看来它们肯定是：http: [//osgithoughts.blogspot.com/2009/09/felix-now-fully-supports-osgi-fragments.html](http://osgithoughts.blogspot.com/2009/09/felix-now-fully-supports-osgi-fragments.html)

# c# - 不使用 Add 方法为 Hashtable 分配新值

> ID：682322
> 
> 赞同：5
> 
> 时间：2009-03-25T16:14:31.497
> 
> 标签：c#, .net, hashtable

要向我一直使用的 dotnet Hashtable 添加新值：

```
myHashtable.Add(myNewKey, myNewValue); 
```

但我刚刚遇到了一些代码，它执行以下操作：

```
myHashTable[myNewKey] = myNewValue; 
```

这两种方法有什么区别吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-25T16:19:40.207

为了稍微纠正 Sergej 的回答......

*   `Add`如果密钥已经存在，确实会抛出异常。
*   将索引器用作设置器*不会*引发异常（除非您指定空键）。
*   如果键不存在并且您使用的是通用的`IDictionary<TKey,TValue>`. 在非泛型`IDictionary`实现（例如`Hashtable`）中，您将获得一个空引用。但是，您不能对任何一个都使用空键-您将得到一个`ArgumentNullException`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T16:16:32.117

如果已经存在具有给定键的项目，则第一个将引发异常，如果没有具有该键的项目，则第二个将引发异常

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T16:21:33.540

不同之处在于处理重复值。

**如果 HashTable 已包含带有您的键的元素，则 **myHashtable.Add()将引发 ArgumentException。****myHashTable[myNewKey]**用新值替换旧值。**

 **# mysql - MySQL - 并发选择 - 一个客户端等待另一个？

> ID：682344
> 
> 赞同：3
> 
> 时间：2009-03-25T16:20:08.393
> 
> 标签：mysql, select, myisam, concurrency

我有以下情况：

我有一个包含大约 400 万行的特定 MyISAM 表的数据库。我使用存储过程（MySQL 5.1 版），特别是使用存储过程来根据各种条件搜索这些行。这个表上有几个索引，通过这个存储过程的查询通常非常快（<1s）。基本上，我使用准备好的语句并在此搜索 sp 中创建和执行一些动态 SQL。执行准备好的语句后，我执行“DEALLOCATE PREPARED stmt;”

大多数查询在一秒钟内运行（我使用 LIMIT 随时只获取 15 行）。但是，有一些罕见的查询需要更长时间才能运行（比如 2-3 秒）。我已尽我所能优化搜索表。

我开发了一个 Web 应用程序，我可以在一秒钟内在我的开发机器上运行并查看快速查询的结果。

但是，如果我打开两个浏览器实例并同时进行搜索（针对开发机器），一个具有运行时间较长的查询，另一个具有更快的查询，结果会同时返回，即看起来好像快速查询在返回结果之前等待较慢的查询完成。即两个查询都需要 2-3 秒...

是否有一个原因？因为我认为 MyISAM 处理 SELECTS 彼此无关，而目前这不是我正在经历的行为......

提前致谢！蒂姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T16:25:28.727

这只是因为您是在同一台机器上进行的，如果搜索来自两台不同的机器，它们会同时进行。你真的希望一个人能够通过打开一堆浏览器窗口并点击刷新来让你的 MySQL 服务器陷入困境吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-12-07T17:06:20.837

没错。MyISAM 表上的每个选择查询都会锁定整个表，直到完成。他们的借口是这实现了“非常高的读取吞吐量”。切换到 innoDB 将允许并发读取。

# wcf - WCF 代理生成

> ID：682345
> 
> 赞同：1
> 
> 时间：2009-03-25T16:20:10.780
> 
> 标签：wcf, proxy

我使用 svcutil 生成调用 WSE2 Web 服务的 wcf 代理。

当 Web 服务作者更改代理中的字段顺序时，问题就出现了。

我检查了生成的代理，发现每个字段的公共属性都装饰有 XmlElementAttribute(Order=0) .. Order=1 等。

有没有办法生成在 Web 服务更改后仍然可以运行的 WCF 代理？

因为现在我需要重新生成代理并重新编译。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T16:26:45.603

您可以手动更改生成的文件，如果唯一更改的是字段的顺序，这可能是最好的解决方案。但是你必须重新编译。

否则，您可以使用通道工厂来创建通道，但您仍然需要更改数据合约 => 您必须重新编译。

将代理保存在单独的程序集中？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T16:30:22.503

svcutil 生成的基本普通代理将使用 DataContractSerializer，它使用这些 Order=x 属性。

如果你愿意，你也可以使用直接的 XmlSerializer 代替，它不会用 Order=x 属性装饰你的属性。

利用：

```
 svcutil ........ /serializer:XmlSerializer 
```

为达到这个。

马克

# java - 如何创建在行首输出两个“#”字样的速度模板？

> ID：682347
> 
> 赞同：3
> 
> 时间：2009-03-25T16:20:37.690
> 
> 标签：java, velocity

我需要创建一个速度文档，其中有一些以“## Foo”为前缀的行，但由于这`#`是速度指令命令，它对我不起作用。

我希望我的**输出**文档看起来像：

```
## Foo this
## Bar that
k1, v1
k2, v2
k3, v3 
```

逃避并没有达到我的预期。显然，以下内容不起作用，因为`#`s 未转义）：

```
## Foo this
## Bar that
#foreach( $foo in $bar )
$foo.key, $foo.value
#end 
```

## 行没有出现 - 再次，正如预期的那样。但是，我的逃跑尝试也没有奏效。逃生解决方案一：

```
\## Foo this
\## Bar that
#foreach( $foo in $bar )
$foo.key, $foo.value
#end 
```

或者这个，逃避解决方案二：

```
\#\# Foo this
\#\# Bar that
#foreach( $foo in $bar )
$foo.key, $foo.value
#end 
```

甚至这个...

```
# set($msg = "##") 
$msg Foo this
$msg Bar that
#foreach( $foo in $bar )
$foo.key, $foo.value
#end 
```

最后一个真的让我很困惑。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T16:32:31.827

使用[速度上下文](http://velocity.apache.org/tools/devel/generic/EscapeTool.html)：

```
${esc.h}${esc.h} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T16:44:03.283

如果您不想添加[org.apache.velocity.tools.generic.EscapeTool](http://velocity.apache.org/tools/devel/generic/EscapeTool.html)或类似于您的上下文，您可以使用第三次尝试的稍微修改的版本：

```
#set($msg = "#") 
${msg}${msg} Foo this 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-28T00:13:26.557

叹息....单引号和双引号是有区别的。这按预期工作：

```
#set($msg = '##') 
$msg Foo this 
```

这正是我想要的打印出来：

```
## Foo this 
```

从[速度用户指南](http://velocity.apache.org/engine/releases/velocity-1.5/user-guide.html)：

> 单引号将确保引用的值将按原样分配给引用。双引号允许您使用速度引用和指令进行插值，例如“Hello $name”

*（我仍然对为什么 \#\# 不起作用感到困惑。）*

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-25T16:27:49.547

“##”是 VTL 中的单行注释分隔符，这可能是您问题的开始。

```
## This is a comment 
```

# php - 投掷 die() 时指定页/行？

> ID：682358
> 
> 赞同：2
> 
> 时间：2009-03-25T16:23:06.640
> 
> 标签：php, die

我正在使用 PHP 4，我知道导致错误并停止一切的唯一方法是调用 die()。但是如果我稍后遇到错误并且不记得它来自哪里，我想指定 die() 发生的页面和行号（就像其他 php 错误一样）。有没有办法做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-25T16:24:27.307

您应该研究[魔术常数。](http://is2.php.net/manual/en/language.constants.predefined.php)

```
echo __LINE__; // Line number 
```

您还可以运行[error_log()](http://is2.php.net/manual/en/function.error-log.php)以悄悄地将错误发送到日志。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-25T16:24:47.993

最简单的方法是使用：

```
echo __FILE__ . ": line " . __LINE__;
die(); 
```

如果你要使用 PHP5，你也可以使用 Exceptions：

```
throw new Exception("My error message!"); 
```

堆栈跟踪将显示整个调用堆栈和被抛出的行。

（编辑：感谢 [@John Isaacs] 和 [@Emil H] 告知我 PHP5 之前没有将异常添加到 PHP）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-25T16:33:32.717

我认为您应该使用[trigger_error()](http://se2.php.net/manual/en/function.trigger-error.php)来生成 E_USER_ERROR 或 E_USER_WARNING。这使您可以详细控制行为。例如，您可以使用[error_reporting()](http://se2.php.net/error_reporting)指定是否应该显示消息，或者使用 set_error_handler() 显式处理 E_USER_WARNING:s。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-25T16:27:03.027

除了@Jukka Dahlbom 和@Ólafur Waage 的建议，您还可以考虑使用[`debug_backtrace()`](http://www.php.net/debug_backtrace).

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T16:29:45.003

更好地[`error_log()`](http://docs.php.net/error_log)用于报告错误和[`debug_backtrace()`](http://docs.php.net/debug_backtrace)调试。您还可以编写自己的错误处理函数（请参阅 参考资料[`set_error_handler()`](http://docs.php.net/set_error_handler)）来结合两者。

# c# - 在 C# 中获取本地 Windows 用户登录会话时间戳

> ID：682360
> 
> 赞同：4
> 
> 时间：2009-03-25T16:24:17.853
> 
> 标签：c#, .net, windows, login, timestamp

我一直在尝试查看各种 .NET 类库，在其中可以获取本地计算机的登录用户，无论是否连接到域。至今

```
System.Security.Principal.WindowsPrincipal LoggedUser = System.Threading.Thread.CurrentPrincipal as 
System.Security.Principal.WindowsPrincipal;
// This returns the username
LoggedUser.Identity.Name 
```

这将返回用户的姓名，但是是否有任何方法可以获取会话详细信息，您将在 AD 中看到的内容或用户登录、会话持续时间等。用户的上下文、工作站锁定等操作、存在用户的基本。

如果您有任何想法，将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T17:12:02.903

[您可以使用System.DirectoryServices](http://msdn.microsoft.com/en-us/library/system.directoryservices.aspx)命名空间通过 LDAP 查询查询 Active Directory 以获取您需要的大部分数据。例如，下面的示例显示了用户的上次登录时间。

当然，这只适用于域用户。

```
using System;
using System.Collections.Generic;
using System.Text;
using System.DirectoryServices;

namespace ADMadness
{
    class Program
    {
        static void Main(string[] args)
        {
            DirectorySearcher search = new DirectorySearcher("LDAP://DC=my,DC=domain,DC=com");
            search.Filter = "(SAMAccountName=MyAccount)";
            search.PropertiesToLoad.Add("lastLogonTimeStamp");

            SearchResult searchResult = search.FindOne();

            long lastLogonTimeStamp = long.Parse(searchResult.Properties["lastLogonTimeStamp"][0].ToString());
            DateTime lastLogon = DateTime.FromFileTime(lastLogonTimeStamp);

            Console.WriteLine("The user last logged on at {0}.", lastLogon);
            Console.ReadLine();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T16:35:40.823

[您可以从 WMI 查看WMI_LogonSession](http://msdn.microsoft.com/en-us/library/aa394189(VS.85).aspx)获取其中一些信息，例如开始时间

# sql - 当不支持继承时，如何在 MySQL 中处理多个值类型？

> ID：682363
> 
> 赞同：0
> 
> 时间：2009-03-25T16:24:29.337
> 
> 标签：sql, mysql

我需要创建一个属性表，其中每条记录本质上只是一个名称-值对。问题是该值可以是字符串、整数或小数，而我使用的 MySQL 不支持表继承。所以，问题是 - 我应该为每个值类型创建一个单独的表，还是应该只创建 str_value、int_value 和 dec_value 列以及一个额外的 value_type 列，告诉你使用哪种类型？此表中不会有太多记录（少于 100 条），因此性能应该不是什么大问题，但我只是不想做出会让 SQL 变得比它更复杂的设计决策成为。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T16:35:08.640

查询数据库时，您将始终收到字符串，无论列类型是什么——因此没有理由在这里做出设计决定——只需将所有内容存储为字符串即可。

顺便说一句：拥有一个额外的 value_type 列是多余的 - 该条目具有唯一具有非空值的列的类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T16:39:19.613

拥有不同的表，甚至是多列，其中只有 3 个中的一个被填充，这将是一场噩梦。将其全部存储为 varchar 以及类型列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T16:26:15.853

如果您为每种类型创建不同的列，那么无论如何您都必须在代码中对此保持警惕......

为什么不将所有内容存储为字符串并在代码中转换为所需的类型？

# python - 用于模糊字符串比较的好 Python 模块？

> ID：682367
> 
> 赞同：232
> 
> 时间：2009-03-25T16:25:08.447
> 
> 标签：python, string, string-comparison, fuzzy-comparison

我正在寻找一个可以进行简单模糊字符串比较的 Python 模块。具体来说，我想要字符串相似程度的百分比。我知道这可能是主观的，所以我希望找到一个可以进行位置比较以及最长相似字符串匹配等的库。

基本上，我希望找到足够简单的东西来产生一个百分比，同时仍然足够可配置，我可以指定要执行的比较类型。

* * *

## 回答 #1

> 赞同：249
> 
> 时间：2009-03-25T16:34:09.017

[difflib](http://docs.python.org/library/difflib.html)可以做到。

文档中的示例：

```
>>> get_close_matches('appel', ['ape', 'apple', 'peach', 'puppy'])
['apple', 'ape']
>>> import keyword
>>> get_close_matches('wheel', keyword.kwlist)
['while']
>>> get_close_matches('apple', keyword.kwlist)
[]
>>> get_close_matches('accept', keyword.kwlist)
['except'] 
```

看看这个。它还有其他功能可以帮助您构建自定义内容。

* * *

## 回答 #2

> 赞同：164
> 
> 时间：2009-03-26T07:18:51.370

Levenshtein Python 扩展和 C 库。

[https://github.com/ztane/python-Levenshtein/](http://code.google.com/p/pylevenshtein/)

Levenshtein Python C 扩展模块包含用于快速计算 - Levenshtein（编辑）距离和编辑操作 - 字符串相似度 - 近似中值字符串，通常是字符串平均 - 字符串序列和集合相似度的函数 它支持普通字符串和 Unicode 字符串。

```
$ pip install python-levenshtein
...
$ python
>>> import Levenshtein
>>> help(Levenshtein.ratio)
ratio(...)
    Compute similarity of two strings.

    ratio(string1, string2)

    The similarity is a number between 0 and 1, it's usually equal or
    somewhat higher than difflib.SequenceMatcher.ratio(), becuase it's
    based on real minimal edit distance.

    Examples:
    >>> ratio('Hello world!', 'Holly grail!')
    0.58333333333333337
    >>> ratio('Brian', 'Jesus')
    0.0

>>> help(Levenshtein.distance)
distance(...)
    Compute absolute Levenshtein distance of two strings.

    distance(string1, string2)

    Examples (it's hard to spell Levenshtein correctly):
    >>> distance('Levenshtein', 'Lenvinsten')
    4
    >>> distance('Levenshtein', 'Levensthein')
    2
    >>> distance('Levenshtein', 'Levenshten')
    1
    >>> distance('Levenshtein', 'Levenshtein')
    0 
```

* * *

## 回答 #3

> 赞同：70
> 
> 时间：2010-03-10T17:03:57.327

正如[nosklo](https://stackoverflow.com/questions/682367/good-python-modules-for-fuzzy-string-comparison/682398#682398)所说，使用 Python 标准库中的[difflib](http://docs.python.org/library/difflib.html)模块。

difflib 模块可以使用[SequenceMatcher()](http://docs.python.org/library/difflib.html#sequencematcher-objects)对象的`ratio()`方法返回序列相似性的度量。相似度以 0.0 到 1.0 范围内的浮点数形式返回。

```
>>> import difflib

>>> difflib.SequenceMatcher(None, 'abcde', 'abcde').ratio()
1.0

>>> difflib.SequenceMatcher(None, 'abcde', 'zbcde').ratio()
0.80000000000000004

>>> difflib.SequenceMatcher(None, 'abcde', 'zyzzy').ratio()
0.0 
```

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2011-12-03T19:20:23.713

[Jellyfish](https://pypi.python.org/pypi/jellyfish/)是一个 Python 模块，它支持许多字符串比较指标，包括语音匹配。与 Jellyfish 的实现相比，Levenstein 编辑距离的纯 Python 实现相当慢。

示例用法：

```
import jellyfish

>>> jellyfish.levenshtein_distance('jellyfish', 'smellyfish')
2 
>>> jellyfish.jaro_distance('jellyfish', 'smellyfish')
0.89629629629629637
>>> jellyfish.damerau_levenshtein_distance('jellyfish', 'jellyfihs')
1
>>> jellyfish.metaphone('Jellyfish')
'JLFX'
>>> jellyfish.soundex('Jellyfish')
'J412'
>>> jellyfish.nysiis('Jellyfish')
'JALYF'
>>> jellyfish.match_rating_codex('Jellyfish')
'JLLFSH'` 
```

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2009-03-25T16:46:32.327

我喜欢[nosklo 的回答](https://stackoverflow.com/questions/682367/good-python-modules-for-fuzzy-string-comparison/682398#682398)；另一种方法是[Damerau-Levenshtein 距离](http://en.wikipedia.org/wiki/Damerau%E2%80%93Levenshtein_distance)：

“在信息论和计算机科学中，Damerau-Levenshtein 距离是两个字符串之间的‘距离’（字符串度量），即有限的符号序列，通过计算将一个字符串转换为另一个字符串所需的最小操作数给出，其中操作被定义为单个字符的插入、删除或替换，或两个字符的转置。”

[Wikibooks](http://en.wikibooks.org/wiki/Algorithm_implementation/Strings/Levenshtein_distance)中的 Python 实现：

```
def lev(a, b):
    if not a: return len(b)
    if not b: return len(a)
    return min(lev(a[1:], b[1:])+(a[0] != b[0]), \
    lev(a[1:], b)+1, lev(a, b[1:])+1) 
```

更多来自 Wikibooks，这为您提供了[最长公共子字符串 (LCS)](http://en.wikibooks.org/wiki/Algorithm_implementation/Strings/Longest_common_substring)的长度：

```
def LCSubstr_len(S, T):
    m = len(S); n = len(T)
    L = [[0] * (n+1) for i in xrange(m+1)]
    lcs = 0
    for i in xrange(m):
        for j in xrange(n):
            if S[i] == T[j]:
                L[i+1][j+1] = L[i][j] + 1
                lcs = max(lcs, L[i+1][j+1])
    return lcs 
```

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2009-03-25T17:47:33.910

还有 Google 自己的[google-diff-match-patch](http://code.google.com/p/google-diff-match-patch/)（“目前在 Java、JavaScript、C++ 和 Python 中可用”）。

（不能评论，因为我自己只用过python的difflib）

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2011-08-29T18:41:14.373

另一种选择是使用最近发布的包[FuzzyWuzzy](https://github.com/seatgeek/fuzzywuzzy)。该包支持的各种功能也在[这篇博](http://seatgeek.com/blog/dev/fuzzywuzzy-fuzzy-string-matching-in-python)文中进行了描述。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2011-12-16T06:30:54.423

我正在使用[双重变音器](https://github.com/dracos/double-metaphone)，它就像一个魅力。

一个例子：

```
>>> dm(u'aubrey')
('APR', '')
>>> dm(u'richard')
('RXRT', 'RKRT')
>>> dm(u'katherine') == dm(u'catherine')
True 
```

更新：水母也有。属于语音编码。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2013-08-14T03:07:38.193

我一直在使用 Seat Geek 的 Fuzzy Wuzzy 并取得了巨大的成功。

[https://github.com/seatgeek/fuzzywuzzy](https://github.com/seatgeek/fuzzywuzzy)

具体来说就是token set ratio函数...

他们还写了一篇关于模糊字符串匹配过程的精彩文章：

[http://seatgeek.com/blog/dev/fuzzywuzzy-fuzzy-string-matching-in-python](http://seatgeek.com/blog/dev/fuzzywuzzy-fuzzy-string-matching-in-python)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-04-20T16:32:11.190

这是一个 python 脚本，用于计算两个单词中最长的公共子字符串（可能需要调整以适用于多单词短语）：

```
def lcs(word1, word2):

    w1 = set(word1[i:j] for i in range(0, len(word1))
             for j in range(1, len(word1) + 1))

    w2 = set(word2[i:j] for i in range(0, len(word2))
             for j in range(1, len(word2) + 1))

    common_subs = w1.intersection(w2)

    sorted_cmn_subs = sorted([
        (len(str), str) for str in list(common_subs)
        ])

    return sorted_cmn_subs.pop()[1] 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2011-11-19T11:21:00.343

这是使用 Charicar 的 simhash 的方法，这也适用于长文档，当您更改文档中的单词顺序时，它也会检测到 100% 的相似性

[http://blog.simpliplant.eu/calculating-similarity-between-text-strings-in-python/](http://blog.simpliplant.eu/calculating-similarity-between-text-strings-in-python/)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2012-04-03T12:12:54.937

看看[Fuzzy](http://pypi.python.org/pypi/Fuzzy)模块。它具有用于 soundex、NYSIIS 和双变音器的快速（用 C 语言编写）算法。

一个很好的介绍可以在：[http ://www.informit.com/articles/article.aspx?p=1848528](http://www.informit.com/articles/article.aspx?p=1848528)

# flash - Actionscript 2、Flash 8 和 Amazon S3。有 AS2.0 API 吗？

> ID：682368
> 
> 赞同：1
> 
> 时间：2009-03-25T16:25:19.070
> 
> 标签：flash, authentication, actionscript-2, amazon-s3

我正在开发一个将图像和视频加载到 Flash 播放器中的应用程序（目前使用 Flash 8 进行开发，所以这是 AS2.0）。我们将在 Amazon S3 服务器上托管文件。谁能指出将文件从 Amazon S3 加载到 Flash Player 的最佳方法。我一直在使用 MovieClipLoader 使用 loadMovie(" [http://domain/folder/file从我们的开发服务器加载图像](http://domain/folder/file)") 和渐进式视频以类似的方式加载。我希望能够像从我们的开发服务器一样从 S3 加载。从 S3 将每个项目加载到 Flash 时是否需要经过签名和身份验证过程？我不完全理解如何在 Flash 中生成签名等。我可以使用 PHP S3 类来执行此操作并在开始时将签名等作为变量发送到 Flash 并使用相同的签名来加载所有图像/视频吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T16:39:01.330

假设 ACL 设置允许读取访问，托管在 Amazon S3 上的资产无需任何身份验证即可使用。因此，您无需提供签名或身份验证即可简单地下载内容。例如，这是我在 S3 上的一个图像文件，可以通过一个简单的 url 访问：

~~[gromit.jpg](http://s3.amazonaws.com/Evernden/gromit.jpg)~~（死链接）

您是否要求保护您的资产不被没有凭据的任何人查看？

# sql - SQL 在 select 语句中创建一个临时“映射”表

> ID：682370
> 
> 赞同：0
> 
> 时间：2009-03-25T16:25:35.247
> 
> 标签：sql, oracle

我正在通过加入表格来建立结果

```
select t1.*, t2.col2 from t1, t2 where t1.col1=t2.col1 
```

对于 t2 表不存在的实例，有没有办法在 select 语句中创建一个临时的“映射”表“内联”？

所以像

```
select t1.*, tempt2.col2 from t1, (<create temp table>) tempt2 where ... 
```

我正在使用甲骨文

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T16:46:14.260

带`1`行的表：

```
SELECT t1.*, t2.col2
FROM   t1,
       (
       SELECT  1 AS col2
       FROM    dual
       ) t2 
```

带`0`行的表：

```
SELECT t1.*, t2.col2
FROM   t1,
       (
       SELECT  1 AS col2
       FROM    dual
       WHERE   1 = 0
       ) t2 
```

带`N`行的表：

```
SELECT t1.*, t2.col2
FROM   t1,
       (
       SELECT  1 AS col2
       FROM    dual
       CONNECT BY
               level <= :N
       ) t2 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T16:51:05.387

我不确定这是您要查找的内容，但是您可以使用 UNION 执行多个 SELECT 以获得派生表

```
SELECT t1.*, t2.col2
FROM t1, (
    SELECT 1 as Id, 'Foo' as Col2
    UNION ALL
    SELECT 2 as Id, 'Bar' as Col2
    UNION ALL
    SELECT 3 as Id, 'FooBar' as Col2
) t2
WHERE
   t1.Id = t2.Id 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-12-27T13:14:20.390

我知道这个问题很老了。但只是为了完成答案，DECODE() 函数呢？

[https://docs.oracle.com/cd/B19306_01/server.102/b14200/functions040.htm#i1017437](https://docs.oracle.com/cd/B19306_01/server.102/b14200/functions040.htm#i1017437)

```
SELECT product_id,
   DECODE (warehouse_id, 1, 'Southlake', 
                         2, 'San Francisco', 
                         3, 'New Jersey', 
                         4, 'Seattle',
                            'Non domestic') 
   "Location of inventory" FROM inventories
   WHERE product_id < 1775; 
```

只要映射表相当短，这似乎是一个非常优雅的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T16:32:22.750

不知道它是否适用于 Oracle，但您是否正在寻找类似以下伪代码的内容？

select t1.*, tempt2.col2 from t1 inner join (select col2, foo, bar from t2 where bar = ?) tempt2 on t1.foo = tempt2.foo where . . .

我想这并不能真正解决问题，因为您说 table2 (t2) 并不存在。我不确定您的映射表中有什么，或者如果不是从表中，您将在哪里获得该数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T16:32:54.543

我不完全确定你在这里得到什么。

您想要的是[WITH 子句](http://www.psoug.org/reference/OLD/with.html)，例如

```
WITH tempt2 AS 
  (SELECT x FROM y)
SELECT t1.*, tempt2.col2
FROM t1, tempt2
WHERE ... 
```

或者，如果您在不同的数据库上运行相同的 SQL，并且您不能确定该表是否确实存在，那么您可能会更好地测试它的存在并做出不同的反应。

它需要纯 SQL 还是可以使用 PL/SQL？

# fluent-nhibernate - NHibernate 中的空值对象

> ID：682387
> 
> 赞同：10
> 
> 时间：2009-03-25T16:30:28.433
> 
> 标签：fluent-nhibernate, null, nhibernate-mapping, value-objects

我有一个包含地址作为值对象的人员实体：

```
public Person()
{
    WithTable("Person");
    Id(x => x.Id);
    Component<Address>(x => x.Address, a =>
    {
        a.Map(x => x.Address1);
        a.Map(x => x.Address2);
        a.Map(x => x.Address3);
        a.Map(x => x.Town);
        a.Map(x => x.Postcode);
    });
} 
```

它在 NHibernate 文档中声明，如果值对象（Address1、Address2 等）的所有属性都为 null，则整个组件将被映射为 null（即 Person.Address 将为 null）。在所有地址字段为空的情况下，这会给我带来问题，因为在我可能拥有的页面中（我正在做 ASP MVC）：

```
<%= Html.TextBoxFor((x => x.Address.Address1))%> 
```

这会因空引用异常而中断。因此，我正在寻找一种干净的方法来将 Address 设置为新的 Address() 对象，而不是 null 如果当我从数据库中加载 Person 时所有字段都为空而不手动执行。我打折了以下想法：

在我的视图中进行空值检查（yuk，可怕）

使数据库字段不可为空（我正在处理旧数据库）

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-26T09:17:40.307

感谢 James 的想法（见他的回答和评论），我修改了我的 Person 实体的 Address 属性：

```
public virtual string Address { get; set; } 
```

到：

```
private Address _address;
public virtual Address Address
{
    get { return _address ?? new Address(); }
    set { _address = value; }
} 
```

这解决了我的问题，它有效，而且它似乎适用于 NHibernate。耶！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T19:50:56.377

我没有任何明确的答案来创建未映射的方法/属性访问器，如果实际地址为空，则返回默认/空对象。

```
public Address GetAddressOrDefault()
{
  return Address ?? new NullAddress();
} 
```

`Address`或与第一个类似，为您在视图中使用的包装器创建一个包装器。

```
public class AddressViewData
{
  private Address address;

  public AddressViewData(Address address)
  {
    this.address = address ?? new NullAddress();
  }

  // expose all address properties as pass-throughs
  public string Street
  {
    get { return address.Street; }
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-12-02T15:31:14.143

在某些情况下，编写 NHibernate 自定义类型非常容易。它不会将组件设置为 null，而是返回 null 对象。我在某些情况下这样做了，然后你就可以忘记空值了。

[复合用户类型的示例](http://geekswithblogs.net/opiesblog/archive/2006/08/30/89823.aspx)。

# iphone - 翻转视图的问题

> ID：682388
> 
> 赞同：2
> 
> 时间：2009-03-25T16:30:30.180
> 
> 标签：iphone, cocoa-touch

我在翻转视图时遇到了一些麻烦。我的视图控制器中有以下代码：

```
- (void)loadFlipsideViewController {
    ProblemViewFlipController *viewController = [[ProblemViewFlipController alloc] initWithNibName:@"ProblemViewFlip" bundle:nil];
    self.problemViewFlipController = viewController;
    [viewController release];
}

- (void) flipView {

    if (problemViewFlipController == nil) {
        [self loadFlipsideViewController];
    }

    UIView *mainView = self.view;
    UIView *flipView = problemViewFlipController.view;

    [UIView beginAnimations:nil context:NULL];
    [UIView setAnimationDuration:1];

    [UIView setAnimationTransition:([mainView superview] ? UIViewAnimationTransitionFlipFromLeft : UIViewAnimationTransitionFlipFromRight) forView:self.view cache:YES];

    if ([flipView superview])
    {
        [flipView removeFromSuperview];
        [self.view addSubview:mainView];
    }
    else
    {
        [mainView removeFromSuperview];
        [self.view addSubview:flipView];
    }

    [UIView commitAnimations];
} 
```

问题是，当我调用flipView 时，视图被替换为空白视图（即，我正在翻转的视图中没有显示任何内容）。

我在这里有什么明显的遗漏吗？（我怀疑有！）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T16:40:52.540

不是积极的，但我认为你需要使用“控制器”来翻转视图。看起来您正在使用翻转视图之一作为控制器。只需添加一个根控制器来翻转您的视图。

像这样的代码应该在根控制器上工作：

```
[UIView beginAnimations:nil context:NULL];
[UIView setAnimationDuration:1];
[UIView setAnimationTransition:UIViewAnimationTransitionFlipFromRight forView:self.view cache:YES]; // self.view is the root controller's view
[mainViewController viewWillAppear:YES];
[flipViewController viewWillDisappear:YES];
[flipViewController.view removeFromSuperview];
[self.view  addSubview:mainViewController.view];
[flipViewController viewDidDisappear:YES];
[mainViewController viewDidAppear:YES];
[UIView commitAnimations]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T18:49:28.443

Based on the variable names, it looks like this is adapted from the default "Utility" application template you get from XCode. If the template project works, and yours doesn't, then you've obviously changed something you shouldn't have :-)

Chances are, one of the outlets in your controller that should be pointing at a view, isn't. Double-check your Nibs, and check the values of the outlets in the debugger. If all else fails, start over again from the template, and see at what point it stops working.

# character-encoding - gedit 无法打开 shoes2.run

> ID：682389
> 
> 赞同：1
> 
> 时间：2009-03-25T16:31:42.050
> 
> 标签：character-encoding, gedit, shoes

我刚刚下载了鞋子，但无法将它们开箱即用。

在 ubuntu intrepid 中双击 shoes2.run 并打开 gedit 并显示以下消息：

```
Could not open the file /home/mark/Marks files/2…ng/Programming/shoes2.run using the Unicode (UTF-8) character coding.

Please check that you are not trying to open a binary file.
Select a different character coding from the menu and try again. 
```

它提供了一个带有 2 个选项和一个重试按钮的下拉菜单：

1.  当前语言环境 (UTF-8)
2.  西方 (ISO-8859-15)

他们俩都不被认可。

我如何让它运行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T15:52:05.987

米-

我有同样的问题。尝试 sudo chmoding 文件：

sudo chmod 777 shoes2.run

然后尝试将其作为脚本运行

./shoes2.run

那应该工作。

我仍在尝试让 shoes2 进入我的路径，这样我就可以像以前的版本（我通过 apt-get 获得）一样轻松地运行它，现在我每次使用它时都必须将它作为脚本运行。

祝你好运！

# .net - 使用“Add-in Express”工具简化 MS Office 插件开发的经验？

> ID：682401
> 
> 赞同：1
> 
> 时间：2009-03-25T16:34:58.827
> 
> 标签：.net, ms-office, add-in

任何人都可以分享有关此工具的任何经验吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T16:43:13.020

这是节省时间的好方法。他们已经解决了一些问题，如果您选择不使用它们，您可能必须自己解决这些问题。您可能知道的加载项问题充其量只能是拳头重击。

我使用了一段时间的 Add-in Express，但最终使用了我自己的基于[COM shim](http://msdn.microsoft.com/en-us/library/aa159894(office.11).aspx)的加载项代码。我需要更多关于注册过程中发生的事情的信息（因为它在高度安全的环境中失败了）。那是我转行的唯一原因。对产品和支持非常满意。正如孩子们现在所说的那样，只需要“更接近金属”。

# windows - 如何检测打开文件句柄的文件是否已在 Windows 上使用 Perl 删除？

> ID：682404
> 
> 赞同：3
> 
> 时间：2009-03-25T16:35:20.213
> 
> 标签：windows, perl, filesystems

我有一个打开文件句柄的进程。我需要检测这个文件是否被另一个进程删除（可能有一个同名的文件在它的位置）。在 UNIX 上，我通过 stat 比较了文件句柄的 inode 和文件路径，但这在 Win32 上不起作用。我怎样才能在 Perl 中做到这一点？

谢谢，
-彼得

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-25T17:19:54.960

我可能弄错了（我不是 Windows 程序员），但我认为文件在 Win32 中打开时无法删除或替换，或者至少默认情况下是不可能的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T19:36:18.877

这是一个很难解决的问题，尤其是在 Windows 和 Unix 中。

让我们备份。您为什么要尝试检测文件是否已被替换？我的猜测是你有某种竞争条件，两个程序都试图写入同一个文件。也许文件锁定在这里会有所帮助？还是使用真实的数据库？想到 SQLite 和 Berkley DB。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T17:08:06.797

我会尝试比较大小、mtime 和 atime；对于那些相同的东西来说应该是非常困难的（除非废话，比如，win32上的文件句柄上的stat为您提供文件系统中当前文件的信息，无论您的文件句柄是否在已删除的实例上）。如果您的文件有可能在给定的秒内被多次删除并替换为相同的文件，并且您必须检测到这一点，那么您可能必须采用架构解决方案，例如使用文件的编号版本或其他东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T17:34:42.273

查看 Win32::ChangeNotify 包以注册文件或目录的更改通知。也可以通过 Win32API::File 包打开文件，这样当你打开它时它就不能被删除（特别是参见 createFile() 和 OsFHandleOpen()，以及 MSDN 上的 CreateFile() 文档）。

# asp.net-mvc - ASP.NET MVC 的模型设计建议

> ID：682426
> 
> 赞同：2
> 
> 时间：2009-03-25T16:46:16.647
> 
> 标签：asp.net-mvc, database, data-modeling

我目前正在将一些小型个人网站从 WebForms 转换为 MVC。对于现有站点，数据库架构是可靠的，但我从未真正花时间构建适当的数据/业务模型/层。aspx 页面都使用各种视图和存储过程直接与数据库对话，这些视图和存储过程是为方便起见而根据需要创建的。使用 MVC，我现在正尝试按照他们所说的那样“做正确的事”，并使用 LINQ to SQL 和/或实体框架之类的东西来为应用程序构建一个或多个适当的数据模型。

我的问题围绕着构建数据模型应该有什么目标。我阅读了各种与模式相关的文章，我意识到最终答案可能取决于我的数据的特征。但通常我是否应该尝试构建包含尽可能多的数据库的更大模型，以便只有一种方式与给定的表集交互？或者我应该为每个 MVC 视图构建更小的自定义模型，只包含视图需要的数据和访问权限？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T17:00:17.847

> 或者我应该为每个 MVC 视图构建更小的自定义模型，只包含视图需要的数据和访问权限？

这可能会更好。

不要忘记，您可以将模型固定在层次结构中，因此每个模型中都可以存在公共属性，例如 id、名称、偏好。

胖扩展模型可能更适合企业应用程序，其中框架会根据预加载的用户偏好、用户角色、访问权限等自动做很多事情。对于小型个人项目，尝试保持模型小而干净可能会更好。这也是一种保护。通过不将不必要的数据放入模型中，您可以确保您的视图不会错误地显示错误的条目，或者提交表单不会错误地覆盖其他一些数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T16:58:26.523

我会选择代表当前系统中实际数据逻辑的模型，并让您的控制器返回视图需要的模型部分，例如：

控制器：

```
public ActionResult index()
{
    var ListOfObjects = DataHelper.GetAll();
    ViewData.Add(ListOfObjects);
    return View();
}

public ActionResult ViewObject(int id)
{
    var Object= DataHelper.GetObject();
    ViewData.Add(Object);
    return View();
}

public ActionResult ViewObjectChild(int Objectid, int ChildId)
{
    var Child= DataHelper.GetChildObject(Objectid, ChildId);
    ViewData.Add(Child);
    return View();
} 
```

在视图上

/

```
<%  var myListOfObjects = ViewData.Get<IList<Object>>(); %> 
```

/ViewObject/1/

```
<%  var myobject= ViewData.Get<Object>(); %> 
```

/ViewChild/1/1/

```
<%  var myChild = ViewData.Get<Child>(); %> 
```

注意我使用了 MVC Contrib 类型的函数，我强烈推荐这些。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T17:09:11.413

通常，您将拥有一个用于数据库的综合领域模型。您可以在服务层或控制器中使用（修改/添加/删除/等）域模型，如果它是一个小应用程序。

但是，对于您的视图，您可以使用演示对象使视图更易于维护。这些有时也称为 DTO 或视图模型对象。基本上，您所做的是创建一个对象，该对象包含模型中填充视图所需的所有数据。

例如：

您的模型可能包括：

```
public class Car() 
{
  public string Model;
}

public class Driver()
{
  public string Name;
} 
```

您希望视图输出汽车的名称和型号，并且您必须将 Car 和 Driver 模型对象都传递给视图。

您可以创建一个仅包含您需要的数据的对象，而不是将两个模型对象直接从控制器发送到视图：

```
public class CarAndDriverViewModel()
{
  public string CarMake;
  public string DriverName;
} 
```

您将从域数据中填充此对象并将其传递给视图。观点是：

```
model.DriverName + ": " + model.CarMake 
```

现在您不必担心延迟加载问题或复杂的视图逻辑来处理模型特性。创建这些视图模型对象需要做更多的工作，但它们确实有助于保持视图清洁，并提供了一种在将数据发送到视图之前进行格式化的简单方法。

如果您想研究它们，可以使用一些项目和约定来帮助自动创建视图模型。[AutoMapper](http://automapper.codeplex.com/)就是一个例子。

# version-control - 如何使用 Starteam vcmutility 自动执行选择性变基？

> ID：682427
> 
> 赞同：2
> 
> 时间：2009-03-25T16:46:18.207
> 
> 标签：version-control, rebase, starteam

在 Borland Starteam 中，我想自动化一个非常简单的 rebase，它只 repins 文件（即忽略其他所有内容 - 假设使用向导完成）。

查看 StarTeam 帮助“VCMUtility 会话选项”，我想将我的 DefaultAction 设置为忽略所有内容——除了 source.modified 应该是 repin。我没有看到一种明显的方法来覆盖所有（因为这是列出所有组合的联合不是一个选项）。

有没有人有任何示例配置文件？或者有使用 StarTeam 执行此操作的经验？

# .net - 如何在实体框架中查询空值？

> ID：682429
> 
> 赞同：109
> 
> 时间：2009-03-25T16:46:24.290
> 
> 标签：.net, entity-framework, ado.net

我想执行这样的查询

```
 var result = from entry in table
                     where entry.something == null
                     select entry; 
```

并得到一个`IS NULL`生成的。

编辑：在前两个答案之后，我觉得有必要澄清我使用的是实体框架而不是 Linq to SQL。object.Equals() 方法似乎在 EF 中不起作用。

编辑 2：上述查询按预期工作。它正确生成`IS NULL`. 然而，我的生产代码是

```
value = null;
var result = from entry in table
                         where entry.something == value
                         select entry; 
```

生成的 SQL 是`something = @p; @p = NULL`. 似乎 EF 正确翻译了常量表达式，但如果涉及变量，它会将其视为普通比较。其实有道理。我将关闭这个问题。

* * *

## 回答 #1

> 赞同：125
> 
> 时间：2010-03-29T20:28:41.813

Linq-to-SQL 的解决方法：

```
var result = from entry in table
             where entry.something.Equals(value)
             select entry; 
```

Linq-to-Entities 的解决方法（哎哟！）：

```
var result = from entry in table
             where (value == null ? entry.something == null : entry.something == value)
             select entry; 
```

这是一个讨厌的虫子，已经咬了我好几次。 ~~如果此错误也影响了您，请访问[UserVoice 上的错误报告](http://data.uservoice.com/forums/72025-ado-net-entity-framework-ef-feature-suggestions/suggestions/1015361-incorrect-handling-of-null-variables-in-where-cl?ref=title)并让 Microsoft 知道此错误也影响了您。~~

* * *

**编辑：** [此错误正在 EF 4.5 中修复](http://data.uservoice.com/forums/72025-ado-net-entity-framework-ef-feature-suggestions/suggestions/1015361-incorrect-handling-of-null-variables-in-where-cl?ref=title#suggestion-1015361)！感谢大家支持这个错误！

为了向后兼容，它将是可选的 - 您需要手动启用设置才能`entry == value`正常工作。目前还没有关于这个设置是什么的消息。敬请关注！

* * *

**编辑 2：** 根据EF 团队的[这篇文章，](http://data.uservoice.com/forums/72025-entity-framework-feature-suggestions/suggestions/1015361-incorrect-handling-of-null-variables-in-where-cl)**此问题已在 EF6 中修复！呜呼！**

> 我们更改了 EF6 的默认行为以补偿三值逻辑。

这意味着依赖旧行为的现有代码*（`null != null`，但仅在与变量进行比较时）*将需要更改为不依赖该行为，或者设置[`UseCSharpNullComparisonBehavior`](http://msdn.microsoft.com/en-us/library/system.data.objects.objectcontextoptions.usecsharpnullcomparisonbehavior.aspx)为 false 以使用旧的损坏行为。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-03-19T15:37:39.923

从 Entity Framework 5.0 开始，您可以使用以下代码来解决您的问题：

```
public abstract class YourContext : DbContext
{
  public YourContext()
  {
    (this as IObjectContextAdapter).ObjectContext.ContextOptions.UseCSharpNullComparisonBehavior = true;
  }
} 
```

这应该可以解决您的问题，因为 Entity Framerwork 将使用“C#like”空比较。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2010-11-24T01:08:41.667

有一个更简单的解决方法适用于 LINQ to Entities：

```
var result = from entry in table
         where entry.something == value || (value == null && entry.something == null)
         select entry; 
```

正如 AZ 所注意到的，这是因为 LINQ to Entities 特殊情况 x == null（即与 null 常量的相等比较）并将其转换为 x IS NULL。

我们目前正在考虑更改此行为以在等式两边都可为空的情况下自动引入补偿比较。但是有几个挑战：

1.  这可能会破坏已经依赖于现有行为的代码。
2.  即使很少使用空参数，新的翻译也可能会影响现有查询的性能。

在任何情况下，我们是否开始着手这方面的工作将在很大程度上取决于我们的客户分配给它的相对优先级。如果您关心这个问题，我鼓励您在我们的新功能建议网站上投票：[https](https://data.uservoice.com) ://data.uservoice.com 。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-03-26T11:33:32.427

如果它是可空类型，也许尝试使用 HasValue 属性？

```
var result = from entry in table
                 where !entry.something.HasValue
                 select entry; 
```

不过这里没有要测试的 EF ......只是一个建议 =)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-25T16:52:44.387

```
var result = from entry in table
             where entry.something.Equals(null)
             select entry; 
```

**MSDN 参考**：[LINQ to SQL：关系数据的 .NET 语言集成查询](http://msdn.microsoft.com/en-us/library/bb425822.aspx)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-03-25T16:58:52.250

处理空比较使用`Object.Equals()`而不是`==`

检查此[参考](http://social.msdn.microsoft.com/Forums/en-US/linqtosql/thread/5d21e48c-b1cb-424d-b146-6c2f064df40d/)

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2015-01-15T22:34:56.953

指出所有 Entity Framework < 6.0 的建议都会产生一些尴尬的 SQL。请参阅“干净”修复的第二个示例。

## 荒谬的解决方法

```
// comparing against this...
Foo item = ...

return DataModel.Foos.FirstOrDefault(o =>
    o.ProductID == item.ProductID
    // ridiculous < EF 4.5 nullable comparison workaround http://stackoverflow.com/a/2541042/1037948
    && item.ProductStyleID.HasValue ? o.ProductStyleID == item.ProductStyleID : o.ProductStyleID == null
    && item.MountingID.HasValue ? o.MountingID == item.MountingID : o.MountingID == null
    && item.FrameID.HasValue ? o.FrameID == item.FrameID : o.FrameID == null
    && o.Width == w
    && o.Height == h
    ); 
```

导致 SQL 如下：

```
SELECT TOP (1) [Extent1].[ID]                 AS [ID],
       [Extent1].[Name]               AS [Name],
       [Extent1].[DisplayName]        AS [DisplayName],
       [Extent1].[ProductID]          AS [ProductID],
       [Extent1].[ProductStyleID]     AS [ProductStyleID],
       [Extent1].[MountingID]         AS [MountingID],
       [Extent1].[Width]              AS [Width],
       [Extent1].[Height]             AS [Height],
       [Extent1].[FrameID]            AS [FrameID],
FROM   [dbo].[Foos] AS [Extent1]
WHERE  (CASE
  WHEN (([Extent1].[ProductID] = 1 /* @p__linq__0 */)
        AND (NULL /* @p__linq__1 */ IS NOT NULL)) THEN
    CASE
      WHEN ([Extent1].[ProductStyleID] = NULL /* @p__linq__2 */) THEN cast(1 as bit)
      WHEN ([Extent1].[ProductStyleID] <> NULL /* @p__linq__2 */) THEN cast(0 as bit)
    END
  WHEN (([Extent1].[ProductStyleID] IS NULL)
        AND (2 /* @p__linq__3 */ IS NOT NULL)) THEN
    CASE
      WHEN ([Extent1].[MountingID] = 2 /* @p__linq__4 */) THEN cast(1 as bit)
      WHEN ([Extent1].[MountingID] <> 2 /* @p__linq__4 */) THEN cast(0 as bit)
    END
  WHEN (([Extent1].[MountingID] IS NULL)
        AND (NULL /* @p__linq__5 */ IS NOT NULL)) THEN
    CASE
      WHEN ([Extent1].[FrameID] = NULL /* @p__linq__6 */) THEN cast(1 as bit)
      WHEN ([Extent1].[FrameID] <> NULL /* @p__linq__6 */) THEN cast(0 as bit)
    END
  WHEN (([Extent1].[FrameID] IS NULL)
        AND ([Extent1].[Width] = 20 /* @p__linq__7 */)
        AND ([Extent1].[Height] = 16 /* @p__linq__8 */)) THEN cast(1 as bit)
  WHEN (NOT (([Extent1].[FrameID] IS NULL)
             AND ([Extent1].[Width] = 20 /* @p__linq__7 */)
             AND ([Extent1].[Height] = 16 /* @p__linq__8 */))) THEN cast(0 as bit)
END) = 1 
```

* * *

## 离谱的解决方法

如果你想生成更干净的 SQL，比如：

```
// outrageous < EF 4.5 nullable comparison workaround http://stackoverflow.com/a/2541042/1037948
Expression<Func<Foo, bool>> filterProductStyle, filterMounting, filterFrame;
if(item.ProductStyleID.HasValue) filterProductStyle = o => o.ProductStyleID == item.ProductStyleID;
else filterProductStyle = o => o.ProductStyleID == null;

if (item.MountingID.HasValue) filterMounting = o => o.MountingID == item.MountingID;
else filterMounting = o => o.MountingID == null;

if (item.FrameID.HasValue) filterFrame = o => o.FrameID == item.FrameID;
else filterFrame = o => o.FrameID == null;

return DataModel.Foos.Where(o =>
    o.ProductID == item.ProductID
    && o.Width == w
    && o.Height == h
    )
    // continue the outrageous workaround for proper sql
    .Where(filterProductStyle)
    .Where(filterMounting)
    .Where(filterFrame)
    .FirstOrDefault()
    ; 
```

首先得到你想要的结果：

```
SELECT TOP (1) [Extent1].[ID]                 AS [ID],
           [Extent1].[Name]               AS [Name],
           [Extent1].[DisplayName]        AS [DisplayName],
           [Extent1].[ProductID]          AS [ProductID],
           [Extent1].[ProductStyleID]     AS [ProductStyleID],
           [Extent1].[MountingID]         AS [MountingID],
           [Extent1].[Width]              AS [Width],
           [Extent1].[Height]             AS [Height],
           [Extent1].[FrameID]            AS [FrameID],
FROM   [dbo].[Foos] AS [Extent1]
WHERE  ([Extent1].[ProductID] = 1 /* @p__linq__0 */)
   AND ([Extent1].[Width] = 16 /* @p__linq__1 */)
   AND ([Extent1].[Height] = 20 /* @p__linq__2 */)
   AND ([Extent1].[ProductStyleID] IS NULL)
   AND ([Extent1].[MountingID] = 2 /* @p__linq__3 */)
   AND ([Extent1].[FrameID] IS NULL) 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-12-24T10:24:03.937

```
var result = from entry in table
                     where entry.something == null
                     select entry; 
```

上述查询按预期工作。它正确生成 IS NULL。然而，我的生产代码是

```
var value = null;
var result = from entry in table
                         where entry.something == value
                         select entry; 
```

生成的 SQL 是 something = @p; @p = 空。似乎 EF 正确翻译了常量表达式，但如果涉及变量，它会将其视为普通比较。其实有道理。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-20T05:33:03.357

看来 Linq2Sql 也有这个“问题”。由于 ANSI NULL 是 ON 还是 OFF，这种行为似乎是有正当理由的，但令人难以置信的是，为什么直接的“== null”实际上会按您的预期工作。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-09-23T15:07:20.300

就个人而言，我更喜欢：

```
var result = from entry in table    
             where (entry.something??0)==(value??0)                    
              select entry; 
```

超过

```
var result = from entry in table
             where (value == null ? entry.something == null : entry.something == value)
             select entry; 
```

因为它可以防止重复——尽管这在数学上并不精确，但它非常适合大多数情况。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-12-07T19:06:04.953

我无法评论 diega 的帖子，但在这里介绍的不同解决方案中，divega 的解决方案产生了最好的 SQL。无论是性能还是长度。我刚刚检查了 SQL Server Profiler 并查看了执行计划（使用“SET STATISTICS PROFILE ON”）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-11-28T14:25:03.093

不幸的是，在 Entity Framework 5 DbContext 中，该问题仍未解决。

我使用了这个解决方法（适用于 MSSQL 2012，但 ANSI NULLS 设置可能在任何未来的 MSSQL 版本中被弃用）。

```
public class Context : DbContext
{

    public Context()
        : base("name=Context")
    {
        this.Database.Connection.StateChange += Connection_StateChange;
    }

    void Connection_StateChange(object sender, System.Data.StateChangeEventArgs e)
    {
        // Set ANSI_NULLS OFF when any connection is opened. This is needed because of a bug in Entity Framework
        // that is not fixed in EF 5 when using DbContext.
        if (e.CurrentState == System.Data.ConnectionState.Open)
        {
            var connection = (System.Data.Common.DbConnection)sender;
            using (var cmd = connection.CreateCommand())
            {
                cmd.CommandText = "SET ANSI_NULLS OFF";
                cmd.ExecuteNonQuery();
            }
        }
    }
} 
```

应该注意的是，这是一种肮脏的解决方法，但它可以非常快速地实现并且适用于所有查询。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-05-04T17:17:15.940

如果你喜欢像我一样使用方法 (lambda) 语法，你可以这样做：

```
var result = new TableName();

using(var db = new EFObjectContext)
{
    var query = db.TableName;

    query = value1 == null 
        ? query.Where(tbl => tbl.entry1 == null) 
        : query.Where(tbl => tbl.entry1 == value1);

    query = value2 == null 
        ? query.Where(tbl => tbl.entry2 == null) 
        : query.Where(tbl => tbl.entry2 == value2);

    result = query
        .Select(tbl => tbl)
        .FirstOrDefault();

   // Inspect the value of the trace variable below to see the sql generated by EF
   var trace = ((ObjectQuery<REF_EQUIPMENT>) query).ToTraceString();

}

return result; 
```

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2011-02-04T08:30:42.710

```
var result = from entry in table    
             where entry.something == value||entry.something == null                   
              select entry; 
```

用那个

# c - 在 Cyrus SASL 中使用 EXTERNAL 机制

> ID：682431
> 
> 赞同：2
> 
> 时间：2009-03-25T16:46:54.087
> 
> 标签：c, authentication, sasl, cyrus

Cyrus SASL api 不支持 EXTERNAL 机制吗？我正在尝试将其用作客户端，但`SASL_NOMECH`在询问时它会返回。

```
% cat cyrus_sal_ex.c
/* cyrus_sasl_ex.c: Example of using the Cyrus SASL api */
#include <stdio.h>      /* for printf() */
#include <sasl/sasl.h>  /* for sasl_client_*(), SASL_*, sasl_*_t */

static char const * SASL_return_code(int const code) 
{
  switch(code) 
  {
    /* ... */
    case SASL_OK:     return "SASL_OK[0]: successful result";
    /* ... */
    case SASL_NOMECH: return "SASL_NOMECH[-4]: mechanism not supported";
    /* ... */
  }
  return "unrecognized";
}

int main()
{
  char const *  output = NULL;
  unsigned      outlen = 0;
  char const *  mechanism = NULL;
  sasl_conn_t * conn;

# define PRINT_RESULT( x ) do\
  {\
    int const __result = (x);\
    printf("%s == %d\n\t%s\n", #x, __result, SASL_return_code(__result));\
    if (__result < 0) goto done;\
  }\
  while (0)

  PRINT_RESULT( sasl_client_init( NULL ) );
  PRINT_RESULT( sasl_client_new( "fake", "fakey.mcfaker.ton", "127.0.0.1", "127.255.255.1", NULL, 0, &conn) );
  PRINT_RESULT( sasl_client_start( conn, "EXTERNAL", NULL, &output, &outlen, &mechanism) );

done:
# undef PRINT_RESULT
  printf("output: [%d bytes] : %s\n", outlen, (output ? output : "NULL") );
  printf("mechanism: %s\n", (mechanism ? mechanism : "NULL"));

  return 0;
}
% gcc -I/sw/include -L/sw/lib -lsasl2 cyrus_sasl_ex.c -o cyrus_sasl_ex # your header/library locations may vary
% ./cyrus_sasl_ex
sasl_client_init( NULL ) == 0
        SASL_OK[0]: successful result
sasl_client_new( "fake", "fakey.mcfaker.ton", "127.0.0.1", "127.255.255.1", NULL, 0, &conn) == 0
        SASL_OK[0]: successful result
sasl_client_start( conn, "EXTERNAL", NULL, &output, &outlen, &mechanism) == -4
        SASL_NOMECH[-4]: mechanism not supported
output: [0 bytes] : NULL
mechanism: EXTERNAL
% 
```

不过，我浏览了[源代码](http://asg.web.cmu.edu/sasl/sasl-library.html)，看起来所有客户端都应该支持 EXTERNAL 机制：

```
cyrus-sasl-2.1.22/lib/client.c:
196 int sasl_client_init(const sasl_callback_t *callbacks)
197 {
...
227
228   sasl_client_add_plugin("EXTERNAL", &external_client_plug_init);
229 
```

所以我猜我在这里做错了什么。我尝试将所有`sasl_callback_t`我能想到的 s 添加到`sasl_client_*()`，但没有一个被调用。是否有一些我应该通过的论点断言 EXTERNAL 是一种可接受的机制？或者 SASL_NOMECH 是否总是为 EXTERNAL 返回 - b/c 似乎不正确。

谁能帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T20:59:34.743

好的，我找到了遗漏的步骤。

根据`sasl/sasl.h`，我需要`SASL_AUTH_EXTERNAL`为我的第一个设置属性`sasl_conn_t`：

```
/* set property in SASL connection state
 * returns:
 *  SASL_OK       -- value set
 *  SASL_BADPARAM -- invalid property or value
 */
LIBSASL_API int sasl_setprop(sasl_conn_t *conn,
                 int propnum,
                 const void *value);
#define SASL_SSF_EXTERNAL  100  /* external SSF active (sasl_ssf_t *) */
#define SASL_SEC_PROPS     101  /* sasl_security_properties_t */
#define SASL_AUTH_EXTERNAL 102  /* external authentication ID (const char *) */

/* If the SASL_AUTH_EXTERNAL value is non-NULL, then a special version of the
 * EXTERNAL mechanism is enabled (one for server-embedded EXTERNAL mechanisms).
 * Otherwise, the EXTERNAL mechanism will be absent unless a plug-in
 * including EXTERNAL is present.
 */ 
```

一旦我这样做了，剩下的就解决了：

```
% cat cyrus_sasl_ex.c
/* Example of using the Cyrus SASL api */
#include <stdio.h>          /* for printf() */
#include <sasl/sasl.h>  /* for sasl_client_*(), SASL_*, sasl_*_t */

int main()
{
    char const *    output = NULL;
    unsigned            outlen = 0;
    char const *    mechanism = NULL;
    sasl_conn_t * conn;

#   define PRINT_RESULT( x ) do\
    {\
        int const __result = (x);\
        printf("%s == %d\n\t%s\n", #x, __result, sasl_errstring(__result,NULL,NULL));\
        if (__result < 0) goto done;\
    }\
    while (0)

    PRINT_RESULT( sasl_client_init( NULL ) );
    PRINT_RESULT( sasl_client_new( "fake", "fakey.mcfaker.ton", "127.0.0.1", "127.255.255.1", NULL, 0, &conn) );
    PRINT_RESULT( sasl_setprop( conn, SASL_AUTH_EXTERNAL, "fake authority" ) );
    PRINT_RESULT( sasl_client_start( conn, "EXTERNAL", NULL, &output, &outlen, &mechanism) );

done:
#   undef PRINT_RESULT
    printf("output: [%d bytes] : %s\n", outlen, (output ? output : "NULL") );
    printf("mechanism: %s\n", (mechanism ? mechanism : "NULL"));

    return 0;
}
% gcc -I/sw/include -L/sw/lib -lsasl2 cyrus_sasl_ex.c -o cyrus_sasl_ex
% ./cyrus_sasl_ex
sasl_client_init( NULL ) == 0
        successful result
sasl_client_new( "fake", "fakey.mcfaker.ton", "127.0.0.1", "127.255.255.1", NULL, 0, &conn) == 0
        successful result
sasl_setprop( conn, SASL_AUTH_EXTERNAL, "fake authority" ) == 0
        successful result
sasl_client_start( conn, "EXTERNAL", NULL, &output, &outlen, &mechanism) == 0
        successful result
output: [0 bytes] :
mechanism: EXTERNAL 
```

但是，由于预装在 OS X 10.5 上的 Cyrus SASL 版本中存在一个错误，导致外部插件需要`SASL_CB_USER`回调并将其传递给 NULL 指针以存储其返回值，这仍然意味着我将拥有在所有这些机器上更新 Cyrus SASL。

或者也许我会围绕这个错误编写代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T00:00:00.340

这是因为 Cyrus SASL 是在没有任何机制的情况下编译的（默认情况下假定它们是动态链接的）。因此，如果没有动态链接机制，它将报告没有匹配机制。

因此，更好的答案是使用静态链接的机制（在 Cyrus 包中称为插件）重新编译 Cyrus SASL。如果您查看 config.h 标头并将相应的静态定义 #define 为 1 然后重新编译（我手动将插件目录中的插件源添加到 libsasl2.a 存档）。然后，当您链接此库时，您将不会收到该错误（没有您找到的解决方法）。

# c++ - VC++ 资源文件和冗长的字符串资源

> ID：682432
> 
> 赞同：2
> 
> 时间：2009-03-25T16:47:12.620
> 
> 标签：c++, resources

在我们的应用程序中，我们的资源字符串对于编译器来说显然太长了。构建中断，说明“行长度太长”。我几乎没有找到关于冗长字符串资源主题的信息，甚至很难找到此类资源字符串的限制。最终我发现这篇文章给出了限制：[MSDN](http://msdn.microsoft.com/en-us/library/cc194808.aspx)。

你有过限制字符串资源的经验吗？
有什么方法可以在不进行任何编码的情况下连接这些？

任何其他建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T16:57:16.417

我会看看`RCDATA`资源。我用它在我的应用程序中存储大型文本文件。

**编辑：**这是我的 MFC 代码，它应该能给你一些指示。

```
CString CWSApplication::LoadTextResource(UINT nID)
{
    HRSRC hResInfo;
    HGLOBAL hResData;
    hResInfo = ::FindResource(AfxGetResourceHandle(),
                              MAKEINTRESOURCE(nID),
                              RT_RCDATA);

    if ( hResInfo == NULL )
    {
        return CString();
    }

    hResData = ::LoadResource(NULL, hResInfo);

    if ( hResData == NULL )
    {
        return CString();
    }

    char *data = (char*)(::LockResource(hResData));
    DWORD len = ::SizeofResource(NULL, hResInfo);
    return CString(data, len);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-28T07:44:56.707

字符串资源旨在存储本质上与 UI 相关的资源和要显示给用户的消息；这样，应用程序可以国际化，从一个包含语言 A 字符串的 DLL 切换到另一个包含另一种语言 B 的相同字符串 ID 的 DLL。我建议查看您使用字符串资源的目的。如果您打算存储大量数据，请使用 RC 中的自定义二进制资源。稍后您可以根据需要对其进行解释。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T14:35:49.987

您可以将文本文件嵌入到资源中，加载它并在 CString 中使用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-04T19:31:31.687

您需要使用自定义数据 (RCDATA) 来避免此类限制。基本上，通过使用二进制字段，编译器会单独留下您的数据，并且不会尝试“按摩”它。另一方面，如果您有字符串资源，它们可能会被合并（以节省空间，如果您设置了该编译器选项）并且通常存储在图像的特殊部分中。所以你想避免所有这些并告诉编译器“只存储”你的数据。使用 RCDATA，您已经有示例代码来提取它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-06T04:03:23.930

您不能使用资源文件来存储冗长的字符串。

相反，您可以将所有巨大的字符串放入一个 XML 文件中，并在需要时读取该字符串。如果您想要 NLS 支持，您还可以拥有特定于语言的文件。

# c++ - 这两个类有什么区别？

> ID：682434
> 
> 赞同：2
> 
> 时间：2009-03-25T16:47:23.010
> 
> 标签：c++, memory

下面，我*没有*声明`my_ints`为指针。我不知道内存将分配到哪里。请在这里教育我！

```
#include <iostream>
#include <vector>

class FieldStorage
{
private:
    std::vector<int> my_ints;

public:
    FieldStorage()
    {
        my_ints.push_back(1);
        my_ints.push_back(2);
    }

    void displayAll()
    {
        for (int i = 0; i < my_ints.size(); i++)
        {
            std::cout << my_ints[i] << std::endl;
        }
    }
}; 
```

在这里，我将该字段声明`my_ints`为指针：

```
#include <iostream>
#include <vector>

class FieldStorage
{
private:
    std::vector<int> *my_ints;

public:
    FieldStorage()
    {
        my_ints = new std::vector<int>();
        my_ints->push_back(1);
        my_ints->push_back(2);
    }

    void displayAll()
    {
        for (int i = 0; i < my_ints->size(); i++)
        {
            std::cout << (*my_ints)[i] << std::endl;
        }
    }

    ~FieldStorage()
    {
        delete my_ints;
    }
}; 
```

`main()`要测试的功能：

```
int main()
{
    FieldStorage obj;
    obj.displayAll();
    return 0;
} 
```

它们都产生相同的结果。有什么不同？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-25T17:05:25.323

在内存管理方面，这两个类实际上是相同的。其他几位响应者认为两者之间的区别在于，一个在堆栈上分配存储，另一个在堆上分配，但这不一定是真的，即使在它是真的情况下，它也是非常误导的。实际上，不同之处在于分配*元数据*的位置。`vector`无论如何，实际的底层存储`vector`都是从堆中分配的。

看到这个有点棘手，因为您正在使用`std::vector`，因此隐藏了具体的实现细节。但基本上，`std::vector`是这样实现的：

```
template <class T>
class vector {
public:
    vector() : mCapacity(0), mSize(0), mData(0) { }
    ~vector() { if (mData) delete[] mData; }
    ...
protected:
    int mCapacity;
    int mSize;
    T *mData;
}; 
```

如您所见，`vector`该类本身只有几个成员——容量、大小和指向动态分配的内存块的指针，该内存块将存储向量的实际内容。

在您的示例中，唯一的区别是这几个字段的存储来自哪里。在第一个示例中，存储是从您用于包含类的任何存储中分配的——如果它是堆分配的，那么`vector`. 如果您的容器是堆栈分配的，那么`vector`.

在第二个示例中，这些位`vector`始终是堆分配的。

在这两个例子中，实际*的*内容`vector`——它的内容——是从堆中分配的，你不能改变它。

其他人都已经指出，您在第二个示例中存在内存泄漏，这也是正确的。确保删除容器类的析构函数中的向量。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-25T16:48:54.177

在 FieldStorage 析构函数的第二种情况下，您必须释放（以防止内存泄漏）为向量分配的内存。

```
FieldStorage::~FieldStorage()
{
    delete my_ints;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-25T16:52:35.180

正如 Mykola Golubyev 指出的那样，您需要在第二种情况下删除向量。

第一个可能会构建更快的代码，因为优化器*知道*FieldStorage 的完整大小，包括向量，并且可以在一次分配中为两者分配足够的内存。

您的第二个实现需要两个单独的分配来构造对象。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-25T16:54:51.807

我认为您确实在寻找[Stack 和 Heap](https://stackoverflow.com/questions/79923/what-and-where-are-the-stack-and-heap)之间的区别。

第一个分配在堆栈上，而第二个分配在堆上。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-25T16:51:07.807

在第一个示例中，对象是在堆栈上分配的。

第二个例子，对象在堆中分配，指向该内存的指针存储在栈中。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-25T16:49:58.370

第一种方法是首选方法，您不需要向量上的指针并且忘记删除它。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-25T16:53:44.570

不同之处在于第二个动态分配向量。几乎没有区别：

*   您必须释放向量对象占用的内存（向量对象本身，而不是保存在向量中的对象，因为它已被向量正确处理）。您应该使用一些智能指针来保留向量或制作（例如在析构函数中）：

    删除我的整数；

*   第一个可能更有效，因为对象是在堆栈上分配的。

*   访问向量的方法有不同的语法:)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-25T16:58:28.677

FieldStorage 的第一个版本包含一个向量。FieldStorage 类的大小包括足够的字节来保存一个向量。当你构造一个 FieldStorage 时，向量是在 FieldStorage 的构造函数体执行之前构造的。当 FieldStorage 被破坏时，向量也会被破坏。

这并不一定要在栈上分配向量；如果您堆分配 FieldStorage 对象，则向量的空间来自该堆分配，而不是堆栈。如果您定义一个全局 FieldStorage 对象，那么向量的空间既不是来自堆栈也不是来自堆，而是来自为全局对象指定的空间（例如某些平台上的`.data`or`.bss`部分）。

请注意，向量执行堆分配以保存实际数据，因此它可能只包含几个指针，或者一个指针和几个长度，但它可能包含编译器的 STL 实现所需的任何内容。

FieldStorage 的第二个版本包含一个指向向量的指针。FieldStorage 类的大小包括指向向量的指针的空间，而不是实际向量。您在 FieldStorage 的构造函数主体中使用 new 为向量分配存储空间，并且在 FieldStorage 被破坏时泄漏该存储空间，因为您没有定义删除向量的析构函数。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-25T16:54:05.847

在第一种情况下，std::vector 被直接放入你的类中（它正在处理任何内存分配和释放，它需要增长和缩小向量并在你的对象被销毁时释放内存；它正在抽象内存由您管理，这样您就不必处理它）。在第二种情况下，您在某处显式地为堆中的 std::vector 分配存储，并且忘记删除它，因此您的程序将泄漏内存。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-25T17:04:54.560

对象的大小会有所不同。在第二种情况下， Vector<>* 只占用指针的大小（在 32 位机器上为 4 字节）。在第一种情况下，您的对象会更大。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-25T17:22:42.830

一个实际的区别是，在您的第二个示例中，您永远不会释放向量的内存或其内容（因为您不删除它，因此调用它的析构函数）。

但是第一个示例将在销毁 FieldStorage 对象时自动销毁向量（并释放其内容）。

# hash - 哈希函数提供来自整数坐标对的唯一 uint

> ID：682438
> 
> 赞同：27
> 
> 时间：2009-03-25T16:49:01.820
> 
> 标签：hash, hashtable

**一般的问题：** 我有一个很大的二维点空间，点点稀疏。把它想象成一块洒满黑点的白色大画布。我必须遍历并搜索这些点很多。Canvas（点空间）可以很大，接近 int 的限制，并且在其中设置点之前它的大小是未知的。

这让我想到了散列：

**理想：** 我需要一个采用 2D 点的散列函数，返回一个唯一的 uint32。这样就不会发生碰撞。*您可以假设 Canvas 上的点数可以通过 uint32 轻松计算。*

**重要提示：**不可能事先知道画布的大小（甚至可能会改变），所以像

画布宽度 * y + x

可悲的是，这是不可能的。

我也试过很幼稚

绝对（x）+绝对（y）

但这会产生太多的碰撞。

**妥协：** 一种散列函数，为键提供*非常*低的冲突概率。

有什么想法吗？谢谢你的帮助。

最好的问候，安德烈亚斯 T。

编辑：我必须更改问题文本中的某些内容：我将假设“能够使用 uint32 计算画布的点数”更改为“能够计算画布上的点数（或要存储的坐标对数”） by uint32\. 我最初的问题没有多大意义，因为我会有一个 sqrt(max(uint32))xsqrt(max(uint32)) 大小的画布，它可以通过 16 位移位和 OR 来唯一地表示。

我希望这没问题，因为所有答案对于更新的假设仍然最有意义

对此感到抱歉。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-03-25T17:28:43.970

康托对数的[枚举](http://en.wikipedia.org/wiki/Cantor_pairing_function#Cantor_pairing_function)

```
 n = ((x + y)*(x + y + 1)/2) + y 
```

可能很有趣，因为它最接近您原来的 canvaswidth * y + x 但适用于任何 x 或 y。但是对于现实世界的 int32 散列，而不是整数对到整数的映射，您可能最好进行一些操作，例如 Bob Jenkin 的[混合](http://burtleburtle.net/bob/hash/doobs.html)并用 x,y 和盐调用它。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-03-25T16:57:00.553

保证无冲突的哈希函数不是哈希函数:)

您可以考虑使用二进制空间分区树 (BSP) 或 XY 树（密切相关），而不是使用散列函数。

如果要将两个 uint32 散列到一个 uint32 中，请不要使用 Y & 0xFFFF 之类的东西，因为这会丢弃一半的位。做类似的事情

```
(x * 0x1f1f1f1f) ^ y 
```

（您需要先转换其中一个变量以确保散列函数不可交换）

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-25T16:56:12.410

`x`与 Emil 类似，但以产生更少冲突的方式处理 16 位溢出，并且需要更少的指令来计算：

```
hash = ( y << 16 ) ^ x; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-09-09T04:24:39.827

您可以递归地将您的 XY 平面划分为单元格，然后将这些单元格划分为子单元格，等等。

Gustavo Niemeyer 于 2008 年发明了他的 Geohash 地理编码系统。

亚马逊的开源**地理库**计算任何经纬度坐标的哈希值。生成的 Geohash 值为 63 位数字。冲突的概率取决于散列的分辨率：如果两个对象比固有分辨率更接近，则计算出的散列将是相同的。

[![在此处输入图像描述](https://i.stack.imgur.com/6duxD.jpg)](https://i.stack.imgur.com/6duxD.jpg)

阅读更多：

[https://en.wikipedia.org/wiki/Geohash](https://en.wikipedia.org/wiki/Geohash) [https://aws.amazon.com/fr/blogs/mobile/geo-library-for-amazon-dynamodb-part-1-table-structure/](https://aws.amazon.com/fr/blogs/mobile/geo-library-for-amazon-dynamodb-part-1-table-structure/) [https:// /github.com/awslabs/dynamodb-geo](https://github.com/awslabs/dynamodb-geo)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-25T18:38:02.073

你的“理想”是不可能的。

您需要一个映射 (x, y) -> i，其中 x、y 和 i 都是 32 位量，保证不会生成 i 的重复值。

原因如下：假设有一个函数 hash() 以便 hash(x, y) 给出不同的整数值。x 有 2^32（约 40 亿）个值，y 有 2^32 个值。所以 hash(x, y) 有 2^64（约 1600 万万亿）个可能的结果。但是 32 位 int 中只有 2^32 个可能的值，因此 hash() 的结果不适合 32 位 int。

另见[http://en.wikipedia.org/wiki/Counting_argument](http://en.wikipedia.org/wiki/Counting_argument)

通常，您应该始终设计数据结构来处理冲突。（除非您的哈希非常长（至少 128 位），非常好（使用加密哈希函数），并且您感觉很幸运）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-25T16:53:33.477

也许？

```
hash = ((y & 0xFFFF) << 16) | (x & 0xFFFF); 
```

只要 x 和 y 可以存储为 16 位整数，就可以工作。不过，不知道这会导致多少次碰撞导致更大的整数。一个想法可能是仍然使用此方案，但将其与压缩方案结合起来，例如取 2^16 的模数。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-08-05T04:59:01.840

如果你能做到 = ((y & 0xffff) << 16) | (x & 0xffff) 然后您可以将可逆的 32 位混合应用于 a，例如 Thomas Wang 的

```
uint32_t hash( uint32_t a)
    a = (a ^ 61) ^ (a >> 16);
    a = a + (a << 3);
    a = a ^ (a >> 4);
    a = a * 0x27d4eb2d;
    a = a ^ (a >> 15);
    return a;
} 
```

这样你就得到了一个看起来随机的结果，而不是一个维度的高位和另一个维度的低位。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-12-27T08:37:11.277

你可以做

```
a >= b ? a * a + a + b : a + b * b 
```

[取自这里](http://szudzik.com/ElegantPairing.pdf)。

这适用于正平面上的点。如果您的坐标也可以在负轴上，那么您将不得不这样做：

```
A = a >= 0 ? 2 * a : -2 * a - 1;
B = b >= 0 ? 2 * b : -2 * b - 1;
A >= B ? A * A + A + B : A + B * B; 
```

但是要将输出限制为`uint`您必须为输入保持上限。如果是这样，那么事实证明你知道界限。换句话说，在编程中编写一个函数而不知道你的输入和输出可以是整数类型是不切实际的，如果是这样，每个整数类型肯定会有一个下限和上限。

```
public uint GetHashCode(whatever a, whatever b)
{
    if (a > ushort.MaxValue || b > ushort.MaxValue || 
        a < ushort.MinValue || b < ushort.MinValue)
    {    
        throw new ArgumentOutOfRangeException();
    }

    return (uint)(a * short.MaxValue + b); //very good space/speed efficiency
    //or whatever your function is.
} 
```

如果您希望输出严格`uint`用于未知范围的输入，那么根据该范围会有合理数量的冲突。我建议的是有一个可以溢出但*未经检查*的功能。Emil 的解决方案很棒，在 C# 中：

```
return unchecked((uint)((a & 0xffff) << 16 | (b & 0xffff))); 
```

请参阅[将两个整数映射为一个，以独特且确定的方式](https://stackoverflow.com/questions/919612/mapping-two-integers-to-one-in-a-unique-and-deterministic-way)获取大量选项。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-08-29T10:18:16.097

根据您的用例，可以使用[四叉树](http://en.wikipedia.org/wiki/Quadtree)并用分支名称字符串替换点。它实际上是点的稀疏表示，并且需要一个自定义的四叉树结构，当您在画布上添加点时通过添加分支来扩展画布，但它可以避免冲突，并且您将获得快速最近邻搜索等好处。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-11-04T08:18:05.997

如果您已经在使用所有对象（甚至像整数这样的原始对象）都已实现内置哈希函数的语言或平台（Java 平台语言，如 Java，.NET 平台语言，如 C#。以及其他如 Python、Ruby 等）。您可以使用内置的散列值作为构建块，并将您的“散列风味”添加到组合中。像：

```
// C# code snippet 
public class SomeVerySimplePoint { 

public int X;
public int Y;

public override int GetHashCode() {
   return ( Y.GetHashCode() << 16 ) ^ X.GetHashCode();
}

} 
```

并且还有像“预定义的百万点集”这样的测试用例针对不同方面的每个可能的哈希生成算法进行比较，比如计算时间、所需内存、键冲突计数和边缘情况（太大或太小值）可能很方便。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-08-26T18:07:00.483

斐波那契散列非常适合整数对

乘数 0x9E3779B9

其他字长 1/phi = (sqrt(5)-1)/2 * 2^w 舍入到奇数

a1 + a2*乘数

这将为靠近的对提供非常不同的值

我不知道所有对的结果

# firefox - 如何防止 Firefox 的自动完成？

> ID：682439
> 
> 赞同：20
> 
> 时间：2009-03-25T16:49:16.140
> 
> 标签：firefox, input, autofill

我们网站的几个部分用户需要输入一些信息，当页面加载时 Firefox 的自动填充会接管 - 大多是错误的！

例如，有一个“传真号码”字段，对于某些用户，Firefox 一直在填写他们的电子邮件地址。如果他们没有看到这个并且他们去提交表单，验证器会向他们抱怨它不是有效的数字格式。

这确实让我们的销售人员担心，因为当他们查看客户页面时，他们有时会看到其中充满了他们自己的个人信息。

有什么办法可以阻止 Firefox 这样做吗？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-03-25T16:52:54.087

将 autocomplete="off" 添加到您的表单标签中，如 Mozilla 文档**[How to Turn Off Form Autocompletion中所述](https://developer.mozilla.org/en/How_to_Turn_Off_Form_Autocompletion#How_to_Turn_Off_the_Autocompletion_Feature)**

```
<form name="form1" id="form1" method="post" autocomplete="off"
  action="http://www.example.com/form.cgi">
[...]
</form> 
```

请阅读有关**[异常和解决方法](https://developer.mozilla.org/En/How_to_Turn_Off_Form_Autocompletion#section_4)**的部分 -如果表单中有名称或地址字段，浏览器将*忽略自动完成属性！*

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-25T16:50:27.463

如果你不关心验证，你可以使用 autocomplete="off"

顺便说一句，这是Mozilla 自己关于自动完成[的一篇很棒的文章](https://developer.mozilla.org/En/How_to_Turn_Off_Form_Autocompletion)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T16:52:24.387

Firefox 通常会根据字段名称自动完成，所以在我看来，您可能对字段名称有一些潜在的混淆。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-07-27T16:28:32.997

我在 Firefox 上遇到了同样的问题，表单具有“用户名”和“密码”字段。在这种情况下， autocomplete="off" 似乎不起作用，如此处所述：[https](https://developer.mozilla.org/en-US/docs/Web/Security/Securing_your_site/Turning_off_form_autocompletion) ://developer.mozilla.org/en-US/docs/Web/Security/Securing_your_site/Turning_off_form_autocompletion （页面底部）。

我发现打开页面时正确知道有空字段的唯一方法是在javascript中清空它们。jQuery 代码示例：

```
setTimeout(function(){
    $('input[name="username"],input[name="password"]').val("");
}, 0); 
```

我知道它很难看（尤其是 setTimeout，但我想不出另一种方法。即使把它放在 $(window).load() 中似乎也不起作用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T16:51:02.097

尝试使用动态输入名称。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-22T03:11:46.357

如果`autocomplete="off"`表单失败，请尝试`autocomplete="off"`直接在输入字段中使用并点击`Ctrl`+ `F5`。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-25T16:54:08.157

实际上，自从几周以来我注意到 Firefox 开始混合自动填充值，下拉列表甚至显示来自不同站点的条目。他们可能在最近的构建中破坏了某些东西。现在，一些个人条目可以被只是要求检查您电脑上的邮件的人看到。想要屏蔽这个功能现在是可以理解的了。

# c++ - 如何找出 Linux 上 C++ 程序的最大内存堆栈大小？（gnu 编译器）

> ID：682444
> 
> 赞同：2
> 
> 时间：2009-03-25T16:50:11.583
> 
> 标签：c++, memory, gnu

我很好奇如何找出特定编译器/操作系统组合的最大堆栈大小。我正在使用 Ubuntu/GNU 编译器。我还有几个问题是：

1.  谁控制默认的最大堆栈大小；操作系统还是编译器？
2.  默认最大值是否根据总内存缩放？（即，具有 2gb 内存的机器比只有 512mb 的机器具有更大的默认大小） 对于此示例，两台机器的操作系统/编译器设置相同，只是系统 RAM 的数量不同。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-25T16:54:30.560

> 谁控制默认的最大堆栈大小；操作系统还是编译器？

编译器通常。操作系统/硬件确实在一定程度上限制了它。Linux IIRC 上的默认值为 8MB。想想`ulimit -s`在 Linux 上（改变堆栈大小）。

> 默认最大值是否根据总内存缩放？（即，具有 2gb 内存的机器比只有 512mb 的机器具有更大的默认大小） 对于此示例，两台机器的操作系统/编译器设置相同，只是系统 RAM 的数量不同。

不，除非你自己做。你可以通过编译器开关改变堆栈大小。

```
ld --stack=<STACK_SIZE> 
```

或者

```
gcc -Wl,--stack=<STACK_SIZE> 
```

> C++ 标准对堆栈和堆问题的看法：

该标准基于抽象机器，并不真正关心硬件或堆栈或堆。它确实谈到了分配的商店和免费的商店。如果您打电话给新的（大部分），免费商店就是您所在的地方。FWIW，当涉及到对象分配时，一个实现只能有一个伪装成堆栈和堆的内存区域。

因此，您的问题归结为特定于实现的问题，而不是语言问题。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T16:53:55.677

在 Linux (Ubuntu) 上，操作系统控制最大大小。请参阅“man limit”或“man ulimit”以供参考。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T16:54:40.277

*如今，正确的问题是：为我的线程*分配了多少内存。 每个线程都会获得一个通常您可以在线程创建时控制的数量。

要回答第 1 部分，编译器/线程系统可以选择，尽管某些操作系统（历史上）有限制。

对于 2，不，它没有缩放。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T16:53:45.803

没有办法以可移植的方式执行此操作 - C++ 标准实际上不需要堆栈。

# python - 使用 Python 拆分 ps 的输出

> ID：682446
> 
> 赞同：14
> 
> 时间：2009-03-25T16:50:57.290
> 
> 标签：python, regex, linux

在 Linux 上，命令 ps aux 输出一个进程列表，其中每个 stat 都有多个列。例如

```
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
...
postfix  22611  0.0  0.2  54136  2544 ?        S    15:26   0:00 pickup -l -t fifo -u
apache   22920  0.0  1.5 198340 16588 ?        S    09:58   0:05 /usr/sbin/httpd 
```

我希望能够使用 Python 阅读此内容并拆分每一行，然后拆分每一列，以便它们可以用作值。

在大多数情况下，这不是问题：

```
ps = subprocess.Popen(['ps', 'aux'], stdout=subprocess.PIPE).communicate()[0]
processes = ps.split('\n') 
```

我现在可以循环遍历进程以获取每一行并按空格将其拆分，例如

```
sep = re.compile('[\s]+')
for row in processes:
    print sep.split(row) 
```

然而，问题是最后一列，命令，有时有空格。在上面的例子中，这可以在命令中看到

```
pickup -l -t fifo -u 
```

这将被拆分为

```
['postfix', '22611', '0.0', '0.2', '54136', '2544', '?', 'S', '15:26', '0:00', 'pickup', '-l', '-t', 'fifo', '-u'] 
```

但我真的想要它：

```
['postfix', '22611', '0.0', '0.2', '54136', '2544', '?', 'S', '15:26', '0:00', 'pickup -l -t fifo -u'] 
```

所以我的问题是，如何拆分列，但是当涉及到命令列时，将整个字符串保留为一个列表元素，而不是用空格拆分？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-03-25T16:53:31.450

使用第二个参数来`split`指定将字符串拆分成的最大字段数。我猜你可以通过计算第一行中的字段数来找到这个数字，即列标题。

```
ps = subprocess.Popen(['ps', 'aux'], stdout=subprocess.PIPE).communicate()[0]
processes = ps.split('\n')
# this specifies the number of splits, so the splitted lines
# will have (nfields+1) elements
nfields = len(processes[0].split()) - 1
for row in processes[1:]:
    print row.split(None, nfields) 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2010-07-29T23:27:40.513

查看[python.psutils](http://pypi.python.org/pypi/psutil/)包。

`psutil.process_iter`返回一个生成器，您可以使用它来迭代所有进程。 `p.cmdline`是每个 Process 对象的 cmdline 参数的列表，以您想要的方式分隔。

您可以只用一行创建一个 pids 字典，`(pid,cmdline,path)`然后随心所欲地使用它。

```
pid_dict = dict([(p.pid, dict([('pid',p.pid), ('cmdline',p.cmdline), ('path',p.path)]))
                 for p in psutil.process_iter()])) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-25T16:57:08.820

为什么不使用[PSI](https://pypi.python.org/pypi/PSI/)代替？PSI 提供有关 Linux 和其他 Unix 变体的进程信息。

```
import psi.process
for p in psi.process.ProcessTable().values(): … 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T16:54:15.940

该方法的`maxsplit`可选参数`split`可能会帮助您：

```
sep.split.(row, maxsplit=42) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-07T22:38:41.540

这是一个很好的例程和用法，可以帮助您前进：

```
def getProcessData():
    ps = subprocess.Popen(['ps', 'aux'], stdout=subprocess.PIPE).communicate()[0]
    processes = ps.split('\n')
    # this specifies the number of splits, so the splitted lines
    # will have (nfields+1) elements
    nfields = len(processes[0].split()) - 1
    retval = []
    for row in processes[1:]:
        retval.append(row.split(None, nfields))
    return retval

wantpid = int(contents[0])
pstats = getProcessData()
for ps in pstats:
    if (not len(ps) >= 1): continue
    if (int(ps[1]) == wantpid):
        print "process data:"
        print "USER              PID       %CPU        %MEM       VSZ        RSS        TTY       STAT      START TIME      COMMAND"
        print "%-10.10s %10.10s %10.10s %10.10s %10.10s %10.10s %10.10s %10.10s %10.10s  %s" % (ps[0], ps[1], ps[2], ps[3], ps[4], ps[5], ps[6], ps[7], ps[8], ps[9]) 
```

# delphi - 在 Delphi 7 的 OnMouseMove 事件中移动组件时如何减少 CPU 使用率？

> ID：682451
> 
> 赞同：6
> 
> 时间：2009-03-25T16:51:17.383
> 
> 标签：delphi, components, delphi-7, cpu-usage

在 Delphi 7 应用程序中，我想跟随鼠标移动一个组件。我正在做这样的事情：

```
procedure MyComponent.MouseMove(Sender: TObject;Shift: TShiftState; X, Y: Integer);
begin
  AnotherComponent.Top := X;
  AnotherComponent.Left := Y;
end; 
```

当我移动鼠标时，主核心的 CPU 使用率在最近的 PC 上上升到 100%。

在这种情况下，有什么想法可以减少 CPU 使用率吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T16:55:22.117

您可以创建一个 TTimer，每 0.10 秒左右轮询当前鼠标位置，然后根据当前鼠标位置定位“AnotherComponent”。

然后你不会为鼠标移动的每个像素触发你的事件——你根本不需要控制组件上的任何 OnMouseMove 事件。

在我的电脑上，这基本上对性能没有影响。

```
procedure TForm1.Timer1Timer(Sender: TObject);
var
  pt: TPoint;
begin
  //Is the cursor inside the controlling component?  if so, position some
  //other control based on that mouse position.

  GetCursorPos(pt);
  if MouseWithin(pt.x,pt.y,MyComponent,Form1.Left,Form1.Top) then begin
    //replace with whatever real positioning logic you want
    AnotherComponent.Top := pt.y;
    AnotherComponent.Left := pt.x;
  end;
end;

function TForm1.MouseWithin(mouseX, mouseY: integer;
  const comp: TWinControl; const ParentWindowLeft: integer;
  const ParentWindowTop: integer): boolean;
var
  absoluteCtrlX, absoluteCtrlY: integer;
begin
  //take a control, and the current mouse position.
  //tell me whether the cursor is inside the control.
  //i could infer the parent window left & top by using ParentwindowHandle
  //but I'll just ask the caller to pass them in, instead.

  //get the absolute X & Y positions of the control on the screen
  //needed for easy comparison to mouse position, which will be absolute
  absoluteCtrlX := comp.Left + ParentWindowLeft;
  absoluteCtrlY := comp.Top + ParentWindowTop +
    GetSystemMetrics(SM_CYCAPTION);

  Result := (mouseX >= absoluteCtrlX)
    and (mouseX < absoluteCtrlX + comp.Width)
    and (mouseY >= absoluteCtrlY)
    and (mouseY <= absoluteCtrlY + comp.Height);
end; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T18:57:20.483

1.  它与鼠标移动本身无关。
2.  除非这是您的意图，否则您将 X、Y 与 Top、Left 不匹配。顶部是 Y 坐标，左侧是 X 坐标。
3.  问题是AnotherComponent 的实际移动。

为了尝试理解它，我建议您编写一个 TestMove 例程，该例程自动移动您的 AnotherComponent 并调整重复/延迟以监控 CPU。
我敢打赌它会触发代价高昂的重绘或其他一些 CPU 密集型计算。
因此，请先仔细检查此组件上是否有任何事件处理程序，然后再使用继承的行为......

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-26T08:39:12.910

最后，我为此更改了代码：

```
procedure MyComponent.MouseMove(Sender: TObject;Shift: TShiftState; X, Y: Integer);
begin
  if GetTickCount-LastMoveTick>50 then begin
    AnotherComponent.Top := Y;
    AnotherComponent.Left := X;
    LastMoveTick := GetTickCount;
  end;
end; 
```

真的很容易实现（添加了 2 行），没有计时器，对我来说效果很好......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-26T06:45:26.647

也许，不是移动组件本身，而是移动“阴影”，并且只有在用户放开鼠标按钮时才移动组件。有点像拖放。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T16:59:18.643

它不可能是移动本身需要如此多的 cpu 能力，很可能是移动导致组件以某种方式重绘自身。你能避免`AnotherComponent`每一步都重绘吗？它应该不是必需的，除非它是一个电影容器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T17:22:14.767

由于鼠标是高分辨率输入设备，因此与鼠标移动事件相关的任何内容都会被非常频繁地调用。不过，我不会担心 CPU 的使用，因为您的处理程序只会根据系统的繁忙程度尽快触发。换句话说，它只是最大化 CPU，因为没有别的。

> 来自 MSDN：
> 
> 当用户移动鼠标，或者按下或释放鼠标按钮时，鼠标会产生一个输入事件。系统将鼠标输入事件转换为消息并将它们发送到相应线程的消息队列中。当鼠标消息的发布速度快于线程处理它们的速度时，系统会丢弃除最近的鼠标消息之外的所有消息。

现在可能有一些例外。您可以通过运行其他一些处理密集型活动来进行一些测试，并查看鼠标移动对它的影响程度。

# ruby - 屏幕抓取 ASP.NET 网页以检索显示在网格视图中的数据

> ID：682453
> 
> 赞同：2
> 
> 时间：2009-03-25T16:51:28.350
> 
> 标签：ruby, screen-scraping

我正在使用 RUBY 筛选使用 gridview 显示数据的网页（在 asp.net 中创建）。我能够成功读取网格第 1 页上显示的数据，但无法弄清楚如何移动到网格中的下一页以读取所有数据。

问题是页码超链接不是普通的超链接（带有 URL），而是导致回发到同一页面的 javascript 超链接。

超链接的一个例子： -

```
<a href="javascript:__doPostBack('gvw_offices','Page$6')" style="color:Black;">6</a> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T17:02:13.987

您需要找出实际的 URL。

选项 1a：在具有良好开发人员支持的浏览器中打开页面（例如带有 web 开发工具的 firefox）并查看源代码以找到`_doPostBack`定义的位置。找出它正在构建的 URL。请注意，它可能不在主页源中，而是在页面加载的内容中。

选项 1b：同上，但是让 ruby​​ 来做。如果您使用 Net:HTTP 获取页面，您已经拥有找到`__doPostBack`已经定义的工具（作为字符串的主体，ruby 的 grep，以及请求其他文件的能力，例如脚本标签中的那些）。

选项 2：监控浏览器和页面之间的流量（例如使用日志代理）以找出 URL 是什么。

选项 3：询问网页的所有者。

选项4：猜测。这可能不像听起来那么糟糕（例如，如果原始 URL 以“...？page=1”或其他东西结尾），但通常这是最不可能工作的。

编辑（回应您对另一个问题的评论）：

假设您使用的是 Net:HTTP 库，您可以通过将 your 替换`get`为 a来进行回发`post`，例如，`my_http.post(my_url)`而不是`my_http.get(my_url)`

编辑（响应 danieltalsky 的回答）：

**watir**对您来说可能是一个非常好的解决方案（我因为没有想到它而自责），但请注意，您可能必须[手动触发事件](http://wiki.openqa.org/display/WTR/JavaScript)或通过其他箍来获得您想要的东西。作为一个特定的问题，对于像这样的任何异步获取，您需要确保在抓取之前完整的响应已经返回；当您自己进行内联请求时，这不是问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T17:07:46.643

如果您已经在使用 ruby​​ 进行处理，我建议使用 Watir，这是一个为浏览器测试而设计的 ruby​​ 库。一方面，它为页面上的 DOM 元素提供了一个更好的界面，并且它使单击这样的链接更容易：

```
ie.link(:text, '6').click 
```

然后，当然你也有更简单的方法来导航表格。自动化这个过程很容易：

```
1..total_number_of_pages.each do |next_page|

  ie.link(:text, next_page).click
  # table processing goes here

end 
```

我不知道您的用例，但这种方法有其优点和缺点。一方面，它实际上运行一个浏览器实例，所以如果这是您需要经常在后台以完全自动化的方式安静地运行的东西，这可能不是最好的方法。另一方面，如果可以启动浏览器实例，那么您不必担心所有这些回发废话，您只需单击链接，就像您是用户一样。

瓦提尔：[http ://wtr.rubyforge.org/](http://wtr.rubyforge.org/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T17:09:56.653

您将不得不执行回发。数据通过表单 POST 传递回服务器。就像 Markus 所说的那样，使用 FireBug 或 IE 8 中的开发人员工具和提琴手来观察流量。但老实说，这是一个使用臃肿的 GridView 的 Web 表单，您将进行一次有趣的冒险。;)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T18:47:40.380

您需要进行一些调查才能确定 javascript 执行正在执行的 HTTP 请求。我使用 Mozilla 浏览器和 Firebug 插件以及“Live HTTP Headers”插件来帮助确定发生了什么。您可能会很清楚您需要提出哪些请求才能遍历到下一页。确保您注意设置的任何 cookie。

我在使用[Mechanize](http://mechanize.rubyforge.org/)进行抓取方面取得了非常好的成功。它包装了所有的 HTTP 通信、html 解析和搜索（使用[Nokogiri](http://nokogiri.rubyforge.org/nokogiri/)）、重定向和保存 cookie。但它不知道如何执行 Javascript，这就是为什么您需要自己弄清楚要执行的 http 请求的原因。

# delphi - IEnumerable.GetEnumerator() 在 Delphi 6 中返回 IEnumVariant

> ID：682458
> 
> 赞同：1
> 
> 时间：2009-03-25T16:52:13.950
> 
> 标签：delphi, com, .net-2.0, ienumerable

我通过 COM 在 Delphi 6 中使用 .Net2.0 程序集。接口之一中的方法之一返回 IEnumerable。只要我导入位于的 mscorlib.tlb

"C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727"

，我可以在 Delphi 6 中同时访问 IEnumerable 和 IEnumerator 接口。这是在 mscorlib_TLB.pas 中定义 IEnumerable 的部分：

```
// *********************************************************************//
// Interface: IEnumerable
// Flags:     (4416) Dual OleAutomation Dispatchable
// GUID:      {496B0ABE-CDEE-11D3-88E8-00902754C43A}
// *********************************************************************//
  IEnumerable = interface(IDispatch)
    ['{496B0ABE-CDEE-11D3-88E8-00902754C43A}']
    function GetEnumerator: IEnumVARIANT; safecall;
  end; 
```

GetEnumerator 方法的返回值不是 IEnumerator，当我尝试将其强制转换为 IEnumerator 时，会抛出“不支持接口”异常。

有没有人遇到过这个或类似的问题？如何解决？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-25T16:55:42.163

这是通过 COM 互操作与 .NET 对象交互时的标准行为，如下所示：

[http://msdn.microsoft.com/en-us/library/111chfb8(VS.71).aspx](http://msdn.microsoft.com/en-us/library/111chfb8(VS.71).aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T18:06:34.737

指向 MSDN 对 IEnumVARIANT 的解释的链接也可能很有价值：http: [//msdn.microsoft.com/en-us/library/ms221053.aspx](http://msdn.microsoft.com/en-us/library/ms221053.aspx)

# deployment - 使用 Powershell 部署应用程序

> ID：682476
> 
> 赞同：1
> 
> 时间：2009-03-25T16:55:12.460
> 
> 标签：deployment, powershell

我开发了一个 Powershell 脚本来将更新部署到一套应用程序；包括 SQL Server 数据库更新。

接下来我需要一种在 100 多台服务器上执行这些脚本的方法；无需手动连接到每个服务器。“Powershell v2 with remoting”不是一个选项，因为它仍在 CTP 中。

带有 WinRM 的 Powershell v1 看起来最有前途，但我无法从我的脚本中获得反馈。脚本执行，但我需要了解异常。脚本创建一个日志文件，有没有办法将日志文件的内容发送回“客户端”（进行远程调用的本地计算机）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T17:58:12.170

快速回答是否定的。长版本是可能的，但会涉及很多黑客攻击。去年我使用 PowerShell 2 开发了非常相似的部署脚本/系统。远程处理功能是我们忍受 CTP 状态的主要原因。带有 WinRM 的 PowerShell 1 充其量是不稳定的，正如您所说，除了正常或失败之外没有真正的反馈。

我认为包括使用[PsExec](http://technet.microsoft.com/en-us/sysinternals/bb897553.aspx)的替代方案，这是非常不标准的，可能会被防火墙阻止。另一种方法涉及使用系统管理工具，例如 MS 的 System Center，但这只是一个小钉子的大锤子。所以你必须选择你的毒药......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T21:51:50.220

对此进行评论：捕获 powershell 输出的最简单方法是使用 start-transcript cmdlet 将控制台输出通过管道传输到文件。我们在所有脚本的开头都有一个小片段，它将带有每个脚本的控制台输出的日志文件发送到中央文件共享，并使用脚本名称和执行日期命名日志文件，以便我们了解发生了什么。将所有这些日志文件通过管道传输到数据库中进行进一步处理也不是太难。可能不会解决您所有的问题，但肯定会在“取回数据”部分有所帮助。

最好的问候， 特隆德

# asp.net - 使用 ASP.NET 进行 PDF 权限管理 - 超时问题

> ID：682477
> 
> 赞同：0
> 
> 时间：2009-03-25T16:55:17.577
> 
> 标签：asp.net, pdf

我有一个包含多个 PDF 文件的网站。我需要使用标准的 ASP.NET 身份验证（在拒绝匿名用户的带有 web.config 的文件夹中）锁定其中的一些。

我将 PDF 文件设置为由 ASP.NET 工作进程处理并添加：

```
<add type="System.Web.StaticFileHandler" path="*.pdf" verb="*" /> 
```

到我的 web.config，但由于某种原因，它们在下载时挂起。我以前在一台旧服务器上看到过这个问题，而对于我来说，我不记得我做了什么来解决它。有人有什么主意吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T20:16:23.537

我会打开 fiddler 并查看实际发送到服务器的请求以及响应是什么。它还可能取决于您实际请求的方式（即路径）以及您提供 PDF 的方式。我演示了如何在我的一本 WROX 电子书中以及我在用户组中所做的处理程序和模块演示中返回受密码保护的 PDF 文档。[http://professionalaspnet.com/archive/2008/08/10/CodeStock-Rocked_2100_.aspx](http://professionalaspnet.com/archive/2008/08/10/CodeStock-Rocked_2100_.aspx)（链接下载页面上的代码）。

这是我用来使用处理程序返回 PDF 的代码，它可能会对您有所帮助。

```
 'First run the supplied filename through a URL decoder to change any URL
    'characters back to their normal selves.
    sDocument = HttpUtility.UrlDecode( _
        Path.GetFileName(context.Request.Url.ToString))
    'Now build a full physical path to the file on the server.
    sDocument = Path.Combine(Path.Combine( _
        context.Request.PhysicalApplicationPath, "PDF"), sDocument)

    'Verify we actually have the file to serve.
    If File.Exists(sDocument) = False Then
        context.Server.Transfer("badpdf.aspx")
    End If

        'The next two sections are from Scott Hanselman's blog, but seem to be out of date, 
    'since it was posted in 2003
    'http://www.hanselman.com/blog/InternetExplorerAndTheMagicOfMicrosoftKBArticleQ293792.aspx
    'This is done to support older browsers that were not as efficient
    'at managing document requests.
    If InStr(1, context.Request.UserAgent, "contype") > 0 Then
        'Just send the mime/type
        Response.ContentType = "application/pdf"
        Response.End()
        Exit Sub
    End If

    Dim Language As String = context.Request.ServerVariables("HTTP_ACCEPT_LANGUAGE")
    If String.IsNullOrEmpty(Language) Then
        Response.Clear()
        Response.ContentType = "application/pdf"
        Response.AddHeader("Last-modified", "Mon, 01 Sep 1997 01:03:33 GMT")
        Response.Status = "304 Not Modified"
        Response.End()
        Exit Sub
    End If

    'Set the Cacheability
    Response.Cache.SetCacheability(HttpCacheability.Public)
    Response.Cache.SetExpires(DateTime.MinValue)
    Response.ContentType = "application/pdf"

    'This opens the Open/Save Dialog
    Response.AddHeader("Content-Disposition", "attachment; filename=" & _
     Path.GetFileName(sDocument))

    'This Bypasses the Open/Save Dialog
    'Response.AddHeader("Content-Disposition", "inline; filename=" & _
    ' Path.GetFileName(sDocument))

    If File.Exists(sDocument) Then
        'Write the file to the Response Output stream without buffering.
        'This is new to ASP.NET 2.0\. Prior to that use WriteFile.
        Response.TransmitFile(sDocument)
        Response.End()
    End If 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-29T21:07:37.940

我想我终于弄清楚了我错过了什么。我需要将 PDF 文件的 MIME 类型设置为 application/octet-stream 而不是 application/pdf。

# internet-explorer - 奇怪的 Internet Explorer 渲染错误（img 标签）

> ID：682484
> 
> 赞同：1
> 
> 时间：2009-03-25T16:56:51.753
> 
> 标签：internet-explorer, internet-explorer-8

我有一个页面有一个类似的电话

```
<%# Databinder.Eval(Me, "Description") %> 
```

其中描述包含在我的网站上输出的 html。它多年来一直运行良好，但现在我试图在 html 中添加一个 img 标签，宽度为 740px，它在较低分辨率下很好地填充了空间。

它在我检查过的所有浏览器（Chrome、FF、Safari）中都可以正常工作，但是 ie8 在图像之后添加了一堆额外的空白区域，这会导致水平滚动条。

IE8 的开发者工具布局选项卡确认包含 img 元素的 div 的宽度大约为 1039px，因此通过内联 css 我能够将其调整为正确的大小，但描述字段中的所有其他元素仍然具有 1039px 的宽度. 当我取出 img 标签时，一切都恢复正常。

我还确保将 img 标签设置为 display:block;

编辑——虚拟代码示例：

```
<h1 class="asdf">asdf</h1>
<h2 class="zxcv">zxcv</h2>
<ul>
  <li>zxcv</li>
  <li>adsf</li>
  <li>asdf</li>
</ul> 
<h2 class="qwerty">qwerty</h2>
<p>qwerty</p>
<div style="margin:0; padding:0; width:740px; display:block;"><img style="margin:0; padding:0; width:740px; display:block;" src="images/asdf1.jpg" /></div> 
```

那么我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T17:18:22.450

在发布的示例代码中，图像标签未关闭，我不知道这是因为它只是虚拟代码还是可能是问题所在。但是，如果图像只是一个间隔，您是否考虑过使用非中断空间来代替？...

`<div style="width:740px;">&nbsp;</div>`

将导致空间被阻塞的 div 元素占用，而不是在 div 内放置图像元素。

# c# - Visual Studio F6 停止工作。它不再构建项目

> ID：682494
> 
> 赞同：36
> 
> 时间：2009-03-25T16:58:40.847
> 
> 标签：c#, .net, visual-studio, visual-studio-2008, keyboard-shortcuts

我正在使用 VS2008，已经使用了很长一段时间了，因为我[讨厌在开发时使用鼠标](http://www.codinghorror.com/blog/archives/000825.html)，所以我总是使用`F6`来构建解决方案，或者`Shift`+`F6` 来构建当前项目。奇怪的是，出于某种奇怪的原因，它在过去几天里就停止了工作。事实上，当我拉下 Build 菜单时，“Build MyProject”旁边的菜单上不再有“ `Shift`+ `F6`”快捷方式？！？有人经历过吗？我需要更改设置吗？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-03-25T17:00:37.597

您可以在“工具”->“选项”对话框中更改键盘绑定。它在环境->键盘下。

您可以在此处重置绑定，还可以通过检查当前绑定到这些键的内容来检查可能被盗的内容。

如果您最近安装了任何加载项，则已知它们会设置（有时是不需要的）键盘快捷键。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2014-12-31T03:51:12.640

您的键盘映射方案已更改。转到工具-> 选项。在“应用以下附加映射方案”下拉菜单中的 Environments->Keyboard 中，选择**“Visual C# 2005”**

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-25T17:04:42.080

您是否尝试过：工具-> 选项-> 环境-> 键盘

所有的键盘快捷键都显示在那里。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-25T17:04:46.837

我将添加众所周知的“它是否插入墙上”问题：

你有一个花哨的键盘，用其他错误切换的东西代替功能键吗？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-06-09T11:03:45.340

VMWare 偷了我的`Shift`+ `F6`。也许这就是你的问题？

我通过像其他建议一样转到工具选项环境键盘来解决此问题，但我单击“重置”而不是恢复正确的快捷方式。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-06-01T02:36:01.463

Resharper 对此感到恼火。我必须将 BuildSolution 设置为 f6，然后从 Resharper_Move 中删除 F6

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-08-30T13:44:14.813

Just in case this bites anyone else: [Parallels Desktop](http://www.parallels.com/uk/products/desktop/) for OS X grabs `F6` and uses it for "Show and hide Parallels Desktop". It can be disabled in Preferences -> OS X System Shortcuts

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-01-13T18:12:45.380

我知道这个问题已经有了答案，但最好把它放在这里以供将来参考：

在解决方案属性页面上，配置属性 -> 配置，将显示项目列表，最后一列“构建”将有复选框，每个项目一个。如果它们都未选中，您将按 F6 但不会发生任何事情。检查您要构建的项目，在这种情况下，您现在可以按 F6。

# python - 在 Python 中拥有多个构造函数的干净、Pythonic 方式是什么？

> ID：682504
> 
> 赞同：866
> 
> 时间：2009-03-25T17:00:21.807
> 
> 标签：python, constructor

我找不到一个明确的答案。据我所知，一个 Python 类中不能有多个`__init__`函数。那么我该如何解决这个问题呢？

假设我有一个`Cheese`使用该`number_of_holes`属性调用的类。我怎样才能有两种创建奶酪对象的方法......

1.  一个需要像这样的多个孔：`parmesan = Cheese(num_holes = 15)`
2.  还有一个不带参数，只是随机化`number_of_holes`属性：`gouda = Cheese()`

我只能想到一种方法来做到这一点，但这似乎很笨拙：

```
class Cheese():
    def __init__(self, num_holes = 0):
        if (num_holes == 0):
            # Randomize number_of_holes
        else:
            number_of_holes = num_holes 
```

你说什么？还有其他方法吗？

* * *

## 回答 #1

> 赞同：926
> 
> 时间：2009-03-25T17:03:38.430

实际上`None`对于“魔术”值要好得多：

```
class Cheese():
    def __init__(self, num_holes = None):
        if num_holes is None:
            ... 
```

现在，如果您想完全自由地添加更多参数：

```
class Cheese():
    def __init__(self, *args, **kwargs):
        #args -- tuple of anonymous arguments
        #kwargs -- dictionary of named arguments
        self.num_holes = kwargs.get('num_holes',random_holes()) 
```

为了更好地解释和的概念`*args`（`**kwargs`您实际上可以更改这些名称）：

```
def f(*args, **kwargs):
   print 'args: ', args, ' kwargs: ', kwargs

>>> f('a')
args:  ('a',)  kwargs:  {}
>>> f(ar='a')
args:  ()  kwargs:  {'ar': 'a'}
>>> f(1,2,param=3)
args:  (1, 2)  kwargs:  {'param': 3} 
```

[http://docs.python.org/reference/expressions.html#calls](http://docs.python.org/reference/expressions.html#calls)

* * *

## 回答 #2

> 赞同：870
> 
> 时间：2009-03-25T17:11:24.323

`num_holes=None`如果您打算只使用`__init__`.

如果您想要多个独立的“构造函数”，您可以将它们作为类方法提供。这些通常称为工厂方法。在这种情况下，您可以使用默认值`num_holes`be `0`。

```
class Cheese(object):
    def __init__(self, num_holes=0):
        "defaults to a solid cheese"
        self.number_of_holes = num_holes

    @classmethod
    def random(cls):
        return cls(randint(0, 100))

    @classmethod
    def slightly_holey(cls):
        return cls(randint(0, 33))

    @classmethod
    def very_holey(cls):
        return cls(randint(66, 100)) 
```

现在创建这样的对象：

```
gouda = Cheese()
emmentaler = Cheese.random()
leerdammer = Cheese.slightly_holey() 
```

* * *

## 回答 #3

> 赞同：62
> 
> 时间：2016-08-11T00:20:55.120

人们绝对应该更喜欢已经发布的解决方案，但是由于还没有人提到这个解决方案，我认为值得一提的是完整性。

可以修改该`@classmethod`方法以提供不调用默认构造函数 ( `__init__`) 的替代构造函数。相反，使用`__new__`.

如果无法根据构造函数参数的类型选择初始化类型，并且构造函数不共享代码，则可以使用此方法。

例子：

```
class MyClass(set):

    def __init__(self, filename):
        self._value = load_from_file(filename)

    @classmethod
    def from_somewhere(cls, somename):
        obj = cls.__new__(cls)  # Does not call __init__
        super(MyClass, obj).__init__()  # Don't forget to call any polymorphic base class initializers
        obj._value = load_from_somewhere(somename)
        return obj 
```

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2009-03-25T17:16:04.470

如果您想使用可选参数，所有这些答案都非常好，但另一种 Pythonic 可能性是使用类方法来生成工厂风格的伪构造函数：

```
def __init__(self, num_holes):

  # do stuff with the number

@classmethod
def fromRandom(cls):

  return cls( # some-random-number ) 
```

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2009-03-25T17:11:35.057

为什么您认为您的解决方案“笨拙”？就我个人而言，在像您这样的情况下，我更喜欢一个具有默认值的构造函数，而不是多个重载的构造函数（Python 无论如何都不支持方法重载）：

```
def __init__(self, num_holes=None):
    if num_holes is None:
        # Construct a gouda
    else:
        # custom cheese
    # common initialization 
```

对于具有许多不同构造函数的非常复杂的情况，使用不同的工厂函数可能会更简洁：

```
@classmethod
def create_gouda(cls):
    c = Cheese()
    # ...
    return c

@classmethod
def create_cheddar(cls):
    # ... 
```

在您的奶酪示例中，您可能希望使用奶酪的 Gouda 子类...

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2011-10-25T15:06:03.197

这些对于您的实现来说是个好主意，但是如果您要向用户展示奶酪制作界面。他们不在乎奶酪有多少孔，也不在乎制作奶酪的内部结构。您的代码的用户只想要“gouda”或“parmesean”对吗？

那么为什么不这样做：

```
# cheese_user.py
from cheeses import make_gouda, make_parmesean

gouda = make_gouda()
paremesean = make_parmesean() 
```

然后您可以使用上述任何方法来实际实现功能：

```
# cheeses.py
class Cheese(object):
    def __init__(self, *args, **kwargs):
        #args -- tuple of anonymous arguments
        #kwargs -- dictionary of named arguments
        self.num_holes = kwargs.get('num_holes',random_holes())

def make_gouda():
    return Cheese()

def make_paremesean():
    return Cheese(num_holes=15) 
```

这是一种很好的封装技术，我认为它更 Pythonic。对我来说，这种做事方式更符合鸭式打字。您只是在要求一个 gouda 对象，而您并不真正关心它是什么类。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2009-03-25T17:03:56.527

`num_holes=None`改为默认使用。然后检查是否`num_holes is None`，如果是，随机化。无论如何，这就是我通常看到的。

更根本不同的构造方法可能需要返回一个实例的类方法`cls`。

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2009-03-25T19:48:35.867

最好的答案是上面关于默认参数的答案，但我写这篇文章很有趣，它确实符合“多个构造函数”的要求。使用风险自负。

[**新**](http://docs.python.org/reference/datamodel.html#object.__new__)方法怎么样。

“典型的实现通过使用 super(currentclass, cls).new (cls[, ...]) 和适当的参数调用超类的 new () 方法来**创建**类的新实例**，**然后在之前根据需要修改新创建的实例还给它。”

 **因此，您可以通过附加适当的构造函数方法让**新**方法修改您的类定义。

```
class Cheese(object):
    def __new__(cls, *args, **kwargs):

        obj = super(Cheese, cls).__new__(cls)
        num_holes = kwargs.get('num_holes', random_holes())

        if num_holes == 0:
            cls.__init__ = cls.foomethod
        else:
            cls.__init__ = cls.barmethod

        return obj

    def foomethod(self, *args, **kwargs):
        print "foomethod called as __init__ for Cheese"

    def barmethod(self, *args, **kwargs):
        print "barmethod called as __init__ for Cheese"

if __name__ == "__main__":
    parm = Cheese(num_holes=5) 
```

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2021-06-10T19:40:12.323

## 概述

对于特定的奶酪示例，我同意许多其他关于使用默认值来表示随机初始化或使用静态工厂方法的答案。但是，您可能还想到了一些相关的场景，在这些场景中，在不损害参数名称或类型信息质量的情况下，使用替代、简洁的方式调用构造函数*是有价值的。*

从 Python 3.8 开始，[`functools.singledispatchmethod`](https://docs.python.org/3/library/functools.html#functools.singledispatchmethod)可以在很多情况下帮助实现这一点（并且更灵活的[`multimethod`](https://github.com/coady/multimethod)可以应用在更多的场景中）。（[这篇相关文章](https://stackoverflow.com/a/24602374/3780389)描述了如何在没有库的情况下在 Python 3.4 中完成相同的任务。）我没有在文档中看到任何一个具体显示`__init__`您所询问的重载的示例，但似乎重载的原则相同任何成员方法都适用（如下所示）。

“单一调度”（在标准库中可用）要求至少有一个位置参数，并且第一个参数的类型足以区分可能的重载选项。对于特定的 Cheese 示例，这不成立，因为您在没有给出参数时想要随机孔，但`multidispatch`确实支持相同的语法并且可以使用，只要每个方法版本可以根据所有方法的数量和类型进行区分一起争论。

## 例子

这是一个如何使用这两种方法的示例（一些细节是为了取悦[mypy](https://mypy.readthedocs.io/en/stable/)，这是我第一次把它放在一起时的目标）：

```
from functools import singledispatchmethod as overload
# or the following more flexible method after `pip install multimethod`
# from multimethod import multidispatch as overload

class MyClass:

    @overload  # type: ignore[misc]
    def __init__(self, a: int = 0, b: str = 'default'):
        self.a = a
        self.b = b

    @__init__.register
    def _from_str(self, b: str, a: int = 0):
        self.__init__(a, b)  # type: ignore[misc]

    def __repr__(self) -> str:
        return f"({self.a}, {self.b})"

print([
    MyClass(1, "test"),
    MyClass("test", 1),
    MyClass("test"),
    MyClass(1, b="test"),
    MyClass("test", a=1),
    MyClass("test"),
    MyClass(1),
    # MyClass(),  # `multidispatch` version handles these 3, too.
    # MyClass(a=1, b="test"),
    # MyClass(b="test", a=1),
]) 
```

输出：

```
[(1, test), (1, test), (0, test), (1, test), (1, test), (0, test), (1, default)] 
```

笔记：

*   我通常不会将别名称为`overload`，但它有助于使使用这两种方法之间的差异只是您使用哪个导入的问题。
*   `# type: ignore[misc]`评论不是必须运行的，但我把它们放在那里取悦不`mypy`喜欢装饰`__init__`也不直接打电话的人`__init__`。
*   如果您不熟悉装饰器语法，请意识到`@overload`在定义之前放置`__init__`只是对`__init__ = overload(the original definition of __init__)`. 在这种情况下，`overload`是一个类，所以结果`__init__`是一个对象，它有一个`__call__`方法，所以它看起来像一个函数，但也有一个`.register`方法，稍后会调用它来添加另一个重载版本的`__init__`. 这有点混乱，但它请 mypy 因为没有方法名称被定义两次。如果您不关心 mypy 并且无论如何都打算使用外部库，那么`multimethod`还有更简单的替代方法来指定重载版本。
*   定义`__repr__`只是为了使打印输出有意义（您通常不需要它）。
*   Notice that `multidispatch` is able to handle three additional input combinations that don't have any positional parameters.

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2015-04-28T12:33:56.647

我会使用继承。特别是如果存在比孔数更多的差异。特别是如果 Gouda 需要拥有不同的成员，那么 Parmesan。

```
class Gouda(Cheese):
    def __init__(self):
        super(Gouda).__init__(num_holes=10)

class Parmesan(Cheese):
    def __init__(self):
        super(Parmesan).__init__(num_holes=15) 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2017-01-18T12:17:31.067

这就是我为`YearQuarter`必须创建的课程解决它的方法。我创建了一个`__init__`对各种输入非常宽容的产品。

你像这样使用它：

```
>>> from datetime import date
>>> temp1 = YearQuarter(year=2017, month=12)
>>> print temp1
2017-Q4
>>> temp2 = YearQuarter(temp1)
>>> print temp2
2017-Q4
>>> temp3 = YearQuarter((2017, 6))
>>> print temp3
2017-Q2 
>>> temp4 = YearQuarter(date(2017, 1, 18))
>>> print temp4
2017-Q1
>>> temp5 = YearQuarter(year=2017, quarter = 3)
>>> print temp5
2017-Q3 
```

这就是`__init__`类和其他类的样子：

```
import datetime

class YearQuarter:

    def __init__(self, *args, **kwargs):
        if len(args) == 1:
            [x]     = args

            if isinstance(x, datetime.date):
                self._year      = int(x.year)
                self._quarter   = (int(x.month) + 2) / 3
            elif isinstance(x, tuple):
                year, month     = x

                self._year      = int(year)

                month           = int(month)

                if 1 <= month <= 12:
                    self._quarter   = (month + 2) / 3
                else:
                    raise ValueError

            elif isinstance(x, YearQuarter):
                self._year      = x._year
                self._quarter   = x._quarter

        elif len(args) == 2:
            year, month     = args

            self._year      = int(year)

            month           = int(month)

            if 1 <= month <= 12:
                self._quarter   = (month + 2) / 3
            else:
                raise ValueError

        elif kwargs:

            self._year      = int(kwargs["year"])

            if "quarter" in kwargs:
                quarter     = int(kwargs["quarter"])

                if 1 <= quarter <= 4:
                    self._quarter     = quarter
                else:
                    raise ValueError
            elif "month" in kwargs:
                month   = int(kwargs["month"])

                if 1 <= month <= 12:
                    self._quarter     = (month + 2) / 3
                else:
                    raise ValueError

    def __str__(self):
        return '{0}-Q{1}'.format(self._year, self._quarter) 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2019-02-14T14:11:21.563

由于[我最初的回答](https://stackoverflow.com/a/48978850)因我的专用构造函数没有调用（唯一的）默认构造函数而受到批评[，因此我在此处发布了一个修改版本，该版本尊重所有构造函数都应调用默认构造函数的愿望：](https://stackoverflow.com/q/682504/#comment89873541_48978850)

```
class Cheese:
    def __init__(self, *args, _initialiser="_default_init", **kwargs):
        """A multi-initialiser.
        """
        getattr(self, _initialiser)(*args, **kwargs)

    def _default_init(self, ...):
        """A user-friendly smart or general-purpose initialiser.
        """
        ...

    def _init_parmesan(self, ...):
        """A special initialiser for Parmesan cheese.
        """
        ...

    def _init_gouda(self, ...):
        """A special initialiser for Gouda cheese.
        """
        ...

    @classmethod
    def make_parmesan(cls, *args, **kwargs):
        return cls(*args, **kwargs, _initialiser="_init_parmesan")

    @classmethod
    def make_gouda(cls, *args, **kwargs):
        return cls(*args, **kwargs, _initialiser="_init_gouda") 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-02-25T21:52:40.527

```
class Cheese:
    def __init__(self, *args, **kwargs):
        """A user-friendly initialiser for the general-purpose constructor.
        """
        ...

    def _init_parmesan(self, *args, **kwargs):
        """A special initialiser for Parmesan cheese.
        """
        ...

    def _init_gauda(self, *args, **kwargs):
        """A special initialiser for Gauda cheese.
        """
        ...

    @classmethod
    def make_parmesan(cls, *args, **kwargs):
        new = cls.__new__(cls)
        new._init_parmesan(*args, **kwargs)
        return new

    @classmethod
    def make_gauda(cls, *args, **kwargs):
        new = cls.__new__(cls)
        new._init_gauda(*args, **kwargs)
        return new 
```

# java - 试图将java对象存储在连续内存中

> ID：682506
> 
> 赞同：9
> 
> 时间：2009-03-25T17:00:57.500
> 
> 标签：java, memory, caching, object

我正在尝试实现一个类似缓存的对象集合。目的是通过内存中的局部性快速访问这些对象，因为我可能一次读取多个对象。我目前只是将对象存储在一个 java 集合对象中，比如 vector 或 deque。但我不相信这会使用连续内存。

我知道这可以在 C 中完成，但可以在 Java 中完成吗？这些对象可能有不同的长度（因为它们可能包含字符串）。有没有办法通过Java分配连续的内存？是否有一个 Java 集合对象？

请告诉我。

谢谢，jbu

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-25T17:05:00.173

你不能强迫它。如果您快速连续分配所有对象，它们*可能*是连续的 - 但如果您将它们存储在一个集合中，则不能保证该集合对于实际值是本地的。（集合将引用对象，而不是包含对象本身。）

此外，GC 压缩将在内存中移动值。

您是否真正分析过您的应用程序并发现这是一个瓶颈？在大多数情况下，我希望其他优化可以以更可靠的方式帮助您。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-25T17:06:53.743

不，您不能保证这个参考位置。

通过分配字节数组或使用`nio`包中的映射字节缓冲区，您可以获得一块连续的内存，您可以从中解码您想要的数据（有效地从这块内存中反序列化感兴趣的对象）。但是，如果您重复访问相同的对象，反序列化开销可能会破坏目的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-25T17:05:33.807

你用 Java 写过这段代码吗？如果是这样，你有没有分析过它？我认为您可能不需要担心对象在连续内存中 - JVM 在内存管理方面比在垃圾收集环境中更好。

如果你真的关心性能，也许 Java 不是适合这项工作的工具，但我的直觉告诉你，你担心优化太早了，你的代码的 Java 版本，使用非连续内存，可能会满足您的需求。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-25T17:08:03.163

我建议对缓存使用 HashMap（无线程）或 Hashtable（线程）。两者都将对象存储到 sun jvm 中的数组中。由于 java 中的所有对象都是通过引用传递的，因此应该将其表示为 c 中的指针数组。我敢打赌，您正在执行过早的优化。

如果你绝对必须拥有这个，你有两个选择：

1）使用JNI并用c编写。2) 获取一个 BIG 字节缓冲区并使用 ObjectOutputStream 向其中写入对象。与使用哈希表相比，这可能非常慢。

# deployment - 包括 MSMQ 作为我的应用程序的先决条件

> ID：682511
> 
> 赞同：21
> 
> 时间：2009-03-25T17:03:22.877
> 
> 标签：deployment, msmq

我正在开发一个使用 MSMQ 进行进程间通信的应用程序，如果尚未安装该服务，我需要安装项目才能安装该服务。我已经检查了有关使其成为先决条件的信息，但到目前为止我一直没有成功找到它。有任何想法吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-03-26T04:20:30.987

我自己发现了答案... Windows 组件安装程序不会因在任何给定时间无法安装多个 MSI 的典型情况而瘫痪，因此我可以使用自定义安装程序操作来执行命令行脚本进行安装MSMQ。

这是我的安装程序类（您的选择可能会明显不同）：

```
public partial class MSMQInstaller : Installer
{
    public MSMQInstaller()
    {
        InitializeComponent();
    }

    [DllImport("kernel32")]
    static extern IntPtr LoadLibrary(string lpFileName);

    [DllImport("kernel32.dll", SetLastError = true)]
    static extern bool FreeLibrary(IntPtr hModule);

    public override void Install(IDictionary stateSaver)
    {
        base.Install(stateSaver);

        bool loaded;

        try
        {
            IntPtr handle = LoadLibrary("Mqrt.dll");

            if (handle == IntPtr.Zero || handle.ToInt32() == 0)
            {
                loaded = false;
            }
            else
            {
                loaded = true;

                FreeLibrary(handle);
            }
        }
        catch
        {
            loaded = false;
        }

        if (!loaded)
        {
            if (Environment.OSVersion.Version.Major < 6) // Windows XP or earlier
            {
                string fileName = System.IO.Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.System), "MSMQAnswer.ans");

                using (System.IO.StreamWriter writer = new System.IO.StreamWriter(fileName))
                {
                    writer.WriteLine("[Version]");
                    writer.WriteLine("Signature = \"$Windows NT$\"");
                    writer.WriteLine();
                    writer.WriteLine("[Global]");
                    writer.WriteLine("FreshMode = Custom");
                    writer.WriteLine("MaintenanceMode = RemoveAll");
                    writer.WriteLine("UpgradeMode = UpgradeOnly");
                    writer.WriteLine();
                    writer.WriteLine("[Components]");
                    writer.WriteLine("msmq_Core = ON");
                    writer.WriteLine("msmq_LocalStorage = ON");
                }

                using (System.Diagnostics.Process p = new System.Diagnostics.Process())
                {
                    System.Diagnostics.ProcessStartInfo start = new System.Diagnostics.ProcessStartInfo("sysocmgr.exe", "/i:sysoc.inf /u:\"" + fileName + "\"");

                    p.StartInfo = start;

                    p.Start();
                    p.WaitForExit();
                }
            }
            else // Vista or later
            {
                using (System.Diagnostics.Process p = new System.Diagnostics.Process())
                {
                    System.Diagnostics.ProcessStartInfo start = new System.Diagnostics.ProcessStartInfo("ocsetup.exe", "MSMQ-Container;MSMQ-Server /passive");

                    p.StartInfo = start;

                    p.Start();
                    p.WaitForExit();
                }
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-02-08T14:48:47.117

pkgmgr 命令呢？

pkgmgr /iu:MSMQ-容器；MSMQ-服务器

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-10-21T19:05:32.603

谢谢你！！这是任何有兴趣的人的 VB.Net 版本。

```
Option Explicit On
Option Strict On

Imports System.Diagnostics.Process
Imports System.IO
Imports System.Text
'Required in all cases when calling API functions
Imports System.Runtime.InteropServices
Imports System.Configuration.Install.Installer

<System.ComponentModel.RunInstallerAttribute(True)> _
Public Class msmqInstaller
    Inherits System.Configuration.Install.Installer

    Private Declare Function LoadLibrary Lib "kernel32" (ByVal lpFileName As String) As IntPtr`enter code here`
    <DllImport("KERNEL32.DLL", EntryPoint:="FreeLibrary", SetLastError:=True)> _
     Public Shared Function FreeLibrary(ByVal hModule As IntPtr) As Boolean
        ' Leave function empty - DLLImport attribute 
        ' forces calls to LoadLibrary to
        ' be forwarded to LoadLibrary in KERNEL32.DLL
    End Function

    Public Const MAX_PATH As Integer = 256
    ' Dim testKernel As loadlibrary
    Dim p As New Process
    '  Dim startInfo As New ProcessStartInfo("sysocmgr.exe", "/i:sysoc.inf /u:\"" + fileName + " \ "")
    Dim fileName As String = System.IO.Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.System), "MSMQAnswer.ans")
    Dim writer As New StreamWriter(fileName)

    ' Override the 'Install' method of the Installer class. When overridden in a derived class, performs the installation.
    'You must override the Install and Uninstall methods to add the code to perform your custom installation steps.
    Public Overrides Sub Install(ByVal mySavedState As IDictionary)
        MyBase.Install(mySavedState)
        Dim loaded As Boolean = False
        Dim fileName As String
        Dim writer As StreamWriter
        Dim p As Process

        Try
            Dim handle As IntPtr = LoadLibrary("Mqrt.dll")
            If handle = IntPtr.Zero Or handle.ToInt32 = 0 Then
                loaded = False
            Else
                loaded = True
                FreeLibrary(handle)
            End If
        Catch ex As Exception
            loaded = False
        End Try

        If Not loaded = True Then
            If Environment.OSVersion.Version.Major < 6 Then ' windows xp or earlier
                fileName = System.IO.Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.System), "MSMQAnswer.ans")
                writer = New System.IO.StreamWriter(fileName)
                Using writer
                    writer.WriteLine("[Version]")
                    '  writer.WriteLine("Signature = \"$Windows NT$\"")
                    writer.WriteLine("Signature = \""$Windows NT$\""")
                    writer.WriteLine()
                    writer.WriteLine("[Global]")
                    writer.WriteLine("FreshMode = Custom")
                    writer.WriteLine("MaintenanceMode = RemoveAll")
                    writer.WriteLine("UpgradeMode = UpgradeOnly")
                    writer.WriteLine()
                    writer.WriteLine("[Components]")
                    writer.WriteLine("msmq_Core = ON")
                End Using
                p = New System.Diagnostics.Process()
                Using p
                    Dim startInfo As New ProcessStartInfo("sysocmgr.exe", "/i:sysoc.inf /u:\" + fileName + " \ ")
                    p.StartInfo = startInfo
                    p.Start()
                    p.WaitForExit()
                End Using
            Else 'windows vista or later, server 03 
                p = New System.Diagnostics.Process
                Using p
                    Dim startInfo As New ProcessStartInfo("ocsetup.exe", "MSMQ-Container;MSMQ-Server /passive")
                    p.StartInfo = startInfo
                    p.Start()
                    p.WaitForExit()
                End Using
            End If
        End If

    End Sub

End Class 
```

# opengl - 保存大于窗口的openGL FBO的问题

> ID：682517
> 
> 赞同：10
> 
> 时间：2009-03-25T17:04:44.310
> 
> 标签：opengl, fbo, openframeworks

我正在渲染到 OpenGL 屏幕外帧缓冲区对象，并希望将其保存为图像。请注意，**FBO**大于显示尺寸。我可以渲染到屏幕外缓冲区并将其用作纹理，这很有效。我可以使用偏移量在显示器上“滚动”这个更大的纹理，这让我确信我渲染到比窗口更大的上下文中。

如果我将屏幕外缓冲区保存到图像文件中，它总是会被裁剪。保存的代码片段是：

```
void ofFBOTexture::saveImage(string fileName) { 
    glReadBuffer(GL_COLOR_ATTACHMENT0_EXT); 
    // get the raw buffer from ofImage
    unsigned char* pixels = imageSaver.getPixels();
    glReadPixels(0, 0, 1024, 1024, GL_RGB, GL_UNSIGNED_BYTE, pixels); 

    imageSaver.saveImage(fileName); 
} 
```

请注意，图像内容被裁剪，可见部分被正确保存（这意味着像素格式没有错误，GL_RGB 问题等），但剩余空间被一种颜色填充。

所以，我的问题是——我做错了什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-26T09:31:39.397

最后我解决了这个问题。

我必须激活 fbo 才能保存其内容：

```
glBindFramebufferEXT(GL_FRAMEBUFFER_EXT, fbo);
// save code
...
glBindFramebufferEXT(GL_FRAMEBUFFER_EXT, 0); 
```

而只选择通过的`glReadPixels`fbo

```
glReadBuffer(GL_COLOR_ATTACHMENT0_EXT); 
```

还不够。

（所有其他正确和测试的东西，例如视口大小、缓冲区的宽度和高度、图像纹理等）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T17:16:35.217

有两个问题要开始：你是如何创建 imageSaver 的，你确定你的宽度和高度是正确的（例如你想保存一个 1024 x 1024 的图像吗？你得到什么尺寸）？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T17:40:57.530

您没有做错任何事情，长期以来，这在 OpenGL 图形驱动程序中一直很常见-我记得至少十年前在 nVidia Geforce 3 卡上遇到了完全相同的问题，我采用了类似的解决方案-渲染到离屏纹理。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-26T09:12:53.483

这听起来像你有错误的视口大小或类似的东西。

# .net - 为什么 Visual Studio 在下一行而不是故障行中显示我的一些异常？

> ID：682523
> 
> 赞同：4
> 
> 时间：2009-03-25T17:05:43.167
> 
> 标签：.net, visual-studio, exception, exception-handling

VS 的通常行为是以黄色显示故障线：

```
 int i = 1;
    switch (i)
    {
        default:
            throw new NotImplementedException(); //this will be yellow
    } 
```

但是，我经常目睹错误的线被着色，就像在这个例子中一样：

```
 int i = 1;
        switch (i)
        {
            default:
                if (i==1)
                     throw new NotImplementedException();
                break;  i = 1; //this line is displayed in yellow, which makes no sense
        } 
```

虽然我了解这两个片段之间的一些差异（在第一种情况下，“throw...”行是该方法的最后一个可执行行，因此不会为之后的代码生成 IL，因此它是最后一个可能的行来“显示”异常），我想知道当 VS 未能在第二个片段的正确行上显示异常时。

有人对这种奇怪行为的原因有任何暗示吗？尽管知道这个警告，但有时我还是会花几分钟调试错误的线路。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T17:14:06.597

如果代码已更新，但代码尚未编译（在编辑和继续时经常发生），则行号将关闭。我以前也遇到过不少这样的事情。这是我确定发生这种情况的原因之一。

我知道发生这种情况的另一种情况是，当您具有由于某种原因未重建的 DLL 依赖项时（Visual Studio 有时会对其 DLL 依赖项树进行 fubared），它也会在调试时突出显示错误的行。这类似于编辑和继续问题。

我能想到的另一件事是，我很少注意到 Studio 会突出显示代码将返回的行......在抛出异常并点击继续后，代码将继续在 x 行执行......但我不完全知道如何重现它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T17:16:33.033

我认为关键是“如果”条款。我在单步执行代码时看到了相同的行为。如果 if 块中的单个语句周围没有“{}”，则可以将当前语句指示为您期望的行之后的行。

# c++ - 将 OCX 控件添加到资源对话框（如何控制它）

> ID：682530
> 
> 赞同：1
> 
> 时间：2009-03-25T17:07:51.667
> 
> 标签：c++, dialog, resources, composite, ocx

我正在将 OCX 添加到我在 C++ 项目中创建的资源对话框中。
ocx 正确添加；但我的问题是如何以编程方式访问 ocx？
我没有看到附加的成员变量（甚至是类）。

这是我的 .rc 内容

///////////////////////////////////////// ///////////////////////////对话框信息//

IDD_LENELDECODER DLGINIT BEGIN IDC_MATRIXCONTROL1, 0x376, 26, 0 0x0000, 0x0000, 0x0900, 0x0000, 0x4c7b, 0x0000, 0x3643, 0x0000, 0x0013, 0x0065, 000, 0x000xff, 0, x

其中 IDC_MATRIXCONTROL1 是与 ocx 关联的 ID。我的问题是，如何从一个类中访问这个 ocx 的成员变量；以及如何在对话框调整大小时使其调整大小？

我已经尝试过 MFC ActiveX 和 ATL Project -> ATL Control (composite)。我认为，由于 ATL 复合控件附加了一个转到对话框，因此我可以访问它，但我不知道该怎么做。

任何帮助是极大的赞赏！谢谢，

乔伊

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T19:28:34.230

使用 MFC 时：

1.  在资源编辑器中右键单击 OCX 控件，
2.  选择“添加变量...”，
3.  输入一个类似 m_object 的名称，然后按完成终止。

现在您可以使用 m_object 访问您的 OCX 控件。

如果要调整对象的大小，则必须捕获 WM_WINDOWSPOSCHANGING 消息。

# javascript - 以编程方式将 CSS 添加到 IE 时遇到问题

> ID：682536
> 
> 赞同：4
> 
> 时间：2009-03-25T17:09:10.460
> 
> 标签：javascript, internet-explorer, dom-manipulation

我有一个小书签，它通过“链接”标签（外部样式表）将 CSS 样式表插入目标 DOM。

最近，这仅在 Internet Explorer 中停止在 Amazon.com 上运行。它适用于其他网站和其他浏览器（甚至在 Amazon.com 上）。我们用来插入样式表的技术非常简单：

```
document.getElementsByTagName('head')[0].appendChild(s); 
```

其中“s”是使用创建的链接对象`document.createElement`。即使在亚马逊上，我也可以通过 Internet Explorer 开发人员工具栏 DOM 检查器看到该元素存在。 **但是**，如果我在 JavaScript 中提醒`document.styleSheets`集合，它就不存在了。

作为测试，我尝试使用仅限 IE 的[document.createStyleSheet](http://msdn.microsoft.com/en-us/library/ms531194(VS.85).aspx)方法将 URL 作为参数传递给我的样式表。这会引发错误：

> 没有足够的存储空间来完成此操作

兴趣点：

*   的文档`document.createStyleSheet`说，如果页面上的样式表超过 31 个，则会引发错误，但是（1）这是一个不同的错误，（2）页面上只有 10 个外部样式表。
*   我对错误的谷歌搜索出现了许多死胡同，唯一一个建议与样式表相关的是[这个 drupal post](http://drupal.org/node/114188)，但它指的是内联样式的字符限制，而不是与外部样式有关的问题。
*   相同的代码，即使是`createStyleSheet`调用，也适用于 IE 中的其他站点。

这对我来说已经达到了“完全神秘”的状态。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T17:49:38.070

我刚试过这个

```
javascript:(function(d) { d.createStyleSheet().cssText="* {color:blue !important;}"   })(document); 
```

和

```
javascript:(function(d) { d.createStyleSheet("http://myschemas.com/pub/clear.css") })(document); 
```

来自 amazon.com 上的 IE，两者都有效。也许您需要将 !important 添加到您的 css 的某些项目以确保它们现在生效？

更新：为您找到了可能的解决方案...

```
javascript:(function(c) {c[c.length-1].addImport("http://myschemas.com/pub/clear.css")})(document.styleSheets); 
```

希望它可以帮助你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-26T16:57:45.357

寻找答案，我发现 31 样式表限制在以编程方式加载 CSS 时引发此异常：

[http://www.telerik.com/community/forums/aspnet-ajax/general-discussions/not-enough-storage-is-available-to-complete-this-operation.aspx](http://www.telerik.com/community/forums/aspnet-ajax/general-discussions/not-enough-storage-is-available-to-complete-this-operation.aspx)

最初的限制在知识库文档中进行了描述（假设只发生在 IE8 及以下版本，但反复报告为发生在 IE9 中）：

[http://support.microsoft.com/kb/262161](http://support.microsoft.com/kb/262161)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T19:35:22.170

这就是我所做的一切，而且我从未见过它不起作用。

```
loadCss = function( name, url ) {

    var head = document.getElementsByTagName('head')[0];

    var link = document.createElement("link");

    link.setAttribute("type", "text/css");

    link.setAttribute("rel", "stylesheet");

    link.setAttribute("href", url);

    link.setAttribute("media", "screen");

    head.appendChild(link);
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-11-29T03:42:38.573

我正在使用 jQuery 做类似的事情，发现我必须按以下顺序进行操作：

```
var $link = $('&lt;link&gt;');
$('head').add($link);
$link.attr({
  type: 'text/css',
  // ... etc ...
  media: 'screen'
}); 
```

否则它在 IE 中不起作用（IE7，还没有看过 IE8）。

高温高压

# c# - 从同一个节点数据加载多个treeView

> ID：682538
> 
> 赞同：0
> 
> 时间：2009-03-25T17:09:30.680
> 
> 标签：c#, treeview

我有三个树视图，它们在加载表单时加载了相同的数据。我可以在三个不同的函数中写入数据，但这似乎重复了很多工作。如何使用相同的数据加载每个 treeView。到目前为止，我已经尝试了以下方法，但它不能正常工作。SecondRowNodes 是我之前在函数中加载的一组节点。

```
//this one misloads the first two and loads treeView4 correctly
TreeNode topNodes = new TreeNode(currentDataSet.HousingAreaTable[housingAreaCounter].HousingAreaName, secondRowNodes);
treeView2.Nodes.Add(topNodes);
treeView3.Nodes.Add(topNodes);
treeView4.Nodes.Add(topNodes);

//this one has the same effect as before and loads the first two wrong and treeView4 correctly
TreeNode topNodes = new TreeNode(currentDataSet.HousingAreaTable[housingAreaCounter].HousingAreaName, secondRowNodes);
TreeNode topNodes2 = new TreeNode(currentDataSet.HousingAreaTable[housingAreaCounter].HousingAreaName, secondRowNodes);
TreeNode topNodes3 = new TreeNode(currentDataSet.HousingAreaTable[housingAreaCounter].HousingAreaName, secondRowNodes);
treeView2.Nodes.Add(topNodes);
treeView3.Nodes.Add(topNodes2);
treeView3.Nodes.Add(topNodes3); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T17:15:31.583

有一个将树视图作为参数的函数。然后它只是用数据填充该树视图，您调用它三次，每个树视图一次。

不过，您需要在数据模型上添加更多细节。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T14:35:24.187

您实际上可能想看看不同的控件。我一直在使用 ObjectListView 来满足我几乎所有的列表视图和树视图需求。它允许您通过简单地向列表发送任何 IEnumerable 对象来填充列表。这意味着您只需更新一个列表，然后为任何或所有 TreeListView 组件调用 SetObjects 函数。花一些时间查看网站上的示例和食谱，因为它是处理列表的一种非常不同的方式。[您可以在ObjectListView](http://objectlistview.sourceforge.net/cs/index.html)找到页面和代码

# java - 使用 JDBC 连接到 oracle 从插入语句返回 ROWID 参数

> ID：682539
> 
> 赞同：5
> 
> 时间：2009-03-25T17:09:34.627
> 
> 标签：java, oracle, jdbc

我似乎无法获得正确的魔法组合来完成这项工作：

```
 OracleDataSource ods = new oracle.jdbc.pool.OracleDataSource();
ods.setURL("jdbc:oracle:thin:app_user/pass@server:1521:sid");
DefaultContext conn = ods.getConnection();
CallableStatement st = conn.prepareCall("INSERT INTO tableA (some_id) VALUES (1) RETURNING ROWID INTO :rowid0");
st.registerReturnParameter(1, OracleTypes.ROWID);
st.execute(); 
```

我得到的错误是“违反协议”。如果我更改为 registerOutParameter()，我会收到通知说我尚未注册所有返回变量。如果我将语句包装在 PL/SQL 开头；结尾; 块然后我使用常规的 registerOutParameter() 调用得到参数就好了。我真的更愿意避免在 PL/SQL 中包装我的所有插入语句 - 那么上面缺少什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-19T07:33:19.797

通常你不想让代码数据库依赖。您应该使用 CallableStatement 而不是 OraclePreparedStatement。

```
CallableStatement statement = connection.prepareCall("{call INSERT INTO tableA (some_id) VALUES (1) RETURNING ROWID INTO ? }");
statement.registerOutParameter( 1, Types.VARCHAR );

int updateCount = statement.executeUpdate();
if (updateCount > 0) {
   return statement.getString(1);
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-04T08:32:38.343

你需要做的几件事

*   将 CallableStatement 更改为 OracleCallableStatement
*   尝试返回一个NUMBER，即：OracleTypes.Number

从查询返回信息的示例代码：

```
OraclePreparedStatement pstmt = (OraclePreparedStatement)conn.prepareStatement(
       "delete from tab1 where age < ? returning name into ?");
pstmt.setInt(1,18);

/** register returned parameter
  * in this case the maximum size of name is 100 chars
  */
pstmt.registerReturnParameter(2, OracleTypes.VARCHAR, 100);

// process the DML returning statement
count = pstmt.executeUpdate();
if (count>0)
{
  ResultSet rset = pstmt.getReturnResultSet(); //rest is not null and not empty
  while(rset.next())
  {
    String name = rset.getString(1);
    ...
  }
} 
```

有关 Oracle 的 JDBC 扩展的更多信息：

*   [http://download-uk.oracle.com/docs/cd/B19306_01/java.102/b14355/oraint.htm](http://download-uk.oracle.com/docs/cd/B19306_01/java.102/b14355/oraint.htm)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-25T17:40:29.620

不知道这是否适用，因为您没有指定您使用的版本。

来自 Oracle Metalink：

**原因**

在 10.1.0.x JDBC 驱动程序中，不支持返回 DML：

根据 JDBC 常见问题解答：“10.1.0 (10g r1) 是否支持 DML 返回？不在当前驱动程序中。但是，我们确实计划在 10.1.0 后的驱动程序中支持它。这次我们是认真的。”

由于应用程序代码尝试使用不受支持的 JDBC 功能，因此会引发错误。

**解决方案**

将 JDBC 驱动程序升级到 10.2.0.x，因为根据常见问题解答，10.2.0.x JDBC 驱动程序确实支持返回子句：

“10.2.0 (10g r2) 是否支持 DML 返回？是的！时间到了。有关详细信息，请参阅开发人员指南。”

**编辑** 只是为了笑，您可以检查 Oracle 认为它使用的 JDBC 版本：

```
 // Create Oracle DatabaseMetaData object
  DatabaseMetaData meta = conn.getMetaData();

  // gets driver info:
  System.out.println("JDBC driver version is " + meta.getDriverVersion()); 
```

如果这显示 JDBC 驱动程序 10.2.0.x 或更高版本，那么我没有想法，也许对 oracle 的支持请求是有序的......

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-09-02T07:24:44.173

```
PreparedStatement prepareStatement = connection.prepareStatement("insert...",
            new String[] { "your_primary_key_column_name" });

    prepareStatement.executeUpdate();

    ResultSet generatedKeys = prepareStatement.getGeneratedKeys();
    if (null != generatedKeys && generatedKeys.next()) {
         Long primaryKey = generatedKeys.getLong(1);
    } 
```

我找到了答案，这是完全有效的。我可以从 JAVA 插入并用密钥返回。

完整版本：

```
CREATE TABLE STUDENTS
(
   STUDENT_ID   NUMBER NOT NULL PRIMARY KEY,
   NAME         VARCHAR2 (50 BYTE),
   EMAIL        VARCHAR2 (50 BYTE),
   BIRTH_DATE   DATE
);

CREATE SEQUENCE STUDENT_SEQ
   START WITH 0
   MAXVALUE 9999999999999999999999999999
   MINVALUE 0; 
```

和Java代码

```
String QUERY = "INSERT INTO students "+
               "  VALUES (student_seq.NEXTVAL,"+
               "         'Harry', 'harry@hogwarts.edu', '31-July-1980')";

// load oracle driver
Class.forName("oracle.jdbc.driver.OracleDriver");

// get database connection from connection string
Connection connection = DriverManager.getConnection(
        "jdbc:oracle:thin:@localhost:1521:sample", "scott", "tiger");

// prepare statement to execute insert query
// note the 2nd argument passed to prepareStatement() method
// pass name of primary key column, in this case student_id is
// generated from sequence
PreparedStatement ps = connection.prepareStatement(QUERY,
        new String[] { "student_id" });

// local variable to hold auto generated student id
Long studentId = null;

// execute the insert statement, if success get the primary key value
if (ps.executeUpdate() > 0) {

    // getGeneratedKeys() returns result set of keys that were auto
    // generated
    // in our case student_id column
    ResultSet generatedKeys = ps.getGeneratedKeys();

    // if resultset has data, get the primary key value
    // of last inserted record
    if (null != generatedKeys && generatedKeys.next()) {

        // voila! we got student id which was generated from sequence
        studentId = generatedKeys.getLong(1);
    }

} 
```

来源：http: [//viralpatel.net/blogs/oracle-java-jdbc-get-primary-key-insert-sql/](http://viralpatel.net/blogs/oracle-java-jdbc-get-primary-key-insert-sql/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T17:22:18.400

尝试使用**？**而不是**:rowid0**在您的 SQL 字符串上。我之前在命名参数和 Oracle 方面遇到过问题。

# mysql - MySQL：视图与存储过程

> ID：682544
> 
> 赞同：35
> 
> 时间：2009-03-25T17:10:33.703
> 
> 标签：mysql, performance, database-design, stored-procedures, views

自从 MySQL 开始支持存储过程以来，我从未真正使用过它们。部分原因是我不是一个出色的查询编写者，部分原因是我经常与为我做出这些选择的 DBA 一起工作，部分原因是我只是对我所知道的感到满意。

在进行数据选择方面，特别是在考虑本质上是数据的非规范化（连接）和聚合（平均或最大值，子查询/计数等）选择时，MySQL 5.x 中的正确选择是什么? 一个看法？还是存储过程？

我很满意的视图 - 你知道你的 SELECT 查询应该是什么样子，所以你只需创建它，确保它被索引等等，然后只需执行`CREATE VIEW [View] AS SELECT [...]`. 然后，在我的应用程序中，我将视图视为只读表 - 它表示我的规范化数据的非规范化版本。

这里有什么缺点 - 如果有的话？如果我将完全相同的 SELECT 语句移动到存储过程中会发生什么变化（收益或损失）？

我希望找到一些在谷歌搜索该主题时很难找到的“幕后”信息，但我真的欢迎所有评论和答案。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-25T17:16:08.807

在我看来，当需要在多个不同的应用程序之间使用相同的例程或用于数据库或表之间的 ETL 时，存储过程应该仅用于数据操作，仅此而已。基本上，在您遇到 DRY 原则或您所做的只是将数据从数据库中的一个地方移动到另一个地方之前，尽可能多地使用代码。

视图可用于为数据提供替代或简化的“视图”。因此，我会选择一种观点，因为您并没有真正操纵数据，而是找到了一种不同的显示方法。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-25T17:18:27.490

不确定这是否是非此即彼的选择。存储过程可以做很多视图难以完成的事情（想想在临时表中填充数据，然后在其上运行游标，然后进行聚合并返回结果集）。

另一方面，视图可以隐藏复杂的 sql / 访问权限并呈现模式的修改视图。

我认为两者都在事物方案中占有一席之地，并且对于成功的模式实现都很有用。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-25T18:51:51.307

我使用视图进行反规范化或输出格式化，并使用存储过程进行过滤和数据操作（需要参数输入的事物）或迭代（光标）。

当需要反规范化和过滤时，我经常访问存储过程中的视图。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-06-26T01:26:50.133

需要注意的一点是，至少 mysql 视图结果存储在一个临时表中，并且与大多数体面的数据库引擎不同，该表没有索引，因此如果仅用于简化查询，当您的程序要获取所有数据时，视图非常好结果来自视图，但是，如果您随后根据参数搜索该视图的结果，则速度非常慢，尤其是在要筛选数百万条记录的情况下，如果视图建立在其他视图之上，则更糟，依此类推。

一个存储过程，但是您可以将这些搜索参数传入并直接针对下划线（索引）表运行查询。缺点是每次运行过程时都需要获取结果，这也可能发生在视图中，具体取决于服务器配置。

所以基本上如果您使用视图尝试最小化结果数量（如果您需要搜索它），则使用存储过程。

# c# - C# VSTO Outlook 2007 / Sharepoint：插件不会保存联系人项目

> ID：682547
> 
> 赞同：2
> 
> 时间：2009-03-25T17:11:59.987
> 
> 标签：c#, sharepoint, vsto, outlook-2007, outlook-addin

有人可以帮忙吗：我有一个从 Sharepoint 服务器读取联系人的插件。用户可以加载联系人并进行一些更改或创建一个新联系人。在他看来，保存该项目效果很好。表单关闭，项目正在传输到 Sharepoint。但是，如果用户再次重新打开同一个联系人并尝试进行简单的更改，则无法保存：该元素无法保存，因为它已被另一个用户或窗口更改。你想在你的标准文件夹中放置一个副本吗”（这是我从德语到英语的翻译......）用户必须重新启动 Outlook 才能进行更改！我不知道为什么会发生“fxxx”。

我连接到“写入”事件以检查一些权利，如果一切正常，我会做一个

```
Marshal.ReleaseComObject(item);
this.Dispose(); 
```

并调用垃圾收集器：

```
GC.WaitForPendingFinalizers();
GC.Collect(); 
```

即使我将这些行写入 FormRegionClosed-Method，问题仍然存在。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T18:47:25.140

Yeehaaaa：发现问题了！

在 AddIn-Startup 中有一个事件处理程序，用于在当前项目上设置消息类。这个项目也必须是 Marshall'd

# domain-driven-design - DDD / 存储库

> ID：682549
> 
> 赞同：3
> 
> 时间：2009-03-25T17:12:13.853
> 
> 标签：domain-driven-design, repository

我对 DDD 很陌生。我的 SQL 表包含一个样式列表，每个样式都有颜色和大小。现在，我正在开发一个应用程序，用户将在其中看到三个下拉列表，一个用于样式，一个用于颜色，一个用于大小。现在最初这些下拉列表加载了不同的值。然后用户能够选择一种样式，然后系统将能够找到该选定样式的所有颜色/尺寸。用户可以对颜色执行相同的操作，它将加载与所选颜色和尺寸相匹配的样式。你明白了。

这些是我的基本要求。现在我正在考虑为样式创建一个存储库（StyleRepository）并让它加载所有样式，并在需要时加载子颜色和子大小。

但是，正如我的应用程序中所述，我还需要加载不同的颜色或尺寸。现在建议创建三个存储库而不是 StyleRepository、ColorRepository、SizeRepository 还是我会创建一个完全不同的存储库？

如前所述，我对此相当陌生，并会感谢您的建议。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T17:57:44.353

样式似乎是您的根聚合对象。这就是您构建存储库的原因。

由于每种样式都有该样式允许的特定颜色和尺寸子集，因此每个样式都应包含一个颜色和样式列表。

```
public class Style
{
   public IList<Color> Colors { get; set;}
   public IList<Size> Sizes { get; set;}
} 
```

然后，您的存储库将有一个 FindAll() 方法来返回所有样式。每种样式都有自己的颜色和尺寸列表，因此无需再次访问存储库即可获得这些。当用户从下拉列表中选择特定样式（希望您已绑定样式对象）时，您可以从所选对象中获取颜色和尺寸列表并填充其他下拉列表。

当用户选择特定的样式、颜色和大小时，我会假设它保存在一个单独的类中，例如 SelectedStyle 类，它只包含一个颜色和大小属性。

```
public class SelectedStyle
{
   public Color Color { get; set;}
   public Size Size { get; set;}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T17:23:04.517

由于您的情况下的颜色是样式使用的实际颜色，而不仅仅是抽象颜色列表（如在绘画应用程序中），我会使用 StyleRepository 和添加方法，如 GetAllUsedColors()。

# asp.net-mvc - ASP.Net MVC 有一个动作渲染另一个动作

> ID：682550
> 
> 赞同：4
> 
> 时间：2009-03-25T17:12:39.173
> 
> 标签：asp.net-mvc

我需要两个页面，并希望显示 url /index 和 /review。两个页面之间的唯一区别在于评论我将有一个评论评论部分来显示和提交按钮。否则这两个页面是相同的。我想我可以为主要内容创建一个用户控件。

但是，如果我可以在 Review 操作下说，标记以显示评论内容，然后他们返回 index 操作的其余部分。

你（一般的你）将如何做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-25T21:05:18.397

**型号示例**

```
public class MyModel
{
  public bool ShowCommentsSection { get; set; }
} 
```

**控制器动作**

```
public ActionResult Index()
{
  var myModel = new MyModel();

  //Note: ShowCommentsSection (and the bool type) is false by default.

  return View(myModel);
}

public ActionResult Review()
{
  var myModel = new MyModel
  {
    ShowCommentsSection = true
  };

  //Note that we are telling the view engine to return the Index view
  return View("Index", myModel);
} 
```

**查看（可能在 index.aspx 中的某个位置）**

```
<% if(Model.ShowCommentsSection) { %>
  <% Html.RenderPartial("Reviews/ReviewPartial", Model); %>
<% } %> 
```

或者，如果 Razor 是您的一杯茶：

```
@if(Model.ShowCommentsSection) {
  Html.RenderPartial("Reviews/ReviewPartial", Model);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-25T17:21:16.687

```
// ... Make comment section visible
return Index(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T17:22:49.960

为什么不总是包含评论评论表单并使用客户端代码来显示或隐藏它。考虑到审查页面不需要额外的数据，除了索引上已经需要的数据之外，不需要到控制器的往返行程。这将允许您删除审查操作和视图。

# c# - 创建取消方案

> ID：682553
> 
> 赞同：1
> 
> 时间：2009-03-25T17:13:41.357
> 
> 标签：c#, events, program-flow

我有一个程序可以分析源代码。它可以递归遍历一个目录找到所有项目，然后递归遍历项目找到所有源代码。

我想创建一个取消进程按钮，它允许用户停止代码解析。我在后台工作人员中运行代码解析。我希望能够观看取消事件。

问题是弄清楚如何编辑我的代码，以便它会检查该项目并返回到 GUI。解析过程深入了几个方法。

在一个小得多的过程中，我成功地使用了一个线程安全的单例，它有一个布尔值，表示是否已请求取消，并在它运行的地方停止循环。

将此取消请求处理到我的代码中的最佳方法是什么？

编辑：这是一个想法，灵感来自约翰桑德斯的回答。

~~如果我在我的处理线程中运行一个后台线程来监视 Cancel Singleton 的变化，然后从该进程中抛出一个异常怎么办？这似乎是一种很好的做法？~~ 这不能按预期工作

编辑 2：John Saunders 的回答似乎是目前最好的。当 Singleton 现在为真时，我只会抛出我自己的异常。我会等着看是否提出任何其他解决方案

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T17:33:10.327

Thread.Abort 是一个坏主意，因为它会在任意点中断线程 - 可能会在您最不希望被中断的地方中断它。

设置一个被取消的线程看到的标志。在每个操作开始时检查它。这个想法是识别代码中可以安全停止的位置，并仅在这些点检查标志。

您可能会发现在这些点抛出异常很有用。异常应该是在到达代码和 UI 之间的边界之前未被代码捕获的异常。那时，您的代码将简单地返回。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T17:26:59.450

您可以`Thread.Abort()`在后台工作线程上使用该函数。这会抛出一个`ThreadAbortException`你可以在你的任何方法中捕获的，但它会在块的末尾自动重新抛出`catch`。

所有`finally`-blocks 也将被执行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T17:32:55.397

听起来您正在使用 .NET backgroundworker 类。我认为您可以将对象参数传递给 RunWorkerAsync 方法，然后 DoWork 事件处理程序参数中的后台线程可以访问该方法。

然后，您可以在 UI 线程中修改该对象（例如更新布尔取消属性）并定期从后台进程中检查它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T18:41:18.307

有多种方法可以取消线程操作；所有这些都涉及定期检查标志或其他值以确定线程是否应该继续运行。

我不建议为此功能抛出异常。首先，取消不是一种特殊情况，其次，对于您要实施的内容来说，它是矫枉过正的。

相反，您可以使用一个简单的、线程安全的布尔标志作为可从任何线程访问的类的静态成员，或者使用诸如命名[Mutex](http://msdn.microsoft.com/en-us/library/system.threading.mutex.aspx)之类的同步对象。然后，向同步对象发出信号将使线程知道它必须取消。

# c# - PropertyGrid 中的枚举 - 简单的自定义排序顺序

> ID：682556
> 
> 赞同：0
> 
> 时间：2009-03-25T17:14:16.847
> 
> 标签：c#

我有一个枚举，我想自定义它出现在属性网格下拉列表中的顺序。

```
public enum Dir : int
{
   None = 0,
   North = (1 << 1),
   South = (1 << 2),
   East = (1 << 3),
   West = (1 << 4),
   NorthWest = North | West,
   NorthEast = North | East,
   SouthWest = South | West,
   SouthEast = South | East
} 
```

我希望下拉列表以与我声明枚举的顺序相同的顺序出现，而是按数字顺序排序。

我知道可以使用类型转换器，但是没有它可以做到吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T17:22:39.213

这些值是固定的吗？我假设您正在使用类似伪标志的枚举来确定该值是否“完全像北方”。如果是这种情况（这有点奇怪——这意味着你可以拥有`South | North`，但没关系）如果你也设置一个额外的位会很重要吗？

```
public enum Dir : int
{
   None = 0,
   North = (1 << 1),
   South = (1 << 2),
   East = (1 << 3),
   West = (1 << 4),
   NorthWest = (1 << 5) | North | West,
   NorthEast = (1 << 6) | North | East,
   SouthWest = (1 << 6) | South | West,
   SouthEast = (1 << 7) | South | East
} 
```

这将使其保持数字顺序。（如果你可以让 West 在 East 之前出现，或者 NorthEast 在 NorthWest 之前出现等，那将会更容易和更一致。然后你可以将`(1 << 5)`它们用作所有它们的额外位。

# resources - 重组项目以进行扩展/重用

> ID：682557
> 
> 赞同：2
> 
> 时间：2009-03-25T17:14:19.433
> 
> 标签：resources, fork, code-reuse

我正在从事的项目的范围正在扩大。该应用程序相当简单，但目前针对的是一个非常具体的利基市场。在不久的将来，我被要求分叉该项目以瞄准新市场并继续同时开发这两个项目。

这两个项目将在功能上相似，因此有很强的动力去概括原始项目的许多*内容*。此外，我确信我会在不久的将来瞄准更多市场（这些市场是地域性的）。

问题是该项目的先前维护者做出了许多将其与原始市场联系起来的假设。将通用代码与市场特定代码分开需要进行相当多的重构。

为了使事情变得更复杂，关于如何为越来越多的市场组织项目，已经提出了一些建议：

1.  每个市场都是一个独立的项目，项目之间的共性被移动到一个共享库中，项目独立部署。
2.  扩展现有项目以针对多个市场，根据购买的许可证限制功能。
3.  创建父应用程序并将项目重新设计为插件，单独购买

所有三个建议都有优点，理想情况下，我希望代码结构足够灵活，只要稍作调整，就可以实现其中任何一个。建议 3 似乎是最令人生畏的，因为它需要构建一个插件架构。前两个建议更合理一些。

*关于这些不同架构的优缺点，是否有任何好的资源可用？*

*在项目之间共享代码与复制和分叉的优缺点是什么？*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-12T15:02:09.150

最初，分叉通常会给您带来更快的结果，但几乎总是会在维护时出现并咬您一口——一个叉子的错误修复和功能增强在其他叉子中丢失了，最终您发现自己扔掉了整个叉子并且必须将他们的功能重新添加到“最佳”分叉中。如果可以的话，避免它。

继续：您的所有三个选项都可以工作，但它们在构建复杂性、维护成本、部署、通信开销和您需要进行的重构量方面需要权衡取舍。

* * *

**1\. 每个市场都是一个独立的项目**

如果您要同时为多个市场开发，这是一个很好的解决方案。

优点：

*   它允许市场 A 的开发人员在不干扰 B 正在进行的工作的情况下打破 A 构建
*   这使得对市场 A 的更改不太可能导致市场 B 的错误

缺点：

*   您必须花时间分离出共享代码
*   您必须花时间设置并行构建
*   对共享代码的修改现在会产生更多开销，因为它们会影响两个团队。

**2\. 扩展现有项目以瞄准多个市场**

可以让它正常工作一段时间。如果您打算在一个小团队中一次为一个市场开发版本，那么这可能是您最好的选择。

优点：

*   无论如何，许可工作可能很有价值，即使您朝着 (1) 或 (3) 前进。
*   单一代码库允许在所有市场进行重构。

缺点：

*   即使你只是在为市场 A 做一些事情，你也必须为市场 B、C 和 D 构建和发布代码——如果你的代码库很小，还可以，但是当你进入数千个市场时会越来越烦人班级
*   改变一个市场可能会破坏其他市场的代码
*   一个市场的变化需要重新测试其他市场

**3.创建父应用程序并将项目重新设计为插件**

在技​​术上感觉很甜蜜，并且可能允许您共享更多代码。

优点：

*   (1) 的所有优点，可能还有：
    *   共享代码和市场特定代码更清晰的分离
    *   可能允许您转向公共 API，这将允许将您的一些工作卸载给您的客户和/或销售利润丰厚的服务项目

缺点：

*   (1) 的所有缺点，加上需要更多的重构。

* * *

我猜想（2）是你现在发现自己的地方，除了许可。我认为在那儿呆一会儿是可以的，但要花一些精力朝着（1）前进——将共享代码移动到一个单独的项目中，即使它们都是一起构建的，例如，试图确保来自市场的依赖关系代码到共享代码都是单向的。

你最终是（1）还是（3）取决于。主要取决于谁在“负责”——共享代码，还是特定于市场的代码？插件和配置一些共享组件的控制器类之间的界限可能非常模糊。我的建议是，让代码告诉你它需要什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T17:43:46.290

1）不！您不想管理同一代码库的不同分支...因为尽管代码可能很常见，但您会想要进行彻底的更改，并且一个项目“目前”不会像其他项目那么重要，然后你会得到一个分支比其他分支增长得更快......插入雪球。

2）这或多或少是行业标准。大配置文件，根据许可证/配置限制事物。它可能会使应用程序有点麻烦，但只要代码抱怨相互排斥的东西，并且所有开发人员都在不断就新功能以及它们如何在整个应用程序中产生影响进行沟通，你就应该做得很好。如果这是一个问题，这也是最容易破解的。

3）这也“可以”工作。如果你使用 C#，插件相对简单，你只需要担心依赖地狱。如果插件有任何机会变得循环相互依赖（即，a 需要 b 需要 c 需要 a），那么这将很快爆发，您将（很容易）恢复到＃2。

你拥有的最好的资源可能是你的同事过去在不同项目上的经历，以及人们在这里或 Slashdot 或任何地方喋喋不休的经历。当然是最便宜的。

共享代码的优点：一个改变改变一切。统一的数据模型。只有一个真理。（每个人都更容易在同一页面上）

共享代码的缺​​点：一个更改会改变一切。小心。如果其中有一个错误，它会影响一切。

复制/分叉的优点：通常更快地为特定客户实施特定功能。当您意识到假设 A 仅适用于市场 B 和 C，而不适用于 D 时，可以更快地破解。

复制/分叉的缺点：由于代码缺乏凝聚力，一个或多个复制的项目最终会失败。如上所述：彻底改变需要更长的时间。

祝你好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-18T22:27:25.140

您说“复制和分叉”，这让我认为您可能没有考虑将这个“分叉”作为 SVN 等修订控制系统中的一个分支来管理。通过这样做，当您重构分支以适应不同的行业时，您可以借助修订控制系统将这些更改合并回主干。

如果您遵循迁移到单个应用程序的长期策略，其中所有变体都由配置文件（或 SQLITE 配置数据库）控制，那么这种方法将对您有所帮助。在您确信已将其推广到两个行业之前，您不必合并任何东西，因此您仍然可以根据需要构建两个独特的系统。但是，您不会把自己逼到角落里，因为它都在一个源代码树中，是传统行业的主干，每个新行业都有一个分支。

如果您的公司真的想进军多个行业，那么我认为配置数据库解决方案无法满足您的所有需求。您仍然需要某种特殊的代码模块。插入式架构是一件好事，因为它会有所帮助，特别是如果您将 Python 之类的脚本引擎嵌入到您的应用程序中。但是，我认为当您进入“数千个类”规模时，插件将无法满足您所有的代码变化要求。

您需要采取一种务实的方法，让您现在可以为新行业构建一个单独的应用程序，但随着您的进展，将改进合并到现有应用程序中相对容易。您可能永远无法达到拥有数千个课程和多个行业的单一主干的涅槃，但您至少会驯服复杂性，并且只需要处理行业需求中存在真正差异的真正重要的变化。

如果我站在你的立场上，我也会查看应用程序中可能被视为“报告”的所有功能，并尝试将它们排除在外，甚至可能放入现成的报告工具中。

# internet-explorer - Internet Explorer 6 测试

> ID：682559
> 
> 赞同：15
> 
> 时间：2009-03-25T17:14:33.507
> 
> 标签：internet-explorer, testing, cross-browser

有没有办法在已经安装了 Firefox 和 Internet Explorer7 的计算机上测试 Internet Explorer 6 中的网站，而无需：

*   使用虚拟机
*   卸载 Internet Explorer 7 并安装 Internet Explorer 6（如果可能的话）

* * *

**复制**

*   [是否可以出于调试目的从 Internet Explorer 7 降级到 Internet Explorer 6？](https://stackoverflow.com/questions/421945)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-25T17:20:44.660

这能解决你的问题吗：

[适用于 Windows Internet Explorer 的 Microsoft Expression Web SuperPreview](http://www.microsoft.com/en-us/download/details.aspx?id=2020)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-25T17:20:12.760

Microsoft 已发布免费的[Virtual PC](http://en.wikipedia.org/wiki/Windows_Virtual_PC)映像，用于 Internet Explorer 兼容性测试。你可以在[这里](http://www.microsoft.com/downloads/details.aspx?FamilyID=21eabb90-958f-4b64-b5f1-73d0a413c8ef&displaylang=en)找到它。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-25T17:29:40.037

下载[Microsoft VirtualPC](http://www.microsoft.com/windows/products/winfamily/virtualpc/default.mspx)。然后下载[Internet Explorer Application Compatibility VPC Image](http://www.microsoft.com/downloads/details.aspx?FamilyId=21EABB90-958F-4B64-B5F1-73D0A413C8EF&displaylang=en)中的任何文件。第二次下载包含四个 VHD（虚拟硬盘）文件，它们具有：

*   XP SP2
    *   即 7
*   XP SP3
    *   IE 6、IE 8 测试版 2
*   远景SP1
    *   即 7

*我对重复问题的回答*

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-25T20:09:09.250

我有同样的问题。虚拟机可以工作，但它会使我的 1 GB 笔记本电脑慢下来。所以我最终不得不升级到 2 GB 内存并安装 Linux。我更喜欢这个。但由于这不是一个选择，这就是我遇到的。

1.  [VirtualBox](http://en.wikipedia.org/wiki/VirtualBox) - 我个人喜欢这个。如果您有 Windows XP 光盘，则此选项非常棒。特别是如果您的处理器上有虚拟化选项。

2.  [SuperPreview](http://en.wikipedia.org/wiki/Microsoft_Expression_Web#Version_history) - 虽然我不喜欢这个，但它是一种选择。我安装了 Windows 7，因为它比 Vista 和 XP 运行得更好，但它为我提供了 Internet Explorer 8。我尝试了这个，它只让我预览 Internet Explorer 8。可能是测试版太早了，或者因为我有一个测试版操作系统。不管怎样，我还不喜欢这个。

3.  [IETester](http://www.my-debugbar.com/wiki/IETester/HomePage) - 到目前为止，一个很棒的程序。在 XP 和 Vista 中完美运行。Internet Explorer 6 和 7 在 Windows 7 中不能正常工作。但如果您有 Vista，这就是要走的路。多个 Internet Explorer 在 Vista 下无法正常工作，但可以。

4.  MultipleIEs - 如上所述，这在 Vista 中不起作用，但它是任何 Windows XP 用户的一个选项。已知问题会导致您的操作系统实际上变得更加不稳定，但我不知道事实是否如此。我刚刚听到一些关于它的报道。

5.  Internet Explorer 7 Standalone - 虽然不适用于这个问题，但其他人可能会发现知道有一个独立的 Internet Explorer 7 很有用。在我的 VM 上，我默认安装了 Internet Explorer 6，而 Internet Explorer 7 是独立的。我不建议这样做，因为独立的 Internet Explorer 7 并不完美。MUltipleIEs + 正版 Internet Explorer 7 或 IETester 是更好的选择。

6.  BrowserShots.com - 浏览器截图是一个很棒的工具，但有些有限。基本上，它会在数百个浏览器上截取屏幕截图并让您查看它们。问题是它非常慢，而且您无法获得全屏预览。这不是一个很好的选择。

7.  Meer Meer - 不久前我从 Adob​​e Labs 听说过一个叫做 Meer Meer 的东西，但我一直没能真正找到它。我相信 meermeer.com 实际上也会带您访问 Adob​​e Labs 的网站。但它看起来像是一个很棒的工具，带有洋葱皮覆盖和作品。像超级预览，但在网络上而不是在本地。如果它发布，肯定会检查这个。

总的来说，我说 IETester 是一个不错的选择。然而，任何运行 Windows 7 的人都会被冷落。我尝试了所有选项，但除了 Linux 主机和 VirtualBox XP 来宾之外，它们都不适合我。不过，那是我的 2.5 美分。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-25T17:16:46.370

我通常会看到推荐的[IETester](http://www.my-debugbar.com/wiki/IETester/HomePage)，尽管我个人没有任何经验（我运行 linux 并为此使用 VirtualBox）。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-05-09T14:33:30.567

对于未来的调查者（希望它们是一个垂死的品种），[modern.IE](http://www.modern.ie/)是我找到的用于测试旧 Internet Explorer 的最佳资源。它由 Microsoft 运行，并为不同的虚拟化环境提供不同的映像。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-25T17:29:01.007

如果可以的话，试试[SuperPreview](http://www.webdesignerdepot.com/2009/03/microsoft-announces-superpreview-for-ie-browser-testing/)或[整个包（Expression Web 在 Mix 上宣布）。](http://www.istartedsomething.com/20090318/expression-web-superpreview-cross-browser-testing/)

SuperPreview 是来自 Microsoft 的新免费独立应用程序（仍处于测试阶段），它使您能够查看您的网站在不同版本的 Internet Explorer 中的外观，从而比以前更容易从 IE6 迁移到 7 和 8，而无需启动虚拟机器运行IE6，或者有一台单独的计算机专门运行IE6。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-25T17:21:28.357

试试[Xenocode Web 应用程序](http://www.xenocode.com/browsers/)。它们是虚拟化的，但不是成熟的虚拟机。

Virtual PC 2007 不受 MS 影响，不是 VM-Ware。不确定您的要求是没有 VM 还是没有 VM-Ware。MS 提供的测试虚拟机运行良好。

据我所知，第 3 方的多个 IE 测试人员中的任何一个都存在兼容性问题，即它们并非 100% 准确于原始浏览器版本。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-25T18:30:20.470

如果您能找到一个 IE 6 安装程序可执行文件，那么您可以使用名为“Altris 软件虚拟化解决方案” [SVS.21.Personal.zip的非常方便的应用程序](http://dl.getdropbox.com/u/631582/Downloads/SVS_21_Personal.zip)

基本上，它允许您创建可以启用或禁用的图层。它可以通过捕获安装可执行文件所做的更改来创建层。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-25T22:34:22.160

虽然你特意说不想用VMWare，但有没有考虑过VMWare ThinAPP？

它可以有效地让您构建一个 EXE，让您在同一台计算机上同时运行 IE6 和 IE7，而不会产生运行整个虚拟机的性能成本。它有点贵（6000 美元），购买你只需要为你构建虚拟版 IE 的机器购买一个许可证。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-25T17:16:51.237

允许 IE6 和 IE7 一起使用的解决方案可能无法为您提供真正的普通 IE6，因此它可能不是您应该寻找的。我使用[http://www.virtualbox.org/](http://www.virtualbox.org/)，它比 VM-ware 轻。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-25T17:23:25.060

如果是为了测试渲染，您可以使用 Microsoft Expression Web SuperPreview ：[链接文本](http://blogs.msdn.com/xweb/archive/2009/03/18/Microsoft-Expression-Web-SuperPreview-for-Windows-Internet-Explorer.aspx)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-25T19:30:14.367

你应该有一台破旧的 PC 来测试。在现代、设置良好的机器上编写代码很容易，但您可能会让用户不那么幸运。过时的个人电脑很便宜或免费，如果你没有任何自己的东西放在某个地方的话。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-03-26T19:34:00.480

看看[BrowserStack](http://www.browserstack.com/)。这是一项具有实时、基于 Web 的浏览器测试的第三方服务。

# java - java.net.SocketException：管道损坏

> ID：682560
> 
> 赞同：4
> 
> 时间：2009-03-25T17:15:14.033
> 
> 标签：java, sockets, pipe, resin

我从我的应用服务器获取所有数据库连接。
这个异常发生了几个小时，然后自行修复。
与来自应用服务器的网络连接有关吗？

```
java.net.SocketException：管道损坏
com.inet.tds.SQLException: java.net.SocketException: 断管
java.net.SocketException：管道损坏
    在 java.net.SocketOutputStream.socketWrite0（本机方法）
    在 java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:92)
    在 java.net.SocketOutputStream.write(SocketOutputStream.java:136)
    在 com.inet.tds.aa（未知来源）
    在 com.inet.tds.aa（未知来源）
    在 com.inet.tds.a.commit（未知来源）
    在 com.inet.pool.a.commit（未知来源）
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T18:08:18.417

对于 MySQL，“默认情况下，如果没有发生任何事情，服务器会在八小时后关闭连接。” 而且，MySQL 有一个重新连接功能，支持在客户端检测到关闭连接后自动重新连接。

八小时？通过使用连接池或长时间运行的后台作业，这是可能的。

[http://dev.mysql.com/doc/refman/5.0/en/gone-away.html](http://dev.mysql.com/doc/refman/5.0/en/gone-away.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T17:19:57.050

这意味着您的客户端已与服务器断开连接；检查它是否正在运行。[看这里](http://java.sun.com/j2se/1.5.0/docs/api/java/net/SocketException.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T17:23:41.393

在写入期间连接被切断，这可能是由于目标关闭连接或目标进程已终止。它不是您的实施错误。

# apache - 谁能解释一下Apache服务器的结构？

> ID：682562
> 
> 赞同：-3
> 
> 时间：2009-03-25T17:15:56.840
> 
> 标签：apache

Apache Web 服务器是如何工作的？有人可以详细解释一下吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-25T17:54:52.347

[从Apache 架构概述](http://www.cs.ucsb.edu/~tve/cs290i-sp01/papers/Concept_Apache_Arch.htm)开始，了解 Apache 的基本组件和数据流。然后，您可能想进入[开发人员文档](http://httpd.apache.org/docs/2.2/developer/)，因为文档中的列表模块配置选项对于理解一切如何工作并没有太大帮助。

最后，将 Apache 与其他流行的开源服务器（例如[Lighttpd](http://www.lighttpd.net) ）进行比较，将向您展示不同程序以类似方式处理哪些任务，以及在哪些方面存在权衡（例如速度与功能）来区分服务器.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T17:19:45.537

这是魔法。甚至不要费心去理解它。

# php - PHP：解析字符串以执行替换

> ID：682572
> 
> 赞同：0
> 
> 时间：2009-03-25T17:18:12.670
> 
> 标签：php, regex, string, replace

我有一组基于文本的规则，其结构如下：

```
规则一：当[PN]大于[N]时做[XXX]
规则 2：获取 [PRD ..] 并添加 [X.XX]

```

与此相关的是一组数据，它将每个分组的代码转换为 CSS 类 ID（用于 jQuery）。

我还有一个从 [ **code** ] 到 ID 的翻译数组，存储在一个简单的结构化数组中，如下例所示：

```
$translate = array(
    'XXX' => 'gen-string-input', 
    'PN' => 'gen-positivenumber-input',
    'N' => 'gen-number-input'
); 
```

重要的是可以实现以下目标：

我需要用结构如下的 span 标签 替换 [ **code ] 的每个实例：**

```
<span class="[classname]" unique="[hash]" offset="[offset]">[CODE]</span> 
```

这是假设字段是

*   *classname*是 $translate 数组的结果
*   *hash*是一个 md5 散列，对于每个规则都是静态的
*   *offset*是字段在字符串中的位置（例如，在第一个示例中，字段**[XXX]**位于位置 0，**[PN]**位于位置 1，依此类推）。

基于此信息，我希望为**Rule 1**实现以下输出：

```
<p>
    Do <span class="gen-string-input" 
             unique="[md5]"
             offset="0">[XXX]</span>
    when <span class="gen-positivenumber-input"
               unique="[md5]" 
               offset="1">[PN]</span>
    greater than <span class="gen-number-input" 
                       unique="[md5]" 
                       offset="2">[N]</span>
</p> 
```

非常感谢任何帮助，我目前正在使用 str_replace 来尝试实现这一目标，但这还不够好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T17:27:16.067

好的，实际上您需要的是[`preg_replace_callback`](http://www.php.net/manual/en/function.preg-replace-callback.php). 请参阅递归回调示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T17:42:19.493

遍历 translate 数组，将字符串中的键替换为值

```
$string = '[代码]';
$translate = array('classname' => 'oddRow', 'hash' => 'abcdef');

foreach($translate AS $key=>$value)
{
$string = str_ireplace('[' . $key . ']', $value, $string);
}

```

# php - 多个站点共享数据

> ID：682574
> 
> 赞同：0
> 
> 时间：2009-03-25T17:18:25.400
> 
> 标签：php, php4

我最近在一家大公司担任 php Web 开发人员职位。他们有多个网站共享大部分相同的内容（主要是新闻文章）。尽管所有站点都是用 PHP 编写的，但内容是静态的，并且在添加新闻文章或更改其他信息时在所有站点上手动编辑。那里的“高级程序员”出于某种原因反对使用 cms，反对升级到 php 5，反对安装 mod_rewrite，基本上我必须在一个非常小的参数范围内工作。

我花了前 3 周的时间编写了一大堆课程，以使混乱变得理智，但我必须找到一种方法来以简单的方式复制这些数据。我在想一些不需要数据库的东西（负责人不想分散数据，所以除了 Intranet 以外的任何地方的数据库都是不行的），我只想要一个集中的 XML 文件或其他东西，即使我需要手动编辑它......有什么想法吗？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T17:33:05.723

将 PHP 视为模板引擎，并让所有主页从一个站点的 RSS 提要中提取标记为 html（或 xml）的文章。

编辑提要以添加新文章，将标记的文章添加到主站点，这一切都非常非常简单，易于理解和扩展。

无需涉及“真正的”cms、数据库或任何东西。

-亚当

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T17:29:18.027

为您的网站使用的所有文档使用一个文件夹。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T17:32:51.513

您可以使用[CURL](http://php.net/curl)通过 HTTP 访问您需要的内容。将 CURLOPT_RETURNTRANSFER 选项设置为 1 将允许您获取您想要的任何内容。XML、HTTP 等

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T17:59:36.767

拥有一个主站点，在其上创建和编辑原始内容。

在所有其他情况下，使用 .htaccess 中的 Apache ErrorDocument 处理程序将 404 错误路由到新的 php 脚本。

```
错误文档 404 /syndicate.php
```

在 syndicate.php 中，获取 uri（来自 $_SERVER['REQUEST_URI']），从原始域中获取内容并使用 200/OK 标头输出它（因此它不会被视为 404）。

```
$master_domain = 'http://master.com';

$master_html = file_get_contents($master_domain . $_SERVER['REQUEST_URI']);

if($master_html != '') {
header("HTTP/1.0 200 OK");
回声 $master_html;
} 别的 {
header("HTTP/1.0 404 Not Found");
}

```

重复的内容仍将位于请求的 url 下。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T18:25:01.480

如果高级程序员反对行业标准工具，如 CMSes、PHP5（至少在考虑反对 PHP3/PHP4 时——不需要语言圣战）、mod_rewrite 等，那么是时候涉及管理了。这样的态度是不能接受的。

# c# - 大型集合的 LINQ 性能

> ID：682576
> 
> 赞同：21
> 
> 时间：2009-03-25T17:18:29.190
> 
> 标签：c#, .net, linq, performance

我有大量按字母顺序排序的字符串（最多 1M）。我已经使用 HashSet、SortedDictionary 和 Dictionary 对这个集合进行了 LINQ 查询试验。我正在静态缓存集合，它的大小高达 50MB，并且我总是针对缓存的集合调用 LINQ 查询。我的问题如下：

无论集合类型如何，性能都比 SQL 差很多（最多 200 毫秒）。对底层 SQL 表执行类似查询时，性能要快得多（5-10 毫秒）。我已经实现了我的 LINQ 查询，如下所示：

```
public static string ReturnSomething(string query, int limit)
{
  StringBuilder sb = new StringBuilder();
  foreach (var stringitem in MyCollection.Where(
      x => x.StartsWith(query) && x.Length > q.Length).Take(limit))
  {
      sb.Append(stringitem);
  }

  return sb.ToString();
} 
```

据我了解，HashSet、Dictionary 等使用二叉树搜索而不是标准枚举来实现查找。对于高级集合类型的高性能 LINQ 查询，我有哪些选择？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-25T18:36:44.667

在您当前的代码中，您没有使用 // 集合的任何特殊功能`Dictionary`，您使用它们的方式与`SortedDictionary`使用. 这就是为什么您看不到任何性能差异的原因。`HashSet``List`

如果您使用字典作为索引，其中字符串的前几个字符是键，字符串列表是值，您可以从搜索字符串中挑选出整个字符串集合中可能匹配的一小部分。

我写了下面的课程来测试这个。如果我用一百万个字符串填充它并使用八个字符的字符串进行搜索，它会在大约 3 毫秒内遍历所有可能的匹配项。使用一个字符串进行搜索是最坏的情况，但它会在大约 4 毫秒内找到前 1000 个匹配项。查找一个字符串的所有匹配项大约需要 25 毫秒。

该类为 1、2、4 和 8 个字符键创建索引。如果您查看您的特定数据和搜索内容，您应该能够选择要创建的索引以针对您的条件进行优化。

```
public class IndexedList {

    private class Index : Dictionary<string, List<string>> {

        private int _indexLength;

        public Index(int indexLength) {
            _indexLength = indexLength;
        }

        public void Add(string value) {
            if (value.Length >= _indexLength) {
                string key = value.Substring(0, _indexLength);
                List<string> list;
                if (!this.TryGetValue(key, out list)) {
                    Add(key, list = new List<string>());
                }
                list.Add(value);
            }
        }

        public IEnumerable<string> Find(string query, int limit) {
            return
                this[query.Substring(0, _indexLength)]
                .Where(s => s.Length > query.Length && s.StartsWith(query))
                .Take(limit);
        }

    }

    private Index _index1;
    private Index _index2;
    private Index _index4;
    private Index _index8;

    public IndexedList(IEnumerable<string> values) {
        _index1 = new Index(1);
        _index2 = new Index(2);
        _index4 = new Index(4);
        _index8 = new Index(8);
        foreach (string value in values) {
            _index1.Add(value);
            _index2.Add(value);
            _index4.Add(value);
            _index8.Add(value);
        }
    }

    public IEnumerable<string> Find(string query, int limit) {
        if (query.Length >= 8) return _index8.Find(query, limit);
        if (query.Length >= 4) return _index4.Find(query,limit);
        if (query.Length >= 2) return _index2.Find(query,limit);
        return _index1.Find(query, limit);
    }

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T17:41:15.937

我敢打赌，您在该列上有一个索引，因此 SQL Server 可以在 O(log(n)) 操作而不是 O(n) 中进行比较。要模仿 SQL 服务器的行为，请使用排序集合并查找所有字符串 s，使得 s >= 查询，然后查看值，直到找到不以 s 开头的值，然后对这些值进行额外的过滤。这就是所谓的范围扫描 (Oracle) 或索引查找 (SQL 服务器)。

这是一些示例代码，很可能会进入无限循环或出现一次性错误，因为我没有对其进行测试，但您应该明白这一点。

```
// Note, list must be sorted before being passed to this function
IEnumerable<string> FindStringsThatStartWith(List<string> list, string query) {
    int low = 0, high = list.Count - 1;
    while (high > low) {
        int mid = (low + high) / 2;
        if (list[mid] < query)
            low = mid + 1;
        else
            high = mid - 1;
    }

    while (low < list.Count && list[low].StartsWith(query) && list[low].Length > query.Length)
        yield return list[low];
        low++;
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T17:26:31.293

如果您正在做“开始于”，您只关心序数比较，并且您可以对集合进行排序（再次按序数顺序），那么我建议您将值放在列表中。然后，您可以二分查找以找到以正确前缀开头的第一个值，然后沿着列表线性向下生成结果，直到第一个*不*以正确前缀开头的值。

实际上，您可能可以对不以前缀开头的第一个值进行另一次二进制搜索，因此您将有一个起点和一个终点。然后，您只需将长度标准应用于该匹配部分。（我希望如果它是明智的数据，前缀匹配将摆脱大多数候选值。）找到不以前缀开头的第一个值的方法是搜索字典顺序的第一个值没有 - 例如前缀为“ABC”，搜索“ABD”。

这些都没有使用 LINQ，而且它都非常适合您的特定情况，但它应该可以工作。让我知道这是否有任何意义。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-25T18:14:00.507

如果您尝试优化查找具有给定前缀的字符串列表，您可能需要查看在 C# 中实现[Trie](http://en.wikipedia.org/wiki/Trie)（不要误认为是常规[树](http://en.wikipedia.org/wiki/Tree_structure)）数据结构。

与用于此类操作的其他数据结构相比，Tries 提供了非常快速的前缀查找并且具有非常小的内存开销。

一般关于 LINQ to Objects。与 SQL 相比，速度降低并不罕见。网络上[充斥着](http://www.google.ca/search?&q=linq+to+object+performance&btnG=Search&meta=)分析其性能的文章。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T17:29:44.267

只需查看您的代码，我会说您应该重新排序比较以在使用布尔运算符时利用短路：

```
foreach (var stringitem in MyCollection.Where(
    x => x.Length > q.Length && x.StartsWith(query)).Take(limit)) 
```

长度的比较总是一个 O(1) 操作（因为长度被存储为字符串的一部分，它不会每次都计算每个字符），而对 StartsWith 的调用将是一个 O (N) 运算，其中 N 是查询的长度（或字符串的长度，取较小者）。

通过在调用 StartsWith 之前比较长度，如果比较失败，您可以节省一些额外的周期，这些周期在处理大量项目时可能会加起来。

我认为查找表在这里不会对您有所帮助，因为当您比较整个键而不是键的一部分时，查找表很好，就像您对 StartsWith 的调用一样。

相反，您最好使用基于列表中单词中的字母拆分的树结构。

但是，此时，您实际上只是在重新创建 SQL Server 正在执行的操作（在索引的情况下），而这只是您的重复工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T18:19:46.220

我认为问题在于 Linq 无法使用您的序列已经排序的事实。尤其是它不能知道，应用`StartsWith`函数保留顺序。

我建议将该`List.BinarySearch`方法与`IComparer<string>`仅比较第一个查询字符的 a 一起使用（这可能很棘手，因为不清楚，查询字符串是否始终是 的第一个或第二个参数`()`）。

您甚至可以使用标准的字符串比较，因为 BinarySearch 返回一个负数，您可以对其进行补码（使用 ~），以便获得大于查询的第一个元素的索引。

然后，您必须从返回的索引（双向！）开始查找与您的查询字符串匹配的所有元素。

# c# - 为 JVM 实现 C#

> ID：682608
> 
> 赞同：96
> 
> 时间：2009-03-25T17:25:05.057
> 
> 标签：c#, java, clr, jvm

有人尝试为 JVM 实现 C# 吗？作为一名 Java 开发人员，我一直很羡慕 C#，但我不愿意放弃 JVM 的可移植性和成熟度，更不用说它的各种工具了。

我知道 JVM 和 CLR 之间有一些重要的区别，但是有什么是引人注目的吗？

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2009-03-25T17:31:39.800

CLR 和 JVM 之间存在非常显着的差异。

几个例子：

*   Java 没有用户定义的值类型
*   Java 泛型与 .NET 泛型*完全不同*
*   C# 的许多方面都依赖于框架的元素 - 委托等。您还需要移植该库，即使是*语言*方面也是如此。
*   Java 不支持 JVM 级别的属性和事件。你可以伪造其中的一些，但它不会是一样的。
*   我不相信 Java 有任何等效于按引用传递的参数，即使在 JVM 级别也是如此
*   尽管我不确定 C# 规范中有多少内容，但与不同内存模型有关的细节很可能会受到影响。
*   一般不安全的代码在 Java 中可能是不可能的
*   JNI 和 P/Invoke 与本机代码的互操作性非常不同。这对你来说可能不是什么大问题。
*   您必须伪造运算符重载和用户定义的转换

你可能会移植*很多*C# - 但你会留下非常不满意的体验，IMO。

反过来说，你知道[IKVM](http://www.ikvm.net/)吗？它允许您在 .NET 中运行 Java 代码。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2010-05-18T12:17:23.033

访问[http://code.google.com/p/stab-language](http://code.google.com/p/stab-language)

下面的代码如果是 JVM 的 Stab 语言代码

```
using java.lang;
using stab.query;
public class Test {
   public static void main(String[] args) {
   // Sorts the arguments starting with "-" by length and then using the default   
        // string comparison
        var query = from s in Query.asIterable(args)
                    where s.startsWith("-")
                    orderby s.length(), s
                    select s;
        foreach (var s in query) {
            System.out.println(s);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2014-10-15T14:19:21.423

# 字节码转译器

[Grasshopper](http://dev.mainsoft.com/)可以获取 CLR 字节码并将其转换为 JVM。主要用于 Web 应用程序，它不提供例如 Windows 窗体类的 JVM 实现。不过，似乎有些过时了。网络上谈论 ASP.NET 2.0、Visual Studio 2008 等等。由@alex 首次提及

[XMLVM](http://xmlvm.org/overview/)可以将 CLR 或 JVM 字节码作为输入并生成其中任何一个作为输出。此外，它可以输出 Javascript 或 Objective-C。还没有发布，只有 Subversion。“不能在生产环境中使用的实验开发版本。”

[IKVM](http://www.ikvm.net/)的发展方向与 OP 想要的相反。它提供了一个在 CLR 上运行的 JVM 实现、一个 JVM 到 CLR 字节码的转换器和一个用于 Java 的 CLR 库方法存根生成器。[http://www.ikvm.net/uses.html](http://www.ikvm.net/uses.html) @Jon Skeet 提到

# RPC

*为什么不让 CLR 和 JVM 一起运行，让通信尽可能顺畅呢？这不是 OP 想要的，但是其他一些答案已经以不同的方式完全偏离主题，所以让我们来介绍一下。*

[RabbitMQ](http://www.rabbitmq.com/)有一个免费选项，它是一个用 Erlang 编写的 RPC 服务器，带有用于 C#、Java 等的 API 库。

[jnBridge](http://jnbridge.com/jnbridge-home)，对于某些潜在用户来说，许可证可能太贵了。

[gRPC](http://www.grpc.io/)和类似的现代 RPC 库提供广泛的语言支持、这些语言的客户端库代码生成、数据的语言独立线格式、级联调用取消等高级功能等。

# 编程语言

*一次编写，到处运行；）*

[Haxe](http://haxe.org/)，可编译为 C#/CLR、Java/JVM、Javascript、Flash、Python…… 为每种目标语言提供互操作机制。在某种程度上可以被认为是 ActionScript3 的继承者。看起来很可靠的东西，至少有一家公司实际上依赖它。比 Stab 更值得信赖，接下来会提到。

[Stab](https://code.google.com/p/stab-language/)带来了一些 C# 特性和 Java 互操作性。不是很有用，您可以获得一些 C# 功能，但您与之交互的是不使用它们的 Java 代码。[https://softwareengineering.stackexchange.com/a/132080/45826](https://softwareengineering.stackexchange.com/a/132080/45826)该语言相对晦涩难懂，可能已被废弃，几乎没有希望变得更好。@Vns 在这里首先提到。

*JVM 平台的新鲜空气；）*

[Scala](https://www.scala-lang.org/)、[Kotlin](http://kotlinlang.org/)等是运行在 JVM 之上的相当不错的语言，它们带来了 C# 程序员在 Java 中可能会错过的特性。尤其是 Kotlin 感觉像是 JVM 世界中 C# 的合理替代品。Scala 对于程序员来说可能有点太大了，无法在短时间内适应。

# 单核细胞增多症

这当然也是一种选择。如果 Mono 可以按原样运行，为什么要转译到 JVM。由@ferhrosa 首次提及

> **纽约 — 2014 年 11 月 12 日**— 周三，微软公司通过开源完整的服务器端 .NET 堆栈和扩展 .NET 以在 Linux 和 Mac OS 平台上运行来加强其对跨平台开发人员体验的承诺。

根据引用的[新闻稿](http://news.microsoft.com/2014/11/12/microsoft-takes-net-open-source-and-cross-platform-adds-new-development-capabilities-with-visual-studio-2015-net-2015-and-visual-studio-online/)，Visual Studio 2015 将添加 Linux/Mono 作为支持的平台。

这是 Mono 项目的人写的关于它的博客，从另一端：[.NET 源代码集成](http://www.mono-project.com/docs/about-mono/dotnet-integration/)（2014 年 11 月）。

# .NET 核心

由 Microsoft 管理的（部分）.Net 的 Windows/Linux 多平台版本。'nuff 说[https://github.com/dotnet/core](https://github.com/dotnet/core)。

# 结论

现在有必要尝试这些工具/框架，看看有多少摩擦。OP 想用 C# 为 JVM 编写，这实际上使用 Grasshopper 可以很好地工作。

这样做的目的是在单个代码库中混合 C# 和 Java 世界库可能效果不佳。

来源

[http://blog.pluralsight.com/new-course-making-java-and-c-work-together-jvm-and-net-clr-interop](http://blog.pluralsight.com/new-course-making-java-and-c-work-together-jvm-and-net-clr-interop)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-03-25T17:50:48.363

编写从 IL 到字节码的转换器可能更简单。这样，您将自动获得对 JVM 上任何 .NET 语言的支持。

然而，这是一个如此明显的想法，如果这还没有完成，它可能非常困难，或者很难做好/有用。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-03-25T17:31:38.940

看看[蚱蜢](http://dev.mainsoft.com/)。它是一个基于 Visual Studio 的 SDK 和获得专利的 .NET 到 Java 转换器，使您能够在 Linux® 和其他支持 Java 的平台上运行 .NET Web 和服务器应用程序。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-03-05T12:03:15.337

C# 中的跨平台开发选项可以是单声道：[http ://www.mono-project.com/](http://www.mono-project.com/)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-06-27T10:42:30.440

您可以使用[源到源编译器](https://en.wikipedia.org/wiki/Source-to-source_compiler)将 C# 翻译成在 JVM 上运行的语言。例如，有几个[C# 到 Java 转换器](https://stackoverflow.com/questions/43699181/can-haxe-compiler-convert-any-c-sharp-code-to-haxe)允许 C# 应用程序在被翻译成 Java 后在 JVM 上运行。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-03-17T18:00:46.373

这个答案对你来说可能迟到了，但这个答案是新的。您可能想查看[Kotlin](http://kotlinlang.org/)编程语言。除了任何非 Java JVM 语言之外，它还提供了 C# 所具有的语法糖以及最接近 C# 的语法。它来自[JetBrains](https://www.jetbrains.com/)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-05-28T15:51:54.057

我可以看到为什么这没有引起太多热情的两个原因。

首先要意识到的是，就语言的实际特性而言，C# 和 Java 非常接近。C# 和 Java 不仅接近，它们也在朝着相似的方向发展。JVM 目前不支持开箱即用的一些特性，但这不是真正的问题。你总是可以伪造缺少的东西。我认为人们更喜欢等待 Java 获得更多的糖，而不是从头开始创建一个差不多 Java。当端口准备好时，Java 可能已经决定迎头赶上。

其次，开发人员更喜欢 C# 的原因与其说是语言本身，不如说是围绕它的工具、他们与 C# 的双向关系以及微软如何支持整个事情。例如，C#-XAML 组合比 JavaFX 更友好，因为 C# 和 XAML 被相互破解（例如 C# 中的部分类，XAML 中的绑定等等）。在 JavaFX 上使用 C# 并没有太大改进。要在 JVM 上获得 C# 体验，您还需要移植工具，这是一个更大的项目。甚至[Mono](http://www.mono-project.com/)都不会打扰。

因此，对于想要在熟悉的工具之上使用更高级的语言的 Java 开发人员，我的建议是检查现有的[JVM 语言](http://en.wikipedia.org/wiki/Java_virtual_machine#JVM_languages)。

Mono 也是一种选择，但我一直对此持怀疑态度。尽管它是 C#-.NET 和跨平台的，但使用 Microsoft 工具构建的东西通常无法在 Mono 上运行。它本质上是它自己的东西。我们将看看微软表示他们将合作现在会发生什么。

# c# - 如何从列表中获取每第 n 个项目 ?

> ID：682615
> 
> 赞同：125
> 
> 时间：2009-03-25T17:27:55.970
> 
> 标签：c#, linq, list, lambda

我正在使用 .NET 3.5，并且希望能够`n`从列表中获取每个 * * 项。我不关心它是使用 lambda 表达式还是 LINQ 实现的。

**编辑**

看起来这个问题引起了很多争论（这是一件好事，对吧？）。我学到的主要内容是，当您认为自己知道做某事的所有方法（即使如此简单）时，请再想一想！

* * *

## 回答 #1

> 赞同：213
> 
> 时间：2009-03-25T17:33:24.473

```
return list.Where((x, i) => i % nStep == 0); 
```

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-03-25T17:30:26.323

我知道这是“老派”，但为什么不直接使用带有 stepping = n 的 for 循环呢？

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2009-03-25T17:33:30.370

听上去像

```
IEnumerator<T> GetNth<T>(List<T> list, int n) {
  for (int i=0; i<list.Count; i+=n)
    yield return list[i]
} 
```

会成功的。我认为不需要使用 Linq 或 lambda 表达式。

**编辑：**

做了

```
public static class MyListExtensions {
  public static IEnumerable<T> GetNth<T>(this List<T> list, int n) {
    for (int i=0; i<list.Count; i+=n)
      yield return list[i];
  }
} 
```

你用 LINQish 的方式写

```
from var element in MyList.GetNth(10) select element; 
```

**第二次编辑**：

让它更加 LINQish

```
from var i in Range(0, ((myList.Length-1)/n)+1) select list[n*i]; 
```

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2009-03-25T17:34:23.193

您可以使用 Where 重载将索引与元素一起传递

```
var everyFourth = list.Where((x,i) => i % 4 == 0); 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-03-25T17:32:51.870

循环

```
for(int i = 0; i < list.Count; i += n)
    //Nth Item.. 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2014-09-11T08:09:02.807

我认为如果你提供一个 linq 扩展，你应该能够在最不具体的接口上操作，因此在 IEnumerable 上。当然，如果您想提高速度，尤其是对于大 N，您可能会为索引访问提供过载。后者消除了对大量不需要的数据进行迭代的需要，并且比 Where 子句要快得多。提供这两个重载可以让编译器选择最合适的变体。

```
public static class LinqExtensions
{
    public static IEnumerable<T> GetNth<T>(this IEnumerable<T> list, int n)
    {
        if (n < 0)
            throw new ArgumentOutOfRangeException("n");
        if (n > 0)
        {
            int c = 0;
            foreach (var e in list)
            {
                if (c % n == 0)
                    yield return e;
                c++;
            }
        }
    }
    public static IEnumerable<T> GetNth<T>(this IList<T> list, int n)
    {
        if (n < 0)
            throw new ArgumentOutOfRangeException("n");
        if (n > 0)
            for (int c = 0; c < list.Count; c += n)
                yield return list[c];
    }
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-25T17:35:10.413

我不确定是否可以使用 LINQ 表达式，但我知道您可以使用`Where`扩展方法来做到这一点。例如获取每五个项目：

```
List<T> list = originalList.Where((t,i) => (i % 5) == 0).ToList(); 
```

这将从那里获得第一个项目和每五分之一。如果要从第五项而不是第一项开始，则与 4 进行比较而不是与 0 进行比较。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-01-19T18:13:16.977

恕我直言，没有答案是正确的。所有解决方案都从 0 开始。但我想要真正的第 n 个元素

```
public static IEnumerable<T> GetNth<T>(this IList<T> list, int n)
{
    for (int i = n - 1; i < list.Count; i += n)
        yield return list[i];
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-05-31T15:55:29.340

@belucha 我喜欢这个，因为客户端代码非常易读，并且编译器选择了最有效的实现。我将在此基础上减少对`IReadOnlyList<T>`高性能 LINQ 的要求并保存该部门：

```
 public static IEnumerable<T> GetNth<T>(this IEnumerable<T> list, int n) {
        if (n <= 0) throw new ArgumentOutOfRangeException(nameof(n), n, null);
        int i = n;
        foreach (var e in list) {
            if (++i < n) { //save Division
                continue;
            }
            i = 0;
            yield return e;
        }
    }

    public static IEnumerable<T> GetNth<T>(this IReadOnlyList<T> list, int n
        , int offset = 0) { //use IReadOnlyList<T>
        if (n <= 0) throw new ArgumentOutOfRangeException(nameof(n), n, null);
        for (var i = offset; i < list.Count; i += n) {
            yield return list[i];
        }
    } 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-05-05T16:13:12.860

```
private static readonly string[] sequence = "1,2,3,4,5,6,7,8,9,10,11,12,13,14,15".Split(',');

static void Main(string[] args)
{
    var every4thElement = sequence
      .Where((p, index) => index % 4 == 0);

    foreach (string p in every4thElement)
    {
        Console.WriteLine("{0}", p);
    }

    Console.ReadKey();
} 
```

输出

[![在此处输入图像描述](https://i.stack.imgur.com/6mURq.png)](https://i.stack.imgur.com/6mURq.png)

# asp.net-mvc - ASP.NET MVC：使用现有帐户还是创建新的用户控制器？

> ID：682616
> 
> 赞同：1
> 
> 时间：2009-03-25T17:28:29.680
> 
> 标签：asp.net-mvc, model-view-controller

我正在创建一个新的 ASP.NET MVC 应用程序。到目前为止，我已经将帐户控制器用于与用户帐户相关的操作——登录/注销、激活（例如注册，但我将注册用于站点中的其他操作，因此我已将其重命名）、添加/更新联系信息. 不过，到目前为止，我一直专注于管理用户视图。

我将开始创建非管理用户将看到的各种视图。与管理界面相比，这些功能相当有限。我的倾向是在用户“家庭”中创建一组新的视图和关联的控制器，而不是使用帐户视图/控制器。这是一个好主意还是我应该坚持使用帐户控制器？我的感觉是，由于这是针对普通用户的，它应该是一个单独的控制器，因为 Account 将适用于普通用户和管理用户。

**编辑**：阅读前几个回复后，我重构的问题是：

您认为 Account 控制器是针对与用户帐户相关的管理操作还是针对用户帐户的所有操作？您是否会在创建新控制器的范围内区分成员资格/角色相关的视图/数据和应用程序相关的视图/数据。

相关但不直接回答我的问题：[ASP.NET MVC Account Controller 使用指南？](https://stackoverflow.com/questions/237249/asp-net-mvc-account-controller-usage-guidelines)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T17:50:36.697

我认为这里没有正确或错误的答案，所以我会给你我的意见。

从技术上讲，任何一种解决方案（扩展帐户控制器或创建新控制器）都可以正常工作。

所以我认为这更多的是用户如何看待功能的问题。我认为遵循 URI 指示控制器的约定是个好主意（如果您愿意，反之亦然）。

例如，如果您希望在单独的路径上执行“管理”操作，那么它应该是一个单独的控制器。例如，如果您使用 IIS 模块进行身份验证，或者如果它使您的日志分析更容易，您可能希望这样做。

另一方面，用户可能会将帐户功能和管理功能视为同一系列操作的一部分，只是某些用户具有附加功能。如果是这样，那么这表明它应该在 URI 中的同一路径上，因此是同一控制器的一部分。

总而言之，我认为这是一个你应该问你的用户代表而不是这个网站上的人的问题。:)

**更新**：关于您更新的问题，我想说在帐户控制器上执行更改用户密码的操作是很自然的，并且该操作可以由用户自己调用，而不仅仅是管理员。所以我不认为 Account 控制器是专门用于管理任务的。另一方面，您的筹款表现示例远远超出了与会员相关的范围，因此也不清楚它是否属于帐户。我仍然倾向于“询问您的用户代表”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T17:53:09.140

在 ASP.NET MVC 中，您通常会根据数据类型而不是访问类型来创建控件。例如：

而不是 2 /Controllers/UsersControl.cs 和 /Controllers/Admin/UsersControls.cs 更容易为管理员和普通用户使用一个通用控制器 - /Controllers/UsersController.cs（通过设置不同的 [Authorize] 属性和视图） .

我会保留现有的 AccountController.cs 来封装与帐户相关的功能。并且只需为其余用户相关功能添加新的 UsersController.cs（可能有 OnlineUsers 等方法）

# iphone - 在 iphone / 智能手机上使用的网页限制

> ID：682621
> 
> 赞同：1
> 
> 时间：2009-03-25T17:29:17.450
> 
> 标签：iphone, html, smartphone

我想让我们的主应用程序生成可以在 iphone 或其他智能手机上轻松阅读的文档文件。我认为最简单的方法是创建一个简单的 HTML 文件并使用 javascript 显示/隐藏它的不同部分。例如，当用户点击/触摸“第 1 部分”时，该部分会展开以显示其全部详细信息；否则，它将保持折叠以节省空间。

创建此文件时应遵循哪些准则？我做了一些研究并得出以下结论：

*   iphone 的原始分辨率为 320x480，但网页只能看到大约 320x400。
*   其他智能手机的分辨率从 160x120（可能不足以打扰）到 320x240，有些甚至有 480x640。

例如，这些对于决定如何设置 HTML 输出的样式和排列方式很有用。还有其他有用的指导方针可以使用吗？例如：

1）我应该做多大/小才能让用户拥有足够大的“目标区域”？

2）我怎样才能把文件放到iphone上？用户是否必须通过 USB 拖放它？

3) 在字体太小而无法阅读之前，我可以使用多大的字体？

等等等等。我实际上没有要测试的iphone，这使得这有点问题。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T19:10:42.947

我不知道其他智能手机，但您的文件要进入 iPhone 的唯一方法是通过网络浏览器、电子邮件或您编写的自定义应用程序。没有将文件上传到 iPhone 的通用机制。

即使在 iPhone 上阅读很小的文本也非常容易，并且基于手势的缩放使放大和缩小变得非常容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T22:59:00.620

如果您打算通过 ASP.NET 提供您的文档，您可能需要查看： http: [//mdbf.codeplex.com/](http://mdbf.codeplex.com/)。它允许您检测请求的智能手机类型，然后您可以检查功能（屏幕分辨率、颜色显示、屏幕像素高度......等）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T23:06:35.627

大多数移动浏览器呈现 XHTML-MP（XHTML 移动配置文件）。你可以摆脱渲染。

iPhone（和其他 WebKit 手机，如 Android）支持视口元标记，这可以使体验更加适合该手机的屏幕尺寸。您可以在 Apple 的 iPhone 网页创建文档中了解这些内容。

如果您真的对支持各种手机感兴趣，您应该看看像 WURFL 这样的“多服务”技术，它可以让您从支持数百款手机中抽象出很多复杂性。不过，这是一种昨天的技术，因为现代移动浏览器可以很好地呈现大多数网页。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T23:12:09.107

我不确定这是多么最新，但[雅虎表示](http://developer.yahoo.com/performance/rules.html#under25)iPhone 的限制之一是它不会缓存大于 25k *uncompressed*的文件。这不一定会影响您的显示，但可能会影响您的性能，因此您可能需要在设计时考虑到它。

# internet-explorer-8 - 为什么 InfoCards 在 IE8 中不起作用？

> ID：682624
> 
> 赞同：1
> 
> 时间：2009-03-25T17:29:42.580
> 
> 标签：internet-explorer-8, cardspace, infocard

IE8 中的哪些变化使得在 javascript 中检测 InfoCard Selector 支持停止工作，除非将 IE8 置于兼容模式？

更重要的是，检测 InfoCard 支持存在的新 JavaScript 代码是什么？

这是通过 IE7 运行的脚本，包括在某些情况下带有插件的 FireFox：

```
function AreCardsSupported() {
    var IEVer = -1;
    if (navigator.appName == 'Microsoft Internet Explorer') {
        if (new RegExp("MSIE ([0-9]{1,}[\.0-9]{0,})").exec(navigator.userAgent) != null) {
            IEVer = parseFloat(RegExp.$1);
        }
    }

    // Look for IE 7+. 
    if (IEVer >= 7) {
        var embed = document.createElement("object");
        embed.setAttribute("type", "application/x-informationcard");

        return "" + embed.issuerPolicy != "undefined" && embed.isInstalled;
    }

    // not IE (any version)
    if (IEVer < 0 && navigator.mimeTypes && navigator.mimeTypes.length) {
        // check to see if there is a mimeType handler. 
        x = navigator.mimeTypes['application/x-informationcard'];
        if (x && x.enabledPlugin) {
            return true;
        }

        // check for the IdentitySelector event handler is there. 
        if (document.addEventListener) {
            var event = document.createEvent("Events");
            event.initEvent("IdentitySelectorAvailable", true, true);
            top.dispatchEvent(event);

            if (top.IdentitySelectorAvailable == true) {
                return true;
            }
        }
    }

    return false;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T04:08:46.913

我从 IE8 团队得到了一个带外的答案：

改变

```
embed.setAttribute("type", "application/x-informationcard"); 
```

到

```
embed.type = "application/x-informationcard"; 
```

# c# - 命名、声明和定义委托和事件约定

> ID：682635
> 
> 赞同：19
> 
> 时间：2009-03-25T17:32:28.190
> 
> 标签：c#, .net, coding-style

### 您如何命名委托、事件和事件实例？

我用这个：

```
delegate void OnSomethingHandler();
event OnSomethingHandler onSomething; 
```

这是一种公认​​的方式吗？注意小写和大写

* * *

### 您在哪里放置代表和活动？

我通常将代表放在最能反映它们的命名空间中：

```
mynamespace.Def.SomethingLike
{

}
mynamespace.Def.SomethingElseLike
{

} 
```

* * *

### 你在哪里定义事件？

我通常将它们放入使用它们的类中。

我注意到很多人在同一个类中定义委托和事件。这有多普遍？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-25T17:39:26.380

[MSDN 关于命名事件](http://msdn.microsoft.com/en-us/library/ms229012.aspx)：

> 事件总是指一些动作，要么是正在发生的，要么是已经发生的。因此，与方法一样，事件以动词命名，动词时态用于指示事件发生的时间。
> 
> √ **DO**用动词或动词短语命名事件。
> 
> 示例包括`Clicked`、`Painting`、`DroppedDown`等。
> 
> √使用现在时和**过去**时给事件命名之前和之后的概念。
> 
> 例如，在窗口关闭之前引发的关闭事件将被调用`Closing`，在窗口关闭之后引发的事件将被调用`Closed`。
> 
> X**请勿**使用“Before”或“After”前缀或后缀来表示前后事件。使用刚才描述的现在时和过去时。
> 
> √ **DO**使用“EventHandler”后缀命名事件处理程序（用作事件类型的委托），如下例所示：
> 
> ```
> public delegate void ClickedEventHandler(object sender, ClickedEventArgs e); 
> ```
> 
> √**务必**在事件处理程序中使用名为*sender*和*e的两个参数。*
> 
> sender 参数表示引发事件的对象。sender 参数通常是 type `object`，即使可以使用更具体的类型。
> 
> √ **DO**使用“EventArgs”后缀命名事件参数类。

所以，事件应该用动词或动词短语来命名。代替`OnSomething`, 使用`Something`, 假设 that`Something`实际上是一个动词，例如`Close`, `Click`, or `ManagedPiplelineAbandoning`and `ManagedPiplelineAbandoned`。

事件的委托人应该以`EventHandler`后缀、给予、、、等`CloseEventHandler`命名。`ClickEventHandler``ManagedPiplelineAbandoningHandler`

对于与事件无关的委托，请使用名词，like `EventProcessor`or `ItemRetriever`，而该委托的实例是动词，like `processEvent`or `retrieveItem`。

您的委托引用的大小写应该是驼峰，除非引用不是私有的。不过，我想不出你会有一个非私有委托字段的情况。

但是，由于建议使用传统的事件处理程序签名（即`object sender, EventArgs e)`），因此您应该[使用通用事件处理程序](http://msdn.microsoft.com/en-us/library/ms182178.aspx)而不是定义自己的事件处理程序。也就是说，您的事件将被定义为：

```
event EventHandler<SomethingEventArgs> Something; 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-03-25T17:39:43.460

你所拥有的一切看起来都很标准——我唯一要改变的是事件名称将是`Something`而不是`onSomething`. 按照微软的约定，你最终会得到更像这样的东西：

```
delegate void SomethingHandler();
event SomethingHandler Something;

protected void OnSomething()
{
    if (this.Something != null)
        this.Something();
} 
```

作为一个很酷的技巧，您可以向您的事件添加一个空委托，`Something`这样您就不必在引发它之前检查事件是否为 null：

```
delegate void SomethingHandler();
event SomethingHandler Something = delegate {};

protected void OnSomething()
{
    this.Something();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-22T15:13:43.993

[扩展 bdukes 答案/摘要并使用我在这里](http://www.codeproject.com/Articles/11541/The-Simplest-C-Events-Example-Imaginable)找到的示例，这是我的尝试：

```
//from http://www.codeproject.com/Articles/11541/The-Simplest-C-Events-Example-Imaginable
using System;
namespace wildert
{
    public class TimeOfTickEventArgs : EventArgs //<- custom event args
    {
        private DateTime TimeNow;
        public DateTime Time
        {
            set { TimeNow = value; }
            get { return this.TimeNow; }
        }
    }
    public class Metronome
    {
        public delegate void TickEventHandler(object sender, TimeOfTickEventArgs e); //I put the delegate declaration before the events
        public event TickEventHandler Ticked; //Ticked(i.e. after something occurred), or possibly Ticking(i.e. before)

        public void Start()
        {
            while (true)
            {
                System.Threading.Thread.Sleep(3000);
                if (Ticked != null){
                    TimeOfTickEventArgs tot = new TimeOfTickEventArgs();
                    tot.Time = DateTime.Now;
                    Ticked(this, tot); //<- publish the event
                }
            }
        }
    }
    public class Listener
    {
        public void Subscribe(Metronome m){
            m.Ticked += new Metronome.TickEventHandler(HeardIt);  //<- subscribe to the event
        }
        private void HeardIt(object sender, TimeOfTickEventArgs e){ //<- this is the event handler (note signature 'object sender, xxx e')
            System.Console.WriteLine("HEARD IT AT {0}",e.Time);
        }
    }
    class Test
    {
        static void Main()
        {
            Metronome m = new Metronome();
            Listener l = new Listener();
            l.Subscribe(m);
            m.Start();
        }
    }
} 
```

# drop-down-menu - 下拉列表上的工具提示

> ID：682643
> 
> 赞同：2
> 
> 时间：2009-03-25T17:33:22.057
> 
> 标签：drop-down-menu, tooltip

无论如何在下拉列表中显示工具提示？例如，当列表被删除并且一个人将鼠标悬停在每个选项上时，会出现一个工具提示或带有详细信息的内容。这是一个带有级联下拉列表的下拉列表。

这是为 asp.net

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-26T00:00:34.793

Marco，不确定您的人口统计是什么浏览器，但下面的标准代码适用于 FF。

```
<select>
<option value="1" title="this is text about the value">Option 1</option>
</select> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-05T18:39:41.320

你可以在后面的代码（c#）中做这样的事情：

```
 foreach (Widget w in Widgets)
        {
            ListItem item = new ListItem(w.Name, w.WidgetID.ToString());
            item.Attributes.Add("title", w.TooltipText);

            ddlWidgets.Items.Add(item);
        } 
```

# c# - Sql Server Ce 3.5 身份插入

> ID：682654
> 
> 赞同：3
> 
> 时间：2009-03-25T17:36:19.523
> 
> 标签：c#, sql-server, compact-framework, identity-insert

Sql Server CE 中的标识列存在问题

使用服务器资源管理器时，在VS2008中，执行以下脚本

SET IDENTITY_INSERT testTable ON; 插入 testTable (id,name) 值 (1,'Something') SET IDENTITY_INSERT testTable ON;

发送以下消息错误“不支持 Set SQL 构造或语句。” 但随后插入行很好?!?!?!

无论如何，当我尝试通过 C# 做同样的事情时，将该脚本作为命令文本给出它失败说错误出现在“插入关键字”中

我知道针对 SQL SERVER CE，该命令当时只接受一个批处理命令，所以在这种情况下，我们有三个命令（它可以与完整的 SQLServer 一起使用）有什么想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-25T18:04:16.350

如果您使用的是 SqlCe 3.5，那么这应该可以。但是，您需要将其作为两个单独的命令发送。您不能用“;”分隔命令 或 SqlCe 中的“GO”。相反，您需要执行以下操作：

```
 SqlCeConnection connection = new SqlCeConnection(connectionString);
            SqlCeCommand identChangeCommand = connection.CreateCommand();
            identChange.CommandText = "SET IDENTITY_INSERT SomeTable ON";
            SqlCeCommand cmd = connection.CreateCommand();
            cmd.CommandText = "INSERT INTO testTable (Id, column1, column2..) VALUES (10,val1,val2...)";
            try
            {
                connection.Open();
                identChange.ExecuteNonQuery();
                cmd.ExecuteNonQuery();
            }

            catch (SqlCeException ex)
            {
                //log ex
            }
            finally
            {
                connection.Close();
            } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T17:55:38.697

尝试

```
SET IDENTITY_INSERT testTable ON; 
Insert into testTable (id,name) values (1,'Something');
SET IDENTITY_INSERT testTable OFF; 
```

或者

```
SET IDENTITY_INSERT testTable ON
go
Insert into testTable (id,name) values (1,'Something')
go
SET IDENTITY_INSERT testTable OFF
go 
```

# sql-server - 在 SQL Server 中对下限日期执行数学运算的最佳方法是什么？

> ID：682656
> 
> 赞同：0
> 
> 时间：2009-03-25T17:38:54.010
> 
> 标签：sql-server, tsql, date

这与[Floor a date in SQL server](https://stackoverflow.com/questions/85373/floor-a-date-in-sql-server)相关，但我更进一步：

我正在 SQL Server 表上编写查询，我想获取当前日历年和上一个日历年的所有记录。所以，现在，我想要一个查询来返回 2008 年 1 月 1 日到今天之间的所有记录。但是到 2010 年 1 月 1 日，我希望它返回不超过 2009 年的记录。

本质上，我想将当前日期设置为年初，然后减去 1。

在翻阅了一些 SQL Server 文档之后，我想出了这个：

```
 WHERE create_date >= CAST((CAST(YEAR(GETDATE()) AS int) -1) AS varchar) 
```

但感觉有点丑。有没有更好的办法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T17:44:50.187

为什么不在 create_date 上也使用 year 函数呢？

```
WHERE YEAR(create_date) >= (YEAR(GETDATE()) -1) 
```

这假设（如您所做的那样）数据库中没有大于今天日期的记录

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T20:40:45.553

我建议分配一个日期为 lastyear-01-01 的变量，方法是为它创建一个 UDF，或者类似

```
DECLARE @startOfLastYear DATETIME
SET @startOfLastYear = CAST(YEAR(GETDATE()) - 1 AS VARCHAR) + '-01-01' 
```

然后进行查询：

```
WHERE  create_date >= @startOfLastYear 
```

因为两个原因：

1.  对表中的数据使用 YEAR() 或任何其他函数（即 YEAR(create_date)）会使索引不可用并降低查询的性能
2.  变量名准确地说明了它是什么，并且阅读代码更容易。

# c++ - 多线程我的程序的负加速

> ID：682658
> 
> 赞同：3
> 
> 时间：2009-03-25T17:39:21.543
> 
> 标签：c++, multithreading, performance, multicore

在配备 Intel Pentium 双核处理器 T2370 (Acer Extensa) 的笔记本电脑上，我运行了一个简单的多线程加速测试。我正在使用 Linux。代码粘贴在下面。虽然我期待 2-3 倍的加速，但我惊讶地发现**减速**了 2 倍。我尝试了 gcc 优化级别 -O0 ... -O3，但每次我得到相同的结果。我正在使用 pthreads。我也尝试过只使用两个线程（而不是代码中的 3 个线程），但性能相似。

可能是什么原因？更快的版本花费了相当长的时间——大约 20 秒——所以这似乎不是启动开销的问题。

注意：这段代码有很多错误（实际上它没有多大意义，因为串行和并行版本的输出会不同）。目的只是为了“获得”相同数量指令的加速比较。

```
#include <stdio.h>
#include <time.h>
#include <unistd.h>
#include <pthread.h>

class Thread{
    private:
            pthread_t thread;
            static void *thread_func(void *d){((Thread *)d)->run();}
    public:
            Thread(){}
            virtual ~Thread(){}

            virtual void run(){}
            int start(){return pthread_create(&thread, NULL, Thread::thread_func, (void*)this);}
            int wait(){return pthread_join(thread, NULL);}
};

#include <iostream>

const int ARR_SIZE = 100000000;
const int N = 20;
int arr[ARR_SIZE];

int main(void)
{

    class Thread_a:public Thread{
            public:
                    Thread_a(int* a): arr_(a) {}
                    void run()
                    {
                            for(int n = 0; n<N; n++)
                            for(int i=0; i<ARR_SIZE/3; i++){ arr_[i] += arr_[i-1];}
                    }
            private:
                    int* arr_;
    };
    class Thread_b:public Thread{
            public:
                    Thread_b(int* a): arr_(a) {}
                    void run()
                    {
                            for(int n = 0; n<N; n++)
                            for(int i=ARR_SIZE/3; i<2*ARR_SIZE/3; i++){ arr_[i] += arr_[i-1];}
                    }
            private:
                    int* arr_;
    };

    class Thread_c:public Thread{
            public:
                    Thread_c(int* a): arr_(a) {}
                    void run()
                    {
                            for(int n = 0; n<N; n++)
                            for(int i=2*ARR_SIZE/3; i<ARR_SIZE; i++){ arr_[i] += arr_[i-1];}
                    }
            private:
                    int* arr_;
    };

    {
            Thread *a=new Thread_a(arr);
            Thread *b=new Thread_b(arr);
            Thread *c=new Thread_c(arr);

            clock_t start = clock();

            if (a->start() != 0) {
                    return 1;
            }

            if (b->start() != 0) {
                    return 1;
            }
            if (c->start() != 0) {
                    return 1;
            }

            if (a->wait() != 0) {
                    return 1;
            }

            if (b->wait() != 0) {
                    return 1;
            }

            if (c->wait() != 0) {
                    return 1;
            }

            clock_t end = clock();
            double duration = (double)(end - start) / CLOCKS_PER_SEC;

            std::cout << duration << "seconds\n";
            delete a;
            delete b;

    }
    {
            clock_t start = clock();
            for(int n = 0; n<N; n++)
            for(int i=0; i<ARR_SIZE; i++){ arr[i] += arr[i-1];}
            clock_t end = clock();
            double duration = (double)(end - start) / CLOCKS_PER_SEC;

            std::cout << "serial: " << duration << "seconds\n";
    }

    return 0;
  } 
```

* * *

另请参阅：[使用更多线程时，什么会使程序运行速度变慢？](https://stackoverflow.com/questions/612860/what-can-make-a-program-run-slower-when-using-more-threads)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-25T17:59:56.797

您报告的时间是使用时钟功能测量的：

> 该[`clock()`](http://linux.die.net/man/3/clock)函数返回程序使用的处理器时间的近似值。

```
$ time bin/amit_kumar_threads.cpp
6.62seconds
serial: 2.7seconds

real    0m5.247s
user    0m9.025s
sys 0m0.304s 
```

多处理器任务的实时时间会更少，但处理器时间通常会更长。

当你使用多个线程时，工作可能由多个处理器完成，但工作量是相同的，另外可能会有一些开销，例如争用有限的资源。`clock()`测量总处理器时间，这将是工作+任何争用开销。所以它不应该少于在单个线程中完成工作的处理器时间。

从这个问题中很难判断您是否知道这一点，并且惊讶于返回的值`clock()`是单个线程的两倍，而不是仅仅多一点，或者您期望它更少。

使用[`clock_gettime()`](http://linux.die.net/man/3/clock_gettime)代替（您将需要实时库 librt `g++ -lrt`等）给出：

```
$ time bin/amit_kumar_threads.cpp
2.524 seconds
serial: 2.761 seconds

real    0m5.326s
user    0m9.057s
sys 0m0.344s 
```

这仍然不像人们希望的那样加速，但至少这些数字是有道理的。

100000000*20/2.5s = 800Hz，总线频率为 1600 MHz，所以我怀疑每次迭代都会进行读取和写入（假设有一些缓存），正如 tstenner 所建议的那样，您的内存带宽受到限制，并且该`clock()`值表明大多数您的一些处理器正在等待数据的时间。（有谁知道`clock()`时间是否包括这样的摊位？）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-25T17:47:06.347

您的线程唯一要做的就是添加一些元素，因此您的应用程序应该是 IO 绑定的。当你添加一个额外的线程时，你有 2 个 CPU 共享内存总线，所以它不会更快，相反，你会有缓存未命中等。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-25T17:51:07.707

我相信您的算法本质上使您的缓存内存无用。

您所看到的可能是三个线程之间的（非）引用局部性的影响。本质上是因为每个线程都在与其他线程相距甚远的不同数据部分上进行操作，因此您会导致缓存未命中，因为一个线程的数据部分替换了缓存中另一个线程的数据部分。如果你的程序被构造成线程操作的数据部分更小（这样它们都可以保存在内存中）或更靠近（这样所有线程都可以使用相同的缓存内页面），你会看到性能提升。因为我怀疑你的减速是因为许多内存引用必须从主内存而不是你的缓存中得到满足。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T17:51:38.643

与您的线程问题无关，但您的代码中存在边界错误。你有：

```
for(int i=0; i<ARR_SIZE; i++){ arr[i] += arr[i-1];} 
```

什么时候`i`是零你会做

```
arr[0] += arr[-1]; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-01T11:07:19.357

另请参阅[herb](http://www.ddj.com/go-parallel/article/printableArticle.jhtml;jsessionid=PRFIZDFRCRO1WQSNDLPCKH0CJUNN2JVN?articleID=214100002)关于多线程代码中多CPU和缓存行如何干扰的文章，特别是“所有共享都不好——即使是“未共享”对象......”部分

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T17:48:46.917

当您拥有适当的向量实现时，线程会将您带到*速度提升 (TM) 的应许之地。*这意味着您需要：

*   算法的适当并行化
*   一个知道并且可以将您的算法作为并行过程传播到硬件上的编译器
*   并行化的硬件支持

很难想出第一个。您需要能够拥有冗余并确保它不会影响您的性能，正确合并数据以处理下一批数据等等......

但这只是理论上的观点。

当您只有一个处理器和一个糟糕的算法时，运行多个线程不会给您带来太多好处。记住——只有一个处理器，所以你的线程必须等待一个时间片，本质上你*是*在做顺序处理。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-25T17:50:23.450

正如其他人指出的那样，线程不一定能提高速度。在这个特定示例中，每个线程所花费的时间明显少于执行上下文切换和同步所需的时间。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-25T18:04:45.397

tstenner 基本上是正确的。

这主要是您操作系统的“分配和映射新页面”算法的基准。该数组分配分配了 800MB 的虚拟内存；在需要之前，操作系统实际上不会分配真正的物理内存。“分配和映射新页面”通常受互斥体保护，因此更多内核无济于事。

您的基准测试还强调了内存总线（至少 800MB 传输；在将内存归零之前的操作系统上，最坏的情况是 800MB * 7 传输）。如果瓶颈是内存总线，那么添加更多内核并没有真正的帮助。

您有 3 个线程正在践踏同一内存。不同的线程正在读取和写入高速缓存行，因此两个 CPU 内核上的 L1 高速缓存之间将进行乒乓操作。（要写入的高速缓存行只能在一个 L1 高速缓存中，并且必须是附加到正在执行写入的 CPU 代码的 L1 高速缓存）。这不是很有效。CPU 内核可能大部分时间都在等待缓存行被传输，这就是为什么线程比单线程慢的原因。

顺便说一句，代码也有问题，因为相同的数组是从不同的 CPU 读取和写入而没有锁定的。适当的锁定会对性能产生影响。

# python - Python Virtual Machine architecture diagrams/references

> ID：682675
> 
> 赞同：14
> 
> 时间：2009-03-25T17:42:49.880
> 
> 标签：python, architecture, language-design, vm-implementation

Someone could point out sites/books where I can find introductory documentation about the architecture of the Python VM?

I'm interested in the C version, but if there are easy-to-follow references about other implementations it could be helpful too.

I'm trying to find any kind of resources of higher level than plain source code (however, UML diagrams or something like that would be nice) And also, information about the design decisions involved, including tradeoffs between the different factors (performance, stability, simplicity).

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-25T18:36:39.550

You should be able to find the information you need at [https://github.com/python/cpython/blob/HEAD/Python/ceval.c](https://github.com/python/cpython/blob/HEAD/Python/ceval.c)

If that's too low level for you, try

*   [http://www.python.org/dev/peps/pep-0339/](http://www.python.org/dev/peps/pep-0339/)
*   [http://codespeak.net/pypy/dist/pypy/doc/interpreter.html](http://codespeak.net/pypy/dist/pypy/doc/interpreter.html)
*   [http://thermalnoise.wordpress.com/2007/12/30/exploring-python-bytecode/](http://thermalnoise.wordpress.com/2007/12/30/exploring-python-bytecode/)
*   [https://docs.python.org/library/dis.html#python-bytecode-instructions](https://docs.python.org/library/dis.html#python-bytecode-instructions)
*   [http://wiki.python.org/moin/ByteplayDoc](http://wiki.python.org/moin/ByteplayDoc)
*   [http://peak.telecommunity.com/DevCenter/BytecodeAssembler](http://peak.telecommunity.com/DevCenter/BytecodeAssembler)
*   [http://nedbatchelder.com/blog/200804/wicked_hack_python_bytecode_tracing.html](http://nedbatchelder.com/blog/200804/wicked_hack_python_bytecode_tracing.html)
*   [https://jasonleaster.github.io/2016/02/21/architecture-of-python-virtual-machine/](https://jasonleaster.github.io/2016/02/21/architecture-of-python-virtual-machine/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-01-25T00:33:28.777

[Inside The Python Virtual Machine](https://leanpub.com/insidethepythonvirtualmachine) by Obi Ike-Nwosu.

# asp.net - 为什么网站项目中缺少 global.asax

> ID：682683
> 
> 赞同：8
> 
> 时间：2009-03-25T17:44:48.393
> 
> 标签：asp.net, global-asax

关于角色的几个问题`global.asax`：

1.  为什么它不包含在 Visual Studio 的网站项目中？如果没有此文件，是否还有其他方法可以实现相同的功能？

2.  如果我要创建一个 Web 应用程序项目，据我所知，`global.asax`会创建一个文件。如果我要删除它，项目会运行吗？

我试图寻找有关`global.asax`编译的一些解释，但没有找到任何有关此的信息.. 将不胜感激帮助/链接。:)

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-25T17:56:43.390

ASP.NET 站点可以在*没有*该`global.asax`文件的情况下运行。 [这](https://stackoverflow.com/questions/307821/what-alternatives-are-there-to-using-global-asax)是一个关于 global.asax 文件替代方案的问题。

即使您删除了一个`global.asax`文件，您的网站也能正常工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-25T17:48:40.507

ASP.NET 不需要 Globax.asax 来运行网站。但是，它对于应用程序级功能（如未处理的异常日志记录）非常有用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-25T17:54:36.997

1.  您可以将 Global.asax 添加到网站项目中，它会正常工作。
2.  Web 应用程序默认不添加 Global.asax。如果你有它，你可以毫无问题地删除它。

部署网站时要小心包含 .compiled 文件，否则 Global.asax 中的事件将不会触发。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T18:35:25.510

听起来您对 Web 应用程序项目很熟悉，现在看到一个网站“项目”并想知道发生了什么。在任何情况下，我都会回答，就好像那是真的一样。;-)

在 Visual Studio 2005 中，Microsoft 引入了 Web 站点“项目”，它们不是项目 - 它们只是本地磁盘、FTP 站点等上的目录结构。它们做的事情与 Web 应用程序项目不同，因此可能会造成混淆（特别是如果您像我一样，试图回答人们的问题，却不知道他们在使用哪个）。

使用 Visual Studio 2005 SP1，他们恢复了 Web 应用程序项目。如果那是您更熟悉的内容，那么我建议您使用它们。他们是真正的项目，就像他们一直以来一样。

而且，顺便说一句，将会有一个 global.asax，就像以前一样......

# git - Git - 处理混合编码文件名

> ID：682691
> 
> 赞同：14
> 
> 时间：2009-03-25T17:47:08.013
> 
> 标签：git

我有一个包含 windows (cp1252) 和 linux (utf8) 提交者的存储库。显然，Git 很困惑，并且放置了无效的（从 linux 的角度来看）文件名。我知道我可以使用钩子在一侧重命名文件（例如，在 linux 一侧，当文件出现时将文件从 cp1252 重命名为 utf8，而当它们消失时则相反），但是......我该怎么做呢？我必须写哪些钩子？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-25T22:23:52.793

好问题！

[http://www.serverwatch.com/tutorials/article.php/3705216](http://www.serverwatch.com/tutorials/article.php/3705216)谈论一个名为“convmv”的工具，它可以修复文件名。这可能会有所帮助。

Iconv [http://www.gnu.org/software/libiconv/](http://www.gnu.org/software/libiconv/)可以将任意文本转换成不同的字符集。

[http://ozmm.org/posts/git_post_commit_for_profit.html](http://ozmm.org/posts/git_post_commit_for_profit.html)告诉你如何去制作一个提交后的钩子，不过更多的是 Ruby 特定的。看起来你只是在 .git/hooks/post-commit 中添加了一个要执行的脚本，git 会在你提交后运行它。它可能是一个脚本，甚至可以在你的 git repo 中运行一个脚本。

对于脚本，我建议只用 find 扫描，将文件名转换为 UTF-8，看看它是否已经是那个名字，如果不是，移动它。

# python - Python 桌面集成 - 拖放

> ID：682692
> 
> 赞同：4
> 
> 时间：2009-03-25T17:47:20.010
> 
> 标签：python, drag-and-drop, pygame, desktop-integration

我有一个 pygame 窗口，我想知道何时将文件拖放到它上面。我只需要能够获取文件的名称。如何实现？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T21:06:32.637

这是一个可能是您正在寻找 的[论坛主题。](http://mail.python.org/pipermail/python-win32/2008-April/007406.html)

和[另一个](http://mail.python.org/pipermail/python-win32/2008-September/008209.html)论坛。

以及指向[msdn 页面](http://msdn.microsoft.com/en-us/library/ms678486(VS.85).aspx)的链接。您可能需要[pythoncom](http://docs.activestate.com/activepython/2.4/pywin32/pythoncom.html)库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-10-08T03:46:34.513

类似效果的一种选择是使用 pygame 的 scrap 模块，这样您就可以复制粘贴到窗口中，您的程序只需要查找 ctr-V 事件。

在我正在使用的这个 XFCE 桌面上如果我在选择文件的情况下按 ctrl-C，当我输入

```
pygame.scrap.init()

types= pygame.scrap.get_types()

print dict(
    [type,pygame.scrap.get(type)] 
    for type intypes
) 
```

# c - C中的固定地址变量

> ID：682697
> 
> 赞同：16
> 
> 时间：2009-03-25T17:48:13.377
> 
> 标签：c, embedded

对于嵌入式应用程序，通常需要访问外设寄存器的固定内存位置。我发现这样做的标准方法如下：

```
// access register 'foo_reg', which is located at address 0x100
#define foo_reg *(int *)0x100

foo_reg = 1;      // write to foo_reg
int x = foo_reg;  // read from foo_reg 
```

我理解它是如何工作的，但我不明白 foo_reg 的空间是如何分配的（即是什么阻止了链接器将另一个变量放在 0x100 处？）。是否可以在 C 级别保留空间，或者是否必须有一个链接器选项指定任何内容都不应位于 0x100。我正在使用 GNU 工具（gcc、ld 等），所以目前最感兴趣的是该工具集的细节。

有关我的体系结构的一些附加信息以澄清问题：

我的处理器通过一组映射到处理器的常规数据空间（变量所在的位置）的寄存器与 FPGA 连接。所以我需要指向那些寄存器并封锁相关的地址空间。过去，我使用过一个编译器，它具有从 C 代码中定位变量的扩展。我会将寄存器分组到一个结构中，然后将该结构放在适当的位置：

```
typedef struct
{ 
   BYTE reg1;
   BYTE reg2;
   ...
} Registers;

Registers regs _at_ 0x100;

regs.reg1 = 0; 
```

实际上创建一个“寄存器”结构在编译器/链接器的眼中保留了空间。

现在，使用 GNU 工具，我显然没有*at*扩展名。使用指针方法：

```
#define reg1 *(BYTE*)0x100;
#define reg2 *(BYTE*)0x101;
reg1 = 0

// or
#define regs *(Registers*)0x100
regs->reg1 = 0; 
```

这是一个没有操作系统和高级内存管理的简单应用程序。本质上：

```
void main()
{
    while(1){
        do_stuff();
    }
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-25T17:53:08.873

您的链接器和编译器对此一无所知（当然，您无需告诉它任何内容）。由您平台的 ABI 的设计者来指定他们不在这些地址分配对象。

所以，有时（我工作的平台有）虚拟地址空间中有一个范围直接映射到物理地址，而另一个范围可以被用户空间进程用来增加堆栈或分配堆内存。

您可以使用 GNU ld 的 defsym 选项在固定地址分配一些符号：

```
--defsym symbol=expression 
```

或者，如果表达式比简单的算术更复杂，请使用自定义链接描述文件。在那里您可以定义内存区域并告诉链接器应该将哪些区域分配给哪些部分/对象。请参阅[此处](http://sourceware.org/binutils/docs/ld/MEMORY.html#MEMORY)以获取解释。尽管这通常正是您使用的工具链作者的工作。他们采用 ABI 的规范，然后编写满足您平台要求的链接器脚本和汇编器/编译器后端。

顺便说一句，GCC 有一个[属性`section`](http://gcc.gnu.org/onlinedocs/gcc/Variable-Attributes.html#index-g_t_0040code_007bsection_007d-variable-attribute-2312)，您可以使用它来将您的结构放入特定的部分。然后，您可以告诉链接器将该部分放入您的寄存器所在的区域。

```
Registers regs __attribute__((section("REGS"))); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-25T18:03:17.680

链接器通常会使用链接描述文件来确定分配变量的位置。这称为“数据”部分，当然应该指向 RAM 位置。因此，不可能将变量分配到不在 RAM 中的地址。

[您可以在此处](http://www.xgc.com/manuals/gcc-1750-ug/p5node5.html)阅读有关 GCC 中的链接器脚本的更多信息。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-25T18:03:32.513

您的链接器处理数据和变量的放置。它通过链接描述文件了解您的目标系统。链接描述文件定义[内存布局](http://www.xgc.com/manuals/gcc-1750-ug/p5node12.html)中的区域，例如`.text`（用于常量数据和代码）和`.bss`（用于全局变量和堆），并在虚拟地址和物理地址之间创建关联（如果需要）。链接器脚本维护者的工作是确保链接器可用的部分不会覆盖您的 IO 地址。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-25T17:54:08.480

当嵌入式操作系统将应用程序加载到内存中时，它通常会将其加载到某个指定的位置，比如 0x5000。您使用的所有本地内存都将与该地址相关，也就是说，int x 将类似于 0x5000+code size+4... 假设这是一个全局变量。如果它是一个局部变量，它位于堆栈上。当您引用 0x100 时，您引用的是系统内存空间，即操作系统负责管理的同一空间，并且可能是它监视的一个非常特定的位置。

链接器不会将代码放置在特定的内存位置，它在“相对于我的程序代码所在的位置”内存空间中工作。

当您进入虚拟内存时，这会有点崩溃，但对于嵌入式系统，这往往是正确的。

干杯!

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-26T08:20:55.900

让 GCC 工具链为您提供适合直接在硬件上使用而无需加载操作系统的图像是可能的，但涉及到正常程序通常不需要的几个步骤。

1.  您几乎肯定需要自定义 C 运行时启动模块。这是一个组装模块（通常命名为`crt0.s`），负责初始化初始化数据、清除 BSS、如果包含具有全局对象的 C++ 模块，则调用全局对象的构造函数等。典型的定制包括需要将硬件设置为实际寻址 RAM（可能还包括设置 DRAM 控制器），以便有地方放置数据和堆栈。一些 CPU 需要以特定顺序完成这些事情：例如，ColdFire MCF5307 有一个芯片选择，它在启动后响应每个地址，最终必须将其配置为仅覆盖为连接芯片规划的内存映射区域。

2.  你的硬件团队（或者你可能戴着另一顶帽子）应该有一个内存映射，记录不同地址的内容。ROM 位于 0x00000000，RAM 位于 0x10000000，设备寄存器位于 0xD0000000 等。在某些处理器中，硬件团队可能仅将 CPU 的片选连接到设备，由您决定哪个地址触发该选择引脚.

3.  GNU ld 支持一种非常灵活的链接器脚本语言，它允许将可执行映像的各个部分放置在特定的地址空间中。对于正常编程，您永远不会看到链接器脚本，因为 gcc 提供了一个库存脚本，该脚本已针对您的操作系统对正常应用程序的假设进行了调整。

4.  链接器的输出采用可重定位格式，旨在由操作系统加载到 RAM 中。它可能有需要完成的重定位修复，甚至可能动态加载一些库。在 ROM 系统中，（通常）不支持动态加载，因此您不会这样做。但是您仍然需要原始二进制映像（通常是适合某种形式的 PROM 程序员的 HEX 格式），因此您需要使用 binutil 中的 objcopy 实用程序将链接器输出转换为合适的格式。

因此，要回答您提出的实际问题...

您使用链接描述文件来指定程序映像的每个部分的目标地址。在该脚本中，您有几个处理设备寄存器的选项，但所有这些选项都涉及将文本、数据、bss 堆栈和堆段放置在避开硬件寄存器的地址范围内。如果您的 ROM 或 RAM 溢出，还有一些可用的机制可以确保 ld 抛出错误，您也应该使用这些机制。

实际上，可以`#define`像您的示例中那样将设备地址放入您的 C 代码中，或者直接在链接描述文件中声明一个符号，该符号被解析为寄存器的基地址，并`extern`在 C 头文件中使用匹配的声明。

虽然可以使用 GCC 的`section`属性将未初始化的实例定义`struct`为位于特定部分（例如`FPGA_REGS`），但我发现这在实际系统中效果不佳。它会产生维护问题，并且成为描述片上设备的完整寄存器映射的一种昂贵方式。如果您使用该技术，则链接描述文件将负责映射`FPGA_REGS`到其正确地址。

在任何情况下，您都需要很好地理解对象文件的概念，例如“部分”（特别是文本、数据和 bss 部分，至少），并且可能需要深入了解弥合硬件之间差距的细节和软件，例如中断向量表、中断优先级、主管与用户模式（或 x86 变体上的环 0 到 3）等。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-25T17:49:47.243

通常，这些地址超出了您的流程的范围。所以，你的链接器不敢把东西放在那里。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-25T17:53:39.310

如果内存位置对你的架构有特殊意义，编译器应该知道这一点，而不是在其中放置任何变量。这类似于大多数架构上的 IO 映射空间。它不知道您正在使用它来存储值，它只知道普通变量不应该去那里。许多嵌入式编译器支持语言扩展，允许您在特定位置声明变量和函数，通常使用`#pragma`. 另外，通常我看到人们实现您尝试执行的那种内存映射的方式是在所需的内存位置声明一个 int ，然后将其视为全局变量。或者，您可以声明一个指向 int 的指针并将其初始化为该地址。这两者都提供了比宏更多的类型安全性。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-25T18:50:25.133

要扩展 litb 的答案，您还可以使用`--just-symbols=`{symbolfile} 选项定义多个符号，以防您有多个内存映射设备。符号文件需要采用以下格式

```
symbolname1 = address;
symbolname2 = address;
... 
```

（等号周围的空格似乎是必需的。）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-28T16:08:39.693

通常，对于嵌入式软件，您可以在链接器文件中为链接器分配的变量定义一个 RAM 区域，并为链接器不会触及的绝对位置的变量定义一个单独的区域。

不这样做应该会导致链接器错误，因为它应该发现它正在尝试将变量放置在已经被具有绝对地址的变量使用的位置。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-25T18:07:46.390

这在一定程度上取决于您使用的操作系统。我猜你正在使用 DOS 或 vxWorks 之类的东西。通常，系统会为硬件保留一定的内存空间区域，并且该平台的编译器*总是*足够聪明，可以避免将这些区域用于自己的分配。否则，当您打算访问变量时，您会不断地将随机垃圾写入磁盘或行式打印机。

如果有其他事情让您感到困惑，我还应该指出这`#define`是一个预处理器指令。不会为此生成任何代码。它只是告诉编译器将`foo_reg`它在源文件中看到的任何文本替换为`*(int *)0x100`. `*(int *)0x100`这与在你拥有的任何地方都输入你自己没有什么不同`foo_reg`，除了它可能看起来更干净。

我可能会做的（在现代 C 编译器中）是：

```
// access register 'foo_reg', which is located at address 0x100
const int* foo_reg = (int *)0x100;
*foo_reg = 1;  // write to foo_regint 
x = *foo_reg;  // read from foo_reg 
```

# .net - 使用受保护的配置加密 web.config 毫无意义？

> ID：682698
> 
> 赞同：5
> 
> 时间：2009-03-25T17:48:20.210
> 
> 标签：.net, asp.net, security, encryption, web-config

我肯定错过了什么...

因此，我正在寻找加密 web.config 中的数据库连接字符串和 sql 会话状态连接信息的最佳方法。我很快在 msdn 上找到了一个演练，解释了使用受保护的配置来加密 web.config 的部分： [MSDN walkthrough on using Protected Configuration](http://msdn.microsoft.com/en-us/library/dtkwfdky(VS.80).aspx)

所以我的想法很好，有一种机制可以做到这一点，而且看起来很简单。我到了演练的结尾，他们提供了一个可用于解密所有连接字符串的 aspx 页面的源代码！！！！

有什么意义？？？我没有在此 Web 服务器上运行任何 ftp 服务，任何人查看 web.config 的唯一方法是他们是否有权访问发布网站的文件系统。如果他们有，那么他们所要做的就是使用提供的代码来解密。

我错过了什么？有没有更好的方法来加密这些？如果我推出自定义解决方案，它将适用于 sql 会话状态部分吗？（不要相信 cane 从 web.config 中删除）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-25T18:03:51.873

假设您使用的是 DPAPI 提供程序，您至少需要对文件系统进行写访问才能对其进行解密。解密方法包括：

*   将包含解密代码的 aspx 页面复制到服务器并导航到它
*   登录服务器并运行应用程序来解密它。

但它可以防止未经授权的用户对文件系统具有读取权限或文件系统的备份进行解密。

通常，您会设置生产服务器，以便只有授权的管理员才能登录服务器或写入其文件系统。

出于支持目的，开发人员可能具有远程读取访问权限，并且无法远程解密配置文件。

使用标准库很容易加密/解密：困难的部分是确保只有授权的人才能访问密钥。

如果您使用的是 DPAPI，则实质上是将密钥的管理委托给 Windows 安全性。如果您使用其他提供商，例如 RSA，您需要将密钥存储在某处，并保护它免受未经授权的访问，例如使用 ACL。

# f# - F# 是否为您提供自动并行性？

> ID：682710
> 
> 赞同：17
> 
> 时间：2009-03-25T17:50:01.580
> 
> 标签：f#, parallel-processing

我的意思是：当您免费设计应用程序副作用等时，F# 代码会自动分布在所有内核上吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-25T18:03:55.977

不，恐怕不会。鉴于 F# 不是一种*纯粹*的函数式语言（在最严格的意义上），我相信这样做会相当困难。在 F# 中充分利用并行性的主要方法是使用**异步工作流**（我相信主要是通过异步模块）。.NET 4.0 引入的 TPL（任务并行库）将在 F# 中发挥类似的作用（尽管值得注意的是，它同样可以用于所有 .NET 语言），但我不能说我'我确切地知道它将如何与现有的异步框架集成。也许微软会简单地建议对所有事情都使用 TPL，或者他们可能会将两者都作为一种选择，最终将成为事实上的标准......

无论如何，这里有几篇关于 F# 中的异步编程/工作流的文章可以帮助您入门。

*   [http://blogs.msdn.com/dsyme/archive/2007/10/11/introducing-f-asynchronous-workflows.aspx](http://blogs.msdn.com/dsyme/archive/2007/10/11/introducing-f-asynchronous-workflows.aspx)
*   [http://strangelights.com/blog/archive/2007/09/29/1597.aspx](http://strangelights.com/blog/archive/2007/09/29/1597.aspx)
*   [http://www.infoq.com/articles/pickering-fsharp-async](http://www.infoq.com/articles/pickering-fsharp-async)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-25T20:16:48.140

F# 不会让它自动化，它只是让它变得简单。

又一个机会链接到[Luca 的 PDC 演讲](http://channel9.msdn.com/pdc2008/TL11/)。从 52:20 开始的八分钟是 F# 异步工作流的精彩演示。它摇摆不定！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-25T17:53:01.417

不，我很确定它不会*自动*为您并行化。它必须*知道*你的代码没有副作用，这很难证明，一方面。

当然，F# 可以*更轻松*地并行化您的代码，尤其是在您没有任何副作用的情况下……但那是另一回事。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-25T18:00:22.740

与提到的其他人一样，F# 不会自动跨内核扩展，并且仍然需要一个框架，例如 Josh 提到的 ParallelFX 端口。

F# 通常与并行处理的潜力相关联，因为它默认对象是不可变的，因此在许多情况下无需锁定。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-26T10:42:45.593

关于纯度注释：[代码契约](http://research.microsoft.com/en-us/projects/contracts/)有一个 Pure 属性。我记得听说 BCL 的某些部分已经使用了这个。潜在地，这个属性也可以被并行化框架使用，但我目前还不知道有这样的工作。另外，我什至不确定代码联系人在 F# 中的使用效果如何，所以这里有很多未知数。

不过，看看所有这些东西是如何结合在一起的，将会很有趣。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-25T17:52:29.670

不，它不会。您仍然必须通过 F# 支持的众多机制之一显式编组对其他线程的调用。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-25T17:53:17.687

我的理解是它不会，但[并行扩展正在被修改](http://weblogs.asp.net/podwysocki/archive/2009/02/23/adding-parallel-extensions-to-f.aspx)以使其可以被 F# 使用。这不会让它自动多线程它，应该让它很容易实现。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-25T18:13:01.323

好吧，你有你的答案，但我只是想补充一点，我认为这是 F# 最重要的限制，因为它是一种*混合*命令式/函数式语言。

我希望看到 F# 的一些扩展，它声明一个函数是*pure*。也就是说，它没有函数类型未表示的副作用。这个想法是，一个函数只有在它引用其他“已知纯”函数时才是纯函数。当然，这只有在可以要求作为函数参数传递的委托引用纯函数时才有用。

# html - 表单输入的名称导致错误

> ID：682716
> 
> 赞同：0
> 
> 时间：2009-03-25T17:51:01.030
> 
> 标签：html, forms, input

我从来没有见过这个，不知道发生了什么：

```
<form action="/cgi-bin/Lib.exe" method=POST name="slider" ID="Form2">
<input type="text" name="user" value="" ID="Text1">
<input type="text" name="end" value="" ID="Text2">
</form>

function setval()
{   
    alert(s.getValue());
    alert(s2.getValue());
    document.slider.user.value = s.getValue();//set value of hidden text box to value of slider
    document.slider.end.value = s2.getValue();//set value of hidden text box to value of slider
    document.slider.submit();
} 
```

从 setval() 提交表单时，当我将第一个输入框的名称从“用户”更改为其他任何内容时，我的 cgi 应用程序不会除此之外，我得到一个错误？我可以把secons输入框的名字改成anyting，好像没有问题？使困惑。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T18:00:14.877

对我来说，这似乎更像是 cgi 的问题，而不是 HTML/Javascript 的问题。它可能假设“用户”的值将始终被发送。在没有看到表单处理代码的情况下，我只能告诉你很多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T18:00:33.550

您的 CGI 必须期待一个名为“用户”的元素。您需要检查来源。

# c - 第九条诫命是什么意思？

> ID：682719
> 
> 赞同：9
> 
> 时间：2009-03-25T17:51:23.840
> 
> 标签：c

在[C 程序员的十诫中](http://www.lysator.liu.se/c/ten-commandments.html)，您对第[9 条诫命](http://www.lysator.liu.se/c/ten-commandments.html)的解释是什么？

### 第九条诫命：

> 你的外部标识符在前六个字符中应该是唯一的，尽管这种严酷的纪律令人厌烦，而且它必要的岁月在你面前似乎没有尽头，以免你在那个决定性的日子里扯掉你的头发并发疯程序在旧系统上运行。

这到底是怎么回事？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-03-25T17:54:02.070

旧的链接器只使用了有限数量的符号字符——我似乎记得我开始编程的旧 IBM 大型机只使用了 8 个字符。C 标准的人们将 6 个字符确定为“最小公分母”，但如果他们愿意，可以允许链接器解析更长的名称。

如果您真的点击了这些最低公分母链接器之一，那么外部符号（函数名称、外部变量等）ABCDEFG 和 ABCDEFH 对它们来说将是相同的。除非您在非常旧的硬件上进行编程，否则您可以放心地忽略此“命令”。

请注意，任何不能处理超过 6 个字符的链接器都不能执行 C++，因为名称重整。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-25T17:54:54.423

外部标识符 = 可能必须从另一个系统调用的东西

前六个字符唯一的原因是一个古老的系统可能对其标识符有六个字符的限制。如果有一天，这样的系统试图调用你的代码，它需要能够区分你所有的函数。

这些天来，这对我来说似乎过于保守，除非你正在使用很多遗留系统。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-25T18:30:46.707

以下是 C/C++ 编译器在各种标准下必须支持的外部标识符中有效字符的最少数量：

*   C90 - 6 个字符
*   C99 - 31 个字符
*   C++98 - 1024 个字符

[如果您的工具集忽略了这些限制（来自http://www.comeaucomputing.com/libcomo/](http://www.comeaucomputing.com/libcomo/)），以下是您可能遇到的各种问题的示例：

> 使用 Borland 和 MetroWerks CodeWarrior 作为后端 C 的用户注意：
> 
> ================================================== =================
> 
> 请注意，Borland 编译器和链接器以及 Metrowerks 编译器的最大外部 id 长度似乎为 250 个字符。事实证明，一些生成的错位模板名称无法容纳在该空间内。因此，当使用 Borland 或 Metrowerks 作为后端 C 编译器时，我们将 libcomo 使用的一些名称重新映射为更短的名称。这么短，事实上我们无法摆脱以下划线开头的名字。事实上，有必要将大多数映射到 2 个字符 id 名称。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-25T18:55:55.493

回应：

*   C++98 - 1024 个字符

“开始幽默”

第九条诫命的附录：

> 如果你的外部标识符接近一千零二十四，你肯定应该迅速被带到外面并被枪杀。

'/结束幽默'

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-25T17:55:25.233

许多旧的编译器和链接器对标识符的长度有限制。六个字符是一个常见的限制。实际上，它们可能比这更长，但是编译器或链接器会丢弃第六个字符之后的所有内容。

这通常是为了节省符号表内存。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-25T18:06:39.793

这意味着你正在看一段古老的历史。那些诫命大多是真的，但那第九条还不如真的刻在一块石碑上，太古老了。

剩下的谜团是：`creat`。出了什么问题`create`？只有六个字母！

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-25T17:54:49.057

根据[这个网站](http://everything2.com/title/The%2520Ten%2520Commandments%2520for%2520C%2520Programmers)：

*这是什么意思？您的全局变量应该是“前六个字母唯一”，而不是“仅限于六个字母”。我听说这是在 ANSI 中，因为某些链接器非常痛苦地“过时”。希望 ANSI 有一天会说“链接器必须使用更长的名称，否则它们会哭泣并使用更长的名称”。（所有理性的人都会忽略这条诫命并告诉人们升级他们的 2 便士链接器 - 这可能不会让你成为朋友，或者让警告开心......）*

# c++ - 在 Main C++ 中调用成员函数

> ID：682721
> 
> 赞同：14
> 
> 时间：2009-03-25T17:51:40.220
> 
> 标签：c++, function

```
#include <iostream>

using namespace std;

class MyClass
{
public:
       void printInformation();
};

void MyClass::printInformation()
{
     return;
}

int main()
{

    MyClass::printInformation();

    fgetc( stdin );
    return(0);
} 
```

我将如何在其中调用该`printInformation`函数`main`？该错误告诉我需要使用类对象来执行此操作。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-03-25T17:53:53.753

声明 MyClass 的一个实例，然后在该实例上调用成员函数：

```
MyClass m;

m.printInformation(); 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-03-25T18:58:45.020

根据您的问题，不清楚您是否希望能够在没有身份的情况下使用该类，或者调用该方法是否需要您创建该类的实例。这取决于您是否希望 printInformation 成员编写一些一般信息或更具体的关于对象身份的信息。

**案例 1**：您想在**不创建实例的情况下**使用该类。该类的成员应该是**static**，使用 this 关键字告诉编译器您希望能够调用该方法而不必创建该类的新实例。

```
class MyClass
{
public:
    static void printInformation();
}; 
```

**案例 2**：您希望类**有一个实例**，您首先需要**创建一个对象**，以便该类具有一个标识，一旦完成，您就可以使用该对象的方法。

```
Myclass m;
m.printInformation();

// Or, in the case that you want to use pointers:
Myclass * m = new Myclass();
m->printInformation(); 
```

如果您不知道何时使用指针，请阅读此[Stack Overflow 问题](https://stackoverflow.com/questions/397263/when-to-use-pointers-and-when-not-to)中的 Pukku 总结。
请注意，在当前情况下，您不需要指针。:-)

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-03-25T17:54:03.083

如果你想让你的代码像上面那样工作，函数 printInformation() 需要被声明和实现为一个静态函数。

另一方面，如果它应该打印有关特定对象的信息，则需要先创建该对象。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-25T17:54:28.947

您需要创建一个对象，因为`printInformation()`它是非静态的。尝试：

```
int main() {

MyClass o;
o.printInformation();

fgetc( stdin );
return(0);

} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-25T17:56:46.477

像这样声明它“静态”：

```
static void MyClass::printInformation() { return; } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-12-16T12:53:29.133

你必须创建一个类的实例来调用该方法..

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-02-16T07:36:32.327

非正式地，您还可以在临时对象上调用非静态成员函数：

```
MyClass().printInformation(); 
```

*（在另一个非正式的注释中，临时变量（变量*很重要，因为您也可以调用非常量成员函数）的生命周期结束在完整表达式（“;”）的末尾）

# java - 读取 MIME 编码流的正确方法是什么？

> ID：682725
> 
> 赞同：3
> 
> 时间：2009-03-25T17:53:02.977
> 
> 标签：java, tcp, stream, mime

我有一个带有流式 MIME 消息的 TCP 套接字。我可以使用 JavaMail API 通过搜索边界来一次解析一条 MIME 消息，然后寻找边界 + -- 符号。

这似乎是很多字符串操作。必须有人在 Java 中正确地完成了 MIME 编码的流式传输。它藏在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T17:59:52.897

看看这个库：

[http://code.google.com/p/mimeparser/](http://code.google.com/p/mimeparser/)

# flash - 在 IE 中使用 AS3 检测 CTRL+V

> ID：682746
> 
> 赞同：4
> 
> 时间：2009-03-25T17:56:55.010
> 
> 标签：flash, actionscript, detect, ctrl

我无法`Ctrl``V`在 IE 中使用 AS3 检测到 swf 上的键盘事件。它似乎触发了默认的浏览器行为，我无能为力......有什么解决方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-26T02:05:42.917

如果这是您遇到的浏览器行为，您可以编写一些 JavaScript 来阻止它。还有另一个相关的帖子，关于在 JS 中捕获关键事件并将它们中继到 flash。[在此处](https://stackoverflow.com/questions/683486/javascript-to-actionscript-keypress-passing-utility/684220#684220)查看我的回复并专注于该`preventDefault()`部分。你应该只取出你不需要的代码并留下类似的东西

```
$(document).ready(function() {
    $(document).keydown(function (event) { event.preventDefault(); });
} 
```

当然，您必须导入[jQuery 库](http://jquery.com/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T18:03:20.580

你试过[`Clipboard.generalClipboard`](http://livedocs.adobe.com/flex/3/html/help.html?content=CopyAndPaste_2.html)吗？

# django-admin - 在 Django Admin 中选择列表过滤

> ID：682757
> 
> 赞同：2
> 
> 时间：2009-03-25T18:00:45.627
> 
> 标签：django-admin

我是 Django 新手，到目前为止我非常喜欢它，但我遇到了一些障碍，我不确定是在管理员中还是在我的模型中可以更改它。我有一个看起来像这样的关系：不幸的是，由于情况我无法链接实际代码

```
class A:

class B:
    a = models.ForeignKey(A)

class C:
    a = models.ForeignKey(A)

class D:
    b = models.ForeignKey(B)
    c = models.ForeignKey(C) 
```

当我运行管理员时，在创建“D”行时，我会得到一个很好的“C”类选择列表。管理员将“D”作为“B”的内联，因此填充了“B”。问题是“C”的选择列表是“C”的所有实例，我想要的是当我想编辑“B”及其相关的“D”时，只有“C”的实例是绑定到“A”。好的，我希望这不会太混乱。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T18:06:13.383

您很可能需要为此注入自定义小部件。

# java - 用于 POJO 到 XML 的 Castor 1.2

> ID：682758
> 
> 赞同：-1
> 
> 时间：2009-03-25T18:00:54.113
> 
> 标签：java, xml, castor

我正在使用 Castor 1.2 进行编组。

您有为此目的使用 Castor 的经验吗？
您对提高性能有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-05T14:56:13.993

Castor 1.2 是支持 Java 1.4 的最后一个版本，因此它仍然被尚未过渡到 1.5 或 1.6 的商店广泛使用（在我的例子中，我们坚持部署到较旧的 Weblogic 版本）。

获得性能改进的最佳方法是使用映射文件，而不是让 Castor 使用反射来编组/解组您的 XML。映射文件可以包含明确的 XML 元素到 Java 类的映射，并省略任何您不感兴趣的翻译。例如，如果 XML 记录包含客户的帐单信息以及最近 100 个订单的历史记录，但所有您关心的是计费信息，您可以将适当的 XML 元素显式映射到您的计费信息类。Castor 将忽略其余的 XML 元素，从而加快编组过程。

最后一个提示是下载 Castor 1.2 的源代码，即使您不打算自己构建代码。1.2 的文档没有保持最新，因此在 1.3 及更高版本中引入的一些新功能实际上也已添加到 Castor 1.2 中。通过快速比较 1.3 文档和 1.2 代码，您可以了解最近对 Castor 1.2 进行了哪些改进。

# java - 在 Rhino 中返回一个宿主对象

> ID：682760
> 
> 赞同：3
> 
> 时间：2009-03-25T18:01:02.007
> 
> 标签：java, javascript, rhino, host-object

在 Rhino 中将宿主对象返回到 JavaScript 的最佳方法是什么？我有两个这样的课程：

```
public class Hosted extends org.mozilla.javascript.ScriptableObject {
    private static final long serialVersionUID = 1;
    public Hosted() {}
    public void jsConstructor() {}

    public String getClassName() {
        return "Hosted";
    }

    public Member jsGet_member() {
        Member m = new Member();
        m.defineFunctionProperties(new String[] { "toString" }, m.getClass(), DONTENUM);
        return m;
    }
}

public class Member extends org.mozilla.javascript.ScriptableObject {
    private static final long serialVersionUID = 2;
    public Member() {}
    public void jsConstructor() {}

    public String getClassName() {
        return "Member";
    }

    public String toString() {
        return "called toString()";
    }
} 
```

从某种意义上说，它可以调用 toString 方法，但成员对象的行为与我预期的不同：

```
js> defineClass("Hosted");
js> defineClass("Member");
js> var h = new Hosted();
js> h.toString();
[object Hosted]
js> h instanceof Hosted;
true
js> h.__proto__;
[object Hosted]
js> 
js> var m = h.member;
js> m.toString();
called toString()
js> m instanceof Member; // Should be true
false
js> m.__proto__; // Should be [object Member]
null 
```

如果我打电话`Object.prototype.toString`，它确实说它是一个成员对象：

```
js> Object.prototype.toString.call(m);
[object Member] 
```

我试过打电话`m.setPrototype`和`Context.javaToJS`。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-27T20:38:02.237

```
 public Scriptable jsGet_member() {
        Scriptable scope = ScriptableObject.getTopLevelScope(this);
        Member m = new Member();
        m.setParentScope(scope);
        // defineClass("Member") must have previously been called.
        m.setPrototype(ScriptableObject.getClassPrototype(scope, "Member"));
        m.defineFunctionProperties(new String[] { "toString" },
                m.getClass(), DONTENUM);
        return m;
    } 
```

* * *

```
js> defineClass("Member")
js> defineClass("Hosted")
js> var h = new Hosted();
js> var m = h.member;
js> m.toString();
called toString()
js> m instanceof Member;
true
js> m.__proto__;
[object Member] 
```

* * *

**编辑**：该方法也可以写成：

```
 public Scriptable jsGet_member() {
        Scriptable scope = ScriptableObject.getTopLevelScope(this);
        Context cx = Context.getCurrentContext();
        Member m = (Member)cx.newObject(scope, "Member");
        m.defineFunctionProperties(new String[] { "toString" },
                m.getClass(), DONTENUM);
        return m;
    } 
```

这将调用 Member.jsConstructor；可能还有其他差异。

# svn - 如何使用 subversion 存储库作为新项目的模板？

> ID：682761
> 
> 赞同：0
> 
> 时间：2009-03-25T18:01:28.697
> 
> 标签：svn, version-control, branch

我创建了一个定制版本的 Wordpress 供我们用作 Web 项目的模板，存储在 svn 存储库中。

它具有各种属性集（忽略、wordpress + 插件作为外部）以简化工作流程和更新。

我的问题是，如何将其用作其他项目/存储库的基础？

*   如果您导出，它会丢失所有属性。

*   如果您签出，它是模板存储库的工作副本，不能导入/提交到新存储库（？）

在这种情况下应该使用分支吗？这似乎不对，因为项目永远不会合并回模板中（尽管我猜某些部分可能是）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T18:06:52.337

可以将其作为分支。您可以跟踪主版本中的整体更新，并在适当的时候应用到分支。

附言。如果您仍想将其用作模板，则已经回答了一个关于它的问题：[有没有办法将存储库用作“模板”来启动新的存储库？](https://stackoverflow.com/questions/680518/is-there-a-way-to-use-an-repository-as-a-template-to-start-a-new-repository)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T18:04:40.640

将您的自定义版本和 SVN 副本导入到新位置。如果您计划在同一个仓库中开发，这将有效。否则导出和导入到另一个仓库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T18:08:34.127

我会在您的模板中添加一个 bat，使用“svn propset”设置所需的属性，然后自行删除。

用户将导出模板，将文件添加到新存储库并运行 propset bat。

编辑：

我的意思是一个批处理文件。您可以使用 svn proplist 和 svn propget 查看当前拥有的属性。然后在您的 setprop.bat 中调用 svn propset，例如：

```
svn propset svn:ignore *.bak dir1
svn propset svn:ignore *.etc dir2
svn propset svn:externals "extdir svn://domain/trunk" . 
```

# database - 数据库索引

> ID：682762
> 
> 赞同：3
> 
> 时间：2009-03-25T18:01:46.090
> 
> 标签：database, indexing, clustered-index

我需要开发用于分布式环境的数据库索引的“简单”实现。我对这个主题几乎一无所知，而且我有点被时间压力。

我很想听听关于这个主题的一些意见、例子和算法。我希望能够对我需要实现的内容有一个心理表征。

**编辑：**我指的是聚集索引

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T18:04:09.080

基本上有两种主要类型的索引：

*   集群（即数据是物理组织的，如果需要，您可以在每次插入时重新排序）

    典型用例：物理组织通常与插入顺序相同，因此重新排序开销不是问题。例如，顺序 UID（数据库上下文中所谓的“IDENTITY”字段）就是这种情况

    聚集索引的一个明显缺点是您的数据只能有一个这样的索引。

    如果插入顺序恰好是排序顺序，则实现天真：使用列表。

    1.  插入是 O(1) ：您只需附加列表的新数据
    2.  如果 ID 是顺序的（即数组索引与 UID 完全匹配），则访问为 O(1)，否则为 O(log)
*   非集群的（即你在数据上保留指针，就像在哈希表中一样）

    典型用例：集群不合适，因为它会导致很大的插入开销。

根据您的需要，您可能最终会使用这两个数据结构

[此处](http://www.sqlservercentral.com/articles/Indexing/)提供了与索引相关的广泛信息库

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T18:09:27.070

一个非常快速且易于实现、非常简单的索引实现，最适合任何具有本机关[联数组](http://en.wikipedia.org/wiki/Associative_array)格式的语言，是一个哈希，其键是您要索引的列的现有值，其值是数组具有该值的行的行 ID。

# html - 选择固定宽度的下拉菜单，在 IE 中截断内容

> ID：682764
> 
> 赞同：55
> 
> 时间：2009-03-25T18:02:58.040
> 
> 标签：html, css, internet-explorer, html-select

问题：

选择中的某些项目需要超过 145px 的指定宽度才能完全显示。

**Firefox 行为**：单击选择显示下拉元素列表调整为最长元素的宽度。

**IE6 和 IE7 行为**：单击选择显示下拉元素列表限制为 145 像素宽度，从而无法读取较长的元素。

当前的 UI 要求我们将此下拉列表调整为 145 像素，并让它托管具有更长描述的项目。

关于解决 IE 问题的任何建议？

即使展开列表，顶部元素也应保持 145px 宽。

谢谢！

的CSS：

```
select.center_pull {
    background:#eeeeee none repeat scroll 0 0;
    border:1px solid #7E7E7E;
    color:#333333;
    font-size:12px;
    margin-bottom:4px;
    margin-right:4px;
    margin-top:4px;
    width:145px;
} 
```

这是选择输入代码（此时没有定义backend_dropbox样式）

```
<select id="select_1" class="center_pull backend_dropbox" name="select_1">
<option value="-1" selected="selected">Browse options</option>
<option value="-1">------------------------------------</option>
<option value="224">Option 1</option>
<option value="234">Longer title for option 2</option>
<option value="242">Very long and extensively descriptive title for option 3</option>
</select> 
```

完整的 html 页面，以防您想在浏览器中快速测试：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>dropdown test</title>

<style type="text/css">
<!--
select.center_pull {
    background:#eeeeee none repeat scroll 0 0;
    border:1px solid #7E7E7E;
    color:#333333;
    font-size:12px;
    margin-bottom:4px;
    margin-right:4px;
    margin-top:4px;
    width:145px;
}
-->
</style>
</head>

<body>
<p>Select width test</p>
<form id="form1" name="form1" method="post" action="">
<select id="select_1" class="center_pull backend_dropbox" name="select_1">
<option value="-1" selected="selected">Browse options</option>
<option value="-1">------------------------------------</option>
<option value="224">Option 1</option>
<option value="234">Longer title for option 2</option>
<option value="242">Very long and extensively descriptive title for option 3</option>
</select>
</form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2010-12-22T15:31:15.417

对于 IE 8，有一个简单的纯 CSS 解决方案：

```
select:focus {
    width: auto;
    position: relative;
} 
```

（如果选择框是具有固定宽度的容器的子容器，则需要设置位置属性。）

不幸的是，IE 7 和更低版本不支持 :focus 选择器。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2010-12-30T11:28:09.410

我对这个问题进行了谷歌搜索，但没有找到任何最佳解决方案，因此创建了一个适用于所有浏览器的解决方案。

只需在页面加载时调用 badFixSelectBoxDataWidthIE() 函数。

```
function badFixSelectBoxDataWidthIE(){
    if ($.browser.msie){
      $('select').each(function(){
    if($(this).attr('multiple')== false){
      $(this)
          .mousedown(function(){
               if($(this).css("width") != "auto") {
                   var width = $(this).width();
                   $(this).data("origWidth", $(this).css("width"))
                          .css("width", "auto");
                   /* if the width is now less than before then undo */
                   if($(this).width() < width) {
        $(this).unbind('mousedown');
                       $(this).css("width", $(this).data("origWidth"));
                   }
               }
           })
           /* Handle blur if the user does not change the value */
           .blur(function(){
               $(this).css("width", $(this).data("origWidth"));

           })
           /* Handle change of the user does change the value */
           .change(function(){
               $(this).css("width", $(this).data("origWidth"));

           });
        }
      });
    }
    } 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-25T18:10:01.580

这是一个可以帮助您的小脚本：

[http://www.icant.co.uk/forreview/tamingselect/](http://www.icant.co.uk/forreview/tamingselect/)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2011-02-10T12:28:52.047

对于一个简单的无 Javascript 解决方案，根据您的要求，将标题属性添加到保存文本的 <option> 可能就足够了。

```
<option value="242" title="Very long and extensively descriptive text">
  Very long and extensively descriptive text
</option> 
```

这将在悬停 <option> 时以工具提示方式显示截断文本，而不管 <select> 的宽度如何。

适用于 IE7+。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-07-17T13:01:25.193

恐怕不是免费的 javascript，但我设法使用 jQuery 使它变得非常小

```
$('#del_select').mouseenter(function () {

    $(this).css("width","auto");

});

$('#del_select').mouseout(function () {

    $(this).css("width","170px");

}); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-10-06T14:14:51.043

只需您可以将此插件用于 jquery ;)

[http://plugins.jquery.com/project/skinner](http://plugins.jquery.com/project/skinner)

```
$(function(){
          $('.select1').skinner({'width':'200px'});
}); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-05-01T23:46:29.980

对 MainMa 和 user558204 的代码进行了小但希望有用的更新（谢谢大家），它删除了不必要的每个循环，将 $(this) 的副本存储在每个事件处理程序的变量中，因为它被多次使用，还结合了模糊和更改事件，因为它们具有相同的操作。

是的，它仍然不完美，因为它调整了选择元素的大小，而不仅仅是下拉选项。但是，嘿，它让我摆脱了困境，我（非常非常不幸）仍然必须支持整个企业中以 IE6 为主的用户群。

```
// IE test from from: https://gist.github.com/527683
var ie = (function () {
  var undef, v = 3, div = document.createElement('div'), all = div.getElementsByTagName('i');
  while (
    div.innerHTML = '<!--[if gt IE ' + (++v) + ']><i></i><![endif]-->',
    all[0]
  );
  return v > 4 ? v : undef;
} ());

function badFixSelectBoxDataWidthIE() {
  if (ie < 9) {
    $('select').not('[multiple]')
      .mousedown(function() {
        var t = $(this);
        if (t.css("width") != "auto") {
          var width = t.width();
          t.data("ow", t.css("width")).css("width", "auto");

          // If the width is now less than before then undo
          if (t.width() < width) {
            t.unbind('mousedown');
            t.css("width", t.data("ow"));
          }
        }
      })

      //blur or change if the user does change the value
      .bind('blur change', function() {
        var t = $(this);
        t.css("width", t.data("ow"));
      });
  }
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-05-14T05:50:53.310

我找到了一个非常简单的解决方法。在`<select>`html 元素中添加以下属性：

```
onmouseover="autoWidth(this)" 
onblur="resetWidth(this)" 
```

因此，每当用户单击该宽度将自动扩展，并且用户移出选择框时，宽度将重置为原始宽度。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-09-30T17:06:45.930

另一种方法：

1.  而不是选择使其成为编辑框，禁用，因此没有人可以手动输入任何内容或在选择后更改内容
2.  另一个隐藏的编辑，包含所选选项的 id（解释如下）
3.  制作一个按钮 [..] 并编写脚本以显示下面的 div
4.  在编辑框下方或附近制作一个绝对位置的隐藏 div
5.  使该 div 包含一个样式 size="6" 的选择（以显示 6 个选项和一个滚动条而不是下拉列表）和一个按钮“选择”，也许还有“取消”
6.  不要设置宽度样式，因此整个事情将假定最宽选项或按钮的宽度加上您选择的一些填充
7.  编写“选择”按钮以将所选选项的 id 复制到隐藏的编辑框，并将其值复制到可见的编辑框中，也可以再次隐藏 div。

总共 4 个简单的 JavaScript 命令。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-02-21T03:41:41.210

可以在此处找到类似的解决方案，使用 jquery 设置焦点（或鼠标输入）时的自动宽度，并在模糊（或鼠标离开）时设置原始宽度[http://css-tricks.com/select-cuts-off-options-in -即修复/](http://css-tricks.com/select-cuts-off-options-in-ie-fix/)。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-05-04T01:54:03.367

```
for (i=1;i<=5;i++){
   idname = "Usert" + i;
   document.getElementById(idname).style.width = "100%";

} 
```

当宽度显示不正确时，我使用这种方式显示下拉列表。

它适用于 IE6、Firefox 和 Chrome。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-08-20T11:41:47.020

一个完整的 jQuery 插件可用，查看演示页面： http: [//powerkiki.github.com/ie_expand_select_width/](http://powerkiki.github.com/ie_expand_select_width/)

免责声明：我编写了那个东西，欢迎使用补丁

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2012-09-20T20:00:34.687

为什么有人想要下拉列表中的鼠标悬停事件？以下是一种操作 IE8 的方法，以实现下拉列表的工作方式：

首先，让我们确保我们只在 IE8 中传递我们的函数：

```
 var isIE8 = $.browser.version.substring(0, 2) === "8.";
    if (isIE8) {
       //fix me code
    } 
```

然后，为了让选择扩展到内容区域之外，让我们用正确的结构将下拉列表包装在 div 中，如果还没有的话，然后调用辅助函数：

```
 var isIE8 = $.browser.version.substring(0, 2) === "8.";
    if (isIE8) {
        $('select').wrap('<div class="wrapper" style="position:relative; display: inline-block; float: left;"></div>').css('position', 'absolute');

        //helper function for fix
        ddlFix();
    } 
```

现在进入事件。由于IE8无论出于何种原因在聚焦后都会引发一个事件，因此IE在尝试展开时会在渲染后关闭小部件。解决方法是绑定到**“focusin”**和**“focusout”**一个类，该类将根据最长的选项文本自动扩展。**然后，为了确保不会缩小到默认值的恒定最小宽度，我们可以获得当前选择列表宽度，并将其设置为“onchange”**绑定上的下拉列表最小宽度属性：

```
 function ddlFix() {
    var minWidth;

    $('select')

    .each(function () {
        minWidth = $(this).width();
        $(this).css('min-width', minWidth);
    })
    .bind('focusin', function () {
        $(this).addClass('expand');
    })
    .change(function () {
        $(this).css('width', minWidth);
    })
    .bind('focusout', function () {
        $(this).removeClass('expand');
    });
} 
```

最后，确保在样式表中添加这个类：

```
 select:focus, select.expand {
    width: auto;
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-07-02T11:59:26.233

恐怕不是 javascript 免费的，而且我的解决方案确实需要一个 js 库，但是，您只能使用您需要的那些文件，而不是全部使用它们，也许最适合那些已经在他们的项目中使用 YUI 或决定使用哪些文件的人一个使用。看看：[http ://ciitronian.com/blog/programming/yui-button-mimicking-native-select-dropdown-avoid-width-problem/](http://ciitronian.com/blog/programming/yui-button-mimicking-native-select-dropdown-avoid-width-problem/)

我的博客文章还讨论了其他解决方案，其中一个在 stackoverflow 上被引用回此处，为什么我回去创建自己的 SELECT 元素是因为简单的原因，我不喜欢 mouseover 展开事件。也许如果这对其他人也有帮助！

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2011-09-05T19:33:09.227

jquery [BalusC 的](https://stackoverflow.com/questions/73960/dropdownlist-width-in-ie)解决方案由我改进。也使用：布拉德罗伯逊的[评论在这里](http://doctype.com/ie7-width-overrides-minwidth-select)。

只需将它放在 .js 中，使用宽类来获得所需的组合，不要伪造给它一个 ID。调用 onload 中的函数（或 documentReady 或其他）。
就这么简单:)
它将使用您为组合定义的宽度作为最小长度。

```
function fixIeCombos() {
    if ($.browser.msie && $.browser.version < 9) {
    var style = $('<style>select.expand { width: auto; }</style>');
    $('html > head').append(style);

    var defaultWidth = "200";

    // get predefined combo's widths.
    var widths = new Array();
    $('select.wide').each(function() {
        var width = $(this).width();
        if (!width) {
        width = defaultWidth;
        }
        widths[$(this).attr('id')] = width;
    });

    $('select.wide')
    .bind('focus mouseover', function() {
        // We're going to do the expansion only if the resultant size is bigger
        // than the original size of the combo.
        // In order to find out the resultant size, we first clon the combo as
        // a hidden element, add to the dom, and then test the width.
        var originalWidth = widths[$(this).attr('id')];

        var $selectClone = $(this).clone();
        $selectClone.addClass('expand').hide();
        $(this).after( $selectClone );
        var expandedWidth = $selectClone.width()
        $selectClone.remove();
        if (expandedWidth > originalWidth) {
        $(this).addClass('expand').removeClass('clicked');
        }
    })
    .bind('click', function() {
        $(this).toggleClass('clicked'); 
    })
    .bind('mouseout', function() {
        if (!$(this).hasClass('clicked')) {
        $(this).removeClass('expand');
        }
    })
    .bind('blur', function() {
        $(this).removeClass('expand clicked');
    })
    }
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2012-05-08T11:51:17.143

已在所有版本的 IE、Chrome、FF 和 Safari 中测试

// JavaScript 代码

```
 <script type="text/javascript">
    <!-- begin hiding
    function expandSELECT(sel) {
      sel.style.width = '';
    }
    function contractSELECT(sel) {
      sel.style.width = '100px';
    }
    // end hiding -->
    </script>

// Html code

    <select name="sideeffect" id="sideeffect"  style="width:100px;" onfocus="expandSELECT(this);" onblur="contractSELECT(this);" >
      <option value="0" selected="selected" readonly="readonly">Select</option>
    <option value="1" >Apple</option>
    <option value="2" >Orange + Banana + Grapes</option> 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2012-06-26T16:12:53.717

我对此还有另一个贡献。我不久前写了这篇文章，您可能会觉得有帮助：[http ://dpatrickcaldwell.blogspot.com/2011/06/giantdropdown-jquery-plugin-for-styling.html](http://dpatrickcaldwell.blogspot.com/2011/06/giantdropdown-jquery-plugin-for-styling.html)

这是一个 jquery 插件，用于制作由隐藏的选择元素支持的可样式化无序列表。

源码在github上：[https ://github.com/tncbbthositg/GiantDropdown](https://github.com/tncbbthositg/GiantDropdown)

您将能够处理 UL 上无法使用 SELECT 处理的行为和样式。其他一切都应该是一样的，因为选择列表仍然存在，它只是被隐藏了，但 UL 将使用它作为支持数据存储（如果你愿意的话）。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2012-07-19T19:30:44.993

这是一个实际有效的解决方案。

它在 IE 中设置宽度，并且不会弄乱您的页面布局，并且当您将鼠标悬停在选择选项上时，它不会关闭下拉列表，就像此页面上的其他一些解决方案一样。

但是，您需要更改`margin-right`值和宽度值以匹配您选择字段的值。

您也可以将 替换`$('select')`为`$('#Your_Select_ID_HERE')`仅影响特定的选择字段。您还需要使用 DOM`fixIESelect()`在主体上`onload`或通过 jQuery调用函数，`ready`就像我在下面的代码中所做的那样：

```
//////////////////////////
// FIX IE SELECT INPUT //
/////////////////////////
window.fixIESelect_clickset = false;
function fixIESelect()
{
 if ($.browser.msie)
 {
  $('select').mouseenter(function ()
  {
   $(this).css("width","auto");
   $(this).css("margin-right","-100");
  });
  $('select').bind('click focus',function ()
  {
   window.fixIESelect_clickset = true;
  });
  $('select').mouseout(function ()
  {
   if(window.fixIESelect_clickset != true)
   {
    $(this).css("width","93px");
    window.fixIESelect_clickset = false;
   }
  });
  $('select').bind('blur change',function ()
  {
   $(this).css("width","93px");
  });
 }
}
/////////////
// ONLOAD //
////////////
$(document).ready(function()
{
 fixIESelect();
}); 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2012-09-08T19:57:31.587

我希望它可以与我动态添加到页面的选择一起使用，所以经过大量实验后，我最终给出了我想要使用“固定宽度”类执行此操作的所有选择，然后添加了以下 CSS：

```
table#System_table select.fixedwidth { width: 10em; }
table#System_table select.fixedwidth.clicked { width: auto; } 
```

和这段代码

```
<!--[if lt IE 9]>
    <script type="text/javascript">
        jQuery(document).ready(function() {
            jQuery(document).on(
              {
                'mouseenter': function(event) {
                    jQuery(this).addClass('clicked');
                    },
                'focusout change blur': function() {
                    jQuery(this).removeClass('clicked');
                    }
              }, 'select.fixedwidth');
        });
    </script>
<![endif]--> 
```

有几点需要注意：

*   尽管我的选择都在一个表中，但我不得不“打开”`jQuery(document).on`而不是`jQuery('table#System_table').on`
*   尽管 jQuery 文档说使用“ `mouseleave`”而不是“ `blur`”，但我发现在 IE7 中，当我将鼠标向下移动到下拉列表时，它会得到一个`mouseleave`事件而不是`blur`.

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2015-01-10T04:14:10.480

对于我的布局，我不想要一个 hack（不增加宽度，不点击自动然后进入原始状态）。它打破了我现有的布局。我只是希望它像其他浏览器一样正常工作。

我发现这完全一样：-

[http://www.jquerybyexample.net/2012/05/fix-for-ie-select-dropdown-with-fixed.html](http://www.jquerybyexample.net/2012/05/fix-for-ie-select-dropdown-with-fixed.html)

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2015-06-26T02:54:34.137

如果您在选择选项后不关心奇怪的视图（即选择跳转到新页面），则一种解决方法：

```
<!-- Limit width of the wrapping div instead of the select and use 'overflow: hidden' to hide the right part of it. -->
<div style='width: 145px; overflow: hidden; border-right: 1px solid #aaa;'>
  <select onchange='jump();'>
    <!-- '&#9660;(▼)' produces a fake dropdown indicator -->
    <option value=''>Jump to ... &#9660;</option>
    <option value='1'>http://stackoverflow.com/questions/682764/select-dropdown-with-fixed-width-cutting-off-content-in-ie</option>
    ...
  </select>
</div> 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2015-08-07T08:05:31.950

一个纯 CSS 解决方案： http: [//bavotasan.com/2011/style-select-box-using-only-css/](http://bavotasan.com/2011/style-select-box-using-only-css/)

```
.styled-select select {
   background: transparent;
   width: 268px;
   padding: 5px;
   font-size: 16px;
   line-height: 1;
   border: 0;
   border-radius: 0;
   height: 34px;
   -webkit-appearance: none;
   }

.styled-select {
   width: 240px;
   height: 34px;
   overflow: hidden;
   background: url(http://cdn.bavotasan.com/wp-content/uploads/2011/05/down_arrow_select.jpg) no-repeat right #ddd;
   border: 1px solid #ccc;
   }
```

```
<div class="styled-select">
   <select>
      <option>Here is the first option</option>
      <option>The second option</option>
   </select>
</div>
```

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2013-06-12T12:26:50.613

最佳解决方案：css + javascript

[http://css-tricks.com/select-cuts-off-options-in-ie-fix/](http://css-tricks.com/select-cuts-off-options-in-ie-fix/)

```
var el;

$("select")
  .each(function() {
    el = $(this);
    el.data("origWidth", el.outerWidth()) // IE 8 can haz padding
  })
  .mouseenter(function(){
    $(this).css("width", "auto");
  })
  .bind("blur change", function(){
    el = $(this);
    el.css("width", el.data("origWidth"));
  }); 
```

# java - 旋转和缩放——如何兼顾两者并获得正确的结果？

> ID：682770
> 
> 赞同：3
> 
> 时间：2009-03-25T18:03:55.820
> 
> 标签：java, graphics, linear-algebra, java-2d, affinetransform

我有一组在图形上下文中绘制矢量的 Java2D 调用。我希望图像的大小翻倍，然后旋转 90 度。

我正在使用以下代码来执行此操作：

```
Graphics2D g2 = // ... get graphics 2d somehow ...
AffineTransform oldTransform = g2.getTransform();
AffineTransform newTransform = (AffineTransform)oldTransform.clone();
newTransform.concatenate(AffineTransform.getTranslateInstance(x1, x2));
newTransform.concatenate(AffineTransform.getScaleInstance((double)newW/(double)iconW, (double)newH/(double)iconH));
newTransform.concatenate(AffineTransform.getRotateInstance(Math.toRadians(rotationAngle), (double)iconW/2.0d, (double)iconH/2.0d));
// ... do my drawing ... 
```

这会旋转和缩放，但是，比例并没有按照我想要的方式应用。就好像它在缩放之前旋转，从而使图像在错误的轴上变宽。

有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T18:08:00.243

我相信这些转换是像堆栈一样实现的 - 所以最后一次转换是首先执行的。尝试颠倒旋转和缩放变换的顺序，你应该得到你想要的。

```
newTransform.concatenate(AffineTransform.getTranslateInstance(x1, x2));
newTransform.concatenate(AffineTransform.getRotateInstance(Math.toRadians(rotationAngle), (double)iconW/2.0d, (double)iconH/2.0d));
newTransform.concatenate(AffineTransform.getScaleInstance((double)newW/(double)iconW, (double)newH/(double)iconH)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T18:22:07.773

始终围绕原点进行旋转。为了[围绕某个点旋转，](http://www.euclideanspace.com/maths/geometry/affine/aroundPoint/index.htm)您必须平移这些点。

[此页面](http://www.euclideanspace.com/maths/geometry/transform/index.htm)解释了您尝试执行的操作背后的数学原理，并说明了为什么需要按特定顺序应用转换。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T18:07:00.790

更改连接变换的顺序以控制它们在合成中的应用顺序。

# c# - 如何为 .Net 应用程序选择 Oracle 提供商？

> ID：682773
> 
> 赞同：6
> 
> 时间：2009-03-25T18:04:11.170
> 
> 标签：c#, oracle, asp.net-2.0, provider

我试图找出将（现有）ASP.Net 应用程序连接到 Oracle 数据库以读取其字典信息的最佳方法。

可能性实在是太多了：

*   适用于 Oracle 的 MS 数据提供程序（需要 8.1.7，命名空间 System.Data.OracleClient）
*   .NET 的 Oracle 数据提供程序（需要 9.2，命名空间 Oracle.DataAccess）
*   用于 OLE DB 的 Oracle 提供程序
*   MSDASQL 和 ODBC

由于我当前的应用程序使用 MSSQL 服务器，因此进一步的选择是：

*   链接服务器，通过 server..user.object 访问
*   通过 OPENROWSET 链接服务器

关于 SO 的类似主题有几个问题，但只有一些已接受答案。

您对每位司机的体验如何？他们的优点和缺点是什么？

当然，Oracle 推荐的是 ODP.Net。9.2（或更高版本）的要求今天有问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-26T08:12:11.320

我也推荐 ODP.NET。选择最新的提供商 ( [http://www.oracle.com/technology/tech/windows/odpnet/index.html](http://www.oracle.com/technology/tech/windows/odpnet/index.html) )。它可以连接 Oracle 9.2 数据库或更新版本的数据库。

Oracle 的 MS 数据提供程序非常有限。例如，您不能使用数组和用户定义的类型。为什么微软会为连接到 Oracle 提供良好的支持？

您还可以查看 devart 的提供者：http: [//www.devart.com/dotconnect/oracle/](http://www.devart.com/dotconnect/oracle/)。它支持实体框架。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-25T18:08:20.490

转储 OLE DB 和 ODBC 选项，如果您有直接数据访问提供程序，则无需使用 OLE DB 或 ODBC。

我推荐用于 .NET 的 Oracle 数据提供程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T14:59:01.587

微软刚刚宣布将[弃用 System.Data.OracleClient](http://blogs.msdn.com/adonet/archive/2009/06/15/system-data-oracleclient-update.aspx)。

我认为这给你留下了几个选择（至少）：

*   ODP.NET（免费，来自 Oracle）
*   开发艺术
*   数据直通

DevArt 还有一个 LINQ to Oracle 实现，您可能会感兴趣。

# documentation - X 窗口系统指南

> ID：682776
> 
> 赞同：2
> 
> 时间：2009-03-25T18:04:32.683
> 
> 标签：documentation, x11, xorg

X 窗口系统（及其流行的实现 X.org）也令人惊叹且复杂 - 客户端服务器模型，将显示转发到其他系统，支持各种设备，原始绘图功能。而且，配置方式很多。

但是，没有明确的指南可以教它动手。你能建议任何吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-29T21:41:43.753

您可能想看看 XCB 以重新开始低级 Xorg 开发：http: [//xcb.freedesktop.org/](http://xcb.freedesktop.org/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T18:16:00.190

我会推荐 Linux 文档项目中的 HOWTO，特别是[The X Window User HOWTO](https://tldp.org/HOWTO/XWindow-User-HOWTO/)和[X Window System Architecture Overview HOWTO](https://tldp.org/HOWTO/XWindow-Overview-HOWTO/index.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T19:35:19.517

您可以尝试获取一份[X Window System: The Complete Reference](https://rads.stackoverflow.com/amzn/click/com/1555580882) by Robert W. Scheifler 和 James Gettys

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-13T06:55:33.490

X.Org去年在其网站上发布了[The X New Developer's Guide 。](http://www.x.org/wiki/guide/)这不是一个长而深入的指南，而是对体系结构的高级概述以及指向哪里可以找到更多关于图形堆栈特定部分的指针。

# xml - 如何在 Joomla 页面中嵌入 XLS？

> ID：682781
> 
> 赞同：0
> 
> 时间：2009-03-25T18:05:45.973
> 
> 标签：xml, excel, joomla

我需要知道如何在 Joomla 网站中嵌入 Excel 电子表格。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T18:08:54.717

完全取决于“嵌入”的含义，但您可以查看[PHPExcelReader](http://mattkruse.com/2008/12/24/php-excel-reader/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T20:48:17.947

将其导出到 googledocs，并将其与用于将 googledocs 嵌入到 joomla 文章中的插件一起嵌入。

# linux - linux：进程启动后重定向标准输出

> ID：682783
> 
> 赞同：1
> 
> 时间：2009-03-25T18:06:33.367
> 
> 标签：linux, bash, redirect, stdout

> **可能重复：**
> [一个进程如何拦截 Linux 上另一个进程的 stdout 和 stderr？](https://stackoverflow.com/questions/249703/how-can-a-process-intercept-stdout-and-stderr-of-another-process-on-linux)

我有一个已经开始的进程，标准输出到控制台。我可以将其重定向到文件而不重新启动它吗？

# asp.net - 使用 ASP .Net Membership 使用户登录持久化

> ID：682788
> 
> 赞同：18
> 
> 时间：2009-03-25T18:07:08.840
> 
> 标签：asp.net, asp.net-membership, asp.net-3.5, sqlmembershipprovider

我有一个使用 sql 成员资格提供程序在 ASP.NET 3.5 和 SQL Server 2005 中构建的网站，并且可能形成身份验证。

由于我网站上的安全需求非常低，我想验证一次，然后无限期地保持登录（不给用户选择）。

正在发生的事情是用户登录，在会话中保持登录状态，然后在他们下次到达时，他们被注销。

如何让登录持久化？

这是技术细节，我已经尝试了许多持续时间的变化。

```
 Try
            If Membership.ValidateUser(UserName.Text, Password.Text) Then
                Security.UserManager.AuthenticateUser(UserName.Text)

                If FormsAuthentication.GetRedirectUrl(UserName.Text, False) = "/default.aspx" Then
                    Try
                        'Custom Logic'
                    Catch Ex As Exception
                        'Custom Error handling'
                    End Try
                Else
                    FormsAuthentication.RedirectFromLoginPage(UserName.Text, True)
                End If
            End If
        Catch ex As Exception
            RaiseEvent ExceptionThrown(New ApplicationException("An error occurred trying to log the user in after account creation.", ex))
        End Try

Public Shared Sub AuthenticateUser(ByVal Username As String)
    Dim Expiration As DateTime = DateTime.Now.AddMonths(3)

    Dim authTicket As FormsAuthenticationTicket = New FormsAuthenticationTicket(Username, True, Expiration.Subtract(Expiration).TotalMinutes)
    Dim EncryptedTicket As String = FormsAuthentication.Encrypt(authTicket)
    Dim AuthCookie As New HttpCookie(FormsAuthentication.FormsCookieName, EncryptedTicket)
    AuthCookie.Expires = Expiration
    HttpContext.Current.Response.Cookies.Add(AuthCookie)
End Sub 
```

网络配置：

```
<membership defaultProvider="SqlProvider" userIsOnlineTimeWindow="15">
   <providers>
      <clear />
      <add
         name="SqlProvider"
         type="System.Web.Security.SqlMembershipProvider"
         connectionStringName="GlobalConnString"
         applicationName="/"
         enablePasswordRetrieval="false"
         enablePasswordReset="true"
         requiresQuestionAndAnswer="false"
         requiresUniqueEmail="true"
         passwordFormat="Hashed"
         minRequiredPasswordLength="5"
         minRequiredNonalphanumericCharacters="0"
      />
   </providers>
</membership>

<authentication mode="Forms">
    <forms timeout="1439200" name="SITENAME" loginUrl="/login.aspx" />
</authentication> 
```

编辑：这是客户端存储的 cookie 信息：

```
Name    ASP.NET_SessionId
Value   r4dz1555f1pdne45n1zrlkmg
Host    SITEADDRESS.com
Path    /
Secure  No
Expires At End Of Session

Name    .ASPXAUTH
Value   648767AC72A60DBA49650A361A2FA446BA992F792055EF5B488CADC95DF495315C1C577F1C8E67E67BD937A7AB6CC5DAED85D8D64E4ED7867FC0FC395F48FED7FB631033CE441DE85223E8B3EBAE616C
Host    www.SITEADDRESS.com
Path    /
Secure  No
Expires Tue, 09 Jun 2009 17:51:31 GMT

Name    ASP.NET_SessionId
Value   gn5pcymhfsnua455yp45wpej
Host    www.SITEADDRESS.com
Path    /
Secure  No
Expires At End Of Session

Name    SITENAME
Value   9610E8515F3DBC088DAC286E1F44311A20CB2BBB57C97F906F49BC878A6C6AC0B9011777402AEA130DCDC521EF4FBB3393DB310083F72EB502AE971183306C24F07F696B3695C67DD73166F1653DF52B
Host    www.SITEADDRESS.com
Path    /
Secure  No
Expires Tue, 20 Dec 2011 06:14:10 GMT 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-06-26T14:50:49.150

我终于弄清楚了最后一块拼图。当我的服务器的应用程序池被回收（由托管服务提供商配置）时，视图状态加密密钥正在自动重新生成。这意味着即使 cookie 有效且未过期（返回前访问），当用户返回时，加密已更改，cookie 不再有效。

解决方案是手动指定静态验证密钥。以下链接可用于为此生成必要的 web.config 标记。

[http://www.aspnetresources.com/tools/keycreator.aspx](http://www.aspnetresources.com/tools/keycreator.aspx)

**更新：**

这是一个更可配置的站点来生成机器密钥

[源树 - 生成属性](http://www.sourcetree.net/sourcetree/Development/Aspnet%20Examples/GenerateMachineKeyForWebConfig.aspx)

我意识到这可能会产生轻微的安全影响，我想从理论上讲，如果您的密钥被暴力破解并危及您可能存储在视图状态中的任何数据，那么更改密钥会更安全，但您可能不应该存储敏感信息视图状态中的信息，因为无论如何它本质上都不是安全的。

例子：

```
<configuration>
  <system.web>
    <machineKey
        validationKey="97CEB2D3DEBF853649EAB851F56F08BA328423F935C97244CF5300925B6FF7D2C43084C73CBAF19D5193755EF7F87A3FFC714675F9197C822BAEEC97E853B91E"
        decryptionKey="A72F69A4650348E3AA249A8179516D67C8553B3D4BD165B9"
        validation="SHA1" />
  </system.web>
</configuration> 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-03-26T10:23:37.697

我认为您最好使用该`FormsAuthentication.SetAuthCookie`方法而不是自己编写大量代码。

我相信您在 web.config 中的会员资格提供商设置可能与您在代码中提供的设置冲突，而且您没有提供 cookie 名称。

尝试以下操作：

```
if (Membership.ValidateUser(userName, password))
{
    FormsAuthentication.SetAuthCookie(userName, true); //Creates a cookie named "XXXAuth" - see settings in web.config below
} 
```

结合 web.config 中的以下设置：

```
<authentication mode="Forms">
    <forms cookieless="UseCookies" loginUrl="~/SignIn.aspx" name="XXXAuth" slidingExpiration="true" timeout="432000"/>
</authentication>

<membership defaultProvider="XXXMembershipProvider">
    <providers>
        <clear />
        <add name="XXXMembershipProvider" type="System.Web.Security.SqlMembershipProvider" applicationName="XXX" connectionStringName="XXX" enablePasswordRetrieval="false" enablePasswordReset="true" requiresQuestionAndAnswer="false" requiresUniqueEmail="true" minRequiredPasswordLength="5" minRequiredNonalphanumericCharacters="0" passwordFormat="Hashed" maxInvalidPasswordAttempts="5" passwordAttemptWindow="10" passwordStrengthRegularExpression=""/>
    </providers>
</membership> 
```

如果您真的想创建无限期的登录期，只需将身份验证块中的“超时”值更改为更长的值。我相信 432000 = 5 天。

如果您希望您的用户能够显式注销，只需调用以下方法来响应按钮单击（或其他）：

```
FormsAuthentication.SignOut(); 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T22:19:26.300

阅读您的代码时，您可能不小心将 FormsAuthenticationTicket 超时值设置为零。您创建票证的代码中的行内容为：-

```
Dim authTicket As FormsAuthenticationTicket = New FormsAuthenticationTicket(Username, True, Expiration.Subtract(Expiration).TotalMinutes) 
```

的值`Expiration.Subtract(Expiration).TotalMinutes`将始终为“0”。

您可能会更好地使用速记格式来创建票证，如下所示，这样可以减少歧义。

```
Public Shared Sub AuthenticateUser(ByVal Username As String)
    Dim Expiration As DateTime = DateTime.Now.AddMonths(3)
    Dim userData As String = String.Empty

    Dim authTicket As FormsAuthenticationTicket = _
       New FormsAuthenticationTicket( _
         Username, _
         DateTime.Now, _
         Expiration, _
         true, _
         userData, _
         FormsAuthentication.FormsCookiePath)
    Dim EncryptedTicket As String = FormsAuthentication.Encrypt(authTicket)
    Dim AuthCookie As New HttpCookie(FormsAuthentication.FormsCookieName, EncryptedTicket)
    AuthCookie.Expires = Expiration
    HttpContext.Current.Response.Cookies.Add(AuthCookie)
End Sub 
```

[这里](http://support.microsoft.com/kb/910443)还有一篇很好的 Microsoft KB 文章“*了解表单身份验证票证和 Cookie* ”

.

# java - 再次调用静态初始化器

> ID：682794
> 
> 赞同：7
> 
> 时间：2009-03-25T18:08:13.610
> 
> 标签：java, static, static-initializer

一旦加载了一个类，有没有办法再次调用静态初始化器？

```
public class Foo {

    static {
        System.out.println("bar");
    }

} 
```

编辑：

我需要调用静态初始化程序，因为我没有编写原始类，并且我需要调用的逻辑是在静态初始化程序中实现的。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-25T18:11:15.727

将初始化代码放在单独的公共静态方法中，以便您可以从静态初始化程序和其他地方调用它？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-25T18:22:32.640

逻辑将多次运行的一种情况是，如果类由不同的 ClassLoader 多次加载。请注意，在这种情况下，它们本质上是不同的类。

不过，一般来说，这些都是一次性交易。如果您希望能够多次调用逻辑，请按照其他人的建议进行操作并将其放入静态方法中。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-25T18:21:08.870

我同意 Earwicker 的回答。只需将静态初始化提取到单独的静态方法即可。

```
public class Foo {

    static {
        Foo.initialize();
    }

    public static void initialize() {
        System.out.println("bar");
    }

} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-10-03T15:23:42.113

如果您真的想要确切问题的确切答案，答案是否定的。无法通过反射调用静态初始化程序或 instanceInitializer。

文档清楚地说：

对于`getDeclaredMethod(String name)`：

> 如果名称是“<init>”或“<clinit>”，则会引发 NoSuchMethodException。

对于`getDeclaredMethods()`：

> 返回的数组中不包含类初始化方法。

所以不，即使通过反射也不可能调用它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-26T12:26:08.167

您可以尝试扩展包含静态代码的类，然后放入您自己的静态初始化程序。不太确定它是否有效，但是：

```
public class OldBadLibraryClass {
   static {
      System.out.println("oldBadLibrary static init");
   }
}

//next file

public class MyBetterClass extends OldBadLibraryClass {
   static {
      System.out.println("MyBetterClass init");
   }
}

public class Test {
   public static void main(String[] args) {
      new MyBetterClass();
   }
} 
```

看看上面的打印是否按您期望的顺序打印。在我的机器上，它工作。

虽然这完全是一个hack，而且非常脆弱。将旧类修改为具有可以覆盖的 init() 方法确实会好得多。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-11-19T16:15:51.017

这里[https://stackoverflow.com/a/19302726/2300018](https://stackoverflow.com/a/19302726/2300018)是我的帖子，我在其中重新加载了一个实用程序类以重新运行静态初始化程序以进行单元测试。

# .net - 在 .net 中使用 XML 文档类型定义

> ID：682795
> 
> 赞同：1
> 
> 时间：2009-03-25T18:08:16.233
> 
> 标签：.net, xml, visual-studio-2008, import, dtd

是否可以将 XML DTD 导入 Visual Studio 以生成代理类？

我有一个需要与之交互的第三方 .dll，它的设计类似于 XML 服务。.dll 的接口全部由 XML 输入驱动，并以 XML 形式返回输出。它的好处是所有输入和输出类型都定义良好。坏消息是他们使用 DTD（文档类型定义）。

我真的不想手动构建 XML，但我只知道如何使用 XSD 文件.Net

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T18:17:07.053

Visual Studio 可以处理将您的 DTD 转换为 XSD，此时您可以生成代理。

您应该能够将您的 DTD 加载到 XML 设计器中，选择“创建架构”，并让 Visual Studio 从中推断 XSD。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T18:14:38.353

将问题简化为您知道如何解决的问题。DTD 和 XSD 大致等效，并且[存在](http://lists.xml.org/archives/xml-dev/200209/msg00267.html)将 DTD 转换为 XSD 的转换器。您知道如何使用 XSD，因此您已将其简化为可解决的问题。

# python - 如何处理“输入行太长”错误消息？

> ID：682799
> 
> 赞同：10
> 
> 时间：2009-03-25T18:08:42.923
> 
> 标签：python, command-line, windows-console

我正在尝试使用 os.system() 来调用另一个接受输入和输出文件的程序。由于文件夹名称很长，我使用的命令约为 250 个字符。

当我尝试调用命令时，出现错误：`The input line is too long`.

我猜有一个`255 character limit`（它使用 C 系统调用构建，但我也找不到它的限制）。

我尝试更改目录`os.chdir()`以减少文件夹路径长度，但是当我尝试使用`os.system()`它`"..\folder\filename"`时显然无法处理相对路径名。有没有办法绕过这个限制或让它识别相对路径？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2010-08-27T10:29:48.790

即使使用 是一个好主意`subprocess.Popen()`，这也不能解决问题。

**您的问题不是 255 个字符的限制**，这在 DOS 时代是正确的，后来 Windows NT/2000 增加到 2048，Windows XP+ 又增加到 8192。

**真正的解决方案**是解决 Windows API 中一个非常古老的错误：[_popen() 和 _wpopen()](http://msdn.microsoft.com/en-us/library/96ayss4b.aspx)。

如果您曾经在命令行中使用引号，则必须在引号中添加整个命令，否则您将收到`The input line is too long`错误消息。

从 Windows XP 开始的所有 Microsoft 操作系统都有 8192 个字符的限制，现在对于任何体面的命令行使用来说已经足够了，但是他们忘记了解决这个错误。

要克服他们的错误**，只需将您的整个命令包含在双引号**中，如果您想了解更多真实的[MSDN 评论 _popen()](http://msdn.microsoft.com/en-us/library/96ayss4b.aspx)。

小心，因为这些工作：

```
prog
"prog"
""prog" param"
""prog" "param"" 
```

但这些不起作用：

```
""prog param"" 
```

如果您需要一个在需要时添加引号的函数，您可以从[http://github.com/ssbarnea/tendo/blob/master/tendo/tee.py获取一个](http://github.com/ssbarnea/tendo/blob/master/tendo/tee.py)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-25T18:15:37.307

您应该改用 subprocess 模块。有关如何重写 os.system 调用以使用子进程的信息，请参阅[这个小文档。](http://docs.python.org/library/subprocess.html#subprocess-replacements)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T18:38:58.123

您应该使用[子](http://docs.python.org/library/subprocess.html)进程而不是 os.system。

subprocess 的优点是能够为您更改目录：

```
import subprocess
my_cwd = r"..\folder\"
my_process = subprocess.Popen(["command name", "option 1", "option 2"], cwd=my_cwd)
my_process.wait() # wait for process to end
if my_process.returncode != 0:
    print "Something went wrong!" 
```

如果上面看起来有点冗长，那么 subprocess 模块也包含一些辅助函数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T18:11:08.567

假设您使用的是 Windows，从反斜杠开始，您可以从 python 中编写一个 .bat 文件，然后再`os.system()`继续。这是一个黑客。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T18:13:55.983

确保当您在字符串中使用 '\' 时，它们已被正确转义。

Python 使用 '\' 作为转义字符，因此字符串`"..\folder\filename"`计算结果为，`"..folderfilename"`因为转义的 f 仍然是 f。

您可能想使用

```
r"..\folder\filename" 
```

或者

```
"..\\folder\\filename" 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-12-07T15:52:02.937

我收到了同样的消息，但很奇怪，因为该命令不是那么长（130 个字符）而且它曾经可以工作，但有一天它就停止了工作。我刚刚关闭了命令窗口并打开了一个新窗口，它工作正常。我已经打开命令窗口很长时间了（可能几个月，它是一个远程虚拟机）。我猜是一些带有缓冲区或其他东西的Windows错误。

# .net - 如何在 WiX 中检测 .NET 3.5？

> ID：682805
> 
> 赞同：20
> 
> 时间：2009-03-25T18:10:12.513
> 
> 标签：.net, wix, version

我正在尝试检测使用 WiX 安装了哪个版本的 .NET。我试过了：

```
<Condition Message='This setup requires the .NET Framework 3.5 or higher.'>
  <![CDATA[MsiNetAssemblySupport >= "3.5.0.0"]]>
</Condition> 
```

但这不起作用，因为 MsiNetAssemblySupport 属性会检查`fusion.dll`.NET 3.0 或 3.5 中的 2.0 版本未更新的版本。

检查系统目录中是否存在 .NET 库是否可行？我将如何使用 WiX 做到这一点？或者有什么方法可以使用注册表来做到这一点？

（我意识到有一个 WiX 用户电子邮件列表，但这是应该的——我不喜欢 1980 年代的技术，我喜欢可以轻松搜索的东西。）

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-03-25T18:21:24.453

Visual Studio -> WiX 项目 -> 添加参考 -> WixNetFxExtension.dll 然后：

```
<PropertyRef Id="NETFRAMEWORK35" />
<Condition Message="This setup requires the .NET Framework 3.5 to be installed.">
  Installed OR NETFRAMEWORK35
</Condition> 
```

[完整详细信息](http://wix.sourceforge.net/manual-wix3/check_for_dotnet.htm)，包括扩展中可用的所有[.NET 版本属性。](http://wix.sourceforge.net/manual-wix3/wixnetfxextension.htm)还要考虑条件消息是否应该[本地化](http://wixtoolset.org/documentation/manual/v3/howtos/ui_and_localization/make_installer_localizable.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-06-28T09:13:15.300

答案似乎是否定的。您无法（以可靠的方式）检查是否安装了 .NET Framework 版本 X 或更高版本。您只能检查是否安装了特定的 .NET 版本。现在 .NET 4.0 发布了，即使已经安装了 .NET 4.0，您也必须安装 .NET 3.5，这很烦人。

我希望 WiX 开发人员能找到解决这个问题的方法。

# silverlight - Silverlight DataGrid 动态复选框列需要点击事件

> ID：682811
> 
> 赞同：0
> 
> 时间：2009-03-25T18:12:34.443
> 
> 标签：silverlight

我有一个绑定到 observablecollection 对象的数据网格。该集合可以是 Foo 的集合或 Bar 对象的集合。Foo 和 Bar 具有不同数量的属性，因此数据网格中的列数应该不同。

因此，我在我的数据网格中动态创建列：

```
 var cellEditTemplate = new StringBuilder();
        cellEditTemplate.Append("<DataTemplate xmlns='http://schemas.microsoft.com/winfx/2006/xaml/presentation' >");
        cellEditTemplate.Append(
            "<CheckBox VerticalAlignment=\"Center\" IsThreeState=\"False\" IsChecked=\"{Binding ");
        cellEditTemplate.Append(bindName);
        cellEditTemplate.Append(", Mode=TwoWay}\"/>");
        cellEditTemplate.Append("</DataTemplate> ");
        var dataTemplate = ((DataTemplate) XamlReader.Load(cellEditTemplate.ToString()));
        var column = new DataGridTemplateColumn
                         {
                             CellEditingTemplate = dataTemplate,
                             Header = title
                         };

        grdCheckList.Columns.Add(column); 
```

在创建所有模板并将它们添加到 DataGrid 之后，我将数据绑定到 DataGrid。正确的数据出现了。我的问题是当复选框被选中时我没有收到通知。

如果我添加

点击="CheckBox_Checked",

我收到以下错误：

> Sys.InvalidOperationException：ManagedRuntimeError 错误 #4004 在控件“sl_Main”中：System.Windows.Markup.XamlParseException：AG_E_PARSER_BAD_PROPERTY_VALUE [行：1 位置：110] 在 MS.Internal.XcpImports.MethodEx（IntPtr ptr，字符串名称，CValue [] cvData ) 在 MS.Internal.XcpImports.MethodEx(DependencyObject obj, String name) 在 MS.Internal.XcpImports.DataTemplate_LoadContent(DataTemplate 模板) 在 System.Windows.DataTemplate.LoadContent() 在 System.Windows.Controls.DataGrid.PopulateCellContent(Boolean forceTemplating, Boolean isCellEdited, DataGridColumn dataGridColumn, DataGridRow dataGridRow, DataGridCell dataGridCell) 在 System.Windows.Controls.DataGrid.AddNewCellPrivate(DataGridRow 行, DataGridColumn 列) 在 System.Windows.Controls.DataGrid.CompleteCellsCollection(DataGridRow dataGridRow) 在 System.Windows。控件.DataGrid。GenerateRow(Int32 rowIndex) 在 System.Windows.Controls.DataGrid.AddRows(Int32 rowIndex, Int32 rowCount) 在 System.Windows.Controls.DataGrid.RefreshRows(Boolean recycleRows) 在 System.Windows.Controls.DataGrid.RefreshRowsAndColumns() 在 System .Windows.Controls.DataGrid.MeasureOverride(Size availableSize) at System.Windows.FrameworkElement.MeasureOverride(IntPtr nativeTarget, Single inWidth, Single inHeight, Single& outWidth, Single& outHeight)Single&outWidth, Single&outHeight)Single&outWidth, Single&outHeight)

有任何想法吗？

谢谢，

瑞克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T19:09:23.200

您不能使用已设置的事件处理程序动态加载 XAML。

在这种情况下，我不会动态添加模板。相反，我会在用户控件的资源中创建两个数据模板，并让它们关闭绑定到网格的数据类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-20T21:40:51.320

您可以在代码中 subcass 复选框并通过覆盖 click 方法添加事件处理程序。在您的 xaml 模板中，使用您的子类复选框而不是标准 CheckBox 类。

# database - 有效地设计一个简单的邮件客户端

> ID：682812
> 
> 赞同：1
> 
> 时间：2009-03-25T18:12:50.387
> 
> 标签：database, architecture, data-structures, storage, email-client

`**Requirement :** JAVA desktop mail client which could connect to existing gmail,y! mail a/c & will allow receive/send mails, support offline view of mails, plus with more features as & when it comes. i am using Java Mail Api's`

`**Underlying Mail Storage:** I have decided to use **HSQLDB** with **Hibernate**. Email content can have attachments , HTML , so i decided to use LONGVARBINARY type to store the email Body & attachments.`

> `Please let me know whether this approach is good & will it give me good performance when it comes to retrieval. Also give me some pointers on how to store java email objects in HSQLDB into LONGVARBINARY type & how to dereference it to get the actual data. **??**`

`~~2)I am confused over this because , with Approach 1 , i will end up storing all mail contents somehow on my local disk to enable offline viewing. And imagine if i have 1GB of mails >~~`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T18:18:39.857

如果您使用基于文件的方法（这并不排除您使用数据库），您可以在不使用时压缩和解压缩用于持久性的文件。由于您将存储简单的文本，因此压缩可能会很大，如果您在明智地选择时间进行压缩，速度下降也不会那么糟糕。地狱，你甚至可以让它成为一个选择。

这里要考虑的最重要的事情（对我来说）是搜索时间。您希望用户能够搜索什么？如果搜索很重要，我可能会使用数据库。我最初解决这个问题的方法是将主题和标题信息（日期、发件人、收件人等）存储在单独的列中，然后将整个电子邮件对象序列化为二进制数据列（可能是压缩的）。这会使全文搜索花费更长的时间，但无论如何这是意料之中的，对吧？

# .net - 将 LDAP 数据映射到 .NET 类 (LINQ)

> ID：682814
> 
> 赞同：0
> 
> 时间：2009-03-25T18:13:41.447
> 
> 标签：.net, linq, ldap, linq-to-ldap

我一直在使用几种不同的 tuts 来构建 LINQ-to-LDAP 模型。我刚刚完成它，但我在尝试将返回的数据绑定到类时遇到了一些问题。

我通过将自定义属性分配给作为数据库字段的实际名称的类的属性来执行相反的部分。

这是该类以及自定义属性的示例（不包括`DirectorySchemaAttribute`和`DirectoryRootAttribute`实现......这些部分工作正常）：

```
[DirectorySchema("C4User"), DirectoryRoot("o=c4, ou=users")]
class User
{
    [DirectoryAttribute("cn")]
    public string Username { get; set; }

    [DirectoryAttribute("userpassword")]
    public string Password { get; set; }

    [DirectoryAttribute("C4-Parent")]
    public string Parent { get; set; }
}

/// <summary>
/// Specifies the underlying attribute to query for in the directory.
/// </summary>
[AttributeUsage(AttributeTargets.Property, AllowMultiple = false)]
public class DirectoryAttributeAttribute : Attribute
{
    private string attribute;
    private DirectoryAttributeType type;

    /// <summary>
    /// Creates a new attribute binding attribute for a entity class field or property.
    /// </summary>
    /// <param name="attribute">Name of the attribute to query for.</param>
    public DirectoryAttributeAttribute(string attribute)
    {
        this.attribute = attribute;
        this.type = DirectoryAttributeType.Ldap;
    }

    /// <summary>
    /// Creates a new attribute binding attribute for a entity class field or property.
    /// </summary>
    /// <param name="attribute">Name of the attribute to query for.</param>
    /// <param name="type">Type of the underlying query source to get the attribute from.</param>
    public DirectoryAttributeAttribute(string attribute, DirectoryAttributeType type)
    {
        this.attribute = attribute;
        this.type = type;
    }

    /// <summary>
    /// Name of the attribute to query for.
    /// </summary>
    public string Attribute
    {
        get { return attribute; }
        set { attribute = value; }
    }

    /// <summary>
    /// Type of the underlying query source to get the attribute from.
    /// </summary>
    public DirectoryAttributeType Type
    {
        get { return type; }
        set { type = value; }
    }
} 
```

因此，我正在使用属性的 DirectoryAttributeAttribute::Name 值填充我的 LDAP 搜索的属性。如果没有指定，那么我只使用属性的类型名称。所以本质上，User.Username 映射到“cn”等等。

我想知道最好的方法是做相反的事情。因此，如果我得到一个包含名为“cn”的字段的 LDAP 结果，我如何找到具有等于“cn”的 DirectoryAttributeAttribute.Name 的属性。我正在开发一个获取每个属性的自定义属性的 foreach，但是我必须为结果集中的每个字段运行该 foreach :( 有点麻烦。有人能想到更好的方法吗？

这是确定属性映射到的字段名称的函数的代码：

```
private string GetFieldName(System.Reflection.MemberInfo member)
{
    DirectoryAttributeAttribute[] da = member.GetCustomAttributes(typeof(DirectoryAttributeAttribute), false) as DirectoryAttributeAttribute[];
    if (da != null && da.Length != 0)
    {
        if (da[0].Type == DirectoryAttributeType.ActiveDs)
            throw new InvalidOperationException("Can't execute query filters for IADs* properties.");
        else
            return da[0].Attribute;
    }
    else
        return member.Name;
} 
```

谢谢，克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T19:33:19.257

你知道“LINQ to Active Directory”吗？[在Codeplex](http://www.codeplex.com/LINQtoAD)上查看。

这可能是一个很好的起点。

马克

# javascript - jquery.autocomplete.js 触发单选和取消触发

> ID：682817
> 
> 赞同：1
> 
> 时间：2009-03-25T18:14:15.593
> 
> 标签：javascript, jquery, autocomplete

我正在尝试设置一个搜索页面，该页面使用两个单选按钮执行两种不同的搜索，用户可以切换这些单选按钮以指示他们正在搜索的内容。

第二种搜索类型我决定使用 jquery 自动完成脚本，因为有一组相对较小的可搜索项（~213），这将产生一种有吸引力且一致的方式来访问数据。

为此，我想设置脚本，但仅在用户选择第二个单选按钮时触发它，我已经通过将一部分绑定到点击来实现（尽管有问题），例如：

```
 $(document).ready(function() {
                    $( "#selector" ).click(
                    function( objEvent ){
                        $("#name").autocompleteArray(
                        [
                            "Alternative/Punk","Blues","Classical","Country/Folk","Electronic","Hip-Hop/R&B","International","Jazz","etc"
                        ],
                        {
                            delay:10,
                            minChars:1,
                            matchSubset:1,
                            onItemSelect:selectItem,
                            onFindValue:findValue,
                            autoFill:true,
                            maxItemsToShow:10
                        }
                    );
                    }
                );
                    $( "#unselector" ).click(
                    function( objEvent ){
                        //Do something
                    }
                );
                }); 
```

所以在笑得太厉害之前，它确实做了我想要的（我对 js 很感兴趣，最近才开始学习 PHP）。问题是我想设置第二个选择器（#unselector）停止/禁用/隐藏/取消绑定/如果用户在切换第二个单选按钮后切换第一个单选按钮（改变主意，只需点击周围） ， ETC）。

显然，一旦选择了第二个收音机，它现在的工作方式就会设置自动完成脚本，并且无论最终选择哪个按钮，在搜索框中键入的任何内容都将显示建议。

您可以在此处查看正在运行的脚本：

[www.lfmseek.com/rss/](http://www.lfmseek.com/rss/)

它只是一个为音乐用户生成 rss 链接的小应用程序（我自己是用户）。

脚本本身可以在此处的作者页面上找到（尽管所有内容都像往常一样嵌入在上面的页面中）：

[www.pengoworks.com/workshop/jquery/autocomplete.htm](http://www.pengoworks.com/workshop/jquery/autocomplete.htm)

任何帮助将不胜感激。我有一种独特的感觉，这应该很简单，但是我与通常与 javascript 相关的任何事物的关系往往是……除了。:-)

非常感谢您抽出宝贵的时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T18:31:32.230

您可以简单地从“名称”中取消绑定所有事件。

```
$( "#unselector" ).click(function( objEvent ){
   $("#name").unbind();
}); 
```

# regex - Unix - 替换

> ID：682820
> 
> 赞同：1
> 
> 时间：2009-03-25T18:14:38.713
> 
> 标签：regex, unix

我有替代问题。我有一个文件，其中包含 1 行随机字符，括号“{}”围绕 1 个字符。我想在前一个字符或下一个字符上移动这些括号。（如果字符行仍然不变，我知道该怎么做。）但是我想知道当我不知道这些字符并且我不知道这些括号在哪里时该怎么做。

例如：“ABC123{X}CBA321”==>“ABC12{3}XCBA321”或“ABC123X{C}BA321”

我想使用 awk 或 sed，一些正则表达式，也许......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T18:18:35.163

向后移动一个字符：

```
sed -e 's/\(.\){\(.\)}/{\1}\2/g' file 
```

向前移动一个字符：

```
sed -e 's/{\(.\)}\(.\)/\1{\2}/g' file 
```

要就地修改文件，请使用以下`-i`标志：

```
sed -i -e 's/\(.\){\(.\)}/{\1}\2/g' file
sed -i -e 's/{\(.\)}\(.\)/\1{\2}/g' file 
```

第一个示例通过匹配后跟由 . 包围的字符的任何字符来工作`{}`。没有分组，这是：`.{.}` 我们添加分组，以便我们可以将两个字符放在输出中。而不是用 with 包围第二个字符来`{}`包围第一个字符。这是`{\1}\2`.

第二个示例的工作方式类似，但`{.}.`首先匹配然后输出`\1{\2}`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T18:18:39.000

这会将括号移动到前一个字符：

```
sed -e 's/\(.\){\(.\)}/{\1}\2/g' < in_file > out_file 
```

这会将括号移动到下一个字符：

```
sed -e 's/{\(.\)}\(.\)/\1{\2}/g' < in_file > out_file 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T18:21:58.663

这是一个小例子。

```
$ echo "ABC123{X}CBA321" | sed -e 's/\(.\){\(.\)}\(.\)/{\1}\2\3/'
ABC12{3}XCBA321
$ echo "ABC123{X}CBA321" | sed -e 's/\(.\){\(.\)}\(.\)/\1\2{\3}/'
ABC123X{C}BA321 
```

以下是使用 sed 就地编辑文件的方法。

```
$ sed -i -e 's/\(.\){\(.\)}\(.\)/{\1}\2\3/' file
$ sed -i -e 's/\(.\){\(.\)}\(.\)/\1\2{\3}/' file 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T18:38:28.220

我在perl中试过。这会将括号移动到前一个字符

```
my $a="ABC123{X}CBA321";

if ($a =~ /(.)\{(.)\}/)
        {
                print "$`"."{$1}";
                print "$2";
                print "$'";
        } 
```

注意：$` 是匹配前的字符串 & $' 是匹配后的字符串

# vb.net - VB.net现场频率检测

> ID：682821
> 
> 赞同：0
> 
> 时间：2009-03-25T18:14:47.527
> 
> 标签：vb.net, audio, frequency

我希望能够在 VB.net 中进行生命频率检测。我必须说我真的不知道从哪里开始。我研究了 BASS.net，但这似乎只适用于预先录制的音频。我需要能够近乎实时地检测通过线路输入或麦克风输入的音频频率。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T18:23:54.837

也许[NAudio](http://www.codeplex.com/naudio)是一个开源的 .NET 音频和 MIDI 库，可以提供帮助。我还会查看[这篇 CodeProject 文章](http://www.codeproject.com/KB/audio-video/PeakMeterCS.aspx)以获取灵感。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T13:57:19.900

我有使用 BASS/C++ 进行实时频率检测的经验。它在 C++ 中基本上是这样的。我认为您可以轻松找到 .NET 等价物：

**初始化：**

```
 // initialize BASS recording (default device)
    if (!BASS_RecordInit(-1)) {
            LOG("Can't initialize device")
                    exit(-1);
    }

    // start recording (44100hz mono 16-bit)
    if (!(m_recChan = BASS_RecordStart(44100, 1, 0, &DuffRecording, 0))) {
            LOG("Can't start recording") 
```

然后将计时器设置为每 50 毫秒检索一次频率数据。这是使用的代码。

```
 float fft[4096];
                    BASS_ChannelGetData(m_recChan, fft, BASS_DATA_FFT8192); // get the FFT data 
```

希望这可以帮助。

# python - 在python中重定向函数定义

> ID：682822
> 
> 赞同：2
> 
> 时间：2009-03-25T18:14:49.680
> 
> 标签：python, class-attributes

这是一个非常人为的示例，因为要解释我最终实施此解决方案的背景并不容易。但是，如果有人能回答为什么会发生这种特殊情况，我将不胜感激。

这个例子：

```
class A(dict):  
    def __init__(self):
        self['a'] = 'success'

    def __getitem__(self, name):
        print 'getitem'
        return dict.__getitem__(name)

class B(object):
    def __init__(self):
        self._a = A()
        setattr(self, '__getitem__', self._a.__getitem__) 

b = B()
c = b['a'] 
```

这输出：

```
c = b['a']
TypeError: 'B' object is unsubscriptable 
```

即使这是一种奇怪的方式（显然子类化会更合乎逻辑），为什么它找不到我明确设置的方法？

如果我这样做：

```
dir(b) 
```

我明白了：

```
['__class__', '__delattr__', '__dict__', '__doc__', '__getattribute__', '__getitem__', '__hash__', '__init__', '__module__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__str__', '__weakref__', '_a'] 
```

其他方法也会出现同样的问题，例如`__iter__`. 明确定义这种有效的方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-25T18:29:16.493

当您使用方括号时，*`[]`*python 会在类中查找。您必须在类中设置方法。

这是您改编的代码：

```
class A(dict):  
    def __init__(self):
        self['a'] = 'success'

    def __getitem__(self, name):
        print 'getitem!'
        return dict.__getitem__(self, name)

class B(object):
    def __init__(self):
        self._a = A()
        B.__getitem__ = self._a.__getitem__

b = B()
c = b['a'] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T18:19:25.877

这是因为您不能即时覆盖特殊的类方法。

我无法找到有关此的参考，但基本上是因为它们是类方法并且不允许是实例方法。

# ms-access - 选择选项组中的项目后如何使 TextBox 可见

> ID：682826
> 
> 赞同：0
> 
> 时间：2009-03-25T18:16:04.123
> 
> 标签：ms-access, textbox, vba

这应该很容易，但由于某种原因它不起作用。我有一个名为 MainForm 的表单，我想要选择的选项组中的选择称为 PickMe。

我有一个名为 TxtHere 的文本框，我将其设置为不可见。

我写了这个：

```
Private Sub PickMe_Click()  
Me!TxtHere.Visible = True 
End Sub 
```

因此，当我选择 PickMe 时，它​​应该将文本框设置为可见，但这不起作用。有任何想法吗？问这么简单的问题我觉得很愚蠢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T18:27:42.473

我想到了。

使用选项组使用：

```
_MouseDown and Me.xxx.Visible = True 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T03:47:13.853

呃，有了选项组，你应该使用选项组的AfterUpdate()事件，然后使用SELECT CASE来测试选项组返回的值。

# c# - 我是否需要一个抽象类或接口（或两者都不需要）？

> ID：682827
> 
> 赞同：2
> 
> 时间：2009-03-25T18:16:34.933
> 
> 标签：c#, oop, interface, abstract-class

我有一个仓库。有时我想通过名称查找框位置，有时通过描述，有时通过 UPC，也许还有其他东西等。这些查找方法中的每一个都调用相同的各种私有方法来查找信息以帮助定位数据。

例如，upc 调用一个私有方法来查找 rowid，name 也是如此，X 也是如此。所以我需要为所有这些方法提供该方法。我可能会以某种方式使用该 rowid 来查找货架位置（这只是一个示例。）

但我的问题是我是否应该有一个抽象类（或其他东西），因为我正在以不同的方式查找我的盒子。

换句话说，假设我的查找代码对于 UPC 和位置非常相似。每个方法都可以使用 (select * from xxxx where location =，或 select * from xxxx where upc =) 调用。我可以在同一个类中创建两个不同的方法

```
LocateByUPC(string upc)...
LocateByLocation(string location)...
LocateByDescription(string description) 
```

...再次，这将是一个大类

有什么理由我想要一个可以举行的超级课程

```
abstract class MySuper
{

properties...

LocateBox(string mycriteria)...

} 
```

然后继承它并创建第二个类来覆盖我需要的任何版本的 LocateBox 方法？

我不知道为什么我想这样做，除了看起来 OOD，这真的意味着如果我有充分的理由我想这样做。但是，我知道没有优势。我只是发现我的类变得越来越大，我只是稍微改变了方法的名称和一些代码，这让我觉得继承可能会更好。

如果这很重要，请使用 C#。

编辑 - 如果我只给某人一个没有源但类定义的 .dll，我会这样做吗？类定义。会告诉我的属性等以及要覆盖的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T18:33:15.080

# 两者都不

使用抽象类和接口都不会简化协议，也就是说，你最终还是会得到一堆 LocateXXX 方法

我建议使用通用的 Locate(string criteria) 方法作为基础，并且只为你知道你会经常使用的方法定义专门的方法签名；如果您需要，泛型可以成为未来扩展的全部内容（并且依赖泛型可以简化编码和测试）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T18:27:51.957

听起来您可能想要实现称为模板方法的设计模式。基本上，您会将基类中的查找算法的大纲定义为最终方法，并将公共代码放在这些方法中。对于根据类型需要不同行为的方法，只需让基类的最终方法调用子类中的受保护方法，并让每个子类实现该行为。

你可以在网上看一些资源，只需在 google 上搜索 Template Method 设计模式。希望它能对您的问题有所启发。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T18:20:46.187

当您有多个实现时，抽象会有所帮助。并且为了面向未来（希望会出现更新的实现）。接口充当客户端和实现者之间的契约。这是一个不变量。实现可以自由地添加他们希望的任意数量的方法。你有这样的需求吗？

这有助于回答你的问题吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T18:21:57.883

你提出的是（基本上）[策略模式](http://en.wikipedia.org/wiki/Strategy_pattern)。我不喜欢链接到维基百科，但至少它是一个很好的起点。看看利弊，看看它是否对你有益。

我不认为你真的需要这样做。您可以简单地将 LocateBox 方法设为公开，并让它根据您想要执行的搜索调用私有助手。仅仅为了使用一些 OO 设计原则而过度复杂化你的类结构通常是一个坏主意。等到你发现*需要*它们，然后适当地重构。这将有助于指出什么是真正必要的，什么是浪费你的时间。

**编辑**：我正在考虑的另一种方法是创建一个数据类，该类具有基于您可以搜索的各种事物的属性。IE。具有 UPC 等属性的 BoxSearchData 类，然后将其传递给 LocateBox() 并根据为空的属性构建查询。这将帮助您稍后根据多个条件构建搜索。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T18:28:06.747

在我看来，这似乎没有必要。只需拥有一个具有不同搜索功能的存储库。然后只需在需要时使用您需要的功能。

但是，只有当您拥有将不同类型的搜索排队的工具时，界面部分才会变得有用。然后你可以有一个工厂来创建不同类型的搜索类，这些类都实现了一个接口。此时，您可以枚举排队的搜索类，强制转换为接口，并执行虚拟函数并指向正确的搜索类型。例子：`ReturnDataObject GetItem(object param);`

附带说明一下，在提取数据时，接口还有其他用途。这只是我想到的第一个例子。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T18:47:22.707

在此示例中仔细观察时，您会看到只有用于查找的属性发生了变化。当以 OO 方式表示这一点时，您最终会得到一个我称之为“查找”的类（表示搜索，可能是 SQL，也可能是另一种查询语言：一个可以基于某些属性返回 rowId 并搜索到的对象该财产的价值。

真正的行为变化将在查询语言中。所以如果你要创建一个抽象类或接口，它应该服务于那个目的。可以通过在查询调用中添加“属性”参数来区分属性和值变化的问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-13T09:49:55.040

当您需要大量功能在子类中相同时，抽象类很有用，例如在具有多种可用支付方式的购物车中，您可以有一个定义通用支付方式的抽象类，并让子类继承来自您想要支持的每种实际支付方式（贝宝、信用卡、帐户等）的超类。每个子类的付款授权机制会有所不同，但它们都执行基本相同的功能 - 它们验证用户可以证明他们可以为相关商品或服务付款。

接口有用的一个例子是你有不相关的项目需要以统一的方式提供一些类似的功能。例如，您可能有一个 CMS，其中文章存储在数据库中，但系统将它们缓存到光盘和 HTML 页面，直到数据库中的文章被修改，此时物理文件被删除，直到下一次有人访问数据库中的副本。您的 CMS 可能还支持用户上传图像、PDF 等以存储在光盘上以供访问，但您绝对不希望删除这些文件，因为光盘上的副本代表文件本身，而不是缓存版本。在这种情况下，您可以创建一个 Cacheable 接口，说明缓存到磁盘的类需要实现哪些方法，同时将其留给类本身来实现它们。这更有意义，因为代表不同类型数据的类几乎肯定需要以不同方式实现它们的缓存方案（如果有的话）。

每个允许缓存的类都将被定义为实现 Cacheable 的类，然后您可以在代码中检查这一点。经验不足的编码人员可能会通过获取类并使用大的 switch 语句处理结果来测试他们正在使用的对象的类。这不是正确的方法，因为这意味着您假设某些类对象实现了某些功能，如果您向系统添加一个新类，则需要修改软件中的每个 switch 语句以将其考虑在内。如果你实现了一个接口，你可以测试一个对象是否使用 instanceof 关键字实现了该接口。

```
if ($thisObject instanceof Cacheable)
{
// Manage item's cache
} 
```

这种方法更好，因为它消除了 switch 语句，从而使您的软件更易于维护。如果您向系统添加一个新类，该类也实现了自己的缓存方案，那么您只需要声明它实现了 Cacheable。由于接口要求所有的类都实现它来声明接口中指定的方法，因此您可以确定任何实现 Cacheable 的类都会提供某些方法供您使用。您的代码不需要知道类如何实现这些方法，只需知道它确实实现了它们。

恐怕这些概念解释起来比实际学习使用要复杂一些，希望我对基本概念的理解足以让您自己弄清楚。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-05T12:01:37.410

显然，这里的多态实体是约束。使用字符串是实现相同目的的快速而肮脏的方法，但是您的类型系统完全脱离了循环，垃圾字符串值对于输入的有效性将与有意义的约束规范一样有效。

所以，

```
LocateBy (Constraint constraint); 
```

和

```
abstract class Constraint {
   String toString ();
}

class LocationConstraint extends Constraint { /* ... */} 
```

等等

# asp.net-mvc - Mono 上的 ASP.NET MVC

> ID：682830
> 
> 赞同：4
> 
> 时间：2009-03-25T18:17:56.520
> 
> 标签：asp.net-mvc, mono

为了在单声道上运行 asp.net mvc 1.0 Web 应用程序，我应该执行哪些步骤？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-13T16:01:09.893

它需要与 3.0 相同的步骤。
减

```
System.Web.Razor.dll 
System.Web.WebPages.Razor.dll 
```

但是，当 4.0 已经可以运行时，为什么还要运行 1.0 应用程序呢？

此处：
[Razor View Engine 是否适用于 Mono？](https://stackoverflow.com/questions/4239645/does-the-razor-view-engine-work-for-mono/6317712#6317712)

# forms - 如何摆脱不遵守表单删除的持久 VBA 表单对象？

> ID：682842
> 
> 赞同：1
> 
> 时间：2009-03-25T18:21:19.697
> 
> 标签：forms, object, ms-access, vba

我有一个 MS Access 2003 数据库，我用它来开发一个基本的小库存应用程序。在此过程中，我添加了一些无关的表格，我想将它们从数据库中取出。我删除了大部分都很好，但其中一个似乎已经留下了它的 VBA 对象。对象中的所有内容都是`Option Compare Database`. 现在，每当我尝试使用数据库时，都会收到以下错误：

```
The form name 'Transaction1' is misspelled or refers to a form that doesn't exist.

If the invalid form name is a macro, ... 
```

为了打字而截断。

是的，我同意，该表格不存在。让我非常困惑的是，当我删除它们时，所有其他表单也破坏了它们的 VBA 对象。这个，无论如何，似乎都喜欢留下来，我不知道如何摆脱它。

我该如何摆脱它？

我尝试过的事情：

*   Compact and Repair 和 DB
*   创建一个名为它所期望的新表单，验证它是否解决了问题，然后删除该表单。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T19:03:20.593

你可以试试 /decompile 开关

*   备份您的 mdb
*   通过快捷方式打开您的 mdb（按住 SHIFT 键以停止任何代码运行）：**msaccess.exe database.mdb /decompile**
*   打开一个模块并编译您的应用程序
*   保存并关闭访问
*   再次打开（再次SHIFT）而不反编译
*   压缩和修复数据库
*   关闭访问

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-01-13T23:21:32.907

我有类似的问题。我发现我已将 STARTUP 菜单中缺少的表单命名为启动 Access 时打开的默认表单。我打开了工具>启动并从启动的“显示/表单/页面”字段中删除了缺少的表单名称。我的问题解决了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-09T16:39:49.727

我遇到的问题是该表单被命名为 ~TMPCLP8151 并且无论我尝试什么都不会出现在 Access 中，但我可以在 Project Explorer 的 VBA 中看到它。这是我解决问题的方法。我创建了一个新表单，并为 Form_Open 创建了一个包含以下内容的事件过程： DoCmd.DeleteObject acForm, "~TMPCLP8151"

Then I just opened the form, and sure enough, the VB code deleted the form that I could not delete myself.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T18:47:36.497

我有同样的问题。我创建了一个具有相同名称的表单并再次删除了该表单。这解决了问题。尝试。顺便说一句，尝试在设计模式下打开新表单，以确保 VBA 模块是否与新表单相关联。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-06T08:02:25.010

我必须结合这两种解决方案来实现目标。首先反编译下一个压缩和修复然后创建具有相同名称的新表单并将其删除注意该表单的状态 Hasmodule 设置为 Yes

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-10-28T14:42:41.287

I had this problem. I renamed my default form from Form Login to frmLogin which suits my naming style, but the program was still looking for it on opening. I am using 2013 so I went to File » Options » CurrentDB and in the display dropdown select the new name. The old name remains in the list until you close and restart the application.

# java - Apache ant清单类路径？

> ID：682852
> 
> 赞同：9
> 
> 时间：2009-03-25T18:23:28.737
> 
> 标签：java, ant, manifest.mf

我有一个 java 项目的标准项目布局：

```
project /
    src /
        source_file_1.java
        ...
        source_file_N.java
    build /
          classes /
              source_file_X.class
              ...
          jar /
              MyJar.jar
    lib /
          SomeLibrary.jar
          SomeOtherLibrary.jar 
```

据我所知，我正在使用 Ant 正确构建项目。我需要在 Manifest 文件中设置类路径属性，以便我的类可以使用所需的库。

以下相关信息来自 build.xml

```
<target name="compile" depends="init">
    <javac srcdir="src" destdir="build\classes">
        <classpath id="classpath">
            <fileset dir="lib">
                <include name="**/*.jar" />
            </fileset>
        </classpath>
    </javac>
</target>

<target name="jar" depends="compile">
    <jar destfile="build\jar\MyJar.jar" basedir="build\classes" >
        <manifest>
            <attribute name="Built-By" value="${user.name}" />
        </manifest>
    </jar>
</target> 
```

任何朝着正确方向的推动都值得赞赏。谢谢

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-03-25T20:57:02.160

假设库不会从编译更改位置到执行 jar 文件，您可以在编译目标之外创建一个指向类路径的路径元素，如下所示：

```
<path id="compile.classpath">
    <fileset dir="lib" includes="**/*.jar"/>
</path> 
```

然后，您可以使用 javac 任务中创建的路径代替当前的类路径。

```
<classpath refid="compile.classpath"/> 
```

然后，您可以使用该路径来设置 manifestclasspath。

```
<target name="jar" depends="compile">
    <manifestclasspath property="jar.classpath" jarfile="build\jar\MyJar.jar">
      <classpath refid="compile.classpath"/>
    </manifestclasspath>    
    <jar destfile="build\jar\MyJar.jar" basedir="build\classes" >
        <manifest>
            <attribute name="Built-By" value="${user.name}" />
            <attribute name="Class-Path" value="${jar.classpath}"/>
        </manifest>
    </jar>
</target> 
```

manifestclasspath 生成一个格式正确的类路径，用于清单文件，必须在 72 个字符后换行。如果不使用 manifestclasspath 任务，包含许多 jar 文件或长路径的长类路径可能无法正常工作。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-25T18:52:56.030

查看我的 NetBeans 生成的构建文件，我在`-do-jar-with-libraries`任务中找到了这个片段：

```
<manifest>
    <attribute name="Main-Class" value="${main.class}"/>
    <attribute name="Class-Path" value="${jar.classpath}"/>
</manifest> 
```

所以换句话说，看起来你只需要向你已经拥有的清单任务添加另一个属性。

另请参阅[清单任务文档](http://ant.apache.org/manual/Tasks/manifest.html)。

# c# - 执行多个查询时如何保持连接打开？

> ID：682855
> 
> 赞同：7
> 
> 时间：2009-03-25T18:25:08.920
> 
> 标签：c#, .net, asp.net

我正在使用多个查询从我的应用程序中的同一服务器中提取数据。问题是我每次有新查询时都必须打开一个新连接。

是否有可能：

*   打开连接
*   运行查询
*   拉取结果
*   运行另一个查询
*   拉另一个结果
*   运行最终查询
*   拉另一个结果
*   关闭连接。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-25T18:28:47.400

虽然你可能还不知道，但你做对了。

打开连接，进行查询，然后关闭它。最好使用`using`块或`try`/ `finally`。

这听起来可能开销很大，但用于 SQL Server 的 .NET Framework 数据提供程序中的连接池实际上会为您优化。

事实上，建议关闭连接。这是文档中的引用：

> 建议您在使用完连接后始终关闭连接，以便将连接返回到池中。这可以使用 Connection 对象的 Close 或 Dispose 方法来完成。未明确关闭的连接可能不会添加或返回到池中。例如，一个超出范围但没有显式关闭的连接只有在达到最大池大小并且连接仍然有效时才会返回到连接池。

这是执行此操作的一些代码的示例：

```
try {
    conn.Open();
    // Perform query here
} finally {
    conn.Close();
} 
```

以供参考：

[http://msdn.microsoft.com/en-us/library/8xx3tyca(VS.71).aspx](http://msdn.microsoft.com/en-us/library/8xx3tyca(VS.71).aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T18:27:31.147

如果您使用具有相同连接字符串的 ASP.NET，您将使用可能永远不会物理关闭的池连接，因此您几乎总是使用可用的打开连接。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T18:31:59.327

这是很有可能的。假设您正在谈论 Connection 和 DataReader。如果您每次都必须创建不同的连接，那么听起来好像出了点问题。

没有看到任何代码，我猜您正在打开 DataReader。这是一个大错误。默认情况下，DataReaders 完全消耗连接并且不关闭它会导致泄漏。关闭 DataReader，然后执行另一个。我建议将 DataReader 包装在 using 块中。

抢

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T18:28:20.863

简短的回答：是的。大多数数据提供者应该可以做到这一点。

长答案：这取决于您用于数据访问的内容。但是，您可能不需要担心它。许多数据提供者框架都内置了连接池，因此后续的连接创建/打开不应“真正”打开连接。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T18:28:58.383

当然，如果您使用的是 SqlConnection 对象，您可以执行以下操作：

```
connection.Open();
cmd.ExecuteReader(); // or any other form of getting the data
cmd2.ExecuteReader();
.
.
.
.
connection.Close(); 
```

我还想补充一点，如果您使用一些 SqlDataAdapters 进行查询，尽管您通常不需要自己打开连接，但如果您明确调用 connection.Open() 它就不会关闭自动为您连接，允许您仅使用一个连接执行多个查询。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T18:39:16.797

如果您使用 C# 打开连接。使用 using 语句将帮助您清理资源/连接，即使有一些异常抛出。

```
 using (SqlConnection connection =
                new SqlConnection(connectionString)
            {
                connection.Open();
                //issue command
            } 
```

并阅读：

[http://msdn.microsoft.com/en-us/library/8xx3tyca(VS.71).aspx](http://msdn.microsoft.com/en-us/library/8xx3tyca(VS.71).aspx)，您可以“使用连接字符串关键字控制连接池”，系统将为您处理池。

# c++ - 限制特定计算机的功能

> ID：682859
> 
> 赞同：4
> 
> 时间：2009-03-25T18:26:21.587
> 
> 标签：c++, windows, drm, copy-protection

我有一个使用配置文件的程序。

我想将配置文件绑定到 PC，因此将文件复制到另一台具有相同配置的 PC 上将不起作用。

我知道 Windows Activation Mecanism 正在监视硬件以检测更改，并且它可以容忍对硬件的一些细微更改。

有没有图书馆可以帮助我做到这一点？

我的另一个选择是使用 WMI 来获取硬件配置并编写我自己的容忍机制。

非常感谢，

尼古拉斯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T18:47:37.137

[Microsoft 软件许可和保护服务](http://www.microsoft.com/slps/Default.aspx)具有将许可证绑定到硬件的功能。这可能值得研究。这是您可能也会感兴趣的[博客文章。](http://blogs.msdn.com/slps/archive/2008/02/07/activation-continued-machine-binding.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T18:31:03.307

如果您希望将数据的使用限制在特定的 PC 上，您必须自己实现此功能，或找到可以执行此操作的第三方解决方案。没有提供此功能的通用 Windows API。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T19:01:28.383

您需要定义您当前所称的“机器”。

如果我更换 CPU、内存和硬盘驱动器，它仍然是同一台计算机吗？网卡、显卡？

什么定义了机器？

有很多很多许可库可以为您执行此操作，但几乎所有许可库都是收费的（因为从表面上看，您只想以这种方式保护商业软件）。查看 RSA、Verisign 甚至 microsoft 必须提供的内容。Windows API 没有公开这一点，表面上是为了防止黑客攻击。

或者，自己做。这并不难，困难的部分是定义你认为的机器是什么。

如果您决定跟踪 5 个东西（HD、网卡、显卡、主板、记忆棒）并且在需要新许可证之前允许 3 次更改，那么用户可以复制硬盘驱动器，取出上述两个，放入一台新机器，用旧机器中的新部件替换它们，然后在两台单独的 PC 上运行您的程序。

所以它确实需要一些思考。

-亚当

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T19:30:19.280

如果机器有网卡，你可以随时检查它的mac地址。这应该是唯一的，并且将其作为程序启动例程的一部分进行检查应确保它一次只能在一台机器上运行……即使您卸下网卡并将其放在另一台机器上，它也只能在该机器上运行机器。不过，这将阻止网卡升级。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T19:34:03.110

也许你可以在注册表中保留一些东西？就像这个文件的最后修改时间戳一样——如果注册表中没有条目或者时间戳不匹配然后回退到默认值——那会起作用吗？（给猫剥皮的方法不止一种；））

# robots.txt - robots.txt：禁止机器人访问给定的“网址深度”

> ID：682863
> 
> 赞同：3
> 
> 时间：2009-03-25T18:27:37.667
> 
> 标签：robots.txt, noindex

我有这个结构的链接：

*   [http://www.example.com/tags/](http://www.example.com/tags/)**等等**
*   [http://www.example.com/tags/blubb](http://www.example.com/tags/) **_**
*   [http://www.example.com/tags/](http://www.example.com/tags/) **blah** / **blubb**（适用于与两个标签匹配的所有项目）

我希望 google & co 蜘蛛所有在 URL 中有一个标签的链接，但不是有两个或多个标签的 URL。

目前我使用html元标记[“robots”->“noindex，nofollow”](https://stackoverflow.com/questions/43971/dynamic-robots-txt)来解决这个问题。

是否有 robots.txt 解决方案（至少适用于某些搜索机器人）或者我是否需要继续使用“noindex，nofollow”并忍受额外的流量？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T18:37:20.547

我不认为你可以使用 robots.txt 来做到这一点。 [该标准](http://www.robotstxt.org/robotstxt.html)非常狭窄（没有通配符，必须在顶层等）。

根据服务器中的用户代理禁止它们怎么样？

# perl - 为什么我的 Perl 脚本会抱怨“全局符号“$connection”需要显式包名”？

> ID：682870
> 
> 赞同：3
> 
> 时间：2009-03-25T18:28:32.097
> 
> 标签：perl

```
my $now = &GetDate;
my $myHeader = &ReadMessage;
my $mySoftwareVersions = param('mySoftwareVersions');
my $q = new CGI;print $q->header();

use CGI::Carp(fatalsToBrowser);
getAllSoftwareVersions();

sub getAllSoftwareVersions
{
        my $user = "zxxx";
        my $passwd = "xxxx";
#       my $tableName = "config_table";
#       my $connection = DBI->connect("DBI:mysql:MESCI:hamysql02.stl.mo.boeing.com:18080", $user, $passwd, { AutoCommit => 0, RaiseError => 1}) or die "Couldn't connect to Database: " . DBI->errstr;
        print "Must be connected\n\n";
        print "\n\n";
# Error here.
        my @Rows = &getConfigTableRows($connection, $config_table, $mySoftwareVersions );
        my $total = @Rows;
        print "total is ";
        print $total; 
```

上面的代码死于：

```
全局符号“$connection”需要明确的包名
```

**编辑** 这个问题与：

*   [https://stackoverflow.com/questions/682695/how-do-i-resolve](https://stackoverflow.com/questions/682695/how-do-i-resolve)
*   [https://stackoverflow.com/questions/681557/xml-cannot-be-displayed-error-from-perl-cgi-script-using-mysql](https://stackoverflow.com/questions/681557/xml-cannot-be-displayed-error-from-perl-cgi-script-using-mysql)

希望原始海报能够将其清理干净，以便更有意义，但这是我们到目前为止所获得的，因此我们可以尝试提供帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T18:57:56.720

尽管肯特的回答是提前考虑，但错误只是告诉您您没有*声明* `$connection`为词法（“my”）变量。因此，perl 将其解释为您必须引用全局包。

当你使用一个未定义的变量时，Raw Perl 不会抱怨，它认为它是一个全局包。您似乎[`strict`](http://search.cpan.org/perldoc?strict)在某个地方（标准和推荐的做法）希望您在使用变量之前声明它们。如果您没有在当前包（或“命名空间”）中声明变量，则假定您指的是在另一个包中声明的变量，因此它会要求您附加包名称，以保持一切清晰明了.

Perl 用于[`my`](http://search.cpan.org/perldoc?perlfunc.pod#my)声明作用域变量，以及[`our`](http://search.cpan.org/perldoc?perlfunc.pod#our)声明包全局变量。

```
my $connection = "Rainbow"; 
```

或者

```
our $connection = 'French'; 
```

* * *

以防万一你有错误的想法，如果你关闭严格，错误消息会消失，你的问题不会。他们可能会进入地下。

```
{ no strict;
  my @rows = getConfigTableRows( $nothing, @other_stuff ); 
} 
```

Perl 不会*抱怨*这`$nothing`没什么。而这个易于修复的错误可能会在其他地方导致更细微的错误。另外想想如果你已经分配`$connection`成功，只需要输入：

```
{ no strict;
  my @rows = getConfigTableRows( $connecion, $config_table, $mySoftwareVersions );
} 
```

Perl 给你一个消息`'$connecion'`，希望你能知道这是一个错字，并且至少 30 分钟没有看到它，并想知道你的查询是否错误，或者其他什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T18:34:46.480

好吧，如果这是其他问题的相关内容，

这是错误的原因是因为您已注释掉创建连接变量的行。

当您没有定义数据库连接时，您将如何在数据库中查询表行？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T20:58:13.843

回覆：

```
my $now = &GetDate;
my $myHeader = &ReadMessage; 
```

如果要在函数调用中使用 &，请确保也使用括号：

```
my $now = &GetDate();
my $myHeader = &ReadMessage(); 
```

否则，当前正在执行的子程序的参数对您正在调用的子程序可用（并可更改）。

这意味着如果你在 mod_perl 下使用你的 cgi 脚本，突然间你实际上在做

```
my $now = &GetDate( Apache2::RequestUtil->request ); 
```

如果 GetDate 采用可选参数，这可能是非常错误的。

# sql - 半不同的 MySQL 查询

> ID：682874
> 
> 赞同：1
> 
> 时间：2009-03-25T18:29:07.943
> 
> 标签：sql, mysql

我有一个名为的 MySQL 表`items`，其中包含数千条记录。每条记录都有一个`user_id`字段和一个`created`（日期时间）字段。

尝试将查询组合到`SELECT`25 行，将用户 ID 字符串作为条件传递并按`created DESC`.

在某些情况下，可能只有几个用户 ID，而在其他情况下，可能有数百个。

如果结果集大于 25，我想通过消除重复`user_id`记录来减少它。例如，如果 有两条记录`user_id = 3`，则仅包含最近的（根据`created`日期时间）。

在尝试解决方案时，我遇到了麻烦，因为例如，虽然很容易获得 100 个结果集（允许重复`user_id`记录）或 16 个结果集（`GROUP BY`用于唯一`user_id`记录），但很难获得 25 个.

一种逻辑方法（可能不是正确的 MySQL 方法）是为 each 获取每个的最新记录`user_id`，然后，如果结果集小于 25，则开始为每个添加第二条记录，`user_id`直到 25 条记录限制为满足（可能需要每个人的第三、第四等记录`user_id`）。

这可以通过 MySQL 查询来完成，还是我需要获取一个大型结果集并使用代码将其修剪到 25？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T18:40:22.113

我认为您尝试完成的操作不可能作为 SQL 查询。无论正常的数据分组是什么，您都希望返回 25 行，而 SQL 通常对基于数据分组的返回很挑剔。

如果您想要一个纯粹基于 MySQL 的解决方案，您可以使用存储过程来完成此操作。（在 MySQL 5.0.x 和更高版本中受支持。）但是，运行查询以返回所有 100 多行然后在应用程序中以编程方式对其进行修剪可能更有意义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T18:41:29.833

这将为您提供每个用户的最新信息-

> SELECT user_id, create
> FROM items AS i1
> LEFT JOIN items AS i2
> ON i1.user_id = i2.user_id AND i1.create > i2.create
> WHERE i2.id IS NULL

他将为您提供每个用户最近的两条记录-

> 选择 user_id，创建
> FROM items AS i1
> LEFT JOIN items AS i2
> ON i1.user_id = i2.user_id AND i1.create > i2.create
> LEFT JOIN items IS i3 ON i2.user_id = i3.user_id AND i2.create > i3.create
> i3.id 为空

尝试从那里工作。

您可以很好地将其放入存储过程中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T18:42:21.423

我的意见是使用应用程序逻辑，因为这是您尝试在数据库级别实现的非常多的应用程序层逻辑，即过滤结果以使搜索对最终用户更有用。

你可以实现一个存储过程（我个人永远不会做这样的事情）或者只是让应用程序来决定哪 25 个结果。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T18:42:33.123

一种方法是获取每个用户的最新项目，然后是所有用户的最新项目，并对其进行限制。您可以构建可能不是您想要的病态示例，但总的来说应该很好。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T18:45:57.747

不幸的是，没有简单的方法:(当我为我的公司构建一个报告时，我不得不做类似的事情，该报告会提取记录在数据库中的客户禁用。唯一的问题是每 30 分钟运行一次并记录一次断开连接。因此，行不会是不同的，因为每次断开连接的时间戳都不同。我用子查询解决了这个问题。我没有确切的代码了，但我相信这就是我实现它的方式：

```
SELECT CORP, HOUSE, CUST, 
    (
        SELECT TOP 1 hsd
        FROM #TempTable t2
        WHERE t1.corp = t2.corp
        AND t1.house = t2.house
        AND t1.cust = t2.cust
    ) DisableDate
FROM #TempTable t1
GROUP BY corp, house, cust -- selecting distinct 
```

所以，我的答案是通过使用子查询从查询​​中消除非不同的列。不过，可能有更简单的方法来做到这一点。我很想看看其他人的帖子。

抱歉，我一直在编辑这个，我一直在努力寻找更容易展示我所做的事情的方法。

# process - 您或您公司的编程流程是什么？

> ID：682882
> 
> 赞同：21
> 
> 时间：2009-03-25T18:30:58.003
> 
> 标签：process, workflow

我正在寻找流程建议，我在网站上看到了一些建议。我很想听听你在公司里特别使用的东西，或者只是你和你的爱好项目。任何指向其他讨论这些主题的网站的链接当然是受欢迎的！

一些问题可以作为答案的基础：

1.  用户如何向您报告错误/功能请求？你用什么软件来跟踪他们？
2.  错误/功能请求如何变成“工作”？你计划工作吗？你有没有一个时间表？
3.  你有规格并遵循它们吗？它们有多详细？
4.  你有技术负责人吗？他们的作用是什么？他们自己做任何编程，还是只是架构/指导？
5.  你做单元测试吗？它对你有什么帮助？你会说你的报道是什么？
6.  你做代码审查吗？在紧迫的期限内工作时，代码可读性会受到影响吗？你打算稍后回去清理它吗？
7.  你记录吗？您或您的公司对多少评论感到满意？（类，每个方法和内部方法的描述？或者只是代码的棘手部分？）
8.  您的 SCM 流程是什么样的？你使用功能分支、标签吗？你的“主干”或“主人”是什么样的？它是发生新开发的地方，还是代码库中最稳定的部分？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-25T19:30:52.057

对于我的（小）公司：

*   我们首先设计 UI。这对我们的设计**至关重要**，因为复杂的 UI 几乎会立即疏远潜在买家。*我们在纸上*对我们的设计进行原型设计，然后当我们决定设计的细节时，准备视图和任何适当的控制器代码，以便对我们的设计进行持续的交互式原型设计。

*   随着我们朝着可接受的 UI 迈进，我们随后为应用程序的工作流逻辑编写了一份*纸质*规范。纸张很便宜，而且翻阅设计可以保证您至少花了少量时间来考虑实现，而不是盲目地编码。

*   我们的规范与我们的源代码一起保存在修订控制中。如果我们决定进行更改或想要进行试验，我们会分支代码，并立即更新规范以详细说明我们试图通过这个特定分支完成的工作。不需要对分支进行单元测试；但是，对于我们想要合并回主干的任何内容，它们都是必需的。我们发现这鼓励了实验。

*   规格不是神圣的，也不属于任何特定个人。通过将规范提交到源代码控制的民主环境，我们鼓励不断的实验和修订——只要它被记录在案，我们就不会说“WTF？” 之后。
    在最近的一款 iPhone 游戏（尚未发布）中，我们最终得到了近 500 个分支，这些分支后来转化为近 20 种不同的功能，大量的概念简化（进度条上的“点击取消”而不是单独的按钮） ，一些被拒绝的想法，以及 3 个新项目。最棒的是**每个想法**都被记录在案，因此很容易想象这个想法如何改变产品。

*   在每个主要构建之后（主干中的任何内容都得到更新，单元测试通过），我们尝试让至少 2 人测试该项目。大多数情况下，我们试图找到对计算机知之甚少的人，因为我们发现设计复杂性而不是简单性太容易了。

*   我们使用 DOxygen 来生成我们的文档。我们还没有真正将自动生成纳入我们的构建过程，但我们正在努力。

*   我们不进行代码审查。如果单元测试有效，并且源代码没有引起问题，那可能没问题——但这是因为我们能够依赖程序员的质量。这可能不适用于所有环境。

*   单元测试对我们的编程实践来说是天赐之物。由于没有适当的单元测试，任何新代码都无法传递到主干，因此我们的主干覆盖率相当高，分支覆盖率适中。但是，它不能替代用户测试——只是帮助实现这一点的工具。

*   对于错误跟踪，我们使用 bugzilla。我们不喜欢它，但它现在有效。我们可能很快就会推出我们自己的解决方案或迁移到 FogBugz。我们的目标是在达到 0 个已知错误状态之前不发布软件。由于这种立场，我们对现有代码包的更新通常相当少。

所以，基本上，我们的流程通常看起来像这样：

1.  Paper UI Spec + Planning »**心理测试**»*第 1 步*
2.  查看代码 + 单元测试 »**用户测试**»*步骤 1 或 2*
3.  Paper Controller & Model Spec + Planning »**心理测试**»*步骤 2 或 3*
4.  模型和控制器代码 + 单元测试 »**用户测试**»*步骤 3 或 4*
5.  分支想法 » 规范 » 编码（无单元测试） »**心理测试**»*拒绝*
6.  分支想法 » 规范 » 编码（无单元测试） »**心理测试**»*验收*» 单元测试 »**主干**»*步骤 2 或 4*
7.  已知错误 » 错误跟踪器 » 错误修复 »*步骤 2 或 4*
8.  成品 » 错误报告 »*第 2 步或第 4 步*

我们的流程无论如何都不是完美的，但完美的流程也意味着完美的人类和技术——这不会很快发生。我们在计划中的文件数量是惊人的——也许是时候让我们与 Dunder Mifflin 签订合同了？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-25T19:52:08.480

我不确定为什么这个问题被否决了。我认为这是一个很好的问题。谷歌搜索和阅读一些随机网站是一回事，这些网站很多时候试图向你推销一些东西，而不是客观的。向 SO 人群询问哪些是开发人员/IT 经理来分享他们的经验，以及什么对他们的团队有效或无效是另一回事。

现在这一点已经不存在了。我相信很多开发人员会将您指向“敏捷”和/或 Scrum，请记住，这些术语的使用通常非常松散，尤其是敏捷。如果说这不是我的意图，我可能会听起来很有争议，但是这些方法论被过度宣传了，尤其是 Scrum，它更像是 Scrum 顾问推销的一种产品，而不是“真正的”方法论。话虽如此，归根结底，您必须使用对您和您的团队最有效的方法，如果它是敏捷/Scrum/XP 或其他什么，那就去吧。同时，您需要对此保持灵活，不要对任何方法、工具或技术过于执着。如果某些东西对您不起作用，或者您可以通过更改某些东西来提高效率，那就去做吧。

更具体地了解您的问题。以下是对我有用的技术的基本总结（其中很多是常识）：

1.  组织与特定项目有关的所有文档和电子邮件，并通过一个中心位置使其他人可以访问（我使用 MS OneNote 2007 并喜欢它来存储我所有的文档、进度、功能和错误跟踪等）

2.  所有会议（您应该尽量减少）之后都应该有行动项目，其中每个项目都分配给特定的人。任何口头协议都应写入书面文件。添加到项目站点/存储库的所有文档。（在我的例子中是 MS OneNote）

3.  在开始任何新的开发之前，有一个系统将能够做什么（以及它不会做什么）的书面文件。承诺，但要灵活适应业务需求。文件应该有多详细？足够详细，以便每个人都了解最终系统的功能。

4.  时间表很好，但对自己和业务用户要现实和**诚实。**我使用的基本准则：发布**质量**和**可用**的软件，但缺少某些功能，而不是具有所有功能的错误软件。

5.  在您的开发人员之间建立开放的沟通渠道。团队之间以及您的开发人员和业务组之间，但在一天结束时，一个人（或几个关键人员）应该负责做出关键决策。

6.  有意义的单元测试。但不要对它过于执着。100% 的代码覆盖率！= 没有错误，软件按照规范正常工作。

7.  确实有代码标准和代码审查。遵守标准，但如果它在某些情况下不起作用，请考虑灵活性。

8.  注释你的代码特别难以阅读/理解的部分，但不要把它写成小说。

9.  如果您已经在处理该类/方法，请返回并清理您的代码；实现新功能，修复错误等。但不要仅仅为了重构而重构它，除非你无事可做并且你很无聊。

10.  最后也是更重要的一点：不要对任何特定的方法或技术变得虔诚。借鉴每个方面的最佳方面，并找到适合您和您的团队的平衡点。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-25T19:58:27.357

1.  我们使用 Trac 作为我们的错误/功能请求跟踪系统
2.  Trac 工单经过审核，更改为可用单元，然后分配给里程碑
3.  trac 票是我们的规格，包含大部分非常稀疏的信息，必须在里程碑期间讨论
4.  不，但我们的开发团队只有两名成员
5.  是的，我们进行了测试，是的，TDD 对我们帮助很大。覆盖率约为 70% (Cobertura)
6.  不，我们会在适当的时候重构（在代码更改期间）
7.  我们只记录公共方法和类，我们的最大行数是 40，所以方法通常太小以至于无法自我描述（如果有这样的事情 ;-)
8.  带有主干、rc 和稳定分支的 svn
    1.  主干 - 新功能的开发，旧功能的错误修复
    2.  rc - 对于内部测试，错误修正从主干向下合并
    3.  稳定 - 只有从主干或 rc 合并的错误修复

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T18:35:12.593

为了给出更好的答案，我公司的政策是尽可能使用 XP，并遵循敏捷宣言中概述的原则和实践。

[http://agilemanifesto.org/](http://agilemanifesto.org/)

[http://www.extremeprogramming.org/](http://www.extremeprogramming.org/)

所以这包括故事卡、测试驱动开发、结对编程、自动化测试、持续集成、一键安装等。我们并不擅长文档，但我们意识到我们需要生成足够的文档才能创建工作软件。

简而言之：

*   创建足够的用户故事来开始开发（这里的用户故事是与业务对话的开始，而不是完整的规范或完全充实的用例，而是可以在不到 1 次迭代中实现的一小部分业务价值）
*   根据业务优先考虑的最重要的内容迭代实施故事卡
*   从业务部门获得关于刚刚实施的反馈（例如，好、坏、几乎等）
*   重复直到企业认为该软件足够好

# c# - DeleteOnSubmit LINQ 异常“无法使用已在使用的键添加实体”

> ID：682890
> 
> 赞同：4
> 
> 时间：2009-03-25T18:33:54.110
> 
> 标签：c#, linq

编辑：如果有人想知道，actionhandler 会调用创建和处理相同类型数据上下文的代码，以防可能与此行为有关。代码没有触及 MatchUpdateQueue 表，但我想我应该提到它以防万一。

双重编辑：每个回答的人都是正确的！我把答案交给了我提问最多的受访者。修复问题允许弹出另一个问题（隐藏在处理程序中），这恰好引发了完全相同的异常。哎呀！

我在删除 LINQ 中的项目时遇到了一些问题。下面代码中的 DeleteOnSubmit 调用会导致 LINQ 异常，并显示消息“无法使用已在使用的键添加实体”。我不确定我在这里做错了什么，它开始让我陷入困境。主键只是一个整数自动增量列，在我尝试从数据库队列中删除一个项目之前，我没有其他问题。希望我在这里做一些令人痛苦的迟钝的事情，对于不是我的人来说很容易发现！

```
static void Pacman()
{
    Queue<MatchUpdateQueue> waiting = new Queue<MatchUpdateQueue>();

    events.WriteEntry("matchqueue worker thread started");

    while (!stop)
    {
        if (waiting.Count == 0)
        {
            /* grab any new items available */
            aDataContext db = new aDataContext();
            List<MatchUpdateQueue> freshitems = db.MatchUpdateQueues.OrderBy(item => item.id).ToList();

            foreach (MatchUpdateQueue item in freshitems)
                waiting.Enqueue(item);
            db.Dispose();
        }
        else
        {
            /* grab & dispatch waiting item */
            MatchUpdateQueue item = waiting.Peek();
            try
            {
                int result = ActionHandler.Handle(item);
                if (result == -1)
                    events.WriteEntry("unknown command consumed : " + item.actiontype.ToString(), EventLogEntryType.Error);

                /* remove item from queue */
                waiting.Dequeue();

                /* remove item from database */
                aDataContext db = new aDataContext();
                db.MatchUpdateQueues.DeleteOnSubmit(db.MatchUpdateQueues.Single(i => i == item));
                db.SubmitChanges();
                db.Dispose();
            }
            catch (Exception ex)
            {
                events.WriteEntry("exception while handling item : " + ex.Message, EventLogEntryType.Error);
                stop = true;
            }
        }

        /* to avoid hammering database when there's nothing to do */
        if (waiting.Count == 0)
            Thread.Sleep(TimeSpan.FromSeconds(10));
    }

    events.WriteEntry("matchqueue worker thread halted");
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T18:44:34.553

你可以做一些事情

```
db.MatchUpdateQueues.DeleteOnSubmit(db.MatchUpdateQueues.Single(theItem => theItem == item)); 
```

只是一个注释，因为其他答案暗示 Attach.. 除非实体已被序列化，否则您将无法在收到项目的原始上下文之外的上下文上使用附加。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T18:38:20.217

采用：

```
aDataContext db = new aDataContext();
item = new MatchUpdateQueue { id=item.id }; // <- updated
db.MatchUpdateQueues.Attach(item);
db.MatchUpdateQueues.DeleteOnSubmit(item);
db.SubmitChanges(); 
```

由于您使用的是新的数据上下文，因此它不知道该对象已经在数据库中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T18:51:21.353

尝试将 while 循环的整个内部包装在单个数据上下文的 using 语句中：

```
Queue<MatchUpdateQueue> waiting = new Queue<MatchUpdateQueue>();
events.WriteEntry("matchqueue worker thread started");
while (!stop)
{
    using (var db = new aDataContext())
    {
      if (waiting.Count == 0)
      {
        /* grab any new items available */
           List<MatchUpdateQueue> freshitems = db.MatchUpdateQueues
                                                 .OrderBy(item => item.id)
                                                 .ToList();
           foreach (MatchUpdateQueue item in freshitems)
                waiting.Enqueue(item);
      }
      ...
   }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T19:27:49.333

删除第一个 db.Dispose() 处置。它可能是问题代码，因为实体保留对其数据上下文的引用，因此您不希望在仍在使用实例时释放它。这不会影响连接，因为它们仅在执行需要它们的操作时打开/关闭。

也不要像那样处置第二个数据上下文，因为无论如何异常都不会调用该处置代码。使用 using 关键字，这将确保无论是否发生异常都会调用 dispose。还从数据库中获取项目以将其删除（以避免必须序列化/反序列化/附加）。

```
using (aDataContext db = new aDataContext())
{
   var dbItem = db.MatchUpdateQueues.Single(i => i.Id == item.Id);
   db.MatchUpdateQueues.DeleteOnSubmit(dbItem);
   db.SubmitChanges();
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-14T13:14:03.270

如果您的 TEntity（此处为区域）主键的类型为身份列，请尝试此操作；就这样，您的 SP 或模型没有任何变化：

```
public void InitForm()
{
    'bnsEntity is a BindingSource and cachedAreas is a List<Area> created from dataContext.Areas.ToList()
    bnsEntity.DataSource = cachedAreas;
    'A nominal ID
    newID = cachedAreas.LastOrDefault().areaID + 1;
    'grdEntity is a GridView
    grdEntity.DataSource = bnsEntity;
}

private void tsbNew_Click(object sender, EventArgs e)
{
    var newArea = new Area();
    newArea.areaID = newID++;
    dataContext.GetTable<Area>().InsertOnSubmit(newArea);
    bnsEntity.Add(newArea);
    grdEntity.MoveToNewRecord();
} 
```

# c# - 如何将两个 IEnumerable 合并（或压缩）在一起？

> ID：682904
> 
> 赞同：8
> 
> 时间：2009-03-25T18:38:23.837
> 
> 标签：c#, .net, linq, ienumerable

我有一个`IEnumerable<T>`和一个`IEnumerable<U>`我想合并到一个`IEnumerable<KeyValuePair<T,U>>`KeyValuePair 中连接在一起的元素的索引相同的地方。请注意，我没有使用 IList，因此我没有要合并的项目的计数或索引。我怎样才能最好地做到这一点？我更喜欢 LINQ 的答案，但是任何以优雅的方式完成工作的东西都可以。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-25T18:44:41.247

**注意：**从 .NET 4.0 开始，该框架`.Zip`在 IEnumerable 上包含一个扩展方法，[在此处](http://msdn.microsoft.com/en-us/library/dd267698%28v=vs.110%29.aspx)记录。以下内容是为了后代和在 4.0 之前的 .NET 框架版本中使用而维护的。

我使用这些扩展方法：

```
// From http://community.bartdesmet.net/blogs/bart/archive/2008/11/03/c-4-0-feature-focus-part-3-intermezzo-linq-s-new-zip-operator.aspx
public static IEnumerable<TResult> Zip<TFirst, TSecond, TResult>(this IEnumerable<TFirst> first, IEnumerable<TSecond> second, Func<TFirst, TSecond, TResult> func) {
    if (first == null) 
        throw new ArgumentNullException("first");
    if (second == null) 
        throw new ArgumentNullException("second");
    if (func == null)
        throw new ArgumentNullException("func");
    using (var ie1 = first.GetEnumerator())
    using (var ie2 = second.GetEnumerator())
        while (ie1.MoveNext() && ie2.MoveNext())
            yield return func(ie1.Current, ie2.Current);
}

public static IEnumerable<KeyValuePair<T, R>> Zip<T, R>(this IEnumerable<T> first, IEnumerable<R> second) {
    return first.Zip(second, (f, s) => new KeyValuePair<T, R>(f, s));
} 
```

**编辑**：评论后我有义务澄清和解决一些问题：

*   我最初从[Bart De Smet 的博客中逐字获取了第一个 Zip 实现](http://community.bartdesmet.net/blogs/bart/archive/2008/11/03/c-4-0-feature-focus-part-3-intermezzo-linq-s-new-zip-operator.aspx)
*   添加了枚举器处理（在 Bart 的原始帖子中也有[说明）](http://community.bartdesmet.net/blogs/bart/archive/2008/11/03/c-4-0-feature-focus-part-3-intermezzo-linq-s-new-zip-operator.aspx#14059)
*   添加了空参数检查（也在 Bart 的帖子中讨论）

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2010-09-23T17:37:40.470

作为对遇到此问题的任何人的更新，.Net 4.0 原生支持此问题，例如来自 MS：

```
int[] numbers = { 1, 2, 3, 4 };
string[] words = { "one", "two", "three" };

var numbersAndWords = numbers.Zip(words, (first, second) => first + " " + second); 
```

[文档](https://docs.microsoft.com/en-us/dotnet/api/system.linq.enumerable.zip?view=net-5.0)：

> 该方法将第一个序列的每个元素与第二个序列中具有相同索引的元素合并。如果序列没有相同数量的元素，则该方法会合并序列，直到它到达其中一个的末尾。例如，如果一个序列有三个元素，而另一个序列有四个，则结果序列将只有三个元素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T18:44:39.217

想想你在这里更仔细地问什么：

您想组合两个 IEnumerable，其中“在 KeyValuePair 中连接在一起的元素的**索引相同”，但您“****没有** 我正在合并的项目的计数或**索引”。**

无法保证您的 IEnumerables 甚至已排序或未排序。你的两个 IEnumerable 对象之间没有关联，那么你怎么能期望它们关联呢？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T18:48:06.650

看下[一个](http://www.codeplex.com/nextension)：

> 当前实现的方法
> 
> IEnumerable
> 
> *   ForEach 对 IEnumerable 的每个元素执行指定的操作。
> *   将物品组合成相同大小的批次。
> *   Scan 通过将委托应用于 IEnumerable 中的项目对来创建列表。
> *   AtLeast 检查 IEnumerable 中至少有一定数量的项目。
> *   AtMost 检查 IEnumerable 中的项目数量不超过一定数量。
> *   **Zip**通过将两个其他列表合并为一个来创建一个列表。
> *   Cycle 通过重复另一个列表来创建一个列表。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T18:54:23.610

我会使用类似的东西 -

```
IEnumerable<KeyValuePair<T,U>> Merge<T,U>(IEnumerable<T> keyCollection, IEnumerable<U> valueCollection)
{
    var keys = keyCollection.GetEnumerator();
    var values = valueCollection.GetEnumerator();
    try
    { 
        keys.Reset();
        values.Reset();

        while (keys.MoveNext() && values.MoveNext())
        {
            yield return new KeyValuePair<T,U>(keys.Current,values.Current);
        }
    }
    finally
    {
        keys.Dispose();
        values.Dispose();
    }
} 
```

这应该可以正常工作，并在之后正确清理。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T18:46:20.180

未经测试，但应该可以工作：

```
IEnumerable<KeyValuePair<T, U>> Zip<T, U>(IEnumerable<T> t, IEnumerable<U> u) {
    IEnumerator<T> et = t.GetEnumerator();
    IEnumerator<U> eu = u.GetEnumerator();

    for (;;) {
        bool bt = et.MoveNext();
        bool bu = eu.MoveNext();
        if (bt != bu)
            throw new ArgumentException("Different number of elements in t and u");
        if (!bt)
            break;
        yield return new KeyValuePair<T, U>(et.Current, eu.Current);
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-25T18:47:38.510

您可以使用[MoreLINQ中的](http://code.google.com/p/morelinq/)[Zip](http://code.google.com/p/morelinq/wiki/OperatorsOverview)方法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-25T18:49:50.517

MSDN 有以下[自定义序列运算符](http://msdn.microsoft.com/en-us/vcsharp/aa336749.aspx#combine)示例。Welbog 是对的；如果您对基础数据没有索引，则无法保证该操作符合您的预期。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-25T19:06:37.120

[JaredPar](https://stackoverflow.com/users/23283/jaredpar)有一个[库](http://code.msdn.microsoft.com/BclExtras)，里面有很多有用的东西，包括`Zip`它可以实现你想做的事情。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-25T19:18:01.073

Alexey Romanov的[功能点网项目](http://code.google.com/p/functional-dotnet/)的另一个实现：

```
/// <summary>
/// Takes two sequences and returns a sequence of corresponding pairs. 
/// If one sequence is short, excess elements of the longer sequence are discarded.
/// </summary>
/// <typeparam name="T1">The type of the 1.</typeparam>
/// <typeparam name="T2">The type of the 2.</typeparam>
/// <param name="sequence1">The first sequence.</param>
/// <param name="sequence2">The second sequence.</param>
/// <returns></returns>
public static IEnumerable<Tuple<T1, T2>> Zip<T1, T2>(
    this IEnumerable<T1> sequence1, IEnumerable<T2> sequence2) {
    using (
        IEnumerator<T1> enumerator1 = sequence1.GetEnumerator())
    using (
        IEnumerator<T2> enumerator2 = sequence2.GetEnumerator()) {
        while (enumerator1.MoveNext() && enumerator2.MoveNext()) {
            yield return
                Pair.New(enumerator1.Current, enumerator2.Current);
        }
    }
    //
    //zip :: [a] -> [b] -> [(a,b)]
    //zip (a:as) (b:bs) = (a,b) : zip as bs
    //zip _      _      = []
} 
```

替换`Pair.New`为 new `KeyValuePair<T1, T2>`（和返回类型），你就可以开始了。

# ruby-on-rails - 使用 ruby ist-aasm 持久化状态列（充当状态机）

> ID：682920
> 
> 赞同：8
> 
> 时间：2009-03-25T18:42:03.187
> 
> 标签：ruby-on-rails, aasm, acts-as-state-machine

在使用 aasm 进行转换时将对象的状态保存到数据库的最佳方法是什么？我原以为这会自动发生，但事实并非如此。

（编辑：当我手动保存对象时，状态列确实会更新。但是在转换时不会保存。）

对于这个插件，我找不到太多有用的文档，因此，如果您有关于具有更好文档的替代有限状态机实现的建议，那也可能会有所帮助。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-08-09T20:49:33.527

如果你叫*砰！*转换事件方法的形式，状态将持续存在。例如，假设您有一个带有以下事件的对象：

```
class Book < ActiveRecord::Base
  # ... 

  aasm_event :close do
    transitions :to => :closed, :from => [:opened]
  end

  # ...
end 
```

调用`book.close`会将状态设置为`closed`，但不会自动保存。调用`book.close!`将设置状态*并*自动保存 AR 对象。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-12T20:45:59.793

正如 Colin 所建议的，AASM 将为您保留您的更改。Markus 所说的完全不正确，除了最新版本的 gem 有一个错误。

在 lib/persistence/active_record_persistence.rb 的第 180 行（您可以通过运行 gem:unpack 获得此信息），您应该会看到注释，其中指出：

> 将状态写入状态列并使用 update_attribute 将其持久化到数据库（绕过验证）

但是，在代码中，它实际上调用了 save！

```
unless self.save 
```

当底层模型验证失败时会出现该错误，因为默认情况下 save 方法不会绕过验证。一个快速的解决方法是这样做：

```
unless self.save(false) 
```

现在，转换确实将新状态保存到数据库中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T18:53:36.373

我相信 AASM 会在转换后保持对象的状态。请参见 aasm/lib/persistence/active_record_persistence.rb 中的第 180-189 行

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-03-25T18:46:14.580

如果这是你想要的效果，我认为你必须在过渡中保存。根据设计，ActiveRecord（aasm 位于其之上）不会自动保存记录。

如果需要，您可以在[回调](http://rails.aizatto.com/2007/05/24/ruby-on-rails-finite-state-machine-plugin-acts_as_state_machine/)中进行保存（听起来像您这样做）。

# python - 动态更改 wx.ComboBox() 中的选项

> ID：682923
> 
> 赞同：21
> 
> 时间：2009-03-25T18:42:34.760
> 
> 标签：python, wxpython, wxwidgets

我没有找到更好的方法来更改 wx.ComboBox() 中的不同选择，而不是将旧的 ComboBox 换成新的。有没有更好的办法？

欧尔扬·彼得森

```
#!/usr/bin/python

#20_combobox.py

import wx
import wx.lib.inspection

class MyFrame(wx.Frame):
    def __init__(self, *args, **kwargs):
        wx.Frame.__init__(self, *args, **kwargs)

        self.p1 = wx.Panel(self)
        lst = ['1','2','3']
        self.st = wx.ComboBox(self.p1, -1, choices = lst, style=wx.TE_PROCESS_ENTER)

        self.st.Bind(wx.EVT_COMBOBOX, self.text_return)

    def text_return(self, event):
        lst = ['3','4']
        self.st = wx.ComboBox(self.p1, -1, choices = lst, style=wx.TE_PROCESS_ENTER)

class MyApp(wx.App):
    def OnInit(self):
        frame = MyFrame(None, -1, '20_combobox.py')
        frame.Show()
        self.SetTopWindow(frame)
        return 1

if __name__ == "__main__":
    app = MyApp(0)
#    wx.lib.inspection.InspectionTool().Show()
    app.MainLoop() 
```

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-03-25T18:58:43.660

[wx.ComboBox](http://docs.wxwidgets.org/stable/classwx_combo_box.html)派生自[wx.ItemContainer](http://docs.wxwidgets.org/stable/classwx_item_container.html)，它具有[附加](http://docs.wxwidgets.org/stable/classwx_item_container.html#a8fdc0090e3eabc762ff0e49e925f8bc4)、[清除](http://docs.wxwidgets.org/stable/classwx_item_container.html#aea621d4fdfbc3a06bf24dcc97304e2c1)、[插入](http://docs.wxwidgets.org/stable/classwx_item_container.html#a8844cacec8509fe6e637c6f85eb8b395)和[删除](http://docs.wxwidgets.org/stable/classwx_item_container.html#a0e8379f41e9d7b912564000828140a19)项目的方法，所有这些方法都在 wx.ComboBox 上可用。

做你想做的一种方法是定义 text_return() 方法如下：

```
def text_return(self, event):
    self.st.Clear()
    self.st.Append('3')
    self.st.Append('4') 
```

# regex - 从 RSS 提要中过滤或删除 item.description

> ID：682925
> 
> 赞同：1
> 
> 时间：2009-03-25T18:43:23.277
> 
> 标签：regex, rss, twitter, yahoo-pipes

我想在雅虎管道中删除 twitter 提要的 item.description 部分，但我还没有弄清楚如何去做。

显然过滤器模块将删除包含该项目的帖子，所以我一直在尝试使用正则表达式。我认为清除 item.description 字段就可以了。是否有一个正则表达式可以替换整个字符串？

基本上，目标是制作一个仅显示标题和发布日期的 Twitter 帖子。基本上， item.description 字段会产生冗余信息。

可以在[此处](http://pipes.yahoo.com/pipes/pipe.info?_id=d20d9b90da911cffe0db73483c31afc5)找到管道的副本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T18:59:40.710

理想情况下，您希望使用 XSLT 来执行此操作 - 如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:template match="*">
        <xsl:copy>
            <xsl:copy-of select="@*" />
            <xsl:apply-templates />
        </xsl:copy>
    </xsl:template>
    <xsl:template match="//description">
        <description/>
    </xsl:template>
</xsl:stylesheet> 
```

但是由于您使用的是 Pipes，请尝试以下正则表达式：

> `<description>[^<]*</description>`

有了这个：

> `<description/>`

作为替换字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-09T18:20:20.203

要完全删除描述节点，请在输出之前添加：

![在此处输入图像描述](https://i.stack.imgur.com/GLn8C.png)

# wordpress - 您如何建议在 WordPress 中将图像添加为自定义字段？

> ID：682926
> 
> 赞同：0
> 
> 时间：2009-03-25T18:43:29.533
> 
> 标签：wordpress, image, custom-field-type

我需要在 WordPress 的每个页面上添加一个图像。我不希望使用 WYSIWYG 编辑器插入它，我只需要 url 作为自定义字段，稍后我会在模板中使用它。

我尝试使用 CFI 插件（自定义字段图像），并设法让它与我的其他插件一起使用，但后来我将站点移至生产服务器，CFI 出于某种原因无法正常工作。

我似乎找不到任何其他插件可以让您从库中选择图像并将其添加为自定义字段。

我已经降级到愿意手动将所有 URL 输入到每个页面的地步。但在我这样做之前，我想我会在这里检查一下。

谁能告诉我在 WordPress 中添加图像作为自定义字段的最简单、最好的方法是什么（2.7.1，如果重要的话）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-26T11:06:58.653

在我们的 WordPress 模板中，每个帖子通常只有一个“附加”图像，显示在帖子的（文本）内容之外。

我只是使用编辑帖子的媒体上传器上传文件，永远不会像上面的 JoshJordan 那样将其插入帖子中，然后在我的模板文件的正确位置使用一些代码检索图像。

如果您在帖子中使用多个图像，这也将起作用，例如。在您的帖子内容中。只要您将用作“主要”帖子图像的图像保留为第一张图像（请记住，您可以通过上下拖动来重新排列帖子图像库中的图像），您就可以轻松地在任何地方调用它在您的模板文件中使用以下内容：

```
<?php
$img_size = 'thumbnail'; // use thumbnail, medium, large, original

$img_id = $wpdb->get_var("SELECT ID FROM $wpdb->posts where post_parent= $post->ID and (post_mime_type = 'image/jpeg' OR post_mime_type = 'image/gif') and post_type = 'attachment'");

$img_array = wp_get_attachment_image_src($img_id,$img_size,false);

echo '<img src="'.$img_array[0].'"' title="'.get_the_title().'" />';
?> 
```

无需复制和粘贴图片网址。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T18:51:55.877

我拥有的模板为每个帖子的启动图像使用手动输入的自定义字段。写完文章后，我上传了一张图片，从上传工具复制了它的 URL，从不将其插入到我的帖子中，然后将该 URL 粘贴到“图片”自定义字段中。像馅饼一样简单，只需几秒钟。与我写一篇文章所花费的时间相比，微不足道。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-11T13:33:18.950

您也可以在帖子上使用自定义键值字段。假设您总是给您的图像“拇指”键。然后，您可以使用此代码将它们作为缩略图输出到您的帖子中：

```
<?php 
   $values = get_post_custom_values("thumb");  
   echo “&lt;img src=\”$values[0]\” class=\”thumb\”&gt;</a>”;  ?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-11T05:08:59.087

考虑使用 [Flutter](http://flutter.freshout.us/)，一开始有点难以理解，并且有许多非常有用的功能，包括 EIP（就地编辑）和图像处理。

安装插件后创建一个新的“写面板”，你会从那里弄清楚。该插件为您提供了一个相当直观的 GUI，其中包括一个图像上传器。模板标签非常易于使用，我相信它类似于

```
<?php echo get_image('name_of_field'); ?> 
```

我只需要为需要相同功能的客户建立一个网站，我最终使用了 Flutter。

# algorithm - 加权项的快速采样和更新（像红黑树这样的数据结构？）

> ID：682928
> 
> 赞同：1
> 
> 时间：2009-03-25T18:44:25.583
> 
> 标签：algorithm, data-structures, statistics

该任务的合适数据结构是什么？

我有一组 N 个项目。N 很大。每个项目都有一个与之相关的正权重值。

我想快速执行以下操作：

内循环：

> 对一件物品进行取样，根据它的重量。
> 
> [过程...]
> 
> 更新 K 个项目的权重，其中 K << N。

当我说按重量抽样时，这与统一抽样不同。一个项目的可能性与其重量成正比。因此，如果有两件物品，一件重量为 0.8，一件重量为 0.2，那么它们的可能性分别为 80% 和 20%。

项目数 N 保持不变。权重在有界范围内，例如 [0, 1]。权重之和并不总是为 1。

一种简单的方法需要 O(n) 个时间步来采样。有 O(log(n)) 算法吗？

该任务的合适数据结构是什么？我认为红黑树是不合适的，因为它们将每个项目视为具有相同的权重。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T23:27:34.170

实际上，您可以为此使用（修改过的）RB-trees。此外，任何平衡树（不一定是二叉树）的修改都可以。

诀窍是在每个节点中存储附加信息 - 在您的情况下，它可能是以节点为根的子树的总权重，或类似的东西。

当您更新（即插入/删除）树时，您遵循您最喜欢的树的算法。当您更改结构时，您只需重新计算节点的总和（这是一个 O(1) 操作，例如旋转和 B 树拆分和连接）。更改项目的权重时，会更新节点祖先的总和。

采样时，您运行的是修改后的搜索版本。您得到树中所有权重的总和（即根的总和）并生成一个低于此值的正随机数。然后，您运行搜索算法，如果数字（这是您搜索的分位数）小于左节点的总和，则转到左节点。如果你去右边的节点，你从分位数中减去左边的总和。

这个描述有点混乱，但我希望它有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-06-08T09:43:45.683

这是我必须为一些蒙特卡罗模拟解决的问题。您可以在下面的链接中看到我当前的“二叉树”。我试图让它非常像 STL。我的树有一个固定的容量，你可以用红黑树的方法来解决这个问题，我已经谈到过尝试。它本质上是 jpacelek 描述的想法的实现。

该方法在处理不精确的浮点数方面非常稳健，因为它几乎总是求和并比较相同大小的数量，因为它们在树中处于同一级别。

[http://mopssuite.svn.sourceforge.net/viewvc/mopssuite/utils/trunk/include/binary_tree.hpp?view=markup](http://mopssuite.svn.sourceforge.net/viewvc/mopssuite/utils/trunk/include/binary_tree.hpp?view=markup)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T09:20:16.087

由于 N 是固定的，您可以通过使用数组来解决这个问题，比如 v，其中 v[i+1] = v[i] + weight[i], v[1] = weight[0], v[0] = 0 并通过二分搜索对它进行采样，即 log(N)，寻找均匀分布在 0 和权重之和之间的随机数的下界。

K 项的朴素更新是 O(KN)，更周到的是 O(N)。

自鸣得意的圈子又破坏了另一个面试问题:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-26T03:21:41.080

I like jpalecek's answer. I would add that the simplest way to get your random number would be (1) Generate u from a uniform(0,1) distribution. (2) Multiply u by the sum of all the weights in the tree.

# ms-access - 如何检查调用堆栈

> ID：682932
> 
> 赞同：10
> 
> 时间：2009-03-25T18:44:42.557
> 
> 标签：ms-access, vba, callstack

是否可以`CallStack`在 VBA 中看到 MS Access 2003？也就是说，能不能从叫什么看`procedure`？`function``function`

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-25T18:50:39.470

在运行时，查看菜单 -> 调用堆栈（或按 CTRL + L）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-26T04:11:26.547

VBA 中没有编程方式来查看我所知道的调用堆栈。这个问题的通常解决方案是使用一些结构来跟踪函数的调用，但它对我来说似乎总是一个杂物，而且只有在编程时（而不是在运行时）才真正有用，在这种情况下，我觉得 VBE 的查看调用堆栈的内置功能就足够了。

而且，顺便说一句，我总是将调用堆栈按钮放在我的 VBE 工具栏上，因为它是我最常用的功能之一。我还添加了编译按钮——我认为它默认不在工具栏上很疯狂，因为它鼓励人们在不强制编译的情况下编写代码。话又说回来，Access 2000 在默认情况下甚至没有使用 Option Explicit（据说是为了与使用 VBE 的其他应用程序保持一致——换句话说，为了使其与几乎没有代码的应用程序保持一致，使 Access 变得笨拙——重的）。

但我离题了...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-03-01T10:44:42.393

最后，为您的函数添加一个可选参数，并以这种方式传递调用者名称。对于表单，您可以`Me.Name`用作参数。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-02-22T16:48:30.090

是的，这是可能的，但它不是很有用！

```
Private Declare Sub SetMode Lib "vba332.dll" Alias "EbSetMode" (ByVal lngMode As Long)
Private Declare Function GetCallStackCount Lib "vba332.dll" Alias "EbGetCallstackCount" (lngCount As Long) As Long
Private Declare Function GetCallStackFunction Lib "vba332.dll" Alias "EbGetCallstackFunction" (ByVal Lvl As Long, ByRef strBase As String, ByRef strModule As String, ByRef strFunction As String, ByRef Done As Long) As Long 
```

Before use GetCallStackCount and GetCallStackFunction call SetMode(2), and after SetMode(1).

# c++ - 是否有 GCC 预处理器指令来检查代码是否在 64 位机器上编译？

> ID：682934
> 
> 赞同：14
> 
> 时间：2009-03-25T18:44:44.663
> 
> 标签：c++, gcc

我正在尝试执行以下操作；

```
#ifdef 64-bit
    #define DECIMAL_FORMAT %ld
#else
    #define DECIMAL_FORMAT %d
#endif
.
intptr_t d;  
.
printf(“Some message with DECIMAL_FORMAT in the middle of it\n”, d); 
```

类型为“intptr_t”的变量“d”在 32 位机器上需要“%d”格式说明符，在 64 位机器上需要格式说明符“%ld”。我正在寻找一种能够在不更改 GCC 命令行或源代码的情况下在 32 位机器和 64 位机器上编译代码的解决方案。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-25T18:49:54.213

我认为 __LP64__ 可能是您正在寻找的。见[http://gcc.gnu.org/onlinedocs/gcc-4.1.2/cpp/Common-Predefined-Macros.html](http://gcc.gnu.org/onlinedocs/gcc-4.1.2/cpp/Common-Predefined-Macros.html)

不过，也许更好的方法是使用 %p 说明符来 printf() 而不是 %ld 或 %d。然后你甚至不必担心你的指针大小是多少。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-25T22:05:35.023

您想使用`PRI*`定义在`inttypes.h`. 您可以通过定义来启用它们`__STDC\_FORMAT\_MACROS`。然后你可以使用

```
 intptr_t d = ... ;
 printf("This is an intptr_t: %" PRIxPTR "\n", d); 
```

宏将`PRIxPTR`扩展为`llx`if`__WORDSIZE == 64`和`lx`or`x`否则。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T19:25:18.607

推荐的解决方案是使您的应用程序的行为更具可预测性。如果你让它依赖于内存指针的大小，你可能会遇到一些意想不到的意外。Printf 只了解几种类型，如果您必须打印一个类型的值，但您不能始终确保它确实是已知的，最好将其转换为已知的值。

```
printf("Some message with %ld in the middle of it\n", (long) d); 
```

这是一个很好的建议，适用于任何类型。例如，要打印一个 Unix PID（即 pid_t 类型）：

```
pid_t pid = fork();
printf("Fork returned %d.\n", (int) pid); 
```

你不必知道pid的类型和大小，只要目标类型足够大即可。

# ant - 从 hudson 实例自动运行 qtp 测试

> ID：682938
> 
> 赞同：1
> 
> 时间：2009-03-25T18:46:01.773
> 
> 标签：ant, hudson, qtp

我们在工作中有一台 Hudson 机器，它充当 Java Swing 项目的构建服务器。构建过程基于 Ant 脚本（而不是 Maven）。

有没有人从 QuickTest Professional 集成测试是这样的配置？

换句话说：是否可以通过 Ant 自动执行 q​​tp 测试？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T19:30:29.467

不确定您的特定设置，但 QTP 有一个自动化 API，可用于驱动 QTP 本身。下面是一个示例 VBScript 片段，您可以将其放入 .vbs 文件并从命令行调用。

```
Dim qtApp 'As QuickTest.Application ' Declare the Application object variable
Dim qtTest 'As QuickTest.Test ' Declare a Test object variable

Set qtApp = CreateObject("QuickTest.Application") ' Create the Application object
qtApp.Launch ' Start QuickTest
qtApp.Visible = True ' Make the QuickTest application visible

qtApp.Open "C:\Temp\simple_test", True ' Open the test in read-only mode

' set run settings for the test
Set qtTest = qtApp.Test
qtTest.Run ' Run the test

WScript.StdOut.Write "Status is:" & qtTest.LastRunResults.Status ' Check the results of the test run
qtTest.Close ' Close the test

Set qtResultsOpt = Nothing ' Release the Run Results Options object
Set qtTest = Nothing ' Release the Test object
Set qtApp = Nothing ' Release the Application object 
```

以下链接[Integrating QTP...](http://www.softwareinquisition.com/2006/06/integrating-qtp-with-non-mercury-products "集成 QTP...")描述了将 QTP 与 Ant 和 CruiseControl 集成的设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-10-14T05:33:16.990

是的，这是可能的。我可以为您提供将 QTP 与 Hudson 集成的步骤：

1.  编写调用 QTP 的 VBScript (.vbs) 文件
2.  这个 vbs 文件应该进行所有配置，例如添加插件、对象存储库、库、加载环境变量等
3.  在 Hudson 配置中，使用调用 shell 并将 vbs 文件作为命令行参数传递来调用 QTP 并运行测试
4.  以 HTML 格式生成结果
5.  使用 Hudson 的 HTML 报告插件
6.  在 Hudson Dashboard 中显示结果

# python - 服务器<->设备的数据同步框架/算法？

> ID：682951
> 
> 赞同：8
> 
> 时间：2009-03-25T18:48:46.103
> 
> 标签：python, django, synchronization

我希望在服务器和分布式客户端之间实现数据同步。服务器上的数据源是mysql，上面有django。客户可能会有所不同。更新可以在客户端或服务器上进行，并且服务器和客户端之间的连接不可靠（例如，可以在断开连接的手机上进行更改，当手机再次连接时应该同步）。

S. Lott 建议在[这个问题](https://stackoverflow.com/questions/413086/client-server-synchronization-pattern-algorithm)中使用版本控制设计模式，这是有道理的。我想知道是否有任何我可以使用的现有包/实现。或者，我应该直接使用 svn/git/etc 吗？

还有其他选择吗？那里必须有同步框架或算法的详细描述，但我没有找到它们的运气。如果您指出我正确的方向，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-05T16:18:05.803

AFAIK 没有任何通用的解决方案，主要是由于同步的不同要求。

在我们早期的一个项目中，我们实现了基于[Spring 批处理](http://static.springsource.org/spring-batch/)的同步机制，该机制依赖于每个表（参与同步）上的最后更新时间戳字段。

我听说过[SyncML](http://en.wikipedia.org/wiki/SyncML)，但对此没有太多经验。

如果您有一个服务器和多个客户端，您可以考虑基于 JMS 的方法。数据被捆绑并放置在队列（或主题）中，并由客户端提取。

在您的情况下，由于更新是双向的，因此您还需要处理冲突检测。这带来了额外的复杂性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-05T10:30:05.437

也许使用普通的旧[rsync](http://www.samba.org/rsync/)就足够了。

# regex - 在 grep 中使用转义字符

> ID：682957
> 
> 赞同：9
> 
> 时间：2009-03-25T18:50:27.270
> 
> 标签：regex, escaping

我有以下用于消除空格、制表符和新行的正则表达式：`[^ \n\t]`

但是，我想将其扩展为某些附加字符，例如`>`和`<`。

我试过`[^ \n\t<>]`了，现在效果很好，但是如果`<`or`>`前面有一个，我希望表达式不匹配`\`。

我试过`[^ \n\t[^\\]<[^\\]>]`了，但这没有用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T20:49:04.910

您的输入中是否可以出现以下任何一个序列？

> `\\>`
> `\\\>`
> `\\\\>`
> `\`*`blank`*
> `\`*`tab`*
> `\`*`newline`*
> ...

如果是这样，您打算如何对待他们？

如果没有，那么只要您的正则表达式引擎支持，[零宽度的后视断言就可以解决问题。](http://www.regular-expressions.info/lookaround.html)任何支持 Perl 风格正则表达式的引擎（包括 Perl、PHP 等）都会出现这种情况：

```
 (?<!\\)[ \n\t<>] 
```

以上将匹配任何未转义的空格、换行符、制表符或尖括号。更一般地（`\s`用于表示任何空格字符，包括`\r`）：

```
 (?<!\\)\s 
```

或者，使用互补符号而不需要零宽度的后视断言（但可以说效率较低）：

```
 (?:[^ \n\t<>]|\\[<>]) 
```

您还可以使用后者的变体来处理`\\>`,`\\\>`等`\\\\>`情况，以及前面的反斜杠数量有限，例如：

```
 (?:[^ \n\t<>]|(?:^|[^<>])[\\]{1,3,5,7,9}[<>]) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T20:50:54.047

根据[grep 手册页](http://linux.die.net/man/1/grep)：

> 方括号表达式是由 [ 和 ] 括起来的字符列表。它匹配该列表中的任何单个字符；如果列表的第一个字符是插入符号 ^，则它匹配不在列表中的任何字符。

这意味着您不能仅匹配单个字符，例如 \< 或 \>。

除非您有使用 Perl 正则表达式支持构建的 grep 版本，否则您可以像提到的其他海报之一那样使用环视。不过，并非所有版本的 grep 都具有此支持。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-25T19:18:26.610

也许您可以使用[egrep](http://www.ss64.com/bash/egrep.html)并将您的模式字符串放在引号内。这应该消除逃避的需要。

# c# - GridView 排序不适用于 ObjectDataSource

> ID：682959
> 
> 赞同：1
> 
> 时间：2009-03-25T18:51:03.523
> 
> 标签：c#, asp.net, gridview

我使用 GridView 通过 DataSource 属性使用 ObjectDataSource 进行绑定。现在，问题是我有一个整数字段，如下所示：

```
<asp:GridView ... DataSource="MyObjectDataSource" OnSorting="MyGrdView_Sorting" >
<Columns>
<asp:BoundField DataField="IntegerField" Visible="False" SortExpression="IntegerField" />
</Columns>
</asp:GridView> 
```

我还为我的业务逻辑目的捕获 RowCommand 事件，并在其中触发 GridView 的 Sort() 方法。如果我从 Sorting 事件处理程序中触发 Sort() 方法，我会得到堆栈溢出异常，我不知道它为什么会发生？

最后，即使在做了我认为这里没有发生的正确事情之后，排序也无法在我的 GridView 中使用 IntegerField。我做错了什么？:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T19:12:34.923

在 Sorting 事件上触发 Sort() 将再次触发 Sorting 事件，从而导致堆栈溢出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T18:52:34.550

我的第一个想法是，当您可能应该使用 DataSourceId 属性时，您正在使用 DataSource 属性。

*编辑：*

好吧，我回答得太快了，阅读也太慢了。;) 您能否与我们分享您的 MyGrdView_Sorting 实现？

*第二次编辑并回答评论：*

“我只是在 MyGrdView_Sorting 处理程序中执行 ((GridView)sender).Sort("IntegerField", SortDirection.Ascending);。”

调用 GridView.Sort 将触发 Sorting 事件，在您的情况下将调用 Sort，这将触发 Sorting 事件，它将调用 Sort，...您看到这里的模式了吗？;)

正如您提到的，您将需要在业务逻辑中的另一个位置进行排序。您可以设置 ObjectDataSource.CanSort = true，指定 SortParameterName，然后让 SelectMethod 进行实际排序。

# ruby-on-rails - 同时使用acts_as_list和in_place_editing

> ID：682960
> 
> 赞同：0
> 
> 时间：2009-03-25T18:51:03.570
> 
> 标签：ruby-on-rails, ruby, plugins

我有一个 Rails 项目，其中视图显示项目列表。我使用acts_as_list 使列表DnD 可排序，并在每个项目上进行in_place_editing 以进行编辑。

我的问题是，当我 DnD 周围的项目时，我拖放的项目自动变为可编辑的。关于如何避免这种行为的任何提示。

理想情况下，我想通过单击项目旁边的小图标使其可编辑，但我不知道如何使用此插件使其工作。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T19:40:14.887

发生这种情况是因为您正在拖动的元素在 mouseup 上有一个开始编辑的侦听器。如果您想要一个不同的元素来触发编辑，您可以在选项哈希中指定一个 :external_control。

```
<div id="<%= dom_id(@obj) -%>">
  <span><%= @obj.to_s -%></span>
  <img id="<%= dom_id(@obj, :edit) -%>" src="edit_handle.png"/>
</div>
<%= in_place_editor(dom_id(@obj), :external_control => dom_id(@obj, :edit)) %>
<%= draggable_element(dom_id(@obj)) %> 
```

# sql - 散列连接出现在全文查询 - SQL Server 2005

> ID：682969
> 
> 赞同：4
> 
> 时间：2009-03-25T18:56:30.717
> 
> 标签：sql, sql-server-2005, indexing, full-text-search

我在 SQL Server 2005 中有以下查询：

```
SELECT 
  PRODUCT_ID
FROM 
  PRODUCTS P
WHERE 
  SUPPLIER_ORGANIZATION_ID = 13225
  AND ACTIVE_FLAG = 'Y'
  AND CONTAINS(*, 'FORMSOF(Inflectional, "%clip%") ') 
```

有趣的是，使用它会生成一个哈希匹配，而如果我使用不同的`SUPPLIER_ORGANIZATION_ID`（旧供应商），它会使用 Merge Join。显然 Hash 比 Merge Join 慢得多。我不明白为什么会有差异，以及需要什么让它运行得更快？

仅供参考，PRODUCTS 表中有大约 500 万条记录。When supplier organization id is selected (13225), there are about 25000 products for that supplier.

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T13:21:13.263

我会尝试使用 OPTIMIZE FOR Query Hint 以一种或另一种方式强制它。

```
SELECT 
  PRODUCT_ID
FROM 
  PRODUCTS P
WHERE 
  SUPPLIER_ORGANIZATION_ID = @Supplier_Organisation_Id
  AND ACTIVE_FLAG = 'Y'
  AND CONTAINS(*, 'FORMSOF(Inflectional, @Keywords) ')
OPTION (OPTIMIZE FOR (@Supplier_Organisation_Id = 1000 )) 
```

另一件事是您的 STATISTICS 可能已过时，自动更新的临界点通常不够低，这意味着选择的查询计划可能不适合您的数据。我建议尝试更新您的 Products 表上的 STATISTICS，如果这是问题的一部分，也许可以创建一个定期执行此操作的工作。

# ruby-on-rails - 关于创建下载链接的问题

> ID：682971
> 
> 赞同：0
> 
> 时间：2009-03-25T18:56:32.887
> 
> 标签：ruby-on-rails, http, http-headers

我是 Rails 的新手，正在从事一个项目，用户登录后可以单击链接下载 exe 文件（例如，该文件位于[http://test.com/test.exe](http://test.com/test.exe)）。我想隐藏 exe 文件的链接。实施此步骤的最佳方法是什么。

我正在考虑使用重定向到 url，但我收到一条错误消息，说我不能在一个函数中使用两个重定向。

另外，我正在考虑使用 NET:HTTP 来使用 http 请求，但我不知道如何实现这一点。

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T01:49:42.130

似乎没有人提到 X-Sendfile。

[文件下载完成](http://www.therailsway.com/2009/2/22/file-downloads-done-right)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T19:02:11.517

您应该阅读代码中的文件并将其按原样输出到客户端。在它之前发送相关标题：

```
Content-type: application/octet-stream  
Content-Disposition: inline; filename=[file name you want the user to see]  
Content-length: [file size] 
```

为什么在同一个地方进行两次重定向是不好的，就像试图一次将汽车转向两个方向......

使用可能会更好

```
Content-Type: application/force-download 
```

代替

```
Content-type: application/octet-stream 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T20:02:53.040

要通过控制器代理文件，您可以使用 open-uri。

**在环境.rb**

```
require 'open-uri' 
```

**在您的控制器中**

```
def download
  send_data(open(params[:url]).read,
    :filename => 'somefilename',
    :disposition => 'attachment'
  )
end 
```

编辑：如果你不想代理文件，你必须redirect_to(url)。如果您收到有关重定向的消息两次调用，请记住，您不能同时从同一操作呈现和重定向。如果您需要加载视图，然后开始下载，请使用两个操作：

```
def present_download
  @download = Download.find(params[:id])
  # implicitly calls render :action => :present_download
end

def download_file
  @download = Download.find(params[:id])
  respond_to do |format|
    format.html { redirect_to(@download.url) }
  end
end 
```

在您看来（present_download.html.erb）：

```
<html>
  <head>
    <meta http-equiv="refresh" content="1;url=<%= url_for :action => :download_file -%>" />
  </head>
  <body>
    Your download will automatically start…
… 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T20:56:49.930

我尝试了下面的代码，只是一个示例 exe 文件，但代码看起来正在读取超过 500 MB 的整个文件。我希望它只给我保存 exe 文件的选项 谢谢！

```
 def download
    send_data(open('http://mirrors.gigenet.com/ubuntu/intrepid/ubuntu-8.10-desktop-i386.iso').read,
    :filename => 'ubuntu-8.10-desktop-i386.iso' ,
    :type => 'application/force-download',
    :disposition => 'attachment')
  end 
```

# stored-procedures - 在 Visual Studio Sql 服务项目中更新连接字符串时出现问题

> ID：682973
> 
> 赞同：0
> 
> 时间：2009-03-25T18:56:51.107
> 
> 标签：stored-procedures, visual-studio-2005

我创建了一些 clr 存储过程，并将它们设置到我们的开发环境中。我现在想更新项目的数据库选项卡上的连接字符串，但它没有保存。这是我所做的事情的清单：

1.  我检查以确保项目文件和用户项目文件不是只读的
2.  我已经删除了用户项目卸载了项目并重新加载了项目并创建了一个新的连接字符串

我不确定还能做什么，还有其他人在更新 Sql 服务项目中的数据库连接字符串时遇到问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-09T20:47:38.723

当您编辑连接字符串时，Visual Studio 2008 不会正确更新它们，它会添加一个新字符串而不是替换它们。查看您的 app.config 文件，您可能有多个名称相同的字符串实例。

# java - 异常处理和内存

> ID：682975
> 
> 赞同：0
> 
> 时间：2009-03-25T18:57:20.637
> 
> 标签：java, memory, exception-handling

这可能是一个奇怪的问题，但在服务器环境中，“try-catch”块是否会比仅运行特定的代码块更多地添加到内存中。例如，如果我执行打印堆栈跟踪，JVM 是否会保留更多信息。还是堆上保留了更多信息？

```
try {
  ... do something()
} catch(Exception e) {
 e.printStackTrace();
}

... do something() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T19:04:44.910

异常将引用堆栈跟踪。printStackTrace 将分配更多内存，因为它将堆栈跟踪格式化为漂亮的东西。

try catch 块可能会导致大部分静态代码/数据段，但不会导致运行时内存分配

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T19:16:42.510

这里重要的是，一旦异常变量“e”不再可访问（即超出范围），它就可以进行内存收集。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T19:03:16.863

堆栈跟踪是在创建异常时构建的。打印堆栈跟踪不会比打印其他任何内容更占用内存。

try/catch 块可能有一些性能开销，但不会以增加内存需求的形式出现。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T19:26:13.627

在大多数情况下，发生异常时不必担心内存/性能。如果您有一个通用代码路径的异常，则表明您在滥用异常。

如果您的问题更多是出于学术目的，那么我不知道堆/内存空间方面的全部情况。然而，Joshua Bloch 在“Effective Java”中提到，try catch 块的 catch 块通常相对来说未被大多数 JVM 实现优化。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T19:37:55.487

从技术上讲，您的问题的答案可能是否定的。有很多理由尽可能避免抛出异常，但内存并不是一个真正的问题。

只在真正异常的情况下抛出异常的真正原因是它很慢。生成异常涉及仔细检查堆栈。这根本不是一个快速的操作。如果您将其作为定期执行流程的一部分，它将明显影响您的速度。我曾经写过一个我认为非常聪明的日志系统，因为它通过生成异常并以这种方式检查堆栈来自动找出哪个类调用了它。最终我不得不回去把那部分拿出来，因为它明显减慢了其他一切的速度。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T20:57:39.087

虽然与内存消耗没有直接关系，但前段时间这里有一个线程讨论[Java 异常有多慢？](https://stackoverflow.com/questions/299068/how-slow-are-java-exceptions)在我看来，值得一看。

我的书签里也有这个[链接](http://www.javaspecialists.eu/archive/Issue129.htm)。据我所知，它提供了一个示例，说明在抛出异常时跳过堆栈跟踪生成时可能会加快速度，但该站点现在似乎已关闭。

# content-management-system - 什么是最好的免费开源 CMS（内容管理系统）解决方案？

> ID：682977
> 
> 赞同：-3
> 
> 时间：2009-03-25T18:58:17.640
> 
> 标签：content-management-system

我想将网站转换为使用内容管理系统来更新网站的大量内容页面。当前的网站主要是 ASP.NET，但我正在考虑转换为 PHP，如果这意味着我将与市场上的“首选 CMS”有更好的集成。我听说过 Joomla！和其他 CMS，但我想要一些答案，哪些被认为更好。我需要支持的功能是自定义侧边栏和选项卡菜单（例如可扩展的 javascript 下拉菜单）。谁能告诉我一个好的解决方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T19:11:28.157

您应该查看[opensourcecms.com](http://www.opensourcecms.com/)。这是一个托管大多数开源 CMS 的演示的站点，包括 PHP 和 ASP.NET。您可以尝试每一个并阅读功能和评论。这是一种无需实际安装即可找到满足您需求的好方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T19:03:09.813

[Joomla](http://www.joomla.org)和[Drupal](http://drupal.org/)是您最常用和最流行的基于 PHP 的 CMS 解决方案。

在 .NET 方面，我只建议[DotNetNuke](http://www.dotnetnuke.com)。该 CMS 的开发量是首屈一指的，内容、模块、主题等有着巨大的市场。DNN 中几乎所有的东西都可以满足您的潜在需求。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T19:06:55.593

“最好的” CMS 真的，真的取决于您的要求。

我会说 Joomla 是非常典型的 PHP 意大利面条，我讨厌它，但它可能对你有用。

Kentico（一个.NET CMS）是一个相当不错的，我已经部署了几次。Microsoft CMS 应该不错，不过我没试过。

但是，在不具体了解您的要求的情况下，我发现不可能给出可靠的建议。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T19:14:27.507

我还没有使用这些应用程序，但是 AFAIK [TYPO3](http://typo3.org/)和[ezPublish](http://ez.no/de/ezpublish)（都是 PHP）被认为比 Joomla 更专业。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T19:13:16.327

[Drupal](http://drupal.org/)有着悠久的历史和成功的记录（许多备受瞩目的用例，包括奥巴马竞选活动、Mozilla Firefox 和英国的 MTV），以及大量免费[模块](http://drupal.org/project/Modules)和[主题](http://themegarden.org/drupal6/)，因此您可以从好的地方开始。Drupal 在内容类型方面的数据存储方式方面也是高度可定制的。Drupal 具有出色的[咨询和合同](http://www.google.com/search?q=drupal+consulting&sourceid=navclient-ff&ie=UTF-8&rlz=1B3GGGL_enUS309US309)帮助。

Joomla 是第二强，但快速浏览一下维基百科上的[Joomla 批评](http://en.wikipedia.org/wiki/Joomla#Criticism)，我认为选择变得更加清晰。维基百科上对 Drupal的三个[批评](http://en.wikipedia.org/wiki/Drupal#Criticism)中有两个是它太复杂了，与 Joomla 的缺点相比，这确实是一个主观问题。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-25T19:29:55.723

如果 Web 开发是您的爱好，那么请使用上面提到的开源 CMS。如果这是您的职业，请考虑努力编写满足您需求的自己的职业。前几个可能有点粗糙，但从长远来看，它可以证明是非常令人满意的，并且必须比现成的任何东西都更具可定制性。

自己编写也迫使您不断扩展自己的技能并学习编程语言的复杂性。

# delphi - 为什么当窗口不在屏幕上时 CreateDIBSection() 会失败？

> ID：682980
> 
> 赞同：1
> 
> 时间：2009-03-25T18:59:03.910
> 
> 标签：delphi, winapi, graphics, sdl

我正在构建一个 Delphi 组件以在 VCL 表单上嵌入[SDL](http://www.libsdl.org)渲染表面。只要在创建 SDL 表面时表单在屏幕上，它就可以正常工作。否则，它无法创建任何渲染纹理。

我追踪到 SDL 代码并最终得到以下函数调用，但失败（返回 NULL）：

```
data->hbm = CreateDIBSection(renderdata->memory_hdc, bmi, DIB_RGB_COLORS, &data->pixels, NULL, 0); 
```

HDC 是绘图上下文的有效句柄，该句柄由具有自己的 HWND 窗口句柄的控件拥有，该句柄已正确设置。但是当控件在屏幕外创建时，这通常发生在 Delphi 中，（所有窗体及其控件都在隐藏状态下创建，直到显示它们） CreateDIBSection 调用将失败，直到控件实际可见。

此外，如果它是在屏幕上创建的，然后隐藏并重新显示（例如，如果它在选项卡上并且我切换选项卡）我创建的任何纹理在此过程中都会被空白。

这让我发疯了。任何人都知道发生了什么以及我该如何解决它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-07-05T20:29:01.323

绘图上下文仅在 Paint 处理期间有效。

# gis - 您如何从数据中计算出太阳漫射比例和透射率值？

> ID：682982
> 
> 赞同：0
> 
> 时间：2009-03-25T18:59:38.027
> 
> 标签：gis, arcgis

数据可以在这里找到：

[http://rrdc.nrel.gov/solar/old_data/nsrdb/bluebook/data/24283.SBF](http://rredc.nrel.gov/solar/old_data/nsrdb/bluebook/data/24283.SBF)

我如何从那里计算出太阳漫射比例和透射率值？

有人知道吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T19:14:44.200

您可以从阅读数据格式的文档开始...这可能会导致您需要了解一些教科书或论文...

如果这些类型的资源不可用，请尝试了解作者的姓名并向他们发送电子邮件（甚至给他们打电话）。要有礼貌，并准备好解释你是谁，以及你为什么要这样做......

几乎唯一的选择是找到一个现有代码（可能是您无法*运行*但可以*阅读*的语言）并复制其中采用的方法。

欢迎来到科学数据考古学的精彩世界。

# text - Shell：在给定的文本行之间添加新行

> ID：682984
> 
> 赞同：1
> 
> 时间：2009-03-25T18:59:55.483
> 
> 标签：text, shell, sed, awk, newline

这个问题**没有**问的是如何在与模式匹配的每一行下方或上方添加新行。

我要做的是在一行上存在的模式之间添加新行。

这是一个例子。

*前：*

> 周一：上午 8 点至晚上 10 点

*后：*

> 周一：
> 
> 上午 8 点至晚上 10 点

因此，在这种情况下，在每个“星期一”模式之后插入新行。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-25T19:01:53.403

```
echo 'Monday:8am-10pm' | sed -e 's/^Monday:/&\n/' 
```

对于不超过 ' `:`' 的字符：

```
echo 'Monday:8am-10pm' | sed -e 's/^[^:]*:/&\n/' 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-25T19:02:30.110

```
sed 's/Monday:/&\n/g' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T19:04:14.163

```
sed 's/Monday:/&\n\n/g' 
```

将替换它们（假设您想要 2 个换行符，如上所示）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T19:04:35.020

使用 sed：

```
echo "Monday:8am-10pm" | sed -e 's/:/:\n\n/' 
```

# windows-installer - 如何让 ARP 运行我的安装程序的引导应用程序以进行修改安装？

> ID：682989
> 
> 赞同：1
> 
> 时间：2009-03-25T19:02:05.150
> 
> 标签：windows-installer, arp

我正在开发一个安装程序项目，该项目由一个 MSI 文件和一个管理先决条件的引导应用程序组成；由于对某些先决条件的需求取决于用户选择安装的功能，因此引导应用程序还提供了 UI。当用户想要运行修改安装时，我希望能够强制添加/删除程序（或程序和功能）控制面板 (ARP) 运行引导应用程序而不是 MSI。我尝试将安装程序的卸载注册表项下的 ModifyPath 值更改为引导应用程序的路径，但无济于事。单击 ARP 中的更改按钮仍然可以获得 MSI。

有没有一种简单的方法可以做我想做的事？如果做不到这一点，MSI 有没有办法使用“更改”按钮检测到它是从 ARP 运行的，以便我可以让它显示一条错误消息，告诉用户运行引导应用程序？（即，ARP 是否使用与用户运行 MSI 并指定修改安装相同的命令行参数，而无需查看 UI 的维护页面？如果没有，我应该寻找什么？）

**编辑**我的安装程序不仅要安装一个应用程序，而且要安装一套应用程序，每个用户都可以选择不安装。（我们将这些应用程序作为一个套件安装，因为它们中的大多数都依赖于其中一个被安装。因此，用户更容易让一个安装程序处理它们，而不是单独的安装程序这个新的安装程序将取代。）

套件中的应用程序并不都需要相同的先决条件集，因此，MSI 很难检查先决条件，直到它知道用户想要安装套件中的哪些应用程序。此外，我们希望通过自动启动用户确实希望安装的应用程序的所有先决条件的安装程序来简化用户。（这是安装程序的 UI 在引导应用程序中实现的主要原因。）

MSI 是否有可能启动引导应用程序，然后在引导应用程序继续运行时立即静默退出，最终重新启动 MSI？（当引导应用程序启动 MSI 时，它传递给 MSI 的命令行参数之一是一个属性，告诉它引导应用程序启动了它。除其他外，这目前用于允许 MSI 显示错误消息告诉用户运行引导应用程序，除非在命令行上指定了卸载或修复安装。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T19:46:21.637

添加/删除程序只会运行您的 MSI，不支持查找或运行任何引导程序应用程序。

您可以（并且应该）做的是将先决条件检查添加到您的 MSI，而不管它是如何运行的。这样，您可以警告用户他们正在要求目前无法完成的事情（添加尚未具备其先决条件的功能）。

如果缺少先决条件，您可以添加一条有关运行引导程序的消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T17:47:51.257

通过让 MSI 为我启动引导应用程序，我能够解决我的困境。我只是编写了一个自定义操作来启动引导应用程序并且不等待它完成。最初，我尝试将自定义操作放入 UI 序列中，但我无法在不以这种方式生成错误的情况下结束安装。

因为我的目标是只为修改安装运行引导程序，所以我在维护对话框的下一步按钮上放置了几个新的控制事件（用户可以在修改、修复和删除之间进行选择）。如果用户选择了维护 (MaintenanceMode ~= "Modify")，则启动自定义操作，并使用带有 Exit 作为参数的 EndDialog 操作关闭对话。（我将进入下一个对话框的现有控制事件的条件修改为导致启动引导程序的事件的否定条件，即 NOT (MaintenanceMode ~= "Modify")。）引导程序应用程序被编程为跳过其 GUI 中的维护对话并从序列中的下一个对话开始，尽管如果用户愿意，则允许返回到维护对话。（如果他这样做，

I know, it's a bit of a kludge, but it does what I need it to do. :-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-06-03T14:30:04.690

I know it's late, however Brad Heath does have some comments about this [http://blogs.msdn.com/b/heaths/archive/2005/08/16/a-reason-for-arpsystemcomponent.aspx](http://blogs.msdn.com/b/heaths/archive/2005/08/16/a-reason-for-arpsystemcomponent.aspx)

# .net - .net 使用 ReceiveAsync 检测断开连接

> ID：682991
> 
> 赞同：1
> 
> 时间：2009-03-25T19:02:18.693
> 
> 标签：.net, networking, sockets

好吧，正如标题所说，我如何检测与所有其他 .net 网络模式的“ReceiveAsync”断开连接，如果您收到 0 个字节或是否抛出任何异常，您只需查看此模式，但这似乎不再适用...

我的第一个接收返回 0 个字节，但第二个有效，这就是为什么我很困惑....

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T20:38:16.417

这是一样的：

```
 void OnReceiveComplete(IAsyncResult iar)
        {
            try
            {
                int count = sock.EndReceive(iar);
                if (count == 0)
                {
                    Console.WriteLine("{0} closed by remote host", ID);
                    sock.Close();
                }
                else
                {
                    int total = Interlocked.Increment(ref totalBytes);
                    Console.WriteLine("{0} received {1} (total: {2})",
                        ID, buff[0], total);
                    StartReceive();
                }
            }
            catch (Exception x)
            {
                Console.WriteLine("{0} error from EndReceive: {1}", ID, x);
            }
        } 
```

# ajax - 我想延迟提交原型 AJAX 表单？

> ID：682993
> 
> 赞同：0
> 
> 时间：2009-03-25T19:02:45.663
> 
> 标签：ajax, prototypejs

这是我的代码：

```
Event.observe(window, 'load', function() {  
        Event.observe('form_post', 'submit', function(){
            new Ajax.Updater('Posts', 'getPosts.php', {
            });
        });
}); 
```

我只是想推迟对更新程序的调用，有什么想法吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T19:10:11.810

使用原型[延迟](http://www.prototypejs.org/api/function/delay)方法。

```
Event.observe(window, 'load', function() {  
        Event.observe('form_post', 'submit', function(){
            new Ajax.Updater.delay(1, 'Posts', 'getPosts.php', {
            });
        });
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T19:05:51.617

将其包装在[setTimeout](http://www.w3schools.com/htmldom/met_win_settimeout.asp)调用中。****