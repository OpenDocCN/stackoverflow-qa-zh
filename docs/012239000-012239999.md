# StackOverflow 问答 12239000-12239999

# python - 如何在 Python 中加速矩阵乘法？

> ID：12239002
> 
> 赞同：8
> 
> 时间：2012-09-02T19:20:27.110
> 
> 标签：python, optimization, numpy, parallel-processing, blas

我正在开发一个小型神经网络，其参数需要大量优化，因此需要大量处理时间。我已经分析了我的脚本，`cProfile`占用 80% 的处理器时间的是 NumPy`dot`函数，其余的是使用函数的矩阵求逆`numpy.linalg.solve`。我当前版本的 numpy 使用`blas`，或者看起来就是这样，因为它`numpy.core._dotblas.dot`显示为占用总处理时间 80% 的函数。

因为它是我的神经网络的核心，而且我必须经常运行它，所以任何微小的速度提升都可以为我节省大量重复参数优化的时间。

更高的精度：矩阵乘法是在具有最小 100*100 到 500*500 形状的矩阵上进行的。我有一台 12 核的计算机，到目前为止，我使用它们来并行运行不同的神经网络参数优化，但矩阵乘法可能可以并行完成？

感谢您的时间！

回答：

我花了几天时间测试和安装卸载库...这是我测试的结果：默认情况下，在我的 Ubuntu (12.04) 版本和 Numpy 的存储库安装版本上，BLAS 库是 ATLAS 库。我做了一些测试，特别反映了我感兴趣的计算的改进，所以这些结果不能被解释为最终答案。这些计算涉及 55000 次迭代循环中的矩阵乘法（点积），矩阵为 500*500 和 1000*1000。我使用 HP Z800 工作站和 Xeon X5675 @ 3.07GHZ 和 12 核。所有结果（百分比）都是所描述的条件和参考资料之间的比较，这里是打包的 ATLAS 库。

*   `Scipy.sparse module`：我不知道我是否正确设置了它，但稀疏度为 10%，从 OpenBLAS 和 MKL 的 1500*1500 矩阵开始，使用这个模块变得很有用。如果您对如何正确使用它们有建议，我很感兴趣！
*   使用 OpenBlas，500*500 矩阵的速度提高了 33%，而 1000*1000 的速度提高了 160%。但是对于 OpenBLAS，scipy.sparse 模块实际上并没有表现得更好而是更差。
*   这里的大赢家是 MKL 库。使用原始 ATLAS 库中的 1000*1000 矩阵，加速高达 230%！对于 500*500 矩阵，加速度更适中（100%），但仍然非常好。此外，通过使用 OpenMP 进行编译，矩阵乘法可以在我的 12 个处理器上运行，而且它的速度是使用 MKL 库的一个处理器上的两倍。但这会浪费处理能力，使用多处理模块并行运行脚本/矩阵乘法会更有效。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-02T19:52:15.850

如果您还没有，您可以尝试将 numpy 链接到一个非常优化的 BLAS 库，例如[Intel MKL](http://software.intel.com/en-us/intel-mkl)（[非商业用途的啤酒免费](http://software.intel.com/en-us/non-commercial-software-development)或[学术用途的折扣](http://software.intel.com/en-us/intel-education-offerings)，这显然不算作非-商业；[来自英特尔的说明，用于将其与 numpy](http://software.intel.com/en-us/articles/numpy-scipy-with-mkl) ) 或[OpenBLAS](http://xianyi.github.com/OpenBLAS/) (free-as-in-speech) 一起使用。还有[Enthought Python Distribution](http://www.enthought.com/products/epd.php)，它预先链接到 MKL 和免费为学者提供的啤酒。这可以自动并行化您的矩阵乘法，并且可以比大多数 Linux 发行版上的典型参考 BLAS / ATLAS 安装快得多，或者您正在使用的任何它。

否则，我知道你唯一能做的就是一些数学技巧，不必计算尽可能多的乘法/求解。在不确切知道您在做什么的情况下，很难在那里提出任何建议。

我假设您的矩阵很密集，因为它们通常位于神经网络中，但是如果您正在做一些不寻常的事情`scipy.sparse`也可能会有所帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-02T19:54:26.210

Numpy 使用非常快速的内部算法和基于第三方库（如您所命名的 BLAS）的表示，这些库已经使用了 SSE 优化等。因为最初的 BLAS 有点慢（因为它旨在成为一个参考实现，专注于精度而不是性能），您可能希望使用另一种专注于性能的风格，例如 OpenBLAS。要使用 OpenBLAS，您需要找到一个预构建的支持 OpenBLAS 的 Numpy 包，或者重新编译与 OpenBLAS 链接的版本。一旦你使用了一个高效的 BLAS 实现，你就不会在纯 python 中找到更好的加速选项，除非你用 C 编写一个库并花很多时间来优化它。

另一方面，您可以检查您的 Numpy 和 BLAS 库是否在您的架构上尽可能高效地编译。例如，如果您可以在 Numpy 编译时激活 OpenMP 库，它将允许多个内核使用数据级并行处理您的问题。如果您的计算机上有多个内核并且您的计算受 CPU 限制，这可能是加速的重要来源。如果您的问题允许，您甚至可以使用基于任务的并行编程库（[SCOOP](http://scoop.googlecode.com) [Disclamer: I write it]、[Celery](http://celeryproject.org/)等）在多台计算机上传播您的工作。

作为最后的手段，另一种可能性是购买新硬件。它可以让软件在不改变任何一行代码的情况下运行得更快。

# c# - 如何解析相对于 ASP.NET MVC 4 应用程序根的路径？

> ID：12239006
> 
> 赞同：47
> 
> 时间：2012-09-02T19:20:58.820
> 
> 标签：c#, asp.net-mvc

如何解析相对于 ASP.NET MVC 4 应用程序根目录的路径？也就是说，我想从控制器操作中打开属于应用程序的文件，引用如`~/Data/data.html`. 这些路径通常在`Web.config`.

**编辑：**

通过“解决”，我的意思是将相对于应用程序根目录的路径转换为绝对路径，例如`~/Data/data.html`→ `C:\App\Data\Data.html`。

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2012-09-02T19:30:52.823

要获取绝对路径，请使用以下命令：

```
String path = HttpContext.Current.Server.MapPath("~/Data/data.html"); 
```

编辑：

`.Current`从上面的行中删除控制器的上下文。通过单独使用`HttpContext`它更容易测试，因为它基于控制器的上下文，因此更加本地化。

我现在意识到我不喜欢`Server.MapPath`工作方式（内部最终调用`HostingEnvironment.MapPath`）所以我现在建议总是使用`HostingEnvironment.MapPath`它，因为它是静态的而不依赖于上下文，除非你当然想要......

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2013-03-26T21:20:25.093

当我需要控制器之外的路径时，我发现此代码很有用，例如当我在 Global.asax.cs 中初始化组件时：

```
HostingEnvironment.MapPath("~/Data/data.html") 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2013-01-28T21:07:44.680

只需使用以下

```
Server.MapPath("~/Data/data.html") 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-09-02T19:30:10.410

在操作中，您可以调用：

```
this.Request.PhysicalPath 
```

返回参考当前控制器的物理路径。如果您只需要根路径调用：

```
this.Request.PhysicalApplicationPath 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-06-21T15:42:42.857

在您的控制器中使用：

```
var path = HttpContext.Server.MapPath("~/Data/data.html"); 
```

这允许您使用 Moq 测试控制器，如下所示：

```
var queryString = new NameValueCollection();
var mockRequest = new Mock<HttpRequestBase>();
mockRequest.Setup(r => r.QueryString).Returns(queryString);
var mockHttpContext = new Mock<HttpContextBase>();
mockHttpContext.Setup(c => c.Request).Returns(mockRequest.Object);
var server = new Mock<HttpServerUtilityBase>();
server.Setup(m => m.MapPath("~/Data/data.html")).Returns("path/to/test/data");
mockHttpContext.Setup(m => m.Server).Returns(server.Object);
var mockControllerContext = new Mock<ControllerContext>();
mockControllerContext.Setup(c => c.HttpContext).Returns(mockHttpContext.Object);
var controller = new MyTestController();
controller.ControllerContext = mockControllerContext.Object; 
```

# php - 在 PHP 中使用预填充的下拉列表将输出发送到 INSERT

> ID：12239010
> 
> 赞同：1
> 
> 时间：2012-09-02T19:21:23.740
> 
> 标签：php, mysql, html, forms

我正在创建一个表单，提交时将输出发送到 INSERT 语句。我正在学习如何使用：

```
<form action="somepage.php" method="post">
Example: <input type="text" name="something" />
<input type="submit" />
</form> 
```

我很乐意这样做，然后编写一个包含 $_POST 的 INSERT 语句。

我还有一个字段，我想在下拉列表中显示该字段，其中填充了 mysql_query 的结果，如下所示：

```
$sql = "SELECT name FROM customer";
$result4 = mysql_query($sql);

echo "<select name='name'>";
while ($row = mysql_fetch_array($result4)) {
echo "<option value='" . $row['name'] . "'>" . $row['name'] . "</option>";
}
echo "</select>"; 
```

但是我不确定如何使用用户选择的值。即我想使用他们在我的 INSERT 语句中选择的值以及其他表单字段。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T19:24:37.587

您在`<select>`标签中指定名称，例如：

```
<select name="car">
    <option>Audi</option>
    <option>BMW</option>
</select> 
```

并获取提交的值`$_POST['car']`

在您的情况下，提交后您可以使用`$_POST['name']`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T19:34:27.623

用于`$_POST['name']`获取提交的值。

# google-cloud-datastore - 更新数据存储实体 - 更改祖先而不更改实体键

> ID：12239013
> 
> 赞同：3
> 
> 时间：2012-09-02T19:22:07.713
> 
> 标签：google-cloud-datastore, go

是否可以在不更改实体键的情况下更新实体的祖先？我将如何在 Go 中实现这一点？

我有一个类似于这样的层次结构：

公司/部门/员工

一开始没有员工的部门：公司/员工。然后稍后当他/她被分配到一个部门时，我想将其更改为：公司/部门/员工，但我希望实体键保持不变，因为它已在其他地方用于引用该实体。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T23:55:06.440

> 是否可以在不更改实体键的情况下更新实体的祖先？

我不相信。祖先是钥匙的一部分。

> 我将如何在 Go 中实现这一点？

您需要在这里使用实体组吗？我尽量避免实体组。他们增加了太多的限制。我建议您为公司和部门的员工实体添加属性：

```
type Employee struct {
  Company, Department string
} 
```

您仍然可以通过这些属性进行查询，尽管更新后可能会有几秒钟的延迟。如果您需要强一致性，您可以随时通过 Key 查找 Employee。这将始终返回最新版本。

# jquery - 无限滚动 - twitter facebook 如何“隐藏”额外数据

> ID：12239014
> 
> 赞同：2
> 
> 时间：2012-09-02T19:22:11.583
> 
> 标签：jquery, html, infinite-scroll

我一直在阅读并尝试实现各种形式的无限滚动，无论是在 jquery、django 还是两者的组合中。我正在使用 chrome 中的 firebug 扩展来跟踪当我滚动到页面底部并从我的数据库请求更多数据时所做的调用。每当我点击页面底部时，萤火虫都会显示一个额外的请求以获取更多数据。

在 twitter.com 和 facebook.com 上使用 firebug，我注意到当我使用无限滚动并滚动到页面底部时，即使加载了更多数据，firebug 中也没有显示其他请求。从安全的角度来看，我想这要好得多。**他们如何“隐藏”这些额外的请求？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T19:31:56.813

他们**不会**隐藏它。他们**确实**按需获取额外数据

* * *

您可以研究的可能方法是：-

1.  跟踪滚动事件以查看用户是否已[到达滚动末尾](https://stackoverflow.com/questions/3898130/how-to-check-if-a-user-has-scrolled-to-the-bottom)。
2.  `div`跟踪页脚（或底部的类似内容）何时[出现](http://remysharp.com/2009/01/26/element-in-view-event-plugin/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T19:33:38.147

在这些情况下，将结果拆分为不同的请求是有意义的，因为您不会预加载所有结果，而是预加载其中的一部分，因此渲染速度会更快。

在您的情况下，如果数据量不是很多，但您只想以呈现它们的方式处理它们，您可以将结果拆分为固定数量的块。您可以添加额外的结果块，直到每次向下滚动时它们都用完。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-02T19:32:50.970

额外的内容不会被隐藏——在 Facebook 中，当您接近页面末尾时，会进行 ajax 调用以获取新内容。

查看 Chrome 中的资源，调用此文件以加载额外内容 -

[https://www.facebook.com/ajax/pagelet/generic.php/MoreStoriesPagelet](https://www.facebook.com/ajax/pagelet/generic.php/MoreStoriesPagelet)

# c++ - 如何在 C++ 中附加一个整数（带整数）

> ID：12239015
> 
> 赞同：3
> 
> 时间：2012-09-02T19:22:14.533
> 
> 标签：c++, integer, append

我想知道是否有人可以告诉我如何在 C++ 中附加一个整数（带有另一个整数）。基本上，如果我有一个值为 67 的 int，我将如何在它后面加上数字 4，所以整数现在是 674？提前致谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-02T19:24:27.463

将第一个乘以十的第二个数字的幂，然后加上另一个。

示例：63 和 5

```
63*10=630
630+5 =635 
```

示例：75 和 34

```
75*100=7500
7500+34=7534
int i1=75;
int i2=34;
int dn=ceil(log10(i2+0.001));     //0.001 is for exact 10, exact 100, ...
int i3=i1*ceil(pow(10,dn)); <---- because pow would give 99.999999(for some optimization modes)
i3+=i2; 
```

**编辑：**字符串版本需要 2 个 int 到 str 的转换（很慢）和 1 个字符串连接（不快）和 1 个 str 到 int 的转换（很慢）。上转换需要 2 次加法、1 次对数、2 次上限、1 次幂、1 次乘法，所有这些都可以在 cpu 中完成，而无需接触主内存来获取/设置子步骤的数据，这肯定比字符串版本的延迟更短。如果编译器设计将 3-4 个字符串存储在 sse 寄存器中，那么两者都会竞争性能。因为当一个人忙于计算“power”函数时，另一个人忙于从 sse 中提取字符串并一个一个地放置必要的寄存器，并通过开始加法和乘法来构建另一个寄存器。Power(10,x) 函数可以换成 10*10*10.... x 次，所以纯数学版本再次变得更快。

如果您需要可读性，那么 eq- 的答案是最好的 imo。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-02T19:23:52.457

```
int appended = std::stoi(std::to_string(i1) + std::to_string(i2));
// error checking left as an exercise 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-02T19:28:32.997

```
#include <iostream>
#include <string>

int appendDigit(int base, int append) {
   std::string sBase = std::to_string(base);
   std::string sAppend = std::to_string(append);
   std::string result = sBase + sAppend;
   return std::stoi(result);

}

int main() {
   int a = 67;
   int b = 4;
   int c = appendDigit(a,b);
   std::cout << c;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-02T19:24:59.887

计算现有数字的位数，乘以它的十次方并添加到第二个数字。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-02T20:11:02.377

```
int append_digits(int i1, int i2) {
    int result = 0;
    while (i1) {
        result *= 10;
        result += i1 % 10;
        i1 /= 10;
    }
    while (i2) {
        result *= 10;
        result += i2 % 10;
        i2 /= 10;
    }
    int final_result = 0;
    while (result) {
        final_result *= 10;
        final_result += result % 10;
        result /= 10;
    }
    return final_result;
} 
```

重构以减少代码重复留给读者作为练习。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-02T20:13:43.687

这里有一个更严重的：

```
int append_digits(int i1, int i2) {
    int i2_copy = i2;
    while (i2_copy) {
        i1 *= 10;
        i2_copy /= 10;
    }
    return i1 + i2;
} 
```

这避免了浮点数学和字符串转换。

# google-maps - 隐藏/显示谷歌地图方向服务

> ID：12239016
> 
> 赞同：0
> 
> 时间：2012-09-02T19:22:22.053
> 
> 标签：google-maps

我使用谷歌地图方向服务在地图上显示巴士路线。因为许多路线重叠，我希望能够通过单击复选框来隐藏和显示。

我真的不确定它们是否可以像那样打开/关闭。

```
function fiveCLine(source,destination,waypoints){
        // show route between the points
        directionsService = new google.maps.DirectionsService();
        directionsDisplay = new google.maps.DirectionsRenderer(
        {
            suppressMarkers: false,
            suppressInfoWindows: true,
            polylineOptions: { strokeColor: '#0093f0', strokeOpacity: 1 },
            preserveViewport: true,
            markerOptions : {icon: 'bus5c.png'}
        });
        directionsDisplay.setMap(map);
        var request = {
            origin:source, 
            destination:destination,
            waypoints:waypoints,
            travelMode: google.maps.DirectionsTravelMode.DRIVING
        };
        directionsService.route(request, function(response, status) 
        {
            if (status == google.maps.DirectionsStatus.OK) 
            {
                directionsDisplay.setDirections(response);

            }
        });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-08T10:03:58.717

这可以使用类`setMap()`的方法来完成`google.maps.DirectionsRenderer`。来自 google docs：*此方法指定将在其上呈现方向的地图。通过`null`从地图中删除方向。*

例如，我使用按钮来切换路径：

```
function initialize() {
  directionsDisplay = new google.maps.DirectionsRenderer();
  ...
  directionsDisplay.setMap(map);
  ...

  var hideShowBtn = document.getElementById('togglePath');
  google.maps.event.addDomListener(hideShowBtn, 'click', hideShowPath);
}

function hideShowPath() {
    if (directionsDisplay.getMap()) {
        directionsDisplay.setMap(null);
    } else {
        directionsDisplay.setMap(map);
    }
} 
```

# objective-c - 如果小时数为零，如何使 NSDateFormatter 不包括小时数？

> ID：12239019
> 
> 赞同：3
> 
> 时间：2012-09-02T19:22:50.587
> 
> 标签：objective-c, ios, time, nsdate, nsdateformatter

我正在使用 NSDateFormatter 来格式化一段时间（[见这里](https://stackoverflow.com/q/8128083/515160)）。

我想使用这样的格式：“3 小时 15 分钟”。
这是我正在使用的格式字符串：`@"H' hours, 'm' minutes'"`.

问题是，对于短于一小时的持续时间，结果类似于“0 小时，35 分钟”。
在这种情况下，我只想显示“35 分钟”。

有没有办法告诉 NSDateFormatter 如果没有小时根本不显示时间，还是应该只使用 if 语句并手动构造字符串？

**编辑：**
我很清楚这很容易通过几行额外的手动完成，这就是我过去的做法。我只是想知道格式化程序是否有足够的智慧来自己处理这个问题，因为这似乎是一个常见问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-01-21T16:13:55.407

从 iOS 8.0 和 Mac OS X 10.10 (Yosemite) 开始，您可以使用`NSDateComponentsFormatter`. 因此，让我们使用小时和分钟作为`allowedUnits`（如您的示例）并`NSDateComponentsFormatterZeroFormattingBehaviorDropLeading`减少`zeroFormattingBehavior`零小时。例子：

```
NSTimeInterval intervalWithHours = 11700; // 3:15:00
NSTimeInterval intervalWithZeroHours = 2100; // 0:35:00
NSDateComponentsFormatter *formatter = [[NSDateComponentsFormatter alloc] init];
formatter.allowedUnits = NSCalendarUnitHour | NSCalendarUnitMinute;
formatter.unitsStyle = NSDateComponentsFormatterUnitsStyleFull;
formatter.zeroFormattingBehavior = NSDateComponentsFormatterZeroFormattingBehaviorDropLeading;
NSString *string = [formatter stringFromTimeInterval:intervalWithHours];
NSString *stringWithoutHours = [formatter stringFromTimeInterval:intervalWithZeroHours];
NSLog(@"%@ / %@", string, stringWithoutHours);
// output: 3 hours, 15 minutes / 35 minutes 
```

斯威夫特 5 版本：

```
let intervalWithHours: TimeInterval = 11700
let intervalWithZeroHours: TimeInterval = 2100
let formatter = DateComponentsFormatter()
formatter.allowedUnits = [.hour, .minute]
formatter.unitsStyle = .full
formatter.zeroFormattingBehavior = .dropLeading
if let string = formatter.string(from: intervalWithHours), let stringWithoutHours = formatter.string(from: intervalWithZeroHours) {
    print("\(string) / \(stringWithoutHours)")
    // output: "3 hours, 15 minutes / 35 minutes\n"
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T19:51:47.113

一旦你有了日期字符串（我们称之为*foo*），只需通过发送 stringByReplacingOccurencesOfString:withString: 来创建另一个字符串。例如：

```
NSString* foo = @"0 hours, 35 minutes";
NSString* bar = [foo stringByReplacingOccurrencesOfString:@"0 hours, " withString:@"" options:0 range:NSMakeRange(0,9)];
NSLog(@"%@",bar); 
```

输出是：

```
35 minutes 
```

我怀疑这与其他可能的方法相比是否非常有效，但除非您必须对数百个字符串执行此操作，否则它可能并不重要。

编辑：另外，如果您希望能够在没有 0 小时的情况下获得日期，并假设您使用的是 stringFromDate: 您可以添加一个类别来添加这样的方法：

```
- (NSString *)stringFromDateWithoutZeroHours:(NSDate *)date{
    result = [self stringFromDate:date];
    return [result stringByReplacingOccurrencesOfString:@"0 hours, " withString:@"" options:0 range:NSMakeRange(0,9)];
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-02T19:52:02.137

这是使用 NSCalendar 和 NSDateComponents 的一种方法：

```
static NSString *stringWithTimeInterval (NSTimeInterval interval)
{
    NSDate *referenceDate = [NSDate dateWithTimeIntervalSince1970:0];
    NSDate *intervalDate = [NSDate dateWithTimeIntervalSince1970:interval];

    NSCalendar *calendar = [NSCalendar currentCalendar];
    NSDateComponents *components = [calendar components:NSHourCalendarUnit|NSMinuteCalendarUnit fromDate:referenceDate toDate:intervalDate options:0];

    NSMutableArray *stringComponents = [NSMutableArray array];

    NSInteger hours = [components hour];
    NSInteger minutes = [components minute];

    if (hours > 0) {
        [stringComponents addObject:[NSString stringWithFormat:@"%ld hours", hours]];
    }
    [stringComponents addObject:[NSString stringWithFormat:@"%ld minutes", minutes]];

    return [stringComponents componentsJoinedByString:@" "];
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-02T19:36:30.257

为什么不为这种情况创建自己的 NSDateFormatter 子类并覆盖`stringFromDate`（如果这是您所调用的）？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-03T01:48:36.797

好的，我要从[Rob Mayoff](https://stackoverflow.com/a/8128243/581994)那里窃取一些代码：

他的原文（稍作修改）：

```
-(NSString*) doit:(NSTimeInterval)timeInterval {
    NSUInteger seconds = (NSUInteger)round(timeInterval);
    NSString *result = [NSString stringWithFormat:@"%u hours, %u minutes", seconds / 3600, (seconds / 60) % 60];
    return result;
} 
```

简单的修改以返回有/没有“小时”：

```
-(NSString*) doit:(NSTimeInterval)timeInterval {
    NSString* result = nil;
    NSUInteger seconds = (NSUInteger)round(timeInterval);
    NSUInteger hours = seconds / 3600;
    NSUInteger minutes = (seconds / 60) % 60;
    if (hours > 0) {
        result = [NSString stringWithFormat:@"%u hours, %u minutes", hours, minutes];
    }
    else {
        result = [NSString stringWithFormat:@"%u minutes", minutes];
    }
    return result;
} 
```

再次，但消除了`if`：

```
-(NSString*) doit:(NSTimeInterval)timeInterval {
    NSUInteger seconds = (NSUInteger)round(timeInterval);
    NSUInteger hours = seconds / 3600;
    NSUInteger minutes = (seconds / 60) % 60;
    NSString* result = hours ? [NSString stringWithFormat:@"%u hours, %u minutes", hours, minutes] : [NSString stringWithFormat:@"%u minutes", minutes];
    return result;
} 
```

现在，我可以使用 将其归结为一个荒谬的 1-liner `,`，但这有点愚蠢，并且不会使代码更清晰。

（请注意，由于 iOS 12/24 “fechure”，所有使用 NSDateFormatter 的方案都被破坏了。）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-10-10T12:16:30.283

根据@matt 的回答，我已经成功地使用他的方法来制作有条件的日期格式。在我的情况下，我只想要该月的第一天，否则就是一天。我需要为 CorePlot 提供一个日期格式化程序以进行轴格式化，并且它必须是有条件的。

```
@interface MyNSDateFormatter : NSDateFormatter
@property (nonatomic) NSDateFormatter *dateFormatterFirstDay;
@property (nonatomic) NSDateFormatter *dateFormatterTheRest;
@end

@implementation MyNSDateFormatter
-(id)init
{
    self = [super init];
    if(self != nil)
        {
        _dateFormatterFirstDay = [[NSDateFormatter alloc] init];
        _dateFormatterTheRest = [[NSDateFormatter alloc] init];

        [_dateFormatterFirstDay setDateFormat:@"MMM"];
        [_dateFormatterTheRest setDateFormat:@"d"];
    }
    return self;
}

-(NSString *)stringFromDate:(NSDate *)date
{
    NSDateComponents *dateComponents = [[NSCalendar currentCalendar] components:NSDayCalendarUnit fromDate:date];
    if ([dateComponents day] == 1) return [_dateFormatterFirstDay stringFromDate:date];
    else return [_dateFormatterTheRest stringFromDate:date];
}
@end 
```

# regex - 正则表达式提取标记之间的数字子串

> ID：12239021
> 
> 赞同：0
> 
> 时间：2012-09-02T19:22:53.843
> 
> 标签：regex

我想提取 a 之间倒数第二个最右边的 6 位数字；和 ？从一个字符串。这里有一些例子：

```
;10001080812?    --> 108081

;0009242340?     --> 924234 
```

请注意“倒数第二个”，因为不需要最后一个数字。
如果可以轻松更改我想要提取的位数，那就太好了。

这就是我到目前为止所得到的，它让我得到了不包括最后一位数字的数字

```
/(?<=\;)(.*?)(?=\d\?)/ 
```

但我真正想要的只是最右边的 6 位数字（或 X 位数字）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T19:52:54.720

试试这个正则表达式

```
\d{6}(?=\d\?) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T19:29:38.170

`^;[0-9]*[0-9]{n}[0-9]{m}\?$`

上面的正则表达式读取`n`数字但在末尾留下`m`数字（不会被读取）。

# objective-c - 表情符号和 CTFramesetterCreateWithAttributedString 错误

> ID：12239028
> 
> 赞同：1
> 
> 时间：2012-09-02T19:24:24.770
> 
> 标签：objective-c, core-text

当我看到那个时我很惊讶

```
CTFramesetterCreateWithAttributedString((__bridge CFAttributedStringRef)self.attributedString); 
```

当属性字符串包含表情符号时，导致我的应用程序无响应。

我提交了错误报告。同时我能做些什么作为快速修复？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T22:15:33.520

有时您需要“甜化”缓存。假设您使用的是 CGFontRef，让它呈现相同的表情符号字符。苹果通常会等到最后一刻才做一些代价高昂的事情。如果你知道你会需要它，如果你在早期强制工作，也许在一个线程中，然后当你需要这些字符时，它们将在某个地方呈现并缓存。

在我的应用程序中，在 applicationDidLaunch 中，我生成了一个执行类似操作的块。

编辑：在您的 applicationDidLaunch 中，获取 CTFontRef 到您稍后将用于渲染 Emoji 字符的字体。创建一大堆表情符号字符的属性字符串并将字体设置为您的 CTFontRef。采用：

```
CTFramesetterCreateWithAttributedString((__bridge CFAttributedStringRef)theAttributedString); 
```

让它（希望）使字体缓存变甜。当您第一次执行此操作时，可能会导致一些延迟，如您之前所见。没关系 - 我们只是想从您看到延迟的地方消除延迟。如果这确实有效，那么您可以将上面的代码放在一个调度块中，然后从 applicationDidLaunch 将其发送到默认队列。

如果问题是您的初始视图绘制速度很慢，因为它显示 Emoji 字符，那么您就不走运了。如果延迟是以后这样的技术可以工作。我有一个类似的问题。

# phpexcel - PHPExcel 数据条

> ID：12239035
> 
> 赞同：0
> 
> 时间：2012-09-02T19:25:03.757
> 
> 标签：phpexcel

我在单元格 A1:A5 中的 Excel 文件中有百分比日期，我想在这些单元格中放入带有渐变填充的数据条。我不知道怎么做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T21:49:17.360

要获得渐变填充背景：

```
$objPHPExcel->getActiveSheet()->getStyle('A1:C3')->applyFromArray(
        array(
            'fill' => array(
                'type'       => PHPExcel_Style_Fill::FILL_GRADIENT_LINEAR,
                'rotation'   => 90,
                'startcolor' => array(
                    'argb' => 'FFFF0000'
                ),
                'endcolor'   => array(
                    'argb' => 'FF0000FF'
                )
            )
        )
); 
```

如果您希望跨单元格的渐变填充线达到百分比级别，PHPExcel 不支持该功能。

# bash - 使用 GNU make 检查目录是否存在

> ID：12239036
> 
> 赞同：0
> 
> 时间：2012-09-02T19:25:11.633
> 
> 标签：bash, makefile

我将编译的所有目标文件转储到一个名为 `objfiles`

在编译时，我想检查目录 objfiles 是否存在，如果它不存在（表示重新编译整个项目），我想创建它。

这是我的 Makefile 和对问题的尝试

```
 SHELL := /bin/zsh
    #All object files are dumped into OBJDIR
    OBJDIR=objfiles
    OBJECTS=$(OBJDIR)/main.o \
            $(OBJDIR)/printdata.o \
            #...
            #...

   COMPILER=nvcc -arch=sm_20

   exec: objdir_exist $(OBJECTS)
        $(COMPILER) $(OBJECTS) -o exec
        @printf "\nExecutable updated!\n\n"

    $(OBJDIR)/main.o: main.cu octree.h
        $(COMPILER) -c $< -o $@

    $(OBJDIR)/printdata.o: printdata.cu  
        $(COMPILER) -c $< -o $@
    ...    

    #Clean-up executables and object files
    .PHONY=clean objdir_exist
    clean:
        rm exec 
        rm -r $(OBJDIR)

    # Check for the existence of object files. 
    # If it does not exist, then create another object_file directory to dump data to.
    # If it exists do nothing
   objdir_exist: 
        if [ ! -d "$(OBJDIR)" ] then mkdir $(OBJDIR)  fi 
```

我收到以下错误。

```
if [ ! -d "objfiles" ] then mkdir objfiles  fi
zsh:[:1: ']' expected
nvcc -arch=sm_20 -c main.cu -o objfiles/main.o
Assembler messages:
Fatal error: can't create objfiles/main.o: No such file or directory
make: *** [objfiles/main.o] Error 1 
```

我哪里错了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T19:27:18.293

问题在于，当您`if`在一行中写入时，您应该将`;`其用作行分隔符。

所以，更换

```
if [ ! -d "$(OBJDIR)" ] then mkdir $(OBJDIR)  fi 
```

经过

```
if [ ! -d "$(OBJDIR)" ]; then mkdir $(OBJDIR);  fi 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-02T19:32:11.450

更简单的是：

```
mkdir -p $(OBJDIR) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-11T17:34:59.617

我找到的解决方案是这样的

```
BIN=exec
OBJSDIR=objs

all: $(OBJSDIR) $(BIN)

$(OBJSDIR):
    if [ ! -d $(OBJSDIR) ]; then mkdir $(OBJSDIR); fi

$(OBJSDIR)/obj1.o: obj1.c header1.h
    # $< expands only to first prerequisite
    $(COMPILER) -c $< -o $@

$(OBJSDIR)/obj2.o: obj2.c header2.h
    $(COMPILER) -c $< -o $@

$(BIN): $(OBJSDIR)/obj1.o $(OBJSDIR)/obj2.o
    # $^ expands to all prerequisites
    $(COMPILER) $^ -o $@ 
```

一切都取决于 $(OBJSDIR) 和 $(BIN)。如果 $(OBJSDIR) 不存在，它会创建它。然后它继续检查 $(BIN) 并构建它，如果它不存在或者它的先决条件已经改变。

# c++ - spoj ARRAYSUB：O(n) 复杂度方法

> ID：12239042
> 
> 赞同：6
> 
> 时间：2012-09-02T19:26:14.403
> 
> 标签：c++, algorithm

我试图在 spoj [http://spoj.pl/problems/ARRAYSUB上解决这个问题](http://spoj.pl/problems/ARRAYSUB)

我用两种方法解决了它

首先使用优化的蛮力。其次在 k、2k、3k 等处取 Pivot 并找到最大值。

尽管在最坏的情况下两种解决方案都被接受，但复杂度为 O(n*k)；

**任何人都可以建议解决问题的 O(n) 解决方案。**

下面是我的运行接受的最坏情况复杂度 O(n*k) 的代码：

```
#include<iostream>
#include<cstdio>
#include<climits>
using namespace std;
main()
{
    long n;
    cin >> n;
    long *arr = new  long[n];
    for( long i=0;i<n;i++)
        cin >> arr[i];
     long k;
    cin >> k;
     long max=arr[0];
    for(long i=1;i<k;i++)
    {
        if(arr[i]>max)
            max=arr[i];
    }
    if(k!=n)
    cout<<max<<" ";
    else cout<<max;
    for( long i=k;i<n;i++)
    {
        if(arr[i-k]==max)
        {max=-1;
        for(int j=i-k+1;j<=i;j++)
        if(arr[j]>max)
        max=arr[j];
        if(i!=n)
        cout<<max<<" ";
        else cout<<max;

        }
        else{
        if(arr[i]>max)
        {   max=arr[i];

        if(i!=n)
        cout<<max<<" ";
        else 
        cout<<max;
        }
        else
        {
        if(i!=n)
        cout<<max<<" ";
        else cout<<max;}
        }
    }

        cout<<endl;
    return(0);
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-02T20:40:31.250

用于在 O(n) 时间内解决此问题的数据结构是“deque”

大多数人会想到的一种自然方式是尝试保持队列大小与窗口大小相同。尝试摆脱这种想法并尝试跳出框框思考。去除冗余元素并仅存储队列中需要考虑的元素是实现以下高效 O(n) 解决方案的关键。

```
 void maxInWindow(vector<int> &A, int n, int k, vector<int> &B) {
  deque<int> Q;
  for (int i = 0; i < k; i++) {
    while (!Q.empty() && A[i] >= A[Q.back()])
      Q.pop_back();
    Q.push_back(i);
  }
  for (int i = k; i < n; i++) {
    B[i-k] = A[Q.front()];
    while (!Q.empty() && A[i] >= A[Q.back()])
      Q.pop_back();
    while (!Q.empty() && Q.front() <= i-k)
      Q.pop_front();
    Q.push_back(i);
  }
  B[n-k] = A[Q.front()];
  //B stores the maximum of every contiguous sub-array of size k    
} 
```

解释 ：

第一个 for 循环计算前“k”个元素的最大值并将索引存储在 Q.front() 中。这变为 B[0] = A[index]。下一部分，如果 A[i] 大于之前存储的最大值，我们**从后面推送和弹出。**如果索引的值小于 ik，我们**从前面弹出，这意味着它不再相关。**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-18T13:25:14.903

一种比蛮力有效的方法是使用红黑树 (RB) 作为数据结构。因为 RB 树具有在 O(log n) 时间内插入、删除和查找最小值或最大值的特性，其中 n 是树中的节点数。

尽管 AVL 树具有相同的属性，但与 RB 树相比，隐藏在大 O 后面的常数很大。

问题的整体复杂性现在将变为 O(n lg k)。

首先在 RB Tree 中插入 k 个节点，然后使用 find max 得到最大元素。(2 * log k) 其次，我们删除插入的第一个元素，然后插入一个新元素，然后查询最大元素。(3 * log k)。按照相同的程序，我们大约需要 (3 * n * log k)。即 O(n* log k)。

目前，天真的蛮力解决方案没有被接受，但这个解决方案被接受了。

# python - 导入项目中定义的包时让 PyC harm 做自动提示

> ID：12239044
> 
> 赞同：0
> 
> 时间：2012-09-02T19:26:19.223
> 
> 标签：python, autocomplete, ide, autosuggest, pycharm

在指定项目中定义的包的导入时，有没有办法让 PyC​​harm 自动完成？

PyCharm 似乎对库包做自动完成就好了，但不是项目中定义的那些。

示例项目结构：

```
项目名称
 > 源
   > 包_1
     __init__.py
     包文件.py
   __init__.py
   source_1.py

```

如果在文件“source_1.py”中输入以下内容，则不会自动建议其余工作“package_1”：

```
来自帕卡

```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T20:20:05.357

在`Project`侧边栏中：

右键单击所需的文件夹（`src`在这种情况下）并从上下文菜单中选择 `Mark directory as`-> `Source root`。它会变成蓝色。

# mongodb - Mongodb 数据库架构设计与共享数据

> ID：12239045
> 
> 赞同：2
> 
> 时间：2012-09-02T19:26:36.763
> 
> 标签：mongodb, mongodb-java, mongodb-query

嗨，我是 mongodb 的新手。我正在使用 java。

我的关系表中有 4 个表租户、系统、授权。

像这样的东西。

```
Table            Fields

Tenant           Tenant_ID(PK), Tenant_INFO
System           System_ID(PK), System_Info
Authorization    System_ID, Autho_Info.
System_prop      System_ID, Prop_Info, Tenant_ID 
```

在 System_prop 表中，Tenant_ID 是指租户表 Tenant_ID (PK)，System_ID 是指系统表 System_ID。

在 Authorization 表中，System_ID 是指 System 表 System_ID

我正在将我的数据库从关系数据库切换到 mongodb。我需要做的第一件事是架构设计。

我需要做的查询是：

1.  SELECT A.Prop_Info, A.System_ID From System_prop A, SYSTEM B, TENANT C 其中 A.System_ID = B.System_ID AND A.Tenant_ID = C.Tenant_ID

2.  SELECT A.System_ID, A.Prop_Info FROM Authoization A, SYSTEM B WHERE A.System_ID = B.System_ID

谁能帮助我如何将这些表设计为 mongodb 中的集合？

我需要嵌入 r 使用 dbref 吗？帮助我为此设计架构。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T23:55:41.523

您的挑战来自`Prop_Info`两个查询都必须检索的事实。这使得很难确定它应该放在哪个 Mongo 集合中。

在 MongoDB 中，您创建文档模式的理想目标是让单个文档在给定查询模式的情况下获得所需的所有信息。如果您需要两个单独的查询针对两个单独的集合返回相同的数据`D`（例如在您的情况下） ，您必须在以下三种策略之间进行选择：`Prop_Info``A``B`

1.  复制`D`和 的文档，`A`并`B`强制与您的代码保持一致。这通常是高性能系统的设计选择，他们希望消除对第二次查询的需求，即使这会以插入/更新方面的额外代码复杂性为代价，并且由于 Mongo 不是 ACID，因此存在一些潜在的一致性问题。

2.  放入`D`并`A`存储一个引用（DBRef 或其他标识字段的组合），`B`以便您可以通过第二个查询获得它。`A`当查询数量超过查询数量时，这通常是设计选择`B`。它保持`D`本地到更频繁查询的集合。在这种模式设计模式中，您只需要在查询时进行第二次查询`B`。

3.  放入`D`一个新集合`C`并从 和 对其进行第二次`A`查询`B`。面对非常不确定的未来需求，这通常是设计选择，如果您采用上述 (1) 或 (2)，则不清楚权衡将是什么。它是最“类似关系”的模式，当您同时查询`A`和时会强制您进行第二次查询`B`。

您选择哪种策略取决于您的领域、查询模式、您从对象关系映射 (ORM) 框架中获得的支持（如果您使用的话），最后但并非最不重要的一点是您的偏好。

在我遇到的情况下，我从来没有选择（3）。我在高性能情况（分析系统）中使用过（1）。我在其他任何地方都使用过 (2)，因为查询访问模式已经清楚地表明了“共享”数据应该存在的位置。

选择策略后，如果您仍然需要帮助，请发布另一个 SO 问题，该问题专门针对给定策略的架构设计问题。

最后三个提示：

1.  如果共享数据`D`的关系多重性大于 1，则使用数组。您可以索引整个数组，并且可以使用[`$elemMatch`](http://www.mongodb.org/display/DOCS/Advanced+Queries#AdvancedQueries-%24elemMatch).

2.  要`D`在策略 (1) 或 (2) 中进行更新，请使用 MongoDB 的[原子修饰符操作](http://www.mongodb.org/display/DOCS/Updating?focusedCommentId=4554814#Updating-ModifierOperations)，其中许多操作旨在对数组进行操作。

3.  [这个 SO question](https://stackoverflow.com/questions/12207084/dbref-command-in-mongodb?rq=1)涵盖了@Stennie 答案中的 DBRef 两个查询模式。（@Stennie 适用于 10gen，MongoDB 的标记。）

祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T01:11:52.970

您可能只需要一个包含所有文档的集合，当然您最终会拥有太多重复的字段，但这是很好地扩展的技巧。对于一对多和一对一类型的关系，您只需删除标识符并放置其余属性，因为 MongoDB 将处理主键。（'我喜欢 MongoDB'）。

对于租户和系统之间的多对多关系，您必须将其更改为 MongoDB 数据结构中的数组。

```
coll{
Tenant : 'value',
tenant_info : 'value',
Sys_info: 'value' ,
auth_info: 'value' ,
Prop_info : array [ 'value','value',''value....]
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-02T23:22:02.603

您仍在考虑关系数据库。然而，MongoDB 是一个面向文档的数据库。

1.  通常不需要人工 ID 号，因为每个文档都会自动有一个 _id 字段，它是一个 GUID（保证全局唯一）。
2.  关系表不应该在 MongoDB 中使用。n 型关系是用数组字段代替的。因此，当 1 个系统有 N 个它使用的授权时，您的系统文档应该有一个“授权”字段，它是它拥有的授权的对象 ID 的数组。是的，这将严重违反关系数据库的规范化规则。但是这里没有关系数据库。在 MongoDB 中，用数组表示 N 关系是很实用的，因为数组对查询语言是透明的。

# javascript - 将 Excel BLOB 转换为 javascript 数组

> ID：12239050
> 
> 赞同：1
> 
> 时间：2012-09-02T19:27:26.657
> 
> 标签：javascript, excel, blob, google-apps-script, xls

使用 Google Apps 脚本，我试图提取 Excel 文件 (.xls) 的单元格内容（作为 Gmail 附件提供）并将这些单元格联系人存入二维 javascript 数组[][]。

```
var excelFile = GmailApp.getInboxThreads(0,1)[0].getMessages()[0].getAttachments()[0]; 
```

此时，我有一个 ContentType = "application/vnd.ms-excel" 的 BLOB。

如何将此“Excel”blob 转换为我可以使用的二维（Google Apps 脚本/javascript）数组？

说明性说明：我只想使用 Google Apps 脚本/javascript来执行[此处描述的操作。](http://www.birt-exchange.org/org/wiki/index.php?title=Reading,_parsing,_and_extracting_data_from_Excel_files#Read_from_BLOB)

更新：以我所描述的方式完成此任务的方法似乎很少。以不同的方式处理它，也许我可以（以编程方式）将 Excel 文件转换为 Google Drive 电子表格？然后使用 Google Apps 脚本进行数据提取是微不足道的。也许 Google 支持人员可以解释如何使用 Google Apps 脚本以编程方式将 Gmail 附件中的 Excel 文件转换为 Google Drive 电子表格？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T05:09:48.497

您现在无法使用 Apps 脚本执行此操作，但有一个[未解决的问题](http://code.google.com/p/google-apps-script-issues/issues/detail?id=1019)要求此功能。您可以为该问题加注星标以对其进行投票并收到更新通知。

# php - 如何从数组自动构建变量？

> ID：12239051
> 
> 赞同：3
> 
> 时间：2012-09-02T19:27:43.770
> 
> 标签：php

我想实例化一个类，它需要任意数量的构造函数参数。

假设我有一个类 Man，它在构造函数中有两个参数。

```
class Man
{
    protected $name;
    protected $age;

    public function __construct($name, $age)
    {
        $this->name = $name;
        $this->age = $age;
    }
} 
```

然后我有参数：

```
$params = array()
$params['name'] = 'Jack';
$params['age'] = 55; 
```

这就是我实例化一个类的方式：

```
$jack = new Man($params['name'], $params['age']); 
```

现在我想要实现的是 params 数组可以是任意大小，2、3、4、任何大小，并且我要实例化的类将具有相同数量的参数。

所以唯一困扰我的是如何自动创建变量？有提取功能，但它返回变量的数量:(

我需要这样的东西：

```
$jack = new Man($name, $age); 
```

但这应该是自动创建的。该脚本只知道 params 数组，它需要将所有数组值作为变量推送。

最接近的事情是这样的：

```
$jack = new Man(extract($params)); 
```

但是提取函数返回数字，我需要从数组中创建变量，并将它们提供给类构造函数。

编辑：

我无法更改正在构建的类，我唯一​​的目标是构建该类，并在构造函数中传递它期望的变量。所以我对我建立的类没有权力，我的目标是只实例化那个类，并给她的构造函数参数。这些参数存储在 $params 数组中，但类需要它作为变量。希望它更容易掌握我想要实现的目标。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T19:29:42.730

您可以执行以下两项操作之一：

1.  传入参数数组：

    ```
    public function __construct(array $params) {} 
    ```

2.  在函数内部使用`func_get_args()`以获取关联数组形式的所有参数。

第一种方法更可取，因为它包含的“魔法”较少。

为了调用具有未知参数集的函数，当参数为数组形式时，您可以使用`call_user_func_array()`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T19:35:35.000

我会将数组传递给构造函数：

```
$jack = new Man($params); 
```

然后在构造函数中处理参数：

```
class Man
{
  public $Age;

  public function __construct( array $params )
  {
     foreach( $params as $key => $value ) {
       if( property_exists( $this, $key ) {
         $this->$key = $value;
       }
     }
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-02T19:35:50.277

是的，extract 将返回变量的数量，但也会创建变量。您必须编写类，以便将数组作为输入，然后从类中调用 extract。这将使用设置为数组每个元素的标签的名称创建变量。

- 编辑 -

在看到问题的变化后，我修改了一个更准确的答案。

- 例子 -

```
$params = array();  
$params['name'] = 'Jack';  
$params['age'] = 55;  

$jack = createMan($params);

//Function designed to extract correct parameters from $params

function createMan($params){

    extract($params);

    if(isset($name) && isset($age)){
        return new man($name, $age);
    }else{
        //What ever error logging and return null
        return null;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-02T20:35:09.303

我需要的是这样的：

[反射类::newInstanceArgs](http://www.php.net/manual/en/reflectionclass.newinstanceargs.php)

So the solution to my problem is this:

```
$reflection = new \ReflectionClass($class); 
return $reflection->newInstanceArgs($params); 
```

Where $params is array with params, and $class is name of the class Im building.

Thanks for all the comments!

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-09-02T19:30:59.350

遍历您的数组，并使用`$obj->{$keyname}`语法设置您的类的属性。

```
public function __construct($params) {
    foreach($params as $key => $value) {
        $this->$key = $value;
    }
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-09-02T19:36:41.913

这可能会有所帮助：

```
class man{
   public function __construct($params){
      foreach($params as $key=>$value){
       $this->$key=$value;
      }
   }
} 
```

这样，数组键将被分配为变量。

# windows-phone-7 - 在 Bing 地图中平移和缩放

> ID：12239052
> 
> 赞同：0
> 
> 时间：2012-09-02T19:27:58.497
> 
> 标签：windows-phone-7, bing-maps, zooming, panning

我想计算用户在使用 bing 地图（我使用的是 windows phone 7 平台）时所做的平移和缩放量（以纬度/经度或像素为单位）。任何解决该问题的建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T02:04:46.053

找到了解决方案：

```
Map map = new Map();
map.MapPan += new EventHandler<MapDragEventArgs>(map_MapPan);
map.MapZoom += new EventHandler<MapZoomEventArgs>(map_MapZoom);

   void map_MapZoom(object sender, MapZoomEventArgs e)
    {
        if (e.ZoomDelta >= 0)
            totalZoomInDelta += Math.Round(e.ZoomDelta, 2);
        else
            totalZoomOutDelta += Math.Abs(Math.Round(e.ZoomDelta, 2));
    }

    void map_MapPan(object sender, MapDragEventArgs e)
    {

       totalAbsDragDeltaX += Math.Abs(e.DragDelta.X);
       totalAbsDragDeltaY += Math.Abs(e.DragDelta.Y);

       totalDragDeltaX += e.DragDelta.X;
       totalDragDeltaY += e.DragDelta.Y;

       totalDragDelta += Math.Sqrt(e.DragDelta.X * e.DragDelta.X + e.DragDelta.Y * e.DragDelta.Y);
    } 
```

# c++ - 通过默认构造函数插入数据后，我没有得到任何输出，但我不确定为什么不

> ID：12239055
> 
> 赞同：1
> 
> 时间：2012-09-02T19:28:29.463
> 
> 标签：c++, oop

所以我使用默认构造函数将单个条目插入内存，然后通过调用`getBookInfo()`方法读取它们。当我尝试只使用一个变量进行测试运行时，即使我`getBookInfo()`在插入数据后调用，我也没有得到任何东西。

这是为什么？

主文件

```
#include <iostream>
using namespace std;

#include "Book.h"

void main()
{
    Book book;

    book.setTitle("Advanced C++ Programming");
    book.setAuthorName("Linda", "Smith");
    book.setPublisher("Microsoft Press", "One Microsoft Way", "Redmond");
    book.setPrice(49.99);
    book.getBookInfo(); // <-= this should be output

    int i;
    cin >> i;
}; 
```

书本.cpp

```
#include <iostream>
#include <sstream>
using namespace std;

#include "Book.h"

Book::Book()
{
}

void Book::setTitle(string  title)
{
    title = title;
}

void Book::setPrice(double price)
{
    price = price;
}

string Book::convertDoubleToString(double number)
{
    return static_cast<ostringstream*>( &(ostringstream() << number) ) -> str();
}

// this should be output
string Book::getBookInfo()
{
    stringstream ss;
    ss << title << endl << convertDoubleToString(price) << endl;

    return ss.str();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T19:33:20.227

改变

```
void Book::setTitle(string  title)
{
    title = title;
} 
```

到

```
void Book::setTitle(string  title)
{
    this->title = title;
} 
```

并且无论在哪里出现这种代码，都会发生相同的变化。如所写，代码将参数的值分配给`title`参数`title`，即它什么也不做。编译器可能会警告您这一点。

或者，正如@hmjd 所说，更改参数的名称。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T19:32:07.023

您需要捕获从 getBootInfo() 返回的数据，例如

```
string result = book.GetBookInfo();
cout << result; 
```

# javascript - 如何使用 travis-ci 或 grunt 来测试不同版本的脚本

> ID：12239057
> 
> 赞同：7
> 
> 时间：2012-09-02T19:28:38.323
> 
> 标签：javascript, travis-ci, gruntjs

我正在使用 Travis-CI 以编程方式（使用 Gruntjs）对前端 javascript 代码进行 lint 和测试。

我的问题是，如果我构建了一个插件并且我想在多个版本的脚本上对其进行测试，我该如何管理呢？

例如，一个简单的用例是，如果我构建一个 jQuery 插件，我可以要求 grunt 或 travis 使用 1.6、1.7 和 1.8 版本通过测试运行它吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T04:40:20.613

我使用来自[http://manuelvanrijn.nl/blog/2012/06/22/integrate-travis-ci-into-grunt/](http://manuelvanrijn.nl/blog/2012/06/22/integrate-travis-ci-into-grunt/)的说明来使 Travis-CI 集成正常工作。

对于多个 jQuery 版本，请查看 jQuery 验证是如何做到的[https://github.com/jzaefferer/jquery-validation/blob/master/test/index.html](https://github.com/jzaefferer/jquery-validation/blob/master/test/index.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-06-08T00:36:28.053

在 travis.ci 上，最好的解决方案是使用他们的构建矩阵。

例如，使用环境变量存储要使用的版本，您可以在之后指定特定版本`npm install`：

```
env:
  - JQUERY=1.11
  - JQUERY=2.2
  - JQUERY=3.0.0-beta1
install:
  - npm install
  - npm install jquery@$JQUERY 
```

# android - 错误“令牌上的语法错误、错误的构造、此令牌 MainActivity.java 后预期的 VariableDeclaratorId”

> ID：12239066
> 
> 赞同：0
> 
> 时间：2012-09-02T19:30:05.783
> 
> 标签：android

```
package com.example.temp_application;

import java.util.ArrayList;

import android.app.Activity;
import android.os.Bundle;
import android.view.Menu;
import android.widget.ArrayAdapter;
import android.widget.EditText;
import android.widget.ListView;

public class MainActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

    final ListView myLV = (ListView)findViewById(R.id.myLV);
    final EditText myET = (EditText)findViewById(R.id.myET);

    final ArrayList<String> todoList = new ArrayList<String>();
    final ArrayAdapter<String> aa = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, todoList);

    myLV.setAdapter(aa);
} 
```

我收到错误：

> 令牌上的语法错误、错位的构造、令牌“aa”上的语法错误、此令牌 MainActivity.java 后预期的 VariableDeclaratorId

在这条线上

```
myLV.setAdapter(aa); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T19:33:29.467

将此代码*放在* 您的 onCreate() 方法中：

```
final ListView myLV = (ListView)findViewById(R.id.myLV);
final EditText myET = (EditText)findViewById(R.id.myET);

final ArrayList<String> todoList = new ArrayList<String>();
final ArrayAdapter<String> aa = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, todoList);

myLV.setAdapter(aa); 
```

要清楚：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    // The above code goes here
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T19:33:19.067

在您的情况下，应在 onCreate() 方法中完成变量的初始化

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T19:33:29.343

有问题的行不在函数体中：

```
myLV.setAdapter(aa); 
```

您可能希望将该行和变量声明移到`onCreate()`函数中。

# google-apps - Google Hangout XML - 如何包含 Drive (Docs) 或 You-Tube 应用程序？

> ID：12239074
> 
> 赞同：0
> 
> 时间：2012-09-02T19:31:27.827
> 
> 标签：google-apps, hangout

我是创建 Google Hangouts 和使用 XML 文件和 API 的新手。有人可以解释如何在环聊的导航栏中包含 Drive/Docs 或其他 Google Apps 吗？我已经创建了简单的环聊应用程序，并正在尝试对其进行自定义。我正在使用开发者沙盒打开环聊。XML 文件部署在公开可用的服务器上。我希望该应用具有与使用 Google+ 入门工具包创建的大部分相同的功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T21:46:19.473

您是否阅读过[文档](https://developers.google.com/+/hangouts/)？一旦您掌握了如何构建环聊的基础知识，Google Drive 或 YouTube 等每项服务都有自己的细节，说明如何将它们集成到第三方应用程序中。您可以在 Google Developer Site 上阅读有关[YouTube](https://developers.google.com/youtube/)和[Google Drive的更多信息。](https://developers.google.com/drive/)

# ios - 运行应用程序时出现“Apple Mach-O 链接器错误”

> ID：12239077
> 
> 赞同：1
> 
> 时间：2012-09-02T19:31:40.327
> 
> 标签：ios, xcode, ios5

有人能告诉我为什么我得到
`Undefined symbols for architecture i386: "_OBJC_CLASS_$_ScramblerModel", referenced from: objc-class-ref in ViewController.o ld: symbol(s) not found for architecture i386 clang: error: linker command failed with exit code 1 (use -v to see invocation)` 我的项目在[这个 zip](http://www.scramblr.us/xcode/Scramblr.zip)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T19:42:46.767

您的代码显然引用了此类`ScramblerModel`，但您尚未`ScramblerModel.m`在项目中包含该文件。

所以，首先，如果你看一下你的`Compile Sources`，它会说：

![不包括模型](../Images/8bb2e6fec424dcf400578038a61707b6.png)

继续并在添加您的模型时单击“+”按钮。您可能也想为 执行此操作`ScramblerPlayer`，因为您也使用该类，所以如果您不添加它，您将收到另一个链接器错误。

![现在添加了扰频器模型](../Images/db8ce269b7c461f7bb93a77c3d84f179.png)

其次，不要忘记告诉应用程序使用什么故事板：

![故事板](../Images/0993f3f2bf996c9cedcd167ca97c460d.png)

第三，您的 .h 为您的所有属性定义了实例变量 (ivars) `IBOutlet`。这是一个问题，因为您的`@synthesize`语句使用前导下划线实例化 ivars，但您的 .h （和您的代码）指的是没有连接到任何东西的重复 ivars。例如，你有一个属性`remainingTime`，你有一个`@synthesize remainingTime = _remainingTime`（正在创建一个`_remainingTime`ivar）。因此，您明确声明的 ivar`remainingTime`未连接到您的`remainingTime`属性，因此如果您使用该 ivar，则不会导致用户界面更新，尽管名称相似。

您可以通过 (a) 摆脱为您的属性显式声明的 ivars 来解决问题并简化您的代码；(b) 更改您的代码以引用该属性，例如`self.remainingTime`或 ivar `_remainingTime`。因此，您的 .h 被简化并变为：

```
//
//  ViewController.h
//  Scrambler
//
//  Created by Alex Grossman on 8/26/12.
//  Copyright (c) 2012 Alex Grossman. All rights reserved.
//

#import <UIKit/UIKit.h>

@class ScramblerModel;

@interface ViewController : UIViewController{
    ScramblerModel* gameModel;
    NSTimer* gameTimer;
}
@property (weak, nonatomic) IBOutlet UILabel *high;
@property (weak, nonatomic) IBOutlet UIBarButtonItem *skipButton;
@property (weak, nonatomic) IBOutlet UIBarButtonItem *restartButton;
@property (weak, nonatomic) IBOutlet UILabel *playerScore;
@property (weak, nonatomic) IBOutlet UILabel *remainingTime;
@property (weak, nonatomic) IBOutlet UILabel *scrambledWord;
@property (weak, nonatomic) IBOutlet UITextField *guessTxt;

-(IBAction)guessTap:(id)sender;
-(IBAction)restart:(id)sender;
-(IBAction)skip:(id)sender;
-(IBAction)category:(id)sender;
-(void) endGameWithMessage:(NSString*) message;

@end 
```

但是，当您编译项目时，您会遇到很多错误，因为您的代码错误地引用了那些旧的、冗余的（和错误命名的）ivars。因此，例如，在你的`viewDidLoad`你有这样的行：

```
remainingTime.text = [NSString stringWithFormat:@"%i", gameModel.time];
playerScore.text = [NSString stringWithFormat:@"%i", gameModel.score]; 
```

那些应该是：

```
self.remainingTime.text = [NSString stringWithFormat:@"%i", gameModel.time];
self.playerScore.text = [NSString stringWithFormat:@"%i", gameModel.score]; 
```

只需对您提到错误的 ivars 的任何地方重复此更正即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T19:43:05.337

如果您忘记将它们添加到您的项目构建阶段，您将收到错误“架构 i386 的未定义符号”。因此，将您的实现文件添加到 Compile Sources，并将 Xib 文件添加到 Copy Bundle Resources。

```
Go to Scramblr Project -> Targets (Scrambl) -> Build Phases -> Complite Sources -> Add a ScramblerModel.m and ScramblerPlayer.m 
```

# python - 语音识别和 python 入门

> ID：12239080
> 
> 赞同：26
> 
> 时间：2012-09-02T19:31:59.047
> 
> 标签：python, speech-to-text

我想知道从哪里可以开始使用语音识别。不是图书馆或任何相当“黑盒”的东西，而是我想知道我在哪里可以实际制作一个简单的语音识别脚本。我做了一些搜索，发现并不多，但我看到的是有“声音”或音节的字典可以拼凑成文本。所以基本上我的问题是我可以从哪里开始？

此外，由于这有点乐观，我也可以在我的程序中使用一个库（目前）。我看到一些文本库和 API 的语音只吐出一个结果。这没关系，但这将是不现实的。我当前的程序已经检查了输入的任何文本的语法和所有内容，所以如果我要说，前十名来自语音到文本软件的结果，而不是它可以检查每一个并排除任何没有意义的内容.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-02T21:38:23.100

如果您真的想从头开始理解语音识别，请为 python 寻找一个好的信号处理包，然后*独立*于软件阅读语音识别。

但是语音识别是一个极其复杂的问题（主要是因为我们说话时声音会以各种方式相互作用）。即使您从可以获得的最好的语音识别库开始，您也绝不会发现自己无事可做。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-05-14T19:33:45.870

## 更新：这不再起作用

因为谷歌关闭了它的平台

--

你可以使用[https://pypi.python.org/pypi/pygsr](https://pypi.python.org/pypi/pygsr)

```
$> pip install pygsr 
```

示例用法：

```
from pygsr import Pygsr
speech = Pygsr()
# duration in seconds
speech.record(3)
# select the language
phrase, complete_response = speech.speech_to_text('en_US')

print phrase 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-06-23T17:05:21.683

Pocketsphinx 也是一个不错的选择。通过 SWIG 提供的 Python 绑定可以轻松集成到脚本中。

例如：

```
from os import environ, path
from itertools import izip

from pocketsphinx import *
from sphinxbase import *

MODELDIR = "../../../model"
DATADIR = "../../../test/data"

# Create a decoder with certain model
config = Decoder.default_config()
config.set_string('-hmm', path.join(MODELDIR, 'hmm/en_US/hub4wsj_sc_8k'))
config.set_string('-lm', path.join(MODELDIR, 'lm/en_US/hub4.5000.DMP'))
config.set_string('-dict', path.join(MODELDIR, 'lm/en_US/hub4.5000.dic'))
decoder = Decoder(config)

# Decode static file.
decoder.decode_raw(open(path.join(DATADIR, 'goforward.raw'), 'rb'))

# Retrieve hypothesis.
hypothesis = decoder.hyp()
print 'Best hypothesis: ', hypothesis.best_score, hypothesis.hypstr

print 'Best hypothesis segments: ', [seg.word for seg in decoder.seg()]

# Access N best decodings.
print 'Best 10 hypothesis: '
for best, i in izip(decoder.nbest(), range(10)):
    print best.hyp().best_score, best.hyp().hypstr

# Decode streaming data.
decoder = Decoder(config)
decoder.start_utt('goforward')
stream = open(path.join(DATADIR, 'goforward.raw'), 'rb')
while True:
    buf = stream.read(1024)
    if buf:
        decoder.process_raw(buf, False, False)
    else:
        break
decoder.end_utt()
print 'Stream decoding result:', decoder.hyp().hypstr 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2015-12-25T09:42:18.617

我知道这个问题很旧，但只适用于未来的人：

我使用`speech_recognition`-Module，我喜欢它。~~唯一的问题是，它需要互联网，因为它使用 Google 来识别语音。但这在大多数情况下应该不是问题。~~识别工作几乎完美。

**编辑：**

该`speech_recognition`软件包不仅可以使用 google 进行翻译，还包括 CMUsphinx（允许离线识别）等。唯一的区别是识别命令的细微变化：

[https://pypi.python.org/pypi/SpeechRecognition/](https://pypi.python.org/pypi/SpeechRecognition/)

这是一个小代码示例：

```
import speech_recognition as sr

r = sr.Recognizer()
with sr.Microphone() as source:                # use the default microphone as the audio source
    audio = r.listen(source)                   # listen for the first phrase and extract it into audio data

try:
    print("You said " + r.recognize_google(audio))    # recognize speech using Google Speech Recognition - ONLINE
    print("You said " + r.recognize_sphinx(audio))    # recognize speech using CMUsphinx Speech Recognition - OFFLINE
except LookupError:                            # speech is unintelligible
    print("Could not understand audio") 
```

只有一件事对我来说效果不佳：在无限循环中聆听。几分钟后挂断。（它没有崩溃，只是没有响应。）

编辑：如果你想使用没有无限循环的麦克风，你应该指定录音长度。示例代码：

```
import speech_recognition as sr

r = sr.Recognizer()
with sr.Microphone() as source:
    print("Speak:")
    audio = r.listen(source, None, "time_to_record")  # recording 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2015-12-17T09:05:03.537

对于那些想深入了解 Python 语音识别主题的人，这里有一些链接：

*   [http://www.slideshare.net/mchua/sigproc-selfstudy-17323823](http://www.slideshare.net/mchua/sigproc-selfstudy-17323823) - Python 中的信号处理，包括最有趣的音频信号。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-09-02T20:04:33.847

[Dragonfly](http://code.google.com/p/dragonfly/)为 Windows 上的语音识别提供了一个干净的框架。检查他们的[文档](http://packages.python.org/dragonfly/)以获取示例用法。由于您不是在寻找 Dragonfly 提供的大规模功能，您可能想看看不再维护的[PySpeech](http://code.google.com/p/pyspeech/)库。

他们的源代码看起来很容易理解，也许这就是您首先要查看的内容

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-01-06T17:37:23.090

> 这可能是最重要的学习内容：信号处理的基本概念，特别是数字信号处理 (DSP)。对抽象概念的一点了解将使您为 scipy.signal 中令人眼花缭乱的工具做好准备。
> 
> 首先是模数转换（ADC）。这确实属于音频工程领域，并且现在是录音过程的一部分，即使您所做的只是将麦克风连接到您的计算机。
> 
> 如果您从模拟录音开始，这可能是将旧磁带或黑胶长播放记录转换为数字形式，或从旧录像带中提取音频的问题。最简单的方法是将源播放到计算机的音频输入插孔中，然后使用内置的硬件和软件将原始线性脉冲编码调制 (LPCM) 数字信号捕获到文件中。你提到的 Audacity 是一个很好的工具，甚至更多。
> 
> 傅里叶变换是你的朋友。在数据科学术语中，它非常适合特征提取和特征空间降维，特别是如果您正在寻找跨越整个样本过程中声音变化的特征。这里没有篇幅解释，但机器学习算法处理时域中的原始数据比处理频域中的原始数据要困难得多。
> 
> 特别是，您将使用快速傅里叶变换 (FFT)，这是一种非常有效的离散傅里叶变换 (DFT) 形式。如今，FFT 通常在 DSP 硬件中完成。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-01-30T12:51:50.880

```
import speech_recognition as SRG 
import time
store = SRG.Recognizer()
with SRG.Microphone() as s:

    print("Speak...")

    audio_input = store.record(s, duration=7)
    print("Recording time:",time.strftime("%I:%M:%S"))

    try:
        text_output = store.recognize_google(audio_input)
        print("Text converted from audio:\n")
        print(text_output)
        print("Finished!!")

        print("Execution time:",time.strftime("%I:%M:%S"))
    except:
           print("Couldn't process the audio input.") 
```

这应该有效。您会将默认麦克风的音频输入保存到 text_output 变量中的文本格式中。您可以查看此链接了解更多信息：[https ://www.journaldev.com/37873/python-speech-to-text-speechrecognition](https://www.journaldev.com/37873/python-speech-to-text-speechrecognition)

我们基本上做的是首先记录来自麦克风的音频，然后我们使用该音频作为语音识别器的输入。这里唯一的事情是您需要有效的互联网连接以及这两个必需的 python 库 `speech_recognition`和`pyaudio`.

# css - 基于 Dust-Me 删除（不是搜索！）未使用的 CSS 选择器

> ID：12239082
> 
> 赞同：4
> 
> 时间：2012-09-02T19:32:05.693
> 
> 标签：css, twitter-bootstrap

Dust-Me(http://www.sitepoint.com/dustmeselectors/) 在识别未使用的 CSS 选择器方面做得很好，但现在我需要删除它们。Dust-Me 生成一个 .CSV 枚举这些选择器，但棘手的部分是实际删除它们。我有 1200 个未使用的选择器，手动移除这些选择器会让我发疯。有没有办法自动化删除过程？或者是否有任何其他应用程序可以删除未使用的 CSS/重新生成 CSS？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-11T13:55:01.403

试试[ReduceCSS](http://www.reducecss.com/)，我认为这是一个工具。识别未使用的 CSS 选择器并保持干净的文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-21T10:04:38.183

+1 用于 CSS 使用 Firefox/Firebug 扩展。[https://addons.mozilla.org/firefox/addon/css-usage/](https://addons.mozilla.org/firefox/addon/css-usage/)

至于 jperelli 上面的评论：您可以使用能够根据正则表达式进行查找/替换的工具来仅删除标有“未使用”的选择器。

我使用了 Grant Skinners 优秀的正则表达式（[http://www.regexr.com/](http://www.regexr.com/)）来提出一个表达式：

未使用（[\s\S][^}]*}）

可以使用此方法的工具包括例如 notepad++ 或 Netbeans。

希望有帮助，

塞巴斯蒂安

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T07:09:44.053

测试[CSS 使用](https://addons.mozilla.org/firefox/addon/css-usage/)Firefox 扩展（需要 FireBug）。
它的工作与 Dust-Me 相同，并提供干净的文件。
不幸的是，这些工具不是很精确......保留备份！

# php - 为什么我的组合框在由 SQL 查询填充时只显示一个值

> ID：12239092
> 
> 赞同：0
> 
> 时间：2012-09-02T19:33:23.887
> 
> 标签：php, sql

我正在使用带有 smarty 的 tpl 系统，当我尝试使组合框具有多个选择时，即使查询中有多个值，我也只能选择一个。

概述2.php：

```
 $smarty->assign("MYTEAM", $team->myteam);
 $smarty->assign("MYTEAMID", $team->myteamid);
 $overview2_tpl = $smarty->fetch("overview2.tpl");
 $smarty->assign("CONTENT", $overview2_tpl); 
```

概述2.tpl：

```
<select name="HScorer1" style="width: 20%;">
<option value ="{$MYTEAMID}" >{$MYTEAM}</option>
</select> 
```

类.team.php：

```
var $myteam;
var $myteamid;

$test=$_SESSION['tid'];

function team_class($id, $league){
global $db;
    $sql = "SELECT * FROM l1_player where team_id='$test'";
    $mytmp = $db->query_first($sql);
            $this->myteam = $mytmp['player_2name'];
            $this->myteamid = $mytmp['player_id'];
} 
```

该表包含多行，其中 team_id=$test 带有 player_2name 和 player_id 但在选项/组合框中它只显示一个名称，无论如何我可以让它显示所有值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T19:40:23.313

`$db->query_first`不是一个巨大的 SMARTY 专家，但如果只返回结果集的第一行就有意义了。您可能正在寻找不同的方法。

# java - 使用 JTransforms 库通过 FFT 计算自相关

> ID：12239096
> 
> 赞同：10
> 
> 时间：2012-09-02T19:33:36.640
> 
> 标签：java, fft, time-series, correlation

我正在尝试使用下面的代码计算时间序列中示例窗口的自相关。我将 FFT 应用于该窗口，然后计算实部和虚部的大小并将虚部设置为零，最后对其进行逆变换以获得自相关：

```
DoubleFFT_1D fft = new DoubleFFT_1D(magCnt);
fft.realForward(magFFT);

magFFT[0] = (magFFT[0] * magFFT[0]);
for (int i = 1; i < (magCnt - (magCnt%2)) / 2; i++) {
    magFFT[2*i] = magFFT[2*i] * magFFT[2*i] + magFFT[2*i + 1] * magFFT[2*i + 1];
    magFFT[2*i + 1] = 0.0;
}

if (magCnt % 2 == 0) {
    magFFT[1] = (magFFT[1] * magFFT[1]);
} else {
    magFFT[magCnt/2] = (magFFT[magCnt-1] * magFFT[magCnt-1] + magFFT[1] * magFFT[1]);
}

autocorr = new double[magCnt];
System.arraycopy(magFFT, 0, autocorr, 0, magCnt);
DoubleFFT_1D ifft = new DoubleFFT_1D(magCnt);
ifft.realInverse(autocorr, false);

for (int i = 1; i < autocorr.length; i++)
    autocorr[i] /= autocorr[0];
autocorr[0] = 1.0; 
```

第一个问题是：可以看出这段代码将自相关结果映射到`[0,1]`范围，虽然相关性应该在-1和1之间。当然很容易将结果映射到`[-1,1]`范围，但我不确定这个映射是否是正确的。我们如何解释结果`autocorr`数组中的值？

其次，使用这段代码，我在一些周期性序列中得到了很好的结果，也就是说，我根据信号的周期为特定的自相关指数获得了更高的值。但是，当我将其应用于非周期性信号时，结果变得很奇怪：`autocorr`数组中的所有值似乎都非常接近 1。这是什么原因？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T05:20:36.173

要使基于 FFT 的算法起作用，您必须特别注意定义，包括您正在使用的库的约定。您似乎混淆了 AC 的“信号处理”约定和“统计”约定。然后是 FFT 环绕和零填充。

这是一个适用于偶数 N 情况的代码，信号处理约定。它针对蛮力包装的自相关进行了测试。注释显示了如何将其转换为信号处理约定。对于统计 ac，减去数据的平均值。这可以通过将 FFT 的“0Hz”分量归零来完成。那么 ac 的第零个元素就是方差，你可以通过除以这个量来归一化。如您所说，结果值将落在 -1..1 中。

您的代码似乎在进行除法运算，但并未忽略数据的 0 Hz 分量。所以它正在计算某种约定的混搭。

```
import edu.emory.mathcs.jtransforms.fft.DoubleFFT_1D;
import java.util.Arrays;

public class TestFFT {

    void print(String msg, double [] x) {
        System.out.println(msg);
        for (double d : x) System.out.println(d);
    }

    /**
     * This is a "wrapped" signal processing-style autocorrelation. 
     * For "true" autocorrelation, the data must be zero padded.  
     */
    public void bruteForceAutoCorrelation(double [] x, double [] ac) {
        Arrays.fill(ac, 0);
        int n = x.length;
        for (int j = 0; j < n; j++) {
            for (int i = 0; i < n; i++) {
                ac[j] += x[i] * x[(n + i - j) % n];
            }
        }
    }

    private double sqr(double x) {
        return x * x;
    }

    public void fftAutoCorrelation(double [] x, double [] ac) {
        int n = x.length;
        // Assumes n is even.
        DoubleFFT_1D fft = new DoubleFFT_1D(n);
        fft.realForward(x);
        ac[0] = sqr(x[0]);
        // ac[0] = 0;  // For statistical convention, zero out the mean 
        ac[1] = sqr(x[1]);
        for (int i = 2; i < n; i += 2) {
            ac[i] = sqr(x[i]) + sqr(x[i+1]);
            ac[i+1] = 0;
        }
        DoubleFFT_1D ifft = new DoubleFFT_1D(n); 
        ifft.realInverse(ac, true);
        // For statistical convention, normalize by dividing through with variance
        //for (int i = 1; i < n; i++)
        //    ac[i] /= ac[0];
        //ac[0] = 1;
    }

    void test() {
        double [] data = { 1, -81, 2, -15, 8, 2, -9, 0};
        double [] ac1 = new double [data.length];
        double [] ac2 = new double [data.length];
        bruteForceAutoCorrelation(data, ac1);
        fftAutoCorrelation(data, ac2);
        print("bf", ac1);
        print("fft", ac2);
        double err = 0;
        for (int i = 0; i < ac1.length; i++)
            err += sqr(ac1[i] - ac2[i]);
        System.out.println("err = " + err);
    }

    public static void main(String[] args) {
        new TestFFT().test();
    }
} 
```

# visual-studio-2010 - 忽略 RegisterForComInterop 警告

> ID：12239100
> 
> 赞同：1
> 
> 时间：2012-09-02T19:34:24.643
> 
> 标签：visual-studio-2010, msbuild

我有一个带有 msbuild 任务 RegisterForComInterop 的 VB .NET 项目。

预计这会引发警告

```
Type library "....tlb" is not registered, cannot unregister. 
```

第一次构建解决方案时（以及进行 TFS 团队构建时）。

我正在尝试消除解决方案中的警告（并且没有警告政策）以提高代码质量。

如何告诉 msbuild 忽略此警告？这是一个 msbuild 警告，而不是编译器警告，所以我不能只在 vbproj 中使用 NoWarn 标记...

# python - python 肥皂客户端库

> ID：12239103
> 
> 赞同：2
> 
> 时间：2012-09-02T19:35:07.953
> 
> 标签：python, soap, pysimplesoap

我想使用 SOAP 协议查询 Internet 中有一项服务。在为 Python 搜索 SOAP 库时，这篇文章提供了丰富的信息：[https](https://stackoverflow.com/a/206964) ://stackoverflow.com/a/206964 。但是我尝试过的所有库都没有为这个特定的服务工作。我有有效的 PHP 脚本：

```
<?php

$client = new SoapClient('https://personyze.com/site/service/service/social_archive/', array('trace' => true));
$result = $client->__soapCall
(   'select', array
    (   array('server_id'=>123456, 'api_key'=>123456), 'user_id', null, null, false, 0, 1
    )
);
echo $client->__getLastRequestHeaders(), $client->__getLastRequest(), "RESULT:\n";
var_dump($result); 
```

我在 Python 中做了以下尝试：

1.

```
from suds.client import Client
client = Client("https://personyze.com/site/service/service/social_archive/")

Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/local/lib/python2.7/dist-packages/suds-0.3.7-py2.7.egg/suds/client.py", line 109, in __init__
    self.wsdl = Definitions(url, options)
  File "/usr/local/lib/python2.7/dist-packages/suds-0.3.7-py2.7.egg/suds/wsdl.py", line 194, in __init__
    self.build_schema()
  File "/usr/local/lib/python2.7/dist-packages/suds-0.3.7-py2.7.egg/suds/wsdl.py", line 255, in build_schema
    self.schema = container.load()
  File "/usr/local/lib/python2.7/dist-packages/suds-0.3.7-py2.7.egg/suds/xsd/schema.py", line 92, in load
    child.dereference()
  File "/usr/local/lib/python2.7/dist-packages/suds-0.3.7-py2.7.egg/suds/xsd/schema.py", line 295, in dereference
    midx, deps = x.dependencies()
  File "/usr/local/lib/python2.7/dist-packages/suds-0.3.7-py2.7.egg/suds/xsd/sxbasic.py", line 330, in dependencies
    raise TypeNotFound(self.ref)
suds.TypeNotFound: Type not found: '(Array, http://schemas.xmlsoap.org/soap/encoding/, )' 
```

2.

```
from pysimplesoap.client import SoapClient
client = SoapClient(wsdl="https://personyze.com/site/service/service/social_archive/", trace=True)
client.select({"server_id":123456, "api_key":123456}, "user_id") 
```

好多了！今天最好的结果。这个库唯一做错的事情是它调用了 method`selectRequest()`而不是`select()`.

```
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/local/lib/python2.7/dist-packages/pysimplesoap/client.py", line 140, in <lambda>
    return lambda *args, **kwargs: self.wsdl_call(attr,*args,**kwargs)
  File "/usr/local/lib/python2.7/dist-packages/pysimplesoap/client.py", line 289, in wsdl_call
    response = self.call(method, *params)
  File "/usr/local/lib/python2.7/dist-packages/pysimplesoap/client.py", line 188, in call
    raise SoapFault(unicode(response.faultcode), unicode(response.faultstring))
pysimplesoap.client.SoapFault: SOAP-ENV:Server: Procedure 'selectRequest' not present 
```

3.

```
import SOAPpy
client = SOAPpy.SOAPProxy("https://personyze.com/site/service/service/social_archive/", "urn:SocialArchiveServiceProviderwsdl")
client.select({"server_id":123456, "api_key":123456}, "user_id", None, None, False, 0, 2)

Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/local/lib/python2.7/dist-packages/SOAPpy-0.12.6-py2.7.egg/SOAPpy/Client.py", line 540, in __call__
    return self.__r_call(*args, **kw)
  File "/usr/local/lib/python2.7/dist-packages/SOAPpy-0.12.6-py2.7.egg/SOAPpy/Client.py", line 562, in __r_call
    self.__hd, self.__ma)
  File "/usr/local/lib/python2.7/dist-packages/SOAPpy-0.12.6-py2.7.egg/SOAPpy/Client.py", line 464, in __call
    p, attrs = parseSOAPRPC(r, attrs = 1)
  File "/usr/local/lib/python2.7/dist-packages/SOAPpy-0.12.6-py2.7.egg/SOAPpy/Parser.py", line 1074, in parseSOAPRPC
    t = _parseSOAP(xml_str, rules = rules)
  File "/usr/local/lib/python2.7/dist-packages/SOAPpy-0.12.6-py2.7.egg/SOAPpy/Parser.py", line 1054, in _parseSOAP
    parser.parse(inpsrc)
  File "/usr/lib/python2.7/xml/sax/expatreader.py", line 107, in parse
    xmlreader.IncrementalParser.parse(self, source)
  File "/usr/lib/python2.7/xml/sax/xmlreader.py", line 123, in parse
    self.feed(buffer)
  File "/usr/lib/python2.7/xml/sax/expatreader.py", line 207, in feed
    self._parser.Parse(data, isFinal)
  File "/usr/lib/python2.7/xml/sax/expatreader.py", line 338, in start_element_ns
    AttributesNSImpl(newattrs, qnames))
  File "/usr/local/lib/python2.7/dist-packages/SOAPpy-0.12.6-py2.7.egg/SOAPpy/Parser.py", line 109, in startElementNS
    "got `%s'" % toStr( name )
SOAPpy.Errors.Error: <Error : expected `SOAP-ENV:Envelope', got `wsdl:definitions'> 
```

请告诉我我该怎么做才能让它发挥作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T20:18:47.187

服务器的 WSDL 模式似乎被破坏了——它引用了命名对象而不导入它们。

请参阅[有关修复损坏模式的 suds 文档，](https://fedorahosted.org/suds/wiki/Documentation#FIXINGBROKENSCHEMAs)了解如何使用 suds 解决该问题。

另请参阅[此问题](https://stackoverflow.com/questions/4719854/soap-suds-and-the-dreaded-schema-type-not-found-error)以获取更多详细信息。

这似乎对我有用：

```
from suds.xsd.doctor import Import
from suds.xsd.doctor import ImportDoctor
from suds.client import Client

url = 'https://personyze.com/site/service/service/social_archive/'
tns = 'urn:SocialArchiveServiceProviderwsdl'

imp = Import('http://schemas.xmlsoap.org/soap/encoding/', 'http://schemas.xmlsoap.org/soap/encoding/')
imp.filter.add(tns)
client = Client(url,plugins=[ImportDoctor(imp)])

print client.service.select({"server_id":123456, "api_key":123456}, "user_id") 
```

# cocos2d-iphone - InputLayers 和 Cocos2d

> ID：12239105
> 
> 赞同：0
> 
> 时间：2012-09-02T19:35:22.637
> 
> 标签：cocos2d-iphone, box2d

我使用标签在我的两个主要层周围传递引用，基本上有一个 Hud 层和一个游戏层。但是，我的 Hud 需要将多个标签传递给主游戏层，例如，操纵杆控制器和两个按钮。我该怎么做呢？也许我可以从 HUD 制作一组标签并将其传递给主层？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T07:33:13.390

我制作了操纵杆和按钮 CCTouchDelegates，允许传递触摸。

# asp.net-ajax - 在加载时展开 Telerik RadTreeView（用于 ASP.net AJAX）

> ID：12239106
> 
> 赞同：1
> 
> 时间：2012-09-02T19:35:26.040
> 
> 标签：asp.net-ajax, telerik, radtreeview

我想知道为什么我找不到在页面加载时展开静态 RadTreeView 的所有节点的直接方法。我首先从 Visual Studio 的属性窗格遍历了它的所有属性，还从代码隐藏中检查了它。我没有找到任何单个属性来告诉它以扩展模式打开它。然后我查看了 Telerik 的网站，不幸的是我没有找到任何服务器端解决方案让它以扩展模式加载。

您知道以扩展模式加载它的任何方法/技巧吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T16:33:49.607

这也可以帮助某人。[更多信息在这里](http://www.telerik.com/help/aspnet-ajax/treeview-client-expanding-collapsing.html)

```
//Javascript
var treeView = $find("<%= RadTreeView2.ClientID %>");
var nodes = treeView.get_allNodes();
for (var i = 0; i < nodes.length; i++) {
    if (nodes[i].get_nodes() != null) {
        nodes[i].expand();
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T19:48:01.580

我找到了答案（从代码隐藏扩展）：

```
if (!IsPostBack)
        {
            foreach (RadTreeNode rtn in RTVControl.Nodes)
            {
                rtn.ExpandChildNodes();
                rtn.Expanded = true;
            }
        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-29T19:32:31.870

```
Protected Sub RadTreeView1_NodeCreated(sender As Object, e As Telerik.Web.UI.RadTreeNodeEventArgs) Handles RadTreeView1.NodeCreated
    e.Node.Expanded = True
End Sub 
```

# php - CREATE TABLE 使用 PHP + PDO for Sqlite 部分失败

> ID：12239111
> 
> 赞同：3
> 
> 时间：2012-09-02T19:35:34.753
> 
> 标签：php, sqlite, pdo

我正在从 Navicat 制作的数据库转储中创建 SQLite 数据库中的表。

在我正在运行的 3 个 CREATE TABLE 查询中，2 个失败，1 个有效 - 所以这不是权限/连接/配置问题。

这是SQL：

```
CREATE TABLE "servers" (
"id"  INTEGER NOT NULL,
"name"  TEXT(32) NOT NULL,
"type"  INTEGER NOT NULL,
"host"  TEXT(128) NOT NULL,
"port"  INTEGER NOT NULL,
"rcon_port"  INTEGER NOT NULL,
PRIMARY KEY ("id")
);

CREATE TABLE "config" ("built"  INTEGER NOT NULL);

CREATE TABLE "users" (
"id"  INTEGER NOT NULL,
"username"  TEXT(32) NOT NULL,
"password"  TEXT(64) NOT NULL,
"salt"  TEXT(8) NOT NULL,
"last_login"  INTEGER NOT NULL,
PRIMARY KEY ("id")
); 
```

尝试运行它 - 仅`config`创建表。

我可以用 Navicat 执行这个脚本并创建表 - 这在语法上有什么问题吗？

也没有错误/异常被抛出

PHP：

`$path`并`$sql`确认是正确的

```
$db_conn = 'sqlite:' . $path;

try {
    $dbh = new PDO($db_conn);
    $dbh->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

    $dbh->query(file_get_contents($sql);
} catch (Exception $e) {
    var_dump($e);
    exit;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T19:54:01.103

尝试将文件分成单独的查询并运行这些：

```
$db_conn = 'sqlite:' . $path;
$queries = file_get_contents($sql);

try {
    $dbh = new PDO($db_conn);
    $dbh->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    $queries = explode(";", $queries);
    foreach ($queries as $query) {
        $dbh->query($query);
    }
} catch (Exception $e) {
    var_dump($e);
    exit;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T19:42:19.910

[SQLite 语法图](http://www.sqlite.org/lang_createtable.html)在列列表之后和 PRIMARY KEY 声明之前不包括逗号。由于这是失败的表之间最明显的区别，因此请先尝试。

# regex - 我的正则表达式中的零个或一个斜杠

> ID：12239112
> 
> 赞同：1
> 
> 时间：2012-09-02T19:35:45.160
> 
> 标签：regex, apache, url-rewriting

我不明白我的 apache 重写规则中的正则表达式有什么问题：

```
RewriteRule ^(.*)\/?$ $1.php?%1 [L] 
```

当转到网址[http://mysite.com/page1/](http://mysite.com/page1/)时，出现错误。但是，如果我将重写规则中的正则表达式更改为

```
RewriteRule ^(.*)\/$ $1.php?%1 [L] 
```

url [http://mysite.com/page1/](http://mysite.com/page1/)工作得很好。我认为问号意味着前一个模式的零个或一个匹配。为什么我的问号没有按说明工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T19:41:27.187

正则表达式`^(.*)\/?$`实际上将匹配*任何*字符串——您要求“任何字符串，后跟斜杠或不后跟斜杠”。因此，如果斜杠是可选的，它将把任何请求变成一个无限的重写循环。您可能需要`RewriteCond`过滤掉*已经*以`.php`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T19:57:16.730

让我再解释一下：

1.  首先通过 rewrite /page1/ 到 page1.php?something
2.  [L] 说：“停在这里，用新的 url 重新开始重写”
3.  第二遍重写 /page1.php 到 page1.php.php?something
4.  等等...

# c# - 禁用工具条下拉按钮的选择和下拉符号

> ID：12239119
> 
> 赞同：4
> 
> 时间：2012-09-02T19:36:48.807
> 
> 标签：c#, winforms, visual-studio-2010, toolstripdropdown

**有没有办法防止选择工具条下拉按钮（不禁用它）？**

我看到它有一个名为 的属性`CanSelect`，但它是只读的。

至于我与此控件相关的第二个问题：

**有没有办法隐藏工具条下拉按钮的下拉符号（黑色矩形指向下方）？**

我想阻止它被选中并隐藏下拉符号以使按钮像状态标签旁边的状态条图标一样。如果您能就此提出建议，将不胜感激。

* * *

**我没有意识到工具条状态标签允许图像......这样我就不需要用控件伪造它。谢谢你们。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T13:36:42.917

问题：**有没有办法隐藏工具条下拉按钮的下拉符号（黑色矩形指向下方）？**

将代码粘贴到表单构造函数中。

```
toolStripDropDownButton1.ShowDropDownArrow = false; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T19:50:30.030

有点棘手，但尝试通过不透明度几乎但不等于 0 对其进行一些控制来覆盖它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T13:53:05.787

我认为问题在于您尝试使用错误的控件来传达给用户的内容。

按钮：如果按钮不打算与您交互，则应禁用它，这是软件中的常见比喻。你想以造型的方式做的是你的特权。或者，您可以只处理焦点而不做任何事情。但是，如果您的点击没有执行任何操作并且该按钮未被禁用，您的用户将会感到困惑。

DropDownButton：您在这里尝试做的似乎是编程控制用户可以使用哪些按钮操作，但不想让他们更改他们可以启动的操作。如果是这种情况，您应该考虑在此处隐藏多个按钮，但您当时想要显示的按钮除外。这将使用户对行为有明确的期望。

显然我在这里做了一些假设，但为了给出更详细的回复，我需要更多关于你想要这样做的具体原因的详细信息，以了解你为什么以这种方式接近它。

# c++ - 无法从文件中读取

> ID：12239122
> 
> 赞同：0
> 
> 时间：2012-09-02T19:37:19.957
> 
> 标签：c++, c, file-io

我编写了一个从名为 network.dat 的文件中读取的代码

我写的代码是

```
 f = fopen("network.dat", "r");
    if(f == NULL)
        exit(1);
    int read, N;

    printf("%p\n", f);//output file pointer, included this just to check if file is opened properly
    fscanf(f, "%d%d", &N, &read);//error here
    cout<<N; 
```

该文件正在正确打开并且正在获取文件指针（`49897488`）作为输出，但它后面的行是程序停止工作的地方，我没有得到`N`作为输出。请告知是否需要其他详细信息。network.dat 的内容是

```
10 1
1   6   1.28646
1   7   1.2585
2   9   1.33856 
```

等等。我只关注文件中的前 2 个数字，即 10 和 1。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T19:56:55.337

您的 scanf() 格式字符串不正确。"%d,%d" 查找用逗号分隔的两个整数。如果要读取两个用空格分隔的整数，只需执行“%d%d”即可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T02:40:10.430

这似乎对斯里扬有效。该代码是一种快速而肮脏的剪切和粘贴工作，风格零分，但它作为测试完成了这项工作。似乎记录中的字段数需要与打印格式字符串中的字段匹配。我在 1.9999 的记录 1 的测试数据中添加了第三个字段，它起作用了。我怀疑这是一个技术上纯粹的解释。

```
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include <errno.h>
#include <cstring>
#include <cstdlib>
#include <iostream>
using std::cout;
using std::endl;
using std::cin;
using std::ios;

int main(int argc, char *argv[])
{
//int read;
//int N;
int res;
FILE *f;

f = fopen("network.dat", "r");
    if(f == NULL)
        exit(1);
    int read, N;
    float f3;

    printf("%p\n", f);//output file pointer, included this just to check if file is opened properly
    for (;;)
        {
    res = fscanf(f, "%d%d%f", &N, &read, &f3);//error here
    if (res <= 0)
        {
        printf("err %d\n",errno);
        break;
        }
    cout<<N << " " << read << "\n";
        }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T19:47:24.750

您的代码期望文件中的所有字符直到第一个空格都是 int。如果文件不是以 int 开头，这可能是它失败的原因。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-02T19:59:43.550

正如我在[评论](https://stackoverflow.com/questions/12239122/unable-to-read-from-a-file#comment16403636_12239122)中所说，问题在于您的格式说明符不正确。尝试

```
fscanf(f, "%d%d", &N, &read); 
```

由于您使用`cout`的是我猜测这实际上是 C++ 代码......老实说，您真的**不**应该以规范的 C 方式来做这件事。相反，使用[`ifstream`](http://www.cplusplus.com/reference/iostream/ifstream/).

```
std::ifstream input("network.dat");
int N, read;
input >> N >> read;
std::cout << N << ' ' << read << std::endl; 
```

# java - 在我的事务中获取 org.hibernate.NonUniqueObjectException

> ID：12239125
> 
> 赞同：3
> 
> 时间：2012-09-02T19:37:51.693
> 
> 标签：java, hibernate

在执行这些步骤时，我得到了 org.hibernate.NonUniqueObjectException。

```
session.beginTransaction();
TransactionEntry te = (TransactionEntry)session.get(TransactionEntry.class, primaryKey);
session.getTransaction().commit();
.
.
.
session.beginTransaction();
session.saveOrUpdate(te.getAccount());
session.delete(te);
session.delete(te.getTransaction());
session.getTransaction().commit(); 
```

我的模型快照如下：

TransactionEntry 类

```
@Entity
public class TransactionEntry {
    @Id
    @GeneratedValue
    private long txnEntryId;

    @ManyToOne
    @JoinColumn(name = "account")
    private Account account;

    @ManyToOne
    @JoinColumn(name = "txnId")
    private TransactionTable transaction;
} 
```

账户类

```
@Entity
public class Account {
    @Id
    @GeneratedValue
    private long accountId;
} 
```

事务表类

```
@Entity
public class TransactionTable {
    @Id
    @GeneratedValue
    private long txnId;

    @OneToMany(targetEntity = TransactionEntry.class, fetch = FetchType.LAZY,
            mappedBy = "transaction", cascade = CascadeType.ALL)
    private List<TransactionEntry> transactionEntries;
} 
```

我收到以下异常：

```
org.hibernate.NonUniqueObjectException: a different object with the same
identifier value was already associated with the
session: [com.pratikabu.pem.model.Account#1] 
```

如果我删除该 `session.delete(te.getTransaction());`语句，则代码工作正常，否则将引发上述异常。有什么我想念的吗。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T21:27:47.573

这是一步一步发生的事情：

*   `session.saveOrUpdate(te.getAccount());`将`Account`对象（id为**1**）附加到会话
*   在该行`session.delete(te.getTransaction());`中，在删除之前，hibernate 会尝试加载`TransactionEntry`对象集合（由于级联，集合中的对象也需要删除）。
*   但是在`TransactionEntry`从集合中加载对象时，hibernate 也会加载成员`Account`对象，因为它是使用具有**[EAGER](http://docs.oracle.com/javaee/6/api/javax/persistence/ManyToOne.html#fetch%28%29)**默认获取的[@ManyToOne注释映射的。](http://docs.oracle.com/javaee/6/api/javax/persistence/ManyToOne.html)
*   当到达与 id 1`TransactionEntry`对应的对象时，`Account`休眠会引发上述异常，因为该异常`Account`已存在于会话中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T19:50:03.297

`session.delete(te)`- 它会删除`TransactionEntry`以及`TransactionTable`因为`cascade = CascadeType.ALL` 所以`session.delete(te.getTransaction()) with this line you wont have any thing`这就是它说的原因`NonUniqueObjectException`

# c# - 如何从诸如 Pocket（稍后阅读）或 Readability 之类的 HTML 页面中提取文章文本内容？

> ID：12239128
> 
> 赞同：10
> 
> 时间：2012-09-02T19:38:21.830
> 
> 标签：c#, .net, html, c#-4.0, article

我正在寻找一些开源框架或算法，通过清理 HTML 代码、删除垃圾内容从任何 HTML 页面中提取文章文本内容，类似于 Pocket（又名稍后阅读）软件所做的。

掌上官网：http: [//getpocket.com/](http://getpocket.com/)

此问题已在链接下提供： [如何从 html 中提取文本内容，例如稍后阅读或 InstaPaper Iphone 应用程序？](https://stackoverflow.com/questions/5960948/how-to-extract-text-contents-from-html-like-read-it-later-or-instapaper-iphone-a) 但我的要求有点不同。我想通过保留字体和样式 (CSS) 来清理 HTML 并使用图像提取主要内容。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-02T19:47:37.567

我会推荐[NReadability](http://code.google.com/p/nreadability/)和[HtmlAgilityPack](http://html-agility-pack.net/?z=codeplex)

`readInner`在 NReadability 对页面进行转码后，主文本始终位于带有 id 的 div 中。

```
//** replace this with any url **
string url = "http://www.bbc.co.uk/news/world-asia-19457334";

var t = new NReadability.NReadabilityWebTranscoder();
bool b;
string page = t.Transcode(url, out b);

if (b)
{
    HtmlAgilityPack.HtmlDocument doc = new HtmlAgilityPack.HtmlDocument();
    doc.LoadHtml(page);

    var title = doc.DocumentNode.SelectSingleNode("//title").InnerText;
    var imgUrl = doc.DocumentNode.SelectSingleNode("//meta[@property='og:image']").Attributes["content"].Value;
    var mainText = doc.DocumentNode.SelectSingleNode("//div[@id='readInner']").InnerText;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T19:39:54.887

使用[HTML Agilty Pack](http://htmlagilitypack.codeplex.com/) - 它是一个用于 .NET 的开源 HTML 解析器。

> 什么是 Html Agility Pack (HAP)？
> 
> 这是一个敏捷的 HTML 解析器，它构建一个读/写 DOM 并支持普通的 XPATH 或 XSLT（实际上你不必了解 XPATH 或 XSLT 就可以使用它，不用担心......）。它是一个 .NET 代码库，允许您解析“网络之外”的 HTML 文件。解析器对“真实世界”格式错误的 HTML 非常宽容。对象模型与 System.Xml 的提议非常相似，但用于 HTML 文档（或流）。

您可以使用它来查询 HTML 并提取您想要的任何数据。

# javascript - 内部函数不能访问外部函数变量

> ID：12239129
> 
> 赞同：5
> 
> 时间：2012-09-02T19:38:38.750
> 
> 标签：javascript

我创建了以下突出显示我的问题的 jsfiddle。 [http://jsfiddle.net/UTG7U/](http://jsfiddle.net/UTG7U/)

```
var ExampleObject = function() {
   var myArray = new Array();
   this.example = function() {
       alert(this.myArray);
   };
}

var exampleObj = new ExampleObject();
exampleObj.example();​ 
```

我是 JavaScript 新手，正在尝试创建对象、字段和方法。我无法让我的方法访问我的字段变量。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-02T20:10:19.193

您混淆了两种类型的变量：局部变量和成员变量。`var myArray`是一个局部变量。`this.myArray`是成员变量。

仅使用局部变量的解决方案：

```
var ExampleObject = function() {
   var myArray = new Array(); // create a local variable
   this.example = function() {
       alert(myArray); // access it as a local variable
   };
}

var exampleObj = new ExampleObject();
exampleObj.example();​ 
```

仅使用成员变量的解决方案：

```
var ExampleObject = function() {
   this.myArray = new Array(); // create a member variable
   this.example = function() {
       alert(this.myArray); // access it as a member variable
   };
}

var exampleObj = new ExampleObject();
exampleObj.example();​ 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-02T19:41:40.563

您试图使用此运算符访问局部变量，这是错误的，所以这是工作示例

```
var ExampleObject = function() {
   var myArray = new Array(1,2,3);
   this.example = function() {
       alert(myArray);
   };
}
var exampleObj = new ExampleObject();
exampleObj.example();​ 
```

链接：http: [//jsfiddle.net/3QN37/](http://jsfiddle.net/3QN37/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-02T19:41:22.820

你不需要`this.myArray`. 单独使用`myArray`就足够了（并且有效）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-02T19:41:37.957

`alert(myArray);`我认为应该可以正常工作

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-02T19:42:31.730

`this`每个功能的范围会发生什么变化。但是，`myArray`将对内部功能可见。例子：

```
var ExampleObject = function() {
   var myArray = new Array();
   this.example = function() {
       alert(myArray);
   };
}
var exampleObj = new ExampleObject();
exampleObj.example();​ 
```

# c++ - 定义 vs 命名空间

> ID：12239133
> 
> 赞同：1
> 
> 时间：2012-09-02T19:39:28.217
> 
> 标签：c++, templates, macros, typedef

我有一个代码：

```
namespace My
{
    #define sptr std::shared_ptr;
} 
```

它被用在很多地方。现在我已经将此代码作为库包含到 qt 项目中，但它无法加载，因为它在某处`sptr`用作变量名。

我可以修改 Qt 标头并重命名变量，但这在可移植性方面并不好。解决此问题的最佳方法是什么？`typedef`不能与模板一起使用。我知道使用模板结构进行破解，但我仍然必须用它修改我的代码。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-02T19:40:26.160

```
namespace ns {
  template<typename T>
  using sptr = std::shared_ptr<T>;
} 
```

另请参阅@Kerrek SB 对有关此特定用例的问题的评论。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T19:56:45.847

您可以使用以下内容：

```
 template<typename T>
  struct sptr : std::shared_ptr<T> { }; 
```

这是一个简单的`std::shared_ptr`. 这适用于 C++2003 和 C++11。

# c# - 行数据绑定中的gridview id

> ID：12239134
> 
> 赞同：2
> 
> 时间：2012-09-02T19:39:32.377
> 
> 标签：c#, asp.net, gridview, rowdatabound

我有一个 rowdatabound 方法，这对于两个 gridviews 很常见。此方法的部分任务是将值分配给 gridview 的最后一列。

网格视图相同，但值与两个网格视图不同。所以我需要检查我是否将 vaules 分配给第一个 gridview 或另一个。

```
protected void GridView1_RowDataBound(object sender, GridViewRowEventArgs e)
    {
        //Here i need to check which gridview (Gridview1 or Gridview2)
        if (e.Row.RowType == DataControlRowType.DataRow)
        {

            {
                int CellValue = Convert.ToInt32(e.Row.Cells[0].Text);

                if (CellValue == 1)
                    e.Row.Cells[7].Text = "" + patchWeekTwo[0] + "t";
                else if (CellValue == 2)
                    e.Row.Cells[7].Text = "" + patchWeekTwo[1] + "t";
                else if (CellValue == 3)
                    e.Row.Cells[7].Text = "" + patchWeekTwo[2] + "t";
                else if (CellValue == 4)
                    e.Row.Cells[7].Text = "" + patchWeekTwo[3] + "t";
                else
                    e.Row.Cells[7].Text = "" + patchWeekTwo[4] + "t";
            }
        }
     } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T19:46:45.793

您可以检查`sender`是`GridView1`或`GridView2`：

```
if( sender == GridView1 ){}
else{} 
```

请注意，仅当`GridView1`在页面顶部而不是在其中一个 childs 中声明时才有效`NamingContainers`。然后你可以检查id：

```
var grid = (GridView)sender;
if( grid.Id == "GridView1" ){}
else{} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T19:54:10.850

我认为这应该这样做

```
protected void GridView1_RowDataBound(object sender, GridViewRowEventArgs e)
{
     GridView gv = (GridView)sender;
     if(gv.ID == "gv1")
        //do this
     else
        //do that
} 
```

# android - 实施唤醒锁

> ID：12239136
> 
> 赞同：0
> 
> 时间：2012-09-02T19:39:43.690
> 
> 标签：android, wakelock

我有一个`Service`，其中有两个`TimerTask`以 2 分钟的频率运行（由用户偏好设置，从 2 到 30 分钟。）。

现在这工作正常，但是当手机进入睡眠状态（灯关闭并且手机处于锁定状态）时，这不能按预期工作。所以我想我需要为此实现唤醒锁..

如果是这样，使用唤醒锁的最佳方法是什么。

我发现我们也可以使用`Alarmmanager`..

请帮助以及我应该在哪里实现这个..（在 oncreate 方法或扩展 timetask 的类中）。

Andoid 2.2 塔吉特版

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T19:45:27.033

通常使用唤醒锁是非常非常罕见的需求。它会对电池寿命产生重大影响，并且很容易出错，在这种情况下，wakelock 根本不会被释放。

出于您的目的，AlarmManager ( [http://developer.android.com/reference/android/app/AlarmManager.html](http://developer.android.com/reference/android/app/AlarmManager.html) ) 是理想的解决方案。它保证在您执行期间不会执行睡眠，但在此执行期间（2 或 30 分钟）设备可以进入睡眠状态并节省大量电池。系统将在您执行下一次执行时唤醒。

祝你好运

# objective-c - 在 Objective-C 中将 NSString 附加到左侧

> ID：12239139
> 
> 赞同：-2
> 
> 时间：2012-09-02T19:40:08.573
> 
> 标签：objective-c, append

以下代码附加`intString`到右侧`resultString`

```
resultString = [resultString stringByAppendingString:intString]; 
```

是否有任何简单的解决方案可以`intString`在左侧附加`resultString`

例如：

```
intString = "2";

resultString = "1"; 
```

而不是给出“12”的结果，我想要“21”的结果

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T19:42:11.970

只需交换参数和接收器：

```
resultString = [intString stringByAppendingString:resultString]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T19:43:25.780

您可以使用`stringWithFormat`方法：

```
resultString  = [NSString stringWithFormat:@"%@%@", intString, resultString]; 
```

# c++ - C++ for 循环显示模式

> ID：12239147
> 
> 赞同：0
> 
> 时间：2012-09-02T19:41:06.923
> 
> 标签：c++

所以基本上我必须使用 for 循环来制作这种模式：

```
*
**
***
****
*****
******
*******
********
*********
**********
**********
*********
********
*******
******
*****
****
***
**
*

two blank lines

   **********
    *********
     ********
      *******
       ******
        *****
         ****
          ***
           **
            *
Two blank lines
            *
           **
          ***
         ****
        *****
       ******
      *******
     ********
    *********
   ********** 
```

我不太确定是否需要将 * 定义为变量。我知道我需要使用增量和减量来实现这一点，并且还需要使用理由来正确排列它。一些反馈和帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T20:06:05.967

这类问题是教你如何将一个问题分解为更小的问题，以创建可用于多种模式的代码。

例如，您可以编写一个打印一行的函数

```
void PrintLine(int length) 
```

你可能想指定你想要左边还是右边的线

```
void PrintLine(int length, bool left) 
```

然后剩下的就是制作特定于您要显示的形状的循环条件。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-02T19:45:02.603

对于第一个形状：

```
int one=1;
boolean doit=true;
int counter=0;

while(doit)
{
  printf("\n");
  counter+=one;
  for(int i=0;i<counter;i++)
  {
      printf("*");
  }
  if(counter>maxi)
  {
      printf("\n");
      for(int i=0;i<counter;i++)printf("*");
      one=-one;
  }
  if(counter==0)doit=false;

} 
```

# html - Firefox 上的错误：滚动时复选框隐藏

> ID：12239148
> 
> 赞同：0
> 
> 时间：2012-09-02T19:41:14.773
> 
> 标签：html, css, firefox, checkbox

自从上次更新 Firefox 以来，当我从消息列表中向下滚动复选框时，我得到了一个奇怪的错误（我网站的用户也得到了它）！

这里是滚动前的屏幕：

![在此处输入图像描述](../Images/42012a2ce5a7e99e7a3c18723f81bce5.png)

向下滚动后的屏幕如下：

![在此处输入图像描述](../Images/4c86198287b857dc96df9f0240775562.png)

我已经在其他浏览器上进行了测试，一切正常，任何想法可能来自哪里？如果需要，我可以添加 css 代码或其他

///// 固定的 ////

问题来自所有输入的“不透明度：0.8”，将其设置为“1”解决了问题，感谢您的回答

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T20:29:30.410

问题来自所有输入的“不透明度：0.8”，将其设置为“1”解决了问题，感谢您的回答

# c# - IEnumerable<> 属于复合体时 HttpPost 中的数据丢失

> ID：12239151
> 
> 赞同：0
> 
> 时间：2012-09-02T19:41:27.413
> 
> 标签：c#, asp.net-mvc-4, model-binding

假设我有这个视图模型：

```
public class CreateGameViewModel
{
    [Required]
    public string SideA { get; set; }

    [Required]
    public string SideB { get; set; }

    [HiddenInput(DisplayValue = false)]
    public IEnumerable<int> ConfigurableCategoryIDs { get; set; }
} 
```

而这些行动：

```
 [HttpGet]
    public ActionResult Create()
    {
        var viewModel = new CreateGameViewModel { ConfigurableCategoryIDs = new List { 1, 1, 1 } };
        return View(viewModel);
    }

    [HttpPost]
    public ActionResult Create(CreateGameViewModel viewModel)
    {
    ...
    } 
```

在视图中，我尝试编辑 ConfigurableCategoryIDs 值：

```
 @for (int i = 0; i < Model.ConfigurableCategoryIDs.Count(); i++)
    {
        var item = Model.ConfigurableCategoryIDs.ElementAt(@i);
        @Html.EditorFor(m => item)
    } 
```

**CreateGameViewModel.ConfigurableCategoryIDs**作为 null 返回到 Create(CreateGameViewModel viewModel)，而 SideA 和 SideB 有值。

将不胜感激解释和解决方案！谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T19:46:24.953

请尝试下一个：

模型：

```
public class CreateGameViewModel
{
    [Required]
    public string SideA { get; set; }

    [Required]
    public string SideB { get; set; }

    [HiddenInput(DisplayValue = false)]
    public List<int> ConfigurableCategoryIDs { get; set; }
} 
```

控制器：

```
 [HttpGet]
    public ActionResult Create()
    {
        var viewModel = new CreateGameViewModel { ConfigurableCategoryIDs = new List<int> { 1, 1, 1 } };
        return View(viewModel);
    }

    [HttpPost]
    public ActionResult Create(CreateGameViewModel viewModel)
    {
        return View();
    } 
```

看法：

```
@model MvcApplication1.Models.CreateGameViewModel

@using (Html.BeginForm()) {
@Html.ValidationSummary(true)
<fieldset>
    <legend>CreateGameViewModel</legend>

    <div class="editor-label">
        @Html.LabelFor(model => model.SideA)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.SideA)
        @Html.ValidationMessageFor(model => model.SideA)
    </div>

    <div class="editor-label">
        @Html.LabelFor(model => model.SideB)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.SideB)
        @Html.ValidationMessageFor(model => model.SideB)
    </div>

    @for (int i = 0; i < Model.ConfigurableCategoryIDs.Count(); i++)
    {
        @Html.EditorFor(m => Model.ConfigurableCategoryIDs[i])
    }

    <p>
        <input type="submit" value="Create" />
    </p>
</fieldset>
} 
```

# ios5 - 使用 Cocos2d (2.0) 中的 UIReferenceLibraryViewController

> ID：12239153
> 
> 赞同：0
> 
> 时间：2012-09-02T19:41:37.047
> 
> 标签：ios5, cocos2d-iphone

由于某种原因整天都在为此苦苦挣扎，希望有人能对此有所了解。

我已经为它设置了一个`CCLabelTTF`并添加了一个触摸处理程序，在触摸端我想在`UIReferenceLibraryViewController`. 这是我的尝试的样子（我的游戏处于横向模式，这就是我尝试 90 度旋转的原因）：

```
if(NSClassFromString(@"UIReferenceLibraryViewController")) {

                if ([UIReferenceLibraryViewController dictionaryHasDefinitionForTerm:word.Value] == YES)
                {
                     UIReferenceLibraryViewController *reference =
                    [[UIReferenceLibraryViewController alloc] initWithTerm:word.Value];
                    reference.view.center = CGPointMake(winSize.width/2, winSize.height/2);
                    reference.view.transform = CGAffineTransformMakeRotation(CC_DEGREES_TO_RADIANS(90.0f));

                    [[[CCDirector sharedDirector] view] addSubview:reference.view];
                }
            } 
```

这类**作品**。我单击我的标签，`UIReferenceLibraryViewController`显示（尽管由于某种原因它没有横向旋转），并且我的定义出现了。但是，当我单击 中的“完成”按钮`UIReferenceLibraryViewController`时，我的应用程序因 EXEC_BAD_ACCESS 而崩溃。图我在这里遗漏了一些明显的东西，但不确定是什么。

当然，任何帮助都会受到赞赏。

谢谢
穆斯塔法

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T22:04:26.720

我有一个类似的问题。就我而言，我`UIReferenceLibraryViewController`在我的类的方法中声明和实例化对象。我在选择“完成”按钮时收到错误消息，因为那时我的`UIReferenceLibraryViewController`对象不再存在。为了解决这个问题，我在类接口中创建了一个成员变量：

```
UIReferenceLibraryViewController *reference; 
```

然后我创建了一个带有保留的属性：

```
@property (retain) UIReferenceLibraryViewController *reference; 
```

在我想要呈现字典屏幕的方法中，确实使用了以下内容：

```
reference = [[UIReferenceLibraryViewController alloc] initWithTerm:cell.textLabel.text];
[[[CCDirector sharedDirector] openGLView] addSubview:reference.view]; 
```

然后我在 dealloc 方法中释放了引用对象。不幸的是，它不再崩溃，但“完成”按钮现在什么也不做。

**附加信息：** 最终我的应用程序正在运行。我的应用程序在 CCScene 上添加了 UITableView，并允许用户单击表格视图单元格以查找单元格内单词的定义。

为了让它工作，我做了以下工作： 在我的 CCScene 类 (Game.m) 中，我创建了一个 UITableView。然后我创建一个 UITableViewController 类并设置 UITableView 数据源并委托给那个新类。

```
myTableView.dataSource = myWordListViewController;
myTableView.delegate = myWordListViewController; 
```

然后我将 UITableView 添加为 CCScene 的子视图，如下所示；

```
[[[CCDirector sharedDirector] openGLView] addSubview:myTableView]; 
```

CCScene 类有一个成员变量（称为委托），它是我的 AppDelegate 类的一个实例。AppDelegate 类有一个成员变量，它是 RootViewController 的一个实例。

```
RootViewController  *viewController; 
```

所以，现在我有一个 UITableView 呈现给用户（在 CCScene 之上）。此表视图包含单词列表。我现在需要确保表格视图单元格在单击时呈现字典定义。

在我的 MyWordListViewController (UITableViewController) 中，我确保存在这些方法以允许此类充当我的表视图的数据源和委托。

```
<UITableViewDelegate, UITableViewDataSource> 
```

此外，当用户单击 UITableView 中的单元格（即 CCSCENE 的子视图）时，我希望字典出现在表视图的顶部。

我正在响应用户单击 MyWordListViewController 的 didSelectRowAtIndexPath 方法。由于我将表格视图添加为 CCScene (Game.m) 的子视图，因此我需要使用我的 CCScene 所依赖的 AppDelegate RootViewController。

为此，我向 MyWordListViewController 添加了一个成员变量，该变量包含 AppDelegate 类的一个实例。

```
delegate = (AppDelegate*) [[UIApplication sharedApplication] delegate]; 
```

现在在 MyWordListViewController 的 didSelectRowAtIndexPath 方法中，我可以依靠 AppDelegate 类中的 RootViewController 变量在表视图上显示字典。

```
reference = [[UIReferenceLibraryViewController alloc] initWithTerm:cell.textLabel.text];

[delegate.viewController presentModalViewController:reference animated:YES]; 
```

它可能不是最有说服力的解决方案，但它确实有效。

# php - 面向对象的 PHP 和数组

> ID：12239156
> 
> 赞同：-5
> 
> 时间：2012-09-02T19:41:46.163
> 
> 标签：php

我一直在关注一个非常有趣的教程，它真正测试了我编写 PHP 的能力。我一直以为我是那个男人，但结果我变得更糟了。话虽如此，在教程中解释了实例化对象的要求，所以我输入了这段代码，不要误会我的意思，一切正常，完全没有问题。最重要的是，我并不真正了解事情是如何运作的，这就是为什么我希望有人向我解释更多。当您使用 MySQL_fetch_array 从数据库中提取记录时，我的问题是什么以及如何将数据呈现给接收变量。例如下面

```
private static function instantiate($record){
 $object = new self;
   foreach($record as $attribute => $value){
     if($object->has_attribute($attribute)){
      $object->$attribute =$value;
     }
   }
   return $object;
 } 
```

如果我在表中有 3 个字段，例如姓名、年龄、地址和一个值，让我们说 Jhone, 23, arizona 什么将存储在属性中，什么将存储在 Key 中，索引在哪里以及如何提取这样的来自数据库的数据，如上面的示例，并将其分配给另一个数组。请我不需要任何代码我的代码工作正常，我需要的是一个非常原始和清晰的解释。确实提前感谢您的支持。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T19:47:13.683

```
/**
 * @param array $record Record as returned from database
 *
 */
private static function instantiate($record){
    //Create a new instance of this class.
    $object = new self;
    //Iterate the record to find all of the data
    foreach($record as $attribute => $value){
        //If this class has a defined attribute which was found in the record
        if($object->has_attribute($attribute)){
            //Set it to the value from the database.
            $object->$attribute =$value;
        }
    }
    //Return the instance for others to use
    return $object;
} 
```

这是您的功能，带有文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T20:02:18.227

真正有帮助的是在你的方法中打印出一些东西（`print_r`例如）。例如，用你的方法试试这个：

```
private static function instantiate($record){
 print_r($record);
 $object = new self;
 print_r($object);
   foreach($record as $attribute => $value){
     echo "attribute: $attribute, value:$value <br />";
     if($object->has_attribute($attribute)){
      $object->$attribute =$value;
     }
   }
   print_r($object);
   die();
   return $object;
 } 
```

这样，您可以准确地看到对象、foreach 等发生了什么。

# jquery - 使用可拖动控件层拖放文本输入框

> ID：12239161
> 
> 赞同：1
> 
> 时间：2012-09-02T19:42:40.997
> 
> 标签：jquery, html, jquery-ui

我的主要目标是能够拖放文本类型的输入框我已经扫描了网络以找到解决方案，我最终想出了以下一个 - 在输入框上放置一个具有非常高不透明度的 div 所以它不会显示和更大的 z-index

但是没有一个 div 的样式位置（绝对、相对、静态或继承）对我不起作用

这是js生成的html代码：

这是我为我的多层想法添加的代码：

```
 $('#' + inputID).css('z-index', '5');
    var draggableCtrl = '<div style="height: ' + $('#' + wrapperId).height() + ';width:' + $('#' + wrapperId).width() + ';background-color: blue; position: static; z-index: 10; top :' + pos.top + '; left :' + pos.left + ';"></div>';
    $('#'+wrapperId).append(draggableCtrl); 
```

有人知道我在做什么错吗？

如果你已经到了这里，那么感谢你的尝试:)

# ios - 如何在 iOS SDK 中从 SimpleDB AWS 检索数据并显示它们？

> ID：12239164
> 
> 赞同：1
> 
> 时间：2012-09-02T19:42:47.923
> 
> 标签：ios, amazon-web-services, amazon-simpledb

我是 iOS 和 AWS 的新手...

我一直在尝试从 AWS 上的 SDB 中检索数据……

首先，我想连接到 aws，然后我想从 somedomain 中检索所有内容并将其放入数组中。并读出数组内部的内容。

```
 // Connecting to SDB    
 AmazonSimpleDBClient *sdbClient = [[AmazonSimpleDBClient alloc] initWithAccessKey:ACCESS_KEY_ID withSecretKey:SECRET_KEY];

@try {
    SimpleDBSelectRequest *selectRequest = [[SimpleDBSelectRequest alloc] initWithSelectExpression:@"select * from somedomain"];
    selectRequest.consistentRead = YES;
    if (self.nextToken != nil) {
        selectRequest.nextToken = self.nextToken;
    }

    SimpleDBSelectResponse *selectResponse = [sdbClient select:selectRequest];
    self.nextToken = selectResponse.nextToken;

    NSLog(self.nextToken);

}
@catch (NSException *exception) {
    NSLog(@"Exception : [%@]", exception);

} 
```

提前谢谢你们。我感谢所有的帮助。:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T05:44:47.157

这里有一些帮助在 java 中列出域、创建域、添加属性、删除属性和列出项目。

```
public boolean checkSubscriptionToAmazonSimpleDB(String accessKey, String secretKey) {
            try {
                basicAWSCredentials = new BasicAWSCredentials(accessKey, secretKey);
                amazonSimpleDBClient = new AmazonSimpleDBClient(basicAWSCredentials);
                String sNextToken = "";
                boolean bDomainExist = false;
                do {
                    ListDomainsRequest listDomainsRequest = new ListDomainsRequest();
                    listDomainsRequest.setMaxNumberOfDomains(100);
                    listDomainsRequest.setNextToken(sNextToken);
                    ListDomainsResult listDomainsResult = amazonSimpleDBClient.listDomains(listDomainsRequest);
                    sNextToken = listDomainsResult.getNextToken();
                    List<String> list = listDomainsResult.getDomainNames();
                    for (String domain : list) {
                        System.out.println(domain);
                    }
                } while (sNextToken != null && bDomainExist == false);

            } catch (Throwable ex) {
                System.out.println(ex.toString());
                return false;
            }
            return true;
        }

        public void createDomain(String domain) {
            CreateDomainRequest createDomainRequest = new CreateDomainRequest(domain);
            amazonSimpleDBClient.createDomain(createDomainRequest);

        }

        private boolean addItem(String domain, String itemName) {
            try {
                PutAttributesRequest putAttributesRequest = new PutAttributesRequest();
                putAttributesRequest.setDomainName(domain);
                putAttributesRequest.setItemName(itemName);
                List<ReplaceableAttribute> list = new ArrayList<ReplaceableAttribute>();
                list.add(new ReplaceableAttribute("A", "a", true));
                list.add(new ReplaceableAttribute("B", "c", true));
                list.add(new ReplaceableAttribute("C", "b", true));
                putAttributesRequest.setAttributes(list);
                amazonSimpleDBClient.putAttributes(putAttributesRequest);
            } catch (Throwable ex) {
                System.out.println(ex.toString());
                return false;
            }
            return true;
        }

        private boolean deleteItem(String domain, String itemName) {
            try {
                DeleteAttributesRequest deleteAttributesRequest = new DeleteAttributesRequest();
                deleteAttributesRequest.setDomainName(domain);
                deleteAttributesRequest.setItemName(itemName);
                amazonSimpleDBClient.deleteAttributes(deleteAttributesRequest);
            } catch (Throwable ex) {
                System.out.println(ex.toString());
                return false;
            }
            return true;
        }

        public void getListOfArchived(String domainname, String pagesize, String nextToken) {
            SelectResult selectResult = null;
            String sNextToken = null;
            String query = null;
            do {
                query = "select * from " + domainname;
                SelectRequest selectRequest = new SelectRequest(query);
                selectRequest.setNextToken(nextToken);
                selectResult = amazonSimpleDBClient.select(selectRequest);
                sNextToken = selectResult.getNextToken();
                List<Item> list = selectResult.getItems();
                for(Item item: list){
                    item.getName(); // itemName
                    List<Attribute> listAttribute = item.getAttributes();
                    for(Attribute attribute:listAttribute){
                        attribute.getName(); // Attribute Name
                        attribute.getValue(); // Attribute value;
                    }
                }
            } while (sNextToken != null);

        } 
```

# ajax - JSF/PrimeFaces：带有布局的页面中的问题

> ID：12239165
> 
> 赞同：1
> 
> 时间：2012-09-02T19:42:52.397
> 
> 标签：ajax, jsf, jsf-2, primefaces, managed-bean

我的 JSF 页面使用 PrimeFaces 组件有问题。由于它可能会很快变得冗长而乏味，因此我尽量简短。考虑这个托管 bean：

```
@Named(value = "testBean")
@RequestScoped
public class TestBean implements Serializable {

    private String test;

    public String update() {
        test = "Updated.";
        return "test";
    }

    // Getters and Setters...
} 
```

这是 的正文`test.xhtml`，删除了不相关的内容和样式：

```
<h:body>
    <p:layout id="layout" fullPage="true">

        <p:layoutUnit position="north">
            <!-- Does not matter -->
        </p:layoutUnit>

        <p:layoutUnit id="input" position="west">
            <p:panel header="">
                <p:tabView>
                    <p:tab title="">
                        <!-- INPUTS and SUBMIT BUTTON -->
                    </p:tab>
                </p:tabView>
            </p:panel>
        </p:layoutUnit>

        <p:layoutUnit id="output" position="center">
            <h:form>
                <p:panel id="display" header="Information">  
                    <h:outputText value="#{testBean.test}" />  
                </p:panel>
                <p:separator />
                    <p:commandButton value="Update !" action="#{testBean.update()}" ajax="false" />
            </h:form>
        </p:layoutUnit>

        <p:layoutUnit position="south">
            <!-- Does not matter -->
        </p:layoutUnit>

    </p:layout>
</h:body> 
```

一切正常。我有两个问题：

1.  我应该将 移动`commandButton`到另一个`layoutUnit`（输入）并且我无法将`<h:form>`元素放置在合理的位置。我尝试将它移到旁边`<p:layout>`，使其包含所有布局单元，但它损坏了（更新的页面不再具有“更新。”字符串）。

2.  我想使用另一个 layoutUnit 上的按钮通过 ajax 执行更新。当我`ajax="false"`从全局表单元素中删除属性`commandButton`并设置属性时`prependId="false"`，输出文本不会更新。

在此先感谢您的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T00:34:23.400

> *我应该将 commandButton 移动到另一个 layoutUnit（输入）并且我无法将`<h:form>`元素放置在合理的位置。我尝试将它移到旁边`<p:layout>`，使其包含所有布局单元，但它损坏了（更新的页面不再具有“更新。”字符串）。*

我不确定我是否理解你的具体问题。只是做这样的事情？

```
<p:layoutUnit id="input" position="west">
    <p:panel header="">
        <p:tabView>
            <p:tab title="">
                <!-- INPUTS and SUBMIT BUTTON -->
            </p:tab>
        </p:tabView>
        <h:form>
            <p:commandButton value="Update !" action="#{testBean.update}" ajax="false" />
        </h:form>
    </p:panel>
</p:layoutUnit>

<p:layoutUnit id="output" position="center">
    <p:panel id="display" header="Information">  
        <h:outputText value="#{testBean.test}" />  
    </p:panel>
    <p:separator />
</p:layoutUnit> 
```

* * *

> *我想使用另一个 layoutUnit 上的按钮通过 ajax 执行更新。当我从 commandButton 中删除 ajax="false" 属性并为全局表单元素设置 prependId="false" 属性时，输出文本不会更新。*

`update`ID 必须是相对或绝对的客户端 ID 。至于如何计算正确的客户端 ID，请查看以下答案：[How to find out client ID of component for ajax update/render? 找不到从“bar”引用的表达式“foo”的组件](https://stackoverflow.com/questions/8634156/how-to-reference-components-in-jsf-ajax-cannot-find-component-with-identifier/8644762#8644762)

PrimeFaces 布局组件不是 a `NamingContainer`，因此它的 ID 不会被添加到前面，并且一旦您`<h:form>`取出中心布局，就`<p:panel id="display">`可以通过命令按钮访问`:display`。因此，这应该这样做：

```
<p:layoutUnit id="input" position="west">
    <p:panel header="">
        <p:tabView>
            <p:tab title="">
                <!-- INPUTS and SUBMIT BUTTON -->
            </p:tab>
        </p:tabView>
        <h:form>
            <p:commandButton value="Update !" action="#{testBean.update}" update=":display" />
        </h:form>
    </p:panel>
</p:layoutUnit>

<p:layoutUnit id="output" position="center">
    <p:panel id="display" header="Information">  
        <h:outputText value="#{testBean.test}" />  
    </p:panel>
    <p:separator />
</p:layoutUnit> 
```

# css - 页面或内容底部的页脚，以较低者为准

> ID：12239166
> 
> 赞同：108
> 
> 时间：2012-09-02T19:42:59.877
> 
> 标签：css, html, footer

我有以下结构：

```
<body>
    <div id="main-wrapper">
        <header>
        </header>
        <nav>
        </nav>
        <article>
        </article>
        <footer>
        </footer>
    </div>
</body> 
```

`<article>`我在使用 javascript中动态加载内容。因此，`<article>`块的高度可以改变。

当有很多内容时，我希望该`<footer>`块位于页面底部，或者当只有几行内容存在时，位于浏览器窗口的底部。

目前我可以做一个或另一个......但不能两者兼而有之。

那么有谁知道我该怎么做 - 让它`<footer>`贴在页面/内容的底部或屏幕的底部，具体取决于哪个较低。

* * *

## 回答 #1

> 赞同：116
> 
> 时间：2012-09-03T19:27:30.967

[Ryan Fait 的粘性页脚](https://web.archive.org/web/20161016193648/http://ryanfait.com/sticky-footer/)非常好，但我发现它的基本结构有所欠缺*。

* * *

# 弹性盒版本

如果你足够幸运，可以使用 flexbox 而不需要支持旧版浏览器，粘性页脚变得非常简单，*并且*支持动态大小的页脚。

使用 flexbox 让页脚粘在底部的技巧是让同一个容器中的其他元素垂直弯曲。所需要的只是一个全高包装元素，`display: flex`并且至少有一个兄弟元素的`flex`值大于`0`：

[CSS：]

```
html,
body {
  height: 100%;
  margin: 0;
  padding: 0;
}

#main-wrapper {
  display: flex;
  flex-direction: column;
  min-height: 100%;
}

article {
  flex: 1;
} 
```

```
html,
body {
  height: 100%;
  margin: 0;
  padding: 0;
}
#main-wrapper {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
  min-height: 100%;
}
article {
  -webkit-box-flex: 1;
      -ms-flex: 1;
          flex: 1;
}
header {
  background-color: #F00;
}
nav {
  background-color: #FF0;
}
article {
  background-color: #0F0;
}
footer {
  background-color: #00F;
}
```

```
<div id="main-wrapper">
   <header>
     here be header
   </header>
   <nav>
   </nav>
   <article>
     here be content
   </article>
   <footer>
     here be footer
   </footer>
</div>
```

* * *

如果你不能使用 flexbox，我选择的基本结构是：

```
<div class="page">
  <div class="page__inner">
    <header class="header">
      <div class="header__inner">
      </div>
    </header>
    <nav class="nav">
      <div class="nav__inner">
      </div>
    </nav>
    <main class="wrapper">
      <div class="wrapper__inner">
        <div class="content">
          <div class="content__inner">
          </div>
        </div>
        <div class="sidebar">
          <div class="sidebar__inner">
          </div>
        </div>
      </div>
    </main>
    <footer class="footer">
      <div class="footer__inner">
      </div>
    </footer>
  </div>
</div> 
```

这与以下内容相去甚远：

```
<div id="main-wrapper">
    <header>
    </header>
    <nav>
    </nav>
    <article>
    </article>
    <footer>
    </footer>
</div> 
```

让页脚粘贴的技巧是让页脚锚定到其包含元素的底部填充。这*要求*页脚的高度是静态的，但我发现页脚通常是静态高度。

[HTML：]

```
<div id="main-wrapper">
    ...
    <footer>
    </footer>
</div> 
```

[CSS：]

```
#main-wrapper {
    padding: 0 0 100px;
    position: relative;
}

footer {
    bottom: 0;
    height: 100px;
    left: 0;
    position: absolute;
    width: 100%;
} 
```

```
#main-wrapper {
  padding: 0 0 100px;
  position: relative;
}

footer {
  bottom: 0;
  height: 100px;
  left: 0;
  position: absolute;
  width: 100%;
}

header {
  background-color: #F00;
}
nav {
  background-color: #FF0;
}
article {
  background-color: #0F0;
}
footer {
  background-color: #00F;
}
```

```
<div id="main-wrapper">
   <header>
     here be header
   </header>
   <nav>
   </nav>
   <article>
     here be content
   </article>
   <footer>
     here be footer
   </footer>
</div>
```

将页脚锚定到 后`#main-wrapper`，您现在`#main-wrapper`至少需要达到页面的高度，除非其子项更长。这是通过制作`#main-wrapper`have a `min-height`of来完成的`100%`。您还必须记住它的父母，`html`并且`body`还需要与页面一样高。

[CSS：]

```
html,
body {
    height: 100%;
    margin: 0;
    padding: 0;
}

#main-wrapper {
    min-height: 100%;
    padding: 0 0 100px;
    position: relative;
}

footer {
    bottom: 0;
    height: 100px;
    left: 0;
    position: absolute;
    width: 100%;
} 
```

```
html,
body {
  height: 100%;
  margin: 0;
  padding: 0;
}

#main-wrapper {
  min-height: 100%;
  padding: 0 0 100px;
  position: relative;
}

footer {
  bottom: 0;
  height: 100px;
  left: 0;
  position: absolute;
  width: 100%;
}

header {
  background-color: #F00;
}
nav {
  background-color: #FF0;
}
article {
  background-color: #0F0;
}
footer {
  background-color: #00F;
}
```

```
 <div id="main-wrapper">
   <header>
     here be header
   </header>
   <nav>
   </nav>
   <article>
     here be content
   </article>
   <footer>
     here be footer
   </footer>
</div>
```

当然，你应该质疑我的判断，因为这段代码迫使页脚从页面底部掉下来，即使没有内容。最后一个技巧是更改 the 使用的盒子模型，`#main-wrapper`以便`min-height`of`100%`包含`100px`填充。

[CSS：]

```
html,
body {
    height: 100%;
    margin: 0;
    padding: 0;
}

#main-wrapper {
    box-sizing: border-box;
    min-height: 100%;
    padding: 0 0 100px;
    position: relative;
}

footer {
    bottom: 0;
    height: 100px;
    left: 0;
    position: absolute;
    width: 100%;
} 
```

```
html,
body {
  height: 100%;
  margin: 0;
  padding: 0;
}

#main-wrapper {
  box-sizing: border-box;
  min-height: 100%;
  padding: 0 0 100px;
  position: relative;
}

footer {
  bottom: 0;
  height: 100px;
  left: 0;
  position: absolute;
  width: 100%;
}

header {
  background-color: #F00;
}
nav {
  background-color: #FF0;
}
article {
  background-color: #0F0;
}
footer {
  background-color: #00F;
}
```

```
 <div id="main-wrapper">
   <header>
     here be header
   </header>
   <nav>
   </nav>
   <article>
     here be content
   </article>
   <footer>
     here be footer
   </footer>
</div>
```

有了它，一个带有原始 HTML 结构的粘性页脚。只要确保`footer`'s`height`等于`#main-wrapper`'s `padding-bottom`，你就应该被设置。

* * *

^(* 我认为 Fait 的结构有问题的原因是它在不同的层级上设置了`.footer`and元素，同时添加了一个不必要的元素。`.header``.push`)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-09-02T19:45:33.340

[Ryan Fait 的粘性页脚](http://ryanfait.com/sticky-footer/)是一个简单的解决方案，我过去曾多次使用过。

**基本 HTML**：

```
<div class="wrapper">
    <div class="header">
        <h1>CSS Sticky Footer</h1>
    </div>
    <div class="content"></div>
    <div class="push"></div>
</div>
<div class="footer"></div> 
```

**CSS**：

```
* {
    margin: 0;
}
html, body {
    height: 100%;
}
.wrapper {
    min-height: 100%;
    height: auto !important;
    height: 100%;
    margin: 0 auto -142px; /* the bottom margin is the negative value of the footer's height */
}
.footer, .push {
    height: 142px; /* .push must be the same height as .footer */
}

/*

Sticky Footer by Ryan Fait
http://ryanfait.com/

*/ 
```

将其翻译为类似于您已经通过以下方式获得的结果：

**HTML**：

```
<body>
    <div class="wrapper">
        <header>
        </header>
        <nav>
        </nav>
        <article>
        </article>
        <div class="push"></div>
    </div>
    <footer>
    </footer>
</body> 
```

CSS：

```
* {
    margin: 0;
}
html, body {
    height: 100%;
}
.wrapper {
    min-height: 100%;
    height: auto !important;
    height: 100%;
    margin: 0 auto -142px; /* the bottom margin is the negative value of the footer's height */
}
footer, .push {
    height: 142px; /* .push must be the same height as .footer */
} 
```

只是不要忘记更新包装边距上的负数以匹配页脚的高度并推送 div。祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-04-02T12:28:59.487

我希望在不添加任何额外标记的情况下解决这个问题，所以我最终使用了以下解决方案：

```
article {
  min-height: calc(100vh - 150px); /* deduct the height or margins of any other elements within wrapping container*/
}

footer {
  height: 50px;
}

header {
   height: 50px;
}

nav {
  height: 50px;
}
```

```
<body>
  <div id="main-wrapper">
    <header>
    </header>
    <nav>
    </nav>
    <article>
    </article>
    <footer>
    </footer>
  </div>
</body>
```

您必须知道页眉、导航和页脚的高度才能设置文章的最小高度。这样，如果文章只有几行内容，页脚将粘在浏览器窗口的底部，否则它将位于所有内容的下方。

您可以在此处找到上面发布的此解决方案和其他解决方案：[https ://css-tricks.com/couple-takes-sticky-footer/](https://css-tricks.com/couple-takes-sticky-footer/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-03-17T05:37:22.840

我想用 css-grid 来解决这个问题。`#main-wrapper`我将在您的div中制作两部分。第一个用于内容，第二个用于页脚。

```
// HTML 

<body>
<div id="main-wrapper">
  <div class="main-content">
    <header></header>
    <nav></nav>
    <article></article>
  </div>
  <footer class="footer">
    footer
  </footer>
</div>
</body> 
```

在 CSS 中

```
#main-wrapper {
  min-height: 100%;
  display: grid;
  grid-template-rows: 1fr auto;
}
.footer {
  grid-row-start: 2;
  grid-row-end: 3;
  background-color: #a45657;
  color: white;
  text-align: center;
  padding: 10px;
  font-size: 20px;
} 
```

[您可以在此处](https://codesandbox.io/s/wizardly-blackwell-dfbx2?file=/src/styles.css:58-299)查看工作演示（请查看项目视图）。这段代码取自我最喜欢的 CSS 站点[css-tricks](https://css-tricks.com/couple-takes-sticky-footer/)。

# javascript - 如果在主题标签链接上点击刷新，则返回 index.html

> ID：12239167
> 
> 赞同：2
> 
> 时间：2012-09-02T19:43:04.943
> 
> 标签：javascript, html, redirect, hashtag

我正在制作一个网站，一旦有人点击刷新，我使用的整个 jQuery 脚本就会表现得很奇怪 - 所以我认为当有人刷新时，他们的 URL 会从让我们说`www.website.com/index.html#test`变为`www.website.com/index.html`......这可能吗，如果可以，怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T20:00:08.043

您可以做的是检查 url 是否包含哈希，因此：

```
var url=window.location;
if(url.indexOf('#')!=-1){
   window.location = 'index.html';
} 
```

它的`indexOf`作用是检查一个字符串是否包含一些子字符串，如果包含，则返回该子字符串所在位置的索引，如果找不到，则返回-1，所以我们在那里所做的就是检查它是否t 不等于 -1 所以这意味着子字符串存在然后我们要转到 index.html

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-26T12:33:27.187

```
window.onbeforeunload = function(e) 
{
    window.location = "index.html#introduction";
}; 
```

这使您可以将刷新重定向到另一个部分，但重定向到 index.html 似乎不起作用

# sql - 如何在 SQL 中的一个字段上选择不重复的记录？

> ID：12239169
> 
> 赞同：75
> 
> 时间：2012-09-02T19:43:10.300
> 
> 标签：sql, select, duplicates, distinct

我有一个包含 3 列的表格，如下所示：

```
+------------+---------------+-------+  
| Country_id | country_title | State |  
+------------+---------------+-------+ 
```

这张表中有很多记录。其中一些有`state`，而另一些则没有。现在，想象一下这些记录：

```
1 | Canada  | Alberta  
2 |  Canada | British  Columbia  
3 | Canada  | Manitoba  
4 | China   | 
```

我需要有没有任何重复的国名。实际上我需要他们的`id`and `title`，最好的 SQL 命令是什么？我`DISTINCT`在下面的表格中使用，但我无法获得适当的结果。

```
SELECT DISTINCT title,id FROM tbl_countries ORDER BY title 
```

我想要的结果是这样的：

```
1, Canada  
4, China 
```

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2012-09-02T19:58:10.077

试试这个：

```
SELECT MIN(id) AS id, title
FROM tbl_countries
GROUP BY title 
```

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2012-09-02T19:47:59.367

`DISTINCT`是关键字
对我来说你的查询是正确的

试着先做这个

```
SELECT DISTINCT title,id FROM tbl_countries 
```

稍后您可以尝试使用 order by。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2015-04-28T07:22:32.087

对于 using`DISTINCT`关键字，您可以像这样使用它：

```
SELECT DISTINCT 
    (SELECT min(ti.Country_id) 
     FROM tbl_countries ti 
     WHERE t.country_title = ti.country_title) As Country_id
    , country_title
FROM 
    tbl_countries t 
```

* * *

对于 using `ROW_NUMBER()`，您可以像这样使用它：

```
SELECT 
    Country_id, country_title 
FROM (
    SELECT *, ROW_NUMBER() OVER (PARTITION BY country_title ORDER BY Country_id) As rn
    FROM tbl_countries) t
WHERE rn = 1 
```

* * *

同样使用 using `LEFT JOIN`，您可以使用它：

```
SELECT t1.Country_id, t1.country_title
FROM tbl_countries t1
    LEFT OUTER JOIN
    tbl_countries t2 ON t1.country_title = t2.country_title AND t1.Country_id > t2.Country_id
WHERE
    t2.country_title IS NULL 
```

* * *

并使用 of `EXISTS`，您可以尝试：

```
SELECT t1.Country_id, t1.country_title
FROM tbl_countries t1   
WHERE
    NOT EXISTS (SELECT 1 
                FROM tbl_countries t2 
                WHERE t1.country_title = t2.country_title AND t1.Country_id > t2.Country_id) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-08-26T13:28:27.957

试试这个

```
SELECT country_id, country_title 
FROM (SELECT country_id, country_title,
CASE
WHEN country_title=LAG(country_title, 1, 0) OVER(ORDER BY country_title) THEN 1
ELSE 0
END AS "Duplicates"
FROM tbl_countries)
WHERE "Duplicates"=0; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-02-26T02:06:44.833

`GROUP_CONCAT`在 MySQL 中，可以使用特殊的列函数：

```
SELECT GROUP_CONCAT(COLUMN_NAME)
FROM INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_SCHEMA = 'computers' AND
    TABLE_NAME='Laptop' AND
    COLUMN_NAME NOT IN ('code')
ORDER BY ORDINAL_POSITION; 
```

需要指出的是，MySQL 中的信息模式涵盖了所有数据库服务器，而不是某些数据库。这就是为什么如果不同的数据库包含具有相同子句`names, search`条件的表应该指定模式名称： .`WHERE``TABLE_SCHEMA='computers'`

字符串与`CONCAT`MySQL 中的函数连接。我们问题的最终解决方案在 MySQL 中可以表示为：

```
SELECT CONCAT('SELECT ',
(SELECT GROUP_CONCAT(COLUMN_NAME)
 FROM INFORMATION_SCHEMA.COLUMNS
 WHERE TABLE_SCHEMA='computers' AND
    TABLE_NAME='Laptop' AND
        COLUMN_NAME NOT IN ('code')
 ORDER BY ORDINAL_POSITION
), ' FROM Laptop'); 
```

[http://www.sql-ex.ru/help/select20.php](http://www.sql-ex.ru/help/select20.php)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-02-18T17:13:59.227

```
select Country_id,country_title from(
   select Country_id,country_title,row_number() over (partition by country_title 
   order by Country_id  ) rn from country)a
   where rn=1; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-06-06T06:22:36.017

忽略 SQL 中的重复行。我想这可能会对你有所帮助。

```
 SELECT res2.*
    FROM
    (SELECT res1.*,ROW_NUMBER() OVER(PARTITION BY res1.title ORDER BY res1.id)as num
     FROM 
    (select * from [dbo].[tbl_countries])as res1
    )as res2
    WHERE res2.num=1 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-09-07T04:53:11.293

可以通过以下方式删除**复杂查询**的重复行，

首先将结果存储到 #TempTable 或 @TempTableVariable

从 #TempTable 或 @TempTableVariable 删除您的条件

然后选择其余数据。

如果需要创建行号创建标识列。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2017-08-04T11:19:58.523

`Having`子句是在 Oracle 中查找重复条目的最简单方法，使用`rowid`我们可以删除重复数据。

```
DELETE FROM products WHERE rowid IN (
  SELECT MAX(sl) FROM (
  SELECT itemcode, (rowid) sl FROM products WHERE itemcode IN (
  SELECT itemcode FROM products GROUP BY itemcode HAVING COUNT(itemcode)>1
)) GROUP BY itemcode); 
```

# javascript - 在第三方函数返回时执行函数

> ID：12239170
> 
> 赞同：0
> 
> 时间：2012-09-02T19:43:14.990
> 
> 标签：javascript

我需要“检测”某些第三方函数何时返回，然后执行我自己的函数。

示例：一些我没有写的函数

```
function foo(params1){
  console.log(params1);
} 
```

我的功能：

```
function bar(params2){
  console.log(params2);
} 
```

我需要它，无论何时`foo`被调用，它都会以某种方式`bar`立即调用！我试过这样：

```
foo = function(params1){
  console.log(params1);
  bar(params2);
} 
```

意思是我“覆盖” `foo`..但有时（总是）`foo`代码太长+传递`params2`（次要）问题。我尝试了原型等绝望的尝试，但后来我想我需要一些支持。

我也试过这个：（但是）

```
var tmp = foo;
foo = function(params1) {
  tmp(params1);
  bar(params2);
} 
```

同样的问题，调用者将调用`foo(params1)`因此 bar 不会 "find" `params2`。

* * *

我需要这个来制作类似“事件处理程序”的东西。
第三方函数进行一些 ajax 调用，作用于 DOM，我立即采取行动。
有没有一种巧妙的方法来做到这一点？我希望这很有趣。谢谢。
ps：我虽然想要`params2`全球化，但我仍然需要一个“原创”的解决方案:)

至于 的使用`params2`，假设我想为每个要挂钩的函数使用不同的参数。

例子：

```
var tmp = foo_1;
foo_1 = function(params1) {
  tmp(params1);
  bar(params2);
}

tmp = foo_2;
foo_2 = function(params1) {
  tmp(params1);
  bar(params3);
}
//etc.. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T19:47:34.073

如果`foo`是一个全局函数，你可以像这样使用[`.apply()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/apply)and来挂钩它[`arguments`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Functions_and_function_scope/arguments)：

```
var oldFoo = foo;
foo = function() {
    // call oldFoo with whatever arguments were passed
    var returnVal = oldFoo.apply(this, arguments);

    // do your thing
    bar(params2);

    // if oldFoo had a returned value, return it here
    return(returnVal);
} 
```

您可以在调用原件之前或之后完成您的工作。 [`.apply()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/apply)并[`arguments`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Functions_and_function_scope/arguments)允许您将原始参数（无论它们是什么）传递给`foo`您，甚至不必知道它们是什么。

在您的代码示例中，您没有说`params2`来自哪里，因此我们很难知道如何将它们注入。您可以从传递给的原始参数中提取它们`foo`，您可以将它们构建到函数中或从某个对象中检索它们。

这些是您确定`params2`应该是什么并将它们适当地传递给的选项`bar()`：

1.  **从传递给`foo`.** 要么将相同的参数传递给，要么`bar`查看传递给`foo`的参数并从中创建参数`bar`。
2.  **每次都让他们做同样的事情。** 您只需将其编码到新函数中。听起来这不是你想要的。
3.  在`foo`被调用之前，**将所需的参数`bar`放入某种全局可访问的变量**中，然后在您的替换函数中，您可以从该全局变量中获取它们。
4.  在`foo`被调用之前，**将所需的参数`bar`放入某种闭包中**，以便您可以从替换函数中的闭包中获取它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T19:47:41.570

您可以使用[function.apply](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/apply)将 传递[`arguments`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Functions_and_function_scope/arguments)给函数

```
var tmp = foo;
foo = function(params1) {
  tmp.apply(this, arguments);
  bar(params2);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-02T20:12:56.733

也许你应该使用一个简单的[pubSub](https://github.com/mroderick/PubSubJS)系统来在调用 foo 时得到通知。这将解耦您对`bar`from的调用`foo`。

```
(function(){
  var footmp = foo;

   foo = function(){
     var result = footmp.apply(this, arguments);
     PubSub.publish('fireBar');
     return result;
  }
})()

PubSub.subscribe( 'fireBar', function(){
 // try to figure out whats params2
 bar(params2)
} ); 
```

# symfony - 原则：删除实体而不加载

> ID：12239172
> 
> 赞同：0
> 
> 时间：2012-09-02T19:43:22.010
> 
> 标签：symfony, doctrine

我想删除一个对象，它是另一个对象的属性，但是当我这样做时，我得到一个异常说“找不到实体”。</p>

我的意思的一个例子：

```
// Foo has a private property, bar, which is an instance of Bar
$foo = $this->get('my_bundle.repository.foo')->find($fooId);
$bar = $foo->getBar();

$entityManager = $this->get('doctrine.orm.entity_manager');
$entityManager->remove($bar);
$entityManager->flush(); 
```

我猜这是因为实体管理器没有`Bar`直接加载的实例，因为以下似乎有效：

```
// Foo has a private property, bar, which is an instance of Bar
$foo = $this->get('my_bundle.repository.foo')->find($fooId);
$bar = $this->get('my_bundle.repository.foo')->find($bar->getId());

$entityManager = $this->get('doctrine.orm.entity_manager');
$entityManager->remove($bar);
$entityManager->flush(); 
```

有没有办法在不重新加载的情况下完成这项工作`$bar`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T21:21:19.780

问题是当您刷新实体管理器时 Foo 仍然具有 Bar 作为属性。做

```
$foo->setBar(null);
$entityManager->persist($foo); 
```

在你冲水之前

# css - 将现有的 Web 渐变转换为单一颜色的透明叠加层

> ID：12239185
> 
> 赞同：0
> 
> 时间：2012-09-02T19:45:28.877
> 
> 标签：css

我想要实现的是将使用十六进制颜色值的现有网络渐变更改为只是黑色的网络渐变，并在需要时添加不透明度以使背景颜色变暗。

所以，转换这个：

```
background-color: #76b347;
background-image: -webkit-gradient(linear, left top, left bottom, color-stop(0%, #76b347), color-stop(100%, #5e9e2e));
background-image: linear-gradient(top, #76b347, #5e9e2e); 
```

对于这样的事情（但具有正确的值，所以它看起来是一样的）：

```
background-color: #76b347;
background-image: -webkit-gradient(linear, left top, left bottom, color-stop(0%, rgba(0, 0, 0, 0)), color-stop(100%, rgba(0, 0, 0, 0.3)));
background-image: linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.3)); 
```

# php - Codeigniter 批量更新引发有关索引的错误

> ID：12239187
> 
> 赞同：0
> 
> 时间：2012-09-02T19:45:32.837
> 
> 标签：php, sql, codeigniter, sql-update

codigniter 中的以下代码给我一个更新数组的错误：

```
$query="UPDATE sell_rate SET price='$price' WHERE code='$code'";
                $this->db->query($query); 
```

错误是：

> 您必须为批量更新指定要匹配的索引

请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-25T07:59:07.407

试试这个代码

$options = array('price'=>$price);
$this->db->where('code', $code);
$this->db->update('sell_rate', $options);

# python - 组合矩阵和稀疏矩阵

> ID：12239191
> 
> 赞同：4
> 
> 时间：2012-09-02T19:46:22.887
> 
> 标签：python, matrix, numpy, scipy, sparse-matrix

如何将 1 列矩阵添加到稀疏矩阵，或将稀疏矩阵添加到列矩阵（无论哪种方式）？它不应该替换数据，只需将其加入一种数据类型。

稀疏矩阵：

```
>>print type(X)
>>print X.shape
<class 'scipy.sparse.csr.csr_matrix'>
(53, 6596) 
```

要添加的列：

```
>>print type(Y)
>>print Y.shape
<class 'numpy.matrixlib.defmatrix.matrix'>
(53, 1) 
```

你怎么能做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-02T20:09:20.020

从文档中，在我看来，您正在从模块中寻找`hstack`/ ：`vstack``scipy.sparse`

```
Python 2.6.5 (r265:79063, Apr 16 2010, 13:57:41) 
[GCC 4.4.3] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import scipy.sparse as ssp
>>> print ssp.hstack.__doc__

    Stack sparse matrices horizontally (column wise)

    Parameters
    ----------
    blocks
        sequence of sparse matrices with compatible shapes
    format : string
        sparse format of the result (e.g. "csr")
        by default an appropriate sparse matrix format is returned.
        This choice is subject to change.

    See Also
    --------
    vstack : stack sparse matrices vertically (row wise)

    Examples
    --------
    >>> from scipy.sparse import coo_matrix, vstack
    >>> A = coo_matrix([[1,2],[3,4]])
    >>> B = coo_matrix([[5],[6]])
    >>> hstack( [A,B] ).todense()
    matrix([[1, 2, 5],
            [3, 4, 6]])

>>> 
```

# android - 添加 facebook/google+/twitter 喜欢按钮

> ID：12239196
> 
> 赞同：-2
> 
> 时间：2012-09-02T19:46:48.767
> 
> 标签：android

我从网站下载了一些文章并将它们显示在我的应用程序中。每篇文章都有一个用于 facebook google+ 和 twitter 的按钮，我想将这些按钮保留在我的应用程序中。

我想用 html 文本和这些按钮的 html/javascript 代码设置一个 textview ......它可以工作吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T19:53:15.227

不，我不希望一个简单的文本视图来处理 HTML 和 Javascript。所以在你的情况下，你应该要么

1.  使用 Facebook/google+/twitter API 自己实现这些按钮，
2.  或者尝试使用 WebView ( [http://developer.android.com/reference/android/webkit/WebView.html](http://developer.android.com/reference/android/webkit/WebView.html) ) - 应用程序中的小型浏览器。它将支持 html 和 JS，但是，不能保证 +1 会起作用，因为它很可能需要用户登录并具有活动会话，而且我不确定 WebView 是否会与其他浏览器共享 Cookie。这种方式需要检查。

但是，您始终可以从此 WebView 重定向到系统浏览器，如果需要，它将处理 +1 并显示登录屏幕。

祝你好运

# qt - Qt N9显示页面时更改滚动方向

> ID：12239197
> 
> 赞同：0
> 
> 时间：2012-09-02T19:46:59.293
> 
> 标签：qt, qml

语言：Qt Quick (QML)

平台：Qt Creator 2.4.1

目标设备 N9

你好

通常在显示新页面时，例如

```
 onClicked: {
          pageStack.push(Qt.resolvedUrl("ExitDialog.qml"))
      } 
```

新页面“从右侧滑入”，是否可以改变这种行为？

我想更改滑动，以便新窗口从左侧进入，并在关闭时向左侧“离开”。

是否有 Page/PageStackWindow 的标签可以改变这一点？

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T20:31:45.050

您可以将需要的系统 qml 文件添加到您的项目并进行编辑。对于您的示例，从 PageStack.qml 更改代码：

```
// Start state for pop entry, end state for push exit.
State {
   name: "left"
   PropertyChanges { target: container; x: -width }
},
// Start state for push entry, end state for pop exit.
State {
   name: "right"
   PropertyChanges { target: container; x: width }
}, 
```

到

```
// Start state for pop entry, end state for push exit.
State {
   name: "left"
   PropertyChanges { target: container; x: width }
},
// Start state for push entry, end state for pop exit.
State {
   name: "right"
   PropertyChanges { target: container; x: -width }
}, 
```

而且我也想知道如何更轻松地做到这一点。

# java - 检查和使用对话框输入时遇到问题

> ID：12239208
> 
> 赞同：0
> 
> 时间：2012-09-02T19:48:27.037
> 
> 标签：java, joptionpane, parseint

我刚开始学习java。它有点整洁，但我想用一些我认为非常简单的东西碰壁了。这是我正在做的部分工作：

```
import javax.swing.JApplet;
import javax.swing.JOptionPane;
import java.awt.Graphics;
import java.awt.Color;

@SuppressWarnings("serial")
public class DrawingShapes extends JApplet
{
  public static void main( String [] args )
  {
    int rgb = 0;
    boolean useful = false;
    String number = JOptionPane.showInputDialog("Make this easy for me.\n"
    +"Type an integer between 0 and 255");
    do
    {
      try
      {
        rgb = Integer.parseInt( number );
        if (rgb > 0 && rgb < 255)
        {
          useful = true;
        }
        else
        {
          useful = false;
        }
      }
      catch ( NumberFormatException nfe )
      {
        number = JOptionPane.showInputDialog( null, "\"" + number + "\""
        + " is not an integer between 0 and 255!\n"
        + "Lrn2 be doin' it right!" );
      }
    }
    while ( !useful );
    JOptionPane.showMessageDialog( null, "The integer is " + rgb);
  }
} 
```

这个想法是对话框要求输入一个数字，如果不是数字则显示错误并再次询问。实际上，现在效果很好。不过，我想要的是使用该数字 (rgb) 来创建在此类之外的小程序中使用的灰色阴影。

```
Color shade = new Color(rgb,rgb,rgb); 
```

这不起作用，因为它无法从另一个类中读取变量。或者，它可能可以，但我想我需要帮助弄清楚如何。

简而言之，我需要读取输入，验证它，并且以后仍然可以将其用于其他用途。我离这个目标有点远，所以我来stackoverflow寻求指导。

编辑：Dans 的建议确实帮助我解决了变量问题，但现在我遇到了无法绘制图形的问题。退出对话框后，小程序立即关闭。所以我还是有点难过。我只需要使用输入对话框中的颜色作为背景绘制一些简单的形状。代码的后半部分现在看起来像这样：

```
public static void main(String[] args)
  {
    new DrawingShapes().getColor();
  }
  public class Shade
  {
    private int color;
    public void setColor(int col)
    {
      color = col;
      System.out.println(color);
    }
    public void paint (Graphics canvas)
    {
      int col = color;
      Color gray = new Color(col,col,col);
      setBackground(gray)
      setSize(500, 500);  
      canvas.drawOval(0, 0, 500, 500);
      canvas.draw....[blablabla other shapes]
    }
  } 
```

除非我注释掉导致它的所有内容，否则它会完全跳过绘制选项...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T20:12:08.050

请参阅下面的代码以获取潜在的解决方案。我创建了一个名为 Shade 的新类，它有一个私有字段，可以使用公共 setter 方法从另一个类（您的类或任何其他类）设置。

请注意，我稍微更改了您的类，因为在 main 方法中包含所有内容并不好，这是静态的。

```
import javax.swing.JApplet;
import javax.swing.JOptionPane;

public class DrawingShapes extends JApplet {
  private Shade shade = new Shade();

  private void readColor() {
    int rgb = 0;
    boolean useful = false;
    String number = JOptionPane.showInputDialog("Make this easy for me.\n" + "Type an integer between 0 and 255");
    do {
      try {
        rgb = Integer.parseInt(number);
        if (rgb > 0 && rgb < 255) {
          useful = true;
          shade.setColor(rgb);
        } else {
          useful = false;
        }
      } catch (NumberFormatException nfe) {
        number = JOptionPane.showInputDialog(null, "\"" + number + "\"" + " is not an integer between 0 and 255!\n"
            + "Lrn2 be doin' it right!");
      }
    } while (!useful);
    JOptionPane.showMessageDialog(null, "The integer is " + rgb);
  }

  public static void main(String[] args) {
    new DrawingShapes().readColor();
  }

  public class Shade {
    private int color;

    public void setColor(int col) {
      color = col;
      System.out.println("The chosen color shade is " + color);
    }

  }
} 
```

# ios - Xcode 不会选择正确的 Provisioning Profile

> ID：12239212
> 
> 赞同：8
> 
> 时间：2012-09-02T19:48:42.747
> 
> 标签：ios, xcode

我有一个带有应用程序 ID 的分发证书的应用程序。我已将分发配置文件下载到我的管理器中，并将 info.plist 中的捆绑包 ID 设置为应用 ID。但是，当我尝试归档项目时，我得到

> 代码签名错误：配置文件“...”指定了与当前设置“mybundleid”不匹配的应用程序标识符“...”。

Xcode 正在查看不同的配置文件并说它是错误的，但我不想查看该配置文件，我希望它查看不同的配置文件。在构建设置中，它甚至说“（当前匹配...）到我正确的配置文件，所以我不明白发生了什么。

我也尝试过删除错误的配置文件，但它给了我另一个错误，即配置文件不存在。

有谁知道我在这里想念什么？谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-04-12T01:12:18.247

我昨晚遇到了同样的问题，花了5个多小时才解决这个问题。今天早上我终于弄明白了，原来我是在更改项目的构建设置，而不是 Xcode 中的目标...

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-05T08:46:16.053

确保 info plist 中的 bundle id 与用于在 iPhone 开发者中心创建配置文件的相同。

然后确保在目标设置中选择了正确的配置文件。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-02T22:32:33.487

我打赌您需要删除所有配置文件并添加所有需要的内容。这也解决[了这个](https://stackoverflow.com/questions/12216906/monotouch-push-notifications-aps-environment/12217040#12217040)案子。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-10-31T22:02:52.130

我在 XCode 6 中遇到了这个问题。我的项目中有两个目标，其中一个总是使用错误的配置文件构建，无论我做什么（包括更改构建设置中的配置配置文件设置）。

在玩了几个小时之后，我注意到以下几点：

1.  好的目标是使用名为“XC：com.mycompanyname.mytargetname1”的配置文件
2.  损坏的目标使用了一个名为“XC: *”的配置文件。此配置文件是“Xcode：通配符 AppID (* )”配置文件。

我不知道其中任何一个来自哪里，但我为解决我的问题所做的是：

1.  登录 developer.apple.com
2.  转到证书、标识符和配置文件
3.  单击左侧栏上的 Provisioning Profiles 下的“All”
4.  点击“+”
5.  创建了一个名为`XC: com.mycompanyname.mytargetname2`（注意：设置将特定于您。com.mycompanyname.mytargetname2 应替换为您的应用程序的捆绑 ID。

之后它起作用了。

# c# - 将随机数函数从 JS 复制到 C#

> ID：12239214
> 
> 赞同：2
> 
> 时间：2012-09-02T19:49:08.213
> 
> 标签：c#

我在 JS 中得到了这个函数

```
var number = Math.random() + "";
var r = number * 10000000000000; 
```

我需要 C# 中 100% 相同的函数，因为我是 C# 新手1 与此类似（0.7740926130209118, 0.6105941028799862），然后我想乘以 10000000000000，我们得到类似“2647182801738.3813 <---这就是我需要的东西。

我考虑过创建一个 13 位随机数和另一个 4 位随机数，然后将其添加为 13 位 + 。+ 4 位数。这当然不理想，但我也遇到了问题。

```
Random random = new Random(); int randomNumber = random.Next(1000000000000, 9999999999999); 
```

会给我错误`int`，我理解的是我应该使用`long`什么？但是当我更改它时`int`，`long`它仍然看起来像随机函数本身是 INT？好吧，我已经对我在网上找到的内容感到困惑，所以如果你能帮助解决这个问题并解释它是如何工作的，那就太好了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T19:52:44.120

尚未测试，但听起来您需要：

```
 Random random = new Random();

 long r = (long)(random.NextDouble() * 10000000000000); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T19:52:22.227

如果您想要一个确切的端口，请选择以下内容：

```
var number = (new Random()).NextDouble() * 10000000000000; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T20:00:29.013

C#也有一个`var`:)

```
using System;

public class Test
{
        public static void Main()
        {
           Random randObj = new Random();
           var number = randObj.NextDouble( ) * 10000000000000;
           Console.WriteLine( number ); 
        }
} 
```

...

```
input: no
output:
6426401076105.61 
```

# python - 金字塔检测照片上传

> ID：12239215
> 
> 赞同：1
> 
> 时间：2012-09-02T19:49:30.217
> 
> 标签：python, pyramid

所以我有一个设置页面，用户可以通过表单的发布请求将照片上传到网站，但是现在，我无法检测到用户是否上传了照片，因为还有其他部分表单，底部有一个提交按钮。现在，我正在使用`if 'file_input' in request.POST:`，但它总是返回 true，即使用户没有上传照片。如何检测用户是否实际上传了照片。html是：

```
<form class="group-photo" action="/${groupName}/settings" method="post" style="vertical-align:text-bottom" enctype="multipart/form-data">
            <span style="font-size:17px;font-weight:bold;">Group Photo</span>
            <img style="border-radius:15px;margin-top:5px;margin-bottom:5px;" src="/static/group/${photo_id}_120.${photo_ext}">
            <br>
            <div class="fileinputs">
                <input class="file" type="file" name="file_input" value="Choose image">

                <div class="fakefile" style="margin-left:40px;">
                    <input type="button" class="btn btn-primary" value="Choose image"/>
                </div>
            </div>
            <br/>
            <span style="font-size:17px;font-weight:bold;">Description</span>
            <textarea class="groupbio" name="groupbio">${bio}</textarea>
            <br>
            <br>
            <p><input class="btn btn-success" type="submit" name="submitted" value="Save Changes"></p>
        </form> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-02T20:11:47.587

浏览器包含表单中的所有文件输入元素，即使是空的，所以`'file_input' in request.POST'`测试将始终为 True，但如果为空，则它是一个空的 unicode 字符串 ( `u''`)。

正确的文件上传有一个文件名，测试一下：

```
if 'file_input' in request.POST and hasattr(request.POST['file_input'], 'filename'): 
```

文件上传是`cgi.FieldStorage`实例，`filename`测试是[`cgi`模块文档](http://docs.python.org/library/cgi.html)推荐的：

> 如果字段表示上传的文件，则通过 value 属性或 getvalue() 方法访问该值会将内存中的整个文件作为字符串读取。这可能不是你想要的。您可以通过测试文件名属性或文件属性来测试上传的文件。

# .net - 在 WebApi 中，我应该在调用 ActionFilter 之间将数据保存在哪里？

> ID：12239216
> 
> 赞同：4
> 
> 时间：2012-09-02T19:49:31.080
> 
> 标签：.net, asp.net-mvc-4, asp.net-web-api

我有一个[ActionFilterAttribute](http://msdn.microsoft.com/en-us/library/system.web.http.filters.actionfilterattribute%28v=vs.108%29.aspx)，它在目标操作之前和之后都做了一些事情。我想保存通话状态以供`Executing`通话使用`Executed`- 但我应该将这些数据保存在哪里？

我会期待这样的事情：

```
public override void OnActionExecuting(HttpActionContext actionContext)
{
    actionContext.SavedState = Precomputation();
}

public override void OnActionExecuted(HttpActionExecutedContext actionExecutedContext)
{
    var pre = actionExecutedContext.ActionContext.SavedState;
    Postcomputation(pre);
} 
```

但`SavedState`实际上并不存在，当然。我应该改用什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-02T20:55:06.057

根据需要添加项目`actionContext.Request.Properties`。

# ruby-on-rails - 测试 rails 设计的最简单示例应用程序

> ID：12239220
> 
> 赞同：1
> 
> 时间：2012-09-02T19:50:17.993
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, devise

我可以下载什么最简单的应用程序，以便我测试设计并使用它？我尝试了 devise_example（https://github.com/plataformatec/devise_example），但它与最新的 rails 和 devise 版本不兼容。还有其他例子吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T20:09:02.313

我相信这个示例应用程序是 Rails 3.2 最新的

[https://github.com/RailsApps/rails3-devise-rspec-cucumber](https://github.com/RailsApps/rails3-devise-rspec-cucumber)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T00:50:45.657

如果你还没有看过，[railscasts](http://www.railscasts.com)也是很好的入门方式。 [http://railscasts.com/episodes/209-introducing-devise](http://railscasts.com/episodes/209-introducing-devise)

这是一个专业链接（需要订阅） [http://railscasts.com/episodes/209-devise-revised](http://railscasts.com/episodes/209-devise-revised)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-28T14:17:02.130

RailsApps项目在**[GitHub](http://railsapps.github.io/)**上有最新的 Rails 4.1 示例应用程序：

> **[Rails 4.1 和设计](https://github.com/RailsApps/rails-devise/)**
> 
> **[Rails 4.1 和 Devise 和 Pundit](https://github.com/RailsApps/rails-devise-pundit/)**

# java - 我如何控制另一个类中的构造函数访问

> ID：12239222
> 
> 赞同：3
> 
> 时间：2012-09-02T19:50:22.817
> 
> 标签：java, design-patterns, constructor

我创建了一个类（ProjectsDataAccess）来处理对数据库的访问，这是该类可以做的：

1.  接收 Project 对象并将其保存到数据库中。
2.  从数据库中按 id 检索项目并将其作为 Project 对象返回。

这是类psudo代码：

```
 class ProjectsDataAccess {

        public void addProject(Project project) {
          // get the project data from the object and save it to the database
        }

        public void getProject() {
         // get the project data from the database and return new project 
         //object with that data
        }

      } 
```

这是项目对象：

```
class Project{

   private String name;
   private int id;

   private Project(){}

   Project(int id, String name){
     this. id = id;
     this.name = name;
   }
   Project(String name){
     this. id = // generate id
     this.name = name;
  }
} 
```

我的问题是我不希望该类的用户使用此构造函数创建对象并提供自己的 ID `Project(int id, String name)`，但我只希望 ProjectsDataAccess 类使用它，以便它能够从数据库中检索数据（包括 id）然后使用构造函数设置它。有没有办法我可以改变我的设计来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T19:58:00.413

一个解决方案是将`ProjectsDataAccess`和`Project`类保持在同一个包中，并使构造函数`Project(int id, String name)` **包可见**（没有任何修饰符，就像现在一样）。另一个构造函数`Project(String name)`需要`public`对客户端代码可见。当然，将客户端代码放在不同的包中。

```
 package foo;

 public class ProjectsDataAccess {

    public void addProject(Project project) {
      // get the project data from the object and save it to the database
    }

    public void getProject() {
     // get the project data from the database and return new project 
     //object with that data
    }

  }

package foo;

public class Project {

   private String name;
   private int id;

   private Project(){}

   Project(int id, String name){
      this. id = id;
      this.name = name;
   }

   public Project(String name){
      this. id = // generate id
      this.name = name;
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T19:59:05.183

我建议您仅使用用户应该调用的方法向用户返回不同的界面。

例如：

```
interface UserProjectInterface
{
   void AnyMethodUserIsSupposedToCall();
}

class Project implements ProjectUserInterface
{
   //constructor won-t be no longer visible to the client class
   public Project(){}
} 
```

然后只返回接口：

```
class ProjectsDataAccess {

   public void addProject(ProjectUserInterfaceproject);

   public ProjectUserInterfacegetProject getProject() {
     return new Project();
   }

} 
```

这种模式有几个不同的优点，因为您没有将具体类型暴露给客户端类。

* * *

编辑：

如果用户应该创建 UserProjectInterface 您可以使用工厂（例如[AbstractFactory](http://it.wikipedia.org/wiki/Abstract_factory)），以便封装对象创建：

```
interface AbstractProjectFactory
{
    UserProjectInterface CreateProject();

} 
```

并提供一个实例化您的具体对象的实现：

```
public AConcreteProjectFactory implements AbstractProjectFactory
{
    public UserProjectInterface CreateProject()
    {
       return new Project();
    }
} 
```

使用示例：

```
//client class:
AbstractProjectFactory factory = new AConcreteProjectFactory();
UserProjectInterface project = factory.CreateProject();

ProjectsDataAccess access = new ProjectsDataAccess();
access.addProject(project ); 
```

# java - 如何从文本文件中选择随机名称？

> ID：12239224
> 
> 赞同：0
> 
> 时间：2012-09-02T19:50:36.620
> 
> 标签：java

我是一名初学者 java 程序员 我已经设法在每一行上创建一个文件并存储名称，它是这种格式

name1
name2
name3

如何选择一个随机名称并打印它？谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T19:58:50.290

您可以将其全部读入一个字符串，将其拆分为一个字符串数组，然后使用“math”中的“random”生成伪随机数以在每个间隔中选择一个，或者您可以使用带有上述建议的“randomAccessFile”仅最大随机数将是文件长度，您将被迫寻找下一个空格以选择您想要的名称，并处理您在最后一个位置选择位置的情况

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T19:59:34.993

```
String fileName = "...the path and name of your file....";
ArrayList<String> allNames = new ArrayList<String>();
Random r = new Random();

BufferedReader in = new BufferedReader(new FileReader(fileName)); 
while (in.ready()) { 
     allNames.add( in.readLine() );
}
in.close();

String randomName = allNames.get(r.nextInt(allNames.size())); 
```

# php - PHP缓存头覆盖

> ID：12239225
> 
> 赞同：5
> 
> 时间：2012-09-02T19:51:00.503
> 
> 标签：php, cache-control

我已经在这里回答了 100 多个答案，尝试了很多，没有任何工作？

有一个基于 PHP 的网站。我需要为所有 .php 文件缓存 OFF，除了 SELECT FEW。

因此，在 .htaccess 中，我有以下内容：

```
ExpiresActive On
# Eliminate caching for certain dynamic files
<FilesMatch "\.(php|cgi|pl)$">
ExpiresDefault A0
Header set Cache-Control "no-cache, no-store, must-revalidate, max-age=0, proxy-revalidate, no-transform"
Header set Pragma "no-cache"
</FilesMatch> 
```

使用 Firebug，我看到以下内容：

```
Cache-Control   no-cache, no-store, must-revalidate, max-age=0, proxy-revalidate, no-transform
Connection  Keep-Alive
Content-Type    text/html
Date    Sun, 02 Sep 2012 19:22:27 GMT
Expires Sun, 02 Sep 2012 19:22:27 GMT
Keep-Alive  timeout=3, max=100
Pragma  no-cache
Server  Apache
Transfer-Encoding   chunked
X-Powered-By    PHP/5.2.17 
```

嘿，看起来很棒！

但是，我有几个 .php 页面需要一些非常短的缓存。

我认为简单的答案是将其添加到我希望启用缓存的每个 php 页面的最顶部：

```
<?php header("Cache-Control: max-age=360"); ?> 
```

没有。

然后我尝试了上述的各种版本。没有。

然后我尝试了 meta http-equiv 变体。没有。

然后我尝试了 .htaccess 代码的变体以及上述变体，例如将其限制为：

```
# Eliminate caching for certain dynamic files
<FilesMatch "\.(php|cgi|pl)$">
Header set Cache-Control "no-cache, max-age=0"
</FilesMatch> 
```

没有。

似乎我所做的任何事情都不会允许使用 .htaccess 代码启用单个 .php 缓存，而不是完全从 .htaccess 文件中删除语句。

我哪里错了？我该怎么做才能使单个 php 页面可缓存而其余页面保持关闭？

谢谢你的任何想法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T16:50:37.973

好吧，显然这没有答案。因此，我此时的解决方案是完全消除 .htaccess 代码，并将显式标头应用于每个文件。你知道的痛苦，但现在是继续前进的时候了。如果有人有更优雅的解决方案可以使用 .htaccess 默认值，请随时分享...谢谢

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-05-09T23:30:46.617

所以我知道我迟到了……也许为时已晚。但我遇到了一个类似的问题，我想我会分享我的解决方案。

基本上，我为每个我不想被缓存的文件（或者与我的静态资源具有不同的缓存时间）关闭了 ExpiresActive。它看起来像这样：

```
ExpiresActive On

<FilesMatch "\.(php|cgi|pl)$">

  # This makes sure that no cache headers can be set,
  # but does not generate an error when trying to.
  ExpiresActive Off

</FilesMatch>

# Your normal caching here
ExpiresDefault "access plus 1 month" 
```

现在在您的 PHP 脚本中，您应该能够插入缓存标头而不会被您的 .htaccess 文件覆盖，就像您正在做的那样

```
<?php header('Expires: ' . gmdate('D, d M Y H:i:s', time() + 360) . ' GMT'); ?> 
```

希望这会有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-03-22T09:48:58.843

这个答案为我提供了解决方案：[https ://stackoverflow.com/a/4521120/2685496](https://stackoverflow.com/a/4521120/2685496)

我几乎不知道`session_start();`默认情况下会用值覆盖您的 Cache-control 和 Expires 标头，以确保页面不被缓存。

你可以使用`session_cache_limiter('public');`before `session_start();`，就像 Marcin 建议的那样，或者你可以把你的`header();`陈述放在 after `session_start();`。

# java - Android - 选择 HTTP Java 库

> ID：12239226
> 
> 赞同：0
> 
> 时间：2012-09-02T19:51:03.280
> 
> 标签：java, android, http, rest, android-async-http

我正在构建一个 Android 应用程序，它将与`REST`使用`HTTP`和`HTTPS`下载`JSON`和文件数据的服务进行通信。我正在寻找要使用的 HTTP 网络库并正在评估选项。我找到了一个名为`AsyncHttpClient`( [loopj.com/android-async-http](http://loopj.com/android-async-http/) ) 的工具，它看起来不错，我看到 Instagram 使用它，但我看到它是建立在`Apache HttpClient`库上的，我似乎记得在某处读过 Apache 库被抛在后面赞成`HttpURLConnection`。这是我应该关心的事情吗？我应该考虑另一个图书馆吗？如果这有所作为，我计划将最低 Android SDK 设为 2.1。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T20:11:32.033

您对`HttpUrlConnection`建议是正确的，但是，您可以检查它的初始来源并检查此建议的根本原因，它真的适用于您吗？ [http://android-developers.blogspot.com/2011/09/androids-http-clients.html](http://android-developers.blogspot.com/2011/09/androids-http-clients.html)

对我来说主要的限制`HttpUrlConnection`是它最初不支持 Multipart。当然，添加起来并不难，但看起来很奇怪。

此外，Apache 的实现基本上很好，只有一个建议 - 不要忘记使用`AndroidHttpClient`而不是`Default`一个。

关于 JSON - 我很可能会为此推荐单独的库 - Google 的 GSON [http://code.google.com/p/google-gson/](http://code.google.com/p/google-gson/)。对我来说`AndroidHttpClient`+ Gson 工作得很好。

祝你好运

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-30T16:41:07.760

看看[http://loopj.com/android-async-http/](http://loopj.com/android-async-http/)

概述说：基于异步回调的 Android Http 客户端，构建在 Apache 的 HttpClient 库之上。所有请求都在应用的主 UI 线程之外发出，但任何回调逻辑都将在同一线程上执行，因为回调是使用 Android 的 Handler 消息传递创建的。

该库被 Instagram、Pinterest、Heyzap 等流行应用程序使用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-06T09:10:03.073

我刚刚发布了一个名为 DroidNetworking 的库，它支持 HTTP 缓存、身份验证、HTTP 和 HTTPS 以及许多其他功能。

[https://github.com/sogeti/DroidNetworking](https://github.com/sogeti/DroidNetworking)

BR马丁

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-21T09:05:14.143

谷歌在这里有一个官方的 http java 客户端库：[https ://code.google.com/p/google-http-java-client/wiki/Android](https://code.google.com/p/google-http-java-client/wiki/Android)

# google-maps - 谷歌地图，Places Api 没有给出正确的结果

> ID：12239227
> 
> 赞同：3
> 
> 时间：2012-09-02T19:51:11.357
> 
> 标签：google-maps

我正在尝试将地理编码服务与谷歌地图一起使用来显示附近地点的标记。我没有得到很好的排序结果，也就是说它们似乎是随机的，并且不接近提供的邮政编码。我使用的半径为 50000。代码如下所示。

```
 latlng = new google.maps.LatLng(lat,longitude);
var myOptions = {
  zoom: zoom,
  center: latlng,
  mapTypeId: google.maps.MapTypeId.ROADMAP
};

map = new google.maps.Map(document.getElementById("map"), myOptions);

//alert("Radius:"+radius_hidden);
var requestsearch = {
    location: latlng,
    radius: radius_hidden,
    name: searchname,
    types: ['store']
};
// keyword: searchname,//name: searchname, to get like pages and name to get exact
service = new google.maps.places.PlacesService(map);
//service.textSearch(requestsearch, callback);
service.search(requestsearch, callback);

if(map != null) {
    google.maps.event.addListener(map, 'drag', function(event) {
        calculateCenter();  
    });
}
          }
       google.maps.event.addDomListener(window, 'load', initialize);

         google.maps.event.addDomListener(window, 'resize', function() {
          map.setCenter(center);
           //google.maps.event.trigger(map, 'resize');
        });
          function calculateCenter() {
        var latlngbounds = new google.maps.LatLngBounds();

        for (var i = 0 ; i < markersArray.length ; i++) {
     latlngbounds.extend(markersArray[i].getPosition());
   }

       //map.setCenter(latlngbounds.getCenter(), map.getBoundsZoomLevel(latlngbounds));
     map.setCenter(latlngbounds.getCenter());
     map.fitBounds(latlngbounds);
        center = map.getCenter();
               }

       function callback(results, status)
         {
var listing='<table width="100%" border="1">';
var num=5;
markersArray = new Array();
if (status == google.maps.places.PlacesServiceStatus.OK) 
{
  for (var i = 0; i < results.length; i++) 
  {
    var pincode='';
    var address='';
    geocoder = new google.maps.Geocoder();
    geocoder.geocode({
      'address': results[i].vicinity,
      'partialmatch': true},function(resultsp, status)
      {
        if (status == 'OK' && resultsp.length > 0) 
        {
            address=resultsp[0].formatted_address;
            var len=resultsp[0].address_components.length-1;
            var res=resultsp[0].address_components[len].short_name;
            if(res!=undefined)
            {
                //address+="<br>Pincode:"+res.toString();
            }
            //listing+='<tr><td>Zip Code: '+res.toString()+'</td></tr>';
        } 
    });

    marker = new google.maps.Marker({
        position: results[i].geometry.location,
        title: results[i].name,
        zIndex: 2,
        icon: gicons["blue"]
    });
            markersArray.push(marker);
    calculateCenter();
    listing+='<tr><td>';

    var address_link=results[i].vicinity.replace(" ","+");
    if(i==0)
    {
        listing+='<table id="div5" width="100%" >'; 
    }
    else if(i%5==0)
    {
        num+=5;
        listing+='<table id="div'+num+'" style="display:none;" width="100%">';  
    }
    //'+results[i].name+'

 listing +='<tr id="searchadd"><td ><input type="hidden" value="'+results[i].name+'" name="end'+i+'" id="end'+i+'"></td></tr><tr><td style="word-wrap: break-word;" onmouseout="markersArray['+i+'].setIcon(gicons.blue)" onmouseover="markersArray['+i+'].setIcon(gicons.yellow)" class="" id="item-'+i+'">'+getaddress(results[i].vicinity)+'<div id="spacer" style="width:120px;height:1px;float:left;"></div><a   style="width:100px;height: 20px;" class="sty-hyperlink" target="_blank" href="https://maps.google.com/maps?daddr='+address_link+'"><b><?php echo getFieldFromDB('user_config','DirectionText'); ?></b></a><br></td></tr>';

        if(i ==(results.length-1))
        {
            listing+='</table>';
            listing+='<span id="largerwindowlink"><br><a  target="_blank" class="sty-action-buttn" href="<?php echo $finalURL; ?>"><?php echo trim(getFieldFromDB('user_config','ActionButtonText')); ?></a></span>';
        }
        else if(i>0 &&(i+1)%5==0)
        {
            listing+='<tr><td align="right"><a class="sty-hyperlink" style="width:100px;height: 20px;" href="javascript:void(0);" onclick="javascript:show_hide_table('+num+');" ><b><?php echo getFieldFromDB('user_config','MoreResultText'); ?></b></a></td></tr></table>';
        }
        listing+='</td></tr>';
      }
      showOverlays(5);
      listing +='</table>';
      if(results.length<=0)
      {
            listing='<br><br><span style="color:green;">Sorry! No stores found.<br>Please try another franchise name</span><br><br>';
      }
    }
    else
    {
        listing='<br><br><span style="color:green;">Sorry! No stores found.<br>Please try another franchise name</span><br><br>';
    }
    document.getElementById("listingAddress").innerHTML=listing;
}
function showOverlays(no) 
{
    if (markersArray) 
    {
        for (i in markersArray) 
        { 
            if(i<no && i>=no-5)
                markersArray[i].setMap(map);
        }
    }
}
function clearOverlays() 
{
    if (markersArray) 
    {
        for (i in markersArray) 
        {
                markersArray[i].setMap(null);
        }
    }
} 
```

我希望结果以正确的顺序排列，首先是更接近的结果，然后是其余的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T20:08:45.840

如果您想要按距离排序的地点结果，您需要告诉 API 这样做。

[https://developers.google.com/maps/documentation/javascript/reference#RankBy](https://developers.google.com/maps/documentation/javascript/reference#RankBy)

1.  [例子](http://www.geocodezip.com/v3_GoogleEx_place-search.html?address=Seattle)

2.  [例子](http://www.geocodezip.com/v3_GoogleEx_place-search.html?lat=37.7&lng=-122.0)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-29T06:28:20.847

```
var requestsearch = {
  location: latlng,
  radius: 5000,
  name: searchname,
  types: ['store']
}; 
```

这将返回 5 公里半径范围内的地点`location`。

# c++ - C++ - 如何在 Visual Studio 2010 中制作只读类成员变量

> ID：12239229
> 
> 赞同：1
> 
> 时间：2012-09-02T19:51:17.830
> 
> 标签：c++, class, constructor, constants, readonly

您好我正在尝试使一些公共成员变量只读。我知道我可以做类似的事情：

```
private: int _x;
public: const int& x;
Constructor(): x(_x) {} 
```

我正在寻找更易于管理和更易于阅读的东西。我在互联网上找到了几个模板，所有这些模板都类似于[这个](https://stackoverflow.com/questions/5424042/class-variables-public-access-read-only-but-private-access-read-write/5424521#5424521)SO 答案中描述的代理类。

我正在尝试调整该代理类，以便我可以将模板放入包含中，并为类中的每个变量编写类似的内容，我需要只读变量：

```
public: proxy<int, myClass> num; 
```

如果我不必每次都说类名，但我不知道如何解决这个问题，除非在模板中标识了类名，否则会更容易。

我在 Visual Studio 2010 中尝试过，但它不起作用，有人知道为什么吗？

```
template <class T, class C>
class proxy {
    friend class C;
private:
    T data;
    T operator=(const T& arg) { data = arg; return data; }
public:
    operator const T&() const { return data; }
};

class myClass {
public:
    proxy<int,myClass> x;

public:
    void f(int i) {
        x = i;
    }
}; 
```

谢谢

编辑-有人问我的意思是什么不起作用：

```
int main(int argc, char **argv)
{
    myClass test;
    test.f(12);
    cout << test.x << endl;
    return 0;
} 
```

返回：

```
b.cpp(122) : error C2649: 'typename' : is not a 'class'
        b.cpp(128) : see reference to class template instantiation 'proxy<T,C>'
being compiled
b.cpp(136) : error C2248: 'proxy<T,C>::operator =' : cannot access private membe
r declared in class 'proxy<T,C>'
        with
        [
            T=int,
            C=myClass
        ]
        b.cpp(125) : see declaration of 'proxy<T,C>::operator ='
        with
        [
            T=int,
            C=myClass
        ] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T20:17:32.587

改变这个：

```
template <class T, class C>
class proxy {
  friend class C; 
```

对此：

```
template <class T, class C>
class proxy {
   friend C; 
```

因为`C`是模板参数，所以不能保证`C`一定是类类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T20:26:31.200

我认为你的问题出在设计上。您不需要违反封装的“公共”成员。我认为您正在寻找 IoC 之类的东西，看看访问者模式它可以帮助您：

```
class IStateHandler{
public:
  virtual void handleState( const proxy<int, myClass>& num )=0;
  virtual ~IStateHandler(){}
};

class myClass {
private:
    proxy<int,myClass> x;

public:
    void f(int i) {
        x = i;
    }

    void handleState( IStateHandler* stateHandler ){
       stateHandler->handle( x );
    }

}; 
```

# c# - Luainterface，如何从ac#代码传递整个类？

> ID：12239231
> 
> 赞同：0
> 
> 时间：2012-09-02T19:51:43.403
> 
> 标签：c#, compiler-construction, lua, luainterface

我想将整个类从 c# 代码传递给 lua，所以我可以在 LUA 中创建一个新对象并使用它的方法、字段等。完成后，我想知道是否可以在 lua 中使用对象，这些对象是在 ac# 代码中创建的，然后以某种方式传递给 lua。

这是我的代码：atm，它不可能在我的类 Person1 的 luainterface 对象中创建，然后当我将 say() 输入到 lua 脚本程序时使用它的函数（不在那里创建任何对象），我得到了 Person2.say( )

```
using System;
using LuaInterface;
using System.Reflection;

namespace ConsoleApplication
{

public class Person1
{
    public void say()
    {
        Console.WriteLine("person1 says: hehe");
    }
}

public class Person2
{
    public void say()
    {
        Console.WriteLine("person2 says: hihi");
    }
}

class Class1
{
    static void Main(string[] args)
    {
        Lua lua_compiler = new Lua();

        Person1 person1 = new Person1();
        Person2 person2 = new Person2();

        lua_compiler.RegisterFunction("say", person1, person1.GetType().GetMethod("say"));
        lua_compiler.RegisterFunction("say", person2, person2.GetType().GetMethod("say"));

        while (true)
        {
            string line = Console.ReadLine();
            try { lua_compiler.DoString(line); }
            catch { }
        }
    }
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T15:01:31.030

```
 Person1 person1 = new Person1();
    Person2 person2 = new Person2();

    lua_compiler["person1"] = person1;
    lua_compiler["person2"] = person2;

    while (true)
    {
        string line = Console.ReadLine();
        try { lua_compiler.DoString(line); }
        catch { }
    } 
```

在该行中，您可以使用 person1:say() 或 person2:say()

如果你的类有很多函数和属性，传递整个类是很耗时的。

# algorithm - 集合中是否有不同的价值

> ID：12239232
> 
> 赞同：2
> 
> 时间：2012-09-02T19:51:45.200
> 
> 标签：algorithm, set

我有 N 组值，例如。

*   S1 = {A,B,C,D,E}
*   S2 = {A,B,C,D,E,F}
*   S3 = {A,B}
*   S4 = {C,E,F,G,H}

我想知道每组集合中是否有不同或独特的价值......即。是否存在通过集合的“路径”，在每个集合中至少留下一个值，而不是在任何其他集合中。上面示例的答案将是 TRUE，因为您可能有：B 来自 S1，D 来自 S2，A 来自S3 和 S4 中的 C

一个错误的例子是：

*   S1 = {A,B,C}
*   S2 = {A}
*   S3 = {A,B}
*   S4 = {A,C}

因为值需要在集合之间复制。

与往常一样，我确信这个问题必须有一个简单的解决方案。任何帮助将不胜感激。谢谢

**澄清**

感谢到目前为止的答案，但我仍然对此感到有些困惑，尽管有什么（我认为）是一个*简单*的要求。我怀疑我让这个问题听起来比它实际代表的问题更令人困惑。

为了澄清，我的最终目标是：

*   每组有一个值。
*   这个新值列表应该彼此不同。
*   从每组中选取的值是相对任意的。
*   如果无法从输入集中导出单个不同的值，则该过程不应返回任何内容

我已经阅读了二分图和最大流量，但我看不到“树上的木头”最终我需要在 .NET 中编写一些代码来实现这一点，所以一些伪代码将是一个非常大的帮助，如果那是不可能的只是一个简单的相关算法的例子就很好了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T21:07:33.090

用 ; 创建一个二分图

```
Set X containing value of nodes = {S1,S2,S3,...,SN}
Set Y containing value of nodes = {A,B,C...} 
```

通过根据问题中给出的集合制作边，将此图与问题陈述相匹配。

问题归结为检查 X 和 Y 之间的“**最大（二分）匹配**”是否等于 N。如果需要知道值的分配，则也打印此匹配。

编辑（更多解释）

![在此处输入图像描述](../Images/69c1c389d975340697472a4203f070b7.png)

两个集合之间的边表示原始集合。我们需要找到边，使得 X 中的所有顶点都被覆盖并且没有 2 条边共享一个公共顶点

注意：可能存在多个最大匹配

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T10:38:45.290

我*认为*你的要求是这样的：

调用集合`S1`, `S2`, ..., `Sn`. 调用元素`a1`, `a2`, ..., `am`. 然后你想：

*   对于每一个`S`，**选择**一个这样的成员*，*`a`至少`S`有一个`S`不包含那个*`a`*

 *所以在你的例子中：

*   `S1` **选择** `B`（不在 中`S4`）
*   `S2` **选择** `D`（不在 中`S3`）
*   `S3` **选择** `A`（不在 中`S4`）
*   `S4` **选择** `C`（不在 中`S3`）

为了解决这个问题，一种可能的方法是：

*   遍历`S`s 和 member `a`s，跟踪所有不同`a`的 s 以及`S`它们出现的数量
*   再次遍历`S`s，对于每一个，查看`a`计数小于s`n`的总数的成员的构造计数列表`S`。**选择**`a`满足此要求的任意一个

我们完成了。

* * *

您的评论似乎有一个额外的要求“如果'A'存在于多个集合中，那么'A'应该留在其中一个集合中”，即

*   对于每`a`一个是多个成员的`S`，那`a`就是一些的'**挑选**'成员`S`

**但是**，我看不出如何将您的评论与在您的示例中`E`存在多个`S`但从未被**选中**的事实相提并论。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T20:15:59.490

让我们以表格的形式表示您的第一个示例中的数据：

```
 a   b   c   d   e   f   g   h
s1  .   .   .   .   .
s2  .   .   .   .   .   .
s3  .   .
s4          .       .   .   .   . 
```

现在，我们正在寻找一些解决方案，例如这个（取自问题）：

```
s1=b, s2=d, s3=a, s4=c 
```

标记的解决方案（一列中不能有两个 X）：

```
 a   b   c   d   e   f   g   h
s1  .   X   .   .   .
s2  .   .   .   X   .   .
s3  X   .
s4          X       .   .   .   . 
```

这类似于在[分配问题](http://en.wikipedia.org/wiki/Assignment_problem)中为处理器选择任务......

但是，如果您不关心复杂性，那么检查所有可能的配置怎么样？

```
for (every element in s1) as e1
    for (every element in s2) as e2
        for (every element in s3) as e3
            for (every element in s4) as e4
                if (e1 != e2 != e3 != e4)
                    return true;
return false; 
```

这是具有复杂性的微不足道的蛮力`O(s1.length * s2.length * s3.length * s4.length)`。*

# ffmpeg - 如何获取 DVD 中的标题和章节信息？

> ID：12239235
> 
> 赞同：10
> 
> 时间：2012-09-02T19:51:49.540
> 
> 标签：ffmpeg, libavcodec, libav, libavformat

我发现了很多关于使用 ffmpeg 创建 DVD 菜单的问题，但我没有找到任何关于以编程方式访问 DVD 结构信息的问题。当我使用 libav（或 FFmpeg）库时，我可以打开 DVD 映像（iso 文件）并访问视频、音频和字幕流。但我找不到任何 API。

我可以使用 VLC 播放器（以及 libvlc 库）播放视频并找到信息。但我需要以编程方式对音频和字幕流进行一些处理。我不想使用 SmartRipper 之类的工具拆分 VOB，然后才进行处理。

libav(ffmpeg) 是否包含任何用于处理 DVD 菜单的 API？如果不是，您能否推荐任何其他可用于以一帧（样本，AVPacket）精度获取有关标题（章节）开始和结束时间的信息的库？

我听说过 libdvdnav 库，但我不知道它是否适合我。我是 libav 和 DVD 格式内部的新手。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2018-01-06T20:42:54.147

我不确定在这种情况下 1 帧精度意味着什么。但是，我一直在使用一个名为[lsdvd](http://sourceforge.net/projects/lsdvd/ "lsdvd")的工具，它是一个基本的 CLI 工具，它的唯一参数是 DVD 驱动器的块设备。（如果没有这个参数，它会猜测`/dev/dvd`，现代 Linux 上没有这个参数，通常是`/dev/sr0`。）然后它会给你一个很好的光盘章节列表，如下所示：

```
$ lsdvd /dev/sr0
Disc Title: METAL_DISC_2
Title: 01, Length: 00:00:00.433 Chapters: 01, Cells: 01, Audio streams: 01, Subpictures: 01
Title: 02, Length: 00:00:11.500 Chapters: 01, Cells: 01, Audio streams: 01, Subpictures: 00
Title: 03, Length: 00:00:00.433 Chapters: 01, Cells: 01, Audio streams: 01, Subpictures: 01
Title: 04, Length: 00:00:00.433 Chapters: 01, Cells: 01, Audio streams: 01, Subpictures: 01
Title: 05, Length: 00:00:09.000 Chapters: 01, Cells: 01, Audio streams: 01, Subpictures: 00
Title: 06, Length: 00:00:10.000 Chapters: 01, Cells: 01, Audio streams: 01, Subpictures: 00
Title: 07, Length: 00:00:00.433 Chapters: 01, Cells: 01, Audio streams: 01, Subpictures: 01
Title: 08, Length: 00:25:02.333 Chapters: 06, Cells: 06, Audio streams: 01, Subpictures: 00
Title: 09, Length: 00:00:00.433 Chapters: 01, Cells: 01, Audio streams: 01, Subpictures: 00
Title: 10, Length: 00:07:48.700 Chapters: 16, Cells: 16, Audio streams: 01, Subpictures: 00
Title: 11, Length: 00:00:00.433 Chapters: 01, Cells: 01, Audio streams: 01, Subpictures: 00
Title: 12, Length: 00:16:43.066 Chapters: 08, Cells: 08, Audio streams: 01, Subpictures: 00
...snip...
Longest track: 20 
```

如果您想编写自己的代码，我想查看源代码`lsdvd`会很有启发性。它在 Fedora 25 中链接的唯一库（除了标准的东西）是[dvdnav](http://dvdnav.mplayerhq.hu/ "dvdnav")项目`libdvdread.so.4`的一部分。

HTH。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-21T03:45:39.617

Mplayer 可以做到这一点。我不熟悉他们的图书馆，但这可以让你开始

```
mplayer dvd:// -identify 
```

结果

```
章节：00:00:00.000,00:03:40.200,00:07:29.500,00:12:04.033,00:16:17.199,
00:27:36.499,00:34:26.166,00:43:37.199,00:49:29.533,00:59:46.500,01:12:47.667,
01:17:09.000,01:26:13.700,01:47:15.833,01:50:06.200,01:55:25.500,02:06:42.500,
02:13:03.666,02:20:37.499,02:28:20.832,02:33:26.832,02:37:47.532,02:43:58.665,
02:51:00.165,02:56:36.165,03:01:21.998,03:05:09.331,03:07:14.665,03:11:49.665,
03:16:35.165,

```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-04-27T21:53:27.737

我使用上述两者的组合来创建 DVD 章节文件，稍后我可以使用 mkvmerge 将其添加到编码的 mkv 文件中：

```
#!/bin/bash
if [ $# -lt 1 ]; then
    echo "Usage: $0 filename title_no"
    exit 
fi

i=1
j2=01
filename=$1
echo "Using lsdvd to load chapter info:"
lsdvd -c ./
if [ -z "$2" ]; then
    echo -ne "What title number do you want to create chapter info for: "
    read title
else
    title=$2
fi
IFS=',' read -r -a CHAPTERS <<< `mplayer -identify -frames 0 "./VTS_0"$title"_0.IFO" 2>/dev/null | grep CHAPTERS: | sed 's/CHAPTERS: //'`

for chapter in "${CHAPTERS[@]}"
do
    echo "Chapter $i: $chapter"
    let i++
done

echo -ne "Creating chapter data file...."
sleep 3
for chapter in "${CHAPTERS[@]}"
do
    echo "CHAPTER$j2=$chapter" >> $filename.txt
    echo "CHAPTER"$j2"NAME=Chapter $j2" >> $filename.txt
    j2=$(printf %02d $((10#$j2 + 1 )))

done
echo "DONE."
echo "Chapter data file: $filename.txt" 
```

示例输出：

```
$ read_chapters.sh whiteglasses_chapters
Using lsdvd to load chapter info: 
libdvdread: Couldn't find device name.
Couldn't read enough bytes for title.
Disc Title: unknown
Title: 01, Length: 00:00:21.000 Chapters: 01, Cells: 01, Audio streams: 00, Subpictures: 00
    Chapter: 01, Length: 00:00:21.000, Start Cell: 01
Title: 02, Length: 01:52:32.166 Chapters: 11, Cells: 12, Audio streams: 02, Subpictures: 01
    Chapter: 01, Length: 00:10:23.200, Start Cell: 01
    Chapter: 02, Length: 00:11:53.200, Start Cell: 02
    Chapter: 03, Length: 00:08:02.367, Start Cell: 03
    Chapter: 04, Length: 00:11:28.533, Start Cell: 04
    Chapter: 05, Length: 00:12:55.834, Start Cell: 05
    Chapter: 06, Length: 00:12:26.600, Start Cell: 06
    Chapter: 07, Length: 00:16:20.766, Start Cell: 07
    Chapter: 08, Length: 00:10:31.934, Start Cell: 09
    Chapter: 09, Length: 00:09:24.033, Start Cell: 10
    Chapter: 10, Length: 00:09:04.767, Start Cell: 11
    Chapter: 11, Length: 00:00:00.800, Start Cell: 12
    Longest track: 02
    What title number do you want to create chapter info for: 2 
    Chapter 1: 00:00:00.000
    Chapter 2: 00:10:23.200
    Chapter 3: 00:22:16.400
    Chapter 4: 00:30:18.767
    Chapter 5: 00:41:47.300
    Chapter 6: 00:54:43.134
    Chapter 7: 01:07:09.734
    Chapter 8: 01:23:30.500
    Chapter 9: 01:34:02.434
    Chapter 10: 01:43:26.467
    Chapter 11: 01:52:31.234 
    Creating chapter data file....DONE.
    Chapter data file: whiteglasses_chapters.txt 
```

然后我简单地运行：

```
mkvmerge --chapters chapters.txt -o output.mkv input-file.mkv 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-01-01T09:21:12.283

> 基本上你不能说，但你可以寻找最长的标题。
> 
> 一种选择：使用`handbrakecli -scan e:`（手刹的一部分）
> 
> 另：使用`mplayer -identify dvd:// -dvd-device e:`（mplayer标准）

来自：[http ://betterlogic.com/roger/2011/07/dvd-determine-main-title-from-command-line/](http://betterlogic.com/roger/2011/07/dvd-determine-main-title-from-command-line/)

这对我有帮助，因为 VLC 在它的 GUI 菜单中列出了标题和章节

> 基本上，安装 VLC 媒体播放器，然后在其中播放您的 DVD。浏览直到它“正在播放真正的标题”</p>
> 
> 然后转到**Playback [menu] -> title**并查看当前突出显示的是哪一个。
> 
> 现在您知道哪个标题是“主要”标题轨道。

资料来源：[http ://betterlogic.com/roger/2010/11/how-to-use-vlc-to-tell-how-many-titles-and-chapters-and-which-is-the-main/](http://betterlogic.com/roger/2010/11/how-to-use-vlc-to-tell-how-many-titles-and-chapters-and-which-is-the-main/)

# algorithm - 谷歌模糊搜索（又名“建议”）：使用了哪些技术？

> ID：12239236
> 
> 赞同：15
> 
> 时间：2012-09-02T19:51:53.667
> 
> 标签：algorithm, search, language-agnostic, autocomplete, fuzzy-search

我正在我的网络应用程序中实现搜索建议功能，并且一直在研究现有的实现以了解正在使用的技术。

似乎大多数主要网站（亚马逊、必应等）都通过以下方式实现模糊搜索：

```
Tokenize search string in to terms
processingSearchStringSet = {}
For each term
    if exact term is NOT in index
        Get possible terms (fuzzyTerms) from levenshtein(term, 1 (or 2))
        For each term in fuzzyTerms
            if term is in index
                processingSearchStringSet.intersect(stringsIndexedByTermsSet)
    else
        processingSearchStringSet.intersect(stringsIndexedByTermsSet) 
```

然后，结果集成员可能会根据指标（例如：术语顺序保留、绝对术语位置、搜索流行度）进行排名，并在返回给用户之前根据此排名和预定结果集大小进行保留或消除。

另一方面，谷歌的实现与此有很大不同。

具体来说，它允许在搜索字符串的组成术语中出现超过 1 个错误。错误阈值似乎取决于感兴趣的术语在字符串中的位置，尽管它从不超过 7。

有趣的是：

1.  在整个术语空间上进行阈值为 5 的 Levenstein 搜索，因为用户字符串中的每个术语都非常昂贵
2.  即使 #1 已经完成，它仍然不能解释没有错误的建议

N-gram 也没有被使用：修改一个术语以使其不包含原始术语中存在的二元组似乎不会影响结果。

这是一个例子来说明我的发现：

```
Example term: "Fiftyyyy shades of grey"

Amazon suggestions: none 
(if the error count exceeds 1 on any term, the search fails)

Bing suggestions: none
(if the error count exceeds 2 on any term, the search fails)

Google suggestions: 10 (max) 
(breaking the search would require 5 or more errors on any single term, 
or multiple errors on multiple terms) 
```

我的问题是：什么类型的巫术在这里起作用？他们只是在使用带有巨大错误余量的 Levenshtein 搜索，还是使用了我不知道的另一种技术？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T15:06:50.360

也许您应该尝试这种方法： http: [//norvig.com/spell-correct.html](http://norvig.com/spell-correct.html)

# mysql - mysql表选择未按逻辑列出

> ID：12239243
> 
> 赞同：0
> 
> 时间：2012-09-02T19:52:52.070
> 
> 标签：mysql, date

我编写了以下查询，该查询将尝试选择开始日期与当前日期无关的所有事件（我在表中有 start_date 和 end_date 字段）：

```
$query = "SELECT id,title,start_date 
          FROM events 
          WHERE start_date > NOW() - INTERVAL 30 DAY AND city = '$cityName' 
          ORDER BY start_date DESC"; 
```

我意识到上述代码的唯一问题是，如果一个事件在 3 个月前开始，`NOW()`那么它将不会显示。我去尝试重写它，但它没有工作。这就是我所管理的：

```
"SELECT id,title,start_date 
 FROM events 
 WHERE start_date >= NOW() - INTERVAL 30 DAY || start_date <= NOW() && end_date >= NOW() - INTERVAL 30 DAY"; 
```

我试图做的是选择开始日期大于或等于当前日期（`NOW()`）的所有事件，甚至选择 start_date 可能小于当前日期但结束日期在之后的事件`NOW()`。关于如何解决这个问题的任何建议？我希望它显示所有事件，只要它们还没有发生（当然这意味着结束日期不小于当前的实际日期）。

谢谢，

编辑：

```
$query = "SELECT id,title,start_date FROM events WHERE start_date > NOW() - INTERVAL 30 DAY AND city = '$cityName' ORDER BY start_date DESC";

$query_posted = "SELECT id,title,start_date FROM events WHERE start_date > DATE_SUB(NOW(), INTERVAL 1 MONTH) AND city = '$cityName' AND category = '$tag' ORDER BY start_date DESC"; 
```

第一个在我修改后加载了事件（不包括修改），但第二个失败了，我认为这是由于最后还有两个 AND。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T21:06:18.557

如果此时运行，这就是您的要求。

```
WHERE start_date >= 2012-08-03 || start_date <= 2012-09-02 && end_date >= 2012-08-03 
```

为了使它起作用，您需要使用括号来分隔比较。

```
WHERE start_date >= NOW() - INTERVAL 30 DAY || (start_date <= NOW() && end_date >= NOW() - INTERVAL 30 DAY) 
```

或者，您可以使用`BETWEEN`运算符：

```
WHERE start_date BETWEEN NOW() - INTERVAL 30 DAY AND NOW()
    AND end_date >= NOW() - INTERVAL 30 DAY 
```

最后，您提到您希望`end_date`大于`NOW()`。因此，只需删除`- INTERVAL 30 DAY`即可：

```
WHERE start_date BETWEEN NOW() - INTERVAL 30 DAY AND NOW() AND end_date >= NOW() 
```

# playframework-2.0 - 将 Scalate 集成到 Play 2.0 中

> ID：12239245
> 
> 赞同：1
> 
> 时间：2012-09-02T19:52:58.800
> 
> 标签：playframework-2.0, sbt, scalate

我欣赏的 Play 2.0 框架的一个特性是*静态编译视图*。如果控制器在没有提供正确数量的类型正确的参数的情况下呈现视图，则会引发编译错误。这大大提高了可维护性，因为控制器<>视图差异不必通过运行应用程序进行测试，而是在编译时出现。

然而，标准的 Play 2.0 视图模板使用纯 HTML 结合 Scala 作为一种语言。我想使用 Scalate，这样我就可以将 Scala 与不那么冗长的 Scaml 或 Jade 模板语言结合起来。但是我不想使用 Scalate 在运行时编译我的视图，因为我会失去上面提到的静态编译视图的优势。

因此，我尝试使用[其他地方](http://janhelwich.wordpress.com/2012/04/22/getting-play-2-with-scalate-to-run-on-heroku/)`xsbt-scalate-generator`描述的方法来实现我的 Jade 视图的静态编译。但这只是让我半途而废——正确配置的插件可以生成相应的文件，但它的命名和打包方式与普通的 Play 2.0 视图不同。一个名为 Play 2.0 的默认视图被编译为包中的一个文件。但是，名为 Jade 的视图会在默认（空白）包中创建一个文件。此类在 Java Play 2.0 控制器中不可导入且不可使用。`.class``index.scala.html``index.class``views.html``index.jade``$_scalate_$default_jade.class`

如何以一种我可以在控制器中编写的方式生成我的 Scalate 视图的类文件`return ok(views.html.index.render(args));`？

[（看起来生成的类`render()`至少提供了一个名为的方法）]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-08T17:37:57.580

我开始了一个插件来做到这一点。查看我的工作：[https ://github.com/kryptt/play2-scalate-plugin](https://github.com/kryptt/play2-scalate-plugin)

# java - 按字母顺序对字符串列表进行排序

> ID：12239251
> 
> 赞同：0
> 
> 时间：2012-09-02T19:53:49.907
> 
> 标签：java, arrays, string, class

好的，这是我的问题。我需要获取一个字符串数组并按字母顺序对其进行排序，然后打印出第一个字符串：例如，“乔治亚州，佛罗里达州，阿拉巴马州”的字符串，它应该打印出阿拉巴马州。字符串不是由用户提交的，我有一个文件，其中包含作为数组输入的一堆状态。

这就是我所拥有的：

```
import java.io.*;
import java.util.*;
public class MinString
{
    private static final int SIZE = 10;
    public static void main(String[] args)
    {
            String[] list = new String[SIZE];
            int numItems;

            numItems = Initialize (list);
            System.out.println(numItems);
    }

    private static int Initialize (String[] list)
    {
      //post : List is initialized with all strings from file.

      String filename, stateInput;
      int i = 0, numItems = 0;
      try  {
            System.out.print("Input File : ");
            Scanner stdin = new Scanner(System.in);
            filename = stdin.nextLine();
            stdin = new Scanner(new File(filename));

            while ((stdin.hasNext()) && (i < list.length))
            {
                    stateInput = stdin.nextLine();
                    System.out.println("S = " + stateInput);
                    list[i] = stateInput;
                    i++;
            }
            numItems = i;
      }
      catch (IOException e)  {
            System.out.println(e.getMessage());
      }
      return numItems;
    }

    // Method FindMin goes here
 private static String FindMin (String[] list, numItems);
 ????? 
```

}

我不确定如何编写这个 FindMin 方法。我需要编写 FindMin 以便它将大小为 numItems 的字符串数组作为输入，并将最小字符串返回给调用函数。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T19:58:56.550

由于这感觉像是一项家庭作业，我将帮助您自助：

[http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#compareTo(java.lang.String](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#compareTo(java.lang.String) )

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T20:10:26.767

最简单的方法是：

```
return Collections.min(Arrays.asList(list)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-02T20:10:37.090

该[`java.util.Arrays`](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html)对象包含一堆用于处理数组的静态方法。我想[`Arrays.sort`](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html#sort%28java.lang.Object%5B%5D%29)可能会在这里帮助你。由于字符串[`Comparable`](http://docs.oracle.com/javase/7/docs/api/java/lang/Comparable.html)以字母顺序实现接口，因此排序数组应该为您提供所需的信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-02T20:29:55.743

只需使用 Arrays.sort(list) ，列表就会被排序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-10T17:52:01.440

```
import java.util.*;
class Six
{
public static void main(String arg[])
{
String str[]=new String[5];
Scanner in=new Scanner(System.in);
System.out.println("Enter the element of array :");
for(int i=0;i<=4;i++)
{
str[i]=in.next();
}
Arrays.sort(str);
System.out.println("The first element after sorting is:");
System.out.println(str[0]);
}
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-09-02T20:25:50.783

```
private static String findMin(String[] list) {
    String minState = list[0]; 
    for(int i=1; i<list.length; i++){
        String min=list[i];
        minState=(min!=null&&min.compareTo(minState)<0)?min:minState;
    }
    return minState;
} 
```

# android - 如何发送音频文件以存储在服务器中

> ID：12239252
> 
> 赞同：0
> 
> 时间：2012-09-02T19:53:58.160
> 
> 标签：android, audio, webserver, send

我想知道如何在 Android 设备的 SD 卡中转换和存储音频文件，以通过互联网将音频发送到服务器。我找了很多，但一切都不一样。

我有 .3gp 音频格式，它与格式无关，我只想在我想要的服务器目录中获取文件。任何指南，教程，评论，请。我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T20:02:38.653

我编写了这段代码来将文件发送到服务器：

path = 要发送的文件的绝对路径。剩余的参数似乎不言自明。

```
 public static String sendFileToServer(String path, String urlString,
        String mimeType, String id) throws Exception {

    try {

        String URL = "", file_name = "";
        if (!path.equals("")) {
            file_name = path.substring(path.lastIndexOf("/") + 1);
        }

        File directory = new File(path);

        byte[] data = new byte[(int) directory.length()];
        try {
            FileInputStream fileInputStream = new FileInputStream(directory);
            fileInputStream.read(data);

        } catch (FileNotFoundException e) {
            System.out.println("File Not Found.");
            e.printStackTrace();
        } catch (IOException e1) {
            System.out.println("Error Reading The File.");
            e1.printStackTrace();
        }

        URL = Constants.WEB_ROOT_URL + urlString;
        Log.v("AppEngine Manager", "Image Upload URL: " + URL);

        HttpClient httpClient = new DefaultHttpClient();
        HttpPost postRequest = new HttpPost(URL);
        ByteArrayBody bab = new ByteArrayBody(data, file_name);
        MultipartEntity reqEntity = new MultipartEntity(
                HttpMultipartMode.BROWSER_COMPATIBLE);

        reqEntity.addPart("media_type", new StringBody(mimeType));
        reqEntity.addPart("file_name", new StringBody(file_name));
        reqEntity.addPart("file_id", new StringBody(file_name));
        reqEntity.addPart("file", bab);

        postRequest.setEntity(reqEntity);
        HttpResponse response = httpClient.execute(postRequest);
        BufferedReader reader = new BufferedReader(new InputStreamReader(
                response.getEntity().getContent(), "UTF-8"));
        String sResponse;
        StringBuilder s = new StringBuilder();

        while ((sResponse = reader.readLine()) != null) {
            s = s.append(sResponse);
        }

        return s + "";

    } catch (Exception e) {
        // handle exception here
        Log.e(e.getClass().getName(), e.getMessage());
        return "exception";
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T20:03:48.510

您可以[`HttpClient`](http://zybnet.com/java-http-client-and-post-requests/)将`POST`音乐文件用于某些服务器应用程序。

例如，在 PHP 中，您将能够通过`$_FILE['key']`. 实际存储和处理取决于您的具体要求。此外，您没有指定是否希望服务器将转码后的文件输出回来。

例如，为了对音频数据进行转码，您可以使用[FFmpeg](http://ffmpeg.org/ffmpeg.html)。

# visual-studio-2010 - 架构名称未显示在 vs2010 工具 sqldatasource 中

> ID：12239255
> 
> 赞同：1
> 
> 时间：2012-09-02T19:54:11.557
> 
> 标签：visual-studio-2010, adventureworks

我对这一切都很陌生，所以我可能会问一个愚蠢的问题。我刚刚安装了 sql server express 2012。我已经安装了 Adventureworks db。在 vs2010 中使用 sqldatasource 工具时，我得到了表名，但没有得到模式名。EG 生产。产品。我只得到表名 Products。因此在运行脚本时会导致错误。

预先感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T19:58:30.840

好吧，默认架构是“dbo”。

在左侧的 SQL Server 中，单击数据库 > Adventureworks > 表，您可以在那里看到架构名称。

# ios - 刷新整个 iOS 应用

> ID：12239260
> 
> 赞同：-1
> 
> 时间：2012-09-02T19:54:53.697
> 
> 标签：ios, uitabbarcontroller

我正在开发一个带有选项卡的应用程序，该应用程序显示有关数据库中某个人的信息。在我的一个选项卡中，有一个文本框，用户可以通过该文本框搜索新人。

我的问题是，如何使用新人的信息刷新所有标签？

我进行了服务器调用并获取了所有新信息，但我只是不知道如何刷新整个应用程序。任何帮助，将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T19:59:55.347

旧数据失效时发布通知，新数据可用时发布通知。让你的视图控制器监听这些通知。当旧数据失效时，显示加载通知。当有新数据可用时，更新您的视图并清除任何加载通知。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-09-02T20:23:18.860

```
(void)applicationDidBecomeActive:(UIApplication *)application {   \\\your code   } 
```

在应用程序委托的上述函数中重新加载数据以在应用程序进入前台时刷新数据。您可以在单击按钮时调用此函数！

# javascript - 使用 d3.js 可视化多项式函数

> ID：12239262
> 
> 赞同：1
> 
> 时间：2012-09-02T19:55:06.153
> 
> 标签：javascript, d3.js

我希望创建一个工具，当输入函数（语句）时，绘图会立即更新。我知道 enter()，但这是针对数据的，我的数据很少更改（当应该进行缩放时，或者当绘图不会发生时）适合，如果曲线很复杂），在我看来，我必须手动循环我希望绘制的新键入的语句，并清除以前的语句。这是真的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T21:03:49.557

[http://mbostock.github.com/d3/ex/stream.html](http://mbostock.github.com/d3/ex/stream.html)上的示例可能有助于查看。我认为您将希望通过多项式函数运行数据并将其用作图形的新数据集。然后可以将图形从一个多项式无缝更新到另一个多项式。

# backbone.js - 通过 id 查找主干集合

> ID：12239269
> 
> 赞同：0
> 
> 时间：2012-09-02T19:55:49.643
> 
> 标签：backbone.js

this.id 在 Blog.Collections.Posts 类中未定义。怎么了？

博客收藏

```
Blog.Collections.Posts = Backbone.Collection.extend({

  model: Blog.Models.Post,
  url: function() {
    console.log(this.id);
    if (this.id) {
      return '/api/posts/'+this.id
    }
    else{
      return '/api/posts'
    }
  }

}); 
```

我的路由器：

```
Blog.Routers.Posts = Backbone.Router.extend({

    routes: {
    ""                  :        "index",
    "entry/:id" :        "show"
  },

  show: function(id) {
    var collection = new Blog.Collections.Posts({id: id});
    collection.fetch({
      success: function() {
        var view = new Blog.Views.PostsIndex({ collection: collection });
        console.log(collection);
      }
    });
  }

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T21:38:28.813

默认情况下，集合没有 id。除非您明确地为您的集合分配一个 id，否则将`this.id`变为未定义。ID 是模型的标准属性。你想做的很简单：

```
// Collection URL
url: function() {
    return '/api/posts'
} 
```

骨干模型，如果它们是集合的一部分，则`url`在获取和保存时将使用该集合。因此，如果您执行以下操作：

```
// myModel is a part of the collection
myModel.save(); 
```

它会自动转到：

```
'/api/posts/:id'  // Assuming your model already has a model.id 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T20:29:44.410

IMO 您的代码设计错误。您可以从[这里](https://github.com/thikonom/django-backbone-blog)（转到`blog/static/js/app.js`）了解如何在主干上组织博客应用程序。

# php - 从表单标签中删除冒号

> ID：12239272
> 
> 赞同：1
> 
> 时间：2012-09-02T19:56:23.683
> 
> 标签：php, symfony, symfony-forms

我正在使用

```
{{ form_label(form.fieldName) }} 
```

最后生成带有冒号 (:) 的标签。如何删除自动添加到标签？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T05:55:23.487

[您可以使用Form Theming](http://symfony.com/doc/current/cookbook/form/form_customization.html)自定义表单呈现。您必须自定义的是[form_label](https://github.com/symfony/symfony/blob/master/src/Symfony/Bridge/Twig/Resources/views/Form/form_div_layout.html.twig)块。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T13:28:44.653

谢谢帕特，解决方案是：

```
{% form_theme form _self %}

{% block field_label %}
{% spaceless %}
    {% if not compound %}
        {% set label_attr = label_attr|merge({'for': id}) %}
    {% endif %}
    {% if required %}
        {% set label_attr = label_attr|merge({'class': (label_attr.class|default('') ~ ' required')|trim}) %}
    {% endif %}
    {% if label is empty %}
        {% set label = name|humanize %}
    {% endif %}
    <label{% for attrname, attrvalue in label_attr %} {{ attrname }}="{{ attrvalue }}"{% endfor %}>{{ label|trans({}, translation_domain) }}</label>
{% endspaceless %}
{% endblock field_label %} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-08T20:53:16.030

简单地说，您可以`vars.label`在现场使用：

```
<label for="{{ form.fieldName.vars.id }}">{{ form.fieldName.vars.label }}</label> 
```

# php - PHP 倒计时到事件并在事件过去时更新

> ID：12239276
> 
> 赞同：0
> 
> 时间：2012-09-02T19:56:48.883
> 
> 标签：php, time, countdown

我有一个 Jquery 倒计时，直到每周一次的活动。活动时间为美国中部时间每周日晚上 7:00。我在php中生成倒计时。我正在寻找一种方法来设置倒计时以在当前事件一周后一个小时后显示下一个事件。

例子：

活动时间为每周日美国中部标准时间晚上 7:00，持续一个小时。

如果您在周日下午 6:00 查看该站点，它应该会开始倒计时一个小时。(00:01:00:00) 如果您在周日晚上 7:00 - 晚上 8:00 查看该站点，它将显示 0。 (00:00:00:00) 如果您在 9 点查看该事件周日：00 PM，它将显示 6days 22hrs 0min 0sec (06:22:00:00)

我有代码来显示我输入的日期和时间的倒计时，但我希望在不每周更改代码的情况下发生这种情况。

```
<?php 
        $rem = strtotime('2012-09-02 19:00:00') - time();
        $day1 = floor($rem / 86400);
        $hr1  = floor(($rem % 86400) / 3600);
        $min1 = floor(($rem % 3600) / 60);
        $sec1 = ($rem % 60);
        $day = sprintf('%02d',$day1);
        $hr = sprintf('%02d',$hr1);
        $min = sprintf('%02d',$min1);
        $sec = sprintf('%02d',$sec1);
        echo "$day:";
        echo "$hr:";
        echo "$min:";
        echo "$sec"; ?> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T20:11:42.930

```
$time = new DateTime("Next Sunday 7:00 PM", new DateTimeZone("America/Chicago"));
$diff = $time->diff(new DateTime("now"));
echo $diff->format("%D:%H:%I:%S"); 
```

根据最适合您的方式更改**[时区。](http://il.php.net/timezones)**不要依赖 UTC/CST/WHATEVER，给一个合适的位置，这样你的时间是准确的。

# php - PHP DOM XML 输出：缺少数据集

> ID：12239280
> 
> 赞同：2
> 
> 时间：2012-09-02T19:57:18.377
> 
> 标签：php, xml, dom

使用 MYSQL 数据库上的 php 查询并使用 DOM 输出 xml 文件，一切正常，除了并非所有数据集都写入 xml 文件。例如，我可以列出预期结果的数量：

```
$num_results = mysql_num_rows($result);
echo $num_results; 
```

例如 20，但在保存的 xml 文件（“auswertung.xml”）中只存在 19 个条目。每次都不会写入第一个数据集。有什么问题？

这是相关的代码：

```
// Start XML file, create parent node
$dom = new DOMDocument("1.0");
$node = $dom->createElement("markers");
$parnode = $dom->appendChild($node);

// Opens a connection to a mySQL server
$connection=mysql_connect ($dbhost, $username, $password);
if (!$connection) {
    die('Not connected : ' . mysql_error());
}

// Set the active mySQL database
$db_selected = mysql_select_db($database, $connection);
if (!$db_selected) {
    die ('Can\'t use db : ' . mysql_error());
}

$query = "SELECT * FROM Herpeto WHERE Art like '$Art' ORDER BY ID ASC";
$result = mysql_query($query) or die ("Error in query: $query " . mysql_error());
$row = mysql_fetch_array($result);
$num_results = mysql_num_rows($result);

// Iterate through the rows, adding XML nodes for each
echo $num_results;
while ($row = @mysql_fetch_assoc($result)){
// ADD TO XML DOCUMENT NODE
$node = $dom->createElement("marker");
$newnode = $parnode->appendChild($node);

$newnode->setAttribute("Art", $row['Art']);
$newnode->setAttribute("Anzahl", utf8_encode ($row['Anzahl']));
$newnode->setAttribute("Status", $row['Status']);
$newnode->setAttribute("Stadt", utf8_encode($row['Stadt']));
$newnode->setAttribute("Fundstelle", utf8_encode($row['Fundstelle']));
$newnode->setAttribute("Bemerkung", utf8_encode($row['Bemerkung']));
$newnode->setAttribute("Tag", utf8_encode ($row['Tag']));
$newnode->setAttribute("Monat", utf8_encode ($row['Monat']));
$newnode->setAttribute("Jahr", utf8_encode ($row['Jahr']));
$newnode->setAttribute("Beobachter", utf8_encode($row['Beobachter']));
$newnode->setAttribute("lat", $row['lat']);
$newnode->setAttribute("lng", $row['lng']);
}

$dom->save('auswertung.xml'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T20:32:13.550

您在 xml 输出中得到 20 行中的 19 行，因为您`mysql_fetch_array()`在将结果传递给实际生成 xml 输出的 while 循环之前调用了结果：

```
$row = mysql_fetch_array($result); // <-- here you get the first row
//...
while ($row = @mysql_fetch_assoc($result)){ // <-- now while loop starts from 2nd row 
```

# java - 在 Facebook Connect 中获取 access_token

> ID：12239283
> 
> 赞同：0
> 
> 时间：2012-09-02T19:57:29.930
> 
> 标签：java, facebook, playframework, playframework-2.0

我对 Java Playframework 和测试 Facebook 身份验证有点陌生。

```
public static Result fbLogin(){
    String token_code_url = "https://www.facebook.com/dialog/oauth?client_id=MY_APP_ID&redirect_uri=http://localhost:9000/&response_type=token";
    return redirect(token_code_url);
}

public static Result index() {

Result loginResult = fbLogin();
return loginResult;

} 
```

这会打开 Facebook，我可以访问我的应用程序。

它返回`http://localhost:9000/#access_token=ACCESS_TOKEN`

我如何获得 ACCESS_TOKEN ？

我需要配置路由吗？我似乎`This webpage has a redirect loop`在浏览器上得到了一个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T07:15:28.437

您似乎使用了客户端身份验证：“#”之后的 URL 部分未发送到服务器。

我建议您使用其中一个可用的模块来进行 Facebook 登录，例如 SecureSocial：[https](https://github.com/jaliss/securesocial) ://github.com/jaliss/securesocial或 Play！认证：http: [//joscha.github.com/play-authenticate/](http://joscha.github.com/play-authenticate/)

# xml - 用于清理数据的 XSLT

> ID：12239290
> 
> 赞同：2
> 
> 时间：2012-09-02T19:58:20.430
> 
> 标签：xml, xslt, xpath

我打算使用 XSLT 从以下数据中清除一些不需要的符号：

```
<Cart>
    <Row>
        <Ld>Restaurant/Cafe Bar &amp; Stores J-K,3</Ld>
        <Ln>Restaurant/Cafe Bar &amp; Stores J-K</Ln>
    </Row>
</Cart> 
```

下面的符号怎么去掉

```
&amp;
/ 
```

结果数据将是

```
<Cart>
    <Row>
        <Ld>Restaurant,Cafe Bar, Stores J-K,3</Ld>
        <Ln>Restaurant, Cafe Bar, Stores J-K</Ln>
    </Row>
</Cart> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T20:09:42.203

您可以使用[translate()](http://www.w3.org/TR/xpath/#function-translate)函数：

应用于身份转换以将这些字符替换为`,`：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    version="1.0">

    <xsl:template match="@*| node()">
        <xsl:copy>
            <xsl:apply-templates select="@*|node()"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="text()">
        <xsl:value-of select="translate(., '&amp;/', ',,')"/>
    </xsl:template>
</xsl:stylesheet> 
```

* * *

使用 XSLT/XPath 2.0，您可以使用[replace()](http://www.w3.org/TR/xpath-functions/#func-replace)函数，它为查找/替换操作和前导/尾随空格的规范化等提供了更强大的功能。

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    version="2.0">

    <xsl:template match="@*| node()">
        <xsl:copy>
            <xsl:apply-templates select="@*|node()"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="text()">
        <xsl:value-of select="replace(., '\s?(&amp;|/)\s?', ', ')"/>
    </xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T20:07:38.040

您可以使用[替换](http://www.w3.org/TR/xpath-functions/#func-replace)功能。

# ruby-on-rails - 从 mac 中完全删除 ruby

> ID：12239293
> 
> 赞同：0
> 
> 时间：2012-09-02T19:58:29.707
> 
> 标签：ruby-on-rails, ruby, macos

我在构建 rails 项目时遇到问题，它只是告诉我缺少 gem，而它们存在于系统中并正确配置。那么从系统（mac os）中完全删除ruby＆rails的最佳方法是什么。我已经尝试过在谷歌中找到的方法，但错误仍然存​​在，我猜不是所有文件和文件夹都从系统中删除

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T20:04:24.310

Ruby 和 Rails 都是非常依赖版本的软件，带来比 Windows 中著名的“dll 地狱”更严重的问题，最好的方法是安装[RVM](https://rvm.io/ "虚拟机")，它允许您在一个平台上运行多个版本的 Ruby 和 Rails单一系统。然后，您可以切换到所需的 Ruby 和 Rails 版本，并运行/构建您的应用程序。

# c# - ASP.NET razor 捕获会话结束

> ID：12239301
> 
> 赞同：1
> 
> 时间：2012-09-02T19:59:25.050
> 
> 标签：c#, asp.net, session, razor

在 razor 中，我们有 _appstart 和 _pagestart。

当会话结束而不去 Global.asax 时，是否可以使用 _sessionend 之类的东西来工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T20:02:19.367

`_appstart`并且`_pagestart`专门用于连接到页面逻辑和数据 - 它们并不是真正用于`Session`. 他们也没有`_*end`同行。

要挂接到会话结束，您必须使用`global.asax.cs`，就像使用 webforms 一样。

# algorithm - 通过遍历图生成给定字符串的步骤

> ID：12239310
> 
> 赞同：2
> 
> 时间：2012-09-02T20:00:24.690
> 
> 标签：algorithm, graph

您有以下网格。

> ```
> A B C D
> E F G H
> I J K L
> M N O P
> Q R S T
> U V W X
> Y Z 
> ```

您的光标始终从 A 开始，您可以进行左 (L)、右 (R)、上 (U)、下 (D) 和 Enter (E) 操作。问题：给定一个字符串，打印生成字符串的操作序列？

例如 ：

```
> INPUT : CGH 
> OUTPUT : R R E D E R E 
```

这个问题是在采访中问我的。

`My approach`：我想通过计算曼哈顿距离并在图上做一个 BFS 来解决这个问题，但我认为这不是最优的。甚至我需要更改每个字母的曼哈顿距离。提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T20:26:57.453

可以从幼稚的方法开始。提示：将初始序列看成一个矩阵，每个字母都有一个位置：行和列的倒数。

### 第1步。

建立一个哈希表：*键*- 是字母，*值*- 是二维矩阵中的索引。您将使用它进行快速查找，例如给定字母“C”它的矩阵索引是什么？它是 [0,2]。

构建需要 O(N) 时间和 O(N) 空间，因为您需要迭代输入并存储它。解决一个字母在平均情况下需要 O(1) + 如果你使用一个好的散列函数，最坏的情况 O(N) 不会有问题。

### 第2步。

给定输入中的 2 个字母来解决偏移量。这将为您提供所需的输出序列块。

这需要 O(1) 时间和 O(1) 空间。

### 步骤 3。

重复步骤 2，直到到达序列的末尾。

这需要 O(N) 时间和用于构建输出的 O(N) 空间。

### 概括。

此解决方案使用哈希表进行快速字母查找。解析路径的偏移量（L/R/U/D/E）也需要 O(N) 时间复杂度和 O(N) 空间复杂度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T22:09:27.717

首先，字母在网格中的位置很容易计算：

```
function get_pos( c : char)
begin
  int col ← (c-'A') modulo 4
  int row ← (c-'A') div 4
  return (row,col)
end 
```

### 假设位置 (6,2) 和 (6,3) 可以使用

我们可以简单地将单元坐标之间的减法定义为：

```
function subtract( pos1, pos2 : position )
begin
  return (pos2.row-pos1.row, pos2.col-pos1.col)
end 
```

如果减法产生一对 (x,y)，则路径只是 x 乘以字符“R”（如果 x 为正）或“L”（如果 x 为负），如果 x 为零，则可能什么都没有，类似地，y 乘以字符 'D ' 如果 y 是正数，或者 'U' 如果 y 是负数，如果 y 为零，则可能什么都没有，那么我们以字符 'E' 结尾。

```
function print_row_path( pos1, pos2 : position )
begin
  path ← subtract(pos1,pos2)
  if path.row > 0 then
    print_times_char(path.row,'R')
  else if path.row < 0
    print_times_char(-path.row,'L')
  end if
end

function print_col_path( pos1, pos2 : position )
begin
  path ← subtract(pos1,pos2)
  if path.col > 0 then
    print_times_char(path.col,'D')
  else if path.col < 0
    print_times_char(-path.col,'U')
  end if
end

function print_path_direction( pos1, pos2 : position ; first_direction : direction )
begin
  if (first_direction = FIRST_MOVE_ROW) then
    print_row_path(pos1,pos2)
    print_col_path(pos1,pos2)
  else
    print_col_path(pos1,pos2)
    print_row_path(pos1,pos2)
  end if
  print 'E'
end

function print_path(start, end : char)
begin
  position pos1 ← get_pos(start)
  position pos2 ← get_pos(end)
  print_path_direction(pos1,pos2, FIRST_MOVE_ROW)
end 
```

其中 print_times_char(t,c) 是打印 t 次字符 c 的函数。我定义了路径打印的两种“风格”，一种先打印行移动，另一种先打印列移动。

### 假设位置 (6,2) 和 (6,3) 被禁止

如果我们不允许使用位置 (6,2) 和 (6,3)，那么：

*   如果 'A' ≤ start,end ≤ 'X' 或 'Y' ≤ start,end ≤ 'Z' : (6,2) 或 (6.3) 将永远不会在路径中使用
*   if 'A' ≤ start ≤ 'X' and 'Y' ≤ end ≤ 'Z' ：确保不使用禁止单元格首先打印列移动
*   if 'A' ≤ end ≤ 'X' and 'Y' ≤ start ≤ 'Z' : 这次我们必须先打印行移动

在伪代码中：

```
function print_path_wo_forbidden(start, end : char)
begin
  position pos1 ← get_pos(start)
  position pos2 ← get_pos(end)
  if if 'A' ≤ start ≤ 'X' and 'Y' ≤ end ≤ 'Z' then
    print_path_direction(pos1,pos2, FIRST_MOVE_COLUMN)
  else
    print_path_direction(pos1,pos2, FIRST_MOVE_COLUMN)
  end if
end 
```

### 复杂

打印两个位置之间的路径显然在 O(1) 中，因此对于长度为 n 的字符串，我们可以构建一个 O(n) 算法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T20:09:57.050

您可以将字母表示为坐标对`A = [0,0], F = [1,1]`等，然后您只需计算当前字母与所需字母之间的偏移量并使用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-02T23:38:55.103

oleski 说了什么，但老实说，哈希表是太多不必要的编程工作，特别是如果您的语言没有原生语言。

使用数组来映射网格位置通常要容易得多，如下所示：

```
struct point{
   int x; 
   int y;
};

point map[256];
point['C'] = (0,2); 
```

# php - 从 php 查询和发布到 mysql。序列化数组并将其保存到数据库或创建大约 15 个不同的列？

> ID：12239314
> 
> 赞同：0
> 
> 时间：2012-09-02T20:00:44.330
> 
> 标签：php, mysql, database, database-design

数据将由 1 位或 2 位数字组成，我可以（根据我的经验）创建一个充满所有主要数据以及这些额外 15 列的繁忙的数据库，或者我可以在我的数组上使用序列化函数已经将保留这些数字以节省空间并整理数据库。

**您可能有的问题：**

*   更改其中一个数字的每个查询都会影响其余数字。

*   我现在正在使用 php 以及可能的 javascript 和 ajax，但是我最终会用 python 和/或 C 完全或部分重写项目。所以序列化函数可能会让事情变得有点棘手......

*   数据库中的信息将由 2 个人使用单独的 Internet 连接读取和写入。

如果您需要一个示例，它将按如下方式播放：

```
row in database is created by php. 
user_1 && user_2 read. 
user_1 writes. 
user_1 && user_2 read. 
user_2 writes. 
user_1 && user_2 read. 
```

依此类推……下一个 user_1 将再次写入。

所以如果有人可以请给我任何帮助..我主要关心mysql是否是这个项目的最佳选择；它基本上是我唯一的免费选择。并序列化或不序列化..？（考虑到我的个人情况）。

非常感谢大家。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T04:08:42.497

PostgreSQL 有很好的数组支持。你创建一个整数数组的列

# c# - 将 Windows 用户“令牌”传递给 WCF 进行身份验证

> ID：12239317
> 
> 赞同：0
> 
> 时间：2012-09-02T20:01:11.180
> 
> 标签：c#, .net, active-directory

有谁知道我如何传递“令牌”？向 WCF 服务验证 windows 用户是否有效？

我想编写一个 wcf 服务，该服务可以使用 U/P 组合或 Windows 登录来进行身份验证服务，该服务将返回其自己的标准令牌。这个想法是 Windows 身份验证只是我的服务可以支持的一种方法。

我已经看到针对 ADFS 对用户名和密码进行身份验证，但我没有密码……只有用户名。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T01:39:18.650

您可以在 serviceModel 配置的两端为您的服务指定 Windows 凭据类型。

```
<system.serviceModel>
<bindings>
    <wsHttpBinding>
        <binding name="httpService">
            <security mode="Message">
                <message clientCredentialType="Windows" algorithmSuite="Default" />
            </security>
        </binding>
    </wsHttpBinding>
</bindings></system.serviceModel> 
```

[http://msdn.microsoft.com/en-us/library/ms733836.aspx](http://msdn.microsoft.com/en-us/library/ms733836.aspx)

您还需要适当地配置 IIS。

[http://msdn.microsoft.com/en-us/library/aa292114(v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/aa292114(v=vs.71).aspx)

# java - 从用户生成的多维数组中输出数据

> ID：12239318
> 
> 赞同：2
> 
> 时间：2012-09-02T20:01:10.993
> 
> 标签：java, arrays, multidimensional-array

我有一个 5 行 5 列的多维数组。前 5 行是社会问题。用户必须为每个社会问题输入一个整数值率，从 1（租赁重要）到 10（非常重要）。

如何将数据输出到表中？

```
 for (int col = 1; col < poller[row].length; col++) {
        poller[row][col] = input.nextInt();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T20:36:20.993

这会将您的数据打印到控制台。

```
int length = poller.length;
for (int row = 0; row < length; row++) {
  int rowLength = poller[row].length;
  System.out.println("");
  for (int col = 0; col < rowLength; col++) {
    System.out.print(poller[row][col]);
  }
} 
```

# sql-server - 在插入运算符中使用子查询时出错

> ID：12239320
> 
> 赞同：1
> 
> 时间：2012-09-02T20:01:44.437
> 
> 标签：sql-server, database, insertion

我有以下结构的表：

```
FirstName|MiddleName|PatientID 
```

我想在其他表中存储所有不同的名字。`FirstName`我创建了名为 TBL 的表，我想将所有不同的行插入其中。让我们假设第一个表名 uis `TBL1`。我尝试了以下方法：

```
INSERT Into TBL(FirstName) VALUES (SELECT DISTINCT FirstName FROM TBL1) 
```

但我有错误：

> 子查询返回超过 1 个值。当子查询跟在 =, ! 之后时，这是不允许的。=、<、<=、>、>= 或当子查询用作表达式时。

我在这里想念什么？我说的是 Microsoft Sql Server 2008 R2。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T20:07:30.063

这应该可以正常工作：

```
INSERT Into TBL(FirstName) 
SELECT DISTINCT FirstName FROM TBL1 
```

`VALUES`用于*单行*中的值。

# vim - VIM 键映射无法按预期工作

> ID：12239321
> 
> 赞同：2
> 
> 时间：2012-09-02T20:01:57.570
> 
> 标签：vim

我有以下关键地图：

```
nmap <F9> :s/^/\/\*! /<cr>:s/$/ !\*\//<cr>j 
```

它旨在以 C 风格注释行。当我点击它时`<F9>`，它工作正常。但是，当我尝试在它前面加上数字（以评论指定的行数）时，它会错过`*/`除最后一行之外的每一行的右括号。看起来像：

```
/*! foo1;
/*! foo2;
/*! foo3; !*/ 
```

我有类似的键映射来取消注释：

```
nmap  <F10>   :s/^\/\*! //e<cr>:s/ !\*\/$//e<cr>j 
```

情况类似（不删除右括号）。

编辑：

[哈！我找到了解决方案。](http://vim.wikia.com/wiki/Mapping_keys_in_Vim_-_Tutorial_%28Part_2%29#Supplying_a_count_to_a_map)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T20:17:40.593

实际上`vim`键盘映射通常不支持 lineranges。但是有一些解决方法：

1.  设置一个视觉选择（行）并将您的映射更改为：（`nmap <F9> :'<,'>s/^/\/\*! /<cr>:'<,'>s/$/ !\*\//<cr>j`并注意您可以在一行上发出更多 ex 命令，以便您可以将其“缩短”为`nmap <F9> :'<,'>s/^/\/\*! /|'<,'>s/$/ !\*\//<cr>j`
2.  但我建议为此使用插件：[NERD 评论](http://www.vim.org/scripts/script.php?script_id=1218)者真的很有能力......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T22:34:16.847

嗯...棘手。这与第一个替换命令转换为范围有关`:.,.+n`，但第二个仅作用于最后一行。我不太确定为什么会这样，但是转换为单个替换可以解决问题。所以，折叠成一个电话，然后稍微整理一下，这行得通：

`nnoremap <F9> :s!.*!/* & */!<CR>j`

（注意使用 of`!`而不是`/`作为模式分隔符。您可以`:s`与（几乎）任何字符一起使用。`/`只是默认设置。如果您的模式使用很多`/`s，使用其他东西并为自己节省一些转义是明智的。）

# html - 在它包含的透明 swf 文件中单击 btns 时，如何更改 html 文件的 bg 颜色

> ID：12239323
> 
> 赞同：0
> 
> 时间：2012-09-02T20:02:08.180
> 
> 标签：html, flash, background

我有一个带有透明 bg 的 swf 文件。我将它从 Flash 发布到 html，我希望在我拥有的 btns 和在该 swf 文件后面可见的 html 页面的 bg 颜色之间进行某种交互。我对 html 的了解很少，所以我希望能得到初学者可以理解的基本准则的答案。提前致谢！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T20:10:50.813

当您单击按钮时，请调用：

```
getURL("javascript:changeClass(x);"); 
```

x 将是一个带有颜色名称的字符串。在您的 HTML 中，您的 javascript 中有类似的内容（假设此处为 Jquery）：

```
function changeClass(x) {
   $('body').removeClass(); //Deletes all classes
   $('body').addClass(x); //Where x is a string
} 
```

然后在你的 CSS 中有一些 body 类：

```
body.red { background: red; }
body.green { background: green; }
body.blue { background: blue; } 
```

所以调用其中一个应该改变颜色。

# php - 获取最近四个最近类别的最新帖子

> ID：12239332
> 
> 赞同：-1
> 
> 时间：2012-09-02T20:03:40.550
> 
> 标签：php, wordpress

我是 wordpress 和 php 的新手，但我需要从最近的类别中获取最近的帖子。我尝试获取最近帖子的类别并将它们添加到具有四个类别元素的数组中。然后把这些类别的最后两个帖子拿出来。为此，我需要一点帮助。谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T21:04:09.537

所以首先你会想要使用这样的东西来获取[类别](http://wordpress.org/support/topic/order-categories-by-most-recently-updated-1)。

然后你会想要获取这些类别并创建一个新的 WP_Query 来过滤[这些类别](http://codex.wordpress.org/Class_Reference/WP_Query#Category_Parameters)（可能使用`category__in`.

所以像

```
$cat_array = array();
$args=array(
  'post_type' => 'post',
  'post_status' => 'publish',
  'posts_per_page' => 5
  );
$my_query = null;
$my_query = new WP_Query($args);
if( $my_query->have_posts() ) {
  while ($my_query->have_posts()) : $my_query->the_post();
    $cat_args=array('orderby' => 'none');
    $cats = wp_get_post_terms( $post->ID , 'category', $cat_args);
    foreach($cats as $cat) {
      $cat_array[$cat->term_id] = $cat->term_id;
    }
  endwhile;
}

wp_reset_query();

$args = array(
    'category__in' => $cats,
);
$query_cats = new WP_Query($args);
if ($query_cats->have_posts() ) {
    while ($query_cats->have_posts()) : $query_cats->the_post();
        //display your posts
    endwhile;
} 
```

请注意，上面的代码尚未经过测试，但应该相当接近。

# bash - 输入子目录（带空格）并将文件合并到另一个目录

> ID：12239334
> 
> 赞同：0
> 
> 时间：2012-09-02T20:04:11.567
> 
> 标签：bash, directory-traversal

我想在 bash 中做一些特别的事情。我找到了 for 循环和 find 的部分解决方案，但我更喜欢编写脚本来完成更复杂的工作。

我有一个复杂的目录结构如下：

```
fiction/
 book1/
  chapter1/
   page1.txt
   page2.txt
   ..
  chapter2/
   page5.txt
   page6.txt
  ..
 book2/
  chapter1/
  chapter2/
 ..
non-fiction/
 book5/
  chapter1/
.. 
```

我希望你明白这一点。

简而言之，我想做以下事情：

1.  输入每本书和章节，例如 Chapter1
2.  cat /mybooks/book1/chapter1.txt 中的所有 page1、page2 等
3.  继续下一章，并重复 /mybooks/book1/chapter2.txt
4.  继续阅读下一本书

我设法用简单的脚本做到了这一点：

```
for i in */; do cat "$i"*.txt > /newdir/"${i%%/}".txt; done 
```

我的第一个问题出现了，因为我意识到有些书不仅按章节划分，而且还分为包含章节的部分或小节。唯一的解决方案是 cd 到这些文件夹并手动执行脚本。

但这不是专业的方式。如何使脚本更智能地遍历子目录然后返回？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T20:59:19.720

您可以尝试以下方法：

```
for b in */*
do 
  cat $(find "$b" -type f -name \*.txt| sort) >> "$b"/$(basename "$b").txtb
done 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T21:38:16.500

这个答案...

*   处理带空格的目录
*   如果您在一章中有超过 9 页，则对页面进行正确排序

* * *

它基于以下假设：

*   页面总是紧接在章节的下方*
*   页面被命名为 page[一位或多位].txt
*   只有一个部分与路径中的“chapter*”匹配，所以没有像“chapter2/subchapter1”这样的部分

* * *

```
#!/bin/bash

while read -r -d $'\0' path; do
    output="$path".txt
    ls -1 "$path"/page*.txt | \
     sed 's/^.*\([0-9][0-9]*\).txt/\1/' | \
     sort -n | \
     while read n; do
         echo "cat ${path}/page${n}.txt >> $output"
         # cat "${path}/page${n}.txt" >> "$output"
     done
done < <(find fiction/ -type d -name "chapter*" -print0) 
```

* * *

如果对结果满意，请删除 - 行`echo`并取消注释下面的行。

### 例子：

```
find f
f
f/book2
f/book2/chapter1
f/book2/chapter1/page10.txt
f/book2/chapter1/page2.txt
f/book2/chapter1/page1.txt
f/book2/chapter3
f/book2/chapter3/page2.txt
f/book2/chapter3/page1.txt
f/book2/chapter2
f/book2/chapter2/page2.txt
f/book2/chapter2/page1.txt
f/book2/part1
f/book2/part1/subsection1
f/book2/part1/subsection1/chapter1
f/book2/part1/subsection1/chapter1/page2.txt
f/book2/part1/subsection1/chapter1/page3.txt
f/book2/part1/subsection1/chapter1/page1.txt
f/book1
f/book1/chapter1
f/book1/chapter1/page2.txt
f/book1/chapter1/page1.txt
f/book1/chapter3
f/book1/chapter3/page2.txt
f/book1/chapter3/page1.txt
f/book1/chapter2
f/book1/chapter2/page2.txt
f/book1/chapter2/page1.txt
f/book with space
f/book with space/chapter1
f/book with space/chapter1/page2.txt
f/book with space/chapter1/page1.txt 
```

### 输出：

```
cat f/book2/chapter1/page1.txt >> f/book2/chapter1.txt
cat f/book2/chapter1/page2.txt >> f/book2/chapter1.txt
cat f/book2/chapter1/page10.txt >> f/book2/chapter1.txt
cat f/book2/chapter3/page1.txt >> f/book2/chapter3.txt
cat f/book2/chapter3/page2.txt >> f/book2/chapter3.txt
cat f/book2/chapter2/page1.txt >> f/book2/chapter2.txt
cat f/book2/chapter2/page2.txt >> f/book2/chapter2.txt
cat f/book2/part1/subsection1/chapter1/page1.txt >> f/book2/part1/subsection1/chapter1.txt
cat f/book2/part1/subsection1/chapter1/page2.txt >> f/book2/part1/subsection1/chapter1.txt
cat f/book2/part1/subsection1/chapter1/page3.txt >> f/book2/part1/subsection1/chapter1.txt
cat f/book1/chapter1/page1.txt >> f/book1/chapter1.txt
cat f/book1/chapter1/page2.txt >> f/book1/chapter1.txt
cat f/book1/chapter3/page1.txt >> f/book1/chapter3.txt
cat f/book1/chapter3/page2.txt >> f/book1/chapter3.txt
cat f/book1/chapter2/page1.txt >> f/book1/chapter2.txt
cat f/book1/chapter2/page2.txt >> f/book1/chapter2.txt
cat f/book with space/chapter1/page1.txt >> f/book with space/chapter1.txt
cat f/book with space/chapter1/page2.txt >> f/book with space/chapter1.txt 
```

# javascript - 使用 DateTimePicker 插件的 JQuery 不起作用

> ID：12239340
> 
> 赞同：2
> 
> 时间：2012-08-29T18:56:30.047
> 
> 标签：javascript, jquery

我的网站上需要 DateTimePicker，我试试[这个例子](http://trentrichardson.com/examples/timepicker/)

并且不工作。我的代码[在这里](http://pastebin.com/XEUUrtBj)

我的 localhost (/var/www) 文件夹中**也包含**我的.js 文件。谢谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T19:08:20.720

看起来你缺少 jquery 和 jquery ui。[请参阅http://jsbin.com/igogob/1/edit#html,live](http://jsbin.com/igogob/1/edit#html,live)上 [的工作代码](http://jsbin.com/igogob/1/edit#html,live)

# android - 将 Parcelable 的一个子类写入另一个 Parcel

> ID：12239343
> 
> 赞同：69
> 
> 时间：2012-09-02T20:05:37.963
> 
> 标签：android, parcelable

我有一个实现`Parcelable`接口的类：

```
class A implements Parcelable {

} 
```

我有另一个`B`包含一个`A`对象作为实例变量的类。在`writeToPacel`里面的类`B`中，我想将对象`B`写入`Parcel`：

```
class B implements Parcelable{

    public void writeToParcel(Parcel dest, int flags) {
        dest.write ??? 
    }
} 
```

我该如何书写和阅读它？

* * *

## 回答 #1

> 赞同：173
> 
> 时间：2012-09-02T20:37:48.077

```
class B implements Parcelable{
//lets assume you have A as a data member 

A obj;
public void writeToParcel(Parcel dest, int flags) {

        dest.writeParcelable(obj , flags);

    }
} 
```

如果您想阅读它，请使用此

```
 obj = in.readParcelable(A.class.getClassLoader()); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2014-09-15T15:47:31.887

避免反射的更好的处理方法是简单地调用目标类型中的静态创建者，如下所示：

```
this.amazingObject = AmazingObject.CREATOR.createFromParcel(in); 
```

并将其写入`Parcelable`使用`this.amazingObject.writeToParcel(Parcel, int)`

在内部，当调用`readParcelable(ClassLoader)`这种情况时：

```
public final <T extends Parcelable> T readParcelable(ClassLoader loader) {
    Parcelable.Creator<T> creator = readParcelableCreator(loader);
    if (creator == null) {
        return null;
    }
    if (creator instanceof Parcelable.ClassLoaderCreator<?>) {
        return ((Parcelable.ClassLoaderCreator<T>)creator).createFromParcel(this, loader);
    }
    return creator.createFromParcel(this);
} 
```

正如您所看到的，该方法的最后一次调用只是调用了正确的方法，`Creator`但内部`readParcelableCreator`有很多反射，我们可以通过直接调用它来避免。

此实用程序调用可能很有用：

```
import android.os.Parcel;
import android.os.Parcelable;

public class Parcels {

    public static void writeBoolean(Parcel dest, Boolean value) {
        dest.writeByte((byte) (value != null && value ? 1 : 0));
    }

    public static Boolean readBoolean(Parcel in){
        return in.readByte() != 0;
    }

    public static void writeParcelable(Parcel dest, int flags, Parcelable parcelable) {
        writeBoolean(dest, parcelable == null);
        if (parcelable != null) {
            parcelable.writeToParcel(dest, flags);
        }
    }

    public static <T extends Parcelable> T readParcelable(Parcel in, Parcelable.Creator<T> creator) {
        boolean isNull = readBoolean(in);
        return isNull ? null : creator.createFromParcel(in);
    }

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-02-07T06:01:41.070

该行：

```
obj = (A)in.readParcelable(A.class.getClassLoader()); 
```

应改为：

```
obj = (A)in.readParcelable(B.class.getClassLoader()); 
```

我遇到了同样的问题，做了几次谷歌搜索，很多网页或教程建议我们使用`A.class.getClassLoader()`，因为我们正在转换为 A，但实际上它是错误的，因为你会得到一个空值，我们必须使用`B.class.getClassLoader()`，因为`codes are INSIDE class B`. 我只是不知道为什么，但它可以通过这种方式获得正确的 A 对象。

欢迎评论和验证！！

# java - 为什么我不应该将equals与继承一起使用？

> ID：12239344
> 
> 赞同：12
> 
> 时间：2012-09-02T20:06:03.483
> 
> 标签：java, oop, equals

当我阅读一本 Java 书籍时，作者曾说过，在设计一个类时，使用`equals()`继承通常是不安全的。例如：

```
public final class Date {
    public boolean equals(Object o) {
         // some code here
    }
} 
```

在上面的类中，我们应该放`final`，所以其他类不能继承。我的问题是，为什么允许另一个类继承它是不安全的？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-09-02T20:14:32.557

因为很难（不可能？）使它正确，尤其是[*对称*属性](http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html#equals(java.lang.Object))。

假设你有 class`Vehicle`和 class `Car extends Vehicle`。如果参数也是 a并且具有相同的权重，则产生`Vehicle.equals()`。如果你想实现它，只有当参数也是汽车时才应该产生，除了重量，它还应该比较品牌、引擎等。`true``Vehicle``Car.equals()``true`

现在想象下面的代码：

```
Vehicle tank = new Vehicle();
Vehicle bus = new Car();
tank.equals(bus);  //can be true
bus.equals(tank);  //false 
```

`true`如果碰巧油箱和公共汽车具有相同的重量，则第一次比较可能会产生。但是由于坦克不是汽车，因此将其与汽车进行比较总是会产生`false`。

你有几个解决方法：

*   严格：两个对象相等*当且仅当*它们具有完全相同的类型（并且所有属性都相等）。这很糟糕，例如，当您创建子类以添加一些行为或装饰原始类时。一些框架也在你没有注意到的情况下对你的类进行子类化（Hibernate、带有 CGLIB 代理的 Spring AOP ......）

*   松散的：如果两个对象的类型“兼容”并且它们具有相同的内容（语义上），则它们是相等的。例如，如果两个集合包含相同的元素，则它们是相等的，一个是`HashSet`另一个是无关紧要`TreeSet`（感谢*@veer*指出这一点）。

    这可能会产生误导。取两个`LinkedHashSet`s（插入订单作为合同的一部分很重要）。然而，由于`equals()`只考虑了原始`Set`合同，`true`即使对于明显不同的对象，比较也会产生：

    ```
    Set<Integer> s1 = new LinkedHashSet<Integer>(Arrays.asList(1, 2, 3));
    Set<Integer> s2 = new LinkedHashSet<Integer>(Arrays.asList(3, 2, 1));
    System.out.println(s1.equals(s2)); 
    ```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-09-02T20:24:30.900

Martin Odersky（Java 中的泛型和当前的原始代码库背后的人）在他的《 *Scala 编程》*`javac`一书中有一个很好的章节来解决这个问题。他建议添加一个方法可以解决相等/继承问题。您可以阅读他的书第一版中的讨论，该书可在线获取：*`canEqual`*

 *[Scala 编程，第一版的第 28 章：对象平等](http://www.artima.com/pins1ed/object-equality.html)

这本书当然指的是 Scala，但同样的想法也适用于经典的 Java。对于具有 Java 背景的人来说，示例源代码应该不难理解。

***编辑：***

看起来 Odersky 早在 2009 年就在 Java 中发表了一篇关于相同概念的文章，并且可以在同一个网站上找到它：

[如何在 Java 中编写等式方法](http://www.artima.com/lejava/articles/equality.html)

我真的不认为试图在这个答案中总结这篇文章会做到公正。它深入涵盖了对象相等的主题，从相等实现中的常见错误到对 Java`equals`作为等价关系的全面讨论。你真的应该读一下。*

# javascript - 将 3 个功能合并在一起

> ID：12239346
> 
> 赞同：-3
> 
> 时间：2012-09-02T20:06:06.917
> 
> 标签：javascript, jquery, ajax, json

我正在尝试将这 3 个函数合并在一起，以便我可以将所有数据放入流中，并将显示在单个 div 中。我该怎么办？

AJAX 它不会获取用户的名字、中间名或姓氏，因为在 response.users 而不是 response.stream 下返回

```
 <script type="text/javascript">
$(function() 
{
$('.load_more').live("click",function() 
{
var ID = $(this).attr("id");
if(ID)
{
$("#load"+ID).html('Loading...');

$.ajax({
type: "POST",
url: "include/load_more_home_posts.php",
cache: false, 
dataType: "json",
data: { streamitem_id: ID},
cache: false,
success: function(response){
     $.each(response.streams, function(i, stream) {
    $("#articles").prepend("<div id='divider-"+stream['streamitem_id']+"'><div class='userinfo'><a href='/profile.php?username="+stream['username']+"'><img class='stream_profileimage' style='border:none;padding:0px;display:inline;' border=\"0\" src=\"imgs/cropped"+stream['id']+".jpg\" onerror='this.src=\"img/no_profile_img.jpeg\"' width=\"40\" height=\"40\" ></a><div class'delete' style='cursor:pointer;position:relative;top:0px;float:right;padding-right:5px;' onclick=\"delete_('"+stream['streamitem_id']+"');\">X</div><a href='/profile.php?username="+stream['username']+"'>"+stream['first']+" "+ stream['middle']+" "+stream['last']+"</a><span class='subtleLink'> said</span><br/><a class='subtleLink' style='font-weight:normal;'>"+stream['streamitem_timestamp']+"</a><hr>"+stream['streamitem_content']+"<div style='height:20px;' class='post_contextoptions'><div id='streamcomment'><a style='cursor:pointer;' id='commenttoggle_"+stream['streamitem_id']+"' onclick=\"toggle_comments('comment_holder_"+stream['streamitem_id']+"');clearTimeout(streamloop);swapcommentlabel(this.id);\">Write a comment...</a></div><div id='streamlike'><a title='Like "+stream['first']+" "+ stream['middle']+" "+stream['last']+"s status' id='likecontext_"+stream['streamitem_id']+"' style='cursor:pointer;' onClick=\"likestatus("+stream['streamitem_id']+",this.id);\"><div style='width:50px;' id='likesprint"+stream['streamitem_id']+"'>Like</a></div><div style='width:50px;' id='likesprint"+stream['streamitem_id']+"'><a title='See who likes "+stream['first']+" "+ stream['middle']+" "+stream['last']+"s status' href='include/likes.php?streamitem_id="+stream['streamitem_id']+"' /></a></div></div></form></div><div id='streamdislike'><a id='dislikecontext_"+stream['streamitem_id']+"' style='cursor:pointer;' onClick=\"dislikestatus("+stream['streamitem_id']+",this.id);\"><div style='width:70px;' id='dislikesprint"+stream['streamitem_id']+"'>Dislike</a></div><div style='width:70px;' id='dislikesprint"+stream['streamitem_id']+"'></div></div></form><div class='stream_comment_holder' style='display:none;' id='comment_holder_"+stream['streamitem_id']+"'><div id='comment_list_"+stream['streamitem_id']+"'></div><div class='stream_comment_inputarea'><form id='mycommentform' method='POST'  class='form_statusinput'>\
<input type='hidden'  name='streamidcontent' id='streamidcontent' value='"+stream['streamitem_id']+"'>\
<input type='input' name='commentingcontents' id='commentingcontents' placeholder='Say something' autocomplete='off'>\
<input type='submit' id='button' value='Feed'><br/></div></div>").show();

      // the rest of your code from inside your $.each() here
   });
};

  // Comments
    $.each(response.comments, function(i, comment) {

    });

 // Users
    $.each(response.users, function(i, user) {    
    });

// remove the previous load more link
$("#load"+ID).remove();
}
});
}
return false;
});
});
</script> 
```

我需要发回的 3 个 json 对象都在 1 个 div 内，所以我没有 UNDEFINED。

```
$following_string = mysqli_real_escape_string($mysqli,$_SESSION['id']);
$call="SELECT * FROM streamdata WHERE streamitem_id < '$lastID' AND streamitem_target=".$following_string." OR streamitem_creator=".$following_string." ORDER BY streamitem_id DESC LIMIT 10";
$chant = mysqli_query($mysqli, $call) or die(mysqli_error($mysqli));
$json = array();
$json['streams'] = array();

while ($resultArr = mysqli_fetch_assoc($chant)) {
    $arr = array();
    $arr['streamitem_id'] = $resultArr['streamitem_id'];
    $arr['streamitem_content'] = $resultArr['streamitem_content'];
    $arr['streamitem_timestamp'] = Agotime($resultArr['streamitem_timestamp']);

    $json['streams'][] = $arr;
}

/***** COMMENTS *****/
$check = "SELECT comment_id, comment_datetime, comment_streamitem, comment_poster, comment_content FROM streamdata_comments WHERE comment_poster=".$following_string."  ORDER BY comment_datetime DESC";
$check1 = mysqli_query($mysqli,$check);
$json['comments'] = array();

while ($resultArr = mysqli_fetch_assoc($check1)) {
    $arr = array();
    $arr['comment_id'] = $resultArr['comment_id'];
    $arr['comment_content'] = $resultArr['comment_content'];
    $arr['comment_poster'] = $resultArr['comment_poster'];
    $arr['comment_datetime'] = Agotime($resultArr['comment_datetime']);
    $arr['comment_streamitem'] = $resultArr['comment_streamitem'];

    $json['comments'][] = $arr;
}

/***** USERS *****/

$check = "SELECT * FROM users WHERE id=".$following_string."";
$check1 = mysqli_query($mysqli,$check);
$json['users'] = array();

while ($resultArr = mysqli_fetch_assoc($check1)) {
    $arr = array();
    $arr['username'] = $resultArr['username'];
    $arr['id'] = $resultArr['id'];
    $arr['first'] = $resultArr['first'];
    $arr['middle'] = $resultArr['middle'];
    $arr['last'] = $resultArr['last'];

    $json['users'][] = $arr;
}

echo json_encode($json);
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T20:55:25.247

您需要做的是将您的`comments`和`users`数据转换为一种格式，您可以在其中轻松查找与您的流相关的评论和用户。就像现在一样，您必须遍历每个评论对象`comments`以查找与您的流相关的评论，然后通过每个用户`users`查找与您的评论相关的用户。这不仅效率极低，而且代码密集。

为了解决这个问题，您应该发送带有键的对象以帮助您查找内容，而不是在 JSON 中发送平面数组。换句话说，而不是你的 JSON 看起来像这样：

```
{
    "streams": [...],
    "comments": [...],
    "users": [...]
} 
```

它应该看起来更像这样：

```
{
    "streams": [...],
    "comments": {
        943: [...], /* 943 is the ID of the stream */
        945: [...],
        975: [...],
    },
    "users": {
        34: { ... }, /* these keys are user IDs */
        45: { ... },
        398: { ... },
    },
} 
```

甚至将您的评论嵌入到与它们相关的流对象中：

```
{
    "streams": [
        { 
            ...,
            "comments": [...]
        },
        { 
            ...,
            "comments": [...]
        },
    ],
    "users": {
        34: { ... }, 
        45: { ... },
        398: { ... },
    },
} 
```

使用这些结构，在处理流时更容易找到所需的数据。

最好是您的 PHP 以这种更理想的格式生成数据。我不是 PHP 专家，所以我将向您展示如何在 JavaScript 中转换数据。在循环通过您的流对象之前，预处理您的其他数组，以便数据查找更容易：

```
var commentLookup = {};
var userLookup = {};

$.each(response.comments, function(i, comment) {
    var streamId = comment.comment_streamitem;
    if (!(streamId in commentLookup)) {
        commentLookup[streamId] = [];
    }
    commentLookup[streamId].push(comment);
});

$.each(response.users, function(i, user) {
    userLookup[user.id] = user;
}); 
```

现在，当您循环浏览流时，您可以轻松查找相关对象：

```
$.each(response.streams, function(i, stream) {

    // Output stream content

    // Output comments
    $.each(commentLookup[stream.streamitem_id], function(i, comment) {
        // Output comment contents

        var commenter = userLookup[comment.comment_poster];
        var name = commenter.first + ' ' + commenter.last;
        // etc.
    });

}); 
```

# android - 重新启动应用程序时无法保留当前活动

> ID：12239349
> 
> 赞同：0
> 
> 时间：2012-09-02T20:06:14.750
> 
> 标签：android, android-activity, android-lifecycle

我有 3 个活动：活动 A、B 和 C 活动 A 是我的登录活动，用户登录到他的帐户，活动 B 是仪表板，活动 C 是 ListView

在 Android 手机上：当我在 Activity C 上按下手机上的 Home 按钮时，它会将我带到手机的主屏幕，而当我尝试再次启动应用程序时，它会将我带到 Activity A 而不是我最初离开的 Activity C。

在模拟器上：当我在 Activity C 上时，我按下手机上的 Home 按钮，而当我尝试再次启动应用程序时，它会将我带到 Activity C。

此外，我在每个活动上都设置了 onResume，只是为了在活动恢复时检查手机是否可以访问互联网。现在的问题是我不明白为什么我在手机上的行为与我在模拟器上的行为不同。

我希望应用程序从我离开它的活动 C 开始。我想要与我在模拟器上获得相同的行为。

模拟器上也没有发生错误或崩溃。所以我很难找到问题所在。

请指导我该怎么做，或者请告诉我可能是什么问题。

谢谢你！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T20:22:25.733

嗯，这两种行为都是正常的。这就是正在发生的事情：当您从“Activity C”按下主页按钮时，操作系统会将您带到 android 主屏幕，然后由操作系统决定是销毁 Activity 还是保留它（这取决于操作系统的资源需要）。

那么在模拟器上可能没有或很少有其他活动正在运行，因此操作系统不会破坏“活动 C”，当您重新启动应用程序时，它会将您带到仍然存在的“活动 C”。

与模拟器相比，您的设备必须运行大量其他应用程序和服务，并且需要资源来保持它们平稳运行，因此当您退出 Activity 时，操作系统会破坏该 Activity 并声明分配给该应用程序的资源。因此，当您启动应用程序时，它会从头开始重新创建或重新启动应用程序，在您的情况下是“活动 A”。

因此，它的行为非常正常，您应该担心它。

有关更多详细信息，您可以阅读[此](http://developer.android.com/reference/android/app/Activity.html)内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T20:54:33.827

关于您不使用 Eclipse 来启动应用程序 - 我想介绍另一种解决方案。

请查看 Manifest 中 Activity 标记的以下键：http: `android:alwaysRetainTaskState` [//developer.android.com/guide/topics/manifest/activity-element.html#always](http://developer.android.com/guide/topics/manifest/activity-element.html#always)

根据文档，它的默认值为 false。如果在任务根活动中设置为 true （我认为在你的情况下是 Launcher） - 它会告诉系统始终保持任务的状态并且不要重置它。因此，即使进程将被终止 - 重新启动后，您也应该出现在最新的任务状态。

但是，要小心，因为如果

1.  您将不为任务的根指定它。
2.  如果您在应用程序中为您的意图使用任务操作标志。例如 FLAG_ACTIVITY_CLEAR_TASK/FLAG_ACTIVITY_CLEAR_TOP/等

祝你好运

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T20:18:57.123

根据您使用的 Eclipse ADT 插件，手机上的行为可能是错误的，因为您是从 Eclipse 启动应用程序。您可以尝试“adb install your_app.apk”并从屏幕手动启动它，它可以解决问题。

一般来说，您描述的行为是设计好的行为，所以如果不中断（通过意图标志和清单语句） - 系统应该按照您的意愿行事，恢复最后一个活动及其状态。

祝你好运

# haskell - 如何遍历列表并逐步删除值

> ID：12239350
> 
> 赞同：2
> 
> 时间：2012-09-02T20:06:16.583
> 
> 标签：haskell

我有一个看起来像这样的列表：

```
lst = [1,2,6,3,9] 
```

我想编写一个函数，将列表中的所有数字相加并将该值附加到一个新列表中，然后遍历列表并逐个删除一个值并对这些值求和。该函数将执行此计算：

```
result = [[1+2+6+3+9],
          [1+6+3+9],
          [1+2+3+9],
          [1+2+6+9],
          [1+2+6+3]] 
```

鉴于上面的列表示例，我试图描述的函数将产生此结果：

> [21,19,15,18,12]

我很难理解如何在 Haskell 中实现这个功能。具体来说，如何遍历一个列表，并删除一个元素，但每次将删除的值加一。任何人都可以帮忙吗？谢谢。我一直在尝试编写一个使用折叠的辅助函数，但我不知道如何在每次“迭代”时从最后一个元素中删除一个不同的元素。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-02T20:36:13.967

你可以按照这些思路写一些东西：

```
f xss@(x:xs) = total : map (total -) xs
  where total = sum xss 
```

基本上它说首先你有你的列表的总和，然后你对于每个元素都有这个相同的总和减去这个元素（我们跳过头部）。

更多细节：

*   `(x:xs)`用于在给定列表上进行模式匹配，以便我们稍后只需使用即可轻松跳过头部`xs`
*   `xss@...`用于命名整个模式，以便我们仍然可以轻松使用整个列表
*   where 子句引入了一个保存列表总和的变量，这样它就不会被重新计算很多次（也许它已经被优化了，我们确信这样）。
*   `(total -)`是一个操作符部分：当使用参数调用时`x`，它会返回`total - x`

注意：当这个函数被给定一个空列表时，你必须精确说明会发生什么，例如，如果你希望它返回空列表，添加：

```
f [] = [] 
```

**编辑**：关于的解释`map (total -) xs`：

正如我在上面的列表中详述的那样，`(total -)`是一个运算符部分，它为我们提供了以下功能：

```
\x -> total - x 
```

它返回总数减去它给出的值。

现在，我们将该函数映射到给定列表的尾部`f`。例如，如果您给出`f`列表

```
[1, 2, 6, 3, 9] 
```

它会让我映射过来

```
[2, 6, 3, 9] 
```

如果 total 是`21`，则 map 调用的结果是

```
[19, 15, 18, 12] -- [21 - 2, 21 - 6, 21 - 3, 21 - 9] 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-02T21:19:12.943

`(+)`Mog 给出了一个答案，它利用了关联、交换和逆的事实。但是，我认为给出一个适用于任何操作的答案也是建设性的；也就是说，要生成要求和的实际列表，然后将它们求和。所以计划会是这样的：

1.  编写一个在每个可能位置拆分列表的函数。
2.  编写一个函数，通过在拆分处删除元素将拆分回列表。
3.  编写一个对列表求和的函数（已经完成`Prelude`：使用该`sum`函数）。
4.  编写一个函数来组合它们，并包含整个列表的特殊情况。

第一部分有几种方法。第一种选择是显式递归：

```
splits :: [a] -> [([a], [a])]
splits []     = [([],[])]
splits (x:xs) = ([],x:xs) : map (\(b,e) -> (x:b,e)) (splits xs) 
```

我们可以在 ghci 中检查它以确保我们做对了：

```
*Main> splits "abcde"
[("","abcde"),("a","bcde"),("ab","cde"),("abc","de"),("abcd","e"),("abcde","")] 
```

但是，有一个更好的方法。该`Data.List`模块包含一系列用于以特定方式修改列表的功能。其中两个是`tails`和`inits`：

```
*Main> tails "abcde"
["abcde","bcde","cde","de","e",""]
*Main> inits "abcde"
["","a","ab","abc","abcd","abcde"] 
```

所以这个定义看起来更好看：

```
splits xs = zip (inits xs) (tails xs) 
```

现在，我们需要一个函数来生成列表列表，其中每个位置删除一个元素。

```
dropEach xs = [beginning ++ end | (beginning, ignored:end) <- splits xs] 
```

所以最后一步是将所有东西放在一起。

```
funnySums xs = map sum (xs : dropEach xs) 
```

我们可以测试：

```
*Main> funnySums [1, 10, 100, 1000, 10000]
[11111,11110,11101,11011,10111,1111] 
```

# c# - 更新云队列中的消息内容时出现异常

> ID：12239353
> 
> 赞同：0
> 
> 时间：2012-09-02T20:06:34.637
> 
> 标签：c#, azure, message-queue, azure-storage, azure-worker-roles

尝试更新云队列上的消息时出现异常。

例外是：

```
System.ArgumentNullException was unhandled
  Message=Value cannot be null.
Parameter name: messageId
  Source=Microsoft.WindowsAzure.StorageClient
  ParamName=messageId
  StackTrace:
       at Microsoft.WindowsAzure.StorageClient.Tasks.Task`1.get_Result()
       at Microsoft.WindowsAzure.StorageClient.Tasks.Task`1.ExecuteAndWait()
       at Microsoft.WindowsAzure.StorageClient.TaskImplHelper.ExecuteImplWithRetry(Func`1 impl, RetryPolicy policy)
       at Microsoft.WindowsAzure.StorageClient.CloudQueue.UpdateMessage(CloudQueueMessage message, TimeSpan visibilityTimeout, MessageUpdateFields updateFields)
       at WorkerRole.WorkerRole.DoTask(Task task) in C:\Users\ALICE\Desktop\Diplloma\AG - Copy\AzureGrid\WorkerRole\WorkerRole.cs:line 133
       at WorkerRole.WorkerRole.Run() in C:\Users\ALICE\Desktop\Diplloma\AG - Copy\AzureGrid\WorkerRole\WorkerRole.cs:line 51
       at Microsoft.WindowsAzure.ServiceRuntime.RoleEnvironment.StartRoleInternal()
       at Microsoft.WindowsAzure.ServiceRuntime.RoleEnvironment.StartRole()
       at Microsoft.WindowsAzure.ServiceRuntime.Implementation.Loader.RoleRuntimeBridge.<StartRole>b__1()
       at System.Threading.ThreadHelper.ThreadStart_Context(Object state)
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
       at System.Threading.ThreadHelper.ThreadStart()
  InnerException: 
```

我的代码是：

```
private void DoTask(Task task)
{
    CloudQueueMessage resultsMessage;

    // Queue a status message to indicate this worker is starting the task.
    task.TaskStatus = Task.Status.Running;
    task.Worker = System.Net.Dns.GetHostName();
    resultsMessage = task.Message;
    ResultsQueue.UpdateMessage(resultsMessage, TimeSpan.FromSeconds(QueueTimeout), MessageUpdateFields.Content | MessageUpdateFields.Visibility);

    Trace.WriteLine("Executing task " + task.TaskId.ToString() + " for job " + task.JobId + ", project " + task.ProjectName,"Information");

    using (GridWorker gridWorker = new AppWorker())
    {
        gridWorker.Execute(task);
    }

    // Queue results.
    task.TaskStatus = Task.Status.Complete;
    resultsMessage = task.Message;
    ResultsQueue.UpdateMessage(resultsMessage, TimeSpan.FromSeconds(QueueTimeout), MessageUpdateFields.Content | MessageUpdateFields.Visibility);
} 
```

这是任务对象的创建方式

```
public override void Run()
{
    CloudQueueMessage taskMessage;
    Task task;

    // This is a sample worker implementation. Replace with your logic.
    Trace.WriteLine("Initializing", "Information");

    LoadConfigurationSettings();
    OpenQueues();

    Trace.WriteLine("Initializing", "Ready for work");

    // Work loop. Read a task from the queue. If there is a task, execute it and pass work output to the results queue. Loop.

    while (true)
    {
        taskMessage = TaskQueue.GetMessage(TimeSpan.FromSeconds(QueueTimeout));
        //taskMessage = TaskQueue.PeekMessage();

        if (taskMessage != null)
        {
            task = new Task(taskMessage);
            DoTask(task);
            TaskQueue.DeleteMessage(taskMessage);
        }
        else
            Thread.Sleep(SleepInterval * 1000);
    }
} 
```

这是我的第一个应用程序，我不知道该怎么做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T21:59:28.940

是从哪里来`task.Message`的？之前是从队列中读取的吗？（似乎缺少消息 ID。）

# php - 将表数据保存到数组中？

> ID：12239355
> 
> 赞同：-1
> 
> 时间：2012-09-02T20:07:06.817
> 
> 标签：php, html, sql, multidimensional-array

我有一个充满文本框的表格。我需要获取所有文本框值并将它们保存到数组中。然后我会将数组转换为字符串并 POST 到另一个页面。我有大约 7-8 个 cloumns，行数在 1-200 之间 如何将所有这些保存在数组中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T20:08:34.647

mysql_query() [1](http://php.net/manual/en/function.mysql-query.php) ; mysqli 对象[2](http://php.net/manual/en/book.mysqli.php) ; 而（）[3](http://php.net/manual/en/control-structures.while.php) ; mysql_fetch_assoc(4);

你自己也做过研究吗？

# ios - 让仪器始终恢复到磁盘上的脚本文件（而不是提示）以进行 iOS UIAutomation 测试

> ID：12239356
> 
> 赞同：1
> 
> 时间：2012-09-02T20:07:06.950
> 
> 标签：ios, ios5, instruments, ui-automation, ios-ui-automation

**问题：** 有没有办法让 Instruments 从磁盘上的更改警告到当前加载的脚本，让它只使用磁盘上最新版本的脚本？我总是在 Instruments 之外编辑它。

**背景：** 我正在 Xcode 中编辑我的 UIAutomation 脚本（当然是 JavaScript）。我在 UIAutomation Instrument 中选择它们以使用 Instruments 工具进行分析。我可以创纪录，一切都很好。

在构建测试脚本时，我将在 Xcode 中对其进行编辑，并在 Instruments 应用程序中切换记录按钮以重新开始测试。

Instruments 提示我更改外部位置的脚本。我每次都说“恢复”（到磁盘版本）。我并不热衷于在 Instruments 中编辑我的脚本，因为我一直在“脚本”视图和“跟踪日志”视图之间切换。

*   **注意**：我在带有 iOS5.1 基础 SDK 的 Mountain Lion 10.8.1 上使用 Xcode 4.4.1。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T14:29:22.433

**我找到了一个解决方案：**

*   我在 javascript 文件中使用`#import`指令来导入我不断更改的文件。
*   我将 Instruments 指向这个 javascript 文件的外壳，其唯一目的是在积极开发中导入我的实际测试文件。
*   然后我在另一个编辑器中修改我正在积极开发的文件，仪器不会抱怨

# c# - 通过开始屏幕颜色更改平铺背景颜色

> ID：12239357
> 
> 赞同：1
> 
> 时间：2012-09-02T20:07:26.573
> 
> 标签：c#, windows-8, microsoft-metro, background-color

我正在开发一个 Windows 8 Metro UI 应用程序。

如何将我的应用程序平铺背景设置为开始菜单颜色？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T00:21:42.303

我相当确定您不能以编程方式访问“开始”屏幕颜色，尽管我似乎找不到比 Release Preview 更新的明确参考。

您*可以*通过应用清单显式设置磁贴背景颜色![在此处输入图像描述](../Images/9c5215fd1aa0197e49a4fc17168c899d.png)

# java - While 循环循环所有内容但不保存

> ID：12239358
> 
> 赞同：2
> 
> 时间：2012-09-02T20:07:27.363
> 
> 标签：java, swing, dialog, joptionpane

我正忙于我更大的应用程序 Hangman 的测试阶段。但在我继续讨论该代码之前，我必须先弄清楚该代码。

现在，我创建了 2 个字符串：1 个是单词，1 个用于隐藏该单词，其字母数量与原始单词包含的相同但带有`'-'`. 现在，有人给了我我正在寻找的代码，它读取原始字符串并替换`'-'`第二个字符串中的相同位置，这取决于字符是否在字母中，现在我创建了一个循环来循环六次但是这个词不会让前一个字母被猜到（如果猜对了）

```
import javax.swing.*;

public class MyThisTest{
public static void main(String[] args){
    int error = 0;
    while(error < 6){
    char guessLetter = JOptionPane.showInputDialog(null, "Enter a letter:").charAt(0);

    String original = "painting";
    String secret = new String(new char[original.length()]).replace('\0', '-');

    StringBuilder builder = new StringBuilder(secret);
    for (int i = 0; i < original.length(); i++){
        if (original.charAt(i) == guessLetter){
            builder.setCharAt(i, guessLetter);
        }
    }

    secret = builder.toString();
    error++;
    System.out.println(secret);
    System.out.println(original);
    }

}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T20:15:13.910

上面的一个问题是您正在创建`StringBuilder`while 循环内部，因此每个循环都会重新创建它。解决方案：在 while 循环***之前***创建您的`StringBuilder`秘密单词。这样，创建一次并保留循环中所做的更改。*`StringBuilder`*

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T20:19:28.330

您只需要更改2行代码，将其放在`while`循环之前

```
String original = "painting";
String secret = new String(new char[original.length()]).replace('\0', '-'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T20:20:32.907

让我们从这个开始

```
int error = 0;

String original = "painting";
String secret = new String(new char[original.length()]).replace('\0', '-');

while(error < 6)
{
   char guessLetter = JOptionPane.showInputDialog(null, "Enter a letter:").charAt(0);

   StringBuilder builder = new StringBuilder(secret);
   for (int i = 0; i < original.length(); i++){
     if (original.charAt(i) == guessLetter){
        builder.setCharAt(i, guessLetter);
     }
   }

   secret = builder.toString();
   error++;

}
  System.out.println(secret);
  System.out.println(original); 
```*

# ruby - 通过在 Ruby 中强制用户代理获取 https 页面的 HTML 源代码

> ID：12239367
> 
> 赞同：1
> 
> 时间：2012-09-02T20:08:23.243
> 
> 标签：ruby, facebook, https, screen-scraping, http-status-code-302

```
>>require 'net/https'
>>uri = URI('https://www.facebook.com/careers/department?dept=product-management&req=a2KA0000000E147MAC')
>>conn = Net::HTTP.new(uri.host, uri.port)
>>req = Net::HTTP::Get.new(uri.request_uri, {'User Agent' => 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_6_8) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.89 Safari/537.1'})
>>resp = conn.request req
=> #<Net::HTTPFound 302 Found readbody=true> 
```

网站抛出的 302 重定向重定向到“不支持的浏览器”页面。我在为此请求设置用户代理时做错了什么？我正在使用浏览器返回的相同用户代理字符串。附加信息：在这个用例中，我不能使用诸如 watir 之类的库。任何使用“net/http[s]”或“open-uri”的解决方案都很棒。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T20:59:56.993

使用连字符将“用户代理”更改为“用户代理”。

# c++ - 如何在 C++ 中通过套接字使用 protobuf 发送序列化数据

> ID：12239370
> 
> 赞同：2
> 
> 时间：2012-09-02T20:08:56.207
> 
> 标签：c++, protocol-buffers

我正在尝试使用 protobuf 序列化一些数据并通过套接字（winsock2）发送它。我真的很感激一个关于如何做到这一点的简单例子。我已经检查了 Google 文档，但没有有用的示例或初学者解释。

提前感谢您的帮助！我想做的是：

**客户端：**

* * *

```
printf("Sporočilo: ");

getline(cin, line);

if(line == "exit") break;

printf("ID odjemalca: ");

cin >> id;

message::Message sporocilo;

sporocilo.set_bodytext(line);

sporocilo.set_uniqueid(id);

//... some usefull code for serializing data and send it over socket

send(sClient, Message, sizeof(Message), 0); 
```

**服务器端：**

* * *

```
WSARecv(Socket, &(DataBuf), 1, &RecvBytes, &Flags, NULL, NULL);

//... some usefull code for deserializing data and getting out bodytext and uniqueid

cout << sporocilo.bodytext();

cout << sporocilo.uniqueid(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T22:19:26.610

最简单的序列化方法很简单：

```
string buffer;
sporocilo.AppendToString(&buffer);
send(sock, buffer.c_str(), buffer.size(), 0); 
```

如果没有 WSARecv 之前和之后没有包含的代码，很难说您是否在接收端做错了什么。

# linq - LINQ 语句无法编译

> ID：12239372
> 
> 赞同：0
> 
> 时间：2012-09-02T20:09:11.050
> 
> 标签：linq, entity-framework

此语句不会编译：

```
query = from g in context.GridViews 
   join f in context.GridViewFavorites on g.ID equals f.GridViewID into gf
   where g.GridTypeID == id && ( g.IsShared == true || g.RepID == me.clsRep.OID) 
   && f.RepID == me.clsRep.OID
   select g; 
```

编译器错误是这样的（它在 where 子句的最后一部分下划线：

> 当前上下文中不存在名称“f”

它的逻辑 SQL 对应物是：

```
declare @RepID int
declare @GridTypeID int
select @RepID=15, @GridTypeID=5

select g.*,f.*
from
   GridViews g
   left outer join GridViewFavorites f on f.GridViewID = g.ID
where
   g.GridTypeID = @GridTypeID and (g.IsShared = 1 or g.RepID == @RepID) 
   and f.RepID == @RepID 
```

**注意：**根据@hdv 的好消息，SQL 示例实际上应该是：

```
select g.*,f.*
from
   GridView g
   left outer join GridViewFavorite f on f.GridViewID = g.ID and f.RepID = @RepID
where
   g.GridTypeID = @GridTypeID and (g.IsShared = 1 or g.RepID = @RepID) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T20:11:23.780

它是您加入的“加入”部分——一旦你加入“加入”一个组，加入变量（`f`在这种情况下）就超出了范围——你必须`gf`改用它。或者，鉴于您实际上根本没有在查询中*使用* `gf`，也许您应该完全摆脱该`into gf`部分，使其成为普通连接而不是组连接。

但是，这不会给你一个左外连接。如果你想要一个左外连接，你可能想要：

```
query = from g in context.GridViews 
   join f in context.GridViewFavorites on g.ID equals f.GridViewID into gf
   from f2 in gf.DefaultIfEmpty()
   where g.GridTypeID == id && (g.IsShared == true || g.RepID == me.clsRep.OID) 
   && (f2 == null || f2.RepID == me.clsRep.OID)
   select g; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T20:11:26.153

LINQ 的左连接模式如下所示：

```
join f in context.GridViewFavorites on g.ID equals f.GridViewID into gf
from f in gf.DefaultIfEmpty() //missing 
```

更多信息可在 Stack Overflow 和 Google 上找到。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T20:11:44.770

该`where`子句作用于连接的结果，因此`f`变量不在范围内。

# zend-framework - Zend 框架中的确认对话框

> ID：12239374
> 
> 赞同：1
> 
> 时间：2012-09-02T20:09:33.157
> 
> 标签：zend-framework, dialog, confirmation

我正在使用理论存储库类构建 Zend 应用程序来更新、删除和插入数据到数据库。这些存储库是从控制器操作中调用的，它们完全按照它们应该做的事情做。但是，我想在应用程序中添加一些确认对话框，例如，如果用户想要编辑或删除一个项目，则必须首先打开一个确认编辑或删除对话框，数据将被编辑或删除，具体取决于用户选择什么。这是用户单击 zend 表单提交按钮后更新员工详细信息的一些操作代码示例。

```
public function updatestaffAction()
{        
    if ($this->getRequest()->isPost()) {
        if ($form->isValid($this->getRequest()->getPost())) {
            $values = $form->getValues();
            $user = $this->entityManager->find('\PTS\Entity\Staff', $values['staff_number']);
            $staffValues = array('staff_number' =>  $values['staff_number'],
                                 'title'        =>  $values['title'],
                                 'first_name'   =>  $values['first_name'],
                                 'last_name'    =>  $values['last_name'],
                                 'telephone'    =>  $values['telephone'],
                                 'cellphone'    =>  $values['cellphone'],
                                 'fax'          =>  $values['fax'],
                                 'email'        =>  $values['email'],
                                 'job_title'    =>  $values['job_title']);

            $this->staffRepository->saveStaff($staffValues);
            $this->entityManager->flush();
        }
    } 
```

员工存储库 saveStaff 方法只是创建一个新的员工对象并在员工不存在时保持该对象，或者如果它是现有员工则合并新数据，就像上面更新代码的情况一样。

所以我的问题是，如何更改操作以仅在用户单击确认对话框中的“是”按钮后才保存数据。顺便说一句，对话框可以是 JQuery 或 Dojo 对话框。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T12:47:27.667

创建表单的提交按钮时，设置js代码：

```
$submit = new Zend_Form_Element_Submit('delete');

$submit->setAttrib(
'onclick', 
'if (confirm("Are you sure?")) { document.form.submit(); } return false;'
); 
```

或者，如果您想在链接上设置对话框（如果您没有提交表单）：

```
onclick="if (confirm('Are you sure?')) { document.location = this.href; } return false;" 
```

显示对话框的代码：

```
$(function() {
    $( "#dialog:ui-dialog" ).dialog( "destroy" );

    $( "#dialog-confirm" ).dialog({
        resizable: false,
        height:140,
        modal: true,
        buttons: {
            "Are you sure": function() {
                                    // PUT your code for OK button, for eg.
                                    document.form.submit();
                $( this ).dialog( "close" );
            },
            Cancel: function() {
                $( this ).dialog( "close" );
            }
        }
    });
});` 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-31T14:22:26.863

Thx，我这样使用第二个选项：

```
<a href="<?=$this->url('skill', array('action'=>'delete', 'id' => $skill->getId()))?>" onclick="if (confirm('Are you sure?')) { document.location = this.href; } return false;">Delete</a> 
```

它的工作:)

# javascript - 无法调用 JSLint！jslint.vim 无法在 Windows 7 (x64) 中运行

> ID：12239376
> 
> 赞同：1
> 
> 时间：2012-09-02T20:09:44.607
> 
> 标签：javascript, vim, jslint

我在 Ubuntu 12.04 上使用[hallettj / jslint.vim](https://github.com/hallettj/jslint.vim)，一切正常。但在 Windows 7（x64）上，它显示错误：

> 处理函数`<SNR>`42_JSLint 时检测到错误：
> 第 47 行：
> 文件名、目录名或卷标语法不正确 ^@
> 
> 处理函数`<SNR>`42_JSLint 时检测到错误：
> 第 48 行：
> 无法调用 JSLint！

我尝试按以下方式解决问题，但不起作用：

*   重命名然后添加`jslint.vim/bim/jslint`到`jslint.exe``PATH`
*   修改**jslint.vim**文件：

    > " 让 s:install_dir = expand(":p:h")
    > 
    > if has("win32")
    > let s:install_dir = '"' .expand("C:\Users\Administrator.vim\bundle\jslint.vim\ftplugin\javascript"). '"'
    > else
    > let s:install_dir = expand (":p:h")
    > endif

*   安装 node.js, npm`npm install jslint -g`用于安装 jslint om cmd.exe

* * *

顺便说一句：我采用[Vindle](https://github.com/gmarik/vundle)来管理我的插件。这是我的[**_vimrc**](https://gist.github.com/3604048)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T20:48:42.840

我已经解决了这个问题。我认为诀窍是运行时语言，即使不使用**_vimrc**`language en`文件中的设置。

 **解决方案是：

1.  完全卸载 gvim。
2.  自定义安装 gvim，不要勾选 **Native Language Support**选项。 ![**母语支持**选项](../Images/f08585277c454d8a33cdb9fab0ab4c02.png)

3.  所以一切都是对的！**

# objective-c - 理解 Objective-C 事件循环

> ID：12239381
> 
> 赞同：0
> 
> 时间：2012-09-02T20:10:01.157
> 
> 标签：objective-c, nsrunloop, event-loop

**如何记录在 Objective-C 事件循环的单次迭代中发送的每条消息？**

我想进一步了解 Objective-C 运行时，并认为这将是一个好的开始。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T20:50:19.907

这些函数将根据进程的 PID 将所有消息记录到 /tmp 中的文件中。在模拟器上很好，但在 iDevice 上不行。

```
// Start logging all messages
instrumentObjcMessageSends(YES);

// Stop logging all messages
instrumentObjcMessageSends(NO); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T20:24:57.560

[`CFRunLoopObserver`](http://developer.apple.com/library/mac/#documentation/CoreFoundation/Reference/CFRunLoopObserverRef/Reference/reference.html%23//apple_ref/doc/uid/20001442)opaque 类型应该完全符合您的要求。这是

> 在运行的运行循环中的不同点接收回调的一般方法。

使用[其创建函数](http://developer.apple.com/library/mac/documentation/CoreFoundation/Reference/CFRunLoopObserverRef/Reference/reference.html#//apple_ref/doc/uid/20001442-CH201-F17726)`activity`的参数来指定您希望何时为观察者提供服务。对于您的情况，这可能是or 。[`kCFRunLoopEntry`](http://developer.apple.com/library/mac/documentation/CoreFoundation/Reference/CFRunLoopObserverRef/Reference/reference.html#//apple_ref/doc/uid/20001442-CH3g-C017571)`kCFRunLoopExit`

您可以`CFRunLoopRef`从当前`NSRunLoop`的`[[NSRunLoop currentRunLoop] getCFRunLoop]`, 或使用[`CFRunLoopGetCurrent()`](http://developer.apple.com/library/mac/documentation/CoreFoundation/Reference/CFRunLoopRef/Reference/reference.html#//apple_ref/doc/uid/20001441-CH201-SW1).

# php - 河豚和地穴成功的例子？

> ID：12239386
> 
> 赞同：0
> 
> 时间：2012-09-02T20:10:27.203
> 
> 标签：php, encryption, blowfish

我正在阅读有关保护密码的内容，并希望获得有关我的代码是否正确的反馈。我正在尝试使用河豚并`crypt()`一起防止任何人解密密码。另外，我有一个问题。当我存储密码时，我假设我还必须存储变量`$string`，以便在用户登录时再次使用它来验证用户，对吗？

```
function unique_md5() {
  mt_srand(microtime(true)*100000 + memory_get_usage(true));
  return md5(uniqid(mt_rand(), true));
}

//unique_md5 returns a random 16 character string

$string = '$2a$07$' . unique_md5();

$password = 'password';

$password = trim($password);

$protected_password = crypt($password, $string); 

//then store the variables $string and $protected_password into the database 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T20:16:54.017

Blowfish 需要一个 22 个字符的字符串作为它的盐（不包括类型和成本参数）。MD5 返回一个**32 个**字符的字符串，它不被`crypt_blowfish`. 使用适当的盐。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T20:17:34.203

不，您不需要将盐与加密密码一起存储，因为加密的密码会返回给您，并且盐已经预先添加。当您验证明文密码是否与加密密码匹配时，您只需检查是否`$crypted_password == crypt($plaintext_password, $crypted_password)`.

# c - 在多线程应用程序中暂停执行其他功能

> ID：12239395
> 
> 赞同：0
> 
> 时间：2012-09-02T20:11:18.217
> 
> 标签：c, pthreads, fifo, thread-synchronization

我在 C 中实现 FIFO。一个线程正在写入 FIFO，另一个正在读取它。

```
#define BUFFER_LENGTH   1000
struct Frame
{
    char data[1024];
    unsigned int data_len;
    struct Frame* frame;
};

struct Frame * get_from_fifo ()
{
    if (!fifo_length)
    {
        first = last = NULL;
        return NULL;
    }
    struct Frame* frame = first;
    first = first->frame;
    fifo_length--;
    return frame;
}

int add_to_fifo (const char* data, unsigned int frame_size)
{
    if (fifo_length >= BUFFER_LENGTH)
    {
        ast_log(LOG_ERROR, "Buffer full\n");
        return SURESH_ERROR;
    }

    struct Frame* frame = malloc(sizeof (struct Frame));
    frame->data_len = frame_size;
    memcpy(frame->data, data, frame_size);

    if (last)
    {
        last->frame = frame;
        last = frame;
    }

    if (!first)
    {
        first = last = frame;
    }
    fifo_length++;
    return SURESH_SUCCESS;
} 
```

如何防止函数 *add_to_fifo* 和 *get_from_fifo* 被不同的线程同时调用。即 *get_from_fifo* 只应在其他线程未执行 *add_to_fifo* 时调用，反之亦然。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T20:40:47.713

在实现 FIFO 堆栈时，**唯一**真正并发的操作是更改堆栈大小 ( `fifo_length`)。
您正在将条目添加到堆栈的尾部并从堆栈的头部删除条目，因此这两个操作永远不会相互干扰。因此，您需要担心的唯一部分是更改堆栈`fifo_length`大小（`add_to_fifo()``get_from_fifo()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T20:23:49.183

您需要使用互斥（互斥）变量。pthread 库拥有您需要的一切。这是开始查看可用功能的好地方：

[http://pubs.opengroup.org/onlinepubs/009695399/basedefs/pthread.h.html](http://pubs.opengroup.org/onlinepubs/009695399/basedefs/pthread.h.html)

您需要初始化每个线程都可以访问的互斥变量：http: [//pubs.opengroup.org/onlinepubs/009695399/functions/pthread_mutex_init.html](http://pubs.opengroup.org/onlinepubs/009695399/functions/pthread_mutex_init.html)

然后你的线程需要在需要访问共享内存时锁定它，然后在使用共享内存完成后解锁它：http: [//pubs.opengroup.org/onlinepubs/009695399/functions/pthread_mutex_lock.html](http://pubs.opengroup.org/onlinepubs/009695399/functions/pthread_mutex_lock.html)

这是一个简单的例子： http: [//publib.boulder.ibm.com/infocenter/iseries/v5r3/index.jsp ?topic=%2Frzahw%2Frzahwe18rx.htm](http://publib.boulder.ibm.com/infocenter/iseries/v5r3/index.jsp?topic=%2Frzahw%2Frzahwe18rx.htm)

祝你好运！

# ios - 从 Web 下载图像并使用 Core Data 将其缓存

> ID：12239396
> 
> 赞同：0
> 
> 时间：2012-09-02T20:11:21.697
> 
> 标签：ios, core-data, uiimageview

想象一下，您使用通过 API 提供图像的 Web 服务。每个图像都有一个 UID，并且您有一个核心数据实体*Image*具有属性*uid* (int) 和*image* (transformable)。

现在，您的应用程序库需要显示许多图像（UID 是已知的）。您不知道之前已下载和存储了哪些图像。如何在后台延迟下载带有核心数据的图像，以便视图在加载过程中显示 UIActivityIndi​​cator 并在图像存储在本地时自动显示图像（例如通过使用*NSFetchedResultsControllerDelegate*协议）？

为此目的子类化 UIImageView 有用吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T20:49:38.237

1.  是的，您可以为此使用 Core Data，但请注意，当您使用 Core Data 存储图像时，性能会受到影响。如果您正在处理小（例如缩略图）图像，则可以忽略不计，但是对于非常大的图像，可以观察到性能损失。对于大图像，我会将图像存储在`Documents`文件夹（或者，更好的是子文件夹）中，并使用 Core Data 来跟踪已下载的图像、文件名等。但如果图像较小，则保持一切正确Core Data 中的内容更干净。

2.  我可能不想为此使用子类`UIImageView`，因为您可能希望将表示层（图像视图）与图像缓存分离。此外，对于复杂的用户界面，`UIImageView`当用户滚动浏览大量图像时，对象可能会被丢弃或重用，因此您可能不希望在`UIImageView`缓存逻辑和缓存逻辑之间建立硬链接。此外，根据您的用户界面，有时图像可以指定比 UIImageView 更广泛的内容（例如，如果您使用的是 tableview，您可能希望在下载图像时根据图像调整单元格高度）。UI 可能执行的操作的细节取决于图像的使用位置（UITableView、显示图像网格的 UIScrollView 等）。

所以，底线，对于简单的用户界面，也许你可以继承 a`UIImageView`但我通常建议有一些自定义图像缓存对象，使用一些委托协议进行延迟加载，以便在图像加载完成时告诉 UI。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T20:51:54.277

我不会使用 Core Data 来存储图像，但我会将它们存储在磁盘上。我试图在文档中找到 Apple 自己警告不要在 Core Data 中存储大于 100k 左右的图像，因为你会遇到性能问题。

但是，我发现[这篇文章讨论了](http://blog.hawkimedia.com/2012/03/core-data-image-caching/)可能有用的 Core Data Image Caching。

此外，这是另一个[Stack Overflow 帖子](https://stackoverflow.com/questions/2573072/coredata-store-images-to-db-or-not/2573113#2573113)，其中有一个很好的答案，它告诉您何时将图像存储在数据库中以及何时仅使用对磁盘存储的引用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T08:41:19.020

If you don't absolutely need Core Data, then may I recommend using MWPhotoBrowser?

[https://github.com/mwaterfall/MWPhotoBrowser](https://github.com/mwaterfall/MWPhotoBrowser)

It essential generates a gallery view controller for you which you can push onto your navigation controller. The gallery view controller has scrollable images with pinch zoom, pan, everything, even emailing the photo to someone.

It also does the lazy loading of the image with the activity indicator.

Short answer: everything you wanted to do without reinventing the wheel.

# c++ - 如何有效地创建 allegro 5 标题菜单？

> ID：12239408
> 
> 赞同：3
> 
> 时间：2012-09-02T20:12:49.697
> 
> 标签：c++, codeblocks, allegro, allegro5

我正在开发我在 Allegro 5 中的第一款游戏，我已经得到了标题菜单渲染，但是我想在菜单中添加可点击的文本。我将如何做到这一点，当您将鼠标悬停在文本上时，您可以单击它？我在想有一个检查像素的 for 语句对性能非常不利，这就是我到目前为止所拥有的：

```
#include <allegro5\allegro.h>
#include <allegro5\allegro_image.h>
#include <allegro5\allegro_primitives.h>

const int width = 1280;
const int height = 720;

int main(void)
{
    al_init();

    al_init_primitives_addon();
    al_init_image_addon();

    ALLEGRO_DISPLAY *display = al_create_display(width, height);
    ALLEGRO_BITMAP *title = al_load_bitmap("titlemenu.bmp");

    al_clear_to_color(al_map_rgb(0, 0, 0));
    al_draw_bitmap(title, 0, 0, 0);
    al_flip_display();
    al_rest(3.0);
    al_destroy_display(display);
    return 0;
} 
```

我在 Windows XP SP3 上使用代码块

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-03T06:28:05.757

要“正确”地做到这一点，您需要使用某种 GUI 库。但是您可以通过硬编码某些矩形的坐标轻松地创建屏幕的可点击部分。

首先，您需要设置事件处理：

```
ALLEGRO_EVENT_QUEUE *queue;
queue = al_create_event_queue();
al_install_keyboard();
al_register_event_source(queue, al_get_keyboard_event_source()); 
```

无需深入了解事件处理的细节（它本身就是一个完整的主题），以下是相关的部分：

```
int selection = 0;

while (!selection)
{
  ALLEGRO_EVENT event;
  al_wait_for_event(queue, &event);
  if (event.type == ALLEGRO_EVENT_KEY_UP)
  {
    if (event.keyboard.keycode == ALLEGRO_KEY_ESCAPE)
      selection = MYGAME_QUIT;
  }
  else if (event.type == ALLEGRO_EVENT_MOUSE_BUTTON_UP)
  {
    if (event.mouse.x >= MYGAME_MENU_X1 && event.mouse.x < MYGAME_MENU_X2 &&
        event.mouse.y >= MYGAME_MENU_Y1 && event.mouse.y < MYGAME_MENU_Y2)
    {
      selection = MYGAME_OPTION1;          
    }
  }
} 
```

有*很多*方法可以改进这个例子……这只是为了让你开始。

您应该仔细阅读有关事件处理的文档并检查捆绑的示例并查看[wiki](http://wiki.allegro.cc)以获取更多信息。

PS：使用文件路径时使用正斜杠，因为它们是跨平台的：

```
#include <allegro5/allegro.h> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-16T08:27:52.240

以上不属实；您可以将键盘添加到游戏中，然后您有 2 个用于碰撞检测、像素完美和边界框的选项，这两个选项都包含在 allegro 5 wiki 中。此处创建最佳菜单 IMO 的打勾是为菜单创建循环和计时器，然后单独列出键盘、鼠标和计时器事件。接下来做一些 if 语句，以便鼠标或键盘事件仅在您实际单击它时触发，这是必需的，因此您可以使用鼠标和键盘滚动菜单，或者您可以这样做，以便鼠标不会影响屏幕，直到之后你点击，但前者看起来更好，至少 IMO。

# matlab - MatLab - 求矩阵逆的算法

> ID：12239409
> 
> 赞同：2
> 
> 时间：2012-09-02T20:12:50.977
> 
> 标签：matlab, matrix-inverse

我正在尝试在 MatLab 中编写一个算法，该算法将下三角矩阵作为其输入。输出应该是这个矩阵的逆矩阵（也应该是下三角形）。我几乎设法解决了这个问题，但我算法的一部分仍然让我摸不着头脑。到目前为止，我有：

```
function AI = inverse(A)
n = length(A);
I = eye(n);
AI = zeros(n);
for k = 1:n
    AI(k,k) = (I(k,k) - A(k,1:(k-1))*AI(1:(k-1),k))/A(k,k);
    for i = k+1:n
        AI(i,k) = (I(i,k) - (??????????????))/A(i,i);
    end
end 
```

我用问号标记了我不确定的部分。我试图通过在纸上写出过程来找到这部分代码的模式，但我似乎无法找到解决这部分的正确方法。

如果有人可以帮助我，我将不胜感激！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T01:05:42.760

这是我通过使用行变换获得下三角矩阵的逆的代码：

```
function AI = inverse(A)
    len = length(A);
    I  = eye(len);
    M  = [A I];
    for row = 1:len
        M(row,:) = M(row,:)/M(row,row);
        for idx = 1:row-1
            M(row,:) = M(row,:) - M(idx,:)*M(row,idx);
        end
    end
    AI = M(:,len+1:end);
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T20:55:30.427

[您可以在Octave 的源代码](http://hg.savannah.gnu.org/hgweb/octave/file/535bb601e7db/libinterp/corefcn/inv.cc)中看到它是如何完成的。根据矩阵的类别，这似乎在不同的地方实现。对于浮点型对角矩阵，它打开`liboctave/array/fDiagMatrix.cc`，对于复杂对角矩阵，它打开`liboctave/array/CDiagMatrix.cc`，等等......

免费（如在自由中）软件的优点之一是您可以自由地研究事物是如何实现的；）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T21:32:56.093

感谢所有的投入！考虑到输入是一个下三角矩阵，我今天实际上能够找到一个非常好的和简单的方法来解决这个问题：

```
function AI = inverse(A)
n = length(A);
I = eye(n);
AI = zeros(n);
for k = 1:n
    for i = 1:n
        AI(k,i) = (I(k,i) - A(k,1:(k-1))*AI(1:(k-1),i))/A(k,k);
    end
end 
```

# css - CSS：图像大小仅为 IE 8 中宽度的 5%

> ID：12239414
> 
> 赞同：0
> 
> 时间：2012-09-02T20:14:24.813
> 
> 标签：css, internet-explorer-8

我刚刚发现我在 IE 8 中的文章缩略图仅显示为细条纹 - 正如您在图片中看到的那样：![IE8](../Images/927ec99551ac928cd88b4f57c02d9301.png)

网络：http: [//jdem.cz/vzcy9](http://jdem.cz/vzcy9)

此行为在任何其他浏览器中都不存在 - 即 FF 14、Opera 11、Chrome X、IE 7、IE 9 都可以。

您知道是什么原因导致 IE8 出现这种情况吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T20:19:48.020

似乎`max-wdth:99.35%`规则正在这样做。尝试将 a 添加`width:auto`到设置小数最大宽度的相同规则中。

换句话说，改变：

```
#masthead img, #featured-content img, #recent-content img, .entry-content img, .entry-thumb img, .comment-content img, .widget img {
    background: #fff;
    border: 1px solid #bbb;
    max-width: 99.35%;
/* Fluid images for posts, comments, and widgets */
    padding: 1px;
} 
```

到

```
#masthead img, #featured-content img, #recent-content img, .entry-content img, .entry-thumb img, .comment-content img, .widget img {
    background: #fff;
    border: 1px solid #bbb;
    max-width: 99.35%;
    width:auto;
/* Fluid images for posts, comments, and widgets */
    padding: 1px;
} 
```

# c++ - 为什么将 std::string 写入 cout 会导致未知运算符 << 错误？

> ID：12239415
> 
> 赞同：14
> 
> 时间：2012-09-02T20:14:29.197
> 
> 标签：c++, cout

当我尝试从我的一种方法输出返回值时出现错误：

```
Error: No operator "<<" matches these operands. Operand types are: std::ostream << std::string 
```

主文件

```
#include <iostream>
using namespace std;

#include "Book.h"

int main()
{
    book.setTitle("Advanced C++ Programming");
    book.setAuthorName("Linda", "Smith");
    book.setPublisher("Microsoft Press", "One Microsoft Way", "Redmond");
    book.setPrice(49.99);

    cout << book.getBookInfo(); // <-= this won't compile because of the error above.

    int i;
    cin >> i;

    return 0;
}; 
```

应该返回字符串的方法：

```
string Book::getBookInfo()
{
    stringstream ss;
    ss << title << endl << convertDoubleToString(price) << endl;

    return ss.str();
} 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-09-02T20:17:14.427

`#include <string>`不见了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T20:17:36.180

代码是如何得到的定义的`string`？标头`<string>`还声明了流插入器。

# c# - 使用 javascript 将 2 个输入的日期加在一起？

> ID：12239418
> 
> 赞同：0
> 
> 时间：2012-09-02T20:14:39.133
> 
> 标签：c#, javascript, asp.net, validation, obout

我有两个使用 obout 控件的日期，当输入两个日期而不是让用户输入总天数字段文本框时，我希望有一段 javascript 可以通过查看开始自动计算总数和输入完成日期。带有显示计算的总天数值的标签。到目前为止，它没有在我的标签中生成任何内容，但它运行正常，所以我猜我离我不远了。

这是我的 javascript

```
 var startDate = new Date(document.getElementByName('txtstartdate').Value);
        var endDate = new Date(document.getElementByName('TxtFinish').Value);

        var days = 24 * 60 * 60 * 1000; 
        var distance = (endDate - startDate) / days;

        var lbltotal = $get('<%= lbltotal %>');
        var lbltotal = lbltotal.innerText; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T20:23:16.583

看这个：[JavaScript中的日期减法](https://stackoverflow.com/questions/9495043/date-subtraction-in-javascript)

看来您可以通过以下方式完成此操作：

```
var startDate = new Date(document.getElementByName('Calendar1').Value);
var endDate = new Date(document.getElementByName('Calendar2').Value);

var days = 24 * 60 * 60 * 1000; 
var distance = (endDate - startDate) / days; 
```

由于您将在毫秒内得到答案，因此请使用变量 days ( `24hrs x 60 minutes x 60 seconds x 60 milliseconds`) 来确定您有多少个 24 小时时段。

编辑要将值放入 ASP 标签中，请在此处检查：[为什么 javascript 无法获取 asp:Label innerText？](https://stackoverflow.com/questions/650630/why-is-javascript-unable-to-get-asplabel-innertext)

# php - 尝试在 Preg_Match 中查找正斜杠

> ID：12239424
> 
> 赞同：5
> 
> 时间：2012-09-02T20:16:23.513
> 
> 标签：php, preg-match

我一直在寻找几个小时试图找到解决方案。我试图确定 REQUEST URI 是否合法并从那里分解。

`$samplerequesturi = "/variable/12345678910";`

为了确定它是否合法，第一部分`variable`只有字母并且长度可变。第二部分是数字，总共应该有 11 个。我的问题是转义正斜杠，以便在 uri 中匹配。我试过了：

```
preg_match("/^[\/]{1}[a-z][\/]{1}[0-9]{11}+$/", $samplerequesturi)
preg_match("/^[\\/]{1}[a-z][\\/]{1}[0-9]{11}+$/", $samplerequesturi)
preg_match("/^#/#{1}[a-z]#/#{1}[0-9]{11}+$/", $samplerequesturi)
preg_match("/^|/|{1}[a-z]|/|{1}[0-9]{11}+$/", $samplerequesturi) 
```

还有一些我现在不记得了。

该请求通常会出错：

```
preg_match(): Unknown modifier '|' 
preg_match(): Unknown modifier '#'
preg_match(): Unknown modifier '[' 
```

编辑：我想我应该声明 REQUEST URI 是已知的。我试图证明整个字符串以确保它不是伪造的字符串，即确保第一组只有小写字母，第二组只有 11 个数字。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-02T20:41:11.863

`/`不是唯一可以用作分隔符的东西。事实上，您几乎可以使用任何非字母数字字符。我个人喜欢使用`()`它，因为它提醒我结果数组的第一项是整个匹配项，并且它也不需要在模式中转义。

```
preg_match("(^/([a-z]+)/(\d+)$)i",$samplerequesturi,$out);
var_dump($out); 
```

那应该这样做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T20:25:16.130

如果您想使用正则表达式（在这种情况下我认为没有必要，只需拆分“/”就可以了：

```
$samplerequesturi = "/variable/12345678910";
preg_match("@^/([A-Za-z]+)/(\d+)$@", $samplerequesturi, $out);
echo $out[1];
echo $out[2]; 
```

应该让你去

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-02T20:28:24.530

您的问题可能是您使用`/`正斜杠作为正则表达式分隔符（在正则表达式的开头和结尾）。切换到使用正斜杠以外的字符，例如`#`井号或任何其他永远不需要出现在此特定表达式中的符号。然后，您根本不需要在表达式中转义正斜杠字符。

# html - 元素上的填充/边距/边框不会改变 DIV 高度

> ID：12239425
> 
> 赞同：0
> 
> 时间：2012-09-02T20:16:23.907
> 
> 标签：html, css

这是一个非常简单的 jsFiddle 来演示我的问题：http: [//jsfiddle.net/ryandlf/mSmUv/4/](http://jsfiddle.net/ryandlf/mSmUv/4/)

当一个元素具有顶部填充或边距并且它位于 div 内的第一行时，div 不尊重该填充或边距并将元素向下推。在大多数情况下，这不是问题，但例如，如果我有一个具有顶部边框的按钮并且填充边框顶部将被切断，因为 div 没有考虑填充值。

除了盲目地在每个容器 div 元素上设置边距或填充并希望我已经添加了足够的内容以解决可能受到影响的任何内部元素之外，是否有解决方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T20:21:45.157

您与类按钮的链接不是`block`元素，而是`inline`元素。通过添加来更改此默认行为，`dispaly: block`它将按预期工作。[jsfiddle](http://jsfiddle.net/mSmUv/5/)上提供了证明。

总而言之，问题不在于 div - 这是 css 的问题 - 内联元素忽略边距和填充，因为它们不能“保留空间”。

更新：要回答您的评论，[这是](http://jsfiddle.net/mSmUv/6/)您可能正在寻找的解决方案

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T20:27:28.460

按钮元素是`inline`. 要获得所需的行为，您可以设置`display:inline-block`. [在这里](http://jsfiddle.net/TRTue/)检查

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T21:34:13.897

尝试将以下内容添加到父 div：

溢出：隐藏

我希望它有帮助！

# plugins - 浏览器 - USB 接口。

> ID：12239427
> 
> 赞同：0
> 
> 时间：2012-09-02T20:16:48.083
> 
> 标签：plugins, browser, usb

我有一个 Garmin 800 GPS 设备。要从中上传数据，我只需将其插入 USB 端口并安装浏览器插件，我就可以从网页浏览设备。

是什么促成了这一点？在一个非常广泛的问题中，我应该去哪里/我应该寻找什么来了解更多关于它并可能自己实现它？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T20:23:28.203

浏览器不会连接到您的 USB 设备，也不会知道您正在使用的连接类型。我自己没有 Garmin 800 GPS，但我可以告诉您，从技术上（很可能）实际连接将由您的操作系统处理，您将在 USB 连接的 HDD 设备或（不太可能）Garmin 上浏览文件800 GPS 将运行您将通过浏览器访问的 http 服务器。

您用于访问 GPS 数据的 URL 的详细信息将为您提供访问类型的线索。

# matlab - 计算不同类别的协方差

> ID：12239438
> 
> 赞同：0
> 
> 时间：2012-09-02T20:17:37.507
> 
> 标签：matlab

我正在尝试计算一组给定观察值的均值和协方差矩阵。点列表是一个 3-d 数组，第一维表示类别编号，第二维表示观察编号，第三维表示坐标编号。虽然我已经能够计算出平均值，但协方差似乎存在一些问题（现在，我得到一个零矩阵）。如果有人能告诉我如何纠正它，我将不胜感激。

```
function [ meanEst, covEst, priorProbEst, classMem ] = estimateParams( trainingSet, classList )
%estimateParams estimate all parameters for each class

numRows = size(trainingSet, 1);
numClasses = max(classList.');
%pointList = zeros(numClasses, numRows, 2);
classMem = zeros(numClasses, 1);

for rowCtr = 1:numRows
    curClass = classList(rowCtr, 1);
    classMem(curClass) = classMem(curClass) + 1;
    pointList(curClass, classMem(curClass), 1) = trainingSet(rowCtr, 1);
    pointList(curClass, classMem(curClass), 2) = trainingSet(rowCtr, 2);
end

meanEst      = zeros(numClasses, 2);
covEst       = zeros(numClasses, 2, 2);
priorProbEst = zeros(numClasses, 1);
tot          = zeros(numClasses, 2);

for classCtr = 1:numClasses
    for pointCtr = 1:classMem(classCtr)
        tot(classCtr, 1) = tot(classCtr, 1) + pointList(classCtr, pointCtr, 1);
        tot(classCtr, 2) = tot(classCtr, 2) + pointList(classCtr, pointCtr, 2);
    end
    meanEst(classCtr, 1) = tot(classCtr, 1) / classMem(classCtr);
    meanEst(classCtr, 2) = tot(classCtr, 2) / classMem(classCtr);

    covEst(classCtr) = cov(pointList(classCtr));
    priorProbEst(classCtr) = classMem(classCtr) / numRows;
end
end 
```

感谢您花时间在这上面！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T23:22:38.977

我认为您通过引入 3d`pointList`矩阵使事情复杂化。如果感觉还可以，您可以这样做，但在某个地方存在协方差估计错误。

没有理由将您的数据保存在这样的结构中，因为您有每个观察的类 ID（即，您的每一行`trainingSet`都有来自相应行的标签`classList`）。因此，您始终可以使用逻辑索引`trainingSet`来检索用于估计`mean`和的数据`cov.`作为一项规则，`N x M = observation x variables`任何估计/分类任务的数据矩阵都是一种总是有帮助的约定，并且与许多 MATLAB 函数一致。

例如，下面我创建了一个随机训练集（NxM 矩阵）和标签索引（Nx1 列表中的 K=4 个类）并估计每个类的均值和协方差，分别将结果分配到 a`Kx2`和`2x2xK`矩阵中。

```
nPoints = 200; % training set points
nClass = 4; % number of unique classes

% random training set of size nPoints x 2 (coordinates)
classList = randi(nClass, nPoints, 1);
trainingSet = randn(nPoints, 2);

meanEst = zeros(nClass, 2);
covEst = zeros(2, 2, nClass);
for classID = 1:nClass
    meanEst(classID,:) = mean(trainingSet(classList==classID,:));
    covEst(:,:,classID) = cov(trainingSet(classList==classID,:));
end 
```

作为证明，运行您的代码将产生与`mean`上述示例相同的结果。

# delphi - 从单位中删除表格声明是否安全？

> ID：12239441
> 
> 赞同：10
> 
> 时间：2012-09-02T20:18:06.697
> 
> 标签：delphi, ide, delphi-xe2

设计时`TForm`，会在表单的单元中添加一行来声明表单对象...

```
var
  frmMyForm: TfrmMyForm; 
```

我不需要自动创建这个表单，我打算创建它的多个实例，并确保我不会犯错误使用这个声明的表单，我把它注释掉了......

```
//var
  //frmMyForm: TfrmMyForm; 
```

我想知道这样做是否安全？我没有看到任何问题，表单设计器仍然可以正常工作。但是，如果我完全忽略它，会不会有一些麻烦？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-02T20:35:47.043

这是使用表单继承时非常常见的场景。您通常不希望从继承链的中间实例化派生形式。

使用这些表单变量的唯一地方（可能除了您的代码）是 dpr 文件，并且仅在自动创建表单时才使用。

因此，删除声明没有问题。

# heroku - heroku postgres 上的缓存大小比宣传的要小？

> ID：12239442
> 
> 赞同：0
> 
> 时间：2012-09-02T20:18:18.783
> 
> 标签：heroku

我启动了一个 Heroku postgres 的 Zilla 实例，它被宣传为具有 17GB 的内存缓存。

当我运行显示全部时；我看到了：有效缓存大小 | 12240000kB

这是否意味着缓存是 12GB 而不是 17GB？还是我错过了什么？当我的数据集超过 12GB 点时，查询运行速度要慢得多。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T22:41:28.230

底层硬件的可用内存有限制（zilla 为 17G）。但是，此内存量不能完全用于“热数据集”缓存。正如您可能想象的那样，正常 postgres 操作的许多其他方面也需要内存。其中一些包括建立连接（产生后端）、需要连接的查询、需要排序的查询或计数、总和、最大值等聚合。此外，诸如 autovacuum 之类的进程也使用部分可用内存。

# vb.net - 为什么 VB.NET 对列表有这样的行为？

> ID：12239450
> 
> 赞同：0
> 
> 时间：2012-09-02T20:19:57.497
> 
> 标签：vb.net, list, nested-lists

这是一个关于列表列表的问题。

```
 Dim smallList As New List(Of Integer)
    Dim largeList As New List(Of List(Of Integer))

    smallList.Add(3)
    largeList.Add(smallList)
    smallList.Clear()
    smallList.Add(4)
    largeList.Add(smallList) 
```

在这段代码中，我希望 largeList 将列表 (3) 添加到自身，然后将列表 (4) 添加到自身。但是不是将数据存储在 smallList 中，而是存储一个引用 smallList，因此最终包含 ((4), (4))，这不是我想要的。

为什么会这样做，我该如何解决？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T20:23:57.603

当你有一个引用类型列表时，你实际上有一个引用列表。向列表中添加某些内容并不意味着复制了数据，它只是添加到列表中的引用。

要将单独的对象添加到列表中，您必须为每个项目创建一个新对象，并且由于列表本身就是引用类型，因此列表也是如此。

```
Dim smallList As List(Of Integer) ' just a reference at this time
Dim largeList As New List(Of List(Of Integer))

smallList = New List(Of Integer)() ' The first list
smallList.Add(3)
largeList.Add(smallList)
smallList = New List(Of Integer)() ' Here's another list
smallList.Add(4)
largeList.Add(smallList) 
```

# c# - 读取 DataGrid 上的当前行

> ID：12239455
> 
> 赞同：1
> 
> 时间：2012-09-02T20:20:07.447
> 
> 标签：c#, wpf, datagrid, wpf-controls

我用 WPF 4.0 和一个数据网格在 c# 中创建了一个小应用程序。我的数据网格绑定到一个对象。

我想在输入一行后进行一些测试，所以我使用 RowEditEnding 事件。

这是我的代码

```
private void dataGrid1_RowEditEnding(object sender, DataGridRowEditEndingEventArgs e)
{
    TableCompte Compte = e.Row.DataContext as TableCompte;

    if (Compte  != null)
    {
       // Verifs
    }
} 
```

我的问题是我的对象为空。

我的错误在哪里？

这是我的 XAML 声明：

```
<DataGrid AutoGenerateColumns="false" Name="dataGrid1" AreRowDetailsFrozen="false" Margin="31,227,28,82" RowEditEnding="dataGrid1_RowEditEnding">
    <DataGrid.Columns>
        <DataGridTextColumn Width="134" Header="Compte d'origine" Binding="{Binding Path=m_CompteOrigine, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
        <DataGridTextColumn Width="134" Header="Compte Taux 1" Binding="{Binding Path=m_CompteTaux1, Mode=TwoWay ,UpdateSourceTrigger=PropertyChanged}"  />
        <DataGridTextColumn Width="134" Header="Taux 1" Binding="{Binding Path=m_Taux1, Mode=TwoWay,UpdateSourceTrigger=PropertyChanged }"  />
        <DataGridTextColumn Width="134" Header="Compte Taux 2" Binding="{Binding Path=m_CompteTaux2, Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" />
        <DataGridTextColumn Width="134" Header="Taux 2" Binding="{Binding Path=m_Taux2, Mode=TwoWay,UpdateSourceTrigger=PropertyChanged }"  />
        <DataGridTextColumn Width="134" Header="Compte Taux 3" Binding="{Binding Path=m_CompteTaux3, Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" />
        <DataGridTextColumn Width="134" Header="Taux 3" Binding="{Binding Path=m_Taux3, Mode=TwoWay,UpdateSourceTrigger=PropertyChanged }"  />
    </DataGrid.Columns>
</DataGrid> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T20:43:32.607

这里的问题是`DataContext`只有在 item 是从生成时才会设置`ItemsSource`（应该在`ItemsSource`上绑定`DataGrid`）。
而不是`e.Row.DataContext`使用`e.Row.Item`，这将解决您的问题。

* * *

***更新***

看起来问题出在演员阵容中。

```
TableCompte Compte = e.Row.DataContext as TableCompte; 
```

您应该知道要绑定到的类型`DataGrid`。如果你要绑定[`ObservableCollection<YourClass> FooObservable`](http://msdn.microsoft.com/en-us/library/ms748365.aspx)，`ItemsSource`那么`YourClass`应该有 m_CompteTaux1、m_CompteTaux2、m_CompteTaux3、m_CompteTaux4 等。然后铸造：

```
var rowDataItem = e.Row.DataContext as YourClass; 
```

# java - 免费/开源的 java 形状库？

> ID：12239456
> 
> 赞同：1
> 
> 时间：2012-09-02T20:20:30.697
> 
> 标签：java, graphics, shape

我搜索 Java 免费的开源形状库，

其中包含以下形状：三角形、圆形、方形、多边形等。

当然它应该是图形而不是文本（终端\ cmd）。

你知道好的吗？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-10T06:41:41.143

查看两个特别的（如果您还在寻找）MyroJAVA 程序——这个程序确实是为机器人设计的，但令人惊讶的是有一些非常好的图形库。[http://wiki.roboteducation.org/Myro_in_Java](http://wiki.roboteducation.org/Myro_in_Java)

还有威廉姆斯学院的这个图书馆：http: [//eventfuljava.cs.williams.edu/library.html](http://eventfuljava.cs.williams.edu/library.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T20:57:42.463

```
That contains shapes like: Triangle, circle, Square, Polygon and etc'. 
```

除了三角形，Java Graphics API 已经包含了所有这些，老实说，三角形实现起来并不难（毕竟它是一个有 3 个点的封闭多边形）

我会先通读[2D Graphics](http://docs.oracle.com/javase/tutorial/2d/index.html)，尤其是[Working with Geometry](http://docs.oracle.com/javase/tutorial/2d/geometry/index.html)

# java - 在不指定完整路径的情况下执行程序？

> ID：12239461
> 
> 赞同：0
> 
> 时间：2012-09-02T20:21:27.933
> 
> 标签：java, process, path

使用 Java 和 ProcessBuilder 时，有没有办法在不指定完整绝对路径 (C:\Windows\system32\diskpart.exe) 的情况下执行例如“diskpart”？特别是路径可能会发生变化，例如，将来可能是一个 64 位程序......有机会告诉 ProcessBuilder 考虑 PATH 变量吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T20:48:29.607

您能够实现此目的的唯一方法是`PATH`自己解析变量，`File.exist`用于确定程序是否存在于每个路径元素的末尾。

您可能还需要提供一些众所周知的路径位置，例如`%WINDIR%`

# c# - 在电子邮件中发送 HTML

> ID：12239477
> 
> 赞同：4
> 
> 时间：2012-09-02T20:24:12.693
> 
> 标签：c#, .net, html-email, embedding

我需要我的 .NET 桌面应用程序能够发送各种 HTML 邮件，允许用户创建自定义模板，包括图像和可能的 CSS 样式（如果他们从其他来源复制/粘贴 HTML）。

从我一直在阅读的内容来看，这并不是那么简单：

*   需要嵌入图像并将其链接替换为内容 ID
*   包含图片的 CSS 样式也需要修复
*   背景颜色/图像不起作用，最好将邮件包装在表格中并对其应用 CSS
*   SMTP 服务器可以将以点开头的行解释为“传输结束”，因此至少必须在所有此类行中添加一个空格
*   谁知道还有什么

我的问题是：

1.  我还有什么需要注意的吗？
2.  是否有一个图书馆已经这样做了，所以我不会重新发明？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T20:49:01.110

我能想到的一件事是，对于那些邮件客户端不能/不会接受 HTML 电子邮件（或者他们已将其关闭）的收件人使用[备用视图。](http://msdn.microsoft.com/en-us/library/system.net.mail.mailmessage.alternateviews.aspx)这样他们将获得纯文本版本，如果他们决定要查看它，您可以在其中包含指向网络上实时 html 版本的链接。

我还听说不包含纯文本版本会增加您被标记为垃圾邮件的可能性——这是因为许多邮件过滤器会比较邮件的纯文本和 html 版本；如果它们差异太大，那对您来说不是一个好兆头:-)

其他垃圾邮件指标包括图片多于文本的 html 消息，以及通常草率的 html - 损坏的 css、坏链接、缺少标签等 - 考虑在发送前使用某种标记验证器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T11:04:13.160

我找到了下面的 CodeProject 文章，它描述了如何将各种图像资源嵌入到邮件中：

*   [将带有图像的网页内容作为 HTML 邮件发送](http://www.codeproject.com/Articles/16873/Sending-the-contents-of-a-webpage-with-images-as-a)。

它有一些有用的示例，虽然它似乎不包含替代的纯文本视图，所以我将不得不添加它。

仍然很遗憾，没有人组建一个可以自动完成这些工作的库。

# java - HashMap 是一个合适的数据结构吗

> ID：12239487
> 
> 赞同：0
> 
> 时间：2012-09-02T20:25:35.860
> 
> 标签：java, data-structures, hashmap

我在 HashMap 中存储 3 种类型的对象。

```
HashMap<String, ArrayList<Car>>

['Lorry', [list of lorries]]
['Sport', [list of sport's cars]] 
```

HashMap 字符串键保存对象的类型（Car 的子类），第二个元素将具有以下属性的对象存储在数组中：ID、日期等。

我必须做的四件事主要是：

1.  当没有提供关于其类型的信息时，检查某个 ID 是否存在于 HashMap 中
2.  在给定类型的情况下打印特定 ID 的元素。
3.  打印特定类型的所有元素
4.  如果每个对象分配的某个属性具有布尔值，例如“true”，则打印集合中的所有元素（不同类型的）；

HashMap 是正确的结构吗？如果涉及到第一点，我觉得有问题。似乎我将不得不遍历整个集合，如果是这样的话，还有什么其他集合更适合这种要求？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T20:44:04.467

基本方法是合理的，但是由于您只想存储每个实例一次，因此对于映射条目值，a`Set`比 a 更好：`List`

```
Map<String, Set<Car>> typeCache = new HashMap<String, HashSet<Car>>(); 
```

的`contains()`方法`HashSet`确实非常快，因此查找您的地图中是否包含特定实例的值不会花费太多。

不过，使用*两个*映射可能会更好 - 每种类型的查找一次，所以也使用：

```
Map<String, Object> idCache = new HashMap<String, Object>(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T20:43:46.910

A`HashMap`是适合该工作的数据结构，但在您的情况下，您可能会考虑使用两个 HashMap：一个包含关系“汽车类型”->“该类型的汽车”，第二个用于关系“ID”-> '具有该 ID 的汽车'。

# admob - 如果模拟器不工作，如何在 java 应用程序上测试 libgdx admob？

> ID：12239488
> 
> 赞同：1
> 
> 时间：2012-09-02T20:25:47.127
> 
> 标签：admob, libgdx

我的模拟器不能同时工作我想在我的应用程序上测试我的“libgdx admob”代码。有没有办法在 libgdx 的桌面应用程序上对其进行测试？请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T20:05:22.907

不，没有办法在桌面版中测试 admob 代码。有些平台特定的东西在桌面版本上不可用。这包括 admob 视图和其他 Android 特定依赖项。我建议要么尝试让模拟器运行起来，要么找到某种方法在手机上进行测试。最好的可能是两者都做。

# java - “委托”如何帮助线程安全类？

> ID：12239491
> 
> 赞同：2
> 
> 时间：2012-09-02T20:25:53.447
> 
> 标签：java, multithreading, concurrency, thread-safety, composition

当我们谈论构建一个线程安全的类时，我并不太了解“委托”的概念。这是什么意思？该策略如何有效地创建一个线程安全的类？什么时候会失败？有人可以举个例子吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T20:41:02.173

关于使类线程安全的“委托”意味着该类包含某个其他类对象的引用，该类将线程安全操作卸载到该类对象。考虑 ，

```
class Delegator {  
    private final AtomicInteger counter = new AtomicInteger(0);

  public int getNextCounter(){
      return counter.incrementAndGet();
   }
 } 
```

在这里，`Delegator`该类将线程安全委托给了它的组件`counter`。显然，班级本可以自己承担`counter`操作的痛苦，但这将是重新发明轮子。

委托需要谨慎使用。如果存在涉及多个变量的状态操作，那么这些变量操作中的每一个单独线程安全是不够的，但是状态转换一起也应该是线程安全的。

# java - Mongodb 数据库 Schema 设计技巧

> ID：12239492
> 
> 赞同：0
> 
> 时间：2012-09-02T20:25:56.470
> 
> 标签：java, mongodb

> **可能重复：**
> [使用共享数据的 Mongodb 数据库模式设计](https://stackoverflow.com/questions/12239045/mongodb-database-schema-design-with-shared-data)

嗨，我是 mongodb 的新手。我正在使用 java。

我的关系表中有 4 个表租户、系统、授权。

像这样的东西。

```
Table            Fields

 Tenant           Tenant_ID(PK), Tenant_INFO
 System           System_ID(PK), System_Info
 Authorization    System_ID, Autho_Info.
 System_prop      System_ID, Prop_Info, Tenant_ID 
```

在 System_prop 表中，Tenant_ID 是指租户表 Tenant_ID (PK)，System_ID 是指系统表 System_ID。

在 Authorization 表中，System_ID 是指 System 表 System_ID

我正在将我的数据库从关系数据库切换到 mongodb。我需要做的第一件事是架构设计。

我需要做的查询是：

```
SELECT D.Prop_Info, D.System_ID, A.Tenant_Info From TENANT A ,System_prop D, SYSTEM B, Where D.System_ID = B.System_ID AND D.Tenant_ID = A.Tenant_ID

SELECT C.System_ID, C.auth_Info, B.System_ID FROM Authorization C, SYSTEM B WHERE C.System_ID = B.System_ID 
```

谁能帮助我如何将这些表设计为 mongodb 中的集合？

我需要嵌入 r 使用 dbref 吗？帮助我为此设计架构。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T23:00:56.530

您仍在考虑关系数据库。然而，MongoDB 是一个面向文档的数据库。

1.  通常不需要人工 ID 号，因为每个文档都会自动有一个 _id 字段，它是一个 GUID（保证全局唯一）。
2.  关系表不应该在 MongoDB 中使用。n 型关系是用数组字段代替的。因此，当 1 个系统有 N 个它使用的授权时，您的系统文档应该有一个“授权”字段，它是它拥有的授权的对象 ID 的数组。是的，这将严重违反关系数据库的规范化规则。但是这里没有关系数据库。在 MongoDB 中，用数组表示 N 关系是很实用的，因为数组对查询语言是透明的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T01:18:18.120

从您提供的模式信息来看，您在 Tenant 和 System 之间存在多对多关系（通过 JOIN 表 System_prop），在 System 和 Authorization 之间存在一对多关系。

在 MongoDB 中，这两种类型的关系都可以使用数组字段来实现。这是您可以设置系统集合的方式：

```
{
    System_Info: ...,

    Tenant: [ 
        { 
            Tenant_Id: ..., 
            Tenant_Info: ..., 
            Prop_Info: ...
        }, 
        { 
            Tenant_Id: ..., 
            Tenant_Info: ..., 
            Prop_Info: ...
        } ],

    Authorization: [ 
        {
            Auth_Id: ..., 
            Auth_Info: ...
        }, 
        {
            Auth_Id: ..., 
            Auth_Info: ...
        } ]
} 
```

但是，对于租户信息，您现在将获得非规范化的重复信息，即相同的租户文档出现在不同的系统文档中。确保一致性取决于您的应用程序。

至于您提到的查询：看起来缺少一些信息。对于第一个查询，您加入`Tenant_Id`但不从租户表中请求任何信息。第二个请求`Prop_Info`来自 Authorization 表，但该表没有`Prop_Info`. 应该是这样`A.Autho_Info`吗？因此，您可能需要仔细检查这些查询。

以下是一些关于 MongoDB 中模式设计的额外资源，值得一读：

[http://www.mongodb.org/display/DOCS/Schema+Design](http://www.mongodb.org/display/DOCS/Schema+Design)

[https://openshift.redhat.com/community/blogs/designing-mongodb-schemas-with-embedded-non-embedded-and-bucket-structures](https://openshift.redhat.com/community/blogs/designing-mongodb-schemas-with-embedded-non-embedded-and-bucket-structures)

最后，这取决于您的应用程序和最常见的查询您选择如何存储数据，上面的示例只是设置模式的一种方法。

# lua - 如何知道客户端是否在 Awesome WM 中被杀死

> ID：12239495
> 
> 赞同：3
> 
> 时间：2012-09-02T20:26:23.617
> 
> 标签：lua, awesome-wm

我正在编写一个模块，它具有带有过滤客户端列表的本地表。当表中的一个客户端被杀死时，所有操作都会引发“客户端无效”异常。

那么如何检查客户端是否被杀死？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T21:34:15.633

最好的办法是为`unmanage`每个客户添加一个事件信号，然后添加到您的列表中。然后，在信号函数中，您可以从表列表中删除客户端。它可能看起来像这样：

```
client.add_signal('unmanage', function(c)
    -- Remove c from your list
end) 
```

# macos - 在 OS X 上以编程方式禁用环境光传感器屏幕调光

> ID：12239496
> 
> 赞同：11
> 
> 时间：2012-09-02T20:26:30.417
> 
> 标签：macos, iokit

几天来我一直在内核代码仓库中挖掘，但我在任何地方都找不到。

我想禁用/启用/检测许多高端 Mac 笔记本电脑所具有的基于环境光传感器的屏幕调光状态。这是由显示控制面板中的“自动调整亮度”复选框激活的调光。

请注意，我**不是**在谈论导致屏幕在睡眠前急剧变暗的 halfdim 设置。我说的是在黑暗的房间里调暗屏幕并在明亮的房间里调亮屏幕的设置，这是不同的。

如果有人能指出我正确的方向，我会很高兴的。我假设它在 IOKit 的某个地方处理，可能是处理屏幕亮度的 IOGraphics，或者在 IOKit/pwr_mgt 的某个地方，但我就是找不到它。

谢谢

编辑：我知道你可以通过使用 AppleScript 解决系统偏好来做到这一点。我正在寻找真正的方法，如果它存在的话。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-09-28T17:27:42.427

试图在小牛队这样做对我来说是不成功的。经过一番研究，我发现您需要使用以下命令：

```
defaults write /Library/Preferences/com.apple.iokit.AmbientLightSensor "Automatic Display Enabled" -bool TRUE 
```

我相信指定完整路径是必要的，否则它将默认为用户的库/首选项，这是不正确的。由于工作方式，在终端中的该目录中也不起作用`defaults`。

这不会更新系统偏好设置 -> 显示中的复选框。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-01-28T22:44:39.873

这不是 API 本身，*但*有**很多**方法可以`launchd` *通过 API*进行控制。

`sudo launchctl stop com.apple.AmbientDisplayAgent`

`sudo launchctl remove com.apple.AmbientDisplayAgent`

***达达！***

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-04T11:29:47.993

`defaults`使用以下命令更改“自动调整亮度”设置：

```
defaults write com.apple.BezelServices dAuto -boolean false 
```

`defaults`还可以使用以下命令检索当前设置：

```
defaults read com.apple.BezelServices dAuto 
```

AppleScript 等价物：

```
do shell script "defaults write com.apple.BezelServices dAuto -boolean false" 
```

用于`true`启用和`false`禁用该功能。
您可能需要再次登录才能使更改生效。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-02-18T21:22:15.030

发布此内容可能会帮助像我这样已经禁用环境光感应但仍然发现他们的计算机在从睡眠中醒来时变暗的人。原来我还需要取消选中“使用电池供电时显示屏稍微变暗”的复选框

系统偏好设置 > 电池 > 使用电池供电时使显示屏略微变暗

见下图：

[![取消选中电池自动变暗](../Images/281d5abe639b94dd148d47aa15ff204d.png)](https://i.stack.imgur.com/lOs7H.png)

# scala - 特征实例抛出空指针

> ID：12239498
> 
> 赞同：4
> 
> 时间：2012-09-02T20:26:31.570
> 
> 标签：scala

为什么下面的代码会出现空指针异常？

```
object Test extends App{
    trait MyTrait[A]{ self =>
        val seq: Seq[A]
        val size = seq.size // null pointer here
    }

    val p = new MyTrait[Int]{
        val seq = Seq(1,2,3)
    }
} 
```

如果我将大小字段更改为惰性，那么没关系。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-02T20:30:40.893

字段按照它们混合的顺序进行初始化——所以首先发生特征中的所有事情，然后`val`分配给`Seq(1,2,3)`（因为你实际上是在混合匿名特征）。

正如您所发现的，`lazy val`这通常是摆脱这种混乱的一种方法：在`seq.size`您需要它之前，您实际上不会调用它，这是在您填充该`seq`字段之后。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-03T06:37:26.463

风格建议是避免 vals 的特性，有利于 defs 和惰性 vals，因为 init order 地雷。

对话示例： [https ://groups.google.com/forum/?fromgroups=#!topic/scala-user/nrOrjPOYmb0](https://groups.google.com/forum/?fromgroups=#!topic/scala-user/nrOrjPOYmb0)

# pdf - 使用 Trigger.io 和 jQuery Mobile 下载并显示 PDF

> ID：12239502
> 
> 赞同：1
> 
> 时间：2012-09-02T20:27:06.467
> 
> 标签：pdf, jquery-mobile, backbone.js, trigger.io

我们将开发一个移动应用程序（iOS 和 Android），它应该提供下载和存储几个用户选择的 PDF 文件，并在应用程序（iOS 和 WebView）或外部 PDF 查看器（Android）中查看它们。

我的问题是：Trigger.io 有可能吗？我在官方文档中没有找到任何与此相关的内容。我们可以对文件或子浏览器/标签模块做些什么吗？如果有，你有什么例子吗？

注意：我们将使用 Backbone.js 和 jQuery Mobile 作为附加库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T16:06:12.273

Android webview 不允许内联打开 PDF - 您可以通过打开例如[http://trigger.io/cross-platform-application-development-blog/wp-content/uploads/2012/05/trigger 来测试它。 io-whitepaper.pdf](http://trigger.io/cross-platform-application-development-blog/wp-content/uploads/2012/05/trigger.io-whitepaper.pdf)在您的股票浏览器中。

在 iOS 上，您可以使用：

```
forge.tools.getURL('my_file.pdf',
  function (file) {
    forge.tabs.open(file);
  }
); 
```

但这不适用于 Android（在 2.3、3 和 4.0 上测试）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T00:34:40.903

简短的回答 - 是的。

绝对可以完成下载、存储、然后显示/参考。查看 forge.file[文档](http://docs.trigger.io/en/v1.4/modules/file.html#modules-file)。

我还没有尝试过儿童浏览器功能。虽然标签模块可以工作，但我认为最好让设备（及其用户设置）决定如何显示/渲染 PDF。我之所以这么说，是因为我的设备（尤其是 Android 设备... 2.3 和 4.x）往往表现不同。无论哪种方式......设备的“后退按钮”总是让我回到我在 trigger.io 应用程序中停止的地方。

# java - 扫描仪无法读取文本文件

> ID：12239504
> 
> 赞同：1
> 
> 时间：2012-09-02T20:27:35.830
> 
> 标签：java

我有一堆 .txt 文件，我正在尝试阅读，但其中许多文件不会阅读。不会阅读的内容似乎以文本前的空行开头。例如，以下会引发 NoSuchElementException：

```
public static void main(String[] args) throws FileNotFoundException{
    Scanner input = new Scanner(new File("documentSets/med_doc_set/bmu409.shtml.txt"));
    System.out.println(input.next());
} 
```

正在读取的文本文件以空行开头，然后是一些文本。我也尝试过使用 input.skip("[\\s]*") 跳过任何前导空格，但它会引发相同的错误。有没有办法解决这个问题？

编辑：托管在谷歌文档上的[文件。](https://docs.google.com/open?id=0Bxz3DUa2_Z2mb0xCTVZQQU5iOHc)如果您下载以在文本编辑器中查看，您可以看到它以空行开头。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T08:07:17.417

在`Scanner`处理输入时，类型出奇地不一致。它吞下 I/O 异常——消费者应该[明确地测试这些](http://docs.oracle.com/javase/7/docs/api/java/util/Scanner.html#ioException%28%29)异常——所以它在通知读者错误方面是松懈的。但是在解码字符数据时类型是严格的 - 错误编码的文本或使用错误的编码将导致引发 an `IOException`，类型会迅速吞下。

此代码通过错误检查读取文本文件中的所有行：

```
 public static List<String> readAllLines(File file, Charset encoding)
      throws IOException {
    List<String> lines = new ArrayList<>();
    try (Scanner scanner = new Scanner(file, encoding.name())) {
      while (scanner.hasNextLine()) {
        lines.add(scanner.nextLine());
      }
      if (scanner.ioException() != null) {
        throw scanner.ioException();
      }
    }
    return lines;
  } 
```

此代码读取行并将解码器无法理解的代码点转换为问号：

```
 public static List<String> readAllLinesSloppy(File file, Charset encoding)
      throws IOException {
    List<String> lines = new ArrayList<>();
    try (InputStream in = new FileInputStream(file);
        Reader reader = new InputStreamReader(in, encoding);
        Scanner scanner = new Scanner(reader)) {
      while (scanner.hasNextLine()) {
        lines.add(scanner.nextLine());
      }
      if (scanner.ioException() != null) {
        throw scanner.ioException();
      }
    }
    return lines;
  } 
```

这两种方法都要求您明确提供[编码](http://docs.oracle.com/javase/7/docs/api/java/nio/charset/Charset.html)，而不是依赖通常不是 Unicode 的[默认编码](http://docs.oracle.com/javase/7/docs/api/java/nio/charset/Charset.html#defaultCharset%28%29)（另请参阅[标准常量](http://docs.oracle.com/javase/7/docs/api/java/nio/charset/StandardCharsets.html)。）

*代码是 Java 7 语法，未经测试。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T20:38:10.590

它以空行开头，您只打印代码中的第一行，将其更改为：

```
public static void main(String[] args) throws FileNotFoundException{
    Scanner input = new Scanner(new File("documentSets/med_doc_set/bmu409.shtml.txt"));
    while(input.hasNextLine()){
        System.out.println(input.nextLine());
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T20:39:27.810

扫描仪读取所有单词或数字，直到行尾。此时您需要调用 nextLine()。如果您想避免出现异常，您需要调用其中一个 hasNextXxxx() 方法来确定是否可以读取该类型。

# c++ - C ++ Fstream替换特定行？

> ID：12239505
> 
> 赞同：2
> 
> 时间：2012-09-02T20:27:36.293
> 
> 标签：c++, input, fstream, getline

好吧，我对如何做到这一点感到困惑。我设法到达了我想更换的线路，但我不知道如何更换它。

说一个名为 file.txt 的文件包含以下内容：

```
1
2
3
4
5 
```

我想替换第 3 行，使其显示为 4 而不是 3。我该怎么做？

```
#include <Windows.h>
#include <iostream>
#include <fstream>
#include <string>
using namespace std;

fstream file;
string line;

int main(){
file.open("file.txt");
for(int i=0;i<2;i++){
getline(file,line);
}
getline(file,line);
//how can i replace?
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-02T20:41:56.647

假设您以读/写模式打开了一个文件，您可以通过查找在读取和写入之间切换，包括查找到当前位置。但是请注意，写入的字符会覆盖现有字符，即不插入新字符。例如，这可能如下所示：

```
std::string line;
while (std::getline(file, line) && line != end) {
}
file. seekp(-std::ios::off_type(line.size()) - 1, std::ios_base::cur);
file << 'x'; 
```

即使您在正确的位置，也需要将流置于未绑定状态。试图在阅读和写作之间切换而不寻找会导致未定义的行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T20:51:33.090

通常的方法是从一个文件中读取，同时写入另一个文件。这样您就可以替换任何您想要的内容，而不必担心它是否与要替换的数据大小相同。

# html - 通过html将文本文件上传到服务器，然后在服务器上读取

> ID：12239509
> 
> 赞同：0
> 
> 时间：2012-09-02T20:28:00.043
> 
> 标签：html, file, jsp, upload

我已经可以上传文件，然后在服务器上读取它们，只是输入流开头的额外数据有问题。我在jsp中的代码：

```
 <%     
  DataInputStream   dis = new DataInputStream(request.getInputStream());
  BufferedReader br = new BufferedReader(new InputStreamReader(dis));
  String strLine;
  while ((strLine = br.readLine()) != null) {
  out.println (strLine+"");
  }
%> 
```

我一开始就得到了我想跳过的数据 -----------------------------41184676334 Content-Disposition: form-data ; 名称="数据"; filename="data.txt" Content-Type: text/plain 和这个结尾 -----------------------------41184676334 --

我会为任何文本文件制定一个通用的解决方案。

# java - 在 JPanel 中创建可滚动的 JTable - 使用 GridBagLayout 时不会显示表数据

> ID：12239510
> 
> 赞同：0
> 
> 时间：2012-09-02T20:28:14.483
> 
> 标签：java, swing, jtable, jscrollpane, layout-manager

我正在尝试使用一些任意值创建一个简单的可滚动 JTable，并将其放置在 JPanel 中。我遇到了一些奇怪的结果，其中 JTable 出现但只显示列名并且似乎压扁了剩余的行。表格也出现在面板的中心，我希望它位于顶部。

```
 // Panel to hold our layer information
        JPanel layerPanel = new JPanel(new GridBagLayout());
        layerPanel.setBackground(Color.LIGHT_GRAY);
        layerPanel.setPreferredSize(new Dimension(200, 200));

        GridBagConstraints c = new GridBagConstraints();
        c.insets = new Insets(0,5,0,5);
        c.weightx = 1; c.weighty = 0.0;
        c.fill = GridBagConstraints.BOTH;
        c.gridx = 0; c.gridy = 0;

        String[] columns = { "Show", "Layer" };
        Object[][] data = {{"x", "Layer1"},
                           {"x", "Layer2"}};

        // Construct our table to hold our list of layers
        JTable layerTable = new JTable(data, columns);
        layerTable.getColumnModel().getColumn(0).setPreferredWidth(64);

        layerPanel.add(new JScrollPane(layerTable), c);
        frame.add(layerPanel); 
```

[链接到结果照片](http://i1241.photobucket.com/albums/gg511/DynamicCast/ba901114.png)

任何帮助表示赞赏，当我使用 GridLayout(1,0) 而不是使用 GridBagLayout 时，代码可以工作，所以我觉得我用错了。

感谢您的时间。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T20:38:38.510

您没有在 Y 轴上设置任何“权重”，因此您`JscrollPane`不会在该轴上扩展。你可以使用：

```
c.weighty = 1; 
```

解决这个问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-02T20:44:19.033

尝试设置`GridBagConstraints.weighty`为 1

```
c.weighty=1; 
```

# java - 如何解决 Play Framework 1.2.4 中的 ClassFormatException？

> ID：12239513
> 
> 赞同：0
> 
> 时间：2012-09-02T20:28:35.527
> 
> 标签：java, playframework-1.x

正在尝试运行 Play！在 Java 1.6.0_33 下的 OSX Snow Leopard 上的 1.2.4 应用程序，但在登录屏幕后一直出现此错误：-

> 异常 ClassFormatError: Invalid index 95 in LocalVariableTable in class file net/sf/oval/guard/Guard 导致出现意外错误

但相同的代码在 Windows 7 和 Java 7 以及 WinXP 下工作得非常好（抱歉，Java 版本未知）。

这是我的应用程序路径上的文件权限错误，伪装成 Java 错误，还是有其他问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T05:40:36.353

固定的！

删除了 Play Framework，下载了一个新副本并重新运行了该应用程序，它运行良好。旧副本是从备份中恢复的，所以那里可能出现了问题，但现在一切都很好。

# java - SpringMVC ListBox 人口

> ID：12239515
> 
> 赞同：0
> 
> 时间：2012-09-02T20:28:56.413
> 
> 标签：java, jsp, spring-mvc, listbox, controller

我有一个列表框，当我运行 UI 时，我正在从数据库中填充我能够看到 itemLabel 但看不到 itemsValue 我在页面运行时看到的代码是：

```
 <li>
            <label>Select Gender</label>
            <select id="genderId" name="genderId">
            <option itemsValue="genderId" value="com.crimetrack.business.Gender@1a81bd5">Select Gender</option><option itemsValue="genderId" value="com.crimetrack.business.Gender@1bb60ad">FEMALE</option><option itemsValue="genderId" value="com.crimetrack.business.Gender@c80e21">MALE</option>
            </select>

        </li> 
```

我没有让值正确显示，但描述显示。

```
@Controller
................

private GenderManager genderManager;
Map<String, Object> myGender = new HashMap<String, Object>();

.........
 @RequestMapping(value="officer_registration.htm", method = RequestMethod.GET)
    public ModelAndView loadPage(HttpServletRequest request,
            HttpServletResponse response,@ModelAttribute Officers officer, BindingResult result, ModelMap m, Model model) throws Exception {     

     try{

myGender.put("genderList", this.genderManager.getGenderList());

            model.addAttribute("gender", myGender);

         return new ModelAndView("officer_registration");            

     }catch(Exception e){

        request.setAttribute("error",e.getMessage());
        return new ModelAndView("error_page");           
     }       
 }

     public void setGenderManager(GenderManager genderManager){

     this.genderManager = genderManager;
 } 
```

* * *

```
jsp 

        <li>
            <label>Select Gender</label>
            <form:select path="genderId">
            <form:options items = "${gender.genderList}" itemsValue="genderId" itemLabel="genderDesc" />
            </form:select>
            <form:errors path="genderId"/>
        </li> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T22:33:09.490

我认为您的属性名称错误，应该`itemValue`不是`itemsValue`

```
<form:options items = "${gender.genderList}" itemValue="genderId" itemLabel="genderDesc" /> 
```

# python - Python - 使用 set.add() 时添加的元素在哪里

> ID：12239517
> 
> 赞同：0
> 
> 时间：2012-09-02T20:29:17.337
> 
> 标签：python, set, element, add

我发现当我使用python的set结构的add函数时，元素似乎被添加到我无法弄清楚的位置。

```
>>> a=set([(0, 2)])
>>> a.add((0,4))
>>> a
set([(0, 2), (0, 4)])
>>> a.add((1,0))
>>> a
set([(1, 0), (0, 2), (0, 4)])
>>> a.add((2,5))
>>> a
set([(2, 5), (1, 0), (0, 2), (0, 4)])
>>> a.add((3,0))
>>> a
set([(3, 0), (2, 5), (1, 0), (0, 2), (0, 4)])
>>> a.add((1,6))
>>> a
set([(3, 0), (0, 2), (1, 6), (0, 4), (2, 5), (1, 0)]) 
```

可以看出，有时元素被添加在开头，而其他时候，元素被添加到结尾或中间。在最后一个示例中，现有元素也被重新排序。

知道插入是如何发生的吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-02T20:30:32.147

集合是无序的。元素在集合中的“位置”的概念是未定义的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-02T20:30:49.373

python中的集合是无序的。顺序是任意的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-02T20:37:39.900

集合使用与字典相同的哈希函数来添加元素。事实上，它们只是没有价值元素的 dict。

[该视频](http://blip.tv/pycon-us-videos-2009-2010-2011/pycon-2010-the-mighty-dictionary-55-3352147)可以帮助您更好地理解它。

如果您使用整数，则集合是有序的（按照“人类”的排序）：

```
>>> s=set()
>>> for e in range(10):
...    s.add(e)
...    print s
... 
set([0])
set([0, 1])
set([0, 1, 2])
set([0, 1, 2, 3])
set([0, 1, 2, 3, 4])
set([0, 1, 2, 3, 4, 5])
set([0, 1, 2, 3, 4, 5, 6])
set([0, 1, 2, 3, 4, 5, 6, 7])
set([0, 1, 2, 3, 4, 5, 6, 7, 8])
set([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]) 
```

但是如果你使用一个元组，它们对人眼来说不是“有序的”：

```
>>> s=set()
>>> for t in ((i,i*i) for i in range(10)):
...    s.add(t)
...    print s
... 
set([(0, 0)])
set([(0, 0), (1, 1)])
set([(0, 0), (1, 1), (2, 4)])
set([(3, 9), (0, 0), (1, 1), (2, 4)])
set([(3, 9), (0, 0), (1, 1), (4, 16), (2, 4)])
set([(0, 0), (4, 16), (5, 25), (3, 9), (2, 4), (1, 1)])
set([(6, 36), (0, 0), (4, 16), (5, 25), (3, 9), (2, 4), (1, 1)])
set([(6, 36), (0, 0), (7, 49), (4, 16), (5, 25), (3, 9), (2, 4), (1, 1)])
set([(6, 36), (0, 0), (7, 49), (4, 16), (5, 25), (3, 9), (2, 4), (1, 1), (8, 64)])
set([(6, 36), (0, 0), (7, 49), (4, 16), (5, 25), (3, 9), (9, 81), (2, 4), (1, 1), (8, 64)]) 
```

现在在解释器中尝试这两行：

```
>>> dict.fromkeys(range(10),None)
{0: None, 1: None, 2: None, 3: None, 4: None, 5: None, 6: None, 7: None, 8: None, 9: None}
>>> dict.fromkeys(((i,i*i) for i in range(10)),None)
{(6, 36): None, (0, 0): None, (7, 49): None, (4, 16): None, (5, 25): None, (3, 9): None, (9, 81): None, (2, 4): None, (1, 1): None, (8, 64): None} 
```

您可以看到生成的 dict 与设置示例的“顺序”相同。

虽然只有 int 键的 dicts 和 set*可能*是“有序的”，但从实际的角度来看，**dicts 和 set 没有顺序。**

如果您观看链接的视频，您就会明白为什么。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-02T20:42:36.790

元素根据其哈希值进入哈希表中的特定位置。对于具有相同最后 3 位的元素，会发生冲突并为其选择其他位置。哈希表在达到 2/3 满时立即展开以降低冲突率。看这个关于哈希表的[视频。](http://blip.tv/pycon-us-videos-2009-2010-2011/pycon-2010-the-mighty-dictionary-55-3352147)

```
>>> def bits(n):
    n+=2**32
    return bin(n)[-32:]

>>> bits(hash('a'))
'11100100000011011011000111100000' #last three bits are picked to determine the spot in hash table
>>> bits(hash('b'))
'11101011101011101101001101100011' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-02T21:07:56.663

正如其他答案所说：

*   集合应该表现得像没有顺序一样
*   将事物添加到集合的实际机制与字典相同；集合基本上是没有项目的键的字典
*   字典基于哈希表（更多信息：[字典和哈希表之间的真正区别是什么？](https://stackoverflow.com/questions/2061222/what-is-the-true-difference-between-a-dictionary-and-a-hash-table)）

我认为看看幕后发生的事情可能很有用，所以我评论了 set`add()`方法的实际源代码（抱歉滚动）。

```
def add(self, element):
    """Add an element to a set.

    This has no effect if the element is already present.
    """
    try:
        self._data[element] = True                             # self._data is the dictionary where all of the set elements are stored
    except TypeError:                                          # this try...except block catches the cases when element cannot be a dict key (that is, it isn't hashable)
        transform = getattr(element, "__as_immutable__", None) # the getattr() call is the same as trying to get element.__as_immutable__ and returning None if element doesn't have __as_immutable__
        if transform is None:                                     
            raise # re-raise the TypeError exception we caught # if we get to this line, then the element has no defined way to make it immutable (and thus hashable), so a TypeError is raised
        self._data[transform()] = True                         # so if we get here, transform() is the same as calling element.__as_immutable__() (which we know exists), and we can now add it to the self._data dict 
```

如您所见， set`add(element)`与 dict 相同`add(element)`，只是它会更努力地进行 hash `element`。

# c# - EM_GETLINE 在第二次调用中不返回任何内容

> ID：12239518
> 
> 赞同：0
> 
> 时间：2012-09-02T20:29:28.077
> 
> 标签：c#, winapi

> **可能重复：**
> [不能在我的 c# 程序中使用 SendMessage_EX 两次](https://stackoverflow.com/questions/7050755/cant-use-sendmessage-ex-twice-in-my-c-sharp-program)

我使用 EM_GETLINE 消息来获取特定行中的文本，但是当我第二次调用它时，它返回一个空字符串。

运行此代码，然后单击 button1 两次，第一次单击文本将显示在消息框中，但第二次将显示消息框为空。

```
 private void button1_Click(object sender, EventArgs e)
    {
        StringBuilder str = new StringBuilder(256);
        SendMessage_Ex(richTextBox1.Handle, EM_GETLINE, 0, str);
        MessageBox.Show(str.ToString());
    }
    public const int EM_GETLINE = 0xc4;
    [DllImport("user32.dll", EntryPoint = "SendMessageA")]
    public static extern int SendMessage_Ex(IntPtr hwnd, int wMsg, int wParam, StringBuilder lParam); 
```

# javascript - 鉴于行权重已知，如何对表行进行排序？

> ID：12239524
> 
> 赞同：1
> 
> 时间：2012-09-02T20:30:02.633
> 
> 标签：javascript, jquery

桌子：

```
<table>
    <tr><td>1</td></tr>
    <tr><td>2</td></tr>
    <tr><td>3</td></tr>
</table> 
```

表数据存在于一个数组中（请参阅 参考资料`table_matrics`）。数组被排序并`weight_index`跟踪顺序的变化（在这种情况下`[1, 1, 1]`）。

```
var desc            = true;

var weight_index    = [];

var table_matrics   = [1, 2, 3];

table_matrics.sort(function(a, b){
    var weight;

    if(a == b)
    {
        weight  = 0;
    }
    else
    {
        weight  = (desc ? a > b : a < b) ? -1 : 1;
    }

    weight_index.push(weight);

    return weight;
}); 
```

如何使用`weight_index`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T20:32:59.403

这是我的方法。我正在克隆`tbody`表的。然后对 jQuery 对象中的行进行排序，并将当前`tbody`正文替换为排序后的行。

```
var data    = tbody.clone();

var i       = 0;

data        = data.find('tr').sort(function()
{
    return weight_index[i++];
});

tbody.html(data); 
```

虽然，它相对较慢。拥有 10,000 多条记录需要大约 300 毫秒。此外，最好使用无 jQuery 的方法。

发布此内容以防其他人可能会发现它足够简单以满足他们的需求。

* * *

经过数小时的焦躁思考，我得出了以下结论。如果这个示例还不够，我已经写了一篇完整的博客文章来解释它背后的逻辑，[http://anuary.com/57/sorting-large-tables-with-javascript](http://anuary.com/57/sorting-large-tables-with-javascript)。

```
// Will use this to re-attach the tbody object.
var table       = tbody.parent();

// Detach the tbody to prevent unnecessary overhead related
// to the browser environment.
var tbody       = tbody.detach();

// Convert NodeList into an array.
rows            = Array.prototype.slice.call(rows, 0);

var last_row    = rows[data[data.length-1].index];

// Knowing the last element in the table, move all the elements behind it
// in the order they appear in the data map
for(var i = 0, j = data.length-1; i < j; i++)
{
    tbody[0].insertBefore(rows[data[i].index], last_row);

    // Restore the index.
    data[i].index   = i;
}

// Restore the index.
data[data.length-1].index   = data.length-1;

table.append(tbody); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T00:39:12.383

见[http://jsfiddle.net/rJe2U/1/](http://jsfiddle.net/rJe2U/1/)

```
var desc            = true,
    weight_index    = [],
    table_matrics   = [1, 2, 3],
    tb=document.getElementById('tb'),
    rowsCollection=tb.rows,
    rows=[];

try{
    rows=Array.prototype.slice.call(rowsCollection,0);
}catch(e){
    for(var i=0,l=rowsCollection.length;i<l;i++){
        rows.push(rowsCollection[i]);
    }
}

table_matrics.sort(function(a, b){
    var weight;
    if(a == b){
        weight  = 0;
    }else{
        weight  = (desc ? a > b : a < b) ? -1 : 1;
    }
    weight_index.push(weight);
    if(weight>0){
        tb.insertBefore(rows[b-1], rows[a-1])
    }else if(weight<0){
        tb.insertBefore(rows[a-1], rows[b-1])
    }
    return weight;
}); 
```

根据[http://jsperf.com/sorting-table-rows-with-known-row-weight](http://jsperf.com/sorting-table-rows-with-known-row-weight)，性能约为 41,000 ops/秒（12,300 ops/300ms），因此它比您的代码快一点。

**编辑：**

上面的代码可以简化（http://jsfiddle.net/rJe2U/2/）：

```
var desc            = true,
    weight_index    = [],
    table_matrics   = [1, 2, 3],
    tb=document.getElementById('tb'),
    rows=[];

try{
    rows=Array.prototype.slice.call(tb.rows,0);
}catch(e){
    for(var i=0,rowsCollection=tb.rows,l=rowsCollection.length;i<l;i++){
        rows.push(rowsCollection[i]);
    }
}

table_matrics.sort(function(a, b){
    var weight;
    if(a == b){
        weight  = 0;
    }else{
        if(desc ? a > b : a < b){
            weight=-1;
            tb.insertBefore(rows[a-1], rows[b-1]);
        }else{
            weight=1;
            tb.insertBefore(rows[b-1], rows[a-1]);
        }
    }
    weight_index.push(weight);
    return weight;
}); 
```

而且您不需要`weight_index`，因此可以将其删除（[http://jsfiddle.net/rJe2U/3/](http://jsfiddle.net/rJe2U/3/)）：

```
var desc            = true,
    table_matrics   = [1, 2, 3],
    tb=document.getElementById('tb'),
    rows=[];

try{
    rows=Array.prototype.slice.call(tb.rows,0);
}catch(e){
    for(var i=0,rowsCollection=tb.rows,l=rowsCollection.length;i<l;i++){
        rows.push(rowsCollection[i]);
    }
}

table_matrics.sort(function(a, b){
    var weight;
    if(a == b){
        return 0;
    }
    if(desc ? a > b : a < b){
        tb.insertBefore(rows[a-1], rows[b-1]);
        return -1;
    }
    tb.insertBefore(rows[b-1], rows[a-1]);
    return 1;
}); 
```

性能似乎没有提高（[http://jsperf.com/sorting-table-rows-with-known-row-weight/3](http://jsperf.com/sorting-table-rows-with-known-row-weight/3)），但我认为有大量的行它会。

# jquery - jGrowl - 类似使用 qTip 2.0 (jQuery) 的插件。定位问题

> ID：12239527
> 
> 赞同：0
> 
> 时间：2012-09-02T20:30:39.073
> 
> 标签：jquery, jquery-plugins, position, qtip, qtip2

好的，我正在尝试使用 qTip 模拟 jGrowl 通知插件。qTip 有一个演示如何制作这样的功能：

[http://craigsworks.com/projects/qtip2/demos/#growl](http://craigsworks.com/projects/qtip2/demos/#growl)

但是，这会将通知定位在右上角，我希望它们位于右下角。我试图弄乱定位，这在一定程度上很好，我只是无法让更新位置效果正常工作。如果页面上至少有 3 个通知，当一个消失时，第二个会完美重新定位，其他则不会。

有人可以帮我让`updatePos`功能按预期工作吗？

这是一个小提琴：http: [//jsfiddle.net/bCcAB/](http://jsfiddle.net/bCcAB/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T21:00:46.307

在创建函数而不是

```
my: target.length ? 'bottom center' : 'bottom right',
at: target.length ? 'top center' : 'bottom right', 
```

类型

```
my: 'bottom right',
at: target.length ? 'top right' : 'bottom right', 
```

在更新功能而不是

```
api.options.position.target = !i ? [$(window).width() - 5,$(window).height()] : [
                    pos.left + width,
                    pos.top - height - 5
                ];
api.set('position.at', !i ? 'bottom right' : 'top center');
api.set('position.my', !i ? 'bottom right' : 'bottom center'); 
```

类型

```
api.options.position.target = !i ? [$(window).width() - 5,$(window).height()] : [
                    pos.left + width,
                    pos.top
                ];
api.set('position.at', !i ? 'bottom right' : 'top right'); 
```

看看这个：http: [//jsfiddle.net/bCcAB/1/](http://jsfiddle.net/bCcAB/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-02T11:28:03.333

为什么不直接改变容器的样式？原始代码在这里：http: [//jsfiddle.net/craga89/YCfx4/](http://jsfiddle.net/craga89/YCfx4/) 所以只需更改

```
#qtip-growl-container{
    position: fixed;
    top: 10px; right: 10px;
} 
```

至

```
#qtip-growl-container{
    position: fixed;
    bottom: 10px; right: 10px;
} 
```

# python-2.7 - 如何使用python识别raw_input中的单词对

> ID：12239529
> 
> 赞同：0
> 
> 时间：2012-09-02T20:30:47.577
> 
> 标签：python-2.7

我是 python 新手，通过编写基于文本的冒险游戏来练习。我有很多种类的糖果，有的长一个字，有的两个字或更多。我有一个功能可以识别用户是否输入了一个单词糖果，但它无法识别这两个单词糖果，因为输入被分成两个单词。有没有办法识别单词对？我在想我可以将我的列表分成所有一个单词，然后识别每个单词并将它们连接起来，我不知道该怎么做，或者是否有更好的选择？

这是我识别 raw_input 并根据糖果列表检查它的功能。提示不是“你想买什么样的糖果？” 它是“你在糖果店，现在做点什么”所以我预计输入会很复杂。

```
action=raw_input(">")
results=list(action.rsplit())    
inter2 = set(results).intersection(candy_list)
if len(inter2)>0:
    inter_2=list(inter2)
    for x in inter_2:
        inventory.append(x) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T20:42:38.347

你真的需要使用集合结构吗？

也许你应该使用列表：

```
candy_list = [...] # your predefined list
inventory = [...] # the inventory
results = raw_input(">")
if results in candy_list:
    inventory.append(results) 
```

# c++ - 无法在 C++ 中删除数组/向量？

> ID：12239531
> 
> 赞同：-5
> 
> 时间：2012-09-02T20:30:53.400
> 
> 标签：c++, arrays, vector, delete-operator

我在删除数组时遇到问题

```
int calc_mode (vector<int> array, int arrSize) { 
  int ipRepetition = new int[arrSize];
  int j;
  bool bFound;

  for(int i =0; i<arrSize; i++) {
    ipRepetition [i] = 0;
    j=0;
    bFound = false;
    while ( j<i && array[i] != array[j] ) {
      if(array[i] != array[j]) {
        ++j;        
      }   
    }
  }

  int iMaxRepeat = 0;
  for(int i =0; i<arrSize; i++)  {
    if(ipRepetition[i] > ipRepetition[iMaxRepeat] ) {
      iMaxRepeat = i;
    }  
  }

  delete [] ipRepetition; //compiler is complaining here
  return array[iMaxRepeat];
} 
```

错误：无法删除'ipRepetition' ....你能指出我错过了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T20:35:56.653

有时最好的答案是不问问题。不要手动分配该 int 数组，而是使用另一个`vector<int>`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T20:32:05.727

```
int ipRepetition = new int[arrSize]; 
```

这是不正确的。`ipRepetition`必须是指针。

```
int* ipRepetition = new int[arrSize]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-02T20:32:40.933

你需要一个`int*`而不是一个`int`。

```
int* ipRepetition = new int[arrSize]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-02T21:53:02.130

除了@Pete Becker（IMO，优秀）的建议，我会考虑使用一些标准算法来完成大部分工作。`std::mismatch`可以告诉您运行结束的每个位置（即输入中的值不等于前一个值的位置）。连同`std::distance`（或只是减法，因为您使用的是随机访问迭代器），它将相当直接地告诉您每次运行的长度。

一旦你找到了运行长度，你就可以用它`std::max_element`来找到最长的。

# c# - 将新行添加到绑定到 DataGrid 的 DataTable 后选择新行

> ID：12239538
> 
> 赞同：-1
> 
> 时间：2012-09-02T20:32:31.763
> 
> 标签：c#, wpf, datagrid, wpfdatagrid

我有一个简单的 C# 程序，其中包含绑定到 WPF DataGrid 的 DataTable 中的一些数据。

```
<DataGrid Grid.Row="1" DataContext="{Binding}" Name="dataGridEditTab" 
```

和

```
dataGridEditTab.ItemsSource = NavTable.DefaultView; 
```

我有一个“添加行”按钮，按下时会向 DataTable 添加一个空白行。空白行很好地显示在 DataGrid 上，但未选中。我想自动选择新行，但我不知道该怎么做。我想我需要将 SelectedItem 设置为某些东西，但我还没有弄清楚是什么。有什么帮助吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T05:03:41.227

如果是 MVVM，请使用 SelectedItem 或 SelectedIndex 的绑定。如果没有，最好使用它）

要实现您的目标，只需绑定 SelectedIndex 并且每当您添加行时，将 SelectedIndex 设置为 RowsCount-1；

这是一个例子。

```
<Grid >

    <DataGrid AutoGenerateColumns="False" CanUserAddRows="False" ItemsSource="{Binding Path=Persons}" Margin="0,65,0,0" 
                  SelectedIndex="{Binding Path=SelectedIndex, Mode=TwoWay}">
        <DataGrid.Columns>
            <DataGridTextColumn Header="First name" Binding="{Binding Path=FirstName}" Width="*"/>
            <DataGridTextColumn Header="Last name" Binding="{Binding Path=LastName}" Width="*"/>
        </DataGrid.Columns>
    </DataGrid>
    <Button Content="Add new row" Height="23" HorizontalAlignment="Left" Margin="317,12,0,0" Command="{Binding Path=AddCommand}" VerticalAlignment="Top" Width="112" />
</Grid> 
```

和视图模型

```
public class MainViewModel : INotifyPropertyChanged
{
    private int _selectedPerson;

    public MainViewModel()
    {
        AddCommand = new RelayCommand(AddAndSelectePerson);
        Persons = new DataTable();
        Persons.Columns.Add("FirstName");
        Persons.Columns.Add("LastName");
        Persons.Rows.Add("Alexandr", "Puskin");
        Persons.Rows.Add("Lev", "Tolstoy");
    }

    public ICommand AddCommand { get; private set; }

    public int SelectedIndex
    {
        get { return _selectedPerson; }
        set
        {
            _selectedPerson = value;
            OnPropertyChanged("SelectedIndex");
        }
    }

    public DataTable Persons { get; private set; }

    #region INotifyPropertyChanged Members

    public event PropertyChangedEventHandler PropertyChanged;

    #endregion

    private void AddAndSelectePerson()
    {
        Persons.Rows.Add();
        SelectedIndex = Persons.Rows.Count - 1;
    }

    protected virtual void OnPropertyChanged(string propertyName)
    {
        PropertyChangedEventHandler handler = PropertyChanged;
        if (handler != null) handler(this, new PropertyChangedEventArgs(propertyName));
    }
}

public class RelayCommand : ICommand
{
    private readonly Action _actionToExecute;

    public RelayCommand(Action actionToExecute)
    {
        _actionToExecute = actionToExecute;
    }

    #region ICommand Members

    public void Execute(object parameter)
    {
        _actionToExecute();
    }

    public bool CanExecute(object parameter)
    {
        return true;
    }

    public event EventHandler CanExecuteChanged;

    #endregion
}

public class Person
{
    public Person()
    {
    }

    public Person(string firstName, string lastName)
    {
        FirstName = firstName;
        LastName = lastName;
    }

    public string FirstName { get; set; }

    public string LastName { get; set; }
} 
```

尝试的[示例](http://dl.dropbox.com/u/62983561/Pro/StackOverflow%20samples/Selecting%20the%20new%20row%20after%20adding%20a%20new%20row.7z)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T20:40:47.400

根据这个线程（[当网格绑定到排序的 DataView 时如何将 DataGridView 的选定行设置为新添加的行），您可以使用](https://stackoverflow.com/questions/191339/how-to-set-selected-row-of-datagridview-to-newly-added-row-when-the-grid-is-boun)[DataGridViewRowsAddedEventArgs](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewrowsaddedeventargs%28v=vs.100%29.aspx)完成此操作。基本上创建一个全局变量来放置新添加的行索引。在 EventArgs 中为该索引分配适当的值，然后使用该索引选择您要查找的行。

# multithreading - 为什么 TextView 在线程完成之前不会改变？

> ID：12239547
> 
> 赞同：0
> 
> 时间：2012-09-02T20:35:04.423
> 
> 标签：multithreading, button, textview, append

我遇到了许多（初学者）可能感兴趣的问题。让我给你看一下代码：

```
startButton.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            startButton.setVisibility(View.GONE);
            if (!started) {
                started = true;
                timer.start();
                information.append("Start 1\n");
                tester1.start();
                if (cores >= 2) {
                    information.append("Start 2\n");
                    tester2.start();
                }
                if (cores >= 3) {
                    information.append("Start 3\n");
                    tester3.start();
                }
                if (cores >= 4) {
                    information.append("Start 4\n");
                    tester4.start();
                }

            }
        }
    }); 
```

计时器，所有测试者都是先前声明的线程。信息是一个TextView。

问题是当我运行应用程序时，线程完成后文本视图会发生变化，即使线程需要 10 秒才能完成。这确实发生在模拟器（android 2.3）和真实（android 4.0）设备上。奇怪的是，线程确实在大致相同的时间开始。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T20:39:23.300

您**必须**从主线程更新任何 UI 组件。

例如

```
runOnUiThread(new Runnable() {
    public void run() {
        someTextView.setText(someResultVariable);
    }
}); 
```

# php - 在javascript函数中设置变量

> ID：12239554
> 
> 赞同：1
> 
> 时间：2012-09-02T20:37:10.870
> 
> 标签：php, javascript, mysql, ajax

我在为变量设置值时遇到问题。我的代码如下。

```
function fpform(){
var response_new = '';
var password_reset = "";
var fpemail = $('#frgtpwd').val();
//var fpemail = document.getElementById('frgtpwd').value;

if (fpemail == ""){
    $('span#fperror').text("insert your emal address");
    //document.getElementById('fperror').innerHTML = "Insert your email address";
    password_reset = 'no';
} else { 
    var filter = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
    if (filter.test(fpemail)==false) { 
        $('span#fperror').text("Email address is not in valid format");
        //document.getElementById('fperror').innerHTML = "Email address is not in valid format";
         password_reset = 'no';
    } else {
        $("#loader").html('<img src="images/ajax-loader.gif" />');
        $.post("forgot_password_process.php", {
            email:fpemail
        }, function(response){
            response_new = response.trim();
        }).success(function () {
            if (response_new == 'yes'){ 
                $("#fperror").html('<font color="green"><b>Your password has been reset now and emailed to you </b></font>');
                $("#loader").empty();
                password_reset = 'yes';
            } else {
                $("#loader").empty();
                $("#fperror").html('<font color="black"><b> Email address was not found in database!</b></font>');
                password_reset = 'no'; 
            } 
        }); 
    }
}

if (password_reset == "yes"){
    alert(password_reset);
    return true;
} else {
    alert(password_reset);
    return true;
}
} 
```

最后一个 if 条件是检查 password_reset 变量是否设置为 yes 并根据它返回 true 或 false。但是警报显示 password_reset 变量的空白值。我似乎找不到这背后的问题，因为 password_reset 变量应该在到达最后一个 if 之前被分配。任何人都可以请提出一个解决方案。

亲切的问候

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T20:39:30.627

`$.post()`是异步的，因此当您提醒数据时请求尚未完成。为此，您还需要在成功回调中调用警报，以确保在尝试警报之前您拥有数据。另一种选择是使用同步 AJAX 调用（虽然这很少是一个好的选择）。

**更新**

不知道为什么你的函数返回真/假，但要让它工作，你必须进行同步 AJAX 调用，否则外部函数将在 AJAX 调用完成之前返回很久，那时你不知道反应是什么。

您可能应该尝试重构您的代码，以使依赖于您的外部函数响应的代码可由成功回调调用。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-02T20:44:22.997

我要发布和克里斯托弗一样的东西。这是一个固定的代码示例。只需删除最后一个代码块。

```
.success(function () {
        if (response_new == 'yes'){ 
            $("#fperror").html('<font color="green"><b>Your password has been reset now and emailed to you </b></font>');
            $("#loader").empty();
            password_reset = 'yes';
            alert 'yes';
            return true;
        } else {
            $("#loader").empty();
            $("#fperror").html('<font color="black"><b> Email address was not found in database!</b></font>');
            password_reset = 'no';
            alert 'no';
            return false;
        } 
```

# security - 通过不安全的网络轻松安全连接（两个端点完全受控）

> ID：12239555
> 
> 赞同：5
> 
> 时间：2012-09-02T20:37:15.277
> 
> 标签：security, authentication, encryption, network-programming, go

我需要通过不受信任的网络连接客户端和服务器。我考虑过使用[TLS (crypto/tls)](http://golang.org/pkg/crypto/tls/)，但据我了解，我首先需要创建一个 create a [crypto/x509.Certificate](http://golang.org/pkg/crypto/x509/#Certificate)。但是我对需要传递给[x509.CreateCertificate() 函数](http://golang.org/pkg/crypto/x509/#CreateCertificate)的所有参数感到不知所措——它说它需要以下所有字段：

> 序列号、主题、NotBefore、NotAfter、KeyUsage、BasicConstraintsValid、IsCA、MaxPathLen、SubjectKeyId、DNSNames、PermittedDNSDomainsCritical、PermittedDNSDomains。

我可以完全控制两个端点，所以我相信我不需要任何过期或失效支持/参数（我可以随时更改客户端和服务器上的密钥） - 所以我可以跳过*NotBefore*和*NotAfter*（？还是我必须设置它们？）。我应该在所有其他字段中添加什么，为什么要避免任何漏洞？另外，我可以使用相同的私钥/公钥对进行两种身份验证（客户端到服务器，服务器到客户端），还是必须使用 2 对？

或者，我可以使用比 TLS 更简单的东西吗？但是请注意，我需要进行两种身份验证。

***编辑：***

我根据接受的答案中的建议以及 generate_cert.go 中的密钥生成代码创建了一个简单的库[-](http://golang.org/src/pkg/crypto/tls/generate_cert.go)请参阅：

> [github.com/akavel/tunnel](https://github.com/akavel/tunnel/)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-02T22:11:37.527

Owlstead 部分正确。您最好的选择是使用 OpenSSL 创建自签名证书。但是，我会使用 Go TLS 库进行加密。以下是一些可能对您有所帮助的代码。

# 创建 x509 密钥对

我通常按​​照[这里](http://www.akadia.com/services/ssh_test_certificate.html)的说明进行操作。命令摘要（对客户端和服务器都执行）：

```
openssl genrsa -des3 -out server.key 1024
openssl req -new -key server.key -out server.csr
cp server.key server.key.org
openssl rsa -in server.key.org -out server.key
openssl x509 -req -days 365 -in server.csr -signkey server.key -out server.crt 
```

# 使用 Go 的 TLS 库

首先，创建一个`tls.Config`. 一个 TLS 配置适用于客户端和服务器，但一些选项只需要在其中一个上设置：

```
cert, err := tls.LoadX509KeyPair(cert, key)
config := &tls.Config{
    Certificates: []Certificates{cert},
    ClientAuth: tls.RequireAnyClientCert, // Must be done on server
    InsecureSkipVerify: true, // Must be done on client
} 
```

在服务器上，您需要设置一个 TLS 侦听器。这将其设置在端口 4443 上：

```
listener, err := tls.Listen("tcp", ":4443", config)
for {
    conn, err := listener.Accept()
    acceptConn(conn) // your code
} 
```

在客户端：

```
conn, err := tls.Dial("tcp", serverAddr, config) 
```

这将创建一个加密连接，但它不会验证对方是他们所说的人。最简单的方法是为每台服务器提供另一台服务器的公钥，并将其与刚刚连接的服务器进行比较。要在另一台服务器上查找公钥，您需要：

```
c := conn.(*tls.Conn) // convert net.Conn from listener to tls conn
err := c.Handshake() // ensure handshake is completed without error
state := c.ConnectionState()
pubKey, err := x509.MarshalPKIXPublicKey(state.PeerCertificates[0])
bytes.Equal(pubKey, knownKey) // compare to known value 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T21:57:37.863

正如 owlstead 所说，TLS 仍然是您最好的选择。可以通过遵循一些在线指南来创建自己的证书。

下面的文章让您创建自己的 SSL 根证书（您实际上成为自己的根 CA，如 Verisign 等）。有了这个，您可以创建和签署您自己的应用程序证书并分发它们。如果如您所说，您可以完全控制两个端点，那么这可能值得一试。

[http://www.eclectica.ca/howto/ssl-cert-howto.php/](http://www.eclectica.ca/howto/ssl-cert-howto.php/)

# mysql - 表中最近的条目基于一年间隔mysql

> ID：12239558
> 
> 赞同：2
> 
> 时间：2012-09-02T20:37:50.927
> 
> 标签：mysql

[在此处](http://sqlfiddle.com/#!2/cb8e3/5)使用以下 sqlfiddle我将如何找到在之前的查询`2012-04-1`中`2012-03-31`使用 case 语句进行的几个月之间的最新付款我试过这个：

```
max(case when py.pay_date >= STR_TO_DATE(CONCAT(2012, '-04-01'),'%Y-%m-%d') and py.pay_date <=  STR_TO_DATE(CONCAT(2012, '-03-31'), '%Y-%m-%d') + interval 1 year  then py.amount end) CURRENT_PAY 
```

但是我得到的答案不正确，实际答案应该是：`(12, '2012-12-12', 20, 1)`

请给我一些帮助，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T20:48:07.287

`CASE`该条件不属于您的聚合内部，而是`MAX()`属于该`WHERE`子句。`person_id`这加入了一个子查询，该子查询通过 join on提取最近的付款`MAX(pay_date), person_id`。

```
SELECT payment.* 
FROM 
  payment
  JOIN (
    SELECT MAX(pay_date) AS pay_date, person_id 
    FROM payment 
    WHERE pay_date BETWEEN '2012-04-01' AND DATE_ADD('2012-03-31', INTERVAL 1 YEAR)
    GROUP BY person_id
  ) maxp ON payment.person_id = maxp.person_id AND payment.pay_date = maxp.pay_date 
```

这是[一个更新的小提琴](http://sqlfiddle.com/#!2/6bcd6/1)，其中包含在您的表中更正的 id（因为其中有 15 个）。这将返回记录 18，对于`2013-03-28`.

### 更新

在看到*正确*的SQL 小提琴之后......要将此查询的结果合并到您现有的查询中，您可以`LEFT JOIN`将其作为`p.id`.

```
select p.name,
  v.v_name,
  sum(case when Month(py.pay_date) = 4 then py.amount end) april_amount,

   (case when max(py.pay_date)and month(py.pay_date)= 4 then py.amount else 0 end) max_pay_april,

   sum(case 
        when Month(py.pay_date) = Month(curdate())
        then py.amount end) current_month_amount,
   sum(case 
        when Month(py.pay_date) = Month(curdate())-1
        then py.amount end) previous_month_amount,
   maxp.pay_date AS last_pay_date,
   maxp.amount AS last_pay_amount
from persons p
left join vehicle v
  on p.id = v.person_veh
left join payment py
  on p.id = py.person_id
/* LEFT JOIN against the subquery: */
left join (
   SELECT MAX(pay_date) AS pay_date, amount, person_id 
      FROM payment 
      WHERE pay_date BETWEEN '2012-04-01' AND DATE_ADD('2012-03-31', INTERVAL 1 YEAR)
      GROUP BY person_id, amount
    ) maxp ON maxp.person_id = p.id

group by p.name,
  v.v_name 
```

# actionscript-3 - as3检测精灵与文本页面内字母的碰撞

> ID：12239559
> 
> 赞同：1
> 
> 时间：2012-09-02T20:37:52.400
> 
> 标签：actionscript-3, collision, bitmapdata, getpixel

我想使用位图数据来检测精灵与文本页面内的字母的冲突。我试图用它来`getPixels`测试颜色，但它似乎不够准确。我不尝试使用 bitmapdata 进行碰撞测试，因为我不知道如何仅查找黑色像素。

# subquery - 如何使用 select 进行这些选择

> ID：12239560
> 
> 赞同：0
> 
> 时间：2012-09-02T20:37:55.437
> 
> 标签：subquery, rows

```
Table A, Table B,  Table C
100      A         Honda
200      B         Ferrari 
300      C
400      D
         E  
         F 
```

这些表只是举例，它们没有任何特殊含义！

我正在尝试做这些

如果我做这些

```
Select * from A, B, C 
```

我会得到所有的组合，我不想那样。

我希望输出查询是

```
Col_1  , Col_2,  Col_3
100      A       Honda 
200      B       Ferrari 
300      C       NULL
400      D       NULL
NULL     E       NULL
NULL     F       NULL 
```

所以我真正想在上面的单个查询中显示输出。

查询愚蠢的（`Select * from A, Select * from b, Select * from C`）Ofcorse这些不会工作......它只是让你明白

这些问题的解决方案是什么，这些必须只在一个查询中完成？？？谢谢

# ruby - 如何从 XSD 创建 Ruby 类？

> ID：12239565
> 
> 赞同：1
> 
> 时间：2012-09-02T20:38:43.643
> 
> 标签：ruby, xsd

我想调用 REST Web 服务并将结果反序列化为 Ruby 类。为了使它成为可能，我需要从 XSD 中生成这些 ruby​​ 类。我怎样才能做到这一点？我测试了一个名为 RXSD 的工具，但该工具已停产并且不适用于 ruby​​ 1.9。

谢谢。法比奥

[编辑：可能与[Generate Ruby Classes from XSD](https://stackoverflow.com/questions/543709/generate-ruby-classes-from-xsd)相同的问题]

# c# - ANTLR C#找不到'IAstRuleReturnScope'

> ID：12239566
> 
> 赞同：2
> 
> 时间：2012-09-02T20:38:46.263
> 
> 标签：c#, visual-studio-2010, antlr

我已经从这里[http://antlrcsharp.codeplex.com/releases/view/47523](http://antlrcsharp.codeplex.com/releases/view/47523)下载了 csharp 语法项目，它运行良好。

但是当我在语法中添加 'output=AST' 时，我得到了大量的错误：

![在此处输入图像描述](../Images/0fff3099a6e747bed091ea39042d0efc.png)

诚然，我是 ANTLR 的新手，所以我现在不知道如何进行。我会假设这种类型会存在于 antlr csharp 运行时 dll 中，但显然不是。有没有人遇到过这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T20:13:01.827

我遇到了从 Java 工具生成的 v3.2 脚本迁移到使用 dotNet 构建工具的 v3.4 的迁移。

我能够弄清楚（感谢 .net VS 集成附带的文档）没有获得正确的返回类型的问题是因为**只有在规则上有返回类型时才会生成一个类**。在我的没有返回值的规则中添加一个虚拟整数返回类型可以清除它。

[在 antlr](http://www.antlr.org/wiki/display/ANTLR3/Antlr3CSharpReleases)的 C# 目标页面的文档中讨论了 C# 生成器和目标中的规则返回，点击页面顶部的链接并查看第 4.1.1 节“返回值”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T05:13:37.430

大约一年前，我用 Antlr 做了一个项目，遇到了一个问题，我遇到了很多错误。听起来很奇怪，但通过使用较旧的运行时，我让它工作了。我想我使用了一个为 2.0 .Net Framework 编译的 dll。

我不记得确切的错误是什么或实际导致它的原因。我只记得它解决了这个问题。我不知道这是否会对您的情况有所帮助，但如果您遇到困难，值得一试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T05:25:21.317

你不是第一个遇到这个问题的人。[https://github.com/antlr/antlr/pull/1](https://github.com/antlr/antlr/pull/1)上的补丁通过提供丢失的文件来解决它。将其包含在您的源代码中并重新编译。

# python - 为什么在 gae 中需要电话号码？

> ID：12239567
> 
> 赞同：0
> 
> 时间：2012-09-02T20:38:48.620
> 
> 标签：python, google-app-engine, google-cloud-datastore

我的 gae python 代码似乎需要这些 if 语句。没有它们，gae 会引发此错误。

```
raise exception('%s must not be empty.' % name)
BadValueError: phone must not be empty. 
```

这是代码。

```
reservation = Reservations(parent=court) 
if phone:
    reservation.phone = phone
if email:
    reservation.email = email
reservation.put() 
```

这是数据存储模型。没有“必需”。

```
class Reservations(db.Model):    #parent is Courts
    court = db.ReferenceProperty(Courts)
    phone = db.PhoneNumberProperty()
    email = db.EmailProperty() 
```

为什么我的代码中需要电话和电子邮件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T21:05:04.150

我猜如果没有 if 语句，您的代码如下所示：

```
reservation = Reservations(parent=court) 
reservation.phone = phone
reservation.email = email
reservation.put() 
```

如果是这样，那么它很可能会抛出该异常，因为`phone`在您的情况下可能是一个空字符串，或者当您分配给时看起来不像电话的东西`reservation.phone`。

我建议您尽管根本不要使用`PhoneNumberProperty`and `EmailProperty`，因为它们已被[删除](https://developers.google.com/appengine/docs/python/ndb/properties)在最新的 NDB 中，而您可以使用`StringProperty`. 如果它是一个新项目，请考虑切换到 NDB，因为有一些很酷的新功能，比如[自动缓存等等](https://developers.google.com/appengine/docs/python/ndb/)。

# php - 如何将样式表添加到我的布局并将值从视图传递到布局

> ID：12239569
> 
> 赞同：1
> 
> 时间：2012-09-02T20:39:11.203
> 
> 标签：php, model-view-controller, zend-framework, layout

我正在使用zend框架。

我的结构是（仅包含此问题所需的文件和文件夹）：

```
application
  >configs
  >controllers
  >forms
  >images
  >layouts
    >scripts
      >layout.phtml
  >models
  >styles
    >style.css
  >views
    >scripts
      >index
        >index.phtml
  Bootstrap.php
docs
library
logs
public
test 
```

我的布局工作正常。但是，我想问几个问题，以使我的设置完美地符合我的要求。

1.  样式表是`application>style`一个好地方吗？如果不是，推荐什么？
2.  如何将样式表添加到布局中？
3.  在我的布局中，我有一个标题标签：`<title>Text</title>`。如何将值从我的控制器传递给它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T21:04:28.223

1.  样式表需要可从浏览器访问，因此通常您会将它们放在公共目录中的某个位置，例如*public/css*

2.  有几种方法，包括在您的视图/布局中放置 rel 标签，但我的首选选项是`viewHelper`在您的控制器中使用：

    $this->view->headLink()->setStylesheet('/css/style.css'); 然后您`headLink()`在布局文件中的调用将自动包含样式表。

3.  我这样做的方式是过去使用 Zend_Registry。可能有更好的方法。

# c - 这个程序是如何工作的？

> ID：12239574
> 
> 赞同：2
> 
> 时间：2012-09-02T20:39:32.927
> 
> 标签：c, infinite-loop, ansi

我一直在阅读 Kernighan 和 Ritchie 的 The C Programming Language 并且很早就拥有了我遇到了一个不起作用的程序，即使我直接从书中复制了它。这是描述的屏幕截图 - [http://i.imgur.com/SBQSE.png](http://i.imgur.com/SBQSE.png)

它陷入无限循环，因为我输入的任何内容显然都是键盘输入，并且它正在检查 EOF，这显然不是键盘输入。

```
#include <stdio.h> 
/* copy input to output; 1st version  */ 
main() 
{ 
    int c; 
    c = getchar(); 
    while (c != EOF) { 
        putchar(c); 
        c = getchar(); 
    } 
} 
```

当然，像这样的 C 权威书籍不会有错误，我错过了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T20:41:23.937

从命令行读取时，您将运行它并使用它`ctrl + d`来发出 EOF（文件结束）信号。

如果您正在从文件中读取字节流，那么它会自动将其包含在其中。但是，由于您是从命令行读取的，因此需要使用上面的键序列手动指示文件结束。

**它实际上是如何工作的**

EOF 通常在（至少 glibc 中）表示 -1，这就是为什么你不能只说`while(c) { do work; }`因为任何非零值都是真的 - 因此 EOF 是真的，就像调用返回的任何其他正数字符一样`getchar()`。这就是为什么您必须直接检查 c 是否匹配 EOF (-1) 与`c != EOF`当您发送 EOF 信号时出现在流中的代码`ctrl + d`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T20:40:21.457

EOF 是文件结束符。试试 Ctrl-D。

# ios - 使用 CADisplayLink 的 iOS OpenGL ES 1.1 生涩动画（重启修复了一段时间）

> ID：12239576
> 
> 赞同：1
> 
> 时间：2012-09-02T20:39:59.477
> 
> 标签：ios, opengl-es-1.1, cadisplaylink

我正在使用 OpenGL ES 1.1 和 CADisplayLink 为 3d 场景设置动画。如果 iOS 设备最近重新启动，动画是平滑的，并且两次 displayLink.timestamp 调用之间的时间增量相当均匀。但是在使用 iOS 设备几个小时或几天后，我的应用程序有时会运行几次，动画会变得不稳定，时间增量会上升，然后重置为较低的值，然后再次上升。

像这样：

> > 2012-09-01 23:42:58.770 [2678:707] dt= 0.021139
> > 
> > 2012-09-01 23:42:58.787 [2678:707] dt= 0.022183
> > 
> > 2012-09-01 23:42:58.804 [2678:707] dt= 0.023223
> > 
> > 2012-09-01 23:42:58.820 [2678:707] dt= 0.024270
> > 
> > 2012-09-01 23:42:58.837 [2678:707] dt= 0.009679
> > 
> > 2012-09-01 23:42:58.853 [2678:707] dt= 0.010750
> > 
> > 2012-09-01 23:42:58.870 [2678:707] dt= 0.011766
> > 
> > 2012-09-01 23:42:58.887 [2678:707] dt= 0.012806
> > 
> > 2012-09-01 23:42:58.903 [2678:707] dt= 0.013847
> > 
> > 2012-09-01 23:42:58.920 [2678:707] dt= 0.014890
> > 
> > 2012-09-01 23:42:58.937 [2678:707] dt= 0.015933
> > 
> > 2012-09-01 23:42:58.953 [2678:707] dt= 0.016976
> > 
> > 2012-09-01 23:42:58.970 [2678:707] dt= 0.018011
> > 
> > 2012-09-01 23:42:58.987 [2678:707] dt= 0.019055
> > 
> > 2012-09-01 23:42:59.003 [2678:707] dt= 0.020097
> > 
> > 2012-09-01 23:42:59.020 [2678:707] dt= 0.021143
> > 
> > 2012-09-01 23:42:59.037 [2678:707] dt= 0.022181
> > 
> > 2012-09-01 23:42:59.054 [2678:707] dt= 0.023222
> > 
> > 2012-09-01 23:42:59.071 [2678:707] dt= 0.024288
> > 
> > 2012-09-01 23:42:59.087 [2678:707] dt= 0.009624
> > 
> > 2012-09-01 23:42:59.103 [2678:707] dt= 0.010728
> > 
> > 2012-09-01 23:42:59.121 [2678:707] dt= 0.011763
> > 
> > 2012-09-01 23:42:59.137 [2678:707] dt= 0.012808
> > 
> > 2012-09-01 23:42:59.153 [2678:707] dt= 0.013847
> > 
> > 2012-09-01 23:42:59.170 [2678:707] dt= 0.014891
> > 
> > 2012-09-01 23:42:59.187 [2678:707] dt= 0.016002
> > 
> > 2012-09-01 23:42:59.203 [2678:707] dt= 0.016979
> > 
> > 2012-09-01 23:42:59.220 [2678:707] dt= 0.018016
> > 
> > 2012-09-01 23:42:59.237 [2678:707] dt= 0.019042
> > 
> > 2012-09-01 23:42:59.253 [2678:707] dt= 0.020099
> > 
> > 2012-09-01 23:42:59.270 [2678:707] dt= 0.021138
> > 
> > 2012-09-01 23:42:59.287 [2678:707] dt= 0.022185
> > 
> > 2012-09-01 23:42:59.304 [2678:707] dt= 0.023222
> > 
> > 2012-09-01 23:42:59.320 [2678:707] dt= 0.024265
> > 
> > 2012-09-01 23:42:59.337 [2678:707] dt= 0.009681
> > 
> > 2012-09-01 23:42:59.354 [2678:707] dt= 0.010736

然后，如果重新启动 iOS 设备，动画又会变得流畅。

当 UpdateAnimation() 函数中几乎没有与游戏相关的计算时，这个问题甚至出现在我的菜单屏幕上。

我不明白发生了什么以及为什么重新启动总能在一段时间内解决这个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-15T03:35:28.147

发现问题了！我正在使用 CADisplayLink 中的时间戳来计算帧之间的时间。时间戳是双精度的，但我（错误地）将它分配给浮点数。这导致精度损失，并导致不正确的帧时间计算。时间戳从用户重新启动设备时开始增长，最终变得如此之大，它需要是双精度才能用于准确计算帧之间的时间。

# c# - 如何使用 SignalR 和对 Web API 的 URL 调用从模型类将 JSON 返回到浏览器？

> ID：12239579
> 
> 赞同：0
> 
> 时间：2012-09-02T20:40:26.403
> 
> 标签：c#, asp.net-mvc, json, asp.net-web-api, signalr

这是正在发生的事情。我有一个 ASP.NET MVC 4 Web API Web 应用程序。我可以通过 URL 调用 API 资源。其中一个函数获取指定时间内的性能监控数据，并在完成后以 JSON 形式返回。但是，我想做的是返回

重要的是要注意我正在使用模型中的浏览器和 API 资源，而不是使用视图。请不要随便告诉我在视图中使用 Javascript，因为没有视图，或者告诉我查看 SignalR wiki，因为“.NET”部分的信息适用于桌面应用程序，而不是 Web 应用程序。例如，您不能向浏览器“Console.WriteLine()”。

重申一下，我正在使用 ASP.NET MVC 4 Web API 来开发 API，并通过浏览器中的 URL 调用 API 并返回 JSON。我正在尝试使用 SignalR 让应用程序将 JSON 发送到浏览器，但它根本没有做任何事情。相反，一旦过程完成，应用程序只需从控制器操作返回完整的 JSON 以及所有性能数据值。换句话说，SignalR 不工作。

所以我想做的是在 API 资源收集所有信息的同时，SignalR 每秒向浏览器发送 JSON，以便客户端可以实时查看正在发生的事情。我需要找出的是为什么 SignalR 不发送它，以及我如何发送信息以在没有 Javascript 的情况下在浏览器中显示，因为我是从模型类而不是视图中工作的。

如您所见，我使用 On 订阅事件，然后使用 Invoke 调用服务器端集线器方法 SendToClient。

请让我知道如果我试图做是不可能的。我从未听说过通过 URL 进行的“实时”动态 API 调用。

这是我的中心课程。它位于 ~/signalr/hubs 并位于名为 LiveHub.cs 的文件中。Send 方法是我试图在下一个代码块中看到的方法中调用的方法。

```
namespace PerfMon2.signalr.hubs
{
    public class LiveHub : Hub
    {

        public void SendToClient(List<DataValueInfo> json)
        {
            Clients.showValue(json);
        }
    }
} 
```

这是 LogDBRepository.cs 中包含 SignalR 调用的方法。

```
public List<LogInfo> LogTimedPerfData(string macName, string categoryName, string counterName,
                                          string instanceName, string logName, string live, long? seconds)
    {
        iModsDBRepository modsDB = new iModsDBRepository();
        List<MachineInfo> theMac = modsDB.GetMachineByName(macName);

        if (theMac.Count == 0)
            return new List<LogInfo>();

        else if (instanceName == null)
        {
            if (!PerformanceCounterCategory.Exists(categoryName, macName) ||
                !PerformanceCounterCategory.CounterExists(counterName, categoryName, macName) )
            {
                return new List<LogInfo>();
            }
        }
        else if (instanceName != null)
        {
            if (!PerformanceCounterCategory.Exists(categoryName, macName) ||
                !PerformanceCounterCategory.CounterExists(counterName, categoryName, macName) ||
                !PerformanceCounterCategory.InstanceExists(instanceName, categoryName, macName))
            {
                return new List<LogInfo>();
            }
        }
        else if (logName == null)
        {
            return new List<LogInfo>();
        }

        // Check if entered log name is a duplicate for the authenticated user
        List<LogInfo> checkDuplicateLog = this.GetSingleLog(logName);
        if (checkDuplicateLog.Count > 0)
        {
            return new List<LogInfo>();
        }

        PerformanceCounterCategory category = new PerformanceCounterCategory(categoryName, theMac[0].MachineName);
        if (category.CategoryName == null || category.MachineName == null)
        {
            return new List<LogInfo>();
        }

        List<LogInfo> logIt = new List<LogInfo>();
        if (category.CategoryType != PerformanceCounterCategoryType.SingleInstance)
        {
            List<InstanceInfo> instances = modsDB.GetInstancesFromCatMacName(theMac[0].MachineName, category.CategoryName);

            foreach (InstanceInfo inst in instances)
            {
                if (!category.InstanceExists(inst.InstanceName))
                {
                    continue;
                }
                else if (inst.InstanceName.Equals(instanceName, StringComparison.OrdinalIgnoreCase))
                {
                    PerformanceCounter perfCounter = new PerformanceCounter(categoryName, counterName,
                                                                        inst.InstanceName, theMac[0].MachineName);

                    //CounterSample data = perfCounter.NextSample();
                    //double value = CounterSample.Calculate(data, perfCounter.NextSample());
                    string data = "";
                    List<UserInfo> currUser = this.GetUserByName(WindowsIdentity.GetCurrent().Name);

                    string timeStarted = DateTime.Now.ToString("MM/dd/yyyy - h:mm:ss tt");

                    //string[] dataValues = new string[(int)seconds];
                    List<string> dataValues = new List<string>();

                    var hubConnection = new HubConnection("http://localhost/PerfMon2/");
                    hubConnection.Credentials = CredentialCache.DefaultNetworkCredentials;
                    var perfMon = hubConnection.CreateProxy("LiveHub");
                    // perfMon.On("sendValue", message => Console.WriteLine(message));
                    perfMon.On("showValue", json => Console.WriteLine(json));
                    hubConnection.Start().Wait();

                    List<DataValueInfo> lol = new List<DataValueInfo>();
                    for (int i = 0; i < seconds; i++)
                    {
                        data = "Value " + i + ": " + perfCounter.NextValue().ToString();
                        //dataValues[i] = data;
                        dataValues.Add(data);
                        lol.Add(new DataValueInfo
                        {
                            Value = perfCounter.NextValue().ToString()
                        });
                        //           perfMon.Invoke<List<DataValueInfo>>("Send", lol);
                        perfMon.Invoke("SendToClient", lol);
                        Thread.Sleep(1000);
                    }
                    string timeFinished = DateTime.Now.ToString("MM/dd/yyyy - h:mm:ss tt");

                    Log log = new Log
                    {
                        LogName = logName,
                        CounterName = perfCounter.CounterName,
                        InstanceName = perfCounter.InstanceName,
                        CategoryName = perfCounter.CategoryName,
                        MachineName = perfCounter.MachineName,
                        TimeStarted = timeStarted,
                        TimeFinished = timeFinished,
                        PerformanceData = string.Join(",", dataValues),
                        UserID = currUser[0].UserID
                    };
                    this.CreateLog(log);
                    logIt.Add(new LogInfo
                    {
                        LogName = logName,
                        CounterName = perfCounter.CounterName,
                        InstanceName = perfCounter.InstanceName,
                        CategoryName = perfCounter.CategoryName,
                        MachineName = perfCounter.MachineName,
                        TimeStarted = timeStarted,
                        TimeFinished = timeFinished,
                        PerformanceData = dataValues.ToList<string>()
                    });
                    break;
                }
            }
        }
        else
        {
            PerformanceCounter perfCounter = new PerformanceCounter(categoryName, counterName,
                                                                        "", theMac[0].MachineName);

            string data = "";
            List<UserInfo> currUser = this.GetUserByName(WindowsIdentity.GetCurrent().Name);

            string timeStarted = DateTime.Now.ToString("MM/dd/yyyy - h:mm:ss tt");

            //string[] dataValues = new string[(int)seconds];
            List<string> dataValues = new List<string>();

            var hubConnection = new HubConnection("http://localhost/PerfMon2/");
            hubConnection.Credentials = CredentialCache.DefaultNetworkCredentials;
            var perfMon = hubConnection.CreateProxy("LiveHub");
            // perfMon.On("sendValue", message => Console.WriteLine(message));
            perfMon.On("showValue", json => Console.WriteLine(json));
            hubConnection.Start().Wait();

            List<DataValueInfo> lol = new List<DataValueInfo>();
            for (int i = 0; i < seconds; i++)
            {
                data = "Value " + i + ": " + perfCounter.NextValue().ToString();
                //dataValues[i] = data;
                dataValues.Add(data);
                lol.Add(new DataValueInfo
                {
                    Value = perfCounter.NextValue().ToString()
                });
     //           perfMon.Invoke<List<DataValueInfo>>("Send", lol);
                perfMon.Invoke("SendToClient", lol);
                Thread.Sleep(1000);
            }
            string timeFinished = DateTime.Now.ToString("MM/dd/yyyy - h:mm:ss tt");

            Log log = new Log
            {
                LogName = logName,
                CounterName = perfCounter.CounterName,
                InstanceName = perfCounter.InstanceName,
                CategoryName = perfCounter.CategoryName,
                MachineName = perfCounter.MachineName,
                TimeStarted = timeStarted,
                TimeFinished = timeFinished,
                PerformanceData = string.Join(",", dataValues),
                UserID = currUser[0].UserID
            };              
            this.CreateLog(log);
            logIt.Add(new LogInfo
            {
                LogName = logName,
                CounterName = perfCounter.CounterName,
                InstanceName = perfCounter.InstanceName,
                CategoryName = perfCounter.CategoryName,
                MachineName = perfCounter.MachineName,
                TimeStarted = timeStarted,
                TimeFinished = timeFinished,
                PerformanceData = dataValues.ToList<string>()
            });
        }
        return logIt;
    } 
```

这是 LogController.cs 中方法的控制器：

```
 [AcceptVerbs("GET", "POST")]
    public List<LogInfo> Log_Perf_Data(string machine_name, string category_name, string counter_name, string instance_name,
                                   string log_name, long? seconds, string live, string enforceQuery)
    {
        LogController.CheckUser();

        // POST api/log/post_data?machine_name=&category_name=&counter_name=&instance_name=&log_name=&seconds=
        if (machine_name != null && category_name != null && counter_name != null && log_name != null && seconds.HasValue && enforceQuery == null)
        {
            List<LogInfo> dataVal = logDB.LogTimedPerfData(machine_name, category_name, counter_name, instance_name,
                                   log_name, live, seconds);
            logDB.SaveChanges();
            return dataVal;

        }

        return new List<LogInfo>();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T08:35:20.987

也许你可以用推送技术来实现它。我是这样做的： 带消息的类

```
 public class Message
    {
        /// <summary>
        /// The name who will receive this message.
        /// </summary>
        public string RecipientName { get; set; }

        /// <summary>
        /// The message content.
        /// </summary>
        public string MessageContent { get; set; }
    } 
```

代表客户的类：

```
public class Client
    {
        private ManualResetEvent messageEvent = new ManualResetEvent(false);
        private Queue<Message> messageQueue = new Queue<Message>();

        /// <summary>
        /// This method is called by a sender to send a message to this client.
        /// </summary>
        /// <param name="message">the new message</param>
        public void EnqueueMessage(Message message)
        {
            lock (messageQueue)
            {
                messageQueue.Enqueue(message);

                // Set a new message event.
                messageEvent.Set();
            }
        }

        /// <summary>
        /// This method is called by the client to receive messages from the message queue.
        /// If no message, it will wait until a new message is inserted.
        /// </summary>
        /// <returns>the unread message</returns>
        public Message DequeueMessage()
        {
            // Wait until a new message.
            messageEvent.WaitOne();

            lock (messageQueue)
            {
                if (messageQueue.Count == 1)
                {
                    messageEvent.Reset();
                }
                return messageQueue.Dequeue();
            }
        }
    } 
```

向客户端发送消息的类：

```
public class ClientAdapter
    {
        /// <summary>
        /// The recipient list.
        /// </summary>
        private Dictionary<string, Client> recipients = new Dictionary<string,Client>();

        /// <summary>
        /// Send a message to a particular recipient.
        /// </summary>
        public void SendMessage(Message message)
        {
            if (recipients.ContainsKey(message.RecipientName))
            {
                Client client = recipients[message.RecipientName];

                client.EnqueueMessage(message);
            }
        }

        /// <summary>
        /// Called by a individual recipient to wait and receive a message.
        /// </summary>
        /// <returns>The message content</returns>
        public string GetMessage(string userName)
        {
            string messageContent = string.Empty;

            if (recipients.ContainsKey(userName))
            {
                Client client = recipients[userName];

                messageContent = client.DequeueMessage().MessageContent;
            }

            return messageContent;
        }

        /// <summary>
        /// Join a user to the recipient list.
        /// </summary>
        public void Join(string userName)
        {
            recipients[userName] = new Client();
        }

        /// <summary>
        /// Singleton pattern.
        /// This pattern will ensure there is only one instance of this class in the system.
        /// </summary>
        public static ClientAdapter Instance = new ClientAdapter();
        private ClientAdapter() { }
    } 
```

发送消息：

```
 Message message = new Message
                                      {
                                          RecipientName = tbRecipientName.Text.Trim(),
                                          MessageContent = tbMessageContent.Text.Trim()
                                      };

                if (!string.IsNullOrWhiteSpace(message.RecipientName) && !string.IsNullOrEmpty(message.MessageContent))
                {
                    // Call the client adapter to send the message to the particular recipient instantly.
                    ClientAdapter.Instance.SendMessage(message);
} 
```

接收消息（这是在测试页面中编写的 JavaScript 函数。它们在 ASPX 页面上呈现消息的内容。在这里你应该实现你的逻辑）：

```
 // This method will persist a http request and wait for messages.
        function waitEvent() {

            CSASPNETReverseAJAX.Dispatcher.WaitMessage("<%= Session["userName"] %>", 
            function (result) {

                displayMessage(result);

                // Keep looping.
                setTimeout(waitEvent, 0);
            }, function () {

                // Keep looping.
                setTimeout(waitEvent, 0);
            });
        }

        // Append a message content to the result panel.
        function displayMessage(message) {
            var panel = document.getElementById("<%= lbMessages.ClientID %>");

            panel.innerHTML += currentTime() + ": " + message + "<br />";
        }

        // Return a current time string.
        function currentTime() {
            var currentDate = new Date();
            return currentDate.getHours() + ":" + currentDate.getMinutes() + ":" + currentDate.getSeconds();
        } 
```

# overflow - Facebook 评论框不会在可滚动的 div 中滚动

> ID：12239583
> 
> 赞同：1
> 
> 时间：2012-09-02T20:40:48.320
> 
> 标签：overflow, parent-child, facebook-comments

我正在一个网站上工作，该网站在`div`( `div id="article"`) 中包含一个 facebook 评论框，该评论框具有一个`overflow="auto"`属性。文章正文滚动，但评论框延伸到 Internet Explorer 中的 div 之外（我使用 IE9）。它在 FF 和 Chrome 中按预期工作。

# python-3.x - 将变量插入“b”字节

> ID：12239584
> 
> 赞同：0
> 
> 时间：2012-09-02T20:40:50.170
> 
> 标签：python-3.x, base64, byte

这是我当前的代码：

```
 encodedstring = base64.encodestring(b"admin:password")[:-1] 
```

现在我想为用户名和密码使用变量，像这样？

```
 username = "admin"
  password = "password"
  user_pass = username + ":" + password

  user_pass = b"user_pass <<<<?
  encodedstring = base64.encodestring(user_pass)[:-1] 
```

我怎样才能做到这一点？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T21:05:57.723

```
base64.b64encode((user + ':' + password).encode('utf-8')) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T21:35:55.770

嗯，像这样？

```
username = b"admin"
password = b"password"
user_pass = username + b":" + password

encodedstring = base64.encodestring(user_pass)[:-1] 
```

或者你是说用户名和密码来自某个给你字符串的地方？

在这种情况下，对它们进行编码。

```
username = get_username().encode('UTF8')
password = get_password().encode('UTF8')
user_pass = username + b":" + password 
```

使用 UTF-8 以便非 ascii 字符也能正常工作。

# php - 如何在 Symfony2 中获取页面渲染时间和数据库查询数

> ID：12239591
> 
> 赞同：2
> 
> 时间：2012-09-02T20:41:29.240
> 
> 标签：php, symfony

我需要在我的第 2 页信息的页脚中显示：

*   渲染时间
*   数据库查询数

在 app_dev.php 中，这些信息位于页面底部的调试工具栏中。任何人都知道如何在“产品”环境中获取这些信息？

编辑：我找到了我的第一个问题的解决方案 - 渲染时间 - 在[这个](https://stackoverflow.com/questions/10211457/symfony2-get-execution-time)问题下

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T22:09:04.347

这在 /app/AppKernel.php 中是可能的

只需添加`new Symfony\Bundle\WebProfilerBundle\WebProfilerBundle();`到 $bundles 数组。

*你会看到里面也一样 `if (in_array($this->getEnvironment(), array('dev', 'test')))`*

# javascript - 是什么阻止了技能 [id].Value 的增加？(Javascript)

> ID：12239593
> 
> 赞同：0
> 
> 时间：2012-09-02T20:41:44.640
> 
> 标签：javascript

如果我创建一个名为“Level 0”的按钮，并且 onmousedown 我让它运行 learnSkill(3)，它只会将技能 [3].Value 增加到 1，然后它会点击但什么也不做，为什么？

我正在尝试编写技能树，由于此类问题，我还没有走得很远，所以它大部分是空的。

```
    var 技能 = 新数组（）；

    功能技能（值，名称，类型，层，列，信息，要求）{
        this.Value = 价值；
        this.Name = 名称；
        this.Type = 类型；
        this.Tier = 层；
        this.Column = 列；
        this.Info = 信息；
        this.Req = 要求；
        //技能[id].Req
    }

    函数 SkillReq(id, amount, reqby) {
        这个.Id = id;
        this.Amount = 金额；
        this.By = reqby;
        //技能[id].Req.Id
        //skill[id].Req.Amount
        //skill[id].Req.By
    }

    Skill[1] = new Skill(0, "Unholy Sphere", "Tree 2", 0, 1, new Array(), new SkillReq(0, 0, 3));
    Skill[3] = new Skill(0, "Dark Circle", "Tree 2", 1, 0, new Array(), new SkillReq(1, 3, 0));

    函数可以学习（id）{
        警报（“在可以学习”）；
        可以学习=真；
        返回可以学习；
    }

    函数canUnlearn（id）{

    }

    功能学习技能（ID）{
        警报（“身份证：”+身份证）；
        如果（！canLearn（id））{
            alert("无法学习");
            返回;
        }
        // 增加当前技能值
        技能[id].Value++；
        警报（技能[id].Value）；
        // 总SP--; 减少totalSP，必须先声明
        // 更新按钮以显示新级别的技能值
        document.getElementById(id).value = "等级"+skill[id].Value;
    }

    函数unlearnSkill（id）{
        如果（！canUnlearn（id））{
            返回;
        }
    }

    功能 onClickTalent(id) {

    }

    函数 rmbDown(e)
    {
        var isRMB = false;
        e = e || 窗口.事件；
        如果（例如哪个）
            isRMB = (e.which == 3);
        else if (e.button)
            isRMB = (e.button == 2);
        返回是RMB；
    }

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T20:48:34.307

我不确定您要做什么，但这是一个问题：

```
function canLearn(id) {
    alert("in canlearn");
    canLearn = true;
    return canLearn;
} 
```

该函数将在第一次调用时“自毁”，因为您将全局符号“canLearn”设置为`true`. 麻烦的是，“canLearn”已经被使用了——作为那个函数的名字！因此，后续调用“canLearn”的尝试将失败，因为它的值不再是函数对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T20:48:49.137

您正在覆盖其中的`canLearn`函数，`canLearn`分配给 true 的标识符是函数本身，要在函数范围内创建新变量，请使用 var 关键字

```
function canLearn(id) {
    alert("in canlearn");
    var canLearn = true;
    return canLearn;
} 
```

# java - 如何在 Vaadin 的表单中绑定 LazyQueryContainer 和 Combobox？

> ID：12239596
> 
> 赞同：1
> 
> 时间：2012-09-02T20:42:14.950
> 
> 标签：java, combobox, datasource, vaadin

我目前正在使用 Vaadin 6.8.1 + Spring 3 的项目，该项目结构为调用 Spring 服务（以及后面的 Hibernate）的 Vaadin 接口。

感谢 LazyQueryContainer (LQC)，我可以从服务中加载我的数据并将其显示在 Vaadin 表和组合框中。在这一点上，一切都很好。但是，我有一个包含组合框的表单，其中包含来自 LQC 的数据，当调用表单的 setItemDataSource 方法时，它没有正确选择正确的项目。

例如，我的应用程序管理数据库中的人员和公司列表。有 2 个类：Person 和 Company。这种关系就像一个人是一家公司的成员一样简单。因此，Person 类有一个 Company 类型的字段 company。现在，我有一个管理人员的 Vaadin 表单。在这个表格中是一个组合框，显示数据库中的所有公司，所选公司是该人注册的公司。

由于我的应用程序是按服务划分的，因此我不能使用 JPAContainer 或 HibernateContainer 直接访问我的数据。然后我选择了带有 AbstractBeanQuery 的 LazyQueryContainer。我为 Person 和 Company 类创建了一个数据源，它们在表格和组合框中正确显示。Vaadin 表单还在文本输入中正确显示人员的字符串字段。

但是，我想使用组合框而不是默认文本框来管理公司字段。因此，我实现了一个 FormFieldFactory 并将该字段绑定到组合框。确实没有更多的默认公司文本框，这意味着绑定正在工作，但组合框中的选定值是空白（null）。

我在 Company 类中实现了 equals 和 hashcode 方法，但它没有改变任何东西。我还认为我应该在组合框中加载所有数据（因为项目数量很少），但我不知道如何从 LQC 对象中手动获取对象。没有源代码，就无法调试。

任何帮助都会非常受欢迎。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T10:28:32.220

我认为您的问题是`LazyQueryContainer`用作`Long`项目 ID，但 Vaadin 表单正试图将您设置`Company`为组合框值。由于此 id（`Company`实例）不是`LazyQueryContainer`id 列表的一部分，因此选择保持为空。

您需要首先找出分配给它的您的 id `Company`，`LazyQueryContainer`然后将该值设置为组合框。您还需要创建一个自定义字段和子类，`ComboBox`以便您可以`setValue`在表单调用它时进行处理。

旁注：Vaadin`BeanItemContainer`使用您的 JavaBean 作为它的项目 ID。这就是为什么`myCombo.setValue (myCompany)`有效。

# mysql - 如何为每个日期返回一行，即使该日期没有数据（在这种情况下，该行应该用零填充）？

> ID：12239597
> 
> 赞同：0
> 
> 时间：2012-09-02T20:42:18.097
> 
> 标签：mysql, coalesce

我希望我能把我的问题说清楚。

我有一个名为的表`tweets`，我想从中提取`daterange`表中每个数据的信息。该表包含 142 个日期，其中 102 个日期的属性`trading`（开市日）设置为 1 ( `trading=1`)。

下面的查询从`tweets`表中提取 20 家公司（用 标识`sp100_id`）的信息。因此，预期的结果集包含 20 x 102 = 2,040 行。**但是**，我只返回了 1,987 行，因为对于某些日期公司组合，该`tweets`表不包含任何数据。但是，我需要将这些“空天”包含在结果集中。我想我可以通过使用`COALESCE(X, 0)`,`0`如果没有数据就返回，但结果是一样的：1,987 行。

根据这些信息和下面的查询，有人知道我如何让它为表中的每个返回 102 行（每个`daterange._date`带有1 行`trading=1`）吗？`sp100_id``tweets`

```
SELECT
  sp100.sp100_id,
  daterange._date,
  COALESCE(SUM(IF(tweets.classify1=2, tweets.`retweet_count`, 0)),0) AS `pos-retweet`,
  COALESCE(SUM(IF(tweets.classify1=2, tweets.`user-quality`,  0)),0) AS `pos-quality`,
  COALESCE(SUM(IF(tweets.classify1=2, tweets.`follow`,        0)),0) AS `pos-follow`,
  COALESCE(SUM(IF(tweets.classify1=3, tweets.`retweet_count`, 0)),0) AS `neg-retweet`,
  COALESCE(SUM(IF(tweets.classify1=3, tweets.`user-quality`,  0)),0) AS `neg-quality`,
  COALESCE(SUM(IF(tweets.classify1=3, tweets.`follow`,        0)),0) AS `neg-follow`
FROM
  sp100
CROSS JOIN
  daterange
LEFT JOIN
  tweets
  ON tweets.nyse_date = daterange._date
  AND tweets.sp100_id  = sp100.sp100_id
WHERE sp100.sp100_id BETWEEN 1 AND 20 AND tweets.type != 1 AND daterange.trading = 1
GROUP BY
  sp100.sp100_id, daterange._date 
```

在任何其他情况下，我都会为您提供一个 SQLFiddle，但是要导出用于 SQLFiddle 的表的适当部分将是很多工作，而解决方案可能对一些真正的 SQL 大师来说是清楚的 :-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T00:01:15.283

问题来自`tweets.type != 1`在您的`WHERE`条款中要求。

对于没有关联推文的日期，外部连接将导致所有`tweets`列，包括`tweets.type`、`NULL`。如[使用`NULL`值](http://dev.mysql.com/doc/en/working-with-null.html)下所述：

> 因为任何算术比较的结果`NULL`也是`NULL`，所以您无法从此类比较中获得任何有意义的结果。
> 
> 在 MySQL 中，`0`or`NULL`表示 false，其他任何表示 true。布尔运算的默认真值是`1`.

因此，此类记录由您的`WHERE`子句过滤。

正如[@Martin Smith 评论](https://stackoverflow.com/questions/12239597/how-can-i-return-a-row-for-each-date-even-when-there-is-no-data-for-that-date#comment16404545_12239597)的那样，您可以将此过滤条件移动到`ON`外部联接的子句中（以便仅针对实际`tweets`记录而不是模拟记录执行测试`NULL`）。

或者，您可以重写过滤器以处理`NULL`. 例如，使用[`NULL`-safe 相等运算符](http://dev.mysql.com/doc/en/comparison-operators.html#operator_equal-to)：

```
NOT tweets.type <=> 1 
```

顺便说一句，我通常不关心`daterange`表格，而是省略结果集中没有数据的日期：相反，我在我的应用程序代码中处理丢失的日期。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T20:52:02.997

您需要一个充满每一天的日历表。我知道这听起来可能很傻，但是这个解决方案可以解决很多问题。整数也可以使用相同的解决方案（整数表）

# c++ - 我不明白如何将变量从一个类中的方法传递和检索到另一个类中的另一个方法

> ID：12239598
> 
> 赞同：0
> 
> 时间：2012-09-02T20:42:26.160
> 
> 标签：c++, oop, default-constructor

我正在开发 OOP C++ 程序，但我有点挣扎。我正在尝试创建一个程序来演示默认和非默认构造函数和指针的使用。我正在尝试先做默认构造函数。

所以我只能在一种方法中存储和检索局部变量。但是现在我必须将值传递给其他类（我想我必须），然后再次检索信息但几乎没有修改。

我可以像我一样将对象初始化为一个类，但是当我尝试检索对象时，它基本上只检索空白空间。如何正确地将对象传递给另一个类中的方法，然后将其取回？

任何指针？

书本.cpp

```
#include <iostream>
#include <sstream>
using namespace std;

#include "Book.h"

Book::Book()
{
}

void Book::setTitle(string  title)
{
    this->title = title;
}

void Book::setAuthorName(string first, string last)
{
    Author author;

    author.setFirstName(first);
    author.setLastName(last);
}

void Book::setPrice(double price)
{
    this->price = price;
}

string Book::convertDoubleToString(double number)
{
    return static_cast<ostringstream*>( &(ostringstream() << number) ) -> str();
}

string Book::getBookInfo()
{
    stringstream ss;
    Author author;

    ss << title << endl << author.getFullName() << endl << "$" << convertDoubleToString(price) << endl;

    return ss.str();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T20:46:59.310

这部分不起作用

```
void Book::setAuthorName(string first, string last)
{
    Author author;

    author.setFirstName(first);
    author.setLastName(last);
} 
```

因为在这个函数中你创建了一个本地对象，设置它的值，然后在函数退出时销毁它。`Author`如果要保留此作者信息，则需要在 Book 类中创建类的成员变量。

在你的 Book 类声明中，你需要这样的东西

```
class Book {
    Author m_Author;  // This is your member variable that you can store author data in

}; 
```

然后在你的`setAuthorName`函数中，设置`m_Author`而不是创建局部变量的值。这将保留成员变量中的值`m_Author`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T20:50:12.270

作者属于本书。您必须在类 Book 的构造函数中声明它，这样只要书存在，它就会存在。

您在方法中声明它，因此它仅在方法执行期间存在。

```
void Book::setAuthorName(string first, string last)
{
    Author author;
    ...
} 
```

这是一个范围问题。

# r - 扩展轴的比例

> ID：12239602
> 
> 赞同：2
> 
> 时间：2012-09-02T20:13:50.953
> 
> 标签：r, data-visualization

我在 R 中生成了以下直方图：

![直方图](../Images/ab8b28d3fbf5e9b0101f113867d674b1.png)

我使用这个`hist()`调用生成了它：

```
hist(x[,1], xlab='t* (Transition Statistic)',
     ylab='Proportion of Resamples (n = 10,000)',
     main='Distribution of Resamples', col='lightblue',
     prob=TRUE, ylim=c(0.00,0.05),xlim=c(1725,max(x[,1])+10)) 
```

加上以下内容`abline()`：

```
abline(v=1728,col=4,lty=1,lwd=2) 
```

该垂直线表示测试统计的实际位置，我将其与排列样本的结果进行比较。

我的问题是：如您所见，x 刻度没有延伸回垂直线。我真的很希望这样做，因为我认为否则它看起来很奇怪。我怎样才能做到这一点？

参数我已经试过了`xaxs="i"`，没有效果。我也尝试过制作自己的轴，`axis()`但这需要从头开始重新制作两个轴，结果对我来说看起来不太好。所以，我怀疑必须有一种更简单的方法来做到这一点。有没有？而且，如果没有，任何人都可以建议什么`axis()`命令可能会很好，假设我希望一切看起来基本相同，但 x 比例尺更长？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-02T20:51:25.553

通常的 R 绘图在绘图周围绘制一个框架。要添加它，请执行以下操作：

```
box() 
```

剧情之后。

如果这不是您想要的，您需要抑制轴绘图，然后再添加自己的绘图。

```
hist(...., axes = FALSE) ## .... is where your other args go
axis(side = 2)
axis(side = 1, at = seq(1730, 1830, by = 20)) 
```

这不会完全接近垂直线，但可能足够接近。如果您想在垂直线上打勾，请选择不同的刻度线，例如

```
axis(side = 1, at = seq(1725, 1835, by = 20)) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-03T01:24:06.640

由于 R 在这里使用 20 的间隙作为 x 轴，因此您可以使用 1720 而不是 1725 作为下限来获得所需的扩展，即使用`xlim=c(1720,max(x[,1])+10)`它会产生类似

![在此处输入图像描述](../Images/7faa0f67e908c55a44bd4a14cdc64fc6.png)

# asp.net-mvc - 自动捆绑/缩小在 MVC 4 的最终版本中被抛弃了吗？

> ID：12239603
> 
> 赞同：4
> 
> 时间：2012-09-02T20:43:09.553
> 
> 标签：asp.net-mvc, asp.net-mvc-4, asp.net-optimization, bundling-and-minification

根据[我之前阅读的 Scott Guthrie 的一篇文章](http://weblogs.asp.net/scottgu/archive/2011/11/27/new-bundling-and-minification-support-asp-net-4-5-series.aspx)和[Mads Kristensen 发布的视频](http://www.asp.net/web-forms/videos/aspnet-vnext/aspnet-vnext-videos-bundling-and-minification)，我应该能够通过替换以下内容在 ASP.net MVC 4 中自动捆绑/缩小：

```
<link href="Styles/reset.css" rel="stylesheet" type="text/css" />
<link href="Styles/normalize.css" rel="stylesheet" type="text/css" />
<link href="Styles/styles.css" rel="stylesheet" type="text/css" />

<script src="Scripts/jquery-1.8.0.min.js" type="text/javascript"></script>
<script src="Scripts/jquery-validation.min.js" type="text/javascript"></script> 
```

有了这个：

```
<link href="Styles/css" rel="stylesheet" type="text/css" />

<script src="Scripts/js" type="text/javascript"></script> 
```

我尝试同时针对 .Net 4.0 和 4.5，但似乎没有什么不同。我收到 404 错误，并且链接和脚本标签永远不会指向捆绑的资源。

此功能是否已从最终版本中删除？

我想将此功能用于“主题”。

* * *

这就是我最终实施的方式。希望这是有道理的...

```
 /// <summary>
 /// Render stylesheets HTML for the given theme. Utilizes System.Web.Optimization for bundling and minification
 /// </summary>
 /// <param name="themeName">Name of theme</param>
 /// <returns>HtmlString containing link elements</returns>
 public static IHtmlString RenderThemeStyles(string themeName)
 {
     IHtmlString retValue = null;

     // If no theme name is passed, return null
     if (!themeName.HasValue())
         return retValue;

     var ctxt = HttpContext.Current;
     string themePath = "~/Themes/" + themeName;
     string themeKey = themePath + "/css";

     if (ctxt.Cache[themeKey] != null)
         return (IHtmlString)ctxt.Cache[themeKey];

     // Check to see if the theme directory exists. Throw error if it does not
     string themeSysPath = HttpContext.Current.Server.MapPath(themePath);
     DirectoryInfo themeDir = new DirectoryInfo(themeSysPath);
     if (!themeDir.Exists)
         throw new ApplicationException(string.Format("Theme directory \"{0}\" does not exist", themePath));

     // Remove the old bundle if it already exists
     var old_bundle = BundleTable.Bundles.FirstOrDefault(b => b.Path == themeKey);
     if (old_bundle != null)
         BundleTable.Bundles.Remove(old_bundle);

     if (themeDir.GetFiles("*.css").Length > 0)
     {
         // If there are css files, add them to the bundler and save the rendered output to cache
         Bundle styles = new StyleBundle(themeKey).IncludeDirectory(themePath, "*.css");
         BundleTable.Bundles.Add(styles);
         retValue = Styles.Render(themeKey);
         ctxt.Cache.Insert(themeKey, retValue, new System.Web.Caching.CacheDependency(themeSysPath));
     }
     else
     {
         // If there are no css files, save empty string to cache
         ctxt.Cache.Insert(themeKey, new HtmlString(string.Empty), new System.Web.Caching.CacheDependency(themeSysPath));
     }

     return retValue;
 } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-03T05:33:15.783

是的，这个功能在 MVC4 RC 版本中被删除了，尽管我再也找不到 RC 发行说明了。

Rick Anderson 关于[将 MVC4 beta 升级到 RC](http://blogs.msdn.com/b/rickandy/archive/2012/06/12/asp-net-mvc-4-beta-to-mvc-rc-upgrade-instructions.aspx)的博文描述了这个过程：

删除“自动捆绑”引用并`BundleConfig.cs`使用您的捆绑配置创建/复制 a 并从 Global.asax 中调用它`BundleConfig.RegisterBundles(BundleTable.Bundles);`。

Hanselman 提到了有关该决定的一些[背景信息：](http://www.hanselman.com/blog/VisualStudio2012RCIsReleasedTheBigWebRollup.aspx)

> 自测试版以来，Web 优化（缩小和捆绑）框架发生了一些重大变化。对捆绑的内容和 beta 中的顺序没有足够的控制，所以它被移到了 BundleConfig.cs（或 .vb）中，你可以完全控制

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-04T09:38:51.240

不完全是，所以我们删除`EnableDefaultBundles`了您所说的“自动捆绑”，但底层功能仍然存在。

您可以通过注册来执行与该方法相同的操作：

```
BundleTable.Bundles.Add(new DynamicFolderBundle("js", "*.js");
BundleTable.Bundles.Add(new DynamicFolderBundle("css", "*.css"); 
```

我们删除了该方法，因为这是一种相当有问题的方法，因为字母顺序通常不是所需的顺序。

# c# - 从 Threadpool 访问 WebBrowser

> ID：12239604
> 
> 赞同：3
> 
> 时间：2012-09-02T20:43:16.510
> 
> 标签：c#, webbrowser-control, threadpool, invokerequired

我正在尝试从另一个线程访问网络浏览器上的信息。尝试访问时`browser.DocumentTitle`，我收到此错误：

`The name DocumentTitle does not exist in the current context`

我可以成功导航到`DoWork`or`ProcessWebPage`方法中的网页，但我无法在`GetTitle`不崩溃的情况下访问该功能。几天来，我一直在独自研究这一部分，根本无法弄清楚。

这是问题代码：

浏览器代码

```
class BrowserInterface : Form
{
    WebBrowser browser;
    Thread thread;

    State state;

    public State State { get { return state; } }

    public BrowserInterface()
    {
        Initialize();
    }

    void Initialize()
    {
        browser = new WebBrowser();
        state = State.Null;
        state = State.Initializing;
        thread = new Thread(StartThread);
        thread.SetApartmentState(ApartmentState.STA);
        thread.Start();

        while (state == State.Initializing) Thread.Sleep(20);
    }

    void StartThread()
    {
        browser = new WebBrowser();
        browser.Dock = DockStyle.Fill;
        browser.Name = "webBrowser";
        browser.ScrollBarsEnabled = false;
        browser.TabIndex = 0;
        browser.DocumentCompleted +=
            new WebBrowserDocumentCompletedEventHandler(this.Web_Completed);
        Form form = new Form();
        form.Controls.Add(browser);
        form.Name = "Browser";
        state = State.Null;
        Application.Run(form);
    }

    public void Navigate(string url)
    {
        state = State.Navigating;
        if (browser.IsDisposed)
            Initialize();
        browser.Navigate(url);
    }

    public string GetTitle()
    {
        if (InvokeRequired)
        {
            BeginInvoke(new MethodInvoker(() => GetTitle()));
        }
        return browser.DocumentTitle;
    }

    private void Web_Completed(object sender, WebBrowserDocumentCompletedEventArgs e)
    {
        var br = sender as WebBrowser;
        if (br.Url == e.Url)
            state = State.Completed;

    }
}

enum State
{
    Initializing,
    Null,
    Navigating,
    Completed
} 
```

其他线程

```
class Controller
{
    public int ThreadsAllowed;

    private ManualResetEvent[] resetEvent;
    private BrowserInterface[] browser;

    static Thread mainThread;

    bool run;
    bool exit;

    public Controller(int threadsAllowed)
    {
        ThreadsAllowed = threadsAllowed;

        resetEvent = new ManualResetEvent[ThreadsAllowed];
        browser = new BrowserInterface[ThreadsAllowed];

        for (int i = 0; i < ThreadsAllowed; i++)
        {
            resetEvent[i] = new ManualResetEvent(true);
            browser[i] = new BrowserInterface();
        }

        ThreadPool.SetMaxThreads(ThreadsAllowed, ThreadsAllowed);

        mainThread = new Thread(RunThread);
        mainThread.Start();

        run = false;
        exit = false;
    }

    public void Run()
    {
        run = true;
    }

    void RunThread()
    {
        while (true)
        {
            while (!run) Thread.Sleep(20);
            while (mode == ScoutMode.Off) Thread.Sleep(100);

            //wait for the last set to complete
            WaitHandle.WaitAll(resetEvent);
            if (exit)
                break;

             for (int i = 0; i < ThreadsAllowed; i++)
             ThreadPool.QueueUserWorkItem(DoWork, i);             
        }
    }

    void DoWork(object o)
    {
        int i = (int)o;
        if(browser[i].state == State.null)
        {
            …
            … navigation code that works …
            …
            return;
        }
        else if(browser[i].state == State.Completed)    
            ProcessWebPage(i);         

    }

    void ProcessWebPage(int i)
    {
        string title;
        try
        {
            title = browser[i].GetTitle();
        }
        catch { return; }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T21:16:54.283

伤害我的眼睛是你的`GetTitle`功能。使用时`MethodInvoker`，您正在处理`void`类型的方法，也就是说，您无法从函数中获取返回值。这就是为什么您需要一个可以返回值的委托的原因。

此外，您必须有`else`声明，因此实际上需要在调用时不要尝试返回值。

```
class BrowserInterface : Form
{
    /* ... */

    private delegate string StringDelegate();

    public string GetTitle()
    {
        /*
        if (InvokeRequired)
        {
            BeginInvoke(new MethodInvoker(() => GetTitle()));
        }
        return browser.DocumentTitle;
        */

        if (InvokeRequired)
        {
            object result = Invoke(new StringDelegate(GetTitle));
            return (string)result;
        }
        else
            return browser.DocumentTitle;
    }

    /* ... */
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T21:15:23.607

首先，使用浏览器调用而不是表单。调用后您将返回代码并尝试访问 browser.DocumentTitle 作为后台线程的主要问题。为避免这种情况，请添加 else 构造。

```
public string GetTitle()
{
    if (this.browser.InvokeRequired)
    {
        this.browser.Invoke(new MethodInvoker(() => GetTitle()));
    }
    else
    {
        return browser.DocumentTitle;
    }
} 
```

# objective-c - 一个 IBAction 多个按钮和标签

> ID：12239615
> 
> 赞同：0
> 
> 时间：2012-09-02T20:45:52.530
> 
> 标签：objective-c, xcode

我有一个标签，两个按钮。从标签一到 +1 和一到 -1。

我使用以下代码：

。H

```
 int counter;

    IBOutlet UILabel *count;
}

-(IBAction)plus:(id)sender;
-(IBAction)minus:(id)sender; 
```

.m

```
-(IBAction)plus {

    counter=counter + 1;

    count.text = [NSString stringWithFormat:@"%i",counter];

}

-(IBAction)minus {

    counter=counter - 1;

    count.text = [NSString stringWithFormat:@"%i",counter];

} 
```

这两个按钮链接到 IB 中的标签（计数）。现在我的问题。如果我想要更多这样的按钮和标签，我该怎么做？我知道我可以复制代码并在 IB 中重新链接它们，但这需要很长时间。当按钮链接到计数标签时，仅在 IB 中复制它们是行不通的，按钮有效，但它计算第一个标签。我需要计算每个标签。

那么，我怎样才能做到这一点并节省时间呢？会有很多这样的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T20:55:33.620

您可以连续生成按钮，将它们存储在 NSArray 中，并对标签执行相同操作。然后，您可以使用它们在数组中的索引来关联它们。

```
// Assuming a view controller
@interface MyVC: UIViewController {
    NSMutableArray *buttons;
    NSMutableArray *labels;
}

// in some initialization method
buttons = [[NSMutableArray alloc] init];
labels = [[NSMutableArray alloc] init];
for (int i = 0; i < numberOfButtonsAndLabels; i++) {
    UIButton *btn = [UIButton buttonWithType:UIButtonTypeRoundedRect];
    // configure the button, then
    [self.view addSubview:btn];
    [buttons addObject:btn];

    UILabel *lbl = [[UILabel alloc] initWithFrame:aFrame];
    // configure the label, then
    [self.view addSubview:lbl];
    [labels addObject:lbl];
    [lbl release];
}

- (void)buttonClicked:(UIButton *)sender
{
    NSUInteger index = [buttons indexOfObject:sender];
    UILabel *label = [labels objectAtIndex:index];

    // use index, sender and label to do something
} 
```

# javascript - ListView 的 ItemTemplate 中自定义 HtmlControl 的数据绑定失败

> ID：12239619
> 
> 赞同：1
> 
> 时间：2012-09-02T20:46:43.810
> 
> 标签：javascript, microsoft-metro, winjs

我有一个在 ListView 上设置的 ItemTemplate：

```
<div class="commentTileTemplate" data-win-control="WinJS.Binding.Template">
    <div class="commentTileControl" data-win-control="WinJS.UI.HtmlControl" data-win-options="{uri: '/htmlControls/commentTile/commentTile.html'}"></div>
</div> 
```

HtmlControl 内部的数据绑定在第一次显示 ListView 时无法绑定，在连续运行时，它工作正常。

如果我从 ListView 中删除模板，那么原始数据会按预期显示，只有在添加 HtmlControl 时它才会首先失败。

知道可能出了什么问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T22:48:47.353

这是因为第一次加载控件时，页面是通过`WinJS.xhr`包中的 XHR ( ) 异步加载的。这意味着当第一次`WinJS.Binding.process()`发生在`WinJS.Binding.Template.render`函数中时，实际内容不会被加载。（例如，它的查询选择器看不到任何`data-win-bind`属性。

第二次，因为你正在加载的片段已经在片段缓存中，它实际上是*同步*渲染到 DOM中并且`WinJS.Binding.Template.render`'s`WinJS.Binding.processAll`看到了这些`data-win-bind`属性。

这为您提供了一些选择：

1.  在您的应用程序启动后立即预加载片段`WinJS.UI.Fragments.cache()`，并且在该片段完成之前不要在列表视图上设置数据
2.  仅`HtmlControl`在您的项目被渲染时实例化，然后在加载时以编程方式实例化`HtmlControl`, 和`WinJS.Binding.process[All]()`加载的模板 [1]
3.  实际上使模板成为您的内容，然后加载片段，处理控件。这比看起来容易，但可能需要一些时间来考虑。简而言之：加载片段，在片段上为您拥有的元素查询选择器`data-win-control`，`WinJS.UI.process()`然后将模板实例返回给调用者并将其用作列表视图上的 itemTemplate

[1] HtmlControl 构造函数采用第三个参数，这是在加载片段时调用的回调。

# ruby-on-rails - cname 重定向导致 Heroku 中的网络钓鱼警告

> ID：12239620
> 
> 赞同：5
> 
> 时间：2012-09-02T20:46:46.803
> 
> 标签：ruby-on-rails, heroku, dns

[我按照此链接https://devcenter.heroku.com/articles/custom-domains](https://devcenter.heroku.com/articles/custom-domains)中的概述更改了我的 CNAME 记录。重定向本身有效，问题出在 Chrome 中（我假设其他浏览器）它给了我一个网络钓鱼警报。

> 这可能不是您要找的网站！
> 
> 您试图访问 app.grewpr.com，但实际上您访问了一个服务器，我将自己标识为 *.herokuapp.com。这可能是由于服务器上的错误配置或更严重的原因造成的。您网络上的攻击者可能正试图让您访问 app.grewpr.com 的虚假（并且可能有害）版本。
> 
> 您不应该继续，特别是如果您以前从未看到此站点的此警告。

我将如何解决此错误？它还在 https 锁上划了一条红线。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T22:42:31.010

由于您使用的是 HTTPS，因此您应该遵循稍微不同的 DNS 配置说明：[https ://devcenter.heroku.com/articles/ssl#configuredns](https://devcenter.heroku.com/articles/ssl#configuredns)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-21T17:32:19.927

有同样的问题。您的自定义域应用程序使用您的主机证书。无论是购买 SSL 插件还是“http”对您来说都可以，然后更改您的应用程序的 ssl 设置。在“environments/production.rb”中必须有以下配置“ **config.force_ssl = false** ”，默认设置为true。必须重置 Firefox 才能生效。其他浏览器正常。

# internationalization - 带有 autoconf 生成的 .desktop 文件的 Intltool

> ID：12239624
> 
> 赞同：2
> 
> 时间：2012-09-02T20:47:40.673
> 
> 标签：internationalization, gettext, gnome, autoconf, automake

在[Emperor](https://github.com/tjol/emperor)项目中，在进行树外构建时，让 intltool 工作时遇到了一些问题。当运行`make check`out-of-tree 时，这是其中一件事`make distcheck`，intltool 会因此失败：

```
INTLTOOL_EXTRACT="/usr/bin/intltool-extract" XGETTEXT="/usr/bin/xgettext" srcdir=../../po /usr/bin/intltool-update --gettext-package emperor --pot
can't open ../../po/../data/emperor.desktop.in: No such file or directory at /usr/bin/intltool-extract line 212. 
```

intltool 正在源代码树中查找`emperor.desktop.in`中列出的。`po/POTFILES.in`但是，`emperor.desktop.in`它是由名为 的文件的配置脚本生成的`emperor.desktop.in.in`，以便插入用户配置的已安装可执行路径，并位于构建树中。

这些是相关的`bootstrap.sh`行：

```
echo +++ Running intltoolize ... &&
intltoolize --force --copy &&
cat >>po/Makefile.in.in <<EOF

../data/_column_names.h:
    cd ../data && \$(MAKE) _column_names.h

EOF 
```

中的设置代码`configure.ac`：

```
IT_PROG_INTLTOOL([0.35.0])

GETTEXT_PACKAGE=emperor
AC_SUBST(GETTEXT_PACKAGE)
AC_DEFINE_UNQUOTED([GETTEXT_PACKAGE], ["$GETTEXT_PACKAGE"],
                                      [The domain to use with gettext])
AM_GLIB_GNU_GETTEXT 
```

`data/emperor.desktop.in`列在`AC_CONFIG_FILES`.

`data/Makefile.am`包含这些行：

```
desktopdir = $(datadir)/applications
desktop_in_files = emperor.desktop.in
desktop_DATA = $(desktop_in_files:.desktop.in=.desktop)
@INTLTOOL_DESKTOP_RULE@ 
```

并`po/POTFILES.in`包含该行

```
data/emperor.desktop.in 
```

如果您愿意，可以查看[公共 git 存储库中的所有详细信息。](https://github.com/tjol/emperor)

**我可以以某种方式告诉 intltool 该文件将位于构建树中，而不是源代码树中吗？**否则，我的选择似乎是中断`make distcheck`（不是一个很好的选择），或者发送一个不包含完整路径并假设可执行文件安装在 PATH 中的桌面文件。（就像凌乱的，恕我直言） - 还有其他选择吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T22:17:19.767

在您的源代码中，您拥有`emperor.desktop.in.in`，它似乎没有在任何规则中作为依赖项。该文件必须先转换为`emperor.desktop.in`，然后再转换为`emperor.desktop`，您的`data/Makefile.am`.

```
desktopdir = $(datadir)/applications
desktop_in_in_files = emperor.desktop.in.in
desktop_in_files = $(desktop_in_in_files:.desktop.in.in=.desktop.in)
desktop_DATA = $(desktop_in_files:.desktop.in=.desktop)
@INTLTOOL_DESKTOP_RULE@

[...]
EXTRA_DIST =  \
    $(desktop_in_in_files) \
    [...] 
```

`$(desktop_in_in_files)`contains `$(desktop_in_in_files)`，并且 Makefile 将知道如何处理它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T21:41:39.753

一些进一步的挖掘让我相信答案是：intltool 不支持不是项目中源文件的源文件。因此，任何额外的处理都必须在 intltool 完成后进行

Intltool 要求输入的行`POTFILES`与（构建时）工作目录相关。该文件`POTFILES`由配置脚本生成，使用在autoconf 宏中定义`POTFILES.in`的简单脚本（由 调用）简单地将顶级源目录的相对位置添加到路径中。唉，修改无济于事：脚本尽其所能来正确地获取源目录。我不相信在不修改 intltool 本身的情况下可以支持有时在源树内部和有时在源树之外的文件。`sed``IT_PO_SUBDIR``IT_PROG_INTLTOOL``POTFILES``intltool-extract`

# java - 为什么/何时添加 inputMismatchException？

> ID：12239629
> 
> 赞同：0
> 
> 时间：2012-09-02T20:48:14.213
> 
> 标签：java, exception, exception-handling

这是一个代码示例。如果我要输入分子：5 和分母：0

我得到一个这样的例外：

```
Exception in thread "main" java.lang.ArithmeticException: / by zero
at ExceptionHandling.DivideByZeroExceptions.quotient(DivideByZeroExceptions.java:10)
at ExceptionHandling.DivideByZeroExceptions.main(DivideByZeroExceptions.java:22) 
```

我知道我必须包含（抛出算术异常）但是，我怎么知道我需要使用 inputMismatchException？

```
 // Try DivideByZeroExceptions

  public class DivideByZeroExceptions {

public static int quotient(int numerator, int denominator) {
    return numerator / denominator;
}

public static void main(String[] args) {

    Scanner input = new Scanner(System.in);

    System.out.println("Please enter an integer numerator: ");
    int numerator = input.nextInt();
    System.out.println("Please enter an integer denominator: ");
    int denominator = input.nextInt();

    int result = quotient(numerator, denominator);
    System.out.printf("\nResult: %d / %d = %d\n", numerator, denominator,
            result);

} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T20:52:04.073

不确定您对 inputMismatchException 的确切要求，但这是您应该做的：

```
public static int quotient(int numerator, int denominator) {
    if(denominator == 0)
        throw new IllegalArgumentException("Cannot divide by 0!");
    return numerator / denominator;
} 
```

`IllegalArgumentException`延伸`RuntimeException`，不只是`Exception`. 因此，它只会在线程发生后停止执行，因此不需要捕获/抛出它（当然，您仍然可以在方法之外捕获它以防止线程停止）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T20:54:02.960

`ArithmeticException`和都是`InputMismatchException`未经检查的异常（ 的子类型`RuntimeException`）。这意味着您不需要抓住或扔掉它们，但是，您需要处理导致它们的情况。

例如，为了避免`DivideByZeroException`( `ArithmeticException`) 您的程序必须检查分母是否不为零。如果是，请不要进行除法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-02T20:51:04.487

您不必`RuntimeExceptions`在 throws 子句 (vg, `NullPointerException`) 中声明派生的异常。这就是为什么编译器没有告诉您必须声明它的原因（对于其他异常，您将收到编译器错误/IDE 将在方法声明中发出错误信号）。

当然，如果您调用的方法之一可能会抛出它，您可以将其作为任何其他异常捕获。

检查[运行时异常](http://docs.oracle.com/javase/6/docs/api/java/lang/RuntimeException.html)

# php - 网页与从该网页触发的 php 脚本之间的通信

> ID：12239630
> 
> 赞同：1
> 
> 时间：2012-09-02T20:48:14.853
> 
> 标签：php, ajax, zend-framework, communication, webpage

我在某些控制器中有一个 myAction 函数。它有一个类实例：

```
public function myAction() {

    ...
    $myAnalyzer = new Analysis();
    $myAnalyzer->analyze();
    ...
} 
```

假设这个函数analyze() 需要10 分钟。这意味着它会阻止 my.phtml 10 分钟，这是不可接受的。我想要的是首先呈现 my.phtml，然后在 my.phtml 上显示来自 analyze() 的中间结果。

```
function analyze() {

... 
    foreach($items as $rv) {

        ...
        ...
        // new result should be stored in db here 
    }

} 
```

据我所知，这是不可能的，因为 PHP 中只有一个线程。所以我决定从 my.phtml ajax-call 来运行 myAnalyzer 实例。

第一个问题：对吗？我可以在 myAction() 中进行而不阻塞吗？

好的，现在我在 javascript 或 JQuery 的帮助下使用 my.phtml 中的一些脚本（比如 worker.php）运行 myAnalyzer。

第二个问题：我怎么知道每个 foreach 循环何时结束？换句话说，我怎样才能让 worker.php 向 my.phtml 或 zend 框架发送一些信号（或事件）。我不想使用 javascript 计时器按时间更新 my.phtml。这就是我需要知道的全部内容，因为中间数据应该存储在 DB 中。

第三个问题：当用户离开页面时，myAnalyzer 必须停止。为此，我有这个代码。

```
window.onbeforeunload = function(e) {

    // killer.php kills myAnalyzer
}; 
```

但是 javascript 如何与 myAnalyzer 通信呢？有类似进程ID的东西吗？我的意思是，当worker.php 运行myAnalyzer 时，它会在zend 框架中注册它的进程ID。当用户离开页面时，killer.php 使用这个进程 ID 停止 myAnalyzer。

我提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T05:10:15.950

第一问：是的，恐怕这是正确的。

第二个问题：我不明白你在这里的意思。请参阅下面的代码示例

```
foreach($data => $item) {
   ...
}
//code here will be executed only after foreach loop is done. 
```

第三问：看看[这个](http://php.net/manual/en/function.ignore-user-abort.php)页面。您可以将其设置为 false（但我想它已经是那样了）并不时向客户发送一些东西。或者您可以将其设置为 true 并检查用户是否仍与`connection_aborted`功能连接。我的意思是，您可以使用 ajax 运行您的 worker.php 并配置您的请求，这样浏览器就不会因为超时而断开连接（因此在用户停留在页面时将保持连接）。但是如果用户离开页面，它将被关闭。

**编辑：** 关于第二个问题。有几个选项：

1）您可以使用一些共享内存（例如 memcached）。并且不时用另一个ajax请求调用服务器。因此，在每个循环结束后 - 您将一些值放入 memcached 并在请求期间您可以检查该值并根据该值构建响应/更新您的页面

2）有像部分反应这样的事情。可以使用 XMLHTTPRequest 获得一些响应，但我记得 - 目前这并不是真正有用，因为许多浏览器不支持它。我没有这方面的任何细节。从未尝试过使用它，但我确信某些浏览器允许使用 XMLHTTPRequest 处理部分响应。

3) 您可以使用不可见的 iframe 来调用您的 worker.php 而不是 XMLHTTPRequest。在这种情况下，您可以发送一些可以放置 javascript 的内容，该 javascript 将在父窗口中调用某个函数，该函数将更新您的页面。如果您想获得更多信息，那是长轮询[COMET实现之一。](http://en.wikipedia.org/wiki/Comet_%28programming%29)有一些陷阱（例如，您可能需要确保发送一些特定数量的符号作为响应，以便在某些浏览器中执行），但仍然可以使用（某些网络浏览器聊天基于这个）。

2）和3）也很好，因为它会自动解决你的第三个问题。同时 1) 可能更简单，但它不会解决第三个问题的问题。

还有一件事 - 因为您将有长时间运行的脚本，您必须记住会话可能会阻止任何其他请求的执行（如果使用基于默认文件的 PHP 会话 - 这肯定会发生）

# php - PayPal Express Checkout 不适用于 php

> ID：12239631
> 
> 赞同：0
> 
> 时间：2012-09-02T20:48:17.270
> 
> 标签：php, paypal

我正在尝试使用 PHP 制作 PayPal Express Checkout。

```
 <form action='/paypal/expresscheckout.php' METHOD='POST'>
        <input type='image' name='submit' src='https://www.paypal.com/en_US/i/btn/btn_xpressCheckout.gif' border='0' align='top' alt='Check out with PayPal'/>
    </form> 
```

这是重定向到贝宝屏幕之前的按钮。

```
<?php

require_once ("paypalfunctions.php");
// ==================================
// PayPal Express Checkout Module
// ==================================

//'------------------------------------
//' The paymentAmount is the total value of 
//' the shopping cart, that was set 
//' earlier in a session variable 
//' by the shopping cart page
//'------------------------------------
//$paymentAmount = $_SESSION["Payment_Amount"];
$paymentAmount = '1';

//'------------------------------------
//' The currencyCodeType and paymentType 
//' are set to the selections made on the Integration Assistant 
//'------------------------------------
$currencyCodeType = "USD";
$paymentType = "Sale";

//'------------------------------------
//' The returnURL is the location where buyers return to when a
//' payment has been succesfully authorized.
//'
//' This is set to the value entered on the Integration Assistant 
//'------------------------------------
$returnURL = "http://www.mydomain.com/add_funds/order_confirm";

//'------------------------------------
//' The cancelURL is the location buyers are sent to when they hit the
//' cancel button during authorization of payment during the PayPal flow
//'
//' This is set to the value entered on the Integration Assistant 
//'------------------------------------
$cancelURL = "http://www.mydomain.com/add_funds/order_cancel";

//'------------------------------------
//' Calls the SetExpressCheckout API call
//'
//' The CallShortcutExpressCheckout function is defined in the file PayPalFunctions.php,
//' it is included at the top of this file.
//'-------------------------------------------------
$resArray = CallShortcutExpressCheckout ($paymentAmount, $currencyCodeType, $paymentType, $returnURL, $cancelURL);
$ack = strtoupper($resArray["ACK"]);
if($ack=="SUCCESS" || $ack=="SUCCESSWITHWARNING")
{
    RedirectToPayPal ( $resArray["TOKEN"] );
} 
else  
{
    //Display a user friendly Error on the page using any of the following error information returned by PayPal
    $ErrorCode = urldecode($resArray["L_ERRORCODE0"]);
    $ErrorShortMsg = urldecode($resArray["L_SHORTMESSAGE0"]);
    $ErrorLongMsg = urldecode($resArray["L_LONGMESSAGE0"]);
    $ErrorSeverityCode = urldecode($resArray["L_SEVERITYCODE0"]);

    echo "SetExpressCheckout API call failed. ";
    echo "Detailed Error Message: " . $ErrorLongMsg;
    echo "Short Error Message: " . $ErrorShortMsg;
    echo "Error Code: " . $ErrorCode;
    echo "Error Severity Code: " . $ErrorSeverityCode;
}
?> 
```

这是快递 expresscheckout.php 代码

![在此处输入图像描述](../Images/9e743e2a143c8422542c65e35e8ac0a3.png)

在我点击 paypal 按钮后，我可以看到这个屏幕没有任何订单信息。

我在代码中输入了 1 美元支付，但订单摘要上没有说明任何内容。

无论如何，我设置了不同的 PayPal 帐户来进行此交易。

![在此处输入图像描述](../Images/753055fb3a5f0907e79e61a4589e2467.png)

我可以看到我的送货地址和个人信息。

但是，它仍然没有订单摘要信息。

它应该说您将获得该产品的报酬，即 1 美元。

如果我单击继续按钮，它将页面重定向到“returnURL”

你知道是什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T10:37:06.647

不要重定向到[https://www.paypal.com/cgi-bin/webcsr?cmd=_express-checkout&token=EC-xxxxxx](https://www.paypal.com/cgi-bin/webcsr?cmd=_express-checkout&token=EC-xxxxxx)，而是重定向到[https://www.paypal.com/cgi-bin/webcsr?cmd= _express-checkout&token=EC-xxxxxx&useraction=commit](https://www.paypal.com/cgi-bin/webcsr?cmd=_express-checkout&token=EC-xxxxxx&useraction=commit)

这会将美元价值添加到“订单摘要”部分，并将最终审核页面上的“继续”按钮更改为“立即付款”。
如果您不想要后者，则需要开始发送订单项详细信息；
有关更多信息，请参阅[https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_api_ECCustomizing](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_api_ECCustomizing)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-05T15:30:47.970

感谢您发布它，它帮助我解决了同样的问题，虽然我稍微改变了它，但我改用了这个：

[https://www.paypal.com/cgi-bin/webscr?cmd=_express-checkout&token=](https://www.paypal.com/cgi-bin/webscr?cmd=_express-checkout&token=) $token&useraction=commit

# jquery - jQuery UI 映射和 getScript() 不能一起工作

> ID：12239639
> 
> 赞同：0
> 
> 时间：2012-09-02T20:49:12.733
> 
> 标签：jquery, jquery-ui, jquery-ui-map

我写了以下片段：

```
$.getScript("http://maps.google.com/maps/api/js?sensor=true", function() {
  $.getScript("/media/lib/jquery.ui.map.js", function() {
    $.getScript("/media/lib/jquery.ui.map.extensions.js",  function() {
      $.getScript("/media/lib/jquery.ui.map.overlays.js", function() {
        $('#map_canvas').gmap('option', 'zoom', 14);
        $('#map_canvas').gmap('option', 'disableDefaultUI', true);
      });
    });
  });
}); 
```

用于将 .gmaps() 函数异步应用于我的 map_canvas。如果我通过标签加载完全相同的文件（包括路径），我没有任何问题。如果我使用上面的级联版本，我会得到：

```
Uncaught TypeError: undefined is not a function 
```

问题似乎是，未定义 gmap() 。为什么？

有人看到我的代码有问题吗？

拍

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T18:59:09.160

我有同样的问题，现在正在寻找解决方案，但是您可以在控制台上看到解析器错误。

```
$.getScript( url ).done( function(script, textStatus, jqxhr) {
       console.log(script); //data returned
       console.log(textStatus); //success
       console.log(jqxhr.status); //200
    }).fail(function(jqxhr, settings, exception) {
        console.error('Error when loading a JS: ', settings);
    }); 
```

# matlab - 编写多个输出文件matlab

> ID：12239641
> 
> 赞同：0
> 
> 时间：2012-09-02T20:49:25.697
> 
> 标签：matlab, file-io

我想在某个特定文件夹的不同文件中定期编写代码输出。我正在使用的代码如下：

```
for i=1:m
% some other things
     if (mod(i,1000)==0)
      y=[1:dx:n_x;c_initial.'];
      fn = ['/home/alekhine' num2str(i) '.dat'];
     fid=fopen(fn);
      fprintf(fid,'%6.4f  %12.8f\n',y);

      fclose(fid);
      end
end 
```

但我从 Matlab 收到如下错误

```
Error using ==> fprintf
Invalid file identifier.  Use fopen to generate a valid file
identifier. 
```

. 代码有什么问题？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T21:00:33.293

您没有将`permission`参数提供给 fopen 函数，因此它仅以只读方式打开。

有关. [_](http://www.mathworks.com/help/techdoc/ref/fopen.html) _`permission`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T07:13:30.337

仅供参考，构造文件名的首选方法是使用[FULLFILE](http://www.mathworks.co.uk/help/techdoc/ref/fullfile.html)。在这种情况下，你可以做

```
fn = fullfile('/home/alekhine', [num2str(i), '.dat']); 
```

FULLFILE 是首选，因为它理解不同操作系统类型（即`\`Windows 和`/`UNIX/Mac）上的不同文件分隔符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-02T21:26:03.230

您似乎在路径生成中缺少路径分隔符：

```
fn = ['/home/alekhine' num2str(i) '.dat']; 
```

应该：

```
fn = ['/home/alekhine/' num2str(i) '.dat']; 
```

# java - 我需要停止计时器并运行帧动画

> ID：12239644
> 
> 赞同：0
> 
> 时间：2012-09-02T20:49:48.370
> 
> 标签：java, android, timer, android-animation

我有一个游戏，其中图像视图在计时器上发生变化。单击（停止）按钮时，将调用更新以更新分数和旋转。当 whammy(); 被调用并运行帧动画，然后在动画结束时重新启动计时器。我试图打电话给 sleep(2500); 但它会导致一切等待 2.5 秒，然后帧动画与图像视图计时器一起运行。这对我需要的东西不起作用。以下是我需要帮助的代码部分：

```
 public void onClick(View v) {
    if (v.getId() == R.id.btstop) {
        final Button bstop = (Button) findViewById(R.id.btstop);
        bstop.setEnabled(false);
        updateState();
    }
}

/**
 * set random view. get random 1 point from class utils and display to 1
 * position random
 */
public void setRandomView() {
    int item = new Random().nextInt(18);
    current = Utils.getAPoint();
    int img = current.getImg();
    int score = current.getScore();
    int spin = current.getSpin();
    iv[item].setImageResource(img);
    dataPoint.get(item).setImg(img);
    dataPoint.get(item).setScore(score);
    dataPoint.get(item).setSpin(spin);
    ivcenter.setImageResource(img);

}

/**
 * display Name,score & spin to screen
 */
public void setPoint() {
    tvspin.setText(spins + "\n" + name);
    tvpoint.setText(point + "");
}

/**
 * Start Thread Sets the speed of the game board Enable STOP button to true
 * 
 * @param time
 */
public void start(int time) {
    countDownTimer = new CountDownTimer(time, 300) {

        @Override
        public void onTick(long millisUntilFinished) {
            // call to set random view
            setRandomView();

        }

        @Override
        public void onFinish() {
            // TODO Auto-generated method stub

        }
    }.start();

}

/**
 * stop timer thread
 */
public void stop() {
    try {
        countDownTimer.cancel();
    } catch (Exception e) {
        // TODO: handle exception
    } finally {
    }
}

/**
 * update state game and check what tile is in the center
 */
public void updateState() { // get score,spin current point
    int scoreCurrent = current.getScore();
    int spinCurrent = current.getSpin();
    spins--;// Take one from spins

    // if score = 2, that mean to double score
    if (scoreCurrent == 2) {
        point = point * 2;
        playmp3(R.raw.correct);
    }

    // if score = 0, that means tile is a whammy
    if (scoreCurrent == 0) {
        playmp3(R.raw.buzz);
        whammy();// I need to put everything else on hold here and animation here
        point = 0;// sets the score to 0
        whammy++; // Add a whammy to the whammy count

        // Display the whammy that was added
        for (int i = 0; i < whammy; i++) {
            popup[i].setVisibility(View.VISIBLE);
        }
        // sleep(2500);
        if (whammy == 4) {
            stop();
            stopmp3();
            callFinish();
        }
    }
    // else ,score = score current + point.getscore
    else {
        playmp3(R.raw.correct);
        point = point + scoreCurrent;
    }
    // spins--;// Take one from spint

    // if spin > 0, that mean is add a spin
    if (spinCurrent > 0) {
        spins = spins + spinCurrent;
    }
    setPoint(); // display spin,score and name to screen

    sleep(2000); // Adds a delay so that the whammy pop up can be seen

    // if spint >0 start new data random
    if (spins > 0) {
        stop();
        final Button bstop = (Button) findViewById(R.id.btstop);
        bstop.setEnabled(true);
        start(10000 * 60 * 60 * 24);
    } else {
        // stop all
        stop();
        stopmp3();
        // if spin < 2, that round <2 move to spin activity
        if (round < 2) {
            Intent it = new Intent(getBaseContext(), SpinActivity.class);
            startActivity(it);
            finish();
        }
        // else move to high score activity
        else {
            callFinish();
        }
    }
}

private void whammy() {
    // set up the whammy act animation
    final ImageView act = (ImageView) findViewById(R.id.whammyact);
    act.setBackgroundResource(R.drawable.tnt_animation);
    actAnim = (AnimationDrawable) act.getBackground();
    actAnim.setVisible(true, true);

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T17:18:44.580

好的，这是为了让动画在游戏计时器重新开始之前运行和完成所做的更改...

如果有问题或任何人需要帮助，请随时提问。

```
 if (scoreCurrent == 0) {
        countDownTimer.cancel();
        countDownTimer = null;
        // Use Timer to set visibility to GONE after the animation finishes.            
                    TimerTask timerTask = new TimerTask(){
                        @Override
                        public void run() {
                            PressActivity.this.runOnUiThread(new Runnable(){
                                public void run() {
                                    resumeLogicAfterPress();
                                }
                            });}};
                    Timer timer = new Timer();
                    timer.schedule(timerTask, getWhammyAnimationTotalDuration(actAnim));
    } else {
        resumeLogicAfterPress();
    }

}

public void resumeLogicAfterPress() {
    // Display the whammy that was added
            for (int i = 0; i < whammy; i++) {
                popup[i].setVisibility(View.VISIBLE);

            }

            sleep(2500); //Adds a delay so that the whammy pop up can be seen

            //Start the background music
            playmp3(mpPress, R.raw.press);
            // if whammy = 4\. stop all and move to high score
            if (whammy == 4) {
                stop();
                stopmp3();
                callFinish();
            }
            // if spint >0 start new data random
            if (spint > 0) {
                stop();
                final Button bstop = (Button) findViewById(R.id.btstop);
                bstop.setEnabled(true);
                start(10000 * 60 * 60 * 24);
            } else {
                // stop all
                stop();
                stopmp3();
                // if spin < 2, that round <2 move to spin activity
                if (spin < 2) {
                    Intent it = new Intent(getBaseContext(), SpinActivity.class);
                    startActivity(it);
                    finish();
                }
                // esle move to high score activity
                else {
                    callFinish();
                }
            }
}

private void whammy() {
    // set up the whammy act animation
    final ImageView act = (ImageView) findViewById(R.id.whammyact);
    act.setBackgroundResource(R.drawable.tnt_animation);
    actAnim = (AnimationDrawable) act.getBackground();
    actAnim.setVisible(true, true); 
    } 
```

# c - 退出（）或_退出（）？

> ID：12239645
> 
> 赞同：4
> 
> 时间：2012-09-02T20:49:55.960
> 
> 标签：c

考虑这段代码：

```
void do_child(void);

int main(void){
int n;
pid_t child;
printf("Write a number: ");
scanf("%d", &n);
if(n != 1){
exit(1);
}
child = fork();
if(child >= 0){ /* fork ok */
 if(child == 0){
    printf("Child pid: %d\n", getpid());
    do_child();
    _exit(0);
  }
 else{ /* parent */
    printf("Child parent: %d\n", getpid());
    _exit(0);
 }
}
else{ /* fallito */
    perror("No fork");
    return 1;
}
return EXIT_SUCCESS;
}

void do_child(void){
/* some code here */
if(1 != 1){
    /* what to write here?? _exit or exit*/
}   
} 
```

从子进程退出时最好写`_exit`而不是，`exit`但如果我需要调用外部函数并进入这个函数我想退出，我应该写什么？`_exit`还是`exit`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T21:01:56.327

您可以期望[`exit`](http://linux.die.net/man/3/exit)调用使用[`atexit`](http://linux.die.net/man/3/atexit). [`_exit`](http://linux.die.net/man/2/_exit)不会那样做。通常，每个注册的清理处理程序应该只执行一次，通常在它注册的进程中。这意味着子进程应该`_exit()`和父进程应该`exit()`。如果子进程执行[`exec`](http://linux.die.net/man/3/exec)其他程序（这可能是最常见的情况），那么该新程序将覆盖任何已注册的处理程序，这意味着您将返回到`exit()`.

至于外部函数：我会说你应该调用，但如果父级在进行分叉之前`exit`注册了非平凡的东西，你应该准备好遇到奇怪的行为。`atexit`所以尽量早点分叉，除非你打算`exec`在孩子身上。并注意您自己的代码和您使用的库可能安装的退出处理程序。I/O 缓冲区刷新就是一个例子。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-02T20:55:22.437

*`exit()`*清理后终止，而*`_exit()`*立即终止。

我建议在正常情况下，*`exit()`*这是正确的方法 - 虽然我相信如果你选择你会明白你在做什么*`_exit()`*？！

我会在[网上引用 MSDN](http://msdn.microsoft.com/en-us/library/6wdz5232.aspx)，因为它在我的收藏夹中 :)

# php - 检查是否加载了php文件

> ID：12239646
> 
> 赞同：0
> 
> 时间：2012-09-02T20:50:10.067
> 
> 标签：php, jquery, ajax

我有一个简单的 jquery 函数，它应该从数据库中删除一行，我的脚本是：

> //
> 
> ```
> // delete the entry once we have confirmed that it should be deleted
> $('.delete').click(function() {
>     var parent = $(this).closest('tr');
> 
>     $.ajax({
>         type: 'get',
>         url: 'delete.php', // <- replace this with your url here
>         data: 'ajax=1&delete=' + $(this).attr('id'),
>         beforeSend: function() {
>             parent.animate({'backgroundColor':'#fb6c6c'},300);
>         },
>         success: function() {
>             parent.fadeOut(300,function() {
>                 parent.remove();
>             });
>         }
>     });        
> });
> 
> // confirm that it should be deleted
> $('.delete').confirm({
>     msg:'Do you really want to delete this?',
>     timeout:3000
> });     }); // ]]></script> 
> ```

当我点击 bitton dalete 行（在屏幕上），但在数据库中它仍然存在时，如何检查 php 是否被执行？我的 php 文件：

```
> <?php     $con = mysql_connect("localhost","root",""); if (!$con)   {  
> die('Could not connect: ' . mysql_error());   }
> 
> mysql_select_db("xxx", $con);
> $sql="DELETE FROM
> `submission_values` WHERE  SubmissionId =49";   
> mysql_query($sql,$con);
> 
> ?> 
```

如果它在同一个文件夹中，我应该提供什么网址？只有像上面这样的名字吗？那应该工作吗？（在删除.php 中）

> 回声（“警报（'ok'）;”）；

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T20:53:06.353

在您的 php 文件中，您可以回显一个响应。然后使用 jQuery 的响应对象，您可以检查响应的值以查看 php 脚本是否运行到该回显行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T20:53:33.777

您需要在失败时触发一些错误条件。

首先，要检查失败，请使用以下命令：

```
if( $e = mysql_error()) {/* report $e */} 
```

就我个人而言，我喜欢返回一个 JSON 字符串，其中包含操作是否成功以及是否发生了错误 - 这使您可以区分 HTTP 问题（这是要查找的问题），`.success()`并`.error()`判断您是否应该继续或死。

# jquery - 如何在 jQuery div 滑块上显示第一张幻灯片

> ID：12239651
> 
> 赞同：2
> 
> 时间：2012-09-02T20:50:35.120
> 
> 标签：jquery, slider

我正在制作一张幻灯片，每张幻灯片上都有触发滑动运动的链接。但我不知道如何让第一张幻灯片出现在加载页面上，所以为了让它工作，我必须让第一张幻灯片可见而其他的隐藏起来，这不是一个真正的修复，只是为了让我可以继续工作，所以我需要改变它

这是小提琴

[http://jsfiddle.net/Paula/XmeGN/10/](http://jsfiddle.net/Paula/XmeGN/10/)

另外，我可以让它向左滑动而不是向右滑动。

谢谢大家的帮助！！

HTML

```
<div id="banner_container" style="min-height:160px; clear:both;">

    <div id="banner_wrapper">
    <div class="banner_panel2" id="target1">
        <a href="#target1" class="banner_panel">Target 1</a><br/>
        <a href="#target2" class="banner_panel">Target 2</a><br/>
        <a href="#target3" class="banner_panel">Target 3</a><br/>      
        Target 1
    </div>
    <div class="banner_panel" id="target2">
        <a href="#target1" class="banner_panel">Target 1</a><br/>
        <a href="#target2" class="banner_panel">Target 2</a><br/>
        <a href="#target3" class="banner_panel">Target 3</a><br/> 
        Target 2
    </div>
    <div class="banner_panel" id="target3">
        <a href="#target1" class="banner_panel">Target 1</a><br/>
        <a href="#target2" class="banner_panel">Target 2</a><br/>
        <a href="#target3" class="banner_panel">Target 3</a><br/> 
        Target 3
    </div>
</div>
</div> 
```

​ javascript:

```
jQuery(function($) {

    $('a.banner_panel').click(function() {
        var $target = $($(this).attr('href')),
            $other = $target.siblings('.active');

        if (!$target.hasClass('active')) {
            $other.each(function(index, self) {
                var $this = $(this);
                $this.removeClass('active').animate({
                    left: $this.width()
                }, 500);
            });

            $target.addClass('active').show().css({
                left: -($target.width())
            }).animate({
                left: 0
            }, 500);
        }
    });

});​ 
```

CSS：

```
* {
    margin:0;
    padding:0;
    list-style:none;
}

#banner_container {
    width:880px;
    position:relative;
    background-color:#E6E6E6;
    margin:30px;
    background-image: linear-gradient(bottom, rgb(207,207,207) 22%, rgb(247,247,247)     82%);
    background-image: -o-linear-gradient(bottom, rgb(207,207,207) 22%, rgb(247,247,247) 82%);
    background-image: -moz-linear-gradient(bottom, rgb(207,207,207) 22%, rgb(247,247,247) 82%);
    background-image: -webkit-linear-gradient(bottom, rgb(207,207,207) 22%, rgb(247,247,247) 82%);
    background-image: -ms-linear-gradient(bottom, rgb(207,207,207) 22%, rgb(247,247,247) 82%);

    background-image: -webkit-gradient(
    linear,
    left bottom,
    left top,
    color-stop(0.22, rgb(207,207,207)),
    color-stop(0.82, rgb(247,247,247))
);
    border:1px #CCC solid;
    border-radius:10px;
    -moz-border-radius:10px;
    padding:20px 10px 10px 10px;
    overflow:hidden;
    }

#banner_wrapper{
    width:890px;
    position:relative;
    z-index:5;
    }

div.banner_panel {
    position: absolute;
    height: 100%;
    width: 100%;
    display:none;
}
div.banner_panel2 {
    position: absolute;
    height: 100%;
    width: 100%;
}
​ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T22:37:06.133

将活动添加到 target1，我还将展示如何删除 panel2

```
<div id="banner_wrapper">
    <div class="active banner_panel" id="target1">
        <a href="#target1" class="active banner_panel">Target 1</a><br/>
        <a href="#target2" class="banner_panel">Target 2</a><br/>
        <a href="#target3" class="banner_panel">Target 3</a><br/>      
        Target 1
    </div>
    <div class="banner_panel" id="target2">
        <a href="#target1" class="banner_panel">Target 1</a><br/>
        <a href="#target2" class="banner_panel">Target 2</a><br/>
        <a href="#target3" class="banner_panel">Target 3</a><br/> 
        Target 2
    </div>
    <div class="banner_panel" id="target3">
        <a href="#target1" class="banner_panel">Target 1</a><br/>
        <a href="#target2" class="banner_panel">Target 2</a><br/>
        <a href="#target3" class="banner_panel">Target 3</a><br/> 
        Target 3
    </div>
</div> 
```

javascript:

```
jQuery(function($) {

    $('a.banner_panel').click(function() {
        var $target = $($(this).attr('href')),
            $other = $target.siblings('.active');

        if (!$target.hasClass('active')) {
            $other.each(function(index, self) {
                var $this = $(this);
                $this.removeClass('active').animate({
                    left: $this.width()
                }, 500);
            });

            $target.addClass('active').show().css({
                left: -($target.width())
            }).animate({
                left: 0
            }, 500);
        }
    });

});​

$('div.banner_panel.active').show(); 
```

小提琴：http: [//jsfiddle.net/XmeGN/18/](http://jsfiddle.net/XmeGN/18/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T22:46:36.727

宝拉，

*   在 HTML 中，更改`class="banner_panel2"`并`class="banner_panel"`删除`banner_panel2`.
*   （可选）`display:none;`从`div.banner_panel {...}`.
*   `$("div.banner_panel").eq(0).find('a.banner_panel').eq(0).trigger('click');` 在单击处理程序定义之后添加。调整一个或两个`eq(0)`表达式以选择您选择的任何其他面板作为初始面板。

此外，`e.preventDefault();`在点击处理程序的顶部添加。当单击指向当前活动面板的链接时，这会抑制不良影响。

Javascript 现在应该如下所示：

```
$('a.banner_panel').on('click', function(e) {
    e.preventDefault();
    var $target = $($(this).attr('href')),
        $other = $target.siblings('.active');

    if (!$target.hasClass('active')) {
        $other.removeClass('active').each(function(index, self) {
            var $this = $(this);
            $this.animate({
                left: $this.width()
            }, 500);
        });
        $target.addClass('active').show().css({
            left: -($target.width())
        }).animate({
            left: 0
        }, 500);
    }
});
$("div.banner_panel").eq(0).find('a.banner_panel').eq(0).trigger('click'); 
```

**[演示](http://jsfiddle.net/XmeGN/14/)**

用户（可能）会看到页面加载的飞入效果，但也许这不是坏事。

这样做可以确保面板的初始状态与用户为他/她自己单击时的状态相同。如果将来您更改点击处理程序以做一些稍微不同的事情，那么您不必担心检查 HTML/CSS 是否兼容。如果用户点击一切正常，那么初始状态也可以。

# iphone - NSURLConnection 缓存和接收数据

> ID：12239652
> 
> 赞同：0
> 
> 时间：2012-09-02T20:51:02.760
> 
> 标签：iphone, ios, cocoa-touch, nsurlconnection

快速提问：关于方法

```
- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data 
```

从 NSURLConnectionDataDelegate 中，如果我不将方法给出的数据附加到我的 NSData 上，它会丢失吗？还是连接也将其保存在某个地方？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T20:56:48.017

不，它没有保存在任何地方。如果你想保留它，你必须自己这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T22:22:39.077

通常，此方法是您使用 NSMutableData 实例变量跟踪数据的地方：

```
- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data
{
    [myData appendData:data];
} 
```

# gdb - 如何在 coredump 中找到地址？

> ID：12239655
> 
> 赞同：2
> 
> 时间：2012-09-02T20:51:19.317
> 
> 标签：gdb

我有一个大于 4Gb 的 coredump 文件。我想找到所有出现的 64 位整数。如果您可以分享这方面的信息，将会很有帮助。

将 coredump 作为文本文件打开并搜索会有所帮助吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T20:54:50.047

当然可以，只需使用 gdb 的“查找”命令

[http://sourceware.org/gdb/onlinedocs/gdb/Searching-Memory.html](http://sourceware.org/gdb/onlinedocs/gdb/Searching-Memory.html)

# css - CSS：不固定文本 div 宽度

> ID：12239661
> 
> 赞同：0
> 
> 时间：2012-09-02T20:52:18.020
> 
> 标签：css, html, text, width, fixed

我正在做一个个人项目，但遇到了设计问题：

假设您有一个带有以下文本的 div：“你好，我的名字是 Daniel...”，以及下面的另一个 div..

所以宽度应该是那个短语和元素的大小；不是整个容器的大小。

这是我的 HTML 代码：

```
<div id="feed">

        <div class="post">
            <div class="feed-msg">
                <p>My name is Daniel...</p>
                <div class="meta">5 hours ago.</div>
            </div>
        </div><!-- [End] .post -->
</div> 
```

这是我在 CSS 中的代码：

```
#feed {
 position: relative;
}

#feed .post {
min-height: 55px;
margin-left: 90px;
position: relative;
margin-bottom: 20px;
}

#feed .post div.feed-msg {
padding-left: 15px; padding-top: 9px; padding-bottom: 10px; padding-right: 15px;
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T20:56:46.850

你想要这个：http: [//jsfiddle.net/uhEBs/](http://jsfiddle.net/uhEBs/)吗？

采用

```
#feed .post div.feed-msg {
    display:inline-block;
} 
```

此外，您还可以`padding-left: 15px; padding-top: 9px; padding-bottom: 10px; padding-right: 15px`加入`padding: 9px 15px 10px 15px`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T20:59:19.093

您将元 div 放置在 msg div 中。您可能会更容易将它们分开并将元数据作为帖子 div 的一部分，然后设置它们各自的宽度

# multithreading - 带有 javafx.concurrent 的 JavaFX 网络后台任务

> ID：12239664
> 
> 赞同：2
> 
> 时间：2012-09-02T20:52:30.313
> 
> 标签：multithreading, service, concurrency, task, javafx

我正在实现一个通过 wifi (android) 与手机通信的 JavaFX 应用程序。

因此，我在后台进程中运行的 JavaFX 上有一个服务器线程：

```
public class NetworkService implements Runnable { 

    private final ServerSocket serverSocket;
    private final ExecutorService pool;

    private RoutePlannerJFX application;
    private UserData userData;

    public NetworkService(ExecutorService pool,
                          ServerSocket serverSocket,
                          RoutePlannerJFX app,
                          UserData data) {
        this.serverSocket = serverSocket;
        this.pool = pool;
        application = app;
        userData = data;
    }

    public void run() {
        try {
            while ( true ) {
                Socket cs = serverSocket.accept(); 
                pool.execute(new Handler(serverSocket, cs, application, userData));
            }
        } catch (IOException ex) {
            System.out.println("--- Interrupt NetworkService-run");
        }
        finally {
            System.out.println("--- Ende NetworkService(pool.shutdown)");
            pool.shutdown();  //keine Annahme von neuen Anforderungen
            try {
                pool.awaitTermination(4L, TimeUnit.SECONDS);
                if ( !serverSocket.isClosed() ) {
                    System.out.println("--- Ende NetworkService:ServerSocket close");
                    serverSocket.close();
                }
            } catch ( IOException e ) { }
            catch ( InterruptedException ei ) { }
        }
    }
} 
```

它有一个处理程序：

```
public class Handler implements Runnable {

    private final Socket client;
    private final ServerSocket serverSocket;

    private RoutePlannerJFX application;
    private UserData userData;

    Handler(ServerSocket serverSocket,Socket client, RoutePlannerJFX app, UserData data) {
        this.client = client;
        this.serverSocket = serverSocket;
        application = app;
        userData = data;
    }

    public void run() {
        StringBuffer sb = new StringBuffer();
        PrintWriter out = null;
        try {
            System.out.println( "running service, " + Thread.currentThread() );
            out = new PrintWriter( client.getOutputStream(), true );
            BufferedReader bufferedReader = 
                new BufferedReader(
                    new InputStreamReader(
                        client.getInputStream()));
            char[] buffer = new char[100];
            int anzahlZeichen = bufferedReader.read(buffer, 0, 100); 
            String nachricht = new String(buffer, 0, anzahlZeichen);
            String[] werte = nachricht.split("\\s");

            System.out.println(nachricht+"\n");

            POI poi = new POI(nachricht);
            userData.addItemToPoiList(poi);

            application.setScene("INSTRUCT");

        } catch (IOException e) {System.out.println("IOException, Handler-run");}
        finally { 
            System.out.println(sb);  //Rückgabe Ergebnis an den Client
            if ( !client.isClosed() ) {
            System.out.println("****** Handler:Client close");
            try {
                client.close();
                } catch ( IOException e ) { }
            } 
        }
    }
} 
```

该应用程序具有更改场景的公共方法（setScene()）。

这就是我希望我能做到的方式，但现在我知道，我无法在后台进程中切换场景。

有谁知道如何解决这个问题？当我的后台进程收到来自客户端的消息时，我需要触发一个操作，但我不知道最好的方法是什么……我已经找到了 javafx.concurrent，但是我必须使用哪个以及如何使用？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T22:34:57.433

对于客户端，您可以使用任务或服务在单独的线程中运行并更新 GUI，如[文档中所述](http://docs.oracle.com/javafx/2/threads/jfxpub-threads.htm)

你也可以查看这篇文章[JavaFX Async Task](https://blogs.oracle.com/clarkeman/entry/javafx_async_task)

# sass - 使用带有 LiveReload 的 Bourbon SASS 库

> ID：12239669
> 
> 赞同：2
> 
> 时间：2012-09-02T20:52:56.120
> 
> 标签：sass, bourbon

我很想将[波旁威士忌](http://thoughtbot.com/bourbon/)与[LiveReload](http://livereload.com/)一起使用，但我似乎无法让它们一起工作。有人成功让这两个玩得很好吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-01T00:31:34.137

如果您使用“处理更改后运行自定义命令”选项而不是标准编译选项，那么您可以使用[自述](https://github.com/thoughtbot/bourbon#rails-23-or-a-non-rails-project-static-site-jekyll-wordpress-etc)文件中详述的命令。

```
# Example (project root directory)
sass --watch stylesheets/sass:stylesheets -r ./stylesheets/sass/bourbon/lib/bourbon.rb 
```

我写了[一篇博客文章涵盖了这一点](http://adamwiggall.com/blog/2012/10/27/using-the-bourbon-mixin-library/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T21:30:04.720

如果您安装最新版本 (3.0.0) 的 Bourbon 并将 bourbon 安装到您的 compass sass 目录中：

```
bourbon install --path ./sass 
```

然后，您可以通过一个小的调整来使用 LiveReload。您需要将 LiveReload 的 SASS 版本替换为至少 3.2.3，因为 Bourbon 需要这样做。

关于如何替换 LiveReload 的默认 SASS 版本的说明可以在这里找到：[http ://carl-topham.com/theblog/post/chang-version-sass-livereload/](http://carl-topham.com/theblog/post/changing-version-sass-livereload/)

这似乎对我有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T16:05:40.420

有人告诉我，您可以通过将 lib/bourbon.rb 文件传递​​到 LiveReload 中的“运行自定义命令”选项来使其工作。见附图。 ![图片](../Images/4375baa192a8808e95aad56ac1b8697f.png)

# node.js - Node/Mongo 应用程序在 Amazon EC2 上崩溃并且无法访问服务器

> ID：12239679
> 
> 赞同：0
> 
> 时间：2012-09-02T20:54:09.473
> 
> 标签：node.js, amazon-ec2, mongodb

我在亚马逊 ec2 实例上有一个带有 mongo 服务器的节点应用程序。它工作得很好，但我只是添加了一个新的 API 调用，每次调用它时，服务器都会冻结，我无法访问/ssh 几个小时。发生这种情况时，我的服务器出现故障，这使得依赖它的应用程序无法使用，我的用户很生气......

**这段代码在我的 localhost 上**运行良好，但是一旦我在我的服务器上运行它，它就会冻结。我的想法是它可能会崩溃 mongo？我不知道为什么会发生这种情况......

如果有人有任何想法可能会出错，请告诉我。

节点正在使用快递。send_error 函数将执行 res.send({some error})。db.CommentModel 返回 mongoose.model('comment', Comment);

在 app.js 中

```
app.get('/puzzle/comment/:id', auth.restrict, puzzle.getComments); 
```

在定义 getComments 的文件中

```
exports.getComments = function(req, res)
{   
    var userID = _u.stripNonAlphaNum(req.params.id);

    var CommentModel = db.CommentModel;
    CommentModel.find({user: userID}, function(e, comments) {
        if(e) 
        {
            err.send_error(err.DB_ERROR, res);
        }
        else if (!comments)
        {
            err.send_error(err.DB_ERROR, res);
        }
        else if (comments.length == 0)
        {
            res.send([]);
    }
    else
    {
        var commentIDs = [];
        for (var i = 0; i<comments.length; i++)
        {
            commentIDs.push({_id: comments[i].puzzle});
        }
        var TargetModel = pApp.findPuzzleModel(_u.stripNonAlphaNum(req.apiKey));
            TargetModel.find({removed: false, $or: commentIDs}, function(e, puzzles) {
                if(e) 
                {
                    err.send_error(err.DB_ERROR, res);
                }
                else if (!puzzles)
                {
                    err.send_error(err.DB_ERROR, res);
                }
                else
                {
                    res.send(puzzles);
                }
            });
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T02:52:01.547

听起来您的查询导致服务器上的某些东西（可能是 mongo）消耗大量 CPU - 因为这通常是导致您在 SSH 访问中看到的问题的原因。

您应该尝试阅读 mongo 实例的日志并查看是否有任何长时间运行的查询。

Monngodb 提供了一个内部分析器来检查长时间运行的命令。尝试将长时间运行的分析级别设置为 1，运行命令并检查日志文件输出。

有关分析器的更多详细信息，请访问[http://www.mongodb.org/display/DOCS/Database+Profiler](http://www.mongodb.org/display/DOCS/Database+Profiler)

# ruby - 在特定范围内评估一个块并传递一个参数

> ID：12239680
> 
> 赞同：7
> 
> 时间：2012-09-02T20:54:14.093
> 
> 标签：ruby, block

例如，假设我有

```
block = proc { |n| "#{downcase} #{n}" } 
```

现在我想在 a 的范围内评估该块`String`，但将该块传递一个变量。我知道如何做第一部分：

```
"Foo".instance_eval(&block) 
```

但是如何也将变量传递给该块？

我试过

```
"Foo".instance_eval { block.call(3) } 
```

但它不起作用，它不在`String`.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-02T21:17:19.007

改用[`instance_exec`](http://ruby-doc.org/core/BasicObject.html#method-i-instance_exec)：

> **instance_exec(arg...) {|var...| 块 } → 对象**
> 
> *在接收者 ( obj* )的上下文中执行给定的块。为了设置上下文，在代码执行时将变量`self`设置为*obj*，从而使代码可以访问*obj*的实例变量。参数作为块参数传递。

所以这会成功：

```
"Foo".instance_exec(3, &block) 
```

并给你`'foo 3'`你想要的。

这个问题：

```
"Foo".instance_eval { block.call(3) } 
```

将`self`在`"Foo"`inside`{ block.call(3) }`但不在 inside `block`，`block`将保留定义`self`时`block`的任何内容；没有什么`block.call(3)`可以强制上下文，所以`self`不会改变。例如，鉴于此：

```
class C
  def m
    proc { |n| "#{downcase} #{n}" }
  end
end
c = C.new
"Foo".instance_eval { c.m.call(3) } 
```

当proc被调用时，`self`将是`c`因为那`self`是proc被定义的时候（`m`即被调用的时候）。`self`块内部的内容对 proc 内部`instance_eval`没有任何影响。`self`

# javascript - 在列表中使用随机生成的 nr 至少两次

> ID：12239681
> 
> 赞同：1
> 
> 时间：2012-09-02T20:54:22.110
> 
> 标签：javascript, jquery, random, html-lists

我有以下小提琴：http: [//jsfiddle.net/mauricederegt/MhhBc/](http://jsfiddle.net/mauricederegt/MhhBc/)

它包含一个用 javascript 生成的列表。每个人`<a>`都有一个随机选择的班级。这种随机选择是使用以下方法完成的：

```
var randomClass;
randomClass = Math.round(Math.random() * 10 + 0); 
```

这会产生一个随机的 nr。我用这个 nr 来获取这里定义的随机类：

```
var classes = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k']; 
```

因此，如果随机 nr 是 a `2`，则该类将是`b`

这一切都很好。我遇到的问题是，在到达完整列表的末尾之前，我希望每个类（或随机 nr）至少使用两次。（小提琴有一个非常短的列表，真正的列表要长得多，也包含多个`<ul>`）。

示例：因此，如果随机选择的 nr 是`5`，它将给出 class `e`。这意味着这个 nr/class 必须再次使用，但也必须随机放置在所有不同的列表中。`5`如果随机 nr 恰好再次出现在列表的后面，则可以多次使用 nr/class 。

整个列表中使用的总量`<a>`总是偶数。

另一个例子：所以超过 6 的类`<a>`可以是：`a, d, a, e, e, d`. 所有课程都在那里两次，而且都是随机的。

这是错误的：`a, d, b, b, e, c`。这是目前的情况，类没有使用两次

希望我足够清楚地解释了这个问题。我的英语不是最好的:)

亲切的问候，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T22:34:36.570

**编辑 - 替换了以前的解决方案，因为它没有在所有`ul`标签中重复**

`<ul>`我已经更新了你的代码，现在它总是在所有标签中添加每个类至少两次。

我确实需要事先知道物品的总数。目前我已经将该计数添加为一个常量`totalCount`，因为我不想为了获得总计数而对 JSON 对象进行两次迭代，并且我想让主代码首先工作。

也许总计数可以作为 JSON 对象的一部分作为对象根中的单独属性向下发送？

无论哪种方式，都必须以某种方式预先知道项目的总数。

我将一些必需的变量移到了更全局的范围内，因为每个 .render 方法都被调用了`ul`。

```
var classes = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k'];
//var classes = ['a', 'd', 'f'];
var sourceClasses = [];
var totalCount = 6;
var selectedClasses = [];

Menu.prototype.render = function() {    
    // Get total item count between all arrays
    //debugger;    
    var ul = $("<ul />");

    $.each(this.data, function(i, e) {
        var li = $("<li />");

        //console.log(listItemCount);
        //debugger;
        $.each(e, function(j, f) {
            //debugger;
            // If we have no more classes left we re-set the list of items to the original source
            // SourceClasses.length will off course not be 0 ever if we already passed the half-way mark.
            if(sourceClasses.length === 0){
                for(index = 0; index < classes.length; index++){
                    sourceClasses.push(classes[index]);
                }
            }            

            var randomClass;
            randomClass = Math.round(Math.random() * (sourceClasses.length - 1) + 0);

            var selectedClass = sourceClasses[randomClass];

            li.append($("<a></a>", {
                href: f.url,
                text: f.title,
                class: selectedClass
            }));

            sourceClasses.splice(sourceClasses.indexOf(selectedClass), 1);
            selectedClasses.push(selectedClass);

            // Check for half-way mark.
            var itemCount = selectedClasses.length;

            if (totalCount % 2 != 0) {
                if (itemCount === (totalCount - 1) / 2) {
                    sourceClasses = selectedClasses;
                    var additionalClass = Math.round(Math.random() * (sourceClasses.length - 1) + 0);
                    sourceClasses.push(sourceClasses[additionalClass]);
                    selectedClasses = [];
                };
            } else {
                if (itemCount === totalCount / 2) {
                    sourceClasses = selectedClasses;
                    selectedClasses = [];
                };
            }
        });
        ul.append(li);
    });

    //console.log($($(ul).find("a")));
    return ul;
}; 
```

### [演示](http://jsfiddle.net/MhhBc/24/)- 每个类在所有列表项中至少使用两次

*（使用浏览器中的调试器工具检查呈现的 HTML 以获取结果）*

您注意到现在内部循环中发生的第一件事是，我正在检查是否还有可用的类，如果没有，我将可用类重新设置为原始列表。

仅当您的原始可用课程列表少于总项目数时，才会发生这种情况。

在每个列表项的迭代过程中，我仍然从可用类列表中删除选定的类，以确保每个类至少出现两次。

我仍在另一个数组中记录选定的类，然后在项目列表的中途使用它来重新设置可用类的数组。

如果项目总数是奇数或偶数，则该代码有效。

对于偶数个项目，我们只需通过除以 2 来测量 laf-way 标记。
对于奇数个项目，我确保在中途标记`(totalCount -1) / 2`，然后将一个随机类添加到已经选择的类作为额外的可用类.

这一切现在都应该按预期工作......

**编辑（2021 年 9 月 3 日）**
我检查了代码，其中有一个逻辑错误。`itemCount`中途标记后重新设置。

这段代码：

```
var itemCount = selectedClasses.length; 
```

假设是： // 将声明移到外部范围，现在稳步增加计数。项目计数 += 1

现在代码正在按照我的计划执行所有操作。

### [演示](http://jsfiddle.net/MhhBc/30/)- 使用 70 个链接和 11 个类池

所有链接都获得了类，并且所有类都至少使用了两次，因为我们只有 11 个。任何链接都不应该最终没有类，因为总是有一个来源可供选择。

关于您关于确保每个班级至少使用一个的问题。这取决于可用类别与总项目的中途标记的比率。

如果您使用 11 个类作为可能的源和至少 22 个预期链接，则您的所有类都将被使用**并将**被使用两次。

如果您使用 20 个类和 22 个项目，则**并非**并非所有类都将被使用。原因是您原来的要求`to use each selected class at least twice`。

为了确保所有选定的类至少使用两次，我将每个选择记录在一个名为`selectedClasses`. 我们已经处理了一半可能的项目，我用选定的类数组替换源类。现在，另一半项目只能从已选择的类别列表中进行选择，从而确保每个类别至少使用两次。

想一想，如果您有一个包含 20 个类和总共 22 个项目的数组，那么如果您同时希望确保每个已选择的类至少使用两次，那么您至少不能使用所有类。这些要求相互矛盾。

可用类的数量必须小于或等于项目总数的一半，以确保所有类至少使用一个**，并且**所有选定的类至少使用两次。

我希望这是有道理的，但是如果您遇到困难，请随时在评论部分开始聊天，我可以再次与您查看代码，没问题。

# ios - 避免登录按钮的 Facebook 和 iOS 集成最佳实践

> ID：12239687
> 
> 赞同：0
> 
> 时间：2012-09-02T20:54:51.403
> 
> 标签：ios, xcode, facebook, login, share

我开始在我的应用程序中使用 FB 集成，并且我一直在阅读很多信息。

我已经下载了 SDK 并完成了将框架集成到我的应用程序中的所有必要步骤。它已经为 Facebook 做好了准备。

然而，有一件事我还没有完全弄清楚。这是相当概念化的东西。

我的应用程序非常简单。只有几个屏幕，没有骨干网、网络服务、用户帐户等。你基本上把三个选项放在牌上，洗牌后选一张牌。没有其他的。

Facebook 集成的每个入门教程都有登录部分。我见过的每个示例都有登录按钮，但我真的不想在我的应用程序上有登录按钮。只需“分享”按钮。

处理这个问题的最佳方法是什么？我应该先让“分享”按钮像“登录”按钮一样，然后再分享内容吗？下次它会知道用户已经登录并以某种方式跳过登录部分吗？

在这里最好的道路是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T21:08:30.623

发布时，如果尚未登录，您将自动完成登录过程然后发布。

如果您存储了检索到的登录令牌，那么您将来会使用它并且您不需要再次登录。

编辑 - - -

我这样做的方式。我有一个 Facebook 单例课程。在单例初始化时，您将 facebook.accessToken 设置为登录完成时存储在 NSUserDefaults 中的 accessToken。这样，您可以使用 .isSessionValid 方法来决定是重新登录还是只是发布。如果用户尚未登录，则 accessToken 将为 nil，因此会话无效。

```
-(void) postToWallWithDialogNewHighscore:(int)highscore
{
    _highScore = highscore;
    _postAfterLogin = NO;

    if (![_facebook isSessionValid]) {
        NSLog(@"session not valid");
        _postAfterLogin = YES;
        [_facebook authorize:_permissions];
    }
    else {
        NSLog(@"session valid so post");
        [self postToWallWithDialogNewHighscore];
    }
} 
```

我希望这有帮助。如果没有，请告诉我。

# c++ - 使用虚拟 void 函数但没有编译错误的类中的运行时错误

> ID：12239691
> 
> 赞同：0
> 
> 时间：2012-09-02T20:55:11.587
> 
> 标签：c++, inheritance, virtual, function-pointers, runtime-error

这是我的代码：

```
/*
create an abstract class shape and derived classes rectangle and circle from class shape, implement abstract method of class shape in rectangle and circle. Class circle contains radius as data members rectangle class contains length and breadth.
 */

class shape
{

              virtual void displayArea() = 0;
              virtual void get_radius(double r) = 0;
              virtual void get_length(double a) = 0;
              virtual void get_breadth(double b) = 0;
};

class rectangle: public shape
{

      protected:

                double length;
                double breadth;
      public:
             virtual void get_length(double a)
             {
                     length = a;
             }
             virtual void get_breadth(double b)
             {
                     breadth = b;
             }
             virtual void get_radius(double r)
             {
                     cout << endl;
             }
             virtual void displayArea()
             {
                     cout << "Area of RECTANGLE = " << length*breadth << endl;
             }
};

class circle: public shape
{

      protected:
                double radius;
      public:
              virtual void get_length(double a)
             {
                     cout << endl;
             }
             virtual void get_breadth(double b)
             {
                     cout << endl;
             }
             virtual void get_radius(double r)
             {
                     radius = r;
             }
             virtual void displayArea()
             {
                     cout << "Area of circle = " << 3.14*radius*radius << endl;
             }
};

int main()
{

    shape* shapes;
    double l, r, b;
    rectangle R;
    circle C;

    cout << "Enter the length and breadth for rectangle\n" << endl;
    cin >> l >> b; 
    cout << "\nEnter the radius of circle\n " << endl;
    cin >> r;
    R.get_length(l);
    R.get_breadth(b);
    C.get_radius(r);

    shapes[0] = R;
    shapes[1] = C;

    shapes[0].displayArea();
    shapes[1].displayArea();

    system("pause");
    return 0;
} 
```

它没有给出编译错误，但在运行时会发生这种情况：输入矩形的长度和宽度

3 3

输入圆的半径

3

然后它暂停一段时间然后终止。我很困惑，我在这里做错了什么以及如何纠正它？代码有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T21:01:06.980

您的`shapes`变量未初始化（我认为它是数组），您需要使用对象的地址对其进行初始化：

```
shape* shapes[2] ;
//...

shapes[0] = &R;
shapes[1] = &C;

shapes[0]->displayArea();
shapes[1]->displayArea(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T21:01:46.220

首先，您没有构造函数或 setter 函数（至少您没有为它们显示任何代码），因此无法设置您的类成员变量。

其次你不能这样做

```
shape* shapes;
shapes[0] = R;
shapes[1] = C; 
```

因为形状是您尚未为其分配内存的指针。如果你想要一个形状指针数组，你必须将形状声明为一个数组，如果它是一个**指针**数组，你应该将**指针**分配给它的元素而不是对象。

**编辑**我看到实际上你确实有 setter 函数，并且你已经调用了它们`get_length()` `get_radius()`等。这非常令人困惑，你最好使用变量名来指示它们在可能的情况下所做的事情。对于阅读您的代码的人来说，这非常令人困惑

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T21:03:24.500

线

```
shape* shapes; 
```

声明一个指向形状对象的指针。但是，您没有为任何形状分配任何内存。然后您稍后将此指针用作数组：

```
shapes[0] = R; 
shapes[1] = C; 
```

这会导致未定义的行为，因为此内存位置未分配给您的程序使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-02T21:07:24.073

关于您的代码，我注意到的一件事是“形状”实际上并不是一个数组。它是一个未初始化的指针。因此 shape[0]=R 不会将 member#0 指向 R，它会将其复制到指针指向的任何位置。下一行将做类似的事情。这可能会导致内存损坏。你可能想要类似的东西

```
shape* Shapes[2]; 
```

甚至（将此行移至声明 C 和 R 的位置之后）：

```
shape** Shapes = {
    &R,
    &C
}; 
```

# android - Android InputStream 丢弃前两个字节（修改过的 BluetoothChat）

> ID：12239692
> 
> 赞同：8
> 
> 时间：2012-09-02T20:55:21.440
> 
> 标签：android, character-encoding, inputstream

我使用 BluetoothChat 示例中的代码从蓝牙秤发送和接收字节数据。秤从设备接收命令，然后发回一个字节数组。{2,198,48,48,48,48,199,3} 在我们的通信协议中，2 = STX，198 = 数据包开始，199 = 数据包结束，3 = ETX。

一切正常，除了 BluetoothChatService.java 中的以下代码反应奇怪，它丢弃了前两个字节。

```
/**
     * This thread runs during a connection with a remote device.
     * It handles all incoming and outgoing transmissions.
     */
    private class ConnectedThread extends Thread {
        private final BluetoothSocket mmSocket;
        private final InputStream mmInStream;
        private final OutputStream mmOutStream;

        public ConnectedThread(BluetoothSocket socket, String socketType) {
            Log.d(TAG, "create ConnectedThread: " + socketType);
            mmSocket = socket;
            InputStream tmpIn = null;
            OutputStream tmpOut = null;

            // Get the BluetoothSocket input and output streams
            try {
                tmpIn = socket.getInputStream();
                tmpOut = socket.getOutputStream();
            } catch (IOException e) {
                Log.e(TAG, "temp sockets not created", e);
            }

            mmInStream = tmpIn;
            mmOutStream = tmpOut;
        }

        public void run() {
            Log.i(TAG, "BEGIN mConnectedThread");
            final byte[] buffer = new byte[1024];
            int bytes;

            // Keep listening to the InputStream while connected
            while (true) {
                try {
                    // Read from the InputStream
                    bytes = mmInStream.read(buffer);

                    // Send the obtained bytes to the UI Activity
                    mHandler.obtainMessage(BluetoothChat.MESSAGE_READ, bytes, -1, buffer)
                            .sendToTarget();
                } catch (IOException e) {
                    Log.e(TAG, "disconnected", e);
                    connectionLost();
                    // Start the service over to restart listening mode
                    BluetoothChatService.this.start();
                    break;
                }
            }
        } 
```

我对以下代码部分特别有疑问：

```
 bytes = mmInStream.read(buffer);

                    // Send the obtained bytes to the UI Activity
                    mHandler.obtainMessage(BluetoothChat.MESSAGE_READ, bytes, -1, buffer)
                            .sendToTarget(); 
```

调试时，在执行之前查看 mmInStream.read(buffer) 中缓冲区的内容，缓冲区包含缩放设备发回的正确数据，即：

```
{2,198,48,48,48,48,48,199,3} 
```

但是一旦代码被单步执行，缓冲区的前两个字节就会被剥离，现在它错误地包含：

```
{48,48,48,48,48,199,3} 
```

这就是消息处理程序最终传递给活动的原因。

为了更清楚，我必须补充一点，秤发送的字节流是 00 到 FF 范围内的十六进制字符。由于某些奇怪的原因，字符串在调试器中实际上看起来像这样：

```
{2,-58,48,48,48,48,48,-57,3} 
```

然后 2,-58 被丢弃。

我注意到，当我通过套接字发送字节数组时，我需要执行以下操作：

```
byte[] sendBytes = {2,(byte)198,48,48,48,48,48,(byte)199,3} 
```

调试此数组的内容时，它将给出 {2,-58,48,48,48,48,48,-57,3}

请理解，我是 Android - java 的新手，还有很多东西要学。所有帮助将不胜感激。谢谢阿德里安

我添加了 log.i 条目，以便根据 Radu 的建议更好地了解正在发生的事情。似乎在我通过蓝牙将数据写入我的设备后，它会响应，我们出于某种原因只读取了前两个字节，然后将它们发送到消息处理程序，然后读取从设备发送的其余数据包，然后发送这关闭到消息处理程序，但在处理程序甚至第一次响应之前，缓冲区已经被覆盖，因此当处理程序尝试读取前两个字节时，它正在读取响应的第 3 和第 4 个字节数据包，然后立即再次响应并从第 3-17 个位置读取整个数据包。因此，如果我可以简单地说..消息处理程序仅在被覆盖后才响应发送的缓冲区。请参阅下面的日志：

```
09-05 13:16:52.093: V/BluetoothSocket.cpp(11279): writeNative
09-05 13:16:52.118: I/IN_BUFFER(11279): The entire buffer after read stream into buffer: 2 
09-05 13:16:52.118: I/IN_BUF_AFTER(11279): 2 
09-05 13:16:52.118: I/IN_BUF_AFTER(11279): -58 
09-05 13:16:52.118: I/IN_BUF_AFTER(11279): 0 
09-05 13:16:52.118: I/IN_BUF_AFTER(11279): 0 
...truncated to save space ... 
09-05 13:16:52.163: I/IN_BUF_AFTER(11279): 0 
09-05 13:16:52.163: I/IN_BUFFER(11279): We now send to handler.
09-05 13:16:52.168: I/IN_BUFFER(11279): Read Stream into Buffer:
09-05 13:16:52.168: V/BluetoothSocket.cpp(11279): readNative
09-05 13:16:52.168: I/IN_BUFFER(11279): The entire buffer after read stream into buffer: 17 
09-05 13:16:52.168: I/IN_BUF_AFTER(11279): 48 
09-05 13:16:52.168: I/IN_BUF_AFTER(11279): 48 
09-05 13:16:52.168: I/IN_BUF_AFTER(11279): 48 
09-05 13:16:52.173: I/IN_BUF_AFTER(11279): 48 
09-05 13:16:52.173: I/IN_BUF_AFTER(11279): 48 
09-05 13:16:52.173: I/IN_BUF_AFTER(11279): 44 
09-05 13:16:52.173: I/IN_BUF_AFTER(11279): 48 
09-05 13:16:52.178: I/IN_BUF_AFTER(11279): 48 
09-05 13:16:52.178: I/IN_BUF_AFTER(11279): 49 
09-05 13:16:52.178: I/IN_BUF_AFTER(11279): 50 
09-05 13:16:52.188: I/IN_BUF_AFTER(11279): 48 
09-05 13:16:52.188: I/IN_BUF_AFTER(11279): 44 
09-05 13:16:52.188: I/IN_BUF_AFTER(11279): 85 
09-05 13:16:52.188: I/IN_BUF_AFTER(11279): 13 
09-05 13:16:52.188: I/IN_BUF_AFTER(11279): -57 
09-05 13:16:52.188: I/IN_BUF_AFTER(11279): 3 
09-05 13:16:52.188: I/IN_BUF_AFTER(11279): 6 
09-05 13:16:52.188: I/IN_BUF_AFTER(11279): 0 
...truncated to save space ... 
09-05 13:16:52.188: I/IN_BUF_AFTER(11279): 0 
09-05 13:16:52.188: I/IN_BUFFER(11279): We now send to handler.
09-05 13:16:52.193: I/IN_BUFFER(11279): Read Stream into Buffer:
09-05 13:16:52.208: V/BluetoothSocket.cpp(11279): readNative
09-05 13:16:52.208: I/MESSAGE_READ(11279): I am reading 2 bytes
09-05 13:16:52.208: I/Content(11279): The entire array:
09-05 13:16:52.208: I/some hardcoded tag(11279): 0 
09-05 13:16:52.208: I/some hardcoded tag(11279): 0 
09-05 13:16:52.273: I/MESSAGE_READ(11279): I am reading 17 bytes
09-05 13:16:52.273: I/Content(11279): The entire array:
09-05 13:16:52.273: I/some hardcoded tag(11279): 0 
...truncated to save space ... 
09-05 13:16:52.283: I/some hardcoded tag(11279): 0 
09-05 13:16:52.283: I/some hardcoded tag(11279): 0 
09-05 13:16:54.528: V/BluetoothSocket.cpp(11279): writeNative
09-05 13:16:54.553: I/IN_BUFFER(11279): The entire buffer after read stream into buffer: 2 
09-05 13:16:54.553: I/IN_BUF_AFTER(11279): 2 
09-05 13:16:54.553: I/IN_BUF_AFTER(11279): -58 
09-05 13:16:54.558: I/IN_BUF_AFTER(11279): 0 
09-05 13:16:54.558: I/IN_BUF_AFTER(11279): 0 
...truncated to save space ... 
09-05 13:16:54.618: I/IN_BUF_AFTER(11279): 0 
09-05 13:16:54.618: I/IN_BUF_AFTER(11279): 0 
09-05 13:16:54.618: I/IN_BUFFER(11279): We now send to handler.
09-05 13:16:54.618: I/IN_BUFFER(11279): Read Stream into Buffer:
09-05 13:16:54.618: V/BluetoothSocket.cpp(11279): readNative
09-05 13:16:54.623: I/IN_BUFFER(11279): The entire buffer after read stream into buffer: 17 
09-05 13:16:54.623: I/IN_BUF_AFTER(11279): 48 
09-05 13:16:54.623: I/IN_BUF_AFTER(11279): 48 
09-05 13:16:54.623: I/IN_BUF_AFTER(11279): 48 
09-05 13:16:54.623: I/IN_BUF_AFTER(11279): 48 
09-05 13:16:54.628: I/IN_BUF_AFTER(11279): 48 
09-05 13:16:54.628: I/IN_BUF_AFTER(11279): 44 
09-05 13:16:54.628: I/IN_BUF_AFTER(11279): 48 
09-05 13:16:54.628: I/IN_BUF_AFTER(11279): 48 
09-05 13:16:54.633: I/IN_BUF_AFTER(11279): 49 
09-05 13:16:54.633: I/IN_BUF_AFTER(11279): 50 
09-05 13:16:54.638: I/IN_BUF_AFTER(11279): 48 
09-05 13:16:54.638: I/IN_BUF_AFTER(11279): 44 
09-05 13:16:54.638: I/IN_BUF_AFTER(11279): 85 
09-05 13:16:54.638: I/IN_BUF_AFTER(11279): 13 
09-05 13:16:54.638: I/IN_BUF_AFTER(11279): -57 
09-05 13:16:54.648: I/IN_BUF_AFTER(11279): 3 
09-05 13:16:54.648: I/IN_BUF_AFTER(11279): 6 
09-05 13:16:54.648: I/IN_BUF_AFTER(11279): 0 
09-05 13:16:54.648: I/IN_BUF_AFTER(11279): 0 
...truncated to save space ... 
09-05 13:16:54.653: I/IN_BUF_AFTER(11279): 0 
09-05 13:16:54.653: I/IN_BUF_AFTER(11279): 0 
09-05 13:16:54.653: I/IN_BUFFER(11279): We now send to handler.
09-05 13:16:54.653: I/IN_BUFFER(11279): Read Stream into Buffer:
09-05 13:16:54.653: V/BluetoothSocket.cpp(11279): readNative
09-05 13:16:54.658: I/MESSAGE_READ(11279): I am reading 2 bytes
09-05 13:16:54.658: I/Content(11279): The entire array:
09-05 13:16:54.658: I/some hardcoded tag(11279): 0 
09-05 13:16:54.663: I/some hardcoded tag(11279): 0 
09-05 13:16:54.723: I/MESSAGE_READ(11279): I am reading 17 bytes
09-05 13:16:54.723: I/Content(11279): The entire array:
09-05 13:16:54.723: I/some hardcoded tag(11279): 0 
09-05 13:16:54.723: I/some hardcoded tag(11279): 0 
09-05 13:16:54.723: I/some hardcoded tag(11279): 0 
09-05 13:16:54.723: I/some hardcoded tag(11279): 0 
09-05 13:16:54.723: I/some hardcoded tag(11279): 0 
09-05 13:16:54.723: I/some hardcoded tag(11279): 0 
09-05 13:16:54.723: I/some hardcoded tag(11279): 0 
09-05 13:16:54.723: I/some hardcoded tag(11279): 0 
09-05 13:16:54.723: I/some hardcoded tag(11279): 0 
09-05 13:16:54.723: I/some hardcoded tag(11279): 0 
09-05 13:16:54.723: I/some hardcoded tag(11279): 0 
09-05 13:16:54.723: I/some hardcoded tag(11279): 0 
09-05 13:16:54.723: I/some hardcoded tag(11279): 0 
09-05 13:16:54.723: I/some hardcoded tag(11279): 0 
09-05 13:16:54.728: I/some hardcoded tag(11279): 0 
09-05 13:16:54.728: I/some hardcoded tag(11279): 0 
09-05 13:16:54.728: I/some hardcoded tag(11279): 0 
```

我的新代码还在读取最新流之前将缓冲区重置为 0，因此消息处理程序只看到 0，在我这样做之前，日志显示如下：

```
09-05 13:06:20.508: V/BluetoothSocket.cpp(10176): writeNative
09-05 13:06:20.533: I/IN_BUFFER(10176): The entire buffer after read stream into buffer: 2 
09-05 13:06:20.533: I/IN_BUF_AFTER(10176): 2 
09-05 13:06:20.533: I/IN_BUF_AFTER(10176): -58 
09-05 13:06:20.533: I/IN_BUF_AFTER(10176): 0 
09-05 13:06:20.533: I/IN_BUF_AFTER(10176): 0 
09-05 13:06:20.538: I/IN_BUF_AFTER(10176): 0 
09-05 13:06:20.538: I/IN_BUF_AFTER(10176): 0 
09-05 13:06:20.548: I/IN_BUF_AFTER(10176): 0 
09-05 13:06:20.548: I/IN_BUF_AFTER(10176): 0 
09-05 13:06:20.548: I/IN_BUF_AFTER(10176): 0 
09-05 13:06:20.553: I/IN_BUF_AFTER(10176): 0 
09-05 13:06:20.553: I/IN_BUF_AFTER(10176): 0 
09-05 13:06:20.568: I/IN_BUF_AFTER(10176): 0 
09-05 13:06:20.568: I/IN_BUF_AFTER(10176): 0 
09-05 13:06:20.568: I/IN_BUF_AFTER(10176): 0 
09-05 13:06:20.568: I/IN_BUF_AFTER(10176): 0 
09-05 13:06:20.568: I/IN_BUF_AFTER(10176): 0 
09-05 13:06:20.568: I/IN_BUF_AFTER(10176): 0 
09-05 13:06:20.568: I/IN_BUF_AFTER(10176): 0 
09-05 13:06:20.568: I/IN_BUF_AFTER(10176): 0 
09-05 13:06:20.568: I/IN_BUF_AFTER(10176): 0 
09-05 13:06:20.568: I/IN_BUF_AFTER(10176): 0 
09-05 13:06:20.568: I/IN_BUF_AFTER(10176): 0 
09-05 13:06:20.573: I/IN_BUF_AFTER(10176): 0 
09-05 13:06:20.573: I/IN_BUF_AFTER(10176): 0 
09-05 13:06:20.573: I/IN_BUF_AFTER(10176): 0 
09-05 13:06:20.573: I/IN_BUF_AFTER(10176): 0 
09-05 13:06:20.573: I/IN_BUF_AFTER(10176): 0 
09-05 13:06:20.578: I/IN_BUF_AFTER(10176): 0 
09-05 13:06:20.578: I/IN_BUF_AFTER(10176): 0 
09-05 13:06:20.578: I/IN_BUF_AFTER(10176): 0 
09-05 13:06:20.578: I/IN_BUFFER(10176): We now send to handler.
09-05 13:06:20.578: I/IN_BUFFER(10176): Read Stream into Buffer:
09-05 13:06:20.578: V/BluetoothSocket.cpp(10176): readNative
09-05 13:06:20.578: I/IN_BUFFER(10176): The entire buffer after read stream into buffer: 17 
09-05 13:06:20.578: I/IN_BUF_AFTER(10176): 48 
09-05 13:06:20.578: I/IN_BUF_AFTER(10176): 48 
09-05 13:06:20.583: I/IN_BUF_AFTER(10176): 48 
09-05 13:06:20.583: I/IN_BUF_AFTER(10176): 48 
09-05 13:06:20.583: I/IN_BUF_AFTER(10176): 48 
09-05 13:06:20.593: I/IN_BUF_AFTER(10176): 44 
09-05 13:06:20.593: I/IN_BUF_AFTER(10176): 48 
09-05 13:06:20.593: I/IN_BUF_AFTER(10176): 48 
09-05 13:06:20.593: I/IN_BUF_AFTER(10176): 49 
09-05 13:06:20.593: I/IN_BUF_AFTER(10176): 51 
09-05 13:06:20.593: I/IN_BUF_AFTER(10176): 48 
09-05 13:06:20.593: I/IN_BUF_AFTER(10176): 44 
09-05 13:06:20.593: I/IN_BUF_AFTER(10176): 85 
09-05 13:06:20.593: I/IN_BUF_AFTER(10176): 13 
09-05 13:06:20.598: I/IN_BUF_AFTER(10176): -57 
09-05 13:06:20.598: I/IN_BUF_AFTER(10176): 3 
09-05 13:06:20.613: I/IN_BUF_AFTER(10176): 6 
09-05 13:06:20.613: I/IN_BUF_AFTER(10176): 0 
...truncated to save space ... 
09-05 13:06:20.623: I/IN_BUF_AFTER(10176): 0 
09-05 13:06:20.623: I/IN_BUFFER(10176): We now send to handler.
09-05 13:06:20.623: I/IN_BUFFER(10176): Read Stream into Buffer:
09-05 13:06:20.623: V/BluetoothSocket.cpp(10176): readNative
09-05 13:06:20.628: I/MESSAGE_READ(10176): I am reading 2 bytes
09-05 13:06:20.628: I/Content(10176): The entire array:
09-05 13:06:20.628: I/some hardcoded tag(10176): 48 
09-05 13:06:20.628: I/some hardcoded tag(10176): 48 
09-05 13:06:20.688: I/MESSAGE_READ(10176): I am reading 17 bytes
09-05 13:06:20.688: I/Content(10176): The entire array:
09-05 13:06:20.688: I/some hardcoded tag(10176): 48 
09-05 13:06:20.688: I/some hardcoded tag(10176): 48 
09-05 13:06:20.688: I/some hardcoded tag(10176): 48 
09-05 13:06:20.688: I/some hardcoded tag(10176): 48 
09-05 13:06:20.688: I/some hardcoded tag(10176): 48 
09-05 13:06:20.688: I/some hardcoded tag(10176): 44 
09-05 13:06:20.688: I/some hardcoded tag(10176): 48 
09-05 13:06:20.693: I/some hardcoded tag(10176): 48 
09-05 13:06:20.693: I/some hardcoded tag(10176): 49 
09-05 13:06:20.693: I/some hardcoded tag(10176): 51 
09-05 13:06:20.693: I/some hardcoded tag(10176): 48 
09-05 13:06:20.693: I/some hardcoded tag(10176): 44 
09-05 13:06:20.693: I/some hardcoded tag(10176): 85 
09-05 13:06:20.693: I/some hardcoded tag(10176): 13 
09-05 13:06:20.693: I/some hardcoded tag(10176): -57 
09-05 13:06:20.693: I/some hardcoded tag(10176): 3 
09-05 13:06:20.693: I/some hardcoded tag(10176): 6 
09-05 13:06:21.788: V/BluetoothSocket.cpp(10176): writeNative
09-05 13:06:21.803: I/IN_BUFFER(10176): The entire buffer after read stream into buffer: 2 
09-05 13:06:21.803: I/IN_BUF_AFTER(10176): 2 
09-05 13:06:21.803: I/IN_BUF_AFTER(10176): -58 
09-05 13:06:21.803: I/IN_BUF_AFTER(10176): 48 
09-05 13:06:21.803: I/IN_BUF_AFTER(10176): 48 
09-05 13:06:21.808: I/IN_BUF_AFTER(10176): 48 
09-05 13:06:21.808: I/IN_BUF_AFTER(10176): 44 
09-05 13:06:21.818: I/IN_BUF_AFTER(10176): 48 
09-05 13:06:21.818: I/IN_BUF_AFTER(10176): 48 
09-05 13:06:21.818: I/IN_BUF_AFTER(10176): 49 
09-05 13:06:21.823: I/IN_BUF_AFTER(10176): 51 
09-05 13:06:21.823: I/IN_BUF_AFTER(10176): 48 
09-05 13:06:21.828: I/IN_BUF_AFTER(10176): 44 
09-05 13:06:21.828: I/IN_BUF_AFTER(10176): 85 
09-05 13:06:21.833: I/IN_BUF_AFTER(10176): 13 
09-05 13:06:21.848: I/IN_BUF_AFTER(10176): -57 
09-05 13:06:21.848: I/IN_BUF_AFTER(10176): 3 
09-05 13:06:21.848: I/IN_BUF_AFTER(10176): 6 
09-05 13:06:21.853: I/IN_BUF_AFTER(10176): 0 
...truncated to save space ... 
09-05 13:06:21.853: I/IN_BUF_AFTER(10176): 0 
09-05 13:06:21.853: I/IN_BUFFER(10176): We now send to handler.
09-05 13:06:21.858: I/IN_BUFFER(10176): Read Stream into Buffer:
09-05 13:06:21.858: V/BluetoothSocket.cpp(10176): readNative
09-05 13:06:21.858: I/IN_BUFFER(10176): The entire buffer after read stream into buffer: 17 
09-05 13:06:21.858: I/IN_BUF_AFTER(10176): 48 
09-05 13:06:21.863: I/IN_BUF_AFTER(10176): 48 
09-05 13:06:21.863: I/IN_BUF_AFTER(10176): 48 
09-05 13:06:21.863: I/IN_BUF_AFTER(10176): 48 
09-05 13:06:21.863: I/IN_BUF_AFTER(10176): 48 
09-05 13:06:21.863: I/IN_BUF_AFTER(10176): 44 
09-05 13:06:21.868: I/IN_BUF_AFTER(10176): 48 
09-05 13:06:21.868: I/IN_BUF_AFTER(10176): 48 
09-05 13:06:21.868: I/IN_BUF_AFTER(10176): 49 
09-05 13:06:21.868: I/IN_BUF_AFTER(10176): 51 
09-05 13:06:21.868: I/IN_BUF_AFTER(10176): 48 
09-05 13:06:21.868: I/IN_BUF_AFTER(10176): 44 
09-05 13:06:21.868: I/IN_BUF_AFTER(10176): 85 
09-05 13:06:21.868: I/IN_BUF_AFTER(10176): 13 
09-05 13:06:21.868: I/IN_BUF_AFTER(10176): -57 
09-05 13:06:21.868: I/IN_BUF_AFTER(10176): 3 
09-05 13:06:21.873: I/IN_BUF_AFTER(10176): 6 
09-05 13:06:21.873: I/IN_BUF_AFTER(10176): 0 
...truncated to save space ...
09-05 13:06:21.893: I/IN_BUF_AFTER(10176): 0 
09-05 13:06:21.893: I/IN_BUFFER(10176): We now send to handler.
09-05 13:06:21.893: I/IN_BUFFER(10176): Read Stream into Buffer:
09-05 13:06:21.898: V/BluetoothSocket.cpp(10176): readNative
09-05 13:06:21.903: I/MESSAGE_READ(10176): I am reading 2 bytes
09-05 13:06:21.903: I/Content(10176): The entire array:
09-05 13:06:21.903: I/some hardcoded tag(10176): 48 
09-05 13:06:21.903: I/some hardcoded tag(10176): 48 
09-05 13:06:21.958: I/MESSAGE_READ(10176): I am reading 17 bytes
09-05 13:06:21.958: I/Content(10176): The entire array:
09-05 13:06:21.958: I/some hardcoded tag(10176): 48 
09-05 13:06:21.958: I/some hardcoded tag(10176): 48 
09-05 13:06:21.958: I/some hardcoded tag(10176): 48 
09-05 13:06:21.958: I/some hardcoded tag(10176): 48 
09-05 13:06:21.958: I/some hardcoded tag(10176): 48 
09-05 13:06:21.958: I/some hardcoded tag(10176): 44 
09-05 13:06:21.958: I/some hardcoded tag(10176): 48 
09-05 13:06:21.958: I/some hardcoded tag(10176): 48 
09-05 13:06:21.958: I/some hardcoded tag(10176): 49 
09-05 13:06:21.958: I/some hardcoded tag(10176): 51 
09-05 13:06:21.958: I/some hardcoded tag(10176): 48 
09-05 13:06:21.958: I/some hardcoded tag(10176): 44 
09-05 13:06:21.958: I/some hardcoded tag(10176): 85 
09-05 13:06:21.958: I/some hardcoded tag(10176): 13 
09-05 13:06:21.958: I/some hardcoded tag(10176): -57 
09-05 13:06:21.963: I/some hardcoded tag(10176): 3 
09-05 13:06:21.963: I/some hardcoded tag(10176): 6 
```

我希望这并没有混淆这个问题，但实际上演示了很多人在添加蓝牙聊天演示代码以供自己使用时似乎遇到的问题。不知何故，我们需要防止缓冲区被覆盖，直到消息处理程序读取它？问候

阿德里安·雷福德

由于 Sleep，更新的代码工作得更好！

```
public void run() {
            Log.i(TAG, "BEGIN  IN mConnectedThread");
            byte[] buffer = new byte[1024];
            int bytes;

            // Keep listening to the InputStream while connected
            while (true) {
                try {
                      try {
                        sleep(100);
                    } catch (InterruptedException e) {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                    }
                    bytes = mmInStream.available();
                    Log.i("IN_BUFFER", "mmInStream-available bytes: " + Integer.toString(bytes)+ " ");
                    if (bytes>0){ 
                    for(int i=0; i<30; i++){ 
                       buffer[i] = 0;}
                    // Read from the InputStream
                    Log.i("IN_BUFFER", "Read Stream into Buffer:");
                    bytes = mmInStream.read(buffer);

                    Log.i("IN_BUFFER", "The entire buffer after read stream into buffer: " + Integer.toString(bytes)+ " "); 
                    for(int i=0; i<30; i++) 
                         Log.i("IN_BUF_AFTER", buffer[i] + " ");
                    // Send the obtained bytes to the UI Activity
                    Log.i("IN_BUFFER", "We now send to handler.");
                    mHandler.obtainMessage(BluetoothScale.MESSAGE_READ, bytes, -1, buffer)
                            .sendToTarget();}
                } catch (IOException e) {
                    Log.e(TAG, "disconnected", e);
                    connectionLost();
                    // Start the service over to restart listening mode
                    BluetoothScaleService.this.start();
                    break;
                }
            }
        } 
```

现在日志如下所示：

```
09-05 20:57:15.833: V/BluetoothSocket.cpp(25368): availableNative
09-05 20:57:15.838: I/IN_BUFFER(25368): mmInStream-available bytes: 0 
09-05 20:57:15.888: V/BluetoothSocket.cpp(25368): availableNative
09-05 20:57:15.888: I/IN_BUFFER(25368): mmInStream-available bytes: 0 
09-05 20:57:15.943: V/BluetoothSocket.cpp(25368): availableNative
09-05 20:57:15.943: I/IN_BUFFER(25368): mmInStream-available bytes: 0 
09-05 20:57:15.958: V/BluetoothSocket.cpp(25368): writeNative
09-05 20:57:15.988: V/BluetoothSocket.cpp(25368): availableNative
09-05 20:57:15.993: I/IN_BUFFER(25368): mmInStream-available bytes: 2 
09-05 20:57:15.993: I/IN_BUFFER(25368): Read Stream into Buffer:
09-05 20:57:15.993: V/BluetoothSocket.cpp(25368): readNative
09-05 20:57:15.998: I/IN_BUFFER(25368): The entire buffer after read stream into buffer: 19 
09-05 20:57:15.998: I/IN_BUF_AFTER(25368): 2 
09-05 20:57:15.998: I/IN_BUF_AFTER(25368): -58 
09-05 20:57:16.003: I/IN_BUF_AFTER(25368): 48 
...truncated to save space ... 
09-05 20:57:16.033: I/IN_BUF_AFTER(25368): 85 
09-05 20:57:16.033: I/IN_BUF_AFTER(25368): 13 
09-05 20:57:16.033: I/IN_BUF_AFTER(25368): -57 
09-05 20:57:16.033: I/IN_BUF_AFTER(25368): 3 
09-05 20:57:16.038: I/IN_BUF_AFTER(25368): 6 
09-05 20:57:16.038: I/IN_BUF_AFTER(25368): 0 
...truncated to save space ... 
09-05 20:57:16.043: I/IN_BUF_AFTER(25368): 0 
09-05 20:57:16.043: I/IN_BUFFER(25368): We now send to handler.
09-05 20:57:16.058: I/MESSAGE_READ(25368): I am reading 19 bytes
09-05 20:57:16.058: I/Content(25368): The entire array:
09-05 20:57:16.058: I/some hardcoded tag(25368): 2 
09-05 20:57:16.058: I/some hardcoded tag(25368): -58 
09-05 20:57:16.058: I/some hardcoded tag(25368): 48 
...truncated to save space ...
09-05 20:57:16.063: I/some hardcoded tag(25368): 13 
09-05 20:57:16.063: I/some hardcoded tag(25368): -57 
09-05 20:57:16.063: I/some hardcoded tag(25368): 3 
09-05 20:57:16.063: I/some hardcoded tag(25368): 6 
09-05 20:57:16.093: V/BluetoothSocket.cpp(25368): availableNative
09-05 20:57:16.093: I/IN_BUFFER(25368): mmInStream-available bytes: 0 
```

请注意 mmInStream.available() 返回 2 个字节，然后在我们读取缓冲区的下一行代码中，读取了 19 个字节......真的很奇怪，它是如何在这两个所谓的直接步骤之间填充的。在重写缓冲区之前，睡眠似乎允许处理程序有足够的时间从传递的缓冲区读取消息。

我本来希望 handler.obtainmessage... 发送一个唯一的缓冲区，但似乎将引用发送到线程缓冲区，因此很麻烦。如何每次发送一个唯一的缓冲区？谢谢阿德里安

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-05T20:08:31.220

在使用蓝牙聊天示例之前，我已经看到人们遇到过此类问题。示例代码的问题在于，发送到的消息对象`Handler`仅包含对`byte[]`用于每个后续`read()`操作的实际数组的引用。这意味着一旦`Handler`获得消息并开始检查数组，`read()`蓝牙套接字上的后续操作就已经有机会将更新的数据写入该数组。

在这行代码中：

```
mHandler.obtainMessage(BluetoothChat.MESSAGE_READ, bytes, -1, buffer)
                        .sendToTarget() 
```

数组*没有*被复制；而是消息只是将对象引用传递给同一数组。

蓝牙聊天示例用于其最初目的的唯一原因是因为它的目的是以人类打字速度传达短串字符。如果您发送比这更快的任何东西，那么`Handler`从该数组读取的内容就会变成垃圾。

答案是发送数组的副本（例如`System.arraycopy()`）或使用简单的循环缓冲区，这是我自己的蓝牙应用程序使用的。

前两个字节被破坏的事实很奇怪，但这可能只是因为特定设备上蓝牙堆栈中底层读取操作的具体实现。一个简单的事实是，一旦您`read()`使用该缓冲区进行调用，您不应该同时接触该缓冲区或关心其中的内容。也许您设备上的特定蓝牙套接字读取实现对缓冲区中的前几个字节做了一些事情，因为它与它的内部操作有关。但是你不应该关心缓冲区在`read()`阻塞时处于什么样的有趣中间状态，因为那时没有其他线程应该试图理解它。您所关心的只是缓冲区在`read()`返回时处于有效状态且数据有效。

使用该`sleep()`操作显然可以部分“解决”问题的原因是因为它是一种粗略的方式，可以让您在后续操作`Handler`处理数组之前花时间查看数组。`read()`虽然这不是一个好的解决方案。

您遇到的第二个问题是由于在 Java 中`byte`已签名。这就是调试器将字节显示为有符号值的原因。在您的应用程序中，如果您需要使用给定的字节作为 an`int`并且该字节最初是无符号的，您可以执行以下操作：

```
int someValue = myByteArray[someIndex] & 0xff; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-13T23:36:38.650

我认为您看到的问题是例如 198 变成 -58 是因为 Java 使用有符号字节，所以超过 127 的任何内容都是负数。所以 198 二进制被视为 -(256 - 198) = -58。
解决方案是使用如下代码将其转换为 int：

```
private int UByte(byte b){
        if(b<0) // if negative
            return (int)( (b&0x7F) + 128 );
        else
            return (int)b;
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-05-23T06:51:12.190

如前所述，数据不保证，蓝牙是像UDP一样的开放数据流。

我想需要对 rs232 有所了解才能知道何时将字节打包在一起或单独发送。

对于一个微控制器项目，想象一下：

```
if (data_ready) echo read_byte(); 
```

使用 PIC 微芯片，生成的数据类似于：

```
0 0 0 0 0 0 0 h 0 0 0 0 e 0 0 0 0 0 0 l 0 0 0 0 0 0 l 0 0 0 0 0 0 o ... 
```

使用 Android 到微控制器项目，我目前正在做类似的事情：

```
do {instream.read()} while (!DELIMETER) 
```

我发现在读取蓝牙数据流时，您需要高效地使用代码。使用 read() 以外的输入流方法，我几乎总是会错过第一个字节。

我刚开始使用蓝牙智能，我想这完全不同，因为数据仅在可用时发送。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-04T13:26:59.400

不知道为什么会发生这种情况，但这可能是一些奇怪的竞争条件。您的代码的问题之一是它想要读取所有时间的数据！即使没有数据。

因此，也许您读取了前 2 个字节，然后在随后的迭代中您再次读取了输入缓冲区而没有前 2 个字节（在这种情况下，调试器向您显示了错误的图片）。

您可以尝试改进的是通过添加这些行（不要尝试复制粘贴，我正在将代码调整为您之前的代码 - 它可能有效，也可能无效）：

```
bytes = mmInStream.getAvailable();
if (bytes>0) {
    Log.i("some hardcoded tag", "I am reading " + Integer.toString(bytes) + " bytes");
    //you could also print the entire bytearray
    /*
    Log.i("some hardcoded tag", "The entire array:");
    for(int i=0; i<bytes; i++)
         Log.i("some hardcoded tag", buffer[i] + " ");*/
    mmInStream.read(buffer);

    //and your code ..
    // Send the obtained bytes to the UI Activity
    mHandler.obtainMessage(BluetoothChat.MESSAGE_READ, bytes, -1, buffer)
                        .sendToTarget();

} 
```

请注意，我使用 Log.i 而不是调试器。如果您可以实现日志并且它们不会打扰您，那么对于多线程的东西会更好 - 而且执行起来更快并且更容易调试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-06T13:16:11.667

几周前我和你处于同样的位置。

我发现使用读取（缓冲区）时读取计数是随机的。所以你永远不会真正预测下一个数据包会有多大。

对我来说，简单的解决方法是使用 read() 一次读取一个字节并将其添加到本地缓冲区，直到接收到每个字节。

希望这可以帮助。

# css - IE9 上的 CSS3 优雅降级

> ID：12239699
> 
> 赞同：1
> 
> 时间：2012-09-02T20:55:48.770
> 
> 标签：css, internet-explorer-9

我正在通过Dan Cederholm*为 Web Designers 编写 CSS3 。*

我在公司环境中，当然必须考虑至少回到 IE7 的浏览器（如果不是 IE6！-eek！）。

我正在研究**Navigating the Moon**示例（从第 36 页开始）。

作者正在谈论在你的 CSS 中使用后备值来优雅地降级。

到现在为止还挺好。我在船上，只是想试一试。

问题是，当我浏览 IE 9 上的示例时，我得到了一些奇怪的结果。

这是`<body>`我页面的标签内容：

```
<ul id='nav'>
  <li><a href="#">Item 1</a></li>
  <li><a href="#">Item 2</a></li>
  <li><a href="#">Item 3</a></li>
  <li><a href="#">Item 4</a></li>
  <li><a href="#">Item 5</a></li>
</ul> 
```

如您所见，它**非常**基础。

这是我正在***尝试***使用的 CSS：

```
body {
  background: #000;
}
ul#nav {
  float: right;
  padding: 42px 0 0 30px;
}
ul#nav li {
  float: left;
  margin: 0 0 0 5px;
}
ul#nav li a {
  font-weight: bold;
  padding: 5px 15px;
  text-decoration: none;
  color: #cccccc;
  color: rgba(255, 255, 255, 0.7);
} 
```

当我在 Safari 中查看页面时，一切都很好，并且 CSS 显示正确（如预期的那样）。当我在 IE 9 中查看此页面时，链接是正常的“HyperLink”蓝色（就像它只是忽略了两个`color`指令）。如果我从我的 CSS 中删除“rgba”行，链接会显示在`#cccccc`. 如果我用 替换“rgba”行`color: #000000`，链接就会消失（正如预期的那样，因为正文也是`#000000`）。

根据作者所写的内容，我认为放置第二行将在支持“rgba”标准的浏览器中工作，而那些不支持的浏览器会忽略它。

我错过了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T05:31:53.270

发布的代码似乎导致了所描述的现象，但仅限于 Quirks Mode。如果页面需要在 Quirks 模式下工作，那么恐怕您需要考虑笨拙的解决方法，例如使用带有备用代码副本的“条件 IE 注释”，在基本样式表之后显示，以便覆盖那里的相关设置（在 IE 上小于 9）。例子;

```
<style>
/* the basic style sheet here */
</style>
<!--[if IE lt 9]>
ul#nav li a {
  color: #cccccc;
}
<![endif]--> 
```

**编辑：**似乎在 Quirks 模式下，IE 的行为通常会导致具有无法识别值的声明甚至会导致先前设置的值被丢弃。例如，`h1 { color: red; color: nonsense }`保留`h1`其默认颜色，而不是红色。但这仅适用于 CSS 规则。如果您将声明放在单独的规则中，问题就会消失。

例如，在这里，您可以将规则`ul#nav li a`分成两部分：

```
ul#nav li a {
  font-weight: bold;
  padding: 5px 15px;
  text-decoration: none;
  color: #cccccc;
}
ul#nav li a {
  color: rgba(255, 255, 255, 0.7);
} 
```

# qt - 在发生拖动时更新 QGraphicsItem

> ID：12239700
> 
> 赞同：1
> 
> 时间：2012-09-02T20:55:55.637
> 
> 标签：qt, drag-and-drop, qgraphicsitem

我正在创建一个`QGraphicsView`衍生的小部件，除其他外，它需要在其中的项目之间创建连接——有点像控制流图。但我无法实现一种“绘制”连接的方法

我尝试了两种方法：

1.  `QGraphicsLineItem`在触发源对象时创建一个派生对象`mouseMoveEvent(..)`，并在每次后续移动时更新它。该线已成功绘制和更新，但最终这不起作用，因为似乎移动鼠标“锁定”事件循环只处理鼠标移动事件，所以另一个对象的 hoverEnterEvent(..)/hoverMoveEvent(..)/等等 不调用方法（这些方法是完成连接所必需的）。
2.  在 mouseMoveEvent(..) 中创建一个`QDrag`实例以创建两个对象之间的连接允许两个对象在删除后形成连接，但最终这不起作用，因为该`QDrag::exec()`调用无法通知其他对象鼠标移动- 所以绘制的连接无法更新。

我真的需要两者的混合：在一个完美的世界中，`QDrag::exec()`调用将允许其他某种鼠标移动通知，所以我可以更新表示连接的对象。有人有建议吗？

类似于这个[问题](https://stackoverflow.com/questions/3845615/detect-when-mouse-enter-qgraphicsitem-with-button-down?rq=1)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T02:05:44.477

我有一个开源小部件可以执行此操作，它适用于 PyQt，但它可能对您正在寻找的内容有所帮助。

您可以在[http://dev.projexsoftware.com/projects/projexui的 projexui 框架中找到它](http://dev.projexsoftware.com/projects/projexui)

您正在寻找的代码特别是在 projexui/widgets/xnodewidget 中找到的 XNodeWidget 类

最终，我使用鼠标按下事件通过场景启动连接并忽略该事件（基于某种触发器 - 控制按下或热点区域等）

希望有帮助！

（Orbiter 应用程序上的表格视图就是一个例子 - [http://www.projexsoftware.com/software/orbiter](http://www.projexsoftware.com/software/orbiter)）

# java - 在凯撒密码中引用数组中的字符

> ID：12239701
> 
> 赞同：2
> 
> 时间：2012-09-02T20:55:57.153
> 
> 标签：java, arrays, string, reference

我正在尝试学习 Java，并希望有人能指出我正确的方向。我正在尝试在 java 中构建一个凯撒密码程序，并且我正在尝试使用自定义字符串，并且无法引用由自定义字符串组成的数组（例如，移位为 1，'a' 会变成'b'，'z'会变成'A'，'?'会变成'@'，等等；实际的自定义字符串在程序的数组中列出）。我现在拥有程序的方式，它可以转换 az 和 AZ，但我需要它继续转换为特殊字符。我知道我现在没有引用我的字符串，但不知道如何让它这样做！任何帮助深表感谢！

```
package caesarcipher;

import java.util.Scanner;

public class Caesarcipher
{
public static void main(String[] args)
{
    Scanner scan = new Scanner (System.in);

    System.out.println("Please enter the shift you would like to use:");

    String shift = scan.next();

    int shiftvalue = Integer.parseInt(shift);

    System.out.println("The shift will be: " + shiftvalue);

    System.out.println("Please enter text:");

    String text = scan.next();

    String ciphertext = encryptCaesar(text, shiftvalue);

    System.out.println(ciphertext);
}
private static String encryptCaesar(String str, int shiftvalue)
{
        if (shiftvalue < 0) 
        {
            shiftvalue = 81 - (-shiftvalue % 81);
        }
    String result = "";
        for (int i = 0; i < str.length(); i++) 
        {
        char ch = encryptCharacter(str.charAt(i), shiftvalue);
        result += ch;
        }
    return result;
}
private static char encryptCharacter(char ch, int shiftvalue) 
{
    String[] values = {"a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z", "A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z", "0", "1", "2", "3", "4", "5", "6", "7", "8", "9", " ", "!", "\\", "\"", "#", "$", "%", "&", "'", "(", ")", ",", "-", ".", "/", ":", ";", "?", "@"};  

    if (Character.isLowerCase(ch))
        {
            ch = (char) ('a' + (Character.toLowerCase(ch) - 'a' + shiftvalue) % 81);
        }
    else if (Character.isUpperCase(ch))
        {
            ch = (char) ('a' + (Character.toUpperCase(ch) - 'a' + shiftvalue) % 81);
        }
    return ch;
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T21:09:40.843

您可以这样做来移动字母输入。它也适用于大于 26 的 shiftvalue。

```
public static String encrypt(String str, int shift)
{
String ciphered="";
char[] ch=str.toCharArray();
int exact=shift%26;
    if(exact<0)
    exact+=26;
int rotate=shift/26;
int i=0;
while(i<ch.length)
{
    if(Character.isLetter(ch[i]))
    {
        int check=Character.isUpperCase(ch[i])?90:122;
        ch[i]+=exact;
        if(check<ch[i])
        ch[i]=(char)(ch[i]-26);
        if(rotate%2==0)
        {
            if(Character.isLowerCase(ch[i]))
            ch[i]=Character.toUpperCase(ch[i]);
            else
            ch[i]=Character.toLowerCase(ch[i]);     
        }
    }   
        ciphered+=ch[i++];          
    }
return ciphered;
} 
```

# c++ - C++ - MySQL 客户端库 - 与 MinGW 静态链接？

> ID：12239704
> 
> 赞同：0
> 
> 时间：2012-09-02T20:56:19.800
> 
> 标签：c++, mysql, sql, static-libraries

我想开发一个使用远程 MySQL 服务器的 C++ 应用程序。我相信要做到这一点，我需要 MySQL 客户端库。

我使用MinGW编译，我需要.exe是独立的，所以它需要是静态的。

甚至可能吗？我尝试与社区下载提供的静态 mysqlclient.lib 链接，但它似乎不适用于 MinGW，我收到未定义的参考错误，例如`undefined reference to 'mysql_init@4'`.

如果可能的话，请有人解释一下，我到处搜索，但没有找到解决方案。

谢谢。

# entity-framework - 为什么我在使用 MVC4 时收到此“无效的对象名称 'dbo.*'”错误？

> ID：12239707
> 
> 赞同：3
> 
> 时间：2012-09-02T20:57:09.790
> 
> 标签：entity-framework, asp.net-mvc-4, visual-studio-2012

我收到此错误：

> 无效的对象名称“dbo.ImageMetas”。

在这条线上：

> 返回视图（db.Images.ToList（））；

我的数据库上下文如下所示：

```
public class GalleryContext : DbContext
{
    public GalleryContext()
        : base("DefaultConnection")
    {
    }

    public DbSet<ImageMeta> Images { get; set; }
    public DbSet<ImageFile> ImageFiles { get; set; }
} 
```

我的模型：

```
public class ImageMeta
{
    [Key]
    [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public int Id { get; set; }
    public UserProfile User { get; set; }
    public string Name { get; set; }
    public virtual ICollection<ImageFile> Files { get; set; } 
} 
```

这是一个全新的 MVC4 项目。我先编写模型，然后自动生成控制器。

我[检查了数据库](https://stackoverflow.com/a/5310619/65387)，确实该表丢失了。

我的印象是它会为我自动创建表格；正如[本教程](http://www.asp.net/mvc/tutorials/mvc-4/getting-started-with-aspnet-mvc4/accessing-your-models-data-from-a-controller)所建议的那样。

那么为什么不这样做呢？

* * *

好的，如果我添加一个以我的上下文命名的连接字符串（并删除基本构造函数），它现在可以工作了。那为什么我不能使用 DefaultConnection 呢？

```
<add name="GalleryContext"
   connectionString="Data Source=(LocalDB)\v11.0;AttachDbFilename=|DataDirectory|\gallery.mdf;Integrated Security=True"
   providerName="System.Data.SqlClient"
/> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T21:24:27.927

尝试将不存在的数据库放在连接字符串中。如果默认情况下不存在，EF Code-First 将创建数据库（当然，如果提供的凭据有权创建数据库），但不会更改现有数据库（因为它可能会影响您现有的数据）。

对现有数据库的更改应使用[代码优先迁移](http://msdn.microsoft.com/en-US/data/jj591621)来完成。

**编辑：**

或者，如果您根本不关心数据，您可以设置数据库初始化程序（即在 global.asax 应用程序启动中），每次更改模型时都会删除并重新创建数据库：

```
DbDatabase.SetInitializer<MyDBContext>(new DropCreateDatabaseIfModelChanges<MyDBContext>()); 
```

有关详细信息，请参阅[DropCreateDatabaseIfModelChanges 类](http://msdn.microsoft.com/en-us/library/gg679604%28v=vs.103%29.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-22T11:46:29.003

我遇到了这个问题并找到了一个解决方案，它要求 SQL 中的用户模式是 dbo 模式的，因此表是用 dbo 创建的。在他们开始时，问题解决了。

我假设这是一个需要由 MS 修复的错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-08-20T10:59:58.283

在使用数据库优先方法时，我也遇到了同样的问题。我的服务/服务的主机 web.config 中的连接字符串不正确。我更正了连接字符串并且它起作用了。

# c# - IHttpHandler IsReusable，但没有被重用

> ID：12239711
> 
> 赞同：5
> 
> 时间：2012-09-02T20:57:56.150
> 
> 标签：c#, asp.net, silverlight

我有一个 IHttpHandler ，我相信它可以从重用中受益，因为它的设置成本很高，而且是线程安全的。但是正在为每个请求创建一个新的处理程序。我的处理程序没有被重复使用。

以下是我的简单测试用例，没有昂贵的设置。这个简单的案例说明了我的问题：

```
public class MyRequestHandler : IHttpHandler
{
    int nRequestsProcessed = 0;

    public bool IsReusable
    {
        get { return true; }
    }

    public void ProcessRequest(HttpContext context)
    {
        nRequestsProcessed += 1;
        Debug.WriteLine("Requests processed by this handler: " + nRequestsProcessed);
        context.Response.ContentType = "text/plain";
        context.Response.Write("Hello World");
    }
}

Requests processed by this handler: 1
Requests processed by this handler: 1
Requests processed by this handler: 1
Requests processed by this handler: 1... at least 100 times. I never see > 1. 
```

我是否误解了 IsReusable 的工作原理？还有其他东西可以打败重复使用吗？如果这有什么不同，我的处理程序将从 Silverlight 应用程序中调用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T21:03:25.700

IsReusable 不是保证。

只需重构您的处理程序并将所有交叉请求状态放入不同的类。**无论如何**，在最佳实践中清楚地分离 Web 应用程序中的交叉请求状态，因为它很危险。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T00:08:09.257

如果它是线程安全的，那么无论如何你都可以比重用更好。

当`IsReusable`返回 true 时：

1.  首先创建处理程序的一个实例。
2.  它`ProcessRequest`被称为。
3.  它**可能会**被放入池中以再次使用。

这意味着它可以减少重复的设置成本，但不一定（不能保证）并且不完全 - 如果对同一个 URI 有多个并发调用，则需要创建几个这样的处理程序来处理它们同时。

这种方法的好处是（当池确实发生时），处理程序实际上不必是线程安全的。

既然你是这样，我们可以通过两种方式之一做得更好。

一是把你所有的功能放到另一个类中。然后处理程序可以只是一个苗条类，其中`ProcessRequest`传递到该类的静态实例。

同样，我们可以使用 IHttpHandlerFactory 对您当前的类执行此操作：

```
public class MyRequestHandlerFactory : IHttpHandlerFactory
{
  private static MyRequestHandler SingletonHandler = new MyRequestHandler();
  IHttpHandler GetHandler(HttpContext context, string requestType, string url, string pathTranslated)
  {
    return SingletonHandler;
  }
  void ReleaseHandler(IHttpHandler handler)
  {
    //do nothing
  }
} 
```

使用上面的类，您只需将 Web.Config 更改为引用`MyRequestHandlerFactory`它当前引用的位置`MyRequestHandler`，它就会完美地工作。

（除非你实际上不像你想象的那样线程安全，在这种情况下 - 哎呀！）

# java - 实现模块化架构/简单的插件系统

> ID：12239713
> 
> 赞同：0
> 
> 时间：2012-09-02T20:58:18.617
> 
> 标签：java, plugins, architecture

我编写了一个简单的程序，从 XML 文件中获取一些命令，执行它，检查命令的错误，通过邮件报告等。命令的条目如下所示：

```
<command>C:\Program Files\Test\test.exe /xyz</command> 
```

现在我想介绍一些插件：

```
<command myPlugin1="abc,1" myPlugin2="def">C:\Program Files\Test\test.exe /xyz</command> 
```

我考虑将插件编写为实现某些接口的 Java 类或子类化某些 Plugin 类，然后使用类似的方法

```
pluginExec(List<String> parameters, String command) 
```

传递参数（例如 abc,1）和命令（C:\Program Files\Test\test.exe /xyz）。然后可能取命令标记的所有属性名称，因此 myPlugin1 和 myPlugin2，然后搜索与 myapp.plugins 命名空间上的属性名称相同的类并调用 pluginExec(...)。

有什么更好的想法吗？我想我的想法需要某种反思，有没有办法没有它？该应用程序是一个私有工具，无需重新编译软件即可添加插件。我只是不想每次都更改代码，我只想插入我的新插件类。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T21:02:07.557

如果您开发的基于插件的程序在未来不会增长很多，那么您的设计很好。

但是，如果您希望它增长并且希望向它添加多个特性，那么我建议您尝试像 OSGi 这样的 Java 标准。

# javascript - 从字符串中提取日期

> ID：12239716
> 
> 赞同：1
> 
> 时间：2012-09-02T20:59:07.443
> 
> 标签：javascript, regex, node.js, datetime

我正在尝试从字符串中创建一个日期提取器，以便在 YouTube 音乐会视频中捕获所有内容。许多视频标题的格式如下：

```
PHISH Reba Comcast Center Hartford CT. 6/18/2010
Phish - It's Ice - November 30, 1991
PHISH - 11.30.91 I didn't know
Phish/Worcester,MA 12-31-91 Llama
Phish: Tube / Runaway Jim [HD] 2011-01-01 - New York, NY
Phish - Stash (Live) 12.29.93 
```

这些只是其中的几个例子。基本上日期可以是从：`MM-DD-YYYY`到`MM-DD-YY`到`YY-MM-DD`等。每个 MM 和 DD 可以是 1 个或两个字符。每个 YYYY 可以是 2 或 4 个字符。字符从句点到破折号到斜线不等，`-`可以通过简单`/.?/`的正则表达式来修复。

我首先去掉空格，然后在字符串上运行这个简单的正则表达式：

```
str.replace((new RegExp(' ', 'g')), '').match(/(([0-9]{1,4}).?([0-9]{1,2}).?([0-9]{1,4}))/)

// to highlight the regex:
// (([0-9]{1,4}).?([0-9]{1,2}).?([0-9]{1,4})) 
```

这似乎工作得很好，但我还必须包括关于哪个数字是年份、月份、日期等的逻辑，以及检测误报。

此外，虽然我不希望能够将“11 月 2 日”检测为 11/2，但这会很酷 :)

任何人都可以推动我前进或提出任何解决方案吗？我不想使用库......我宁愿为此编写特定的代码，因为它并不是非常复杂。谢谢

这是一个测试环境（打开控制台查看结果），因此您可以轻松地使用数据。[http://jsfiddle.net/ZNLxW/4/](http://jsfiddle.net/ZNLxW/4/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T01:10:41.623

这是我的尝试（使用[jsfiddle](http://jsfiddle.net/some/wEmLG/)）

```
function formatDate(date) {
  function lz(value,w) {
    value = value.toString();
    return "0000".slice(4-w + value.length) + value;
  }
  return [
    lz(date.getFullYear(),4),
    lz(date.getMonth()+1,2),
    lz(date.getDate(),2)
  ].join('-');
}

//RegExp with support for short (XdYdZ) and long (month_in_text day, year)
var reDate = new RegExp([
  '(?:', // Short format
    '\\b',
    '(\\d{4}|\\d{1,2})',    // field.short_value_1
    '\\s*([./-])\\s*',      // field.short_del_1
    '(\\d{1,2})',           // field.short_value_2
    '\\s*([./-])\\s*',      // field.short_del 2
    '(\\d{4}|\\d{1,2})',    // field.short_value_3
    '\\b',
  ')|(?:', // Long format
    '\\b',
    '(',                    // field.long_month
    'jan(?:uary)?|',
    'feb(?:ruary)?|',
    'mar(?:ch)?|',
    'apr(?:il)?|',
    'may|',
    'jun(?:e)?|',
    'jul(?:y)?|',
    'aug(?:ust)?|',
    'sep(?:tember)?|',
    'oct(?:ober)?|',
    'nov(?:ember)?|',
    'dec(?:ember)?',
    ')',
    '\\s+',                 // required space
    '(\\d{1,2})\\b',        // field.long_date
    '\\s*',                 // optional space
    ',?',                   // optional delimiter
    '\\s*',                 // optinal space
    '(\\d{4}|\\d{2})\\b',   // field.long_year
  ')'
].join(''),'i');

//Month names, must be 3 chars lower case.
//Used to convert month name to number.
var  monthNames = [
  'jan', 'feb', 'mar', 'apr', 'may', 'jun',
  'jul','aug', 'sep', 'oct', 'nov', 'dev'
];

var extractDateFromString = function(str) {
    var m = str.match(reDate);
    var date;
    if (m) {
      var idx=-1;
      //Convert array form regexp result to named variables.
      //Makes it so much easier to change the regexp wihout
      //changing the rest of the code.
      var field = {
        all : m[++idx],
        short_value_1 : m[++idx],
        short_del_1 : m[++idx],
        short_value_2 : m[++idx],
        short_del_2 : m[++idx],
        short_value_3 : m[++idx],
        long_month : m[++idx],
        long_date : m[++idx],
        long_year : m[++idx]
      }

      //If field.long_month is set it is a date formated with named month
      if (field.long_month) {
        var month = monthNames.indexOf(
            field.long_month.slice(0,3).toLowerCase()
        );
        // TODO: Add test for sane year
        // TODO: Add test for sane month
        // TODO: Add test for sane date
        date = new Date(field.long_year,month,field.long_date);
      } else {
        // Short format: value_1 del_1 value_2 del_2 value_3
        var year, month, day;

        if (field.short_del_1 != field.short_del_2) {
          if (
            field.short_del_1 === '/' &&
            field.short_del_2 === '-'
          ) {
            // DD/MM-YYYY
            year = field.short_value_3;
            month = field.short_value_2;
            day = field.short_value_1;
            console.log('DMY',field.all,+year,+month,+day);
          } else {
            // TODO: Add other formats here.
            // If delimiters don't match it isn't a sane date.
            console.log('different delimiters');
          }
        } else {
          // assmume YMD if
          //   (delimiter = '-' and value_3 < 31)
          //   or (value_1 > 31) 
          if (
            (field.short_del_1 == '-' || field.short_value_1 > 31)
            && (field.short_value_3 < 32)
           ) {
            // YMD
            year = field.short_value_1;
            month = field.short_value_2;
            day = field.short_value_3;
            console.log('YMD',field.all,+year,+month,+day);
          } else {
            // MDY
            year = field.short_value_3;
            month = field.short_value_1;
            day = field.short_value_2;
            console.log('MDY',field.all,+year,+month,+day);
          }
        }

        if (year !== undefined) {
          year = +year; //convert to number
          //Handle years without a century 
          //year 00-49 = 2000-2049, 50-99 = 1950-1999
          if ( year < 100) {
            year += year < 50 ? 2000:1900;
          }
          date = new Date(year,+month-1,+day);
        }
      } 
    }

    var div = document.createElement('div');
    div.className = date ? 'pass' : 'fail';
    div.appendChild(document.createTextNode(date?formatDate(date):'NaD'));
    div.appendChild(document.createTextNode(' ' + str));
    document.body.appendChild(div);    
}
for (var i = 0; i < dates.length; i++) {
    extractDateFromString(dates[i].name)
} 
```

更新：调整了长格式的正则表达式（添加了 \b）

更新：再次调整正则表达式。不再有 3 位数字字段。（1、2 或 4 个）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-03T02:21:34.890

javascript 已经有一个 Date 对象：

[http://www.w3schools.com/jsref/jsref_obj_date.asp](http://www.w3schools.com/jsref/jsref_obj_date.asp)

尝试这个：

```
var d = new Date(dateString); 
```

# ios - 使用快速枚举删除 NSManagedObject 是否安全？

> ID：12239722
> 
> 赞同：3
> 
> 时间：2012-09-02T21:00:02.670
> 
> 标签：ios, core-data, fast-enumeration

您不应该通过快速枚举来修改正在迭代的集合，但我不确定这在多大程度上。下面的代码没有给我带来任何问题，但我不确定是不是我很幸运。有人有明确的答案吗？

```
for(NSManagedObject *myObject in myArray) {
   [myObject.managedObjectContext deleteObject:myObject];
} 
```

所以我并没有真正修改数组，而是从上下文中删除对象，这可能只是间接修改数组，但我不确定。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T21:04:25.487

你可以对数组中的对象做任何你想做的事情，只要你不改变数组本身。

该代码是完全可以接受的。

但是请注意，如果您有很多要删除的对象，您还应该考虑其他事情（例如预取关系、使用自动释放池、确保您的 MOC 保持清洁等）

# php - 获取包含搜索词的句子？

> ID：12239726
> 
> 赞同：1
> 
> 时间：2012-09-02T21:01:09.537
> 
> 标签：php, get

我想获得包含搜索词的句子。我已经尝试过了，但无法使其正常工作。

```
$string = "I think instead of trying to find sentences, I'd think about the amount of 
context around the search term I would need in words. Then go backwards some fraction of this number of words (or to the beginning) and forward the remaining number 
of words to select the rest of the context.";

$searchlocation = "fraction";

$offset = stripos( strrev(substr($string, $searchlocation)), '. ');
$startloc = $searchlocation - $offset;
echo $startloc; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T21:06:39.993

你可以得到所有的句子。

试试这个：

```
$string = "I think instead of trying to find sentences, I'd think about the amount of 
context around the search term I would need in words. Then go backwards some fraction of this number of words (or to the beginning) and forward the remaining number 
of words to select the rest of the context.";

$searchlocation = "fraction";

$sentences = explode('.', $string);
$matched = array();
foreach($sentences as $sentence){
    $offset = stripos($sentence, $searchlocation);
    if($offset){ $matched[] = $sentence; }
}
var_export($matched); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T21:14:38.023

使用[array_filter](http://php.net/array_filter)函数

```
$sentences = explode('.', $string);
$result = array_filter(
    $sentences, 
    create_function('$x', "return strpos(\$x, '$searchlocation');")); 
```

注意：第二个参数中的双引号`create_function`是必须的。

如果你有匿名函数支持，你可以使用这个，

```
$result = array_filter($sentences, function($x) use($searchlocation){
        return strpos($x, $searchlocation)!==false;
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-02T21:06:45.720

由于你用 反转字符串`strrev()`，你会发现`[space].`而不是`.[space]`。

# node.js - Node.js / Express 响应事件

> ID：12239731
> 
> 赞同：14
> 
> 时间：2012-09-02T21:02:30.923
> 
> 标签：node.js

我正在尝试创建一个记录响应时间和状态代码并将其发送到数据库的中间件。但是，我不确定要使用什么事件。在节点的文档中有一个`close`事件，但它从未被触发。`end`也不行。但是，`header`确实如此，但我找不到任何文档。

```
app.use(function(req, res, next) {
  res.on('close', function() {
    console.log('close')
  })

  res.on('end', function() {
    console.log('end')
  })

  res.on('header', function() {
    console.log('header')
    console.log(res.statusCode)
  })

  next()
}) 
```

只会`header`触发，它会返回正确的 res.statusCode。

我的问题：

1.  为什么不`close`开火？为什么要`header`开火？
2.  这是一个可靠的方法吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2016-07-25T16:30:34.903

有一个[完成事件](https://nodejs.org/api/http.html#http_event_finish)，它在响应发送时发出。

```
app.use(function(req, res,next){
    res.on('finish', function(){
        console.log('the response has been sent');
    });
    next();
}); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-02T21:45:34.203

`close`仅当连接在 response.end() 调用之前终止时才会发出事件。 `header`触发的事件[`connect`](https://github.com/senchalabs/connect)。这不是 node.js http.ServerResponse 本机事件。

看`connect` [`responseTime`](https://github.com/senchalabs/connect/blob/master/lib/middleware/responseTime.js)中间件。我认为它应该对你有所帮助。

**更新**：

这是`header`事件文档[https://github.com/senchalabs/connect/blob/gh-pages/tests.md#patch](https://github.com/senchalabs/connect/blob/gh-pages/tests.md#patch)

`heder`[从https://github.com/senchalabs/connect/blob/master/lib/patch.js](https://github.com/senchalabs/connect/blob/master/lib/patch.js)代理的 writeHead 方法触发`connect`

# vba - 使用 vba 在 word 2010 中的现有内容控件之后添加内容控件

> ID：12239732
> 
> 赞同：1
> 
> 时间：2012-09-02T21:02:51.930
> 
> 标签：vba, ms-word, word-2010

更详细一点：

1.  我将（大量）带有内容控件的文档插入到单个文档中。
2.  每个文档中的内容控件之一是标题控件（链接到文档属性），它自然会接收与插入时目标文档的标题相同的值。
3.  使用 word 或 vba 重命名控件的标题和/或标记并不能解决问题（奇怪！）
4.  我建议的解决方案是创建一个具有不同名称的新控件，从原始标题控件复制 .range.text ，然后删除标题控件。

我有一个循环遍历所有需要更改的文件，效果很好。但是，无论我做什么，我创建的任何新控件都出现在文档的开头，而不是在正确的位置（有一个控件，前面有文档的代码）。

想法？顺便说一句，更改控件名称不起作用是否有任何合乎逻辑的原因？

当前代码：

```
Sub FieldChanger()

Dim docCur As Document
Dim strCurPath As String
Dim strCurFile As String
Dim rngTitle As Range
Dim strTitle As String
Dim ccName As ContentControl

strCurPath = "C:\Users\User\Desktop\BGS\Final\"
strCurFile = Dir(strCurPath & "*.docx")

Do While strCurrentFile <> ""
    Set docCur = Application.Documents.Open(strCurPath & strCurFile)
        With docCur.ContentControls
            .Item(1).LockContents = False //Unlock outer content control
            Set rngTitle = .Item(3).Range
            strTitle = rngTitle.Text
            rngTitle = rngTitle.Move(wdCharacter, 1)
            ccName = rngTitle.ContentControls.Add(wdContentControlRichText) //This line throws a 4198 error
            ccName.Title = "ccName"
            ccName.Tag = "ccName"
            ccName.Range = strTitle
            ccName.LockContentControl = True
            .Item(3).LockContentControl = False
            .Item(3).Delete
            .Item(1).LockContents = True //Lock outer content control
        End With
    docCur.Save
    docCur.Close
    strCurFile = Dir
Loop

End Sub 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T09:13:13.150

> 顺便说一句，更改控件名称不起作用是否有任何合乎逻辑的原因？

内容控制 (CC) 名称只是一个名称。从“标题”重命名 CC 不会改变 Word 从何处获取内容。将抄送命名为“标题”也不会导致 Word 将文档的标题字符串放入抄送中。如果您创建一个空文档，请插入 Title 文档属性（作为 CC）并查看

activedocument.ContentControls(1).XMLMapping.XPath

你可能会看到价值

/ns1:coreProperties[1]/ns0:title[1]

这就是告诉 Word 它需要将 Title 内置文档属性的值放在 CC 中，以及从哪里获取它的原因。您可以使用相同的机制将您自己的纯文本 CC 链接到内置属性，或者您可以将它们链接到您自己的“自定义 XML 部分”中的节点。但它们不必与任何东西联系起来。

至于代码，更像这样的东西怎么样（注意，我也将“strCurrentFile”更改为strCurFile）。我想知道您是否真的需要重新插入 CC 值作为新的 CC（即为什么不直接删除 CC 并将其现有值保留在那里）但假设您需要 CC 那里。

注意，作为 VBA 中的一般规则，您需要在设置范围变量和 CC 等对象的值时使用 Set 关键字。理论上，当您完成对象时，您还应该将对象设置为 Nothing（例如 Set rngTitle = Nothing）。我没有在这里添加那些东西。在 VB.NET 中，您不需要做任何这些事情。

```
Dim docCur As Document
Dim strCurPath As String
Dim strCurFile As String
Dim rngTitle As Range
Dim strTitle As String
Dim ccName As ContentControl

strCurPath = "C:\a\test\"
strCurFile = Dir(strCurPath & "*.docx")

Do While strCurFile <> ""
    Set docCur = Application.Documents.Open(strCurPath & strCurFile)
        With docCur.ContentControls
            .Item(1).LockContents = False 'Unlock outer content control
            Set rngTitle = .Item(3).Range
            strTitle = rngTitle.Text
            ' we need the following line to ensure that deleting the range
            ' does not remove the CC prematurely
            .Item(3).Temporary = False
            rngTitle.Delete
            rngTitle.Collapse wdCollapseStart
            ' Delete the control here instead of later
            .Item(3).LockContentControl = False
            .Item(3).Delete
            Set ccName = rngTitle.ContentControls.Add(wdContentControlRichText) 
            ccName.Title = "ccName"
            ccName.Tag = "ccName"
            ccName.Range = strTitle
            ccName.LockContentControl = True
            .Item(1).LockContents = True 'Lock outer content control
        End With
    docCur.Save
    docCur.Close
    strCurFile = Dir
Loop 
```

评论合并...

有一些插件可能会有所帮助，例如 cctw.codeplex.com 上的数据绑定工具包（最近未检查该链接）

# php - android上传进度条不起作用

> ID：12239733
> 
> 赞同：0
> 
> 时间：2012-09-02T21:03:02.223
> 
> 标签：php, android, android-networking, android-progressbar

我是 Android 编程的初学者，我正在尝试将图像上传到服务器。我在stackoverflow上找到了一些代码，我调整了它，它仍然不起作用。

问题是我的图片仍然无法上传。

**编辑我解决了问题**，我对服务器上的文件夹没有权限。现在我有一个新问题。进度条不起作用。它一直说 0 % 已传输

有人在我的代码中看到错误吗？

```
import android.app.Activity;
import android.app.AlertDialog;
import android.app.Dialog;
import android.app.ProgressDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.location.Location;
import android.location.LocationListener;
import android.location.LocationManager;
import android.os.AsyncTask;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.view.Window;
import android.widget.Button;
import android.widget.ImageView;

import java.io.DataInputStream;
import java.io.DataOutputStream;
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.net.HttpURLConnection;
import java.net.URL;

public class PreviewActivity extends Activity {

/** The captured image file. Get it's path from the starting intent */
private File mImage;

public static final String EXTRA_IMAGE_PATH = "extraImagePath"

/** Log tag */
private static final String TAG = "DFH";

/** Progress dialog id */
private static final int UPLOAD_PROGRESS_DIALOG = 0;
private static final int UPLOAD_ERROR_DIALOG = 1;
private static final int UPLOAD_SUCCESS_DIALOG = 2;

/** Handler to confirm button */
private Button mConfirm;

/** Handler to cancel button */
private Button mCancel;

/** Uploading progress dialog */
private ProgressDialog mDialog;

/**
 * Called when the activity is created
 *
 * We load the captured image, and register button callbacks
 */
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    requestWindowFeature(Window.FEATURE_INDETERMINATE_PROGRESS);
    setContentView(R.layout.preview);

    setResult(RESULT_CANCELED);

    // Import image
    Bundle extras = getIntent().getExtras();
    String imagePath = extras.getString(FotoActivity.EXTRA_IMAGE_PATH);
    Log.d("DFHprev", imagePath);
    mImage = new File(imagePath);
    if (mImage.exists()) {
        setResult(RESULT_OK);
        loadImage(mImage);
    }

    registerButtonCallbacks();

}

@Override
protected void onPause() {
    super.onPause();

}

/**
 * Register callbacks for ui buttons
 */
protected void registerButtonCallbacks() {
    // Cancel button callback
    mCancel = (Button) findViewById(R.id.preview_send_cancel);
    mCancel.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
            PreviewActivity.this.finish();
        }
    });

    // Confirm button callback
    mConfirm = (Button) findViewById(R.id.preview_send_confirm);
    mConfirm.setEnabled(true);
    mConfirm.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
            new UploadImageTask().execute(mImage);
        }
    });
}

/**
 * Initialize the dialogs
 */
@Override
protected Dialog onCreateDialog(int id) {
    switch(id) {
    case UPLOAD_PROGRESS_DIALOG:
        mDialog = new ProgressDialog(this);
        mDialog.setProgressStyle(ProgressDialog.STYLE_HORIZONTAL);
        mDialog.setCancelable(false);
        mDialog.setTitle(getString(R.string.progress_dialog_title_connecting));
        return mDialog;

    case UPLOAD_ERROR_DIALOG:
        AlertDialog.Builder builder = new AlertDialog.Builder(this);
        builder.setTitle(R.string.upload_error_title)
                .setIcon(android.R.drawable.ic_dialog_alert)
                .setMessage(R.string.upload_error_message)
                .setCancelable(false)
                .setPositiveButton(getString(R.string.retry), new          DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog, int which) {
                        PreviewActivity.this.finish();
                    }
                });
        return builder.create();

    case UPLOAD_SUCCESS_DIALOG:
        AlertDialog.Builder success = new AlertDialog.Builder(this);
        success.setTitle(R.string.upload_success_title)
                .setIcon(android.R.drawable.ic_dialog_info)
                .setMessage(R.string.upload_success_message)
                .setCancelable(false)
                .setPositiveButton(getString(R.string.success), new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog, int which) {
                        PreviewActivity.this.finish();
                    }
                });
        return success.create();

    default:
        return null;
    }
}

/**
 * Prepare the progress dialog
 */
@Override
protected void onPrepareDialog(int id, Dialog dialog) {
    switch(id) {
    case UPLOAD_PROGRESS_DIALOG:
        mDialog.setProgress(0);
        mDialog.setTitle(getString(R.string.progress_dialog_title_connecting));
    }
}

/**
 * Load the image file into the imageView
 *
 * @param image
 */
protected void loadImage(File image) {
    Bitmap bm = BitmapFactory.decodeFile(image.getPath());
    ImageView view = (ImageView) findViewById(R.id.preview_image);
    view.setImageBitmap(bm);
}

/**
 * Asynchronous task to upload file to server
 */
class UploadImageTask extends AsyncTask<File, Integer, Boolean> {

    /** Upload file to this url */
    private static final String UPLOAD_URL = "http://www.xxxx.x/xxxx/fotos";

    /** Send the file with this form name */
    private static final String FIELD_FILE = "file";

    /**
     * Prepare activity before upload
     */
    @Override
    protected void onPreExecute() {
        super.onPreExecute();
        setProgressBarIndeterminateVisibility(true);
        mConfirm.setEnabled(false);
        mCancel.setEnabled(false);
        showDialog(UPLOAD_PROGRESS_DIALOG);
    }

    /**
     * Clean app state after upload is completed
     */
    @Override
    protected void onPostExecute(Boolean result) {
        super.onPostExecute(result);
        setProgressBarIndeterminateVisibility(false);
        mConfirm.setEnabled(true);
        mDialog.dismiss();

        if (result) {
            showDialog(UPLOAD_SUCCESS_DIALOG);
        } else {
            showDialog(UPLOAD_ERROR_DIALOG);
        }
    }

    @Override
    protected Boolean doInBackground(File... image) {
        return doFileUpload(image[0], "UPLOAD_URL");
    }

    @Override
    protected void onProgressUpdate(Integer... values) {
        super.onProgressUpdate(values);

        if (values[0] == 0) {
            mDialog.setTitle(getString(R.string.progress_dialog_title_uploading));
        }

        mDialog.setProgress(values[0]);
    }

    private boolean doFileUpload(File file, String uploadUrl) {
        HttpURLConnection connection = null;
        DataOutputStream outputStream = null;
        DataInputStream inputStream = null;

        String pathToOurFile = file.getPath();
        String urlServer = "http://www.xxxx.x/xxxx/upload.php";
        String lineEnd = "\r\n";
        String twoHyphens = "--";
        String boundary =  "*****";

        // log pathtoourfile
        Log.d("DFHinUpl", pathToOurFile);

        int bytesRead, bytesAvailable, bufferSize;
        byte[] buffer;
        int maxBufferSize = 1*1024*1024;
        int sentBytes = 0;
        long fileSize = file.length();

        // log filesize
        String files= String.valueOf(fileSize);
        String buffers= String.valueOf(maxBufferSize);
        Log.d("fotosize",files);
        Log.d("buffers",buffers);

        try
        {
        FileInputStream fileInputStream = new FileInputStream(new File(pathToOurFile) );

        URL url = new URL(urlServer);
        connection = (HttpURLConnection) url.openConnection();

        // Allow Inputs & Outputs
        connection.setDoInput(true);
        connection.setDoOutput(true);
        connection.setUseCaches(false);

        // Enable POST method
        connection.setRequestMethod("POST");

        connection.setRequestProperty("Connection", "Keep-Alive");
        connection.setRequestProperty("Content-Type", "multipart/form-data;boundary="+boundary);

        outputStream = new DataOutputStream( connection.getOutputStream() );
        outputStream.writeBytes(twoHyphens + boundary + lineEnd);
        outputStream.writeBytes("Content-Disposition: form-data; name=\"uploadedfile\";filename=\"" + pathToOurFile +"\"" + lineEnd);
        outputStream.writeBytes(lineEnd);

        bytesAvailable = fileInputStream.available();
        bufferSize = Math.min(bytesAvailable, maxBufferSize);
        buffer = new byte[bufferSize];

        // Read file
        bytesRead = fileInputStream.read(buffer, 0, bufferSize);

        while (bytesRead > 0)
        {
        outputStream.write(buffer, 0, bufferSize);
        bytesAvailable = fileInputStream.available();
        bufferSize = Math.min(bytesAvailable, maxBufferSize);
        bytesRead = fileInputStream.read(buffer, 0, bufferSize);

        sentBytes += bufferSize;
        publishProgress((int)(sentBytes * 100 / fileSize));

        bytesAvailable = fileInputStream.available();
        bufferSize = Math.min(bytesAvailable, maxBufferSize);
        bytesRead = fileInputStream.read(buffer, 0, bufferSize);
        }

        outputStream.writeBytes(lineEnd);
        outputStream.writeBytes(twoHyphens + boundary + twoHyphens + lineEnd);

        // Responses from the server (code and message)
        int serverResponseCode = connection.getResponseCode();
        String serverResponseMessage = connection.getResponseMessage();

        fileInputStream.close();
        outputStream.flush();
        outputStream.close();
        try {
            int responseCode = connection.getResponseCode();
            return responseCode == 200;
        } catch (IOException ioex) {
            Log.e("DFHUPLOAD", "Upload file failed: " + ioex.getMessage(), ioex);
            return false;
        } catch (Exception e) {
            Log.e("DFHUPLOAD", "Upload file failed: " + e.getMessage(), e);
            return false;
        }
        }
        catch (Exception ex)
        {
            String msg= ex.getMessage();
        Log.d("DFHUPLOAD", msg);
        }
        return true;
}

}
} 
```

处理此上传的 PHP 代码如下：

```
 <?php
 $date=getdate();

      $urldate=$date['year'].$date['month'].$date['month'].$date['hours'].$date['minutes'].$date[     'seconds'];
 $target_path  = "./";
 $target_path = $target_path . basename( $_FILES['uploadedfile']['name']) . $urldate;
 if(move_uploaded_file($_FILES['uploadedfile']['tmp_name'], $target_path)) {
  echo "The file ".  basename( $_FILES['uploadedfile']['name']).
  " has been uploaded";
 } else{
  echo "There was an error uploading the file, please try again!";
 }
 ?> 
```

如果有人可以帮助我，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T21:11:41.880

在 onCreate() 中不应访问视图。尝试将一些代码移至 onStart()。

```
@Override
public void onStart()
{
    super.onStart();
    mImage = new File(imagePath);
    if (mImage.exists()) {
        setResult(RESULT_OK);
        loadImage(mImage);
    }

    registerButtonCallbacks();
} 
```

我没有运行代码，所以我不知道是否还有其他缺陷。

# java - 刽子手：如果正确的按钮点击应用程序挂起

> ID：12239737
> 
> 赞同：0
> 
> 时间：2012-09-02T21:04:05.263
> 
> 标签：java

在我的刽子手应用程序中，我为用户创建了一组按钮，然后从文件中随机选择在刽子手应用程序中猜测的单词...使用 JLabel 打印单词...但是只要一个按钮单击应用程序冻结。谁能告诉我这正在发生...

* * *

# 我是如何创建按钮的

```
for(char i = 'A'; i <= 'Z'; i++){
    String buttonText = new Character(i).toString();
    JButton button = getButton(buttonText);
    panel1.add(button);
} 
```

* * *

# 按钮动作监听器

```
public JButton getButton(final String text){
    final JButton button = new JButton(text);
    button.addActionListener(new ActionListener(){
        public void actionPerformed(ActionEvent e){
            if(original.toUpperCase().indexOf(button.getText())!=-1){
                guessString = text;
                guessLetter = guessString.charAt(0);
                StringBuilder builder = new StringBuilder(secret);
                while(error < 6){
                }
                for (int i = 0; i < original.length(); i++){
                    if (original.charAt(i) == guessLetter){
                        builder.setCharAt(i, guessLetter);
                    }
                }
                secret = builder.toString();
            }
            else{
                JOptionPane.showMessageDialog(null, "There is no " + text );
                error++;
                if(error >= 0) imageName = "hangman1.jpg";
                if(error >= 1) imageName = "hangman2.jpg";
                if(error >= 2) imageName = "hangman3.jpg";
                if(error >= 3) imageName = "hangman4.jpg";
                if(error >= 4) imageName = "hangman5.jpg";
                if(error >= 5) imageName = "hangman6.jpg";
                if(error >= 7) imageName = "hangman7.jpg"; 
            }
        }
    });
    return button;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T21:07:30.173

`actionPerformed`如果`error`小于 6 ，您有一个无限循环。

```
while(error < 6) {
} 
```

# opengl-es - 当使用骨架矩阵进行漫反射/定向照明时，我的着色器应该是什么样子？

> ID：12239741
> 
> 赞同：0
> 
> 时间：2012-09-02T21:04:33.517
> 
> 标签：opengl-es, opengl-es-2.0, webgl, lighting, vertex-shader

我在网上找到了如何执行漫射照明的示例，但我似乎找不到任何关于使用骨架矩阵时事情会如何变化的信息。

有人有我可以看的例子吗？

我专门以这个页面为例来学习扩散光照： [http ://learningwebgl.com/blog/?p=684](http://learningwebgl.com/blog/?p=684)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T22:06:46.377

无论您对顶点应用哪种变换，最重要的是保持一致；知道您在哪个空间进行转换。假设`object_matrix`是您的对象的转换和`camera_matrix`视图转换：

```
vec4 pos = VertexPosition;
// pos is in object space

pos = object_matrix * pos;
// pos is now in world space

pos = camera_matrix * pos;
// view space 
```

光照坐标通常在世界空间中，在这种情况下：

```
pos = object_matrix * pos;
// perform diffuse lighting computations here
pos = camera_matrix * pos; 
```

如果通过“骨骼矩阵”指代骨骼动画，它们是在对象空间中完成的。

希望这可以帮助。

# c# - 如何以编程方式将 PictureBox 控件添加到标签页控件

> ID：12239742
> 
> 赞同：2
> 
> 时间：2012-09-02T21:04:44.990
> 
> 标签：c#, .net, winforms

如何以编程方式将`PictureBox`控件添加到`TabPage`控件并适合其大小？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-02T21:08:24.970

```
PictureBox pb = new PictureBox();
pb.Dock = DockStyle.Fill;
tabPage.Controls.Add(pb); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-02T21:45:46.560

代码如下所示：

```
 var pb = new PictureBox();
        pb.Image = Bitmap.FromFile(@"\\filepath");
        pb.Dock = DockStyle.Fill;
        yourTabPage.Controls.Add(pb); 
```

但是，如果标签页的唯一目的是显示图像，则最好使用标签页本身的“背景图像”并使用它`BackgroundImageLayout`来保持图像大小，与添加`PictureBox`

# stored-procedures - 访问存储过程中获得的相关实体的 ObjectContext 错误（EF 4）

> ID：12239745
> 
> 赞同：0
> 
> 时间：2012-09-02T21:05:26.157
> 
> 标签：stored-procedures, entity-framework-4.1, relationship

我有以下存储过程：

```
ALTER PROCEDURE [dbo].[SP_BuscarBien_servicio]
@campo varchar(50),
@numPags int,
@numRegs int
AS
BEGIN
    SELECT TOP (@numRegs) 
        [Project1].[BS_Id] AS [BS_Id], 
        [Project1].[BS_Descripcion] AS [BS_Descripcion], 
        [Project1].[UNM_Id] AS [UNM_Id], 
        [Project1].[BS_CostoPromedio] AS [BS_CostoPromedio], 
        [Project1].[BSTIP_Id] AS [BSTIP_Id], 
        [Project1].[UNM_Id1] AS [UNM_Id1], 
        [Project1].[UNM_Descripcion] AS [UNM_Descripcion], 
        [Project1].[BSTIP_Id1] AS [BSTIP_Id1], 
        [Project1].[BSTIP_Descripcion] AS [BSTIP_Descripcion]
        FROM ( 
            SELECT [Project1].[BS_Id] AS [BS_Id], 
                   [Project1].[BS_Descripcion] AS [BS_Descripcion], 
                   [Project1].[UNM_Id] AS [UNM_Id], 
                   [Project1].[BS_CostoPromedio] AS [BS_CostoPromedio], 
                   [Project1].[BSTIP_Id] AS [BSTIP_Id], 
                   [Project1].[UNM_Id1] AS [UNM_Id1], 
                   [Project1].[UNM_Descripcion] AS [UNM_Descripcion], 
                   [Project1].[BSTIP_Id1] AS [BSTIP_Id1], 
                   [Project1].[BSTIP_Descripcion] AS [BSTIP_Descripcion], 
                   row_number() OVER (ORDER BY [Project1].[BS_Descripcion] ASC) AS [row_number]
            FROM ( SELECT 
                    [Extent1].[BS_Id] AS [BS_Id], 
                    [Extent1].[BS_Descripcion] AS [BS_Descripcion], 
                    [Extent1].[UNM_Id] AS [UNM_Id], 
                    [Extent1].[BS_CostoPromedio] AS [BS_CostoPromedio], 
                    [Extent1].[BSTIP_Id] AS [BSTIP_Id], 
                    [Extent2].[UNM_Id] AS [UNM_Id1], 
                    [Extent2].[UNM_Descripcion] AS [UNM_Descripcion], 
                    [Extent3].[BSTIP_Id] AS [BSTIP_Id1], 
                    [Extent3].[BSTIP_Descripcion] AS [BSTIP_Descripcion]
                    FROM   [dbo].[Bien_servicio] AS [Extent1]
                    INNER JOIN [dbo].[Unidad_Medida] AS [Extent2] ON [Extent1].[UNM_Id] = [Extent2].[UNM_Id]
                    LEFT OUTER JOIN [dbo].[Bs_tipo] AS [Extent3] ON [Extent1].[BSTIP_Id] = [Extent3].[BSTIP_Id]
                    WHERE [Extent1].[BS_Descripcion] like '%'+ @campo + '%'
                    or [Extent2].[UNM_Descripcion] like '%'+ @campo + '%'
                    or [Extent1].[BS_CostoPromedio] like '%'+ @campo + '%'
                    or [Extent3].[BSTIP_Descripcion] like '%'+ @campo + '%'
                )  AS [Project1]
        )  AS [Project1]
        WHERE [Project1].[row_number] > (@numPags - 1)*@numRegs
        ORDER BY [Project1].[BS_Descripcion] ASC
END 
```

在此函数中导入：

```
public static List<Bien_servicio> ListarBien_servicio(int numPags, int numRegs, String campo = "")
{
    try
    {
        using (SampleDBEntities db = new SampleDBEntities())
        {
           return db.BuscarBien_servicio(campo, numPags, numRegs).ToList();
        }
    }
    catch (Exception)
    {
        throw;
    }
 } 
```

使用以下关系

bs_tipo --< Bien_servicio >--- Unidad_Medida

当我尝试获取相关实体 (Bien_Servicio.Bs_Tipo) 时，我收到错误消息：“ObjectContext 实例已被释放，不能再用于需要连接的操作”

在 db 层，相关实体被正确映射，但在 winform 代码中，我得到了这个异常，就像我失去了连接一样。

这发生在存储过程中（如果我使用 db.Bien_Servicio.Include("Bs_tipo").ToList(); 我没有问题）。即使我将结果转换为 .ToList()。我的错误是什么？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T13:39:34.783

这是一个延迟加载问题。您确实加载了`Bien_Servicio`列表，但没有加载相关参考。因此，当您的方法的使用者`ListarBien_servicio`尝试访问`Bien_Servicio.Bs_Tipo`上下文时，就会出现您提到的异常。

那么如何加载相关实体呢？您不能在对存储过程的调用中加载它们，因为存储过程不可组合（这意味着：无法将 a`join`转换为 sql）。所以没有办法`ObjectResult`支持`Include`，因为它涉及到加入，你也不能在 linq 中使用加入。

您必须[`Load`](http://msdn.microsoft.com/en-us/library/bb738874.aspx)在上下文范围内`Bs_Tipo`手动引用引用`using`。或者您应该只让您的存储过程返回`BS_Id`值，并将 Id 用于（使用）`Select`的完整记录。`db.Bien_Servicio``Include`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T01:02:12.217

我使用加载解决了这个问题：

```
var x = (from b in db.BuscarBien_servicio(campo, numPags, numRegs)
        select b).ToList();
foreach (Bien_servicio b in x)
{
     b.Unidad_MedidaReference.Load();
     b.Bs_tipoReference.Load();
}
return x; 
```

代替

```
return db.BuscarBien_servicio(campo, numPags, numRegs).ToList(); 
```

# sparql - 从 DBpedia 返回出生在巴黎的人的列表的查询

> ID：12239750
> 
> 赞同：0
> 
> 时间：2012-09-02T21:06:29.423
> 
> 标签：sparql, dbpedia

我不知道如何编写一个查询来获取所有在巴黎出生的人

我想要得到的结果是：

```
dbpedia:Sergi_Pàmies
dbpedia:Princess_Eugénie_of_Greece_and_Denmark
dbpedia:Laurent_Fabius
dbpedia:Auguste_Rodin
dbpedia:Manu_Chao
dbpedia:Louis_Antoine_de_Bougainville
dbpedia:Maria_Francisca_of_Savoy
dbpedia:Alexandre_Coste
dbpedia:Jean_le_Rond_d'Alembert
        etc...... 
```

资源页面为：[http ://dbpedia.org/page/Paris](http://dbpedia.org/page/Paris)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T17:11:49.870

我找到了我的问题的答案。下面的查询得到所有在巴黎出生的人。

```
PREFIX dbponto: <http://dbpedia.org/ontology/>
PREFIX dbpedia: <http://dbpedia.org/resource/>
SELECT ?person 
WHERE { ?person dbpedia-owl:birthPlace dbpedia:Paris } 
```

对不起，如果我上面的问题结构不合理，但我是编程初学者。

# excel - 根据其他单元格中的值显示一个单元格或多个单元格的值

> ID：12239753
> 
> 赞同：0
> 
> 时间：2012-09-02T21:06:40.097
> 
> 标签：excel

我有一个列出一堆名称的 Excel 电子表格，我们正在跟踪某个事件发生的次数。我需要做的是找到一种方法来计算哪个名称的出现值最高，然后在另一个单元格中显示该名称。我还想做的是，如果有平局，我想显示平局第一人的所有名字。任何帮助表示赞赏。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T08:29:22.253

您可以使用该`Advanced Filter`功能来执行此操作：

（Excel 2010 的屏幕截图）

![在此处输入图像描述](../Images/03925fbcb0a999e192d1b0a265cea220.png)

单元格中的公式`B2: =COUNTIFS(A:A,A2)`（根据需要复制为 raf）

单元格中的公式`D2: =MAX(B:B)`

单击确定，最高计数名称将列在列中（`F`在本例中）`t``y`

# cocoa - Cocoa：非基于文档的应用程序，数组控制器绑定？

> ID：12239755
> 
> 赞同：0
> 
> 时间：2012-09-02T21:06:50.557
> 
> 标签：cocoa, binding, nsarraycontroller

我环顾四周，并没有找到明确的答案。**我正在尝试在非基于文档的应用程序**中使用数组控制器，但我似乎无法使其工作。这是不可能的吗？

我不确定如何让内容数组绑定到控制器。即使是指向一些阅读材料的指针也会有所帮助。谢谢。:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T21:33:50.383

当然可以——在绑定检查器的 IB 中，在“内容数组”标题下，从下拉菜单中选择包含要绑定的数组的类，然后单击“绑定到”框。在“模型键路径”字段中，输入数组的属性名称。这里的所有都是它的。

# php - PHP，避免重写html

> ID：12239758
> 
> 赞同：1
> 
> 时间：2012-09-02T21:07:27.270
> 
> 标签：php, html, optimization

我有一些完全相同的 html 文件，除了一些文本的小区域。我在想是否有一种方法可以保存在 7 个文件中写入相同的文本。我想了一个可能的解决方案，但我发现它有点混乱：我将页面分成两部分，upper.php 和 lower.php：

上层.php

```
<html>
<head>
...
</head>
<body>
...
<div id=content> 
```

较低的.php

```
</div>
...
</body>
</html> 
```

然后我像这样写不同的页面：

主页.php

```
<? include "upper.php" ?>
Welcome to my webpage where I do random stuff.
<? include "lower.php" ?> 
```

联系人.php

```
<? include "upper.php" ?>
Contact me by sending an email to asdf@a.org
<? include "lower.php" ?> 
```

ETC..

我怀疑这是一种非常肮脏的方法，还有其他解决方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T21:17:08.990

这就是我做所有网站的方式。有时会在第一个之前进行设置`include`（例如确定用户是否必须登录），但大多数情况下我喜欢这样做。

唯一真正的问题是确保在不同文件夹中有文件时不会混淆。除此之外，你应该很好。

# java - 如何将文件添加到 Jar 文件中？

> ID：12239764
> 
> 赞同：24
> 
> 时间：2012-09-02T21:07:53.737
> 
> 标签：java, jar

我想将以前从其他文件中提取的一系列文件（已经完成）添加到 jar 中。这些文件将覆盖 JAR 中的文件。最有效的方法是什么？我需要它快。谢谢！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-09-02T21:09:07.950

```
jar -u file.jar file1 file2 file3 ... 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2017-06-23T16:08:35.030

```
jar -uf my.jar file1 file2...
jar -uf my.jar dir/ 
```

或混合

```
jar -uf my.jar file dir/ 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-09-02T21:10:46.870

JAR 文件是一个 ZIP 文件，请记住。

只需使用一些 ZIP 库。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2020-04-03T09:51:24.293

只是为了添加现有答案，至少有一种特殊情况：所谓的可执行 JAR 文件。如果你添加另一个 JAR 文件作为依赖项——无论你使用 jar 还是 zip——它都会抱怨嵌入的文件被压缩：

```
Caused by: java.lang.IllegalStateException: Unable to open nested entry 'BOOT-INF/lib/file.jar'. It has been compressed and nested jar files must be stored without compression. Please check the mechanism used to create your executable jar file 
```

解决方案是使用`0`jar 选项：

```
jar uvf0 myfile.jar BOOT-INF/lib/file.jar 
```

对于普通的类文件，您不需要它。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-04-12T21:42:02.730

```
 zip file.jar file1 file2 file3 
```

在 Mac Os 10.7.5 中为我工作

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-07-31T07:30:03.347

```
//Add a file in jar in a particular folder
jar uvf <jar file name> <file to be added> <folder name inside jar> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-12-16T06:56:45.887

如果有人需要以编程方式回答，就在这里。

```
private static void createJar(File source, JarOutputStream target) {
    createJar(source, source, target);
}

private static void createJar(File source, File baseDir, JarOutputStream target) {
    BufferedInputStream in = null;

    try {
        if (!source.exists()) {
            throw new IOException("Source directory is empty");
        }
        if (source.isDirectory()) {
            // For Jar entries, all path separates should be '/'(OS independent)
            String name = source.getPath().replace("\\", "/");
            if (!name.isEmpty()) {
                if (!name.endsWith("/")) {
                    name += "/";
                }
                JarEntry entry = new JarEntry(name);
                entry.setTime(source.lastModified());
                target.putNextEntry(entry);
                target.closeEntry();
            }
            for (File nestedFile: source.listFiles()) {
                createJar(nestedFile, baseDir, target);
            }
            return;
        }

        String entryName = baseDir.toPath().relativize(source.toPath()).toFile().getPath().replace("\\", "/");
        JarEntry entry = new JarEntry(entryName);
        entry.setTime(source.lastModified());
        target.putNextEntry(entry); in = new BufferedInputStream(new FileInputStream(source));

        byte[] buffer = new byte[1024];
        while (true) {
            int count = in .read(buffer);
            if (count == -1)
                break;
            target.write(buffer, 0, count);
        }
        target.closeEntry();
    } catch (Exception ignored) {

    } finally {
        if ( in != null) {
            try { in .close();
            } catch (Exception ignored) {
                throw new RuntimeException(ignored);
            }
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-10-22T14:55:59.657

扩展现有答案，我发现*jar*选项在添加位于它们自己的文件夹中的文件并且您将它们的路径展平时非常有用。**`-C`**

 *```
$ jar uf jar-file -C /path/to/my_jars/ this_useful.jar 
```

* * *

您最终将在 JAR 的根目录中拥有 this_useful.jar：

```
$ jar tf jar-file | grep this_useful.jar
this_useful.jar 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2019-07-31T06:16:26.443

```
String cmd = "jar uvf " + "jarName" + " " + "Filename";
System.out.println(cmd);
try {
Process p = Runtime.getRuntime().exec(cmd);
}
catch (Exception ex) {
} 
```*

# php - 代码需要一些解释

> ID：12239768
> 
> 赞同：-5
> 
> 时间：2012-09-02T21:08:33.277
> 
> 标签：php

我有这段代码，想知道它在做什么，或者是否有更好的方法。

```
if (eregi("1$|3$|5$|7$|9$", $o))
{
     $tablecolor='bgcolor="#cccccc"';
     $bgcolor='bgcolor="#bcbcbc"';
} 
else
{
     $tablecolor='bgcolor="#bcbcbc"';   
     $bgcolor='bgcolor="#cccccc"';
} 
```

我对`"1$|3$|5$|7$|9$", $o`部分有点困惑

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T21:12:28.307

首先`eregi()`已弃用，不应再使用。

`$o`如果它以`1`or`3`或`5`or `7`or结尾，则搜索`9`，假设 $o 是一个 ID，可以是整数或一些字符串，如`div1`or `div3`，如果它匹配它为您的 html 设置不同的颜色。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T21:13:36.297

这是一个正则表达式模式，以下是重要的部分：

1.  意思是“`|`或”，所以你可以把它分解成`1$`OR `3$`OR ...
2.  意思是“`$`如果行尾在这里”。所以这意味着“如果行尾是 1 或......”

这意味着表达式正在寻找任何以奇数结尾的行。

它本质上是一种将不同样式应用于奇数行和偶数行的算法。如果您可以自己编写 HTML（即奇数和偶数的 css 类），则有更简洁的方法可以做到这一点，但有时您必须使用所提供的内容 :-)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-02T21:13:42.047

[eregi](http://www.php.net/manual/en/function.eregi.php)是一个已弃用的 php 函数，它对字符串（在本例中为 $o）运行不区分大小写的正则表达式搜索。

美元符号检查字符串的结尾，因此您的函数所做的是检查字符串是否以 1、3、5、7 或 9 结尾并相应地设置表格颜色。

# html - Google+ 按钮间距不正确

> ID：12239771
> 
> 赞同：0
> 
> 时间：2012-09-02T21:09:22.997
> 
> 标签：html, css, button

我已经将我的社交媒体按钮全部设置在一条线上（Twitter、Facebook 和 Google+）。

问题在于 Google+ 按钮的间距不正确 - 它的间距比 Twitter 和 Facebook 按钮的间距大 3 倍。

我试过改变填充，但这没有帮助。我认为可能是 Google+ 按钮的宽度有问题，但我在代码中看不到任何更改宽度的内容。

HTML：

```
<div class="copy_right_social">
<div class="social">
<ul id="social">

<li><a href="https://twitter.com/share" class="twitter-share-button" data-url="https://www.whatever.com" data-via="jimsmith" data-lang="en" data-related="anywhereTheJavascriptAPI" data-count="vertical">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script></li>

<li><iframe src="//www.facebook.com/plugins/like.php?href=http%3A%2F%2Fwww.whatever.com&amp;send=false&amp;layout=box_count&amp;width=80&amp;show_faces=false&amp;action=like&amp;colorscheme=light&amp;font&amp;height=90" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:80px; height:90px;" allowTransparency="true"></iframe></li>

<!-- Place this tag where you want the +1 button to render. -->
<li><div class="g-plusone" data-size="tall"></div></li>

<!-- Place this tag after the last +1 button tag. -->
<script type="text/javascript">
  (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script>

</ul>
</div><!-- SOCIAL -->
</div><!-- COPY_RIGHT_SOCIAL --> 
```

CSS：

```
.copy_right_social {
float: left;
width: 410px;
height: 100px;
margin: 15px 0 0 0;
padding: 0;
border: none;
background-color: #FFF;
}

.social {
list-style-type: none;
list-style-position: inside;
padding: 0;
}

.social li {
display: inline;
text-decoration: none;
padding: 15px 0 0 20px;
float: left;
} 
```

[JsFiddle](http://jsfiddle.net/Abijah/8eqPY/)上的这个例子。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T21:47:17.407

三个按钮的宽度不相等。推特按钮是 60 像素宽，脸书是 44 像素，gplus 是 50 像素。

因此，您应该为每个类定义单独的类并设置宽度，ala：

```
.social li { float: left; }
.social li.twitter { width: 60px; }
.social li.facebook { width: 44px; }
.social li.gplus { width: 50px; } 
```

这是一个工作小提琴，它们之间没有间距（随意添加你喜欢的任何内容）：http: [//jsfiddle.net/7jC5f/](http://jsfiddle.net/7jC5f/)

# java - Java - 将字符转换为字节

> ID：12239774
> 
> 赞同：0
> 
> 时间：2012-09-02T21:09:56.663
> 
> 标签：java

我要做的就是从记事本中读取字符并将其转换为字节并将其保存为另一个文件。

“a.txt”在记事本中包含简单的文本“Hello World！”

但是，在“b.txt”中，我仍然看到人类可读的字符而不是字节值。我还注意到，当我执行 a 时`System.out.print(ba)`，它会打印字节。

谁能告诉我为什么 Java 不将字节值写入“b.txt”？

```
import java.io.*;

class a {
    static int f;
    static String s;

    public static void main(String args[]) 
    throws IOException {
        BufferedReader  br = new BufferedReader(new FileReader ("a.txt"));
        BufferedOutputStream w = new BufferedOutputStream(new FileOutputStream("b.txt"));

        byte ba[] = new byte[1024];

        while((s=br.readLine())!=null) {
            ba = s.getBytes();
            System.out.print(ba);
            w.write(ba);
        }
    w.flush();
    w.close();
    br.close();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T21:14:20.930

您正在将原始字节值写入文件。
记事本将它们读取为 ASCII 文本。

如果您在十六进制编辑器中打开任一文件，您将看到实际的字节值。

如果您想在记事本中查看字节值，您需要将每个字节作为字符串打印到文件中，通常用空格分隔，以便您可以看到每个字节。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T21:23:21.030

您正在将 a.txt 逐字节复制到 b.txt 中。当然它会显示为文本，为什么不呢？如果您真的想在使用它之后在文本编辑器中查看字节，则必须先将字节转换为表示它们的文本，然后将其写出来。将 ba 转换为整数并使用 Integer.toBinaryString 将字节更改为文本，然后将其写出。这样，您可以在文本编辑器中打开结果并将字节视为文本（0 和 1）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-02T21:24:20.047

返回一个字节数组，因此`getBytes()`您应该遍历此数组并将其写入文件

```
 while((s=br.readLine())!=null) {
        ba[]= s.getBytes();
        for (int i=0;i<ba.lenght;i++){
           w.writeInt(ba[i]);
        }            
    } 
```

代码未测试

# wordpress - 致命错误：在第 10 行......对非对象调用成员函数 escape()

> ID：12239775
> 
> 赞同：0
> 
> 时间：2012-09-02T21:10:08.337
> 
> 标签：wordpress

我正在为 wordpress 制作一个简单的 javascript 登录表单。我有表单提交到以下 php 位来处理登录：

```
<?php
get_header(); 
global $user_ID;

if (!$user_ID) {

    if($_POST){
        //We shall SQL escape all inputs
        $username = $wpdb->escape($_REQUEST['username']);
        $password = $wpdb->escape($_REQUEST['password']);
        $remember = $wpdb->escape($_REQUEST['rememberme']);

        if($remember) $remember = "true";
        else $remember = "false";
        $login_data = array();
        $login_data['user_login'] = $username;
        $login_data['user_password'] = $password;
        $login_data['remember'] = $remember;
        $user_verify = wp_signon( $login_data, false ); 
        //wp_signon is a wordpress function which authenticates a user. It accepts user info parameters as an array.

        if ( is_wp_error($user_verify) ) 
        {
           echo "<span class='error'>Invalid username or password. Please try again!</span>";
           exit();
         } else 
         {  
            echo "<script type='text/javascript'>window.location='". get_bloginfo('url') ."'</script>";
            exit();
          }
    } else { 

//get_header();

?> 
```

关于我为什么会收到错误的任何想法？干杯，丹

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T21:33:44.473

您正在使用`$wpdb`对象并调用脚本`ajax`可能在您的脚本中不可用（错误消息说），要`$wpdb`在您的脚本中使用首先使用以下行将您的脚本连接到 Wordpress

```
include "/path-to-wordpress/wp-blog-header.php"; 
```

为了`$wpdb`从函数内部访问，您必须在全局范围内定义它，如下所示

```
function my_function() {
    global $wpdb;
    $wpdb->query('...');
} 
```

此文件位于 WordPress 安装的根目录中。

# apache - Nginx 不会离开！如何删除它

> ID：12239778
> 
> 赞同：10
> 
> 时间：2012-09-02T21:10:50.033
> 
> 标签：apache, nginx, window, webserver

我已经运行过一次 nginx，现在我无法摆脱它。当我在我的服务器 localhost 上运行 apache 时，仍然指向欢迎使用 nginx，我不知道为什么。我在Windows 7上。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-09-02T21:58:01.830

**杀死 nginx 进程。**

如果你确定 nginx 确实在运行，你只需要杀死`nginx.exe`进程并重新运行`apache`。

打开`Run`（窗口键 + R）或`commend prompt`（cmd.exe）并粘贴到命令下方，

`taskkill /F /IM nginx.exe`

* * *

**找出哪个进程占用了 80 端口。**

这是`netstat`命令和输出以查找正在保留的进程`port 80`。

```
C:\> netstat -n -a -o | findstr "0.0.0.0:80"
  TCP    0.0.0.0:80             0.0.0.0:0              LISTENING       1588 
```

^ 这里，`1588`是`PID`进程保持`port 80`。

因此，下面是从`PID 1588`.

```
C:\> tasklist /svc /FI "PID eq 1588"

Image Name                     PID Services
========================= ======== ============================================
nginx.exe                     1588 N/A 
```

所以，它表明它`nginx.exe`正在持有`port 80`。

# javascript - 我的角度表单输入 [数字] 验证不起作用

> ID：12239780
> 
> 赞同：2
> 
> 时间：2012-09-02T21:11:23.563
> 
> 标签：javascript, angularjs

我的角度形式仅显示我在下面定义的文本。它没有在表单输入字段中显示红色来告诉用户有错误。请告诉我发生了什么事。

请帮忙。

谢谢！

我在页面中包含以下文件：

```
<script src="js/lib/angular/angular-1.0.1.js"></script>
<link rel="stylesheet" href="css/ui-lightness/jquery-ui-1.8.23.custom.css" />
<link rel="stylesheet" href="css/style.css" />
<script type="text/javascript" src="js/jquery-1.8.0.min.js"></script>
<script type="text/javascript" src="js/jquery-ui-1.8.23.custom.min.js"></script> 
```

我包含了一个名为 users.html 的模板，这个 users.html 进一步包含了以下名为 pagination.html 的模板：

```
<div style="padding-left: 252px;">
   <form name="pageForm" ng-submit="search()">
      Page: <input name="pageTxtField" ng-model="request.page" type="number" 
                required min="1" max="{{totalPages}}" style="width:30px;" ng-pattern="/[0-9]+/" /> of <span ng-bind="totalPages"></span>
   <span class="error" ng-show="pageForm.pageTxtField.$error.required">
        Please enter a number!</span>
   <span class="error" ng-show="pageForm.pageTxtField.$error.valid">
     Enter valid number!</span>
   </form>
</div> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T13:06:32.753

我解决了这个问题。我的样式表现在看起来像这样：

```
form span.error {
   color: red;
}

form.ng-invalid input.ng-invalid {
   border-color: red;
   outline-color: red;
} 
```

我发布这个答案是为了帮助有同样问题的人。

谢谢！

# c++ - 使用 CV_INTER_AREA 调整图像大小

> ID：12239781
> 
> 赞同：1
> 
> 时间：2012-09-02T21:11:40.747
> 
> 标签：c++, opencv

使用 CV_INTER_AREA 调整图像大小时，我有一些奇怪的行为。我确定我做错了什么，但我无法弄清楚。那么，有人可以告诉我以下代码有什么问题：

```
Mat src = imread( File_Name );
Mat dst;
Size s( src.size().width / 10, src.size().height / 10 );
resize( src, dst, s, 0, 0, CV_INTER_AREA ); 
```

保存 dst 时，它只会在 Windows 上产生灰色图像（未初始化的内存）。

这按预期工作：

```
Mat src = imread( File_Name );
Mat dst;
Size s( src.size().width / 10, src.size().height / 10 );
resize( src, dst, s ); 
```

因为我要减小尺寸，所以我喜欢使用 CV_INTER_AREA 并使用 dsize 参数定义目标图像尺寸的结果。

欢迎任何帮助。

谢谢，克里斯蒂安

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-14T20:20:03.637

实际上，您可以尝试 cv::INTER_AREA 而不是在 2.4.9 版本中使用 CV_INTER_AREA。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T22:05:55.007

事实证明，主干（ 2.4.9 ）不起作用。当我尝试 2.4 分支时，代码有效。

# c++ - 关于 static_cast 的问题

> ID：12239783
> 
> 赞同：4
> 
> 时间：2012-09-02T21:11:41.917
> 
> 标签：c++, static-cast

我写了一段代码，但我对它的输出感到困惑：

```
#include <iostream>

using namespace std;

class B{
public:
    virtual void foo() {cout << "B::foo" << endl;}
};

class D:public B{
public:
    virtual void foo() {cout << "D::foo" << endl;}
    void disp() {cout << "D::disp" << endl;}
};

void func(B *pb){
    D *pd1 = static_cast<D*>(pb);
    pd1->foo();
    pd1->disp();
}

int main(int argc, char *argv[])
{

    B* pb = new B();
    func(pb); 

    return 0;
} 
```

输出是：

```
B::foo
D::disp 
```

但据我所知，`pb`指向类型 B。并且其中没有命名函数`disp()`？那么，为什么它可以访问`disp()`D 类中的函数呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T21:16:29.133

由于`disp()`不访问类的任何成员，原则上与在全局命名空间中声明它而不是在类中声明相同，因此调用它没有负面影响，即使实例不是正确的班级。

你在做什么是将基类的指针向下转换为派生类的指针，即使它没有被初始化。如果`disp()`尝试访问 in`D`但不在 in 的类成员`B`，您可能会遇到段错误。

底线：`static_cast`除非您绝对确定指针实际上指向派生类的实例，否则不要用于向下转换。如果您不确定，您可以使用`dynamic_cast`which 在不匹配的情况下失败（但 RTTI 存在开销，因此请尽可能避免使用它）。

`dynamic_cast``nullptr`如果转换不正确，将返回，如果`std::bad_cast` 转换引用则抛出异常，因此您将确定它失败的原因，而不是可能的内存损坏错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T21:18:39.863

该行：

```
D *pd1 = static_cast<D*>(pb); 
```

无论源指针是`B*`or ，都会进行强制转换`D*`。在您的情况下，结果将是指向错误类型对象的指针。方法`disp`将起作用，因为它没有使用类的任何数据成员或虚函数`D`。在更复杂的情况下，这将导致不稳定的行为或崩溃。

您的对象是多态的。您应该`dynamic_cast`改用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-02T21:21:55.417

我认为，在这种情况下，重要的是成员函数`disp()`不会隐藏在所有 type 对象中`D`。它是一个存在于一个地方的单一功能。而任何对象是否会尝试调用 call`disp()`是由代码决定的。

**无论您传递什么指针，**您`static_cast`都将生成编译器认为指向的指针。一旦你有了一个指向 的指针，编译器就会让你尝试调用.`D` **`D``disp()`**

 ***换句话说，`static_cast`不会保护您免于错误地投射指针。*

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-02T21:29:45.957

`B`当您将指向分配为指向派生类的指针的对象的指针强制转换时，您做了一件非常糟糕的事情`D`。这是标准所说的，强调我的：

> 5.2.9 静态投射
> 
> 如果“指向 cv1 B 的指针”类型的右值指向实际上是 D 类型对象的子对象的 B，则生成的指针指向 D 类型的封闭对象。**否则，强制转换的结果是未定义的**.

你已经通过这样做调用了未定义的行为`static_cast`。当程序调用未定义的行为时，编译器和运行时可以做任何事情并且仍然是合规的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-02T21:33:34.693

您需要了解[各种 C++ 类型转换之间的区别](https://stackoverflow.com/questions/28002/regular-cast-vs-static-cast-vs-dynamic-cast)。

您在这里使用静态转换，这与说“我真的不在乎它是否真的属于那种类型 - 只是尽力而为”。

在这种情况下，您想知道您的指针是否实际上是您将其转换为的派生类型。您应该使用 dynamic_cast。仅当指针的类型正确时，此强制转换才会成功。这意味着，如果它失败，它将返回一个 NULL 指针。

您看到的行为是当您没有为工作使用正确的演员表时会发生什么，虽然您可以尝试解释它，但您确实应该避免这种情况，因为它属于未定义行为的领域。换句话说，您不能期望跨编译器甚至同一编译器的不同版本会产生相同的副作用。换句话说，避免它。**

# java - 如何从 Java 中的装饰器模式中删除装饰对象

> ID：12239784
> 
> 赞同：6
> 
> 时间：2012-09-02T21:11:49.140
> 
> 标签：java, design-patterns, decorator

我正在阅读“傻瓜设计模式”。我阅读并练习了装饰器模式。使用装饰器模式，我们可以用任何东西装饰一个对象。现在，我想在装饰之前删除装饰对象。我已经通过 ArrayList 解决了这个问题，但我仍然觉得它不好。你能告诉我如何去除装饰物吗？还有什么更好的方法？

这是我的方式：

**计算机.java**

```
public class Computer {

    public Computer() {
    }

    public String description() {
        return "computer";
    }

} 
```

**组件装饰器.java**

```
public abstract class ComponentDecorator extends Computer {
    @Override
    public abstract String description();
} 
```

**光盘.java**

```
public class CD extends ComponentDecorator {
    private Computer computer;

    public CD() {
    }

    public CD(Computer computer) {
        this.computer = computer;
    }

    @Override
    public String description() {
        return computer.description() + " and a CD";
    }

} 
```

**磁盘.java**

```
public class Disk extends ComponentDecorator {
    private Computer computer;

    public Disk() {
    }

    public Disk(Computer c) {
        computer = c;
    }

    @Override
    public String description() {
        return computer.description() + " and a disk";
    }

} 
```

**监视器.java**

```
public class Monitor extends ComponentDecorator {
    private Computer computer;

    public Monitor() {
    }

    public Monitor(Computer computer) {
        this.computer = computer;
    }

    @Override
    public String description() {
        return computer.description() + " and a monitor";
    }

} 
```

**主.java**

```
import java.util.ArrayList;
import java.util.Arrays;

public class Main {
    static ArrayList<ComponentDecorator> list = new ArrayList<>();

    public static void main(String[] args) {
        addComponent(new CD(), new Disk(), new Monitor());
        System.out.println(list.size());
        Computer penIII = getComputer();
        removeComponent(new Monitor());
        penIII = getComputer();
        System.out.println(penIII.description());
    }

    private static void addComponent(ComponentDecorator... comp) {
        list.addAll(Arrays.asList(comp));
    }

    private static void removeComponent(ComponentDecorator comp) {
        for(ComponentDecorator c : list) {
            if(c.getClass() == comp.getClass()) {
                list.remove(list.indexOf(c));
                break;
            }
        }
    }

    private static Computer getComputer() {
        Computer c = new Computer();
        Class e;
        for(ComponentDecorator d : list) {
            e = d.getClass();
            try {
                c = (Computer) e.getConstructor(new Class[]{Computer.class}).newInstance(c);
            } catch(Exception ex) {
                ex.printStackTrace();
            }
        }
        return c;
    }
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-02T23:28:28.220

更好的方法是将“removeDecorator”方法添加到您的 ComponentDecorator 类。

```
public abstract class ComponentDecorator {

private ComponentDecorator subject;

public ComponentDecorator(ComponentDecorator subject) {
  this.subject = subject;
}

@Override
public abstract String description();
}

public void removeDecorator(ComponentDecorator toRemove) {
  if (subject == null) {
    return;
  } else if (subject.equals(toRemove)) {
    subject = subject.getSubject();
  } else {
    subject.removeDecorator(toRemove);
  }
}

public ComponentDecorator getSubject() {
  return subject;
}

// Computer
public class Computer extends ComponentDecorator{

public Computer() {
  super(null);
}

public String description() {
  return "computer";
}

// CD
public class CD extends ComponentDecorator {

  public CD(ComponentDecorator computer) {
    super(computer);
  }

  @Override
  public String description() {
    return getSubject().description() + " and a CD";
  }
}

// main
public static void main(String[] args) {
    ComponentDecorator penIII = new Computer();
    penIII = new CD(penIII);
    penIII = new Monitor(penIII);
    System.out.println(penIII.description());
} 
```

}

如果您没有要删除的装饰器的引用，您可以创建另一个类的方法来代替。

但是，您需要将装饰对象作为“ComponentDecorator”而不是“Computer”。我建议让 Computer 类扩展 ComponentDecorator 而不是相反。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T21:50:08.230

我怀疑我误解了你的问题，但是要从装饰器中取出装饰的（内部）对象，你可以在装饰器中添加一个 get 方法。添加

`public abstract Computer getDecorated();`

到 ComponentDecorator 和

`public Computer getDecorated(){return computer;}`

到每个子类（CD，监视器，...）。那是你要找的吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-07-23T00:04:12.377

向接口添加两个方法， undecorate() 和 removeDecoration(String className)：

**事物接口.java**

```
public interface ThingInterface {
    public ThingInterface undecorate();
    public ThingInterface removeDecoration(String className);
    public String nonDecoratedString();
    public String decoratedString();
} 
```

您的基类将简单地为这些方法返回自身：

**BaseThing.java**

```
public class BaseThing implements ThingInterface {

    private String basicString;

    public BaseThing(String string) {
        basicString = string;
    }

    @Override
    public ThingInterface undecorate() {
        return this;
    }

    @Override
    public ThingInterface removeDecoration(String className) {
        return this;
    }

    @Override
    public String nonDecoratedString() {
        return basicString;
    }

    @Override
    public String decoratedString() {
        return basicString;
    }

} 
```

现在，您需要的真正内容在抽象类中：

**AbstractThingDecorator.java**

```
public abstract class AbstractThingDecorator implements ThingInterface {

    private ThingInterface thing;

    public AbstractThingDecorator(ThingInterface thing) {
        this.thing = thing;
    }

    @Override
    public ThingInterface removeDecoration(String className) {
        ThingInterface undecorate = this;
        if(this.getClass().getName() == className) {
            undecorate = this.undecorate();
        } 
        else {
            ArrayList<String> classStack = new ArrayList();
            while(undecorate != undecorate.undecorate()) {
                if(undecorate.getClass().getName() != className) {
                    classStack.add(undecorate.getClass().getName());
                }
                undecorate = undecorate.undecorate();
            }
            for(int i = classStack.size()-1;i == 0;i--) {
                try {
                    Class<?> clazz = Class.forName(classStack.get(i));
                    Constructor<?> ctor = clazz.getConstructor(ThingInterface.class);
                    Object object = ctor.newInstance(new Object[] { undecorate });      
                    undecorate = (ThingInterface) object;
                }
                catch(Exception e) {
                    System.out.println("Exception:" + e.getMessage());
                }
            }
        }
        return undecorate;
    }

    @Override
    public ThingInterface undecorate() {
        return this.thing;
    }

    @Override
    public String nonDecoratedString() {
        return thing.nonDecoratedString();
    }

    @Override
    public String decoratedString() {
        return thing.decoratedString();
    }

} 
```

我添加了两个简单的装饰器，ThingDecorator 和 FancyThingDecorator：

**ThingDecorator.java**

```
public class ThingDecorator extends AbstractThingDecorator {
    public ThingDecorator(ThingInterface thing) {
        super(thing);
    }

    @Override
    public ThingInterface undecorate() {
        return super.undecorate();
    }

    @Override
    public String decoratedString() {
        return super.decoratedString() + ", decorated";
    }
} 
```

**FancyThingDecorator.java**

```
public class FancyThingDecorator extends AbstractThingDecorator {
    public FancyThingDecorator(ThingInterface thing) {
        super(thing);
    }

    @Override
    public ThingInterface undecorate() {
        return super.undecorate();
    }

    @Override
    public String decoratedString() {
        return super.decoratedString() + ", fancy";
    }
} 
```

最后，我的java main：

**装饰器.java**

```
public class Decorator {

    /**
     * @param args
     */
    public static void main(String[] args) {
        ThingInterface thing = new BaseThing("Basic string");
        ThingInterface decorator = new ThingDecorator(thing);
        ThingInterface fancyDecorator = new FancyThingDecorator(thing);
        ThingInterface extraFancy = new FancyThingDecorator(new ThingDecorator(thing));
        ThingInterface undecorate = new FancyThingDecorator(new ThingDecorator(thing));

        System.out.println("Basic thing is: " + thing.decoratedString()+".");
        System.out.println("Decorated thing is: " + decorator.decoratedString()+".");
        System.out.println("Fancy thing is: " + fancyDecorator.decoratedString()+".");
        System.out.println("Decorated fancy thing is: " + extraFancy.decoratedString()+".");

        while(extraFancy.undecorate() != extraFancy) {
            extraFancy = extraFancy.undecorate();
            System.out.println("Rolling back decorations: " + extraFancy.decoratedString()+".");
        }

        System.out.println("Decoration chain before removal is: " + undecorate.decoratedString());
        System.out.println("Removing decoration for " + ThingDecorator.class.getName());
        undecorate = undecorate.removeDecoration(ThingDecorator.class.getName());
        System.out.println("Decoration chain after removal is: " + undecorate.decoratedString()+".");

    }

} 
```

输出是：

基本的东西是：基本字符串。

装饰的东西是：基本字符串，装饰。

花哨的是：基本字符串，花哨。

装饰花哨的东西是：基本字符串，装饰，花哨。

回滚装饰：基本弦，装饰。

回滚装饰：基本字符串。

移除前的装饰链为：基本字符串、装饰、花式

移除 ThingDecorator 的装饰

去掉后的装饰链是：基本串，花式。

# c# - 反序列化中间 XML 时出错。找不到类型

> ID：12239785
> 
> 赞同：0
> 
> 时间：2012-09-02T21:12:20.223
> 
> 标签：c#, xml, xna

整个错误信息在这里：

```
There was an error while deserializing intermediate XML. Cannot find type
"WindowsGame1.Tile". 
```

我正在制作 XNA 游戏，现在我正在尝试从 xml 文件加载基于图块的关卡。现在，我的 xml 文件如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<XnaContent>
  <Asset Type="WindowsGame1.Tile">
    <Tile>
      <X>0</X>
      <Y>0</Y>
      <ImageName>grass-tile</ImageName>
    </Tile>
  </Asset>
</XnaContent> 
```

我的 C# 文件如下所示：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Microsoft.Xna.Framework;
using Microsoft.Xna.Framework.Graphics;

namespace WindowsGame1
{
    public class Tile
    {
        public int x;
        public int y;
        public string imageName;

        public int X
        {
            get { return x; }
            set { x = value; }
        }

        public int Y
        {
            get { return y; }
            set { y = value; }
        }
        public string ImageName
        {
            get { return imageName; }
            set { imageName = value; }
        }
    }
} 
```

我有一个类，它使用 XPath 库来解析 xml 文件并将 Tile 排除在外，但现在它都被注释掉了，因为 xml 的东西无论如何都不起作用。在我的 Game1 课程中，我尝试导入：

```
using WindowsGame1.Tile; 
```

并参考：

```
Tile tile; 
```

这个瓷砖类，根据我在尝试找到解决方案时发现的建议，但我仍然遇到同样的错误，我的游戏无法构建。任何人都知道我需要改变什么才能让这些 XML 东西正常工作吗？

下面是解析 XML 的代码应该是什么样子的，尽管目前，在我可以编译之前，它都被注释掉了。

```
namespace WindowsGame1
{
    class ActionScreen : GameScreen
    {
        public ActionScreen(Game game, SpriteBatch spriteBatch, String file,  AnimatedSprite sprite)
            : base(game, spriteBatch)
        {
            this.file = file;
            this.sprite = sprite;
            initializeTiles();
        }

        private void initializeTiles()
        {
            XPathDocument doc = new XPathDocument(file);
            XPathNavigator nav = doc.CreateNavigator();
            XPathNodeIterator iter = nav.Select("tile");

            while (iter.MoveNext())
            {
                int x, y;
                string fileName;

                x = int.Parse(iter.Current.GetAttribute("X", ""));
                y = int.Parse(iter.Current.GetAttribute("Y", ""));
                fileName = iter.Current.GetAttribute("ImageName", "");

                Console.WriteLine(x + " " + y + " " + fileName);
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T05:55:49.080

看起来您正在尝试使用 XNA 内容管道将 XML 文件构建为内容 - 所以我的回答将跳过您提到的所有 XPath 内容 - 您不需要它。

错误所指的“反序列化”是当内容管道试图将您的 XML 转换**为对象实例**时。然后它获取该对象并将其写入 XNB 文件。稍后，当您的游戏运行时，它将将该 XNB 文件加载回**对象实例**中。

哪个对象的实例？好吧，在你的情况下，一个`WindowsGame1.Tile`对象。内容管道如何*知道*`WindowsGame1.Tile`对象是什么？**它不会**-*除非你告诉它*- 因此会出现错误消息。

* * *

**你如何解决这个问题？**

`WindowsGame1.Tile`您需要从内容管道项目中引用包含该类型的程序集。

您不能直接引用您的游戏项目 - 因为这会创建循环依赖项（您的游戏项目已经依赖于内容项目）。

因此，您必须将类型`WindowsGame1.Tile`放入您从游戏项目和内容项目（右键单击内容项目，添加引用，添加项目引用）中引用的单独程序集中（创建一个新的“游戏库项目”）。

然后您可以通过内容管理器在游戏中加载您的图块：

```
Tile myTile = Content.Load<Tile>("assetName"); 
```

* * *

如果您收到有关XML*格式*的另一个错误（我想我发现了一个错误，但我没有检查过），您可以通过创建您的类型的虚拟实例来弄清楚它应该是什么`Tile`，然后使用`IntermediateSerializer.Serialize`生成适当的 XML。[这是一个如何执行此操作的示例](https://gamedev.stackexchange.com/a/11241/288)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T02:10:01.097

问题是您使用的是`GetAttribute()`方法而不是执行`Select("X").Value`. 例如，而不是

```
x = int.Parse(iter.Current.GetAttribute("X", "")); 
```

尝试

```
x = int.Parse(iter.Current.Select("X").Value, string.Empty)); 
```

您可能还需要考虑 System.Xml.Serlization.XmlSerializer 类，因为它更易于使用，但我不知道它是否包含在您正在使用的 XNA 框架版本中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T21:26:10.710

要使其正确反序列化，您必须使 XML 和实际类中的属性名称相同。尝试在 Tile 类中将属性“imageName”重命名为“image”。

# java - Java 在它的 run() 中调用线程

> ID：12239787
> 
> 赞同：3
> 
> 时间：2012-09-02T21:12:59.533
> 
> 标签：java, thread-safety

我编写了一个线程类，它通过每秒发送一个小字符串来检查与服务器的套接字连接。

`begin()`方法执行线程。

连接丢失后，线程尝试再次连接。

我的问题是是否可以像我一样通过方法`begin()`内的线程重新运行（见下文）。`run()`

```
public void begin() {  
   Check = new Thread(this);
   Check.start();
}

@Override
public void run() {
   Thread thisThread = Thread.currentThread();
   while (Check==thisThread) {
      try {
         oos.writeObject("a");
         // oos.flush();

         synchronized (this) {
            while (pleaseWait) {
               try {
                  System.out.println("waiting");    
                  wait();
                  System.out.println("not waiting");      
               } 
               catch (Exception e) {
                  System.err.println("Thread is interrupted: "+e.getMessage());
               }
            }
         }
         sleep(1000);
         } catch (Exception ex) {
              v = new Visual("The connection is lost. The system will try to reconnect now.");
              this.end();
              try {
                 Server=ClientLogin.checkingServers(); //returns the reachable server string address
                 socket = new Socket(Server, ServerPort);
                 System.out.println("Connected: " + socket);
                 oos = new ObjectOutputStream(socket.getOutputStream());
                 begin();
                 v = new Visual("The system is reconnected.");
              }
              catch(UnknownHostException uhe){  
                 System.out.println("Host unknown: " + uhe.getMessage());
                 v = new Visual("The system has failed to reconnected.");
              }
              catch (IOException ioe) {
                 System.out.println("The system cannot connect to servers: " + ioe.getMessage());
                 v = new Visual("The system has failed to reconnected.");
              }
              catch (Exception e) {
                 System.out.println("The system has failed to reconnect: " + e.getMessage());
                 v = new Visual("The system has failed to reconnected.");
              }
          }
   }
}

public void end() {
   Check = null;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T21:21:03.593

我不知道为什么这不起作用，但它看起来有点乱。您可能必须声明`Check`为`volatile`以确保循环始终读取当前值，因为新线程会覆盖它。

恕我直言，更好的方法是一个单独的“主管”线程，负责启动其中一个线程，然后用于`Thread.join()`等待它死亡，此时它可以再次启动它。

通过这种方式，您的主线程的逻辑可以专注于它*应该*做的事情，而无需任何“自我意识”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T23:14:48.013

首先，代码不是线程安全的。“检查”字段由一个线程写入，但由另一个线程读取，但不同步。不能保证新启动的线程会看到“Check”的更新值，即新线程在检查“Check==thisThread”时会获取旧线程的引用并做错事，

这个特殊问题可以通过使“检查”字段易失来解决。它确保在更新时，每个线程都会看到新值。

在 run() 方法中调用“begin()”并不是“错误的”。但是我不推荐它，因为您在这里有效地创建了递归调用。你很有可能会弄错并陷入无限循环。试试下面的简单设计。它使用while循环而不是递归。

```
package com.thinkinginobjects;

public class HeathChecker {

public void run() {
    while (true) {
        boolean success = checkHeath();
        if (!success) {
            //log and re-establish connection
        } else {
            Thread.sleep(1000);
        }
    }
}

private boolean checkHeath() {
    try {
        oos.writeObject("a");
        return true;
    } catch (Exception ex) {
        return false;
    }
} 
```

}

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T21:16:57.743

没关系，但是为什么每次都需要启动一个线程？使用 Timer 和 TimerTask 不是更好吗？

[http://docs.oracle.com/javase/6/docs/api/java/util/TimerTask.html](http://docs.oracle.com/javase/6/docs/api/java/util/TimerTask.html)

[http://docs.oracle.com/javase/6/docs/api/java/util/Timer.html](http://docs.oracle.com/javase/6/docs/api/java/util/Timer.html)

# javascript - swfobject.embedSWF: 'onYouTubePlayerReady' 和 'callbackFn' - 有什么区别？

> ID：12239788
> 
> 赞同：0
> 
> 时间：2012-09-02T21:12:59.923
> 
> 标签：javascript, swfobject

我正在使用 swfobject.js 2.2 版。

我正在调用 swfobject.embedSWF，并将最后一个参数 (callbackFn) 设置为我的 Javascript 代码中的本地函数。

之后，会调用两个不同的例程： 1\. 我的回调函数 2\. 'onYouTubePlayerReady'，这是一个由 swfobject API 定义的回调函数。

这两者有什么区别，我应该依靠哪一个来确保视频已上传并可以播放？

我问这个，因为在 Safari 上，只有我的回调函数被调用，所以我需要知道依赖它是否安全。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T05:42:51.037

`onYouTubePlayerReady` is not a SWFObject method, it is an independent method supplied by YouTube's player API.

Your issue probably comes down to timing -- since `onYouTubePlayerReady` is part of the YouTube player API, it will not be available until the SWF has finished loading and ExternalInterface has been initialized by Flash Player.

SWFObject's `callbackFn` simply executes when the `<object>` has been successfully added to the page's markup, and does *not* indicate the SWF has loaded. In fact, SWFObject does not pay attention to whether the SWF loads at all.

However with a little bit of extra JavaScript you can poll the SWF to detect whether it has finished loading, then execute your custom script (in this case `onYouTubePlayerReady`).

This [Stack Overflow thread](https://stackoverflow.com/questions/7710799/load-timer-on-swfobject-for-swf-load-time) discusses the polling, and here's [a short tutorial explaining how to poll after embedding a SWF via SWFObject](http://learnswfobject.com/advanced-topics/executing-javascript-when-the-swf-has-finished-loading/).

# facebook - Facebook评论框并不总是加载

> ID：12239789
> 
> 赞同：0
> 
> 时间：2012-09-02T21:13:06.713
> 
> 标签：facebook, comments, loading

我在我的网站上添加了一个 facebook 评论框，但它只有大约 40% 的时间加载。其他 60% 没有任何反应。我尝试进行一些故障排除并提出了这个问题，它不加载框的高度的时间设置为 0px，但是当它加载时它说 160px，正如它应该的那样。这是与评论框相关的所有代码。

```
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="http://www.facebook.com/2008/fbml"> 
```

以下是body标签之后的内容。

```
<div id="fb-root"></div>
<script>
window.fbAsyncInit = function() {
FB.init({
  appId      : '389788207743820', // App ID
  channelUrl : 'file:///C:\Users\ts10027\Documents\Mina webbplatser\recensionsida\channel.html', // Channel File
  status     : true, // check login status
  cookie     : true, // enable cookies to allow the server to access the session
  xfbml      : true  // parse XFBML
});
};
(function(d){
 var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 if (d.getElementById(id)) {return;}
 js = d.createElement('script'); js.id = id; js.async = true;
 js.src = "http://connect.facebook.net/en_US/all.js";
 ref.parentNode.insertBefore(js, ref);
}(document));
</script>
<div id="fb-root"></div>
<script>(function(d, s, id) {
var js, fjs = d.getElementsByTagName(s)[0];
if (d.getElementById(id)) return;
js = d.createElement(s); js.id = id;
js.src = "//connect.facebook.net/sv_SE/all.js#xfbml=1&appId=389788207743820";
fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script> 
```

这个放在我想要我的盒子的地方

```
<div class="fb-comments" data-href="http://www.stadskoll.nu/restaurang/harrys.php" data-num-posts="2" data-width="565px" data-height="160"></div> 
```

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T11:11:18.803

如果这是您实际使用的代码，则需要更改一些内容：

`channelUrl : 'file:///C:\Users\ts10027\Documents\Mina webbplatser\recensionsida\channel.html', // Channel File`

这必须在公共 URL 上，只需将文件移动到服务器上任何人都可以访问的位置。

接下来，您必须两次包含 JS SDK？您可能需要仔细检查：[https ://developers.facebook.com/docs/reference/javascript/](https://developers.facebook.com/docs/reference/javascript/)

# android - Android listView 作为 iPhone 的 listView

> ID：12239790
> 
> 赞同：3
> 
> 时间：2012-09-02T21:13:26.343
> 
> 标签：android, iphone, android-listview

我想实现一个类似于 iPhone 的 ListView。 ![这是图像](../Images/c97159636a0839632c628e6669e65038.png)

表格的第一个元素是图像，其他元素是文本加箭头。

我知道如何使用自定义图像适配器，但仅用于独特的自定义，而不是自定义每一行。

该信息是静态的，我应该只能单击所需的元素。

非常感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T22:11:44.057

我找到了解决方案，

我可以使用列表视图的标题和自定义边框。这是一个例子：

可绘制文件夹中的 listview_border.xml：

```
<?xml version="1.0" encoding="UTF-8"?> 
<shape xmlns:android="http://schemas.android.com/apk/res/android">
<stroke android:width="4dp" android:color="#FFFFFFFF" />
<padding android:left="7dp" android:top="7dp"
        android:right="7dp" android:bottom="7dp" />
<corners android:radius="15dp" />
<solid android:color="#FFFFFFFF"/>
</shape> 
```

对于列表视图，设置：

```
 android:background="@drawable/listview_border" 
```

然后对于 hedser，在布局中创建一个 listviaw_header.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

   <ImageView
       android:id="@+id/imageView1"
       android:layout_width="128dp"
       android:layout_height="wrap_content"
       android:src="@drawable/contact_image_fr"
       android:layout_marginLeft="10dp" />

</LinearLayout> 
```

然后设置标题：

```
ListView contact = (ListView) findViewById(R.id.contactListView);

    View header = getLayoutInflater().inflate(R.layout.contact_listview_header, null);

    contact.addHeaderView(header); 
```

就这样。享受...

# c# - 为什么 EF5 会在 SaveChanges() 时间产生这些尖峰？

> ID：12239794
> 
> 赞同：7
> 
> 时间：2012-09-02T21:13:44.113
> 
> 标签：c#, performance, sql-server-2008-r2, entity-framework-5

我一直得到下图中显示的结果。我想知道我是否可以做些什么来提高可预测性。我没有使用[SqlBulkCopy](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlbulkcopy.aspx)，因为我需要利用 EFv5 的验证功能。

如果有人可以验证/反驳我的发现，那就太好了。我的目标是摆脱这两种尖峰。我在下面提供源代码，以便您快速完成。您所需要的只是 VS 中的一个类库项目，其中包含对 EFv5 和 NUnit 的引用，两者都可以通过 NuGet 获得。只需将此代码粘贴到 Class1 中，修改连接字符串，然后运行它。您可以使用下面的 sql 脚本重新创建表。

我正在使用 .Net 4.5、EF 5、NUnit 2.6.1，在发布模式下运行代码，没有附加调试器。数据库是 SqlServer 2008 R2。我在 64 位模式下使用 NUnit.exe 运行测试，其中显示“Net 4.0”作为框架版本。

![EFv5 简单实体插入。 1000批100个实体](../Images/b2635e3e3f01bc443bd38dbcd463ab15.png)

X 轴是批号（总共 1000 个批次），Y 轴是毫秒。您可以看到第一批大约需要 30 秒，这是预期的，因为 dbContext 是“冷”的。每批保存 100 个实体。

请注意，这个问题正在寻找[这个答案](https://stackoverflow.com/questions/5940225/fastest-way-of-inserting-in-entity-framework/5942176#5942176)中缺少的一些信息，它是 EF 保存中的**抖动**。

这是我正在使用的代码：

桌子：

```
CREATE TABLE [dbo].[Entity1](
    [Id] [int] IDENTITY(1,1) NOT NULL,
    [IntField] [int] NOT NULL,
    [StrField] [nvarchar](50) NOT NULL,
    [DateField] [datetimeoffset](7) NOT NULL,
CONSTRAINT [PK_Entity1] PRIMARY KEY CLUSTERED 
(
    [Id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF,
    ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY] 
```

课程：

```
using System;
using System.Collections.Generic;
using System.Data.Entity;
using System.Diagnostics;
using NUnit.Framework;

namespace ClassLibrary1
{
    public class Entity1
    {
        public int Id { get; protected set; }
        public int IntField { get; set; }
        public string StrField { get; set; }
        public DateTimeOffset DateField { get; set; }
    }

    public class MyContext : DbContext
    {
        public MyContext(string connStr) : base(connStr) { }
        public virtual DbSet<Entity1> Entities { get { return base.Set<Entity1>(); } }
    }

    [TestFixture]
    public class Class1
    {
        [Test]
        public void EfPerf()
        {
            var entities = buildEntities(100000);
            int batchSize = 100;
            var batchTimes = new List<Stopwatch>();

            for (int i = 0; i < entities.Length; i += batchSize)
            {
                var sw = Stopwatch.StartNew();
                using (var ctx = buildCtx())
                {
                    for (int j = i; j < i + batchSize; j++)
                        ctx.Entities.Add(entities[j]);
                    ctx.SaveChanges();
                }
                sw.Stop();
                batchTimes.Add(sw);
            }

            batchTimes.ForEach(sw => Console.Out.WriteLine("Elapsed ms: " + 
                sw.ElapsedMilliseconds));
        }

        private MyContext buildCtx()
        {
            var cs = "Data Source=your db server;" +
                    "Initial Catalog=your db;" +
                    "Persist Security Info=True;" +
                    "User ID=your user;" + 
                    "Password=your pwd";
            var ctx = new MyContext(cs);
            //ctx.Configuration.ProxyCreationEnabled = false;
            return ctx;
        }

        private Entity1[] buildEntities(int count)
        {
            var entities = new Entity1[count];
            for (int i = 0; i < count; i++)
                entities[i] = new Entity1 { IntField = i, StrField = "str" + i, 
                    DateField = DateTimeOffset.UtcNow };
            return entities;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T17:33:58.707

我有一种感觉，您在数据库中遇到了死锁问题。EF 将所有 saveChanges() 调用放在一个事务中。默认情况下，SQL Server 中的事务以 Read Committed 的方式运行，这是非常严格的。也许您可以尝试更改隔离级别：

```
 using (var scope = new TransactionScope(TransactionScopeOption.Required, new 
 2: TransactionOptions { IsolationLevel= IsolationLevel.Snapshot }))
 3: {
 4: // do something with EF here
 5: scope.Complete();
 6: } 
```

# optimization - 使用 CUDA 进行令人尴尬的可并行计算，如何开始？

> ID：12239795
> 
> 赞同：0
> 
> 时间：2012-09-02T21:14:06.617
> 
> 标签：optimization, parallel-processing, cuda

我需要加速我现在使用 PyLab 进行的许多计算。我想到了使用 CUDA。整个计算单元 (A) 包括执行几个（数千个）完全独立的较小计算 (B)。它们中的每一个在初始阶段都涉及进行 40-41 次独立的、甚至更小的计算 (C)。所以并行编程应该真的有帮助。使用 PyLab，总体 (A) 需要 20 分钟，(B) 需要十分之一秒。

作为这个领域的初学者，我的问题是我应该在哪个级别并行计算，无论是在 (C) 还是在 (B)。

我应该澄清一下，（C）阶段包括获取在所有（C）进程之间共享的一堆数据（数千个浮点数），并执行各种任务，其中最耗时的一个是线性回归，其中也是可并行的！每个过程 (C) 的输出是一个浮点数。每个计算 (B) 基本上包括执行多次程序 (C) 并对输出的数据进行线性回归。同样，它的输出是一个浮点数。

我不熟悉 CUDA 编程，所以我基本上是在问最明智的策略是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T05:17:43.150

在决定如何（以及是否）将项目转换为 CUDA 时，一个重要的考虑因素是您的代码需要哪种类型的内存访问模式。GPU 以 32 个一组的线程运行，称为 warp，为了获得最佳性能，warp 中的线程应该以一些基本模式访问内存，这些模式在 CUDA 编程指南（包含在 CUDA 中）中进行了描述。一般来说，访问模式越随机，内核就越有可能成为内存绑定。在这种情况下，GPU 中的计算能力无法得到充分利用。

无法充分利用 GPU 中的计算能力的另一个主要情况是，是否存在条件逻辑和循环导致 warp 中的线程运行通过不同的代码路径，因为 GPU 必须运行 warp 中的所有线程通过每个代码路径。

如果您发现这些点可能会导致您的代码出现问题，您还应该进行一些研究，看看是否有已知的替代方法可以实现您的代码以在 GPU 上更好地运行（通常是这种情况）。

如果您根据上述考虑看到关于在哪个级别并行化计算的问题，则可能会清楚做出哪个选择。

# php - 内连接 3 个查询

> ID：12239797
> 
> 赞同：0
> 
> 时间：2012-09-02T21:14:19.803
> 
> 标签：php, sql

我想知道如何将这 3 个查询连接在一起，因为我只想要一个 JSON 输出，我认为 INNER JOIN 会这样做。但是不知道这个怎么用。有人可以引导我走上正确的道路吗？

```
 $json = array();
$following_string = mysqli_real_escape_string($mysqli,$_SESSION['id']);
$call="SELECT * FROM streamdata WHERE streamitem_id < '$lastID' AND streamitem_target=".$following_string." OR streamitem_creator=".$following_string." ORDER BY streamitem_id DESC LIMIT 10";
$chant = mysqli_query($mysqli, $call) or die(mysqli_error($mysqli));

$json['streamdata'] = array();

while ($resultArr = mysqli_fetch_assoc($chant)) {

    $json['streamitem_id'] = $resultArr['streamitem_id'];
    $json['streamitem_content'] = $resultArr['streamitem_content'];
    $json['streamitem_timestamp'] = Agotime($resultArr['streamitem_timestamp']);

 $json['streamdata'] = $json;
}

/***** COMMENTS *****/
$check = "SELECT comment_id, comment_datetime, comment_streamitem, comment_poster, comment_content FROM streamdata_comments WHERE comment_poster=".$following_string." ";
$check1 = mysqli_query($mysqli,$check);
$json['streamdata_comments'] = array();

while ($resultArr = mysqli_fetch_assoc($check1)) {

    $json['comment_id'] = $resultArr['comment_id'];
    $json['comment_content'] = $resultArr['comment_content'];
    $json['comment_poster'] = $resultArr['comment_poster'];
    $json['comment_datetime'] = Agotime($resultArr['comment_datetime']);
    $json['comment_streamitem'] = $resultArr['comment_streamitem'];

$json['streamdata_comments'] = $json;
}

/***** USERS *****/

$check = "SELECT * FROM users WHERE id=".$following_string."";
$check1 = mysqli_query($mysqli,$check);
$json['users'] = array();

while ($resultArr = mysqli_fetch_assoc($check1)) {

    $json['username'] = $resultArr['username'];
    $json['id'] = $resultArr['id'];
    $json['first'] = $resultArr['first'];
    $json['middle'] = $resultArr['middle'];
    $json['last'] = $resultArr['last'];

$json['users'] = $json;
}

echo json_encode($json);
}
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T21:48:17.833

您正在获取不相关的数据，因此您不能在 SQL 级别使用连接。

但是 JSON 不在乎你喂它什么，或者如何喂它。只需构建适当的 PHP 级数据结构，例如

```
$data = array();
$data['streamdata'] = array();
... insert data from 'streamdata' query...
$data['streamdata_comments'] = array();
... insert comment data ...
$data['users'] = array();
... insert user data ... 
```

这将为您提供一个包含每个查询数据的 3 路数组。然后，您将整个`$data`结构传递给 json_encode，然后繁荣 - 您在单个数据结构中获得了 3 个未评级的查询，而无需每次都触及 SQL 连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T22:28:56.220

Some previous answers have suggested that you can't join unrelated tables, but these are clearly not unrelated tables. The `streamdata` and `streamdata_comments` tables are quite closely related, and the `users` table maps user ID values in the other tables to names.

At the SQL level, these can be combined easily:

```
SELECT d.*, c.*, u.*
  FROM streamdata          AS d
  JOIN streamdata_comments AS c ON d.streamitem_ID = c.comment_streamitem
  JOIN users               AS u ON u.user_id = c.comment_poster
 WHERE c.comment_poster = '$following_string'
   AND d.streamitem_id < '$lastID'
   AND (d.streamitem_target  = '$following_string' OR
        d.streamitem_creator = '$following_string'); 
```

Whether the result makes sense for wrapping into a JSON string is a different matter, on which I can't pontificate. This would give you one record from the comments information for each comment associated with each stream item.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T21:43:27.290

您正在获取不相关的数据。仅当要连接的数据具有关系时，连接数据才有用。

你不能加入苹果、牛和猴子。

# javascript - CreateJS：无法让补间工作

> ID：12239805
> 
> 赞同：2
> 
> 时间：2012-09-02T21:15:58.443
> 
> 标签：javascript, canvas, tween, createjs

所以，

我刚刚开始学习 CreateJS，我遇到了第一个问题：我无法让补间工作（正如我所期望的那样）。

这是示例：[http ://www.hakoniemi.net/labs/createjs-test/](http://www.hakoniemi.net/labs/createjs-test/)

我想让那朵云从右向左移动——目前它只跳到目标。

代码看起来：

```
 createjs.Tween.get(stack["cloud"]).to({"x":25}, 1000).call(test); 
```

where`createjs.Tween.get(stack["cloud"])`是有效的并且函数`test`被执行。但是，根本没有发生 1000 毫秒的视觉效果。

我已经浏览了教程，这就是事情应该如何工作的方式，但事实并非如此。我究竟做错了什么？

**编辑：**如果我在控制台中重新执行具有不同值的代码，则补间和视觉效果会正常发生（这是使用 setTimeout 的版本：[http](http://www.hakoniemi.net/labs/createjs-test/index2.html) ://www.hakoniemi.net/labs/createjs-test/index2.html ）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T00:20:36.727

`x`设置初始值时遇到类型问题

> ```
> if (this.getAttribute("x")) {
>   ref.x = this.getAttribute("x");
> } 
> ```

问题是`getAttribute()`返回一个字符串，您可以验证输出`Object.prototype.toString.call(ref.x)`. 这样，似乎补间第一次尝试运行它无法进行正确的数学运算。最后，它正确地将值更新为最终值作为一个数字，这就是为什么下一次调用相同的方法可以正常工作的原因。

您可以通过确保 ref.x 是一个数字来解决此问题。例如：

> ```
> if (this.getAttribute("x")) {
>   ref.x = parseInt(this.getAttribute("x"));
> } 
> ```

你可以看到它在这个[fiddle](http://jsfiddle.net/jbalsas/ZB9Xv/)中工作。

最后一件事，BitmapImageLoaded 是在加载资产后立即将资产添加到舞台。如果您的云图像在背景之前加载，它将被放置在其下方，您将无法看到它们。（以防万一 ：））

# java - Java变量声明效率

> ID：12239806
> 
> 赞同：3
> 
> 时间：2012-09-02T21:16:00.180
> 
> 标签：java, performance

据我了解，如果是数组，JAVA 会根据数组的大小检查索引。因此`array[i]`，与其在循环中多次使用，不如声明一个存储 的值的变量`array[i]`，并多次使用该变量。

我的问题是，如果我有这样的课程：

```
public class MyClass(){

    public MyClass(int value){
      this.value = value;
    }

    int value;
} 
```

如果我在其他地方创建这个类的一个实例：（`MyClass myobject = new MyClass(7)`），并且我必须多次使用对象值，是否可以`myobject.value`经常使用或者声明一个存储该值并多次使用的变量会更好，还是会一样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T21:19:37.973

在您的情况下，它不会有任何区别，因为引用与引用新变量 `myobject.value`一样快速有效。`int`

此外，JVM 通常能够优化这些事情，除非你有高性能的关键代码，否则你不应该花时间担心它。只需专注于编写清晰易读的代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T21:21:11.700

简短的回答是肯定的（实际上，在数组的情况下，它不仅要检查索引限制，还要计算您要查找的引用的实际内存位置 - 如 i=7，获取数组并添加 7 个单词-)。

长答案是，除非您真的大量使用该值**（**我的意思是很多）并且您确实由于速度而受到限制，否则不值得增加代码的复杂性。此外，局部变量意味着您的 JVM 使用更多内存，可能会遇到缓存错误，等等。

一般来说，你应该更多地担心你的算法（the `O(n)`）的效率，而不是这些小事情。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-02T21:39:04.683

Java 编译器不是笨蛋。[他会为你做优化。](http://en.wikipedia.org/wiki/Common_subexpression_elimination)通常，您提供的所有选项之间的速度差异为 0。

我说“通常”是因为是否访问原始对象或您的本地副本并不总是相同的。如果您的数组是全局可见的，并且另一个线程正在访问它，那么这两种形式将产生不同的结果，并且编译器无法将其中一种优化为另一种。有可能某些东西让编译器误以为可能有问题，即使没有。然后它不会应用合法的优化。

但是，如果您没有做有趣的事情，编译器会看到您在做什么并为您优化变量访问。真的，这就是编译器所做的。这就是它的用途。

您需要在此之上至少优化一个级别。这个不适合你。

# jquery - Openlayers 导航控件不可见

> ID：12239807
> 
> 赞同：0
> 
> 时间：2012-09-02T21:16:08.260
> 
> 标签：jquery, html, asp.net-mvc, openlayers

我有一个非常基本的地图设置，带有 openlayers，只有 3 个控件，内置在 MVC 项目中。但是，出于某些原因，导航控件和 panzoombar 不显示（尽管 mouseposition 之一显示）。我在地图加载时看到它们片刻，但随后它们消失了。下面是我用来实现这一点的代码。谁能告诉我我做错了什么？

```
 function initNormMap() {
        var map;
        OpenLayers.DOTS_PER_INCH = 72;
        map = new OpenLayers.Map('divmap', {
            controls: [
                        new OpenLayers.Control.Navigation(),
                        new OpenLayers.Control.PanZoomBar(),
                        new OpenLayers.Control.MousePosition()
            ], units: 'm',
            projection: new OpenLayers.Projection("EPSG:900913"),
            displayProjection: new OpenLayers.Projection("EPSG:4326")
        });
        //http://trac.osgeo.org/openlayers/wiki/AvailableWMSServices
        var ol_wms = new OpenLayers.Layer.WMS("OpenLayers WMS",
                    "http://labs.metacarta.com/wms/vmap0",
                      { layers: 'basic' });

        var osm_wms = new OpenLayers.Layer.OSM();
        map.addLayers([osm_wms]);
        var fromProjection = new OpenLayers.Projection("EPSG:4326");   // Transform from WGS 1984
        var toProjection = new OpenLayers.Projection("EPSG:900913"); // to Spherical Mercator Projection
        var position = new OpenLayers.LonLat(-98, 39).transform(fromProjection, toProjection);
        var zoom = 4;
        map.setCenter(position, zoom);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T15:35:12.280

问题出在 MVC4 捆绑上，它似乎根本不适用于 openlayers。我在我的 BundleConfig.cs 文件中有：

```
var openBun = new ScriptBundle("~/bundles/openlayerjs").Include("~/OpenLayers-2.10/OpenLayers.js");
        openBun.CdnPath = @"http://cdnjs.cloudflare.com/ajax/libs/openlayers/2.11/OpenLayers.js";
        bundles.Add(openBun); 
```

在我实际的 .cshtml 页面中：

```
@Scripts.Render("~/bundles/openlayerjs") 
```

我什至在没有 CDNPath 的情况下尝试过，但每次都遇到同样的问题。改为直

```
<script type="text/javascript" src="@Url.Content("~/OpenLayers-2.10/OpenLayers.js")"></script> 
```

它工作正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-15T11:50:44.473

捆绑失败的原因是**除非明确指定**，否则 OpenLayers 将**尝试加载相对于脚本文件的“style.css”**。

例子：

```
Script: /scripts/OpenLayers-2.13.1/OpenLayers.js
Style:  /scripts/OpenLayers-2.13.1/theme/default/style.css 
```

捆绑脚本后，脚本路径变为：

```
/scripts/master-bundle?v=Jg4I5oThMOtPHMDHusv30zPkDMVHcvHtjoLyWPwIC1A1 
```

并且“style.css”无法加载，导致图像不显示。

**解决方案**可以在OpenLayers.js的**源代码中找到**

```
 * Please remember that when your OpenLayers script is not named 
 * "OpenLayers.js" you will have to make sure that the default theme is 
 * loaded into the page by including an appropriate <link>-tag, 
 * e.g.:
 * 
 * (code)
 *   <link rel="stylesheet" href="/path/to/default/style.css"  type="text/css">
 * (end code) 
```

如果要捆绑脚本文件，则**需要显式引用 'style.css'**，如下所示：

```
<link rel="stylesheet" href="/scripts/OpenLayers-2.13.1/theme/default/style.css" type="text/css" /> 
```

**更新：**
您也需要设置`OpenLayers.ImgPath`，所以这是一种涵盖所有内容的**新方法**：

*openlayers-fix.js*

```
var basePath = '/Scripts/OpenLayers-2.13.1/';
var cssPath = basePath + 'theme/default/style.css';
var imgpath = basePath + 'img/';

// load stylesheet
$('<link>')
    .appendTo('head')
    .attr({ type: 'text/css', rel: 'stylesheet' })
    .attr('href', cssPath);

// set image path
OpenLayers.ImgPath = imgpath; 
```

*捆绑配置*

```
bundles.Add(new ScriptBundle("~/scripts/openlayers")
       .Include(new[]
           {
               "~/Scripts/OpenLayers-2.13.1/OpenLayers.js",
               "~/Scripts/OpenLayers-2.13.1/lang/nl.js",
               "~/Scripts/openlayers-fix.js"
           }) 
```

# java - 如何从控制台在 mac 上制作可运行的 jar？

> ID：12239811
> 
> 赞同：0
> 
> 时间：2012-09-02T21:16:43.987
> 
> 标签：java, macos, jar, terminal, runnable

我正在用 java 制作一个游戏，它会打开一个窗口，做一些图形操作，它可以从带有`java Game`.

我知道 using`jar cfm Game.jar src/manifest.txt src/*.class`可以完美地创建 jar，但是当我双击 jar 时它不会运行。

之前看过其他代码，之前还做过可运行的jar，但是现在找不到旧的，也找不到任何帮助（对于mac，用控制台（NOT ECLISPE））。

谁能告诉我我做错了什么？

到目前为止，这是我所拥有的： - 两个类文件，一个带有 main 方法 - manifest.txt 与`Main-Class: Game`（我将输入作为最后一行） - 通过控制台制作 jar 的命令 - 具有文件，但双击时不会运行

我想我需要在 Game 类上放一些东西，说明它实现了 Runnable 或类似的东西。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T21:21:55.040

我只是自己想通了。不感谢互联网，主要是甲骨文... -.-

我`implements Runnable`在游戏课之后放了，它马上就奏效了！感谢您的帮助，所有在线教程都忽略了一点：/

您也不需要导入任何内容，只需执行以下操作：

```
public class ClassName implements Runnable { 
```

# ios - 在 iOS 上，如果 SDWebImage 没有占位符，那么图像不会显示？

> ID：12239813
> 
> 赞同：1
> 
> 时间：2012-09-02T21:16:55.150
> 
> 标签：ios, uitableview, sdwebimage

如果代码在里面`tableView:cellForRowAtIndexPath`

```
[cell.imageView setImageWithURL:
     [NSURL URLWithString:
         [NSString stringWithFormat:
              @"http://www.mysite.com/images/pic%i.png", 
              indexPath.row % 12]]]; 
```

没有占位符，图像不会显示？（如果使用占位符，则会显示）。

我之前试过设置`cell.imageView.frame = CGRectMake(0, 0, 300, 300);`，还是不显示。如果我使用较长的版本`setImageWithURL:placeholderImage:success:failure:`并使用 , 的占位符`nil`并在成功块中使用，则图像将显示（但如果在调用之前使用，`[cell setNeedsLayout];`则不能包含在 300x300 框中 它可能是 400 x 300 或 500 x 300，具体取决于图像宽度）。但是简短的形式呢？它可以工作吗？`cell.imageView.frame = CGRectMake(0, 0, 300, 300);``setNeedsLayout`

# jsf - Primefaces基本自动完成功能不起作用

> ID：12239820
> 
> 赞同：4
> 
> 时间：2012-09-02T21:17:29.253
> 
> 标签：jsf, primefaces

我正在尝试 [自动完成演示](http://www.primefaces.org/showcase-labs/ui/autoCompleteBasic.jsf)。我没有收到任何错误，但 httprequest/response 显示它正在与服务器通信，而不是与 bean 通信。我正在使用最新版本的 primefaces 3.4。

任何帮助表示赞赏。

豆 ：

```
import java.io.Serializable;
import java.util.ArrayList;
import java.util.List;
import javax.faces.bean.ManagedBean;
import javax.faces.bean.ViewScoped;
import com.zreflect.emyed.managedbean.BaseMB;

@ManagedBean
@ViewScoped
public class CircleSearchBean extends BaseMB implements Serializable {
    private static final long serialVersionUID = 1L;
    private String selected;
    List<String> results = new ArrayList<String>();
    public List<String> complete(String query) {
        List<String> results = new ArrayList<String>();
        for (int i = 0; i < 10; i++) {
            results.add(query + i);
        }
        return results;
    }
    /**
     * @return the selected
     */
    public String getSelected() {
        return selected;
    }

    /**
     * @param selected
     *            the selected to set
     */
    public void setSelected(String selected) {
        this.selected = selected;
    }
} 
```

XHTML

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:p="http://primefaces.org/ui"
    xmlns:c="http://java.sun.com/jsp/jstl/core">
<h:head>
    <title><h:outputText value="test" /></title>
</h:head>

<h:body>
<h:form>
<p:autoComplete value="#{circleSearchBean.selected}" completeMethod="#{circleSearchBean.complete}"/> 
</h:form>
</h:body>
</html> 
```

这是来自 Chrome 开发者工具的调试信息。

要求：

```
Request URL:http://localhost:8080/PrimefacesTest/faces/index.xhtml
Request Method:POST
Status Code:200 OK 
```

请求标头：

```
Accept:application/xml, text/xml, */*; q=0.01
Accept-Charset:ISO-8859-1,utf-8;q=0.7,*;q=0.3
Accept-Encoding:gzip,deflate,sdch
Accept-Language:en-US,en;q=0.8
Connection:keep-alive
Content-Length:157
Content-Type:application/x-www-form-urlencoded; charset=UTF-8
Cookie:JSESSIONID=60Wd6aXSj6rDbPOgvMCoFJFF.undefined
Faces-Request:partial/ajax
Host:localhost:8080
Origin:http://localhost:8080
Referer:http://localhost:8080/PrimefacesTest/faces/index.xhtml
User-Agent:Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.89 Safari/537.1
X-Requested-With:XMLHttpRequest 
```

表格数据：

```
javax.faces.partial.ajax:true
javax.faces.source:j_idt8
javax.faces.partial.execute:j_idt8
javax.faces.partial.render:j_idt8
j_idt8:j_idt8
j_idt8_query:hello 
```

响应标头：

```
Cache-Control:no-cache
Content-Length:346
Content-Type:text/xml;charset=UTF-8
Date:Sun, 02 Sep 2012 21:11:42 GMT
Server:Apache-Coyote/1.1
X-Powered-By:JSF/2.0 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T18:40:53.767

在将“id”属性添加到自动完成后，它现在正在工作，如演示中所示。

```
<p:autoComplete id="autocomplete" value="#{circleSearchBean.selected}" 
   completeMethod="#{circleSearchBean.complete}"/> 
```

在一个单独的项目中，它在没有“id”属性的情况下工作。看起来像一个错误。

# ruby-on-rails - 缺少 gems & db:migrate 问题

> ID：12239821
> 
> 赞同：0
> 
> 时间：2012-09-02T21:17:46.030
> 
> 标签：ruby-on-rails, rake, bundler

我正在尝试完成Andrew Perkins 的[本教程](http://www.youtube.com/watch?v=UQ8_VOGj5H8)。当我到达时，`rake db:migrate`每次安装缺少的 gem 时都会收到此错误和类似的后续错误。

> 在任何源中找不到 rake-0.9.2.2
> 运行`bundle install`以安装缺少的 gem。

我已经运行`bundle install`但不确定我是否已正确安装或具有所有正确的依赖项。我对 Rails 还很陌生，所以我对哪里出错没有一个好主意，所以任何正确安装的例子都会非常有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T21:25:32.433

尝试

```
bundle exec rake db:migrate 
```

这可确保`rake`命令运行是您项目的 Gemfile 中指定的命令。[`bundle exec`您可以在 docs](http://gembundler.com/man/bundle-exec.1.html)中阅读更多信息。

# php - Wordpress 自定义帖子类型默认页面？

> ID：12239825
> 
> 赞同：1
> 
> 时间：2012-09-02T21:19:04.717
> 
> 标签：php, wordpress

好的，我已经制作了自定义帖子类型，它们工作正常（代码如下所示）。但我似乎无法为其创建默认页面，例如 example.com/php < 如何获取该页面。我可以制作像 example.com/php/some page/ 这样的页面，它们工作正常。

```
$labels = array(
'name' => _x('PHP', 'post type general name'),
'singular_name' => _x('PHP', 'post type singular name'),
'add_new' => _x('Add New', 'PHP Page'),
);
$args = array(
'labels' => $labels,
'taxonomies' => array('post_tag'),
'public' => true,
'publicly_queryable' => true,
'show_ui' => true, 
'show_in_menu' => true, 
'query_var' => true,
'rewrite' => true,
'capability_type' => 'post',
'has_archive' => true, 
'hierarchical' => true,
'menu_position' => null,
'supports' => array( 'title', 'editor', 'page-attributes')
 ); 
register_post_type('php',$args); 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T21:32:49.747

我不确定在 WordPress 中是否有一种直观的方法可以做到这一点（您可能想在[https://wordpress.stackexchange.com/](https://wordpress.stackexchange.com/)上查看）。但是，我将解释我以前是如何做到这一点的。

`php.php`使用您希望“默认”页面执行的任何操作创建一个新的页面模板，例如。通常，我包含一个仅从我的自定义帖子类型中提取的循环。

```
<?php
/*
Template Name: PHP Default Page
*/
// ...
query_posts("post_type=php");
// ...
?> 
```

然后，在 WordPress 仪表板中创建一个标题为“PHP”的页面（因此它将具有永久链接，`http://example.com/php`）

# php - PHP shell大输出（100+行）到浏览器

> ID：12239827
> 
> 赞同：0
> 
> 时间：2012-09-02T21:19:18.160
> 
> 标签：php

我正在尝试执行一个包含 100 多行并且是动态数据的 shell 脚本。我如何在 shell 执行时将每一行打印到浏览器。这是我正在尝试的方式，但它不起作用？

```
<?php
    ob_start();  
    echo "<pre>";  
    system("/var/www/html/shell_script.sh -e <arg1>");  
    ob_flush();  
    flush();  
?> 
```

但下面的代码正在工作，因为我正在循环......

```
<?php
    ob_start();
    for($i=0;$i<40;$i++)
    {
        echo 'printing...<br />';
        ob_flush();
        flush();
        ob_end_flush();
        usleep(300000);
    }
?> 
```

请建议我如何在执行时将外壳输出到浏览器。

# php - Foursquare：无用户身份验证中缺少“hereNow”？

> ID：12239831
> 
> 赞同：2
> 
> 时间：2012-09-02T21:20:20.130
> 
> 标签：php, api, foursquare

我是foursquare API的新手。我正在尝试使其与我的 wordpress 网站（列表目录，如场地）一起工作，并且对于每个场地，我想显示“hereNow”用户以及照片和评论/提示。我已经注册了我的应用程序，所以我有客户端 ID 和密码。对于提示/照片，我想我不能没有 Auth，但我想知道为什么现在我的数组中缺少这里。这是我在我的 php 文件中使用的查询：

```
$venue = $fsObjUnAuth->get('/venues/search', array('near' => $city, 'query' => $title )); 
```

在哪里

```
$fsObjUnAuth = new EpiFoursquare($clientId, $clientSecret); 
```

城市和标题取自 Wordpress 自定义字段。

我得到了正确的输出，但现在丢失了，这里是摘录：

```
 ["verified"]=>
      bool(false)
      ["stats"]=>
      object(stdClass)#20 (3) {
        ["checkinsCount"]=>
        int(1)
        ["usersCount"]=>
        int(1)
        ["tipCount"]=>
        int(0)
      }
      ["likes"]=>
      object(stdClass)#21 (2) {
        ["count"]=>
        int(0)
        ["groups"]=>
        array(0) {
        }
      }
      ["specials"]=>
      array(0) {
      }
    } 
```

它应该低于特价商品，但没有痕迹。在 Api Explorer 中，它经常出现，但在我的文件中没有。有什么提示吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-08T16:48:35.080

我已经解决了这个问题，在 json url 的末尾添加了“v=”查询，基本上它是 v2 API 中需要的日期（Ymd）。有了它，我的输出显示了 hereNow

# iphone - 从 Google Plus 获取好友列表

> ID：12239832
> 
> 赞同：0
> 
> 时间：2012-09-02T21:20:39.157
> 
> 标签：iphone, objective-c, ios, google-plus

我已经在我的 iPhone 应用程序中使用 Google plus API 成功登录。现在我想用姓名、身份证和生日来获取我所有的朋友。谁能帮帮我吗。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T18:55:04.503

运气不好..根据我目前的经验，谷歌没有任何 API 来检索与朋友相关的数据。

参考这些。

[如何在 Android 中获取 Google+ 好友](https://stackoverflow.com/questions/9584822/how-to-fetch-google-plus-friends-in-android)

[google+ api 人的朋友](https://stackoverflow.com/questions/7683115/google-api-persons-friends)

[获取 google plus 用户好友](https://stackoverflow.com/questions/10820536/get-google-user-friends)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T12:07:02.343

你试过这个 API 方法吗？

queryForPeopleListWithUserId：集合：

来源：[https ://developers.google.com/+/mobile/ios/people](https://developers.google.com/+/mobile/ios/people)

# sql-server-2008 - 实体框架视图在选择时不显示所有行

> ID：12239833
> 
> 赞同：0
> 
> 时间：2012-09-02T21:20:45.073
> 
> 标签：sql-server-2008, entity-framework, views

我在 sql server 2008 中有一个常规视图，并且我正在使用实体框架从数据库方法生成设计。我已经知道实体框架中视图的关键问题，但这不是我的解决方案。当我从视图中查询 select * 时，它带出了 3 行，这是正确的，但所有行都是相同的，并且是数据库视图中的第一行。

一些帮助将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-02T21:32:22.267

> 我已经知道实体框架中视图的关键问题，但这不是我的解决方案。当我从视图中查询 select * 时，它带出了 3 行，这是正确的，但所有行都是相同的，并且是数据库视图中的第一行。

您所描述的正是由错误的密钥引起的问题。您的三行必须具有唯一标识 - 某些列或一组列必须唯一标识每个可能返回的记录。这些列必须在设计器中设置为实体键。

您还可以通过在从视图加载数据时不使用更改跟踪来避免此问题，因为返回的实体是只读的。您必须为此`MergeOption.NoTracking`使用`ObjectSet`：

```
context.MyViewEntities.MergeOption = MergeOption.NoTracking;
var data = context.MyViewEntities.ToList(); 
```

# jsp - jsp 在代理后面学习其外部 URL

> ID：12239840
> 
> 赞同：0
> 
> 时间：2012-09-02T21:21:23.620
> 
> 标签：jsp

考虑一个 JSP 页面，其中包含以下内容，位于反向代理后面。

前者可以通过使用 mod_proxy_html 重写来解决`link`，但它不会在脚本元素中进行探索。有没有比通过 -D 传递正确的 URL 并覆盖 pageContext.request.contextPath 更好的解决方案？

```
<link rel="stylesheet" 
    href="${pageContext.request.contextPath}/services/legendcss/legend.css?version=2"
    type="text/css"/>

 <script>
    var bt_wd40_appurl = "${pageContext.request.contextPath}/services";
</script> 
```

为了澄清，也许：

考虑可在 上访问的 Tomcat`http://internalhost.com`副本和可在公共 Internet 上访问的 Apache2 副本`http://externalhost.com`。

Apache 实例的配置包括一个从 映射`http://externalhost.com/blue/green/`到的反向代理`http://internalhost.com/yellow`。

现在，位于“黄色”的东西是一个 Web 应用程序，由带有 JavaScript 的网页组成，这些网页需要与黄色 Web 应用程序内的 Web 服务进行通信。我们不想在这些东西中加入路径名。上面的代码会将“内部主机”URL 传递给浏览器，而浏览器无法与它们对话。我需要它来提供“外部主机”URL。

我不希望在 JSP 或 HTML 中使用对部署它的 URL 进行假设的代码，更不用说代理的存在了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T12:56:57.463

经过考虑，Web 服务的相对 URL 似乎是最不坏的选择。因此，EL 表达式完全消失了，并且 URL 在代理的任一侧都可以正常工作。这需要 JSP 页面和 Web 服务之间的恒定路径关系，但这是一个很小的代价。

# php - 加权网站旋转器

> ID：12239844
> 
> 赞同：0
> 
> 时间：2012-09-02T21:22:46.600
> 
> 标签：php

对于我创建的所有链接，我需要一个加权旋转器，以便流量可以按加权比例分配到我定义的目的地。我目前使用以下内容：

```
<?

header('Location: www.destinationwebsite1.com/index.php');

?> 
```

但是，这只会将流量分配到 1 个来源。我想要一些基于“权重”分配到我定义的许多目的地的东西。

如：

```
25% to www.destinationwebsite1.com/index.php 
25% to www.destinationwebsite2.com/index.php 
25% to www.destinationwebsite3.com/index.php 
25% to www.destinationwebsite4.com/index.php 
```

或我选择的任何百分比。有人有想法么？

最佳-N

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T21:29:09.157

使用[`rand`om](http://php.net/rand)编号并根据它将您的结果发送到不同的地方。

```
// equal weights:
$sites = Array(
     "http://www.example.com/",
     "http://google.com/",
     "http://youtube.com/"
);
header("Location: ".$sites[rand(0,count($sites)-1)]);

// individual weights:
$sites = Array(
     "http://www.example.com/" => 50,
     "http://google.com/" => 30,
     "http://youtube.com/" => 20
);
$rand = rand(0,array_sum($sites)-1);
foreach($sites as $site=>$weight) {
    $rand -= $weight;
    if( $rand < 0) break;
}
header("Location: ".$site); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T21:28:53.563

像这样的东西？

```
<?php
$r = rand() / getrandmax();

if ( $r < 0.25 )
{
    header( 'Location: www.destinationwebsite1.com/index.php' );
}
elseif ( $r < 0.50 )
{
    header( 'Location: www.destinationwebsite2.com/index.php' );
}
elseif ( $r < 0.75 )
{
    header( 'Location: www.destinationwebsite3.com/index.php' );
}
else
{
    header( 'Location: www.destinationwebsite4.com/index.php' );
}

?> 
```

从统计上讲，这应该将 25% 的访问者发送到每个站点。要更改发送到每个站点的访问者的比例，只需更改权重数字即可。

# data-mining - 为什么三角定律在数据挖掘中如此重要

> ID：12239847
> 
> 赞同：1
> 
> 时间：2012-09-02T21:23:27.983
> 
> 标签：data-mining

我很想知道为什么三角定律对于更好的数据挖掘如此重要。据我所知，三角定律可以帮助我们根据不同对象之间的距离定义模式并形成集群。有没有人对三角定律有任何其他输入?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T08:01:18.377

它实际上并不那么重要。在数据挖掘中，我们通常不能假设具有适当的“数学”距离函数。一旦我们允许重复，我们就已经失去了一个关键公理——我们*可以*有两个距离为 0 的不同对象。（在分类中，在最坏的情况下它们甚至可能有不同的类）。

然而，三角不等式可以让我们*修剪*搜索空间。如果我们有一个满足三角不等式的距离函数并使用适当的索引，我们可以**跳过很多计算**，从而使算法更快。

请注意，许多研究和实现并不太关心这种优化。许多使用 R 的数据挖掘者喜欢构建一个距离矩阵（`O(n^2)`在优化的 C 代码，而不是解释的 R 代码）。但如果你需要超越这一点，性能的一个关键因素是尽可能利用三角不等式。

# macos - FSEvents 处理被其他操作系统改变的磁盘

> ID：12239848
> 
> 赞同：4
> 
> 时间：2012-09-02T21:23:34.957
> 
> 标签：macos, fsevents

我在 FSEvents 上看到了奇怪的行为，我在恢复模式下挂载了我的驱动器，并且在重新启动时，我的流中的 fsevents 为零。我执行以下操作：

1.  定期开机
2.  使用 FSEventsGetCurrentEventId() 记录当前事件
3.  以恢复模式启动并修改监视路径中的文件
4.  重启系统

发生这种情况时，我在使用 fsevents API 时根本没有收到任何事件。它在 kFSEventStreamEventFlagHistoryDone 哨兵中发送的唯一标志，即使我在常规操作系统上进行了其他更改。

此[ars technica 评论](http://arstechnica.com/apple/2007/10/mac-os-x-10-5/7/)似乎暗示当您安装在其他设备上时，您应该获得 kFSEventStreamEventFlagMustScanSubDirs 标志，但我没有看到这种行为。有没有人遇到过这个？有没有更好的方法来检测和处理在操作系统关闭时驱动器已安装在其他地方的情况？

更新：我尝试了从 linux 启动并修改文件系统的相同操作。无论如何，我没有得到同样奇怪的 0 事件行为，但我也没有从我更改的目录或 MustScanSubdirs 标志中得到事件。

更新 2：在[这个线程](https://discussions.apple.com/thread/1969175?start=0&tstart=0)中，接受的响应说当发生这种情况时，时间机器会检测到在上述情况下日志已过期。有谁知道如何检测日志是否过期？这个日期可以用来代替标志。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T01:29:34.383

我认为您还需要在步骤 #2 中存储 FSEvents 数据库的 UUID，并在步骤 #4 中检查它。

[Apple的文档中含糊地提到了](https://developer.apple.com/library/mac/documentation/Darwin/Conceptual/FSEvents_ProgGuide/UsingtheFSEventsFramework/UsingtheFSEventsFramework.html)这种行为（强调添加）：

> **注意：**由于运行早期版本的 OS X（或可能的其他操作系统）的计算机可以修改磁盘，因此您应该将事件列表视为建议，而不是卷所有更改的最终列表。**如果运行先前版本的 OS X 的计算机修改了磁盘，则历史日志将被丢弃。**
> 
> 例如，备份软件仍应定期对任何卷执行全面扫描，以确保没有任何更改漏掉。

请注意有关丢弃历史日志的信息，然后查看[参考资料](https://developer.apple.com/library/mac/documentation/Darwin/Reference/FSEvents_Ref/Reference/reference.html)（已添加重点）：

> FSEventStreamGetLatestEventId() -> 最初，它返回创建流时提供的 sinceWhen 值；此后，在调用客户端回调之前，它会使用当前批次事件中提到的编号最高的事件 ID 进行更新。**只要客户端还存储设备的 UUID**（通过 FSEventsCopyUUIDForDevice() 获得），客户端就可以永久存储此值。客户端随后可以将此事件 ID 作为 FSEventStreamCreateRelativeToDevice() 的 sinceWhen 参数提供，只要其 UUID 与您存储的内容匹配。这是因为 FSEvents 服务将事件存储在一个持久的、按卷的数据库中。在这方面，事件 ID 流就像一个全局的、系统范围的时钟，但与任何特定的时基无关。
> 
> FSEventsCopyUUIDForDevice() -> 获取唯一标识该卷的 FSEvents 数据库的 UUID。**如果数据库被丢弃，那么它的替换将具有不同的 UUID，以便客户端能够检测到这种情况并避免尝试使用它们存储为 FSEventStreamCreate...() 函数的 sinceWhen 参数的事件 ID。**

请注意，UUID 是针对每个设备的，因此如果您在目录树中安装了任何文件系统，您可能需要获取每个文件系统的 UUID。

祝你好运！

# cuda - CUDA Toolkit 4.1/4.2：nvcc 因访问冲突而崩溃

> ID：12239849
> 
> 赞同：1
> 
> 时间：2012-09-02T21:23:44.053
> 
> 标签：cuda, gpu, gpgpu, nvidia

我正在使用 Windows 7 64 位上的 Visual Studio 2010 Professional 为 GTX 580 开发 CUDA 应用程序。我的项目使用 CUDA Toolkit 4.0 构建良好，但是当我选择 CUDA Toolkit 4.1 或 4.2 时 nvcc 崩溃并出现以下错误：

> 1> 堆栈转储：
> 1> 0\. 在模块“moduleOutput”上运行“Promote Constant Global”。
> 1>CUDACOMPILE：nvcc 错误：'cicc' 以状态 0xC0000005 (ACCESS_VIOLATION) 死亡

奇怪的是，程序在为“代码生成”指定“compute_10,sm_10”的情况下编译正常，但“compute_20,sm_20”不起作用。有问题的代码可以在这里下载：

[http://www.meriken2ch.com/files/CUDA_SHA-1_Tripper_MERIKENs_Branch_0.04_Alpha_1.zip](http://www.meriken2ch.com/files/CUDA_SHA-1_Tripper_MERIKENs_Branch_0.04_Alpha_1.zip)

（README.txt 为日文，但源文件中的注释为英文。）

我怀疑 CUDA Toolkit 4.1/4.2 中有一个新引入的错误。有人遇到过这个问题吗？有什么解决方法吗？任何形式的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T00:23:26.003

这似乎是 CUDA 4.x 中的编译器错误，已在 CUDA 5.0 中修复（根据 @meriken2ch 的评论，该项目使用 CUDA 5.0 RC 构建良好）。

# credit-card - 来自磁条信用卡的任意数据，如何解析？

> ID：12239855
> 
> 赞同：6
> 
> 时间：2012-09-02T21:24:22.187
> 
> 标签：credit-card

根据 wiki，可自由裁量的数据——

> 可能包括 Pin 验证密钥指示符（PVKI，1 个字符）、PIN 验证值（PVV，4 个字符）、卡验证值或卡验证码（CVV 或 CVC，3 个字符）

这意味着不能保证我总是能够获得 CVC，这对我来说是个问题。我能够使用现有的实现来解析我的信用卡条带，并为 discrepdata 获得一堆数字。我不确定如何准确解释。因为它超过 8 个字符并且与我的 cvc 或 pin 号不匹配。

看起来像（数字是随机的，但填充的 0 相同）：0000031200100

这是什么意思？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-03T08:54:47.820

您不应该使用可自由支配的数据。它（顾名思义）是完全可选的。一些卡方案根本不使用它，在允许它的方案中，大多数发卡*机构*不使用它。在使用它的地方，您会发现它在卡方案之间以及可能在发卡机构之间的填充方式存在差异。

此外，磁条上的 CVC 实际上是 CVC1 代码，它只是试图验证磁条细节没有被篡改/损坏。它与印在卡片背面的 CVC 代码不同。

印在卡片上的 CVC（按设计）仅供肉眼查看。

# editor - slickGrid：textEditor：输入字段时焦点不会触发

> ID：12239856
> 
> 赞同：1
> 
> 时间：2012-09-02T21:24:27.083
> 
> 标签：editor, slickgrid

这有点奇怪：

```
function myEditor(args) {
   this.init = function () {
      $input = $("<INPUT id='tags' class='editor-text' />");
      $input.appendTo(args.container);
   },

   $input.focus().select();
   this.init();
} 
$input.focus( function(e){ ... }) 
```

无论我尝试什么，它都不会触发。我究竟做错了什么？

或者，换个说法：当我想在输入单元格（-editor）时做某事时，我需要在什么元素中捕获什么事件？

# cordova - Phonegap 如何从应用程序菜单中获得“设置”页面？

> ID：12239860
> 
> 赞同：5
> 
> 时间：2012-09-02T21:25:06.367
> 
> 标签：cordova, cordova-2.0.0

我正在为 phonegap 开发一个应用程序，发现当我按下手机上的菜单按钮时，我看到一个名为“设置”的选项。

当我选择它时在调试器上触发的选项如下：

> : D/DroidGap(12793): onMessage(onOptionsItemSelected,Settings)

是否有任何可能的方法将该调用挂钩到应用程序内的页面/参数化查询，在“settings.html”或“index.html?page=settings”行中？

我试图用谷歌搜索，但没有运气。我的应用程序刚刚升级到 2.0 版，但我认为这并不重要。

更新：这是我当前实现的摘录：

```
var onMenuKeyDown;
onMenuKeyDown = function(ev) {
  return $("#mainBox").html(ev.type);
};
document.addEventListener("menubutton", onMenuKeyDown, false); 
```

在模拟器上触发事件时，似乎将“mainBox”的内部 html 更改为“menubutton”，但是当我在实际设备上运行它时不会发生这种情况。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-03T13:29:33.527

你有两个选择。

1）您可以监听“菜单按钮”事件，然后提供您自己的 html 设置页面。2) 你可以实现一个原生的首选项面板并通过 AppPreferences 插件调用它。

[http://simonmacdonald.blogspot.com/2012/06/phongap-android-application-preferences.html](http://simonmacdonald.blogspot.com/2012/06/phongap-android-application-preferences.html)

# c# - 链接和引导多个 MSI 并将现有的 MSI 功能集 GUI 合并到一个自定义的

> ID：12239861
> 
> 赞同：1
> 
> 时间：2012-09-02T21:25:11.290
> 
> 标签：c#, wix, windows-installer, installshield, bootstrapper

关于[Bootstrapper & Chaining](https://stackoverflow.com/a/4381099/763026)的问题之前可能已经被问过。我想问一些[相似](https://stackoverflow.com/q/4711920/763026)和**不同**的东西。

我的要求**是**作为一个单一的功能集，这样当用户选择顶层的任何功能时，该选择作为参数传递给底层的相应 msi 并继续安装。用户可以再次启动此 exe/安装程序，他可以通过以通常方式选择它们来删除/修改功能。`CHAIN 3 installshield msi into a single one``expose the feature selection GUI of 2 of the MSIs`

最后，当安装结束时`the package should generate a custom XML file`，将由内部工具使用，该工具基于用户上面选择的功能。

* * *

因此，标准和自定义行为混合在一起。`I have no clue about the world of installers`. 可能有人可以建议如何以最小的努力实现这一目标或重做*`correct approach ?`*.

我应该写这样一个工具`in C#/Winforms (or WPF) ?`看起来像重新发明轮子吗？即类似的东西

> *   在标准 GUI (Winforms / WPF) 中拥有自己的自定义 TreeView GUI
> *   Process.Start("msiexec /i /ADDLOCAL=Feature1 msi1.msi") --> ADDLOCAL 将从我的自定义 GUI 选择中传递功能集参数。
> *   挂钩进程的退出事件
> *   等待进程退出
> *   成功退出后，使用退出处理程序中的适当参数触发第二个 msi 等等...

我不知道它是否是正确的方法？非常感谢您对此的任何帮助。提前致谢！！

**（我为这个问题标记了 C#。）**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T22:01:28.703

老实说，bootstrappers 和 chainers 是非常复杂的故事......远远超过了眼睛。如果您对安装程序一无所知，那么您正在为大量工作做好准备。最好看看 WiX（Burn）和 InstallShield（Setup Prereqs 和 Suite Installers）等工具必须提供哪些工具，并更改您的要求以匹配它们的功能。

Microsoft 的团队（Office、SQL、Visual Studio）投入了大量时间和人才来开发他们的定制解决方案。比我们其他人通常必须花费的时间要多得多。

就个人而言，我会考虑将您的 MSI 分解为许多小型“微包”，每个“微包”都有 1 个功能。然后使用带有设置先决条件和功能先决条件的 InstallShield Basic MSI 项目将它们捆绑在一起。我遗漏了很多细节，因为您必须先有详细的要求，然后才能详细说明您将如何设计它。

WiX 3.6 ala Burn 也是一种可能性。

# javascript - Javascript图像数组预加载速度并从内存中删除

> ID：12239864
> 
> 赞同：0
> 
> 时间：2012-09-02T21:25:48.543
> 
> 标签：javascript, asp.net-mvc, memory, preload

我有一个 asp.net MVC 应用程序，我在一个视图中显示了许多图像，这些图像的数量在每组 100 到 2500 之间。在视图中，我为每个组预加载图像，然后从下拉列表中选择不同的组，这将刷新页面。第一次预加载效果很好，但是，当我更改组时，它非常慢。对这些图像的引用位于 MS SQL 数据库中，特定组的图像列表来自控制器 (C#)。这是我正在使用的 Javascript：

```
 var impath = $("#ImagePath").val();
        var im = $("#ImageName").val();

        var images = null;
        var images = [];
        var tochar = $("#lastchar").val();

        function preload_images() {

            var i;
            for (i = tochar; i < sl; i++) {
                images[i] = new Image();
                var name = impath.toString() + im.toString() + i;

            }
        } 
```

我的问题是有一种方法可以加快预加载过程，我是否需要在加载下一组之前从内存中删除预加载的图像以及如何删除它们，我使用了 images=null，这是正确的方法吗. 提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T23:44:06.653

处理这么多图像的最佳方法是使用精灵。使用 sprite，您可以加载一张较大的图像，其中包含许多较小的图像。由于在浏览器中加载单个图像比加载大量小图像要快得多，因此您的预加载可以快得多。实际上，您实际上可以只预加载一个包含整个子图像块的图像。

然后，当您想要显示其中一个图像时，您只显示图像的剪辑部分。有许多方法可以进行显示，但一种常见的方法是创建所需单元格大小的对象，并将较大的图像显示为背景，并使用适当的偏移量与较大图像的所需部分对齐。

这是关于 CSS 和精灵的有用参考：http: [//css-tricks.com/css-sprites/](http://css-tricks.com/css-sprites/)

您必须在服务器端创建适当的精灵才能使用此技术。

* * *

回答您的其他一些问题。

不，除了加载更少的图像（如上所述）或减小每个图像的大小之外，您无法加快它们的速度。浏览器一次只会通过网络发出 N 个图像请求（可能避免服务器超载），因此其余的将排队等待一个完成，然后发出下一个请求，等等......

您可以通过确保不再持有对它们的引用来从内存中释放图像。这样，浏览器垃圾收集器将清理您创建的 Image() 对象。在您的代码设置中，`images = null`或者`images = []`只要没有在其他任何地方引用这些 Image() 对象，就会实现这一点。图像仍将保留在浏览器的缓存中，并且本质上仍将被预加载（如果再次引用它们将不必通过网络加载）。

# objective-c - 为什么睡眠不工作？

> ID：12239866
> 
> 赞同：1
> 
> 时间：2012-09-02T21:26:04.430
> 
> 标签：objective-c, macos, cocoa, unix, system-calls

我有一个在单独的队列/线程上运行的函数。在这个函数中，我试图调用`usleep`.

无论传入的值如何，`usleep`似乎都不起作用。也是如此`sleep()`。

为了诊断错误，我打印了`errno`. `errno`打印为：“中断的系统调用”

**这到底是什么意思，我该如何诊断它？**

手册页将错误描述为：

```
[EINTR]            A signal was delivered to the process and its action was to invoke a signal-catching
                    function. 
```

注意我在使用 Xcode 4 和 Objective-C 的 OSX Mountain Lion 上。我正在使用 Cocoa 为 OSX 开发应用程序。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T07:28:33.810

`usleep`并且`sleep`可以通过传递信号以这种方式中断。

没有专用的信号传递线程，因此可以将信号传递到应用程序中的任意线程。

**注意**下面留下的原始答案在 Mountain Lion 上*无法*正常工作 - 在 XCode 下运行时会触发 EINTR。

为了避免这个问题，我们切换到`nanosleep`，并使用这样一个事实，即当它被中断时，它会在第二个参数中返回剩余时间：

```
struct timespec to_sleep = { 1, 0 }; // Sleep for 1 second
while ((nanosleep(&to_sleep, &to_sleep) == -1) && (errno == EINTR)); 
```

虽然，如果您使用的是 NSThread，那么您最好使用：

```
[NSThread sleepForTimeInterval:1.0f]; // sleep for 1 second 
```

这是可可的睡眠方式，不会受到“打嗝”的影响`sleep`，`usleep`和`nanosleep`经验

**旧答案**- 在调试器下无法正常工作。

如果你想防止你的线程`usleep`被中断，你需要屏蔽掉所有可能传递给线程的信号。例如

```
#include <signal.h>

sigset_t sigset;
sigset_t oldset;
sigfillset(&sigset);
pthread_sigmask(SIG_BLOCK, &sigset, &oldset);
usleep(9999);
pthread_sigmask(SIG_SETMASK, &oldset, NULL); 
```

*注意*：此代码中未进行错误检查

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T00:51:10.680

你不能`errno`在任何时候随意打印并期望它有用。它是一个每个线程的变量，只有在特定的系统调用设置它之后才会设置。

即，您只能`errno`在确定呼叫失败时进行检查。

任何一个呼叫都不太可能失败。极不可能。

* * *

从您的问题中不清楚您正在获取返回值。

*   在调试器之外尝试它，它可能是调试器用信号冲洗东西。如果是这样，它很可能是一个错误。

*   您还有其他信号量大的代码或子系统在使用吗？一般来说，信号处理程序在 Unix 系统上很麻烦。

*   你在使用lldb吗？你试过切换到gdb吗？

# java - 将文件从 REST Web 服务发送到客户端的正确方法是什么？

> ID：12239868
> 
> 赞同：114
> 
> 时间：2012-09-02T21:26:09.687
> 
> 标签：java, json, web-services, rest, jersey

我刚刚开始开发 REST 服务，但遇到了一个困难的情况：将文件从我的 REST 服务发送到我的客户端。到目前为止，我已经掌握了如何发送简单数据类型（字符串、整数等）的窍门，但发送文件是另一回事，因为文件格式太多，我什至不知道应该从哪里开始。我的 REST 服务是在 Java 上创建的，我使用的是 Jersey，我使用 JSON 格式发送所有数据。

我读过 base64 编码，有人说这是一种很好的技术，其他人说这不是因为文件大小问题。正确的方法是什么？这是我项目中一个简单资源类的外观：

```
import java.sql.SQLException;
import java.util.List;

import javax.ws.rs.GET;
import javax.ws.rs.Path;
import javax.ws.rs.Produces;
import javax.ws.rs.core.Context;
import javax.ws.rs.core.MediaType;
import javax.ws.rs.core.Request;
import javax.ws.rs.core.UriInfo;

import com.mx.ipn.escom.testerRest.dao.TemaDao;
import com.mx.ipn.escom.testerRest.modelo.Tema;

@Path("/temas")
public class TemaResource {

    @GET
    @Produces({MediaType.APPLICATION_JSON})
    public List<Tema> getTemas() throws SQLException{

        TemaDao temaDao = new TemaDao();        
        List<Tema> temas=temaDao.getTemas();
        temaDao.terminarSesion();

        return temas;
    }
} 
```

我猜发送文件的代码是这样的：

```
import java.sql.SQLException;

import javax.ws.rs.GET;
import javax.ws.rs.Path;
import javax.ws.rs.Produces;

@Path("/resourceFiles")
public class FileResource {

    @GET
    @Produces({application/x-octet-stream})
    public File getFiles() throws SQLException{ //I'm not really sure what kind of data type I should return

        // Code for encoding the file or just send it in a data stream, I really don't know what should be done here

        return file;
    }
} 
```

我应该使用什么样的注释？我看到有人推荐`@GET`using `@Produces({application/x-octet-stream})`，这是正确的方法吗？我发送的文件是特定的，因此客户端不需要浏览这些文件。谁能指导我如何发送文件？我应该使用 base64 对其进行编码以将其作为 JSON 对象发送吗？还是不需要编码就可以将其作为 JSON 对象发送？感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：156
> 
> 时间：2012-09-03T16:18:06.363

我不建议在 base64 中编码二进制数据并将其包装在 JSON 中。它只会不必要地增加响应的大小并减慢速度。

只需使用 GET 并`application/octect-stream`使用以下工厂方法之一提供您的文件数据[`javax.ws.rs.core.Response`](http://docs.oracle.com/javaee/6/api/javax/ws/rs/core/Response.html)（JAX-RS API 的一部分，因此您不会被锁定在 Jersey 中）：

```
@GET
@Produces(MediaType.APPLICATION_OCTET_STREAM)
public Response getFile() {
  File file = ... // Initialize this to the File path you want to serve.
  return Response.ok(file, MediaType.APPLICATION_OCTET_STREAM)
      .header("Content-Disposition", "attachment; filename=\"" + file.getName() + "\"" ) //optional
      .build();
} 
```

如果您没有实际`File`对象，但`InputStream`,[`Response.ok(entity, mediaType)`](http://docs.oracle.com/javaee/6/api/javax/ws/rs/core/Response.html#ok%28java.lang.Object,%20javax.ws.rs.core.MediaType%29)也应该能够处理它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-03T15:18:18.333

如果你想返回一个要下载的文件，特别是如果你想与一些文件上传/下载的 javascript 库集成，那么下面的代码应该可以完成这项工作：

```
@GET
@Path("/{key}")
public Response download(@PathParam("key") String key,
                         @Context HttpServletResponse response) throws IOException {
    try {
        //Get your File or Object from wherever you want...
            //you can use the key parameter to indentify your file
            //otherwise it can be removed
        //let's say your file is called "object"
        response.setContentLength((int) object.getContentLength());
        response.setHeader("Content-Disposition", "attachment; filename="
                + object.getName());
        ServletOutputStream outStream = response.getOutputStream();
        byte[] bbuf = new byte[(int) object.getContentLength() + 1024];
        DataInputStream in = new DataInputStream(
                object.getDataInputStream());
        int length = 0;
        while ((in != null) && ((length = in.read(bbuf)) != -1)) {
            outStream.write(bbuf, 0, length);
        }
        in.close();
        outStream.flush();
    } catch (S3ServiceException e) {
        e.printStackTrace();
    } catch (ServiceException e) {
        e.printStackTrace();
    }
    return Response.ok().build();
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-10-24T07:38:41.720

将机器地址从 localhost 更改为您希望客户端连接的 IP 地址，以调用下面提到的服务。

客户端调用 REST web 服务：

```
package in.india.client.downloadfiledemo;

import java.io.BufferedInputStream;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;

import javax.ws.rs.core.MediaType;
import javax.ws.rs.core.Response.Status;

import com.sun.jersey.api.client.Client;
import com.sun.jersey.api.client.ClientHandlerException;
import com.sun.jersey.api.client.ClientResponse;
import com.sun.jersey.api.client.UniformInterfaceException;
import com.sun.jersey.api.client.WebResource;
import com.sun.jersey.multipart.BodyPart;
import com.sun.jersey.multipart.MultiPart;

public class DownloadFileClient {

    private static final String BASE_URI = "http://localhost:8080/DownloadFileDemo/services/downloadfile";

    public DownloadFileClient() {

        try {
            Client client = Client.create();
            WebResource objWebResource = client.resource(BASE_URI);
            ClientResponse response = objWebResource.path("/")
                    .type(MediaType.TEXT_HTML).get(ClientResponse.class);

            System.out.println("response : " + response);
            if (response.getStatus() == Status.OK.getStatusCode()
                    && response.hasEntity()) {
                MultiPart objMultiPart = response.getEntity(MultiPart.class);
                java.util.List<BodyPart> listBodyPart = objMultiPart
                        .getBodyParts();
                BodyPart filenameBodyPart = listBodyPart.get(0);
                BodyPart fileLengthBodyPart = listBodyPart.get(1);
                BodyPart fileBodyPart = listBodyPart.get(2);

                String filename = filenameBodyPart.getEntityAs(String.class);
                String fileLength = fileLengthBodyPart
                        .getEntityAs(String.class);
                File streamedFile = fileBodyPart.getEntityAs(File.class);

                BufferedInputStream objBufferedInputStream = new BufferedInputStream(
                        new FileInputStream(streamedFile));

                byte[] bytes = new byte[objBufferedInputStream.available()];

                objBufferedInputStream.read(bytes);

                String outFileName = "D:/"
                        + filename;
                System.out.println("File name is : " + filename
                        + " and length is : " + fileLength);
                FileOutputStream objFileOutputStream = new FileOutputStream(
                        outFileName);
                objFileOutputStream.write(bytes);
                objFileOutputStream.close();
                objBufferedInputStream.close();
                File receivedFile = new File(outFileName);
                System.out.print("Is the file size is same? :\t");
                System.out.println(Long.parseLong(fileLength) == receivedFile
                        .length());
            }
        } catch (UniformInterfaceException e) {
            e.printStackTrace();
        } catch (ClientHandlerException e) {
            e.printStackTrace();
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }

    }

    public static void main(String... args) {
        new DownloadFileClient();
    }
} 
```

响应客户端的服务：

```
package in.india.service.downloadfiledemo;

import javax.ws.rs.GET;
import javax.ws.rs.Path;
import javax.ws.rs.Produces;
import javax.ws.rs.core.MediaType;
import javax.ws.rs.core.Response;

import com.sun.jersey.multipart.MultiPart;

@Path("downloadfile")
@Produces("multipart/mixed")
public class DownloadFileResource {

    @GET
    public Response getFile() {

        java.io.File objFile = new java.io.File(
                "D:/DanGilbert_2004-480p-en.mp4");
        MultiPart objMultiPart = new MultiPart();
        objMultiPart.type(new MediaType("multipart", "mixed"));
        objMultiPart
                .bodyPart(objFile.getName(), new MediaType("text", "plain"));
        objMultiPart.bodyPart("" + objFile.length(), new MediaType("text",
                "plain"));
        objMultiPart.bodyPart(objFile, new MediaType("multipart", "mixed"));

        return Response.ok(objMultiPart).build();

    }
} 
```

需要 JAR：

```
jersey-bundle-1.14.jar
jersey-multipart-1.14.jar
mimepull.jar 
```

WEB.XML：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
    id="WebApp_ID" version="2.5">
    <display-name>DownloadFileDemo</display-name>
    <servlet>
        <display-name>JAX-RS REST Servlet</display-name>
        <servlet-name>JAX-RS REST Servlet</servlet-name>
        <servlet-class>com.sun.jersey.spi.container.servlet.ServletContainer</servlet-class>
        <init-param>
             <param-name>com.sun.jersey.config.property.packages</param-name> 
             <param-value>in.india.service.downloadfiledemo</param-value>
        </init-param>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>JAX-RS REST Servlet</servlet-name>
        <url-pattern>/services/*</url-pattern>
    </servlet-mapping>
    <welcome-file-list>
        <welcome-file>index.jsp</welcome-file>
    </welcome-file-list>
</web-app> 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-09-02T21:42:27.360

由于您使用的是 JSON，因此我会在通过网络发送之前对其进行 Base64 编码。

如果文件很大，请尝试查看 BSON 或其他更适合二进制传输的格式。

如果文件压缩得好，您也可以在 base64 编码之前压缩文件。

# android - Android：应用内：检查是否已购买商品

> ID：12239871
> 
> 赞同：0
> 
> 时间：2012-09-02T21:26:22.103
> 
> 标签：android, in-app-purchase, in-app-billing

我按照本教程在我的应用程序中实现应用程序内：http: [//blog.blundell-apps.com/simple-inapp-billing-payment/](http://blog.blundell-apps.com/simple-inapp-billing-payment/)

用户现在可以使用应用内系统购买我的商品 (com.myitem)。之后，我在共享偏好中设置用户已购买该商品。

问题是如果用户卸载并重新安装应用程序。所以问题是：如何检查用户是否已经购买了该商品？

我知道我应该在 RESTORE_TRANSACTION 上使用 restore *BillingHelper.restoreTransactionInformation(...)* ......但是在哪里以及如何使用？

我检查了地下城的例子，但似乎很难理解。有一种简单的方法可以做到这一点吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T03:04:11.437

如果您使用托管购买，则使用 RESTORE_TRANSACTION 是唯一的方法。如果您使用未管理的购买，您可以将购买状态存储在您自己的服务器上，但这并不简单。RESTORE_TRANSACTIONS 没有什么复杂的：您只需触发命令，您就会收到与您第一次购买商品时所获得的格式完全相同的交易信息的通知。您应该以完全相同的方式处理它，并且很可能您的应用程序中已经有了相应的代码。对此进行测试有些困难，因为它实际上不适用于测试帐户，并且您需要一个实时应用程序。再次查看*官方*文档以了解其工作原理。

# ruby-on-rails - 无法批量分配受保护的属性：数量

> ID：12239872
> 
> 赞同：0
> 
> 时间：2012-09-02T21:26:43.210
> 
> 标签：ruby-on-rails

我收到此错误：

> 无法批量分配受保护的属性：数量

我在网站上查找了有关此问题的所有主题，但找不到可以回答我的问题的内容。以下是代码片段：

### 产品.rb

```
class Product < ActiveRecord::Base
  attr_accessible :name, :quantities_attributes
  has_many :quantities

  accepts_nested_attributes_for :quantities, :allow_destroy => :true,
  :reject_if => proc { |attrs| attrs.all? { |k, v| v.blank? } } 
```

### 新的.html.erb

```
<% if @was_submitted %>
  <%= form_for(:new_product_array, :url => products_path) do |f| %>
    <% prefix ||= 0 %>
    <% @new_product_array.each do |n| %>
      <% n.quantities.build %>
      <% prefix += 1 %>
      <%= f.fields_for(prefix.to_s ) do |child| %>
        <div class="field">
          <%= child.label :name %><br />
          <%= child.text_field :name%>
        </div>
        <%= render :partial => 'quantities/form',
                   :locals => {:form => child} %>
      <% end %>
    <% end %>
    <div class="actions">
      <%= submit_tag :submit %>
    </div>
  <% end %>
<% else %>
  <%= form_tag new_product_path, :method => 'get' do %>
  <p align=center>
    How many Items are you Adding? (1-100)
    <%= number_field_tag 'amount', 1, :in => 1...100 %>
    </br>
    To which storage?
    <%= number_field_tag 'storage', 1, :in => 1...100 %>
    <%= submit_tag "Next", :name => 'submitted' %>
  </p>
  <% end %>
<% end %>
<%= link_to 'Back', products_path %> 
```

### product_controller.rb

```
def new
  @product = Product.new

  if params['submitted'] 
    @was_submitted = true
    @amount_form = params['amount']
    @new_product_array = []
    (1..@amount_form.to_i).each do
      @new_product_array << Product.new
    end
    @storage_form = params['storage']
  else
    @was_submitted = false
  end

  respond_to do |format|
    format.html # new.html.erb
    format.json { render :json => @product }
  end
end

def create
  i=0
  logger.info params[:new_product_array].inspect
  params[:new_product_array].each do |new_product|
    if new_product.last[:name] != nil
      @new_product_array[i] = Product.new(new_product.last)
      @new_product_array[i].save
      i+=1
    end
  end
  redirect_to(products_path)
end 
```

### 数量.rb

```
class Quantity < ActiveRecord::Base
  belongs_to :product
  attr_accessible :amount, :storage
end 
```

### 数量/_form.html.erb

```
<%= form.fields_for :quantities do |quant| %>
  <div class="field">
    <%= quant.label :storage %><br />
    <%= quant.number_field :storage %>
  </div>
  <div class="field">
    <%= quant.label :amount %><br />
    <%= quant.number_field :amount %>
  </div>
  <% unless quant.object.nil? || quant.object.new_record? %>
    <div class="field">
      <%= quant.label :_destroy, 'Remove:' %>
      <%= quant.check_box :_destroy %>
    </div>
  <% end %>
<% end %> 
```

总的来说，我想做的是询问用户要添加多少产品，然后使用用户指定的字段数制作一个表单，并使用一个提交按钮添加所有产品，而当您添加产品时，您还添加了一个数量记录，其中包含有关产品的更多信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T21:32:57.410

你需要这样的一行：

```
attr_accessible :name, :quantities_attributes, :quantities 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T21:51:27.727

你的代码很糟糕，它可以简单得多 100%。

您的问题是表单对您的资源（产品）一无所知，因此它无法“智能”呈现“quantities_attributes”字段，而是呈现“quantities”。

# html - 如何扩展我的 适当地适应更多的垂直内容？

> ID：12239873
> 
> 赞同：0
> 
> 时间：2012-09-02T21:26:44.273
> 
> 标签：html, css

每当我尝试添加`margin-top: 30px`到我的`box_1`and`box_2` `<div>`时，我的底部`<div>`都会被推下并消失。似乎我的包装器不会扩展以适应内容。

如何在`top` *and* `box_1/2` *和* `bottom`之间获得 30px 的间隙？

```
<html>

<head>
    <title>Circle Motion</title>
    <link rel="stylesheet" type="text/css" href="styles.css" />
</head>

<body> 
    <div id="outer-wrapper">
        <div id="wrapper">

            <div id="top">  
            </div>

            <div id="box_1">
            <img src="chrome_400x400.png" />
            </div>

            <div id="box_2">
            <img src="firefox_400x400.png" />
            </div>

            <div id="bottom">
            <p>All Rights Reserved - CSS_maniac 2012 ©</p>
            </div>

        </div>
    </div>
</body>

</html> 
```

CSS

```
/* My CSS */

html {
    height: 100%
}

body {
    background-color: grey;
    }

#outer-wrapper {
    height: 100%;
    width: 1000px;
    margin: 0px auto;
    background-color: #EAFFDB;
    -moz-border-radius: 15px;
    border-radius: 15px;
}

#wrapper {
    height: 100%;
    width: 960px;
    margin: 0px auto;
    background-color: #EAFFDB;
    overflow: hidden;
}

#top {
    width: 900px;
    height: 110px;
    margin-top: 35px;
    margin-left: 30px;
    margin-right: 30px;
    background-color: white;
    -moz-border-radius: 15px;
    border-radius: 15px;
}

#box_1 {
    width: 430px;
    height: 430px;
    background-color: white;
    -moz-border-radius: 15px;
    border-radius: 15px;
    float:left;
    margin-left: 30px;
    text-align: center;
}

#box_2 {
    width: 430px;
    height: 430px;
    background-color: white;
    -moz-border-radius: 15px;
    border-radius: 15px;
    float:right;
    margin-right: 30px;
    text-align: center;
}       

#box_1 img {
    margin: 15px 0px;
}

#box_2 img {
    margin: 15px 0px;
}

#bottom {
    width: 900px;
    margin: 0px auto 0px auto;
    text-align: center;
    background-color: white;
    -moz-border-radius: 15px;
    border-radius: 15px;
    clear:both;
}

/* Classes */

.clear {
    clear: both;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T21:36:00.063

我已经为您稍微调整了您的代码：

[http://jsfiddle.net/83RZc/](http://jsfiddle.net/83RZc/)

# mongodb-query - mongodb dbref java

> ID：12239875
> 
> 赞同：0
> 
> 时间：2012-09-02T21:26:49.483
> 
> 标签：mongodb-query, mongodb

我是 mpngodb 的新手。

我有两个系列。

```
 Tenant
 {
 Tenant_ID:123, Tenant_Info:new
 Tenant_ID:456, Tenant_Info:old
 }

 System
 {
  System_ID:768, Tenant_ID:123,System_Info:"check"
 } 
```

我需要使用系统集合 Tenant_ID 引用租户集合 Tenant_ID。

任何人都可以帮助我使用 mongodb 的 DBREF java 代码来实现这种关系吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T06:15:13.947

[数据库引用（DBRefs）](http://docs.mongodb.org/manual/applications/database-references/)按惯例使用；它们与 MongoDB 服务器中支持的功能不对应。

如果您想在文档中存储对另一个集合的引用，您可以通过以下几种方式进行：

1）只需保存其他集合的相关键（在您的示例`Tenant_ID`中，相关租户文档的希望保存为 System 集合中文档中的字段）。

2）使用[DBRef类](http://api.mongodb.org/java/current/com/mongodb/DBRef.html)构造对象的引用然后[fetch()](http://api.mongodb.org/java/current/com/mongodb/DBRef.html#fetch(com.mongodb.DB) , com.mongodb.DBObject)) 引用的对象。

根据您的示例，第一次使用似乎更相关 - 您似乎正在将`Tenant_ID`字段保存在`System`文档中。在这种情况下，您可以加载一个 System 文档并使用[findOne()](http://api.mongodb.org/java/current/com/mongodb/DBCollection.html#findOne%28com.mongodb.DBObject%29)根据 Tenant_ID 检索相关的租户文档（假设 Tenant_ID 唯一标识一个租户）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-18T05:17:32.710

看看[Spring Data MongoDB](http://projects.spring.io/spring-data-mongodb/)。

# c - 将四边形转换为三角形条带的最快方法？

> ID：12239876
> 
> 赞同：1
> 
> 时间：2012-09-02T21:27:17.107
> 
> 标签：c, algorithm, geometry, triangulation

将四边形（由四个`x,y`点组成）转换为三角形条带的最快方法是什么？我很清楚现有的一般三角测量算法，但我需要一个简短的、**优化好的**算法，只处理四边形。

我目前的算法是这样做的，它适用于**大多数**四边形，但仍然会混淆一些点：

```
#define fp(f) bounds.p##f

/* Sort four points in ascending order by their Y values */
point_sort4_y(&fp(1), &fp(2), &fp(3), &fp(4));

/* Bottom two */
if (fminf(-fp(1).x, -fp(2).x) == -fp(2).x)
{
    out_quad.p1 = fp(2);
    out_quad.p2 = fp(1);
}
else
{
    out_quad.p1 = fp(1);
    out_quad.p2 = fp(2);
}

/* Top two */
if (fminf(-fp(3).x, -fp(4).x) == -fp(3).x)
{
    out_quad.p3 = fp(3);
    out_quad.p4 = fp(4);
}
else
{
    out_quad.p3 = fp(4);
    out_quad.p4 = fp(3);
} 
```

**编辑：**我问的是如何将**单个**四边形转换为应由四个点组成的单个三角形条带。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T09:18:21.020

1.  用坐标定位四边形的极值点。顺其自然，循环容器上的迭代器在`p`哪里`p`
2.  检查是否`p + 2`位于由`{p - 1, p, p + 1}`. 如果是，则寻找其他坐标的极值（或从`min`到`max`，反之亦然）并重复步骤 1。
3.  通过切断极值点周围的“耳朵”将四边形分成两个三角形： `t0 = { p - 1, p, p + 1}`和 `t1 = { p + 1, p + 2, p - 1 }`

无需排序，只需找到极值即可。如果保证您的四边形是凸的（实四边形），则跳过极值搜索并选择任意`p`。

编辑：根据评论中的建议进行了修改。评论者建议的公式也更容易实现：

1.  给定一个四边形`A, B, C, D`的对角线 `AC`和`BD`
2.  如果点`B`和`D`位于`AC`then的不同边`AC`可以用来分割四边形
3.  对和`BD`点应用相同的推理`A``C`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T08:41:07.093

Given a quad `A B C D` we can split it into `A B C, A C D` or `A B D, D B C`.

Compare the length of `A-C` and `B-D` and use the shorter for the splitting edge. In other words use `A B C, A C D` if `A-C` is shorter and `A B D, D B C` otherwise.

# oracle10g - 为什么我们需要在 cognos/hibernate 而不是在 oracle 中指定基数

> ID：12239877
> 
> 赞同：1
> 
> 时间：2012-09-02T21:27:17.813
> 
> 标签：oracle10g, cardinality, cognos-8

在oracle中指定外键关系时，不需要说关系是1对1、1对多等。但是在cognos框架管理器中指定关系时，为什么要指定1对1、1对许多等？此外，不相关但只是好奇，像 Hibernate 这样的 ORM 工具中的行为也是如此。该规范仅用于优化目的吗？

我的另一个问题是指定错误的基数关系有什么影响？即，我指定了一个 1 对 1 的关系，实际上它是一对多的。我冒的风险是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T03:06:10.097

您*确实*在 Oracle 中声明了关系，关系的性质隐含在向 Oracle 声明的方式中，例如：

```
CONSTRAINT fk FOREIGN KEY (id) REFERENCES parent_table (id) 
```

表示父表与本表存在1:M关系。

此外，如果子表上存在唯一约束，例如：

```
CONSTRAINT uk UNIQUE (id) 
```

意味着关系是 1:1。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T19:10:14.253

来自 Cognos 文档：

IBM® Cognos® 软件通过以下方式使用关系的基数：

避免重复计算事实数据
支持星型模式模型中常见的循环连接
优化对底层数据源系统
的访问 识别表现为事实或维度的查询主题

有关更多详细信息，请查看此处： [Framework Manager Cardinality](http://publib.boulder.ibm.com/infocenter/cbi/v10r1m1/topic/com.ibm.swg.ba.cognos.ug_best.10.1.1.doc/c_bp-cardinality.html#bp-cardinality)

# wpf - WPF UserControl 不更新内容

> ID：12239878
> 
> 赞同：0
> 
> 时间：2012-09-02T21:27:35.553
> 
> 标签：wpf, user-controls, mahapps.metro

我创建了一个窗口并使用 MahApps 对其进行了样式化，我还创建了一个用户控件。在我的 UserControl 中，我创建了一个在 UserControl 元素中填充一些数据的方法。

在我的窗口中，我创建了一个执行以下操作的按钮：

```
EdicaoFisioterapeuta ed = new EdicaoFisioterapeuta();
ed.LoadContents("My Text"); 
```

当我调试代码时，我看到用户控件的元素被填充，这里是代码：

```
public void LoadContents(string text)
{
    textBox1.Text = text;
    lbl.Text = text;
} 
```

完成所有工作后，textBox1 和 lbl 没有得到内容“我的文本”。

我创建了另一个项目并重复了这个过程，在新项目中一切正常。

在我的“旧”项目中，我删除了 MahApps，但没有生效。

我知道，这很简单，但我找不到解决这个问题的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T21:29:16.193

哦，伙计，我设置错了班级，看来我需要多睡一会儿。

# ruby-on-rails-3 - 迁移后 Rails 种子数据未正确加载

> ID：12239880
> 
> 赞同：0
> 
> 时间：2012-09-02T21:28:04.767
> 
> 标签：ruby-on-rails-3, csv, seed

我使用下面的代码加载了一些种子数据，它运行良好。然后，我需要再添加两列，我使用以下步骤完成了此操作，但它没有将两个新列种子数据附加到表中，我做错了什么？

脚步：

1.  使用迁移添加两列
2.  使它们在模型中可访问
3.  用新的 CSV 文件替换旧的 CSV 文件
4.  更改 seed.rb 文件以插入新数据
5.  运行 rake db:seed

种子.rb

```
require 'csv'

Model.delete_all
CSV.foreach("#{Rails.root}/lib/data/model.csv") do |row|
   Model.create!(:model_number => row[0], :areq => row[1], :length => row[2], :width => row[3], :depth => row[4], :material => row[5], :frame => row[6], :edge => row[7], :tubes => row[8], :tube_length => row[9])
end 
```

架构.rb

```
create_table "models", :force => true do |t|
  t.string   "model_number"
  t.float    "areq"
  t.float    "length"
  t.float    "width"
  t.float    "depth"
  t.string   "material"
  t.string   "frame"
  t.float    "edge"
  t.datetime "created_at",   :null => false
  t.datetime "updated_at",   :null => false
  t.float    "tubes"
  t.float    "tube_length"
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T22:07:14.063

不能说这可能 100% 有效

在种子`Model.reset_column_information`文件上面试一次

这应该刷新表中的列信息。

```
require 'csv'

Model.reset_column_information

Model.delete_all
#...... 
```

只是猜测检查是否加载了正确的 model.csv 并且第 8 列和第 9 列意味着在所有 10 列中都有。

# google-maps - 如何使用谷歌地图以路线和河流为边界创建多边形

> ID：12239881
> 
> 赞同：0
> 
> 时间：2012-09-02T21:28:31.053
> 
> 标签：google-maps

我想开发一个专为移动设备设计的网络应用程序，只显示一些区域。这些区域的边界由路线和河流组成。我手头没有路线和河流的数据，我想使用谷歌地图提供的数据。

如果谷歌地图不可行，请给我一些提示或其他方法来实现这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T21:39:37.077

禁止从googlemap中提取数据。阅读条款和协议。大多数数据甚至不属于谷歌，而是由将其出租给谷歌的 GIS 公司所有。使用 Google API 甚至无法获取这些数据。谷歌只是提供图块作为位图。

这就是说，这并不难做到，只需查询除了道路和河流之外一切都是白色的自定义图块。然后解析它们。[http://gmaps-samples-v3.googlecode.com/svn/trunk/styledmaps/wizard/index.html](http://gmaps-samples-v3.googlecode.com/svn/trunk/styledmaps/wizard/index.html)

还有另一种解决方案，开源地图数据库：[http ://www.openstreetmap.org/](http://www.openstreetmap.org/)

# winforms - 如何访问行以访问 XtraGrid CardView DevExpress 中的记录

> ID：12239882
> 
> 赞同：2
> 
> 时间：2012-09-02T21:28:34.460
> 
> 标签：winforms, devexpress, xtragrid

我有一个设置了主从关系的网格控件，但是我想知道如何访问详细视图记录或行以执行编辑或更新信息。我已经尝试过了，但它不起作用，它返回 0 到表单：

```
void AddPayment_Click(object sender, EventArgs e) {
    Paymentfrm payent = new Paymentfrm(Utils.Formtype.add, 0);
    payent.PaymentEvent += new EventHandler(RefreshingGrid);
    payent.PayentlabelsEvent += new EventHandler(RefresHlabels);

    gridView1.ViewCaption = " Lessee Payment ";
    CardView card = new CardView(DgPaymentYW);
    DgPaymentYW.LevelTree.Nodes.Add("LesseePayments", card);

    card.ViewCaption = " Lessee Payments";
    GetPayment.TotalPrice = Convert.ToDecimal(card.GetFocusedRowCellValue("TotalPrice"));

    payent.ShowDialog();
} 
```

# c# - 使用 C# 更改 XAML 对象的边距

> ID：12239883
> 
> 赞同：0
> 
> 时间：2012-09-02T21:28:43.257
> 
> 标签：c#, xaml, visual-studio-2012

需要帮助解决这个问题。

我在 MainPage.xaml 中初始化一个文本框

```
<TextBox 
    x:Name="box"
    HorizontalAlignment="Left"
    TextWrapping="NoWrap"
    Text="TextBox"
    VerticalAlignment="Center"
    RenderTransformOrigin="1.332,-26.438"
    Height="23" Width="1366"
    HorizontalContentAlignment="Left">
</TextBox> 
```

然后我尝试更改 MainPage.xaml.cs 中的边距：

`box.Margin = new Thickness(0,grid.Height - 23,0,0);`

这是运行时错误

```
An exception of type 'System.Runtime.InteropServices.COMException'
occurred in Console.exe but was not handled in user code

Additional information: Error HRESULT E_FAIL has been returned from
a call to a COM component. 
```

这是显示边距更改代码和错误的图像： http: [//screencast.com/t/U7pzizHzb](http://screencast.com/t/U7pzizHzb)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T02:51:36.510

好像你让这个过于复杂。您设置的边距将导致 TextBox 底部对齐并强制为 23 像素高。那么，为什么不一开始就这样做呢？

```
<TextBox ... Height="23" VerticalAlignment="Bottom" /> 
```

我不是 100% 确定是什么导致了您的 COM 错误，但我的第一个猜测是您的“手动更改边距”代码是在 UI 框架尚未准备好进行此类更改的时间点运行的。（我发现 WinRT 在这种情况下非常脆弱。）因此删除代码隐藏并在 XAML 中指定您的布局可能会修复您的 COM 错误，并使您的代码更简单和更易于维护。

# java - Java SwingUtilities.invokeLater 更新 TextArea

> ID：12239884
> 
> 赞同：3
> 
> 时间：2012-09-02T21:28:50.903
> 
> 标签：java, multithreading, swing, event-dispatch-thread, invokelater

我有以下课程：

*   主服务器
*   TCP服务器
*   UDP服务器

我从 MainServer 类创建 TCPServer 和 UDPServer 类的新实例（开始），我的 GUI 在其中初始化。在这个 GUI 中，我有一个**textArea**，TCP 或 UDP 类需要更新它以显示日志信息（错误、状态等）。我做了一些搜索，我知道我可能需要在 MainServer 中使用 EDT，但不知道如何从 TCPServer 或 UDPServer 访问 MainServer 类中的这个对象。现在我只能打印到控制台，这是不可取的。如何从 TCPServer 访问 MainServer.printlog？或 Mainserver.textArea 对象？如果我从 TCPServer 或 UDPServer 创建一个新的 MainServer 实例，这似乎不起作用。

这是我在 MainServer 类中的函数：

```
public void printLog (final String log, final int level) {

    SwingUtilities.invokeLater(
    new Runnable() 
    {
        public void run() 
        {
        if (level == 1) 
            textArea.append("INFO\t" + log);
        if (level == 2)
            textArea.append("WARN\t" + log);
        if (level == 3)
            textArea.append("ERROR\t" + log);
        }
    }
    );
} 
```

编辑：我试图创建一个新的实例`MainServer`并访问`printLog`，但我得到：

```
线程“AWT-EventQueue-0”中的异常 java.lang.NullPointerException
    在 MultithreadedBarcodeReader.MultithreadedBarcodeReaderServer$2.run(
        多线程BarcodeReaderServer.java:68)
    在 java.awt.event.InvocationEvent.dispatch(InvocationEvent.java:209)
    在 java.awt.EventQueue.dispatchEventImpl(EventQueue.java:682)
    在 java.awt.EventQueue.access$000(EventQueue.java:85)
    在 java.awt.EventQueue$1.run(EventQueue.java:643)
    在 java.awt.EventQueue$1.run(EventQueue.java:641)

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T01:07:39.060

出现`NullPointerException`在第 68 行嵌套在 中的匿名类中`MultithreadedBarcodeReaderServer`，大概是`Runnable`被引用的。有人可能会猜测， as没有`textArea`被取消引用并且是原始的。您需要在调试器中的该行附近中断才能确定。还要验证您的 GUI 组件是否*仅*在[事件调度线程](http://download.oracle.com/javase/tutorial/uiswing/concurrency/initial.html)上构建和操作。`null``log``level`

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T07:19:09.480

考虑使用一个单独的日志框架，或者至少一个带有静态方法的单独的日志类（或者一个带有静态方法的日志工厂）。对于您的应用程序，它们是否登录到控制台、a、... 都无关紧要`JTextArea`，而且您当然不想`MainServer`仅出于记录目的而传递实例。

Then your application can simply 'log' those messages, and if you want to display those on a certain `JTextArea`, you can simply add a handler which does exactly this. This handler can then be created in the same location as where you create the actual `JTextArea`, and of course can `append` the log messages on the Event Dispatch Thread.

Other advantages of using a decent logging framework are that you can activate the logging on a per-class basis, configure the logging level on a per-class basis, ... and all that without making any changes to your code. So this allows to gather "debug-information" from a deployed application (perhaps even information you do not want to appear in the `JTextArea` but you want to know to diagnostic a problem).*

# android - 如何从 Gallery 迁移到 Horizo ntalScrollView & ViewPager？

> ID：12239886
> 
> 赞同：12
> 
> 时间：2012-09-02T21:29:01.667
> 
> 标签：android, gallery, android-viewpager, horizontalscrollview, migrate

我需要在 Android 2.2 及更高版本上简单控制图标选择。
Gallery 对我来说是一个更好的解决方案，但它已被弃用，我必须使用`HorizontalScrollView`and`ViewPager`代替。
但是如何轻松迁移？在这种情况下如何使用这些类和控件？我试图找到这个主题的完整示例，但我找不到它。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-09-02T22:49:51.970

[Dave Smith 的这个要点](https://gist.github.com/8cbe094bb7a783e37ad1)展示了一种使用方法`ViewPager`来获得与 a 非常相似的视觉结果`Gallery`：

![画廊风格的 ViewPager](../Images/07a86f0d71d56054ca6faac750a1e0a7.png)

引用我关于在 a 中一次显示多个页面[的主题的博客文章](http://commonsware.com/blog/2012/08/20/multiple-view-viewpager-options.html)`ViewPager`：

> 他的容器 ( `com.example.pagercontainer.PagerContainer`) 包装了`ViewPager`并调用`setClipChildren(false);`自身，因此即使`ViewPager`聚焦在一个选定的页面上，其他坐标超出`ViewPager`边界的页面仍然可见，只要它们适合`PagerContainer`. 通过将 的大小设置`ViewPager`为小于`PagerContainer`，`ViewPager`可以将其页面调整为该大小，从而为其他页面留出空间。`PagerContainer`但是，需要在触摸事件方面提供一些帮助，因为`ViewPager`它只会在其自己的可见边界上处理滑动事件，而忽略任何侧面可见的页面。

您可能还想筛选[这个 android-developers thread](https://groups.google.com/forum/?fromgroups=#!topic/android-developers/RIERxUcGpQg)，有人在较新的 Android 版本上指出了这个问题。由于. [_`ViewPager`](http://code.google.com/p/android/issues/detail?id=36788)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-01-06T11:32:17.090

在 CommonsWare 的链接解决方法中，触摸处理和硬件加速存在各种问题。在我看来，一个更简单、更优雅的解决方案是为 ViewPager 指定一个负边距：

```
ViewPager.setPageMargin(
    getResources().getDimensionPixelOffset(R.dimen.viewpager_margin)); 
```

然后我在我的`dimens.xml`：

```
<dimen name="viewpager_margin">-64dp</dimen> 
```

为了补偿重叠页面，每个页面的内容视图都有相反的边距：

```
android:layout_marginLeft="@dimen/viewpager_margin_fix"
android:layout_marginRight="@dimen/viewpager_margin_fix" 
```

再次在`dimens.xml`：

```
<dimen name="viewpager_margin_fix">32dp</dimen> 
```

（请注意，`viewpager_margin_fix`尺寸是绝对`viewpager_margin`尺寸的一半。）

我们[在荷兰报纸应用程序*De Telegraaf Krant*](https://play.google.com/store/apps/details?id=com.trab.news)中实现了这一点：

![De Telegraaf Krant 中的电话示例](../Images/da3cf1eae218d4c810622ce206ab099a.png)![平板电脑示例](../Images/b9887be664931b565871356eea12d3ac.png)

# java - 如果用户关闭单独的窗口，为什么我的应用程序会终止？

> ID：12239887
> 
> 赞同：3
> 
> 时间：2012-09-02T21:29:08.250
> 
> 标签：java, swing, user-interface, jtable, windowlistener

我有一个简单的 GUI 程序，它可以`JTable`在某个时间点创建一个新窗口（其中包含一个 ）。如果用户关闭`JTable`，主应用程序也会关闭。我该如何防止这种情况？它是否与它如何处理窗口关闭有关，或者我应该给它自己的线程，还是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-02T21:31:29.703

`JFrame`为您的:`HIDE_ON_CLOSE`或设置这些关闭操作之一`DISPOSE_ON_CLOSE`。您正在使用`EXIT_ON_CLOSE`. [这](http://docs.oracle.com/javase/6/docs/api/javax/swing/JFrame.html#setDefaultCloseOperation%28int%29)是您可以使用的 JavaDoc 方法的链接。

# javascript - 替换字符串的脚本在某些网站上不起作用

> ID：12239891
> 
> 赞同：0
> 
> 时间：2012-09-02T21:29:29.943
> 
> 标签：javascript, jquery, google-chrome-extension

我创建了一个简单的 Chrome 扩展程序，它使用正则表达式查找某些字符串并用预定义的文本替换匹配项。它在大多数网站上运行良好，但不知何故，该脚本不会在 Lifehacker 上生效（如此页面[http://lifehacker.com/5939740/five-best-audio-editing-applications?popular=true](http://lifehacker.com/5939740/five-best-audio-editing-applications?popular=true)） . 代码是：

```
$('p, h1, h2, h3, span, .content, .post-body').each(function(){
        //do something with $(this)
}); 
```

任何想法为什么 Lifehacker 的网站对我的脚本有抵抗力？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T21:36:09.733

将您的脚本更改为以下内容：

```
(function($){
  $('p, h1, h2, h3, span, .content, .post-body').each(function(){
     console.log($(this));
  });
})(jQuery); 
```

在他们的网站`$`上不用作 jQuery 对象的别名。上面的代码就像一个自动执行的匿名函数，它将他们的 jQuery 对象作为参数并将其视为`$`. 或者，您可以将`$`代码中的所有 ' 替换为`jQuery`.

**UPD**：同样在您的扩展程序中，我将首先检查`jQuery`页面上是否存在/加载对象并使用`jQuery`而不是`$`，因为`$`其他 JavaScript 库（如 mootools）可能会使用该对象。

# function - 在 lua、corona sdk 中定义函数时出错

> ID：12239895
> 
> 赞同：0
> 
> 时间：2012-09-02T21:30:21.947
> 
> 标签：function, sdk, lua, coronasdk

请帮助我找出代码中的问题。我正在定义一个函数

```
local function goOnLesson()
   if date.hour==1  then
   index=1
   local subj=schToday[index]
   local text = display.newRetinaText("А сейчас у тебя: "..subj, 0, 0, native.systemFont, 70)
   text:setTextColor(128,64,0)
   text:setReferencePoint(display.CenterReferencePoint)
   localGroup:insert(text)
   end
end 
```

当我运行它时，一切都很好。

我重新组织了代码，不再需要 if 阻塞

```
local function goOnLesson()
   index=1
   local subj=schToday[index]
   local text = display.newRetinaText("А сейчас у тебя: "..subj, 0, 0, native.systemFont, 70)
   text:setTextColor(128,64,0)
   text:setReferencePoint(display.CenterReferencePoint)
   localGroup:insert(text)
end 
```

我刚刚删除了 if-end 块，但现在它不起作用。请帮忙 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T23:12:38.370

当 Corona 事件执行期间出现运行时错误时，此错误似乎是一般消息。我发现了几个对同一问题的引用（例如，[here](http://developer.coronalabs.com/forum/2011/12/13/director-errorfailed-execute-newparams-function-menu-where-my-object)）。

schToday 可能没有任何元素，并且您的`subj`变量获得 nil 值，然后在字符串连接时失败。您的原始代码可能“有效”，因为它没有进入该部分（您的`day.hour == 1`条件大多数时候返回“false”）。

我建议您仔细检查您的代码，以确保它按预期工作。

要尝试的另一件事是本地化您的`index`变量。您可能为它分配了一个值，这会破坏程序其他部分的某些内容。

# jquery - 开始输入后，带有“X”图标的文本输入会清除该字段

> ID：12239901
> 
> 赞同：2
> 
> 时间：2012-09-02T21:31:34.187
> 
> 标签：jquery, jquery-mobile

搜索输入采用药丸形角设计，并在您开始输入后添加一个“x”图标以清除该字段。

我可以对常规文本框做同样的事情吗？请参阅小提琴：http: [//jsfiddle.net/nvWnx/1/](http://jsfiddle.net/nvWnx/1/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T21:58:02.313

只需添加`data-type="search"`到文本输入，它就会收到与搜索框相同的样式，但也会包括放大镜，这里有一些选项：

[**小提琴**](http://jsfiddle.net/nvWnx/9/)

稍微摆弄了一下，想出了这个：

[**小提琴2**](http://jsfiddle.net/nvWnx/12/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T21:35:39.377

您可以使用`val()`方法来清除*常规*输入的值。

```
$('#X').click(function(){
   $(this).prev().val("").focus();
   // $(this).remove()
}) 
```

[http://jsfiddle.net/nvWnx/3/](http://jsfiddle.net/nvWnx/3/)

*   [值（）](http://api.jquery.com/val/)
*   [上一个（）](http://api.jquery.com/prev/)
*   [重点（）](http://api.jquery.com/focus/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-02T22:00:14.820

将其包装在插件中：

```
(function($) {
    $.fn.addClearButton = function(width) {
        if (typeof width === 'undefined') width = '50%';
        this.wrap('<div class="ui-input-search ui-shadow-inset ui-btn-corner-all ui-btn-shadow ui-icon-searchfield ui-body-c"></div>').bind('input keyup', function() {
            $(this).next().css('display', ($(this).val() !== '') ? 'inline-block' : 'none');
        }).parent().css({backgroundSize: '0 0', paddingLeft: 10, width: width}).append($('<a title="clear text" class="ui-input-clear ui-btn ui-btn-up-c ui-btn-icon-notext ui-btn-corner-all ui-shadow" href="#" data-theme="c"><span class="ui-btn-inner ui-btn-corner-all"><span class="ui-btn-text">clear text</span><span class="ui-icon ui-icon-delete ui-icon-shadow"></span></span></a>').click(function() {
            $(this).hide().prev().val('').focus();
        }));
    };
})(jQuery);

//the width parameter is optional.
$('#basic').addClearButton(200);
//integers are treated as px, can accept % and em between quotes too e.g. '77%' 
```

[**小提琴**](http://jsfiddle.net/ult_combo/nvWnx/18/)

请注意，它将模仿 Search 按钮的标记，即将输入包装在 a`div`中以将 X 按钮浮动在输入的右侧。

如果您将 jQuery 从 1.6.2 升级到 1.7+，请将`.bind`.`.on`

编辑删除搜索图标。

添加了可选的宽度参数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-11-21T14:25:04.790

你可以尝试这样的事情：

```
(function($, undefined) {
  $.fn.clearable = function() {
    var $this = this;
    $this.wrap('<div class="clear-holder" />');
    var helper = $('<span class="clear-helper">&times;</span>');
    $this.parent().append(helper);
    $this.parent().on('keyup', function() {
      if ($this.val()) {
        helper.show();
        helper.css('display', 'inline-block');
      } else helper.hide();
    });
    helper.click(function() {
      $this.val("");
      helper.hide();
    });
    $this.on('focus', function() {
      helper.show();
    });
  };
})(jQuery);

  $('#myInput').clearable();
```

```
.clear-holder{
    position:relative;
    float:left;  
}
.clear-helper{
    margin-top:4px;
    text-align:center;
    position:absolute;
    right:4px;
    height:16px;
    width:16px;
    font-size:13px;
    cursor: pointer;
    display:none;
    background:#e0e0e0;
    border-radius:16px;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<input id="myInput" type="text"/>
```

# objective-c - 无法将文件保存到磁盘，不知道为什么

> ID：12239902
> 
> 赞同：2
> 
> 时间：2012-09-02T21:31:37.673
> 
> 标签：objective-c, cocoa, osx-mountain-lion, nsmutablestring

我正在尝试将字符串写入磁盘：

```
return [fileContent writeToFile:path atomically:YES encoding:NSUnicodeStringEncoding error:error]; 
```

但它总是失败并出现以下错误：

```
Error Domain=NSCocoaErrorDomain Code=4 "The folder “ddd.csv” doesn’t exist." UserInfo=0xc4a08b0 {NSUnderlyingError=0xc49ba60 "The operation couldn’t be completed. No such file or directory", NSFilePath=file://<path to file>, NSUserStringVariant=Folder} 
```

文件的路径似乎是有效的（我在这里遮盖了它）并且字符串 (NSMutableString) 绝对不是 0 长度。此代码曾经在 Mountain Lion 之前工作。任何人都可以帮助阐明可能发生的事情吗？

**编辑：** 值为`path`：`file://localhost/Users/cocoaster/Downloads/ddd.csv`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T21:47:49.107

由于您使用的是保存面板，因此结果会以 URL 的形式返回，因此如果您需要路径，请使用 path 命令将结果转换为路径：[url path]。

或者，您可以使用 writeToURL:atomically: 如果该版本可用于任何类 fileContent 。

# python - 依赖于先前匹配的正则表达式

> ID：12239903
> 
> 赞同：3
> 
> 时间：2012-09-02T21:31:47.410
> 
> 标签：python, regex

例如，我们如何使用单个 RE 识别以下格式的字符串：

```
LenOfStr:Str 
```

这种格式的示例字符串是：

```
5:5:str 
```

我们要查找的字符串是“5:str”。

在 python 中，可能类似于以下内容（这不起作用）：

```
r'(?P<len>\d+):(?P<str>.{int((?P=len))})' 
```

一般来说，有没有办法在使用之前更改以前匹配的组，或者我只是问了另一个不适合 RE 的问题。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T21:38:10.810

是的，您所描述的超出了正则表达式的范围。正则表达式只处理实际的字符数据。这提供了一些有限的根据上下文进行匹配的能力（例如，`(.)\1`匹配相同的字符两次），但是您不能将任意函数应用于正在进行的匹配的片段并稍后在相同的匹配中使用结果。

您可以执行诸如搜索与 regex 匹配的文本之类的操作`(\d+):\w+`，然后对结果进行后处理以检查字符串长度是否等于匹配第一部分的 int 值。但是您不能将其作为匹配过程本身的一部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T23:31:19.470

那么这*可以*用正则表达式来完成（如果我理解这个问题）：

```
>>> s='5:5:str and some more characters...'
>>> m=re.search(r'^(\d+):(.*)$',s)
>>> m.group(2)[0:int(m.group(1))]
'5:str' 
```

只是不能通过动态更改前一个匹配组来完成。

你可以让它*像*一个单一的正则表达式一样像这样：

```
>>> re.sub(r'^(\d+):(.*)$',lambda m: m.group(2)[0:int(m.group(1))],s)
'5:str' 
```

# mysql - mysql根据两个表之间的公共列获取表

> ID：12239909
> 
> 赞同：1
> 
> 时间：2012-09-02T21:32:57.173
> 
> 标签：mysql, sql

在尝试学习 sql 时，我遇到了“Learn SQL The Hard Way”并开始阅读它。一切都很顺利，然后我想，作为一种练习方式，做一些像书中给出的例子（例子包括 3 个表 pet、person、person_pet 和 person_pet 表将宠物“链接”到它们的主人）。

我做的：

```
report table
+----+-------------+
| id | content     |
+----+-------------+
|  1 | bank robbery|
|  2 | invalid     |
|  3 | cat on tree |
+----+-------------+
notes table
+-----------+--------------------+
| report_id | content            |
+-----------+--------------------+
|  1        | they had guns      |
|  3        | cat was saved      |
+-----------+--------------------+

wanted result
+-----------+--------------------+---------------+
| report_id | report_content     | report_notes  |
+-----------+--------------------+---------------+
|  1        | bank robbery       | they had guns |
|  2        | invalid            | null or ''    |
|  3        | cat on tree        | cat was saved |
+-----------+--------------------+---------------+ 
```

我尝试了一些组合但没有成功。

我的第一个想法是

```
SELECT report.id,report.content AS report_content,note.content AS note_content
FROM report,note
WHERE report.id = note.report_id 
```

但这只会返回匹配的那些（不会返回无效的报告）。在此之后我尝试添加 IF 条件，但我只是让它变得更糟。

我的问题是，这是我在通过基本 sql 后会弄清楚的事情，还是可以用简单的方式完成？

无论如何，我将不胜感激任何帮助，我对此几乎迷失了。

谢谢你。

编辑：我已经研究了相关问题，但还没有找到解决我的问题的问题。我可能需要查看其他语句，例如 join 或其他东西来解决这个问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T21:36:18.173

您需要阅读关于 的章节`OUTER JOINS`，具体来说，`LEFT JOIN`

```
SELECT report.id,report.content AS report_content,note.content AS note_content 
FROM report
    LEFT JOIN note ON report.id = note.report_id 
```

注意 ANSI-92 JOIN 语法，而不是使用`WHERE x=y`

（如果我正确地记得旧语法，您可能可以使用您正在使用的旧语法来做到这一点`WHERE report.id *= note.report_id`，但我建议使用上述语法）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T21:39:06.837

你正在加入。您拥有的连接类型是内部连接，但您需要外部连接：

```
SELECT report.id,report.content AS report_content,note.content AS note_content
FROM report
LEFT JOIN note on report.id = note.report_id 
```

请注意，LEFT 表将提供缺失值。

# image - sencha touch 2 中的图像平移

> ID：12239914
> 
> 赞同：0
> 
> 时间：2012-09-02T21:34:05.070
> 
> 标签：image, scroll, sencha-touch-2

我正在尝试显示用户可以平移的大图像（因此垂直和水平滚动）。但我无法让图像滚动。这就是我所拥有的：

```
Ext.define('myapp.view.image.Floorplan', {

extend: 'Ext.Container',    
requires: 'Ext.Img',
xtype: 'floorplan',

config: {

    title: 'Floorplan',
    iconCls: 'locate',
    items: [
      {
        xtype: 'image',    
        scrollable: true,
        src: './resources/images/floorplan.png',
        height: 1570,
        width: 1047
      }
    ]
} 
```

});

如何使图像可滚动？

谢谢马特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T00:21:40.423

试试这个

```
{
    xtype:'panel',
    scrollable: true,
    items:[
        {
            xtype: 'image',
            src: 'http://www.hdwallpapersarena.com/wp-content/uploads/2012/07/0000037-2650.jpg',
            height: 1570,
            width: 2047
        }
    ]
} 
```

图像小部件没有可滚动的属性。

# c# - 创建泛型类实例抛出 TypeLoadException

> ID：12239916
> 
> 赞同：0
> 
> 时间：2012-09-02T21:34:52.617
> 
> 标签：c#, generics, reflection

我的 TestLayer 类具有命名空间：“BLL.Infrastructure.TestLayer”并且在程序集中：“BLL”

```
public class LayerFactory<T, U>
{

  public static IBaseLayer<T, U> Get()
  {
       var obj = Activator.CreateInstance("BLL", "BLL.Infrastructure.TestLayer", new object[]   { (IBaseLayer<T, U>)null });

  }
} 
```

当我运行代码时，Activator 抛出 TypeLoadException 没有更多细节

那就是它应该创建的具体类：

GenericBaseLayer 实现 IBaseLayer。

```
public class TestLayer<T, U> : GenericBaseLayer<MyRequest, MyInfo.ActionType>
{
  public TestLayer(IBaseLayer<MyRequest, MyInfo.ActionType> layer)
            : base(layer)
   { }
} 
```

我错了什么？

LayerFactory 在程序集中：BLL

因此程序集必须已经加载！

**更新**

```
Type d1 = typeof(TestLayer<,>);
Type[] typeArgs = { typeof(T), typeof(U) };
Type constructed = d1.MakeGenericType(typeArgs);
var obj = Activator.CreateInstance(constructed, new object[] { (IBaseLayer<T, U>)null }); 
```

这有效:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T22:32:28.377

[按此处](http://todotnet.com/post/2006/11/13/Instantiating-Generic-Types-at-runtime.aspx)所示指定类型名称字符串：该文章建议

```
"System.Collections.Generic.List`1[System.String]" 
```

是 a 的字符串标识符`List<string>`。

如果您知道`T`并且`U`仅在运行时，您仍然可以使用`Type.GetType`泛型类型定义的字符串表示：

```
Type d1 = Type.GetType(yourNamespace + ".TestLayer`2"); 
```

`MakeGenericType`然后，您可以`d1`按照问题所示进行呼叫。

# email - 运行 Applescript 的邮件规则不起作用？

> ID：12239917
> 
> 赞同：0
> 
> 时间：2012-09-02T21:35:30.420
> 
> 标签：email, applescript, rule, apple-mail

我的 AppleScripters 同事的问题。我有以下脚本，如果您在 AppleScript 编辑器或脚本调试器中运行它，它运行得很好，但如果您尝试从邮件规则运行它，它根本不会运行。该脚本正确放置在 ~/Library/Application Scripts/com.apple.mail 中，并显示在 Mail 规则的“Run AppleScript”菜单中，但在新邮件到达时拒绝工作。

```
on perform_mail_action(info)
  tell application "Mail"
set theMessages to |SelectedMessages| of info
repeat with thisMessage in theMessages
set AppleScript's text item delimiters to {""}
set thisSender to sender of thisMessage as string
set quotepos to offset of "\"" in thisSender
  if (quotepos is not 0) then
    set thisSender to (text items (quotepos + 1) through -1) ¬
      of thisSender as string
    set quotepos to offset of "\"" in thisSender
    if (quotepos is not 0) then
      set thisSender to (text items 1 through (quotepos - 1)) ¬
        of thisSender as string
    end if
  else
    set atpos to offset of "@" in thisSender
    if (atpos is not 0) then
      set thisSender to (text items 1 through (atpos - 1)) ¬
        of thisSender as string
    end if
    set brkpos to offset of "<" in thisSender
    if (brkpos is not 0) then
      set thisSender to (text items (brkpos + 1) through -1) ¬
        of thisSender as string
      end if
      end if
      tell application "Finder" to say "Mail from " & thisSender
    end repeat
  end tell
end perform_mail_action 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T19:19:41.733

感谢大家的反馈，但我发现了问题所在。这根本与剧本无关。. . 是我在脚本添加文件夹中安装了 Satimage.osax，因为它还不是完全兼容 ML，所以它把一切都搞砸了。卸载它后，我所有的文件夹操作都开始正常工作！

谢谢！

——安迪·H。

# java - 作用于同一个可运行对象的两个线程

> ID：12239922
> 
> 赞同：4
> 
> 时间：2012-09-02T21:35:58.503
> 
> 标签：java, concurrency, race-condition

鉴于：

```
public class Thread1 {
int x = 0;

public class Runner implements Runnable {

    public  void run() {
        int current = 0;
        for (int i = 0; i < 4; i++) {
            current = x;
            System.out.print(current + " ");
            x = current + 2;
        }
    }
}

public void go() {
    Runnable r1 = new Runner();

    new Thread(r1).start();
    new Thread(r1).start();

}

public static void main(String[] args) {
    new Thread1().go();
}

} 
```

哪两个是可能的结果？（选择两个）

A. 0, 2, 4, 4, 6, 8, 10, 6,

B. 0, 2, 4, 6, 8, 10, 2, 4,

C. 0、2、4、6、8、10、12、14、

D. 0, 0, 2, 2, 4, 4, 6, 6, 8, 8, 10, 10, 12, 12, 14, 14,

E. 0, 2, 4, 6, 8, 10, 12, 14, 0, 2, 4, 6, 8, 10, 12, 14,

我选择了 A 和 B，但我不确定这是否是正确的答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T21:51:31.190

首先 D. 和 E. 出局了。作为`i`函数的本地范围，我们知道将有 8 个数字。

现在

`B. 0, 2, 4, 6, 8, 10, 2, 4,`

是不正确的。为什么？为了打印最后两个位置，每个线程必须至少***写入***变量两次。`x`此时 的最小值`x`为`4`。这意味着无论竞争条件如何，最后两个值都应该大于或等于`4`.

***编辑*** `C`是完全可能的。没有同步并不意味着不可能有所谓的串行执行（即好像线程一个接一个地执行）。并发的教训是你不知道线程将如何交错

```
 C. 0, 2, 4, 6, 8, 10, 12, 14, 
```

例如发生：

*   当第一个线程`x`在第二个开始之前完成更新时
*   当第一个线程在第一个线程之前挂起时，第二个线程`current = x;`完成执行，第一个线程继续。
*   ***大量***其他案例。

正如布赖恩·戈茨所说：

> *“编写正确的程序很难；编写正确的并发程序更难。”*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T21:59:55.580

答案是 A 和 C。您可以立即消除 D 和 E，因为两个线程都会显示 4 个结果，所以总共有 8 个结果，只剩下 A、B 和 C。

B 被消除是因为两个 2 之间的序列太长，单个线程无法产生，所以两个线程必须完成比仅达到 2 更多的工作。

# android - 在发出请求之前从 WSDL 检索值

> ID：12239927
> 
> 赞同：0
> 
> 时间：2012-09-02T21:36:26.193
> 
> 标签：android, web-services, wsdl, android-ksoap2

我对使用 Web 服务非常陌生，我正在尝试使用 ksoap2 库了解它在 Android 中的基础知识。问题是：[这](http://webservicex.net/ConvertWeight.asmx?WSDL)是我正在使用的服务的 WSDL 文件。它是一种在不同单位之间转换值的服务。单位在 WSDL 中说明。现在，有没有办法读取这些单位，例如，填充 a`Spinner`让用户选择他们想要使用的单位？代码解决方案将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T04:26:44.913

如果您使用 wsimport 为服务接口和关联类型生成存根，您应该得到一个 java WeightUnit 枚举。然后，代码解决方案将利用构成枚举的值来填充任何适当的控件。

# dynamics-crm - 在 CRM Dynamics 中的何处输入 JavaScript 代码？

> ID：12239930
> 
> 赞同：-1
> 
> 时间：2012-09-02T21:37:06.347
> 
> 标签：dynamics-crm, crm

> **可能重复：**
> [如何通过 Javascript 更新 Microsoft CRM Online 上的表单字段](https://stackoverflow.com/questions/11922319/how-can-i-update-form-field-on-microsoft-crm-online-via-javascript)

我昨天开始玩CRM Dynamics，所以这个问题应该被视为一个**非常**基本的问题。我已经编码多年，但 CRM D 对我来说是新闻。

显然，人们应该能够输入 JavaScript 代码来自定义应用程序的行为。我知道有一个 API 可以直接接触 DOM 或玩 jQuery 是不行的。

问题：JS代码应该在哪里输入？我已经浏览了所有菜单，但据我所知，没有地方可以插入我的自定义代码。

例如：我在哪里可以为当前正在定义的联系人的姓氏定义验证？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T23:18:59.103

所以我建议查看这些文章。

[这些给出了 Crm- MSDN](http://msdn.microsoft.com/en-us/library/hh771584.aspx)中 JavaScript 的一般概述。

您可能最常在表单上使用 JavaScript - [MSDN](http://msdn.microsoft.com/en-us/library/gg328261)。

另请查看本[教程](http://blog.webfortis.com/post/2011/08/15/A-Brief-Introduction-to-CRM-2011-JavaScript.aspx)，该教程解释了如何使用表单事件和库。同一系列中的本[教程提供了一个基本示例。](http://blog.webfortis.com/post/2012/02/28/CRM-2011-JavaScript-Tutorial-01-Basic-Field-Calculation.aspx)

您可以在某些情况下使用 jQuery，如此处所述 - [MSDN](http://msdn.microsoft.com/en-us/library/gg328261#BKMK_UsingjQuery)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-04T08:01:15.107

要输入 JavaScript，首先将其作为网络资源上传。然后，如果您希望它在加载表单时触发，请转到表单自定义，表单属性： ![在此处输入图像描述](../Images/66ee6fc41e2afe071c9557bab8526882.png)

从那里应该会弹出一个菜单： ![在此处输入图像描述](../Images/a07b74757dcdbf64f907fc14c9edfd79.png)

在表单库中添加 Java Web 资源。在事件处理程序中选择您正在使用的 Javascript 和函数名称。希望这会有所帮助:) Gdluck

# logging - uWSGI 日志格式统一

> ID：12239931
> 
> 赞同：1
> 
> 时间：2012-09-02T21:37:08.940
> 
> 标签：logging, uwsgi

我正在尝试统一我的 uwsgi 实例的日志格式。目前有三种不同类型的日志项：

*   `Sun Sep 2 17:31:00 2012 - spawned uWSGI worker 10 (pid: 2958, cores: 8)`
*   `(DEBUG) 2012-09-02 17:31:01,526 - getFileKeys_rpc called`
*   `Traceback (most recent call last): File "src/dispatch.py", line 13, in application obj = discovery(env) File "src/dispatch.py", line 23, in discovery ret_obj = {"return":dispatch(method,env)} File "src/dispatch.py", line 32, in dispatch raise Exception("test") Exception: test`

第一个是 uWSGI 内部产生的错误（我设置了 --log-date 选项）。第二个来自已`logging.basicConfig(format='(%(levelname)s) %(asctime)s - %(message)s')`设置的日志记录模块。最后一个是未捕获的异常。

我知道未捕获的异常可能无法格式化，但是有什么方法可以让 uwsgi 使用日志记录模块来记录其内部日志？还是反过来？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T04:46:29.703

您必须使用 uWSGI 1.3 并设置“python”记录器，使用

--logger 蟒蛇

# sql - SSRS表达式数字之间的和

> ID：12239932
> 
> 赞同：0
> 
> 时间：2012-09-02T21:37:28.610
> 
> 标签：sql, vb.net, expression, reporting-services

我正在寻求帮助，以在 SSRS 中创建一个减去 SUMS 的 VB 表达式。我有一个数据集，其中包含帐户和相应的货币/金额值。我需要帮助创建一个表达式，该表达式将指定范围内一组帐户的金额/金额值相加，然后从另一个范围内的金额/金额总额中减去它。具体来说：

```
(Sum(amt) where acct between 40000 and 49999) -
(Sum(amt) where (acct between 50000 and 59999) or (acct between 66000 and 69999)) -
(Sum(amt) where acct between 76000 and 79825) -
(Sum(amt) where acct between 89000 and 90399) 
```

确实需要帮助将此 SQL 逻辑转换为 VB 表达式以用于 SSRS 中的文本框。任何建议都会非常有帮助！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T15:02:42.877

textbox 只能捕获数据集的第一个值，因此如果您转到文本框的表达式构建器，您会看到数据集中没有可用的字段。但是，可以使用数据集字段上的聚合函数。

因此，您可以为数据集创建一个计算字段，并使用适当的符号向其中添加金额值，以便该计算字段中所有值的总和代表您所需的解决方案。

例如，将一个新的计算字段添加到您的数据集。在字段源中，添加适当的表达式，例如：

```
=IIF(Fields!acct.Value>=40000 AND Fields!acct.Value<=49999, CInt(Fields!amt.Value),
   IIF(   (Fields!acct.Value>=50000 AND Fields!acct.Value<=59999)  OR
          (Fields!acct.Value>=66000 AND Fields!acct.Value<=69999)  OR
          (Fields!acct.Value>=76000 AND Fields!acct.Value<=79825)  OR
          (Fields!acct.Value>=89000 AND Fields!acct.Value<=90399), 
                 CInt(0 - Fields!amt.Value), CInt(0)
      )
    ) 
```

这使值保持在 40000 和 49999 之间。使所有需要减去的值变成负值。以及您不希望将其视为 0 的所有其他内容。

因此，当你打电话

```
Sum(Fields!calcfield.Value, "your dataset name") 
```

从文本框中，添加 40000 到 49999 之间的值，然后减去所需范围内的值。

请根据需要更改计算字段的表达式，该过程将起作用。您不应该直接从文本框中浏览数据集中的所有值。

希望能帮助到你。

# open-source - 开源SaaS

> ID：12239933
> 
> 赞同：4
> 
> 时间：2012-09-02T21:37:49.203
> 
> 标签：open-source, licensing, gpl, saas

我最近看到一些商业服务使他们的代码开源。一些例子是[cloud9 ide](https://github.com/ajaxorg/cloud9)和[reddit](https://github.com/reddit/reddit)。当然，我想到了 Wordpress。它一直是一个 OSS - 因为我不知道什么时候 - 在 GPl（如 cloud9）下，具有并行服务，对“功能”或高级内容收费。（[完整列表](http://www.labnol.org/internet/blogging/how-wordpress-makes-money/7576/)）

所以问题是：

1.  开源一个应用程序（在 GPL 下）并用它来驱动一个为它在该应用程序之上提供的*“服务”*收费的 Saas是否*安全？*

**   这样做有什么好处和坏处？

    *   它真的有意义吗？:)* 

 *我只是喜欢开源，并希望开源我的一些项目，同时从中产生一些收入。因此我的担心！

非常感谢小伙伴们的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T22:05:40.603

没有开源许可证可以阻止您对软件或服务收费。GPL 只是说，如果您分发某些 GPL 软件的修改版本，那么您的修改也必须在 GPL 下发布。它并*没有*说如果你不想发布你的修改版本，只是说*如果*你这样做了，那么你必须在 GPL 下这样做。

“Affero GPL”比这更进一步，它说如果您使用 AGPL 软件来驱动网络服务，那么您也必须在 AGPL 下发布您对软件所做的任何修改。换句话说，提供对服务的公共访问权限与分发软件相同。

当然，如果您是相关软件（所有部分）的版权所有者，那么您可以根据您选择的任何许可自由发布和/或使用它。您可以发布它 (A)GPL，但也可以提供商业许可选项，或者将您的核心软件发布为 AGPL，然后运行您自己的服务，该服务添加您自己的专有扩展，其代码您不发布 - 开源许可说“任何人都可以在 [GPL/Apache/whatever] 条件下使用此软件，而无需请求特定许可”，但作为版权所有者，您可以为特定人员/案例授予其他许可，包括（显然）您自己。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-04T08:13:18.577

FWIF 通过发布您的 SaaS 的源代码，您会失去“默默无闻的安全性”。每个人都可以看到您正在运行过时的框架版本，并查找此版本的安全相关票证。另一方面，这迫使您考虑适当的安全性，例如运行最新版本的库。*

# php - php缓冲输出，css和邮件

> ID：12239941
> 
> 赞同：3
> 
> 时间：2012-09-02T21:38:54.597
> 
> 标签：php, css, email, ob-get-contents

目前我有一个发送一些邮件的脚本，脚本结果是几个 html 表：

```
$from = "prueba.com <noreply@prueba.com>"; 
$to = "myemail@gmail.com"; 
echo "<div>"; 

$contenido = ob_get_contents(); 
echo "</div>"; 
$cabeceras = "Content-type: text/html; charset=iso-8859-1 \r\n" 
           ."MIME-Version: 1.0 \r\n" 
           ."To: $cliente <$email> \r\n" 
           ."From: prueba <prueba@example.com> \r\n"; 

mail($to,$subject,$contenido,$cabeceras); 

ob_end_flush(); 
```

可能会给那封电子邮件提供css？因为我尝试了几种方法，但都没有奏效。

预先感谢您的合作

编辑：

这是我的代码[http://www.mediafire.com/?bq9352xh6paji1d](http://www.mediafire.com/?bq9352xh6paji1d)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T21:44:51.537

也许你想要这样：（使用`ob_get_clean()`）

```
ob_start();
echo "<div>"; 
    // more html
echo "</div>";
$contenido = ob_get_clean(); 
```

并失去最后一个`ob_end_flush();`

测试：

```
$from = "prueba.com <noreply@prueba.com>"; 
$to = "myemail@gmail.com"; 
ob_start();
echo "<div>"; 
echo "<table border='1'><tr><td>TEST</td></tr></tr>";
echo "</div>";
$contenido = ob_get_clean(); 

$cabeceras = "Content-type: text/html; charset=iso-8859-1 \r\n" 
           ."MIME-Version: 1.0 \r\n" 
           ."To: $cliente <$email> \r\n" 
           ."From: prueba <prueba@example.com> \r\n"; 

mail($to,$subject,$contenido,$cabeceras); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T21:42:24.987

您可以在这里阅读：http: [//css-tricks.com/sending-nice-html-email-with-php/](http://css-tricks.com/sending-nice-html-email-with-php/)

# ruby-on-rails - Gruff 中的分段错误使我无法生成简单的图表

> ID：12239944
> 
> 赞同：0
> 
> 时间：2012-09-02T21:39:22.400
> 
> 标签：ruby-on-rails, rmagick, gruff

我正在尝试简单的项目和 RonR，特别是尝试使用带有 rmagick 和图像魔法的 gruff gem 生成一些图形。一切都安装成功，但是当我运行一个带有图表的简单 .rb 时，它给了我：

> > C:/RailsInstaller/Ruby1.8.7/lib/ruby/gems/1.8/gems/gruff-0.3.4/lib/gruff/base.rb:467: [BUG] Segmentation fault ruby​​ 1.8.7 (2011-06-30补丁级别 352) [i386-mingw32]
> > 
> > 此应用程序已请求运行时以不寻常的方式终止它。请联系应用程序的支持团队以获取更多信息。

*base.rb*文件中的行是指这段代码：

```
# Writes the graph to a file. Defaults to 'graph.png'
#
# Example:
#   write('graphs/my_pretty_graph.png')
def write(filename="graph.png")
   draw()
   @base_image.write(filename)
end 
```

同时，我试图绘制的简单图表似乎很简单，它来自 Gruff 网站的一个示例：

```
#!/usr/bin/ruby

require 'rubygems'
require 'gruff'
g = Gruff::Bar.new('800x500') # Define a custom size
g.sort = false  # Do NOT sort data based on values
g.maximum_value = 50  # Declare a max value for the Y axis
g.minimum_value = 0   # Declare a min value for the Y axis
g.theme_37signals  # Declare a theme from the presets available

g.title = 'A more advanced bar chart'

g.data('Foo', [5, 10, 24])
g.data('Bar', [15, 3, 10])
g.data('Else', [38, 15, 32])

g.labels = {0 => 'Last year', 1 => 'This year', 2 => 'Next year'} # Define labels for each of the "columns" in data

g.write('a_more_advanced_graph.png') 
```

*我要么尝试在irb*中加载上述 .rb 脚本，要么直接将其加载到控制器中。两种方式都失败了。

即使尝试在控制器中制作图表然后在视图中显示它，它也会再次失败。每次同样的分割错误。

请注意，我已经安装了 gems，并在 Gemfile 中添加了（如果尝试从应用程序中进行）。我在 Windows 上运行 Rails 并且*gruff*版本是*0.3.4*，虽然我也尝试过使用最新版本*0.3.6*但那里也有同样的问题。

任何想法或建议都非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T00:10:29.743

它可能与您的代码无关，但我不能肯定。

分析错误：

```
C:/RailsInstaller/Ruby1.8.7/lib/ruby/gems/1.8/gems/gruff-0.3.4/lib/gruff/base.rb:467:
   [BUG] Segmentation fault ruby 1.8.7 (2011-06-30 patchlevel 352) [i386-mingw32] 
```

也就是说，当 gruff gem 执行时，当它到达 base.rb 文件中的第 467 行时，ruby 抛出了一个分段错误（一个非常低级别的错误，通常是试图访问一个不存在的内存位置）

所以不要专注于你的代码，专注于版本（即所需的 ruby​​ 版本，或 gruff 依赖的 gem 版本等）

# java - 写时依赖java字符串复制

> ID：12239946
> 
> 赞同：1
> 
> 时间：2012-09-02T21:39:35.990
> 
> 标签：java, copy-on-write

我的应用程序创建了一个类的很多实例，比如 A 类。所有实例都包含一个字符串，其中大多数都包含相同的字符串

```
class A {
   String myString;
} 
```

我知道 JVM 使“所有相等的字符串”指向只存储一次的同一个字符串。如果我的 A 实例之一的 myString 字段被覆盖，则对原始字符串的引用将替换为对新 String 值的引用，并且一切都按预期工作，就好像每个实例都有一个字符串的副本一样。

兼容的 JVM 是否需要这种行为，或者它是对 jvm 的一种改进，可能会从一个 jvm 更改为另一个，或从一个版本更改为另一个版本？
**提出问题的另一种方式**：在设计高度冗余（基于字符串）的数据结构时，应该只依赖写时复制机制还是建议在应用程序级别放置一些东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T22:01:03.153

另一个方面是，如果它们是动态创建的（例如，由解析器分配），您的字符串将不一样。如果空间是一个问题，请查看 String.intern() ：

```
String a = String.valueOf('a') + "b";
String b = a.intern();
String c = "ab";
// now b == c is true 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T10:23:10.267

事实是 String 是常规对象。

```
String a = "test";
String b = a; 
```

与以下内容完全相同：

```
StringBuffer a = new StringBuffer("test");
StringBuffer b = a; 
```

也就是说：在这两种情况下，b 都是对 a 的第二次引用，这不是由于不可变性。

**不变性开始发挥作用**
因此，您总是处理指向相同数据的两个指针。现在，如果类是不可变的，您可以忘记它：没有人会在您的脚下更改您的数据，不是因为您有自己的副本，而是因为共享副本是不可变的。你甚至可以认为你有一个字符串的副本，但实际上从 String b = a; 开始就没有副本存在。对每个对象执行其操作：唯一引用的副本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T21:54:59.553

正如@Hot Licks 所说：字符串是不可变的，因此没有地方谈论写入时的复制。同样，当您使用可变对象时，您必须注意“写入时复制”可能在您的客户端环境中不可用。

当您创建大量对象时，另一件可能非常重要的事情。每个对象都包含几个字节的标头、指针等。如果我没记错的话，空对象大约是 20 个字节。当您谈论许多包含属性的对象时，它开始变得很重要。请注意这一点，当您**测量**它导致问题时，您必须在应用程序级别做一些事情（轻量级设计模式，使用流 xml 解析器等）。

# java - Java注解

> ID：12239948
> 
> 赞同：4
> 
> 时间：2012-09-02T21:39:37.253
> 
> 标签：java, annotations

我在java中使用了很多注释，但我从来没有写过。我阅读了几本指南，我真的很困惑。

他们正在使用元信息之类的注释，例如姓名、年龄等。这真的很令人困惑，因为我想做一些不同的事情

[http://www.developer.com/java/other/article.php/3556176/An-Introduction-to-Java-Annotations.htm](http://www.developer.com/java/other/article.php/3556176/An-Introduction-to-Java-Annotations.htm)

我想控制函数调用。

例如

```
@Permission(user)
public static void account(){
...
} 
```

所以我的函数只有在用户有权限的情况下才会被调用，否则用户应该被重定向到登录页面。

我找不到任何信息，也许我使用了错误的关键字？

希望你能把事情弄清楚

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T21:50:34.090

你*可以*这样做，但需要大量额外的代码。拦截方法调用是 AOP（面向方面​​编程）的一部分。您需要为您的目标对象制作代理，并在调用处理程序中解析注释。

幸运的是，你不必这样做——因为你有一个 webapp，只需使用 spring/spring-mvc/spring-security。Spring 为您提供了一个 AOP 框架，您可以使用它来定义处理权限逻辑的方面

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T21:49:10.573

不知道你怎么能自己做到这一点，但如果你使用的是 Spring，他们有一些可能会有所帮助的东西

[http://static.springsource.org/spring-security/site/docs/3.0.7.RELEASE/reference/el-access.html](http://static.springsource.org/spring-security/site/docs/3.0.7.RELEASE/reference/el-access.html)

我将它用于我当前的项目并且效果很好

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-02T21:49:52.460

类似的事情应该在函数本身（或程序的其他部分）中完成。请注意，注释提供了有关**不**属于程序本身的程序的数据（请参阅[此](http://docs.oracle.com/javase/tutorial/java/javaOO/annotations.html)参考）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-02T21:53:03.257

我认为您所追求的是在您的方法之前运行的 AOP 顾问。见这里：http: [//java-questions.com/spring_aop.html](http://java-questions.com/spring_aop.html)

作为 Spring 的替代方案，您可以使用 AspectJ：[http ://www.andrewewhite.net/wordpress/2010/03/17/aspectj-annotation-tutorial/](http://www.andrewewhite.net/wordpress/2010/03/17/aspectj-annotation-tutorial/)

# c++ - 将 C++ 主方法移动到自己的文件时出现编译器错误

> ID：12239950
> 
> 赞同：4
> 
> 时间：2012-09-02T21:40:05.230
> 
> 标签：c++, g++, main

我这里有世界上最简单的程序。我想你们中的一些人只需要一秒钟就可以找出问题所在。

富.h：

```
#ifndef FOO_H
#define FOO_H

namespace foo
{
    char str[ 20 ];

    void bar(char* s);
}

#endif 
```

foo.cpp：

```
#include "foo.h"

using namespace std;

namespace foo
{
    void bar(char* s) {
        return;
    }
} 
```

foo_main.cpp：

```
#include "foo.h"

using namespace std;
using namespace foo;

int main(void)
{
    bar( str );
} 
```

现在，当我尝试将这三个编译在一起时：

```
g++ foo_main.cpp foo.cpp -o foo

/tmp/cc22NZfj.o:(.bss+0x0): multiple definition of `foo::str'
/tmp/ccqMzzmD.o:(.bss+0x0): first defined here
collect2: ld returned 1 exit status 
```

我想在命名空间 foo 中使用 str 作为全局变量，因此需要将其保留在那里。如果我将我的 main 方法移动到 foo.cpp 中，那么一切都可以正常编译。如果我想将我的主要方法留在一个单独的文件中，我该怎么办？如您所见，我什至在 .h 文件中添加了包含保护，这样就不会与 str 发生冲突，但似乎不起作用。怎么了？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-02T21:43:42.487

就像任何其他全局变量一样，在需要使用它的任何地方声明它并只在一个地方定义它。所以在 中`foo.h`，将其标记为`extern`。然后在`foo.cpp`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-02T21:46:25.180

include 指令将包含文件的内容逐字包含到包含`#include`. 因此，您最终得到了两个 cpp 文件中的定义`char str[ 20 ];`，*因此*两次。

写

```
extern char str[ 20 ]; 
```

在头文件中并放入

```
char str [ 20 ]; 
```

只放入其中一个 cpp 文件中。

# iphone - 适用于 DirectSound 程序员的 iOS 音频 - 使用什么？

> ID：12239951
> 
> 赞同：1
> 
> 时间：2012-09-02T21:40:11.430
> 
> 标签：iphone, ios, ipad, ipod

我是 iOS 新手的 DirectSound 程序员。我想实现播放流式多声道音频的能力，有时在流完成播放时循环回到指定点（想想一首有一点介绍的歌曲，播放一次，然后歌曲无限循环，跳过那个介绍）。

至少使用 DirectSound 和 libvorbis，我会将一大块 OGG 数据输入 libvorbis 解码器，它会吐出一些 PCM，然后我会填充缓冲区并将其排队等待在当前声音缓冲区之后播放完成，在两个缓冲区之间交换。

可能正在考虑在 iOS 上使用某种硬件支持的格式，例如 AAC。我应该使用哪些编程 API 来实现多通道和循环点？任何输入表示赞赏，谢谢！

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-02T21:48:22.980

iOS AVAssetReader 类可用于将压缩的音频文件数据读入 PCM 缓冲区。音频队列 API（更简单）或 RemoteIO 音频单元（延迟更低）都可用于播放 PCM 数据的缓冲区。

# unix - 如何在 VIm 和终端中始终拥有相同的当前目录？

> ID：12239952
> 
> 赞同：5
> 
> 时间：2012-09-02T21:40:25.500
> 
> 标签：unix, vim, vim-plugin

我想我的终端当前目录跟随我的 VIM 之一。

例子：

在终端：

```
> pwd
=> /Users/rege
> vim 
```

然后在vim中

```
:cd /Users/rege/project
<Ctrl-z>(for suspend) 
```

在终端

```
> pwd
=> /Users/rege/project 
```

我正在使用 MacOS、zsh、tmux。

我需要这个，因为当我尝试在 VIM 中使用标签时，标签是从我的终端目录而不是 vim 一签入项目。

因此，当我更改 VIM 当前目录时，我需要始终更改终端当前目录。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T13:50:41.557

挂起 Vim 后，你在 shell 中发出什么样的命令？Vim`:!command`还不够吗？

使用`set autochdir`，当你从一个文件跳转到另一个文件时，Vim 的当前目录会跟随你。使用此设置，simple`:!ctags -R .`将始终`tags`在当前文件的目录中创建一个文件。

另一个有用的设置是`set tags=./tags,tags;$HOME`告诉 Vim`tags`在当前文件的目录中查找文件，然后在“当前目录”中查找，直到找到您的`~/`. 您可以修改端点以满足您的需要。这允许您`tags`在编辑属于项目的任何文件时在项目的根目录使用 a。

所以，基本上，你可以在不离开 Vim 的情况下走很长一段路。

如果你真的*需要*回到 shell 来发出你的命令，`:shell`（或`:sh`）用 Vim 的当前目录启动一个新的 shell。完成后，您只需`$ exit`返回 Vim：

```
$ pwd
/home/romainl
$ vim
:cd Projects
:sh
$ pwd
/home/romainl/Projects
$ exit 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-03T04:05:46.153

在 bash 或 zsh 以及 Unix 上，您可以这样做：进程的当前工作目录表示`/proc/{PID}/cwd`为指向真实目录的符号链接。谈到 zsh，下面的代码将完成这项工作：

```
function precmd()
{
    emulate -L zsh
    (( $#jobstates == 1 )) || return
    local -i PID=${${${(s.:.)${(v)jobstates[1]}}[3]}%\=*}
    cd $(readlink /proc/$PID/cwd)
} 
```

. 注意：使用此代码，您将无法再在终端中永久切换目录，只能在 vim 中或在一个命令的持续时间内（使用`cd other-dir && some command`）。

注 2：我不知道如何在 bash 中表达这一点。直接的方法是获取 shell 的所有子进程的 PID（使用`ps --ppid $$ -o CMD`），过滤掉`ps`进程（它也将显示为子进程），检查是否只有一个其他子进程，并像最后一行一样使用它的 PID以上。但我很确定有一种更好的方法可以使用一些 shell 内置函数，就像我对 zsh 的`$jobstates`关联数组所做的那样。我也不记得`precmd`bash 的类似物是什么。

* * *

另一个想法是让 vim 在你这样做时将其当前目录保存到某个文件中，`<C-z>`并让 shell 在 precmd 中读取它：

```
" In .vimrc:
function s:CtrlZ()
    call writefile([fnamemodify('.', ':p')], $CWDFILE, 'b')
    return "\<C-z>"
endfunction
nnoremap <expr> <C-z> <SID>CtrlZ()

# In .zshrc
function vim()
{
    local -x CWDFILE=~/.workdirs/$$
    test -d $CWDFILE:h || mkdir $CWDFILE:h
    vim $@
}
function precmd()
{
    local CWDFILE=~/.workdirs/$$
    test -e $CWDFILE && cd "$(cat $CWDFILE)"
} 
```

. 将上面的代码移植到 bash 应该更容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T22:52:35.093

你可以像这样打开一个新终端

```
:!xterm -e bash -c "cd %:p:h;bash" & 
```

实际上我在我的 .vimrc 中写了这个

```
nmap <F3> :!xterm -e bash -c "cd %:p:h;bash" &<CR> | :redraw! 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-11-22T21:55:11.633

对于过来的 bash 用户：

**Vim:** 保存`pwd`在`<c-z>`(with `map`and `getpwd()`).
**Bash：**在提示命令之前，转到 vim 指示的目录，带有`PROMPT_COMMAND`.

**.bashrc**

```
PROMPT_COMMAND='read -r line 2>/dev/null </tmp/cd_vim'\
'&& > /tmp/cd_vim && cd ${line##\r};'$PROMPT_COMMAND 
```

**vimrc**

```
function! s:CtrlZ() call writefile([getcwd(),''], '/tmp/cd_vim', 'b')
    return "\<C-z>"
endfunction
nnoremap <expr> <C-z> <SID>CtrlZ() 
```

[这是为 bash https://stackoverflow.com/a/12241861/2544873](https://stackoverflow.com/a/12241861/2544873)编辑的 ZyX 答案

# java - 与命令行进程交互

> ID：12239956
> 
> 赞同：0
> 
> 时间：2012-09-02T21:40:58.160
> 
> 标签：java, windows, process

我需要与命令行进程交互，例如windows 上的diskpart。问题：`input.readLine()`在以下示例中导致阻塞。

```
public static void main(String[] args) throws IOException 
{
    ProcessBuilder processBuilder = new ProcessBuilder("C:\\Windows\\system32\\diskpart.exe");                      
    processBuilder.redirectErrorStream(true);
    Process process = processBuilder.start();

    input = new BufferedReader(new InputStreamReader(process.getInputStream()));
    output = new BufferedWriter(new OutputStreamWriter(process.getOutputStream()));

    // read #1 code position
    String line = null;
    while((line = input.readLine())!= null)
        System.out.println(line);

    // code position #2
    System.out.println("This line is never executed");   

    output.write("list disk" + System.lineSeparator());
    output.flush(); // important
} 
```

输出（从读取 #1 代码位置）是

```
Microsoft DiskPart-Version 6.1.7601
Copyright (C) 1999-2008 Microsoft Corporation.
Auf Computer: MYPC 
```

这是正确的，但是在那之后什么也没有发生，例如代码位置#2

```
System.out.println("This line is never executed"); 
```

永远达不到。谁能告诉我，为什么以及如何解决这个问题？谢谢！

**更新：**

尝试逐字节读取似乎也不起作用？):

```
 InputStreamReader input = new InputStreamReader(process.getInputStream());
    int mychar = -1;

    while((mychar = input.read()) != -1)
        System.out.println(mychar);

    System.out.println("This line is never executed"); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T21:47:15.150

因为 Diskpart 所做的下一件事是显示提示，其中不包含换行符：

```
Microsoft DiskPart version 6.1.7601
Copyright (C) 1999-2008 Microsoft Corporation.
On computer: PCNAME

DISKPART> _ 
```

所以你的代码在那里等待换行，它永远不会出现。

您需要更改代码以在正确的时间发送“list disk”命令。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T21:46:52.997

[Diskpart](http://support.microsoft.com/kb/300415)有一个需要用户输入的交互式控制台。尝试像这样读取它的输出：

```
while((line = input.readLine())!= null)
      System.out.println(line); 
```

将导致您无限期地等待，因为应用程序本身需要输入。

您需要先等待来自 windows 命令的输入，因此您需要添加**`CMD /C`**到命令中。

由于`diskpart`是交互式的，您可以尝试将 list 命令作为脚本运行，因此您可以：

```
String[] command = {"CMD", "/C", "C:\\Windows\\system32\\diskpart.exe", "/s", "diskpart.txt"};
ProcessBuilder processBuilder = new ProcessBuilder(command); 
```

包含`diskpart.txt`：

```
list disk 
```

我建议您首先在标准批处理文件中使用它以检查输出是否正确。

# objective-c - 将带有参数的方法传递给 NSTimer

> ID：12239960
> 
> 赞同：1
> 
> 时间：2012-09-02T21:41:42.973
> 
> 标签：objective-c, ios

我不知道如何使用带有参数的方法`NSTimer`。我正在使用的代码如下 - 想法是标签被发送到第一个方法，它变成红色，然后在第二个方法被调用并且标签变成黑色。

```
-(void) highlightWord:(UILabel *)label
{
    label.textColor = [UIColor colorWithRed:235 green:0 blue:0 alpha:1];
    //[NSTimer scheduledTimerWithTimeInterval:1.0 target:self selector:@selector(unhighlightWord:label) userInfo:nil repeats:NO];
}

- (void) unhighlightWord:(UILabel *)label {
    label.textColor = [UIColor colorWithRed:0 green:0 blue:0 alpha:1];

} 
```

有了这样的代码，Xcode 告诉我：`Expected ":"`在`@selector(unhighlightWord:label`. 如果我添加“：”，我会`unrecognized selector`在运行时收到一条消息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T21:52:25.157

计时器方法的选择器采用一个参数，即计时器本身（您无需在选择器中指定任何参数——它应该只是@selector(unhighlightWord:)）。因此，您需要有一个指向您的标签的 ivar 或属性，并在您的方法中使用它，而不是尝试将标签作为参数传递。

```
-(void) highlightWord:(UILabel *)label
{
    label.textColor = [UIColor colorWithRed:235 green:0 blue:0 alpha:1];
    self.myLabel = label; // myLabel is a property
    [NSTimer scheduledTimerWithTimeInterval:1.0 target:self selector:@selector(unhighlightWord:) userInfo:nil repeats:NO];

}

- (void) unhighlightWord:(NSTimer *) aTimer {
    self.myLabel.textColor = [UIColor colorWithRed:0 green:0 blue:0 alpha:1];

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-14T11:57:26.913

接受的答案工作正常，但另一个（可能更好）的解决方案是将标签传递给计时器`userData`：

```
-(void) highlightWord:(UILabel *)label
{
    label.textColor = [UIColor colorWithRed:235 green:0 blue:0 alpha:1];
    [NSTimer scheduledTimerWithTimeInterval:1.0 target:self selector:@selector(unhighlightWord:) userInfo:label repeats:NO];

}

- (void)unhighlightWord:(NSTimer *)aTimer {
    if ([aTimer.userData isKindOfClass[UILabel class]]) {
        ((UILabel *)aTimer.userData).textColor = [UIColor colorWithRed:0 green:0 blue:0 alpha:1];
    }
    // can do other checks for different objects (buttons, dictionaries, switches, etc...)
} 
```

这对于丢失代码来说非常好，如果您想对不同的标签（甚至是按钮等其他对象）使用相同的方法/机制，您可以这样做，前提是您进行了正确的检查。

`userData`如果您需要其他信息，也可以传入字典：

```
[NSTimer scheduledTimerWithTimeInterval:1.0 target:self selector:@selector(unhighlightWord:) userInfo:@{@"sender": label, @"otherData", @"some important value"} repeats:NO]; 
```

然后在您的接收方法中，您可以像使用普通字典一样访问数据：

```
if ([aTimer.userData isKindOfClass[NSDictioanry class]]) {
    // do something
} 
```

# c# - 如何检查目录的大小并可能删除最后一个文件

> ID：12239961
> 
> 赞同：0
> 
> 时间：2012-09-02T21:41:57.137
> 
> 标签：c#, sql-server-2008, directory, database-backups

> **可能重复：**
> [如何在 C# 中获取目录大小（目录中的文件）？](https://stackoverflow.com/questions/1118568/how-do-i-get-a-directory-size-files-in-the-directory-in-c)

我有一个制作 SQL Server 备份的程序。每次运行后，它都会创建一个备份文件。但文件正在积累。

我想添加检查备份目录大小的方法，如果大小高于阈值大小，它将删除最后一个文件。

你知道我该怎么做吗？

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T21:48:43.437

添加列表中的所有文件，并结合使用 CompareTo 和 FileInfo CreationTime 对列表进行排序。然后根据您要保留在目录中的文件数相应地删除文件。

至于计算目录文件，只需遍历目录中的所有文件，同时使用 FileInfo Length 来增加总大小的变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T22:10:52.193

使用 DirectoryInfo 和一些 Linq 是一项简单的任务

```
public void RemoveLastFile(string folderPath, long dirSizeLimit)
{
    long size = 0;
    var files = new DirectoryInfo(folderPath).GetFiles();
    files.Sum(f => size += f.Length);
    if(size > dirSizeLimit)
    {
       var sorted = files.OrderBy(f => f.LastWriteTime);
       File.Delete(sorted.First().FullName);
   }
} 
```

当然这是一个例子。您需要添加一些错误检查。
PS我使用了FileInfo类的属性LastWriteTime，在你的情况下（备份文件）我认为它相当于CreationTime。

# android - GridLayout 中 TextView 的动态高度

> ID：12239966
> 
> 赞同：10
> 
> 时间：2012-09-02T21:42:56.340
> 
> 标签：android, textview, clipping, grid-layout

我在使用 GridLayout 使用库兼容性时遇到问题（没有尝试过）。我正在使用`app:layout_gravity="fill_horizontal"`而不是，`android:layout_gravity="fill_horizontal"`但里面的所有内容`TextView`都没有显示。为了显示所有内容，我必须设置`TextView`“标题”的高度，但我想要一个动态高度，而不是设定高度。

任何想法？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-09-12T15:23:09.947

您必须为 TextView 设置`layout_width="0dp"`和`layout_gravity="fill_horizontal"`。

```
<TextView
    android:layout_width="0dp"
    android:layout_gravity="fill_horizontal" /> 
```

请在此处查看完整示例：[https](https://groups.google.com/d/msg/android-developers/OmH3VBwesOQ/ZOGR0SGvC3cJ) ://groups.google.com/d/msg/android-developers/OmH3VBwesOQ/ZOGR0SGvC3cJ或此处：[http ://daniel-codes.blogspot.com/2012/01/gridlayout-view -clipping-issues.html](http://daniel-codes.blogspot.com/2012/01/gridlayout-view-clipping-issues.html)

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2014-04-15T17:02:14.873

使用`TextView`inside`GridLayout`是有问题的，但是有*一个*很好的方法可以同时使用两者。

这是示例布局的样子：

![GridLayout内的TextView](../Images/8eecb1183468da41f12bb684f35b5bcd.png)

这是完整的布局xml，重要的行标有***。

```
<?xml version="1.0" encoding="utf-8"?>
<GridLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:columnCount="3"              *   this example uses 3 columns
    android:orientation="horizontal" >   *** use "horizontal"

<TextView                                *   just a normal view
    android:layout_column="0"
    android:layout_row="0"
    android:background="#666666"
    android:text="A"
    android:textColor="#afafaf"
    android:textSize="60sp"
    android:textStyle="bold" />

<TextView                                *   this text will not be cut!
    android:layout_width="0dp"           *** important: set width to 0dp
    android:layout_height="wrap_content"
    android:layout_column="1"
    android:layout_columnSpan="2"        *   colspan does also work with this
    android:layout_gravity="fill_horizontal|bottom"        *** set to "fill*"!
    android:layout_row="0"
    android:text="This view has 2 columns. Lorem ipsum dolor sit amet, consetetur sadipscing elitr."
    android:textColor="#666666" />

</GridLayout> 
```

根据您的需要，这种组合也将起作用：

```
 android:layout_width="0dp"
    android:layout_height="0dp"
    android:layout_gravity="fill"
    android:gravity="bottom" 
```

请注意，您不必使用除此之外`android`的任何命名空间。

# ios - 如果已为 UIBackgroundModes 注册了位置，iOS 会唤醒已终止的应用程序吗？

> ID：12239967
> 
> 赞同：24
> 
> 时间：2012-09-02T21:42:59.300
> 
> 标签：ios, background, location

我知道如果一个应用程序使用“重大变化的位置服务”，如果有一个位置更新要传递，iOS 会唤醒它，即使应用程序被终止。

如果应用程序使用标准位置服务并将位置指定为 UIBackgroundModes 的键，我无法找到有关此案的明确答案：即使它被终止，iOS 也会唤醒它以提供更新吗？还是应用程序需要在后台运行才能获取位置更新回调？

**更新：**当我问这个时，我没有时间测试它。但是在这里得到答案后，我在我的应用程序的委托中编写了这段代码，以查看我终止的应用程序在获得位置更新时是否会重新启动。当我收到更新通知时，我正在显示 UILocalNotification。但是，当我终止我的应用程序然后更改我在城市中的位置时，该应用程序没有重新启动，我也没有得到任何更新。你能告诉我我做错了什么吗？

**更新#2：**根据本问答中的最终调查结果，此代码没有任何问题，这是使用标准位置服务的应用程序的预期行为，终止后不会重新启动。

我已将位置添加为 Info.plist 文件中的 UIBackgroundModes 之一。

这是我的应用程序委托的位置相关部分：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {    

    [UIApplication sharedApplication].applicationIconBadgeNumber = 0;

    m_locManager = [[CLLocationManager alloc] init];
    m_locManager.delegate = self;
    [m_locManager startUpdatingLocation];
    return YES;
}

- (void)applicationDidEnterBackground:(UIApplication *)application {
    [m_locManager startUpdatingLocation];
}

- (void)locationManager:(CLLocationManager *)manager didFailWithError:(NSError *)error
{
    NSLog("%@", [NSString stringWithFormat:@"Background Fail %@", [error localizedDescription]]);
}

- (void)locationManager:(CLLocationManager *)manager
    didUpdateToLocation:(CLLocation *)newLocation
           fromLocation:(CLLocation *)oldLocation
{
    UILocalNotification * theNotification = [[UILocalNotification alloc] init];
    theNotification.alertBody = [NSString stringWithFormat:@"Background location %.06f %.06f %@" , newLocation.coordinate.latitude, newLocation.coordinate.longitude, newLocation.timestamp];
    theNotification.alertAction = @"Ok";

    theNotification.fireDate = [NSDate dateWithTimeIntervalSinceNow:1];

    [[UIApplication sharedApplication] scheduleLocalNotification:theNotification];
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-03T15:30:58.633

看起来您找到了一个可行的解决方案，并且使用重大更改框架似乎可以为您节省一些电池寿命，只要它对您的目的足够准确。您的解决方案也是有益的，因为它允许您通过仅监控您最接近的区域来处理可能超过允许同时监控 20 个区域的每个应用程序限制。

我需要类似的功能，但认为重大更改对于我的应用程序来说不够准确，因此我挖掘了更多内容并找到了以下内容。

根据[位置感知编程指南](http://developer.apple.com/library/ios/#documentation/userexperience/conceptual/LocationAwarenessPG/CoreLocation/CoreLocation.html)，在“监控基于形状的区域”下：

> 在 iOS 中，与您的应用关联的区域会一直被跟踪，包括当您的应用未运行时。如果在应用程序未运行时跨越区域边界，则该应用程序将重新启动到后台以处理事件。同样，如果应用程序在事件发生时被挂起，它会被唤醒并给予很短的时间来处理事件。

还有在“处理区域的跨界事件”中：

> 每次用户的当前位置跨越边界区域时，系统都会为您的应用生成适当的区域事件。如果您的应用程序已经在运行，这些事件将直接发送给任何当前位置管理器对象的委托。如果您的应用程序没有运行，系统会在后台启动它，以便它可以响应。应用程序可以实现以下方法来处理越界：
> 
> locationManager:didEnterRegion:
> 
> locationManager:didExitRegion:

就我而言，我只需要在越界时触发通知，因此我将 AppDelegate 设置为符合 CLLocationManagerDelegate，创建了一个 locationManager 属性，并将其放入我的实现文件中：

```
- (BOOL)application:(UIApplication *)application willFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.locationManager.delegate = self;
    return YES;
}

- (CLLocationManager *)locationManager
{
    if (!_locationManager) {
        _locationManager = [[CLLocationManager alloc] init];
        _locationManager.desiredAccuracy = kCLLocationAccuracyHundredMeters;
    }
    return _locationManager;
}

- (void)locationManager:(CLLocationManager *)manager didEnterRegion:(CLRegion *)region
{
    UILocalNotification *notification = [[UILocalNotification alloc] init];
    notification.alertBody = NSLocalizedString(@"You crossed a boundary!", @"user crossed a boundary");
    [[UIApplication sharedApplication] presentLocalNotificationNow:notification];
} 
```

测试表明这无需设置 UIBackgroundModes 位置键即可工作。在这个用例中，操作系统会为您处理边界监控，然后将事件发送到您的应用程序，时间足以处理事件。这不会*启动*应用程序，它只是在后台运行它几秒钟以处理边界事件，在此期间您只能进行相关活动。希望这对其他人也有帮助！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-03T01:26:11.103

是的，它的行为方式相同，只是它会更频繁地接收更新（因此会消耗更多电池）。

来源：*跟踪用户位置*部分下的[应用程序状态和多任务处理](http://developer.apple.com/library/ios/#DOCUMENTATION/iPhone/Conceptual/iPhoneOSProgrammingGuide/ManagingYourApplicationsFlow/ManagingYourApplicationsFlow.html)。

 ***编辑**重新阅读后，似乎程序将从*暂停*状态中唤醒，而不是*终止*状态。不过，我不认为你真的需要这种后台模式。它专为需要精细位置信息的应用程序（如逐向导航）而设计。查看位置编程指南中有关“基于区域”编程的部分。您评论中的示例被列为此应用程序的用途之一。

**再次编辑**根据评论中的讨论，最终的解决方案似乎是设置显着的位置更改，直到用户足够近，然后切换到精细的位置更改（并希望应用程序在此期间不会终止^^ )

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-08-30T15:59:34.850

杀死应用程序后，位置更新将发送到应用程序

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions 
```

您需要通过查找启动密钥来收集此委托方法中的位置更新，如下所示，

```
if ([launchOptions objectForKey:UIApplicationLaunchOptionsLocationKey])
{
//Code to handle the location update
} 
```

希望这就是你要找的。是的，您需要在 plist 中设置键“所需的后台模式”，其值为“应用程序注册以进行位置更新”。*

# php - 谷歌浏览器的 PHP 修复确认表单重新提交弹出窗口

> ID：12239968
> 
> 赞同：0
> 
> 时间：2012-09-02T21:43:26.583
> 
> 标签：php, html, google-chrome

我正在尝试使用 POST 方法提交表单数据。但提交后，当我刷新页面时，会出现“确认表单重新提交”弹出窗口。现在我查看了该站点的其他一些答案，这些答案建议使用 GET（我不想使用 GET，仅 POST）或使用带有 Location: url 的标头进行重定向。我试过了，它仍然不能解决问题。

这对我来说可能是一个愚蠢的错误，所以我提前道歉。请从我下面的代码中指出问题所在。

提前致谢。

```
</head>

<body>

    <form action="PHPConfirmationResubmissionForm.php" method="POST">
        First name: <input type="text" name="fname" /><br />
        <input type="submit" value="Submit" />
    </form>

 <?

    if(isset($_POST["fname"]))
    {
        header('Location: http://localhost/web/PHP/PHPConfirmationResubmissionForm.php');

        $x = $_POST["fname"];
        echo "<br /> Firstname is $x";

    }

?>
</body> 
```

# json - JSONValue 失败。错误是：令牌的非法开始 [<]

> ID：12239974
> 
> 赞同：0
> 
> 时间：2012-09-02T21:44:26.607
> 
> 标签：json, ios4, runtime-error, sbjson

我是 JSON 解析的新手。我正在使用 SBJson 3.1 并尝试获取数据以响应我遇到的上述错误。我在谷歌上搜索了很多，但没有人问过或解释过错误的真正`Illegal Start of Token`含义。所以请有人可以解释一下吗？我该如何调试这个错误？

到目前为止我写的代码是：

```
-(IBAction) Start:(id)sender
{
responseData = [[NSMutableData data] retain];

    NSURLRequest *request = [NSURLRequest requestWithURL:[NSURL URLWithString:URL]];

    [[NSURLConnection alloc] initWithRequest:request delegate:self];
}

-(void) connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response
{
[responseData setLength:0];
}

-(void) connection:(NSURLConnection *)connection didReceiveData:(NSData *)data
{
[responseData appendData:data];
}

-(void) connection:(NSURLConnection *)connection didFailWithError:(NSError *)error
{
label.text = [NSString stringWithFormat:@"Connection failed: %@", [error description]];

[connection release];
responseData = nil;
}

-(void) connectionDidFinishLoading:(NSURLConnection *)connection
{
[connection release];

NSString *responseString = [[NSString alloc]  initWithData:responseData encoding:NSUTF8StringEncoding];

[responseData release];

NSDictionary *dict = [responseString JSONValue];

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T23:29:32.680

首先，而不是：

```
#define URL @"http://xyz...." 
```

并将其用作，

NSURLRequest *request = [NSURLRequest requestWithURL:[NSURL URLWithString:URL]];

我刚刚把它复制到：

NSURLRequest *request = [NSURLRequest requestWithURL:[NSURL URLWithString:http://xyz....]];

其次，问题是通过Web服务返回的json字符串不正确。当我打印响应数据时，它是这样的：

`<3c68746d 6c3e0a20 2020203c 68656164 3e0a2020 20203c2f 68656164 3e0a2020 20203c62 6f64793e 0a5b7b22 55736572 4964223a 2231222c 22557365 724e616d 65223a22 4d616861 20497a68.....>`

[这个](http://jsonlint.com/)链接帮助我理解了“Illegal Start of Token”是什么意思。

在 Web 服务上，编写以下内容：

```
<html><head></head><body>[
{
    "UserId": "1", ..... 
```

引发的错误是：

`Parse error on line 1: <html><head></head>< ^ Expecting '{', '['`

# c# - 如果未选中某些复选框，则使用复选框将文本保存到文件需要转到新行

> ID：12239977
> 
> 赞同：3
> 
> 时间：2012-09-02T21:45:18.957
> 
> 标签：c#, checkbox

我正在创建一个简单的程序来将笔记跟踪到文本文件中。除了复选框之外，我的一切都正常工作。我需要它，您可以在其中选择所需的复选框并将其写入同一行的文件。如果未选择复选框或仅选择其中一些复选框，它也会转到下一行。下面是我目前拥有的代码，到目前为止它工作正常，除非我在每个复选框语句上使用 Writeline，显然它会将每个复选框文本放在一个新行上。如果我只使用 Write 它可以工作，除了“tshooting_text.Text 与复选框文本在同一行结束。我对 C# 和一般编程有点陌生，所以如果我遗漏了一些简单的东西，请原谅我。无论如何这里是我到目前为止的代码。

```
private void copy_clipboard_button_Click(object sender, EventArgs e)
{

    //Starts the file writer
    using (StreamWriter sw = new StreamWriter("C:\\INET Portal Notes.txt"))
    {
        string CBRSame = cust_btn_text.Text;
        if (cbr_same.Checked)
        {
            cust_callback_text.Text = CBRSame;
        }

        //Writes textboxes to the file
        sw.WriteLine("**Name: " + cust_name_text.Text);
        sw.WriteLine("**BTN: " + cust_btn_text.Text);  
        sw.WriteLine("**CBR: " + cust_callback_text.Text);
        sw.WriteLine("**Modem: " + cust_modem_text.Text);
        //Statements to write checkboxes to file
        if (checkbox_pwr.Checked)
            sw.Write("**Lights: PWR, ");
        if (checkbox_e1.Checked)
            sw.Write("E1, ");
        if (checkbox_e2.Checked)
            sw.Write("E2, ");
        if (checkbox_e3.Checked)
            sw.Write("E3, ");
        if (checkbox_e4.Checked)
            sw.Write("E4, ");
        if (checkbox_wlan.Checked)
            sw.Write("WLAN, ");
        if (checkbox_dsl.Checked)
            sw.Write("DSL, ");
        if (checkbox_dslblink.Checked)
            sw.Write("DSL Blinking, ");
        if (checkbox_inet.Checked)
            sw.Write("INET, ");
        if (checkbox_inetred.Checked)
            sw.Write("INET RED, ");

        //Continues textboxes to file
        sw.WriteLine("**Troubleshooting: " + tshooting_text.Text);
        sw.WriteLine("**Services Offered: " + services_offered_text.Text);
        sw.WriteLine("**Other Notes: " + other_notes_text.Text);
        sw.Flush();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T21:48:57.220

```
 // ...
 if (checkbox_inetred.Checked)
        sw.Write("INET RED, ");

 sw.WriteLine (); // <--- this is new, means: insert line break

 //Continues textboxes to file
 sw.WriteLine("**Troubleshooting: " + tshooting_text.Text);

 // ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T22:09:50.930

我的建议如下：

1.  将所有`CheckBox`控件放在一个`Panel`控件中，我们称之为`pnlCheckBoxes`.
2.  将所需的指标输入到`CheckBox`' 的`Tag`属性（在设计时）。
3.  如果需要，请订购复选框。
4.  枚举所有复选框并为每个复选框编写输出文本。

这样，您将能够轻松添加/删除复选框，而无需修改代码以反映这些更改。

以下是如何在控件中订购复选框`Panel`（如果不确定，请确保不要修改其余代码）。修改文件中的代码`Form1.designer.cs`：

```
// 
// pnlCheckBoxes
//
// Rearrange the lines below to match the order you desire
this.pnlCheckBoxes.Controls.Add(this.checkBoxWlan);
this.pnlCheckBoxes.Controls.Add(this.checkBoxDsl);
// Leave the lines below intact.
this.pnlCheckBoxes.Location = new System.Drawing.Point(21, 110);
this.pnlCheckBoxes.Name = "pnlCheckBoxes";
this.pnlCheckBoxes.Size = new System.Drawing.Size(200, 100);
this.pnlCheckBoxes.TabIndex = 6; 
```

这是您的编写器功能的代码（在面板中放置复选框，`Tag`为它们分配属性并排列它们之后）：

```
private void copy_clipboard_button_Click(object sender, EventArgs e)
{
    //Starts the file writer
    using (StreamWriter sw = new StreamWriter("C:\\INET Portal Notes.txt"))
    {
        /* ... */

        //Statements to write checkboxes to file

        // This variable will store your whole line for check boxes.
        string checkBoxesLine = "**";

        // Enumerate all controls in panel.
        foreach (Control control in pnlCheckBoxes.Controls)
        {
            // Make sure the control is CheckBox, ignore others.
            if (control is CheckBox)
            {
                // Cast it to CheckBox variable, to make it easier to work with.
                CheckBox checkBox = (CheckBox)control;

                // Make sure it is checked, and if it is, make sure that the Tag property
                // has been set to string, so that we can get it's ID (WLAN, DSL, etc.).
                if (checkBox.Checked && checkBox.Tag is string)
                {
                    // Cast tag to string.
                    string checkBoxId = (string)checkBox.Tag;
                    // Append tag and comma to the end of the line.
                    checkBoxesLine += string.Format("{0}, ", checkBoxId);
                }
            }
        }

        // That's it, we have the whole line, write it as a new line.
        sw.WriteLine(checkBoxesLine);

        //Continues textboxes to file
        /* ... */ 
    }
} 
```

上面的代码可以缩短，但由于您是 C# 新手，所以我已尽力解释。

虽然答案有点超出了问题的范围，但我在这里演示了几个功能——枚举控件、转换对象、格式化字符串——我希望你会发现这些对你未来的 C# 项目很有用。

# node.js - 使用 async.waterfall 减少嵌套，但增加了混乱

> ID：12239982
> 
> 赞同：6
> 
> 时间：2012-09-02T21:46:06.613
> 
> 标签：node.js, node-async

我试图通过使用来减少异步调用（node + socket.io）的嵌套，但[`async.waterfall`](https://github.com/caolan/async#waterfalltasks-callback)我最终不得不将参数附加到瀑布下方，因为稍后需要它们。此代码可能会更好地解释：

// 原始版本：

```
 socket event: turn action
  socket.on('turn action', function(gameId, turnAction, clientFn) {
    socket.get('corp', function(err, corp) {
      gameProvider.processTurnAction(gameId, corp.id, turnAction, function(err, msg, game) {
        clientFn(msg, game);
      });
    });
  }); 
```

// async.js 版本

```
 async.waterfall([
    function(callback) {
      socket.on('turn action', function(gameId, turnAction, clientFn) {        
        callback(null, gameId, turnAction, clientFn);
      });
    },
    function(gameId, turnAction, clientFn, callback) {
      socket.get('corp', function(err, corp) {
        callback(null, gameId, turnAction, clientFn, corp);
      });
    },
    function(gameId, turnAction, clientFn, corp, callback) {
      gameProvider.processTurnAction(gameId, corp.id, turnAction, function(err, msg, game) {
        clientFn(msg,game);
      });
    }
  ]); 
```

目标是可读性，但我发现多余的参数传递会增加混乱。我知道我可以在调用 async.waterfall 之前声明变量并根据需要存储参数以供以后在链中使用，但这对可读性没有帮助。

有没有办法让它更优雅？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T22:09:53.303

我很好奇瀑布中设置`turn action`处理程序的第一个函数。因为它只是指定了一个事件处理程序，所以它在技术上是同步的（即使处理程序本身将被异步调用）。我可能会这样重构它：

```
socket.on('turn action', function(gameId, turnAction, clientFn) {
  async.waterfall([
    function(callback) { socket.get('corp', callback); },
    function(corp, callback) {
      gameProvider.processTurnAction(gameId, corp.id, turnAction, callback);
    }
  ], function(err, msg, game) {
    // err will be set if either of the two `callback`s were called with
    // an error as the first parameter
    clientFn(msg, game);
  });
} 
```

这具有将任何参数传递到最终回调的额外好处`error`，因此您可以根据需要处理它们（例如`clientFn`，使用指定错误的参数调用）。

# algorithm - 将RGB转换为光频率

> ID：12239986
> 
> 赞同：7
> 
> 时间：2012-09-02T21:47:02.403
> 
> 标签：algorithm, colors, physics, rgb, frequency

是否可以从 RGB 表示中获得颜色的光频率？我找到了相反的过程[1]，但我不知道这是否可能。

[1] [http://www.fourmilab.ch/documents/specrend/](http://www.fourmilab.ch/documents/specrend/)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-02T22:01:45.873

AFAIK，没有直接的答案，因为多个波长可以组合产生相同的颜色，对吗？因此，您拥有映射到纯色的波长，然后它们的组合可以产生许多其他相同的颜色。并且有几种组合可以提供相同的颜色。这是因为干扰。所以你本质上是在要求一个一对多的映射。

回答你的问题：没有固定的公式。反向公式将为您提供一个范围。这是它所能得到的最好的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-02T22:27:59.107

也许[Javascript - Sort rgb values](https://stackoverflow.com/questions/11923659/javascript-sort-rgb-values)可以帮助你。

但问题是波长光谱看起来像

![波长](../Images/febc4567456cce075a1d567a1d1c41d6.png)

您可以将 RGB 转换为 HSL，但 HSL 光谱看起来像

![HSL光谱](../Images/1a742c6b96cc78a47ac1d64a0eaa11d9.png)

然后，由于波长光谱不具有所有颜色，例如粉红色，因此存在问题。

我想那是因为自然界中不存在粉红色，它是光谱中相反极端颜色的组合。但我们有它在 RGB 中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T22:01:29.750

1.  从 RGB 转换为 XYZ
2.  从 XYZ 转换为 Yxy
3.  计算 xy 的主波长
4.  计算频率

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-03T04:11:52.060

查看链接引用的 C 程序，只有 81 个不同频率的 color_match 值 - 这些似乎是链接中图 3 边缘周围的标记频率。因此，如果您知道您的 RGB 信息是针对一种频率的纯光，您可以计算出这些值中的每一个的 RGB 信息，并查看它最匹配的值 - 可能在缩放一个或另一个以使亮度匹配之后。

当然，问题在于您的 RGB 值可能来自不同频率的光的混合。在这种情况下，您将得到一个来自图 3 内部的点 - 它不会接近外部的任何值（因此至少您将能够判断存在问题）并且会有是可能产生它的大量可能的频率集 - 这些对应于图表外部点的加权平均值，这些点平均产生内部点。

# python - 如何用我自己的方法使用`wx.ProgressDialog`？

> ID：12239990
> 
> 赞同：2
> 
> 时间：2012-09-02T21:47:20.317
> 
> 标签：python, user-interface, wxpython

如何使用`wx.ProgressDialog`我的方法调用的时间`imgSearch`？该`imgSearch`方法在用户的 pc 上查找图像文件。如何在仍在运行的`wx.ProgressDialog`同时进行运行并显示需要多长时间？`imgSearch``imgSearch`

这是我的代码：

```
def onFind (self,event)# triggered by a button click
    max = 80
    dlg = wx.ProgressDialog("Progress dialog example","An informative message",parent=self, style = wx.PD_CAN_ABORT| wx.PD_APP_MODAL| wx.PD_ELAPSED_TIME| wx.PD_REMAINING_TIME)

    keepGoing = True
    count = 0
    imageExtentions = ['*.jpg', '*.jpeg', '*.png', '*.tif', '*.tiff']
    selectedDir = 'C:\\'
    imgSearch.findImages(imageExtentions, selectedDir)# my method

    while keepGoing and count < max:

    count += 1
    wx.MilliSleep(250)

    if count >= max / 2:
        (keepGoing, skip) = dlg.Update(count, "Half-time!")
    else:
        (keepGoing, skip) = dlg.Update(count)

    dlg.Destroy() 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-03T03:26:05.997

# 问题

您的问题含糊不清，但在查看您的代码后，我猜您的问题是`imgSearch.findImages()`在对话框甚至打开之前就完成了。如果您可以编辑您的问题，我将不胜感激，以便我知道这是否正确。

我看到您正在使用[本教程](http://www.blog.pythonlibrary.org/2010/07/10/the-dialogs-of-wxpython-part-2-of-2/)中的代码向您展示如何使用`wx.ProgressDialog`. 不幸的是，您对此采取了一种相当幼稚的方法。该教程的目的是向读者介绍各种内置对话框。因此，该`wx.ProgressDialog`示例是一个简单的示例，只是为了向您展示方法，而不是用作实现。

# 背景资料

首先，您需要了解什么是[多线程](http://en.wikipedia.org/wiki/Multithreading_%28software%29#Multithreading)以及它是如何工作的。计算机所做的一切都分解为一系列数学运算。计算机处理器一次只能执行一项操作。因此，计算机一次只能做一*件事*。现在您可能会想“这不是真的。我在浏览互联网时正在听 MP3。这至少是两件事”。好吧，你是对的，你错了。想象一个厨师。厨师可以一次准备很多菜，**但**他一次只能注意一道菜。因此，他必须在菜肴之间切换，执行一些小任务，直到它们都完成。这就是计算机[多任务处理](http://en.wikipedia.org/wiki/Computer_multitasking)的方式。而不是“菜”，

# 解决方案

## 第 1 步：穿线

默认情况下，wxPython 只是一个线程（这并不完全正确，但随它去吧）。wxPython 逐行运行您的代码，这样一行必须在下一行运行之前完全完成。因此，在`imgSearch.findImages()`运行时没有其他代码在执行，它必须在`wx.ProgressDialog`创建之前完成。好消息是有几种方法可以解决这个问题。坏消息是解决这个问题可能会变得相当复杂。我不是专家，但我建议搜索“wxpython threading”并尝试查找一些教程。我找到[了这个教程](http://wiki.wxpython.org/LongRunningTasks)，但它已经相当老了。要点是你需要`imgSearch.findImages()`在它自己的线程中运行，这样它就不会*阻塞*GUI。

## 第 2 步：指标

那么现在，您如何使`wx.ProgressDialog`反映的实际状态`imgSearch.findImages()`？嗯，这取决于。您需要找到一些*指标*来帮助您衡量已经完成了多少工作以及还有多少工作要做。在您的代码中，度量标准是时间，因为进度被编程为`80 * 250ms = 20s`. 时间可能不是你想要的。您需要决定什么最适合您的程序，但我将使用“文件夹数量”的示例，因为它很容易理解。我将计算文件夹的总数以及我完全扫描的文件夹的数量。现在有两种方法可以初始化您的指标。你可以计算`max`如果数字很小或易于计算（例如时间），则需要，或者您可以采用动态方法。就我而言，准确计算“文件夹数量”需要的时间几乎与图像搜索本身一样多，因此动态是最佳选择。所以，我会修改`imgSearch.findImages()`，以便它记录它看到的文件夹数量以及它扫描的文件夹数量（例如，如果我的起始位置有 3 个文件夹，我从 3/0 开始。我开始扫描第一个文件夹本身又包含 2 个文件夹，所以我现在有 5/0。每次我完全扫描一个文件夹时，我将扫描的文件夹数加 1，即扫描一个文件夹后的 5/1。）。知道我已经扫描了多少个文件夹以及我还剩下多少个文件夹要扫描，我可以使用`# of folders scanned / total # of folders`.`1 / 5 = 0.20`，因此我估计我完成了 20%（请注意，如果我扫描的下一个文件夹包含 5 个以上的文件夹，那么这个数字会自动减少到 10%。这就是为什么我称 20% 为估计值）

## 第 3 步：更新

所以现在我们应该有`imgSearch.findImages()`它自己的线程，它应该能够估计它离完成还有多远。现在我们需要更新`wx.ProgresDialog`. 对于这些类型的问题，我最喜欢的方法是使用[pubsub](http://wiki.wxpython.org/WxLibPubSub)库。基本上，`imgSearch.findImages()`线程必须偶尔发送一条消息，说明它有多接近完成。也许在每个文件夹的末尾。也许曾经三个文件夹。由你决定。接下来，您需要在主 GUI 线程中创建一个方法，该方法可以读取这些消息并`wx.ProgressDialog`进行相应更新。

工作量很大，但我祝你好运。

# java - 为什么原生 String getBytes 方法比自定义实现的 getBytesFast 慢？

> ID：12239993
> 
> 赞同：6
> 
> 时间：2012-09-02T21:48:21.820
> 
> 标签：java, performance, optimization

运行以下代码时，Java String 的本机方法**getBytes()**的执行似乎比自定义**getBytesFast()实现****慢**。您可以使用来验证两个字节数组是否相等。**`Arrays.equals(str.getBytes(), getBytesFast(str))`**

 **getBytesFast 实现是此编程技巧文章 (1997) 中包含的实现的修改版本：http: [//java.sun.com/developer/technicalArticles/Programming/Performance/](http://java.sun.com/developer/technicalArticles/Programming/Performance/)

我正在寻找一个有据可查的答案，说明为什么本机实现比自定义实现慢。

```
package com.test;

public class Performance {

    public static void main(String args[]) {

        final String str = "This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test! This is a performance test!";

        long startTime_1 = System.nanoTime();
        str.getBytes();
        System.out.println(System.nanoTime() - startTime_1);

        long startTime_2 = System.nanoTime();
        getBytesFast(str);
        System.out.println(System.nanoTime() - startTime_2);
    }

    private static byte[] getBytesFast(String str) {
        final char buffer[] = new char[str.length()];
        final int length = str.length();
        str.getChars(0, length, buffer, 0);
        final byte b[] = new byte[length];
        for (int j = 0; j < length; j++)
            b[j] = (byte) buffer[j];
        return b;
    }
} 
```

**编辑：**

卡尺基准测试结果

![在此处输入图像描述](../Images/ebfbde88a3b5d1a751773529ceef0d3e.png)

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-02T22:17:06.203

根据 [the documentation]，`char`Java 中的类型是 16 位 Unicode 字符，而`byte`类型是 8 位有符号整数。这意味着在您的代码中进行的每次转换`char`都会**丢弃一半的字符数据。**`byte`

 **[关于字符和字节流](http://docs.oracle.com/javase/tutorial/i18n/text/stream.html)的Java 教程有一个很好的使用日文汉字的小示例字符串：

```
String jaString = new String("\u65e5\u672c\u8a9e\u6587\u5b57\u5217"); 
```

对于该字符串中的每个字符，您的快速转换方法将丢弃信息的第一个字节（例如`65`in `\u65e5`）。[您的链接](http://java.sun.com/developer/technicalArticles/Programming/Performance/)还特别提到`String.getBytes()`运行速度要慢几倍，“因为前者进行了正确的字节到字符转换，*这涉及每个字符的函数调用。* ”

如果您完全忽略字符编码并丢弃每个字符的高阶字节，`char`那么您将获得一点加速。您只需要记住，此方法仅适用于某些字符编码，并且有可能丢失数据。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-09-02T21:59:11.883

[`String.getBytes`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#getBytes%28%29)考虑到系统的默认字符集。您的实施假定[ISO-8859-1](http://en.wikipedia.org/wiki/ISO/IEC_8859-1)。

`String.getBytes`最终最终调用了这个方法。`ce`是一个[`CharsetEncoder`](http://docs.oracle.com/javase/7/docs/api/java/nio/charset/CharsetEncoder.html)。

```
byte[] encode(char[] ca, int off, int len) {
        int en = scale(len, ce.maxBytesPerChar());
        byte[] ba = new byte[en];
        if (len == 0)
            return ba;
        if (ce instanceof ArrayEncoder) {
            int blen = ((ArrayEncoder)ce).encode(ca, off, len, ba);
            return safeTrim(ba, blen, cs, isTrusted);
        } else {
            ce.reset();
            ByteBuffer bb = ByteBuffer.wrap(ba);
            CharBuffer cb = CharBuffer.wrap(ca, off, len);
            try {
                CoderResult cr = ce.encode(cb, bb, true);
                if (!cr.isUnderflow())
                    cr.throwException();
                cr = ce.flush(bb);
                if (!cr.isUnderflow())
                    cr.throwException();
            } catch (CharacterCodingException x) {
                // Substitution is always enabled,
                // so this shouldn't happen
                throw new Error(x);
            }
            return safeTrim(ba, bb.position(), cs, isTrusted);
        }
    }
}

private static int scale(int len, float expansionFactor) {
    // We need to perform double, not float, arithmetic; otherwise
    // we lose low order bits when len is larger than 2**24.
    return (int)(len * (double)expansionFactor);
}

private static char[] safeTrim(char[] ca, int len,
                               Charset cs, boolean isTrusted) {
    if (len == ca.length && (isTrusted || System.getSecurityManager() == null))
        return ca;
    else
        return Arrays.copyOf(ca, len);
} 
```

使用 a 涉及更大程度的复杂性`CharsetEncoder`，这*可能*导致您看到的执行时间较慢。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-02T21:53:24.907

这可能是因为`String.getBytes()`使用或委托给一个字符集（JVM 当前的默认字符集），而您的“快速”实现只是硬编码的 ISO-8859-1 字符集。

（注意：我没有验证您的结果，我只是在这里陈述我的假设。与微基准测试相关的评论在这里非常重要，而且绝对比我对您的问题的回答更有价值：）****

# php - 如何使用 php 和 mysql 创建带有子菜单的动态菜单

> ID：12239995
> 
> 赞同：2
> 
> 时间：2012-09-02T21:48:38.757
> 
> 标签：php, mysql

我想要一个使用 php 和 mysql 从表中提供的动态菜单。

我的表如下所示：

```
sec_id  sec_name    sec_group
1   section 1   group 1
2   section 2   group 1
3   section 3   group 2
4   section 4   group 1
5   section 5   group 3 
```

我可以进行查询以获取和显示唯一的 sec_group 值，但无法找到将 sec_name 包含到每个 sec_group 中的方法

```
//Query by unique sec_group
$qry_secs="SELECT DISTINCT sec_group FROM tbl_user_sec ORDER BY sec_id ASC";
$result_secs = mysql_query($qry_secs);

//echo values
while($row_secs = mysql_fetch_assoc($result_secs)){
 echo '<ul><li><a href="#">'.$row_secs['sec_group'].'</a></li></ul>';
} 
```

最终，HTML 应该像下面的代码。

```
<ul>
<li><a href="#">Group 1</a>
  <ul>
  <li><a href="#">Section 1</a></li>
  <li><a href="#">Section 2</a></li>
  <li><a href="#">Section 4</a></li>
  </ul>
</li>

<li><a href="#">Group 2</a>
  <ul>
  <li><a href="#">Section 3</a></li>
  </ul>
</li>

<li><a href="#">Group 3</a>
  <ul>
  <li><a href="#">Section 5</a></li>
  </ul>
</li>
</ul> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T22:05:44.583

```
$q = mysql_query("SELECT sec_id, sec_name, sec_group FROM tbl_user_sec ORDER BY sec_id");

// prepare data 
$groups = Array();
while($w = mysql_fetch_assoc($q)) {
  if(!isset($groups[$w['sec_group']])) $groups[$w['sec_group']] = Array();
  $groups[$w['sec_group']][] = $w;
}

// display data
echo "<ul>";
foreach($groups as $group_name => $sections) {
  echo '<li><a href="#">'.$group_name.'</a><ul>';
  foreach($sections as $section) {
    echo '<li><a href="#">'.$section['sec_name'].'</a>';
  }
  echo '</ul></li>';
}
echo "</ul>"; 
```

如果您不关心排序结果，还有[另一种解决方案](http://codepad.org/oxvpznQP)`sec_id`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T22:00:58.673

```
$qry_secs="SELECT DISTINCT sec_group FROM tbl_user_sec ORDER BY sec_id ASC";
$result_secs = mysql_query($qry_secs);
echo '<ul>\n';
//echo values
while($row_secs = mysql_fetch_assoc($result_secs)) {
    echo '<li><a href="#">'.$row_secs['sec_group'].'</a></li>\n';
    echo '<ul>\n';
    $newqry = "SELECT sec_name FROM tbl_user_sec WHERE `sec_group` = '" . mysql_real_escape_string($row_secs['sec_group'] . "'";
    $result = mysql_query($newqry);
    while($row = mysql_fetch_assoc($result) ) {
        echo '<li><a href="#">' . $row['sec_name'] . '</li>\n';
    echo '</ul>\n';
}
echo '</ul>\n'; 
```

# javascript - 在 node.js 中使用 JavaScript 从 JSON 对象获取和设置文本内容

> ID：12239996
> 
> 赞同：1
> 
> 时间：2012-09-02T21:48:39.043
> 
> 标签：javascript, xml, json, parsing, node.js

背景信息：我正在使用 node.js，这是一个服务器端脚本。

话虽这么说，这就是问题所在。我有一个 JSON 对象`result`，使用`eyes.inspect()`时看起来像

```
{
user: [
    {
        foods: {
            food: [
                {
                    #: 'McDonalds',
                    @: { type: 'string' }
                },
                {
                    #: 'Seafood Topped Salmon',
                    @: { type: 'string' }
                }
            ]
        },
        email: '****@******.edu',
        name: 'Leo'
    },
    {
        email: '****@******.edu',
        food-list: {
            food: [
                {
                    #: 'KFC',
                    @: { type: 'string' }
                },
                {
                    #: 'KGC',
                    @: { type: 'string' }
                }
            ]
        },
        name: 'Eric'
    }
]
} 
```

调用`console.log(result.user[0].foods.food[1])`时，输出为`{ '#': 'Seafood Topped Salmon', '@': { type: 'string' } }`

那么有没有办法像`Seafood Topped Salmon`去掉 type 属性一样获取和设置节点的文本内容？

更多信息：JSON 实际上是从 XML 文档中解析出来的。在原始 xml 文件中，食物节点看起来像`<food type="string">McDonalds</food>`. 我必须保留该`type="string"`属性，在完成 JSON 对象的编辑后，我会将其解析回 xml。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T22:52:48.470

您可以直接访问该嵌入对象的文本以获取并将其设置为：

```
result.user[0].foods.food[1]['#'] 
```

# android - 根据id查找listview位置

> ID：12239999
> 
> 赞同：2
> 
> 时间：2012-09-02T21:49:10.423
> 
> 标签：android, android-listview, android-cursoradapter

我有一个 ListView 显示来自 SimpleCursorAdapter 的数据。我有 id 值，我想要列表中的位置，与 getItemId(position) 相反。有这样的功能吗？

我知道如何实现它（不要打扰显示代码），但我找不到它，这似乎是一个显而易见的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T23:10:51.183

**从评论中提出**

内置适配器没有这样的方法。如果您的 ListView 是按行 ID 排序的，那么您可以使用二进制搜索（快！），否则您可能会遇到详尽的搜索（慢...）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-24T06:35:55.780

简单的解决方案是将 id 设置为绑定视图中的子项

```
@Override
public void bindView(View view, final Context context, Cursor cursor {
      ..... 
      convertView.setId(id);
} 
```

稍后从活动中您可以通过 id 找到此视图并获取位置

```
View yourChildViewWithSpecifiedId = yourListView.findViewById(id);
int position = yourListView.getPositionForView(yourChildViewWithSpecifiedId); 
```