# StackOverflow 问答 10141000-10141999

# svn - SVN：你能把一个签到合并到另一个分支吗？

> ID：10141001
> 
> 赞同：4
> 
> 时间：2012-04-13T12:39:08.840
> 
> 标签：svn, merge, checkin

我知道你可以将两个分支合并在一起，但是单次签到呢？

例如，我过去曾使用 SourceGear Vault 来合并签到。如果我修改了项目中的多个文件并一次将它们全部签入，即使它包含多个文件，这也被视为一次签入。如果我只想将这些更改合并到另一个分支而不合并可能包含我不想合并的其他人更改的整个分支*，*我可以只合并我签入的文件。

我可以用 SVN 做到这一点吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-16T18:59:19.070

当两个人已经提供了可能是合法的答案时，我可能会因为回答我自己的问题而被拒绝，但我发现了一种使用 TortoiseSVN 的 Windows 资源管理器集成的无命令行方式来做到这一点。我按照以下步骤操作：

*   在 Windows 资源管理器中，我右键单击包含与 DESTINATION 分支相关联的项目的文件夹，然后选择 TortoiseSVN > Merge。
*   在弹出的对话框中，我选择了“合并一系列修订”
*   在下一个窗口中，我选择了包含我要合并的更改的 SOURCE 存储库分支，然后单击`Show log`以获取签入的修订号
*   我做了一个测试合并以确保它有效，之后我继续合并，检查了我的 VS 2010 项目的工作副本，我所有的代码都在那里！

FWIW，我对其他人投了赞成票。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-15T13:17:56.387

是的。请参阅[“樱桃采摘”的手册部分。](http://svnbook.red-bean.com/nightly/en/svn.branchmerge.advanced.html#svn.branchmerge.cherrypicking)

# drupal - Formatting Drupal Views RSS feed for chrome

> ID：10141004
> 
> 赞同：0
> 
> 时间：2012-04-13T12:39:22.757
> 
> 标签：drupal, rss, drupal-views

Can someone please help me out. I'm looking for a way to force chrome to display my rss feed in a more user friendly way. I know chrome doesnt support this by default but I've seen websites like BBC (http://feeds.bbci.co.uk/shared/bsp/xsl/rss/nolsol.xsl) doing it.

I'm using drupal 7 views to generate the rss feed so anything I do will need to be done by modifying the views-view-rss.tpl.php file which looks as follows:

```
<?php print "<?xml"; ?> version="1.0" encoding="utf-8" <?php print "?>"; ?>
<rss version="2.0" xml:base="<?php print $link; ?>"<?php print $namespaces; ?>>
<channel>
<title><?php print $title; ?></title>
<link><?php print $link; ?></link>
<description><?php print $description; ?></description>
<language><?php print $langcode; ?></language>
<?php print $channel_elements; ?>
<?php print $items; ?>
</channel>
</rss> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T07:33:11.567

您可能想要使用 XSL，这需要对该视图模板进行微小的更改......以及大量的 XSL。

```
<?php print "<?xml"; ?> version="1.0" encoding="utf-8" <?php print "?>"; ?>
<?xml-stylesheet href="/css/rss20.xsl" type="text/xsl"?>
<rss version="2.0" xml:base="<?php print $link; ?>"<?php print $namespaces; ?>> 
```

我发现 XSL 令人讨厌，但您可能只是基于您在网络上找到的东西。您的 BBC 链接是一个好的开始，或者《纽约时报》也有一个很好的链接：查看源：http://feeds.nytimes.com/css/rss20.xsl

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T13:16:00.540

您始终可以使用`view-source:`前缀，它将适用于每个提要。

例如，如果您的提要有 url `http://feeds.guardian.co.uk/theguardian/rss`，您可以`view-source:http://feeds.guardian.co.uk/theguardian/rss`在 Chrome 的地址栏中输入，它会向您显示其完整的 XML。

此外，当查看格式化的提要时（点击页面上的 RSS 图标/链接后），右上角有一个“提要”链接（在“提要预览”蓝色条上），它会将您带到完全相同的`view-source:`页面.

# asp.net - Make pdf editable in asp.net C#

> ID：10141005
> 
> 赞同：-4
> 
> 时间：2012-04-13T12:39:22.903
> 
> 标签：asp.net

I have a PDF or Image . in this i can write something, draw line , high light sentences then download it .

how to Achieve this.

thanks in advance

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T12:48:11.537

那么PDF和图像是两个不同的东西。

我知道这是一个糟糕的建议，但你真的应该快速搜索“.net pdf library”。您将找到数十个付费和免费代码库，用于创建和操作 PDF 文档，其中包含大量关于如何使用它们的非常好的文档。

同样，对于图像，也有很多很多用于图像处理的 .net 库。

# sql - Aggregate results based on where clause using SQLite

> ID：10141006
> 
> 赞同：1
> 
> 时间：2012-04-13T12:39:23.847
> 
> 标签：sql, grouping, where-clause

I have a query that counts records based on various criteria, but I would like to split the results into two grouped fields based on said criteria. Is there a way to do this inside the query - or is it necessary to have two queries?

```
select count(PT_TASK_ASSAY_DISP) as 'Count' from vbasedata v
where 
    v.PT_TASK_ASSAY_DISP like 'SS%' or
    (v.PT_TASK_ASSAY_DISP like 'IP%' and
    v.PT_TASK_ASSAY_DISP not like 'IP CUT' and
    v.PT_TASK_ASSAY_DISP not like 'IP NEG'); 
```

I'm trying to group by IP and SS to get a total count.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T12:52:17.400

我不确定你想要什么。但是，如果您希望每个“SS%”计数一个，“IP%”一个计数。然后可能是这样的：

```
select 
    SUM(CASE WHEN PT_TASK_ASSAY_DISP LIKE 'SS%' THEN 1 ELSE 0 END) as SSCount,
    SUM(CASE WHEN PT_TASK_ASSAY_DISP LIKE 'IP%' THEN 1 ELSE 0 END) as IPCount 
from vbasedata v
where 
    v.PT_TASK_ASSAY_DISP like 'SS%' or
    (v.PT_TASK_ASSAY_DISP like 'IP%' and
    v.PT_TASK_ASSAY_DISP not like 'IP CUT' and
    v.PT_TASK_ASSAY_DISP not like 'IP NEG'); 
```

# google-maps - Preventing shift key from setting map into zoom mode

> ID：10141007
> 
> 赞同：2
> 
> 时间：2012-04-13T12:39:26.943
> 
> 标签：google-maps, google-maps-api-2, keydragzoom

we have the following problem in a legacy (GMaps V2) application: we show a info window upon clicking on a marker. A pop-up is displayed and the user enters an annotation. If the user presses the shift key (for capitalizing letters), the map goes into "zoom mode" (the hand cursor changes into the arrow cursor, and, should the user move the mouse cursor outside the info window, he sees the red rubber-band rectanlge for zooming). Upon closing the window, the map is stuck in the zoom mode, with the red zoom rectangle showing. This only goes away after the user clicks, drags and the map zooms.

Is there a way to prevent the shift key to set the map mode? (I had a look at the KeyDragZoom library, but this didn't solve the problem.) I also tried many workaround for canceling the events, stop bubbling etc, to no avail.

Thanks in advance

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T13:07:28.220

通过这种方式，您可以禁用键盘输入：

```
 var ui = map.getDefaultUI();
 ui.keyboard = false;
 map.setUI(ui); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T09:18:48.793

查看[参考文档](http://gmaps-utility-library-dev.googlecode.com/svn/trunk/keydragzoom/docs/reference.html)。您可以指定`key`哪个激活拖动缩放：

> key String 按住以激活拖动缩放的热键，shift | 控制 | alt。请注意，altshift。

所以，我会尝试将其设置为`null`or `"alt"`。

# javascript - Ordering JSON with Javascript

> ID：10141012
> 
> 赞同：2
> 
> 时间：2012-04-13T12:39:35.517
> 
> 标签：javascript, json, sorting

Considering I have the following JSON, how could I generate another JSON, ordering by a field (let's say `anoCobranca`)?

```
{
  "extratos": [
    {
      "descricao":         "product A",
      "anoCobranca":       2012,
      "mesCobranca":       01,
      "nomeMesCobranca":   "Janeiro",
      "diaUsoInicial":     1,
      "diaUsoFinal":       30,
      "valor":             "236.81",
      "vencimento":        "24/01/2012",
      "formaPagamento":    "Cartão",
      "situacao": "ok"
    },
    {
      "descricao":         "product B",
      "anoCobranca":       2012,
      "mesCobranca":       2,
      "nomeMesCobranca":   "Fevereiro",
      "diaUsoInicial":     1,
      "diaUsoFinal":       29,
      "valor":             "249.81",
      "vencimento":        "24/02/2012",
      "formaPagamento":    "-",
      "situacao":          "aberto"
    },
    {
      "descricao":         "product 1",
      "anoCobranca":       2012,
      "mesCobranca":       3,
      "nomeMesCobranca":   "Março",
      "diaUsoInicial":     1,
      "diaUsoFinal":       31,
      "valor":             "339.11",
      "vencimento":        "24/03/2012",
      "formaPagamento":    "Cartão",
      "situacao":          "ok"
    },
    {
      "descricao":         "product D",
      "anoCobranca":       2011,
      "mesCobranca":       4,
      "nomeMesCobranca":   "Abril",
      "diaUsoInicial":     1,
      "diaUsoFinal":       30,
      "valor":             "119.18",
      "vencimento":        "24/04/2012",
      "formaPagamento":    "Cartão",
      "situacao":          "ok"
    },
    {
      "descricao":         "product E",
      "anoCobranca":       2011,
      "mesCobranca":       5,
      "nomeMesCobranca":   "Maio",
      "diaUsoInicial":     1,
      "diaUsoFinal":       30,
      "valor":             "81.29",
      "vencimento":        "24/05/2012",
      "formaPagamento":    "-",
      "situacao":          "aberto"
    }
  ]
} 
```

I've tried a few techniques like:

```
function sortJSON(a,b){
  return parseInt(a.json.extratos.anoCobranca - b.json.extratos.anoCobranca)
} 
```

And a few others I found here, at StackOverflow, but all of them failed.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-13T12:42:45.953

Sort the array with a callback function :

```
obj.extratos.sort(function(a, b) {
  return a.anoCobranca - b.anoCobranca;
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T12:53:24.527

使用[下划线](http://documentcloud.github.com/underscore/)，您可以：

```
_(obj.extratos).pluck(propertyName).sort() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-13T12:49:59.447

如果您不反对使用外部库，那么我建议您使用[Underscore.js](http://underscorejs.org/)来解决这个问题和类似问题。这是我在下面一行中执行此操作的示例：

```
var model = {
  "extratos": [
    {
      "descricao":         "product A",
      "anoCobranca":       2012,

            .
            .
            .

      "situacao":          "aberto"
    }
  ]
};

model.extratos = _.sortBy(model.extratos, 
                   function (extrato) { return extrato.anoCobranca; });

console.log(model); 
```

这是一个 jsFiddle，您可以在其中玩：http: [//jsfiddle.net/JohnMunsch/4eE2F/](http://jsfiddle.net/JohnMunsch/4eE2F/)

Yanick 的解决方案也是一个不错的解决方案，但我认为 Underscore 库具有广泛的功能（例如 map 和 reduce），可以帮助您解决一组复杂的数据操作问题，而不仅仅是简单的排序。

# mysql - mySQL Trigger returns error

> ID：10141015
> 
> 赞同：1
> 
> 时间：2012-04-13T12:39:40.493
> 
> 标签：mysql, sql, triggers

I am trying to set up a trigger on a table to copy the contents of a row into another table.

I have the following:

```
CREATE TRIGGER story_deleted BEFORE DELETE ON stories 
  FOR EACH ROW BEGIN
    INSERT INTO stories_backup SET story_id = OLD.story_id;  
  END; 
```

This returns the following error though:

`1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' at line 3`

I can't work out where I'm going wrong with this. Any ideas?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T18:17:38.253

尝试更改分隔符

```
DELIMITER $$

CREATE TRIGGER story_deleted BEFORE DELETE ON stories  
  FOR EACH ROW
  BEGIN 
    INSERT INTO stories_backup SET story_id = OLD.story_id;   
  END $$

DELIMITER ; 
```

就您的权限而言，运行此查询

```
SHOW GRANTS; 
```

如果 SUPER 不存在，你可以

*   请求您的 DBA 为您添加该权限
*   让您的 DBA 为您创建触发器

# jquery - Jquery - 使用父高度垂直居中。有点

> ID：10141017
> 
> 赞同：0
> 
> 时间：2012-04-13T12:39:55.187
> 
> 标签：jquery, css, image, center

所以，我有 X 数量的图像在 a 中垂直居中`<ul><li><a> <img> </a></li></ul>`（下面 jquery 中的类名是实际的`<img>`）。这工作得很好，但是......它只取第一个值并将其应用于其余图像，导致第一个被居中而其他人不是。

我可能会补充一点，所有图像的高度和宽度都不同。到目前为止，只需`text-align: center;`在锚标签上使用即可处理宽度

```
$(window).load(function(){
    var parent_height = $('.tv-list-channel-logo').parent().height();
    var image_height = $('.tv-list-channel-logo').height();
    var top_margin = (parent_height - image_height)/2;
    $('.tv-list-channel-logo').css( 'margin-top' , top_margin);
}); 
```

盯着这个已经有一段时间了，我肯定错过了一些明显的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T12:44:32.473

如果图像需要不同的值，您需要遍历它们。尝试使用`$('.tv-list-channel-logo').each( function... )`. Inside `.each`，`this`指的是当前元素。

编辑：这是一个例子`.each`：

```
// `.each` takes each selected element and calls the callback on each one
$('.tv-list-channel-logo').each( function( ) {
    // `this` refers to the current .tv-list-channel-logo element
    var parent_height = $(this).parent().height();
    var image_height = $(this).height();
    var top_margin = (parent_height - image_height)/2;
    $(this).css( 'margin-top' , top_margin);
    // I just replaced all instances of `'.tv-list-channel-logo'` with `this`
} ); 
```

# regex - RedirectMatch in mod_rewrite doesn't work as expected

> ID：10141025
> 
> 赞同：0
> 
> 时间：2012-04-13T12:40:17.763
> 
> 标签：regex, apache, mod-rewrite, redirect

I'm driving crazy about this, but I'm sure it's only a small thing..

All I'm trying to do is redirecting https server traffic to another website in my virtual hosts config file:

```
<VirtualHost 127.0.0.1:443>
  ServerName somewebsite.ch
  RewriteEngine on
  RedirectMatch 301 ^client$ https://someotherwebsite.com/client
  RedirectMatch 301 ^/client$ https://someotherwebsite.com/client
</VirtualHost> 
```

However, this doesn't seem to work, it looks like the page tries to load the content of the other website, but the Adress Field in the browser still shows the old URL, and the browser body is empty..

Thanks for your help.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T18:16:53.853

您是否尝试过在末尾添加斜杠？您的配置不匹配，例如 /client/

```
 RedirectMatch 301 ^/client/$ https://someotherwebsite.com/client 
```

如果 URL 在*client*之后继续，您可以这样做：

```
 RedirectMatch 301 ^/client(.*)$ https://someotherwebsite.com/client$1 
```

# objective-c - Tabbar is not showing OR screen does not reconize touches

> ID：10141029
> 
> 赞同：0
> 
> 时间：2012-04-13T12:40:47.820
> 
> 标签：objective-c, xcode, ios5

i'm using this code for a tabbar, but the tabbar is not showing

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{

    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];

    UITabBarController *tabController = [[UITabBarController alloc] init];

    UIViewController *viewController1 = [[UIViewController alloc] init];

    UIViewController *viewController2 = [[UIViewController alloc] init];

    UIViewController *viewController3 = [[UIViewController alloc] init];

    UIViewController *viewController4 = [[UIViewController alloc] init];

    tabController.viewControllers = [NSArray arrayWithObjects:viewController1,
                                     viewController2,
                                     viewController3,
                                     viewController4, nil];

    self.window.rootViewController = tabController;

    UIViewController *rootController = 
    [[xTableViewController alloc] 
     initWithNibName:@"xTableViewController" bundle:nil];

    navigationController = [[UINavigationController alloc]
                            initWithRootViewController:rootController];

    self.window = [[UIWindow alloc] 
                   initWithFrame:[[UIScreen mainScreen] bounds]];
    [self.window addSubview:navigationController.view];

    [self.window makeKeyAndVisible];
    return YES;
} 
```

When i remove this line:

```
self.window = [[UIWindow alloc] 
                       initWithFrame:[[UIScreen mainScreen] bounds]]; 
```

The tabbar show's up but i cant 'touch' my screen (i cant touch my screen but the tabbar is 'touchable' because nothing is working, does anyone know how to display the tabbar on a normal way?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T12:45:32.007

好像您正在初始化窗口两次。首先使用 UITabbarContorller，然后使用 UINavigationController。尝试

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    UITabBarController *tabController = [[UITabBarController alloc] init];
    UIViewController *viewController1 = [[UIViewController alloc] init];
    UIViewController *viewController2 = [[UIViewController alloc] init];
    UIViewController *viewController3 = [[UIViewController alloc] init];
    UIViewController *viewController4 = [[UIViewController alloc] init];
    tabController.viewControllers = [NSArray arrayWithObjects:viewController1,
                                 viewController2,
                                 viewController3,
                                 viewController4, nil];

    self.window.rootViewController = tabController;
    [self.window makeKeyAndVisible];
    return YES;
} 
```

# c# - Group By List

> ID：10141030
> 
> 赞同：0
> 
> 时间：2012-04-13T12:40:49.050
> 
> 标签：c#, linq, list, group-by

I have this class:

```
public class Item 
{
    public virtual int32 Id { get; set; }
    public virtual Previa Previa { get; set; }
    public virtual Product Product { get; set; }
    public virtual Int32 Quantity { get; set; }
    public virtual Decimal Price { get; set; }
    public virtual Decimal Total { get; set; }
} 
```

And now i need to a query to find every Items in database, group by Products, with the sum of Quantity and Total. For find every Items, i use:

```
public List<Item> FindItem(int IdProduct = 0)
{
    var retorno = (from c in Session.Query<Item>()
                   select c);

    if (IdProduto > 0)
        retorno = retorno.Where(x => x.Product.Id == IdProduct)

    return retorno.ToList<Item>();
} 
```

But I don't know how to group these items. Could someone please help me?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-13T12:45:51.657

您的问题还很不清楚，但*听起来*您想要一个查询，例如：

```
var query = from item in Session.Query<Item>()
            group item by item.Product into g
            select new {
                Product = g.Key,
                Quantity = g.Sum(item => item.Quantity),
                Total = g.Sum(item => item.Total)
            }; 
```

然后你如何把它传回去是另一回事 - 你几乎肯定*不*想要一个`List<Item>`...

# wpf - How/Where I do to override the app.config ConnectionString at runtime?

> ID：10141031
> 
> 赞同：0
> 
> 时间：2012-04-13T12:41:17.960
> 
> 标签：wpf, sqlite, ef-code-first

I'm using Entity Framework 4.1 Code First, Sqlite and WPF.

I want to redefine the app.config ConnectionString to sqlite, so I can define the Data Source (path for Sqlite database file) **at runtime**.

My guess is using the EntityConnectionStringBuilder to create the connection string. But I don't know what the event where I build and assign the connection string so the EF Code First will detect the change and will use the newer ConnectionString in all the code for the application (instead to use the app.config ConnectionString). I imagine that it's to be placed on Application_Startup event, but I don't know if this is the best pratice.

Thank you in advance.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T17:51:20.730

如果这就是你所追求的，

您可以在运行时通过`DbContext(string)`构造函数传递字符串 - 请参阅此处了解更多[DbContext(string)](http://msdn.microsoft.com/en-us/library/gg679467%28v=vs.103%29.aspx)

您还可以让您的上下文实现采用该参数并将其传递给`base`DbContext。

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T13:27:10.470

如果您使用的是 EF 4.1 CF，那么一旦您生成 *.edmx 文件，它应该会自动创建您的 app.config。如果您有现有的，则无需创建自己的 app.config 或更改它。

# android - 如何设置 Android 对话框的大小以匹配对话框的布局大小？

> ID：10141032
> 
> 赞同：3
> 
> 时间：2012-04-13T12:41:18.877
> 
> 标签：android, dialog

我有这个定义我的对话框的 xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" >

    <TextView android:text="test"
       android:layout_width="wrap_content"
       android:layout_height="wrap_content"/>
</LinearLayout> 
```

这是我的对话：

```
OverlayItem item = mapOverlays.get(index);
Dialog dialog = new Dialog(context);
dialog.setContentView(R.layout.map_menu);
dialog.setCanceledOnTouchOutside(true);
dialog.show(); 
```

出于某种原因，我的对话框比我的“测试”文本视图大（高得多）。我希望我的对话与我的文本完全相同。我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T12:47:15.043

您必须将选项设置为没有标题的对话框。

所以添加这个：`dialog.requestWindowFeature(Window.FEATURE_NO_TITLE);`

希望这可以帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-13T12:48:04.763

我面前没有 API，但我认为您需要将对话框宽度和高度参数设置为：

```
dialog.getWindow().setLayout(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT); 
```

您还可以设置 X、Y 坐标来显示对话框的位置，方法是玩弄它的窗口并在显示之前设置它的属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T13:01:33.377

删除对话框的标题，然后您可以减小对话框大小，或在调整对话框视图的布局中调整大小。

```
OverlayItem item = mapOverlays.get(index);

Dialog dialog = new Dialog(context);
// Removing Dialog 
dialog.requestWindowFeature(Window.FEATURE_NO_TITLE);
dialog.setContentView(R.layout.map_menu);
dialog.setCanceledOnTouchOutside(true);
dialog.show(); 
```

# javascript - Adding several input boxes based by a select box value

> ID：10141033
> 
> 赞同：0
> 
> 时间：2012-04-13T12:41:19.340
> 
> 标签：javascript, jquery

I have a select box:

```
<select id="steps_number">
    <option value="2">2</option>
    <option value="3">3</option>
    <option value="4">4</option>
    <option value="5">5</option>
    <option value="6">6</option>
    <option value="7">7</option>
    <option value="8">8</option>
    <option value="9">9</option>
    <option value="10">10</option>
</select> 
```

Now, if the user selects "4", then 4 input boxes needed to be added to the page, if he changes his selection to 8, 8 input boxes need to be there, an so on...

And also, the input boxes names are important, I'm gonna send the form values to another page for processing and inserting the data into db, how I could know/get the newly made input boxes names?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T12:49:22.813

非常简单的例子（也在[这里演示](http://jsfiddle.net/FFfRT/1/)）：

```
// bind to when the drop-down list changes
$('#steps_number').change(function(){    
    // find out the number to display
    var count = $(this).val();

    // Try to keep the fields already on the page. Remove anything
    // that exceeds the count
    $('#steps input:gt('+(count-1)+')').remove();

    // But if it doesn't have enough, add more
    for (var i = $('#steps input').length; i < count; i++){
        $('<input>',{type:'text',id:'step'+(i+1),name='step'+(i+1)}).appendTo('#steps');
    }
}); 
```

这假设您需要以下结构作为输入：

```
<div id="steps">
  <input type="text" id="step1" name="step1" />
  <input type="text" id="step2" name="step2" />
  <input type="text" id="step3" name="step3" />
  <!-- .... -->
</div> 
```

关于服务器端，您现在将看到使用`$_REQUEST['step1']`、`$_REQUEST['step2']`等的输入。或者，根据您的表单方法，它们也会显示在`$_POST`或`$_GET`中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T12:53:37.027

你可以这样做：

```
<html>
<head>
    <title>Test</title>

    <script language="javascript" src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
    <script language="javascript">

        $(document).ready(function(){

            alert("ok");
            $("#steps_number").change(function() { 
                var inputNum = $("#steps_number").val();

                var inputCode = "";
                for(i=0; i<inputNum; i++) { 
                    inputCode += "<p class=\"inputBox\"><input id=\"inputBox_" + i + "\" size=\"20\" type=\"text\"></p>"
                }

                $("#inputBoxes").html(inputCode);
            });
        });
    </script>
</head>

<body>

    <form id="testform">
        <select id="steps_number">
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
        </select>

        <div id="inputBoxes">

        </div>
    </form>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T12:59:26.803

这是我的解决方案：

```
<select id="steps_number">
<option value="2">2</option>
<option value="3">3</option>
<option value="4">4</option>
<option value="5">5</option>
<option value="6">6</option>
<option value="7">7</option>
<option value="8">8</option>
<option value="9">9</option>
<option value="10">10</option>
</select>
<div id="container"></div>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script>
$("#steps_number").on("change", function() {
    var count = $(this).val()
    $("#container").html("")
    for (i=0;i<count;i++) {
        $("<input>").appendTo("#container");
        $("<br>").appendTo("#container")
    }
})

</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-13T12:49:36.450

我为你写了一些基本的功能。但是您需要根据需要扩展它：

```
$('#steps_number')​.change(function(){
    for(var i=0; i < parseInt($(this).val()); i++) {
        $('body').append('<input type="text" name="someinput' + i + '">');
    }
});​ 
```

参见[jsFiddle](http://jsfiddle.net/antyrat/ZsKj6/)

# javascript - jquery splitter change to vertical splitter on button click

> ID：10141040
> 
> 赞同：0
> 
> 时间：2012-04-13T12:41:35.877
> 
> 标签：javascript, jquery, jquery-ui, jquery-plugins

I have a splitter that works fine. Now the client wants to change the splitter from horizontal view to vertival view. I mean that the splitter is first split int the 2 divs horizontally and when I click the button it will change so that it's split the same 2 divs vertically.

I tried this

```
 <script type="text/javascript">
        $(function () {
        $('.LeftPane').attr('id', 'LeftPane');
        $('.RightPane').attr('id'`enter code here`, 'RightPane');
        $("#MySplitter").splitter({
            type: "v"
        });
        $('#Button1').click(function () {
            $('#LeftPane').attr('id', 'TopPane');
            $('#RightPane').attr('id', 'BottomPane');
            $("#MySplitter").splitter({
                type: "h"
            });
        });
    });
    </script>

<style type="text/css" media="all">
   #MySplitter
    {
        height: 400px;
        width: 600px;
        margin: 1em 2em;
        background: #def;
        border: 2px solid #039; /* No padding allowed */
    }
   #LeftPane
    {
        background: #def;
        overflow: auto;
        width: 200px; /* optional, initial splitbar position */
        min-width: 50px; 
    }

    #RightPane
    {
        background: #def;
        overflow: auto;
        min-width: 100px; /* No margin or border allowed */
    }

   #MySplitter .vsplitbar
    {
        width:8px;
        cursor: e-resize; /* in case col-resize isn't supported */
        cursor: col-resize;
        background-color:Black;
    }
    #MySplitter .vsplitbar.active, #MySplitter .vsplitbar:hover
    {
         background-color:Black;
    }

     #TopPane
    {
       background: #def;
        overflow: auto;
        width: 200px; 
        min-width: 50px; /
    }

    #BottomPane
    {
       background: #def;
        overflow: auto;
        min-width: 100px; /* No margin or border allowed */
    }

     #MySplitter .hsplitbar
    {
        height: 2px;
        background: #487BA4;
    }
    #MySplitter .hsplitbar.active, #MySplitter .hsplitbar:hover
    {
        background: #487BA4;
    }
</style>

</head>
<body>
<div id="MySplitter">
    <div class="LeftPane">
        <p>
            This is the left side of the vertical splitter.</p>
        </p>
    </div>
    <div class="RightPane">
         This is the right side of the vertical splitter.</p>
    </div>
</div>
<p>
    <input id="Button1" type="button" value="splitchange" /></p>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T08:26:21.080

最后我找到了我的onw问题的解决方案。我在 asp.net 中设计它，所以我在 jquery 中用 asp.net 提供解决方案

```
<head id="Head1" runat="server">
<title></title>
<script src="../Scripts/jquery-1.4.4.js" type="text/javascript"></script>
 <script src="../Js/js/splitter.js" type="text/javascript"></script>
enter code here
 <style type="text/css" media="all">
  #MySplitter
  {
    height: 400px;
    width: 600px;
    margin: 1em 2em;
    background: #def;
    border: 2px solid #039;
} 
```

#LeftPane { 背景：#def; 溢出：自动；宽度：200px；最小宽度：50px；}

```
#RightPane
{
    background: #def;
    overflow: auto;
    min-width: 100px;
} 
```

#MySplitter .vsplitbar { 宽度：8px; 光标：电子调整大小；光标：col-resize；背景颜色：黑色；}

```
#MySplitter .vsplitbar.active, #MySplitter .vsplitbar:hover
{
     background-color:Black;
}

 #TopPane
{
   background: #def;
    overflow: auto;
    width: 200px; 
    min-width: 50px; 
}

#BottomPane
{
   background: #def;
    overflow: auto;
    min-width: 100px; 
}

 #MySplitter .hsplitbar
{
    height: 2px;
    background: #487BA4;
}
#MySplitter .hsplitbar.active, #MySplitter .hsplitbar:hover
{
    background: #487BA4;
}
</style>

 <script type="text/javascript">
     $(document).ready(function () {
         // var result = function () {
        // alert('fired');
       var val =  $('#<%=HiddenField1.ClientID %>').val();
         if (val == 1) {
             $('.LeftPane').attr('id', 'LeftPane');
             $('.RightPane').attr('id', 'RightPane');

             $("#MySplitter").splitter({
                 type: "v"
             });
         }
         else {
             $('#LeftPane').attr('id', 'TopPane');
             $('#RightPane').attr('id', 'BottomPane');
             $(' #MySplitter .vsplitbar').css('width', '');
             $("#MySplitter").splitter({
                 type: "h"
             });
         }
         // }
     });
</script>

</head>
<body>
 <form runat="server" >
<asp:HiddenField ID="HiddenField1" runat="server"  Value="1"/>
<asp:Button ID="Button1" runat="server" Text="change" OnClick="Button1_Click" />

 <div id="MySplitter">
    <div class="LeftPane">
        <p>
            This is the left side of the vertical splitter.</p>
        <p>
            Note what happens when you move the splitbar as far left as you can to make this
            pane very thin. A scrollbar appears and it is flush against the splitbar, just the
            way it should be.</p>
    </div>
    <div class="RightPane">
        <p>
            The splitbar needs to be wide enough to grab with the mouse, but a thick splitbar
            may be visually distracting in a design. This example shows how to make a splitbar
            that looks skinny but has a wider grabbing area. It also demonstrates the use of
            an alternate resize cursor. (Not all browsers support alternate cursors and only
            IE seems to support animated cursors.)</p>
        <p>
            A background image in the splitbar provides the visual marker but the splitbar area
            extends further right, appearing as padding on the right pane. The splitbar's hot
            zone is "biased" to the right so that it will not have a gap against any left-side
            scrollbar when it appears. If you know the left pane will never have a scroll bar,
            you could make the hot zone centered on the skinny splitbar.</p>
    </div>
</div>
</form> 
```

按钮后面的代码如下

```
 protected void Page_Load(object sender, EventArgs e)
    {
        if (HiddenField1.Value == "2")
        {
            HiddenField1.Value = "1";
        }
        else
        {
            HiddenField1.Value = "2";
        }
    } 
```

# django - 用户创建时的 django 信号

> ID：10141045
> 
> 赞同：7
> 
> 时间：2012-04-13T12:41:59.997
> 
> 标签：django

我已经使用函数 create_user_profile 连接了用户的创建，当我创建 i 用户时出现问题，我似乎调用了两次连接的函数并且 UserPRofile 试图创建两次，女巫触发错误

**列 user_id 不是唯一的**

```
Request Method: POST
Request URL:    http://127.0.0.1:8000/register/
Django Version: 1.3
Exception Type: IntegrityError
Exception Value:    
column user_id is not unique
Exception Location: c:\Python27\lib\site-packages\django\db\backends\sqlite3\base.py in execute, line 234
Python Executable:  c:\Python27\python.exe
Python Version: 2.7.2 
```

**这是调试日志：**

```
[13/Apr/2012 10:20:57] "GET /register/ HTTP/1.1" 200 176691
DEBUG:django.db.backends:(0.002) SELECT "auth_user"."id", "auth_user"."username",
 "auth_user"."first_name", "auth_user"."last_name", "auth_user"."email", "auth_us
er"."password", "auth_user"."is_staff", "auth_user"."is_active", "auth_user"."is_
superuser", "auth_user"."last_login", "auth_user"."date_joined" FROM "auth_user"
WHERE "auth_user"."last_name" = favicon ; args=(u'favicon',)
DEBUG:django.db.backends:(0.001) SELECT "auth_user"."id", "auth_user"."username",
 "auth_user"."first_name", "auth_user"."last_name", "auth_user"."email", "auth_us
er"."password", "auth_user"."is_staff", "auth_user"."is_active", "auth_user"."is_
superuser", "auth_user"."last_login", "auth_user"."date_joined" FROM "auth_user"
WHERE "auth_user"."last_name" = testuser2 ; args=(u'testuser2',)
DEBUG:django.db.backends:(0.000) SELECT "auth_user"."id", "auth_user"."username",
 "auth_user"."first_name", "auth_user"."last_name", "auth_user"."email", "auth_us
er"."password", "auth_user"."is_staff", "auth_user"."is_active", "auth_user"."is_
superuser", "auth_user"."last_login", "auth_user"."date_joined" FROM "auth_user"
WHERE "auth_user"."username" LIKE testuser2@gmail.com ESCAPE '\' ; args=(u'testus
er2@gmail.com',)
DEBUG:django.db.backends:(0.001) INSERT INTO "auth_user" ("username", "first_name
", "last_name", "email", "password", "is_staff", "is_active", "is_superuser", "la
st_login", "date_joined") VALUES (testuser2@gmail.com, , , testuser2@gmail.com, s
ha1$9bc1b$c9d377a1bf228ef74eb6931a9ed02d5c455e1576, False, True, False, 2012-04-1
3 10:21:13.949000, 2012-04-13 10:21:13.949000); args=(u'testuser2@gmail.com', '',
 '', u'testuser2@gmail.com', 'sha1$9bc1b$c9d377a1bf228ef74eb6931a9ed02d5c455e1576
', False, True, False, u'2012-04-13 10:21:13.949000', u'2012-04-13 10:21:13.94900
0')

====================================
=

DEBUG:django.db.backends:(0.002) INSERT INTO "page_userprofile" ("user_id", "thum
b", "name", "title", "description", "phone", "birthday", "address", "lat", "lng",
 "gender", "creation_date", "updation_date") VALUES (13, , , , , , None, , , , ,
2012-04-13 10:21:14.131000, 2012-04-13 10:21:14.131000); args=(13, '', '', '', ''
, '', None, '', '', '', '', u'2012-04-13 10:21:14.131000', u'2012-04-13 10:21:14.
131000')
DEBUG:django.db.backends:(0.002) INSERT INTO "page_pagesettings" ("user_id", "bac
kground_url", "background_repeat", "showAvatar", "showTags", "color_background",
"color_panel_background", "color_panel_background_opacity", "color_name", "color_
title", "color_description", "color_links", "font_name", "font_title", "font_desc
ription", "font_tags_and_links", "font_size_name", "font_size_title", "font_size_
description", "font_size_tags_and_links", "can_contact_via_email", "panel_positio
n") VALUES (13, , 0, False, True, , , , , , , , , , , , , , , , True, ); args=(13
, '', u'0', False, True, '', '', '', '', '', '', '', '', '', '', '', '', '', '',
'', True, '')

====================================
=

DEBUG:django.db.backends:(0.002) INSERT INTO "page_userprofile" ("user_id", "thum
b", "name", "title", "description", "phone", "birthday", "address", "lat", "lng",
 "gender", "creation_date", "updation_date") VALUES (13, , , , , , None, , , , ,
2012-04-13 10:21:14.442000, 2012-04-13 10:21:14.442000); args=(13, '', '', '', ''
, '', None, '', '', '', '', u'2012-04-13 10:21:14.442000', u'2012-04-13 10:21:14.
442000')
DEBUG:django.db.backends:(0.000) SELECT "page_userprofile"."id", "page_userprofil
e"."user_id", "page_userprofile"."thumb", "page_userprofile"."name", "page_userpr
ofile"."title", "page_userprofile"."description", "page_userprofile"."phone", "pa
ge_userprofile"."birthday", "page_userprofile"."address", "page_userprofile"."lat
", "page_userprofile"."lng", "page_userprofile"."gender", "page_userprofile"."cre
ation_date", "page_userprofile"."updation_date" FROM "page_userprofile" LIMIT 21;
 args=()
DEBUG:django.db.backends:(0.000) SELECT "auth_user"."id", "auth_user"."username",
 "auth_user"."first_name", "auth_user"."last_name", "auth_user"."email", "auth_us
er"."password", "auth_user"."is_staff", "auth_user"."is_active", "auth_user"."is_
superuser", "auth_user"."last_login", "auth_user"."date_joined" FROM "auth_user"
WHERE "auth_user"."id" = 1 ; args=(1,)
DEBUG:django.db.backends:(0.000) SELECT "auth_user"."id", "auth_user"."username",
 "auth_user"."first_name", "auth_user"."last_name", "auth_user"."email", "auth_us
er"."password", "auth_user"."is_staff", "auth_user"."is_active", "auth_user"."is_
superuser", "auth_user"."last_login", "auth_user"."date_joined" FROM "auth_user"
WHERE "auth_user"."id" = 2 ; args=(2,)
DEBUG:django.db.backends:(0.000) SELECT "auth_user"."id", "auth_user"."username",
 "auth_user"."first_name", "auth_user"."last_name", "auth_user"."email", "auth_us
er"."password", "auth_user"."is_staff", "auth_user"."is_active", "auth_user"."is_
superuser", "auth_user"."last_login", "auth_user"."date_joined" FROM "auth_user"
WHERE "auth_user"."id" = 4 ; args=(4,)
DEBUG:django.db.backends:(0.000) SELECT "auth_user"."id", "auth_user"."username",
 "auth_user"."first_name", "auth_user"."last_name", "auth_user"."email", "auth_us
er"."password", "auth_user"."is_staff", "auth_user"."is_active", "auth_user"."is_
superuser", "auth_user"."last_login", "auth_user"."date_joined" FROM "auth_user"
WHERE "auth_user"."id" = 5 ; args=(5,)
DEBUG:django.db.backends:(0.000) SELECT "auth_user"."id", "auth_user"."username",
 "auth_user"."first_name", "auth_user"."last_name", "auth_user"."email", "auth_us
er"."password", "auth_user"."is_staff", "auth_user"."is_active", "auth_user"."is_
superuser", "auth_user"."last_login", "auth_user"."date_joined" FROM "auth_user"
WHERE "auth_user"."id" = 7 ; args=(7,)
DEBUG:django.db.backends:(0.000) SELECT "auth_user"."id", "auth_user"."username",
 "auth_user"."first_name", "auth_user"."last_name", "auth_user"."email", "auth_us
er"."password", "auth_user"."is_staff", "auth_user"."is_active", "auth_user"."is_
superuser", "auth_user"."last_login", "auth_user"."date_joined" FROM "auth_user"
WHERE "auth_user"."id" = 8 ; args=(8,)
DEBUG:django.db.backends:(0.001) SELECT "auth_user"."id", "auth_user"."username",
 "auth_user"."first_name", "auth_user"."last_name", "auth_user"."email", "auth_us
er"."password", "auth_user"."is_staff", "auth_user"."is_active", "auth_user"."is_
superuser", "auth_user"."last_login", "auth_user"."date_joined" FROM "auth_user"
WHERE "auth_user"."id" = 9 ; args=(9,)
DEBUG:django.db.backends:(0.001) SELECT "auth_user"."id", "auth_user"."username",
 "auth_user"."first_name", "auth_user"."last_name", "auth_user"."email", "auth_us
er"."password", "auth_user"."is_staff", "auth_user"."is_active", "auth_user"."is_
superuser", "auth_user"."last_login", "auth_user"."date_joined" FROM "auth_user"
WHERE "auth_user"."id" = 10 ; args=(10,)
DEBUG:django.db.backends:(0.000) SELECT "auth_user"."id", "auth_user"."username",
 "auth_user"."first_name", "auth_user"."last_name", "auth_user"."email", "auth_us
er"."password", "auth_user"."is_staff", "auth_user"."is_active", "auth_user"."is_
superuser", "auth_user"."last_login", "auth_user"."date_joined" FROM "auth_user"
WHERE "auth_user"."id" = 11 ; args=(11,)
DEBUG:django.db.backends:(0.000) SELECT "auth_user"."id", "auth_user"."username",
 "auth_user"."first_name", "auth_user"."last_name", "auth_user"."email", "auth_us
er"."password", "auth_user"."is_staff", "auth_user"."is_active", "auth_user"."is_
superuser", "auth_user"."last_login", "auth_user"."date_joined" FROM "auth_user"
WHERE "auth_user"."id" = 12 ; args=(12,)
DEBUG:django.db.backends:(0.000) SELECT "auth_user"."id", "auth_user"."username",
 "auth_user"."first_name", "auth_user"."last_name", "auth_user"."email", "auth_us
er"."password", "auth_user"."is_staff", "auth_user"."is_active", "auth_user"."is_
superuser", "auth_user"."last_login", "auth_user"."date_joined" FROM "auth_user"
WHERE "auth_user"."id" = 13 ; args=(13,)
[13/Apr/2012 10:21:15] "POST /register/ HTTP/1.1" 500 446959
DEBUG:django.db.backends:(0.001) SELECT "auth_user"."id", "auth_user"."username",
 "auth_user"."first_name", "auth_user"."last_name", "auth_user"."email", "auth_us
er"."password", "auth_user"."is_staff", "auth_user"."is_active", "auth_user"."is_
superuser", "auth_user"."last_login", "auth_user"."date_joined" FROM "auth_user"
WHERE "auth_user"."last_name" = favicon ; args=(u'favicon',) 
```

**联系：**

```
def create_user_profile(sender, instance, created, **kwargs):
    if created:
        print('')
        print('')
        print('=========================================')
        print('')
        print('')
        UserProfile.objects.create(user=instance)
        PageSettings.objects.create(user=instance)

post_save.connect(create_user_profile, sender=User) 
```

**创建用户：**

```
newUser = User.objects.create_user(username, username, password)
 newUser.last_name = slug

 if(registerAs == 'company'):
   newUser.first_name = 'company'
 else:
   newUser.first_name = 'user'

 #newUser.save() 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-13T12:58:35.137

使用`dispatch_uid`参数给你的信号一个唯一的标识符。

```
post_save.connect(create_user_profile, sender=User, dispatch_uid="create_user_profile") 
```

有关更多信息，请参阅[django 文档](https://docs.djangoproject.com/en/dev/topics/signals/#preventing-duplicate-signals)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-13T13:12:00.073

您可以通过向您的方法添加额外的健全性检查来避免该问题：

```
def create_user_profile(sender, instance, created, **kwargs):
    if created and not UserProfile.objects.exists(user=instance):
        UserProfile.objects.create(user=instance)
        PageSettings.objects.create(user=instance) 
```

# php - 有没有一种方法可以使用对 SEO 友好的包含来编码 html 页面？

> ID：10141046
> 
> 赞同：-3
> 
> 时间：2012-04-13T12:42:07.813
> 
> 标签：php, javascript, seo

我继承了一个有大约 40 页的网站，文件中的菜单是静态的，页脚和页眉也是静态的，并且都是 html 页面。我正在考虑在 javascript include 中使用 JS document.write 来隔离代码并将其内联编写。经过研究，SE 似乎不会看到这一点，并且 SE 找不到菜单链接并不是一件好事。有没有办法用 .html 页面做到这一点？我确信许多页面都有外部链接，所以我不想将它们更改为 php 或 asp。我正在考虑编写一个 php 脚本来重写页面并交换包含的内容。欢迎大家提出意见。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T12:45:13.440

大多数 HTTP 服务器（IIS / Apache / Lighttpd 等）支持[服务器端包含](http://en.wikipedia.org/wiki/Server_Side_Includes)

```
<!--#include file="header.html" -->

// your content

<!--#include file="footer.html" --> 
```

这会让你的生活变得轻松......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T12:54:52.020

我认为最好的选择是从关键字数据库中进行动态加载，例如：

```
<meta NAME="DESCRIPTION" CONTENT="<?php require('file_that_loads_desc_for_each_individual_page.php'); ?>" />
<meta NAME="KEYWORDS" CONTENT="<?php require('file_that_loads_keywords_for_each_individual_page.php'); ?>" /> 
```

必须修改`include`after很麻烦`include`。您说您的网站目前有 40 个页面 --> 想象一下必须修改 40 个不同的 php 包含！

这使得修改所有页面变得更容易，并通过从数据库中动态生成关键字来保持代码干净，并且只需连续修改实际内容即可在页面上更改它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T12:55:56.307

在 php 中，您可以将其添加到 .htaccess 文件中，php 将使用 php 引擎处理 .html ，就像处理 .php 文件一样：

```
# Use PHP5 by default
AddHandler application/x-httpd-php5 .php .html 
```

[从这里](http://www.bluehostforum.com/showthread.php?20116-Can-PHP-pages-have-HTML-extension)得到这个我现在没有测试它所以不能保证语法但是如果你可以更改服务器上的 .htaccess 文件它会起作用

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-13T12:58:39.597

我会在 php 中重新编写它们，然后在您的 .htaccess 文件中设置 301 重定向，以将蜘蛛和访问者重定向到新位置。

# java - Adding parameters in jsp file

> ID：10141050
> 
> 赞同：1
> 
> 时间：2012-04-13T12:42:18.007
> 
> 标签：java, jsp, servlets

Is there any way to add parameters in a servlet or jsp? Because as far as I have searched, parameters can only be set in forms. Why is there no command in java to add parameters manually? Another doubt I have is that, when forwarding from one jsp page to other, is the input request(with the parameters, attributes etc) forwarded to the next jsp page? What if I don't want certain parameters or attributes to be forwarded?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T12:49:12.220

请求参数可以通过使用传递`<jsp: param>`

该标签包含两个属性：

1.  姓名
2.  价值。

例如：

```
<jsp: param name="myParam" value="Amar Patel"/> 
```

此标记用作`<jsp:forward>`或`<jsp:include>`块内的嵌套标记。

例如：

```
<jsp: forward page="ssParameters.jsp">
  <jsp: param name="myParam" value="Amar Patel"/>
  <jsp: param name="Age" value="15"/>
</jsp: forward> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-13T12:50:04.203

**有没有办法在 servlet 或 jsp 中添加参数？**

-- 将其附加到 URL。如果您正在考虑一些假设函数，例如`request.setParameter`，那么没有提供这样的方法。你不认为这将是一个安全漏洞吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-14T14:04:25.573

> 有没有办法在 servlet 或 jsp 中添加参数？

是的。如果可以使用`RequestDispatcher.forward(ServletRequest, ServletResponse)`或者 `RequestDispatcher.include(ServletRequest, ServletResponse)`您可以使用[`HttpServletRequestWrapper`](http://docs.oracle.com/javaee/5/api/javax/servlet/http/HttpServletRequestWrapper.html)来添加或过滤请求参数

```
// assuming this code is part of a Servlet or JSP
HttpServletRequest request = ...;
final Map<String,String> additionalParameters = ...;

RequestDispatcher dispatcher = this.getServletConfig().getServletContext().getRequestDispatcher("/");

dispatcher.forward(new HttpServletRequestWrapper(request){

    public String getRequestParameter(String parameterName) {
        if (additionalParameters.contains(parameterName)) {
           return additionalParameters.get(parameterName);
        } else {
           if (!"filteredParameter".equals(parameterName)) {
              return super.getParameterMap().get(parameterName());
           } else {
              return null;
           } 
        }
    }
}
, response); 
```

如果您只想将其他“参数”传递给转发/包含的页面/servlet，建议使用`ServletRequest.setAttribute(String, Object)`. ServletRequest 属性可以在处理请求期间添加/删除，并允许在使用请求参数时添加完整的 java 对象而不是字符串。

> 为什么java中没有手动添加参数的命令？

ServletRequest 请求参数通常应该被视为不可修改，因为它是从客户端发送到服务器的请求的 Warpper。如果要添加参数，请使用请求属性。

> 我的另一个疑问是，当从一个 jsp 页面转发到另一个页面时，输入请求（带有参数、属性等）是否会转发到下一个 jsp 页面？

大多数时候，原件`HttpServletRequest`被传递给转发的页面/servlet。但正如我的片段所示，也可以将不同的 ServletRequest 传递给转发/包含的 servlet/jsp。

> 如果我不想转发某些参数或属性怎么办？

请参阅上面的代码片段。您可以使用自己的过滤转发参数或属性`HttpServletRequestWrapper`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-13T13:05:13.537

您可以通过在您的网址中使用它来传递您的参数。关于您对请求的问题。如果您转发到另一个 jsp/servlet，您的所有参数和属性都将在请求中。如果您不想在那里看到它，那么您应该改用重定向 (response.sendRedirect(url))

# algorithm - 数据压缩：算术编码不清楚

> ID：10141053
> 
> 赞同：10
> 
> 时间：2012-04-13T12:42:27.590
> 
> 标签：algorithm, encoding, compression, entropy, lossless-compression

任何人都可以用实现细节解释数据压缩的算术编码吗？我通过互联网浏览并找到了马克纳尔逊的帖子，但在尝试了几个小时后，我确实不清楚实现的技术。

Mark nelson 关于算术编码的解释可以位于

[http://marknelson.us/1991/02/01/arithmetic-coding-statistical-modeling-data-compression/](http://marknelson.us/1991/02/01/arithmetic-coding-statistical-modeling-data-compression/)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-16T17:17:28.810

算术压缩的主要思想是它能够使用所需的确切数据长度对*概率进行编码。*

这个数据量是已知的，由 Shannon 证明，并且可以使用以下公式简单地计算：-log2(p)

例如，如果 p=50%，那么您需要 1 位。如果 p=25%，则需要 2 位。

对于 2 的幂的概率来说，这很简单（在这种特殊情况下，霍夫曼编码就足够了）。但是如果概率是 63% 呢？然后你需要 -log2(0.63) = 0.67 位。听起来很棘手...

如果您的概率很高，则此属性尤其重要。如果你能以 95% 的准确率预测某事，那么你只需要 0.074 位就可以代表一个好的猜测。这意味着你要压缩很多。

现在，该怎么做？

嗯，它比听起来简单。您将根据概率划分范围。例如，如果您有 100 个范围、2 个可能的事件，并且第一个事件的概率为 95%，那么前 95 个值将显示为“事件 1”，剩下的 5 个值将显示为“事件 2” .

好的，但是在计算机上，我们习惯于使用 2 的幂。例如，对于 16 位，您有 65536 个可能值的范围。做同样的事情：取范围的第一个 95%（即 62259）说“事件 1”，其余的说“事件 2”。您显然有“四舍五入”（精度）的问题，但只要您有足够的值可以分配，就没有太大关系。此外，您不限于 2 个事件，您可以有无数个事件。重要的是根据每个事件的概率分配值。

好的，但现在我有 62259 个可能的值来表示“事件 1”，3277 表示“事件 2”。我应该选择哪一个？好吧，他们中的任何一个都可以。无论是 1、30、5500 还是 62256，它仍然表示“事件 1”。

事实上，决定选择哪个值并不取决于当前的猜测，而是取决于下一个猜测。

假设我有“事件 1”。所以现在我必须选择 0 到 62256 之间的任何值。在下一次猜测中，我有相同的分布（95% 事件 1，5% 事件 2）。我将简单地分配具有这些概率的分布图。除了这一次，它分布在 62256 个值上。我们继续这样，减少每次猜测的值范围。

所以事实上，我们正在定义“范围”，每次猜测都会缩小范围。然而，在某些时候，存在准确性问题，因为剩下的值很少。

这个想法是再次简单地“扩大”范围。例如，每次范围低于 32768 (2^15) 时，输出最高位，然后将其余位乘以 2（有效地将值左移一位）。通过不断地这样做，您将逐个输出比特，因为它们正在通过一系列猜测来解决。

现在与压缩的关系变得很明显：当范围迅速缩小时（例如：5%），您会输出很多位以使范围回到限制之上。另一方面，当概率非常高时，范围会非常缓慢地缩小。在输出第一个位之前，您甚至可以进行很多猜测。这就是如何将事件压缩到“一点点”的方式。

我有意使用术语“概率”、“猜测”、“事件”来保持本文的通用性。但是对于数据压缩，您只需将它们替换为您想要的数据建模方式。例如，下一个事件可以是下一个字节；在这种情况下，您有 256 个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-10-12T01:22:49.450

也许这个脚本可能有助于构建一个更好的算术编码器心智模型：[gen_map.py](https://github.com/wonder-mice/arcd/blob/master/tools/gen_map.py)。最初创建它是为了方便算术编码器库的调试并简化其单元测试的生成。然而，它创建了很好的 ASCII 可视化，这对于理解算术编码也很有用。

一个小例子。想象一下，我们有一个由 3 个符号组成的字母表：`0`，`1`和`2`概率`1/10`，`2/10`和`7/10`对应。我们要对序列进行编码`[1, 2]`。脚本将给出以下输出（暂时忽略`-b N`选项）：

```
$ ./gen_map.py -b 6 -m "1,2,7" -e "1,2"
000000111111|1111|111222222222222222222222222222222222222222222222
------011222|2222|222000011111111122222222222222222222222222222222
---------011|2222|222-------------00011111122222222222222222222222
------------|----|-------------------------00111122222222222222222
------------|----|-------------------------------01111222222222222
------------|----|------------------------------------011222222222
==================================================================
000000000000|0000|000000000000000011111111111111111111111111111111
000000000000|0000|111111111111111100000000000000001111111111111111
000000001111|1111|000000001111111100000000111111110000000011111111
000011110000|1111|000011110000111100001111000011110000111100001111
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
001100110011|0011|001100110011001100110011001100110011001100110011
010101010101|0101|010101010101010101010101010101010101010101010101 
```

前 6 行（`====`行前）表示从 0.0 到 1.0 的范围，该范围以与符号概率成比例的间隔递归细分。注释的第一行：

```
[1/10][     2/10    ][                 7/10                      ]
000000111111|1111|111222222222222222222222222222222222222222222222 
```

然后我们再次细分每个区间：

```
[ 0.1][     0.2     ][                 0.7                       ]
000000111111|1111|111222222222222222222222222222222222222222222222
         [   0.7    ][.1][   0.2 ][          0.7                 ]
------011222|2222|222000011111111122222222222222222222222222222222
                                  [.1][ .2][   0.7               ]  
---------011|2222|222-------------00011111122222222222222222222222 
```

请注意，某些区间没有细分。当没有足够的空间来表示给定精度（由`-b`选项指定）内的每个子区间时，就会发生这种情况。

每行对应于输入中的一个符号（在我们的例子中 - 序列`[1, 2]`）。通过跟踪每个输入符号的子间隔，我们将得到一个最终的间隔，我们想要用最少的比特进行编码。在我们的例子中，它`2`是第二行的第一个子区间：

```
 [ This one ]
------011222|2222|222000011111111122222222222222222222222222222222 
```

以下 7 行（之后`====`）表示相同的区间 0.0 到 1.0，但根据二进制符号进行细分。每行都是一个输出，通过在 0 和 1 之间进行选择，您可以选择左半子间隔或右半子间隔。例如，位`01`对应于`[0.25, 05)`第二行的子间隔：

```
 [   This one   ]
000000000000|0000|111111111111111100000000000000001111111111111111 
```

算术编码器的思想是输出位（0 或 1），直到相应的区间完全在（或等于）输入序列确定的区间内。在我们的例子中，它是`0011`. 该`~~~~`行显示了我们在哪里有足够的位来明确识别我们想要的间隔。

由`|`符号组成的垂直线表示可用于对输入序列进行编码的位序列（行）的范围。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-13T21:15:46.137

首先感谢您向我介绍算术压缩的概念！

我可以看到这个方法有以下步骤：

1.  创建映射：计算每个字母出现的比例，给出每个字母的范围大小。然后对它们进行排序并分配从 0 到 1 的实际范围
2.  给定一条消息，计算范围（非常简单的恕我直言）
3.  找到最优代码

第三部分有点棘手。使用以下算法。

令 b 为最优表示。将其初始化为空字符串 ('')。令 x 为最小值， y 为最大值。

1.  双倍 x 和 y：x=2*x, y=2*y
2.  如果它们都大于 1，则将 1 添加到 b。转到步骤 1。
3.  如果两者都小于 1，则将 0 附加到 b。转到步骤 1。
4.  如果 x<1，但 y>1，则将 1 附加到 b 并停止

b 基本上包含您正在传输的数字的小数部分。例如。如果 b=011，则分数对应于二进制的 0.011。

您不了解实施的哪一部分？

# android - Android views not scaling on different sized devices

> ID：10141054
> 
> 赞同：0
> 
> 时间：2012-04-13T12:42:32.160
> 
> 标签：android, view, scale, density-independent-pixel

I am using eclipse I have views with images and buttons with their width and height set in dp:

```
<Button
    android:id="@+id/btn_menu_games"
    android:layout_width="70dp"
    android:layout_height="70dp"
    android:layout_gravity="center"
    android:background="@drawable/ico_games"
    android:onClick="goToGames" /> 
```

But when I use a different device the images and buttons do not scale relative to the screen, so they are really big on a small screen and really small on a big screen. Am I doing something wrong in the view? Do I need to set anything in the Manifest?

Thanks.

Full code:

```
 <?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@drawable/bg_portrait"
    android:gravity="center_horizontal"
    android:orientation="vertical" >

    <ImageView
        android:id="@+id/imageView1"
        android:layout_width="234dp"
        android:layout_height="156dp"
        android:layout_marginBottom="15dp"
        android:layout_marginLeft="20dp"
        android:layout_marginRight="20dp"
        android:layout_marginTop="10dp"
        android:src="@drawable/flag" />

    <LinearLayout
        android:id="@+id/linearLayout1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        >

        <LinearLayout
            android:id="@+id/linearLayout2"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:orientation="vertical"
            android:layout_marginRight="20dp" >

                <Button
                    android:id="@+id/btn_menu_games"
                    android:layout_width="70dp"
                    android:layout_height="70dp"
                    android:layout_gravity="center"
                    android:background="@drawable/ico_games"
                    android:onClick="goToGames" />

        <com.academyGeneric.MyTextView
            android:id="@+id/textView1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center"
            android:textColor="#8c0101"
            android:text="Games"
            android:layout_marginBottom="5dp"
            android:textAppearance="?android:attr/textAppearanceLarge" />

        <Button
            android:id="@+id/btn_menu_lessons"
            android:layout_width="70dp"
            android:layout_height="70dp"
            android:layout_gravity="center"
            android:background="@drawable/ico_lessons" />

       <com.academyGeneric.MyTextView
           android:id="@+id/textView2"
           android:layout_width="wrap_content"
           android:layout_height="wrap_content"
           android:layout_gravity="center"
           android:text="Lessons"
           android:layout_marginBottom="5dp"
           android:textColor="#8c0101"
           android:textAppearance="?android:attr/textAppearanceLarge" />

          <Button
              android:id="@+id/btn_menu_settings"
              android:layout_width="70dp"
              android:layout_height="70dp"
              android:layout_gravity="center"
              android:background="@drawable/ico_settings"
              android:onClick="goToSettings" />

        <com.academyGeneric.MyTextView
            android:id="@+id/textView3"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center"
            android:text="Settings"
            android:textColor="#8c0101"
            android:textAppearance="?android:attr/textAppearanceLarge" />

</LinearLayout>

<LinearLayout
     android:id="@+id/linearLayout2"
     android:layout_width="wrap_content"
     android:layout_height="wrap_content"
     android:orientation="vertical"
     android:layout_marginLeft="20dp" >

            <Button
                android:id="@+id/btn_menu_dictionary"
                android:layout_width="70dp"
                android:layout_height="70dp"
                android:layout_gravity="center"
                android:background="@drawable/ico_dictionary"
                android:onClick="goToDictionary" />

        <com.academyGeneric.MyTextView
            android:id="@+id/textView4"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center"
            android:text="Dictionary"
            android:layout_marginBottom="5dp"
            android:textColor="#8c0101"
            android:textAppearance="?android:attr/textAppearanceLarge" />

        <Button
            android:id="@+id/btn_menu_statistics"
            android:layout_width="70dp"
            android:layout_height="70dp"
            android:layout_gravity="center"
            android:background="@drawable/ico_stats" />

        <com.academyGeneric.MyTextView
        android:id="@+id/textView5"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center"
        android:text="Statistics"
        android:layout_marginBottom="5dp"
        android:textColor="#8c0101"
        android:textAppearance="?android:attr/textAppearanceLarge"
         />

        <Button
            android:id="@+id/close"
            android:layout_width="70dp"
            android:layout_height="70dp"
            android:layout_gravity="center"
            android:background="@drawable/ico_exit"
            android:onClick="exit" />

        <com.academyGeneric.MyTextView
        android:id="@+id/textView6"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center"
        android:text="Exit"
        android:textColor="#8c0101"
        android:textAppearance="?android:attr/textAppearanceLarge"
         />

        </LinearLayout>            

    </LinearLayout>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T18:50:12.307

如果你真的需要它有一定的纵横比，你绝对应该考虑使用权重。

如果一个线性布局父级中有两个按钮，两个按钮的权重都为 1，它们都将占据
屏幕宽度的 1/2

按钮相对于屏幕的比例 = (view_weight/(total_weights of all view)

看看这里：http: [//blog.stylingandroid.com/archives/297](http://blog.stylingandroid.com/archives/297)

否则，DP 是正确的。

# twitter - Twitter statistics of my own application

> ID：10141058
> 
> 赞同：3
> 
> 时间：2012-04-13T12:42:40.273
> 
> 标签：twitter

I wrote a simple twitter client. so I need to know number of users who get an access for my application to use their accounts. Is this possible? And I need as many statistics of my application.

# ruby-on-rails-3 - 安全模板（Ruby on Rails）

> ID：10141060
> 
> 赞同：0
> 
> 时间：2012-04-13T12:42:41.457
> 
> 标签：ruby-on-rails-3, rubygems

是否有任何插件允许用户创建自己的模板？所以我用 smth like

```
Templates.find(5).render(:val1 => val1, :val2 => val2) 
```

有一个名为liquid 的好插件，但它似乎并不安全（用户可以删除数据库等）。

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-13T14:10:01.093

液体是一种非常流行的模板系统，被认为是安全的。事实上，这是设计目标之一。从液体的文件中：

> Liquid 是一个模板引擎，它具有非常具体的要求：
> 
> 它必须有漂亮而简单的标记。不产生好看标记的模板引擎使用起来没有乐趣。
> 
> **它需要是非评估和安全的。制作了 Liquid 模板，以便用户可以对其进行编辑。您不想在您的服务器上运行用户编写的代码。**
> 
> 它必须是无国籍的。编译和渲染步骤必须分开，这样昂贵的解析和编译就可以完成一次，然后您可以将其渲染到带有局部变量和对象的散列中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T13:03:18.703

机车 CMS 使用一种名为液体的宝石，声称可以做到这一点。在这里查看[http://rubygems.org/gems/liquid](http://rubygems.org/gems/liquid)。

# sencha-touch-2 - Offline application in sencha touch 2 not working

> ID：10141061
> 
> 赞同：0
> 
> 时间：2012-04-13T12:42:42.047
> 
> 标签：sencha-touch-2

I am trying to to build an offline application in sencha touch 2 using mvc structure. In offline mode page displayed is blank. I checked developer tool and there was an error as

"Failed to load resource [http://ipaddress/AppName/app/view/LoginViewport.js?_dc=1334316337812](http://ipaddress/AppName/app/view/LoginViewport.js?_dc=1334316337812) "

We can also see in the above error, there is some data appended to "LoginViewPort.js", and that might be the problem. Please help.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T18:50:01.840

当我收到该错误时，这意味着我没有将文件放置在 Sencha Touch 期望的正确位置。可能是您创建了 VIEWS 目录，它正在 VIEW 中查找信息？你是这样定义的吗？

```
Ext.application({
    name: 'MyApp',
    views: ['LoginViewport'],
...

    Ext.define('MyApp.view.LoginViewport', {
... 
```

我相信这意味着它将在视图文件夹中查找文件 LoginViewport.js。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T02:09:24.090

我有同样的问题。即使 sencha 可以在视图文件夹中找到该文件。由于某种原因，它忽略了它。如果您将文件夹重命名为视图，它应该可以工作。至少这就是它在我的项目中所做的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-04T04:07:27.320

它适用于我们进行生产的那些。因为所有的mvc结构文件都会被拷贝到一个文件中。

# ios - 在后台运行应用程序还是处于活动状态？

> ID：10141067
> 
> 赞同：1
> 
> 时间：2012-04-13T12:43:14.567
> 
> 标签：ios

实际上，我正在开发 iPhone 应用程序。我想跟踪处于活动状态的应用程序数量相同的应用程序状态或后台应用程序数量。你知道如何跟踪任务吗？我认为它与任务管理器有关。请给我一些指导。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T14:48:11.477

当我试图这样做时，我花了很多时间。但没有结果。

我能得到的最好结果是获取活动和后台运行应用程序的列表（实际上是正在运行的进程列表）：

```
-(void) listOfProcesses {
int mib[4] = {CTL_KERN, KERN_PROC, KERN_PROC_ALL, 0};
size_t miblen = 4;

size_t size;
sysctl(mib, miblen, NULL, &size, NULL, 0);
int st;

struct kinfo_proc * process = NULL;
struct kinfo_proc * newprocess = NULL;

do {       
    size += size / 10;
    newprocess = realloc(process, size);
    if (!newprocess){
        if (process){
            free(process);
        }
    }
    process = newprocess;
    st = sysctl(mib, miblen, process, &size, NULL, 0);
} while (st == -1 && errno == ENOMEM);

if (st == 0){
    if (size % sizeof(struct kinfo_proc) == 0){
        int nprocess = size / sizeof(struct kinfo_proc);
        if (nprocess){              
            for (int i = nprocess - 1; i >= 0; i--){
                NSLog(@"Pid: %d, Process name: %@",process[i].kp_proc.p_pid,process[i].kp_proc.p_comm);
            }
            free(process);
        }
    }
} 
```

}

在这个列表中有几个系统进程，但是对它们进行排序是没有问题的。

有关 mo 的信息，请参阅本手册：

*   [http://developer.apple.com/library/ios/#documentation/System/Conceptual/ManPages_iPhoneOS/man5/manpages.5.html](http://developer.apple.com/library/ios/#documentation/System/Conceptual/ManPages_iPhoneOS/man5/manpages.5.html)

这是 Unix 系统调用列表。这可能会有所帮助。

希望能帮助到你。

# windows - 如何在 Windows XP 中监视 UDP 缓冲区

> ID：10141072
> 
> 赞同：3
> 
> 时间：2012-04-13T12:43:20.503
> 
> 标签：windows, windows-xp, udp, windbg, winsock

我正在尝试优化基于 UDP 的大型系统中的通信。通过优化，我的意思是尽量减少数据包的丢失。（是的，我知道 UDP 的固有限制，不建议使用其他协议）我们有几个 .exe，每个都有几个线程，并使用

```
setsockopt with SO_SNDBUF  & SO_RCVBUF to increase to bufers. 
```

我们已经经历过为许多套接字设置非常大的缓冲区会降低整体性能（更多的数据包丢失）但是如何监控这些增加的缓冲区大小的影响呢？. 特别是在接收端，我想看看是否有任何端口由于缺少缓冲区而被丢弃。

请建议如何做到这一点，（用户或内核模式下的Windbg，特殊程序，自知之明）

编辑：@EdChum：我已经使用过 WireShark，是的，将线路上的数据包与应用程序接收的数据包关联起来很痛苦。我见过几次数据包在网络上的情况，（由 Wireshark 捕获）但应用程序没有收到。那些丢失的数据包通常是一个小数据包到多播目的地，在一个大的单播数据包之后以非常小的时间间隔发送。单播的接收者丢失了多播，但其他人接收它。

我的怀疑是，XP 有时会在 NDIS 或 IP 层的某个地方遇到一些缓冲区不足，因此会默默地丢弃数据包。如果某处有柜台，我可以确认这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:42:50.370

不知道如何使用 WinDbg 执行此操作，但我会使用[NetMon](http://www.microsoft.com/en-us/download/details.aspx?id=4865)或[WireShark](http://www.wireshark.org/)来监视数据包并查看是否有任何被丢弃，这将是痛苦的，具体取决于重现的难易程度，您需要学习如何过滤数据包，以便显示器显示您感兴趣的内容，但是这两个应用程序的帮助都非常有用。

您必须侦听物理套接字而不是环回地址才能监视数据包。

# c++ - 为什么 seekg(0) 不清除流的 eof 状态？

> ID：10141075
> 
> 赞同：8
> 
> 时间：2012-04-13T12:43:55.920
> 
> 标签：c++, iostream

我想知道是否以及为什么`seekg(0)`不应该清除`eofbit`流。我现在已经阅读了所有流，因此`EOF`已经到达（但`failbit`尚未设置）并且想要返回`seekg()`到有效位置并再次读取一些字符。在这种情况下`seekg(0)`，似乎可以“使用”该`eofbit`集合，但是一旦我尝试从流中读取，就会设置故障位。这个逻辑是正确的还是我的实施不好？我是否应该识别这种情况并手动清除 eofbit（如果未设置故障位）？

编辑：

读者提供的以下程序在我的实现中给出了不同的结果（ mingw32-c++.exe (TDM-2 mingw32) 4.4.1 ）：

```
#include <sstream>
#include <iostream>
#include <string>

int main() {
        std::istringstream foo("AAA");
        std::string a;
        foo >> a;
        std::cout << foo.eof() << " " << foo.fail() << std::endl; // 1 0
        foo.seekg(0);
        std::cout << foo.eof() << " " << foo.fail() << std::endl; // 0 0
        foo >> a;
        std::cout << foo.eof() << " " << foo.fail() << std::endl; // 1 0
        foo >> a;
        std::cout << foo.eof() << " " << foo.fail() << std::endl; // 1 1
} 
```

上面的评论来自在他的实现中尝试过该程序的用户。我得到这些结果：

```
1 0
1 0
1 1
1 1 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T12:52:42.407

根据**新**标准`clear()`应该重置`eofbit`（§ 27.7.2.3）：

> `basic_istream<charT,traits>& seekg(pos_type pos);`
> 
> *效果：*表现为一个未格式化的输入函数......，除了函数首先清除`eofbit`......

但是在**旧**标准（第 27.6.1.3 节）中没有提到清除`eofbit`!

和一个简单的测试：

```
#include <sstream>
#include <iostream>
#include <string>

int main() {
        std::istringstream foo("AAA");
        std::string a;
        foo >> a;
        std::cout << foo.eof() << " " << foo.fail() << std::endl; // 1 0
        foo.seekg(0);
        std::cout << foo.eof() << " " << foo.fail() << std::endl; // 0 0
        foo >> a;
        std::cout << foo.eof() << " " << foo.fail() << std::endl; // 1 0
        foo >> a;
        std::cout << foo.eof() << " " << foo.fail() << std::endl; // 1 1
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T12:49:38.117

为什么不手动 clear() 流然后在设置 eofbit 后返回？已达到EOF，为什么要自动清除它？这样做似乎会导致更多问题。

# c++ - 如何将具有继承的类拆分为不同的 .h/.cpp 文件？

> ID：10141079
> 
> 赞同：1
> 
> 时间：2012-04-13T12:44:08.077
> 
> 标签：c++, class

我一直在研究一个类，它又大又丑，想把每一位分成自己的 cpp/.h 文件。

我无法解决如何做到这一点......

这是我的代码 [http://ideone.com/n2Vjb](http://ideone.com/n2Vjb)

我知道您将类放在 .h 中，将实现放在 .cpp 中……但我无法让它运行，它在单个文件中运行良好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T13:03:01.117

确保不要忘记输入：

```
#include "HeaderFile.h" 
```

在 cpp 文件中，其中“HeaderFile.h”是“.h”文件的名称，其中包含要在 cpp 文件中使用的类的定义。

如果您有一个文件“MapFrames.h”，其中包含：

```
#include <iostream>
#include <vector>
#include <algorithm>
#include <stdio.h>
#include <math.h>
using namespace std;

class MapFrames{
public:
    char frame[11];
    vector<short> cols;
    vector<short> rows;
    MapFrames (short a, short b);
}; 
```

then the cpp file "MapFrames.cpp" should contain:

```
#include "MapFrames.h"

MapFrames::MapFrames (short a, short b){
    // Construct a vector "rows" of a certain user defined size
    rows.resize(a);
    // Construct a vector "cols" of a certain user defined size
    cols.resize(b);
    //Construct Frames
    frame[0]=201; // Top LC
    frame[1]=205; // Horizontal
    frame[2]=187; // Top RC
    frame[3]=186; // Vertical
    frame[4]=200; // Bottom LC
    frame[5]=188; // Bottom RC

    //Construct Icons
    frame[6]=219;  // ICON: Hidden Locations 
    frame[7]=177;  // ICON: Spy Location: Nothing Found
    frame[8]=2;    // ICON: Spy Location: City Found
    frame[9]=127;  // ICON: Miss
    frame[10]=15;  // ICON: Destroyed City
} 
```

Gerald

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T13:07:53.037

The following compiles and runs for me (albeit with a number of compiler warnings which you should probably look into):

file.h:

```
#ifndef FILE_H
#define FILE_H

#include <iostream>
#include <vector>
#include <algorithm>
#include <stdio.h>
#include <math.h>

using namespace std;

class MapFrames{
public:
        char frame[11];
        vector<short> cols;
        vector<short> rows;
        MapFrames (short a, short b);
};

class Cities : public MapFrames{
public:
        //Cords Holds map data. 0 = Unknown, 1 = City Location, 2 = Hit, 3 = Miss, 4 = Spy: Hit Nothing, 5 = Spy: Hit City
            vector<short>P1cords;
            vector<short>P2cords;
        Cities (short a, short b);
};

class PrintFuncs : public Cities{
public:
        PrintFuncs(short a, short b);
        void PrintTop();
        void PrintMid();
        void PrintBot();
        void PrintCords();
        void PrintGrid();
};

class GameBoard : PrintFuncs{
public:
        GameBoard (short a, short b);
        void display();
};

#endif 
```

file.cpp:

```
#include "file.h"

MapFrames::MapFrames (short a, short b){
        // Construct a vector "rows" of a certain user defined size
        rows.resize(a);
        // Construct a vector "cols" of a certain user defined size
        cols.resize(b);
        //Construct Frames
        frame[0]=201; // Top LC
        frame[1]=205; // Horizontal
        frame[2]=187; // Top RC
        frame[3]=186; // Vertical
        frame[4]=200; // Bottom LC
        frame[5]=188; // Bottom RC

        //Construct Icons
        frame[6]=219;  // ICON: Hidden Locations 
        frame[7]=177;  // ICON: Spy Location: Nothing Found
        frame[8]=2;    // ICON: Spy Location: City Found
        frame[9]=127;  // ICON: Miss
        frame[10]=15;  // ICON: Destroyed City
}

Cities::Cities (short a, short b) : MapFrames (a,b){
    //Player 1 (LEFT)
        //Resize Vector to number of elements in map
        P1cords.resize(a*b);
        //set 1st 33% of elements (rounded up) to 1.
        for (int i=0; i<ceil((33/100.f)*(a*b)); i++){
                P1cords[i] = 1;
        }
        //Shuffle cords for random city locations.
        random_shuffle ( P1cords.begin(), P1cords.end() );

//Player 2 (RIGHT)
        //Resize Vector to number of elements in map
        P2cords.resize(a*b);
        //set 1st 33% of elements (rounded up) to 1.
        for (int i=0; i<ceil((33/100.f)*(a*b)); i++){
                P2cords[i] = 1;
        }
        //Shuffle cords for random city locations.
        random_shuffle ( P2cords.begin(), P2cords.end() );
}

PrintFuncs::PrintFuncs(short a, short b) : Cities (a,b){
}
void PrintFuncs::PrintTop(){
        cout<<frame[0]<<frame[1]<<frame[1]<<frame[1]<<frame[2];
}
void PrintFuncs::PrintMid(){
        cout<<frame[3]<<" "<<frame[6]<<" "<<frame[3];
}
void PrintFuncs::PrintBot(){
        cout<<frame[4]<<frame[1]<<frame[1]<<frame[1]<<frame[5];
}
void PrintFuncs::PrintCords(){
        cout<<"    ";
        for (int i=0; i<cols.size(); ++i){
                cout<<"  "<<i<<"  ";
        }
        cout<<"   ";
        for (int i=0; i<cols.size(); ++i){
                if (i+cols.size()<10){
                        cout<<"  "<<i+cols.size()<<"  ";}
                if (i+cols.size()>9){
                        cout<<"  "<<i+cols.size()<<" ";}
        }
        cout<<"\n";
}

void PrintFuncs::PrintGrid(){
        for (int j=0; j<rows.size(); ++j){
                //Print TopRow  
                cout<<"    ";
                for (int i=0; i<cols.size(); ++i){
                        PrintTop();
                }
                cout<<"   ";
                for (int i=0; i<cols.size(); ++i){
                        PrintTop();
                }
                cout<<"\n";
                //Print Middle Row
                cout<<"  "<<j<<" ";
                for (int i=0; i<cols.size(); ++i){
                        PrintMid();
                }
                cout<<"   ";
                for (int i=0; i<cols.size(); ++i){
                        PrintMid();
                }
                cout<<"\n";
                //Print Bottom Row
                cout<<"    ";
                for (int i=0; i<cols.size(); ++i){
                        PrintBot();
                }
                cout<<"   ";
                for (int i=0; i<cols.size(); ++i){
                        PrintBot();
                }
                cout<<"\n";
        }
}

GameBoard::GameBoard(short a, short b) : PrintFuncs (a,b){}
void GameBoard::display(){
        PrintCords();
        PrintGrid();
}

int main (){

        short rows = 0;short cols = 0;
        cout<<"Enter a value for ROWS - between 2-6: ";cin>>rows;
        cout<<"Enter a value for COLS - between 2-7: ";cin>>cols;
        cout<<endl<<endl;

//      short rows = 5;short cols = 5;
        GameBoard map(rows, cols);
        map.display();

        // End  
        std::cout<<std::endl<<std::endl<<std::endl<<"Please Close Console Window"<<std::endl;
        std::cin.ignore('\n', 1024);
        return(0);
} 
```

**In summary: includes, uses of namespaces and class declarations into the header file, and definitions in the source file.** Include the header file at the top of the source file. The `#ifndef`, `#define`, and `#endif` ensure that the header file can only be included once, alternatively you can use `#pragma once` with most preprocessors. Also, as suggested by another answer, it would be neater to place each class into its own set of header/source files. This will have the added benefit that you won't need to worry about what order you list the class declarations: with the single-file approach, every class needs to be declared *before* it is used. In your case, that means that each declaration for a base class needs to appear before the inheriting class declaration.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T12:51:52.173

将“类”放入.h，每个类最多一个（接口）

```
class MapFrames{
public:
    char frame[11];
    vector<short> cols;
    vector<short> rows;
    MapFrames (short a, short b);
}; 
```

将 ...::... 放入 .cpp （实现）

```
MapFrames::MapFrames (short a, short b){
    // Construct a vector "rows" of 
... 
```

# javascript - 了解 Crockford 的 Object.create shim

> ID：10141086
> 
> 赞同：10
> 
> 时间：2012-04-13T12:44:32.393
> 
> 标签：javascript, prototype, object-create

我一直在阅读 Crockford 垫片以防止覆盖原型，并了解它有时不是最终/全部解决方案。我也明白[ES5 Shim](https://github.com/kriskowal/es5-shim)可能是一个可行的替代方案。我还阅读[了这篇文章，它提供了更强大、更安全的替代方案](https://stackoverflow.com/questions/3830800/object-defineproperty-in-es5#3844768)。

尽管如此，我还是想知道他的`Object.create`垫片在“说”什么，然后“在做什么”。有人可以告诉我我的解释评论是否正确吗？

```
if (typeof Object.create === 'undefined') { 
//If the browser doesn't support Object.create

  Object.create = function (o) {
  //Object.create equals an anonymous function that accepts one parameter, 'o'.

    function F() {};
    //Create a new function called 'F' which is just an empty object.

    F.prototype = o;
    //the prototype of the 'F' function should point to the
    //parameter of the anonymous function.

    return new F();
    //create a new constructor function based off of the 'F' function.
  };
}

//Then, based off of the 'Lost' example in the Crockford book...

var another_stooge = Object.create(stooge);

//'another_stooge' prototypes off of 'stooge' using new school Object.create.
//But if the browser doesn't support Object.create,
//'another_stooge' prototypes off of 'stooge' using the old school method. 
```

这样，当我们将东西扩充到“another_stooge”时，“stooge”对象的原型就不会被覆盖。无需使用 'constructor' 重置 'stooge' 原型。

提前致谢，

-k

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-13T13:57:25.073

```
if (typeof Object.create !== 'function') {
    Object.create = function (o) {
        function F() {}
        F.prototype = o;
        return new F();
    };
}
var oldObject={prop:'Property_one' }; // An object
var newObject = Object.create(oldObject); // Another object 
```

在上面的示例中，我们`newObject`使用方法创建了一个新对象，该方法是我们之前在（Crockford 的）示例中添加到对象中的对象`create`的成员函数。所以基本上它的作用是，该方法声明一个函数，一个空对象，然后我们继承了原型（在这种情况下也是作为 create 方法的参数传递的对象），最后我们返回了新的对象（F 的一个实例）使用到变量，所以 now是一个继承了. 现在如果你写那么它会输出，因为我们的对象继承了`Object``Object``create``F``every function is a first class object in javascript``o``o``oldObject``return new F();``newObject``newObject``oldObject``console.log(newObject.prop);``Property_one``newObject``oldObject`这就是为什么我们有`prop`as的价值`Property_one`。这被称为原型继承。

**您必须将对象作为`create`方法的参数传递**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T12:56:26.837

它所做的只是创建一个新的对象构造函数，即 F，然后将传递的对象分配给构造函数的原型属性，以便使用 F 构造函数创建的新对象继承这些方法。

然后它使用构造函数返回一个新的初始化对象（new F() => F.prototype）

但是 crockford 未能正确地重新分配构造函数，因为通常新的对象构造函数应该与它继承的对象构造函数相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T13:45:47.870

关于您的评论：

```
>   //Object.create equals an anonymous function that accepts one parameter, 'o'. 
```

最好说一个函数被分配给 的`create`属性`Object`。所有函数都可以被认为是匿名的，只是一些被分配给命名的属性或变量，而另一些则不是。

```
> //Create a new function called 'F' which is just an empty object. 
```

声明一个函数。是的，它也是一个对象。

```
>     F.prototype = o;
>     //the prototype of the 'F' function should point to the
>     //parameter of the anonymous function. 
```

`o`分配给的引用`F.prototype`写起来有点短。

```
>     //create a new constructor function based off of the 'F' function. 
```

不，应该是“返回 F 的实例”。所以返回的对象有一个内部`[[Prototype]]`引用传递给函数的对象。混乱的部分是必须创建一个无用的 F 函数来执行该技巧，并且返回的对象的构造函数将没有有用的值，因为它引用了 empty `F`。

并不是说构造函数属性通常非常可靠或特别有用。

> 这样，当我们将东西扩充到“another_stooge”时，“stooge”对象的原型就不会被覆盖。无需使用 'constructor' 重置 'stooge' 原型。

这是一个奇怪的说法。*another_stooge*`stooge`因为它是私有的`[[Prototype]]`，所以它不是继承自`stooge.prototype`而是继承自`stooge.[[Prototype]]`.

如果你想`another_stooge`继承自`stooge.prototype`，使用`Object.create(stooge.prototype)`or `Object.create(new stooge())`，前者可能更合适。

我希望一切都说得通。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-04T20:05:02.490

这里有两个技巧：

1.  F 不是一个简单的函数，它是一个构造函数。
2.  “F.prototype”只是一个属性，此时它与继承无关。真正的诀窍是，当我们使用“new F()”时，“new”会创建一个新对象，调用构造函数（这里不做任何事情）并将新对象的内部“prototype”字段设置为“ F.prototype”，因此返回的对象将继承自“o”。

所以我认为：

*   F 是构造函数
*   F 不是继承自 o
*   “new F”（即返回的对象）继承自 o

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2016-09-20T08:41:20.903

我猜想将内部函数命名为，`Object`而不是`F`使生成的对象看起来更接近将`Object.create()`要创建的对象。

```
if (typeof Object.create !== 'function') {
    Object.create = function (o) {
        function Object() {}
        Object.prototype = o;
        return new Object();
    };
} 
```

# java - 如何在使用 ITextPDF Java 动态生成 PDF 文件时合并 PDF 文件和 HTML 文本？

> ID：10141089
> 
> 赞同：1
> 
> 时间：2012-04-13T12:44:48.583
> 
> 标签：java, htmltext, itextpdf

我的项目需要动态生成 PDF 文件。此 PDF 文件应包含页眉图像、页脚图像和一些内容，具体取决于传递给我的 servlet 的参数。这些内容可以是 HTML 文本格式，也可以是 PDF 文件或两者兼有。我可以使用 HTMLWorker 为 HTML 文本创建 PDF 文件，也可以复制 PDF 文件，但是每当内容出现在 HTML 和 PDF 文件中时，它就会无法正常工作。我的内容被覆盖了。这是代码，我现在正在尝试。

```
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.StringReader;
import java.net.MalformedURLException;
import com.itextpdf.text.Document;
import com.itextpdf.text.DocumentException;
import com.itextpdf.text.Element;
import com.itextpdf.text.ExceptionConverter;
import com.itextpdf.text.Image;
import com.itextpdf.text.PageSize;
import com.itextpdf.text.Rectangle;
import com.itextpdf.text.html.simpleparser.HTMLWorker;
import com.itextpdf.text.pdf.BaseFont;
import com.itextpdf.text.pdf.PdfContentByte;
import com.itextpdf.text.pdf.PdfImportedPage;
import com.itextpdf.text.pdf.PdfPCell;
import com.itextpdf.text.pdf.PdfPTable;
import com.itextpdf.text.pdf.PdfPageEventHelper;
import com.itextpdf.text.pdf.PdfReader;
import com.itextpdf.text.pdf.PdfWriter;
public class itextPdf {
static class PageHeader extends PdfPageEventHelper{
    String header;

    public void setHeader(String header) {
        this.header = header;
    }

    public void onEndPage(PdfWriter writer, Document document) {
        System.out.print("Yeahhhhh...now add header");
        PdfPTable table = new PdfPTable(1);
        try {
            table.setWidths(new int[]{527});
            table.setTotalWidth(600);
            table.setLockedWidth(true);
            table.getDefaultCell().setFixedHeight(40);
            //table.getDefaultCell().setBorder(Rectangle.BOTTOM);
            Image img = Image.getInstance(header);
            img.setScaleToFitLineWhenOverflow(true);
            PdfPCell cell = new PdfPCell(img);
            //cell.setBorder(Rectangle.BOTTOM);
            table.addCell(cell);
            table.getDefaultCell().setHorizontalAlignment(Element.ALIGN_CENTER);
            //table.addCell(String.format("Page %d of", writer.getPageNumber()));
            //PdfPCell cell = new PdfPCell(Image.getInstance(total));
            //cell.setBorder(Rectangle.BOTTOM);
            //table.addCell(cell);
            //System.out.println(850 - document.topMargin() + table.getTotalHeight());
            table.writeSelectedRows(0, -1, 0, 845 , writer.getDirectContent());
        }
        catch(DocumentException de) {
            throw new ExceptionConverter(de);
        } catch (MalformedURLException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}

public static void main(String[] args){
    try{
        Document document = new Document(PageSize.A4, 50, 50, 50, 50);
        FileOutputStream fos = new FileOutputStream("parsedpdf.pdf");
        PdfWriter pdfWriter = PdfWriter.getInstance(document, fos);
        PageHeader event = new PageHeader();
        event.setHeader("C:/logos/120x60_KU.jpg");

        pdfWriter.setPageEvent(event);
        document.open();
        document.addAuthor("Author of the Doc");
        document.addCreator("Creator of the Doc");
        document.addSubject("Subject of the Doc");
        document.addCreationDate();
        document.addTitle("This is the title");

        //SAXParser parser = SAXParserFactory.newInstance().newSAXParser();
        //SAXmyHtmlHandler shh = new SAXmyHtmlHandler(document);

        HTMLWorker htmlWorker = new HTMLWorker(document);
        String str = "<B>NINAD ROCKS</B> :: <table><tr><td><p style=’font-size: 10pt; font-family: Times’&gt;" +
            "Cher Monsieur,</p><br><p align=’justify’ style=’text-indent: 2em; font-size: 10pt; font-family: Times’&gt;" +
            "asdasdasdsadas<br></p><p align=’justify’ style=’text-indent: 2em; font-size: 10pt; font-family: Times’&gt;" +
            "En vous remerciant &agrave; nouveau de la confiance que vous nous t&eacute;moignez,</p>" +
            "<br><p style=’font-size: 10pt; font-family: Times’&gt;Bien Cordialement,<br>" +
            "<br>ADMINISTRATEUR ADMINISTRATEUR<br>Ligne directe : 04 42 91 52 10<br>Acadomia&reg; – " +
            "37 BD Aristide Briand  – 13100 Aix en Provence  </p></td></tr></table>";
        StringBuffer sb = new StringBuffer(str);

        for(int i=0; i< 5 ; i++){
            sb.append(str);
        }
        htmlWorker.parse(new StringReader(sb.toString()));

        Image image = Image.getInstance("C:/Documents/Shared/compliance/btn_submit1.jpg");
        document.add(image);
        //document.add

        PdfReader reader = new PdfReader("C:/Ebooks/Interview/interview_questions 3.pdf");
        int size = reader.getNumberOfPages();
        System.out.println("Size:" + size);
        PdfPTable table = new PdfPTable(2);
        document.newPage();
        PdfImportedPage page;
        PdfContentByte cb = pdfWriter.getDirectContent();
        Rectangle psize = reader.getPageSize(1);
        float width = psize.getWidth();
        for(int i=1; i <=size; i++){
            //byte[] dataBytes = reader.getPageContent(i);
            //System.out.println(i + " " + dataBytes.length);
            //PdfObject pbo = new PdfStream(dataBytes);
            //((PdfStream)pbo).writeContent(fos);
            System.out.println("In:" + i);
            page = pdfWriter.getImportedPage(reader, i);
            cb.addTemplate(page, 0 , 0);
            System.out.println("$$" +page.toString());
            table.addCell(Image.getInstance(page));
            //document.add(page);
        }
        document.add(table);
        cb.beginText();
        cb.setFontAndSize(BaseFont.createFont(BaseFont.HELVETICA, BaseFont.CP1252, BaseFont.NOT_EMBEDDED), 9);
        String str1 = "<B>NINAD ROCKS</B> :: FOOTER FOOTER :: NINAD ROCKS :: FOOTER FOOTER";
        cb.showText(str1);
        cb.endText();

        document.close();
        HTMLWorker htmlWorker1 = new HTMLWorker(document);
        StringBuffer sb1 = new StringBuffer(str1);
        htmlWorker1.parse(new StringReader(sb1.toString()));

        document.close();
    }catch(Exception e){
        e.printStackTrace();
    }
}
} 
```

请帮助解决这个问题。或者让我知道是否有其他方法可以实现我的功能。

# .net - 无法将“System.DBNull”类型的对象转换为“System.String”类型

> ID：10141092
> 
> 赞同：0
> 
> 时间：2012-04-13T12:44:51.210
> 
> 标签：.net, mysql

我正在使用 MVC3 ASP，并已将我的 web.config 文件配置为以 root 身份登录 MYSQL DB。我创建了许多可以很好地连接的存储过程。我现在想将此登录用户更改为公共用户，称为 tempuser 而不再是 root。

但是，当我将登录用户从“root”更改为“tempuser”时，出现错误：无法将“System.DBNull”类型的对象转换为“System.String”类型

我在执行 ExecuteNonQuery() 时收到上述错误。

我已通过以下方式授予对函数的访问权限：GRANT EXECUTE ON FUNCTION check_user_exists to tempuser@'%';

我还在这个表上授予了“选择”和“更新”，我正在访问该函数使用的那个表。我可以以 tempuser 身份登录 mysql 命令行并手动调用该函数，没有任何问题。但是当我运行 ExecuteNonQuery() 时，我得到了上述错误。我目前正在使用 Visual Web Developer 2010、Razor Engine、MVC3。

任何帮助，请。

我已经尝试了几个星期了，但没有运气。

这是正在执行的代码。ExecuteScalar() 函数是错误所在。错误是这个问题的主题：但是，如果我以“root”用户身份登录，我不会收到错误消息。

```
 [HttpPost]
    public ActionResult Register(RegisterModel model)
    {
        if (ModelState.IsValid)
        {
            // Attempt to register the user

            DBController dbcontroller = new DBController();

            if (dbcontroller.DBConnection())
            {
                MySqlCommand command = new MySqlCommand("check_user_exists_signup", dbcontroller.conn);
                command.CommandType = System.Data.CommandType.StoredProcedure;

                // Add parameters for the check_user_exists_signup STORED FUNCTION
                command.Parameters.Add(new MySqlParameter("@userName", model.UserName));
                command.Parameters["@userName"].Direction = System.Data.ParameterDirection.Input;

                // RETURN parameter for the insert_users STORED FUNCTION
                MySqlParameter cnt_user = command.Parameters.Add("@cnt_user", MySqlDbType.Int32);
                command.Parameters["@cnt_user"].Direction = System.Data.ParameterDirection.ReturnValue;

                try
                {
                    command.ExecuteScalar();
                    object ret = command.Parameters["@cnt_user"].Value;             
                    dbcontroller.conn.Close(); 
```

存储的过程是：

```
CREATE DEFINER=`root`@`localhost` FUNCTION `check_user_exists_signup`(
       userName varchar(20)) RETURNS int(11)
    DETERMINISTIC
BEGIN
DECLARE cnt_user int;

  select count(*) into cnt_user
    from users 
   where user_name = userName;

RETURN cnt_user;

END 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T12:47:17.777

> 无法将“System.DBNull”类型的对象转换为“System.String”类型

好吧，你**不能那样**做。你不得不说

```
string s = null;
object value = reader["columnName"];
if(value != System.DBNull) {
    s = (string)value;
} 
```

或等价的东西。关键是，您不能`System.DbNull`转换为字符串。因此，如果`columnName`您当前正在处理的行中的列的值为`null`，那么您必须检测它。否则，继续进行强制转换是安全的（假设基础数据类型是`string`）。

> 我已经尝试了几个星期了，但没有运气。

最重要的是，您不应该花费**数周时间**来解决这样的问题。我将消息“无法将'System.DBNull'类型的对象转换为'System.String'”输入谷歌并弹出[这个答案](https://stackoverflow.com/questions/870697/unable-to-cast-object-of-type-system-dbnull-to-type-system-string)，这基本上是你的问题，和我给你的相同解决方案，只是编码了一点不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T12:52:07.477

在.Net中，如果数据为NULL，则表示为System.DBNull.Value，它是在DB中表示NULL的特定类型，您不能将其隐式转换为任何内容，因此假设您有一个对象包含来自DB的值命名为**theValue**，但数据为 NULL 那么 theValue 实际上是 System.DBNull 的一种类型，那么下面的表达式将抛出异常：

```
if(theValue == "blabla")
{
     ....
} 
```

要防止很容易，要么检查类型，要么对其执行 ToString（只要您确定它不是 .net null），您将得到一个空字符串

# html - 使用 CSS 顶部带有文本的背景填充形状

> ID：10141099
> 
> 赞同：1
> 
> 时间：2012-04-13T12:45:09.790
> 
> 标签：html, css

现在我们有一个网页，一个页面上有一堆链接部分。每个部分都有一个像这样的标题：

![在此处输入图像描述](../Images/fe62fe6de7540fcfe5e069f190469bdb.png)

这个标题背景实际上是两个图像。第一个只是一个矩形，第二个有斜边。在查看此解决方案时，我想知道是否可以使用 CSS 而不是图像来解决此问题。虽然我不是 CSS 专家，但我确实查看了一些示例，并且能够获得类似的工作。但是，当我尝试将文本放在背景之上时，它最终会出现在颜色之上而不是在其中。我拥有的 CSS 也有一个固定的大小，这并不理想。我宁愿指定可用区域的百分比并让它填充颜色。

这是我一直在使用的代码：

```
<STYLE type="text/css">
  .mini_banner 
  {
     display:inline;
     border-bottom:30px solid blue; 
     border-left:0px solid transparent;
     border-right:30px solid transparent;
  }
</STYLE> 
```

我想将此应用于表格中的单元格。我也不想破坏与现代浏览器的兼容性。我的“客户”（主要是内部人员）将主要使用 IE8 或更高版本，但如果我能提供帮助，我不想限制自己。

那么首先，这可能吗？其次，我将如何做到这一点？第三，有没有办法让它在规模上相对而不是固定？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T13:33:08.940

我会说，如果您恢复使用单个背景图像，那么您将不会感到头疼 - 在这种情况下，是带有缺口的白色图像（具有 alpha 透明度的 PNG-24）。让它比你认为你需要的大大约 200%，然后做这样的事情：

```
.minibanner {
   background: blue url(..images/notch.png) no-repeat middle right;
   font-size: 1.5em;
 } 
```

原因是依赖边框大小可能会导致跨浏览器的一些奇怪现象，如果任何元素运行到两行肯定会看起来很奇怪。

如果您将缺口图像放大 200-300%，但将其垂直对齐在背景的中间，并且*确实*增加了字体大小，则框会变大，但您的白色缺口会随之增长。

更新：

我能看到的唯一其他方法是在您的文本之后添加一个非语义元素，例如 a 或类似的东西：

```
<div>
    <p>Hello text</p>
    <span></span>
</div> 
```

然后在你的 CSS 中：

```
 p { 
        background: blue; 
        color: white;
        float: left;
        padding: 0 20px;
        height: 50px;
        margin:0;
        line-height: 50px;
        }
    span {
        width: 0;
        height: 0;
        border-top: 50px solid transparent;
        border-bottom: 0px solid transparent;
        display: inline-block;
        border-left: 50px solid blue;
    } 
```

请参阅此[JSFiddle](http://jsfiddle.net/chippper/Ct2F7/)。

[该形状基于本教程关于 CSS 三角形](http://css-tricks.com/snippets/css/css-triangle/)。现在，我只在基于 webkit 的浏览器上尝试过这个，它可以工作。每次要更改字体大小时都必须调整高度，这是一个缺点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T18:03:13.270

我让它在没有额外跨度的情况下工作：[jsFiddle](http://jsfiddle.net/PB2gs/1/)

```
.mini_banner
{
    width:18em; height:1.5em;
    color:white; font-weight:bold; padding-left:0.5em;
    margin-bottom:.5em;
}
.mini_banner:before {
    display:inline-block; content:''; overflow:hidden;
    width:17em; height:0;
    margin-bottom:-1.5em; margin-left:-.5em;
    border-bottom:1.5em solid blue;
    border-right:1.5em solid transparent;
} 
```

在 FF、Safari、Opera 和 IE 中测试。（适用于 IE8，但不适用于 IE7）

# java - Maven、Vaadin 和资源文件夹

> ID：10141104
> 
> 赞同：1
> 
> 时间：2012-04-13T12:45:52.350
> 
> 标签：java, css, gwt, maven, vaadin

我有一个现有的 maven 项目，通过在 POM 文件中添加依赖项，我开始使用 vaadin。但是，当我将 VAADIN/themes 文件夹放在 src/main/resources 下时，当使用 maven 构建时，它会被复制到 .war 文件中的 WEB-INF/classes 文件夹中，而不是像预期的那样将它放在 war 根目录中成为。我已经尝试了所有明显的组合，如 src/main/webapp/VAADIN 或 src/main/VAADIN 甚至 src/main/webapp/WEB-INF/VAADIN 但它们似乎都不是放置主题和其他 vaadin 的正确位置资源。

我还尝试生成一个 vaadin 项目，如[https://vaadin.com/wiki/-/wiki/Main/Using%20Vaadin%20with%20Maven](https://vaadin.com/wiki/-/wiki/Main/Using%20Vaadin%20with%20Maven)中所述，但没有成功。maven 的行为方式相同。

有谁知道如何在 Maven 项目中正确设置 Vaadin 主题？我正在使用带有 maven 3 的 osx 10.6

任何帮助将非常感激。最好的祝福

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T12:56:26.090

我不确定 Vaadin，但您可以使用[Maven Resources 插件](http://maven.apache.org/plugins/maven-resources-plugin/examples/copy-resources.html)将资源复制到特定位置（您喜欢的任何位置，而不仅仅是目标文件夹）。因此，如果您想将名为 VAADIN 的文件夹从项目的根目录复制到战争的根目录，您可以这样设置：

```
<plugin>
  <artifactId>maven-resources-plugin</artifactId>
  <version>2.5</version>
  <executions>
    <execution>
      <id>copy-resources</id>
      <phase>validate</phase>
      <goals>
        <goal>copy-resources</goal>
      </goals>
      <configuration>
        <outputDirectory>${basedir}/target/war</outputDirectory>
        <resources>
          <resource>
            <directory>VAADIN</directory>
            <filtering>false</filtering>
          </resource>
        </resources>
      </configuration>
    </execution>
  </executions>
</plugin> 
```

通常，该`src/main/resources`文件夹用于存放应该位于类路径`src/main/webapp`中的资源，并且存放应该位于`WEB-INF`webapp 文件夹中的资源。我建议将其他资源放在其他地方（也许`src/main/vaadin`？）。如果你真的想把它放进去`src/main/resources`并且你使用我刚刚概述的方法，你还需要排除它 Maven 复制那里的其他东西 - 更容易避免它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T14:03:56.850

你应该把你放在 src/main/webapp/ 中的所有东西都放在你的战争的根源上，而不需要任何定制。

# c# - 在 C# 控制台应用程序中测试数据库连接

> ID：10141106
> 
> 赞同：0
> 
> 时间：2012-04-13T12:45:53.513
> 
> 标签：c#, sql-server, database

我有一个 C# 控制台应用程序，它本质上是一个长批处理过程，每晚处理许多不同数据库中的数据。在此类程序开始时测试基本数据库连接的正确或首选方法是什么？我遇到了我的一个连接的数据库密码过期的问题，该连接被异常处理捕获，但我想在一开始就测试基本连接。

**一个简单的 SELECT 查询就足够了，还是有一种更有效的方法可以为众多数据库执行此操作？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T12:47:56.077

恕我直言，最简单的方法是尝试连接到数据库，如果失败，就放弃。
当您运行夜间批处理时，立即了解原因并解决它并不重要。
所以像这样

```
using(SqlConnection conn = new SqlConnection(connectionString))
{
    try
    {
        conn.Open();
        // Do what you please here        
    }
    catch (Exception ex)
    {
        // Write error to file
        File.Append(..., 
            DateTime.Now.ToString("yyyy-MM-dd hh:mm:ss") + " " + 
            ex.Message);
    }
    finally 
    { 
        conn.Close();
    } 
} 
```

第二天早上你可以检查文件是否有错误...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T12:52:31.657

```
'Connection.open` 
```

是确定是否可以连接到 db 的简单方法。

```
using (SqlConnection connection = new SqlConnection(connectionString))
{
    connection.Open();
} 
```

如果您收到编号为 18487 或 18488 的 SqlException，则表明密码已更改。

[Connection.changePassword](http://msdn.microsoft.com/en-us/library/kb8k729z.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T12:52:50.100

您无需运行任何查询。如果您使用 SqlConnection 传递连接字符串，则可以尝试 Open() 连接，如果无法连接，则会出现异常，例如：

```
try
{
    var cnn = new SqlConnection(connectionString);
    cnn.Open();
}
catch
{
   // connection failed, do something
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-13T12:53:57.740

打开（然后关闭）连接应该足以测试密码。但是，这并不能告诉您 db 用户是否有权访问特定表。

# java - Flex Blaze DS 和 JPA - 延迟加载问题

> ID：10141115
> 
> 赞同：2
> 
> 时间：2012-04-13T12:47:00.100
> 
> 标签：java, apache-flex, reflection, jpa, blazeds

我正在 Flex 中开发一个应用程序，使用 Blaze DS 与 Java 后端通信，该后端通过 JPA（Eclipse 链接）提供持久性。

通过 Blaze DS 将 JPA 实体传递给 Flex 时遇到问题。Blaze DS 通过调用实体上的所有 getter 方法，使用反射将 JPA 实体转换为 ObjectProxy（实际上是 HashMap）。这包括任何延迟初始化的一对多关系。

你可能会看到我要去哪里。如果我通过 JPA 传递一个对象，这将调用该对象的所有一对/多对多方法。对于每个返回的对象，如果它们具有一对多的关系，它们也会被调用。因此，通过传回单个 JPA 实体，我实际上最终会执行多个数据库调用并将所有相关条目作为单个 ObjectProxy 实例传回！

迄今为止，我的解决方案是创建一个转换器，将每个实体转换为 ObjectProxy，反之亦然。这显然很麻烦，必须有更好的方法。

请问有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T15:25:06.350

作为替代方案，您可以考虑使用[GraniteDS](http://www.graniteds.org)代替 BlazeDS：GraniteDS 具有比 BlazeDS 更强大的[数据管理](http://www.graniteds.org/public/docs/2.3.0/docs/reference/en-US/html/graniteds.datamanagement.html)堆栈（它与 LCDS 竞争更激烈）并且完全支持所有主要 JPA 引擎的延迟加载：Hibernate、EclipseLink、OpenJPA 等.

此外，GraniteDS 具有出色的客户端[透明延迟加载](http://www.graniteds.org/public/docs/2.3.0/docs/reference/en-US/html/graniteds.datamanagement.html#data.lazyloading)功能，甚至还有所谓的[*反向*延迟加载](http://www.graniteds.org/public/docs/2.3.0/docs/reference/en-US/html/graniteds.datamanagement.html#data.reverselazyloading)机制。

而且您不需要任何类型的中间 DTO：它按原样序列化 JPA 实体，并在客户端使用代码生成的 ActionScript bean 来保持它们的初始化状态。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T13:45:59.647

不幸的是，使用 Flash 客户端实现延迟加载并不容易。有一些可行的解决方案，例如[dpHibernate](http://blog.engage-encore.com/index.php/2009/05/13/blazeds-lazy-loading/)，但到目前为止，我测试过的所有不同解决方案在性能和易用性方面都达不到您的预期。

因此，根据我的经验，始终使用[DTO](http://en.wikipedia.org/wiki/Data_transfer_object)是最好和最可靠的解决方案，它增加了将数据库层和视图层清晰分离的好处。但是，这需要您实现预先加载或第二次服务器往返来解决您的多对多关系，以及复制 DAO 和 DTO 字段值的大量样板代码。

选择哪一个取决于您的用例：有时仅获取主对象的字段可能就足够了，然后您可以简单地从 DTO 中省略相关对象列表（仅传输查询所需的那些值）。有时您可能实际上需要完整的相关实体列表，然后您可以通过预先加载或设置第二个远程对象来仅查找列表来获取它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T13:54:13.170

EclipseLink 还提供了一个 copyObject() API，它允许您提供您想要的属性的副本组。然后，您可以使用此副本来避免出现您不想要的关系。

如果您有一个分离的对象，您也可以将不需要的字段清空，或者使用 DTO。

# android - 检索时登录错误

> ID：10141117
> 
> 赞同：0
> 
> 时间：2012-04-13T12:47:08.430
> 
> 标签：android, sqlite

我有一个包含四个编辑文本的主屏幕。在每个编辑文本中，我只接受单个数字值。我在每个编辑文本上设置 requestFocus()。一旦我在第四个编辑文本中输入值，它应该调用构造函数，触发查询并返回我登录是否成功。相反，它给我的消息是“登录失败”

这是我的代码

```
edit4.setOnKeyListener(new OnKeyListener() {
    @Override
    public boolean onKey(View arg0, int arg1, KeyEvent arg2) 
    {
        // TODO Auto-generated method stub
        if(edit4.getText().toString().length()==1)
        {
            ParentDBHelper helper = new ParentDBHelper(getApplicationContext(), "db_parents", null, 2);
            SQLiteDatabase db=helper.getWritableDatabase();
            Cursor c=db.rawQuery("SELECT * FROM tbl_countries", null);
            // check if the table is empty 
            if (!c.moveToNext())
            {
                Toast.makeText(getApplicationContext(), "No data to display, please make sure you have already inserted data!", Toast.LENGTH_LONG).show();
                db.close();
                return false;
            }
            c.moveToPrevious();
            // if the table is not empty, read the result into a string named display 
            while(c.moveToNext())
            {
                String 
                String no1=c.getColumnName(5); 
                if(no1==edit1.getText().toString()+edit2.getText().toString()+edit3.getText().toString()+edit4.getText().toString())
                {
                    flag_status_pin=1;
                    Toast.makeText(getApplicationContext(), "Login Successful!!", Toast.LENGTH_LONG).show();
                    Intent dash1=new Intent(getApplicationContext(),DashBoard.class);
                    startActivity(dash1);
                }
            }
            if(flag_status_pin==0)
            {
                Toast.makeText(getApplicationContext(), "Login Failed!!", Toast.LENGTH_LONG).show();
                Intent homes=new Intent(getApplicationContext(),home.class);
                startActivity(homes);
            }  

        }//if 

        return false;
    }}); 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T12:57:12.933

最好为您的编辑文本使用 TextWatcher，而不是 keylistener：

```
TextWatcher watcher = new TextWatcher(){

    @Override
    public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {
    }

    @Override
    public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) {
    //Test here for login 
```

}

```
 @Override
    public void afterTextChanged(Editable editable) {
    }
}; 
```

然后将其设置为`edit4.addTextChangedListener(watcher);`您需要稍微更改您的逻辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T13:51:25.633

您正在使用 比较字符串`==`。这不起作用。改用等于。

此外，您正在将您的密码与列名进行比较？你不应该把它比作

```
c.getString(5) 
```

反而？

# spring - Spring security拦截-url root和登录

> ID：10141118
> 
> 赞同：0
> 
> 时间：2012-04-13T12:47:09.553
> 
> 标签：spring, security, login, root, intercept

我想保护除根以外的所有内容。我的安全性如下所示：

```
<http auto-config="true" use-expressions="true">
<intercept-url pattern="/"/>
<intercept-url access="isAuthenticated()" pattern="/**"/>
<form-login authentication-failure-url="/" login-page="/" default-target-url="/dashboard"/>
<logout invalidate-session="true" logout-success-url="/"/>
</http> 
```

我的登录页面包含在根目录中.. 我收到“页面未正确重定向”错误..

请问有人可以帮忙解决这个问题吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T23:53:28.647

为登录页面添加绕过安全检查

# functional-programming - 第一类函数和高阶函数之间的任何区别

> ID：10141124
> 
> 赞同：141
> 
> 时间：2012-04-13T12:47:49.990
> 
> 标签：functional-programming, terminology

我想知道[First Class Function](http://en.wikipedia.org/wiki/First-class_function)和[High Order Function](http://en.wikipedia.org/wiki/Higher-order_function)之间是否/有什么区别。

我通读了这两个 wiki 页面，它们看起来非常相似。如果他们谈论相同，为什么需要两个术语？

尝试谷歌但没有找到任何有用的东西。

* * *

## 回答 #1

> 赞同：176
> 
> 时间：2012-04-13T13:07:22.383

它们是有区别的。当您说一种语言具有一等函数时，这意味着该语言将函数视为值-您可以将函数分配给变量，将其传递等等。高阶函数是对其他函数起作用的函数，这意味着他们将一个或多个函数作为参数，也可以返回一个函数。

“高阶”概念通常可以应用于函数，例如数学意义上的函数。“一流”概念仅与编程语言中的函数有关。在指代函数时很少使用它，例如“一等函数”。更常见的说法是“一种语言有/没有一流的功能支持”。

这两件事是密切相关的，因为很难想象一种具有一流功能的语言不支持高阶函数，相反，一种具有高阶函数但没有一流函数支持的语言。

* * *

## 回答 #2

> 赞同：79
> 
> 时间：2012-04-13T12:59:36.257

*第一类函数*是被视为对象（或可分配给变量）的函数。

*高阶函数*是将至少一个第一类函数作为参数或返回至少一个第一类函数的函数。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2012-04-13T13:35:41.873

他们是不同的。

*一级功能*

在整个语言中统一处理的值称为“第一类”。它们可以存储在数据结构中，作为参数传递，或者在控制结构中使用。

支持具有函数类型的值并将它们视为非函数值的语言可以说具有“第一类函数”。

*高阶函数*

拥有一流函数的后果之一是您应该能够将函数作为参数传递给另一个函数。后一个功能现在是“高阶”。它是一个将函数作为参数的函数。

典型的例子是“地图”

```
map :: (a -> b) -> [a] -> [b]
map f []     = []
map f (x:xs) = f x : map f xs 
```

也就是说，它接受一个函数和一个数组，并返回一个新数组，该数组将函数应用于每个元素。

函数式语言——其中函数是构建程序的主要手段的语言——都具有一流的函数。大多数还具有高阶函数（非常罕见的例外是像 Excel 这样的语言，可以说是函数式的，但不是高阶的）。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2012-04-14T16:52:44.863

除了前面的答案，请注意具有一等函数的语言会自动启用高阶函数的表达式（因为您可以像传递任何其他值一样将函数作为参数传递）。

另一方面，您可以想象支持高阶函数但不将函数设为一等的语言（并且作为函数的参数被特殊处理，并且与“普通”值参数不同）。

因此，一等函数的存在（作为一种语言特征）意味着高阶函数的存在，但反之则不然。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-07-08T17:58:26.973

**一流的**功能可以：

*   存储在变量中
*   从函数返回。
*   作为参数传递给另一个函数。

**高阶函数**是一个返回另一个函数的函数。

例如：

```
function highOrderFunc() {
  return function () {
    alert('hello');
  };
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-02-10T21:15:16.027

一流的函数意味着您可以使用其他类型（变量、布尔值、数字......）做的所有事情，您可以使用函数来做。

例如，将它们分配给变量，传递它，即时创建它们。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-03-15T10:05:34.823

### 一级功能：

当我们将函数作为另一个函数的参数传递时，称为第一类函数。将函数用作值的能力称为第一类函数。

```
var a = function(parameter){
    return function(){
    }
}
console.log(a()) 
```

### 高阶函数：

接收另一个函数作为参数或返回一个新函数或两者兼有的函数称为高阶函数。由于 First-class 函数，高阶函数才有可能。

# c# - 将 wsse:security 元素添加到肥皂标题

> ID：10141128
> 
> 赞同：1
> 
> 时间：2012-04-13T12:47:57.460
> 
> 标签：c#, wcf, api, soap, wcf-binding

我目前正在尝试连接到 hmrc 的 api 并在我的项目中设置了一个服务，现在正在创建要发送的消息。

我已经能够很好地创建消息的正文部分，但是在正确获取标题时遇到了麻烦。这是消息应该是什么样子的示例：

```
<soap:Envelope  
xmlns:wsa="http://schemas.xmlsoap.org/ws/2004/03/addressing"  
xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd"  
xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wsswssecurity-utility-1.0.xsd"  
xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"> 
<soap:Header>     
<wsa:Action>http://schemas.xmlsoap.org/ws/2004/04/security/trust/RST/Issue</wsa:Action> 
<wsa:MessageID>uuid:39610e5b-162b-4491-9301-85578046a583</wsa:MessageID> 
<wsa:ReplyTo>
    <wsa:Address>
        http://schemas.xmlsoap.org/ws/2004/03/addressing/role/anonymous
    </wsa:Address> 
</wsa:ReplyTo> 
<wsa:To>
    http://www.gateway.gov.uk/soap/2007/02/sts
</wsa:To> 
<wsse:Security> 
  <wsu:Timestamp wsu:Id="Timestamp-201ebb7a-d2f4-44d5-85e4-b8bb4c71ed54"> 
    <wsu:Created>2012-04-13T16:18:11Z</wsu:Created> 
    <wsu:Expires>2012-04-13T16:23:11Z</wsu:Expires> 
  </wsu:Timestamp> 
</wsse:Security> 
</soap:Header> 
<soap:Body> 
<wst:RequestSecurityToken xmlns:wst="http://schemas.xmlsoap.org/ws/2004/04/trust"> 
<wst:TokenType>urn:GSO-SystemServices:external:1.65:gatewaytoken#GatewayToken</wst:TokenType>     
<wst:RequestType>http://schemas.xmlsoap.org/ws/2004/04/security/trust/Issue</wst:RequestType> 
  <wst:Base> 
    <wsse:UsernameToken xmlns:wsu="http://docs.oasisopen.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" wsu:Id="SecurityToken-94d12e0f-400b-4412-bde8-e03357eb0692"> 
      <wsse:Username>513FDQ37JILL</wsse:Username> 
      <wsse:Password Type="http://docs.oasisopen.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordDigest"> 
        NXJ3ynAa8Sy136aifThXJl8vLoE= 
      </wsse:Password> 
      <wsse:Nonce>4nJy2oD6xC79zatTHvuywg==</wsse:Nonce> 
      <wsu:Created>2007-02-01T11:03:10Z</wsu:Created> 
    </wsse:UsernameToken> 
  </wst:Base> 
  <wsp:AppliesTo xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy"> 
    <wsa:EndpointReference> 
      <wsa:Address>urn:GSO-SystemServices:external:1.65:GatewayWebServices</wsa:Address> 
    </wsa:EndpointReference> 
  </wsp:AppliesTo> Version 1.0 32 9 June 2008 
  <wst:Lifetime> 
    <wsu:Expires>2012-04-13T20:23:11Z</wsu:Expires> 
  </wst:Lifetime> 
</wst:RequestSecurityToken> 
</soap:Body> 
</soap:Envelope> 
```

主要问题是我无法显示安全元素。我目前一直在 app.config 文件中尝试各种类型的绑定，但我对使用服务真的很陌生并且完全陷入困境。这是我当前的 app.config：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
    <configSections>
    </configSections>
    <system.serviceModel>
    <bindings>
        <customBinding>
            <binding name="XmlTokenServiceBinding" >
                <textMessageEncoding maxReadPoolSize="64" maxWritePoolSize="16"
                    messageVersion="Soap11WSAddressing10" writeEncoding="utf-8">
                 <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384" maxBytesPerRead="4096" maxNameTableCharCount="16384" />
                </textMessageEncoding>
                <security authenticationMode="SecureConversation" includeTimestamp="True" requireSecurityContextCancellation="false"
                        messageSecurityVersion="WSSecurity11WSTrust13WSSecureConversation13WSSecurityPolicy12BasicSecurityProfile10">
               </security>                
               <httpsTransport manualAddressing="false" maxBufferPoolSize="524288"
                    maxReceivedMessageSize="65536" allowCookies="false" authenticationScheme="Anonymous"
                    bypassProxyOnLocal="false" decompressionEnabled="true" hostNameComparisonMode="StrongWildcard"
                    keepAliveEnabled="true" maxBufferSize="65536" proxyAuthenticationScheme="Anonymous"
                    realm="" transferMode="Buffered" unsafeConnectionNtlmAuthentication="false"
                    useDefaultWebProxy="true" requireClientCertificate="false" />
            </binding>
        </customBinding>
    </bindings>
  <behaviors>
    <endpointBehaviors>
      <behavior>
        <clientVia viaUri="https://secure.gateway.gov.uk/soap/2007/02/sts/GatewayTokenService.ashx"/>
      </behavior>
    </endpointBehaviors>
  </behaviors>
    <client>
        <endpoint address="https://secure.gateway.gov.uk/soap/2007/02/sts/GatewayTokenService.ashx"
            binding="customBinding" bindingConfiguration="XmlTokenServiceBinding"
            contract="ServiceReference1.XmlTokenServicePortType" name="XmlTokenServicePort" />
    </client>
</system.serviceModel> 
```

编辑：呼叫服务评论中要求的代码：

```
 TokenService.RequestSecurityToken request = CreateTokenRequest();   
  TokenService.XmlTokenServicePortTypeClient client = new TokenService.XmlTokenServicePortTypeClient();
  TokenService.RequestSecurityTokenResponseType response = client.RequestSecurityTokenRequest(request); 
```

这里也是通过提琴手的请求消息：

```
<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/" xmlns:a="http://www.w3.org/2005/08/addressing">
<s:Header>
    <a:Action s:mustUnderstand="1">http://schemas.xmlsoap.org/ws/2005/02/trust/RST/Issue</a:Action>
    <a:MessageID>urn:uuid:0f43afa7-c22c-400b-87b2-c9b76bd0abdd</a:MessageID>
    <a:ReplyTo>
        <a:Address>http://www.w3.org/2005/08/addressing/anonymous</a:Address>
    </a:ReplyTo>
        <a:To s:mustUnderstand="1">https://secure.gateway.gov.uk/soap/2007/02/sts/GatewayTokenService.ashx</a:To>
</s:Header>
<s:Body>
    <t:RequestSecurityToken Context="uuid-829d42ad-a560-44aa-9be8-95c212d82762-1" xmlns:t="http://schemas.xmlsoap.org/ws/2005/02/trust">
        <t:TokenType>http://schemas.xmlsoap.org/ws/2005/02/sc/sct</t:TokenType>
        <t:RequestType>http://schemas.xmlsoap.org/ws/2005/02/trust/Issue</t:RequestType>
        <t:KeySize>256</t:KeySize>
        <t:BinaryExchange ValueType="http://schemas.xmlsoap.org/ws/2005/02/trust/spnego" EncodingType="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary">YIGeBgYrBgEFBQKggZMwgZCgGjAYBgorBgEEAYI3AgIeBgorBgEEAYI3AgIKonIEcE5FR09FWFRTAAAAAAAAAABgAAAAcAAAABOP7thI+QdbUguCiBDWyeqYiLGof7AdxPVl4cuUPGbTiMyHDzMox/EGGxas/mzB/AAAAAAAAAAAYAAAAAEAAAAAAAAAAAAAAEVyfDIyRYtIv9kqa6BepAo=</t:BinaryExchange>
    </t:RequestSecurityToken>
</s:Body>
</s:Envelope> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T15:58:41.253

你有任何额外的服务安全配置规范吗？似乎它不仅需要一条消息，还需要多条消息交换（ws-trust）。此外，示例消息使用 wcf 不直接支持的 ws-addressing 版本 2004/03。在您的情况下，所有这些可能是也可能不是问题（也许您只是直接与 STS 合作）

要回答您的直接问题 - 您的设置应该发出一些安全标头。为什么你认为它没有？WCF 日志将不会显示安全性（除非配置为在传输级别记录）。使用 fiddler 来查看线路上的实际情况。

# android - Framelayout 在单击按钮时调用新活动

> ID：10141130
> 
> 赞同：0
> 
> 时间：2012-04-13T12:47:58.633
> 
> 标签：android, layout, frame

我有一个布局，其中有一个框架布局。

我放了2个按钮。当单击button1时，我想在framelayout中调用activity1。所以在framelayout中点击button2调用activity2。

这可能吗？

布局1.xml

```
 <Button
                android:id="@+id/button1"
                android:layout_width="80dp"
                android:layout_height="35dp"
                android:background="@drawable/tab_buton"
                android:text="@string/turlar"
                android:textColor="#ffffff"
                android:textSize="12sp"
                android:textStyle="bold" android:layout_weight="1"/>

            <Button
                android:id="@+id/button2"
                android:layout_width="80dp"
                android:layout_height="35dp"
                android:background="@drawable/tab_buton"
                android:text="@string/alisveris"
                android:textColor="#ffffff"
                android:textSize="12sp"
                android:textStyle="bold" android:layout_weight="1"/>
        </LinearLayout>

<FrameLayout
    android:id="@+id/frameLayout1"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_alignParentLeft="true"
    android:layout_below="@+id/linearLayout2"
    android:layout_marginLeft="5dp"
    android:layout_weight="0.59" android:layout_marginRight="5dp">
</FrameLayout> 
```

活动1.java

```
public class Firsat extends Base {
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.layout1);

} 
```

当我单击 button1 时，调用框架布局中的另一个活动。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T13:10:42.007

我认为这对活动和布局之间的区别没有一个清晰的概念。

布局，指的是 .xml，定义了如何构建你的 UI，在你的屏幕中定位视图。活动是一个容器，作为控制器与您的屏幕、数据等进行交互，并且可以反映您的布局布局上的操作。

因此，如果您的 FrameLayout 中有两个框架，则您只能使用一个活动，在单击按钮后隐藏和显示框架。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T13:10:53.677

不，那是不可能的。活动不能嵌套。打开活动 2 会将活动 1 推入后台。不过，您可以使用*片段*来完成这项工作。

# sql-server - 休眠锁表

> ID：10141138
> 
> 赞同：3
> 
> 时间：2012-04-13T12:48:19.463
> 
> 标签：sql-server, hibernate, seam

Seam 2.2、Jboss 6.1、休眠 3.5.6 和 MSQL Server 2008

并具有这样的功能。

```
public void deliverFile() {
    EntityManager jobbEntityManager = (EntityManager)Component.getInstance("jobbEntityManager");

    JobbStatusInterface jobbStatus = new JobbStatus();
    jobbStatus.setStatus(PluginStatus.INITIATED);
    jobbEntityManager.persist(jobbStatus);

            /**

                 Code here to save a file that takes a minutes
             **/

    jobbStatus.setStatus(PluginStatus.DONE);
    jobbEntityManager.flush();

    }
    public void checkJobb(){
    EntityManager jobbEntityManager =  (EntityManager)Component.getInstance("jobbEntityManager");

        jobbEntityManager.createQuery("from JobbStatus", JobbStatus.class).getResultList();

    } 
```

我每 10 秒对 checkJobb 进行一次投票，所以如果执行了 deliveryFile() 函数。

checkJobb 排队向上并在查询处停止，因此当 deliveryFile() 函数完成时，它会同时完成所有 6 个 checkJobbs()。

即使我直接从数据库中选择，它也会被锁定并在 DeliveryFile() 完成后完成它的查询。

有没有办法解决这个问题，所以我可以在 DeliveryFile 执行时执行我的 checkJobb() ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T14:27:11.097

不知道你想用上面的代码实现什么。如果您想通过加载中间的作业状态来检查作业是否已启动..这可能是不可能的。由于数据尚未提交，并且您在其他功能中使用了不同的会话..您可能无法看到数据。

只有状态的最后一个值将提交到数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T21:03:23.430

READ_COMMITTED_SNAPSHOT 改为普通的 READ_COMMITTED 隔离。

```
ALTER DATABASE <dbname> SET SINGLE_USER WITH ROLLBACK IMMEDIATE; 
ALTER DATABASE <dbname> SET READ_COMMITTED_SNAPSHOT ON; 
ALTER DATABASE <dbname> SET MULTI_USER; 
```

# spring - 服务器重新启动时未清除 Spring MVC 会话（Tomcat）

> ID：10141142
> 
> 赞同：1
> 
> 时间：2012-04-13T12:48:42.067
> 
> 标签：spring, jakarta-ee, spring-mvc, spring-roo

我注意到，当我在会话中存储一个字符串，然后重新启动服务器（而不是发布）时，有时仍会设置相同的会话变量......

服务器重启时不应该清除吗？如果没有，我该如何配置？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T12:06:38.250

尝试在 CATALINA_HOME/conf/context.xml 中取消注释这一行。

```
<!-- Uncomment this to disable session persistence across Tomcat restarts -->
<!--
<Manager pathname="" />
--> 
```

# c# - C# 使用 PdfSharp 从 PDF 中提取文本

> ID：10141143
> 
> 赞同：53
> 
> 时间：2012-04-13T12:48:56.997
> 
> 标签：c#, text, text-extraction, pdfsharp

是否有可能使用 PdfSharp 从 PDF 文件中提取纯文本？由于它的许可证，我不想使用 iTextSharp。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2014-06-04T19:37:48.237

拿了塞尔吉奥的回答，做了一些扩展方法。我还将字符串的累积更改为迭代器。

```
public static class PdfSharpExtensions
{
    public static IEnumerable<string> ExtractText(this PdfPage page)
    {       
        var content = ContentReader.ReadContent(page);      
        var text = content.ExtractText();
        return text;
    }   

    public static IEnumerable<string> ExtractText(this CObject cObject)
    {   
        if (cObject is COperator)
        {
            var cOperator = cObject as COperator;
            if (cOperator.OpCode.Name== OpCodeName.Tj.ToString() ||
                cOperator.OpCode.Name == OpCodeName.TJ.ToString())
            {
                foreach (var cOperand in cOperator.Operands)
                    foreach (var txt in ExtractText(cOperand))
                        yield return txt;   
            }
        }
        else if (cObject is CSequence)
        {
            var cSequence = cObject as CSequence;
            foreach (var element in cSequence)
                foreach (var txt in ExtractText(element))
                    yield return txt;
        }
        else if (cObject is CString)
        {
            var cString = cObject as CString;
            yield return cString.Value;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2014-05-15T01:02:08.460

我实现它的方式与 David 的做法类似。这是我的代码：

```
 {
        // ....
        var page = document.Pages[1];
        CObject content = ContentReader.ReadContent(page);
        var extractedText = ExtractText(content);
        // ...
    }

    private IEnumerable<string> ExtractText(CObject cObject )
    {
        var textList = new List<string>();
        if (cObject is COperator)
        {
            var cOperator = cObject as COperator;
            if (cOperator.OpCode.Name== OpCodeName.Tj.ToString() ||
                cOperator.OpCode.Name == OpCodeName.TJ.ToString())
            {
                foreach (var cOperand in cOperator.Operands)
                {
                    textList.AddRange(ExtractText(cOperand));
                }
            }
        }
        else if (cObject is CSequence)
        {
            var cSequence = cObject as CSequence;
            foreach (var element in cSequence)
            {
                textList.AddRange(ExtractText(element));
            }
        }
        else if (cObject is CString)
        {
            var cString = cObject as CString;
            textList.Add(cString.Value);
        }
        return textList;
    } 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-08-01T08:36:28.873

PDFSharp 提供了从 PDF 中提取文本的所有工具。使用`ContentReader`该类访问每个页面中的命令并从 TJ/Tj 运算符中提取字符串。

我已经将一个简单的实现上传到[github](https://github.com/DavidS/PdfTextract)。

# web-services - 在 Windows xp 上使用 Sun Wireless 工具包 2.5.2 未生成存根

> ID：10141145
> 
> 赞同：1
> 
> 时间：2012-04-13T12:49:01.067
> 
> 标签：web-services, blackberry, stub, sun, java-wireless-toolkit

我正在尝试使用 sun 的无线工具包 2.5.2 生成存根。我电脑上的操作系统是 windows xp。我正在尝试使用以下过程生成存根

```
Start -> SunWirelessToolkit -> Utilities -> stub generator -> launch 
```

然后我把我的网络服务的 wsdl 链接放在那里

并指定输出路径，但现在在指定文件夹中创建文件或输出。

谁能告诉我我做错了什么或者没有生成存根。我在浏览器上复制并粘贴该 URL，它打开并显示整个 wsdl。

我想生成这个存根来使用黑莓中的 web 服务。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T15:09:07.483

您可能遇到连接超时或存根生成器由于防火墙而无法连接。

尝试将 WSDL 文件下载到本地，然后重试。

我不明白为什么存根生成器不产生输出也不给出任何错误。尝试故意放置一个错误的 URL，看看它是否失败。如果仍然没有输出，您可能安装了 J2ME 无线工具包或 Java 错误。

更新：
检查此链接：http: [//developers.sun.com/mobility/apis/articles/wsa/](http://developers.sun.com/mobility/apis/articles/wsa/)

滚动到页面中间，您将找到一个包含受支持数据类型的表格。JSR-172 是 JAX-RPC 的子集，因此并非通常支持所有复杂类型。检查您的 WSDL 不包含任何不受支持的类型。

# javascript - CSS：缩放更改时两列 Div 布局未对齐

> ID：10141148
> 
> 赞同：1
> 
> 时间：2012-04-13T12:49:09.223
> 
> 标签：javascript, html, css

请参阅 jsFiddle [http://jsfiddle.net/Lijo/ryDnn/1/](http://jsfiddle.net/Lijo/ryDnn/1/)。我有两列布局。它是基于 % 的布局——但定义了最小宽度。当我将（浏览器 IE8 的）缩放比例设为 75 % 或更低时，效果很好。当我将缩放设置为 85% 时，橙色框会下降。我们怎样才能克服这种错位呢？无论缩放/浏览器最小化/桌面分辨率如何，橙色框都应保持在正确的位置（如图所示）。它不应该下降。

jsFiddle 中的结果窗口：http: [//jsfiddle.net/Lijo/ryDnn/1/embedded/result/](http://jsfiddle.net/Lijo/ryDnn/1/embedded/result/)

此外，如果您能解释其背后的 CSS 理论，那就太好了。

注意：即使浏览器最小化，也会观察到这种错位。

注意：测试时，我的桌面配置为 1024 by 768。

* * *

即使从 leftNavContainer 和主容器中删除了边距，问题仍然存在。请参阅[http://jsfiddle.net/Lijo/ryDnn/10/](http://jsfiddle.net/Lijo/ryDnn/10/)

![在此处输入图像描述](../Images/e02163c13c4e8235e9a03510a99c9240.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T13:11:32.383

为了允许舍入误差，取一个百分比。`15%`左，`84%`应该工作。

但是，**问题是您也在添加边距**，这显然不会很好。

考虑首先使用两个 div`15%`和`84%`（或者`85%`如果它有效），然后使用这两个 div 作为包装器，在其中放置一个 div 并给出正确的边距。这样，您的利润就不会干扰`width`计算。

换句话说，*边距不是 div 宽度的一部分*。

如有疑问，请广泛使用 Page/Web Inspector 来了解拳击模型...

![](../Images/c416695afec31581c8b7b058aea352fc.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T14:22:46.843

你的总宽度是 100% leftNavContainer 采取的宽度是 25% 因为 margin-left-10px 和 width-15% ,mainContainer 也一样

如果您提供边距意味着减少与边距大小相关的宽度

主容器 css

```
 #mainContainer {

                   width:75%; //(or) reduce your margin
                        } 
```

或者

```
 #leftNavContainer {

                   width:15%; //(or) reduce your margin
                   margin:5px;
                        } 
```

# xmpp - Xmpp聊天隐形存在

> ID：10141155
> 
> 赞同：1
> 
> 时间：2012-04-13T12:49:47.887
> 
> 标签：xmpp, facebook-chat

我正在构建一个监控朋友存在但不需要可见的机器人。我尝试使用所有已知值的优先级、显示、类型来设置存在，但没有成功。是否有可能是不可见的并且只接收存在通知？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T04:41:44.120

请参阅[XEP-0126：隐形](http://xmpp.org/extensions/xep-0126.html)，第 3.1 节：

```
<iq from='bilbo@tolkien.lit/shire' type='set' id='inv1'>
  <query xmlns='jabber:iq:privacy'>
    <list name='invisible'>
      <item action='deny' order='1'>
        <presence-out/>
      </item>
    </list>
  </query>
</iq> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T18:52:58.453

看看[rfc](http://xmpp.org/rfcs/rfc3921.html#sub)。Presence 具有订阅状态。如果您的 bot 已订阅接收来自您的用户的存在，但您的用户没有，则他们不会收到有关 bot 存在的通知。

换句话说，你的机器人应该发送：

```
<presence to="user@example.com" type="subscribe" /> 
```

其次是用户的授权，

```
<presence to="bot@example.com" type="subscribed" /> 
```

现在机器人将收到用户的存在，但不是相反。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T06:13:02.233

要设置不可见状态，您必须发送类型为“不可见”的状态。

```
<presence type="invisible"/> 
```

这是代码（在ios中）：

```
XMPPPresence *presence = [XMPPPresence presenceWithType:@"invisible"];
[[self xmppStream] sendElement:presence]; 
```

我使用此代码将我的状态设置为“不可见”。有关更多详细信息，请阅读[http://xmpp.org/extensions/xep-0018.html#sect-id86210上的文档](http://xmpp.org/extensions/xep-0018.html#sect-id86210)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-15T16:47:53.683

最后我从 Facebook 知道，不可能通过 XMPP 命令实现隐形： [https](https://developers.facebook.com/bugs/315067461919373) ://developers.facebook.com/bugs/315067461919373 。另请参阅**限制**下的[https://developers.facebook.com/docs/chat/](https://developers.facebook.com/docs/chat/)。

# c# - 防止类被实例化的最佳方法？

> ID：10141159
> 
> 赞同：17
> 
> 时间：2012-04-13T12:50:02.253
> 
> 标签：c#

我需要知道如何防止类在.net 中被实例化？

我知道一些方法，比如制作抽象类和静态类。

还有其他方法可以实现这一目标吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-04-13T12:55:07.257

*如果您绝对*不想要任何实例，则将类设为静态是最好的方法。这会阻止*任何人*创建实例。该类将是密封的*和*抽象的，并且不会有*任何*构造函数。

此外，该语言会注意到它是一个静态类，并阻止您在各种*暗示*实例的地方使用它，例如类型参数和变量。这比仅仅拥有一个私有构造函数更清楚地表明了意图——这可能意味着在该类中创建了一些实例（例如，对于单例实现）。

哦，将类设为静态也会阻止您在类中引入任何无意义的实例成员:)

有关静态类的更多信息，请参阅[MSDN](http://msdn.microsoft.com/en-us/library/79b3xss3.aspx)。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-04-13T12:51:46.650

标记构造函数`private`，`protected`或者如果从另一个程序集中使用，`internal`

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-04-13T12:51:20.440

标记构造函数`private`。当然，这并不妨碍类通过`static`方法实例化自己，例如...

更实际的是，禁止类实例化的目的是什么。如果它有一个*单例*，那么一个`private`构造函数是合适的。如果是强制子类化，做类`abstract`更好；如果要拥有一个具有实用方法的类，则使其成为`static`一种方法（那么您只能拥有`static`方法）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-13T12:54:08.710

> 我需要知道如何防止类在.net 中被实例化？

你的问题不清楚。

你的意思是在运行时实例化？制作类`abstract`或`static`.

您的意思是在代码中无法访问构造函数吗？制作构造函数`private`。但请注意，有人仍然可以使用反射来获取构造函数的句柄并在运行时实例化实例。

那么，你的意思是什么？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-13T20:00:09.573

如果问题是：

> `static`如果没有你的类是or ，你怎么能让你的类不被实例化`abstract`？

那么这个问题的答案是实现[单例模式](http://en.wikipedia.org/wiki/Singleton_pattern "关联")，在 .NET 4+ 中，这很容易通过以下方式完成：

```
public sealed class myClass
{
    private static readonly Lazy<myClass> lazyInstance = 
        new Lazy<myClass>(() => new myClass());

    public static Instance
    {
        get
        {
            return lazyInstance.Value;
        }
    }

    private myClass()
    {
        // constructor logic here
    }
} 
```

单例模式允许您将类作为对方法的引用传递，同时仍确保您只有一个类的实例。它还使测试变得更加容易，因为您可以拥有一个实现的`ImyClass`实例`myClass`，这在制作模拟对象时非常有用。

如果没有 .NET4，您仍然可以实现单例模式，例如：

```
private static readonly myClass instance = new myClass();

public static Instance
{
    get
    {
        return instance;
    }
}

// rest of code remains the same 
```

在调用之前没有延迟加载，还有很多其他方法（我认为有 6 种不同的方法），但以上两种是最常见的。

总之，这个问题很可能是问你是否知道单例模式，以及你是否认识到它对于单元测试和模拟对象的静态类的重要性。

正如其他人已经指出的那样，`static`字段，即使是标记的字段`readonly`也可以使用反射设置，此外`private`可以使用反射调用构造函数。如果你需要阻止这些，要么你需要让调用代码在一个不太受信任的应用程序域空间中运行，要么你需要将你的类实现为`static`.

不过，一般来说，人们不会为了绕过你的限制而进行这种级别的反思，除非他们“真的需要”，例如，编写晦涩/极端的边缘案例单元测试。

# c# - 动态绘制具有变化幅度和频率的信号类型

> ID：10141161
> 
> 赞同：2
> 
> 时间：2012-04-13T12:50:07.790
> 
> 标签：c#, draw

正如标题所说：

我有 2 个轨迹栏的表格。一种用于**频率**，一种用于**幅度**。我为即时更改设置了计时器。

```
private void timer1_Tick(object sender, EventArgs e)
    {
        float amplitude, frequency;

        amplitude = Convert.ToSingle(trackBar1.Value) / 100;
        label1.Text = amplitude.ToString() + " V";

        frequency = trackBar2.Value;
        label2.Text = frequency.ToString() + " Hz";
    } 
```

我还有 4 个单选按钮来决定，将显示哪种**类型的信号（正弦、正方形、三角形、锯齿形）**

现在我用 ImageList 实现了这个（改变信号的图像）。

如何绘制信号类型并使用轨迹条对其进行调节？所以它就像在示波器中一样。

感谢您的回答和代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T12:12:15.423

让我们从创建不同的信号类型开始，这是一个创建振幅为 1 的波长的函数：

```
private PointF[] CreateBaseSignal(SignalType signalType)
{
  switch (signalType)
  {
    case SignalType.Sine:
      const int oversampling = 32;
      PointF[] signal = new PointF[oversampling];
      for (int i = 0; i < signal.Length; i++)
      {
        signal[i].X = (float) i / oversampling;
        signal[i].Y = Convert.ToSingle(Math.Sin((double) i / oversampling * 2 * Math.PI));
      }
      return signal;

    case SignalType.Square:
      return new PointF[]
      {
        new PointF(0.0f, -1.0f),
        new PointF(0.5f, -1.0f),
        new PointF(0.5f, 1.0f),
        new PointF(1.0f, 1.0f),
      };

    case SignalType.Triangle:
      return new PointF[]
      {
        new PointF(0.0f, -1.0f),
        new PointF(0.5f, 1.0f),
      };

    case SignalType.Sawtooth:
      return new PointF[]
      {
        new PointF(0.0f, -1.0f),
        new PointF(1.0f, 1.0f),
      };

    default:
      throw new ArgumentException("Invalid signal type", "signalType");
  }
} 
```

然后我们创建具有选定幅度和频率的实际信号：

```
private PointF[] CreateSignal(PointF[] baseSignal, float frequency, float amplitude)
{
  PointF[] signal = new PointF[Convert.ToInt32(Math.Ceiling(baseSignal.Length * frequency))];
  for(int i = 0; i < signal.Length; i++)
  {
    signal[i].X = baseSignal[i % baseSignal.Length].X / frequency + (i / baseSignal.Length) / frequency;
    signal[i].Y = baseSignal[i % baseSignal.Length].Y * amplitude;
  }
  return signal;
} 
```

在尝试将此信号绘制到 PictureBox 之前，我们缩放信号以适应宽度和高度：

```
private PointF[] ScaleSignal(PointF[] signal, int width, int height)
{
  const float maximumAmplitude = 10.0f;
  PointF[] scaledSignal = new PointF[signal.Length];
  for(int i = 0; i < signal.Length; i++)
  {
    scaledSignal[i].X = signal[i].X * width;
    scaledSignal[i].Y = signal[i].Y * height / 2 / maximumAmplitude;
  }
  return scaledSignal;
} 
```

使用 Graphics.DrawLine 绘制信号比 Bitmap.SetPixel 好得多，因为即使在高频下数据点也会连接。Bitmap.SetPixel 也很慢，您确实需要使用 Bitmap.LockBits 和不安全的代码来操作单个像素以实现任何不错的性能。使用 Graphics.DrawLine，您还可以控制线宽、抗锯齿等。

由于我们已将信号存储在 PointF 数组中，因此我们可以使用简单的 Graphics.DrawLines 方法来绘制信号，而不是遍历数据点：

```
private void PlotSignal(PointF[] signal, PictureBox pictureBox)
{
  Bitmap bmp = new Bitmap(pictureBox.ClientSize.Width, pictureBox.ClientSize.Height);
  signal = ScaleSignal(signal, bmp.Width, bmp.Height); // Scale signal to fit image

  using(Graphics gfx = Graphics.FromImage(bmp))
  {
    gfx.SmoothingMode = SmoothingMode.HighQuality;
    gfx.TranslateTransform(0, bmp.Height / 2); // Move Y=0 to center of image
    gfx.ScaleTransform(1, -1); // Make positive Y axis point upward
    gfx.DrawLine(Pens.Black, 0, 0, bmp.Width, 0); // Draw zero axis
    gfx.DrawLines(Pens.Blue, signal); // Draw signal
  }

  // Make sure the bitmap is disposed the next time around
  Image old = pictureBox.Image;
  pictureBox.Image = bmp;
  if(old != null)
    old.Dispose();
} 
```

如果您经常重绘信号，您可能希望重用 Bitmap 和 Graphics 对象，而不是每次都创建新对象。只需记住在每次重绘之间调用 Graphics.Clear。

将所有内容放在一个重要的声明中：

```
PlotSignal(
  CreateSignal(
    CreateBaseSignal(signalType),
    frequency,
    amplitude),
  thePictureBox); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T13:02:19.080

如果您想要一个快速绘图库，我真的很喜欢动态数据显示

[动态数据显示](http://dynamicdatadisplay.codeplex.com/releases/view/26761)

这是一个 WPF 组件，但对于快速、流畅的绘图应用程序，我真的认为尽早移植到 WPF 是值得的。无论如何，感觉你现在对你的项目还不算太远。

该组件的 WPF 开发似乎已停止（尽管 Silverlight 仍在继续开发）。文档很糟糕，但源代码可从上面的链接获得，因此您可以根据需要对其进行扩展（它编写得非常好并且非常可扩展），并且源代码对于几乎完全缺乏任何文档的替代品来说是无价的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T13:22:12.580

假设您要在图片框控件上绘制正弦波，请在表单上创建图片框控件，然后执行以下操作：

```
 int width = pictureBox1.Width;
    int height = pictureBox1.Height;
    Bitmap b = new Bitmap(width, height);

    for (int i = 0; i < width; i++)
    {
        int y = (int)((Math.Sin((double)i * 2.0 * Math.PI / width) + 1.0) * (height - 1) / 2.0);
        b.SetPixel(i, y, System.Drawing.Color.Red);
    }
    pictureBox1.Image = b; 
```

# android - Android - 具有多个项目的可折叠线性布局

> ID：10141162
> 
> 赞同：0
> 
> 时间：2012-04-13T12:50:11.270
> 
> 标签：android, android-layout, visibility, android-linearlayout

我正在尝试通过单击“标题”来列出`LinearLayout`成为列表。`VISIBLE``LinearLayout`

```
<LinearLayout android:id="@+id/sample_title" ...>
    <TextView ... />
</LinearLayout>
<LinearLayout
    android:id="@+id/sample_content"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:visibility="gone" >
    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:duplicateParentState="true"
        android:orientation="horizontal"
        android:visibility="visible" >
        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_weight="1.0"
            android:gravity="left"
            android:text="Sample text 1"
            android:textColor="@color/white" />
        <CheckBox
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="" />
    </LinearLayout>
    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:duplicateParentState="true"
        android:orientation="horizontal"
        android:visibility="visible" >
        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_weight="1.0"
            android:gravity="left"
            android:text="Sample text 2"
            android:textColor="@color/white" />
        <CheckBox
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="" />
    </LinearLayout>
</LinearLayout> 
```

以编程方式：

```
mSampleTitle = (LinearLayout) mView.findViewById(R.id.sample_title);
mSampleTitle.setOnClickListener(this);
mSampleContent = (LinearLayout) mView.findViewById(R.id.sample_content);

[...]

public void onClick(View v) {
    if (v == mSampleTitle) {
        mSampleContent.setVisibility(mSampleContent.getVisibility() == View.VISIBLE ? View.GONE : View.VISIBLE);
    }
} 
```

当只有一个`TextView`要显示时它工作正常，但是一旦有更多，只有第一个变得可见，其余的只是空白。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T12:00:05.497

我的错误，愚蠢的错误。

我忘记了`android:orientation="vertical"`。更改 VISIBILITY 的代码工作正常。

```
<LinearLayout
    android:id="@+id/sample_content"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:visibility="gone" >

<LinearLayout
    android:id="@+id/sample_content"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical"
    android:visibility="gone" > 
```

我仍然觉得奇怪的是，它们在 LinearLayout 水平下方有这么多空白空间......

# android - 从同一网络中的 android 应用程序调试 web 服务

> ID：10141166
> 
> 赞同：0
> 
> 时间：2012-04-13T12:50:25.560
> 
> 标签：android, web-services, vpn

我正在为 android 开发一个使用 .NET webservice 的应用程序。这部分没问题，我已经在 vm 中进行了测试，我的应用确实调用了 web 服务并完成了它应该做的事情。问题是我现在需要“现场”测试它。由于我的应用程序需要蓝牙和模拟器无法提供的其他东西，我必须将它部署在我的手机中并试用。

真正的问题是我的网络服务托管在我的计算机中（而不是在 IIS 中）。如何连接到网络服务？我已经在我的电脑中设置了一个 VPN 连接，这样我就可以在同一个网络中。连接正常，我可以从我的安卓手机 ping 我的电脑（我为此下载了一个应用程序）。但是我尝试使用我的计算机的 ip 调用 web 服务，但它不起作用。我在浏览器上使用此地址：http: [//192.168.56.1](http://192.168.56.1:49365/DataUpload.asmx) : 49365/DataUpload.asmx（其中 192.168.56.1 是我计算机的 IP，DataUpload.asmx 是网络服务的名称）

网络服务的名称和 IP 都可以，但我看不到网络服务。

有谁知道如何帮助我？我想是与端口有关的东西或类似的东西（我的防火墙已禁用）。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T13:50:16.023

几乎可以肯定 192.168.56.1 是您的路由器，这几乎是常态。可以肯定的是，转到您的计算机并在浏览器中使用与您在手机上尝试相同的地址。

发布你的结果。

另一件事是，您必须关闭手机中的“蜂窝”无线电，以确保它仅通过 WiFi 连接。否则，您将不得不找出您家中的 IP 地址，并将您的手机指向该 IP，然后将端口从您的路由器转发到您的本地计算机。

# java - java：我需要将整数显示为字符串值而不添加它们吗？

> ID：10141167
> 
> 赞同：-2
> 
> 时间：2012-04-13T12:50:30.320
> 
> 标签：java

```
public class Test {
    public static void main(String args[]) {
        int a = 0;
        int b = 1;
        int c = 0;
        int d = 2;
        int e = 0;
        String result;
    }
} 
```

在这里，我希望结果值为 01020

我试过这种方式

```
int a = 0;
        int b = 1;
        int c = 0;
        int d = 2;
        int e = 0;

         String aString = Integer.toString(a);
         String bString = Integer.toString(b);
         String cString = Integer.toString(c);
         String dString = Integer.toString(d);
         String eString = Integer.toString(e);

         String result = aString+bString+cString+dString+eString; 
```

请告诉我如何实现结果以将其打印为 01020

非常感谢你

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-13T12:53:24.140

试试这个：

```
String result = String.format("%d%d%d%d%d", a, b, c, d, e); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-13T12:55:40.303

```
System.out.println("" + a + b + c + d + e); 
```

强制结果`"" + ...`类型为字符串，因此不会将这些值相加（只要您不使用括号）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-13T12:52:34.047

您可以使用 String.valueOf(a) 或 java.lang.Integer 的 toString() 方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-13T12:54:53.060

```
public static void main(String args[]) {
    String result = String.valueOf(0) + String.valueOf(1) + String.valueOf(0) + String.valueOf(2) + String.valueOf(0);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-13T12:57:15.623

```
public class Test { 
 public static void main(String args[]) { 
    StringBuilder sb = new StringBuilder();
    int a = 0; 
    int b = 1; 
    int c = 0; 
    int d = 2; 
    int e = 0; 
    sb.append(String.valueOf(a));
    sb.append(String.valueOf(b));
    sb.append(String.valueOf(c));
    sb.append(String.valueOf(d));
    sb.append(String.valueOf(e));
    System.out.println(sb.toString());
} 
```

}

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-01T08:38:14.233

最佳解决方案是取数字并乘以相应的以 10 为底的幂，因此它只需要创建一个 String 对象，而不是为每个数字创建一个并将它们连接在一起 - 这也会为每个连接创建一个新的 String 对象。

```
int a = 0;
int b = 1;
int c = 0;
int d = 2;
int e = 0;
String result = String.valueOf(a*1+b*10+c*100+d*1000+e*10000); 
```

# mysql - 通过 JDBC 执行 INSERT IGNORE 时获取重复计数

> ID：10141169
> 
> 赞同：4
> 
> 时间：2012-04-13T12:50:47.993
> 
> 标签：mysql, jdbc, insert

通过 JDBC 执行 MySQL "INSERT IGNORE" 语句时是否可以获得重复计数？

例如，当我在 mysql 命令行上执行 INSERT IGNORE 语句时，有重复我得到类似

查询正常，0 行受影响（0.02 秒）记录：1 重复：1 警告：0

注意它在哪里说“重复：1”，表示有重复被忽略。

通过 JDBC 执行查询时是否可以获得相同的信息？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-25T23:49:40.910

在执行 INSERT IGNORE 时，您可以使用 ROW_COUNT() 和 FOUND_ROWS() 函数来确定插入行数和重复行数。

例如 ：

```
SELECT ROW_COUNT(), FOUND_ROWS()
    INTO myRowCount, myFoundRows;
myInsertedRows = myRowCount;
myDuplicateRows =  myFoundRows - myInsertedRows;
COMMIT; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T02:50:15.240

`SHOW WARNINGS`我相信您可以通过在插入后 发出来检索它。

[http://dev.mysql.com/doc/refman/5.0/en/show-warnings.html](http://dev.mysql.com/doc/refman/5.0/en/show-warnings.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T03:14:42.283

您可以`rows affected`通过 JDBC 获取值。只需从您插入的行数中减去它。

请记住，这`rows affected`还包括受查询间接影响的行。因此，如果有任何触发器影响其他行，`rows affected`也将包括这些行。

见：[http](http://docs.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html#executeUpdate) ://docs.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html#executeUpdate ()

# mysql - mysql 慢查询获取帖子和标签

> ID：10141171
> 
> 赞同：0
> 
> 时间：2012-04-13T12:50:59.740
> 
> 标签：mysql, database-design

我有三张桌子。一个包含帖子 ( `postadata`)，一个包含标签 ( `tag`) 和一个链接表 ( `tag_data`) 我正在运行查询以使用以下查询连接所有帖子及其标签。

```
 SELECT 
        postdata.data_id as data_id, 
        GROUP_CONCAT(DISTINCT(tag.tag_id)) as tag_ids, 
        GROUP_CONCAT(DISTINCT(tag.tag) ORDER BY tag.tag ASC) as tags
    FROM postdata
    LEFT JOIN tag_data as tag_data
            INNER JOIN tag as tag
                ON tag_data.tag_id = tag.tag_id
    ON postdata.data_id = tag_Data.data_id
    GROUP BY postdata.data_id
    LIMIT 1000 
```

但它非常非常慢。（大约 20 秒）。下面是解释，我似乎找不到问题

```
1   SIMPLE  postdata    index   NULL    source_id   4   NULL            158808  Using index; Using temporary; Using filesort
1   SIMPLE  tag_data    index   PRIMARY PRIMARY     8   NULL            45279   Using index
1   SIMPLE  tag         eq_ref  PRIMARY PRIMARY     4   tag_data.tag_id 1 
```

以下是postdata索引

```
postdata    0   PRIMARY     1   data_id     A   120405  NULL    NULL        BTREE       
postdata    1   source_id   1   source_id   A   168     NULL    NULL        BTREE 
```

是不是查询有问题？有没有办法更有效地编写它？还是缺少索引？

**更新：**根据 jordeu 的评论添加索引信息

显示来自 [database_name] 的表状态，其中 Name='postdata'

```
Name        Engine  Version Row_format  Rows    Avg_row_length  Data_length Max_data_length Index_length    Data_free   Auto_increment  Create_time Update_time Check_time  Collation   Checksum    Create_options  Comment
postdata    InnoDB  10      Compact     158645  43              6832128     0               8421376         4194304     NULL            2012-03-08 09:22:40 NULL    NULL    utf8_unicode_ci NULL 
```

显示像“key_buffer_size”这样的变量

```
key_buffer_size 16777216 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T13:08:37.937

在 LEFT JOIN 之后不需要使用 INNER JOIN。

试试这个方法：

```
SELECT 
    postdata.data_id as data_id, 
    GROUP_CONCAT(DISTINCT(tag.tag_id)) as tag_ids, 
    GROUP_CONCAT(DISTINCT(tag.tag) ORDER BY tag.tag ASC) as tags
FROM postdata
    LEFT JOIN tag_data as tag_data
      ON postdata.data_id = tag_Data.data_id
    LEFT JOIN tag as tag
      ON tag_data.tag_id = tag.tag_id
GROUP BY postdata.data_id
LIMIT 1000 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T13:43:10.010

问题可能是您的索引不适合内存，这会减慢 MySQL 的速度。

例如将“key_buffer_size”增加到 160Mb：

```
SET GLOBAL key_buffer_size = 167772160 
```

如果您使用 InnoDB，您可能还需要增加“innodb_buffer_size”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T12:59:46.443

如果正如评论的那样， DISTINCT 是邪恶的，您可以`DISTINCT`像这样删除并使其独一无二：

```
$arr_tag_ids = array_unique(implode(',', $row->tag_ids));
$arr_tags = array_unique(implode(',', $row->tags)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-13T13:04:54.910

从您的解释看来，您第一次加入时没有使用任何索引。这可能是因为您有两个 JOIN 和两个 ON 条件。我从未见过像这样格式化的 JOIN。尝试像这样更改

```
SELECT 
    postdata.data_id as data_id, 
    GROUP_CONCAT(DISTINCT(tag.tag_id)) as tag_ids, 
    GROUP_CONCAT(DISTINCT(tag.tag) ORDER BY tag.tag ASC) as tags
FROM postdata
    LEFT JOIN tag_data as tag_data
      ON postdata.data_id = tag_Data.data_id
    LEFT JOIN tag as tag
      ON tag_data.tag_id = tag.tag_id
GROUP BY postdata.data_id
LIMIT 1000 
```

然后重新运行 EXPLAIN 并查看它是否有所作为。另外，第一次 JOIN 肯定需要 LEFT JOIN 吗？如果可能的话，将其更改为 INNER JOIN 可能会有所帮助。

# microdata - 如何在产品提供聚合页面中处理 schema.org 微数据标记

> ID：10141179
> 
> 赞同：5
> 
> 时间：2012-04-13T12:51:33.343
> 
> 标签：microdata, schema.org

示例页面是： [http ://www.uswitch.com/mobiles/deals/apple_iphone_4s/](http://www.uswitch.com/mobiles/deals/apple_iphone_4s/)

此页面汇总了特定手机的所有合同交易，我希望在行上添加 schema.org 微数据，据我了解，看来我应该用 schema.org/Offer 标记每一行

这将导致类似：

报价 [itemOffered: x , price: a, ... 其他变体...] ... 报价 [itemOffered: x , price: b, ... 其他变体...]

这是解决这个问题的最好方法吗？

Google 的“Rich Snippets 产品”指南：http: [//support.google.com/webmasters/bin/answer.py](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=146750&topic=1088474&ctx=topic) ?hl=en&answer=146750&topic=1088474&ctx=topic仅列出了 AggregateOffer 的使用，但省略了他们的标记指南页面上显示的每个优惠。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-12T04:19:57.887

[AggregateOffer](http://schema.org/AggregateOffer)类型正好适合这个。

> 当单个产品有不同的offer时（例如，同一双鞋由不同的商家提供），则可以使用AggregateOffer。

此外，Google 支持具有多种优惠的产品。他们甚至[以这种情况为例](http://www.google.com/webmasters/tools/richsnippets?url=http://www.ebay.com/ctg/Logitech-Revue-/97019743)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-13T13:35:06.270

AFAICT，Google Rich Snippets 每页仅支持单个项目。这是有道理的，因为这一切都是为了在搜索结果中更好地显示页面。因此，如果您的目标是让聚合页面在搜索结果中显示得更好，那么在聚合页面上标记各个商品是没有意义的。

您当然可以在页面上为个别交易添加报价标记。

# php - php 5.2 中的排序错误

> ID：10141180
> 
> 赞同：0
> 
> 时间：2012-04-13T12:51:41.097
> 
> 标签：php, codeigniter

嗨，我是 PHP 开发人员的新手

我尝试使用此帮助进行排序[http://www.php.net/manual/en/function.usort.php#103722](http://www.php.net/manual/en/function.usort.php#103722)

```
function usortByArrayKey($key, $asc=SORT_ASC) {
$sort_flags = array(SORT_ASC, SORT_DESC);

if (!in_array($asc, $sort_flags))
    throw new InvalidArgumentException('sort flag only accepts SORT_ASC or SORT_DESC');

return function(array $a, array $b) use ($key, $asc, $sort_flags) {
            if (!is_array($key)) { //just one key and sort direction
                if (!isset($a[$key]) || !isset($b[$key])) {
                    throw new Exception('attempting to sort on non-existent keys');
                }
                if ($a[$key] == $b[$key])
                    return 0;
                return ($asc == SORT_ASC xor $a[$key] < $b[$key]) ? 1 : -1;
            } else { //using multiple keys for sort and sub-sort
                foreach ($key as $sub_key => $sub_asc) {
                    //array can come as 'sort_key'=>SORT_ASC|SORT_DESC or just 'sort_key', so need to detect which
                    if (!in_array($sub_asc, $sort_flags)) {
                        $sub_key = $sub_asc;
                        $sub_asc = $asc;
                    }
                    //just like above, except 'continue' in place of return 0
                    if (!isset($a[$sub_key]) || !isset($b[$sub_key])) {
                        throw new Exception('attempting to sort on non-existent keys');
                    }
                    if ($a[$sub_key] == $b[$sub_key])
                        continue;
                    return ($sub_asc == SORT_ASC xor $a[$sub_key] < $b[$sub_key]) ? 1 : -1;
                }
                return 0;
            }
        }; 
```

}

问题是，我使用的是 PHP 5.2，然后我像这样更改代码

```
function usortByArrayKey(&$array, $key, $asc=SORT_ASC) { 
    $sort_flags = array(SORT_ASC, SORT_DESC); 
    if(!in_array($asc, $sort_flags)) {
        throw new InvalidArgumentException('sort flag only accepts SORT_ASC or SORT_DESC'); 
    }
    $cmp = $this->_usortByArrayKey($key, $asc, $sort_flags); 
    usort($array, $cmp); 
    //return $array;
}

function _usortByArrayKey($key, $asc=SORT_ASC, array $sort_flags, array $a, array $b){ 
    if(!is_array($key)) { //just one key and sort direction 
        if(!isset($a[$key]) || !isset($b[$key])) { 
            throw new Exception('attempting to sort on non-existent keys'); 
        } 
        if($a[$key] == $b[$key]) {
            return 0; 
        }
        return ($asc==SORT_ASC xor $a[$key] < $b[$key]) ? 1 : -1; 
    } else { //using multiple keys for sort and sub-sort 
        foreach($key as $sub_key => $sub_asc) { 
            //array can come as 'sort_key'=>SORT_ASC|SORT_DESC or just 'sort_key', so need to detect which 
            if(!in_array($sub_asc, $sort_flags)) 
            { 
                $sub_key = $sub_asc; $sub_asc = $asc; 
            } 
            //just like above, except 'continue' in place of return 0 
            if(!isset($a[$sub_key]) || !isset($b[$sub_key])) { 
                throw new Exception('attempting to sort on non-existent keys'); 
            } 
            if($a[$sub_key] == $b[$sub_key]) {
                continue; 
            }
            return ($sub_asc==SORT_ASC xor $a[$sub_key] < $b[$sub_key]) ? 1 : -1; 
        } 
        return 0; 
    } 
} 
```

但我仍然得到错误

错误 ：

```
Message: Argument 4 passed to ConnectList::_usortByArrayKey() must be an array, none given, called in C:\xampp\htdocs\receiverlist\application\models\connect.php on line 321 and defined
Uncaught exception 'Exception' with message 'attempting to sort on non-existent keys' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T15:10:15.953

在 codeigniter 中，将 callabck 函数输入 PHP 函数需要类似于：

```
usort($array, array('name-of-controller', 'name-of-method')); 
```

显然在适当的地方替换名称。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T13:02:28.223

您正在写这个： `$cmp = $this->_usortByArrayKey($key, $asc, $sort_flags);` 但是您的函数`_usortByArrayKey`接受 5 个必需参数，而您只传递了 3 个。这就是`Message: Argument 4 passed to ConnectList::_usortByArrayKey() must be an array, none given, called in C:\xampp\htdocs\receiverlist\application\models\connect.php on line 321 and defined` 出现第一条消息的原因

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T13:04:52.210

您询问的问题是您需要将 PHP 5.2 中不可用的匿名函数转换为适用于 PHP 5.2 的函数。功能头：

```
function(array $a, array $b) use ($key, $asc, $sort_flags) 
```

由于这是使用该`use`子句，您需要在 PHP 5.2 中使用一个类来模仿它。简化示例：

```
function ($a) use ($b) 
```

一个类可以是这样的：

```
class Func
{
    private $b;
    public function __construct($b)
    {
        $this->b = $b;
    }
    public function invoke($a) {
        $b = $this->b; # operate on $b, not $this->b
    }
    public function getCallback() {
        return array($this, 'invoke');
    }
} 
```

这是如何运作的？使用示例：

```
$func = new Func($b);
return $func->getCallback(); 
```

模式是什么？

1.  您创建一个表示该函数的新类。
2.  `use`子句中的变量是构造函数参数。
3.  您创建一个`invoke`表示该函数的函数。
4.  在`invoke`函数内部，所有使用变量都被复制到本地范围内。
5.  `getCallback()`函数提供可用于调用函数的回调。

# dojo - Dojo 中有类似 RadWindo 的东西吗？

> ID：10141187
> 
> 赞同：-1
> 
> 时间：2012-04-13T12:52:00.753
> 
> 标签：dojo

Dojo 中有类似 RadWindo 的东西吗？
我想打开一个弹出式样式页面。
我很想看看人们可能有的任何例子。

在 RadWindow 我会做这样的事情：

```
 `RadWindow statusWindow = new RadWindow();
        statusWindow.NavigateUrl = "./StatusWindow.aspx" + qs;
        statusWindow.ID = "sendWindow";
        statusWindow.Visible = true;
        statusWindow.Height = Unit.Pixel(180);
        statusWindow.Width = Unit.Pixel(595);
        statusWindow.Modal = true;` 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T14:02:58.607

您可以将 dojo Dialog 与 contentpane 结合使用：

[http://dojotoolkit.org/documentation/tutorials/1.6/dialogs_tooltips/](http://dojotoolkit.org/documentation/tutorials/1.6/dialogs_tooltips/) http://dojotoolkit.org/documentation/tutorials/1.6/dialogs_tooltips/demo/dialog-terms.html

# vb.net - 如何将值传递给母版页用户控件

> ID：10141191
> 
> 赞同：1
> 
> 时间：2012-04-13T12:52:10.210
> 
> 标签：vb.net, controls, master

我有问题。我有 site.master，其中包括几个用户控件。现在我需要将实际页面代码中的值（字符串）传递给母版页面用户控件（属性）。

**所以我的主人是这样的：**

```
<%@ Master Language="VB" CodeFile="/scripts/pohjakoodit.master.vb" Inherits="pohjakoodit"  AutoEventWireup="false"  debug="false" %> 
```

...在主人的最后有：

```
<ucSheriff:sheriffala ID="sheriffala" statvalue="atesti" runat="server" /> 
```

**然后我有这样开始的实际页面：**

```
<%@ Page Language="vb" MasterPageFile="site.master" AutoEventWireup="false" CodeFile="/scripts/alkuuutisetxw.aspx.vb" Inherits="uutiset_index" debug="true"  %> 
```

**sheriffala.ascx 拥有财产**

```
dim Public staref As String = ""    

    Public Property statvalue() As String
        Get
            Return statvalue
        End Get
        Set(ByVal value As String)
            staref = value
        End Set
    End Property 
```

现在我尝试从文件 alkuuutisetxw.aspx.vb 后面的代码中的用户控件 sheriffala 访问属性 statvalue。

我已经尝试了非常基本的 方法`sheriffala.statvalue = "my srting"` 或 `page.master.sheriffala.statvalue = "my srting"` 尝试了一些绑定，但没有一个没有成功。

那么如何从文件后面的代码中将字符串传递给用户控件属性呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T12:57:38.113

您需要确保您的 UserControl 在 MasterPage 上是公开的。然后在 ContentPage 的 CodeBehind 中，您需要创建 MasterPage 的一个实例，您应该可以访问`statvalue()`，因为它已经是 Public。

或者，如果您不喜欢弄乱设计器文件，则可以创建公开 UserControls 和 MasterPage 的属性：

## 母版页：

```
Public ReadOnly Property UCSheriffala() As Sheriffala
    Get
        Return Me.Sheriffala
    End Get
End Property 
```

## 内容页：

```
Public Shadows ReadOnly Property Master() As Pohjakoodit
    Get
        Return CType(MyBase.Master, Pohjakoodit)
    End Get
End Property 
```

## 使用示例：

```
Response.Write(Master.UCSheriffala.statvalue) 
```

# objective-c - NSArray：为什么发送 SIGABRT 而不是“索引越界”类型的错误？

> ID：10141196
> 
> 赞同：2
> 
> 时间：2012-04-13T12:52:19.693
> 
> 标签：objective-c, xcode, nsarray, sigabrt

行。所以我在`SIGABRT`我正在开发的一个复杂的 Objective-C iOS 程序上遇到了这个非常奇怪的错误，经过一天的跟踪，我找到了罪魁祸首。

假设我们有以下代码：

```
NSArray *a = [NSArray arrayWithObjects:@"a", @"b", @"c", nil];
NSLog(@"tada: %@", [a objectAtIndex:-1]); 
```

为什么这会终止程序`Program received signal: SIGABRT`并且调试器甚至不指向我的代码（而是在某些程序集部分）而不是更好的“索引越界”和“嘿，这行代码是错误的”错误？

我以为我搞砸了项目配置，所以我在一个全新的项目上复制了这个：同样的结果。

有没有办法将 XCode 配置得更好，并以更易于理解的方式指示此类错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T13:01:28.640

[正如文档所说](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSArray_Class/NSArray.html)：

> 如果 index 超出数组的末尾（即，如果 index 大于或等于 count 返回的值），则会引发 NSRangeException

当没有定义异常处理程序时，默认操作是……嗯……你可以看到默认行为是什么。

您*可以*使用@try/@catch 来捕获异常，但这并不是真正的Objective-C-ish。你知道数组中有多少元素；您没有真正需要访问不存在的元素。

像这样的异常通常有一个堆栈跟踪，所以你可以回到导致错误的代码行。（如果 LLDB 和 GDB 不能正常工作，可能值得在 LLDB 和 GDB 之间切换。LLDB 更快更小，但并不完全可靠。（

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T13:01:47.677

如果您在 Xcode 中查看控制台日志，您应该会看到类似于“超出范围的索引”的内容。SIGABRT 是触发断言的结果。有时您必须在崩溃后点击“继续”才能打印消息。

调试器会告诉您崩溃实际发生的位置。它不知道最初的原因是什么。如果调试器让您查看汇编程序，则只需向上移动堆栈直到到达您的代码。

# magento - Magento 网站不断崩溃

> ID：10141197
> 
> 赞同：0
> 
> 时间：2012-04-13T12:52:23.313
> 
> 标签：magento, logfile, exception-logging

我的 magento 网站已经开始崩溃。最近访问该网站时大多显示以下错误消息

```
There has been an error processing your request  
Exception printing is disabled by default for security reasons.
Error log record number: xxxxxxxxxxxx 
```

多次刷新站点后，再次显示正常页面。

写入的错误报告`var/reports/<error log record numer>`开始如下：

```
a:5:{i:0;s:82:"Category Products Index process is working now. Please try run this process later.";i:1;s:2099:"#0 /home/krishbal/public_html/app/code/core/Mage/Index/Model/Process.php(162): Mage::throwException('Category Produc...') 
```

以前有人偶然发现过这个吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T18:54:20.127

我同意*@zpea*。请提供报告文件的内容，我们可以提供帮助。还尝试查看**`var/log/system.log`**并**`var/log/exception.log`**查看您的 magento 安装文件夹。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-04T08:04:37.883

进程名称 ID 代码

产品属性 1 catalog_product_attribute

产品价格 2 catalog_product_price

目录 URL 重写 3 catalog_url

产品平面数据 4 catalog_product_flat

类别平面数据 5 catalog_category_flat

分类产品 6 catalog_category_product

目录搜索索引 7 catalogsearch_stock

库存状态 8 cataloginventory_stock

标记聚合数据 9 tag_summary

对于 ($i = 1; $i <= 9; $i++) {

$process = Mage::getModel('index/process')->load($i);

$process->reindexAll();

}

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T19:12:01.733

删除`var/lock`文件夹的内容并仔细检查权限。

# java - 为 Eclipse 安装了 Hibernate Tools 插件，但无法访问代码生成功能

> ID：10141201
> 
> 赞同：2
> 
> 时间：2012-04-13T12:52:31.830
> 
> 标签：java, hibernate, orm, hibernate-tools

我正在使用 Eclipse Helios SR2，并且刚刚安装了 Hibernate 工具插件（通过更新站点：http: [//download.jboss.org/jbosstools/updates/stable/helios/](http://download.jboss.org/jbosstools/updates/stable/helios/)）。我现在有了创建配置文件、映射文件等的向导，但似乎有些问题：我没有“休眠代码生成菜单”？！因此，我无法根据现有的数据库模式生成域类。

谁能解释我错过了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T07:43:13.203

> “休眠代码生成”菜单仅在我处于休眠状态时出现

不是真的，请尝试以下步骤

*   **菜单**-> 窗口 -> 自定义透视（当前透视）
*   命令组可用性 -> 检查休眠代码生成

# google-app-engine - 从高性能 blobstore 提供图像，无需直接访问 get_serving_url()

> ID：10141204
> 
> 赞同：0
> 
> 时间：2012-04-13T12:52:46.887
> 
> 标签：google-app-engine, http-headers, jinja2

我正在将我的网站转换为使用 blobstore 进行图像服务，但遇到了问题。我有一个页面，其中包含大量动态呈现的图像（通过 jinja），唯一可用的数据是指向包含相关服务 url 的图像对象的实体键。

以前每个图像都有一个 url `"/show-image?key={{image_key}}"`，它指向一个请求处理程序，如下所示：

```
def get(self):
  imageInfo = db.get(self.request.args.get("key"))
  imagedata = imageInfo.data // the image is stored as a blob in the normal datastore
  response = Response()
  response.data = imagedata
  response.headers['Content-Type'] = imageInfo.type
  return response 
```

我的问题是：我怎样才能修改它，而不是返回一个响应`imageInfo.data`，我返回一个响应`imageInfo.saved_serving_url`（从`get_serving_url`创建图像对象时生成）。更重要的是，这甚至是一个好主意吗？似乎将数据转换`saved_serving_url`回数据（例如使用`urllib.fetch`）可能会首先抵消使用高速数据存储的速度和效率？

也许我应该重写我的代码，以便 jinja 模板可以直接访问每个图像的服务 url。但理想情况下，我想避免这种情况，因为我必须传递大量并行列表。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T13:07:13.977

为什么不返回服务网址而不是图像数据？

```
<img src="/show-image?key={{image_key}}" />

def get(self):
  imageInfo = db.get(self.request.args.get("key"))
  return imageInfo.saved_serving_url 
```

# xslt - xsl：对 xsl：for-each 中的不均匀元素进行排序

> ID：10141209
> 
> 赞同：0
> 
> 时间：2012-04-13T12:52:59.893
> 
> 标签：xslt, sorting, xslt-1.0

我有一组具有不同属性的元素，如下所示：

```
<?xml version="1.0" encoding=utf-8"?>
<root>
  <elem at="4" iterate="third" />
  <foo/>
  <elem at="1" iterate="first" />
  <bar/>
  <elem start="3" end="9" iterate="second" />
</root> 
```

我想遍历`elem`标签，所以我指定了`for-each`这样的：

```
<xsl:for-each select="/root/elem"> 
```

到目前为止一切顺利，但现在我想根据它们的and字段对这些元素进行*排序*，而每个元素都保证*有**or*。我在属性中注释了我希望如何迭代标签（只是为了清楚起见）。`@at``@start``elem` *`@at` *`@start``@iterate`**

 **我的方法是这样的

```
<xsl:sort select="@at or @start" data-type="number" order="ascending" /> 
```

但这似乎并没有按预期工作，因为具有`@at`属性的元素似乎优先于具有`@start`属性的元素。

那么，我怎样才能告诉 XSLT (1.0) 不要区分设置的属性的名称，而只是根据其各自的值进行排序呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T13:54:34.313

你不远了。尝试使用联合运算符 |

```
<xsl:sort select="@at|@start" data-type="number" order="ascending" /> 
```

这是完整的 XSLT

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
   <xsl:output method="xml" indent="yes"/>

   <xsl:template match="root">
      <root>
         <xsl:apply-templates select="elem">
            <xsl:sort select="@at|@start" data-type="number" order="ascending" />
         </xsl:apply-templates>
      </root>
   </xsl:template>

   <xsl:template match="@*|node()">
      <xsl:copy>
         <xsl:apply-templates select="@*|node()"/>
      </xsl:copy>
   </xsl:template>
</xsl:stylesheet> 
```

当应用于您的 XML 时，将输出以下内容

```
<root>
   <elem at="1" iterate="first"></elem>
   <elem start="3" end="9" iterate="second"></elem>
   <elem at="4" iterate="third"></elem>
</root> 
```**

# objective-c - Switch 中语句块中的 EXC_BAD_ACCESS 对 imageViewPoistion 的影响

> ID：10141212
> 
> 赞同：3
> 
> 时间：2012-04-13T12:53:06.370
> 
> 标签：objective-c, xcode, exception, switch-statement, parentheses

我有一个奇怪的情况。我在 switch 语句的大括号中的以下代码中遇到异常

```
imageViewPosition = self.imageView6.center;
switch(direction) {
   case(1): 
      if (starty-imageViewPosition.y>50) {
         imageViewPosition.y = starty+100;
      } else {
         imageViewPosition.y = starty;
      }
      break;
   case(2): 
      ...
   }         <----- Here i get the exception 
```

starty 是双重班级成员。而 imageViewPosition 是一个 CGPoint。当我像这样运行它时，我得到一个 EXC_BAS_ACCESS 异常。

在以下情况下，我没有例外，一切都按预期工作。我不明白为什么会这样。

a）当我在 if 语句中添加括号时，一切正常：

```
if ((starty-imageViewPosition.y)>50) { 
```

b）当我将 case 语句放在大括号内时，一切正常。

```
imageViewPosition = self.imageView6.center;
switch(direction) {
   case(1): {
      if (starty-imageViewPosition.y>50) {
         imageViewPosition.y = starty+100;
      } else {
         imageViewPosition.y = starty;
      }
      }
      break; 
```

为什么？我希望 a) 和 b) 选项的答案会有所不同。我之前已经在另一种情况下使用了开关，所以我想了解我做错了什么。谢谢。

# c# - 如何通过减少在多个文档上创建索引

> ID：10141213
> 
> 赞同：3
> 
> 时间：2012-04-13T12:53:09.523
> 
> 标签：c#, ravendb

我有以下文件：

```
 public class User
    {
        public string Id { get; set; }
        public string Email { get; set; }
        public string Password { get; set; }
    }

    public class Book
    {
        public string Id { get; set; }
        public string Title { get; set; }
    }

    public class BookFavorite
    {
        public string Id { get; set; }
        public string UserId { get; set; }
        public string BookId { get; set; }
    } 
```

我想查询书籍列表，如果用户收藏了每本书，我想了解每本书的信息。

实际上是这样的结果：

```
 public class QueryResult
    {
        public Book Book { get; set; }
        public User User { get; set; }
        public bool IsInFavorite { get; set; }
    } 
```

我怎样才能创建我的索引来执行它？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T14:59:29.390

请看这个： [http ://ayende.com/blog/89089/ravenb-multi-maps-reduce-indexes](http://ayende.com/blog/89089/ravendb-multi-maps-reduce-indexes)

它显示了如何加入文档以向用户显示收藏夹。

# php - 如何获取调用脚本的页面名称

> ID：10141222
> 
> 赞同：0
> 
> 时间：2012-04-13T12:53:39.300
> 
> 标签：php, javascript, jquery, ajax

我有一个从 3 个不同页面调用的函数。在每一页中，我都向一个 div 添加了一个属性。

例如：

```
<div id="posts" page="home"></div>
<div id="posts" page="feed"></div>
<div id="posts" page="search"></div> 
```

然后在 Java Script 中获取 page 的值，然后将其传递给 PHP 文件，其中我有一个`if`,`elseif`和`else`声明。

为了更安全，我认为最好在 AJAX 加载的 PHP 文件中获取调用脚本的 url，因为使用谷歌调试工具很简单，有人可以更改 attr。

```
<?php
   if($page =='home' && $sourceUrl == 'the home url' )
   {
       // do this
   }
   elseif($page =='feed' && $sourceUrl == 'the feed url')
   {
       // do this
   }
   elseif($page =='search' && $sourceUrl == 'the search url')
   {
       // do this
   }
   else 
   {
       exit();
   }
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T12:59:47.253

嗯，嗯，你可以使用 javascript 来获取当前页面地址并发送到你的 PHP 文件，你也可以使用 PHP，但这只会让你得到你的 PHP 脚本的地址。

无论如何，您使用javascript执行此操作根本不安全，正确的方法是不要担心发送到服务器的内容，因为服务器端脚本会验证用户的所有输入，而不是相反！

只需检查 PHP 脚本中的某些值，如果收到其他内容，终止 Ajax 调用，这是简单且安全（至少在某种程度上）的解决方案。

为了避免 XSS，您可以在 PHP 的每个页面加载时生成一个随机字符串，该字符串插入到 HTML 中，当然必须是随机的。在每次 ajax 调用时发送该字符串，以避免有人从其他地方向您的脚本发送 ajax 调用。

# performance - postgreSQL 优化

> ID：10141230
> 
> 赞同：1
> 
> 时间：2012-04-13T12:54:17.650
> 
> 标签：performance, postgresql, query-optimization

我正在开发一个大型 PostgreSQL 项目，不幸的是，在生产中（一个有 90 列的表中有 300 万条记录）在大约 2 分钟内运行一个查询（具有 2 个条件的选择/连接）。

假设我的查询没有什么可以优化的，我可以修改任何设置以使其运行得更快吗？这是数据库的配置，我不知道什么适合我的需求：

```
version PostgreSQL 8.4.4 on i686-pc-linux-gnu, compiled by GCC gcc (GCC) 4.1.2 20080704 (Red Hat 4.1.2-44), 32-bit
checkpoint_completion_target    0.9
checkpoint_segments 10
custom_variable_classes pg_stat_statements
effective_cache_size    1GB
lc_collate  fr_FR.UTF-8
lc_ctype    fr_FR.UTF-8
listen_addresses    *
log_autovacuum_min_duration 0
log_line_prefix %t [%p]: [%l-1] user=%u,db=%d
log_min_duration_statement  30s
logging_collector   on
maintenance_work_mem    128MB
max_connections 100
max_stack_depth 2MB
pg_stat_statements.max  1000
pg_stat_statements.save on
pg_stat_statements.track    all
random_page_cost    1.5
server_encoding UTF8
shared_buffers  128MB
TimeZone    Europe/Paris
track_functions pl
wal_buffers 1MB
work_mem    8MB 
```

询问：

```
SELECT distinct
    ((Table_Commande_Historique.COD_STECIAL
    || ',' || Table_Commande_Historique.COD_MCIAL
    || ',' || Table_Commande_Historique.NUM_REC_CLI
    || ',' || Table_Commande_Historique.NUM_DNT_CLI
    || ',' || Table_Commande_Historique.NUM_DDE)) cle
FROM G1DDE2_DDE Table_Commande_Historique
inner join "K2VER2_VER" ver
  on ( Table_Commande_Historique.NUM_REC_CLI
         = (string_to_array(ver.num_cle,','))[3]::int
    OR Table_Commande_Historique.NUM_DNT_CLI
         = (string_to_array(ver.num_cle,','))[3]::int
    OR ver.num_cle = (Table_Commande_Historique.COD_MCIAL
                     || ',' || Table_Commande_Historique.NUM_REC_CLI)
    OR ver.num_cle = (Table_Commande_Historique.COD_MCIAL
                     || ',' || Table_Commande_Historique.NUM_DNT_CLI) ); 
```

索引：

```
CREATE INDEX idx_combo1
  ON g1dde2_dde
  USING btree
  (((cod_mcial || ','::text) || num_rec_cli) );

  CREATE INDEX idx_combo2
  ON g1dde2_dde
  USING btree
  (((cod_mcial || ','::text) || num_dnt_cli) );

  CREATE INDEX idx_dnt
  ON g1dde2_dde
  USING btree
  (num_dnt_cli );

  CREATE INDEX idx_rec
  ON g1dde2_dde
  USING btree
  (num_rec_cli );

  CREATE INDEX idx_k2ver3sb
  ON "K2VER2_VER"
  USING btree
  (num_cle ); 
```

解释：

```
"HashAggregate  (cost=197.97..201.77 rows=69 width=29)"
"  ->  Nested Loop  (cost=1.29..197.35 rows=248 width=29)"
"        ->  Seq Scan on "K2VER2_VER" ver  (cost=0.00..2.58 rows=58 width=19)"
"        ->  Bitmap Heap Scan on g1dde2_dde table_commande_historique  (cost=1.29..2.84 rows=5 width=29)"
"              Recheck Cond: ((table_commande_historique.num_rec_cli = ((string_to_array((ver.num_cle)::text, ','::text))[3])::integer) OR (table_commande_historique.num_dnt_cli = ((string_to_array((ver.num_cle)::text, ','::text))[3])::integer) OR ((ver.num_cle)::text = (((table_commande_historique.cod_mcial)::text || ','::text) || (table_commande_historique.num_rec_cli)::text)) OR ((ver.num_cle)::text = (((table_commande_historique.cod_mcial)::text || ','::text) || (table_commande_historique.num_dnt_cli)::text)))"
"              ->  BitmapOr  (cost=1.29..1.29 rows=5 width=0)"
"                    ->  Bitmap Index Scan on idx_rec  (cost=0.00..0.32 rows=2 width=0)"
"                          Index Cond: (table_commande_historique.num_rec_cli = ((string_to_array((ver.num_cle)::text, ','::text))[3])::integer)"
"                    ->  Bitmap Index Scan on idx_dnt  (cost=0.00..0.32 rows=1 width=0)"
"                          Index Cond: (table_commande_historique.num_dnt_cli = ((string_to_array((ver.num_cle)::text, ','::text))[3])::integer)"
"                    ->  Bitmap Index Scan on idx_combo1  (cost=0.00..0.32 rows=1 width=0)"
"                          Index Cond: ((ver.num_cle)::text = (((table_commande_historique.cod_mcial)::text || ','::text) || (table_commande_historique.num_rec_cli)::text))"
"                    ->  Bitmap Index Scan on idx_combo2  (cost=0.00..0.32 rows=1 width=0)"
"                          Index Cond: ((ver.num_cle)::text = (((table_commande_historique.cod_mcial)::text || ','::text) || (table_commande_historique.num_dnt_cli)::text))" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T16:19:53.193

```
version PostgreSQL 8.4.4 
```

那是个问题。请阅读此内容并考虑发布一个小版本来修复安全漏洞和错误：

[http://www.postgresql.org/support/versioning/](http://www.postgresql.org/support/versioning/)

这些有时包括引入性能问题的错误。要查看您将获得哪些修复，您可以在此处查看 8.4.5 到 8.4.11 的注释：

[http://www.postgresql.org/docs/8.4/static/release.html](http://www.postgresql.org/docs/8.4/static/release.html)

一些基于 RAM 的设置可能太低了，但在不知道系统上有多少 RAM 以及那里运行的其他内容的情况下，无法建议具体数字。

```
shared_buffers  128MB 
```

对于 Linux 上的专用数据库服务器，通常的建议是将其设置为系统总 RAM 的 25%，最大可能为 8GB，并根据基准测试从那里进行调整。

```
effective_cache_size    1GB 
```

这不会分配任何 RAM，但允许规划器根据对同一查询中先前读取的文件仍处于缓存中的可能性的估计来计算重复读取文件的成本。我建议您将 shared_buffers 大小添加到操作系统显示为缓存的内容中。

```
work_mem    8MB 
```

这个很棘手。它确实可以通过多种方式提高查询性能，但高值往往会将事物推出缓存，从而增加磁盘访问。您还需要考虑每个查询可以多次分配这么多空间（针对不同的查询步骤），因此您通常应该允许每个允许的连接分配一个这种大小的空间。这是使用连接池将大量用户集中到有限数量的实际数据库连接通常有益的原因之一*。*如果你能负担得起更大的尺寸，它很可能有助于这个查询，因为它可以防止位图索引扫描变得“有损”并需要重新检查索引条件。

您没有设置`cpu_tuple_cost`，但我发现默认设置通常太低而无法提供整体最佳计划。鉴于您的大表有 90 列，我建议将其从 0.01 提高到 0.05。

您没有设置`effective_io_concurrency`，但这可能会有所帮助。我会用不同的值进行测试。（当然，在运行测试以比较替代方案的性能时，请注意缓存问题。）

```
maintenance_work_mem    128MB 
```

根据您拥有多少 RAM，这可能合理，也可能不合理。它不会影响您眼前的问题，但增加它可能有助于 autovacuum 更有效地运行，并有助于索引构建运行得更快。

这些可能有点低：

```
checkpoint_segments 10
wal_buffers 1MB 
```

它们不是您当前问题的一部分，但它们有时可能会导致额外的磁盘写入，因此调整它们可能会有所回报。 `wal_buffers`除非您的机器的 RAM 非常有限，否则通常应该是 32MB。 `checkpoint_segments`在不了解更多信息的情况下很难估计，但如果您检查日志和统计信息并发现检查点发生得太频繁，您可能需要增加此值，直到检查点发生基于`checkpoint_timeout`.

# jquery - 无需加载两次即可对图像加载进行操作

> ID：10141232
> 
> 赞同：1
> 
> 时间：2012-04-13T12:54:22.453
> 
> 标签：jquery, image, loading

我正在加载图像并在图像完成并且各种 css 和动画完成后显示。但我想调用图像来检查函数内的宽度和高度：

```
$('.ePage').find('img').each(function(){
    var $img    = $(this);
    $('<img/>').load(function(){

         // my css and animations
         // need to check height and width

    }).attr('src',$img.attr('src'));
}); 
```

只有我不想加载图像两次。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T12:57:41.077

```
$('.ePage').find('img').each(function(){
    var $img    = $(this);
    $('<img/>').load(function(){

         console.log($(this).css("width"));
         console.log($(this).css("height"));
         console.log($(this).width());
         console.log($(this).height());

    }).attr('src',$img.attr('src'));
}); 
```

*   [http://api.jquery.com/css/](http://api.jquery.com/css/)
*   [http://api.jquery.com/width/](http://api.jquery.com/width/)
*   [http://api.jquery.com/height/](http://api.jquery.com/height/)

# php - 从 PHP 数组中过滤出一组坏词

> ID：10141233
> 
> 赞同：1
> 
> 时间：2012-04-13T12:54:27.977
> 
> 标签：php

我有一个包含大约 20,000 个名称的 PHP 数组，我需要对其进行过滤并删除名称中包含单词`job`、`freelance`或`project`的任何名称。

下面是我到目前为止开始的内容，它将循环遍历数组并添加清理过的项目以构建一个新的清理数组。不过，我需要帮助匹配“坏”词。如果可以的话请帮忙

```
$data1 = array('Phillyfreelance' , 'PhillyWebJobs', 'web2project', 'cleanname');

// freelance
// job
// project

$cleanArray = array();
foreach ($data1 as $name) {
    # if a term is matched, we remove it from our array
    if(preg_match('~\b(freelance|job|project)\b~i',$name)){
        echo 'word removed';

    }else{
        $cleanArray[] = $name;
    }

} 
```

现在它匹配一个单词，所以如果“freelance”是数组中的一个名称，它会删除该项目，但如果它是类似的，`ImaFreelaner`那么它不会，我需要删除任何包含匹配单词的东西

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T13:07:09.997

这里不需要正则表达式——使用几个[`stripos`](http://php.net/stripos)调用可能会更快。（性能在此级别上很重要，因为搜索会针对 20,000 个名称中的每一个进行。）

With [`array_filter`](http://php.net/array_filter)，它只保留回调返回的数组中的元素`true`：

```
$data1 = array_filter($data1, function($el) {
        return stripos($el, 'job') === FALSE
            && stripos($el, 'freelance') === FALSE
            && stripos($el, 'project') === FALSE;
}); 
```

* * *

这是一个更可扩展/可维护的版本，可以从数组中加载坏词列表，而不必在代码中明确表示：

```
$data1 = array_filter($data1, function($el) {
        $bad_words = array('job', 'freelance', 'project');
        $word_okay = true;

        foreach ( $bad_words as $bad_word ) {
            if ( stripos($el, $bad_word) !== FALSE ) {
                $word_okay = false;
                break;
            }
        }

        return $word_okay;
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T13:13:28.310

我倾向于使用[array_filter](http://php.net/manual/en/function.array-filter.php)函数并将正则表达式更改为在单词边界上不匹配

```
$data1 = array('Phillyfreelance' , 'PhillyWebJobs', 'web2project', 'cleanname');

$cleanArray = array_filter($data1, function($w) { 
     return !preg_match('~(freelance|project|job)~i', $w); 
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-13T12:58:00.960

这应该是你想要的：

```
if (!preg_match('/(freelance|job|project)/i', $name)) {
    $cleanArray[] = $name;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-13T13:06:47.157

使用该`preg_match()`函数和一些正则表达式应该可以解决问题；这就是我想出的，它对我来说效果很好：

```
<?php
    $data1=array('JoomlaFreelance','PhillyWebJobs','web2project','cleanname');
    $cleanArray=array();
    $badWords='/(job|freelance|project)/i';
    foreach($data1 as $name) {
        if(!preg_match($badWords,$name)) {
            $cleanArray[]=$name;
        }
    }
    echo(implode($cleanArray,','));
?> 
```

哪个返回：

```
cleanname 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-13T13:06:58.420

就个人而言，我会做这样的事情：

```
$badWords = ['job', 'freelance', 'project'];
$names = ['JoomlaFreelance', 'PhillyWebJobs', 'web2project', 'cleanname'];

// Escape characters with special meaning in regular expressions.
$quotedBadWords = array_map(function($word) {
    return preg_quote($word, '/');
}, $badWords);

// Create the regular expression.
$badWordsRegex = implode('|', $quotedBadWords);

// Filter out any names that match the bad words.
$cleanNames = array_filter($names, function($name) use ($badWordsRegex) {
    return preg_match('/' . $badWordsRegex . '/i', $name) === FALSE;
}); 
```

# java - 带有@Autowired注解的Spring依赖注入，没有setter

> ID：10141235
> 
> 赞同：27
> 
> 时间：2012-04-13T12:54:43.980
> 
> 标签：java, spring, dependency-injection, autowired

几个月以来我一直在使用 Spring，我认为带有`@Autowired`注释的依赖注入还需要一个 setter 来注入该字段。

所以，我这样使用它：

```
@Controller
public class MyController {

    @Autowired
    MyService injectedService;

    public void setMyService(MyService injectedService) {
        this.injectedService = injectedService;
    }

    ... 
```

}

但我今天试过这个：

```
@Controller
public class MyController {

    @Autowired
    MyService injectedService;

    ... 
```

}

哦，令人惊讶的是，没有编译错误，启动时没有错误，应用程序运行完美......

所以我的问题是，带有`@Autowired`注释的依赖注入是否需要setter？

我正在使用 Spring 3.1.1。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-04-13T13:00:05.960

您不需要带有@Autowired 的设置器，该值是通过反射设置的。

检查这篇文章以获得完整的解释[Spring @Autowired 如何工作](https://stackoverflow.com/questions/3536674/how-does-spring-autowired-work)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-13T13:01:17.003

不，如果 Java 安全策略允许 Spring 更改包受保护字段的访问权限，则不需要设置器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-07-07T10:03:14.550

```
package com.techighost;

public class Test {

    private Test2 test2;

    public Test() {
        System.out.println("Test constructor called");
    }

    public Test2 getTest2() {
        return test2;
    }
}

package com.techighost;

public class Test2 {

    private int i;

    public Test2() {
        i=5;
        System.out.println("test2 constructor called");
    }

    public int getI() {
        return i;
    }
}

package com.techighost;

import java.lang.reflect.Field;

public class TestReflection {

    public static void main(String[] args) throws ClassNotFoundException, InstantiationException, IllegalAccessException {
        Class<?> class1 = Class.forName("com.techighost.Test");
        Object object = class1.newInstance();
        Field[] field = class1.getDeclaredFields();
        field[0].setAccessible(true);
        System.out.println(field[0].getType());
        field[0].set(object,Class.forName(field[0].getType().getName()).newInstance() );
        Test2 test2 = ((Test)object).getTest2();
        System.out.println("i="+test2.getI());

    }
} 
```

**这就是使用反射完成的方式。**

# objective-c - 如何在 UITextView 中跟踪来自 UIPickerView 的选择？

> ID：10141239
> 
> 赞同：0
> 
> 时间：2012-04-13T12:54:54.637
> 
> 标签：objective-c, ios5, uitextview, uipickerview

我有一个带有 UITextView 的项目，用于显示我从 UIPickerView 中的选择。我已经可以显示选择，但是当我选择另一个选择时，它会覆盖前一个选择，我需要跟踪我所做的所有选择。

这是我的代码：

```
NSString *msg = [NSString stringWithFormat: @"Você comprou %@ %@ e pagará R$ %.2f.",
                 [quantidade objectAtIndex:[pickerView selectedRowInComponent:1]],
                 [produtos objectAtIndex:[pickerView selectedRowInComponent:0]], total];

texto.text = msg; 
```

有人可以帮忙吗？？？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T14:45:13.200

一个解决方案可能是在视图控制器中创建一个实例变量 NSMutableString。然后，每次，您从选择器视图中选择一个新值，只需在字符串中附加新选择，例如：

在.h

```
NSMutableString *mutableStr; 
```

在.m

```
// In your init
mutableStr = [[NSMutableString alloc] initWithString:@""];

// When a selection is made
[mutableStr appendFormat:@"Você comprou %@ %@ e pagará R$ %.2f.",
                 [quantidade objectAtIndex:[pickerView selectedRowInComponent:1]],
                 [produtos objectAtIndex:[pickerView selectedRowInComponent:0]], total]; 
```

# c++ - typedef 枚举输入

> ID：10141241
> 
> 赞同：0
> 
> 时间：2012-04-13T12:55:02.763
> 
> 标签：c++, enums, typedef

如果我们在 C++ 中有这个：

```
typedef enum {Unknown,USA,Canada,France,England,Italy,Spain,Australia,} origin_t;

origin_t Country;
char *current;
cin>>current; 
```

我们如何设置`Country`为用户输入的 c-String `current`？因为我们有一个很大的列表，所以除了一个一个比较？最快的方法？非常感谢您。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-13T12:58:11.640

C++ 中的`enum`and `string`or之间没有直接的转换，就像在 Java 中一样。`char*`

一种有效的方法是拥有一张地图：

```
#include <map>
#include <string>

typedef enum {Unknown,USA,Canada,France,England,Italy,Spain,Australia,} origin_t;

std::map<std::string, origin_t> countries;
countries["Unknown"] = Unknown;
countries["USA"] = USA;
//...

origin_t Country;
std::string current;
cin>>current;
Country = countries[current]; 
```

请注意，在我的示例中，我使用`std::string`的`char*`是 ，除非您有充分的理由使用 ，否则您应该这样做`char*`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T13:07:20.857

我使用的是一组 POD 结构。该结构包含与特定枚举对应的字符的枚举和 const char *。然后我使用 std::find 来查找 enum 或 char * 取决于需要哪个。

POD 数组的优点是一切都在程序加载时初始化。无需加载地图。

缺点是 std::find 的线性搜索。但这从来都不是问题，因为我从来没有大量的枚举值。

以上都隐藏在实现文件中。标题只有功能。通常一个从枚举转换为 std::string，另一个从 std::string 转换为枚举。

# android - 如何正确移动视图？

> ID：10141244
> 
> 赞同：2
> 
> 时间：2012-04-13T12:55:12.890
> 
> 标签：android, animation, view, position

有人可以向菜鸟解释动画视图的正确方法，以便它的触摸区域和图像实际上一起移动吗？！

我已经阅读了很多帖子、问题和教程，但没有人解释什么会移动布局以及什么会移动图像，以便我可以为视图设置动画，然后将其保留在新位置。

这是我正在使用的示例方法，尝试了许多不同的组合都没有成功。该视图位于父级 RelativeLayout 中。它是一个可触摸的图标菜单，并通过单击以滑出屏幕时使用 xml 资源进行动画处理，只留下一个小选项卡显示，它需要一直停留到再次单击。

```
public void RetractTools (View v){      
    final ImageView finalImage1 = (ImageView) findViewById(R.id.paintsView);
    Animation slideout = AnimationUtils.loadAnimation(this, R.anim.slideout_tools);
    slideout.setFillAfter(true);
    slideout.setAnimationListener(new AnimationListener() {
        @Override
        public void onAnimationEnd(Animation animation) {
            finalImage1.setEnabled(true);
            optionMenu.showing = false;
            optionMenu.inMotion = false;
            finalImage1.layout(1258, 668, 1697, 752);
            finalImage1.setRight(1280);
            finalImage1.invalidate();
        }

        @Override
        public void onAnimationRepeat(Animation arg0) {
        }

        @Override
        public void onAnimationStart(Animation arg0) {
            finalImage1.setEnabled(false);
        }
    });

    optionMenu.inMotion = true;
    v.startAnimation(slideout);
 }// End RetractMenu 
```

无论我尝试什么，我都会遇到问题。setFillAfter 在 xml 文件中设置时不执行任何操作。以编程方式设置，它将图像留在正确的位置，但触摸控件仍保留在菜单所在的位置。我尝试过 setLeft 和 setRight ，它们显然只移动图像，而不是视图位置，以及各种不同的布局选项，填充和不填充和无效，但无法解决。我显然不了解定位和渲染视图所需的基础机制！:D

谢谢。

***编辑：解决方案***

对于任何有类似问题的人，这就是我发现使用相对布局的方式。您创建一个具有指定大小的 LayoutParams 对象，然后您可以为其分配位置。例如。

```
 final RelativeLayout.LayoutParams position = new RelativeLayout.LayoutParams(RelativeLayout.LayoutParams.WRAP_CONTENT, RelativeLayout.LayoutParams.WRAP_CONTENT);           
    position.leftMargin = 440; 
```

然后将其分配给您的视图

```
 myView.setLayoutParams(position); 
```

所以总而言之，您使用 LayoutParams 对象作为视图位置的接口，而不是像我假设的那样直接访问视图的坐标。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T13:01:54.383

你所拥有的基本上是好的，有两个缺陷：

1.  您正在使用`setFillAfter()`，这不是特别有用

2.  你在打电话`layout()`等等`setRight()`，这不是特别有效

相反，在 中`onAnimationEnd()`，您需要修改 的`LayoutParams`以`View`反映您希望小部件所处的新位置。小部件的大小和位置由它与其容器协商的布局规则决定。最初，这些是通过您的布局 XML 资源设置的。通过修改`LayoutParams`运行时，您正在更改这些规则。

这些`LayoutParams`是什么（`LinearLayout.LayoutParams`、`RelativeLayout.LayoutParams`等）以及您应该在其中指定什么值，我们无法告诉您，因为我们不知道您在做什么。

# qt - Qt：在添加小部件后执行操作（滚动）

> ID：10141245
> 
> 赞同：0
> 
> 时间：2012-04-13T12:55:14.280
> 
> 标签：qt, user-interface

我有一个水平滚动区域并在其中动态添加小部件。

我希望它在添加新小部件时滚动到最后，以便用户使用此方法看到最后一个小部件：

```
void scrollToEnd()
{
    scroll->horizontalScrollBar()->setValue(100000);
}

...

layout->addWidget(widget);
scrollToEnd(); 
```

`layout->addWidget()`但是，调用和实际小部件出现之间存在延迟。所以调用`scrollToEnd()`什么都不做。

例如，如果我通过显示 MessageBox 来暂停一下，一切正常。

有没有办法等到显示小部件，然后滚动滚动区域？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T15:26:55.680

`addWidget`可能会在重新进入事件循环之后安排实际添加小部件，所以你应该做同样的事情并`scrollToEnd`异步调用方法（它必须是一个插槽）：

```
layout->addWidget(widget);
QTimer::singleShot(0, this, SLOT(scrollToEnd())); 
```

# asp.net - 如何记录和分析我网站上的某些用户操作

> ID：10141250
> 
> 赞同：2
> 
> 时间：2012-04-13T12:55:32.847
> 
> 标签：asp.net, statistics, monitoring

我有一个提供搜索体验的简单页面。它允许用户通过查询表单进行搜索，过滤结果，并根据第一次搜索的结果执行更深入的搜索。

我想获得一些关于用户体验以及他们如何使用页面的指标。大多数用户操作都转换为新的查询字符串。例如：

*   有多少用户执行搜索然后跟进另一个搜索/过滤器
*   在搜索查询中使用了多少次通配符
*   用户在新搜索之前浏览了多少结果

由于版权问题，我也受限于使用谷歌分析和排序（也许我可以提出一个案例，如果它真的是开放网络分析或其他的方式）。服务器端我正在考虑使用 cookie 来跟踪用户并使用 log4net 来记录他们所做的事情，然后将信息转储到数据库中并从那里进行分析。或者登录到事件查看器并使用日志查看器从那里获取信息。

您认为总体上更好的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T14:51:29.297

我建议您为此使用现有的、现成的解决方案，而不是构建自己的解决方案 - 这是一种规模迅速增长的项目。您从问题中的 3 个指标变为“哦，您能否按用户浏览的国家/地区对其进行细分？”，“哪些语言会影响问题？”，“如果他们点击结果，他们最终会购买任何东西吗？香蕉？”。然后，在不知不觉中，您已经构建了自己的网络分析工具......

因此，您可以使用像 Google Analytics 这样的“网络分析即服务”产品，或者使用更老式的日志解析解决方案。您想回答的大部分问题都可以从 IIS Web 日志中的数据中得出；有许多应用程序可以解析这些数据，包括开源和免费解决方案。

我已经很久没有使用基于日志文件的分析工具了，但是我的 ISP 提供了[AWStats](http://www.awstats.org/)，这看起来很不错 - 做你想做的事，你必须在你的搜索页面周围设置特定的测量值；不确定 AWSStats 是否会这样做（Google Analytics 肯定会这样做）；检查[Wikipedia](http://en.wikipedia.org/wiki/List_of_web_analytics_software)列表以获取执行此操作的日志文件分析工具。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T13:18:46.387

显然，您需要记录搜索页面的每次提交。特别是您需要记录：

*   日期时间.Now
*   搜索字符串
*   会话ID

您还可以在 Session 中存储一个计数器，每次用户加载页面时都会增加一个计数器，而不是搜索页面。如果用户执行搜索，您可以从会话中读取该值，将其存储在数据库中并重置计数器。

请注意，由于 cookie 支持、多选项卡、页面重新加载等原因，“用户在新搜索之前浏览了多少结果”这一指标只能作为估计值，而不是真正的指标。

# android - Android：getAssets().openFd() 和 FileNotFoundException

> ID：10141251
> 
> 赞同：6
> 
> 时间：2012-04-13T12:55:38.413
> 
> 标签：android, android-assets

我正在尝试从 assets 文件夹中读取一个 txt 文件，如下所示：

```
descriptor = context.getAssets().openFd("openAccess.txt");
reader = new FileReader(descriptor.getFileDescriptor()); 
```

但我得到了这个例外：

> java.io.FileNotFoundException：这个文件不能作为文件描述符打开；它可能被压缩了

我不知道是什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T13:20:37.003

这个怎么样：

```
InputStream in = context.getAssets().open("openAccess.txt");
reader = new InputStreamReader(in); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T13:36:32.010

试试这个 ：

```
AssetFileDescriptor descriptor = getAssets().openFd("openAccess.txt");
BufferedReader f = new BufferedReader(new FileReader(descriptor.getFileDescriptor()));
String line = f.readLine();
while (line != null) {
    // do stuff
    Log.d("TAG",line);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-06-15T12:18:53.933

对我来说，它是在 /res 中创建一个“行”文件夹并在其中复制文件。然后你可以使用：

```
InputStreamReader iReader = new InputStreamReader(getResources().openRawResource(R.raw.text))); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-13T13:09:08.357

像这样使用。文件路径。

```
context.getAssets().openFd("file:///android_asset/openAccess.txt"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-13T13:31:07.333

您可以在 Asset 中创建新文件夹并将文件放在该文件夹中，然后尝试从该文件夹中获取该文件

# php - 是否有任何开源签入/签出系统？

> ID：10141258
> 
> 赞同：2
> 
> 时间：2012-04-13T12:56:11.377
> 
> 标签：php, open-source, registration, barcode

我在一栋大楼工作，人们到达时要登记入住，离开时应该退房。有必要：

*   消防法规
*   它告诉接待员访客的会员资格是否有效
*   营销团队希望将其用于 CRM

目前，访客通过使用条形码阅读器扫描他们的会员卡来登记入住，并与接待员交谈以结帐。然而，这个过程对于访客和接待员来说都非常低效，因此数据通常非常不准确。

我正在寻找更强大的解决方案。显然，我可以构建一些东西，但我想知道是否已经存在某种开源解决方案。它需要有一个 API 才能与其他现有系统集成。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-29T19:26:33.583

我能够找到**一个**开源项目：**[PHPTimeClock](https://github.com/SteveCastle/PHP-Time-Clock)**

经过简短的代码审查后，我注意到它没有**一流**的编码实践。然而，它确实提供了一种快速启动类似项目的方法，并且至少提供了一些关于从哪里开始的想法。

它也没有得到积极维护（考虑到最后一次/唯一一次提交是 7 个月前）。

取自[ohloh.net](http://www.ohloh.net/p/phptimeclock)：

> PhpTimeClock 最初由 Ken Papizan 创立，发展成为许多公司易于使用且稳定的时钟解决方案。经过一段时间的闲置后，该项目重新启动并以新网站和新代码的形式赋予了新的生命。PhpTimeClock 致力于成为首屈一指的开源时钟解决方案，适用于小型公司和大型企业。

# php - 在 Symfony2 中覆盖另一个包中的实体

> ID：10141262
> 
> 赞同：2
> 
> 时间：2012-04-13T12:56:24.370
> 
> 标签：php, orm, symfony, doctrine

我们正在编写基于 Symfony2 的自定义 CMS，目前正在开发用户系统。我们的包定义了一个`BaseSiteUser`包含站点可能需要的用户数据的所有最常见属性的一个，以及一个`SiteUser`扩展`BaseSiteUser`和定义实体表的一个。

这个想法是，对于每个单独的项目，我们将`SiteUser`通过在新项目的命名空间中创建一个更具体的实体来覆盖实体，或者如果我们不指定新的，则使用默认的实体。

我们的 bundle 架构看起来有点像这样：

```
OurCompany
  CMSBundle
    Entities
      BaseSiteUser.php
      SiteUser.php

CustomerName
  CustomerProjectBundle
  CMSBundle
    Entities
      SiteUser.php 
```

我们的问题是我们无法构建模型，以便使用`SiteUser`定义的 in`CustomerName\CMSBundle`而不是 in `OurCompany\CMSBundle`。相反，我们得到了这个错误：

```
 [Doctrine\DBAL\Schema\SchemaException]
  The table with name 'siteuser' already exists. 
```

我们尝试查阅[文档](http://symfony.com/doc/current/cookbook/bundles/override.html)，但尚未涵盖该部分。搜索网络也没有提供解决方案。

我们正在使用注释方法来定义模型。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T14:08:22.497

我已经删除了我之前的答案，因为它是错误的:)。刚刚检查了`FOSUserBundle`. 他们正在使用[继承映射](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/inheritance-mapping.html)。因此，在您的核心`CMSBundle`定义`BaseSiteUser`为`@MappedSuperclass`和覆盖的捆绑包中，只需扩展`BaseSiteUser`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-30T14:48:09.830

我认为这个解决方案应该有效（伪代码）：

```
我们公司   
  CMSBundle
    实体

      /**
      * BaseSiteUser
      *
      * @ORM\Entity(repositoryClass="OurCompany\CMSBundle\Repository\SiteUserRepository")
      * @ORM\Table(name="siteuser")
      * @ORM\InheritanceType("SINGLE_TABLE")
      * @ORM\DiscriminatorColumn(name="discr", type="string")
      *
      * 不要使用显式鉴别器映射（它会自动生成）！！！
      * @ ORM\DiscriminatorMap({"basesiteuser" = "BaseSiteUser", "siteuser" = "SiteUser"})
      */
      BaseSiteUser.php

      /**
      * 站点用户
      *
      * @ORM\Table(name="siteuser")
      */
      SiteUser.php => 类 SiteUser 扩展 CustomerName\CMSBundle\Entities\SiteUserCustom

顾客姓名   
  客户项目包   
  CMSBundle
    实体
      /**
      * 站点用户自定义
      *
      * @ORM\Table(name="siteuser")
      */
      SiteUserCustom.php => 类 SiteUserCustom 扩展 OurCompany\CMSBundle\Entities\BaseSiteUser

```

不要忘记在**AppKernel.php**中注册你的包。如果您希望能够在**SiteUserCustom**中定义新字段，请将您的**CustomerNameCMSbundle**添加到实体管理器配置中：

```
形式：
  实体经理：
    默认：
      映射：
        OurCompanyCMS 捆绑包：~
        客户名称CMSbundle：~

```

# jquery - Chrome 的问题 - 在 Ajax 之后 jquery/javascript 无法正常工作

> ID：10141265
> 
> 赞同：2
> 
> 时间：2012-04-13T12:56:29.597
> 
> 标签：jquery, google-chrome, xhtml, hide, show

我在使用 Chrome 时遇到了一个奇怪的问题。我正在尝试在未遵循任何 w3c 标准开发的页面中解决此问题。我可以说几乎 1000 多个 w3c 问题。

错误出现在“onclick”函数上，该函数在 ajax 调用之前工作正常。在 ajax 调用之后，我们正在过滤内容（包括带有 onclick 的链接）。这些功能适用于 .show() 一个容器和 .hide() 另一个容器。在初始加载时工作正常。但是在使用 ajax 刷新链接后，.show() 和 hide() 不起作用（在浏览器中视觉上没有变化）。但我发现即使在 ajax 之后，函数调用也很顺利。我通过在函数中提供警报来测试这一点。但是函数内部的 .show() 和 hide() 没有发生。

我发现一种奇怪的行为，当我通过右键单击链接检查元素时，函数中的 show() 和 hide() 工作正常。

Safari、IE、Firefox 等没有问题，只有 Chrome 有问题。

希望这里的一些专家可以帮助我解决这个问题。

这里的代码：

## HTML

```
<a href="javascript:void(0);" onclick="swap(1)" >Show hotels in area</a> 
<a href="javascript:void(0);" onclick="swap(2)">Show hotels on map</a>

<table border="0" cellpadding="0" cellspacing="0">
<tr id="hotelArea" style="display: none">
<td>
<!-- Hote Area Content here -->
</td>
</tr>
<tr id="hotelsMap" style="display: none">
<td>
<!-- MAP Content here -->
</td>
</tr>
</table> 
```

## html 之后的 Javascript（位于页面底部）：

```
function swap(n){
if(n==1){
$('#hotelsMap').hide('slow');
$('#hotelArea').show('slow');
}
if(n==2){
$('#hotelArea').hide('slow');
displayHotelsOnMap();
$('#hotelsMap').show('slow');
}
} 
```

我也尝试使用 .live(click) 而不是内联 onclick，但发生了同样的问题....提前致谢-sunil

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T06:05:03.760

使用[更好的 JavaScript 链接](http://www.thefutureoftheweb.com/blog/javascript-only-links)来消除副作用。用 span 元素替换锚点以避免[void() 函数冲突](http://mbaierl.com/2009/09/a-void0-javascriptvoid0.html)并将 onclick 移动到[jQuery .click](http://api.jquery.com/click/)事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-11T09:29:51.247

出于调试的目的，请尝试在ajax调用后重新运行js脚本。我会将您的 javascript 放在一个 .js 文件中，然后像这样重新运行它：

```
 $(document).ready(function(){
       //your ajax call
       $.getScript("yourjs.js");
 }); 
```

# charts - 客户端图表导出库

> ID：10141267
> 
> 赞同：0
> 
> 时间：2012-04-13T12:56:39.567
> 
> 标签：charts

我正在寻找一个客户端（即：HTML5、Javascript、Flash 或 Silvelight）库，即

1.  能够创建交互式图表
2.  能够将这些图表导出为 jpg/png
3.  是免费的（LGPL，或类似的）

我研究过 Highcharts 和 FusionCharts；两者都是非常好的选择——除了这些不能用于商业软件。

是否有符合上述条件的图表库？

谢谢，克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T06:27:36.613

FusionCharts 提供了一个名为[FusionCharts Free](http://www.fusioncharts.com/goodies/fusioncharts-free/)的产品。

FusionCharts Free 在 MIT (X11) 和 GNU GPL 许可下获得双重许可。

简而言之，上述许可证允许您：

*   将软件用于任何商业或个人目的
*   修改软件的源代码以满足您的需求
*   与您的朋友和邻居分享该软件
*   将软件作为软件或硬件应用程序的一部分重新分发

在此处阅读有关许可部分的更多信息 - [http://www.fusioncharts.com/goodies/fusioncharts-free/product-licensing/](http://www.fusioncharts.com/goodies/fusioncharts-free/product-licensing/)

# file-io - 如何编写只转发文件操作的 Linux 驱动程序？

> ID：10141268
> 
> 赞同：1
> 
> 时间：2012-04-13T12:56:42.640
> 
> 标签：file-io, linux-kernel, kernel, driver, shfileoperation

我需要实现一个 Linux 内核驱动程序，它（在第一步中）只将所有文件操作转发到另一个文件（在后面的步骤中，这应该被管理和操作，但我不想在这里讨论这个）。

我的想法如下，但是在阅读时，内核崩溃了：

```
static struct {
    struct file *file;
    char *file_name;
    int open;
} file_out_data = {
.file_name  = "/any_file",
.open       = 0, 
};

int memory_open(struct inode *inode, struct file *filp) {
  PRINTK("<1>open memory module\n");
    /* 
     * We don't want to talk to two processes at the same time 
     */
    if (file_out_data.open)
        return -EBUSY;
    /*
     * Initialize the message 
     */
    Message_Ptr = Message;
    try_module_get(THIS_MODULE);

        file_out_data.file = filp_open(file_out_data.file_name, filp->f_flags, filp->f_mode); //here should be another return handling in case of fail
    file_out_data.open++;

  /* Success */
  return 0;
}

int memory_release(struct inode *inode, struct file *filp) {
      PRINTK("<1>release memory module\n");
    /* 
     * We're now ready for our next caller 
     */
    file_out_data.open--;
    filp_close(file_out_data.file,NULL);

    module_put(THIS_MODULE);
  /* Success */
  return 0;
}

ssize_t memory_read(struct file *filp, char *buf, 
                    size_t count, loff_t *f_pos) { 
   PRINTK("<1>read memory module \n");
ret=file_out_data.file->f_op->read(file_out_data.file,buf,count,f_pos); //corrected one, false one is to find in the history
    return ret;

} 
```

那么，谁能告诉我为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T13:02:09.293

为什么要增加`file_out_data.open`两次并减少一次？这可能会导致您`file_out_data.file`在关闭后使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T14:02:12.780

1.  不要使用`set_fs()`，因为没有理由这样做。
2.  使用`file->f_fop->read()`而不是`vfs_read`. 看一下[file](http://lxr.linux.no/linux+v3.3.1/include/linux/fs.h#L971)和[file_operations](http://lxr.linux.no/linux+v3.3.1/include/linux/fs.h#L1598)结构。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-27T13:12:56.397

您想在读取的文件中写入内存吗？因为你正在阅读而不是写作......可能我错了

# wcf - WCF 到 WCF 通信 401，HttpClient

> ID：10141272
> 
> 赞同：0
> 
> 时间：2012-04-13T12:57:13.370
> 
> 标签：wcf, iis

我有一个需要与另一个 WCF REST 服务通信的 WCF REST 服务。

共有三个网站：

*   默认网站
*   网站1
*   网站2

如果我在默认网站中设置这两个服务并`HttpClient`使用 URI [http://localhost/service](http://localhost/service)连接到另一个（使用），那么一切都很好。

所需的设置是将这两个服务移动到不同的网站，而不是使用 URI [http://localhost/service](http://localhost/service)，通过[http://website1.domain.com/service](http://website1.domain.com/service)访问服务仍然使用`HttpClient`.

我收到了异常：

> System.ArgumentOutOfRangeException：未经授权 (401) 不是以下之一：OK (200)、已创建 (201)、已接受 (202)、NonAuthoritativeInformation (203)、NoContent (204)、ResetContent (205)、PartialContent (206)

我可以看到这是一个 401，但是这里发生了什么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T15:09:42.500

> 我收到了异常：

“我”是谁？Web 服务之一或其他客户端？

如果我理解正确，那么接收端似乎期待一系列响应，401**不是**其中之一。它可能是一些错误检查代码，需要“这个范围”的响应并且 X （并且 401 不是其中之一，或者没有“默认”方法来解释 x 响应？）。

也就是说，401 是一个授权错误，因此请检查可能的[ServiceAuthorizationManager](http://msdn.microsoft.com/en-us/library/system.servicemodel.serviceauthorizationmanager.aspx)和/或“我”未满足的类似设置首先导致 401 响应......

嗯...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T10:50:51.047

我的猜测是您缺少授权标头或凭据。

看一下这个 ：

*   [从 .NET 使用 REST API](https://stackoverflow.com/questions/1842770/consume-rest-api-from-net)
*   [如何使用基于 HttpClient 和 .net4 的 Rest-client 进行身份验证](https://stackoverflow.com/questions/7387205/how-to-authenticate-with-rest-client-based-on-httpclient-and-net4)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T03:39:02.980

我认为这与您的网络服务设置有关。最好只为新服务创建 GET、POST、Put、DELETE 心跳调用，然后从 fiddler 中检查这些调用。如果您收到 401，则可能意味着您的应用程序池身份无法访问某些内容。

解决该问题的步骤：

1.  在您的 WCF 发布文件夹中授予用户读/写/修改/执行/..similar 权限
2.  在集成的 .net 4 中为此站点创建应用程序池
3.  将此用户设置为应用程序池标识，启用匿名模式
4.  启用 PUt，同时删除动词

服务中用于测试调用的心跳类的一部分：

```
 [DataContract]
public class StatusInfo
{
    [DataMember]
    public string MachineName { get; set; }

    [DataMember]
    public string IpAddress{ get; set; }

    [DataMember]
    public string Methodname { get; set; }

    public override string ToString()
    {
        return "Machinename:" + MachineName + " ;IP:" + IpAddress + "; Method:" + Methodname;
    }
}

private void ResolveStatus(StatusInfo statusInfo,string methodname)
    {
        try
        {
            var context = System.ServiceModel.OperationContext.Current;

            RemoteEndpointMessageProperty property =
                (RemoteEndpointMessageProperty)
                context.IncomingMessageProperties[RemoteEndpointMessageProperty.Name];

            statusInfo.IpAddress = property.Address;
            statusInfo.MachineName = Environment.MachineName;
            statusInfo.Methodname = methodname;

        }catch(Exception ex)
        {

        }
    }
/// <summary>
    /// create task
    /// </summary>
    /// <param name="taskwrapped"></param>
    [WebInvoke(Method = "POST", UriTemplate = "", RequestFormat = WebMessageFormat.Json,
        ResponseFormat = WebMessageFormat.Json, BodyStyle = WebMessageBodyStyle.WrappedRequest)]
    public StatusInfo postcall()
    {
        StatusInfo statusInfo = new StatusInfo();
        logger.Trace(Tagname + "postcall");
        ResolveStatus(statusInfo, "POST");
        return statusInfo;

    }

    /// <summary>
    /// edit task
    /// </summary>
    [WebInvoke(Method = "PUT", UriTemplate = "", RequestFormat = WebMessageFormat.Json,
              ResponseFormat = WebMessageFormat.Json, BodyStyle = WebMessageBodyStyle.WrappedRequest)]
    public StatusInfo Edit()
    {
        StatusInfo statusInfo = new StatusInfo();
        logger.Trace(Tagname + "Edit");
        ResolveStatus(statusInfo, "PUT");
        return statusInfo;

    }

    //delete request with taskid
    [WebInvoke(Method = "DELETE", UriTemplate = "", RequestFormat = WebMessageFormat.Json,
     ResponseFormat = WebMessageFormat.Json, BodyStyle = WebMessageBodyStyle.WrappedRequest)]
    public StatusInfo DeleteCall()
    {
        StatusInfo statusInfo = new StatusInfo();
        logger.Trace(Tagname + "Edit");
        ResolveStatus(statusInfo, "DELETE");
        return statusInfo;

    }

    //delete request with taskid
    [WebInvoke(Method = "DELETE", UriTemplate = "/{recordid}", RequestFormat = WebMessageFormat.Json,
     ResponseFormat = WebMessageFormat.Json, BodyStyle = WebMessageBodyStyle.WrappedRequest)]
    public StatusInfo DeleteCallWithParam(string recordid)

    {
        StatusInfo statusInfo = new StatusInfo();
        logger.Trace(Tagname + "Edit");
        ResolveStatus(statusInfo, "DELETE/"+recordid);
        return statusInfo;

    }

enter code here 
```

# c - 是目标文件 (.o) 中包含的 .c 文件中的头文件路径引用

> ID：10141277
> 
> 赞同：0
> 
> 时间：2012-04-13T12:57:23.903
> 
> 标签：c, compiler-construction, linker, object-files

我编译了一个包含以下行的 example.c 文件：

```
#include "parse/properties/properties.h" 
```

编译器创建一个 example.o 文件。头文件的路径是否包含在 example.o 文件中？还是该信息是外部的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T12:59:10.767

目标文件格式可能不标准化（标准甚至没有提到“目标文件”）。编译器可能会插入 #include 以进行调试，也可能会完全跳过它。

另请注意，#include'ing 是由编译器在标准描述的翻译的第一阶段使用文本预处理器完成的；#include-directive 告诉预处理器逐字复制并替换另一个文件的内容。这发生在生成实际目标文件之前很久

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T13:00:52.230

它是实现定义的，但*通常*当您使用调试选项（例如`-g`在 gcc 中）进行编译时，会包含文件路径以帮助您进行调试

# asp.net - DevExpress GridView 中的千位分隔符

> ID：10141283
> 
> 赞同：-1
> 
> 时间：2012-04-13T12:57:53.417
> 
> 标签：asp.net, devexpress

如何在 DevExpress GridView 中做千位分隔符？数据绑定到 sqlserver 表。

```
ASPxGridVendor2.DataSource = Session("DSGrid13")

ASPxGridVendor2.DataBind() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T13:07:29.030

[在此处](http://documentation.devexpress.com/#AspNet/DevExpressWebASPxEditorsEditPropertiesBase_DisplayFormatStringtopic)查找文档，并[在此处](http://www.devexpress.com/Support/Center/p/Q368793.aspx?searchtext=format%20decimal%20grid)查找有关网格的 fromatString 的问题

**更新**

查看[此示例](http://demos.devexpress.com/ASPxGridViewDemos/DataBinding/XPOLargeDB.aspx)的代码。cs 代码中有一个方法可以做我认为你想做的事情。寻找方法

```
 protected void grid_CustomColumnDisplayText(object sender, ASPxGridViewColumnDisplayTextEventArgs e) 
```

# excel - 在 VBA 中处理错误时如何管理无错误情况？

> ID：10141292
> 
> 赞同：8
> 
> 时间：2012-04-13T12:58:50.047
> 
> 标签：excel, vba, error-handling

我需要使用以下`GoTo`语句捕获一些 VBA 错误：

```
Sub mySub
 On Error GoTo errorHandler:
    Workbooks.Open("myWorkbook")
'
' Some Code
'
errorHandler:
MsgBox "ERROR"

End Sub 
```

问题是当没有错误时该`errorHandler`部分被执行。
我找到[了这个讨论](https://stackoverflow.com/questions/1099177/why-vba-goes-to-error-handling-code-when-there-is-no-error)，但答案并没有解决我的问题。
我尝试`Exit Sub`按照说明添加一条语句：

```
Sub mySub
 On Error GoTo errorHandler:
    Workbooks.Open("myWorkbook")
    Exit Sub

'
' Some Code
'
errorHandler:
  MsgBox "ERROR"

End Sub 
```

在这种情况下，它会在没有错误时退出该方法。我也试过：

```
 Sub mySub
 On Error GoTo errorHandler:
    Workbooks.Open("myWorkbook")
'
' Some Code
'
errorHandler:
  MsgBox "ERROR"
  Exit Sub
End Sub 
```

但仍然是同样的问题：`errorHandler`即使没有发生错误，也会执行。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-13T13:01:15.007

只需将 Exit sub 放入即可。

```
Sub mySub
 On Error GoTo myHandler:
    Workbooks.Open("myWorkbook")
'
' Some Code
'
Exit sub

myHandler:
MsgBox "EROOR !"

err.clear
End Sub 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-14T20:22:09.820

这是我喜欢的模式：

```
Sub SomeSub()
    On Error GoTo ErrorLabel

    'Code goes here

ExitLabel:
   'Clean-up code, if any, goes here 
   Exit Sub

ErrorLabel:
    'Error-handling code goes here
    Resume ExitLabel
End Sub 
```

请注意，`Resume`清除错误。我喜欢这种模式有几个原因：

1.  *习惯性地在错误处理块之前*插入退出块可以减少我遇到 OP 意外掉入错误处理程序的问题的机会。
2.  我`GoTo ExitLabel`用于从 Sub*或*Function 中提前退出。这样，我不太可能意外跳过清理代码。例子：

    ```
    Sub SomeOtherSub()
        Dim x As ResourceThatNeedsToBeClosed
        Dim i As Long
        On Error GoTo ErrorLabel
        Set x = GetX
        For i = 1 To 100
            If x.SomeFunction(i) Then
                GoTo ExitLabel
            End If
        Next
    ExitLabel:
        x.Close
    ErrorLabel:
        'Error-handling code goes here
        Resume ExitLabel
    End Sub 
    ```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-14T00:04:17.367

```
Public Sub MySub
    On Error Goto Skip

    ' Some Codes

Skip:
    If err.Number > 0 Then

        ' Run whatever codes if error occurs

        err.Clear
    End If
    On Error Goto 0
End Su 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-10T06:57:38.053

在错误处理程序部分使用以下代码：

```
if err.number>0 the
    ' error handling goes here
else
    ' some code
end if 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-01-31T16:57:42.267

我遇到了和你一样的问题，上面的解决方案都不起作用。他们显然甚至没有看到您已经在原始帖子的 2 个不同位置写了 Exit Sub。似乎没有在线网站理解有时不会出现错误（如果总是会出现错误，你为什么要这样编码？），当没有错误时，你显然不会想退出子。您也不希望 myHandler 在没有错误时运行。呃！这是我想出的似乎可行的解决方案。

```
On Error GoTo ErrorHandler
'This is the thing I am trying to do...
Workbooks("SpreadSolver.xlsb").Activate
'If it works, great. 
'Don't touch the error stuff and move on. 
'I.e. go to the part that I know works (the rest of the macro)
GoTo ThisPartWorks

'If the thing I am trying to do doesn't work...
ErrorHandler:
MsgBox "Error: Please open Spread Solver and then run the macro."
'Only want to Exit Sub if there is an error.. duh.
Exit Sub

ThisPartWorks:
'the rest of your macro can go here...
'...
End Sub 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-08-06T12:15:12.557

我在 ErrorHandler 中使用 If 语句，如果没有错误，它将停止执行。这是通过使用 Err.Number (Err (object) number (eg Run-time error 9: Subscript out of range)) 来实现的

```
If Err.Number >= 1 Then
MsgBox ("Message")
End
Else: other code
End If
Exit Sub 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-08-22T08:30:37.703

这就是我所做的。奇迹般有效

```
Sub someProgram ()
    On Error goto Handler:
        x = 7/0

    'Some code you wanna execute  with or without error
Exit Sub

Handler:
     'Write your handler here

Resume next 'After handling error, this line will help you resume the next line

End sub 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-04-09T18:49:25.983

```
sub XYZ ()
on error goto label

"Write your macro"

Label:
      If Err.Description <> "" Then
       "your code if error occurs for eg:"
       msgbox "Error Occured!"
       Exit Sub
       Else
       "Your code when no error occurs for eg"
        msgbox " Done."
       End If
Exit Sub 
```

# php - 使用 preg_replace 在 PHP 字符串中查找电话号码的终极方法

> ID：10141295
> 
> 赞同：2
> 
> 时间：2012-04-13T12:59:04.117
> 
> 标签：php, preg-replace, phone-number

现在正在处理一个项目，我们有大量的文本字符串，我们必须本地化电话号码并使其可用于 Android 手机。

电话号码可以有不同的格式，前后有不同的文字。有什么简单的方法可以检测各种电话号码格式吗？一些可以使用的库？

电话号码可以显示，必须与所有这些组合一起使用。所以结果就像

`<a href="tel:number">number</a>`

+61 8 9000 7911

+2783 207 5008

+82-2-806-0001

+56 (2) 509 69 00

+44 (0)1625 500125

+1 (305)409 0703

031-704 98 00

+46 31 708 50 60

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T13:16:52.587

也许是这样的：

```
/(\+\d+)?\s*(\(\d+\))?([\s-]?\d+)+/ 
```

*   `(\+\d+)?`= 一个“+”后跟一位或多位数字（可选）
*   `\s*`= 任意数量的空格字符（可选）
*   `(\(\d+\))?`= A "(" 后跟一个或多个数字，后跟 ")"（可选）
*   `([\s-]?\d+)+`= 一组或多组数字，前面可选空格或破折号

不过，老实说，我怀疑你会找到一种可以统治所有人的表达方式。电话号码可以有多种不同的格式，以至于要匹配任何可能的格式而没有误报或否定可能是不切实际的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T13:14:12.490

不确定是否有一个图书馆。嗯。像任何国际设施一样，电话号码是标准化的，并且也应该有一种定义电话号码的格式。E.164 建议推荐的电话号码：[http](http://en.wikipedia.org/wiki/E.164) ://en.wikipedia.org/wiki/E.164 。所有开源解码库都是通过阅读这些标准格式构建的，所以如果你真的找不到任何现有的库，它应该会有所帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-25T15:21:08.067

尝试以下操作：

```
preg_match_all('/\+?[0-9][\d-\()-\s+]{5,12}[1-9]/', $text, $matches); 
```

或者：

```
preg_match_all('/(\+?[\d-\(\)\s]{8,20}[0-9]?\d)/', $text, $matches); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-13T13:10:54.860

我想这可能适用于这些情况？

```
preg_replace("/(\+?[\d-\(\)\s]{7,}?\d)/", '<a href="tel:$1">number</a>', $str); 
```

基本上我检查它是否可以从+开始。它不必。然后我检查它是否有数字、-、(、) 和至少 8 个案例的空格，这样它就不会选择低的非电话号码。

# java - 如何将 UUID 值转换为字符串

> ID：10141296
> 
> 赞同：15
> 
> 时间：2012-04-13T12:59:07.817
> 
> 标签：java

我想为我的会话生成唯一的会话 ID。所以我使用了UUID。这是我所做的

```
if (session == null) {

    session = httpServletRequest.getSession(true);
    session.setAttribute("logedin", "0");

    if (!httpServletRequest.isRequestedSessionIdFromCookie()) {

        UUID sessionID = UUID.randomUUID();

        Cookie sessionCookie = new Cookie("JSESSIONID", "sessionID");  //problem

} 
```

Cookie 构造函数接受两个字符串，如何将我的 UUID 转换为字符串，以便获得唯一的 UUID 值？谢谢

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-04-13T13:01:44.003

这会将您的唯一会话 ID 转换为字符串

```
String suuid = UUID.randomUUID().toString(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T13:01:18.953

您可以调用`toString()`所有 Java 对象...

# c++ - 变量的常量及其生命周期

> ID：10141302
> 
> 赞同：4
> 
> 时间：2012-04-13T12:59:36.060
> 
> 标签：c++

因此，从另一个线程中提出[的问题](https://stackoverflow.com/questions/3097593/what-happens-when-c-reference-leaves-its-scope)中，我想到了一个新问题，答案对我来说并不明显。

因此，似乎有一条 c++ 规则规定，如果您对临时对象有 const 引用，那么临时对象的生命周期至少与 const 引用一样长。但是，如果你有一个对另一个对象的成员变量的本地 const 引用，然后当你离开作用域时——它会调用该变量的析构函数吗？

所以这里是原始问题的修改程序：

```
#include <iostream>
#include <string>
using namespace std;

class A {
public:
   A(std::string l) { k = l; };
   std::string get() const { return k; };
   std::string k;
};

class B {
public:
   B(A a) : a(a) {}
   void b() { cout << a.get(); }  //Has a member function
   A a;
};

void f(const A& a)
{  //Gets a reference to the member function creates  a const reference
     stores it and goes out of scope
 const A& temp = a;
 cout << "Within f(): " << temp.k << "\n";
}

int main() {
   B b(A("hey"));

   cout << "Before f(): " << b.a<< "\n";

   f(b.a);

   cout << "After f(): " << b.a.k << "\n";

   return 0;
} 
```

所以当我运行这段代码时，我每次都会得到“嘿”作为值。这似乎意味着本地 const 引用不会通过传入的成员对象将自己绑定到一生中。为什么不呢？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-13T13:08:25.800

`b.a`不是临时的，因此它的生命周期不受随后绑定到它的任何引用的影响。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T14:39:45.793

我不确定我明白你在问什么。在您的代码中，我看到的唯一临时变量是`A("hey")`在初始化的表达式`b` 中`main`。这被复制（使用复制构造函数）到`b.a` in 中`B::B`。在那之后，任何地方都没有更多的临时工。

更一般地说，临时绑定到引用的事实并不一定会改变它的生命周期。延长生命周期的是临时用于初始化引用的事实：例如，在您的情况下，`temp`in`f`永远不会对临时的生命周期产生影响，因为它不是用临时的，而是用另一个引用初始化的. 这条规则也有例外：如果你在类的初始化器中使用临时来初始化成员引用，它的生命周期仍然不会超出构造函数的末尾，所以：

```
class A
{
    std::string const& rString;
public:
    A() : rString( std::string( "hey" ) ) {}
    std::string get() const { retur rString; }
}; 
```

不管用。

# html - HTML5：为什么我应该使用 section 或 article 而不是 div

> ID：10141305
> 
> 赞同：2
> 
> 时间：2012-04-13T12:59:43.830
> 
> 标签：html

> **可能重复：**
> [像 <section> 和 <article> 这样的新 HTML5 元素是否毫无意义？](https://stackoverflow.com/questions/3822024/are-new-html5-elements-like-section-and-article-pointless)

因此，HTML5 中有很多新元素。例如部分或文章。但不清楚为什么我应该使用这些而不是 div 元素？

许多博客都说语义结束等等，但我为什么要关心它呢？它是否会影响性能或使页面对搜索引擎更友好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T13:04:18.933

> 它是否会影响性能或使页面对搜索引擎更友好？

到目前为止，没有。事实上，对于某些新技术（例如页面上有多个 h1 标签，每个部分 1 个），它可能会对 SEO 产生相反的影响。当然，人们的想法是 html5 将成为新标准，很快就会对 SEO 产生积极影响。就性能而言，我找不到任何支持这一点的东西。

我看到的最大优势是可读性（因此可维护性），通过查看适合它们包含的内容的标签而不是随处可见的 Div，并且“id”属性指的是目的。

此外，一些新标签有特殊用途，例如上面提到的部分标签。

# unicode - MSXML.DOMDocument.4.0 loadXML 与中文 Unicode 字符

> ID：10141308
> 
> 赞同：0
> 
> 时间：2012-04-13T12:59:51.217
> 
> 标签：unicode, msxml4

目前，我正在尝试使用 ASP 中的 MSXML loadXML 方法来加载可能包含 Unicode 中文字符的 XML 字符串，例如

> (U+20BA2) 4字节

xml字符串看起来像

```
<City>City</City><Name></Name> 
```

所以，在我的代码中，我可以看到 xml 字符串是正确的，但是 loadXML 返回一条错误消息，例如

> 无效的 unicode 字符，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T10:22:26.773

我建议发布您收到的**确切代码、XML 源代码和错误消息。**我无法通过`<element></element>`在 MSXML 4.0 SP3 中解析来重现错误；这很好用。

通过尝试解析，我确实得到了一个 parseError，原因是“无效的 unicode 字符” `<element>&#55362;&#57250;</element>`，因为这不是格式良好的 XML。如果你的标记中有这个，那么你需要修复产生它的序列化器，因为 MSXML 和任何符合标准的 XML 解析器都不会加载它。

如果`变成字符引用，它必须是`&#134050;`（或`&#x20BA2;`）。代码单元 55362 和 57250 是“代理”，保留用于在 UTF-16 中编码星体平面字符。它们不能包含在 XML 文档中。`

 `* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T19:59:37.813

`&#55362;&#57250;`是 的实体编码形式`0xD842 0xDFA2`，是 Unicode`字符的 UTF-16 编码形式。确保 XML 完全采用 UTF-16 编码，而不是混合单字节 ASCII 和多字节 UTF-16。``

# xcode - 如何将 Xcode 4.2.1 与 ifort 一起使用？

> ID：10141319
> 
> 赞同：1
> 
> 时间：2012-04-13T13:00:35.797
> 
> 标签：xcode, debugging, intel-fortran

我遵循以下指南：（1）打开一个新项目；(2)打开一个新的空文件来构建fortran代码；(3) 在构建规则下添加构建规则（使用 intel fortran XE 的过程选择 Fortran 源文件）。

但是，输出窗口显示： GNU gdb 6.3.50-20050815（Apple 版本 gdb-1708）（2011 年 11 月 3 日 21:59:02 UTC） 版权所有 2004 Free Software Foundation, Inc. GDB 是自由软件，受 GNU 保护通用公共许可证，欢迎您在某些条件下更改和/或分发它的副本。键入“显示复制”以查看条件。GDB 绝对没有任何保证。键入“显示保修”以获取详细信息。此 GDB 配置为“x86_64-apple-darwin”.tty /dev/ttys000 [切换到进程 19571 线程 0x0] Hello World！程序以退出代码结束：0

我在这里想念什么吗？

# javascript - 使用没有 JS 警报的 jQuery 将 XML 加载到 JS 变量中

> ID：10141320
> 
> 赞同：0
> 
> 时间：2012-04-13T13:00:40.387
> 
> 标签：javascript, jquery, xml

我知道有关将 XML 加载到 JS 变量中的问题已经在这里发布了很多次，但我没有找到可行的解决方案。在我的脚本中，我在 ajax 请求之前声明了一个变量，然后将结果添加到该变量中。这仅在我向脚本添加警报时才有效：

```
var myDB;
$.ajax({
    type: 'GET',
    url: 'db.xml',
    dataType: 'xml',
    success: function (xml){
        myDB = xml;
    }
});

alert(myDB); //returns: undefined

$(myDB).find('item').each(function (){
    var question = $(this).find('question').text();
    alert(question);
}); 
```

上面的代码仅适用于警报。当我删除警报时，代码不起作用。我怎样才能在没有警报的情况下完成这项工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T13:02:41.840

为此，您需要将代码添加到成功处理程序中：

```
var myDB;
$.ajax({
    type: 'GET',
    url: 'db.xml',
    dataType: 'xml',
    success: function (xml){
        $(myDB).find('item').each(function (){
            var question = $(this).find('question').text();
        });
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T13:03:36.303

ajax 请求是异步的。这意味着，您在成功选项中提供的功能将在稍后执行。

在你开始请求之后，你的变量仍然是空的。仅当您等待足够长的时间以确认阻塞警报时，变量才会被加载。

您需要将迭代添加到成功函数，其中 xml 数据肯定可用。

# c# - 调用服务时不会触发 Ajax Success 事件

> ID：10141324
> 
> 赞同：1
> 
> 时间：2012-04-13T13:00:46.187
> 
> 标签：c#, jquery, asp.net, ajax

我正在使用 JQuery 对本地服务进行 AJAX。我的本地服务是一个 HttpHandler（例如 Request.ashx）。在 Request.ashx 中，它的职责是调用外部网站（例如，CallExternalWebsite()）。CallExternalWebsite() 使用 .NET 的 System.Net.WebRequest() 来发起请求。访问外部网站时，不会触发成功或错误事件。（*注意：我也尝试过托管在 IIS 中的 WCF 服务。我看到了相同的结果*）

这里有两种情况：

此方案有效：

1.  在 ProcessRequest() 中，*注释掉*callExternalWebsite()。
2.  对于对象 o，使用数据进行初始化以模拟结果。
3.  点击我的按钮
4.  成功事件在客户端触发。
5.  在 Fiddler 中，我可以看到标题信息。我看到了 Json 结果等。

这种情况不起作用：

1.  在 ProcessRequest() 中，*启用*对 callExternalWebsite() 的调用。
2.  对于对象 o，callExternalWebsite() 将返回一个适当的对象。
3.  点击我的按钮
4.  成功事件*不会*在客户端上触发。
5.  在 Fiddler 中，我可以看到标题信息。我看到了 Json 结果等。
6.  我知道 callExternalWebsite() 正在工作，因为我让它将结果发送到我的手机。

总而言之，HttpHandler 中的外部 http 调用正在影响 Ajax 成功事件。

这是 AJAX 调用的一个片段：（我在尝试不同的交互）

```
 $(document).ready(function () {
        $("#myButton").click(function (event) {

            $.ajax({
                cache: false,
                type: "POST",
                url: "http://localhost/Service/Request.ashx",
                data: '{"id" : "053252f3"}',
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                timeout: 20000,
                success: function (msg) {
                    AjaxSucceeded(msg);
                },
                error: AjaxFailed
            });
        });
    }); 
```

在 HttpHandler Request.ashx 中，

```
public Void ProcessRequest(httpContent context)
{
//  Do some stuff....

// Make call to external web site
object o = callExternalWebsite (Uri, Data, "POST");

// Return results from callOtherWebsite 
        JavaScriptSerializer javaScriptSerializer = new JavaScriptSerializer();
        string json = javaScriptSerializer.Serialize(o);
        context.Response.ContentType = "application/json";
        context.Response.Write(json);

} 
```

有什么想法吗？

谢谢。

史蒂夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T13:41:04.067

What happens if you do this, msg vs msg.d:

```
$(document).ready(function () {
    $("#myButton").click(function (event) {

        $.ajax({
            cache: false,
            type: "POST",
            url: "http://localhost/Service/Request.ashx",
            data: '{"id" : "053252f3"}',
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            timeout: 20000,
            success: function (msg) {
                AjaxSucceeded(msg.d);
            },
            error: AjaxFailed
        });
    });
}); 
```

# ruby-on-rails - 使用数组和 ajax

> ID：10141333
> 
> 赞同：0
> 
> 时间：2012-04-13T13:01:24.963
> 
> 标签：ruby-on-rails, ajax, ruby-on-rails-3

我有一个对象数组。我想当你点击链接时，我浏览了所有对象并将它们显示在页面上，使用 ajax

**运行.js.erb**

```
$(function(){

  $("#next").click(function(){

    $.post(<%= EngineHelper.nextQuestion %>, function(data){
    $("#question").html(data);
    });
    return false;
  });
}); 
```

但它不起作用。在脚本中，而不是 <% = EngineHelper.nextQuestion%> 替换了当前数据数组元素。我需要显示下一个数组元素

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T07:23:03.590

尝试将其转换为 JSON

所以与其：

```
$.post(<%= EngineHelper.nextQuestion.to_json %>, function(data){
  $("#question").html(data);
}); 
```

希望能帮助到你 ：）

# visual-studio-2010 - Word 2010 与 Visual Studio 2010 的集成

> ID：10141334
> 
> 赞同：0
> 
> 时间：2012-04-13T13:01:27.223
> 
> 标签：visual-studio-2010, ms-word, office-2010

我正在使用以下代码，它在 Visual Studio 2010 集成 Web 服务器中运行良好，但在 IIS 上部署时，我在 ** 行出现错误：

```
 Word.Application oWord = new Word.Application();
        Word.Document oWordDoc; //= new Word.Document();
        object breakPage = Word.WdBreakType.wdPageBreak;

        oWord.Visible = false;
        oWord.Options.set_DefaultFilePath(Microsoft.Office.Interop.Word.WdDefaultFilePath.wdUserTemplatesPath, Server.MapPath(TemplatesFolder)); //@"D:\Presentationalism\Presentationalism\Presentations\Templates");

        Object oTemplatePath = Server.MapPath(TemplatesFolder + templates[ddTemplates.SelectedIndex]);
        **oWordDoc = oWord.Documents.Add(ref oTemplatePath, ref oMissing, ref oMissing, ref oMissing);**

        oWordDoc.Activate(); 
```

以下是错误：

```
Word was unable to read this document.  It may be corrupt.
Try one or more of the following:
* Open and Repair the file.
* Open the file with the Text Recovery converter. 
```

我如何解决它？

# android - 如何从活动类获取数据到 PhoneStateListener 类？

> ID：10141345
> 
> 赞同：0
> 
> 时间：2012-04-13T13:02:04.023
> 
> 标签：android

我有一个问题，我无法从活动类获取数据到 PhoneStateListener 类。

为了更好地理解代码如下：

这是我要发送数据或字符串的类

```
package net.cellobject.blockingincomingcall;

import android.app.Activity;
import android.content.SharedPreferences;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.Toast;

public class SecondTab extends Activity
{
    EditText e1;
    Button b1;

    protected void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.setting);

        e1=(EditText)findViewById(R.id.edt1);

        b1=(Button)findViewById(R.id.b1);

        LoadPreferences();

        b1.setOnClickListener(new OnClickListener()
        {
            public void onClick(View v) 
            {
                String msg=e1.getText().toString();

                SavePreferences("msg1",msg);

                LoadPreferences();

                if(msg=="")
                {
                    Toast.makeText(getApplicationContext(), "First 

                                               Enter the message then save it"

                                               ,Toast.LENGTH_LONG).show();

                    e1.requestFocus();
                }
            }
        });
    }

    private void LoadPreferences() 
    {
        SharedPreferences shp= getPreferences(MODE_PRIVATE);

        String s1=shp.getString("msg1","");

        e1.setText(s1);
    }

    private void SavePreferences(String key, String msg) 
    {
        SharedPreferences shp= getPreferences(MODE_PRIVATE);

        SharedPreferences.Editor editor=shp.edit();

        editor.putString(key, msg);

        editor.commit();
    }
} 
```

这是我想要获取通过PhoneStateListener 扩展的数据或字符串的类？

```
package net.cellobject.blockingincomingcall;

import java.lang.reflect.Method;
import android.content.Context;
import android.media.AudioManager;
import android.telephony.PhoneStateListener;
import android.telephony.TelephonyManager;
import android.util.Log;
import com.android.internal.telephony.ITelephony;

public class PhoneCallStateListener extends PhoneStateListener 
{   
    private Context context;    

    public PhoneCallStateListener(Context context)
    {
        this.context = context;
    }

    public void onCallStateChanged(int state, String incomingNumber) 
    {
        switch (state) 
        {
            case TelephonyManager.CALL_STATE_RINGING:               

                AudioManager audioManager = (AudioManager) context.

                                                 getSystemService(Context.AUDIO_SERVICE);   

                //Turn ON the mute

                audioManager.setStreamMute(AudioManager.STREAM_RING, true);     

                TelephonyManager telephonyManager = (TelephonyManager) context.

                                               getSystemService(Context.TELEPHONY_SERVICE);

                try {
                    @SuppressWarnings("rawtypes")

                    Class clazz = Class.forName(telephonyManager.getClass().getName());

                    Method method = clazz.getDeclaredMethod("getITelephony");

                    method.setAccessible(true);

                    ITelephony telephonyService = (ITelephony) method.invoke(telephonyManager);     

                    //Checking incoming call number

                    String incoming=incomingNumber.toString();

                    if (incomingNumber.equalsIgnoreCase(incoming)) 
                    {
                        Log.v("incoming_call",incoming);

                        telephonyService.endCall();

                        sendSMS(incoming, "I am Busy!!call me later");
                    }

                } catch (Exception e) {

                    e.printStackTrace();
                }

            audioManager.setStreamMute(AudioManager.STREAM_RING, false);

            break;
        }

        super.onCallStateChanged(state, incomingNumber);
    }

    private void sendSMS(String incoming, String string) 
    {
        android.telephony.SmsManager sms=android.telephony.SmsManager.getDefault();

        sms.sendTextMessage(incoming, null, string, null, null);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T13:21:29.973

我发布了一个非常简单的方法来存储和获取首选项，使用它我将解决您与存储和检索首选项相关的问题。

```
public class Preferences {

public static void record(String key,Context context,String value)
{
    SharedPreferences pref=PreferenceManager.getDefaultSharedPreferences(context);
    SharedPreferences .Editor editor=pref.edit();

    editor.putString(key,value );
    editor.commit();

}
public static String getRecord(String key,Context context)
{
    return PreferenceManager.getDefaultSharedPreferences(context).getString(key,PREF_DEFAULT_VALUE);

} 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T13:09:50.353

既然你`Context`在这两个地方都有，`Activity and Receiver`你可以`SharedPreference`用来设置和获取这两个地方的数据.. 什么问题..

```
context.getSharedPreference("name" , MODE_PRIVATE); 
```

# magento - Magento 1.4.2 + APC：清除缓存对更改设置没有影响

> ID：10141349
> 
> 赞同：1
> 
> 时间：2012-04-13T13:02:20.653
> 
> 标签：magento, apc

我们有一台装有 Magento 1.4.2 CE 的服务器，安装了 APC 3.1.9，并且将 Magento 配置为将其用作后端缓存。

我们在缓存中遇到了奇怪的行为。我们在后端所做的每一个更改都不会显示，直到 apache2 重新启动/APC 操作码缓存已被清除。这包括例如更改欢迎信息或激活/停用 Google Analytics。

**问题：**为什么 APC 缓存整个页面？我们不希望这种行为，它似乎不是标准的。对于后端的每一个微小变化，我们都需要清除操作码缓存。清除 Magento 缓存没有帮助。

为了完整起见，这是我们的`/etc/php5/conf.d/apc.ini`：

```
extension=/usr/lib/php5/20090626/apc.so
apc.enabled=1
apc.file_update_protection=2
apc.optimization=0
apc.shm_size=128M
apc.include_once_override=0
apc.shm_segments=1
apc.gc_ttl=7200
apc.ttl=7200
apc.num_files_hint=1024
apc.enable_cli=0 
```

在 7200s TTL 之后，启用/禁用 Google Analytics 也将无效。可能是因为我们的缓存此时没有满。40% 的容量被使用，命中率约为 98%。

这是 apc.php 的完整设置输出：

```
apc.cache_by_default    1
apc.canonicalize        1
apc.coredump_unmap      0
apc.enable_cli      0
apc.enabled         1
apc.file_md5        0
apc.file_update_protection  2
apc.filters 
apc.gc_ttl          7200
apc.include_once_override   0
apc.lazy_classes        0
apc.lazy_functions      0
apc.max_file_size       1M
apc.mmap_file_mask  
apc.num_files_hint      1024
apc.preload_path    
apc.report_autofilter   0
apc.rfc1867         0
apc.rfc1867_freq        0
apc.rfc1867_name        APC_UPLOAD_PROGRESS
apc.rfc1867_prefix      upload_
apc.rfc1867_ttl     3600
apc.serializer      default
apc.shm_segments        1
apc.shm_size        128M
apc.slam_defense        1
apc.stat            1
apc.stat_ctime      0
apc.ttl         7200
apc.use_request_time    1
apc.user_entries_hint   4096
apc.user_ttl        0
apc.write_lock      1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T15:22:07.287

APC 保留基于终端和 Web 的缓存。由于您只能从基于 Web 的 URL 调用而不是命令行中清除“web”缓存命中，这就是为什么在重新启动 apache 后会清除**APC 基于 Web 的缓存**。您很可能希望使用类似的脚本设置一个脚本来清除缓存，这样您就可以简单地从 CLI 或脚本中调用它。

```
echo "Clearing APC web cache\n";
system('wget --spider --quiet http://localhost/clear_apc_cache.php');

echo "Clearing APC command line user cache\n";
apc_clear_cache('user');

echo "Clearing APC command line opcode cache\n";
apc_clear_cache(); 
```

显然，您需要在其中创建`clear_apc_cache.php`具有相同两个 APC 内部方法调用的相应文件，`apc_clear_cache();`并且`apc_clear_cache('user');`

另外，我还设置了一个本地区域来查看 APC 缓存：

[http://www.electrictoolbox.com/apc-php-cache-information/](http://www.electrictoolbox.com/apc-php-cache-information/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T03:46:58.927

您还可以将 apc.stat 设置为零。(apc.stat=0) 在您的 PHP.ini 文件中。

如果设置为 1，则不查找文件更新，这会提供更好的性能，但需要在更新后重新启动 apache。设置为 0 它将检查文件更新并将它们添加到缓存中（即您的更新将在站点上可见）。

# ios - NSData 到 NSString 编码

> ID：10141354
> 
> 赞同：7
> 
> 时间：2012-04-13T13:02:38.567
> 
> 标签：ios, cocoa-touch, encoding

我有一个从服务器接收消息的应用程序。这些消息可能包含西里尔字符。但是当我将接收到的数据转换为 NSString 时，我只获得“\u041c\u0430\u043a”符号而不是西里尔符号。

```
 NSData *responceData = ....;

   NSString* responceString = [[NSString alloc] initWithData:responseData encoding:NSUTF8StringEncoding]; 
```

我怎样才能得到正确的符号？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-13T19:40:41.460

有一个更简单的解决方案。

如果您的数据中有文字 unicode 转义序列（即`\u041c\0430\043a`作为纯 ASCII 字符，没有应用 unicode 转义），那么这不是该字符串的 UTF-8 编码。你想要`NSNonLossyASCIIStringEncoding`。

```
NSData *responseData = ....;

NSString* responseString = [[NSString alloc] initWithData:responseData encoding:NSNonLossyASCIIStringEncoding]; 
```

`responseString`现在将完全符合您的预期。

# powershell - Powershell Invoke-Item 不再适用于在资源管理器中打开目录

> ID：10141357
> 
> 赞同：3
> 
> 时间：2012-04-13T13:02:43.273
> 
> 标签：powershell, windows-explorer

我经常使用

```
ii . 
```

在 PowerShell 中打开 Windows 资源管理器中的当前目录。这曾经一直有效，但现在什么也没有发生。

该`Invoke-Item`cmdlet 仍然有效。这样做`ii somefile.txt`会在文本编辑器中打开该文件。但是目录不再起作用了。

另外`start .`不起作用。使用`explorer .`确实有效。

跑步

```
Trace-Command -Name ParameterBinding {ii .} -PSHost 
```

返回

```
DEBUG: ParameterBinding Information: 0 : BIND NAMED cmd line args [Invoke-Item]
DEBUG: ParameterBinding Information: 0 : BIND POSITIONAL cmd line args [Invoke-Item]
DEBUG: ParameterBinding Information: 0 :     BIND arg [.] to parameter [Path]
DEBUG: ParameterBinding Information: 0 :         Binding collection parameter Path: argument type [String], parameter type [System.String[]],
collection type Array, element type [System.String], no coerceElementType
DEBUG: ParameterBinding Information: 0 :         Creating array with element type [System.String] and 1 elements
DEBUG: ParameterBinding Information: 0 :         Argument type String is not IList, treating this as scalar
DEBUG: ParameterBinding Information: 0 :         Adding scalar element of type String to array position 0
DEBUG: ParameterBinding Information: 0 :         BIND arg [System.String[]] to param [Path] SUCCESSFUL
DEBUG: ParameterBinding Information: 0 : BIND cmd line args to DYNAMIC parameters.
DEBUG: ParameterBinding Information: 0 : MANDATORY PARAMETER CHECK on cmdlet [Invoke-Item]
DEBUG: ParameterBinding Information: 0 : CALLING BeginProcessing
DEBUG: ParameterBinding Information: 0 : CALLING EndProcessing 
```

跑步

```
Trace-Command -Name CommandDiscovery {ii .} -PSHost 
```

返回

```
DEBUG: CommandDiscovery Information: 0 : Looking up command: ii
DEBUG: CommandDiscovery Information: 0 : Alias found: ii  Invoke-Item
DEBUG: CommandDiscovery Information: 0 : Cmdlet found: Invoke-Item  Microsoft.PowerShell.Commands.InvokeItemCommand,
Microsoft.PowerShell.Commands.Management, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35 
```

我想可能是文件关联问题或其他问题。但我无法弄清楚`Invoke-Item`实际调用的是什么或如何改变它。

我怎样才能让它再次工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T13:06:03.417

很难弄清楚为什么它可能不再适合你，但为什么不使用在 powershell 和 cmd 中相同的替代方案：

```
start . 
```

（`explorer .`也可以）

如果`ii .`很重要，请尝试重新启动 Powershell 控制台和/或计算机。也试着做`ii . -whatif`看看你是否知道为什么它不再起作用了。

# c - 读取一个 C 文件，读取一个额外的行，为什么？

> ID：10141359
> 
> 赞同：4
> 
> 时间：2012-04-13T13:02:57.177
> 
> 标签：c

我不知道为什么文件指针会从文件中读取额外的一行，特别是最后一行，这里是代码：

```
FILE *fp ;
fp = fopen ("mac_ip.txt", "r") ;
int mac;
char *ip = (char *) malloc(15);

while(!feof(fp)){
    fscanf(fp,"%i",&mac);
    fscanf(fp,"%s",ip);

    printf("MAC: %i\n",mac);
    printf("IP: %s\n",ip);  
} 
```

该文件正好有 20 行，但第 20 行打印了两次。

哪个是错误？

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-13T13:06:28.637

因为在阅读了最后两个值之后，您仍然没有达到 EOF。所以循环继续。在循环的下一次循环中，fscanf 实际上并没有像它出现的那样第二次读取最后一行，fscanfs 失败，但 printfs 打印出循环前一次循环的值。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-13T13:07:34.303

`feof`在您尝试阅读更多内容之前，不会“知道”它位于文件末尾。因为[`fscanf`](http://www.cplusplus.com/reference/clibrary/cstdio/fscanf/)告诉你它有多少项目，你可以使用这个简单的技巧：

```
for(;;){
    if (fscanf(fp,"%i%s", &mac, ip) != 2) break;
    printf("MAC: %i\n",mac);
    printf("IP: %s\n",ip);  
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-13T13:06:46.240

在您完成第 20 行的两次读取后，您已经到了文件的末尾，*但*系统不知道这一点。feof 只会在您尝试越过文件末尾时触发，而不是在您完全位于文件末尾时触发...

此外，您可能在第 20 行有一个行尾（CR 或 CR-LF），它只会在再次尝试读取时通过。

解决方案是一口气读取该行（为此有一个特定的 C 命令），然后解析它以获取您的数据。如果整行读取失败，那么你已经走到了尽头。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-13T13:25:45.147

您的代码类似于以下示例

```
#include <stdio.h>

int main(void)
{
    char buffer[256];
    FILE * myfile;

    myfile = fopen("some.txt","r");

    while (!feof(myfile))
    {
        fgets(buffer,256,myfile);
        printf("%s",buffer);
    }

    fclose(myfile);

    return 0;
} 
```

从

[http://www.friedspace.com/feof.html](http://www.friedspace.com/feof.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-13T13:09:59.483

您最好在打印结果之前测试 fscanf 返回值。我敢打赌，在你的循环的最后一次迭代中， fscanf 调用失败并且你打印最后返回的结果。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-13T13:10:04.093

```
FILE *fp ;
int mac;
char ip[15];

fp = fopen ("mac_ip.txt", "r") ;
if (!fp) return;

while(1){
    if (fscanf(fp,"%i",&mac) < 1) break;
    if (fscanf(fp,"%s",ip) < 1) break;

    printf("MAC: %i\n",mac);
    printf("IP: %s\n",ip);  
}
fclose (fp); 
```

fscanf() 返回它疯狂的赋值数（或 eof 上的 -1）。通过使用返回值，您不需要 eof() 函数。顺便说一句，我认为您不能将 MAC 地址读入 int。也许您也需要将其读入字符串？

说明： feof() 不符合 OP 的预期。**feof() 仅应在文件操作之一失败后检查。**在大多数情况下，您不需要 feof()。

# visual-studio-2010 - 在构建后事件中复制和覆盖文件的正确语法

> ID：10141364
> 
> 赞同：2
> 
> 时间：2012-04-13T13:03:13.730
> 
> 标签：visual-studio-2010, xcopy, post-build-event, robocopy

在 Windows 7 上运行的 VS2010 的构建后事件中，将文件复制并始终覆盖到目标目录的最佳方法是什么。

目前我正在使用

```
robocopy $(SolutionDir) $(TargetDir) "Morning Report Template.xlsm" 
```

我也尝试过使用 Xcopy（带 /Y），甚至只是简单的副本。但我还没有让它正常工作。要么我收到诸如“命令“robocopy C:\Working\Projects\SAFEXQueryForm\C:\Working\Projects\SAFEXQueryForm\SAFEXQueryForm\bin\Release\“Morning Report Template.xlsm””之类的构建错误，代码为 1。” 否则它只是不复制。

我需要它每次都复制和覆盖，而不会出现构建错误，而且我还希望更改我知道 Robocopy 无法做到的文件名。

我究竟做错了什么？最好的方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-27T13:08:55.223

**编辑 2015/11/23**

这个答案提供了一个更好的方法：[https](https://stackoverflow.com/a/4596552/1011724) ://stackoverflow.com/a/4596552/1011724 。您可以将文件添加到项目中，然后更改文件的“复制到输出目录”属性。

* * *

**原始答案**

我仍然不知道我的原始语法有什么问题或如何说服 VS`Robocopy`的成功退出代码是 1 但这是我现在拥有的并且它似乎有效，唯一的区别是我更改了目录结构但是没关系（恐怕我不知道我是否在此期间进行了其他更改，这是很久以前的事了）

```
xcopy "$(SolutionDir)\Additional Files\Morning Report Template.xlsm" "$(TargetDir)" /Y 
```

而且我将 Run post build 事件下拉设置为`On successful build`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T15:22:10.687

您需要使用自定义构建操作来实现此目的。有关详细信息，请参阅[http://msdn.microsoft.com/en-US/library/hefydhhy(v=vs.80).aspx](http://msdn.microsoft.com/en-US/library/hefydhhy(v=vs.80).aspx)，但这是我尝试过的。

我将输入文件添加到项目中。然后选择文件并显示属性页面（右键单击-> 属性）。在“常规”页面上，确保“项目类型”为“自定义构建工具”。

您可能需要关闭并重新打开属性对话框，但是将“项目类型”更改为“自定义构建工具”后，属性对话框中应该有一个“自定义构建工具”页面。然后，您可以填写命令行。确保使用我们的自定义构建步骤生成的文件的名称填写“输出”部分。

然后，您应该会发现，只要项目发现输入文件的日期大于输出文件的日期，就会构建并运行自定义构建步骤，我相信这就是您想要实现的目标。

# twitter-bootstrap - 用 twitter bootstrap 替换选择框后的 Jquery 更改功能

> ID：10141365
> 
> 赞同：1
> 
> 时间：2012-04-13T13:03:16.003
> 
> 标签：twitter-bootstrap, onchange, jquery

[http://jsfiddle.net/xuAQv/](http://jsfiddle.net/xuAQv/) <-- 链接到我在 JsFiddle 上的错误代码。

所以我发现了这段代码，它将传统的表单选择框转换为他们的 twitter bootstrap 样式版本。它本质上只是隐藏了选择，并使用引导程序的 css / js 为选择框创建了 html。

[http://blog.iamjamoy.com/convert-select-boxes-to-a-fancy-html-dropdown](http://blog.iamjamoy.com/convert-select-boxes-to-a-fancy-html-dropdown) 我稍微定制了插件来改变下拉菜单的外观。

我现在遇到的问题是 $("#mySelect").change(function(){}); 不再开火。我尝试在其中添加 .live 和 .on ，但没有任何运气。

我需要修改插件吗？这是我的插件代码..

```
/*!
 * Convert <select> elements to Dropdown Group
 *
 * Author: John Rocela 2012 <me@iamjamoy.com>
 * Customized: Frank B 3/2012
 */
jQuery(function ($) {
    $('select').each(function (i, e) {
        if (!($(e).data('convert') == 'no')) {
            //get some initial data...
            xSelect = $(e).attr('id')
            xLabel = $("#" + xSelect + " option:selected").text();
            xClass = $(e).data('class')
            $(e).hide().wrap('<div class="btn-group" id="select-group-' + i + '" />');
            var select = $('#select-group-' + i);
            select.html('<a class="btn dropdown-toggle ' + xClass + '" data-toggle="dropdown" href="javascript:;">' + xLabel + ' <span class="caret"></span></a><ul class="dropdown-menu"></ul><input type="hidden" value="' + $(e).val() + '" name="' + $(e).attr('name') + '" id="' + $(e).attr('id') + '" class="' + $(e).attr('class') + '" />');
            $(e).find('option').each(function (o, q) {
                select.find('.dropdown-menu').append('<li><a href="javascript:;" data-title="' + $(q).text() + '" data-value="' + $(q).attr('value') + '">' + $(q).text() + '</a></li>');
                if ($(q).attr('selected')) select.find('.dropdown-menu li:eq(' + o + ')').click();
            });
            select.find('.dropdown-menu a').click(function () {
                select.find('input[type=hidden]').live().val($(this).data('value')).change();
                select.find('.btn:eq(0)').html($(this).text() + ' <span class="caret"></span>');
            });
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T13:31:12.357

如果您查看代码中实际发生的情况，选择将被隐藏输入替换。当您更改值时，这就是它所`change()`调用的内容。您将需要使用事件委托。像这样的东西：

```
$("<parent selector>").on("change","#mySelect", function(){}); 
```

`<parent selector>`与未替换的选择的某些父级匹配的选择器在哪里。如果需要，它可以是，`document`但理想情况下，您希望它尽可能远离树。

* * *

你`live`没有工作的原因是因为它应该是这样的：

```
$("#mySelect").live("change", function(){}); 
```

虽然`live`如果您使用的是最新的 jquery，则不应使用，但您应该使用`on`.

* * *

**编辑：**更新你的小提琴：http: [//jsfiddle.net/xuAQv/2/](http://jsfiddle.net/xuAQv/2/)

# java - 通过将 blob 映射到二进制数据来读取和写入 blob

> ID：10141373
> 
> 赞同：0
> 
> 时间：2012-04-13T13:03:40.543
> 
> 标签：java, hibernate, sybase, hibernate-mapping

我在尝试使用休眠 JPA 从 Sybase DB 读取 blob 时遇到以下异常。

实体

```
@Lob
@Column(length=100000)    
private byte[] fileContent;

public byte[] getFileContent() {
    return fileContent;
}

public void setFileContent(byte[] fileContent) {
    this.fileContent = fileContent;
} 
```

ioc.Registry com.sybase.jdbc3.jdbc.SybResultSet.getBlob(String) 方法不受支持，不应调用。ioc.Registry 操作跟踪：ioc.Registry [1] 在 Purchase_Request TapestryModule.RequestExceptionHandler 上触发事件“激活”处理请求失败，未捕获异常：不支持方法 com.sybase.jdbc3.jdbc.SybResultSet.getBlob(String) 并且不应该被调用。org.apache.tapestry5.ioc.internal.OperationException：方法 com.sybase.jdbc3.jdbc.SybResultSet.getBlob(String) 不受支持，不应调用。

我遇到了以下休眠线程，该线程提供了一个链接，该链接指向如何通过将 blob 映射到二进制数据来读取和写入 blob，但是该链接已失效。

线程 [https://forum.hibernate.org/viewtopic.php?f=1&t=936553](https://forum.hibernate.org/viewtopic.php?f=1&t=936553)

死链接 [http://www.hibernate.org/73.html](http://www.hibernate.org/73.html)

我想知道是否有人可以提供一个例子或一篇文章来描述如何做到这一点？

更新

我发现以下 JIRA 问题概述了这个问题 [https://issues.jboss.org/browse/JBPAPP-2867](https://issues.jboss.org/browse/JBPAPP-2867)

Laura 声称“解决此问题的方法是创建映射到 Sybase 文本和图像类型的用户定义类型。”

有人熟悉创建用户定义的类型吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T14:08:45.757

您可以尝试在映射中使用 java.sql.Blob 而不是字节数组。您可以使用 Hibernate.createBlob() 函数从字节数组、字符串、输入流转换 blob。这样做的好处是延迟加载（仅在休眠会话打开之前）。

否则..在内存中加载更大的对象会消耗大量的堆空间。

```
 private void setBlob(Blob blob) 
 {
    this.image = toByteArray(blob);
 }

 private Blob getBlob()
 {
   return Hibernate.createBlob(this.image);
 } 
```

# iphone - 当我尝试停止动画 UIActivityIndi catorView 时内存崩溃

> ID：10141377
> 
> 赞同：0
> 
> 时间：2012-04-13T13:03:57.287
> 
> 标签：iphone

当我试图从线程更新 UIActivityIndi​​catorView 时。该应用程序通过抛出一个正在完成的异常修改层而崩溃 - 0x7e177fd0 -[CALayer removeAnimationForKey:]: message sent to deallocated instance 0x7e177fd0 。当我尝试从 mallocDebugger 工具中跟踪内存泄漏时。

这种崩溃并非一直发生，十分之一

请帮我解决这个内存问题

NSAutoreleasePool *pool = [[NSAutoreleasePool alloc]init];

```
[autoRechargeCell addSubview:activityIndicator];
[self.activityIndicator startAnimating];
   if( [PennyTalkAPI getBalanceInfoForAccount:appDelegate.accountNumber withPIN:appDelegate.pinNumber])
{   
    [autoRechargeCell.switchField setOn:[[NSUserDefaults standardUserDefaults] boolForKey:@"AutoRecharge"]];
    [self.activityIndicator stopAnimating];   <<<<<<<<<<<<<<<<<<<<<< 

}
else
{
    [self.activityIndicator stopAnimating];
}

[pool release]; 
```

这是我写的代码

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T13:07:12.010

这要么是双重释放错误，要么是悬空指针。您应该在 Scheme 的配置中启用僵尸检测，并尝试在 Instruments 中使用 Zombies 工具。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T13:05:37.783

在不查看代码并看到错误的情况下，我假设您释放了活动指示器，然后您尝试访问它以进行动画处理。

解决方法：在.h文件中声明`UIActivityIndicator`对象合成并在`-(void)dealloc`方法中释放。

# entity-framework - 如何使用 Code First 实体框架链接属性？

> ID：10141381
> 
> 赞同：0
> 
> 时间：2012-04-13T13:04:08.110
> 
> 标签：entity-framework, ef-code-first

我正在尝试做看起来相当简单的事情，但我得到了一个空引用....

我在最后一个语句中的 assoc files 属性上有一个 null ......

```
TestInfo.AggregateRoutes.MainBlogEntry = new Blog { BlogType = 1, Title = TestInfo.UniqueRecordIdentifier, Description = TestInfo.UniqueRecordIdentifier, DateAdded = DateTime.Now, User = TestInfo.UniqueRecordIdentifier };

IBlogRepository blogRepo = new BlogRepository();
var assocFile = new AssocFile { Name = TestInfo.UniqueRecordIdentifier, Url = TestInfo.UniqueRecordIdentifier };

TestInfo.AggregateRoutes.MainBlogEntry.AssocFiles.Add(assocFile); 
```

这是我为支持我正在尝试做的事情而编写的代码......

```
public class PteDotNetContext : DbContext
    {
        public DbSet<Blog> Blogs { get; set; }
        public DbSet<AssocFile> AssocFiles { get; set; }
    }

 public class Blog
    {

        [Key]
        [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
        public int BlogId { get; set; }
        public int BlogType { get; set; }
        public string Title { get; set; }
        public string Description { get; set; }
        public DateTime DateAdded { get; set; }
        public string User { get; set; }

        public virtual ICollection<AssocFile> AssocFiles { get; set; }
    }

 public class AssocFile
    {

        [Key]
        [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
        public int AssocFileId { get; set; }

        public int BlogId { get; set; }
        public string Url { get; set; }
        public string Name { get; set; }

        public virtual Category Category { get; set; }
    } 
```

我认为声明它是虚拟的重点是它会创建一个外键约束？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T13:33:30.877

当您实例化一个实体时，您还需要在第一次访问它之前初始化集合导航属性。在你的情况下`MainBlogEntry.AssocFiles = new List<AssocFile>();`。原因是，您的属性实现不包含任何初始化集合的逻辑。

当 EF 创建您的实体的新实例时，它会将您的实体子类化（即代理创建）并覆盖您的属性的默认功能。

```
TestInfo.AggregateRoutes.MainBlogEntry = new Blog { BlogType = 1, Title = TestInfo.UniqueRecordIdentifier, Description = TestInfo.UniqueRecordIdentifier, DateAdded = DateTime.Now, User = TestInfo.UniqueRecordIdentifier };

IBlogRepository blogRepo = new BlogRepository();
var assocFile = new AssocFile { Name = TestInfo.UniqueRecordIdentifier, Url = TestInfo.UniqueRecordIdentifier };

TestInfo.AggregateRoutes.MainBlogEntry.AssocFiles = new List<AssocFile>();

TestInfo.AggregateRoutes.MainBlogEntry.AssocFiles.Add(assocFile); 
```

# java - 安全地准备逗号分隔列表以供查询

> ID：10141387
> 
> 赞同：0
> 
> 时间：2012-04-13T13:04:27.847
> 
> 标签：java, spring, jdbc

> **可能重复：**
> [如何通过 Spring JdbcTemplate 生成动态“in (...)” sql 列表？](https://stackoverflow.com/questions/1981683/how-to-generate-a-dynamic-in-sql-list-through-spring-jdbctemplate)

我正在尝试为`IN()`java 中的 MsSQL 中的一个子句准备一个 ID 列表。我有下面的代码，它看起来应该可以工作，但它抛出了错误：java.sql.SQLException：将 nvarchar 值“1,2”转换为数据类型 int 时转换失败。

当我传递一个字符串时，为什么它像一个整数一样尝试它，我完全不知所措。任何见解都会很棒。

我也试过换成`template.getId()`没有`template.getId().toString()`运气

```
 //JOINs
    Collection<Template> templates = search.getTemplateCollection();
    if (templates != null && templates.size() > 0) {
        searchQuery.append("INNER JOIN dbo.content_to_template ON content_to_template.template_id IN (:templateIds) AND content_to_template.content_id = content.id ");

        StringBuilder templateIds = new StringBuilder();
        for (Template template : templates) {
            if (templateIds.length() == 0) {
                templateIds.append(template.getId());
            } else {
                templateIds.append(",").append(template.getId());
            }
        }
        queryMap.put("templateIds", templateIds.toString());
    }

return this.namedjdbcTemplate.query(searchQuery.toString(), new MapSqlParameterSource(queryMap), this.contentRowMapper); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T13:25:32.267

您需要准备一组模板 ID 并将其传递给地图。字符串分隔的数据可能无法像预期的那样工作。

========================

```
List templateIds = new ArrayList(); 
templateIds.add(template.getId()); 

----
---

 queryMap.put("templateIds", templateIds); 
```

# jquery - JQuery LT 选择器工作但 GT 不是

> ID：10141388
> 
> 赞同：1
> 
> 时间：2012-04-13T13:04:34.507
> 
> 标签：jquery, jquery-selectors, siblings

我正在研究星级选项。我有一个包含隐藏输入和五个图像的跨度。当其中一个图像悬停在上面时，该图像和左侧的每个兄弟图像都设置为图像的突出显示版本，而右侧的每个兄弟图像都变暗。

### 的HTML

```
<span>
 <input type="hidden" value="1" class="starCount">
 <img src="star-on.jpg" alt="Rating:1 Star" class="rating"><!--
 --><img src="star-off.jpg" alt="Rating:2 Stars" class="rating"><!--
 --><img src="star-off.jpg" alt="Rating:3 Stars" class="rating"><!--
 --><img src="star-off.jpg" alt="Rating:4 Stars" class="rating"><!--
 --><img src="star-off.jpg" alt="Rating:5 Stars" class="rating">
</span> 
```

### jQuery

```
click: (function(){
  // Set the hidden input value to which rating you clicked
  $(this).siblings(".starCount:eq(0)").val($(this).index());
}),
mouseover: (function(){
  // Highlight the star being hovered + all stars to the left
  $(this).attr("src","star-on.jpg");
  $(this).prevAll(".rating").attr("src","star-on.jpg");
  $(this).nextAll(".rating").attr("src","star-off.jpg");
}),
mouseout:(function(){
  // Reset highlighted stars to the value of the hidden input

  // Get the position of the hovered element
  var stars = parseInt($(this).siblings(".starCount:eq(0)").val());

  if($(this).index() != stars){
    // Highlight this element and everything to it's left
    $(this).siblings(".rating:lt("+(stars-1)+")").attr("src","star-on.jpg");

    // Dim everything to the right
    /* -- Note this line: It works, but is where my question derives from -- */
    $(this).siblings(".rating:eq("+(stars-1)+")").nextAll().attr("src","star-off.jpg");
  }
}) 
```

我的问题是我必须如何完成“调光”部分。这适用于 [this element] + 以前的兄弟姐妹：

```
$(this).siblings(".rating:lt("+(stars-1)+")").attr("src","star-on.jpg"); 
```

**为什么这对之后的所有内容都不起作用：**

```
$(this).siblings(".rating:gt("+(stars-1)+")").attr("src","star-off.jpg"); 
```

* * *

我只是注意到我没有解释使用 GT 选择器时*什么*不起作用。这是我如何重现我的问题。见[http://jsfiddle.net/SNmcB/1/](http://jsfiddle.net/SNmcB/1/)：

*   点击第三颗星。
*   将鼠标悬停在星号 1 上并退出；它重置回选择的 3。
*   点击第一颗星。
*   将鼠标悬停在星号 4 或 5 上并退出；您悬停的星星仍然突出显示。
*   如果我使用 nextAll() 方法而不是 GT，则不会发生这种行为。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T13:36:16.443

第一颗星的兄弟姐妹是：2 3 4 5

没有 gt() 选择器可以选择它。

第二颗星的兄弟姐妹是：1 3 4 5 gt 参数需要为 0。

明星#3

兄弟姐妹：1 2 4 5

所需索引：1

明星#4

兄弟姐妹：1 2 3 5

所需索引：2

明星#5

兄弟姐妹：1 2 3 4

所需指数：3

所以以下应该工作：

```
if (stars === 1) {
    $(this).nextAll().attr("src","star-off.jpg");
} else {
    $(this).siblings(".rating:gt("+(stars - 2)+")").attr("src","star-off.jpg");
} 
```

# math - 拼字游戏 - 最好的举动

> ID：10141403
> 
> 赞同：0
> 
> 时间：2012-04-13T13:05:12.100
> 
> 标签：math

我已经为 scrabble 制作了算法。它使用最高分的策略。但我不认为这是玩游戏的最佳方式。

我的问题是：**拼字游戏是否有任何高级数学表明不是最高分的单词，而是另一个会增加获胜概率的单词**？

或者换句话说，一些不同的策略然后是最高分？

我有自己的想法。例如，假设有两个单词的分数几乎相同（s1 > s2），但假设第二个单词没有打开新的 3W 或 2W 的方式，甚至它的分数低于第一个的分数，比它好用第二个词而不是第一个词。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T13:40:25.583

根据我在拼字游戏方面的经验，您是正确的，因为您不一定要总是建议得分最高的单词。相反，您想建议**最好**的词。我不认为这需要很多高级数学才能完成。

以下是一些建议：

*   在您当前的算法中，根据易用性对所有字母（尤其是辅音）进行排序。例如，字母`"S"`将具有最高的易用性，因为它是最灵活的。也就是说，当您播放一个给定的单词并忽略该字母`"S"`时，您基本上打开了使用新字母进行更好单词选择的可能性，而不是在您的下一回合发挥作用。

*   平衡单词中的元音和辅音用法。作为一个普通的拼字游戏玩家，如果最好的得分词没有使用足够的元音，我并不总是玩最好的得分词。例如，如果我使用 4 个字母而不是不包含元音，并且我的字母数组中还剩下 3 个元音，那么我很有可能在下一回合至少画出两个元音，这将留下 5 个元音和 2 个辅音，哪个机会并没有为高分词打开很多机会。**在你的单词中使用更多的元音几乎总是比辅音更好，尤其是字母`I`。在选择最佳单词时，您的算法应该反映其中的一些。**

我希望这能给你一个好的开始。一旦您的算法能够选择最佳得分词，您就可以根据这些建议对其进行微调，以便在您的拼字游戏中成为整体上更好的得分手。（我假设这是您正在创建的某种 AI）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T13:08:56.223

> 我的问题是：拼字游戏是否有任何高级数学表明不是最高分的单词，而是另一个会增加获胜概率的单词？

正如 ROFLwTIME 提到的，你还需要考虑你没有玩过的字母。

在进行这种会计处理时，您需要考虑信件如何相互影响。例如，假设您有一个 Q、一个 U 和五个其他字母。假设你可以同时使用 Q 和 U 的最高得分是 30 分，但是你可以通过播放 U 而不使用 Q 来获得更高的分数。除非“more”超过 30，否则要么用 Q 弹奏这个词，要么找第三个词让 Q 和 U 都没有弹奏。

您还需要考虑您所玩的词为对手创造的机会。一个典型的博弈论策略是最大化你的分数，同时最小化你的对手分数，简称 maxin。玩一个 20 分的词，让你的对手玩一个 50 分的词不是一个好主意。

# javascript - 不包含“空白”的 jQuery(document).width()

> ID：10141405
> 
> 赞同：0
> 
> 时间：2012-04-13T13:05:17.440
> 
> 标签：javascript, jquery, dom

考虑这两个函数：

1.  `jQuery(document).width()`
2.  `jQuery(window).width()`

(1) 给出网页的宽度，(2) 给出浏览器视口的宽度，粗略地说。

但是假设我们有一个 800 像素宽的网页。

如果浏览器窗口宽度小于 800 像素，方法 (1) 总是返回 800。这很好。

但是如果浏览器窗口宽度大于 800 像素，方法 (1) 将返回与 (2) 相同的值，而不是 800。因此 (1) 的值取决于浏览器窗口。情况不妙。

我的问题是：鉴于您无法控制浏览器窗口大小，并且在大多数情况下浏览器窗口宽度大于网页宽度，我如何使用 javascript/jquery 获得真正的网页宽度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T13:28:31.020

AFAIK，当浏览器无法在当前窗口宽度中呈现某些**块时，它会添加滚动条。**因此，如果您有一个固定宽度的主要内容块（我建议您这样做），您可以获得它的宽度 - 它始终保持不变。

```
<div id="content">
<!-- Main block -->
</div> 
```

CSS：

```
#content{
   width:800px;
   margin:0 auto;
} 
```

JS：

```
$("#content").width() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T13:40:39.730

Don't really get the question, but there are many ways of getting the width of any object, here are the most commonly used:

[FIDDLE](http://jsfiddle.net/adeneo/WB6tT/)

Try adding some markup to that fiddle, and see if any of them get what you're looking for.

# php - 在使用 CakePHP 的模型方法中使用来自另一个模型的条件

> ID：10141406
> 
> 赞同：0
> 
> 时间：2012-04-13T13:05:18.800
> 
> 标签：php, cakephp

在我的应用程序中，我有三个表：

```
Users
Profiles
Friends 
```

用户有一个个人资料，个人资料有一个用户和许多朋友。朋友有很多个人资料。

在配置文件模型中，我有一个方法可以获取配置文件的配置文件列表（但它使用来自用户表的相关用户名。）

```
public function getFriends($username) {

   return $this->find('all', array(
     'conditions' => array(
       'User.username' => $username,
        'Friend.status' => 1
      )
   ));

} 
```

所以它应该得到一个与用户名匹配用户和朋友状态为 1 的配置文件列表。我该怎么做呢？

我还将发布我的关联，以便您了解数据库：

**用户模型：**

```
public $hasOne = 'Profile'; 
```

**型材型号：**

```
public $belongsTo = 'User';

public $hasMany = array(
    'ProfileFrom'=>array(
        'className'=>'Friend',
        'foreignKey'=>'profile_from'
    ),
    'ProfileTo'=>array(
        'className'=>'Friend',
        'foreignKey'=>'profile_to'
    )
);

public $hasAndBelongsToMany = array(
    'Friendship' => array(
        'className' => 'Profile',
        'joinTable' => 'friends',
        'foreignKey' => 'profile_from',
        'associationForeignKey' => 'profile_to'
    )
);

public $actsAs = array('Containable'); 
```

**朋友型号：**

```
public $belongsTo = array(
      'UserFrom'=>array(
         'className'=>'Profile',
         'foreignKey'=>'profile_from'
      ),
      'UserTo'=>array(
         'className'=>'Profile',
         'foreignKey'=>'profile_to'
      )
   );

public $actsAs = array('Containable'); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T14:13:11.710

这看起来很复杂，我建议看一下 Containable（一种核心 cakephp 行为），它可以更轻松地选择要获取的数据（尤其是在防止选择过多数据方面）。请考虑将其用于您的整个应用程序。

似乎您正试图告诉 cake 在关联的 Friend 模型中进行搜索，但如果我是对的，则该朋友存在的唯一关联被别名为 ProfileTo 和 ProfileFrom。所以我猜蛋糕不知道该去哪里招惹“朋友”。但在未来，发布任何错误也会有所帮助。

请参阅下面的建议以获取可能的解决方法。

* * *

现在您可以执行以下操作： 在 ProfileModel 中：

```
function getFriends($username) {
    //Start by getting User's ID
    $user = $this->User->find(
        'first',
        array(
            'conditions' => array(
                'User.username' => $username
            )
        )
    );
    //User's ID is now $user['User']['id']

    //Fetch user's profile with associated friends
    $this->Behaviors->attach('Containable');
    $profileAndFriends = $this->find(
        'first',  //Because User hasOne Profile, so we'll fetch this one profile.
        array(
            'conditions' => array(
                'Profile.user_id' => $user['User']['id']
            ),
            //We'll want to fetch all associated Friend records (which are linked to the Profile model as ProfileFrom and ProfileTo
            'contain' => array(
                'ProfileFrom' => array(
                    'conditions' => array(
                        'status' => 1
                    )
                ),
                'ProfileTo' => array(
                    'conditions' => array(
                        'status' => 1
                    )
                )
            )
        )
    );
    return $profileAndFriends;
} 
```

它应该像这样工作。因此，在 FriendsController 中，您现在应该能够`$this->Friend->UserTo->getFriends('cameron');` 获取属于用户名为“cameron”的用户的个人资料，以及与此个人资料关联的所有好友。

* * *

不过，还有一件小事仍然困扰着我，那就是您收到一个错误，指出 ProfileTo 与 Profile 没有关联，这很奇怪，因为在您的示例中，关系显然已定义。原因可能是您的关联定义中的错误，但我不确定。

* * *

还有一个建议，如果上面的代码不起作用，请将`contain`数组替换为：

```
 'contain' => array(
                'Friendship' => array(
                    'conditions' => array(
                        'OR' => array(
                            'Friendship.profile_from' => 'Profile.id',
                            'Friendship.profile_to' => 'Profile.id',
                        )
                    )
                )
            ) 
```

# java - JUnit 只是记录失败？

> ID：10141407
> 
> 赞同：2
> 
> 时间：2012-04-13T13:05:23.213
> 
> 标签：java, junit

如何使用 JUnit 在断言失败时不终止，而只是记录它们？

如果存在日志消息，我的目标是失败，并将它们打印出来。因为我想遍历一个大列表，并且想知道哪些元素失败了。

如何强制 JUnit 不因失败而中断？

泰

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T13:13:27.000

也许[ErrorCollector](http://kentbeck.github.com/junit/javadoc/latest/org/junit/rules/ErrorCollector.html)规则会帮助你

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T13:09:00.760

如果您想查看测试可能失败的所有原因，而不仅仅是第一个，您需要创建一个测试失败的原因列表，如果列表最后不为空，则抛出错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-13T14:04:04.077

你不能用标准的 JUnit 做你想做的事，你的测试就是这样。问题是 assertXXX 方法实际上会抛出异常（AssertionError），因此您不能使用正常的断言并从抛出异常后的点恢复。JUnit 捕获这些 AssertIonErrors 并做正确的事。

正如 Ludwig 建议的那样，一种替代方法是使用 ErrorCollector 规则，但这将意味着重写我想象的相当一部分测试。

如果您的目标是遍历一个大列表，请查看[Parameterized](http://kentbeck.github.com/junit/javadoc/latest/org/junit/runners/Parameterized.html)。这允许您迭代单个测试方法，每次使用不同的数据：

```
@RunWith(Parameterized.class)
public class FibonacciTest {
  @Parameters
  public static List<Object[]> data() {
    return Arrays.asList(new Object[][] {
      { 0, 0 }, { 1, 1 }, { 2, 1 }, { 3, 2 }, { 4, 3 }, { 5, 5 }, { 6, 8 }
    });
  }

  private int fInput;

  private int fExpected;

  public FibonacciTest(int input, int expected) {
    fInput= input;
    fExpected= expected;
  }

  @Test
  public void test() {
    assertEquals(fExpected, Fibonacci.compute(fInput));
  }
} 
```

data() 返回 Object[] 的列表。列表中的每个 Object[] 都被传递给测试类的构造函数。因此，列表中的每个条目都使用测试类的新实例。

Object[] 中的条目数必须与构造函数的参数数相对应，并且类型也必须对应。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-13T13:10:33.460

[如果您在junit](http://ant.apache.org/manual/Tasks/junit.html)任务中使用诸如 ant 之类的构建工具，则可以设置一个`haltonfailure`属性，`no`以便在测试失败时它不会停止您的构建过程。

# jquery - 滚动到后如何淡入元素

> ID：10141410
> 
> 赞同：1
> 
> 时间：2012-04-13T13:05:43.963
> 
> 标签：jquery, scroll, fadein, sticky

我正在使用滚动脚本，当页面上到达某个点时，它将元素的显示从无更改为阻塞。

有什么方法可以应用淡入以及更改显示，甚至加载动画 gif 吗？

这是我的代码

```
window.onscroll = function()
{
if( window.XMLHttpRequest ) {
    if (document.documentElement.scrollTop > 454 || self.pageYOffset > 454) {
    $('logosmall').style.position = 'fixed';
    $('logosmall').style.top = '0';
    $('logosmall').style.padding = '10px';
    $('logosmall').style.display = 'block';
} else if (document.documentElement.scrollTop < 454 || self.pageYOffset < 454) {
        $('logosmall').style.position = 'absolute';
        $('logosmall').style.top = '454px';
        $('logosmall').style.display = 'none';
    }
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T13:13:07.747

您只需链接[`.fadeIn()`](http://api.jquery.com/fadein/)或[`.fadeOut()`](http://api.jquery.com/fadeout/)。这样做时，使用它总是一个好主意，[`.stop(true, true)`](http://api.jquery.com/stop/)这样您就不会排队动画。我还重构了您的代码，以便在样式方面更有效：

```
window.onscroll = function() {

    if( window.XMLHttpRequest ) {
        if (document.documentElement.scrollTop > 454 || self.pageYOffset > 454) {

            $('logosmall').css({

                'position' : 'fixed',
                'top'      : '0',
                'padding'  : '10px'

            }).stop(true,true).fadeIn('slow');

        } else if (document.documentElement.scrollTop < 454 || self.pageYOffset < 454) {

            $('logosmall').css({

                'position' : 'absolute',
                'top'      : '454px'

            }).stop(true, true).fadeOut(0);

        }
    }
} 
```

PS我不确定这是否是拼写错误，但是 logosmall 是一个类还是一个 id？如果它是一个类，你需要在它前面加上一个句点：`.logosmall`. 如果它是一个 id，你需要在它前面加上一个井号：`#logosmall`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T13:09:23.493

改了怎么办

```
$('logosmall').style.display = 'block'; 
```

至

```
$('logosmall').fadeIn(); 
```

?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T13:11:50.440

我真的不明白你需要什么。但是如果你只是想做一个淡入淡出，解决方案在这里[http://api.jquery.com/fadeIn/](http://api.jquery.com/fadeIn/)

```
$('#myDivID').fadeIn('slow', function() {
        // Animation complete
      }); 
```

# javascript - JavaScript 如何在运行时推断实例类型？

> ID：10141412
> 
> 赞同：0
> 
> 时间：2012-04-13T13:06:00.450
> 
> 标签：javascript, types, runtime

在编写 JavaScript 时，我总是理所当然地认为将两个整数相加会产生另一个整数。或者将两个字符串加在一起会导致串联。但我开始思考，在使用这些实例执行操作之前，语言如何在幕后确定实例的类型？

```
var one = 1;
var two = 2;
var fourStr = 'four';
var floaty = 1.5;

//this results in an integer
var three = one + two;           //3

//but this results in a string
var result = fourStr + one;      //'four1'

//and this results in a float
var floatenized = one + floaty;  //2.5 
```

**运行时是否只是确定实例类型，然后引用某种内部类型优先级或其他什么？**当不同类型的实例组合在一起时，谁能准确解释运行时**如何执行这些操作？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T13:09:20.950

ecmascript[规范](http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-262.pdf)准确地描述了操作符`+`（第 11.6.1 节）如何处理不同的类型。

与您的示例相关：

*   (number) `+`(number): 结果将是浮点数的总和
*   (string) `+`(number)：结果将是字符串的连接和数字的字符串表示形式
*   （数字）`+`（字符串）：结果将是数字和字符串的字符串表示形式的连接

但`+`也可以作为一元运算符将字符串转换为数字，就像二元`-`运算符一样（例如：`+"4"+5==9`, `5-"4"==1`）。

类型转换算法在规范的第 9 节中描述。未指定环境应如何存储基元和对象的类型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T13:08:00.577

当您将数字分配给变量时

```
var one = 1;
//or
var floaty = 1.5; 
```

值类型是数字....当您将字符串分配给变量时

```
var fourStr = 'four'; 
```

值类型是字符串。当您添加一个字符串和一个数字时，它会将数字转换为一个字符串，然后连接两个字符串

[请参阅 Mozilla 的此文档的值部分](https://developer.mozilla.org/en/JavaScript/Guide/Values,_Variables,_and_Literals)

# cocos2d-iphone - 在 cocos2d for iPhone 中绘制线/点非常慢

> ID：10141414
> 
> 赞同：0
> 
> 时间：2012-04-13T13:06:14.317
> 
> 标签：cocos2d-iphone

我正在尝试在我的游戏周围绘制彩色景观，当玩家继续前进时，它会动态改变其形状和颜色。

即使是简单的绘图也会导致帧率下降到 10 FPS 左右。

```
-(void) draw {    
    glPointSize(1);
    glColor4ub(100,100,100,255);
    for(int i=0; i<100; i+=1){
        for (int j=0; j<100; j++){
            ccDrawPoint(ccp(i, j));
        }
    }
} 
```

我能做些什么来使这些操作更快地工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T16:08:50.537

您正在调用`ccDrawPoint`并制作一个新`CGPoint`的 10,000 次一帧，这可能会导致一些速度变慢。你见过`ccDrawSquare`吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-06T10:00:34.440

使用 ccDrawPoint 或 ccDrawLine 绘制自定义形状不是很好的解决方案。

绘制自定义形状的最佳方法是绘制多个三角形甚至更好——多个多边形。

检查此线程以了解如何操作：http: [//www.cocos2d-iphone.org/forum/topic/848](http://www.cocos2d-iphone.org/forum/topic/848)

# .htaccess - .htaccess 重写一个 url，而不是另一个

> ID：10141416
> 
> 赞同：0
> 
> 时间：2012-04-13T13:06:23.690
> 
> 标签：.htaccess, mod-rewrite, apache2.2

我已经设置了这组`.htaccess`重写（Zend Framework 默认重写规则）：

```
重写引擎开启
RewriteCond %{REQUEST_FILENAME} -s [OR]
RewriteCond %{REQUEST_FILENAME} -l [OR]
RewriteCond %{REQUEST_FILENAME} -d
重写规则 ^.*$ - [NC,L]
RewriteRule ^.*$ index.php [NC,L]

```

我的`DocumentRoot`文件夹只包含`.htaccess`and `index.php`，没有别的。

重写规则应该通过 index.php 将所有请求发送到不存在的文件。这发生在`/herp/derp/`（无论控制器是否存在），但不适用于`/index/herp/`或任何其他以`/index/`.

所有`/index/*`url 都被路由到 apache 的 404 页面，所有其他 url 都可以工作。

我应该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T13:50:20.300

原来 MultiViews 做到了这一点。仍然不确定为什么：P

# c++ - 调用父窗口小部件函数

> ID：10141417
> 
> 赞同：1
> 
> 时间：2012-04-13T13:06:24.770
> 
> 标签：c++, qt4, signals-slots

使用 Qt 我有一个带有几个 QPushButton 按钮的 QStackedWidget。小部件的父小部件是 QMainWindow。在 QStackedWidget 里面我也有一些 QLineEdit。我想做的很简单：验证包含文本框的表单，如果一切正常，调用将处理数据的自定义类的函数。该类的实例是在我的 QMainWindow 类中创建的。调用该类方法的最佳方法是什么？我应该使用 Qt 的信号/插槽机制将我的自定义类连接到 QStackedWidget 内的小部件实例吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T13:12:36.260

您可以根据需要多次从[QValidator派生，并在每个需要验证的字段上安装验证器。](http://doc.qt.nokia.com/4.7-snapshot/qvalidator.html)这样，您可以确保该字段为空或包含有效条目。

在处理您的数据之前，请确保所有适当的字段都有数据，然后保证您有一个有效的表单。

将数据从表单传递给表单数据的某些消费者的典型方法是创建一个中间人类来保存数据。验证表单后填充类的实例，然后将该实例传递给使用者。这样，如果表单发生更改，您的消费者将与这些更改隔离，前提是正在收集相同的数据。

一般规则是针对对象接口工作，而不是它们的实现。只要记住一些事情，您是执行 sig/slot 还是直接函数调用都没有关系：

Sig/slot 不保证调用顺序，并且发出信号本质上意味着任何可以看到这个对象的人都可以连接到它的信号并接收这个变化。如果您*必须*保证子组件处理表单数据的顺序，那么为什么还要让维护程序员选择搞砸呢？

其次，对象所在的*位置*无关紧要。有一天，当您的数据消费者变得非常复杂，并且您想根据某些情况（可能是用户权限，或者今天的日期，或者当前的温度，我不知道！）来获取不同的数据时，那么您将想做一个重新拱。如果您将数据提供给消费者的逻辑高度依赖于以某种方式驻留在表单中的对象，那么您做错了。

# objective-c - Objective-C - 将项目从 NSDictionary 添加到 NSMutableDictionary

> ID：10141420
> 
> 赞同：1
> 
> 时间：2012-04-13T13:06:39.483
> 
> 标签：objective-c, ios, json, nsdictionary, nsmutabledictionary

我在尝试将对象从 an 加载`NSDictionary`到 an 时遇到问题`NSMutableDictionary`- 代码如下：

```
dictListData = [[NSMutableDictionary alloc] initWithCapacity:200]; 
```

...

```
NSError *jsonError = nil;
NSDictionary *jsonResultDict = [NSJSONSerialization JSONObjectWithData:[httpRequestCopy responseData] options:kNilOptions error:&jsonError];
NSDictionary *tempDataset = [[jsonResultDict objectForKey:@"result"] objectAtIndex:0]; 

NSLog(@"tempDataset = %@", tempDataset);

[dictListData addEntriesFromDictionary:tempDataset];   // <-- Error here 
```

该`NSLog`命令以字典样式格式输出数据，因此我知道数据在那里，但是 addEntriesFromDictionary 命令失败并出现错误：

`'NSInvalidArgumentException' [NSMutableDictionary addEntriesFromDictionary:]: dictionary argument is not an NSDictionary'.`

我尝试过对 tempDataset 进行类型转换，但没有任何区别。有任何想法吗？

我正在使用 Xcode 4.3.2，针对 iOS SDK 5.1，启用了 ARC。

```
jsonResultDict = {
    result =     (
                (
                        {
                stCode = 000477065;
                stDesc1 = "TIMER KNOB";
                stQtyFree = 0;
                stQtyInStock = 0;
            },
                        {
                stCode = 0010311;
                stDesc1 = "DBLE TAPER CHUCK CAP";
                stQtyFree = 10;
                stQtyInStock = 10;
            },
                        {
                stCode = "0016-103";
                stDesc1 = "1/8 I.D";
                stQtyFree = 0;
                stQtyInStock = 0;
            },
                        {
                stCode = "0016-104";
                stDesc1 = "1/4 I.D";
                stQtyFree = 0;
                stQtyInStock = 0;
            },
                        {
                stCode = "0016-157";
                stDesc1 = "1/8 x 1/16 X 1/8 TEE";
                stQtyFree = 0;
                stQtyInStock = 0;
            }
        )
    );
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T13:23:00.930

这似乎`tempDataset`是一个`NSArray`类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T13:31:16.633

Flink 回答它是一个 NSArray 类应该是正确的。此外，如果您确实需要将 an 转换`NSDictionary`为`NSMutableDictionary`，它的使用要容易得多`myDictionary.mutableCopy`。

# c++ - 至少内部名称的前 31 或 63 个字符有意义？

> ID：10141422
> 
> 赞同：0
> 
> 时间：2012-04-13T13:06:45.983
> 
> 标签：c++, c, variables, names, kr-c

这是书中的直接引述（K&R，第 2 版，第 35 页）：

> “至少内部名称的前 31 个字符是重要的。对于函数名称和外部变量，该数字可能小于 31，因为外部名称可能被语言无法控制的汇编程序和加载程序使用。对于外部名称, 标准只保证 6 个字符和一个大小写。”

并且在 C99 中对其内部名称没有长度限制，但只有前 63 个保证是重要的（第 5.2.4.1 节翻译限制）。

我的问题是为什么这些限制特别是**31**或**63**？为什么是这个数字？为什么不是**19、24**或任何其他数字？如果这是一个实施问题，将其**设为 31**或**63**是否有好处？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-13T13:13:48.740

与语言设计委员会相关的编译器/链接器编写者通常会施加一些限制，以便他们可以在工具链的实现或随附的二进制文件格式（例如[ELF](http://en.wikipedia.org/wiki/Executable_and_Linkable_Format)、[COFF](http://en.wikipedia.org/wiki/COFF)等）中做出假设。选择数字 31 和 63 可能只是因为它们是 2 ^n -1 而程序员出于某种愚蠢的原因喜欢 2 ^(n 。)-1 通常用于说明名称中的前导字符`_`或尾随`NUL`字符。

# c# - 在asp.net mvc 3中使用ajax发送一组json对象以执行操作

> ID：10141425
> 
> 赞同：3
> 
> 时间：2012-04-13T13:06:50.043
> 
> 标签：c#, jquery, asp.net-mvc, asp.net-mvc-3, razor

我希望任何人都可以帮助我（对不起我的英语）。当我想在 ajax 中发送数组数组时遇到问题。我的模型是：

```
public class SJSonModel
{
    public string Name { get; set; }
    public bool isChecked { get; set; }     
}

public class SJSonModelList
{
    public List<SJSonModel> Features { get; set; }
    public List<SJSonModel> MenuItems { get; set; }
} 
```

控制器：

```
 [HttpPost]
    public ActionResult CheckPreferences(SJSonModelList postData)
    {
        BindUserFeatures(postData.Features);

        return Json(new { status = "Success", message = "Passed" });
    } 
```

视图简化：

```
<div class="Feature borderRadius Items">
    <h2>Title
        <input type="checkbox" class="Item" name="featureName"/>
    </h2> 

   <div class="FeatureDetails subItems">                 
        <a href="@Url…">featureName</a>
        <input type="checkbox" class="subItem" name="subItemName"/>
   </div> <!-- endOf FeatureDetails --> 
```

jQuery 代码：

```
 var isChecked = false;
    var features = new Array();
    var menuItems = new Array();
    var postData = new Array(); 
```

在这里，我使用 featureName/menuItemName 和 isChecked boolean 填充功能，menuItems 每个功能/menuItem

```
menuItems.push({ "Name": $(this).attr('name'), "isChecked": isChecked });
features.push({ "Name": $(this).attr('name'), "isChecked": isChecked });

postData.push({ "features": features, "menuItems": menuItems });
postData = JSON.stringify(postData); 
```

ajax函数：

```
 $(':submit').click(function () {

        postData.push({ "features": features, "menuItems": menuItems });
        postData = JSON.stringify(postData);

        $.ajax({
                 url: '@Url.Action("CheckPreferences")',
                 type: 'POST',
                 data: postData, 
                 contentType: "application/json; charset=utf-8",
                 dataType: "json",
                 traditional: true,
                 success: function () { window.alert('@Resource.AjaxSuccess'); },
                 error: function (event, request, settings) {  window.alert('@Resource.AjaxError' + ' : ' + settings); },
                 timeout: 20000
        }); //endOf $.ajax
    }); //endOf :submit.click function 
```

当我执行警报（postData）时，在客户端它包含每个项目的真实值，但在控制器中 postData.Features 和 postData.MenuItems 为空。

我也尝试将一个数组传递给控制器​​：

```
 features = JSON.stringify(features); 
```

在 $.ajax 中：

```
{… data: features,…} 
```

在控制器中：

```
 ActionResult CheckPreferences(IEnumerable<SJSonModel> features) 
```

它工作正常，但我不知道如何将 json 对象数组传递给我的控制器。所以我希望在这里找回答案:)

非常感谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-13T14:23:12.253

最好将它们作为单独的参数发送到操作方法，而不是将您的数组组合到另一个数组中，例如：

假设我们仍然有你的两个数组：

```
var features = new Array();
var menuItems = new Array();
menuItems.push({ "Name": $(this).attr('name'), "isChecked": isChecked });
features.push({ "Name": $(this).attr('name'), "isChecked": isChecked }); 
```

然后在您的 JQuery ajax 调用中执行以下操作：

```
$.ajax({
        url: '@Url.Action("CheckPreferences")',
        type: 'POST',
        datatype: "json",
        traditional: true,
        data: { 
            menuItems: JSON.stringify(menuItems),
            features: JSON.stringify(features)
        },
        success: function () { window.alert('@Resource.AjaxSuccess'); },
        error: function (event, request, settings) {  
            window.alert('@Resource.AjaxError' + ' : ' + settings); },
        timeout: 20000
}); 
```

那么你的控制器方法应该是：

```
[HttpPost]
public ActionResult CheckPreferences(string menuItems, string features)
{
    var js = new JavaScriptSerializer();
    var deserializedMenuItems = (object[])js.DeserializeObject(menuItems);
    var deserializedFeatures = (object[])js.DeserializeObject(features);
    var myFeatures = new List<SJSonModel>();
    var myMenuItems = new List<SJSonModel>();

    if (deserializedFeatures != null)
    {
        foreach (Dictionary<string, object> newFeature in deserializedFeatures)
        {
            myFeatures.Add(new SJSonModel(newFeature));
        }
    }

    if (deserializedMenuItems != null)
    {
        foreach (Dictionary<string, object> newMenuItem in deserializedMenuItems)
        {
            myMenuItems.Add(new SJSonModel(newMenuItem));
        }
    }

    var myModelList = new SJSonModelList(myFeatures, myMenuItems);

    return Json(""); 
```

我还通过放入构造函数来编辑您的类以使用上述代码，如下所示：

```
public class SJSonModel
{
    public SJSonModel(Dictionary<string, object> newFeature)
    {
        if (newFeature.ContainsKey("Name"))
        {
            Name = (string)newFeature["Name"];
        }
        if (newFeature.ContainsKey("isChecked"))
        {
            isChecked = bool.Parse((string)newFeature["isChecked"]);
        }
    }

    public string Name { get; set; }
    public bool isChecked { get; set; }
}

public class SJSonModelList
{
    public SJSonModelList(List<SJSonModel> features, List<SJSonModel> menuItems )
    {
        Features = features;
        MenuItems = menuItems;
    }

    public List<SJSonModel> Features { get; set; }
    public List<SJSonModel> MenuItems { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T14:18:17.000

由于您从客户端传递序列化数据，因此在控制器中将 postData 定义为类型字符串，然后使用 JavascriptSerializer.Deserialize 将 JSON 反序列化到您的对象中。这样，您还可以捕获反序列化期间可能发生的任何错误并调试发送过来的 JSON。我不确定的一件事是反序列化器是否希望在区分大小写的情况下匹配字段名称。您将模型中的数组定义为“Features”和“MenuItems”，而在 Javascript 中将它们定义为“features”和“menuItems”。

# c# - linq 按月份名称和年份排序（MMM yyyy 字符串）

> ID：10141428
> 
> 赞同：4
> 
> 时间：2012-04-13T13:07:05.490
> 
> 标签：c#, asp.net, linq

我如何在 linq 中按月份名称和年份排序，它目前按字母顺序排序，这在显示报告时会导致问题

我正在寻找 2011 年 11 月、2011 年 12 月、2012 年 1 月、2012 年 2 月

我主要关心的是结果 MonthList 因为它是monthlist1 和monthlist2 之间的联合

感谢您的帮助和洞察力

```
var monthlist1 = data.
    Select(x => new { wkdate = x.WKENDDATE }).
    OrderBy(y => y.wkdate).
    Select(m => new { 
        monthname = m.wkdate.ToString("MMM yyyy", 
                                      CultureInfo.CreateSpecificCulture("en-US")) 
        }).
    Distinct().
    ToList();

var monthlist2 =
    data.Select(x => new { wkdate = 
          ExportHelper.getSplitEndDate(x.WKENDDATE).AddDays(1)})
         .OrderBy(y => y.wkdate)
         .Where(l => ExportHelper.isSplitWeek(l.wkdate.AddDays(-6), l.wkdate) == true)
         .Select(m => new { 
                   monthname = m.wkdate.ToString("MMM yyyy", 
                   CultureInfo.CreateSpecificCulture("en-US")) 
               })
              .Distinct()
              .ToList();

var monthlist = 
    monthlist1.
    Union(monthlist2).
    Distinct().
    OrderBy(m=> m.monthname).
    ToList(); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-13T13:21:11.367

它按字母顺序排序，因为它`wkdate`是一个`String`值而不是一个`DateTime`. 你需要先解析它：

```
var monthlist = monthlist1.Union(monthlist2)
    .Distinct()
    // monthname is a String in format MMM yyyy
    .OrderBy(m => DateTime.Parse(m.monthname))
    .ToList(); 
```

我假设由于您当前的`wkdate`值遵循`MMM yyyy`（例如`Apr 2012`）格式，它们都会**正确**解析。这是一个大胆的假设，我知道。

您还必须将值重新格式化`String`为最终结果的表示形式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T13:23:55.960

类似的东西

```
var monthlist1 = data.Select(m => new DateTime(m.WKENDDATE.Year,
                                                 m.WKENDDATE.Month,
                                                 1);

var monthlist2a = 
    data.Select(x => 
        new { wkdate = ExportHelper.getSplitEndDate(x.WKENDDATE).AddDay(1)})
    .Where(l => 
        ExportHelper.isSplitWeek(l.wkdate.AddDays(-6), l.wkdate) == true);

var monthlist2b = monthlist2a.Select(m => new DateTime(m.WKENDDATE.Year,
                                                 m.WKENDDATE.Month,
                                                 1);

var monthlist = monthlist1.Union(monthlist2b).Distinct()
                 .OrderBy(m => (m.Year * 100) + m.Month)
                 .Select(m => 
        m.ToString("MMM yyyy", CultureInfo.CreateSpecificCulture("en-US")); 
```

这样可以避免不必要的格式化和解析

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T13:21:07.480

```
var monthlist1 = data.
    Select(x => new { wkdate = x.WKENDDATE }).
    OrderBy(x=> CultureInfo.CurrentCulture.DateTimeFormat.GetMonthName(x.Month)).
    ThenBy(x=> x.Year).
    Select(m => new { 
        monthname = m.wkdate.ToString("MMM yyyy", 
                                      CultureInfo.CreateSpecificCulture("en-US")) 
        }).
    Distinct().
    ToList(); 
```

# java - 客户端服务器应用程序。始终打开的套接字

> ID：10141431
> 
> 赞同：0
> 
> 时间：2012-04-13T13:07:12.053
> 
> 标签：java, c++, sockets, client-server

我有客户端服务器应用程序 - C++ 上的客户端（在 AIX 上运行，使用 library ）和 Java 上的服务器（在 Win 和 AIX 上运行，使用 java.net. *， java.io.*）。应用程序的结构是下一个
**服务器**

```
//...
while (true)
         {
            final Socket s = ss.accept();
            pool.execute(new Service(s));
         }
// .. 
```

**Service.class**从输入流中获取字节并将字节发送到 otputstream。*并关闭 Socket s*

**克莱特** 是

```
SendMessage(msg)
{ 
// ...
   const int socketFD = OpenSocket();
// send bytes
// receive bytes
    close(socketFD);
} 
```

接下来的问题是：我可以在客户端打开套接字，发送消息，接收消息，并在一段时间后发送新消息并接收新消息。没有重新打开套接字？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T13:33:09.083

你当然可以。但是，服务器应该理解预期的消息不止一条，并且在客户端关闭连接之前不应终止服务。您的实现的问题在于 Service 是 Runnable 而不是 Thread。如果它会在接收消息时循环，它将保持它正在运行的线程。如果您使用 FixedThreadPool，这可能会导致所有池线程都用尽并且下一个服务将等待直到前一个客户端断开连接。使用 CachedThreadPool 可以避免这种情况，但结果是使用的线程数等于客户端数。如果您有足够的主内存（每个线程大约使用 0.5 Mb），这不是问题。如果要节省内存，可以使用 Apache Netty 等异步网络库。Java 7 实现了异步通道。

[https://github.com/rfqu/df4j](https://github.com/rfqu/df4j)是一个轻量级的数据流库，它包括一个对 Java7 异步网络设施的包装器，使它们更易于使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T13:18:59.337

是的，当然。除了 HTTP，大多数协议都使用持久连接（SMTP、POP3、FTP、ICQ ......）

# java - urllib2 从启动的 Web 服务返回 HTTP 404

> ID：10141438
> 
> 赞同：0
> 
> 时间：2012-04-13T13:07:31.137
> 
> 标签：java, python, web-services

我有一个提供一些数据的 Spring 3 Web 服务。它可以在 Firefox 中完美运行，但是当我尝试使用 urllib2 通过简单的 Python 脚本访问它时，我始终返回 HTTP 404。

无论我是在 Eclipse 下通过 Tomcat 运行 Web 服务，还是将 Tomcat 作为 Windows 服务运行，都会发生这种情况。

我唯一能想到的（这似乎仍然不太可能）是关于 Web 服务的某些事情（在引擎盖下）对 urllib2 用户代理字符串不满意......

谁能给我一些关于下一步尝试的想法？

谢谢，

米奇

这是代码的简化版本，然后是屏幕输出：

```
import sys
import urllib2
import urllib
import datetime
import time
import httplib
from datetime import timedelta

url = 'http://localhost:8086/OamDataWebService/oamdatawebservice/oamdata5    /SYRC01TAMP20/1334127600000/1334131199000'

handler=urllib2.HTTPHandler(debuglevel=1)
opener = urllib2.build_opener(handler)
urllib2.install_opener(opener)

req = urllib2.Request(url=url)
req.add_header('Content-Type', 'text/xml')

try:
        resp = urllib2.urlopen(req)
except urllib2.HTTPError, e:
        print "ERROR: caught HTTPError exception"
        print "HTTP error code:", e.code
        print e.read()
        sys.exit(1)

content = resp.read()

print content 
```

$ python test.py send: 'GET /OamDataWebService/oamdatawebservice/oamdata5/SYRC01TAMP20/1334127600000/1334131199000 HTTP/1.1\r\nAccept-Encoding: identity\r\nHost: tbdivb2400 2.corp.local:8086\r\nContent-类型：text/xml\r\n连接：关闭\r\n用户代理：Python-urllib/2.7\r\n\r\n' 回复：'HTTP/1.1 404 Not Found\r\n' 标头：服务器： Apache-Coyote/1.1 标头：内容类型：文本/html；charset=utf-8 标头：内容长度：952 标头：日期：2012 年 4 月 13 日星期五 13:56:28 格林威治标准时间标头：连接：关闭错误：捕获HTTPError 异常 HTTP 错误代码：404 Apache Tomcat/6.0.35 - 错误报告

# HTTP 状态 404 -

**类型**状态报告

> **信息**
> 
> **描述**请求的资源 () 不可用。
> 
> ### Apache Tomcat/6.0 .35

我认为问题出在我的 Spring Controller 配置中，但我仍然不明白为什么它以一种方式如此一致地工作，而不是来自 Python。我现在从 Chrome 运行，我相信我正在发送同样的东西。

当我通过 urllib 发送请求时，我的 Tomcat 日志显示以下内容：

2012-04-13 14:31:26,782 警告 org.springframework.web.servlet.PageNotFound.handleNoSuchRequestHandlingMethod:142 - 未找到 servlet 请求的匹配处理程序方法：路径 '/oamdata5/SYRC01TAMP20/1334127600000/1334131199000'，方法 'GET' , 参数映射[[empty]]

我的 Spring web.xml servlet 映射是：

```
<servlet-mapping>
    <servlet-name>spring</servlet-name>
    <url-pattern>/</url-pattern>
</servlet-mapping> 
```

我的 RequestMapping 条目是：

```
@RequestMapping(value = "/{interval}/{serviceId}/{startTime}/{endTime}", 
    method = RequestMethod.GET, 
    headers="Accept=application/xml, application/json") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T14:15:21.197

您的演示代码在 oamdata5 之后的 URL 中包含一些空格。那是对的吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T13:12:50.323

只需将用户代理设置为 Firefox。

```
headers = {"User-agent": "Mozilla/5.0"}
request = urllib2.Request(url, None, headers)
result = urllib2.urlopen(request)
html = result.read() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T13:14:02.070

使用 Wireshark 捕获 urllib2 正在发送的请求。我想这样，您应该能够发现问题所在。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-13T13:14:04.080

是什么产生了 404？404 页面的实际内容是什么（他们经常解释问题所在）？你确定它是目标网站吗？有时过滤防火墙会拒绝不通过内部身份验证代理的传出 HTTP 连接。代码是否成功地从其他外部网站获取 HTTP 内容？

* * *

好的，因为服务器在同一台机器上，我们在 Tomcat 日志中收到错误，这不是防火墙问题。我的下一个建议是设置一个本地 HTTP 代理（参见例如[http://code.google.com/p/python-proxy/](http://code.google.com/p/python-proxy/)或[非常简单的 python HTTP 代理？](https://stackoverflow.com/questions/4412581/seriously-simple-python-http-proxy)）。然后更改您的网络浏览器配置以使用它。尽可能多地打开代理登录。从您的浏览器中获取页面，保存日志数据，然后尝试从您的 python 代码中获取数据（已更新它以使用代理）。您应该能够通过比较代理记录的数据找出关键差异。

# c# - 打开一个excel文件并添加单元格值

> ID：10141440
> 
> 赞同：1
> 
> 时间：2012-04-13T13:07:36.390
> 
> 标签：c#, excel, add, xlsx

我为我的项目使用 C# & Excel Intropt.dll

我想打开我的 xlsx 文件并向 Sheet1 中的所有单元格添加一个值（例如“1”）。

我怎样才能做到这一点？

像这样：

```
12   14    19    22

81   91    26    62 
```

结果：

```
13   15    20    23

82   92    27    63 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T13:11:25.113

您可以使用此代码段。Cells[1,1] 是左上角的第一个单元格。这将获得第一张纸，但您也可以按名称引用它们。

```
Excel.Application xlApp;
Excel.Workbook xlWorkBook;
Excel.Worksheet xlWorkSheet;
object misValue = System.Reflection.Missing.Value;

xlApp = new Excel.ApplicationClass();
xlWorkBook = xlApp.Workbooks.Open(_filename, 0, true, 5, "", "", true, Excel.XlPlatform.xlWindows, "\t", false, false, 0, true, 1, 0);
xlWorkSheet = (Excel.Worksheet)xlWorkBook.Worksheets.get_Item(1);

//You can loop through all cells and use i and j to get the cells
xlWorkSheet.Cells[1,1].Value2 = Convert.ToInt32(xlWorkSheet.Cells[1,1].Value2) + 1;

xlWorkBook.Close(false, misValue, misValue);
xlApp.Quit(); 
```

# javascript - 禁用浏览器页面的特定事件

> ID：10141441
> 
> 赞同：3
> 
> 时间：2012-04-13T13:07:38.577
> 
> 标签：javascript, performance, profiling, dom-events

我的目标是在给定页面中找到 Javascript 事件瓶颈，无论是点击、聚焦文本字段还是类似的东西。

我非常相信有一些巧妙的方法可以做到这一点，尽管我不认为它是跨浏览器的。但在这一点上，什么浏览器供应商允许我做这样的事情对我来说并不重要。

所以，我需要一种方法，例如，禁用所有特定的事件回调被调用。所以，我需要防止任何点击事件被触发的能力。这在那些体面的浏览器（Chrome、Firefox、Safari、Opera）上是否可行？因为拥有它会给我一种方法来隔离什么事件类型和什么事件回调是瓶颈的来源。

在有人建议我使用 Chrome 开发人员工具中的脚本选项卡来设置事件侦听器断点之前，我已经发现单击特定文本字段似乎是问题所在（它会触发 4 次单击回调，显然有很多那里的事件委托），但我想在浏览器级别禁用点击事件，以检查我是否真的在正确的路径上精确定位瓶颈罪魁祸首。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T13:24:52.067

我认为没有任何优雅的方法可以做到这一点，一种方法是编写一些代码来获取所有元素并将所有事件绑定设置为 null

```
var events = 'click change focus'.split(' '), // add more as needed
    eLen = events.length,
    eI = 0,
    els = document.getElementsByTagName('*'),
    len = els.length,
    i = 0,
    el;

for (; i < len; i++) {
    el = els[i];
    for (eI = 0; eI < eLen; eI++) {
        el['on' + events[eI]] = null;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T13:37:49.607

我要解决这个问题的方法是根据一些全局变量内容短路附加这些事件的函数。

几乎每个 js lib 都将事件处理程序包装在一个函数中，如果设置了某个变量，您所要做的就是添加一些代码来跳过调用实际的侦听器。

IE

```
var DO_NOT_FIRE = ['click', 'change']; 
```

在被包裹的监听器内部：

```
// I'll just assume Array.prototype.indexOf is present for the sake of clarity
if(DO_NOT_FIRE.indexOf(eventType) == -1)
{
    originalListener.call(_this, evt);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T14:10:58.907

我[**在 jsfiddler 上制作了一个示例，它可以满足**](http://jsfiddle.net/schawaska/StpkW/)您的需求..您可以将其扩展到其他类型的事件.. 不像詹姆斯邦德那样优雅，但可以解决问题

本质上，我正在检查所有分配有事件的元素，并检查它们是否有点击事件（仅检查一个，因此`[...].click[0]`）并使用该`unbind`函数

```
// some elements that I'll bind a click event handler through jquery
<input type="button" id="btn1" value="click 1" />
<input type="button" id="btn2" value="click 2" />
<input type="button" id="btn3" value="click 3" />​

// bind all buttons to some fake click handler
var btn_Click = function(e) {
    alert("clicked button " + $(this).attr("id")); 
};

$("input[type='button']").on("click", btn_Click);

// defining which events to block
var events_to_block = ['click'];

// filtering and unbinding the handler for click 

var x = document.getElementsByTagName("*");
$(x).each(function() {
    var x_events = $.data(this, 'events' );
    if(x_events !== undefined) { 
        if(-1 != events_to_block.indexOf("click")) {
            if((x_events.click !== undefined) && (x_events.click !== null)) {
                if($(this).attr("id") !== "btn2") {
                   $(this).unbind("click", x_events.click[0].handler);
                }
            }
        }
    }
}); 
```

**PS**：我故意“允许”第二个按钮（`btn2`）来保持事件只是为了演示

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-13T13:28:27.620

我认为这个链接解决了你的问题：

[jQuery：在所有点击事件发生之前捕获它们？](https://stackoverflow.com/questions/6157486/jquery-trap-all-click-events-before-they-happen)

```
document.addEventListener('click', function(e) {
    e.stopPropagation();
}, true); 
```

我认为这是要走的路

# database-design - 设计具有两个与用户相关的属性的 Product 实体

> ID：10141445
> 
> 赞同：0
> 
> 时间：2012-04-13T13:08:04.507
> 
> 标签：database-design

我的域中有一个产品实体和两个属性 IsFavorite 和 IsHidden。

每个用户可以选择一些要收藏、隐藏或以前没有的产品。

我必须为用户提供一个产品列表，其中不包含“标记为隐藏”的产品，并且在每个最喜欢的产品附近都有一个“星号”。

在我的脑海中想出一张带有两个表“Product”和“Product_User”的图片

“Product_User”模式可以是：ProductId、UserId、IsFavorite、IsHidden、

这是对的吗？

在查询期间，我必须查询不包括隐藏产品的 Product 表（所以我必须先查询 Product_User 表），然后标记每个喜欢的产品。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T13:36:14.503

当你做 DDD 时，没有模式或表之类的东西，因为没有数据库。只有域模型为特定的有界上下文建模问题。

我认为您的问题显然是关于 db 模式的，因为在域级别，您可以拥有 BoughtProduct 对象的 ProductImpression（不是最好的名称）属性，该对象是 BoughtProductsCollection 对象的一部分。当然，这些是基于疯狂猜测的建议，因为我不知道有关该域的很多细节。

作为一个模式，我会说一些类似于你想的东西。包含以下列的表：Id、ProductId、UserId、ProductImpression。

此架构的好处是您可以在将来添加更多状态，而无需更改架构。

# ruby - 更新新 ruby 版本时出现问题

> ID：10141446
> 
> 赞同：0
> 
> 时间：2012-04-13T13:08:06.657
> 
> 标签：ruby, installation, rvm, patch

我试图在我的 Mac 上安装一个带有 rvm 的新 ruby​​ 版本。为什么我选择重新安装所有东西有几个问题。

红宝石有两个版本。

1.  Mac 内部红宝石 -> 1.8.*
2.  用户版本 -> 1.9.1（需要 >= 1.9.2）

可以使用“sudo rvm install ...”在本地mac版本上安装新版本但是当我用我的用户版本尝试时，会出现这个错误：

```
stvn$ rvm install 1.9.2

info: Installing Ruby from source to: /Users/stvn/.rvm/rubies/ruby-1.9.2-p0
info: Downloading ruby-1.9.2-p0, this may take a while depending on your connection...
% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                               Dload  Upload   Total   Spent    Left  Speed
100 8296k  100 8296k    0       139k      0  0:00:59  0:00:59   --:--:--  102k

info: Extracting ruby-1.9.2-p0 ...
info: Applying patch '' (located at /)

error: Error running 'patch -F25 -p1 -f <"/"', please check /Users/stevenklar/.rvm/log/ruby-1.9.2-p0/patch.apply.*.log

fail: There has been an error applying the specified patches. Aborting the installation. 
```

已经尝试过在 stackoverflow 和 google 中发布的几种解决方案。还没有任何效果。这些错误似乎与unvail有关。小路。表示 rvm 使用 '' 作为路径，而不是例如 '/Users/stvn/.rvm/...'

有人知道如何解决吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T13:18:10.427

“在本地Mac版本上安装新版本”是什么意思？

老实说，我刚刚删除了我提供的 ruby​​ 版本并安装了 rvm。

此外，您应该始终使用`rvmsudo`，而不是`sudo rvm`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T17:40:15.680

您有两个版本的 RVM，一个在系统中（1.12.2 - 几乎是新的），一个在用户主页中（1.0.2 - 古老）。

由于建议用户安装，您应该删除所有内容并重新开始：

```
sudo rm -rf /usr/local/rvm /etc/rvmrc /etc/profile.d/rvm.sh ~/.rvm* 
```

打开新终端并确保环境中没有 rvm：

```
env | grep rvm 
```

输出应该是空的，如果不是重启电脑，

最后以用户身份运行安装程序，无需 sudo：

```
curl -L get.rvm.io | bash -s stable --auto 
```

你也可以在引导模式下安装，要求 ruby​​ 1.9.2：

```
curl -L get.rvm.io | bash -s stable --auto --ruby=1.9.2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T13:22:15.073

`sudo install patch`

请查看此帖子，并按照所有说明进行操作：

[Ruby 安装问题](https://stackoverflow.com/questions/10060498/ruby-installation-problems/10060697#10060697)

安装所需的所有软件包。

rvm 也不需要 sudo

# java - 如何拒绝客户端解绑RMI Registry？

> ID：10141457
> 
> 赞同：0
> 
> 时间：2012-04-13T13:09:04.037
> 
> 标签：java, rmi, rmiregistry

我编写了一个简单的 RMI 应用程序。我发现客户端获取RMI-Registry后可以成功执行Registry.unbind()方法。在我看来，这是一个安全风险。为什么允许客户端取消绑定远程注册表中的名称？邪恶的人可以通过修改代码来做到这一点，而我的所有其他客户端都无法连接到我的服务器，因为绑定已被删除。

是否有可能否认这一点，也许在 Java 政策中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T09:36:57.200

仅当客户端与注册表在同一主机上运行时，才会发生这种情况。如果您自己的客户遇到安全问题，那么您遇到的问题比 RMI 可以为您解决的任何问题都要大得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T14:39:23.777

来自注册表的[Javadoc](http://docs.oracle.com/javase/6/docs/api/java/rmi/registry/Registry.html)：

> Registry 实现可以选择限制对其部分或全部方法的访问（例如，改变注册表绑定的方法可能仅限于来自本地主机的调用）。如果 Registry 方法选择拒绝对给定调用的访问，则它的实现可能会抛出 AccessException，它（因为它扩展 RemoteException）在被远程客户端捕获时将被包装在 ServerException 中。

如果您愿意，您可以选择阻止这种行为（它实际上是大多数注册表实现的默认行为）。

# cryptography - 为 DCPU-16 编写流密码，鉴于它的局限性，我应该关注哪个？

> ID：10141463
> 
> 赞同：1
> 
> 时间：2012-04-13T13:09:37.763
> 
> 标签：cryptography, dcpu-16, stream-cipher

为了好玩，我正在为[DCPU-16](http://0x10c.com/doc/dcpu-16.txt)（游戏[0x10 ^c](http://0x10c.com/)的虚构 CPU ）编写流密码。该处理器只有 16 位寄存器，运行频率为 100 Khz。但是，就目前而言，内存访问以及诸如乘法和除法之类的东西非常快（`DIV`使用两次间接内存访问的 A 只需要 5 个周期）。

有了这些限制，我最好的选择是什么？我正在考虑 RC4，但是我担心使用我的代码的其他人无法正确使用它，我们可能会遇到另一场 WEP 灾难。我觉得我需要做一些比 RC4 更复杂的事情来保护其他程序员免受他们自己的伤害，但是我担心使用幻数或预计算表的算法，这些表期望 8 位字节作为最小单位而不是 16 位字。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T16:46:51.610

> “但是我担心其他人使用我的代码不会正确使用它，我们可能会遇到另一场 WEP 灾难”

任何密码都是如此 - RC4 应该可以正常工作。

您可能还想查看[eStream](http://en.wikipedia.org/wiki/ESTREAM)密码。特别是，[Grain](http://en.wikipedia.org/wiki/Grain_%28cipher%29)声称*“专为受限硬件环境而设计”。* 不过，我没有这方面的经验，所以我不知道在软件中实现它有多容易。

# c# - 永远使用 ClickOnce 发布建筑

> ID：10141474
> 
> 赞同：1
> 
> 时间：2012-04-13T13:10:40.450
> 
> 标签：c#, clickonce, signtool

我们使用 Click once 技术来发布我们的应用程序。最近，当尝试执行相同操作时，当勾选 Sign Click once 清单时，应用程序将永远阻塞。但是，如果要对它进行统一标记，或者如果应用程序要在带有网络提示的安全模式下发布，则发布构建过程不会挂起。另一方面，如果应用程序在启用标志清单的正常模式下运行，则应用程序总是在发布构建过程中停止。

注意：使用的证书未过期使用命令行上的签名工具可以完美运行。我还修复了 VS 2010。从任务管理器结束 Signtool 进程使应用程序再次处于活动状态

请帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T13:39:48.803

我的猜测是它正在尝试联系时间戳服务器并失败。在发布时运行[Fiddler](http://www.fiddler2.com/fiddler2/)，看看是否可以看到任何失败的 http 调用。至于它*为什么*失败，我不知道，但希望它能给你一个起点。

时间戳服务对清单进行标记，以便当应用程序的证书过期时，客户端可以在证书仍然有效的情况下验证它是否已签名。

# javascript - 通过单击模态 iframe 关闭对话框？

> ID：10141478
> 
> 赞同：0
> 
> 时间：2012-04-13T13:10:45.457
> 
> 标签：javascript, jquery, iframe, dialog, modal-dialog

我正在创建一个模式对话框。首先，我将 iframe 附加到`body`标签以充当我的叠加层。

```
<div class="modal-screen">
  <iframe src="javascript:false;"></iframe>
</div> 
```

然后我将我的对话框附加到`body`.

```
<div class="dialog">
  <!-- various dialog related elements
</div> 
```

现在我想在用户单击覆盖时关闭对话框。问题是我似乎无法绑定到与覆盖相关的任何事件。

总结一下我的 JS，基本上我的对话框视图有一个`initialize`准备覆盖的方法：

```
initialize: function() {
  this.modal = $('<div class="modal-screen"><iframe src="javascript:false;"></iframe></div>')

  this.modal.on('click', function(e) {
    // this event never seems to fire
    console.log("hello");
  }
} 
```

然后我在需要时渲染到页面中。当我单击叠加层时，我从来没有看到`hello`..

```
render: function() {
  $('body').append(this.modal);
  // append other dialog content
  this
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T13:16:15.453

this.modal 不是单个元素，而是一个 DOM 对象，这就是为什么你不能在其上绑定任何东西的原因。尝试绑定 $('.modal-screen', this.modal) 代替。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T13:27:36.477

没有理由在这里使用 iframe。只需构造一个[覆盖 div](http://raventools.com/blog/create-a-modal-dialog-using-css-and-javascript/)，然后在单击时将其删除。

# html - 扫描网页以获取 API

> ID：10141485
> 
> 赞同：1
> 
> 时间：2012-04-13T13:11:03.040
> 
> 标签：html, api

我想对网页进行扫描，并以某种方式发现该站点是否提供了某种 API——XML 或 JSON。

例如，带有电视节目表的网页。我想扫描 example.com 并找出它是否提供了某种带有电视时间表的 API。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T13:14:18.903

据我所知，这是**不可能的**。

我建议寻找 RSS 或 Atom 提要。您还可以联系支持人员，或查找 example.com 提供的有关任何 API 的文档。

**底线：**如果他们想让你了解他们的 API，他们会通过提供文档、链接、Wiki 等来告诉你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T13:28:04.230

我*认为*这是**不可能**的。

我知道的大多数网站甚至都不引用 API（RSS/Atom 除外）。

`<head>`您可以在网页的 中找到 Atom 和 RSS 提要。

如果它只是您想要查找其 API 的*一个网站，那么您可以直接联系该网站而不是使用脚本或其他东西。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-15T08:33:03.270

没有标准方法 - 但是如果页面上有一个 API 用于驱动 Ajax 视图，那么您很可能能够从页面上引用的 Javascript 分析中获取一些信息 - 它通常会指向回到 API。

不用说，它很可能不是一个“受支持的”API，并且您使用它会违反使用条款 - 因此它可能会在不通知的情况下被删除/更改/阻止。

# javascript - javascript 中的作用域（为什么 $.post() 方法数组的作用域是本地的？）

> ID：10141493
> 
> 赞同：0
> 
> 时间：2012-04-13T13:12:03.677
> 
> 标签：javascript, jquery

```
externalCSSContents = [];

function getExternalCSSContents(){
        href = document.styleSheets[0].href;
        $.post(href, function(result){
            externalCSSContents.push(result);
            alert(externalCSSContents.length); // 1
        });
}

getExternalCSSContents();
alert(externalCSSContents.length); // 0 
```

有人可以向我解释为什么在 $.post() 方法数组 externalCSSContents 的范围内是本地的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T13:13:58.140

[AJAX](http://en.wikipedia.org/wiki/Ajax_%28programming%29)是异步的，在警报之后执行 post 回调

（我今天在这里打了很多次“异步”，现在我知道如何拼写了）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T13:14:04.597

那是因为 ajax 请求尚未完成执行，而您正在提醒数组的内容。

你可以这样做。

```
function getExternalCSSContents(){
    href = document.styleSheets[0].href;
    return  $.post(href, function(result){ externalCSSContents.push(result); });
}

$.when( getExternalCSSContents() ).then(function(){ 
        alert(externalCSSContents.length);
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-13T13:14:05.580

这是因为异步请求。这就是 AJAX 的工作原理。例如，在[Wiki](http://en.wikipedia.org/wiki/Ajax_%28programming%29)上阅读有关 ajax 的更多信息

# oracle - 基于 Oracle 函数的索引

> ID：10141498
> 
> 赞同：2
> 
> 时间：2012-04-13T13:12:35.783
> 
> 标签：oracle, indexing

也许是一个愚蠢的问题，但使用基于函数的索引是否安全。我的意思是，当列更改时，索引会立即更改吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-13T13:23:34.810

假设它们设置正确，是的。

概述：Oracle 在具有基于函数的索引的表上创建一个隐藏列，每次更改基于函数的索引的列时都会更新该索引；假设这些值是确定性的（有关更多信息，请参见 oracle 链接）。您可以通过查询系统对象 all_tab_cols 您的表来查看这些隐藏列，在该表上创建了基于函数的索引。它们通常包含 $ 并且看起来像 SYS_NC00005$。

当您想要处理区分大小写或处理重复的函数调用时，通常会使用它们，在这些函数调用上执行函数调用的开销如此之快，以至于计算一次并保留它的值会导致性能提升。

补充阅读：

*   [问汤姆](http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:667694821129)
*   [堆栈溢出](https://stackoverflow.com/questions/177240/how-to-use-a-function-based-index-on-a-column-that-contains-nulls-in-oracle-10)
*   [甲骨文](http://docs.oracle.com/cd/B19306_01/server.102/b14231/indexes.htm#i1006674)

# sql - 在 SQL 中指定最小连接点数

> ID：10141500
> 
> 赞同：2
> 
> 时间：2012-04-13T13:12:41.227
> 
> 标签：sql, sql-server, sql-server-2008, tsql

我有这个加入表：

```
 CREATE TABLE [TagMap](
[intItemId] [bigint] NOT NULL,
[intTagId] [bigint] NOT NULL,
 CONSTRAINT [PK_TagMap_intItemId] PRIMARY KEY CLUSTERED 
 (
[intItemId] ASC,
[intTagId] ASC
 )) 
```

我的 sproc 发现与 seedItemId 关联的标签，然后选择与这些标签关联的其他 intItemId，如下所示：

```
 declare @baseTags table    (intTagId bigint primary key clustered);

INSERT INTO @baseTags (intTagId)
SELECT TOP 20 t1.intTagId
FROM   TagMap t1
WHERE t1.intItemId = 776

 SELECT TOP 500 t1.intItemId
 FROM   TagMap t1
      JOIN @baseTags t2
       ON t1.intTagId = t2.intTagId
 GROUP  BY t1.intItemId
 ORDER  BY Count(*) DESC 
```

我需要做的是在两个 intItemIds 之间指定一个最小标签关联数 - 比如 10 - 低于该值不返回值。也就是说在TagMap 表中可以找到十个或更多的两个intItemIds 共有的intTagIds，这很好，我们选择它——否则忽略它。

因此，例如给定以下数据：

```
 CREATE TABLE #TagMap(
 [intItemId] [bigint] NOT NULL,
 [intTagId] [bigint] NOT NULL,
 CONSTRAINT [PK_TagMap_intItemId] PRIMARY KEY CLUSTERED 
 (
 [intItemId] ASC,
 [intTagId] ASC
 ))

 insert into #TagMap
 (intItemId, intTagId)
 values 
 (1, 100),(1, 200),(1, 300),
 (2, 100),(2, 200),         (2, 500),(2, 600),
 (3, 100),                  (3, 500),(3, 600) 
```

假设匹配阈值为二。

如果种子是 intItemId 1，则只应返回 intItemId 2（它有两个匹配的标签 Id：100 和 200，而 intItemId 3 有一个：100，低于阈值）。

如果种子是 intItemId 2，则应返回 intItemId 1 和 3（intItemId 1 匹配标签 ID 100 和 200，而 intItemId 3 匹配标签 ID 500 和 600）。

如果种子是 intItemId 3，则只应返回 intItemId 2（它有两个匹配的标签 ID：500 和 600，而 intItemId 有一个：100，低于阈值）。

请问有什么办法吗？

干杯，马特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T13:31:04.637

```
SELECT
  [foreign].intItemID
FROM
  #TagMap    AS [primary]
INNER JOIN
  #TagMap    AS [foreign]
    ON [foreign].intTagID = [primary].intTagID
WHERE
  [primary].intItemID = 1
GROUP BY
  [foreign].intItemID
HAVING
  COUNT(distinct [foreign].intTagID) >= @threshold 
```

但是请注意，这非常糟糕。因为`JOIN`搜索“具有这些标签中的***任何***一个”，然后只有在`HAVING`子句中才能指定“具有***所有***这些标签”。

根据我的经验，您可以进行一些小的优化，但我发现最有价值的方法是将结果缓存到更标准的映射表中。必要时更新它们。（标签数据的内容很少改变。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T13:37:33.977

这似乎可以做到（`@InterestItem`从 1、2、3 不等，它似乎产生了您要求的结果）：

```
declare @InterestItem int
set @InterestItem = 1
declare @Threshold int
set @Threshold = 2

select
    tm2.intItemId,
    COUNT(*)
from
    #TagMap tm1
        inner join
    #TagMap tm2
        on
            tm1.intTagId = tm2.intTagId and
            tm2.intItemId <> tm1.intItemId
where
    tm1.intItemId = @InterestItem
group by
    tm2.intItemId
having
    COUNT(*) >= @Threshold 
```

我目前将 包括`COUNT`在结果集中，但这并不是完成这项工作所必需的。

# java - 压缩java字符串（url）

> ID：10141501
> 
> 赞同：3
> 
> 时间：2012-04-13T13:12:46.250
> 
> 标签：java, string, url, compression, web-crawler

我有很多网址要处理。我将其中大约 20'000'000 个存储在哈希集中。这会造成一些记忆问题。

我试图创建一个压缩字符串类：

```
import java.io.*;//file writer
import java.util.*;
import java.util.zip.*;

class CompressedString2 implements Serializable{
    private int originalSize;
    private byte[] cstring;

    public CompressedString2 (){
        compress("");
    }

    public CompressedString2 (String string){
        compress(string);
    }

    public void compress(String str){
        try {
            byte[] bytes = str.getBytes("UTF-8");
            originalSize = bytes.length;

            ByteArrayOutputStream deflatedBytes = new ByteArrayOutputStream();
            DeflaterOutputStream dos = new DeflaterOutputStream(deflatedBytes,new Deflater(Deflater.DEFAULT_COMPRESSION));
            dos.write(bytes);
            dos.finish();
            cstring=deflatedBytes.toByteArray();
        }catch(Exception e){e.printStackTrace();}

    }

    public String decompress() throws Exception{
        String result="";
        try{
            ByteArrayOutputStream deflatedBytes=new ByteArrayOutputStream();
            deflatedBytes.write(cstring);
            deflatedBytes.close();

            InflaterInputStream iis = new InflaterInputStream(new ByteArrayInputStream(deflatedBytes.toByteArray()));
            byte[] inflatedBytes = new byte[originalSize];
            iis.read(inflatedBytes);
            result= new String(inflatedBytes, "UTF-8");
        }catch(Exception e){e.printStackTrace();}
        return result;
    }
} 
```

但事实上，当我用这样的东西存储它们时：

```
HashSet<String> urlStr=new HashSet<String>();
HashSet<CompressedString> urlComp=new HashSet<CompressedString>();

        String filePath=new String();

            filePath=args[0];

        int num=0;

        try{
            BufferedReader br = new BufferedReader(new FileReader(filePath));

            String line = br.readLine();
            while (line != null) {

                num++;
                urlStr.add(line);
                urlComp.add(new CompressedString(line));

            line = br.readLine();
            }
        } catch(Exception e){
        System.out.println("fehler..:");
            e.printStackTrace();
        }

ObjectOutputStream oos1 = new ObjectOutputStream(new FileOutputStream("testDeflator_rawurls.obj"));
oos1.writeObject(urlStr);
ObjectOutputStream oos4 = new ObjectOutputStream(new FileOutputStream("testDeflator_compressed2.obj"));
oos4.writeObject(urlComp); 
```

“压缩”的网址更大......

有人知道如何成功压缩网址吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-13T13:16:50.250

好吧，如果它们在一个集合中，那么您所能做的就是添加/删除/查找。您也可以在“字符森林”上执行这些操作，它可能是更紧凑的表示。我在想一棵节点树，每个节点都有一个角色，彼此链接。森林的根将包含“h”、“f”等。在“h”节点下将是一个“t”节点，在该节点下是另一个“t”，在该节点下是一个“p”，等等。“f”节点将有“t”和“i”子节点。最终树会分叉，但在根部附近可能会有很多共享。然后，您只需在森林中走一走，看看那里是否有 URL。

我想一个节点需要一个布尔成员来指示集合中的一个 URL 在那里终止，一个保存字符的成员，以及指向其他节点的链接数组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T14:12:24.723

您是否考虑过不同的方法？哈希集中的 2000 万个字符串非常多。您可以将它们存储在数据库中并从那里进行处理吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T13:38:55.353

例如，如果您的许多 url 有一个共同的基础，`http://www.mysite.com/`那么您应该考虑使用[Ropes](http://www.ibm.com/developerworks/library/j-ropes/)（[项目页面](http://ahmadsoft.org/ropes/)），以便每个字符串的第一部分表示一次。

另请参阅[此维基百科页面](http://en.wikipedia.org/wiki/Rope_%28computer_science%29)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-13T13:28:01.343

短字符串可能不会压缩到小于未压缩的字符串。您是否尝试过`-XX:+UseCompressedString`某些 Java 6 版本默认打开的选项。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-13T13:20:09.577

只是，一般来说，为了使压缩工作良好，字符串必须更长，因为它基于所述字符串中的模式工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-13T13:52:29.890

您可以使用 tinyurl 减少长度然后存储它。[您可以在此处](http://www.mularien.com/blog/2008/12/04/tutorial-accessing-the-tinyurl-api-from-java/)
找到指向小 URL 的 java 实用程序类

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-13T13:37:06.770

您可以一次压缩 n 个 URL，其中 n 可能是 10 到 100。这将使压缩器以重复字符串和倾斜字符概率分布的方式工作。缺点是每次访问都必须解压缩 10 到 100 个 URL。因此，实现这一点后，改变 n 以在内存使用和速度之间进行交易，并选择你喜欢的折衷方案。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-13T14:19:43.973

例如，将 100 个链接连接在一起（由特殊字符分隔）并尝试将它们压缩成一个 CompressedString 怎么样？压缩可能需要最小长度才能有效。CompressedString 类可以恢复集合中的 100 个字符串。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-07-17T19:10:35.937

由于包装类的额外开销，压缩 URL 不一定会为您节省任何内存。另一种方法是使用前缀映射来缩短 URL。但是，如果使用包装类，则必须实现`hashCode`and`equals`方法。没有它们，哈希集将无法按预期工作（允许重复）。对于`CompressedString2`这些可以实现为：

```
@Override
public int hashCode() {
    return Arrays.hashCode(cstring);
}

public boolean equals(Object other){
    if(other instanceof CompressedString){
        return Arrays.equals(cstring, ((CompressedString) other).cstring);
    }
    return false;
} 
```

另一个可以大大减少内存占用的方法是使用例如 Trove 的`THashSet`. 由于您知道 URL 的大致数量，您还可以增加负载因子并设置散列集的初始大小，这将为您节省大量重新散列并让您更有效地使用分配的空间。

# c# - 重定向前的时间延迟

> ID：10141504
> 
> 赞同：14
> 
> 时间：2012-04-13T13:12:53.440
> 
> 标签：c#, timedelay

我为我的 Web 应用程序创建了一个注册页面。应用程序要求用户注册成功后，页面会显示“注册成功”的信息，然后等待5秒再切换到登录页面。我用过`Thread.Sleep(5000)`。它等待 5 秒，但不显示消息。谁能帮我？

```
void AccountServiceRegisterCompleted(object sender, RegisterCompletedEventArgs e)
    {
        if (e.Result)
        {
            lblMessage.Text = "Register successfully";

            Thread.Sleep(5000); 
            this.SwitchPage(new Login());
        }
        else
        {
            ...
        }
    } 
```

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-04-13T13:34:13.727

`Thread.Sleep(5000)`仅将您的线程挂起 5 秒 - 在此期间不会执行此线程上的任何代码。所以没有消息或其他任何东西。

如果它是一个 ASP.NET 应用程序，客户端不知道服务器上发生了什么，并等待服务器响应 5 秒。您必须手动实现此逻辑。例如，使用 JavaScript：

```
setTimeout(function(){location.href = 'test.aspx';}, 5000); 
```

或通过添加 HTTP 标头：

```
Response.AddHeader("REFRESH","5;URL=test.aspx"); 
```

或`meta`标签：

```
<meta http-equiv="refresh" content="5; url=test.aspx" /> 
```

查看[更多信息](http://en.wikipedia.org/wiki/URL_redirection#Refresh_Meta_tag_and_HTTP_refresh_header)。

如果它是桌面应用程序，您可以使用[timers](http://msdn.microsoft.com/en-us/library/system.threading.timer.aspx)之类的东西。并且永远不要让主线程（UI 线程）挂起像 Thread.Sleep 这样的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-06T12:14:23.837

只有元标记足以重定向到另一个页面

动态广告元标记

`Response.AddHeader("REFRESH", "5;URL=~/account/login");`

此代码将向当前页面添加一个元标记，并且您的页面将在指定时间重定向到另一个页面，如上。

# facebook - 将我的电子商务商店与 FB 集成

> ID：10141507
> 
> 赞同：0
> 
> 时间：2012-04-13T13:13:13.643
> 
> 标签：facebook, e-commerce, integration, integrate

我有一家电子商务商店，想开始将其整合到 FB 中。有关已完成此操作的本地客户端的示例，请参见此处：http: [//apps.facebook.com/woolworthsstore/fbHome.jsp](http://apps.facebook.com/woolworthsstore/fbHome.jsp)

这是一个 iframe 吗？我该如何设置呢？

谢谢，德昂

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T19:01:45.130

是的，这是通过 iframe 提供的外部内容。您正在寻找设置 Facebook 页面选项卡应用程序。

[https://developers.facebook.com/docs/appsonfacebook/pagetabs/](https://developers.facebook.com/docs/appsonfacebook/pagetabs/)

# javascript - 如何在java脚本中打印这个哈希表数据

> ID：10141511
> 
> 赞同：-4
> 
> 时间：2012-04-13T13:13:19.030
> 
> 标签：javascript

如何在java脚本中打印这个哈希表数据

```
var product = {
    "prduct_name": "Mobile",
    "product_attribute": {
        "attribute_name": "Brand",
        "type": "combo",
        "product_attribute_values": {
            "attribute_value": "Apple",
            "brand_price": "2000"
        }
    }
}; 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-13T13:19:47.440

如果您的（或目标）浏览器具有可用的 JSON 对象（Internet Explorer 8+、Firefox 3.1+、Safari 4+、Chrome 3+ 和 Opera 10.5+ [Browser-native JSON support (window.JSON)](https://stackoverflow.com/questions/891299/browser-native-json-support-window-json) ），那么我建议作为快速发展溶胶。

`str = JSON.stringify(product);`

或者如果你想要这一切都很像：

`str = JSON.stringify(product, null, " ");`

然而，这可能不适合面向客户端的显示器！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T13:17:35.547

编辑为没有看到嵌套对象数据。

[http://jsfiddle.net/wYWQJ/](http://jsfiddle.net/wYWQJ/)

```
function printData(data) {
    var str = '';
    for (var key in data) {
        if (typeof data[key] == 'object') str += key + printData(data[key]) + ' ';
        else str += key + ' => ' + data[key] + ' ';
    }
    return str;
};

console.log(printData(product)); 
```

# jquery - JQuery UI Dialog dialog.('close'); 不工作

> ID：10141512
> 
> 赞同：0
> 
> 时间：2012-04-13T13:13:20.793
> 
> 标签：jquery, jquery-ui, jquery-ui-dialog

我有一个包含多个模态 jQuery UI 对话框的页面，我正在尝试在一个对话框（常见问题解答）上创建一个链接，该链接将关闭该对话框并打开另一个对话框（保修）。下面是相关代码：

```
var $faqIframe = $('<iframe />', {
                name: 'myFrame',
                id:   'myFrame',
                src: "modal_faq.html",
                width:"100%",
                height:"100%",
                align:"left",
                scrolling:"auto",
                frameborder:"0"
            }); 

var $warrantiesIframe = $('<iframe />', {
                name: 'myFrame1',
                id:   'myFrame1',
                src: "modal_warranties.html",
                width:"100%",
                height:"100%",
                align:"left",
                scrolling:"auto",
                frameborder:"0"
            }); 
```

然后，打开 faq iFrame

```
$(function(){
    $('#faqDialog').dialog({
        autoOpen: false,
        width: 780,
        height: 460,
        modal: true
    });

    $('#faqDialog').append($faqIframe.clone());

    // Dialog Link
    $('#faq_link, #faq_link1').click(function(){
        $('#faqDialog').dialog('open');

        return false;
    }); 
```

这工作正常，按预期打开对话框。我也有类似的保修对话框代码。这是当前不起作用的代码。#warranty_link2 是常见问题对话框上的一个链接，单击该链接时，我想触发关闭常见问题对话框。

```
 $('#warranty_link2').on("click", function(event){
        $('#faqDialog').dialog('close');
    });
} 
```

我努力了

```
$('#faqDialog').dialog('close');
$('#faqDialog').dialog('hide');
$('#faqDialog').dialog('destroy'); 
```

我也尝试过使用“live”而不是“on”，并且没有这两者中的任何一个也尝试使用 var $faqIframe 引用它，如

```
$faqIframe.dialog('close') 
```

没有结果。

我知道点击事件正在触发，因为我输入了一个有效的 console.log。

我做错了什么，如何关闭此对话框？

[在http://www.solarkit2go.com](http://www.solarkit2go.com)上查看它的实际操作- 单击常见问题解答链接

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T13:21:29.240

触发对话框后，您必须绑定 onclick 事件。见下文

```
$(function(){
   $('#faqDialog').dialog({
    autoOpen: false,
    width: 780,
    height: 460,
    modal: true
});

$('#faqDialog').append($faqIframe.clone());

// Dialog Link
$('#faq_link, #faq_link1').click(function(){
    $('#faqDialog').dialog('open');

    $('#warranty_link2').click(function(event){
        $('#faqDialog').dialog('close');
    });

    return false;
}); 
```

# debugging - 当 NaN 仅在使用优化编译时出现时，如何开始调试数字代码？

> ID：10141515
> 
> 赞同：1
> 
> 时间：2012-04-13T13:13:38.333
> 
> 标签：debugging, floating-point, compiler-optimization, scientific-computing, compiler-options

在以下情况下，开始调试数字代码的一般策略是什么：

*   使用积极优化标志编译的代码，在输出中产生偶尔的 NaN 和 Inf
*   `-g`用（这意味着）编译的代码`-O0`与调试器一起运行，不再产生 NaN 和 Inf 了？

在这种情况下，我使用的是 Portland Group C++ 编译器 pgCC，并使用了优化选项

`-w -fast -O3 -Mipa=fast -Mfprelaxed -Minline=levels:10`

然后就

`-w -g`

对于调试版本。但我相信类似的情况也可能发生`g++`。

编辑：添加打印语句不是一个非常诱人的选项，因为代码不是我写的，它有几千行大，我不知道缩小搜索范围；NaN 可能几乎来自任何地方。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T13:46:51.940

[我会尝试看看你是否可以启用像 done here 这样](https://stackoverflow.com/questions/235664/how-to-use-stdsignaling-nan)的浮点异常，然后看看是否有一些信号 nan 引发了异常。您的编译器中可能有一些编译器标志来启用这些异常。

除此之外，我会进行手动二进制搜索。也就是说，编写一个转储所有变量的函数。然后将程序分成两半，不是按代码行，而是按实际运行的内容，并将其隔离。换句话说，卷起袖子进去。

编辑：这可能不适用于您的情况，因为我给您的链接非常特定于 Win32。但也许它会给你一些线索。或者您可以在免费的 MS 编译器上尝试代码？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T14:14:07.737

Portland Group 编译器提供了一些伴随指令的选项 - `Mfprelaxed`; 我会尝试一个一个地设置这些，看看哪些会有所作为。您可能只想从编译中完全删除此指令。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-13T18:25:01.697

我想指出，在 g++ 的情况下，-g 标志不会抑制优化（也就是说，它并不意味着 -O0）。包含调试信息的优化可执行文件更难调试，但当然可以这样做。

# twisted - 在 Twisted 中，processExited 和 processEnded 有什么区别？

> ID：10141520
> 
> 赞同：8
> 
> 时间：2012-04-13T13:14:02.007
> 
> 标签：twisted

正如标题所说，ProcessProtocol 类上的这两个函数有什么区别？关于何时应该使用一个而不是另一个的文档有点稀疏？

最好，我正在寻找一些证明这一点的用例示例。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-13T16:48:45.910

我想在这一点上文档有些稀疏。如果不存在此类票证，请随时[提交票证](http://twistedmatrix.com/trac/newticket)以改进 API 文档。

`processExited`在正式流程管理意义上的流程*退出*时调用，即`exit()`从 . 调用或返回`main()`。

但是，这并不总是您想要的。有时，一个进程会产生一个子进程，交出它的标准输入和标准输出，委派负责产生您（在这种情况下是产生的父进程）想要的数据，然后`exit()`因为它已经完成了设置。

`processEnded`当进程退出*并*完成对其托管文件描述符（ 、 和 ）的所有 I/O`stdin`并且`stdout`它们`childFDs`已关闭时调用。如果您只是为了读取它的输出而生成一些东西，那么这就是您最可能关心的通知。

# c++ - AudioOutputUnitStart 很慢

> ID：10141526
> 
> 赞同：3
> 
> 时间：2012-04-13T13:14:18.457
> 
> 标签：c++, ios, core-audio

我有一个播放单声道音频事件的代码（各种频率的短哔声）。我创建了一个 AudioOutputUnit，将其停止，并在我需要播放音频时停止。我启动它。当我播放了所需的时间时，我会停止它。

听起来很简单。

但是，在我的 iPhone 4S（使用 iOS 5.1）上，AudioOutputUnitStart 通常需要 180 毫秒才能返回，这太过分了。

这是 AudioOutputUnit 的创建/初始化

```
void createAOU()
{
    m_init = false;
    // find the default playback output unit
    AudioComponentDescription defaultOutputDescription;
    defaultOutputDescription.componentType = kAudioUnitType_Output;
    defaultOutputDescription.componentSubType = kAudioUnitSubType_RemoteIO;
    defaultOutputDescription.componentManufacturer = kAudioUnitManufacturer_Apple;
    defaultOutputDescription.componentFlags = 0;
    defaultOutputDescription.componentFlagsMask = 0;

    // Get the default playback output unit
    AudioComponent defaultOutput = AudioComponentFindNext(NULL, &defaultOutputDescription);
    if (defaultOutput == NULL)
        return;

    OSErr err = AudioComponentInstanceNew(defaultOutput, &m_toneUnit);
    if (err != noErr)
        return;

    // single channel, floating point, linear PCM
    AudioStreamBasicDescription streamFormat;
    streamFormat.mSampleRate = m_framerate;
    streamFormat.mFormatID = kAudioFormatLinearPCM;
    streamFormat.mFormatFlags =
    kLinearPCMFormatFlagIsFloat |
    kAudioFormatFlagsNativeEndian | kLinearPCMFormatFlagIsPacked;
    streamFormat.mBytesPerPacket = sizeof(float);
    streamFormat.mFramesPerPacket = 1;
    streamFormat.mBytesPerFrame = sizeof(float);
    streamFormat.mChannelsPerFrame = 1;
    streamFormat.mBitsPerChannel = sizeof(float) * 8;
    err = AudioUnitSetProperty (m_toneUnit,
                                kAudioUnitProperty_StreamFormat,
                                kAudioUnitScope_Input,
                                0,
                                &streamFormat,
                                sizeof(AudioStreamBasicDescription));
    if (err != noErr)
        return;

    // Attach callback to default output
    AURenderCallbackStruct input;
    input.inputProc = RenderTone;
    input.inputProcRefCon = this;
    err = AudioUnitSetProperty(m_toneUnit, 
                               kAudioUnitProperty_SetRenderCallback, 
                               kAudioUnitScope_Input,
                               0, 
                               &input, 
                               sizeof(input));
    if (err != noErr)
        return;

    float aBufferLength = 0.001; // In seconds
    AudioSessionSetProperty(kAudioSessionProperty_PreferredHardwareIOBufferDuration, 
                            sizeof(aBufferLength), &aBufferLength);

    err = AudioUnitInitialize(m_toneUnit);
    if (err != noErr)
        return;
    reset();
    m_init = true;
} 
```

要开始它，我只需调用：

```
OSErr err = AudioOutputUnitStart(m_toneUnit); 
```

完成后：

```
OSErr err = AudioOutputUnitStop(m_toneUnit); 
```

我尝试了各种方法：将 kAudioSessionProperty_PreferredHardwareIOBufferDuration 属性设置为一个非常小的值（如 5 毫秒） 降低帧速率（尝试 48kHz、44.1kHz、8kHz）

不管我做什么......第一次启动音频单元时，AudioOutputUnitStart 仅在 160-180 毫秒后返回。如果我立即停止并启动它，那么它只需要大约 5m，这是可以接受的。

在我的应用程序中延迟是相当重要的，180ms 绝对是不可接受的。

有什么建议么？我见过一些人问过类似的问题，但他们通常没有得到答案。

我希望这次事情会有所不同:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T22:20:51.500

处理音频单元启动延迟的方法是提前启动音频单元，而不是停止它。相反，只需为短缓冲区配置音频会话，然后用静音填充音频单元渲染回调缓冲区，直到需要用所需的声音填充它们。然后在你的声音之后，回到用静音填充缓冲区而不是停止。

# wordpress - 在 Wordpress 中的自定义函数上使用条件标签/if/else？

> ID：10141530
> 
> 赞同：0
> 
> 时间：2012-04-13T13:14:27.293
> 
> 标签：wordpress, function, wordpress-theming, thumbnails, attachment

如果没有附件，如何隐藏 img-tag？

（功能来自本教程：[http](http://wp.tutsplus.com/tutorials/automagic-post-thumbnails-image-management/) ://wp.tutsplus.com/tutorials/automagic-post-thumbnails-image-management/ ）

```
<img src="<?php get_attachment_picture();?>" /> 
```

我需要这样的东西：

```
<?php if ( get_attachment_picture()) { ?>
<img src="<?php get_attachment_picture();?>">
<?php } else { ?>
show nothing, not even av default image
<?php } ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T16:44:42.870

您可以通过让函数返回缩略图而不是回显它来完成您需要的操作。

从函数中删除这些行：

```
else:
    $related_thumbnail = "images/default_thumbnail.jpg";  //define default thumbnail, you can use full url here. 
```

并更换

```
echo $related_thumbnail; 
```

和

```
return $related_thumbnail; 
```

然后你的代码变成

```
<?php
$attachment = get_attachment_picture();

if ( ! empty($attachment) ) { ?>
    <img src="<?php echo $attachment; ?>">
<?php } ?> 
```

我还没有测试过这些，所以我可能错过了一些东西，但这种方法应该有效。

顺便说一句 - 我不明白为什么函数有这些行：

```
ob_start();  
ob_end_clean(); 
```

可能值得删除它们，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T07:21:34.973

如果您使用的是“标准”文章缩略图，则可以使用`has_post_thumbnail`
[http://codex.wordpress.org/Function_Reference/has_post_thumbnail](http://codex.wordpress.org/Function_Reference/has_post_thumbnail)

```
<?php 
//This must be in one loop

if(has_post_thumbnail()) {
    the_post_thumbnail();
} else {
    // if there is no thumbnail, do nothing (or whatever you want) here
}
?> 
```

# vb.net - VB.NET 中的特殊字符

> ID：10141531
> 
> 赞同：0
> 
> 时间：2012-04-13T13:14:28.463
> 
> 标签：vb.net, encoding, special-characters

我正在开发带有 WebBrowser 控件的 VB.NET 应用程序。Web 浏览器转到包含字符串（仅此而已）的页面，类似于：

```
":¯‰—‚‰‰» º†—‰¿Ø†ƒ §Ø÷‰– É‰ ì€‰»…‰¿× Å ™†æ‰… ‰»—¿” †»… Â¼ƒ‰» ½¿¼½‰¿—”.:::" 
```

所述字符串来自 mySQL 数据库，然后设置为变量，例如

```
foo = WebBrowser1.DocumentText 
```

当我调用该变量时 - 使用`Debug.Print(foo)`,`MsgBox(foo)`或`Textbox1.Text = foo`，文本主要以正方形（或问号）的形式出现。

我认为这与编码有关。我尝试过使用`System.Text.Encoding.GetEncoding`几个不同的数字，但最终仍然是相同的结果。

我在PHP中写了一个类似strtr的函数，目的是把上面的特殊字符替换为字母数字字符。

# api - SRSPlus 替代品？

> ID：10141533
> 
> 赞同：0
> 
> 时间：2012-04-13T13:14:36.203
> 
> 标签：api, dns

我正在评估用于域配置的[SRSPlus API。](http://www.srsplus.com/)有谁知道这些的好替代品？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T16:49:32.610

我看过 OpenSRS，它是 SRSPlus 最接近的模拟，但与 SRSPlus 相比，它是个笑话。我花了相当多的时间研究这个问题，我发现 plus 是最好的解决方案，无论是在 api 和 Web 界面方面（顺便说一句，wi 真的非常好）。eNom 也值得一提——（虽然我实际上并没有评估）。

# php - PHP循环读取文件

> ID：10141535
> 
> 赞同：0
> 
> 时间：2012-04-13T13:14:48.433
> 
> 标签：php, loops, text, file-get-contents

我在 php 循环中读取文本文件时遇到问题。这是我的代码的一个更简单的示例，我知道我应该检查它是否存在在我的较长版本中的文件，但无论我做什么，这都不会读取我的文本文件。PHP 警告说文本文件是空的，但它们不是。PHP正在编写`<br />`tho。

```
for ($i=1; $i<=5; $i++)
{
   $myFile = "$i.txt";
   $readfile = file_get_contents($myfile);
   echo "$readfile <br />";
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-13T13:17:38.263

您的传入`$myfile`，`file_get_contents`但它在`$myFile`上面被调用（区分大小写）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T13:18:08.300

变量区分大小写。

```
for ($i = 1; $i <= 5; $i++) {
    $myFile = "$i.txt";
    $readfile = file_get_contents($myFile);
    echo "$readfile<br />";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T13:22:42.210

如果你简化你的代码，那么出错的机会就会更少：

```
for ($i=1; $i<=5; $i++)
{
   readfile("$i.txt");
   echo "<br />";
} 
```

# java - 线程在套接字程序中面临死锁

> ID：10141536
> 
> 赞同：2
> 
> 时间：2012-04-13T12:50:00.463
> 
> 标签：java, multithreading, sockets

我正在开发一个程序，用户可以在其中下载许多文件。现在首先我将文件列表发送给用户。因此，用户一次从列表中选择一个文件并提供存储该文件的路径。反过来，它还为服务器提供文件所在的路径。

我之所以采用这种方法，是因为我想在没有文件大小限制的情况下提供类似流的体验。

这是我的代码..

1）这是每次我启动应用程序时都会启动的服务器

```
public class FileServer extends Thread {

    private ServerSocket socket = null;

    public FileServer() {
        try {
            socket = new ServerSocket(Utils.tcp_port);
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }

    @Override
    public void run() {

        try {

            System.out.println("request received");
            new FileThread(socket.accept()).start();

        } catch (IOException ex) {
            ex.printStackTrace();
        }
    }

} 
```

2）这个线程分别为每个客户端运行，一次将请求的文件发送给用户8kb的数据。

```
public class FileThread extends Thread {

    private Socket socket;
    private String filePath;

    public String getFilePath() {
        return filePath;
    }

    public void setFilePath(String filePath) {
        this.filePath = filePath;
    }

    public FileThread(Socket socket) {
        this.socket = socket;
        System.out.println("server thread" + this.socket.isConnected());
        //this.filePath = filePath;
    }

    @Override
    public void run() {
        // TODO Auto-generated method stub
        try

        {
            ObjectInputStream ois=new ObjectInputStream(socket.getInputStream());
            try {
                           //************NOTE
                filePath=(String) ois.readObject();             
            } catch (ClassNotFoundException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

            File f = new File(this.filePath);

            byte[] buf = new byte[8192];

            InputStream is = new FileInputStream(f);
            BufferedInputStream bis = new BufferedInputStream(is);

            ObjectOutputStream oos = new ObjectOutputStream(
                    socket.getOutputStream());
            int c = 0;

            while ((c = bis.read(buf, 0, buf.length)) > 0) {
                oos.write(buf, 0, c);
                oos.flush();
                // buf=new byte[8192];
            }

            oos.close();
            //socket.shutdownOutput();
            // client.shutdownOutput();
            System.out.println("stop");
            // client.shutdownOutput();
            ois.close();
//          Thread.sleep(500);

            is.close();
            bis.close();
            socket.close();
        } catch (IOException ex) {
            ex.printStackTrace();
        }

    }

} 
```

注意：这里的 filePath 代表它在服务器上存在的文件的路径。连接到服务器的客户端提供此路径。我正在通过套接字管理它，并且我成功地接收到了这条路径。

3) FileReceiverThread 负责从服务器接收数据，并以此缓冲区数据构造文件。

```
public class FileReceiveThread extends Thread {

    private String fileStorePath;
    private String sourceFile;
    private Socket socket = null;

    public FileReceiveThread(String ip, int port, String fileStorePath,
            String sourceFile) {
        this.fileStorePath = fileStorePath;
        this.sourceFile = sourceFile;
        try {
            socket = new Socket(ip, port);
            System.out.println("receive file thread " + socket.isConnected());
        } catch (IOException ex) {
            ex.printStackTrace();
        }
    }

    @Override
    public void run() {
        try {
            ObjectOutputStream oos = new ObjectOutputStream(
                    socket.getOutputStream());
            oos.writeObject(sourceFile);
            oos.flush();
            // oos.close();
            File f = new File(fileStorePath);

            OutputStream os = new FileOutputStream(f);
            BufferedOutputStream bos = new BufferedOutputStream(os);

            byte[] buf = new byte[8192];
            int c = 0;

            //************ NOTE

            ObjectInputStream ois = new ObjectInputStream(
                    socket.getInputStream());

            while ((c = ois.read(buf, 0, buf.length)) > 0) {
                // ois.read(buf);
                bos.write(buf, 0, c);
                bos.flush();
                // buf = new byte[8192];
            }

            ois.close();
            oos.close();
            //
            os.close();
            bos.close();

             socket.close();
            //Thread.sleep(500);
        } catch (IOException ex) {
            ex.printStackTrace();
        }
    }

} 
```

注意：现在我面临的问题是第一次请求文件时，程序的结果与我的预期相同。我能够在第一时间传输任何大小的文件。现在，当请求第二个文件时（例如，我已将文件 a、b、c、d 发送给用户并且用户已成功接收文件 a，现在他正在请求文件 b）程序在这种情况下面临死锁。它正在等待套接字的输入流。我放了断点并试图调试它，但它第二次没有进入 FileThread 的运行方法。我在这里找不到错误。基本上我正在制作一个在局域网上工作的局域网信使。我使用 SWT 作为 UI 框架。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T13:51:19.757

一个更基本的问题。

您只处理第一个套接字。

```
while(true) {
    new FileThread(socket.accept()).start();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T14:24:41.477

根据 Peter Lawrey 的建议，我从源代码中删除了所有冗余流代码。现在修改后的源代码如下，问题依旧。

1) 文件服务器没有变化。它就是这样。

2) 文件线程

```
public class FileThread extends Thread {

    private Socket socket;
    private String filePath;

    public String getFilePath() {
        return filePath;
    }

    public void setFilePath(String filePath) {
        this.filePath = filePath;
    }

    public FileThread(Socket socket) {
        this.socket = socket;
        System.out.println("server thread" + this.socket.isConnected());
        // this.filePath = filePath;
    }

    @Override
    public void run() {
        // TODO Auto-generated method stub
        try

        {
            OutputStream oos = socket.getOutputStream();
            oos.flush();

            InputStream ois = socket.getInputStream();
            byte[] buf = new byte[8192];

            ois.read(buf);
            filePath = new String(buf);
            System.out.println(filePath);

            File f = new File(this.filePath);

            InputStream is = new FileInputStream(f);

            int c = 0;

            while ((c = is.read(buf, 0, buf.length)) > 0) {
                oos.write(buf, 0, c);
                oos.flush();
            }

            oos.close();
            System.out.println("stop");
            ois.close();

            is.close();
        } catch (IOException ex) {
            ex.printStackTrace();
        }

    }

} 
```

3) FileReceiverThread

```
public class FileReceiveThread extends Thread {

    private String fileStorePath;
    private String sourceFile;
    private Socket socket = null;

    public FileReceiveThread(String ip, int port, String fileStorePath,
            String sourceFile) {
        this.fileStorePath = fileStorePath;
        this.sourceFile = sourceFile;
        try {
            socket = new Socket(ip, port);
            System.out.println("receive file thread " + socket.isConnected());
        } catch (IOException ex) {
            ex.printStackTrace();
        }
    }

    @Override
    public void run() {
        try {
            OutputStream oos = socket.getOutputStream();

            oos.write(sourceFile.getBytes());
            oos.flush();

            File f = new File(fileStorePath);

            OutputStream os = new FileOutputStream(f);

            byte[] buf = new byte[8192];
            int c = 0;

            // ************ NOTE

            InputStream ois = socket.getInputStream();

            while ((c = ois.read(buf, 0, buf.length)) > 0) {

                os.write(buf, 0, c);
                os.flush();

            }

            ois.close();
            oos.close();

            os.close();

        } catch (IOException ex) {
            ex.printStackTrace();
        }
    }

} 
```

还有什么我想念的吗？

# mongodb - 查询数组元素而不是文档

> ID：10141540
> 
> 赞同：0
> 
> 时间：2012-04-13T13:15:15.003
> 
> 标签：mongodb

我可以查询文档内部的数组元素而不是查询整个文档吗？IE。我想接收数组元素，而不是文档。例如，我有这个：

```
{
  blog: 'blog1',
  comments:
  [{user: 'Alice', text: 'bla-bla-bla'}, {user: 'Sarah', text: 'bla-bla-bla'}, ...]
},
{
  blog: 'blog2',
  comments:
  [{user: 'John', text: 'bla-bla-bla'}, {user: 'Alice', text: 'bla-bla-bla'}, ...]
} 
```

如何获取 Alice 写的评论列表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T13:33:07.287

你还不能这样做。见[https://jira.mongodb.org/browse/SERVER-828](https://jira.mongodb.org/browse/SERVER-828)

# eclipselink - MOXy 可以仅使用 getter 序列化 POJO，而无需在每个 getter 上显式放置注释吗？

> ID：10141543
> 
> 赞同：1
> 
> 时间：2012-04-13T13:15:23.957
> 
> 标签：eclipselink, moxy

所以鉴于我有班级名称：

```
class Name {
  private String first;
  private String middle;
  private String last;

  public getFirst() { return first; }
  public getMiddle() { return middle; }
  public getLast() { return last; }
} 
```

我想使用映射 XML 序列化此类的实例，而不必列出映射 XML 中的每个属性：

```
<java-types>
    <java-type name="Name">
        <java-attributes>
           <xml-element java-attribute="first"/>
           <xml-element java-attribute="middle"/>
           <xml-element java-attribute="last"/>
        </java-attributes>
    </java-type>
</java-types> 
```

所以理想情况下，我希望有这样的映射文件：

```
<java-types>
    <java-type name="Name" xml-accessor-type="GETTERS"/>
</java-types> 
```

我有一些像这样的遗留 DTO 类仅用于具有 30 个或更多属性的序列化（故意没有设置器），理想情况下，我希望避免在映射文件中列出每个属性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T13:46:30.717

**注意：** 我是[**EclipseLink JAXB (MOXy)**](http://www.eclipse.org/eclipselink/moxy.php)负责人，也是[**JAXB 2 (JSR-222)**](http://jcp.org/en/jsr/detail?id=222)专家组的成员。

对于这个用例，我建议使用字段访问类型。指定此项后，JAXB 实现将使用字段（实例变量）来访问数据，而不是通过属性（get 方法）。下面我将演示如何使用 MOXy 的外部映射文档扩展来做到这一点：

**绑定.xml**

```
<?xml version="1.0"?>
<xml-bindings
    xmlns="http://www.eclipse.org/eclipselink/xsds/persistence/oxm"
    package-name="forum10141543">
    <java-types>
        <java-type name="Name" xml-accessor-type="FIELD">
            <xml-root-element/>
        </java-type>
    </java-types>
</xml-bindings> 
```

**姓名**

```
package forum10141543;

class Name {
    private String first;
    private String middle;
    private String last;

    public Name() {
    }

    public Name(String first, String middle, String last) {
        this.first = first;
        this.middle = middle;
        this.last = last;
    }

    public String getFirst() { return first; }
    public String getMiddle() { return middle; }
    public String getLast() { return last; }
} 
```

**jaxb.properties**

要将 MOXy 指定为您的 JAXB 提供程序，您需要添加一个`jaxb.properties`在与您的域类相同的包中调用的文件，其中包含以下条目。

```
javax.xml.bind.context.factory = org.eclipse.persistence.jaxb.JAXBContextFactory 
```

**演示**

以下代码演示了如何在引导时传入绑定文件`JAXBContext`：

```
package forum10141543;

import java.util.*;
import javax.xml.bind.*;
import org.eclipse.persistence.jaxb.JAXBContextFactory;

public class Demo {

    public static void main(String[] args) throws Exception {
        Map<String, Object> properties = new HashMap<String, Object>(1);
        properties.put(JAXBContextFactory.ECLIPSELINK_OXM_XML_KEY, "forum10141543/bindings.xml");
        JAXBContext jc = JAXBContext.newInstance(new Class[] {Name.class}, properties);

        Name name = new Name("Jane", "Anne", "Doe");
        Marshaller marshaller = jc.createMarshaller();
        marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);
        marshaller.marshal(name, System.out);
    }

} 
```

**输出**

```
<?xml version="1.0" encoding="UTF-8"?>
<name>
   <first>Jane</first>
   <middle>Anne</middle>
   <last>Doe</last>
</name> 
```

**了解更多信息**

*   [http://blog.bdoughan.com/2011/06/using-jaxbs-xmlaccessortype-to.html](http://blog.bdoughan.com/2011/06/using-jaxbs-xmlaccessortype-to.html)
*   [http://blog.bdoughan.com/2010/12/extending-jaxb-representing-annotations.html](http://blog.bdoughan.com/2010/12/extending-jaxb-representing-annotations.html)

# java - Guice：请求实例，而不是类型

> ID：10141544
> 
> 赞同：0
> 
> 时间：2012-04-13T13:15:26.873
> 
> 标签：java, spring, dependency-injection, guice

让我们声明“ `All Rocks have Minerals.`”：

```
public class Mineral
{
    // Nevermind why a Mineral would have a GUID.
    // This is just to show that each Mineral instance
    // is universally-unique.
    String guid;

    @Inject
    public Mineral(String id)
    {
        guid = id;
    }
}

public class Rock
{
    private Mineral mineral;

    @Inject
    public Rock(Mineral min)
    {
        mineral = min;
    }
} 
```

如果我们想要 2 个`Rock`实例，每个实例都配置了不同的`Mineral`实例（每个都有自己的 GUID）：

```
public class RockModule extends AbstractModule
{
    public void configure(Binder binder)
    {
        // Make two Minerals with different GUIDs.
        Mineral M1 = new Mineral(UUID.getRandomId().toString());
        Mineral M2 = new Mineral(UUID.getRandomId().toString());

        // Configure two Rocks with these unique Minerals
        Rock R1 = new Rock(M1);
        Rock R2 = new Rock(M2);

        // Define bindings
        bind(Rock.class).toInstance(R1);

        // No way for Guice to expose R2 to the outside world!
    }
} 
```

所以现在，当我们向 Guice 请求 a 时`Rock`，它总是会给我们一个`R1`实例，它本身就配置了 的`M1`实例`Mineral`。

在 Spring DI 中，您可以将两个 bean 定义为相同的类型，但只需给它们不同的 bean ID。然后，您使用它们的 ID 将 bean“连接”在一起。因此，我可以将它们连接在一起，`R1`并在一起等等。然后，我可以根据需要向 Spring 索取它们。`M1``R1``M2``R1``R2`

使用 Guice，您只能询问您想要的**类型**`Rock.class`( )，而不是**实例**。

**您如何使用 Guice 请求不同的“有线豆”？通过使用不同的`AbstractModule`结核？或者这是Guice的限制？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T13:25:02.013

我怀疑你想要[绑定注释](http://code.google.com/p/google-guice/wiki/BindingAnnotations)。Guice 不按*类型*绑定——它通过*键*绑定——但如果你不做任何其他事情，键将只包含类型。绑定注释允许您创建更丰富的键。

链接的文档比我能更好地解释它，但结果是有多种方法可以指定您想要的内容，包括：

```
@Inject
public Foo(@Named("X") Rock rock) 
```

或者

```
@Inject
public Foo(@HardRockCafe Rock rock) 
```

在后一种情况下，`@HardRockCafe`是自定义绑定注释。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T04:23:33.333

一般来说，这将违反 Guice 的建议。您通常不会`new`在模块内部创建一个类来创建实例，因为它首先违背了使用 DI 容器的目的。（为什么还要用 注释你的类`@Inject`？）

相反，您会让 Guice 为您执行此操作：

```
class RockModule extends AbstractModule {
  public void configure() {}

  @Provides
  @Named("UUID")
  public String getUuid() {
    return UUID.getRandomId().toString();
  }
} 
```

现在每个人都会`Mineral`自动获得一个唯一的 UUID，并且每个`Rock`人都会获得一个唯一的`Mineral`.

这让我们分道扬镳，但是如果您想要在运行时使用两个独特的 Rock 和 Mineral 配对，那么这就是 Guice 所说的“机器人腿”问题，您可以使用**私有模块**来解决它。[请参阅此处](http://code.google.com/p/google-guice/wiki/FrequentlyAskedQuestions#How_do_I_build_two_similar_but_slightly_different_trees_of_objec)的示例。

# perl - Perl 的排队系统

> ID：10141545
> 
> 赞同：9
> 
> 时间：2012-04-13T13:15:27.840
> 
> 标签：perl, task-queue

我正在开发一个 Perl 项目，该项目需要一个 FIFO 消息队列来在单台机器（UNIX）上的多个进程之间分配任务。队列大小可能会增长到 1M 个作业。

我已经尝试过[`IPC::DirQueue`](http://search.cpan.org/perldoc?IPC%3a%3aDirQueue)，但是排队的工作量为 50k 左右，速度变得非常慢。可以在 Perl 中使用的这个模块有哪些好的替代品？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-13T14:51:00.213

我在使用 ZeroMQ 解决此类问题方面取得了相当大的成功，无论是使用 Perl 还是其他语言。

根据我的经验，[ZeroMQ](http://metacpan.org/module/ZeroMQ)模块似乎是目前 Perl 最可靠的绑定。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-13T16:03:45.517

我没有在您列出的条件下尝试过，但[Thread::Queue](http://search.cpan.org/perldoc?Thread%3a%3aQueue)已证明对我有用。结合[forks](http://search.cpan.org/perldoc?forks)，它可以用来与进程通信，只要这些进程是由队列创建者产生的。

```
use forks;  # If you want to use processes instead of threads.
use Thread::Queue qw( ); 
```

工人模型通常是理想的。

```
my $q = Thread::Queue->new();

my @workers;
for (1..$NUM_WORKERS) {
   push @workers, async {
      while (my $item = $q->dequeue()) {
         ...
      }
   };
}

# ... Enqueue requests [ $q->enqueue($request); ] ...

# Signal termination
$q->enqueue(undef) for 1..@workers;

# Collect workers.
$_->join() for @workers; 
```

# spring - 没有 Guice/Spring 的 JPA 交易更轻松

> ID：10141553
> 
> 赞同：4
> 
> 时间：2012-04-13T13:16:12.207
> 
> 标签：spring, jpa, transactions, osgi, guice

Spring 和 Guice-persist 都允许`@Transactional`对访问数据库的方法进行注释，以在未打开时自动创建事务，在方法返回时提交它，在异常时回滚等。

有没有办法在 OSGi 应用程序中不使用 Spring 或 Guice 来获得相同的东西（或类似的可用）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-13T19:22:54.400

即使在 Guice/Spring @Transactional 容器中运行时，我也经常使用以下代码片段：

```
public void transact(Runnable runnable) {
    EntityTransaction tx = em.getTransaction();
    boolean success = false;
    tx.begin();
    try {
        runnable.run();
        success = true;
    } finally {
        if (success) {
            tx.commit();
        } else {
            tx.rollback();
        }
    }
}

public <T> T transact(Callable<T> callable) throws Exception {
    EntityTransaction tx = em.getTransaction();
    boolean success = false;
    tx.begin();
    try {
        T result = callable.call();
        success = true;
        return result;
    } finally {
        if (success) {
            tx.commit();
        } else {
            tx.rollback();
        }
    }
} 
```

用法：

```
dao.transact(new Runnable() {
    public void run() {
        // do stuff in JPA
    }
});

Long count = dao.transact(new Callable<Long>() {
    public Long call() {
        return em.createQuery("select count(*) from Foo", Long.class)
            .getSingleResult();
    }
}); 
```

它非常轻巧，可以完成工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T16:14:26.197

Apache Aries 允许您在 blueprint.xml 中以声明方式配置事务。例如：

```
<blueprint
xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0"
xmlns:jpa="http://aries.apache.org/xmlns/jpa/v1.0.0"
xmlns:tx="http://aries.apache.org/xmlns/transactions/v1.0.0">

<bean
    id="transactedBean"
    class="some.package.BeanImpl">
    <tx:transaction
        method="*"
        value="Required" /> 
```

Aries 捆绑包可以放在您选择的 OSGi 框架中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T14:46:42.243

一种可能的解决方案是使用 Spring Data JPA，因为它[可以在 Spring 容器之外](http://static.springsource.org/spring-data/data-jpa/docs/current/reference/html/#repositories.create-instances.standalone)与[`JpaRepositoryFactory`](http://static.springsource.org/spring-data/data-jpa/docs/current/api/org/springframework/data/jpa/repository/support/JpaRepositoryFactory.html)您的`RepositoryFactorySupport`. 获得这项工作的有用信息是[如何在 Spring 容器之外使用 Spring Data JPA？](https://stackoverflow.com/questions/9123964/how-do-you-use-spring-data-jpa-outside-of-a-spring-container).

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-13T15:16:22.840

如何以不同的方式看待问题，而不是考虑如何准确地实现事务管道，而是考虑*包装在事务中的东西*，其中 a只是一个包装器，在提交**之前**`transaction`并没有多大意义。

 **这个词可能听起来很奇怪并吓跑了许多开发人员，但它*确实*很有意义.. 在这里谈论 Monad，或者更好的是......

## 事务单子

```
trait Transactional[A] {
  def map[B]( f: A => B): Transactional[B]
  def flatMap[B]( f: A => Transactional[B] ): Transactional[B]
} 
```

这是一篇讨论该方法的[帖子](http://advorkovyy.blogspot.com/2010/10/transactional-monad-for-scala.html)，但要点是在没有任何副作用的情况下自由应用函数（例如，在事务中，例如它总是将所有函数输出包装在 中`Transactional`）**，直到**您准备好提交，然后您调用“承诺”（又名`unsafePerformIO`）实际上是“改变宇宙”。

以上是在 Scala 中，也许 Monad 一开始可能不是非常明显或可取的东西，但这只是看待问题的另一种方式 => 例如没有框架、AOP、突变等。只是纯函数组合（ FTW！）**

# mysql - 安装 mysql & phpmyadmin

> ID：10141556
> 
> 赞同：0
> 
> 时间：2012-04-13T13:16:16.810
> 
> 标签：mysql, amazon-ec2, phpmyadmin

我刚刚为我的网站安装了 Amazon EC2，并安装了 php、apache 等。

用这些代码安装了mysql，

```
yum install mysql mysql-server mysql-libs
/sbin/service mysqld start
chkconfig --levels 235 mysqld on
mysqladmin -u root password 'mynewpassword' 
```

但是，我得到了这个回应

```
mysqladmin: connect to server at 'localhost' failed
error: 'Access denied for user 'root'@'localhost' (using password: NO)' 
```

我安装了 phpmyadmin，我无法以 root 用户身份登录。

如何更改/设置密码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T17:06:34.243

用这个

```
mysqladmin -u root -p 
```

系统将提示您输入密码

# php - 从 PHP 中的动态文件夹加载图像

> ID：10141559
> 
> 赞同：0
> 
> 时间：2012-04-13T13:16:23.943
> 
> 标签：php

我想知道是否可以帮助我。

我正在尝试构建一个 php 脚本，该脚本从名为“Thumbnails”的文件夹中加载图像：

下面的 php 代码是从我的加载图像的脚本中提取的。

```
<?php 

  $galleryPath = 'UploadedFiles/'; 

  $thumbnailsPath = $galleryPath . 'Thumbnails/'; 

  $descriptions = new DOMDocument('1.0'); 
  $descriptions->load($galleryPath . 'files.xml'); 
?> 
```

根据我阅读的信息和从该站点收到的指导，我一直在使用“realpath”来获取文件夹的完整路径，即：

`/homepages/2/d333603417/htdocs/development/UploadedFiles/IRHM73/1/Thumbnails`

通常我可以使用它来指向脚本以打开所需的图像，但我遇到的问题是两个文件夹，“用户名”和“位置”是动态创建的，并且每个用户和位置的值都会发生变化，在以上是值“IRHM73”（用户名）和“1”（位置）。

几天来，我一直在尝试找到一种方法来指向脚本，以便它打开正确的文件路径，而不管值如何，但我似乎找不到解决方案。除此之外，我还需要只检索那些与当前用户和位置相关的图像。

我尝试了以下方法：

```
<?php 

  $galleryPath = 'UploadedFiles/'; 

  $absGalleryPath = realpath($galleryPath) . DIRECTORY_SEPARATOR . $usernamefolder . DIRECTORY_SEPARATOR . $locationfolder . DIRECTORY_SEPARATOR; 

  $thumbnailsPath = $absGalleryPath . 'Thumbnails/'; 

  $descriptions = new DOMDocument('1.0'); 
  $descriptions->load($absGalleryPath . 'files.xml'); 
?> 
```

但是图像无法加载，我现在不知道如何解决这个问题。

我只是想知道是否有人可以看看这个，让我知道我哪里出错了。

谢谢并恭祝安康

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T13:25:33.577

好的，我看到您将 DIRECTORY_SEPARATOR 用于 $absGalleryPath 变量。但是您没有注意到您在 $galleryPath ("UploadedFiles/") 和 'Thumbnails/' 中使用了 '/'，这违背了 DIRECTORY_SEPARATOR 的目的。如果 '/' 有效，那么也许你应该将 DIRECTORY_SEPARATOR 更改为 '/'。可能会奏效。

# android - Android Fragments 何时将它们引入应用程序

> ID：10141560
> 
> 赞同：0
> 
> 时间：2012-04-13T13:16:25.100
> 
> 标签：android, android-fragments, fragment

我正在制作一个需要在平板电脑和手机上运行的项目。我正在考虑为此使用片段。但我没有任何使用它们的历史。

我应该立即实施它们还是以后容易实施它们？（我可以先制作手机应用程序，然后再制作平板电脑应用程序）

有第一次实现片段历史的人吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T13:39:11.103

我建议从一开始就为 UI 组件使用片段，这些片段可以在平板电脑上的主细节中使用，如时尚，但在较小的手机上作为单一活动。对于较小的手机，您将获得少量开销（例如，仅使用一个片段的活动容器），但在切换到平板电脑时您将从该开销中受益。它还将改进小型手机和平板电脑之间的一致 UI 设计。

如果您针对 pre-fragment（例如 Android 2.x）设备使用支持库。我还建议根据支持库使用注释来标记类。这样，将来有时从支持库切换到“本机”实现时，您会发现它们更容易（至少您已经修改了导入语句，因为支持库使用不同的包。在极少数情况下，您将不得不修改方法（例如更改`getSupportFragmentManager()`为`getFragmentManager()`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T11:03:25.817

我已经工作了两个星期来更新一个android应用程序并使它使用fragment，所以你直接使用fragment会更容易。但我认为您必须问自己的问题是我的应用程序中是否需要片段？？？

从本质上讲，片段允许您一次向用户显示多个“活动”。你需要这个吗？？如果不是，则使用资源限定符指向另一个具有更多/更少片段的布局（例如 layout-land-large）会更容易。您将能够更新 file.xml 中元素的大小。

如果您需要显示两个活动（使用平板电脑时），最好的解决方案是使用片段。在这里你说：片段是否协同工作，为用户提供简化的体验？如果是，那么直接使用片段将是完美的，因为片段在彼此之间发送参数以进行通信（与活动不同）。在活动中：intent.putExtra() 在片段中：例如，您可以使用 bundle。因此，如果您需要更新您的应用程序，您将浪费时间搜索发件人附加信息并以其他方式发送。

# c# - 值不在预期范围内。（运行时错误）

> ID：10141561
> 
> 赞同：0
> 
> 时间：2012-04-13T13:16:36.733
> 
> 标签：c#, class, runtime-error, opc

我正在将 Windows 窗体从 VB 转换为 C#，当我尝试同步读取我的 OPC 标签时遇到错误。

我有这个代码：

```
public partial class FrmPartialMain : Form
{   
    RsiOPCAuto.OPCServer oOpcServer;
    RsiOPCAuto.OPCGroup oOpcGroup;

    int ClHandle; //this is set to 1 in another part of the code.
    int SvHandle;

    int OpcDsCashe = 1;
    int OpcDsDevice = 2;
    private void cmdSyncRead_Click(object sender, EventArgs e)
    {
        int lNumItems = oOpcGroup.OPCItems.Count; // = 3
        int[] h = new int[lNumItems];
        Array arValues = new int[lNumItems];
        Array arHandles;
        Array arErrors;
        object Qualities;
        object Timestamps;

        h[ClHandle - 1] = oOpcGroup.OPCItems.Item(ClHandle).ServerHandle;  
        arHandles = (Array)h;
        //Error on the next line bellow.
        oOpcGroup.SyncRead((short)OpcDsDevice, lNumItems, ref arHandles, out arValues, out arErrors, out Qualities, out Timestamps);

        txtSubValue.Text = Convert.ToString(arValues.GetValue(0));
    }
} 
```

oOpcGroup.Read() 读取组中一个或多个项目的值、质量和时间戳信息。返回类型如下所示：

```
 SyncRead(short Source, int NumItems, ref System.Array ServerHandles, out System.Array Values, out System.Array Errors, out object Qualities, out object TimeStamps); 
```

运行此代码给了我标题中的错误，值不在预期范围内。关于我在这里可能做错了什么的任何想法？

头脑风暴！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T08:32:11.400

它还活着！

这是固定代码：

```
public partial class FrmPartialMain : Form
{   
    RsiOPCAuto.OPCServer oOpcServer;
    RsiOPCAuto.OPCGroup oOpcGroup;

    int ClHandle; //this is set to 1 in another part of the code.
    int SvHandle;

    int OpcDsCashe = 1;
    int OpcDsDevice = 2;
    private void cmdSyncRead_Click(object sender, EventArgs e)                                                                                  //Sync Read
    {
        int lNumItems = oOpcGroup.OPCItems.Count;
        int[] arH = new int[1 + lNumItems];
        Array arValues = new object[1 + lNumItems]; //<-- This needed to be an object array.
        Array arHandles;
        Array arErrors;
        object Qualities;
        object Timestamps;

        arH[ClHandle] = oOpcGroup.OPCItems.Item(ClHandle).ServerHandle;

        arHandles = (Array)arH;
        oOpcGroup.SyncRead((short)OpcDsDevice, lNumItems, ref arHandles, out arValues, out arErrors, out Qualities, out Timestamps);

        txtSubValue.Text = Convert.ToString(arValues.GetValue(1));
    }
} 
```

# java - java : Error in Enum Declaration Saying Misplaced Constructors

> ID：10141564
> 
> 赞同：2
> 
> 时间：2012-04-13T13:16:57.560
> 
> 标签：java

I may get result of any of the type , so i am defining enum this way

```
public enum Result 
     {
        1, 2,3, 4,5, 6,7, 8
     }

String resultvalue = calculateResult();

    switch (Result .valueOf(resultvalue ))
          {

          } 
```

**But i am geting error at the Enum Declaration itself saying Mispalced Constructors .**

Could anybody please help me

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-13T13:18:25.257

Those aren't valid identifiers for enum values, basically. You'll need to prefix them with a letter or _. You'll also need to make the identifiers unique - currently you've got `0010` four times...

Once you've sorted that out, the rest should probably be okay - but if you have any more problems, please post a short but *complete* program, rather than snippets.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T13:18:46.110

`0001` is not a valid Java identifier. A Java Identifier must not start with a digit.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T13:21:26.153

Although I don't understand what you want to achieve and why you have duplicates. Something like that (maybe using an int instead of String) should work.

```
public enum Result {
    One( "0001"),
    Two( "0010")
    ...

    private String val;

    private Result(String val) {
        this.val = val;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-13T13:23:54.123

I an not sure why calcuate result would return a String. I would return a int here but...

```
String resultvalue = calculateResult();
switch (Integer.parseInt(resultvalue)) {
   case 0b0001:

   case 0b0010:

   case 0b0110:

   case 0b1010:

   case 0b1100:

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-13T13:54:27.197

What is it that you are trying to achieve? If you need to:

1.  parse an integer from a string, then
2.  check that it's from a certain set of values, and finally
3.  switch on its value,

then you don't need an enum. Just do it with `Integer.parseInt()`, `Set.contains()`, and `switch`.

# c++ - openmp减少技术

> ID：10141565
> 
> 赞同：4
> 
> 时间：2012-04-13T13:17:01.743
> 
> 标签：c++, parallel-processing, openmp, reduce, tbb

我有这个用于查找最小和最大长度的 for 循环，如您所见，在查看 OpenMP 时我有两个值要减少，我只能注意到它只为一个值提供了减少技术。

```
for (size_t i = 0; i < m_patterns.size(); ++i) 
{// start for loop
    if (m_patterns[i].size() < m_lmin)          
        m_lmin = m_patterns[i].size();          
    else if (m_patterns[i].size() > m_lmax)           
        m_lmax = m_patterns[i].size();
 }// end for loop 
```

我可以执行以下操作吗

```
 #pragma omp parallel for reduction (min:m_lmin,max:m_lmax) 
```

或者我应该将 for 循环重写为两个 for 循环，一个用于最小值，一个用于最大值

另一个问题..我可以在 OpenMP 中使用像 concurrent_vector 这样的 tbb 容器吗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-03-23T20:17:31.600

从 OpenMP 3.1 开始，他们开始支持最小和最大缩减操作。GCC 4.7 提供 OpenMP 3.1。您可以参考[此链接](http://www.techdarting.com/2013/06/openmp-min-max-reduction-code.html)以获取有关最小最大减少的更多详细信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-23T20:53:52.257

您可以通过并行填充变量的私有版本然后将它们合并到关键部分中来滚动您自己的并发向量以及最小和最大减少。这将适用于仅支持 OpenMP 2.5（不支持最小和最大缩减）的 MSVC。但无论您的 OpenMP 版本是否支持最小和最大缩减，这都是一种有用的学习技术。

只要您循环的项目数远大于线程数（或者与合并相比，遍历项目的时间很大），此方法就很有效。

```
#pragma parallel 
{
    int m_lmin_private = m_lmin;
    int m_max_private = m_max_private;
    #pragma omp for nowait
    for (size_t i = 0; i < m_patterns.size(); ++i) {
        if (m_patterns[i].size() < m_lmin_private)          
            m_lmin_private = m_patterns[i].size();          
        else if (m_patterns[i].size() > m_lmax_private)           
            m_lmax_private = m_patterns[i].size();
    }
    #pragma omp critical
    {
        if (m_lmin_private<m_lmin)          
            m_lmin = m_lmin_private;    
        if (m_lmax_private>m_lmax)           
            m_lmax = m_lmax_private;                     
    }
} 
```

对于并发向量，我们使用相同的方法：

```
std::vector<int> vec;
#pragma omp parallel
{
    std::vector<int> vec_private;
    #pragma omp for nowait //fill vec_private in parallel
    for(int i=0; i<n; i++) {
        vec_private.push_back(i);
    }
    #pragma omp critical
    vec.insert(vec.end(), vec_private.begin(), vec_private.end());
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T15:49:33.007

就 openmp 而言 - 提供了官方规范 (www.openmp.org)。但最后你的编译器完成了所有的工作。所以你的问题的答案可能与编译器相关......但是微软提供[http://msdn.microsoft.com/de-de/library/2etkydkz(v=vs.80).aspx](http://msdn.microsoft.com/de-de/library/2etkydkz(v=vs.80).aspx)

建议

```
#pragma omp parallel for reduction(min:m_lmin) reduction(max:m_lmax) 
```

# wpf - 如何在 WPF DataGrid 中编辑长文本（如带有下拉菜单的备忘录编辑）

> ID：10141567
> 
> 赞同：1
> 
> 时间：2012-04-13T13:17:19.653
> 
> 标签：wpf, text, datagrid, drop-down-menu, multiline

假设您有一个 ViewModel 的属性，它是字符串并且包含一个长文本。用户希望在 WPF DataGrid 中以就地模式编辑此属性，因此

*   在视图模式下，适当的单元格显示用省略号修剪的文本
*   在编辑模式下，文本将在单元格的下拉列表中打开。下拉菜单应该只允许垂直滚动。

所以它应该看起来像： ![在此处输入图像描述](../Images/3cd0b7c8a75c090e222d579a7c95e13e.png)

我的问题是如何在 WPF DataGrid 中实现这些要求？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T13:25:37.040

使用数据模板和样式触发器来满足您的要求。

# sitecore - Sitecore 内容编辑器 HTML 代码格式

> ID：10141571
> 
> 赞同：0
> 
> 时间：2012-04-13T13:17:50.507
> 
> 标签：sitecore

最近开始使用 Sitecore 6.2。

有没有办法在“HTML”编辑器中保留代码格式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T14:26:09.847

Mark Ursino 在这里写了一篇博客：http: [//firebreaksice.com/prevent-sitecore-content-editor-from-stripping-script-tags/](http://firebreaksice.com/prevent-sitecore-content-editor-from-stripping-script-tags/)

我认为这有你需要的所有信息。

# jquery - jquery改变背景

> ID：10141573
> 
> 赞同：-2
> 
> 时间：2012-04-13T13:17:55.420
> 
> 标签：jquery, css

```
<td class="td_1">nbsp;</td><td class="td_1">nbsp;</td><td class="td_1">nbsp;</td>
<td class="td_2">nbsp;</td><td class="td_2">nbsp;</td><td class="td_2">nbsp;</td>
<td class="td_3">nbsp;</td><td class="td_3">nbsp;</td><td class="td_3">nbsp;</td>
<td class="td_4">nbsp;</td><td class="td_4">nbsp;</td><td class="td_4">nbsp;</td> 
```

我需要一个 jquery 在鼠标悬停时将背景更改为 #00000，鼠标悬停时更改为原始颜色。这些是在循环中动态生成的，因此它可以达到 td_100s。

我尝试了一些示例，但不幸的是，这些名称都是静态的，对我不起作用。

如果将鼠标悬停在 td_1 上，则所有 td_1 都应受到相应影响。

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-13T13:25:02.437

我认为鼠标悬停效果根本不需要 jQuery。CSS 可以完成这项工作：

```
#table_id td {
  background: #ffffff;
 }

#table_id td:hover {
  background: #000000;
  color: #ffffff;
} 
```

这假定您的表有一个 ID 或 CSS 的其他钩子。

大量更新以响应其他单元格的要求

好的，如果您希望*所有*具有相同类的 td 更改颜色，那么是的，您将需要一些 javascript。

像这样的东西应该工作：

```
$('td').hover(function(){
    var thisClass = $(this).attr('class');
    $('td.' + thisClass).addClass('hovered');
}, 
   function(){
     var thisClass = $(this).attr('class');
     $('td.' + thisClass).removeClass('hovered');
 } 
```

然后在 CSS 中：

```
.hovered { background: #000000; } 
```

我通常尝试使用 jQuery 添加/删除类，而不是在 CSS 中进行颜色声明 - 通常更容易维护这种方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T13:24:35.460

我会做以下事情：（我假设这些`<td>`s在一个`<table>`元素内）所以你可以将类“table_class”添加到表中并在**css**中定义两个类：

```
table.table_class td{
    background-color:#whatever;
}
table.table_class td:hover{
    background-color:#000;
} 
```

**注意：**这个解决方案根本不需要 JQuery ;)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T13:23:13.727

是否可以对整行进行悬停。或者修改此代码`td`只做

```
$("#mytable tr").mouseover(function() {$(this).addClass("over");}).mouseout(function() {$(this).removeClass("over");}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-13T13:21:36.810

为什么要设置动态 td 行的类名？？？为什么不将他们的 ids 设置为 'td_1' ... 'td_100'？并在鼠标悬停时改变他们的班级？或者css3过滤器怎么样？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-13T13:24:36.943

在你的 CSS 中，为

```
td.hoverstate{background-color:#000;} 
```

然后在jQuery中做

```
 $("td").hover(
      function () {
        $(this).addClass("hoverstate");
      },
      function () {
        $(this).removeClass("hoverstate");
      }
    ); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-13T18:20:30.997

好吧，看看这个：http: [//jsfiddle.net/hKmTU/3/](http://jsfiddle.net/hKmTU/3/)。我已经按照你要求的方式工作了。chipcullen 的答案不起作用，因为您需要解析悬停类。

例如：当您将鼠标悬停在所有 td_1 上时，该类变为“td_1 hovered”。

然后，当您尝试在选择器中使用 thisClass 时，您最终会得到“td.td_1 hovered”，这不会选择正确的 div

```
var thisClass = $(this).attr('class');
$('td.' + thisClass).removeClass('hovered');

becomes

var thisClass = $(this).attr('class');
thisClass = thisClass.substring(0, thisClass.indexOf(" "));
$("td." + thisClass ).removeClass('hovered'); 
```

希望这可以帮助！

# exception - cfthrow 你是这样用的吗？（来自 Adob e 的文档）

> ID：10141578
> 
> 赞同：0
> 
> 时间：2012-04-13T13:18:15.893
> 
> 标签：exception, coldfusion

我正在阅读[cfthrow 的文档](http://livedocs.adobe.com/coldfusion/8/htmldocs/help.html?content=Errors_15.html)并遇到了这个

> 何时使用 cfthrow 标签
> 
> 当您的应用程序可以识别和处理特定于应用程序的错误时，请使用 cfthrow 标记。cfthrow 标记的一种典型用途是实现自定义数据验证。cfthrow 标记对于将错误从自定义标记页面抛出到调用页面也很有用。
> 
> 例如，在用于设置密码的表单操作页面或自定义标签上，应用程序可以确定输入的密码是最小长度，还是包含字母和数字，并抛出错误消息，指示密码规则坏了。cfcatch 块处理错误并告诉用户如何更正问题。

我一直都做错了吗，或者这只是一个可怕的用例？

我被告知不应使用异常来处理常规的应用程序流程，而应使用某些超出您控制的东西。例如，一个文件在您写入时被锁定。

违反密码规则的用户听起来不像是您无法控制的事情。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-13T14:47:16.543

That is a poor example not a poor use case. I personally would pass in the parameters to a validation function and return a result that contained a pass or fail and a collection of failure messages to display to the user.

How I use exceptions is as follows.

**Within functions**. Let's say that you have a function that you are getting some data from the database and you are then constructing a structure from it. If the query returned has no values you have several options:-

1.  You could return an empty structure and let the calling code deduce the problem from the fact the structure is empty. This is not ideal because then the application has to have complicated logic to address the missing data.

2.  You could return a more complex datatype where one property is whether the process went ok and the actual data. Again this is not optimal as you have to then make this access the property on every call when the majority of the time you have data and again your application is dealing with this issue.

3.  Or you could raise a custom exception with cfthrow indicating that there is no record that matches. This then means that you can choose to ignore the prospect of this error happening and let it bubble up to the onError handler or you could surround it in a try catch statement and deal with it there and then. This keeps your API clean and sensible.

**Wrapping external errors** let's say that you connect to an external API using cfhttp over https. Now this requires installing the certificate in your keystore otherwise it throws an error. If this certificate gets updated then it will start erroring again. In this instance I would wrap the call in a try catch and should this be the error I would wrap that in my own custom exception with a message detailing that we need to update the cert in the keystore so that any developer debugging it knows what to do to fix it without having to work it out. If it is not that particular error then I would cfrethrow it so that it bubbles up and is dealt with by whatever exception handling logic is above the call.

These are just a few examples, but there are more. To summarise I would say that throwing exceptions is a way of communicating up through the tiers of an application when something has occurred that is not the hoped for behaviour while keeping your API/Application logic clean and understandable.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T13:52:58.527

这真的取决于你的判断力。在许多语言中，对所有内容都使用异常是非常常见的，包括输入验证。

重要的是，异常与您是否可以控制某些事情无关。例如，假设您有一个相当长且复杂的模块来上传文件。类似的事情有很多失败点：文件可能太大，文件可能是错误的格式等。无一例外，你唯一的选择是大量的 if/then 检查和最后的某种状态返回. 除了例外，您所要做的就是使用一组 cfthrows：

```
<cfthrow type="FileUpload.TooBig" message="The file size was #FileSize#, but the maximum size allowed is #MaxFileSize#">

<cfthrow type="FileUpload.WrongType" message="The file type was #FilType#, but the accepted types are #AcceptedTypeList#"> 
```

然后，调用文件上传函数的任何东西都可以捕获`<cfcatch type="FileUpload">`或捕获特定的（例如`<cfcatch type="FileUpload.WrongType">`）。

此外，从技术上讲，破解密码的用户*超出*了您的控制范围，因为用户已经确定了密码的值。也就是说，我讨厌密码规则，因为它们总是使维护安全变得更难，而不是更容易。

# c# - C# - 当前上下文中不存在变量

> ID：10141579
> 
> 赞同：1
> 
> 时间：2012-04-13T13:18:21.133
> 
> 标签：c#, visual-studio, variables, scope, declare

我有一个似乎无法解决的问题。

我创建了一个名为 test 的类函数，并在函数中声明了一个变量。在下一行，我用一个字符串填充函数。

在调试期间变量没有被声明，我在 VS 中的变量观察器告诉我该变量在当前上下文中不存在。

大家能帮我解决这个问题吗？

这是我的代码：

```
public void Test()
{
    string DirectoryPath;
    DirectoryPath = System.Environment.GetFolderPath(System.Environment.SpecialFolder.InternetCache);
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-13T13:20:54.757

我的猜测是您使用的是 Release 配置 - 优化器可能已经删除了该变量，因为它除了用于调试之外毫无意义。你给它赋值，但从不读取它。在调试配置中，我希望它没问题（但可能会产生警告）。

编辑：当然，这是假设您*在*`Test()`看不到变量的方法中。如果`Test()`已经完成，那么 Likurg 的答案可能更合适。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T13:26:31.257

如果我没记错的话你想这样做

```
 public class MyTest
    {
        string DirectoryPath = "";
        public void Test()
        {
            DirectoryPath = System.Environment.GetFolderPath(System.Environment.SpecialFolder.InternetCache);
        }
        public void UseString()
        {
            //Use DirectoryPath
        }
    } 
```

# c++ - C++：使用向量/数组优化速度？

> ID：10141583
> 
> 赞同：12
> 
> 时间：2012-04-13T13:18:37.370
> 
> 标签：c++, vector

我有一个嵌套的 for 循环结构，现在我在每次迭代开始时重新声明向量：

```
void function (n1,n2,bound,etc){

    for (int i=0; i<bound; i++){
             vector< vector<long long> > vec(n1, vector<long long>(n2));
             //about three more for-loops here
    }
} 
```

这使我可以“重新开始”每次迭代，这非常有效，因为我的内部操作主要采用 vec[a][b] += some value 的形式。但我担心大 n1 或大 n2 会很慢。我不知道向量/数组/等的底层架构，所以我不确定处理这种情况的最快方法是什么。我应该改用数组吗？我应该以不同的方式清除它吗？我应该完全不同地处理逻辑吗？

编辑：向量的大小在技术上不会改变每次迭代（但它可能会根据函数参数而改变）。我只是想清除它/等，以便在所有其他情况下程序尽可能快。

编辑：

我的不同方法的结果：

```
Timings (for a sample set of data):
reclaring vector method: 111623 ms
clearing/resizing method: 126451 ms
looping/setting to 0 method: 88686 ms 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-13T13:23:50.270

我对小范围有明确的偏好（即，如果变量只在那里使用，则在最里面的循环中声明变量），但对于大范围，这可能会导致大量分配。

因此*，如果*此循环是一个性能问题，请尝试在循环外声明变量并仅在循环内将其清除 - 但是，这只有在向量的（保留）大小保持相同时才有优势。如果您正在调整向量的大小，那么无论如何您都会得到重新分配。

不要使用原始数组——它不会给你任何好处，只会给你带来麻烦。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-13T13:48:57.527

这是一些测试几种不同方法的代码。

```
#include <chrono>
#include <iostream>
#include <vector>

int main()
{
  typedef std::chrono::high_resolution_clock clock;

  unsigned n1 = 1000;
  unsigned n2 = 1000;

  // Original method
  {
    auto start = clock::now();
    for (unsigned i = 0; i < 10000; ++i)
    {
      std::vector<std::vector<long long>> vec(n1, std::vector<long long>(n2));
      // vec is initialized to zero already

      // do stuff
    }
    auto elapsed_time = clock::now() - start;

    std::cout << elapsed_time.count() << std::endl;
  }

  // reinitialize values to zero at every pass in the loop
  {
    auto start = clock::now();
    std::vector<std::vector<long long>> vec(n1, std::vector<long long>(n2));
    for (unsigned i = 0; i < 10000; ++i)
    {
      // initialize vec to zero at the start of every loop
      for (unsigned j = 0; j < n1; ++j)
        for (unsigned k = 0; k < n2; ++k)
            vec[j][k] = 0;

      // do stuff
    }
    auto elapsed_time = clock::now() - start;

    std::cout << elapsed_time.count() << std::endl;
  }

  // clearing the vector this way is not optimal since it will destruct the
  // inner vectors
  {
    auto start = clock::now();
    std::vector<std::vector<long long>> vec(n1, std::vector<long long>(n2));
    for (unsigned i = 0; i < 10000; ++i)
    {
      vec.clear();
      vec.resize(n1, std::vector<long long>(n2));

      // do stuff
    }
    auto elapsed_time = clock::now() - start;

    std::cout << elapsed_time.count() << std::endl;
  }

  // equivalent to the second method from above
  // no performace penalty
  {
    auto start = clock::now();
    std::vector<std::vector<long long>> vec(n1, std::vector<long long>(n2));
    for (unsigned i = 0; i < 10000; ++i)
    {
      for (unsigned j = 0; j < n1; ++j)
      {
        vec[j].clear();
        vec[j].resize(n2);
      }

      // do stuff
    }
    auto elapsed_time = clock::now() - start;

    std::cout << elapsed_time.count() << std::endl;
  }
} 
```

**编辑**：我更新了代码以在方法之间进行更公平的比较。 **编辑2**：稍微清理一下代码，方法2或4是要走的路。

以下是我电脑上上述四种方法的时序：

```
16327389
15216024
16371469
15279471 
```

关键是您应该尝试不同的方法并*分析*您的代码。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-04-13T13:29:25.790

选择容器时，我通常使用此图来帮助我：

![在此处输入图像描述](../Images/626e131a92b546639d7267ed7aea2f88.png)

[来源](https://stackoverflow.com/questions/471432/in-which-scenario-do-i-use-a-particular-stl-container)

* * *

除此之外，

就像之前发布的那样，如果这会导致性能问题，请在 for 循环之外声明容器，并在每次迭代开始时将其清除

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-13T13:28:42.657

为什么不这样：

```
{
    vector< vector<long long> > vec(n1, vector<long long>(n2));

    for (int i=0; i<bound; i++){

         //about three more for-loops here

         vec.clear();
    }
} 
```

**编辑**：添加范围大括号;-)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-13T13:28:57.147

除了之前的评论：

如果你使用 Robinson 的交换方法，你可以通过异步处理交换来更快。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-13T13:31:00.987

好吧，如果您真的很关心性能（并且您事先知道大小`n1`和大小`n2`）但不想使用 C 样式数组，`std::array`那么可能是您的朋友。

编辑：鉴于您的编辑，它似乎`std::array`不是一个合适的替代品，因为虽然向量大小不会改变每次迭代，但在编译之前它仍然未知。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-13T14:40:32.247

由于每次迭代都必须将向量值重置为 0，因此实际上，这个问题归结为“与循环内的计算相比，为向量分配和取消分配内存的成本是便宜还是昂贵”。

假设计算是算法中昂贵的部分，那么您编写它的方式既清晰、简洁，又显示了预期的范围，并且可能与替代方法一样快。

*但是，如果*您的计算和更新非常快并且向量的分配/释放相对昂贵，您可以使用`std::fill`在循环的每次迭代结束/开始时将零填充回数组。

当然，唯一确定的方法是使用分析器进行测量。我怀疑您会发现您采用的方法不会显示为任何类型的热点，您应该保留明显的代码。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-04-13T13:25:35.560

使用向量与数组的开销很小，尤其是当您从向量中获得很多有用的功能时。在内部，向量分配一个数组。所以矢量是要走的路。

# python - 在 Python 中将三角形作为输入

> ID：10141588
> 
> 赞同：0
> 
> 时间：2012-04-13T13:18:49.853
> 
> 标签：python

我正在尝试创建一个三角形，该三角形接受用户输入的值，并且希望从这些值中找到这些输入中的最大路径。我最初问了这个问题以找到最大路线：[Finding the Maximum Route in a given input](https://stackoverflow.com/questions/10053540/finding-the-maximum-route-in-a-given-input)

代码：

```
def triangle(rows):
    for rownum in range (rows):
        PrintingList = list()
        print ("Row no. %i" % rownum)
        for iteration in range (rownum):
            newValue = input("Please enter the %d number:" %iteration)
            PrintingList.append(int(newValue))
            print()
def routes(rows,current_row=0,start=0):
    for i,num in enumerate(rows[current_row]):
        #gets the index and number of each number in the row
        if abs(i-start) > 1:   # Checks if it is within 1 number radius, if not it skips this one. Use if not (0 <= (i-start) < 2) to check in pyramid
            continue
        if current_row == len(rows) - 1: # We are iterating through the last row so simply yield the number as it has no children
            yield [num]
        else:
            for child in routes(rows,current_row+1,i): #This is not the last row so get all children of this number and yield them
                yield [num] + child

numOfTries = input("Please enter the number of tries:")
Tries = int(numOfTries)
for count in range(Tries):
    numstr= input("Please enter the height:")
    rows = int(numstr)
    triangle(rows)
    routes(triangle)
    max(routes(triangle),key=sum) 
```

输入三角形的所有值后出现的错误：

```
Traceback (most recent call last):
  File "C:/Users/HP/Desktop/sa1.py", line 25, in <module>
    max(routes(triangle),key=sum)
  File "C:/Users/HP/Desktop/sa1.py", line 10, in routes
    for i,num in enumerate(rows[current_row]): #gets the index and number of each number in the row
TypeError: 'function' object is not subscriptable 
```

我的代码中的错误在哪里？需要一些帮助..谢谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T13:21:53.567

您正在使用：

```
routes(triangle) 
```

该`triangle`名称指的是一个函数，该函数作为第一个参数传递`rows`给 function `routes`。在函数体中，`rows[current_row]`产生错误，因为`rows`它确实是一个函数。

我真的不明白你想做什么。也许您想`PrintingList`从函数返回`triangles`并将此结果依次传递给函数`routes`？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T13:26:33.000

您可能正在尝试获取在函数内部创建的 的值作为函数`PrintingList`内部的变量。`triangle``rows``routes`

为了让您的程序以这种方式工作，您必须在三角形函数中添加一个 return 语句 - 也就是说，添加 a`return PrintingList`作为最后一个语句 - 并在调用函数时存储此值，并将存储的值传递给`routes`函数 - 这意味着，你的程序的结尾应该是这样的：

```
result = triangle(rows)
routes(result)
max(routes(triangle),key=sum) 
```

这将解决*这个*问题，上面的代码中可能还有其他问题。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-04-13T13:23:38.950

正如回溯所述，它在第 25 行和第 10 行。它是说该函数不可下标，这是真的，你不能订阅一个函数。但是，您可以订阅：

```
String:  "x"[2] == "foo"
Tuple:   (2,5,2,7)[3] == 7
List:    [1,2,3,"foo"][3] == "foo"
Dict:    {"a":1, "b":5, "c":5}["a"] == 1 
```

# soundcloud - 当我使用令牌时，Soundcloud API 错误 401 比我得到它之后

> ID：10141591
> 
> 赞同：0
> 
> 时间：2012-04-13T13:18:59.663
> 
> 标签：soundcloud

我想了解为什么我得到“请求的 URL 以 HTTP 代码 401 响应”。当我尝试使用访问令牌进行描述时。

奇怪的是，当我从用户那里获得 access_token （会话）之后，它工作得很好，但是当我存储令牌并稍后尝试启动相同的代码时，它会失败！

显然，令牌有问题，因为我可以在没有令牌的情况下访问 soundcloud 描述，但是如果我使用此方法： $soundcloud->setAccessToken($token); 在获取曲目数据之前，我无法再访问它们了...

这是代码：

```
require_once 'soundcloud/Soundcloud.php';
$soundcloud = new Services_Soundcloud(SOUNDCLOUD_CLIENT_ID, SOUNDCLOUD_CLIENT_SECRET, SOUNDCLOUD_REDIRECT_URI);
$soundcloud->setAccessToken($session_token);
try
{
    $track = json_decode($soundcloud->get('tracks/'.$media_id), true);
}
catch (Services_Soundcloud_Invalid_Http_Response_Code_Exception $e)
{
    exit($e->getMessage());
}
try
{
    $response = json_decode($soundcloud->put(
                                     'tracks/'.$media_id,
                                              'test',
                                               array(CURLOPT_HTTPHEADER => array('Content-Type: application/xml'))), true);
}
catch (Services_Soundcloud_Invalid_Http_Response_Code_Exception $e)
{
    exit($e->getMessage());
} 
```

此代码在我刚获得令牌时有效，但如果我在几天后启动它就会失败......

感谢帮助 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T23:34:40.807

在这个例子中 $session_token 来自哪里？根据您生成访问令牌的方式，会发生以下两种情况之一：

1.  您没有发送正确的访问令牌。
2.  您发送的访问令牌已过期。

如果是 2，那么当用户授权您的应用时，您应该已经获得了一个刷新令牌。PHP SoundCloud SDK 有一个 accessTokenRefresh() 方法，您可以在此场景中使用该方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-01T19:27:28.470

您需要一个不会过期的令牌。

授权时，参数`scope`默认为`"*"`.

指定范围并检索令牌，如下所示：

```
$soundcloud->getAuthorizeUrl(array('scope'=>'non-expiring')) 
```

请参阅：http: [//developers.soundcloud.com/docs/api/reference#connect](http://developers.soundcloud.com/docs/api/reference#connect)

（很老的问题，但我自己也遇到过这个问题。当令牌过期时，除了 401 错误之外，您不会从 API 获得反馈，让您一无所知。）

# jetty - 如何让 Jetty 使用 JVM 范围的 JNDI？

> ID：10141599
> 
> 赞同：0
> 
> 时间：2012-04-13T13:19:33.270
> 
> 标签：jetty, jndi, jackrabbit, maven-jetty-plugin

我正在尝试为 Jetty 中的 Jackrabbit 存储库工厂设置 JNDI 资源。问题是我似乎将 JNDI 作为 webapp 范围。我需要它是 JVM 范围的。据我从文档中了解到的，您需要指定一个空参数，如下所示 ( `<Arg></Arg>`) 才能执行此操作（[在此处](http://wiki.eclipse.org/Jetty/Feature/JNDI#Setting_JNDI_Entries_as_Global_or_Scoped)解释）。

我有两个 webapps 部署到 Jetty，我需要它们共享相同的 JNDI。如果他们不共享它，Jackrabbit 会尝试初始化两次并失败，这会破坏我的整个应用程序。

我通过调试器运行代码，我可以看到第一个被访问并需要 JNDI 查找 Jackrabbit 存储库的 web 应用程序，获取 的实例`BindableRepositoryFactory`并将记录正确添加到`cache`对象。`cache`但是，为JNDI 查找创建了一个完全不同的对象。这显然仍然是空的，因此创建了一个新实例，这把事情搞砸了。

我正在使用码头 7.6.2.v20120308。这是我的 jetty-jndi.xml：

```
<New class="org.eclipse.jetty.plus.jndi.Resource">
    <Arg></Arg>
    <Arg>jndi:comp/env/jcr/repository</Arg>
    <Arg>
        <New class="javax.naming.Reference" id="reference">
            <Arg>javax.jcr.Repository</Arg>
            <Arg>org.apache.jackrabbit.core.jndi.BindableRepositoryFactory</Arg>
            <Arg>null</Arg>
            <Call name="add" id="reference">
                <Arg>
                    <New class="javax.naming.StringRefAddr">
                        <Arg>configFilePath</Arg>
                        <Arg><SystemProperty name="jetty.home" default="."/>/jackrabbit/repository.xml</Arg>
                    </New>
                </Arg>
            </Call>
            <Call name="add" id="reference">
                <Arg>
                    <New class="javax.naming.StringRefAddr">
                        <Arg>repHomeDir</Arg>
                        <Arg><SystemProperty name="jetty.home" default="."/>/jackrabbit</Arg>
                    </New>
                </Arg>
            </Call>
        </New>
    </Arg>
</New> 
```

在我从中调用 jetty 的 pom 文件中，我有以下相关设置告诉 Jetty 使用 JNDI 和 Plus 设置 xml-s：

```
<jettyConfig>${project.build.directory}/jetty/etc/jetty-plus.xml,${project.build.directory}/jetty/etc/jetty-jndi.xml</jettyConfig> 
```

在 jetty-plus.xml 我有：

```
<!-- =========================================================== -->
<!-- Sequence of configurations to defining Plus features.       -->
<!-- =========================================================== -->
<Array id="plusConfig" type="java.lang.String">
    <Item>org.eclipse.jetty.webapp.WebInfConfiguration</Item>
    <Item>org.eclipse.jetty.webapp.WebXmlConfiguration</Item>
    <Item>org.eclipse.jetty.webapp.MetaInfConfiguration</Item>
    <Item>org.eclipse.jetty.webapp.FragmentConfiguration</Item>
    <Item>org.eclipse.jetty.plus.webapp.EnvConfiguration</Item>        <!-- Add for JNDI -->
    <Item>org.eclipse.jetty.plus.webapp.PlusConfiguration</Item>       <!-- Add for JNDI -->
    <Item>org.eclipse.jetty.annotations.AnnotationConfiguration</Item>
    <Item>org.eclipse.jetty.webapp.JettyWebXmlConfiguration</Item>
    <Item>org.eclipse.jetty.webapp.TagLibConfiguration</Item>          <!-- Not needed for Jetty-8 -->
</Array>

<!-- =========================================================== -->
<!-- Apply plusConfig to all webapps for this Server             -->
<!-- =========================================================== -->
<Call name="setAttribute">
    <Arg>org.eclipse.jetty.webapp.configuration</Arg>
    <Arg>
        <Ref id="plusConfig"/>
    </Arg>
</Call> 
```

有什么想法我可能做错了吗？

提前谢谢了！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T16:41:05.827

这似乎是 Jetty 的全局 JNDI 资源配置中的一个错误。

我在[Jetty 的 bugzilla](https://bugs.eclipse.org/bugs/show_bug.cgi?id=376746)中提交了一个错误，并且会接受这个答案是正确的，尽管事实上它不是解决方案。

# prolog - 如何在 Prolog 中取反

> ID：10141600
> 
> 赞同：12
> 
> 时间：2012-04-13T13:19:33.727
> 
> 标签：prolog

我是 PROLOG 的新手，并且在[本页](https://sites.google.com/site/prologsite/prolog-course/a-first-glimpse)练习的最开始。给定规则父（X，Y）和男性（X），我试图将规则母亲（X，Y）定义为

```
mother(X, Y) :-
    not(male(X)),
    parent(X, Y). 
```

但是，在 GNU Prolog 中，我收到以下错误：

```
| ?- mother(lina, julia).
uncaught exception: error(existence_error(procedure,not/1),mother/2)
| ?- 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-13T13:23:06.370

`\+/1`是“否定”的 ISO Prolog 谓词。请注意，“否定”是指此时无法证明。

您可以参考@false 提供的[这个出色的答案](https://stackoverflow.com/questions/8523608/logical-not-in-prolog/8523825#8523825)，以了解有关该主题的更多信息

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-04-13T13:27:10.953

解决方案实际上在该页面的练习文件中：

```
female(X) :- \+ male(X). 
```

正如@Mog 所说，否定是一元运算`\+`符。

# python - 在 Python 中查找和替换逻辑

> ID：10141603
> 
> 赞同：0
> 
> 时间：2012-04-13T13:19:46.940
> 
> 标签：python, python-2.7

在 python 中，我需要一个逻辑来处理下面的场景，我对此使用了 split 函数。我有包含输入的字符串，如下所示。

> “ID674021384 25/01/1986 heloo hi 感谢 5 分钟和 25-01-1988。”
> 
> “ID909900000 25-01-1986 你好 10 分钟。”

输出应如下所示，将日期格式替换为“日期”，将时间格式替换为“时间”。

> “ID674021384 日期你好你好谢谢时间日期。”
> 
> “ID909900000 日期你好时间。”

而且我还需要计算每个 ID 的日期和时间，如下所示

> ID674021384 日期：2 时间：1
> 
> ID909900000 日期：1 时间：1

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T14:48:45.270

```
>>> import re
>>> from collections import defaultdict
>>> lines = ["ID674021384 25/01/1986 heloo hi thanks 5 minutes and 25-01-1988.", "ID909900000 25-01-1986 hello 10 minutes."]
>>> pattern = '(?P<date>\d{1,2}[/-]\d{1,2}[/-]\d{4})|(?P<time>\d+ minutes)'
>>> num_occurences = {line:defaultdict(int) for line in lines}
>>> def repl(matchobj):
        num_occurences[matchobj.string][matchobj.lastgroup] += 1
        return matchobj.lastgroup

>>> for line in lines:
        text_id = line.split(' ')[0]
        new_text = re.sub(pattern,repl,line)    
        print new_text
        print '{0} DATE:{1[date]} Time:{1[time]}'.format(text_id, num_occurences[line])
        print ''

ID674021384 date heloo hi thanks time and date.
ID674021384 DATE:2 Time:1

ID909900000 date hello time.
ID909900000 DATE:1 Time:1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T13:44:03.117

为了解析类似的文本行，比如日志文件，我经常使用该`re`模块使用正则表达式。虽然`split()`也可以很好地分隔不包含空格和日期部分的字段，但使用正则表达式还可以确保格式符合您的期望，并且如果需要警告您奇怪的输入行。

使用正则表达式，您可以获取日期和时间的各个字段，并从中构造`date`或`datetime`对象（均来自`datetime`模块）。拥有这些对象后，您可以将它们与其他类似对象进行比较并编写新条目，并根据需要格式化日期。我建议解析整个输入文件（假设您正在读取一个文件）并编写一个全新的输出文件，而不是尝试就地更改它。

至于跟踪日期和时间计数，当您的输入不是太大时，使用字典通常是最简单的方法。当您遇到具有特定 ID 的行时，在您的字典中找到与该 ID 对应的条目，如果没有，则添加一个新条目。这个条目本身可以是一个使用日期和时间作为键的字典，其值是每个遇到的计数。

我希望这个答案能指导您找到解决方案，即使它不包含任何代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T14:41:33.463

You could use a couple of regular expressions:

```
import re

txt = 'ID674021384 25/01/1986 heloo hi thanks 5 minutes and 25-01-1988.'

retime = re.compile('([0-9]+) *minutes')
redate = re.compile('([0-9]+[/-][0-9]+[/-][0-9]{4})')

# find all dates in 'txt'
dates = redate.findall(txt)
print dates

# find all times in 'txt'
times = retime.findall(txt)
print times

# replace dates and times in orignal string:
newtxt = txt
for adate in dates:
    newtxt = newtxt.replace(adate, 'date')

for atime in times:
    newtxt = newtxt.replace(atime, 'time') 
```

The output looks like this:

```
Original string:
ID674021384 25/01/1986 heloo hi thanks 5 minutes and 25-01-1988.
Found dates:['25/01/1986', '25-01-1988']
Found times: ['5']

New string:
ID674021384 date heloo hi thanks time minutes and date.

Dates and times found:
ID674021384 DATE:2 TIME:1 
```

Chris

# c# - 如何使用 C# 启用/禁用计划任务？

> ID：10141604
> 
> 赞同：3
> 
> 时间：2012-04-13T13:19:47.220
> 
> 标签：c#, .net, c#-4.0, scheduled-tasks, windows-xp-sp3

使用 C# (.net Framework 4.0) 和 Windows XP 是否可以通过编程方式启用/禁用计划任务？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T13:23:14.017

使用[任务计划程序托管包装器](http://taskscheduler.codeplex.com/)：

> 该项目为 Windows 98 之后的所有 Microsoft 操作系统中的 1.0 和 2.0 版本的任务计划程序提供了单个程序集包装器。它简化了编码，聚合了多个版本，提供了一个编辑器并允许本地化支持。

# c# - 在 C# 中，当一个字段可能是字符串或字符串数 组时，如何反序列化此 json？

> ID：10141610
> 
> 赞同：4
> 
> 时间：2012-04-13T13:20:26.027
> 
> 标签：c#, json, deserialization, javascriptserializer

我有一个 asp.net-mvc 网站，我正在从数据库中读取 Json 字符串。这是数据库中的以下 json。它可能看起来像这样：

```
{"description": "Test", "contacts": ["joe@gmail.com", "bill@yahoo.com"], "enabled": true} 
```

或这个：

```
{"description": "Test", "contacts": "joe@gmail.com, bill@yahoo.com", "enabled": true} 
```

如您所见，联系人字段是：

1.  一个字符串（项目以逗号分隔）
2.  一个字符串数组。

我想转换为这个类：

```
public class MyJob
{
    public string description;
    public string[] contacts;
    public string enabled;
} 
```

当我尝试使用 JavascriptSerializer() 仅分配给一个字符串（将上面的内容更改为此：公共字符串联系人；）时：

```
var serializer = new JavaScriptSerializer();
string contacts = serializer.Deserialize<MyJob>(theAboveJsonString).contacts; 
```

在数组的情况下出现此错误：**类型'System.String'不支持数组的反序列化。**

反序列化处理以下情况的最佳方法是什么：

1.  一个字符串
2.  一个字符串数组。

对于联系人字段。我很乐意提出任何需要的条件逻辑。.

我试过这个：

```
 var contacts = serializer.Deserialize<MyJob>(theAboveJsonString).contacts;
        if (contacts is string)
        {
            jobInfo.contacts = contacts;
        }
        else
        {
            jobInfo.contacts = String.Join("; ", contacts );
        } 
```

但这似乎没有解决，因为当它是一个数组时我仍然收到上面的错误

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T13:50:24.517

尝试

```
 var contacts = (new JavaScriptSerializer().DeserializeObject(theAboveJsonString) as Dictionary<string, object>)["contacts"];

  if (contacts is object[])
  {
      jobInfo.contacts = String.Join("; ", contacts as object[]);
  }
  else
  {
      jobInfo.contacts = contacts.ToString(); 
  } 
```

有关参考，请参阅[MSDN](http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.deserializeobject.aspx)和[此处](https://stackoverflow.com/questions/8350169/using-javascriptserializer-deserializeobject-how-can-i-get-back-a-dictionary-tha)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T13:47:58.590

您可能对这里的一些细节感兴趣：[JSON.net - field is either string or List<string>](https://stackoverflow.com/questions/10121804/json-net-field-is-either-string-or-liststring/10122284#10122284)

如果你愿意使用 Json.NET，有这个功能：

```
public string[] getAsArray(JToken token)
{
    if (token.HasValues)
    {
        return token.Select(m => string(m)).ToArray();
    }
    else
    {
        return ((string)token).Split(",").Select(s => s.Trim()).ToArray();
    }
} 
```

然后用法：

```
var json = "...";
JObject o = JObject.Parse(json);
string[] contacts = getAsArray(o["contacts"]); 
```

对于任一 JSON，结果应该是相同的。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-04-13T13:32:31.093

尝试将联系人反序列化为字符串数组而不是纯字符串：

```
string[] contacts = serializer.Deserialize<MyJob>(theAboveJsonString).contacts; 
```

如果 JSON 变量包含纯字符串，请使用：

```
string[] contacts = serializer.Deserialize<MyJob>(theAboveJsonString).contacts.Split(','); 
```

# php - jQuery - 在 php 端发送数据并获取数据

> ID：10141617
> 
> 赞同：0
> 
> 时间：2012-04-13T13:20:58.547
> 
> 标签：php, javascript, jquery

这是我的 html 表单

```
{foreach value=artist2 from=$artist}

                  <form name=form1 method=post action=action_page.php onsubmit='return validate(this)'>

                <br />

                <span class="checkArtist" id="hide_{$artist2.MOVIE_ID}-{$artist2.PERSON_ID}-374"><input type="checkbox" name="artist[]" value="{$artist2.MOVIE_ID}-{$artist2.PERSON_ID}-374"  />{$artist2.NAME_SURNAME}<br /></span>

                {/foreach}
                <p align="right">
                <a style="float: right" ><br />
                    <input type="button" name="checkArtistButton" value="Seçilenleri Sil" onclick="deleteData('artist[]');" id="ajaxCheckbox" /></a></p>
                <br >
                  </form> 
```

在jQuery端

我取文本值和 id

```
 function AddData(par){

        var artistName =  $("input[name='"+par+"']").attr('id') + '-'+$("input[name='"+par+"']").val();

        alert(artistName);

       $.post('/management/AddDataAjax2', 
        {
           data: JSON.stringify({"artistName": "artistName"})
        },
        function(response){
            alert("Başarıyla silindi");
        });
    } 
```

正如您在上面的代码中看到的，当我发出警报时，我看到了所有需要的数据

![在此处输入图像描述](../Images/7139d4183ef71c9352ba800f2b38feb1.png)

我认为数据不会转到我的 php 端

这是我的 php 方面，但什么都没有

```
 public function AddDataAjax2() {

        $json = $_POST['json'];
        $data = json_decode($json, true);
        $arr = explode("-",$data);

        $personID = NCore::db('PERSON')->select('ID')->eq('NAME_SURNAME', $arr[2])->fetch(FETCH_MODEL_BASE, true);
            if($personID)
                NCore::db('PERSON_MOVIE')->insertAsArray(array('PERSON_ID' =>$personID->id,'MOVIE_ID'=> $arr[0],'JOB_ID' => $arr[1]));

     } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T13:27:33.063

在您的 PHP 代码中，您需要运行您的代码。你已经声明了你的函数，但你还没有调用它。您的 PHP 代码应如下所示：

```
<?php
    AddData2Ajax2();

     public function AddDataAjax2() {

            $json = $_POST['json'];
            $data = json_decode($json, true);
            $arr = explode("-",$data);

            $personID = NCore::db('PERSON')->select('ID')->eq('NAME_SURNAME', $arr[2])->fetch(FETCH_MODEL_BASE, true);
                if($personID)
                    NCore::db('PERSON_MOVIE')->insertAsArray(array('PERSON_ID' =>$personID->id,'MOVIE_ID'=> $arr[0],'JOB_ID' => $arr[1]));

         }
?> 
```

# java - 将私有方法更改为受保护的测试

> ID：10141626
> 
> 赞同：9
> 
> 时间：2012-04-13T13:21:51.660
> 
> 标签：java, junit

将私有方法更改为受保护的 JUNIT 测试是否是个好主意。？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-13T13:24:53.807

它有时很有用，是的。

如果该类是可扩展的，请确保将方法设为 final。

此外，记录该方法不应由同一包的子类或外部类调用的事实。

我使用 Guava @VisibleForTesting 注释来明确该方法实际上应该是私有的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-13T13:28:25.183

不，一般不会。单元测试的想法是测试……单元。或者换句话说，接口方法的实现。如果您想测试一个您无法“看到”的方法，这可能是代码异味。也许您还没有将业务逻辑与 UI 代码或其他东西充分分离。

所以最好的想法是重新考虑你的架构。但是，如果替代方案是不测试您的代码，那么保护这些方法是个好主意。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-13T13:25:24.013

您可以改为将方法包本地化。

您可以使用反射调用私有方法，或者您可以决定`private`不直接测试方法，只间接测试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-13T18:33:36.580

尽管您应该更喜欢按照@user714965 的建议进行重构，但 PowerMock 的[MockPrivate](http://code.google.com/p/powermock/wiki/MockPrivate)可以在不打开私有方法的可见性的情况下进行模拟。

首先编写测试通常会导致您不需要模拟私有方法的设计。

# ios - 如何在地图上显示两个坐标相同的注解？

> ID：10141628
> 
> 赞同：3
> 
> 时间：2012-04-13T13:21:56.920
> 
> 标签：ios

我有两个具有相同坐标的注释。我必须在地图上显示它们。当我在地图上添加这些注释时，我只看到一个图钉。如何显示两个注释而不是一个？或者如何通过单击图钉显示注释列表？有谁能够帮我？提前致谢。伊戈尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T13:37:33.133

当您尝试使用 MapKit 在地图上的同一坐标处显示多个注释时，通常它实际上会放置两个不同的图钉，但它们将位于完全相同的位置。但是，您可以比较阴影强度的差异以查看差异；看看单针的阴影，然后再看看你的双针阴影，你应该会看到后者看起来更暗。

就向您的用户指示有多个 pin 而言，您可以通过多种方式做到这一点。您可能会考虑在您的注释上实现`title`or`subtitle`属性以显示相同坐标处的注释数量（例如，设置`subtitle`为字符串`@"(and two more)"`或类似的）。然后，当点击标注附件视图时，将在该位置的注释表视图推送（到导航控制器堆栈上）。

# java - 在 MyEclipse 中安装 Windows Azure 插件时出现错误文件长度异常，安装到 Eclipse Indigo 时没有错误。建议？

> ID：10141632
> 
> 赞同：0
> 
> 时间：2012-04-13T13:22:08.187
> 
> 标签：java, eclipse, plugins, azure, myeclipse

我已经尝试在 MyEclipse 中安装 Windows Azure SKD+Plugin。我已经在 Eclipse Indigo 中毫无问题地完成了它，但是当我尝试在 MyEclipse 中使用相同的链接（http://dl.windowsazure.com/eclipse）时，我收到以下错误：

收集要安装的项目时发生错误会话上下文是：(profile=com.poweredbypulse.profile-0-rb-5513151-1330619618181, phase=com.genuitec.pulse2.client.common.download.PulseCollect,operand=, action =）。无法检索

org.eclipse.update.feature,com.persistent.winazure.eclipseplugin.feature,1.6.0.201201121023 无法检索工件；有关更多详细信息，请参阅日志 com.genuitech.pulse2.client.common.download.WrongFileLengthException：预计不会出现 9310；应该是 5237 无法检索

osgi.bundle,com.microsoft.sqljdbc4.ui,3.0.1301.202 无法检索工件；有关更多详细信息，请参阅日志 com.genuitech.pulse2.client.common.download.WrongFileLengthException: 16094 is not expected; 应该是 11614

错误似乎是 WrongFileLengthException，如何更正文件长度？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T16:04:00.347

在此处尝试 Azure 和 Eclipse 的设置说明；[http://www.windowsazure4e.org/download/](http://www.windowsazure4e.org/download/)

# php - Kohana 2.3.4 + LINUX - ErrorException [致命错误]：找不到类

> ID：10141636
> 
> 赞同：0
> 
> 时间：2012-04-13T13:22:16.890
> 
> 标签：php, linux, kohana, classnotfoundexception

我在我的 Linux 机器上的 Kohana 2.3.4 中遇到 Class not found 错误，但在 Windows 上一切正常。

我的 Windows 机器：

*   PHP 版本 5.2.9
*   Windows 7 终极版

我的 Linux 机器：

*   PHP 版本 5.3.2-1ubuntu4.15
*   Ubuntu 10.04

我收到此错误：

```
Fatal error: Class 'calafate_orm' not found in /home/jay/workspace/Facebook_App/application/helpers/user.php on line 514 
```

这就是我所说的模型：

```
 //controllers/user.php
   class User_Core{

        ...

       $fbuser = calafate_orm::factory('fbuser')->where('fbid', $user['id'])->find();

        ...
    } 
```

相同的代码在 Windows 上运行良好。

calafate_orm 是这样的：

```
//libraries/calafate_orm.php 
    <?php
abstract class calafate_orm_core extends ORM{
    protected $db = 'calafate';
    protected $table_names_plural = false;

    public function save(){
        $field          = ($this->id)?'modification_date':'creation_date';
        $this->$field   = date('Y-m-d H:i:s');
        parent::save();
    }

}
?> 
```

我所有的文件名都是小写的。

会发生什么？

提前致谢

固定的

库类名和文件名以大写字母开头。

将库重命名为 Calafate_orm 并像这样编辑类声明：

```
<?php
abstract class Calafate_orm_core extends ORM{
...
}?> 
```

就是这样。

感谢 hakre 为我指明了正确的方向。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T18:48:21.980

您应该在 Facebook_Model 中扩展 Model 而不是 Facebook。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T15:50:14.997

正如 hakre 在评论中所说以及[这里](http://docs.kohanaphp.com/general/libraries "图书馆")所说的“库类名和文件名以大写字母开头”

我将文件和类更改为以 C 开头，这解决了问题。

当我将项目移动到 Ubuntu 时，我将每个文件名都更改为小写，以防库错误。

感谢所有人，我希望这对未来的任何人都有帮助。

# asp.net - ASP.NET MVC EF 使用 Out 参数调用 MySQL 存储过程

> ID：10141637
> 
> 赞同：0
> 
> 时间：2012-04-13T13:22:19.637
> 
> 标签：asp.net, mysql, entity-framework, stored-procedures

我正在使用 Entity Framework ExecuteStoreQuery 来调用带有输出参数的 MySql 存储过程。存储过程还返回一个结果集。

我收到以下错误。

*例程 mydb.mysp 的 OUT 或 INOUT 参数 2 不是 BEFORE 触发器中的变量或 NEW 伪变量*

**怎么了？有没有更好的方法来调用 MySql sp 混合输出参数和结果集？**

**这是代码**

```
 var outParam = new MySqlParameter();
                outParam.ParameterName = "totalRowsOut";
                outParam.MySqlDbType = MySqlDbType.Int64;
                outParam.Direction = ParameterDirection.Output;

var data =  db.ExecuteStoreQuery<PropertySearchResultRow>
(
    "call mysp(@input1, @totalRowsOut);", 
    new MySqlParameter("input1", 10),
    outParam
);

var result = data.ToList();
int totalRowsCount = (int)outParam.Value; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T10:03:05.237

最后最终使用 ado.net MySqlCommand 调用存储的过程并获取输出值。Mysql 和 EF 集成不好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T13:26:29.427

您只需要指定存储过程的名称并传入参数即可。像这样的东西

```
var data =  db.ExecuteStoreQuery<PropertySearchResultRow>
(
    "mysp",new MySqlParameter("input1", 10),outParam
); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-10-12T19:39:28.210

这是我使用 VS2012 和 Mysql 连接器 6.8.3 的示例代码希望这对某人有所帮助

```
public static IList<MyClass> GetCustOrderHist(string someParameter)
    {
        IList<MyClass> data = ((IObjectContextAdapter)TestDashboardEntities).ObjectContext.ExecuteStoreQuery<MyClass>("CALL CustOrderHist({0});", someParameter).ToList();

        return data;
    }

    public class MyClass
    {
        public string ProductName { get; set; }
        public int TOTAL { get; set; }
    } 
```

# android - 检查 IPv6 是否可用的最佳方法

> ID：10141638
> 
> 赞同：1
> 
> 时间：2012-04-13T13:22:24.937
> 
> 标签：android, ipv6

检查当前安卓手机上是否有 IPv6 的最佳方法是什么？

我目前的想法是使用[`NetworkInterface`](http://developer.android.com/reference/java/net/NetworkInterface.html)和枚举 via [`NetworkInterface.getNetworkInterfaces()`](http://developer.android.com/reference/java/net/NetworkInterface.html#getNetworkInterfaces%28%29)，但这似乎太复杂了。

有没有更简单的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T14:53:30.960

如果您需要检查所有接口，我不知道比使用更简单的方法[`NetworkInterface`](http://docs.oracle.com/javase/6/docs/api/java/net/NetworkInterface.html)，但它不应该那么糟糕：

```
for(NetworkInterface netInt: NetworkInterface.getNetworkInterfaces()){
    for(InterfaceAddress address: netInt.getInterfaceAddresses()){
        if(address.getAddress() instanceof Inet6Address){
            // found IPv6 address
            // do any other validation of address you may need here
        }
    }
} 
```

如果您知道要检查的地址，则可以跳过使用`NetworkInterface`并`InetAddress`通过调用其中一个`InetAddress`静态[`getBy...()`](http://docs.oracle.com/javase/1.4.2/docs/api/java/net/InetAddress.html#getByAddress%28byte%5B%5D%29)方法来检查具体地址，并检查它是否是`Inet6Address`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-04-18T17:23:49.287

```
boolean isIPV6 = false;
Enumeration<NetworkInterface> networkInterfaces =
    NetworkInterface.getNetworkInterfaces();
while (networkInterfaces.hasMoreElements()) {
    NetworkInterface ni = networkInterfaces.nextElement();
    for (InterfaceAddress addr : ni.getInterfaceAddresses()) {
        if (addr.getAddress() instanceof Inet6Address) {
            isIPV6 = true;
        }
    }
} 
```

# continuous-integration - 将 DBDeploy.Net 与 Rake 一起使用

> ID：10141640
> 
> 赞同：1
> 
> 时间：2012-04-13T13:22:27.353
> 
> 标签：continuous-integration, rake, dbdeploy

我们正在尝试使用 DBDeploy.Net 在 .Net 项目中管理我们的 SQL 脚本。我们还使用 Rake 脚本进行自动构建。我找不到任何关于如何将 DBDeploy.Net 与 Rake 一起使用的文档。有没有让 DBDeploy 与 Rake 一起工作的好方法？（我不想为 DBDeploy 创建一个 NAnt 脚本并从 Rake 调用它）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T14:09:58.747

dbdeploy.NET 命令行执行的文档已添加到[https://github.com/brunomlopes/dbdeploy.net#command-line](https://github.com/brunomlopes/dbdeploy.net#command-line)。还添加了许多新功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T13:32:06.660

DbDeploy.net 是否有命令行运行程序。如果是这样，请查看[Albacore](https://github.com/derickbailey/Albacore/wiki/exec-task)的 ExecTask 。如果您刚刚开始使用 DbDeploy.net 并且对选项持开放态度，请查看[FluentMigrator](http://lostechies.com/seanchambers/2011/04/02/fluentmigrator-getting-started/)。它有一个命令行运行器。

# django - Django Crispy Forms - 通过 Helper 添加按钮

> ID：10141643
> 
> 赞同：3
> 
> 时间：2012-04-13T13:22:47.587
> 
> 标签：django, forms, button, helper, django-crispy-forms

我研究了 Crispy-Forms 文档，并尝试在我的一个表单中添加一个额外的按钮。和

```
self.helper.add_input(Button('back', "Back", css_class='btn')) 
```

我可以添加一个漂亮的按钮。但是 Button() 不会采用 onclick 或 on_click 属性。那么如何为这个按钮添加逻辑呢？使用 JQuery 添加 onclick 事件不是一个很好的解决方案......

谢谢！

罗恩

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-20T09:12:06.673

您确定 Button 不会在其 kwargs 中使用 onclick 吗？

我刚刚`onclick="javascript here"`向一个`Submit()`元素添加了一个，它显示得很好。

我还仔细研究了底层代码，我认为默认情况下所有输入都会展平由于特殊用途（即模板）而未弹出的 kwarg，并将它们传递到呈现的 HTML 中。这可能是自 12 年 4 月（最初发布时）以来的新内容，但目前似乎很简单，如下所示：

```
self.helper.add_input(Button('back', "Back", css_class='btn', onclick="alert('Neat!');")) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T08:31:54.917

默认情况下不包括在内（afaik ..）。如果你只需要一次，可以使用crispy-forms HTML [Layout Object](http://django-crispy-forms.readthedocs.org/en/latest/tags.html#layouts)

```
HTML('<input type="button" name="Save" onclick="do_whatever" />') 
```

那么你不喜欢使用 jQuery 吗？您可以使用以下方法来处理这个相当简单和通用的问题：

```
$('form :submit.ajax_submit').live('click', function(e) {
    e.preventDefault();
    var my_form = $(this).parents('form');

    // do whatever
    alert(my_form.attr('id'));
    alert(my_form.attr('action'));
}); 
```

然后就通过课程：

```
Submit('save', 'save', css_class='ajax_submit') 
```

# java - Guice：类或实例级别的绑定注解

> ID：10141646
> 
> 赞同：0
> 
> 时间：2012-04-13T13:23:06.307
> 
> 标签：java, dependency-injection, guice

Guice 提供了所谓的**绑定注解**的两种变体，它们似乎真的分解为类和实例级别的注解：

“班级级别”：

```
bind(Service.class).annotatedWith(Red.class).to(RedServiceImpl.class);

@Red
public class SomeService implements Service { ... }

Service redSvc = injector.getInstance(SomeService.class); 
```

“实例级”：

```
bind(Service.class).annotatedWith(Names.named("Blue").to(BlueServiceImpl.class);
@Blue blueSvc = injector.getInstance(Service.class); 
```

什么时候一种方法优先于另一种？似乎类级别的注释比实例级别的更绝对/不灵活。任何一种方法的优点/缺点/警告/陷阱？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T04:08:57.303

我不确定我是否理解你的问题。您对绑定注释的使用是不规则的。您通常不会注释局部变量或类，而是注释字段和参数。

您的第一个代码示例*将*导致注入器返回 SomeService，但不是因为您的注释或绑定，而是因为 SomeService 是一个具体的实现。您是否要求这样做：

```
Service redSvc = injector.getInstance(Service.class); 
```

你会得到一个错误：

```
1) No implementation for com.example.Service was bound.
  while locating com.example.Service 
```

你的第二个例子也不正确。如果使用`Names`来定义绑定，则必须使用`@Named`来访问该绑定。使用`@Blue`会导致编译器错误。正确的用法是`@Named(value="Blue")`.

绑定注释的常见最佳实践是：

```
@BindingAnnotation
@Target({ FIELD, PARAMETER, METHOD })
@Retention(RUNTIME)
public @interface MyAnno 
```

在这种情况下，这两个都是编译错误：

```
@Red // not allowed
public class SomeService implements Service { ... }

@Blue // not allowed
blueSvc = injector.getInstance(Service.class); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T14:37:24.510

唯一真正的区别是，在一种情况下，您绑定整个注释，而在另一种情况下，您绑定到具有特定参数的注释。并非所有注解都带有参数，在这种情况下，与注解类绑定是完全正常的。

# java - 带参数的并发 JUnit 测试

> ID：10141648
> 
> 赞同：3
> 
> 时间：2012-04-13T13:23:08.627
> 
> 标签：java, concurrency, selenium, junit, parallel-processing

所以我正在尝试运行并行参数化测试。我有一个解决方案，其中相同的测试可以与提供的参数并行运行，例如说我有以下内容：

```
@Test
public void someTest1(){
}

@Test
public void someTest2(){
} 
```

我可以让 someTest1() 同时运行所有参数，但是 someTest2() 仍然必须等待 someTest1() 在执行之前完成所有参数。我想知道是否有人知道能够同时运行带有所有参数的 someTest1() 和带有所有参数的 someTest2() 的解决方案？我尝试过[tempus-fugit concurrent test runner](http://tempusfugitlibrary.org/documentation/junit/parallel/)，它非常适合未参数化的测试......

下面是我当前并行运行每个参数测试的代码。

```
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.TimeUnit;

import org.junit.runners.Parameterized;
import org.junit.runners.model.RunnerScheduler;

/**
 * Class used from the following source:
 * http://jankesterblog.blogspot.com/2011/10
 * /junit4-running-parallel-junit-classes.html
 * 
 * @author Jan Kester
 * 
 */
public class Parallelized extends Parameterized {

    private static class ThreadPoolScheduler implements RunnerScheduler {
        private ExecutorService executor;

        public ThreadPoolScheduler() {
            String threads = System.getProperty("junit.parallel.threads", "16");
            int numThreads = Integer.parseInt(threads);
            executor = Executors.newFixedThreadPool(numThreads);
        }

        public void finished() {
            executor.shutdown();
            try {
                executor.awaitTermination(12, TimeUnit.HOURS);
            } catch (InterruptedException exc) {
                throw new RuntimeException(exc);
            }
        }

        public void schedule(Runnable childStatement) {
            executor.submit(childStatement);
        }
    }

    /**
     * Instantiates a new parallelized.
     * 
     * @param klass
     *            the klass
     * @throws Throwable
     *             the throwable
     */
    public Parallelized(Class<?> klass) throws Throwable {
        super(klass);
        setScheduler(new ThreadPoolScheduler());
    }
} 
```

下面的代码是一个示例测试，BaseSuite 不包含任何重要的内容。这些与 selenium 一起使用，因此它只设置 webDriver。getAllButOpera() 方法返回包含 Internet Explorer、Firefox 和 Chrome 的浏览器类型的集合。这些参数用于在firefox ie 和chrome 上同时运行相同的测试。我想在课堂上同时运行这两个测试，这是我遇到的问题。

```
import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertTrue;

import java.util.Collection;

import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.junit.runners.Parameterized.Parameters;
import org.openqa.selenium.WebDriver;

/**
 * The Class SampleSuite1.
 * 
 * @author Reid McPherson
 */
@RunWith(Parallelized.class)
public class SampleSuite1 {
    WebDriver driver;
    /**
     * Data.
     * 
     * @return the collection
     */
    @Parameters
    public static Collection<Object[]> data(){
          List<Object[]> browsers = new ArrayList<Object[]>();
    browsers.add(new String[]{"Firefox"});
    browsers.add(new String[]{"Chrome"});
    browsers.add(new String[]{"IE"});
    return browsers;
    }

    /**
     * Instantiates a new sample suite1.
     * 
     * @param type
     *            the type
     */
    public SampleSuite1(String type){
        switch (type) {
    case "FIREFOX":
        driver = new FirefoxDriver();
        break;
    case "IE":
        driver = new InternetExplorerDriver();
        break;
    case "CHROME":
        System.setProperty("webdriver.chrome.driver", PATHTOCHROMEEXE);
        driver = new ChromeDriver();
        break;
    case "OPERA":
        driver = new OperaDriver();
        break;
    default:
        throw new RuntimeException("Browser type unsupported");
    }
    // Set the timeout.
    driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);
    }

    /**
     * Sets the up.
     */
    @Before
    public void setUp() {
        driver.get("http://www.google.com");
    }

    /**
     * Test navigation succeeded.
     */
    @Test
    @TestDescription("Navigation Test")
    public void navigationShouldSucceed() {
        String pageSource = driver.getPageSource();
        assertTrue(pageSource.contains("Google"));
    }

    /**
     * Test title.
     */
    @Test
    @TestDescription("This method tests the web page title.")
    public void titleShouldBeGoogle() {
        assertEquals(driver.getTitle(), "Google");
    }

    @After
    public void finished(){
    driver.close();
    }

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-13T14:23:16.683

正如我所说，问题在于 JUnit 的实现。

你可以看到：

```
Parallelized extends Parametrized extends Suite extends ParentRunner 
```

另一方面：

```
ConcurrentTestRunner extends BlockJUnit4ClassRunner extends ParentRunner 
```

因此它们来自不同的继承层次。

现在您需要查看的是以下内容的实现：

```
org.junit.runners.ParentRunner#getChildren 
```

方法。对于 org.junit.runners.BlockJUnit4ClassRunner 它是：

```
protected List<FrameworkMethod> computeTestMethods() {
    return getTestClass().getAnnotatedMethods(Test.class);
} 
```

它生成所有带有注释的方法。但是对于 org.junit.runners.Parameterized 它是：

```
for (int i= 0; i < parametersList.size(); i++)
  runners.add(newtestClassRunnerForParameters(getTestClass().getJavaClass(),
                parametersList, i)); 
```

最后一个只提供课程。

建议：用`org.junit.runners.ParentRunner#getChildren from BlockJUnit4ClassRunner`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-17T16:17:31.490

感谢您的帮助，除了运行并发套件之外，我最终使用了[这里](http://code.google.com/p/jeeunit/source/browse/jeeunit-concurrent/src/test/java/com/googlecode/jeeunit/concurrent/test/MultithreadedTest.java)的代码，它使我能够同时运行测试，但它不会同时运行相同的测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-29T14:53:06.573

我也在使用 Jeeunit 的代码……但是即使是 1.0 版也有错误。

在 [ConcurrentRunnerScheduler](https://github.com/hwellmann/jeeunit/blob/master/jeeunit-concurrent/src/main/java/com/googlecode/jeeunit/concurrent/impl/ConcurrentRunnerScheduler.java)中，finished 方法必须被实现。

所以我只是拉取代码并像suiteFinished()方法一样实现它：

```
@Override
    public void finished() {
        try {
        while (!tasks.isEmpty())
            tasks.remove(completionService.take());
    }
    catch (InterruptedException e) {
        System.out.println("suite fin");
        Thread.currentThread().interrupt();
    }
    finally {
        while (!tasks.isEmpty())
            tasks.poll().cancel(true);
        executorService.shutdownNow();
    }

} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-20T03:33:24.700

这是我尝试过的，它对我来说非常有效。

```
public class ParallelTests {
   static ExecutorService eService ;
   public static void main(String[] args) {
      testA() ;
      testB() ;
      testC() ;
   }
   public static void testA() {
      eService = Executors.newCachedThreadPool() ;
      for (int i = 0 ; i < 10 ; i++) {
         TestA testA = new TestA() ;
         eService.execute(testA) ;
      }
      eService.shutdown() ;
      while(!eService.isShutDown()) {
      }
   }
//same for testB and testC
}

public class TestA implements Runnable {
    public TestA() {
    }
    @Test
    public myTest throws Throwable {
    }
} 
```

# c# - 在第一个标点符号处修剪字符串，不包括空格

> ID：10141653
> 
> 赞同：-1
> 
> 时间：2012-04-13T13:23:19.240
> 
> 标签：c#, asp.net

我正在寻找一种在不是空格的标点符号的第一个实例处修剪字符串的方法。

谢谢

[编辑] 我尝试了以下方法：

```
var length = input.IndexOf(@"[^\w\s]");

return input.Substring(0, length); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T13:26:34.027

```
string s = "Hello, world!";
string t = new string(s.TakeWhile(c => !Char.IsPunctuation(c)).ToArray()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T13:24:56.557

您正在寻找[`Char.IsPunctuation`](http://msdn.microsoft.com/en-us/library/6w3ahtyy.aspx). 然后只是索引的子字符串。

# scala - Scala不可变映射，什么时候可变？

> ID：10141654
> 
> 赞同：26
> 
> 时间：2012-04-13T13:23:22.890
> 
> 标签：scala, map, immutability, mutable, use-case

我目前的用例非常简单，可变或不可变 Map 都可以解决问题。

有一个采用不可变 Map 的方法，然后调用一个也采用不可变 Map 的第 3 方 API 方法

```
def doFoo(foo: String = "default", params: Map[String, Any] = Map()) {

  val newMap = 
    if(someCondition) params + ("foo" -> foo) else params

  api.doSomething(newMap)
} 
```

有问题的地图通常很小，最多可能有一个嵌入的案例类实例列表，最多几千个条目。因此，再次假设在这种情况下不可变影响不大（即通过 newMap val 副本基本上拥有 2 个 Map 实例）。

尽管如此，它还是让我有点烦，复制地图只是为了得到一张新地图，上面贴了一些 k->v 条目。

对于我想要附加的条目，我可以使用 mutable 和`params.put("bar", bar)`等，然后`params.toMap`为 api 调用转换为不可变的，这是一个选项。但是我必须导入和传递可变映射，与使用 Scala 的默认不可变映射相比，这有点麻烦。

那么，什么时候使用可变地图而不是不可变地图是合理/良好的做法的一般准则是什么？

谢谢

**编辑** 所以，在不可变地图上的添加操作似乎花费了几乎恒定的时间，证实了@dhg 和@Nicolas 的断言，即没有制作完整的副本，这解决了所提出的具体案例的问题。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-04-13T13:27:13.027

根据不可变 Map 的实现，添加一些条目实际上可能不会复制整个原始 Map。这是不可变数据结构方法的优点之一：Scala 会尽量避免复制。

这种行为最容易用`List`. 如果我有一个`val a = List(1,2,3)`，那么该列表将存储在内存中。但是，如果我在前面加上一个额外的元素`val b = 0 :: a`，我*会*得到一个新的 4 元素`List`，但 Scala 没有*复制*原始列表`a`。相反，我们只是创建了一个新链接，称为它`b`，并给它一个指向现有 List 的指针`a`。

您也可以为其他类型的集合设想类似的策略。例如，如果我向 a 添加一个元素`Map`，则该集合可以简单地包装现有地图，在需要时回退到它，同时提供一个 API，就好像它是单个`Map`.

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-04-13T15:00:28.850

使用可变对象本身并不坏，在函数式编程环境中它变得不好，在这种环境中，您试图通过保持函数纯净和对象不可变来避免副作用。

但是，如果您在函数内部创建一个可变对象并修改此对象，则如果您不在函数外部释放对该对象的引用，则该函数仍然是纯的。可以接受如下代码：

```
def buildVector( x: Double, y: Double, z: Double ): Vector[Double] = {
    val ary = Array.ofDim[Double]( 3 )
    ary( 0 ) = x
    ary( 1 ) = y
    ary( 2 ) = z
    ary.toVector
} 
```

现在，我认为这种方法在两种情况下有用/推荐：（1）性能，如果创建和修改不可变对象是整个应用程序的瓶颈；(2) 代码可读性，因为有时在原地修改复杂对象更容易（而不是求助于镜头、拉链等）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-13T13:50:40.337

除了 dhg 的回答，你可以看看[scala collections 的表现](http://www.scala-lang.org/docu/files/collections-api/collections.html)。如果添加/删除操作不需要线性时间，则它必须执行其他操作，而不仅仅是简单地复制整个结构。（请注意，反过来是不正确的：这不是因为复制整个结构需要线性时间）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-03T17:54:25.087

我喜欢使用 collections.maps 作为声明的参数类型（输入或返回值），而不是可变或不可变映射。Collections 映射是不可变的接口，适用于这两种类型的实现。使用地图的消费者方法实际上不需要了解地图的实现或它是如何构造的。（无论如何，这真的不关它的事）。

如果您采用向使用它的消费者隐藏地图的特定构造（无论是可变的还是不可变的）的方法，那么您仍然会在下游获得本质上不可变的地图。并且通过使用 collection.Map 作为不可变接口，您可以完全消除编写使用 immutable.Map 类型对象的消费者所具有的所有“.toMap”低效率。必须将一个完全构建的映射转换为另一个映射，以符合第一个不支持的接口，当您考虑它时，这确实是绝对不必要的开销。

我怀疑在几年后，我们将回顾三组独立的接口（可变映射、不可变映射和集合映射），并意识到 99% 的时间只有两个是真正需要的（可变和集合）和使用（不幸的是）默认的不可变映射接口确实为“可扩展语言”增加了许多不必要的开销。

# objective-c - 在屏幕保护程序中嵌入自定义字体

> ID：10141655
> 
> 赞同：1
> 
> 时间：2012-04-13T13:23:23.037
> 
> 标签：objective-c, cocoa, fonts, nsfont

我不知道如何在我的 Mac 屏幕保护程序中包含字体。我做了以下教程，[Embed font in a mac bundle](https://stackoverflow.com/questions/2444717/embed-font-in-a-mac-bundle/2444772#244477)，但我的 [NSFont fontWithName:size:] 仍然返回 null。我真的不知道从哪里开始。任何想法，解决方案？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T06:57:18.107

您遵循的示例适用于应用程序。问题是您正在构建屏幕保护程序包。这些不是应用程序本身，它们是由单独的应用程序加载的。显然，`ATSApplicationFontsPath`键，顾名思义，仅在加载应用程序时使用。

您必须编写代码来枚举捆绑包中的字体文件 URL 并注册它们。你可以使用`-[NSBundle URLsForResourcesWithExtension:subdirectory:]`and `CTFontManagerRegisterFontsForURLs()`。

# ninject - Ninject 级联构造函数参数

> ID：10141661
> 
> 赞同：1
> 
> 时间：2012-04-13T13:23:49.150
> 
> 标签：ninject

我有一个类型 IRoleRepository，它接受一个构造函数参数“数据库”，它接受一个 IDbRepository 类型，它本身接受一个构造函数参数“ConnectionStringName”。我有一个依赖解析器，它有一个 GetService 方法，虽然下面的代码有效，但我希望在 Bind 时间而不是在 Ninject 3.0 的 Get 时间有更好的方法来做到这一点。注意我可能有多个 IDBRepository 实例，每个实例都有自己的“ConnectionStringName”。

```
_repository = EngineContext.Current.GetService<IRoleRepository>(
                        new ConstructorArgument("database",
                            EngineContext.Current.GetService<IDbRepository>(
                                new ConstructorArgument(SystemConstants.ConnectionStringName, SystemConstants.ConfigurationDatabase)))); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T13:48:01.227

您可以使用`WithConstructorArgument`绑定来指定构造函数参数。

```
kernel.Bind<IDbRepository>().To<DbRepository>()
      .WithConstructorArgument(
           SystemConstants.ConnectionStringName, 
           SystemConstants.ConfigurationDatabase); 
```

或使用 ToConstructor()

```
kernel.Bind<IDbRepository>().ToConstructor(
    x => new DbRepository(
             SystemConstants.ConfigurationDatabase, 
             x.Inject<ISomeOtherDependency>()) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T14:08:20.563

好的，我相信我找到了我想要的：

通过在绑定时间使用它：

```
 Bind<IDbRepository>().To<SqlServerRepository>()
            .WhenInjectedInto<IRoleRepository>()
            .WithConstructorArgument(SystemConstants.ConnectionStringName, SystemConstants.ConfigurationDatabase); 
```

这使我可以在 Get 时间使用它：

```
_repository = EngineContext.Current.GetService<IRoleRepository>(); 
```

这当然意味着我现在可以根据要注入 IDbRepository 的更具体的存储库来改变 IDbRepository 的构造函数参数。例如：

```
 Bind<IDbRepository>().To<SqlServerRepository>()
            .WhenInjectedInto<ITimerJobStore>()
                .WithConstructorArgument(SystemConstants.ConnectionStringName, SystemConstants.ConfigurationDatabase);

        Bind<ITimerJobStore>().To<TimerJobSqlStore>(); 
```

# python - 如何在我的模板中使用用户上传的文件？(django)

> ID：10141668
> 
> 赞同：4
> 
> 时间：2012-04-13T13:24:13.247
> 
> 标签：python, django, file-upload, django-templates, media-url

到目前为止，我已经完成了用户上传图像的部分，但是如何使用位于我的媒体文件夹中的那些图像？这是我尝试过的：

我的观点：

```
#I even tried to import MEDIA_ROOT to use it in my template...
#from settings import MEDIA_ROOT

def home(request):
    latest_images = Image.objects.all().order_by('-pub_date')
    return render_to_response('home.html',
                             #{'latest_images':latest_images, 'media_root':MEDIA_ROOT},
                             {'latest_images':latest_images,},
                             context_instance=RequestContext(request)
                             ) 
```

我的模型：

```
class Image(models.Model):
    image = models.ImageField(upload_to='imgupload')
    title = models.CharField(max_length=250)
    owner = models.ForeignKey(User)
    pub_date = models.DateTimeField(auto_now=True) 
```

我的模板：

```
{% for image in latest_images %}
    <img src="{{ MEDIA_ROOT }}{{ image.image }}" width="100px" height="100px" />
{% endfor %} 
```

和我的 settings.py MEDIA_ROOT 和 URL：

```
MEDIA_ROOT = '/home/tony/Documents/photocomp/photocomp/apps/uploading/media/'
MEDIA_URL = '/media/' 
```

所以这就是我想要做的：在我的模板中使用这些图像！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-13T14:01:12.547

如果使用该`url`属性，`MEDIA_URL`则自动附加。如果`name`您想要没有`MEDIA_URL`. 所以你需要做的就是：

```
<img src="{{ some_object.image_field.url }}"> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-13T14:06:43.510

在开发机器上，您需要告诉开发服务器[提供上传的文件](https://docs.djangoproject.com/en/1.4/howto/static-files/#serving-other-directories)

```
# in urls.py
from django.conf import settings

if settings.DEBUG:
    urlpatterns += patterns('',
        url(r'^media/(?P<path>.*)$', 'django.views.static.serve', {
            'document_root': settings.MEDIA_ROOT,
        }),
    )

{# in template, use sorl-thumbnail if your want to resize images #}
{% with image.image as img %}
<img src="{{ img.url }}" width="{{ img.width }}" height="{{ img.height }}" />
{% endwith %}

# furthermore, the view code could be simplified as
from django.shortcuts import render
def home(request):
    latest_images = Image.objects.order_by('-pub_date')
    return render(request, 'home.html', {'latest_images':latest_images}) 
```

在使用普通文件系统存储的生产环境中，确保网络服务器具有写入 MEDIA_ROOT 的权限。还将网络服务器配置为`/media/filename`从正确的路径读取。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-13T13:32:30.343

ImageField() 有一个`url`属性，所以试试：

```
<img src="{{ MEDIA_URL }}{{ image.image.url }}" /> 
```

您还可以像这样向模型添加一个方法来跳过 MEDIA_ROOT 部分：

```
from django.conf import settings

class Image(...):

    ...

    def get_absolute_url(self):
        return settings.MEDIA_URL+"%s" % self.image.url 
```

我也会像这样使用 upload_to 来保持理智：

```
models.ImageField(upload_to="appname/classname/fieldname") 
```

试试这些设置：

```
import socket

PROJECT_ROOT = path.dirname(path.abspath(__file__))

# Dynamic content is saved to here
MEDIA_ROOT = path.join(PROJECT_ROOT,'media')

if ".example.com" in socket.gethostname():
    MEDIA_URL = 'http://www.example.com/media/'
else:
    MEDIA_URL = '/media/'

# Static content is saved to here
STATIC_ROOT = path.join(PROJECT_ROOT,'static-root') # this folder is used to collect static files in production. not used in development
STATIC_URL =  "/static/"
STATICFILES_DIRS = (
    ('', path.join(PROJECT_ROOT,'static')), #store site-specific media here.
)

STATICFILES_FINDERS = (
    'django.contrib.staticfiles.finders.FileSystemFinder',
    'django.contrib.staticfiles.finders.AppDirectoriesFinder',
) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-11-12T00:34:00.730

对于 Django 2.2 版，请尝试以下操作：

```
#You need to add the following into your urls.py  
from django.conf import settings
from django.conf.urls.static import static

urlpatterns = [
Your URL mapping
] + static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT) #add this  

# And then use this in your html file to access the uploaded image
<img src="{{ object.image_field.url }}"> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-13T13:30:00.063

您必须使包含上传图像的文件夹“可通过网络访问”，即要么使用 Django 从文件夹中提供静态文件，要么为此使用专用的网络服务器。

在您的模板代码中，您必须使用正确的`MEDIA_URL`值。

# css - 使用嵌套在另一个选择器/类中的 mixin

> ID：10141671
> 
> 赞同：3
> 
> 时间：2012-04-13T13:24:19.383
> 
> 标签：css, less, less-mixins

我正在尝试根据上下文使 Mixin 输出两种不同的东西。像这样：

```
.seticon(@r,@g,@b) {
    b {
        background-color: rgb(@r,@g,@b);
    }
    &.act b {
        .box-shadow(0 0 5px 1px rgba(@r,@g,@b,0.45));
    }
    &.act.hover b {
        background: #000;
        .box-shadow(inset 0 0 0 3px rgb(@r,@g,@b) !important;
    }
}

.nonreceivable {
    .seticon(@r,@g,@b) {
        b {
            background: #000 !important;
            .box-shadow(inset 0 0 0 2px rgb(@r,@g,@b));
        }
    }
} 
```

现在`.seticon`按预期工作，但`.nonreceivable .seticon`似乎不起作用。这是一个错误，还是我做错了什么，或者这不是 Less 开发人员的意图？你将如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T14:13:56.317

类是`nonreceivable`应用于同一个元素还是父元素？如果它是父母，它应该工作。否则，`&`在前面放一个`.section`

```
.nonreceivable {
 &.seticon(@r,@g,@b) {
    b {
        background: #000 !important;
        .box-shadow(inset 0 0 0 2px rgb(@r,@g,@b));
    }
}
} 
```

# javascript - 你如何在javascript中关闭一个窗口？

> ID：10141674
> 
> 赞同：1
> 
> 时间：2012-04-13T13:24:34.940
> 
> 标签：javascript, browser, client-side

我有一个 zend 框架项目，我正在页面中加载一些 javascript。如何从 javascript 代码中关闭该页面？

window.close() 仅在使用 window.open() 打开当前窗口/选项卡/页面时才有效，这不是我的情况，这不是解决方案。

还有其他解决方案吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-13T13:35:33.587

有办法做到这一点，但它们是“hack”ish。

出于安全原因，javascript 不能关闭它没有打开的窗口。但是，您可以使用一个技巧让浏览器认为您当前的窗口是由 javaScript 打开的：

```
window.open('', '_self', '');
window.close(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T13:26:27.787

不，没有其他解决方案

> 脚本不能关闭不是由脚本打开的窗口

[在MDN](https://developer.mozilla.org/en/DOM/window.close)上查看更多信息

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-01-16T00:26:03.283

试试这个：

**open("/", '_self').close();**

# jquery - 相对字体大小

> ID：10141677
> 
> 赞同：0
> 
> 时间：2012-04-13T13:24:38.710
> 
> 标签：jquery

我正在使用 jquery 通过使用简单的附加函数在 div 容器中构建一个元素，如下所示

```
$("#container").append("<label style='font-size:100%;'>ASAD</label>"); 
```

现在我使用相同的东西将相同的元素附加到主页正文，但我得到的两个字体大小相同。那是div里面的一个，body里面的一个。我想要的是在附加到 div 时获得相对于 div 的大小。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T13:30:37.180

W3C 推荐使用 em 大小单位。1em 等于当前字体大小。浏览器中的默认文本大小为 16 像素。因此，1em 的默认大小是 16px。

可以使用以下公式从像素到 em 计算大小：pixels/16=em

```
h1 {font-size:2.5em;} /* 40px/16=2.5em */
h2 {font-size:1.875em;} /* 30px/16=1.875em */
p {font-size:0.875em;} /* 14px/16=0.875em */ 
```

如何在 CSS
[http://www.alistapart.com/articles/howtosizetextincss/中调整文本大小](http://www.alistapart.com/articles/howtosizetextincss/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T13:26:18.537

你试过“字体大小：1em”吗？ems 也是一个相对测量单位。1em 表示与父元素大小相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-02-21T08:30:12.550

实现这一点的方法是使用**相对字体单位**，如**em**或**rem**。**em**字体单元取决于**容器的字体大小**，而**rem**单元取决于**根元素的字体大小**。

**例如，您可以将容器 div 的字体大小设置为 16px，并且使用em**单位设置任何子元素的字体大小将使其相对于容器 div。

```
div { font-size: 16px }

div>p  {
  font-size: 1.5em; //this will be equal to 24px
} 
```

在**p**元素上，**1em 等于 16px**，这意味着**1.5em 将等于 24px**。

这里有一篇很棒的文章[https://kolosek.com/css-relative-font-size/](https://kolosek.com/css-relative-font-size/)，详细解释了相对字体大小。

# c - 为什么使用 pipe() 创建的管道不能用作双向管道？

> ID：10141678
> 
> 赞同：4
> 
> 时间：2012-04-13T13:24:38.880
> 
> 标签：c, ipc, pipe, interprocess

[`pipe`](http://linux.die.net/man/2/pipe)我见过的几乎所有示例都建议关闭未使用的写入/读取结束。男人也明确指出，`pipe() creates a pipe, a unidirectional data channel`但我已经尝试在父母和孩子的管道两端进行读写，一切似乎都很好。

所以我的疑问是，如果两个进程必须相互读写，为什么我们需要 2 个管道，为什么不使用单个管道呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-13T13:30:42.450

如果您使用相同的管道，孩子如何将其消息与父母消息分开，反之亦然？

例如：

```
Parent writes to pipe
Parent reads from pipe hoping to get message from child but gets its own message :( 
```

将一个管道用于子-> 父，将另一个管道用于父-> 子，这要容易得多。

即使您有一些用于读/写的协议，也很容易使父进程和子进程死锁。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-13T13:29:55.683

您***可以***在创建的管道的两端读取和写入，但单向意味着数据*在任何时候都*只能在一个方向上传输，从父级到子级，反之亦然。非阻塞发送和接收数据需要两个管道，这意味着您可以使用两个管道同时读取和写入，但是使用一个管道您必须先完成读取才能写入管道，否则您必须完成写入在您阅读管道之前。***用外行的话来说，你只能在任何时间点用一个管道读取或写入***

# c# - wpf中用于分层导航的导航栏

> ID：10141679
> 
> 赞同：0
> 
> 时间：2012-04-13T13:24:39.820
> 
> 标签：c#, asp.net, wpf

嗨，asp.net 中有一个名为**SiteMapPath**的控件，我需要 WPF 中类似的东西来帮助用户在应用程序页面中来回导航……有人知道任何第三方控件或可以帮助我实现此功能的内置功能吗功能还是我应该从头开始

能够显示期刊历史也可以解决问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T14:52:40.117

我不知道任何像 SiteMapPath 一样工作的 WPF 控件。您可以使用菜单或选项卡控件将不同的视图加载到页面上并在 xml 中定义菜单/选项卡。以下是一些链接，可能有助于激发您的一些想法。
[WPF XML DataBinding](https://stackoverflow.com/questions/1061358/wpf-xml-databinding)
[绑定到 Xlinq](http://bea.stollnitz.com/blog/?p=50&cpage=1#comment-166001)

对于面包屑，您可能对
[代码项目](http://www.codeproject.com/Articles/29350/WPF-BreadcrumbBar)
[堆栈溢出感兴趣](https://stackoverflow.com/questions/5727382/breadcrumb-style-with-wpf-listview)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T14:59:49.003

好的，我为 wpf 创建了自己的面包屑......首先，因为我的应用程序中的所有导航都是基于 wpf **NavigationService**我使用了Frame 的**BackStack**属性

```
var x = Frame.BackStack.Cast<JournalEntry>().Select((page) => page).ToList(); 
```

现在只需将列表框或您想要的任何控件绑定到上面列表的 Name 属性，在我的情况下，因为我只需要跟踪以前的页面，我将此代码添加到绑定到的列表框的 SelectionChanged 事件中以上列表

```
void listBox_SelectionChanged(object sender, SelectionChangedEventArgs e)
    {
        int i = (sender as ListBox).Items.Count - (sender as ListBox).SelectedIndex;
        for (; i > 0 && (sender as ListBox).SelectedIndex != -1; i--)
            Frame.NavigationService.GoBack();
    } 
```

# iphone - 将视图控制器推送到导航期间的动画。控制器有时会停止工作

> ID：10141681
> 
> 赞同：1
> 
> 时间：2012-04-13T13:24:40.003
> 
> 标签：iphone, objective-c, animation, uinavigationcontroller, pushviewcontroller

我在我的应用程序中多次使用此标准代码将 VC 推送到导航。控制器。

```
 [self.navigationController pushViewController:detailController animated:YES]; 
```

但有时他们会停止工作——视图控制器被正确推送但没有动画（就像我会使用“动画：否”一样），我不知道为什么。

有什么建议可以观察或尝试吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T17:04:40.230

每当您使用 ...animated:YES/NO 时，Cocoa 框架将确定它是否可以/不能这样做，而且通常它只是失败了。就像迈克尔说的那样，你可能不在主线程上，也不知道是什么。如果您在 NSWindow 上查看用于全屏动画的最新 Lion API，您会发现动画失败的各种委托无法提供详细信息。所以我不指望苹果会回归动画师并添加这样的功能。

要回答您的问题，主要是我会使用我自己的使用 Core Animations 的自定义动画。他们真的没有那么糟糕。为了让您开始，您可以创建一个类别或类方法为方便起见，如下所示：

```
+ (void) animateWithDuration:(NSTimeInterval)duration 
                   animation:(void(^)())animationBlock
                  completion:(void(^)())completionBlock {

    [NSAnimationContext runAnimationGroup:^( NSAnimationContext *context ) {

        if ( duration > 0 ) [context setDuration:duration];
        [context setTimingFunction:[CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionDefault]];

        if ( animationBlock ) animationBlock();

    } completionHandler:^ {

        if ( completionBlock ) completionBlock();

    }];
} 
```

然后，您可以像这样将它用于多个动画。像这样...

```
[AnimationContext animateWithDuration:myDuration animation:^{

        // You can use whatever animation you want here or even nest
        CABasicAnimation *fade  = /* opacity animation */; 
        [view.layer addAnimation:fade forKey:nil];

    } completion:^{ 

        // Do some completion here.
}]; 
```

请注意，您可以通过这种方式更好地控制动画。

希望这能回答您正在寻找的内容。

（注意，我的示例是针对 Mac OS X。在 iOS 上，相当于 NSAnimationContext 是使用 CATransaction 进行包装）

# eclipse - eclipse java编辑器方法建议

> ID：10141694
> 
> 赞同：0
> 
> 时间：2012-04-13T13:25:22.827
> 
> 标签：eclipse, editor, code-completion

我最近不得不从事一个 Visual Basic 项目。对于这个任务，我使用了 Visual Studio 2010，并注意到我提出的代码完成方法略有不同。如果您按 CRTL+空格键并开始输入，则会建议所有包含该文本的方法。Eclipse 建议所有以文本开头的方法。

如果您必须使用未知代码，此行为特别有用。我可以为 Eclipse 实现相同的行为吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T13:45:17.057

您可以下载 Eclipse Code Recommenders 插件 - [http://www.eclipse.org/recommenders/](http://www.eclipse.org/recommenders/)。它具有“子词完成”功能，可以完全满足您的需求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T13:39:13.060

您在 Eclipse 中最接近的是对驼峰式大小写的支持...这允许您键入“ `new NPE`” ctrl-space，Eclipse 将建议`NullPointerException`和`NoPermissionException`（取决于您当前的目标平台）。

要查看您必须更改快速辅助功能的行为的首选项，请打开首选项对话框并在搜索字段中键入“assist”......有很多方法可以调整行为:-)

# php - 如何在 Redis 中存储简单的数组

> ID：10141703
> 
> 赞同：5
> 
> 时间：2012-04-13T13:25:50.457
> 
> 标签：php, redis

我想知道在 Redis 中存储 IP（不是很多（<50））以及一些元数据（添加时间，注意）的最佳方式是什么。我需要能够快速确定某个 IP 是否在该列表中，并能够检索所有存储的 IP。

我有一些想法，但它们对我来说似乎并不优雅/高效：

*   使用列表存储 IP，其中每个条目都是数组（ip、note、timestamp）。这将使检索所有 IP 变得简单，但需要循环遍历所有 IP，以确定给定 IP 是否在列表中。因此，这对检索所有 IP 是很好的，但对于检查一个 IP 的存在不是很好。
*   使用哈希表存储 IP，其中 IP 是键的一部分，元数据是哈希中的字段。这将允许我检查一个 IP 是否存储得非常简单（exists()），但需要一个单独的 redis 列表来跟踪存储的 IP（这需要我在添加/删除 IP 时非常小心）并且我必须执行 1 + count(ips) 操作才能获取所有存储的 IP 及其元信息。因此，这种方式适用于检查一个 IP 是否存在，但不适用于检索所有 IP。

是否有其他方法可以使用 redis 执行此操作，或者我是否必须使用上述方法之一（如果是，哪一个是最好的）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-13T14:17:32.973

对于您的数据大小，这并不重要。

然而，这个黑客怎么样。使用分数为 IP 的有序集（将其视为一个数字，每个句点被视为 00，例如 127.0.0.1 => 1270000001），每个项目是 JSON 中的元数据和 IP

```
zadd ip_set 1270000001 '{ip:"127.0.0.1", note:"blah"} 
```

然后得到你所做的一切

```
zrange ip_set 0 -1 
```

并检查是否存在

```
zcount ip_set 1270000001 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-13T13:35:29.453

当然是第二种方式。这是一个键值存储。您应该完全按照您的描述使用密钥。Redis 执行操作非常快。不用担心1-2次操作。

# c# - C# Linq 使用数组元素过滤 DataTable

> ID：10141707
> 
> 赞同：0
> 
> 时间：2012-04-13T13:26:11.690
> 
> 标签：c#, asp.net, vb.net, linq

我想使用过滤数据表中的数据`linq`。

我的场景是我有一个元素数组，其中包含动态创建的日期，并且在数据表中我们有列`id,date,etc.`

我们必须检索包含数组中所有日期的 id

前任：

```
string[] arr={"10/10/2012","11/11/2012","9/9/2012"} 
```

桌子 ：

```
ID   date      
1    10/10/2012         
2    11/11/2012        
1    9/9/2012         
6    9/9/2012         
3    9/9/2012         
6    11/11/2012         
1    11/11/2012 
```

输出将为 1 - 因为只有 id '1' 具有所有数组元素。

为了完成上述功能，我使用了如下所示的 Linq 查询。但我确实失败了。

```
Dim volunteers As DataTable =
    (From leftTable In dtavailableVolunteers.AsEnumerable()
    Join rightTable In dtavailableVolunteers.AsEnumerable()
        On leftTable.VolunteerId Equals rightTable.VolunteerId
    Where SelectedDatesArray.All(Function(i) rightTable.Field(Of String)("SelectedDate").Equals(i.ToString()))
    Select rightTable).CopyToDataTable() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T13:30:39.080

假设您的数据表是 dt

```
DataRow[] dr = dt.Select("date in (" + string.join("," , arr) + ")");

string[] st = dr.Select(ss => ss["id"].ToString()).ToArray(); 
```

或者

```
DataTable newdt = dr.CopyToDataTable(); 
```

第二行是 LINQ

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T07:30:03.393

这是另一个版本：

```
from volunteer in dtavailableVolunteers
group volunteer by volunteer.Id into g
let volunteerDates = g.Select(groupedElement=>groupedElement.date)
where arr.All(date=>volunteerDates.Contains(date))
select g.Key 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-14T05:55:38.727

您可以按 ID 对行进行分组，然后找到以下组：不存在组日期不包含该元素的 arr 元素。我的意思是：

```
var result = from item in list
             group item by item.ID into grouping
             where !arr.Exists(date => 
                 !grouping.Select(x => x.Date).Contains(date))
             select grouping.Key; 
```

# vb6 - VB6中的Sub和Function有什么区别？

> ID：10141708
> 
> 赞同：54
> 
> 时间：2012-04-13T13:26:16.677
> 
> 标签：vb6

我正在浏览一些旧的 VB 代码，我遇到了像这样的函数定义 -

```
 Private Function ExistingCustomer(Index As Integer, Customer As String) As Integer

 Private Sub cmdCustomerList_Click() 
```

有什么不同？

* * *

## 回答 #1

> 赞同：119
> 
> 时间：2012-04-13T13:27:34.853

函数返回值，Sub 没有。就是这么简单。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2014-11-18T16:33:57.220

函数也可以在表达式中使用。子程序不能。函数可以比子例程更好地提高代码的可读性。

这是一个函数如何提高可读性的示例：

```
If AccountIsLocked("JJones") then Msgbox("This account is locked") 
```

这个函数将在某处定义

```
public function AccountIsLocked(UserId as string) as boolean
   dim usr = uow.AccountRepository.UserInfo(UserId)
   return usr.locked
end function 
```

这是相同的示例，但使用子例程进行了编码：

```
CheckIfAccountLocked("JJones") 
```

在其他地方定义了这个子：

```
public sub CheckIfAccountLocked(UserId)
       if uow.AccountRepository.UserInfo(UserId).locked then
          msgbox("Account is locked")
       end if
end sub 
```

另请注意，检查值与操作是分开的——这有助于职责分离。该功能将有助于可重用性。

对于 VB6，有一些奇怪的规则来管理括号。如果 sub 没有参数，则不需要括号（我认为 Visual Studio 可能会删除括号）。解决此问题的一种方法是在您的子之前添加关键字“呼叫”。

```
Call CheckIfAccountLocked() 
```

对比

```
CheckIfAccountLocked 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-08-23T11:12:03.520

在函数中，我们可以将值返回为布尔值、字符串和其他数据数据类型。

但 sub 不返回任何东西。它只是执行我们给出的代码和指令。这些也被视为方法

Sub 也用于控件的事件，这些事件也不返回任何值。

例如命令按钮的点击事件： Private sub cmd_click()

结束子

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-04-30T09:20:17.857

它们都是编写代码的部分，但是函数必须返回一个值。例如，如果您有一个程序需要多次执行复杂的数学过程，您只需创建一个函数并在其中包含复杂的数学代码，并且任何时候您需要进行计算，您都可以调用该函数. 希望这有助于不确定我是否解释得很好。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-08-25T09:25:38.883

VB6中的Sub和Function有什么区别？

“ **sub** ”可以执行一些动作。“sub”不返回任何值。

例子：

Form_Load()

“ **function** ”也可以执行一些操作，但它也会返回一些值到调用它的点。也就是说，“函数返回一个值，通常基于一个变量”

例子：

值（），格式百分比（）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-07-09T06:19:12.387

VB中的函数

*   函数必须返回一些值
*   语法：私有函数 fun_name(argument/s(optional)) as return_type(integer,string..) 返回值结束函数
*   fun_name(arguments(optional) ) 函数调用就足够了

vb中的子

*   一个子不需要返回任何值/s
*   语法 : private sub sub_name(argument/s(optional))

    结束子

*   sub_name(arguments(optional) ) 足以用于函数调用

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2017-02-17T19:49:06.600

函数保存数据和代码。但是子程序只包含代码，而不包含数据。

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2017-04-03T17:00:09.117

1.  函数的语法将是 Function...End 函数，对于 Sub 将是 Sub...End Sub。
2.  函数可能有也可能没有对象，但 sub 没有对象
3.  函数可在 Sub 不能重用的地方重用
4.  函数可以返回值，但 sub 不能
5.  函数可能有对象存储库，但 sub 没有
6.  函数的扩展是 .qfl，其中 sub 是 .vba

# android - 如何锁定安卓手机程序？

> ID：10141710
> 
> 赞同：0
> 
> 时间：2012-04-13T13:26:22.020
> 
> 标签：android

```
public class lock extends DeviceAdminReceiver {

    public static class Controller extends Activity {

        DevicePolicyManager mDPM;
        ComponentName mDeviceAdminSample;

        protected void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);

            mDPM = (DevicePolicyManager)getSystemService(Context.DEVICE_POLICY_SERVICE);
            mDeviceAdminSample = new ComponentName(Controller.this,
                lock.class);
            boolean active = mDPM.isAdminActive(mDeviceAdminSample);
            if (active) 
            {
                mDPM.lockNow();
            }
        }
    }
} 
```

我面临的错误是：

```
1.04-11 18:25:50.918: ERROR/AndroidRuntime(860): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.lock/com.lock.lock.Controller}: java.lang.ClassNotFoundException: com.lock.lock.Controller in loader 
dalvik.system.PathClassLoader[/data/app/com.lock-1.apk]

04-11 18:25:50.918: ERROR/AndroidRuntime(860):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2585)
04-11 18:25:50.918: ERROR/AndroidRuntime(860):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
04-11 18:25:50.918: ERROR/AndroidRuntime(860):     at android.app.ActivityThread.access$2300(ActivityThread.java:125)
04-11 18:25:50.918: ERROR/AndroidRuntime(860):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
04-11 18:25:50.918: ERROR/AndroidRuntime(860):     at android.os.Handler.dispatchMessage(Handler.java:99)
04-11 18:25:50.918: ERROR/AndroidRuntime(860):     at android.os.Looper.loop(Looper.java:123)
04-11 18:25:50.918: ERROR/AndroidRuntime(860):     at android.app.ActivityThread.main(ActivityThread.java:4627)
04-11 18:25:50.918: ERROR/AndroidRuntime(860):     at java.lang.reflect.Method.invokeNative(Native Method)
04-11 18:25:50.918: ERROR/AndroidRuntime(860):     at java.lang.reflect.Method.invoke(Method.java:521)
04-11 18:25:50.918: ERROR/AndroidRuntime(860):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
04-11 18:25:50.918: ERROR/AndroidRuntime(860):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
04-11 18:25:50.918: ERROR/AndroidRuntime(860):     at dalvik.system.NativeStart.main(Native Method)
04-11 18:25:50.918: ERROR/AndroidRuntime(860): Caused by: java.lang.ClassNotFoundException: com.lock.lock.Controller in loader dalvik.system.PathClassLoader[/data/app/com.lock-1.apk]
04-11 18:25:50.918: ERROR/AndroidRuntime(860):     at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:243)
04-11 18:25:50.918: ERROR/AndroidRuntime(860):     at java.lang.ClassLoader.loadClass(ClassLoader.java:573)
04-11 18:25:50.918: ERROR/AndroidRuntime(860):     at java.lang.ClassLoader.loadClass(ClassLoader.java:532)
04-11 18:25:50.918: ERROR/AndroidRuntime(860):     at android.app.Instrumentation.newActivity(Instrumentation.java:1021)
04-11 18:25:50.918: ERROR/AndroidRuntime(860):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2577)
04-11 18:25:50.918: ERROR/AndroidRuntime(860):     ... 11 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T13:41:17.313

```
KeyguardManager mgr = (KeyguardManager) getContext().getSystemService(Activity.KEYGUARD_SERVICE); 
KeyguardLock lock = mgr.newKeyguardLock(KEYGUARD_SERVICE); 
lock.reenableKeyguard(); 
```

And you need the appropriate permissions.

# c# - 如何将 xml 数据发布到 xml 页面

> ID：10141711
> 
> 赞同：1
> 
> 时间：2012-04-13T13:26:26.770
> 
> 标签：c#, asp.net, xml

我正在尝试将 xml 代码从 aspx 页面发布到 xml 页面* *(http://../../command.xml)* *

谁能帮我..？

提前致谢。！！

# c# - 动态列出数据库表中的字段

> ID：10141716
> 
> 赞同：3
> 
> 时间：2012-04-13T13:26:30.767
> 
> 标签：c#, sql, sql-server-2008, c#-4.0

有没有办法查询数据库以检索有关表架构的信息？我只对获取列名列表以及它们是否是主键感兴趣；这可能吗？我不关心类型，只关心它的名称以及它是否是主键。

样品表：

```
Table Organism
{
   primary: int ID;
   int Kingdom;
   int Phylum;
   int Class;
   int Genus;
   int Species;
   nvarchar(50) Name;
} 
```

样品用法：

```
List<Tuple<string, bool>> t = ReadTable("Organism");
t.ForEach(x => Console.WriteLine(x.Item2 ? x.Item2 + ": " + x.Item1 : x.Item1)); 
```

样本输出：

```
True ID
Kingdom
Phylum
Class
Genus
Species
Name 
```

我正在使用 C#4.0 和 SQL Server 2008 R2。我*认为*这应该可以使用系统表，但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T13:28:51.767

```
select col.*
from sys.columns col
join sys.tables tab on col.object_id = tab.object_id
where tab.name = @tabName
order by col.column_id 
```

系统视图包含大量数据并且易于使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T13:29:06.010

您可以使用这种 hacky 查询获取字段名称

```
select * from Organism where 1=2 
```

并且可以使用[Information Schema Views](http://msdn.microsoft.com/en-us/library/ms186778.aspx)检索元数据，例如密钥用法：

```
SELECT * FROM databaseName.INFORMATION_SCHEMA.KEY_COLUMN_USAGE 
Where TABLE_NAME='Organism' 
```

# php - 将arraylist更新到mysql数据库到php时出错

> ID：10141720
> 
> 赞同：0
> 
> 时间：2012-04-13T13:26:50.233
> 
> 标签：php, mysql, arraylist

我可以将两个数组列表 android 发送到 php

```
 [p,q,r,s,t,u](old menuname)
                      [a,b,c.d,e.f](new menunames) 
```

我在该表中有一个测试表，其中包含一列菜单名称，它会正确更新。现在我添加另一列作为 menuimage 我可以将 menuimages(blob) 插入 mysql 数据库中的 menuimage 列。现在我要执行更新菜单名称意味着它只更新第一行。剩余的行不更新。

```
 i try this code
      <?php
    $old_menu_names=explode(',',preg_replace('/^.*\
    [(.*)\].*$/','$1',trim($_POST['menuname'], '[]'))); 

    $new_menu_names=explode(',',preg_replace('/^.*\
    [(.*)\].*$/','$1',trim($_POST['editmainmenu'], '[]'))); 

    mysql_connect("localhost", "root", "root");
    mysql_select_db("test"); 

    $i = 0;
    foreach ($old_menu_names as $key => $old_name)
    {
       $new_name = mysql_real_escape_string($new_menu_names[$i]);
       $old_name  = mysql_real_escape_string($old_menu_names[$key]);
       echo $new_name;
       mysql_query("UPDATE `test` SET `menuname` = '$new_name' WHERE menuname =   '$old_name'")
       or die('Error' . mysql_error());
       echo "Updated"; 
       $i++;
    } 
```

?>

我可以打印此行的响应是 echo $new_name; 回声“更新”；aUpdated bUpdated c\nUpdated dUpdated eUpdated fUpdated

但只有第一个被更新剩余的行没有被更新

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T13:48:08.993

嗯……

可能你的正则表达式有错误..

在 foreach 之前转储 $old_menu_names 变量。

```
print_r($old_menu_names); 
```

# asp.net - 如何将跟踪信息保存到文件中

> ID：10141723
> 
> 赞同：3
> 
> 时间：2012-04-13T13:27:07.820
> 
> 标签：asp.net, web-config, trace

我通过在`web.config`( `<trace enabled="true" pageOutput="true"/>`)中启用跟踪来跟踪我的 ASPX 页面

我如何将此信息（特别是请求标头）保存到日志文件中。

感谢您分享您宝贵的时间。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-13T13:44:44.193

仅以您拥有的方式启用跟踪是不够的 - 您需要配置要跟踪的内容以及如何处理跟踪。

请参阅MSDN 上的[跟踪侦听器](http://msdn.microsoft.com/en-us/library/4y5y10s7.aspx)和[配置跟踪。](http://msdn.microsoft.com/en-us/library/ms733025.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-13T13:37:37.813

检查下面的链接，其中显示了各种跟踪选项

[http://www.codeproject.com/Articles/82290/Step-by-Step-Guide-to-Trace-the-ASP-NET-Applicatio](http://www.codeproject.com/Articles/82290/Step-by-Step-Guide-to-Trace-the-ASP-NET-Applicatio)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-04-13T15:10:27.740

```
foreach (string key in HttpContext.Current.Request.Headers)
 {
     YourLoggingMethod(key, HttpContext.Current.Request.Headers[key]);
 } 
```

# .net - 派生类的泛型版本可以使用泛型类型覆盖基方法吗？

> ID：10141726
> 
> 赞同：2
> 
> 时间：2012-04-13T13:27:13.000
> 
> 标签：.net, vb.net, oop, generics, clr

考虑：

```
Public MustInherit Class Column
    Public ReadOnly Property ReturnSomethingUseful() As Object
        Get
             'return something useful
        End Get
    End Property
End Class

Public Class TypedColumn(Of T)
    Inherits Column

    Public Overrides ReadOnly Property ReturnSomethingUseful() As T
        Get
             'return the same something useful, but as type T
             Return MyBase.ReturnSomethingUseful()
        End Get
    End Property
End Class 
```

但这会产生以下错误：

> Public Overrides Function ReturnSomethingUseful(sValue As String) As Boolean' 不能覆盖'Public Overridable Function ReturnSomethingUseful(sValue As String) As Object'，因为它们的返回类型不同。

我接受你不能这样做，但我希望能够保留我正在**尝试**做的事情的语义，即有一个处理 的无类型版本`Object`，但派生类中的类型版本知道具体的类型`T`。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-13T13:31:03.760

是的，有：使用[`Shadows`](http://msdn.microsoft.com/en-us/library/1h3wytf6%28v=vs.71%29.aspx)修饰符

```
Public Shadows ReadOnly Property ReturnSomethingUseful() As T
    Get
         'return the same something useful, but as type T
         Return MyBase.ReturnSomethingUseful()
    End Get
End Property 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T14:37:48.687

我不喜欢这个答案，但这是我正在做的事情，直到我找到一个真正优雅的解决这个问题的方法：

```
Public Class TypedColumn(Of T)
    Inherits Column

    Public ReadOnly Property ReturnSomethingUsefulTyped() As T
        Get
          'return the same something useful, but as type T
          Return MyBase.ReturnSomethingUseful()
        End Get
    End Property
End Class 
```

因此，它没有覆盖基本方法，而是有一个不同的名称来指示它的作用。不是很好，但比处理类型`Object`好，也比处理问题好`Shadows`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-27T20:01:32.313

我因愚蠢的 5 分钟限制而无法进行编辑...

无论如何，我想说，这有点像无法执行以下操作：

```
Private _myProperty As Integer = 0

ReadOnly Property MyProperty As String
    Get
        Return _myProperty.ToString("0,###")
    End Get
End Property

WriteOnly Property MyProperty As Integer
    Set(value As Integer)
        _myProperty = value
    End Set
End Property 
```

我认为能够向属性写入与从中读取不同的类型是有效的。例如，在管理 UI 日期时间时。简单地将日期时间读取为格式化字符串比在 UI 代码中乱七八糟要干净得多。我知道我在这里会是少数，真正的编码员会尖叫。

# model-view-controller - iOS5 中我的 UIView CGRect 属性上的 KVO 不起作用

> ID：10141730
> 
> 赞同：1
> 
> 时间：2012-04-13T13:27:22.170
> 
> 标签：model-view-controller, uiview, key-value-observing, cgrect

我有一个 ViewController 和一个 UIView，并且想对 CGRect 类型的 UIView 属性执行 KVO。由于某种原因，它无法正常工作。我的代码如下所示：

```
@interface MyView : UIView
@property (nonatomic, assign) CGRect myRect;
@end

@implementation MyView
@synthesize myRect;
...
- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event {
   ...
   //Changing structures values
   myRect.origin.x+=moveVector.x;
   myRect.origin.y+=moveVector.y;
   //assigning new structure
   [self setMyRect:CGRectMake(20, 20, 50, 50)];
   //Both doesn't call
} 
```

我想用我的 viewController 观察 CGRect。不确定我应该对 MVC 有多严格。顺便说一句，MyView 中的 CGRect 只是一个可见的正方形，我可以四处移动，所以我会说它不是模型，应该留在 MyView 中。如果我错了，请纠正他们。

这是我的视图控制器：

```
@class MyView;
@interface MyViewController : UIViewController
@property (nonatomic, retain) MyView *overlayView;
@end

@implementation MyViewController
@synthesize overlayView;

- (void)viewDidLoad
{
[super viewDidLoad];
overlayView = [[CameraOverlayView alloc] initWithFrame:CGRectMake(0, 0, 320, 480)];
[overlayView addObserver:self 
              forKeyPath:@"myRect" 
                 options:(NSKeyValueObservingOptionNew | NSKeyValueObservingOptionOld) 
                 context:NULL];
/*    [self addObserver:self 
       forKeyPath:@"overlayView.myRect"
          options:(NSKeyValueObservingOptionNew | NSKeyValueObservingOptionOld) 
          context:NULL];*/
self.view = overlayView;
}
-(void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object 
                   change:(NSDictionary *)change context:(void*)context { 
   if( [keyPath isEqualToString:@"myRect"] ) {
      NSLog(@"observeValueForKeyPath");
      CGRect rect = [[change valueForKey:NSKeyValueChangeNewKey] CGRectValue];
   }
} 
```

无论我如何在 MyView 中更改 myRect，observeValueForKeyPath 都不会被调用。setMyRect：在运行时崩溃，我真的不知道为什么。我虽然 synthesize 会处理 setter 和 getter 以及 Keyvalues 和更改。我也不确定 addObserver: 的哪种方式更好，因为我注释掉了我第二次尝试注册观察者的尝试。

我在做什么错？不能观察结构吗？还是仅使用自己编写的 setter 和 getter？会不会是 UIView 不符合 KVC-Compliant，如果是，为什么会这样？ [KVO 在 UIView 框架属性上的回调](https://stackoverflow.com/questions/4874288/how-can-i-get-a-callback-by-kvo-on-a-uiviews-frame-property "在 UIView 框架上由 KVO 回调") 感谢您的帮助:-)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T00:22:46.997

我的解决方案是，我正在使用委托。控制器是我的视图代表，我认为它应该是这样，否则 UIView 将是 KVC 投诉。

# forms - 编辑表单中的jqgrid分页

> ID：10141732
> 
> 赞同：1
> 
> 时间：2012-04-13T13:27:23.340
> 
> 标签：forms, jqgrid, navigation, edit

我需要禁止向用户分页（按下下一个，上一个按钮时不会发生任何事情）。我发现 `onPaging: function (b) {...}`返回“停止”字符串的事件。但这仅适用于网格。不适用于编辑表单。当我打印参数时，一直在获取“用户”值。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T14:18:22.540

可能您需要使用表单编辑的[viewPagerButtons: false](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3aform_editing#properties)属性：

```
$("#list").jqGrid("navGrid", "#pager", {/*options of navGrid*/},
    {viewPagerButtons: false},    // options of Edit form
    {viewPagerButtons: false});   // options of Add form 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-13T21:08:35.833

在 editOptions : { viewPagerButtons:false } 这是编辑表单上的上一个和下一个按钮

# javascript - Javascript验证也允许点在最后第三位

> ID：10141736
> 
> 赞同：0
> 
> 时间：2012-04-13T13:27:33.513
> 
> 标签：javascript, regex

这是我正在检查的表达式，只允许 0-9 位数字

```
var alphaExp = /^[0-9]+$/;

 if (!txtRate.value.match(alphaExp)) {

              alert("Rate should be numeric.");
              txtRate.focus();
              return false;

          } 
```

我希望 .(dot) 也位于最后第三个位置 .. 如果这是我的表达式 10000.00 （不会为此生成警报）

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T13:30:20.220

你可以使用这个：

```
/^\d+(\.\d\d)?$/ 
```

它表示一个或多个数字，可选地后跟一个小数点和两个数字。`\d`只是一个简写`[0-9]`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T13:30:21.327

将您的 RexEx 更改为：

```
/^[0-9]+(\.[0-9][0-9])?$/ 
```

# schema - 如何查看 h2 数据库中的当前模式搜索路径？

> ID：10141739
> 
> 赞同：1
> 
> 时间：2012-04-13T13:27:42.470
> 
> 标签：schema, h2, search-path

连接到 h2 数据库时，默认搜索路径设置为`public`. 您可以使用`SET SCHEMA_SEARCH_PATH`.

但是，如果您多次更改它，在某些时候您如何查看其当前内容？

我找不到类似这样的命令`VIEW SCHEMA_SEARCH_PATH`或`SHOW SCHEMA_SEARCH_PATH`.

键入它们会给我错误消息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T13:36:39.670

这有点 hack，但你可以使用：

```
SELECT * FROM INFORMATION_SCHEMA.SESSION_STATE 
WHERE KEY='SCHEMA_SEARCH_PATH' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-01T14:47:49.740

非黑客解决方案：SELECT SCHEMA()

# xslt - 如何在 Diazo 中切片字符串？

> ID：10141743
> 
> 赞同：1
> 
> 时间：2012-04-13T13:27:54.170
> 
> 标签：xslt, split, plone, diazo

我只想从默认事件 portlet 中获取两位数的日期。在下面的示例中为“13”：

```
<dl class="portlet portletEvents">
    <dt class="portletHeader"><a href="/mysite/events_listing">Next events</a></dt>    
    <dd class="portletItem">
        <a title="" href="/mysite/events/my-event">Example event</a>
        <span class="portletItemDetails"><span>13/04/2012 - 22/04/2012</span></span>
    </dd>
    <dd class="portletFooter"><a href="/mysite/events_listing">Next events…&lt;/a></dd>
</dl> 
```

在根规则级别我尝试过：

```
<replace css:theme="#event-day strong">
  <xsl:template css:match="dl.portletEvents .portletItemDetails span">
    <xsl:value-of select="substring(.,1,2)" />
  </xsl:template>
</replace> 
```

并且：

```
<replace css:theme="#event-day strong">
  <xsl:value-of css:select="substring(dl.portletEvents .portletItemDetails span,1,2)" />
</replace> 
```

这些都没有奏效。我该怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T14:40:49.703

这是可能的，但很难看：

```
<copy css:theme="#event-day strong">
   <xsl:value-of select="substring((//dl[contains(concat(' ', normalize-space(@class), ' '), ' portletEvents ')]//span[contains(concat(' ', normalize-space(@class), ' '), ' portletItemDetails ')]/span/text()),1,2)"/>
</copy> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T14:39:51.763

这可能是您最好通过修改底层事件 portlet 来实现的目标。但真正的重氮巫师之一可能有办法。

# objective-c - 我用选择器和目标调用 dispatch_async。选择器被调用但界面不会更新，直到我点击主页按钮

> ID：10141747
> 
> 赞同：1
> 
> 时间：2012-04-13T13:28:06.357
> 
> 标签：objective-c, ios, ios5

我发现我的 iOS 应用程序出现了最奇怪的行为。我有这个代码：

```
 dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0), ^{
             CMLog(@"Start Save RoundQuestions Asynchronously");
             [round saveRoundQuestions:target selector:selector];
         }); 
```

该函数完成它的工作并调用它：

```
#pragma clang diagnostic push
#pragma clang diagnostic ignored "-Warc-performSelector-leaks"
        [target performSelector:selector];
#pragma clang diagnostic pop 
```

日志显示一切正常运行，但是目标在 navigationController 上调用了 pushViewController，并且执行实际推送需要很长时间。我可以通过单击主页按钮强制它继续。我读过我可能违反了线程安全，并且可能需要唤醒运行循环。

从 dispatch_async 调用选择器是错误的吗？还是我需要在 UI 所在的主线程上执行选择器？

编辑：我实际上发现了问题。事实证明，我正在调用一个函数，该函数阻塞了 saveRoundQuestions 内的 UI，我相信这会迫使推送动画到行的后面，可以这么说。我把这个功能放在后台，推送动画现在立即发生。但我还是很好奇为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-13T13:31:12.063

您应该只在主线程上进行 UI 更新，因此您需要使用以下方法获取主队列：

```
dispatch_get_main_queue() 
```

代替`dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0)`

我的回答仍然成立，不能保证会`dispatch_get_global_queue`返回主线程的队列，它只是一个高优先级队列

> **名称：** dispatch_get_global_queue
> **摘要：**返回一个已知的给定优先级的全局并发队列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T13:33:02.687

您可以使用 dispatch_async 成功更新 UI。只是代替`dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0)`使用`dispatch get_main_queue()`

编辑：根据您的更新。如果你在里面做一些昂贵的工作`saveRoundQuestions`，然后更新UI，你应该使用：

```
 dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
         CMLog(@"Start Save RoundQuestions Asynchronously");
         [round saveRoundQuestions:target selector:selector];
     }); 
```

然后在里面`saveRoundQuestions`放另一个块`dispatch_get_main_queue()`来更新 UI。

# asp.net - ASP.NET MVC 2：使用没有重复验证的重复输入部分视图

> ID：10141748
> 
> 赞同：0
> 
> 时间：2012-04-13T13:28:11.610
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-2, partial-views

在重写的应用程序中，最初的某个表单包括一个下拉菜单，用户可以在其中选择两个主要选项之一，以了解如何将输入用于其他地方的计算。

现在的要求规定，界面应该在同一页面上显示两个相同的表单，而不是这个下拉菜单，一个在另一个之上。参数或隐藏值用于确定是否在每个表单上设置了上述选项，以便两个选项中的每一个都有一个表单。这会在模型上设置一个布尔值。

我对表单的两种外观都使用相同的局部视图，在初始化期间定义它们的差异。但是，我仍然遇到一个特殊问题——如果一个表单上存在验证错误，它会同时出现在两个表单上。防止这种情况的最佳方法是什么？

我只是不得不屈服并制作几乎重复的部分视图，还是有办法继续使用相同的部分视图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T13:43:43.987

你可以尝试这样的事情：

为表单创建一个基本模型。该基本模型将具有其两个子模型共有的属性和验证属性：

```
public class BaseModel {
    [Required]
    public string Name { get; set; }
}
public class Model1 : BaseModel {
    public bool Form1 { get; set; }
}
public class Model2 : BaseModel {
    public bool Form2 { get; set; }
} 
```

然后，您可以创建两个接受这些模型作为参数的不同控制器操作：

```
public ActionResult PostForm1(Model1 model) { }
public ActionResult PostForm2(Model2 model) { } 
```

您的部分视图必须根据它的形式添加一个输入：

```
<form action="<%=(isForm1 ? "/PostForm1" : "/PostForm2")>%">
    <input type="hidden" 
           id="<%=(isForm1 ? "Form1" : "Form2")%>" 
           name="<%=(isForm1 ? "Form1" : "Form2")%>" 
           value="true" />
</form> 
```

当一个表单被发布时，它应该只对其模型进行验证，而不影响另一个模型（您需要一个视图模型，它具有两个表单模型作为属性）。

我不确定这是否可行，但同样，您可以尝试一下。

# php - cURL 和 domDocument 解析 html

> ID：10141751
> 
> 赞同：0
> 
> 时间：2012-04-13T13:28:16.730
> 
> 标签：php, dom, curl, domdocument

`<td>`我只需要来自DOM 嵌套表中特定的单个值。一个里面有 7 个表，具体`<td>`是使用一个名为“LtrAligned”的类。

我如何查看 DOM 并准确查看我需要哪个元素以及什么可以带回我正在寻找的数据？

1.  用于检索标签之间的 HTML 的方法是什么？喜欢：

    `<a href="abc.com">`**这是一个链接**`</a>`/// 检索文本值-> 这是一个链接

2.  如何取出放置在标签内的值，例如：

    `<a href="abc.com">`**这是一个链接**`</a>`/// 检索 href 值-> abc.com

我在通过 DOM 时遇到很多错误，因为我不知道要查找什么。有没有办法真正一步一步地做到这一点`<td>`？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T13:38:11.690

1.  节点值
2.  [获取属性](http://php.net/manual/en/domelement.getattribute.php)

# asp.net - ASP.NET 和 IIS7 Winsock 错误

> ID：10141757
> 
> 赞同：1
> 
> 时间：2012-04-13T13:28:28.533
> 
> 标签：asp.net, iis-7

我最近设置了一台新的开发 PC，它是 64 位并具有 IIS 7。我正在开发一个 Web 应用程序，我会定期将其部署到我的旧开发 PC 上。在我的新开发 PC 上，我收到以下错误提示：

```
[SocketException (0x273b): The requested protocol has not been configured into the system, or no implementation for it exists]
System.Net.Dns.InternalGetHostByAddress(IPAddress address, Boolean includeIPv6, Boolean throwOnFailure) +1576906
System.Net.Dns.GetHostByAddress(String address) +117
_Default.Page_Load(Object sender, EventArgs e) +154
System.Web.UI.Control.OnLoad(EventArgs e) +99
System.Web.UI.Control.LoadRecursive() +50
System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +627 
```

我已调试该错误，并将其跟踪到以下行：

```
System.Net.Dns.GetHostByAddress(Request.ServerVariables.Item("REMOTE_HOST")).HostName 
```

如果我注释掉这一行，那么它会完美运行。这条线有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T13:35:15.333

GetHostByAddress 已过时，现在使用 GetHostEntry，请查看以下链接

[http://msdn.microsoft.com/en-us/library/dat0fbe2%28v=vs.80%29.aspx](http://msdn.microsoft.com/en-us/library/dat0fbe2%28v=vs.80%29.aspx)

# c# - 在继承映射类中重新映射属性

> ID：10141760
> 
> 赞同：0
> 
> 时间：2012-04-13T13:28:51.530
> 
> 标签：c#, fluent-nhibernate

我有一个基本地图类（在它自己的程序集中），其中 Segment 属性被声明为**LazyLoad**。

```
public class GroupMap : ClassMap<Group>
{
    public GroupMap()
    {
        ....

        Map(x => x.Segment)
            .LazyLoad();
    }
} 
```

在我的应用程序中，我希望此属性不是 LazyLoad。我尝试了一些这样的方法：

```
public class MyGroupMap : GroupMap
{
    public MyGroupMap() : base()
    {
        Map(x => x.Segment)
            .Not.LazyLoad();
    }
} 
```

并将此类添加到映射。但它只生成一个运行时异常（属性段已经映射。很明显）。有什么建议么？我认为 Properties 属性可能会有所帮助，但已被弃用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T05:17:31.383

我在流利的 nhibernate google-group 中得到了答案。主要思想是创建一个映射了主要属性的基础映射类（GroupMapBase）。还有具有延迟加载属性的 GroupMap 类。以及基于 GroupMapBase 的 MyGroupMap 类，其中需要映射的属性没有延迟加载。

它解决了我的问题。

# php - 如何使用 php jquery 制作高效的通知生成器

> ID：10141762
> 
> 赞同：1
> 
> 时间：2012-04-13T13:28:57.067
> 
> 标签：php, jquery, database-design, notifications

我正在做一些小的事情，正在考虑制作一个像 facebook 这样的好的通知生成器。主要是我想要表格的外观。如何进行更新以及我应该拥有的所有必需品和注意事项谢谢

我有用户在他们上传图片时像个人资料一样发表评论

Facebook 的做法

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T13:41:50.777

There's many ways to do it, one of which is to have a column in the table titled `new_notification` that will tell you if the notification is new(read by the user or not). So, for example, if a person likes another persons picture, in the table that column will have `new_notification` set to `Y`. When the user who's picture was liked logs into the website, you search for all rows where `new_notification = Y` do a count and show the number of notifications like facebook does. Once the user has seen the notifications or opened the notification bar, go through that table and set all the rows with `new_notification = Y` to `'N'`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T14:26:33.190

是的，我同意@Interstellar_Coder，您可以将您的帖子页面信息存储在数据库表的一行中，并将您的类似信息存储在另一个表中。通过 ID 参考该人喜欢的图片。

表一（图片贴）：

```
ID | Picture    | Comments   | who
1  | (pic data) | my picture | user.name_1 
```

表2（喜欢）：

```
row_ID | picture_ID | who
0      | 1          | user.name_2
1      | 1          | user.name_3 
```

所以在这个例子中你有 1 张图片由 user.name_1 发布，那么这张图片已经被 user.name_2 和 user.name_3 点赞。我们知道这一点是因为`likes`表中的 picture_ID 字段。

你可以在你的数据库中查看谁喜欢ID=1的图片帖子，它会告诉你谁喜欢它，mysql代码示例：

```
select who from likes where picture_ID = 1; 
```

# facebook - 来自 iframe 应用程序的监听器喜欢和不同的按钮

> ID：10141764
> 
> 赞同：0
> 
> 时间：2012-04-13T13:28:58.737
> 
> 标签：facebook, facebook-iframe

我为粉丝页面制作了一个 iframe 应用程序，问题是如果用户在 facebook 的顶部栏中单击 LIKE，它会重新加载应用程序 iframe 页面，但如果用户在同一位置单击 UNLIKE，则不会刷新

我的应用程序检查用户是否喜欢或不喜欢粉丝页面，如果首先不点击 LIKE 按钮，它将无法继续（喜欢按钮是指顶部栏中的 iframe 应用程序之外的按钮）

```
<div id="fb-root"></div>
<script>
window.fbAsyncInit = function() {
FB.init({
  appId      : '<?php echo $app_id; ?>', // App ID
  status     : true, // check login status
  channelUrl : '//www. domain .it/<?php echo $sub_dir_app; ?>/cf.php', // Channel File
  cookie     : true, // enable cookies to allow the server to access the session
  xfbml      : true  // parse XFBML
});
FB.Event.subscribe('edge.remove', function(response) {
//top.location.reload();
    alert('ok NOLIKE');
});
FB.Event.subscribe('edge.create', function(response) {
//top.location.reload();
    alert('ok LIKE');
});
};
// Load the SDK Asynchronously
(function(d){
 var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
 if (d.getElementById(id)) {return;}
 js = d.createElement('script'); js.id = id; js.async = true;
 js.src = "//connect.facebook.net/it_IT/all.js";
 ref.parentNode.insertBefore(js, ref);
}(document)); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T13:39:05.177

使用 Javascript SDK 的方法`'FB.Event.subscribe'`。这些事件是： `edge.create`- 喜欢 `edge.remove`- 不一样

阅读更多： [https ://developers.facebook.com/docs/reference/javascript/FB.Event.subscribe/](https://developers.facebook.com/docs/reference/javascript/FB.Event.subscribe/)

# coding-style - 格式化大型方法

> ID：10141765
> 
> 赞同：-1
> 
> 时间：2012-04-13T13:29:00.893
> 
> 标签：coding-style

就编码风格而言，我遇到了两个问题，我只是想知道解决它们的最佳方法是什么？

第一个是带有许多参数的方法，我一直在做两件事之一（为了演示而使用Java）。

```
someObj.bigMethod(someData,
                  moreData,
                  evenMoreData,
                  moar,
                  andMore); 
```

和

```
someObj.bigMethod
    (
        someData,
        moreData,
        evenMoreData,
        moar,
        andMore
    ); 
```

有时还打算一路回来。

至于方法的声明，我倾向于#1

```
class SomeClass
{
    public void someMethod(int someData,
                           int moreData,
                           int evenMoreData,
                           int moar,
                           int andMore)
    {
        // Blah
    }
} 
```

对于我喜欢#2的电话，因为它更快地写出来（是的，我很懒）并且完成了工作。但显然这可能会令人困惑，因为它使用与我格式化花括号的方式相似的样式，乍一看，人们可能会认为这是对某些东西的声明，我不知道，很难说我什么时候是那个实际上写它。

我遇到的另一个问题，虽然不经常，是当一个方法在一个类中的一个类中的一个类中，等等。我什至不知道如何格式化这个烂摊子，我只是猜测首先拥有它是不好的做法，但是嘿，它发生了。

```
someObj.anotherObj.yetAnotherObj.betterThanTheNextObj.nextObj.someMethod(); 
```

也许没有到如此极端的程度，但相似，尤其是当名字很大的时候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T13:34:21.080

1.  对于声明，我也肯定赞成方法1

2.  对于方法调用：如果间接链太长，您可以随时使用变量将其切断：

    var currentAnotherObj = someObj.anotherObj.yetAnotherObj; var currentNextObj = currentAnotherObj.betterThanTheNextObj.nextObj;

    currentNextObj.someMethod();

高温高压

# javascript - 改变 textarea 的高度取决于 DOM 负载上的文本

> ID：10141778
> 
> 赞同：0
> 
> 时间：2012-04-13T13:29:57.147
> 
> 标签：javascript, jquery, html, css, dom

加载 DOM 后，我想检查所有文本区域并根据包含的文本更改它们的高度。它应该看起来像这样：

```
 $().ready(function (){
     //my check textares code
 }); 
```

谁能给我建议如何做到这一点？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T13:43:01.507

既然你使用jquery，你不妨为此使用[插件jgrow](https://github.com/berkerpeksag/jGrow/tree/master/src)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T13:56:52.720

你应该使用 jquery 插件 Autosize。

你可以下载这个： [http ://www.jacklmoore.com/autosize](http://www.jacklmoore.com/autosize)

像这样声明：

```
$(document).ready(function(){
    $('textarea').autosize();  
}); 
```

# jquery - 索引检查行为

> ID：10141782
> 
> 赞同：-1
> 
> 时间：2012-04-13T13:30:05.840
> 
> 标签：jquery

我对这段代码有一个非常奇怪的问题：在这个[小提琴](http://jsfiddle.net/USvwp/)中，它提醒“红色”的索引为 0（我想提醒），但在我的本地计算机上它提醒检查不起作用......有人可以告诉我为什么会这样？

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
  <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-2" />
  <meta name="author" content="Dejan Peic"/>
  <meta name="description" content=""/>
  <meta name="keywords" content=""/>

 <style type="text/css">
 .wrapper{
 width:100px;
 height:150px;
 border:1px solid #000000;
 margin:0auto;
 position:relative;
 display:block;
 }
 .red{
 width:100px;
 height:50px;
 display:block;
 background-color:red;
 }
 .blue{
 width:100px;
 height:50px;
 display:block;
 background-color:blue;
 }
.green{
 width:100px;
 height:50px;
 display:block;
 background-color:green;
 }
.checkIndex{
width:150px;
height:20px;
background-color:black;
color:white;
}
</style>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"  type="text/javascript"></script>
  <script type="text/javascript">

  var red = $('.red');
  var active = $('.active');
  var redIndex = red.index();
  var activeIndex = active.index();
  $(document).ready(function(){
  $('.wrapper div:last').addClass('active');

  $('.checkIndex').click(function(){

  if(redIndex > activeIndex){
  alert('Red has index 0');
  }

  else{
  alert('check doesnt work :(');
  }

  });

  });
  </script>
  </head>
  <body>
  <div class="wrapper">
  <div class="red"></div>
  <div class="blue"></div>
  <div class="green"></div>
  </div><!--/wrapper-->
  <div class="checkIndex">Check index of RED</div>

  </body>
  </html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T13:31:14.370

您需要移动这些行：

```
var red = $('.red');
var active = $('.active');
var redIndex = red.index();
var activeIndex = active.index(); 
```

在你的`$(document).ready(...)`函数里面。

在该函数之外，指定的 DOM 元素尚不存在。

它仅适用于 jsfiddle，因为默认情况下，该站点会自动将您的代码包装在`onload`处理程序中，从而达到相同的效果。

# spring-mvc - Spring beans属性绑定错误

> ID：10141784
> 
> 赞同：0
> 
> 时间：2012-04-13T13:30:06.613
> 
> 标签：spring-mvc

org.springframework.beans.factory.BeanCreationException：创建 ServletContext 资源 [/WEB-INF/tracker-servlet.xml] 中定义的名称为“workingTimeController”的 bean 时出错：bean 的初始化失败；嵌套异常是 java.lang.IllegalArgumentException: Validator [de.intec.tracker.controller.WorkingTimeController@4610fa] 不支持命令类 [de.intec.tracker.dto.WorkingTimeDTO]

工作控制器是java中的控制器类

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T13:56:47.273

您可以定义如下代码片段

LoginFormCommand com.aims.commands.LoginFormCommand

验证器应该使用验证器接口，如下面的代码片段

公共类 LoginFormValidator 实现 Validator {

```
public boolean supports(Class arg0) {
    // TODO Auto-generated method stub
    return LoginFormCommand.class.equals(arg0);

}

public void validate(Object obj, Errors errors) {
    // TODO Auto-generated method stub
    LoginFormCommand login = (LoginFormCommand) obj;
    System.out.println("validate==============");
    ValidationUtils.rejectIfEmpty(errors,"username","field.required", "Required field");
    ValidationUtils.rejectIfEmpty(errors,"password","field.required", "Required field");
    } 
```

}

# android - 如何在 Android 中获取 TabBar 选项卡的对象？

> ID：10141793
> 
> 赞同：0
> 
> 时间：2012-04-13T13:30:51.543
> 
> 标签：android, tabbar

在 Android 应用程序中，我使用的是由 4 个选项卡组成的 TabBar。我需要获取 4 个选项卡的所有对象。如何实现这一点，任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T13:42:47.437

```
 TabHost.TabSpec spec; // This is the Object of TabBar
        Intent intent;

        // Single Activity
        intent = new Intent().setClass(this, Home.class);
        spec = tabHost.newTabSpec(getResources().getString(R.string.Home)).setIndicator(getResources().getString(R.string.Home),res.getDrawable(R.drawable.home)).setContent(intent);
        tabHost.addTab(spec); 
```

现在你可以像这样添加不同的标签

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T14:24:43.037

我可以想到两种明显的方法：

1.  使用 a [`LocalActivityManager`](http://developer.android.com/reference/android/app/LocalActivityManager.html)（应该在每个中可用`ActivityGroup`，因此也在 中`TabActivity`）提供的函数来检索活动。您可以`Activity`通过调用获得当前选择的内容，也可以`getCurrentActivity()`通过传入用作 : 一部分的标签`TabSpec`来获取任何内容`getActivity(String id)`。
2.  针对活动构建您自己的本地标签映射并将其用于查找；例如一个`Map<String, Activity>`。

在这两种情况下，您都需要将泛型`Activity`转换为您自己的实现，以便访问您自己的方法。如果活动都应该实现类似的方法，我建议您使用声明这些方法的接口，并使用该接口进行转换/映射；例如`Map<String, ITabbedActivity>`。

或者，您可以使用一个成员变量 per 简单地跟踪不同的活动`Activity`。这样你就可以避免铸造。并不是说如果您要处理四个以上的选项卡，我不建议您采用这种方法。

# javascript - Socket.IO 的原始“this”上下文

> ID：10141795
> 
> 赞同：3
> 
> 时间：2012-04-13T13:30:54.387
> 
> 标签：javascript, socket.io, prototype

我已将（客户端）socket.io 包装在原型类中：

```
Chat.Client = Class.create();

Chat.Client.prototype = {

    initialize: function() {
        ...
        this.socket.on('message', this.on_message);
        ...
    },

    on_message: function(data) {
        this.add_chat_message(data.something);
    }

    do_something: function(something) {
        ...
    } 
```

这不起作用，因为 on_message 中的“this”将是“SocketNamespace”。传统上我会通过将“this”作为附加参数传递给回调来解决这个问题，但是因为我使用的是 socket.io，所以我不能简单地这样做。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-13T13:32:58.673

您可以将其包装在另一个函数中：

```
initialize: function() {
  // ...
  var client = this;
  this.socket.on('message', function(data) { client.on_message(data); }); 
```

在较新的浏览器（或 Node.js）中，您也可以在`Function`原型上使用名为“bind”的函数：

```
 this.socket.on('message', this.on_message.bind(this)); 
```

“bind”函数返回一个函数，当调用该函数时，将强制以给定值作为`this`值调用原始函数（“on_message”）。

# google-image-search - 通过图像 API 进行谷歌搜索？

> ID：10141800
> 
> 赞同：56
> 
> 时间：2012-04-13T13:31:05.120
> 
> 标签：google-image-search

对于我的工作，我正在研究一个想法，人们可以使用谷歌图片搜索并使用他们找到的任何名人照片。谷歌会返回结果，然后在我们这边，会有一个专业人士的数据库，展示如何获得特定的外观。

我假设这是极不可能的，因为用户可以使用任何照片。

那么，有没有一种方法可以让我拥有大约 100 张左右的名人照片，让 Google Image 结果可以与之比较，然后选择最接近的一张。

基本上：

1.  拖放小甜甜布兰妮的照片
2.  使用该图片进行 Google 搜索
3.  Google 的结果将排名靠前的图片与我们的 100 张图片进行比较，并选择最接近的匹配。
4.  用户可以看到如何让布兰妮斯皮尔斯看起来的视频。

我不是程序员，但正在寻找一些 API 或 Search by Image 扩展，可以让我工作的程序员远程实现这一点。是否存在类似的东西（通过图像 api 搜索）？我能找到的最好的只是支持页面，它几乎没有任何帮助： http: [//support.google.com/images/bin/answer.py ?hl=en&p=searchbyimagepage&answer=1325808](http://support.google.com/images/bin/answer.py?hl=en&p=searchbyimagepage&answer=1325808)

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2015-03-13T09:53:02.127

您可以通过将其插入地址栏中轻松地搜索现有图像：

[https://www.google.com/searchbyimage?site=search&sa=X&image_url=](https://www.google.com/searchbyimage?site=search&sa=X&image_url=) **YOUR_IMAGE_URL**

例子：

[https://www.google.com/searchbyimage?site=search&sa=X&image_url=http://cdn.sstatic.net/Sites/stackoverflow/company/img/logos/so/so-icon.png](https://www.google.com/searchbyimage?site=search&sa=X&image_url=http://cdn.sstatic.net/Sites/stackoverflow/company/img/logos/so/so-icon.png)

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2012-04-13T13:37:40.903

抱歉，Google 图片 API 已被[弃用](https://developers.google.com/image-search/)：

> 重要提示：Google 图片搜索 API 已于 2011 年 5 月 26 日正式弃用。它会根据我们的弃用政策继续工作，但您每天可以提出的请求数量可能会受到限制。

很确定有一些替代品（[http://www.tineye.com/](http://www.tineye.com/)和[http://mrisa.mage.me.uk](http://mrisa.mage.me.uk)）

更新（2013 年）：现在有允许图像搜索的[Google 自定义搜索。](https://developers.google.com/custom-search/json-api/v1/overview)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-03-06T12:36:50.070

这些答案已经过时了，但问题出现在搜索中。因此，[Google Vision API](https://cloud.google.com/vision/)具有执行反向图像搜索的“网络检测”功能。每月前 1000 个请求是免费的，之后 3.50 美元/1000 美元。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-03-20T15:31:41.117

我认为[Google Web Detection](https://cloud.google.com/vision/docs/internet-detection)可能是您的解决方案。谷歌将其从图片搜索中永久移除

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-07-09T11:45:22.450

您可以通过 www.images.google.com 进行操作，但只能通过浏览器进行（让您上传自己的图像并将其与类似图像进行比较）。我正在通过代码（而不是浏览器）来做这件事。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-01-20T16:28:10.607

我遇到了同样的问题并提出了两个解决方案：

1.  现在有许多提供反向图像搜索结果的 API。我使用的是[https://reverseimageapi.com](https://reverseimageapi.com)和 TinEye.com。

2.  正如所选答案所提到的，您可以轻松地抓取此信息，但几乎可以肯定需要轮换代理以防止被搜索引擎禁止。有很多代理轮换服务（Zyte、Oxylabs、ScrapingBee 等）让您的生活更轻松。

由于抓取搜索引擎和元素更改/破坏的维护，我最终选择了选项 1。

# facebook - 在我的 facebook 粉丝页面的墙上发布的 PHP 脚本问题和 $access_token 的永久值

> ID：10141801
> 
> 赞同：1
> 
> 时间：2012-04-13T13:31:05.557
> 
> 标签：facebook, facebook-graph-api

> **可能重复：**
> [将上传的图像传递给 facebook->api 函数的 PHP SCRIPT 问题](https://stackoverflow.com/questions/10152313/php-script-issue-with-passing-the-uploaded-image-to-facebook-api-function)

我有这段代码，它的工作非常好，只有一个问题我无法将我上传的图像传递给 facebook->api（无论它是否有效），以下总是回显 echo 'Only jpg、png 和 gif 图像支持类型！'; 我什至删除了对图像类型的检查并尝试从 $img = realpath($_FILES["pic"]["tmp_name"]); 但是 $img 什么都没有，并默认在 facebook 上上传一个空图像作为我的页面 请检查我的以下代码，让我知道我的代码应该有什么问题，这样我就可以上传图像了

```
 <?

require 'src/facebook.php';

$app_id = "364900470214655";
$app_secret = "xxxxxxxx";

$facebook = new Facebook(array(
 'appId' => $app_id,
 'secret' => $app_secret,
 'cookie' => true,
 'fileUpload' => true,
));

$user = $facebook->getUser();
//echo $user;

if(($facebook->getUser())==0)
{
 header("Location:{$facebook->getLoginUrl(array('req_perms' => 'user_status,publish_stream,user_photos,offline_access,manage_pages'))}");
 exit;
}
else {
$accounts_list = $facebook->api('/me/accounts');
echo "i am connected";
}
  $valid_files = array('image/jpeg', 'image/png', 'image/gif');

//to get the page access token to post as a page
foreach($accounts_list['data'] as $account){
      if($account['id'] == 194458563914948){      // my page id =123456789
        $access_token = $account['access_token'];
        echo "<p>Page Access Token: $access_token</p>";
        }
    }

//posting to the page wall

if (isset($_FILES) && !empty($_FILES))
{  
if( !in_array($_FILES['pic']['type'], $valid_files ) )
{
  echo 'Only jpg, png and gif image types are supported!';
 }
 else{
  #Upload photo here
  $img = realpath($_FILES["pic"]["tmp_name"]);
$attachment = array('message' => 'this is my message',
                'access_token'  => $access_token,
                'name' => 'This is my demo Facebook application!',
                'caption' => "Caption of the Post",
                'link' => 'example.org',
                'description' => 'this is a description',
                'picture' => '@' . $img,
                'actions' => array(array('name' => 'Get Search',
                                  'link' => 'http://www.google.com'))
                );
$status = $facebook->api('/194458563914948/feed', 'POST', $attachment);   // my page id =123456789
var_dump($status);
}
}
?>
<body>
 <!-- Form for uploading the photo -->
 <div class="main">
  <p>Select a photo to upload on Facebook Fan Page</p>
  <form method="post" action="<?php echo $_SERVER['PHP_SELF']; ?>" enctype="multipart/form-data">
  <p>Select the image: <input type="file" name="pic" /></p>
  <p><input class="post_but" type="submit" value="Upload to my album" /></p>
  </form>
 </div>
</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T15:01:59.857

**创建新相册并添加照片**

这是您将照片上传到 ALBUM_ID/photos Graph API 端点的场景。此示例的用户界面允许用户在提交新照片之前选择照片并添加标题。

使用 PHP：

* * *

```
<?php

       $app_id = "YOUR_APP_ID";
       $app_secret = "YOUR_APP_SECRET";
       $post_login_url = "YOUR_POST-LOGIN_URL";
       $album_name = 'YOUR_ALBUM_NAME';
       $album_description = 'YOUR_ALBUM_DESCRIPTION';

       $code = $_REQUEST["code"];

       //Obtain the access_token with publish_stream permission 
       if(empty($code))
         {
           $dialog_url= "http://www.facebook.com/dialog/oauth?"
           . "client_id=" . $app_id 
           . "&redirect_uri=" . urlencode($post_login_url)
           . "&scope=publish_stream";
           echo("<script>top.location.href='" . $dialog_url . 
           "'</script>");
       } 
       else {
         $token_url= "https://graph.facebook.com/oauth/"
         . "access_token?"
         . "client_id=" .  $app_id 
         . "&redirect_uri=" . urlencode( $post_login_url)
         . "&client_secret=" . $app_secret
         . "&code=" . $code;
         $response = file_get_contents($token_url);
         $params = null;
         parse_str($response, $params);
         $access_token = $params['access_token'];

         // Create a new album
         $graph_url = "https://graph.facebook.com/me/albums?"
         . "access_token=". $access_token;

         $postdata = http_build_query(
         array(
          'name' => $album_name,
          'message' => $album_description
            )
          );
         $opts = array('http' =>
         array(
          'method'=> 'POST',
          'header'=>
            'Content-type: application/x-www-form-urlencoded',
          'content' => $postdata
          )
         );
         $context  = stream_context_create($opts);
         $result = json_decode(file_get_contents($graph_url, false, 
           $context));

         // Get the new album ID
         $album_id = $result->id;

         //Show photo upload form and post to the Graph URL
         $graph_url = "https://graph.facebook.com/". $album_id
           . "/photos?access_token=" . $access_token;
         echo '<html><body>';
         echo '<form enctype="multipart/form-data" action="'
         .$graph_url. ' "method="POST">';
         echo 'Adding photo to album: ' . $album_name .'<br/><br/>';
         echo 'Please choose a photo: ';
         echo '<input name="source" type="file"><br/><br/>';
         echo 'Say something about this photo: ';
         echo '<input name="message" type="text"
            value=""><br/><br/>';
         echo '<input type="submit" value="Upload" /><br/>';
         echo '</form>';
         echo '</body></html>';
      }
 ?> 
```

# cocoa-touch - 了解核心数据并在删除后保存 NSManagedObjectContext

> ID：10141803
> 
> 赞同：0
> 
> 时间：2012-04-13T13:31:06.867
> 
> 标签：cocoa-touch, core-data, io, nsmanagedobject

我有一个核心数据生成类“项目”。它具有“类型”的属性，这是另一个类。

我已经自定义了“setType”，以便进行其他一些处理 - 例如，我更新了“dateTypeLastSet”。到目前为止，这工作正常。

但是，由于某种原因，当我删除该项目时，也会发生这种额外的处理。具体来说，直到我在 NSManagedObjectContext 上调用“保存”时才会发生这种情况。

这是因为删除会导致自动调用“setType:nil”吗？记录参数表明 NULL 是尝试的分配。

这对我来说是个问题，因为在我的附加处理代码中，我执行了一些计算。假设我在其中存储了一些“设置项目类型的次数”的计数器。我不希望删除和设置为 nil 被计算在内。但我也不能只检查 nil，因为这可能是一个合法的更新（nil 作为一种类型可能是可以接受的）。

任何解释或建议表示赞赏。

更新

事实证明，当类型被删除时，它确实将该属性设置为 nil - 我注意到数据实体的删除规则默认为无效。如果将其更改为无操作，则我没有此问题。

所以现在的问题变成了 - 将删除规则从无效更改为其他影响是什么？为什么这被视为合理的默认值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T14:56:43.720

似乎 nullify 是一个合理的默认值，因为一旦“类型”不再存在，有一个指向它的流浪指针可能是危险的。如果您在文档中查找 NSNoActionDeleteRule ，它会说：

> “如果您使用此规则，则您有责任维护对象图的完整性。除高级用户外，强烈建议不要使用此规则。”

# iphone - 模态视图防止其他视图旋转

> ID：10141805
> 
> 赞同：2
> 
> 时间：2012-04-13T13:31:08.597
> 
> 标签：iphone, objective-c, ios

我的 MainViewController 中有这个方法：

```
-(void)willAnimateRotationToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration
{
    NSLog(@"MAIN CONTAINER WILL ANIMATE");
    [super willAnimateRotationToInterfaceOrientation:toInterfaceOrientation duration:duration];
} 
```

当我旋转时，NSLog 出现了，一切都很完美。但是，如果我从 MainViewController 中显示 modalViewController，然后旋转，则 NSLog 不再出现，并且我的 MainViewController 永远不知道设备已旋转，因此当 modalView 被关闭时，界面不会针对旋转进行调整。

关于为什么模式视图可以阻止父级接收旋转更新的任何想法？这是典型的，还是我的设置有问题？

为了确保，我尝试通过 modalViewController 将 modalViewController 呈现为子视图`[mainViewController.view addSubview:modalView.view]`，并且旋转更新正确生效。只有当我这样做时`[mainViewController presentModalViewController:modalViewController];`，更新才会生效。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-13T13:43:19.913

当然，当视图控制器以模态方式呈现时，其他视图控制器根本不会收到任何消息。这就是模态在这种情况下的含义。

显而易见的解决方案是检查无模式视图控制器的 viewWillAppear 方法中的方向。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T13:38:27.477

您必须检查以下内容的实施：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
    // Overriden to allow any orientation. 
    return YES;
 } 
```

在这两种观点中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T13:52:34.127

您需要在 viewWillAppear 中将布局调整为当前界面方向。显然，由于视图是不可见的，因此在模态视图控制器启动时不会调用动画函数。

# button - 使用 extjs 中的按钮下载文件

> ID：10141814
> 
> 赞同：2
> 
> 时间：2012-04-13T13:31:18.783
> 
> 标签：button, extjs, download, handler

在窗体中，我有一个下载按钮

```
{
                        xtype: 'button',
                        text: 'Download CSV',
                        style: 'margin:18px 0 0 10px',
                        handler: function () {
                            console.log('download data');
                        }

                    } 
```

我想下载：单击此按钮时的 export.csv。我试着用

```
window.open('export.csv','download') 
```

这适用于 chrome、ff 和 ie9。但在 ie8 中，除非您更改浏览器中的设置，否则它不起作用。有没有更好的方法来使用按钮下载文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T13:49:13.330

强制下载文件的一种方法是在服务器上使用代理。通常，您会将文件名传递给代理，然后它会输出 MIME 标头和文件。

但是，您不能用 EXT 真正做到这一点。你如何做到这一点将取决于你的服务器端平台。

请参阅：[https ://stackoverflow.com/search?q=force+download](https://stackoverflow.com/search?q=force%20download)

# winforms - 失去对 WinForm 的控制

> ID：10141815
> 
> 赞同：1
> 
> 时间：2012-04-13T13:31:19.813
> 
> 标签：winforms, visual-studio-2008, c#-3.0, controls

我一直在使用 Visual Studio 2008 递归地改进 UI，我似乎在无数其他控件层下失去了一个控件。该项目*被*签入我们的版本控制软件（我在进行足够大的更改后签入 - 例如移动某些东西或添加到 UI，或添加一个方法）。

用户界面的改进直接来自老板，他喜欢在我们讨论任何需要进行的更改时四处移动——我想这还不错。我在他开始工作之前签到，并写下他所做的一切（以防我们需要重新创建它），然后如果没有任何重大变化，请再次检查 UI。

我想我应该提到我正在使用 .Net 3.5（因为我们还不能升级到 VS2010）和 C#，以及一些自定义控件（但其中大多数是内置的 .NET 控件）。

在某个地方，我失去了一个文本框控件。它仍然列在表单属性窗口中，我仍然可以从那里选择它。但是当我查看表格时，似乎没有任何突出显示的内容。

我已经移动了大部分控件（在可能的情况下，因为其中一些控件停靠在表单的两侧，或者彼此停靠。我知道糟糕的 UI 设计。但这就是老板想要的方式）并重新排序（发送到后面/前面），并且可以一直回到表单的背景（在大多数地方）。但我还是找不到。

在这一点上，我倾向于从表单中删除/删除控件并重新开始，而不是找到它并将其移动到新位置。但是，由于我似乎找不到它，我不确定是否可以。

除了选择它并按下删除键之外，是否可以通过某种方式删除控件？我宁愿不必跳回旧版本的 UI，因为我最近做了很多小的更改（并在每次更改后都进行了检查），我不知道这个文本框什么时候丢失了。

**编辑：**

如果它有用，下面是文本框控件的一些属性：

*   尺码: 356, 0
*   地点：1、1
*   多行：真
*   文本：
*   码头：填充

我已在 text 属性中添加了文本，并再次移动了所有内容，但仍然找不到。我也一直在弄乱 Dock 属性，以便在表单中移动它以使其更容易找到。

此外，大多数 UI 都使用组框和面板，因为我发现在需要时以这种方式隐藏和禁用/显示和启用控件组更容易。

**编辑2：**

文本框属性现在是（基于答案中的一些有用建议）：

*   尺寸：356、150
*   地点：150、150
*   码头：无
*   多行：真
*   文字：“你在哪里？”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T13:37:30.700

好吧，它的高度为 0（大小：356, **0**）。将其更改为有意义的内容，您将再次开始看到控件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T13:45:19.323

问题可能很少。试试这些。

1.  如果您在工作室中使用团队服务器，那么您可以右键单击待处理的更改并查看旧版本，您可以看到以前与当前所做的更改，所以您知道想要出错。

2.  控件属性可见性设置为 true。即：textbox1.visibility=true；

3.  如果控件停靠以填充，则它将另一个控件包装在其下。因此，请尝试使用控件属性。

# c# - 如何根据for循环多次提交表单？

> ID：10141816
> 
> 赞同：0
> 
> 时间：2012-04-13T13:31:20.890
> 
> 标签：c#, jquery, asp.net-mvc, for-loop

我正在使用带有剃须刀模板的 asp.net C# MVC3，并想了解以下内容：

我有一个表格，这个表格包含一个按钮。如果我单击按钮，将执行以下代码：

```
function OnGetSelectedFieldValues(result) {
    for (var i = 0; i < result.length; i++) {
        $("#id").val(result[i]); //This will replace the value of my hidden field with the selected id
        $("#DeleteForm").submit();
    }
} 
```

根据我的逻辑，这应该提交并删除我从 gridview 中选择的每一行。它确实选择了每条记录，我用 Javascript“alert()”对此进行了测试。但它只删除了第一条记录，为什么会发生这种情况，我该如何解决？

问候，

马可

编辑：这是我的表格（为了更容易理解）：

```
 @using (Html.BeginForm("Delete", "Home", FormMethod.Post, new { id = "DeleteForm" }))
    {
        <input type="hidden" id="id" name="id" />
        <input type="button" id="button" value="Verwijder geselecteerde" />
    } 
```

我的控制器：

```
[HttpPost]
    public ActionResult Delete(int id)
    {
        ErrorRepository repo = new ErrorRepository();
        var test = repo.GetById(id);
        repo.Delete(test);
        return RedirectToAction("Index");
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T13:43:22.237

因为您正在表单上进行直接 POST，所以它只会在第一次循环中执行，因为表单在进入下一个循环时已经在发布。

这不是处理多次删除的正确方法，但如果您必须这样做，则需要创建一个 AJAX 发布方法，以便可以异步进行多次删除。

更好的方法是将要删除的完整 ID 列表传递给 POST 表单，然后在服务器端一次将它们全部删除。您应该构建一串以逗号分隔的 ID 并将其发送到 POST 方法。然后在方法中使用

```
 var _ids = values.split(',');
    foreach(var _id in _ids){
        YourDeleteMethod(Int32.Parse(_id));
    } 
```

如果您必须通过多个帖子完成此操作，您将需要以下内容：

```
function OnGetSelectedFieldValues(result) {
    for (var i = 0; i < result.length; i++) {
        $.post("yourPostURL",  result[i]);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T13:37:02.373

每页只能提交一个表单，尝试实现一个请求删除多条记录的方法！

# android - Android Browser PhoneGap no Caret (cursor) inside form

> ID：10141820
> 
> 赞同：2
> 
> 时间：2012-04-13T13:31:43.527
> 
> 标签：android, cordova

在这一点上，我束手无策......我无法让文本插入符号出现在表单的输入区域内。这是一个基于 phonegap 的应用程序，至少可以说非常简单。通过 css onfocus 我可以在文本框周围放置一个黄色突出显示..所以很明显我得到了焦点。

这是表单的样子：

```
<form method = "post" autocomplete="off" action="portal.html" style = "top:20%; width:250px; position:absolute; left:480px; right:auto; margin-top:0px; margin-bottom:0px;">

        <label>Username:</label>
        <input type="text"   name="username" maxlength="40" style = "font-size: 20px;"/> 
        <label>Password:</label>
        <input type="password" name="password"  maxlength="40" style = "font-size: 20px;"/>     
        <input type="submit" class="submit" style = "left:20px; position:relative; cursor:auto;"/>

</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T19:41:05.233

你用的是什么设备？

不幸的是，每个设备都以不同的方式实现 WebView（大多数浏览器和基于 HTML 的框架，如 PhoneGap 使用的组件），并且一些小部件（如输入小部件）不会显示克拉或边框，或者会破坏它们的边框（HTC 是最严重的违规者） .

另外，您的输入元素是否附加了任何 CSS 样式规则？如果是这样，请将它们移除，因为它们也可能隐藏了克拉。

# java - 日期年份的 JPA 约束

> ID：10141826
> 
> 赞同：2
> 
> 时间：2012-04-13T13:32:17.283
> 
> 标签：java, jpa, unique-constraint

我有一个代表文档的实体，如下所示：

文档 date_creation doc_number doc_origin

文档通常被称为*'2012/XY/005'*，这将是 2012 年由 XY 发起的第五个文档。所以数字必须在它创建的年份和相同的起源中是唯一的，我需要为它设置一个约束。

使用 JPA 对其进行建模和映射的最佳方法是什么？

我认为我的选择是：

**选项1：**在日期创建中放置另一个字段为年份的文档实体，并使其唯一（年份，文档编号，文档来源）

**选项 2：**创建一个字段 doc_ref 并放置一个字符串，如 'YEAR/ORIG/NUMBER' 并使其唯一（doc_ref）

两个选项都添加了另一个重复年份的字段，但选项 1 要求我更新字段年份与 date_creation 一致，选项 2 要求我更新字段 doc_ref 与其余字段一致，所以我倾向于认为选项 1 是最好的。

还有其他我没有看到的选择吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T14:01:32.973

如果您的数据库允许，您可以使用基于函数的唯一索引。Oracle 中的示例：

```
CREATE UNIQUE INDEX YEAR_ORIGIN_NUMBER_IDX 
on DOCUMENT (TRUNC(DT_CREATION, 'YEAR'), DOC_ORIGIN, DOC_NUMBER) 
```

# javascript - 如何在下面定义事件

> ID：10141831
> 
> 赞同：0
> 
> 时间：2012-04-13T13:32:43.617
> 
> 标签：javascript, jquery

我在下面有一个函数，它不允许用户在文本框中输入字母，但它一直说事件未定义。我想在哪里以及如何定义事件？

下面是函数：

```
function isNumberKey(evt)
  {
     var charCode = (evt.which) ? evt.which : event.keyCode
     if (charCode > 31 && (charCode < 48 || charCode > 57))
        return false;

     return true;
  } 
```

下面是可以使用它的html：

```
onkeypress="return isNumberKey(event)" 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-13T13:34:58.410

改变

```
var charCode = (evt.which) ? evt.which : event.keyCode 
```

至

```
var charCode = (evt.which) ? evt.which : evt.keyCode 
```

或者如果你正在使用 jQuery（你标记了它但没有使用它）你可以做

```
$('#textareaid').keypress(function(e) {
     if (e.which > 31 && (e.which < 48 || e.which > 57)) {
        e.preventDefault();
     }
}); 
```

你的html在哪里

```
<textarea id="textareaid"></textarea> 
```

见[event.preventDefault()](http://api.jquery.com/event.preventDefault/)

关于如何使用 jQuery 按下按键的注意事项

> 要确定输入了哪个字符，请检查传递给处理函数的事件对象。虽然浏览器使用不同的属性来存储这些信息，但 jQuery 对 .which 属性进行了规范化，因此您可以可靠地使用它来检索字符代码。

取自[.keypress()](http://api.jquery.com/keypress/)文档

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T13:45:59.653

这是应该工作的代码：

```
function checkerFunction(e){
    var charCode=e.which || e.keyCode;
    if(charCode<=31 || charCode>=48 && charCode<=57)return true;
    return false;
} 
```

并且事件绑定应该是

```
onkeypress="return checkerFunction(window.event)" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-22T16:25:58.817

作为记录，我认为上面的大多数答案都没有考虑到箭头键。

这应该是它的工作方式，以防你在谷歌上搜索它。

```
function isNumberKey(event)
{
   var charCode = event.charCode;
   if ((charCode < 48 || charCode > 57) && charCode != 0){
       return false;
   }
    return true;
} 
```

# ruby - gsub 在整个代码片段中都不起作用

> ID：10141833
> 
> 赞同：3
> 
> 时间：2012-04-13T13:32:50.643
> 
> 标签：ruby, gsub

使用此代码示例

```
#!/usr/bin/ruby
paragraph = "champion xylophone excellent"
paragraph = paragraph.gsub("ch","tj")
words = paragraph.split(/ /)
words.each do |word|
   if word[0,1] == "x"
     word[0.1] = "z" 
   end
end
paragraph = words.join(" ")
paragraph.gsub("x","ks")
print paragraph 
```

输出将是“tjampion zylophoneexcel”而不是“tjampion zylophone ekscellent”

如果在 each 中将 gsub 应用于单个单词，则同样适用。我不明白为什么它在开始时起作用，但在结束时却没有。

**编辑**

第二种情况与第一种情况不同：

```
#!/usr/bin/ruby
paragraph = "champion xylophone excellent"
paragraph = paragraph.gsub("ch","tj")
words = paragraph.split(/ /)
words.each do |word|
   if word[0,1] == "x"
     word[0.1] = "z" 
   end
   word = word.gsub("x","ks")
end
paragraph = words.join(" ")
print paragraph 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-13T13:35:44.507

当您第一次使用 gsub 时，您将其分配给 paragrah

```
paragraph = paragraph.gsub("ch","tj") 
```

第二次错过作业

更改`paragraph.gsub("x","ks")`为

```
paragraph = paragraph.gsub("x","ks") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T14:14:04.333

您的代码意外运行。工作部分使用修改字符串的字符串方法；不工作的部分使用产生新字符串（被丢弃）的方法。这令人困惑；`map`如果所需的结果是数组，则更好的方法是使用。它将包含块的结果，无论是修改的字符串还是新的。

```
paragraph = "champion xylophone excellent"
words = paragraph.split(' ').map do |word|
  word.gsub('ch','tj') #new string
  word[0.1] = "z" if word.start_with?('x') #modified string
  word.gsub!('x','ks') #modified string
end
puts words.join(' ') 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-13T13:44:55.080

```
paragraph.gsub!("x","ks")
puts paragraph 
```

或者使用正则表达式（一行操作可以完成所有操作）：

```
paragraph = "champion xylophone excellent"
paragraph = paragraph.gsub("ch","tj").gsub(/([\A\s])x(\w*)/){$1 + 'z'+ $2}.gsub("x","ks")

puts paragraph 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-13T13:40:54.660

If you want your `gsub` to be destructive, i.e. to change the value of the variable on which it was called, use `gsub!`. so:

```
paragraph.gsub!('ch', 'tj') 
```

rather than:

```
paragraph = paragraph.gsub('ch', 'tj') 
```

It's more concise, and Ruby developers recognize bang (!) methods as destructive. And in your case, you need the `gsub!` method in place of both calls to `gsub`

# c++ - std::set 和 std::priority_queue 之间的区别

> ID：10141841
> 
> 赞同：83
> 
> 时间：2012-04-13T13:33:22.747
> 
> 标签：c++, algorithm, sorting, priority-queue

由于`std::priority_queue`和`std::set`(and `std::multiset`) 都是存储元素并允许您以有序方式访问它们的数据容器，并且具有相同的插入复杂性`O(log n)`，因此使用一个比另一个有什么优势（或者，什么样的情况需要一个还是其他？）？

虽然我知道底层结构是不同的，但我对它们实现的差异并不感兴趣，而是对它们的**性能**和对各种用途的**适用性进行比较。**

**注意：**我知道集合中的无重复项。这就是我还提到的原因，`std::multiset`因为它具有与 完全相同的行为，`std::set`但可以在允许将存储的数据作为相等元素进行比较的情况下使用。所以请不要评论单/多键问题。

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2012-04-13T13:38:10.683

优先级队列*只*允许您按排序顺序访问*一个*元素——即，您可以获得最高优先级的项目，当您删除它时，您可以获得下一个最高优先级，依此类推。优先级队列还允许重复元素，因此它更像是一个多重集而不是一个集。[编辑：正如@Tadeusz Kopec 所指出的，构建一个堆也与堆中的项目数成线性关系，其中构建一个集合是 O(N log N) 除非它是从已经排序的序列构建的（在这种情况下它也是线性的）。]

集合允许您按排序顺序进行完全访问，例如，您可以在集合中间的某个位置找到两个元素，然后按顺序从一个元素遍历到另一个元素。

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2012-04-13T13:44:19.757

`std::priority_queue`允许执行以下操作：

1.  插入一个元素`O(log n)`
2.  获取**最小**元素`O(1)`
3.  擦除**最小**的元素`O(log n)`

而`std::set`有更多的可能性：

1.  插入任意元素`O(log n)`且常数大于in`std::priority_queue`
2.  查找**任何**元素`O(log n)`
3.  找到一个元素，>= 比您要查找的元素`O(log n)`( `lower_bound`)
4.  擦除**任何**元素`O(log n)`
5.  通过其擦除**任何**元素`iterator` `O(1)`
6.  按排序顺序移动到上一个/下一个元素`O(1)`
7.  获取**最小**元素`O(1)`
8.  获取**最大**元素`O(1)`

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2012-04-13T13:36:15.713

set/multiset 通常由二叉树支持。 [http://en.wikipedia.org/wiki/Binary_tree](http://en.wikipedia.org/wiki/Binary_tree)

priority_queue 通常由堆支持。 [http://en.wikipedia.org/wiki/Heap_(data_structure)](http://en.wikipedia.org/wiki/Heap_(data_structure))

所以问题是什么时候应该使用二叉树而不是堆？

两种结构都布置在树中，但是关于祖先之间关系的规则是不同的。

我们将位置 P 称为父，L 为左孩子，R 为右孩子。

在二叉树中 L < P < R。

在堆中 P < L 和 P < R

因此，二叉树“横向”排序，而堆“向上”排序。

因此，如果我们将其视为一个三角形，那么在二叉树中 L、P、R 是完全排序的，而在堆中 L 和 R 之间的关系是未知的（只有它们与 P 的关系）。

这具有以下效果：

*   如果您有一个未排序的数组并想将其变成二叉树，则需要`O(nlogn)`时间。如果你想把它变成一个堆只需要`O(n)`时间，（因为它只是比较找到极端元素）

*   如果您只需要极端元素（某些比较函数的最低或最高），堆会更有效。堆只进行确定极端元素所需的比较（懒惰地）。

*   二叉树执行对整个集合排序所需的比较，并始终保持整个集合排序。

*   堆具有最低元素的恒定时间查找（peek），二叉树具有最低元素的对数时间查找。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2016-04-07T10:28:36.663

> 由于`std::priority_queue`和`std::set`(and `std::multiset`) 都是存储元素并允许您以有序方式访问它们的数据容器，并且具有相同的插入复杂性`O(log n)`，因此使用一个比另一个有什么优势（或者，什么样的情况需要一个还是其他？）？

即使两个容器的*插入*和*擦除*操作具有相同的复杂度*O(log n)*，这些操作 for`std::set`比 for 慢`std::priority_queue`。那是因为`std::set`做了很多内存分配。的每个元素`std::set`都存储在自己的分配中。`std::priority_queue`（默认使用底层`std::vector`容器）使用单一分配来存储所有元素。另一方面`std::priority_queue`，对其元素使用许多交换操作，而`std::set`仅使用指针交换。因此，如果交换对于元素类型来说是非常慢的操作，那么使用`std::set`可能会更有效。此外，元素可能根本不可交换。

内存开销`std::set`也更大，因为它必须在其节点之间存储许多指针。

# macos - 如何创建 D-Cocoa 端口？

> ID：10141847
> 
> 赞同：2
> 
> 时间：2012-04-13T13:34:02.123
> 
> 标签：macos, cocoa, user-interface, d

我打算使用 D 在 Mac OS X 上创建本机应用程序。为此，当然，D 必须与 Cocoa API 交互。我不知道如何完成这种绑定。我已经看过[Cocado](http://sourceforge.net/projects/cocodao/)并且知道 Michel Fortin 的[D-ObjC 桥](http://michelf.com/projects/d-objc/)，并希望了解一些细节：

*   他们（或任何其他可能的）将 Cocoa 移植到 D 的方法是什么？——在这里，我基本上要求提供技术阅读资源（书籍/文章/参考资料等）；

*   是否可以直接或通过 C ABI 建立与 ObjC 的 ABI 兼容性？— [stackoverflow 上有一个问题，其中的答案描述了使用](https://stackoverflow.com/questions/5901508/calling-cocoa-apis-from-c)[Objective-C 的运行时参考](http://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ObjCRuntimeRef/Reference/reference.html)可以实现的目标；

*   使这种东西很好地工作并获得性能和稳定性水平是否可行，例如，在 Mac OS X 上使用 Qt 框架？

我在这个领域完全没有经验，所以请原谅我的任何技术故障。任何帮助都是不言而喻的。

提前感谢您的回复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T14:01:34.757

我在Jacob Carlborg的 dlang.org[论坛上对这个问题有更详细的回答。](http://forum.dlang.org/thread/jhijexinmerdaufnltwm@forum.dlang.org)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T22:32:53.267

*   大多数 Cocoa 端口所做的是将 .h 转换为 .di 并提供一个瘦包装器和通用工具，

    这可能会通过`opDispatch(string sel,A...)(A args)`重载包含一些语法糖，这些语法糖将转化`obj.call1(arg1).call2(arg2)`为正确的`obj_msgsend(obj.ptr,NSSelectorFromString(sel),args)`调用

*   可以通过 C ABI，您可以[在 D 规范中阅读更多相关信息](http://dlang.org/interfaceToC.html)

*   当然，Obj 可能有很多事情。C 编译器可以检查 D 编译器不能检查需要单元测试来找到那些

# ios - 当日历为日语或佛教时，iOS NSDateFormatter 格式不正确

> ID：10141848
> 
> 赞同：4
> 
> 时间：2012-04-13T13:34:05.257
> 
> 标签：ios, nsdateformatter

当在模拟器和真实设备上将 Settings/General/International/Calendar 设置为日语或佛教时，我发现 iOS 上的 NSDateFormatter 存在问题。语言设置为什么似乎并不重要，区域格式只是重新安排事情（但它仍然很糟糕）。以下结果均适用于 'Language' = English 和 'Region Format' = Japan 时的结果。

这是我的代码（启用了 ARC）：

```
// Configure the Date Formatter
NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
[dateFormatter setLocale:[NSLocale currentLocale]];
[dateFormatter setDateStyle:NSDateFormatterShortStyle];
[dateFormatter setTimeStyle:NSDateFormatterNoStyle];

// Format the date string
NSString *dateString = [dateFormatter stringFromDate:[NSDate date]]; 
```

结果：

*   iOS 4.3（日历 = 日语），dateString = “平成24/04/13”</li>
*   iOS 5.1（日历 = 日语），dateString = “H.24/04/09”</li>
*   iOS 4.3（日历 = 佛教），dateString = “BE2555/04/13”</li>
*   iOS 5.1（日历 = 佛教），dateString = “BE2555/04/13”</li>

我找到了这个链接： http: [//www.cocoanetics.com/2011/12/ios-5-break-nsdateformatter/](http://www.cocoanetics.com/2011/12/ios-5-breaking-nsdateformatter/)，这很有趣，但并没有真正指出我的解决方案。我还发现了这个：[NSDateFormatter 和 Japanese calendar](https://stackoverflow.com/questions/4677006/nsdateformatter-and-japanese-calendar)，所以我稍微改变了我的代码：

```
[dateFormatter setLocale:[[NSLocale alloc] initWithLocaleIdentifier:[[NSLocale preferredLanguages] objectAtIndex:0]]]; 
```

然后我的结果是这样的（这些对我来说似乎都是错误的，本质上是美国 MM/DD/YY 格式）：

*   iOS 4.3（日历 = 日语），dateString = “4/13/12”</li>
*   iOS 5.1（日历 = 日语），dateString = “4/13/12”</li>
*   iOS 4.3（日历 = 佛教），dateString = “4/13/12”</li>
*   iOS 5.1（日历 = 佛教），dateString = “4/13/12”</li>

在上述所有结果中，唯一对我来说正确的是带有 Calendar = Japanese 的 iOS4.3。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-01-21T21:42:04.297

The region is what effects the date format, not the language. You're setting the format to use the user's region:

`[dateFormatter setLocale:[NSLocale currentLocale]];`

If you want a consistent format across all users you can set it to the system's local:

`[dateFormatter setLocale:[NSLocale systemLocale]];`

# javascript - 单击带有 Applescript 的 JavaScript/jQuery 链接

> ID：10141849
> 
> 赞同：1
> 
> 时间：2012-04-13T13:34:07.177
> 
> 标签：javascript, applescript

我对 AppleScript 做的不多，但我正在尝试自动化这个过程。我有一个需要点击按钮的网站。然而，按钮是用 JavaScript/jQuery/AJAX 实现的，如下所示：

```
<div id="divIdOfButton" class="someClass">
    <div class="divClassOfButton someOtherClass">
        <img src="imgOfButton">
    <div>

...

<script type="text/javascript">

$(document).ready(function() {
$('#divIdOfButton .divClassOfButton).click(function() {
...
}} 
```

我试过这个没有任何运气

```
tell application "Safari"
    activate
    delay 1
    set URL of first document to "http://example.com/"
    do JavaScript "document.getElementById('divIdOfButton').getElementByClassName('divClassOfButton')[0].click()" in front document
end tell 
```

我做了一堆搜索，但找不到任何东西。非常感谢一些帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-13T14:53:51.507

大多数浏览器会忽略对 click 事件处理程序的直接调用，[看起来](https://stackoverflow.com/q/210643/990363)（显然是出于安全原因——不要让我开始了解浏览器中的 JavaScript 安全模型），所以你的`click()`调用根本什么都不做。您可以通过 JavaScript 的事件调度机制触发 click 事件（参见我的[这个问题](https://stackoverflow.com/questions/9603288/missing-value-errors-when-heavily-using-javascript-in-safari-by-applescript)和[答案](https://stackoverflow.com/a/10145332/990363)）。但是，如果您的目标站点已经包含 jQuery，那么您需要做的就是：

```
tell application "Safari"
    do JavaScript "$('#divIdOfButton .divClassOfButton').click();" in front document
end tell 
```

如果您的 类中有多个按钮，则`DIV`需要添加过滤器表达式，即

```
tell application "Safari"
    do JavaScript "$('#divIdOfButton .divClassOfButton :equ(0)).click();" in front document
end tell 
```

但是如果没有这个，您将失去`querySelectorAll`jQuery 所利用的性能优势（请参阅[jQuery API 文档](http://api.jquery.com/eq-selector/)）。

*通过在 Safari 中触发 Stack Overflow 站点上的收件箱下拉列表进行测试。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-09T17:00:47.550

我会查看[UI 浏览器](http://pfiddlesoft.com/uibrowser/)，它非常适合这类事情，我一直都在使用它。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-13T14:29:12.580

我不是 Applescript 用户，但我可以马上告诉你`getElementByClassName`应该是`getElementsByClassName`- 复数形式的“元素”。

# c# - 有什么方法可以强制允许在 XML 文件中使用“<”和/或“>”？

> ID：10141854
> 
> 赞同：1
> 
> 时间：2012-04-13T13:34:27.300
> 
> 标签：c#, xml, xmldocument

我编写了一个 C# 应用程序，它可以加载 XML 文件、解析它们并使用这些信息来运行 SQL 查询并将结果发送到电子邮件分发列表。

这些 XML 文件通常由 END 用户创建。

目前我让他们在 SQL 中用 > 和 < 替换 > 和 <，当然是他们有时会忘记的 END 用户。事实上，他们总是忘记。我更愿意将查询保存在 XML 文件中。那么，有没有办法强制/允许在 XML 文件中使用这些特殊字符？

现在我的用户必须输入：

```
<?xml version="1.0" encoding="utf-8" ?>
<report>
  <queries>
    <query>
       SELECT * FROM THETABLE WHERE THEVALUE &gt; 100
    </query>
  </queries>
</report> 
```

我希望他们能够输入：

```
<?xml version="1.0" encoding="utf-8" ?>
<report>
  <queries>
    <query>
       SELECT * FROM THETABLE WHERE THEVALUE > 100
    </query>
  </queries>
</report> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-13T13:36:53.103

您可以将查询包装在[`CDATA`](http://www.w3schools.com/xml/xml_cdata.asp)：

```
<?xml version="1.0" encoding="utf-8" ?>
<report>
  <queries>
    <query><![CDATA[
       SELECT * FROM THETABLE WHERE THEVALUE > 100
    ]]></query>
  </queries>
</report> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T13:37:04.913

使用[CDATA](http://www.w3schools.com/xml/xml_cdata.asp)，不解析 CDATA 中的文本，如下所示：

```
<query><![CDATA[SELECT * FROM THETABLE WHERE THEVALUE > 100]]></query> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-13T13:37:26.083

您需要用 CDATA 包围文本，使其看起来像这样：

```
<?xml version="1.0" encoding="utf-8" ?>
<report>
  <queries>
    <query>
       <![CDATA[SELECT * FROM THETABLE WHERE THEVALUE > 100]]>
    </query>
  </queries>
</report> 
```

这告诉解析器之间的所有内容都应该被视为文本并且不应该被解释。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-13T13:38:02.570

使用[`CDATA`](http://www.w3schools.com/xml/xml_cdata.asp). 所以：

```
<query><![CDATA[SELECT * FROM THETABLE WHERE THEVALUE > 100]]></query> 
```

*解析器会忽略CDATA*部分中的文本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-13T14:31:39.597

您可以使用正则表达式预处理文件，该表达式查找不属于标记的 < 和 >，并相应地替换它们。

您可以使用此正则表达式：

```
 (?sx)
    \s*
    (?:<\?.*?\?>)(?:\s*)
    (?:
     (?:<[^\s]*?>)\s*
     |(?:[^<>]*\s)
     |(?<lt><)
     |(?<gt>>)
    )*
    \s* 
```

（请注意，您必须使用单行并忽略空格选项，如`(?sx)`.

此表达式捕获或小于和大于不属于`lt`and`gt`组中的标记的符号。

您可以替换匹配项。

如果您想知道它是如何工作的，这将捕获命名组中的所有内容：

```
 (?sx)
    \s*
    (?<head><\?.*?\?>)(?:\s*)
    (?:
     (?<tag><[^\s]*?>)\s*
     |(?<others>[^<>]*\s)
     |(?<lt><)
     |(?<gt>>)
    )*
    \s* 
```

# jquery - 如何将多个表替换为 Div？

> ID：10141856
> 
> 赞同：4
> 
> 时间：2012-04-13T13:34:31.840
> 
> 标签：jquery, html

在我下面的第二个表的代码中，它没有保留相同的代码，它似乎被第一个表中的代码覆盖。

有没有办法让我可以保留代码但仍将我的表替换为 div 和 span？

```
 <script>
    $(document).ready(function() {

    $('table').replaceWith( $('table').html()
       .replace(/<tbody/gi, "<div class='table'")
       .replace(/<tr/gi, "<div class='ccbnOutline'")
       .replace(/<\/tr>/gi, "</div>")
       .replace(/<td/gi, "<span")
       .replace(/<\/td>/gi, "</span>")
       .replace(/<\/tbody/gi, "<\/div")
    );

    });
    </script>
    </head>
    <body>

    <!-- This will be changed into div's and span's -->
    <table width="100%" cellpadding="0" cellspacing="0">
    <tbody>
    <tr>
    <td>one</td>
    <td>two</td>
    <td>three</td>
    </tr>
    </tbody>
    </table>
    <!-- End of Example Table -->

            <!-- This will be changed into div's and span's -->
    <table width="100%" cellpadding="0" cellspacing="0">
    <tbody>
    <tr>
    <td>one123</td>
    <td>two123</td>
    <td>three123</td>
    </tr>
    </tbody>
    </table>
    <!-- End of Example Table --> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-13T14:21:20.473

这是因为您正在用多个对象的内容替换多个对象。

这里有一个固定版本：

```
<script>
    $(document).ready(function() {
        $('table').each(function (){
            $(this).replaceWith( $(this).html()
                .replace(/<tbody/gi, "<div class='table'")
                .replace(/<tr/gi, "<div class='ccbnOutline'")
                .replace(/<\/tr>/gi, "</div>")
                .replace(/<td/gi, "<span")
                .replace(/<\/td>/gi, "</span>")
                .replace(/<\/tbody/gi, "<\/div")
            );
        });
    });
</script> 
```

我让它通过一个 .each 循环运行，并用相应的表格一一替换了这些项目。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-13T14:30:14.623

您应该遍历不同的元素并生成自己的 html，而不是这样做`.replace`——使用正则表达式通常是处理 HTML 结构的不好做法。以下代码有效：

```
$('table').replaceWith(function() {
    var html = '';

    $('tr', this).each(function() {
        html += '<div class="ccbnOutline">';
        $('td', this).each(function() {
            html += '<span>' + $(this).html() + '</span>';
        });
        html += '</div>';
    });

    return '<div class="table">' + html + '</div>';
}); 
```

**小提琴：http:** [//jsfiddle.net/HRYEQ/1](http://jsfiddle.net/HRYEQ/1)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T13:40:25.037

Yes.

Just replace `$('table').replaceWith( $('table').html()` in your code with

`$('table:first').replaceWith( $('table').html()`.

# haskell - 如何从此haskell片段返回列表值

> ID：10141858
> 
> 赞同：1
> 
> 时间：2012-04-13T13:34:51.467
> 
> 标签：haskell

我知道它很冗长，但这就是我学习语法的方式。这条线在

(abCombo' a 2 lst) ... 我想返回“列表”和/或打印列表，但我无法使用此返回类型“Writer [String] [Int]”提取列表。

```
-- Loop through several integer values
-- and calculate the power of a^b, append to list
abCombo' :: Int -> Int -> [Int] -> Writer [String] [Int]
abCombo' a b lst
    | b == maxB = do
        tell [ "  ... x-Done(1): a^b = " ++ show (a^b) ++ " // " ++ show lst  ]
        return ((a^b):lst)
    | otherwise = do
        tell [ "  ... x-Processing: a^b = " ++ show (a^b) ++ " // " ++ show lst ]
        abCombo' a (b+1) ((a^b):lst)

-- Loop through several integer values
-- and calculate the power of a^b, append to list
abCombo :: Int -> [Int] -> Writer [String] [Int]
abCombo a lst
    | a == maxA = do              
        tell [ "- Done(2): a=" ++ show a ]
        abCombo' a 2 lst
    | otherwise = do
        (abCombo' a 2 lst) <<<<<<<<<<<<<<<<<<<<<< line of interest, here
        tell ["- Processing: a=" ++ show a]
        abCombo (a + 1) lst 
```

...

也就是上面的当前代码，我想把它改成：

```
abCombo :: Int -> [Int] -> Writer [String] [Int]
abCombo a lst
    | a == maxA = do              
        tell [ "- Done(2): a=" ++ show a ]
        abCombo' a 2 lst
    | otherwise = do
        let res = (abCombo' a 2 lst) <<<<<<<<<<<<<<<<<<<<<< line of interest, here            
        tell ["- Processing: a=" ++ show a]
        abCombo (a + 1) (flatten snd res) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-13T13:52:17.230

要在 -block 中绑定操作的结果，`do`您需要使用`<-`而不是`let`.

```
res <- abCombo' a 2 lst      -- res :: [Int] 
```

这是因为使用`let`，您只是在动作本身上命名。

```
let res = abCombo' a 2 lst   -- res :: Writer [String] [Int] 
```

# javascript - 在 Titanium 中检查空 json

> ID：10141861
> 
> 赞同：1
> 
> 时间：2012-04-13T13:34:55.053
> 
> 标签：javascript, json, titanium

我一直在研究检测空 JSON 对象的问题，但无法获得我在此处找到的一些建议。

似乎有效的解决方案是：

```
if ( Ti.JSON.stringify ( json ) != "{}" ) 
```

有人看到这种方法有什么问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T09:08:07.970

对于空字符串或空值，这可能会出现问题。

```
json = '';
Ti.API.log(JSON.stringify(json));  // would output ""

json = null;
Ti.API.log(JSON.stringify(json));  // would output "null" 
```

# java - 等待一系列脚本中的单个 Shell 脚本运行完成，然后再继续（Java、MySQL、JUnit）

> ID：10141865
> 
> 赞同：0
> 
> 时间：2012-04-13T13:35:05.693
> 
> 标签：java, mysql, shell, junit

我正在开发一个 Java 程序，它结合了 Process 和 Runtime 来运行多个 shell 脚本以进行自动化测试。除了其中一个脚本之外的所有脚本都运行良好，这会导致脚本调用出现问题。前任：

```
process = runtime.exec("A.sh");
process = runtime.exec("B.sh");
process = runtime.exec("C.sh"); 
```

A.sh 运行良好，只需几秒钟即可运行。然而，B.sh 需要几分钟才能运行，我认为这会导致运行 C.sh 出现问题，因为它们都与同一个 MySQL 表进行交互，并且重叠会导致通信链接失败。

在不给您带来不必要的信息的情况下，我的问题是，*在继续下一个 exec() 调用之前，我该如何等待以确保运行 shell 脚本已运行到完成/终止？*

我试过的：

```
process.waitFor() 
```

这不起作用，我认为它不会等到脚本完全完成

```
process.wait(long time_period) 
```

这不起作用，因为它会导致当前线程等待，从而导致剩余的 shell 脚本调用被跳过并且下一个测试用例过早开始。

我调用的导致问题的shell脚本*不是*一个简单的脚本，而是我自己没有写，对它在幕后做了什么了解很少。我所拥有的唯一相关信息是它直接连接到有问题的 MySQL 数据库，而我的程序使用 java.sql.* 来（我相信）远程连接（尽管它是远程机器上的本地数据库）。

编辑：

遵循建议后，我查看了 Apache Commons Exec 并尝试了一种新策略，但未成功。

```
ExecuteWatchdog watchdog = new ExecuteWatchdog(300000); //For five minutes
CommandLine cmdline = CommandLine.parse("./directory/shell.sh");
DefaultExecutor executor = setExitValue(0);
executor.setWatchdog(watchdog);
int exitVal = executor.execute(cmdLine);
//A line to log the exit val in another file 
```

我的日志没有暗示 shell 脚本实际上已经运行，因为记录的语句“shell.sh 开始”和“测试 2 开始”之间的时间基本上是同一时刻，这意味着 shell.sh 大约需要 2 分钟的过程跑步永远不会发生。我哪里做错了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T13:45:48.510

我使用[Apache Commons Exec](http://commons.apache.org/exec/tutorial.html)。具有同步和异步执行支持。可以设置执行超时。

他们教程页面的第一段：

> 在这一点上，我们可以放心地假设您希望从 Java 应用程序中启动一些子进程，并且您在这里花了一些时间来正确地完成它。您查看 Commons Exec 并认为“哇 - 调用 Runtime.exec() 很容易，而 Apache 人员正在用大量代码浪费他们和我的时间”。好吧，我们很难（在我的例子中不止一次）了解到使用普通的 Runtime.exec() 可能是一种痛苦的经历。因此，我们邀请您深入研究 commons-exec 并以简单的方式查看艰难的课程......

高级用法示例（缺少一些代码，例如 BusinessException 和“StreamUtil.closeQuietly”，但可以轻松替换）：

```
 ExecuteWatchdog watchdog = new ExecuteWatchdog(EXECUTION_TIMEOUT_IN_MS);
    DefaultExecutor executor = new DefaultExecutor();

    executor.setWatchdog(watchdog);
    executor.setExitValue(0);

    ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
    ByteArrayOutputStream errorStream = new ByteArrayOutputStream();

    executor.setStreamHandler(new PumpStreamHandler(outputStream, errorStream));

    try {
        log.info(commandLine.toString());

        int exitCode = executor.execute(commandLine, (Map<?, ?>) null);

        if (exitCode != 0)
            throw new BusinessException("Process exited with non-zero exit code.");

        return outputStream.toString();
    } catch (ExecuteException e) {
        String errorStreamStr = null;

        if (errorStream.size() != 0)
            errorStreamStr = errorStream.toString();

        StringBuilder errorMessageBuilder = new StringBuilder();

        errorMessageBuilder.append("main.error").append(":\n").append(
                e.getMessage()).append("\n\n");

        if (errorStreamStr != null) {
            errorMessageBuilder.append("additional.error").append(":\n").append(errorStreamStr).append("\n\n");
        }

        errorMessageBuilder.append("command.line").append(":\n").append(commandLine.toString());

        if (log.isDebugEnabled())
            log.debug(errorMessageBuilder.toString());

        throw new BusinessException(errorMessageBuilder.toString());
    } catch (IOException e) {
        throw new IllegalStateException(e);
    } finally {
        StreamUtil.closeQuietly(outputStream, errorStream);
    } 
```

# python - urllib2 是否支持线程到需要基本身份验证的服务器？

> ID：10141878
> 
> 赞同：2
> 
> 时间：2012-04-13T13:35:56.100
> 
> 标签：python, multithreading, urllib2

我正在开发一个应用程序，它使用一系列 REST 调用来检索数据。我已经完成了基本的应用程序逻辑，数据检索的结构大致如下。

1）初始数据调用完成

2) 对于初始调用中的每个响应，对需要基本身份验证的其余服务执行后续数据调用。

按顺序执行这些调用可能会导致最终用户的等待时间很长，因此我正在尝试实现线程以加快进程（受 IO 限制使其成为线程的理想候选者）。问题是我对线程调用的身份验证有问题。

如果我按顺序执行调用，那么一切正常，但如果我使用线程方法进行设置，我最终会出现 401 个身份验证错误或来自服务器的 500 个内部服务器错误。

我已经与 REST 服务管理员交谈过，他们不知道会阻止来自服务器端的同一用户的并发连接，所以我想知道这是否是 urllib2 端的问题。

有人对这个有经验么？

编辑：

虽然我无法发布确切的代码，但我会以非常相似的结构发布我正在做的事情的合理表示。

```
import threading
class UrlThread(threading.Thread):
    def __init__(self, data):
        threading.Thread.__init__(self)
        self.data = data

    def run(self):
        password_manager = urllib2.HTTPPasswordMgrWithDefaultRealm()
        password_manager.add_password(None, 'https://url/to/Rest_Svc/', 'uid', 'passwd')
        auth_manager = urllib2.HTTPBasicAuthHandler(password_manager)
        opener = urllib2.build_opener(auth_manager)
        urllib2.install_opener(opener)
        option = data[0]
        urlToOpen = 'https://url/to/Rest_Svc/?option='+option
        rawData = urllib2.urlopen(urlToOpen)
        wsData = rawData.readlines()
        if wsData:
            print('success')

#firstCallRows is a list of lists containing the data returned 
#from the initial call I mentioned earlier.
thread_list = []
for row in firstCallRows:
    t = UrlThread(row)
    t.setDaemon(True)
    t.start()
    thread_list.append(t)

for thread in thread_list:
    thread.join() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T15:24:54.853

使用[请求](http://docs.python-requests.org)，您可以执行以下操作：

```
from requests import session, async

auth = ('username', 'password')
url = 'http://example.com/api/'
options = ['foo1', 'foo2', 'foo3']

s = session(auth=auth)

rs = [async.get(url, params={'option': opt}, session=s) for opt in options]

responses = async.imap(rs)

for r in responses:
    print r.text 
```

**相关文档：**
[Sessions](http://docs.python-requests.org/en/latest/user/advanced/#session-objects)
[异步请求](http://docs.python-requests.org/en/latest/user/advanced/#asynchronous-requests)
[Basic authentication](http://docs.python-requests.org/en/latest/user/quickstart/#basic-authentication)

# javascript - 在页面底部附近执行操作

> ID：10141884
> 
> 赞同：0
> 
> 时间：2012-04-13T13:36:33.197
> 
> 标签：javascript

Javascript代码：

```
var next_page = 2;
var next_previews = 36;

function ajax_autopaginate(a, b) {
    function incrementPage () {

        next_page += 1;
        next_previews += 36;

    }

    jQuery('#' + b).load(a , function() {
        incrementPage();
        setTimeout(pollScrollPosition, 500);
    });
}

function pollScrollPosition() {
var y = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop;

var max = window.scrollMaxY || (document.body.scrollHeight - document.body.clientHeight);

if ((max - y) <= 1500) {
    ajax_autopaginate('http://www.wallpaperup.com/welcome/get_wallpapers/date_added/DESC/' + next_previews + '/','content' + next_page);
} else {
    setTimeout(pollScrollPosition, 500);
}
}

setTimeout(pollScrollPosition, 500); 
```

如果我们距离页面末尾 1500px 或更小，我正在使用此代码执行一个函数，在 Firefox 中一切正常，但在 IE 和 Chrome 中，该函数总是执行，我应该如何修复它？

这是给我带来问题的页面：[http ://www.wallpaperup.com/](http://www.wallpaperup.com/)

# javascript - 给 Dojo TabContainer 一个 ID

> ID：10141887
> 
> 赞同：0
> 
> 时间：2012-04-13T13:36:46.287
> 
> 标签：javascript, dojo

我的页面中有以下代码，用于创建新的 Dojo/Dijit TabContainer。

```
<div dojoType="dijit.form.ComboButton" iconClass="dijitIconEdit">
    <span>
    Blank
    </span>
    <div dojoType="dijit.Menu">
    <div dojoType="dijit.MenuItem" iconClass="dijitIconEdit">
        Letter to Client
        <script type="dojo/method" event="onClick">
            newLetterToClientPane = dojox.layout.ContentPane({ title:'New Letter to Client', href:'some_url', closable:true })
            dijit.byId('mainTabs').addChild(newLetterToClientPane)
        </script>
    </div>
    <div dojoType="dijit.MenuItem" iconClass="dijitIconEdit">
        Letter to Company
        <script type="dojo/method" event="onClick">
            newLetterToCompanyPane = dojox.layout.ContentPane({ title:'New Letter to Company', href:'some_url', closable:true })
            dijit.byId('mainTabs').addChild(newLetterToCompanyPane)
        </script>
    </div>
    </div>
</div> 
```

这一切都很好。我只是想知道如何给新的 TabContainer 一个 ID，因为我需要稍后在脚本中重新填充，但我不能用 out 和 ID 来做到这一点。我只是问，因为[dojox.layout.ContentPane](http://dojotoolkit.org/reference-guide/1.7/dojox/layout/ContentPane.html)和[dijit.layout.ContentPane](http://dojotoolkit.org/reference-guide/1.7/dijit/layout/ContentPane.html)上的 Dojo 页面没有提及它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T13:57:26.373

以下应该有效：

```
newLetterToClientPane = dojox.layout.ContentPane({ id: "cp1", title:'New Letter to Client', href:'some_url', closable:true }); 
```

然后，您可以稍后访问该小部件

```
dijit.byId("cp1") 
```

例如

```
dijit.byId("cp1").attr ("title", "new title"); 
```

请注意，jsid 将使用您指定的 id 创建一个全局 JS 变量 - 因此，如果您不想添加到全局内存中，请小心它确实提供了便利，尽管您不需要执行 dijit.byId 来访问它，您可以这样做：

```
cp1.attr("title", "new title"); 
```

如果你使用 jsId 作为 cp1

Aso 请注意 dojo.byId 和 dijit.byId 之间的区别：http: [//dojotoolkit.org/reference-guide/1.7/dijit/info.html](http://dojotoolkit.org/reference-guide/1.7/dijit/info.html)

由于所有小部件的 id 行为都是相同的，我猜他们在上面链接中提供的基本 dijit 文档中添加了详细信息

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T13:49:43.263

用作`jsId`_

```
<div jsId='myfirstTab' dojoType="dijit.form.ComboButton" iconClass="dijitIconEdit"> 
```

**更新**

为自己分配新的 ID

```
newLetterToClientPane = dojox.layout.ContentPane({ title:'New Letter to Client', href:'some_url', closable:true, jsId :'myfirstTab' }) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T15:21:10.340

您也可以通过将`id`作为第二个参数传递给构造函数来做到这一点

很像标准的方式。

```
newLetterToClientPane = dojox.layout.ContentPane({ title:'New Letter to Client', href:'some_url', closable:true }, "cpId") 
```

# php - 反序列化多个附件数据

> ID：10141900
> 
> 赞同：0
> 
> 时间：2012-04-13T13:37:35.583
> 
> 标签：php, upload, phpmyadmin

我在我的数据库中存储了一些多个附件，通过代码序列化附件数据在一列中：

```
 $files = array(
'file1' => base64_encode(file_get_contents('back.jpg')),
'file2' => base64_encode(file_get_contents('email.jpg')),
'file3' => base64_encode(file_get_contents('web.jpg')),
  );
     // serialize
     $filesData = serialize($files); 
```

现在，在另一个 php 页面中，我正在下载要下载的文件，其中我对上述文件数据进行反序列化，从数据库列“数据”中获取它们

使用以下代码反序列化数据，但似乎数据没有反序列化，我保存了三张图片，当我检索它们时，我下载了一个 .txt 文件，其中写有“数组”

```
 if($result->num_rows == 1) {
         $row = mysqli_fetch_assoc($result);
       // Print headers
            header("Content-Type: ". $row['mime']);
            header("Content-Length: ". $row['size']);
            header("Content-Disposition: attachment; filename=". $row['name']);

        $files = unserialize($row['data']);
            echo $files;
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T13:42:09.007

$files is an array containing the three files, what do you expect?

"Array" is the result of the string cast from echo.

try echo $files['file1'] etc..

# user-interface - Unity 游戏编程

> ID：10141906
> 
> 赞同：0
> 
> 时间：2012-04-13T13:37:45.817
> 
> 标签：user-interface, text, unity3d

我的场景中有一个 GUI 文本对象，我希望它显示我为戏剧留下的剩余生命。由于某种原因，我似乎无法让它工作。我有下面的代码，有人可以帮我吗？

```
// the sound to play when the player is shot
public var shotSound:AudioClip;

// the number of lives
public var lives:int = 3;

/**
    Player has been shot
*/
function Shot () 
{
    // play the shot audio clip
    audio.PlayOneShot(shotSound);

    // reduce lives
    lives--;

    // reload the level if no lives left
    if (lives == 0)
    {
        // destroy the crosshair
        Destroy(GetComponent(CrossHair));

        // add the camera fade (black by default)
        iTween.CameraFadeAdd();

        // fade the transparency to 1 over 1 second and reload scene once complete
        iTween.CameraFadeTo(iTween.Hash("amount", 1, "time", 1, "oncomplete", "ReloadScene", "oncompletetarget", gameObject));
    }
}

/**
    Reload the scene
*/ 
function ReloadScene()
{
    // reload scene
    Application.LoadLevel("MainMenu");
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T09:49:33.237

试试下面的代码。通过转到 GameObject->Create Other->GUI Text 创建 GUIText 对象。现在将它拖到检查器面板中下面脚本的 playerLives 字段。它应该工作。

```
// the sound to play when the player is shot
public var shotSound:AudioClip;

public var GUIText playerLives;

// the number of lives
public var lives:int = 3;

function OnGUI ()
{
    playerLives.Text = lives.ToString();
}
/**
    Player has been shot
*/
function Shot () 
{
    // play the shot audio clip
    audio.PlayOneShot(shotSound);

    // reduce lives
    lives--;

    // reload the level if no lives left
    if (lives == 0)
    {
        // destroy the crosshair
        Destroy(GetComponent(CrossHair));

        // add the camera fade (black by default)
        iTween.CameraFadeAdd();

        // fade the transparency to 1 over 1 second and reload scene once complete
        iTween.CameraFadeTo(iTween.Hash("amount", 1, "time", 1, "oncomplete", "ReloadScene", "oncompletetarget", gameObject));
    }
}

/**
    Reload the scene
*/ 
function ReloadScene()
{
    // reload scene
    Application.LoadLevel("MainMenu");
} 
```

# python - 为什么这在 Python 中不可能？

> ID：10141907
> 
> 赞同：1
> 
> 时间：2012-04-13T13:37:47.720
> 
> 标签：python

```
def myfunc(a,b=2):
    print("Called with", a, b)
    return
p1 = functools.partial(myfunc, b=4)
p1("foobar", 4) 
```

为什么我在运行最后一行时会出现语法错误？如果我这样做，它会起作用：`myfunc("foobar", 4)`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-13T13:42:11.353

'partial' 已经将 'b' 设置为 4；如果你想要另一个值，你应该明确设置参数'b'：

```
>>> p1("foobar")
('Called with', 'foobar', 4)

>>> p1("foobar", b=5)
('Called with', 'foobar', 5) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T13:46:39.353

`b`因为您正在为它提供`functools.partial`呼叫。您的电话应如下所示：

```
p1("foobar") 
```

或者您可以摆脱`b=4`in`p1 = functools.partial(myfunc, b=4)`并使其类似于：

```
p1 = functools.partial(myfunc) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T13:48:10.613

我认为这是因为 python 允许您以任何顺序使用可选参数。当您使用更多静态类型的语言时，通常会限制按函数/方法中定义的顺序使用可选参数。因此，例如，在 python 中这是合法的：

```
def myfunc(a=1,b=2,c=3):
    print a,b,c

myfunc(c=99, b=13, a=12) 
```

因为可以按任意顺序指定可选参数，所以我认为 python 明确需要知道哪些参数分配给了哪些局部函数变量。

# spring - 从 web.xml 初始化一个 spring bean

> ID：10141910
> 
> 赞同：2
> 
> 时间：2012-04-13T13:37:56.520
> 
> 标签：spring, jakarta-ee

我正在更新使用 Spring 的现有 Java EE Web 应用程序。

在我的 web.xml 中，有一个 servlet 定义如下：

```
 <servlet>
    <display-name>My Example Servlet</display-name>
    <servlet-name>MyExampleServlet</servlet-name>
    <servlet-class>com.example.MyExampleServlet</servlet-class>
  </servlet> 
```

现在，在这个类中我需要添加一个@Autowite 注释：

```
class MyExampleServlet extends HttpServlet {
    @Autowired (required = true)
    MyExampleBean myExampleBean;

    [...]
} 
```

问题是 MyExampleBean 是由应用程序服务器初始化的（在我的例子中，weblogic.servlet.internal.WebComponentContributor.getNewInstance ...）

因此，Spring 没有意识到这一点，并且 Spring 没有机会连接“myExampleBean”。

如何解决？也就是说，我需要如何修改 web.xml 或 MyExampleServlet 以便 MyExampleServlet 获得对 myExampleBean 的引用？

一种可能是在 MyExampleServlet 中添加此初始化代码，但它需要对 servletContext 的引用。如何获取对 servletContext 的引用？

```
ApplicationContext context = WebApplicationContextUtils.getWebApplicationContext(servletContext);
myExampleBean = (MyExampleBean) context.getBean("myExampleBean"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T14:25:26.810

我看到，HttpServlet/GenericServlet 有一个 getServletContext() 方法，（并且应用程序服务器首先调用 servlet 的 init(ServletConfig config)，并且 config 包含对 servletContext 的引用）。

请参阅[http://tomcat.apache.org/tomcat-5.5-doc/servletapi/javax/servlet/GenericServlet.html](http://tomcat.apache.org/tomcat-5.5-doc/servletapi/javax/servlet/GenericServlet.html)

代码修改：

```
class MyExampleServlet extends HttpServlet {
    MyExampleBean myExampleBean;

    @Override
    public void init() throws ServletException {
        ApplicationContext context = WebApplicationContextUtils.getWebApplicationContext(getServletContext());
        myExampleBean = (MyExampleBean) context.getBean("myExampleBean");
    }

    [...]
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T13:42:45.377

在您的应用程序上下文 xml 中，您需要类似

```
<bean id="myExampleBean" class="path/to/myExampleBean"> 
```

# jquery - 使用 CSS（或 jQuery）放大图像而不移动页面上的其他所有内容

> ID：10141912
> 
> 赞同：5
> 
> 时间：2012-04-13T13:37:58.890
> 
> 标签：jquery, css, image, image-enlarge

我有一组动态生成的图像（每个图像附近都有评论）。我想以 48 像素的最大宽度和最大高度显示每个图像，但是当用户将鼠标悬停在图像上时，它会增长到 200 像素的最大宽度和最大高度。但无需移动页面上的其他所有内容。这是生成图像的代码：

```
$(function(){
        $.getJSON("inc/API.php", 
        {command : "getUserComments", userid : getQueryStringValue("userid")},
        function(result)
        {
        for (var i = 0; i<6; i++){
            $("#divUserCommentsContent").append("<div id='divUserComment'><div id='divCommentTime'>"+
            result[i].commentDateAndTime+"</div><div id='divUserDetail'><div id='divUserpic'>
       **<img src='images/"+result[i].imageFileName+"' class='commentpic' />**</div>
            <div id='divUsername'>Comment for <a href='rank.html?imageID="+result[i].imageID+
            "&imageFileName="+result[i].imageFileName+"'>"+result[i].imageHeader+
            "</a></div></div><div id='divCommentText'>"+result[i].comment+"</div></div>");
        }
    });
}); 
```

我用 2 ** 标记了图像。这是CSS：

```
.userpic, .commentpic
{
max-height:48px;
max-width:48px;
border-radius:5px;
z-index:1;
position:relative;
}
.commentpic:hover
{
max-width: 200px;
max-height: 200px;
position:relative;
z-index: 50;
} 
```

它会放大图像，但也会移动图像右侧和图像下方的所有其他内容。

如何在不移动其他所有内容的情况下使用 CSS（最好）或使用 jQuery 使图像更大？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-13T13:49:29.443

您可以尝试将 .commentpic 的位置设置为绝对位置。

你可以在这里看到一个例子：http: [//jsfiddle.net/HkPCp/3/](http://jsfiddle.net/HkPCp/3/)

我认为这是您想要的行为，对吗？

**编辑：**我更新了 jsFiddle，这样它就不会移动其他元素。

这是正确的行为吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T13:52:14.033

将您的每个图像放入具有设定宽度和高度的容器中。您的容器的溢出将是可见的。

任何流出的东西都是可见的，但不会影响内容。

[http://jsfiddle.net/ck6MG/](http://jsfiddle.net/ck6MG/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-13T13:52:18.087

它会在这里使用 jQuery：

```
<div id="enlarge_img"></div>

<style type="text/css">
   div#enlarge_img {
       display: none;
       height: 200px;
       line-height: 200px;
       position: absolute;
       text-align: center;
       width: 200px;
   }

   div#enlarge_img > img {
       max-height: 200px;
       max-width: 200px;
   }
</style>

<script type="text/javascript">
$(function() {
    $('body img').bind('mouseover', function() {
        var offset = $(this).offset();

        $('div#enlarge_img').show().css({
            'left' : offset.left - ((200 - $(this).width()) / 2),
            'top' : offset.top- ((200 - $(this).height()) / 2),
        }).html('<img src="'+$(this).attr('src')+'" />');
    });

    $('div#enlarge_img > img').live('mouseout', function() {
        $('div#enlarge_img').hide();
    });
});
</script> 
```

基本上你有一个`absolute` `div`隐藏，直到你悬停 a `img`，然后将自己定位到 img 所在的位置并显示相同的图像，但更大。图像从中心增加，不会影响结构的其余部分，因为它是`absolute`.

如果你愿意，我可以添加动画。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-01-04T06:38:47.557

[https://jsfiddle.net/dafemtg1/](https://jsfiddle.net/dafemtg1/)

仅供参考，CSS 使用 transform 属性：

```
img{transition:all 0.2s;}
img:hover {transform:scale(1.4);transition:all 0.2s;} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-13T13:40:37.533

`position:absolute`对不想移动的元素尝试 css

`z-index`为您想要显示在顶部的元素设置高位

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-13T14:08:22.873

将 class="userpic-container" 添加到图像的父 div 并尝试以下 CSS：

```
.userpic-container {
    position: relative;
    height: 48px;
    width: 48px;
}

.userpic, .commentpic {
    border-radius: 5px;
    position: absolute;
    height: 48px;
    width: 48px;
    z-index: 1;
}
.commentpic:hover {
    height: 200px;
    width: 200px;
    z-index: 10;
} 
```

# wordpress - @font-face 不能在 Windows 服务器上工作？

> ID：10141920
> 
> 赞同：0
> 
> 时间：2012-04-13T13:38:13.650
> 
> 标签：wordpress, fonts, windows-server-2003, font-face

我在运行 linux 的测试服务器上为客户端开发了一个 wordpress 主题。@font-face 加载了 .otf 并在此实例中正确呈现了文本。它可以在多台计算机上运行。

但是现在当我在客户端的 wordpress 上安装这个主题时，它在 windows server 2003 上运行，它不会在任何计算机上加载字体。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T21:49:24.790

IIS 未发送带有正确 MIME 类型集的 .otf，这就是它无法正常工作的原因。您需要配置 IIS MIME 类型以将 .otf 文件响应为“font/opentype”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-17T18:08:55.710

有时，Windows 服务器会允许这样做：

把它放在 web.config

```
<system.webServer>
  ...
  <staticContent>
    <remove fileExtension=".woff" />
    <mimeMap fileExtension=".woff" mimeType="application/font-woff" />
  </staticContent>
</system.webServer> 
```

竖起大拇指！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T11:01:18.770

在 Windows 2003 上遇到了同样的问题，按照 Maxim V. Pavlov 的建议更新了 MIME 类型，在 IIS 中回收了应用程序池，一切正常......

# c# - 使用 PrivateObject 在没有设置器的情况下设置属性值

> ID：10141924
> 
> 赞同：1
> 
> 时间：2012-04-13T13:38:48.563
> 
> 标签：c#, unit-testing, reflection

使用 a `PrivateObject`，我正在尝试创建`ItemChange`该类的实例（在[此处](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.itemchange_members%28v=exchg.80%29.aspx)找到）。查看调试器以及 Visual Studio 2008 中的对象浏览器，除了 setter 之外，我似乎找不到与该属性相关的*任何内容。*`ItemId`下面是我正在使用的代码。

```
var itemChange = new PrivateObject(typeof(ItemChange));

itemChange.SetFieldOrProperty("ChangeType", _fixture.CreateAnonymous<ChangeType>());
itemChange.SetFieldOrProperty("ItemId", _fixture.CreateAnonymous<ItemId>()); 
```

我收到的错误是：

```
System.MissingMethodException : Method 'Microsoft.Exchange.WebServices.Data.ItemChange.ItemId' not found. 
```

我尝试了 的变体`BindingFlags`，但似乎没有任何帮助。如何设置没有 setter 而只有 getter 的属性？

### 编辑

关于我的评论，我可以创建`PrivateObject`对象实例并设置的另一个内联类`ItemId`是`ItemEvent`类（在[此处](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.itemevent_members%28v=exchg.80%29.aspx)找到）。这个类很简单，因为当我调试并将该类添加到我的监视列表中时，我可以将`itemId`其视为私有变量。但是，在类上执行相同的步骤时，除了*只有*一个 setter的属性本身之外，`ItemChange`我*找不到*任何字段*的*痕迹。这是我对如何设置此属性感到困惑的地方。`ItemId`

 *最后，我无法使用可以让我反编译类并查看什么是什么的工具。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T14:47:58.377

公共 get-only 属性不一定具有私有 setter。如果您还没有自己编写目标类，您可能需要使用像[Reflector](http://www.reflector.net/)这样的反编译器来确定您需要更改的内容，以便更改属性 getter 返回的值。

如果您发现自己经常需要做这种事情，您可能需要考虑使用另一种方法来控制第三方代码的行为，而无需适当的扩展挂钩。例如，[Moles](http://research.microsoft.com/en-us/projects/moles/)将允许您在不了解属性或类的内部情况的情况下用自己想要的行为替换 getter。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T14:49:10.573

如果您尝试设置的属性是只读的并且不受任何底层私有字段的支持，那么您实际上无法设置它。例如，如果您有以下属性：

```
public string ItemId
{
  get 
  {
    return "Test";
  }
} 
```

您所做的任何事情都不会将此属性设置为另一个值。如果在调试器和/或反射中查看对象的字段时没有看到明显的支持字段，则很可能是这种情况。

在这种情况下，如果我不得不猜测，我会说 ItemId 可能是一个快捷方式属性，它只返回`this.Item.Id`.

编辑：

我部分是对的。根据 dotPeek，`ItemChange.ItemId`只需返回`Change.id`，适当地进行类型转换。如果`Change.serviceObject`有值，则`Change.id`返回`Change.serviceObject.GetId()`，否则返回`Change.id`。根据 MSDN，哪些适合您的情况取决于您正在谈论的更改类型：

> 当 ChangeType 属性的值为 ChangeType.Delete 或 ChangeType.ReadFlagChange 时，Item 为空。

实际上，Change 和 ItemChange 的实现是这样的：

```
public class Base 
{
  private Thing thing;
  private BaseId id;

  internal BaseId Id
  {
    get
    {
      return this.thing == null ? this.id : this.thing.GetId();
    }
  }
}

public class Child
{
  public ChildId ChildId
  {
    get 
    { 
      return (ChildId) this.Id; 
    }
  }
} 
```

In the actual `Change` implementation, the object field is a [`ServiceObject`](http://msdn.microsoft.com/en-us/library/dd636097%28v=exchg.80%29.aspx) named `serviceObject`, which has a `GetId()` method that returns a `ServiceId`, and there is also an `id` field of type `ServiceId`. To get your `ItemChange` object's `ItemId` property set, you need to set one or the other of those internal fields on the object's base class (the `serviceObject` field takes precedence if it's set.)*

# ruby-on-rails - 如何根据关联事实限制 CanCan 中的记录？

> ID：10141930
> 
> 赞同：0
> 
> 时间：2012-04-13T13:39:03.540
> 
> 标签：ruby-on-rails, cancan

我正在尝试使用 CanCan 满足以下要求：

1.  如果一个交易被分配给 1-many 网络，如果他/她是任何分配网络的成员，则用户可以阅读该交易。

2.  如果交易未分配给任何网络，则任何注册用户都可以查看该交易，无论其网络成员身份如何。

3.  ~~如果交易未分配给网络，但交易标记为 member_only = true，则用户可以在他/她是任何网络的成员时阅读该交易。~~

4.  ~~如果交易未分配给网络并且标记为 member_only = false，则任何注册用户都可以阅读该交易。~~

5.  客人（即非用户）无法阅读任何优惠

我想我有 2-4 个涵盖以下内容：

```
if current_user.persisted?
  can :read, Deal, current_user.networks.empty? ? { member_only: false } : {}
end 
```

但是，我不确定如何进一步限制分配给网络的交易。CanCan 有可能吗？如果是这样，建议如何？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T09:34:43.907

尝试[access_by](https://github.com/ryanb/cancan/wiki/Fetching-Records)。这样，如果用户无权访问数据，您只会显示一个空列表。换句话说，不是限制对页面的访问，而是使用 cancan 范围限制对数据的访问。

另见：[相关答案](https://stackoverflow.com/questions/5344247/cancan-accessible-by)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T16:47:58.063

Here is what I came up with. Probably not the best solution, so feedback welcomed.

```
if current_user.persisted?
  can :read, Deal, { id: DealAccessPolicy.accessible_deal_ids_for(current_user) }
end

class DealAccessPolicy
  def self.accessible_deal_ids_for(user)
    Deal.pluck(:id) - (Network.all - user.networks).map{|r| r.deals.map(&:id)}.flatten.uniq
  end
end 
```

# iphone - 如何在 UIAlertview 中添加 iAd？

> ID：10141933
> 
> 赞同：0
> 
> 时间：2012-04-13T13:39:06.567
> 
> 标签：iphone, objective-c, ios, iad

我使用 iAd 框架在屏幕上添加广告。我通过下面的代码完成了这个。但我想在 UIAertview 中做广告。当 UIAlertview 出现时，用户应该在其中查看公司广告。

```
-(void)bannerViewDidLoadAd:(ADBannerView *)banner
{
    if (!self.bannerIsVisible) {
        [UIView beginAnimations:@"animatesAdBannerOn" context:NULL];
        banner.frame = CGRectOffset(banner.frame, 0, -banner.frame.size.height);             [UIView commitAnimations];
        self.bannerIsVisible = YES;
    }
}

- (void)bannerView:(ADBannerView *)banner didFailToReceiveAdWithError:(NSError *)error
{
          if (!self.bannerIsVisible) 
          {
              [UIView beginAnimations:@"animatesAdBannerOff" context:NULL];
              banner.frame = CGRectOffset(banner.frame, 0, banner.frame.size.height); //rect, dx,dy
              [UIView commitAnimations];
              self.bannerIsVisible = NO;
          }
} 
```

我知道我们可以自定义 UIAlertview。但不知道如何在其中添加 iAd 视图。如果有人知道的帮助我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T13:49:07.590

如果我对您的理解正确，您想为自己的公司制作广告吗？您不会为此使用 iAd，因为使用 iAd 您几乎无法控制将哪些广告推送到您的横幅上。但是，您可以使用您想要的任何内容创建一个新视图（广告方面），并将其添加为`UIAlertView`. 现在我说你可以**这样**做，但你可能不应该这样做。以这种方式修改 alertView 很可能会被 Apple 拒绝。

# tdd - TDD 场景：寻求建议

> ID：10141934
> 
> 赞同：0
> 
> 时间：2012-04-13T13:39:10.893
> 
> 标签：tdd

我目前处于从客户网站解析数据的环境中。我想使用我的测试来确保当客户更改他们的网站时，我知道我们什么时候不再收到信息。

我的第一种方法是进行纯集成测试，我的测试访问客户的站点并断言数据已找到。然而，在进行了 500 次测试的中途，测试运行变得难以忍受，并且在某些情况下开始超时。所以我在不失去他们提供的核心保护的情况下尽可能多地清除了测试，我已经降到了 350 左右。我害怕添加更多测试以破坏所有测试。当我再进行更改时，我还发现自己没有运行 5 分钟以上的持续时间（一些客户会更长，因为这是基于与他们网站的通信速度）。我认为这是一个彻底的失败。

我对此进行了很多思考，并在办公室四处询问，我下一次尝试的想法是拉下客户的页面并针对我的项目中的这些嵌入式资源编写测试。这将为我提供更高的测试覆盖率，并允许我单独返回测试。但是，当他们进行更改时需要通知我，然后重新拉下页面进行测试。我认为客户不会坚持这一点。

有人建议我用一套“随机”集成测试来增强它，这些测试与我失败的测试（访问客户站点）提供相同的功能，但数量比以前少得多。我真的不喜欢随机测试的想法，有时可能会用相同的代码获得红灯，有时会获得绿灯。但是到目前为止，这听起来像是我听到的最好的主意，它仍然可以了解客户的站点何时发生更改并且我的代码不再找到数据。

有没有人发现自己在测试这样的环境？测试社区对我有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T14:01:27.597

我的建议是尽量隔离处理不确定性的代码部分。这部分应该是一个 API，作为所有其他代码使用的服务。这样，您将保护大部分代码免受更改。

代码的稳定部分应该进行单元测试。由于该部分独立于与运行测试的客户端站点的连接，应该会更快，并且也会使这些测试更加可靠。

可以减少必须处理客户网站上的更改的部分。这样，您并没有解决问题，但至少您将其最小化并将其集中在代码的一个模块中。

建议客户将数据公开为 Web 服务将是您的最佳选择。但我想这不取决于你：P。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T14:12:48.513

您应该考虑将测试划分为可以独立运行的单独程序集。我通常有一个单元测试程序集和一个运行速度较慢的集成测试程序集。

我的单元测试程序集非常快（因为代码是使用模拟单独测试的）并且在我开发时会非常频繁地运行。集成测试速度较慢，我仅在完成功能/签入或对破坏某些东西有不好的感觉时才运行它们。

也许您可以做一些类似的事情，甚至更进一步，并拥有 3 个测试套件，其中第三个包含更慢的客户端 UI 轮询测试。

如果您没有持续集成服务器/流程，您应该考虑设置一个。这将持续构建您的软件并执行测试。这可以设置为监控签入并在后台工作，如果出现任何故障，则会发出通知。有了这个，您就不会关心您的客户端 UI 轮询测试需要多长时间，因为您不必自己运行它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T13:58:22.397

当您说大测试变得无法忍受时，它表明您正在手动运行此测试套件。你不应该这样做。它应该在后台持续运行，以完成套件所需的任何速度 - 然后重新开始（如果有相关成本，可能在延迟之后）。只有当出现问题时，您才会收到警报。

如果您的测试有什么东西导致它们随着数量的增长而变慢 - 找到它并修复它。测试应该彼此独立，因此简单地拥有更多测试不应导致单个测试超时。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-14T00:21:35.817

绝对将测试分开 - 至少将单元测试与集成测试分开。

正如 Martyn 所说，建立一个持续集成系统。我使用 Teamcity，它非常好，易于使用，前 20 次构建免费，如果您没有服务器可供使用，您可以愉快地在自己的机器上运行它 - [http://www.jetbrains.com /团队城市/](http://www.jetbrains.com/teamcity/)

设置一个构建以在每次签入时运行，并使该构建运行您的单元测试，或者如果您愿意，可以运行快速运行的测试。

设置第二个构建在每晚午夜（或其他方便的时间）运行，并在其中包含运行时间较长的客户端调用集成测试。有了这个，测试需要多长时间都没关系，如果你的客户破坏了你的东西，你会在早上第一件事得到一个很大的危险信号。如果您怀疑可能存在问题，您也可以按需手动运行这些。

# linux - 使用 sed 从文件中提取数据并附加到 linux 中的目标文件

> ID：10141938
> 
> 赞同：0
> 
> 时间：2012-04-13T13:39:16.940
> 
> 标签：linux, sed, append, extract

我想从文件 minimumThickness*.k 中提取一些数据并将其放入文件 results.txt 中。文件 mimimumThickness*.k 在第一行只有 double 值。

文件 minimumThickness.k 是从 1 到 100 的一系列文件

```
mimimumThickness1.k
mimimumThickness2.k
mimimumThickness3.k
. . .
. . .
mimimumThickness100.k 
```

我曾经按照命令执行此操作，但没有成功。

```
 sed -n '/^[0-9.]*$/w results.txt' minimumThickness*.k 
```

我也可以使用

```
for loop of i over 1 to hundred 

thickness=´cat minimumThickness$i.k | {print $1} ' | bc` 
echo $thickness 
thickess >> results.txt 
```

请告诉我 sed 的问题或建议我使用 sed 的更好方法。它会欣赏任何优雅的方法。

此致。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T14:09:19.810

如果您只需要每个文件的第一行：

```
head -n 1 minimumThickness*.k > results.txt 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T06:57:38.820

这可能对您有用（GNU sed）：

```
sed -sn '1w results.txt' minimumThickness*.k 
```

或者

```
head -qn1 minimumThickness*.k > results.txt 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T14:06:15.083

[0-9.]* 将匹配任何内容，因此您可能看不到预期的结果。您可以尝试 [0-9]*\.[0-9]* 获得双打（进行一些修改）。

# visual-studio-2010 - 一个信任使用 VsPerfCmd.exe 的硬件计数器分析应该走多远？

> ID：10141940
> 
> 赞同：0
> 
> 时间：2012-04-13T13:39:23.427
> 
> 标签：visual-studio-2010, profiler, performancecounter, cpu-cache

我正在尝试使用 VsPerfCmd.exe 来分析检测本机应用程序中的分支预测错误和最后一级缓存未命中。

设置就像在[tin](http://msdn.microsoft.com/en-us/library/aa985627%28v=vs.100%29.aspx)上所说的那样工作，但我得到的结果似乎并不明智。例如，一个总是接触 24MB 数据集的函数被报告为在被调用 ~2000 次时只会导致 ~700 次缓存未命中。现在让我考虑一下 - 该函数线性遍历两个 12 字节元素的 1024*1024 元素数组。对于每个元素，它随机决定是否需要它之前或之后的元素 1024 个索引的信息。这意味着为了不产生任何高速缓存未命中，CPU 必须始终在高速缓存中拥有至少三个 1024*12 字节的部分。此外，在每次迭代之后，该过程使用 sleep() 产生 CPU 大约 8 毫秒。我无法想象任何硬件预取器做得这么好。

这种愚蠢的数据量怎么不会产生比 VsPerfCmd 说的更多的最后一级缓存未命中？尽管我的 i7 有 8MB 的共享 L3 缓存，但这似乎不太可能。任何人都可以分享他们对这里可能发生的事情的看法吗？当然，“VsPerfCmd.exe 糟透了”将是一个有效的答案，但如果有人要这么说，我至少想听听有人有类似的经历作为这个断言的基础。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T09:32:17.080

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T09:44:13.733

首先 - 硬件 LLC 未命中计数器（我们称其为）实际上不会计算您的特定应用程序中的 LLC 未命中数。它的作用是计算所有 LLC 未命中并将该数字与预设阈值（称为 SAV - 值后样本，通常为数千甚至数百万）进行比较。如果当前计数等于 SAV，则会引发中断，此时指向的任何 IP 都将保存在跟踪中，与计数器和时间戳一起（例如，使跟踪合理）。如果此 IP 指向您模块中的指令，那么所有这些缓存未命中都归因于您的模块/功能/指令。因此，您看到的结果图片不是真实的，而是统计上正确的。我没有使用过 VsPerfCmd，但可以帮助您检查它为 LLC 未命中设置的 SAV。如果它'

然后是您的应用程序工作负载和工作集的主题。3 x 1024 x 12B 只有 36KB，这对于 8MB LLC 来说不算什么。如果算法均匀地来回跳跃，而不总是向前或向后跳跃，那么它只是经常使用的 24 MB 的一小部分，这意味着最热门的数据也很可能适合 LLC。此外，CPU 只能看到称为高速缓存行的块中的内存，这些块长 64 字节。因此，每当您的算法向前或向后跳转以访问接下来的 12 个字节时，都会将 52 个相邻字节加载到 L1 中，因此如果跳转后的下一步是 *(ptr++)，则不会导致缓存未命中。让 CPU 8 毫秒不应影响缓存性能，除非您怀疑为下一个时间片安排的线程正在执行其他内存密集型操作，这将导致您的数据缓存行被驱逐。否则，如果只是一些在后台运行的操作系统线程仅触及几个字节，那么就不应该发生大规模缓存驱逐。

# cakephp-2.0 - 会话 cookie 不断被覆盖

> ID：10141945
> 
> 赞同：0
> 
> 时间：2012-04-13T13:39:46.643
> 
> 标签：cakephp-2.0

当我登录到我的应用程序时，我得到一个值为 odm7krain1ms6bic7irfvpsj91 的 cookie。

只要我留在此选项卡上并浏览应用程序，我“通常”就可以了。如果我打开另一个选项卡并转到相同的 url，我将获得一个覆盖旧 cookie 的新 cookie，并且我的旧会话丢失。我怎样才能防止这种情况发生？

当我使用 XHR 请求时，我已经看到这种情况发生，这也有效地将我从当前会话中注销。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T13:43:07.420

尝试将以下内容添加到您的 core.php 文件中：

```
Configure::write('Session.checkAgent', false);
Configure::write('Session.ini',array('session.cookie_secure' => false, 'session.referer_check' => false)); 
```

这些参数应该强制 cookie 持续存在。这将设置 PHP 和 CakePHP 的设置以允许 cookie 通过 http 和 https 持久存在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T13:41:19.607

use $_SESSION["your session var"];

# java - Guice: bootstrapping and dependency graph resolution

> ID：10141950
> 
> 赞同：2
> 
> 时间：2012-04-13T13:40:00.090
> 
> 标签：java, dependency-injection, guice

I've read that explicitly requesting an object instance from a DI mechanism is considered a general anti-pattern for DI/IoC. This is because, by the time the object comes into scope, it should have already been injected with all the dependencies it needs. In Guice-land, such an anti-pattern would be represented as:

```
Service svcImpl = (Service)injector.getInstance(Service.class); 
```

Apparently, the one exception to this anti-pattern is the bootstrapping/dependency resolution phase, where you ask Guice for all the top-level *root* ("root" in the sense that all other objects flow from it) objects.

Interestingly enough, I can't find any practical, working code examples of this bootstrap process after an exhaustive online search! I would *imagine* it looks something like this:

```
public void bootstrap() {
    RootObj1 root1 = (RootObj1)injector.getInstance(RootObj1.class);
    RootObj2 root2 = (RootObj2)injector.getInstance(RootObj2.class);

    this.root1 = root1;
    this.root2 = root2;

    // Since all objects flow from these two "root" dependencies, bootstrapping
    // is complete. root1 and root2 contain all the dependencies the application
    // needs from here on out, and the "injector" object is no longer needed.
    // More importantly, injector is never used anywhere else in the code, and
    // therefore the code is not in violation of this anti-pattern.
} 
```

**Is this correct, or am I way off-base here?** I ask only because I can't find any working examples!!

As I write this I'm beginning to second-guess myself because this just doesn't seem feasible/practical.

This is because, in reality an application's dependency graph will be massive with many separate, disparate "dependency trees", each with their own roots. This would lead to the necessity for some kind of `Bootstrapper` object, responsible for returning the roots of each of these trees so that all other objects across the codebase could request the appropriate root object to the "tree" they belong to. This is already sounding extremely convoluded.

A **working code example** of how bootstrapping is practiced in the real world might help bring some clarity to this for me. Thanks in advance!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T03:43:05.430

我认为你很难找到一个好的例子的原因是因为你让它变得比它需要的更复杂。引导并不比您的代码片段复杂，除了您可能需要调用一个方法`root1`或`root2`让您的应用程序开始执行它所做的任何事情！

其余的只是由 Guice 处理。任何在执行过程中被实例化的对象都通过一个带注释的`@Inject`构造函数（或方法）从 Guice 获得它需要的东西。不需要有一个 Boostrapper 对象来控制所有树的所有根，因为 DI 容器管理所有实例。如果一棵树中的对象需要另一棵树中的对象，您就是`@Inject`它！无需为此“询问” Bootstrapper 对象。对于有背景的人来说，这有时很难想象`ServiceLocator`，但它确实是设计课程的一种更有凝聚力的方式。

Guice 有几个用于管理依赖图的工具。不同的依赖树是通过**模块**管理的，模块只是一组内聚的绑定。因此，Guice 鼓励您封装功能并让注入器解决相互依赖关系。此外，Guice 直到需要时才实例化图（除了可以急切加载的单例），开发人员可以使用`Provider`接口和方法显式延迟实例化。

如果您解释一下您希望将 Guice 用于哪种应用程序，或者解释一下您习惯使用哪种应用程序，也许会有所帮助。这将使我们更好地了解什么是没有意义的。

# iphone - OAuthConsumer 框架

> ID：10141951
> 
> 赞同：0
> 
> 时间：2012-04-13T13:40:02.617
> 
> 标签：iphone, objective-c, xcode, frameworks, oauth

我实际上在 iphone 项目上工作，我想使用 OAuthConsumer 进行身份验证。开发者指南说

"*为了使用框架，您必须首先从 svn 存储库中获取一份副本并对其进行编译。编译框架将自动运行所有单元测试。* "

我得到了 svn 存储库，但我不明白如何编译它...

你能帮我吗 ？

（对不起我的英语不好...）

谢谢

ps：安装指南链接[http://code.google.com/p/oauthconsumer/wiki/UsingOAuthConsumer](http://code.google.com/p/oauthconsumer/wiki/UsingOAuthConsumer)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T11:01:49.187

你可能已经解决了这个问题，但如果它可以帮助别人...... [http://code.google.com/p/oauthconsumer-iphone/](http://code.google.com/p/oauthconsumer-iphone/)

该项目包含一个生成文件，它将提取 OAuthConsumer 的 Objective-C 组件，以便它适用于 iPhone 应用程序开发。

:)

# sum - SSAS - 顶部或底部的总和

> ID：10141966
> 
> 赞同：0
> 
> 时间：2012-04-13T13:40:56.783
> 
> 标签：sum, ssas, mdx

```
SELECT  
  [Measures].[Internet Sales Amount] ON COLUMNS  
 ,Tail  
  (  
    [Date].[Calendar Year].[Calendar Year].MEMBERS  
   ,2  
  ) ON ROWS  
FROM [Adventure Works]; 
```

以上 MDX 查询给我的输出为：

> 年份 互联网销售额
> 
> 2003 年 9,791,060.30 美元
> 
> 2004 年 9,770,899.74 美元

我了解这个查询是如何工作的，但我想在一个多维数据集中创建计算度量，它总是给我底部 2 年的总和。这该怎么做？我是 SSAS 的新手。我擅长设计简单的度量和维度，但在使用 MDX 时，我大多陷入困境。

PS：我尝试使用 TopCount、BottomCount 等，但在这里我想按“年份”排序，这是一个维度。

任何帮助，将不胜感激。

谢谢，

招架

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T15:14:10.703

以下查询计算 Date 维度最近 2 年总和的度量：

```
WITH
MEMBER [Measures].[Sales from the last 2 Years]
    AS Aggregate( Tail( [Date].[Calendar Year].[Calendar Year].Members, 2)
                , [Measures].[Internet Sales Amount]
                )

SELECT { [Measures].[Sales from the last 2 Years]
       } ON COLUMNS
     , { Tail( [Date].[Calendar Year].[Calendar Year].Members, 2)
       } ON ROWS
    FROM [Adventure Works] 
```

其他有趣的查询，将计算每年和以前的总和的度量：

```
WITH
MEMBER [Measures].[Sales from 2 years]
    AS Aggregate( { [Date].[Calendar Year].CurrentMember.PrevMember
                  : [Date].[Calendar Year].CurrentMember }
                , [Measures].[Internet Sales Amount]
                )

SELECT { [Measures].[Internet Sales Amount]
       , [Measures].[Sales from 2 years]
       } ON COLUMNS
     , NON EMPTY
       { [Date].[Calendar Year].[Calendar Year]
       } ON ROWS
    FROM [Adventure Works] 
```

It does a sum, because the aggregation type of the measure `[Measures].[Internet Sales Amount]` is `Sum`, and the `Aggregate` function aggregates according to the measure's aggregation type.

*   [Key Concepts in MDX](http://msdn.microsoft.com/en-us/library/ms144884.aspx)
*   [Aggregate function reference](http://msdn.microsoft.com/en-us/library/ms145524.aspx)

MDX is a hard topic to grasp; if you're starting out, I recommend you read the book [MDX Solutions, 2nd edition](https://rads.stackoverflow.com/amzn/click/com/0471748080).

# c# - Why are CLR Types derived from generics not supported in SQL Server 2008 and later?

> ID：10141969
> 
> 赞同：39
> 
> 时间：2012-04-13T13:41:04.800
> 
> 标签：c#, sql-server-2008, tsql, generics, sql-server-2012

The following code implements an UDT which derives from a generic (SortedDictionary):

```
[Serializable]
[Microsoft.SqlServer.Server.SqlUserDefinedType(Format.UserDefined, MaxByteSize = 8000)]
public class udtMassSpectra : SortedDictionary<float, float>, INullable, IBinarySerialize, ICloneable, IDisposable
{
...
} 
```

Creating the type (T-SQL):

```
CREATE TYPE dbo.udtMassSpectra EXTERNAL NAME MassSpectra.udtMassSpectra; 
```

throws an exception:

> Msg 10331, Level 16, State 1, Line 1 Type 'udtMassSpectra' in assembly 'MassSpectra' derives from a generic type which is not supported for a CLR Type.

What is the reason? Is there any workaround other than hiding the base class within a private member? This code works fine on a SQL-Server 2005.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T17:39:13.207

另一个建议：

> 验证类型是否被定义为类，不是原始的、嵌套的或泛型的

PS：

至于“在 MSSQL 2005 上工作但不是在 MSSQL 2008 上工作”——我引用 Tom Petty 的话：“你很幸运，宝贝！” ;)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T14:49:43.613

我没有使用 UDT 的经验，但问题可能是 float 无法表示 SQL-Server 的 NULL 值。

我做了一些研究，发现了这个[here](http://channel9.msdn.com/Learn/Courses/SQL2008R2TrainingKit/CLR/NullableTypesDemo)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T21:14:32.777

`SortedDictionary<float, float>`您可以通过在 UDT 中存储一个实例来非常简单地解决此限制。

出于好奇，我想看看泛型类是如何在 T-SQL 上下文中实例化的，作为列数据类型、变量等。

# e-commerce - What ecommerce platforms support decimal product quantities?

> ID：10141970
> 
> 赞同：0
> 
> 时间：2012-04-13T13:41:12.837
> 
> 标签：e-commerce, shopping-cart, webshop

I am working on a client site and the majority of what they sell is fabric sold by the yard, with a minimum of .25 yards per purchase.

The client INSISTS that he wants the end user to enter a decimal into the quantity field to order the amount of fabric she wants and so far I haven't been able to talk him out of this requirement.

They currently use Miva because it supports this particular requirement (through a [module](http://www.mivacentral.com/Merchant2/merchant.mv?Screen=PROD&store_code=m&product_code=WCW-SIZEX5&query=http://search.mivacentral.com/search/index?query=size&search.x=0&search.y=0)). I'd prefer not to work with Miva if I can help it, so I'm turning to you guys!

So far, I've found two additional options for handling decimal quantities:

*   Magento
*   Zen Cart

Anyone know of any other options? I'm open to anything right now (hosted, open source, whatever), just want to see all the options for this one specific weird requirement.

Thanks!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T16:01:30.730

你可以去 TYPO3 Multishop。也是开源的，经过微小的调整，它支持小数作为数量输入。您可以在以下网页上看到它的实际效果：

[http://www.bbms.nl/webwinkel/](http://www.bbms.nl/webwinkel/)

更多关于 TYPO3 Multishop 的信息可以在这里找到：

[http://typo3multishop.com/](http://typo3multishop.com/)

# cordova - xcode 中的 Cordova 文件上传错误 - “WebKit 丢弃了未捕获的异常”

> ID：10141975
> 
> 赞同：1
> 
> 时间：2012-04-13T13:41:27.423
> 
> 标签：cordova

我很难让 FileTransfer 在 Cordova 1.6.0 中工作。我在早期版本中没有尝试过，所以我不知道这是否是一个新问题。

```
var options = new FileUploadOptions();
options.fileKey = "file";

var ft = new FileTransfer();
ft.upload( 
    imageURLToLocalFile, 
    urlToMyServiceEndpoint, 
    successhandler,
    errorhandler,
    options
); 
```

在我看到的 Xcode 控制台中。

```
*** WebKit discarded an uncaught exception in the
webView:decidePolicyForNavigationAction:request:frame:decisionListener: 
delegate: <NSRangeException> ***
 -[JKArray objectAtIndex:]: index (1) beyond bounds (1) 
```

在我看来，当 Cordova exec 函数调用本机 Filehandler 函数时，会发生这种情况，但我不知道如何解释错误消息。

我有点怀疑创建错误的调用，即 Cordova 文件中的 FileTransfer.prototype.upload 函数。我的 1.6.0 版本是：

```
exec(
    successCallback, 
    errorCallback, 
    'FileTransfer', 
    'upload', 
    [filePath, server, fileKey, fileName, mimeType, params, trustAllHosts, chunkedMode]
); 
```

而旧的 1.5.0 版本是：

```
Cordova.exec(
    successCallback,
    errorCallback,
    'org.apache.cordova.filetransfer', 
    'upload', 
    [options]
); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T05:01:29.963

这是 Cordova 1.6.x 中的一个错误，将在 Cordova 1.7.0 (https://issues.apache.org/jira/browse/CB-543) 中解决。

解决方法是手动指定所有选项（fileName、fileKey 等），因为框架错误地将它们视为必需的。

所以：

```
var options = new FileUploadOptions();
options.fileKey = "file"; 
```

变成：

```
var options = new FileUploadOptions();
options.fileKey = "file";
options.fileName = "image.jpg";
options.mimeType = "image/jpeg";
options.chunkedMode = true;
options.params = {}; // This line is untested as I have actual params 
```

富有的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T07:46:36.840

上传方式好像变了。我有类似的问题，通过在选项之后添加 true 来解决：

```
var ft = new FileTransfer();
ft.upload(

  imageURLToLocalFile, 
  urlToMyServiceEndpoint, 
  successhandler,
  errorhandler,
  options,
  **true**
); 
```

# xcode - 在 xcode 中包含提升

> ID：10141983
> 
> 赞同：19
> 
> 时间：2012-04-13T13:42:08.377
> 
> 标签：xcode, boost

我不能在 xcode 中包含 boost。我使用了 Boost 文档中的构建说明，并在 xcode /usr/local/lib 和 /usr/local/include 中编写了搜索路径。

请提供任何帮助！

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-07-01T14:59:59.650

我花了很长时间试图完成这项工作。我无法使用从 Boost 项目主页下载的内容使其工作，因此我使用了[自制软件](https://brew.sh/)：

安装自制软件后，我使用以下方法安装了 Boost：

```
brew install boost 
```

或者，如果您没有安装 python，请使用：

```
brew install boost --without-python 
```

没有 --without-python 它不会安装在我的机器上。

1.  在 XCode (4.3.3) 中，选择左侧边栏中的项目文件（最顶部），然后在项目窗格中再次选择它。
2.  选择构建设置选项卡，然后选择全部。
3.  在搜索路径下，添加标题搜索路径**/usr/local/Cellar/boost/1.49.0/include/**并选中该框。该路径现在应该显示在构建设置中。

现在，您可以使用：

```
#include <boost/regex.hpp> 
```

或者任何你需要的 Boost 包。

* * *

如果您已经安装了 boost，请使用`$ brew info boost`获取正确的路径：

```
boost: stable 1.60.0 (bottled), HEAD
Collection of portable C++ source libraries
https://www.boost.org/
/usr/local/Cellar/boost/1.60.0_1 (11,139 files, 436.5M) *
  Poured from bottle
From: https://github.com/Homebrew/homebrew-core/blob/master/Formula/boost.rb 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-12-25T01:29:10.237

我在 mac os 10.6.8 上使用带有 Xcode 3.2.1 的 boost

我今天在使用 boost 和 Xcode 时遇到了问题，最后我设法让它工作了，所以我希望这会有所帮助：

1.  下载boost，我今天拿到了1.52.0，解压

2.  安装提升：

    起初我做不到`./bootstrap.sh`，它在前几行之后就停止了。google了一下，得到了答案，是因为很久以前安装Xcode的时候，不知什么原因没有勾选安装选项中的“Unix开发”。此时，重新安装新版本的Xcode，检查“unix开发线”

    之后，`./bootstrap`并`./b2`安装工作正常

3.  拉姆达示例：

    此时，第一个示例应该可以正常工作，如果它没有尝试`/usr/local/include`在项目设置/标题搜索路径中添加

4.  使用线程或其他需要构建的东西

    线程需要特定的 dylib 才能工作：libboost_system.dylib。在我的系统上，它位于thingy`/usr/local/lib`之后`./b2 install`

    在 GUI 的左侧，您可以右键单击任意位置并选择 Add Existing File

    如果文件被隐藏，你可以在目录中找到一个快捷方式来访问 usr/local/lib`/Developer/SDKs/MacOSX10.6.sdk/usr/local`

一旦`libboost_system.dylib`确实出现在 GUI 的组和文件部分中，它应该可以工作

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2015-09-19T22:24:08.937

我关注了 henrikstroem 的精彩帖子，如下所示：

通过[homebrew](http://brew.sh/)安装，不到 3 分钟

```
mac:~ woz$ brew install boost
==> Downloading https://downloads.sf.net/project/machomebrew/Bottles/boost-1.57.0.yosemite.bottle.tar.gz
######################################################################## 100.0%
==> Pouring boost-1.57.0.yosemite.bottle.tar.gz
  /usr/local/Cellar/boost/1.57.0: 10572 files, 439M
mac:~ woz$ 
```

在您的主目录中创建符号链接

```
mac:~ woz$ cd
mac:~ woz$ ln -s /usr/local/Cellar/boost/1.57.0 boost_1_57_0
mac:~ woz$ 
```

在 Xcode 内部，像这样引用刚刚创建的符号链接

[![用于提升的 Xcode 构建设置](../Images/5e9136f079947637c322be3b97c1ce82.png)](https://i.stack.imgur.com/Ovi2t.png)

为了`Header Search Paths`使用`$(HOME)/boost_1_57_0/include`

为了`Library Search Paths`使用`$(HOME)/boost_1_57_0/lib`

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-12-26T04:53:04.563

```
mic@mbp: ~/work $ brew install boost
mic@mbp: ~/work $ ls -l /usr/local/include/boost
lrwxr-xr-x  1 mic  wheel  36 Nov 27 01:06 /usr/local/include/boost -> ../Cellar/boost/1.56.0/include/boost 
```

嗨，我添加`/usr/local/include`（`Header Search Paths`双击它，但调试或其他子检查），然后

```
#include <boost/asio.hpp>
#include <boost/date_time.hpp>

using namespace boost;

int main() {
    asio::io_service io;

    io.run();
    return 0;
} 
```

工作，:D

# sql - Oracle SQL 合并语句只有一个表和一堆值

> ID：10141988
> 
> 赞同：5
> 
> 时间：2012-04-13T13:42:39.357
> 
> 标签：sql, oracle, spring, merge-statement

我正在使用 Spring JDBC 和 oracle SQL。

使用 SpringJDBC 类 MapSqlParameterSource，我已经映射了我想要合并的数据。

现在我想使用合并语句来更新/插入数据库表。我所拥有的只是一张表和一堆我想合并到其中的参数。

```
 merge into proj.person_registry pr
using ( ! parameters should go here somehow? )
on (pr.id = :id or pr.code = :code)
when matched then 
update set pr.code             = :code,
        pr.name                 = :name,
        pr.firstname            = :firstname,
        pr.cl_gender            = :cl_gender,
        pr.cl_status            = :cl_status,
        pr.aadress              = :aadress,
        pr.aadress_date         = :aadress_date 
when not matched then
insert values (:code, :name, :firstname, :cl_gender, :cl_status, ;aadress, :aadress_date); 
```

**我是否必须以某种方式为using**关键字创建一个临时表， 还是有其他方法？我将如何进行这样的合并？

还有两个唯一键 pr.id 和 pr.code。有时参数**:id**为**null**，当发生这种情况时，我想根据 pr.code 与 :code 匹配来访问更新语句。如果我的更新包含以下行，它是否仍然有效：

```
update set pr.code             = :code, 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-13T17:14:36.847

这应该有效：

```
merge into proj.person_registry pr
using ( 
  select 42 as id
         'xyz' as code,
         'Dent' as name,
         'Arthur' as firstname,
         'male' as cl_gender
         'closed' as cl_status,
         'Somewher' as aaddress,
         current_date as aaddress_date
   from dual
) t on (pr.id = t.id or pr.code = t.code)
when matched then 
update set pr.code             = t.code,
        pr.name                 = t.name,
        pr.firstname            = t.firstname,
        pr.cl_gender            = t.cl_gender,
        pr.cl_status            = t.cl_status,
        pr.aadress              = t.aadress,
        pr.aadress_date         = t.aadress_date 
when not matched then
insert values (t.code, t.name, t.firstname, t.cl_gender, t.cl_status, ;aadress, t.aadress_date); 
```

我不熟悉 Spring 的 JDBC 模板，但是用`select ... from dual`参数占位符替换查询中的实际值应该可以。

# facebook - 如何让我的网站显示在 http://api.facebook.com/

> ID：10141989
> 
> 赞同：0
> 
> 时间：2012-04-13T13:42:41.333
> 
> 标签：facebook, api, header, tags, meta-tags

希望有人可以在这里帮助我。

我正在尝试提取喜欢按钮在我的每个网页上获得的喜欢数量。但是，我没有给我任何有关该页面的信息，而是得到下面显示的内容（例如），没有任何统计信息。我将如何获得它，以便在我的每个单独页面的 API 页面上显示喜欢的数量？我的每个页面都需要某种标签吗？

同样，我只是希望能够提取我的每个页面获得的喜欢的数量。

非常感谢！:)

担

```
{
   "id": "http://samplewebsite.com/3242342234"
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T13:46:33.537

像这样： [https ://graph.facebook.com/YOUR_PAGE_ID](https://graph.facebook.com/YOUR_PAGE_ID)

编辑：

如果第一个 URL 不起作用，请尝试以下操作： [https://api.facebook.com/method/fql.query?query=select like_count from link_stat where url=YOUR_URL](https://api.facebook.com/method/fql.query?query=select%20like_count%20from%20link_stat%20where%20url=YOUR_URL)

# google-maps - disableAutoPan 不适用于 Google Maps API v3

> ID：10141990
> 
> 赞同：2
> 
> 时间：2012-04-13T13:42:42.133
> 
> 标签：google-maps, google-maps-api-3, infowindow

我正在使用 Maps API（v3，javascript）在该客户的网站上显示一堆待售的本地房产。当用户将鼠标悬停在标记上时，它会加载带有属性信息的 infoWindow。问题是，当它位于地图边缘附近时，它会平移地图以显示信息窗口，当附近有很多标记时，这可能会导致问题。

所以我在 infoWindow 调用中添加了 disableAutoPan: true ，它似乎解决了这个问题。但是，经过更多测试后，如果用户手动移动地图，然后将鼠标悬停在标记上，则生成的 infoWindow 会平移地图。这就像它忽略了 infoWindow 的设置。

其他人有这个问题或任何想法如何解决它？我用来调用 infoWindow 的代码如下：

```
infoWindowAjax = new google.maps.InfoWindow({
  disableAutoPan: true,
  maxWidth: '260'
}); 
```

# java - 从 ColdFusion 服务器执行 Excel 宏

> ID：10141993
> 
> 赞同：2
> 
> 时间：2012-04-13T13:42:57.140
> 
> 标签：java, excel, coldfusion, apache-poi, poi-hssf

我有一个 ColdFusion Web 应用程序，它允许用户在服务器上上传 Excel 工作簿。

上传文件后，我想在该 Excel 文件中执行宏。

任何人都知道我该如何做到这一点？

注意：我也可以使用 Java 对象，我已经在使用 HSSF POI 来访问表格的内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T15:00:38.373

POI 和类似的 java 库无法运行宏。运行宏需要 MS Excel 应用程序，这意味着它必须安装在服务器上。然后通过 COM、Excel.Interop 等访问。

也就是说，出于安全原因，通常您不想在服务器上执行宏。所以我的第一个问题是这个宏有什么作用？如果你能告诉我们你最终想要达到的目标，也许有更简单、更安全的选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T16:04:35.043

我找到了一种方法来做这样的事情：

1）在服务器上编写一个 VBS 脚本文件，如下所示：

```
 <cfset contentVBS = 
            "Dim objXL" & Chr(13) & Chr(10) &
            "Set objXL = CreateObject(" & Chr(34) & "Excel.Application" & Chr(34) & ")" & Chr(13) & Chr(10) &
            "With objXL" & Chr(13) & Chr(10) &
            "   .Workbooks.Open (" & Chr(34) & VARIABLES.Instance.filePath & VARIABLES.Instance.fileName & Chr(34) & ")" & Chr(13) & Chr(10) &
            "   .Application.Run " & Chr(34) & VARIABLES.Instance.macroName & Chr(34) & Chr(13) & Chr(10) &
            "   .Application.Quit" & Chr(13) & Chr(10) &
            "End With" & Chr(13) & Chr(10) &
            "Set objXL = Nothing" & Chr(13) & Chr(10)
    />

    <cffile
        action="write"
        charset="utf-8"
        file="#VARIABLES.Instance.filePath##VARIABLES.Instance.script_vbs_name#"
        output="#contentVBS#"
        addnewline="no"
    > 
```

`VARIABLES.Instance.filePath`我的 Excel 文件的路径在哪里，是我的 Excel 文件的名称`VARIABLES.Instance.fileName`，`VARIABLES.Instance.macroName`是我要启动的宏的名称。

2）使用cscript.exe执行vbs文件：

```
 <cfexecute name = "C:\WINDOWS\system32\cscript.exe"
        arguments = "#VARIABLES.Instance.filePath##VARIABLES.Instance.script_vbs_name#">
    </cfexecute> 
```

`VARIABLES.Instance.script_vbs_name`我刚才写的VBS脚本文件的名字在哪里。

注意：该宏在服务器上生成一个文件，因此我需要指定 ColdFusion 服务器对该文件夹的读/写访问权限。

# c++ - C ++程序：其中键是名称和其他三个参数的映射

> ID：10141997
> 
> 赞同：-1
> 
> 时间：2012-04-13T13:43:05.830
> 
> 标签：c++, map, insert, iterator

我有一个包含以下代码的 C++ 程序。我想知道是否`timeval`像这样从迭代器访问结构的成员：

```
time_iter->second.tv_sec 
```

是否正确。

```
 static std::map<std::string,struct timeval> name_time_map;
 std::map<std::string,struct timeval>::iterator time_iter;

 time_iter = name_time_map.find(name);

 if (time_iter == name_time_map.end()) {
   gettimeofday(&tvPrev, NULL); 
   name_time_map[name]=tvPrev;
 }
 else {
   print("what inserted values have");
   gettimeofday(&tvCurrent, NULL);
   diff = 
     (tvCurrent.tv_usec + 1000000 * tvCurrent.tv_sec) - 
     (time_iter->second.tv_usec + 1000000 * time_iter->second.tv_sec);

   tvDiff.tv_sec = diff / 1000000;
   tvDiff.tv_usec = diff % 1000000; // micro seconds
 } 
```

我担心的是，鉴于指向预定义结构`time_iter->second.tv_sec`，可能不允许使用访问插入的值。`second``struct timeval`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T14:25:22.050

对，那是正确的。例如，运行以下代码：

```
#include <map>
#include <string>
#include <iostream>

using namespace std;

int main()
{
   struct MyStruct
   {
      int someValue;
   };
   map<string, struct MyStruct> exampleMap;
   MyStruct exampleStruct;
   exampleStruct.someValue = 5;
   exampleMap["exampleKey"] = exampleStruct;
   map<string, struct MyStruct>::iterator exampleIterator = exampleMap.find("exampleKey");
   cout << exampleIterator->second.someValue;
} 
```

输出结果：

```
5 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T14:33:52.803

从一开始它*看起来*还不错（忽略相当吓人的缩进做法）。话虽如此，真相在考验中。