# StackOverflow 问答 12325000-12325999

# c# - 自动登录网站 + 获取 cookie 参数 (C#)

> ID：12325004
> 
> 赞同：0
> 
> 时间：2012-09-07T20:34:14.730
> 
> 标签：c#, .net, autologin

是否可以使用 C# 创建网站的自动登录？例如，我想通过外部网站从服务器进行身份验证，并从 cookie 中获取一些参数。也许为此目的存在特殊库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T21:01:30.570

如果可能的话，您打算做什么，您可以尝试使用多种方式使用**会员提供程序**，让您可以轻松地创建、管理和更改用户配置文件，包括自动加载状态，以进入站点。我希望你需要这些信息。

# ios - 通过NSPredicatae获取CoreData中一对多关系的最大值

> ID：12325011
> 
> 赞同：0
> 
> 时间：2012-09-07T20:34:59.437
> 
> 标签：ios, core-data, max, nspredicate, database-relations

我正在创建一个时钟应用程序，其中有一个 ClockPunch NSManagedObject 模型，该模型具有表示打卡和打卡的属性。每个 ClockPunch 实例都与Employees 模型中的一个Employee 有关系（它也与每个punch 有一对多的关系）。我希望能够编写一个 NSPredicate 来为我提供员工最近打卡的信息。然后，我可以通过他们是否有匹配的打卡打卡来确定他们是打卡还是打卡。我不想把所有的拳头都拉进去然后对它们进行分类，因为每个员工可能有 1000 个。我该怎么办？

我的模型看起来像这样

```
Employees<->>ClockPunches 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T21:32:25.003

我最近尝试了类似的东西。我试图找到最大日期的注册。

```
NSFetchRequest* request = [Registration fetchRequest];
NSExpression *date = [NSExpression expressionForKeyPath:@"time"];

NSExpression *maxDate = [NSExpression expressionForFunction:@"max:"
                                                  arguments:[NSArray arrayWithObject:date]];

NSExpressionDescription *d = [[[NSExpressionDescription alloc] init] autorelease];
[d setName:@"maxTime"];
[d setExpression:maxDate];
[d setExpressionResultType:NSDateAttributeType];
[request setPropertiesToFetch:[NSArray arrayWithObject:d]];

NSError *error = nil;
NSArray *objects = [Registration executeFetchRequest:request];
if (objects == nil) {
    // Handle the error.
} else {
    if (0 < [objects count]) {
        NSLog(@"Maximum date: %@", [[objects objectAtIndex:0] valueForKey:@"type"]);
    }
} 
```

您可以在此页面上找到更多详细信息。[https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreData/Articles/cdFetching.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreData/Articles/cdFetching.html)

然而，我仍然缺少的部分是如何只查看特定员工的注册......我尝试将请求设置为 NSPredicate 但不知何故它们不能一起使用。

注意：我使用 restkit 进行 coredata 访问，点击链接获取纯核心数据示例（只有一小部分代码不同）

# asp.net - 在asp.net中禁用页面的简洁方法是什么？

> ID：12325012
> 
> 赞同：1
> 
> 时间：2012-09-07T20:35:07.753
> 
> 标签：asp.net

在想象的情况下，不应访问网页的用户导航到该页面。此页面是子页面。用户在此页面中不应该有任何功能，甚至不能看到任何东西，但他（或她）应该仍然能够使用母版页控件。你做什么来禁用页面？

我想也许可以制作一个控制元素 .visible=false，但这安全吗？还有其他方法我应该禁用页面吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T21:11:56.693

提供`nopermission.aspx`具有所需母版页的页面，然后`Page_Load`重定向到该页面

```
protected void Page_Load(object sender, EventArgs e)
{
    if(!HasPermission("User123"))   //User does not have permission
       Response.Redirect("nopermission.aspx");

    //otherwise, the page continues as required
} 
```

`nopermission`您可以在页面中放置您希望的任何友好信息

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T23:23:13.560

假设我理解您的问题，并假设您指的是 ASP.Net Web 表单，那么请查看`<asp:LoginView />`控件。

它有一个`<AnonymousTemlate />`和一个`<LoggedInTemplate />`分别代表用户的类型（匿名或登录，将显示适当的内容）。

它适用于 ASP.net 表单身份验证。

有关详细信息：[MSDN - ASP.Net 登录控件](http://msdn.microsoft.com/en-us/library/ms178329%28v=vs.100%29.aspx)

嗯……

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-08T03:05:59.800

如果用户无权访问控件，则使控件可见 = false 应该是安全的，因为该控件的任何内容都由服务器呈现。

但是，如果用户尝试访问他们无权访问的页面，我通常会记录该活动并将他们重定向到“抱歉您无权查看此页面”屏幕

# ruby - 我应该明确关闭 StringIO 实例吗？

> ID：12325014
> 
> 赞同：2
> 
> 时间：2012-09-07T20:35:13.867
> 
> 标签：ruby

我正在使用[StringIO](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/stringio/rdoc/StringIO.html)类编写一些测试，只是想知道：我可以关闭 StringIO 实例，因为它实际上是在模仿 IO，但我真的应该打扰吗？我应该关闭 StringIO 实例，因为我实际上[应该关闭文件](https://stackoverflow.com/questions/4795447/rubys-file-open-and-the-need-for-f-close)吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T21:07:06.873

好吧，读写直接进入底层字符串；没有要刷新的额外缓冲区，也没有要返回的操作系统级资源。

您可能想要关闭 StringIO 的唯一原因是使后续 IO 失败，或者如果您需要`closed?`返回 true，如果您将该 StringIO 提供给其他组件，这可能会很有用。另一方面，如果您稍后只是要丢弃 StringIO，那一点也不重要；垃圾收集器不关心它是标记为打开还是关闭。

# javascript - 下拉菜单大小更改事件？

> ID：12325015
> 
> 赞同：0
> 
> 时间：2012-09-07T20:35:14.180
> 
> 标签：javascript, javascript-events, jquery

当下拉菜单的大小发生变化/添加元素时，是否有可能通过 jQuery / Javascript 触发事件？格雷茨

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T20:51:04.393

不幸的是，您无法检测是否已将新选项添加​​到选择中。

如果新选项已添加到选择中，则不会有任何事件通知您。

这个问题的一个简单解决方案是创建一个间隔，每隔 n 秒检查一次新选项。

例子：

```
 var leSelect     = $('#my-select'),
     noOfoptions  = leSelect.children().length;

 setInterval(function() {
     if(leSelect.children().length > noOfoptions) {
         console.log('boom. new option has been added');
     }
 }, 10000); // 10 seconds 
```

# php - Uploadify - 返回上传表单的随机表单数据

> ID：12325016
> 
> 赞同：0
> 
> 时间：2012-09-07T20:35:15.147
> 
> 标签：php, javascript, jquery, uploadify

基本上我想要做的是生成一个字母数字字符串，它被传递给 php 处理程序，以及返回到上传表单。上传完成后，表单会使用字母数字字符串创建一个链接。

除了一个问题，我已经完成了所有工作。仅生成一个随机字符串，因此如果您尝试同时上传多个文件，每个文件都具有相同的字符串名称。我需要它们每个具有不同的名称，但我似乎无法弄清楚如何，同时仍然能够传递回表单和 php.ini 文件。

这是我的脚本：

```
<script>
    function randomString(length, chars) {
        var result = '';
        for (var i = length; i > 0; --i) result += chars[Math.round(Math.random() * (chars.length - 1))];
        return result;
    }
    var sessid = '';
    var data = document.getElementById('data');
    $(document).ready(function () {

        $('#myModal').modal({
            show: false
        });
        $('#mm').modal({
            show: false
        });

        $(function () {
            $('#file_upload').uploadify({
                'fileObjName': 'file',
                'fileSizeLimit': '8MB',
                'buttonText': 'BROWSE FILE(S)...',
                'fileTypeExts': '*.JPEG; *.GIF; *.PNG; *.APNG; *.TIFF; *.BMP; *.PDF; *.XCF',
                'cancelImg': 'uploadify-cancel.png',
                'swf': 'uploadify.swf',
                'uploader': 'uploadify.php',
                'formData': randomString(7, '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'),
                'auto': false
            });
        });
    });
</script> 
```

我还对 进行了小修改`jquery.uploadify-3.1.min.js`，允许将随机字符串传递回表单。

```
if (c.inArray("onUploadSuccess", g.overrideEvents) < 0) {
    c("#" + f.id).find(".data").html(" - " + this.settings.post_params);
} 
```

如果有人想看到这一切，你可以在这里看到它：http: [//icap.me/test/files.php](http://icap.me/test/files.php) 忽略损坏的设计，现在我只是想让它工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T20:54:19.610

使用`onUploadStart`处理程序设置用于上传的随机字符串。

```
$('#file_upload').uploadify({
            'fileObjName': 'file',
            'fileSizeLimit': '8MB',
            'buttonText': 'BROWSE FILE(S)...',
            'fileTypeExts': '*.JPEG; *.GIF; *.PNG; *.APNG; *.TIFF; *.BMP; *.PDF; *.XCF',
            'cancelImg': 'uploadify-cancel.png',
            'swf': 'uploadify.swf',
            'uploader': 'uploadify.php',
            'auto': false,
            'onUploadStart': function() {
               $("#file_upload").uploadify('settings', 
                                           'formData',
                                           randomString(7, '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ')) }
        }); 
```

# compression - 什么是 pvrtc 纹理压缩二进制格式？

> ID：12325024
> 
> 赞同：0
> 
> 时间：2012-09-07T20:35:49.067
> 
> 标签：compression, textures, pvrtc

我不是在寻找定义。我正在寻找格式是什么，所以我自己制作或解码它们，没有库，没有工具，只有格式，所以我可以编写自己的代码。如果您知道格式是什么，请在此处发布或发布链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T09:22:07.737

根据我的一位同事的说法，Imagination Technologies 的 PowerVR SDK 应该包含参考解压缩代码以及二进制格式的文档（“PVRTC 和纹理压缩用户指南”）。

# actionscript-3 - 如何从 AS3 中的对象中自动删除事件侦听器

> ID：12325025
> 
> 赞同：1
> 
> 时间：2012-09-07T20:35:53.477
> 
> 标签：actionscript-3, flash, events, event-handling

我正在开发小型 Flash 游戏。游戏包含 20 个关卡和主菜单。通过删除框架上的每个对象以及所有事件侦听器来实现级别之间的转换。然后代码从下一级添加对象......

捕获和删除事件侦听器由以下代码完成：

```
override public function addEventListener(type:String, listener:Function, useCapture:Boolean=false, priority:int=0, useWeakReference:Boolean=false):void
    {
        super.addEventListener(type, listener, useCapture, priority, useWeakReference);
        arrListeners.push({type:type, listener:listener});

    }

    private function clearEvents():void
    {
       for(var i:Number = 1; i<arrListeners.length; i++){
          if(this.hasEventListener(arrListeners[i].type))
        {
             this.removeEventListener(arrListeners[i].type, arrListeners[i].listener);
          }
       }
       arrListeners = []
    } 
```

此代码覆盖内部 addEventListeners 并使每个侦听器都添加到数组中。第二个函数检查 EventListeners 是否仍然存在（之前没有删除），然后从数组中删除每个 Listener。

此代码适用于分配给舞台的 EventListener。但是，当 EventListener 直接分配给 Object 时，它不会添加到数组中，因此以后不会自动删除。

我知道当你删除对象时，你也会删除分配给它的事件监听器。但是当我再次添加该对象时，侦听器会运行两次。您可以在关卡中自由移动，因此您可以来回走动。当你回去时，我会遇到问题。系统被过度使用并且工作速度变慢，因为正在运行的事件侦听器的数量增加了一倍。

那么，您能否修改此代码或给我一个建议，我如何才能捕获分配给 Object 的 EventListener 并最终删除它们。

代码：

```
package

{
     Public Class Main extends MovieClip
     {
          Public function Main()
          {
               Intro();
          }
          Private function Intro():void
          {
             //Constructor contains a lot of addChild and a EventListeners. So I will upload what I think i important for this problem.
             Play_btn.addEventListener(MouseEvent.CLICK, clicked);
             function clicked (e:MouseEvent):void
             {
                 clearEvents();
                 clearChild(); // function that removes all children on stage
                 FirstLevel();
              }
           }
           Private function FirstLevel():void
           {
              //Also adding children and EventListeners, that affect the gameplay
              Next_level_btn.addEventListener(MouseEvent.CLICK, clicked1);
              function clicked1 (e:MouseEvent):void
             {
                 clearEvents();
                 clearChild();
                 SecondLevel();
              }
              Main_Menu_btn.addEventListener(MouseEvent.CLICK, clicked1);
              function clicked1 (e:MouseEvent):void
              {
                 clearEvents();
                 clearChild(); 
                 Intro();
               }
            } 
```

接下来的 20 个级别以此类推。

谢谢指教。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T20:48:37.560

移除一个对象 ( `removeChild(object)`)**不会**自动移除它的事件监听器。你需要自己做。像这样的东西可以工作：

在您的类构造函数中：

```
super.addEventListener(Event.ADDED_TO_STAGE,addedToStage,false,0,true);  //only if you want the listeners added back again the next time this object is added to the stage  eg. addChild(this)
super.addEventListener(Event.REMOVED_FROM_STAGE,removedFromStage,false,0,true); 
```

处理程序：

```
//this runs whenever the object is added to the display list
//if you don't want the listeners re-added, remove this function.
private function addedToStage(e:Event):void {
    for(var i:int=0; i<arrListeners.length; i++){
        super.addEventListener(arrListeners[i].type, arrListeners[i].listener, arrListeners[i].useCapture, arrListeners[i].priority, arrListeners[i].useWeakReference);
    }
}

//this runs whenever the object is removed from the display list
private function removedFromStage(e:Event):void {
    for(var i:int=0; i<arrListeners.length; i++){
        super.removedEventListener(arrListeners[i].type, arrListeners[i].listener, arrListeners[i].useCapture);
    }

    //OR if you want the listeners gone forever, use your clearEvents() method instead of the for loop above
} 
```

这将使您的听众在项目从显示列表中删除时停止收听，并在添加时重新添加它们。您必须修改您的数组以包含其他侦听器信息，例如捕获阶段和弱引用。如果您不想再次添加它们，只需在 removedFromStage 处理程序中调用您的 clearEvents() 并完全取出 addedToStage 侦听器/处理程序。

这是假设您发布的代码（以及我添加的代码）是您希望将其应用于的所有对象的基类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T20:38:40.200

数组索引从 0 开始，clearEvents 应该是：

```
 private function clearEvents():void
 {
     for(var i:int= 0; i<arrListeners.length; i++){
        if(this.hasEventListener(arrListeners[i].type))
        {
             this.removeEventListener(arrListeners[i].type, arrListeners[i].listener);
        }
     }
     arrListeners = []
 } 
```

不确定这是否会解决您的问题。如果您在添加新对象时创建了事件侦听器，则应在对象被销毁/删除时删除这些侦听器。

# arrays - 快速加载 70,000 个文件到数组并插入数据库

> ID：12325026
> 
> 赞同：1
> 
> 时间：2012-09-07T20:35:55.823
> 
> 标签：arrays, bash

几天前，我在处理我们的 EMC 批量文件管理器上的大量文件的脚本时遇到了问题。这是我的工作代码

```
unset xP_Array
declare -a xP_Array
...
export LOG=$HOME/BIN/somelogfile
export OUT=/path/to/device
...
echo "`date '+%m/%d/%y %T:'` START -- MEM"                          >> $LOG

echo "`date '+%m/%d/%y %T:'` Go to work directory."                                              >> $LOG
cd ${OUT}

echo "`date '+%m/%d/%y %T:'` Fill the array."                                                   >> $LOG
for f in "$OUT"/*XML; do
    xP_Array+=( "${f#$OUT/}" )
done
echo "`date '+%m/%d/%y %T:'` Get array length."                                               >> $LOG
Plen=${#xP_Array[@]}

echo "`date '+%m/%d/%y %T:'` MEM: $Plen FILES TO PROCESS."                                      >> $LOG

echo "`date '+%m/%d/%y %T:'` Check if zero files."                                               >> $LOG
date_fmt='%m/%d/%y %T'
if (( Plen = 0 ))
then
    printf "%($date_fmt)T: ZERO FILES\n" $(date +%s)                                            >> $LOG
fi

echo "`date '+%m/%d/%y %T:'` Loop."                                                             >> $LOG
for i in "${xP_Array[@]}"
do
        echo "`date '+%m/%d/%y %T:'` Move file to run directory."                              >> $LOG
        mv $OUT/$i RUN/
        echo "`date '+%m/%d/%y %T:'` PROCESSING "$i"."                                          >> $LOG
        [[[DATABASE LOAD DONE HERE]]]
        echo "`date '+%m/%d/%y %T:'` Check DB LOAD return value."                                       >> $LOG
        EXIT=`echo $?`
        case $EXIT in
                0) echo "`date '+%m/%d/%y %T:'` COMPLETE."                                      >> $LOG
                mv RUN/"$i" "$ARCH"
                ;;
                *) echo "`date '+%m/%d/%y %T:'` ERROR. "$i" MOVED TO RECON."                    >> $LOG
                mv RUN/"$i" "$RECON"
                ;;
        esac
done

echo "`date '+%m/%d/%y %T:'` END -- MEM"                                    >> $LOG 
```

我想知道它是否可以更快地工作。我已经在与我的 DBA 合作，看看是否可以加快数据库插入速度，但我想知道循环本身是否可以运行得更快。

顺便说一句，`echo`当脚本完成时，所有语句都被重定向到我自己通过电子邮件发送的日志文件。他们是否减慢了脚本的速度？

可以优化此脚本以更快地运行吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T22:02:47.197

我在这里唯一能想到的是`echo "date...`语句和`CASE`语句，但它们的执行时间应该可以忽略不计。我会更专注于调整 SQL，而不是花时间在这里微调 bash 脚本。如果你真的想在脚本中做一些事情，你可以使用@chepner 提到的技巧。

另一种方法是，如果您的文件格式相同，那么您可以合并所有文件，或者一次合并 100 个文件作为`CSV`文件，然后使用合并后的`CSV`文件加载[External Tables](http://orafaq.com/node/848)。然后，您可以使用外部表来加载实际表。您可以使用外部表一次一个文件开始执行此操作，然后查看观察到的性能差异有多大。

当涉及到数据文件（如果格式正确）时，外部表是非常方便的解决方案，因为实际上不需要`INSERT`或`DELETE`需要努力，如果数据文件存在于指定目录中，您将在表中找到数据，否则您不会（如果数据文件不存在，在表上发出 a`SELECT`会导致错误，并会生成一些`log`可以轻松处理的文件）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T21:03:04.677

```
for f in "$OUT"/*XML; do
    xP_Array+=( "${f#$OUT/}" )
done 
```

可以替换为

```
pushd "$OUT"
xP_Array=( *XML )
popd 
```

但我认为这不是您脚本中的一大瓶颈。

在您的另一个循环中，我看到的唯一真正开销是重复调用`date`并使用命令替换分配`$?`给 EXIT，这可以直接完成 ( `EXIT=$?`)。我认为除了实际的数据库负载之外，没有其他可以优化的地方。

如果您愿意从人类可读的日期切换，您可以将当前时间（作为 UNIX 时间戳）分配给`SECONDS`，然后只需为日志行引用该变量，而不是调用`date`.

```
SECONDS=$(date +%s)
for i in "${xP_Array[@]}"
do
    echo "$SECONDS: Move file to run directory." >> $LOG
    # etc
done 
```

使用足够新的 bash（我认为是 4.2 或更高版本），`printf`可以将 UNIX 时间戳格式化为可读时间：

```
printf "%(%m/%d/%Y %T)T" $SECONDS 
```

# django - 所需示例：将提交的表单信息传递到审核页面

> ID：12325031
> 
> 赞同：-1
> 
> 时间：2012-09-07T20:36:24.333
> 
> 标签：django

我有一个使用modelForm 的表单我需要views.py 和相关文件的示例或代码来创建另一个页面，用户可以在其中查看他们提交的信息。我可以考虑使用他们保存到的数据库的主键来执行此操作，但是我如何使用他们刚刚输入的表单中的信息将它们重定向到另一个模板。

我还需要一个指向该页面的永久链接，以便其他人可以输入一个 url 来查看该信息审查页面

非常感谢您的帮助，如果您知道的话，您也可以将我重定向到带有上述示例的 url

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-08T18:11:46.907

我认为可以通过这种方式完成...

例如，您有一个采用 modelform 的注册表单

```
class RegistrationForm(ModelForm):
    username = forms.CharField(label=(u'User Name'))
    email = forms.EmailField(label =(u'Email Address'))
    password = forms.CharField(label =(u'Password'),widget=forms.PasswordInput(render_value=False))
    password1 = forms.CharField(label =(u'Verify Password'),widget=forms.PasswordInput(render_value=False))

    class Meta:
        model = Drinker
        exclude = ('user',) 
```

然后是视图：

```
def Registration(request):
    if request.POST:
        form =RegistrationForm(request.POST)
        if form.is_valid():
            user = User.objects.create_user(username=form.cleaned_data['username'],email=form.cleaned_data['email'])
            password = form.cleaned_data['password']
            user.save()
            path = reverse('Review', dict(user=user,email=email,password=password)
            return HttpResponseRedirect(path)
        else:
            return render(request,'register.html',{'form':form,})
    else:
        form = RegistrationForm()
        return render(request,'register.html',{'form':form,}) 
```

然后只需创建另一个视图：

```
def Review(request):
    render(request,'review.html',dict(user=user,email=email,password=password)) 
```

然后在review.html中显示它......希望这会有所帮助......

# ruby - 为什么当我的列在我的 attr_accessible 列表中时出现批量分配错误

> ID：12325033
> 
> 赞同：0
> 
> 时间：2012-09-07T20:36:25.660
> 
> 标签：ruby, ruby-on-rails-3, mass-assignment, attr-accessible

有几个与此相关的问题。但是没有一个答案能解决我的情况。

尝试创建新策略时，我在本地主机上收到此错误。

```
Can't mass-assign protected attributes: starts_on 
```

在我的 policy.rb 模型中，虽然我有这个：

```
class Policy < ActiveRecord::Base

belongs_to :policy_type

attr_accessible :starts_on,
                :ends_on,
                :i_agree_privacy_policy,
                :license,
                .
                .
                .etc...

validates:starts_on, :presence => true

def self.init(user, policy_type, load_user_profile = true)
    attributes = {
        :user => user,
        :policy_type => policy_type,
        :starts_on => Date.today
    }
    policy_type.policy_class.constantize.new(attributes)
end

etc...
end 
```

该表格用于保险，因此它很大，但在这里也不重要，因为我在这里使用 Date.today 创建了starts_on。真的很难过，过去几天我在谷歌上花了几个小时来弄清楚为什么会这样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-08T03:25:14.980

`policy_type.policy_class`您可能会在解析为的实际类上收到“无法批量分配”错误，而不是在`Policy`.

我会检查任何类`policy_type.policy_class`指向，并尝试添加`starts_on`到`attr_accessible`那里。

# c# - 存储过程仅在我重新启动 SQL Server 数据库服务器时才有效

> ID：12325043
> 
> 赞同：2
> 
> 时间：2012-09-07T20:37:08.140
> 
> 标签：c#, sql-server-2005

在我公司的一个基于 C#、ASP.Net、SQL server 2005 和 Windows Server 2008 的内部项目中，当有人尝试登录时，登录存储过程只需要无限的时间。但是当我重新启动数据库服务器时，问题就解决了。这每天都在发生。这可能不是数据库负载问题，因为其他存储过程可以正常工作。此外，如果我在存储过程中提取查询，我会在适当的时间得到结果。在存储过程中，除了获取数据之外，还有一个 if 条件将用户限制为仅使用某些 IP。

我不知道问题是什么。有人可以帮我找出问题所在。提前致谢。

这是存储过程

```
ALTER PROCEDURE [dbo].[get_user]          
@username varchar(50), @pwd varchar(50), @passcode varchar(50), @ipaddress varchar(15)          
AS          
BEGIN          
 IF(@ipaddress = 'aaa.aaa.aaa.aaa' OR @ipaddress = 'aaa.aaa.aaa.aaa' OR @ipaddress = 'aaa.aaa.aaa.aaa')          
 BEGIN          
  IF EXISTS(select up_id from tbl_user_profile (nolock) WHERE up_status='Y')          
  BEGIN          
   DECLARE @ri_date_time varchar(20)          
   SET @ri_date_time=convert(varchar(50),getdate(),120)          
   DECLARE @user_exists as int          
   Set @user_exists = 0          
   Set @user_exists = (Select count(*) from tbl_recent_items (nolock) where ri_user_name=@username)          
   IF @user_exists = 0          
   BEGIN          
    BEGIN TRAN          
     INSERT INTO tbl_recent_items (ri_user_name, ri_access_date_time) values (@username, @ri_date_time+'|'+@ipaddress+'^')          
     IF @@error=0 COMMIT TRAN ELSE ROLLBACK TRAN          
   END          
   ELSE          
   BEGIN          
    DECLARE @datetext varchar(max)          
    SET @datetext = (select isnull(ri_access_date_time,'') from tbl_recent_items(nolock) where  ri_user_name=@username)          
    SET @datetext=@ri_date_time+'|'+@ipaddress+'^'+@datetext          
    BEGIN TRAN          
     UPDATE tbl_recent_items Set ri_access_date_time=@datetext where ri_user_name = @username          
     IF @@error=0 COMMIT TRAN ELSE ROLLBACK TRAN          
   END          
  END          
  SELECT CONVERT(varchar(4),up_id) as up_id,LTRIM(RTRIM(isnull(up_user_name,''))) as u_user_name,           
  ISNULL(up_password,'') as u_user_password,isnull(up_first_name,'') as up_first_name,           
  ISNULL(up_middle_name,'') as up_middle_name, isnull(up_last_name,'') as up_last_name,           
  ISNULL(up_branch_id,'') as up_branch_id, isnull(b_branch_id,'') as b_branch_id,          
  ISNULL(b_branch_name,'') as b_branch_name,isnull(up_mobile_phone,'') as up_mobile_phone,          
  --ISNULL(up_pager_phone,'') as up_pager_phone,  
  isnull(up_email,'') as up_email,          
  ISNULL(up_status,'') as u_status,   
  --isnull(up_job_posting_phone,'') as up_job_posting_phone,          
--  ISNULL(up_level,'') as up_level, 
    isnull(up_trainee,'0') as up_trainee,          
  ISNULL(up_senior,'0') as up_senior, isnull(up_team_lead,'0') as up_team_lead, isnull(up_ist,'0')as up_ist, up_hyd_branch,    
  convert(varchar(10),up_password_date,102)as up_password_date    
  FROM tbl_user_profile (nolock)           
  LEFT OUTER JOIN tbl_branches (nolock) on up_branch_id = b_id where           
  up_user_name = @username and up_password =@pwd          
 END          
 IF EXISTS(select up_id from tbl_user_profile (nolock) WHERE up_user_name = @username and up_password = @pwd and up_passcode = @passcode and up_status='Y')          
 BEGIN          
  IF EXISTS(select up_id from tbl_user_profile (nolock) WHERE up_status='Y')          
  BEGIN          
   DECLARE @ri_date_time1 varchar(20)          
   SET @ri_date_time1=convert(varchar(50),getdate(),120)          
   DECLARE @user_exists1 as int          
   Set @user_exists1 = 0          
   Set @user_exists1 = (Select count(*) from tbl_recent_items (nolock) where ri_user_name=@username)          
   IF @user_exists1 = 0          
   BEGIN          
    BEGIN TRAN          
     INSERT INTO tbl_recent_items (ri_user_name, ri_access_date_time) values (@username, @ri_date_time1+'|'+@ipaddress+'^')          
     IF @@error=0 COMMIT TRAN ELSE ROLLBACK TRAN          
   END          
   ELSE          
   BEGIN          
    DECLARE @datetext1 varchar(max)          
    SET @datetext1 = (select isnull(ri_access_date_time,'') from tbl_recent_items(nolock) where  ri_user_name=@username)          
    SET @datetext1=@ri_date_time1+'|'+@ipaddress+'^'+@datetext1          
    BEGIN TRAN          
     UPDATE tbl_recent_items Set ri_access_date_time=@datetext1 where ri_user_name = @username          
     IF @@error=0 COMMIT TRAN ELSE ROLLBACK TRAN          
   END          
  END          
  SELECT CONVERT(varchar(4),up_id) as up_id,LTRIM(RTRIM(isnull(up_user_name,''))) as u_user_name,           
  ISNULL(up_password,'') as u_user_password,isnull(up_first_name,'') as up_first_name,           
  ISNULL(up_middle_name,'') as up_middle_name, isnull(up_last_name,'') as up_last_name,           
  ISNULL(up_branch_id,'') as up_branch_id, isnull(b_branch_id,'') as b_branch_id,          
  ISNULL(b_branch_name,'') as b_branch_name,isnull(up_mobile_phone,'') as up_mobile_phone,          
  --ISNULL(up_pager_phone,'') as up_pager_phone,  
  isnull(up_email,'') as up_email,          
  ISNULL(up_status,'') as u_status,  
   --isnull(up_job_posting_phone,'') as up_job_posting_phone,          
--  ISNULL(up_level,'') as up_level, 
 isnull(up_trainee,'0') as up_trainee,          
  ISNULL(up_senior,'0') as up_senior, isnull(up_team_lead,'0') as up_team_lead,isnull(up_ist,'0')as up_ist, up_hyd_branch,    
  convert(varchar(10),up_password_date,102)as up_password_date    
  FROM tbl_user_profile (nolock)           
  LEFT OUTER JOIN tbl_branches (nolock) on up_branch_id = b_id where           
  up_user_name = @username and up_password =@pwd          
 END          
END 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T20:38:21.403

听起来您正在为该过程缓存一个糟糕的执行计划。没有看到代码很难说，但[参数嗅探](http://www.sqlmag.com/article/database-administration/pros-cons-parameter-sniffing-140598)可能是一个问题。一种可能的解决方法是使用 WITH RECOMPILE 选项。这将强制存储过程每次重新编译并生成新的执行计划。

```
CREATE PROCEDURE YourLoginProc
WITH RECOMPILE
AS
... 
```

# c# - 不仅支持日期/时间触发器的调度引擎

> ID：12325048
> 
> 赞同：4
> 
> 时间：2012-09-07T20:37:20.840
> 
> 标签：c#, scheduled-tasks, quartz-scheduler

我发现了许多很棒的 .NET 调度引擎，特别是 Quartz.Net 看起来很有前途。但是，我需要一个调度引擎，它不仅可以让我触发日期和时间，还可以触发我能想到的任何事情。例如，除了基于日期/时间的触发器之外，我可能希望在看到进程已启动、计算机锁定、WMI 事件关闭等时触发。

我正在寻找的是一种解决方案，它允许我实现适当的接口并在满足我的条件时触发触发器*。*这样的事情已经存在还是我一个人？

这是我看过的一对：

*   [在数据库中表示“重复事件”的最佳方式是什么？](https://stackoverflow.com/questions/1579638/what-is-the-best-way-to-represent-recurring-events-in-database)
*   [c# 重复事件（比如日历）](https://stackoverflow.com/questions/9137473/c-sharp-recurring-event-like-for-a-calendar)
*   [推荐一个 C# 任务调度库](https://stackoverflow.com/questions/507247/recommend-a-c-sharp-task-scheduling-library)
*   [如何编写 C# 调度程序](https://stackoverflow.com/questions/7764812/how-to-write-c-sharp-scheduler)
*   [http://www.codeproject.com/Articles/2478/C-Scheduler](http://www.codeproject.com/Articles/2478/C-Scheduler)
*   [http://www.codeproject.com/Articles/2407/A-New-Task-Scheduler-Class-Library-for-NET](http://www.codeproject.com/Articles/2407/A-New-Task-Scheduler-Class-Library-for-NET)
*   [http://www.codeproject.com/Articles/8424/A-component-for-event-scheduling-inside-an-applica](http://www.codeproject.com/Articles/8424/A-component-for-event-scheduling-inside-an-applica)
*   [http://blog.bobcravens.com/2009/10/an-event-based-cron-scheduled-job-in-c/](http://blog.bobcravens.com/2009/10/an-event-based-cron-scheduled-job-in-c/)
*   [http://www.codeproject.com/Articles/6507/NET-Scheduled-Timer](http://www.codeproject.com/Articles/6507/NET-Scheduled-Timer)

这需要在我的 .NET 应用程序中运行。我研究了修改 Quartz.Net 以支持这种类型的触发，但日期/时间触发的概念只是根深蒂固；编写自己的调度程序可能会更容易，因为我不需要将作业和触发器保存到数据库中。

我宁愿在现有的调度系统上工作，这样我就不必担心实现队列、优先级、线程池等坚韧不拔的细节……但我当然会做我必须做的事情.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T21:50:33.257

您可以声明一个基`Task`类或接口，无论您喜欢哪个实现`bool`属性`NeedsToRun`和方法`Run()`。

然后，您可以为每个单独的任务（或使用委托函数、任务类型）继承 Task 类，并定义您需要的所有自定义要求，以检查该任务是否需要运行，如果需要，请调用该`Run()`特定任务的方法。

将所有任务添加到 a`List<Task>`并定期迭代它们以查看实际需要运行的任务，瞧；你有一个非常简单但有效的调度程序。

就个人而言，我追求的是基于优先级的调度程序，而不是你描述的事件驱动的调度程序，所以我实现了一个`Func<bool>`来确定一个任务是否需要运行并`Action`实际运行它。我的代码如下：

```
public class Task : IComparable<Task>
{
    public Task(int priority, Action action, Func<bool> needsToRun, string name = "Basic Task")
    {
        Priority = priority;
        Name = name;
        Action = action;
        _needsToRun = needsToRun;
    }

    public string Name { get; set; }

    public int Priority { get; set; }

    private readonly Func<bool> _needsToRun;

    public bool NeedsToRun { get { return _needsToRun.Invoke(); } }

    /// <summary>
    /// Gets or sets the action this task performs.
    /// </summary>
    /// <value>
    /// The action.
    /// </value>
    public Action Action { get; set; }

    public void Run()
    {
        if (Action != null)
            Action.Invoke();
    }

    #region Implementation of IComparable<in State>

    /// <summary>
    /// Compares the current object with another object of the same type.
    /// </summary>
    /// <returns>
    /// A value that indicates the relative order of the objects being compared. The return value has the following meanings: Value Meaning Less than zero This object is less than the <paramref name="other"/> parameter.Zero This object is equal to <paramref name="other"/>. Greater than zero This object is greater than <paramref name="other"/>. 
    /// </returns>
    /// <param name="other">An object to compare with this object.</param>
    public int CompareTo(Task other)
    {
        return Priority == other.Priority && Name == other.Name ? 1 : 0;
    }

    #endregion
} 
```

但我认为这可以适应订阅事件并设置一个标志，以确保`NeedsToRun`在该事件被相当容易地触发时返回 true。

# javascript - 如何找到屏幕的中心？

> ID：12325051
> 
> 赞同：0
> 
> 时间：2012-09-07T20:37:37.977
> 
> 标签：javascript, jquery

我有一个 div，即使在用户滚动页面时，我也需要**在屏幕中心（即可视区域）显示这个 div 。**

所以它的风格应该是（例如）

```
{position:fixed; top:90px; left:150 px; z-index:9999; overflow:hidden;} 
```

现在我需要找到 left 和 top 的值，以便 div 将放置在屏幕的中心（即可视区域），对于任何页面。

如何使用 javascript 或 jquery 找到 left & top 的值？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T20:39:22.260

`left:50%; top:50%;`把你放在中间，然后你应用一个固定的宽度和高度，并将 and 设置`margin-top`为`margin-left`负的一半`width`and `height`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T20:42:22.647

为了以固定位置居中，您需要知道元素的高度和宽度。

然后，您只需要将`margin-top`and`margin-left`的负一半置`width`中`height`即可。

例如，此类将居中并具有 100px`height`和 200px的元素`width`。

```
.centered {
  position: fixed;
  top: 50%;
  left: 50%;
  margin-top: -50px;
  margin-left: -100px;
} 
```

[http://css-tricks.com/quick-css-trick-how-to-center-an-object-exactly-in-the-center/](http://css-tricks.com/quick-css-trick-how-to-center-an-object-exactly-in-the-center/)

**更新：** 如果您不知道需要在页面加载之前居中的元素的高度和宽度，那么您需要使用 JavaScript 来检测大小。

这是一个如何做到这一点的工作示例 - [http://jsfiddle.net/3Ag97/1/](http://jsfiddle.net/3Ag97/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T20:44:06.870

您可以使用 flexbox 模块，尽管它尚未得到广泛支持：http: [//jsfiddle.net/b7nrS/](http://jsfiddle.net/b7nrS/)。

```
.container {
  display: flex;
  align-items: center;
  justify-content: center;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T20:48:33.710

试试这个：

```
var $box = $('#box');

var bw = $box.width() / 2;
var bh = $box.height() / 2;

var wh = $(window).height() / 2;
var ww = $(window).width() / 2;

$box.css({'left': ww-bw, "top": wh-bh}) 
```

[http://jsfiddle.net/mqMwj/](http://jsfiddle.net/mqMwj/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-07T20:49:20.423

```
function centerObject(selector) {
var x = $(window).height() - $(selector).height();
var y = $(window).width() - $(selector).width();
$(selector).css("left", y / 2).css("top", x / 2);
}; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-07T20:51:42.340

```
#divX {
    position: fixed; 
    left: 50%; 
    top: 50%; 
    width: 100px; 
    height: 100px; 
    margin-left: -50px; 
    margin-top: -50px; 
    background-color: #0000FF;
} 
```

# python - 在 Tornado 中使用 POST 请求删除数据？

> ID：12325060
> 
> 赞同：1
> 
> 时间：2012-09-07T20:38:32.370
> 
> 标签：python, tornado

在我看来，使用`POST`请求从数据库中删除 Tornado 中的数据是可行的：

```
def post(self, id):
    # delete data from db using id 
```

在客户端，我们可以发送一个发布请求，`id`其中包含要删除的内容。这是一种有效的方法吗？

我注意到`delete`Tornado 的 RequestHandler 类中也有一个方法，但是我应该如何正确使用它呢？一些例子会有所帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T20:54:45.617

除非我正在查看过时的示例，否则龙卷风似乎支持删除请求。[http://www.tornadoweb.org/documentation/web.html](http://www.tornadoweb.org/documentation/web.html)

我会`delete`像使用任何东西一样使用该方法。使用 delete 方法（可能指定 and ）设置处理程序，`id`然后如果该记录存​​在并且用户具有适当的权限，则删除该记录。我从未使用过 Tornado，但可能是这样的：

```
class WidgetHandler(RequestHandler):
    def initialize(self, database):
        self.database = database    

    def delete(self, id):
        # if user has permission to delete
        # if record exists
        # delete it

app = Application([
    (r'/widgets/([0-9]+)', WidgetHandler, dict(database=database)),
    ]) 
```

如果您在前面使用 javascript/jquery/ajax 发出请求，则 jquery ajax 支持删除：

```
// get your id somehow
// dynamically build url   
$.ajax({
    url: '/widgets/' + theIdYouGotSomehow,
    type: 'DELETE',
    success: function(result) {
        // Do something with the result
    }
}); 
```

对于您的评论，您可以使用 delete 方法点击 url。`/widgets/12`

从 jquery 文档中他们说

> 但并非所有浏览器都支持它们 [delete, put, etc]。

[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

一些 stackoverflow 帖子建议所有现代浏览器都支持删除方法。

# windows - 使用 FD_SET 并选择串口

> ID：12325065
> 
> 赞同：2
> 
> 时间：2012-09-07T20:39:05.383
> 
> 标签：windows, sockets, serial-port

我是串行端口编程和套接字的新手，所以请温柔:)

我在 Windows 7 上使用 Visual Studio 2010。我正在尝试从串行端口接收数据包（插入了一个与远程设备连接的 USB Digi XStick）。我首先使用 WriteFile 发送初始数据包，此操作成功完成。当我调用 select 时，我得到错误 10038“尝试对不是套接字的东西进行操作”。

以下是相关代码：

```
char szCodedPort[20];
sprintf(szCodedPort, "\\\\.\\COM%d",3); //manually set for testing purposes
HANDLE fileHandle =  CreateFileA(szCodedPort, 
    GENERIC_READ | GENERIC_WRITE, 
    FILE_SHARE_READ | FILE_SHARE_WRITE, 
    NULL, 
    OPEN_EXISTING,
    FILE_ATTRIBUTE_NORMAL, NULL);

fd_set readfds;
int fd;
fd = _open_osfhandle((long)fileHandle, O_RDONLY);
FD_ZERO(&readfds);
FD_SET(fd, &readfds);       

WSAData WSA_Data;
WSAStartup(MAKEWORD(2,2),&WSA_Data);    

res = select(fd,&readfds,NULL,NULL, &waitlen);

WSACleanup(); 
```

我认为我的问题出在 fd 上，但我不确定如何解决。我可以使用什么传递给代表串行端口的 FD_SET，以便 select 在使用 readfds 时停止生成错误消息？或者我什至没有使用这个正确的邮政编码？

# jquery - 在不同的输入中按 Enter 键时触发按钮单击事件（无表单）

> ID：12325066
> 
> 赞同：116
> 
> 时间：2012-09-07T20:39:07.710
> 
> 标签：jquery, internet-explorer

在“金额”输入中按“Enter”时会触发此逻辑，我认为它不应该（它不在 Chrome 中）。我怎样才能防止这种情况发生，如果在 IE 中没有防止这种情况发生，请处理它以使 click 事件中的逻辑不会触发。

```
<html>
 <body>
   <div id="page">
     <div id="financed_amount">
      <h1>Financed Amount:</h1>
      <input type="text" id="amount" value="" />
     </div>
     <h1>Finance Options</h1>
     <div>
      <a id="shareLink" rel="leanModal" name="email" href="#email"></a>
      <button id="btnShare" class="share">Share this report</button>
     </div>
    </div>
   </body>
</html> 
```

**脚本**

```
$("#btnShare").click(function (e) {
    // This logic is firing when pressing "Enter" in the "Amount" input
}); 
```

*   jQuery：1.7.2
*   即 9
*   （在 Chrome 中工作）

* * *

## 回答 #1

> 赞同：338
> 
> 时间：2012-11-23T19:10:07.550

我遇到了同样的问题并通过向元素添加`type="button"`属性来解决它`<button>`，IE 认为按钮是一个简单的按钮而不是提交按钮（这是`<button>`元素的默认行为）。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2012-10-31T20:01:12.403

我今天遇到了这个问题。IE 假设如果您在任何文本字段中按下回车键，您想要提交表单——即使这些字段不是表单的一部分并且即使按钮不是“提交”类型。

您必须使用 preventDefault() 覆盖 IE 的默认行为。在您的 jQuery 选择器中，放入包含要忽略回车键的文本框的 div ——在您的情况下，是“页面”div。除了选择整个 div，您还可以指定要专门忽略的文本框。

```
$('#page').keypress(function(e) {
    if(e.which == 13) { // Checks for the enter key
        e.preventDefault(); // Stops IE from triggering the button to be clicked
    }
}); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-07-06T01:19:52.843

我在使用 ASP.NET WebForms 时遇到了这个问题：

```
<asp:Button /> 
```

这不能仅通过添加 type="button" 来解决，因为 ASP.NET 将其替换为 type="submit"（如果您检查元素，您可以在浏览器中看到此行为。）

在 asp.net 中执行此操作的正确方法是添加

```
<asp:Button UseSubmitBehavior="false" /> 
```

到按钮。ASP 将自动添加 type="button" 属性。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-07T20:55:34.107

IE 认为任何`button`元素都是一个**提交**按钮（不管你有`form`没有）。它还将`Enter`表单元素中的键按下处理为隐式表单提交。因此，由于它认为您正在尝试提交表单，它认为它会帮助您并`click`在（它认为的）**提交**按钮上触发事件。

您可以将`keyup`事件附加到`input`或`button`并检查`Enter`键 ( `e.which === 13`) 和`return false;`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-04-29T23:29:09.373

为每个按钮执行此操作的基于 jQuery 的解决方案是：

```
 $('button').prop('type', 'button'); // To prevent IE from treating every button as a submit and firing a click() event 
```

然而，由于某种原因，点击事件仍会冒泡到父元素......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-05-27T07:27:28.980

对于 Chrome，您可以添加`<button type="submit" style="display:none"/>` 因为在 chrome 中默认按钮类型是“提交”

对于 IE ，我尝试与`type="button"`（在 IE 中默认按钮类型为“按钮”）相同，但效果不佳。

所以这是解决方案。在 HTML`(keypress)=xxx($event)`中添加表单。在 TS 中，

```
xxx(event) {
 if(event.key === 'Enter' && event.target.type !== 'submit')
event.preventDefault():
} 
```

以上将适用于跨浏览器、正常点击和标签流等所有场景。

# c# - Newtonsoft JSON Collection of Interfaces 序列化错误

> ID：12325067
> 
> 赞同：1
> 
> 时间：2012-09-07T20:39:10.027
> 
> 标签：c#, json, serialization, interface, json.net

我正在使用 C# .NET 4.0，Newtonsoft JSON 4.5.0。

```
public class Recipe
{
   [JsonProperty(TypeNameHandling = TypeNameHandling.All)]
   public List<IFood> Foods{ get; set; }
   ...
 } 
```

我想序列化和反序列化这个 Recipe 对象。如果我在应用程序生命周期内序列化和反序列化对象，则成功，但如果我序列化对象，退出应用程序然后反序列化它，则会引发异常，它无法实例化 IFood（因为它是一个接口）。

**问题是它没有序列化接口的实现。**

*"$type": "System.Collections.Generic.List`1[[NSM.Shared.Models.IFood, NSMShared]], mscorlib"*

我尝试使用 TypeNameHandling.Object 和 Array 和 Auto，但没有帮助。有没有办法正确序列化它？或者至少在反序列化之前定义类映射？

**编辑：** 我使用 JSON 和 Hammock ( [http://code.google.com/p/relax-net/](http://code.google.com/p/relax-net/) )，CouchDB 的 C# 驱动程序，它在内部序列化和反序列化对象。如前所述，问题在于它没有序列化接口实现。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-08T08:01:02.653

这是关键，您必须添加此属性，因为它定义了如何处理集合中的项目。

**[JsonProperty(ItemTypeNameHandling = TypeNameHandling.Auto)]**

```
public class Recipe
{
    [JsonProperty(ItemTypeNameHandling = TypeNameHandling.Auto)]
    public List<IFood> Foods{ get; set; }
    ...
} 
```

# asp.net-mvc - AddModelError 消息未显示

> ID：12325070
> 
> 赞同：1
> 
> 时间：2012-09-07T20:39:21.320
> 
> 标签：asp.net-mvc, exception-handling

我有一个编辑页面，当用户通过输入相同的名称提交页面时，会引发异常并被捕获。但它没有重定向到编辑页面以显示模型错误，而是显示带有异常详细信息的 asp.net 黄色错误页面。我在控制器的 OnException 中仍然没有任何代码，我在我的开发机器上看到了这个。

```
try
{
 //code
}
catch (Exception ex)
{                
   ModelState.AddModelError(string.Empty, "Customer with same name already exists.");
}

return RedirectToAction("Edit", new {id=model.id}); <--not executing 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T21:11:46.433

如果您在 AddModelError 中将“String.Empty”作为键传递..那么在您看来，您应该有..

错误消息出现在

```
<%: Html.ValidationSummary() %> 
```

或者如果您想将“名称”指定为键，则

```
ModelState.AddModelError(Name, "Customer with same name already exists.");  

<%=Html.TextBox("Name") %> <br /> 
<%=Html.ValidationMessage("Name") %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T20:51:27.217

如果您想在视图中显示您在操作方法中添加的验证错误消息，您需要将模型返回到视图。当您的保存成功完成时，您将执行重定向到 GET 操作。

```
[HttpPost]
public ActionResult CreateUser(UserViewModel model)
{
  try
  {
     //Save and Redirect to GET action (PRG pattern)
     //Assuming model.ID will have the Id of record.

    return RedirectToAction("View",new {id=model.ID });
  }
  catch(Exception ex)
  {
    //Log error 
    ModelState.AddModelError("","Some error message");
  }
  return View(model);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T22:29:10.523

雅虎！！我弄清楚了问题所在。实际上我正在执行 trans.commit ，当它失败时，我没有在 catch 块中进行回滚。感谢你的帮助。

# visual-studio-2010 - VS2010 - 使用 在设置项目之间共享属性？

> ID：12325072
> 
> 赞同：2
> 
> 时间：2012-09-07T20:39:28.660
> 
> 标签：visual-studio-2010, visual-studio, msbuild, wix

为什么它对这个文件不起作用`<Import />`，当我用复制粘贴三个属性替换语句时它起作用？

**../../Setup.Version.proj**

```
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    <PropertyGroup>
        <InstallerMajorVersion>7</InstallerMajorVersion>
        <InstallerMinorVersion>7</InstallerMinorVersion>
        <InstallerBuildNumber>7</InstallerBuildNumber>
    </PropertyGroup>
</Project> 
```

**作品：**

```
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    <PropertyGroup>
        <InstallerMajorVersion>7</InstallerMajorVersion>
        <InstallerMinorVersion>7</InstallerMinorVersion>
        <InstallerBuildNumber>7</InstallerBuildNumber>
        <OutputName>asdf-$(InstallerMajorVersion).$(InstallerMinorVersion).$(InstallerBuildNumber)</OutputName>
        <OutputType>Package</OutputType> 
```

**不起作用：**

```
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    <Import Project="../../Setup.Version.proj" />
    <PropertyGroup>
        <OutputName>asdf-$(InstallerMajorVersion).$(InstallerMinorVersion).$(InstallerBuildNumber)</OutputName>
        <OutputType>Package</OutputType> 
```

这里的变量只是评估为空字符串... :( 我确定导入项目的路径是正确的。

* * *

## **因此，当我从命令行运行 msbuild 时它似乎工作正常，但当我在 Visual Studio 中构建项目时却不行。为什么在世界上？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T09:36:47.007

I've tried to reproduce and everything works:

**importme.proj**

```
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    <PropertyGroup>
        <InstallerMajorVersion>7</InstallerMajorVersion>
        <InstallerMinorVersion>7</InstallerMinorVersion>
        <InstallerBuildNumber>7</InstallerBuildNumber>
    </PropertyGroup>
</Project> 
```

**main.proj**

```
<Project ToolsVersion="4.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    <Import Project="importme.proj" />
    <PropertyGroup>
        <OutputName>asdf-$(InstallerMajorVersion).$(InstallerMinorVersion).$(InstallerBuildNumber)</OutputName>
        <OutputType>Package</OutputType>
    </PropertyGroup>
    <Target Name="Build">
        <Message Text="$(OutputName)"/>
    </Target>
</Project> 
```

**OUTPUT**

```
Microsoft (R) Build Engine version 4.0.30319.17626
[Microsoft .NET Framework, version 4.0.30319.17626]
Copyright (C) Microsoft Corporation. All rights reserved.

Build started 10.09.2012 12:35:12.
Project "d:\temp\SO\main.proj" on node 1 (default targets).
Build:
  asdf-7.7.7
Done Building Project "d:\temp\SO\main.proj" (default targets).

Build succeeded.
    0 Warning(s)
    0 Error(s)

Time Elapsed 00:00:00.55 
```

**Run using**

```
msbuild main.proj 
```

**UPDATE**: You need to reload project for Include'd files to be updated or use [workaround](https://stackoverflow.com/questions/4919204/how-to-turn-off-caching-of-build-definitions-in-visual-studio/6217800).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T07:08:56.393

The reason it didn't work is that Visual Studio had cached the included file, so that any changes I made to it didn't take effect until I reloaded the solution or restarted Visual Studio. This seems to be a limitation of VS 2010\. After reloading VS 2010, everything worked as expected.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-08T01:07:08.460

[Import](http://msdn.microsoft.com/en-us/library/92x05xfs.aspx)元素仅在该元素下有效`Project`。但是，代码似乎想要将值导入到`<ProjectGroup>`元素中。尝试在 Setup.Version.proj 中将值声明为变量并在主 MSBuild 文件中引用它们，例如：

```
<Project ToolsVersion="4.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    <Import Project="../../Setup.Version.proj" /> <!-- Variables declared in here -->
    <PropertyGroup>
        <InstallerMajorVersion>$(MyInstallerMajorVersion)</InstallerMajorVersion>
        <InstallerMinorVersion>$(MyInstallerMinorVersion)</InstallerMinorVersion>
        <InstallerBuildNumber>$(MyInstallerBuildNumber)</InstallerBuildNumber>
        <OutputName>asdf-$(InstallerMajorVersion).$(InstallerMinorVersion).$(InstallerBuildNumber)</OutputName>
        <OutputType>Package</OutputType> 
```

# php - $_SERVER[] 不会在 localhost 上的浏览 器中返回当前 url

> ID：12325073
> 
> 赞同：0
> 
> 时间：2012-09-07T20:39:46.140
> 
> 标签：php

以下返回空数组，因此在我的本地主机 $_SERVER[] 上不返回任何内容。为什么？

浏览器中的 URL 如下所示：localhost/final/events/2012-10/

```
$current_url_all = parse_url($_SERVER['PATH_INFO']);
print_r($current_url_all); 
```

我究竟做错了什么？我还能如何从 url 中获取最后一个日期片段？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T20:44:07.163

您可能想使用

```
$_SERVER['REQUEST_URI'] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T20:44:16.767

尝试使用`$_SERVER["REQUEST_URI"]`instad，`$_SERVER['PATH_INFO']`如果您像目录一样调用脚本似乎只是可行的：

```
http://example.org/script.php/foo 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T20:44:12.710

你可以操纵字符串。使用 strpos 获取 localhost/final/events/ 的位置，然后使用 substring 获取其余部分。

你也可以使用`$end = end((explode('/', $url)));`

然后从数组中获取最后一个值

# entity-framework - Entity Framework 如何将 EntityTransaction 转换为提供者特定的事务？

> ID：12325077
> 
> 赞同：0
> 
> 时间：2012-09-07T20:40:02.357
> 
> 标签：entity-framework, entity-framework-4, entity-framework-4.1

我有一个 Entity Framework 4 数据模式。我正在使用存储过程将数据加载到数据库中，因为 EF 太慢了。我们使用实体模型来调用存储过程。一切都必须在一次交易中。

为了加快进程，我需要执行一些批量复制操作。为此，我正在使用 SQL Anywhere 及其 ADO.NET 提供程序软件。

当我打电话时`context.Connection.BeginTransactin()`，我得到了`EntityTransaction`回复。实际上，我的变量是 a `DbTransaction`，它是所有交易的基类。但实际返回的对象是一个`EntityTransaction`.

我无法将 an`EntityTransaction`转换为提供者特定的事务类（`SAConnection`在这种情况下）。如果我这样做，我会得到一个演员表异常。然而，不知何故，当实体上下文调用存储过程时，它会将它创建的提供者特定的命令对象加入到由该`EntityTransaction`对象表示的事务中。

提供商如何做到这一点？它是我可以用来为我的批量复制操作获取特定于提供程序的事务对象的机制吗？

托尼

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T21:05:43.007

我查看了`EntityTransaction`该类，实际上`StoreTransaction`存在一个名为的内部属性。如果在这个 SO 讨论中找到一些源代码：[这个 SqlTransaction 已经完成；它不再可用。Entity Framework Code First](https://stackoverflow.com/questions/9843449/this-sqltransaction-has-completed-it-is-no-longer-usable-entity-framework-code)这可能会帮助你。

请记住，这在部分信任环境中不起作用，它不允许您使用反射访问成员。

# c++ - QGraphicscene 奇怪的行为（不要用负数更新屏幕）

> ID：12325080
> 
> 赞同：0
> 
> 时间：2012-09-07T20:40:13.427
> 
> 标签：c++, qt, qgraphicsview

我有一个不会用负数更新屏幕的 QGraphicscene。图片解释了所有内容。

[http://s16.postimage.org/4b59m8hx1/problem.jpg](http://s16.postimage.org/4b59m8hx1/problem.jpg)

这就是简单的代码。

```
if (dinA){ //assume its always true
      int sx=dinA->getX();
      int sy=dinA->getY();
      dis->scene.addRect(QRectF(300,100-sy, sx, sy),QPen(), QBrush(Qt::FDiagPattern));
 }

 //** 300,100-sy ** because of my work-area is 600*300 
```

可能是什么原因？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T21:13:56.800

如果我正确解释了您的屏幕截图及其下方的文本，则您使用的是负数作为高度。但是，这会创建一个无效的`QRectF`. 引用 Qt 文档：

```
bool QRectF::isValid() const
[...]
A valid rectangle has a width() > 0 and height() > 0. 
```

在您的代码中，您应该确保大小和宽度为正数。否则，您必须交换角点的 x 和/或 y 坐标。

希望有帮助！

# nested - BeautifulSoup 嵌套/嵌入具有不同类的相同标签

> ID：12325084
> 
> 赞同：0
> 
> 时间：2012-09-07T20:40:38.073
> 
> 标签：nested, beautifulsoup

我正在尝试解析一些经常有这样的片段的 html 文件：

```
<p class="p5"><p class="s2">In the directory </p>/home/blah/<p class="s2"> there is a file, </p>plotData.dat</p> 
```

它被解析为：

```
>>> [c for c in P.body.children]
[<p class="p5"></p>,
 <p class="s2">In the directory </p>,
 u'/home/blah/',
 <p class="s2"> there is a file, </p>,
u'plotData.dat'] 
```

我希望它会像

```
>>> [c for c in P.body.children]
[<p class="p5"></p>,
 <p class="s2">In the directory </p>,
 <p class="p5">u'/home/blah/'</p>,
 <p class="s2"> there is a file, </p>,
 <p class="p5">u'plotData.dat'</a>] 
```

那么输入的html格式是否错误？我可以做些什么来使输入的html解析为后者？（我无法控制 html 的外观）

编辑：完成 MWE：

```
>>> from bs4 import BeautifulSoup as BS
>>> P = BS('<p class="p5"><p class="s2">In the directory </p>/home/blah/<p class="s2"> there is a file, </p>plotData.dat</p>')
>>> [c for c in P.body.children]
[<p class="p5"></p>, <p class="s2">In the directory </p>, u'/home/blah/', <p class="s2"> there is a file, </p>, u'plotData.dat'] 
```

# php - div中的表单放置

> ID：12325085
> 
> 赞同：-2
> 
> 时间：2012-09-07T20:40:39.837
> 
> 标签：php, html, forms, validation, verify

我试图创建一个几乎涵盖我页面所有内容的表单。由于输入字段是分散的，因此它会验证但之后仍会进入下一页。我不知道问题是什么；当我离线尝试它时，它在 HTML 和 PHP 格式中运行良好。当我将它上传到服务器时会出现问题。

剧本：

```
<form method="post" action="step.php" id="form1">
<div id="content">
<center>
<br><br><br>
      <input  id="sig" name="sig" type="text" class="validate[sign] text-input" style="margin-left:-180px;visibility:hidden;height:0px;"/>

    <div id="signatureparent">
    <div id="signature"></div>
    </div>
</div>

</center>

<!====================================================================================>

<div id="content">
<div id="wrapper">
<div id="form-div">
<center><strong>Please enter the information for the person who will be the primary contact for our account set up team. If left blank we will use the information in the billing section.</strong></center>
<div id="wrapper3">
<div id="form-div">

<center>
<table cellpadding='0' cellspacing='27'>
<tr>
<td>
<!====================================================================================>
<div style="display:none">
<label for="name"><strong>First Name<font color=red size=3> *</font></strong></label>
      <p class="name">
         <input name="name" readonly="readonly" type="text" class="validate[custom[name]] text-input" id="Name" value="<?php echo $_POST["name"]; ?>" />

      </p>
<label for="last" style="margin-left:45px;"><strong>Last Name<font color=red size=3> *</font></strong></label>
      <p class="last">
         <input name="last" style="margin-left:45px;" readonly="readonly" type="text" class="validate[custom[last]] text-input" id="last" value="<?php echo $_POST["last"]; ?>" />

      </p>
</div>

<!====================================================================================>
<label for="cname"><strong>First Name<font color=red size=3> *</font></strong></label>
      <p class="cname">
         <input name="cname" type="text" class="validate[custom[cname]] text-input" id="cname" value="" />
        </p>

<label for="cemail"><strong>E-mail<font color=red size=3> *</font></strong></label>
      <p class="cemail">
        <input name="cemail" type="text" class="validate[custom[cemail]] text-input" id="cemail" value=""  />

      </p>

<!====================================================================================>
</td><td>

<label for="clast" style="margin-left:45px;"><strong>Last Name<font color=red size=3> *</font></strong></label>
      <p class="clast">
         <input name="clast" style="margin-left:45px;"  type="text" class="validate[custom[clast]] text-input" id="clast" value="" />

      </p>

<label for="cphone" style="margin-left:45px;"><strong>Phone<font color=red size=3> *</font></strong></label>
      <p class="cphone">
        <input type="text" class="validate[custom[mob]] text-input" name="cphone" id="cphone"  style="margin-left:45px;width:100px" /> 

 <b>ext</b><input style="width:25px; margin-left:5px;" type="text" class="validate[custom[ext]] text-input" name="cext1" id="cext1" />
        </p>

</td><td>

<!====================================================================================>   
<label for="ccom" style="margin-left:45px;"><strong>Company<font color=red size=3> *</font></strong></label>
      <p class="com">
        <input type="text" class="validate[custom[ccom]] text-input"name="ccom" id="ccom" onblur="this.value = this.value.toTitleCase();" style="margin-left:45px;" />
      </p>

<label for="cmob" style="margin-left:45px;"><strong>Mobile#</strong></label>
      <p class="mob">
        <input type="text" class="validate[custom[mob]] text-input" name="cmob" id="cmob" style="margin-left:45px;width:100px;" /> 

<b>ext</b><input style="width:25px; margin-left:5px;" type="text" class="validate[custom[ext]] text-input" name="cext2" id="cext2" />
        </p>

</div></div></div></div></div>
</center>
</td></tr></table>

<div>

<!====================================================================================>
<br>
<div id="wrapper">
<div id="form-div">

<table><tr><td><div style="margin-left:210px;" >
<p><font color=red size=2%><b>Clicking this button means that you accept the terms and conditions of our service  </b></font></td><td>
<div id="accept"><button style="margin-left:10px;border: 0; background: transparent" type="submit"><img src=img/acept.png height=30 /></button>
 </div>
</tr></td></table>
</div>
</div>  
<br><br><br>

</form> 
```

它应该首先验证内容，然后继续。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T21:54:42.723

您的表单似乎在提交时没有运行任何代码。您希望您的表单具有：

```
<form method="post" action="step.php" id="form1" onsubmit="return validate()"> 
```

这是假设您的验证代码是一个 JavaScript 函数。

# c - 使用自定义数据类型

> ID：12325088
> 
> 赞同：0
> 
> 时间：2012-09-07T20:40:47.967
> 
> 标签：c, types

FreeType 库定义了相当多的[基本数据类型](http://www.freetype.org/freetype2/docs/reference/ft2-basic_types.html)，但我不太清楚如何使用它们。我正在尝试使用[FT_Get_Glyph_Name](http://freetype.sourceforge.net/freetype2/docs/reference/ft2-base_interface.html#FT_Get_Glyph_Name)方法，该方法采用以下形式：

```
FT_Get_Glyph_Name(FT_Face face, FT_UInt glyph_index, FT_Pointer buffer, FT_UInt buffer_max ); 
```

所以我有这个代码：

```
FT_Face = face;
FT_Pointer = name;
FT_Get_Glyph_Name(face, 0, name, 45); 
```

这很好用，但我不确定如何实际获取名称的字符串表示形式（`printf`例如与一起使用）。我如何从`FT_Pointer`一个字符串？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T20:55:10.013

从文档链接：

> 如果字形名称太长，则将其截断以适合缓冲区。返回的字符串始终以零结尾。

`FT_Pointer`是 void* 上的 typedef。

一个简单的演员就足够了：

```
char name[100];
FT_Get_Glyph_Name(face, 0, (FT_Pointer) name, 100);
printf("Name : '%s'\n", name); 
```

您还可以使用 FT_Pointer 类型变量并将它们转换为 (char *)。

# javascript - Javascript/CSS 调整 div 同步

> ID：12325094
> 
> 赞同：0
> 
> 时间：2012-09-07T20:41:40.667
> 
> 标签：javascript, css, css-transitions

我在一个网站中有一些代码可以重新调整网页中一些水平对齐的 div 的大小，但是它们都同时重新调整大小，使得 div 被移位并且网页看起来很丑。如何让 javascript 代码等到它完成缩小 div 后再扩展另一个 div？

CSS：

```
#leftpanel,#middlepanel,#rightpanel
{
过渡：宽度2s；
-moz-transition：宽度 2s；/* 火狐4 */
-webkit-transition：宽度 2s；/* Safari 和 Chrome */
-o-transition: 宽度 2s; /* 歌剧 */
}

```

Javascript：

```
函数调整大小按钮（div）
{
    if (div == 'leftpanel'){
        #此代码缩小其他div，它应该首先运行，没有任何其他div被放大
        document.getElementById('middlepanel').style.width = '20%';
        document.getElementById('rightpanel').style.width = '20%';
    }
    if (div == '中间面板'){
        document.getElementById('leftpanel').style.width = '20%';
        document.getElementById('rightpanel').style.width = '20%';
    }
    if (div == 'rightpanel'){
        document.getElementById('leftpanel').style.width = '20%';
        document.getElementById('middlepanel').style.width = '20%';
    }

    #此代码应在其他 div 缩小后第二次运行，现在它在其他 div 缩小的同时放大
    document.getElementById(div).style.width = '50%';
}

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T20:48:49.640

听起来可能回调函数会起作用？

就像是：

```
function resizebutton(div)
{
    if (div == 'leftpanel'){
        #this code shrinks the other divs, it should run first, without any other divs being enlarged
        document.getElementById('middlepanel').style.width = '20%';
        document.getElementById('rightpanel').style.width = '20%';
    }
    if (div == 'middlepanel'){
        document.getElementById('leftpanel').style.width = '20%';
        document.getElementById('rightpanel').style.width = '20%';
    }
    if (div == 'rightpanel'){
        document.getElementById('leftpanel').style.width = '20%';
        document.getElementById('middlepanel').style.width = '20%';
    }

}

function resizeMeFirst(div, callback) {
    document.getElementById(div).style.width = '50%';
    //ok, now that that is done, run the callback function.
    callback(div)    
}

resizeMeFirst(div, resizebutton); 
```

# visual-studio-2010 - 臭名昭著的 Visual Studio 错误 C1902，VS 配置

> ID：12325096
> 
> 赞同：12
> 
> 时间：2012-09-07T20:41:47.617
> 
> 标签：visual-studio-2010

我在 Visual Studio 2010 中的 VC++ 构建中收到臭名昭著的“错误 C1902：程序数据库管理器不匹配；请检查您的安装”。我的 VS 甚至不会构建 hello world，即使文件夹中不存在 pdb 文件。

我尝试过的步骤：

*   清理和重建（包括 hello world 在内的 3 个不同项目，大约 15 次）

*   从计算机中删除 2010 版之前的每个 Visual Studio 实例，包括所有可再发行组件。除了我的 2010 目录中的最新版本 (100) 之外，我的计算机上没有任何 mspdb*.dll 的副本。

*   重新安装2010。我完全重新安装了VS 2010。没有效果。

*   重新启动我的电脑。我花了一个下午删除任何可能与此错误远程相关的所有内容并一遍又一遍地重新启动。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-09-10T15:49:34.533

我通过在几年前在另一个论坛上创建的类似帖子中找到一个不起眼的帖子来解决这个问题。这是解决方案：

将文件 mspdbsrv.exe 从 VisualStudio/Common7/IDE 目录复制到 /VC/bin 目录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-20T14:54:35.987

`cyglas-config`解决了我的构建系统上的问题。似乎 Vs2010+ 需要这个，但 vs2008 不需要。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-05-26T21:50:21.857

我已经看到这是由共享中间目录的两个项目引起的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-27T20:28:02.397

让你的 VS2010 在管理员下运行并拥有正确的权限。

我们的 IT 部署了一个工具来阻止对多个“端口”的访问，结果发现我所有的 VC 项目都无法在 VS2010 中构建。然后，他重新部署了该工具，并选中了“允许提升的程序访问被阻止的‘端口’”，一切都恢复了正常。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-07T16:02:34.063

如果在自动化下运行未锁定，请验证本地用户帐户。事实证明，这解决了我看到的“致命错误 C1902：程序数据库管理器不匹配；请检查您的安装”消息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-03-28T10:28:56.767

我遇到了同样的错误，问题是“mspdbcore.dll”文件已从我的 \Microsoft Visual Studio 12.0\Common7\IDE\ 文件夹中删除。[这篇](https://msdn.microsoft.com/en-us/library/8y7hea02.aspx)文章帮助我解决了我的问题。

PS：删除是由“重复文件清理器”实用程序进行的。

# ruby-on-rails-3 - Rails 3：在 Flash 消息中显示错误完整消息

> ID：12325107
> 
> 赞同：0
> 
> 时间：2012-09-07T20:42:44.107
> 
> 标签：ruby-on-rails-3, error-handling, custom-validators

这是我的信用卡模型：

```
validate :name_is_split_properly
  private
    def name_is_split_properly
      if last_name.blank?
        self.errors[:base] << "Last Name is required"
      end
    end 
```

当用户提交 CreditCard 时，会进行验证，这就是我在 Flash 消息中设置错误的方式：

```
flash[:error] = current_order.errors.full_messages.join('\n')
redirect_to new_order_path(:client_id => params[:client_id]) 
```

但是由于某种原因，当`flash[error]`在视图中显示时，它是这样显示的：`Credit card base Last Name is required`......我如何摆脱钥匙？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T20:51:20.797

尝试`errors.add(:base, "Last Name is required")`

# html - SASS 样式在保存 scss 文件时适用，但在浏览器刷新时不适用

> ID：12325108
> 
> 赞同：0
> 
> 时间：2012-09-07T20:42:47.487
> 
> 标签：html, css, media-queries, sass

我在文档的头部使用了主要的媒体断点：

```
<!-- Base = Normalize for basic and small screens -->
<link rel="stylesheet" href="css/base.css">
<!-- Enhanced = Styles for devices that understand media queries -->
<link rel="stylesheet" href="css/enhanced.css" media=”screen, handheld” />
<!-- Medium = Devices larger then generlized phone size -->
<link rel="stylesheet" href="css/medium.css" media=”only screen and (min-width:37em)”/>
<!-- Large = Larger tablets and desktops -->
<link rel="stylesheet" href="css/large.css" media=”only screen and (min-width:45em)”/>
<!-- Extralarge = Large displays and tv -->
<link rel="stylesheet" href="css/extralarge.css" media=”only screen and (min-width:60em)”/> 
```

四个样式表由几个 _partials 组成。当我保存在其中一个 scss 文件中时，codekit 运行并且 Chrome 刷新并且一切都呈现得很好。但是，当我刷新浏览器时，所有样式都没有应用。css 文件存在，但没有应用任何内容。当我在该文件中有一个带有媒体查询的 screen.scss 文件时，一切正常，但现在它们被拆分了，什么都不适用。我在这里想念什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T20:58:55.890

我在您的 HTML 中看到花哨的花式引号。修复它们应该会导致您的媒体查询被识别：

```
<!-- Base = Normalize for basic and small screens -->
<link rel="stylesheet" href="css/base.css">
<!-- Enhanced = Styles for devices that understand media queries -->
<link rel="stylesheet" href="css/enhanced.css" media="screen, handheld" />
<!-- Medium = Devices larger then generlized phone size -->
<link rel="stylesheet" href="css/medium.css" media="only screen and (min-width:37em)"/>
<!-- Large = Larger tablets and desktops -->
<link rel="stylesheet" href="css/large.css" media="only screen and (min-width:45em)"/>
<!-- Extralarge = Large displays and tv -->
<link rel="stylesheet" href="css/extralarge.css" media="only screen and (min-width:60em)"/> 
```

# php - centos无法安装php-devel

> ID：12325109
> 
> 赞同：17
> 
> 时间：2012-09-07T20:42:51.977
> 
> 标签：php, installation, centos, package, yum

我需要安装 php-devel 的帮助（我需要它，因为它有 phpize，这是安装 eAccelerator 所必需的）。但是当我尝试使用`yum install php-devel`它安装 php-devel 时，会出现以下错误：

```
# yum install php-devel
Loaded plugins: fastestmirror, priorities
Loading mirror speeds from cached hostfile
 * base: centos.itt-consulting.com
 * epel: mirror.yandex.ru
 * extras: centos.itt-consulting.com
 * passenger: mirror.hmdc.harvard.edu
 * updates: centos.itt-consulting.com
Setting up Install Process
Resolving Dependencies
--> Running transaction check
---> Package php-devel.x86_64 0:5.3.3-14.el6_3 will be installed
--> Processing Dependency: php = 5.3.3-14.el6_3 for package: php-devel-5.3.3-14.el6_3.x86_64
--> Finished Dependency Resolution
Error: Package: php-devel-5.3.3-14.el6_3.x86_64 (updates)
           Requires: php = 5.3.3-14.el6_3
           Installed: php-5.4.6-1.el6.remi.x86_64 (@remi-test)
               php = 5.4.6-1.el6.remi
           Available: php-5.3.3-3.el6_2.8.x86_64 (base)
               php = 5.3.3-3.el6_2.8
           Available: php-5.3.3-14.el6_3.x86_64 (updates)
               php = 5.3.3-14.el6_3
You could try using --skip-broken to work around the problem
You could try running: rpm -Va --nofiles --nodigest 
```

我不知道如何处理这些错误。而且我安装了 php 5.3.3（phpinfo() 这么说），所以不明白为什么在这个列表中我可以看到`Installed: php-5.4...`

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2014-02-21T13:28:20.483

而不是运行`yum install php-devel`，您需要运行`yum --enablerepo=remi,remi-php54 install php-devel`.

简而言之，只需从 remi repo 中指定您想要的 php-devel 版本。在您的情况下，您从 remi 安装了 php54，因此您需要添加 "remi-php54" 。那将在没有停机的情况下成功安装 php-devel。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2013-08-29T22:02:29.973

我所做的是：

```
yum search php53 
```

它显示了要安装的 php-devel 文件。一旦我进行了搜索并找到了正确的开发包，我只需在 yum install 之后复制并粘贴整个名称。我执行了

```
yum install php53-devel.x86_64 
```

为拿到它，为实现它

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-03-18T13:17:04.893

如果你有 php 5.5.x, centos 6.5 64 试试这个

```
yum install php55w-devel 
```

您还需要 gcc

```
yum install gcc.x86_64 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-07T20:47:43.133

`php`是从 Remi 的存储库安装的。您将需要降级到股票`php`，或者`php-devel`从同一个地方获得。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-07T22:38:34.653

考虑到我从不同的 repo 安装了不同的东西，唯一的方法是删除从 Remi 的 repo 安装的所有包并使用 yum 安装标准包。

1）列出从一些奇怪的仓库（在我的情况下为@remi）安装的所有包，例如`yum list installed | grep remi`。

2）从系统中完全删除所有包`yum remove <package_name>`

注意：httpd 重新启动后 - 所有站点都会死掉！

3）快速安装所有你需要的东西，例如`yum install php-mysql php-gd php-imap php-ldap php-mbstring php-odbc php-pear php-xml php-xmlrpc`等。

4）重启httpd并启动mysql服务器。

5) 你的网站又活了。

我做这一切的唯一原因是我想为 php 安装 eAccelerator 以加快速度（由于 remi 的 repo 包，它的安装是不可能的），我很高兴我做到了！所有脚本的运行速度都快了 2 到 10 倍（我什至无法想象我的网站响应速度如此之快）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-21T09:43:07.137

```
sudo yum --enablerepo=remi install php-devel 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-07-28T15:43:50.433

关于最初的问题（安装 eAccelerator）。

这个项目已经死了，并且从来没有使用过 PHP >= 5.4。

所以如果你需要一个操作码缓存，请选择一个维护好的。我会推荐“opcache”，由 PHP 项目维护的官方缓存，从 5.5 开始包含在 php-src 中，并且在 pecl 5.4 中可用。

如果您使用“remi”存储库，在尝试构建扩展之前，请先检查它是否在存储库中可用，因为大多数 PECL 扩展都以 RPM 的形式提供，请参阅[http://blog.remirepo.net/pages/ PECL-扩展-RPM-状态](http://blog.remirepo.net/pages/PECL-extensions-RPM-status)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-07-28T15:19:06.187

```
yum --enablerepo=remi,remi-php55 install php55-devel 
```

为我工作

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2022-02-25T10:57:18.397

只需输入：

sudo nano /etc/yum.conf 然后去掉 php*

然后输入：

yum install --enablerepo remi php-pear php-devel

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-03-20T05:11:17.213

对于 PHP 7.2 和类似版本，以下对我有用（注意**remi-php72**）

```
sudo yum --enablerepo=remi,remi-php72 install php-devel 
```

### 如果这是关于为 centos 安装 xdebug 要求，那么：

```
sudo yum --enablerepo=remi,remi-php72 install php-devel autoconf automake 
```

# javascript - jQuery 滑块淡入淡出

> ID：12325112
> 
> 赞同：0
> 
> 时间：2012-09-07T20:42:57.647
> 
> 标签：javascript, jquery, slider

我正在寻找一个不错的 jQuery 滑块。我希望在过渡阶段，图像消失，隐藏，然后在下一张图像中消失。像这样：http: [//i47.tinypic.com/6gygko.gif](http://i47.tinypic.com/6gygko.gif)

现在我正在使用 Plus Slider，但它在转换过程中并没有完全隐藏图像。相反，它会加载下一个图像，然后在显示第二个图像时隐藏它。看到这个：http: [//jsfiddle.net/EgkFq](http://jsfiddle.net/EgkFq)

有谁知道一个体面的滑块可以满足我上面的要求，或者至少可以帮助我完成我的建议？此外，图像将是动态的并具有透明背景。

此外，我想要数字分页，因此只有单击数字才能进行转换。有人告诉我我必须使用 jQuery 来检测有多少图像等。

**除了滚动条问题，它已经解决了。[http://jsfiddle.net/h7Y3F](http://jsfiddle.net/h7Y3F)**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T21:02:04.710

[http://jsfiddle.net/EgkFq/5/](http://jsfiddle.net/EgkFq/5/)

```
(function slider(){
    var slides = $("#slider > img");
    var currentIndex = 0;
    var slideCount = slides.length;
    var timePerSlide = 5000;
    var fadeDuration = 1000;

    var nextSlide = function(){
        var nextIndex = currentIndex + 1;
        if (nextIndex == slideCount)
            nextIndex = 0;

        $(slides[currentIndex ]).fadeOut(fadeDuration);
        $(slides[nextIndex ]).fadeIn(fadeDuration);

        currentIndex = nextIndex;
        setTimeout(nextSlide, timePerSlide);
    };

    setTimeout(nextSlide, timePerSlide);
})(); 
```

插件 shmugin。

这是一个如何在“滑块”中居中图像的示例[http://jsfiddle.net/EgkFq/9/](http://jsfiddle.net/EgkFq/9/)

```
(function slider(){
    var slides = $("#slider > img");
    var currentIndex = -1;
    var slideCount = slides.length;
    var timePerSlide = 5000;
    var fadeDuration = 1000;

    var nextSlide = function(){
        var nextIndex = currentIndex + 1;
        if (nextIndex == slideCount)
            nextIndex = 0;

        var me = $(slides[currentIndex]);
        var nxt = $(slides[nextIndex]);

        var w = nxt.width();
        var h = nxt.height();        

        me.fadeOut(fadeDuration);
        nxt.fadeIn(fadeDuration);

        nxt.css({
            "left":"50%", 
            "margin-left":w/2 * -1, 
            "top":"50%", 
            "margin-top": h/2 * -1
        });

        currentIndex = nextIndex;
        setTimeout(nextSlide, timePerSlide);
    };

    setTimeout(nextSlide, 0);
})(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-08T14:24:22.143

有很多滑块供您选择。看看**[70+ Awesome jQuery Slider Plugins](http://www.tripwiremagazine.com/2012/08/jquery-slider.html)**。它们中的大多数具有褪色效果。

# javascript - jQuery Ajax .ajaxSuccess() 事件未触发

> ID：12325113
> 
> 赞同：3
> 
> 时间：2012-09-07T20:43:04.533
> 
> 标签：javascript, javascript-events, jquery

我有一个本机 javascript 对象，我想将 .ajaxSuccess 回调分配给它。这样做的目的是因为我希望我的数据模型在 ajax 调用成功后更新，但我不想让我的数据模型对整个 javascript 文件都是全局的。是的，我检查以确保我的 jQuery 包含在我的脚本文件之前。

这是代码：

```
$("#formButtonAddLink").click(function() {
    $.ajax({
        type: "POST",
        url: "ajax/addlink",
        data: {content: $("#formInputLinkContent").val(), subject: $("#formInputLinkSubject").val()},
        dataType: "json",
        error: function() {
            alert("An ajax error occured adding link")
        }
    });
    return false; //prevents html form submit
})

$(document).ready(function(){
    var links = new Links(20,0);
    $(links).ajaxSuccess(function() {
        console.log("Hey.")    //This does not work.
    });
    $(document).ajaxSuccess(function() {
        console.log("Document hey.")   //This shows up.
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T20:56:43.700

的基本思想`ajaxSuccess()`是：

> 每当 Ajax 请求成功完成时，jQuery 都会触发 ajaxSuccess 事件。此时会执行已使用 .ajaxSuccess() 方法注册的所有处理程序。

据我从[**文档**](http://api.jquery.com/ajaxsuccess/)中了解到，您只能将`ajaxSuccess()`事件处理程序附加到**元素**，而不是 JavaScript 对象。这就是为什么在将事件处理程序附加到`document`.

> 我们可以将事件处理程序附加到任何元素。

在这种情况下，如果您有类似的东西：

```
<div class="links"></div> 
```

你可以这样做：

```
$(document).ready(function(){
    $(".links").ajaxSuccess(function() {
        console.log("Hey.")
        // use links in here:
        var links = new Links(20,0);
    });
}); 
```

# amazon-s3 - EC2 实例上默认安装了哪些 AWS CLI 工具？

> ID：12325114
> 
> 赞同：1
> 
> 时间：2012-09-07T20:43:15.083
> 
> 标签：amazon-s3, amazon-ec2, amazon-web-services, amazon-rds

我正在使用 Amazon Linux EC2 实例，并且想知道默认情况下安装了哪些 AWS CLI 工具。

它只是 EC2 CLI API 工具吗？怎么能说出来？如果尚未安装各种 CLI 工具（RDS、cloudwatch 等），EC2 实例上的首选单个位置在哪里？

如果您能回答这些问题中的每一个，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T21:05:24.310

一般来说，AMI 上安装的内容没有固定标准或固定规则。

不同的 Linux 发行版和不同的 AMI 发布者各自决定他们想在他们的镜像中放入什么以及放在哪里。

事实上，如果 AMI 不愿意，他们甚至不需要通过 ssh 为您提供对实例的命令行访问权限。

如果您有特定的 AMI 系列（Amazon Linux、Canonical 的 Ubuntu 12.04 LTS、RightScale 的 CentOS 5.5），请更新您的问题以包含此内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T21:56:14.623

对于 Amazon Linux AMI 2012.03，这里是[已安装软件包的列表](http://aws.amazon.com/amazon-linux-ami/2012.03-packages/)。

为了回答您的问题，以下是 AWS 工具列表：

*   aws-amitools-ec2-1.4.0.7
*   aws-apitools-as-1.0.61.0
*   aws-apitools-cfn-1.0.9
*   aws-apitools-common-1.1.0
*   aws-apitools-ec2-1.5.5.0
*   aws-apitools-elb-1.0.17.0
*   aws-apitools-iam-1.5.0
*   aws-apitools-mon-1.0.12.1
*   aws-apitools-rds-1.8.002
*   aws-cfn-bootstrap-1.1
*   aws-scripts-ses-2012.05.15

[根据 Amazon Linux AMI 基础知识：](http://docs.amazonwebservices.com/AWSEC2/latest/UserGuide/AmazonLinuxAMIBasics.html)

> **为了允许安装多个版本的 API 和 AMI 工具，我们在/opt/aws**中放置了指向这些工具所需版本的符号链接，如下所述：
> 
> **/opt/aws/bin** — 将场符号链接到每个已安装工具目录中的 /bin 目录。
> 
> **/opt/aws/{apitools|amitools} —**产品安装在格式为 [name]-version 和符号链接 [name] 的目录中，附加到最近安装的版本。
> 
> **/opt/aws/{apitools|amitools}/[name]/environment.sh** — 由 /etc/profile.d/aws-apitools-common.sh 用于设置产品特定的环境变量（EC2_HOME 等）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T04:54:15.373

作为记录：Amazon Linux 的“最小”变体没有全套 CLI 工具。做 a`yum install ec2-tools`并没有得到我想要的，所以我只是用非最小 AMI 创建了一个新实例。我还发现这个最小的 Linux 不再节省空间，至少与最初配置的一样；将进入根分区的额外 6 GB 未被分配。

# performance - 用于最佳匹配查找的高效数据结构

> ID：12325118
> 
> 赞同：0
> 
> 时间：2012-09-07T20:43:40.833
> 
> 标签：performance, data-structures, match, numerical

如果之前有人问过这个问题，我感到非常抱歉，我在决定发布之前搜索了大约 30 分钟，但没有找到任何东西。

我有一个没有精确步进的升序数组：

```
12.34, 103.223, 105.3, 110, 234.45, 329.11 ... 
```

例如，我得到一个数字输入，`106.45`我需要快速找到列表中最接近的匹配项。在这种情况下`105.3`。

如果你能推荐一个，我正在寻找一个合适的数据结构来完成这个。

插入和删除不是性能关键，但找到最接近的匹配是。结构可以是不可变的，数据集不会经常变化。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T20:47:16.430

我只是更喜欢二进制搜索。

# mysql - MySQL 从表中获取缺少的 ID

> ID：12325132
> 
> 赞同：44
> 
> 时间：2012-09-07T20:44:27.457
> 
> 标签：mysql

我在 MySQL 中有这个表，例如：

```
ID | Name
1  | Bob
4  | Adam
6  | Someguy 
```

如果您注意到，没有 ID 号（2、3 和 5）。

如何编写查询以便 MySQL 只回答丢失的 ID，在这种情况下： "2,3,5" ？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-09-07T20:50:19.917

```
SELECT a.id+1 AS start, MIN(b.id) - 1 AS end
    FROM testtable AS a, testtable AS b
    WHERE a.id < b.id
    GROUP BY a.id
    HAVING start < MIN(b.id) 
```

希望这个链接也有帮助 [http://www.codediesel.com/mysql/sequence-gaps-in-mysql/](http://www.codediesel.com/mysql/sequence-gaps-in-mysql/)

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2014-12-17T07:45:12.887

更有效的查询：

```
SELECT (t1.id + 1) as gap_starts_at, 
       (SELECT MIN(t3.id) -1 FROM my_table t3 WHERE t3.id > t1.id) as gap_ends_at
FROM my_table t1
WHERE NOT EXISTS (SELECT t2.id FROM my_table t2 WHERE t2.id = t1.id + 1)
HAVING gap_ends_at IS NOT NULL 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-06-30T20:10:42.607

为了给 Ivan 的回答添加一点内容，如果 1 不存在，此版本会在开头显示缺少的数字：

```
SELECT 1 as gap_starts_at,
       (SELECT MIN(t4.id) -1 FROM testtable t4 WHERE t4.id > 1) as gap_ends_at
FROM testtable t5
WHERE NOT EXISTS (SELECT t6.id FROM testtable t6 WHERE t6.id = 1)
HAVING gap_ends_at IS NOT NULL limit 1
UNION
SELECT (t1.id + 1) as gap_starts_at, 
       (SELECT MIN(t3.id) -1 FROM testtable t3 WHERE t3.id > t1.id) as gap_ends_at
FROM testtable t1
WHERE NOT EXISTS (SELECT t2.id FROM testtable t2 WHERE t2.id = t1.id + 1)
HAVING gap_ends_at IS NOT NULL; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-02-28T08:14:03.487

如果您不想返回多个 ID 范围，而是要检索每个丢失的 ID 本身，每个 ID 都在自己的行中，您可以执行以下操作：

```
SELECT id+1 FROM table WHERE id NOT IN (SELECT id-1 FROM table) ORDER BY 1 
```

查询非常有效。但是，它最后还包括一个额外的行，等于最高 ID 号加 1。可以在服务器脚本中忽略最后一行，方法是检查返回的行数 ( [mysqli_num_rows](http://php.net/manual/en/mysqli-result.num-rows.php) )，然后使用`for`如果行数大于 1 则循环（查询将始终返回至少一行）。

**编辑：** 我最近发现我的原始解决方案没有***返回***所有丢失的 ID 号，在丢失的数字是连续的（即彼此相邻的）的情况下。但是，该查询仍然可以非常快速地确定是否有数字丢失，并且在与 hagensoft 的查询（最佳答案）结合使用时可以节省时间。换句话说，可以首先运行此查询来测试是否缺少 ID。如果找到任何东西，则可以在之后立即运行 hagensoft 的查询，以帮助识别丢失的确切 ID（没有节省时间，但一点也不慢）。如果什么也没找到，那么可能会节省大量时间，因为不需要运行 hagensoft 的查询。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-11-23T00:50:54.853

在一个查询中获取间隙的开始和在一个查询中的间隙结束会更有效率。

我有 1800 万条记录，每条记录都用了不到一秒钟的时间来获得这两个结果。当我尝试将它们放在一起时，我的查询在一小时后超时。

获取差距的开始：

```
SELECT (t1.id + 1) as MissingID
FROM sequence t1
WHERE NOT EXISTS 
    (SELECT t2.id 
    FROM sequence t2 
    WHERE t2.id = t1.id + 1); 
```

得到间隙的结束：

```
SELECT (t1.id - 1) as MissingID
FROM sequence t1
WHERE NOT EXISTS 
    (SELECT t2.id 
    FROM sequence t2 
    WHERE t2.id = t1.id - 1); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-08-26T12:48:30.013

上面的查询将提供两列，因此您可以尝试在单个列中获取缺失的数字

```
select start from 
(SELECT a.id+1 AS start, MIN(b.id) - 1 AS end
    FROM sequence AS a, sequence AS b
    WHERE a.id < b.id
    GROUP BY a.id
    HAVING start < MIN(b.id)) b
UNION
select c.end from (SELECT a.id+1 AS start, MIN(b.id) - 1 AS end
    FROM sequence AS a, sequence AS b
    WHERE a.id < b.id
    GROUP BY a.id
    HAVING start < MIN(b.id)) c order by start; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-03-14T13:39:58.057

通过使用[窗口函数](https://dev.mysql.com/doc/refman/8.0/en/window-functions.html)（在 mysql 8 中可用）查找`id`列中的间隙可以表示为：

```
WITH gaps AS
(
    SELECT
        LAG(id, 1, 0) OVER(ORDER BY id) AS gap_begin,
        id AS gap_end,
        id - LAG(id, 1, 0) OVER(ORDER BY id) AS gap
    FROM test
)
SELECT
    gap_begin,
    gap_end
FROM gaps
WHERE gap > 1
; 
```

如果您使用的是旧版本的 mysql，则必须依赖变量（所谓的穷人窗口函数习语）

```
SELECT
   gap_begin,
   gap_end
FROM (
     SELECT
         @id_previous AS gap_begin,
         id AS gap_end,
         id - @id_previous AS gap,
         @id_previous := id
     FROM (
         SELECT
             t.id
         FROM test t
         ORDER BY t.id
     ) AS sorted
     JOIN (
         SELECT
             @id_previous := 0
     ) AS init_vars
 ) AS gaps
WHERE gap > 1
; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-06-03T08:30:10.820

如果您想要一种更轻松的方式来搜索数百万行数据，

```
SET @st=0,@diffSt=0,@diffEnd=0;
SELECT res.startID, res.endID, res.diff
  , CONCAT(
    "SELECT * FROM lost_consumer WHERE ID BETWEEN "
    ,res.startID+1, " AND ", res.endID-1) as `query`
FROM (
SELECT
  @diffSt:=(@st) `startID`
  , @diffEnd:=(a.ID) `endID`
  , @st:=a.ID `end`
  , @diffEnd-@diffSt-1 `diff`
  FROM consumer a 
ORDER BY a.ID
) res
WHERE res.diff>0; 
```

看看这个[http://sqlfiddle.com/#!9/3ea00c/9](http://sqlfiddle.com/#!9/3ea00c/9)

# javascript - javascript匿名函数语法

> ID：12325136
> 
> 赞同：3
> 
> 时间：2012-09-07T20:45:02.990
> 
> 标签：javascript, anonymous-function

以下两个块有什么区别？

```
// block 1
{
    console.log("anonymous block");
}

// block 2
(function anon() {
    console.log("anonymous block 2");
})(); 
```

我在 Netbeans 中运行了这个（使用 node.js 插件），它们似乎都可以工作......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-07T20:48:37.310

不同之处在于您可以使用后一种形式隐藏全局变量而不破坏它们。

例如，假设您正在使用 jQuery 库，默认情况下，它的主命名空间别名为`$`. 如果您想在`$`不改变`$`通常使用方式的情况下用于不同的目的，您可以执行以下操作：

```
(function($) {
    // Use $ without clashing with the jQuery object.
})(someObject); 
```

事实上，它也可用于另一个目的。由于`undefined`它不是 JavaScript 中的保留字，因此它可以被赋予一个值而失去其用途。因此，您可以简单地不将值传递给`undefined`参数，并且您知道它会正常运行而不会与全局值发生冲突。

```
undefined = "some not-undefined value";    // you'd have to be an idiot to do this but I've seen it done
(function(a, b, undefined) {
    console.log(typeof(undefined) === "undefined");   // true
})(someA, someB); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T20:50:35.743

第一个创建一个块，它与一个函数不同。您可以使用匿名自执行函数来创建本地私有变量并从中返回接口。它被称为模块模式。

```
var Module = (function() {

    var method = function() { console.log("anonymous block"); },
        someOtherMethod = function() {};

    return { // return our interface as an object literal
        method: method,
        someOtherMethod: someOtherMethod
    };
})();

Module.method(); // "anonymous block" 
```

我们可以调用它，保留变量`method`并`someOtherMethod`与全局范围隔离。它是 JS 中面向对象编程的最重要、最有用的特性之一。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T20:51:27.470

`block 1`将具有其所在块的范围，设置 var 将在父级中覆盖它，您可以使用`let`.

```
var a = 2;
{
    var a = 4;
}
a; // === 4 
```

`block 2`将具有全局范围，但设置的任何内容`var`在执行后都会被遗忘。

```
var a = 2;
(function(){
    var a = 4;
})();
a; // === 2 
```

# mysql - 从数据库中检索每个用户的倒数第二条记录

> ID：12325142
> 
> 赞同：0
> 
> 时间：2012-09-07T20:45:32.930
> 
> 标签：mysql, sql, oracle

我有一个包含用户名、更新日期和状态的表，如下所示：

## 姓名 | 更新_on | 地位

```
akg     29-NOV-10       Active
akg     13-JAN-12       NonActive
akg     10-MAR-12       Active
ems     23-JUL-12       NonActive
ems     10-SEP-10       Active
tkp     10-SEP-10       NonActive
tkp     13-DEC-10       Active
tkp     02-JUL-12       NonActive
tkp     24-SEP-10       Active
aron    12-JAN-11       NonActive
aron    07-NOV-11       Active
aron    25-JUN-12       NonActive 
```

在此表中，每次我们更改状态时都会更新用户状态（即，`username`可以有许多条目，如表中所示。

我想要每个用户的第二个最后更新的记录。即对于上表，结果应该是：

## 姓名 | 更新_on | 地位

```
akg     13-JAN-12       NonActive
ems     10-SEP-10       Active
tkp     13-DEC-10       Active
aron    07-NOV-11       Active 
```

我真的很困惑，因为我想获得每个用户的记录。

有没有可以用于此的查询？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T20:57:05.993

```
SELECT * FROM (
  SELECT
    rounda.*
  FROM
    userstatus AS rounda
    INNER JOIN userstatus AS roundb
      ON rounda.name=roundb.name
      AND rounda.Updated_on<roundb.Updated_On
  ORDER BY Updated_on DESC
) AS baseview
GROUP BY name 
```

见[sqlfiddle](http://sqlfiddle.com/#!2/1fd98/6)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T20:59:29.007

你可以试试，它有点冗长，但它有效：

```
SELECT
  name,
  max(Updated_on) as Updated_on,
  STATUS
FROM userstatus a
  WHERE (name, Updated_on) not in
  (select name, max(Updated_on) FROM userstatus group by name)
group by name, status
HAVING UPDATED_ON =
  (SELECT MAX(UPDATED_ON) FROM userstatus b where a.name = b.name
   and (b.name, b.Updated_on) not in
  (select name, max(Updated_on) FROM userstatus group by name)
  group by name); 
```

[Sqlfiddle](http://sqlfiddle.com/#!2/1fd98/27)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T22:39:32.137

当您使用 Oracle 标记此（也）时：

```
select name, updated_on, status
from (
  select name, updated_on, status,
         row_number() over (partition by name order by updated_on desc) as rn,
         count(*) over (partition by name) as max_rn
  from userstatus
) 
where rn = max_rn - 1 
   or max_rn = 1; 
```

这实际上适用于各种 DBMS（包括 Oracle）——只是不适用于 MySQL。

# bash - 如何在 shell 脚本中嵌入一些 HTML？

> ID：12325144
> 
> 赞同：1
> 
> 时间：2012-09-07T20:45:42.213
> 
> 标签：bash, unix

我想在 shell 脚本中包含一些 HTML。这是我尝试过的：

```
(
echo "<html> 
<head>
<title>HTML E-mail</title>
</head>
<body>
<p style="font-family:verdana;color:red;">
This text is in Verdana and red</p>
</body>
</html>"
)>pkll.htm 
```

但是，它没有将 HTML 写入文件，而是给了我一些错误：

```
> bash: color:red: command not found bash: > This text is in Verdana and
> red</p </body> </html>: No such file or directory 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T20:51:27.410

更好的选择是使用此处的文档语法（请参阅[此答案](https://stackoverflow.com/a/2954835/761090)）：

```
cat << 'EOF' > pkll.htm
<html> 
  <head>
    <title>HTML E-mail</title>
  </head>
  <body>
    <p style="font-family:verdana;color:red;">
      This text is in Verdana and red
    </p>
  </body>
</html>
EOF 
```

您的尝试失败了，因为 HTML 中的双引号终止了您环绕它的双引号，并导致`<>`s 被视为重定向并且`;`s 终止`echo`命令。

从技术上讲，您可以使用单引号：

```
( 
echo '<html> 
<head>
<title>HTML E-mail</title>
etc ...'
)>pkll.htm 
```

但是如果 HTML 包含 a `'`，例如撇号或在属性中，您就会再次遇到同样的问题。这里的文档没有这样的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T20:54:36.287

您需要转义 html 中的引号，因为您在要回显的参数的开头有一个引号。

您的终端将其解释为

```
<html>...<p style=" 
```

第一个论点

```
font-family:verdana; 
```

作为第二个参数，其余的作为其他命令，因为你有一个分号。

所以你需要将 p 标签替换为

```
<p style=\"font-family:verdana;color:red;\"> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T20:55:03.653

阅读高级 Bash 脚本指南第 19 章。这里是文档。[http://tldp.org/LDP/abs/html/here-docs.html](http://tldp.org/LDP/abs/html/here-docs.html)

```
cat << 'EOF' > pkll.htm
<html> 
<head>
<title>HTML E-mail</title>
</head>
<body>
<p style="font-family:verdana;color:red;">
This text is in Verdana and red</p>
</body>
</html>
EOF 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-05-05T22:28:02.303

您可以使用在线工具来做同样的事情：

[http://togotutor.com/code-to-html/shell-to-html.php](http://togotutor.com/code-to-html/shell-to-html.php)

# c++ - 当我有一个指向对象的指针时，重载的“取消引用”或“指针成员”运算符不会运行

> ID：12325145
> 
> 赞同：0
> 
> 时间：2012-09-07T20:45:46.363
> 
> 标签：c++, operator-overloading, indirection

我有以下代码：

```
#include <iostream>

struct Base {
    int i_;
};

class El : protected Base {
public:
    int get_i() const { return i_; }
    void set_i(int i) { i_ = i; }
};

class It : protected Base {
public:
    using pointer = const El*;
    using reference = const El&;

    reference operator*() const
    {
        return reinterpret_cast<reference>(*this);
    }

    pointer operator->() const
    {
        return reinterpret_cast<pointer>(this);
    }
};

int main()
{
    It it;
    It* itp = &it;
    std::cout << *****(itp)->get_i() << "\n"; //ERROR
} 
```

GCC 和 Clang++ 都无法调用`operator*`or ，所以无论我尝试了多少次间接调用，最后一行都会`operator->`出错。`It doesn't have member function 'get_i'`标准是否保证这种不直观的行为？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T20:50:22.853

运算符优先级：`->`绑定更紧密，因此应用于指针`itp`。

当您重载`operator->`时，这*不会*影响`operator->`应用于指向您的类的指针的含义。你想要`(*itp)->get_i();`，我想。

# javascript - SyntaxHighlighter 插入新行并错误编号

> ID：12325151
> 
> 赞同：2
> 
> 时间：2012-09-07T20:46:31.930
> 
> 标签：javascript, html, syntax-highlighting, blogger

我在我的 Blogger 博客中使用 SyntaxHighlighter，但有些东西没有按应有的方式工作。在我所有的代码示例中，SyntaxHighlighter 出于某种原因插入了很多新行。此外，它错误地显示数字 9 之后的行数。

这是情况的屏幕截图： ![在此处输入图像描述](../Images/ad218b79a127754620fb1d866b225f4d.png)

我在`</head>`标签上方使用这些脚本来包含 SyntaxHighlighter：

```
<link href='http://alexgorbatchev.com/pub/sh/current/styles/shCore.css' rel='stylesheet' type='text/css'/>
<link href='http://alexgorbatchev.com/pub/sh/current/styles/shThemeDefault.css' rel='stylesheet' type='text/css'/>

<script src='http://alexgorbatchev.com/pub/sh/current/scripts/shCore.js' type='text/javascript'/>
<script src='http://alexgorbatchev.com/pub/sh/current/scripts/shBrushJScript.js' type='text/javascript'/>
<script src='http://alexgorbatchev.com/pub/sh/current/scripts/shBrushXml.js' type='text/javascript'/>

<script language='javascript' type='text/javascript'>
    SyntaxHighlighter.config.bloggerMode = true;
    SyntaxHighlighter.all();
</script> 
```

**我在做什么错，如何修复 SyntaxHighlighter？**

仅供参考，以下是我博客的来源：

```
<pre class="brush:javascript">
var start = function()
{
    var game = new Game(); //The game should now initialize.
    //This will:

        //Get the canvas.
        //Create the renderer.
        //Create the scene.
        //Create the camera.
        //Create the input object.

    game.begin(); //Hand over all the control to the game logic.
    //This will:

        //Begin rendering.
        //Begin listening for input.
        //Begin updating the game.
}
</pre> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T21:13:11.243

这是由最近的 Chrome 版本的变化引起的问题 - 行号实际发生的情况是行号列没有扩展以正确适应，所以你看到数字换行了；在“9”之后，“1”和“0”实际上是“10”等。

在发布 SyntaxHighlighter 更新之前，您可以通过包含修改后的样式表自行修复它。有关说明，请参阅[上个月发布的另一个问题](https://stackoverflow.com/questions/11804789/extra-lines-using-syntaxhighlighter-for-chrome-only)。

# android - Android CheckedTextView

> ID：12325153
> 
> 赞同：0
> 
> 时间：2012-09-07T20:46:34.020
> 
> 标签：android, listview, android-listview, checkedtextview

我有一个`listview` 包含一个`checkedtextview`. 我的应用程序从列表视图的顶部移动到底部。我想在调用操作之前检查是否检查了该项目。如果未选中，我想移至列表中的下一项。

例如

第 1 项 - 已选中

第 2 项 - 已选中

第 3 项 - 未选中

第 4 项 - 已检查

所以，我希望应用程序按如下方式处理：

项目 1

第 2 项

第 4 项。

我不确定如何从该`listview`位置访问项目的已检查状态。

我想要的逻辑如下：

```
Is Current Item checked?
Yes:
Call action
No:
Move to next item.
Reloop to top of void. 
```

我需要一些东西来阻止无限循环。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T21:55:30.610

**1.）**首先创建一个数组，表示适配器中的项目检查状态

（假设您`BaseAdapter`为此目的扩展类）：

```
private boolean [] itemsChecked = new boolean [getCount()]; 
```

**2.)**然后创建一个`OnCheckedChangeListener`：

```
private OnCheckedChangeListener listener = new OnCheckedChangeListener()
{
    @Override
    public void onCheckedChanged(CompoundButton button, boolean checked)
    {
        Integer index = (Integer)button.getTag();
        itemsChecked[index] = checked;
    }
} 
```

**3.）**在您的适配器`getView()`方法中：

```
public View getView(int index, View view, ViewGroup parent)
{
    /*...*/
    CheckBox checkBox = /*get the checkbox*/;
    checkbox.setTag(index); 
    checkBox.setOnCheckedChangeListener(listener);
    /*...*/
} 
```

**4.)**在`onClick()`方法中：

```
public void onClick(View view)
{
    //just get the boolean array somehow
    boolean [] itemsChecked = adapter.getItemsCheckedArray(); 

    for(int i=0; i<itemsChecked.length; i++)
    {
        if(itemsChecked[i])
        {
            //the i th item was checked
        }
        else
        {
                //it isnt checked
        } 
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T20:51:44.993

一种解决方案是使用`ArrayList`of 位置。当用户选中/取消选中 a`checkbox`时，相应地添加/删除您的位置`ArrayList`。然后当用户结束时，只需遍历列表即可知道选择了哪个位置。

# php - ajax 调用只在第一次工作

> ID：12325159
> 
> 赞同：1
> 
> 时间：2012-09-07T20:47:07.617
> 
> 标签：php, ajax, codeigniter

我的控制器中有一个方法可以让用户检查称为“POE 状态”的内容。这将返回一个字符串，我在视图的 div 标记中显示该字符串。我还提供了 2 个按钮。一个启用 POE，另一个禁用。enable 和 disable 命令都将返回 POE 状态作为结果。因此，一旦单击了两个按钮中的任何一个，我就尝试使用 ajax 以新状态更新页面。

我注意到的是，第一次加载页面时，这两个按钮都会起作用。但是在进行初始 ajax 调用并更新视图后，如果我再次尝试使用按钮，则什么也没有发生。

我有以下 HTML：（我不包括所有的 html，只是我认为重要的部分......）

```
 <div class="span6" id="clientajaxcontainer">

      <h2>Port POE Status: Port <?php echo $portname;?></h2>
      <p><p>
      <?php echo $poeStatus;?>                
      <button class="btn" id="enable">Enable POE</button>&nbsp;
      <button class="btn" id="disable">Disable POE</button>              
  </div> 
```

然后我有以下javascript：

```
 <script>
 //Enable POE button
  $('#enable').click(function()  {
   alert('in POEOn');
   console.log('On');
  //disbled button until ajax request is done. 
  $(this).attr("disabled","disabled");
  $('#disable').attr("disabled","disabled");
  var htmlstring;
  $.ajax({
    url:"<?php echo site_url('controller/poeOn);?>",
    type:'POST',
    dataType:'text',
    success: function(returnDataFromController) {
    htmlstring = "<h2>Port POE Status: Port " + $('#port').val() + "</h2><p><p>" + returnDataFromController + "<button class='btn' name='enable' id='enable'>Enable POE</button>&nbsp;<button class='btn' name='disable' id='disable'>Disable POE</button>";    
    alert(htmlstring);
    $('#clientajaxcontainer').html(htmlstring); 
    console.log(htmlstring);
  }
});
//re-enable the buttons.
$(this).removeAttr("disabled");
$('#disable').removeAttr("disabled");
  });

//Disable POE button
  $('#disable').click(function()  {
alert('in POEoff');
console.log('Off');
//disbled button until ajax request is done. 
$(this).attr("disabled","disabled");
$('#enable').attr("disabled","disabled");

$.ajax({
  url:"<?php echo site_url('controller/poeOff);?>",
  type:'POST',
  dataType:'text',
  success: function(returnDataFromController) {
    htmlstring = "<h2>Port POE Status: Port " + $('#port').val() + "</h2><p><p>" + returnDataFromController + "<button class='btn' name='enable' id='enable'>Enable POE</button>&nbsp;<button class='btn' name='disable' id='disable'>Disable POE</button>";    

    alert(htmlstring);
    $('#clientajaxcontainer').html(htmlstring); 
    console.log(htmlstring);
}
  });
  //re-enable the buttons.
  $(this).removeAttr("disabled");
  $('#enable').removeAttr("disabled");
});    

</script> 
```

你能告诉我哪里出错了吗？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T20:50:04.143

问题是您没有为按钮创建“实时”绑定，一旦调用`$('#clientajaxcontainer').html(htmlstring);`，您就用没有点击绑定的新元素替换按钮。试试这个：

```
$('#enable').live('click', function()  {
    //...
}

$('#disable').live('click', function()  {
    //...
} 
```

如果您使用的是 jQuery 1.8，则可以使用该`on()`方法而不是`live()`. 看起来像这样：

```
$(document).on('click', '#enable', function()  {
    //...
}

$(document).on('click', '#disable', function()  {
    //...
} 
```

以下是相关文档：

*   [http://api.jquery.com/live/](http://api.jquery.com/live/)
*   [http://api.jquery.com/on/](http://api.jquery.com/on/)

# sql - 在 SQL 中创建计算列

> ID：12325160
> 
> 赞同：0
> 
> 时间：2012-09-07T20:47:08.040
> 
> 标签：sql

我有一个`XYZ`包含 3 列的表：

```
Environment Servers Databases
Dev         5        10
PROD        25       100
Test        9        10
TOTAL       39       120 
```

我想根据 and 的值向名为 and 的表中添加另外两列（可能`SERVER MAINTENANCE`是表中的计算列，以便每当将数据添加到表中时，该列都应该具有自动计算的值）就像，`DATABASE MAINTENANCE``TOTAL SERVERS``TOTAL DATABASES`

1.  *   如果总 SERVERS 为 [1 到 30]，则 SERVER MAINTENANCE 列的值应为 1
    *   如果总 SERVERS 为 [30 到 100]，则 SERVER MAINTENANCE 列的值应为 5
2.  *   如果总 DATABASES 为 [1 到 10]，则 DATABASE MAINTENANCE 列的值应为 1
    *   如果总 DATABASES 为 [30 到 100]，则 DATABASE MAINTENANCE 列的值应为 10

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T20:55:13.213

通常，计算的列被认为是非标准化的。

在这里，您正在阐明可以作为附加数据轻松输入到另一个表中的规则，例如：

```
maintenance_limits
-------------------
type
min_count
max_count
result_value 
```

然后填写您的信息：

```
DATABASE, 30, 100, 10 
```

等等

那么您只需要编写一个简单的 JOIN 查询即可获得“计算”结果

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T21:16:12.393

不要存储可以计算的内容。只需使用将为您执行此操作的查询：

```
SELECT Environment, Servers, Databases,
    CASE
        WHEN Servers BETWEEN 1 AND 30 THEN 1
        WHEN Servers BETWEEN 31 AND 100 THEN 5
        ELSE 0
    END AS 'Server Maintenance',
    CASE
        WHEN Databases BETWEEN 1 AND 10 THEN 1
        WHEN Databases BETWEEN 30 AND 100 THEN 10
        ELSE 0
    END AS 'Server Maintenance',
FROM XYZ 
```

您可能需要更改`ELSE`为，`NULL`具体取决于您要对数据执行的操作。

# visual-studio-2010 - 映射驱动器文件夹的“指定的网络名称不再可用”

> ID：12325167
> 
> 赞同：1
> 
> 时间：2012-09-07T20:47:21.560
> 
> 标签：visual-studio-2010, networking, mapped-drive

最近在尝试访问特定映射驱动器上文件夹的内容时开始出现以下错误。该程序在 Visual Studio 2010 中运行，奇怪的是该驱动器上有两个文件夹位于同一目录中，并且该错误仅发生在一个文件夹中。我检查了每个文件夹的属性，它似乎匹配，所以不确定可能是什么问题。

```
IOEXception was unhandled. The specified network name is no longer available. 
```

这里有问题的文件夹是 Z:\Output\FTransferBACKUP，但可访问的文件夹是 Z:\Output\TTransferBACKUP。

```
 For Each item In folderList
        Dim fileLists As String() = Directory.GetFiles(item)
        Try
            For i As Integer = 0 To fileLists.Count - 1
                Try
                    Dim fileobj As New FileInfo(fileLists(i))
                    Dim filename As String = fileobj.Name
                    Dim CutOffDate As DateTime = DateTime.Now.AddDays(-7)
                         .... 
```

文件夹列表包含我为归档而访问的各种文件夹的路径。例如。Z:\Output\TTransferBACKUP、Z:\Output\FTransferBACKUP、E:\Output\T2TransferBACKUP、E:\Output\F2TransferBACKUP。E 驱动器是该服务器上的本地驱动器。

# c# - 为什么 CLI 中没有弱引用内置类型

> ID：12325175
> 
> 赞同：0
> 
> 时间：2012-09-07T20:47:55.597
> 
> 标签：c#, .net, garbage-collection, weak-references

我想知道为什么弱引用不是内置类型，它们被垃圾收集处理为类似于标准对象引用。在 C# 中，您必须要么使用 Wea​​kReference 类（它对性能和内存有重大影响，因为它是在托管堆本身上创建并使用终结器进行清理）或手动分配 GCHandle（稍后必须再次手动释放） .

原则上，我会通过以下方式为弱引用实现 GC：

1.  为了识别活动对象，GC 必须从所有根开始遍历对象树。如果它找到对对象的引用，则该对象被标记为可达。相反，如果它发现一个对象的弱引用，这将在第一步中被忽略。

2.  在第二步中，GC 查找无法访问的内存块所在的位置并压缩托管堆（或至少部分堆）。当它这样做时，它必须再次遍历对象树并更新所有对已移动对象的引用（正常和弱）。此外，如果它发现对未标记为可访问的对象的弱引用，则必须将其设置为 null（或其他一些明确定义的无效内存位置）以将其标记为无效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T20:51:49.203

可能是因为它们往往被需要的次数不够多，无法获得更突出的代表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T21:07:02.607

垃圾收集器在常规引用方面已经做得很好，即使存在循环引用。（在引用计数的世界中，这是一个非常不同的故事）。您可以在对象之间进行循环引用，并且在大多数情况下它会被正确清理。这意味着您很少需要 WeakRef，因此它可能不保证内置在 CLI 中。

# asp.net - 如何处理 ListView 中的 UserControl 事件？

> ID：12325177
> 
> 赞同：0
> 
> 时间：2012-09-07T20:48:09.737
> 
> 标签：asp.net, vb.net, webforms

这是我设置的结构：

```
<UserControl1>
    <ListView>
        <UserControl2 />
        <UserControl2 />
        <UserControl2 />
        <UserControl2 />
    </ListView>
</UserControl2> 
```

当用户在 UserControl2 上单击“编辑”时，我想在 UserControl1 上处理该事件。所以我在 UserControl2 上创建了一个事件，在 ListView DataBind 上的 UserControl1 上添加了一个处理程序，并在单击“编辑”时引发了 UserControl2 事件。

但是当用户单击“编辑”时，整个事情都会发回，并且处理程序会在 UserControl1 上丢失。问题是，我无法在每次回发时重新绑定 ListView，因为重新添加处理程序是一项非常繁重且耗时的操作。

那么如何让 UserControl1 看到 UserControl2 的事件呢？

我尝试过的事情：

1.  Usercontrol2 上的静态/共享事件...在 asp.net 应用程序上是个坏主意，显然这些静态事件会以某种方式混淆起来，我想它们存在于不同的 webrequests 中。
2.  将 userControl1 实例属性 (ParentControl1) 添加到 UserControl2...asp.net 中不允许嵌套的 UserControl。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T22:40:45.990

我有一段时间没有做过网络表单了——但我对此很感兴趣。

这三个文件将演示如何使用用户控件订阅事件。

*   基本上我的 UserControl1 有一个我可以订阅的事件。
*   UserControl2 有一个 ListView，它将包含 UserControl1 的实例。我可以在 UserControl2 中订阅 UserControl1 实例中的事件。
*   Default.aspx 包含 UserControl2 的一个实例

单击 UserControl1 中的任何事件都会触发该事件——在这种情况下，它只会发送 UserControl1 中按钮的文本。

VB 中的代码应该非常相似。

用户控件1

```
<%@ Control Language="C#" AutoEventWireup="true" %>
<script runat="server">
    public delegate void SillyHandler(object sender, string text);
    public event SillyHandler SomethingHappened;

    public string Name { get; set; }

    protected void Button1_Click(object sender, EventArgs e)
    {
        if (SomethingHappened != null)
            SomethingHappened(this.Button1, this.Button1.Text);
    }
</script>
<asp:Button ID="Button1" runat="server" Text="<%#this.Name %>" onclick="Button1_Click" /> 
```

用户控件2

```
<%@ Control Language="C#" AutoEventWireup="true" %>
<%@ Register src="UserControl1.ascx" tagname="UserControl1" tagprefix="uc1" %>
<script runat="server">
    public List<string> DataSource { get; set; }

    protected void SomethingHappened(object sender, string txt)
    {
        MyLabel.Text = txt;
    }
</script>
<asp:ListView runat="server" ID="ListView1" DataSource="<%#DataSource %>">
    <ItemTemplate>
        <uc1:UserControl1 ID="UserControl11"  runat="server" OnSomethingHappened="SomethingHappened" Name="<%#Container.DataItem %>"/>
    </ItemTemplate>
</asp:ListView>

<asp:Label runat="server" ID="MyLabel" /> 
```

默认.aspx

```
<%@ Page Language="C#" AutoEventWireup="true" %>

<%@ Register src="UserControl2.ascx" tagname="UserControl2" tagprefix="uc1" %>

<script runat="server">
    protected void Page_Load(object sender, EventArgs e)
    {
        if (!this.IsPostBack)
        {
            this.UserControl21.DataSource = new List<string> { "A", "B", "C" };
            this.UserControl21.DataBind();
        }
    }
</script>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <div>

        <uc1:UserControl2 ID="UserControl21" runat="server" />

    </div>
    </form>
</body>
</html> 
```

# android - 所有智能手机浏览器（Android 和 iOS）都支持多点触控/手势吗？

> ID：12325189
> 
> 赞同：3
> 
> 时间：2012-09-07T20:49:28.020
> 
> 标签：android, ios, browser, multi-touch, gesture

**背景：**

*   我的网站有一个页面，我需要我的用户/客户在其中绘制他们的设计模型。
*   为此，我计划使用 HTML5-Javascript 创建一个非常简单的基于 SVG 的绘图工具。
*   我希望该工具能够在 iOS 和 Android 手机（3.x 及更高版本）上的标准浏览器上工作。

**问题**：

*   对于我网页上建议的绘图工具，我想特别利用多点触控和手势支持——但它们是否在 iOS 和 Android（3.x 及更高版本）上的标准浏览器中受支持？

（因为，如果不是，唯一的其他选择是分别为两个平台开发两个本机（和非浏览器）应用程序，对吗？）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-10T08:25:04.287

iOS Safari 3.2、Android Browser 2.1、BlackBerry Browser 7.0 和更新版本支持 HTML5 触摸事件。

资料来源：[http](http://caniuse.com/#feat=touch) ://caniuse.com/#feat=touch 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T21:55:50.220

我发现这篇[文章](http://www.html5rocks.com/en/mobile/touch/)似乎表明除了 Gingerbread 和 iOS 之外的 android 在响应多点触控事件方面应该是可靠的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-11T22:41:53.753

您可以使用 corona 并同时开发这两个应用程序。Corona 比在 xcode 中开发更容易。我不使用电晕，因为它会限制你，但是做一个网络应用程序根本不重要。浏览器的 2-touch 功能主要用于页面的缩放、选择和其他编辑，因此您将无法接收它们，至少不是很好。您可以让他们使用一根手指，但两根手指用于浏览器功能。

# asp.net - 如何从 web.config 指定 CodeFileBaseClass？

> ID：12325192
> 
> 赞同：1
> 
> 时间：2012-09-07T20:49:45.133
> 
> 标签：asp.net, user-controls, templating

我¹正在注册*用户控件* ：`Control``web.config`

```
<configuration>
    <system.web>
       <pages validateRequest="false">
          <controls>
              <add src="~/GenericControls/Toolbar.ascx" 
                    tagName="Toolbar" tagPrefix="Vista" />
          </controls>
       </pages>
    </system.web>
<configuration> 
```

现在，因为我的*“用户控件”*是 a `Control`，而不是 a `UserControl`（为了支持模板），这会导致 Visual Studio 错误：

> ASPNET：确保此代码文件中定义的类与“继承”属性相匹配，并且**它扩展了正确的基类（例如 Page 或 UserControl）**。

此错误的修复是您[必须提醒 Visual Studio *control `inherits from`Control`](http://forums.asp.net/t/941553.aspx/1)：

```
<%@ Page language="c#" Inherits="University.AspNet.Index"  
      CodeFile="Index.aspx.cs" CodeFileBaseClass="XXXXXX" %> 
```

具有超级机密`CodeFileBaseClass`属性。除了我没有使用**Page**指令外，我在 web-config 中注册了整个**站点的控件：**

```
<add src="~/GenericControls/Toolbar.ascx" 
      tagName="Toolbar" tagPrefix="Vista" /> 
```

我如何`CodeFileBaseClass`从内部指定`web.config`？

## 系列

这个问题是正在进行的 Stackoverflow 系列**“模板化用户控件”**中的一个：

*   [如何将模板添加到用户控件？](https://stackoverflow.com/questions/11658053/how-to-add-a-templating-to-a-usercontrol/11700540)
*   [如何从 Control 继承，而不是 UserControl？](https://stackoverflow.com/questions/12323303/how-to-inherit-from-control-rather-than-usercontrol)
*   [UserControl 有 IsPostBack，但 Control 没有](https://stackoverflow.com/questions/12321621/usercontrol-has-ispostback-but-control-does-not/12321692)
*   [UserControl 没有名为 ContentTemplate 的公共属性](https://stackoverflow.com/questions/11656637/usercontrol-does-not-have-public-property-named-contenttemplate)
*   [如何从 web.config 指定 CodeFileBaseClass？](https://stackoverflow.com/questions/12325192/how-do-i-specify-codefilebaseclass-from-web-config)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-08T09:05:46.213

尝试这个：

```
<system.web>
    <!-- ... -->
    <pages pageBaseType="MyWeb.UI.MyPageBase" />
    <!-- ... -->
</system.web> 
```

**另外，请参考以下链接：**

[http://blogs.msdn.com/b/tom/archive/2008/08/22/known-issues-for-asp-net-with-net-3-5-sp1.aspx](http://blogs.msdn.com/b/tom/archive/2008/08/22/known-issues-for-asp-net-with-net-3-5-sp1.aspx)

[http://forums.asp.net/t/1305800.aspx](http://forums.asp.net/t/1305800.aspx)

**建议的解决方法**：

如果并非所有页面都需要 pageBaseType 类（例如 MyBasePage），您可以将其从 web.config 文件中删除，或者

如果页面确实需要 pageBaseType 值，请修改代码隐藏文件中的类以扩展基本类型。在 filename.aspx.cs 代码隐藏文件中，确保该类继承自 web.config 文件中指定的 pageBaseType（例如，公共部分类 CodeFileClass : MyBasePage 而不是公共部分类 CodeFileClass : System.Web .UI.Page）。

另一种解决方法将允许您将以下属性添加到您的页面指令：

```
CodeFileBaseClass="System.Web.UI.Page" 
```

# php - Facebook 连接 注销

> ID：12325197
> 
> 赞同：2
> 
> 时间：2012-09-07T20:50:25.890
> 
> 标签：php, facebook, codeigniter, session

我正在使用 Facebook Connect SDK for php 使用 CodeIgniter 开发基于 PHP 的应用程序。到目前为止，所有用户都可以登录系统，但对于某些用户尝试注销时会话不会过期！这真的很奇怪，因为这对某些用户有效，而对其他用户无效！以下是我使用 Facebook 提供的基本注销代码：控制器：

```
if ($user) {
            $data['logoutUrl'] = $this->facebook->getLogoutUrl(); 
```

看法：

```
<a href="<?php echo $logoutUrl; ?>" id="bstyle" onclick="RemoveSess()">Logout</a> 
```

JavaScript：

```
function RemoveSess(){
                $.post("<?php echo base_url(); ?>"+ "/facebook_cn/remSess", function(data){
                        document.getElementById('message').innerHTML = $data;       
                      });   
            } 
```

php控制器：

```
function remSess()
{
    $data2 = array('user_id' => '','logged_in' => '');
    $this->session->unset_userdata($data2);
    $this->session->sess_destroy();
    session_destroy();
    $data = array('sess' => "gone" );
    echo json_encode($data["sess"]="gone");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T20:57:10.910

您正在破坏本地会话，但用户不会使用此代码从 Facebook 注销。因此，一旦您初始化 SDK，您的应用程序就会缓存用户的 Facebook 会话。您需要从 Facebook 和您的网站注销用户，或者检查更好的登录/Facebook 连接功能以不自动登录用户。

如果您需要更多说明，请提供您在其中启动 Facebook SDK 的登录功能和代码。

**更新**

这就是我的 FB 连接：

```
$this->_facebook = new Facebookapi($settings);

// Try to get the user's id on Facebook
$userId = $this->_facebook->getUser();

// If user is not yet authenticated, the id will be zero
if( $userId == 0 ){
    $this->_loginUrl = $this->_facebook->getLoginUrl(array('scope'=>'email')); 
}else{
    $_user = $this->_facebook->api('/me');
    $this->_user = new Users();
    $this->_user->load($_user['username'], 'facebook');
} 
```

因此，如果用户已登录 facebook，我会检查我是否已经拥有具有此类用户名的用户，如果是，我会将用户加载到对象中。用户将自动登录回我的站点，无需再次单击连接按钮。

您需要检查您的代码以确保您没有像我这样的东西，否则您的用户将永远不会注销，直到先从 Facebook 注销。

# java - 有没有办法手动损坏文件？

> ID：12325204
> 
> 赞同：3
> 
> 时间：2012-09-07T20:50:40.663
> 
> 标签：java, file-io, io

我有一个过程，在这个过程中，我偶尔会创建文件，但由于我无法弄清楚我得到“java.io.FileNotFoundException：文件不是普通文件”的原因。即使文件出现（在文件管理器和文本编辑器中）完全正常，也会出现异常。因此，我正在尝试重新创建此错误并查看如何处理它，但为此我需要手动创建一个会引发此异常的文件，而且我不知道我可以手动对文件执行什么操作它突然以这种方式“破碎”。

我意识到，无论我对文件做什么，都与抛出异常的文件不同，但为了编写可测试代码以验证我的保护代码是否有效，这无关紧要.. . 我只需要一个损坏的文件。我想我可以在某个随机周期中手动抛出异常，但我希望我能让这个更“现实”。

所有帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T20:59:25.530

我认为您可能看错了方式，尤其是根据文本编辑器实际上没有损坏文件时。
您应该已经发布了整个堆栈跟踪。我怀疑问题不在于文件，而在于路径名。
您是否在收到异常时尝试过[File#isfile()](http://docs.oracle.com/javase/6/docs/api/java/io/File.html#isFile%28%29)的结果？来自 javadoc（我的重点）

> 公共布尔 isFile()
> 
> 测试此抽象路径名表示的文件是否为 **普通文件**。***如果文件***不是目录，并且满足其他系统相关标准，则该文件是正常的。Java 应用程序创建的任何非目录文件都保证是普通文件。

我怀疑它`File#isfile()`会`false`在异常之前返回，你应该查看这个 API 而不是试图破坏文件

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T21:02:59.583

损坏的文件仍然是文件。例如，损坏的 Word 文档仍然是一个文件，但无法使用文字处理器打开，因为它的内容不可读。

此处抛出异常：

```
public FilePartSource(File file) throws FileNotFoundException {
66          this.file = file;
67          if (file != null) {
68              if (!file.isFile()) {
69                  throw new FileNotFoundException("File is not a normal file.");
70              }
71              if (!file.canRead()) {
72                  throw new FileNotFoundException("File is not readable.");
73              }
74              this.fileName = file.getName();       
75          }
76      } 
```

并且当您的文件不是文件而是其他文件（目录？指向不存在文件的链接？）时发生

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T20:56:20.160

如果要破坏现有文件，只需编写一个打开文件并打乱字节的函数。您也可以使用十六进制编辑器来执行此操作。如果你想生成垃圾文件，你可以创建一个新文件并将 random.nextBytes() 写入其中。

# java - JavaScriptInterface 没有做任何事情

> ID：12325205
> 
> 赞同：1
> 
> 时间：2012-09-07T20:50:46.423
> 
> 标签：java, javascript, android, webview

我一直在研究主线程和 WebView 之间的通信，但无论我尝试什么，似乎都没有发生任何事情。不幸的是，我在 Android 中并没有真正准备好 Javascript 调试控制台：-/

这可能又是一个愚蠢的小错误，但我找不到问题所在。它根本没有做任何事情。我没有看到任何错误或其他任何东西。

```
@SuppressLint("SetJavaScriptEnabled")
@Override
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate (savedInstanceState);
    setContentView (R.layout.activity_main);

    WebView web = (WebView) findViewById (R.id.web);
    web.getSettings ().setJavaScriptEnabled (true);
    web.setWebChromeClient (new WebChromeClient ());
    JavaScriptInterface jsInterface = new JavaScriptInterface (this);
    web.addJavascriptInterface (jsInterface, "accessAndroid");
}

public class JavaScriptInterface
{
    Context context;

    JavaScriptInterface (Context c)
    {
        context = c;
    }

    public void gotoArticle (int id)
    {
        jsHandler.post
        (
            new Runnable ()
            {
                public void run ()
                {
                    //TODO//
                }
            }
        );
    }

    public void showDialog (final String message)
    {
        jsHandler.post
        (
            new Runnable ()
            {
                public void run ()
                {
                    showDialog (message);
                }
            }
        );
    }
} 
```

从加载的网页运行`alert ('Something');`时，一切都很好。但是`dlg ('Something');`什么都不做。

# java - 如何使用 Java Swing Actions 在 Netbeans 中创建菜单项和工具栏项

> ID：12325207
> 
> 赞同：1
> 
> 时间：2012-09-07T20:50:54.350
> 
> 标签：java, swing, netbeans, action, netbeans-7

我正在阅读一本 Java 书籍，作者使用相同的操作创建菜单项和工具栏项。如何使用 NetBeans 做到这一点？这是代码：

```
 public class ActionInterfaceDemo extends JFrame{

    private JPanel buttonPanel = new JPanel();
    private FlowLayout flowLayout = new FlowLayout();

    //---Default constructor
    public ActionInterfaceDemo()
    {
        //Create image icons
        ImageIcon leftImageIcon = new ImageIcon(getClass().getResource("image/leftAlignment.png"));
        ImageIcon centerImageIcon = new ImageIcon(getClass().getResource("image/centerAlignment.png"));
        ImageIcon rightImageIcon = new ImageIcon(getClass().getResource("image/rightAlignment.png"));

        //Create actions
        Action leftAction = new MyAction("Left", leftImageIcon, "Left alignment for the buttons in the panel", new Integer(KeyEvent.VK_L), KeyStroke.getKeyStroke(KeyEvent.VK_L, ActionEvent.CTRL_MASK));
        Action centerAction = new MyAction("Center",centerImageIcon, "Center alignment for the buttons in the panel", new Integer(KeyEvent.VK_C), KeyStroke.getKeyStroke(KeyEvent.VK_C, ActionEvent.CTRL_MASK));
        Action rightAction = new MyAction("Right", rightImageIcon, "Right alignment for the buttons in the panel", new Integer(KeyEvent.VK_R), KeyStroke.getKeyStroke(KeyEvent.VK_R, ActionEvent.CTRL_MASK));

        //Create menus
        JMenuBar jMenuBar1 = new JMenuBar();
        JMenu jmenuAlignment = new JMenu("Alignment");
        setJMenuBar(jMenuBar1);
        jMenuBar1.add(jmenuAlignment);

        //Add actions to the menu
        jmenuAlignment.add(leftAction);
        jmenuAlignment.add(centerAction);
        jmenuAlignment.add(rightAction);

        //Add actions to the toolbar
        JToolBar jToolBar1 = new JToolBar(JToolBar.HORIZONTAL);
        jToolBar1.setBorder(BorderFactory.createLineBorder(Color.red));
        jToolBar1.add(leftAction);
        jToolBar1.add(centerAction);
        jToolBar1.add(rightAction);

        //Add buttons to the button panel
        buttonPanel.setLayout(flowLayout);
        JButton jbtLeft = new JButton(leftAction);
        JButton jbtCenter = new JButton(centerAction);
        JButton jbtRight = new JButton(rightAction);
        buttonPanel.add(jbtLeft);
        buttonPanel.add(jbtCenter);
        buttonPanel.add(jbtRight);

        //Add toolbar to the east and panel to the center
        add(jToolBar1, BorderLayout.NORTH);
        add(buttonPanel, BorderLayout.CENTER);
    }

    //inner class MyAction
    private class MyAction extends AbstractAction
    {
        String name;

        MyAction(String name, Icon icon)
        {
            super(name, icon);
            this.name = name;
        }

        MyAction(String name, Icon icon, String desc, Integer mnemonic, KeyStroke accelerator)
        {
            super(name,icon);
            putValue(Action.SHORT_DESCRIPTION, desc);
            putValue(Action.MNEMONIC_KEY, mnemonic);
            putValue(Action.ACCELERATOR_KEY, accelerator);
            this.name = name;
        }

        @Override
        public void actionPerformed(ActionEvent e) {
            if (name.equals("Left"))
                flowLayout.setAlignment(FlowLayout.LEFT);
            else if (name.equals("Center"))
                flowLayout.setAlignment(FlowLayout.CENTER);
            else if (name.equals("Right"))
                flowLayout.setAlignment(FlowLayout.RIGHT);

            buttonPanel.revalidate();
        }
    }

    /**
     * @param args the command line arguments
     */
    public static void main(String[] args) {
        // TODO code application logic here
        ActionInterfaceDemo frame = new ActionInterfaceDemo();
        frame.setLocationRelativeTo(null);  //Center the frame
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setTitle("ActionInterfaceDemo");
        //frame.pack();
        frame.setSize(new Dimension(600, 200));
        frame.setVisible(true);
    }
} 
```

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T21:59:04.047

两者`JMenuItem`都有`JButton`一个`setAction()`方法，你可以用它来设置你的`Action`.

# android - ZXing集成集scan_mode

> ID：12325212
> 
> 赞同：1
> 
> 时间：2012-09-07T20:51:06.170
> 
> 标签：android, zxing

我已经将 ZXing 源集成到我的应用程序中，但是我没有使用 Intent 方法加载相机，而是在我的布局中包含了 capture.xml：

`<include layout="@layout/capture"/>`

然后将 ZXing 嵌入到我的布局中，我想知道如何将 SCAN_MODE 设置为仅一维代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T21:06:43.857

如果您使用标准意图，请将此键值对添加到您的意图中：

```
intent.putExtra(Intents.FORMATS, Intents.ONE_D_MODE); 
```

在我的程序中，我使用这一行将条形码限制为 QR 码：

```
intent.putExtra("SCAN_FORMATS", "QR_CODE"); 
```

另请参阅[此源文件](http://code.google.com/p/zxing/source/browse/trunk/android/src/com/google/zxing/client/android/Intents.java#36)的第 36 行。

# wpf - 为什么内部对象的 DataContext 没有更新？

> ID：12325213
> 
> 赞同：0
> 
> 时间：2012-09-07T20:51:17.023
> 
> 标签：wpf, datacontext

我对 DataContext 更改有疑问，我构建了示例以了解这方面。我在 MainWindow 上有 MainUserControl。MainUserControl 由多个用户控件组成。此类用户控件之一是 SubUserControl1。

```
<Window x:Class="WpfApplicationUcBindingQuestion.MainWindow">
    <Grid>
        .....
      <uc:MainUserControl />
    </Grid>
</Window>

<UserControl x:Class="WpfApplicationUcBindingQuestion.MainUserControl">
<Grid>
.....
    <uc:SubUserControl1 x:Name="subUserControl1" />
</Grid>
</UserControl> 
```

在 MainWindow 中，我有类 Info 的对象。类信息由几个内部类组成。其中之一是，可以说，SubInfo。Info 和 SubInfo 类都继承自 INotifyPropertyChanged。

这是他们的代码：

```
public class Info : INotifyPropertyChanged
{
    private SubInfo m_subInfo = new SubInfo();

    public Info()
    {
    }

    public SubInfo SubInfo 
    {
        get
        {
            return m_subInfo;
        }
        set
        {
            m_subInfo = value;
            OnPropertyChanged("SubInfo");
        }      
    }

    public event PropertyChangedEventHandler PropertyChanged;

    protected void OnPropertyChanged(string propertyName)
    {
        PropertyChangedEventHandler handler = PropertyChanged;
        if (handler != null)
            handler(this, new PropertyChangedEventArgs(propertyName));
    } 
}

public class SubInfo: INotifyPropertyChanged
{
    private string m_subString = "subStr";

    public SubInfo()
    {
    }

    public string SubString 
    {
        get
        {
            return m_subString;
        }
        set
        {
            m_subString = value;
            OnPropertyChanged("SubString");
        }      
    }

    public event PropertyChangedEventHandler PropertyChanged;

    protected void OnPropertyChanged(string propertyName)
    {
        PropertyChangedEventHandler handler = PropertyChanged;
        if (handler != null)
            handler(this, new PropertyChangedEventArgs(propertyName));
    } 
} 
```

我想将 MainUserControl 的 DataContext 设置为 Info 类的对象，而**SubUserControl1 的 DataContext 将是 Info.SubInfo。**

以下代码对此进行了描述：

```
<UserControl x:Class="WpfApplicationUcBindingQuestion.SubUserControl1">
   <Grid>
      .....
    <TextBox Text="{Binding Path=SubString}"/> 
   </Grid>
</UserControl>

public MainUserControl()
{
        InitializeComponent();

        MainWindow mainWnd = (MainWindow)Application.Current.MainWindow;

        Info info = mainWnd.Info;
        this.DataContext = info;

        this.subUserControl1.DataContext = info.SubInfo;
} 
```

当新的 subInfo 到达时，我更新 info 对象内的内部对象 subInfo：（这是 MainWindow 的功能）

```
private void OnUpdateData()
{
    SubInfo arrivedSubInfo = new SubInfo();
    arrivedSubInfo.SubString = "newString";

    m_info.SubInfo = arrivedSubInfo;
} 
```

我想看到 subUserControl1 的 DataContext 也发生了变化。

但它没有发生，SubUserControl1 中的 TextBox 没有更新，也没有显示“newString”。

（注意：如果我在 OnUpdateData() 函数中编写以下内容：

```
m_info.SubInfo.SubString = arrivedSubInfo.SubString; 
```

（复制字段字段而不是整个对象）它可以工作，但我不想复制 50 个字段......）

我哪里错了？您的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T21:01:17.473

您的问题如下：

在您的构造函数中，当您这样做时：

```
 this.DataContext = info;

    this.subUserControl1.DataContext = info.SubInfo; 
```

您将只设置一次 DataContext。`subUserControl1.DataContext = someNewDataContext`这意味着除非你在某处写，否则它永远不会改变。

你可以做些什么来解决这个问题：

**“正确的解决方案”：**

使用绑定。在您的 XAML 中，只需编写：

```
<uc:SubUserControl1 x:Name="subUserControl1" DataContext="{Binding
SubInfo, UpdateSourceTrigger=PropertyChanged}" /> 
```

假设您的`SubInfo`属性在设置时触发`OnPropertyChanged`事件，这将起作用。

**“丑陋的解决方案”：**

需要时在代码隐藏中显式设置您`UserControl`的 's 。`DataContext`同样，我不建议您这样做，您最好应用第一个解决方案！

# r - 在哪里放置 CRAN 提交的包小插曲？

> ID：12325223
> 
> 赞同：21
> 
> 时间：2012-09-07T20:51:45.127
> 
> 标签：r, cran, package-development

从[Writing R Extensions Manual](http://cran.r-project.org/doc/manuals/R-exts.html#Writing-package-vignettes)，我读到

> 从 R 2.14.0 开始，Sweave 源的首选位置是源包的子目录 vignettes，但为了与 R 的早期版本兼容，如果 vignettes 不存在，则将在 inst/doc 中查找 Vignette 源。

但是，当我创建`vignettes`包源的子目录时，当我运行`devtools::check()`或`R CMD check`收到`Package vignette(s) without corresponding PDF`. 如果我将小插图（.Rnw 和 .pdf）放入`inst/doc`检查中，则无需投诉即可完成。我尝试在已安装打包的库中查看我的库，但没有看到任何名为`vignettes`. 我还应该使用已弃用的位置吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-09-07T21:04:16.527

您照原样放入`.Rnw`资源`vignettes/`，但错过了关键步骤；不要检查源代码树。预期的工作流程是构建源 tarball，然后检查该 tarball。构建 tarball 将创建小插图 PDF。

```
R CMD build ../foo/pkg
R CMD check ./pkg-0.4.tar.gz 
```

例如，将在当前目录中`../foo/pkg`创建包时从源代码构建一个源包 tarball，并附加包名称和版本。`.tar.gz`然后你`R CMD check`在那个源包上运行。

如果您想为您构建小插图，请将其放入`vignettes/`并构建源包。在未来的某个日期，R Core 可能会移除构建小插图的功能，`inst/doc`因此请立即使用建议的位置并避免直接检查源。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-09-07T21:03:45.470

我也很难解释这一点。

我相信您的意图是您应该将`.Rnw`文件`vignettes/`和 PDF（适当压缩）放入 中`inst/doc/`，如果您仔细阅读，这在技术上与文档一致。（也就是说，它说*来源*应该进入`vignettes/`。我看不出它在哪里说了这么多话，你应该把相应的 PDF 放进去`inst/doc/`，但它没有**说**，而且这种解释似乎让人`R CMD check`高兴...)

解决方案在@GavinSimpson 的回答中（即需要构建tarball 然后检查它，而不是检查源目录本身）。*（我的两分钱是，如果 R-core 正式弃用（并最终删除）直接源代码检查，而不是混淆我们所有的基础知识，这可能是最好的......）*

# ios - 地图套件。从服务器获取附近的地点并可能缓存它们（例如供离线使用）

> ID：12325225
> 
> 赞同：1
> 
> 时间：2012-09-07T20:51:48.603
> 
> 标签：ios, caching, mapkit

我正在开发 iOS 5 应用程序，我想与服务器通信，提供有关给定位置附近地点的信息：地点位置和注释。我想使用 MapKit 用这些信息填充我的地图。

我没有找到有关以下问题的任何直接信息：

1.  MapKit 是否具有开箱即用的图块功能（谷歌地图方式），如果没有，我是否需要额外处理它？
2.  从服务器检索地点信息（标记位置和注释）的最佳实践是什么？
3.  是否可以缓存此信息，以便用户可以在离线模式下查看“他的城市”附近的地方？

实际上问题 2 和 3 是相互关联的：它们都解决了无法多次检索已经在地图上的信息（位置 + 注释）的问题。

希望我不会在这里忽略一些明显的东西。

谢谢！

更新1：（关于地点，而不是地图）更具体地说，我感兴趣的是，我应该如何为包含我从服务器获取的地点的区域创建一个“手工制作”的逻辑图块，这样它们就不需要在用户滚动时重新获取自己地图？我知道我可以自己潜入实现这个功能。例如，我应该在获取它们后立即使用 Core Data 将刚刚获取的位置写入本地存储还是组织一些队列？或者我怎么知道何时需要对服务器上的特定区域执行请求，以及何时只获取设备上已经存在的本地数据？我只想知道，有没有推荐的方法，最佳实践？希望我在这里写得很清楚。

更新 2：我想知道这里的最佳实践（链接、示例）不要从头开始创建所有这些（第 2+3 点）。有没有封装这个或好的教程的框架？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T23:14:50.550

@Stanislaw - 我们已经为我们的一位客户实现了您在名为[PreventConnect](http://itunes.apple.com/us/app/preventconnect/id542072909?mt=8)的应用程序中描述的功能。客户已经在 Google Fusion 表中存储了一些数据。我们通过添加另一个存储多个位置的地理坐标的 Google Fusion 表扩展了他们现有的解决方案。说了这么多，回答你的问题...

1）地图部分本身非常开箱即用，瓷砖等等，但你需要做一些编码来获得缩放范围、图钉放置、注释和类似的东西，以你期望的方式工作.

2) 我们发现 Google Fusion 解决方案非常有效。如果您不想使用 Google Fusion，还有其他云数据库提供商，例如 StackMob、database.com 等。Google 是免费的，他们有一个 iOS SDK，可以让与 Google Fusion 的通信变得非常简单。

3）绝对！我们将大部分数据缓存在设备本地的 Core Data 存储中。这极大地提高了性能和响应能力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-26T15:37:19.217

是时候为这个我的问题写一个可靠的答案了（我可以在一年前写下它，但不知何故我忘记了它）。

* * *

> MapKit 是否具有开箱即用的图块功能（谷歌地图方式），如果没有，我是否需要额外处理它？

答案是肯定的：MapKit 确实有。这里的关键词是`overlays (MKOverlay, MKOverlayView and others)`。请参阅[我的另一个答案](https://stackoverflow.com/questions/12561357/update-mapkit-annotation-subtitle-and-image/12665821#12665821)。

也可以看看：

[WWDC 2010 会议：使用叠加自定义地图](https://developer.apple.com/videos/wwdc/2010/)，

[苹果-WWDC10-TileMap](https://github.com/klokantech/Apple-WWDC10-TileMap)。

* * *

> 从服务器检索地点信息（标记位置和注释）的最佳实践是什么？

实际上，从那时起，我并没有学到很多关于“最佳实践”的知识——不幸的是，没有人告诉我它们:(——这就是我要描述“我的实践”的原因。

首先，使用地点填充 MapKit 地图有两种策略：

第**一个策略**是根据需求用地点填充地图：假设您想要显示并查看附近的所有地点（例如，距离当前用户位置不超过 1 公里） - 这种方法假设您只询问服务器的地点你感兴趣的盒子。它的意思是：“如果我在柏林（我希望柏林有 200 个地方），我为什么要从俄罗斯、日本……（10000 多个地方）获取这些地方” .

这种方法导致依赖于问题 N1 解决的“图块”功能：谷歌地图和苹果地图通常使用“图块”绘制，因此对于地图的“柏林”部分，您依赖于由 MKMapView 绘制的相应“柏林”图块 -您使用它们的尺寸，仅询问您的服务器“柏林”框中的位置（请参阅我的链接答案和那里的演示应用程序）。

最初这是我使用的方法，我的实现运行良好，但后来我被迫使用第二种方法（见下文），因为出现了集群问题。

第二种**策略**是一次获取所有地点（是的，所有这 10000 多个或更多）并使用 Core Data 获取您感兴趣的地图可见部分所需的地点。

第二种方法意味着，在第一次运行期间，您向服务器发送请求以获取所有位置（我的应用程序中有大约 2000 个）。这里重要的是，您将获取的字段限制为仅地图真正需要的地理字段：`id`, `latitude`, `longitude`。

这种 'fetch-all' 获取对我的应用程序的首次启动时间有重大影响（在“最旧的”iPhone 4 上，整个`Fetch + Parse-JSON-into-Core-Data`过程我有近 700 毫秒的时间，并且广泛的基准测试表明**它是 Core Data 并且它的插入是瓶颈**），但随后您就可以在设备上获得有关您所在位置的所有基本地理信息。

请注意，无论您使用什么策略，您**都应该执行一个有效地获取这些地理点的过程**：

`Place`想象一下具有以下字段结构的核心数据实体（preudo-Objective-C 代码）：

```
// Unique identificator
NSNumber *id,

// Geo info
NSNumber *latitude,
NSNumber *longitude,

// The rest "heavy" info  
NSString *name,
NSString *shortDescription,
NSString *detailedDescription, etc 
```

有效地获取地点意味着您只要求您的地点记录来自服务器的地理数据，以尽可能快地进行此镜像过程。

另请参阅此热门话题：[改进通过 JSON 将服务器数据库镜像到客户端数据库的过程？](https://stackoverflow.com/questions/17795759/improve-process-of-mirroring-server-database-to-a-client-database-via-json/18192797#18192797).

**聚类问题**超出了这个问题的范围，但仍然非常相关，并且会影响您用于整个过程的整个算法 - 我要在这里留下的唯一说明是，所有当前现有的聚类解决方案都需要您使用第二种策略 -您必须在使用将在地图上组织您的地点的聚类算法之前准备好所有地点 - 这意味着如果您决定使用聚类，则必须使用策略 #2。

聚类的相关链接：

[WWDC 2011 会议：使用 MapKit 在地理上可视化信息](https://developer.apple.com/videos/wwdc/2011/)，

[如何在 iOS 地图上高效显示大量数据](http://robots.thoughtbot.com/how-to-handle-large-amounts-of-data-on-maps)，

[kingpin](https://github.com/itsbonczek/kingpin) - 开源集群解决方案：高性能且易于使用。

* * *

> 是否可以缓存此信息，以便用户可以在离线模式下查看“他的城市”附近的地方？

是的，这两种策略都是这样做的：第一个策略缓存您在地图上看到的地方 - 如果您观察到柏林的地图部分，您将缓存柏林的部分......

使用第二种策略时：您将缓存有关您的地点的所有基本地理信息，并准备好在离线模式下绘制在地图上（假设 MapKit 缓存了您在离线模式下浏览的区域的地图图像）。

# sql-server - 在一个 sql 表中构建一个字符串并插入到另一个表中

> ID：12325230
> 
> 赞同：-1
> 
> 时间：2012-09-07T20:52:00.537
> 
> 标签：sql-server, tsql

假设我有一张`Name_Address`如下表：

```
CREATE TABLE [dbo].[Name_Address](
[First_Name] [nvarchar] (50)  NULL,
[Last_Name] [nvarchar] (50)  NULL,
[Address] [nvarchar] (50)  NULL,
[City] [nvarchar] (50)  NULL,
[State] [nvarchar] (50)  NULL,
[Zip] [nvarchar] (50)  NULL,
[Phone] [nvarchar] (50)  NULL,
[Cell] [nvarchar] (50)  NULL
) ON [PRIMARY] 
```

SQL中有没有一种方法可以构建一个字符串：

```
<First Name>John<Last Name>Smith<Address>1233 Your Street<City>Home Town<State>NY<Zip>123456-1234<Phone>111-111-1111<Cell>222-222-222 
```

并将其插入另一个表？

原始帖子未将 xml 标签显示为所需结果的一部分：没有代码格式化，标签被逐字解释并且不显示。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T20:55:09.257

您只需使用 将`+`值连接在一起。

```
INSERT INTO yourNewTable (newRecord)
SELECT First_Name + Last_Name + Address + City + State + Zip + Phone + Cell
FROM dbo.Name_Address 
```

或添加空格：

```
INSERT INTO yourNewTable (newRecord)
SELECT First_Name + ' ' + Last_Name + ' ' 
 + Address + ' ' + City + ' ' + State + ' ' + Zip 
 + Phone + ' ' + Cell
FROM dbo.Name_Address 
```

`FOR XML PATH`如果您想要 XML 格式，也可以使用：

```
select *
from name_address
for xml path 
```

# 见[SQL Fiddle with Demo](http://sqlfiddle.com/#!3/265d3/2)

或者您可以手动编码 XML 标签，如果您想将完整记录插入到另一个表中，您可以使用：

```
insert into yourNewTable (yourNewRecord)
select '<FirstName>'+[First_Name] 
  + '<Last_Name>'+[Last_Name] 
  +'<Address>'+[Address] 
  +'<City>'+[City] 
  +'<State>'+[State] 
  +'<Zip>'+[Zip] 
  +'<Phone>'+[Phone] 
  +'<Cell>'+[Cell]
from name_address 
```

# 参见[带有 Select Demo 的 Sql Fiddle](http://sqlfiddle.com/#!3/265d3/5)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T20:55:46.137

您可以使用 || 将字段连接在一起：

```
select First_name||' '||Last_Name||' '+Address . . .
from NameAddress 
```

要插入另一个表，您可以执行以下操作：

```
insert into AnotherTable
    select '<First Name>'||First_name||'<Last Name>'||Last_Name||'<Address>'+Address . . .
    from NameAddress 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T20:56:14.090

```
 INSERT INTO MyTable(MyString) 
   SELECT
    '<FirstName>'+[First_Name] + '<Last_Name>'+[Last_Name] +'<Address>'+[Address] +<City>+[City] +<State>+[State] +'<Zip>'+[Zip] +'<Phone>'+[Phone] +'<Cell>'+[Cell] 

    FROM [dbo].[Name_Address] 
```

# php - 反转 mysql_fetch_array 在 html 页面上的显示

> ID：12325233
> 
> 赞同：0
> 
> 时间：2012-09-07T20:52:32.667
> 
> 标签：php, mysql

我有一个讨论类型页面，用户可以在其中输入他们对不同主题的回复。为此，我有一个表名**回复**字段回复**ID、主题 ID、用户 ID、回复正文、时间**

在显示结果的页面上，我使用以下 php 命令：

```
$run = mysql_query("SELECT * FROM replies WHERE topicID = $topicnumber ORDER BY time DESC Limit 5");

while($data= mysql_fetch_array($run)){
// do formatting and display data 
} 
```

如您所见，该页面最初仅显示对某个主题的 5 条回复（之后，如果有兴趣，用户单击以访问显示所有回复的页面）。

问题是，上面的代码正确显示了最近的 5 个回复，但我想更改它的显示顺序。它在顶部显示最近的回复，并且在我们向下时显示较旧的回复，但我想更改此顺序，在底部显示最近的回复。

我想我在这里遗漏了一个非常简单的观点，因为大多数网站都有这个功能，最近大多数评论都会下降，但是嘿，“问题不大”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T20:58:32.467

我认为这在 sql 中并不容易。

我只需将结果加载到数组中并用于[`array_reverse()`](http://www.php.net/manual/en/function.array-reverse.php)反转顺序。然后您可以像现在一样遍历数组并显示值。

否则，我认为您需要进行 2 次查询，一次查询总金额，然后一次查询将结果集限制为最后一项`x`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T21:08:18.393

使用嵌套查询来反转 SQL 中的顺序：

```
SELECT *
FROM (
    SELECT * FROM replies WHERE topicID = $topicnumber ORDER BY time DESC Limit 5
) AS a
ORDER BY time ASC 
```

内部查询将返回您最近的 5 条记录，而外部查询将反转这 5 条的排序顺序。

# python - Python：从 mysql 表中选择时，元组索引必须是整数，而不是 str

> ID：12325234
> 
> 赞同：21
> 
> 时间：2012-09-07T20:52:43.760
> 
> 标签：python, mysql, tuples

我有以下方法，我从表中选择所有 id 并将它们附加到列表并返回该列表。但是当执行这段代码时，我最终得到元组索引必须是整数......错误。我已附上错误和打印出来的方法以及我的方法：

```
def questionIds(con):
    print 'getting all the question ids'
    cur = con.cursor()
    qIds = []
    getQuestionId = "SELECT question_id from questions_new"
    try:
        cur.execute(getQuestionId)
        for row in cur.fetchall():
            print 'printing row'
            print row
            qIds.append(str(row['question_id']))
    except Exception, e:
        traceback.print_exc()
    return qIds 
```

打印我的方法的作用：

```
Database version : 5.5.10 
getting all the question ids
printing row
(u'20090225230048AAnhStI',)
Traceback (most recent call last):
  File "YahooAnswerScraper.py", line 76, in questionIds
    qIds.append(str(row['question_id'][0]))
TypeError: tuple indices must be integers, not str 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-09-07T20:57:43.263

python 标准 mysql 库从 cursor.execute 返回元组。要获取您将使用的 question_id 字段`row[0]`，而不是`row['question_id']`. 这些字段的出现顺序与它们在 select 语句中出现的顺序相同。

提取多个字段的一种不错的方法是

```
for row in cursor.execute("select question_id, foo, bar from questions"):
    question_id, foo, bar = row 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-08-19T11:15:22.563

MySQLdb 模块中有多种游标类型。默认游标返回元组元组中的数据。当我们使用字典游标时，数据以 Python 字典的形式发送。这样我们就可以通过列名来引用数据。[来源](http://zetcode.com/db/mysqlpython/)

```
#!/usr/bin/python
# -*- coding: utf-8 -*-

import MySQLdb as mdb

con = mdb.connect('localhost', 'testuser', 'test623', 'testdb')

with con:

    cur = con.cursor(mdb.cursors.DictCursor)
    cur.execute("SELECT * FROM Writers LIMIT 4")

    rows = cur.fetchall()

    for row in rows:
        print row["Id"], row["Name"] 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-08-30T00:00:04.187

我知道这个问题很老，但我找到了另一种方法，我认为它比公认的解决方案更好。所以我就把它留在这里以防万一有人需要它。

创建光标时，您可以使用

```
cur = connection.cursor(dictionary=True); 
```

这将使您无需任何其他修改即可完全按照您的意愿行事。

```
rows = cur.fetchall()
for row in rows:
    print "%s %s %s" % (row["Id"], row["Name"], row["Price"]) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-05-22T23:45:52.903

你可以在这里看到：在此处[输入链接描述](http://zetcode.com/db/sqlitepythontutorial/)，我认为这是你想要的

```
#!/usr/bin/python
# -*- coding: utf-8 -*-

import sqlite3 as lite

con = lite.connect('test.db')    

with con:

    con.row_factory = lite.Row # its key

    cur = con.cursor() 
    cur.execute("SELECT * FROM Cars")

    rows = cur.fetchall()

    for row in rows:
        print "%s %s %s" % (row["Id"], row["Name"], row["Price"]) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-12-23T13:03:32.163

要从数据库中检索数据，请使用字典游标

```
import psycopg2
import psycopg2.extras
con = psycopg2.connect(database="test", user="test", password="test", host="localhost", port="5432")
if con != None:
    print "Connection Established..!\n"
else:
    print "Database Connection Failed..!\n"

cur = con.cursor(cursor_factory=psycopg2.extras.DictCursor)

cur.execute("SELECT * FROM emp")
rows = cur.fetchall()
for row in rows:
    print "%s %s %s" % (row["id"],row["name"],row["address"])

print "\nRecords Display Successfully"
con.commit()
con.close() 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-05-05T05:28:10.127

不允许使用整数索引。为了让它工作，你可以声明如下指定的 DICT：

```
VarName = {} 
```

希望这对你有用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-07T20:55:21.893

`row`是一个元组。当你这样做时`row['question_id']`，你试图使用一个字符串索引来访问一个元组，这会给你一个错误。

# jquery - 使用 jquery 过滤和删除

> ID：12325238
> 
> 赞同：1
> 
> 时间：2012-09-07T20:53:14.483
> 
> 标签：jquery, regex, filter

我在 jQuery 中过滤时遇到了一些问题：

```
<div>content: content: {"bla":"test","IMPORTANT"}</div>

  <button>Remove</button>
<script>
    $("button").click(function () {
      $("div").remove(":contains('content: content: {\"bla\":\"test\",\"')");
    });

</script> 
```

所以，onClick整个div都被删除了，我只想删除指定的部分，怎么办？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T20:54:45.163

如果要删除 div 中的内容，请选择 div，然后使用 将其内容设置为空字符串`text()`。

```
$("div").text(""); 
```

**编辑：**

显然你想保留部分文本。为此，您可以使用正则表达式来捕获您想要的文本。以马克的回答为基础：

```
$div = $("div");
str = $div.text()
str = str.replace(/.*?,"(.*)"\}$/, "$1");
$div.text(str) 
```

这是一个[jsfiddle](http://jsfiddle.net/tAM8C/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T21:00:33.387

您将需要对该 div 的内容进行一些字符串操作。然后用你的结果更新 div 的文本。例子：

```
$div = $("div:contains('content: content: {\"bla\":\"test\",\"')")
str = $div.text()
str = str.replace(/your regex goes here/, "")
$div.text(str) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T21:21:03.210

如果 div 的内容总是以相同的方式出现，下面的代码将成为一个解决方案

```
 $("button").click(function () {
      var string = $("div").text();
        var arr = string.split(":");
        var arr1 = arr[3].split(",");
        var string1 = (arr1[1].replace("\"","")).replace("\"}","");
    $("div").text(string1);
    }); 
```

查看[Fiddle](http://jsfiddle.net/2Gcy9/)
**EDITED FIDDLE 中的演示：http:** [//jsfiddle.net/2Gcy9/1/](http://jsfiddle.net/2Gcy9/1/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T20:55:20.583

```
 $("button").click(function () {

  $("div:contains('content: content: {\"bla\":\"test\",\"')").text("");

 }); 
```

# python - 如何在 Mac 上安装多部分 python 程序？

> ID：12325239
> 
> 赞同：0
> 
> 时间：2012-09-07T20:53:18.557
> 
> 标签：python, macos, wxwidgets, pyserial

最后为我的产品制作了一个合法的 mac 安装程序。我已经使用 Inno 安装程序制作了一个成功的 Windows 安装程序。我不确定如何在 Mac 中执行此操作。

这必须发生： -Python 已安装 -Wx 已安装 -Py 串行已安装 -程序已复制 -快捷方式已创建。我以前用 Bash 脚本来做这件事，但我的客户一直在抱怨这些。也许 X-code 软件包制造商是解决方案？我知道推荐的方法是“只复制文件”，但必须以某种方式安装这些库。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-08T00:36:26.780

除非我使用 Fink 来安装软件包，否则我通常只从源代码下载 .tar.gz 文件，然后从终端安装它，该文件位于包含 install.py 文件的解压缩文件夹中。终端命令：

```
sudo python ./setup.py install 
```

如果你愿意，我可以向你展示如何设置和使用 Fink，这是另一种安装包/库的简单方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-08T00:50:43.187

tl;dr: [py2app](http://pypi.python.org/pypi/py2app/)将从你的 Python 脚本中创建一个独立的应用程序包，使得使用“仅复制文件”安装过程变得非常容易。您需要的库已捆绑到应用程序包本身中，因此无需在系统范围内安装它们。

另请查看wxPython wiki 中的[Optimizing for Mac OS X](http://wiki.wxpython.org/Optimizing%20for%20Mac%20OS%20X)；它提供了有关使用 py2app 的好技巧以及有关构建 Mac 友好的 Python 应用程序的其他有用信息。

* * *

在 OS X 上，程序通常通过以下三种方式之一安装：Mac App Store、软件包安装程序 (.pkg/.mpkg) 或磁盘映像上的可复制应用程序包（.dmg 中的.app）。每个都有其优点和缺点。

Mac App Store 要求您订阅 Apple 的限制和要求，对于期望更广泛分发的应用程序来说，这可能是一个不错的选择（尽管如今，它可能是轻松接触更广泛受众的好方法）。可复制的应用程序包是迄今为止最简单的 App Store 之前的安装方法，并且仍然是更流行的安装程序的方法之一。最后，安装程序包是一种用户友好的方式来安装更复杂的程序，而不是简单的应用程序包（例如系统服务、特定目录中的文件、系统相关组件、高级安装逻辑等）。不过，我应该指出，确实存在复杂的应用程序，它们作为应用程序包发布，并在首次运行时执行大部分“安装”。

我对 Mac App Store 的体验有限，所以我不会谈论它。您可以在[官方网站上](https://developer.apple.com/programs/mac/distribution.html)找到更多详细信息。

Python 非常适合作为应用程序包发布。您可以使用[py2app](http://pypi.python.org/pypi/py2app/)为程序自动创建应用程序包，然后使用磁盘工具将该包放入 Mac 磁盘映像 (.dmg) 以创建完整的安装包。这不支持创建快捷方式，但在 OS X 上，用户通常只需将应用程序放入 /Applications 并根据需要自行创建必要的停靠快捷方式。

下一个方法是制作一个元包 (.mpkg)，它将使用 OS X 标准安装程序实用程序进行安装。这符合用户对 Mac 应用程序的期望。IIRC，Mac Python 和 wxPython 都已经作为 .pkg 提供，这应该可以更容易地将它们集成到元包中。`bdist_mpkg`可以帮助为 pyserial 和您自己的程序制作包，这些包可以添加到元包中。最后，使用第三方`dockutil`脚本，可以自动添加停靠快捷方式。但是请注意，安装程序通常不会向 Dock 添加快捷方式；将程序安装到`/Applications`目录中更为常见。`

# html - 包含标记 INSIDE 数据

> ID：12325240
> 
> 赞同：1
> 
> 时间：2012-09-07T20:53:23.703
> 
> 标签：html

是的，我正在努力从我们的数据库中显示包含标记的数据！我正在显示的一个特定字段有一个开放的粗体标签，但没有关闭的粗体标签。我试图“包含”这个标记，所以它不会影响页面的其余部分。

来自我的数据库的数据是这样的文本：

```
this is soem nasty <b>data 
```

（注意缺少结束</b>标签）

如果我将标记包含在 div 中，则页面的其余部分为粗体：

```
<div>this is some nasty <b>data</div> 
```

但是，如果我将它包装在这样的表中：

```
<table><tr><td>this is some nasty <b>data</td></tr></table> 
```

一切都很好！事实上，FF (FireBug) 和 IE9 的 DOM 检查器都显示了树。在 div-case 中，它显示了 open-b 标记和其中包含的文档的其余部分。但桌子似乎把它包围起来。

我怎样才能让它在没有桌子的情况下“关闭 b”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T20:56:22.840

你正确地使用结束`</b>`标签，就像任何理智的人一样。

您可以使用`DOMDocument`and`tidy`尝试修复格式错误的标记，以防您无法控制它，但最好在它到达数据库之前修复它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T13:18:57.843

I took a cue from HTML rich-text editors like TinyMCE and built up an IFrame. It seems to contain the arbitrary, possibly-mal-formed content better.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T20:57:21.470

我在某处读到[HTML Purifier](http://htmlpurifier.org/)应该能够实现这一点。可能值得一试。

# node.js - node.js 参数隐藏

> ID：12325241
> 
> 赞同：0
> 
> 时间：2012-09-07T20:53:25.733
> 
> 标签：node.js

我正在测试 node.js 中的回调机制，以查看触发回调的上下文。在运行以下代码时，我注意到一个奇怪的行为，我想知道你是否能解释一下：

```
var outID =2;

var closure = function (){
    var that = {};
    that.id = 1;
    outID = 3; //if line is commented out outID will always be 2.
    that.inside  = function(cb){
        console.log("level 0");
        console.log("thatID:" +that.id);
        console.log("outID:" +outID);
        setTimeout(function(){
            console.log("level 1");
            console.log("thatID:" +that.id);
            console.log("outID:" +outID);
            setTimeout(function(){
                setTimeout(cb,0,that.id);
            },0);
        }, 0);
    };
    return that;
};
var level3  = function(id){
    console.log("level 100S");
    console.log("id " + id);
    console.log(outID); // --- Interesting value is 3.
};
var cl = new closure();
cl.inside(level3); 
```

输出是：

```
node: no process found
level 0
thatID:1
outID:3
level 1
thatID:1
outID:3
level 100S
id 1
3
[Finished in 0.1s] 
```

为什么最后一个值是 3 而不是 2 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T21:12:36.037

`outID``var`在顶级范围内声明（即使用关键字），并且从未在任何其他（函数）范围内重新声明。这意味着当它被分配到任何地方时，它正在写入同一个变量，而当它被引用时，它在任何地方都从同一个变量中读取。

为了防止`outID=3`内部函数中的行更改最后打印的值，您可以将其更改为`var outID=3`.

编辑：

发布的代码具有以下范围：

```
global 
    closure
         that.inside
             $anonymous1 (outer setTimeout argument)
                  $anonymous2 (inner setTimeout callback)
    level3 
```

正如希望更清楚的那样，函数作用域继承自*定义*它的作用域，而不是*调用*它的作用域。当然，您可能会将范围与 的值混为一谈`this`，这是另一回事...

# r - 关于两个csv文件的交集、并集和不对称差异

> ID：12325243
> 
> 赞同：-1
> 
> 时间：2012-09-07T20:53:33.133
> 
> 标签：r

我有两个 csv 文件，它们共享一些常见的列。有没有办法得到这两个文件的交集、并集和不对称差异？对于这两个文件，第一行是文本字符，其他行只是 0 或 1。

csv文件就像

一个.csv

> 美国广播公司
> 
> 0 0
> 
> 1 0
> 
> 0 1

B.csv

> 替代录音
> 
> 1 0
> 
> 1 0
> 
> 0 1

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T23:23:41.820

这在较早的问题中得到了回答： [如何在有序对上进行相交、联合等？](https://stackoverflow.com/questions/9719436/how-to-do-intersect-union-etc-on-ordered-pairs/9719699#9719699)

确实没有理由将其限制为成对。您可以将任意数量的向量粘贴在一起以形成索引。实际上，我已将您的第二个问题转换为第一个问题。

# ios - iOS：数据处理

> ID：12325253
> 
> 赞同：0
> 
> 时间：2012-09-07T20:54:29.857
> 
> 标签：ios, model-view-controller

**解释**

我的应用程序基本上使用了一个地图视图，上面覆盖了代表建筑物的多边形，再加上一个注释。因此，为此它导入了一个名为 Annotation 的自定义类，该类在点击注释时处理弹出详细信息，这意味着它存储了建筑物的名称和地址。此时标注（蓝色显示按钮）加载了一个空的 DetailViewController 对象（因为实际上没有任何数据要通过）。

我很快以可搜索表的形式添加了一个新功能，它加载了 Building 类的自定义对象（具有与 Annotation 类似的属性，以及图像和更多细节），然后加载到前面提到的 DetailViewController 类以及建筑物的详细信息中。

总而言之，MapVC 包含多个注释，当点击相关的公开按钮时会打开 DetailVC。SearchVC 可以通过 MapVC 上的按钮访问，并且有一个 Building 对象表，该表会加载一个带有相关数据的 DetailVC，如下所示：

![应用程序功能的基本图](../Images/adb2b558318481d4be46a81a5e79d9d5.png)

**下一步**

所以现在我想在标注上的蓝色披露按钮中实现功能，所以当用户点击它时，它会加载建筑细节。目前它只有注释的详细信息。我可以将额外的属性添加到注释中以使其完整，但我认为只使用一个名为 Building 的自定义类会更好，它具有 MKAnnotation 特性。然后为注解和 searchVC 的表加载这个 Building 类。

**问题**

那么最后，解决这个问题的最佳方法是什么？我希望所有数据都独立于图中的任何 VC 进行存储。我遵循了 Apple 的教程（BirdSighting 教程），它使用了一个单独的 Datacontroller 类，然后我将其加载到其他类中。这是最好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T21:02:21.653

你说的是 MVC，模型-视图-控制器。这是一种非常聪明的处理方式，也是一种很好的实践。模型存储数据，在这种情况下是建筑物名称等。视图显示数据。控制器将视图连接到模型，更新视图，从用户那里获取通知，进而更新模型。

我对模型数据使用单例模式。应用程序中只有一个单例实例。这样，数据就不会绑定到任何一个特定的视图控制器。数据只在一个地方更新，模型。使用应用程序数据对象的单一收敛点解决问题要容易得多。

我有一个在我的 PCH 文件中定义的宏。

```
#import "DataController.h"

#define DATA() [DataController sharedInstance] 
```

在我的代码中，我可以通过调用轻松进入我的模型类

```
DataController *data = DATA(); 
```

我所有的视图和视图控制器都访问存储在 DataController 中的对象，因此从来没有两个视图控制器独立处理单独的信息。所有引用都指向同一个地方。

有些人使用 AppDelegate 对象来存储数据，但它可以很快变成一个 1000 行的野兽。我更喜欢保持 AppDelegate 干净:-)

# jquery - for循环中的Jquery计数器

> ID：12325258
> 
> 赞同：1
> 
> 时间：2012-09-07T20:54:50.700
> 
> 标签：jquery, counter

我正在尝试在 jquery 中创建一个类似这样的计数器...

```
for(counter = 1;counter<4;counter++){
} 
```

这行得通吗？

好吧，我只是说循环作为测试...我最终要做的是从此代码中删除重复的图像...

```
 // Preloads images within a rel group
            if (settings.preloading) {
                preload = [
                    getIndex(-1),
                    getIndex(1)
                ];
                while (i = $related[preload.pop()]) {
                    src = $.data(i, colorbox).href || i.href;
                    if ($.isFunction(src)) {
                        src = src.call(i);
                    }
                    if (isImage(src)) {
                        img = new Image();
                        img.src = src;
                    }

                } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T20:57:52.180

是的，我会的

```
for (var counter = 0; counter < 4; counter++) { 
```

更明确。

# ruby-on-rails - rails 3 formtastic 水平对齐单选按钮

> ID：12325262
> 
> 赞同：0
> 
> 时间：2012-09-07T20:55:06.743
> 
> 标签：ruby-on-rails, formtastic

如何让单选按钮水平对齐？例如：

```
<%= f.input :rating, :as => :radio, :collection => [["1", 1], ["2", 2], ["3", 3]] %> 
```

显示为，

评分

[ ] 1

[ ] 2

[ ] 3

我想：

评分 [ ] 1 [ ] 2 [ ] 3

更新：通过添加修复

```
.formtastic fieldset > ol >li.radio fieldset ol li {
  margin:0.1em 0.5em 0.5em 0;
  display: inline-block;
} 
```

到 active_admin.css.scss

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T21:04:54.697

从关于[css 定制](https://github.com/justinfrench/formtastic/wiki/6.1-Customize%3a-CSS#wiki-Example)的 formtastic wiki和[这里](https://github.com/justinfrench/formtastic/pull/516)，似乎 css 是这样做的方法。

# .htaccess - htaccess：为什么 301 重定向不适用于单个页面，但通常适用于所有页面？

> ID：12325272
> 
> 赞同：0
> 
> 时间：2012-09-07T20:55:33.047
> 
> 标签：.htaccess, redirect

它适用于所有页面：

```
Options +FollowSymLinks
RewriteEngine on
RewriteBase /
RewriteRule (.*) http://www.newdomain.ru/somepage/ [R=301,L] 
```

但我想重定向单页。此代码不执行重定向：

```
Options +FollowSymLinks
RewriteEngine on
RewriteBase /
RewriteRule ^thePageOnOldDomain.php?someGetParameter=1 http://www.newdomain.ru/somepage/ [R=301,L] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T22:45:37.333

在重写规则中，您无法匹配查询字符串（？之后的所有内容）。使用 %{QUERY_STRING} 各种

```
RewriteCond %{QUERY_STRING} someGetParameter=1
RewriteRule ^someoldpage.php$ http://newdomain.ru/ [L,R=301] 
```

# javascript - JavaScript 中更简单的“类”定义

> ID：12325276
> 
> 赞同：0
> 
> 时间：2012-09-07T20:55:53.937
> 
> 标签：javascript, object, ecmascript-5

我注意到在 ECMAScript 标准中你有类似的东西`defineProperty`，就像在 JavaScript 对象中定义属性和什么不是，`prototype`它通过使用方法和什么来扩展对象。有没有一个速记可以带你：

```
Object.defineProperty(Person,"name",{
    type : "string",
    get : function(){ return this.$d.name; },
    set : function(_v){ this.$d.name = _v }
}) 
```

像这样简单的事情：

```
function Person(args){
// ... snip ...

this.defineProperty("name",{
   get : function() { return $d.name },
   set : function(_v) { $d.name = _v; },
   type : "string"
});

// ... snip ...
} 
```

我很确定，借助 JavaScript 的魔力，有一种更简单的方法。但我可能只是懒惰。任何指针？

**注意：**我正在避免使用 CoffeeScript，它过多地提醒了 Ruby，恕我直言。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T21:14:15.333

您可以扩充`Object.prototype`以实现此目的：

```
Object.defineProperty( Object.prototype, "defineProperty", {
    value: function( name, pd ) {
        return Object.defineProperty( this, name, pd );
    },

    enumerable: false
}); 
```

# android - 如何访问从两个独立数据库的行中存储的具有共同字段值的数据？

> ID：12325278
> 
> 赞同：0
> 
> 时间：2012-09-07T20:56:05.263
> 
> 标签：android

*嗨，我是android开发的新手，我不是专业人士，你很快就会发现，无论如何这是我遇到的问题：我有两个数据库，即1->DatabaseClass和2->TransactionDatabase数据库DatabaseClass有bank_name 字段和 account_number 的条目（以及其他，但此时无关紧要）。TransactionDatabase 也有一个bank_name 和account_number 字段。交易端的微调器项保存所有银行名称的列表，这些名称是通过使用游标从 DatabaseClass 访问的。从微调器中选择的项存储在 TransactionDatabase 中。现在用户在 TransactionDatabase 中输入所选银行的帐号。如果该银行的帐号与数据库“DatabaseClass”中添加的帐号相匹配，应从两个表中提取包含在具有该“特定”帐号的“特定”行中的所有字段，并应将其插入不同的字符串中。如何比较 account_numbers ？，我收集了包含在交易侧名为“帐号”的编辑文本字段中的文本。还选择了 spinner 的银行名称。现在如何从与该银行名称对应的“DatabaseClass”中获取帐号以进行比较？我用它在微调器中设置银行名称：* 交易侧的帐号”。还选择了微调器中的银行名称。现在如何从与该银行名称对应的“DatabaseClass”中获取帐号以进行比较？我用它在微调器中设置银行名称：* 交易侧的帐号”。还选择了微调器中的银行名称。现在如何从与该银行名称对应的“DatabaseClass”中获取帐号以进行比较？我用它在微调器中设置银行名称：*

```
 SimpleCursorAdapter myAdapter;

    Cursor cursor = myDatabase.getData();
    cursor.moveToFirst();           
    myAdapter = new SimpleCursorAdapter(AddTransaction.this,
                R.layout.spinnerlayout, cursor,
                new String[] { DatabaseClass.KEY_BANK_NAME_ID, },
                new int[] { R.id.bankName });
    mySpinner.setAdapter(myAdapter); 
```

*到目前为止，我能够通过数据库 DatabaseClass 获得从微调器中选择的项目的位置，请帮助我，我很困惑。*

```
 int item = mySpinner.getSelectedItemPosition();
    Cursor cursor = myDatabase.getData();
    cursor.moveToPosition(item); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T22:05:18.767

您的选择：

1.  合并两个数据库，在一个数据库中使用单独的表，并在 foreign_key 上连接表。（首选）
2.  子类游标适配器以采用多个游标。
3.  创建一个实现游标并存储对两者的引用的自定义类，并创建一个访问两个表以填充它的自定义帮助器类。

# java - 允许我正确运行使用 cin 的 C++ 代码的网站？

> ID：12325280
> 
> 赞同：2
> 
> 时间：2012-09-07T20:56:15.323
> 
> 标签：java, c++

有没有可以在线运行 Java 或 C++ 代码的网站，可以让我`cin`在 C++ 中使用？键盘和许多其他的只是让你看到你的程序，但不让用户提供输入，我想知道我是否能找到一个允许这样做的网站。

Ideone 似乎没有正确输入：这应该是一个游戏，您输入一个单词，然后字母改变位置，然后您需要找出单词。代码是正确的，但网站没有正确读取 cin ！[http://ideone.com/0PmDX](http://ideone.com/0PmDX)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-07T20:58:38.987

[Ideone 就是这样做](http://ideone.com/)的，这也在[c++](/questions/tagged/c%2b%2b "显示标记为“c++”的问题")标记的 Info 部分中。

在您提供的代码中：[http://ideone.com/0PmDX](http://ideone.com/0PmDX)您调用`return main();`这是未定义的行为，并导致您的代码中的无限循环。试试`return 0`吧。

代码：http: [//ideone.com/ymXeH](http://ideone.com/ymXeH)

# html - HTML 列表中的字母/数字组合是否可能？

> ID：12325284
> 
> 赞同：2
> 
> 时间：2012-09-07T20:56:34.320
> 
> 标签：html, html-lists

很简单，我想要一个有序列表像这样工作：

```
 1\. Foo
 2\. Bar
3a. Baz
3b. Qux
 4\. Etc... 
```

有什么方法可以轻松地在 HTML 中按照这些方式做一些事情吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T21:45:00.873

鉴于以下标记：

```
<ol>
    <li>Foo</li>
    <li>
        <ol>
           <li>bar</li>
           <li>baz</li>
        </ol>
    </li>
    <li>Something else...</li>
</ol>​ 
```

下面的 CSS*几乎*可以工作：

```
ol {
    counter-reset: topLevel;
}

li {
    counter-increment: topLevel;
    margin-left: 1em;
}

li::before {
    content: counter(topLevel) '. ';
    margin-right: 0.3em;
}

ol ol {
    counter-reset: secondLevel;
}

ol ol li {
    counter-increment: secondLevel;
}

ol ol li::before {
    content: counter(topLevel) counter(secondLevel, lower-alpha) '. ';
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/5zLpg/)。

到目前为止，唯一的问题是它包含`topLevel`对内部`li`元素（如您所愿）和外部`li`（包含那些内部元素）的计数，所以......还没有。

并且上述问题解决了！...在那些支持 CSS`:not()`选择器的浏览器中：

```
ol {
    counter-reset: topLevel;
}

li {
    counter-increment: topLevel;
    margin-left: 1em;
}

li:not(.hasChild)::before {
    content: counter(topLevel) '. ';
    margin-right: 0.3em;
}

ol ol {
    counter-reset: secondLevel;
}

ol ol li {
    counter-increment: secondLevel;
}

ol ol li::before,
ol li.hasChild ol li::before {
    content: counter(topLevel) counter(secondLevel, lower-alpha) '. ';
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/5zLpg/2/)。

[我（最初）忘记了要注意，要使其正常工作（因为](http://dev.w3.org/csswg/selectors4/#subject)CSS 还没有父选择器（到目前为止），我必须向`li`具有子元素的那些元素添加一个特定的类`ol`，以便适当地隐藏数字的重复。在这种情况下，我选择了类名`.hasChild`（如 Fiddle 所示）。

顺便说一句，对规则的一个小改动`li:not(.hasChild)::before`，允许右对齐的文本：

```
li:not(.hasChild)::before {
    content: counter(topLevel) '. ';
    width: 2em;
    margin-right: 0.3em;
    display: inline-block;
    text-align: right;
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/5zLpg/4/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T21:27:47.517

它不能完全满足您的要求，并且需要对您的 html 进行一些（烦人的）更改，但我认为它与您将得到的差不多。

[http://jsfiddle.net/qGCUk/30/](http://jsfiddle.net/qGCUk/30/)

```
<ol>
    <li>one</li>
    <li class="has_children">
        <ol>
           <li>two.one</li>
           <li>two.two</li>
           <li>two.three</li>
        </ol>
    </li>
</ol> 
```

* * *

```
ol,li{
   padding:0;
   margin:0;    
}
ol { counter-reset: item }
li { display: block; padding-left: 0 }
li:before { 
    content: counters(item, ".") " "; 
    counter-increment: item 
}
LI.has_children:before { 
    content: " "; 
    counter-increment: item 
} 
```

这只是数字，因为我认为您不能混合数字和字母。而且由于没有选择器可以选择并且`li`其中包含 and `ol`，因此您必须将一个类添加到任何`li`具有 child的类`ol`。

# javascript - 设置适当的视口，兼容 ios 和 android，适用于旋转

> ID：12325286
> 
> 赞同：5
> 
> 时间：2012-09-07T20:56:36.180
> 
> 标签：javascript, android, ios, web-applications, viewport

我有一个问题，我已经看到了被问到的不同部分，但我还没有找到一个在 iOS 和 android 上正常工作的简明工作答案（我现在正在专门测试 iPad、iPad2、Android 手机和 iPod Touch） . 所以我所拥有的是一个可扩展的网站，效果很好。我希望能够指定站点的最小宽度为 480 像素，最大宽度为 1014 像素，中间的任何内容都将保持原样。这是我当前的代码：

viewportWidth 由 window.screen.width 计算 minwidth 是一个变量 (480) maxwidth 是一个变量 (1014)

下面的代码在被触发的设备旋转事件上调用。

注意：我在下面的源代码中留下了一些注释代码，以显示我尝试过的内容

非常感谢任何帮助，我的代码确实有效，但我发现在较小的设备上我必须缩小一点，因为页面在视口之外（即使它不应该）。偶尔旋转几次可以解决这个问题......

```
/*Set initial Sizes*/
        if( viewportWidth > maxWidth){
            //dont adjust since it may be desktop
            viewportWidth = maxWidth;
            $('meta[name="viewport"]').attr('content', 'initial-scale=1.0; width=device-width'  );

            //viewport = document.querySelector("meta[name=viewport]");
            //viewport.setAttribute('content', 'width=' +  maxWidth + '; initial-scale=1.0; user-scalable=1;');

        }else if( viewportWidth > minWidth && viewportWidth < maxWidth ){
            $('body').removeClass('mobile');
            $('body').addClass('desktop');
            $('meta[name="viewport"]').attr('content', 'initial-scale=1.0; width=device-width' );

            //viewport = document.querySelector("meta[name=viewport]");
            //viewport.setAttribute('content', 'width=' + window.screen.width + '; initial-scale=1.0; user-scalable=1;');

            isMobile = 0;

        }else if( viewportWidth <= minWidth ){  

            if( /iPhone|iPad|iPod/i.test(navigator.userAgent)  ) {
                $('meta[name="viewport"]').attr('content', 'initial-scale =' + (window.screen.width / minWidth ).toFixed(2)  ); 
            }else{
                $('meta[name="viewport"]').attr('content', 'initial-scale = '  + (window.screen.width / minWidth ).toFixed(2)  + '; width=device-width');
            }

            //viewport = document.querySelector("meta[name=viewport]");
            //viewport.setAttribute('content', 'initial-scale = '  + (window.screen.width / minWidth ).toFixed(2)  + '; width=' + minWidth  + '; initial-scale=1.0; user-scalable=1;');

            $('body').removeClass('desktop');
            $('body').addClass('mobile');

            //$('#pageBody').width(minWidth );
            viewportWidth = minWidth ;

            isMobile = 1;   

        } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-05T20:42:01.670

没有人回答，所以这是可行的

1，对css使用媒体查询 2，使用这个脚本来修复缩放

```
<meta id="Viewport" name="viewport" width="initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">

<script type="text/javascript">
$(function(){
if( /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) ) {
  var ww = ( $(window).width() < window.screen.width ) ? $(window).width() : window.screen.width; //get proper width
  var mw = 480; // min width of site
  var ratio =  ww / mw; //calculate ratio
  if( ww < mw){ //smaller than minimum size
   $('#Viewport').attr('content', 'initial-scale=' + ratio + ', maximum-scale=' + ratio + ', minimum-scale=' + ratio + ', user-scalable=yes, width=' + ww);
  }else{ //regular size
   $('#Viewport').attr('content', 'initial-scale=1.0, maximum-scale=2, minimum-scale=1.0, user-scalable=yes, width=' + ww);
  }
}
});
</script> 
```

# vim - 在 VimScript 中解析日期

> ID：12325291
> 
> 赞同：5
> 
> 时间：2012-09-07T20:57:20.213
> 
> 标签：vim, viml

给定一个“2012-09-31”形式的日期字符串，我想要一个 vimscript 函数来解析它，这样我就可以计算相对日期。欢迎使用纯 vimscript 或 python 解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T22:09:08.530

对于日期的正常模式操作，Tim Pope 提供了出色的[SpeedDating](https://github.com/tpope/vim-speeddating)插件。原则上应该可以提取该插件的一些内部功能以在其他脚本中使用，但我不知道这在实践中有多容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T23:18:50.420

对于它的价值，这是我目前的解决方案。欢迎提出更好的建议或改进。

```
function! AdjustDate(date, offset)
python << EOF
import vim
import datetime

result = datetime.datetime.strptime(vim.eval("a:date"), "%Y-%m-%d") + \
        datetime.timedelta(days=int(vim.eval("a:offset")))
vim.command("let l:result = '" + result.strftime("%Y-%m-%d") + "'")
EOF
return result
endfunction 
```

# node.js - 空 HTTP 响应

> ID：12325295
> 
> 赞同：0
> 
> 时间：2012-09-07T20:57:44.667
> 
> 标签：node.js

由于某种原因，此代码一直失败：

```
var http = require('http');
var url = require ('url');
var jade = require('jade');
var fs = require('fs');

http.createServer(function(req, res) {

  // Request handlers
  var path = url.parse(req.url, true).pathname;
  var dot = path.lastIndexOf('.');
  var extension = path.substr(dot + 1);

  // Response handlers
  switch(extension) {
    case 'css' :
      res.writeHeader(200, {"Content-Type": "text/css"});
      fs.readFile(path.substr(1, dot - 1) + '.css', function (err, css) {
        if(err) {
          res.write(err, 'utf8')
        };
        res.write(css, 'utf8')
      });
      break;
    case 'js' :
      res.writeHeader(200, {"Content-Type": "text/javascript"});
      fs.readFile(path.substr(1, dot - 1) + '.js', function (err, js) {
        if(err) {
          res.write(err, 'utf8')
        };
        res.write(js, 'utf8')
      });
      break;
    default :
      res.writeHeader(200, {"Content-Type": "text/html"});
      jade.renderFile(path.substr(1, path.length) + '.jade', { title: 'test' }, function(err, html) {
        if(err) {
          res.write(err, 'utf8')
        };
        res.write(html, 'utf8');
      });
      break;
  }

  res.end();

}).listen(8080); 
```

我没有收到任何错误，只是响应似乎是空的。有一个标题，但没有 css 或 javascript 文件。

我在 Jade 中链接它们的方式如下：

```
link(rel='stylesheet', href='/css/bootstrap.min.css')
link(rel='stylesheet', href='/css/style.css') 
```

先感谢您 ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T21:00:48.253

你打电话`res.end()`太早了。相反，将它`res.write()`放在每个`fs.readFile`处理程序的最后一个之后。

# c# - 如何在本地机器上调用 WCF 服务

> ID：12325299
> 
> 赞同：1
> 
> 时间：2012-09-07T20:57:55.517
> 
> 标签：c#, .net, wcf, mef, wcf-binding

我们有一个环境，其中多个 WCF 服务托管在防火墙后面的单个 VM 和（多个 VM 中）服务器场上。某些服务会调用其他服务。目前我们通过 http 调用这些服务。呼叫被路由到负载平衡器，每个呼叫被路由到任何一个虚拟机。

出于性能原因，我们想在本地机器上调用服务。如果可能，我们希望避免序列化和反序列化的开销并直接调用它（使用 MEF？）。我想知道其他人是如何处理这种情况的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T22:26:06.610

你能不能只为本地机器设置一个额外的端点。

[NetNamedPipeBinding 类](http://msdn.microsoft.com/en-us/library/system.servicemodel.netnamedpipebinding%28v=vs.100%29.aspx)

“提供安全可靠的绑定，针对机器上的通信进行了优化。”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T21:18:54.907

您必须将 Web 服务项目放到您的本地机器上，并在您的机器上为它创建一个虚拟目录，并从您的代码中指向它，然后您可以在本地指向它并调试..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T21:19:21.240

您可以在本地计算机上启动服务并修改配置文件以仅在调试模式下使用本地主机，在发布模式下使用生产虚拟机。

# ruby - Ruby 以十六进制形式发送字符串变量

> ID：12325303
> 
> 赞同：0
> 
> 时间：2012-09-07T20:58:07.733
> 
> 标签：ruby, string, hex

我如何将变量表示为十六进制以发送like-

```
a='00'
write("\x#{a}") => 0x00 
```

试图将接收到的字符串变量包含到原始数据的命令字符串中并传递给 com 端口，如 -

```
cmd="\x45\x#{a}\x01"
Send(cmd) 
```

在红宝石中

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T22:06:30.503

[String#to_i](http://www.ruby-doc.org/core-1.9.3/String.html#method-i-to_i)函数接受一个基本参数，默认为 10 - 但您可以传入 16。这将为您提供您想要的数字，而不是字符串。从那里，您可以使用[Integer#chr](http://www.ruby-doc.org/core-1.9.3/Integer.html#method-i-chr)函数来获取您想要的值 - 一个字符串，其中包含由原始字符串表示的二进制值的字符。

# r - GUI在R中对数据框进行子集化

> ID：12325305
> 
> 赞同：3
> 
> 时间：2012-09-07T20:58:09.033
> 
> 标签：r, user-interface, filter, subset, gwidgets

我正在 R 中构建一个自定义 GUI 来工作，我需要一个可以根据变量值选择数据框子集的部分（即选择所有 50 岁以上的女性等）。我正在使用 gwidgets 构建 GUI，但我对如何实现此过滤器感到困惑。具体如何创建一个允许用户选择一个或多个过滤器然后返回过滤后的数据框的小部件。

这是我正在使用的数据中的一个小样本：

```
structure(list(kunde = c(3, 3, 3, 3, 3, 3, 3, 1, 3, 3), 
               bank = c(7,98, 3, 3, 98, 2, 2, 1, 7, 2)),
          .Names = c("kunde", "bank"), row.names = c(NA, 10L), class = "data.frame") 
```

任何帮助是极大的赞赏！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T21:53:24.177

包中有一些类似的东西的例子`ProgGUIinR`。这是其中之一：

```
library(gWidgets)
options(guiToolkit="RGtk2")
options(repos="http://streaming.stat.iastate.edu/CRAN")
d <- available.packages()       # pick a cran site

w <- gwindow("test of filter")
g <- ggroup(cont=w, horizontal=FALSE)
ed <- gedit("", cont=g)
tbl <- gtable(d, cont=g, filter.FUN="manual", expand=TRUE)

ourMatch <- function(curVal, vals) {
  grepl(curVal, vals)
}

id <- addHandlerKeystroke(ed, handler=function(h, ...) {
  vals <- tbl[, 1, drop=TRUE]
  curVal <- svalue(h$obj)
  vis <- ourMatch(curVal, vals)
  visible(tbl) <- vis
}) 
```

出于您的目的，您可能希望使用`gcheckboxgroup`或`gcombobox`选择因子水平或水平并按此过滤。关键是对象的`visible<-`方法`gtable`用于过滤显示的项目。

如果你是游戏玩家，你可以试试我的 github 网站上的`gfilter`小部件（也可以从 devtools使用）。这可能正是您想要做的。`gWidgets2``install_packages("gWidgets2", "jverzani")``gWidgets2RGtk2`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T21:21:06.683

使用您的数据对象并测试其中一个变量，这是一个简化版本`subset.data.frame`：

```
tmp <- 
structure(list(kunde = c(3, 3, 3, 3, 3, 3, 3, 1, 3, 3), bank = c(7, 
98, 3, 3, 98, 2, 2, 1, 7, 2)), .Names = c("kunde", "bank"), row.names = c(NA, 
10L), class = "data.frame")

 getsub <- function(obj, logexpr) if (missing(logexpr)) {return(obj)
        } else {e <- substitute(logexpr)
         r <- eval(e, obj, parent.frame())
         if (!is.logical(r)) 
             stop("'subset' must evaluate to logical")
         r <- r & !is.na(r)
         obj[r, ] }

 getsub(tmp, bank <50)
#--------------
   kunde bank
1      3    7
3      3    3
4      3    3
6      3    2
7      3    2
8      1    1
9      3    7
10     3    2 
```

# php - 在 ob_get_contents 中通过 Jquery/Javascript 设置数据

> ID：12325308
> 
> 赞同：0
> 
> 时间：2012-09-07T20:58:23.343
> 
> 标签：php, jquery

我可能不清楚我的问题标题，但这是代码..

```
<?php
$filename = 'myfile.htm';
ob_start();
<?PHP 
 <div id='test'>my original value</div>
?>
$htmlcontent = ob_get_contents();
file_put_contents("$filename", $htmlcontent);
ob_end_clean(); 
```

所以这段代码最终会创建一个新文件，并带有文本'我的原始值

如果我想在将其传输到文件之前通过 javascript/jquery 更改 div 的值，是否有可能？

我为什么要这样做？因为我最终会添加一个 jquery 图形库并希望将其保存到文件中..

稍后使用 wkhtmltopdf 生成该 html 页面的 pdf 版本..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T21:15:45.747

不; 您必须显示该页面以及您要使用的所有 javascript。然后你创建一个表单来收集页面的内容（在它被你的图形库操作之后）并将其发布回 PHP，在那里它可以保存到文件中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T21:27:28.237

嗯，你可以尝试一件事。我不知道 myfile.htm 的内容是什么样的，但您可以尝试使用 DOMDocument 之类的内容加载此内容，使用 loadHTML 方法和 getElementById。

所以：

```
<div id="test1">value</div> 
```

可以用

```
// pseudo
$dom = new DOMDocument::loadHTML('myfile.htm');
$dom->getElemenyById('test1');
$dom->saveHTMLFile('etc .. 
```

执行 $.post 并“操作”现有的 myfile.htm 并覆盖它。

干杯

# django - FreeTDS SQL Server 无效的数据类型

> ID：12325309
> 
> 赞同：3
> 
> 时间：2012-09-07T20:58:25.493
> 
> 标签：django, linux, pyodbc

我正在使用 Ubuntu。我想在 django 中使用 pyodbc 访问 Microsoft sql 数据库。我安装了所有要求。为此，我写了这个

```
cursor.execute('SELECT Id FROM %s' %table_name) 
```

我收到错误消息

```
[HY004] [FreeTDS][SQL Server]Invalid data type (0) (SQLBindParameter)') 
```

但是，当我尝试这个

```
cursor.execute('SELECT * FROM mytable') 
```

它工作正常。为什么我看到这个错误，有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T21:07:14.713

SQL Server 不支持表名的变量。尝试将整个语句构建为字符串，然后执行它。

# ruby - 将列表解析为多维数组，无需循环

> ID：12325315
> 
> 赞同：2
> 
> 时间：2012-09-07T20:58:48.317
> 
> 标签：ruby, parsing, nokogiri

我正在使用 Ruby 和 Nokogiri 来解析 HTML 源代码，并让它以可识别的模式以下列格式列出项目：

```
<span class="x">junk</span>
<small class="y">ParameterA</small>
<span class="z">
    <b>ParameterB</b>
    <i>Possible ParameterC</i>
</span>
<script type="text/javascript">useless stuff</script>
<object><noscript>other useless stuff</noscript></object>

<span class="x">junk</span>
<small class="y">ParameterA</small>
<span class="z">
    <b>ParameterB</b>
    <i>Possible ParameterC</i>
</span>
<script type="text/javascript">useless stuff</script>
<object><noscript>other useless stuff</noscript></object> 
```

等等多次。

如何在以下结构中创建具有所需参数的多维数组？

```
myarray = []
mystuff = Struct.new(:ParameterA, :ParameterB, :ParameterC) 
```

无法找出我可以在这里运行什么样的循环以及如何避免解析无用的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-08T05:42:26.403

我能够用一个正则表达式解决这个问题，它给了我正确的多维数组作为输出：

```
[["ParameterA", "ParameterB", "Possible ParameterC"], ["ParameterA", "ParameterB", "Possible ParameterC"]] 
```

工作代码：

```
str = <<EOF
<span class="x">junk</span>
<small class="y">ParameterA</small>
<span class="z">
<b>ParameterB</b>
    <i>Possible ParameterC</i>
</span>
<script type="text/javascript">useless stuff</script>
<object><noscript>other useless stuff</noscript></object>

<span class="x">junk</span>
<small class="y">ParameterA</small>
<span class="z">
    <b>ParameterB</b>
    <i>Possible ParameterC</i>
</span>
<script type="text/javascript">useless stuff</script>
<object><noscript>other useless stuff</noscript></object>
EOF

m = str.scan(/<small [^>]+>([^<]+)<.*?<b>([^<]+)<\/b>\s+<i>([^<]+)<\/i>/m)
puts m.inspect 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T05:30:24.713

我会使用这样的东西：

```
require 'nokogiri'
require 'ostruct'

doc = Nokogiri::HTML(<<EOT)
<span class="x">junk</span>
<small class="y">ParameterA</small>
<span class="z">
    <b>ParameterB</b>
    <i>Possible ParameterC</i>
</span>
<script type="text/javascript">useless stuff</script>
<object><noscript>other useless stuff</noscript></object>

<span class="x">junk</span>
<small class="y">ParameterA</small>
<span class="z">
    <b>ParameterB</b>
    <i>Possible ParameterC</i>
</span>
<script type="text/javascript">useless stuff</script>
<object><noscript>other useless stuff</noscript></object>
EOT

mystuff = doc.search('small.y').map { |span_y|
  [
    span_y.content,
    span_y.next_element.at('b').content,
    span_y.next_element.at('i') ? span_y.next_element.at('i').content : nil
  ]
}

pp mystuff 
```

看起来像：

```
[
  [
    "ParameterA",
    "ParameterB",
    "Possible ParameterC"
  ],
  [
    "ParameterA",
    "ParameterB",
    "Possible ParameterC"
  ]
] 
```

# regex - 正则表达式，不包括拆分中的部分表达式

> ID：12325320
> 
> 赞同：0
> 
> 时间：2012-09-07T20:59:09.613
> 
> 标签：regex, string, split

我有以下正则表达式：`[\S](?!\s)[\W][\S]`，
它将匹配像这样的模式`z.A`，
我想像这样拆分字符串：
`"The brown fox.Jumped over the..."=> ["The brown fox.","Jumped over the..."]`-这就是我使用该正则表达式的原因，但我的问题是如何排除 [\S] （在我的示例中：“J”（-from jumped））但知道正则表达式是否有效？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T21:14:33.817

听起来您可能正在寻找前瞻：

[http://www.regular-expressions.info/lookaround.html](http://www.regular-expressions.info/lookaround.html)

[前瞻与后瞻](https://stackoverflow.com/questions/11621273/lookahead-vs-lookbehind)

# ruby-on-rails - 如何在 Ruby on Rails 中进行查询以过滤对象的对象是否为 nil

> ID：12325321
> 
> 赞同：1
> 
> 时间：2012-09-07T20:59:09.690
> 
> 标签：ruby-on-rails, ruby-on-rails-2

我正在使用 Rails 2.3.10。我有名为 Stream、Buzz 和 BuzzDigest 的模型。有一个关联，buzz has_many :streams。还有另一个关联，buzz has_one :digest。有时，buzz.digest 为零。如何为 Stream 编写一个查询，以过滤掉流的摘要为 nil 的流？

这不是正确的语法，但可能接近我想要的：

```
Stream.find( :all, :conditions => "buzz_id.digest IS NOT NULL" ) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-08T14:34:15.143

由于 BuzzDigest 是一个对象，而不是 DB 字段或 attr_accessor，因此您可能希望在您的应用程序设计中首先解决 Buzz.digest 可以为 nil 的事实。

如果您对此犹豫不决，那么快速思考会是这样的：

```
 Stream.includes[:buzzes, :buzz_digests].group(:id) 

```

假设正确的模式。 [SO问题](https://stackoverflow.com/questions/2737073/activerecord-find-all-parents-that-have-associated-children)也可能有一些提示。

# objective-c - 如何识别从左到右的滑动动作？

> ID：12325330
> 
> 赞同：0
> 
> 时间：2012-09-07T20:59:38.830
> 
> 标签：objective-c, ios, uigesturerecognizer

如果我试图识别从左到右或从左到右的滑动动作。我是否需要使用`UISwipeGestureRecognizer`带有`UISwipeGestureRecognizerDirectionLeft`方向的 a 然后动态添加`UISwipeGestureRecognizer`带有`UISwipeGestureRecognizerDirectionRight`方向的另一个？

那么当用户抬起手指时，我会移除带有`UISwipeGestureRecognizerDirectionRight`方向的手势识别器吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T21:03:03.417

如果我对您的理解正确，并且您只想检测从左到右的手势，则只需使用`UISwipeGestureRecognizerDirectionRight`. 这是一个例子：

```
UISwipeGestureRecognizer *swipeLeftToRight = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(myMethod:)];
[swipeLeftToRight setDirection:UISwipeGestureRecognizerDirectionRight];
[swipeLeftToRight setDelegate:self];
[someView addGestureRecognizer:swipeLeftToRight]; 
```

# asp.net - ASP.Net 中的异步触发器

> ID：12325332
> 
> 赞同：0
> 
> 时间：2012-09-07T20:59:49.157
> 
> 标签：asp.net, asynchronous

我有一个更新面板、一个异步触发器和一个更新面板外的按钮。按钮被触发器包裹。所有这一切都以一种形式出现。我使用 .load() 方法 (jQuery) 加载此表单。它工作正常：我按下选项卡并将表单加载到另一个表单中。然后，当我第一次按下按钮时，它会触发点击事件，但是当我再次按下它时，什么也没有发生。你能帮忙吗？我已经尝试将按钮放入和退出更新面板，但它仍然无法正常工作。这是我的代码：

```
 <asp:Button ID="Button1" runat="server" onclick="Button1_Click" Text="Search" />
            <asp:ScriptManager ID="ScriptManager1" runat="server">
            </asp:ScriptManager>
       <asp:UpdatePanel ID="UpdatePanel1" runat="server" >
         <Triggers>
            <asp:AsyncPostBackTrigger ControlID="Button1" EventName = "Click"/>
        </Triggers>
        <ContentTemplate>
        ... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-08T03:03:09.347

如果您使用 jquery 加载表单，则可能需要重新绑定事件，我不熟悉 .load 方法（）

如果您将其拉到测试页面中，我认为这部分代码可以正常工作吗？

# javascript - 单击行时如何在对话框中显示行内容

> ID：12325333
> 
> 赞同：0
> 
> 时间：2012-09-07T20:59:54.167
> 
> 标签：javascript, jquery, jquery-ui

我是 javascript 和 jQuery 的新手。昨天我问了这个问题[链接](https://stackoverflow.com/questions/12308198/append-row-from-user-input-javascript)，发现了如何从输入值向表中添加行。所以现在我有一个表，它将创建显示用户输入的新行。今天我试图找出当我单击特定行时如何在对话框中显示行内容。任何线索、建议、教程都会很有用。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T21:02:34.430

这是一个开始：

每当用户单击该行时，html 将显示在 javascript 默认对话框中。

如果您想做更复杂的处理，您可以调用一个函数，该函数将使用以下内容处理行内容：

```
<script type="text/javascript>
    function processRow(row){
         ...
    }

</script>
...

<tr onclick="processRow(this)"> 
```

# php - 从表中确定帐户类型并注册会话

> ID：12325335
> 
> 赞同：0
> 
> 时间：2012-09-07T21:00:16.833
> 
> 标签：php, mysql, sql

基本上我在这里要做的是使用客户登录详细信息从我的数据库中的表中读取，然后检索与此信息匹配的记录。该表中有一个名为“AccountType”的列，用于区分普通用户和经理，如果该列为1，则他们是普通用户。如果此列为 2，则他们是经理。

现在我在我的代码中实现这个问题，下面是我的登录过程脚本的片段：

```
<?php

***session_start()

$query = mysql_query("SELECT * FROM accounts WHERE username='$username' and password='$password'", $db) or die ("Query failed with error: ".mysql_error());

$count=@mysql_num_rows($query);

if(***$count == 1)
    {
    ***$user_row = mysql_fetch_array($result)

        $userid = $user_row["userid"];    
        $_SESSION['userid'] = $userid;

        $customername = $user_row["customername"];    
        $_SESSION['customername'] = $customername;

        $AccountType = $user_row["accounttype"];

        if ($AccountType == 2)
        { 
            $_SESSION['manager'] = $AccountType;
        } 
```

取决于此，当我检查每个页面包含的登录脚本时，它将在导航上显示特定链接，具体取决于帐户类型，如果他们是用户，他们将有权访问普通链接，但如果他们是经理，他们有权访问对于管理功能，以下也是此的代码片段：

```
***session_start();
if (***isset($_SESSION['userid'])) 
{
    $employeeid = $_SESSION['userid'];
    $firstname = $_SESSION['customername'];

    if (***isset($_SESSION['manager'])) 
    {
        $User_Options .='Manager links go here';
    }

    else
    {
    $Links .='Normal Links go here';
    }   

} 
```

那只是一个基本的截断版本，但这为我试图完成的工作奠定了基础。我猜想使用while循环覆盖会话，我理解，但是我正在搜索的信息只有一个记录。它在某种程度上有效，但是即使 AccountType 为 1，它也会显示 2 的选项。

谁能帮助我进一步解决这个问题？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T21:24:06.933

在登录表单上使用类似这样的内容：

```
$_SESSION['manager'] = false;
if ($AccountType == 2) {
  $_SESSION['manager'] = true;
} 
```

然后稍后：

```
if ($_SESSION['manager']) {
  // display manager-only options
} else {
  // display user-only options
}
// Display options for everyone here 
```

# fortran - 用值 -2**31 初始化整数

> ID：12325343
> 
> 赞同：4
> 
> 时间：2012-09-07T21:01:26.647
> 
> 标签：fortran

```
integer, parameter :: m = -2147483648 
```

导致编译器错误：“Integer too big for its kind”，但是

```
integer, parameter :: m = -2147483647 - 1 
```

似乎工作并产生正确的结果。我认为这是因为编译器在否定它之前检查 2147483648 并溢出整数类型。虽然减 1 hack 似乎可以进行所需的初始化，但是否有“最佳实践”方法可以使用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-08T07:09:21.923

问题是 Fortran 标准根据“型号”定义整数，它们具有对称间隔。GFortran（您似乎根据错误消息使用）不允许不是 Fortran 型号的整数文字，即使二进制补码硬件可以表示此类数字。这个检查是在解析阶段完成的，因此在编译过程中，当诸如“-huge(0) - 1”之类的表达式被常量折叠时，不会出现错误消息。

使用 GFortran，您可以使用 -fno-range-check 禁用此检查。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T21:53:52.490

正如您所怀疑的，编译器将 -2147483648 解释为值 +2147483648 的一元否定，并且该中间值对于带符号的 32 位整数来说太大了。

至于最佳实践，`INT_MIN`我见过的每个定义都用以下方式表示`-INT_MAX - 1`：

*   [glibc](http://fossies.org/dox/glibc-2.16.0/limits_8h.html#a21658776274b3d146c674318b635a334)
*   [饮食库](https://github.com/ensc/dietlibc/blob/master/include/limits.h#L45)
*   [linux](http://tomoyo.sourceforge.jp/cgi-bin/lxr/source/include/linux/kernel.h#L30)

我的结论是，最好的做法是依靠编译器的常量折叠来做正确的事情，而不是直接表达这个常量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T21:09:47.663

2147483648 不存在，32 位最大为 2147483647。您需要使用整数*8 变量，它是一个 64 位整数，可让您使用更大的数字。

# c# - 使用带有进度条的 WININET 函数在 C# 中进行 FTP 上传/下载

> ID：12325346
> 
> 赞同：0
> 
> 时间：2012-09-07T21:01:49.280
> 
> 标签：c#, ftp, progress-bar, wininet

所以我发现这个非常好的[ftp 库](http://ftplib.codeplex.com/)似乎可以用 WININET 函数完成大部分工作，除了一件事。它不显示上传/下载文件的进度。有没有简单的方法来解决这个问题？或者这就像地狱一样扩展它，我会更好地使用`WebRequest`其他库（我已经看到了进度条的代码示例，但是这个干净漂亮的库对我来说似乎很好，所以我更喜欢使用这个） .

此外，如果我使用 WebRequests 或类似的，它在速度、可扩展性等方面是否与使用 Wininet 一样好？

```
 public void GetFile(string remoteFile, string localFile, bool failIfExists)
    {
        int ret = WININET.FtpGetFile(_hConnect,
             remoteFile,
             localFile,
             failIfExists,
             WINAPI.FILE_ATTRIBUTE_NORMAL,
             WININET.FTP_TRANSFER_TYPE_BINARY,
             IntPtr.Zero);

        if (ret == 0)
        {
            Error();
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T23:33:44.093

也许不是直接回答我的问题，但[http://netftp.codeplex.com/ 可以满足](http://netftp.codeplex.com/)我的所有需求，甚至更多。

# iphone - Cocos2d-x 和 Marmalade - CCCallFuncO 的麻烦

> ID：12325347
> 
> 赞同：1
> 
> 时间：2012-09-07T21:01:51.977
> 
> 标签：iphone, c++, cocos2d-x, marmalade

我有一个工作的 Cocos2d-x 项目，在 XCode 中开发并基于版本 cocos2d-1.0.1-x-0.13.0-beta

现在我必须让它与 Marmalade 一起工作（在 Windows pc 上使用 VS Express），我对它完全陌生。我设法设置了项目并且源代码编译得很好，但是当我启动项目时，当调用 CCCallFuncO 时，我得到一个神秘的异常：

```
DEFAULT: s3eDeviceHandleException: 1 0x00000000 0x00000000
Memory exception (11) attempting to access: 00000000
S3E runtime is not handling this exception
First-chance exception at 0x00000000 in s3e_simulator_debug.exe: 0xC0000005: Access violation.
Unhandled exception at 0x00000000 in s3e_simulator_debug.exe: 0xC0000005: Access violation reading location 0x00000000. 
```

这发生在类 CCActionInstant 中，在方法 CCCallFuncO::execute 中，在指令上：

```
(m_pSelectorTarget->*m_pCallFuncO)(m_pObject); 
```

据我所知，所有涉及的对象都是正确且合理的，证明它完全有效并且在 XCode 中使用相同的代码并且没有 Marmalade 是有意义的。

可能导致此问题的这两种环境之间有什么区别？任何有果酱经验的人都可以给我一个线索，让我知道我应该寻找什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T17:57:17.403

我正在回答我自己的问题，只是为了让其他开发人员知道我是如何解决这个问题的。

事实证明，Marmalade 模拟器的问题与代码无关。如果您遇到与我类似的问题 - 我的意思是在尝试在橘子酱模拟器上运行您的应用程序时遇到一个非常未指定的异常 - 在尝试其他任何事情之前，我建议您删除橘子酱子文件夹并重新生成项目来自 .mkb 文件。这显然会清除一些可能与您的实际代码不同步的缓存和预编译对象。删除 marmalade 子文件夹会强制编译器重新创建所有内容。

# php - 从简码函数内部调用 WordPress get_template_part 会首先呈现模板

> ID：12325348
> 
> 赞同：9
> 
> 时间：2012-09-07T21:01:54.280
> 
> 标签：php, wordpress, shortcode

我有一个页面，我需要允许用户输入一段文本。然后在该文本之后，插入一个将呈现帖子列表的短代码，然后添加更多自由格式的文本。我的想法是他们应该能够插入一个短代码来输出帖子。这样他们就可以简单地在他们希望帖子出现的地方添加短代码。

我目前有检索在其自己的文件中分隔的帖子的逻辑。目前，我只需使用以下`get_template_part()`功能将其包含在页面中：

```
get_template_part('donation', 'posts'); 
```

我研究了如何创建简码并将以下代码包含到我的`functions.php`文件中以创建简码：

```
add_shortcode('donation-posts', 'fnDonatePosts');   
function fnDonatePosts($attr, $content)
{
    get_template_part('donation', 'posts');    
} 
```

正在正确执行并且`donation-posts.php`帖子正在出现，但是，它们始终位于内容之前，而不是放置短代码的位置。

我尝试删除该`get_template_part()`功能并仅输出一些文本，并且效果很好。所以我知道这`get_template_part()`可能不是正确的方法，但是，我无法找到一种方法来做我想做的事情（我相信有一种方法......我只是没有'没找到）。

我试过了：

```
include(get_template_directory(). '/donation-posts.php');
include_once(get_template_directory(). '/donation-posts.php') : 
```

但是一旦它们命中包含文件中的 PHP 代码，它们就会停止处理。

我也试过：

```
$file = file_get_contents(get_template_directory(). '/donation-posts.php');  
        return $file; 
```

但这仅返回文件的内容（如函数名称所示），这意味着它不会*执行*PHP 脚本来返回帖子。

以前有人做过吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-07T21:25:24.237

你可以试试这个，它可以解决你的问题，因为`get_template_part`基本上反应就像`PHP's` `require`，它不会返回但会立即在它被调用的地方回显内容。

```
add_shortcode('donation-posts', 'fnDonatePosts');   
function fnDonatePosts($attr, $content)
{        
    ob_start();  
    get_template_part('donation', 'posts');  
    $ret = ob_get_contents();  
    ob_end_clean();  
    return $ret;    
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-02-12T12:44:50.823

这是一个更动态的版本，您可以在其中将路径传递给模板。

```
function template_part( $atts, $content = null ){
   $tp_atts = shortcode_atts(array( 
      'path' =>  null,
   ), $atts);         
   ob_start();  
   get_template_part($tp_atts['path']);  
   $ret = ob_get_contents();  
   ob_end_clean();  
   return $ret;    
}
add_shortcode('template_part', 'template_part'); 
```

和简码：

```
[template_part path="includes/social-sharing"] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-11-01T22:54:48.537

接受答案的最小版本：

```
function my_template_part_shortcode() {
    ob_start();
    get_template_part( 'my_template' );
    return ob_get_clean();
}
add_shortcode( 'my_template_part', 'my_template_part_shortcode' ); 
```

`my-template.php`您要包含的文件在哪里。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-11-28T16:19:17.357

get_template_part() 在functions.php 中使用它时对我不起作用。我在 ob_start 和 clean 中使用了 locate_template() 。例如：

```
function full_petition_shortcode( $attr ) {
    ob_start();
    locate_template( 'petition.php', TRUE, TRUE );

    return ob_get_clean();
}
add_shortcode( 'full-petition', 'full_petition_shortcode' ); 
```

# image - 如何使用在 Coldfusion 中用作 img src 属性的参数从 cfc 加载图像？

> ID：12325359
> 
> 赞同：1
> 
> 时间：2012-09-07T21:02:43.887
> 
> 标签：image, file-upload, coldfusion, amazon-s3

我正在跑步`Coldfusion8`并且有一个显示产品图片的页面。图像可以预先存储在`Amazon S3`（首选）上，或者我需要从远程源（由所有者指定）加载它们，调整大小，存储在 S3 上并从那里显示。

虽然这在“理论上”有效（图像被拉入、转换和存储），但我在显示新创建的图像时遇到了问题，这些图像在第一次加载时永远不会起作用。刷新页面后，图像加载正常。

这就是我正在做的事情：

1.  在我的 display_image.cfc 中，它构造了 HTML 标记：

    ```
     <!--- check media log for availablity through S3 --->
     <cfif results.typ NEQ "img" AND results.typ NEQ "alt">
        <!--- call cfc to pull in and store image to s3 --->
        <cfset variables.imageSrc = "http://www.page.de/test/services/img_handler.cfc" & "?method=upload&cm=upload_search&pt=" & results.bildpfad & "&fl=" & results.bilddateiname & "&se=" & results.iln & "&ar=" & results.artikelnummer & "&ck=" & variables.screenWidth & "&ax=rm&gb=s">
     <cfelse>
         <cfset variables.imgFail = "true">
     </cfif> 
    ```

2.  传递的变量

    ```
    method = the method handling uploads  
    cm = routing inside method  
    pt = remote image path  
    fl = remote file name   
    se = seller id  
    ar = item corresponding to this image  
    ck = screen width (to load responsive image size)  
    ax = remote access trigger  
    gb = return images size 
    ```

3.  在我的 image_handler.cfc 里面

    ```
    <!--- set variables --->
    <cfscript>  
        var LOCAL = {};                 
            LOCAL.command = cm;
            LOCAL.imgPath = pt;
            LOCAL.imgFile = fl;
            LOCAL.sellerILN = se;
            LOCAL.article = ar;
            LOCAL.cookie = LSParseNumber(ck);
            LOCAL.getBack = gb;
            LOCAL.access = ax;
            // routing
            if ( LOCAL.command NEQ "" ) {
                 LOCAL.action = LOCAL.command;
            } else {
                 LOCAL.action = "upload";
            }
            // s3 misc
            LOCAL.bucketPath = Session.bucketPath;
            LOCAL.bucketName = Session.bucketName;
            LOCAL.acl = "public-read";
            LOCAL.storage = "";
            LOCAL.tempDirectory = expandPath( "../members/img/secure/" );
            LOCAL.allow = "png,jpg,jpeg";
            LOCAL.failedLoads = "";
            LOCAL.altFailedLoads = "";
            LOCAL.createBucket = "false";
            LOCAL.errorCount = 0;
            LOCAL.altErrorCount = 0;
            LOCAL.cacheControl = 1;
            LOCAL.contentType = "image";
            LOCAL.httptimeout = "300";
            LOCAL.cacheDays = "30";
            LOCAL.storageClass = "REDUCED_REDUNDANCY";
            LOCAL.keyName = "";
            LOCAL.baseUrl = "http://www.page.com";
            LOCAL.imageSrc = "";
            LOCAL.testFilePath = LOCAL.imgPath & LOCAL.imgFile;
            LOCAL.fileExt = ListLast(LOCAL.testFilePath, ".");
            // image size indicator
            LOCAL.runner = "s,m,l,xl";
            LOCAL.worked = "true";
        </cfscript> 

        <cftry>
            <!--- get image --->
            <cfhttp timeout="45" throwonerror="no" url="#LOCAL.testFilePath#" method="get"   useragent="Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US; rv:1.8.1.12) Gecko/20080201 Firefox/2.0.0.12"  getasbinary="yes" result="objGet">

    <!--- determine which image size to create (depending on screen width) --->
            <cfif LOCAL.cookie LT 320 >
                <cfset LOCAL.runner = "l,s">
            <cfelseif LOCAL.cookie GTE 320 AND LOCAL.cookie LTE 767>
                <cfset LOCAL.runner = "l,m">
            <cfelseif LOCAL.cookie GT 768 AND LOCAL.cookie LTE 1279>
                <cfset LOCAL.runner = "xl,m">
            <cfelseif LOCAL.cookie GT 1280>
                <cfset LOCAL.runner = "xl,l">
            </cfif>

            <!--- validate --->
            <cfif len(objGet.Filecontent) EQ 0 OR objGet.Mimetype EQ "text/html">
                <cfset LOCAL.worked = LOCAL.worked& "false length or mime">
            <cfelseif NOT listfindnocase(LOCAL.allow, LOCAL.fileExt )>
                 <cfset LOCAL.worked = LOCAL.worked& "false wrong extension">
            <cfelse>
                 <!--- create temp image and resize --->
                 <cfset LOCAL.objImage = ImageNew(objGet.FileContent)>
                 <cfset LOCAL.basePath = LOCAL.tempDirectory & "_base_" & LOCAL.imgFile>
                 <cfset imageWrite( LOCAL.objImage, LOCAL.basePath, ".99")>
                 <cfset LOCAL.base = imageRead( LOCAL.basePath )>
                 <cfset LOCAL.imageSrc = LOCAL.tempDirectory>
                 <cfset ImageSetAntialiasing(LOCAL.base,"on")>
                 <cfset variables.loopCount = 0>

                 <!--- portrait --->
                 <cfif ImageGetWidth( LOCAL.base ) LT ImageGetHeight( LOCAL.base )>
                      <!--- loop through image size, like "xl,m" --->
                      <cfloop list="#LOCAL.runner#" delimiters="," index="letter"><cfset variables.loopCount = variables.loopCount+1>
                          <cfset LOCAL.lt = ListGetAt(LOCAL.runner, variables.loopCount, ",")>
                          <cfset LOCAL.height = Application.strConfig.respH[LOCAL.lt]>
                          <cfset LOCAL.width = "">
                          <cfset ImageScaleToFit(LOCAL.base, LOCAL.width, LOCAL.height, "bilinear")>
                          <cfset LOCAL.filekey = LOCAL.lt & "_" & LOCAL.imgFile>
                          <cfset LOCAL.keyName = LOCAL.sellerILN & "/" & LOCAL.filekey>
                          <cfset LOCAL.filename = LOCAL.tempDirectory & LOCAL.filekey>
                          <cfset imageWrite( LOCAL.base, LOCAL.filename, ".99" )>

                          <!--- call s3 --->
                         <cfset Application.strObjs.s3.putObject(LOCAL.bucketName, LOCAL.filekey, LOCAL.contentType, LOCAL.httptimeout, LOCAL.cacheControl, LOCAL.cacheDays, LOCAL.acl, LOCAL.storageClass, LOCAL.keyName, LOCAL.imageSrc, "false" )>
                         <cfset fileDelete( LOCAL.tempDirectory & LOCAL.lt & "_" & LOCAL.imgFile )>
                     </cfloop>
                     <!--- cleanup --->
                     <cfset fileDelete( LOCAL.tempDirectory & "_base_" & LOCAL.imgFile )>
               </cfif>
               <!--- pass back image THIS DOESN'T WORK --->

               <cfscript>
               // set image path and mime type
                   if ( LOCAL.getBack EQ "s" ){
                       LOCAL.passPath = Session.bucketPath & Session.bucketName & "/" & LOCAL.sellerILN & "/" & ListGetAt(LOCAL.runner, Listlen(LOCAL.runner), ",") & "_" & LOCAL.imgFile;
                   } else if( LOCAL.getBack EQ "l" ) {
                       LOCAL.passPath = Session.bucketPath & Session.bucketName & "/" & LOCAL.sellerILN & "/" & ListGetAt(LOCAL.runner, 1, ",") & "_" & LOCAL.imgFile;
                   }
               if ( LOCAL.fileExt EQ "jpg" ){
                       LOCAL.fileExt = "jpeg";
                   }
               LOCAL.mime = "image/" & LOCAL.fileExt;
               </cfscript>
               <!--- pass back as content --->
               <cfcontent reset="no" type="#LOCAL.mime#" file="#LOCAL.passPath#" />
           <cfreturn /> 
    ```

就像我说的，这运行正常，拉入、验证和存储图像，创建的较小的图像作为`cfcontent`元素传回。但是，我无法让它工作=创建并存储了图像，但是无论我传回什么，图像都不会显示，直到我刷新页面并触发新的搜索。

**问题：**
我做错了`iamge_handler`什么吗？我认为这可能与我的使用有关，`cfcontent`但我不确定。

# python - 使用 ip 登录本地 FTP 服务器

> ID：12325366
> 
> 赞同：1
> 
> 时间：2012-09-07T21:03:08.893
> 
> 标签：python

我正在尝试登录仅在网络中本地运行的 FTP 服务器。为此，我必须使用我的 ip 地址作为服务器地址（参见下面的代码）。但是每次我得到一个***gaierror: [Errno 11004] getaddrinfo failed***错误。

任何人都可以查看我的代码，看看我是否犯了任何可能导致此地址问题的错误？我也可以从我的浏览器很好地登录 ftp 服务器，这样我就知道服务器已启动并正常运行，也允许匿名登录服务器。

```
#import the ftp lib.
from ftplib import FTP
#enter the address of the ftp server to use, use ip address since server is ran locally
ftp = FTP('ftp://192.168.1.130')
#logs into the ftp server
ftp.login() 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T21:09:19.113

您包含的协议的主机名不正确。发生的事情是图书馆试图解析“ftp://192.168.1.130”（而不是“192.168.1.130”），这不是一个有效的地址。

```
#Wrong
ftp = FTP('ftp://192.168.1.130')
#Right
ftp = FTP('192.168.1.130') 
```

[http://docs.python.org/library/ftplib.html](http://docs.python.org/library/ftplib.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T21:09:34.883

根据[ftplib 文档](http://docs.python.org/library/ftplib.html%20%22ftplib%20documentation)，您应该只给他主机地址/IP，而不是代表 URL 的字符串。所以在这里，你应该简单地做：

```
ftp = FTP('192.168.1.130') 
```

# dictionary - 尝试在子类实体中使用 TreeMap

> ID：12325367
> 
> 赞同：1
> 
> 时间：2012-09-07T21:03:10.893
> 
> 标签：dictionary, subclass, treemap, joined-subclass

我找到了关于映射超类的子类化的帮助，并且我找到了关于如何映射 TreeMap 的帮助。但是，我根本找不到在子类中使用 TreeMap 的任何内容。情况如下：我正在向一个长期存在的应用程序添加一个功能。该应用程序已映射实体，其中一组实体形成层次结构。有一个，例如，它建立基类。然后有许多许多子类使用元素来映射各个子类。子类都使用元素来引用包含子类属性的附加表。这已经工作了好几年，生活似乎还不错。

现在我的工作开始了，我需要在我的新子类实体中使用 TreeMap（与所有其他实体扩展相同的基类），所以我要做的第一件事是尝试以与其他子类相同的方式映射它，使用一个里面一个。

简而言之，当我启动应用程序并且 Hibernate 开始映射时，我遇到了一个错误。研究这个错误让我查看了休眠映射文件的 DTD，你猜怎么着？根据我的解释，不能在 .

同样的研究让我了解了哪个可以包含地图。所以，我去配置一个内部基类映射。

当我这样做时，我遇到了奇怪的错误，引用了我什至在代码、映射中都找不到的符号……任何地方！更多的研究，我在 Hibernate 参考手册第 9 章中找到了一个参考，它说 Hibernate 不支持和元素的混合。所以这也做不到。

我的问题是：有没有我一直错过的解决方案？从事物的声音看来，如果您正在使用，您似乎不能在子类中配置地图，因为内部它不会占用地图......而且，虽然可以在 a 中配置 Map ，但我怀疑我可以在这里收集很多支持，以涉水通过当前映射文件并将所有实体重新映射为实体。

有人有什么想法吗？如果我看的不对，相信我，我愿意接受并学习！

# ruby - 替换ruby中括号之间的特定字符

> ID：12325368
> 
> 赞同：1
> 
> 时间：2012-09-07T21:03:12.060
> 
> 标签：ruby, regex

我有一个字符串

```
str = "'${1:textbox}',[${2:x},${3:y},${4:w},${5:h}]" 
```

我想用一个空格替换所有之间`,`。`[``]`

我试图使用类似的东西

```
str.gsub!(/(?<=\[)\,*?(?=\])/," ") 
```

没有成功。但是，如果我用 替换`\,`我的表达式`.`，我会得到预期的输出：

```
str.gsub!(/(?<=\[).*?(?=\])/," ")

== "'${1:textbox}',[  ]" 
```

有人可以解释在这种情况下使用的正确正则表达式技术，也许还可以解释为什么我上面发布的示例失败并成功了？

我在用`ruby 1.9.3p194 (2012-04-20 revision 35410) [x86_64-darwin10.8.0]`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T21:50:52.163

使用单个正则表达式可能可以做到这一点，但即使是这样，我也可以保证它会变得难以描述。使用“嵌套”替换要简单得多 - 使用一个 gsub 查找带括号的子字符串，然后使用另一个替换逗号：

```
str.gsub(/\[.*?\]/) do |substr|
    substr.gsub(',', ' ')
end 
```

恐怕我无法解释为什么你的尝试失败了——它们都不适合我（ruby 1.8.7 / irb 0.9.5）。IRB 给出的错误含糊地说是“错误的正则表达式语法”。而且我无法完全理解它们应该如何工作（编辑：mu 太短了，[他的回答](https://stackoverflow.com/a/12325962/589985)中有一个很棒的细分- 看看）。无论如何，希望这有帮助！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-07T22:00:39.007

这个正则表达式：

```
/(?<=\[)\,*?(?=\])/ 
```

正在寻找一个左括号，后跟一系列逗号（任意长度），后跟一个右括号。这意味着这样的事情：

```
[]
[,]
[,,,,,,,,,,,] 
```

你的字符串看起来不像那样，所以你的第一个`gsub!`不做任何事情。如果你这样做：

```
'[,,,,,,]'.gsub(/(?<=\[),*?(?=\])/, " ") 
```

你会得到一个`'[ ]'`为你的麻烦。

你的第二个正则表达式：

```
/(?<=\[).*?(?=\])/ 
```

之所以有效，是因为`.*?`匹配任何内容（当然，受换行符和`/m`and`/s`修饰符的影响），并且字符串的部分介于`[`and`]`当然有资格作为*任何东西*。

如果你想产生这个：

```
"'${1:textbox}',[${2:x} ${3:y} ${4:w} ${5:h}]" 
```

然后我会使用[Xavier Holt 的](https://stackoverflow.com/a/12325855/479863)嵌套`gsub`方法，它简单而干净。

# linux - 如果 shell 脚本中发生错误，通过电子邮件通知

> ID：12325370
> 
> 赞同：1
> 
> 时间：2012-09-07T21:03:23.167
> 
> 标签：linux, bash, shell, unix

```
fileexist=0
  mv /data/Finished-HADOOP_EXPORT_&Date#.done /data/clv/daily/archieve-wip/
  fileexist=1
--some other script below 
```

上面是我在 for 循环中的 shell 脚本，我正在移动一些文件。如果在移动过程中出现问题，我想通过电子邮件通知自己，因为我在 Hadoop 集群上运行这个脚本，所以集群可能在运行时出现故障等等。所以我怎样才能更好`error handling mechanism`在这个 shell 脚本中？有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T21:54:54.487

好吧，至少您需要知道“您预计会出现什么问题”。基于此，您可以做到这一点

```
 mv ..... 2> err.log
 if [ $? -ne 0 ]
 then
   cat ./err.log | mailx -s "Error report" admin@abc.com
   rm ./err.log
 fi 
```

或者如[William Pursell](https://stackoverflow.com/users/140750/william-pursell)建议的那样，使用——

```
trap 'rm -f err.log' 0; mv ... 2> err.log || < err.log mailx ... 
```

`mv`出错时可能会返回非零返回码，并`$?`返回该错误码。如果整个服务器出现故障，那么不幸的是，该脚本也不会运行，因此最好留给更高级的监控工具，例如在不同的监控服务器上运行的[Foglight 。](http://www.quest.com/foglight/)对于更基本的检查，您可以使用上述方法。

# kryo - Kryo 中的序列化事件

> ID：12325371
> 
> 赞同：1
> 
> 时间：2012-09-07T21:03:26.967
> 
> 标签：kryo

你如何接收序列化事件？你可以定义

```
void writeObject(ObjectOutputStream out) {
  // handle event
  out.defaultWriteObject(this);
} 
```

在 java 序列化中，当您的对象被序列化时将调用此方法。你如何在 Kryo 做同样的事情？两者都有默认序列`KryoSerializable`化`Externalizable`的问题：一旦调用了事件处理程序，您就需要默认的读/写对象。但是没有这样的事情！? 您可以调用`FieldSerializer`in`read(Kryo, Input)`来读取对象的字段，但它会为您生成一个新对象，而不是填充当前对象。为此，我尝试引入一个自定义序列化程序：

```
Serializer def = kryo.getDefaultSerializer(A.class)
kryo.addDefaultSerializer(A.class, new Serializer() {
    public void write(Kryo kryo, Output output, Object object) {
        ((A)object).serializationEvent();
        def.write(kryo, output, object); 
```

但是，我提到通过 A 的子类接收`serializationEvent()`事件，只有 A.class 字段被序列化。因此，这不适用于`class B extends A`. 我还尝试了[Natan 提出](http://code.google.com/p/kryo/issues/detail?can=2&start=0&num=100&q=&colspec=ID%20Type%20Status%20Priority%20Milestone%20Owner%20Summary&groupby=&sort=&id=86)的解决方案：`register(A.class, new FieldSerializer(A.class, myhandler`。这会序列化所有字段，包括子类，但是根本不会为子类调用自定义序列化程序。因此，我决定 Kryo 自定义仅适用于最终课程。[Nathan 说这个结论是“无效的”，而 KryoSerializable 解决方案是“特定于应用程序的”，否则认为是“粗鲁的”。](http://code.google.com/p/kryo/issues/detail?can=2&start=0&num=100&q=&colspec=ID%20Type%20Status%20Priority%20Milestone%20Owner%20Summary&groupby=&sort=&id=86)尽管有这样的决心，我还是决定发表我发现的一般方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T21:03:26.967

我发现了两种解决方案。首先，覆盖 writeReferenceOrNull 可以工作

```
Kryo kryo = new Kryo() {
    public boolean writeReferenceOrNull (Output output, Object object, boolean mayBeNull) {
        if (object instanceof A) {
            ((A) object).serializationEvent();
        }

        return super.writeReferenceOrNull(output, object, mayBeNull);
    } 
```

但是，它需要更改源代码可见性，Natan 说这仅在启用引用时才有效（在默认情况下），并推荐一种更可靠的方法：覆盖 newDefaultSerializer：

```
public class EventFiringKryo extends Kryo {
    protected Serializer newDefaultSerializer(Class type) {
        final Serializer def = super.newDefaultSerializer(type);
        Serializer custom = new Serializer() {

            public void write(Kryo kryo, Output output, Object object) {
                System.err.println("writing " + object + ":" + object.getClass().getSimpleName());
                if (object instanceof A)
                    ((A)object).serializationEvent();
                def.write(kryo, output, object);
            }

            public Object read(Kryo kryo, Input input, Class type) {
                Object result = def.read(kryo, input, type);
                if (result instanceof SomeAnotherType)
                    result.canInitializeSomethingElse();
                return result;
            }
        };
        return custom;
    }

} 
```

除了有效之外，此方法不需要仔细注册所有实现您要调用的接口的类。

# tsql - public void Execute(string sql) 被认为是危险的吗？

> ID：12325373
> 
> 赞同：0
> 
> 时间：2012-09-07T21:03:28.660
> 
> 标签：tsql

如果我在我的程序集中实现这样的方法会被认为是危险的吗？

```
 public void Execute(string sql)
        {
            using (SqlConnection connection = new SqlConnection("MyConnectionString....."))
            {
                SqlCommand command = new SqlCommand(sql, connection);
                connection.Open();
                command.ExecuteNonQuery();                
            }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T21:05:35.587

如果您传入的 sql 字符串是动态构建的并且包含用户输入的连接，这是很*危险的。*否则，它通常被认为是不好的做法。存储过程是您最好的选择。

[这是关于 SQL 注入的 OWASP 文章](https://www.owasp.org/index.php/SQL_Injection)

# php - 如何消除 PHP 中的反斜杠

> ID：12325381
> 
> 赞同：4
> 
> 时间：2012-09-07T21:04:34.917
> 
> 标签：php, javascript, jquery, ajax, encode

我用 javascript 构建了我的 xml 文件，并使用如下警报正确显示它：

```
<Voitures>
   <voiture par1="4" par2="1" par3="0"/>
   <voiture par1="3" par2="0" par3="0"/>
</Voitures> 
```

但问题是当我用 ajax 将它发送到一个 php 文件时，我得到了这个结果：

```
<Voitures>
   <voiture par1=\"4\" par2=\"1\" par3=\"0\"/>
   <voiture par1=\"3\" par2=\"0\" par3=\"0\"/>
</Voitures> 
```

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-07T21:06:28.863

您的 PHP 配置启用了[魔术引号](http://us2.php.net/magic_quotes)，这是一个已弃用的设置，任何人都不应再使用。它已在 PHP 5.4 中删除。 **立即禁用它**，否则您可能会编写升级到 PHP 5.4 时行为不正确的代码。

如果这是不可能的，请先使用[`stripslashes()`](http://php.net/manual/en/function.stripslashes.php)该值，然后再对其进行任何其他操作。 **仅当您确实无法禁用魔术引号时才这样做。开发启用魔术引号的 PHP 软件是一个非常非常糟糕的主意。**

* * *

如果您正在尝试编写好的代码并面向未来，请将其作为每个文件的顶部，或者一些在任何地方都可以使用的常见包含文件：

```
if (get_magic_quotes_gpc()) {
    trigger_error("Magic quotes are enabled; please disable them.", E_USER_ERROR);
} 
```

如果启用了魔术引号，这将使您的应用程序简单地拒绝运行。

如果您可以选择，`.htaccess`请随您的应用程序提供一个包含以下内容的文件：

```
php_flag magic_quotes_gpc Off 
```

如果可能，这将在 Apache 上解聚时禁用整个应用程序的魔术引号。如果 Apache 配置不允许文件中的`php_flag`指令，`.htaccess`那么这将导致 HTTP 500 错误，这比让您的应用程序在启用魔术引号的情况下运行要好得多。

# java - Spring MVC 控制器代码：已为此响应调用 getOutputStream()

> ID：12325382
> 
> 赞同：1
> 
> 时间：2012-09-07T21:04:41.623
> 
> 标签：java, spring, exception, spring-mvc, csv

我正在尝试从一些数据库数据中组装一个 CSV 文件，并将其从我的 Spring MVC 控制器（和相关服务）发送到客户端。我正在使用 SuperCSV 来处理写入和输出： [http ://supercsv.sourceforge.net/](http://supercsv.sourceforge.net/)

所以，这里是控制器方法：

```
@RequestMapping(value="/getFullReqData.html", method = RequestMethod.GET)
public void getFullData(HttpSession session, HttpServletRequest request, HttpServletResponse response) throws IOException{
    logger.info("INFO:  ******************************Received request for full Req data dump");

    List<Requirement> allRecords = reqService.getFullDataSet(ProjectService.getProjectID((String)session.getAttribute("currentProject")));
    response.setContentType("text/csv;charset=utf-8"); 
    response.setHeader("Content-Disposition","attachment; filename=nistData.csv");
    OutputStream fout= response.getOutputStream();  
    OutputStream bos = new BufferedOutputStream(fout);   
    OutputStreamWriter outputwriter = new OutputStreamWriter(bos); 

    ICsvBeanWriter writer = new CsvBeanWriter(outputwriter, CsvPreference.EXCEL_PREFERENCE);
    try {
      final String[] header = new String[] { 
              "ReqID", 
              "ColName1",
              "ColName2",
              "ColName3",
              "ColName4",
              "ColName5", 
              "ColName6",
              "ColName7",
              "ColName8",                                 
              "ColName9",
              "ColName10" };

      // the actual writing
      writer.writeHeader(header);

      for(Requirement aCR : allRecords){
          writer.write(aCR, header);
      }

    } finally {
        writer.close();
    }
}; 
```

这实际上是向前推进并获得对触发 csv 文件下载的客户端浏览器的响应。

两个问题：

1）我得到一堆服务器端异常吐出（下）

2) CSV 文件中只有标题，没有数据，尽管 allRecords 列表在调试器中显示为完全填充。

我希望填充失败是由异常引起的，但我很怀疑。异常跟踪：

```
SEVERE: Servlet.service() for servlet jsp threw exception
java.lang.IllegalStateException: getOutputStream() has already been called for this response
at org.apache.catalina.connector.Response.getWriter(Response.java:633)
at org.apache.catalina.connector.ResponseFacade.getWriter(ResponseFacade.java:214)
at javax.servlet.ServletResponseWrapper.getWriter(ServletResponseWrapper.java:105)
at javax.servlet.ServletResponseWrapper.getWriter(ServletResponseWrapper.java:105)
at org.apache.jasper.runtime.JspWriterImpl.initOut(JspWriterImpl.java:125)
at org.apache.jasper.runtime.JspWriterImpl.flushBuffer(JspWriterImpl.java:118)
at org.apache.jasper.runtime.PageContextImpl.release(PageContextImpl.java:182)
at org.apache.jasper.runtime.JspFactoryImpl.internalReleasePageContext(JspFactoryImpl.java:123)
at org.apache.jasper.runtime.JspFactoryImpl.releasePageContext(JspFactoryImpl.java:80)
at org.apache.jsp.error_jsp._jspService(error_jsp.java:102)
at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:432)
at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390)
at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:722) 
```

异常看起来会传递，因为每次调用此方法我都会看到 4 次。

我发现的所有文档中都有人将他们的 response.getOutputStream() 嵌入到 scriptlet 中，而不是放在 servlet 中。我上面提到的方法是在 Spring MVC 控制器内部，所以建议“将它移到 servlet！” 似乎不适用于这里。据我所知，我只调用了一次 response.getOutputStream() ，并且该方法在第一次调用时就崩溃了。

我难住了。帮助？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-07T21:14:49.963

您的流程可能在请求映射方法的某处引发异常 - 可能在`writer.write(aCR, header);`其中然后转到 finally 块，关闭响应流，然后异常冒泡到 servlet，它试图通过错误页面处理它（检查你的web.xml `error-page`tags) ，因为响应流已关闭，因此无法干净地呈现错误 jsp，因此您会看到异常消息。

如果您可以在控制器中捕获异常并打印堆栈跟踪以查看在写入输出流时控制器中可能出现的问题，那就太好了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-08T01:13:14.953

你能不能让它与 printWriter 一起工作：

```
 response.setContentType("application/vnd.ms-excel;charset=UTF-8");
    response.setHeader("Content-Disposition", "attachment; filename=\"" + fileName + ".xls\"");
    PrintWriter out = response.getWriter(); 
```

# iphone - 将类非自动引用计数导入我的项目时出错

> ID：12325394
> 
> 赞同：0
> 
> 时间：2012-09-07T21:05:25.963
> 
> 标签：iphone, ios, xcode

只需创建新项目并检查自动引用计数并下载另一个项目。当我将下载的类导入我的项目时，它给出了太多的错误，经过搜索我发现因为下载的项目是非自动引用计数。

那么，请问这个问题的解决方案是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T21:12:03.047

发生这种情况是因为“release”之类的调用会导致 ARC 项目中的错误，因此您不要使用它们，因为编译器会为您执行此操作。要在您的类上启用 ARC 并在您导入的类上禁用它，请转到构建阶段并将编译器标志“-fno-objc-arc”添加到要使用手动内存管理的类中。

![在此处输入图像描述](../Images/81dd78150095bc394eabe29e2a921098.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T21:10:57.923

这些文件需要标记给编译器，这样编译器就不会对它们使用 ARC。使用 -fno-objc-arc 标志。单击您的项目文件，单击应用程序的目标，单击“构建阶段”选项卡，展开“编译源”，然后双击没有 ARC 的文件。一旦弹出一个小窗口，将 -fno-objc-arc 标志放在这些文件上。

# ios - 在do-while循环iOS中创建一个类的多个实例

> ID：12325397
> 
> 赞同：1
> 
> 时间：2012-09-07T21:05:40.940
> 
> 标签：ios, class, instance, do-while

我正在创建一个应用程序，该应用程序从 plist 中获取信息以创建电子目录。我们有许多不同的版本，如果我不必进入每个应用程序的代码并为每个应用程序设置这个数量的部分，并且每次我们进行更新，那就太好了。

我想使用 do while 循环来完成此操作，但无法弄清楚如何为每个实例重命名我的实例。请参阅附件代码，任何帮助将不胜感激！

```
scroller = [[UIScrollView alloc] initWithFrame:CGRectMake(0, 44, 320, 387)];
int secNum = 8;
int secTemp = 0;
int frameWidth = self.view.frame.size.width;
int frameHeight = self.view.frame.size.height;

do {
    id *sectionViewController = [NSString stringWithFormat:@"svc%d",secTemp];

    SectionViewController *sectionViewController = [[SectionViewController alloc] init];
    [sectionViewTable setDataSource:sectionViewController];
    [sectionViewTable setDelegate:sectionViewController];
    sectionViewController.view = sectionViewController.tableView;

    sectionViewController.view.frame = CGRectMake(frameWidth*secTemp, 0, frameWidth, frameHeight);

    secTemp = secTemp + 1;
    [scroller addSubview:sectionViewController.view];
} while (secTemp < secNum);

scroller.contentSize = CGSizeMake(320*secTemp, 387);
scroller.pagingEnabled = YES; 
```

我无法弄清楚其余的，并且在网上找不到任何可以帮助自己的东西。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T21:19:52.907

无法真正得到您的问题...您希望 sectionViewController 为每个循环都使用另一个名称来访问它吗？

为什么不创建一个 NSMutableArray 并将 sectionViewController 的实例添加到其中？所以你可以通过索引接收它。

还是我把你的问题弄错了？

# ios - CAAnimation 和多视图控制器

> ID：12325398
> 
> 赞同：0
> 
> 时间：2012-09-07T21:05:42.140
> 
> 标签：ios, ipad, animation, caanimation

我有一个根视图控制器 (VC)，它管理另外两个 VC，用于纵向和一个用于横向，并且在每一个中都有许多其他 VC。较低级别的 VC 之一具有由来自根 VC 的通知触发的动画方法。

这是有效的并且动画开始但是当它移动到 VC 的框架之外时被隐藏/隐藏。所以我的问题如下：

*   CAAnimation 是否限制在启动动画的 VC 内？
*   是否可以创建跨多个 VC 移动的动画，如果有任何示例可以提供帮助吗？

如果您可以想象我的根 VC 在每个角落包含四个 VC，我正在尝试为左下角的视图设置动画，以便它向上移动到屏幕的右上角。动画方法从左下角 VC 启动。

# asp.net-mvc-3 - 发布后 MVC3 联系表单未发送电子邮件

> ID：12325400
> 
> 赞同：0
> 
> 时间：2012-09-07T21:05:42.653
> 
> 标签：asp.net-mvc-3, razor

我构建了一个简单的联系表单，在我的测试“mvc1application”中本地工作得很好。当我将确切的代码传输到我的一个网站时，我会遇到问题并且真的很难过。

场景是当用户访问站点时，它会检查他们是否已经通过身份验证（通过 SSO 系统）。如果是这样，则设置了 cookie 并且他们已登录。如果您尝试在未登录的情况下访问该站点，您当前会被重定向到“AccessDenied.cshtml”视图。这完全没有问题。

从那以后，我用一个表单（简单的联系表单）替换了该视图，用户可以填写该表单以向网站管理员发送电子邮件。我让表单正确显示，在 POST 上它得到 200，通过 Chrome 开发工具，我看到表单内容已发布。没有发生的是我认为我的 EmailViewModel.cs 没有被调用并处理表单数据。所以从来没有发送过电子邮件。

我真的很难过，这里是一些示例代码：

（我的 AccountController 的一些部分被剪掉了......）

```
[AllowAnonymous]
public ActionResult LogOn(string strEmail, string token)
{
    DepartmentUser departmentuser = db.DepartmentUsers.SingleOrDefault(r => r.UserEmail == strEmail && r.Token == token);
    if (departmentuser != null)
    {
        //verify that the token date  + 1 day >= current datetime
        if (departmentuser.TokenDate.Value.AddDays(1) >= DateTime.Now)
        {
            //if yes, then update to set token = null and datetime = null
            departmentuser.Token = null;
            departmentuser.TokenDate = null;
            db.SaveChanges();

            string userData = departmentuser.DepartmentUserID.ToString() + ":" + departmentuser.DepartmentID.ToString() + ":" + departmentuser.UserName;

            FormsAuthenticationTicket ticket = new FormsAuthenticationTicket(1, departmentuser.UserEmail,
                DateTime.Now, DateTime.Now.AddMinutes(FormsAuthentication.Timeout.TotalMinutes),
                false, userData);
            string hashedTicket = FormsAuthentication.Encrypt(ticket);

            HttpCookie cookie = new HttpCookie(FormsAuthentication.FormsCookieName, hashedTicket);
            Response.AppendCookie(cookie);
            return Redirect("~/Home");
        }
        else
        {
            return View("RequestForm");

        }
    }
    else
    {
        return View("RequestForm");
    }
}

public ActionResult RequestForm(EmailViewModel emailVM)
{
    if (!ModelState.IsValid)
    {
        return View(emailVM);
    }

    var email = new EmailViewModel
    {

        Name = emailVM.Name,
        EmailAddress = emailVM.EmailAddress,
        InternalTeamName = emailVM.InternalTeamName,
        InternalTeamLeadName = emailVM.InternalTeamLeadName,
        InternalDistEmail = emailVM.InternalDistEmail,
        AverageNumCommsWeekly = emailVM.AverageNumCommsWeekly,
        AverageNumPeopleSentWeekly = emailVM.AverageNumPeopleSentWeekly
    };

    string body = "Name: " + email.Name + "\n"
                + "Email: " + email.EmailAddress + "\n"
                + "Internal Team: " + email.InternalTeamName + "\n"
                + "Internal Team Lead: " + email.InternalTeamLeadName + "\n"
                + "Internal Team Lead Email: " + email.InternalTeamLeadEmail + "\n"
                + "Internal Distribution Email: " + email.InternalDistEmail + "\n"
                + "Average # of Communications Per Week: " + email.AverageNumCommsWeekly + "\n"
                + "Average # of People Emailed Per Week: " + email.AverageNumPeopleSentWeekly;

    MailMessage mail = new MailMessage();

    mail.From = new MailAddress(email.EmailAddress);
    // for production put email in web.config for easy change
    mail.To.Add("user@email.me");
    mail.Subject = "Access Request";
    mail.Body = body;
    mail.IsBodyHtml = true;

    // smtp is local directory in web.config for testing ATM...
    SmtpClient smtp = new SmtpClient();

    smtp.Send(mail);

    mail.Dispose();
    return View("RequestForm");

} 
```

还有我的 EmailViewModel.cs...

```
namespace MVC.Models
{
    public class EmailViewModel
    {
        [Required]
        public string Name { get; set; }

        [Required]
        [DataType(DataType.EmailAddress)]
        public string EmailAddress { get; set; }

        [Required]
        public string InternalTeamName { get; set; }

        [Required]
        public string InternalTeamLeadName { get; set; }

        [Required]
        public string InternalTeamLeadEmail { get; set; }

        [Required]
        public string InternalDistEmail { get; set; }

        [Required]
        public string AverageNumCommsWeekly { get; set; }

        [Required]
        public string AverageNumPeopleSentWeekly { get; set; }

    }
} 
```

最后是我的 Requestform.cshtml 视图...

```
@model CorpNewsMgr.Models.EmailViewModel
@{
    ViewBag.Title = "Request Access";
    Layout = "~/Views/Shared/_WideLayoutDenied.cshtml";
}
<p>
    Currently you do not have the required credentials to access the site.
    <br />
    To request more information, or to request permission to access this system, please
    contact:
</p>
<br />
<br />
<div>
    <h3>
        Please fill this form out to request access to the tool.</h3>
    @using (Html.BeginForm())
    {
        @Html.ValidationSummary(true)
        <fieldset>
            <legend>Request Access</legend>
            <div class="editor-label">
                @Html.LabelFor(Model => Model.Name)
            </div>
            <div class="editor-field">
                @Html.TextBoxFor(Model => Model.Name)
                @Html.ValidationMessageFor(Model => Model.Name)
            </div>
            <div class="editor-label">
                @Html.LabelFor(Model => Model.EmailAddress)
            </div>
            <div class="editor-field">
                @Html.TextBoxFor(Model => Model.EmailAddress)
                @Html.ValidationMessageFor(Model => Model.EmailAddress)
            </div>
            <div class="editor-label">
                @Html.LabelFor(Model => Model.InternalTeamName)
            </div>
            <div class="editor-field">
                @Html.TextBoxFor(Model => Model.InternalTeamName)
                @Html.ValidationMessageFor(Model => Model.InternalTeamName)
            </div>
            <div class="editor-label">
                @Html.LabelFor(Model => Model.InternalTeamLeadName)
            </div>
            <div class="editor-field">
                @Html.TextBoxFor(Model => Model.InternalTeamLeadName)
                @Html.ValidationMessageFor(Model => Model.InternalTeamLeadName)
            </div>
            <div class="editor-label">
                @Html.LabelFor(Model => Model.InternalTeamLeadEmail)
            </div>
            <div class="editor-field">
                @Html.TextBoxFor(Model => Model.InternalTeamLeadEmail)
                @Html.ValidationMessageFor(Model => Model.InternalTeamLeadEmail)
            </div>
            <div class="editor-label">
                @Html.LabelFor(Model => Model.InternalDistEmail)
            </div>
            <div class="editor-field">
                @Html.TextBoxFor(Model => Model.InternalDistEmail)
                @Html.ValidationMessageFor(Model => Model.InternalDistEmail)
            </div>
            <div class="editor-label">
                @Html.LabelFor(Model => Model.AverageNumCommsWeekly)
            </div>
            <div class="editor-field">
                @Html.TextBoxFor(Model => Model.AverageNumCommsWeekly)
                @Html.ValidationMessageFor(Model => Model.AverageNumCommsWeekly)
            </div>
            <div class="editor-label">
                @Html.LabelFor(Model => Model.AverageNumPeopleSentWeekly)
            </div>
            <div class="editor-field">
                @Html.TextBoxFor(Model => Model.AverageNumPeopleSentWeekly)
                @Html.ValidationMessageFor(Model => Model.AverageNumPeopleSentWeekly)
            </div>
            <p>
                <input type="submit" value="Send" />
            </p>
        </fieldset>

    }
</div>
<br />
<p>
    Thank you,<br />

</p> 
```

因此，当页面加载时，表单加载正常（耶）。我可以填写并验证它（耶）。在提交时我得到一个 200 并且 POST 看起来很好（我可以看到 POST 中的字段）但没有任何反应。页面重新加载为空表单，我的取件文件夹或任何内容中都看不到任何电子邮件。

同样，在我的本地开发测试站点上，我可以让它工作并正常运行。在这里我不能。我认为问题在于 AccountController 的顶部以及它是如何拉视图的，但我很难（并且很累）试图弄清楚这一点。

哦，这是我从标准 WebForms 构建 MVC 表单的第一次大尝试……

有什么想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-08T13:06:06.957

我正要评论，但它运行得太久了。

您需要发布发布到的操作，`Requestform.cshtml`这里也不需要您的帐户控制器代码。我的猜测是您的托管环境是共享托管，并且有一些东西阻止您的电子邮件代码运行。

您可能想要做的第一件事是，如果您的电子邮件代码在 a`try catch`中，请暂时评论我们的 the，`try catch`以便它会抛出错误。这至少应该可以帮助您了解正在发生的事情。

接下来要做的是尝试`Elmah`为 mvc3 添加，您可以通过 Visual Studios 中的 Nuget 添加它。确保为 MVC3 使用 Elmah，因为它会为您完成大部分设置。这将让您看到是否有任何错误被抛出。

否则，如果没有看到您的实际电子邮件代码，我将无法提供更多帮助。

# macos - Word for OS X 中的运行时错误 438

> ID：12325402
> 
> 赞同：0
> 
> 时间：2012-09-07T21:05:51.970
> 
> 标签：macos, ms-word

我有一个包含宏的 Word 文档，我试图在 Word 2011 for OS X 中打开它。我收到错误“运行时 438”。我选择调试宏，Word 突出显示以下不在我的宏中的代码：

```
private Sub Document_Open()
  ActiveDocument.SelectContentControlsByTitle("Today").Item(1).Range.Text = Form(Date, "m/d/yyy")
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T22:46:05.237

看起来错误“438”是“对象不支持此属性或方法”。（参见[http://www.excelbanter.com/showthread.php?t=312817](http://www.excelbanter.com/showthread.php?t=312817)）

我猜这个文件在 Windows 上运行良好，但是你正在尝试执行一个有限的 Mac 实现的 VBasic 没有实现的操作。

# linux - Gnome Shell 扩展键绑定

> ID：12325405
> 
> 赞同：11
> 
> 时间：2012-09-07T21:06:00.780
> 
> 标签：linux, key-bindings, hotkeys, gnome-shell, gnome-shell-extensions

**（全局）将键组合（例如`<Super>+A`）绑定到 gnome shell 扩展中的函数的最简单方法是什么？**

检查几个扩展，我遇到了以下代码：

```
global.display.add_keybinding('random-name',
                              new Gio.Settings({schema: 'org.gnome.shell.keybindings'}),
                              Meta.KeyBindingFlags.NONE,
                              function() { /* ... some code */ }); 
```

我知道组合键是由 schema 参数指定的，并且可以创建一个描述组合的 XML 文件。**有没有更简单的方法来做到这一点？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2017-02-26T09:24:35.290

以下是我的答案的副本，我[只](https://superuser.com/questions/471606/gnome-shell-extension-key-binding/1182899#1182899) 在 Gnome 3.22 中测试过

## TL;博士

这是一个类：

```
KeyManager: new Lang.Class({
    Name: 'MyKeyManager',

    _init: function() {
        this.grabbers = new Map()

        global.display.connect(
            'accelerator-activated',
            Lang.bind(this, function(display, action, deviceId, timestamp){
                log('Accelerator Activated: [display={}, action={}, deviceId={}, timestamp={}]',
                    display, action, deviceId, timestamp)
                this._onAccelerator(action)
            }))
    },

    listenFor: function(accelerator, callback){
        log('Trying to listen for hot key [accelerator={}]', accelerator)
        let action = global.display.grab_accelerator(accelerator)

        if(action == Meta.KeyBindingAction.NONE) {
            log('Unable to grab accelerator [binding={}]', accelerator)
        } else {
            log('Grabbed accelerator [action={}]', action)
            let name = Meta.external_binding_name_for_action(action)
            log('Received binding name for action [name={}, action={}]',
                name, action)

            log('Requesting WM to allow binding [name={}]', name)
            Main.wm.allowKeybinding(name, Shell.ActionMode.ALL)

            this.grabbers.set(action, {
                name: name,
                accelerator: accelerator,
                callback: callback
            })
        }

    },

    _onAccelerator: function(action) {
        let grabber = this.grabbers.get(action)

        if(grabber) {
            this.grabbers.get(action).callback()
        } else {
            log('No listeners [action={}]', action)
        }
    }
}) 
```

这就是你使用它的方式：

```
let keyManager = new KeyManager()
keyManager.listenFor("<ctrl><shift>a", function(){
    log("Hot keys are working!!!")
}) 
```

您将需要导入：

```
const Lang = imports.lang
const Meta = imports.gi.Meta
const Shell = imports.gi.Shell
const Main = imports.ui.main 
```

## 解释

我可能大错特错，但这是我最近几天发现的。

首先是 Mutter 负责监听热键。Mutter 是一个创建窗口管理器的框架，它本身并不是一个窗口管理器。Gnome Shell 有一个用 JS 编写的名为“窗口管理器”的类——这是真正的窗口管理器，它在内部使用 Mutter 来执行所有低级操作。Mutter 有一个对象 MetaDisplay。这是您用来请求监听热键的对象。但！但 Mutter 将要求窗口管理器批准此热键的使用。那么当按下热键时会发生什么？- MetaDisplay 生成事件“过滤键绑定”。- Gnome Shell 中的窗口管理器检查是否允许处理此热键。- 窗口管理器向 MetaDisplay 返回适当的值 - 如果允许处理此热键，MetaDisplay 将生成事件 'accelerator-actived'

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2021-06-16T17:18:28.777

这个问题很老，但我刚刚为 Gnome Shell 40 实现了它。所以这就是我的做法。

密钥在您用于扩展设置的普通模式文件中定义。所以它看起来像这样：

```
<?xml version="1.0" encoding="UTF-8"?>
<schemalist>
    <schema id="org.gnome.shell.extensions.mycoolstuff" path="/org/gnome/shell/extensions/mycoolstuff/">
        <key name="cool-hotkey" type="as">
            <default><![CDATA[['<Ctrl><Super>T']]]></default>
            <summary>Hotkey to open the cool stuff.</summary>
        </key>

        ... other config options

    </schema>
</schemalist> 
```

键类型是“字符串数组”，因此您可以为操作配置多个组合键。

在您的代码中，您可以像这样使用它：

```
const Main = imports.ui.main;
const Meta = imports.gi.Meta
const Shell = imports.gi.Shell
const ExtensionUtils = imports.misc.extensionUtils;

...

let my_settings = ExtensionUtils.getSettings("org.gnome.shell.extensions.mycoolstuff");

Main.wm.addKeybinding("cool-hotkey", my_settings,
    Meta.KeyBindingFlags.IGNORE_AUTOREPEAT,
    Shell.ActionMode.NORMAL | Shell.ActionMode.OVERVIEW
    this._hotkeyActionMethod.bind(this)); 
```

我建议在扩展程序被禁用时删除键绑定。不知道如果你不这样做会发生什么。

```
Main.wm.removeKeybinding("cool-hotkey"); 
```

顺便说一句：对设置的更改（通过 dconf 编辑器、gsettings 或您的扩展首选项）会立即生效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-03-07T14:02:04.737

与@p2t2p 相同，但使用 ES5 类重铸。这也使用了我的记录器类，但您可以用 log() 替换它。

```
const Lang = imports.lang
const Meta = imports.gi.Meta
const Shell = imports.gi.Shell
const Main = imports.ui.main

const ExtensionUtils = imports.misc.extensionUtils;
const Me = ExtensionUtils.getCurrentExtension();

const Logger = Me.imports.logger.Logger;

var KeyboardShortcuts = class KeyboardShortcuts {
  constructor(settings) {
    this._grabbers = {};

    this.logger = new Logger('kt kbshortcuts', settings);

    global.display.connect('accelerator-activated', (display, action, deviceId, timestamp) => {
      this.logger.debug("Accelerator Activated: [display=%s, action=%s, deviceId=%s, timestamp=%s]",
        display, action, deviceId, timestamp)
      this._onAccelerator(action)
    });
  }

  listenFor(accelerator, callback) {
    this.logger.debug('Trying to listen for hot key [accelerator=%s]', accelerator);
    let action = global.display.grab_accelerator(accelerator, 0);

    if (action == Meta.KeyBindingAction.NONE) {
      this.logger.error('Unable to grab accelerator [%s]', accelerator);
      return;
    }

    this.logger.debug('Grabbed accelerator [action={}]', action);
    let name = Meta.external_binding_name_for_action(action);
    this.logger.debug('Received binding name for action [name=%s, action=%s]',
        name, action)

    this.logger.debug('Requesting WM to allow binding [name=%s]', name)
    Main.wm.allowKeybinding(name, Shell.ActionMode.ALL)

    this._grabbers[action]={
      name: name,
      accelerator: accelerator,
      callback: callback
    };
  }

  _onAccelerator(action) {
    let grabber = this._grabbers[action];

    if (grabber) {
      grabber.callback();
    } else {
      this.logger.debug('No listeners [action=%s]', action);
    }
  }
} 
```

并像使用它一样，

```
 this.accel = new KeyboardShortcuts(this.settings);
      this.accel.listenFor("<ctrl><super>T", () => {
        this.logger.debug("Toggling show endtime");
        this._timers.settings.show_endtime = !this._timers.settings.show_endtime;
      }); 
```

# c++ - C++中的函数模板，两个问题

> ID：12325407
> 
> 赞同：0
> 
> 时间：2012-09-07T21:06:23.157
> 
> 标签：c++, templates

我是 C++ 的初学者，并使用“C++ Primer Plus”这本书来自学这门语言，并在编程中变得更加自如。

我在书中做了一些与功能模板主题相关的练习，我有两个问题。

我不明白为什么以下明确的专业化不起作用：

```
template <typename T>
T lesser(T a, T b)
{
        return a > b ? a : b;
}

template <> 
box lesser<box>(box& a, box& b)
{
        return a.volume > b.volume? a : b;
} 
```

假设我有一个 box 类型的结构，为什么不能将类型专门化为键入“box&”而键入“box”？第二个声明的意思是“不要使用 lesser() 模板来生成函数定义。而是使用单独的专用函数”。而且，我不能使用 type box&，只能使用 box。这是为什么？

编辑：好的，第二个问题本身就消失了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T21:14:40.677

您必须在每个实例中都专注`T`于相同的类型：

```
template <>
box& lesser<box&>(box& a, box& b)
{
    // ...
} 
```

或者你可以`box`在任何情况下使用。

* * *

或者，您可以将模板更改为：

```
template <typename T>
T lesser(const T& a, const T& b)
{
        return a > b ? a : b;
} 
```

并将其专门化为

```
template <>
box lesser(const box& a, const box& b)
{
        // ...
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T21:14:50.730

模板只有一个参数-T。返回类型和参数类型需要相同。但是您的专业化通过引用获取参数并按值返回 - 这是两种不同的类型，因此模板和专业化不匹配。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T21:13:49.263

您的专长与模板不匹配。模板期望一个函数通过值获取两个对象并返回一个相同类型的对象。您的专业化是一个函数，它采用两个盒子对象**引用**并返回一个盒子对象。

哦，在它被删除之前，您的第二个示例演示了这一点，因为所有东西都很好地匹配。回到那个并与这个进行比较。

# gnuplot - Gnuplot：线条不透明度/透明度？

> ID：12325410
> 
> 赞同：16
> 
> 时间：2012-09-07T21:06:34.230
> 
> 标签：gnuplot

我正在使用 Gnuplot 成功绘制一些时间序列数据。但是，该系列相当密集（大约 5 英寸空间内有 10,000 个样本），当我绘制多个系列时，很难在顶部绘制的系列下方看到。**有什么方法可以使线条具有一点不透明度或透明度（即使线条透明，以便下面的线条可见）？**

Excel 具有此功能，但我更喜欢使用 Gnuplot。

以下是我正在谈论的示例。你看不到绿线下面的红线。我实际上想添加第三个时间序列。我正在使用以下命令进行绘图：

```
plot [][-3:3] 'samples_all.csv' using 1:7 title 'horizontal' w l ls 1, '' using 1:8 title 'vertical' w l ls 2" 
```

![在此处输入图像描述](../Images/9be710fbe31f4ba721d4725d1a71ae56.png)

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-09-07T22:02:25.083

好消息！这已在 gnuplot 中实现。示例语法是

```
plot x lw 10, -x lw 10 lc rgb "#77000000" 
```

这会将 x 绘制为一条红线，将 -x 绘制为一条透明的黑线（它看起来是灰色的）。rgb 规范中的第一对两个字符定义了 alpha（透明度）通道（“#AARRGGBB”）。正常语法（“#RRGGBB”）仍然有效。

### 旧（gnuplot < 5.0 左右）答案供参考：

如果您想为时间序列数据绘制线，答案是否定的（请参阅[此处](http://old.nabble.com/transparent-lines-and-points-td25285912.html)的讨论）。您不能将线条样式设置为透明。透明度仅适用于曲线下方的填充，并且必须打印到正确的终端类型。

我自己最近也遇到了这个问题，希望以后的gnuplot版本能添加这个功能。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-07T21:47:05.193

[这](http://gnuplot-surprising.blogspot.com/2011/09/transparency-in-gnuplot.html)可能是您正在寻找的。

# cakephp - CakePHP：缓存不起作用

> ID：12325419
> 
> 赞同：1
> 
> 时间：2012-09-07T21:08:11.843
> 
> 标签：cakephp, caching

我有以下问题：我的 cakephp 应用程序没有正确处理缓存。正如 google 中的每个结果所建议的那样，我在模型中创建了一个函数来手动删除缓存：

```
public function afterSave($created) {
    Cache::clear();
    clearCache();
} 
```

不幸的是，这无济于事。没有删除任何东西，我仍然有问题。

如果我没有正确解释自己，我将举例说明会发生什么：

我使用浏览器转到一个页面，该页面显示了我数据库中最后 5 条记录的列表。然后我去添加另一条记录。我回到显示最后 5 个的页面，并且信息没有更新。它使用缓存并返回过时的信息。如果我按 F5，那么他的页面 trully 会重新加载，我会看到 trully 5 最后的记录。

就是这样，我不知道该怎么办。整个应用程序就像垃圾一样工作，因为你做了一些事情，除非你用 F5 刷新页面，否则它永远不会出现，这当然是用户不知道的，导致他们认为实际上是“没有添加任何内容”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T01:43:35.890

`Cache::clear()`只会清除已过期的条目。

试试`Cache::clear(FALSE)`。如果你有 CakePHP 2.x 就可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-08T21:28:22.617

我这样做是为了解决问题：在控制器中，在 beforefilter 函数中我进行了检查，如果该操作是我禁用缓存的东西。

您选择的操作不会有浏览器缓存。

```
function beforeFilter(){
    if ($this->action == 'youraction'){
       $this->disableCache();
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-15T11:05:04.667

使用缓存需要大量思考，在哪里使用，哪里不使用。如果您的更新频繁，请不要在此处使用缓存。

我们在数据很少变化的地方使用缓存，那是双赢的局面。

***缓存::clear($check, $config = 'default')***

销毁缓存配置的所有缓存值。

[cakephp缓存](http://book.cakephp.org/2.0/en/core-libraries/caching.html)

# ssrs-2008 - 电子邮件订阅的 SSRS 动态文件名

> ID：12325420
> 
> 赞同：7
> 
> 时间：2012-09-07T21:08:15.303
> 
> 标签：ssrs-2008, reporting-services

我们正在将报告从 迁移`Crystal Reports`到`SSRS`. 在 Crystal Reports 中，我们使用变量**动态****生成**我们的文件名，因此当通过电子邮件发送报告时，该文件具有报告名称和执行日期。（例如`MonthlyReport09-07-2012.xls`）。

这在SSRS中可能吗？在订阅报告时，我看不到任何直接在文件名中使用变量的方法。当向同一个人发送多个具有相同文件名的报告时，这可能会很麻烦，因为很难辨别哪个报告是哪个。

任何帮助是极大的赞赏。谢谢你这么。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-10T22:33:23.107

SSRS 中没有这样的功能，但有一个解决方法。您有两个选项
选项 1：
与其直接通过电子邮件发送它，不如先将文件转储到文件共享位置，该位置可能类似于 \machine-name\ExportReports\ReportName\ 然后创建一个 Windows 作业，将文件重命名为您想要的格式并通过电子邮件发送在下一步中。

选项 2：
请参阅此[博客](http://beyondrelational.com/modules/2/blogs/109/posts/11174/generating-and-exporting-ssrs-reports-programatically-using-report-viewer-control.aspx)您想要的内容从“以编程方式生成 PDF 输出文件”部分开始，现在您可以在程序集中使用它，然后有一些调度机制来获取时间表。然后调用生成报告并通过电子邮件发送报告的 DLL。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-12-04T21:14:45.403

在文件名中使用**@timestamp**，它将在运行时进行翻译。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-10T23:09:28.830

您不能在 Reporting Services 的标准订阅中指定报告文件名。

如果您有企业版（或 SQL 2012 商业智能版），则可以使用数据驱动订阅功能，该功能允许您根据从表中检索到的数据指定报告文件名（和其他属性）。

如果您有标准版，那么您的选项是 Bhupendra 建议的选项之一，或者您可以查看使用 Reporting Services 提供的“rs.exe”实用程序编写报告生成脚本并使用数据库邮件和 SQL Server 代理来处理电子邮件和日程安排。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-25T17:01:42.353

这篇文章看起来很老了，但迟到总比不...

市场上有一些工具可以运行 SSRS 报告：[CRD](http://go.christiansteven.com/ssrs-sql-server-reporting-services-sqlrd)、[R-Tag](http://www.r-tag.com/Pages/ReportManager.aspx)和 [RemiWare](http://www.remiware.com/)

这些是桌面工具，但我猜你不是要替换 SSRS ，只是为了扩展它。

我不确定 CRD 和 RemiWare ，但 R-Tag 支持数据驱动的报告和动态名称。它也可以与标准许可证一起使用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-26T23:58:36.503

我能够通过循环通过帐户、发票和电子邮件表来自动发送电子邮件并更改文件名，然后设置参数并重命名目录中的报告名和路径名在执行结束后执行我做了等待持续 2 秒，然后何时进入下一个循环。最后我将路径和名称设置回原始名称。表现不错。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-06-12T11:48:01.887

@timestamp 适用于 Chris 回答的 Windows 文件共享。

对于电子邮件递送，您可以使用：

@ReportName - 指定报告的名称。

@ExecutionTime - 指定执行报告的时间。

有关更多详细信息 - [MS Docs](https://docs.microsoft.com/en-us/sql/reporting-services/subscriptions/e-mail-delivery-in-reporting-services?view=sql-server-2017)

# jquery - IE 和 FF 中的 $(window).height() 问题

> ID：12325424
> 
> 赞同：4
> 
> 时间：2012-09-07T21:08:21.443
> 
> 标签：jquery, cross-browser, height

我编写了一个脚本来`div`在我的页面中创建一个动态大小的（#table）。我还有一个菜单（#menu），`nav`里面有一个确定最小高度的菜单。在 Chrome 和 Safari 中一切正常，但在 IE/FF 中就没有那么多了。在这两种情况下，我都有同样的问题：如果我全屏加载页面，然后使用最小化按钮将其最小化，则会出现错误的 `$(window).height()`. 如果我重新加载它最小化，它可以正常工作，我什至可以调整大小以使 div 调整好。我放了一些图片来清楚我在说什么。

对于FF，我还有另一个问题。当窗口大小大于菜单时，它总是在 div 的底部有一个空格。就像我在其他浏览器中应用的值不适合 Firefox。这个问题只是高度。动态宽度工作正常。

我的**浏览器版本**如下：我认为它们是最新的。

*   铬 21.0.1180.89 m
*   Safari 5.1.7
*   互联网浏览器 9
*   火狐 14.0.1

**这是我的 javascript/jQuery 代码：**

```
<!-- Menu resize -->
<script type='text/javascript'>
$(function(){
    $('#menu').css({'height':(($(window).height())-350)+'px'});
    $('#table').css({'height':(($(window).height())-225)+'px'});
    $('#table').css({'min-height':(($('nav').height())-15)+'px'});
    $('#table').css({'width':(($(window).width())-135)+'px'});

    $(window).resize(function(){
          $('#menu').css({'height':(($(window).height())-350)+'px'});
          $('#table').css({'height':(($(window).height())-225)+'px'});
          $('#table').css({'width':(($(window).width())-151)+'px'});
    });
});
</script> 
```

部分页面**样式**：

```
/* NAV */

#line{
    width:1px;
    position:absolute;
    left:147px;
    top:123px;
    bottom:0px;
    background-color:#b3b3b3;
}

nav{
    width:147px;
    min-height: 100%;
    float:left;
}

nav ul{
    list-style:none;
    padding:0px;
    margin:0px;
}

nav li{
    display:block;
    width:147px;
    height:24px;
    line-height:24px;
    border-bottom: 1px solid #b3b3b3;
    text-indent:30px;

    -moz-box-shadow:    inset 1px 1px 1px #ffffff;
    -webkit-box-shadow: inset 1px 1px 1px #ffffff;
    box-shadow:         inset 1px 1px 1px #ffffff;
}

nav li a{
    color:#808080;
    font-size:14px;
    text-decoration:none;
    display:block;
}

nav li:hover{
    background-color:#cccccc;
    -moz-box-shadow: none;
    -webkit-box-shadow: none;
    box-shadow: none;
}

nav li .active{
    background-color:#fdad06;
    -moz-box-shadow: none;
    -webkit-box-shadow: none;
    box-shadow: none;
}

nav li a.active{
    color:#7e5303;
}

nav li:first-child{
    border-top: 1px solid #b3b3b3;
}

nav #group{
    width:148px;
    height:49px;
    font-size:14px;
    font-weight:bold;
    line-height:49px;
    text-indent:22px;
}

/* SECTION */

#menu_and_content{
    width:auto;
    display:block;
    background-image:url(images/background.jpg);
    box-shadow:inset 0 5px 5px rgba(0,0,0,.2) 
}

#menu_and_content #menu{
    width:148px;
    vertical-align:top;
    border-right-style:solid;
    border-right-width:1px;
    border-right-color:#b3b3b3;
    padding: 0px 0px 20px 0px;
}

#menu_and_content #content{
    width:100%;
    vertical-align:top;
}

#table{
    overflow-x:scroll;
    overflow-y:scroll;
    width:500px;
}

#table table{
    width:100%;
    font-size:11px;
    padding:25px 25px 25px 25px;
    text-align:left;
    }

#table table thead th{
    font-size:12px;
    font-weight:bold;
    color:#969696;
    cursor:pointer;
}

#content table td, th{
    border-bottom:solid;
    border-bottom-color:#afafaf;
    border-bottom-width:1px;
    white-space: nowrap;
    padding:0px 5px 0px 10px;
    line-height:24px;
}

#content table td:first-of-type, th:first-of-type {
    padding-left:4px;   
}

#content table tr:hover:not(#captions){
    background-color:rgba(255,255,255,0.4);
    color:#3e3a34;
    cursor:pointer;
}

#content table input[type='checkbox']{
    margin-top:2px;
    border-color:#949494;
}

#login_container{display:block; height:260px;} 
```

**以下是图片**：

 **![布局](../Images/d34b44403b9386973feb1a33e084b0e8.png)

![铬合金](../Images/168e2bd2a85d3d698f067fc5baf12c4c.png)

![苹果浏览器](../Images/72433b23f5105c1e006189cef945b6a4.png)

![互联网探索者（问题 1）](../Images/322bd5d68d734fd52e2ef271fdaa111c.png)

![火狐（问题 1）](../Images/00d93b6d020b703fe2d00690d742b9bd.png)

![火狐（问题 2）](../Images/fe59ad14cbb059fb6cf3a4ccac3ebefc.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T14:30:08.823

我在使用 Firefox 时遇到了同样的问题，我将它添加到我的所有 HTML 文件中解决了这个问题。在这个堆栈溢出问题中指出了解决方案：

[为什么 Firefox 返回 0 作为 $(window).height() 的值](https://stackoverflow.com/questions/12937494/why-does-firefox-return-0-as-the-value-of-window-height)

**jQuery 1.8.1**发行说明说

> 不要使用怪癖模式！jQuery 从未支持 Quirks 模式，我们不会在 Quirks 中进行任何测试。这可能会影响像 $("window").height() 这样的值，并且 jQuery 1.8 Quirks 模式的结果确实发生了变化，以支持一些现代浏览器功能。我们看到的大多数问题案例都来自希望处于标准模式但在其标签之前有无效文档类型或无关标记的开发人员。如有疑问，请使用 simple 和 short 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T21:23:27.977

尝试`innerHeight()`或`outerHeight()`代替`height()`

可能不包括填充/边框/边距

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-11T11:58:45.203

请看看这个博客。他对浏览器中的屏幕测量进行了非常详细的研究

[http://tripleodeon.com/2011/12/first-understand-your-screen/](http://tripleodeon.com/2011/12/first-understand-your-screen/)**

# java - 做一个 API，构造函数仅供系统私有使用，另一个官方，javadoc'ed 和公共使用。关于修复/模式方法的建议

> ID：12325426
> 
> 赞同：1
> 
> 时间：2012-09-07T21:08:32.063
> 
> 标签：java, constructor, design-patterns, private

我想这是一个糟糕的模式，修复它的最佳方法是什么？

我的意思是我希望每个人都使用带有 2 个参数的构造函数，但我需要保留默认构造函数，因为它实现了一个侦听器，该侦听器在没有 args 的情况下对其进行类加载。我想向除使用它的侦听器处理程序之外的任何其他人隐藏默认构造函数，并使另一个作为实例化的唯一点。

有什么注释吗？某些类的任何隐私修饰符（系统调用者不在同一个包中）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T21:13:37.940

这对我来说似乎很好。如果你想在单元测试期间以不同的方式实例化一个类，你会做同样的事情。

哦，我看到您需要一个具有比受保护更多但比公共更少访问权限的构造函数。不幸的是，这是不可能的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T21:16:43.603

您可以将您的类和需要使用空构造函数`MyClass`的侦听器放在同一个包中。`MyListener`然后，将空构造函数的访问权限设置为**[package-level](http://docs.oracle.com/javase/tutorial/java/javaOO/accesscontrol.html)**：

```
package com.stackoverflow.foo;

public class MyClass {
  MyClass () {  // package-private (no explicit access modifier) 
  }

  public MyClass(int a, int b) {  // public
  }
}

package com.stackoverflow.foo;

public class MyListener {
  private MyClass ref = new MyClass(); // MyListener is on the same package as MyClass, so this is valid
} 
```

这样，您可以确保只有在同一个包中的类`MyClass`才能使用默认构造函数。

# ssrs-2008 - SSRS 字段范围问题

> ID：12325429
> 
> 赞同：4
> 
> 时间：2012-09-07T21:08:44.230
> 
> 标签：ssrs-2008, reporting-services

我有一个 SSRS 2008 R2 报告，它在表中使用此表达式：

```
=Lookup(Fields!DataSet1Date.Value, Fields!DataSet2Date.Value, Fields!DataSet2Price.Value, "DataSet2") 
```

我有 2 个数据集，并且正在使用 Lookup 函数根据另一个数据集中的日期从一个数据集中获取数据。

我的问题是这适用于我尝试过的机器，但其他人却遇到这样的错误：

```
Error   1       [rsFieldReference] The Value expression for the text box ‘Col_D2Price’ refers to the field ‘DataSet2Date’.  Report item expressions can only refer to fields within the current dataset scope or, if inside an aggregate, the specified dataset scope.
Error   2       [rsFieldReference] The Value expression for the text box ‘Col_D2Price’ refers to the field ‘DataSet2Price’.  Report item expressions can only refer to fields within the current dataset scope or, if inside an aggregate, the specified dataset scope. 
```

我们还能做些什么来解决这个问题？我们都使用相同的 2008R2 版本。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-04T09:20:03.440

`LookUp`使用该功能时，我经常会收到此“幻影”错误。我称它为幻影，因为我在哪里找不到原因，但是您会弹出错误。

在我的情况下解决它的唯一方法是使用辅助功能[`LookUpSet`](http://msdn.microsoft.com/en-us/library/ee240819.aspx)。

希望我有所帮助。

**编辑：**

此外，你对我很感兴趣，所以我做了一些研究：

1.  该`lookup`功能仅适用于一对一关系。
2.  `loopupset`功能是一对多的关系。
3.  该`multilookup`函数适用于许多一对一的关系，即在第二个数据集中只有一个值的单个值数组。不相关但很有趣。

我还遇到了一个潜在的修复。这在新机器上尝试打开报表中的数据集和`refresh all`对话框中的字段。出于某种原因，这可能会将字段重新链接到此表达式。去图...阻止引用

# .net - 跟踪应该出于逻辑目的收集的对象

> ID：12325431
> 
> 赞同：1
> 
> 时间：2012-09-07T21:08:58.663
> 
> 标签：.net, garbage-collection, weak-references

1.  我有用 Wea​​kReferences 填充的字典。
2.  Web 服务 A：创建对象并将其放置在弱引用字典上。(1)
3.  Web 服务 A 有时会保留具有强引用的对象，有时则不会。

我的问题：

我无法跟踪应该从弱引用字典中删除的对象，因为垃圾收集器不会立即收集它们，它只会在随机且不可预测的时间后收集。

行为不一致，例如

示例 1：按预期工作，变量 ex1 立即被收集。

```
Sub Example1(id as integer)
Dim ex1 as new Object
dim t as new WeakReference With {.target = ex1};
WeakReferenceDictionary.add(id,ex1)
End Sub<br> 
```

Example2 '这不起作用，ext1 没有立即收集

```
Sub Example1(id as integer)
  Dim ex1 as new Object
  dim t as new WeakReference With {.target = ex1};
  WeakReferenceDictionary.add(id,ex1)

  otherclass.refObject = ex1
  otherclass.refObject = Nothing

End Sub<br> 
```

我努力了。
将 WeakDictionary 放在 Module1 内（是一个控制台应用程序）。
GC.Collect
GC.Collect(0)
GC.Collect(1)
GC.Collect(2)

我的问题。无论如何，即使它会降低我的应用程序的性能，是否真的强制进行垃圾收集。我知道我不应该将 GC 用于逻辑目的，但对于我的解决方案来说，这样做真的很方便。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T21:18:19.227

我将以免责声明开始这篇文章：我非常怀疑你是否选择了正确的方法来依赖垃圾收集内部，因为不能保证，不可预测，即使现在测试可以工作，你的代码可能会与任何 .NET 中断补丁发布。

您的对象可能未被收集的原因有多种：

1.  您正在调试器下运行或已在调试模式下构建。这将稍微延长对象的生命周期（JIT 不会急切地将变量内容标记为未使用，以便即使变量超出范围，您也可以调试变量）。
2.  您将 GC.Collect 调用放置在错误的位置
3.  尽管您的对象有一个，但您没有调用 WaitForPendingFinalizers

也许还有其他原因。

那么如何解决这个问题呢？不要依赖GC。依赖确定性操作，例如实现和调用 Dispose 或切换到引用计数技术。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-08T16:48:56.757

感谢exaceratedexpert；阅读文章 www.sellsbrothers.com/writing/refcount_rotor.doc，发现真正强制 GC 以确保所有应该被处理的对象实际上都将以可预测的方式被处理是不切实际的。

必须实现引用计数器（如文章所示）。

我发现的另一个解决方案是创建一个包含已创建的特定类的所有对象的数组，然后使用根节点通过反射执行第二次查看，然后比较两者并找出谁是missig。这种方法将确保获得干净一致的结果，但会消耗太多资源，不得不进行完整的根子扫描。

谢谢你们的回答。

# php - 优化以下 PHP 代码的最佳方法是什么？

> ID：12325433
> 
> 赞同：2
> 
> 时间：2012-09-07T21:09:16.460
> 
> 标签：php, regex, optimization, str-replace

我是 php 的新手。你能告诉我优化这个 php 代码以获得最佳性能的最佳方法是什么：

```
 $data = mysql_query("SELECT * FROM wcddl_recents ORDER BY id DESC LIMIT 15");
$searchai = mysql_fetch_array( $data );
while($searchai = mysql_fetch_array($data)) {
$searchai[query] = strip_tags($searchai[query]);
    $searchai_clean = str_replace(array("/","\\","'",'"',"<",">","-","+","%","@","%20","(",")",":","[","]","{","}","?","!")," ",$searchai[query]);
    $searchai_cleandvigubai = str_replace(" ","-",$searchai_clean);
    $searchai_cleandvigubaix = str_replace(array("---","--"),"-",$searchai_cleandvigubai);
    $searchai_cleandvigubai2 = strtolower($searchai_cleandvigubaix); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T21:32:24.287

请务必注意优化俱乐部的规则：

1.  优化俱乐部的第一条规则是，你不要优化。
2.  优化俱乐部的第二条规则是，**你不优化而不测量**。
3.  如果您的应用程序运行速度比底层传输协议快，那么优化就结束了。
4.  一次一个因素。
5.  没有市场机器人，没有市场机器人时间表。
6.  只要需要，测试就会继续进行。
7.  如果这是您在优化俱乐部的第一个晚上，您必须编写一个测试用例。

您需要注意的两个大问题是#2 和#3。

首先，您在没有测量的情况下进行优化。您还不知道该代码块的哪些部分花费的时间最多。为此，您需要一个工具来告诉您，例如 xdebug。如果做不到这一点，请在每个语句之后调用 PHP 的`microtime()`函数来计算每个语句的执行时间。

似乎提供的大多数答案都为您提供了加速字符串函数的方法，但我敢打赌，调用 SQL 函数和返回行所花费的时间会使这些字符串函数的执行时间相形见绌。例如，如果整个代码运行时间为 1000 毫秒，SQL 调用需要 970 毫秒，字符串函数需要 30 毫秒，那么即使将字符串函数的速度减半，也只能节省 15 毫秒。

假设 SQL 调用是瓶颈，看看你能做些什么来加速它们。SQL 查询是否使用了它应该使用的索引？ID 列是否被索引？

您是否使用了正确的 PHP 函数？是否有一个`mysql_*`函数可以一次性返回结果中的所有行，而不是访问数据库 15 次？就此而言，函数`mysqli_`或`pdo_`函数集是否以某种方式更快？这些`mysql_`功能已正式弃用。（查看[大红框](http://php.net/manual/en/function.mysql-fetch-array.php)并阅读替代方案。）

最后，你需要它跑多快？如果现在运行需要 10 秒，您希望它运行多快？9秒够快吗？或者你需要它在 1 中运行吗？您甚至可能无法获得所需的加速。

tl;dr：在尝试加速代码**之前**找出慢的部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T21:14:51.543

这个怎么样？更少的变量，你可以在第一条语句中使用 strtolower 和 strip_tags。

您正在用空格替换几个字符，然后用破折号替换空格。还不如把两者结合起来。还要从干净的替换件上取下破折号。它被替换为一个空格，然后又是一个破折号，除非它是 Microsoft 双破折号，此时您可以在下面的示例中再次添加它。

```
$searchai[query] = strtolower(strip_tags($searchai[query]));
$searchai_clean  = str_replace(array("/","\\","'",'"',"<",">","+","%","@","%20","(",")",":","[","]","{","}","?","!"),"-",$searchai[query]);
$searchai_cleandvigubaix = str_replace(array("---","--"),"-",$searchai_clean); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T21:59:29.550

不要优化它；剖析它。

使用诸如[XDebug](http://xdebug.org)之类的分析器工具来找出代码的哪些部分运行时间最长。一旦您知道代码的哪些部分花费的时间最多，您就可以专注于这些区域。

加速这些特定代码区域的少量工作将比数月修补边缘产生更大的影响。

事实上，除非你在一个流量很大的网站上工作，并且需要节省每一个可能的带宽字节，否则人们称之为“优化”的所有在边缘上的修补可能会产生几乎为零的可识别效果。

简而言之：找出什么是慢的；解决这个问题。不要打扰其余的。

# unity-container - Unity 的程序集绑定重定向不起作用

> ID：12325434
> 
> 赞同：1
> 
> 时间：2012-09-07T21:09:17.753
> 
> 标签：unity-container, .net-assembly, assembly-loading

我正在创建一个新的 MVC 4 网站，我想使用 Unity.MVC3 库与 MVC 中内置的 DependencyResolver 内容集成。

我还想从一个旧的、更大的项目中引用一些数据访问 DLL。

我的问题是 Unity.MVC3 和较旧的 DLL 分别针对不同版本的 Unity 1.2.0.0 和 2.1.505.0 进行编译。我尝试在我的 web.config 文件中创建绑定重定向，如下所示：

```
 <dependentAssembly>
    <assemblyIdentity name="Microsoft.Practices.Unity" publicKeyToken="31bf3856ad364e35" />
    <bindingRedirect oldVersions="1.2.0.0-2.1.505.0" newVersion="2.1.505.0" />
  </dependentAssembly> 
```

但是，我仍然收到以下错误：

```
 Could not load file or assembly 'Microsoft.Practices.Unity, Version=1.2.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040) 
```

我打开了程序集绑定日志记录，最后两行说明：

```
 WRN: Comparing the assembly name resulted in the mismatch: Major Version
 ERR: Failed to complete setup of assembly (hr = 0x80131040). Probing terminated. 
```

为什么我的绑定重定向不被尊重？有没有办法覆盖它对主要版本冲突的检查？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T06:52:10.383

密钥令牌中有错字：

```
<assemblyIdentity name="Microsoft.Practices.Unity" 
     publicKeyToken="31bf856ad364e35" /> 
```

应该：

```
<assemblyIdentity name="Microsoft.Practices.Unity" 
     publicKeyToken="31bf3856ad364e35" /> 
```

如果出现拼写错误，绑定重定向[不会抱怨](https://stackoverflow.com/a/3981611/274340)，它什么也不做。

我制作了一个测试应用程序，使用此配置它可以工作：

```
<runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="Microsoft.Practices.Unity" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="1.2.0.0" newVersion="2.1.505.0" />
      </dependentAssembly>
    </assemblyBinding>
  </runtime> 
```

注意`xmlns`，没有它，它会默默地失败。

# java - 如何从 mac lion OS 卸载 play 框架？

> ID：12325437
> 
> 赞同：0
> 
> 时间：2012-09-07T21:09:24.697
> 
> 标签：java, playframework

我删除了提取到我的 /Applications 的 play 2.0 文件。但是，当我在终端中输入“播放”时。一切正常？？

还有其他可靠的方法可以让我的系统发挥作用吗？

# jquery - jQuery .css 不适用于 p 和 p.class

> ID：12325438
> 
> 赞同：2
> 
> 时间：2012-09-07T21:09:25.607
> 
> 标签：jquery, css, class

我有一个 jQuery 函数，可以重新调整页面中许多元素的字体大小和行高，包括 p 和 p.latest_news。**除了 p.latest_news 之外，该函数对所有其他元素都按预期工作**

应用于 p.latest_news 的 font-size 和 line-height 等于 p no class (ie `$('p').css({...`)

jQuery.1.7.1

代码

```
 $('p.article_news').css({
            'font-size' : Math.max(11,(.9 * newFontSize)),
            'line-height' : Math.max(13,(1.1 * newFontSize))+'px'
            });
    $('p').css({
            'font-size' : Math.max(14,newFontSize),
            'line-height' : Math.max(21,(1.7 * newFontSize))+'px'
            }); 
```

如果我只使用

```
 $('p.article_news').css({
            'font-size' : Math.max(11,(.9 * newFontSize)),
            'line-height' : Math.max(13,(1.1 * newFontSize))+'px'
            }); 
```

p.article_news 字体大小和行高按预期更改

为什么会这样？我如何影响每个 p、class 和 classless？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T21:11:55.950

您正在设置 article_news 字体大小，然后使用第二个选择器再次更改它。

你需要的是：

```
$('p.article_news').css({
        'font-size' : Math.max(11,(.9 * newFontSize)),
        'line-height' : Math.max(13,(1.1 * newFontSize))+'px'
        });
$('p:not(.article_news)').css({
        'font-size' : Math.max(14,newFontSize),
        'line-height' : Math.max(21,(1.7 * newFontSize))+'px'
        }); 
```

:not() 选择器基本上选择了所有没有类 .active_news 的 p 节点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T21:14:35.507

只需翻转您的功能。首先使用带有 p 选择器的函数，然后使用带有 p.article_news 选择器的函数。

您的 p 选择器函数覆盖了 p.article_news 选择器函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T21:19:38.420

我喜欢马克的解决方案。

但是如果这两个函数一起调用，你可以翻转它们并让它们工作。

```
$('p').css({
            'font-size' : Math.max(14,newFontSize),
            'line-height' : Math.max(21,(1.7 * newFontSize))+'px'
            });
$('p.article_news').css({
            'font-size' : Math.max(11,(.9 * newFontSize)),
            'line-height' : Math.max(13,(1.1 * newFontSize))+'px'
            }); 
```

可能比检查更快`:not`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T21:13:23.447

您正在覆盖您在设置样式时添加的`p.article_news`样式，`p`因为所有样式`p.article_news`都是`p`. 您可以先设置样式，`p`然后设置`p.article_news`，也可以使用`p:not(.article_news)`代替`p`。

# javascript - show() 用 children() 隐藏的 div（拖放）

> ID：12325446
> 
> 赞同：2
> 
> 时间：2012-09-07T21:10:18.337
> 
> 标签：javascript, jquery, drop-down-menu, show-hide

这里的第一个问题:)

我正在使用一些拖放 div，我想在拖放到特定 div 时显示隐藏的内容。

这是我的拖放功能：

```
function drop(ev) {

    ev.preventDefault();

    var data=ev.dataTransfer.getData("Text");
    ev.target.appendChild(document.getElementById(data));

    if($(ev.target).hasClass("items")){

        $(ev.target).children('div').children('.post').hide();
    }
    else if($(ev.target).hasClass("dropzone")) {

        $(ev.target).children('div').children('.post').show();
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T21:13:28.563

看看这是否有帮助：

[https://developer.mozilla.org/en-US/docs/DragDrop/Drag_Operations](https://developer.mozilla.org/en-US/docs/DragDrop/Drag_Operations)

# php - crontab 无法正常运行

> ID：12325449
> 
> 赞同：0
> 
> 时间：2012-09-07T21:10:37.363
> 
> 标签：php, linux, ubuntu, cron

我正在尝试在 Ubuntu 上运行 crontab，我想我大致了解了如何创建 crontab

我做了以下...

1）运行命令`crontab -e`

2) 添加条目`04 22 * * * /var/www/update_ranks >> /root/update_ranks.root.txt`

`update_ranks.root.txt`3) 检查在指定
时间在 root/name 下创建了一个文本文件。

文件`update_ranks.root.txt`为空，php文件没有执行，我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T21:14:01.557

如果`update_ranks`是 bash 文件，请尝试在脚本之前添加 sh`sh /var/www/update_ranks`

顺便说一句，检查您是作为 root 用户还是对`/root`. 试试`sudo crontab -e`。

**编辑：**

如果它是一个 PHP 文件，你需要在 php 中执行它，`/usr/bin/php /var/www/update_ranks`如果文件有扩展名，使用这个：`/usr/bin/php /var/www/update_ranks.php`

# python - 如何在 Selenium WebDriver 中获取元素的文本，而不包括子元素文本？

> ID：12325454
> 
> 赞同：51
> 
> 时间：2012-09-07T21:11:21.513
> 
> 标签：python, html, selenium, selenium-webdriver

```
<div id="a">This is some
   <div id="b">text</div>
</div> 
```

获得“这是一些”并非易事。例如，这会返回“这是一些文本”：

```
driver.find_element_by_id('a').text 
```

一般而言，如何获取特定元素的文本而不包括其子元素的文本？

（我在下面提供了一个答案，但如果有人能想出一个不那么可怕的解决方案，我会留下这个问题）。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-09-26T23:26:51.443

这是一个通用的解决方案：

```
def get_text_excluding_children(driver, element):
    return driver.execute_script("""
    return jQuery(arguments[0]).contents().filter(function() {
        return this.nodeType == Node.TEXT_NODE;
    }).text();
    """, element) 
```

传递给函数的元素可以是从`find_element...()`方法中获得的东西（即它可以是一个`WebElement`对象）。

或者，如果您没有 jQuery 或不想使用它，您可以将上述函数的主体替换为：

```
return self.driver.execute_script("""
var parent = arguments[0];
var child = parent.firstChild;
var ret = "";
while(child) {
    if (child.nodeType === Node.TEXT_NODE)
        ret += child.textContent;
    child = child.nextSibling;
}
return ret;
""", element) 
```

我实际上在测试套件中使用此代码。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2020-01-11T19:57:40.563

在您共享的 HTML 中：

```
<div id="a">This is some
   <div id="b">text</div>
</div> 
```

文本`This is some`在[文本节点](https://www.w3schools.com/jsref/met_document_createtextnode.asp)内。以结构化的方式描述[文本节点](https://www.w3schools.com/jsref/tryit.asp?filename=tryjsref_document_createtextnode)：

```
<div id="a">
    This is some
   <div id="b">text</div>
</div> 
```

* * *

## 这个用例

要使用[Selenium](https://stackoverflow.com/questions/54459701/what-is-selenium-and-what-is-webdriver/54482491#54482491)的[python](/questions/tagged/python "show questions tagged 'python'")**`This is some`**客户端从*文本节点*中提取和打印文本，您有以下两种方法：

*   使用`splitlines()`：您可以识别父元素即`<div id="a">`，提取`innerHTML`然后使用`splitlines()`如下：

    *   使用*xpath*：

        ```
        print(driver.find_element_by_xpath("//div[@id='a']").get_attribute("innerHTML").splitlines()[0]) 
        ```

    *   使用*xpath*：

        ```
        print(driver.find_element_by_css_selector("div#a").get_attribute("innerHTML").splitlines()[0]) 
        ```

*   使用`execute_script()`：你也可以使用[`execute_script()`](https://selenium.dev/selenium/docs/api/py/webdriver_remote/selenium.webdriver.remote.webdriver.html#selenium.webdriver.remote.webdriver.WebDriver.execute_script)可以在当前窗口/框架中同步执行JavaScript的方法，如下：

    *   使用*xpath*和*firstChild*：

        ```
        parent_element = driver.find_element_by_xpath("//div[@id='a']")
        print(driver.execute_script('return arguments[0].firstChild.textContent;', parent_element).strip()) 
        ```

    *   使用*xpath*和*childNodes[n]*：

        ```
        parent_element = driver.find_element_by_xpath("//div[@id='a']")
        print(driver.execute_script('return arguments[0].childNodes[1].textContent;', parent_element).strip()) 
        ```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-07T21:11:59.563

```
def get_true_text(tag):
    children = tag.find_elements_by_xpath('*')
    original_text = tag.text
    for child in children:
        original_text = original_text.replace(child.text, '', 1)
    return original_text 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-12T23:56:56.217

您不必进行替换，您可以获取子文本的长度并将其从总长度中减去，然后切片为原始文本。那应该快得多。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-04-15T04:52:58.733

不幸的是，Selenium 仅适用于[Elements](https://developer.mozilla.org/en-US/docs/Web/API/Element)，而不适用于[Text](https://developer.mozilla.org/en-US/docs/Web/API/Text)节点。

如果您尝试使用诸如`get_element_by_xpath`定位文本节点之类的函数，Selenium 将抛出一个`InvalidSelectorException`.

一种解决方法是使用 Selenium 获取相关的 HTML，然后使用可以更优雅地处理文本节点的 BeautifulSoup 之类的 HTML 解析库。

```
import bs4
from bs4 import BeautifulSoup

inner_html = driver.find_elements_by_css_selector('#a')[0].get_attribute("innerHTML")
inner_soup = BeautifulSoup(inner_html, 'html.parser')

outer_html = driver.find_elements_by_css_selector('#a')[0].get_attribute("outerHTML")
outer_soup = BeautifulSoup(outer_html, 'html.parser') 
```

从那里，有几种方法可以搜索文本内容。您必须进行试验以查看最适合您的用例的方法。

这是一个简单的单行，可能就足够了：

```
inner_soup.find(text=True) 
```

如果这不起作用，那么您可以使用 .contents() 遍历元素的子节点并检查它们的对象类型。

BeautifulSoup 有[四种类型的元素](https://www.crummy.com/software/BeautifulSoup/bs4/doc/#kinds-of-objects)，您会感兴趣的一种是[NavigableString](https://www.crummy.com/software/BeautifulSoup/bs4/doc/#navigablestring)类型，它由 Text 节点生成。相比之下， Elements 将具有[Tag](https://www.crummy.com/software/BeautifulSoup/bs4/doc/#tag)类型。

```
contents = inner_soup.contents

for bs4_object in contents:

    if (type(bs4_object) == bs4.Tag):
        print("This object is an Element.")

    elif (type(bs4_object) == bs4.NavigableString):
        print("This object is a Text node.") 
```

请注意，BeautifulSoup 不支持 Xpath 表达式。如果您需要这些，那么您可以使用[此线程](https://stackoverflow.com/questions/11465555/can-we-use-xpath-with-beautifulsoup)中的一些解决方法。

# tableview - iPad TableView 设计

> ID：12325455
> 
> 赞同：1
> 
> 时间：2012-09-07T21:11:32.183
> 
> 标签：tableview

我想使用`UITableView`Apple 在其 iPad 版 iTunes Connect 应用程序中使用的简洁明了的设计类型。查看市场选项卡。顶部 TV 使用第一行作为列名，接下来的行包含与这些列对应的数据。当您向上滚动顶行（列标签）时，请按预期保持原样，就像典型电子表格的设置方式一样。

这是如何实现的？我无法使用可用的样式获得该功能。

我也对底部电视的标题和周围的圆角矩形感兴趣，这是用图形完成的`UIImageView`吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-15T07:25:49.903

您需要使用 section 和 rows 方法。这些部分创建的标题在您滚动表格时浮动，并且行包含用户可以选择的记录。有几种不同的风格。这是对 tableview 样式的一个很好的[解释](https://developer.apple.com/Library/ios/documentation/UIKit/Reference/UITableView_Class/Reference/Reference.html "解释")。如果您需要创建更复杂的表，您需要做的是创建一个[集合](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=2&cad=rja&ved=0CDYQtwIwAQ&url=http://www.youtube.com/watch?v=Pvvn1L2aPyA&ei=jcqFUpnFLKuP7Ab1qIGADw&usg=AFQjCNHAl8mr9uGKOQx9ax3yNgAf4GilSQ&sig2=ZeDGUdwkZmYM2pASCDVmJw&bvm=bv.56643336,d.ZGU "收藏")。以下示例是用于创建节和行的方法。

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView {
    return 10; //you could take the count of records in an NSarray/NSdictionary here instead
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
return 5; //you could take the count of records in an NSarray/NSdictionary here instead
} 
```

# javascript - 是否可以使用 Web 开发工具并创建一个实际工作的 WYSIWYM 数学编辑器，例如 MathType 等桌面应用程序？

> ID：12325456
> 
> 赞同：1
> 
> 时间：2012-09-07T21:11:44.587
> 
> 标签：javascript, jquery, html, flash, wysiwym

在我开始尝试制作这个东西之前，我想知道是否可以，在以下情况下：

*   编写数学脚本的代码必须能够被获取、提交并存储在数据库中
*   看起来完全相同的两段数学的代码必须具有完全相同的代码
*   根据要求，无论用户在何处单击鼠标，插入符号都必须移动到该特定元素或数学部分

那么，有可能吗？我期待使用 HTML、JavaScript、jQuery 甚至 Flash 等技术作为最后的手段。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T21:40:11.167

[**MathQuill**](http://mathquill.com/)可让您以所见即所得的方式输入数学，请[**点击此处**](https://github.com/laughinghan/mathquill)。主页上有演示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T21:17:47.670

我想你想要像 MathML 这样的东西。看看这里。[http://www.w3.org/Math/](http://www.w3.org/Math/)

或者也许[http://code.google.com/p/mathmleditor/](http://code.google.com/p/mathmleditor/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T22:09:37.770

不久前我发现这个[http://www.codecogs.com/latex/eqneditor.php](http://www.codecogs.com/latex/eqneditor.php)非常有用的 LaTeX 实现，带有实时预览，我已经用过几次了。可能也不适合您的第 3 点，但以防万一它有用。

# mysql - 仅当在其他表中找到时才返回 mysql 结果集

> ID：12325465
> 
> 赞同：0
> 
> 时间：2012-09-07T21:12:34.007
> 
> 标签：mysql, sql

我不太擅长 MySQL 查询中的 JOIN 语句，所以我希望有人能帮我解决这个问题：

两张桌子 - `videos`& `video_groups`。in 中的条目具有对in的引用`videos`的字段。我需要做的是只返回至少有一个视频的结果......`groupid``id``video_groups``video_groups`

类似的东西 `SELECT * FROM video_groups WHERE video_groups.id...`，不知道如何继续......

我试图寻找一些东西，但是因为我真的不知道要寻找什么，所以我迷路了:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T21:14:31.277

```
SELECT vg.*
    FROM video_groups vg
    WHERE EXISTS (SELECT 1
                      FROM videos v
                      WHERE v.groupid = vg.id) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T21:20:30.630

常规 JOIN 只会连接在两个表中都找到行的行：

```
SELECT DISTINCT vg.id
FROM video_groups vg
JOIN videos v
ON vg.id = v.groupid
ORDER BY vg.id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T21:17:03.497

你可以这样做：

```
SELECT * FROM video_groups WHERE id = '...' 
```

# .net - Asp.net Web API - 如何为自定义 CSV 媒体类型格式化程序设置文件名

> ID：12325467
> 
> 赞同：12
> 
> 时间：2012-09-07T21:12:36.433
> 
> 标签：.net, asp.net-web-api

我已经在我的 ASP.Net Web API 项目中成功实现了一个 Csv 媒体类型格式化程序。我能够以 Csv 格式返回结果。但是，生成的文件名是没有扩展名的“部分”。

理想情况下，我希望能够在控制器中设置此文件名，但能够在全局范围内添加扩展名将是最低要求。

**以下是我找到的示例**

覆盖 OnGetResponseHeaders - 我不认为这是当前版本中的选项。 [http://forums.asp.net/t/1782973.aspx/1?Setting+response+and+content+headers+esp+ContentDisposition+inside+a+MediaTypeFormatter](http://forums.asp.net/t/1782973.aspx/1?Setting+response+and+content+headers+esp+ContentDisposition+inside+a+MediaTypeFormatter)

根据那篇文章，这应该有效

```
public override IEnumerable<KeyValuePair<string, string>> OnGetResponseHeaders(Type objectType, string mediaType, HttpResponseMessage responseMessage)
{
       return new[] { new KeyValuePair<string, string>("Content-Disposition", "attachment; filename=testing.csv") };
} 
```

然而，Visual Studio 说“没有合适的覆盖方法”并且当我将它添加到我的自定义 Csv 格式化程序时不会编译。

从控制器返回 HttpMessageResponse -[如何在 ASP.NET Web API 中设置下载文件名](https://stackoverflow.com/questions/12145390/how-to-set-downloading-file-name-in-asp-net-mvc-web-api) 然而，这似乎只是在推送现有的服务器文件，这将使 Csv 序列化脱离混合。下面是使这种方法起作用的尝试：

```
public HttpResponseMessage Get(string id)
{
    var response = new HttpResponseMessage();

    if (id == "test")
    {
        var data = GetTestData();
        response.StatusCode = HttpStatusCode.OK;
        response.Content = new StreamContent(data);
        response.Content.Headers.ContentDisposition = new ContentDispositionHeaderValue("attachment");
        response.Content.Headers.ContentDisposition.FileName = "testorama.csv";
        return response;
    }

    return null;
} 
```

这里的问题是 new StreamContent() 需要一个流 - 有没有办法获取 Custom Csv Formatter 创建的当前流？

底线，如何为首先序列化为 Csv 格式的结果集设置文件名？

**解决方案**

谢谢克劳迪奥——这让我朝着正确的方向前进。与您发布的内容相比有一些变化：

1.  我从 BufferedMediaTypeFormatter 派生了我的自定义 Csv Formatter，而要使用 SetDefaultContentHeaders，我不得不从 MediaTypeFormatter 派生。

2.  SetDefaultContentHeaders 接受类型为 MediaTypeHeaderValue 而不是字符串的 mediaType 参数。

这是最终代码：

```
public override void SetDefaultContentHeaders(Type type, HttpContentHeaders headers, MediaTypeHeaderValue mediaType)
{
    base.SetDefaultContentHeaders(type, headers, mediaType);
    headers.Add("Content-Disposition", "attachment; filename=testorama.csv");
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-07T21:19:09.827

覆盖`SetDefaultContentHeaders`MediaTypeFormatter 上的方法

```
public override void SetDefaultContentHeaders(
    Type type, HttpContentHeaders headers, string mediaType)
{
    base.SetDefaultContentHeaders(type, headers, mediaType);
    headers.Add("Content-Disposition", "attachment; filename=yourname.csv");
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-03-12T01:40:31.520

为了提供基于数据的自定义名称（至少在 Web API 2 中），您需要覆盖 GetPerRequestFormatterInstance。从那里您可以访问 HttpRequestMessage。

```
private string FileName { get; set; }

public override void SetDefaultContentHeaders(Type type, HttpContentHeaders headers, MediaTypeHeaderValue mediaType)
{
    base.SetDefaultContentHeaders(type, headers, mediaType);
    if (!string.IsNullOrEmpty(FileName))
        headers.Add("Content-Disposition", string.Format("attachment; filename={0}", FileName));
}

public override MediaTypeFormatter GetPerRequestFormatterInstance(Type type, HttpRequestMessage request, MediaTypeHeaderValue mediaType)
{
    // We aren't setting the name, so just return the current instance.
    if (!request.Properties.ContainsKey("filename")) return this;

    var formatter = new CsvFormatter();
    var fileName = request.Properties["filename"] as string;
    formatter.FileName = string.Format("{0}.csv", fileName);
    return formatter;
} 
```

然后，在您的控制器操作中，您可以像这样设置文件名......

```
if (!Request.Properties.ContainsKey("filename"))
    Request.Properties.Add("filename", "MyFile.{ext}"); 
```

我使用 {ext} 以防我添加需要文件名的其他格式化程序。理论上，只有扩展名才需要更改以支持其他格式。

# ruby-on-rails - 根据特定条件获取载波图像？

> ID：12325468
> 
> 赞同：0
> 
> 时间：2012-09-07T21:12:41.013
> 
> 标签：ruby-on-rails, ruby-on-rails-3, carrierwave

具有一定条件的载波图像如何获得？

例如：

```
 image_tag @profile.photos.first.file_url(:profile) 
```

返回第一张图片但是如果我想要类似的东西

```
@photo = Photo.where(:attachable_id => 1, :attachable_type => "Profile", :main => true) 
```

:main => true 表示这是用户选择的个人资料图片。

另外，在旁注中，

我有这个功能，真是一团糟：

```
def show_avatar_thumb(id)
    @profile = User.find(id).profile rescue nil
    image_tag @profile.photos.first.file_url(:img_96x96)
  rescue
    image_tag ("/assets/avatars/img_96x96.png")
  end 
```

有没有办法改善这一点？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-08T09:56:09.510

```
def show_avatar_thumb(id)
  begin
    user = User.find(id)
  rescue ActiveRecord::RecordNotFound
    image_tag ("/assets/avatars/img_96x96.png")
  else
    image_tag user.profile.photos.where(main: true).first.file_url(:img_96x96)
  end
end 
```

不过，我会拔出`where(main: true)`并将其放入模型范围内。

# php - 文档访问权限

> ID：12325473
> 
> 赞同：0
> 
> 时间：2012-09-07T21:13:07.447
> 
> 标签：php, mysql

我有一个简单的文档管理系统，目前它基于公司 ID 提供对文档的“公共”访问 - 我想逐个用户实施访问控制。我对如何在 PHP 中检查访问权限等感到满意，但不确定如何以有效的方式最好地维护表中已批准的用户。

一个文档可能具有仅限于 x 个用户的公共访问或私有访问，并且由于我不知道 x 的值，因此在 MySql 中实现多个名为 user1、user2 等的字段是没有意义的。

有一个表已经称为用户和一个称为文档。一个名为 users to docs 的新表是否有意义，或者是否有更好的方法来实现这一点，以便我可以检查用户是否有权访问该文档（如果他们尝试）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T21:27:36.560

最好的方法是有链接表，例如

```
table #1: users (id, ...)
table #2: documents (id, ....) 
```

和

```
table #3: user_documents (user_id, document_id) 
```

其中 user_id 和 document_id 是指向用户表和文档表的外键

如果 user_documents 中存在记录，则用户有权访问该文档。如果您需要实现各种级别的访问（读/写/等），您可以将其存储在 user_documents 表中以及额外的字段中。

相比之下，如果你有类似的东西

```
table #1: users (id, doc1, doc2, doc3, etc...) 
```

其中 doc# 字段指向该用户有权访问的文档，您必须在表中有 N 个字段来处理 N 个文档的权限。如果只有少数用户拥有 N 文档的权限，而大多数用户的权限要少得多，那么您将在未使用的字段上浪费大量空间。而且总会有一些小丑需要 N+1 个文档，这意味着您每次都在修改您的表格。

使用链接表，您永远只有 2 个字段，并且只有与用户/文档访问对一样多的记录。

# django - 权限问题阻止 celery 作为守护进程运行？

> ID：12325477
> 
> 赞同：0
> 
> 时间：2012-09-07T21:13:35.317
> 
> 标签：django, daemon, celery

我目前在将 celery 作为守护进程运行时遇到了一些问题。我使用 apache 来为我的 Django 应用程序提供服务，所以我将 celery 中的 uid 和 gid 设置为“www-data”。到目前为止，我知道有 2 个地方需要访问权限：`/var/log/celery/*.log`, `/var/run/celery/*.pid`，并且我已经将它们设置为“www-data”所有。但是，当我跑步时，芹菜无法启动`sudo service celeryd start`。如果我去掉命令的 --uid 和 --gid 选项，芹菜可以由用户“root”启动。

我注意到的另一件事是，如果我可以使用“root”启动 celery，它将在我的 django 应用程序目录中放置一些文件，例如：、、、`celery.bak`。我还更改了“www-data”拥有的应用程序目录，芹菜仍然无法启动。我从另一台 celery 运行良好的机器上复制了所有设置文件，所以我想这不是我的设置问题。有没有人有任何线索？谢谢。`celery.dat``celery.dir``CELERYD_CHDIR`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-08T01:32:49.047

Su 到 celery 用户并从命令行启动 celery。您很可能有一个需要许可的应用程序日志，而不是 celery。

# c# - 如何在 iOS 上的 unity3d 中生成（挤压）网格时提高性能？

> ID：12325478
> 
> 赞同：2
> 
> 时间：2012-09-07T21:13:35.840
> 
> 标签：c#, ios, unity3d, mesh, procedural

我要为 iOS 制作一个类似于[AudioSurf](http://www.youtube.com/watch?v=tM8dXHq9uPw)的游戏，并在其中实现“生成特定参数的路由”。我使用了 Unity Procedural Example 中的 Extrude Mesh 示例和这个问题的答案 -[链接](http://answers.unity3d.com/questions/241707/randomly-generated-content.html) 但是在 iOS 中，对象的挤压存在相当大的滞后，如果整个路线在游戏早期挤压 - 这需要很多时间，它也有轨道的显示问题，由大量多边形组成......你能告诉我如何显示生成的路线或生成路线的最佳方式是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-21T18:16:28.257

您可以通过以下方式极大地提高程序网格生成的性能
--您可以编辑网格的顶点和三角形数组，而不是生成新网格，即使用固定大小的三角形和顶点数组-

创建一个“RoadMesh”类并向其添加函数，例如- UpdateRoadMesh(Vector3 playerPosition) 此函数将根据玩家的当前位置计算并设置道路远端的顶点和三角形的值，同时更新数组当您到达顶点和三角形数组的末尾时的值开始使用起始索引，因为玩家已经越过了这些点。由于没有创建新的网格，并且每隔几帧也会编辑一次顶点，因此它将具有巨大的性能..

# c++ - 使用 C++ 进行图像处理的有效方法？

> ID：12325484
> 
> 赞同：2
> 
> 时间：2012-09-07T21:13:54.270
> 
> 标签：c++, arrays, image, opencv, camera

最近我打开了用于图像和数据处理的 opencv 编程库，在尝试让软件工作的过程中，我决定我只是厌倦了将库放到我的计算机上是多么复杂. 是否有另一个库或框架允许用户在 c++ 中与相机和图像处理进行交互，但不需要像 OpenCV 那样进行如此繁琐的工作来获取和安装？

编辑：我在使用 opencsv 时遇到困难的原因是因为我不想使用 IDE 来开发我的任何程序，我正在尝试从 cmd 行和 vim 学习使用 gdb 进行编辑

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T21:29:02.487

您能否具体说明您使用的是哪个平台以及遇到了什么问题？

我怀疑您的许多问题与 OpenCV 本身无关，而是您在使用任何 C++ 库时都会遇到的一般问题。例如，获得一个 64 位编译器、一个不错的 IDE、编译 OpenCV 以及如果需要它的一些依赖项。这实际上确实会成为一种麻烦。你用的是什么平台？我发现具有良好软件包存储库的 Linux 发行版使这种方式更容易，因为您可以非常轻松地设置所需的工具，并且通常通过存储库安装许多构建依赖项，而无需自己编译它们。

如果您确实遇到了与 OpenCV 严格相关的问题，那么 ITK (http://www.itk.org/) 可能是一个不错的选择。

最好的，

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T21:20:13.377

您可以[分 8 步使用它](http://docs.opencv.org/doc/tutorials/introduction/linux_eclipse/linux_eclipse.html)

```
#include <cv.h>
#include <highgui.h>

using namespace cv;

int main( int argc, char** argv )
{
  Mat image;
  image = imread( argv[1], 1 );

  if( argc != 2 || !image.data )
    {
      printf( "No image data \n" );
      return -1;
    }

  namedWindow( "Display Image", CV_WINDOW_AUTOSIZE );
  imshow( "Display Image", image );

  waitKey(0);

  return 0;
} 
```

在 Linux 中。

[Windows 也需要 8 个步骤。](http://docs.opencv.org/doc/tutorials/introduction/windows_install/windows_install.html)

[您可以从 C/C++ 调用 MATLAB 引擎。Matlab 也有图像处理功能！](http://www.mathworks.com/help/techdoc/matlab_external/f38569.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T21:40:16.173

当我进行大量图像处理时，我会处理位图。将文件读入内存并记下[BITMAPFILEHEADER](http://msdn.microsoft.com/en-us/library/dd183374%28v=VS.85%29.aspx)。有更多信息，但您可以在像素数据中查找偏移量。您也可以使用 Directshow 从网络摄像头获取帧。

创建一个包装器以公开一些用户友好的函数，如 getPixel() 等。

然后我会查看论文+博客等，看看我是否可以自己编写算法，有时传递一些图像来说出 FaceTracking（ImageData 数据）函数太容易了。

# python - 将 curl 命令转换为 pycurl

> ID：12325487
> 
> 赞同：1
> 
> 时间：2012-09-07T21:14:02.233
> 
> 标签：python, curl, progress-bar, pycurl

所以我使用的 curl 命令如下：

```
cmd = "curl --write-out %{http_code} -X PUT -T " + self.basedir + putfile + " -# -o /dev/null " + self.uri + "/" + self.dist + "/" + putfile 
```

我想将其从调用系统命令更改为使用 pycurl。通过这种方式，我可以对其进行更精细的控制，并最终为它实现一个进度条。但是，当我尝试转换为 python 时，生成的脚本会失败。这是我对 python 脚本的努力：

```
f = open(filepath, "rb")
fs = os.path.getsize(filepath)
c = pycurl.Curl()
c.setopt(c.URL, target_url)
c.setopt(c.HTTPHEADER, ["User-Agent: Load Tool (PyCURL Load Tool)"])
c.setopt(c.PUT, 1)
c.setopt(c.READDATA, f)
c.setopt(c.INFILESIZE, int(fs))
c.setopt(c.NOSIGNAL, 1)
c.setopt(c.VERBOSE, 1)
c.body = StringIO()
c.setopt(c.WRITEFUNCTION, c.body.write)
try:
        c.perform()
except:
        import traceback
        traceback.print_exc(file=sys.stderr)
sys.stderr.flush()

f.close()
c.close()

sys.stdout.write(".")
sys.stdout.flush() 
```

这是输出的内容：

```
* About to connect() to ************ port 8090 (#0)
*   Trying 16.94.124.53... * connected
> PUT /incoming/ HTTP/1.1
Host: ***********
Accept: */*
User-Agent: Load Tool (PyCURL Load Tool)
Content-Length: 21
Expect: 100-continue

< HTTP/1.1 100 Continue
* We are completely uploaded and fine
< HTTP/1.1 500 Internal Server Error
< Content-type: text/html
* no chunk, no close, no size. Assume close to signal end
< 
```

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-30T23:01:49.670

我已经上传了工作模块，你可以在代码中找到你的答案。

*   通过挖掘 libcurl[示例和文档，您可以找到几乎所有关于 pycurl 的答案。](http://curl.haxx.se/libcurl/c/example.html)

![在此处输入图像描述](../Images/a092f0e088dc5f67eea670c9c41507e7.png)

```
'''
Created on Oct 22, 2013

@author: me
'''
import pycurl
import os
import wx
import sys
import hashlib
from cStringIO import StringIO

def get_file_hash(full_filename):
    BLOCKSIZE = 65536
    hasher = hashlib.md5()
    with open(full_filename, 'rb') as afile:
        buf = afile.read(BLOCKSIZE)
        while len(buf) > 0:
            hasher.update(buf)
            buf = afile.read(BLOCKSIZE)
    return hasher.hexdigest()

class FtpUpload(object):

    def __init__(self, server, username, password, **items):
        self.server = server
        self.username = username
        self.password = password
        self.gauge = items.get("gauge")
        self.sb_speed = items.get("sb_speed")
        self.upload_file_size = items.get("upload_file_size") 
        self.upload_file_speed = items.get("upload_file_speed")
        self.filesize = 0
        self.ftp_filehash = '0'

    def sizeToNiceString(self, byteCount):
        for (cutoff, label) in [(1024*1024*1024, "GB"), (1024*1024, "MB"), (1024, "KB")]:
            if byteCount >= cutoff:
                return "%.2f %s" % (byteCount * 1.0 / cutoff, label)
        if byteCount == 1:
            return "1 byte"
        else:
            return "%d bytes" % byteCount

    def initRange(self, filesize):
        self.filesize = filesize
        self.gauge.SetRange(filesize)

    def updateValue(self, upload_d):
        upload_d_int = int(upload_d)
        self.gauge.SetValue(upload_d_int)

        upload_d_str = self.sizeToNiceString(upload_d)
        upload_percent = int((upload_d*100)/self.filesize)

        upload_d_status = "{0}/{1} ({2}%)".format(upload_d_str, self.sizeToNiceString(self.filesize), upload_percent)
        self.sb_speed.SetStatusText(upload_d_status, 1)
        self.upload_file_size.SetLabel(upload_d_status)
        self.upload_file_speed.SetLabel(upload_d_str)

    def progress(self, download_t, download_d, upload_t, upload_d):
        self.updateValue(upload_d)

    def test(self, debug_type, debug_msg):
        if len(debug_msg) < 300:
            print "debug(%d): %s" % (debug_type, debug_msg.strip())

    def ftp_file_hash(self, buf):
        sys.stderr.write("{0:.<20} : {1}\n".format('FTP RAW ', buf.strip()))
        ftp_filehash = dict()
        item = buf.strip().split('\n')[0]
        ext = item.split('.')[1]
        if len(ext) > 3:
            ftp_filename = item[:-33]
            ftp_filehash = item[-32:]
        self.ftp_filehash = ftp_filehash

    def get_ftp_file_hash(self, filename):
        c = pycurl.Curl()
        list_file_hash = 'LIST -1 ' + filename + "_*"
        sys.stderr.write("{0:.<20} : {1} \n".format('FTP command ', list_file_hash))
        c.setopt(pycurl.URL, self.server)
        c.setopt(pycurl.USERNAME, self.username)
        c.setopt(pycurl.PASSWORD, self.password)
        c.setopt(pycurl.VERBOSE, False)
        c.setopt(pycurl.DEBUGFUNCTION, self.test)
        c.setopt(pycurl.CUSTOMREQUEST, list_file_hash)
        c.setopt(pycurl.WRITEFUNCTION, self.ftp_file_hash)
        c.perform()
        c.close()

    def delete_ftp_hash_file(self, ftp_hash_file_old):
        c = pycurl.Curl()
        delete_hash_file = 'DELE ' + ftp_hash_file_old
        sys.stderr.write("{0:.<20} : {1} \n".format('FTP command ', delete_hash_file))
        c.setopt(pycurl.URL, self.server)
        c.setopt(pycurl.USERNAME, self.username)
        c.setopt(pycurl.PASSWORD, self.password)
        c.setopt(pycurl.VERBOSE, False)
        c.setopt(pycurl.DEBUGFUNCTION, self.test)
        c.setopt(pycurl.CUSTOMREQUEST, delete_hash_file)
        try:
            c.perform()
        except Exception as e:
            print e
        c.close()

    def upload(self, full_filename, filesize):
        self.initRange(filesize)
        filename = os.path.basename(full_filename)
        sys.stderr.write("filename: %s\n" % full_filename)

        c = pycurl.Curl()
        c.setopt(pycurl.USERNAME, self.username)
        c.setopt(pycurl.PASSWORD, self.password)

        c.setopt(pycurl.VERBOSE, False)
        c.setopt(pycurl.DEBUGFUNCTION, self.test)

        c.setopt(pycurl.NOBODY, True)
        c.setopt(pycurl.HEADER, False)

        ftp_file_path = os.path.join(self.server, os.path.basename(full_filename))
        file_hash = get_file_hash(full_filename)
        ftp_hash_file = ftp_file_path + "_%s" % file_hash

        # Getting filesize if exist on server.
        try:
            c.setopt(pycurl.URL, ftp_file_path)
            c.perform()
            filesize_offset = int(c.getinfo(pycurl.CONTENT_LENGTH_DOWNLOAD))
        except Exception as error_msg:
            print error_msg
            wx.MessageBox(str(error_msg), 'Connection error!', 
                wx.OK | wx.ICON_ERROR)
            # Exit upload function.
            return True

        ftp_file_append = True
        # Get ftp file hash.
        self.get_ftp_file_hash(filename)

        offset = filesize_offset == -1 and '0' or filesize_offset
        sys.stderr.write("L_file hash : {0:.<60}: {1:<40}\n".format(filename, file_hash))
        sys.stderr.write("F_file hash : {0:.<60}: {1:<40}\n".format(filename, self.ftp_filehash))
        sys.stderr.write("{0:15} : {1:.>15}\n".format('filesize:', filesize))
        sys.stderr.write("{0:15} : {1:.>15}\n".format('ftp_filesize', offset))
        sys.stderr.write("{0:15} : {1:.>15}\n".format('to upload:', filesize - int(offset)))
        # File not exist on FTP server.
        if filesize_offset == -1:
            # file not exist: uploading from offset zero.
            ftp_file_append = False
            filesize_offset = 0
        # Local and FTP file size and files MD5 are the same.
        elif filesize_offset == self.filesize and file_hash == self.ftp_filehash:
            sys.stderr.write("--- File exist on server! ---\n\n")
            self.upload_file_speed.SetLabel("File exist on server!")
            self.sb_speed.SetStatusText("File exist on server!", 1)
            # Check next filename.
            return False
        # Ftp file and local file different data.
        elif file_hash != self.ftp_filehash:
            ftp_file_append = False
            filesize_offset = 0
            ftp_hash_file_old = filename + "_" + self.ftp_filehash
            # delete old hash file.
            self.delete_ftp_hash_file(ftp_hash_file_old)

        c.setopt(pycurl.FTPAPPEND, ftp_file_append)
        c.setopt(pycurl.UPLOAD, True)
        c.setopt(pycurl.PROGRESSFUNCTION, self.progress)

        with open('filehash.txt', 'w') as f:
            f.write(file_hash)

        for item in ("filehash.txt", full_filename):
            # dont show progress by default.
            noprogress = True
            # upload ftp_hash_file first.
            ftp_url = ftp_hash_file

            with open(item, "rb") as f:
                # chages ftp_url and show progress values, add filesize_offset.
                if item != "filehash.txt":
                    f.seek(filesize_offset)
                    noprogress = False
                    ftp_url = ftp_file_path

                c.setopt(pycurl.URL, ftp_url)
                c.setopt(pycurl.NOPROGRESS, noprogress)
                c.setopt(pycurl.READFUNCTION, f.read)
                try:
                    c.perform()
                    if item != "filehash.txt":
                        sys.stderr.write("{0:15} : {1:.>15}\n\n".format("size uploaded", int(c.getinfo(pycurl.SIZE_UPLOAD))))
                except Exception as error_msg:
                    print error_msg
                    wx.MessageBox(str(error_msg), 'Connection error!', 
                        wx.OK | wx.ICON_ERROR)
                    # Exit upload function.
                    return True
        self.ftp_filehash = '0'
        c.close()

if __name__ == '__main__':
    pass 
```

# import - 在 Windows 上的 Dart 中导入库

> ID：12325488
> 
> 赞同：1
> 
> 时间：2012-09-07T21:14:04.707
> 
> 标签：import, dart

我一直在尝试在 Dart 中创建一个库并将其导入我的项目中。虽然由于某种原因它不会这样做。

它看起来是这样的： ![漏洞](../Images/4911eb93423fdd4d0737f0a7134d8f0c.png) 它说它找不到库，尽管路径是正确的。我还尝试了许多其他路径：

*   SmartCanvas.dart
*   SmartCanvas/SmartCanvas.dart
*   智能画布
*   智能画布/智能画布
*   ./SmartCanvas/SmartCanvas.dart
*   ../SmartCanvas/SmartCanvas.dart
*   ./SmartCanvas.dart
*   ../SmartCanvas.dart
*   ./SmartCanvas
*   ../SmartCanvas

注意：我尝试将此库导入的项目位于我的硬盘驱动器（我的保管箱文件夹）上完全不同的某个地方。

任何人都知道我应该使用什么作为路径，或者如何正确导入库？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T21:34:14.383

`#import`期望具有该`#library`行的 .dart 文件的完整路径或正确的相对路径。

这是工作代码的示例：

[https://github.com/johnmccutchan/DartVectorMath/blob/master/test/console_test_harness.dart](https://github.com/johnmccutchan/DartVectorMath/blob/master/test/console_test_harness.dart)

在你看到的顶部`#import('../lib/vector_math_console.dart');`

位于：

[https://github.com/johnmccutchan/DartVectorMath/blob/master/lib/vector_math_console.dart](https://github.com/johnmccutchan/DartVectorMath/blob/master/lib/vector_math_console.dart)

去掉 github url 前缀，我们得到：

```
test/console_test_harness.dart
lib/vector_math_console.dart 
```

导入行使用从 test/ 到 ../lib/ 的正确相对路径来查找 vector_math_console.dart（库）。

HTH，约翰

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-08T00:56:02.977

在 Windows 上试试这个

```
#import('/c:/users/pablo/pablo\'s documents/projects/smartcanvas/smartcanvas.dart'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-19T17:10:24.697

要在 dart 中导入本地库，我建议使用 pubspec.yaml 中的路径依赖项。这是一种更简洁的方法，然后在 dart 代码中嵌入绝对路径。

在此处阅读：[https ://www.dartlang.org/tools/pub/dependencies.html#path-packages](https://www.dartlang.org/tools/pub/dependencies.html#path-packages)

# flyway - flyway如何锁定postgres模式？

> ID：12325489
> 
> 赞同：2
> 
> 时间：2012-09-07T21:14:07.770
> 
> 标签：flyway

我正在将 Flyway 与 Postgres 一起使用，我注意到如果我的 tomcat 服务器正在运行，并且我尝试执行 a`DROP SCHEMA foo`它在 tomcat 关闭之前不起作用。我假设 flyway 有一些机制可以在运行后阻止对模式的修改。其他客户端修改模式的阻塞是如何在flyway中完成的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-09T11:53:04.067

**Flyway 不会锁定架构。**

当它开始应用迁移时，它会开始一个事务。然后，它使用 获取元数据表上的锁`SELECT * FROM metadatatable FOR UPDATE`。在事务提交或回滚时迁移完成后，此锁会自动释放。

# ruby-on-rails - ROR / 数据库：如何为数据库记录创建自定义订单列表？

> ID：12325490
> 
> 赞同：1
> 
> 时间：2012-09-07T21:14:13.977
> 
> 标签：ruby-on-rails, database

我有一个包含一些文章（用于网站）的数据库表，如下所示：

```
Articles:
id       title         order_id
1          -            1
2          -            4
3          -            3
4          -            2 
```

现在在网页上我想使用 order_id 来订购文章，这非常好，使用 ROR 活动记录。

但是，当我想更新 order_id 时，我必须使用这种技术更新所有记录，每次更改 order_id 时。这样做的更好方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T21:23:43.660

你想要[acts_as_list](http://rubydoc.info/gems/acts_as_list/0.1.8/frames)：

```
class Article < ActiveRecord::Base
  acts_as_list :column => 'order_id'
end 
```

当您执行重新排序时，没有办法更新大量记录，但是acts_as_list 可以使用 和 之类的方法为您完成所有这些`Article#move_to_top`工作`Article#move_lower`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-18T19:01:34.950

有一些宝石可以解决您的问题。[Ruby 工具箱将它们放在Active Record Sortables](https://www.ruby-toolbox.com/categories/Active_Record_Sortables)类别中。截至撰写本文时（2017 年 3 月），此列表中的顶级宝石是：

**act_as_list** ([网站](http://info.pagnis.in/acts_as_list/), [GitHub](https://github.com/swanandp/acts_as_list) )

这是在数据库中管理有序列表的最流行的选择，并且在创建 10 年后仍然保持不变。它会做你想做的事并管理项目的数量。gem 会以正确的顺序保持您的位置字段编号从 1 到 n。然而，这意味着在列表中间插入项目意味着增加其下方列表项目的所有位置值，这对您的数据库来说可能是相当多的工作。

**排名模型**( [GitHub](https://github.com/mixonic/ranked-model) )

该 gem 还为您管理自定义排序列表。然而，它在幕后使用了另一种方法，您的列表项在整个整数值范围内获得很大的位置编号并且间隔开。如果您有大量列表并且需要经常重新排序项目，这应该会给您带来性能优势。在我看来，这个 gem 可能不再被维护，因为作者现在正在进行 Ember.js 开发，但它应该可以工作。**编辑：** [它仍然被维护](https://github.com/mixonic/ranked-model/issues/101#issuecomment-287839145)。

**可排序**（[GitHub](https://github.com/shuber/sortable)）

这似乎与 act_as_list 相同，但能够将您的项目放入多个列表中。我不确定这是否是一个有效的用例，因为您可以只创建多个项目。看起来它没有维护很长时间，也没有被很多人使用。

**度假村**( [GitHub](https://github.com/codegram/resort) )

这个gem 使用链表方法，即每个数据库条目都有一个指向下一个条目的指针。如果您需要在列表中间进行大量插入，这可能是一个好主意，但对于仅获取整体列表或者如果数据库中出现问题并且链中断，这似乎是一个糟糕的主意。它很新，所以让我们看看它是如何发展的。

**act_as_restful_list** ( [GitHub](https://github.com/12spokes/acts_as_restful_list) )

这个宝石是“就像acts_as_list，但很安静”。它似乎旨在提供更好的 API。它背后的公司已经不存在了，所以我宁愿使用act_as_list来处理它的API，反正也不错。

# html - 对齐社交媒体按钮

> ID：12325503
> 
> 赞同：0
> 
> 时间：2012-09-07T21:14:49.533
> 
> 标签：html, css, social-networking, facebook-social-plugins

我正在尝试对齐我们的 3 个社交媒体按钮：Facebook/Twitter/Google+，均匀地在 393 像素的宽度间隙中。它们水平对齐（facebook 似乎在 twitter/google+ 上垂直向下约 2 px），但是我有点挣扎，希望有人能提供帮助。

下面是 CSS/HTML 按钮的代码：

HTML

```
 <div class="nav-container2">
    <div id="nav3"><div class="fb-like" data-href="http://www.facebook.com/pages/Foscam-UK/222224154548563" data-send="false" data-layout="button_count" data-width="20" data-show-faces="false"></div>
    <a href="https://twitter.com/FoscamUK" class="twitter-follow-button" data-show-count="false">Follow @FoscamUK</a>  
    <div class="g-plusone" data-size="medium"></div> 
```

CSS

```
.nav-container2 { width:940px; margin:auto; height:30px;}
#nav2 { width:547px; height:40px; float:right; margin:1px 0 0 0; font-size:105%; background:url(../images/bg-nav.png) 0 0 repeat-x; -webkit-border-radius:5px; -moz-border-radius:5px; border-radius:5px; box-shadow:0 0 3px #ccc; }
#nav3 { width:393px; float:left; height:0px; margin-top:10px;} 
```

非常感谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-07T21:26:03.710

试试这个：

```
<div class="nav-container2">
    <ul class="social-media-list">
        <li>
            <div class="fb-like" data-href="http://www.facebook.com/pages/Foscam-UK/222224154548563" data-send="false" data-layout="button_count" data-width="20" data-show-faces="false"></div>
        </li>
        <li>
            <a href="https://twitter.com/FoscamUK" class="twitter-follow-button" data-show-count="false">Follow @FoscamUK</a> 
        </li>
        <li> 
            <div class="g-plusone" data-size="medium"></div>
        </li>
    </ul>
</div> 
```

CSS：

```
.nav-container2 { width:940px; margin:auto; height:30px;}
.social-media-list { width: 393px; }
.social-media-list li { display:block; float: left; width:33.3%; text-align:center; margin: 0 auto;} 
```

这只是一个猜测，因为我不确定这将如何适合您的页面，但这将为您提供一个 393px 宽的块元素，其中包含 3 个均匀间隔的列表项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T22:05:31.523

html

```
<div class="nav-container2">
  <ul>
    <li>
        <div class="fb-like" data-href="http://www.facebook.com/pages/Foscam-UK/222224154548563" data-send="false" data-layout="button_count" data-width="20" data-show-faces="false">x</div>
    </li>
    <li>
        <a href="https://twitter.com/FoscamUK" class="twitter-follow-button" data-show-count="false">Follow @FoscamUK</a> 
    </li>
    <li> 
        <div class="g-plusone" data-size="medium">y</div>
    </li>
  </ul>
</div> 
```

CSS

```
.nav-container2 { width:940px; margin:auto; height:30px; background-color: #ace}
.nav-container2 ul div {display: inline;}
.nav-container2 li {display: inline; border: 1px solid #000; width: 33%; float: left;} 
```

根据之前的回答。`borders`并被`background-color`添加以显示正在发生的事情。

# java - 错误：结果集结束后

> ID：12325512
> 
> 赞同：0
> 
> 时间：2012-09-07T21:16:29.387
> 
> 标签：java, resultset

此代码在数据库中搜索书籍或用户，搜索用户时没有问题，但是当搜索不存在的书籍时，出现此错误：

错误：结果集结束后

```
 if(RB1.isSelected()==true)
  {

    Statement stmt = (Statement)conn.createStatement();
    String SQL1 = "select * from usernames";
    ResultSet rs1 = stmt.executeQuery(SQL1);

    String ID ="";

    while(rs1.next())
    {          
        ID = rs1.getString("UserID");
        if(UIorBItf.getText().compareTo(ID) == 0)
        {
          JOptionPane.showMessageDialog(null,rs1.getString("Full_Name") +
           " is available","Query result",JOptionPane.INFORMATION_MESSAGE);
           break;
        }
    }

     if(UIorBItf.getText().compareTo(ID) != 0)
     {
       JOptionPane.showMessageDialog(null, UIorBItf.getText() +" is 
       not available","Query result",JOptionPane.INFORMATION_MESSAGE);
     }

  }
  if(RB2.isSelected()==true)
    {
     //JOptionPane.showMessageDialog(null, UIorBItf.getText() +" Now 
     //You are inside Book search","Query result",JOptionPane.INFORMATION_MESSAGE);

         Statement stmt2= (Statement)conn.createStatement();

         String SQL2 = "select * from books";

         ResultSet rs2 = stmt2.executeQuery(SQL2);
         String ID ="";

            while(rs2.next())
            {
                ID = rs2.getString("BookID");
                if(ID.compareTo(UIorBItf.getText()) ==0)
                {
                 JOptionPane.showMessageDialog(null,rs2.getString("Book_Name") +
                  " is available","Query result",JOptionPane.INFORMATION_MESSAGE);
                     break;     
                }
            }
            if(UIorBItf.getText().compareTo(ID)!=0)
               {
                 JOptionPane.showMessageDialog(null,rs2.getString("Book_Name") +
                  " is not available","Query result",JOptionPane.INFORMATION_MESSAGE);
               }
    }
    }catch(Exception e)
    {
                  System.out.println("Error: " + e.getMessage());

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T21:33:31.477

```
if(UIorBItf.getText().compareTo(ID)!=0)
{
                                      // problem is here
                                      // from other code I am guessing you want UIorBItf.getText()
                                      // instead of rs2.getString("Book_Name")
   JOptionPane.showMessageDialog(null,rs2.getString("Book_Name") +
       " is not available","Query result",JOptionPane.INFORMATION_MESSAGE);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T21:34:12.080

问题在这里：

```
if(UIorBItf.getText().compareTo(ID)!=0)
{
    JOptionPane.showMessageDialog(null,rs2.getString("Book_Name") +
    " is not available","Query result",JOptionPane.INFORMATION_MESSAGE);
} 
```

你不能`rs2.getString("Book_Name")`从这里调用，因为只有在`while`循环结束时你才会到这里。此时，您已经越过了最后一行，因为`rs2.next()`has returned `false`。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-07T21:23:45.927

你不能打电话

```
rs2.getString("Book_Name") 
```

如果`rs2.next()`

与您的查询中的任何内容都不匹配

```
select * from books 
```

# jquery-mobile - jQueryMobile 默认字体太大，我可以为电脑屏幕缩小尺寸吗？

> ID：12325517
> 
> 赞同：2
> 
> 时间：2012-09-07T21:16:55.480
> 
> 标签：jquery-mobile, responsive-design, font-size

@Phill Pafford 为我的相反问题提供了解决方案：使用元视口解决方案的[jquery 移动默认字体大小。](https://stackoverflow.com/questions/6752977/jquery-mobile-default-font-size)但是，这对于放大视口以适应手机屏幕非常有用。

我正在实施 jQM 框架，只是为了在计算机屏幕上运行的“常规”基于 Web 的应用程序上提供移动外观。而且字体在他们身上看起来很大！如何全局缩小字体大小或使其（响应式设计）在计算机屏幕上更具吸引力（即更小）？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T22:04:00.717

在您的自定义样式表中，而不是 JQM 样式表中，将您的样式与媒体查询分组：

```
/* Large desktop */
@media (min-width: 1200px) { font-size: 12px; }

/* Portrait tablet to landscape and desktop */
@media (min-width: 768px) and (max-width: 979px) { ... }

/* Landscape phone to portrait tablet */
@media (max-width: 767px) { ... }

/* Landscape phones and down */
@media (max-width: 480px) { ... } 
```

# javascript - 使用 jQuery 将侦听器附加到 iframe 内的顶部窗口焦点事件

> ID：12325519
> 
> 赞同：1
> 
> 时间：2012-09-07T21:16:58.173
> 
> 标签：javascript, jquery

有没有办法在 iFrame 中附加一个侦听器，当浏览器窗口获得焦点（单击选项卡或标题栏）时将调用该侦听器？这是测试代码：

测试.html：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html><body><iframe src="test1.html"></iframe></body></html> 
```

测试1.html：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js"></script></head><body><script type="text/javascript">
    var doc = $(window.top.document);
    var win = $(window.top);
    doc.ready(function(){
             win.focus(function() { console.log('Focus'); });
             win.blur(function() { console.log('Blur'); });
             doc.mousemove(function() { console.log('Move'); });
    });
</script></body></html> 
```

点击 test.html，mousemove 侦听器被调用，但焦点和模糊仅在 iFrame 被点击和关闭时被调用，而不是在浏览器窗口获得/失去焦点时被调用。我尝试将侦听器附加到 doc 并以相同的结果获胜。我正在 Chrome 和 Firefox 中进行测试。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-10T03:04:57.490

我真的不知道，jQuery 的焦点/模糊的魔力是什么，但我相信这种魔力有点问题。（或者这可能是我不知道的功能：o）

如果你在没有 jQuery 方法的情况下这样做，它可以正常工作。

```
var doc = window.top.document;
var win = window.top;
win.onfocus = function() { console.log('Focus'); };
win.onblur  = function() { console.log('Blur'); };
doc.onmousemove = function() { console.log('Move'); }; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-26T14:47:23.813

答案似乎在 jQuery 的实例中。在您的示例中，您使用*iframe*中的 jQuery 实例在*top*的元素上附加了一个事件处理程序。这只是一个猜测，但我会说“魔法”不会跨 jQuery 实例翻译。

 *试试这个：

```
var doc = window.top.$(window.top.document);
var win = window.top.$(window.top);
doc.ready(function(){
         win.focus(function() { console.log('Focus'); });
         win.blur(function() { console.log('Blur'); });
         doc.mousemove(function() { console.log('Move'); });
}); 
```

实现从以下方面闪耀：

[https://leapinggorilla.com/Blog/Read/4/passing-messages-to-iframes-with-jquery](https://leapinggorilla.com/Blog/Read/4/passing-messages-to-iframes-with-jquery)*

# objective-c - 如何检测 Web 服务器上是否存在文件

> ID：12325524
> 
> 赞同：1
> 
> 时间：2012-09-07T21:17:07.170
> 
> 标签：objective-c, ios

在 iOS 中检测 Web 服务器上是否存在文件 (HTML) 的正确方法是什么。使用以下方法检测 myfile.html 的存在总是返回 true。

```
NSURL *url = [NSURL URLWithString:@"http://somewebsite.com/myfile.html"];
NSURLRequest *requestObject = [NSURLRequest requestWithURL:url];

NSURLConnection *theConnection=[[NSURLConnection alloc] initWithRequest:requestObject delegate:self];

if (theConnection) {

    NSLog(@"File exists");

} else {

    NSLog(@"File does NOT exist");
} 
```

我相信它返回的是与 HTTP 服务器的连接成功，而不是检查文件 myfile.html 是否实际存在。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T21:27:41.030

您需要使用 connection:didReceiveResponse 委托方法来检查 http 响应代码。类似以下内容将检查以确保您收到 200 响应，具体取决于您的服务器，如果文件不存在，我希望状态代码为 404。

```
- (void) connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response {
    //make sure we have a 2xx reponse code
    NSHTTPURLResponse *httpResponse = (NSHTTPURLResponse *)response;

    if ([httpResponse statusCode]/100 == 2){
        NSLog(@"file exists");
    } else {
        NSLog(@"file does not exist");
    }
} 
```

# git - 未推送提交的别名，无论我在哪个分支上？

> ID：12325525
> 
> 赞同：5
> 
> 时间：2012-09-07T21:17:22.043
> 
> 标签：git, git-log

我有一个看起来像这样的 git 别名：

```
[alias]
        unpushed = log origin..HEAD --pretty=format:'%h %an %s' 
```

当我在主人时，这非常适合显示“未推动”的变化。但是，当我在分支上时，这个别名并不能真正正常工作。

无论我是否在分支上，正确的命令是显示未推送的更改？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-08T17:29:09.110

如果您只想查看当前分支的传出提交，可以使用以下命令：

```
git config alias.unpushed "log @{u}.. --pretty=format:'%h %an %s'" 
```

这会导致`git log`显示所有可访问的提交，`HEAD`不包括可从上游分支访问的提交。该`@{u}..`参数等价于`@{u}..HEAD`, 并且`@{u}`是当前分支的上游提交的简写（例如，`origin/foo`如果签出的分支是`foo`）。

如果您想查看所有分支的所有未推送提交，请执行以下操作：

```
git config alias.unpushed "log --all --not --remotes --tags --pretty=format:'%h %an %s'" 
```

以上导致`git log`遍历所有引用，但在（排除）远程引用（例如，`origin/master`）和标签处停止。Git 不区分本地和远程标签，所以上面假设所有标签都是远程的（这并不总是正确的，所以`--tags`有时你可能想省略这个参数）。

我个人使用以下别名来显示未推送的提交：

```
# unpushed:  graph of everything excluding pushed/tag commits
# with boundary commits (see below for 'git g' alias)
git config alias.unpushed '!git g --not --remotes --tags'

# go:  _G_raph of _O_utgoing commits with boundary commits
# (see below for 'git gb' alias)
git config alias.go '!git gb @{u}..'

# g:  _G_raph of everything with boundary commits
git config alias.g '!git gb --all'

# gb:  _G_raph of current _B_ranch (or arguments) with boundary commits
git config alias.gb '!git gbnb --boundary'

# gbnb:  _G_raph of current _B_ranch (or arguments) with _N_o _B_oundary commits
git config alias.gbnb 'log --graph --date-order --pretty=tformat:"%C(yellow)%h%Creset %C(magenta)%aE %ai%Creset %C(green bold)%d%Creset%n        %s"' 
```

对于简单的存储库，我使用`git g`别名作为探索提交的主要方法。对于复杂的存储库（数十个分支），我通常`git gb`用来显示特定的分​​支或提交范围。当我想查看如何`git push`更改远程引用（我`push.default`的设置为`upstream`）时，我使用`git go`. 当我想查看本地存储库中是否有任何未推送的内容（例如，查看删除克隆是否会丢失工作）时，我使用`git unpushed`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T21:22:05.380

我使用[git-wtf](https://github.com/michaelklishin/git-wtf)来解决这个问题和其他问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-08T02:28:21.500

这将做到：

```
git config alias.unpushed "log $(git rev-parse --symbolic-full-name @{u})..HEAD --pretty=format:'%h %an %s'" 
```

它将上游跟踪分支的全名（例如`refs/remotes/origin/master`）与 HEAD 进行比较。全名是您平均 git 操作的有效参考规范。

如果您使用`fetch`而不是`pull`，并且希望在*任*一分支中提交但不是同时提交，请在命令中使用`...`语法而不是`..`语法。

# javascript - 如何检测用户何时在浏览器当前选项卡视口中放置图像？

> ID：12325529
> 
> 赞同：2
> 
> 时间：2012-09-07T21:17:40.273
> 
> 标签：javascript, jquery, drag-and-drop

我想知道如何进行拖放图像上传。我不明白的是，如何让服务器知道用户何时将图像拖放到某个 div 内或上传到正文中？这是否普遍支持浏览器 ie,ff,chrome,safari。谢谢你 ：）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T21:32:48.653

我可以告诉你没有做太多的研究。

简短的回答是，不。*所有*主流浏览器都不支持检测用户何时在客户端窗口内放置图像的方法。

此外，正如 Rajat Saxena 在评论中指出的那样，您必须通过在 drop 事件上发送 ajax 请求来通知服务器文件删除。

* * *

## HTML5

这是使用 HTML5 和 javascript[从桌面拖放到浏览器](http://www.html5rocks.com/en/tutorials/file/dndfiles/#toc-selecting-files-dnd)

```
<div id="drop_zone">Drop files here</div>
<output id="list"></output>

<script>
  function handleFileSelect(evt) {
    evt.stopPropagation();
    evt.preventDefault();

    var files = evt.dataTransfer.files; // FileList object.

    // files is a FileList of File objects. List some properties.
    var output = [];
    for (var i = 0, f; f = files[i]; i++) {
      output.push('<li><strong>', escape(f.name), '</strong> (', f.type || 'n/a', ') - ',
                  f.size, ' bytes, last modified: ',
                  f.lastModifiedDate ? f.lastModifiedDate.toLocaleDateString() : 'n/a',
                  '</li>');
    }
    document.getElementById('list').innerHTML = '<ul>' + output.join('') + '</ul>';
  }

  function handleDragOver(evt) {
    evt.stopPropagation();
    evt.preventDefault();
    evt.dataTransfer.dropEffect = 'copy'; // Explicitly show this is a copy.
  }

  // Setup the dnd listeners.
  var dropZone = document.getElementById('drop_zone');
  dropZone.addEventListener('dragover', handleDragOver, false);
  dropZone.addEventListener('drop', handleFileSelect, false);
</script> 
```

* * *

## jQuery

这是使用 JQuery（Firefox 和 Chrome）[从桌面到浏览器的拖放操作](http://jxs.me/2010/09/20/drag-and-drop-with-jquery/)

```
function ignoreDrag(e) {
  e.originalEvent.stopPropagation();
  e.originalEvent.preventDefault();
}

$('#target')
    .bind('dragenter', ignoreDrag)
    .bind('dragover', ignoreDrag);
    .bind('drop', drop);

function drop(e) {
  ignoreDrag(e);
  var dt = e.originalEvent.dataTransfer;
  var files = dt.files;

  if(dt.files.length > 0){
    var file = dt.files[0];
    alert(file.name);
  }
} 
```

* * *

## 其他插件相关链接（未测试）和问题

*   [有没有好的 jQuery 拖放文件上传插件？](https://stackoverflow.com/questions/1663741/is-there-a-good-jquery-drag-and-drop-file-upload-plugin)
*   [通过拖放上传文件](https://stackoverflow.com/questions/6739085/file-upload-via-drag-and-drop)
*   [jQuery 从桌面插件拖动图像](http://strd6.com/2011/01/jquery-drag-image-from-desktop-plugin/)
*   [从桌面 jQuery 插件拖放](http://xquerywebappdev.wordpress.com/2010/05/21/drag-n-drop-from-desktop-jquery-plugin/)
*   [用于将文件从桌面拖放到网页中的 Javascript](http://bytes.com/topic/javascript/answers/578735-javascript-drag-file-desktop-drop-into-webpage)
*   [jQuery 文件上传演示](http://blueimp.github.com/jQuery-File-Upload/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-08T00:35:09.533

我正在使用[Pupload](http://www.plupload.com/)。我不必担心如何实现这种拖放行为，如果浏览器不兼容 html 5，它会优雅地降级。

# iphone - 界面构建器未在 UITabBarController 内显示导航控制器的导航栏

> ID：12325533
> 
> 赞同：1
> 
> 时间：2012-09-07T21:18:05.217
> 
> 标签：iphone, xcode, interface-builder

我最近从 3.2 切换到 Xcode 4，到目前为止一切都很好。在过去的一个小时左右，有一件事让我发疯了。在我的主窗口 xib 中，我有一个带有 4 个选项卡的选项卡控制器。其中三个是常规的 UIViewController，但一个是 UINavigationController。问题是使用 Xcode 4 的 Interface Builder，我看不到导航控制器的导航栏。我只是得到一个窗口，上面写着“联系人导航控制器内的地址列表表视图控制器”。为什么 Xcode 不显示导航栏？在 Xcode 3 的 IB 中，我可以看到它、添加按钮、更改标题等。我在这里似乎无法做到这一点。

如果您观看此视频，该人将 UINavigationController 拖到选项卡栏中，您可以看到该栏。

[http://www.youtube.com/watch?v=aSBK8Zz6O4M](http://www.youtube.com/watch?v=aSBK8Zz6O4M)

我将自定义类设置为我的 ContactsNavigationController，并且我在导航控制器的 xib 中所做的更改不会像常规视图控制器的 xib 更改那样反映在选项卡控制器中。

所以，我有点困惑。我对此并不陌生，从第一天开始我就一直在 Xcode 编程，但我很困惑为什么导航栏没有出现在选项卡控制器的视图中，以及为什么当我设置导航控制器时到我的自定义类（甚至设置 nib 文件），它不起作用。其他一切都可以。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T12:50:16.517

我刚刚在一个较旧的项目中遇到了这个问题。我更改了根视图控制器属性中的大小，这似乎已经刷新了界面构建器，包括它在链接到导航控制器的视图上显示导航栏，但在 IB 中没有显示导航栏

# javascript - Javascript 是否支持多线程？

> ID：12325534
> 
> 赞同：0
> 
> 时间：2012-09-07T21:18:06.117
> 
> 标签：javascript, multithreading, browser

> **可能重复：**
> [为什么 JavaScript 不支持多线程？](https://stackoverflow.com/questions/39879/why-doesnt-javascript-support-multithreading)

是否有某种方法可以为运行任务（用于网络内容或一些繁重的计算）生成新线程以并行工作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-07T21:23:24.527

是和不是。

您可以使用[Web Worker](https://developer.mozilla.org/en-US/docs/DOM/Using_web_workers?redirectlocale=en-US&redirectslug=Using_web_workers)创建后台线程，但并非所有浏览器都支持它。例如，Internet Explorer 直到版本 10 才支持它。

在常规的 Javascript 代码中没有多线程。Javascript 是一种严格的单线程语言。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T21:20:06.373

是的，通过网络工作者。请参阅文档：[https ://developer.mozilla.org/en-US/docs/DOM/Using_web_workers?redirectlocale=en-US&redirectslug=Using_web_workers](https://developer.mozilla.org/en-US/docs/DOM/Using_web_workers?redirectlocale=en-US&redirectslug=Using_web_workers)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-07T21:21:32.350

你可以，但只能在支持的现代浏览器中`Webworkers`

[http://www.html5rocks.com/en/tutorials/workers/basics/](http://www.html5rocks.com/en/tutorials/workers/basics/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-07T21:22:29.263

JS 不直接支持多线程，但我相信您可以通过使用多个运行相同脚本或不同脚本的 IFRAMES 来模拟它。我只是在猜测。

# tsql - SQL Azure：在 CREATE TABLE TRIGGER 上获取表名

> ID：12325538
> 
> 赞同：2
> 
> 时间：2012-09-07T21:18:50.157
> 
> 标签：tsql, azure, azure-sql-database

在 SQL Server 2008 中，我有一个 DDL 触发器，它正在获取使用以下触发器创建的表的表名：

```
CREATE TRIGGER [tr_getName] ON DATABASE FOR CREATE_TABLE 
AS 

DECLARE @xmlEventData XML
DECLARE @TableName varchar(128)
-- Capture the event data that is created
SET @xmlEventData = eventdata()

IF OBJECT_ID('dbo.tNames', 'U') IS NOT NULL
BEGIN
    DeAllocate tNames
END 

DECLARE tNames CURSOR Read_Only
FOR SELECT CONVERT(VARCHAR(128), @xmlEventData.query('data(/EVENT_INSTANCE/ObjectName)'))
OPEN tNames

FETCH Next FROM tNames
    INTO @TableName
...
... 
```

但是，在 SQL Azure 中不再支持 eventdata()。有没有办法在 SQL Azure 中完成等效操作？谢谢

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2014-01-17T14:21:36.713

有关如何获取事件数据的信息，请参见以下页面：

[http://msdn.microsoft.com/en-us/library/ms173781(v=sql.120).aspx](http://msdn.microsoft.com/en-us/library/ms173781(v=sql.120).aspx)

[http://msdn.microsoft.com/en-us/library/ms187909(v=sql.120).aspx](http://msdn.microsoft.com/en-us/library/ms187909(v=sql.120).aspx)

# objective-c - 类方法包含对另一个类的方法的选择器调用

> ID：12325540
> 
> 赞同：1
> 
> 时间：2012-09-07T21:18:56.813
> 
> 标签：objective-c, class

所以我用类方法创建了一个类 CommonMethods：

```
+ (CCMenu *)createMenu:(NSString *)menuName atPosition:(CGPoint)position {
    CCMenuItemImage *menuBlock = [CCMenuItemImage itemWithNormalImage:menuName selectedImage:menuName target:self selector:@selector(choose:)];
    CCMenu *menuBlockMenu = [CCMenu menuWithItems:menuBlock, nil];
    menuBlockMenu.position = position;
    return menuBlockMenu;
} 
```

现在在包含选择方法的 MainClass 中，我创建了一个菜单：

```
CCMenu *regularBlockMenu = [CommonMethods createMenu:kbRegularBlock atPosition:position];
[self addChild:regularBlockMenu]; 
```

当我点击菜单时我的程序崩溃了，因为它不理解选择器调用。我该如何实施？我想创建一个 CommonMethods 方法，因为我将在许多类中一遍又一遍地使用这个方法。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T21:25:28.760

由于`self`在类方法中引用了类，因此您不应该将`self`选择器作为目标：

```
CCMenuItemImage *menuBlock = [CCMenuItemImage itemWithNormalImage:menuName selectedImage:menuName target:self selector:@selector(choose:)];
//                                                                                            HERE ------^^^^ 
```

相反，您应该将选择器发送到响应选择器的对象`choose:`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T22:17:58.147

您想在 MainClass 类中选择一个方法吗？如果是这样，您需要稍微修改您的 createMenu 函数。试试这个，

```
+ (CCMenu *)createMenu:(NSString *)menuName atPosition:(CGPoint)position forTarget:(id)target 
{
    CCMenuItemImage *menuBlock = [CCMenuItemImage itemWithNormalImage:menuName selectedImage:menuName target:target selector:@selector(choose:)];
    CCMenu *menuBlockMenu = [CCMenu menuWithItems:menuBlock, nil];
    menuBlockMenu.position = position;
    return menuBlockMenu;
} 
```

然后在 MainClass 中：

```
CCMenu *regularBlockMenu = [CommonMethods createMenu:kbRegularBlock atPosition:position forTarget:self];
[self addChild:regularBlockMenu]; 
```

你需要`-(void)choose:(id)sender;`在 MainClass中定义

所以这样做是设置选择的目标：成为 MainClass 的一个实例，而不是 CommonMethods。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T21:26:09.550

您需要使 CommonMethods 成为单例

```
@implementation CommonMethods
static CommonMethods* globalCommonMethods = nil;
+(CommonMethods*)gCommonMethods
{
    if( !globalCommonMethods ) globalCommonMethods = [[CommonMethods alloc] init];
    return globalCommonMethods;
}
-(CCMenu *)createMenu:(NSString *)menuName atPosition:(CGPoint)position {
    CCMenuItemImage *menuBlock = [CCMenuItemImage itemWithNormalImage:menuName selectedImage:menuName target:self selector:@selector(choose:)];
    CCMenu *menuBlockMenu = [CCMenu menuWithItems:menuBlock, nil];
    menuBlockMenu.position = position;
    return menuBlockMenu;
}

-(void)choose:(id)sender
{
    //do stuff
} 
```

现在，当您需要访问 CommonMethods 时，请使用 [CommonMethods gCommonMethods]

# java - 如何检测组件的碰撞？

> ID：12325553
> 
> 赞同：0
> 
> 时间：2012-09-07T21:20:05.490
> 
> 标签：java, swing, components, collision-detection, jlabel

如何检测组件的碰撞，特别是 JLabels（或 ImageIcons？）？我试过这个：

```
add(test1);
test1.setLocation(x, y);
add(test2);
test1.setLocation(x1, y1);
validate();

if(intersects(test1, test2))
{
    ehealth-=50;
}

public boolean intersects(JLabel testa, JLabel testb)
{
    boolean b3 = false;
    if(testa.contains(testb.getX(), testb.getY()))
    {
        b3 = true;
    }
    return b3;
} 
```

当我运行它时，它什么也不做！

我曾经使用过`Rectangle`，但它并不适合我。我正在考虑一个带有边框的图像（使用paint.net）并移动一个imageicon，但我不知道如何获取ImageIcon 的x 或检测碰撞。我也不知道如何检测标签的碰撞或增加位置。

我已经搜索了组件/ImageIcons 的碰撞检测，但没有出现任何结果。我还搜索了 ImageIcons 的 x。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T21:28:57.783

尝试使用`computeIntersection()`SwingUtilities 中的方法。根据此方法的[Javadoc ：](http://docs.oracle.com/javase/1.5.0/docs/api/javax/swing/SwingUtilities.html#computeIntersection%28int,%20int,%20int,%20int,%20java.awt.Rectangle%29)

> 方便计算两个矩形的交集，而无需分配新的矩形。如果两个矩形不相交，则返回的矩形从 (0,0) 开始，宽度和高度为零。

您可以使用上述内容执行以下操作：

```
public boolean intersects(JLabel testa, JLabel testb){
    Rectangle rectB = testb.getBounds();

    Rectangle result = SwingUtilities.computeIntersection(testa.getX(), testa.getY(), testa.getWidth(), testa.getHeight(), rectB);

    return (result.getWidth() > 0 && result.getHeight() > 0);
} 
```

正如@Jakub 建议的那样，另一种方法是使用`intersects()`区域方法。示例代码将是这样的：

```
public boolean intersects(JLabel testa, JLabel testb){
    Area areaA = new Area(testa.getBounds());
    Area areaB = new Area(testb.getBounds());

    return areaA.intersects(areaB.getBounds2D());
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T21:34:29.863

您可以自己编写它，请记住，如果两个区域的区域重叠，则两个区域相交，而不仅仅是当一个区域包含 x 和 y 坐标（您正在测试）时。

如果我是你，我会使用[`Area`](http://docs.oracle.com/javase/7/docs/api/java/awt/geom/Area.html). 它已经有了你需要的方法`contains`。`intersects`

# c++ - 如何将 Objective C 代码添加到 FireBreath 项目？

> ID：12325559
> 
> 赞同：4
> 
> 时间：2012-09-07T21:20:29.677
> 
> 标签：请记住，我对此有点陌生，所以如果您留下详细的答案，而不是firebreath, c++, objective-c, macos, osx-lion, firebreath

我正在为 Mac OS 编写一个浏览器插件，它将在状态栏中放置一个状态栏图标，用户可以使用它来与浏览器插件交互。我已经在 XCode 4.4.1 中成功构建了一个 FireBreath 1.6 项目，并且可以在浏览器中安装它。然而，FireBreath 使用 C++，而大多数现有的 Mac OS 库都是用 Objective C 编写的。

在 /Mac/projectDef.make 文件中，我添加了 Cocoa 框架和 Foundation 框架，正如[这里](https://stackoverflow.com/questions/8031172/converting-a-cocoa-application-to-a-npapi-plugin-with-the-firebreath-framework/8031756#8031756)和我在 Internet 上找到的其他资源中所建议的那样：

```
target_link_libraries(${PROJECT_NAME}
    ${PLUGIN_INTERNAL_DEPS}
    ${Cocoa.framework} # added line
    ${Foundation.framework} # added line
) 
```

我重新运行了 prepmac.sh，希望在 XCode 中使用我的 .mm 文件和 .m 文件创建一个新项目；但是，似乎它们被忽略了。我只看到 .cpp 和 .h 文件。我在 projectDef.make 文件中添加了规则，但似乎没有什么区别：

```
file (GLOB PLATFORM RELATIVE ${CMAKE_CURRENT_SOURCE_DIR}
    Mac/[^.]*.cpp
    Mac/[^.]*.h
    Mac/[^.]*.m    #added by me
    Mac/[^.]*.mm   #added by me
    Mac/[^.]*.cmake
) 
```

即使我手动添加文件，也会出现一系列编译错误。大概有20个左右，都和file`NSObjRuntime.h`文件有关：

```
Parse Issue - Expected unqualified-id
Parse Issue - Unknown type name 'NSString'
Semantic Issue - Use of undeclared identifier 'NSString'
Parse Issue - Unknown type name 'NSString'
...
...
Semantic Issue - Use of undeclared identifier 'aSelectorName'
...
...
Semantic Issue - Use of undeclared identifier 'aClassName'
... 
```

它会这样持续一段时间，并出现类似的错误......

根据我的阅读，这些错误的出现是由于对 Foundation Framework 的依赖，我相信我已经将其包含在项目中。我还尝试在 XCode 中单击项目

我现在到了不知道接下来要尝试什么的地步。人们说在 C/C++ 代码中使用 Objective C 并不难，但是对 XCode 和 Objective C 不熟悉可能会导致我的困惑。这只是我在这个新平台上的第 4 天。

我需要做什么才能让 XCode 编译 Objective C 代码？[请记住，我对此有点陌生，所以如果您留下详细的答案，而不是firebreath](/questions/tagged/firebreath "显示标记为“firebreath”的问题")标签中常见的模糊单行字，我将不胜感激。我只是有点过头了，但如果你能让我越过这个障碍，我相信我会很好地从那里开始。

**更新：**

我编辑了 projects/MyPlugin/CMakeLists.txt 并在那里添加了 .m 和 .mm 规则。运行 prepmac.sh 后，文件包含在项目中，但我仍然得到相同的编译错误。

我将所有 .h 文件和 .mm 文件从 Obj C 代码移动到 MyPlugin 根文件夹并重新运行 prepmac.sh 文件。问题依然存在。同样的编译错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-08T03:20:04.330

您的问题是您的 .h 文件包含在具有目标 c 类型和/或包含在其中的 C++ 文件中。为了做你想做的事情，你所有的 C++ 使用的类需要要么将所有与 obj c 相关的东西保存在 #ifdef 中，要么根本不在头文件中公开任何 obj c。

例如，您可以在标题中使用此 ifdef：

```
#ifdef __OBJC__
     // Objective C / C++ code here
#endif 
```

重要的是要记住 .h 文件是*包含*以及头文件，因此它们实际上是包含在内的。如果您在 .cpp 文件中包含目标 c 代码，编译器会感到困惑并哭泣。

* * *

编辑：要记住的最重要的事情是，您需要确保 cpp 文件中不包含任何目标 c 头文件（或具有目标 c 代码的其他文件）。如果你能做到这一点，你会没事的。

# php - PHP + OAuth + Google：获取“所需长度”而不是访问令牌

> ID：12325562
> 
> 赞同：3
> 
> 时间：2012-09-07T21:20:50.897
> 
> 标签：php, oauth

我正在尝试在我的应用中添加使用 Google 登录。在用户重定向到谷歌并返回（使用`code`）后，我需要获取访问令牌：

```
 $url = "https://accounts.google.com/o/oauth2/token";
        $content = "code={$code}&client_id={$params['appid']}&client_secret={$params['secret']}&" .
            "redirect_uri=$return_url&grant_type=authorization_code";

        $opts = array(
            'http'=>array(
                'method'=>'POST',
                'header'=>'Content-type: application/x-www-form-urlencoded\r\n' .
                    'Content-Length: ' . strlen($content)
            )
        );

        $cont = stream_context_create($opts);

        $response = file_get_contents($url + '?' + $content, false, $cont); 
```

最后一行抛出警告`[function.file-get-contents]: failed to open stream: HTTP request failed! HTTP/1.0 411 Length Required`。不过，如您所见，我将`Content-Length`标头放入请求中。有人可以告诉我做错了什么吗？

先感谢您！

# c# - 初始化引用类型对象数组的简洁方法

> ID：12325563
> 
> 赞同：4
> 
> 时间：2012-09-07T21:20:51.910
> 
> 标签：c#, linq

我想知道是否有更好的方法来初始化引用类型对象的数组，就像这样。

```
Queue<int>[] queues = new Queue<int>[10];
for (int i = 0; i < queues.Length; i++)
    queues[i] = new Queue<int>(); 
```

我试过 Enumerable.Repeat，但数组中的所有元素都引用同一个实例，

```
Queue<int>[] queues = Enumerable.Repeat(new Queue<int>(), 10).ToArray(); 
```

我也尝试了 Array.ForEach，但如果没有 ref 关键字，它就无法工作：

```
Queue<int>[] queues = Array.ForEach(queues, queue => queue = new Queue<int>()); 
```

还有其他想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-07T21:31:22.847

你可以使用这个：

```
Enumerable.Range(0,10).Select(_=>new Queue<int>()).ToArray() 
```

但是 IMO 你的第一个例子也很好。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-07T21:24:54.720

不，没有。只需将其分解为实用方法即可：

```
// CommonExtensions.cs
public static T[] NewArray<T> (int length) where T : class, new ()
{
    var result = new T[length] ;
    for (int i = 0 ; i < result.Length ; ++i)
         result[i] = new T () ;
    return result ;
}

// elsewhere
var queues = Extensions.NewArray<Queue<int>> (10) ; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T21:35:57.677

我有同样的答案——使用循环。但是您可以将其作为通用的扩展方法：

```
 public static void Init<T>(this IList<T> array )
    {
        if (array == null) return;

        for (int i = 0; i < array.Count; i++)
            array[i] = Activator.CreateInstance<T>();
    } 
```

就这么称呼它：

```
 Queue<int>[] queues = new Queue<int>[10];
        queues.Init(); 
```

# php - 用PHP获取计算机的IP地址

> ID：12325571
> 
> 赞同：0
> 
> 时间：2012-09-07T21:21:45.177
> 
> 标签：php, mysql

如何获取用户的 IP 地址，然后将其存储到 MySQL 表中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T21:23:27.590

你的标题说暗示一个问题，而问题文本是另一个。PHP 将用户的 IP 存储为`$_SERVER['REMOTE_ADDR']`. 您可以将其作为字符串直接填充到 MySQL 中，或者将其转换为整数，在这种情况下，您必须考虑有人通过 IPv6 进入并拥有 128 位 IP 地址，而不仅仅是 32 位。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T21:29:50.427

您应该阅读以下文章：

*   如何使用 PHP 获取真实 IP 地址： [http ://roshanbh.com.np/2007/12/getting-real-ip-address-in-php.html](http://roshanbh.com.np/2007/12/getting-real-ip-address-in-php.html)

*   如何在 MySQL 中存储 IP 地址： [客户端 IP 地址的最大长度](https://stackoverflow.com/questions/1076714/max-length-for-client-ip-address)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T21:24:23.000

正如您在[https://stackoverflow.com/questions/1437771/how-can-i-get-the-clients-ip-address-in-a-php-webservice](https://stackoverflow.com/questions/1437771/how-can-i-get-the-clients-ip-address-in-a-php-webservice)上看到的，在 PHP 中获取 IP 是通过访问`$_SERVER['REMOTE_ADDR']`变量。

要轻松地将 IP 存储在 MySQL 中，您可以

*   使用 CHAR(15)
*   使用 INET_ATON(expr) 函数

# javascript - window.open 使页面向上滚动

> ID：12325574
> 
> 赞同：0
> 
> 时间：2012-09-07T21:22:17.123
> 
> 标签：javascript

我正在使用 windows.open 弹出窗口，当我单击它时页面会自动上升，我该如何防止这种情况发生？我试过'top：auto'它不起作用这是我的代码

> ```
>  function openPopup() {
> 
>         var divText = document.getElementById("pass").outerHTML;
>         var myWindow = window.open('', '', 'width=500,height=200,top=100');
>         var doc = myWindow.document;
>         doc.open();
>         doc.write(divText);
>         doc.close();
>     } 
> ```

```
 <a href="#" onclick="openPopup()">Read More</a> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T21:26:16.920

不是那个`window.open`，是那个`href="#"`。

我总是使用`href="javascript:void(null);"`将由. `onclick`_`javascript:;``return false;``onclick`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T21:28:48.173

尝试`<a href="javascript:void(0)" onclick="openPopUp()".`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T21:29:27.057

浏览器正在执行您的 onClick 处理程序，然后继续执行默认行为——单击链接，这会导致浏览器滚动到`#`锚点。（地址栏最后也会得到一个 # 来反映这一点。）你希望你的 onClick 处理程序抑制点击事件，所以有它`return false`：

```
 <a href="#" onclick="openPopup(); return false">Read More</a> 
```

# javascript - 使用 jQuery 访问动态创建的项目？

> ID：12325575
> 
> 赞同：5
> 
> 时间：2012-09-07T21:22:19.553
> 
> 标签：javascript, jquery, html

我有一个页面，其中一些 html 被动态添加到页面中。

这是创建的 html 和 javascript：

```
<div>
    <script type="text/javascript" language="javascript">
        $('#btn').click(function() {
            alert("Hello");
        });
    </script>

    <a id="btn">Button</a>
</div> 
```

查看我的 Firebug 控制台，我收到一条错误消息：

> 类型错误：$("#btn") 为空

jQuery 最初是在页面上加载的。

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-07T21:24:24.657

您必须将`on()`（或方法中定义的事件绑定`on()`到运行 jQuery 时存在于 DOM 中的元素。通常这是 on`$(document).ready()`或类似的。

`$('#btn')`绑定到页面加载/DOM 就绪时存在于 DOM 中的元素将被追加的最近元素。

假设您正在加载`$('#btn')`（`#container` `div`例如），给出：

```
<div id="container">
    <div>
        <a href="#" id="btn">Button text</a>
    </div>
</div> 
```

然后使用：

```
$('#container').on('click', '#btn', function(){
    alert('Button clicked!');
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T21:25:22.097

用于`.on`将事件连接到您的按钮。检查这个答案：

[动态创建元素的事件绑定？](https://stackoverflow.com/questions/203198/jquery-event-binding-on-dynamically-created-elements)

```
$(document).ready(function() {
    $('body').on('click', '#btn', function() {
        alert("Hello");
    });
}) 
```

编辑：我添加了文档就绪代码，您需要确保这样做。

固定的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T21:24:21.243

您正在寻找 .on ，它将点击事件绑定到动态添加的节点。

```
$("#parent_container").on("click", "#btn", function () {
    alert("hello")
}) 
```

文档：[http ://api.jquery.com/on/](http://api.jquery.com/on/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T21:24:46.520

尝试

```
<div>
     <a id="btn">Button</a>
</div>
 <script>

    $('#btn').on('click', function() {
        alert("Hello");
    });

</script> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-07T21:25:28.587

您的代码中的问题是您在创建按钮之前将事件附加到按钮。

正确的版本是：

```
 <div>
       <a id="btn">Button</a>
       <script type="text/javascript" language="javascript">
           $('#btn').click(function() {
              alert("Hello");
           });
       </script>            
  </div> 
```

这应该可以完成这项工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-08T01:06:47.423

使用[`.live()`](http://api.jquery.com/live/)jQuery的功能

# python - Python：从 apache authnz_ldap 获取用户

> ID：12325578
> 
> 赞同：3
> 
> 时间：2012-09-07T21:22:35.450
> 
> 标签：python, apache, ldap

我正在通过 Apache2 的 authnz_ldap 模块成功验证 ldap 用户。我不清楚他们登录后如何获取他们的用户名，以便我可以通过以下任何表单/网页与他们交互。我已经尝试过典型的方法（os.getenv os.environ getpass 等），但它们要么只给我 www-data 要么给我 None 结果。

我怀疑我需要的东西在 apache/ldap 模块中都可用，但我可以使用一些帮助来搜索正确的路径。谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-08T19:57:44.193

To answer my own question: [http://httpd.apache.org/docs/2.2/mod/mod_authnz_ldap.html#exposed](http://httpd.apache.org/docs/2.2/mod/mod_authnz_ldap.html#exposed)

Although the environment key was not documented, i threw in a few likely suspects and found that `os.getenv('AUTHENTICATE_UID')` was the winner.

I hope this saves someone some time.

# c# - 窗口的计算区域 - 公式错误

> ID：12325579
> 
> 赞同：0
> 
> 时间：2012-09-07T21:22:40.573
> 
> 标签：c#, numbers, integer, formula

我的程序有点问题。基本上，我必须创建一个程序来查找窗口（例如玻璃窗）的区域。公式是面积 = 高度 * 宽度，这就是我输入的内容。但是，结果实际上并没有回答高度 * 宽度。如果我输入相同的两个数字（例如，3 * 3），答案将是正确的 (9)。另一方面，如果我输入两个不同的数字（例如，4 * 5），则答案不正确（它会说上一个示例的答案是 25，应该是 20）。谁能帮我理解为什么会这样并帮我解决问题？

PS 我刚刚开始在学校使用 Microsoft Visual C# 2010 Express 进行计算。这就是为什么它相当简单。

```
using System;

namespace FindTheArea
{
    class Program
    {
        static void Main(string[] args)
        {               
            string temporary;
            double Height;
            double Width;
            double Area;

            Console.WriteLine("Find The Area");
            Console.WriteLine("Please enter the height below");
            temporary = Console.ReadLine();
            Console.WriteLine("Please enter the Width below");
            temporary = Console.ReadLine();

            Console.Clear();

            Height = double.Parse(temporary);
            Width = double.Parse(temporary);

            Area = (Height * Width);

            Console.WriteLine("The area is...");
            Console.WriteLine();
            Console.WriteLine(Area+"cm2");

            Console.Read();
        }
    }
} 
```

我现在明白我哪里出错了。但是我该如何解决呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-07T21:24:22.760

```
Height = double.Parse(temporary);
Width = double.Parse(temporary); 
```

这里有一个明显的问题。的行为`double.Parse()`是确定性的，因此您将相同的值分配给`Height`和`Width`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T21:24:58.407

```
Console.WriteLine("Please enter the height below");

temporary = Console.ReadLine();

Console.WriteLine("Please enter the Width below");

temporary = Console.ReadLine(); 
```

您正在覆盖 的第一个值`temporary`。您应该将输入的值分配给两个不同的变量。

```
string temporaryHeight;
string temporaryWidth;

Console.WriteLine("Please enter the height below");

temporaryHeight= Console.ReadLine();

Console.WriteLine("Please enter the Width below");

temporaryWidth= Console.ReadLine(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T21:27:34.687

看看这段代码：

```
 Console.WriteLine("Please enter the height below");

    temporary = Console.ReadLine();

    Console.WriteLine("Please enter the Width below");

    temporary = Console.ReadLine(); 
```

您将高度值分配给临时值，然后将宽度值分配给临时值。这意味着您已经丢失了高度值，因为您已经覆盖了它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T21:24:57.860

临时有同样的价值！将一个更改为temporary1，将另一个更改为temporary2。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-07T21:25:22.073

```
 Console.WriteLine("Please enter the height below");

        temporary = Console.ReadLine();

        Console.WriteLine("Please enter the Width below");

        temporary = Console.ReadLine(); 
```

您没有存储第一个值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-07T21:48:30.623

使用系统；

```
namespace FindTheArea
{

    class Program
    {

        static void Main(string[] args)
        {
            double Height;
            double Width;
            double Area;

            Console.WriteLine("Find The Area");
            Console.WriteLine("Please enter the height below");
            Height = double.Parse(Console.ReadLine());
            Console.WriteLine("Please enter the Width below");
            Width = double.Parse(Console.ReadLine());

            Console.Clear();

            Area = (Height * Width);

            Console.WriteLine("The area is...");
            Console.WriteLine();
            Console.WriteLine(Area+"cm2");

            Console.ReadKey();
        }

    }

} 
```

# c++ - How to define a template for pointers and dynamic memory allocation?

> ID：12325581
> 
> 赞同：1
> 
> 时间：2012-09-07T21:23:16.523
> 
> 标签：c++, templates, pointers, dynamic-memory-allocation, class-template

I've made a class template called **Queue** but I'm having problems trying to instanciate it with a pointer to another class called Worker as the type. `Queue<Worker*>`

The problem I think comes with this concrete Queue method:

```
// Add item to queue
template <typename Type>
bool Queue<Type>::enqueue(const Type& item)
{
    if (isfull())
        return false;
    Node* add = new Node; // create node
    // on failure, new throws std::bad_alloc exception
    add->item = item; // set node pointers (shallow copying!!!!!)
    add->next = nullptr;
    items++;
    if (front == nullptr) // if queue is empty,
        front = add; // place item at front
    else
        rear->next = add; // else place at rear
    rear = add; // have rear point to new node
    return true;
} 
```

In the case of the type parameter being a pointer I need to copy the pointed-to value, not the address (I'm using dynamic memory management) to avoid the program crashing.

I don't know how to solve this with a template.

Any help?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T22:51:56.783

Use traits technique.

I mean define simple struct where all magic will be implemented. Something like this deep_copy:

```
 template <typename T>
  struct deep_copy {
     void do_copy(T& d, const T& s)
     {
        d = s;
     }
  }; 
```

And specialization for pointers

```
 template <typename T>  
   struct deep_copy<T*> {
     void do_copy(T*& d, const T* s)
     {
       if(s) d=new(*s); else d=0; }};
     }
   }; 
```

**[UPDATE1] More details and more examples:**

And use deep_copy in your Queue:

```
template <typename T>
class Queue {
public:
   void push_back(const T& elem)
   {
       Node* n = new Node();
       copyTraits.doCopy(n->elem, elem);
   }
private:
  deep_copy<T> copyTraits;
}; 
```

Or even better make it default parameter to your template like less<> is default for map.

```
template <typename T, typename CopyTraits = deep_copy<T> >
class Queue {
public:
   void push_back(const T& elem)
   {
       Node* n = new Node();
       copyTraits.doCopy(n->elem, elem);
   }
private:
  CopyTraits copyTraits;
}; 
```

And do not forget about destroy method, if you want your `Queue::~Qeueu()` d-tor to be safe:

```
 template <typename T>
  struct deep_copy {
     void do_copy(T& d, const T& s)
     {
        d = s;
     }
     void do_destroy(const T& elem) {} // do nothing
  };

   template <typename T>  
   struct deep_copy<T*> {
     void do_copy(T*& d, const T* s)
     {
       if(s) d=new(*s); else d=0; }};
     }
     void do_destroy(const T& elem) {
       delete elem;
     }
   };         

template <typename T, typename AllocTraits = deep_copy<T> >
class Queue {
public:
   ...
   ~Queue() {
      for (n in Nodes) { // pseudo-code
         allocTraits.doDestroy(n->elem);
      }
   }
private:
  AllocTraits allocTraits;
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T21:55:57.457

Although it will cause a bit of code duplication, you can create a specialization of your `Queue` class for instantiations with pointer-types. My recommendation in order to reduce the amount of code duplication would be to create a base-class that each specialized class will inherit from, where the base-class contains all the methods and members that will not change depending on the type that the class is instantiated with.

So for instance:

```
template<typename T>
base_queue; //keep everything "common" in this class

template<typename T>
queue : public base_queue<T> { ... }; //unspecialized queue class

template<typename T>
queue<T*> : public base_queue<T> { ... }; //pointer specialized version 
```

Now in the specialized version of your `Queue<T*>` class, your `enqueue` method can look like the following:

```
template <typename T>
bool Queue<T*>::enqueue(const T* item)
{
    //... code

    add->item = *item; // copy the value being pointed to, not the pointer itself

    //... more code

    return true;
} 
```

# java - 从所有活动/类中删除一行代码

> ID：12325586
> 
> 赞同：0
> 
> 时间：2012-09-07T21:23:42.990
> 
> 标签：java, android, eclipse, android-activity

好的，我想知道如何从我的所有活动中删除一行代码。我知道我在所有活动中都有相同的代码行，我只是想知道我是否可以轻松删除它而不是逐个活动地执行它。这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T21:28:25.247

您可以执行以下操作：

*   在顶部菜单中选择搜索/文件（或按`CTRL`+ `H`）。
*   在打开的对话框中，键入“包含文本”，然后点击“替换”。
*   在新对话框中输入要替换的字符串。

我认为您应该谨慎使用此功能。

# ruby - 从另一个文本文件的一行创建一个新文件（名称）

> ID：12325598
> 
> 赞同：1
> 
> 时间：2012-09-07T21:24:50.123
> 
> 标签：ruby, file, filenames

你能告诉我为什么这段代码会出错吗？

我不明白这一行：`File.new("#{line}", "w")`

```
system "ipconfig /all > info.txt"
info_text = File.open("info.txt")
info_text.each { |line|
  if line =~ /Physical Address/
    line.slice! "   Physical Address. . . . . . . . . : "
    File.new("#{line}", "w")
  end
} 
```

谢谢-迈克·W

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T21:45:30.280

该代码旨在在 Microsoft Windows 上运行。该脚本不会在其他操作系统上做任何有用的事情。特别是，它会尝试使用 MAC 地址为系统上的每个网络适配器创建一个空文件。

它很可能`line`包含 Windows 不允许在文件名中使用的字符。（Windows 比 Linux 或 Mac OS X 更具限制性。）您遇到了什么错误？

此外，请尝试在调用之前立即打印`line`变量`File.new`以查看它包含的内容。

您可能需要`line`通过删除无效字符来进行清理。有关不允许的内容，请参阅[此答案。](https://stackoverflow.com/a/62888/498594)简单的方法是使用简单的白名单：

```
# remove non-alphanumeric and non-underscore
line.gsub!(/\W/, '') 
```

我怀疑这是导致错误的换行符。

更新：

我在 Windows 上进行了测试，确实是回车 ( `\r`) 和换行 ( `\n`) 导致了问题。我明白了`Errno::EINVAL: Invalid argument`。

这应该通过删除所有空格来解决它：

```
line.gsub!(/[\s]/, '') 
```

# python - 迭代 Python 中的字典或列表

> ID：12325608
> 
> 赞同：14
> 
> 时间：2012-09-07T21:25:38.777
> 
> 标签：python, list, dictionary, loops

刚刚写了一些讨厌的代码，在 Python中迭代 a`dict`或 a 。`list`我有一种感觉，这不是最好的方法。

问题是为了迭代一个字典，这是约定：

```
for key in dict_object:
    dict_object[key] = 1 
```

但是，如果在列表上执行相同的操作，则通过键修改对象属性不起作用：

```
# Throws an error because the value of key is the property value, not 
#     the list index:

for key in list_object:
    list_object[key] = 1 
```

我解决这个问题的方法是编写这个讨厌的代码：

```
if isinstance(obj, dict):
    for key in obj:
        do_loop_contents(obj, key)
elif isinstance(obj, list):
    for i in xrange(0, len(obj)):
        do_loop_contents(obj, i)

def do_loop_contents(obj, key):
    obj[key] = 1 
```

有一个更好的方法吗？

谢谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-07T21:33:07.420

我从来不需要这样做，从来没有。但如果我这样做了，我可能会做这样的事情：

```
seq_iter = x if isinstance(x, dict) else xrange(len(x)) 
```

例如，在函数形式中：

```
>>> def seq_iter(obj):
...     return obj if isinstance(obj, dict) else xrange(len(obj))
... 
>>> x = [1,2,3]
>>> for i in seq_iter(x):
...     x[i] = 99
... 
>>> x
[99, 99, 99]
>>> 
>>> x = {1: 2, 2:3, 3:4}
>>> for i in seq_iter(x):
...     x[i] = 99
... 
>>> x
{1: 99, 2: 99, 3: 99} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-07T21:41:41.777

这是正确的方法，但是如果由于某种原因您需要以相同的方式处理这两个对象，您可以创建一个迭代器，它无论如何都会返回索引/键：

```
def common_iterable(obj):
    if isinstance(obj, dict):
        return obj
    else:
        return (index for index, value in enumerate(obj)) 
```

它将按照您想要的方式运行：

```
>>> d = {'a': 10, 'b': 20}
>>> l = [1,2,3,4]
>>> for index in common_iterable(d):
    d[index] = 0

>>> d
{'a': 0, 'b': 0}
>>> for index in common_iterable(l):
    l[index] = 0

>>> l
[0, 0, 0, 0] 
```

或者可能更有效，使用生成器：

```
def common_iterable(obj):
    if isinstance(obj, dict):
        for key in obj:
            yield key
    else:
        for index, value in enumerate(obj):
            yield index 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-07T21:40:51.870

要成为pythonic和ducktype-y，并且要遵循“请求宽恕而不是许可”，您可以执行以下操作：

```
try:
    iterator = obj.iteritems()
except AttributeError:
    iterator = enumerate(obj)
for reference, value in iterator:
    do_loop_contents(obj, reference) 
```

虽然如果您只需要键/索引：

```
try:
    references = obj.keys()
except AttributeError:
    references = range(len(obj))
for reference in references:
    do_loop_contents(obj, reference) 
```

或者作为一个函数：

```
def reference_and_value_iterator(iterable):
    try:
        return iterable.iteritems()
    except AttributeError:
        return enumerate(iterable)

for reference, value in reference_and_value_iterator(obj):
    do_loop_contents(obj, reference) 
```

或者只是参考：

```
def references(iterable):
    try:
        return iterable.keys()
    except AttributeError:
        return range(len(iterable))

for reference in references(obj):
    do_loop_contents(obj, reference) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-07T22:27:08.373

```
test_list = [2, 3, 4]
for i, entry in enumerate(test_list):
    test_list[i] = entry * 2
print(test_list)  # Gives: [4, 6, 8] 
```

但你可能想要一个列表理解：

```
test_list = [2, 3, 4]
test_list = [entry * 2 for entry in test_list]
print(test_list)  # Gives: [4, 6, 8] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-08T14:21:48.837

您可能只想拥有不同的代码，具体取决于您尝试更改的对象是字典还是列表。

```
if type(object)==type([]):
    for key in range(len(object)):
        object[key]=1
elif type(object)==type({}): #use 'else' if you know that object will be a dict if not a list
    for key in object:
        object[key]=1 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-09-17T08:31:23.880

我在寻找更好的帖子时偶然发现了这篇文章，这就是我的做法。

```
for row in [dict_or_list] if not type(dict_or_list) is list else dict_or_list:
    for i,v in row.items():
        print(i,v) 
```

# hibernate - 使用休眠批量插入/更新

> ID：12325609
> 
> 赞同：1
> 
> 时间：2012-09-07T21:25:46.587
> 
> 标签：hibernate

我正在使用类似于 [http://code.google.com/p/struts2-jquery/source/browse/showcase-grid/src/com/jgeppert/struts2/jquery/grid/showcase/dao中的表单的类 AbstractSimpleGenericDao /AbstractSimpleGenericDao.java?r=322](http://code.google.com/p/struts2-jquery/source/browse/showcase-grid/src/com/jgeppert/struts2/jquery/grid/showcase/dao/AbstractSimpleGenericDao.java?r=322)

MyDAO 扩展了这个类。我有 1000 个我希望休眠的对象。我是否在每一个上调用 MyDAO.save(object)。这对我来说似乎非常低效。这是否每次都会导致数据库命中？有什么方法可以同时插入很多对象吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-08T02:27:44.683

您确实必须对要保存到数据库的每个项目调用 save 。值得记住的是，Hibernate 是一个 ORM。它可用于批量插入，但通常不是最有效的方法。

如果您还没有阅读 Hibernate 手册的[这一](http://docs.jboss.org/hibernate/orm/4.1/manual/en-US/html_single/#batch)章，那当然值得一读。那里有一些有用的技巧，关于保持会话较小以避免大量脏检查等。如果您只插入 1000 个对象而不驱逐任何先前的对象，则操作将变得越来越慢，因为 Hibernate 必须对越来越多的对象进行脏检查。

Hibernate 实际执行插入的方式被设计为尽可能高效。可以批处理插入以利用数据库优化。值得记住的是，如果您使用基于标识的生成器，例如在 MySQL 上，您将失去任何批处理优势。这是因为 Hibernate 必须实际执行插入才能在将对象插入会话时生成标识符。

您可以实施替代标识符生成策略以确保您不需要这样做。一种可能性可能是存储每个实体的当前最高标识符的表。然后 Hibernate 可以以适当大小的批次从该表中请求标识符。

如果你发现 Hibernate 很慢，你总是可以回退到普通的旧 JDBC 来完成这项任务。

# sass - SASS：扩展类与变量

> ID：12325610
> 
> 赞同：0
> 
> 时间：2012-09-07T21:25:46.803
> 
> 标签：sass

最近在使用 Sass 时，我一直在扩展类来代替变量。

例如：

**- 使用变量**

```
$small-font: 12px

p {
font-size: $small-font
} 
```

**- 延长课程**

```
.small-font {
font-size:12px;
}

p {
@extend .small-font;
} 
```

扩展类的优点是它可以更容易地使您的代码响应。例如，我可以包装 `.small-font`一个媒体查询，这对于变量是不可能的。

我的问题是：以这种方式使用扩展类有什么缺点吗？我知道输出倾向于将所有类集中在一起（这会使调试更加麻烦），但是还有其他潜在问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-08T01:09:05.407

有几个问题。一是它的疯狂滑坡性质。这将作为维护问题回来咬你。每个属性的类作为代码组织方案没有意义。这并不意味着你离得很远——@extend 非常适合这样的事情，在合理的范围内。

原因是关键：你的分组作为分组应该是有意义的。虽然 html 样式的内容语义对于 @extends 并不重要，但仍然应该有语义组织感。我已经看到了“视觉语义”这个术语。你的命名应该超越描述效果，而是描述它的视觉原因。不是 %yellow，而是 %highlight-text。不是%red，而是%warning。不是什么，而是为什么。

另一个问题是级联。输出代码的顺序非常重要，因为它会影响级联（这是 CSS 的重要组成部分）。使用这种方法，您会发现自己经常与级联作斗争——因为您放弃了对代码顺序的控制。@extend 非常适合广泛而简单的默认分组，但它不适合级联覆盖。

# c# - 如何设置考虑 utf8 的 VS2010 设置，以便我可以将数据原样发送到 mysql 数据库

> ID：12325611
> 
> 赞同：0
> 
> 时间：2012-09-07T21:25:54.407
> 
> 标签：c#, mysql, utf-8

我有一个 MYSQL 数据库，它有一个表（字符集在 utf8->utf8_general_ci 上）。当我在此表中插入字符串数据时（通过 MYSQLquery 浏览器）中欧“ČĆŽŠĐ”字母被正确插入。但是，当我尝试通过 C# 应用程序（简单的 VS2010 Windows 窗体应用程序）插入相同的内容时：

**"Č"**我在表中得到**"C"**，**"Ć"**我在表中得到**"C"**，对于**"Đ"**我得到**"D"**。 **“Ž”**和**“Š”**很好。

我想它最高可达 VS2010 选项，或者......

知道为什么会这样吗？

## 代码

在 Click 事件中，我将数据发送到我的表：

```
private void button1_Click(object sender, EventArgs e)
{
    string a= textBox1.Text;
    string b= textBox2.Text;
    int b= int.Parse(textBox3.Text);
    string d= textBox4.Text;

    string cs = @"server=localhost;userid=root;password=xxx;database=table";
    string myquerystring = "INSERT INTO table VALUES(0,'" +a+ "', '" +b+ "','"+c+"', '"+d+"')";

    try
    {
        conn = new MySqlConnection(cs);
        conn.Open();
        MySqlCommand cmd = new MySqlCommand();
        cmd.Connection = conn;
        cmd.CommandText = myquerystring;
        cmd.ExecuteNonQuery();
    }
    catch (MySqlException ex)
    {
        MessageBox.Show(ex.ToString());
    }
    finally
    {
        if (conn != null)
        {
            conn.Close();
        }
    }

} 
```

好的，

我试过这个编码逻辑：

```
 string letters = "čćžšđ"; 

        byte[] byteENC = Encoding.UTF8.GetBytes(letters);

        Console.WriteLine("UTF-8  Text : {0}", Encoding.UTF8.GetString(byteENC)); 
```

我得到了它们。此外，当我在 win 表单应用程序中执行此操作时，我得到了相同的结果（mbox 中的结果是正确的）。

但是，当我将相同的字符串传输到数据库时，**ČĆĐ**是**CCD**。

转移中发生了一些事情。什么？我需要帮助？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T22:08:26.917

这是转换字符串编码的代码

```
byte[] data = Encoding.ASCII.GetBytes(textBox1.Text);
string n = Encoding.UTF8.GetString(data);
MessageBox.Show(n); 
```

* * *

**编辑**：或者你可以获得中欧编码

```
Encoding enc = Encoding.GetEncoding("windows-1250");
byte[] data = enc.GetBytes(textBox1.Text); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T08:04:46.247

我认为您可以尝试修改连接字符串以将 charsetOption 添加到此>>>

```
string cs = @"server=localhost;userid=root;password=xxx;database=table;CharSet=UTF8"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-08T07:40:02.147

尝试将表排序规则更改为 utf8_unicode_ci，因为我认为在您的排序规则中删除了重音，因为 š 等于 s 等等......并且所有小写字母都是大写的......尝试更改排序规则

# apache - httpd.conf、php.ini 和 .htaccess 之间的区别

> ID：12325618
> 
> 赞同：6
> 
> 时间：2012-09-07T21:26:36.013
> 
> 标签：apache, .htaccess, php, httpd.conf

我即将开始学习Apache。我正在研究的所有资源，都提到了用于设置配置和内容的`php.ini`文件`.htaccess`。`httpd.conf`但是他们都不清楚这三个文件之间的区别。谁能解释它们的区别和用法？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-07T21:32:35.160

httpd.conf（在某些平台上实际上可以有不同的名称，但这是默认设置）是 Apache 的主配置文件。您可以使用 Include 语句来拉入外部配置文件。当 Apache 启动或运行“重新加载”时，会读入 httpd.conf。

.htaccss 是 Apache 的每个目录的配置文件。您可以在 httpd.conf 文件中启用或禁用 .htaccess 文件。在可能的情况下，建议我关闭 .htaccess 使用，因为每次请求导致它读取目录时，Apache 都会检查文件。

正如您可能知道的那样，PHP 与 Apache 是分开的，尽管它经常与它一起使用。php.ini 是 PHP 引擎的配置文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-07T21:31:07.900

每个守护进程或应用程序都有自己的配置文件。在 linux 上，这些通常位于`/etc`目录中。您将必须学习根据程序编辑每一个。与等`/etc/php5/php.ini`不同`/etc/apache2/httpd.conf`。

将它们视为不同类型的文件。Word 文档与 JPEG 图像或 AVI 视频不同。

*   PHP.ini 控制 PHP 的设置
*   .htaccess 控制给定文件夹（和所有子文件夹）的 apache 设置
*   httpd.conf 控制 apache 的设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T21:32:14.817

*   php.ini 是一个配置文件，您可以在其中指定与 php 相关的选项，例如 CURL
*   .htaccess 是您在服务器上指定 URI 路由选项和文件夹选项的地方
*   httpd.conf 是一个配置文件，您可以在其中指定与 apache 相关的选项

# drools - 流口水累积问题

> ID：12325620
> 
> 赞同：2
> 
> 时间：2012-09-07T21:26:38.610
> 
> 标签：drools

我在使用 Drools 5.4 累积时遇到问题。我想做的是在给定时间内发生许多事件时触发规则：

```
when

$things : List() from collect (TimedThings () over window:time(5ms)) 

$thing_list  : List(size > 10) from accumulate(
        $thing : TimedThings (eval(testMe(attribute, "1"))) from $things,
        collectList($thing)
            )
then 
```

现在我希望这只会在 thing_list 中有 10 件东西时触发，但我看到它在少于 10 件东西时触发。

我的规则不正确吗？

# jquery - 从 jquery.colorbox.js 中删除重复的图像

> ID：12325628
> 
> 赞同：3
> 
> 时间：2012-09-07T21:27:28.127
> 
> 标签：jquery, colorbox

嘿你们我有一个问题，我不知道如何解决我缺乏 jquery 技能。

我正在将 jquery colorbox 用于包含我的图像的画廊，问题有一些重复的图像，我正在尝试将其删除。我什至不知道从哪里开始寻找......如果有人能给我一个关于从哪里开始的提示，我会非常喜欢它（ps - 这是我的生日）

我认为这是我需要删除重复项的地方，但就像我说的我的 jquery 技能很糟糕

```
// Preloads images within a rel group
                if (settings.preloading) {
                    preload = [
                        getIndex(-1),
                        getIndex(1)
                    ];
                    while (i = $related[preload.pop()]) {
                        src = $.data(i, colorbox).href || i.href;
                        if ($.isFunction(src)) {
                            src = src.call(i);
                        }
                        if (isImage(src)) {
                            img = new Image();
                            img.src = src;
                        }

                    }
                } 
```

这也是我正在使用的文件的链接......希望这会有所帮助

[http://www.taranmarlowjewelry.com/wp-content/plugins/jquery-colorbox/js/jquery.colorbox.js?ver=1.3.19](http://www.taranmarlowjewelry.com/wp-content/plugins/jquery-colorbox/js/jquery.colorbox.js?ver=1.3.19)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-20T05:33:03.553

查看您的网站后，我遇到了与颜色框相同的问题...这将起作用

```
jQuery('document').ready(function($){
$(".wpcart_gallery a:first").removeClass("cboxElement");
jQuery(".wpcart_gallery img").click(function($){
jQuery(".wpcart_gallery a").addClass('cboxElement');
jQuery(this).closest('a').removeClass('cboxElement');
});
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-08T15:49:58.790

你可以使用这个 jQuery 代码来达到这个目的：

```
var arrayImgsColorbox = new Array();

$('.cboxElement').each(function(i, obj){
    if($.inArray($(obj).attr('href'), arrayImgsColorbox ) > -1)
        $(obj).removeClass('cboxElement');
    else
        arrayImgsColorbox[i] = $(obj).attr('href');
}); 
```

# postscript - 如何在 PostScript 中将字符串拆分为数组

> ID：12325634
> 
> 赞同：5
> 
> 时间：2012-09-07T21:28:05.937
> 
> 标签：postscript

按给定字符将字符串拆分为数组的最简单方法是什么？例如，通过空间分割来制作一个单词数组；甚至制作一个包含字符串所有字符的数组。

我能想到的唯一方法是`search`在循环中使用。由于所有语言都有用于此目的的功能，因此恐怕我缺少`PostScript`这样做的功能。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-23T16:22:35.053

```
%!

%(string) (delimiter)  split  [(s)(t)(r)(i)(n)(g)]
/split {              % str del
    [ 3 1 roll        % [ str del
    {                 % [ ... str del
        search {      % [ ... post match pre
            3 1 roll   % [ ... pre post match  %ie. [ ... pre str' del
        }{            % [ ... str
            exit       % [ ... str  %% break-from-loop
        }ifelse
    }loop             % [ ...
    ]                 % [ ... ]
} def

(string of words separated by spaces)( )split ==
%-> [(string) (of) (words) (separated) (by) (spaces)]

(string.of.words.separated.by.dots)(.)split ==
%-> [(string) (of) (words) (separated) (by) (dots)] 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-08T03:11:28.457

您与`search`操作员的合作是正确的。它的目的是执行文本字符串搜索和匹配。以下是[PostScript 语言参考手册](http://www-cdf.fnal.gov/offline/PostScript/PLRM2.pdf)`search`中的运算符摘要：

```
search   string seek search post match pre true (if found)  
         string false (if not found)  

         looks for the first occurrence of the string seek within string and  
         returns results of this search on the operand stack. The topmost   
         result is a boolean that indicates if the search succeeded.  

         If search finds a subsequence of string whose elements are equal   
         to the elements of seek, it splits string into three segments:   
         pre, the portion of string preceding the match; match, the portion  
         of string that matches seek; and post, the remainder of string. It  
         then pushes the string objects post, match, and pre on the operand   
         stack, followed by the boolean true. All three of these strings are  
         substrings sharing intervals of the value of the original string.  

         If search does not find a match, it pushes the original string  
         and the boolean false.  

         Example:  

             (abbc) (ab) search ==> (bc) (ab) ( ) true  
             (abbc) (bb) search ==> (c) (bb) (a) true  
             (abbc) (bc) search ==> () (bc) (ab) true  
             (abbc) (B) search ==> (abbc) false 
```

# jquery - 连接事件时如何添加回调函数？

> ID：12325636
> 
> 赞同：1
> 
> 时间：2012-09-07T21:28:13.737
> 
> 标签：jquery

我有一个`wireEvents`将 javascript 与表单事件绑定的函数。例如，

```
$(document).on('click', '#cancelEdit', cancelEdit); 
```

我这样做是因为该`#cancelEdit`按钮是稍后从`jsRender`模板中添加的。它工作正常。单击按钮时，`cancelEdit`将调用函数。

```
var cancelEdit = function (event) {
        event.preventDefault();
        ...
    }; 
```

但是现在我想像这样添加一个回调函数`cancelEdit`；

```
var cancelEdit = function (event, callback) {
        event.preventDefault();
        ...
    }; 
```

我应该如何更新事件连线语句？像这样？

```
$(document).on('click', '#cancelEdit', cancelEdit('click', cancelEditCallBack)); 
```

我不能让它工作。请帮忙。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T21:31:40.607

您用函数调用交换了函数引用。您现在应该将回调包装在第二个定义中：

```
$(document).on('click', '#cancelEdit', function() {cancelEdit('click', cancelEditCallBack) }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T21:33:28.630

您可以使用 data 参数将其他参数传递给回调。

```
$(document).on('click', '#cancelEdit', {cancelEditCallBack: cancelEditCallBack}, cancelEdit);

var cancelEdit = function (event) {
    event.preventDefault();
    event.data.cancelEditCallBack();
    ...
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T21:33:38.613

为什么不直接触发您可以添加事件侦听器的自定义事件呢？

```
var cancelEdit = function (event) {
    event.preventDefault();
    $(event.currentTarget).trigger("mycustomevent")
};

$(document).on("mycustomevent", "#cancelEdit", function (e) {
    // this is your callback
}) 
```

# c# - 派生类中的 C#“重命名”属性

> ID：12325637
> 
> 赞同：11
> 
> 时间：2012-09-07T21:28:17.260
> 
> 标签：c#, properties, alias, derived-class, base-class

当你读到这篇文章时，你会非常想给出这样的建议：“这是一个坏主意，原因如下......”

忍受我。我知道还有其他方法可以解决这个问题。这个问题应该被认为是琐事。

假设您有一个“交易”类，它具有所有交易共同的属性，例如发票、采购订单和销售收据。

让我们以交易“金额”为例，它是给定交易最重要的货币金额。

```
public class Transaction
{
    public double Amount { get; set; }

    public TxnTypeEnum TransactionType { get; set; }
} 
```

此金额在派生类型中可能具有更具体的名称……至少在现实世界中。例如，以下值实际上都是相同的：

*   交易 - 金额
*   发票 - 小计
*   采购订单 - 总计
*   销售收据 - 金额

所以现在我想要一个派生类“发票”，它有一个小计而不是一般命名的金额。理想情况下，以下两种情况都是正确的：

1.  在 Transaction 的实例中，Amount 属性将是可见的。
2.  在 Invoice 的实例中，Amount 属性将被隐藏，但 Subtotal 属性将在内部引用它。

发票长这样：

```
public class Invoice : Transaction
{
    new private double? Amount
    {
        get
        {
            return base.Amount;
        }
        set
        {
            base.Amount = value;
        }
    }

    // This property should hide the generic property "Amount" on Transaction
    public double? SubTotal
    {
        get
        {
            return Amount;
        }
        set
        {
            Amount = value;
        }
    }

    public double RemainingBalance { get; set; }
} 
```

但当然 Transaction.Amount 在任何 Invoice 实例上仍然可见。

谢谢参观！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-07T22:21:42.913

感谢所有的帮助。

好的，当然，当派生类是基实例时，您不能“隐藏”基类上的公共属性。在我大脑深处的某个地方，我已经知道这一点。嗬！

通过使用名为 TransactionBase 的第三个类，我最终让语法糖按照我想要的方式为消费者提供服务。此类是抽象的，包含所有交易（如货币、汇率、创建/修改的日期和时间、交易日期等）存在的共享的、非别名的东西……除了诸如金额之类的别名之外。

在这里，我只显示有问题的 Amount 属性：

```
public abstract class TransactionBase
{
    protected virtual double Amount { get; set; }
} 
```

然后事务看起来像这样：

```
public class Transaction : TransactionBase
{
    public new double Amount 
    { 
        get
        {
            return base.Amount;
        }
        set
        {
            base.Amount = value;
        }
    }
} 
```

和发票：

```
public class Invoice : TransactionBase
{
    public double SubTotal
    {
        get
        {
            return Amount;
        }
        set
        {
            Amount = value;
        }
    }
} 
```

并且访问按我想要的方式工作：

```
var transaction = new Transaction();

// This line works fine:
var transactionAmount = transaction.Amount;

var invoice = new Invoice();

// This line works fine:
var invoiceSubtotal = invoice.SubTotal;

// This line won't compile.
// Error: TransactionBase.Amount is inaccessible due to its protection level.
var invoiceAmount = invoice.Amount; 
```

所以我最初的问题的答案是，“不”你不能隐藏公共继承成员。上面的解决方案通过直接在派生类型中访问受保护的成员来伪造它，但它仍然有点糟糕。打字太多。

当然，既然我摆弄了所有这些，我看到一个更好的解决方案完全抛弃了受保护的成员并节省了我一些打字时间。顺便说一句，是的，我很尴尬，我没有立即跳到这个解决方案。

**编辑：**实际上，我回答中的第一个方法可能会更好。对于第二个，从交易转换为发票时，我会丢失“金额”或“小计”。

```
public abstract class TransactionBase
{
    // There are some shared properties here.
}

public class Transaction : TransactionBase
{
    public double Amount { get; set; }
}

public class Invoice : TransactionBase
{
    public double SubTotal { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T21:35:48.580

简而言之，你不能这样做。

总而言之，您可以通过对接口进行编码来模拟这一点！

```
public class Transaction
{
    public double Amount { get; set; }
}
public interface IInvoice
{
    public double? SubTotal { get; set; }
}
public class Invoice : Transaction, IInvoice
{
    public double? SubTotal
    {
        get
        {
            return Amount;
        }
        set
        {
            Amount = value ?? 0.0f;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T21:39:24.007

您正在寻找的确切行为在语法上没有意义。如果**Invoice**继承了**Transaction**，那么它*就是一种*事务，编译器要求它继承它的所有属性。

我认为您正在寻找的一般行为是封装，它可以通过接口来完成。

```
public interface IInvoice
{
    double? Amount { get; set; }
}

public interface ITransaction
{
    double? SubTotal { get; set; }
} 
```

要求代码的使用者使用这些接口，然后对他们隐藏实现细节。

* * *

所以现在，这些类可以按照你想要的方式运行。 **SubTotal对***类*(Invoice)仍然可见，但对*界面*(IInvoice) 是隐藏的。

```
public class Transaction : ITransaction
{
    public double? SubTotal { get; set; }
}

public class Invoice : IInvoice
{
    public double? Amount
    {
        get { return base.SubTotal; }
        set { base.SubTotal = value; }
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-07T21:41:57.453

在这种情况下，我建议使用组合而不是继承。主要原因是 Transaction 的基本实现似乎永远不会以继承的方式使用。您可以将交易隐藏为 Invoice 的受保护或私有成员，并使用 Invoice 的公共属性公开/操作它。

一个这样的示例可能如下所示：

```
public class Invoice
{
        private readonly Transaction _transaction; 
        public Invoice():this(new Transaction())
        {
        }
        public Invoice(Transaction transaction)
        {
            _transaction = transaction;
        }

        // This property should hide the generic property "Amount" on Transaction
        public double? SubTotal
        {
            get
            {
                return _transaction.Amount;
            }
            set
            {
                _transaction.Amount = value ?? 0.0f;
            }
        }

        public double RemainingBalance { get; set; }
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-07T22:10:09.510

使用隐式转换运算符怎么样？

```
class Program
{
    static void Main(string[] args)
    {
        var transaction = new Transaction();
        var transactionAmount = transaction.Amount;

        var invoice = new Invoice();
        var invoiceSubTotal = invoice.SubTotal;

        Transaction fromInvoiceToTrans = invoice;
        var fromInvoiceToTransAmount = fromInvoiceToTrans.Amount;

    }
}

public class Transaction
{
    public decimal Amount {get; set;}
}

public class Invoice
{
    public decimal SubTotal
    {
        get;
        set;
    }

    public static implicit operator Transaction(Invoice invoice)
    {
        return new Transaction
        {
            Amount = invoice.SubTotal
        };
    }
} 
```

# iphone - 适用于 iOS 的 Tesseract 3.02？

> ID：12325643
> 
> 赞同：1
> 
> 时间：2012-09-07T21:28:30.147
> 
> 标签：iphone, ios, xcode, ocr, tesseract

我做了一些谷歌搜索，以使我的 iOS 应用程序更快地进行 OCR（我使用 tesseract 3.01）。（我从这里下载了它[http://tinsuke.wordpress.com/2011/11/01/how-to-compile-and-use-tesseract-3-01-on-ios-sdk-5/](http://tinsuke.wordpress.com/2011/11/01/how-to-compile-and-use-tesseract-3-01-on-ios-sdk-5/)）我遇到了一些链接（

> [如何让 iOS 上的 tesseract 更快？](https://stackoverflow.com/questions/11630640/how-can-i-make-tesseract-on-ios-faster)

）这里说使用 tesseract 3.02 进行 OCR。但我找不到它的链接或svn。

有没有人在他/她的 iOS 应用程序上使用 tesseract 3.02？如果有示例项目，那就太好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T17:33:36.390

SVN url 是[Tesseract SVN](http://tesseract-ocr.googlecode.com/svn/trunk/)

如果您使用 SVN 软件，您将下载可用的最新版本，但您必须为 iOS 编译

顺便说一句，我测试了 suzuki 脚本，它适用于最新版本，但它不包含一些新的 .h 文件（6 或 7），因此您需要在 tesseract folfer 中搜索它们（它们在 ccutil和 ccmain 文件夹）

编辑：我将我的编译上传到 github，它是 phonegap 的插件，但您可以选择依赖文件夹并在任何常规 iOS 项目中使用它。

[OCR 插件](http://goo.gl/9To23)

# java - 将 iText 列表项目符号更改为黑点

> ID：12325645
> 
> 赞同：4
> 
> 时间：2012-09-07T21:28:55.170
> 
> 标签：java, list, itext

我想使用 iText 创建一个无序列表。但是，我不希望默认的项目符号是破折号，而是一个黑点（看你的声誉标记你的奖牌的地方 - 类似的东西，但是黑色）。我不知道 iText 是否已经实现了这个（我找不到），还是我必须手动完成。

问题是，如果我必须手动操作，因为键盘上没有黑点，我必须将图像作为 ListSymbol 插入，但该`setListSymbol`方法只接受`Chunk`或`String`作为参数...

我该怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-08T08:41:21.307

答案在你自己的问题中。您可以使用 Chunk 作为列表符号。如果您想使用自定义图像（例如，可视化黑点的图像），您可以将这样的图像包装在 Chunk 中。如果您不想自己绘制这样的图像，您可以寻找一种字体（Webdings？Wingdings？）并使用带有该字体字符的块。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-12-15T10:59:56.870

这是一个例子，这个 char 是 HTML 中无序列表的项目符号。

```
 List list = new List(List.UNORDERED);
 list.setListSymbol("•");

 list.add(new ListItem("list 1");
 list.add(new ListItem("list 2"));
 list.add(new ListItem("list 3")); 
```

# android - 仅使用 android 中的后退按钮返回指定屏幕

> ID：12325647
> 
> 赞同：1
> 
> 时间：2012-09-07T21:28:55.953
> 
> 标签：android

具有 screen1、screen2、screen3、screen4 的应用程序

用户可以从剩余的 3 个屏幕转到第 3 个屏幕

如果用户单击 screen3 中的后退按钮

那么他应该被重定向到screen1（如果他来自screen1）或screen2（如果他来自screen2）

但不应该去screen4

我在screen3中尝试了finish（）

功能缺失

我该如何解决这个问题，请帮助我提前谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T22:09:40.433

您需要查看 Intent 标志。可以使用 Intent.FLAG_ACTIVITY_NO_HISTORY 以便您无法返回活动。

> 公共静态最终 int FLAG_ACTIVITY_NO_HISTORY
> 
> 自：API 级别 1
> 
> 如果设置，则新活动不会保留在历史堆栈中。一旦用户离开它，活动就完成了。这也可以使用 noHistory 属性进行设置。

# php - 使用关系 AR 检索“OR”条件

> ID：12325651
> 
> 赞同：4
> 
> 时间：2012-09-07T21:29:24.363
> 
> 标签：php, activerecord, yii, relational-database

我正在使用 Yii 框架，并且在构建朋友/连接样式系统时遇到了一个问题。我有一个标准的用户表并存储朋友我有一个具有以下布局的朋友表（已设置适当的 FK 等）：

```
id | userId | friendId | and some other fields... 
```

由于“朋友”是相互的——因此，如果用户 A 是用户 B 的朋友，则用户 B 是用户 A 的朋友——因此每个“友谊”只有一个条目。

我想做的是使用 Yii 的关系查询最终返回属于朋友的项目。目前我在用户模型中有以下关系......

```
'friends' => array(self::HAS_MANY, 'UserFriend', 'userId'), 
```

但是，如果用户 ID 存在于 userId 字段中，则仅返回“朋友”。如果用户的 ID 在friendId 字段中，则无法识别“友谊”。

有没有办法使用“或”进行查询 - 例如：如果用户 ID == userId OR 用户 ID ==friendId 然后返回该条目？

另外，有没有办法让 Yii 返回另一个 ID，所以如果用户 ID == userId 它将返回friendId，否则如果用户 ID ==friendId 它将返回 userId？

我最终试图做类似的事情：

```
$userModel = User::model()->findByPk(Yii::app()->user->id); // user's model
$userFriends = $userModel->with(items)->friends; // return friends with their items 
```

希望我没有混淆太多！抱歉解释不佳

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T21:58:52.430

按照[此处](http://www.yiiframework.com/doc/guide/1.1/en/database.dao)创建数据库命令对象的说明进行操作，然后您可以使用以下`OR`条件进行查询：

```
$command->where(array('OR', 'userID = :userID', 'userID = :friendID'), array(':userID' => $userID, ':friendID' => $friendID)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T06:03:34.770

你想得到你的应用程序当前用户的所有朋友吗？您可以使用 CDbCriteria 和方法 find()。像这样的东西：

```
$criteria = new CDbCriteria;
$criteria->addCondition('id = :userid');
$criteria->addCondition('friendid = :userid', 'OR'); // OR - the operator to join different conditions. Defaults to 'AND'.
$criteria->params = array(':userid' => Yii::app()->user->id);
$userFriends = UserFriend::model()->find($criteria); 
```

但我不确定你`User`和`UserFriend`模型的结构和相互关系。你有什么关系`UserFriend`吗`User`？如果是这样，那么您可以在上面的代码之后使用类似的东西`$userFriends->user0`。

[CDbCriteria 详细信息](http://www.yiiframework.com/doc/api/1.1/CDbCriteria)

[find() 方法详细信息](http://www.yiiframework.com/doc/api/1.1/CActiveRecord#find-detail)

# python - 将变量的输出显示到小数点后 2 位以上

> ID：12325660
> 
> 赞同：2
> 
> 时间：2012-09-07T21:30:12.103
> 
> 标签：python, floating-point, precision

我正在尝试将我的加法输出显示到小数点后 2 位以上。

```
import time
import random

max_number = 1000000.0
random_time = random.randrange(1, max_number-1) / max_number
range_key = int(time.time()) + random_time

range_key
>>> 1347053222.790799

print range_key
>>> 1347053222.79 
```

如何打印完整号码？如果这是一个函数，我怎么能返回完整的数字？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T21:33:32.303

将浮点数转换为字符串时（打印会自动执行此操作），python 将其限制为仅 12 个最高有效数字，加上小数点。

从函数返回数字时，您总是得到完整的精度。

要打印更多数字（如果可用），请使用[字符串格式](http://docs.python.org/library/stdtypes.html#string-formatting)：

```
print '%f' % range_key  # prints 1347053958.526874 
```

默认为 6 位，但您可以指定更高的精度：

```
print '%.10f' % range_key  # prints 1347053958.5268740654 
```

或者，python 也提供了一种更新的[字符串格式化方法](http://docs.python.org/library/string.html#formatstrings)：

```
print '{0:.10f}'.format(range_key)  # prints 1347053958.5268740654 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T21:33:22.687

你已经有了完整的号码。在输出上使用自定义格式说明符。

```
>>> print '%.15f' % range_key
1347053222.790798902511597 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T22:02:13.070

您会发现，如果您对要打印的位数进行硬编码，有时您会得到太少或更糟，但会超出浮点精度并在最后得到无意义的数字。标准浮点数的精度只有大约 15 位。你可以用这个简单的公式找出小数点右边有多少位数字：

```
digits_right = 14 - int(math.log10(value)) 
```

使用它，您可以创建适当的`%f`格式：

```
fmt = '%%0.%df' % max(0, digits_right) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T22:02:58.483

```
>>> f = 1/7.
>>> repr(f)
'0.14285714285714285'
>>> str(f)
'0.142857142857'
>>> f
0.14285714285714285
>>> print f
0.142857142857
>>> '%.15f' % f
'0.142857142857143' 
```

# php - PHP 导出为 CSV

> ID：12325663
> 
> 赞同：1
> 
> 时间：2012-09-07T21:30:48.290
> 
> 标签：php, mysql, arrays, csv, export

> **可能重复：**
> [PHP 将 Excel 导出到特定路径？](https://stackoverflow.com/questions/12305204/php-export-excel-to-specific-path)

我不太熟悉将 PHP 导出到 excel 或 csv，但我将 PHP MySQL 用于本地销售点。根据下面的代码，这确实有效..但不是它应该的方式！所有记录都在 csv 文件中放置为 1 行，我该如何解决？另外，我将如何停止覆盖同一个文件...我的意思是当我单击按钮导出 csv 时，它应该检查是否存在现有的 csv 文件，如果有 - 创建新文件！

谢谢你

```
require_once('connect_db.php');

$items_array = array();

$result = mysql_query("SELECT * FROM sold_items");

while($row = mysql_fetch_array($result))
{
    $items_array[] = $row['item_no'];

    $items_array[] = $row['qty'];
}

$f = fopen('C:/mycsv.csv', 'w');
fputcsv($f, $items_array);
fclose($f); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T21:36:12.993

首先

```
$items_array[] = array($row['item_no'], $row['qty']); 
```

其次，使用变量来存储文件名。

```
$filename = $name = "myscsv";
$index = 1;
while(file_exists($filename.".csv")) {
  $filename = $name.$index;
  $index++;
} 
```

现在你可以保存它了；）

```
$f = fopen("C:/{$filename}.csv", 'w'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T21:40:45.957

fputcsv 似乎只写入一行/记录，并在其输出中包含一个行/记录终止符。您需要为报告的每一行调用 fputcsv。

dbf 的顺序文件命名解决方案在许多情况下都非常有效。就个人而言，我发现附加时间戳很有帮助，因为当存在现有文件的集合时它需要更少的 IO。此外，即使在修改/复制/触摸报告的情况下，也无需打开每个报告就可以知道报告的来源。

次要细节：将查询调整为您使用的列。

```
<?php

require_once('connect_db.php');

$result = mysql_query("SELECT item_no, qty FROM sold_items");

$timestamp = date('Ymd-His'); 

$f = fopen("C:/mycsv-{$timestamp}.csv", 'w');

// Headers    
fputcsv($f, array('Item No', 'Qty'));

while($row = mysql_fetch_row($result))
{
    fputcsv($f, $row);
}
fclose($f); 
```

# ruby-on-rails - 如何使用 HTTPParty 解析 wunderground api url 中的变量？

> ID：12325665
> 
> 赞同：0
> 
> 时间：2012-09-07T21:30:55.860
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

使用 wunderground API 在我的城市页面上显示天气预报。

city_controller.rb

```
def show

        @region = Region.find(params[:region_id])
        @city = City.find(params[:id])

        @weather_lookup = WeatherLookup.new

end 
```

天气查找.rb

```
class WeatherLookup 
    attr_accessor :temperature, :icon, :condition

    def fetch_weather
      HTTParty.get("http://api.wunderground.com/api/a8135a01b8230bfb/hourly10day/lang:NL/q/IT/#{@city.name}.xml")
     end

    def initialize
      weather_hash = fetch_weather
    end

    def assign_values(weather_hash)
      hourly_forecast_response = weather_hash.parsed_response['response']['hourly_forecast']['forecast'].first
      self.temperature = hourly_forecast_response['temp']['metric']
      self.condition = hourly_forecast_response['condition']
      self.icon = hourly_forecast_response['icon_url']

   end

   def initialize
    weather_hash = fetch_weather
    assign_values(weather_hash)
   end

end 
```

show.html.haml（城市）

```
= @weather_lookup.temperature 
= @weather_lookup.condition.downcase 
= image_tag @weather_lookup.icon 
```

为了获取正确的天气预报，我认为我可以像在示例中那样将@city 变量放在 HTTParty.get URL 中，但是我收到错误消息 undefined method `name'

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-08T04:40:57.707

如果您需要 WeatherLookup 中的城市，则需要将其传递给初始化程序。实例变量只绑定到它们各自的视图。

```
@weather_lookup = WeatherLookup.new(@city) 
```

* * *

```
attr_accessor :city # optional

def initialize(city)
  @city = city
  weather_hash = fetch_weather
end 
```

# c# - DataGridViewComboBox 下拉列表不显示任何可供选择的项目，下拉不起作用

> ID：12325668
> 
> 赞同：1
> 
> 时间：2012-09-07T21:31:25.780
> 
> 标签：c#, datagridviewcombobox

在一个`DataGrid`，我有一个`DataGridViewComboBoxColumn`。我在代码中分配了 a`DataTable`作为 a `DataSource`、 items 、 value 成员和 display 成员，但是`ComboBox`当我运行程序时显示为空。下拉菜单根本不起作用。

但是，它确实正确分配了值，这表明`DataSource`已正确设置。即，当我分配 value 时，它​​会获取正确的显示成员。

我已经根据其他相关帖子尝试过的事情 - 使用`List`而不是`DataTable`[ 工作原理完全相同] - 使用`enum`而不是[ 工作正常 ] -通过 a - 检查“只读” = false 在所有行、列、单元格上`DataTable`使用该对象. - 作为预防措施，为特定列分配“只读”= false on function 并设置if it is 。`DataTable``BindingSource``cell_enter``DataSource``null`

当我`DataGridViewComboBoxCell`在调试中观看 [or column] 时，我看到项目已被填充。我真的没有想法，任何帮助表示赞赏。如果有帮助，我已经粘贴了一些代码片段

```
DataTable data = new DataTable();
data.Columns.Add(new DataColumn("Value", typeof(string)));
data.Columns.Add(new DataColumn("Description", typeof(string)));

data.Rows.Add("en_US", "English-US");
data.Rows.Add("de", "german-Germany");

(patientGrid.Columns[5] as DataGridViewComboBoxColumn).Items.Add("English-US");
(patientGrid.Columns[5] as DataGridViewComboBoxColumn).Items.Add("german-Germany");
(patientGrid.Columns[5] as DataGridViewComboBoxColumn).ValueType = typeof(string);

(patientGrid.Columns[5] as DataGridViewComboBoxColumn).DataSource = data;
(patientGrid.Columns[5] as DataGridViewComboBoxColumn).ValueMember = "Value";
(patientGrid.Columns[5] as DataGridViewComboBoxColumn).DisplayMember = "Description";

//setting value 
(patientGrid.Rows[rowIndex].Cells[5] as DataGridViewComboBoxCell).Value = 
    clientLanguagePreference[cmbClients.SelectedItem.ToString()]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T16:00:21.340

Add: patientGrid.Rows[rowIndex].Cells[5].ReadOnly = false;

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-22T10:20:11.957

在 Designer 中单击小箭头（右上角），然后单击编辑列。选择组合框并将只读字段设置为 false

# ios - NSnotification 中心不工作 iOS

> ID：12325673
> 
> 赞同：0
> 
> 时间：2012-09-07T21:31:45.143
> 
> 标签：ios, search, uiview, nsnotificationcenter

上周我问了这个问题：[刷新整个 iOS 应用](https://stackoverflow.com/questions/12239260/refresh-the-entire-ios-app) @Jim 建议我使用通知中心。我无法弄清楚如何处理通知，我被告知要问另一个问题，我尝试了整整一周自己解决问题，所以就这样吧。

我有一个包含多个子视图的视图。其中一个子视图是一个搜索栏（不是表格视图，只是一个自定义文本框），用户可以在这里搜索一个新人，整个应用程序将逐屏更新。

当用户点击搜索子视图中的 GO 按钮时，我会调用服务器以获取所有数据。之后我发布此通知：

```
 [self makeServerCalls];

[[NSNotificationCenter defaultCenter] postNotificationName:@"New data" object:Nil]; 
```

现在在我的父视图控制器的初始化中，我有一个监听器

```
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(viewDidLoad) name:@"New data" object:nil]; 
```

我知道这很可能是错误的，所以有人可以向我解释如何在我的情况下正确使用通知吗？或者，如果有更好的方法来做我想做的事。

感谢你给与我的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T23:18:36.647

当您发布通知时，将通知所有注册观察者。他们通过向他们发送一条消息来获得通知……选择器标识的消息。如评论中所述，您**不应**使用`viewDidLoad`. 考虑这个...

```
- (void)newDataNotification:(NSNotification *notification) {
    // Do whatever you want to do when new data has arrived.
} 
```

在一些早期代码中（viewDidLoad 是一个很好的候选）：

```
[[NSNotificationCenter defaultCenter]
    addObserver:self
       selector:@selector(newDataNotification:)
           name:@"New data"
         object:nil]; 
```

这是一个可怕的名字，顺便说一句。那好吧。此注册表明，只要使用任何对象的名称发布通知，您的`self`对象就会收到`newDataNotification:`带有对象的消息。如果要限制要从哪个对象接收消息，请提供非零值。`NSNotification``"New data"`

现在，当您发送通知时，您可以简单地执行此操作，就像您在代码中所做的那样：

```
[[NSNotificationCenter defaultCenter] postNotificationName:@"New data" object:nil]; 
```

这将确保（出于实际目的）`[self newDataNotification:notification]`被调用。现在，您也可以连同通知一起发送数据。因此，假设新数据由 表示`newDataObject`。由于您接受来自任何对象的通知，因此您可以：

```
[[NSNotificationCenter defaultCenter]
    postNotificationName:@"New data"
                  object:newDataObject]; 
```

然后在你的处理程序中：

```
- (void)newDataNotification:(NSNotification *notification) {
    // Do whatever you want to do when new data has arrived.
    // The new data is stored in the notification object
    NewData *newDataObject = notification.object;
} 
```

或者，您可以传递用户信息字典中的数据。

```
[[NSNotificationCenter defaultCenter]
    postNotificationName:@"New data"
                  object:nil
                userInfo:@{
                          someKey : someData,
                       anotherKey : moreData,
                          }]; 
```

然后，您的处理程序将如下所示...

```
- (void)newDataNotification:(NSNotification *notification) {
    // Do whatever you want to do when new data has arrived.
    // The new data is stored in the notification user info
    NSDictionary *newData = notification.userInfo;
} 
```

当然，您可以使用我更喜欢的块 API 来做同样的事情。

无论如何，请注意您必须移除您的观察者。如果你有一个`viewDidUnload`，你应该把它放在那里。此外，确保它也进入`dealloc`：

```
- (void)dealloc {
    // This will remove this object from all notifications
    [[NSNotificationCenter defaultCenter] removeObserver:self];
} 
```

# jquery - 将拇指分配给 fancybox 的 url（图片）

> ID：12325674
> 
> 赞同：1
> 
> 时间：2012-09-07T21:32:05.923
> 
> 标签：jquery, facebook, fancybox, share, thumbnails

这是在[“直接链接到任何幻想框”之后，但在地址栏中带有 URL](https://stackoverflow.com/questions/12320630/direct-link-to-any-fancybox-but-with-url-in-address-bar)。现在我设法为我的 fancybox 画廊的每张图片分配了一个唯一的 url，我想知道是否通过共享例如 image #1 url，它会产生正确的拇指，例如，在 Facebook 上。

我正在使用最新的 fancybox 和 jquery 版本。

这是Javascript：

```
 var thisHash = window.location.hash;
    $(document).ready(function() {

        $('.thumbs').fancybox({
            prevEffect : 'fade',
            nextEffect : 'fade',
            closeBtn  : true,
            arrows    : true,
            nextClick : true,
            padding : 15,
            helpers : {
                title : {
                    type : 'inside'
                },
                thumbs : {
                    width  : 80,
                    height : 80
                }
            },
            beforeShow: function () {
                var id = this.element.attr("id")
                if (id) {
                    window.location.hash = id;
                }
            },
            beforeClose: function() {
                window.location.hash = "";
            }
        });

        if(thisHash) {
            $(thisHash).trigger('click');
        }
    }); 
```

这是HTML：

```
<a class="thumbs" data-fancybox-group="group1" id="image1" href="http://freeimagesarchive.com/data/media/206/1_black.jpg"><img src="http://freeimagesarchive.com/data/media/206/1_black.jpg" /></a> 
```

基本上，使用此代码，当我打开图像时，网址将变为例如 www.mysite.com#image1

如果我复制该地址并将其粘贴到例如 Facebook 上，显然它不会给任何拇指分享。正确的拇指应该是[http://freeimagesarchive.com/data/media/206/1_black.jpg](http://freeimagesarchive.com/data/media/206/1_black.jpg)但这个想法不是分享图片链接，而是花式链接。

我希望我说清楚了，对不起英语。

有什么办法可以做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-08T01:50:16.927

如果您希望 Facebook 正确共享此图像，您需要为每个图像创建一个页面，并在其上使用正确的[Open Graph 元标记](http://ogp.me/)。这些必须要么在静态文件中硬编码，要么由服务器端脚本动态生成。这些页面将是您在 Facebook 上共享的 URL，因此它们的[解析器](https://developers.facebook.com/tools/debug)可以读取它们。

如果您希望最终用户看到 Fancybox 版本，当他们访问共享 URL 时，您可以使用 Javascript 代码重定向他们。

# php - php mail() 删除CC、BCC和安全

> ID：12325677
> 
> 赞同：0
> 
> 时间：2012-09-07T21:32:20.260
> 
> 标签：php, email

我是stackoverflow的新手，找不到我的问题的答案；如何在 php 中保护我的 mail() 代码以防止人们添加最终会导致大量邮件的密件抄送？当在我的网站中输入新评论时，我的网站使用 PHP mail() 服务向我发送电子邮件。防止人们篡改它的最佳方法是什么，例如删除密件抄送？到目前为止，我所拥有的是：

```
function mres($input){
if (get_magic_quotes_gpc()){
    $input = stripslashes($input);
}
return mysql_real_escape_string($input);
}
$name = strip_tags(mres($_POST['name']));
$comment = strip_tags(mres($_POST['comment']));

$to = 'myself@gmail.com';
$subject = 'Website - comment';
$body = 'A new comment has been entered on the website.'."\n\n"."$name".' said:         '."\n\n"."$comment";
mail($to,$subject,$body); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T21:46:10.763

我会看类似[http://mailgun.com/](http://mailgun.com/)

事实上，如果您只使用 mail()，您的邮件通常会成为人们的垃圾邮件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T21:48:59.237

假设此代码后跟：

```
mail($to, $subject, $body); 
```

然后它是安全的，如果过度杀伤 - 唯一`mail()`容易受到注入的参数是控制标头字段（`$to`，`$subject`和`$additional_headers`）的参数。`strip_tags`并且`mysql_real_escape_string`都是不必要的，后者会使撇号出现`\'`在您的电子邮件中。

如果没有对 的后续调用`mail()`，那么它是非常安全的，因为它什么都不做。:)

# actionscript-3 - 用于 Flash/ActionScript swf 创建的 IDE 工具

> ID：12325682
> 
> 赞同：2
> 
> 时间：2012-09-07T21:32:28.193
> 
> 标签：actionscript-3, ide

我不是 Flash/ActionScript 开发人员，但我需要在 Flash 中完成一项非常小的任务。我需要在 Flash 中显示用户音频输入电平。我发现我可以使用 ActionScript 来做到这一点（[根据 this](http://help.adobe.com/en_US/ActionScript/3.0_ProgrammingAS3/WS5b3ccc516d4fbf351e63e3d118a9b90204-7d0c.html)）。

我不知道我需要使用哪些工具来生成 SWF 文件。
任何帮助高度赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T21:37:00.563

您可以使用 Flash Pro IDE（例如 Flash CS6）、Flash Builder (Adobe) 或 FlashDevelop。还有一些类似 FDT 和 IntelliJ。

如果这对您来说是一个快速而肮脏的无/低预算方案，我会推荐 FlashDevelop。

如果速度是最重要的，而您没有时间学习，那么 Flash Pro CS~ 将是一个不错的选择。

如果您是一位经验丰富的编码人员并且会使用该工具，那么 Flash Builder（作为商业产品）是一个不错的选择。虽然 FlashDevelop 也是 Flash Builder 的一个很好的开源替代品。

他们的网站上都有关于如何设置环境和开始创建 swf 的教程。

[http://www.flashdevelop.org/](http://www.flashdevelop.org/)

[http://www.adobe.com/products/flash-builder.html](http://www.adobe.com/products/flash-builder.html)

[http://www.adobe.com/products/flash.html](http://www.adobe.com/products/flash.html)

[http://fdt.powerflasher.com/](http://fdt.powerflasher.com/)

[http://www.jetbrains.com/idea/](http://www.jetbrains.com/idea/)

# iphone - 开发滑动和视图更改 iPhone 应用程序

> ID：12325687
> 
> 赞同：1
> 
> 时间：2012-09-07T21:32:49.480
> 
> 标签：iphone, objective-c, ios, cocoa-touch

我正在尝试开发一个视图与 groupon 应用程序非常匹配的应用程序。用户应该能够在屏幕上滑动，整个屏幕随着顶部指针指向不同的工具栏实体而改变。

任何关于如何去做的指针？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T22:23:31.220

查看Apple Guides中的[UIScrollView 参考](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIScrollView_Class/Reference/UIScrollView.html)和[PageControl 参考](http://developer.apple.com/library/ios/#samplecode/PageControl/Introduction/Intro.html)

希望它有帮助， **马里奥**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T22:22:43.577

看起来像 pagecontrol+scrollerview 复杂的部分是当您以不同的速度更改页面时使工具栏元素移动

# java - 解析 XML 时出错（一些烦人的问题，初学者）

> ID：12325695
> 
> 赞同：1
> 
> 时间：2012-09-07T21:33:26.600
> 
> 标签：java, android, google-maps, android-mapview

我一直在查看有关该错误的先前主题，他们说我应该首先列出 android:xmlns 属性，这就是我所做的，但我仍然面临该错误，不知道为什么。（如果我从工作中复制另一个布局并不重要）。无论如何，这是XML：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent" >

<com.google.android.maps.MapView
xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/mapview"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:clickable="true"
android:apiKey="*CENSORED*"/>

</RelativeLayout> 
```

这里可能是什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T21:47:49.200

```
<?xml version="1.0" encoding="utf-8"?> 
<RelativeLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:orientation="vertical"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent">

        <com.google.android.maps.MapView
            xmlns:android="http://schemas.android.com/apk/res/android"
            android:id="@+id/mapview"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:clickable="true"    
            android:layout_above="@+id/ll"
            android:apiKey="*******"    />           
</RelativeLayout> 
```

这是我的 xml，它适用于我。我认为您缺少第一行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T08:03:56.243

解决方案是：必须重置我的 adb ..

# java - JAVA RMI 客户端

> ID：12325702
> 
> 赞同：1
> 
> 时间：2012-09-07T21:33:46.317
> 
> 标签：java, rmi

当我在 Eclipse 中点击“运行”按钮时，我的 RMI 应用程序客户端无法正常工作。它抛出以下异常：

```
java.rmi.UnmarshalException: error unmarshalling return; nested exception is: 
java.net.MalformedURLException: unknown protocol: rsrc
at sun.rmi.registry.RegistryImpl_Stub.lookup(Unknown Source)
at java.rmi.Naming.lookup(Unknown Source)
... 
```

我在互联网上查看，人们在从 Eclipse 生成 JAR 时似乎遇到了这个问题。但是我的（ant-built）jar 工作正常，只是在 Eclipse 内部它没有按应有的方式工作！

```
 InterfaceRemota objetoRemoto = (InterfaceRemota)Naming.lookup("//localhost:1097/ObjetoRemoto"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T17:54:20.987

我找到了一个解决方案，在启动 rmiregistry 服务器之前，我必须使用“set CLASSPATH =”清理 java 类路径

c: > 设置类路径=

c: > rmiregistry

# regex - 带有正则表达式的 Git 日志统计信息

> ID：12325703
> 
> 赞同：3
> 
> 时间：2012-09-07T21:33:50.667
> 
> 标签：regex, git, bash, git-log

我想在我的 git log 上做一些统计数据，以获得类似：

```
10 Daniel Schmidt
5  Peter
1  Klaus 
```

第一列是提交计数，第二列是提交者。我已经做到了这一点：

```
 git log --raw |
    grep "^Author: " |
    sort |
    uniq -c |
    sort -nr |
    less -FXRS 
```

有趣的部分是

```
 grep "^Author: " 
```

我想用一个很好的正则表达式进行修改以排除邮件地址。使用 Rubular 之类的[http://rubular.com/r/mEzP2hFjGb](http://rubular.com/r/mEzP2hFjGb)可以工作，但如果我将它插入 grep （或通过管道插入的另一个），它不会让我得到正确的输出。

附带问题：在保持这种管道命令样式的同时，是否有可能让计数和作者被其他东西隔开，然后是空格？我希望稍后在我们的专栏之间有一个更好的分隔符（也许还有一些颜色^^）

非常感谢你的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T21:45:21.347

谷歌`git-extras`。它有一个`git summary`这样做的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-08T02:08:09.873

`git shortlog -n -s`为您提供相同的数据。例如，在 git 存储库上（通过管道传送到 head 以获得更高的数字）：

```
$ git shortlog -n -s | head -4
 11129  Junio C Hamano
  1395  Shawn O. Pearce
  1103  Linus Torvalds
   896  Jeff King 
```

要获得不同的分隔符，您可以将其通过管道传输到`awk`：

```
$ git shortlog -n -s | awk 'BEGIN{OFS="|";} { $1=$1; print $0 }' | head -4
 11129|Junio|C|Hamano
  1395|Shawn|O.|Pearce
  1103|Linus|Torvalds
   896|Jeff|King 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T21:51:43.583

您可以使用 perl 单线获得 pcre 的全部功能（应该与您使用 Rebular 的实验相匹配）：

```
perl -ane 'print if /^Author: /' 
```

只需根据需要扩展该模式。

要重新格式化，您可以使用`awk`（例如`awk '{printf "%5d\t%s", $1, $2}'`）

# android - 我无法设置标签的背景颜色？

> ID：12325704
> 
> 赞同：0
> 
> 时间：2012-09-07T21:33:50.533
> 
> 标签：android, xml, android-activity, tabs

我需要一些帮助来了解我缺少什么或做错了什么。我的目标是在选中时将标签的背景颜色设置为白色，在未选中时将其设置为黑色。但首先我只是想将背景颜色设置为红色，作为代码测试：**getTabHost().getTabWidget().getChildAt(0).setBackgroundColor(Color.parseColor("#4E4E9C"));** . 我下面的代码甚至在应用程序启动之前就崩溃了，原因如下：二进制 XML 文件第 19 行：您必须提供 layout_width 属性。我不知道从哪里开始？我错过了什么？这与宽度属性有什么关系？/问候

```
 public class Tabs extends TabActivity
   {
private static final String TAG = "TabHostActivity";
private boolean mHaveShownStartDialog = false;

@Override
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.tab_host);
    setOnCreatePreferences();

    try
    {

        addTab(getString(R.string.Search), R.drawable.searchtab, SearchTask.class );
        addTab(getString(R.string.Bookmarks), R.drawable.blackheart1, Bookmarks.class );
        addTab(getString(R.string.Latest), R.drawable.clock3, Latest.class );
        addTab(getString(R.string.QAndA), R.drawable.pen, LatestFeedback.class );

        getTabHost().setCurrentTab( 0 );
        getTabHost().getTabWidget().getChildAt(0).setBackgroundColor(Color.parseColor("#4E4E9C"));

    }
    catch(Exception e)
    {
        Log.e(TAG, e.getMessage());
    }
}

private void addTab( CharSequence label, int drawable_id, Class<?> c ) 
{
    TabHost.TabSpec spec = getTabHost().newTabSpec("tab" + " "+ label);

    spec.setIndicator( label, getResources().getDrawable( drawable_id ) );

    spec.setContent( new Intent().setClass( this, c ) );

    getTabHost().addTab( spec );
}

@Override
public boolean onCreateOptionsMenu(Menu menu) 
{
    MenuInflater inflater = getMenuInflater();
    inflater.inflate( R.menu.tabs_menu, menu );
    return true;
}

@Override
public boolean onOptionsItemSelected(MenuItem item) 
{
    switch ( item.getItemId() ) 
    {
        case R.id.tabs_menu_options_item:
            //startActivityForResult( new Intent( this, Options.class ) , 0 ); 
            return true;

        default: return super.onOptionsItemSelected(item);
    }
}

//private void initTabsAppearance(TabWidget tabWidget){
//  
//  for(int i=0; i<tabWidget.getChildCount(); i++)
//      tabWidget.getChildAt(i).setBackgroundResource(R.drawable.searchtab);
//  
//}

private void setOnCreatePreferences()
{
    SharedPreferences preferences = PreferenceManager.getDefaultSharedPreferences( getBaseContext() );

    boolean mUseStartDialog = preferences.getBoolean( "use_dialog", true );
    if( mUseStartDialog ) 
    {
        if( !mHaveShownStartDialog )
        {
            mHaveShownStartDialog = true;
            startActivity( new Intent( this, WelcomeDialog.class ) );
        }
      }
    }

    } 
```

我的 tab_host.xml

```
<?xml version="1.0" encoding="utf-8"?>
<TabHost
android:id="@android:id/tabhost"
xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
>
<LinearLayout
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    >
    <TabWidget
        android:id="@android:id/tabs"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
    />
    <FrameLayout
        android:id="@android:id/tabcontent"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
    />
</LinearLayout>
</TabHost> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-08T06:48:44.800

R.drawable.searchtab中的资源，是不是图片'.PNG'格式，如果是，是否有足够的透明度..？

> addTab(getString(R.string.Search), **R.drawable.searchtab** , SearchTask.class );

# c# - 如何找出PC现在连接的网络

> ID：12325709
> 
> 赞同：2
> 
> 时间：2012-09-07T21:34:20.190
> 
> 标签：c#, networking

我正在用 C# 编写一个应用程序，其中一项功能需要根据网络连接执行不同的操作。

例如; 当PC连接到家庭网线时执行MethodA 当PC连接到家庭网络但Wifi然后执行MethodB 当PC连接到建筑物1的办公网络时执行MethodC 当PC连接到建筑物2的办公网络时执行MethodD 当PC连接到朋友家庭网络执行方法E

在这里我如何区分不同的网络？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T21:39:45.107

我会使用一些关于网络的信息来解决这个问题。如果您使用无线网络，您会知道有线网卡没有 IP。然后根据 IP 方案，您可以推断出您所在的位置。您将不得不了解有关网络的一些信息。

例如，如果您的工作为您分配了子网范围内的 IP，`10.1.0.1-40`而您的家庭网络为您分配了 IP，`192.168.1.2-255`那么您可以使用该信息来决定您的应用程序的功能。

不幸的是，这是一个非常松散的耦合，如果路由方案发生变化，那么您的应用程序可能会中断。我会让这种设置可配置，您可以在其中创建一个将 ip 方案映射到“位置”的配置，并将其用作您所做工作的基础。

如果您将网络映射到 Windows 中的位置，则可以使用此问题中的答案来帮助[如何确定 .NET 中的“网络位置”？](https://stackoverflow.com/questions/2895692/how-do-i-determine-network-location-in-net?rq=1).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T21:47:31.860

我相信您可以可靠地检测机器是否通过无线或电缆连接到本地路由器。

但是，更进一步，我认为您会遇到很多问题。

如果它们在 Vista 或更高版本上，您应该能够获得正在使用的网络的“名称”。但是，这必须正确配置，并且不能由最终用户使用。

除此之外，您当然可以检查分配给您的 IP 地址范围……但是，假设建筑物 1 和 2 发出不同的范围，并且这些范围与家庭网络发出的范围不同。此外，家庭网络和朋友家庭网络完全有可能在同一个内部范围内。

我想说，您的应用程序最好询问用户使用什么方法，或者给他们方法的名称，或者通过询问其他类型的问题来给您一个提示。

# ruby-on-rails - 坐标数组形式

> ID：12325714
> 
> 赞同：0
> 
> 时间：2012-09-07T21:35:05.533
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, erb

我有一个创建地址的表格，这个地址有一个坐标数组。但我不知道生成输入以键入例如 3 个坐标。可以是 n 个坐标，我打算用 jQuery（创建输入）来做到这一点。但现在我想显示现有坐标。

这是代码：

模型

```
class Address
    include Mongoid::Document
    include Mongoid::Timestamps
    include Mongoid::Spacial::Document

    field :street, :type => String
    field :number, :type => Integer

    field :phone, :type => String

    field :delivery_zone, :type => Array
end 
```

erb.html

```
<%= form_for [:owner, :company,@address], :html => {:class => "form-horizontal"} do |f| %>
  <%= @address.delivery_zone.each do |dz|%>
    <% fields_for 'delivery_zone[]' , dz do |items| -%>

        ?? I don't know what to write here!!

    <% end %>
  <% end %>
<%end%> 
```

我正在寻找的是为字段`delivery_zone`和数组中的每个项目生成如下内容：

```
<input id="address_delivery_zone[]"  name="address[delivery_zone][]" type="text" value="32.7 33.8" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-08T18:30:36.363

我对 Mongoid 和 Mongoid::Spacial 不太熟悉，但我会尽力提供帮助。

据我了解你的问题，你需要每个`address`可能有多个`delivery_zones`，我假设是地理坐标。我认为这样做会更好：

```
class Address
  include Mongoid::Document
  include Mongoid::Timestamps

  field :street, :type => String
  field :number, :type => Integer
  field :phone, :type => String

  embeds_many :delivery_zones
  accepts_nested_attributes_for :delivery_zones
end

class DeliveryZone
  include Mongoid::Spacial::Document

  embedded_in :address
  field :coordinates, :type => Array, :spacial => true

  # accessors will help us manipulate the coordinates
  def latitude
    coordinates[:lat] # or coordinates[1] if you use the array
  end

  def longitude
    coordinates[:lng] # or coordinates[0] if you use the array
  end

  def latitude=( lat )
    coordinates[:lat] = lat
  end

  def longitude=( lng )
    coordinates[:lng] = lng
  end
end 
```

然后你可以使用`form_for`并且`fields_for`它打算用于嵌套资源，我认为（不能保证按原样工作）应该是这样的：

```
<%= form_for @address do |address_form| %>
  <% @address.delivery_zones.each do |zone| %>
    <%= address_form.fields_for( zone ) do |zone_form| %>
       <p>Latitude :</p> 
       <p><%= zone_form.text_field :latitude %></p>
       <p>Longitude :</p> 
       <p><%= subform.text_field :longitude %></p>
  <% end %>
<% end %> 
```

有关嵌套资源表单的更多信息，请[参阅 railscasts #197](http://railscasts.com/episodes/197-nested-model-form-part-2?view=asciicast)和[railscasts #75](http://railscasts.com/episodes/75-complex-forms-part-3)。

# python - 不使用排序函数查找中位数

> ID：12325715
> 
> 赞同：1
> 
> 时间：2012-09-07T21:35:06.180
> 
> 标签：python, median

作为家庭作业，我必须编写一个脚本，它可以在不使用 Python 的标准排序函数的情况下找到 3 个给定数字的中位数。

这是我上课的第一周，也是我的第一次编程体验，所以我发现很难比现在更进一步。

这是我到目前为止所拥有的：

```
def med3(a,b,c):
    list = [a, b, c]
    newlist = []
    if list:
        minimum = list[0]
        for x in list:
            if x < minimum:
                minimum = x
                newlist.append(minimum)
                list.remove(minimum)
            elif x >= minimum:
                newlist.append(x)
                list.remove(x)

    return newlist[1] 
```

这似乎可以解决问题，但仅适用于列表的前两个条目。该循环不包括第三个条目。

如何使脚本包含所有三个条目？

提前致谢！桑德

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-07T22:00:48.840

`sum([a, b, c]) - min(a, b, c) - max(a, b, c)`- 没有排序！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T21:45:41.963

您在循环遍历列表时正在就地修改列表，这会对您看到的元素产生影响：

```
>>> numbers = [1,2,3]
>>> for i in numbers:
...     if i == 2: numbers.remove(i)
...     print i
... 
1
2 
```

请注意如何`3`从不打印；通过删除列表中的第二个条目，我们将其缩短了一个元素，并且循环发现列表提前耗尽。

请注意，您*不需要*遍历这些项目，如果您考虑一下，一些简单的比较会告诉您哪个项目是中位数。:-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T00:40:44.683

最快的方法：

```
def medianFast(a, b, c):
    if a > b:
        if b > c: 
            return b
        elif a > c:
            return c
        else:
            return a
    else:
        if b < c: 
            return b
        elif a > c:
            return a
        else:
            return c 
```

保证在最坏情况下进行 3 次比较，在最佳情况下进行 2 次比较。平均 2,5 次比较。

使用[三元条件](http://docs.python.org/3/reference/expressions.html#conditional-expressions)，我们可以把它写得更短：

```
def medianTernary(a, b, c):
    return (b if b > c else (c if a > c else a)) if a > b else (b if b < c else (a if a > c else c)) 
```

如果您可以使用排序，您将拥有最短的版本：

```
def medianSorted(a, b, c):
    return sorted([a, b, c])[1] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T21:48:21.307

有许多更简单的方法可以解决这个问题，但至于您的方法：

您正在`list`循环内部进行修改。不要那样做。:)

在您的情况下，您应该从新列表中删除元素：

```
def med3(a,b,c):
    list = [a, b, c]
    newlist = []
    if list:
        minimum = list[0]
        for x in list:
            if x < minimum:
                minimum = x
                newlist.pop()
                newlist.append(minimum)
            elif x >= minimum:
                newlist.append(x)
    return newlist[1] 
```

但作为练习，您可能需要考虑以下几点：

*   为什么要将元素放在列表中并循环遍历它们？与将 a,b,c 与简单的 if 语句进行比较相比，这有什么优势？

*   为什么`if list:`？

# php - PHP - 准确的 Unix 时间戳

> ID：12325717
> 
> 赞同：0
> 
> 时间：2012-09-07T21:35:28.637
> 
> 标签：php, unix, time, filter, timestamp

我正在尝试根据不同的时间段创建准确的 Unix 时间戳以分配给变量。知道如何计算这些时间戳周期吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T21:50:09.953

我只能建议你阅读时间手册。

[http://php.net/manual/en/function.time.php](http://php.net/manual/en/function.time.php)

今天到最后一个午夜 -> 获取小时 + 分钟，做一个减去 24:00 小时的计算，使用[http://php.net/manual/en/function.abs.php](http://php.net/manual/en/function.abs.php)让你的价值为正

所有其他的都可以通过使用[http://php.net/manual/en/function.strtotime.php来解决](http://php.net/manual/en/function.strtotime.php)

在最坏的情况下，将其转换为 unix 时间并获得差异，您将获得准确的输出，而无需关注闰年和您提到的其他时间条件，例如 2 月 28 日问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T22:02:47.727

我可以说你不想这样做吗？存储常规的 Unix 时间戳——如果需要，可以转换为本地时间戳。

当时区发生变化或有人改变夏令时时，数据会变得非常快，非常快。根据您需要数据的准确程度，闰秒（甚至闰分钟）是可能的。

时间处理代码非常复杂且/非常/智能。

*   存储实时时间戳。
*   存储标记该时期开始的时间戳。
*   需要时减去。
*   避免晦涩的错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T22:10:52.600

我是 PHP 的[DateTime 类](http://www.php.net/manual/en/book.datetime.php)的大力支持者。它们减轻了在处理时间时出现的许多挫败感。

此示例说明了如何使用它。

```
<?php

header('Content-type: text/plain');

$today = new DateTime("today");
echo 'Today: ' . $today->format('Y-m-d H:i:s') . "\n";
echo 'Timestamp: ' . $today->getTimestamp() . "\n\n";

$thisweek = new DateTime("this week");
echo 'This Week: ' . $thisweek->format('Y-m-d') . "\n";
echo 'Timestamp: ' . $thisweek->getTimestamp() . "\n\n";

$thismonth = new DateTime("this month");
echo 'This Month: ' . $thismonth->format('Y-m') . "\n";
echo "Days this month: ", $thismonth->format('t') . "\n";
echo 'Timestamp: ' . $thismonth->getTimestamp() . "\n\n";

?> 
```

您可以通过使用[DateTimeZone](http://www.php.net/manual/en/class.datetimezone.php)类来增强它。

# php - MeioUpload 和 phpThumb() 不存在错误

> ID：12325719
> 
> 赞同：0
> 
> 时间：2012-09-07T21:35:32.500
> 
> 标签：php, cakephp, phpthumb, cakephp-2.2, meio-upload

我目前正在使用 CakePHP v2.2.1 和 MeioUpload 4.0 以及 phpThumb() 来尝试为这些图像生成图像上传和缩略图。如果我在`$actAs = array()`没有 thumbsizes 属性的情况下设置我的一切都上传得很好，但是当我添加以下内容时：

```
'thumbsizes' => array(
    'small' => array('width' => 165, 'height' => 115),
    'medium' => array('width' => 800, 'height' => 600)
), 
```

要生成缩略图，我收到一条错误消息，说明如下：

```
"E:/xampp/htdocs/site/vendors/phpthumb/img/posts/image-name.jpg" does not exist 
```

我已经尝试了几种不同的方法来从网络上解决这个问题，但似乎没有任何效果。我是 cakephp 的新手，所以这可能是一个简单的修复，我只是没有连接点来找到解决方案。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-08T02:25:14.013

决定使用 Miles J. 插件，这里[是 milesj.me/code/cakephp/uploader](http://milesj.me/code/cakephp/uploader)。看来Meio 的CakePHP 2.2.1 版本有问题，又好了！

# android - webview.java 中的 NullPointerException (android.webkit.WebView$PrivateHandler.handleMessage)

> ID：12325720
> 
> 赞同：6
> 
> 时间：2012-09-07T21:35:33.463
> 
> 标签：android, webview, htc-android

每隔几天，我就会收到我的应用程序的崩溃报告，其中包含以下堆栈跟踪或其小型变体（基于不同的 android 版本具有不同的行号）

```
java.lang.NullPointerException at
WebView.java:8241:in `android.webkit.WebView$PrivateHandler.handleMessage'
Handler.java:99:in `android.os.Handler.dispatchMessage'
Looper.java:150:in `android.os.Looper.loop'
ActivityThread.java:4293:in `android.app.ActivityThread.main'
Method.java:-2:in `java.lang.reflect.Method.invokeNative'
Method.java:507:in `java.lang.reflect.Method.invoke'
ZygoteInit.java:849:in `com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run'
ZygoteInit.java:607:in `com.android.internal.os.ZygoteInit.main'
NativeStart.java:-2:in `dalvik.system.NativeStart.main' 
```

此特定堆栈位于 HTC EVO 3D PG86100 设备上的 Android 2.3.4 上。我的应用确实为一些与 oAuth 相关的登录场景托管了几个 webview。

我应该如何去尝试弄清楚如何解决这个问题？我尝试在 grepcode 上查找源代码，但找不到有意义的匹配行号。我的 Grepcode-fu 弱吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-16T22:25:39.127

我最近遇到了这个问题，在我的情况下，我设法弄清楚是次要错误修复导致了这个问题。

所以，如果你没有创建一个扩展 webview 的自定义类，它会覆盖 onCheckIsTextEditor 以始终返回 true，因为这个[android 错误报告](http://code.google.com/p/android/issues/detail?id=7189)中的建议......我会停止阅读这里。

如果您已经这样做了，那么看来此修复程序已由 HTC 实施，并且由于某种原因导致它在收到焦点时崩溃。对我来说，这个问题在两个地方表现出来，在视图上放置触摸事件和设置视图可见性时。在我的项目中，我设置了一个 WebViewClient 并等到页面完成加载，然后再将 webview 的可见性设置为可见。这导致了以下堆栈跟踪：

```
java.lang.NullPointerException at android.webkit.WebView.navHandledKey(WebView.java:9353)
    at android.webkit.WebView.requestFocus(WebView.java:7910)
    at android.view.View.requestFocus(View.java:3718)
    at android.view.View.requestFocus(View.java:3696)
    at android.view.ViewRoot.focusableViewAvailable(ViewRoot.java:1803)
    at android.view.ViewGroup.focusableViewAvailable(ViewGroup.java:474)
    at android.view.ViewGroup.focusableViewAvailable(ViewGroup.java:474)
    at android.view.ViewGroup.focusableViewAvailable(ViewGroup.java:474)
    at android.view.ViewGroup.focusableViewAvailable(ViewGroup.java:474)
    at android.view.ViewGroup.focusableViewAvailable(ViewGroup.java:474)
    at android.view.ViewGroup.focusableViewAvailable(ViewGroup.java:474)
    at android.view.View.setFlags(View.java:4680)
    at android.view.View.setVisibility(View.java:3163) 
```

通过将 setVisibility 调用包装在 try/catch 中，我能够确定是否应该覆盖触摸事件。如果我抓住了这个事件，那意味着我应该禁用覆盖。这是我所做的一个例子：

```
try {
    webView.setVisibility(View.VISIBLE);
} catch (NullPointerException e) {
    Log.i(TAG, "Error setting webview visibility due to overriding focus. It will be disabled.");
    webView.setOverrideOnCheckIsTextEditor(false);
    // Confirm window is visible
    webView.setVisibility(View.VISIBLE);
} 
```

我的自定义 webview 现在看起来像这样，特别注意最后两种方法：

```
/**
 * When using a webview in a dialog, there are issues relating to the keyboard not appearing when focusing on a text box.
 * This overrides a function to ensure the keyboard is shown when focusing on a text box in a webview.
 * See link for bug report and solution.
 *
 * @see http://code.google.com/p/android/issues/detail?id=7189
 * @see http://stackoverflow.com/questions/12325720
 * @author James O'Brien
 * @since 10/16/2012
 */
public class FocusableWebView extends WebView {

    private boolean mOverrideCheckIsTextEditor = true;

    /**
     * Default Constructor
     *
     * @param context
     */
    public FocusableWebView(Context context) {
        super(context);
    }

    /**
     * Default Constructor
     *
     * @param context
     * @param attrs
     */
    public FocusableWebView(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    /**
     * Default Constructor
     *
     * @param context
     * @param attrs
     * @param defStyle
     */
    public FocusableWebView(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
    }

    @Override
    public boolean onCheckIsTextEditor() {
        if (mOverrideCheckIsTextEditor) {
            return true;
        } else {
            return super.onCheckIsTextEditor();
        }
    }

    /**
     * Enable/Disable overriding of onCheckIsTextEditor to always return true.
     */
    public void setOverrideOnCheckIsTextEditor(boolean foo) {
        mOverrideCheckIsTextEditor = foo;
    }
} 
```

抱歉，我无法详细说明为什么这可以解决问题。我只能假设它与焦点有关，并且动态禁用它是一种享受:)

** 更新 (12/11/12) **

设法解决了上述两个问题。这似乎是 webview 的焦点问题。我的代码现在看起来像这样

```
webView.setVisibility(View.VISIBLE);
webView.setFocusable(true);
webView.requestFocus(); 
```

我建议确保将可聚焦属性显式设置为“true”或调用 setFocusable(true)。

# php - 使用 php curl 解析我的 wordpress 博客中的 XML 提要时出错

> ID：12325722
> 
> 赞同：0
> 
> 时间：2012-09-07T21:35:40.033
> 
> 标签：php, curl, xml-parsing, rss

[https://blog.onlywire.com/category/content-submission/feed/](https://blog.onlywire.com/category/content-submission/feed/)

这是我的提要网址。出于某种原因，我无法使用 PHP 解析它。我错过了什么？

剧本：

```
$ch = curl_init( $feed_curl );
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_HEADER, 0);
$data = curl_exec($ch);
echo $data; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T21:44:07.517

尝试查看您是否收到任何 curl 错误 - 并且不要忘记关闭处理程序！

```
 $ch = curl_init($url);
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE); // return into a variable
        curl_setopt($ch, CURLOPT_HEADER, 0);
        $result = curl_exec($ch); // run!
        if($result === FALSE) {
            var_dump(curl_error($ch));
        }
        else {
            var_dump($result);
        }
        curl_close($ch); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-14T19:38:00.723

尝试指定根 CA 文件：

```
curl_setopt($ch, CURLOPT_CAINFO, '/path/to/your/cafile'); 
```

您可以从 curl 网站下载 CA 文件：

[http://curl.haxx.se/docs/caextract.html](http://curl.haxx.se/docs/caextract.html)

# vbscript - 从 Windows 批处理文件中解析 url

> ID：12325725
> 
> 赞同：2
> 
> 时间：2012-09-07T21:35:51.167
> 
> 标签：vbscript, batch-file

我有一个文本文件（myurls.txt），其内容是如下 URL 列表：

```
Slides_1:   http://linux.koolsolutions.com/svn/ProjectA/tags/REL-1.0
Exercise_1: http://linux.koolsolutions.com/svn/Linux/tags/REL-1.0

Slides_2:   http://linux.koolsolutions.com/svn/oldproject/ProjectB/tags/REL-2.0
Exercise_2: http://linux.koolsolutions.com/svn/ProjectB/tags/REL-1.0

Exercise_3: http://linux.koolsolutions.com/svn/BlueBook/ProjectA/tags/REL-1.0 
```

现在我想在 for 循环中解析这个文本文件，以便在每次迭代之后（例如，从上面的文件中获取第一个 url）我将以下信息放入不同的变量中：

```
%i% = REL-1.0
%j% = http://linux.koolsolutions.com/svn/ProjectA
%k% = http://linux.koolsolutions.com/svn/ProjectA/tags/REL-1.0 
```

经过一些实验后，我得到了以下代码，但它仅在 URL 具有相同数量的斜杠时才有效（有点）：

```
@echo off
set FILE=myurls.txt
FOR /F "tokens=2-9 delims=/ " %%i in (%FILE%) do (
@REM <do something with variables i, j and k.>
) 
```

显然，我需要让它更灵活，以便它可以处理任意 url 长度。我对其他解决方案很好，例如使用 Windows Script Host/VBscript，只要它可以在默认的 Windows XP/7 安装下运行。换句话说，我知道我可以在 Windows 上使用 awk、grep、sed、python 等并完成工作，但我不希望用户必须安装除了标准 Windows 安装之外的任何东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T22:33:42.553

我认为这可能是您正在寻找的东西，尽管我不确定您确定项目的规则是什么。

它使用 FOR`~pnx`修饰符来解析路径的一部分。`HELP FOR`从命令行使用以获取更多信息。它用于`\..\..`访问祖父“目录”，并`\`预先设置为使“路径”成为绝对路径。

结果将`/`and`//`转换为`\`，因此变量搜索和替换用于恢复正确的斜杠分隔符，并使用子字符串操作去除前导斜杠。`HELP SET`从命令行使用以获取有关搜索和替换以及子字符串操作的更多信息。

使用延迟扩展是因为它需要扩展在同一代码块中设置的变量。

```
@echo off
setlocal enableDelayedExpansion
set "file=myurls.txt"
for /f "tokens=1*" %%A in (%file%) do (
  for /f "delims=" %%C in ("\%%B\..\..") do (
    set "project=%%~pnxC"
    set "project=!project:~1!"
    set "project=!project:\=/!"
    set "project=!project:http:/=http://!"
    echo header  = %%A
    echo url     = %%B
    echo project = !project!
    echo release = %%~nxB
    echo(
  )
) 
```

以下是您的样本数据的结果：

```
header  = Slides_1:
url     = http://linux.koolsolutions.com/svn/ProjectA/tags/REL-1.0
project = http://linux.koolsolutions.com/svn/ProjectA
release = REL-1.0

header  = Exercise_1:
url     = http://linux.koolsolutions.com/svn/ProjectA/tags/REL-1.0
project = http://linux.koolsolutions.com/svn/ProjectA
release = REL-1.0

header  = Slides_2:
url     = http://linux.koolsolutions.com/svn/oldproject/ProjectB/tags/REL-2.0
project = http://linux.koolsolutions.com/svn/oldproject/ProjectB
release = REL-2.0

header  = Exercise_2:
url     = http://linux.koolsolutions.com/svn/ProjectB/tags/REL-1.0
project = http://linux.koolsolutions.com/svn/ProjectB
release = REL-1.0

header  = Exercise_3:
url     = http://linux.koolsolutions.com/svn/BlueBook/ProjectA/tags/REL-1.0
project = http://linux.koolsolutions.com/svn/BlueBook/ProjectA
release = REL-1.0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T11:35:32.660

好的，我最短且最容易理解但评论最少的解决方案：

```
@echo off
for /f "tokens=1-3 delims=: " %%x in (URLs.txt) do (
  set LabelNam=%%x
  set ReleaseURL=%%y:%%z
  for /f "tokens=1-31 delims=/" %%a in ("%%y:%%z") do call :getURL %%a %%b %%c %%d %%e %%f %%g %%h %%i %%j %%k %%l %%m %%n %%o %%p %%q %%r %%s %%t %%u %%v
  echo.
  echo       Label = %LabelNam%
  echo     Release = %Release%
  echo         URL = %URL%
  echo Release URL = %ReleaseURL%
)
goto :eof

:getURL
  set URL=%1/
  shift
  :URLloop
    set URL=%URL%/%1
    shift
  if "%1" neq "tags" goto :URLloop
  Set Release=%2
goto :eof 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-09T01:37:09.137

```
@echo off

:: First seperate into Label, URI type, and internet path
for /f "tokens=1-3 delims=:" %%x in (URLs.txt) do (
  echo.

  :: Take the Label
  for /f %%a in ("%%x") do set LabelNam=%%a

  :: Assemble Release URL
  set ReleaseURL=http:%%z

  :: Delayed variable expansion is required just for 'z'
  setlocal enabledelayedexpansion

    :: Take Release URL Path
    set z=%%z

    :: Extract the Release
    for /f "tokens=2" %%b in ("!z:/tags/= !") do set Release=%%b

    :: Split the Internet Path at the '/''s and call ':getURL'
    call :getURL %%y !z:/= !

    :: Output the information 
    echo       Label = !LabelNam!
    echo     Release = !Release!
    echo         URL = !URL!
    echo Release URL = !ReleaseURL!
  :: End variable expansion
  endlocal
)
goto :eof

:getURL
  :: Get URL type
  set URL=%1:/
  :: shift all arguments one to the left
  shift

  :URLloop
    :: Assemble URL
    set URL=%URL%/%1
    shift
  :: If we haven't fount 'tags' yet, loop
  if "%1" neq "tags" goto :URLloop

goto :eof 
```

# ruby-on-rails - 无法使用 ruby -on-rails 批量分配受保护的属性

> ID：12325727
> 
> 赞同：2
> 
> 时间：2012-09-07T21:35:59.603
> 
> 标签：ruby-on-rails, nested-attributes

我试图在我的用户/新页面上有一个嵌套表单，它接受用户属性和公司属性。当您提交表格时：

**这是我的错误信息：**

```
ActiveModel::MassAssignmentSecurity::Error in UsersController#create
Can't mass-assign protected attributes: companies
app/controllers/users_controller.rb:12:in `create' 
```

这是我的表单的代码：

```
<%= form_for @user do |f| %>
      <%= render 'shared/error_messages', object: f.object %> 

      <%= f.fields_for :companies do |c| %>

      <%= c.label :name, "Company Name"%>
      <%= c.text_field :name %>

      <% end %>

      <%= f.label :name %>
      <%= f.text_field :name %>

      <%= f.label :email %>
      <%= f.text_field :email %>

      <%= f.label :password %>
      <%= f.password_field :password %>

      <%= f.label :password_confirmation %>
      <%= f.password_field :password_confirmation %>
      <br>
      <% if current_page?(signup_path) %>
      <%= f.submit "Sign Up", class: "btn btn-large btn-primary" %>     Or, <%= link_to "Login", login_path %>
      <% else %>
      <%= f.submit "Update User", class: "btn btn-large btn-primary" %>
      <% end %>
<% end %> 
```

**用户控制器：**

```
 class UsersController < ApplicationController

  def index
    @user = User.all
  end

  def new
    @user = User.new
  end

  def create
    @user = User.create(params[:user])
    if @user.save
      session[:user_id] = @user.id #once user account has been created, a session is not automatically created. This fixes that by setting their session id.  This could be put into Controller action to clean up duplication.
      flash[:success] = "Your account has been created!"
      redirect_to tasks_path
    else
       render 'new'
    end
  end

  def show
    @user = User.find(params[:id])
    @tasks = @user.tasks
  end

  def edit
    @user = User.find(params[:id])
  end

  def update
    @user = User.find(params[:id])
    if @user.update_attributes(params[:user])
      flash[:success] = @user.name.possessive + " profile has been updated"
      redirect_to @user
    else
      render 'edit'
    end

    #if @task.update_attributes params[:task]
    #redirect_to users_path
    #flash[:success] = "User was successfully updated."
    #end
end

  def destroy
    @user = User.find(params[:id])
    unless current_user == @user
      @user.destroy
      flash[:success] = "The User has been deleted."
    end
    redirect_to users_path
    flash[:error] = "Error. You can't delete yourself!"
  end

end 
```

**公司控制人**

```
 class CompaniesController < ApplicationController

  def index
    @companies = Company.all
  end

  def new
    @company = Company.new
  end

  def edit
    @company = Company.find(params[:id])
  end

  def create
    @company = Company.create(params[:company])
    #if @company.save
      #session[:user_id] = @user.id #once user account has been created, a session is not automatically created. This fixes that by setting their session id.  This could be put into Controller action to clean up duplication.
      #flash[:success] = "Your account has been created!"
      #redirect_to tasks_path
    #else
       #render 'new'
    #end
  end

  def show
    @comnpany = Company.find(params[:id])
  end

end 
```

**用户模型**

```
class User < ActiveRecord::Base
  has_secure_password

  attr_accessible :name, :email, :password, :password_confirmation
  has_many :tasks, dependent: :destroy
  belongs_to :company
  accepts_nested_attributes_for :company

  validates :name, presence: true, length: { maximum: 50 }
  VALID_EMAIL_REGEX = /\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z/i
  validates :email, presence:   true,
                    format:     { with: VALID_EMAIL_REGEX },
                    uniqueness: { case_sensitive: false }
  validates :password, length: { minimum: 6 }
  #below not needed anymore, due to has_secure_password
  #validates :password_confirmation, presence: true  
end 
```

**公司模式**

```
 class Company < ActiveRecord::Base
  attr_accessible :name
  has_and_belongs_to_many :users
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-08T00:05:15.963

首先，为了调试，请在两个控制器中创建，如下所示：`create!` 您的日志可能会吐出更多。

然后，如果这很糟糕，请尝试构建两个对象并为每个对象分配参数的老式方法。

我还假设这就是属性，而不是保存后应该对架构有更多的内容，然后再显示。

最后，你不见了

```
def new
  @user = User.new
  @company = @user.companies.build
end 
```

也打印出参数，以防万一它说了什么奇怪的东西，但添加了这一行：正如@Beerlington所说的应该也可以工作`:company_attributes`，也许company_attributes ...在这里吐个球。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T21:41:17.547

添加`attr_accessible :companies`到您的用户模型属性列表

# java - 创建对象数组

> ID：12325732
> 
> 赞同：-3
> 
> 时间：2012-09-07T21:36:12.583
> 
> 标签：java, arrays

我有一堂课叫`ElementInfo`

```
public class ElementInfo {

    public String name;
    public String symbol;
    public double mass;

} 
```

然后我尝试创建一个`ElementInfo`像这样的数组：

```
ElementInfo e[] = new ElementInfo[2];

e[0].symbol = "H";
e[0].name = "Hydrogen";
e[0].mass = 1.008;

//... 
```

不要告诉我我必须调用`new`类的每个实例！

我可以这样做：

```
ElementInfo e[] = new ElementInfo[100];
for(ElementInfo element: e){
    e = new ElementInfo();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T21:37:13.023

您必须为类的每个元素调用 new。

```
public class ElementInfo {

    private String name;
    private String symbol;
    private double mass;

    public String get_name() { return name; }
    public String get_symbol() { return symbol; }
    public double get_mass() { return mass; }

    public ElementInfo(name, symbol, mass) {
        this.name = name;
        this.symbol = symbol;
        this.mass = mass;
    }
} 
```

然后像这样创建它们：

```
e[0] = new ElementInfo("H", "Hydrogen", 1.008); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T21:37:26.347

> 不要告诉我我必须为类的每个实例调用 NEW！

确切地。

您刚刚创建了一个空数组。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-07T21:38:03.443

```
ElementInfo e[] = new ElementInfo[2];

e[0] = new ElementInfo();
e[0].symbol = 'H'; ... 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-07T21:38:03.307

您必须为每个元素创建一个新实例，但这并不难：

```
ElementInfo e[] = new ElementInfo[2];
for (int i = 0; i < e.length; i++)
    e[i] = new ElementInfo(); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-07T21:38:51.260

是的，你必须这样做。

创建数组时，您只需为实际对象的引用创建空间。最初的值为`null`。

要放置对对象的引用，请执行分配

```
e[0] = new ElementInfo(); 
```

或者

```
ElementInfo a = new ElementInfo();
....
e[0] = a; 
```

放松，打字将是你作为程序员的最后一个问题:-D

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-07T21:40:59.487

是的。现在它是一个包含 ElementInfo 对象但每个索引为空的数组。

为什么不创建一个接受参数的构造函数。然后

```
ElementInfo [] elements = {new ElementInfo("H", "Hydrogen", 1.008), new ElementInfo("C", ....)}; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-09-07T21:40:16.210

通过声明一个数组，该数组类型的实例*不会*自动填充该数组。

```
e[0] = new ElementInfo(); 
```

您还可以使用 for 循环轻松地在每个索引处实例化一个对象。

```
for (int i = 0; i < e.length; i++) {
    e[i] = new ElementInfo();
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-09-07T21:50:29.377

```
ElementInfo e[] = new ElementInfo[100]; 
for(ElementInfo element: e){ 
    e = new ElementInfo(); 
} 
```

您不能这样做，因为`e`它是一个数组类型变量，这意味着您不能为它分配对 type 对象的引用`ElementInfo`。`e = new ElementInfo();`就是我所指的。

看看[达尔姆斯的回答](https://stackoverflow.com/a/12325743/738746)。

# rdf - 公开可用的（rdf）颜色本体？

> ID：12325736
> 
> 赞同：5
> 
> 时间：2012-09-07T21:36:35.660
> 
> 标签：rdf, semantic-web, ontology

是否有任何公开可用的（rdf）颜色本体？感谢您的任何指示。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-08T13:50:42.257

您可以使用**dbpedia**的资源。

SPARQL：

```
select distinct ?c where {?c a <http://dbpedia.org/ontology/Colour> } 
```

[http://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query=select+distinct+%3Fc+where+{%3Fc+a+%3Chttp%3A%2F%2Fdbpedia.org%2Fontology %2FColour%3E+}&format=text%2Fhtml&timeout=0&debug=on](http://dbpedia.org/sparql?default-graph-uri=http://dbpedia.org&query=select%20distinct%20?c%20where%20%7B?c%20a%20%3Chttp://dbpedia.org/ontology/Colour%3E%20%7D&format=text/html&timeout=0&debug=on)

```
http://dbpedia.org/resource/Turquoise_(color)
http://dbpedia.org/resource/Orange_(colour)
http://dbpedia.org/resource/Gold_(color)
http://dbpedia.org/resource/Terracotta
http://dbpedia.org/resource/Cobalt_blue
http://dbpedia.org/resource/Orchid_(color)
http://dbpedia.org/resource/Buff_(colour)
http://dbpedia.org/resource/Isabelline_(colour)
http://dbpedia.org/resource/Egyptian_blue
http://dbpedia.org/resource/Phthalocyanine_Green_G
http://dbpedia.org/resource/Phthalocyanine_Blue_BN
http://dbpedia.org/resource/Vermilion
(...) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T22:11:21.063

试试[Linked Open Colors](http://linkedopencolors.appspot.com/)词汇表，它为 RGB 光谱的所有颜色提供 IRI。

**编辑：**正如 Joshua Taylor 在评论中所说，链接已失效，所以我更改了它。我还添加了一句话来说明链接是关于什么的，以解决“这是一个链接唯一的答案”。

**编辑（之二）：**链接现在已经死了。忽略此答案，并随时对其进行多次否决。但是，[代码仍然可用](https://bitbucket.org/moreways/loc)，理论上将来可以在其他地方重新部署，因此我将答案保留在这里。

# visual-studio-2010 - 我应该安装 Visual Studio 12

> ID：12325739
> 
> 赞同：1
> 
> 时间：2012-09-07T21:37:22.223
> 
> 标签：visual-studio-2010, visual-studio-2012

我正在和其他几个拥有 vs10 的人一起做一个项目，如果我升级到 vs12 会不会很痛苦。当我们都签入 svn 时会痛吗？就 wpf、mvc 等而言，一切是否仍然兼容。我应该知道关于新的视觉工作室 2012 的任何事情吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T11:53:08.950

到目前为止，使用 VS2012 和 VS2010 似乎完美无缺。一个月前，当它在 MSDN 上可用时，我安装了它。从那时起，我已经解决了几个问题，没有任何兼容性问题。令人担忧的是，我们遇到了一个问题，即 linq to entity 查询在没有 .net 4.5 的机器上运行良好，但在具有 .net 4.5 的机器上却失败了，尽管项目针对 .net 4.0。一个同事正在看这个，所以我没有更多细节

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T21:52:42.663

我个人会与从事该项目的其他人保持类似的环境——要么全部到 2012 年，要么全部留在 2010 年。

并不是说在这两种环境之间工作存在或不存在已知问题，但是当您要使用尽可能低的公分母时，为什么要引入可能的问题呢？

# c++ - std::ratio<> 背后的设计原则

> ID：12325741
> 
> 赞同：30
> 
> 时间：2012-09-07T21:37:30.860
> 
> 标签：c++, c++11, metaprogramming, rational-numbers

我正在查看[`std::ratio<>`](http://en.cppreference.com/w/cpp/numeric/ratio)C++11 标准中允许进行编译时有理算术的类。

我发现模板设计和用类实现的操作过于复杂，并且没有找到任何理由不能通过实现一个非常简单的有理类并`constexpr`为运算符定义函数来使用更直接和直观的方法。结果将是一个更易于使用的类，并且编译时优势将保持不变。

`std::ratio<>`与使用 的简单类实现相比，有人知道当前设计的优势`constexpr`吗？实际上，我无法找到当前实施的任何优势。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-09-07T22:22:00.647

当[N2661](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2661.htm)被提出时，没有一个提案作者能够访问一个实现了`constexpr`. 我们没有人愿意提出我们无法构建和测试的东西。因此，是否可以完成更好的设计`constexpr`甚至不是设计考虑的一部分。该设计仅基于作者当时可用的那些工具。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-09-07T23:25:52.087

constexpr 解决方案解决了完全不同的问题。`std::ratio`创建它是为了用作使用不同单位的变量之间的桥梁，而不是作为数学工具。在这些情况下，您绝对希望比率成为类型的一部分。constexpr 解决方案在那里不起作用。例如，如果没有运行时空间和运行时成本，就不可能实现`std::duration`，因为每个持续时间对象都需要在对象内携带其提名/分母信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-06-08T22:06:02.663

> 为运算符定义 constexpr 函数

您仍然可以在现有的基础上执行此操作`std::ratio`：

```
#include <ratio>

// Variable template so that we have a value
template< 
    std::intmax_t Num, 
    std::intmax_t Denom = 1 
>
auto ratio_ = std::ratio<Num, Denom>{};

// Repeat for all the operators
template< 
    std::intmax_t A, 
    std::intmax_t B,
    std::intmax_t C,
    std::intmax_t D
>
constexpr typename std::ratio_add<std::ratio<A, B>, std::ratio<C, D>>::type
operator+(std::ratio<A, B>, std::ratio<C, D>) {}

// Printing operator
template< 
    std::intmax_t A, 
    std::intmax_t B
>
std::ostream &operator<<(std::ostream &os, std::ratio<A, B> r) {
    return os << decltype(r)::num << "/" << decltype(r)::den;
} 
```

```
#include <iostream>

int main() {
    std::cout << ratio_<1,2> + ratio_<1,3> << std::endl;
    return 0;
} 
```

```
5/6 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T21:48:59.003

`std::ratio`借助模板元编程和类型操作，其周围的机制将始终在编译时运行。仅当 C++ 工具（例如模板参数或初始化变量）`constexpr`需要常量表达式时，才需要在运行时运行。`constexpr`

那么哪个对您更重要：编译时执行，还是“更直接和直观”？

# .net - 我的完全托管程序集在 .Net 4.5 上因 AccessViolationException 而崩溃？

> ID：12325746
> 
> 赞同：0
> 
> 时间：2012-09-07T21:38:45.430
> 
> 标签：.net, debugging, jit, .net-4.5, il

我一直在调试一个非常棘手的问题。

基本上，我有一个以各种方式崩溃的混淆程序集。未混淆的程序集没有问题，但不能保证混淆器不会在这里受到责备。（这就是我可能要解决的问题）

无论如何，混淆程序集在 .Net 4.0 上也可以正常运行。如果我在 .Net 4.5 中禁用 JIT 优化，它运行良好。

我试过的：

我尝试针对 IL 进行调试。访问冲突似乎来自一个简单地将某些内容加载到堆栈上的 IL 操作。同样，完全托管的代码。

以防万一它与[String.Empty](https://stackoverflow.com/questions/11873798/whats-the-cause-of-this-fatalexecutionengineerror-in-net-4-5-beta)相关，我通过 IL 并将所有 string::empty 调用替换为`ldstr ""`.. 现在，而不是 AccessViolation，我得到了 FatalEngineException

在所有选项关闭的情况下通过反混淆器运行它可以使其正常工作。基本上，反混淆器所做的一切都没有打开，只是勉强重新排列 IL 并插入一些 NOP。

此外，可执行文件确实通过了 PEVerify，所以这不是问题。

错误的可执行文件：[Test.exe](http://lastyearswishes.com/static/Test.exe)

好的可执行文件：[Test-cleaned.exe](http://lastyearswishes.com/static/Test-cleaned.exe)

有问题的堆栈跟踪：

```
Test.exe!PreEmptive.SoS.Client.Cache.CacheService.ServiceCache() 第 22032 行 + 0x137 字节未知
Test.exe!Test.TestConsole.Main(string[] args) 第 14 行 + 0x6 字节未知

```

您可以使用 ildasm 比较两个可执行文件。因为它是重新排序的，我发现它对我的口味来说有点太难了。我制作了一个[小工具](https://bitbucket.org/earlz/ildump/overview)来转储方法的 IL 并将方法按排序顺序排列以便于比较。

错误的 IL 转储：[testcount.il](http://lastyearswishes.com/static/testcount.il)

好的 IL 转储：[testcountcleaned.il](http://lastyearswishes.com/static/testcountcleaned.il)

无论如何，如果有人对如何分析这一点有任何想法并弄清楚究竟是哪些 IL 导致了这种情况，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T13:27:32.070

解决方案是我们确实有一点点 P/Invoking。.Net 4.5 更积极地使用内存。出于某种原因，我们使用的一个工具在我们的一个结构上剥离了 Marshalling 属性。修复该错误后，一切都神奇地起作用。所以，这根本不是 .Net 4.5 的错误。它现在只是更积极地使用内存。

# iphone - 从长度为 4000+ 的 NSData 转换时，NSMutableString 变为 (null)

> ID：12325751
> 
> 赞同：0
> 
> 时间：2012-09-07T21:39:21.293
> 
> 标签：iphone, ios, nsstring, nsurlconnection, nsdata

我正在向某个服务器发送 XML 请求并使用 NSURLConnection 从中获取一些响应数据：

```
-(void)connectionDidFinishLoading:(NSURLConnection *)connection  
{  
    NSMutableString *receivedString = [[NSMutableString alloc] initWithData:_receivedData encoding:NSUTF8StringEncoding];       
    NSLog(@"Size of DATA: %d",[_receivedData length]);  
    NSLog(@"Body: %@", receivedString);  
} 
```

当我的数据长度约为 4000 时 - 我通常可以在输出中看到接收到的数据。但是当数据长度变大（6000、10000等）时，输出显示我的receiveString变为null！

当它的长度变得更大时，我怎样才能将我的数据保存到字符串中？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T22:29:45.437

你确定你的数据是用 编码的`NSUTF8StringEncoding`吗？仔细检查返回给您的数据。 如果编码未正确表示数据，`initWithData:encoding:`将返回。`nil`

一个简单的测试方法是使用相同的数据对象，并创建一个包含相同数据的增量片段的字符串，直到它失败，然后查看导致它失败的字节。

我敢打赌，你在该数据中有一个不正确（或不匹配）的编码字节。

# flash - HTML5 回退到 Flash，而 Flash 又回退到 JPG

> ID：12325761
> 
> 赞同：0
> 
> 时间：2012-09-07T21:40:32.743
> 
> 标签：flash, html, jpeg, agent

有人可以帮我弄清楚如何构建后备设置吗？我需要通过 iframe 将 HTML5 动画插入网页，如果浏览器不支持 HTML5，我需要它来播放 Flash 动画。如果浏览器不支持 HTML5，并且没有安装正确版本的 Flash，我需要它来显示一个 jpeg。

这可以通过用户代理来实现吗？我无法通过使用条件语句来完成这项工作，因为条件语句只检查用户是否使用 IE，而 IE10“支持”HTML5（我讽刺地使用引号，实际上 IE10 做得很好。我只是不习惯对 IE 有好话要说，但我离题了）

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T23:01:48.740

你有两个不错的选择：

1.  **HTML**。HTML 会自动忽略它不理解的标签，所以嵌套标签来完成你想要的：

```
 <canvas>
        <!-- stuff that works for canvas -->
        <object class="flash-etc">
            <!-- flash parameters -->
            <img src="/the/jpg" />
        </object>
    </canvas> 
```

1.  **JavaScript**。使用 Modernizr ([http://modernizr.com/](http://modernizr.com/)）来检测特征的存在。检测浏览器制造商和版本非常非常脆弱。不要这样做。而是检测目标特征的存在并采取相应的行动。搜索词称为“polyfill”

    ```
    if ( Modernizr.canvas ) {
        // html5 here
    } else if ( /*test for flash */ ) {
        // flash init here
    } else {
        // img here
    } 
    ```

# c# - 如何在.Net MVC 中的不同类上添加按钮单击事件？

> ID：12325762
> 
> 赞同：0
> 
> 时间：2012-09-07T21:40:38.797
> 
> 标签：c#, asp.net, asp.net-mvc

我是 asp.net MVC 的新手，我想要一些简单的东西。我有一个`Index.aspx`页面和一个`UrlContent.cs`类。

我正在寻找如何编写`button_click`类中页面监听器的代码。到目前为止还没有在谷歌上找到任何东西。

就这些了，谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T21:51:23.227

MVC 是一个不同的范式，并没有真正的“事件监听器”的概念。

该概念始终是 Web 客户端/服务器真正通信方式的抽象。对于 Web 服务器，实际上只有一个事件，那就是来自客户端的 HTTP 请求。为了实现“事件”的错觉，ASP.Net 在幕后做了一些（Javascript+cookies）魔术，并`input`在标准 HTML 表单中创建隐藏的表单标签——包含有关单击哪个按钮的信息，并发布表单回到服务器。

MVC 更接近于 HTML/HTTP 的本机行为。它要求您习惯于使用这些技术——表单、GET/POST 请求和 AJAX。

* * *

要处理（提交表单）按钮单击事件，您需要在控制器中创建一个接受参数的操作。

**控制器**

```
[HttpPost]
public ActionResult Index(MyModel model)
{
    // handle the submit button's "click event" here
} 
```

**看法**

```
@model MyModel

@using (@Html.BeginForm("Index", "Home")) {
    @Html.EditorForModel
    <input type='submit' value='submit' />
}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T21:47:07.510

如果您正在运行 MVC，我认为您正在寻找类似的东西

```
@Html.ActionLink("Link Text", "Action method Name", "Controller name",new {} , new {}) 
```

[这是有关更多重载的一些文档。](http://msdn.microsoft.com/en-us/library/dd505040%28v=vs.108%29)

# csv - drive sdk 以 csv 格式插入电子表格

> ID：12325763
> 
> 赞同：1
> 
> 时间：2012-09-07T21:40:41.400
> 
> 标签：csv, upload, google-drive-api, google-sheets

我正在尝试将电子表格上传到 csv 文件的谷歌驱动器。

这是我的帖子网址 [https://www.googleapis.com/upload/drive/v2/files?uploadType=multipart&alt=json&convert=true](https://www.googleapis.com/upload/drive/v2/files?uploadType=multipart&alt=json&convert=true)

mimetype 设置为 mime：application/vnd.google-apps.spreadsheet

文件已上传，但我收到一条错误消息“很抱歉。找不到此 URL 的电子表格。请确保您拥有正确的 URL 并且电子表格的所有者没有删除它。”

我还尝试了 mimetype = "text/plain" ，它被转换为文档，而不是电子表格。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T04:43:49.110

mime 类型应为“text/csv”。

您可以尝试在[https://developers.google.com/drive/v2/reference/files/insert#try-it](https://developers.google.com/drive/v2/reference/files/insert#try-it)上传文件以快速尝试不同的设置。

# ruby-on-rails - heroku上的自定义时钟进程

> ID：12325772
> 
> 赞同：5
> 
> 时间：2012-09-07T21:41:24.300
> 
> 标签：ruby-on-rails, heroku, whenever

我刚刚继承了一个 Rails 项目，之前它位于典型的 'nix 服务器上。决定将其移至 Heroku 以供客户使用，由我来决定后台进程是否正常工作。目前它使用Whenever来安排日常事件（电子邮件等）并在启动时启动延迟的作业队列。

Heroku 提供了一个使用发条的自定义时钟过程的文档示例，我可以通过这个示例随时使用它吗？我可能会遇到什么陷阱？我需要创建一个单独的工人测功机吗？

[带有 Clockwork 的 Ruby 中的计划作业和自定义时钟进程](https://devcenter.heroku.com/articles/clock-processes-ruby)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-08T02:59:30.657

是的——Heroku 的 Cedar 堆栈让您可以随心所欲地运行。

Cedar 堆栈的基本构建块是测功机。每个 dyno 都会获得应用程序的临时副本、512 MB RAM 和大量共享 CPU 时间。Web dynos 应该将 HTTP 服务器绑定到`$PORT`环境变量中指定的端口，因为 Heroku 将在该端口发送 HTTP 请求，但除此之外，Web dynos 与其他类型的 dynos 相同。

您的应用程序通过在`Procfile`. （请参阅[使用 Procfile 声明和缩放进程类型](https://devcenter.heroku.com/articles/procfile)。）时钟进程文章演示了一种模式，您可以使用工作人员（即非 Web）测功机根据任意标准将工作排入队列。同样，您可以在这里做任何您想做的事情——只需在 Procfile 中定义它，Heroku 就会愉快地运行它。如果您使用时钟过程（例如 24x7 `whenever`），您将使用整个测功机（0.05 美元/小时）除了安排工作之外什么都不做。

在您的情况下，我会考虑从 When 切换到[Heroku Scheduler](https://devcenter.heroku.com/articles/scheduler)。调度程序基本上是 Heroku 运行的 cron，其中 crontab 条目是“启动测功机并运行此命令”。您仍然需要为额外的测功机支付 0.05 美元/小时，但与时钟 + 工人设置不同，您只需为他们实际运行的时间付费。它将周期性任务与稳定状态的 web + worker 流量清晰地分开，而且通常也便宜得多。

唯一的另一个警告是，在分布式系统中运行周期性任务很复杂，并且具有复杂的故障模式。一些平台事件（对应于大型 EC2 中断）导致了诸如 2 个同步时钟进程和重复调度程序运行之类的事情。如果您正在做一些需要连续运行的事情（例如每天给人们发一次电子邮件），请考虑使用 RDBMS 锁定来保护它，并仔细检查您的日常工作实际上已经过去了大约 23 个小时。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-01-31T18:49:04.160

Heroku Scheduler 对于生产使用来说通常是一个糟糕的选择，因为它[不可靠](https://devcenter.heroku.com/articles/scheduler#known-issues-and-alternatives)并且有时会跳过运行它的任务。

好消息是，如果您使用 Sidekiq 运行作业队列[dyno](https://github.com/mperham/sidekiq)，则可以使用调度插件，例如[sidekiq-cron](https://github.com/ondrejbartas/sidekiq-cron)。有了它，您可以使用相同的测功机进行调度。而且，如果您还没有作业工作者，那么如果您需要可靠地运行它，则需要将其设置为仅用于调度。

PS，如果您碰巧运行[Delayed::Job](https://github.com/collectiveidea/delayed_job)来处理排队的作业，那么也有针对它的调度插件，例如[这个](https://github.com/amitree/delayed_job_recurring)。

# c# - 拆箱修改项目集合

> ID：12325779
> 
> 赞同：1
> 
> 时间：2012-09-07T21:42:21.967
> 
> 标签：c#, winforms, unboxing

这个 Winforms 项目有问题。尝试在通过以下方式填充字典**propList**的组合框上使用 SelectedIndexChanged 事件：

```
comboBox1.DataSource = new BindingSource(propList, null);
comboBox1.DisplayMember = "Value";
comboBox1.ValueMember = "Key"; 
```

这是事件本身：

```
private void comboBox1_SelectedIndexChanged(object sender, EventArgs e)
{
    ComboBox comboBox = (ComboBox)sender;
    //comboBox.DataSource = null;
    System.Collections.Generic.KeyValuePair<int, string> dummy =
        (System.Collections.Generic.KeyValuePair<int, string>) 
            comboBox.SelectedItem;

    //comboBox1.DataSource = new BindingSource(propList, null);
    PopulateCollars(dummy.Key);
} 
```

然后它在 KeyValuePair 演员表上抛出这个：

```
Items collection cannot be modified when the DataSource property is set 
```

我知道这是适当的演员阵容，因为调试表明：

```
SelectedItem  ~~~  object System.Collections.Generic.KeyValuePair<int,string>} 
```

那么我的问题是，为什么显式转换会修改项目集合？在 C++ 上长大，其中强制转换不会修改他们正在强制转换的数据，这对我来说没有意义。

请注意，使用注释掉的行会导致空引用异常，因为显然将数据源设置为空会擦除组合框中的所有成员。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T21:58:23.653

无论如何，您是否在 PopulateCollars中修改了其中一个`dummy.Key`或自身？`dummy`由于我也从未见过演员更改对象的数据，因此该例程似乎更有可能是罪魁祸首。正如我在上面评论的那样，有时 VS 关于哪一行引发了错误是完全错误的。

ETA：好的，不是这样。这是一个想法。检查异常的堆栈跟踪，并查看您的方法和（在框架中）引发异常的方法之间是否有任何有趣的层。还要确保不会通过 PopulateCollars 中导致列表更改的某些内容递归调用此方法。

如果您在处理由组合框引起的更改时尝试将相同的组合框与其他数据重用，那可能行不通。

# c - 试图解析一个简单的字符串并逐字打印，得到 Bus Error: 10

> ID：12325781
> 
> 赞同：0
> 
> 时间：2012-09-07T21:42:34.943
> 
> 标签：c

正如标题所示，这应该很容易。我不明白为什么，但是当我运行它时出现 Bus error: 10。

这应该很容易！但我似乎无法解决它......呃。请帮忙。

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

main() {

char *string[20];
char buffer[256];

int wordCount = 0;

    while ((scanf("%s", buffer) != EOF)) {
        printf("%s%d\n", buffer, wordCount);
        string[wordCount++] = (char *) malloc (strlen(buffer)+1); 
        strcpy (string[wordCount], buffer);
    }

int j;

printf("There are %d words.\n", wordCount+1);

for (j = 0; j < wordCount; j++)
{

    printf("%s\n", string[j]);
}   
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T21:44:00.950

> ```
> string[wordCount++] = (char *) malloc (strlen(buffer)+1); 
> strcpy (string[wordCount], buffer); 
> ```

你分配给`string[wordCount]`然后你增加`wordCount`. 然后你继续到`strcpy`这个新的、未分配的元素，这是非法的。

改为`wordCount` **之后** 递增。`strcpy`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-08T04:42:55.240

您应该遇到的另一个问题是，如果您阅读超过 20 行，您将进行非法内存访问，因为您声明了一个具有 20 个位置的 char 指针数组：

字符*字符串[20]；

您应该重新考虑循环：

while ((scanf("%s", buffer) != EOF))

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-08T07:54:49.593

您应该检查数组（索引）溢出，例如：

```
int main() {

char *string[20];
char buffer[256];

int j, wordCount = 0;

    while (wordcount<20 && (scanf("%255s", buffer) == 1)) {  /* here */
        printf("%s%d\n", buffer, wordCount+1);
        strcpy( string[wordCount++] = malloc (strlen(buffer)+1, buffer ); 
    }

printf("There are %d words.\n", wordCount+1);

for (j = 0; j < wordCount; j++)
{

    printf("%s\n", string[j]);
}
  return 0;
} 
```

请注意，scanf 将在所有空格上中断，并且在所有 scanf/fgets(stdin) 操作之后清除输入缓冲区。

# android - Android SDK 安装错误

> ID：12325783
> 
> 赞同：4
> 
> 时间：2012-09-07T21:43:07.730
> 
> 标签：android

安装安卓 SDK。获得了 Eclipse Juno（最新版本）。安装时遇到了一些小问题，但设法克服了这些问题。但是现在我有一个我无法完成的工作。我已经下载了 Eclipse ADT 插件。当我重新启动 Eclipse 时，它​​给了我这个错误：“这个版本的 ADT 需要 Android SDK Tools 版本 20.0.0 或更高版本。当前版本是 16.0.0。请将您的 SDK 工具更新到最新版本。” 错误对话框为我提供了一个打开 SDK 管理器的按钮，我使用了该按钮。它打开 SDK 管理器并找到我需要的新包。当我去安装它们时，我得到另一个错误。日志说：

```
"Failed to rename directory C:\Program Files (x86)\Android\android-sdk\platform-tools to 
C:\Program Files (x86)\Android\android-sdk\temp\PlatformToolPackage.old01." 
```

并弹出一个对话框，告诉我它无法重命名文件夹以及尝试使其工作的方法。它从来没有用过，我不得不取消一切回到 Eclipse（我仍然对我没有最新的东西感到恼火）。

我试过重启等等，但它没有帮助。我尝试以管理员身份运行 SDK 管理器，但是当我这样做时，它认为它拥有所有最新的东西（奇怪）并且不想下载任何东西。

仅供参考，我有第 16 版的 Android SDK 工具（它需要 20 个）和第 10 版的 Android SDK 平台工具（它需要 12 个）。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T13:19:29.130

Did you start eclipse as an Administrator? If not, try it, sometimes eclipse just installing updates if you are an admin. If I update SDK, I first start SDK-Manager without eclipse to install updates. After this is done, I am doing the same in eclipse. Always do this as an admin.

# c++ - 从 Mingw 程序调用 Visual Studio DLL 时导致崩溃

> ID：12325784
> 
> 赞同：1
> 
> 时间：2012-09-07T21:43:20.670
> 
> 标签：c++, linux, dll

基本上，我有一个在 Visual Studio 中编写的 DLL（编译为 C！）：

```
#ifdef __cplusplus
extern "C" {
#endif

extern __declspec(dllexport) int my_dll_test();

#ifdef __cplusplus
}
#endif 
```

源文件在包含头文件后，简单地说：

```
int my_dll_test()
{
  return 0;
} 
```

然后我尝试从使用 Mingw 编译的 C++ 程序中调用它。一旦我调用该函数或任何其他函数，整个程序就会出现段错误而没有任何警告。我知道这似乎是一件非常奇怪的事情，而且这是一个很长的故事。但是我不明白为什么这么简单的DLL在调用时会崩溃。

# html - 设置 HTML5 音频事件“timeupdate”的粒度

> ID：12325787
> 
> 赞同：30
> 
> 时间：2012-09-07T21:43:35.167
> 
> 标签：html, html5-audio

我正在尝试使用 HTML5 音频创建一个简单的循环功能，并有一个非常原始的解决方案，如下所示：

```
$(audio).bind('timeupdate', function() {
  if (audio.currentTime >= 26){
    var blah = audio.currentTime; 
    audio.currentTime = 23;
    console.log(blah);
  }
}) 
```

这工作正常，但这里唯一的故障是 timeupdate 事件不会非常一致地触发。比如上面的console.log返回：26.14031982421875

26.229642868041992

26.13462257385254

26.21796226501465

...ETC。（你明白了..不一致的时间）

显然，这不适用于时间很重要的应用程序（音乐应用程序）。所以对我来说显而易见的解决方案是增加触发 timeupdate 事件的粒度。我还没有找到任何 API 文档......但很想知道是否有办法做到这一点。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2014-01-27T16:06:41.967

应该注意的是，您*可以*更频繁地阅读视频的 currentTime 属性。如果时间真的很关键，你可以忍受一点不确定性，你可以试试这个。

然而，它比使用标签自己的`timeupdate`事件要优雅得多。

```
setInterval(function () {
    console.log(audio.currentTime); // will get you a lot more updates.
}, 30); 
```

在这种情况下，您必须自己管理间隔，确保在`null`设置音频元素之前清除它。但这*是*一种可能。

我在视频元素上使用了这种方法，但它也应该在这里应用。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2012-09-07T22:00:32.647

我很抱歉，但这就是它的工作方式。从[html5 规范](http://dev.w3.org/html5/spec/single-page.html#mediacontroller)：

> 每隔 15 到 250 毫秒，或者每当 MediaController 的媒体控制器位置发生变化时（以最不频繁发生的为准），用户代理必须排队一个任务以在 MediaController 上触发一个名为 timeupdate 的简单事件。

还，

> 因此，事件的触发速度不会超过大约 66Hz 或低于 4Hz（假设事件处理程序的运行时间不超过 250ms）。鼓励用户代理根据系统负载和每次处理事件的平均成本来改变事件的频率，这样 UI 更新不会比用户代理在解码视频时可以轻松处理的频率高。

如果您通读规范，您会认为`timeupdate`事件是某种“尽力而为”的事件。只要它不会对性能产生太大影响，它就会在可能的情况下并且总是会触发。

您可以过滤不时丢弃一些事件以平滑到达时间，但恐怕不能反其道而行之。

# objective-c - 核心情节：异常“x 和 y 值的数量不匹配”

> ID：12325790
> 
> 赞同：1
> 
> 时间：2012-09-07T21:43:49.080
> 
> 标签：objective-c, ios, core-plot

我无法找到有关此的大量信息，并且我以任何方式都没有运气，我试图缩小这个问题的来源，所以我希望这里有人可以给我更多信息和潜力导致我可能会收到此错误。

我正在实时绘制数据集，因为数据集通过我不断接收新数据而不断增加。当我收到新数据时，我会花时间将其作为 x 并将值本身作为 y，这就是我生成积分的方式。

完全错误：由于未捕获的异常而终止应用程序`'CPTException', reason: 'Number of x and y values do not match'`

我在崩溃前查看了我的数据集，我确保我的点创建从未失败过，也没有任何问题。我猜此时这与我的散点图版本有关，可能在 numberOfRecordsForPlot 函数中。但是，它似乎并没有在该功能的任何地方崩溃。崩溃通常在 10 多秒后才会发生，但它再次不一致，并且在它崩溃并且正在完美地工作绘图之前。

非常感谢人们对此有所了解。

PS：如果人们想看代码，请告诉我，任何非标准的我已经验证可以尽我所能发挥作用，与散点图有关的任何事情都是相当标准的。

```
-(NSUInteger)numberOfRecordsForPlot:(CPTPlot *)plot 
{
    //Translation: The array with key of the top of the first selected parameter
    NSInteger curCount = [self.graphParams count];
    NSLog(@"Current Count: %d", curCount);

    if ([plot.identifier isEqual:@"Sel_1"] && (curCount >= 1) ) {
        if ([self.graphParams objectAtIndex: 0] != nil) {
            //NSString *myText = ((UITableViewCell *)[self.graphParams objectAtIndex: 0]).textLabel.text;
            //NSInteger myNum = [[self.graphData objectForKey: myText] count];
            //return [[self.graphData objectForKey: myText] count];
            //return [[self.graphData objectForKey: ((UITableViewCell *)[self.graphParams objectAtIndex: 0]).textLabel.text] count];
            return [[self.graphData objectForKey: [self.graphParams objectAtIndex: 0]] count];
        }
        else 
            return 0;  
    }
    else if ([plot.identifier isEqual:@"Sel_2"] && (curCount >= 2) ) {
        if ([self.graphParams objectAtIndex: 1] != nil)
            //return [[self.graphData objectForKey: ((UITableViewCell *)[self.graphParams objectAtIndex: 1]).textLabel.text] count];
            return [[self.graphData objectForKey: [self.graphParams objectAtIndex: 1]] count];
        else 
            return 0;
    }
    else if ([plot.identifier isEqual:@"Sel_3"] && (curCount >= 3) ) {
        if ([self.graphParams objectAtIndex: 2] != nil)
            //return [[self.graphData objectForKey: ((UITableViewCell *)[self.graphParams objectAtIndex: 2]).textLabel.text] count];    
            return [[self.graphData objectForKey: [self.graphParams objectAtIndex: 2]] count];
        else
            return 0;
    }

    return 0;
}

-(NSNumber *)numberForPlot:(CPTPlot *)plot field:(NSUInteger)fieldEnum recordIndex:(NSUInteger)index
{
    //Translation: The array with key of the top of the first selected parameter
    NSValue *value = nil;

    if ( [plot.identifier isEqual:@"Sel_1"] ) {
        value = [[self.graphData objectForKey: [self.graphParams objectAtIndex:0]] objectAtIndex:index];
    }
    else if ( [plot.identifier isEqual:@"Sel_2"] ) {
        value = [[self.graphData objectForKey: [self.graphParams objectAtIndex: 1]] objectAtIndex:index];    
    }
    else if ( [plot.identifier isEqual:@"Sel_3"] ) {
        value = [[self.graphData objectForKey: [self.graphParams objectAtIndex: 2]] objectAtIndex:index];    
    }

    if (value != nil)
    {
        CGPoint point = [value CGPointValue];
        if ( fieldEnum == CPTScatterPlotFieldX )
            return [NSNumber numberWithFloat:point.x];
        else if ( fieldEnum == CPTScatterPlotFieldY )
            return [NSNumber numberWithFloat:point.y];
    }

    return [NSNumber numberWithFloat:0];
} 
```

编辑：发布了一些我认为错误可能来自的散点图代码，但我不知道这对你们中的任何人有多大用处。一如既往地评论额外的请求，我很乐意提供任何有意义的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T21:14:46.163

1.  `graphData`确保对字典及其内容的所有访问都是线程安全的。Core Plot 在主线程上进行所有数据源访问和绘图。

2.  始终从主线程调用`-reloadData`、和其他 Core Plot 方法。`-insertDataAtIndex:numberOfRecords:`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T00:06:45.927

我也看到了这个。绘制图形时发生异常，而不是调用任何数据源函数。

```
x 和 y 值的数量不匹配
(
    0 核心基础 0x00007fff88f4df56 __exceptionPreprocess + 198
    1 libobjc.A.dylib 0x00007fff851cfd5e objc_exception_throw + 43
    2 核心基础 0x00007fff88f4dd8a +[NSException raise:format:arguments:] + 106
    3 核心基础 0x00007fff88f4dd14 +[NSException raise:format:] + 116
    4 CorePlot 0x0000000100027c31-[CPTScatterPlot renderAsVectorInContext:] + 561
    5 CorePlot 0x000000010004dd50 -[CPTLayer drawInContext:] + 96
    6 核心绘图 0x000000010001d023 -[CPTPlot drawInContext:] + 99
    7 石英核心 0x00007fff8a673701 CABackingStoreUpdate_ + 3221
    8 石英核心 0x00007fff8a672616 _ZN2CA5Layer8display_Ev + 1086
    9 石英核心 0x00007fff8a66a4e6 _ZN2CA5Layer17display_if_neededEPNS_11TransactionE + 560
    10 石英核心 0x00007fff8a66949b _ZN2CA7Context18commit_transactionEPNS_11TransactionE + 319
    11 石英核心 0x00007fff8a669218 _ZN2CA11Transaction6commitEv + 274
    12 石英核心 0x00007fff8a668819 _ZN2CA11Transaction17observer_callbackEP19__CFRunLoopObservermPv + 63
    13 核心基础 0x00007fff88f0d8e7 __CFRUNLOOP_IS_CALLING_OUT_TO_AN_OBSERVER_CALLBACK_FUNCTION__ + 23
    14 核心基础 0x00007fff88f0d846 __CFRunLoopDoObservers + 374
    15 核心基础 0x00007fff88ee24a2 CFRunLoopRunSpecific + 258
    16 HIToolbox 0x00007fff8d59c4d3 RunCurrentEventLoopInMode + 277
    17 HIToolbox 0x00007fff8d5a3781 ReceiveNextEventCommon + 355
    18 HIToolbox 0x00007fff8d5a360e BlockUntilNextEventMatchingListInMode + 62
    19 AppKit 0x00007fff87df4e31 _DPSNextEvent + 659
    20 AppKit 0x00007fff87df4735-[NSApplication nextEventMatchingMask:untilDate:inMode:dequeue:] + 135
    21 AppKit 0x00007fff87df1071-[NSApplication 运行] + 470
    22 AppKit 0x00007fff8806d244 NSApplicationMain + 867
    23 0x0000000100001a62 主要 + 34
    24 0x0000000100001a34 开始 + 52
)

```

我的应用程序也是多线程的，但我确保在主线程中调用了 [thePlot setDataNeedsReloading]，并且我确保在主线程中调用了我的所有数据源回调。

我敢肯定，CorePlot 以某种方式进行了两次调用来获取我的数据，并且我在这两次调用之间添加了更多数据，CorePlot 很困惑。

# javascript - javascript 属性访问器

> ID：12325791
> 
> 赞同：12
> 
> 时间：2012-09-07T21:43:55.520
> 
> 标签：javascript, accessor

在 Javascript 中，使用属性访问器似乎并不常见（与其他 OO 语言不同，例如 Java）。

如果我有`Person`一个名称的对象，定义为

```
function Person(name) {
   this.name = name;
} 
```

一个人的名字不会改变，但我确实希望能够在需要时访问它，所以我可以执行以下操作：

```
function Person(name) {
   var name = name;
   this.getName = function() {
      return name;
   }
} 
```

即使在动态语言中，我认为使用 getter 和 setter 的原则也适用于静态类型的 OO 语言（例如封装、添加验证、限制访问等）

这个问题可能会因为主观而被关闭，但我很好奇为什么这种行为不会更频繁地出现（例如，如果一切都是公开的，Java 开发人员会发疯）。

在javascript中是否有“标准”方法来做到这一点？我见过`Object.defineProperty`，但并非所有浏览器都支持。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-07T21:48:15.473

Javascript 具有可拦截的属性访问器：

[http://ejohn.org/blog/javascript-getters-and-setters/](http://ejohn.org/blog/javascript-getters-and-setters/)

恕我直言，这是一个比 Java 更严格的显式 getter 执行统一访问原则更好的解决方案，但这也是该语言简单性和不灵活性的一部分（例如 Groovy 允许类似的拦截）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-07T21:54:08.277

我知道我对这个问题的想法。

getter 和 setter 是邪恶的。

等待！真的！请耐心等待，让我解释一下。

仅仅使用一种方法来获取和设置一个值是..好吧..有点毫无意义。它没有保护，不是真的，你投入的就是你得到的。

另一方面，我更喜欢将信息放入，然后将信息取出的方法。但这是神奇的部分！这不是相同的信息。不是直接的。

```
function Person(name) {
  this.getFullName = function() {return this.firstName + " " + this.lastName;};
  this.setBirthday = function(date) { this.birthday = date; };

  this.getAge = function() { /* Return age based on the birthday */ };
  this.isOfLegalDrinkingAge function() { /* do your math here too */ };
} 
```

但大多数时候我只是将静态数据推入并取出静态数据。将它隐藏在 getter 和 setter 后面有什么意义？

作为次要原因，在处理 DOM 和大多数宿主对象时，您需要设置属性。你不玩 getter 和 setter。不使用它们符合 JS 编码员所做的其他“风格”。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-07T21:52:23.043

我认为答案是在 javascript 中模拟类并不是常见的做法，因为该语言实际上是原型语言。

尽管可以创建类结构（如您的示例中），但它们并不像 java 类，并且作为程序员，您最终会与细微差别作斗争。

但是，如果您接受了 javascript 的原型特性，那么您将获得该语言的一种不同但又具有凝聚力且简单的结构。

不必使用具有原型结构的 getter 和 setter，因为您可以简单地设置一个对象，好吧，将其设置为一个值，然后通过调用它作为一个值来获取它。

Javascript 不会强迫您编写结构化代码，也不会阻止您这样做。我认为围绕 javascript 发展起来的文化已经形成了一种很好的编码风格，这是完全有效的，并且与我使用的任何其他语言都不同。

我知道这个答案不是确定的，也不是决定性的，但希望其中有一些想法可以帮助您找到您正在寻找的分析器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T21:56:06.980

如果我没有正确理解这个问题，我深表歉意，但自我执行功能是使成员公开/私有的一种方式

```
var Person = function(){
  var _name = "Roger",
      self = { getName : function (){ return _name; }};
  return self;
}() 
```

然后，您可以从任何地方访问 Person.getName()，但不能设置 _name。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-05-16T10:41:48.007

这是我用于本地字段的：

```
TYPE_DEFAULT_VALUE= {
    number: 0,
    string: "",
    array: [],
    object: {},
};

typeOf = function (object) {
    if (typeof object === "number" && isNaN(object))
        return NaN;
    try {
        return Object.prototype.toString.call(object).slice(8, -1).toLowerCase();
    }
    catch(ex) {
        return "N/A";
    };
};

getAccessor = function(obj, key, type, defaultValue) {
    if (defaultValue === undefined) 
        defaultValue =  TYPE_DEFAULT_VALUE[type] === undefined ? null : TYPE_DEFAULT_VALUE[type];
    return {
        enumerable: true,
        configurable: true,
        get: function () {
            if (obj[key] === undefined) 
                obj[key] = defaultValue;
            return obj[key];
        },
        set: function (value) {
            if (typeOf(value) === type)
                obj[key] = value;
        },
    };
}

LocalFields = function (fields, object) {
    /**
    * field properties
    * { 
    *   type: [ required ] ( number | string | array | object | ... ),
    *   defaultValue: [ optional ]
    * }
    */
    if (! fields)
        throw "Too few parameters ...";
    if (! object) 
        object = this;

    var obj = this;
    var fieldsAccessor = {};
    for(key in fields){
        field = fields[key];
        fieldHandler = key[0].toUpperCase() + key.substr(1);
        if(! field.type)
            throw "Type not set for field: " + key;

        fieldsAccessor[fieldHandler] = getAccessor(obj, fieldHandler, field.type, field.defaultValue)
    }
    Object.defineProperties(object, fieldsAccessor);
} 
```

现在对于每个类，我可以调用如下内容：

```
Person = function(){
    new LocalFields({
        id:     { type: "number" },
        name:   { type: "string" },
    }, this);
} 
```

然后像 VS getter 和 setter 一样调用：

```
var alex = new Person();
alex.Name = "Alex Ramsi";
console.clear();
console.info(alex.Name); 
```

# macos - 我应该在 Mac 应用程序上使用 Growl 吗？

> ID：12325796
> 
> 赞同：4
> 
> 时间：2012-09-07T21:44:21.700
> 
> 标签：macos, cocoa, notifications, growl

我为 mac 设计了一个应用程序（可可中的新功能），我需要在监视器上使用通知。我打算实施咆哮。但我看到现在 App Store 上的咆哮不是免费的。所以我想知道它是否仍将是 Mac 上的默认通知管理器。

那么你认为我应该使用 Growl 来通知我的屏幕通知吗？如果没有其他建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T21:53:59.987

它不是免费的，但是您可以下载一个独立的 Growl 库，该库允许您的应用程序显示 Growl 通知，而无需在用户的 Mac 上实际安装 Growl。

有关更多信息，请参阅 Growl 的网站。

话虽如此，是的，推荐使用咆哮，因为它很熟悉。但是，如果您要支持 Mac OS X 10.8+，我会说只使用新的通知中心。

# python - 如何为 N 骰子生成“先行”骰子？

> ID：12325797
> 
> 赞同：9
> 
> 时间：2012-09-07T21:44:28.513
> 
> 标签：python, math, dice

## 背景

如此处所述[http://www.ericharshbarger.org/dice/#gofirst_4d12](http://www.ericharshbarger.org/dice/#gofirst_4d12)，“先走”骰子是一组四个骰子，每个骰子都有唯一的编号，因此：

*   任何两个或更多骰子的掷骰都不会导致平局。
*   任何骰子与该组中的任何其他骰子掷出的骰子都有相同的机会“赢/输”该骰子。

以下是提到的四个骰子的编号：

```
DICE COUNT: 4
FACE COUNT: 12
D1: 1,8,11,14,19,22,27,30,35,38,41,48
D2: 2,7,10,15,18,23,26,31,34,39,42,47
D3: 3,6,12,13,17,24,25,32,36,37,43,46
D4: 4,5, 9,16,20,21,28,29,33,40,44,45 
```

[（通过）](http://www.ericharshbarger.org/dice/4d12_fairness_report.txt)

## 问题

我讨厌数学。我难住了。鉴于上述信息，**我希望能够在给定多个骰子的情况下生成整数列表（“骰子”）。**这样，示例输出可能如下所示（格式化，python 控制台）：

```
 >>> generate_dice(players=4)
    [[1,8,11,14,19,22,27,30,35,38,41,48],
     [2,7,10,15,18,23,26,31,34,39,42,47],
     [3,6,12,13,17,24,25,32,36,37,43,46],
     [4,5,9,16,20,21,28,29,33,40,44,45]] 
```

此处选择的边数仅出于示例目的，因为它与给出的其他示例相匹配。每个模具的“公平性”确实是我正在寻找的。

我向你保证这不是家庭作业。这只是一个坚定的极客，对一个看似微不足道的谜题感到恼火，只是不会让我一个人呆着......而且由于某种原因，我似乎无法正确解决问题。

我确信这里有一些相对微不足道的数学和基本算法，这就是我正在寻找的。如果这对您来说很明显，我应该搜索什么术语？因为对我来说，不是。

理想情况下，解决方案是 Python，但我也可以很好地阅读 PHP、Javascript、一些 Ruby。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-08T21:53:48.233

这是一个（计算上）困难的问题。乍一看，每个骰子的预期值相同是不够的（尽管奇怪的是，在您给出的示例中）。每个 die 必须在每个 die 元素的点积的所有实例的 50% 上“获胜”。

这篇文章提到一位数学家生成了您“手动”给出的示例，这一事实让我在建议以下蛮力方法时更加自在：

```
import itertools

nplayers=4
nsides=2
max_number=8

assert nplayers*nsides <= max_number
assert nsides % 2 == 0 #otherwise x^x (dot product) is not even, so half_wins_fairness always fails

iterations=[]
def half_wins_fairness( dice1,dice2 ):
    dice1_wins= map( lambda x: x[0]>x[1], itertools.product(dice1,dice2) )
    dice_wins_prob= float(sum(dice1_wins))/len(dice1_wins)
    #probs.append(dice_wins_prob)
    return dice_wins_prob==0.5

def fair( all_dice ):
    all_fair= True
    for d1,d2 in itertools.combinations( all_dice, 2):
        if not half_wins_fairness(d1,d2):
            all_fair=False
    return all_fair

for i,dice_pattern in enumerate(itertools.permutations(range(max_number), nplayers*nsides)):
    #cut dice pattern into dices
    dice= [dice_pattern[p*nsides:(p+1)*nsides] for p in range(nplayers)]
    if fair(dice):
        print dice
        iterations.append(i)

def discrete_derivative(l):
    last=0
    for i,x in enumerate(l):
        tmp= x
        l[i]=x-last
        last=tmp

#discrete_derivative(iterations)
#import pylab
#pylab.plot(iterations)
#pylab.show() 
```

这里的复杂性是 n^n，所以这本身只能解决你的问题，因为 nplayers 和 nsides 的数量非常少。但是，通过取消注释注释行，您可以检查骰子沿点积迭代的公平性图，该图似乎有很多模式，这表明可以使用几种启发式方法来加快搜索速度，甚至可能找到一个通用的解决方案。

**编辑**

更改了代码以改进图形。这是一些图片，以防有人特别擅长发现模式。

nplayers=2, nsides=2, max_number=8 ![nplayers=2, nsides=2, max_number=8](../Images/bf7ce9156b28aba88e71906181ce1558.png) nplayers=2, nsides=4, max_number=8 ![nplayers=2, nsides=4, max_number=8](../Images/fa3f6cdadb65e1d79396d7e063b7b166.png) nplayers=4, nsides=2, max_number=8 ![nplayers=4, nsides=2, max_number=8](../Images/38462971f3935f562687e301b3835918.png)

一些初步观察：

1.  这是对称的
2.  当 max_number % (nplayers*nsides) == 0 时，似乎生成了“最干净”的图表

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-09T01:29:44.520

作为记录，这个答案`codegolf`有一个简单的算法，似乎至少在骰子上的边数是偶数的任何时候都有效：[https ://codegolf.stackexchange.com/a/7238/5376](https://codegolf.stackexchange.com/a/7238/5376)

```
def generate_dice(count, sides = 12):
  dice = []
  for i in range(count):
    dice.append([])

  value = 0
  for sindex in range(sides):
    if sindex % 2:
      for dindex in range(count):
        value += 1
        dice[dindex].append(value)
    else:
      for dindex in reversed(range(count)):
        value += 1
        dice[dindex].append(value)
  return dice 
```

# python - 无法使用 Boto 在 DynamoDB 中将浮点数作为 range_keys 插入

> ID：12325802
> 
> 赞同：0
> 
> 时间：2012-09-07T21:45:10.827
> 
> 标签：python, boto, amazon-dynamodb

当我尝试插入包含多于 2 位小数的 range_key 时，存储在数据库中的数字将被截断为前 2 位小数。

我该如何解决这个问题？

```
 max_number = 1000000.0
    random_time = random.randrange(1, max_number-1) / max_number
    range_key = int(time.time()) + random_time
    data['item_id'] = '12345'
    result = db.add(table='media', key=group_id,
                    range_key = range_key,
                    data=data) 
```

“1347053744.819199”的结果 range_key 被插入为“1347053744.82”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T22:23:04.413

更新：

这实际上是boto中的一个bug，跟踪见[https://github.com/boto/boto/pull/890#issuecomment-8456495](https://github.com/boto/boto/pull/890#issuecomment-8456495)

原始答案：

你为什么用它`add`来存储一个新项目？`add`是原子增量的函数。你应该`put_item`改用。

我不知道为什么你的浮点数是圆形的，但无论如何，你真的不应该尝试它。使用浮点数作为键是一种不好的做法。不可能可靠地检查浮点数是否相等，因为它们本质上是近似值。请参阅[http://www.cygnus-software.com/papers/comparingfloats/comparingfloats.html](http://www.cygnus-software.com/papers/comparingfloats/comparingfloats.html)以深入了解浮点数。

尽管如此，如果你*真的*需要浮点数作为键，你需要完全控制那里的表示，以便在反序列化请求的 JSON 时不依赖于服务器端的实现。您需要用常规字符串替换它。

# c# - 从 StackPanel 中删除所有子元素

> ID：12325810
> 
> 赞同：16
> 
> 时间：2012-09-07T21:45:52.540
> 
> 标签：c#, windows-phone

我有以下 xaml 代码：

```
//some code
<ListBox>
<StackPanel Name="Mess">
</StackPanel>
</ListBox> 
```

然后我将元素添加到`StackPanel`.

但在特定时刻，我需要删除`Mess`. 我该怎么做？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-09-07T21:48:13.787

请试试

```
Mess.Children.Clear(); 
```

# php - 套接字关闭时间过长

> ID：12325814
> 
> 赞同：3
> 
> 时间：2012-09-07T21:46:13.370
> 
> 标签：php, sockets, minecraft

我有套接字在我的应用程序的几个页面上查询游戏服务器。我有一个问题，当我在页面之间导航太快时，套接字没有正确关闭，我得到的错误是这样的；

```
socket_recv() [function.socket-recv]: unable to read from socket [104]: Connection reset by peer 
```

在每个页面完全加载后，我必须等待大约 4-5 秒才能关闭。

这是套接字的代码；

```
function QueryMinecraft( $IP, $Port, $Timeout =1 )
{
    $Socket = Socket_Create( AF_INET, SOCK_STREAM, SOL_TCP );

    Socket_Set_Option( $Socket, SOL_SOCKET, SO_SNDTIMEO, array( 'sec' => (int)$Timeout, 'usec' => 0 ) );

    if( $Socket === FALSE || @Socket_Connect( $Socket, $IP, (int)$Port ) === FALSE )
    {
        Socket_Close( $Socket );
        return FALSE;
    } else {
        Socket_Close( $Socket );
        return TRUE;
    }      
    Socket_Close( $Socket );                  
} 
```

这是另一页上套接字的代码；

```
function QueryMinecraft( $IP, $Port, $Timeout = 3 )
{
    $Socket = Socket_Create( AF_INET, SOCK_STREAM, SOL_TCP );

    Socket_Set_Option( $Socket, SOL_SOCKET, SO_SNDTIMEO, array( 'sec' => (int)$Timeout, 'usec' => 0 ) );

    if( $Socket === FALSE || @Socket_Connect( $Socket, $IP, (int)$Port ) === FALSE )
    {
        return FALSE;
    }

    Socket_Send( $Socket, "\xFE", 1, 0 );
    $Len = Socket_Recv( $Socket, $Data,256, 0 );

    if( $Len < 4 || $Data[ 0 ] != "\xFF" )
    {
        return FALSE;
    }

    $Data = SubStr( $Data, 3 );
    $Data = iconv( 'UTF-16BE', 'UTF-8', $Data );
    $Data = Explode( "\xA7", $Data );

    return Array(
        'HostName'   => SubStr( $Data[ 0 ], 0, -1 ),
        'Players'    => isset( $Data[ 1 ] ) ? IntVal( $Data[ 1 ] ) : 0,
        'MaxPlayers' => isset( $Data[ 2 ] ) ? IntVal( $Data[ 2 ] ) : 0
    );
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T21:53:01.493

呜呼，具体知识我知道很多！应该有一个我的世界标签。

我相信这实际上是我的世界服务器限制，而不是你的 php 代码的问题。您可能会注意到，如果您正在使用 minecraft 客户端并且您多次快速访问多人游戏页面，您将遇到相同的问题（连接到服务器以查询玩家人数和 MOTD 将被拒绝）。如果您在两次访问之间等待 5 或 6 秒，它会自行解决。

因此，您的解决方案可能是将来自服务器的响应缓存 10 秒或 30 秒左右，以便服务器不会拒绝它们。

我不知道您是否有可以使用的本地 SQL 数据库，但是您应该能够为自己设置一个包含服务器 ip 的表（不是主机名，不能保证是唯一的。IP 也不是但这是一个更好的选择）、MOTD、当前和最大玩家以及最后检查的时间戳。您可以简单地进行数据库查询，检查时间戳以确保缓存值未过期，如果已过期，则直接查询服务器并将结果存储在数据库中。

# php - 在 PHP 中获取 XML 属性

> ID：12325821
> 
> 赞同：0
> 
> 时间：2012-09-07T21:47:29.553
> 
> 标签：php, xml, simplexml

看了其他一些关于此的 SO 帖子，但没有任何乐趣。

我有这个代码：

```
$url = "http://itunes.apple.com/us/rss/toppaidapplications/limit=10/genre=6014/xml";
$string = file_get_contents($url);
$string = preg_replace("/(<\/?)(\w+):([^>]*>)/", "$1$2$3", $string);
$xml = simplexml_load_string($string);

foreach ($xml->entry as $val) {
    echo "RESULTS: " . $val->attributes() . "\n"; 
```

但我无法得到任何结果。我特别有兴趣在此片段中获取 ID 值，即 549592189：

```
<id im:id="549592189" im:bundleId="com.activision.wipeout">http://itunes.apple.com/us/app/wipeout/id549592189?mt=8&amp;uo=2</id> 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T22:05:14.177

尝试`xpath`：

```
$doc     = new DOMDocument;
@$doc->loadHTML($string);
$xpath   = new DOMXpath($doc);
$r       = $xpath->query("//id/@im:id");
$id      = $r->item(0)->value; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T22:11:57.880

SimpleXML 为您提供了深入研究 XML 结构并获取所需元素的简单方法。不需要正则表达式，不管它做什么。

```
<?php

// Load XML
$url = "http://itunes.apple.com/us/rss/toppaidapplications/limit=10/genre=6014/xml";
$string = file_get_contents($url);
$xml = new SimpleXMLElement($string);

// Get the entries
$entries = $xml->entry;

foreach($entries as $e){
    // Get each entriy's id
    $id = $e->id;
    // Get the attributes
    // ID is in the "im" namespace
    $attr = $id->attributes('im', TRUE);
    // echo id
    echo $attr['id'].'<br/>';
} 
```

演示：[http ://codepad.viper-7.com/qNo7gs](http://codepad.viper-7.com/qNo7gs)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-04T19:43:58.617

尝试：

```
$sxml = new SimpleXMLElement($url);
for($i = 0;$i <=10;$i++){
$appid= $sxml->entry[$i]->id->attributes("im",TRUE);
echo $appid;
} 
```

# ruby - Ruby：使用元数据创建文件

> ID：12325822
> 
> 赞同：1
> 
> 时间：2012-09-07T21:47:30.200
> 
> 标签：ruby, unix, metadata

我们正在创建一个应用程序，它将在 *nix 系统上生成一些带有散列文件名的文本文件，以避免文件名过长。

但是，最好用一些元数据标记文件，以便更好地了解它们的内容是什么。

因此我的问题。有没有人有在 Ruby 中使用自定义元数据创建文件的经验？

我做了一些搜索，似乎有一些（非常古老的）宝石可以读取元数据： [https ://github.com/kig/metadata](https://github.com/kig/metadata) [http://oai.rubyforge.org/](http://oai.rubyforge.org/)

我还发现：[系统文件、读写或创建自定义元数据或扩展属性](https://stackoverflow.com/questions/9979864/system-file-read-write-o-create-custom-metadata-or-attributes-extended)，这似乎表明我需要的可能是系统级别的，但在那里下降感觉又脏又可怕。

任何人都知道可以实现这一目标的图书馆吗？如何为 Ruby 生成的文件创建自定义元数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2021-12-16T00:39:21.913

一个非常古老但有趣的问题，没有答案！

为了使文件包含元数据，它必须具有某种格式（隐式或显式）来描述元数据的存储位置和方式。

这可以通过格式来完成，例如具有说明“主要”数据存储在哪里以及“元数据”存储在哪里的标题，或者可能是隐式的，例如具有“主要”数据的长度，并存储元数据作为“主要”数据之外的任何内容。

这也可以由操作系统/文件系统通过将信息与文件一起存储来完成，例如权限信息、修改时间、用户以及更全面的文件信息，例如 iOS/Windows 中的“图标”。

（请注意，我在“main”和“metadata”周围使用“引号”，因为现实情况是它都是数据，需要以某种方式存储，以便工具可以检索它）

*真正*的文本文件不包含任何标题或任何此类文件格式，本质上只是一个连续的字符块（不管操作系统如何存储它）。这也意味着它通常可以由任何文本编辑器打开，它只会读取并显示它找到的所有字符。

所以从某种意义上说，答案是你不能，至少不能在真正可移植到多个操作系统的真正文本文件上。

关于如何解决这个问题的一些想法：

在文本文件的末尾使用二进制文件，希望/要求他们的文本编辑器将忽略非 ascii。

将其存储在文件的操作系统元数据中并使其特定于操作系统（例如将其存储在操作系统可能对文件具有的“注释”部分中。

将其存储在与文件“一起”的单独文件中（即，file.txt 和 file.meta），并希望它们将文件保存在一起。

将其存储在一个单独的文件中，并将文本和元文件压缩在一起，让您的工具能够识别 zip。

想出一种新的文件格式，它*不仅*是文本，而且有一个文本部分（尽管它不能再用文本编辑器编辑）。

将元数据以文本格式存储在文本文件的末尾，可能带有注释或一些指示符，以单独保留元数据。这类似于 vi/vim 文本编辑器用于将 vim 命令嵌入文件的技术，它只是将它们作为注释放在文件的开头或结尾。

我不确定还有很多其他方法可以完成您想要的，但也许其中一种会起作用。

# visual-c++ - 看似不必要的循环

> ID：12325825
> 
> 赞同：3
> 
> 时间：2012-09-07T21:47:52.650
> 
> 标签：visual-c++, assembly, x86

这是从（可能）使用 MSVC 创建的 x86 exe 反汇编而来的。
这些循环的任何原因还是它们只是膨胀？

```
00428D08   |> B9 02000000    MOV ECX,2
00428D0D   |> 33C0           /XOR EAX,EAX
00428D0F   |> 8BF0           |/MOV ESI,EAX
00428D11   |. 48             ||DEC EAX
00428D12   |. 83F8 E9        ||CMP EAX,-17
00428D15   |.^7F F8          |\JG SHORT File.00428D0F
00428D17   |. 49             |DEC ECX
00428D18   |.^75 F3          \JNZ SHORT File.00428D0D 
```

`ESI`后来在某种跳表中使用，但在我看来，这似乎是一种过于复杂的设置`ESI`两次的方法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T22:41:08.243

如果没有额外的入口点并且没有自修改代码，则可以通过一种独特的方式遍历代码：

```
mov ecx,2              ; ecx = 2
xor eax,eax            ; eax = 0, ecx = 2, SF = 0, ZF = 0
mov esi,eax            ; eax = 0, ecx = 2, esi = 0, no changes to flags
dec eax                ; eax = 0xFFFFFFFF, ecx = 2, esi = 0, SF = 1, ZF = 0
cmp eax,-17            ; OF = 0, SF = 1, ZF = 0
jg SHORT File.00428D0F ; jump if (SF==OF and ZF==0) -> jump. 
```

`mov esi, eax`; `eax`= 0xFFFFFFFF, `ecx`= 2, `esi`= 0xFFFFFFFF ... 16 次内循环后情况如下：

```
mov esi,eax            ; eax = -16, ecx = 2, esi = -16
dec eax                ; eax = -17, ecx = 2, esi = -16, SF = 1, ZF = 0
cmp eax,-17            ; OF = 0, SF = 0, ZF = 1
jg SHORT File.00428D0F ; jump if (SF==OF and ZF==0) -> no jump.
dec ecx                ; eax = -17, esi = -16, ecx = 1, SF = 0, ZF = 0 
```

外循环是微不足道的。如果确定除了 00428D08（这段代码的开头）没有其他入口点`mov ecx,2`，即代码没有从其他地方修改并且这段代码没有用作数据，则可以将代码替换为：

如果在此代码结束后使用标志值：

```
mov eax,-17
cmp eax,-17
mov ecx,1
dec ecx
mov esi,-16 
```

如果标志的值不重要：

```
mov eax,-17
mov ecx,0
mov esi,-16 
```

# objective-c - 为什么一个空的 tableView 会检查节的数量而非空的不检查？

> ID：12325829
> 
> 赞同：1
> 
> 时间：2012-09-07T21:47:55.643
> 
> 标签：objective-c, ios, uitableview

我已经设置了一个简单的演示应用程序，`UITableViewController`没有内容，但工具栏中有一个“添加”按钮。这将启动一个模态视图控制器，除了“取消”按钮之外，它又是空的。取消按钮只是告诉它的`delegate`(the `UITableViewController`) 关闭模式。

然后我在's方法中添加了一条`NSLog`语句。`UITableViewController``numberOfSectionsInTableView`

通常，当表视图控制器加载时，我会看到两次调用`numberOfSectionsInTableView`. 当我打开并关闭模式（返回到`UITableViewController`）时，我看不到对`numberOfSectionsInTableView`.

但是，如果我`0`从中返回`numberOfSectionsInTableView`，除了显示的两个调用之外，我还会在模态关闭时看到一个额外的 numberOfSections 调用。

这仅在`numberOfSectionsInTableView`返回时发生`0`，除了提到的之外，我没有向我的项目添加任何其他代码。正如我所描述的那样，通过设置几个控制器并修改来自`numberOfSectionsInTableView`.

我的问题：

*   为什么从模态视图返回`UITableView`调用？`numberOfSectionsInTableView`
*   `numberOfSectionsInTableView`为什么只有在返回时才这样做`0`？
*   除了`numberOfSectionsInTableView`，当模式被解除时，`UITableViewController`也会调用。`cellForRowAtIndex:`事实上，它正在尝试显示其`dataSource`. 如果添加的第一行已经自动更新，我该如何手动为行插入设置动画？难道不应该让我来确保 my`UITableView`与其一致`dataSource`吗？
*   检查什么属性`UITableViewController`才能知道有一个或多个部分（因此询问我的代表有多少部分）？它不能是`numberOfSectionsInTableView`它自己，因为每当我从模态返回时，我都会看到它被调用，而不仅仅是在 numberOfSections = 0 时。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-08T06:17:52.360

来自[`UITableViewController`文档：](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITableViewController_Class/Reference/Reference.html)

> 当表格视图第一次加载时即将出现时，表格视图控制器重新加载表格视图的数据...... `UITableViewController`该类在超类方法中实现了这一点 `viewWillAppear:`

如果您在调试器中观看，应用程序启动时的**第二次**调用来自`UITableViewController`'s `viewWillAppear:`implementation - 特别是上面提到的部分，`tableView`发送`reloadData`消息的位置。

现在，对 on launch 的**第一个**调用`numberOfSectionsInTableView:`也是来自`UITableViewController`的实现，`viewWillAppear:`但不是直接来自该实现对`-[UITableView reloadData]`. 我不确定第一个电话是怎么回事。

但是，对于您的问题，在解除模式时调用该调用具有与**第二次**`numberOfSectionsInTableView:`调用完全相同的调用堆栈from 。我的假设是，将零部分解释为处于根本没有加载的状态。这确实有些道理。我认为“空”表视图是没有任何*行*的表视图，但没有任何*部分*的表视图对我来说似乎几乎“未初始化”。此外，文档暗示默认情况下有一节。从此方法返回零也与文档的假设不一致。**`applicationDidFinishLaunching:withOptions:``UITableView`**`UITableViewDataSource``UITableView`****

 ****现在，对于您对动画的关注 - 如果您为表格提供一个空白部分以使用，您将能够完全控制插入第一行的任何动画，并且不会被锁定在您需要的时候重新加载。

我认为这个故事的寓意是，不要返回零部分，除非你真的，真的因为某种原因需要。您帖子的标题也提到了这个表格视图是“空的”，但我认为很明显框架发现零部分不是空的而是卸载的。

希望这可以帮助！感谢您发布示例项目供我使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-08T05:47:03.850

也许代表简直不敢相信自己的眼睛。但说真的，由于表格视图必须至少有一个部分，因此传递 0 没有任何意义。为什么这样做？你传给它一个无效的参数，它会给你一个奇怪的响应。至于为什么当你通过 1 时它不询问部分的数量，我认为这是因为它不需要知道此时（从模态视图控制器返回）——表格视图已经被填充（如果有一些数据）并且您没有更改模型中的任何内容，因此不需要更新。

每次您从模态视图控制器返回时，我都会在您的示例项目中添加几行以连续滑动，这就是我认为您正在尝试做的事情。我为 numberOfRowsInSection 的返回值添加了一个 int 属性 num，添加了一个数组来填充表，并从模式视图控制器解除方法调用了 insertRowsAtIndexPaths。

```
- (void)viewDidLoad
{
    _num = 0;
    self.theData = @[@"one",@"two",@"three"];
    [super viewDidLoad];
    self.navigationItem.leftBarButtonItem = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemAdd
                                                                                          target:self
                                                                                          action:@selector(addRecipe)];
}

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    NSLog(@"# sections requested");
    //when 0, this fires on return from the modal. When 1, it does not.
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    NSLog(@"in numberOfRows in section");
    return _num;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    NSLog(@"in cellForRowAtIndexPath");
    UITableViewCell *cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:nil];
    cell.textLabel.text = [self.theData objectAtIndex:indexPath.row];
    return cell;
}

- (void)addRecipe
{
    //create the modal and suscribe for delegate notifications
    AddRecipeViewController *addRecipeController = [[AddRecipeViewController alloc]initWithStyle:UITableViewStyleGrouped];
    addRecipeController.delegate = self;

    //display the modal in a navigation controller
    UINavigationController *navController = [[UINavigationController alloc] initWithRootViewController:addRecipeController];
    [self.navigationController presentModalViewController:navController animated:YES];
}

- (void)addRecipeVC:(AddRecipeViewController *)addRecipeVC didAddRecipe:(NSString *)recipe
{
    [self dismissModalViewControllerAnimated:YES];
    _num += 1;
    [self performSelector:@selector(addRow) withObject:nil afterDelay:.5];
}

-(void)addRow {
    [self.tableView insertRowsAtIndexPaths:@[[NSIndexPath indexPathForRow:_num-1 inSection:0]] withRowAnimation:UITableViewRowAnimationRight];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T22:16:13.510

表格视图在用数据填充表格视图时检查部分的数量！
由于表格可以分为多个部分，因此它必须具体知道将其分为多少个部分。

重新加载数据时，还会检查节数。

因为每次表格视图必须采取行动访问表格的数据，例如您点击了哪一行，在哪个部分，或者填充数据表时，必须知道部分的数量！

希望这有帮助！****

# wordpress - 将列添加到发布编辑页面

> ID：12325830
> 
> 赞同：0
> 
> 时间：2012-09-07T21:47:57.930
> 
> 标签：wordpress

在仪表板区域中，您可以选择 1-4 列。但是，当您添加或编辑新帖子/页面时，您只能选择 1-2 列。我希望能够选择 1-3 甚至 1-4 列。我有很多自定义分类法，我想通过使用超过 2 列来更恰当地安排它们。

下面列出了一个解决方案，它适用于我拥有的 Wordpress 3.2 安装，但不适用于当前的 3.4。它可能只需要一个小的调整，但我似乎无法弄清楚。这是上面链接中的解决方案...

```
'add_action( 'submitpost_box', 'third_column_edit_form' );
add_action( 'submitpage_box', 'third_column_edit_form' );
function third_column_edit_form() {
    global $post_type, $post;
    //if( 'your-type' != $post_type )
    //return;
    $side_meta_boxes2 = do_meta_boxes( $post_type, 'column3', $post );
}

add_action( 'admin_print_styles-post.php',     'third_column_css');
add_action( 'admin_print_styles-post-new.php', 'third_column_css');
function third_column_css () {
    global $post_type;
        //if( 'your-type' != $post_type )
         //     return;
    ?>
    <style type="text/css">
    #side-info-column {
      width: 580px;
    }
#post-body {
  margin-right: -620px !important;
}

#post-body-content {
  margin-right: 600px !important;
}

#column3-sortables {
  width: 280px;
  float: right;
  display: block;
  min-height: 200px;
}

#side-sortables {
  float: left;
  display: block;
  min-height: 200px;
}

/* Style copied from #side-sortables */

#column3-sortables .category-tabs, #column3-sortables .category-tabs {
  margin-bottom: 3px;
}

#column3-sortables .category-tabs li, #column3-sortables .add-menu-item-tabs li {
  display: inline;
}

#column3-sortables .category-tabs a, #column3-sortables .add-menu-item-tabs a {
  text-decoration: none;
}

#column3-sortables .category-tabs .tabs a, #column3-sortables .add-menu-item-tabs .tabs a {
  color: #333;
}
</style>
<?php
}' 
```

# android - PhoneGap 2.0 升级错误 - JSCallback 错误/找不到类

> ID：12325836
> 
> 赞同：1
> 
> 时间：2012-09-07T21:48:25.180
> 
> 标签：android, eclipse, cordova

我将 Phonegap (Cordova) 项目从 1.9 更新到 2.0，并收到以下两个新错误：

```
Web Console

JSCallback Error: Request failed. at file file://android_assets/www/js/cordova-2.0.0.js:3698 
```

和

```
dalvikvm

Could not find class 'android.webkit.WebResourceResponse', referenced from method org.apache.cordova.CordovaWebViewClient.generatedWebResourceResponse 
```

这是一个已知问题吗？我已经搜索但找不到解决这些问题的解决方案。我尝试创建一个新的空白项目，但我遇到了同样的错误。我还确保 Eclipse 和 SDK 管理器是最新的。

任何帮助将非常感激。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T18:16:19.583

不确定第一个问题，因为我需要知道该日志出现时您在做什么。

关于第二个问题：

[https://stackoverflow.com/a/12043959/41679](https://stackoverflow.com/a/12043959/41679)

# ruby - ruby 和 curl：跳过无效页面

> ID：12325842
> 
> 赞同：0
> 
> 时间：2012-09-07T21:49:02.977
> 
> 标签：ruby, curl

我正在构建一个脚本来解析多个页面标题。感谢堆栈中的另一个问题，我现在有了这个工作位

```
curl = %x(curl http://odin.1.ai)
simian = curl.match(/<title>(.*)<\/title>/)[1]
puts simian 
```

但是如果您尝试相同的页面没有标题，例如

```
 curl = %x(curl http://zales.1.ai) 
```

它因 nill 类的未定义方法而死，因为它没有标题....我无法检查 curl 是否为 nil，因为在这种情况下它不是（它包含另一行）

即使标题不存在并移至下一页进行检查，您是否有任何解决方案可以使其正常工作？如果我们坚持使用此代码，我将不胜感激，因为我确实尝试过使用 nokogiri 和 uri 的其他解决方案 (Nokogiri::HTML(open("http:/.....") 但这也不能像 byname_meee.1 这样的子域工作.ai 不适用于默认的 open-uri，所以如果我们能坚持使用 curl 的代码，我将不胜感激。

# 更新

我意识到我可能遗漏了一些应该澄清的具体案例。这是为了解析 300-400 页。在第一次运行中，我注意到至少有两种情况，其中 nokogiri、hpricot 甚至更基本的 open-uri 都不起作用

1) open-uri 在一个简单的域中就失败了，像[http://levant_alejandro.1.ai](http://levant_alejandro.1.ai)这是一个有效的域，并且可以与 curl 一起使用，但不能与 open_uri 或 nokogiri 一起使用 open_uri

2）第二种情况，如果页面没有像 [http://zales.1.ai这样的标题](http://zales.1.ai)

3) 第三个是一个带有图像的页面，没有像[http://voldemortas.1.ai/这样的有效 HTML](http://voldemortas.1.ai/)

第四种情况是页面只有内部服务器错误或乘客/机架错误。

可以使用此解决方案对前三个案例进行排序（感谢 #ruby IRC 频道中的 Havenwood）

```
curl = %x(curl http://voldemortas.1.ai/)
begin
   simian = curl.match(/<title>(.*)<\/title>/)[1]
rescue NoMethodError
   simian = "" # curl was nil?    
rescue ArguementError
   simian = "" # not html?
end
puts simian 
```

现在我知道这既不优雅也不最优。

# 改写的问题

你有没有更好的方法来使用 nokogiri 或其他包含这些情况的 gem（没有标题或没有 HTML 有效页面甚至 404 页面）？鉴于我正在解析的页面具有相当简单的标题结构，上述解决方案是否合适？为了了解知识，了解为什么使用像 nokogiri 这样的额外 gem 进行解析会是更好的选择（注意：我尝试很少有 gem 依赖项，因为它们往往会随着时间的推移而破坏）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T23:38:57.300

你对自己太苛刻了。

Nokogiri 不在乎您从哪里获得 HTML，它只需要文档的正文。您可以使用 Curb、Open-URI、原始 Net::HTTP 连接，它会解析返回的内容。

尝试遏制：

```
require 'curb'
require 'nokogiri'

doc = Nokogiri::HTML(Curl.get('http://http://odin.1.ai').body_str)
doc.at('title').text
=> "Welcome to Dotgeek.org * 1.ai" 
```

如果你不知道你是否会有一个`<title>`标签，那么不要试图一次做所有的事情：

```
title = doc.at('title')
next if (!title)
puts title.text 
```

看看“[相当于 Ruby 的 curl？](https://stackoverflow.com/questions/929652/equivalent-of-curl-for-ruby?rq=1) ”以获得更多想法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-08T00:45:47.557

您只需要在访问之前检查匹配项。如果`curl.match`是`nil`，则您无法访问分组：

```
curl = %x(curl http://odin.1.ai)
simian = curl.match(/<title>(.*)<\/title>/)
simian &&= simian[1] # only access the matched group if available
puts simian 
```

请听从*铁皮人的*建议并使用 Nokogiri。您的正则表达式实际上只适用于脆弱的解决方案——当`title`元素分布在多行时它会失败。

# 更新

如果您真的不想使用 HTML 解析器并且您*承诺*这是一个快速脚本，您可以在标准库中使用 OpenURI（net/http 的包装器）。它至少比解析`curl`输出要干净一点。

```
require 'open-uri'

def extract_title_content(line)
  title = line.match(%r{<title>(.*)</title>})
  title &&= title[1]
end

def extract_title_from(uri)
  title = nil

  open(uri) do |page|
    page.lines.each do |line|
      return title if title = extract_title_content(line)
    end
  end
rescue OpenURI::HTTPError => e
  STDERR.puts "ERROR: Could not download #{uri} (#{e})"
end

puts extract_title_from 'http://odin.1.ai' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-08T06:47:33.923

看来，您真正在寻找的是一种跳过非 HTML 响应的方法。就像 Tin Man 建议的那样，使用像 curl 这样的 curl 包装器比掉到 shell 上并在那里使用 curl 要容易得多：

```
1.9.3p125 :001 > require 'curb'
 => true 
1.9.3p125 :002 > response = Curl.get('http://odin.1.ai')
 => #<Curl::Easy http://odin.1.ai?> 
1.9.3p125 :003 > response.content_type
 => "text/html" 
1.9.3p125 :004 > response = Curl.get('http://voldemortas.1.ai')
 => #<Curl::Easy http://voldemortas.1.ai?> 
1.9.3p125 :005 > response.content_type
 => "image/png" 
1.9.3p125 :006 > 
```

所以你的代码可能看起来像这样：

```
response = Curl.get(url)
if response.content_type == "text/html" # or more fuzzy: =~ /text/
  match = response.body_str.match(/<title>(.*)<\/title>/)
  title = match && match[1] 
  # or use Nokogiri for heavier lifting
end 
```

没有更多的例外让猿猴

# google-apps-script - 使用 GAS Web App 保存和加载时间长

> ID：12325844
> 
> 赞同：0
> 
> 时间：2012-09-07T21:49:18.657
> 
> 标签：google-apps-script

我一直以奇怪的规律遇到这个问题。代码工作正常，然后开始需要几分钟来保存或加载。它大约有 2000 行，因此仅在平均值较大的一侧。好吧，这个问题今天再次出现在我的日常生活中，我终于找到了原因。

事实证明，我所有的“慢代码”都被复制和粘贴了，通常是在我使用`Select All`. 当我将应用程序部署给同事等时，我一直在这样做，这引起了很大的挫败感。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T21:49:18.657

我知道这听起来很明显，但将应用程序安装到其他帐户的最佳做法似乎是在查看器级别共享脚本，然后制作副本。

我还回到了其他慢代码，找到了一个好的版本并制作了副本并一点一点地更新。慢代码现在快。

# c# - 为什么 XmlReader 上的默认编码与 XmlTextReader 的默认编码表现不同？

> ID：12325856
> 
> 赞同：4
> 
> 时间：2012-09-07T21:50:51.793
> 
> 标签：c#, xml, character-encoding

我有一个 ACII 编码的 XML 文件。

我尝试使用两种不同的 Microsoft XmlReader 实现来阅读它：

1.  `XmlReader.Create(new StreamReader(fileImport.FileContent, true));`
2.  `new XmlTextReader(fileImport.FileContent)`

第一个是 XmlReader.Create，它使用 StreamReader 进行编码，效果很好。

第二个，新的 XmlTextReader，抛出一个 XmlException，并带有消息“给定编码中的无效字符”。

如果您阅读了这两个的 MSDN 文档，它们都应该从字节顺序标记中检测编码，如果检测失败则回退到 UTF-8。

`XmlTextReader`[[msdn]](http://msdn.microsoft.com/en-us/library/system.xml.xmltextreader.encoding.aspx) ![XmlTextReader.Encoding 属性](../Images/5488cb13b766d44724e97b6d86e7c037.png)

`StreamReader`[[msdn]](http://msdn.microsoft.com/en-us/library/7bc2hwcb.aspx) ![StreamReader 构造函数](../Images/a0a97ec3abc8cd94220d0ba16695d549.png)

那么，为什么 XmlTextReader 会失败，编码无效，而 StreamReader 却没有，当文档说默认情况下两种实现都以相同的方式处理编码时？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-08T00:47:11.493

它们的工作方式相同，但您使用它们的方式不同......在第一种情况下，您将 a`StreamReader`作为参数传递，而在第二种情况下，您将传递文件位置。

当您`XmlReader`在 a `TextReader`（如`StreamReader`）上创建一个时，它总是使用该的编码`TextReader`（忽略 XML 声明中的 encoding 属性的值）。当您只传递路径或流时，它使用 XML 声明中的 encoding 属性。

在您的情况下，我怀疑声明的编码与文件的实际编码不匹配。我能够通过创建一个 XML 文件来重现您的问题，该文件将其编码声明为 UTF-8，但实际上编码为 ANSI。如果文件包含非 ASCII 字符，我会得到同样的错误。但是，如果我修复 XML 声明中的编码，它就可以正常工作......

# java - JNI 获取异常信息 - 尝试读取或写入受保护的内存

> ID：12325860
> 
> 赞同：1
> 
> 时间：2012-09-07T21:51:20.390
> 
> 标签：java, c++, java-native-interface

我正在使用以下代码尝试在 java 中获取类 RWException（它扩展了 Exception），以便我可以调用方法“getCode()”来检索错误代码 (int) 并正确处理错误。我浏览了 JNI 文档并创建了以下代码...问题是当我尝试调用无参数方法 getCode() 时遇到 AccessViolation 异常。我得到了类的有效句柄和我正在寻找的方法 id。

```
jstring o = (jstring)envLoc->CallStaticObjectMethod(cls, mid, jstrUser, jstrPass, jstrGroup);
jthrowable exc = envLoc->ExceptionOccurred();

if (exc) {
    // Get the class
    jclass mvclass = env->GetObjectClass( exc );
    // Get method ID for method
    jmethodID mid = env->GetMethodID(mvclass, "getCode", "()I");
    // Call the method      
    jint code  =  env->CallIntMethod(mvclass, mid);
} 
```

此代码在使用以下信息在 VS.NET 中调试时给了我一个异常：

尝试读取或写入受保护的内存

**更新** 这是我希望通过上面的 JNI 代码调用的 java 方法：

```
public int getCode() {
    return code;
} 
```

mvclass 和 mid 对象都已正确实例化，并且应该可以正常工作，除非我遗漏了什么。

**更新 2**

如果我运行以下代码，则 toString() 方法使用相同的概念：

```
jstring o = (jstring)envLoc->CallStaticObjectMethod(cls, mid, jstrUser, jstrPass, jstrGroup);
exc = envLoc->ExceptionOccurred();
if (exc) {

    envLoc->ExceptionClear();

    // Get the class
    jclass exccls = envLoc->GetObjectClass(exc);

    // Get method ID for methods 
    jmethodID getCodeMeth = envLoc->GetMethodID(exccls, "getCode", "()I");

    jmethodID getMsgMeth = envLoc->GetMethodID(exccls, "toString", "()Ljava/lang/String;");

    jstring obj = (jstring)envLoc->CallObjectMethod(exccls, getMsgMeth);
    String^ toString = JStringToCliString(obj);

    // this is where the access violation occurs
    jint jcode  =  envLoc->CallIntMethod(exccls, getCodeMeth);
    int code = jcode;
} 
```

因此，toString() 方法返回对象的完整类名，它是正确的 RWException 对象。第一次更新 getCode() 中概述的方法是公开的，等等......所以不确定为什么它会给出内存访问冲突错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-08T09:50:51.747

我可以在您的代码中看到的唯一可能的问题是您正在调用一个方法，而异常仍在传播。`envLoc->ExceptionOccurred()`为您提供异常对象，但您仍然必须使用`envLoc->ExceptionClear()`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-11T10:15:23.563

```
// exc is the exception object
exc = envLoc->ExceptionOccurred();

...

// exccls is the exception CLASS
jclass exccls = envLoc->GetObjectClass(exc);
jmethodID getCodeMeth = envLoc->GetMethodID(exccls, "getCode", "()I");

...

// CallIntMethod(jobject instance, jmethodID method)
jint jcode = envLoc->CallIntMethod(exccls, getCodeMeth);
// exccls is the CLASS, not the object
// so correct would be:
jint jcode = envLoc->CallIntMethod(exc, getCodeMeth); 
```

哇哦。

并且编译器不会抱怨这一点，因为每个`jclass`都是 a `jobject`，就像`jstring`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-10T18:54:47.270

您在此代码中没有错误检查。您需要检查每个 JNI 操作的结果：GetObjectClass()、GetMethodID()、CallXXXMethod() ... 例如，您假设该类有一个 getCode() 方法，并在不检查的情况下调用它。

# c# - 如何通过网络请求取消异步任务？

> ID：12325863
> 
> 赞同：7
> 
> 时间：2012-09-07T21:51:23.960
> 
> 标签：c#, asp.net-mvc, asynchronous, task-parallel-library, signalr

这是场景：在用户登录时，我启动了一个任务，该任务正在侦听 IMAP 空闲以获取邮件通知，并且它通过信号器（一种推送通知）与客户端建立实时连接。现在的问题是我如何取消这个任务？即用户取消推送通知或注销..

编辑：根据我的理解，例如，如果 5 个用户登录到该站点，则有 5 个任务正在运行？那么如何取消单个任务。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T17:23:50.173

每当您创建任务时，您都必须创建一个取消令牌并将其传递给它。由于每个用户都与一个任务相关联，因此您可以将任务和取消令牌存储在用户的会话中。

现在使用存储在用户会话中的取消令牌，您可以在他注销或按下取消按钮时轻松取消任务。

请参阅此[帖子](http://blogs.msdn.com/b/csharpfaq/archive/2010/07/19/parallel-programming-task-cancellation.aspx)以取消任务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T22:00:44.697

必须修改异步工作者以支持取消

[http://www.csharp-examples.net/cancel-asynchronous-method/](http://www.csharp-examples.net/cancel-asynchronous-method/)

您还可以使用不太复杂的后台工作程序 [http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.cancelasync.aspx](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.cancelasync.aspx)

当您向已经开始工作的外部源（数据库、应用程序）发送取消时遇到的一个问题，如果它不支持取消，您可能必须等到它完成。

编辑：我从来没有用 MVC 做过这个，但是找到了一篇关于“使用取消令牌”的好文章，用于在 MVC4 中采用 CancellationToken 参数的异步进程。 [http://www.asp.net/mvc/tutorials/mvc-4/using-asynchronous-methods-in-aspnet-mvc-4](http://www.asp.net/mvc/tutorials/mvc-4/using-asynchronous-methods-in-aspnet-mvc-4) 希望对您有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T15:03:31.120

该进程可以在用户没有任何活动的情况下杀死自己。在另一个线程中交换变量的最简单方法 - 文件。假设客户端浏览器仍然打开，javascript 计时器调用 Ajax 请求，它在服务器上将时间戳写入文件。您的任务还会定期读取文件，当时间戳太旧时，该进程会杀死自己。您可以选择设置的活动超时值。

# ios - 将照片从外部扫描仪直接导入我的 iOS 应用程序

> ID：12325865
> 
> 赞同：0
> 
> 时间：2012-09-07T21:51:41.563
> 
> 标签：ios, import, scanning

我想通过外部扫描仪将照片或 pdf 导入我的应用程序。

我知道打印机制造商制作了一些应用程序，可以将照片无线导入您的照片库。照片在那里后，很容易导入到我的应用程序中。但是，我想在我的应用程序中完成这一切。

是否有任何开放标准可以做到这一点？有没有办法用 UIWebView 做到这一点？如何通过 USB 将设备连接到扫描仪并以某种方式保存文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T22:35:25.903

您可以将扫描仪连接到服务器，该服务器将接收您扫描的每个文件。使用 iphone，您可以从服务器下载数据。

希望它有帮助， **马里奥**

# algorithm - 以最快的方式生成所有 n 位二进制数

> ID：12325868
> 
> 赞同：3
> 
> 时间：2012-09-07T21:51:51.733
> 
> 标签：algorithm, bitstring

如何生成所有可能的 n 位字符串组合？我需要以最快的方式生成 20 位字符串的所有组合。（我目前的实现是通过按位与和右移操作完成的，但我正在寻找一种更快的技术）。

我需要将位字符串存储在数组（或列表）中以获取相应的十进制数，例如-

`0 --> 0 0 0`

`1 --> 0 0 1`

`2 --> 0 1 0`... ETC。

任何的想法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-08T08:00:33.727

Python

```
>> n = 3
>> l = [bin(x)[2:].rjust(n, '0') for x in range(2**n)]
>> print l
['000', '001', '010', '011', '100', '101', '110', '111'] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T21:53:59.550

只需以二进制表示形式输出 0 到 2^n - 1 的数字，恰好 n 位。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-07T21:54:28.723

```
for (unsigned long i = 0; i < (1<<20); ++i) {
    // do something with it
} 
```

An`unsigned long` *是*位序列。

如果您想要的是一串字符`'0'`and `'1'`，那么您`i`每次都可以转换为该格式。您可以利用连续数字通常共享一个长的初始子字符串这一事实来加快速度。所以你可以做这样的事情：

```
char bitstring[21];
for (unsigned int i = 0; i < (1<<10); ++i) {
    write_bitstring10(i, bitstring);
    for (unsigned int j = 0; j < (1<<10); ++j) {
        write_bitstring10(j, bitstring + 10);
        // do something with bitstring
    }
} 
```

我只在那里从 1 个循环增加到 2 个循环，但我从位到字符的转换比以前多 50%。您可以尝试以下方法：

*   使用更多循环
*   不均匀地拆分循环，可能是 15-5 而不是 10-10
*   编写一个函数，它接受一串 0 和 1，并在其上加 1。这很容易：找到最后一个`'0'`，将其更改为 a `'1'`，并将其后面的所有`'1'`s 更改为`'0'`。

要极其优化`write_bitstring`，4 的倍数是好的，因为在大多数架构上，您可以一次在一个单词中写入 4 个字符：

开始：

```
assert(CHAR_BIT == 8);
uint32_t bitstring[21 / 4]; // not char array, we need to ensure alignment
((char*)bitstring)[20] = 0; // nul terminate 
```

函数定义：

```
const uint32_t little_endian_lookup = {
    ('0' << 24) | ('0' << 16) | ('0' << 8) | ('0' << 0),
    ('1' << 24) | ('0' << 16) | ('0' << 8) | ('0' << 0),
    ('1' << 24) | ('1' << 16) | ('0' << 8) | ('0' << 0),
    // etc.
};
// might need big-endian version too

#define lookup little_endian_lookup // example of configuration

void write_bitstring20(unsigned long value, uint32_t *dst) {
    dst[0] = lookup[(value & 0xF0000) >> 16];
    dst[1] = lookup[(value & 0x0F000) >> 12];
    dst[2] = lookup[(value & 0x00F00) >> 8];
    dst[3] = lookup[(value & 0x000F0) >> 4];
    dst[4] = lookup[(value & 0x0000F)];
} 
```

我还没有测试过这些：显然你有责任编写一个可以用来做实验的基准。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T21:54:08.183

```
for (i = 0; i < 1048576; i++) {
   printf('%d', i);
} 
```

将 int 版本 i 转换为二进制字符串作为 OP 的练习。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-08T07:53:23.063

此解决方案使用 Python。（版本 2.7 和 3.x 应该可以工作）

```
>>> from pprint import pprint as pp
>>> def int2bits(n):
    return [(i, '{i:0>{n}b}'.format(i=i, n=n)) for i in range(2**n)]

>>> pp(int2bits(n=4))
[(0, '0000'),
 (1, '0001'),
 (2, '0010'),
 (3, '0011'),
 (4, '0100'),
 (5, '0101'),
 (6, '0110'),
 (7, '0111'),
 (8, '1000'),
 (9, '1001'),
 (10, '1010'),
 (11, '1011'),
 (12, '1100'),
 (13, '1101'),
 (14, '1110'),
 (15, '1111')]
>>> 
```

它找到最大数字的宽度，然后将 int 与二进制格式的 int 配对，每个格式化的字符串在必要时用零填充以填充最大宽度。（pprint 的东西只是为了得到这个论坛的整洁打印输出，可以省略）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-12-04T12:25:37.353

> 您可以通过生成从 0 到 2^n-1 的二进制表示的所有整数来实现

```
static int[] res;
    static int n;
    static void Main(string[] args)
    {
        n = Convert.ToInt32(Console.ReadLine());
        res = new int [n];
        Generate(0);

    }

    static void Generate(int start)
    {
        if (start > n)
            return;
        if(start == n)
        {
            for(int i=0; i < start; i++)
            {
                Console.Write(res[i] + " ");
            }
            Console.WriteLine();
        }

        for(int i=0; i< 2; i++)
        {
            res[start] = i;
            Generate(start + 1);
        }
    } 
```

# c++ - 仅标头文件中的静态 const 整数类成员-正确的方法？

> ID：12325871
> 
> 赞同：7
> 
> 时间：2012-09-07T21:52:16.003
> 
> 标签：c++, static, constants, member

假设我有以下示例：

```
#include <cstdlib>

class A {
public:
    static const std::size_t value = 42;
}; 
```

简而言之，我有（或者更好，想要）一个类`A`，它的`static const std::size_t`成员`value`用值`42`（在编译时确定）调用。

现在，IIRC，这仅在某些情况下才能正常工作。例如，当您获取`A::value`. 为了在所有情况下都能正常工作，您需要在*一些*实现文件中添加定义：

```
const std::size_t A::value; 
```

但是，我不能这样做，因为我希望这个文件是**header-only**。另一个常见的解决方案是：

```
class A {
public:
    enum { value = 42 };
}; 
```

我也不喜欢这种解决方案，因为我希望类型`A::value`为`std::size_t`.

这个问题有什么好的解决方案？最好是一个小巧便携的解决方案，而不是像`BOOST_STATIC_CONSTANT`.

* * *

我想要 C++03 的解决方案，而不是 C++11（在那里很简单）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-07T22:15:04.530

首先，`size_t`对数字使用无符号类型，您可能会遇到隐式提升问题。因此，使用其对应的有符号类型是个好主意，称为`ptrdiff_t`. 碰巧的是，它是指针差异表达式的结果类型。

此外，由于 C++11 的变化，通常最好包含`<stddef.h>`and not `<cstddef>`，即 write `::ptrdiff_t` or just plain `ptrdiff_t`， not `std::ptrdiff_t`。

现在，这里是如何做头文件外部链接常量的事情：

```
template< class Dummy >
struct A_constants_
{
    static ::ptrdiff_t const value;
};

template< class Dummy >
::ptrdiff_t const A_constants_<Dummy>::value = 42;

typedef A_constants_<void> A_constants;

class A
    : public A_constants
{
public:
    // Whatever
}; 
```

然后你可以像这样使用它：

```
foo( A::value ); 
```

还有其他一些方法可以做到这一点，但以上是最简单和最容易做到的。

# silverlight - Silverlight - 向旋转的文本块添加工具提示

> ID：12325875
> 
> 赞同：0
> 
> 时间：2012-09-07T21:52:39.937
> 
> 标签：silverlight, xaml, rotation, tooltip

我有一个在 Silverlight XAML 中旋转 90 度的 TextBlock：

```
<TextBlock Name="txbPW" Text="West">
    <TextBlock.RenderTransform>
          <RotateTransformAngle="90" />
    </TextBlock.RenderTransform>
</TextBlock> 
```

我想向它添加一个工具提示（未旋转）。有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T22:02:04.930

你怎么了？你也想显示旋转的工具提示吗？还是不要？？还是您只是要求向文本块添加工具提示？？？

如果您只想向文本块添加工具提示，则必须执行以下操作：

```
<TextBlock Name="txbPW" Text="West">
    <TextBlock.RenderTransform>
          <RotateTransformAngle="90" />
    </TextBlock.RenderTransform>
    <ToolTipService.ToolTip>
          <ToolTip Content="ToolTip"></ToolTip>
    </ToolTipService.ToolTip>
</TextBlock> 
```

[http://bouncetadiss.blogspot.com.es/2010/02/tooltip-for-textblock-in-silverlight.html](http://bouncetadiss.blogspot.com.es/2010/02/tooltip-for-textblock-in-silverlight.html)

# node.js - 如何正确使用 Node.js / Mongoose / MongoDB + ConnectSet 进行负载平衡？

> ID：12325881
> 
> 赞同：3
> 
> 时间：2012-09-07T21:53:00.293
> 
> 标签：node.js, mongodb, mongoose

我正在使用 Node.js+Express+Mongoose 连接到我的 MongoDB 副本集（3x 实例）。我的印象是，当我使用 Mongoose 的“connectSet”命令，从而连接到副本集时，我的查询将在我的副本集之间进行负载平衡。

但是，使用[nodetime](http://nodetime.com)，我可以看到所有查询（包括 find() 查询）都将转到副本集中的 PRIMARY 实例。

我在这里误解了什么吗？是否有一些我遗漏的练习，或者副本集中的设置？我认为副本集的目的是平衡只读查询与集合中的 SECONDARY MongoDB 服务器......

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T23:10:21.163

> 我的印象是，当我使用 Mongoose 的“connectSet”命令，从而连接到副本集时，我的查询将在我的副本集之间进行负载平衡。

这种印象是不正确的。

默认情况下，MongoDB 读取和写入发送到副本集的主成员。副本集的主要目的是提供高可用性 (HA)。当主节点关闭时，驱动程序将在现有连接上抛出异常，然后自动重新连接到任何被选为新主节点的节点。

这里的想法是驱动程序将在没有干预和配置更改的情况下找到新的主节点。

> 是否有一些我遗漏的练习，或者副本集中的设置？

如果您*真的*想将查询发送到辅助服务器，您可以在查询上配置一个标志，说明*“此查询可以发送到辅助服务器”*。实现会有所不同，[这里是](https://stackoverflow.com/questions/8364388)Mongoose 的一个版本。

请注意，向辅助节点发送查询不是默认行为，这里有很多陷阱。MongoDB 的大多数实现都受到单个写入锁的限制，因此不需要对读取进行负载平衡。分散读取并不能保证提高性能，并且很容易导致脏读。

在进行这样的负载平衡之前，请确保您绝对需要它。分片可能是更好的选择。

# eclipse-plugin - perforce 进入离线模式后文件被锁定

> ID：12325887
> 
> 赞同：2
> 
> 时间：2012-09-07T21:53:40.743
> 
> 标签：eclipse-plugin, perforce

我有一个由 perforce 管理的 Eclipse 项目。我在离线模式下打开了一些文件进行了更改并关闭了文件。我的网络恢复了，现在该文件的权限被劫持了。

我可以更改文件系统的权限，但我必须进行检查才能让 Team Sync 识别我所做的更改。

我还是觉得我在作弊。还有其他我应该做的事情吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-08T09:27:15.353

当您的连接恢复时，您需要告诉 Perforce 协调您所做的离线更改。在 Eclipse 中，这是通过**Team > Check Consistency...**完成的。

请查看[在线手册](http://www.perforce.com/perforce/r10.1/manuals/p4eclipse/topics/changesettings.html)了解详细信息。这应该使您免于对操作系统文件权限等进行任何手动操作。

# java - 如何禁用 JFrame 中的关闭按钮？

> ID：12325888
> 
> 赞同：1
> 
> 时间：2012-09-07T21:53:46.750
> 
> 标签：java, swing, jframe

> **可能重复：**
> [如何禁用（或隐藏）JFrame 上的关闭 (x) 按钮？](https://stackoverflow.com/questions/276254/how-to-disable-or-hide-the-close-x-button-on-a-jframe)

我希望框架有一个停用的关闭按钮，但我不想这样做`frame.setDefaultCloseOperation( JFrame.DO_NOTHING_ON_CLOSE )`；也不`frame.setUndecorated(true)`。

我希望框架出现，但关闭按钮应该看起来不活动/禁用。

如果我们不能做到这一点，`JFrame`有没有办法做到这一点？你的建议会有很大帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T22:06:17.320

我认为最好的答案是不可能。

我会选择`DO_NOTHING_ON_CLOSE`并覆盖其 WindowAdapter 中的 windowClosing 事件作为最佳选择。

```
frame.setDefaultCloseOperation(JFrame.DO_NOTHING_ON_CLOSE);
frame.addWindowListener(new WindowAdapter() {
  public void windowClosing(WindowEvent e) {
    // do whatever else
  }
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T23:13:23.950

这个[错误报告](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6199687)说这是不可能的，虽然它是一个旧链接，但它可能还没有添加到 jdk 中:(

# android - Android：如何存储我最近的搜索并在应用中显示

> ID：12325895
> 
> 赞同：0
> 
> 时间：2012-09-07T21:54:28.097
> 
> 标签：android, android-widget, android-sqlite

我正在构建一个有助于搜索的应用程序，就像谷歌的搜索小部件一样。在我的应用程序中，我有一个自动建议，它以 json 格式从 wiki-suggest URL 带来键入的数据。我可以填充它，但我想知道如何保存我最近的搜索并将其显示在应用程序上，就像谷歌的搜索小部件一样。我对此一无所知。此时任何建议或调整都会有所帮助。

我可以做一件事，在按下搜索按钮后输入查询，同时将其保存在数据库中或其他东西，如果用户回来，我可以在应用程序中填充字符串。那可能吗？如果是的话，可以告诉我如何从 SQLite 数据库中存储和检索字符串。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T22:41:19.220

您可以使用 SQLite 将搜索键与搜索时间的列一起存储在表中。然后，您可以通过时间限制访问最近的搜索。谷歌搜索 SQLite Android 将返回有关此问题的大量资源。本教程可能对开始有用：[http](http://www.vogella.com/articles/AndroidSQLite/article.html) ://www.vogella.com/articles/AndroidSQLite/article.html 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T22:44:38.187

您可以使用您编写的文件或使用 SharedPreferences 在应用程序生命周期之外存储数据：[SharedPreferenes | 安卓开发者](http://developer.android.com/reference/android/content/SharedPreferences.html)

# c# - 连接 DropDownList 和中继器

> ID：12325898
> 
> 赞同：0
> 
> 时间：2012-09-07T21:54:37.577
> 
> 标签：c#, .net, drop-down-menu, repeater

如果这个问题看起来很基本，我很抱歉，但我很茫然。我是编程新手，但有足够的知识让自己迷失方向。基本上，我有一个下拉列表和一个中继器列表。如何在更改类别下拉列表时更改列表。这是在 C# 中。

这是下拉菜单的代码：

```
protected void PopulateCategories()
{
    category myCategory = new category();
    category[] myCategoryList = myCategory.Listing("title ASC");

    ddlCategories.Items.Add("-- Select a category --");
    ddlCategories.Items.Add("View all categories");

    foreach (category category in myCategoryList)
    {
        ListItem item = new ListItem(category.title, category.category_id);
        ddlCategories.Items.Add(item);
    }
} 
```

如果您需要更多信息，请询问。我是新手，我会很感激我能得到的任何帮助。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T22:01:11.887

你有几个选择：

在下拉列表控件上，您可以添加一个 OnSelectedIndexChanged 处理程序，该处理程序可以通过将新列表数据绑定到转发器来更新转发器。

这更容易做到，但需要回发，因此在客户端并不那么灵活。

另一种方法是在 javascript 中通过将事件处理程序附加到下拉列表来处理此问题，然后更新列表。这对用户来说将是一个更好的体验，但需要更多的努力来将所有类别的所有数据放在页面上，或者在下拉列表更改时请求它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T22:02:25.583

您需要`SelectedIndexChanged`为下拉列表添加一个事件

```
public void ddlCategories_SelectedIndexChanged(object sender, EventArgs e)
{
    //Load Repeater code goes here
} 
```

在标记中定义下拉列表时：

```
<asp:DropDownList id="ddlCategories" runat="server" 
    OnSelectedIndexChanged="ddlCategories_SelectedIndexChanged" 
    AutoPostBack="true /> 
```

# c# - XmlReader 在文件上抛出异常，期待“;” 而不是“=” C# .NET

> ID：12325902
> 
> 赞同：0
> 
> 时间：2012-09-07T21:54:49.290
> 
> 标签：c#, .net, exception-handling, xhtml, xml-parsing

我正在使用 C# .NET，并且正在抓取[http://gatherer.wizards.com/Pages/Card/Details.aspx?printed=false&multiverseid=155](http://gatherer.wizards.com/Pages/Card/Details.aspx?printed=false&multiverseid=155)。在解析我粘贴的最后一行时引发了异常。由于第一个 155 前面的“=”，它被抛出。它说它期待一个“;”。我对解析 xml 不太熟悉，但那里有语法吗？如果是这样，您将如何处理网页上的错误。我正在使用它来设置阅读器：“XmlReader reader = XmlReader.Create(stream, xmlReaderSettings);” 并且阅读：“while（reader.Read（））”并且异常被抛出在reader.Read（）上。我也不熟悉异常处理，

```
 <td id="ctl00_ctl00_ctl00_MainContent_SubContent_SubContent_rightCol" class="rightCol">
            <div class="smallGreyMono">
                <b class="ft"><b></b></b>
                <div style="padding-left: 5px; font-size:.85em;">
                    Display: <b><a id="cardTextSwitchLink1" href='/Pages/Card/Details.aspx?printed=false&multiverseid=155' class="selected">Oracle</a></b> | <a id="cardTextSwitchLink2" href='/Pages/Card/Details.aspx?printed=true&multiverseid=155'>Printed</a> 
```

# java - java中的重叠图像

> ID：12325903
> 
> 赞同：1
> 
> 时间：2012-09-07T21:54:49.227
> 
> 标签：java, image, swing

我想重叠两个图像。为此，我使用 JLabel 并为其设置了 ImageIcon。我还有一个使用包含我的图像的网格布局的 JPanel（如基于图块的地图）。到目前为止，没有问题，而且效果很好。

我遇到的问题是当我试图重叠两个图像时。为此，我尝试在 gridlayout 中使用 JLayeredPane 并将两个图像 (JLabel) 放在不同的级别。此方法向我抛出此异常：

> 线程“AWT-EventQueue-0”java.lang.IllegalArgumentException 中的异常：比较方法违反了它的一般约定！

我做了一些研究并试图降级到 jdk-6 而不是 7，因为在 jdk-7 中它似乎不能很好地工作。异常现在已消失，但屏幕上没有绘制任何内容。

然后我通过创建一个扩展 JComponent 的类尝试了一种新方法，并覆盖了 paintComponent() 方法。我的类包含我的图像（JLabel）的arrayList，在paintComponent 方法中，我遍历arrayList 并使用我自己类的Graphics 对象调用每个标签的paintComponent 方法。引发了相同的异常。

这是我的 paintComponent 方法的示例：

```
@Override
public void paintComponent(Graphics g) {
    for(JLabel label : this.images) {
        label.paintComponents(g);
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T21:59:21.173

你可以使用

1.  [JLayer (Java7)](http://docs.oracle.com/javase/tutorial/uiswing/misc/jlayer.html)基于`JXLayer (Java6)`

2.  [玻璃板](http://docs.oracle.com/javase/tutorial/uiswing/components/rootpane.html)

3.  [叠加布局](http://www.java2s.com/Code/Java/Swing-JFC/LayoutOverlaySample.htm)

4.  [JLayeredPane](http://docs.oracle.com/javase/tutorial/uiswing/components/layeredpane.html)

然后您可以（例如）使用放置在[JLabel中的](http://docs.oracle.com/javase/tutorial/uiswing/components/label.html)[Icons / ImageIcons移动或动画](http://docs.oracle.com/javase/tutorial/uiswing/components/icon.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T22:03:12.220

如果覆盖`paint`or`paintComponent`是一个选项，那么我建议您使用`Graphics`or `Graphics2d`APIs 来绘制图像：

```
g.drawImage(); 
```

它为您的需要提供了更多的灵活性。

# css - 通过 Gmail 的 HTML 电子邮件中的字体大小

> ID：12325905
> 
> 赞同：3
> 
> 时间：2012-09-07T21:55:01.857
> 
> 标签：css, gmail, html-email

有没有人遇到过这样的问题，当字体大小样式应用于元素时，Gmail 客户端在呈现时不一致？例如，我将 font-size 设置为 17px，一切都渲染得太大，然后我将其设置为 16px，它变得非常小。

任何输入将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T22:00:59.360

使用`pt`而不是`px`for *font-sizes*，似乎对我有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T23:11:30.943

您在制作电子邮件模板吗？

然后你应该使用 good-old-back-to-basics 字体标签：

```
<font size="2">text</font> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T21:15:34.517

看起来他们正在覆盖字体大小并忽略文本标签（a、p 等）的 !important

当我将其应用于`font-size`包装`<td>`时，它工作正常。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-20T09:26:25.580

我今天遇到了同样的问题。我没有在这个线程上找到对我个人有帮助的答案。

但是，我通过使用具有像这样的内联样式的跨度包围所有表现不佳的文本段落来解决它

```
<span style="color:#613400;font-size:14px;font-weight:bold;font-family:Calibri,Helvetica, Arial, Sans-Serif;">TEXT</span> 
```

后来我意识到，即使我给了 font-size:14px!important; font 没有坚持可见的 14px 大小（浏览器的元素检查器显示它是 14px！），原因可能是 font-family 为那些行为不端的文本设置了不同的值。当我将 font-family 选择器添加到跨度时，一切都开始正常了。

当应用于或作为一个整体时，这种相同的风格不起作用。我发现作为解决方案的方法是，您应该使用 span 围绕它来设置所有文本的样式。

希望这对偶然发现此线程的人有所帮助！

# php - 我在哪里保存 Zend_Form 文件？

> ID：12325912
> 
> 赞同：2
> 
> 时间：2012-09-07T21:56:11.880
> 
> 标签：php, file, zend-framework, zend-form, structure

我正在尝试学习 Zend 框架！我对它很感兴趣，但我找不到说明它应该是 Zend_Form 类的存储位置的教程！也许这是很简单的事情，但我还不能明白......我看过关于这个的教程：

```
<?php
 class Form_Example extends Zend_Form
 {
  public function init()
  {
   // Great code here
  }
 } 
```

但是他们都没有说这段代码去哪里了？？？？？？在目录树的哪个文件夹中的文件中？我已经阅读并且理解并且我已经做了一个关于模块、控制器、动作、布局的小例子，并且我知道命名约定和文件夹结构的重要性。那么这个表单类必须去哪里以及如何从视图中调用它？

非常感谢，我知道这对于已经知道如何使用 Zend Framework 的人来说一定很容易 =)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T22:10:11.860

我通常将所有表单与模型、控制器和视图放在一个表单文件夹中。

所以，我的文件结构如下：

```
application ->
  configs
  layouts
  plugins
  controllers
  models
  views
  forms ->
    form1.php
    form2.php 
```

在您的应用程序中使用它们并不是那么简单。您必须在控制器中实例化表单类，然后将表单传递给您的视图。所以在你的控制器中你想要这样的东西：

```
$form1 = new Application_Form_Form1($options);
$request = $this->getRequest();

if($request->isPost()) {
  if($form1->isValid($post))  {
    // form is valid, do form processing here
  }
}

$this->view->form1 = $form1; 
```

然后在视图文件中，放置表单：

```
<html>
<body>
  <div id="body">
    <?php echo $this->form1; ?>
  </div>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-08T02:28:18.510

最好的方法是让 ZF 为您做这件事。ZF 为 windows 和 *nix 提供了一个命令行界面。

在您可以键入的命令行中`zf create form Example`，ZF 将创建一个以`Example.php`默认应用程序级别位置命名的空表单。

通常这将是 at`application/forms/Example.php`并且类名将是`Application_Form_Example`.

如果您需要在模块中构建表单，则命令将类似：
`zf create form Example -m admin`
where`-m`表示您希望在模块中创建文件，并且`admin`是模块的名称。

表单是 Zend Framework 中预定义的资源之一，因此具有默认位置。还有一些其他资源是预定义的并具有默认值。

> **[模块资源自动加载器](http://framework.zend.com/manual/1.12/en/zend.loader.autoloader-resource.html)**
> 
> Zend Framework 附带了 Zend_Loader_Autoloader_Resource 的具体实现，其中包含资源类型映射，涵盖 Zend Framework MVC 应用程序的默认推荐目录结构。这个加载器 Zend_Application_Module_Autoloader 带有以下映射：

```
 forms/          => Form
    models/         => Model
    models/DbTable/ => Model_DbTable
    models/mappers/ => Model_Mapper 
    plugins/        => Plugin 
    services/       => Service views/
    helpers         => View_Helper
    filters         => View_Filter 
```

> 例如，如果您有一个前缀为“Blog_”的模块，并尝试实例化类“Blog_Form_Entry”，它将在资源目录的“forms/”子目录中查找名为“Entry.php”的文件。当使用 Zend_Application 的模块引导时，默认情况下会为每个离散模块创建一个 Zend_Application_Module_Autoloader 实例，允许您自动加载模块资源。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-08T06:01:09.830

您问题的核心是以下问题：

1.  自动加载
2.  [ZF 自动装载机](http://framework.zend.com/manual/1.12/en/zend.loader.autoloader.html)的一般工作原理，以及
3.  ZF 自动加载器在标准 ZF 应用程序中的默认配置方式

这实际上是三个不同但明显相关的问题。

假设您有默认的 ZF 安装，其中`appnamespace`设置为“应用程序”，然后命名您的表单类`Application_Form_Example`并将其存储在文件中`application/forms/Example.php`。

然后您可以使用以下方法实例化（例如在控制器中）：

`$form = new Application_Form_Example()`.

确保您`resources.modules[] =`在`application/configs/application.ini`.

有关自动加载的更多讨论，请参阅[https://stackoverflow.com/a/10933376/131824](https://stackoverflow.com/a/10933376/131824)

# ruby - 如何编写特定的 rspec 测试？需要咨询...

> ID：12325916
> 
> 赞同：1
> 
> 时间：2012-09-07T21:56:41.427
> 
> 标签：ruby, testing, rspec, sinatra, rspec2

我是 rspec 的新手，我正在尝试了解如何编写一些特定的测试。

背景：

*   我正在测试一个 Sinatra 应用程序
*   该应用程序连接到多个数据库
*   我已将这些数据库的用户名/密码定义为环境变量，并在代码中引用这些变量。

我有工作测试，所以我知道如何测试环境变量的存在。

我是这样做的：

```
27     it "should know the username for each SUBDOMAIN in the list" do
28       @dm.domains.each do |dom|
29         ENV['C_USERNAME_' + dom].nil?.should eq(false)
30       end
31     end 
```

正如我所说，测试有效。唯一的问题是，当它失败时，不清楚哪个 dom 没有设置环境变量。失败测试的结果如下所示：

```
 dhaskew@Air1:~/code/projects/rules$ rake spec
   /Users/dhaskew/.rvm/rubies/ruby-1.9.3-p194/bin/ruby -S rspec ./spec/c_spec.rb   ./spec/main_spec.rb ./spec/routes_spec.rb
   ..F*.....*

    Pending:
      My Site Domain Manager should know the password for each SUBDOMAIN in the list
      # Not yet implemented
      # ./spec/c_spec.rb:33
      My Site GET '/rules/SUBDOMAINS' should test all subdomains
      # Not yet implemented
      # ./spec/routes_spec.rb:28

   Failures:

     1) My Site Domain Manager should know the username for each SUBDOMAIN in the list
        Failure/Error: ENV['C_USERNAME_' + dom].nil?.should eq(false)

          expected: false
          got: true

          (compared using ==)
         # ./spec/c_spec.rb:29:in `block (4 levels) in <top (required)>'
         # ./spec/c_spec.rb:28:in `each'
         # ./spec/c_spec.rb:28:in `block (3 levels) in <top (required)>'

     Finished in 0.05095 seconds
     10 examples, 1 failure, 2 pending

    Failed examples:

    rspec ./spec/c_spec.rb:27 # My Site Domain Manager should know the username for each SUBDOMAIN in the list
    rake aborted! 
```

问题：如何更好地编写此测试，以便我可以看到未定义的环境变量。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-08T00:30:06.010

一个简单的解决方案是：`it`动态生成测试。一般来说，争取每个场景/`it`块进行一次测试。在这种情况下：

```
@dm.domains.each do |dom|
  it "should know the username for #{dom} in the list" do
    ENV['C_USERNAME_' + dom].should_not be_nil
  end
end 
```

# 更新

这是一个更完整的例子。您需要在块`@dm`之外声明`before`它才能使用。

```
class DomainManager
  attr_reader :domains

  def initialize(domains)
    @domains = domains
  end
end

describe DomainManager do
  @dm = DomainManager.new( %w(example.com example.org))

  @dm.domains.each do |dom|
    it "should know the username for #{dom} in the list" do
      ENV['C_USERNAME_' + dom].should_not be_nil
    end
  end
end 
```

# c++builder - 如何在 Borland C++ Builder 上创建一组按钮并使用它？

> ID：12325918
> 
> 赞同：0
> 
> 时间：2012-09-07T21:56:53.520
> 
> 标签：c++builder

## 具体问题

如何在 Borland C++ Builder 上创建一组按钮并使用它？

我正在使用 Borland C++ Builder 6 和 Borland Developer Studio 2006 (Turbo C++ 2006)。

## 目的

使用带有索引的 for 循环来处理表单上的许多按钮，例如，更改它们的标题、大小和位置。

我知道如果`Button1`我创建了另一个按钮（通过`TButton *Button2 = new TButton(Form1)`），我是否有一个名为的按钮，并且在该按钮的单击事件中，我可以分配`Button1`给`Button2`（`Button2 = Button1`），我可以简单地修改`Button1`with的标题`Button2->Caption`。所以我想扩展它，将真实组件的指针分配给数组的元素，让它们通过`for`循环与所有这些元素一起工作。

好吧，如果有人找到一种将所有按钮作为数组添加到表单上的方法，那就更好了:)

## 尝试

在 TForm1::Button1Click() 上进行了以下测试，这是表单上按钮的事件：

*   测试 1

    *   说明：直接创建数组
    *   代码：

        ```
        TButton Buttons[3]; 
        ```

    *   结果：编译错误：

        ```
        > [C++ Error] Unit1.cpp(23): E2248 Cannot find default constructor
        > to initialize array element of type 'TButton' 
        ```

    *   注释：
        *   我测试了这个测试的一些变体（例如`TButton Buttons = new TButton[3]`，使用`calloc`函数和其他变体），但它们都指向`TButton`没有没有参数的构造函数的问题，即`TButton()`，，但只有`TButton (TComponent *AOwner)`，`TButton(void *ParentWindow)`和`TButton(const TButton &)`;
        *   有什么方法可以将运算符`new`与构造函数原型的参数一起用于`TButton`数组？
*   测试 2

    *   描述：创建向量
    *   代码：还要添加`#include "vector.h"`单元标题...

        ```
        vector<TButton> Buttons;
        Buttons[0].Caption="it is ok";
        Buttons[1].Caption="mayday, mayday"; 
        ```

    *   结果：第 3 行的调试器异常：

        ```
        > Project Project1.exe raised exception class EAccessViolation
        > with message 'Acceess violation at address 401075B9 in module
        > 'vcl60.bpl'. Read of address 00000254'. Proccess stopped. Use
        > Step or Run to continue. 
        ```

    *   注释：
        *   是的，我预计它会被提出，但我把它放在这里给某人说如何在创建后为该向量上的更多元素分配内存，因为由于`vector<TButton> Buttons(3);`相同的原因 test1 失败:(

## 一般问题

如何为任何视觉组件做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T20:43:28.387

由于相同的原因，您的所有尝试都失败了 - 您正在尝试创建实际`TButton`对象实例的数组/向量，而不是指向实例的指针的数组/向量**。**`TButton`

创建一个固定长度的按钮**指针**数组：

```
TButton* Buttons[3];
...
Buttons[0] = Button1;
Buttons[1] = Button2;
Buttons[2] = Button3;
...
for(index = 0; index < 3; ++index)
{
    TButton *Btn = Buttons[index];
    // use Btn as needed...
} 
```

要创建按钮**指针**的动态长度数组：

```
TButton** Buttons;
...
Buttons = new TButton*[3];
Buttons[0] = Button1;
Buttons[1] = Button2;
Buttons[2] = Button3;
...
for(index = 0; index < 3; ++index)
{
    TButton *Btn = Buttons[index];
    // use Btn as needed...
}
...
delete[] Buttons; 
```

要创建按钮**指针**向量：

```
std::vector<TButton*> Buttons;
...
Buttons.push_back(Button1);
Buttons.push_back(Button2);
Buttons.push_back(Button3);
...
for(index = 0; index < 3; ++index)
{
    TButton *Btn = Buttons[index];
    // use Btn as needed...
}
/*
Or:
for(std::vector<TButton*>::iterator iter = Buttons.begin(); iter != Buttons.end(); ++iter)
{
    TButton *Btn = *iter;
    // use Btn as needed...
}
*/ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-06-30T18:12:47.533

所有这一切都非常好，而且是正确的。但我的意思是用户的问题是其他意图。如果对于我们得到的所有按钮，每个索引都没有特别的好处——这只是一种真正的方法：目的是通过单击来控制所有组件（按钮、面板、形状等......）并且不要为每个索引一个新代码，这就是为什么我更改了一些程序的代码：

```
void __fastcall TForm1::Button1Click(TObject *Sender)

{

typedef TPanel* TPanels;

TPanels Panels[3] = {Panel1, Panel2, Panel3};

int count;

for(count=0;count<3;count++)

Panels[count]->Left=random(100);

} 
```

正如人们所看到的，而不是`index`这里`count`。当然不要忘记插入`randomize()`到`TForm1`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T23:38:39.940

## 神奇的 Typedef + 伪数组 = 解决方案

*   神奇的字体定义：

    *   经过几个小时的搜索，我`typedef`在 Stack Overflow 和 Google 搜索之旅中看到了一个，并想为什么不这样做：

        ```
        typedef TButton* TButtons; 
        ```

    *   好吧，它改变了所有事情，因为我可以执行：

        ```
        TButtons Buttons[3]; 
        ```

*   伪数组：

    *   问题仍然是如何为存储在该`Buttons[3]`数组上的数据分配内存，但是根据我问题的目的部分的第二段的知识，我想：忘记新数据，数据在那里，指向那里（所以我称之为构建一个伪数组，因为我只创建一个指向现有数据的指针数组）：

        ```
        TButtons Buttons[3] = {Button1, Button2, Button3}; 
        ```

    *   `Button1`当我将它们正常放在表单上时（通过我的鼠标） ，Where`Button2`和`Button3`已经创建了。

## 工作示例

1.  创建一个新的 vcl/forms 应用程序项目；
2.  将左侧的 3 个按钮（ 、 、 ）放在下图（`Button1`、`Button2`、`Button3`）上以演示该解决方案，并将 1 个大按钮（`Button4`）也作为下图来执行操作； ![下图点2](../Images/46aacc8bca4bc4498db27d5c1b8bb63c.png)
3.  在第四个按钮的单击事件上插入以下代码，即大按钮 ( `Button4`)；

    ```
    typedef TButton* TButtons;
    TButtons Buttons[3] = {Button1, Button2, Button3};
    int index;

    for(index=0;index<3;index++)
    {
            Buttons[index]->Caption=(AnsiString)"teste "+index+" - "+(1+random(100));
            Buttons[index]->Left=25+4*random(100);
            Buttons[index]->Top=25+4*random(100);
    } 
    ```

4.  执行“沙赞！” 一边跑一边玩…… ![像一个游戏项目](../Images/25560e3f6414ad6af62b233425ed2156.png)

# android - android：如何使用自定义颜色？

> ID：12325921
> 
> 赞同：9
> 
> 时间：2012-09-07T21:56:57.823
> 
> 标签：android, background-color, android-framelayout

我试图`FrameLayout`用我自己的颜色设置我的背景颜色。

我创建了一个`.xml`包含我自己颜色的文件。这里是：

```
<?xml version="1.0" encoding="utf-8"?> 
<resources>
    <color name="red">#FF0000</color>
    <color name="orange">#FF7D00</color>
    <color name="yellow">#FFFF00</color>
    <color name="green">#00FF00</color>
    <color name="blue">#00B4FF</color>
    <color name="black">#000000</color>
</resources> 
```

这是我试图设置背景颜色的代码，但是当我运行应用程序时，`FrameLayout`它总是灰色的，为什么？：

```
FrameLayout MyFrameLayout = new FrameLayout(this);
LayoutParams MyFrameLayoutParam = new LayoutParams(LayoutParams.FILL_PARENT, 200);
MyFrameLayout.setLayoutParams(MyFrameLayoutParam);

MyFrameLayout.setBackgroundColor(R.color.red);

Parent.addView(MyFrameLayout); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-07T21:59:51.313

您需要在设置颜色之前从资源中检索颜色。您分配的是 R.java id 而不是实际值。

```
Color red = getApplicationContext().getResources().getColor(R.color.red)
MyFrameLayout.setBackgroundColor(red); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-12-11T10:10:25.587

这使按钮背景变为绿色，找到所需的颜色十六进制。

yourButton.setBackgroundColor(Color.parseColor("#25b72f"));

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-11-08T15:56:08.997

要在 xml 中使用您的自定义颜色，您可以使用以下内容：

`android:color="@color/orange"`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-11-20T15:12:43.520

您可以使用 setBackgroundResource(Color)

这里有一个例子：

`relativelayout.setBackgroundResource(R.color.green);`

# ruby-on-rails - unicorn 和 unicorn_rails 有什么区别？

> ID：12325923
> 
> 赞同：23
> 
> 时间：2012-09-07T21:57:09.753
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, unicorn

那么......我应该何时使用一种或另一种有`unicorn`什么区别？`unicorn_rails`

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-09-07T22:17:31.747

它在[https://blog.engineyard.com/2010/everything-you-need-to-know-about-unicorn](https://blog.engineyard.com/2010/everything-you-need-to-know-about-unicorn)中得到正式回答：

**什么是独角兽可执行文件？什么是 unicorn_rails 可执行文件？**

可执行文件是 Rack 的“rackup”模型的`unicorn`Rack-only 工具，推荐用于 Rack 应用程序。`unicorn_rails`对于 Rails 的 pre-Rack 版本的用户来说，这是一个更容易的过渡。该手册页鼓励 Rails 3 用户改用 plain `unicorn`。

**有什么不同？**

从`unicorn_rails`联机帮助页中，一些约定`unicorn_rails`是仿照`script/server`在 Rails 中找到的。它在“tmp”下创建目录，例如`script/server`开关`-E/–environment`设置`RAILS_ENV`而不是`RACK_ENV`.

除此之外，根据我的经验，某些 gem 可能特别需要 unicorn_rails，例如 activeadmin（请参阅[此](https://github.com/gregbell/active_admin/issues/298#issuecomment-1589377)）

另外，[手册页：](http://unicorn.bogomips.org/unicorn_rails_1.html)

> 它旨在帮助 Rails 1.x 和 2.y 用户过渡到 Rack，但 Rails 3 应用程序不需要它。鼓励 Rails 3 用户使用 unicorn(1) 而不是 unicorn_rails(1)。Rails 1.x/2.y 的用户也可以使用 unicorn(1) 代替 unicorn_rails(1)。

# c# - 在C#中通过字符串获取对象属性的属性

> ID：12325924
> 
> 赞同：0
> 
> 时间：2012-09-07T21:57:16.920
> 
> 标签：c#

如何使用字符串访问对象实例中的属性属性？我想自动更改我将在表单中进行的更改，例如响应以下对象：

```
class myObject{
   Vector3 position;
   public myObject(){
       this.position = new Vector3( 1d,2d,3d);
   }
}; 
```

表格有例如三个`numericUpDown`分别称为`position_X`, `position_Y`, `position_Z`; 取而代之的是三个事件回调：

```
private void positionX_ValueChanged(object sender, EventArgs e)
  { 
    // this.model return myObject
    this.model().position.X = (double)  ((NumericUpDown)sender).Value;

  } 
```

我会有一个回调，它可以从控件名称/标签自动设置模型中的特定属性

下面是描述我想要的目的的javascript:)

```
position_Changed( sender ){
   var prop = sender.Tag.split('_'); ; // sender.Tag = 'position_X';      
   this.model[ prop[0] ] [ prop[1] ] = sender.Value;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T22:02:00.090

您可以使用反射或表达式树来做到这一点。

简单的反射方式（不是很快但用途广泛）：

```
object model = this.model();
object position = model.GetType().GetProperty("position").GetValue(model);
position.GetType().GetProperty("X").SetValue(position, ((NumericUpDown)sender).Value); 
```

**注意：**如果`Vector3`是一个结构，您可能不会得到预期的结果（但这与结构和装箱有关，而不是与代码本身有关）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T22:05:28.833

为了补充前面的答案，这基本上是您正在寻找的：

```
object model = this.model();
object position = model.GetType().GetProperty("position").GetGetMethod().Invoke(model, null);
var propName = (string) ((NumericUpDown)sender).Tag;
position.GetType().GetProperty(propName).GetSetMethod().Invoke(model, new [] {((NumericUpDown)sender).Value}); 
```

也就是说，您可以只使用 的`Tag`属性来指定实例“绑定”到`Control`Vector3 对象的哪个属性。`NumericUpDown`

# axis2 - 如果服务器正在使用它，是否有必要在客户端上使用 Rampart？

> ID：12325927
> 
> 赞同：1
> 
> 时间：2012-09-07T21:57:31.957
> 
> 标签：axis2, ws-security, rampart

我正在开发 Web 服务，并且正在服务器上使用 Axis2 + Rampart。是否有必要在 Web 服务的两端都有 Rampart？或者是否有可能有一个使用 Rampart 以外的东西实现 WS-Security 的客户端？

我发现的 Rampart 的例子似乎在两端都假设 Rampart。我不知道这是否只是方便，或者是否有必要。我对客户没有任何控制权。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-08T13:51:04.017

不，没有必要在客户端上使用 Rampart。Rampart 基本上是根据 WS-Security* 规范处理 SOAP 消息中的安全标头。因此，如果客户端可以发送包含符合 WS-Security* 规范的标准安全标头的有效 SOAP 消息，则壁垒将成功处理请求并验证安全性。

# html - 当孩子的数量可能不同时，将 div 的孩子居中

> ID：12325931
> 
> 赞同：1
> 
> 时间：2012-09-07T21:57:44.840
> 
> 标签：html, css

我有一个场景，我有一个 940 像素宽度的框，最多有 4 个 140 像素的子 div，它们之间有 20 像素，漂浮在一条线上。当有 1、2、3 或 4 个子 div 时，我希望 CSS 强制子 div 组居中。目前，当第 4 个被移除时，前 3 个的位置不会改变。

我正在使用 LESS。

我的代码：

```
#parent
{
    position: relative;
    width: 940px;
    clear: both;
    background-image: url(../images/bg.png);
    background-repeat: repeat-x;
    height: 100px;
    margin: 0 auto;
    margin-top: 2px;
}

#parent h1
{
    position: absolute;
    color: white;
    font-size: 36px;
    font-weight: 400;
    margin: 0;
    padding: 0;
    left: 5px;
    top: -24px;
}

#children
{
    position: relative;
    margin: 0 auto;
    margin-top: 35px;
}

.child
{
    width: 140px;
    padding-right:20px;
    float: left;
    text-align: center;   
}

#children:last-child
{
    padding-right: 0px;
    clear: right;
} 
```

编辑：HTML ......

```
<div id="parent">

    <h1>Lorem Ipsum</h1>

    <div id="children">

        <div class="child" id="1"></div>
        <div class="child" id="2"></div>
        <div class="child" id="3"></div>
        <div class="child" id="4"></div>

     </div>

 </div> 
```

此外，#children:last-child 似乎什么也没做。我假设它的规则应该适用于#4 是否正确？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-08T00:37:37.217

只需将 div #children 的宽度设置为 100% 和 text-align:center，这样它的 CSS 就变成了这样：

```
#children
{
    position: relative;
    margin: 0 auto;
    margin-top: 35px;
    width: 100%;
    text-align: center;
} 
```

对于子元素，您必须删除 float 属性并给它们一个相对位置：

```
.child
{
    width: 140px;
    padding-right:20px;
    text-align: center;   
    position: relative;
} 
```

它应该有效。如果您通过它的 id 清楚地指定最后一个子选择器，它也是首选， :last-child 不会在 IE7 或 IE6 上工作：

```
#4.child{
    padding-right: 0px;
    clear: right;
} 
```

我认为你不应该以数字开头任何 id，id="1" | id="2" 等。它的语法不正确。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-08T00:44:12.287

这是一个可以正常工作的jsfiddle：

[http://jsfiddle.net/emYfz/](http://jsfiddle.net/emYfz/)

```
#children {
  width: 100%;
  text-align: center    
}

.child {
 display: inline-block;
 width: 140px;
 height: 20px;
 margin: 5px;
 background: #f00;
} 
```

# magento - 最好在模板 Magento 中调用模板

> ID：12325934
> 
> 赞同：0
> 
> 时间：2012-09-07T21:58:08.070
> 
> 标签：magento

因此，我一直在研究一个 Magento 模块，该模块在用户未登录时隐藏价格。感谢@AlanStorm，我得到了它的工作，但我只是想确保它我正在寻找最好的方法。

我所做的是为 *catalog_product_price_template* 块设置一个不同的模板，然后我做了所有的逻辑

```
<?php   $_message = Mage::getStoreConfig('catalog/pricehideconfig/title'); 
        $_enabled = Mage::getStoreConfig('catalog/pricehideconfig/active');
        $_current_template = Mage::getBaseDir('design') 
                        . '/frontend/' 
                        . Mage::getSingleton('core/design_package')->getPackageName() . '/' 
                        . Mage::getSingleton('core/design_package')->getTheme('frontend') .'/'
                        . 'template/catalog/product/price.phtml';

        $_default_template = Mage::getBaseDir('design') . '/frontend/base/default/template/catalog/product/price.phtml';
?>

<p>
    <?php if (  $_enabled && !($this->helper('customer')->isLoggedIn()) ) { ?>
        <?php echo $_message; ?>
    <?php } else { 

        if (file_exists($_current_template)){ 
            include $_current_template;
        } else{
            include $_default_template;
        }

     } ?>

</p> 
```

然而，两部分似乎真的很不自然

1.  调用'原始'或默认模板代码的价格感觉不对，Magento是否提供任何功能来做到这一点，在模板中调用默认模板，同时检查模板是否存在于当前包中，然后恢复为默认值如果没有？

2.  我认为模板应该仅用于演示，因此应该将变量分配移到一个块中，但我不能这样做，因为我只是设置模板而不是扩展 *Mage_Catalog_Block_Product_Price_Template*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-09T01:21:52.923

我真的不明白上面的代码！

如果您想对未登录的客户隐藏价格，我使用的最简单和最好的方法是：

该模块将只有一个块和 config.xml

扩展 - 重写类 Mage_Catalog_Block_Product_Price

```
class Namespame_ModuleName_Block_Product_Price extends Mage_Catalog_Block_Product_Price
{
    // and Override _toHtml Function to be 
    protected function _toHtml()
    {
        if(!$this->helper('customer')->isLoggedIn()){
             $this->getProduct()->setCanShowPrice(false);
        }

        if (!$this->getProduct() || $this->getProduct()->getCanShowPrice() === false) {
            return '';
        }
        return parent::_toHtml();
    }
} 
```

无需向视图/模板/布局添加更多代码即可完美运行！

如果您仍想设置模板，您也可以这样做：

```
class Namespame_ModuleName_Block_Product_Price extends Mage_Catalog_Block_Product_Price
{
    // and Override _toHtml Function to be 
    protected function _toHtml()
    {
        if(!$this->helper('customer')->isLoggedIn()){
              $this->setTemplate('mymodule/price_template.phtml');
        }

        if (!$this->getProduct() || $this->getProduct()->getCanShowPrice() === false) {
            return '';
        }
        return parent::_toHtml();
    }
} 
```

谢谢

# javascript - 使用 Ajax 的 Post 方法发送多个值的问题

> ID：12325936
> 
> 赞同：0
> 
> 时间：2012-09-07T21:58:14.580
> 
> 标签：javascript, html, ajax, forms, post

我的目标是通过 ajax 函数提交整个表单，然后将这些值发送到 php 文件。我使用 Post 有几个原因 - 一个是我将更改 MySQL 数据库中的数据。

我在寻找答案时看过一些示例，但似乎没有一个示例直接解决了我遇到的问题。

例如，这个例子：

```
var url = "get_data.php";
var params = "lorem=ipsum&name=binny";
http.open("POST", url, true);

// Send the proper header information along with the request
http.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
http.setRequestHeader("Content-length", params.length);
http.setRequestHeader("Connection", "close");

// Call a function when the state changes.
http.onreadystatechange = function() {
    if(http.readyState == 4 && http.status == 200) {
        alert(http.responseText);
    }
}
http.send(params); 
```

开始解决它。

具体来说，我不确定如何发送多个值。在上面找到的示例中，我看到他们将两个值硬编码到变量 params 中的语句中。我想知道如何将这些值传递给函数，而不必对它们进行硬编码。

我的表格：

```
<table border="0" cellpadding="2" cellspacing="5">
    <th colspan="2" align="center">Check Out</th>
    <form name="checkOut" method="post" onSubmit="return(validate(this))"> 
        <tr>
            <td>Territory Number</td>
            <td><input type="text" name="numberOut" tabindex="1" maxlength="3" size="3" /></td>
        </tr>
        <tr>
            <td>First Name of Publisher</td>
            <td><input type="text" onKeyUp="showHint(this.value)" name="fName" tabindex="2" maxlength="15"/></td>
        </tr>
        <tr>
            <td>Last Name of Publisher</td>
            <td><input type="text" onKeyUp="showHint_l(this.value)" name="lName" tabindex="3" maxlength="15" /></td>
        </tr>
        <tr>
            <td>Special Campaign</td>
            <td><input type ="checkbox" name="specialC" tabindex="4" value="Yes"/></td>
        </tr>
        <tr>
            <td><input type="button" onClick="clearForm()" value="Reset" /></td>
            <td><input type="submit" value="Check Out" /></td>
        </tr>
    </form>
    <p>Suggestions: <span id="txtHint"></span></p>
</table> 
```

在这里，我想传递 numberOut、fName、lName 和 specialC 的值。我知道如何单独通过它们，但不是作为一个群体。最终，我希望能够通过 php 访问这些值，例如 $_POST['fName'] 。

在这个网站上看到几个类似问题的答案后，很多人说要使用 jQuery。我知道这更容易，但我想先学习使用 ajax，因为我是基于 Web 的语言的新手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T22:13:06.943

您将必须创建`params`

这是给你的示例代码

```
var params = "numberOut="+document.getElementsByName("numberOut")[0].value;
params+="?fName="+document.getElementsByName("fName")[0].value;
params+="?lName="+document.getElementsByName("lName")[0].value;
var isSc = document.getelementsByName("specialC")[0].checked;
if(isSc){
    params+="?specialC=Yes";
} 
```

# xml - XSL 转换 XML 仅过滤掉元素和属性值？

> ID：12325937
> 
> 赞同：0
> 
> 时间：2012-09-07T21:58:17.227
> 
> 标签：xml, xslt, localization, xmldiff

我需要将以下 XML 转换为具有相同元素和属性的 XML，但可以本地化的值除外 - 基本上是英语短语。

一些元素 ( `<footnote>`) 和属性是可选的 ( `<display_data_type>`)，我希望能够通用地执行此操作 - 无需为每个元素提供模板。那可能吗？

最终目标是能够将 XML 的默认版本与本地化版本进行比较，忽略本地化字符串。

例如以下：

```
<data_schema>
    <field symbol="ACCOUNT" type="string" name="Account Number">
        <validators>
            <maxlength>6</maxlength>
        </validators>
        <description>The account number</description>
        <example>123456</example>
        <default_value></default_value>
    </field>
    <field symbol="POSTAL_CODE" type="string" name="Postal Code">
        <description>Postal Code for account</description>
        <example>22022</example>
        <footnote>Does not apply to certain accounts</footnote>
        <default_value></default_value>
    </field>
    <field symbol="DISCOUNT" type="string" name="Discount Percentage" display_data_type="percentage">
        <description>Descount determined by account</description>
        <example>1.5%</example>
        <default_value></default_value>
    </field>
</data_schema> 
```

将转换为：

```
<data_schema>
    <field symbol="ACCOUNT" type="string" name="">
        <validators>
            <maxlength>6</maxlength>
        </validators>
        <description/>
        <example/>
        <default_value/>
    </field>
    <field symbol="POSTAL_CODE" type="string" name="">
        <description/>
        <example/>
        <footnote/>
        <default_value/>
    </field>
    <field symbol="DISCOUNT" type="string" name="" display_data_type="percentage">
        <description/>
        <example/>
        <default_value/>
    </field>
</data_schema> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-08T08:13:44.973

这是另一种方法。这个基于“身份转换”的 XSLT 设计模式，它基本只是按原样复制所有节点。

```
<xsl:template match="@*|node()">
   <xsl:copy>
      <xsl:apply-templates select="@*|node()"/>
   </xsl:copy>
</xsl:template> 
```

您可以扩展它以添加其他模板匹配项以匹配您要对其执行特定操作的节点，在您的情况下是删除文本。所需的模板将取决于转换的确切规则。

如果您希望从特定元素和属性中删除文本，您将添加以下两个模板，以复制节点但不包含文本：

```
<xsl:template match="description|example|footnote|default_value">
   <xsl:copy/>
</xsl:template>

<xsl:template match="@name">
   <xsl:attribute name="{name()}"/>
</xsl:template> 
```

因此，在这种情况下，元素**description**、**example**、**footnote**和**default_value与****@name**属性一起删除了它们的文本。所有其他节点将按原样复制其文本。

另一方面，如果你有一个特定的元素和属性列表，你想保持不变，你可以像这样添加模板

```
<xsl:template match="field/*[not(self::validators)]">
   <xsl:copy/>
</xsl:template>

<xsl:template match="@symbol|@type|@display_data_type">
   <xsl:copy/>
</xsl:template>

<xsl:template match="@*">
   <xsl:attribute name="{name()}"/>
</xsl:template> 
```

因此，对于**验证器**元素，您实际上是在说，删除所有不是**验证器**元素的东西。**验证器**元素将由身份转换模板复制。对于属性，我展示了一种稍微不同的方法，其中明确列出了要保留的属性，并且您有第二个模板可以从所有其他模板中删除文本。

这是本例中的两个完整 XSLT。

第一个用于从特定节点中删除文本

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
   <xsl:output method="xml" indent="yes"/>

   <xsl:template match="description|example|footnote|default_value">
      <xsl:copy/>
   </xsl:template>

   <xsl:template match="@name">
      <xsl:attribute name="{name()}"/>
   </xsl:template>

   <xsl:template match="@*|node()">
      <xsl:copy>
         <xsl:apply-templates select="@*|node()"/>
      </xsl:copy>
   </xsl:template>
</xsl:stylesheet> 
```

第二个用于将文本保存在特定节点中

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
   <xsl:output method="xml" indent="yes"/>

   <xsl:template match="field/*[not(self::validators)]">
      <xsl:copy/>
   </xsl:template>

   <xsl:template match="@symbol|@type|@display_data_type">
      <xsl:copy/>
   </xsl:template>

   <xsl:template match="@*">
      <xsl:attribute name="{name()}"/>
   </xsl:template>

   <xsl:template match="node()">
      <xsl:copy>
         <xsl:apply-templates select="@*|node()"/>
      </xsl:copy>
   </xsl:template>
</xsl:stylesheet> 
```

对于您的示例文档，两者都应该产生相同的输出：

```
<data_schema>
   <field symbol="ACCOUNT" type="string" name="">
      <validators>
         <maxlength>6</maxlength>
      </validators>
      <description/>
      <example/>
      <default_value/>
   </field>
   <field symbol="POSTAL_CODE" type="string" name="">
      <description/>
      <example/>
      <footnote/>
      <default_value/>
   </field>
   <field symbol="DISCOUNT" type="string" name="" display_data_type="percentage">
      <description/>
      <example/>
      <default_value/>
   </field>
</data_schema> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T23:21:30.370

这是一个例子。应用这样的模板时，应创建树的副本，减去非符号或类型的属性的文本区域和属性文本。

```
<xsl:template match="*">
  <xsl:element name="{name()}">
    <xsl:for-each select="@*">
      <xsl:choose>
        <xsl:when test="name() = 'symbol' or name() = 'type'">
          <xsl:copy-of select="."/>
        </xsl:when>
        <xsl:otherwise>
          <xsl:attribute name="{name()}"/>
        </xsl:otherwise>
      </xsl:choose>
    </xsl:for-each>  

    <xsl:apply-templates select="*"/>
  </xsl:element>
</xsl:template> 
```

# java - 如何在布局中移动组件？

> ID：12325940
> 
> 赞同：4
> 
> 时间：2012-09-07T21:58:36.813
> 
> 标签：java, swing, components, jlabel

使用布局时如何在框架中移动组件？我试过这个：

```
 System.out.println(test1.getLocation());
    int oy = test1.getY();
    int ox = test1.getX();
    oy++;
    ox++;
    test1.setLocation(ox, oy);
    validate();
    test1.validate();
    System.out.println(test1.getLocation()); 
```

第一个位置与最后一个位置相同。我知道您在正常布局中无法更改位置，但是您如何完成呢？我以前也问过类似的问题，但从未得到答案。我已经在整个互联网上搜索了这个，但我还没有找到答案。

TL;DR - 你如何移动一个组件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T22:06:24.233

问题是`LayoutManager`面板正在为您设置标签的位置。

您需要做的是将布局设置为`null`：

```
setLayout(null); 
```

这将使框架/面板不会尝试自行布局组件。

然后`setBounds(Rectangle rect)`在标签上调用。像这样：

`lbl.setBounds(new Rectangle(new Point(200, 300), lbl.getPreferedSize()));` 这应该将组件放置在您想要的位置。

但是，如果您没有真正充分的理由自己布置组件，那么使用`LayoutManager`s 来为您工作通常是一个更好的主意。

[这](http://docs.oracle.com/javase/tutorial/uiswing/layout/visual.html)是一个关于开始使用`LayoutManager`s 的很棒的教程，如果你必须使用绝对，那么看看[这个](http://docs.oracle.com/javase/tutorial/uiswing/layout/none.html)教程

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-07T22:14:38.650

可能会帮助您查看[DragLayout](http://tips4java.wordpress.com/2011/10/23/drag-layout/)并与[ComponentMover](http://tips4java.wordpress.com/2009/06/14/moving-windows/)结合，由`@camickr`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-07T22:09:25.930

该`setLocation()`方法在将布局设置为`null`. 如果您使用的是布局管理器，那么一种选择是从其容器中删除组件并使用新的布局约束将其添加回来。

# arrays - 使用处理匹配字符串数组中的字符串

> ID：12325945
> 
> 赞同：0
> 
> 时间：2012-09-07T21:59:03.323
> 
> 标签：arrays, string, split, match, processing

我一直在 Processing 中使用 match 函数来匹配字符串。但是，在尝试匹配字符串数组中的字符串时，我遇到了问题。下面的代码是我想要做的一个例子：

```
String zj = "(V)X(PL)X(FR)";
String z = "(V)X(AV)X(FR2)";

String[] list4 = split (zj,'X');
String[] list5 = split (z, 'X');

String BZJ = list4[0];
String BZ = list5[0];

String [] Y = match (BZJ,BZ);
if (Y != null)
{
  println ("correct");
}
else
{
  println ("incorrect");
} 
```

问题是，如果所有字符都不同，我只会收到“不正确”的答案。从打印输出看来，如果它可以匹配任何字符，则该功能似乎是满意的。所以对于示例代码，我的程序会将“FR”与“FR2”匹配。如果我人为地更改字符串以使它们在每个字符中都不同，那么（并且只有这样）我会收到“不正确”的答案。如果我只是独立比较两个字符串，则情况并非如此，其中函数（据我所知）仅在整个字符串匹配时才满足。任何想法一如既往地受到高度赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T22:03:55.997

在您的示例代码中，只需使用即可`.equals()`：

```
if (BZ3.equals(BZ)) {
    println ("correct");
... 
```

# java - 读取可以是整数或字符的输入的简单方法是什么？

> ID：12325947
> 
> 赞同：3
> 
> 时间：2012-09-07T21:59:10.690
> 
> 标签：java

由于无法调用 nextChar()，我不确定我应该如何读取可能是 2 个整数（由空格分隔）或字符的输入。帮助？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T22:04:27.733

首先，而不是`if (next=="q")` 用来`if (next.equals("q"))`比较字符串。请注意，即使`"q"`是单个字符，它仍然是一个`String`对象。您可以使用`next.charAt(0)`来获取`char` `'q'`，然后，您确实可以使用`next == 'q'`.

此外，不要`next()`使用 use `nextLine()`，如果用户没有键入`"q"`，请拆分行以获取两个整数。否则，如果您调用`next()`了两次，然后只输入`"q"`，您将永远不会退出程序，因为扫描仪将等待用户输入内容以从第二次返回`next()`：

```
String next = keyboard.nextLine();
if (next.equals("q")) {
  System.out.println("You are a quitter. Goodbye.");
}
else {
  String[] pair = next.split(" ");
  int r = Integer.valueOf(pair[0]);
  int c = Integer.valueOf(pair[1]);
  System.out.printf("%d %d\n", r, c);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T22:01:09.847

你必须`next.equals("q")`改用。`==`通常应仅用于基元。尝试这个：

```
Scanner keyboard = new Scanner(System.in);
System.out.print("Enter a coordinate [row col] or press [q] to quit: ");
String next = keyboard.nextLine();

if (next.equals("q")){  // You can also use equalsIgnoreCase("q") to allow for both "q" and "Q".
    System.out.println("You are a quitter. Goodbye.");
    isRunning=false;
}
else {
    String[] input = next.split(" ");
    // if (input.length != 2) do_something (optional of course)
    int r = Integer.parseInt(pair[0]);
    int c = Integer.parseInt(pair[1]);
    // possibly catch NumberFormatException...
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-07T22:01:48.103

字符串比较应该是

```
"q".equals(next) 
```

`==`比较是否指向同一个对象的两个引用。一般用于基元比较。

`.equals()`比较值对象必须确定相等。

# excel - Excel VBA：将日期字符串转换为 Unix 时间戳

> ID：12325948
> 
> 赞同：7
> 
> 时间：2012-09-07T21:59:12.833
> 
> 标签：excel, vba, date, timestamp

Excel VBA：如何将日期字符串
“2012-08-20”转换为时间戳：1345438800
我需要将 1345438800 作为长数据类型值存储在单元格中。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-09-07T22:17:17.893

时间戳日期：

```
Public Function toUnix(dt) As Long
    toUnix = DateDiff("s", "1/1/1970", dt)
End Function 
```

迄今为止的时间戳：

```
Public Function fromUnix(ts) As Date
    fromUnix = DateAdd("s", ts, "1/1/1970")
End Function 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-05-12T08:12:40.747

为确保准确的完整往返行程，请向 DateDiff 和 DateAdd 函数添加时间戳：

时间戳日期：

```
Public Function toUnix(dt) As Long
    toUnix = DateDiff("s", "1/1/1970 00:00:00", dt)
End Function 
```

迄今为止的时间戳：

```
Public Function fromUnix(ts) As Date
    fromUnix = DateAdd("s", ts, "1/1/1970 00:00:00")
End Function 
```

# jquery-mobile - jQuery 移动 ThemeRoller 错误？

> ID：12325957
> 
> 赞同：0
> 
> 时间：2012-09-07T22:00:08.853
> 
> 标签：jquery-mobile, asp.net-mvc-4, themeroller

我使用 ThemeRoller 创建了 2 个具有自定义背景颜色和样式的不同按钮（主题 C 和 D）。然后我导入了样式表并在我的 Asp.Ner mvc4 项目中使用它。虽然按钮的样式符合预期，但列表项和按钮已丢失其图像。

我的网络项目正在使用主题 B 来处理其他所有内容。

然后我尝试将[http://code.jquery.com/mobile/1.1.1/jquery.mobile.structure-1.1.1.css](http://code.jquery.com/mobile/1.1.1/jquery.mobile.structure-1.1.1.css)加载到 ThemeRoller 中，希望这些图标不会丢失并创建主题 F 和 G .

在项目中使用它时也会发生同样的事情。列表项丢失了漂亮的右箭头图标，后退按钮丢失了左箭头图标。没有检查其他图标。

有没有其他人遇到过同样的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T22:42:10.770

我的自定义 jQuery Mobile 1.1.0 主题也有同样的问题（IE8 中缺少图标）。但是，当我从 ThemeRoller 下载默认主题并在我的网站上使用它时，图标显示正确。

我发现当你只要点击 DISC COLOR 和 DISC OPACITY 设置，即使没有实际更改这些设置，然后下载默认主题，.css 文件中以下代码中的背景颜色也会从 #666666 更改（默认设置）到#FFFFFF。

.ui-icon,
.ui-icon-searchfield:after {
background: #666666 /*{global-icon-color}*/;

我编辑了我的自定义样式表，使其背景颜色为#666666，并且图标在 IE8 中变得可见。

同样的行为也适用于两个 DEFAULT ICON 设置，以及不同版本的 jQuery Mobile（例如，1.2.0）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-08T02:45:42.777

您可能缺少图标包。下载 jquerymobile 完整 zip，将图像文件夹复制到您的项目所在的位置。那应该这样做。它通常包含以下文件：`ajax-loader.gif`, `ajax-loader.png`, `icons-18-black.png`, `icons-18-white.png`, `icons-36-black.png`,`icons-36-white.png`

# sql - 我想通过 MS SQL 中的交替数字进行排序，例如 1、2、3、1、2、3 等

> ID：12325958
> 
> 赞同：1
> 
> 时间：2012-09-07T22:00:24.437
> 
> 标签：sql, sql-server, tsql, sql-order-by

我在 MS SQL 数据库中有一个表，其中包含值 1 或 2 或 3

现在我想做一个 ORDER BY 得到这样的记录 1,2,3,1,2,3,1,2,3

这看起来更难了..我已经编程了 10 年了，这个让我陷入困境;-)

有人有什么好主意吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-07T23:16:38.697

```
DECLARE @T TABLE(A INT) 

INSERT @T VALUES(1),(1),(1),(2),(2),(2),(3),(3),(3)

SELECT A FROM (
SELECT ROW_NUMBER() OVER(PARTITION BY A ORDER BY A) R, A
FROM @T
) B
ORDER BY R, A 
```

# c - 如何在快速排序中使枢轴元素通用？

> ID：12325959
> 
> 赞同：0
> 
> 时间：2012-09-07T22:00:25.323
> 
> 标签：c, sorting, pivot, quicksort

我正在尝试使用快速排序对文件中存在的 100k 元素进行排序。我的算法仅在我使用第一个元素作为枢轴时才有效。如何使枢轴元素对程序通用？使用快速排序选择枢轴元素的最佳方法是什么？枢轴元素是依赖于数据还是我们实时使用任何特定算法？

```
void quicksort(int *temp,int p,int r)
{
    if(r > p + 1)
    {
        int piv = temp[p];
        int left = p + 1;
        int right = r;
        while(left < right)
        {
            if(temp[left] <= piv)
                left++;
            else
                swap(&temp[left], &temp[--right]);
        }
        swap(&temp[--left], &temp[p]);
        quicksort(temp, p, left);
        quicksort(temp, right, r);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T22:09:08.123

对枢轴选择的限制是它需要相当快。常见的方法是选择第一个元素、选择中间元素或选择随机元素。

使用随机元素可能是最好的，因为即使对于已经排序的列表，它仍然倾向于快速排序（使用第一个元素在排序列表上的表现会很差，因为以下所有元素都将落在枢轴的一侧）。

使用中间元素也是相当安全的，除非你的列表是一些奇怪的非标准顺序，比如你可以通过连接两个以相反顺序排序的列表来找到它。

我建议随机选择。

> 我的算法只有在我使用第一个元素作为枢轴时才有效

当您这么说时，您的意思是如果您的枢轴不是第一个元素，它会产生一个错误排序的列表吗？你能说得更详细些吗？

# azure - 如何为 Azure 存储设置区域

> ID：12325961
> 
> 赞同：2
> 
> 时间：2012-09-07T22:00:33.153
> 
> 标签：azure

我的 Azure SQL 数据库位于美国中北部（选为区域）。我也想在那里创建一个 Azure 存储。问题是我在创建新选项时只看到美国西部和东部在我的选择中。我不想有延迟和额外的成本。有谁知道如何处理这个？例如，我是否应该尝试将我的数据库转移到美国东部？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T22:28:40.743

目前并非所有区域都提供所有 Windows Azure 平台服务（多种因素）。因此，您唯一的选择可能是将数据库重新定位到另一个区域。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T22:30:38.423

如果您访问[https://windows.azure.com/](https://windows.azure.com/)（旧门户），然后访问左侧的托管服务帐户、存储和 CDN 选项卡，然后单击顶部的新存储帐户，那么您应该能够创建一个新的一个在美国中北部，我可以...

此外，您最好的选择是创建关联组，然后使用此关联，以便您轻松轻松地将所有东西放在一起。

您确实可以选择移动数据库并创建一个新的关联组，但如果美国中北部满足您的需求，我认为在这种情况下您不需要这样做......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T23:43:54.823

在@Brent 的回答中添加一点：这是您需要联系客户支持的地方，以查看您的订阅是否可以在 N. Central 中启用存储，以与您的 SQL 资源保持一致。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-02T08:46:17.480

免费试用订阅的地区列表可能有限。

我还注意到[旧门户](https://manage.windowsazure.com/)中的一个错误，当订阅更改时它不刷新区域下拉列表。它在[新的（测试版）门户](https://portal.azure.com)中运行良好。

# sas - 在 SAS 中生成相互依赖的数据

> ID：12325963
> 
> 赞同：4
> 
> 时间：2012-09-07T21:29:19.073
> 
> 标签：sas

我正在尝试计算 SAS 中的一列，该列依赖于自身。例如，我有以下初始值列表

```
 ID Var_X Var_Y Var_Z
     1     2     3     .   
     2     .     2     .
     3     .     .     .
     4     .     .     .
     5     .     .     .
     6     .     .     .
     7     .     .     . 
```

我需要填补空白。公式如下：

```
 Var_Z = 0.1 + 4*Var_x + 5*Var_Y
    Var_X = lag1(Var_Z)
    Var_Y = lag2(Var_Z) 
```

正如我们看到的 Var_X、Var_Y 和 Var_Z 的值是相互依赖的。所以计算需要遵循特定的顺序。

```
First we compute when ID = 1, Var_Z = 0.1 + 4*2 + 5*3 = 23.1
Next, when ID = 2,  Var_X = lag1(Var_Z) = 23.1 
```

Var_Y 在 ID = 2 时不需要计算，因为我们这里已经有了初始值。所以，我们有

```
 ID Var_X Var_Y Var_Z
     1     2     3  23.1   
     2   23.1    2  102.5 (= 0.1 + 4*23.1 +5*2)
     3     .     .     .
     4     .     .     .
     5     .     .     .
     6     .     .     .
     7     .     .     . 
```

我们不断重复这个过程，直到计算出所有的值。

有没有办法，SAS可以处理这个？我尝试了 DO 循环，但我想我没有做好正确的编码工作。它在 ID = 2 后停止。

我是 SAS 的新手，所以不熟悉 SAS 是否有办法轻松处理这个问题。将等待您的建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-08T02:24:32.030

如果您只是在单个数据步骤中执行此操作，则不需要使用 LAG 或 RETAIN。DO 循环本身会很好地处理事情。只有当我们做一些涉及预先存在的数据集的事情时，才需要 RETAIN，但实际上没有理由使用它。

我在这里使用了一个快捷方式——虽然你用 VAR_Z 来描述 VAR_Y，但你的意思是在一次迭代之后，VAR_Z 移动到 VAR_X 并且 VAR_X 移动到 VAR_Y，所以我这样做（以正确的顺序不要混淆） .

```
data test_data;
if _n_ = 1 then do;
var_x=2;
var_y=3;
end;
do _iter = 1 to 7;
  var_z = 0.1+4*var_x+5*var_y;
  output;
  var_y=var_x;
  var_x=var_z;
end;
run;
proc print data=test_data;
run; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T22:00:08.910

我相信您可以在 DO 循环中执行此操作 - 关键是让 SAS 记住变量的最后一个值。我的建议是寻找一个简单的“计数器”程序，在伪 SAS 代码中，它类似于：

```
Do i = 1 to 100;
   i = i + 1;
run; 
```

并查看 SAS 中的实际语法。我怀疑您的问题是您没有在 DO 循环中使用*保留语句。*检查 SAS 文档，看看它是否解决了您的问题？

# perl - Perl 比较没有数字的字符串

> ID：12325968
> 
> 赞同：1
> 
> 时间：2012-09-07T22:00:57.913
> 
> 标签：perl

我有 2 个变量：

```
my $var1 = 'package-name-1.4';
my $var2 = 'package-name-1.5'; 
```

我想要做的是比较 $var1 和 $var2，同时排除数字。

我在网上查看并尝试了正则表达式，但我无法让它工作，我非常感谢一些帮助。

我的想法如下：

```
if (removeNumbers($var1) =~ removeNumbers($var2)) 
```

这样结果就像比较：package-name- 与 package-name-，从而评估为 true。

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T22:03:36.870

好吧，最简单的方法就是完全删除所有数字：

```
sub remove_numbers {
  my ($orig) = @_;
  $orig =~ s/\d+//g;
  return $orig;
} 
```

但这有点幼稚：例如，`some-package-1.4.1`并且`some-package-1.4`不相等。最好也删除点，但前提是它们跟随数字（用作分隔符）。

```
 $orig =~ s/\d+[.]?//g; 
```

更重要的是，也许数字之前的第一个连字符也应该去（所以 'package-name' 和 'package-name-1' （甚至 'package-name-1.0-some-fancy-line' 和 'package-name -some-fancy-line') 将被视为相同：

```
 $orig =~ s/-?\d+[.]?//g; 
```

更新：然而，有不止一种方法可以做到：

```
 $orig = substr $orig, 0, rindex $orig, '-'; 
```

如果所有字符串都具有相同的格式（版本号始终位于字符串的末尾，始终跟在最后一个连字符后面，它始终存在），则适用：

使用如下：

```
if (remove_numbers($var1) eq remove_numbers($var2)) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-08T01:14:18.120

在这种情况下，最好简单地提取所有“单词”（此处指字母字符串）并比较仅包含这些单词的字符串

例如

```
sub words_only {
  join ' ', shift =~ /\b[a-z]+\b/ig;
} 
```

会同时变成`package-name-1.4`和，所以这个脚本可以正确打印`package-name-1.5``package name``MATCH`

```
use strict;
use warnings;

my $var1 = 'package-name-1.4';
my $var2 = 'package-name-1.5';

print words_only($var1) eq words_only($var2) ? 'MATCH' : 'NO MATCH';

sub words_only {
  join ' ', shift =~ /\b[a-z]+\b/ig;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T22:06:13.213

如果您的变量包含相同的格式，那么您可以尝试删除字符串中的数字并比较结果。

# google-sites - 列出给定用途的所有 Google 网站

> ID：12325969
> 
> 赞同：0
> 
> 时间：2012-09-07T22:00:58.317
> 
> 标签：google-sites

使用 gdata Java 客户端库，如何列出给定用户的所有站点？由于我最近意识到站点提要检索仅返回了 25 个站点，因此我尝试了这段代码来获取“下一批站点”（基于我很久以前为 Google Docs 编写等效代码的方式）：（注意：resultFeed 是 SiteFeed)

```
if (resultFeed.getNextLink() != null) {
    System.out.println( "Will retrieve more...");
    String nextFeedURLString = resultFeed.getNextLink().getHref();
    .... here I retrieve the feed referred to by nextFeedURLString and save it in the resultFeed variable...
    entries = resultFeed.getEntries();
    count = count + entries.size();
    ...etc
} 
```

问题：即使用户拥有超过 25 个 Google 站点，上述条件似乎始终为假（即 result.getNextLink() 始终返回 NULL）......任何人都有这方面的经验，并且可以提出另一种检索方式下一批网站？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T17:13:53.463

这似乎是一个[错误](http://code.google.com/a/google.com/p/apps-api-issues/issues/detail?id=2743)。

我使用的解决方法：

```
SiteFeed siteFeed = client.getFeed(new URL(getSiteFeedUrl()), SiteFeed.class);
SiteQuery q = new SiteQuery(new URL(getSiteFeedUrl()));

Query.CustomParameter qs = new Query.CustomParameter("include-all-sites", "true");
Query.CustomParameter qs2 = new Query.CustomParameter("max-results", "1000");
siteFeed = client.getFeed(q, SiteFeed.class); 
```

这将返回所有站点，如果少于 1000 个，则至少返回所有站点

# sparql - 是否可以在 SPARQL 中聚合两个资源？

> ID：12325974
> 
> 赞同：3
> 
> 时间：2012-09-07T22:01:25.700
> 
> 标签：sparql, aggregation, allegrograph

**挑战**

在我的三重商店中，我有一个资源类型电子邮件。该电子邮件类型的资源分配有一个发件人和一个或多个收件人。

让符号“A->B”定义为“A 是电子邮件的发件人，而 B 是收件人之一”。

现在，我想知道以下内容：A 人向 B 人发送了多少次电子邮件？注意A和B的作用很重要，即A->B不同于B->A。

**格式错误的 SPARQL 查询**

为了回答所有可用配对的这个问题，我编写了这个 SPARQL (1.1) 查询：

```
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX foaf: <http://xmlns.com/foaf/0.1/>
PREFIX email: <http://example.com/schema/for/email/>

SELECT ?sender ?recipient (COUNT(?sender ?recipient) AS ?count)
WHERE {
  ?sender rdf:type foaf:Person.
  ?recipient rdf:type foaf:Person.

  ?e rdf:type email:Email.
  ?e email:sender ?sender.
  ?e email:recipient ?recipient.
}
GROUP BY ?sender ?recipient 
```

这不起作用，AllegroGraph 给了我错误`MALFORMED QUERY: Line 5, Found ?recipient (of type varname)`- 第 5 行是 SELECT 子句。我尝试了一些其他变体，更改了 SELECT 和/或 GROUP BY 子句，但没有成功。

我不确定是否允许聚合多个资源。在[SPARQL 1.1 文档](http://www.w3.org/TR/sparql11-query/#aggregates)和相关的 SO 问题（[Counting in SPARQL](https://stackoverflow.com/questions/5966410/counting-in-sparql)）中，我只发现了基于一种资源的聚合。

所以最后，这是我的问题：是否可以汇总发件人和收件人？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-08T09:13:18.603

尝试替换`(COUNT(?sender ?recipient) AS ?count)`为`(COUNT(?e) AS ?count)`.

这应该可行，因为您想要计算`?e`符合您的条件的电子邮件 ( ) 的数量。

# jquery - 深度链接 json 加载的数据

> ID：12325976
> 
> 赞同：0
> 
> 时间：2012-09-07T22:01:32.110
> 
> 标签：jquery, json, deep-linking, jquery-address

我有填充 dom 的 json 数据，并且正在添加的 json 对象具有用于 window.hash 的 ID

```
 $j.getJSON('js/looks.json', function(data){

            $j.each(data.looks, function(i, looks){
                var look = "<li class='style "+data.looks[i].type+"'>";
                look+= "<div class='overlay'></div>";
                look+= "<a href='#"+data.looks[i].person+"'><img src='../images/looks/landinglooks_"+data.looks[i].person+".jpg'/></a>";
                look+="</li>";
             });

      }); 
```

并且链接到的 div 也以 json 格式输出：

```
<div id='"+data.looks[i].person+"' class='block steps'> 
```

输出：

```
<li class="style fine"><div class="overlay"></div><a href="#gabrielle"><img src="../images/looks/landinglooks_gabrielle.jpg"></a></li> 
```

单击它会将您带到 http:.../#/gabrielle 这是一个 div 也是

```
<div id="gabrielle" class="block steps"></div> 
```

这工作正常，但似乎在页面加载时（如果我尝试加载到 .../#/gabrielle）没有任何反应。jQuery Address 不会读取加载到 dom 中的 json 的页面加载哈希值。

是否有解决方法或其他支持此功能的深层链接插件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T23:00:24.133

我决定使用[http://benalman.com/projects/jquery-hashchange-plugin/](http://benalman.com/projects/jquery-hashchange-plugin/)就像一个魅力！我可以在加载 json 后调用 hashchange 触发器。

# c++ - 在链表中使用模板

> ID：12325978
> 
> 赞同：-2
> 
> 时间：2012-09-07T22:01:42.530
> 
> 标签：c++, templates

我遇到了这个问题，我需要实现一个链表，但是存储在节点中的元素的数据类型可能是字符串或指向另一个类的指针，

```
class Node{
    public:
        string data;
        void *link;
        Node *next;

        Node(){
            link = next = NULL;
        }
        Node(string str){
            data = str;
        }
        Node(void *ptr){
            link = ptr;
        }
};

class List{
    Node *head;
    Node *tail;

    public:
        void insert(string str){
            Node *newNode = new Node(str);
            /* ... */
        }
        void insert(void *ptr){
            Node *newNode = new Node(ptr);
            /* ... */
        }
}; 
```

我尝试使用模板，但我不能，我怎么能使用模板呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-08T01:52:49.500

STL 有一个`std::list`模板类，你真的应该使用它。但是，如果您想实现自己的类，请尝试以下操作：

```
template<typename T>
class Node
{ 
public: 
    Node *next; 
    T data; 

    Node(const T &value)
        : next(NULL), data(value)
    {
    } 
}; 

template<typename T>
class List
{ 
private:
    Node<T> *head; 
    Node<T> *tail; 

public: 
    List()
        : head(NULL), tail(NULL)
    {
    }

    void insert(const T &value)
    { 
        Node<T> *newNode = new Node<T>(value); 
        if (!head)
            head = newNode;
        if (tail)
            tail->next = newNode;
        tail = newNode;
    } 
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T22:41:32.563

你可能会做这样的事情：

```
template <class T>
class List 
{
public:
    List(): root(NULL) {};
    ~List();
    bool add(const T& item);
    ....

private:
    typedef struct Node {
        T item;
        struct Node *next;
    } Node; 
    Node *root;
}; 
```

看到其他答案会很有趣。C++ 不是我最擅长的话题，但是这个例子应该可以编译并且可以工作。您知道在 C++ 中，struct 是一种“默认公共”类，因此您甚至可以在其中包含函数（不过，我宁愿将私有函数添加到您的列表中）。

# java - 在 XML Validator 上设置 ErrorHandler 会导致验证不正确

> ID：12325985
> 
> 赞同：2
> 
> 时间：2012-09-07T22:02:05.670
> 
> 标签：java, xml, xsd, sax, xerces

`Validator`在使用 Java 的 XML （我相信它使用 Apache Xerces 实现）时，我遇到了一些看起来非常奇怪的行为。

我正在尝试针对 XSD 验证一些 XML 文档，并且我想记录任何导致文档无效的内容。我认为实现我自己的`ErrorHandler`可以让我做到这一点。我很快发现这会导致错误地验证 XML 文档（即无效的 XML 被识别为对我的 XSD 有效）。

我做了一些测试，发现简单地将`Validator`'s设置`ErrorHandler`为任何东西都会导致这种行为，如下所示。

```
validator.validate(invalidXmlSource); // XML correctly identified as INVALID

validator.setErrorHandler(new DefaultHandler());
validator.validate(invalidXmlSource); // XML incorrectly identified as VALID 
```

我会假设未指定`Validator`用途`DefaultHandler`时的用途，所以我不明白为什么行为会发生变化。

这里发生了什么？

**编辑**

```
public void validate(File dir, String xsdPath) {
    File schemaFile = new File(xsdPath);
    SchemaFactory schemaFactory = SchemaFactory.newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI);
    Schema schema = schemaFactory.newSchema(schemaFile);
    Validator validator = schema.newValidator();
    //validator.setErrorHandler(new DefaultHandler()); <-- this line causes incorrect validation
    for (File xmlFile: dir.listFiles()) {
        try {
            validator.validate(new StreamSource(xmlFile));
            System.out.println("File '" + xmlFile.getName() + "' is valid.");
        } catch (SAXException e) {
            System.out.println("File '" + xmlFile.getName() + "' is NOT valid.");
            System.out.println("Reason: " + e.getLocalizedMessage());
        } catch (IOException e) {
            e.printStackTrace();
        }       
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-11T20:22:15.170

`DefaultHandler`不会为`error`and做任何事情`warning`。但是，它会为`fatalError`. 在 和 的文档之间`Validator`，`DefaultHandler`您会看到，无论好坏，您得到的正是您所要求的。:)

编辑：文档中要注意的主要事情可能`Validator`是默认（null）错误处理程序将引发异常`error`...

Edit2：这是一个可能的错误处理程序的概要，可以执行您想要的操作：

```
import org.xml.sax.ErrorHandler;
import org.xml.sax.SAXParseException;

public class LoggingErrorHandler implements ErrorHandler {

    private boolean isValid = true;

    public boolean isValid() {
        return this.isValid;
    }

    @Override
    public void warning(SAXParseException exc) {
        // log info
        // valid or not?
    }

    @Override
    public void error(SAXParseException exc) {
        // log info
        this.isValid = false;
    }

    @Override
    public void fatalError(SAXParseException exc) throws SAXParseException {
        // log info
        this.isValid = false;
        throw exc;
    }
} 
```

它可以像这样使用：

```
LoggingErrorHandler errorHandler = new LoggingErrorHandler();
validator.setErrorHandler(errorHandler);
validator.validate(invalidXmlSource);
if (!errorHandler.isValid()) {
    //...
} 
```

# database - 内存 H2 数据库，插入脚本不持久

> ID：12325986
> 
> 赞同：2
> 
> 时间：2012-09-07T22:02:12.657
> 
> 标签：database, insert, h2, persist

我想使用 H2 作为我的单元测试的内存数据库。我通过 Spring 将所有东西连接在一起。一切*似乎*都很好。数据库加载，ddl sql 文件运行，dml sql 也是如此（或者看起来如此）。

我可以运行一个在数据库中创建记录的测试，然后检索并验证它是否被适当地持久化。所以这告诉我 ddl 脚本运行良好。

问题是当我尝试接收通过 dml 脚本插入的记录时，我什么也得不到。

我尝试两次将相同的插入语句放入文件中，并且确实收到了一个独特的约束错误，这告诉我它们正在运行......但由于某种原因没有*持续存在*。

DDL：

```
DROP TABLE IF EXISTS `schema`.`region` ;CREATE  TABLE IF NOT EXISTS `schema`.`region` (
  `region_id` INT(11) NOT NULL ,
  `name` VARCHAR(56) NOT NULL ,
  `description` VARCHAR(512) NULL DEFAULT NULL ,
  PRIMARY KEY (`region_id`) ); 
```

DML：

```
INSERT INTO `schema`.`region` (`region_id`, `name`, `description`) VALUES (1001, 'TEST', 'TESTING'); 
```

网址：

```
jdbc:h2:file:db_test;MODE=MYSQL;INIT=create schema if not exists test_db\\;runscript from 'classpath:test_ddl.sql'\\;runscript from 'classpath:test_dml.sql' 
```

任何帮助都会有所帮助。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-08T12:19:07.430

请参阅[数据库文件存储在哪里？](http://h2database.com/html/faq.html#database_files)在常见问题解答中。使用您使用的数据库 URL `jdbc:h2:file:db_test`，文件存储在*当前工作目录*中。根据您启动应用程序的位置，这是一个不同的位置，因此使用不同的数据库。

我建议`jdbc:h2:~/db/test_db...`改用。

> 我想使用 H2 作为内存数据库

您实际上使用的是持久数据库，请参阅[数据库 URL 概述](http://h2database.com/html/features.html#database_url)。

# sharepoint - 为新网站集应用自定义母版页

> ID：12325990
> 
> 赞同：1
> 
> 时间：2012-09-07T22:02:32.440
> 
> 标签：sharepoint, master-pages, sitecollection, spsite

这适用于现有网站集及其下的任何新网站及其子网站但是当我创建新网站集时，我现在什至无法创建新网站集，因为它给了我文件未找到错误作为我的根网站新站点集合无法找到母版页...为什么？我是说怎么做？？

```
using (SPWeb currentWeb = (SPWeb)properties.Feature.Parent)
            {
                using (SPSite currentSite = currentWeb.Site)
                {
                   //Set Masterpage
                    Uri masterURI = new Uri(currentSite.Url + "/_catalogs/masterpage/V4Copy.master");
                    currentWeb.CustomMasterUrl = masterURI.AbsolutePath;
                    currentWeb.MasterUrl = masterURI.AbsolutePath;
                    currentWeb.Update();
                }
            } 
```

# php - 使用 HTML/JS/CSS/PHP/MySQL 构建家谱

> ID：12325991
> 
> 赞同：5
> 
> 时间：2012-09-07T22:02:34.487
> 
> 标签：php, html, css, hierarchy, ancestry

我的任务是构建与此类似的东西，我需要一些建议/意见以获得有效的解决方案：

[http://familyecho.com](http://familyecho.com)

到目前为止，我已经尝试使用嵌套集模型来表示我的数据，但我认为它不可能有多个父节点。几乎我见过的每个例子都只涉及一个有多个孩子的父母。我还尝试使用 Google 可视化组织结构图，它看起来很棒，几乎解决了所有显示问题，但我遇到了同样的问题，节点再次仅支持 1 个父节点。所以我想我尝试自己构建一些东西，好吧，我没有太多运气。

至于让树正确显示，最大的问题之一是弄清楚如何将节点放置在正确的位置。请注意，在 Family Echo 中，父节点如何根据子节点的数量适当间隔开，以免与周围的其他节点发生冲突。我一直在尝试至少复制这种行为，所以我将不胜感激任何提示。我尝试的是遍历一个数组，如下所示，其中包含有关家庭的所有数据：

```
 {
    508 : {
        "id" : 1,
        "name" : "Son",
        "Parent" : {
            17864 : {
                "id" : 2,
                "name" : "Father"
            },
            65926 : {
                "id" : 3,
                "name" : "Mother"
            }
        }
    },
    17864 : {
        "id" : 2,
        "name" : "Father",
        "Partner" : {
            65926: {
                "id" : 3,
                "name" : "Mother"
            }
        },
        "Son/Daughter" : {
            508 : {
                "id" : 1,
                "name" : "Son"
            }
        }
    },
    65926 : {
        "id" : 3,
        "name" : "Mother",
        "Partner" : {
            17864: {
                "id" : 2,
                "name" : "Father"
            }
        },
        "Son/Daughter" : {
            508 : {
                "id" : 1,
                "name" : "Son"
            }
        }
    }
} 
```

（508、17864、65926 充当每个家庭成员的唯一随机键），然后使用一些递归函数，创建第二个更清洁的变量，没有任何重复，包括为每个成员计算的 x/y 坐标。下面的第二个变量示例：

```
{
    508 : {
        "id" : 1,
        "name" : "Son",
        "x" : 0,
        "y" : 0
    },
    17864 : {
        "id" : 2,
        "name" : "Father",
        "x" : 1,
        "y" : -1
    },
    65926 : {
        "id" : 3,
        "name" : "Mother",
        "x" : -1,
        "y" : -1
    }
} 
```

然后我循环遍历第二个变量并开始绘制具有绝对定位的固定维度 DIV，并使用 X 和 Y 坐标修改左侧和顶部 CSS 值。这是一个好方法，还是有更好的方法（或者可能像谷歌组织图表可视化来加快速度）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-08T15:11:45.290

这听起来像是[D3.js](http://d3js.org/)的工作。

> D3.js 是一个基于数据操作文档的 JavaScript 库。D3 帮助您使用 HTML、SVG 和 CSS 将数据变为现实。D3 对 Web 标准的重视为您提供了现代浏览器的全部功能，而无需将自己束缚于专有框架，结合了强大的可视化组件和数据驱动的 DOM 操作方法。

# math - 解释指数表达式如何简化？

> ID：12325997
> 
> 赞同：0
> 
> 时间：2012-09-07T22:03:01.983
> 
> 标签：math, expression

已经很长时间了，我找不到一个简单的答案或规则......有人介意解释这是如何平等的吗？

（即，使“=”符号左侧的一侧等于右侧的一侧所需的步骤是什么？）

(36^24 - 35^24) / 36^24 = 1 - (35/36)^24

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T22:21:00.707

从...开始：

```
(36^24 - 35^24) / 36^24 
```

应用分配属性——即`(a*b)*c = a*c + b*c`：

```
= 36^24 / 36^24 - 35^24 / 36^24 
```

简化第一个表达式，因为`a/a = 1`提供`a != 0`：

```
= 1 - 35^24 / 36^24 
```

现在我们可以应用`a^n * b^n = (a * b)^n`, for `a = 35`,`b = 1/36`和`n = 24`:

```
= 1 - (35/36)^24 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T22:14:17.027

首先，将这两项除以 36^24：

```
(36^24 - 35^24) / 36^24 = 36^24/36^24 - 35^24/36^24 
```

`36^24/36^24`当然，只是 1。还记得`a^x/b^x = (a/b)^x`，然后您可以进行最后一个替换：

```
1 - 35^24/36^24 = 1 - (35/36)^24 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T22:30:29.243

让我们先考虑一个更简单的表达式。

**(ab)/c**

这可以表示为

**a/c - b/c**

现在让我们考虑指数是如何工作的。

a^3 = a * a * a。

b^3 = b * b * b。

所以，a^3/b^3 = (a*a*a)/(b*b*b)

```
 = (a/b) * (a/b) * (a/b)

          = (a/b)^3. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-07T23:11:44.967

很简单，我们有

```
 (a - b)/a  = (a/a) - (b/a) = 1 - (b/a) 
```

从你的方程我们代入

```
 a = 36^24,   b = 35^24 
```

这使

```
 (a - b)/a = 1 - (b/a) 

 = 1 - (35^24 / 36^24) 

 = 1 - (35/36)^24 
```

如果上述任何一项没有意义，请阅读此[http://en.wikipedia.org/wiki/Exponentiation](http://en.wikipedia.org/wiki/Exponentiation)，然后再次查看此处的答案。