# StackOverflow 问答 10098000-10098999

# c# - 如何正确引发自定义事件？

> ID：10098000
> 
> 赞同：3
> 
> 时间：2012-04-10T23:41:46.817
> 
> 标签：c#, events

如果找到/创建了特定目录中的新/现有文件，我需要一个自定义事件。为了检查是否创建了新文件，我使用了 SystemFileWatcher，它工作正常。为了检查程序启动时是否存在某些文件，我写了一些行并且可以。

我将此类用于事件参数：

```
public class FileDetectEventArgs : EventArgs
{
    public String Source { get; set; }
    public String Destination { get; set; }
    public String FullName { get; set; }

    public FileDetectEventArgs(String source, String destination, String fullName)
    {
        this.Source = source;
        this.Destination = destination;
        this.FullName = fullName;
    }
} 
```

如果 SystemFileWatcher 引发 FileCreated 事件，我将使用以下代码行：

```
public void onFileCreated(object sender, FileSystemEventArgs e)
{
    // check if file exist
    if (File.Exists(e.FullPath))
    {
        OnNewFileDetect(new FileDetectEventArgs(source, destination, e.FullPath));  
    }
} 
```

如果存在文件，我会尝试以这种方式引发事件：

```
public void checkExistingFiles(String source, String filter)
    {
        DirectoryInfo di = new DirectoryInfo(source);
        FileInfo[] fileInfos = di.GetFiles();
        String fileFilter = filter.Substring(filter.LastIndexOf('.'));       

        foreach (FileInfo fi in fileInfos)
        {
            if (fi.Extension.Equals(fileFilter))
            {
                OnNewFileDetect(new FileDetectEventArgs(source, destination, fi.FullName));                   
            }
        }
    } 
```

这是 OnNewFileDetect 事件：

```
protected void OnNewFileDetect(FileDetectEventArgs e)
    {
        if (OnNewFileDetectEvent != null)
        {
            OnNewFileDetectEvent(this, e);
        }
    } 
```

问题是，如果 onFileCreated-Event 引发我的 OnNewFileDetect-Event 一切正常。但是，如果 checkExistingFiles 发现一些现有文件并尝试引发 OnNewFileDetect-Event，则不会发生任何事情。我发现 OnNewFileDetectEvent-Object 为空，所以什么也没发生。但是，如果 onFileCreated-Event 被触发，为什么它不为空？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T23:43:17.363

> 但是，如果 onFileCreated-Event 被触发，为什么它不为空？

在订阅该事件之前，此事件将为空。

* * *

附带说明一下，我会考虑切换到更好的模式来引发事件，以及在此处使用标准 C#/.NET 命名。这更像是：

```
// The event...
public EventHandler<FileDetectedEventArgs> NewFileDetected;

// Note the naming
protected void OnNewFileDetected(FileDetectedEventArgs e)
{
    // Note this pattern for thread safety...
    EventHandler<FileDetectedEventArgs> handler = this.NewFileDetected; 
    if (handler != null)
    {
        handler(this, e);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T23:52:59.627

@Reed Copsey 回答了这个问题；该事件将`null`持续到有订阅者为止。

此外，这是一个潜在的竞争条件：

```
if (OnNewFileDetectEvent != null)
{
    OnNewFileDetectEvent(this, e);
} 
```

请注意，在多线程场景中，如果在语句之后`OnNewFileDetectEvent`设置为，但在下一行调用之前，您的程序将崩溃。通常你会这样做：`null``if`

```
var del = OnNewFileDetectEvent;
if (del != null)
{
    del(this, e);
} 
```

由于您的事件对象是不可变的，因此如果它在语句`del`中不为空，则它永远不会为空。`if`

另请注意，您的命名是非常规的。事件通常不以 为前缀`On`，调用事件的方法是。

# java - 如何执行使用另一个 jar 的 jar

> ID：10098005
> 
> 赞同：1
> 
> 时间：2012-04-10T23:42:27.777
> 
> 标签：java, android, jar

我在将项目导入我的 android 项目时遇到了一点问题。

我使用 Ical4Java 构建了一个小库来解析 .ical 文件，并且该库被导出到 .jar。

在我的 Android 项目中，我已经从我的库中导入并添加了我生成的 .jar 到构建路径，其中包括一些 jar 以使我的库正常工作。

但是当我运行我的应用程序时它只是崩溃了，我在 LogCat 上得到了这个：

```
E/AndroidRuntime(14382): java.lang.NoClassDefFoundError: net.fortuna.ical4j.data.CalendarBuilder 
```

该库（ical4j.jar）在库构建路径中导入，并与我的库（mylibrary.jar）一起导出。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T00:18:58.500

您可以使用[One-Jar](http://sourceforge.net/projects/one-jar/)帮助您使用依赖于其他 jar 文件的 jar 文件。基本上你可以将它们组合成一个 jar 文件。

这里有一个小[教程](http://beautifulwaste.blogspot.com/2007/06/running-jar-file-that-includes-another.html)可以帮助你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T23:49:01.603

只需将一个罐子的内容放入另一个罐子（组合它们）。它们只是 zip 文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-10T23:47:23.043

是`mylibrary.jar`可执行的jar文件吗？

如果是这样，您不能引用外部 jar。

# asp.net - asp.net - 动态创建的下拉列表不会在回发中调用事件处理程序方法

> ID：10098010
> 
> 赞同：1
> 
> 时间：2012-04-10T23:43:19.473
> 
> 标签：asp.net, dynamic, drop-down-menu

我有一个页面可以进行分层搜索，它从一个下拉列表开始，根据下拉列表中选择的值，它将查询数据库并在另一个下拉列表中显示孩子，只要它碰到叶子，它就会继续......所以我首先动态添加了下拉列表，它在 SelectedIndexChanged 上有事件处理程序，当我更改所选值时，它会触发回发**但不调用事件处理程序方法**..不确定我在这里做错了什么..或者是它是一个错误？？

使用会话变量来跟踪创建的控件

```
private List<DynamicControlProperties> PersistedControls 
    {
        get
        {
            if (_persistedControls == null)
            {
                if (Session[PersistedControlsKey] == null)
                {
                    Session[PersistedControlsKey] = new List<DynamicControlProperties>();
                }

                _persistedControls = Session[PersistedControlsKey] as List<DynamicControlProperties>;
            }

            return _persistedControls;
        }
    } 
```

在 Page Init 中，重新创建动态生成的控件

```
protected override void LoadViewState(object savedState)
    {
        base.LoadViewState(savedState);

        // regenerate the persisted controls
        foreach (var prop in PersistedControls)
        {
            CreateControl(prop);
        }

    } 
```

在页面加载中，创建了第一个下拉菜单

```
protected void Page_Load(object sender, EventArgs e)
    {

        if (!Page.IsPostBack)
        {
           // create the control
            CreateControl(....)

           // bind the data to the dropdown
         }
   } 
```

在创建控件方法中，只需创建一个标签和一个下拉菜单，将其包装在 a 中并将其添加到占位符

```
private DropDownList CreateControl(DynamicControlProperties dynamiccntrlprop)
    {
        // create a new HTML row
        HtmlGenericControlWithParentID tr = new HtmlGenericControlWithParentID("tr");
        HtmlGenericControlWithParentID td1 = new HtmlGenericControlWithParentID("td");
        HtmlGenericControlWithParentID td2 = new HtmlGenericControlWithParentID("td");

        // make sure we set the id and parentid
        tr.ID = string.Format("tr{0}", dynamiccntrlprop.ID);            
        tr.ParentID = dynamiccntrlprop.ParentID;
        tr.EnableViewState = true;

        // create a new label for dropdown
        Label lbl = new Label() { ID = string.Format("lbl{0}", dynamiccntrlprop.DisplayName), Text = dynamiccntrlprop.DisplayName };

        // create a new dropdown list
        DropDownList ddl = new DropDownList()
        {
            ID = string.Format("ddl{0}", dynamiccntrlprop.DisplayName),

            // set the postback
            AutoPostBack = true,

            EnableViewState = true
        };

        // subscribe for the select index changed event
        ddl.SelectedIndexChanged += new EventHandler(ddl_SelectedIndexChanged);

        // add the controls to table row
        td1.Controls.Add(lbl);
        td2.Controls.Add(ddl);

        tr.Controls.Add(td1);
        tr.Controls.Add(td2);

        // add the control to place holder     
        this.filtersPlaceHolder.Controls.Add(tr);

        return ddl;

    } 
```

这是索引更改处理程序，

```
protected void ddl_SelectedIndexChanged(object sender, EventArgs e)
{
} 
```

启用了视图状态，autopostback blah blah blah ...在回发中重新创建了具有相同 ID 的控件..在谷歌中尝试了所有答案..但没有运气..当我更改索引但不调用事件时，它确实触发了回发处理方法..

有什么想法好吗？？？

非常感谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T02:18:44.063

您必须确保在每个页面回发时调用 CreateControl 方法。这需要发生以确保动态控件的事件处理程序在回发后连接。

```
protected void Page_Load(object sender, EventArgs e)
{
    // you shouldn't wrap the call to CreateControl in this 'if' statement
    //if (!Page.IsPostBack)
    //{
           // create the control
            CreateControl(....)

           // bind the data to the dropdown
    //}
} 
```

执行此操作后，将触发选定的索引更改事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T02:21:48.380

也许是因为下拉列表的新值没有被加载。受保护的覆盖无效LoadViewState（对象已保存状态）{

```
 // regenerate the persisted controls
    foreach (var prop in PersistedControls)
    {
        CreateControl(prop);
    }

    base.LoadViewState(savedState);
} 
```

# django - 我是否需要覆盖保存方法才能将数据从 django UserCreationForm 添加到不同的模型

> ID：10098011
> 
> 赞同：0
> 
> 时间：2012-04-10T23:43:20.013
> 
> 标签：django, django-forms, django-registration, django-users, django-profiles

我想在 UserCreationForm 中添加另一个字段以显示在 RegistrationForm 中，为此我在 stackoverflow 上看到了几个示例。我的意思是通过定义从 UserCreationForm 继承的不同 RegisterForm 的示例，如stackoverflow的这个问题中所述： [django-create-custom-usercreationform-b​​asic](https://stackoverflow.com/questions/5745197/django-create-custom-usercreationform-basic)

但是，如果我的数据属于包括`User`模型在内的 2 或 3 个不同的模型，我该怎么办？然后我会覆盖保存方法还是做其他事情？是否有某种方法可以通过仅在将从 UserCreationForm 继承的 RegistrationForm 中处理它而不进入更底层的方法来处理它？什么是更好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T00:28:32.110

好的，就像您在[链接](http://dmitko.ru/django-registration-form-custom-field/)中看到的那样，您可以使用许多方法，没有一种方法看起来像您想要的那样高级。我不知道你对 Django 有多熟悉，但链接的方法看起来很有前途。它很新鲜，使用信号框架（灵活）并且非常容易实现 - 高水平足以解决您的问题。请注意[UserProfile Example](https://stackoverflow.com/questions/1910359/creating-a-extended-user-profile)，因为它们与您的问题非常相似并且更常见。

如果您不想使用信号，最直接的解决方案是覆盖保存方法。

所以你已经想到了解决方案。恕我直言，我想不出更好或更高级的解决方案。

# git - 如何将某些文件忽略到与 github 同步的本地存储库中？

> ID：10098013
> 
> 赞同：4
> 
> 时间：2012-04-10T23:43:38.993
> 
> 标签：git, github

我正在使用 github 在本地机器上创建我的代码的最新版本的副本，我不想发出推送请求我只想发出拉取请求并修改本地机器中的一些文件并尝试说github 忽略一些文件并更新其他文件。

我使用以下命令忽略名为“config.inc.php”的文件：

```
git rm /home/escogit/www/inc/config.inc.php 
```

然后我对远程 github 存储库中的其他文件进行了更改，当我尝试使用命令“git pull”获取新更改时，我收到以下错误：

```
远程：计数对象：9，完成。
远程：压缩对象：100% (1/1)，完成。
远程：总共 5 个（增量 4），重复使用 5 个（增量 4）
拆包对象：100% (5/5)，完成。
来自 github.com:Visooal/Colegios
   e724ba3..a624059 主 -> 原点/主
更新 e724ba3..a624059
错误：您对以下文件的本地更改将被合并覆盖：
www/inc/config.inc.php
请在合并之前提交您的更改或存储它们。
中止

```

注意：即使我使用命令 git commit -m ".config.inc.php ignored" 提交，我也会收到该错误

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T23:58:02.093

首先，`git rm`不忽略文件。它在本地和从索引中删除文件。如果您在删除文件之前提交了该文件，那么它将始终在您的树中，即使它不在当前索引中。另一个人很容易意外地重新添加它。您应该在之后为该文件设置一个 .gitignore 条目`git rm`。人们仍然可以手动绕过 .gitignore，但该文件将不再显示在`git status`任何 UI 工具中。

你需要按照它说的去做。`git commit -a -m "My Commit Comment"`在你做之前`git pull`

只是为了给出更清晰的画面，假设您已经`git rm`编辑了该文件，请运行这些命令。

```
echo 'config.inc.php' > .gitignore
git add .gitignore
git commit -a -m "Removed uneeded file"
git pull
// Fix any merge issues
git commit -a -m "Merge"
git push 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-30T16:15:44.420

您可以忽略文件，然后忽略 .gitignore 下的更改。

所以它会是这样的：将您的文件添加到**.gitignore**：

`echo '/home/escogit/www/inc/config.inc.php' >> .gitignore`

然后忽略**gitignore**的变化：

`git update-index --assume-unchanged .gitignore`

它已经完成了！

**警告：** .gitignore 中的所有本地更改都将被忽略以撤消此操作，并使用所需的功能再次重新撤消它使用： `git update-index --no-assume-unchanged .gitignore`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T00:08:36.060

Git 不允许您使用未提交的更改进行拉取。要让 git 忽略文件，通常你会创建一个`.gitignore`文件，但你不能在这里，因为那将是一个改变；但您可以将文件名添加到`repo/.git/info/exclude`. 此文件使用与 .gitignore 相同的语法，但不会被 git 索引提交或查看。因此，在您的示例中，您将添加该行

```
www/inc/config.inc.php 
```

到`escogit/.git/info/exclude`.

如果您在遥控器上更改这些被忽略的文件之一，然后拉取该更改，您可能仍然会遇到问题。所以最好的办法是提交本地更改。反正他们不会被推，所以没关系。为此运行

```
git commit -a -m "a message explaining commit" 
```

然后你可以拉，git会自动为你合并更改。如果你需要让本地恢复到一个干净的状态，你可以这样做`git checkout .`

# opencv - opencv 字符空分割

> ID：10098015
> 
> 赞同：0
> 
> 时间：2012-04-10T23:43:49.690
> 
> 标签：opencv

我用这个功能来分割字符图像，但是程序崩溃了，有人可以帮我找到解决办法，为什么它会崩溃？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T04:19:07.430

您需要查明导致崩溃的行。为此，我可以通过两种方式思考：

*   使用调试器；
*   或者如果您害怕，请使用以下`printf()`方法：

该`printf()`方法涉及`printf()`在程序中的每个函数调用之后进行调用，因此当您运行应用程序时，您可以在控制台中看到最后`printf()`一条消息是什么。这将帮助您找到导致崩溃的代码。例子：

```
printf("dbg10\n");

IplImage *img_cv = cvLoadImage("plaque.jpg");
printf("dbg20\n");

cvSetImageROI(img_cv,cvRect(8,10,60,35));
printf("dbg30\n");

IplImage *img_pl = cvCreateImage( cvGetSize(img_cv),img_cv->depth,img_cv->nChannels);
printf("dbg40\n");

cvCopy(img_cv,img_pl, NULL);
printf("dbg50\n");

cvResetImageROI(img_cv);
printf("dbg60\n");

//etc 
```

从我在您的代码中看到的情况来看，前 2 个调用有可能使您的应用程序崩溃：如果`cvLoadImage()`无法加载图像，它将返回一个 NULL 指针。由于下一个函数接收指针作为参数，它会尝试取消引用空指针，这可能会导致崩溃。解决方案？**始终检查您拨打的电话的*惊人***回报：

```
IplImage *img_cv = cvLoadImage("plaque.jpg");
if (!img_cv)
{
   printf("Failed to load image.\n");
   exit(1);
}

cvSetImageROI(img_cv,cvRect(8,10,60,35)); 
```

# symfony - 我无法重新安装 symfony2

> ID：10098016
> 
> 赞同：1
> 
> 时间：2012-04-10T23:43:49.597
> 
> 标签：symfony, php

我在 linux mint 12 上使用 symfony2 标准版本。

我创建了一个 symfony2 项目 2 天，一切顺利，我安装了一个错误的包并搞砸了项目，所以我决定删除该`Symfony`文件夹，然后重新安装 symfony。

现在，如果我这样做了，`php app/check.php`我得到了时区错误，尽管我的时区设置正确，并且配置页面看起来像这样

![在此处输入图像描述](../Images/8353a092edca1317bcddf783f025d4a6.png)

我试过了

```
rm -rf app/cache/*
rm -rf app/logs/* 
```

我试过了

```
chmod -R 777 app/cache app/logs 
```

无法修复

**编辑**

`php bin/vendors install --reinstall`解决了这个问题（Hakan Deryal，谢谢先生）。但是，我发现如果您将`Symfony`文件夹重命名为`symfony`或任何其他名称，您会收到错误消息，或者一切正常，但是当您按下时，`Configure your Symfony Application online`您会收到此错误消息

```
Server error
The website encountered an error while retrieving http://localhost/mysite/web/app_dev.php/_configurator/. It may be down for maintenance or configured incorrectly.
Here are some suggestions:
Reload this webpage later.
HTTP Error 500 (Internal Server Error): An unexpected condition was encountered while the server was attempting to fulfill the request. 
```

所以我的下一个问题是如何更改 symfony2 项目，假设你在 localhost 上有 2 个 symfony2 项目，它们不能有相同的名称

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-30T13:57:17.250

嗨，仅仅清除缓存是不够的。

事件我遇到了相同类型的问题，清除缓存后，尝试重建它。

命令是：

```
$ sudo php app/console cache:clear 
$ sudo php app/console cache:warmup
$ sudo chmod 777 -R app/cache app/logs 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T09:39:53.740

设置权限的最佳方式是使用 ACL：

```
sudo setfacl -R -m u:www-data:rwx -m u:`whoami`:rwx app/cache app/logs
sudo setfacl -dR -m u:www-data:rwx -m u:`whoami`:rwx app/cache app/logs 
```

你也可以试试`chown www-data app/logs`

Symfony 在这一点上重新安装不是很相关

# php - 从父类实例化正确的子类

> ID：10098020
> 
> 赞同：4
> 
> 时间：2012-04-10T23:44:29.420
> 
> 标签：php

我已经实现了两个类，isbn10 和 isbn13。我想创建一个 isbn 类，以便在实例化时根据给定给 isbn 类构造函数的参数获得 isbn10 或 isbn13 类型的对象：

```
$isbn_code = new isbn('978-3-16-148410-0'); 
```

我知道我可以用静态方法做这样的事情：

```
class isbn {
    public static function new($isbn) {
      if (preg_match('/' . isbn13::isbn_regex . '/', $isbn)) {
            return new isbn13($isbn);
        } else if (preg_match('/' . isbn10::isbn_regex . '/', $isbn)) {
            return new isbn10($isbn);
        } else {
            throw new Exception("Invalid ISBN code", 1);
        }
    } 

}

$isbn_code = isbn::new('978-3-16-148410-0'); 
```

但是是否可以实例化 isbn 类并自动获取 isbn13 对象（或 isbn10）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T23:48:04.330

不。使用静态“工厂”方法，如您所描述的，是正确执行此操作的方法。在强类型语言中，这可以更好地处理，但在 PHP 中则不然。这是因为构造函数不返回对象，他们只是创建它。

# compilation - coffeescript：为什么 "str".replace(/ /g, "") 给出 coffeescript 编译错误？

> ID：10098021
> 
> 赞同：10
> 
> 时间：2012-04-10T23:44:30.833
> 
> 标签：compilation, coffeescript

违规的线路

```
"str".replace(/ /g, "") 
```

给

```
Error: In orders.js.erb.coffee, Parse error on line 463: Unexpected 'MATH'
    at Object.parseError (/usr/local/lib/node_modules/coffee-script/lib/coffee-script/parser.js:466:11)
    at Object.parse (/usr/local/lib/node_modules/coffee-script/lib/coffee-script/parser.js:542:22)
    at Object.compile (/usr/local/lib/node_modules/coffee-script/lib/coffee-script/coffee-script.js:38:22)
    at /usr/local/lib/node_modules/coffee-script/lib/coffee-script/command.js:149:33
    at /usr/local/lib/node_modules/coffee-script/lib/coffee-script/command.js:115:19
    at [object Object].<anonymous> (fs.js:107:5)
    at [object Object].emit (events.js:61:17)
    at afterRead (fs.js:878:12)
    at wrapper (fs.js:245:17) 
```

这是咖啡脚本编译器中的错误还是我遗漏了什么？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-04-10T23:50:37.387

[转义正则表达式中的第一个空格](https://github.com/jashkenas/coffee-script/issues/1049)

```
"str".replace(/\ /g, "") 
```

编译就好了。

# scala - Scala 中的简单隐式转换

> ID：10098028
> 
> 赞同：1
> 
> 时间：2012-04-10T23:45:13.563
> 
> 标签：scala, dsl

我对 scala 很陌生，到目前为止我真的很喜欢它，但我遇到了一个非常奇怪的问题。我想通过实现 D&D 风格的骰子表达式来尝试隐式转换。即2d12“掷两个十二面骰子”......你知道我的意思。

据我了解scala应该能够编译这个

```
(1 d 6).roll 
```

甚至可能这个

```
1d6 + 2 - 1d30 
```

但我在我的规格测试中收到“值 d 不是 int 的成员”编译错误。

```
package meh.toast
import scala.util.Random

object Dice {
  class DiceSymbol(val amount:Int) {
    def d(sides:Int):Dice = new Dice(amount, sides)
  } 

  implicit def int2DiceSymbol(amount:Int) = new DiceSymbol(amount)
  implicit def dice2Int(d:Dice) = d.roll

  private val rnd = new Random()
  protected def throwDice(sides:Int) = rnd.nextInt(sides) + 1
}

class Dice(amount:Int, sides:Int) {
   def roll:Int = (1 to amount) map { _ => Dice.throwDice(sides)} sum 
} 
```

我真的被困住了。如果您能提供帮助，那就太棒了，这可能非常简单。

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T23:52:46.130

你真的很接近：但是`Dice`当你尝试使用它们时，你必须确保对象的隐式函数在范围内：

```
 scala> import Dice._
 import Dice._

 scala> (1 d 6).roll
 res12: Int = 2 
```

# c# - 使用 WCF 在某个时间间隔内下载大量数据时的 GC 行为

> ID：10098033
> 
> 赞同：0
> 
> 时间：2012-04-10T23:46:31.750
> 
> 标签：c#, .net, wcf, memory, garbage-collection

我正在试验一个定期运行并从远程服务器下载大量数据（只是文本）的网络应用程序（WCF NetTcpBinding）。该应用程序使用 System.Threading.Timer 在 Windows 服务中运行：

```
 protected override void OnStart(string[] args)
    {
        int interval = // get interval from some config file 
        timer = new Timer(new TimerCallback(x => DoWork()), null, 0, interval);
    } 
```

我观察到的是，当下载大量数据时，服务进程会消耗大约 300,000 kb 的工作集内存（考虑到数据量，这是预期的）。然而，在操作完成后，进程保持在大约 300,000 kb 左右，根据我运行的 CLR 分析器，这是堆栈内存，尽管我不是 100% 确定这一点。

一旦服务在 X 分钟的间隔后进行另一批下载，该过程会回落到大约 15,000 kb 的较低内存使用量，然后**只有**在有更多数据要下载时才会立即再次上升。但是，如果要下载的数据很少甚至没有，则该过程将继续挂在大约 300,000 kb 左右。

在每个间隔完成后在这种情况下使用 GC.Collect 是否有意义（每个间隔的操作完全相互独立），还是应该由 GC 自己执行？在我看来，GC 会一直等到新批次需要更多内存才能清除旧批次剩余的内存——这本身不是内存泄漏，但 GC 等待的时间比它应该等待的时间长。我很好奇这是设计使然，还是我的代码中可能有某些东西导致了这种行为？此外，如果它实际上是堆栈内存，我的印象是 GC 并没有真正参与。但是我测试了以下代码，它似乎确实及时清除了内存：

```
 GC.Collect(GC.MaxGeneration, GCCollectionMode.Forced); 
```

# javascript - 如何通过单击按钮将日期和时间插入输入字段

> ID：10098038
> 
> 赞同：3
> 
> 时间：2012-04-10T23:46:51.363
> 
> 标签：javascript, jquery, forms, date, time

我需要一个脚本，通过单击按钮在输入字段中插入当前日期和时间？任何人都可以参考我的脚本吗？

我更喜欢 jquery 或 ajax 或 javascript。

非常感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-10T23:53:03.947

jQuery：

```
$(
    function(){

        $('#time').click(function(){
                  var time = new Date();                
                  $('#time-holder').val(time.toDateString());  
        });

    }
); 
```

HTML：

```
<input type="text" value="" id="time-holder">
<input type="button" value="time" name="timer" id="time"> 
```

这是一个[jsFiddle 示例](http://jsfiddle.net/28Wqq/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T00:20:30.367

一个简单的实现：

```
<form>
  <input name="theDate" size="50">
  <input type="button" value="Insert date" onclick="
    this.form.theDate.value = new Date();
  ">
</form> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T23:51:47.140

这样的事情应该可以解决问题：

```
 $('#yourButtonId').click(function() {
       var now = new Date();
       $('#yourInputId').val(now.toDateString());
 }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T00:05:18.493

使用 JavaScript，您可以使用 Date 对象。要在单击按钮时更改输入值，您可以执行以下操作：

```
document.getElementById("buttonId").onclick = function() {
     var date = new Date();
     document.getElementById("inputId").value = date.toString();
}; 
```

或者，如果您只想使用部分日期或以另一种方式对其进行格式化，您可以使用 、 等函数获取对象的特定属性`date.getDate()`，`date.getFullYear()`并替换`date.toString()`为您想要的任何格式。[在https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Date](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Date)有一个 Date 对象方法的完整列表

# android - Android ViewPager - 在左右显示页面预览

> ID：10098040
> 
> 赞同：141
> 
> 时间：2012-04-10T23:47:30.323
> 
> 标签：android, android-viewpager

我正在使用 Android 的`ViewPager`. 我想要做的是在左侧和右侧显示页面的预览。我已经看到在哪里可以使用底片`pageMargin`来显示右侧的预览。

```
setPageMargin(-100); 
```

无论如何，我也可以显示左侧的预览吗？它基本上类似于我正在寻找的画廊小部件。

* * *

## 回答 #1

> 赞同：216
> 
> 时间：2014-04-29T05:14:23.303

要显示左右页面的预览，请设置以下两个值

1.  `viewpager.setClipToPadding(false);`
2.  `viewpager.setPadding(left,0,right,0);`

如果您需要 viewpager 中两个页面之间的空间，请添加

```
viewpager.setPageMargin(int); 
```

* * *

## 回答 #2

> 赞同：162
> 
> 时间：2019-09-24T21:30:55.143

# 使用新 ViewPager2 的解决方案

现在你应该考虑使用[ViewPager2](https://developer.android.com/reference/androidx/viewpager2/widget/ViewPager2)，它*“取代了 ViewPager，解决了其前身的大部分痛点”*：

> *   基于 RecyclerView
> *   RTL（从右到左）布局支持
> *   垂直方向支持
> *   可靠的 Fragment 支持（包括处理对底层 Fragment 集合的更改）
> *   数据集更改动画（包括`DiffUtil`支持）

## 结果

[![在此处输入图像描述](../Images/de684059dba495da29cc88e212762707.png)](https://i.stack.imgur.com/D2rgA.gif)

## 编码

在您的 Activity/Fragment 中，设置 ViewPager2：

```
// MyRecyclerViewAdapter is an standard RecyclerView.Adapter :)
viewPager2.adapter = MyRecyclerViewAdapter() 

// You need to retain one page on each side so that the next and previous items are visible
viewPager2.offscreenPageLimit = 1

// Add a PageTransformer that translates the next and previous items horizontally
// towards the center of the screen, which makes them visible
val nextItemVisiblePx = resources.getDimension(R.dimen.viewpager_next_item_visible)
val currentItemHorizontalMarginPx = resources.getDimension(R.dimen.viewpager_current_item_horizontal_margin)
val pageTranslationX = nextItemVisiblePx + currentItemHorizontalMarginPx
val pageTransformer = ViewPager2.PageTransformer { page: View, position: Float ->
    page.translationX = -pageTranslationX * position
    // Next line scales the item's height. You can remove it if you don't want this effect
    page.scaleY = 1 - (0.25f * abs(position))
    // If you want a fading effect uncomment the next line:
    // page.alpha = 0.25f + (1 - abs(position))
}
viewPager2.setPageTransformer(pageTransformer)

// The ItemDecoration gives the current (centered) item horizontal margin so that
// it doesn't occupy the whole screen width. Without it the items overlap
val itemDecoration = HorizontalMarginItemDecoration(
    context,
    R.dimen.viewpager_current_item_horizontal_margin
)
viewPager2.addItemDecoration(itemDecoration) 
```

添加`HorizontalMarginItemDecoration`，这是微不足道的`ItemDecoration`：

```
/**
 * Adds margin to the left and right sides of the RecyclerView item.
 * Adapted from https://stackoverflow.com/a/27664023/4034572
 * @param horizontalMarginInDp the margin resource, in dp.
 */
class HorizontalMarginItemDecoration(context: Context, @DimenRes horizontalMarginInDp: Int) :
    RecyclerView.ItemDecoration() {

    private val horizontalMarginInPx: Int =
        context.resources.getDimension(horizontalMarginInDp).toInt()

    override fun getItemOffsets(
        outRect: Rect, view: View, parent: RecyclerView, state: RecyclerView.State
    ) {
        outRect.right = horizontalMarginInPx
        outRect.left = horizontalMarginInPx
    }

} 
```

添加控制上一个/下一个项目可见多少的尺寸，以及当前项目的水平边距：

```
<dimen name="viewpager_next_item_visible">26dp</dimen>
<dimen name="viewpager_current_item_horizontal_margin">42dp</dimen> 
```

[![在此处输入图像描述](../Images/19754129822b4703c8120463493e02dd.png)](https://i.stack.imgur.com/akm59.png)

最后添加`ViewPager2`到您的布局中：

```
<androidx.viewpager2.widget.ViewPager2
    android:id="@+id/viewPager"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" /> 
```

一件重要的事情：一个`ViewPager2`项目必须有`layout_height="match_parent"`（否则它会抛出一个 IllegalStateException），所以你应该这样做：

```
<androidx.cardview.widget.CardView xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    android:layout_width="match_parent"
    android:layout_height="match_parent" <-- this!
    app:cardCornerRadius="8dp"
    app:cardUseCompatPadding="true">

    <androidx.constraintlayout.widget.ConstraintLayout
        android:layout_width="match_parent"
        android:layout_height="280dp">

        <!-- ... -->

    </androidx.constraintlayout.widget.ConstraintLayout>

</androidx.cardview.widget.CardView> 
```

## PageTransformer 示例

Google 在 ViewPager2 上添加了一个指南，其中有 2 个`PageTransformer`实现，您可以将其用作灵感：[https ://developer.android.com/training/animation/screen-slide-2](https://developer.android.com/training/animation/screen-slide-2)

## 关于新的 ViewPager2

*   [Google I/O 2019 上的公告](https://youtu.be/td3Kd7fOROw?t=1702)
*   [文档](https://developer.android.com/reference/androidx/viewpager2/widget/ViewPager2)
*   [发行说明](https://developer.android.com/jetpack/androidx/releases/viewpager2)
*   [代码示例](https://github.com/android/views-widgets-samples/tree/master/ViewPager2)
*   [从 ViewPager 迁移到 ViewPager2](https://developer.android.com/training/animation/vp2-migration)

* * *

## 回答 #3

> 赞同：81
> 
> 时间：2015-12-11T06:52:12.073

@JijuInduchoodan 的答案是完美且有效的。但是，由于我对 Android 比较陌生，所以我花了一些时间来理解和正确设置它。因此，我发布此答案以供将来参考，并帮助与我处境相同的其他任何人。

```
if (viewPager == null) 
        {

            // Initializing view pager
            viewPager = (ViewPager) findViewById(R.id.vpLookBook);

            // Disable clip to padding
            viewPager.setClipToPadding(false);
            // set padding manually, the more you set the padding the more you see of prev & next page
            viewPager.setPadding(40, 0, 40, 0);
            // sets a margin b/w individual pages to ensure that there is a gap b/w them
            viewPager.setPageMargin(20);
        } 
```

无需`ViewPager's`在适配器中为页面设置任何宽度。无需额外代码即可查看`ViewPager`. 但是，如果您想在每个页面的顶部和底部添加空格，您可以将以下代码设置为`ViewPager's`子页面的父布局。

```
android:paddingTop="20dp"
android:paddingBottom="20dp" 
```

[![最终视图页面](../Images/d47e2eadd02434c1a8a75ca76937cd1c.png)](https://i.stack.imgur.com/mMQkS.jpg)

这将是 ViewPager 的最终外观。

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2017-08-09T19:37:42.757

`RecyclerView`在 2017 年，通过使用[PagerSnapHelper](https://developer.android.com/reference/android/support/v7/widget/PagerSnapHelper.html)（在 v7 支持库的 25.1.0 版中添加） 可以轻松实现这种行为：￼</p>

[![在此处输入图像描述](../Images/385531d40d065ac09a0cdb0fb97f4994.png)](https://i.stack.imgur.com/FAA9q.png)

前段时间我需要这样一个类似于 viewpager 的功能并准备了一个小库：

[MetalRecyclerPagerView](https://github.com/sandrfx/MetalRecyclerPagerView) - 您可以在那里找到所有代码以及示例。

它主要由一个类文件组成：[MetalRecyclerViewPager.java](https://github.com/sandrfx/MetalRecyclerPagerView/blob/master/library/src/main/java/com/sandrlab/widgets/MetalRecyclerViewPager.java)（和两个 xml：[attrs.xml](https://github.com/sandrfx/MetalRecyclerPagerView/blob/master/library/src/main/res/values/attrs.xml)和[ids.xml](https://github.com/sandrfx/MetalRecyclerPagerView/blob/master/library/src/main/res/values/ids.xml)）。

希望它可以帮助某人并节省一些时间:)

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2019-05-28T06:06:41.630

您可以在 xml 文件中执行此操作，只需使用以下代码：

```
 android:clipToPadding="false"
 android:paddingLeft="XX"
 android:paddingRight="XX" 
```

> 例如：

```
<androidx.viewpager.widget.ViewPager
        android:id="@+id/viewpager"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:clipToPadding="false"
        android:paddingLeft="30dp"
        android:paddingRight="30dp" /> 
```

> 注意：如果您需要页面之间的空间，请将填充/边距设置为子片段

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2018-02-23T11:37:58.480

如果有人仍在寻找解决方案，我已经自定义 ViewPage 以在不使用负边距的情况下实现它，请在此处找到示例项目[https://github.com/44kksharma/Android-ViewPager-Carousel-UI](https://github.com/44kksharma/Android-ViewPager-Carousel-UI) 它应该在大多数情况下都可以工作，但你仍然可以定义页边距 `mPager.setPageMargin(margin in pixel);`

[![](../Images/2b168a9e3884739f46f04aa6167d6cc1.png "在 imgflip.com 制作")](https://imgflip.com/gif/2557e5)

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2021-07-24T14:27:05.223

**Kotlin + ViewPager2**

[![在此处输入图像描述](../Images/77ae88d22e4b02af9593b23254973379.png)](https://i.stack.imgur.com/E5UC8.jpg)

我迟到了，但上述答案对我不起作用。所以我来这里是为了帮助那些仍在寻找答案的人。

1.  你的 XML：

    ```
     <androidx.viewpager2.widget.ViewPager2
         android:id="@+id/newsHomeViewPager"
         android:layout_width="match_parent"
         android:layout_height="wrap_content" /> 
    ```

2.  您的项目布局根视图应如下所示：

    ```
     <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
     android:layout_width="match_parent"
     android:layout_height="match_parent"
     android:paddingStart="@dimen/dp_10"
     xmlns:tools="http://schemas.android.com/tools"
     android:orientation="vertical" /> 
    ```

3.  您的活动/片段：

在设置 viewpager 适配器之前添加它

```
 newsHomeViewPager.apply {
        clipToPadding = false   // allow full width shown with padding
        clipChildren = false    // allow left/right item is not clipped
        offscreenPageLimit = 2  // make sure left/right item is rendered
    }

    //increase this offset to show more of left/right
    val offsetPx =
        resources.getDimension(R.dimen.dp_30).toInt().dpToPx(resources.displayMetrics)
    newsHomeViewPager.setPadding(0, 0, offsetPx, 0)

    //increase this offset to increase distance between 2 items
    val pageMarginPx =
        resources.getDimension(R.dimen.dp_5).toInt().dpToPx(resources.displayMetrics)
    val marginTransformer = MarginPageTransformer(pageMarginPx)
    newsHomeViewPager.setPageTransformer(marginTransformer) 
```

4.  dp 到像素函数：

    fun Int.dpToPx(displayMetrics: DisplayMetrics): Int = (this * displayMetrics.density).toInt()

**一般注意事项：**

1.  我只显示下一页，所以在`setPadding`方法中，我为左和`offsetPx`右保留了 0。因此，如果您也想显示右侧项目，`offsetPx`也可以在方法中添加到右侧。`setPadding`

2.  我已经使用了维度文件中的 dp，您可以使用自己的。

谢谢你，快乐的编码。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2019-02-07T07:28:33.210

对于那些努力在不同屏幕上拥有它的人来说，

```
mPager.setClipToPadding(false);
DisplayMetrics displayMetrics = new DisplayMetrics();
self.getWindowManager().getDefaultDisplay().getMetrics(displayMetrics);
int width = displayMetrics.widthPixels;
int paddingToSet = width/4; //set this ratio according to how much of the next and previos screen you want to show.
mPager.setPadding(paddingToSet,0,paddingToSet,0); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-12-16T09:50:29.743

感谢[这篇文章](https://code.luasoftware.com/tutorials/android/android-viewpager2-show-partial-preview-of-left-and-right/)的作者。这是我找到的最好的解决方案。

只需创建一个函数，例如。在您的`Helpers`班级中，例如：

```
fun ViewPager2.showHorizontalPreview(offsetDpLeft : Int, offsetDpRight : Int, marginBtwItems : Int){
        this.apply {
            clipToPadding = false   // allow full width shown with padding
            clipChildren = false    // allow left/right item is not clipped
            offscreenPageLimit = 2  // make sure left/right item is rendered
        }

        // increase this offset to show more of left/right
        val offsetPxLeft = offsetDpLeft.toPx()
        val offsetPxRight = offsetDpRight.toPx()
        this.setPadding(offsetPxLeft, 0, offsetPxRight, 0)

        // increase this offset to increase distance between 2 items
        val pageMarginPx = marginBtwItems.toPx()
        val marginTransformer = MarginPageTransformer(pageMarginPx)
        this.setPageTransformer(marginTransformer)
    } 
```

并称之为：

```
mViewPager.showHorizontalPreview(40,40,5) 
```

在您的活动/片段中

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-06-21T08:33:59.837

请注意，当为 viewpager 设置 none 零填充时，viewpager 的边缘效果放置会被搞砸，这是 viewpager 的错误，请参见此处：[viewpager edgeeffect bug](https://issuetracker.google.com/issues/68494185#comment1)

您可以通过设置`android:overScrollMode="never"`为 viewpager 来禁用边缘效果，或者您可以使用 EdgeEffect 类的略微修改版本来修复错误：[ViewPagerEdgeEffect 修复](https://github.com/ssynhtn/WrapContentViewPager/blob/master/wrapcontentviewpager/src/main/java/com/ssynhtn/wrapcontentviewpager/ViewPagerEdgeEffect.java)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-07-16T04:05:57.663

根据 Jiju 的回答，如果您想为 VIEWPAGER 2 设置页面之间的边距，请使用如下代码：

```
viewpager.setPageTransformer(new MarginPageTransformer(14)); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-09-11T15:01:36.223

```
 override fun getPageWidth(position: Int): Float {
    return 0.7f
} 
```

在适配器类文件中添加它，这对我有用

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-11-04T19:11:22.893

在 XML 文件中，您应该像这样设置填充： [![在此处输入图像描述](../Images/dab6a2ccf8f330e66fe1be35a1aed2f6.png)](https://i.stack.imgur.com/3zGHc.png)

在片段中：

```
int margin = (int) TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP, 20*2,     getResources().getDisplayMetrics()); 
```

并设置好，使用这个

```
myViewPager.setPageMargin(-margin); 
```

应该做的伎俩:)

* * *

## 回答 #14

> 赞同：-12
> 
> 时间：2012-11-05T07:12:18.520

使用此片段适配器和类在左右滚动中查看 viewpager。添加必要的类以滚动以查看下一页。

```
package com.rmn.viewpager;

import java.util.List;

import android.support.v4.app.Fragment;
import android.support.v4.app.FragmentManager;
import android.support.v4.app.FragmentPagerAdapter;

/**
 * The <code>PagerAdapter</code> serves the fragments when paging.
 * @author mwho
 */
public class PagerAdapter extends FragmentPagerAdapter {

    private List<Fragment> fragments;
    /**
     * @param fm
     * @param fragments
     */
    public PagerAdapter(FragmentManager fm, List<Fragment> fragments) {
        super(fm);
        this.fragments = fragments;
    }
    /* (non-Javadoc)
     * @see android.support.v4.app.FragmentPagerAdapter#getItem(int)
     */
    @Override
    public Fragment getItem(int position) {
        return this.fragments.get(position);
    }

    /* (non-Javadoc)
     * @see android.support.v4.view.PagerAdapter#getCount()
     */
    @Override
    public int getCount() {
        return this.fragments.size();
    }
}

package com.manishkpr.viewpager;

import android.content.Context;
import android.support.v4.app.Fragment;
import android.support.v4.app.FragmentManager;
import android.support.v4.app.FragmentPagerAdapter;

public class ViewPagerAdapter extends FragmentPagerAdapter {
    private Context _context;

    public ViewPagerAdapter(Context context, FragmentManager fm) {
        super(fm);  
        _context=context;

        }
    @Override
    public Fragment getItem(int position) {
        Fragment f = new Fragment();
        switch(position){
        case 0:
            f=LayoutOne.newInstance(_context);  
            break;
        case 1:
            f=LayoutTwo.newInstance(_context);  
            break;
        }
        return f;
    }
    @Override
    public int getCount() {
        return 2;
    }

} 
```

# c# - 创建树节点图

> ID：10098046
> 
> 赞同：6
> 
> 时间：2012-04-10T23:47:58.223
> 
> 标签：c#, gdi+

我正在尝试创建一个像节点图一样的树，就像[这里的示例图像](http://i39.tinypic.com/rclyc1.jpg)一样。我有以下代码：

```
 private void DrawNode(Graphics g, Node<T> node, float xOffset, float yOffset)
    {
        if (node == null)
        {
            return;
        }

        Bitmap bmp = (from b in _nodeBitmaps where b.Node.Value.Equals(node.Value) select b.Bitmap).FirstOrDefault();

        if (bmp != null)
        {
            g.DrawImage(bmp, xOffset, yOffset);

            DrawNode(g, node.LeftNode, xOffset - 30 , yOffset + 20);
            DrawNode(g, node.RightNode, xOffset + 30, yOffset + 20);
        }
    } 
```

我的代码几乎可以工作了。我遇到的问题是一些节点重叠。在上图中，节点 25 和 66 重叠。我敢肯定，原因是因为它在数学上放置左节点和右节点的空间相等，因此父节点的右节点与相邻父节点的左节点重叠。我该如何解决这个问题？

更新：

这是我根据 dtb 的建议进行的代码更新：

```
 int nodeWidth = 0;
            int rightChildWidth = 0;

            if (node.IsLeafNode)
            {
                nodeWidth = bmp.Width + 50;
            }
            else
            {
                int leftChildWidth = 0;

                Bitmap bmpLeft = null;
                Bitmap bmpRight = null;

                if (node.LeftNode != null)
                {
                    bmpLeft =
                        (from b in _nodeBitmaps where b.Node.Value.Equals(node.LeftNode.Value) select b.Bitmap).
                            FirstOrDefault();
                    if (bmpLeft != null)
                        leftChildWidth = bmpLeft.Width;
                }
                if (node.RightNode != null)
                {
                    bmpRight =
                        (from b in _nodeBitmaps where b.Node.Value.Equals(node.RightNode.Value) select b.Bitmap).
                            FirstOrDefault();
                    if (bmpRight != null)
                        rightChildWidth = bmpRight.Width;
                }

                nodeWidth = leftChildWidth + 50 + rightChildWidth;
            }

            g.DrawImage(bmp, xOffset + (nodeWidth - bmp.Width) / 2, yOffset);

            if (node.LeftNode != null)
            {
                DrawNode(g, node.LeftNode, xOffset, yOffset + 20);
            }
            if (node.RightNode != null)
            {
                DrawNode(g, node.RightNode, xOffset + nodeWidth - rightChildWidth, yOffset + 20);
            } 
```

这是此代码的屏幕截图：![截屏](../Images/72c687ceb544205ca3c75bcd02e7e2b7.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T00:22:23.127

为每个分配一个宽度`node`：

*   叶子的宽度是图像的宽度，`w`。
*   一个节点的宽度是它的左子节点的宽度+一个常数`d`+右子节点的宽度。

       ![插图](../Images/a73b5131155d24f7d2c94409d1f94932.png)

```
void CalculateWidth(Node<T> node)
{
    node.Width = 20;
    if (node.Left != null)
    {
        CalculateWidth(node.Left);
        node.Width += node.Left.Width;
    }
    if (node.Right != null)
    {
        CalculateWidth(node.Right);
        node.Width += node.Right.Width;
    }
    if (node.Width < bmp.Width)
    {
        node.Width = bmp.Width;
    }
} 
```

从根节点 和 开始`x = 0`，在宽度的一半处绘制图像，偏移量为`x`。
然后计算`x`每个子节点的位置并递归：

```
void DrawNode(Graphics g, Node<T> node, double x, double y)
{
    g.DrawImage(x + (node.Width - bmp.Width) / 2, y, bmp);

    if (node.Left != null)
    {
        DrawNode(g, node.Left, x, y + 20);
    }
    if (node.Right != null)
    {
        DrawNode(g, node.Right, x + node.Width - node.Right.Width, y + 20);
    }
} 
```

*用法：*

```
CalculateWidth(root);

DrawNode(g, root, 0, 0); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T23:58:21.920

你说得对，它们会重叠。这是因为您在遍历树时向 xOffset 添加/减去一个固定值。在示例图片中，它实际上不是一个固定的偏移量：相反，它是相对于其垂直位置的~~对数指数。~~你走得越远，偏移量应该越小。

~~将 30s 替换为`A * Math.Log(yOffset)`，其中 A 是一些缩放值，您必须对其进行调整，直到它看起来正确为止。~~

**编辑**：还是指数？我无法很好地想象这些东西。你最终可能会想要`A * Math.Exp(-B * yOffset)`。（负面影响很大：这意味着它会随着 yOffset 变大而变*小*，这正是您想要的。）

`A`将像您的主线性比例因子一样，同时`B`将控制偏移变小的速度。

```
double A = some_number;
double B = some_other_number;
int offset = (int)(A * Math.Exp(-B * yOffset));
DrawNode(g, node.LeftNode, xOffset - offset , yOffset + 20);
DrawNode(g, node.RightNode, xOffset + offset, yOffset + 20); 
```

**更新：**

```
double A = 75f;
double B = 0.05f;
int offset = (int)(A * Math.Exp(-B * (yOffset - 10)));
DrawNode(g, node.LeftNode, xOffset - offset, yOffset + 20);
DrawNode(g, node.RightNode, xOffset + offset, yOffset + 20); 
```

调用：

```
DrawNode(e.Graphics, head, this.ClientSize.Width / 2, 10f); 
```

Exp 中的`- 10`很重要：它是头部的初始 yOffset。它产生以下内容：

![](../Images/3610f61f78614d0522c82c903a3c4d2f.png)

如果您想要精确的边距/填充控制，那么请务必使用 dtb 的方法，但我认为使用单个公式的 3 行额外的行与您将获得的数学解决方案一样优雅。

**更新 2：**

我还忘了一件事：我正在使用 base `e = 2.7183`，但你想要更接近 2 的值。从逻辑上讲，你会使用 2，但由于节点的宽度不为零，你可能需要更大的东西，比如 2.1。`B`您可以通过乘以更改基数`Math.Log(new_base)`：

```
double B = 0.05f * Math.Log(2.1); 
```

我还应该解释一下我是如何得到 0.05f 的值的。基本上，树的每个级别都会增加`yOffset`20。`yOffset`如果我减去头部的初始值（在我的情况下是 10），那么我的前几个`yOffset`s 是 0、20、40、60 等。我希望每行的 x 偏移量减半；那是，

```
2 ^ (-0B) = 1
2 ^ (-20B) = 0.5
2 ^ (-40B) = 0.25 
```

显然，B 需要为 1/20，即 0.05。我`Math.Log(2.1)`从关系中得到价值：

```
base ^ exponent == e ^ (ln(base) * exponent) 
```

因此，使用 base 2.1，它看起来像这样：

![](../Images/ae8510cec6d4f318001437fa0df977fd.png)

# android - Android ndk-build 忽略 APP_ABI := x86

> ID：10098049
> 
> 赞同：41
> 
> 时间：2012-04-10T23:48:17.120
> 
> 标签：android, android-ndk

我正在尝试运行 NDK 来编译本机代码以在 Atom(x86) 处理器和 ARM 上运行。无论我如何设置 APP_ABI，NDK 都在生成 armeabi 库。即使我只为 APP_ABI 放置 x86。并且文件大小始终相同。这是我的 Application.mk 文件：

```
LOCAL_PATH := $(call my-dir)
APP_ABI := x86
include $(CLEAR_VARS)

LOCAL_LDLIBS    := -L$(SYSROOT)/usr/lib -llog 
LOCAL_MODULE    := myjni-jni
LOCAL_SRC_FILES := myjni-jni.c

include $(BUILD_SHARED_LIBRARY) 
```

不管我在 APP_ABI 之后放了什么，我都会得到 armeabi 并且它的大小总是一样的。这里有什么问题？我正在使用最新的 NDK。

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2012-04-11T00:49:14.173

您应该将 APP_ABI 变量放在**Application.mk**文件而不是**Android.mk**文件中。

它写在 NDK 的文档中（docs/CPU-ARCH-ABIS.html 文件）。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2013-03-21T23:54:50.937

如果您没有`Application.mk`文件，请`jni`在`project root`.

> project_root/jni/Application.mk

添加目标编译平台：

> APP_ABI := x86

或平台：

> APP_ABI := armeabi armeabi-v7a x86 mips

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-02-19T01:18:02.167

您也可以`APP_ABI`直接设置为`ndk-build`shell 命令：

```
ndk-build APP_ABI=x86 
```

# asp.net-mvc - 用于在 ASP.NET MVC 中显示图像图标的 jQuery Lightbox 插件

> ID：10098060
> 
> 赞同：1
> 
> 时间：2012-04-10T23:49:39.117
> 
> 标签：asp.net-mvc, jquery-plugins, path, lightbox

`but am not quite sure how to point jquery.lightbox-0.5.min.js to these files. It appears that no matter what I type in to try to point to the location in the lightbox script file, when I hover over the broken image links it ends up being`我在“内容/图像/灯箱http://locahost:8080/Home/Project/../Content/Images/Lightbox/lightbox-btn-close.gif ”中有​​我的灯箱的加载、上一个/下一个/关闭按钮

这是当我进入灯箱脚本文件并将位置更改为 ../Content/Images/Lightbox/lightbox-btn-close.gif 时，它相对于 javascript 文件（位于 中`Scripts/jquery.lightbox-0.5.min.js`）。

似乎它只是添加到我所在页面的当前位置并且`../`没有任何价值，因为它只是在当前 URL 的末尾添加了一个文字字符串。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T04:47:06.793

如果您的上一个/下一个/等。按钮位于“/Content/Images/Lightbox”文件夹中，那么正确的设置是（在文件“jquery.lightbox-0.5.js”中）：

```
// Configuration related to images
imageLoading:   '/Content/images/Lightbox/lightbox-ico-loading.gif',
imageBtnPrev:   '/Content/images/Lightbox/lightbox-btn-prev.gif',   
imageBtnNext:   '/Content/images/Lightbox/lightbox-btn-next.gif',   
imageBtnClose:  '/Content/images/Lightbox/lightbox-btn-close.gif',  
imageBlank:     '/Content/images/Lightbox/lightbox-blank.gif', 
```

该路径与灯箱的脚本文件（jquery.lightbox-0.5.min.js）无关，它与根应用程序路径相关。使用 '/' 而不是 '../etc.'。以“/”开头的路径是指根目录，以“../”开头的路径向后移动一个目录并从那里开始。

您可能不想在主灯箱脚本文件中更改它，然后在视图文件中设置选项：

```
 $(function () {
    $('#gallery a').lightBox({

        imageLoading: '/Content/images/Lightbox/lightbox-ico-loading.gif',
        imageBtnClose: '/Content/images/Lightbox/lightbox-btn-close.gif',
        imageBtnPrev: '/Content/images/Lightbox/lightbox-btn-prev.gif',
        imageBtnNext: '/Content/images/Lightbox/lightbox-btn-next.gif',  
    });
}); 
```

如果按钮图像是动态的，您可以使用 UrlHelper 在 veiw 文件中创建路径，例如`imageLoading: '@Url.Content("~/Content/images/Lightbox/lightbox-ico-loading.gif")',`

# php - Wordpress 中的 PHP While 控制结构

> ID：10098061
> 
> 赞同：2
> 
> 时间：2012-04-10T23:50:02.887
> 
> 标签：php, wordpress

我一直在努力使用 Wordpress 中的 PHP While 控制结构。我绝对知道这是可能的，只是不知道该怎么做。

我正在使用 Wordpress 数据库来存储我的小部件控件表单字段数据，并且我想用这段代码遍历数据。

```
need to control structure by the 2 numbers defined in my widget control.
$data['houses_row']
$data['shown_rows'] 
```

这是我正在尝试做的事情：

我在想房子，每个房子都在一块土地上作为类比。有点。

每行显示多少个房子？以及要显示多少行？

如果该行的房屋数量超出该行的处理能力，则需要隐藏这些房屋，这很自然。我在想很多房子到很多行。

我希望有人可以帮助我完成我的循环。

```
 static $number_posts_shown = 1;
    static $per_row_count = 0;

    while ( have_posts() ) : the_post();        

        if ( $per_row_count <= $data['houses_row'] ): 
        echo "show house: #". $per_row_count ." ";                  

                   endif;
        $per_row_count++;

        // show rows            
        if ( $number_posts_shown <= $data['shown_rows'] ):           
            echo "<hr />";
        endif;
        $number_posts_shown++;                  

    endwhile; 
```

当 shown_rows 为 4 并且houses_row(houses per row) 为 4 时，我希望输出是这样的。

```
show house: #0 show house: #1 show house: #2 show house: #3 
--------------------------------------------------------------------------------
blank
--------------------------------------------------------------------------------
blank
--------------------------------------------------------------------------------
blank 
```

当 shown_rows 为 4 且 house_row(houses per row) 为 2 时，输出就是这个。

```
show house: #0 show house: #1 
--------------------------------------------------------------------------------
show house: #2 show house: #3 
--------------------------------------------------------------------------------
blank row
--------------------------------------------------------------------------------
blank row 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T02:42:02.207

从您的问题中，我了解到您想根据以下格式显示房屋（存储在 wordpress 帖子中）：

```
$data['houses_row']
$data['shown_rows'] 
```

最简单的解决方案是先将已有的内容存储在临时数组中：

```
$temporary_data = array();
while ( have_posts() ) : the_post();

    $temporary_data[] = $post;//retrieve current post object

endwhile; 
```

获得所有发布数据后，开始第二个循环以生成它：

```
$current_house_counter = 0;
$available_slot = 0;
for($shown_row = 0; $shown_row < $data['shown_rows']; $shown_row++)
{
    for($house_row = 0; $house_row < $data['houses_row']; $house_row++)
    {
        if( isset($temporary_data[$current_house_counter]) )
        {
            echo "show house: #". ($current_house_counter + 1) ." ";
        }
        else
        {
            $available_slot++;
            echo "available slot #" . $available_slot . " ";
        }
        $current_house_counter++;
    }
    echo "<hr />";
} 
```

因为我目前没有安装 wordpress，所以我会给你这个代码片段来测试它：

```
$temporary_data[] = "data #1";
$temporary_data[] = "data #2";
$temporary_data[] = "data #3";
$temporary_data[] = "data #4";
$temporary_data[] = "data #5";

$data['houses_row'] = 3;
$data['shown_rows'] = 3;

$current_house_counter = 0;
$available_slot = 0;
for($shown_row = 0; $shown_row < $data['shown_rows']; $shown_row++)
{
    for($house_row = 0; $house_row < $data['houses_row']; $house_row++)
    {
        if( isset($temporary_data[$current_house_counter]) )
        {
            echo "show house: #". ($current_house_counter + 1) ." ";
        }
        else
        {
            $available_slot++;
            echo "available slot #" . $available_slot . " ";
        }
        $current_house_counter++;
    }
    echo "<hr />";
} 
```

上面的代码有以下结果：

```
show house: #1     show house: #2     show house: #3 <hr />
show house: #4     show house: #5     available slot #1 <hr />
available slot #2  available slot #3  available slot #4 <hr /> 
```

# jquery - Jquery Href - 需要在 mac 和 pc 上使用

> ID：10098067
> 
> 赞同：0
> 
> 时间：2012-04-10T23:50:59.473
> 
> 标签：jquery, href

我正在编写一个可供 500 多人访问的 HTML 程序，在 html 页面中，我需要将其链接到来自侧服务器的 pdf 文件 - 但是我无法将网页上传到服务器，

计算机分为 mac 和 PC，我如何使用 Jquery 来检测计算机是什么操作系统，并从中决定使用哪个 href 链接（从 pc 获取文件使用服务器名称 KPA0DSOT10 - 但是从mac 我需要使用“Volumes”，或者在 JQUERY 中有一种方法可以将一个链接转发，如果它无法打开它会尝试另一个链接？ - 一个 html 页面上有超过 20,000 个链接，所以如果有一个快速和无需再次写出所有链接的简单方法将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T23:54:15.053

检查`navigator.appVersion`变量，然后相应地修改页面上所有指向 .pdf 的链接。从[.ready()](http://api.jquery.com/ready/)函数执行此操作。

```
$(document).ready(function() {
    if (navigator.appVersion.indexOf("Win") != -1) {
        // Computers runs windows
        $("a[href*='.pdf']").each(function() {
            this.href = this.href.replace("word_to_replace", "win_replacement");
        });
    }
    if (navigator.appVersion.indexOf("Mac") != -1) {
        // computer is a Mac
        $("a[href*='.pdf']").each(function() {
            this.href = this.href.replace("word_to_replace", "mac_replacement");
        });
    }
} 
```

# iphone - 简单游戏 - 得分后添加倒计时

> ID：10098072
> 
> 赞同：0
> 
> 时间：2012-04-10T23:51:42.330
> 
> 标签：iphone, objective-c, timer

我正在用 Objective-C 创建一个简单的网球游戏。目前，当球员或计算机得分时，它会给出一条消息“轻击开始”并释放球（将拇指放在球拍上而另一个拇指轻击开始有点尴尬）。

如何在我的游戏中添加一个计时器，这样我就不必在每次得分后点击？

（此代码为有新游戏和有分数时的重置方法）

```
{

self.gameState = kGameStatePaused;

ball.center = self.view.center;

if(newGame)

{
    if(computerScoreValue > playerScoreValue)

    {
        tapToBegin.textAlignment = UITextAlignmentCenter;
        tapToBegin.text = @"Computer Wins!";
        AudioServicesPlaySystemSound(booFileID);
    }

    else

    {
        tapToBegin.textAlignment = UITextAlignmentCenter;
        tapToBegin.text = @"You Win!";
        AudioServicesPlaySystemSound(clappingFileID);
    }

    computerScoreValue = 0;
    playerScoreValue = 0;
}
else
{
    tapToBegin.textAlignment = UITextAlignmentCenter;
    tapToBegin.text = @"Tap to Begin";

}
playerScore.text = [NSString stringWithFormat:@"%d",playerScoreValue];
computerScore.text = [NSString stringWithFormat:@"%d",computerScoreValue];

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T00:34:36.320

[NSTimer](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nstimer_Class/Reference/NSTimer.html)应该可以工作。如果你好奇，也可以看看[CADisplayLink](http://developer.apple.com/library/ios/#documentation/QuartzCore/Reference/CADisplayLink_ClassRef/Reference/Reference.html)。

# php - 如何fb隐藏表情符号路径以及如何找到它

> ID：10098075
> 
> 赞同：1
> 
> 时间：2012-04-10T23:52:16.450
> 
> 标签：php, facebook, chat, emoticons

我通常做一个

```
array(

" :) ", " :( "

); 
```

用表情符号然后我用替换做另一个数组

```
array(

'<img src="smile.png"/>',
'<img src="sad.png"/>'
); 
```

然后我用`str_replace ($theFirstArray, $secondArray, $and here is the message);`

但我注意到，在 Facebook 聊天中，表情符号没有指向图像的路径，而是它们导致

[https://s-static.ak.facebook.com/images/blank.gif](https://s-static.ak.facebook.com/images/blank.gif)

这是如何实现的？

# javascript - 为什么 StreetView JS API 不能正确镜像 StreetView 静态 API？

> ID：10098077
> 
> 赞同：1
> 
> 时间：2012-04-10T23:52:35.650
> 
> 标签：javascript, google-maps-api-3, google-static-maps, google-street-view

我正在尝试使用 JS StreetView API 让用户选择他们希望用于静态 StreetView 图像的视图。我已经在我的[沙箱](http://sandbox.drewsonne.com/maps.html)实例上构建了一个基本测试（以及未来的后代）。

当页面首次加载时，StreetView 视口会加载，并且反映该视口的静态图像会正确加载。如果我在没有我的位置的情况下平移，静态图像会正确更新。

我正在使用对`pov_changed`、`position_changed`和`visible_changed`事件进行调用来调用静态图像的更新。我在这些事件的触发之间延迟了半秒，以免引发配额错误。

**我的问题是：** 如果我使用任何“clickToGo”操作来更改我的位置，我的静态 StreetView 中显示的位置（纬度/经度）不会正确反映 JS StreetView 视口。据我所知，pov（fov/zoom、heading、pitch）都是正确的，但我的位置不正确。

```
<!DOCTYPE html>
<html>
    <head>
        <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
        <script type="text/javascript">

          function initialize() {
            var panorama = new google.maps.StreetViewPanorama(document.getElementById("pano"), {
              position: new google.maps.LatLng(42.345573,-71.098326),
              pov: {
                heading: 34,
                pitch: 10,
                zoom: 1
              }
            });

            /**
             * Build static URL from streetview JS instance settings
             */
            function getStaticUrl(secure) {
                secure = (secure) ? 's' : '';
                var latlng = panorama.getPosition();
                var pov = panorama.getPov();
                var url = "http" + secure + "://maps.googleapis.com/maps/api/streetview?size=500x400&location=" + encodeURIComponent(latlng.lat() + ", " + latlng.lng()) + "&fov=" + (180 / Math.pow(2, pov.zoom)) + "&heading=" + encodeURI(pov.heading) + "&pitch=" + encodeURI(pov.pitch) + "&sensor=false";
                console.log("lat: " + latlng.lat() + "     " + "lng: " + latlng.lng());
                console.log("img src: " + url);
                return url;
            }

            /**
             * To stop overusing quota errors with the static streetview API, wait half a second after streetview has stopped moving to
             * update image preview.
             */
            var _updateStreetViewWait = 0;
            var _handleStreetViewPovChange = function() {
                clearTimeout(_updateStreetViewWait);
                _updateStreetViewWait = setTimeout(function() {
                    var linkUrl = getStaticUrl();
                    $('#link').html("<a target='_blank' href='" + linkUrl + "'><img src='" + linkUrl + "'/></a>");
                }, 500);
            };
            google.maps.event.addListener(panorama, 'pov_changed', _handleStreetViewPovChange);
            google.maps.event.addListener(panorama, 'position_changed', _handleStreetViewPovChange);
            google.maps.event.addListener(panorama, 'visible_changed', _handleStreetViewPovChange);
          }
        </script>
    </head>
    <body onload="initialize()">
      <div id="pano" style="width: 500px; height: 400px"></div>
      <div id="link" style="width:100%; height: 2%"></div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T15:08:46.970

两种不同的 API 使用不同的投影系统。JS API 根据浏览器使用不同的投影，所以它们不会排成一行

# html - MongoDB 不允许保存在 Rockmongo 中

> ID：10098082
> 
> 赞同：0
> 
> 时间：2012-04-10T23:53:18.453
> 
> 标签：html, json, mongodb, rockmongo

我使用 Rockmongo 作为 UI，我正在尝试保存与此类似的东西。

```
text text's text. <p>text this is where the text goes</p><h1>haha</h1> 
```

现在我不确定它是`.,'`还是`? <p>`等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T15:12:24.280

我无法重现这一点。这是我在 JavaScript shell 中尝试的：

```
> db.text.save({_id:1, text:"text text's text. <p>text this is where the text goes</p><h1>haha</h1>"})
> db.text.find()
{ "_id" : 1, "text" : "text text's text. <p>text this is where the text goes</p><h1>haha</h1>" } 
```

该行已成功保存。您是否用双引号括住文本字符串 " ？正如 bfavaretto 所提到的，问题可能来自字符串中的单个撇号。以下内容将不起作用：

```
> db.text.drop()
true
> db.text.save({_id:1, text:'This is text with an extra ' apostrophe.'})
... 
... 
> db.text.find()
> 
```

如您所见，上述文档未保存，因为字符串格式不正确。事实上，JS shell 甚至从未执行过该命令。

Mongo 应该能够保存包含所有这些字符的字符串。如果您仍然有问题，也许这可能是 RockMongo 的问题？（不幸的是，我不熟悉这个程序。）一个简单的故障排除方法是测试一次保存每个唯一字符，看看是哪个字符导致了问题。希望这可以帮助！

# php - PHP 和 Windows WMI、CPU 温度和错误读数？

> ID：10098083
> 
> 赞同：3
> 
> 时间：2012-04-10T23:53:33.390
> 
> 标签：php, function, wmi, cpu

我写了这个 PHP 函数：

```
<?php
//windows cpu temperature
function win_cpu_temp(){
    $wmi = new COM("winmgmts://./root\WMI");
    $cpus = $wmi->execquery("SELECT * FROM MSAcpi_ThermalZoneTemperature");
    foreach ($cpus as $cpu) {
        $cpupre = $cpu->CurrentTemperature;
    }
    $cpu_temp = ($cpupre/10)-273.15 . ' C';
    return $cpu_temp;
}
echo win_cpu_temp();
?> 
```

我的问题是脚本显示`59.55 C`我认为是正确的。几个小时后我检查了这个值，它完全一样。我只是让 CPU 工作在 90% 压缩视频十分钟，这个值还是一样的。

谁能帮我找到这个功能的“真实”价值？

我已阅读（无济于事）： [MSAcpi_ThermalZoneTemperature 类未显示实际温度](https://stackoverflow.com/questions/9101295/msacpi-thermalzonetemperature-class-not-showing-actual-temperature)

比如说，“Core Temp”是如何获得它的值的？同一台计算机，它报告的温度在 49 到 53 摄氏度之间。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-13T20:59:22.747

经过一番挖掘，我发现使用 MSAcpi_ThermalZoneTemperature 的常见问题是它取决于在您的系统上实现。

您可以尝试查询[Win32_TemperatureProbe](http://msdn.microsoft.com/en-us/library/windows/desktop/aa394493%28v=vs.85%29.aspx)并查看是否有任何运气。

MSAcpi_ThermalZoneTemperature 或 Win32_TemperatureProbe 在我的系统上都不起作用，但如果您具有管理员访问权限，则可以使用[http://openhardwaremonitor.org/](http://openhardwaremonitor.org/)，它为所有可用的传感器数据提供了 WMI 接口。

这对我很有用，我能够从 PHP 脚本准确地报告 CPU Core temp：

```
function report_cpu_temp(){    
    $wmi = new COM('winmgmts://./root/OpenHardwareMonitor');
    $result = $wmi->ExecQuery("SELECT * FROM Sensor");
    foreach($result as $obj){
        if($obj->SensorType == 'Temperature' && strpos($obj->Parent, 'cpu') > 0)
            echo "$obj->Name ($obj->Value C)"; // output cpu core temp
        else
            echo 'skipping ' . $obj->Identifier ;
        echo '<br />';
    }
} 
```

希望这可以帮助。

# ruby-on-rails - rake assets:precompile 启动环境 3 次是否正常？（轨道 3.2.3）

> ID：10098085
> 
> 赞同：1
> 
> 时间：2012-04-10T23:53:38.050
> 
> 标签：ruby-on-rails, ruby-on-rails-3

如果我将 config/application.rb 放在 rails 3.2.3 应用程序上：

```
config.assets.precompile << "foo.js"
puts "hello" 
```

我再看看吧：

```
hello
hello
hello 
```

这是正常和预期的行为吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T15:23:23.460

如果您使用的是像乘客或独角兽这样的多进程 Web 服务器，那么可以。需要将整个 rails 环境加载到每个流程实例中。

# java - Dalvik VM 错误：发现异常“Javax.xml.namespace.QName.class”

> ID：10098088
> 
> 赞同：16
> 
> 时间：2012-04-10T23:54:12.197
> 
> 标签：java, android, eclipse, dalvik, google-places-api

这不是一个问题。相反，当您使用外部 API 进行开发和 android.jar 时，在 Android 中发现的一个常见问题不会被复制到您的项目中！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-16T15:06:38.850

在各种论坛、谷歌和stackoverflow搜索之后，我似乎自己得到了一个解决方案，并想到了分享它。

1.  每当您链接外部库时，最好通过创建 /lib 文件夹来链接它并将那些 .jar 转储到那里（意味着复制文件而不是链接它们）。使用**Eclipse -> Build Properties -> Configure Build path -> Library tab -> Add external Jars**链接它们。在此添加保存在 /lib 文件夹中的所需 .jar。（请注意，**在 Eclipse 中作为“引用库”包含的 jar 将在 /lib 文件夹中消失！**但是，不要担心，因为发生了正确的链接。另一个注意事项是检查引用的 /lib jar 是否不可见在构建属性的库选项卡中，因为它将被继承。）

2.  另一个主要问题是何时使用 Google API。特别是那些使用 java/javax 的一些核心库函数的那些。对此要非常小心。错误在于，DalvikVM 尝试链接这些但由于发现重复而失败并且无法决定引用哪个。下面是错误。

    ```
    Dx trouble processing "javax/xml/namespace/QName.class": 
    Ill-advised or mistaken usage of a core class (java.* or javax.*) when not building a core library. 
    ```

在这种情况下，我观​​察到，这个类在**xpp3-1.1.4c.jar 中使用。如果您已将其复制到您的 /lib 文件夹中，请删除它**。然后清理项目，并重新构建。此后船顺利航行。

如果存在此类重复，请对其他引用的 .jar 执行此操作。

干杯!

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-27T21:40:38.097

这对我有用。我正在使用 maven，xpp3-1.1.4c 依赖项显示在“Maven 依赖项”下；我不得不使用（右键单击依赖项）Maven->“排除 Maven Artifact...”来排除它。非常感谢 - 这真的很模糊。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-02-06T16:22:15.880

此错误仅在您尝试生成签名 APK 时显示。有两种方法可以解决此问题。

**1\. 正如 Amira Elsayed Ismail 在这篇文章中评论的那样，[我们](https://stackoverflow.com/q/47018474/5805371) 应该恢复到 gradle 2.3.3。**

为此，您还应该下载 Android Studio 2.3.3，因为 studio 3.0.1 需要 gradle 插件 3.0+

这是第一个解决方案。但是还原 Android Studio 和 gradle 插件是一个痛苦的解决方案。

**2.** **解决所有依赖冲突。**

当我恢复 gradle 时，Studio 2.3.3 显示我们感兴趣的警告（*我不知道为什么 Studio 3.0.1 不显示依赖冲突警告*）

`Warning:WARNING: Dependency xpp3:xpp3:1.1.4c is ignored for debug as it may be conflicting with the internal version provided by Android. Warning:WARNING: Dependency org.apache.httpcomponents:httpclient:4.3.3 is ignored for debug as it may be conflicting with the internal version provided by Android.`

因此，这些依赖项在调试时被忽略，而**不是在发布**时被忽略。我通过排除这些依赖项来解决这个问题。

```
configurations {
        all*.exclude group: 'xpp3', module: ['xpp3' ,'httpclient']
    } 
```

在此之后，我使用 gradle 3.0.1 成功生成了签名的 APK。***（不恢复）***。

# javascript - 返回 false 有时不起作用

> ID：10098093
> 
> 赞同：0
> 
> 时间：2012-04-10T23:54:52.913
> 
> 标签：javascript, jquery, hyperlink, return-value

我有一个带有照片库的页面[http://dev.dolina-imeniy.ru/fotogalereya/kp_usadba_tishnevo/](http://dev.dolina-imeniy.ru/fotogalereya/kp_usadba_tishnevo/) 我用它来绑定点击事件并将其返回 false

```
$('a.link_photo').click(function(e) {
var new_img = $(this).attr('href');
var photo_title = $(this).attr('title');
var photo_info = $('.photo_info', this).html();
$('#photo_view img').attr({
    src : new_img
});
$('#photo_title').html(photo_title);
$('#photo_info').html(photo_info);
return false;
    }); 
```

但在某些图像上它不起作用！为什么会出现？

**尝试在我的示例中单击 10 个图像 (ut-1-foto.jpg) 来查看它。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T23:56:09.123

由于某种原因，您的代码正在中断，因此无法返回 false。

您可以使用`e.preventDefault();`来停止默认操作

```
e.preventDefault(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T23:59:19.750

尝试调用 e.preventDefault()

欲了解更多信息，请看这里： [http ://api.jquery.com/event.preventDefault/](http://api.jquery.com/event.preventDefault/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-11T00:13:25.607

这样做的原因是该函数仅绑定到调用时已经存在的元素。在文档加载后创建的每个链接都不会绑定到此函数。要监听这些元素的创建并将函数绑定到它们，您可以使用 jQuery 插件[liveQuery](http://docs.jquery.com/Plugins/livequery)。我希望这会有所帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-11T00:02:20.653

我不认为`return false;`或`event.preventDefault()`与它有任何关系。我猜这与你的轮播的工作方式有关。一旦图像开始重复，您的代码就会中断，这并非巧合——点击事件可能不再绑定。如果元素只是被移动，事件仍应设置，但如果它被克隆或复制，则事件可能不会。

编辑：我可以通过调试确认您的脚本甚至没有在“损坏”链接上调用。

# git - git 我可以查看远程的 reflog 吗？

> ID：10098095
> 
> 赞同：77
> 
> 时间：2012-04-10T23:54:59.377
> 
> 标签：git

是否可以查看遥控器的 reflog？也就是说，我想知道`git reflog`另一台远程机器上的输出是什么。

`reflog`请注意，我不是要远程跟踪分支（例如 origin/master）的reflog ，我要的是*另一台机器上的*内容。

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2016-02-08T15:56:20.903

如果远程机器是 github 存储库，

1.  首先使用 Github 的事件 API 来检索提交 SHA。
    `curl https://api.github.com/repos/<user>/<repo>/events`

2.  识别不再存在于任何分支**中的孤立提交 ID 的 SHA 。**

3.  接下来，使用 Github 的 Refs API 创建一个指向孤立提交的新分支。

    `curl -i -H "Accept: application/json" -H "Content-Type: application/json" -X POST -d '{"ref":"refs/heads/D-commit", "sha":"<orphan-commit-id>"}' https://api.github.com/repos/<user>/<repo>/git/refs`

    *用步骤 2 中确定的 SHA替换`<orphan-commit-id>`上述命令。*

4.  最后`git fetch`将新创建的分支放入您的本地存储库。
    从那里你可以挑选或合并提交到你的工作中。

查看[**本文**](https://objectpartners.com/2014/02/11/recovering-a-commit-from-githubs-reflog/)以获取实际示例。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2012-04-11T01:17:04.187

答案基本上是“否”（在那台机器上除外），因为 reflog 是本地重新分配某些 ref-name 的日志。本质上，每次运行`git update-ref -m msg <name> <target>`更新都会记录...本地：`.git/logs/<name>`附加一行：

```
$ git update-ref -m foo HEAD HEAD^
$ tail -1 .git/logs/HEAD
2418b6ba8fd0289933c9351260a272b8e410867f 8d945134b0cead535d66af29c8eb4228b5dc3763 [redacted] <[redacted]> 1334106483 -0600     foo 
```

（在这种情况下，消息之前的东西`foo`不是空格，而是一个制表符；我出于 SO 目的对其进行了扩展）。从概念上讲，移动分支提示的所有其他内容都会调用`git update-ref`来执行此操作（有些是 shell 脚本，实际上是这样做的，其他只是调用执行所有文件更新的 C 代码）......并且所有内容都`.git/logs`构成了 reflog。

如果底层 git:// 和/或 ssh:// 协议中有一些东西可以让你访问 reflog，那会这样做，但据我所知没有。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2017-05-03T19:42:54.180

在 GitHub 上，如果您`git push --force`之前在 master 上错误地获取了合并的更改，同时合并的分支被删除了（是的，它发生在我身上），您可以查找合并的拉取请求并转到**Commits**部分，例如：

[![在此处输入图像描述](../Images/827c86c5d93171d23bd643125624138d.png)](https://i.stack.imgur.com/k4Tam.png)

然后您继续最后一次提交并单击`<>`按钮（标题为“在历史记录中的此时浏览存储库”）。

这将把你带到历史的“删除”点。从这里您可以：

*   创建一个新分支，然后打开一个新的拉取请求（如果更改来自另一个存储库，建议使用）。
*   打开一个新的拉取请求（建议在您的存储库内提交）。

# php - 文件上传成功时如何插入值

> ID：10098098
> 
> 赞同：-1
> 
> 时间：2012-04-10T23:55:17.070
> 
> 标签：php, javascript, jquery

我[在这里](http://er5325.aisites.com/scripts/stack/test.html)有一个应用程序，用户可以使用 Mas 的 Ajax 文件上传器上传文件。用户必须先通过单击“添加问题”按钮添加一行，然后才能使用文件上传器。我想知道的是如何对其进行编码以及将代码放置在哪里，以便每次用户为每一行选择一个文件时，当用户单击“上传”按钮时，它会将文件位置插入文本框中的那一行到数据库中，但只有当文件位置不在数据库中并且文件上传成功时才会这样做？

我想在“ImageFile”字段中插入值，对于 ImageId 字段，每次插入值时都应添加字符串“IMG”，然后在字符串后面添加下一个数字。例如，如果最后一个 ImageId 是“IMG3”，那么当插入一个值时，下一个 ImageId 应该是“IMG4”，然后插入的下一个值意味着下一个 id 是“IMG5”等等。我已经连接了数据库。

下面是 php 代码，其中包含我目前拥有的 INSERT VALUES 和查询代码：

```
if (isset($_POST['fileImage'])) {

$_SESSION['fileImage'] = $_POST['fileImage'];

}

if (isset($_POST['submitImageBtn'])) {

$imagequery = "SELECT ImageId, ImageFile FROM Image";

    $insertimage[] = "'". mysql_real_escape_string( $_SESSION['fileImage'] ) ."'";

  $imagequery = "INSERT INTO Image (ImageId, ImageFile) 
  VALUES (" . implode('), (', $insertimage) . ")";

  mysql_query($imagequery); 
```

下面是它在每个表行中附加文件上传器以及上传过程发生的代码：（这是在 JavaScript 中，尽管我知道在 php 中插入值）

下面是它上传文件的php页面：

```
<?php

   $destination_path = str_replace("//", "/", $_SERVER['DOCUMENT_ROOT']."/")."ImageFiles";

   $result = 0;

   $target_path = $destination_path . basename( $_FILES['fileImage']['name']);

   if(@move_uploaded_file($_FILES['fileImage']['tmp_name'], $target_path)) {
      $result = 1;
   }

   sleep(1);
?>

<script language="javascript" type="text/javascript">window.top.window.stopImageUpload(<?php echo $result; ?>);</script>   

 <script type="text/javascript">
         var sourceForm; 

        function insertQuestion(form) {   

            var $tbody = $('#qandatbl > tbody'); 
            var $tr = $("<tr class='optionAndAnswer' align='center'></tr>");
            var $image = $("<td class='image'></td>"); 

           var $fileImage = $("<form action='imageupload.php' method='post' enctype='multipart/form-data' target='upload_target' onsubmit='startUpload(this);' class='imageuploadform' >" + 
            "<p class='imagef1_upload_process' align='center'>Loading...<br/><img src='Images/loader.gif' /><br/></p><p class='imagef1_upload_form' align='center'><br/><label>" + 
            "File: <input name='fileImage' type='file' class='fileImage' /></label><br/><label>" + 
            "(jpg, jpeg, pjpeg, gif, png, tif)</label><br/><br/><label>" + 
            "<input type='submit' name='submitBtn' class='sbtn' value='Upload' /></label>" +
            "</p> <iframe class='upload_target' name='upload_target' src='#' style='wclassth:0;height:0;border:0px;solclass #fff;'></iframe></form>");

            $image.append($fileImage);

            $tr.append($image);  
            $tbody.append($tr); 

        }

       function startUpload(imageuploadform){
      $(imageuploadform).find('.imagef1_upload_process').css('visibility','visible');
      $(imageuploadform).find('.imagef1_upload_form').css('visibility','hidden');
      sourceForm = imageuploadform;
          return true;
    }

        function stopUpload(success){
              var result = '';
              if (success == 1){
                 result = '<span class="msg">The file was uploaded successfully!<\/span><br/><br/>';
              }
              else {
                 result = '<span class="emsg">There was an error during file upload!<\/span><br/> <br/>' ;
              }
              $(sourceForm).find('.imagef1_upload_process').css('visibility','hidden');
              $(sourceForm).find('.imagef1_upload_form').html(result + '<label>File: <input name="fileImage" type="file"/><\/label><br/><label>(jpg, jpeg, pjpeg, gif, png, tif)</label><br/><br/><label><input type="submit" name="submitBtn" class="sbtn" value="Upload" /><\/label>');
              $(sourceForm).find('.imagef1_upload_form').css('visibility','visible');     
              return true;   
        }
        </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T05:49:12.050

你可以把`INSERT`你的里面

```
if(@move_uploaded_file($_FILES['fileImage']['tmp_name'], $target_path)) {
    $result = 1;

    ... insert image details into database here ...
} 
```

我还可以建议对图像 id 使用自动增量 id，对存储图像的名称使用安全随机字符串。然后，您可以返回最后一个插入 id 或 -1 表示失败（或包含这些和任何其他详细信息的 XML/JSON 对象）。

祝你好运

# c - C分配不同大小的二维数组

> ID：10098099
> 
> 赞同：0
> 
> 时间：2012-04-10T23:55:21.620
> 
> 标签：c, arrays, malloc

我有这个：

```
uint64_t **array;
int a;

if((array = malloc(8 * 25)) == NULL){
    errx(1, "malloc");
}

for(a = 0; a < 25; a++){
    if((array[a] = malloc(8 * (1 << a))) == NULL){
        errx(1, "malloc 1");
    }   
} 
```

在最坏的情况下，我将使用 2^a 位，这意味着，我并不总是需要为此使用 uint64_t，甚至 uint。我的想法是只为 < 8 分配 1 个字节，为 < 16 和 >=8 分配 2 个字节，这样分配到 8 个字节（uint64_t）。

有可能这样做吗？我怎么能只使用我的变量数组来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T01:04:08.857

这可能应该是一条评论（或 3 条），但是……

您需要首先弄清楚您需要多少字节（以及为什么，尽管我假设您已经涵盖了那部分。）

什么是25？为什么要为 25 个大小为 8、16、32 ... 2^27 的不同数组分配内存？这可能是示例代码，但我们仍然被一个神奇的数字所迷惑：25。我们本可以使用常量（或预处理器宏）的名称。

8 是另一个神奇的数字，也是有问题的。`sizeof(*array)`不保证是8。

我也有点被你的想法弄糊涂了。您当前的代码为 a=7 分配 1024 个字节。单个字节如何足以存储您认为需要在原型中分配 1024 个字节的内容？

# python - 使用 Python tkinter 画布的上标问题

> ID：10098100
> 
> 赞同：1
> 
> 时间：2012-04-10T23:55:25.823
> 
> 标签：python, unicode, canvas, tkinter, superscript

我正在尝试使用 canvas.create_text(...) 将文本添加到绘图中。我通过以下方式使用 unicode 取得了一定的成功：

```
mytext = u'U\u2076'  #U^6
canvas.create_text(xPos,yPos,text = mytext, font = ("Times","30")
canvas.pack() 
```

它可以工作，但是当增加字体大小时，上标 4,5,6,7,8,9,0 的大小不会增加。只有 1,2,3 工作。我假设下标是一样的。此外，当我将画布另存为附言时，问题上标消失了......但是当我打印出保存的图像时，上标返回。

我的方法完全错了吗？我只是想完成这项工作，因此将不胜感激任何帮助。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T12:03:43.767

您的问题来自您的平台和字体中对 Unicode 的处理。正如[维基百科](http://en.wikipedia.org/wiki/Unicode_subscripts_and_superscripts)上解释的那样：上标 1,2 和 3 以前在 Latin-1 中处理过，因此在字体方面得到了不同的支持。

我没有注意到固定大小问题，但在大多数字体（在 Linux 和 MacOS 上）上，1、2、3 与 4-9 没有正确对齐。

我的建议是选择一种符合您需要的字体（您可以查看提供自由高质量字体的 DejaVu 系列）。

这是一个小应用程序，用于说明不同字体或大小的上标的处理。

```
from Tkinter import *
import tkFont

master = Tk()

canvas = Canvas(master, width=600, height=150)
canvas.grid(row=0, column=0, columnspan=2, sticky=W+N+E+S)

list = Listbox(master)
for f in sorted(tkFont.families()):
    list.insert(END, f)

list.grid(row=1, column=0)

font_size= IntVar()
ruler = Scale(master, orient=HORIZONTAL, from_=1, to=200, variable=font_size)
ruler.grid(row=1, column=1, sticky=W+E)

def font_changed(*args):
    sel = list.curselection()
    font_name = list.get(sel[0]) if len(sel) > 0 else "Times"
    canvas.itemconfig(text_item, font=(font_name,font_size.get()))
    #force redrawing of the whole Canvas
    # dirty rectangle of text items has bug with "superscript" character
    canvas.event_generate("<Configure>")

def draw():
    supernumber_exception={1:u'\u00b9', 2:u'\u00b2', 3:u'\u00b3'}
    mytext =""
    for i in range(10):
        mytext += u'U'+ (supernumber_exception[i] if i in supernumber_exception else unichr(8304+i))+" "
    return canvas.create_text(50, 50,text = mytext, anchor=NW)

text_item = draw()

list.bind("<<ListboxSelect>>", font_changed)

font_size.trace("w", font_changed)
font_size.set(30)

master.grid_columnconfigure(0, weight=0)
master.grid_columnconfigure(1, weight=1)
master.grid_rowconfigure(0, weight=1)
master.grid_rowconfigure(1, weight=0)

master.mainloop() 
```

# maven - 是否有将 Jenkins 的构建与 Maven (Nexus) 工件联系起来的插件

> ID：10098104
> 
> 赞同：4
> 
> 时间：2012-04-10T23:56:02.277
> 
> 标签：maven, nexus, hudson-plugins, jenkins-plugins

我想知道是否有一个 Hudson/Jenkins 插件将存储库工件与创建它们的构建联系起来？我正在查看[“从 nexus 存储库中删除工件”](https://stackoverflow.com/questions/3692681/remove-artifacts-from-nexus-repository)的问题，并认为在 Jenkins 中删除构建还应该提供删除构建创建的工件的选项。

我们目前正在运行[Jenkins 1.447](http://jenkins-ci.org/changelog)和 Nexus Open Source 1.9.2.3。我们的 Jenkins 构建使用 Maven 部署目标在我们的 Nexus 存储库中创建工件。我似乎一旦部署了这些工件，就没有类似的自动化机制来删除它们。我们希望将 Jenkins 构建与其 Nexus 工件联系起来。我想如果我们决定从 Jenkins 中删除构建，我们对构建没有用处，因此也不需要存储该构建的工件。我们希望删除构建以触发删除 Nexus 工件。

如果没有可用的东西，我想我可以开始写一些东西，但我想看看其他人是如何处理这个问题的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T07:20:41.667

[您可以通过maven-dependency-plugin](http://maven.apache.org/plugins/maven-dependency-plugin/purge-local-repository-mojo.html)从本地存储库中清除工件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T19:19:04.493

如果您有一个版本，那么根据构建服务器的编号对其进行编号是没有意义的。通常的用例是为此目的使用 SNAPSHOT。此外，通常的用例是在一段时间后从 Nexus 中删除基于计划任务的 SNAPSHOT，但永远不会从 Nexus 中删除版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T20:04:50.497

由于您知道版本的名称，您可以构建自定义作业或触发器以使用 wget 命令从 nexus 存储库中删除工件。

作为 Nexus 中的正确用户，您确实可以删除发布工件，而不仅仅是 SNAPSHOTS。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T09:30:08.017

您可以使用 Nexus 的 REST API 构建您自己的 Jenkins 插件，为您完成这项工作。您可以使用 Nexus 自定义元数据插件存储 Jenkins Build Job 编号。删除构建后，您可以让您的自定义 Jenkins 插件删除 Nexus 中在其元数据中具有该构建号的所有工件。我有一个类似的问题并编写了一个自定义 Jenkins 插件。在 github 上查看教程和源代码。这应该很简单。

教程： http: [//blog.codecentric.de/en/2012/08/tutorial-create-a-jenkins-plugin-to-integrate-jenkins-and-nexus-repository/](http://blog.codecentric.de/en/2012/08/tutorial-create-a-jenkins-plugin-to-integrate-jenkins-and-nexus-repository/)

源代码： [https ://github.com/marcelbirkner/nexus-metadata-plugin/](https://github.com/marcelbirkner/nexus-metadata-plugin/)

# javascript - 在单个 .on() 调用中绑定多个事件

> ID：10098108
> 
> 赞同：1
> 
> 时间：2012-04-10T23:56:14.417
> 
> 标签：javascript, jquery

好吧，一直在努力切换到 jQuery 1.7 的新功能和改进[`.on()`](http://api.jquery.com/on/)功能，而不是依赖 .live()。

这就是我的意思，当您有多个绑定时， .live() 非常棒，让您可以在一个简单的函数中完成所有操作。例如：

```
$('.my_thing').live({
   mouseover: function(e) {
     console.log('hey imma moused over');   
   },
   mouseout: function(e) {
     console.log('hey imma moused out');   
   }
 }); 
```

很简单！您将如何使用 .on() 来执行此操作？这是我能得到的尽可能近的地方，但仍然感觉很乱。

```
$(document).on('mouseover','.my_thing', function(e) {
     console.log('hey imma moused over');   
  }).on('mouseout','.my_thing', function(e) {
     console.log('hey imma moused out');   
 }); 
```

感觉很乱，不是吗？一定会有更好的办法。

**PS** -如果你想在谷歌上了解更多，这一定是最糟糕的功能之一*。*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-10T23:59:11.883

```
$(document).on({
   mouseover: function(e) {
     console.log('hey imma moused over');   
   },
   mouseout: function(e) {
     console.log('hey imma moused out');   
   }
 }, '.my_thing' ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T23:59:02.290

除了选择器之外，只需使用事件映射：

```
$(document).on({
    mouseover: function(e) {
        console.log('hey imma moused over');   
    },
    mouseout: function(e) {
        console.log('hey imma moused out');   
    }
}, '.my_thing'); 
```

[这是一个演示。](http://jsfiddle.net/minitech/zJtWR/)

# python - 在 Python 中搜索二叉搜索树的两边

> ID：10098112
> 
> 赞同：1
> 
> 时间：2012-04-10T23:56:25.807
> 
> 标签：python, binary-search-tree

我在 python 中有一个 BST，每个节点包含 3 条数据。这些数据是 ID、Mark 和 Name。

我正在尝试做的是搜索名称，但节点基于 ID，这就是我搜索的方式。该函数应该输出特定名称的 ID。

```
def findName(tree,name):
    if tree==None:
        return None
    elif tree['name']==name:
        return tree['id']
    if tree['left']!=None:
        return findName(tree['left'],name)
    if tree['right']!=None:
        return findName(tree['right'],name) 
```

不幸的是，我只会搜索树的左侧，而不是右侧，如果我先搜索右侧，则相反。

我如何搜索双方？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T00:00:36.267

`return`如果你还没有完成，你不应该这样做！相反，您可以用一个短路替换最后 4 行`or`：

```
return findName(tree['left'], name) or findName(tree['right'], name) 
```

但是，请确保您的 ID 不包含`0`，否则此方法将失败，因为`0`它是一个虚假值，就像 None 一样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T23:59:28.033

```
...
result = findName(tree['left'],name)
if result is None:
    result = findName(tree['right'],name) 
return result 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T00:00:52.027

问题是你正在返回

```
if tree['left']!=None:
    return findName(tree['left'],name) 
```

你需要做的是创建一个局部变量并将其设置为`findName()`从那时起的值，如果你得到 None 继续正确，否则返回值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T00:10:28.220

如果您希望避免额外的递归调用，您可以像这样遍历分支。请注意，最好测试身份`None`而不是相等

```
for branch in ('left', 'right'):
    if tree[branch] is not None:
        result = findName(tree[branch], name)
        if result is not None:
            return result 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-11T00:48:44.410

试试这个：

```
def search(node, name):
    self_result = [node['id']] if node['name'] == name else []
    if not node['left'] and not node['right']:
        return self_result
    elif node['left'] and not node['right']:
        return self_result + search(node['left'], name)
    elif not node['left'] and node['right']:
        return self_result + search(node['right'], name)
    else:
        return self_result + search(node['left'], name) + search(node['right'], name)

test_tree = {'id':0, 'name': 'a', 
             'left': {'id':1, 'name': 'a', 
                      'left':{'id':3, 'name':'c', 
                              'left':{'id':4,'name': 'd', 
                                  'left' : None,
                                  'right' : None},
                          'right':None},
                  'right':{'id':4, 'name':'e',
                           'left': None,
                           'right': None}
                  }, 
             'right': {'id':5, 'name':'c',
                       'left': {'id':6, 'name':'e',
                                'left': None,
                                'right': None},
                       'right': {'id': 7, 'name': 'a',
                                 'left' : {'id' : 8, 'name': 'b',
                                           'left': None,
                                           'right' : None},
                                 'right' : None
                                }
                      }
            }

if __name__ == '__main__':
    assert search(test_tree, 'a') == [0, 1, 7]
    assert search(test_tree, 'b') == [8]
    assert search(test_tree, 'c') == [3, 5]
    assert search(test_tree, 'e') == [4, 6]
    print 'ok' 
```

它还可以处理多个匹配项。

# c# - 用于部署的 Web 服务中的相对路径

> ID：10098113
> 
> 赞同：0
> 
> 时间：2012-04-10T23:56:40.470
> 
> 标签：c#, wcf, web-services, publishing

我托管在 IIS 上的 Web 服务在与已发布 bin 文件夹（在 localhost 上）相同的目录中找不到文件。它似乎正在其他地方寻找该文件。我怎样才能让它使用相对路径找到文件，以便在我部署到任何 Web 服务器时它都能工作。

```
 Server Error in '/' Application.

Could not find file 'C:\Program Files\Common Files\Microsoft Shared\DevServer\10.0\DataStore.xml'. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T00:03:52.070

尝试[HostingEnvironment.ApplicationPhysicalPath](http://msdn.microsoft.com/en-us/library/system.web.hosting.hostingenvironment.applicationphysicalpath.aspx)或 Environment.CurrentDirectory 或 AppDomain.CurrentDomain.BaseDirectory

# http - Chromium 最大并发 HTTP 连接数

> ID：10098116
> 
> 赞同：4
> 
> 时间：2012-04-10T23:56:53.680
> 
> 标签：http, google-chrome, browser, chromium

有人可以指出我默认情况下铬中并发 HTTP 连接的最大数量。如果我需要更改该值，是否有一个启用该值的标志。如果没有，您能否指出铬源中可以实现此目的的位置。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T14:12:45.213

在 http://dev.chromium.org/administrators/policy-templates 查看“MaxConnectionsPerProxy”策略模板。[1][2] 看起来 Chrome 或 Chromium 不会像 Firefox 在 about:config 中那样支持配置最大并发 HTTP 连接数。 [3]

参考：

1.  [http://code.google.com/p/chromium/issues/detail?id=63658](http://code.google.com/p/chromium/issues/detail?id=63658)
2.  [http://dev.chromium.org/administrators/policy-templates](http://dev.chromium.org/administrators/policy-templates)
3.  [http://code.google.com/p/chromium/issues/detail?id=87381](http://code.google.com/p/chromium/issues/detail?id=87381)

# ruby-on-rails - Rails 3 验证 - 与数据库值的比较

> ID：10098124
> 
> 赞同：1
> 
> 时间：2012-04-10T23:58:33.900
> 
> 标签：ruby-on-rails, ruby-on-rails-3, validation

我正在尝试对表单文本框使用 Rails 验证，以查看输入的文本是否与数据库中表的特定列中的任何现有值匹配。Rails 可以做到这一点吗？

基本上，像这样：

用户输入“Foobar”

表列值：'Foobar，test，house，random'

验证未通过，因为 'Foobar' 已在数据库中。

谢谢！dwmcc

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T00:01:26.127

您可以在模型中使用类似`validates_uniqueness_of :name`Rails 3 中的新功能或新功能来执行此操作，您可以内联进行多个验证`validates :name, :presence => true, :uniqueness => true`

[来自 Rails API](http://api.rubyonrails.org/classes/ActiveRecord/Validations/ClassMethods.html)。

# asp.net - Sever.Transfer 从 ASHX 处理程序，HttpContext.Current.Session 为空

> ID：10098125
> 
> 赞同：4
> 
> 时间：2012-04-10T23:58:36.757
> 
> 标签：asp.net

因此，我正在尝试`Server.Transfer`从通用处理程序到常规 ASPX 页面。

它传输正常，但它发现`HttpContext.Current.Session`为空。

有谁知道为什么？

谢谢您的帮助！

-EV

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T00:03:54.993

[您必须使用IRequiresSessionState](http://msdn.microsoft.com/en-us/library/system.web.sessionstate.irequiressessionstate.aspx)标记接口标记处理程序才能初始化 Session。如果您只需要从会话中读取，请使用[IReadOnlySessionState](http://msdn.microsoft.com/en-us/library/system.web.sessionstate.ireadonlysessionstate.aspx)标记接口，因此 Session State Provider 可以在请求结束时跳过保存会话。如果没有 proc 会话状态提供程序，可以提高性能。

这是示例：

```
using System.Web.SessionState;

namespace BlahBlah
{
  public class CustomHandler : IHttpHandler, IRequiresSessionState
...
} 
```

# image-processing - 如何在图像照片上进行肩膀定位？

> ID：10098127
> 
> 赞同：0
> 
> 时间：2012-04-10T23:58:55.507
> 
> 标签：image-processing, computer-vision

我必须从电影中人的肩膀所在的视频进行本地化。对如何做到这一点有什么建议吗？

我考虑过角点检测或某种形状检测。但我仍然不确定接下来会发生什么。我们可以将视频视为图像序列（我写了这个，但我认为很明显）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T04:27:09.657

幸运的是，肩膀通常连接到头部......

我使用了 Dalal-Triggs 算法[（维基百科）](http://en.wikipedia.org/wiki/Histogram_of_oriented_gradients) 来检测所有面对相机的人的头部和肩膀。基本上，您在标记了头部和肩膀的正面示例和不包含这些身体部位的负面示例上训练线性 SVM。描述符是梯度直方图 (HOG)，它告诉您在描述符的每个单元格中哪些边缘方向占主导地位。我发现他们的归一化方案在处理非均匀照明时非常重要。

通过足够多的示例，线性 SVM 将为您提供可以解释为描述符的平面法线：您可以可视化正权重的含义，并看到它们勾勒出头+肩的轮廓。同样，负权重将属于身体外部的区域，和/或与轮廓边缘正交的方向。

您可以在多个尺度和纵横比下对每个图像有效地应用线性 SVM 分类器，并找到具有最佳响应的图像块。这应该会给你头部和肩膀的位置（虽然它不会是准确的）

# javascript - Javascript 将设置保存到一个或多个 cookie？

> ID：10098133
> 
> 赞同：0
> 
> 时间：2012-04-10T23:59:22.840
> 
> 标签：javascript, cookies

在我正在处理的博客上，我使用 cookie 来保存用户偏好，即侧边栏应显示在布局的哪一侧，所以我有一个类似这样的 cookie……

名称：`sidebar_switcher`
值：`right`或`left`

不，我只是构建了一个在用户首次访问时显示的模态/屏幕覆盖 DIV，一旦此模态窗口被隐藏/关闭，我就设置了一个 DIV，这样我就不会在每次访问时都唠叨用户。所以我现在有另一个像这样保存的cookie......

名称：`subscribe`
值：`yes`或`no`

所以我的问题是，因为据我所知，每个 Cookie 都是一个新的 HTTP 请求，我是否应该将这些值存储到 1 个 cookie 中？如果是这种情况，那么我应该将其作为 JSON 字符串执行吗？

谢谢你的建议

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T00:01:34.803

您*可以*将其存储为一个 cookie，也可以将其与 cookie 一起使用`localStorage()`。

这样，使用现代浏览器的用户就不需要解析任何 cookie。

# javascript - processing.js 是实现这个想法的好选择吗？

> ID：10098139
> 
> 赞同：2
> 
> 时间：2012-04-11T00:00:23.097
> 
> 标签：javascript, css, xhtml, processing.js

我一直在为我的个人项目收集关于 CSS/JavaScript/XHTML 的想法。这个想法是复制这个：

![图片](../Images/a7953cc30fd8123292aaf00d588afea6.png)

到目前为止我有这个（我知道它离我需要的很远，但只是在玩）

[http://jsfiddle.net/dburelax/XY8CA/9/](http://jsfiddle.net/dburelax/XY8CA/9/)

我想知道 http://processingjs.org/exhibition/ 是否是我在 javascript 中完成这项工作的最佳选择？谢谢

PS：我不知道如何让角色在瓷砖内移动，欢迎提出任何建议：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T00:37:03.737

我会说光年之外。但不要把它当作讽刺；让我解释。

我在看 gif 时看到的是一个支持块“原语”的引擎。

因为，你看，每次他用指针悬停一块瓷砖时，它都会被白色边框装饰。在您的情况下，您只有两个图像：

*   地图背景

*   角色精灵的 gif 图像（没有他的背部或侧身，但让我们暂时忘记这一点）。

有了这两个，为了实现块突出显示，您应该始终计算偏移量，并在带有边框装饰（以及阴影等）的背景上应用图像过滤器。然后，当移动到盒子外面时，移除最后一个窗口的装饰。

之后如果你改变盒子大小你会怎么做？重新校准所有偏移量？如果你有混合尺寸的盒子/盒子（我现在可以互换地称呼它们）怎么办？

特别是在游戏引擎中，您有诸如盒子之类的基元，您可以在其中检测碰撞并允许或不允许从碰撞盒子通过（角色也是盒子）。想想如果你有“战争迷雾”并且只允许在相邻的盒子里看到这将是多么实用。

这不仅仅是*processing.js*，它可能对您有帮助也可能没有帮助，但首先要考虑键绑定、角色移动、角色方向。

我不了解你，但我无法将所有这些信息编码到 Javascript 对象中并且仍然具有高性能。至少在当前的 Javascript 引擎中没有。

虽然您的爱好项目是一个有趣的想法，但您必须首先学习更多才能实现这一目标。

> 在我冒犯的情况下，接受，但这一切都得到了弥补——[地精](http://www.youtube.com/watch?v=hBKdAl875cc#t=1204s)

如果这是在学习编程的范围内，同时有一个项目可以让你保持动力；然后继续努力（使用我认为很难的路径），首先学习如何在 HTML5 画布上移动图像，以及何时出现实际代码问题。

# iphone - iPhone - 目标 C - PLCameraPreviewView 类

> ID：10098142
> 
> 赞同：0
> 
> 时间：2012-04-11T00:00:35.410
> 
> 标签：iphone, objective-c, camera

我的应用程序使用相机拍照。
当我第二次打开相机时（在我第一次打开并关闭它之后），
应用程序崩溃并显示以下消息：

```
*** -[PLCameraPreviewView isKindOfClass:]: message sent to deallocated instance 0x4193380 
```

什么是 PLCameraPreviewView？
你知道发生了什么吗，我只是使用以下代码打开相机：

```
self.imagePicker = [[[UIImagePickerController alloc] init] autorelease];
imagePicker.delegate = self;
imagePicker.sourceType =  UIImagePickerControllerSourceTypeCamera;
imagePicker.allowsEditing = NO;
[self presentModalViewController:imagePicker animated:YES]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T21:55:20.887

原因是我有一个 UIView 类别，它有一个方法：

+(UIView*) **firstResponder** ;

当我将此方法的名称更改为

+(UIView*) **theFirstResponder** ;

问题消失了。

我想我们不应该将我们类别中的方法命名为类似于该类的内置方法名称。

# c - y86 装配标签没有做他们应该做的事

> ID：10098147
> 
> 赞同：2
> 
> 时间：2012-04-11T00:00:57.780
> 
> 标签：c, assembly, y86

下面发布的是我为一个简单的 y86 汇编程序编写的代码。给定两个整数，它应该打印出两者中较大的一个。在每一行的右边，我有一个等效的 C 翻译。

```
# I ask about the need for a first line comment below.
rdint   %eax          # scanf("%d", &a);
rdint   %ebx          # scanf("%d", &b);
rrmovl  %eax, %ecx    # c = a;
subl    %ebx, %ecx    # c = a - b;
jge     ALarger       # if (c >= 0) { goto ALarger };
wrint   %ebx          # printf("%d", b);
jmp     End           # goto End;

ALarger:
wrint   %eax          # printf("%d", a);

End:
irmovl  $10, %ecx     # c = 10;
halt
wrch    %ecx 
```

使用汇编程序**yas**，生成的 .yo 文件如下所示：

```
0x000: f118         | # I ask about the need for a first line comment below.
0x002: f208         | rdint   %eax          # scanf("%d", &a);
0x004: f238         | rdint   %ebx          # scanf("%d", &b);
0x006: 2001         | rrmovl  %eax, %ecx    # c = a;
0x008: 6131         | subl    %ebx, %ecx    # c = a - b;
0x00a: 7514000000   | jge     ALarger       # if (c >= 0) { goto ALarger };
0x00f: f338         | wrint   %ebx          # printf("%d", b);
0x011: 7016000000   | jmp     End           # goto End;
                    |
0x016:              | ALarger:
0x016: f308         | wrint   %eax          # printf("%d", a);
                    |
0x018:              | End:
0x018: 30810a000000 | irmovl  $10, %ecx     # c = 10;
0x01e: 10           | halt 
```

*   这还没有组装好。有人告诉我，无论在哪里遇到标签，它都会被程序中找到它的地址替换。如果输入的第一个数字较大，则 0x00a 行的**指令**为**7514000000**。这是告诉程序计数器在应该告诉它转到**0x016时转到第****0x014**行（甚至不存在的行） 。**第0x011**行也存在同样的问题。为什么会这样？
*******   当我使用地址行而不是标签来组装程序时，会打印结果，但不会打印换行符。我怎样才能解决这个问题？*   最后，一个小问题：如果我没有将注释作为第一行，则第一行代码将被忽略。这应该发生吗？******

 ******感谢您的宝贵时间，我期待您提供任何答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T21:56:07.760

YAS 需要在最后一行之后换行以构建正确的 yo 代码。有关详细信息，请参阅[http://y86tutoring.wordpress.com/2012/11/06/yas-no-halt-for-the-wicked/](http://y86tutoring.wordpress.com/2012/11/06/yas-no-halt-for-the-wicked/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T01:44:03.727

您将停止语句放在 wrch 之前，因此在写入换行符之前执行停止，看起来 yas 完全忽略了它。这可能会解释您的其他问题，例如将跳转移动一个字节；程序中的行数可能大于实际汇编的行数，这可能会使汇编程序在进行地址跳转时感到困惑。******

# php - 根据表单响应发送到特定 URL

> ID：10098148
> 
> 赞同：2
> 
> 时间：2012-04-11T00:01:00.203
> 
> 标签：php, javascript, forms

我对编码完全陌生——我可以做一些基本的 HTML。我正在尝试为我的一个朋友创建一个交互式故事，在那里我要创建一个表单，该表单根据表单中的关键字重定向到不同的页面。

IE。“天空是什么颜色的？” 带有提交表单框。

如果他们输入“蓝色”，则将其发送到页面 A。如果他们输入“绿色”或“黄色”，则将其发送到页面 B。如果输入“黑色”，则将其发送到页面 C。

我不认为这太复杂 - 我只是找不到任何地方解释如何做这样的事情。

我知道我需要做一个 HTML 表单并使用 PHP 或 Javascript 来做到这一点。我唯一的限制是我想确保它可以在移动设备上运行。

有什么建议，或者你知道我可以去哪里研究如何根据表单答案将用户发送到特定页面的任何网站吗？

非常感谢！

-拉赫。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T00:03:20.700

在 PHP 中，您可以使用函数通过发送带有所需 URL 的 http-response 标头作为其值[`header()`](http://php.net/manual/en/function.header.php)来进行服务器端重定向：`Location`

```
header('Location: http://example.com/'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T00:06:14.553

在处理表单的页面上，检查`$_POST`变量，然后根据该变量进行重定向。

```
if ($_POST['answer'] == "blue") {
   header('Location: http://blue.com/');
} else if ($_POST['answer'] == "yellow") {
   header('Location: http://yellow.com/');
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T00:12:26.837

不使用像 php 这样的服务器端语言，你可以使用 jquery

```
<input id="input1" type="text"  />
<button id="p" type="button">Click Me!</button> 

<script type="text/javascript">
$(document).ready(function(){
  $("#p").click(function(){
    if($("input1").val()=="blue")
    {
       window.location = "pagea.html";
     }
   if($("input1").val()=="green")
    {
       window.location = "pageb.html";
     }

  });
});
</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T00:12:48.740

这是一个使用 javascript 的示例：http: [//jsfiddle.net/YeEuy/](http://jsfiddle.net/YeEuy/)

没有提交按钮，每次击键后都会检查事件。

# c++ - 程序加载/执行

> ID：10098152
> 
> 赞同：4
> 
> 时间：2012-04-11T00:01:36.690
> 
> 标签：c++, linux, gcc, llvm, elf

我是编译器的初学者，但我对了解程序的结构（二进制）以及如何读取和加载到内存中执行非常感兴趣。你们建议我阅读哪些电子书/书籍/教程以便快速入门？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T00:14:40.167

## ELF 文件布局

> **一个 ELF 文件有两个视图：**
> 
> *   *程序头*显示运行时使用的段
> *   *节头*列出了二进制文件的节集
> 
> 每个 ELF 文件由一个 ELF 头组成，后面是文件数据。
> 
> **文件数据可以包括：**
> 
> *   *程序头表*，描述零个或多个段
> *   *节头表*，描述零个或多个节
> *   *程序头表或节头表中的条目所引用的*数据**
> 
>  **段包含文件运行时执行所需的信息，而节包含用于链接和重定位的重要数据。整个文件中的任何字节最多只能由一个节拥有，并且可以有不属于任何节的孤儿字节。**

 *![在此处输入图像描述](../Images/a4fa8b2b71646eb8d60a7f1b5b443d5e.png)

## 将程序加载到内存

> 在计算中，加载程序是操作系统中负责加载程序的部分。
> 
> 它是启动程序过程中的重要阶段之一，因为它将程序放入内存并为执行做好准备。
> 
> ***加载程序涉及：***
> 
> *   将包含程序文本的可执行文件的内容读入内存
> *   执行其他所需的准备任务以准备可执行文件以运行。
> 
> 加载完成后，操作系统通过将控制权传递给加载的程序代码来启动程序。

## *NIX 方式

> 在 Unix 中，加载程序是系统调用的处理程序`execve()`。
> 
> ***Unix 加载器的任务包括：***
> 
> *   *验证*（权限、内存要求等）
> *   *将程序映像从磁盘*复制到主**存储器**
> **   **在堆栈上**复制*命令行参数****   *初始化寄存器*（例如，堆栈指针）*   *跳转到程序入口点 ( `_start`)****

 *** * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-11T08:13:03.513

编译器和可执行二进制文件是远程相关的。（实际的可执行文件是由链接器构建的`ld`，而不是编译器）。

在 Linux 系统上，[Linux 内核](http://en.wikipedia.org/wiki/Linux_kernel)使用[写时复制](http://en.wikipedia.org/wiki/Copy-on-write)和[按需分页](http://en.wikipedia.org/wiki/Demand_paging)技术来延迟加载程序页面，用于[ELF](http://en.wikipedia.org/wiki/Executable_and_Linkable_Format)可执行文件。共享库可以[动态加载](http://en.wikipedia.org/wiki/Dynamic_loading)，最好包含与[位置无关的代码](http://en.wikipedia.org/wiki/Position-independent_code)。

您可能有兴趣阅读有关[编译器构造](http://en.wikipedia.org/wiki/Book%3aCompiler_construction)、Levine 关于[链接器和加载器](http://www.iecc.com/linker/)的书、[Linux 汇编方法](http://tldp.org/HOWTO/Assembly-HOWTO/)、[程序库方法](http://tldp.org/HOWTO/Program-Library-HOWTO/)、[ldd(1)](http://www.kernel.org/doc/man-pages/online/pages/man1/ldd.1.html)、[execve(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/execve.2.html)、[intro(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/intro.2.html)、[fork(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/fork.2.html)、[mmap( 2)](http://www.kernel.org/doc/man-pages/online/pages/man2/mmap.2.html)、[dlopen(3)](http://www.kernel.org/doc/man-pages/online/pages/man3/dlopen.3.html)、[elf(5)](http://www.kernel.org/doc/man-pages/online/pages/man5/elf.5.html)、[proc(5)](http://www.kernel.org/doc/man-pages/online/pages/man5/elf.5.html)、[signal(7)](http://www.kernel.org/doc/man-pages/online/pages/man7/signal.7.html)手册页。

还要尝试了解`cat /proc/self/maps`向您展示的内容（执行该操作的进程的内存映射`cat`）。你也可以玩`objdump`。***

# c++ - 如何从被调用者的角度检测内存是动态的还是静态的？

> ID：10098153
> 
> 赞同：4
> 
> 时间：2012-04-11T00:01:37.157
> 
> 标签：c++, c, realloc, static-memory-allocation

注意：当我在这里说“静态字符串”时，我指的是 realloc 无法处理的内存。

嗨，我编写了一个带有 char * 参数的过程，如果内存不能通过 realloc 重新定位/调整大小，我想创建一个副本。照原样，该过程是一个“重”字符串处理器，因此无知并复制字符串是否是静态的肯定会在将来导致一些内存开销/处理问题。

我尝试使用异常处理程序来修改静态字符串，应用程序只是退出而没有任何通知。我退后一步，看着 C 说：“我没印象。” 如果我听说过一个，那将是一个例外。

我尝试使用异常处理程序在静态变量上调用 realloc ... Glib 报告它无法找到结构的一些私有信息（我确定）我不知道并且显然在程序上调用 abort意味着它不是可以用 longjmp/setjmp 或 C++ try, catch finally 捕获的异常。

我很确定必须有一种方法可以合理地做到这一点。例如，动态内存很可能不在静态内存附近的任何地方，所以如果有办法从地址泄露这些信息......我们可能只是有宾果游戏......

我不确定 C/C++ 预处理器中是否有任何宏可以识别宏参数的来源和类型，但如果没有，那就太愚蠢了。宏汇编器对这类事情非常聪明。从缺乏强大的错误处理来看，如果没有，我不会感到惊讶。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T00:09:21.443

C 没有提供一种可移植的方式来区分静态分配的内存块和动态分配的内存块。`struct`您可以使用字符串指针和指示对象占用的内存类型的标志来构建自己的。在 C++ 中，您可以使它成为一个具有两个不同构造函数的类，每个内存类型一个，以使您的生活更轻松。

就中止程序而言，尝试释放或重新分配尚未动态分配的内存是未定义的行为，因此中止是一个公平的游戏。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-11T00:08:26.603

您可能能够检测内存范围并进行一些指针比较。我在一些垃圾收集代码中完成了这项工作，我需要知道指针是在堆栈、堆还是其他地方。

如果您控制所有分配，您可以简单地根据从或出来`malloc`的每个动态指针保持最小和最大界限。小于 min 或大于 max 的指针可能不在堆中，并且这个和分隔的区域不太可能与任何静态区域相交。如果您知道一个指针是静态的或者它来自 malloc，并且该指针位于 malloced 存储的“边界框”之外，那么它必须是静态的。`calloc``realloc``min``max`

有一些“博物馆”机器，这类东西不起作用，C 标准没有给出使用关系运算符比较指向不同对象的指针的含义，除了完全相等或不相等。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-11T00:07:54.350

您将获得的任何解决方案都是特定于平台的，因此您可能希望指定您正在运行的平台。

至于为什么`abort`在传递意外参数时应该调用库，这往往比继续执行更安全。当然，这更烦人，但此时库知道调用它的代码处于无法恢复的状态。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-11T00:23:09.913

> 我编写了一个带有 char * 参数的过程，如果内存不能通过 realloc 重新定位/调整大小，我想创建一个副本。

从根本上说，问题在于您想根据您正在操作的范围内不可用的信息进行内存管理。显然，您在创建字符串时知道该字符串是在堆栈上还是在堆上，但该信息是当你在你的函数中时迷失了。试图解决这个问题几乎是不可能的，而且肯定超出了标准。

> 我尝试使用异常处理程序来修改静态字符串，应用程序只是退出而没有任何通知。我退后一步，看着 C 说：“我没印象。” 如果我听说过一个，那将是一个例外。

如前所述，C 没有例外。C++**可以**做到这一点，但 C++ 标准委员会认为，让 C 函数在 C++ 中表现不同将是一场噩梦。

> 我很确定必须有一种方法可以合理地做到这一点。

您可以让您的应用程序使用您创建的堆栈替换默认堆栈（因此，知道其中的地址范围）[`ucontext.h`](http://pubs.opengroup.org/onlinepubs/7908799/xsh/ucontext.h.html)或[Windows Fibers](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682661%28v=vs.85%29.aspx)，并检查地址是否在该范围内。但是，（1）这会给使用你的库的任何应用程序带来巨大的负担（当然，如果你使用你的库编写了唯一的应用程序，那么你可能愿意接受这个负担）；`realloc`并且 (2) 没有检测到由于其他原因（使用`static`分配、使用自定义分配器分配、在 Windows 上使用`SysAlloc`or分配、在 C++ 中使用等分配）而无法使用的内存。`HeapAlloc``new`

相反，我建议让您的函数采用一个函数指针，该指针将指向一个用于重新分配内存的函数。如果函数指针是`NULL`，则复制内存。否则，您调用该函数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-11T01:40:53.197

原始海报在这里。我没有提到我有一个可行的解决方案来解决这个问题，它并不像我希望的那样强大。请不要难过，我感谢参与此征求意见和回答的每个人。“程序”本质`in question`上是`variadic`不超过 63 个匿名`char *`参数。

它是什么：一个多字符串连接器。它可以处理许多参数，但我建议开发人员不要传递超过 20 个左右的参数。开发人员从不直接调用该过程。相反，一个称为“过程名称”的宏将参数和一个尾随的空指针一起传递，所以我知道什么时候我已经遇到了统计数据收集的结束。

如果函数只接收两个参数，我创建第一个参数的副本并返回该指针。这是字符串文字大小写。但实际上它所做的只是掩盖`strdup`

如果单个有效参数测试失败，我们继续使用来自包含每个指针`realloc`和`memcpy`它的 64 条记录的静态数据库中的记录信息`strlen`，每次将 memcopy 的大小添加到`memcpy` `destination`作为返回副本开始的辅助指针 ()来自 realloc 的值。

我编写了第二个带有“d”附件的宏，表示第一个参数不是动态的，因此需要一个动态参数，并且该宏使用以下代码将动态参数注入到实际的过程调用中第一个论点：

`strdup("")`

它是一个可以重新分配的有效内存块。它`strlen`返回 0，因此当循环将它的大小添加到记录中时，它不会产生任何影响。空终止符将被覆盖`memcpy`。我应该说它工作得非常好。但是，仅在过去几周内才刚接触 C，我不明白您不能“傻瓜证明”这些东西。我想人们会按照指示或在 DLL 地狱中结束。

该代码在没有所有这些额外的恶作剧和口哨声的情况下工作得很好，但是没有办法回报单个内存块，由于所有动态指针 mgmt，该过程在循环处理中丢失。涉及。因此，第一个参数必须始终是动态的。我读到有人建议在函数中使用保存指针的 c-static 变量，但是您不能使用该过程在其他函数中执行其他操作，例如在决定编译的递归下降解析器中需要随着它的进行。

如果您想查看代码，请询问！

快乐编码！

* * *

**mkstr.cpp**

```
#include <stdarg.h>
#include <stdlib.h>
#include <string.h>

struct mkstr_record {
    size_t size;
    void *location;
};

// use the mkstr macro (in mkstr.h) to call this procedure.
// The first argument to mkstr MUST BE dynamically allocated. i.e.: by malloc(),
// or strdup(), unless that argument is the sole argument to mkstr. Calling mkstr()
// with a single argument is functionally equivalent to calling strdup() on the same
// address.
char *mkstr_(char *source, ...) {

    va_list args;

    size_t length = 0, item = 0;

    mkstr_record list[64]; /*

    maximum of 64 input vectors. this goes beyond reason!

    the result of this procedure is a string that CAN be
    concatenated by THIS procedure, or further more reallocated!

    We could probably count the arguments and initialize properly,
    but this function shouldn't be used to concatenate more than 20
    vectors per call. Unless you are just "asking for it".

    In any case, develop a workaround. Thank yourself later.

    */// Argument Range Will Not Be Validated. Caller Beware!!!

    va_start(args, source);

    char *thisArg = source;

        while (thisArg) {

            // don't validate list bounds here.
            // an if statement here is too costly for
            // for the meager benefit it can provide.

            length += list[item].size = strlen(thisArg);
            list[item].location = thisArg;
            thisArg = va_arg(args, char *);
            item++;

        }

    va_end(args);

    if (item == 1) return strdup(source);   // single argument: fail-safe

    length++;   // final zero terminator index.

    char *str = (char *) realloc(source, length);

    if (!str) return str;   // don't care. memory error. check your work.

    thisArg = (str + list[0].size);

    size_t count = item;

    for (item = 1; item < count; item++) {
        memcpy(thisArg, list[item].location, list[item].size);
        thisArg += list[item].size;
    }

    *(thisArg) = '\0';  // terminate the string.

    return str;

} 
```

* * *

**mkstr.h**

```
#ifndef MKSTR_H_
#define MKSTR_H_

extern char *mkstr_(char *string, ...);

// This macro ensures that the final argument to "mkstr" is null.
// arguments: const char *, ...
// limitation: 63 variable arguments max.
// stipulation: caller must free returned pointer.

#define mkstr(str, args...) mkstr_(str, ##args, NULL)
#define mkstrd(str, args...) mkstr_(strdup(str), ##args, NULL)

/* calling mkstr with more than 64 arguments should produce a segmentation fault
 * this is not a bug. it is intentional operation. The price of saving an in loop
 * error check comes at the cost of writing code that looks good and works great.
 *
 * If you need a babysitter, find a new function [period]
*/

#endif /* MKSTR_H_ */ 
```

不要在演职员表中提及我。她很好，花花公子。

# android - 无法使用 aSmack 库检索联系人状态以连接 google talk 服务

> ID：10098156
> 
> 赞同：0
> 
> 时间：2012-04-11T00:02:07.583
> 
> 标签：android, xmpp, contacts, user-presence

我正在尝试实现一个连接到谷歌谈话服务的安卓聊天客户端。我已经完成了大部分工作，连接到服务器，获取联系人（并将它们显示在 ListView 中），并在单击发送和接收消息的列表上的联系人姓名时打开一个新活动。我的问题是，现在我正在尝试获取用户帐户联系人的存在。我已经编写了这段代码，但它不起作用，我无法找出原因。任何帮助表示赞赏。

```
Button connect = (Button) findViewById(R.id.connect);
    connect.setOnClickListener(new View.OnClickListener() {
        public void onClick(View view) {

            String username = getTheText(R.id.UserName);
            String password = getTheText(R.id.Password);

            login(username, password);
            try {
        Thread.sleep(5000);
    } catch (InterruptedException e1) {
        e1.printStackTrace();
      }
            roster = connection.getRoster();

            entries = roster.getEntries();
            arrayOfEntries = new ArrayList<RosterEntry>(entries);
            searchedContacts = GetSearchContacts();\\This method is the one who is not working correctly

            try{

                launchNextActivity();

            }catch(Exception e){
                e.printStackTrace();

             }

        }

     });
    /*
 * Asigna los datos del ArrayList de RosterEntry al ArraList de SearchContacts
 */

private ArrayList<SearchContacts> GetSearchContacts(){
    ArrayList<SearchContacts> results = new ArrayList<SearchContacts>();
      \\The class SearchContacts is an own class very simple with a constructor which assigns 4 parameters to the objects of the class, and getters and setters for every parameter.
    for (RosterEntry r : arrayOfEntries){
        SearchContacts sc = new SearchContacts(null, null,null,null);
        sc.setNick(r.getName());
        sc.setEmail(r.getUser());
        roster.setSubscriptionMode(Roster.SubscriptionMode.accept_all);
        prs = roster.getPresence(r.getUser());
        Presence.Mode presence2 = prs.getMode();
        status = ConvierteEnumToString(presence2);
        sc.setFirstSentence(status);
        results.add(sc);

    }
    return results;

}

\*
     *
     *\ 
private void ConvierteEnumToString(Presence.Mode pm){

    switch(pm){
    case available:
        Log.i(LOGTAG,"Case Available");
        status= "Available";
        break;
    case away:
        Log.i(LOGTAG,"Case away");
        status= "Away";
        break;
    case chat:
        Log.i(LOGTAG,"Case chat");
        status= "chat";
        break;
    case dnd:
        Log.i(LOGTAG,"Case dnd");
        status= "Do not disturb";
        break;
    case xa:
        Log.i(LOGTAG,"Case xa");
        status= "Unavailable";
                    break;
            default:
                    Log.i(LOGTAG,"Invalid status");
                    status="Invalid";
                    break;

    }

} 
```

如果我更改此行的属性： String status = ConvierteEnumToString(presence2); 我直接输入 Presence.Mode.available，它将状态分配给我所有的联系人，但它工作正常。如果我让它在上面的代码中，我会得到一个这样的异常：

```
04-10 23:11:02.866: W/dalvikvm(1722): threadid=1: thread exiting with uncaught exception (group=0x40015560)
04-10 23:11:02.886: E/AndroidRuntime(1722): FATAL EXCEPTION: main
04-10 23:11:02.886: E/AndroidRuntime(1722): java.lang.NullPointerException
04-10 23:11:02.886: E/AndroidRuntime(1722):     at android.chat.Login.GetSearchContacts(Login.java:164)
04-10 23:11:02.886: E/AndroidRuntime(1722):     at android.chat.Login.access$1(Login.java:153)
04-10 23:11:02.886: E/AndroidRuntime(1722):     at android.chat.Login$1.onClick(Login.java:81)
04-10 23:11:02.886: E/AndroidRuntime(1722):     at android.view.View.performClick(View.java:2485)
04-10 23:11:02.886: E/AndroidRuntime(1722):     at android.view.View$PerformClick.run(View.java:9080)
04-10 23:11:02.886: E/AndroidRuntime(1722):     at android.os.Handler.handleCallback(Handler.java:587)
04-10 23:11:02.886: E/AndroidRuntime(1722):     at android.os.Handler.dispatchMessage(Handler.java:92)
04-10 23:11:02.886: E/AndroidRuntime(1722):     at android.os.Looper.loop(Looper.java:123)
04-10 23:11:02.886: E/AndroidRuntime(1722):     at android.app.ActivityThread.main(ActivityThread.java:3683)
04-10 23:11:02.886: E/AndroidRuntime(1722):     at java.lang.reflect.Method.invokeNative(Native Method)
04-10 23:11:02.886: E/AndroidRuntime(1722):     at java.lang.reflect.Method.invoke(Method.java:507)
04-10 23:11:02.886: E/AndroidRuntime(1722):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
04-10 23:11:02.886: E/AndroidRuntime(1722):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
04-10 23:11:02.886: E/AndroidRuntime(1722):     at dalvik.system.NativeStart.main(Native Method) 
```

不同的是，我有时会获得一个用户状态，然后发生异常，有时根本没有获得任何状态。非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T16:33:14.923

我发现了这个问题。我在这里添加它可能关注的解决方案。

问题是当这条线被执行时：

Presence.Mode Presence2 = prs.getMode();

Presence2 可以获得的可能值之一是 null。因此，您将一个空变量传递给一个等待 Presence.Mode 存在变量的 try/catch 结构......这就是为什么会出现 NullPointerException 的原因。

我在该行之后添加了一个 if 子句，该子句测试变量存在 2 是否等于 null，如果它发生，它会以某种方式更改它。我想它也可以用 try/catch 结构围绕行完成，并以某种方式处理 NullPointerException。

我希望它至少可以帮助任何人不要浪费时间思考解决方案！

# windows - 分发我的应用程序时要记住哪些细节？

> ID：10098157
> 
> 赞同：0
> 
> 时间：2012-04-11T00:02:19.640
> 
> 标签：windows, vb.net

在 Windows 7 VB.NET Express 上，我开发了一个简单的 Forms 应用程序。我并没有真正使用任何外部插件或任何东西——它只有几个按钮、图片框、GDI 操作来修改一些图像......

现在它已经完成了。我想已经上传了。但是，由于这实际上是我第一次尝试提交一些东西，*在分发我的申请时我应该记住哪些其他细节？*我的意思是......*我的应用程序会在其他机器上按预期工作吗？其他 Windows 版本？*我担心我没有合适的位置在其他机器上测试它，所以我依赖“默认”设置并希望它能够简单地工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T00:08:22.473

除非您使用特定于平台的 API（这在典型的、普通的 .NET 应用程序中很少见），否则它应该可以在支持您的 .NET Framework 版本的所有 Windows 版本上运行。如果最终用户*没有*安装该版本的 .NET Framework，那么他或她将需要手动获取它。如果您还没有使用内置的 ClickOnce 安装程序（构建 > 发布 <项目名称>），可以使这更容易一些。

除此之外，不，不应该有任何问题，因为您说您的应用程序是一个简单的应用程序。（控制台应用程序甚至可以使用 Mono 在 Linux 和 Mac 上运行！）

# c++ - 为什么在检查有效输入时还要使用 istream::ignore？

> ID：10098161
> 
> 赞同：1
> 
> 时间：2012-04-11T00:03:08.690
> 
> 标签：c++, windows, istream

[parashift 上](http://www.parashift.com/c++-faq-lite/input-output.html#faq-15.3)的C++ FAQ使用类似于以下内容的内容：

```
while (cout << "Enter an integer: " && !(cin >> foo))
{
    cin.clear();

    //feel free to replace this with just (80, '\n') for my point
    cin.ignore (numeric_limits<streamsize>::max(), '\n');
} 
```

然而`cin.ignore (...)`，似乎没有必要。为什么我不能直接使用`cin.sync()`？它更短，不需要长度。它也更加通用，因为无论输入缓冲区中是否有任何字符，它都将以相同的方式工作。我已经在与我使用的相同循环中测试过一次，`ignore`并且它的工作方式相同。然而，似乎每个涉及此类输入验证的示例都使用`ignore`而不是`sync`.

`ignore`当有更简单的替代方案时，使用的原因是什么（如果有的话） ？

如果重要：
Windows
GCC
MinGW

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T00:19:12.913

在 ifstream 上，效果`sync()`是实现定义的（根据 C++11，第 27.9.1.5/19 节）——不能保证它会做你想做的事（也不能真正保证它会做什么） ）。在典型情况下，它大约相当于`ignore`if 且仅当流是行缓冲的 - 但如果流是无缓冲的，它可能不会做任何事情，如果流是完全缓冲的，它可能会做坏事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T00:13:00.390

两者都做不同的事情。`sync`丢弃已经预读的字符，无论有多少，或者它们是什么。另一方面，`ignore`丢弃字符直到遇到某个字符，无论这些字符是否已被读取，或者是否有更多字符已经提前读取。例如，假设`cin`有一个 40 字节的缓冲区，但您的行有 80 个字节。然后很可能前 40 个字节已被读取到`cin`的缓冲区。在你解释了这些的开头之后，通过调用你丢弃*你已经读过*`sync`的那 40 个字符的其余部分，但*不是***行中的其他 40 个字符。另一方面，您的输入可能来自通常不进行行缓冲的管道。在这种情况下，您不仅可以丢弃当前行，还可以丢弃已预先读取的下一行的部分内容。OTOH 与`ignore`您始终确信您将始终阅读到下一个`\n`（假设要忽略的最大字符数足以遇到它）。**

# java - 如何在 java 代码中使用 wrap_cotent 创建一个 LinearLayout？

> ID：10098165
> 
> 赞同：0
> 
> 时间：2012-04-11T00:03:46.443
> 
> 标签：java, android, android-layout

什么是 java 在编程上等效于创建以下`XML`文件：

```
<LinearLayout
   android:layout_width="wrap_content"
   android:layout_height="wrap_content">
     <RelativeLayout />
</LinearLayout> 
```

我尝试这样做，但有些`LinearLayout`如何`MATCH_PARENT`

```
// child is the RelativeLayout in the above example:
LinearLayout parent = new LinearLayout(getContext());
LinearLayout.LayoutParams childLayoutParams = new LinearLayout.LayoutParams(
  LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT);
parent.addView(child, -1, childLayoutParams); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T00:27:32.037

试试这个

```
LinearLayout parent = new LinearLayout(getContext());
LayoutParams parentLayoutParams = new LinearLayout.LayoutParams(
        LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT);
parent.setLayoutParams(parentLayoutParams); 
```

然后将其添加到屏幕上

```
outerlayout.addView(parent); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T00:17:15.323

`LayoutParams`您设置的是，`RelativeLayout`而不是`LinearLayout`。我敢打赌，它被用作默认参数`LinearLayout`。`MATCH_PARENT`当您添加`parent`到`Window`或 根`ViewGroup`时，您应该创建一个适当的集合`LayoutParams`并指定`WRAP_CONTENT`.

# web-crawler - 以 Map Reduce 友好格式从 Nutch 中提取提取的网页

> ID：10098169
> 
> 赞同：2
> 
> 时间：2012-04-11T00:04:09.097
> 
> 标签：web-crawler, nutch

在分布式（部署）模式下进行 Nutch 爬网后如下：

```
bin/nutch crawl s3n://..... -depth 10 -topN 50000 -dir /crawl -threads 20 
```

我需要以地图缩减友好格式提取每个获取的 URL 及其内容。通过使用下面的 readseg 命令，可以获取内容，但输出格式不适合映射缩减。

```
bin/nutch readseg -dump /crawl/segments/*  /output  -nogenerate -noparse -noparsedata -noparsetext 
```

理想情况下，输出应采用以下格式：

```
http://abc.com/1     content of http://abc.com/1
http://abc.com/2     content of http://abc.com/2 
```

关于如何实现这一目标的任何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T05:45:14.077

该`bin/nutch readseg`命令以人类可读格式而不是 map reduce 格式生成输出。数据以 map-reduce 格式存储在段中。我不认为您可以直接从 map-reduce 格式的段中提取该信息。

您关心的几个选项：

1.  段本身就是 map-reduce 格式文件。你能重复使用那些吗？
2.  `readseg`通过编写一个小的 map-reduce 代码，可以将命令的输出转换为 map-reduce 形式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T22:41:19.963

答案在于调整 nutch 的源代码。事实证明这很简单。导航到`SegmentReader.java`文件`apache-nutch-1.4-bin/src/java/org/apache/nutch/segment`

类内部`SegmentReader`是一个方法`reduce`，负责生成`bin/nutch readseg`命令生成的人类可读输出。更改`StringBuffer dump`您认为合适的变量 - 这包含由`key`变量表示的给定 url 的整个输出。

确保您运行`ant`以创建一个新的二进制文件，并进一步调用以`bin/nutch readseg`您的自定义格式生成输出。

这些参考在浏览代码时非常有用：
[1] [http://nutch.apache.org/apidocs-1.4/overview-summary.html](http://nutch.apache.org/apidocs-1.4/overview-summary.html)
[2] [http://nutch.apache.org/apidocs-1.3/index -all.html](http://nutch.apache.org/apidocs-1.3/index-all.html)

# python - PyCrypto：使用 RSA 非对称密钥对中文字符进行编码

> ID：10098170
> 
> 赞同：2
> 
> 时间：2012-04-11T00:04:16.523
> 
> 标签：python, encryption, unicode, rsa, pycrypto

我正在尝试使用 PyCrypto 加密/解密一些字符串，但我遇到了汉字问题。

当我尝试加密“ *ni-hao* ”时（*你好*）......

```
pemFile = open("/home/borrajax/keys/myKey.pem", "r")
encryptor = RSA.importKey(pemFile, passphrase="f00")
return encryptor.encrypt("你好", 0)[0] 
```

...我不断收到错误：

```
Module Crypto.PublicKey.pubkey:64 in encrypt         
>>  ciphertext=self._encrypt(plaintext, K)
Module Crypto.PublicKey.RSA:92 in _encrypt         
>>  return (self.key._encrypt(c),)
ValueError: Plaintext too large 
```

我尝试了很多组合，

```
encryptor.encrypt(u"你好"...
encryptor.encrypt(u"你好".encode("utf-8")... 
```

没有任何运气。

我想我总是可以在编码之前尝试使用base64，但我想把它作为“最后的资源”......我希望有一种更“优雅”的方式来做到这一点。

有没有人遇到过同样的问题？任何提示将不胜感激。先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T06:27:40.513

首先，您应该只加密二进制数据，而不是 Unicode 文本。这意味着`str`类型（在 Python 2.x 中）或`bytes`（在 Python 3.x 和最新的 Python 2.x 中）。您必须在加密之前对文本进行编码，并且在解密之后必须对其进行解码。

其次，您要加密的字节串必须小于 RSA 模数（例如，对于 RSA2048，小于 256 个字节）。如果您的数据较长，请考虑使用中间 AES 会话密钥。

第三，如果您使用 PyCrypto 2.5，则没有充分的理由使用`.encrypt/.decrypt`RSA 密钥对象的方法。使用 PKCS#1 方法之一会更好、更安全：[OAEP](https://www.dlitz.net/software/pycrypto/api/current/Crypto.Cipher.PKCS1_OAEP-module.html)或[v1.5](https://www.dlitz.net/software/pycrypto/api/current/Crypto.Cipher.PKCS1_v1_5-module.html)。有了它们，明文必须更短。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T00:40:52.550

我在 yakuake 终端的交互式解释器中使用从 Ubuntu Linux 10.04 上的 python 2.6.5 上的 pip 安装的 PyCrypto v2.5 进行了测试。

我无法重现您看到的错误，尤其是“明文太大”位。我见过的一些错误：

```
encryptor.encrypt(u"你好",0)[0]

TypeError: argument 1 must be long, not unicode 
```

似乎它不喜欢 unicode 对象 - 只想要 str.

这两个都适用于我的设置，并且都产生相同的输出，但是第一个解决方案更正确：

```
encryptor.encrypt(u"你好".encode("utf-8"), 0)[0]
encryptor.encrypt("你好", 0)[0] 
```

您是从交互式解释器还是从文件中尝试此操作？如果是文件，我[是 UTF-8 编码的文件](http://www.python.org/dev/peps/pep-0263/)吗？如果是控制台，它是否有适当的 UTF-8 支持？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-11T00:52:36.087

我检查了 PyCrypto 的相关代码，仅当纯文本（转换为长文本后）大于关键参数之一时才会引发此错误。假设脚本的编码设置正确，可能是因为您的 RSA 密钥无效或太短。我试过这个片段，它没有问题：

```
rsa = RSA.generate(1024)

print(rsa.encrypt("你好", 0)) 
```

# c# - 引用 AudioVideoPlayback 命名空间

> ID：10098171
> 
> 赞同：2
> 
> 时间：2012-04-11T00:04:30.430
> 
> 标签：c#, video, reference, directx

免责声明：我是初学者，它正在显示。

我正在尝试按照[此处](http://social.msdn.microsoft.com/Forums/en-US/winforms/thread/53d1071b-26d9-406a-877c-3b33eedf8a4c/)的说明在 ac# 程序中播放电影。

我已经下载并安装：

*   2010 年 6 月的[DirectX SDK](http://www.microsoft.com/download/en/details.aspx?displaylang=en&id=6812)
*   [DirectX 最终用户运行](http://www.microsoft.com/download/en/details.aspx?id=8109)时（2010 年6 月）

然而，当我尝试在我的 c# 项目中添加一个引用时，我`Microsoft.DirectX.AudioVideoPlayback`找不到它。

这是我正在做的事情： 在菜​​单栏上，我单击*Project | 添加参考*。然后我在 COM 组件中搜索类似于“Microsoft Direct X AudioVideoPlayback”的东西，但我看不到任何远程关闭的东西。

我错过了什么吗？我是否错误地安装了 SDK？

谢谢，

布雷特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T00:57:02.710

您需要浏览它。程序集在[GAC中](http://en.wikipedia.org/wiki/Global_Assembly_Cache)

> %WinDir%\assembly\ GAC\Microsoft.DirectX.AudioVideoPlayback
> 
> 在菜单栏上，我单击项目 | 添加参考 | **浏览**

# android - 取消选中其中一个复选框后，在 ListView 中选择选中的项目？

> ID：10098176
> 
> 赞同：0
> 
> 时间：2012-04-11T00:05:16.700
> 
> 标签：android, android-listview, checkbox

我正在尝试获取在`ListView`. 这里的问题是，当我在取消选中一项后尝试获取该项目时，它会显示所有已选中和未选中的元素。例如，如果我检查选项 A、B 和 C 并获取已检查项目的列表，结果为 3，然后如果我在取消选中选项 B 后尝试，我仍然得到结果为 3。这是我的代码：

```
public class ClikableList extends Activity implements OnItemClickListener{
/** Called when the activity is first created. */
ListView lv;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

     lv = (ListView) findViewById(R.id.listView1); 
    lv.setAdapter(new ArrayAdapter<String>(this,
            android.R.layout.simple_list_item_multiple_choice, GENRES));
    lv.setChoiceMode(ListView.CHOICE_MODE_MULTIPLE);
    lv.setOnItemClickListener(this);

}

private static final String[] GENRES = new String[] {
    "Action", "Adventure", "Animation", "Children", "Comedy", "Documentary", "Drama",
    "Foreign", "History", "Independent", "Romance", "Sci-Fi", "Television", "Thriller"
};

@Override
public void onItemClick(AdapterView<?> arg0, View arg1, int position, long id) {

    //Toast.makeText(getBaseContext(),lv.getItemAtPosition(position) + " Test "+lv.getCheckedItemPositions().size(), Toast.LENGTH_SHORT).show();        
        System.out.println(lv.getItemAtPosition(position)); 
    lv.updateViewLayout(arg1, null);

}} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T04:58:06.240

我不知道您如何获得检查的项目，但您应该使用该方法[`getCheckedItemPositions()`](http://developer.android.com/reference/android/widget/AbsListView.html#getCheckedItemPositions%28%29)来获取用户在以下位置检查的位置`ListView`：

```
@Override
public void onItemClick(AdapterView<?> arg0, View arg1, int position, long id) {
        SparseBooleanArray checkedPosistions = lv.getCheckedItemPositions(); // this will return a mapping of the position in the adapter and a boolean value
        String results = "";
        int count = lv.getAdapter().getCount();
        for (int i = 0; i < count; i++) {
            if (checkedPositions.get(i)) { //if true this is a checked item
                results += i + ",";
            }
        }
        Toast.makeText(this, "The checked items are :" + results,
                Toast.LENGTH_SHORT).show();
        // ...
}} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T01:12:08.690

你确定这工作正常吗？

因为，据我所知，您需要`checkedPositions.valueAt(i)`使用`checkedPositions.get(i)`

# c - 套接字 recv() 不接收数据

> ID：10098178
> 
> 赞同：1
> 
> 时间：2012-04-11T00:05:27.913
> 
> 标签：c, linux, sockets, network-programming

我有一个在 TCP unix 域/本地套接字上侦听的服务器守护程序。在同一台机器上运行的多个客户端连接到它。守护进程还绑定到 UDP Internet 套接字。每当守护程序从本地客户端之一接收到任何数据时，它都会向所有连接的客户端发送相同的数据，但发送客户端除外。如果守护程序在 UDP 互联网套接字上接收数据，它需要将该数据发送到所有本地连接的客户端。当守护程序在本地套接字上接收数据时，数据的发送/接收工作完美。但是，当服务器向客户端发送在 UDP 互联网套接字上接收到的数据时，客户端不会收到任何数据。客户端在退出服务器守护程序并关闭连接后，或者当任何客户端在本地向服务器发送数据时接收该 Internet 数据。互联网数据与本地数据一起被客户端接收。我已将本地和 inet 套接字设置为阻塞使用`fcntl()`. 这是我拥有的守护程序代码（我已经删除了所有不必要的代码）：

```
while(1)
{
  FD_SET(sockfd, &read_fds);
  FD_SET(inet_sock, &read_fds);
  for (i = 0; i < nclients; i++)
  {
    FD_SET(clients[i], &read_fds);
  }

  select(maxfd + 1, &read_fds, &write_fds, &except_fds, NULL);

  /* Check for events on inet sock */
  if (FD_ISSET(inet_sock, &read_fds))
  {
    /* Read from inet sock */
    socklen = sizeof(dest_sin);
    rval = recvfrom(inet_sock, buf, BUFLEN-1, MSG_DONTWAIT,
                    (struct sockaddr *) &dest_sin, &socklen);        
    buf[rval]=0;
    fprintf(stderr, "Received: %d (%d) bytes containing %s", rval, strlen(buf), buf);

    /* Send the message to every other client */
    for(j=0; j < nclients; j++)
    {
      send(clients[j], buf, strlen(buf), MSG_DONTWAIT);
    }
  }

  /* A read event on the local socket is a new connection */
  if (FD_ISSET(sockfd, &read_fds))
  {
    socklen = sizeof(dest_sun);
    /* Accept the new connection */
    rval = accept(sockfd, (struct sockaddr *) &dest_sun, &socklen);

    /* Add client to list of clients */
    clients[nclients++] = rval;
    if (rval > maxfd) maxfd = rval;
    snprintf(s, BUFLEN, "You are client %d [%d]. You are now connected.\n\0",
        nclients, rval);
    send(rval, s, strnlen(s, BUFLEN), MSG_DONTWAIT);
  }

  /* Check for events from each client */
  for (i = 0; i < nclients; i++)
  {
    fprintf(stderr,"Checking client %d [%d] for read indicator.\n",i, clients[i]);

    /* Client read events */
    if (FD_ISSET(clients[i], &read_fds))
    {
      fprintf(stderr, "Client %d [%d] marked for read.\n", i, clients[i]);

      /* Read from client */
      rval=recv(clients[i], buf, BUFLEN-1, MSG_DONTWAIT);

      buf[rval]=0;
      fprintf(stderr, "Received: %d (%d) bytes containing %s", rval, strlen(buf), buf);

      /* Send the message to every other client */
      for(j=0; j < nclients; j++)
      {
        /* Skip the sender */
        if (j == i) continue;
        /* Send the message */
        send(clients[j], s, strlen(s, BUFLEN), MSG_DONTWAIT);
      }
    }
  } 
} 
```

这是我拥有的客户端代码：

```
while(1)
{
  FD_SET(fileno(stdin), &read_fds);
  FD_SET(sockfd, &read_fds);
  select(fileno(stdin) > sockfd ? fileno(stdin)+1 : sockfd+1,
&read_fds, &write_fds, &except_fds, NULL);

  if (FD_ISSET(sockfd, &read_fds))
  {
    /* Read from socket and display to user */
    mlen = recv(sockfd, (void *)buf, BUFLEN-1, MSG_DONTWAIT);
    buf[mlen]=0;
    printf("Received %d bytes: %s", mlen, buf);
  }

  if (FD_ISSET(fileno(stdin), &read_fds))
  {
    fgets(buf, BUFLEN, stdin);
    fprintf(stderr, "Sent %d octets to server.", 
    send(sockfd, (void *)buf, (size_t) strnlen(buf, BUFLEN), 0));
  }
} 
```

目标是让客户端立即接收守护程序发送给他们的数据（守护程序在其 inet 套接字上接收的数据）。

编辑：我认为当守护进程发送数据时，客户端的 select() 返回套接字是可读的，但是 recv() 是阻塞的，这就是我没有在客户端获取数据的原因。对于如何解决这个问题，有任何的建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T00:13:50.267

这是`send()`您的代码中提取并对齐的调用：

```
send(clients[j], buf, strlen(buf),        MSG_DONTWAIT);
send(rval,       s,   strnlen(s, BUFLEN), MSG_DONTWAIT);
send(clients[j], s,   strlen(s, BUFLEN),  MSG_DONTWAIT); 
```

我在这里看到了一些不一致的地方。有时你打电话`strlen()`，有时`strnlen()`，有时`strlen()`有两个参数（我什至不知道那会做什么）。

您看到的问题可能与您没有在套接字上发送任何显示消息边界所在位置的信息有关。通过流套接字，*不*保留消息边界，您应该注意在协议中包含适当的帧信息，以便接收器可以提取单个消息。`recv()`您不能依赖与呼叫中完全相同的字节数`send()`。您将以相同的顺序获得相同的*总*字节数（这是流套接字的点），但消息可能会合并或拆分，您无法控制。

# html - 带框架的空白空间

> ID：10098186
> 
> 赞同：0
> 
> 时间：2012-04-11T00:07:18.687
> 
> 标签：html, css, google-chrome, iframe, frame

因此，我创建了一个包含 3 个框架的页面，顶部、左侧和右侧，其中左侧是主框架，右侧框架是索引。

这是它在歌剧/夜间/甚至 ie 上的外观： ![不伦不类](../Images/b98de3a3b6d3d7fa32c351cd65655100.png) 然而，这就是它在 chrome 上的外观： ![不伦不类](../Images/83d3242d4f1adfef6e59ad03a8a5d57f.png) 在蓝色之后看到白色空间，在绿色下。当你使用黑色时，它看起来更难看。

我希望我能给你 jsfiddle 或其他东西，但它不适用于框架，问题只发生在 chrome 中。html 代码位于[http://pastebin.com/HxG4NUjb](http://pastebin.com/HxG4NUjb)并且不能粘贴在这里，因为 alth。我用了四个空格，这个编辑器似乎认为它只是文本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T00:42:36.907

您将框架封闭`id="ma"`在另一个额外的框架集中。删除额外的框架集，这将摆脱额外的空白。

改变这个...

```
<frameset id="x" rows="50,*" border = "0" frameborder ="0">
<frame id="to" name="to" src="http://examancer.com/mobile/screen.html" style="frameborder:0" scrolling="no" noresize="noresize" />
        <frameset cols="*,200" border="0">
        <frame id="ri" name="ri" src="http://examancer.com/mobile/screen.html" frameborder="0" noresize="noresize" />
                <frameset cols="200,*" style="border:0">
                <frame id="ma" name="ma" src="http://examancer.com/mobile/screen.html" frameborder="0"  noresize="noresize" />  
                </frameset>
        </frameset>
</frameset> 
```

对这个...

```
<frameset id="x" rows="50,*" border = "0" frameborder ="0">
    <frame id="to" name="to" src="http://examancer.com/mobile/screen.html" style="frameborder:0" scrolling="no" noresize="noresize" />
    <frameset cols="*,200" border="0">
        <frame id="ri" name="ri" src="http://examancer.com/mobile/screen.html" frameborder="0" noresize="noresize" />
        <frame id="ma" name="ma" src="http://examancer.com/mobile/screen.html" frameborder="0" noresize="noresize" />  
    </frameset>
</frameset> 
```

# r - 禁用保存历史记录

> ID：10098189
> 
> 赞同：27
> 
> 时间：2012-04-11T00:07:26.467
> 
> 标签：r, session, history

是否可以默认禁用在 R 中保存命令历史记录/会话？我真的很讨厌那些 .RData 和 .RHistory 文件！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2018-12-28T08:11:01.217

如果您使用的是 RStudio，您可以简单地在设置中禁用。

转到工具 -> 全局选项 -> 常规并取消勾选始终保存历史记录。 [![在此处输入图像描述](../Images/4a925b44c0158d9888b65f010aed1184.png)](https://i.stack.imgur.com/vaE07.jpg)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-04-11T00:11:27.760

只需用`--no-save`. 见`R --help`。

将此添加到您的快捷方式中（例如，在 Windows 中，当您右键单击快捷方式并选择属性时，它位于“目标”下）。

![在此处输入图像描述](../Images/8a37814ac614e323e37c36546cecf6f8.png)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-04-11T07:08:00.027

如果您使用的是 R gui，由于 Brian Ripley（[见此处](https://stat.ethz.ch/pipermail/r-help/2001-January/010615.html)），另一种非常好的方法是将以下几行放入您的“R_HOME/etc/Rprofile.site”文件中：

```
q <- function (save = "no", status = 0, runLast = TRUE)
.Internal(quit(save, status, runLast)) 
```

注意一点：当您从命令行调用 R 时，这将不起作用。在这种情况下，只需使用`--no-save`@mdsumner 答案中描述的参数。

要了解有关“Rprofile.site”和“.Rprofile”（可选的每个目录配置文件）的更多信息，请参阅始终有用的[`?Startup`](http://stat.ethz.ch/R-manual/R-devel/library/base/html/Startup.html)帮助文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-11T09:29:25.203

更灵活（Windows），将 R 和 RStudio 添加到您的右键菜单中，以便您可以在任何目录中启动

R-Gui：将以下内容保存在文件 rguihere.reg 中，然后双击

```
Windows Registry Editor Version 5.00

[HKEY_CLASSES_ROOT\Folder\shell\RGui]
@="R Gui here"

[HKEY_CLASSES_ROOT\Folder\shell\RGui\command]
@="cmd.exe /c \"pushd  %L &&start rgui --no-restore --no-save\"" 
```

工作室

```
Windows Registry Editor Version 5.00

[HKEY_CLASSES_ROOT\Folder\shell\RStudio]
@="RStudio here"

[HKEY_CLASSES_ROOT\Folder\shell\RStudio\command]
@="cmd.exe /c \"pushd %L &&start C:\\PROGRA~1\\RStudio\\bin\\rstudio.exe\"" 
```

# java - eclipse中的非反应导入

> ID：10098190
> 
> 赞同：0
> 
> 时间：2012-04-11T00:07:42.847
> 
> 标签：java, import

我正在开发一个 java 项目，我正在使用 Timer 类。所以，我导入了`javax.swing.*`. 但是，当我想创建新的 Timer 对象时，它表现为没有导入的计时器包。但是当我将它导入为 时`javax.swing.Timer`，它会识别并且我可以使用它。它是编译器的错误还是我不知道什么`.*`有效？谢谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T01:14:29.157

我正在输入这个作为答案，因为这将超过评论字符限制。

首先，“它表现为没有导入的计时器包。” - 没有计时器包这样的东西。`javax.swing.Timer`是一个类

在 eclipse 的编辑器中导入 like`import javax.swing.*`应该`javax.swing.Timer`可以用于您的课程。但是，如果 eclipse 强迫你做出声明，`javax.swing.Timer timer = ..`即使你`import javax.swing.*;`在顶部，你很可能已经导入了不同类型的计时器。查看您的导入语句并查找`import java.util.Timer`可能导致此行为的类似内容。此外，前几行中的某些语法错误也可能导致此行为。总而言之，如果您适当地编写问题，您的问题将得到适当的答案。您至少需要提供有关您正在做什么的代码的一瞥，以便完全看不到您屏幕的人会知道我们在说什么。

# python - 找到元组对的所有可能组合，将每个组合合并成新序列

> ID：10098197
> 
> 赞同：1
> 
> 时间：2012-04-11T00:09:05.587
> 
> 标签：python, list, tuples, python-2.7, combinations

我有一条按以下顺序在一条路线（地点序列）上行驶的巴士路线：-

```
Ayr - Newton - Troon - Paisley - Glasgow 
```

IE`route = ['Ayr', 'Newton', 'Troon', 'Paisley', 'Glasgow']`

我需要找到所有可能的方式来拆分旅程（总是从 Ayr 开始，到 Glasgow 结束，所以我有代码（python）可以找到每个对组合并将每个（元组）对附加到列表中。

```
pairs = [('Ayr', 'Newton'),('Ayr', 'Troon'),('Ayr', 'Paisley'),('Ayr', 'Glasgow'),('Newton', 'Troon'),('Newton', 'Paisley'),('Newton', 'Glasgow'),('Troon', 'Paisley'),('Troon', 'Glasgow'),('Paisley', 'Glasgow')] 
```

我想要结束的是一个列表列表或元组列表（或最快的内存效率最高的序列），其中包含所有可能的对组合（从 Ayr 开始并在 Glasgow 结束）。

```
final_splits = [['Ayr', 'Glasgow'], ['Ayr', 'Newton', 'Glasgow'], ['Ayr', 'Newton', 'Troon', 'Glasgow'], ['Ayr', 'Newton', 'Troon', 'Paisley', 'Glasgow'], ['Ayr', 'Troon', 'Glasgow'], ['Ayr', 'Troon', 'Glasgow'], ['Ayr', 'Troon', 'Paisley', 'Glasgow']..........etc] 
```

不是一件容易的事！任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-11T00:17:31.663

假设每个组合都成对出现，则无需计算该中间步骤

```
>>> from itertools import combinations
>>> route = ['Ayr', 'Newton', 'Troon', 'Paisley', 'Glasgow']
>>> [(route[0],)+x+(route[-1],) for i in range(len(route)-1) for x in combinations(route[1:-1],i)]
[('Ayr', 'Glasgow'), ('Ayr', 'Newton', 'Glasgow'), ('Ayr', 'Troon', 'Glasgow'), ('Ayr', 'Paisley', 'Glasgow'), ('Ayr', 'Newton', 'Troon', 'Glasgow'), ('Ayr', 'Newton', 'Paisley', 'Glasgow'), ('Ayr', 'Troon', 'Paisley', 'Glasgow'), ('Ayr', 'Newton', 'Troon', 'Paisley', 'Glasgow')] 
```

# javascript - 如何将函数仅应用于完成 jquery ajax 提交的类？

> ID：10098199
> 
> 赞同：1
> 
> 时间：2012-04-11T00:09:24.453
> 
> 标签：javascript, jquery

这是我目前正在使用的代码：

```
$.ajax({
    success: function(){
        $('.post_container').append('test <br />');
    }
});
<% sleep 1 %> 
```

它类似于我用于单个主微帖子表单的代码，但是有几个使用相同类的评论，因此测试将应用于所有 post_containers 而不是刚刚发布帖子的那个。“测试”文本最终将替换为包含用户发布的实际评论的 div。

通常我会使用“this”，但这在这里不起作用。

**HTML：**

```
<div class="post_content">
    <div class="post_container">
        <div class="userNameFontStyle">
            <%= link_to current_users_username.capitalize, current_users_username %> -
            <div class="post_time">
                <%= time_ago_in_words(m.created_at) %> ago.
            </div>
        </div>  
        <%=  simple_format h(m.content) %>
    </div>
    <% if m.comments.any? %>
    <% comments(m.id).each do |comment| %>
    <div class="comment_container">
        <%= link_to image_tag(default_photo_for_commenter(comment), :class => "commenter_photo"), commenter(comment.user_id).username %>
        <div class="commenter_content">
            <div class="userNameFontStyle">
                <%= link_to commenter(comment.user_id).username.capitalize, commenter(comment.user_id).username %> - <%=  simple_format h(comment.content) %>
            </div>
        </div>
        <div class="comment_post_time">
            <%= time_ago_in_words(comment.created_at) %> ago.
        </div>
    </div>
    <% end %>
    <% end %>
    <% if logged_in? %>
    <%= form_for @comment, :remote => true do |f| %>
    <%= f.hidden_field :user_id, :value => current_user.id %>
    <%= f.hidden_field :micropost_id, :value => m.id %>
    <%= f.text_area :content, :placeholder => 'Post a comment...', :class => "comment_box", :rows => 0, :columns => 0 %>
    <div class="commentButtons">         
        <%= f.submit 'Post it', :class => "commentButton" %>
        <div class="cancelButton">
            Cancel
        </div>
    </div>   
    <% end %>
    <% end %>
    </div>
</div> 
```

我将如何处理？

亲切的问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T01:25:56.690

新的：

```
$(function() {
    $('.post-form').submit(function(){
        var $post_content = $(this).find('.post_content');

        $.ajax({
            url: this.attributes['action'],
            data: $(this).serialize(),
            success: function() {
                $post_content.append('test <br />');
            }
        })
        return false; //this will stop the form from really submitting.
    });
}); 
```

这应该可以满足您的需求。只需在任何地方包含此 javascript。

老的：

```
$('form').submit(function(){
    $.ajax({
        url: this.attributes['action'],
        data: $(this).serialize(),

        //the below line might need to be adapted.
        var post_content = $(this).find('.post_content');

        success: function() {
            $(post_content).append('test <br />');
        }
    }) 
```

这假设页面上只有一个表单。但是，要使代码完全工作，我需要知道如何区分哪个 .post_content 是“提交的”post_content。您如何以编程方式确定这一点？每个 post_content 是否有不同的按钮？还是每个 post_content div 周围有不同的形式？无论哪种方式，您都必须以某种方式将其包含到 js 代码中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T23:03:07.370

这就是我最终不得不这样做的方式。

.new_comment 是我的表单 ID

```
$('.new_comment').on('ajax:success', function(){
    $(this).parent('.post_content').find('.comment_container:last').after("<BR />TEST <BR />");

});

<% sleep 1 %> 
```

现在唯一的问题是为刚刚发布的帖子识别实际的comment_container。

# c# - 我的 linq 选择不起作用，我的 foreach 可以

> ID：10098200
> 
> 赞同：1
> 
> 时间：2012-04-11T00:09:30.647
> 
> 标签：c#, linq

我有以下`Select`不起作用的 LINQ。

```
Data.Select(d => d.Value.IsDirty = true); //-- Not working 
```

我更长的解决方法可以。

```
foreach (var d in Data)
    d.Value.IsDirty = true; 
```

为什么我的第一个代码不起作用？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-11T00:12:29.900

`Select`像,等投影函数`Where`定义*查询*。在评估查询之前，简单的调用`Select`实际上并没有*做*`foreach`任何事情（几乎可以肯定，在某些时候，通过 a ）。

如果您要执行某些操作来强制执行查询（`Count`例如调用 ），您会看到它生效。

然而，这有点滥用。这些函数并非专门用于状态更改操作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-11T00:12:38.800

`Select()`返回 an `IEnumerable<…&gt;`，它*能够*遍历输入并调用有问题的代码，但实际上在您以某种方式枚举它之前不会这样做：

```
Data.Select(d => d.Value.IsDirty = true).ToList(); 
```

或者

```
foreach (var _ in Data.Select(d => d.Value.IsDirty = true))
    ; // Do nothing 
```

但是，鉴于它们会产生副作用（显然是这里的意图），以上两者都是恶业。不要使用它们。您的原件`foreach`是唯一明智的选择。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-04-11T00:56:44.267

即使您通过迭代元素来强制执行，调用`Select`也不会导致您需要的副作用。如果你想要你必须做的副作用`foreach`。

例如：

```
class MyValue
{
    public MyValue(bool flag) { Flag = flag; }

    public bool Flag { get; set; }
}

class MyValueContainer
{
    public MyValueContainer(MyValue val) { MyVal = val; }

    public MyValue MyVal { get; set; }
}

class Program
{
    static void Main(string[] args)
    {
        var someList = new List<MyValueContainer>();
        someList.Add(new MyValueContainer(new MyValue(true)));
        someList.Add(new MyValueContainer(new MyValue(true)));
        someList.Add(new MyValueContainer(new MyValue(false)));
        someList.Add(new MyValueContainer(new MyValue(true)));

        var trueCount = someList.Count(x => x.MyVal.Flag); // 3
        var falseCount = someList.Count(x => !x.MyVal.Flag); // 1

        // try causing side effect by calling Select
        someList.Select(x => x.MyVal.Flag = false);

        // force execution. call Count
        trueCount = someList.Count(x => x.MyVal.Flag); // still 3... no side effect.
        falseCount = someList.Count(x => !x.MyVal.Flag); // still 1... no side effect.

        foreach (var x in someList)
            x.MyVal.Flag = false;

        trueCount = someList.Count(x => x.MyVal.Flag); // 0... side effect seen.
        falseCount = someList.Count(x => !x.MyVal.Flag); // 4...  side effect seen.
    }
} 
```

# asp.net - ASP.NET 常用准备函数及其结果

> ID：10098202
> 
> 赞同：1
> 
> 时间：2012-04-11T00:09:37.950
> 
> 标签：asp.net, function, scope

假设我想在每个 .aspx 页面上运行相同的功能。例如，假设此函数始终生成 UTC DateTime 和用户的 DateTime。如何在一个地方编写代码来计算每次页面加载的这些值，然后使它们的值可用于整个 .aspx 页面？我意识到我可以在每个页面中声明这些变量然后调用该函数，但是没有办法编写一次以避免重复编写相同的代码吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T00:21:38.223

我建议使用母版页。即使您在母版页中看不到任何内容，也可以让其 onload 或 oninit 进行计算，并将其存储为母版页的属性。

```
public Date date{get;set;}
protected void onLoad(){ 
    this.date = ... calculate ....; 
} 
```

然后从子页面您可以访问母版页

```
((YourMasterClassName)this.Master).date 
```

# c# - 在 MonoTouch 和 MonoDroid 中使用 C DLL

> ID：10098204
> 
> 赞同：4
> 
> 时间：2012-04-11T00:10:00.107
> 
> 标签：c#, mono, xamarin.ios, monodevelop, xamarin.android

我是使用 .NET 的新手，但我对使用 MonoTouch/Droid 编写可以共享一些核心代码的移动应用程序很感兴趣。

我有许多想要使用的 C 风格 API 库，例如[libxml2](http://xmlsoft.org/)。如何在 Mono 中调用这些本机库方法？如果我在 Windows 中开发，是否可以使用从 Windows 编译的相同二进制文件？如果我在 OS X 中开发，我可以使用 Windows 二进制文件吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-11T04:05:28.203

> 如何在 Mono 中调用这些本机库方法？

您可以使用[p/invoke](http://msdn.microsoft.com/en-us/library/aa446536.aspx)（平台调用）从任何 .NET 语言调用本机 C 代码。您需要编写这些声明（寻找在您之前做过的人）才能使用本机库。就像@Marcelo 评论的那样，大多数 C 库通常都有非常好、**更**容易使用的 .NET 替代品。

这也适用于 MonoTouch。但是，您需要提供一个静态库（`.a`在 OSX 上，如`.lib`在 Windows 上），因为 Apple iOS 不允许与用户提供的动态库（`.dylib`在 OSX/iOS 和`.dll`Windows 上）链接。

> 如果我在 Windows 中开发，是否可以使用从 Windows 编译的相同二进制文件？

Windows 生成的二进制文件应该可以在 Windows 上与 Mono 一起正常运行。您也可以在 Windows 上使用 Microsoft .NET。

> 如果我在 OS X 中开发，我可以使用 Windows 二进制文件吗？

如果二进制文件是 .NET 编译的代码，那么**可以**——只要您的 p/invoke 声明是可移植的（例如 32 位和 64 位类型）。

如果二进制文件是本机代码，则**没有**. 请记住，Mono 不是 Windows 模拟器。它在 .EXE 或 .DLL 内运行 CIL 代码，但不会运行本机 Windows 代码或提供对 Windows 本机 API（Windows 外部）的访问。

# javascript - 在 JQuery / Javascript 中加载从 JSON 列表返回的 URL 的最佳方法是什么

> ID：10098206
> 
> 赞同：0
> 
> 时间：2012-04-11T00:10:16.117
> 
> 标签：javascript, jquery, html, ajax, json

我正在尝试将一些内容 AJAX 到#BlogContainer div 中，但似乎无法让我的点击功能正常工作。它似乎在 if 语句中分崩离析，但我不知道为什么。我已经用警报进行了测试，并且 JSON 的返回按应有的方式通过。初始加载也可以正常工作，它只是遍历 JSON 返回并将 url 返回到似乎不起作用的加载函数。

我想要实现的效果是使用 .load 和 JSON 文件中指向内容的 URL 将页面内容（博客条目）加载到 #BlogContainer div 中，每次单击 #Nexus div 时迭代到下一个。

我的主要问题是通过 JSON 返回动态加载的最佳方法是什么？我有一个 each 函数，它也做了完全相同的事情（它似乎返回了正确的结果，但实际上并没有加载内容）。我决定改用 for 循环，因为我读到的内容表明它的效率稍高一些，尽管我怀疑它对我的情况会有很大影响。

我对 JS / JQ 完全陌生，以前使用 JQueryTools 可以按照我想要的方式运行一切，但我认为最好的学习方法是自己做（当然需要一点帮助：））。

HTML

```
<div id="BlogContainer"></div>
<div id="NexusRef" alt="03151201.htm">'03151201.htm'</div> 
```

JSON

```
{
    "0": "'03151201.htm'",
    "1": "'01191201.htm'",
    "2": "'00000103.htm'",
    "3": "'00000102.htm'",
    "4": "'00000101.htm'"
}​ 
```

Javascript

```
$(function() {
    $('#Navigation').load('navi.htm');
    $('#BlogContainer').load('03151201.htm');
    $('#TT1').load('ajtt1.htm');
    $('#TT2').load('ajtt2.htm')
});

$(function() {
    $('#Nexus').click(function() {
        $.getJSON("BlogRoll.json", function(data) {
            var i = 0;
            var n = ($('#NexusRef').html());
            var length = data.length;

            for (i = 0; i < length; i++) {
                if (data[i] == n) {
                    $(function() {
                        $('#BlogContainer').load(data[i + 1]);
                    });
                } else {
                    alert(data[i + 1]);
                }
            }
        });
    });
});​ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T00:48:18.897

[这应该这样做](http://jsfiddle.net/eWwF9/)

```
$(function() {
    //assuming you have this JSON to work with:
    var pages = {
        "0": "'03151201.htm'",
        "1": "'01191201.htm'",
        "2": "'00000103.htm'",
        "3": "'00000102.htm'",
        "4": "'00000101.htm'"
    }

    //add a click handler to your button
    $('#Nexus').on('click', function() {

        //prepare a storage url
        var url;

        //pick out first link, copy, and remove it
        //works like Array.shift()
        for (var key in pages) {
            if (pages.hasOwnProperty(key)) {
                url = pages[key];
                delete pages[key]
                break;
            }
        }

        //Do a GET to retrieve contents and append to container
        $.get(url, function(contents) {
            var contents = url;
            $('#BlogContainer').append(contents);
        });
    });
});​ 
```

# php - 从PHP变量传递ID时javascript中未定义的ID

> ID：10098214
> 
> 赞同：1
> 
> 时间：2012-04-11T00:12:12.463
> 
> 标签：php, javascript, forms, undefined

我进行了一些搜索，但没有给出明确的答案。我根本不是一个 javascript 的人，我很无能。但是我理解 PHP，对我来说这应该有效。我还应该注意，这个脚本曾经使用 document.all 因为它是 javascript，我尝试在可能的情况下将其更新为 getElementById()（因为 document.all 在 firebug 中引发错误）。

现在在大多数情况下，页面显示正常，尽管没有应该发生的 javascript 更改。

我还必须为代码的陈旧性质道歉，当我接任我们游戏俱乐部的互联网人时，我继承了这个代码。此代码用于使用虚构积分购买虚构物品。

当我单击一个项目以“购买”它（或者可能不购买）时，该行的背景应该变成绿色，并且应该从我的总帐户中减去积分（或者如果我取消选中该框，则相反）。单击提交按钮将我单击的这些内容添加到另一张表中，并从我的帐户中减去实际金额。

目前我收到“tr615 is undefined”错误这是 PHP 为元素生成的代码，如下所示。

如果有人可以帮助我解决这个问题，那就太好了。在谷歌和这里搜索了几天后，我似乎无法找到答案。

相关代码的PHP片段：（我们在我们的网站上使用自定义函数，即：入口）

例如说 $id=615

```
 <?php
        while (list ($id, $name, $class, $desc, $range, $damage, $cost,$hide) = entry ($items) )
        {
           if ($hide =='0')
           {
            $JavaScriptArrayParms .= '"' . $id . '",';
            $list .= $id . ',';
           ?>
           <tr id="tr<?php echo $id; ?>">  //Thus tr615 for this example
           <td>
             <input type="checkbox" name="chk<?php echo $id; ?>" onclick="updateStoreTable(this.form, this, <?php echo $id; ?>)" />
             <input type="hidden" name="cost<?php echo $id; ?>" value="<?php echo $cost; ?>" />
           </td>
           <td><?php echo $name; ?></td>
           <?php if (! in_array($catid, $noclass)){ echo "<td>$class</td>";}?>
           <td><?php echo $desc; ?></td>
           <?php if (! in_array($catid, $norange)){ echo "<td>$range</td>";}?>
           <td><?php echo $damage; ?></td>
           <td><?php echo $cost; ?></td>
           </tr>
         <?php
        }
        }
        ?>
    </table>

 <input type="hidden" name="list" value="<?php echo $list; ?>" />
 <input type="button" value="Purchase!" onclick='validatePurchase(this)' />
 <input type="reset">
</form> 
```

相关 JS：（在某些情况下，它曾经是 document.all.store... 或只是 document.all..。我希望我以正确的方式修复它）

```
<script language="javascript">
var startmoney = <?php echo $currMoney; ?>;
function canAfford(t,id)
{
    if(t.checked) return;// don't touch if checked for buying.
    //alert("canAfford("+t+","+id+");");
    //t.disabled = false;
    eval("document.store.getElementByID(foo).disabled = false;");
    eval("document.store.getElementByID(foo).checked = false;");
    eval("document.getElementByID(tr"+id+").style.background = '#000000';");
}

function cantAfford(t,id)
{
    //alert("cantAfford("+t.disabled+","+id+")-- "+t+";");
    //alert("before disable");
    //t.disabled = true;
    eval("document.store.getElementByID(chk"+id+").disabled = "+true+";");
    //alert("After disable");
    eval("document.store.getElementByID(chk"+id+").checked = false;");
    eval("document.getElementByID(tr"+id+").style.background = '#555555';");
}

function getCost(id)
{
return eval("document.store.getElementByID(cost"+id+").value");
}

function buying(t,id)
{
eval("document.getElementByID(tr"+id+").style.background = 'green';");
document.store.credits.value -= getCost(id);
}

function notbuying(t,id)
{
eval("document.getElementByID(tr"+id+").style.background = '#000000';");
var creds = new Number(document.store.credits.value);
var cost  = new Number(getCost(id));
document.store.credits.value = (creds + cost);
}

function updateStoreTable(f,t,id) 
{
    var ids = new Array(<?php echo $JavaScriptArrayParms; ?>);
    if(t.checked)
        buying(t,id);
    else
        notbuying(t,id);

for(i = 0; i<ids.length; i++)
    {
        cost = new Number(getCost(ids[i]));
        creds = new Number(f.credits.value);
        //alert("COST: " +(cost)+"\nCREDITS: "+creds+"\nID: "+ids[i]);
    //  alert("'"+ (cost) + "' > '" + (creds) +"'\n"+(eval(cost > creds)));
    //  alert("f.chk"+ids[i]+".checked");
        if(eval("f.chk"+ids[i]+".checked")) { continue; } //ignore already carted items     

        if(eval(cost > creds))
            cantAfford(eval("f.chk"+id),ids[i]);
        else 
            canAfford(eval("f.chk"+id),ids[i]);     
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T00:23:41.337

**第一个问题：**

它必须是`getElementById()`
（最后是小写的**d**）

* * *

**第二：**

使用 eval 时，代码将被评估为：

```
document.getElementById(tr615).style.background = '#000000'; 
```

..什么会导致错误，因为 tr615 没有用引号括起来，所以 javascript 需要一个变量 tr615。

该行必须如下所示：

```
eval("document.getElementById('tr"+id+"').style.background = '#000000';"); 
```

* * *

**但是：**这里为什么要用eval，不用eval也可以做到：

```
document.getElementById('tr'+id).style.background = '#000000'; 
```

# python - 嵌套 try 语句以打开 XL 工作表

> ID：10098222
> 
> 赞同：0
> 
> 时间：2012-04-11T00:13:01.060
> 
> 标签：python, try-catch, xlrd

我正在尝试在 XL 中打开工作表。工作表可以命名为“地图”、“地图”或“地图”

这就是我正在做的

```
import xlrd
book = xlrd.open_workbook(xls) // where xls is the name of the spreadsheet
try:
     sheet = book.sheet_by_name('map')
except:
     try:
        sheet = book.sheet_by_name('Map')
     except:
        try:
          sheet = book.sheet_by_name('MAP')
        except:
           raise 
```

这看起来很笨重......有没有更pythonic的方式来做到这一点

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T00:18:09.877

只需遍历可能性，尝试依次打开每个可能性：

```
sheet = None
for thing in ['map','Map','MAP']:
  try:
    sheet = book.sheet_by_name(thing)
    break
  except:
    pass 
```

运行后，`sheet`将设置为`thing`可以打开的第一个。如果没有一个可以打开，那么`sheet`将是`None`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T23:39:03.413

Excel 工作表名称不区分大小写。Excel 不会让您在单个工作簿中创建多个名称为（地图、地图、地图、地图等）的工作表。

```
candidates = [n for n in book.sheet_names() if n.lower() == 'map']
assert len(candidates) in (0, 1)
if candidates:
     sheet = book.sheet_by_name(candidates[0])
else: 
     whatever() 
```

也许您想提出一个增强请求，要求 Book.sheet_by_name 使用不区分大小写的搜索。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-11T00:48:18.157

虽然它不像其他一些方法那样可读，但可能最短的方法是使用：

```
sheet = book.sheet_by_name(list(set(['map', 'Map', 'MAP']) & set(book.sheet_names())[0]) 
```

基本上，这使用了通过另一个 SO 答案呈现的列表交集的概念。可能是一种更简单的创建方法，因此更易于阅读：

```
possibleNames = ['map', 'Map', 'MAP']
sheetNames = book.sheet_names()
name = intersect(possibleNames, sheetNames)
if len(name) < 1:
    print "Error"
    # break program appropiately
sheet = book.sheet_by_name(name[0])

def intersect(a, b):
    return list(set(a) & set(b)) 
```

# arrays - 我可以使用数组的内容作为哈希的键吗？

> ID：10098223
> 
> 赞同：2
> 
> 时间：2012-04-11T00:13:12.217
> 
> 标签：arrays, perl

我希望我的数组成为我的新哈希的键。我正在编写一个计算文档中单词出现次数的程序。

```
my @array = split(" ", $line);

keys my %word_count = @array; #This does nothing 
```

当我逐行读取 infile 时，会发生此段。我正在尝试找到一种使用哈希来完成这个项目的方法。单词是键，出现的次数是值。但是，这一步尤其让我感到困惑。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T00:30:58.730

使用[散列片](http://perldoc.perl.org/perldata.html#Slices)。

```
my %word_count;
@word_count{split ' ', $line} = ();

# if you like wasting memory:
# my @array = split ' ', $line;
# @word_count{@array} = (0) x @array; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T00:21:14.360

你不能那样做，当然。

```
my %word_count = map {($_, 0)} @array; 
```

将初始化散列的键；但通常在 Perl 中你不想这样做。这里有两个问题是

1.  您需要第二遍才能真正*解释*该行中的单词；
2.  您不能作弊并将其更改`0`为`1`上述内容，因为如果在该行中重复一个单词，您只会计算一次，其他单词将被覆盖。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T00:18:36.817

```
my %word_count = map { $_ => 0 } split(" ", $line); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T03:23:35.777

您正在尝试计算一行中单词的出现次数，对吗？如果是这样，你想要

```
my %word_count;
++$word_count for split(/\s+/, $line); 
```

或者把它放在头上，以便于细化一个词的定义：

```
my %word_count;
++$word_count for $line =~ /(\S+)/g; 
```

# c++ - if ('fstream object') 如何根据文件是否打开返回 true 或 false 值？

> ID：10098230
> 
> 赞同：6
> 
> 时间：2012-04-11T00:14:12.553
> 
> 标签：c++, fstream

我很好奇如何通过简单地将对象的名称放在条件语句中`fstream` `class`来返回 a `true`or值。`false`例如...

```
std::fstream fileStream;
fileStream.open("somefile.ext");

if (!fileStream)  // How does this work?
  std::cout << "File could not be opened...\n"; 
```

我问这个是因为如果我以类似的方式使用它，我希望我自己的类返回一个值。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-11T00:16:27.170

它并不是真的等于真或假，而是它重载了`!`运算符以返回其状态。

有关详细信息，请参阅[http://www.cplusplus.com/reference/iostream/ios/operatornot/](http://www.cplusplus.com/reference/iostream/ios/operatornot/)。

自己做这件事非常简单，请查看[运算符重载常见问题解答](https://stackoverflow.com/questions/4421706/operator-overloading)或[C++ 运算符重载指南](http://courses.cms.caltech.edu/cs11/material/cpp/donnie/cpp-ops.html)。

编辑：有人向我指出，这`ios`也重载了`void *`转换运算符，在失败的情况下返回一个空指针。因此，您也可以使用前面提到的常见问题解答中也涵盖的方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-11T00:22:16.173

这使用转换运算符工作。请注意，看似显而易见的方式转换为具有意想不到的副作用，因此应使用`bool`隐式转换为内置类型的转换，例如：`bool`

```
class X
{
public:
  void some_function(); // this is some member function you have anyway
  operator void(X::*)() const
  {
    if (condition)
      return &X::some_function; // "true"
    else
      return 0; // "false"
  }
}; 
```

在 C++11 中，您可以进行`bool`显式转换，从而避免意外的副作用。因此，在 C++11 中，您可以简单地编写：

```
class X
{
public:
  explicit operator bool() const
  {
    return condition;
  }
}; 
```

# scala - 使用 Akka Actors/Remoting 在集群中分布图算法

> ID：10098231
> 
> 赞同：1
> 
> 时间：2012-04-11T00:14:39.173
> 
> 标签：scala, graph, distributed, actor, akka

因此，我目前正致力于将我的 Scala 代码分布在多台机器上以获取大图（[问题的“第 1 部分”](https://stackoverflow.com/questions/9742938/efficiency-scalability-of-parallel-collections-in-scala-graphs)），并且目前正在使用 Akka 框架，希望能够使用 Actors 和 Remoting。

[我在这里](http://doc.akka.io/docs/akka/2.0/intro/getting-started-first-scala.html)阅读了文档，似乎可以将示例的完成方式扩展到做我想做的事情，但我对这种方法有一些担忧......

1）我们如何决定我们应该创建多少个Actor实例？我们是否必须做一个试错的事情来看看哪个是最好的，还是有一些更直观的方法来解决它？

2）我正在考虑以类似于示例的方式完成我的任务 - 使用一个产生多个工人并使用案例类作为消息进行通信的 Master。我想要做的是在所有顶点对之间找到一些度量（随机游走）。我有一个图形类，它实现了一种计算给定两个顶点的度量的方法。

我会给每个工人两个顶点'u'和'v'来计算度量，并让工人返回值。

当 Master 向 Workers 发送消息以计算度量时，Worker 需要图形结构 - 我是否只需在消息中包含图形结构（即邻接列表，即 HashMap）来做到这一点？这是否会通过每次复制图结构而导致任何开销，或者所有工作人员都只是共享该图，还是有更好的方法来解决这个问题？

3）计算顶点对之间度量的算法是否需要重新实现到扩展的Actor类，或者有没有办法让各个Actor访问相同的图结构来调用方法（我猜这类似于上面关于将整个图形结构作为消息的一部分传递的问题）？

谢谢！问候，-kstruct

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T19:48:54.063

> 1）我们如何决定我们应该创建多少个Actor实例？

尽管 Actor 抽象了底层线程管理，但创建的 Actor 少于可用的 CPU 内核正在浪费计算能力。如果您有 10 台服务器，每台服务器 8 个内核，则创建至少 80 个参与者，每台机器 8 个。

如果算法是 CPU 密集型的，那么创建更多不会给您带来性能提升 - 额外的工作人员只会等待可用的核心。

> [...] Worker 需要图形结构 - 我是否只是通过在消息中包含图形结构（即，作为 HashMap 的邻接列表）来做到这一点？[...]

如果您的所有参与者都位于同一个 JVM 中，则不会产生任何开销——您只需在消息中传递对图形结构的引用。然而，在分布式环境中，这将导致图形被序列化并通过线路发送 - 可能是大量数据。

考虑由所有参与者共享此数据结构。

我不明白问题3。

# ruby-on-rails - 显示所有记录而不是实例记录的嵌套路由

> ID：10098237
> 
> 赞同：4
> 
> 时间：2012-04-11T00:16:11.267
> 
> 标签：ruby-on-rails, ruby-on-rails-3, routes, nested-attributes

这些是相关模型：

```
class Repository < ActiveRecord::Base
   has_many :quizzes, :dependent => :destroy
   has_one :key, :dependent => :destroy

   accepts_nested_attributes_for :key, :quizzes
end

class Quiz < ActiveRecord::Base
   belongs_to :repository
   has_many :topics, :dependent => :destroy

   accepts_nested_attributes_for :topics
end 
```

这是我的路线：

```
GqAPI::Application.routes.draw do
  resources :repositories do
    resources :quizzes
  end

  resources :quizzes

  resources :keys

  resources :topics

  resources :questions
end 
```

当我尝试这个配置时，我得到了数据库中的所有测验，而不仅仅是我在尝试转到 /repositories/1/quizzes 时指定的 ID 的测验

关于为什么的任何想法？非常感谢您的时间

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T00:23:51.167

在您的索引操作中，您`QuizzesController`需要添加：

```
def index
  @repository = Repository.find(params[:repository_id])
  @quizzes = @repository.quizzes
end 
```

该`@repository`行将根据您的 URL 中的参数找到存储库。然后它将根据该存储库找到所有测验。

然后在您的视图中，您可以在显示它们时循环浏览所有这些测验。

**笔记**

您当前设置路线的方式，您可以访问页面，`/quizzes`但听起来您不希望这样做。如果是这种情况，您可以`resources: quizzes`从您的`routes.rb`（仅第二个，而不是嵌套的）中删除。

# c++ - 如何调用作为函数输入参数的基类虚函数

> ID：10098238
> 
> 赞同：0
> 
> 时间：2012-04-11T00:16:15.073
> 
> 标签：c++, inheritance, virtual-functions

使用 C++，我有

```
struct Base {
    virtual void stuff(/*base stuff*/);
};

struct Derived : public Base {
    void stuff(/*derived stuff*/); 
};

void function1(Derived& obj){
   obj.stuff(); 
} 
```

在这种情况下，function1 将使用 Derived 的 do() 函数。如果在 function1 中，我想调用 Base 类的 do() 函数呢？如果我将 function1 称为 as ，它会起作用 `function1(dynamic_cast<Base*>(derived_obj_ptr))`吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-11T00:23:21.847

在更正代码中的大量错误之后，这确实是可以实现的：

```
#include <iostream>

class Base {
public:
    virtual void foo() { std::cout << "Base\n"; }
};

class Derived : public Base {
public:
    void foo() { std::cout << "Derived\n"; }
};

void function1(Derived *p) {
   p->Base::foo();  // <<<<< Here is the magic >>>>>
}

int main() {
    Derived d;
    function1(&d);
} 
```

输出：

```
Base 
```

（见[http://ideone.com/FKFj8](http://ideone.com/FKFj8)）

# android - Android 浏览器未正确处理换行符 (ASCII x0A) 字符

> ID：10098242
> 
> 赞同：4
> 
> 时间：2012-04-11T00:16:47.693
> 
> 标签：android, css, character-encoding, newline, whitespace

Android 的浏览器在源 HTML 中有换行符 (ASCII x0A) 的任何地方都显示“框”字符（如 []）。

浏览器应将换行符视为/呈现空格。此问题不会出现在任何桌面浏览器或 iOS Safari 上。

我们已将罪魁祸首与我们的一个 CSS 文件隔离开来，但无法进一步缩小违规代码的范围。任何帮助是极大的赞赏。我们很困惑。我们已经研究了字符编码问题和字体系列，但更改它们并没有解决问题。

截图：[http](http://haxway.com/mjm.jpeg)
://haxway.com/mjm.jpeg HTML：[http://haxway.com/mjm.html](http://haxway.com/mjm.html)
CSS： http: [//www.marijuana.com/styles/hathwaymobile/styles.css](http://www.marijuana.com/styles/hathwaymobile/styles.css)

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-11T05:32:53.997

问题是`text-rendering: optimizelegibility`在 Android 2.2 和 2.3 上被破坏了。

看到这个错误：[http ://code.google.com/p/android/issues/detail?id=15067](http://code.google.com/p/android/issues/detail?id=15067)

> 这个 HTML：
> 
> ```
> <p style="text-rendering:optimizelegibility">
> Webkit.
> Android.
> Oh no. 
> ```
> 
> 用换行符所在的框呈现。
> 
> 发生在 2.2 和 2.3 中。在 1.6 中不会发生。

说明此错误的 jsfiddle：http: [//jsfiddle.net/therefromhere/huUcE/2/](http://jsfiddle.net/therefromhere/huUcE/2/)

# c# - 生命游戏算法问题

> ID：10098244
> 
> 赞同：0
> 
> 时间：2012-04-11T00:16:56.720
> 
> 标签：c#

我正在用 C# 编写一个生命游戏程序。我正在使用二维结构数组。当我显示 Random 方法时，似乎邻居的算法或某些东西是错误的。当它经过几代人时，随机细胞会在它们不应该“活着”的时候“活着”。有什么帮助吗？

```
public struct cellDetail
{
    public int curGenStatus;
    public int nextGenStatus;
    public int age;

}
public class Class1
{

    static cellDetail[,] Generations(cellDetail[,] cells)
    {

        int neighbours = 0;

        for (int i = 0; i < 40; i++)
            for (int j = 0; j < 60; j++)
                cells[i, j].nextGenStatus = 0;

        for (int row = 0; row < 39; row++)
            for (int col = 0; col < 59; col++)
            {
                neighbours = 0;

                if (row > 0 && col > 0)
                {
                    if (cells[row - 1, col - 1].curGenStatus > 0)
                        neighbours++;
                    if (cells[row - 1, col].curGenStatus > 0)
                        neighbours++;
                    if (cells[row - 1, col + 1].curGenStatus > 0)
                        neighbours++;

                    if (cells[row, col - 1].curGenStatus > 0)
                        neighbours++;
                    if (cells[row, col + 1].curGenStatus > 0)
                        neighbours++;

                    if (cells[row + 1, col - 1].curGenStatus > 0)
                        neighbours++;
                }

                if (cells[row + 1, col].curGenStatus > 0)
                    neighbours++;
                if (cells[row + 1, col + 1].curGenStatus > 0)
                    neighbours++;

                if (neighbours < 2)
                    cells[row, col].nextGenStatus = 0;
                if (neighbours > 3)
                    cells[row, col].nextGenStatus = 0;
                if ((neighbours == 2 || neighbours == 3) && cells[row, col].curGenStatus > 0)
                    cells[row, col].nextGenStatus = 1;
                if (neighbours == 3 && cells[row, col].curGenStatus == 0)
                    cells[row, col].nextGenStatus = 1;
            }

        for (int i = 0; i < 40; i++)
            for (int j = 0; j < 60; j++)
                cells[i, j].curGenStatus = cells[i, j].nextGenStatus;

        return cells;
    }

    static void PrintCells(cellDetail[,] cells)
    {
        for (int row = 0; row < 40; row++)
        {
            for (int col = 0; col < 60; col++)
            {
                if (cells[row, col].curGenStatus != 0)
                {
                    cells[row, col].curGenStatus = (char)30;
                    Console.Write((char)cells[row, col].curGenStatus);
                }
                else
                    Console.Write(" ");
            }
        }
    }

    public static void Random(int numOfGenerations)
    {
        cellDetail[,] cells = new cellDetail[40,60];
        Random rand = new Random();

        for (int row = 0; row < 40; row++)
            for (int col = 0; col < 60; col++)
                cells[row, col].curGenStatus = rand.Next(0, 2);

        for (int i = 0; i < numOfGenerations; i++)
        {
            Console.ForegroundColor = (ConsoleColor.Green);
            Generations(cells);
            Console.SetCursorPosition(0, 3);
            PrintCells(cells);
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T00:21:21.147

随机对象应该只创建一次并由类的所有对象使用。通过将其声明为类的静态成员，这可以实现。更好的选择是为随机对象创建一个单例辅助类。

# javascript - jquery从php脚本预加载图像然后显示

> ID：10098245
> 
> 赞同：1
> 
> 时间：2012-04-11T00:17:01.340
> 
> 标签：javascript, jquery, image, preload

我已经四处寻找这个案例并接近了，但我在完成它时遇到了问题。

我有一个创建图表的 PHP 脚本。它通过创建一个 png img 然后使用标题将图像显示到页面来实现。

我可以做类似的事情：

```
$('#img').attr('src', 'url.php?make_graph=1'); 
```

这有效。问题是，我有一些图表需要很长时间才能创建，超过一分钟，而在这种情况下，图像只是空白，网页看起来什么也没做。

我找到了一种预加载图像的方法，但没有找到将其应用到网页的方法（实际上来自堆栈溢出）。我可以：

```
$('<img/>', {
    'src': 'url.php....',
    'load': function(){ alert("loaded!"); }
}); 
```

所以我的问题是，我可以以这样的方式加载图像并以某种方式将其应用于页面上的现有图像吗？我不确定那句话是否很清楚......我错过了我可以实际显示由脚本制作的预加载图像的部分。如果可能，我想避免保存图像或使用 iframe。

坦克寻求任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T05:45:03.957

加载后，将图像 src 设置到您在幕后加载的相同位置，它将（理论上）从缓存中拉出并显示给用户。

```
$("<img>", {
    "src": "url.php...",
    "load": function() {
        alert("loaded!");
        $("#foo").attr("src", "url.php...");
    }
});​ 
```

这是我放在一起的一个例子。它最初在页面上加载一张图片，然后在后台加载另一张图片。当您确认警报消息时，它将通过更改 src 来交换图像。我确认它使用 Chrome 开发工具从缓存中提取图像。 [http://jsfiddle.net/uVFLD/1/](http://jsfiddle.net/uVFLD/1/)

可能有另一种方法可以解决这个问题，但这是我想到的第一个解决方案。

# java - 双向映射做对了吗？

> ID：10098251
> 
> 赞同：2
> 
> 时间：2012-04-11T00:18:03.050
> 
> 标签：java, hibernate

有人可以告诉我这是否是进行双向映射的正确方法吗？

```
class User {
    @OneToMany(cascade=CascadeType.ALL, mappedBy="user")
    private List<item> items;
}

class Item {
    @ManyToOne
    private User user;
} 
```

现在，如果我删除一个项目，我不希望删除该用户。如果我删除一个用户，我希望删除它的关联项目，因为它对用户来说是唯一的。

还有一个问题：如果我创建一个项目，我会：

```
User user = new User();
Item item = new Item();

user.getItems().add(item);
item.setUser(user);
persist(item); 
```

我是否必须将项目设置为用户，反之亦然设置项目？

泰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T00:26:01.657

1.  是的，您的关系/映射已正确注释。删除一个`Item`不会删除其关联的`User`. 删除 a`User`将删除`Item`与该用户关联的所有内容。

2.  您不需要自己双向链接它们（尽管这样做没有害处），至少在获取存储在数据库中的正确信息方面不需要。请注意，当数据库操作从 级联`User`到`Item`（反之亦然）时，您可能需要调用而*不是*. 这会自动持久化，只要你把它添加到列表中。 `persist(user)``persist(item)``item``user`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T00:26:31.850

如果您不想删除它们但想保存它们，请使用 CascadeType.PERSIST 或 MERGE。

# actionscript-3 - 为什么我不能在 AS3 中显示嵌入字体？

> ID：10098254
> 
> 赞同：8
> 
> 时间：2012-04-11T00:18:57.657
> 
> 标签：actionscript-3, flash, fonts, flashdevelop

我已经浏览了我能找到的关于在 AS3 中嵌入字体的所有主题，并尝试了所有解决方案。我可能遗漏了一些明显的东西，但我不完全理解我在做什么，所以请引导我朝着正确的方向前进。许多答案涉及 Flash Builder 或其他工具，但我使用**FlashDevelop**。不知道这是否重要。

我的 Main.as 中有这一行：

```
[Embed(source = "assets/SKA_75_marul_CE_extended.ttf", 
fontName = "SKA_75_marul_CE_extended", 
fontWeight = "bold", 
advancedAntiAliasing = "true", 
mimeType = "application/x-font")] 
public static var SKA_75_marul_CE_extended:String; 
```

这存在于名为 Pointer.as 的扩展 Sprite 的构造函数中：

```
var format:TextFormat = new TextFormat();
format.font = "SKA_75_marul_CE_extended";
format.color = 0xFFCCCC;
format.size = 20;           

var label:TextField = new TextField();
label.defaultTextFormat = format;
label.text = "test";
label.embedFonts = true;
label.antiAliasType = AntiAliasType.ADVANCED;

//label.setTextFormat(format);    --> I tried this too, didn't work...
label.defaultTextFormat = format;
label.x += img.width + 50;
this.addChild(label); 
```

我发现让它显示任何内容的唯一方法是关闭 embedFonts。我试过嵌入 C:/windows/fonts/arial.ttf 没有成功。

嵌入字体似乎是一门与众不同的黑暗艺术，经过 1 小时的挣扎，我必须承认。请发送帮助。

**更新：**

这是工作代码，原来是由于具有正确的操作顺序......：

```
[Embed(source="assets/SKA_75_marul_CE_extended.ttf", 
                fontName = "myFont", 
                mimeType = "application/x-font", 
                fontWeight="normal", 
                fontStyle="normal", 
                unicodeRange="U+0020-U+007E", 
                advancedAntiAliasing="true", 
                embedAsCFF="false")]
        private var myEmbeddedFont:Class;

            var tf:TextFormat = new TextFormat( "myFont", 20,0xffffff );

            var t:TextField     = new TextField;
            t.embedFonts        = true; // very important to set
            t.defaultTextFormat = tf;
            t.text              = text;
            t.x += img.width + 50;
            t.width = 700;
            this.addChild( t ); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T01:07:24.183

让嵌入的字体正常工作绝对是一种“黑暗艺术”。我将首先检查“SKA_75_marul_CE_extended”是否是字体在其元数据中的实际名称（我使用手提箱融合来提取名称）。我还看到了 Flash 拒绝嵌入的 TTF 字体（可能无效的元数据会导致嵌入系统出现故障）。我将继续使用已知的工作字体进行测试，直到您发现实际问题，以防它是字体文件问题。

我注意到的一件事是“public static var SKA_75_marul_CE_extended:String;”......这不应该是 Class 类型吗？

来自有问题的人的 FlashDevelop 字体嵌入参考： [http ://www.flashdevelop.org/community/viewtopic.php?p=28301](http://www.flashdevelop.org/community/viewtopic.php?p=28301)

# c# - 使用 ScriptableMember 进行 MainPage 验证

> ID：10098256
> 
> 赞同：0
> 
> 时间：2012-04-11T00:19:00.457
> 
> 标签：c#, silverlight, silverlight-4.0

我正在使用[本教程](http://www.codeproject.com/Articles/293515/Calling-Silverlight-Method-from-Javascript-and-Jav)中教授的概念与我的 Silverlight 应用程序之间的 Javascript 进行通信。我希望 JavaScript 代码检查 HTML 端的所有表单字段是否都已填写，如果是，则在 MainPage 中运行一个方法。

问题是该技术返回对 ScriptableClass 对象而不是 MainPage 的响应。有谁知道 ScriptableObject 如何调用 MainClass 中的方法。也许使用在 ScriptableClass 对象中触发的 MainClass 中的事件？

```
public class ScriptableClass
{
    [ScriptableMember]
    public void gotdetails(string message)
    {
        if (message == "1")
        {
            // call next method in MainPage
        }
        if (message == "0")
        {
            // tell user to complete fields
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T11:51:59.697

一种解决方案是将您的“gotdetails”方法移动到 MainClass 并将此 MainClass 注册为 ScriptableObject，我的意思是您根本不需要 ScriptableClass。

第二个选项，如果你想保留 ScriptableClass，是在 ScriptableClass 中创建静态事件并在 MainClass 中订阅此事件。使用静态事件，您不需要从 MainClass 实例访问 ScriptableCalss 实例。

MSDN 也有很好的关于 javascript 和 Silverlight 通信的[演练。](http://msdn.microsoft.com/en-us/library/cc221359%28v=vs.95%29.aspx)

# c# - 如何一次将继承应用于一组类

> ID：10098260
> 
> 赞同：3
> 
> 时间：2012-04-11T00:19:33.863
> 
> 标签：c#, inheritance, abstract-class

在 c# 中，我希望将抽象类应用于许多其他类。我怎么能不标记每个班级。

```
public abstract class Bar
{
 public bool Blah { get; set; }
}

public class Foo : Bar
{
 public int FooId { get; set; }
}

public class Stool : Bar {}
public class Fun : Bar {}
public class NoFun : Bar {} 
```

等等等等

有没有办法抓住每个类，然后将其标记为继承`Bar`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T00:23:35.210

不，您可以使用 Visual Studio 插件或其他类似的静态代码操作工具，但就语言本身而言，无法在运行时修改类型的继承，而且到目前为止据我所知，没有现有的 Visual Studio 功能可以为您执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T00:44:07.930

除了像其他海报提到的那样使用模板和/或 VS 插件之外，在技术上可以使用 Reflection.Emit 来做到这一点，尽管它会非常费力并且可能不是很高效。它可能归结为 IL 操作，并且必须创建一个函数来手动将 IL 从基类映射到新的动态类型。

如果您可以使用接口而不是抽象类，那可能会更容易一些。以下是一些示例代码，可让您以任何一种方式开始：

```
 AssemblyName assemblyName = new AssemblyName("MyDynamicAssembly");

    AssemblyBuilder assemblyBuilder = AppDomain.CurrentDomain.DefineDynamicAssembly
        (assemblyName, AssemblyBuilderAccess.RunAndSave);

    ModuleBuilder moduleBuilder = assemblyBuilder.DefineDynamicModule
        ("MyDynamicAssembly", "MyDynamicAssembly.dll");

    TypeBuilder typeBuilder = moduleBuilder.DefineType
        ("MyDynamicAssembly." + typeName, TypeAttributes.Public, typeof(object));

    typeBuilder.AddInterfaceImplementation(typeof(IMyInterface)); 

    typeBuilder.DefineDefaultConstructor(MethodAttributes.Public); 
```

# celery - 关于将 Celery 与多个负载平衡的 Django 应用程序服务器一起使用的问题

> ID：10098267
> 
> 赞同：2
> 
> 时间：2012-04-11T00:20:38.080
> 
> 标签：celery, django-celery, celeryd

我有兴趣将 Celery 用于我正在开发的应用程序。这一切看起来都很简单，但是如果我有多个负载平衡的应用程序服务器，我对我需要做什么感到有点困惑。所有文档都假定代理将与应用程序位于同一台服务器上。目前，我所有的应用程序服务器都位于 Amazon ELB 后面，并且任务需要能够来自其中任何一个。

这是我认为我需要做的：

*   在单独的实例上运行代理服务器
*   配置每个应用程序实例以连接到该代理服务器
*   每个应用程序实例也将是一个 celery 工作（运行 celeryd）？

我唯一对此感到不满的是：如果我的代理实例死了会发生什么？我可以以某种方式运行 2 个代理实例，这样如果一个发生故障我是安全的吗？

任何关于在像我这样的设置中做什么的提示或信息将不胜感激。我确定我错过了一些东西或不理解一些东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T12:50:49.673

供将来参考，对于那些更喜欢坚持使用 RabbitMQ 的人......

您可以从 2 个或更多实例创建 RabbitMQ 集群。将这些实例添加到您的 ELB 并将您的 celeryd 工作人员指向 ELB。只要确保您连接了正确的端口，您就应该准备就绪。不要忘记让您的 RabbitMQ 机器相互交谈以运行集群。这对我在生产中非常有效。

这里有一个例外：如果你需要安排任务，你需要一个 celerybeat 进程。出于某种原因，我无法将 celerybeat 连接到 ELB，而不得不将其直接连接到其中一个实例。我打开了一个关于它的问题，它应该得到解决（尚未测试）。请记住，celerybeat 本身只能存在一次，因此这已经是单点故障。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T06:15:06.880

你在所有方面都是正确的。

如何制作可靠的代理：制作集群rabbitmq安装，如下所述： [http ://www.rabbitmq.com/clustering.html](http://www.rabbitmq.com/clustering.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-16T19:51:58.357

如果您在每个工作节点上运行 Celery beat，也不必是单点故障：

[https://github.com/ybrs/single-beat](https://github.com/ybrs/single-beat)

# mysql - MySQL - 从查找表中获取和 ID 并在需要时插入

> ID：10098270
> 
> 赞同：0
> 
> 时间：2012-04-11T00:20:51.193
> 
> 标签：mysql

我有一个查找表，它有一个`ID`和一个`NAME`字段。我目前正在经历的过程是：

查找名称。如果行数等于 1，则返回 ID。如果行数为 0，则插入新名称并返回新 ID。如果多于 1 行，则记录错误并返回第一个 ID。

这由一个 SELECT 和一个 INSERT 组成（如果是新名称）。有没有办法把它结合起来，所以只执行一个 SQL 语句？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T00:31:11.127

即使这是可能的，我相信这不是非法的。你在 SQL 代码中塞进了太多的逻辑。

# java - 尝试使带有 Hibernate 示例的简单 Struts2 工作时出错

> ID：10098273
> 
> 赞同：1
> 
> 时间：2012-04-11T00:21:01.633
> 
> 标签：java, hibernate, xslt, struts2, persistence

我在使用 Struts2 和 Hibernate 获得具有许多表关系的大型应用程序时遇到了一些问题，因此我决定创建一个规模小得多的示例来解决这个问题，但我也无法使其正常工作。我的主要问题是，当涉及到任何惰性实例化集时，我根本无法让两者一起工作。我试图弄清楚如何让它在加载和不加载惰性数据的情况下工作，但在这种情况下，我已经加载了惰性数据并且我得到了一个“java.lang.StackOverflowError”。我有两个表，“部门”有两个条目，“员工”有三个；我正在使用 Struts2“xslt”结果类型。这是两个持久性类：

部门：

```
package com.test.model;
// Generated Apr 7, 2012 7:10:28 PM by Hibernate Tools 3.4.0.CR1

import java.util.HashSet;
import java.util.Set;
import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.FetchType;
import javax.persistence.GeneratedValue;
import static javax.persistence.GenerationType.IDENTITY;
import javax.persistence.Id;
import javax.persistence.OneToMany;
import javax.persistence.Table;

/**
 * Departments generated by hbm2java
 */
@Entity
@Table(name="Departments"
    ,catalog="test"
)
public class Departments  implements java.io.Serializable {

     private Integer id;
     private String name;
     private Set<Employees> employeeses = new HashSet(0);

    public Departments() {
    }

    public Departments(String name) {
        this.name = name;
    }
    public Departments(String name, Set employeeses) {
       this.name = name;
       this.employeeses = employeeses;
    }

     @Id @GeneratedValue(strategy=IDENTITY)

    @Column(name="Id", unique=true, nullable=false)
    public Integer getId() {
        return this.id;
    }

    public void setId(Integer id) {
        this.id = id;
    }

    @Column(name="Name", nullable=false)
    public String getName() {
        return this.name;
    }

    public void setName(String name) {
        this.name = name;
    }

    @OneToMany(fetch=FetchType.LAZY, mappedBy="departments")
    public Set<Employees> getEmployeeses() {
        return this.employeeses;
    }

    public void setEmployeeses(Set employeeses) {
        this.employeeses = employeeses;
    }
} 
```

雇员：

```
package com.test.model;
// Generated Apr 7, 2012 7:10:28 PM by Hibernate Tools 3.4.0.CR1

import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.FetchType;
import javax.persistence.GeneratedValue;
import static javax.persistence.GenerationType.IDENTITY;
import javax.persistence.Id;
import javax.persistence.JoinColumn;
import javax.persistence.ManyToOne;
import javax.persistence.Table;

/**
 * Employees generated by hbm2java
 */
@Entity
@Table(name="Employees"
    ,catalog="test"
)
public class Employees  implements java.io.Serializable {

     private Integer id;
     private Departments departments;
     private String firstName;
     private String lastName;

    public Employees() {
    }

    public Employees(Departments departments, String firstName, String lastName) {
       this.departments = departments;
       this.firstName = firstName;
       this.lastName = lastName;
    }

     @Id @GeneratedValue(strategy=IDENTITY)

    @Column(name="Id", unique=true, nullable=false)
    public Integer getId() {
        return this.id;
    }

    public void setId(Integer id) {
        this.id = id;
    }

    @ManyToOne(fetch=FetchType.LAZY)
    @JoinColumn(name="DepartmentsId", nullable=false)
    public Departments getDepartments() {
        return this.departments;
    }

    public void setDepartments(Departments departments) {
        this.departments = departments;
    }

    @Column(name="FirstName", nullable=false)
    public String getFirstName() {
        return this.firstName;
    }

    public void setFirstName(String firstName) {
        this.firstName = firstName;
    }

    @Column(name="LastName", nullable=false)
    public String getLastName() {
        return this.lastName;
    }

    public void setLastName(String lastName) {
        this.lastName = lastName;
    }
} 
```

我在 DepartmentsManager 类中使用的 HQL 查询是：“from Departments d left join fetch d.employeeses”。

这是错误的堆栈跟踪：

> org.apache.commons.logging.LogFactory.getContextClassLoaderInternal(LogFactory.java:859) 的 java.security.AccessController.doPrivileged(Native Method) 的线程“http-bio-8080-exec-4”java.lang.StackOverflowError 中的异常在 org.apache.commons.logging.LogFactory.getFactory(LogFactory.java:423) 在 org.apache.commons.logging.LogFactory.getLog(LogFactory.java:685) 在 com.opensymphony.xwork2.util.logging.commons .CommonsLoggerFactory.getLoggerImpl(CommonsLoggerFactory.java:29) 在 com.opensymphony.xwork2.util.logging.LoggerFactory.getLogger(LoggerFactory.java:42) 在 org.apache.struts2.views.xslt.AbstractAdapterNode.(AbstractAdapterNode.java: 85) 在 org.apache.struts2.views.xslt.BeanAdapter 的 org.apache.struts2.views.xslt.AbstractAdapterElement.(AbstractAdapterElement.java:41)。(BeanAdapter.java:73) 在 sun.reflect.GeneratedConstructorAccessor14.newInstance(Unknown Source) 在 sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45) 在 java.lang.reflect.Constructor.newInstance(Constructor.java:525) ) 在 java.lang.Class.newInstance0(Class.java:372) 在 java.lang.Class.newInstance(Class.java:325) 在 org.apache.struts2.views.xslt.AdapterFactory.constructAdapterInstance(AdapterFactory.java: 209) 在 org.apache.struts2.views.xslt.BeanAdapter.buildChildAdapters(BeanAdapter.java:135) 在 org.apache.struts2 的 org.apache.struts2.views.xslt.AdapterFactory.adaptNode(AdapterFactory.java:159) .views.xslt.AbstractAdapterNode.getChildAdapters(AbstractAdapterNode.java:128) 在 org.apache.struts2.views.xslt.AbstractAdapterNode。getChildNodes(AbstractAdapterNode.java:186) at org.apache.struts2.views.xslt.BeanAdapter.getChildNodes(BeanAdapter.java:88) at org.apache.struts2.views.xslt.AbstractAdapterNode.getFirstChild(AbstractAdapterNode.java:194)在 com.sun.org.apache.xalan.internal.xsltc.trax.DOM2SAX.parse(DOM2SAX.java:300) 在 com.sun.org.apache.xalan.internal.xsltc.trax.DOM2SAX.parse(DOM2SAX. java:302)...[此行重复令人作呕]

有人能指出我正确的方向吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T00:39:41.763

是的，这是一个想法：

您有一个 Departments 类（错误的命名 - 使用单数 Department）。它有一组 Employee 实例。这是一对多的关系：一个部门可以有一个或多个员工。到现在为止还挺好。

您的员工类（更糟糕的命名 - 使用单数员工）具有对其父部门的引用。

你看到问题了吗？每次调用 Employee 构造函数时，都可以使用 Department 构造函数，它会创建一个员工集。原始 Employee 的实例在该 Set 中，它再次调用 Department 构造函数 ad nauseum。

你需要打破这个循环：这是一个双向的一对多：

[http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/example-parentchild.html#example-parentchild-bidir](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/example-parentchild.html#example-parentchild-bidir)

# java - JTextArea 作为单元格渲染器似乎不适用于换行样式字

> ID：10098274
> 
> 赞同：4
> 
> 时间：2012-04-11T00:21:10.713
> 
> 标签：java, swing, jtable, jtextarea, renderer

我有一个 JTextArea 用作表格的单元格渲染器。在`getTableCellRenderercomponent`我的方法中：

```
 setText(getTextForCell());
    setSize(table.getColumnModel().getColumn(column).getWidth(), 0);
    getUI().getRootView(textArea).setSize(textArea.getWidth(), 0f);
    updateSize();

    private void updateSize() {
       int prefHeight = textArea.getPreferredSize().height;
       int currHeight = table.getRowHeight(r);
       if (prefHeight > currHeight) {
        table.setRowHeight(row, prefHeight);          
      } 
```

当文本区域使用换行字时，有时会短一行。

如果我从外部调用此 updateSize 方法，`getTableCellRendererComponent`则它可以正常工作。但是对于一个大表，每当调整列大小时调用所有行的更新大小是不可行的，因为它太慢了，所以我一直试图找到一种在行渲染期间调整大小的方法。

有一个相关的 Java 错误（被标记为已修复，但看起来并非如此）[http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4446522](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4446522)，但这种解决方法似乎不起作用使用自动换行时。

任何人都可以提供有关如何使其正常工作的替代方法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-11T07:04:33.830

替代方案正常工作

![在此处输入图像描述](../Images/cbf069ff5211f14179a9aa40fa29782d.png)

```
import java.awt.*;
import javax.swing.*;
import javax.swing.table.*;
import javax.swing.text.*;

public class AutoWrapInJTable {

    public AutoWrapInJTable() {
        String[] columnNames = {"TextAreaCellRenderer"};
        Object[][] data = {
            {"123456789012345678901234567890"},
            {"dddddddddddddddddddddddddddddddddddddddddddddddddddddddddx"},
            {"----------------------------------------------0"},
            {">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>|"},};
        TableModel model = new DefaultTableModel(data, columnNames) {

            private static final long serialVersionUID = 1L;

            @Override
            public boolean isCellEditable(int row, int column) {
                return false;
            }
        };
        JTable table = new JTable(model) {

            private static final long serialVersionUID = 1L;

            @Override
            public void doLayout() {
                TableColumn col = getColumnModel().getColumn(0);
                for (int row = 0; row < getRowCount(); row++) {
                    Component c = prepareRenderer(col.getCellRenderer(), row, 0);
                    if (c instanceof JTextArea) {
                        JTextArea a = (JTextArea) c;
                        int h = getPreferredHeight(a) + getIntercellSpacing().height;
                        if (getRowHeight(row) != h) {
                            setRowHeight(row, h);
                        }
                    }
                }
                super.doLayout();
            }//http://tips4java.wordpress.com/2008/10/26/text-utilities/

            private int getPreferredHeight(JTextComponent c) {
                Insets insets = c.getInsets();
                View view = c.getUI().getRootView(c).getView(0);
                int preferredHeight = (int) view.getPreferredSpan(View.Y_AXIS);
                return preferredHeight + insets.top + insets.bottom;
            }
        };
        table.setEnabled(false);
        table.setShowGrid(false);
        table.setTableHeader(null);
        table.getColumnModel().getColumn(0).setCellRenderer(new TextAreaCellRenderer());
        table.setPreferredScrollableViewportSize(table.getPreferredSize());
        JScrollPane sp = new JScrollPane(table);
        sp.setVerticalScrollBarPolicy(ScrollPaneConstants.VERTICAL_SCROLLBAR_ALWAYS);
        JPanel p = new JPanel(new BorderLayout());
        p.add(sp);
        JFrame f = new JFrame();
        f.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);
        f.add(p);
        //f.pack();
        f.setSize(200, 200);
        f.setLocation(150, 150);
        f.setVisible(true);
    }

    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable() {

            @Override
            public void run() {
                AutoWrapInJTable autoWrapInJTable = new AutoWrapInJTable();
            }
        });
    }
}

class TextAreaCellRenderer extends JTextArea implements TableCellRenderer {

    private static final long serialVersionUID = 1L;
    private final Color evenColor = new Color(230, 240, 255);

    public TextAreaCellRenderer() {
        super();
        setLineWrap(true);
        setBorder(BorderFactory.createEmptyBorder(2, 2, 2, 2));
    }

    @Override
    public Component getTableCellRendererComponent(JTable table, Object value,
            boolean isSelected, boolean hasFocus, int row, int column) {
        if (isSelected) {
            setForeground(table.getSelectionForeground());
            setBackground(table.getSelectionBackground());
        } else {
            setForeground(table.getForeground());
            setBackground(table.getBackground());
            setBackground((row % 2 == 0) ? evenColor : getBackground());
        }
        setFont(table.getFont());
        setText((value == null) ? "" : value.toString());
        return this;
    }
} 
```

# android - Android AVD - USB 端口

> ID：10098279
> 
> 赞同：3
> 
> 时间：2012-04-11T00:22:07.197
> 
> 标签：android, usb, google-api, avd

我是 Android 编程新手。

我正在尝试编写一个使用 USB 与设备通信（读/写）的应用程序。我正在使用 Android SDK 2.3.3 (API 10)。我的项目设置为使用 Google API。`AVD Manager`我使用Eclipse 为 Google API创建了 AVD 。

现在当我使用时：

`mUsbAccessory = mUsbManager.getAccessoryList();`

`mUsbAccessory`是`null`因为没有设备连接到 AVD。是否可以让 AVD 使用我电脑上的 USB 端口之一？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T02:24:27.327

模拟器不支持 USB（[http://developer.android.com/guide/developing/devices/emulator.html#limitations](http://developer.android.com/guide/developing/devices/emulator.html#limitations)）。

# android - Android错误在xml上膨胀类

> ID：10098281
> 
> 赞同：2
> 
> 时间：2012-04-11T00:22:17.167
> 
> 标签：android, xml, user-interface, view, custom-controls

我创建了一个从 ViewFlipper 扩展的类。当我尝试在 xml 上实例化时，它给了我这个“错误在 xml 上膨胀类”

FixedViewFlipper

```
public FixedViewFlipper(Context context)
{
    super(context);
}

public FixedViewFlipper(Context context, AttributeSet attrs)
{
    super(context, attrs);
} 
```

xml

```
<View class="com.touchcare.idealogix.android.FixedViewFlipper"
    android:id="@+id/flipperAdd"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentTop="true"
    >
</View> 
```

[日志猫](http://pastebin.com/hYmrD0sp)

编辑：我在 MainActivity 中使用 TabActivity。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-11T00:35:56.937

您只需要 view 不被大写 -

```
<view 
    class="touchcare.idealogix.android.FixedViewFlipper"
    android:id="@+id/flipperAdd"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentTop="true"
    >
</view> 
```

这是完全有效的语法，并且是在许多谷歌应用程序中完成的

# debugging - 异常日志分析工具或技术

> ID：10098286
> 
> 赞同：4
> 
> 时间：2012-04-11T00:22:31.180
> 
> 标签：debugging, elmah, logfile-analysis

我正在记录异常，如果有一些工具或技术可以对异常日志进行一些分析，那就太好了，有人可以推荐吗？

我正在用某种启发式分析来想象一些东西，但我可能是在做梦。

我认为对分析工具*或技术*有用的东西：

*   X 类型的所有异常都在 url A 上
*   Y 类型的所有异常都来自用户代理 B
*   Z 型的所有例外情况仅限于周六下午 4 点；-)

如果您有任何其他技巧或技术来加快异常日志的分析，那也很好。

注意：我将 Elmah 与 SQLite 一起使用（尽管数据可以传输到任何更容易的地方，例如 SQL）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T00:23:19.043

我试过[elmah-loganalyzer](http://code.google.com/p/elmah-loganalyzer/)这是我发现的

*   一两份报告很有帮助，
*   查询功能不够灵活。（没有分组等）
*   没有魔法启发式分析器;-)
*   它不读取 SQLite（我可以将数据传输到 SQL）
*   不记得 SQL 连接设置

# ruby-on-rails - 让访问者尝试写入数据库的仅限用户的功能

> ID：10098289
> 
> 赞同：0
> 
> 时间：2012-04-11T00:22:38.120
> 
> 标签：ruby-on-rails, html, registration, user-management

我的网站允许人们创建数据库条目（大多数 Rails 应用程序都这样做），我意识到从登陆该网站到实际注册试用它有很大的下降。基本上，该服务允许用户通过组合不同的组件来构建自己的文档。我正在考虑添加一个界面，让尚未注册的访问者可以尝试这些功能（构建东西）并要求他们在最后阶段注册，当他们即将发布他们的文档时。

首先想到的是使用 HTML5 本地存储，但随后又想到了另一个想法：也许我可以在访问者尝试使用这些功能时创建一个临时用户，然后如果他们没有登录，则稍后将其从数据库中删除. 我不确定这是否安全，但这似乎比处理所有本地存储问题更容易。

这种情况的最佳做法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T01:54:41.530

HTML5 存储将是一种选择，但很可能有很多客户端编码。

其他选项是拥有这些“演示”文档的重复表，您可以不时为未注册的用户清除这些表。您也可以只将文档存储在用户会话中，因为您不需要永久存储它，然后在他们注册后将其存储在数据库中。

# asp.net - 使用 ASP.net 监控数据库中的更新和删除

> ID：10098297
> 
> 赞同：0
> 
> 时间：2012-04-11T00:23:40.913
> 
> 标签：asp.net, vb.net, ms-access

我在 VB.net 中使用网格来显示存储在 Microsoft Access 中的数据库记录，这些表允许使用网格字段进行编辑和删除。有没有一种方法可以在用户删除或编辑记录时进行监控？我希望能够查看对某些记录的每次更新或删除的详细信息，例如日期和执行此操作的用户。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T00:37:49.373

您所说的被称为“审计”，某些数据库（例如 MS SQL Server）具有对此的内置支持。MS Access 不包括此功能。由于没有审计，以自定义方式实现这一点的常用方法是使用更新触发器。不幸的是，MS Access 也没有触发器。您能够做到这一点的唯一方法是通过您自己编写的 API 与您的表格进行交互并遵守该 API 的纪律。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T00:36:18.753

您要做的是在插入和删除时挂接到保存命令。您还可以挂钩事件以捕获数据。无论哪种方式，创建一个插入语句，将日志数据转储到您的日志数据库中。

# javascript - 使用 AJAX 从 Javascript 运行整个 PHP 文件

> ID：10098300
> 
> 赞同：0
> 
> 时间：2012-04-11T00:23:49.897
> 
> 标签：javascript, php, ajax, local-storage

在 index.php 中的 $(document).ready(function() 上，执行以下 AJAX，运行文件 getData.php：

```
if (window.XMLHttpRequest)
      {// code for IE7+, Firefox, Chrome, Opera, Safari
      xmlhttp=new XMLHttpRequest();
      }
    else
      {// code for IE6, IE5
      xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
      }
    xmlhttp.onreadystatechange=function()
      {
      if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
        document.getElementById("dataSuccess").innerHTML=xmlhttp.responseText;
        } 
      }
    xmlhttp.open("GET","getData.php",true);
    xmlhttp.send(); 
```

在 getData.php 文件中，从 MySQL 收集数据并放入 JS 数组中：

```
 var guestData = new Array("<? for ($j=0;$j< sizeof($guestData);$j++) { print     ($guestData[$j]); ?>","<?php } $j = $j+1; ?>"); 
```

最后，将我的 js 数组中的数据存储到 LocalStorage 中：

```
 var guestDataCols = new Array();
    guestDataCols = guestData[0].split(",")

        var arrayIndex=0;
        for(arrayIndex=0;arrayIndex<guestData.length-1;arrayIndex++)
        {
            localStorage.setItem(arrayIndex, guestData[arrayIndex]); // storing
        } 
```

**一切正常！但**问题是我的 AJAX 代码似乎没有运行整个 getData.php 文件，因为在通过 AJAX 执行 php 文件后 LocalStorage 仍然为空。**但是（这是一个很大的问题）**，如果我只是在另一个窗口中刷新 getData.php，*数据将被完美存储并且一切正常*。正如另一个 Stack Overflow 问题中所建议的那样，我也尝试过使用**jQuery**

```
 $('#dataSuccess').load('getData.php'); //instead for the AJAX code 
```

但结果完全相同且有些平庸。所以我的问题是，为什么 AJAX 脚本不运行整个 php 文件和**HENCE**，为什么没有数据存储在 LocalStorage 中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T00:44:01.877

当由 XMLHttp 请求调用时，HTML 页面上的 JavaScript 不会运行。浏览器不解析 JavaScript 通过 XMLHttp 请求接收的页面，因此不运行 JavaScript。您必须输出到浏览器才能运行它。您最好的选择是让 PHP 返回您需要的数据，然后从 XMLHttp 请求中提取它。例如，`getData.php`可以返回一个 JSON 字符串，其中包含您需要的数据。然后在带有 XMLHttp 请求的页面上，您可以解析该 JSON 字符串并将其保存到该页面上的 localStorage。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T01:16:51.843

我认为您正在寻找[jQuery.getScript](http://api.jquery.com/jQuery.getScript/)

# c++ - C++：将不接受新的 C 字符串输入

> ID：10098302
> 
> 赞同：1
> 
> 时间：2012-04-11T00:24:09.897
> 
> 标签：c++, c-strings

首先，提前感谢您的帮助。这个问题快把我逼疯了。

我有一个接受 c 字符串的程序，然后可以计算元音和辅音的数量。这没有问题。但是，我还需要包含一个允许用户创建新字符串的函数。但是，问题是，当用户从菜单中选择“新字符串”时，它只是循环执行该`newString()`方法，而无需等待用户输入。然后它会创建一个新的空白屏幕。

这是整个程序。`newString()`方法在最后。

```
#include <iostream>    
using namespace std;

// function prototype
void printmenu(void);
int vowelCount(char *);
int consCount(char *);
int cons_and_vowelCount(char *);
void newString(char *, const int);

int main() {

    const int LENGTH = 101;
    char input_string[LENGTH];      //user defined string
    char choice;                        //user menu choice
    bool not_done = true;       //loop control flag

    // create the input_string object
    cout << "Enter a string of no more than " << LENGTH-1 << " characters:\n";
    cin.getline(input_string, LENGTH);

    do {
        printmenu();
        cin >> choice;
        switch(choice)
        {
            case 'a':
            case 'A':
               vowelCount(input_string);
               break;
            case 'b':
            case 'B':
               consCount(input_string);
               break;
            case 'c':
            case 'C':
                cons_and_vowelCount(input_string);
                break;
            case 'd':
            case 'D':
               newString(input_string, LENGTH);
               break;
            case 'e':
            case 'E':
               exit(0);
            default:
                cout << endl << "Error: '" << choice << "' is an invalid selection" << endl;
                break;
        } //close switch
    } //close do

while (not_done);
return 0;
} // close main

/* Function printmenu()
 * Input:
 *  none
 * Process:
 *  Prints the menu of query choices
 * Output:
 *  Prints the menu of query choices
 */
void printmenu(void)
{
    cout << endl << endl;
    cout << "A) Count the number of vowels in the string" << endl;
    cout << "B) Count the number of consonants in the string" << endl;
    cout << "C) Count both the vowels and consonants in the string" << endl;
    cout << "D) Enter another string" << endl;
    cout << "E) Exit the program" << endl;
    cout << endl << "Enter your selection: ";
    return;    
}

int vowelCount(char *str) {
    char vowels[11] = "aeiouAEIOU";
    int vowel_count = 0;

    for (int i = 0; i < strlen(str); i++) {
        for (int j = 0; j < strlen(vowels); j++) {
            if (str[i] == vowels[j]) {
                vowel_count++;
            }
        }
    }
    cout << "String contains " << vowel_count << " vowels" << endl;
    return vowel_count;
} // close vowelCount

int consCount(char *str) {
    char cons[43] = "bcdfghjklmnpqrstvwxyzBCDFGHJKLMNPQRSTVWXYZ";
    int cons_count = 0;

    for (int i = 0; i < strlen(str); i ++) {
        for (int j = 0; j < strlen(cons); j++) {
            if (str[i] == cons[j]) {
                cons_count++;
            }
        }
    }
    cout << "String contains " << cons_count << " consonants" << endl;
    return cons_count;
} // close consCount

int cons_and_vowelCount(char *str) {
    int cons = consCount(str);
    int vowels = vowelCount(str);
    int total = cons + vowels;

    cout << "The string contains a total of " << total << " vowels and "
            "consonants" << endl;
    return total;
}

void newString(char *str, int len) {
    cout << "Enter a string of no more than " << len-1 << " characters:\n";
    cin.getline(str, len);
    return;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-11T00:32:23.877

该语句`cin >> choice`只使用他们键入的字符，而不是后面的回车。因此，随后的`getline()`调用读取一个空行。一个简单的解决方案是调用`getline()`而不是`cin >> choice`然后使用第一个字符作为选择。

顺便说一句，`while (not done)`应该紧跟在`do { … }`之后，而`return 0`是多余的。此外，您应该在程序开始时调用 newString 而不是重复其内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-11T00:34:32.443

`cin >> choice`在输入流中留下一个换行符..这导致下一个`getline()` 消耗它并返回。有很多方法..一种方法是在`cin.ignore()`之后使用`cin >> choice`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T01:03:11.070

仅消耗流中的`cin >> choice`一个字符（如前所述）。你应该添加

```
 cin.ignore(std::numeric_limits<std::streamsize>::max(),'\n'); 
```

在阅读选择后`cin>>choice`忽略所有进入流的字符。

ps`#include <limits>`

# jquery - 嵌套的 jQuery 切换语句

> ID：10098303
> 
> 赞同：0
> 
> 时间：2012-04-11T00:24:16.873
> 
> 标签：jquery, nested, toggle

我有一种情况，我在 jQuery 中有“嵌套”切换语句。

我有一堆选择，允许用户将一天设置为打开或关闭。

然后我有一个选择，允许用户显示所有日子的详细信息。默认情况下隐藏详细信息（这导致了我的问题）。

如果用户将某一天设置为关闭，我不想在用户选择显示所有天的详细信息时显示这一天。例如。如果星期一设置为关闭并且一周的其余时间是开放的并且用户选择“显示详细信息”，它将显示除星期一以外的所有日期的详细信息。

如果我从显示所有详细信息开始（您可以隐藏和显示详细信息并且不显示关闭日），这很好用。但默认情况下，详细信息是隐藏的，如果用户将某些天设置为关闭，然后显示详细信息，它会显示所有天的详细信息，甚至是关闭的天。

当包含 div 的切换发生更改时，是否有一种简单的方法可以保持“嵌套”切换？

我已经在这个 jFiddle 中整理了一个关于这种情况的粗略示例。

[http://jsfiddle.net/yTt3t/16/](http://jsfiddle.net/yTt3t/16/)

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T00:30:24.043

实际上，问题在于您更改其可见性的元素的父元素最初是隐藏的。我假设 jQuery 执行了一些优化以避免不必要的 CSS 和 DOM 更改。

但是，如果您将布尔值传递给[`.toggle()` *^([docs])*](http://api.jquery.com/toggle/)，它仍然有效，无论如何，IMO 更好，它确保元素的状态始终正确：

```
$("#monday_select").change(function(){
    $("#monday_details").toggle(this.value === 'Open');
});

$("#tuesday_select").change(function(){
    $("#tuesday_details").toggle(this.value === 'Open');
}); 
```

该参数控制元素是显示 ( `true`) 还是隐藏 ( `false`)。

[**演示**](http://jsfiddle.net/yTt3t/17/)

# c++ - 我在哪里可以设置 Eclipse C++ 函数名称样式？

> ID：10098304
> 
> 赞同：5
> 
> 时间：2012-04-11T00:24:18.923
> 
> 标签：c++, eclipse, naming-conventions, eclipse-indigo, codan

命名约定的 Codan 分析给了我“错误的函数名称”信息消息，因为它需要 camelCase 并且我使用 CamelCase。（我知道我可以关闭它，但我宁愿让它强制执行我的命名约定）。

我正在使用 Eclipse/CDT Indigo。在 Windows->Preferences 下有一个 C/C++->Code Style->Name Style（见图），但在 Code 下它没有方法名称的选项。这很奇怪，因为它有一个更具体的 Getter 和 Setter 方法条目。Codan 从哪里得到它用于验证的样式？

![首选项对话框的屏幕截图](../Images/8f38e3ad70778d0f116c06ec6cb996fa.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-11T01:53:20.930

右键单击“问题”窗口中的信息消息，然后选择`Customize Problem...`上下文菜单底部的选项：

![在此处输入图像描述](../Images/f3fd32c116520cf7df1871b7324e605b.png)

并将函数命名的模式更改为`^[A-Z]`

![在此处输入图像描述](../Images/157c82db49e1f2419d5502524c51e277.png)

# wcf - 将 HTMLPage 作为 WCF REST 服务的返回值传递

> ID：10098306
> 
> 赞同：0
> 
> 时间：2012-04-11T00:24:22.413
> 
> 标签：wcf, html

我想将 HTMLPage 作为我的 WCF REST 服务的返回值传递给我的 HTML5 应用程序（客户端）。有没有办法做到这一点？还是有其他方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T02:56:58.017

简单的方法：`Stream`从要返回 HTML 页面的操作中返回 a，并将传出内容类型设置为“text/html”。[您可以在http://blogs.msdn.com/b/carlosfigueira/archive/2008/04/17/wcf-raw-programming-model-web.aspx](http://blogs.msdn.com/b/carlosfigueira/archive/2008/04/17/wcf-raw-programming-model-web.aspx)找到有关它的更多信息。

如果您不想自己创建 HTML 页面，而是想要可以将某些对象转换为页面的东西，则需要深入挖掘 WCF 的内部，并使用消息格式化程序之类的东西来进行转换为你。这确实需要更多的工作，所以我强烈推荐这种简单的方法，除非您已经在对象及其表示之间建立了某种映射。

# php - 将站点 CSS 与 PHP 联系表单一起使用

> ID：10098307
> 
> 赞同：0
> 
> 时间：2012-04-11T00:24:31.397
> 
> 标签：php, css

这是我的问题。我使用与 css zen garden 相同的设置制作了我的作品集。它只有 4 个 html 页面，但它有 4 种不同的 CSS 布局可以在它们之间切换。我在联系页面中安装了一个使用 PHP 的联系表单。**我如何做到这一点，以便我的 php 联系表单使用该站点当前正在使用的相同 CSS。**

我真的需要帮助我无法解决这个问题。

**我的投资组合：** [联系表](http://www.gzstudios.com/contact.html)

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T00:47:21.200

您还必须在[iFrame 源](http://www.gzstudios.com/contact/contactform.php)中包含 CSS 。iFrame 不会从其父页面继承 CSS，因此基本上您在 iFrame 窗口中拥有的是没有 CSS 的空白 HTML。

您可以`contactform.php`使用 $_GET 开关来使用不同的 CSS 样式（我相信您知道这一点）。

# ruby-on-rails - Rails - 按用户=唯一的课程ID查找所有内容

> ID：10098317
> 
> 赞同：1
> 
> 时间：2012-04-11T00:26:44.067
> 
> 标签：ruby-on-rails, ruby, activerecord

我有下表：

```
Tweet(id: integer, from_user: string, tweet_text: string, tweet_id: integer, course_id: integer, tweet_already_exists: boolean, tweet_posted_to_reviews: boolean, created_at: datetime, updated_at: datetime) 
```

而且，对于一门特定的课程，我想获得最后 50 条用户独特的推文。我已经做到了这一点：

```
 Tweet.order("tweet_id desc").find_all_by_course_id(@course.id).first(50) 
```

这样做的问题是，如果用户不止一次发推文，他们会出现两次（两条推文都出现），我只想得到那个人的最新推文。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T01:11:05.887

这有点复杂，但我不确定是否可以以更简单的方式执行您想要执行的查询：

```
Tweet.where("tweets.updated_at >= (SELECT MAX(t.updated_at) FROM tweets AS t WHERE t.from_user=tweets.from_user)").order("tweets.tweet_id desc").find_all_by_course_id(@course.id).first(50) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T00:31:30.073

我没有测试过，但试试这个：

```
Tweet.find(:all, :select => 'DISTINCT from_user', :order => 'tweet_id desc') 
```

将为您提供没有重复用户的推文列表。查询结果获取课程。

* * *

你晚上还想使用 ruby​​ 方法`uniq`，它返回一个没有重复的数组。

# ruby-on-rails - Rails + SCSS：根据子级样式设置 Flash 包装器

> ID：10098318
> 
> 赞同：0
> 
> 时间：2012-04-11T00:26:46.997
> 
> 标签：ruby-on-rails, css, sass

我有这个样式：

```
#flash_wrapper {
  width: 100%;
  padding: 15px 0;
  background: rgba(255,255,120,0.2);
  border-bottom: 2px solid #FFFFAA;
  -moz-box-shadow: 0 2px 2px #FFF;
  -webkit-box-shadow: 0 2px 2px #FFF;
  box-shadow: 0 2px 2px #FFF;
  .flash{
    width: 960px;
    margin: 0 auto;
    font-size: 16px;
    font-weight: bold;
    color: #333;
  }
} 
```

但我想有背景：#flash_wrapper 中的红色，如果 Flash 中有一个 id 错误的孩子。所以，如果我有以下情况：

```
<div id="flash_wrapper">
 <div class="flash" id="error">
   Error value
 </div>
</div> 
```

我想将#flash_wrapper 的背景设置为红色。

我怎样才能做到这一点？

# actionscript-3 - IntelliJ 10 与 IntelliJ 11：代码完成

> ID：10098321
> 
> 赞同：2
> 
> 时间：2012-04-11T00:27:14.247
> 
> 标签：actionscript-3, flash, ide, intellij-idea

看看下面的图片。这种情况经常发生。例如，键入“pub”将显示 Flex 4.5 中的类，而我真的想键入“public”。IntelliJ 10 似乎工作得很好。如何将其更改为也可以在 IntelliJ 11 中使用？有什么建议么？

IntelliJ 10 - 好
![智能 10](../Images/7600d30fe2cb8cf619c4a6fe1a063791.png)

IntelliJ 11 - 不好
![智能 11](../Images/b76de7709fb4004b827f1450b0c073c4.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T02:25:58.773

该问题将在版本 118.255 中修复。链接到[错误问题](http://youtrack.jetbrains.com/issue/IDEA-84421)

# mysql - myphpadmin 中缺少数据库，但可通过 Coldfusion 访问

> ID：10098326
> 
> 赞同：0
> 
> 时间：2012-04-11T00:27:43.330
> 
> 标签：mysql, database, phpmyadmin

我是 mySQL 和 myphpadmin 的新手，但几周前我想出了如何创建数据库、表、添加关系和插入/修改记录……太棒了！我一直在创建可访问和更新数据库的冷融合表单……完美！但是我上周的一天回到了 myphpadmin，我的数据库已经消失了！唯一的数据库是“information_schema”和“test”（它是空的）。我的数据库“hr_database”不见了！疯狂的是（除此之外），我仍然可以使用我的 ColdFusion 表单来访问和修改该数据库！

无论如何，我可以在 myphpadmin 中取回它？如果你们都需要更多信息，请告诉我！

非常感谢！

克尔斯滕

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T16:16:01.500

我认为菲多是对的。您登录到 phpmyadmin 的用户可能无权查看该数据库。如果您具有 root 访问权限，请确保使用该权限登录。如果不是，请使用您的 CF DSN 使用的同一用户。

# java - 如何从地图作业中输出整个文件？

> ID：10098327
> 
> 赞同：0
> 
> 时间：2012-04-11T00:28:03.773
> 
> 标签：java, hadoop, mapreduce

这是关于 mapreduce 输出的基本问题。

我正在尝试创建一个映射函数，该函数接受一个 xml 文件并使用 apache fop 制作一个 pdf。但是，我对如何输出它有点困惑，因为我知道它作为（键，值）对输出。

我也没有使用流媒体来做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T03:10:26.640

map-reduce 的重点是处理通常不适合内存的大量数据 - 因此输入和输出通常会以某种方式存储在磁盘上（又名文件）。输入输出必须以[键值格式指定](http://hadoop.apache.org/common/docs/current/mapred_tutorial.html)

```
(input) <k1, v1> -> map -> <k2, v2> -> combine -> <k2, v2> -> reduce -> <k3, v3> (output) 
```

我没有尝试过，但这就是我会做的：

将映射器的输出写入此表单：`key`是[Text](http://hadoop.apache.org/common/docs/current/api/org/apache/hadoop/io/Text.html)中的文件名（保持文件名唯一），`value`是[TextOutputFormat](http://hadoop.apache.org/mapreduce/docs/r0.21.0/api/org/apache/hadoop/mapreduce/lib/output/TextOutputFormat.html)中 fop 的输出。[使用TextOutputFormat](http://hadoop.apache.org/mapreduce/docs/r0.21.0/api/org/apache/hadoop/mapreduce/lib/output/TextOutputFormat.html)编写它。

**建议：**

我假设您的用例只是读取输入 xml（可能对其数据进行一些操作）并使用[fop](http://xmlgraphics.apache.org/fop/)将数据写入 PDF 文件。我不认为这首先是一个hadoop用例......因为你想做的任何事情都可以通过批处理脚本来完成。你的 xml 文件有多大？您必须处理多少个 xml 文件？

**编辑：**

[SequenceFileOutputFormat](http://hadoop.apache.org/common/docs/current/api/org/apache/hadoop/mapred/SequenceFileOutputFormat.html)将写入[SequenceFile](http://wiki.apache.org/hadoop/SequenceFile)。[SequenceFile](http://wiki.apache.org/hadoop/SequenceFile)具有自己的标题和其他元数据以及存储的文本。它还以键：值的形式存储数据。

```
SequenceFile Common Header

    version - A byte array: 3 bytes of magic header 'SEQ', followed by 1 byte of actual version no. (e.g. SEQ4 or SEQ6)
    keyClassName - String
    valueClassName - String
    compression - A boolean which specifies if compression is turned on for keys/values in this file.
    blockCompression - A boolean which specifies if block compression is turned on for keys/values in this file.    
    compressor class - The classname of the CompressionCodec which is used to compress/decompress keys and/or values in this SequenceFile (if compression is enabled).    
    metadata - SequenceFile.Metadata for this file (key/value pairs)
    sync - A sync marker to denote end of the header. 
```

使用[SequenceFile](http://wiki.apache.org/hadoop/SequenceFile)会破坏您的应用程序，因为您最终会得到损坏的输出 PDF 文件。试试[这个](http://srijiths.wordpress.com/2011/02/23/sequence-files-in-hadoop/)，自己看看。

你有很多输入文件......这就是 hadoop 糟糕的地方。[（读这个）](http://www.cloudera.com/blog/2009/02/the-small-files-problem/)。我仍然觉得您可以使用脚本对每个文档逐一调用[fop来执行所需的操作。](http://xmlgraphics.apache.org/fop/)如果您有多个节点，请在输入文档的不同子集上运行相同的脚本。相信我，考虑到创建地图和减少所涉及的开销（你不需要减少......我知道），这将比 hadoop 运行得更快。

# r - 减去具有不同行数的数据帧？

> ID：10098328
> 
> 赞同：4
> 
> 时间：2012-04-11T00:28:12.667
> 
> 标签：r, dataframe

我有两个数据框，每个数据框有两列。第一列是时间戳，第二列包含一些值。其中一个数据帧比另一个大得多，但它们都包含相同时间戳范围内的数据。

如果我将这两个绘制在彼此之上，我会得到一个很好的图来展示它们在时间上的差异。

现在我想获得这两个数据帧的时间绝对差异，以制作另一个图，显示它们的差异程度（或使用此信息创建一个箱线图），即使它们没有相同的长度和精确匹配的时间戳。

检查这个例子：

df1：

```
timestamp | data
1334103075| 1.2
1334103085| 1.5
1334103095| 0.9
1334103105| 0.7
1334103115| 1.1
1334103125| 0.8 
```

df2:

```
timestamp | data
1334103078| 1.2
1334103099| 1.5
1334103123| 0.8
1334103125| 0.9 
```

我将如何实现这样的目标：

```
df3 <- abs(df1-df2) 
```

如您所见，df2 的时间戳可能与 df1 不同，但它们的时间戳都在相同的时间范围内。

当然，减法应该尝试匹配时间戳或从它们附近的时间戳平均值中减去值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T00:49:38.167

我建议使用两个线性插值器，并根据您的两组时间戳对它们进行评估：

```
df1 <- data.frame(timestamp = c(1334103075, 1334103085, 1334103095,
                                1334103105, 1334103115, 1334103125),
                  data      = c(1.2, 1.5, 0.9, 0.7, 1.1, 0.8))

df2 <- data.frame(timestamp = c(1334103078, 1334103099, 1334103123,
                                1334103125),
                  data      = c(1.2, 1.5, 0.8, 0.9))

library(Hmisc)
all.timestamps <- sort(unique(c(df1$timestamp, df2$timestamp)))
data1 <- approxExtrap(df1$timestamp, df1$data, all.timestamps)$y
data2 <- approxExtrap(df2$timestamp, df2$data, all.timestamps)$y

df3 <- data.frame(timestamp = all.timestamps,
                  data1     = data1,
                  data2     = data2,
                  abs.diff  = abs(data1 - data2))
df3
#    timestamp data1    data2   abs.diff
# 1 1334103075  1.20 1.157143 0.04285714
# 2 1334103078  1.29 1.200000 0.09000000
# 3 1334103085  1.50 1.300000 0.20000000
# 4 1334103095  0.90 1.442857 0.54285714
# 5 1334103099  0.82 1.500000 0.68000000
# 6 1334103105  0.70 1.325000 0.62500000
# 7 1334103115  1.10 1.033333 0.06666667
# 8 1334103123  0.86 0.800000 0.06000000
# 9 1334103125  0.80 0.900000 0.10000000 
```

如果您对线性近似不太满意，那么您可以考虑拟合样条曲线。

# plone - Plone中奇怪的锚标签/相对路径问题

> ID：10098332
> 
> 赞同：1
> 
> 时间：2012-04-11T00:29:34.267
> 
> 标签：plone

使用克隆 4.1.4。

有一个名为 /employment 的容器，它有一个页面的默认视图，也称为就业。

就业容器中还有一个名为 foo 的附加页面

当我添加锚标记（通过 TinyMCE 或直接 html）时，它“自动”链接到父文件夹而不是当前页面。

我正在`http://www.example.com/employment/foo` 尝试`<a href="#bar">`在 foo 页面上添加一个链接。

我希望链接`http://www.example.com/employment/foo#bar`在渲染时出现，但它显示为`http://www.example.com/employment/#bar`

知道为什么它默认为父“文件夹”而不是当前实际所在的页面吗？是一些奇怪的缓存问题还是 url 重写巫毒？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T08:01:27.043

您可能会在这里成为基本标签的受害者。浏览器使用基本标签来决定相对链接的参考点。如果基本标签说基本 URL 是您的容器，那么您创建的相对链接最终将相对于它呈现。

检查渲染页面头部的 base 值，看看是否是这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T04:17:34.720

您是否在 TinyMCE 的设置中启用了“使用 UID 链接”？UID 链接启用 URL 重写过滤器，它将所有相对链接解析为绝对链接。Id 有相对链接的问题，但应该在*plone.outputfilters >= 1.2*中修复（例如，它不再尝试“修复”锚链接）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-07T07:39:27.060

对于我在 Plone 4.3.3 中处理敏捷内容类型来说，这仍然是一个相关问题。

起初，当我创建非文件夹内容类型时，锚链接正常工作。但是在我将其转换为文件夹容器类型后，锚链接行为发生了变化。

在看到 Cris 的回答后，我相信基本标签会根据内容的类型而改变，如果它是文件夹的话。然而导航链接（例如在portlet 导航树中）却没有。这限制了锚链的使用。

已经为此提交了[一张票，解决方案似乎是在 plone 5.0 中完全删除基本标签。](https://dev.plone.org/ticket/13705)

对于克隆 4.3.3。我只能想到在我的文件夹内容类型的模板中使用绝对网址作为锚链接。

```
<a tal:attributes="href string:${context/absolute_url}#anchor">My Anchor</a> 
```

# html - 更改背景图像和 a:li 的悬停颜色

> ID：10098334
> 
> 赞同：2
> 
> 时间：2012-04-11T00:30:20.477
> 
> 标签：html, css

我有这个菜单架构：

```
<nav>
    <ul>
        <li><a href="index.asp">home</a></li>
        <li><a href="colecao.asp">coleção</a></li>
        <li><a href="tecnologia.asp">downloads</a></li>
        <li><a href="contato.asp">contato</a></li>
    </ul>
</nav> 
```

我的 LI 是`float:left`这样的，它是并排的。我想当我悬停`a:hover`我的背景 LI 时，颜色会发生变化。

看到这个小提琴：http: [//jsfiddle.net/56wUm/](http://jsfiddle.net/56wUm/)

如果您只将鼠标悬停在 上`li`，则链接不起作用并且`a`不改变颜色！

求帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T03:44:23.250

如果您仍然需要帮助，我建议将填充添加到 css 中的 a 元素而不是 li。例如这样的：http: [//jsfiddle.net/MGRBS/2/](http://jsfiddle.net/MGRBS/2/)

这样链接就占据了整个块空间，祝你好运。:D

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T00:36:25.293

您应该更喜欢使用 CSS Sprites 来实现这一点。参考这些链接

[视频链接](http://www.from-the-couch.com/post.cfm/title/how-to-use-css-sprites)

[http://css-tricks.com/css-sprites/](http://css-tricks.com/css-sprites/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T00:38:15.720

要准确修复正在发生的事情，您需要稍微更改 a:hover 规则：

```
ul li:hover a { color: #fff } 
```

见：http: [//jsfiddle.net/56wUm/4/](http://jsfiddle.net/56wUm/4/)

但是，就可用性而言，我认为您最好让链接占据所有菜单空间，从而形成一个大目标。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T00:40:43.507

您想将一些 CSS 从 A 移动到 LI。目标是让 A 与 LI 直接对接，因此没有差距。您只想将 LI 用于其浮动属性，将它们视为 TABLE 中的 TD。他们不应该有自己的真正风格。

# css - jwebunit 检查 CSS 样式

> ID：10098337
> 
> 赞同：-1
> 
> 时间：2012-04-11T00:30:24.703
> 
> 标签：css, junit, jwebunit

我正在尝试断言 div 的当前样式。例如，它是否设置为可见。不过，我无法在 jwebunit 中找到获取此信息的方法。想法？替代方法？

约束：我无法更改要测试的页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T03:39:23.367

有两个 TestEngine 可以与 JWebUnit、HTMLUnit 和 Selenium 一起使用。为什么不 System.out.println("========="+ getPageSource()); 并查看来自两个 TestEngines 的页面源返回是否在输出中提供 css。如果他们这样做意味着您可以验证 css，如果输出没有给出 css，那么我猜您将无法验证。我肯定知道的一件事是，它会向您显示页面用于样式的 css 文件，但至于所应用的样式，我会说不是，但试试看

# ios - 设置 tableView selectRowAtIndexPath 的滚动速度：

> ID：10098339
> 
> 赞同：2
> 
> 时间：2012-04-11T00:30:39.220
> 
> 标签：ios, uitableview

使用`[myTableView selectRowAtIndexPath:...]`滚动到某个表视图滚动视图太快而无法被视为滚动动作，即使通过`animated:YES`. 设置`tableView.decelerationRate`似乎并没有改变它滚动的速度。

有没有办法在不编写自定义动画的情况下减慢滚动速度？如果是这样，有没有办法在调用另一个动作之前确保滚动已经完成？我想`didSelectRowAtIndexPath`在它滚动后打电话，但直到它完成滚动。

# iphone - iphone - 如何为 NSMutableURLRequest GET 方法制作 JSON 数据

> ID：10098340
> 
> 赞同：0
> 
> 时间：2012-04-11T00:30:42.243
> 
> 标签：iphone, json, get, httprequest, nsmutableurlrequest

我正在使用 JSONKit.h、JSONKit.m、ios5.1。

我也尝试使用 GET 方法和 POST 发送数据，但我的 django 服务器出错了。

我的代码错了吗？

这是我的代码。

```
NSString *myid = @"myidddd";
NSString *mypw = @"mypwwww";
NSArray *objects = [NSArray arrayWithObjects:myid,mypw, nil];
NSArray *keys = [NSArray arrayWithObjects:@"id", @"pw", nil];
NSDictionary *dic = [NSDictionary dictionaryWithObjects:objects forKeys:keys];

NSString *jsonInfo = [dic JSONString];
NSData *jsonData = [jsonInfo dataUsingEncoding:NSUTF8StringEncoding];
NSMutableURLRequest* request = [[NSMutableURLRequest alloc] initWithURL:[[NSURL alloc] initWithString:@"http://www.scg.com:8000/post"]];
[request setHTTPMethod:@"GET"];
[request setValue:@"application/json" forHTTPHeaderField:@"Accept"];
[request setValue:@"application/json" forHTTPHeaderField:@"Content-Type"];
[request setValue:[NSString stringWithFormat:@"%d", [jsonData length]] forHTTPHeaderField:@"Content-Length"];
[request setHTTPBody:jsonData];
[NSURLConnection sendAsynchronousRequest:request queue:[NSOperationQueue mainQueue] completionHandler:^(NSURLResponse *res, NSData *data, NSError *err){
    [self didReceiveData:data];
}]; 
```

我的 django 服务器收到数据时出错，

raceback（最近一次调用最后）：文件“/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/wsgiref/handlers.py”，第86行，运行self.finish_response（）文件“/Library /Frameworks/Python.framework/Versions/2.7/lib/python2.7/wsgiref/handlers.py”，第 127 行，finish_response Traceback（最近一次调用最后一次）：self.write（data）文件“/Library/Frameworks/ Python.framework/Versions/2.7/lib/python2.7/wsgiref/handlers.py”，第 86 行，在运行 self.finish_response() 文件“/Library/Frameworks/Python.framework/Versions/2.7/lib/python2\. 7/wsgiref/handlers.py”，第 210 行，写入 self.send_headers() 文件“/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/wsgiref/handlers.py”，第 268 行，在 send_headers 文件“/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/wsgiref/handlers.py”，第 127 行，在 finish_response self.send_preamble() self.write(data) 文件“/Library/Frameworks/Python.framework/Versions/2.7/lib/python2\. 7/wsgiref/handlers.py”，第 210 行，写入 self.send_headers() 文件“/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/wsgiref/handlers.py”，第 268 行，在 send_headers 文件“/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/wsgiref/handlers.py”中，第 192 行，在 send_preamble self.send_preamble() 文件中“/Library/Frameworks/Python.framework /Versions/2.7/lib/python2.7/wsgiref/handlers.py"，第 192 行，在 send_preamble 'Date: %s\r\n' % format_date_time(time.time()) 回溯（最近一次通话最后）： '日期：%s\r\n' % format_date_time(time.time()) 文件 "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/socket.py”，第 324 行，写入文件“/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/ wsgiref/handlers.py”，第 86 行，运行 self.flush() 文件“/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/socket.py”，第 303 行，刷新自我。 _sock.sendall(view[write_offset:write_offset+buffer_size])

## 错误：[Errno 32] 管道损坏

处理来自 ('127.0.0.1', 54842) 的请求时发生异常 Traceback（最近一次调用最后一次）：文件“/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/SocketServer.py”，第 582 行，在 process_request_thread self.finish_request(request, client_address) 文件 "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/SocketServer.py"，第 323 行，在 finish_request self.RequestHandlerClass(request, client_address, self) 文件“/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/core/servers/basehttp.py”，第 139 行，在**init** super(WSGIRequestHandler, self ）。**init** (*args, **kwargs) 文件“/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/SocketServer.py”，第 641 行， **self.finish() 文件“/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/SocketServer.py”，第 694 行，在完成 self.wfile.flush() 文件“/Library/Frameworks/ Python.framework/Versions/2.7/lib/python2.7/socket.py"，第 303 行，刷新 self._sock.sendall(view[write_offset:write_offset+buffer_size])**

 **## 错误：[Errno 32] 管道损坏

```
self.finish_response() 
```

文件“/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/wsgiref/handlers.py”，第 127 行，finish_response self.write(data) 文件“/Library/Frameworks/Python.framework/ Versions/2.7/lib/python2.7/wsgiref/handlers.py”，第 210 行，写入 self.send_headers() 文件“/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/wsgiref/ handlers.py”，第 268 行，在 send_headers 文件“/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/socket.py”，第 324 行，写入 self.flush() 文件“/Library /Frameworks/Python.framework/Versions/2.7/lib/python2.7/socket.py"，第 303 行，刷新 self._sock.sendall(view[write_offset:write_offset+buffer_size])

## 错误：[Errno 32] 管道损坏

处理来自 ('127.0.0.1', 54843) 的请求时发生异常 Traceback（最近一次调用最后一次）：文件“/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/SocketServer.py”，第 582 行，在 process_request_thread self.finish_request(request, client_address) 文件 "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/SocketServer.py"，第 323 行，在 finish_request self.RequestHandlerClass(request, client_address, self) 文件“/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/core/servers/basehttp.py”，第 139 行，在**init** super(WSGIRequestHandler, self ）。**init** (*args, **kwargs) 文件“/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/SocketServer.py”，第 641 行， **self.finish() 文件“/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/SocketServer.py”，第 694 行，在完成 self.wfile.flush() 文件“/Library/Frameworks/ Python.framework/Versions/2.7/lib/python2.7/socket.py"，第 303 行，刷新 self._sock.sendall(view[write_offset:write_offset+buffer_size])**

 **## 错误：[Errno 32] 管道损坏

```
self.send_preamble() 
```

文件“/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/wsgiref/handlers.py”，第 192 行，在 send_preamble 'Date: %s\r\n' % format_date_time(time.time( )) 文件“/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/socket.py”，第 324 行，写入 self.flush() 文件“/Library/Frameworks/Python.framework/Versions /2.7/lib/python2.7/socket.py"，第 303 行，刷新 self._sock.sendall(view[write_offset:write_offset+buffer_size])

## 错误：[Errno 32] 管道损坏

处理来自 ('127.0.0.1', 54844) 的请求时发生异常 Traceback（最近一次调用最后一次）：文件“/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/SocketServer.py”，第 582 行，在 process_request_thread self.finish_request(request, client_address) 文件 "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/SocketServer.py"，第 323 行，在 finish_request self.RequestHandlerClass(request, client_address, self) 文件“/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/core/servers/basehttp.py”，第 139 行，在**init** super(WSGIRequestHandler, self ）。**init** (*args, **kwargs) 文件“/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/SocketServer.py”，第 641 行， **self.finish() 文件“/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/SocketServer.py”，第 694 行，在完成 self.wfile.flush() 文件“/Library/Frameworks/ Python.framework/Versions/2.7/lib/python2.7/socket.py"，第 303 行，刷新 self._sock.sendall(view[write_offset:write_offset+buffer_size])**

 **## 错误：[Errno 32] 管道损坏

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T03:45:15.577

自答。

GET 方法不能将数据包含到 http 正文中。只能使用 POST 方法。

要使用 GET 方法发送一些信息，请使用扩展请求 URL，例如：

```
"?%@=%@", key, value 
```

这是示例网址：

```
http://www.somedomain.com/?name=username&pw=password 
```******

# python - 截断作为路径的字符串的 filname 部分。

> ID：10098351
> 
> 赞同：2
> 
> 时间：2012-04-11T00:31:55.093
> 
> 标签：python

我在下面发布了一个示例和所需的结果。我看到了许多消除文件路径部分的方法，但反之亦然

**例子 。**

```
sample = "/tmp/test/helloworld.cpp"
sample = truncate_file_name(sample)
Print sample 
```

**期望的结果**

```
/tmp/test 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-11T00:34:01.593

使用这些`os.path`函数来做这样的事情：

```
>>> import os
>>> os.path.split("/tmp/test/helloworld.cpp")
('/tmp/test', 'helloworld.cpp') 
```

另请参见`os.path.splitext()`、`os.path.splitdrive()`等。换一种方式，用它`os.path.join()`来*构建*路径——它总是为你的操作系统做正确的事情。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-11T00:37:13.463

`os.path`提供[`dirname`功能](http://docs.python.org/library/os.path.html#os.path.dirname)：

```
>>> from os.path import dirname
>>> dirname("/tmp/test/helloworld.cpp")
'/tmp/test' 
```

# python - 打印页面生成时间

> ID：10098357
> 
> 赞同：0
> 
> 时间：2012-04-11T00:32:44.633
> 
> 标签：python, django

我将如何打印在 django 中将页面呈现到我的网站底部所花费的时间？我不确定 django 的应用程序流程，所以我不知道它是如何工作的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T01:54:27.450

你可能对[django-debug-toolbar](https://github.com/django-debug-toolbar/django-debug-toolbar)感兴趣，它包括一个请求计时器和许多其他有用的信息来调试这样的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T00:52:13.583

在视图处理程序的开头，将当前日期/时间保存在变量 say 中`time_start`，并将其传递给呈现页面的模板上下文。

然后定义一个自定义模板过滤器，它将`timedelta`根据`datetime.now()`值和作为参数传入的原始日期时间创建，如下所示：

```
from datetime import datetime
from django import template

register = template.Library()

@register.filter
def get_elapsed(time_start):
    return str(datetime.now() - time_start) 
```

然后在您的模板中，简单地显示：

```
...
{{ time_start|get_elapsed }}
... 
```

# android - iOS & android 上的 AS3 加载屏幕

> ID：10098358
> 
> 赞同：0
> 
> 时间：2012-04-11T00:32:50.367
> 
> 标签：android, ios, actionscript-3, flash, air

我正在使用 Flash Professional CS5.5 构建一个图书应用程序以在平板设备上发布，并且我正在尝试了解加载应用程序的最佳结构。对于 iOS 设备，我知道我可以包含 default.png，但如何为 Android 完成类似的任务？图书应用程序也将很大，因为它包含大量资产和动画，有没有一种好方法可以表明这是在两个平台上加载的？

我正在尝试的一件事是加载屏幕，其中主应用程序实际上是一个加载系统，可以导入已编译的 SWF 书，但进一步的研究表明它不适用于 iOS 设备。

感谢您提供任何提示或指示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T20:26:13.927

好吧，最后，我正在为 iOS 开发主应用程序本身并使用 Default.png 将其导出。然后，Android 版本是一个较小的闪屏/预加载器应用程序，它将加载 iOS 应用程序的 SWF 版本。这是正确的做法吗？可能不是，但这是我在阅读了太多关于这个概念的文章后得出的结论。

# php - PHP 退出、返回和正确的编程标准

> ID：10098360
> 
> 赞同：1
> 
> 时间：2012-04-11T00:33:22.163
> 
> 标签：php, standards, return, exit

是否可以包含一个 break 或 exit 命令来防止进一步的代码执行，或者这是一个糟糕的编程？

```
function index()
{
  $error = NULL;

  if ($_POST){

     // validate form
    if ($form_validated) {
        echo 'this content only';
        exit;    // or return         IS THIS BAD???
    } else {
        $error = 'form failed';
    }
 }  
  echo 'normal page on initial load';
  if ($error) { echo '<br />'.$error; }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T01:41:44.217

可以使用`exit`.

话虽如此，在这个特定的例子中这是否是最好的方法是有争议的。`exit`发出重定向时通常使用：

```
header('Location: /foo');
exit; 
```

在您的情况下，似乎不需要立即在运行中停止程序执行。您应该构建您的程序流程，使其始终完成，但结果不同。很难遵循可能在中间某处终止的程序逻辑，因此通常最好`return`使用来自函数或分支的更具逻辑性的流程。`if..else`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T10:52:33.317

对于您给出的示例：

```
function index()
{
  ...
    if ($form_validated) {
        echo 'this content only';
        exit;    // or return         IS THIS BAD???
    } else {
  ...
} 
```

这通常称为*提前退出*或*提前返回*（返回更常见）。这可能很好，有人说早期返回使代码难以理解，但我想说这取决于一个函数是否易于阅读和理解。

所以决定这里好坏的人是你。您需要自己找到一些标准来划定界限。例如，如果一个函数很长（超过 12 行代码）并且包含许多这些提前返回甚至退出，这将使代码更加复杂。

通常，提前返回可以使函数代码不那么复杂，从而大大减少错误的数量。

所以[这里的复杂性可能是一个很好的标准](http://phpmd.org/rules/codesize.html)。

另外，我建议您`exit`非常小心地使用。它一次完成很多工作，您通常在程序流程中不需要它。特别是如果您正在编写业务逻辑。

# java - 将 env 特定属性传递到 webapp

> ID：10098363
> 
> 赞同：0
> 
> 时间：2012-04-11T00:34:21.373
> 
> 标签：java, web-services, tomcat, deployment

我们正在为我们的 webapp 寻找我们的持续集成系统的部署选项。我们正在构建一个 .war 文件。我们需要将它部署到几个不同的环境中（例如 DEV、QA、STAGE 等）。AFAIK，有两种方法可以传入 env 特定属性：

首先，在启动 Tomcat 时使用 -D 选项：

```
-Denv=DEV 
```

这需要我们`catalina.sh`为每个环境定制脚本。

二、启动Tomcat前使用环境变量：

```
export env=DEV; 
```

这需要我们调整每个环境的部署脚本。这取决于平台（即在 Windows 上您必须这样做`set env=DEV`）。

谁能告诉我这两个选项哪个更好？或者还有其他更好的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T01:12:04.543

我们有一个部署到 14 个不同环境中的 Web 应用程序。为了管理这一点，我们为每个环境创建了一个独特的构建。

我们使用 maven 作为构建系统，因此每个环境都有一个独特的配置文件。该配置文件引用了一个用于过滤的属性文件，其中包含因环境而异的配置。此信息被标记为 Spring 上下文文件、web.xml、weblogic.xml 等。（我们不过滤源文件，因为这会很快变得丑陋。）

第二部分是我们的 Jenkins CI 服务器。对于每个环境，我们都有一个引用相应配置文件的工作。这指向了我们的 subversion repo 中一个众所周知的标签名称。所以流程是这样的：

1.  开发发生并且代码提交到主干。
2.  需要构建到一些环境中，所以我们创建一个名为“最新”的标签（如果存在旧副本，则删除它们）。同时，我们还创建了一个带有日期时间戳的标签，但这是可选的。
3.  启动适当的哈德逊构建。这意味着我们不会构建一些开发人员工作站，并且构建已经配置，所以没有什么要记住的。
4.  从 Jenkins 中拉出要部署的工件。

我已经看到应用程序服务器本身维护了应用程序配置，但除非你有像[glu](http://linkedin.github.com/glu/docs/latest/html/index.html)这样的东西来管理事物，否则它很快就会成为维护的噩梦。如果您有不同的开发和运营团队，则尤其如此。

# ruby - 在编译和 JIT 模式下在 JRuby 中使用 `require`

> ID：10098364
> 
> 赞同：0
> 
> 时间：2012-04-11T00:34:25.237
> 
> 标签：ruby, jvm, jruby

我有以下结构：

```
 lib/cf.jar
 lib/modules/basic_server.rb
 examples/server.rb 
```

**lib/modules/basic_server.rb：**

```
require 'java'

require(File.join(File.dirname(__FILE__), '..', 'cf.jar'))

module Cf
  import 'ch.ethz.inf.vs.californium.coap'
  import 'ch.ethz.inf.vs.californium.endpoint'
  import 'ch.ethz.inf.vs.californium.examples.resources'
  import 'ch.ethz.inf.vs.californium.util'
end 
```

**示例/server.rb:** 要求（File.join(File.dirname( **FILE** ), '..', 'lib', 'modules', 'basic_server'))

```
class ExampleServer
  def initialize
    # Create the logger
    Cf::Log.init();
    # Create the endpoints container
    @ep = Cf::LocalEndpoint.new
    # Add a few basic endpoints
    @ep.addResource(Cf::HelloWorldResource.new)
    @ep.addResource(Cf::ZurichWeatherResource.new)
  end
end

srv = ExampleServer.new 
```

当我使用命令运行它时一切正常`jruby`，但是当我尝试编译它`jrubyc`然后运行时`java -cp .:$JRUBY_JAR examples/server`给我这个错误：

```
Exception in thread "main" org.jruby.exceptions.RaiseException: (LoadError) no such file to load -- file:/opt/devel/src/projects/californium-jruby.git/examples/../lib/modules/basic_server 
```

所以我看到使用`File.dirname(__FILE__)`可能是错误的。

为了进行健全性检查，我尝试连接代码并且它有效，尽管它似乎对我来说不是一个解决方案。我如何`require()`在 JRuby 中？

在写这篇文章时，我发现任何使用相对路径都不起作用，而起作用的是：

**lib/modules/basic_server.rb：**

```
require 'java'
require 'lib/cf.jar'
# .... 
```

**示例/server.rb：**

```
require 'lib/modules/basic_server'
# .... 
```

编译一个 JAR 得到了一个可行的解决方案。但是，现在 - 我如何在两种行为之间切换？

我可以跑`jruby examples/server.rb`，我不能跑`cd examples; jruby server.rb`，这还不算太糟糕，但是，有人已经解决了这个问题吗？

顺便说一句，像这样的 hack 是有效的：

```
if (File.dirname(__FILE__).split(':')[0] == 'jar') then
  require(File.join('lib', 'modules', 'basic_server'))
else
  require(File.join(File.dirname(__FILE__), '..', 'lib', 'modules', 'basic_server'))
end 
```

但它相当丑陋。

# jquery - 为什么 jQuery 不提供 .firstChild 方法？

> ID：10098367
> 
> 赞同：16
> 
> 时间：2012-04-11T00:34:44.627
> 
> 标签：jquery, performance, jquery-selectors

我已经看到很多关于使用 jQuery 选择第一个子元素的最快方法的讨论。正如所料，原生 DOM 的 firstChild 属性比使用 jQuery 选择器或选择器组合要快得多——请参阅[http://jsperf.com/jquery-first-child-selection-performance/6](http://jsperf.com/jquery-first-child-selection-performance/6)。这通常不是问题——要么它被用在性能不是什么大问题的地方，要么它很容易访问 DOM 元素并使用它的 .firstChild 属性。但是，这样做有几个问题：

*   firstChild 可以返回文本或注释节点，而不是元素，因为 jQuery 选择器将返回
*   如果我需要选择多个元素的第一个子元素，我必须要么使用慢速选择器，要么进行大量额外的工作来迭代 DOM 元素，将它们添加到集合中，然后将它们放回 jQuery 对象中。

在我看来，将 firstChild 方法添加到核心 jQuery 库的成本将远远小于收益。我自己尝试创建这样一种方法供我自己使用：

```
$.fn.firstChild = function() {
    var ret = [];

    this.each(function() {
        var el = this.firstChild;

        //the DOM firstChild property could return a text node or comment instead of an element
        while (el && el.nodeType != 1)
            el = el.nextSibling;

        if (el) ret.push(el);
    });

    //maintain jQuery chaining and end() functionality
    return this.pushStack(ret);
}; 
```

在我在[http://jsperf.com/jquery-multiple-first-child-selection](http://jsperf.com/jquery-multiple-first-child-selection)创建的测试中，此函数的执行速度比任何其他选项快五倍以上。这些测试基于上面提到的测试，但是选择多个元素的第一个子元素，而不是单个元素。

有什么我想念的吗？我应该使用的技术？或者这是一个永远不应该担心的问题？有没有理由不在 jQuery 中包含这样的函数？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-11T01:38:49.133

> *“为什么 jQuery 不提供 .firstChild 方法？”*

功能蠕变，很可能。

正如您所说，它可以使用其他方法来完成，如果性能是一个问题，您可以按照您所做的那样扩展 jQuery 以满足该特定需求。

* * *

您可以进一步提高代码的性能...

```
$.fn.firstChild = function () {
    var ret = [];
    // use a for loop
    for (var i = 0, len = this.length; i < len; i++) {
        var this_el = this[i],
            el = this_el.firstElementChild; // try firstElementChild first
        if (!el) {
            el = this_el.firstChild;
            while (el && el.nodeType != 1)
                el = el.nextSibling;
        }
        if (el) ret.push(el);
    }
    //maintain jQuery chaining and end() functionality
    return this.pushStack(ret);
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T01:59:51.513

对于单元素情况，您可以使用

```
$('.test > eq(0)') 
```

这似乎几乎与你的速度相匹配..

[http://jsperf.com/jquery-multiple-first-child-selection/2](http://jsperf.com/jquery-multiple-first-child-selection/2)

# encryption - 加密患者数据

> ID：10098368
> 
> 赞同：4
> 
> 时间：2012-04-11T00:34:49.260
> 
> 标签：encryption, privacy, multi-user, key-management

我将使用 AES_ENCRYPT() 和 AES_DECRYPT 将患者数据存储在 EMR 系统中，我想知道如何存储密钥。我需要能够允许授权用户访问该密钥，以便解密和读取存储在患者记录中的数据。我怎样才能轻松地与许多用户共享密钥，但又要保证该密钥的安全。任何想法或例子表示赞赏。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-11T00:50:53.260

执行此操作的标准方法是为每位患者创建一个“系统”密钥，并使用该密钥加密该患者的数据。 **不要与患者或任何用户共享该密钥。**

当用户在系统中注册时，使用密码为该用户创建一个“用户”密钥。（例如，取用户密码的 SHA-256 哈希值。） **不要将用户密码存储**在系统上。

然后，当用户被授权访问患者的数据时，使用授权用户的密钥对该患者的系统密钥进行加密，并将加密的密钥保存在用户的帐户中。如果用户被授权访问其他患者的记录，请为每个患者的系统密钥重复此过程。

最后，当授权用户想要访问患者的数据时，他/她输入他或她自己的密码，该密码用于解密患者的系统密钥，而系统密钥又用于解密患者的数据。

当用户想要更改他/她的密码时，您必须解密与该帐户关联的每个系统密钥，然后使用新密码重新加密它们。

* * *

免责声明：**安全是硬的^***我不是密码学家。此外，法律可能要求根据某些标准对患者数据进行加密和保护。在实施*任何*安全系统之前，请咨询专家，并且*在任何情况下都不要创建自己的安全方案*，尤其是在涉及财务、医疗或其他关键信息的情况下。

^* [Bruce Schneier](http://www.schneier.com/about.html)，[BT首席安全技术官](http://www.bt.com/)

# apache - Apache .htaccess，url 重写问题

> ID：10098370
> 
> 赞同：2
> 
> 时间：2012-04-11T00:35:03.417
> 
> 标签：apache, .htaccess, https, fastcgi

我将我的 python flask web 应用程序托管到了fluxflex 云托管（Apache、FastCGI）。因此，.htaccess 文件如下所示：

```
RewriteEngine On
AddHandler fcgid-script .fcgi
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*)$ /dispatch.fcgi/$1 [QSA,L] 
```

有用。现在我想从 http 重定向到 https。我怎样才能做到这一点？在 .htaccess 末尾添加以下两行：

```
RewriteCond %{HTTP:X-Forwarded-Proto} !https
RewriteRule .* https://%{HTTP_HOST}%{REQUEST_URI} [R,L] 
```

但是，得到响应：错误 310 (net::ERR_TOO_MANY_REDIRECTS)。如果我在第一次重写之前插入这两行，响应是：找不到页面。

有人可以告诉我重定向到 https 的正确方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-03-18T15:31:38.967

在 fcgi 调用之前添加一个重定向到 https 的规则 此重定向必须仅在请求 http 时发生：

我的 .htaccess 看起来像这样：

```
Options -Indexes +FollowSymLinks +ExecCGI
<IfModule mod_fcgid.c>
        AddHandler cgi-script .fcgi
        RewriteEngine On

        #redirect to https if http, notice the L tag
        #it will break the rule processing and trigger the redirection        
        RewriteCond %{HTTPS} !=on
        RewriteRule ^(.*)$ https://${HTTP_HOST}/$1 [R,QSA,L]

        #handle the request (must be https at this point)
        RewriteCond %{REQUEST_FILENAME} !-f
        RewriteRule ^(.*)$ dispatch.fcgi/$1 [QSA,L]
</IfModule> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T02:50:24.523

你想使用`%{HTTPS}`变量：

```
RewriteCond %{HTTPS} off
RewriteRule .* https://%{HTTP_HOST}%{REQUEST_URI} [R,L] 
```

# delphi - 如何在保持组件可见的同时使表单透明？

> ID：10098374
> 
> 赞同：11
> 
> 时间：2012-04-11T00:35:36.260
> 
> 标签：delphi, transparency, transparent-control

![](../Images/a9e61d28d0862940440ef6a2a7ab7055.png)

我需要制作一种包含透明区域的PNG图像的程序。表单必须是不可见的，而图像必须保持可见，透明区域必须保持透明。问题是图像透明度。在这种情况下，主窗体是透明的、不可见的，而所有组件/控件都保持可见。但是，PNG 图像的透明区域不保持透明度。如何保持透明度？

```
 procedure MakeTransparent;
   var
   AControl: TControl;
   A, Margin, X, Y, CtlX, CtlY: Integer;
   begin
     Margin    := (Width - ClientWidth) div 2;
     FullRgn   := CreateRectRgn(0, 0, Width, Height);
     X         := Margin;
     Y         := Height - ClientHeight - Margin;
   ClientRgn := CreateRectRgn(X, Y, X + ClientWidth, Y + ClientHeight);
   CombineRgn(FullRgn, FullRgn, ClientRgn, RGN_DIFF);
   for A := 0 to ControlCount - 1 do
   begin
    AControl := Controls[A];
    if (AControl is TWinControl) or (AControl is TGraphicControl) then with        AControl do
   begin
    if Visible then
    begin
      CtlX   := X + Left;
      CtlY   := Y + Top;
      CtlRgn := CreateRectRgn(CtlX, CtlY, CtlX + Width, CtlY + Height);
      CombineRgn(FullRgn, FullRgn, CtlRgn, RGN_OR);
    end;
  end;
  end;
  SetWindowRgn(Handle, FullRgn, True);
  end;

  procedure UndoTransparency;
  begin
   FullRgn := CreateRectRgn(0, 0, Width, Height);
   CombineRgn(FullRgn, FullRgn, FullRgn, RGN_COPY);
   SetWindowRgn(Handle, FullRgn, True);
  end; 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-11T02:20:27.287

只需在您的表单中使用按钮删除此代码，您就会看到您的表单与您的 PNG 变得透明：

```
procedure SetTransparent(Aform: TForm; AValue: Boolean);
begin
  Aform.TransparentColor := AValue;
  Aform.TransparentColorValue := Aform.Color;
end;

procedure TForm2.Button1Click(Sender: TObject);
begin
  SetTransparent(Self, True);
end; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-11T08:46:54.553

如果您需要部分透明度，那么 TransparentColor/TransparentColorValue 将无济于事。

对于 NonAero（或 DisabledAero）和 EnabledAero 情况，您将需要使用两种完全不同的方法。

启用 Aero 后，您将不得不使用此类方法：[http ://delphihaven.wordpress.com/category/glass/](http://delphihaven.wordpress.com/category/glass/)

当 Aero 被禁用或不存在时，您将不得不使用某种 hack：

1.  设置 AlphaBlend := True;
2.  通过 BitBlt+GetDC+GetDesktopWindow 制作桌面截图。您的窗口不会出现在该屏幕截图上。
3.  在与表单位置和大小相同的屏幕截图的表单部分上绘制。实际上，您将绘制表单后面的任何内容，这就是为什么它看起来像透明的原因。
4.  定期重复动作 2 和 3。

# functional-programming - 如何在功能上处理来自外部系统的状态？

> ID：10098386
> 
> 赞同：5
> 
> 时间：2012-04-11T00:37:06.297
> 
> 标签：functional-programming, referential-transparency, architectural-patterns

我最近接触了函数式编程，并且学会了几种以引用透明的方式处理某些副作用的方法：

*   用于可变状态[的 State monad ，例如更新变量](http://apocalisp.wordpress.com/2011/03/20/towards-an-effect-system-in-scala-part-1)
*   [用于 I/O的 IO monad](http://james-iry.blogspot.com/2007/11/monads-are-elephants-part-4.html)，例如从控制台读取/写入到控制台
*   用于图形和输入设备事件等交互性的[FRP](http://flapjax-lang.org)

但是现在大多数“现实世界”应用程序都与外部系统（如 Web 服务、数据库等）交互，这些系统可以由多个用户同时修改，它们具有状态、长时间运行的操作等。所以情况并不那么简单与上述类别一样：向系统询问实体的状态或试图控制它的结果取决于其状态。此外，交互性也是一个要求：有一些用户可以任意点击的 GUI，也许我们还必须自动响应来自系统的变化。

通过最大化纯函数的好处来设计和实现这类应用程序的模式是什么？或者上述一些方法可以以我没有想到的方式应用于这个问题吗？该语言（比如 Java 或 Scala）并不强制要求 100% 的纯度，所以我对实践经验支持的实用解决方案感兴趣。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T02:09:06.757

我还没有做很多这种实际上以实际方式完成的事情，所以其他人希望能够做得更多。然而，我已经用 Scala 编写了一个 Android 应用程序，它有你的几个要求；UI 是交互式的，“状态”全部存储在 SQLite 数据库中。数据库和 UI 都需要与 Android 框架交互，这些框架非常面向 Java，因此不太适合 Scala 或函数式编程。

我所做的是采用类似于 MVC 设计的东西，其中模型部分被实现为一组仅支持纯操作的 ADT。这还有一个额外的优势，即模型代码完全独立于 Android 框架，因此可以在模拟器之外以我喜欢的任何方式对其进行测试。

这给我留下了控制器（视图是一个非常薄的层，主要是配置，Android 的工作方式），加上“从数据库加载模型”和“将模型保存到数据库”的附加操作。作为 Scala，我只是用不纯代码实现了这些部分，这些代码调用纯模型代码来进行实际的数据操作。在 Haskell 中，这些部分可能完全在 IO monad[1] 中。

总而言之，这让我能够以纯粹的功能性术语来思考我的问题域，而不必在与外部系统交互时“违背常规”。数据库层变成了数据库模式和我用于数据模型的 ADT 之间的映射问题；处理这些操作可能失败的事实是控制器（启动数据库操作）的责任，并且不会影响模型。控制器操作在概念上变得非常简单，例如“按下此按钮时，将当前状态设置为在当前状态上调用函数的结果，然后更新显示表”。最后，这种不纯的“胶水”代码比实际的模型代码要多得多，但我仍然认为以这种方式编写程序是一种胜利，因为我的应用程序的核心是处理复杂的结构化数据，所以要做到这一点是最棘手的。其余的主要是编写乏味而不是难以设计。

当您的程序中有大量计算（不一定是大量*数据*，只是您实际在其上进行计算）时，这将起作用。如果该程序几乎完全将不同的外部系统粘合在一起，那么您不一定有那么多收获。

* * *

[1] 请记住，IO monad 不仅仅用于从控制台读取/写入。结果受程序外部状态影响的建模操作正是 IO monad 的**用途**；通常，如果 IO monad 不是一直与外部系统交互（或者最好即使是），Haskellers 会尽量避免在几乎整个程序中使用 IO monad。您可以对数据进行纯计算以响应来自“外部”的事件，或者甚至对需要执行以响应外部事件的 IO 操作进行纯计算，如果这很复杂的话**。**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T15:37:13.963

> 但是现在大多数“现实世界”应用程序都与外部系统（如 Web 服务、数据库等）交互，这些系统可以由多个用户同时修改，它们具有状态、长时间运行的操作等。所以情况并不那么简单与上述类别一样：向系统询问实体的状态或试图控制它的结果取决于其状态。此外，交互性也是一个要求：有一些用户可以任意点击的 GUI，也许我们还必须自动响应来自系统的变化。

交互地，同时编辑共享状态只是状态单子的另一个例子。您可能会使用镜头或其他一些抽象来对数据结构进行编辑，但在引擎盖下，您所拥有的只是一个共享的全局状态。

如果您想要机器级别的并发支持，您可以使用并发结构（例如 STM var 或 MVar ）来解决并发编辑的冲突。这意味着您将处于 STM 或 IO monad 中。

在 Hackage 和 Haskell 包中，有许多为此类作业设计的单子环境示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T16:13:02.720

[异步流](http://queue.acm.org/detail.cfm?id=2169076)又名[迭代](http://www.playframework.org/documentation/2.0/Iteratees)似乎是一个有用且相关的抽象，似乎值得进一步探索它们......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-10-27T22:25:41.000

> 我对实践经验支持的务实解决方案感兴趣。

GHC 用来提供不同标识符的[`Unique`](https://gitlab.haskell.org/ghc/ghc/-/wikis/commentary/compiler/unique)类型可能会让您感兴趣 - 基于相同方法的教学实施可以在John Launchbury 和 Simon Peyton Jones[在 Haskell 的 State 的第 39-41 页上找到。](https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.52.3656&rep=rep1&type=pdf)这种方法可以追溯到 F. Warren Burton 的[Nondeterminism with Referential Transparency in Functional Programming Languages](https://academic.oup.com/comjnl/article-pdf/31/3/243/1157325/310243.pdf)，其中还简要描述了使用*伪数据*在运行时访问信息以提供`timestamp`和`spacestamp`值。

既然你提到`IO`：

```
 -- abstract; single-use I/O source
data Exterior
getchar :: Exterior -> Char
putchar :: Char -> Exterior -> ()

 -- from section 2 of Burton's paper
data Tree a = Node { contents :: a,
                     left     :: Tree a,
                     right    :: Tree a }

 -- utility definitions
type OI  =  Tree Exterior

getChar' :: OI -> Char
getChar' =  getchar . contents

putChar' :: Char -> OI -> ()
putChar' c = putchar c . contents

part     :: OI -> (OI, OI)
parts    :: OI -> [OI]

part t   =  (left t, right t)
parts t  =  let !(t1, t2) = part t in
            t1 : parts t2 
```

现在定义 Philip Wadler 的[How to Declare an Imperative](https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.91.3579&rep=rep1&type=pdf)中的运行示例：

```
echo     :: OI -> ()
echo t   =  let !(t1:t2:t3:_) = parts t in
            let !c = getChar' t1 in
            if c == '\n' then
               ()
            else
               let !_ = putChar' c t2 in
               echo t3 
```

连同`IO`：

```
type IO a = OI -> a

unit     :: a -> IO a
unit x   =  \ t -> let !_ = part t in x

bind     :: IO a -> (a -> IO b) -> IO b
bind m k =  \ t -> let !(t1, t2) = part t
                       !x = m t1
                       !y = k x t2
                   in y  

{-
  getChar' :: IO Char
  putChar' :: Char -> IO ()
  echo     :: IO ()
-} 
```

# java - 迭代器泛型，不能声明类型不匹配的迭代器（可能是转换问题）

> ID：10098391
> 
> 赞同：0
> 
> 时间：2012-04-11T00:37:44.353
> 
> 标签：java, generics, iterator

我有这个简单的代码

```
public String toString() {

   **Iterator it = list.iterator();**
   String s;

   while(it.hasNext()){

     s = s + " " + Integer.toString(it.next());

   }
   System.out.println(s);

 // IMPLEMENT THIS METHOD VIA AN ITERATOR

 // MAKE SURE THE OUTPUT PRODUCED BY THE METHOD
 // DISPLAYS THE LEAST SIGNIFICANT BIT TO THE RIGHT.

  } 
```

在带星号的那一行，我得到以下编译错误。

```
Error: incompatible types
  required: Iterator
  found:    java.util.Iterator<java.lang.Integer> 
```

这个我已经试过了

```
**Iterator<Integer> it = list.iterator();** 
```

我明白了，`Error: type Iterator does not take parameters`

编辑***

我忘了提，我有自己的接口方法实现。

```
/*
   * Inner class to implement the iterator for the <code>BitList</code>.
   */
  private class BitListIterator implements Iterator {

    /*
     * A reference to the current <code>Node</code> in the iterator. 
     */
    private Node current = null;

    /*
     * The expected modification count variable.
     *  Needed for the "fast-fail" implementation of the iterator.
     */    
    private int expectedModCount = modCount;

    /*
     * Advances the iterator to the next element in the list.
     */
    public int next() {
      checkValid();

      if (current == null) {
        current = first ;
      } else {
        current = current.next ; // move the cursor forward
      }

      if (current == null)
        throw new NoSuchElementException() ;

      return current.value ;
    }

  /**
   * Inserts a new <code>int</code> value immediately before the next element that would be returned by <code>next()</code>.
   */    
    public void add(int newElement) {
      Node newNode;

      if (current == null) {
        first = new Node(newElement, first);
        current = first;
      } else {
        current.next = new Node(newElement, current.next);
        current = current.next;
      }

      modCount++ ;
      expectedModCount++ ;
    }

  /**
   * Indicates whether there is a next element in the list being traversed or not.
   */      
    public boolean hasNext() {
      return ((current == null) && (first != null)) ||
        ((current != null) && (current.next !=null));
    }

  /**
   * Checks whether this iterator remains valid, i.e. no concurrent modifications have been made on the list.
   */      
    private void checkValid() {
      if (expectedModCount != modCount)
        throw new ConcurrentModificationException();
    }
  } // end of BitListIterator class 
```

所以如果导入包我会得到以下错误

```
Error: BitList.BitListIterator is not abstract and does not override abstract method remove() in java.util.Iterator

Error: next() in BitList.BitListIterator cannot implement next() in java.util.Iterator
  return type int is not compatible with java.lang.Object 
```

我有 jdk 1.7 和它在使用中。

任何想法肯定会有所帮助。

谢谢，

Mjall2

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T00:39:50.620

我怀疑你没有`import java.util.Iterator;`在文件的顶部。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T00:47:53.457

我怀疑你没有`list`用类型声明。试试这个：

```
private List<Integer> list = new ArrayList<Integer>(); 
```

此外，该消息表明您导入了*错误* `Iterator`的类，如果您在使用 IDE 时不小心，就会发生这种情况。确保`import java.util.Iterator;`，并且没有其他 Iterator 类的导入出现在您的 java 文件的顶部。

# javascript - jquery removeClass 在第二次或第三次单击后没有拾取 CSS。

> ID：10098394
> 
> 赞同：0
> 
> 时间：2012-04-11T00:37:59.110
> 
> 标签：javascript, jquery, css

我正在为我的网站制作一个在线日历，并希望使用 jquery 的 removeClass 和 addClass 函数更改所选日期的背景。该脚本在第一次单击时工作正常，旧日的背景被移至默认颜色，并且单击的日期 (td) 突出显示。但是，随后的点击会保留其突出显示的颜色，这意味着我有多个选择的日子。

我尝试了一系列解决方案，包括 .on() live() 和其他帖子中的各种 if 函数。

```
$('#calendarGrid td').on("click", function() {  
    $('#calendarGrid td').removeClass('today');         
    $(this).addClass('today');
}); 
```

我的 CSS 看起来像这样：

```
#calendarGrid .wEnd{background: #DDD;}
#calendarGrid .wDay{background: #EEE;}
#calendarGrid .today{background: #99BBEE;} 
```

并且没有把我的整张桌子放在这里是HTML

```
<table id="calendarGrid">
    <tr>
        <td name='2012-04-07' class='wEnd today' id='a6'>7</td>
        <td name='2012-04-08' class='wEnd' id='b0'>8</td>
        <td name='2012-04-09' class='wDay' id='b1'>9</td>
    </tr>
<table> 
```

奇怪的是，当我有更多的 javascript 时，`.today`尽管它拾取了`.today`CSS，但它的行为好像已被删除。

任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T00:50:38.260

我为你创建了一个[JSFiddle](http://jsfiddle.net/S2B5Z/3/)。一切似乎都在工作......

**HTML**

```
<table id="calendarGrid" cellpadding="5" cellspacing="5" border="1">
    <tr>
        <td name='2012-04-07' class='wEnd today active' id='a6'>7</td>
        <td name='2012-04-08' class='wEnd' id='b0'>8</td>
        <td name='2012-04-09' class='wDay' id='b1'>9</td>
    </tr>
<table> 
```

**CSS**

```
#calendarGrid td{
    padding: 20px;
    cursor: pointer;
}

#calendarGrid td.active{
    background-color: #000;
    color: #fff;
} 
```

**JS**

```
$(document).ready(function(){
    $('#calendarGrid td').live('click', function(){
       $('#calendarGrid td').removeClass('active');
       $(this).addClass('active');
    });
});​ 
```

​</p>

​</p>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T01:04:06.930

代码似乎是正确的。可能是 jquery 库中的一些错误。尝试将谷歌库放在脚本之前：

```
 <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-11T00:47:18.017

您应该尝试`toggleClass`像这样使用：

```
$("#calendarGrid td").on('click', function(){
  //$(this) = #calendarGrid td 
    $(this).toggleClass("today");

}) 
```

# ruby - 不能在使用 jruby 的 IRB 控制台中要求 gem

> ID：10098397
> 
> 赞同：1
> 
> 时间：2012-04-11T00:38:28.043
> 
> 标签：ruby, gem, jruby, irb

我目前在本地机器上使用 jRuby（版本 1.6.5）。

```
rvm use jruby 
```

如果我做一个

```
which cucumber 
```

我得到 /Users/sebastiano/.rvm/gems/jruby-1.6.5.1/bin/cucumber

但是当我打开 Ruby 控制台（irb）并尝试要求“黄瓜”时

```
require 'cucumber' 
```

我得到：

```
LoadError: no such file to load -- cucumber 
```

有什么线索吗？我可以看到 gem 安装在 '/Users/sebastiano/.rvm/gems/jruby-1.6.5.1/gems'

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T00:41:48.650

其实我明白了..我必须做一个

`require 'rubygems'`作为第一条指令

干杯

# objective-c - 从 plist 文件中写入和读取

> ID：10098399
> 
> 赞同：0
> 
> 时间：2012-04-11T00:39:06.417
> 
> 标签：objective-c, ios, cocos2d-iphone, plist

我目前需要读取和写入 plist 文件。这是我目前的状态：我创建了一个名为“Scores.plist”的 plist 文件，并将它放在我的 xcode 项目的 Resources 文件夹中。plist 文件中包含一个带有键“Score”的字典。附加到键的对象是一个占位符值为 1010 的 NSNumber。当我运行我的代码时，我得到了奇怪的结果。我的 plist 是不是放错了地方？我听说 plist 应该位于某些文档目录中，用于读写。但是，我不确定它到底在哪里。任何帮助表示赞赏。提前致谢！:)

```
-(void)writeToPlistHighScore:(int)scoreNumber {  
    //attempt to write to plist   
    //however both the nslog's in this first section result in "null"
    NSString *documentsDirectory = [NSSearchPathForDirectoriesInDomains(NSLibraryDirectory, NSUserDomainMask, YES) objectAtIndex:0];
    NSString *filePath = [documentsDirectory stringByAppendingPathComponent:@"Scores.plist"];

//NSString *scorePath2 = [[NSBundle mainBundle] pathForResource:@"Scores" ofType:@"plist"];
NSDictionary *plistDict = [[NSDictionary dictionaryWithContentsOfFile:filePath] retain];
NSLog(@"%@",[plistDict objectForKey:@"Score"]);
[plistDict setObject:[NSNumber numberWithInt:scoreNumber] forKey:@"Score"];
[plistDict writeToFile:filePath atomically: YES];
NSLog(@"%@",[plistDict objectForKey:@"Score"]);
[plistDict release];

//Stable code for reading out dictionary data
//this code reads out the dummy variable in Scores.plist located in my resources folder.
// Path to the plist (in the application bundle)
NSString *scorePath = [[NSBundle mainBundle] pathForResource:@"Scores" ofType:@"plist"];
NSDictionary *plistData = [[NSDictionary dictionaryWithContentsOfFile:scorePath] retain];
NSString *scoreString = [NSString stringWithFormat:@"Score:%@", [plistData objectForKey:@"Score"]];
NSLog(@"%@",scoreString);

//checking to see where my file is...
//this logs a file path which I don't know means
NSError *error;
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory2 = [paths objectAtIndex:0];
NSString *path = [documentsDirectory2 stringByAppendingPathComponent:[NSString stringWithFormat:@"%@.plist",@"Scores"]]; 

NSFileManager *fileManager = [NSFileManager defaultManager];

if (![fileManager fileExistsAtPath: path]){
    NSLog(@"File don't exists at path %@", path);

    NSString *plistPathBundle = [[NSBundle mainBundle] pathForResource:@"Scores" ofType:@"plist"];

    [fileManager copyItemAtPath:plistPathBundle toPath: path error:&error]; 
}else{
    NSLog(@"File exists at path:%@", path);
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T02:51:38.203

简短的回答是您想使用 NSDocumentDirectory 而不是 NSLibraryDirectory。

```
NSString *documentsDirectory = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0]; 
```

您希望保存到沙箱内的应用程序文档目录，而不是应用程序包。您不能在运行时更改应用程序包中的任何内容。

有关完整说明，请参阅[http://developer.apple.com/library/mac/#documentation/FileManagement/Conceptual/FileSystemProgrammingGUIde/FileSystemOverview/FileSystemOverview.html](http://developer.apple.com/library/mac/#documentation/FileManagement/Conceptual/FileSystemProgrammingGUide/FileSystemOverview/FileSystemOverview.html)。

现在的诀窍是，如果您想加载一个尚未保存的默认 plist 文件怎么办？好吧，首先检查您的文档目录，如果没有文件保存在那里，然后从您的资源目录加载模板。更好的是，如果它看起来像一个简单的结构，只需在代码中创建 NSDictionary，然后使用 writeToFile:atomically: 保存它，它将以 plist 格式写入。

[在http://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/PropertyLists/QuickStartPlist/QuickStartPlist.html#//apple_ref/doc/uid/10000048i-CH4-SW5](http://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/PropertyLists/QuickStartPlist/QuickStartPlist.html#//apple_ref/doc/uid/10000048i-CH4-SW5)有一个很好的 plist 处理解释. 它使用 Mac OS X 应用程序作为示例，但这些概念可以转移到 iOS。

顺便说一句，您在保留和发布方面采取了一些不必要的步骤。dictionaryWithContentsOfFile 创建一个自动释放的对象，因此不需要保留它，因此完成后不需要释放它。您可以使用以下代码完成您在第一个代码块中所做的相同事情：

```
NSDictionary *plistDict = [NSDictionary dictionaryWithContentsOfFile:filePath]; 
NSLog(@"%@",[plistDict objectForKey:@"Score"]); 
[plistDict setObject:[NSNumber numberWithInt:scoreNumber] forKey:@"Score"]; 
[plistDict writeToFile:filePath atomically: YES]; 
NSLog(@"%@",[plistDict objectForKey:@"Score"]); 
```

plistDict 将在当前运行循环迭代时自动释放。我提到这一点是因为您在示例中稍后未能释放 plistData，如果稍后没有释放它，这是内存泄漏，而您可以通过不保留 plistData 来避免这种情况。有关自动释放对象的详细说明，请参阅[https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmAutoreleasePools.html#//apple_ref/doc/uid/20000047-CJBFBEDI](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmAutoreleasePools.html#//apple_ref/doc/uid/20000047-CJBFBEDI)。

# android - 自定义 Android EditText 不起作用

> ID：10098401
> 
> 赞同：1
> 
> 时间：2012-04-11T00:39:12.753
> 
> 标签：android, android-edittext, android-view, android-custom-view

我正在尝试`onDraw()`在我的`EditText`. `onDraw`被调用 - 我可以看到日志消息，但它没有绘制任何东西。

谁能告诉我我做错了什么？

这是我的布局的摘录：

```
 <view xmlns:android="http://schemas.android.com/apk/res/android"
          class ="my.package.NotePadEditView"
            android:inputType="textMultiLine"
            android:id="@+id/edit_text"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:gravity="top"
            android:background="@android:color/transparent"
            android:singleLine="false"
            >
        <requestFocus/>
    </view>
</ScrollView> 
```

这是类（现在只是一些测试代码）：

```
public class NotePadEditView extends EditText {
Paint paint = new Paint();
public NotePadEditView(Context context, AttributeSet attrs, int defStyle) {
   super(context, attrs, defStyle);
   paint.setStyle(Paint.Style.STROKE);
   paint.setStrokeWidth(3);
   paint.setColor(0xFF0000);
 }
 @Override
 protected void onDraw(Canvas canvas) {
   Log.d("NotePadEditView", "Calling onDraw()"); // These log messages are displaying
   canvas.drawLine(0, 0, 50, 50, paint); // just some random stuff so we know when we are done. (Note: these are not displaying - what's up with that???)
   canvas.drawText("Hello, World", 30, 30, paint);
   super.onDraw(canvas);
  }

// more constructors, etc 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T05:16:02.600

我认为您应该尝试在 android 布局的 xml 中使用自定义 EditText。

这是我在您的班级中所做的一些更改。

```
public class NotePadEditView extends EditText{
@Override
protected void onDraw(Canvas canvas) {

    Log.d("NotePadEditView", "Calling onDraw()"); // These log messages are displaying
       canvas.drawLine(0, 0, 50, 50, paint); // just some random stuff so we know when we are done. (Note: these are not displaying - what's up with that???)
       canvas.drawText("Hello, World", 30, 30, paint);
       super.onDraw(canvas);

}
Paint paint;

public NotePadEditView(Context context, AttributeSet attrs){
    super(context, attrs);
    //this Contructure required when you are using this view in xml 
    paint = new Paint();
    paint.setStyle(Paint.Style.STROKE);
    paint.setStrokeWidth(3);
    paint.setColor(Color.BLUE);
}

public NotePadEditView(Context context, AttributeSet attrs, int defStyle) {
    super(context, attrs, defStyle);
    paint = new Paint();
    paint.setStyle(Paint.Style.STROKE);
    paint.setStrokeWidth(3);
    paint.setColor(0xFF0000);

   }

} 
```

像这样在你的xml中使用，

```
 <my.package.NotePadEditView 
            android:id="@+id/edit_text"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:background="@android:color/transparent"
            android:gravity="top"
            android:inputType="textMultiLine"
            android:singleLine="false" /> 
```

希望这会让你的工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T11:42:17.523

好的，终于想通了。看起来您需要在颜色分配上设置 alpha 字节：

```
paint.setColor(0x80FF0000); 
```

不是

```
paint.setColor(0xFF0000); 
```

显然，通过排除 alpha 字节，您隐式传入零，这意味着颜色是完全透明的。Java AWT 不是这样工作的——谁认为这是个好主意？！

# clojure - 在 Clojure 中处理大文件时出现 OutOfMemory 错误

> ID：10098402
> 
> 赞同：5
> 
> 时间：2012-04-11T00:39:32.750
> 
> 标签：clojure, out-of-memory

我正在学习 algo-class.org 课程，其中一项编程任务提供了一个格式如下的文件：

```
1 2
1 5
2 535 
```

...

有超过 500 万行这样的行，我想读取文件并将其转换为整数向量的向量，如下所示：[[1 2][1 5][2 535]...]。

```
(defn to-int-vector [s]
    (vec (map #(Integer/parseInt %) (re-seq #"\w+" s))))    

(def ints (with-open [rdr (clojure.java.io/reader "<file>")]
               (doall (map to-int-vector (line-seq rdr))))) 
```

所以我相信这样，我不会将整个文件保存在内存中，而只会生成一个大整数向量。但我从中得到了 OutOfMemoryError 。我确实尝试通过运行 rand-int 生成相同大小和格式的向量，并且效果很好。

看起来内存问题是由生成的临时对象引起的？clojure 处理这种情况的理想方法是什么？

**更新：**

是的，我意识到我持有整个整数向量。我已经提高了堆大小，现在它可以工作了。我对一个向量和 500 万个元素（1000 万个整数）会占用这么多内存很感兴趣——我必须为 jvm 分配 3g。有没有其他方法可以降低内存？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T07:51:17.127

你不会相信实现的惰性序列会带来多少开销。我在 64 位操作系统上对此进行了测试：大约是 120 字节。这对于每个惰性 seq 成员来说都是纯粹的开销。另一方面，向量具有相当低的开销，并且在给定足够大的向量的情况下与 Java 数组基本相同。所以尝试替换`doall`为`vec`.

让我们看看你在没有开销的情况下花费了多少内存。你有 5e6 对整数——即 5e6 x 8 = 40 MB。您可以通过使用短裤来节省并节省 50%（我再说一遍——这还不包括父集合的开销，并且每个持有该对的向量实例都有自己的开销）。

保存的下一步是为外部集合和对使用原始数组。它仍然是一个非常实用的解决方案，因为数组是可排序的并且与语言很好地集成。为此，您只需将出现的两次替换`vec`为`to-array`。

**更新**

`Integer`和之间的差异`Short`并不大，因为两者仍然是成熟的对象。将数字对存储为原始数组，使用`short-array`(or `int-array`) 而不是`to-array`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T17:48:43.687

很难同时利用惰性和封装`with-open`。在您的情况下，惰性很重要，因为它使得内存中只有行或 int-vector 序列的“相关”部分成为可能。

该问题的一种解决方案是不封装`with-open`并将整个行处理逻辑包含在`with-open`表单的动态范围内：

```
(with-open [rdr (clojure.java.io/reader "<file>")]
  (doseq [int-vector (map to-int-vector (line-seq rdr))]
    (process int-vector))) 
```

这里有两个重要的细节是您不存储 line 和 int-vector 序列，并且您只在`with-open`表单中使用它们。这些细节确保序列中已经处理的部分可以被垃圾收集，并且文件流在整个处理过程中保持打开状态。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-11T02:48:24.710

`def`in将`(def ints`确保整个结果存储在内存
中，该内存至少与文件一样大，因为每行上的数字都存储在一个集合中，在这种情况下是一个 vec，这也占用了空间。

同样默认情况下java会拒绝使用计算机中的所有内存，您可能需要设置maxHeapSize参数。

如果您从一个新的 repl 开始（还没有保存任何大列表），您是否仍然内存不足？

# mysql - mysql复制：如何向前跳过

> ID：10098407
> 
> 赞同：1
> 
> 时间：2012-04-11T00:40:07.367
> 
> 标签：mysql, replication

我在主服务器和从服务器之间设置了 mysql 复制。现在发现从服务器落后了。如果我只关心最新数据，有什么想法可以跳过 mysql 复制吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T01:13:50.943

它应该很快赶上来，但是您可以将从站设置为在任何时候启动。如果要将其设置为 master 当前所在的位置，请在 master 上运行此命令以发现 Master 在复制日志中的位置：

```
SHOW MASTER STATUS; 
```

然后在从属服务器上，使用 CHANGE MASTER 命令更新主日志文件和主日志位置以匹配您在上面命令中看到的内容。

```
STOP SLAVE;
CHANGE MASTER TO MASTER_LOG_FILE='log_file', MASTER_LOG_POS=#;
START SLAVE; 
```

[http://dev.mysql.com/doc/refman/5.1/en/change-master-to.html](http://dev.mysql.com/doc/refman/5.1/en/change-master-to.html)

或者，您可以直接跳过一定数量的指令。但你通常这样做只是为了跳过一个问题。 [http://dev.mysql.com/doc/refman/5.1/en/set-global-sql-slave-skip-counter.html](http://dev.mysql.com/doc/refman/5.1/en/set-global-sql-slave-skip-counter.html)

# iphone - UIViewController 动画内存释放

> ID：10098410
> 
> 赞同：2
> 
> 时间：2012-04-11T00:40:46.657
> 
> 标签：iphone, animation, sdk

看看我下面的代码，点击“返回”按钮后出现内存错误，如果我删除[aboutView release]问题就解决了，这是为什么？以及我应该如何发布 aboutView？

```
-(IBAction)swichView {
    AboutView *aboutView = [[AboutView alloc] init];
    [aboutView.view setAlpha:0];
    [self.view addSubview:aboutView.view];
    [UIView beginAnimations:@"" context:nil];
    [UIView setAnimationDuration:1.0];  
    [aboutView.view setAlpha:1];
    [UIView commitAnimations];
    [aboutView release];
} 
```

第二个视图控制器：

```
-(IBAction)back {
    [UIView beginAnimations:@"" context:nil];
    [UIView setAnimationDuration:1.0];
    [self.view setAlpha:0];
    [UIView commitAnimations];
    [self.view removeFromSuperview];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T00:57:39.657

在您的`switchView`中，您不应该创建`AboutView`. `AboutView *aboutView`应该创建为实例变量，而不是函数局部变量。

由于视图控制器动画的设计，动画本身不会**保留**您的控制器并在动画结束时自动释放它。您的代码在动画期间取消分配视图控制器，这就是它会崩溃的原因。

要在动画后正确释放视图，请尝试：

```
-(IBAction)switchView {
    // given that aboutView is an instance variable
    aboutView = [[AboutView alloc] init];
    [aboutView.view setAlpha:0];
    [self.view addSubview:aboutView.view];
    [UIView animationWithDuration:1.0 animations:^{
        [aboutView.view setAlpha:1];
    } completion:^(BOOL fin) {
        // don't release it
    }];
}

-(IBAction)back {
    [UIView animationWithDuration:1.0 animations:^{
        [aboutView.view setAlpha:0];
    } completion:^(BOOL fin) {
        [aboutView.view removeFromSuperview];
        [aboutView release];
    }];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T02:40:10.553

问题大概`[self.view removeFromSuperview];`出在`-(IBAction)back;`

你不需要那个。在 a`UIViewController`中，只要您在其中释放它，它的视图就会为您处理`dealloc`。

AboutView 将由控制器的视图保留，当您`addSubview:`

> 此方法保留视图并将其下一个响应者设置为接收者，这是它的新超级视图。-- 文档`addSubview:`

因此，当视图被释放时，`aboutView`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T05:12:57.003

在方法 '-(IBAction)swichView' 之后似乎没有任何东西保留 aboutView 对象

行'[self.view addSubview:aboutView.view];'

**会给aboutView.view**一个额外的参考计数，而不是**aboutView**本身。

我可能会使用类似于 UIPopoverViewController 工作方式的委托模型。

使用方法定义一个协议

```
-(void) subViewClosed:(AboutView*)aboutView; 
```

让父母实现它，然后去：

家长

```
-(IBAction)swichView {
    .. existing stuff ..

    (dont release)

    aboutView.delegate = self;
} 
```

关于查看类

```
-(IBAction)back {
    ... existing stuff ...

    [self.delegate subViewClosed:self];
} 
```

家长

```
-(void) subViewClosed:(AboutView*)aboutView{
    [aboutView release];
} 
```

# bash - 通过 sudo - 环境变量从另一个 shell 脚本调用 shell 脚本？

> ID：10098414
> 
> 赞同：4
> 
> 时间：2012-04-11T00:42:02.090
> 
> 标签：bash, shell, environment-variables, sudo

我正在从脚本 A 调用 bash 脚本 B。在脚本 A（父脚本）中，我正在导出一些变量。我想在脚本 B（下标）中使用这些变量，但变量值没有从脚本 A 传递到脚本 B。有没有办法从脚本 B 访问变量值？

```
#!/bin/bash
# script_A.sh
export VAR="value"
enter code here
sudo -u user ./script_B.sh

#!/bin/bash
# script_B.sh
echo $VAR    # this prints nothing 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-11T00:53:31.217

正如@geekosaur 提到`sudo`的，出于安全原因重置环境。为了保护环境，请`-E`切换到`sudo`.

从`sudo`手册页：

> `-E`
> 
> ( `-E`preserve environment) 选项向安全策略表明用户希望保留他们现有的环境变量。`-E`如果指定了选项并且用户没有保留环境的权限，则安全策略可能会返回错误。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-11T00:44:39.887

这里的问题不在于 shell 脚本，而是出于安全原因`sudo`，它会清理它传递给它运行的程序的环境。有关`man sudoers`详细信息，并`/etc/sudoers`在您的系统上查看它将保留哪些（如果有）环境变量，请参阅。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T09:37:23.003

如果出于安全或简单的原因只想保留一组特定的变量（而不是所有变量），您可以简单地**将它们分配为`sudo`命令**的一部分：

```
$ cat test.sh 
#!/usr/bin/env bash
echo "$foo"
$ unset foo
$ foo=bar ./test.sh
bar
$ sudo foo=bar ./test.sh
bar 
```

# c# - XNA GameTime Windows 手机

> ID：10098416
> 
> 赞同：1
> 
> 时间：2012-04-11T00:42:24.583
> 
> 标签：c#, windows-phone-7, xna

我一直在关注微软网站上的教程，他们使用 GameTime 来跟踪一些事情。但是，当我创建一个新实例时，它不会开始计数，也没有像 .start() 这样的函数来启动计时器。当我运行游戏时，GameTime 中创建的对象 gameTime 对于里面的每个元素都保持为 0。有谁知道如何正确使用 GameTime，因为很明显，我做错了；）

-谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T01:19:41.333

您不应该创建`GameTime`类的实例，而是使用`gameTime`提供给类的`Draw()`和`Update()`方法的参数`Game`：

```
TimeSpan totalGameTime = gameTime.TotalGameTime; 
```

Windows Phone 7 的一个很好的参考是[Programming Windows Phone 7](http://www.charlespetzold.com/phone/index.html)，Charles Petzold 的免费电子书。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T15:52:19.103

想通了，因为这是特定于 windows phone，你必须使用内置的 GameTimerEventArgs。谢谢你们的帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-05T10:22:22.873

我将此代码用于 XNA wp 游戏倒计时。我认为这也可以在普通 XNA GameTimer 中用于倒计时和计时。

```
GameTimer gameTime = new GameTimer();
int _timer = 5;
// initiate
gameTime.UpdateInterval = TimeSpan.FromSeconds(1);  // game time count every second
gameTime.Update +=new EventHandler<GameTimerEventArgs>(gameTime_Update);  // each time count, will exeute gameTime_Update method.
// each time execute, will decrease _timer by 1
void gameTime_Update(object sender, GameTimerEventArgs e)
{
            _timer-= 1;
}
// on function OnNavigatedTo, after 
timer.Start();  // this is default
gameTime.Start();   // this what I add. 
```

# c++ - INetSharingConfiguration->EnableSharing( ICSSHARINGTYPE_PUBLIC ) 返回 0x80040201

> ID：10098419
> 
> 赞同：6
> 
> 时间：2012-04-11T00:43:08.933
> 
> 标签：c++, windows-7, sharing

我正在尝试以编程方式启用与 Windows 7 机器上已知 GUID 匹配的设备上的共享类型 public 的共享。

API 位于： http: [//msdn.microsoft.com/en-us/library/windows/desktop/aa365944 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365944(v=vs.85).aspx)

错误列表显示如下：E_ABORT、E_FAIL、E_INVALIDARG、E_NOINTERFACE、E_NOTIMPL、E_OUTOFMEMORY、E_POINTER 和 E_UNEXPECTED。

我得到的错误代码是 0x80040201，它解析为：“事件无法调用任何订阅者。” 这似乎与上面列出的任何错误代码都不匹配。

如果我手动进入网络适配器属性并转到共享选项卡并启用共享并选择专用网络并单击确定，共享将正确启用。

在此之后，我上面的代码运行没有问题。

我什至可以在另一个适配器（公共）和不同的专用网络上手动设置共享，然后运行我的代码并查看我的代码将公共和专用网络更新为我想要的。这似乎仅在首先通过网络属性窗格手动启用共享后才有效。

该问题已在运行 windows 7 64 位的两台不同计算机上重复出现。这似乎是在启用共享时从系统中卸载网络适配器驱动程序然后重新安装网络适配器驱动程序后发生的。

我试过让卸载程序在卸载期间禁用共享，但这似乎是命中或错过。

Windows 网络共享属性窗格在后台执行此 API 调用不执行的操作，因为每次手动设置适配器上的共享都有效。

有谁知道那可能是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-12-07T15:23:11.683

我在 Windows 8.1 上遇到了同样的问题，并在阅读后最终修复了它：https: [//support.microsoft.com/kb/828807](https://support.microsoft.com/kb/828807)

我的代码是 C# 但我相信你可以在 C++ 中做同样的事情

```
// Disable ICS on any network iterfaces which may no longer be present in the system
public void Disable_ICS_WMI()
{
  ManagementScope scope = new ManagementScope("\\\\.\\ROOT\\Microsoft\\HomeNet");

  //create object query
  ObjectQuery query = new ObjectQuery("SELECT * FROM HNet_ConnectionProperties ");

  //create object searcher
  ManagementObjectSearcher searcher = new ManagementObjectSearcher(scope, query);
  //get a collection of WMI objects
  ManagementObjectCollection queryCollection = searcher.Get();

  //enumerate the collection.
  foreach (ManagementObject m in queryCollection)
  {
    // access properties of the WMI object
    Console.WriteLine("Connection : {0}", m["Connection"]);
    try
    {
       PropertyDataCollection properties = m.Properties;
       foreach(PropertyData  prop in properties)
       {
         if (prop.Name == "IsIcsPrivate" && ((Boolean) prop.Value ) == true)
         {
            prop.Value = false;
            m.Put();
         }
       }          
     } catch (Exception e)
     {
       Console.WriteLine("ex " + e.Message);
       continue;
     }
  }
} 
```

# c# - POST 表单时将复选框绑定到模型

> ID：10098420
> 
> 赞同：1
> 
> 时间：2012-04-11T00:43:09.850
> 
> 标签：c#, jquery, html, asp.net-mvc-3, checkbox

这是我的简单课程：

```
using System;
using System.Collections.Generic;
using System.ComponentModel.DataAnnotations;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using XXX.Domain;

namespace XXX.WebUI.Models
{
    public class AccountRegisterModel
    {
        ..snip..

        [Required(ErrorMessage = "You must agree to our terms of use.")]
        public bool AcceptedTerms { get; set; }

        ..snip..
    }
} 
```

而我的观点：

```
<div class="terms">
    <input type="checkbox" name="AcceptedTerms" value="AcceptedTerms"  />
    <img class="sim" src="@Url.Content("~/Public/images/unchecked.gif")" alt="accept the terms" />
    <p>I accept the <span class="legalize">Terms of Service &amp; Privacy Policy</span> and wish to continue</p>
</div> 
```

该视图以未选中的复选框开始，并使用一些 Javascript 代码我使用图像创建一个时髦的复选框，并在幕后更新复选框，以便回发正确的值。

```
$('.terms input[type="checkbox"]').prop("checked", true); 
```

出于调试目的，我`display:block`在“隐藏”的**实际**复选框中添加了一条规则，以查看当我单击图像时检查是否真的被勾选，我可以确认是这种情况。

此外，使用 Firebug，这是我单击图像并选中复选框时显示的 HTML：

```
<input type="checkbox" name="AcceptedTerms" value="AcceptedTerms"> 
```

发布表单时，AcceptedTerms 的值仍然为 false，就好像该值没有被发布回我的服务器一样。也许 HTML 缺少我不知道的属性。

有什么想法或建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T09:07:02.597

要保留您需要将复选框绑定到视图模型的值。我会这样：

```
@Html.CheckBoxFor(x => x.AcceptedTerms) 
```

当您的表单发布时，它应该具有复选框的值，即。如果它被检查（真）或没有（假）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T06:05:41.327

```
<input type="checkbox" name="AcceptedTerms" value="AcceptedTerms"  /> 
```

应该改为

```
<input type="checkbox" name="AcceptedTerms" value="true"  /> 
```

value 必须是 true 而不是 AcceptedTerms。

如果您使用 @Html.CheckBoxFor(x => x.AcceptedTerms)

您将看到该值设置为 true。

# solr - Cygwin 中 solr 配置中的严重错误

> ID：10098423
> 
> 赞同：0
> 
> 时间：2012-04-11T00:43:40.773
> 
> 标签：solr

我正在尝试使用 Cygwin 在我的 64 位 Windows 7 专业版上的 Tomcat 7.0.27 上安装 solr。

我将 solr.war 文件从 cygwin/apache-solr-3.4.0 复制到 Tomcat/WebApps 下的 Tomcat 中。

当我这样做时，它会在 localhost:8080/solr 上显示 Solr 管理员

但是当我更新 web.xml 文件（从 /put/your/solr/home/here 更改为 C:\cygwin\apache-solr-3.4.0\example\solr

我什至无法在 localhost:8080/solr 上看到 solr 管理员

如果你能帮助我，我将不胜感激（我是 Solr 和整体编程的新手）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T08:51:47.107

试试 C:/cygwin/apache-solr-3.4.0/example/solr

# java - 有没有办法摆脱打印语句并将字符串变量视为Java中的有效代码？

> ID：10098425
> 
> 赞同：1
> 
> 时间：2012-04-11T00:43:50.797
> 
> 标签：java, security

我正在探索一段代码中的一些安全问题，并想知道是否有办法打破`System.out.println("");`语句并将字符串视为可执行代码？

因此，例如，我有以下两行：

```
String exit = "System.exit(0);";
System.out.println(exit); 
```

`"System.exit(0);"`因此，我希望 JVM 将其视为可执行代码，而不是打印到控制台。甚至可能吗？如果是这样，是否有人对如何做到这一点有想法？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-11T00:47:24.097

> 甚至可能吗？

不。

并非没有首先故意弄乱您的 JVM 等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T01:12:18.890

对的，这是可能的。它在概念上很容易，但实施起来却极其困难。我不会测试我的答案，所以它很可能是完全错误的。

编写自定义 PrintStream 类。此 PrintStream 应为每个输入行生成一个字符串，例如

```
public class Xid implements Runnable { public void run ( ) { line } } 
```

其中 id 对于每一行都是唯一的，而 line 是该行的文本。

然后它应该将该文本发送到编译器。

然后它应该加载类 Xid 并创建它的实例并运行它。

在你有一个这样的 PrintStream 类之后，你创建它的一个实例`out`并使用[System.setOut(out)](http://docs.oracle.com/javase/7/docs/api/java/lang/System.html#setOut%28java.io.PrintStream%29)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-11T00:48:29.500

这是可能的：

1.  使用您想要的任何代码生成 java 源文件。
2.  执行“javac”编译
3.  使用类加载器将字节码加载到 JVM
4.  执行类（即调用方法）。

现在用一个接受字符串的方法编写一个类，执行所有这 4 个步骤：

```
JavaInterpreter.execute("System.exit(0);"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T04:05:20.600

> 我正在探索一段代码中的一些安全问题，并想知道是否有办法突破 System.out.println(""); 语句并将字符串视为可执行代码？

根据埃默里的回答，可以做到这一点。但是，为了做到这一点，您首先必须能够将代码注入应用程序 (*)。如果你可以注入代码，还有更简单的方法可以关闭 JVM。所以：

*   这并不代表您的 Java 应用程序中存在新的安全风险，并且
*   这不是破坏其他人的 Java 应用程序的明智方法。

^(* 这种代码注入可能需要使用一些现有的或新的 Java 安全漏洞，或者它可能只是涉及修改 Java 应用程序的源代码或构建过程，或者在主机计算机受到攻击后修改应用程序的字节码。)

# iphone - 实例化一个单例类

> ID：10098426
> 
> 赞同：3
> 
> 时间：2012-04-11T00:44:01.167
> 
> 标签：iphone, objective-c, cocoa-touch

我创建了一个单例类来跟踪我在 iPhone 应用程序上的数据。我知道单例只需要实例化一次，但是实例化它的最佳位置是什么？这应该在 appDelegate 中完成吗？我希望能够从多个类中调用这个单例（其中包含一个 NSMutableArray），以便我可以访问该数组。

这是我写的我的课：

```
#import "WorkoutManager.h"

static WorkoutManager *workoutManagerInstance;

@implementation WorkoutManager
@synthesize workouts;

+(WorkoutManager*)sharedInstance {
    if(!workoutManagerInstance) {
        workoutManagerInstance = [[WorkoutManager alloc] init];
    }
    return workoutManagerInstance;
}

-(id)init {
    self = [super init];
    if (self) {
        workouts = [[NSMutableArray alloc] init];
    }
    return self;
}

@end 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-11T00:51:21.433

在几乎所有情况下，单例的意义在于你不关心谁首先实例化它。谁最先呼唤谁就是`[Something sharedSomething]`创造者。您想使用“[如何实现与 ARC 兼容的 Objective-C 单例？](https://stackoverflow.com/questions/7568935/how-do-i-implement-an-objective-c-singleton-that-is-compatible-with-arc) ”中给出的模式，这将确保单例只创建一次。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T00:51:51.947

单例通常是惰性实例化的——第一次访问它们时，会创建实例并从访问方法返回。对访问方法的后续调用仅返回已创建的实例。

标准模式是： 1\. 获取锁或以其他方式使以下线程安全（即`dispatch_once()`）。2\. 检查单实例是否已经创建。3\. 如果没有，创建它。4\. 释放锁定（如果适用）。5\. 返回实例。

如果出于某种原因需要，可以更早地创建实例。[`+load`](http://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSObject_Class/Reference/Reference.html#//apple_ref/doc/uid/20000050-load)当类添加到运行时时，运行时会发送类方法，这在应用程序执行的早期。(`+initialize`似乎它也是一个候选者——它是在类收到它的第一条（其他）消息（也不包括`+load`）之前由运行时发送的——但它实际上并没有给你任何东西，因为它会在之前立即发送你发送`sharedInstance`。）

gcc`__constructor__` [函数属性](http://gcc.gnu.org/onlinedocs/gcc/Function-Attributes.html#Function-Attributes)也有效（在 clang 中也是如此），尽管被记录为没有为 ObjC 实现。在输入之前将调用具有此属性的函数`main()`。不过，我不太确定此选项的内存管理含义。运行时应该全部设置好，但是还没有自动释放池。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-11T00:51:20.180

这可能是最简单的方法：

```
static MyClass* theInstance = nil;

+ (MyClass*) sharedInstance {
    @synchronized(self) {
        if (! theInstance) {
            theInstance = [[MyClass alloc] init];
        }
    }

    return theInstance;
} 
```

...所以在你想访问单例的地方，你只是`[MyClass sharedInstance]`为了获得对实例的引用。

请注意，这不能防止人们手动调用您`alloc`的`init`单例类来创建其他实例。如果您需要这样做，您可以`init`以与上述类似的方式实现，以防止使用`alloc`and创建/返回其他实例`init`。

然而，在实践中，单例类最常使用这种`sharedInstance`方法（有时在命名上有细微的变化，例如`[UIApplication sharedApplication]`）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T00:54:11.207

通常单例类在第一次被访问时被实例化：

```
static SomeClass *_instance = nil;

+ (SomeClass *) instance {
    @synchronized(self) {
        if (!_instance)
            _instance = [[self alloc] init];
    }
    return _instance;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-11T01:03:30.677

我正在使用此代码来实例化单例。GCD 负责同步

```
+ (SingletonClass *)sharedInstance {
  static SingletonClass *sharedInstance;
  static dispatch_once_t onceToken;
  dispatch_once(&onceToken, ^{
    sharedInstance = [[SingletonClass alloc] init];
    sharedInstance.property = [Property new];
  });
  return sharedInstance;
} 
```

# asp.net-mvc-3 - 使用 EF 4.3 更新参考关联

> ID：10098433
> 
> 赞同：0
> 
> 时间：2012-04-11T00:45:47.863
> 
> 标签：asp.net-mvc-3, entity-framework

我正在使用 EF 4.3 和 MVC 3。

在一个编辑操作中，我收到了一个模型实例，它的引用关联已更新。当我尝试更新 de 模型时，我执行以下操作：

```
public void Update(Client updatedClient)
{
    var currentClient = _context.Clientes.Include("Address").Include("Phone").FirstOrDefault(c => c.ClientId == updatedClient.ClientId);
    _context.Entry(currentClient).CurrentValues.SetValues(updatedClient);
} 
```

Client 类的所有属性都更新了，除了 Address 和 Phone 的属性。

我必须手动完成还是有更简单的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T08:25:03.673

`SetValues`仅适用于您作为参数传递的实体的标量/复杂属性。它不适用于导航属性，也不能深入到对象图中。

您要么必须跟踪对关系所做的更改`updatedClients`并手动设置图中每个实体的状态，要么必须比较`currentClient`和`updateClient`（以及它们的所有关系）并`currentClient`相应地更新（再次手动）。对这个问题的更深入的解释是[here](https://stackoverflow.com/questions/3635071/update-relationships-when-saving-changes-of-ef4-poco-objects/3635326#3635326)。

# html - Safari/Chrome 在浏览器刷新时创建了重复的 webSQL 数据库

> ID：10098435
> 
> 赞同：2
> 
> 时间：2012-04-11T00:46:05.567
> 
> 标签：html

我正在使用 HTML5、CSS 3 和 Javascript 创建一个移动 Web 应用程序。目前我正在 Google Chrome 和 Safari 桌面浏览器中对此进行测试，因为我最终会将这个应用程序发布到 iOS 和 Android 设备上。

在测试期间，数据库操作按预期工作（这太棒了）但是每次我刷新网页时，最初创建的数据库都会重复（在多次页面刷新后，数据库的数量会增长到一个愚蠢的数字），我不能弄清楚为什么会这样。

我认为浏览器会检查数据库是否存在（如果不存在则创建它）或打开数据库（如果检查是肯定的数据库存在）。以下代码用于创建数据库：

```
var Database = function(){
this.db     = false;
this.dbName     = 'Stores';
this.dbVersion  = '1.0';
this.display    = 'Stores';
this.dbSize     = 5000000;
this.resultSet      = [];
}

Database.prototype = {

initialiseDatabase : function(){
this.db = openDatabase(this.dbName, this.dbVersion, this.display, this.dbSize);
return this;
}
} 
```

这个类方法（严格来说不是 JS 中的一个类，但由于缺乏术语，它被接受）然后在前端视图中只调用一次，代码如下：

db.initialiseDatabase();

就像我之前所说的，除了在 Google Chrome 和 Safari 中刷新页面时，代码工作正常。发生这种情况时，每次刷新页面都会复制已存在的数据库。

是否有人能够就我可能做错的事情或可以做些什么来防止这种情况发生提供任何建议/指示？我看了这篇文章：[Duplicate SQLite database in webapp](https://stackoverflow.com/questions/8201700/duplicate-sqlite-database-in-webapp)，但我发现这发生在上面提到的 Mac OS X 10.7 上的两个浏览器上。

提前感谢任何可以给我提示的人:)

# android - 如何将文件从android应用程序上传到tomcat 6服务器

> ID：10098436
> 
> 赞同：0
> 
> 时间：2012-04-11T00:46:05.613
> 
> 标签：android, jakarta-ee, file-upload, tomcat6

请帮助我我已经搜索和搜索但我没有找到一个操作代码，一个允许将文件从我的android应用程序上传到我的Tomcat服务器6的代码，

我需要客户端和服务器端的代码。非常感谢您

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T01:37:44.163

对于服务器检查：

[文件上传“multipart/form”异常 org.apache.commons.fileupload.FileUploadBase$InvalidContentTypeException](https://stackoverflow.com/questions/1458453/file-upload-multipart-form-exception-org-apache-commons-fileupload-fileuploadb)

和客户：

[带有服务器端 php 的 Android 文件上传器](https://stackoverflow.com/questions/3204476/android-file-uploader-with-server-side-php)

您应该能够调整这些帖子中的代码。

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T00:53:20.013

您需要在 Tomcat 服务器上创建一个 Web 服务。您可以使用 java servlet、php 或 .NET 中的 WCF 服务来执行此操作。然后使用 RESTful 客户端访问您的 Web 服务

# c++ - C++ 使用自定义权重提升 prim 算法？

> ID：10098437
> 
> 赞同：0
> 
> 时间：2012-04-11T00:46:11.900
> 
> 标签：c++, algorithm, boost, prims-algorithm

我正在尝试使用 boost 的 prim 算法来使用边权重和 id 号而不是边权重来找到最小生成树。

例如，如果两个边的权重都是 1，则将比较 id，无论哪个较小，都会打破平局。

我创建了一个 EdgeWeight 类并重载了 < 和 + 运算符来执行此操作，然后将 edge_weight_t 属性从 int 更改为 EdgeWeight，希望它能起作用。

```
// TestPrim.cpp : Defines the entry point for the console application.
//

#include "stdafx.h"

#include <boost/config.hpp>
#include <iostream>
#include <boost/graph/adjacency_list.hpp>
#include <boost/graph/prim_minimum_spanning_tree.hpp>

using namespace std;

class EdgeWeight{
    public:
    EdgeWeight(){}
    EdgeWeight(int weightIn, int destinationIdIn){
        weight = weightIn;
        destinationId = destinationIdIn;
    }

        bool operator<(const EdgeWeight& rhs) const {
        if (weight < rhs.weight)
            return true;
        else if(weight == rhs.weight){
            if (destinationId < rhs.destinationId)
                return true;
            else
                return false;
        }
        else
            return false;
        }

    EdgeWeight operator+(const EdgeWeight& rhs) const {
        EdgeWeight temp;
        temp.weight = weight + rhs.weight;
        temp.destinationId = destinationId + rhs.destinationId;
        return temp;
        }

    int weight;
    int destinationId;
};

int _tmain(int argc, _TCHAR* argv[])
{
  using namespace boost;
  typedef adjacency_list < vecS, vecS, undirectedS, property<vertex_distance_t, EdgeWeight>,      property < edge_weight_t, EdgeWeight > > Graph;
  typedef std::pair < int, int >E;
  const int num_nodes = 5;
  E edges[] = { E(0, 2), E(1, 3), E(1, 4), E(2, 1), E(2, 3),
    E(3, 4), E(4, 0)
  };
  EdgeWeight weights[] = { EdgeWeight(1, 2), EdgeWeight(1, 3), EdgeWeight(2, 4), 
      EdgeWeight(7, 1), EdgeWeight(3, 3), EdgeWeight(1, 4), EdgeWeight(1, 0) };
  Graph g(edges, edges + sizeof(edges) / sizeof(E), weights, num_nodes);
  property_map<Graph, edge_weight_t>::type weightmap = get(edge_weight, g);
  std::vector < graph_traits < Graph >::vertex_descriptor > p(num_vertices(g));
  prim_minimum_spanning_tree(g, &p[0]);

  for (std::size_t i = 0; i != p.size(); ++i)
    if (p[i] != i)
      std::cout << "parent[" << i << "] = " << p[i] << std::endl;
    else
      std::cout << "parent[" << i << "] = no parent" << std::endl;

  return EXIT_SUCCESS;
} 
```

我收到一个错误，“c:\program files (x86)\microsoft visual studio 10.0\vc\include\limits(92): error C2440: '' : cannot convert from 'int' to 'D' 1> No constructor could取源类型，或构造函数重载决议不明确”

我这样做对吗？有一个更好的方法吗？

[http://www.boost.org/doc/libs/1_38_0/libs/graph/doc/prim_minimum_spanning_tree.html](http://www.boost.org/doc/libs/1_38_0/libs/graph/doc/prim_minimum_spanning_tree.html) http://www.boost.org/doc/libs/1_38_0/boost/graph/prim_minimum_spanning_tree.hpp

编辑：好的，所以我现在使用 cjm 的扰动方法实现了权重，但是将来我相信我将不得不以某种方式使用上述方法，仍然想知道该怎么做

编辑2：根据耶利米的回应，我将 vertex_distance_t 从 int 更改为 EdgeWeight 但得到了同样的错误

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T20:48:43.307

顶点距离图`value_type`需要与算法工作的边权重类型相同。该文档暗示（在描述的第一部分`distance_map`）但没有明确说明。我（在回答这个问题后）澄清并更正了 Boost 后备箱中的文档。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T13:53:17.077

Boost 对“Prim 算法”的实现（Jarník 在 Prim 之前将近 30 年发现了该算法）使用 Dijkstra 算法的通用实现作为子程序。我敢肯定有人认为这*真的很聪明*。

Dijkstra 的算法需要非负权重来支持加法和比较，并且这些操作必须兼容（对于所有 x、y、z，如果 x <= y，则 x + z <= y + z）。在实践中，~~实例化这些操作的唯一有用方法是惯用的方法~~（我收回这一点；也可以用同样的方式打破 Dijkstra 算法），因此 Boost 对 Dijkstra 算法的实现明智地假设存在“无穷大”（`std::numeric_limits<vertex_distance_t>::max()`）。它还断言所有权重都是非负的。

相比之下，Prim 的算法需要仅支持比较的权重。您可能想知道“最小生成树”中的“最小值”在没有加法的情况下是什么意思，但是最小生成树的另一种表征是，对于从顶点 u 到顶点 v 的每条路径 P，P 中的最长边位于至少与从 u 到 v 的树路径中的最长边一样长。

**结果是 Boost 对 Prim 算法的实现做出了一些毫无根据的假设。您可以按如下方式围绕它们进行编码，但 Boost 似乎没有合同义务在未来不破坏此 hack。**

*   去掉加法运算符；它没有被使用。

*   由于 Boost 将断言您的所有权重均不小于默认构造值，因此让我们将默认值设为“负无穷大”。

    ```
    #include <limits>
    ...
    EdgeWeight() : weight(numeric_limits<int>::min()),
                   destinationId(numeric_limits<int>::min()) {} 
    ```

*   Boost需要“正无穷大”，所以我们需要专门化`std::numeric_limits`。

    ```
    namespace std {
    template<>
    struct numeric_limits<EdgeWeight> {
        static EdgeWeight max() { return EdgeWeight(numeric_limits<int>::max(),
                                                    numeric_limits<int>::max()); }
    };
    } 
    ```

*   您可以简化比较。

    ```
    bool operator<(const EdgeWeight& rhs) const {
        return (weight < rhs.weight ||
                (weight == rhs.weight && destinationId < rhs.destinationId));
    } 
    ```

# maven - spring roo更新maven配置错误

> ID：10098440
> 
> 赞同：2
> 
> 时间：2012-04-11T00:46:34.737
> 
> 标签：maven, spring-roo

我正在运行 springsource 工具套件 2.9.1。在我签入一个 spring roo 项目后，该项目无法识别它是一个动态 Web 项目，当我尝试更新 maven 配置时，它给出了这个错误

```
!MESSAGE An internal error occurred during: "Updating Maven Configuration".
!STACK 0
java.lang.NullPointerException
    at com.springsource.sts.roo.ui.internal.maven.RooProjectConfigurator.doConfigure(RooProjectConfigurator.java:56)
    at com.springsource.sts.maven.AbstractSpringProjectConfigurator.configure(AbstractSpringProjectConfigurator.java:36)
    at org.eclipse.m2e.core.project.configurator.AbstractLifecycleMapping.configure(AbstractLifecycleMapping.java:72)
    at org.eclipse.m2e.core.internal.project.ProjectConfigurationManager.updateProjectConfiguration(ProjectConfigurationManager.java:302)
    at org.eclipse.m2e.core.internal.project.ProjectConfigurationManager.updateProjectConfiguration(ProjectConfigurationManager.java:277)
    at org.eclipse.m2e.core.ui.internal.UpdateConfigurationJob.runInWorkspace(UpdateConfigurationJob.java:87)
    at org.eclipse.core.internal.resources.InternalWorkspaceJob.run(InternalWorkspaceJob.java:38)
    at org.eclipse.core.internal.jobs.Worker.run(Worker.java:54) 
```

有什么想法吗？

# c - 在 C 中获取当前时间（以毫秒为单位）？

> ID：10098441
> 
> 赞同：9
> 
> 时间：2012-04-11T00:46:44.513
> 
> 标签：c

C语言中Java的等价物是什么`System.currentTimeMillis()`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T00:51:08.640

检查`time.h`，也许类似于`gettimeofday()`功能。

你可以做类似的事情

```
struct timeval now;
gettimeofday(&now, NULL); 
```

`now.tv_sec`然后，您可以通过从和获取值来提取时间`now.tv_usec`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-11T01:05:38.360

在 Linux 和其他类 Unix 系统上，您应该使用[clock_gettime(CLOCK_MONOTONIC)](http://linux.die.net/man/3/clock_gettime)。如果这不可用（例如 Linux 2.4），您可以退回到[gettimeofday()](http://linux.die.net/man/2/gettimeofday)。后者的缺点是受时钟调整的影响。

在 Windows 上，您可以使用[QueryPerformanceCounter()](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644904%28v=vs.85%29.aspx)。

[我的这段代码](http://code.google.com/p/badvpn/source/browse/trunk/system/BTime.h)将上述所有内容抽象为一个简单的接口，该接口以 int64_t 形式返回毫秒数。请注意，返回的毫秒值仅用于相对用途（例如超时），与任何特定时间无关。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-07-14T07:06:31.343

```
#include <sys/time.h>
/**
* @brief provide same output with the native function in java called
* currentTimeMillis().
*/
int64_t currentTimeMillis() {
  struct timeval time;
  gettimeofday(&time, NULL);
  int64_t s1 = (int64_t)(time.tv_sec) * 1000;
  int64_t s2 = (time.tv_usec / 1000);
  return s1 + s2;
} 
```

我像`System.currentTimeMillis()`在 Java 中一样编写此函数，并且它们具有相同的输出。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-11T00:56:27.287

有[time()](http://www.cplusplus.com/reference/clibrary/ctime/time/)函数，但它返回秒，而不是毫秒。如果您需要更高的精度，您可以使用特定于平台的函数，例如 Windows 的[GetSystemTimeAsFileTime()](http://msdn.microsoft.com/en-us/library/windows/desktop/ms724397%28v=vs.85%29.aspx)或 *nix 的[gettimeofday()](http://linux.die.net/man/2/gettimeofday)。

如果您实际上并不关心日期和时间，而只想计算两个事件之间的时间间隔，如下所示：

```
long time1 = System.currentTimeMillis();
// ... do something that takes a while ...
long time2 = System.currentTimeMillis();
long elapsedMS = time2 - time1; 
```

那么 C 等效项是[clock()](http://www.cplusplus.com/reference/clibrary/ctime/clock/)。在 Windows 上，为此目的使用[GetTickCount()](http://msdn.microsoft.com/en-us/library/windows/desktop/ms724408%28v=vs.85%29.aspx)更为常见。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-11T00:49:02.907

看到这个线程：[http ://cboard.cprogramming.com/c-programming/51247-current-system-time-milliseconds.html](http://cboard.cprogramming.com/c-programming/51247-current-system-time-milliseconds.html)

它说 time() 函数精确到秒，更深的精度需要其他库......

# titanium - Titanium - 将变量传递到新窗口

> ID：10098442
> 
> 赞同：0
> 
> 时间：2012-04-11T00:46:57.313
> 
> 标签：titanium, appcelerator, titanium-mobile, appcelerator-mobile

我在我的 iphone Titan App 中传递变量时遇到问题。下面是我的 AppTabGroup.js 文件。有一个名为“grantEntrance”的事件监听器。当它被触发时，我需要将变量 event.name 和 event.email 传递给所有新选项卡。出于某种原因，这对我不起作用。我最终得到未定义的错误。我想我的问题是如何设置全局变量？与 event.name 类似，因此它显示在应用程序的任何位置。

```
function AppTabGroup() {
//declare module dependencies
var AppWindow = require('ui/AppWindow');
var OverviewWindow = require('ui/OverviewWindow');
var LeadWindow = require('ui/LeadWindow');
var CaseWindow = require('ui/CaseWindow');
var ResourcesWindow = require('ui/ResourcesWindow');

//create module instance
var self = Ti.UI.createTabGroup();

//create app tabs
var win1 = new OverviewWindow(L('Login')),
    win2 = new CaseWindow(L('Cases'));
    win3 = new LeadWindow(L('Leads'));
    win4 = new ResourcesWindow(L('Resources'));

var tab1 = Ti.UI.createTab({
    title: L('Login'),
    icon: '/images/KS_nav_ui.png',
    window: win1
});
win1.containingTab = tab1;

var tab2 = Ti.UI.createTab({
    title: L('Cases'),
    icon: '/images/KS_nav_views.png',
    window: win2
});
win2.containingTab = tab2;

var tab3 = Ti.UI.createTab({
    title: L('Leads'),
    icon: '/images/KS_nav_views.png',
    window: win3
});
win3.containingTab = tab3;

var tab4 = Ti.UI.createTab({
    title: L('Resources'),
    icon: '/images/KS_nav_mashup.png',
    window: win4
});
win4.containingTab = tab4;

//Load Initial Login tab
self.addTab(tab1);

//If Login is successful then the below even will fire and the other tabs will be loaded
Ti.App.addEventListener('grantEntrance', function(event)  
{
win2.name       = event.name;  
win2.email      = event.email;
self.addTab(tab2);
self.addTab(tab3);
self.addTab(tab4);
self.removeTab(tab1);

});  

return self;
};

module.exports = AppTabGroup; 
```

**下面是我的 CaseWindow.js 选项卡**

```
function AppWindow(title) {
var Main = Ti.UI.createWindow({
    title:title,
    backgroundColor:'white'
});

//Closed Case Button
var ccButton = Titanium.UI.createButtonBar({
    labels:['Closed'],
    backgroundColor:'#336699'
});
Main.setLeftNavButton(ccButton);

//New Case Button
var ncButton = Titanium.UI.createButtonBar({
    labels:['New Case'],
    backgroundColor:'#336699'
});
Main.setRightNavButton(ncButton);

ncButton.addEventListener('click', function() {
    //containingTab attribute must be set by parent tab group on
    //the window for this work
    Main.containingTab.open(Ti.UI.createWindow({
        title: L('newCaseWindow'),
        backgroundColor: 'white'
    }));
});

var msg = Titanium.UI.createLabel({  
text:"Your Name is " + win.name,
//text:"You have successfully logged in. Upon logging in we sent back your email address and your name. You can pass all kinds of data simply by creating objects on your window.\n\nYour email is:\n" + email + "\n\nyour name is:\n" + name,  
top:10,  
left:10,  
width:300,  
height:'auto'  
});  
    Main.add(msg);  

    return Main;
};

module.exports = AppWindow; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T11:05:28.667

app.js 文件中定义的变量应该在所有其他 JS 文件中可用。但是，您应该为这些全局变量创建一个命名空间，以确保它们不会干扰任何其他变量。

这是一个示例，说明您可以如何做到这一点。在 app.js 中：

```
var MyGlobalVars = {
    email: null,
    name: null
}; 
```

然后，您可以通过引用从应用程序中的任何位置获取和设置这些值：

```
MyGlobalVars.email = 'me@gmail.com';
alert('My email is: '+MyGlobalVars.email); 
```

* * *

但是，这些值不会存储在您的应用程序执行之间。如果您停止您的应用程序并重新启动它，这些变量将丢失，直到您再次设置它们。如果您希望存储信息以便在应用程序重新启动后可以再次访问它们，则可以使用 Ti.App.Properties 来存储它们。

这里有关于存储信息的不同方式的信息：

[https://wiki.appcelerator.org/display/guides/Working+with+Local+Data+Sources](https://wiki.appcelerator.org/display/guides/Working+with+Local+Data+Sources)

# jquery - 使用 JQuery 时如何停止 jsdom 自动限定 href 结果？

> ID：10098443
> 
> 赞同：1
> 
> 时间：2012-04-11T00:47:08.367
> 
> 标签：jquery, node.js, jquery-selectors, jsdom

该脚本使用 jsdom 和 jquery 来获取 a 标签的 href 属性的值。出于某种原因，相对于我在其中运行脚本的路径，它完全合格。我怎样才能*只*获得 href 值，而不是完全合格的？

```
var currentDoc = jsdom.jsdom('<html><head><title>href test</title></head><body><p><a href="test.html">Test</a></p></body></html>';, null, {});
var window = currentDoc.createWindow();
jsdom.jQueryify(window, 'jquery-1.4.2.min.js' , function() {
    console.log(window.$('a')[0]['href']);
}); 
```

（代码片段也在[https://gist.github.com/2355968](https://gist.github.com/2355968)）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T00:50:31.560

您想使用`getAttribute`而不是仅使用字段访问器。

```
var someLink = document.createElement("A");
someLink.href = "/foo";
someLink.href; // => "http://whatever.com/foo"
someLink.getAttribute("href"); // => "/foo" 
```

# python - py2exe“包含”模块：何时应该手动管理它们？

> ID：10098444
> 
> 赞同：6
> 
> 时间：2012-04-11T00:47:11.283
> 
> 标签：python, py2exe

什么时候需要指定要包含的模块？py2exe 不会搜索并包含以下内容：http: [//www.py2exe.org/index.cgi/FAQ](http://www.py2exe.org/index.cgi/FAQ)吗？

以及为什么它包含未使用的模块，例如[“Tkconstants”，“Tkinter”，“tcl”，“wx”]（我正在使用Qt，但在我的PC上安装了wx）然后需要被排除在外？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-11T01:12:03.330

py2exe 尝试从您的入口点脚本开始创建所有依赖项的图表。它不能总是 100% 正确，这就是为什么提供`includes`和`excludes`选项来微调包的原因。

请参阅此处的选项：http: [//www.py2exe.org/index.cgi/ListOfOptions](http://www.py2exe.org/index.cgi/ListOfOptions)

有时您不想要的模块会被包含在内，如果发生这种情况，只需将它们添加到排除项中。我想你的问题的答案是：当开箱即用的选项不能完全按照你想要的方式打包它时，手动管理 setup.py。

py2exe 的帮助文件实际上包含了一堆提示和技巧……一个专门解决包含 Tk 的问题：http: [//www.py2exe.org/index.cgi/TkInter](http://www.py2exe.org/index.cgi/TkInter)

提示和技巧的索引在这里： http: [//www.py2exe.org/index.cgi/Py2Exe](http://www.py2exe.org/index.cgi/Py2Exe)

我已经使用非常相似`py2app`的 osx 构建了大量应用程序。在不同版本的过程中，有时它们会改变发现依赖项的方式。它还使用各种“配方”来处理某些包，如 Qt。一个更新版本的 p2app 突然开始包含所有 PyQt 模块，而不仅仅是我使用的两个。所以，我不得不将它们添加到我的排除项中。

# sql - 使用 Java Servlet 登录和注册

> ID：10098448
> 
> 赞同：-2
> 
> 时间：2012-04-11T00:47:24.013
> 
> 标签：sql, jakarta-ee, servlets

我过去曾问过一个与此类似的问题，但这是一个略有不同的问题。我正在使用 Java Servlet 实现一个 Web 应用程序。我的登录和注册功能有问题。在我之前的问题中，我遇到了数据库连接问题。我已经解决了这个问题，现在在成功登录或注册新用户后让应用程序重定向到正确的页面时遇到问题。下面是登录 servlet 的代码：

```
package hw5package;

import java.io.IOException;
import java.io.PrintWriter;
import java.sql.*;
import java.util.UUID;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;

/**
 *
 * @author Tyler
 */
public class Login extends HttpServlet {

/**
 * Processes requests for both HTTP
 * <code>GET</code> and
 * <code>POST</code> methods.
 *
 * @param request servlet request
 * @param response servlet response
 * @throws ServletException if a servlet-specific error occurs
 * @throws IOException if an I/O error occurs
 */
protected void processRequest(HttpServletRequest request, HttpServletResponse response)
        throws ServletException, IOException {
    response.setContentType("text/html;charset=UTF-8");
    PrintWriter out = response.getWriter();
    try {
        String driver = "oracle.jdbc.driver.OracleDriver";
        String url = "jdbc:oracle:thin:@cci-ora02.uncc.edu:1521:class";
        String username = "teverha4";
        String password = "qwe123";

        out.println("<html>");
        out.println("<head>");
        out.println("<title>ITIS 4166 Project</title>");
        out.println("</head>");
        out.println("<body>");
        out.println("<div align='center'>");
        out.println("<h1>ITIS 4166 Project - Login Page</h1>");
        out.println("<h2>by: Tyler Everhart</h2>");

        out.println("<br />");
        out.println("<br />");
        out.println("<br />");
        out.println("<br />");

        out.println("<table width='20%' border='1' cellspacing='1' cellpadding='1'>");
        out.println("<form id='loginForm' name='loginForm' method='POST'>");
        out.println("<tr>");
        out.println("<td bgcolor='006F13' align='left' colspan='2'><b>Login</b></td>");
        out.println("</tr>");

        out.println("<tr>");
        out.println("<td bgcolor='35D551' align='left'>Username:</td>");
        out.println("<td bgcolor='35D551'>");
        out.println("<input type='text' name='username' id='username' />");
        out.println("</td>");
        out.println("</tr>");
        String passUsername = request.getParameter("username");

        out.println("<tr>");
        out.println("<td bgcolor='35D551' align='left'>Password:</td>");
        out.println("<td bgcolor='35D551'>");
        out.println("<input type='password' name='pwd' id='pwd' />");
        out.println("</td>");
        out.println("</tr>");
        String passPwd = request.getParameter("pwd");

        out.println("<tr>");
        out.println("<td bgcolor='006F13' align='center' colspan='2'>");
        out.println("<input type='submit' value='Submit' onclick='loginValidation()' /> ");
        out.println("<input type='reset' value='Reset' />");
        out.println("</td>");
        out.println("</tr>");
        out.println("</form>");
        out.println("</table>");
        out.println("<a href='Registration'>New User, Click Here to Register</a>");
        out.println("</div>");
        out.println("</body>");
        out.println("</html>");

        Class.forName(driver);

        Connection connection = DriverManager.getConnection(url, username, password);

        Statement statement = connection.createStatement();
        String query = "SELECT UserName, PassWord FROM UserLogin";

        ResultSet resultSet = statement.executeQuery(query);

        HttpSession session = request.getSession(true);

        while (resultSet.next()) {
            if ((passUsername.equals(resultSet.getString("UserName")) && passPwd.equals(resultSet.getString("PassWord")))) {
                String sessionID = UUID.randomUUID().toString();
                session.setAttribute("username", passUsername);
                session.setAttribute("sessionID", sessionID);
                response.sendRedirect("Categories");
            }
            else if (passUsername.equals("") || passPwd.equals("")) {
                out.println("Enter a username and password.");
            }
            else {
                out.println("Either your username or password is incorrect or could not be found.");
                out.println("Please try again, or click the link below to register.");
            }
        }
    }
    catch (ClassNotFoundException cnfe) {
        System.err.println("Error loading driver: " + cnfe);
        out.println("<tr>Error loading driver: " + cnfe + "</tr>");
    }
    catch (SQLException sqle) {
        System.err.println("Error with connection: " + sqle);
        out.println("<tr>Error with connection: " + sqle + "</tr>");
    }
    finally {            
        out.close();
    }
}

// <editor-fold defaultstate="collapsed" desc="HttpServlet methods. Click on the + sign on the left to edit the code.">
/**
 * Handles the HTTP
 * <code>GET</code> method.
 *
 * @param request servlet request
 * @param response servlet response
 * @throws ServletException if a servlet-specific error occurs
 * @throws IOException if an I/O error occurs
 */
@Override
protected void doGet(HttpServletRequest request, HttpServletResponse response)
        throws ServletException, IOException {
    processRequest(request, response);
}

/**
 * Handles the HTTP
 * <code>POST</code> method.
 *
 * @param request servlet request
 * @param response servlet response
 * @throws ServletException if a servlet-specific error occurs
 * @throws IOException if an I/O error occurs
 */
@Override
protected void doPost(HttpServletRequest request, HttpServletResponse response)
        throws ServletException, IOException {
    processRequest(request, response);
}

/**
 * Returns a short description of the servlet.
 *
 * @return a String containing servlet description
 */
@Override
public String getServletInfo() {
    return "Short description";
}// </editor-fold>
} 
```

这是注册 Servlet 的代码：

```
package hw5package;

import java.io.IOException;
import java.io.PrintWriter;
import java.sql.*;
import java.util.Random;
import java.util.UUID;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;

/**
 *
 * @author Tyler
 */
public class Registration extends HttpServlet {

/**
 * Processes requests for both HTTP
 * <code>GET</code> and
 * <code>POST</code> methods.
 *
 * @param request servlet request
 * @param response servlet response
 * @throws ServletException if a servlet-specific error occurs
 * @throws IOException if an I/O error occurs
 */
protected void processRequest(HttpServletRequest request, HttpServletResponse response)
        throws ServletException, IOException {
    response.setContentType("text/html;charset=UTF-8");
    PrintWriter out = response.getWriter();
    try {
        String driver = "oracle.jdbc.driver.OracleDriver";
        String url = "jdbc:oracle:thin:@cci-ora02.uncc.edu:1521:class";
        String username = "teverha4";
        String password = "qwe123";

        out.println("<html>");
        out.println("<head>");
        out.println("<title>ITIS 4166 Project</title>");
        out.println("</head>");
        out.println("<body>");
        out.println("<div align='center'>");
        out.println("<h1>ITIS 4166 Project - Registration Page</h1>");
        out.println("<h2>by: Tyler Everhart</h2>");

        out.println("<br />");
        out.println("<br />");
        out.println("<br />");
        out.println("<br />");

        out.println("<table width='25%' border='1' cellspacing='1' cellpadding='1'>");
        out.println("<tr>");
        out.println("<th bgcolor='006F13' align='left' colspan='2'>Register Account Information</th>");
        out.println("</tr>");

        out.println("<tr>");
        out.println("<td bgcolor='35D551' align='left'>Requested Username:</td>");
        out.println("<td bgcolor='35D551'>");
        out.println("<form id='enterForm' name='enterForm'>");
        out.println("<input type='text' name='requested_username' />");
        out.println("</td>");
        out.println("</tr>");
        String passUsername = request.getParameter("requested_username");

        out.println("<tr>");
        out.println("<td bgcolor='35D551' align='left'>Password:</td>");
        out.println("<td bgcolor='35D551'>");
        out.println("<input type='password' name='pwd' />");
        out.println("</td>");
        out.println("</tr>");
        String passPwd = request.getParameter("pwd");

        out.println("<tr>");
        out.println("<td bgcolor='35D551' align='left'>Confirm Password:</td>");
        out.println("<td bgcolor='35D551'>");
        out.println("<input type='password' name='pwd1' />");
        out.println("</td>");
        out.println("</tr>");
        String passPwd1 = request.getParameter("pwd1");

        out.println("<tr>");
        out.println("<td bgcolor='006F13' align='center' colspan='2'>");
        out.println("<input name='Submit' type='submit' value='Submit' /> ");
        out.println("<input type='reset' value='Reset' />");
        out.println("</td>");
        out.println("</tr>");
        out.println("</form>");
        out.println("</table>");
        out.println("</div>");
        out.println("</body>");
        out.println("</html>");

        Class.forName(driver);

        Connection connection = DriverManager.getConnection(url, username, password);

        Statement statement = connection.createStatement();

        HttpSession session = request.getSession();

        if (passPwd.equals("") || passPwd1.equals("")) {
            Integer registerError = Integer.valueOf(1);
            session.setAttribute("registerError", registerError);
            out.println("Please enter a valid password.");
        }
        else if (!passPwd.equals(passPwd1)) {
            Integer registerError = Integer.valueOf(2);
            session.setAttribute("registerError", registerError);
            out.println("Your password and confirm password does not match.");
        }
        else {
            String query2 = "INSERT INTO UserLogin (UserName, PassWord, StockAmt, TechnologyStock, UtilityStock) VALUES (?,?,?,?,?)";
            PreparedStatement stmt = connection.prepareStatement(query2);
            stmt.setString(1, passUsername);
            stmt.setString(2, passPwd);
            stmt.setInt(3, 0);
            stmt.setInt(4, 0);
            stmt.setInt(5, 0);
            stmt.executeQuery();
            session.setAttribute("sessionUsername", passUsername);
            String sessionID = UUID.randomUUID().toString();

            Random StockID1 = new Random();
            StockID1.nextInt(10);
            String insertDataSqlMicrosoft = "INSERT INTO StockInfo(StockID, UserID, Type, StockName, Owned, Price, Total) VALUES('" + StockID1 + "','" + passUsername + ",'Technology','Microsoft (MSFT)',0,32.75,0";
            PreparedStatement stmtMicrosoft = connection.prepareStatement(insertDataSqlMicrosoft);
            stmtMicrosoft.executeQuery();

            Random StockID2 = new Random();
            StockID2.nextInt(4);
            String insertDataSqlIntel = "INSERT INTO StockInfo(StockID, UserID, Type, StockName, Owned, Price, Total) VALUES('" + StockID2 + "','" + passUsername + "','Technology','Intel (INTC)',0,26.75,0)";
            PreparedStatement stmtIntel = connection.prepareStatement(insertDataSqlIntel);
            stmtIntel.executeQuery();

            Random StockID3 = new Random();
            StockID3.nextInt(9);
            String insertDataSqlDuke = "INSERT INTO StockInfo(StockID, UserID, Type, StockName, Owned, Price, Total) VALUES('" + StockID3 + "','" + passUsername + "','Utility','Duke Energy (DUK)',0,89.00,0";
            PreparedStatement stmtDuke = connection.prepareStatement(insertDataSqlDuke);
            stmtDuke.executeQuery();

            Random StockID4 = new Random();
            StockID4.nextInt(7);
            String insertDataSqlCable = "INSERT INTO StockInfo(StockID, UserID, Type, StockName, Owned, Price, Total) VALUES('" + StockID4 + "','" + passUsername + "','Utility','Time Warner Cable (TWC)',0,30.00,0)";
            PreparedStatement stmtCable = connection.prepareStatement(insertDataSqlCable);
            stmtCable.executeQuery();

            session.setAttribute("sessionID", sessionID);
            response.sendRedirect("Categories");
        }
    } 
    catch (ClassNotFoundException cnfe) {
        System.err.println("Error loading driver: " + cnfe);
        out.println("<tr>Error loading driver: " + cnfe + "</tr>");
    }
    catch (SQLException sqle) {
        System.err.println("Error with connection: " + sqle);
        out.println("<tr>Error with connection: " + sqle + "</tr>");
    } finally {            
        out.close();
    }
}

// <editor-fold defaultstate="collapsed" desc="HttpServlet methods. Click on the + sign on the left to edit the code.">
/**
 * Handles the HTTP
 * <code>GET</code> method.
 *
 * @param request servlet request
 * @param response servlet response
 * @throws ServletException if a servlet-specific error occurs
 * @throws IOException if an I/O error occurs
 */
@Override
protected void doGet(HttpServletRequest request, HttpServletResponse response)
        throws ServletException, IOException {
    processRequest(request, response);
}

/**
 * Handles the HTTP
 * <code>POST</code> method.
 *
 * @param request servlet request
 * @param response servlet response
 * @throws ServletException if a servlet-specific error occurs
 * @throws IOException if an I/O error occurs
 */
@Override
protected void doPost(HttpServletRequest request, HttpServletResponse response)
        throws ServletException, IOException {
    processRequest(request, response);
}

/**
 * Returns a short description of the servlet.
 *
 * @return a String containing servlet description
 */
@Override
public String getServletInfo() {
    return "Short description";
}// </editor-fold>
} 
```

当我尝试登录系统时没有显示错误消息，但是当我尝试注册新用户时收到以下错误消息：

连接错误：java.sql.SQLException：ORA-00917：缺少逗号

新用户仍会注册并添加到数据库中，但您不会像预期的那样被重定向到下一页。我已经寻找了一段时间试图找到解决此错误的方法，但到目前为止成功率为零。如果这被认为是转发，我深表歉意，但我发誓这是一个与以前完全不同的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T00:52:53.310

这是你的问题：

```
String insertDataSqlMicrosoft = "INSERT INTO StockInfo (StockID, UserID, Type, StockName, Owned, Price, Total) VALUES('" + StockID1 + "','" + passUsername + ",'Technology','Microsoft (MSFT)',0,32.75,0"; 
```

注意没有右括号。鉴于您提供的文字墙，这很难看到。请注意，此错误出现两次，并且正是您所期望的：在您构造 sql 语句以插入新用户之后，但在方法结束之前 - 特别是在随后的 sql 语句中。考虑您收到的错误（SQL 错误），您应该能够在不显示所有无关代码的情况下缩小范围。

# javascript - 如何翻译 d3.js 节点？

> ID：10098450
> 
> 赞同：4
> 
> 时间：2012-04-11T00:47:31.073
> 
> 标签：javascript, events, d3.js, geometry, force-layout

我有一个包含一组节点的 d3 力导向图：

```
var node = vis.selectAll("g.node")
              .data(json.nodes)
              .enter().append("svg:g")
              .attr("class", "node")
              .attr("id", function(d) { return "node" + d.index; })
              .attr("transform", function(d) { return "translate(" + d.x + "," + d.y + ")"; })
              .call(force.drag); 
```

这渲染得很好。

`div`当我显示带有 id的细节时，我现在想将这些节点向右平移（移动）200 像素`detail_container`。

我尝试了以下操作，但显示时节点没有任何反应`detail_container`（除了显示细节`div`）：

```
$('#detail_container').fadeIn('slow', function() {
    d3.selectAll("g.node").attr("transform", function(d) { return "translate(200, 0)"; });
}); 
```

该`d3.selectAll("g.node")`语句包含节点数据，我可以通过查看控制台中的数据来确认：

```
console.log(d3.selectAll("g.node")); 
```

作为另一种方法，我将缩放/平移行为附加到我的图表中：

```
var vis = d3.select("#position")
            .append("svg:svg")
            .attr("width", w)
            .attr("height", h)
            .attr("pointer-events", "all")
            .append("svg:g")
            .call(d3.behavior.zoom().on("zoom", redraw))
            .append("svg:g"); 
```

这工作正常。但是，这与鼠标交互，而不是与我的程序中发生的事件交互，所以是否有一种*编程*方式来调用缩放/平移行为，以便我可以完成我想要的翻译？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-11T02:02:33.817

如果您只想将节点向右移动，则可以通过设置变换来实现；如果您想要交互式平移和缩放，请仅使用缩放行为。

我不清楚为什么当您选择节点并设置变换时什么都没有发生，但我看到的一个问题是，通过直接在节点上设置变换属性，您正在覆盖力布局设置的 x & y 位置. 因此，您可能希望将所有节点放在另一个 G 元素中，以便您可以通过更改容器上的变换而不是单个节点来抵消所有节点。DOM 看起来像这样：

```
<g class="nodes">
  <g class="node" transform="translate(42,128)">
    <circle r="2.5">
    <text>First Node</text>
  </g>
  <g class="node" transform="translate(64,501)">
    <circle r="2.5">
    <text>Second Node</text>
  </g>
  …
</g> 
```

那么，如果你想将所有节点向右移动 200px，那就是：

```
d3.select(".nodes").attr("transform", "translate(200,0)"); 
```

要恢复班次，请删除容器的变换：

```
d3.select(".nodes").attr("transform", null); 
```

如果你想要*真正*的花哨，实现这种效果的另一种方法是改变力布局的重心，然后在显示或隐藏细节 DIV 时重新加热图形。这将导致节点平滑地转移到一个新位置，为细节容器让路。您可以在 Shan Carter 的可视化中看到一个示例，[即切割奥巴马 2013 年预算提案的四种方法](http://www.nytimes.com/interactive/2012/02/13/us/politics/2013-budget-proposal-graphic.html)：单击“支出类型”按钮并观察圆圈的中心位置。或者，请参阅[自定义重力这个示例](http://bl.ocks.org/1804919)。

# reference - 参考监视器与。系统调用包装器

> ID：10098457
> 
> 赞同：0
> 
> 时间：2012-04-11T00:48:13.210
> 
> 标签：reference, system, call, wrapper, monitor

我试图根据它们的属性和用途清楚地区分这两个术语/技术。我最感兴趣的是它们之间的区别。

我知道它们通过插入系统调用以相同的方式工作。或者我可能错了！

但是，我仍然对系统包装器属于什么层和模式（用户、内核）以及参考监视器属于什么层和模式感到困惑。

用尽可能少的词。请告诉我您对这两种插入技术的了解。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T01:27:03.067

这就是我对两者的解释：

**系统调用包装器** 系统调用包装器是包装系统调用的用户模式代码。也就是说，它在系统调用之前和/或之后执行以验证某些属性。一个简单的例子是在 execve 周围添加一层代码来检查权限或记录此操作。照原样，libc 和其他库已经包装了系统调用。您通常不会直接使用 execve、clone、open、read 或 write - 而是有 execv、fork、fopen、fread 和 fread 等版本，以使程序员的工作更轻松一些。

**参考监视器** 另一方面，我认为参考监视器的功能有些不同。它试图调解对资源的访问，这可以在用户和内核中完成，并且可以干预系统调用甚至更低。

I think the best way to distinguish the two is that one (system call wrapper) is an implementation, whereas the other (reference monitor) is an idea or policy you would like to enforce. That is, you could wrap system calls in a program to ensure access control and proper resource allocation, but the idea and the implementation are not one and the same.

Note: I'm not very familiar with reference monitors. I used [http://en.wikipedia.org/wiki/Reference_monitor](http://en.wikipedia.org/wiki/Reference_monitor) and [http://www.cse.psu.edu/~tjaeger/cse544-s10/papers/refmon.pdf](http://www.cse.psu.edu/~tjaeger/cse544-s10/papers/refmon.pdf) as partial sources.

# sql - SQL Server 更新列组

> ID：10098469
> 
> 赞同：1
> 
> 时间：2012-04-11T00:49:58.610
> 
> 标签：sql, sql-server, group-by

**表A**

```
int  class del
null  13
null  13
null  13
12    13
null  23
null  23
null  87
null  74
null  74
null  65
32    65 
```

所以，我想填充 del = 'A' 对于给定的类，它的所有 int 都是 null 否则它应该填充 B。

预期结果：

**表A**

```
int  class del
null  13    B
null  13    B
null  13    B
12    13    B
null  23    A
null  23    A
null  87    A
null  74    A
null  74    A
null  65    B
32    65    B 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T01:06:16.603

```
update
    TableA
set
    del = Case
            when mcolint is null Then 'A'
            Else 'B'
    End
from
    TableA T
inner join
    (
        select
            class,
            MAX(colint) mcolint
        from
            TableA
        group by
            class
    ) T1
on
    T.class = T1.class 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T14:25:28.673

在 SQL Server 2005+ 中，您可以执行以下操作：

```
WITH calcDelValue AS (
  SELECT
    *,
    CASE
      WHEN MAX(int) OVER (PARTITION BY class) IS NULL THEN 'A'
      ELSE 'B'
    END AS Value
  FROM TableA
)
UPDATE calcDelValue
SET del = Value 
```

*有关窗口聚合函数*的更多信息，请参阅[OVER 子句 (Transact-SQL)](http://msdn.microsoft.com/en-us/library/ms189461%28v=sql.90%29.aspx)，有关*CTE（公共表表达式）*的信息，请参阅[WITH common_table_expression (Transact-SQL](http://msdn.microsoft.com/en-us/library/ms175972%28v=sql.90%29.aspx) ) 。

# android - 如何将 AdSense 添加到我的应用

> ID：10098484
> 
> 赞同：8
> 
> 时间：2012-04-11T00:51:55.423
> 
> 标签：android, adsense

几天前，我输入了我的 Admob 帐户。它有关于 Google 将在 01/05 不再支持 Admob 的信息。然后它要求创建一个 AdSense 帐户。现在我创建了 AdSense 帐户，但我不知道如何在我的应用中添加 AdSense。谁能教我怎么做？非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-06-03T12:11:31.853

> 您提到的消息不再显示在 Admob 注册或登录后。

AdMob 要求您拥有有效的 AdSense 帐户和 AdWords 帐户。如果您没有其中一个或两个帐户，Google 将帮助您在注册过程中创建它们并将它们连接到您的 Google 帐户。

[您可以在此处的 5 步注册流程](https://apps.admob.com/signup/)中注册 Admob 。注册后，您将被重定向到[admob 主页](https://apps.admob.com/#home)。您可以[获利](https://apps.admob.com/#monetize)、[推广](https://apps.admob.com/#promote)和[分析](https://apps.admob.com/#analyze)新应用。

# powershell - 如何在代理后面使用 FTP 在 Powershell 中上传？

> ID：10098485
> 
> 赞同：5
> 
> 时间：2012-04-11T00:52:08.960
> 
> 标签：powershell, proxy, ftp

我正在尝试在 Powershell 中使用 FTP 上传文件。我`FtpWebRequest`稍后使用`GetRequestStream`，但此方法返回错误：

> “使用 HTTP 代理时不支持请求的 FTP 命令。”

我确实支持代理并且必须这样做。

在代理后面如何通过 Powershell 上传？

这将仅从`.ps1`Powershell 脚本运行。

我也试过：

```
$webclient = New-Object System.Net.WebClient
$uri = New-Object System.Uri($server)

$webclient.UploadFile($uri, "C:\Test\1234567.txt") 
```

哪里`$server`和那个文件是有效的。但是该代码返回此错误：

```
"An exception occurred during a WebClient request."
At C:\Test\script.ps1:101 char:26
+     $webclient.UploadFile <<<< ($uri, "C:\Test\1234567.txt")
    + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException
    + FullyQualifiedErrorId : DotNetMethodException 
```

我还在文件路径中尝试了双反斜杠，但没有帮助。

我所在的代理只涉及 HTTP，而不涉及 FTP。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T03:02:42.083

您确定您的代理支持 FTP，还是仅支持 HTTP？看到这个线程：

[使用 HTTP 代理上传 FTP 文件](https://stackoverflow.com/questions/161200/ftp-file-upload-with-http-proxy)

对于 WebClient，我过去曾使用过它，尽管它是用于 HTTP 的，但您可以尝试一下：

```
$wc = New-Object System.Net.WebClient
$wc.Headers.Add("User-Agent","Mozilla/4.0+")        
$wc.Proxy = [System.Net.WebRequest]::DefaultWebProxy
$wc.Proxy.Credentials = [System.Net.CredentialCache]::DefaultNetworkCredentials
$wc.UploadFile($uri, "C:\Test\1234567.txt") 
```

注意 - “UploadFile 方法将本地文件发送到资源。此方法使用 STOR 命令上传 FTP 资源。对于 HTTP 资源，使用 POST 方法。”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-04-12T08:54:14.890

我有一个例外：

> 使用“2”参数调用“UploadFile”的异常：“WebClient 请求期间发生异常。”

跟踪显示，当我使用 ftp-uri 并向 web 客户端添加代理时，没有启动任何连接。（既不是服务器也不是代理）

我支持一个带有身份验证的 ftp 代理，它对我有用的唯一方法是：

```
$LocalFile = "C:\Temp\test.csv"
$FtpFile = "ftp://$ProxyUser:$ProxyPassword@$ProxyServer:21/ftp_test.csv"

$uri = New-Object System.Uri($FtpFile)
$webclient = New-Object System.Net.WebClient
$webclient.Credentials = New-Object System.Net.NetworkCredential("$FtpUser@$FtpServer","$FtpPassword")
$webclient.UploadFile($uri, $LocalFile) 
```

# linux - 在 Linux 中共享可执行内存页？

> ID：10098489
> 
> 赞同：2
> 
> 时间：2012-04-11T00:52:47.130
> 
> 标签：linux, shared-libraries, shared-memory, ld, dyld

为了节省空间，是否可以在 Linux 上共享可执行页面？我知道有共享内存 API 可用于在不同进程之间共享内存，但我不认为这意味着要使用它。

基本上，我想要一个共享内存区域，可以将一些常用的共享库加载到其中。我想让动态链接器链接到预加载的（只读）图像，而不是必须将所有共享库图像加载到每个进程中（这似乎是一种浪费）。

*这在 Linux 内核上可行吗？*Darwin 内核使用 Mach VM 的一个称为**commpages**的功能来实现这一点（dyld 共享缓存存储在那里）。commpages 可以访问并在每个进程之间共享。

澄清一下，我知道共享对象（库）是什么。目前，动态链接器在 Linux 上所做的是将所有需要的库加载到程序的地址空间中，这意味着每个链接到 libc 的应用程序（例如）将在其地址空间的某个位置有一个 libc 的图像。在 Darwin 上，可以通过将 libc 的可执行（和其他只读）部分放在**一组共享内存页面**上来消除此问题。共享图像的可写部分仍然是分开的。

**编辑：**我知道 ELF 格式不支持分隔共享库的 DATA 和 TEXT 段。我没有使用 ELF，*我使用的是不同的二进制格式（使用我自己的 binfmt 内核模块和我自己的动态链接器）*。如果 Linux 内核支持类似 commpage 的功能，我很感兴趣。

**编辑2：**我能想到的唯一方法是在内核中分配一大块内存并将其映射到每个执行的二进制文件中。第一次执行任何二进制文件时，动态链接器可以取消保护它，用所需数据填充它并保护它。然后不知何故，内核必须确保内存段没有被其他任何东西修改，因为它会打开一个巨大的安全漏洞。其他

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-11T19:48:08.360

正如 geekosaur 所说，Linux 已经做到了这一点。

在应用程序启动时，动态链接器 (ld.so)`mmap()`是共享库。`mmap()`它对每个库执行多次调用：

*   `mmap(PROT_READ|PROT_EXEC)`对于可执行部分（即.text）
*   `mmap(PROT_READ|PROT_WRITE)`对于数据（即 .data 和 .bss）

（您可以使用 自行检查`strace`。）

内核是一段聪明的代码，它意识到由偏移量和 inode（通过 fd 知道）标识的可执行部分已经被映射。由于它是只读的，因此没有必要为其分配更多内存。

这也意味着，如果您有任何其他文件是您`mmap()`从多个应用程序中只读的，则内存也只会被消耗一次。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-11T00:55:40.160

Linux 已经这样做了；事实上，这就是*共享*对象的意义所在。

# c# - 角的 DrawLine 偏移

> ID：10098493
> 
> 赞同：0
> 
> 时间：2012-04-11T00:53:29.283
> 
> 标签：c#, .net, graphics, gdi+

我有一个程序允许用户操纵不断增长的线（Tron 游戏），但我遇到的问题是当玩家转身时，角落的出现方式存在问题。对于 1px 宽的笔，没有问题，但是当笔的大小增加时，问题变得更加明显....

这是代码：

```
 canvas = this.CreateGraphics();
    foreach (LightBike b in bikes) //draw bikes
    {
        canvas.DrawLine(new Pen(b.color, BIKE_SIZE), b.getPreviousLocation(), b.location);
        grid[b.location.X, b.location.Y] = bikes.IndexOf(b)+1;
    } 
```

我将碰撞存储在一个 2D 网格中，该网格是 from 本身的大小。在每个位置，我给出数组中自行车的值。

在这里看到 15px 宽： ![Tron 偏移](../Images/39f7c5fe83a8bfdffbfae0336cf6c4dc.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T00:57:06.583

这是因为线在您选择的点结束。修复很简单 - 只需告诉在`Pen`每行的开头和结尾画一个方形帽：

```
canvas.DrawLine(new Pen(b.color, BIKE_SIZE) {
    EndCap = System.Drawing.Drawing2D.LineCap.Square,
    StartCap = System.Drawing.Drawing2D.LineCap.Square
}, b.getPreviousLocation(), b.location); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-19T17:49:10.207

不要使用**DrawLine**命令绘制连接线。如果你不是在循环中一个接一个地绘制线条，而是使用**DrawLines**命令将线条全部绘制在一个位置，线条看起来会好很多。并且：一旦你开始使用 alpha 通道，即使是最好的 LineCaps 也会看起来非常难看..

# java - processbuilder 从 Java 运行命令

> ID：10098497
> 
> 赞同：3
> 
> 时间：2012-04-11T00:54:21.833
> 
> 标签：java, callback, processbuilder

我正在从 Java 代码运行 shell 命令，`ProcessBuilder.start()` 当命令完成执行时，我需要一个回调（或某种通知）。该命令需要 10-15 秒才能执行。可以使用`ProcessBuilder`吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T00:56:43.043

是的，这是可能的。您可以调用`waitFor()`Process，并等待它返回，然后分析返回的值以确保它为0，或者如果不响应错误。这通常在后台线程中完成，以免占用当前线程。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-11T00:58:58.253

ProcessBuilder的`start()`方法明确声明它返回一个 Process，其 API 在[这里](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Process.html)。该 Process 具有可以在其上调用的方法，包括 waitFor，它将在 Process 完成时唤醒当前线程。您需要做的就是启动一个线程，给它这个进程并让它在进程完成时或超时后发出信号。

# php - 如何在不回显的情况下将 PHP *variable* 发送回 jQuery？

> ID：10098501
> 
> 赞同：0
> 
> 时间：2012-04-11T00:55:04.377
> 
> 标签：php, jquery, variables

我正在使用 ajax() 函数将字符串发送到 PHP 文件。

如果成功，PHP 文件会回显“字符串验证成功”。但我也想将实际字符串发送回 jQuery 并将其放入 div 中。

如何发送回该字符串，而不必将其与确认消息一起回显？

或者我应该将两条消息都放入一个字符串中，将其发送到 jQuery 并让 jQuery 拆分该字符串？最好的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T01:03:05.993

将其他人所说的内容放入代码中，您可以将 PHP 脚本设置为返回 JSON 编码的对象，如下所示：

```
$result = array(
  'message' => 'the validation of the string was successful',
  'original' => 'string sent by client'
);

echo json_encode($result); 
```

在客户端，您可以从回调函数中访问每个部分，如下所示：

```
function (result) { 
  alert(result.message);
  // do something with result.original
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T00:59:59.560

我将返回带有字符串和验证消息的 JSON。

# haskell - Haskell TVar 的容器

> ID：10098506
> 
> 赞同：2
> 
> 时间：2012-04-11T00:56:21.013
> 
> 标签：haskell, concurrency, containers, stm

我有一个游戏服务器，它使用 forkIO 为每个客户端生成一个线程。例如，我想与所有客户共享客户列表和怪物列表。

我的第一个想法是为包含两个列表的数据类型创建一个 TVar 容器，但假设两个线程同时更改客户端和怪物，如果我理解该部分正确，这将回滚其中一个。这将是不必要的回滚。

第二个想法是制作列表 TVar，然后将它们作为参数传递，但如果要添加更多列表，我宁愿将它们放在容器中以保持代码清洁和易于管理。

有没有办法在一个容器中传递几个 TVar 或者我是否过度考虑了第一个想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T02:53:30.903

只创建一个包含 2`TVar`的包含数据类型怎么样？这与仅将`TVar`s 作为单独的参数传递没有太大区别，但它使它们“打包”在一起，您似乎更喜欢这样。

```
data GameState = GameState {clients :: TVar [Client], monsters :: TVar [Monster]} 
```

# python - 无法安装 pymssql

> ID：10098507
> 
> 赞同：17
> 
> 时间：2012-04-11T00:56:23.817
> 
> 标签：python, macos

我试图安装 pymssql 。为此，我使用 pip 并根据[此处](http://www.pip-installer.org/en/latest/installing.html#using-the-installer)提到的说明使用虚拟环境安装它但是当我说

(my_new_env)tmp> pip install pymssql

我看到以下错误：

> 下载 pymssql-2.0.0b1-dev-20111019.tar.gz (5.0Mb): 5.0Mb 下载运行 setup.py egg_info 包 pymssql
> Traceback (最近一次调用最后): 文件 "", line 14, in File "/private /tmp/my_new_env/build/pymssql/setup.py"，第 41 行，从 Cython.Distutils 导入 build_ext 作为 _build_ext ImportError：没有名为 Cython.Distutils 的模块命令 python setup.py egg_info 的完整输出：回溯（最近一次调用最后):
> 
> 文件“”，第 14 行，在
> 
> 文件“/private/tmp/my_new_env/build/pymssql/setup.py”，第 41 行，在
> 
> 从 Cython.Distutils 导入 build_ext 作为 _build_ext
> 
> **ImportError：没有名为 Cython.Distutils 的模块**

我在谷歌上搜索了一下这个问题。我必须安装 Cython 还是什么？如果是这样，这个方向的一些说明会有所帮助。谢谢！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-11T03:22:05.933

您需要安装 Cython。它在 PyPi 上可用，因此您可以执行以下操作：

```
pip install cython 
```

这可能在 Windows 上不起作用（我真的不知道），但如果它不检查这个页面： [http ://cython.org/#download](http://cython.org/#download)

在该页面上，您将看到一个指向 Windows 安装程序的链接。选择正确的，你应该很高兴。

# iphone - 如何将 plist 保存到 NSUserDefaults

> ID：10098512
> 
> 赞同：3
> 
> 时间：2012-04-11T00:57:05.407
> 
> 标签：iphone, ios, plist, nsuserdefaults

我正在尝试将`.plist`我创建的数据保存到我`NSUserDefaults`的数据中，以便我可以保存我放入其中的数据，因此如果应用程序停止（从多任务栏中删除），我不会丢失这些值。

我在[这里被指出了本教程](http://www.cocoadev.com/index.pl?NSUserDefaults)

其中有这个示例代码。

```
-(void)saveToUserDefaults:(NSString*)myString
{
    NSUserDefaults *standardUserDefaults = [NSUserDefaults standardUserDefaults];

    if (standardUserDefaults) {
        [standardUserDefaults setObject:myString forKey:@"Prefs"];
        [standardUserDefaults synchronize];
    }
}

-(NSString*)retrieveFromUserDefaults
{
    NSUserDefaults *standardUserDefaults = [NSUserDefaults standardUserDefaults];
    NSString *val = nil;

    if (standardUserDefaults) 
        val = [standardUserDefaults objectForKey:@"Prefs"];

    return val;
} 
```

我想要一些帮助的是，以上内容与储蓄有何关系`.plists`？

我有一个`.plist`控制器类，它读取捆绑包在根文档中`.plist`创建一个新`.plist`的，然后读取并写入它......所以当应用程序退出或关闭时我如何使用上面的来保存它？

这就是我加载和写入我`.plist`的，目前使用单例并且它在自己的类中的方式。

```
#pragma mark Singleton Methods
+ (id)sharedManager {
    @synchronized(self) {
        if (sharedMyManager == nil)
            sharedMyManager = [[self alloc] init];
    }
    return sharedMyManager;
}
- (id)init {
    if (self = [super init]) {

        // Data.plist code
        // get paths from root direcory
        NSArray *paths = NSSearchPathForDirectoriesInDomains (NSDocumentDirectory, NSUserDomainMask, YES);
        // get documents path
        NSString *documentsPath = [paths objectAtIndex:0];
        // get the path to our Data/plist file
        NSString *plistPath = [documentsPath stringByAppendingPathComponent:@"EngineProperties.plist"];

        // check to see if Data.plist exists in documents
        if (![[NSFileManager defaultManager] fileExistsAtPath:plistPath])
        {
            // if not in documents, get property list from main bundle
            plistPath = [[NSBundle mainBundle] pathForResource:@"EngineProperties" ofType:@"plist"];
        }

        // read property list into memory as an NSData object
        NSData *plistXML = [[NSFileManager defaultManager] contentsAtPath:plistPath];
        NSString *errorDesc = nil;
        NSPropertyListFormat format;
        // convert static property liost into dictionary object
        NSDictionary *tempRoot = (NSMutableDictionary *)[NSPropertyListSerialization propertyListFromData:plistXML mutabilityOption:NSPropertyListMutableContainersAndLeaves format:&format errorDescription:&errorDesc];
        if (!tempRoot)
        {
            NSLog(@"Error reading plist: %@, format: %d", errorDesc, format);
        }
        // assign values
        self.signature = [tempRoot objectForKey:@"Signature"];
        self.version = [tempRoot objectForKey:@"Version"];
        self.request = [tempRoot objectForKey:@"Request"];
        self.dataVersion = [tempRoot objectForKey:@"Data Version"];

        man = [cacheValue objectForKey:@"Man"];
        mod = [cacheValue objectForKey:@"Mod"];
        sub = [cacheValue objectForKey:@"SubMod"];

        cacheValue = [tempRoot objectForKey:@"Cache Value"];
    }

    - (void) saveData:(NSString *)methodName signature:(NSString *)pSignature Version:(NSNumber *)pVersion request:(NSNumber *)rNumber dataVersion:(NSNumber *)dvReturned cacheValue:(NSNumber *)cValue;
    {
        // get paths from root direcory
        NSArray *paths = NSSearchPathForDirectoriesInDomains (NSDocumentDirectory, NSUserDomainMask, YES);
        // get documents path
        NSString *documentsPath = [paths objectAtIndex:0];
        // get the path to our Data/plist file
        NSString *plistPath = [documentsPath stringByAppendingPathComponent:@"EngineProperties.plist"];

        // set the variables to the values in the text fields
        self.signature = pSignature;
        self.version = pVersion;
        self.request = rNumber;
        self.dataVersion = dvReturned;

        //do some if statment stuff here to put the cache in the right place or what have you.
        if (methodName == @"manufacturers")
        {
            self.man = cValue; 
        }
        else if (methodName == @"models")
        {
            self.mod = cValue;
        }
        else if (methodName == @"subMod")
        {
            self.sub = cValue;
        }

        self.cacheValue = [NSDictionary dictionaryWithObjectsAndKeys:
                           man, @"Manufacturers",
                           mod, @"Models",
                           sub, @"SubModels", nil];

        NSDictionary *plistDict = [NSDictionary dictionaryWithObjectsAndKeys:
                                   signature, @"Signature",
                                   version, @"Version",
                                   request, @"Request",
                                   dataVersion, @"Data Version",
                                   cacheValue, @"Cache Value", nil];

        NSString *error = nil;
        // create NSData from dictionary
        NSData *plistData = [NSPropertyListSerialization dataFromPropertyList:plistDict format:NSPropertyListXMLFormat_v1_0 errorDescription:&error];

        // check is plistData exists
        if(plistData)
        {
            // write plistData to our Data.plist file
            [plistData writeToFile:plistPath atomically:YES];

            NSString *myString = [[NSString alloc] initWithData:plistData encoding:NSUTF8StringEncoding];
            //        NSLog(@"%@", myString);
        }
        else
        {
            NSLog(@"Error in saveData: %@", error);
            //        [error release];
        }
    }

    @end 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-11T01:47:42.303

你不能写 a `.plist`into `NSUserDefaults`，至少实际上不能。要实现这一点，您必须从其中写入特定的密钥，`.plist`这`NSUserDefaults`基本上就像保存所有数据的两个副本。您可以将其`NSUserDefaults`视为`.plist`可以读取和写入的不可见文件，而实际上无法看到文件。使用`NSUserDefaults`，即使应用程序在多任务处理中被杀死，您也可以恢复保存的值。

但是，您如何选择`.plist`以及`NSUserDefaults`应该基于您需要保存多少数据。Apple 建议仅将少量数据保存到`NSUserDefaults`. 如果您需要保存大量信息，那么`.plist`就是要走的路。要么，要么当然`Core-Data`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T01:38:31.203

.plist 是一个键值对文件。这本质上是一本字典。当您将数据存储在 .plist 中时，您就是在持久化它。即使您的应用程序被杀死，您也可以取回它。

NSUserDefaults 也是如此。它更干净，更快捷。因此，任何一种方法都足够了。

# php - 共享主机是否授予对 INFORMATION_SCHEMA 的访问权限？

> ID：10098514
> 
> 赞同：1
> 
> 时间：2012-04-11T00:57:17.947
> 
> 标签：php, mysql, hosting, information-schema

我想知道共享主机是否通常向其用户授予对该表的访问权限。

依靠它从脚本中快速获取当前数据库结构可以吗？

我的想法是使用这些信息来清理输入 lol。例如：`UPDATE table SET field = ?`

`?`可以是一个参数（我正在使用 PDO），但是如果我想创建`field`一个变量呢？由于 PDO 不支持这一点，我可以使用信息模式中的数据来确定该列是否存在......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T01:04:23.807

任何 MySQL 用户都可以访问`SELECT`on `information_schema`，因为用户*必须*能够读取`information_schema`才能读取他被授予访问权限的数据库。

您可以通过创建一个仅对`SELECT`单个数据库中的单个表具有权限的新用户来测试这一点。用户将能够读取`information_schema`与该数据库中已授予表相关的任何内容，但不能读取尚未授予的任何内容。

```
/* Create a new user with only SELECT on one db: */
GRANT SELECT ON newdb.* TO newuser@localhost IDENTIFIED BY 'passwd';

/* Login with that user and list databases */
mysql> show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| newdb              |
+--------------------+ 
```

[从相关文档：](http://dev.mysql.com/doc/refman/5.0/en/information-schema.html)

> 每个 MySQL 用户都有权访问这些表，但只能看到表中与用户具有适当访问权限的对象相对应的行。在某些情况下（例如，INFORMATION_SCHEMA.ROUTINES 表中的 ROUTINE_DEFINITION 列），权限不足的用户会看到 NULL。

# javascript - 从设定的日期和时间开始计数

> ID：10098520
> 
> 赞同：0
> 
> 时间：2012-04-11T00:58:08.107
> 
> 标签：javascript

我有一个网页，当您单击开始巡逻时，会开始计算您单击按钮后的时间。因为我需要将它存储在服务器（ASP.NET）上，并且因为我想在他们重新加载页面时恢复计数，所以我从服务器获得了两个变量。第一个变量是他们单击开始巡逻按钮的服务器时间。第二个变量是本地时间与服务器时间的偏移量，因此我们 100% 准确地确定了时间量，并且由于本地时间，它不会关闭。以下代码有效，但时间已过。当前本地时间是 19:53，如果此函数运行，它将从“18:00:00”开始，然后上升“18:00:01”、“18:00:02”等...如果本地时间是 20:53 将是“19:00:00”。为什么这个功能会这样做，我该如何纠正这个问题？

**巡逻**时间当前时间偏移是返回的偏移值（例如：-729）

**巡逻**时间开始是用户开始巡逻的服务器上的日期和时间（例如：2012 年 4 月 10 日 20:01:13）

```
function UpdatePatrolTime() {
        var patroltimeCurrentTime = new Date();

        patroltimeCurrentTime.setTime(patroltimeCurrentTime.getTime() + patroltimeCurrentTimeoffset);

        var patroltimeStarted = new Date(patroltimeStart);
        var CompareDateTime = new Date((patroltimeCurrentTime.getTime()-patroltimeStarted.getTime()));

        currentHours = CompareDateTime.getHours();
        currentMinutes = CompareDateTime.getMinutes();
        currentSeconds = CompareDateTime.getSeconds();

        currentHours = (currentHours < 10 ? "0" : "") + currentHours;
        currentMinutes = (currentMinutes < 10 ? "0" : "") + currentMinutes;
        currentSeconds = (currentSeconds < 10 ? "0" : "") + currentSeconds;

        var currentTimeString = currentHours + ":" + currentMinutes + ":" + currentSeconds

        document.getElementById("patroltime").firstChild.nodeValue = currentTimeString;
    } 
```

而 <span> 控件：

```
<span id="patroltime">00:00:00</span> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T01:18:21.717

我从“ **[How to get the time elapsed from a json date?](https://stackoverflow.com/questions/9297974/how-to-get-the-time-elapsed-from-a-json-date)** ”中找到了一个解决方案，但如果有人能够弄清楚我上面的解决方案为什么不起作用（所以我可以奖励某人为我和可能的其他人解释）我会奖励他们积分。我的解决方案是更改以下代码：

```
 var patroltimeStarted = new Date(patroltimeStart);
    var CompareDateTime = new Date((patroltimeCurrentTime.getTime()-patroltimeStarted.getTime()));

    currentHours = CompareDateTime.getHours();
    currentMinutes = CompareDateTime.getMinutes();
    currentSeconds = CompareDateTime.getSeconds(); 
```

至

```
 var patroltimeStarted = new Date(patroltimeStart);
    var diff = (patroltimeCurrentTime-patroltimeStarted);

    currentHours = Math.floor(diff / 3600000);
    currentMinutes = Math.floor((diff % 3600000) / 60000);
    currentSeconds = Math.floor(((diff % 3600000) % 60000) / 1000); 
```

# asp.net-mvc-3 - .NET 反射。通过属性名获取方法

> ID：10098521
> 
> 赞同：0
> 
> 时间：2012-04-11T00:58:09.167
> 
> 标签：asp.net-mvc-3, reflection

在我的 MVC 3 项目中，我有一种方法，可以扫描 dll 中的文件夹 bin 和一些负载。然后我过滤并获取列表控制器类。然后我过滤并尝试列出返回 ActionResult 的方法。但我得到了复制方法。我尝试按属性过滤。但什么都没有得到

```
private void GetControllers()
{
        IEnumerable<FileInfo> files = this.GetFileList();

        foreach (var fileInfo in files)
        {
            if (fileInfo.Name != "SGN.Framework.dll" && fileInfo.Name != "SGN.Controls.dll")
            {
                Assembly assembly = Assembly.LoadFile(fileInfo.FullName);
                AssemblyName asamName = assembly.GetName();
                IList<Type> myType =
                    assembly.GetTypes().Where(item => item.Name.Contains("Controller")).Where(
                        item => item.Name != "AdminsController" && item.Name != "ModuleController").ToList();

                foreach (var type in myType)
                {
                    var m =
                        type.GetMethods().Where(
                            item =>
                            item.ReturnType == typeof(ActionResult)).Except(type.GetCustomAttributes(true).Where(i => i != typeof(ActionInfoAttribute)));
                }
            }
        }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-30T14:58:30.633

我知道这个问题很老了。但也许我的回答会对某人有所帮助。对于这种情况，以下代码将起作用：

```
type.GetMethods().Where(
    item =>
    item.ReturnType == typeof(ActionResult) && item.IsDefined(typeof(ActionInfoAttribute), false)); 
```

# iphone - 带有可重用项目的 UIScrollView

> ID：10098523
> 
> 赞同：0
> 
> 时间：2012-04-11T00:58:13.287
> 
> 标签：iphone, objective-c, uitableview, uiscrollview, uikit

由于一个非常不幸的障碍，我无法使用 UITableView 并且被 UIScrollView 卡住了。原因是项目框架是动态的，它们之间不应该有空间。因此，例如，我得到 10 件物品，其中 8 件可以在左侧，2 件非常大的可以在右侧。所有项目都是根据图像或视频等网络内容构建的。

所以我的问题是如何高效且尽可能无缝地从内存中卸载项目并将它们重新加载？我应该研究哪些滚动视图委托方法？

另外，我的滚动视图没有分页，也不适用。一次屏幕上可能有 20 个项目或 2 个项目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T01:03:05.227

Eugene，去年在 WWDC 上有一个关于高级 UIScrollView 技术的精彩演讲。可以在这里找到： [https ://developer.apple.com/videos/wwdc/2011/includes/advanced-scrollview-techniques.html#advanced-scrollview-techniques](https://developer.apple.com/videos/wwdc/2011/includes/advanced-scrollview-techniques.html#advanced-scrollview-techniques)

我相信它会回答你的问题。

# jsf-2 - jsf 2.0 @ViewScoped 重定向（导航）到 target="_blank"

> ID：10098528
> 
> 赞同：0
> 
> 时间：2012-04-11T00:58:52.270
> 
> 标签：jsf-2, richfaces, facelets

[基本上和这里](https://stackoverflow.com/questions/5425674/jsf-2-0-how-to-save-the-view-after-redirect-target-blank)一样的问题

如何在重定向到不同浏览器选项卡的页面上保留 ViewScoped bean：

第一页.xhtml：

```
<h:commandLink action="#{controller.redirect}" value="#{bean.value} target="_blank"/> 
```

当重定向/导航完成初始化其他 bean 时，它会在进程中销毁这个 #{bean}。在重定向的代码中，我什至没有使用#{bean}。这曾经与

```
<a4j:keepAlive> 
```

这是我目前的设置。豆类：

```
@ViewScoped
public class Bean{ 
    @PreDestroy
    public void onDestroy(){ // being destroyed when I don't want to }
} 
```

面孔配置：

```
<navigation-rule>
  <from-view-id>/firstPage.xhtml</from-view-id>
    <navigation-case>
      <from-outcome>redirect</from-outcome>
      <to-view-id>/secondPage.xhtml</to-view-id>
  </navigation-case>
</navigation-rule> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T15:00:16.277

您需要按照 Luiggi 的建议进行操作，并将数据临时存储在会话中，或通过查询参数将数据（或足以重新获取数据的键）传递给目标视图。即使您没有重定向和/或定位新窗口/选项卡，情况也是如此。

视图范围很奇怪。只要用户停留在同一视图上，它就存在。当 JSF 发现视图已被导航离开时，它将自动销毁范围为该视图的所有 bean。

有两种方法可以导航到不同的视图。第一个是非人脸请求，例如 from`h:link`或`h:button`。在这种情况下，之前的视图不会被恢复，因此 JSF 不会知道有任何视图范围的 bean 需要销毁。第二个是 faces 请求，例如 from `h:commandLink`or `h:commandButton`，它返回`void`or以外的内容`null`。在这种情况下，有一个对视图的回发，它被恢复以处理操作。如果该操作的结果是离开该视图，重定向与否，则范围为该视图的任何 bean 都将被销毁。

在底层，视图范围本质上是会话范围，具有一些用于清理“旧”数据的内置语义。如果用户不在多个窗口/选项卡中打开应用程序并且只使用应用程序中提供的导航（即，不是浏览器的后退/前进按钮），这实际上很有效。但是，由于我们谈论的是针对 Web 浏览器，因此在我看来，视图范围非常无用（唯一的例外是您可以控制目标浏览器并完全禁用后退/前进/重新加载/定位的情况，但它没有'听起来不像你在那种环境中）。

# jax-ws - grizzly jaxws schemaLocation

> ID：10098530
> 
> 赞同：0
> 
> 时间：2012-04-11T00:59:44.713
> 
> 标签：jax-ws, grizzly

我正在从我的 java 应用程序中发布一个肥皂 ws api。到目前为止，我已经使用了 jdk 内置的 http 服务器，如下所示：

Endpoint.publish("http://www.example.com:80/soap/v1/foo", myWebService);

一切正常。

现在切换到灰熊。我的代码基于来自[http://grizzly.java.net/nonav/docs/docbkx2.0/html/jaxws-samples.html的官方示例](http://grizzly.java.net/nonav/docs/docbkx2.0/html/jaxws-samples.html)

因此类似于 httpServer.getServerConfiguration().addHttpHandler(httpHandler, "/soap/v1/foo");

wsdl 在预期的 url [http://www.example.com:80/soap/v1/foo?wsdl](http://www.example.com:80/soap/v1/foo?wsdl)下都可用，但对于 grizzly，生成的 wsdl 看起来不同。schmemaLocation 在所有地方都被缩短了，因为“/v1/foo”部分被删除了，它只指向/soap。我发布的所有服务（多个）都是这种情况。结果是无法调用方法。

（我会在 grizzly 邮件用户列表上交叉发布此内容，尽管流量不多。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T12:13:43.280

已在 Grizzly 2.2.5 中修复

# python - 在 NLTK 中实现词袋朴素贝叶斯分类器

> ID：10098533
> 
> 赞同：24
> 
> 时间：2012-04-11T01:00:00.993
> 
> 标签：python, machine-learning, nlp, nltk, naivebayes

我基本上[和这个人有同样的问题](https://stackoverflow.com/questions/2162718/python-nltk-code-snippet-to-train-a-classifier-naive-bayes-using-feature-frequ).. Naive Bayes 分类器[的 NLTK 书中的示例](http://nltk.googlecode.com/svn/trunk/doc/book/ch06.html#document-classify-all-words)只考虑一个单词是否出现在文档中作为一个特征.. 它没有考虑单词的频率作为特征看看（“词袋”）。

[答案之一](https://stackoverflow.com/a/2226115/378622)似乎表明使用内置的 NLTK 分类器无法做到这一点。是这样吗？如何使用 NLTK 进行频率/词袋 NB 分类？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-04-11T02:00:03.157

[scikit-learn](http://scikit-learn.org)有[一个多项式朴素贝叶斯的实现](http://scikit-learn.org/stable/modules/naive_bayes.html#multinomial-naive-bayes)，这是在这种情况下朴素贝叶斯的正确变体。不过，支持向量机 (SVM) 可能会更好。

正如 Ken 在评论中指出的那样，NLTK 有[一个很好的 scikit-learn 分类器包装器](https://github.com/nltk/nltk/blob/master/nltk/classify/scikitlearn.py)。根据文档修改，这里有一个有点复杂的，它进行 TF-IDF 加权，根据 chi2 统计选择 1000 个最佳特征，然后将其传递给多项式朴素贝叶斯分类器。（我打赌这有点笨拙，因为我对 NLTK 或 scikit-learn 都不太熟悉。）

```
import numpy as np
from nltk.probability import FreqDist
from nltk.classify import SklearnClassifier
from sklearn.feature_extraction.text import TfidfTransformer
from sklearn.feature_selection import SelectKBest, chi2
from sklearn.naive_bayes import MultinomialNB
from sklearn.pipeline import Pipeline

pipeline = Pipeline([('tfidf', TfidfTransformer()),
                     ('chi2', SelectKBest(chi2, k=1000)),
                     ('nb', MultinomialNB())])
classif = SklearnClassifier(pipeline)

from nltk.corpus import movie_reviews
pos = [FreqDist(movie_reviews.words(i)) for i in movie_reviews.fileids('pos')]
neg = [FreqDist(movie_reviews.words(i)) for i in movie_reviews.fileids('neg')]
add_label = lambda lst, lab: [(x, lab) for x in lst]
classif.train(add_label(pos[:100], 'pos') + add_label(neg[:100], 'neg'))

l_pos = np.array(classif.classify_many(pos[100:]))
l_neg = np.array(classif.classify_many(neg[100:]))
print "Confusion matrix:\n%d\t%d\n%d\t%d" % (
          (l_pos == 'pos').sum(), (l_pos == 'neg').sum(),
          (l_neg == 'pos').sum(), (l_neg == 'neg').sum()) 
```

这是为我打印的：

```
Confusion matrix:
524     376
202     698 
```

不完美，但体面，考虑到这不是一个超级简单的问题，而且它只接受了 100/100 的训练。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-11T01:26:19.837

NLTK 贝叶斯分类器中的特征是“名义的”，而不是数字的。这意味着它们可以采用有限数量的离散值（标签），但不能将它们视为频率。

所以使用贝叶斯分类器，你不能*直接*使用词频作为特征——你可以做一些事情，比如使用每个文本中 50 个更频繁的词作为特征集，但这是完全不同的事情

但也许 NLTK 中还有其他依赖于频率的分类器。我不知道，但你看过吗？我会说值得一试。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-03-10T14:43:49.917

*   将您正在查看的字符串放入列表中，分成单词
*   对于列表中的每个项目，询问：这个项目是我的功能列表中的一个功能吗？
*   如果是，则正常添加日志概率，如果不是，则忽略它。

如果您的句子多次使用相同的单词，它只会多次添加概率。如果单词在同一个类中出现多次，您的训练数据应该反映在字数中。

为了提高准确性，将所有二元组、三元组等视为单独的特征。

它有助于手动编写您自己的分类器，以便您准确了解正在发生的事情以及您需要做些什么来提高准确性。如果您使用预打包的解决方案并且效果不佳，那么您无能为力。

# c# - 启用事件面板的问题

> ID：10098534
> 
> 赞同：0
> 
> 时间：2012-04-11T01:01:13.330
> 
> 标签：c#

我现在要做的是让我的程序在后台添加每次发生后的 5 秒，这样一旦发生 25 秒，就会触发一个事件。

有什么建议么？

这是正在发生的事情的一些代码

```
 private void autoshapingPanel_Paint(object sender, PaintEventArgs e)
        {

        }

        //Code for Peck Counter

        private int counter = 0;

        public event EventHandler Clicked5TimesEvent;

        private void OnClicked5TimesEvent()
        {
            if (Clicked5TimesEvent != null)
            {
                Clicked5TimesEvent(this, EventArgs.Empty);
            }
        }

        //Stimulus with Peck Counter
        private void pictureBox1_Click(object sender, EventArgs e)
        {
            counter++;
            if (counter % 5 == 0)
            {
                //Code for Hopper
                //Code to Write Data
                string file_name = "C:\\Users\\Carter Daniels\\DATA\\AUTOSHAPINGdata.txt";
                System.IO.StreamWriter objWriter;
                objWriter = new System.IO.StreamWriter(file_name, true);
                objWriter.WriteLine("5 pecks");
                objWriter.WriteLine("1 Reinforcement");
                objWriter.Close();
                //ITI Panel
                ITIpanel.Visible = true;
            }
        }

        private void ITIpanel_Paint(object sender, PaintEventArgs e)
        {
            if (ITIpanel.Visible == true) 
            {
                ITItimers.Enabled = true;
            } 
        }

        private void ITItimers_Tick(object sender, EventArgs e)
        {
            ITIpanel.Visible = false;
            string file_name = "C:\\Users\\Carter Daniels\\DATA\\AUTOSHAPINGdata.txt";
            System.IO.StreamWriter objWriter;
            objWriter = new System.IO.StreamWriter(file_name, true);
            objWriter.WriteLine("5s ITI");
            objWriter.Close();
            ITItimers.Enabled = false; 
            autoshapingPanel.Visible = true;
        }
    }
} 
```

我希望我的程序做的是计算 ITIpanel 或 ITItimers 发生的次数，并在一个或另一个之后触发一个新事件，最好计时器已经发生 20 次

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T05:44:15.410

一个基本问题似乎有很多文字 - 如果我理解的话。只需进行另一项类似于您现有活动的活动。

```
 private int _timerCounter = 0;
    private void ITItimers_Tick(object sender, EventArgs e)
    {
        if( _timersCounter++ == 5 ) {
             OnTimerFired20TimesEvent();
             _timersCounter = 0;
        }

        ITIpanel.Visible = false;
        // ...
    }

public event EventHandler TimerFired20TimesEvent;

        private void OnTimerFired20TimesEvent()
        {
            if (TimerFired20TimesEvent != null)
            {
                TimerFired20TimesEvent(this, EventArgs.Empty);
            }
        } 
```

# networking - 2 IP 在不同的子网/网关到 openVz

> ID：10098536
> 
> 赞同：-1
> 
> 时间：2012-04-11T01:01:45.867
> 
> 标签：networking, routes, gateway, openvz

我将 debian6 与 openVz 一起使用，并从 ISP 61.19.252.68 和 61.19.252.55 获得了 2 个 IP。在设置网桥并将 0.68 分配给主机节点并将 0.55 分配给 Vz101 节点后，一切正常，能够从外部访问 0.55 .68。但是在我从 IP 获得另一个 ip 61.19.252.191 并分配给 Vz102 节点之后，我无法从任何外部网络 ping 或访问 .191，除了它自己的主机节点。有人可以帮助我。

主机节点 61.19.252.68 vz101 节点 61.19.252.55 子网 61.19.252.128 gw 61.19.252.3

vz102-节点 61.19.252.191 子网 61.19.252.128 gw 61.19.252.129

谢谢你的进步，汤姆兹

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T01:12:16.727

.68 和 .55 与 .191 位于不同的网络上，因此您必须确保它们彼此了解。是否有通往彼此网络的路线？

# javascript - 尝试动态使用 jOrgChart

> ID：10098538
> 
> 赞同：1
> 
> 时间：2012-04-11T01:01:59.010
> 
> 标签：javascript, jquery, html, css

我希望使用 jOrgChart（链接：[jOrgChart](http://th3silverlining.com/2011/12/01/jquery-org-chart-a-plugin-for-visualising-data-in-a-tree-like-structure/)）让用户动态创建树算法。正如预期的那样，我遇到了很多问题（这是我第一次使用树插件），但首先是我无法获得“.add_child”输入按钮来添加另一个“li”到任何东西。 ..

我希望有人能发现我做错了什么。

[这是我的jsfiddle](http://jsfiddle.net/8VGVG/2/)

我在插件底部写了这个，以便在一个 javascript 文件中显示所有内容：

```
$(document).ready(function() {
    $('#org').jOrgChart();
    $('.add_child').live({
        click: function() {
            var $new_child = '<li>test1</li>';

        }
    });
}); 
```

注意：我还在插件的最后添加了这个，这样“+”按钮就不会折叠树：

```
$nodeDiv.children('input{class=\"add_child\"').click(function(e){
        console.log(e);
        e.stopPropagation();
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-23T20:10:03.487

看看这个 fork，它有添加/删除节点的能力[https://github.com/velonce/jOrgChart](https://github.com/vellonce/jOrgChart)

# facebook - 来自我朋友的 Open Graph 内置操作（如 video.watches 或 news.reads）始终为空

> ID：10098539
> 
> 赞同：4
> 
> 时间：2012-04-11T01:02:10.720
> 
> 标签：facebook, facebook-opengraph

我试图`video.watches`从我的朋友那里得到一切

```
https://graph.facebook.com/me/friends/video.watches?access_token=<valid_token> 
```

我的访问令牌同时具有`user_actions.video`和`friends_actions.video`权限。我得到空结果：

```
{
"data": []
} 
```

虽然我的一个 id 为 100000291284354 的朋友使用 Vevo 应用程序观看了视频，但我何时观看

```
https://graph.facebook.com/100000291284354/video.watches?access_token=<valid_token> 
```

我得到这些视频。与`news.reads`（如果我输入朋友ID，我可以得到消息，而当我通过请求时得到空结果`/me/friends/`）

有什么问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T13:41:54.490

Facebook 昨天增强了那里的 API，试试这个 Graph API 请求：

```
GET https://graph.facebook.com/me/friends?limit=10&fields=name,video.watches.limit(2) 
```

见[https://developers.facebook.com/docs/reference/api/field_expansion/](https://developers.facebook.com/docs/reference/api/field_expansion/) 和[https://developers.facebook.com/blog/post/2012/08/30/updates-to-the-graph-api/](https://developers.facebook.com/blog/post/2012/08/30/updates-to-the-graph-api/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-11T04:39:55.287

我相信这是正确的做法。或者我愿意相信。

`user_actions.video`应该`me/video.watches` *只*授予并且`friends_actions.video`应该授予`friend_id/video.watches`。一种有效的检查方法是放弃`friends_actions.video`权限并使用您提到的用户 ID 重试。但是为什么会有结尾/me/friends/video.watches？

我认为这个端点不应该存在。似乎您可以将`video.watches`路径附加到某些图形调用的末尾，并且它将以空数组静默失败，而不是给您提供的分页链接

```
{
  "data": [
  ], 
  "paging": {
    "next": "pagination_url"
  }
} 
```

自己尝试（在我的情况下，我用 music.listens 尝试过）

*   /me/photos/music.listens -*调用 /me/photos 静默失败*
*   /me/likes/music.listens -*错误 100*
*   /me/friends/music.listens -*以空数组静默失败*

其余的行为与无效路径组件的预期相同，因此第二个猜测是这些路径中的一些是错误。

所以，我不认为你能做到，你认为你能做到的；一次抓住你朋友的所有活动。

# java - java.vector / 安卓开发工具包

> ID：10098540
> 
> 赞同：0
> 
> 时间：2012-04-11T01:02:23.963
> 
> 标签：java, android, eclipse

好的，我的 android 游戏运行流畅，但无法升级。我也收到此警告：说明资源路径位置类型类型安全：方法 addElement(Object) 属于原始类型 Vector。对泛型类型 Vector 的引用应该参数化 LevelManager.java/FROZEN BUBBLES/src/org/bigdaddyapp/android/frozenbubbles 第 32 行 Java 问题

```
import android.os.Bundle;
import java.util.Vector;

public class LevelManager {
private int currentLevel;
private Vector levelList;

public void saveState(Bundle map) {
    map.putInt("LevelManager-currentLevel", currentLevel);
}

public void restoreState(Bundle map) {
    currentLevel = map.getInt("LevelManager-currentLevel");
}

public LevelManager(byte[] levels, int startingLevel) {
    String allLevels = new String(levels);

    currentLevel = startingLevel;
    levelList = new Vector();

    int nextLevel = allLevels.indexOf("\n\n");
    if (nextLevel == -1 && allLevels.trim().length() != 0) {
        nextLevel = allLevels.length();
    }

    while (nextLevel != -1) {
        String currentLevel = allLevels.substring(0, nextLevel).trim();

        levelList.addElement(getLevel(currentLevel));

        allLevels = allLevels.substring(nextLevel).trim();

        if (allLevels.length() == 0) {
            nextLevel = -1;
        } else {
            nextLevel = allLevels.indexOf("\n\n");

            if (nextLevel == -1) {
                nextLevel = allLevels.length();
            }
        }
    }

    if (currentLevel >= levelList.size()) {
        currentLevel = 0;
    }
}

private byte[][] getLevel(String data) {
    byte[][] temp = new byte[8][12];

    for (int j = 0; j < 12; j++) {
        for (int i = 0; i < 8; i++) {
            temp[i][j] = -1;
        }
    }

    int tempX = 0;
    int tempY = 0;

    for (int i = 0; i < data.length(); i++) {
        if (data.charAt(i) >= 48 && data.charAt(i) <= 55) {
            temp[tempX][tempY] = (byte) (data.charAt(i) - 48);
            tempX++;
        } else if (data.charAt(i) == 45) {
            temp[tempX][tempY] = -1;
            tempX++;
        }

        if (tempX == 8) {
            tempY++;

            if (tempY == 12) {
                return temp;
            }

            tempX = tempY % 2;
        }
    }

    return temp;
}

public byte[][] getCurrentLevel() {
    if (currentLevel < levelList.size()) {
        return (byte[][]) levelList.elementAt(currentLevel);
    }

    return null;
}

public void goToNextLevel() {
    currentLevel++;
    if (currentLevel >= levelList.size()) {
        currentLevel = 0;
    }
}

public void goToFirstLevel() {
    currentLevel = 0;
}

public int getLevelIndex() {
    return currentLevel;
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T01:07:04.520

对于 Eclipse 环境，您会收到不使用泛型的警告，因此您应该使用

```
private Vector<byte[][]> levelList; 
```

反而。

一种替代方法是关闭 Eclipse 首选项中的警告，但我不建议这样做。这些警告可以帮助您。

我还建议您创建一个类`Level`而不是使用`byte[][]`.

# exchange-server - 仅出于开发目的而设置 MS Exchange Server 的最佳和最便宜的选择是什么？

> ID：10098544
> 
> 赞同：0
> 
> 时间：2012-04-11T01:03:08.520
> 
> 标签：exchange-server, exchangewebservices, exchange-server-2007, exchange-server-2010

下面是设置：我计划建立一个 Exchange Server 实例，以便我可以将现有的 Ruby on Rails 应用程序与其集成以进行概念验证项目。我希望允许 Ruby on Rails 应用程序的用户通过该应用程序（而不是通过 Outlook）查看其他用户何时可用。

以下是我想知道的： 1\. 带有 Exchange 的 MSDN 非常昂贵，Exchange Server 也是如此。是否存在将 Exchange Server 用作开发人员或在实验室条件下使用廉价的选项？2\. 是否有我可以使用的托管交换实例或交换主机，我的 Ruby on Rails 应用程序可以通过 Web 服务或 API 与之交互？
3\. 我真的希望能够做的不仅仅是拉可用性，但这就是所需要的。4\. 购买旧版本的 Exchange（例如 5.5、2003、2007）而不是 Exchange 2010 并直接使用它是否有意义？听起来好像没有。

任何建议的阅读将是一个加号。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T23:33:39.537

您肯定想要最新版本，API 发生了很大变化。

几个选项供您选择：

1.  订阅 technet 会很便宜
2.  如果您是合作伙伴，则行动包也很便宜
3.  实际上，您可以从 download.microsoft.com 下载最新的 Exchange Service Pack (2) 并安装它。这是整个产品。您将获得一个功能完善的 Exchange 2010 标准版服务器。每次打开控制台时，它都会提醒您一个密钥，但是它实际上永远不会过期。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T01:07:21.467

你看过 Office 365 吗？4 美元/用户/月，这是非常合理的。您有朋友在工作中使用 Exchange 吗？

# android - Cygwin 正在修剪我的 android.mk 路径

> ID：10098549
> 
> 赞同：0
> 
> 时间：2012-04-11T01:03:51.420
> 
> 标签：android, path, android-ndk, cygwin, gnu-make

我正在像这样用 Cygwin 编译我的项目 Android 项目

**bash.exe -i [ANDROID_NDK_HOME]/ndk-build -j4**

我在win7 x86上遇到了这个问题

Android NDK：您的 APP_BUILD_SCRIPT 指向一个未知文件：/cygdrive/d/jni/Android.mk /cygdrive/d/DevTools/android-ndk/build/core/add-application.mk:118：* *Android* NDK：Aborting。 ... 停止。

我的 android.mk 的路径应该是 /cygdrive/d/my_app/android/my_project/jni/Android.mk

**为什么 cygwin 正在修剪我的路径字符串？**

在其他电脑上，这个问题不会发生（Win 7 x64）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T05:02:39.763

我不认为“-i”会起作用。我相信你应该使用“--login -c”。此外，在运行 ndk-build 之前，您必须使用 cd 来更正目录。当我将 Cygwin 用于 Android NDK 时，我正在运行以下 bat 文件以在 cygwin 下的当前目录中运行 ndk-build 命令：

```
set ANDROID_NDK=C:\android\ndk
set CYGWIN=C:\cygwin

for /f "delims=" %%A in ('%CYGWIN%\bin\cygpath.exe "%cd%"') do set CUR_DIR=%%A
for /f "delims=" %%A in ('%CYGWIN%\bin\cygpath.exe "%ANDROID_NDK%"') do set NDK_DIR=%%A

%CYGWIN%\bin\bash --login -c "cd %CUR_DIR% && %NDK_DIR%/ndk-build -j4" 
```

但是现在我不再使用cygwin了。Android NDK 可以从本机 Windows 命令行 (cmd.exe) 将 ndk-build.cmd 作为本机 bat 文件运行，而无需 Cygwin。

# java - 更新 newView 以在 xml 行布局之间切换

> ID：10098552
> 
> 赞同：1
> 
> 时间：2012-04-11T01:04:09.807
> 
> 标签：java, android, listview, custom-adapter

我的列表视图上有一个自定义适配器，它链接到 newView 中的两个单独的 xml 布局，当活动启动时，它通过使用开关选择要使用的布局。一切正常，但是如何在活动开始后更新 newView 以便我可以在两个不同的行布局之间切换？当我滚动时，有些行会发生变化，但我希望它在我的 checkedChangeListener 上发生变化。

setOnCheckedChangeListener：

```
auto.setOnCheckedChangeListener(new OnCheckedChangeListener() {
    public void onCheckedChanged(RadioGroup group, int checkedId) {

        switch (checkedId) {
        case R.id.Auto:
            if(toggle.isChecked()){
                seek.setEnabled(true);
            }                   
            toggle.setEnabled(true);
            v=0;
            result.setEnabled(true); break;
        case R.id.Manual:
            seek.setEnabled(false);
            toggle.setEnabled(false);
            v=1;
            result.setEnabled(false); break;
        }
        final MyContactsAdapter adapter = ((MyContactsAdapter)b_list.getAdapter());
        adapter.notifyDataSetChanged(); 
    }
}); 
```

新视图：

```
@Override
public View newView(Context context, Cursor cursor, ViewGroup parent) {

    View view = null;

    switch(v){
    case 0:
        view = mInflater.inflate(R.layout.blanket_auto, parent, false);break;

    case 1:
        view = mInflater.inflate(R.layout.blanket_manual, parent, false);break;

    }
    return view;
} 
```

谢谢

# java - 任何想法为什么这不会打印？

> ID：10098555
> 
> 赞同：2
> 
> 时间：2012-04-11T01:04:28.363
> 
> 标签：java, binary-search-tree

这是主要课程：

```
import javax.swing.*;
class BinarySearchTree {
private Node root;

public void main()
{
    int Value = 0;
    while(Value!= -1)
    {
        Value = Integer.parseInt(JOptionPane.showInputDialog("Enter a value"));
        insert(root, Value); 
    }
    print();
}

public void insert(Comparable x) 
{
    root = insert(root, x);
}

public boolean find(Comparable x) 
{
    return find(root,x);
}

public void print() 
{
    print(root);
}

@SuppressWarnings("unchecked")
boolean find(Node tree, Comparable x) 
{
    if (tree == null)
        return false;

    if (x.compareTo(tree.data) == 0) 
        return true;

    if (x.compareTo(tree.data) < 0)
        return find(tree.left, x);
    else
        return find(tree.right, x);
}

void print(Node tree) 
{
    if (tree != null) 
    {
        print(tree.left);
        System.out.println(tree.data);
        print(tree.right);
    }
}

@SuppressWarnings("unchecked")
Node insert(Node tree, Comparable x) 
{
    if (tree == null) 
    {
        return new Node(x);
    }

    if (x.compareTo(tree.data) < 0) 
    {
        tree.left = insert(tree.left, x);
        return tree;
    } 
    else 
    {
        tree.right = insert(tree.right, x);
        return tree;
    }
} 
```

}

节点类：

```
public class Node {
    public Comparable data;
    public Node left;
    public Node right;

    Node(Comparable newdata) {
        data = newdata;
    }
} 
```

当我调用“print();”时，我尝试打印出结果 在 void 主类中，在树中插入所有值后，但它不打印任何内容。当我单独调用每个方法时，它们会起作用，但当我尝试从主类调用它们时不会。发生这种情况的任何原因？非常感谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T01:10:26.150

这是因为您没有主要方法。将 main 方法的签名更改为：

```
public static void main(String[] args) 
```

并重新运行它。

# ruby-on-rails - 如何仅对在 ruby on rails 中保存“remote => true”的表单的父类执行函数？

> ID：10098556
> 
> 赞同：0
> 
> 时间：2012-04-11T01:04:30.153
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1

我想要做的是一些如何仅将下面的 jquery 函数应用于刚刚发布的评论的类。相反，该功能被应用于所有类。

这是我目前正在使用的代码：

**控制器：**

```
class CommentsController < ApplicationController

    def create

         @comment = Micropost.find(params[:comment][:micropost_id]).comments.build(params[:comment])
           respond_to do |format|
                 if @comment.save

                    unless params[:comment][:recipient].blank? # this will be blank when current user is commenting/replying on their own wall
                    recipient = User.find(params[:comment][:recipient])
                    UserMailer.new_wall_post_comment_notification(recipient, current_user).deliver if recipient.email_notification == 1 
                    end
                    format.js   { render :post_comment }
                    else
                    format.js   { render :form_errors }
                    end
           end
    end

end 
```

**jQuery：**

```
$.ajax({
    success: function(){
        $('.post_container').append('test <br />');
    }
});
<% sleep 1 %> 
```

它类似于我用于单个主微帖子表单的代码，但是有几个使用相同类的评论，因此测试将应用于所有 post_containers 而不是刚刚发布帖子的那个。“测试”文本最终将替换为包含用户发布的实际评论的 div。

通常我会使用“this”，但这在这里不起作用。

**HTML：**

```
<div class="post_content">
    <div class="post_container">
        <div class="userNameFontStyle">
            <%= link_to current_users_username.capitalize, current_users_username %> -
            <div class="post_time">
                <%= time_ago_in_words(m.created_at) %> ago.
            </div>
        </div>  
        <%=  simple_format h(m.content) %>
    </div>
    <% if m.comments.any? %>
    <% comments(m.id).each do |comment| %>
    <div class="comment_container">
        <%= link_to image_tag(default_photo_for_commenter(comment), :class => "commenter_photo"), commenter(comment.user_id).username %>
        <div class="commenter_content">
            <div class="userNameFontStyle">
                <%= link_to commenter(comment.user_id).username.capitalize, commenter(comment.user_id).username %> - <%=  simple_format h(comment.content) %>
            </div>
        </div>
        <div class="comment_post_time">
            <%= time_ago_in_words(comment.created_at) %> ago.
        </div>
    </div>
    <% end %>
    <% end %>
    <% if logged_in? %>
    <%= form_for @comment, :remote => true do |f| %>
    <%= f.hidden_field :user_id, :value => current_user.id %>
    <%= f.hidden_field :micropost_id, :value => m.id %>
    <%= f.text_area :content, :placeholder => 'Post a comment...', :class => "comment_box", :rows => 0, :columns => 0 %>
    <div class="commentButtons">         
        <%= f.submit 'Post it', :class => "commentButton" %>
        <div class="cancelButton">
            Cancel
        </div>
    </div>   
    <% end %>
    <% end %>
    </div>
</div> 
```

我将如何处理？

亲切的问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T03:53:15.917

您可以将一个类添加到您想要更改的特定帖子的容器中，特别是为了识别它。

```
my_post.parent().addClass("fixme"); 
```

然后稍后

```
container = $(".post_container.fixme");
// do stuff
container.removeClass("fixme"); 
```

# eclipse - 键盘箭头键无法在方法提示弹出窗口中选择项目

> ID：10098557
> 
> 赞同：1
> 
> 时间：2012-04-11T01:04:50.283
> 
> 标签：eclipse

在这个 Eclipse 弹出窗口中：

![在此处输入图像描述](../Images/ae44fcf28d7a396b9c1ec878f92ec790.png)

键盘向上/向下箭头键不会让我选择一个项目。我可以用鼠标选择，但是这里有没有使用键盘的方法？

# xml - 从 XML 文档填写 VB.Net 表单

> ID：10098558
> 
> 赞同：0
> 
> 时间：2012-04-11T01:04:56.410
> 
> 标签：xml, vb.net

我有一个类项目，我使用 VB.Net 表单根据输入到文本框中的数据搜索 XML 文档，并且我需要返回子标记中其他项目的值。下面是 XML 信息的一个示例。在 VB 表单中，用户输入一个帐号，然后根据与 XML 文档中的一个匹配的帐号，表单的其余部分、姓名、dob 等将 XML 填充到文本框中。

我不确定如何编码。我已将 XML 文档附加到 VB 表单代码中：

```
 Dim doc = XDocument.Load("CreditApp.xml")
    Dim xdoc = doc.Descendants("custData").FirstOrDefault() 
```

我还为接收用户搜索输入的文本框分配了变量。通过单击 VB 表单中的“搜索”按钮激活搜索。

```
 txtAcctNum.Text = xdoc.Element("AcctNum").Value
  txtSSN.Text = xdoc.Element("SSN").Value 
```

XML 示例：

```
 <custData>
    <FName>Ben</FName>
    <LName>Dover</LName>
    <Gender>Male</Gender>
    <Address>21 Jump Street</Address>
    <City>Beverly Hills</City>
    <State>CA</State>
    <Zip>90210</Zip>
    <Phone>3108591212</Phone>
    <Email>yourex@stalkermail.com</Email>
    <SSN>000001233</SSN>
    <AcctNum>5695847185978954</AcctNum>
    <PassCode>What</PassCode>
    <AccountAvail>75000</AccountAvail>
    <AcctBal>25000</AcctBal>
    <LPmtDate>3/28/2012</LPmtDate>
    <LPmtAmt>7500</LPmtAmt>
    <CreditLimit>100000</CreditLimit>
    <IntRate>15.499</IntRate>
    <MinPayment>1250</MinPayment>
    <PmtDueDate>4/28/2012</PmtDueDate>
    <Note></Note>
  </custData>

  <custData>
    <FName>Al</FName>
    <LName>Caholic</LName>
    <Gender>Male</Gender>
    <Address>8585 Milky Way</Address>
    <City>Palm Springs</City>
    <State>CA</State>
    <Zip>90561</Zip>
    <Phone>2029867411</Phone>
    <Email>screaming@silentmail.com</Email>
    <SSN>951855589</SSN>
    <AcctNum>9812020274912689</AcctNum>
    <PassCode>Glover</PassCode>
    <AccountAvail>0</AccountAvail>
    <AcctBal>55000</AcctBal>
    <LPmtDate>4/1/2012</LPmtDate>
    <LPmtAmt>15</LPmtAmt>
    <CreditLimit>55000</CreditLimit>
    <IntRate>18.995</IntRate>
    <MinPayment>95000</MinPayment>
    <PmtDueDate>5/1/2012</PmtDueDate>
    <Note></Note>
  </custData> 
```

任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T01:24:40.900

尝试使用 xml to linq 我认为它对你有好处

/// custDtatas 它是整个文档的顶部包装元素，您的可以不同

```
Dim q = (From c In xDoc.Descendants("custDtatas")
From view In c.Elements("custData") 
Where view.Element("SSN") = '000001233'
AndAlso view.Element("AcctNum") = '5695847185978954' view).ToList()

        // fill the specific part of the form with specific item 

        For Each item As var In q

        Next 
```

# javascript - 如何通过 Socket.IO 服务器端发送和捕获消息

> ID：10098564
> 
> 赞同：4
> 
> 时间：2012-04-11T01:05:24.383
> 
> 标签：javascript, node.js, websocket, socket.io

我不确定如何理解 socket.io 中消息的使用。我正在尝试将消息从客户端发送到服务器，然后服务器回复客户端（基本不？）。

这是服务器代码：

```
var fs = require('fs');
var hskey = fs.readFileSync('ssl.key');
var hscert = fs.readFileSync('ssl.crt');

var options = {
    key: hskey,
    cert: hscert
};

var app = require('https').createServer(options);
var io = require('/usr/local/lib/node_modules/socket.io').listen(app);

app.listen(8181);

io.sockets.on('connection', function (socket) {
  socket.emit('serverMessage', 'Hello world!');
  io.sockets.emit('serverMessage', 'A user connected');

  io.sockets.on('clientMessage', function (socket) {
    socket.emit('serverMessage', 'Gotamessage bitch!');
    console.log('I received a message by ', from, ' saying ', msg);
  });

    socket.on('disconnect', function () {
    io.sockets.emit('serverMessage', 'A user disconnected');
  });
}); 
```

这是客户端代码：

```
<script>

        var socket;
        var firstconnect = true;

        function connect() {
          if(firstconnect) {
            socket = io.connect('https://secure.connectednodes.com:8181');

            socket.on('serverMessage', function(data){ message(data); });
            socket.on('connect', function(){ status_update("Connected to Server"); });
            socket.on('disconnect', function(){ status_update("Disconnected from Server"); });
            socket.on('reconnect', function(){ status_update("Reconnected to Server"); });
            socket.on('reconnecting', function( nextRetry ){ status_update("Reconnecting in " 
              + nextRetry + " seconds"); });
            socket.on('reconnect_failed', function(){ message("Reconnect Failed"); });

            firstconnect = false;
          }
          else {
            socket.socket.reconnect();
          }
        }

        function disconnect() {
          socket.disconnect();
        }

        function message(data) {
          document.getElementById('message').innerHTML += "<br>" + "Server says: " + data;
        }

        function status_update(txt){
          document.getElementById('status').innerHTML = txt;
        }

        function esc(msg){
          return msg.replace(/</g, '&lt;').replace(/>/g, '&gt;');
        }

        function send() {
          socket.emit('clientMessage', 'Yo server');  
        };        

     </script> 
```

我设法让连接和断开连接工作，但我无法让 io.sockets.on('clientMessage' 工作。有什么想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-11T02:38:41.210

我认为你必须使用 socket.on 而不是 io.sockets.on

服务器端

```
socket.on('clientMessage', function (data, from) {
   socket.emit('serverMessage', 'Got a message!');
   console.log('I received a message by ', from, ' saying ', msg);
}); 
```

客户端

```
function send() {
   socket.emit('clientMessage', 'Yo server', 'USER001');  
}; 
```

尝试一下

# cxf - 让 CXF JAX-RS 客户端使用 Jackson

> ID：10098565
> 
> 赞同：4
> 
> 时间：2012-04-11T01:05:24.917
> 
> 标签：cxf, jax-rs, jackson

我不知道如何将 Jackson 与 Jax-RS 的 CXF 客户端一起使用。

我看到一些引用声称我应该添加以下 XML 片段，但是，我不知道应该在哪里添加它。这仅在使用服务时相关还是我也可以与客户一起设置？

```
<jaxrs:providers>
   <bean class="org.codehaus.jackson.jaxrs.JacksonJsonProvider"/>
</jaxrs:providers> 
```

我目前创建客户的方式是：

`MyServiceClass client = JAXRSClientFactory.create(serverUrl, MyServiceClass.class);`

如何设置此客户端以使用 Jackson？我确定我遗漏了一些明显的东西，但我似乎看不到它。. .

```
Thanks! 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-02-25T06:38:02.163

这可能会做到：[JAXRSClientFactory#create(String,Class,List)](https://cxf.apache.org/javadoc/latest/org/apache/cxf/jaxrs/client/JAXRSClientFactory.html#create(java.lang.String,%20java.lang.Class,%20java.util.List))

该列表被声明为`List<?>`因为您可以在其中传递任何内容并且应该正确处理它 - 假设它具有正确的注释。

# linq - 将 iQueryable 转换为 IEnumerable

> ID：10098568
> 
> 赞同：18
> 
> 时间：2012-04-11T01:05:53.453
> 
> 标签：linq, entity-framework, c#-4.0

我下面的代码有什么问题？即使数据库中存在匹配的记录，它也不会返回任何项目。如果它是错误的，我该如何转换我`IQueryable`的`IEnumerable`？

```
public IEnumerable<TimelineItem> TimeLineItems { get; set; }
public IEnumerable<TimelineItem> GetTimeLineItems(int SelectedPID)
{
    TimeLineItems = (from t in db.TimelineItems
                     where t.ProductID == SelectedPID
                     select new { t.Description, t.Title }) as IEnumerable<TimelineItem>;
    return TimeLineItems;
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-11T01:30:12.613

在我看来，如果你打算使用 linq，那就拥抱它，摆脱那种深奥的符号 :)

```
 public IEnumerable<TimelineItem> GetTimeLineItems(int SelectedPID)
   {
      return db.TimelineItems.Where(tl => tl.ProductID == SelectedPID)
        .Select( tl => new TimelineItem {
            Description = tl.Description,
            Title = tl.Title })
        .AsEnumerable<TimelineItem>();
   } 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-11T01:10:04.683

您得到的原因`null`是因为您正在尝试将`IQueryable`基于*匿名类型*的转换为`IEnumerable<TimelineItem>`（`new { t.Description, t.Title }`创建具有两个字段的匿名类型的实例 -`Description`并且`Title`）您应该删除该`Select`部分以使其工作。

如果您只想选择`Description`and ，请使用这两个字段`Title`创建一个*命名*`IEnumerable`类型，并返回该类型的 an：

```
public class TitleDescr {
    public string Title {get;set;}
    public string Description {get;set;}
}

public IEnumerable<TitleDescr> GetTimeLineItems(int SelectedPID)
{
    return from t in db.TimelineItems
                     where t.ProductID == SelectedPID
                     select new TitleDescr { t.Description, t.Title };
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-02T05:16:06.473

使用自动映射器转换`IQueryable`为`IEnumerable`

```
 StudentsModel IEmodel = new StudentsModel();//IEnumerable 
            try {
                var Queryablemodel = _tblStudents.GetQueryable().FirstOrDefault(x => x.CNIC == strCNIC && x.LoginPassword == strPassword);//IQueryable
               //conversion with Auto Mapper
                IEmodel = AutoMapper.Mapper.Map(Queryablemodel , IEmodel ); 
            }
            catch(Exception ex){
                throw ex;
            } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-05-21T22:17:10.413

您将 IQueryable 转换为 IEnumerable 的业务用例是什么？IQueryable 将为您提供延迟或延迟的非缓存数据，而 IEnumerable 将为您提供即时或急切的缓存数据。但是，如果您在上下文级别关闭了延迟加载，您仍将获得即时数据。

# c++ - new 导致 mpirun 中出现不可预测的错误

> ID：10098569
> 
> 赞同：0
> 
> 时间：2012-04-11T01:06:01.903
> 
> 标签：c++, new-operator, mpi

我在旧的并行 linux 服务器上使用 mpirun 和 gcc-3.4.6 和 mpicc-9.0，我没有 root 权限。在使用带有 1 个处理器的 mpirun 时，我没有收到错误，但是，在使用 2 个处理器时，我得到了

```
signal 11 received, exiting... 
```

等错误。

我看到了这篇[SO 帖子](https://stackoverflow.com/a/804935/984260)，想知道我的系统配置是否可能导致 new 不是线程安全的。**当我打印输出时，我发现该程序在调用new**时卡住了，甚至没有打印出预期的内容。你能建议点什么吗。提前致谢。

如果有帮助，我可以在没有 root 的情况下在主目录中安装最新的 gcc。请告诉我。我还需要安装最新的 mpicc 吗？

在 gcc > 4.1 的其他机器上，我的程序运行良好，但我无法运行 mpi。

# sql - 连续行之间的日期差异 - 复杂

> ID：10098570
> 
> 赞同：9
> 
> 时间：2012-04-11T01:06:05.303
> 
> 标签：sql, ms-access

我之前发布了一个已回答的[问题](https://stackoverflow.com/questions/9994862/date-difference-between-consecutive-rows)，但我也需要对此进行查询。我有一个包含这样数据的表结构（日期格式为*dd/mm/yyyy*）。

```
ID    Account Number    Unit    Admit_Date    Disch_Date
1     1001              w32     01/04/2012    
2     1002              w32     01/04/2012    01/04/2012
3     1001              ccu     03/04/2012
4     1001              w33     05/04/2012
5     1003              cicu    04/04/2012
6     1001              ccu     07/04/2012
7     1001              ccu     07/04/2012    10/04/2012
8     1003              w33     05/04/2012
9     1003              w33     05/04/2012    08/04/2012 
```

基本上，这张表处理的是患者进入特定病房并在病房之间转移，然后最终在同一天或几天后出院。查询的预期结果将是：

```
Account_Number                                 No. Of Days
1001              01/04/2012    03/04/2012      2
1001              03/04/2012    05/04/2012      2
1001              05/03/2012    07/04/2012      2
1001              07/04/2012    10/04/2012      3
1002              01/04/2012    01/04/2012      0
1003              04/04/2012    05/04/2012      1
1003              05/04/2012    08/04/2012      3 
```

出院日期字段仅在患者出院时填写，因此我想计算患者每个移动日期之间的日期差异，包括入院日期和出院日期。

我使用 MS Access 2003。

我希望有人能够帮助我解决这个问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-11T01:39:17.163

### 过滤掉不相关的数据

对于任何复杂的查询，艺术的一部分是逐个构建查询，随时进行测试。

我假设表名是 PatientMovements 并且：

> 给定像 ID = {6,7} 和 ID = {8,9} 这样的行对，*可以*正确地说，当有空出院日期的患者（帐号）、单位和入院日期所在的行被忽略时也是同一患者、单位和入院日期但非空出院日期的记录。

因此，第一步是生成我们需要处理的行，从记录在数据库中的表中过滤掉不相关的数据。这是两组数据的 UNION：

1.  那些具有非空出院日期的行。
2.  那些出院日期为空但没有相同帐户、单位和入院日期的行。

显然，UNION 的第一部分是：

```
SELECT * FROM PatientMovements WHERE DischargeDate IS NOT NULL 
```

不太明显的是，UNION 的第二部分是：

```
SELECT *
  FROM PatientMovements AS p1
 WHERE DischargeDate IS NULL
   AND NOT EXISTS
       (SELECT *
          FROM PatientMovements AS P2
         WHERE P1.Account   = P2.Account
           AND P1.Unit      = P2.Unit
           AND P1.AdmitDate = P2.AdmitDate
           AND P2.DischargeDate IS NOT NULL
       ) 
```

现在您可以将它们组合成一个结果集：

```
SELECT *
  FROM PatientMovements
 WHERE DischargeDate IS NOT NULL
UNION
SELECT *
  FROM PatientMovements AS p1
 WHERE DischargeDate IS NULL
   AND NOT EXISTS
       (SELECT *
          FROM PatientMovements AS P2
         WHERE P1.Account   = P2.Account
           AND P1.Unit      = P2.Unit
           AND P1.AdmitDate = P2.AdmitDate
           AND P2.DischargeDate IS NOT NULL
       ) 
```

您可以通过检查它是否返回 ID 为 1..5、7 和 9 的行来验证上面的查询。

*警告：*未经测试的代码。此答案中的所有 SQL 都没有靠近 DBMS，因此未经测试。

### 应用以前的经验教训

然后你可以应用你从另一个[问题中学](https://stackoverflow.com/questions/9994862/date-difference-between-consecutive-rows)到的知识来排序数据并计算日期差异等。唯一的复杂之处是你必须写出两次查询，这很痛苦（除非 MS Access 2003 支持'WITH'子句或公用表表达式）。

* * *

> 但是没有单一的查询来获得这个所需的输出吗？

当然，UNION 是一个单一的查询。我想你可以写：

```
SELECT *
  FROM PatientMovements
 WHERE (DischargeDate IS NOT NULL)
    OR (DischargeDate IS     NULL
        AND NOT EXISTS
            (SELECT *
               FROM PatientMovements AS P2
              WHERE P1.Account   = P2.Account
                AND P1.Unit      = P2.Unit
                AND P1.AdmitDate = P2.AdmitDate
                AND P2.DischargeDate IS NOT NULL
            )
       ) 
```

我无法立即想到一种更紧凑的查询方式。

* * *

### 将 UNION 构建为“另一个答案”

另一个问题的公认答案有两种可能的解决方案（经评论修改并重新格式化）：

```
SELECT T1.ID, T1.AccountNumber, T1.Date, 
       MIN(T2.Date) AS NextDate, 
       DATEDIFF("D", T1.Date, MIN(T2.Date)) AS DaysDiff
  FROM YourTable T1
  JOIN YourTable T2
    ON T1.AccountNumber = T2.AccountNumber AND T2.Date > T1.Date 
```

或者：

```
SELECT ID, AccountNumber, Date, NextDate,
       DATEDIFF("D", Date, NextDate) AS DaysDiff
  FROM (SELECT ID, AccountNumber, Date,
               (SELECT MIN(Date) 
                  FROM YourTable T2
                 WHERE T2.AccountNumber = T1.AccountNumber
                   AND T2.Date > T1.Date
               ) AS NextDate
          FROM YourTable T1
        ) AS T 
```

如评论中所述，问题中缺少表名会导致答案中出现不同的表名；在这个答案中，我称之为 PatientMovements 的东西被称为 YourTable。另一个区别是原始问题没有在数据中包含 Unit 或 DischargeDate 列。但是，我给出的 UNION 查询给出了运行这些查询的相关数据，所以剩下要做的就是将 UNION 查询写入其他答案中，而不是 YourTable。这将导致：

```
SELECT T1.ID, T1.AccountNumber, T1.Date, 
       MIN(T2.Date) AS NextDate, 
       DATEDIFF("D", T1.Date, MIN(T2.Date)) AS DaysDiff
  FROM (SELECT *
          FROM PatientMovements
         WHERE (DischargeDate IS NOT NULL)
            OR (DischargeDate IS     NULL
                AND NOT EXISTS
                    (SELECT *
                       FROM PatientMovements AS P2
                      WHERE P1.Account   = P2.Account
                        AND P1.Unit      = P2.Unit
                        AND P1.AdmitDate = P2.AdmitDate
                        AND P2.DischargeDate IS NOT NULL
                    )
               )
       ) AS T1
  JOIN (SELECT *
          FROM PatientMovements
         WHERE (DischargeDate IS NOT NULL)
            OR (DischargeDate IS     NULL
                AND NOT EXISTS
                    (SELECT *
                       FROM PatientMovements AS P2
                      WHERE P1.Account   = P2.Account
                        AND P1.Unit      = P2.Unit
                        AND P1.AdmitDate = P2.AdmitDate
                        AND P2.DischargeDate IS NOT NULL
                    )
               )
       ) AS T2
    ON T1.AccountNumber = T2.Accountnumber AND T2.Date > T1.Date 
```

或者：

```
SELECT ID, AccountNumber, Date, NextDate,
       DATEDIFF("D", Date, NextDate) AS DaysDiff
  FROM (SELECT ID, AccountNumber, Date,
               (SELECT MIN(Date) 
                  FROM (SELECT *
                          FROM PatientMovements
                         WHERE (DischargeDate IS NOT NULL)
                            OR (DischargeDate IS     NULL
                                AND NOT EXISTS
                                    (SELECT *
                                       FROM PatientMovements AS P2
                                      WHERE P1.Account   = P2.Account
                                        AND P1.Unit      = P2.Unit
                                        AND P1.AdmitDate = P2.AdmitDate
                                        AND P2.DischargeDate IS NOT NULL
                                    )
                               )
                       ) AS T2
                 WHERE T2.Accountnumber = T1.AccountNumber
                   AND T2.Date > T1.Date
               ) AS NextDate
          FROM (SELECT *
                  FROM PatientMovements
                 WHERE (DischargeDate IS NOT NULL)
                    OR (DischargeDate IS     NULL
                        AND NOT EXISTS
                            (SELECT *
                               FROM PatientMovements AS P2
                              WHERE P1.Account   = P2.Account
                                AND P1.Unit      = P2.Unit
                                AND P1.AdmitDate = P2.AdmitDate
                                AND P2.DischargeDate IS NOT NULL
                            )
                       )
               ) AS T1
        ) AS T 
```

所以，只要你小心，在片段中开发查询，然后一致地组合它们，就可以驯服看起来最糟糕的查询。

### 公用表表达式

请注意，SQL 标准有“通用表表达式”（CTE），也就是“WITH 子句”，它可以让事情变得更容易。

```
WITH YourTable AS
   (SELECT *
      FROM PatientMovements
     WHERE (DischargeDate IS NOT NULL)
        OR (DischargeDate IS     NULL
            AND NOT EXISTS
                (SELECT *
                   FROM PatientMovements AS P2
                  WHERE P1.Account   = P2.Account
                    AND P1.Unit      = P2.Unit
                    AND P1.AdmitDate = P2.AdmitDate
                    AND P2.DischargeDate IS NOT NULL
                )
           )
     )
SELECT T1.ID, T1.AccountNumber, T1.Date, 
       MIN(T2.Date) AS NextDate, 
       DATEDIFF("D", T1.Date, MIN(T2.Date)) AS DaysDiff
  FROM YourTable T1
  JOIN YourTable T2
    ON T1.AccountNumber = T2.AccountNumber AND T2.Date > T1.Date 
```

或者：

```
WITH YourTable AS
   (SELECT *
      FROM PatientMovements
     WHERE (DischargeDate IS NOT NULL)
        OR (DischargeDate IS     NULL
            AND NOT EXISTS
                (SELECT *
                   FROM PatientMovements AS P2
                  WHERE P1.Account   = P2.Account
                    AND P1.Unit      = P2.Unit
                    AND P1.AdmitDate = P2.AdmitDate
                    AND P2.DischargeDate IS NOT NULL
                )
           )
     )
SELECT ID, AccountNumber, Date, NextDate,
       DATEDIFF("D", Date, NextDate) AS DaysDiff
  FROM (SELECT ID, AccountNumber, Date,
               (SELECT MIN(Date) 
                  FROM YourTable T2
                 WHERE T2.AccountNumber = T1.AccountNumber
                   AND T2.Date > T1.Date
               ) AS NextDate
          FROM YourTable T1
        ) AS T 
```

使用 CTE 的主要优点之一是优化器被明确告知表表达式在所有使用它的地方都是相同的，而当它被多次写出时，它可能不会发现这种共性。另外，多次写出查询会导致两个“本来相同”的查询实际上由于编辑错误而略有不同。CTE 排除了这种可能性。当前上下文中的另一个优势是将 CTE 与另一个问题的解决方案结合起来是儿戏。

遗憾的是，MS Access 2003 不太可能支持 CTE。我分担你的痛苦；我主要使用的 DBMS 也没有。

# javascript - 使用 jQuery Masonry 时保持网格顺序

> ID：10098573
> 
> 赞同：4
> 
> 时间：2012-04-11T01:06:27.383
> 
> 标签：javascript, jquery, jquery-masonry

我目前正在使用[jQuery Masonry](http://masonry.desandro.com/index.html)来制作网格布局。网格中的每个项目都具有相同的尺寸，除非该项目稍微变大时悬停。然而，这会导致一个问题，并且网格变得无序。

请参阅jsFiddle 上[的问题示例。](http://jsfiddle.net/mitchmalone/q3fXt/1/)

有没有办法强制 jQuery Masonry 始终保持网格顺序（从左到右，从上到下）？使用选项还是稍微修改 jQuery Masonry 代码？如果需要修改 jQuery Masonry，请使用[这个 gist](https://gist.github.com/2356054)让事情变得更容易。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T17:21:45.103

尝试仅操作悬停的项目 ( `$(this)`)，这样做时你真的不需要重新加载砌体网格。

[这是一个小提琴](http://jsfiddle.net/Nft3z/)

# ajax - IE XDomainRequest responseText 和 HTML

> ID：10098575
> 
> 赞同：0
> 
> 时间：2012-04-11T01:06:35.740
> 
> 标签：ajax, regex, internet-explorer-8, xdomainrequest

我在 IE 8 中使用 XDomainRequest 来获取网页的内容。reponseText 包含防止将标记插入 div 的转义字符和 unicode 字符。这是返回数据的示例。

```
<!DOCTYPE html PUBLIC \"-\/\/W3C\/\/DTD XHTML 1.0 Transitional\/\/EN\" \"http:\/\/www.w3.org\/TR\/xhtml1\/DTD\/xhtml1-transitional.dtd\">\u000d\u000a<html xmlns=\"http:\/\/www.w3.org\/1999\/xhtml\">\u000d\u000a<head>\u000d\u000a    <title>...<\/title>\u000d\u000a    <script src=\"\/\/ajax.googleapis.com\/ajax\/libs\/jquery\/1.7.1\/jquery.min.js\" type=\"text\/javascript\"><\/script>\u000d\u000a<\/head>\u000d\u000a<body>\u000d\u000a\u000d\u000a<div style=\"font-size:24px;font-weight:bold\">\u000d\u000aText Headline: \u000d\u000a<\/div>\u000d\u000a\u000d\u000a<div style=\"float:left;width:50%;margin:0;padding:0;\">\u000d\u000a<p>Lorem ipsum dolor sit amet<\/p>\u000d\u000a\u000d\u000a<p>In nec imperdiet lectus. 
```

当我使用 decodeURI 或 decodeURIComponent 时，我收到“要解码的 URI 不是有效的编码”错误。

有人可以建议一种方法或正则表达式来清理 HTML 吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-11T14:22:53.380

根据我的快速测试：

```
regex = /\\([^u])/g;
// put it in a JSON object so that JS doesn't automatically de-escape
string = JSON.stringify({response: '<!DOCTYPE html PUBLIC \"-\/\/W3C\/\/DTD XHTML 1.0 Transitional\/\/EN\" \"http:\/\/www.w3.org\/TR\/xhtml1\/DTD\/xhtml1-transitional.dtd\">\u000d\u000a<html xmlns=\"http:\/\/www.w3.org\/1999\/xhtml\">\u000d\u000a<head>\u000d\u000a    <title>...<\/title>\u000d\u000a    <script src=\"\/\/ajax.googleapis.com\/ajax\/libs\/jquery\/1.7.1\/jquery.min.js\" type=\"text\/javascript\"><\/script>\u000d\u000a<\/head>\u000d\u000a<body>\u000d\u000a\u000d\u000a<div style=\"font-size:24px;font-weight:bold\">\u000d\u000aText Headline: \u000d\u000a<\/div>\u000d\u000a\u000d\u000a<div style=\"float:left;width:50%;margin:0;padding:0;\">\u000d\u000a<p>Lorem ipsum dolor sit amet<\/p>\u000d\u000a\u000d\u000a<p>In nec imperdiet lectus.'});

string.replace(regex, '$1'); 
```

将替换除 Unicode 之外的所有转义斜杠。我认为 JS 中的正斜杠没有许多其他非转义用途。

# c# - 如果字符串列表不在其中，则获取两个字符串之间的字符串

> ID：10098578
> 
> 赞同：0
> 
> 时间：2012-04-11T01:07:16.117
> 
> 标签：c#, regex, linq

希望标题不会太混乱。

我有一个目录，里面满是包含故事的文件。只有当它们之间的字符串不包含另一个列表中包含的任何句子时，我才需要获取两个句子之间的字符串列表（总是向前）。每个故事。

因此，例如，我有一个列表“大狗”、“她追他”、安妮咬嘴唇”等。

然后我有一个文件，它可能是一个包含谁知道什么的故事。我想找到“他跳到她后面”和“她吻了他”之间的字符串，但前提是它们之间的字符串不包含第一个列表中的任何句子，或者它们本身。

我已经找到了一些方法来做到这一点，但大多数都很慢，需要将近一个小时才能完成一个文件，我相信一定有更好更快的方法来做到这一点。请注意，我没有在此处添加它，因为我不想将解决方案限制在我正在做的事情上，这可能不是最好的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T03:31:08.143

不确定您使用什么算法来解决您描述的问题，但这是我在这种情况下会做的

**预处理：**

*   确保任何空白字符序列都减少为一个（空格、制表符等）。
*   使整个文本小写或大写。

**过程：**

*   将所有标记的单词预加载到内存（有序列表以使用二进制搜索，理论上这个过程应该只在您第一次创建列表时消耗时间，继续对条目进行排序并将它们以您以后可以加载的格式保存，任何进一步的添加应该进行二进制搜索以确定单词是否在列表中并将条目放在相应的位置/槽中）。
*   将所有流行语预加载到内存中（在这里我们可以使用与加载单词相同的方法）。
*   遍历文件并保留与标记列表匹配的任何单词的偏移量/位置和长度。考虑到大文件，偏移量应该很长。
*   查找标记单词的序列。第一个单词之后的任何匹配都是序列的候选，因为我们删除了所有空白字符序列，如果这个单词的偏移量等于前一个单词的偏移量加上前一个单词，我们可以确定 WordN 是序列的一部分长度加 1，这里的 1 代表分隔两个单词的空白字符。word2Offset = word1Offset + word1Length + 1。
*   检查找到的任何序列是否匹配开始或匹配流行语。

**实施资产：**

*   **单词：**一个简单的字符串就足以表示单词。所有单词必须以小写或大写形式存储。
*   **组件：**组件是一个结构，它包含一个单词和在文件中找到它的文件的偏移量
*   **短语：**是两个或多个组件的组合，一个简单的列表就足够了。
*   一次读取一个字符可以帮助快速确定单词和单词的顺序。例如，每个空格都意味着读取了一个新组件，基本上是一个单词，所以我们可以在那里使用检查它是否匹配，如果它匹配并且是第一个匹配，我们不知道它是否是一个序列，但是一旦我们读取第二个或第三个单词并且我们知道是否匹配，我们可以检查当前偏移量是否遵循我们之前描述的规则。

**检查阶段**

*   如果没有标记任何单词，则不会匹配任何短语。几乎不可能，但谁知道呢。
*   文件中的任何单词匹配序列都代表短语检查的候选对象。
*   检查词长和后面的词内容以检查流行语和候选词之间的匹配。在这里，您可以检查部分或整个短语是否匹配。

**获取两个序列阶段之间的文本。**

由于阶段只是一个组件列表，我们只需从第一个短语的最后一个单词的偏移量和长度之和到第二个短语的第一个单词的偏移量读取文件。

From = PhaseALastWordOffset + PhaseALastWordLength
To = PhaseBFirstWordOffset
内容 = StoryFile.readSegment(From, To);

希望能帮助到你。

# jquery - jquery 验证器插件 - 没有验证

> ID：10098579
> 
> 赞同：0
> 
> 时间：2012-04-11T01:07:20.890
> 
> 标签：jquery, jquery-validate

我知道这很简单（无论如何根据插件页面）

但我试图使用插件没有成功，这是我的表格：

```
<form id="mongoForm">
        <label for="skip">skip:</label> <input type="text" id="skip"
            style="width: 70px">
        <p />
        limit: <span id="limitLable" style="border: 0">1</span>
        <div id="limit" style="width: 250px"></div>
        <p />
        <label for="collection">collection: </label> <input type="text"
            id="collection">
        <p />
        <label for="sort">sort: </label> <input type="text" id="sort">
        <p />
        <label for="type">type: </label><select id="type">
            <option value="find" selected="selected">find</option>
            <option value="count">count</option>
        </select>
        <p />
        <label for="query">query: </label>
        <textarea rows="10" cols="80" id="query"></textarea>
        <input type="submit" value="execute" id="execute">
    </form> 
```

和我的 jquery 脚本：

```
$(document).ready(function() {
    $.validator.addMethod("validJson", function(value, element) {
        try {
            var val = $.parseJSON(value);
            return true;
        } catch (e) {
            return false;
        }

    }, "Invalid JSON string");
    $("#mongoForm").validate({
        rules : {
            collection : {
                required : true
            },
            query : {
                validJson : true
            }
        },
        submitHandler : function(form) {
            queryServer();
        }
    }); 
```

但是，验证不起作用。如果我在输入中添加一个 class="required"，它适用于自定义验证，但不适用于我的自定义 validJson 方法。但这并不能解决我的问题，因为不需要某些字段我只需要验证可选值

请问有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T12:01:18.750

您需要名称属性，如[一般准则中所述：](http://docs.jquery.com/Plugins/Validation/Reference#General_messages)

> 输入元素需要 name 属性，没有它验证插件将无法工作。通常 name 和 id 属性应该具有相同的值。

所以标记应该是

```
<label for="collection">collection:</label> 
<input type="text" id="collection" name="collection"> 
```

ETC

# uinavigationcontroller - 隐藏导航栏后重新排列控件

> ID：10098583
> 
> 赞同：0
> 
> 时间：2012-04-11T01:07:25.403
> 
> 标签：uinavigationcontroller, xamarin.ios

我的应用程序的主视图是一个 UImageView 和一个 NavigationController，它是隐藏的。我正在使用 Monotouch.Dialog 创建一个运行良好的设置屏幕。

我已经安排 UIImageView 与 NavigationController 重叠，这样它就可以到达可视区域的顶部。

我的问题是，当我回到主视图并隐藏 NavigationController 时，看起来 UIImageView 已自动“下推”，因此它不再重叠。看起来视觉控件没有任何 Dock/Anchor 属性，那么是否有一种编程方式可以将 UIImageView 放回原来的位置？

抱歉，如果这是一个菜鸟问题，我是一个长期的 C# 程序，但直到本月才真正启动过任何类型的 Mac，所以我发现 Monotouch 的学习曲线在早期有点困难。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T18:16:17.000

实际上有一些用于视觉控件的停靠/锚属性。在处理设备方向更改时，它们也常被使用。

在 Xcode 中，单击您遇到问题的图像，在右侧您应该会看到属性窗口。在该窗口的顶部，单击下一个选项卡（看起来像标尺的东西），您可以在其中调整位置等。

但是回到手头的问题，您似乎在主视图上隐藏了一个导航控制器，但是在您使用导航控制器将某些内容推送到视图堆栈后它会出现（如果我错了，请纠正我）。解决此问题所需要做的就是在每个控制器的 XIB 上将右侧属性面板中的“模拟指标”属性更改为“导航栏”或“标签栏”（如果您使用的是一个）。这将帮助您正确定位事物，使其正确显示。请注意，这实际上并没有创建导航栏，而只是让您查看以编程方式推送视图并出现时的外观。

所以总而言之，只需修改两个 XIB 以不同地处理图像，您的问题就应该得到解决！

# mysql - 克隆 MySQL 行加上新的唯一 ID

> ID：10098587
> 
> 赞同：2
> 
> 时间：2012-04-11T01:08:03.857
> 
> 标签：mysql, clone

我可以使用以下代码克隆表中的一行：

```
$uuid = 'blahblah';    
INSERT INTO events (title, subtitle) SELECT title, subtitle FROM events WHERE uuid = '$uuid' 
```

但是，我想为新克隆的行生成一个新的唯一 ID。此表列的名称为“uuid”，如何在克隆过程中插入新的唯一 ID？我有一个 INT 类型的自动索引列，但我也有一个 VARCHAR 类型的唯一 ID 列，用于每一行（混合字母数字）。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T20:07:04.123

我在这里找到了答案 - [PHP MySQL Copy a row within the same table... with a Primary and Unique key](https://stackoverflow.com/questions/11660944/php-mysql-copy-a-row-within-the-same-table-with-a-primary-and-unique-key)

基本上，选择除 ID 之外的所有内容，只要主键设置为自动递增 - 应该不是问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-29T17:54:46.317

```
/*
eduardoaf.com
https://github.com/eacevedof/
*/
DELIMITER $$

DROP PROCEDURE IF EXISTS `prc_clone_row`$$

CREATE PROCEDURE `prc_clone_row`(
    sTableName VARCHAR(25)
    ,sId VARCHAR(5)
    )
BEGIN
    SET @sSQL := CONCAT('SELECT (MAX(id)+1) AS idnew FROM ',sTableName,' INTO @sIdNew');
    PREPARE sExecute FROM @sSQL;
    EXECUTE sExecute;

    IF (@sIdNew IS NOT NULL) THEN
        SET @sSQL := CONCAT('CREATE TEMPORARY TABLE tempo_table SELECT * FROM ',sTableName,' WHERE id = ',sId,'; ');
        PREPARE sExecute FROM @sSQL;
        EXECUTE sExecute; 

        SET @sSQL := CONCAT('UPDATE tempo_table SET id=',@sIdNew,' WHERE id=',sId,'; ');
        PREPARE sExecute FROM @sSQL;
        EXECUTE sExecute;        

        SET @sSQL := CONCAT('INSERT INTO ',sTableName,' SELECT * FROM tempo_table WHERE id=',@sIdNew,'; ');
        PREPARE sExecute FROM @sSQL;
        EXECUTE sExecute; 

        SET @sSQL := CONCAT('SELECT * FROM ',sTableName,' ORDER BY id DESC;');
        PREPARE sExecute FROM @sSQL;
        EXECUTE sExecute;   
    ELSE
        SELECT CONCAT('TABLE ',sTableName,' IS EMPTY!!!') AS msg;
    END IF;

END$$

DELIMITER ;

CALL prc_clone_row('app_cms_content','1'); 
```

# jquery - 使用 jQuery UI 自动完成结果取决于其他输入值

> ID：10098590
> 
> 赞同：0
> 
> 时间：2012-04-11T01:08:39.730
> 
> 标签：jquery, jquery-ui, cakephp, jquery-ui-autocomplete

我正在使用 jQuery UI 的自动完成功能来创建关联值的被动数据库。我有三个输入：镜头类型、镜头设计和镜头材料。

所有三个值都是自动完成的，并且在表单提交时，如果这些输入存在唯一的值，它们将存储在数据库中。

我想要做的是根据前一个输入的已知输入为每个输入返回自动完成值。因此，例如镜头类型 a 只有镜头设计输入：c、d、g。如果镜头类型设置为 b，那么自动完成将返回 a,b,e,f。

我将如何使用 jQuery UI 自动完成来做到这一点？我已经知道如何编写数据库和服务器端逻辑，但自动完成前端却被难住了。

**编辑：** 我已经通过使用以下java脚本制定了一个硬编码的方法：

```
 $('input.autocompleteme').each( function() {
            var $input = $(this);
            $input.autocomplete({ 
                source: function( request, response ) {

                    var fieldName = $input.attr('id');

                    if ( fieldName.indexOf( "Right" ) !== -1 ) {
                        var lensSide = "Right";
                    }else{
                        var lensSide = "Left";
                    }

                    var LensType = $("#" + "Patient" + lensSide + "EyeLensType").attr("value");
                    var LensDesign = $("#" + "Patient" + lensSide + "EyeLensDesign").attr("value");
                    var LensMaterial = $("#" + "Patient" + lensSide + "EyeLensMaterial").attr("value");
                    var LensCoating = $("#" + "Patient" + lensSide + "EyeLensCoating").attr("value");
                    var LensTints = $("#" + "Patient" + lensSide + "EyeLensTints").attr("value");

                    var serverUrl = "/autocomplete.json?field=" + fieldName + "&LensType=" + LensType + "&LensDesign=" + LensDesign + "&LensMaterial=" + LensMaterial + "&LensCoating=" + LensCoating + "&LensTints=" + LensTints;
                    var term = request.term;

                    lastXhr = $.getJSON( serverUrl, request, function( data, status, xhr ) {
                        response( data );
                    });
                },
                minLength: 2, 
            });
        }); 
```

这会向 cakephp 函数提交一个 url，该函数类似于：

```
 function admin_autocomplete(){
    Controller::loadModel('AutoField');

    $param      = $this->params["url"]["term"];
    $fieldName  = $this->params["url"]["field"];
    $hasParent  = false;
    $output     = array();

    if ($param == ''){
        $this->set("output", NULL);
        return;
    }

    switch ($fieldName){

        case "PatientRightEyeLensType":
        case "PatientLeftEyeLensType":
            $fieldName = "LensType";
        break;

        case "PatientRightEyeLensDesign":
        case "PatientLeftEyeLensDesign":
            $fieldName = "LensDesign";
            $hasParent = "LensType";
        break;

        case "PatientRightEyeLensMaterial":
        case "PatientleftEyeLensMaterial":
            $fieldName = "LensMaterial";
            $hasParent = "LensDesign";
        break;

        case "PatientRightEyeLensCoating":
        case "PatientLeftEyeLensCoating":
            $fieldName = "LensCoating";
            $hasParent = "LensMaterial";
        break;

        case "PatientRightEyeLensTints":
        case "PatientLeftEyeLensTints":
            $fieldName = "LensTints";
            $hasParent = "LensCoating";
        break;

        default:
            die("Field Name is not known");
        break;
    }

    if ($hasParent === false){ // This is the root of the tree.

        $query = array(
            "conditions" => array(
                "type" => $fieldName,
                "parent_id" => NULL,
                "value REGEXP '^$param'"
            ),
            "fields" => array(
                "value"
            ),
        );

        $results = $this->AutoField->find("all", $query);

    }else{

        $parentValue = $this->params["url"][$hasParent];
        $query = array(
            "conditions" => array(
                "type" => $hasParent,
                "value" => $parentValue,
            ),
            "fields" => array(
                "id",
            )
        );

        $results = $this->AutoField->find("all", $query);
        $parentIds = "";
        foreach ($results as $parentId){
            $parentIds .= $parentId["AutoField"]["id"] . ",";
        }

        $parentIds = substr_replace($parentIds ,"",-1);

        $query = array(
            "conditions" => array(
                "type" => $fieldName,
                "parent_id IN ($parentIds)",
                "value REGEXP '^$param'"
            ),
            "fields" => array(
                "value"
            ),
        );

        $results = $this->AutoField->find("all", $query);

    }

    foreach ($results as $result){
        $output[] = $result["AutoField"]["value"];
    }

    $this->set("output", $output); 

} 
```

我的 Mysql 数据库如下所示：

```
--
-- Table structure for table `auto_fields`
--

CREATE TABLE IF NOT EXISTS `auto_fields` (
  `id` int(11) unsigned NOT NULL auto_increment,
  `created` datetime default NULL,
  `modified` datetime default NULL,
  `parent_id` int(11) default NULL,
  `type` varchar(100) default NULL,
  `value` varchar(150) default NULL,
  `count` int(11) NOT NULL default '0',
  PRIMARY KEY  (`id`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8 AUTO_INCREMENT=5 ;

--
-- Dumping data for table `auto_fields`
--

INSERT INTO `auto_fields` (`id`, `created`, `modified`, `parent_id`, `type`, `value`, `count`) VALUES
(1, '2012-04-12 10:51:00', '2012-04-12 10:51:02', NULL, 'LensType', 'Progressive', 0),
(2, '2012-04-12 10:51:00', '2012-04-12 10:51:00', NULL, 'LensType', 'Bifocal', 0),
(3, '2012-04-12 11:55:46', '2012-04-12 11:55:46', 1, 'LensDesign', 'AAA', 0),
(4, '2012-04-12 11:55:46', '2012-04-12 11:55:46', 1, 'LensDesign', 'BBB', 0); 
```

我确信拥有比我更好的 Javascript 技能的人能够编写 UI 交互的那一侧，这样就不需要对继承变量进行硬编码。

对我来说，这可以按预期工作，继承由 php 函数中的开关映射。如果我能弄清楚 javascript 前端，我可以将其写入 cakephp 帮助程序和组件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T01:19:33.110

我认为 jQuery UI 没有为此提供任何开箱即用的东西。

如果您在客户端拥有所有这些值，则可以在设置自动完成时使用“源”选项的回调函数进行过滤。在回调函数中，您将有逻辑查看其他自动完成框中的值，然后返回过滤后的集合。

另一方面，如果您在 上获取自动完成值，则可以在那里放置类似的逻辑。

# php - 需要在单独的文件中将值从 javascript 传递给 php

> ID：10098591
> 
> 赞同：0
> 
> 时间：2012-04-11T01:08:57.420
> 
> 标签：php, javascript, ajax

我按照这样的教程进行操作：

```
 ajaxRequest.onreadystatechange = function(){
            if(ajaxRequest.readyState == 4){
                //use the value  passed in to return response to correct button
                e = document.getElementById("RB" + number);
                e.value = ajaxRequest.responseText + number;
            }

        }

        ajaxRequest.open("GET", "Reject.php" + number, true);
        ajaxRequest.send(null); 
```

我需要为 Reject.php 中的 mysql 函数传递编号。但是，尽管该示例适用于导师，但我的文件希望将数字附加到 reject.php 给我一个 404 错误。我究竟做错了什么？在我的 Reject.php 中：

```
 $ID = $_GET['number']; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T01:11:13.963

您需要传递一个查询字符串，就像任何其他 URL 一样：

```
"Reject.php?number=" + number 
```

# xslt - xpath：我们如何只选择最后一个文本节点？

> ID：10098593
> 
> 赞同：5
> 
> 时间：2012-04-11T01:09:05.887
> 
> 标签：xslt, xpath, lxml, libxml2

如何使用 xpath 选择全局最后一个文本节点？我试过这个，但它给了我文档每个上下文中的最后一个节点。

```
lxml.html.fromstring('1<a>2<b>3</b>4<c>5</c>6</a>').xpath('//text()[last()]')
['1', '3', '5', '6'] 
```

我可以这样做，但是在时间和空间上效率都很低，尤其是在文档变大的情况下。

```
lxml.html.fromstring('1<a>2<b>3</b>4<c>5</c>6</a>').xpath('//text()[last()]')[-1]
'6' 
```

我尝试使用 -1 的索引，但这给了我一个空列表。我尝试使用一些反向轴（以便我可以使用 1 进行索引），但我无法让它们在全局环境中工作。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-11T01:53:37.247

**使用**：

```
(//text())[last()] 
```

这是一个常见问题解答。

**说明**：

XPath 伪运算符`//`的优先级（优先级）低于`[]`运算符，后者与它之前的节点测试绑定得更强。

与数学和每种语言一样，覆盖默认优先级的方法是使用括号。

# c++ - 素数序列的回溯算法

> ID：10098594
> 
> 赞同：0
> 
> 时间：2012-04-11T01:09:13.807
> 
> 标签：c++, backtracking

我在回溯时遇到了麻烦，并且不确定我正在做的事情是否准确地回溯。

在我的示例中，我有 n 个整数，它将是 [5,6,7,8]。

从这些整数中，我需要找出素数序列是否存在以及是否显示它。

这个例子的素数序列是 7,6,5,8 因为 7+6=13 6+5=11 5+8=13

为了得到答案，我可以遍历每个 n，然后尝试查看它是否是素数序列。

**5点开始：**

*   5,6[7,8]
*   5,6,7[8]

因为 7+8 不是素数。进入下一个整数。

因为 5+7 不是素数。进入下一个整数。

*   5,8,[6,7]

因为 8+6 或 8+7 不是素数。你已经完成了 5 个。

**6点开始：**

*   6,5[7,8]
*   6,5,8[7]

因为 7+8 不是素数。进入下一个整数。

*   6,7[5,8]

因为 7+5 或 7+8 不是素数。进入下一个整数。

因为 6+8 不是素数。你已经完成了 6 个。

**7点开始：**

*   7,6[5,8]
*   7,6,5[8]
*   7,6,5,8

自从你找到素数序列后结束。

那么如何通过回溯来解决这个问题呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T01:29:49.887

在这种情况下，回溯的想法基本上是这样的：让我找到所有有效事物的子序列（或前缀）的延续。如果我成功了，我会将继续返回给我的调用者。如果我运气不好，我会要求我的来电者尝试不同的前缀。

更确切地说：

```
// call initially as Backtrack(epsilon, all numbers)
Backtrack(Sequence fixedPrefix, Set unbound) {
  if (unbound is empty) {
    return check(fixedPrefix);
  }
  for all (element in unbound) {
    if (Backtrack(concat(fixedPrefix,element), setminus(unbound,element))
      return true;
  }
  return false;
} 
```

请注意，此算法只会告诉您序列是否存在（并且它在 C++ 中的直接实现会非常慢），但不会告诉您该序列是什么，但这很容易修改。

无论如何，回溯中的“返回”发生在递归调用*不走运*的最后一行：这将提示调用实例*尝试另一个 prefix*，因此控制流有点颠倒。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T01:55:05.163

您的函数（无论是否为伪代码）都没有做任何有效的事情。我实际上不确定它应该做什么。IE。`u = 0;`紧随其后`if(u == 4);`，你的`isPrime`函数总是被传递`(Integers[0]+integers[0])`。

我相信您所说的回溯更恰当地称为递归函数（可以调用自身的函数）。回溯是递归函数可以表现出的特定行为的一个糟糕（模糊）的名称。

如果你想要一个这样的递归函数，你需要废弃它并重新开始。用简单的英语（或其他语言）写出函数应该做什么。然后，一旦您知道需要传递给它的内容、失败和成功之间的区别以及失败或成功时返回的内容（在失败时需要如何修改向量），然后对其进行编码。

超级提示：对于整数的小选择，例如您提出的，请尝试`next_permutation()`在 stl`< algorithm >`中快速浏览向量中可能的整数排列。

# ios - 将应用上传到 App Store

> ID：10098596
> 
> 赞同：0
> 
> 时间：2012-04-11T01:09:43.753
> 
> 标签：ios, xcode, app-store, appstore-approval

我正在尝试使用 Apple 提供的应用程序加载器将我的应用程序上传到 App Store，但是当我尝试将我的源代码发送到 Apple 时，我收到此错误：

> “应用程序包装必须以 .app /var/folder/4h/2xtkks0x5nvgz75c87r_cjdm0000gn/T/BowledOver!.zip/BowledOver! 结尾！无效”

我需要向我的项目添加什么才能成功发送？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T04:53:33.310

如果您使用的是较新版本的 Xcode，请尝试使用应用程序加载器构建到 Xcode 中进行提交。

![在此处输入图像描述](../Images/cf732ee3ab108a388757ca3e900caaa2.png)

![在此处输入图像描述](../Images/9dc1b93f405bf56108099efc307a4f20.png)

单击分发后，然后按照屏幕指南进行操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-24T19:19:45.420

当您手动制作 Ipa 文件时，您复制 xcarchive 文件内容的命运文件夹的名称必须为“Payload”。这样做此错误消息消失。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-11T01:17:01.733

我怀疑 App Store 不允许您的文件名中的 bang (!)。您的显示名称可能与您的二进制名称不同，因此您仍然可以使用“Bowled Over！” 与“保龄球”。

# javascript - 具有中等页码的分页

> ID：10098597
> 
> 赞同：1
> 
> 时间：2012-04-11T01:10:04.263
> 
> 标签：javascript, jquery, pagination, paging, underscore.js

我正在尝试在 JavaScript 中创建分页，类似于您现在看到的大多数分页，如果有很多页面，它将使用点来分解页面显示。即（1 2 ... 22 23 24 25 **26** 27 28 ... 110 111）

这是我到目前为止的代码，但这不起作用。我只显示当前页面。有什么想法我在这里想念的吗？

仅供参考 - 你会注意到我正在使用[`_.range()`](http://underscorejs.org/#range)，这是来自 Underscore.js 和[`$.inArray()`](https://api.jquery.com/jQuery.inArray/)，这是来自 jQuery。

您还会注意到我有`iPage`，默认情况下我的分页从 0 开始（`page`是我所在的当前页面索引），所以我只是为了显示而添加 1 - 我已经尝试了两种方法，我得到了同样的问题。

非常感谢您的帮助！

编辑：我刚刚在下面添加了一条 else 语句，现在它显示 (1 2 3 21)，21 是最后一页，1 是我所在的页面。

```
var midRange = 7;
var paging = '';
var iPage = page + 1;

if(totalPages > 10) {

    var startRange = iPage - Math.floor(midRange / 2);
    var endRange   = page + Math.floor(midRange / 2);

    if(startRange <= 0) {
        endRange += Math.abs(startRange + 1);
        startRange = 1;
    }

    if(endRange > totalPages) {
        startRange -= (endRange - totalPages);
        endRange = totalPages;
    }

    var range = _.range(startRange, endRange);

    for(i = 1; i <= totalPages; i++) {

        if(range[0] > 2 && i == range[0]) {
            paging += ' ... ';
            console.log(paging);
        }

        inArray = $.inArray(i, range);

        if (inArray > -1)
            isInArray = true;
        else 
            isInArray = false;

        if(i == 0 || i == totalPages || isInArray) {
            if(i == iPage) {
                paging += '<a href="#"><b>'+i+'</b></a>';
                console.log(paging);
            } else {
                paging += '<a href="#">'+i+'</a>';
            }
        }
        if(range[midRange-1] < totalPages && i == range[midRange-1]) {
            paging += ' ... ';
            console.log(paging);
        }                   
    }
} else {
    for(i = 1; i <= totalPages; i++) {

        if(i == iPage) {
            paging += '<a href="#"><b>'+i+'</b></a>';
            console.log(paging);
        } else {
            paging += '<a href="#">'+i+'</a>';
            console.log(paging);
        }
    }   
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-05T18:03:16.993

我在 nodejs + underscore + jam + bootstrap 中的解决方案

前：

```
var pages = 200;
var limit = 50;
var page = 2;
var _ = required('underscore') 
```

索引.jade

```
.pagination
    ul
        - if(page > 0)
            li
                a(href='/page/'+ page) Prev
        - var _next = 10, _prev = (page +1) - 10
        - if(pages - (page + 1) < _next) _next = pages - (page + 1)
        - if(_prev < 0) _prev = 1;
        - var range = _.range(_prev, page + (_next+2));
        - each i in range
            li(class=i==page+1?'active':null)
                a(href='/page/'+(i)) #{i}
        - if((page+1) < pages)
            li
                a(href='/page/'+ (page +1)) Next 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T11:07:19.470

您可以考虑使用“对数”样式的分页。在此处查看我的帖子：[如何为许多页面进行页面导航？对数页面导航](https://stackoverflow.com/q/7835752/999120)。否则，实际上并不容易通过单击导航链接到达“...”范围中间的任何页面。我的答案中包含 PHP 和 ASP 中的代码；转换为 javascript 应该不难。

# analytics - Web 应用程序的私有分析

> ID：10098599
> 
> 赞同：4
> 
> 时间：2012-04-11T01:10:14.337
> 
> 标签：analytics, web-analytics

我们有一些私人网络应用程序，我们希望记录用户活动，以便深入了解用户如何使用这些应用程序，这与谷歌分析非常相似。

通常我们会简单地使用 Google Analytics、Mint、Clicky 或其他服务，但由于应用程序正在处理的内容的敏感性（类似于在线会计应用程序），我宁愿将服务保留在内部而不是冒险将使用数据发送到外部服务（主要是为了隐私，但也是为了将所有内容保存在内部，并避免在用户发现数据被发送时惹恼用户）。

我们有一些想法，即在数据库中记录活动（例如请求、会话时间等），然后再分析数据，但如果已经有解决方案，最好先考虑这些。

我们的应用程序是在 Rails 3.x 中构建的，在带有 PostgreSQL 后端的 Ubuntu 服务器上，但是我们有各种用不同语言构建的系统工具，因此 PHP 工具或其他工具不是限制。

这种分析有哪些选择？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T08:30:56.433

看看 piwik.org

做了很多与 GA 类似的事情，可以自托管并且相当漂亮。

# self - 无法在 OS X 上运行 Self 4.4

> ID：10098602
> 
> 赞同：0
> 
> 时间：2012-04-11T01:10:50.487
> 
> 标签：self

我按照[http://selflanguage.org/download/index.html](http://selflanguage.org/download/index.html)上的说明在我的 OS X 机器上安装 Self 4.4。Self-4.4.pkg 安装没有问题，但没有“... /usr/bin/Self 上的小 shell 脚本”。

应该在 /Libarary/Self 中的文件在那里，但双击它们没有任何作用。双击快照同样无效。

我如何让这个东西运行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T06:39:41.077

目前这是安装程序中的一个错误，应该很快就会得到修复。同时，

*   您可以使用以下内容自己创建文件 /usr/bin/Self

    ```
    #!/bin/sh
    /Library/Self/0/Self.app/Contents/MacOS/Self $@ 
    ```

*   您可以直接使用实际的 Self 可执行文件：`/Library/Self/0/Self.app/Contents/MacOS/Self`

（在这两种情况下，您都应该`-s`在要加载快照时使用命令行开关）

*   您可以尝试可在[http://selflanguage.org/files/releases下载的实验性 OS X Self starter（参见](http://selflanguage.org/files/releases/4.5/experimental/SelfVM-30Mar12.zip)[http://tech.groups.yahoo.com/group/self-interest/message/2856 ）](http://tech.groups.yahoo.com/group/self-interest/message/2856) [/4.5/experimental/SelfVM-30Mar12.zip](http://selflanguage.org/files/releases/4.5/experimental/SelfVM-30Mar12.zip)

# c# - WPF 应用程序中无法捕获的崩溃

> ID：10098604
> 
> 赞同：0
> 
> 时间：2012-04-11T01:11:03.923
> 
> 标签：c#, wpf, exception, crash, try-catch

我已经订阅了 App.xaml.cs 中的 Application.Current.DispatcherUnhandledException AppDomain.CurrentDomain.UnhandledException 以尝试捕获所有未处理的异常，但我的应用程序仍然会因此 .Net 运行时错误和错误模块 CLR.dll 而崩溃。

当我调用第 3 方 COM 互操作对象时会发生崩溃。代码简化：（请注意，代码在与主 UI 线程不同的线程中运行）

```
try
{
    myLatLong = (LatLongReport)locationObj.GetReport(ref IID_LatLongReport);
}
catch (Exception ex)
{
}
catch
{
} 
```

您可以看到我正在尝试捕获任何托管/非托管、符合 CLS/不符合 CLS 的异常，但它们都不起作用。

提前感谢您的任何想法。

更多信息：

我正在使用 Windows LocationApiLib。错误消息显示“由于 IP xxxxx 的 .Net 运行时出现内部错误，退出代码为 80131506，进程已终止”。“故障模块名称：clr.dll 版本 4.0.xxxx”。

# jquery - 如何实现动态图像幻灯片

> ID：10098612
> 
> 赞同：0
> 
> 时间：2012-04-11T01:12:10.513
> 
> 标签：jquery, tabs

我想知道[https://kippt.com/](https://kippt.com/)为动态选项卡区域实现了以下 javascript：

[http://jsfiddle.net/itzamacko/ykdCT/](http://jsfiddle.net/itzamacko/ykdCT/)

我想知道这是如何完成的，所以我可以为我自己的项目模拟它，但我一直在努力让它在本地工作一天左右：/

任何有关此实现如何工作的见解将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T21:27:47.490

Kippt 的开发者在这里。您似乎忘记切换到正确的 JS 库：Kippt 的代码库是使用 jQuery 构建的，而不是 Mootools。这是工作版本：

[http://jsfiddle.net/itzamacko/ykdCT/](http://jsfiddle.net/itzamacko/ykdCT/)

我还将正确的 CSS 复制粘贴到 CSS 选项卡。如果您对实施有任何疑问，我很乐意回答。

# core-animation - 使用 CAMediaTimingFunction 计算时间 (t) 的值

> ID：10098613
> 
> 赞同：15
> 
> 时间：2012-04-11T01:12:15.943
> 
> 标签：core-animation, bezier

在 Cocoa/Touch 中，CAMediaTimingFunction 表示四个控制点，它们指定了计时函数的三次贝塞尔曲线。对于我正在编写的应用程序，我希望能够在任意时间 t (0 -> 1) 提取所述贝塞尔曲线的结果。令我困惑的是，当我查找如何[执行此操作](http://en.wikipedia.org/wiki/B%C3%A9zier_curve#Cubic_B.C3.A9zier_curves)时，结果也应该是一个点，而不是一个标量：

![B(t) = (1 - t) ^ 3 * P0 + 3 * (1 - t) ^ 2 * t * P1 + 3 * (1 - t) * t ^ 2 * P2 + t ^ 2 * P3](../Images/3a16c709b0e7315738e9033f04b188dc.png)

但是，Apple 的实现会产生一个标量值（您可以在此图中看到他们绘制 x(t) 与 t 的关系图：http: [//developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Animation_Types_Timing/Articles/ Timing.html#//apple_ref/doc/uid/TP40006670-SW1](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Animation_Types_Timing/Articles/Timing.html#//apple_ref/doc/uid/TP40006670-SW1) )

那么苹果是不是简单地忽略了结果的 y 坐标而只处理 x 呢？这看起来很奇怪，因为这样您就不需要传递控制点而是控制标量，因为 y 根本不会影响结果。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-09-29T22:23:48.527

CoreAnimation 可以满足`CAMediaTimingFunction`您的需求，但不会公开为给定的“x”获取“y”以供多功能（动画）使用，而只是将已解决的值不透明地提供给引擎盖下的动画系统。

我自己需要它，所以[构建了一个类，其接口和功能`CAMediaTimingFunction`与所需的`-valueForX:`方法](https://gist.github.com/raphaelschaad/6739676)完全相同；用法示例：

```
RSTimingFunction *heavyEaseInTimingFunction = [RSTimingFunction timingFunctionWithControlPoint1:CGPointMake(0.8, 0.0) controlPoint2:CGPointMake(1.0, 1.0)];
CGFloat visualProgress = [heavyEaseInTimingFunction valueForX:progress]; 
```

您可以创建缓入、缓出、缓入缓出或任何可以用[三次贝塞尔曲线描述的曲线](http://en.wikipedia.org/wiki/B%C3%A9zier_curve)。实现数学基于 WebCore (WebKit)，这大概也是 CoreAnimation 在后台使用的。

享受吧，拉斐尔

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-04-01T20:28:37.057

不幸的是，Core Animation 没有公开其动画时间的内部计算模型。然而，对我来说真正有效的是使用 Core Animation 来完成这项工作！

1.  创建一个`CALayer`作为评估者
2.  将其框架设置为`((0.0, 0.0), (1.0, 1.0))`
3.  设置`isHidden`为`true`
4.  设置`speed`为`0.0`
5.  将此层添加到某个容器层
6.  当你想评估 any`CAMediaTimingFunction`时，创建一个参考动画：

    ```
    let basicAnimation = CABasicAnimation(keyPath: "bounds.origin.x")
    basicAnimation.duration = 1.0
    basicAnimation.timingFunction = timingFunction
    basicAnimation.fromValue = 0.0
    basicAnimation.toValue = containerLayer.bounds.width

    referenceLayer.add(basicAnimation, forKey: "evaluatorAnimation") 
    ```

7.  将参考层设置为您要评估 的`timeOffset`任何归一化输入值（即，介于`0.0`和之间）：`1.0`

    ```
    referenceLayer.timeOffset = 0.3    // 30% into the animation 
    ```

8.  询问参考层的表示层，并获取其当前边界原点 x 值：

    ```
    if let presentationLayer = referenceLayer.presentation() as CALayer? {
        let evaluatedValue = presentationLayer.bounds.origin.x / containerLayer.bounds.width
    } 
    ```

基本上，您使用 Core Animation 为不可见层运行动画。但是图层`speed`是`0.0`，所以它根本不会进行动画。使用`timeOffset`，我们可以手动调整动画的当前位置，然后获取其表示层的 x 位置。这表示由动画驱动的该属性的当前感知值。

这有点不合常规，但并没有什么骇人听闻的地方。它尽可能忠实地表示 a 的输出值，`CAMediaTimingFunction`因为 Core Animation 实际上正在使用它。

唯一需要注意的是表示层是屏幕上显示的值的**近似值**。Core Animation 不保证它们的准确性，但在我使用 Core Animation 的这些年里，我从未见过它不准确。不过，如果您的应用程序需要绝对准确度，那么这种技术可能不是最好的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-11T02:09:01.783

**注意**：我不是 CoreAnimation 方面的专家。这只是我阅读您链接的文档的理解。

苹果在这里混合了坐标系，这造成了一些混乱。

`x(t)`在示例图中，表示沿某个路径的标量级数，而不是物理坐标。

CAMediaTimingFunction 中使用的控制点用于描述此进程，而不是几何点。更令人困惑`x`的是，控制点实际上映射到`t`绘图上，而`y`控制点实际上映射到`x(t)`绘图上。

以该图`kCAMediaTimingFunctionEaseInEaseOut`为例，该图将大致由控制点 (0,0)、(0.5,0)、(0.5,1)、(1,1) 来描述。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-15T21:36:59.590

最好的提示可能是WebKit 源代码中的[UnitBezier.h](http://opensource.apple.com/source/WebCore/WebCore-955.66/platform/graphics/UnitBezier.h)。事实上，我猜 Apple 在 Core Animation 中使用了相同的代码。

更冗长，他们使用计算参数`t`（与时间无关）给定一个`x`实际包含时间值的值。然后他们使用[Newton-Raphson 方法](http://en.wikipedia.org/wiki/Newton's_method)（[附加示例说明](http://www.shodor.org/unchem/math/newton/index.html)）。由于它可能会失败，因此他们反复使用二分法（“分而治之”）。`solveCurveX()`在方法中看到这个。

获得参数后`t`（鉴于三次贝塞尔曲线是参数化定义的，这是必要的），他们只需使用它来计算`y`. `solve()`在方法中看到这个。

顺便说一句，卡布奇诺的忠实粉丝，仍然希望发布 Atlas :-)

* * *

2020 年 1 月更新：我在 2012 年实现核心动画 API 时就这样做了。[随意参考它。](https://github.com/gnustep/libs-quartzcore/blob/16950e2f8f0b55cb97b6916e724adf093103bc92/Source/CAMediaTimingFunction.m#L169)

# bash - Bash：如何将数字转换为月份字符串？

> ID：10098616
> 
> 赞同：10
> 
> 时间：2012-04-11T01:12:43.170
> 
> 标签：bash

例如，我想将 4 映射到“Apr”（月份名称的 3 个字符缩写）

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-04-11T01:14:38.560

**尝试这个 ：**

```
MONTHS=(Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec)

echo ${MONTHS[3]} 
```

*或根据@potong 的建议（在月份编号和索引之间建立 1-1 对应关系）*

```
MONTHS=(ZERO Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec)

echo ${MONTHS[4]} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-04-11T01:15:10.990

```
#! /bin/bash
case $1 in 
  [1-9]|1[0-2])     date -d "$1/01" +%b ;;
  *)            ;  exit 1
esac 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-04-11T17:28:09.063

可以像这样获得区域敏感的结果；把数字放在日期的月份位置，作为日期传递到日期，并选择任意的年和日（远离50年代和遥远的未来，避免天数远大于20）。不一定是实际年份：

```
i=10; date -d 2012/${i}/01 +%b 
```

在这里，使用 locale de_DE，我得到结果：

```
Okt 
```

（我没有选择四月，因为日期默认为当前月份，所以使用格式错误的 -d -date，即使 i=10，您也会得到四月。我知道，因为我经历过。此外：April 的德语名称是 April，所以它不能很好地作为更详细的示例，下面将要介绍：)

```
i=10; LC_ALL=C date -d 2012/${i}/01 +%b 
```

这揭示了国际标准风格的月份。

该解决方案的优势在于，它将在革命中幸存下来，这些革命将月份重命名为 Brumaire、Obamer 或国际化尝试（德语中的 Mär、Mai、Okt、Dez，即）。

# python - Python中具有多个属性的漂亮汤查询

> ID：10098618
> 
> 赞同：1
> 
> 时间：2012-04-11T01:13:13.950
> 
> 标签：python, beautifulsoup

我正在尝试查找 HTML 的这些部分，但仅查找某个月份 (04) 中的部分，以链接结尾进行区分。

```
<td class="">
    <div class="dayContainer">
        <a href="/parks/magic-kingdom/calendardayview/?asmbly_day=20120402"> 
            <p class="day"> 2</p> 
            <p class="moreLink">
                Park Hours
                <br />
                8:00 AM - 1:00 AM
                <br /><br/>
                Extra Magic Hours
                <br />
                7:00 AM - 8:00 AM
                <br /><br/>
            </p> 
        </a> 
    </div>
</td> 
```

我可以使用 找到所有日期`findAll('div', attrs={'class':'dayContainer'})`，但这给了我网站内的所有日期。我尝试按照[此](https://stackoverflow.com/questions/706443/complex-beautiful-soup-query)示例进行操作，但我尝试的所有内容都给我留下了空白结果。这是我现在要找到的部分：

```
days = soup.findAll(lambda date: date.name == 'a' and date.text[-4:-2] == '04' and date.findParent('div', attrs={'class':'dayContainer'}))
print days 
```

关于我要去哪里错的任何想法？谢谢！如果有人需要，这里是[网站。](http://disneyworld.disney.go.com/parks/magic-kingdom/calendar/)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-11T01:48:19.490

查看您发布的站点链接后，我发现每个月的日历实际上包含在名为“month_name2012”的 div 中。

所以对于四月，你可以这样做：

```
april_c = soup.find('div', attrs={'id':'april2012'})
parking_apr = april_c.findAll('div', 'dayContainer')
for item in parking_apr:
    print item.text 
```

这会给你：

> 1停车时间8:00 AM - 12:00 AMExtra Magic Hours7:00 AM - 8:00 AMExtra Magic Hours12:00 AM - 3:00 AM
> 
> 2公园营业时间8:00 AM - 1:00 AMExtra Magic Hours7:00 AM - 8:00 AM
> 
> 3停车时间8:00 AM - 1:00 AMExtra Magic Hours7:00 AM - 8:00 AM
> 
> 4停车时间8:00 AM - 1:00 AMExtra Magic Hours7:00 AM - 8:00 AM
> 
> 5停车时间8:00 AM - 1:00 AMExtra Magic Hours7:00 AM - 8:00 AM
> 
> 6停车时间8:00 AM - 12:00 AMExtra Magic Hours7:00 AM - 8:00 AMExtra Magic Hours12:00 AM - 3:00 AM
> 
> 7停车时间8:00 AM - 1:00 AMExtra Magic Hours7:00 AM - 8:00 AM
> 
> 8公园营业时间8:00 AM - 12:00 AMExtra Magic Hours7:00 AM - 8:00 AMExtra Magic Hours12:00 AM - 3:00 AM
> 
> ……

# java - Java System.currentTimeMillis() 方法的正确用法？

> ID：10098622
> 
> 赞同：1
> 
> 时间：2012-04-11T01:14:13.383
> 
> 标签：java, factorial, language-concepts

我正在比较在 Java 中计算迭代和递归阶乘过程的时间。我正在尝试使用该`System.currentTimeMillis`方法来比较每种算法计算所需的时间，但我似乎无法计算出差异。我不确定使用此方法的正确方法是什么，但这里的任何事件都是我试图在我的代码中实现的：

```
// ... more code above

System.out.print("Please enter an integer: ");
int integer = readInt();
System.out.println();

// demonstrate recursive factorial and calculate
// how long it took to complete the algorithm
long time1 = System.currentTimeMillis();
int fact1 = factRecursive(integer);
long time2 = System.currentTimeMillis();
System.out.format("Result of recursive factorial %s is %d\n", integer, fact1);
System.out.format("Algorithm took %d milliseconds\n\n", (time2 - time1));

// ... more code below 
```

这是输出：

```
Please enter an integer: 25

Result of recursive factorial 25 is 2076180480
Algorithm took 0 milliseconds

Result of iterative factorial 25 is 2076180480
Algorithm took 0 milliseconds 
```

显然我在这里做错了，因为计算这两种情况的阶乘的预期时间不应该为零。

编辑：如果有人感兴趣，这是我的阶乘解决方案（不是特别独特，但无论如何它们都在这里）：

```
// factRecursive uses a recursive algorithm for 
// caluclating factorials.
public static long factRecursive(long n)
{
    return n = (n == 1)? 1 : n * factRecursive(n - 1);
}

// factIterative uses an iterative algorithm for
// calculating factorials.
public static long factIterative(long n)
{
    long product = 1;

    if(n == 1) return n;

    for(int i = 1; i <= n; ++i)
        product *= i;

    return product;
} 
```

并且是一些输出。令人惊讶的是，递归版本的效果很好。还没到39点左右！迭代版本开始表现得明显更好。

```
Please enter an integer: 39

Result of recursive factorial 39 is 2304077777655037952
Algorithm took 5828 nanoseconds

Result of iterative factorial 39 is 2304077777655037952
Algorithm took 5504 nanoseconds 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T01:19:53.227

的分辨率`System.currentTimeMillis()`可能会有所不同，具体取决于您的系统；看来您的算法太快了，无法使用此计时器进行测量。

改为使用[`System.nanoTime()`](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/System.html#nanoTime%28%29)。它的准确性也取决于系统，但至少它能够进行高分辨率时间测量。

即时编译会对性能产生很大影响，但大多数虚拟机需要在重新编译之前多次调用某个方法。这使得很难从这种微基准中获得准确的结果。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-11T01:18:30.073

一个编写良好的阶乘函数在 n = 25 时执行得非常快，所以让它在大约 0 毫秒内运行并不令人惊讶。你有三个选择：

1.  使用更大的 n。这将导致阶乘函数花费更长的时间，并为您提供一些要测量的东西。
2.  [使用System.nanoTime](http://docs.oracle.com/javase/6/docs/api/java/lang/System.html#nanoTime%28%29)以近似纳秒而不是毫秒来测量时间。
3.  我建议同时执行 1 和 2。

正如其他回答者指出的那样，您确实是从 start 中减去 end ，这是倒退的。显然，你也应该解决这个问题。但这种变化只影响结果的*符号*，而不影响绝对值。

* * *

**编辑**：只是为了看看找到 25 的阶乘有多快，我写了这个 Python 实现

```
>>> def fact(n):
...     def _fact(n, acc):
...             if n == 1:
...                     return acc
...             return _fact(n - 1, n * acc)
...     if n < 0:
...             return 0 # Or raise an exception
...     if n < 2:
...             return 1
...     return _fact(n, 1)
... 
>>> fact(25)
15511210043330985984000000L
>>> import timeit
>>> t = timeit.Timer("fact(25)", "from __main__ import fact")
>>> print t.timeit()
6.2074379921 
```

尽管 Python 是一种没有尾调用优化的解释型动态类型语言，但带有累加器的简单递归解决方案可以`fact(25)`在我的机器上在 6.2 秒内找到一百万次。所以平均执行时间是 6.2 微秒。没有机会以毫秒时钟精度在一次运行中测量迭代和递归解决方案之间的实质性差异。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-11T01:16:43.557

你需要做（完成时间 - 开始时间），你有它倒退。

试试这个：

```
System.out.format("Algorithm took %d milliseconds\n\n", (time2 - time1)); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-11T01:18:25.940

很常见的错误。您应该从 time2 中减去 time1。

如果您明智地命名变量，这将有所帮助 - 例如`startTime`，`endTime`您会知道或至少发现您必须这样`endTime - startTime`做`endTime`>`startTime`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-11T01:20:12.460

看起来您的快速递归毕竟可能没有进行如此繁重的处理。

请`System.nanoTime()`改用。它返回纳秒

[http://docs.oracle.com/javase/7/docs/api/java/lang/System.html](http://docs.oracle.com/javase/7/docs/api/java/lang/System.html)

nanoTime() 返回正在运行的 Java 虚拟机的高分辨率时间源的当前值，以纳秒为单位。

* * *

另一种测试方法是迭代你的阶乘，比如 1000 次。然后将时间差除以 1000.00（双倍）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-11T06:02:50.427

要获得有意义的定时结果，您需要重复并忽略至少前 10,000 次调用方法（因此代码已编译），并且您需要再运行 2-10 秒（重复）。

# math - 理解朴素贝叶斯的概率计算

> ID：10098623
> 
> 赞同：2
> 
> 时间：2012-04-11T01:14:18.967
> 
> 标签：math, statistics, document-classification

使用朴素贝叶斯文本分类技术，您通常计算训练数据中的单词并计算 p(label | document)，其中文档是一串单词？

对于文本分类，为什么我们不能直接计算 P(label | word1, word2, etc) 来预测标签？（即为什么我们需要使用贝叶斯定理）

鉴于文件，我们有完整的数据......似乎应该能够直接计算 p(label and w1 and w2 ) / p(w1 and w2) ？

我意识到训练集不是基本事实。用贝叶斯定理计算能解决这个问题吗？如果是这样，怎么做？你能说明数学是如何工作的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T12:10:05.647

贝叶斯使用来自您的训练集和数据的先验信息来估计后验概率。

我认为“我们有完整的数据”将是一个常客的观点。

贝叶斯是对频率论方法的改进，原因有很多，但其中之一是它允许您使用过去的信息改进您的后验。

我建议阅读[Doing Bayesian Data Analysis - A Tutorial Using R and BUGS](https://rads.stackoverflow.com/amzn/click/com/0123814855)。这是一本关于一个非常重要的话题的好书。贝叶斯赢得了这场战争——最好彻底学习它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T19:41:29.587

“朴素贝叶斯”这个名字有点误导，因为你通过贝叶斯定理计算值并不是那么了不起。正如您所指出的，贝叶斯定理源自条件概率的标准定义，因此我们可以证明通过贝叶斯定理给出的答案与正常计算的答案相同。

洞察力（或错误的假设，取决于您的观点）是词频通常与文档标签无关。因为这`P(w_1, ..., w_n | label)`很容易计算：`P(w_1, ..., w_n | label) = P(w_1 | label) * ... * P(w_n | label)`。

但是我们当然不在乎`P(w_1, ..., w_n | label)`，我们想要`P(label | w_1, ..., w_n)`。所以我们需要使用贝叶斯定理，因此得名。

通过这样做，我们可以嵌入关于单词独立性的知识，以做出更好的预测。如果我们只是进行原始计算，就无法编码我们关于独立性的知识。

（这对于贝叶斯网络来说是正确的，而不仅仅是朴素贝叶斯——好处是你可以编码你关于变量之间关系的先验知识。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-17T13:18:25.467

研究了一下，问了几个人，想了想。你不计算的原因：

p(label | W1 = 1, W2 = 2 etc) 直接

是因为它在计算上会很困难，因为您需要保留二元组、三元组等的索引。即使这样，您也需要一种聪明的方法来处理索引中出现零次的单词。

使用贝叶斯是解决问题的好方法，但您确实需要做出条件独立假设。

您还可以将公式转换为另一种形式，其中单词仍位于右侧。下面是使用贝叶斯公式从分子开始的数学：

p(w1 | c) * p (w2 | c) ... * p(c)

这可以分解为

p(c | w1) * p(w1) / p(c) * p(c | w2) * p(w2) / p(c) ... p(c | Wn) * p(Wn) / p( c) * p(c)

这简化为

p(c | w1) ... p(c | Wn)*p(c)^-(n-1)*p(w1)....p(Wn)

# php - 无法将 php 数据返回到 jQuery ajax 调用

> ID：10098625
> 
> 赞同：1
> 
> 时间：2012-04-11T01:14:33.757
> 
> 标签：php, ajax, jquery

似乎这种类型的问题已经被问过并回答了很多次，但我似乎无法让它发挥作用，即使经过数小时的尝试不同的事情。

这是我的ajax：

```
$.ajax({
type: 'POST',
url: 'scripts/manageHomePage.php',
//datatype: 'json',
data: dataString,
cache: false,
success: function(response) {
    //$.parseJSON(response);

    alert('response: ' + response);
    //alert('Got a successful return: ' + response.result);
    //window.location.href="documents/" + response.result;
},
error: function(response) {
    alert ('There was an error creating the archive: ' + response);
}
}); 
```

如您所见，我也一直在尝试使用 json 来执行此操作。这是返回数据的php代码：

```
if ($zipArchive) {
$log->lwrite('passing to ajax function: ' . $archiveName);
//$return['error'] = true;
//$return['result'] = $archiveName;
return $archiveName;
} else {
$log->lwrite('Error creating zip file - not passed to form');
//$return['error'] = false;
//$return['result'] = 'There was an error creating the zip file';
return 'error';
} 
```

再次，对 json 的更多尝试。无论如何，php 脚本返回的变量 $archiveName 是正确的。我在 $.ajax 的成功参数中的 js 警报显示“响应：”

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T02:02:31.050

您需要`echo`支持该功能的响应，而不是`return`它。

# wpf - ListView GridView Handle ColumnsReorder

> ID：10098627
> 
> 赞同：-1
> 
> 时间：2012-04-11T01:14:39.800
> 
> 标签：wpf, gridview

如何处理/保持列重新排序？不需要改变它。需要将其持久化，以便用户再次打开 GridView 时可以按上次定义的顺序显示列。

```
 <ListView>
        <ListView.View>
            <GridView AllowsColumnReorder="True" > 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T02:34:55.407

不幸的是，您不会找到 StoreColumnOrder="True" 设置。您必须自己编写代码。并且要持久化，您必须将订单存储在磁盘上的某个位置，例如设置文件。

创建一个继承自 GridView 的新对象（或者您也可以创建一个 UserControl），该对象将一个函数添加到 onloaded 事件，并将一个函数添加到 onclose 事件。onloaded 函数将查找设置文件，如果存在，则重新排序列。如果发生重新排序，onclose 函数会创建设置文件。

# networking - 混杂模式下的网络嗅探

> ID：10098628
> 
> 赞同：2
> 
> 时间：2012-04-11T01:14:39.467
> 
> 标签：networking

考虑有两个 wi-fk 网络 A 和 B 使用相同的通道并且它们彼此重叠。我有一个节点（带有一个 NIC）位于重叠区域。现在这应该能够看到两个网络流量（如果网络不安全）不一定同时。

我的问题是，如果网络接口处于混杂模式，节点能否同时嗅探来自两个网络的流量？即使节点在任何时候都将连接到其中一个网络（因为只有一个 NIC），因为两个网络都在同一通道中运行并且 NIC 处于混杂模式，它是否可以嗅探属于这两个网络的数据包？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T01:22:25.750

使用[Aircrack-ng](http://www.aircrack-ng.org/)（airmon 应用程序），您可以很好地嗅探两个 wi-fi 网络，无论它们是否在同一个频道中。

ps：我认为airmon一次嗅探一个频道，但它同时进行的速度非常快。

# iis - 使用 web.config 文件在 IIS 中看似简单的重定向

> ID：10098632
> 
> 赞同：4
> 
> 时间：2012-04-11T01:15:38.067
> 
> 标签：iis, redirect, url-rewriting, web-config

我已经重组了一个托管在 Windows 服务器上的 WordPress 网站，因此我尝试使用 web.config 文件进行重定向。我已经从示例中尝试了几十种变体，但我无法让它发挥作用。新的 url 从此改变：

www.mysite.com/wp/whatever-else

对此：

www.mysite.com/whatever-else

我试过的一些例子包括：

```
<rewrite>
<rules>
    <rule name="WP Redirect">
        <match url="^(.*)/wp/(.*)" />
        <action type="Rewrite" url="{R:1}/{R:2}" />
    </rule>
</rules>
</rewrite> 
```

* * *

```
<rewrite>
<rules>
    <rule name="WP Redirect">
    <match url="^(.*)/?wp(.*)" />
    <action type="Rewrite" url="http://www.mysite.com/{R:1}" />
    </rule>
</rules>
</rewrite> 
```

* * *

```
<rewrite>
<rules>
    <rule name=""WP Redirect" stopProcessing="true">
    <match url="^com/wp/?" />
    <conditions logicalGrouping="MatchAny" trackAllCaptures="true">
    </conditions>
    <action type="Redirect" url="{R:1}/" />
    </rule>
</rules>
</rewrite> 
```

有什么建议么？我难住了。谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-11T01:22:14.227

试试这个：

```
<rewrite>
  <rules>
    <rule name="WP Redirect" stopProcessing="true">
      <match url="^wp/(.*)$" ignoreCase="false" />
      <action type="Redirect" redirectType="Permanent" url="http://www.mysite.com/{R:1}" />
    </rule>
  </rules>
</rewrite> 
```

# wpf - 如何在 Visual Studio 2010 中查找和删除所有未使用的资源？

> ID：10098633
> 
> 赞同：2
> 
> 时间：2012-04-11T01:16:09.360
> 
> 标签：wpf, xaml, resources

有没有办法找到所有未使用的资源（那些设置了 x:Key 属性的资源）？资源是指在 ResourceDictionary 中创建的 WPF/XAML 对象。这是 WPF/XAML 特定问题，与 .resx 文件或其他类型的资源（如图像或二进制文件）无关。

我已经在一个项目上工作了一段时间，并且正在为相同的控件测试一些不同的样式，但在此期间一切都搞混了，所以我想删除所有不再使用的资源。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T01:32:46.283

您可以在解决方案中对每个命名资源进行文件搜索（使用[Find in Files ）。](http://msdn.microsoft.com/en-us/library/dechx2tz%28v=vs.100%29.aspx)不是很优雅，但它会完成这项工作。

有关查找应用程序中所有资源的帮助，请参阅[此问题。](https://stackoverflow.com/questions/1765920/searching-and-listing-wpf-resource-dictionaries-in-a-folder)

# android - 位置 vs GeoPoint vs 1E6 vs 充电

> ID：10098639
> 
> 赞同：3
> 
> 时间：2012-04-11T01:16:51.880
> 
> 标签：android

我正在编写一个基于位置的应用程序，并希望对合理的 API 使用有所了解。

到目前为止，我所理解的是使用 int 更有效。我将需要存储它们的负载并进行大量距离计算。

我的应用程序使用实现 LocationListener 的服务，并且我将经度和纬度作为 int 值（微度）存储在 SQL db（通过 ormlite）中，因此计算得出 ::

```
public static int degreesToMicroDegrees(double degrees){
    return (int)(degrees * 1E6);
} 
```

有时我需要知道我何时返回到特定的“位置”，因此我从数据库中取回 int 值以与最新的位置更新进行比较。

问题是，在我的最新位置更新中，比较 int 值（我曾经所在的位置）和 double 值（我现在所在的位置）之间的“位置”的最佳方法是什么？

我四处寻找一些数学来完成距离计算并找到了这个::

```
public static double distanceBetween(double lat1, double lng1, double lat2, double lng2) {

          double earthRadius = 3958.75; 
          double dLat = Math.toRadians(lat2-lat1); 
          double dLng = Math.toRadians(lng2-lng1); 
          double a = Math.sin(dLat/2) * Math.sin(dLat/2) + 
                   Math.cos(Math.toRadians(lat1)) * Math.cos(Math.toRadians(lat2)) * 
                   Math.sin(dLng/2) * Math.sin(dLng/2); 
          double c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); 
          double dist = earthRadius * c; 

          return dist; 
        } 
```

我试过像这样传递我的 int 值 :: ((double)myIntValue) / 1E6F 返回的距离值让我感到困惑。如果我走 100 米，我的应用程序会明智地告诉我，我使用 Location.distanceTo(myLastLocation) 已经走了大约 100 米。但是，如果我对存储的 int 值使用上述方法，我会得到零值。

如果有人可以解释 E6 格式，那就太好了。

1E6 和 1000000 一样吗？

另外我可以看到有这个 GeoPoint 类。我很犹豫是否要使用它，因为我不清楚在 GeoPoints 上进行大量计算是否会由 Google 收费。关于使用 GoogleMaps API 的收费似乎存在一些噪音，我无法找到关于收费如何工作的明确解释。

所有的智慧都感激地接受。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T04:00:46.007

只是我的2美分：

1E6 与 1,000,000 相同。

要将您的 int 纬度/经度转换为双精度，您可以执行以下操作：

```
(double)theLat/1E6; 
```

我还建议您使用类的[Location.distanceBetween](http://developer.android.com/reference/android/location/Location.html#distanceBetween%28double,%20double,%20double,%20double,%20float%5B%5D%29)方法`Location`。

* * *

GeoPoint 不会为您的申请产生任何费用。我用它所有的时间。:-)

# actionscript-3 - Flex 错误 #1009：无法访问空对象引用的属性或方法

> ID：10098642
> 
> 赞同：0
> 
> 时间：2012-04-11T01:17:20.280
> 
> 标签：actionscript-3, apache-flex

我试图在我的 init() 方法中使用一个按钮。

```
<?xml version="1.0" encoding="utf-8"?>
<s:View xmlns:fx="http://ns.adobe.com/mxml/2009" 
        xmlns:s="library://ns.adobe.com/flex/spark" title="Test"
        creationComplete="init()"> 
```

现在，当我尝试用我的按钮做某事时，我得到了提到的错误。我假设它可能还没有加载？

```
function init():void{
     myButton.thisorthat == makes the error.
} 
```

****编辑***** 该按钮是在 MXML btw 中创建的，这并不重要，但这适用于 flex 移动应用程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T01:32:57.313

其实这很*重要*。关于 NavigatorContent 的一件事（假设您的孩子是这些类型容器之一的子集）与他们的 halo 对应物一起要记住的是，他们都有一个内容创建策略设置为 deferred - 这意味着它创建了视图/视图堆栈的最父层，但在用户实际导航到该特定孩子之前，它不是孩子。一种*作弊*是将策略设置为“ALL”，但更好的方法是实际侦听**FlexEvent.CONTENT_CREATION_COMPLETE**（这是从导航容器的子级广播的）。

例如：

```
<halo:ViewStack id="setupStack" width="100%" height="100%">
    <api:FileSelector width="100%" height="100%" owner="{this}" 
                      enumerationMode="{FileSystemEnumerationMode.DIRECTORIES_ONLY}"
                      hint="{networkDbAccessHint}" />
    <!- this is valid, but not it's children until contentCreateComplete is fired -->
    <api:DataImport width="100%" height="100%" owner="{this}" />
</halo:ViewStack> 
```

'FileSelector' 和 'DataImport' 都广播事件（扩展 s:NavigatorContent）。

# javascript - 如何在不同的文件中执行javascript？

> ID：10098643
> 
> 赞同：3
> 
> 时间：2012-04-11T01:17:40.193
> 
> 标签：javascript, html, file, onclick

我的 html 页面中有多个 javascript 函数。其中一个，迄今为止最大的，是在单击按钮时执行的。如果我将该函数移动到一个单独的 .js 文件中，让 onclick 运行该文件的语法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-11T01:21:39.430

如果函数的名称仍然相同，那么除了在任何代码使用它之前将脚本包含在 html 中的某个位置之外，您无需执行任何操作，如下所示：

```
<script src="/yourscript.js" type="text/javascript"></script> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-11T01:21:57.913

您的 javascript 函数可以位于任意数量的文件中。您只需在标签内添加对 .js 文件的引用，如下所示：

```
<script type="text/javascript" src="path/to/scripts/filename.js"></script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T01:21:21.630

**你不必改变任何东西。**

只需将您的 javascript 文件包含在您的`HEAD`部分中，其余部分可能保持不变。:-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T01:21:56.120

您`onclick`不运行该文件。它运行该文件中包含的函数。您无需更改`onclick`语法即可实现这一目标。

# c# - 我怎么知道服务器使用套接字关闭了 UDP

> ID：10098644
> 
> 赞同：2
> 
> 时间：2012-04-11T01:17:43.300
> 
> 标签：c#, sockets, connection, udp

我知道 UDP 不是面向连接的协议，但 UDP 是我必须做的事情的要求。

当我从客户端应用程序向服务器应用程序发送一堆数据包时，是否知道服务器应用程序是否已关闭（例如，用户终止了进程）？

一种方法是定期 ping 服务器（在与发送/接收数据流的线程不同的线程中）并等待响应。如果服务器不确认 ping，它可能已关闭（虽然不能保证，毕竟这是 UDP）。

但是有更好/更简单的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T01:44:15.157

没有可靠的方法。我实现的使用 UDP 作为传输的协议使用请求/响应模型。例如，[SIP](http://en.wikipedia.org/wiki/Session_Initiation_Protocol)就是这样做的（当然，一般来说）：

假设您有 2 个对等点 - A 和 B。如果对等点 A 向对等点 B 发送请求，对等点 B 应始终发回响应。如果对等体 A 在一定时间内没有收到响应，它会重新发送之前的消息。对等点 A 将继续重新发送消息，直到它收到对等点 B 的响应或直到指定的到期时间（这取决于您）。如果该时间已过期，则假设对等方 B 已关闭。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T01:21:28.080

当服务器进程未运行时，您的服务器操作系统*可能*会将诸如“目标端口不可达”之类的 ICMP 数据包发送回发送方。使用 tcpdump 或其他数据包嗅探器检查。如果是这样，那么您的客户可能能够查明是否收到了这样的响应。

ping（ICMP 回显）服务器不会很有用，因为无论您的服务器进程是否正在运行，操作系统都会响应 ping。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-11T01:25:57.357

嗯，你是对的，UDP 是一个不可靠的协议。没有握手，没有确认，没有可靠性。

您最好的选择是在一个新线程中执行 ping，但以 UDP 方式（相同的端点实现）执行此操作，但这实际上并不比让目的地发送一个“收到的”UDP 数据包更可靠。你不会做得比这更好，因为它不是一个有状态的开放连接，你要么发送一个数据包并假设它到达，要么你收到数据。也无法保证接收顺序，因此您必须假设 ping 成功并且没有超过您的实际有效负载，或者您没有从不同的请求中获得成功回复。

# php - 使用 php 或 mysql 到日期的字符串

> ID：10098645
> 
> 赞同：0
> 
> 时间：2012-04-11T01:18:05.770
> 
> 标签：php, javascript, sql

谁能帮我如何将字符串转换为日期

我有 3 个下拉菜单（年、月、日），我得到的日期值为 2012 年 1 月 12 日。

我怎样才能像 2012-01-12(yyyy-mm-dd) 那样转换它。

$dob = $year.'-'.$month.'-'.$day;

我在查询本身中使用了 str_to_date('$dob','%Y-%M-%e') 但它停止执行查询。

这是查询

```
 $sql = "insert into issio_asc_workers (lname_fname_dob, asc_id, asc_lastname, asc_firstname, asc_middlename, asc_dob, asc_phone_mobile, asc_phone_work, asc_ssn,
              asc_email, asc_phone_preferred, asc_status, asc_emp_yesno, asc_emp_status, asc_user_type, asc_npi, asc_credentials, asc_committee, asc_speciality, 
              asc_group, asc_startdate)values ('$lfd', '$ascid', '$lname', '$fname', '$mname', 
             'str_to_date('$dob','%Y-%M-%e')', '$phCell', '$phOffice', '$ssn', '$email', '$preffered', '$asc_status', '$empType', '$asc_emp_status', '$asc_user_type', '$npi', 
             '$credential', '$commitee ', '$speciality', '$group', 'str_to_date('$sdate','%Y-%M-%e')')"; 
```

Thnaks 提前....，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T01:23:02.883

```
$date = DateTime::createFromFormat('Y-m-d\TH:i:s', '2010-06-03T14:29:00'); 
```

试试这个...用您从表单中收到的信息填写日期，然后将变量放入 MySQL 插入查询中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T01:21:59.357

在将变量插入 sql 查询之前对它们进行编组是一个好主意。这对程序运行来说并不困难，但会让你作为程序员的生活更轻松：

```
$dob_asDate = str_to_date('$dob','%Y-%M-%e');

$sql = "insert into issio_asc_workers (lname_fname_dob, asc_id, asc_lastname, asc_firstname, asc_middlename, asc_dob, asc_phone_mobile, asc_phone_work, asc_ssn,
              asc_email, asc_phone_preferred, asc_status, asc_emp_yesno, asc_emp_status, asc_user_type, asc_npi, asc_credentials, asc_committee, asc_speciality, 
              asc_group, asc_startdate)values ('$lfd', '$ascid', '$lname', '$fname', '$mname', 
             '$dob_asDate', '$phCell', '$phOffice', '$ssn', '$email', '$preffered', '$asc_status', '$empType', '$asc_emp_status', '$asc_user_type', '$npi', 
             '$credential', '$commitee ', '$speciality', '$group', 'str_to_date('$sdate','%Y-%M-%e')')"; 
```

通过这种方式，您可以回显`$dob_asDate`并确保它是您想要的。

# sharepoint - Chrome 中的 Canvas 和 SharePoint 下拉菜单冲突

> ID：10098647
> 
> 赞同：1
> 
> 时间：2012-04-11T01:18:15.227
> 
> 标签：sharepoint, google-chrome, canvas

我在 SharePoint 中使用画布时遇到问题。在 Chrome 中，当我打开一个新选项卡或一个新的 Chrome 实例并且当前页面包含一个或多个画布时，SharePoint 的下拉菜单不起作用。这是一个简单的演示：
![在 Chrome 中](../Images/a5a6db812abfcebbd0c880f0362e2d37.png)

当我将鼠标放在“新闻”上时，它没有出现。
但是当我刷新页面时就可以了。
这是 Firefox 中的预期结果：
![在火狐中](../Images/b5b7691af6b6df5ca60454066325c4e4.png)

这是绘制矩形的演示代码：

```
function drawRectangle(){
    var canvas = document.getElementById("myCanvas");
        if(canvas.getContext){
      var ctx = canvas.getContext("2d");
      ctx.fillRect(0,0,200,200);
  }
} 
```

而且我还发现如果我删除“ctx.fillRect(0,0,200,200)”，只留下“var ctx = canvas.getContext(“2d”);”，问题依旧存在。你会帮我吗？谢谢！

# javascript - 当您从锚标记开始时，JQuery-Mobile 滑动不起作用

> ID：10098656
> 
> 赞同：7
> 
> 时间：2012-04-11T01:19:34.233
> 
> 标签：javascript, jquery, html, jquery-mobile

我的 swipeleft/swiperight 在我的应用程序中运行良好，但是当用户在锚标记上执行 mousedown 时，不会触发滑动操作。

即使用户在锚标记上按下鼠标，我如何才能使滑动工作？

编辑：看起来这只是计算机浏览器中的一个问题 - 平板电脑工作正常。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-11T19:57:35.283

您可以在桌面上的任何现代浏览器中使用普通的左键滑动。

确保阻止对 div 上的 dragstart 事件执行默认操作。

```
$("div").bind('dragstart', function(event) {event.preventDefault(); }); 
```

我这里有一个工作副本...

[http://jsfiddle.net/38nXe/](http://jsfiddle.net/38nXe/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T19:44:51.167

您可以使用鼠标右键在桌面浏览器上滑动。它不是很优雅，因为它还打开了上下文菜单。但它无处不在。亚历克斯

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-10T12:16:55.820

至于我，它是由“excludedElements”引起的，它过滤所有按钮、选择、文本区域、输入和锚点。

为了使其工作，例如添加带有空数组的附加参数。

$("#test").swipe({ excludeElements:[] });

在此处查看 touchSwipe 插件文档 在此处[输入链接描述](http://labs.rampinteractive.co.uk/touchSwipe/demos/Excluded_children.html)

# ruby-on-rails - 在 Rails 3.x 应用程序中从 Engine 重新打开模型和控制器

> ID：10098658
> 
> 赞同：3
> 
> 时间：2012-04-11T01:19:50.087
> 
> 标签：ruby-on-rails, rails-engines

我想通过在 Rails 应用程序中重新打开它们来扩展 Engine 中的模型和控制器。问题是应用程序启动时没有加载它们。我知道有一些解决方案，比如[Rails 引擎扩展功能](https://stackoverflow.com/questions/2964050/rails-engines-extending-functionality/2990539)以及[如何在主应用程序中覆盖 rails 3 引擎模型和控制器？](https://stackoverflow.com/questions/4009553/how-to-override-rails-3-engine-models-and-controllers-in-the-main-application)，但我怀疑这是由于导轨的加载顺序，应该有一些巧妙的解决方案。

然后我遇到了这个解决方案：

```
config.railties_order = [Blog::Engine, :main_app, :all] 
```

但是，Engine 中的模型和控制器已加载，而不是 rails 中的模型和控制器。只是想知道以前是否有人做过这项工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T12:12:21.650

我的解决方案：

```
# === in engine
class EngineNameSpace::Blog
  # logic goes here
end

class Blog < EngineNameSpace::Blog
  # no codes should go here
end

# === in app
# If I need to extend the Blog class, I will code as below instead of reopenning the class
class Blog < EngineNameSpace::Blog
  # do something
end 
```

解释：

如果引擎类与父应用程序中的文件名/路径相同，Rails 会阻止引擎类加载。请参阅[http://www.cowboycoded.com/2011/02/06/making-the-case-for-rails -3-引擎/](http://www.cowboycoded.com/2011/02/06/making-the-case-for-rails-3-engines/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T23:11:12.270

您可以通过从 Rails 引擎继承主 Rails 应用程序控制器来重新打开控制器类。这不需要`config.railties_order`为了让控制器工作，

```
#/app/controllers/answer_sheets_controller.rb
require YourCustomEngine::Engine.root.join('app', 'controllers', 'your_custom_engine', 'answer_sheets_controller')

class AnswerSheetsController < YourCustomEngine::AnswerSheetsController 
```

由于某种原因，这种策略不适用于模型。

# ruby-on-rails - 使用 mechanize 解析 xpaths 和 html

> ID：10098661
> 
> 赞同：1
> 
> 时间：2012-04-11T01:20:10.070
> 
> 标签：ruby-on-rails, parsing, mechanize

我使用机械化来解析`http://www.hammacher.com/Category/Default.aspx?uq=Gifts-Under-30&all=True`

我可以使用什么 xpath 来访问该页面上的每个 href，以便可以传递每个产​​品页面？

这就是我现在正在尝试的，但没有获得完整的网址：

```
page = agent.get('http://www.hammacher.com/Category/Default.aspx?uq=Gifts-Under-30&all=True')    
page.parser.xpath('//*[contains(concat( " ", @class, " " ), concat( " ", "product_list_sub", " " ))]//a')[5].attributes['href'].to_s 
```

另外，当使用 Mechanize 在同一语句中解析两个不同的 xpath 选择器时，是否有可能？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T01:50:47.587

试试这个

```
page.links_with(:href => /Product\/Default.aspx\?sku/) 
```

# python - 模板内的 Django 渲染模板

> ID：10098668
> 
> 赞同：10
> 
> 时间：2012-04-11T01:21:20.103
> 
> 标签：python, django

我想为在单个页面上多次使用的组件创建一个模板，更改很少（只需 2 或 3 个变量）。如何创建此模板并将其呈现在另一个模板中？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-11T01:36:04.583

[包括](https://docs.djangoproject.com/en/dev/ref/templates/builtins/?from=olddocs#include)怎么样？

像这样：

```
{% include "name_snippet.html" with person="Jane" greeting="Hello" %} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-11T01:26:20.710

我们通常为此[创建一个自定义包含标签](https://docs.djangoproject.com/en/dev/howto/custom-template-tags/#inclusion-tags)。

# java - Android：这么多字符后如何删除？

> ID：10098676
> 
> 赞同：0
> 
> 时间：2012-04-11T01:21:59.807
> 
> 标签：java

我需要在这么多之后删除 coma(,) 。假设有一个带有 4 个逗号的字符串“我，我，好的，今天，你好”，我想在 2 个逗号后删除重置，但只保留文本，只在前 2 个后删除逗号？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T01:48:33.790

遍历字符串，使用 StringBuilder 重建并检查逗号：

```
static String stripCommasAfterN(String s, int n)
{
    StringBuilder builder = new StringBuilder(s.length());
    int commas = 0;

    for (int i = 0; i < s.length(); i++)
    {
        char c = s.charAt(i);

        if (c == ',')
        {
            if (commas < n)
            {
                builder.append(c);
            }
            commas++;
        }
        else
        {
            builder.append(c);
        }
    }   

    return builder.toString();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T01:41:05.973

像这样的事情应该这样做。

```
public string StripCommas(string str, int allowableCommas) {
    int comma;
    int found = 0;
    comma = str.indexOf(",");
    while (comma >= 0) {
        found++;
        if (found == allowableCommas) {
            return str.substring(0, comma) + str.substring(comma + 1).replaceAll(",", "");            
        }
        comma = str.indexOf(",", comma + 1);
    }
    return str;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T01:43:44.407

有两种方法可以做，

**一种**

1.  使用 split string 将字符串拆分为字符串数组，使用`yourString.split(",")`.
2.  循环遍历字符串数组并在前 2 个元素之后添加“，”，然后附加其余元素。

**乙**

1.  使用 indexOf() 查找第二个逗号的位置
2.  此时拆分字符串。
3.  将第二个子字符串中的 "," 替换为 "" 并将其附加到第一个子字符串中。

# visual-studio - 为什么找不到我的 Visual Studio 2010 自定义工具？

> ID：10098681
> 
> 赞同：0
> 
> 时间：2012-04-11T01:22:26.873
> 
> 标签：visual-studio, customtool

我的自定义工具如下：

```
Class: FooBar.Blah.Tools.DataContextClassGenerator
Assembly: FooBar.Blah.Tools.DataContextClassGenerator
Project: FooBar.Blah.Tools.DataContextClassGenerator 
```

通过将 GeneratePkgDef 设置为 true 从项目文件中启用的 CreatePkgDef 任务会在构建输出中创建以下 pkgdef 文件。

```
[$RootKey$\Generators\{FAE04EC1-301F-11D3-BF4B-00C04F79EFBC}\DataContextClassGenerator]
@="Foo Bar DataContext Class Generator"
"CLSID"="{2155fcee-7012-400b-a6b3-5d8d0e34de6c}"
"GeneratesDesignTimeSource"=dword:00000001
"GeneratesSharedDesignTimeSource"=dword:00000000
[$RootKey$\Generators\{164B10B9-B200-11D0-8C61-00A0C91E29D5}\DataContextClassGenerator]
@="Foo Bar DataContext Class Generator"
"CLSID"="{2155fcee-7012-400b-a6b3-5d8d0e34de6c}"
"GeneratesDesignTimeSource"=dword:00000001
"GeneratesSharedDesignTimeSource"=dword:00000000
[$RootKey$\CLSID\{2155fcee-7012-400b-a6b3-5d8d0e34de6c}]
@="FooBar.Blah.Tools.DataContextClassGenerator"
"InprocServer32"="$WinDir$\SYSTEM32\MSCOREE.DLL"
"Class"="FooBar.Blah.Tools.DataContextClassGenerator"
"CodeBase"="$PackageFolder$\FooBar.Blah.Tools.DataContextClassGenerator.dll"
"ThreadingModel"="Both" 
```

当我安装 VSIX 扩展时，我会在 10.0_Config 键下看到相应的键。然而，当我将 DataContextClassGenerator 设置为自定义工具时，VS2010 抱怨找不到该工具。

我尝试为 VS2010 启用 ActivityLog 并查看它，当 VS2010 启动时找到并加载了该工具，然而，它就好像它甚至不存在一样。

我无计可施，将不胜感激。

我已将 VSIX 设置为可安装到 VS2010 的 Ultimate、Premium 和 Professional 版本。在安装过程中，它说它找到了 Ultimate 版并说它已经安装了它，即使我的机器上有 VS2010 Premier 版。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T01:29:38.740

问题是，虽然我的自定义工具类本身设置为 ComVisible(true)，但基类没有，因此 Visual Studio 没有正确加载它，因为你不能这样做。显然，整个类的层次结构必须是 ComVisible(true)。

# python - Powershell相当于Python“in”？

> ID：10098684
> 
> 赞同：5
> 
> 时间：2012-04-11T01:22:59.013
> 
> 标签：python, arrays, powershell, syntax

我最近一直在使用数组，真的很想念 Python 的“in”运算符。

例如：

```
if ("hello" in ["hello", "there", "sup"]):
    print "this prints :)" 
```

我通过创建一个“ThereExists-Object”函数来弥补它，如下所示：

```
function ThereExists-Object([System.Management.Automation.ScriptBlock] $sb)
{
    return ($input | where $sb) -as [bool]
}
New-Alias -Name ThereExists -Value ThereExists-Object 
```

例如：

```
if ($arrayOfStuff | thereexists { $_ -eq "hello" } )
{
    write-host "this prints too"
} 
```

显然我也可以为此定义另一个函数......但我想知道是否有一些我不熟悉的语法糖可以完成这项工作。

那么……有吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-11T01:32:20.220

```
$arrColors = "blue", "red", "green", "yellow", "white", "pink", "orange", "turquoise"
$arrColors -contains "black" 
False
$arrColors -contains "blue"
True 
```

来源：[http ://technet.microsoft.com/en-us/library/ee692798.aspx](http://technet.microsoft.com/en-us/library/ee692798.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-11T03:46:49.587

从 Powershell v3.0 开始，您可以使用`-in`运算符本身：

```
PS> "hello" -in "hello", "there", "sup"
True
PS> "hell" -in "hello", "there", "sup"
False 
```

# iphone - Facebook iPhone SDK 签到 Foursquare Place

> ID：10098686
> 
> 赞同：0
> 
> 时间：2012-04-11T01:23:08.247
> 
> 标签：iphone, facebook, foursquare, checkin

诚然，我没有做很多实验，但我认为有人可能会给我一个快速的答案并保存所有的实验。

我有一个使用 Foursquare 的 API 为用户查找位置的应用程序。我希望这个人能够在 Foursquare 上签到这些地方（简单），但我也想在 Facebook 上签到同一个地方，无论它是否存在（而且我似乎需要一个 PlaceID 来检查用户在？）。是否有捷径可寻？我见过几个应用程序这样做，但他们是否在做某种幕后搜索/挂钩以将 Foursquare 位置链接到 Facebook 位置？

提前致谢！如果没有人对我有一个快速的答案，我会在我最终弄清楚时发布我自己的问题的答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T04:00:35.537

您不能使用公共 API 在 Graph API 上创建地点，因此需要现有的地点 ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T15:07:50.523

我相信，您不能在 Facebook Places API 上动态创建地点，但您可以使用*广播*参数轻松将用户的foursquare签到共享到 Facebook 以签入/添加（请参阅[https://developer.foursquare.com/docs/签到/添加](https://developer.foursquare.com/docs/checkins/add)）。

虽然这不会创建旧意义上的“Facebook 签到”，但它仍然会创建一个 OpenGraph 故事并在他们的 Facebook“我去过的地方地图”上创建一个条目，因为foursquare 现在使用 OpenGraph 发送更多信息分享时的数据（请参阅[http://blog.foursquare.com/2012/03/13/foursquare-on-facebook-is-now-prettier-check-out-the-new-look-for-foursquare-check- ins-徽章和市长/](http://blog.foursquare.com/2012/03/13/foursquare-on-facebook-is-now-prettier-check-out-the-new-look-for-foursquare-check-ins-badges-and-mayorships/)）。

这样，您仍将允许用户使用foursquare 地点数据库签到，并将该签到以及您添加到其中的任何内容分享给他们的foursquare 和Facebook 朋友。

# javascript - tumblr 和 google+ 如何像拼图一样堆叠图像？

> ID：10098688
> 
> 赞同：4
> 
> 时间：2012-04-11T01:23:24.110
> 
> 标签：javascript, jquery, html, css, ajax

我正在寻找制作图片库，并且想知道如何像 Google 和 tumblr 那样堆叠图片。

我的意思是，当您查看 tumblr 的存档页面时，它们都堆叠在列中： http: [//the-overlook-hotel.tumblr.com/archive](http://the-overlook-hotel.tumblr.com/archive)

但是我希望它们也可以跨列重叠，我在 tumblr 上的一个名为 tessellate 的主题中看到了这一点：[http ://www.tumblr.com/theme/30524](http://www.tumblr.com/theme/30524)

这是它的一个例子。继续滚动以查看图像或嵌入视频将跨越 2 列的部分：http: [//idotessellate.tumblr.com/](http://idotessellate.tumblr.com/) （抱歉我找不到更好的示例）

Google 在 Google+ 照片页面上做了类似的事情：https: [//plus.google.com/u/0/photos/111395306401981598462/albums/5678415422536656161](https://plus.google.com/u/0/photos/111395306401981598462/albums/5678415422536656161)

这种东西有名字吗？我怎样才能实现它或我在哪里可以得到这些结果

就好像他们坐在一起一样。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-11T02:40:13.343

Tumbler 似乎正在使用 Javascript 来计算图像的布局。页面加载后，它为每个图像设置一个绝对位置。如果调整窗口大小，则会重新计算每个图像的位置。

谷歌似乎已经预购了这些图片，所以它们使用 float:left 很好地结合在一起。您会注意到，除了第一张图片之外，这些图片都是按行排列的。当您调整浏览器大小时，图像会放大或缩小以保持布局。

要自己执行此操作，请查看[jQuery Masonry 插件](http://masonry.desandro.com/)。

# javascript - JavaScript 一张一张地显示图片

> ID：10098691
> 
> 赞同：0
> 
> 时间：2012-04-11T01:23:59.067
> 
> 标签：javascript, slideshow

我正在使用此代码从 test.php 输出中读取数组，对其进行排序，然后像幻灯片一样显示结果。

这条线有问题，因为只显示了一张图像。

```
 curimg= (curimg < galleryarray.length)
    curimg + 1; 
```

这是代码：

```
> <script type="text/javascript">
> var curimg=0;
> function rotateimages(){
> galleryarray.sort();
> document.getElementById("picsimg").setAttribute("src", "images/"+galleryarray[curimg]);
> curimg= (curimg < galleryarray.length);
> curimg + 1;
> }
>
> window.onload = function(){
> setInterval("rotateimages()", 2000);
> }
>
> setTimeout(function(){
>   window.location.reload(1);
> }, 20000);
>
> </script>
> 
```

我的代码有什么问题？

我遇到的另一个问题是，当我第一次加载页面时，它会显示 2000 毫秒的空白页面。//或我上面设置的任何值。

要么是在加载图像之前出现延迟，要么是我的计数错误。如何解决？

这是我的 php 代码的输出：

```
var galleryarray = new Array();
galleryarray[0] = "image1.jpg";
galleryarray[1] = "image5.jpg";
galleryarray[2] = "image2.jpg";
galleryarray[3] = "image4.jpg";
galleryarray[4] = "image8.jpg";
galleryarray[5] = "image7.jpg";
galleryarray[6] = "image0.jpg";
galleryarray[7] = "image3.jpg";
galleryarray[8] = "image6.jpg";​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T01:28:37.707

在行

```
curimg= (curimg < galleryarray.length); 
```

您正在将 curimg 设置为布尔值（1 或 0）。您需要做的是将这些行替换为

```
if(curimg < galleryarray.length) 
    curimg = curimg + 1; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T01:31:06.963

试试这个：

```
curimg = (curimg+1) % galleryarray.length; 
```

这将让您从头到尾重复遍历galleryarray。

# core-data - 我应该如何建模某些实例无法修改？

> ID：10098693
> 
> 赞同：1
> 
> 时间：2012-04-11T01:24:27.927
> 
> 标签：core-data, uml, datamodel, data-modeling

我正在使用 xcode 和核心数据创建数据模型。这是一个对象图，而不是实体关系模型，所以我有继承和多对多关系。

这是我的问题：我有一个名为 Category 的类或实体。某些类别由应用程序创建，用户无法删除或修改。用户可以创建自己的类别。

经过思考，我找到了 4 种方法来对此进行建模。看图片：

![在此处输入图像描述](../Images/5dd155e538407169825ab5c51bf7675b.png)

我想最实用的解决方案只是添加一个标志 isSystemCategory，但我想知道从建模的角度来看最好的解决方案是什么。我猜是第一个。一个叫做Category的抽象类，以及2个后代，可编辑和可删除的UserCategory和不可变的SystemCategory，用户不能删除或修改。请注意，后代不会添加任何属性、关系或任何更改，所以，这就是我提出问题的原因。这对建模者来说是正确的方法吗？

我想知道你的想法。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T11:39:39.883

根据描述，我可能也会选择第一个。

> 请注意，后代不会添加任何属性、关系或任何更改

但行为不同。而且也有逻辑上的差异。User 和 UserCategory 之间存在隐含的“关系”，允许用户创建/更新/删除 UC。您可能不需要明确地持有它，但它仍然存在（并且您可能会捕获它，例如，如果您想记录谁创建/修改/删除了该类别）。

创建单独的子类型将防止出现一些令人讨厌的条件逻辑，如果您使用例如标志，这些条件逻辑会突然出现。想想删除：有了一个标志，你就会有一个`if (category.isUserCategory) then <delete> else <...etc...>`. 此外，对于每个操作，对于用户类别与系统类别的行为不同，该逻辑将被复​​制。使用子类型消除了这一点：`UserCategory.delete()`只是这样做，`SystemCategory.delete()`只是没有（在 SystemCategory 上甚至可能没有公共删除）。没有条件。

最后一个想法：这里的问题实际上与授权有关。如果处理类别是它出现的唯一地方，那么您的选项 (1) 可能是一个务实的解决方案（“可能工作的最简单的事情”）。但是，如果您经常需要控制访问，您可能应该使用更通用的授权机制。

hth。

# vbscript - VBScript IF 语句确定操作系统版本和 ServicePack

> ID：10098694
> 
> 赞同：0
> 
> 时间：2012-04-11T01:24:32.370
> 
> 标签：vbscript, wmi

我正在为 Office 2010 和其他几个应用程序编写部署脚本，我们在测试中遇到的问题之一是一些计算机仍然有 XP SP2，所以我想为此编写一个安全措施。

我想出了这个

```
Set colOperatingSystem = objWMIService.ExecQuery("Select * from Win32_OperatingSystem")

For Each objOperatingSystem in colOperatingSystem
ServicePack = objOperatingSystem.ServicePackMajorVersion
Next

IF not ServicePack = "3" Then

MsgBox "WARNING: prerequisite to installing Microsoft Office 2010 Professional you must first install service pack 3" & VbCrlf & "your current Service Pack Version is " & ServicePack

ELSE

'Do Nothing

END IF 
```

我将它插入 XP SP2 机器并得到警告弹出 On_WindowLoad，所以我很高兴，但是一旦我将它插入我的 windows 7 机器，它就会抛出相同的消息，深入研究 powershell 我意识到自从 windows 7报告它的 ServicePackMajorVersion 编号为“1”，因此它不满足条件，

希望有人可能知道如何编写 IF / 条件语句来绕过 Windows 7 PC，我查看了内部版本号 7601，但不确定如何嵌套这些

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-11T02:14:46.107

要测试您是否在 Windows XP 下运行，您必须检查WMI 类的`Version`属性是否以`Win32_OperatingSystem``5.1`

检查这个样本

```
strComputer = "."
 Set objWMIService = GetObject("winmgmts:\\" & strComputer & "\root\cimv2")        
Set colOperatingSystem = objWMIService.ExecQuery("Select * from Win32_OperatingSystem")

For Each objOperatingSystem in colOperatingSystem
ServicePack = objOperatingSystem.ServicePackMajorVersion
Version = objOperatingSystem.Version

Next

IF Mid(Version,1,3)="5.1" And  not ServicePack = "3" Then

MsgBox "WARNING: prerequisite to installing Microsoft Office 2010 Professional you must first install service pack 3" & VbCrlf & "your current Service Pack Version is " & ServicePack

ELSE

'Do Nothing

END IF 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T01:30:30.083

查看：[http ://www.tek-tips.com/viewthread.cfm?qid=1249039](http://www.tek-tips.com/viewthread.cfm?qid=1249039)

首先查找操作系统版本，然后如果 XP 查找 SP 3，如果 Win 7 查找 SP 1。

# c++ - 删除两个字符串比较中不常见的字符

> ID：10098696
> 
> 赞同：0
> 
> 时间：2012-04-11T01:25:00.657
> 
> 标签：c++

```
string word1 = "misisipi";
string word2 = "mississippi"; 
```

我想以某种方式“比较”这些字符串，并能够“扔掉”不常见的字母。例如 word2 将被缩减为`"misisipi"`，确保保持 'S' 的顺序，并且`word1`不会更改，因为它的所有字符都在`word2`. 我知道如何删除字符串中的元素，但这次我想保持顺序。例如，如果我**不**维护顺序，比较后`word2`会是`"missipi"`，这不是我想要的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T01:43:55.967

尝试`word2`在`word1`遍历`word1`.

```
std::string temp;
std::string::iterator w2 = word2.begin();

for(std::string::iterator w1 = word1.begin(); w1 != word1.end(); ++w1)
{
    for(; w2 != word2.end(); ++w2)    // Move through word2...
    {
        if(*w1 == *w2)    // Copy the character into temp when found.
        {
            temp += *w2;
            break;
        }
    }
}

std::cout << temp << std::endl; 
```

`temp`如果您想要速度，可能要预先分配。

# c# - 使用 MemoryBarrier 传播字典中的更改 多线程应用

> ID：10098697
> 
> 赞同：1
> 
> 时间：2012-04-11T01:25:02.270
> 
> 标签：c#, multithreading, dictionary

我有一个 .NET 3.5 应用程序，其中 Dictionary 实例在两个线程之间共享。我知道字典本身在任何方面都不是线程安全的，但我只有一个线程可以修改字典，而另一个线程只需要确保它在执行其工作时具有最新的值。（从最严格的意义上讲，即使是*最新*的也不是硬性要求）

一个线程正在接收间歇性串行数据并调用 Set 函数来更改字典中的值。（此字典在初始设置后是固定大小的，我基本上只是将其用作稀疏数组）

第二个线程收集当前存储在字典中的值，并通过 GetLatestValues() 对它们进行一些处理。

```
public class HwMemoryMap{
   Dictionary<int, HwDataItem> HwCache;

   public void Set(HwDataItem dataItem){
       HwCache[dataItem.PtId] = dataItem;
       MemoryBarrier();
   }

   public List<HwDataItem> GetLatestValues(){
       System.Threading.Thread.MemoryBarrier();
       List<HwDataItem> HwDataItemList = new List<HwDataItem>();
       // do work here to pull appropriate values out of HwCache
       HwDataItemList.Add(HwCache[0]); // etc
       return HwDataItemList;
   }
} 
```

此处的 MemoryBarrier() 调用是否足以确保对特定键的字典值的更改在所有线程/内核中传播？

我的测试没有发现任何问题，但考虑到这些问题的性质，这并没有给我任何安慰。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T13:55:16.980

不，这不安全。您仍然冒着同时从数据结构中写入和读取的风险。如果写入频率足够低，您可以使用一个非常有效的技巧。基本上，您确保引用的数据结构`HwCache`保持不变。每次要更改数据结构时，首先将其复制到新实例中，然后在独占锁内更改新实例。然后，当您的更改完成后，您将`HwCache`引用与新实例交换出来。要使其正常工作，您必须标记`HwCache`为`volatile`。

```
public class HwMemoryMap
{
  private object lockobj = new object();
  volatile Dictionary<int, HwDataItem> HwCache;

  public void Set(HwDataItem dataItem)
  {
    lock (lockobj)
    {
      var copy = new Dictionary<int, HWDataItem>(HwCache);
      copy[dataItem.PtId] = dataItem;
      HwCache = copy;
    }
  }

  public List<HwDataItem> GetLatestValues()
  {
    var local = HwCache;
    var HwDataItemList = new List<HwDataItem>();
    // do work here to pull appropriate values out of local
    HwDataItemList.Add(local[0]); // etc
    return HwDataItemList;
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T01:40:52.093

我对 C# 不是很熟悉，但我不会对“幕后”发生的事情做出假设。特别是，如果插入代码假定它是唯一访问数据结构的代码，它可能会在分配空间或其他情况时留下部分更新的引用。

考虑以下（简化的）代码：

```
Insert(TKey key, TVal val) {
    if (this.size > this._threshold) {
        // Allocate more space and
        // move to a new table
    }
    // Find location and insert
} 
```

如果所有这些都发生在您的一个商店中（我不是说它是，我不知道 C# 如何实现字典），那么如果任何中间状态传播到不同的状态，内存屏障不会拯救您线。

可能更有意义的是一对读/写锁。如果常见的情况是读，可以让多个线程都抢读锁，只有在需要更新的时候才需要给写线程独占访问。

# ios - iOS 将 mp3 下载到应用程序的沙箱

> ID：10098698
> 
> 赞同：0
> 
> 时间：2012-04-11T01:25:02.863
> 
> 标签：ios, mp3

我想在我的 iphone 应用程序上播放 mp3。我现在可以从我的服务器流式传输 mp3（通过使用 MPMoviePlayerViewController）。但是，我想添加使用户能够下载 mp3，然后在没有互联网连接时在本地播放的功能。

**有一个名为Elevation**的应用程序做同样的事情。它会将 mp3 下载到应用程序的沙箱（而不是 ipod 库）中。用户可以在以后根据需要将其删除。有谁知道它是怎么变魔术的？

![在此处输入图像描述](../Images/e5472951cff4e4baf981540d24e27750.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T04:38:28.050

使用`NSURLConnection` **BUT****异步**下载文件，因为同步连接会使您的 UI 在下载文件时冻结。这是一个清晰的示例，您只需要做一些小的更改：

[http://blog.sallarp.com/iphone-uiimage-asynchronously/](http://blog.sallarp.com/iphone-uiimage-asynchronously/)

希望能帮助到你。

# javascript - 对象内的 Javascript 回调

> ID：10098699
> 
> 赞同：1
> 
> 时间：2012-04-11T01:25:12.270
> 
> 标签：javascript, jquery, twitter-bootstrap, jquery-events

我正在编写一个通过 AJAX 获取 HTML 文档的 Javascript 应用程序，然后需要对其进行处理以将事件侦听器（特别是 Bootstrap 弹出窗口）附加到其中的元素。我很难连接听众，我相信这是一个范围问题。以下是相关代码：

```
var App = function(site){

  this.load = function(data, func){
    $('div.ajax').html(data);
    func();
  }

  this.dispatch = function(data){

    if(data.indexOf('from_server') !== -1){
      this.load(data, this.process);
      console.log('Loaded view from Matisse.');
      return true;
    }

  }

  this.process = function(){
    this.popovers('from_server');
  }

  this.popovers = function(el){
    var that = this;
    $('img.artwork.gallery', el).each(function(){
       $(this).popover({ trigger: 'hover', content: that.popoverPopulate(this) });
    });
  }

  this.popoverPopulate = function(el){
    return $(el).next('div.popover_content').html();
  }
}

var APP = new App();

$.ajax({blah: blah, success: function(data){ APP.dispatch(data); }});

... 
```

问题（我认为）是`func()`调用`this.load`. 如果我通过它`this.process()`，那么它将“this”范围限定为窗口，并且出现错误。如果我通过`this.process`，它是一个创建的 lambda 并且它仍然失败。如果我打电话`this.func()`会出现同样的问题。

我如何 a) 使用回调将范围保持在 App 对象内，或者 b) 重新组织这个混乱以在加载后调用处理程序？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T02:04:16.343

我想你想`var that=this`在所有方法上使用范围技巧：

```
var App = function(site){

  var that = this;

  this.load = function(data, func){
    $('div.ajax').html(data);
    func();
  }

  this.dispatch = function(data){

    if(data.indexOf('from_server') !== -1){
      that.load(data, that.process);
      console.log('Loaded view from Matisse.');
      return true;
    }

  }

  this.process = function(){
    that.popovers('from_server');
  }

  this.popovers = function(el){
    $('img.artwork.gallery', el).each(function(){
       $(that).popover({ trigger: 'hover', content: that.popoverPopulate(this) });
    });
  }

  this.popoverPopulate = function(el){
    return $(el).next('div.popover_content').html();
  }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-11T02:06:11.583

像这样的东西：

```
var App = function(site){
    var self = this; //-<!!!

    this.load = function(data, func){

    ...

    this.dispatch = function(data){
        if(data.indexOf('from_server') !== -1){
            self.load(data, self.process);
    ... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-11T02:06:02.783

this 指的是当前使用它的上下文。因此，当您这样做时，`this.process`它将以窗口为目标。如果您这样做，`App.load(data, App.process)`那么它将针对`App`对象内的流程功能。

# asp.net - 将 HttpHandler 添加到 SharePoint 2010 以在下载时重命名 PDF

> ID：10098701
> 
> 赞同：1
> 
> 时间：2012-04-11T01:25:37.077
> 
> 标签：asp.net, visual-studio-2010, sharepoint, sharepoint-2010

我已经四处寻找了一段时间，但似乎找不到最新的示例，而且我目前对 SharePoint 作为一个整体的了解相当少。我需要做的是从文档库中附加一列以及在下载 PDF 时对它们进行最后修改的日期。据我所知，SharePoint 没有内置的方法来执行此操作，而要采取的方法是生成一个 HttpHandler，它在下载文件之前更改文件名。

[关联](http://blog.falchionconsulting.com/index.php/2012/03/stamping-pdf-files-downloaded-from-sharepoint-2010/)

我发现这是一个好的开始，并且添加代码来操作文件名似乎很简单，但我遇到困难的地方实际上是创建正确的文件并将其部署到 SharePoint。

任何建议或示例将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T07:49:34.880

您需要做的是将您的 VisualStudio SharePoint 项目（功能、包等）打包到**.wsp**文件中。**.wsp**文件只是一个zip 文件，其中包含要部署到配置单元（14 文件夹）的工件。

我建议您使用 CKS Dev，您可以轻松地创建 wsp。它是在代码 plex 上找到的 VS 2010 的开源插件。 [CodePlex 上的 CKS 开发](http://cksdev.codeplex.com/)

下一步是将这个 wsp 复制到需要安装它的服务器上。然后在服务器上发出一些 powershell 命令来安装你的代码。 [这是一个链接，带您完成部署步骤](http://www.c-sharpcorner.com/uploadfile/anavijai/how-to-deploy-a-wsp-using-powershell-in-sharepoint-2010/)

简而言之：
1\. 创建 wsp
2\. 复制 wsp
3\. 在服务器上安装 wsp

我希望它有所帮助。祝你好运。

# php - 分离我的 Mysql 组结果

> ID：10098704
> 
> 赞同：0
> 
> 时间：2012-04-11T01:26:00.540
> 
> 标签：php, mysql

好的，我有一个来自我的 mysql 数据库的结果列表，基本上它列出了我查看的网站页面并按日期对它们进行分组。现在结果很好，一切都很好地分组。并像这样显示在页面上。

29/03/2012 09:18 页面名称

29/03/2012 09:24 页面名称

现在我想做的是看看我是否可以更改格式，以便这样列出结果

29/03/2012

页面名称

页面名称

2012 年 3 月 30 日

页面名称

页面名称

我遇到的问题之一是日期字段是日期时间，尽管我可以从变量中删除日期并以这种方式使用日期，但我不确定如何列出上面列出的结果。以下是我当前的代码，

```
$query = "SELECT date, page_name FROM page_views GROUP BY date"; 
$result = mysql_query($query) or die(mysql_error());
// Print out result
while($row = mysql_fetch_array($result)){
echo $row['date']. " - $". $row['page_name'];
echo "<br />"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T06:30:43.390

您可以使用 PHP 中的 date() 来格式化您的日期时间：

```
while($row = mysql_fetch_array($result)) { 
    echo date("d/m/Y", strtotime($row['date']));
    echo "<br />";
    echo $row['page_name'];
    echo "<br />"; 
} 
```

这将导致：

29/03/2012

页面名称

2012 年 3 月 30 日

页面名称

编辑：

这是我现在唯一的解决方案：

```
//First you select only the DISTINCT DATEs without TIME
$query1 = 'SELECT DISTINCT DATE_FORMAT(date, %d/%m/%Y") as date FROM page_views';
$result1 = mysql_query($query1) or die(mysql_error()); 

//Create a while-loop to store DATE data in array
while($row1 = mysql_fetch_array($result1)) {
    $array[]['date'] = $row1['date']

    //SELECT the page_names where the date is LIKE the date in array
    $query2 = 'SELECT page_name FROM page_views WHERE date LIKE "%'.$row1['date'].'%"';
    $result2 = mysql_query($query2) or die(mysql_error());

    //Create a second while-loop to store the pagenames data in array who fits to the date
    while($row2 = mysql_fetch_array($result2) {
        $array[]['pagenames'][] = $row2['page_name'];
    }
}

print_r($array);
//This will output this:
$array = Array(
    [0] => Array(
        [date] => 29/03/2012
        [pagenames] => Array(
            [0] => pagename1
            [1] => pagename2
        )
    )
    [1] => Array(
        [date] => 30/03/2012
        [pagenames] => Array(
            [0] => pagename1
            [1] => pagename2
        )
    )
)

//use foreach to display the data
foreach($array as $entry) {
    echo $entry['date'];
    echo '<br />';
    foreach($entry['pagenames'] as $pagename) {
        echo $pagename;
        echo '<br />';
    }
} 
```

# ubuntu - Amazon EC2 Ubuntu 缺少 update-rc.d？

> ID：10098709
> 
> 赞同：2
> 
> 时间：2012-04-11T01:26:40.820
> 
> 标签：ubuntu, amazon-ec2

我有一个新的小型 Amazon Ubuntu 服务器，使用标准 AMI。我在 init.d 中添加了一个工作，我正在尝试使用 update-rc.d 向我的启动添加一个工作。但是，我收到 update-rc.d 的命令未找到错误。我认为这是 Ubuntu 标准安装的一部分，我没有看到任何关于如何安装它的建议。有什么想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-15T15:11:36.030

您可能实际上想要使用`chkconfig`. 例如，要启用 memcached，您可以这样做

```
sudo chkconfig --level 345 memcached on 
```

重启后，memcached 应该会自动启动。这在 Amazon Linux AMI 2012.03 上对我有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T01:37:32.327

你是管理员吗？当我在那里尝试时。你可以尝试做一个： `find / -name update-rc.d` 也许它在其他地方或者你没有许可。

另外你使用的是什么版本的ubuntu？

# actionscript-3 - AS3控制孩子的movieclip

> ID：10098711
> 
> 赞同：0
> 
> 时间：2012-04-11T01:27:03.407
> 
> 标签：actionscript-3, flash

我有几个库中的影片剪辑将添加到舞台，影片剪辑内部有一些我想控制它的 mc，这是我的脚本。

```
if (selectDiffText.text == "Collection 1 Easy")
    {
        var c1_easy:cartoonEasy = new cartoonEasy();
        addChild(c1_easy);
        c1_easy.x = 412;
        c1_easy.y = 400;
        TweenMax.from(c1_easy, 0.5, {alpha:0, ease:Expo.easeOut});
    }
    else if (selectDiffText.text == "Collection 1 Medium")
    {
        var c1_medium:cartoonMedium = new cartoonMedium();
        addChild(c1_medium);
        c1_medium.x = 412;
        c1_medium.y = 400;
        TweenMax.from(c1_medium, 0.5, {alpha:0, ease:Expo.easeOut});
    }
else
    {
        trace("ERROR!");
    } 
```

***如果selectDiffText***发生变化，上面的代码将从库中加载特定的影片剪辑。

```
var movieList:Array = [cartoonMedium1,cartoonMedium2,cartoonMedium3,cartoonMedium4,cartoonMedium5,cartoonMedium6];

function getRandomMovie():MovieClip
{
    var index:int = Math.floor(Math.random() * movieList.length);
    var mcClass:Class = movieList.splice(index,1)[0];
    return new mcClass();
}
playGame = getRandomMovie();
addChild(playGame); 
```

假设如果将 c1_medium 添加到舞台，c1_medium 也会从库中随机添加 1 个影片剪辑。

在***playGame*** mc 里面，我有*mouseTarget.alpha = 0;* ...如何从根级别控制它？c1_easy 也有 mouseTarget.alpha=0 。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T03:10:27.590

要轻松做到这一点，`c1_easy`并且`c1_medium`应该都扩展同一个类。例如：

```
class c1_easy extends CartoonGenericClass{[...]} 
```

和

```
class c1_medium extends CartoonGenericClass{[...]} 
```

在`CartoonGenericClass`中，您将拥有变量`mouseTarget`。您使用 getter/setter 将其公开：

```
protected var _mouseTarget:Number;

public function get mouseTarget():Number{
    return _mouseTarget;
}

public function set mouseTarget(value:Number):void{
    // (should probably do some verification on "value" here)
    _mouseTarget.alpha = value;
} 
```

这将允许从任何可以访问或`mouseTarget`的对象访问变量（注意没有下划线）：`c1_easy``c1_medium`

```
c1_easy.mouseTarget = 0;
c1_medium.mouseTarget = .3; 
```

等等等等。这是标准的 OOP，所以可能是时候破解一个文档了。！

# php - 此登录脚本是否良好/当前/安全？

> ID：10098712
> 
> 赞同：0
> 
> 时间：2012-04-11T01:27:04.723
> 
> 标签：php, mysql, security, login

这是一个网站的身份验证脚本。这安全吗？是最近的节目吗？它已经过时了吗？有没有“更好更安全的方法”我很新，但我没有看到太多使用标头授权的地方。

任何帮助，将不胜感激！这是我做过的第一个登录脚本，也是注册的。但是我不确定我是否喜欢标题授权。

```
<?php
require_once('connectvars.php');
IF (!isset($_SERVER['PHP_AUTH_USER']) || !isset($_SERVER['PHP_AUTH_PW'])) {
header('HTTP/1.1 401 Unauthorized');
header('WWW-Authenticate: Basic realm="Register"');
exit('<h3> You must enter your username & password to continue');
}
$Dbc  = mysqli_connect('localhost', 'root', '', 'learn');
$user_username = mysqli_real_escape_string($Dbc, trim($_SERVER['PHP_AUTH_USER']));
$user_password = mysqli_real_escape_string($Dbc, trim($_SERVER['PHP_AUTH_PW']));
$query = "SELECT ID, Username from members where Username = '$user_username' AND " .
"Password = SHA1('$user_password')";
$data = mysqli_query($Dbc, $query);
if (mysqli_num_rows($data) == 1) {
$row = mysqli_fetch_array($data);
$user_id = $row['ID'];
$username = $row['Username'];
}
else {
header('http/1.1 401 unauthorized');
header('www-authenticate: basic realm="Register"');
}
echo ('<p class="Login"> yo are logged in as ' . $user_username . '.</p>'); 

if (isset($_POST['submit'])) {
$username = $_POST['username'];
$password = $_POST['password'];
$email = $_POST['email'];

if (empty($username) ){ 
echo "you forgot to enter a username.</br>";
}
if (empty($password)) {
echo "you forgot to enter a password.</br>";
}   
if (empty($email)) {
echo "you forgot to enter an email.</br>";
}

if(!empty($username) && !empty($password) && !empty($email))  {
$dbc = mysqli_connect('localhost', 'root', '', 'learn');
$checkusername = 'SELECT username FROM members where username = "'.$username.'"';
if (mysqli_num_rows(mysqli_query($dbc, $checkusername)) != 0) 
{
    echo "<font color = red> Username <font color = black><u>           $username</u></font> already exists in the database.</font></br>";

$checkemail = 'Select email FROM members where email = "'.$email.'"';
if (mysqli_num_rows(mysqli_query($dbc, $checkemail)) != 0)
        echo "<font color = red> Email <font color = black><u>     $email</u></font> already exists in the database.</font>";
    mysqli_close($dbc);
}
else 
{
$query = "INSERT INTO members VALUES (0, '$username', SHA1('$password'), '$email')";
mysqli_query($dbc, $query);
echo " Username: <font color = green ><u> $username</u></font> & Password: <font color = green><u> $password</u></font> have been added to the database.";
mysqli_close($dbc);
}
}   
}

?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T01:29:18.480

这是错的。mysqli 支持参数化查询；使用它们。

# hibernate - 休眠：刷新时“无法将数据库状态与会话同步”

> ID：10098713
> 
> 赞同：0
> 
> 时间：2012-04-11T01:27:07.153
> 
> 标签：hibernate, exception

当我在下面的单元测试中尝试刷新时，我收到“无法将数据库状态与会话同步”。

谁能告诉我问题是什么，因为我完全迷路了？我试过只创建一个没有任何属性集的 RuleDefinition，但这也不起作用。

谢谢

这是我的单元测试的片段，它扩展了 AbstractTransactionalDataSourceSpringContextTests

```
@Test
public void testCreateRule() {
    RuleDefinition ruleReturned = (RuleDefinition) hibernateRuleDefinitionDao.findRule(1);
    RuleDefinition newRule = new RuleDefinition();
    newRule.setCurrentState("ACTIVE");
    newRule.setAttribute(ruleReturned.getSecondaryAttribute());
    newRule.setSecondaryAttribute(ruleReturned.getAttribute());
    newRule.setOperator(ruleReturned.getOperator());
    newRule.setPrecedence(4);
    hibernateRuleDefinitionDao.createRule(newRule);
    // Exception is thrown after the flush
    hibernateTemplate.flush();   
} 
```

DAO 方法只是调用一个保存操作。这是我的映射文件

```
<class name="abc.def.rules.RuleDefinition" table="REFDATA.CONFIG_RULE_DEFINITION">
    <id name="ruleId" column="RULE_ID">
        <generator class="increment"/>
    </id>
    <many-to-one name="attribute" cascade="none" class="abc.def.rules.ConfigAttribute" lazy="false" column="CONFIG_ATTR_ID"/>
    <many-to-one name="operator" cascade="none" class="abc.def.rules.Operator" lazy="false">
        <column name="OPRTR_VAL"/>
        <column name="OPRTR_VAL_DATA_TYP"/>
    </many-to-one>
    <many-to-one name="secondaryAttribute" cascade="none" class="abc.def.rules.ConfigAttribute" lazy="false" column="CONFIG_ATTR_ID_2" not-null="false"/>
    <property name="operand" column="OPRND_VAL" type="string"/>
    <property name="trueAction" column="TRUE_ACTN" type="string"/>
    <property name="falseAction" column="FALSE_ACTN" type="string"/>
    <property name="precedence" column="RULE_ORD_SEQ" type="int" not-null="true"/>
    <property name="currentState" column="RULE_STAT" type="string"/>
</class> 
```

这是我的 Spring 配置文件的片段

```
<bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource">
    <property name="driverClassName" value="org.hsqldb.jdbcDriver" />
    <property name="url" value="jdbc:hsqldb:mem:testdb" />
    <property name="username" value="sa" />
    <property name="password" value="" />
</bean>

<bean id="sessionFactory"
    class="org.springframework.orm.hibernate3.LocalSessionFactoryBean">
    <property name="dataSource" ref="dataSource" />
    <property name="configLocations">
        <list>
            <value>classpath:abc\def\hibernate-reference.cfg.xml</value>
        </list>
    </property>
    <property name="hibernateProperties">
        <props>
            <prop key="hibernate.dialect">
                org.hibernate.dialect.HSQLDialect
            </prop>
            <prop key="hibernate.cache.provider_class">
                org.hibernate.cache.NoCacheProvider
            </prop>
            <prop key="hibernate.cache.use_second_level_cache">
                false
            </prop>
            <prop key="hibernate.cache.use_query_cache">false</prop>
        </props>
    </property>
</bean>

<tx:annotation-driven transaction-manager="transactionManager" />

<bean id="transactionManager"
    class="org.springframework.orm.hibernate3.HibernateTransactionManager">
    <property name="sessionFactory" ref="sessionFactory" />
</bean> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T02:19:09.917

我自己设法解决了这个问题。我的 CONFIG_RULE_DEFINITION 有一个约束，指定 Timestamp 列不应为空，并且应默认为 SYSDATE。但是，我认为 SYSDATE 在 HSQLDB 中不起作用。出于某种原因，没有传播此类错误来通知我。一旦我删除了这个约束，一切都很好！

# php - PHP mkdir 在 if 语句中不起作用

> ID：10098716
> 
> 赞同：0
> 
> 时间：2012-04-11T01:27:39.743
> 
> 标签：php, function, codeigniter, mkdir

为什么我`mkdir`不在该`if(is_dir)`函数内工作，但它只在其上方工作，只有一行？

```
mkdir($location.$folderName, 0777);

            if(!is_dir($folderName))
            {   
                mkdir($location.$folderName, 0777);

            }else{

            //Set File Settings 
              $config['upload_path'] = $location.$folderName; 
              $config['allowed_types'] = 'jpg|png|pdf'; 
              $config['file_name'] = $folderName.'_'.$concept;
              $config['remove_spaces'] = TRUE;
              $config['overwrite'] = TRUE;
              $config['max_size'] = '1024'; 
              $config['max_width'] = '1024'; 
              $config['max_height'] = '768'; 

              $this->load->library('upload', $config); 

                print_r($config);

              if(!$this->upload->do_upload($conceptOne)) { #= try upload

                $data['uploadError'] = array('uploadError' => $this->upload->display_errors()); #Error

                $this->load->view('layout', $data);

          } // Do upload
              else{
                $data = array('upload_data' => $this->upload->data($conceptOne));

              }// end else
            }// end if folder 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T01:53:48.127

你的代码自相矛盾......你正在打电话`mkdir ( $location . $folderName, 0777 );`，但检查`! is_dir ( $folderName ))`肯定这不起作用

尝试

```
$location  = "" ; // Your Location 
$foldername = "" ; // Your Folder Name
$path = $location . DIRECTORY_SEPARATOR . $foldername ;

if (!is_dir ( $path )) {

    if(is_writable($location))
    {
        mkdir ($path, 0777 );
    }
    else
    {
        die("You don't have permission to create folder");
    }
}

 else { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T01:31:06.447

**尝试这个 ：**

```
if (!(file_exists($folderName))) { 
```

# android - 如何在 TextView 中滚动时显示水平滚动条？

> ID：10098717
> 
> 赞同：0
> 
> 时间：2012-04-11T01:28:05.207
> 
> 标签：android, android-layout

我已启用

```
 android:scrollHorizontally="true"
        android:scrollbars="horizontal|vertical" 
```

在我的 TextView 中 - 它可以水平和垂直滚动。但是，只有垂直的滚动条显示，而从不显示水平的。我怎样才能让它显示出来？

这个文本视图也在 ScollView 中（所以我可以有非滚动的元素）。textviews 的宽度和高度都是 wrap_content，scrollviews 都是 match_parent。

# javascript - 在继续之前等待 .each 完成（jquery）

> ID：10098718
> 
> 赞同：0
> 
> 时间：2012-04-11T01:28:07.997
> 
> 标签：javascript, jquery

我正在使用 jquery 中的每个函数，看起来它正在转到一个函数，该函数在完成之前需要每个循环的结果......这是代码

```
$.each(array, function(index, value) { 
  prob[value] = get_probs(value);
});

sim(prob);

function sim(prob){
  //alert ("test");
  alert (prob[value]);
  new_sim(prob[value]); 
} 
```

如果我取消注释警报（“测试”）；一块它显然会显示一个警报，然后它会在第二个警报中显示正确的数字，但是，如果我保持原样，它会返回未定义，我只能假设是因为它已经进入了 sim 函数而没有完成每个循环

无论如何我可以让 sim 函数等待运行，直到每个循环完成？

注意：还有比这更多的代码，但我试图简化......如果有任何不清楚的地方请告诉我。我最终会多次运行 sim 函数，这就是为什么我想这样设置它

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T01:30:37.720

.each 循环应该按顺序运行，在它完成之前什么都不应该执行。

如何运行此代码：

```
sim(prob);

function sim(prob){
  //alert ("test");
  alert (prob[value]);
  new_sim(prob[value]); 
} 
```

在 get_probs 的成功回调中，同步 ajax 调用永远不是答案。

# asp.net-mvc - 当 IDictionary 不是表的一部分时如何使用 MVC 下拉列表

> ID：10098719
> 
> 赞同：1
> 
> 时间：2012-04-11T01:28:11.793
> 
> 标签：asp.net-mvc, asp.net-mvc-3, razor, drop-down-menu, idictionary

我有一些代码在表格中的剃刀文件中使用以下方法设置下拉列表：

```
 foreach (var item in group) {
                <tr>
                    <td>
    ...
        @Html.DropDownListFor(modelItem => item.OfficeUserId, Model.OfficeApprovers, new { @class = "officeapproverddl", invoiceLineId = @item.InvoiceLineId, officeUserId = @item.OfficeUserId })
    ...
    </td>
    </tr>
}
    </table> 
```

这很好用，但是现在我想要表外的相同下拉列表。因此将没有要使用的项目对象。

你如何在桌子之外进行这项工作，即。我现在必须提供的只是 Model.OfficeApprovers 和 html 属性。

Model.OfficeApprovers 的类型为：`new Dictionary<string, IEnumerable<SelectListItem>>();`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T08:54:09.810

您使用字典有什么原因吗？

下面是我在填充下拉列表时通常如何做的代码。它非常简单，我建议您将其用作构建下拉列表的基础。

在我的视图顶部，我指定了我的视图模型：

```
@model MyProject.ViewModels.MyViewModel 
```

在我看来，我有一个下拉列表，其中显示了用户可以选择的所有银行：

```
<table>
     <tr>
          <td><b>Bank:</b></td>
          <td>
               @Html.DropDownListFor(
                    x => x.BankId,
                    new SelectList(Model.Banks, "Id", "Name", Model.BankId),
                    "-- Select --"
               )
               @Html.ValidationMessageFor(x => x.BankId)
          </td>
     </tr>
</table> 
```

我总是有一个视图的视图模型，我从不将域对象直接传递给视图。在这种情况下，我的视图模型将包含将从数据库中填充的银行列表：

```
public class MyViewModel
{
     // Other properties

     public int BankId { get; set; }
     public IEnumerable<Bank> Banks { get; set; }
} 
```

我的银行域模型：

```
public class Bank
{
     public int Id { get; set; }
     public string Name { get; set; }
} 
```

然后在我的操作方法中创建我的视图模型的一个实例并从数据库中填充银行列表。完成后，我将视图模型返回到视图：

```
public ActionResult MyActionMethod()
{
     MyViewModel viewModel = new ViewModel
     {
          // Database call to get all the banks
          // GetAll returns a list of Bank objects
          Banks = bankService.GetAll()
     };

     return View(viewModel);
} 
```

我希望这有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T01:41:50.380

从这里[http://msdn.microsoft.com/en-us/library/ee703573.aspx](http://msdn.microsoft.com/en-us/library/ee703573.aspx)我们有`DropDownListFor`这个语法：

```
public static MvcHtmlString DropDownListFor<TModel, TProperty>(
    this HtmlHelper<TModel> htmlHelper,
    Expression<Func<TModel, TProperty>> expression,
    IEnumerable<SelectListItem> selectList,
    Object htmlAttributes
) 
```

构造 a 时必须提供表达式`DropDownListFor`：

> ```
> expression: System.Linq.Expressions.Expression(Of Func(Of TModel, TProperty))
> An expression that identifies the object that contains the properties to render. 
> ```

因此，您想要的方式不适用于 DropDownListFor。

在这种情况下，您最好的选择是使用简单的`@Html.DropDownList`. 您可以使用[此重载](http://msdn.microsoft.com/en-us/library/dd470329.aspx)来实现您想要的：

```
public static MvcHtmlString DropDownList(
    this HtmlHelper htmlHelper,
    string name,
    IEnumerable<SelectListItem> selectList,
    IDictionary<string, Object> htmlAttributes
) 
```

样本：

```
@Html.DropDownList("officeApprovers", Model.OfficeApprovers,
                                                   new { @class = "officeapproverddl" } 
```

编辑：

试试这个：

```
@Html.DropDownList("officeApprovers", Model.OfficeApprovers.Values[0],
                                                   new { @class = "officeapproverddl" } 
```

# cakephp - 如何根据组 id 获取列表

> ID：10098721
> 
> 赞同：0
> 
> 时间：2012-04-11T01:28:39.127
> 
> 标签：cakephp, cakephp-1.3, cakephp-2.0, cakephp-2.1

我有一个 group_id 分配给用户，但在我的用户索引页面上，我想知道属于登录用户所属特定组的用户的方式。目前它设置为显示所有用户

```
public function index() {

                            $this->User->recursive = 0;
                            $this->set('users', $this->paginate());
} 
```

我将如何改变它

登录：

```
public function login() {
     if ($this->request->is('post')){
        if ($this->Auth->login()) {
            $this->redirect($this->Auth->redirect());
        }else {
            $this->Session->setFlash('Your username or password was incorrect.');
        }
    }
} 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T06:18:24.437

要获取当前登录用户的 group_id，请更新 index() 操作以包括：

```
public function index() {

    // get logged in user info
    $user = $this->Auth->user();
    $group_id = $user['group_id'];

    // add pagination conditions
    $this->paginate = array(
        'conditions' => array('User.group_id' => $group_id)
    );
    $this->User->recursive = 0;
    $this->set('users', $this->paginate('User'));

} 
```

希望有帮助。

# java - Java：端口不可用（在 Windows 7 上）

> ID：10098722
> 
> 赞同：1
> 
> 时间：2012-04-11T01:28:50.803
> 
> 标签：java, sockets, port

**已解决：** 问题是“病毒”或类似劫持端口的东西。OBS：病毒劫持了端口，端口没有出现在 netstat -an 或正在使用的端口的 TCPView 上。

我使用了 AVG 杀毒软件来清除病毒。另一个防病毒软件不起作用，只有 AVG。

* * *

我做了这个程序来检查端口是否可用：

```
package com.test;

import java.io.IOException;
import java.net.DatagramSocket;
import java.net.ServerSocket;

public class Test {
    public static void main(String[] args) {
        System.out.println("Port available: " + available(62974));
    }
    public static boolean available(int port) {
        ServerSocket ss = null;
    try {
        ss = new ServerSocket(port);
        ss.setReuseAddress(true);
        return true;
    } catch (IOException e) {
        e.printStackTrace();
    } finally {
        if (ss != null) {
            try {
                ss.close();
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
    }

    return false;
    }
} 
```

响应是**错误**的。

抛出的异常是：

```
java.net.BindException: Address already in use: JVM_Bind
    at java.net.PlainSocketImpl.socketBind(Native Method)
    at java.net.PlainSocketImpl.bind(PlainSocketImpl.java:383)
    at java.net.ServerSocket.bind(ServerSocket.java:328)
    at java.net.ServerSocket.<init>(ServerSocket.java:194)
    at java.net.ServerSocket.<init>(ServerSocket.java:106)
    at com.dgs.test.Test.available(Test.java:16)
    at com.dgs.test.Test.main(Test.java:9) 
```

我正在使用这个端口：62​​974

但我检查控制台/提示-dos：

```
netstat -ano 
```

该端口**不在列表中**。

**我没有使用任何防火墙，我禁用了它**

我是否在做正确的事情来查看端口是否可用？

这是一个“不可用”的端口吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T02:59:17.280

在本地或远程测试活动 TCP/UDP 端口时，您的代码应该尝试成为客户端而不是服务器。

```
package com.test;

import java.io.IOException;
import java.net.Socket;

public class PortScan {
    public static void main(String[] args) {
        if (args.length > 0 ){
            System.out.println("Port active: " + available(args[0], args[1]));
        }
        else System.out.println("Usage: PortScan <ip> <port>");
    }

    public static boolean available(String ip, String port) {
        boolean status = false;
        Socket ss = null;
        try {
            ss = new Socket(ip, Integer.parseInt(port));
            status = true; //there is a listening port 
        } catch (IOException e) {
            e.printStackTrace();
        } finally {
            if (ss != null) {
                try {
                    ss.close();
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }
        }

        return status;
    }
} 
```

获取当前的 nestat -ano 结果：

```
 TCP    192.168.72.1:139       0.0.0.0:0              LISTENING       4
  TCP    192.168.184.1:139      0.0.0.0:0              LISTENING       4
  UDP    0.0.0.0:445            *:*                                    4 
```

当已经有一个 UDP 服务处于活动状态但它没有在 127.0.0.1:445 监听或 TCP 服务处于活动状态并且它正在监听 192.168.184.1:139 时，当你测试`PortScan 127.0.0.1 445`或时`PortScan 192.168.184.1 139`，它会连接并说“端口活动： 真的”：

当给定端口没有服务时（可能未激活或阻塞）；假设“127.0.0.1:446”，它将捕获“连接被拒绝”并说“端口活动：假”：

```
java.net.ConnectException: Connection refused: connect
    at java.net.PlainSocketImpl.socketConnect(Native Method)
    at java.net.PlainSocketImpl.doConnect(Unknown Source)
    at java.net.PlainSocketImpl.connectToAddress(Unknown Source)
    at java.net.PlainSocketImpl.connect(Unknown Source)
    at java.net.SocksSocketImpl.connect(Unknown Source)
    at java.net.Socket.connect(Unknown Source)
    at java.net.Socket.connect(Unknown Source)
    at java.net.Socket.<init>(Unknown Source)
    at java.net.Socket.<init>(Unknown Source)
    at com.test.PortScan.available(PortScan.java:18)
    at com.test.PortScan.main(PortScan.java:9)
Port active: false 
```

但是，您需要检查它拒绝的原因；它真的没有激活还是被防火墙阻止了？这是一个棘手的问题，您需要找出答案。

之后，您可以编写代码成为服务器并尝试在空闲/非活动端口上建立自己，如下所示：

```
 ServerSocket serverSocket = null;
        Socket socket = null;
        try {
            serverSocket = new ServerSocket(Integer.parseInt(port));
            serverSocket.setReceiveBufferSize(2048);
            serverSocket.setSoTimeout(0);
            serverSocket.setReuseAddress(true);
            socket = serverSocket.accept();
        } catch (NumberFormatException e1) {
            e1.printStackTrace();
        } catch (IOException e1) {
            e1.printStackTrace();
        }

        //do something here in a loop

        try {
            socket.close();
        } catch (IOException e1) {
            // TODO Auto-generated catch block
            e1.printStackTrace();
        } 
```

**更新：**

当您尝试再次连接另一个运行时，请确保上一次运行（涉及服务器代码部分）在 Eclipse 中正确关闭。检查Eclipse 的**调试视图**并在测试之前关闭有问题的先前运行。否则，`BindException`当您尝试在已激活的同一端口上建立服务器代码时，您将得到一个。

要检查服务器端口是否已建立，请使用：

```
netstat -ano | find "62974" 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-11T02:00:32.563

问题是您试图打开端口进行两次侦听。Serversocket 接受 TCP 连接，而 DatagramSocket 接受 UDP 数据报。您不能两次打开同一个端口。这解释了您得到的绑定 IO 异常。

# eclipse - Eclipse Ubuntu JApplet 缺少标题栏

> ID：10098723
> 
> 赞同：1
> 
> 时间：2012-04-11T01:28:52.080
> 
> 标签：eclipse, ubuntu, applet, window

晚上好，

我在 Ubuntu 11.04 的 64 位发行版上运行 Eclipse。当我编译和运行我的代码时，我正在编写一个 JApplet 并使用 Applet Viewer 中内置的 Eclipse。问题是 Applet Viewer 窗口没有标题栏或关闭栏，所以我无法重新定位窗口或关闭小程序。（我仍然可以通过单击 Eclipse IDE 中的停止进程按钮来关闭小程序）

有人对解决此问题有任何建议吗？

谢谢，

# android - Android Facebook Open Graph 类型引用错误

> ID：10098724
> 
> 赞同：1
> 
> 时间：2012-04-11T01:28:55.610
> 
> 标签：android, facebook-opengraph, facebook-oauth

当我尝试发布 Facebook Open Graph Action 时出现以下错误。

这是我提交代码的方式。

```
JSONObject test = new JSONObject();
test.put("type","myappnamespace:myCustomType");
test.put("title","test");
test.put("url","http://samples.ogp.me/314782891908537");
Bundle params = new Bundle();
params.putString("access_token", GetAccessToken(mContext));
params.putString("myCustomType", test.toString());
AsyncFacebookRunner request = new AsyncFacebookRunner(facebook);
request.request("me/myappnamespace:myCustomAction", params, "POST", new addToTimelineListener(), null); 
```

错误：

```
{"error":{"message":"(#3503) \"{
\"type\":\"myappnamespace:myCustomType\",
\"url\":\"http:\\\/\\\/samples.ogp.me\\\/314782891908537\",
\"title\":\"test\"}\" 
is an invalid value for property \"myCustomType\" with type 
"Reference\"","type":"OAuthException","code":3503}} 
```

即使它说它是一个 OAuthException 它与我的访问令牌没有任何关系。因为我可以使用相同的令牌通过应用程序将提要发布到 Facebook。

# c++ - C++结构对象调用函数

> ID：10098725
> 
> 赞同：0
> 
> 时间：2012-04-11T01:29:16.733
> 
> 标签：c++, function, object, struct

这简直让我沮丧到崩溃的边缘。我不知道为什么我无法弄清楚这一点，但是，我需要一些帮助。或者至少一些反问可以引导我走向正确的方向。

我有一个名为表达式的对象。此对象是 tokenType 标记的结构。

```
//expression.h file
struct expression
{

    int numTokens ;
    tokenType tokens[MAX_TOKENS_IN_EXPRESSION] ;

    void print() const ;
    ...
} 
```

tokenType 只是一个数字（操作数）或一个符号（运算符）

鉴于此，我的 test.cpp 文件中有这些代码行：

```
expression expr1 , expr2 ;
...
errorCode = expr1.toPostfix( expr2 ) ; 
```

我必须实现 toPostFix( [parameter] ); 其函数声明如下：

```
//in expression.cpp
int expression::toPostfix( expression & pfx ) const
{
    int result = 1; 

    //how do I read in the 'expression' that is calling this method???

    return result;
} 
```

如果结果 = 0，则表达式成功转换为 PostFix 表示法，否则不成功。

我遇到的问题是提供的代码中间的注释...如何检索传递给函数的数据？？？

我不是要代码，因为我觉得这是一个非常简单的问题，只是我的一个大脑放屁。因此，如果有人可以请我朝正确的方向踢我，我将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T01:32:07.997

你打电话时

```
expr1.toPostfix(expr2); 
```

然后指向的指针`expr1`作为方法内的（隐藏）指针传递`this`。

这样做的结果（不是双关语）是您可以`expression::toPostfix()`使用或不使用 using访问被调用对象上的成员函数和变量`this->`。通常，C++ 程序员`this->`在访问成员时会省略。

当然，您可以`expr2`通过在您的方法中使用来访问`pfx`方法。

我必须说，这是非常基本的 C++ 东西。您可能会考虑通过 C++ 教程来巩固您对事物的掌握。

# java - 创建代理对象以异步调用目标的方法（拆分逻辑/渲染线程）

> ID：10098727
> 
> 赞同：1
> 
> 时间：2012-04-11T01:29:39.060
> 
> 标签：java, reflection, asynchronous

在我的游戏设计中，我试图让逻辑和渲染线程尽可能并行运行。鉴于此，我需要一些方法将游戏逻辑中的更新推送到渲染线程中，并且我想找到最干净的方法来做到这一点。

首先让我道歉，因为我只是一个业余爱好者，我真的不知道任何设计模式或正确的术语，所以如果我所描述的内容有不同的名称，请告诉我。

假设我有一个看起来像这样的对象，渲染线程不断访问它：

```
public class Renderable {
   void functionA(int foo)          { ... }
   void functionB(int foo, int bar) { ... }
   void functionC()                 { ... }
} 
```

在我的逻辑线程中，我需要在随机点调用`functionA`、`functionB`和`functionC`，但由于对象位于不同的线程中，我无法在没有并发问题的情况下直接触摸 Renderable 。我真正想做的只是创建一个`RenderableProxy`与 具有相同接口的代理对象`Renderable`，它将存储对它的所有调用，然后`Renderable`在我对齐线程时在同步窗口期间将调用转发到。

该对象将如下所示：

```
public class RenderableProxy {
    Renderable target;

    void functionA(int foo)            { ? }
    void functionB(int foo, int bar)   { ? }
    void functionC()                   { ? }

    void execute()   {
        foreach( called_function )
           target.???      
    }             
} 
```

现在我相信我可以实现这个，如果我创建了一些结构，它包含表示函数的枚举之类的信息，并存储参数，然后只保留所有这些直到我调用`execute`.

但真正让我恼火的是，每次我对`Renderable`界面进行更新时，我都必须返回`RenderableProxy`并修改界面以匹配，并修改`execute`以处理更改。这对我来说真的很乱，我觉得可能有一种语言功能可以以某种方式处理这个问题，这样每当我更改 Renderable 界面时，我都不必重写`RenderableProxy`来处理新功能。

是否有这样一个神奇的功能可以让我实现我的目标，而无需不断尝试保持两个不同对象（对象及其代理）的接口同步？我知道 java 有一些反射特性，但我有点害怕接触它，因为我担心在 60Hz 游戏中每秒执行几千次反射查找会影响性能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T05:13:28.590

您可以使用代理类 ( [http://docs.oracle.com/javase/6/docs/api/java/lang/reflect/Proxy.html](http://docs.oracle.com/javase/6/docs/api/java/lang/reflect/Proxy.html) ) 来实现这一点。
在此处查看如何使用它的好教程[http://www.ibm.com/developerworks/java/library/j-jtp08305/index.html](http://www.ibm.com/developerworks/java/library/j-jtp08305/index.html)。

基本上你需要 RenderableProxy 来实现 InvocationHandler。
- 在 RenderableProxy 的 invoke() 方法中，将要调用的方法存储在内存中
- 向 RenderableProxy 添加一个新的 executeAll() 方法，该方法执行所有存储的方法调用
- 随意调用 executeAll() 方法。

# qt - 删除 MacPorts 后，新日期（“YYYY-MM-DD”）在 Qt WebKit 中停止工作

> ID：10098731
> 
> 赞同：5
> 
> 时间：2012-04-11T01:30:08.907
> 
> 标签：qt, webkit, macports, homebrew, phantomjs

在我的 OS X 10.7.3 (Lion) 笔记本电脑上，我无法使用 Date 构造函数使用 Qt WebKit 解析 JavaScript 日期字符串。使用 jasmine-headless-webkit 或 phantomJS，所有调用都像：

```
new Date("2012-04-10") 
```

总是回来

```
"Invalid Date" 
```

而不是有效的 Date 对象。几周前，一切正常，我已经在六台具有类似设置的计算机上进行了检查，并且无法在其他任何地方重现该问题。

我相当肯定，当我决定清理旧的据称未使用的 MacPorts 安装时，问题就开始了（我早就改用 Homebrew 并且正在做一些房屋清洁工作）。我怀疑有一个动态链接库已从我的系统中删除，Qt 将其用于日期解析。

有谁知道这个日期解析库可能被称为什么？知道我是否可以使用 Homebrew 安装它或以某种方式手动修复丢失的依赖项？

我尝试重新安装 Qt 和许多其他库，但没有解决问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T01:46:32.730

我没有 Mac，但考虑到 Windows 的类似情况，我会使用可以报告应用程序依赖项信息的程序，例如 Dependency Walker。快速搜索表明[该程序](http://code.google.com/p/macdependency/)可能对 Mac 世界有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T18:26:52.567

好的，我用 jasmine-headless-webkit 解决了日期解析的问题。不幸的是，我对此不够科学，所以我不确定是什么修复了它。可能是以下部分或全部过程：

1.  从 /Library/Frameworks/Qt* 和自制软件（/usr/local/Qt* 和 /usr/local/Cellar/qt*）中删除所有 Qt 痕迹
2.  [从http://qt.nokia.com/downloads/](http://qt.nokia.com/downloads/)重新安装 Qt 库（库，而不是顶部的 SDK）
3.  通过“brew update”更新自制软件
4.  冲泡安装qt

此外，我安装了 Qt SDK 和 XCode 4.3，但我认为这并没有解决它，因为我的同事没有安装这些东西，也没有遇到和我一样的问题。

这可能与 MacPorts 无关，但可能与我的旧 Qt 4.7 安装有关。我现在正在运行 Qt 4.8。

对不起所有的噪音！也许这个信息会帮助别人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-16T18:20:29.397

我有这个错误，我假设与 QtWebKit 有关，但是在使用 wicked_pdf 时。很难找出跨操作系统对 wkhtmltopdf 和 qtwebkit 的依赖关系（我在 dev 中运行 OSX，有时在 dev 中运行 Ubuntu，我们部署到 Heroku，但可能很快会部署到其他平台），所以我也使用了一种解决方法。我使用 moment.js 新建一个 Date 对象，一切正常。我还没有时间深入了解它是如何工作的，但我的猜测是，moment.js 通过测试浏览器支持将“YYYY-MM-DD”转换为日期对象很聪明。

当您不想关心您的代码在哪个操作系统中运行并且可以负担得起包含 moment.js 库时，这实际上是一个非常好的解决方法。这样您就不必关心运行的是哪个 WebKit。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T22:46:20.477

根据问题 187“PhantomJS 似乎在 ISO8601 日期格式上中断”，看起来这个 bug 将在 v1.8 中修复：

[http://code.google.com/p/phantomjs/issues/detail?id=187](http://code.google.com/p/phantomjs/issues/detail?id=187)

同时，该错误报告的解决方法是将“T00:00:00Z”附加到您的日期。

# python - PyPNG 读取 48 位，更改像素颜色，写回像素

> ID：10098733
> 
> 赞同：-1
> 
> 时间：2012-04-11T01:30:12.943
> 
> 标签：python, png, pixel, pypng

我想知道是否有人可以发布一个使用 PyPNG 读取 48 位图像（16 位通道 R、G 和 B）的示例，获取并显示特定的像素颜色（例如像素 88 或其他），更改该值，然后把它写回png。我发现文档非常稀疏，任何帮助将不胜感激。

```
def readPNG2(f):
    r=png.Reader(f)
    r.read()
    print r.bitdepth 
```

这会产生 16 个结果。我将图像从 Photoshop 中保存为每个通道 16 个（48 位）。我错过了什么，这实际上是在说每个通道 16 位吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T20:53:30.170

是的，这意味着每个通道 16 位。每像素 16 或 15 位已成为过去。该文档解释了如何将[16bpc 加载到 numpy 数组](http://packages.python.org/pypng/ex.html#png-to-numpy-array-reading)中。

PyPNG 的 API 似乎非常低级，距离直接使用 C 中的 libpng 仅一步之遥。（有关更多信息，请参阅[libpng 手册](http://www.libpng.org/pub/png/libpng-manual.txt)。对于 python 应用程序，这是一个选项，例如 MyPaint[通过swig 扩展名](https://gitorious.org/mypaint/mypaint/blobs/master/lib/fastpng.hpp)。）

# javascript - Javascript 提取评论 RegExp

> ID：10098738
> 
> 赞同：2
> 
> 时间：2012-04-11T01:31:02.367
> 
> 标签：javascript, regex, comments, extract

我有一个这样的Javascript文件

```
/**
 * My Comment Line1
 * My Comment Line2
 */
var a = 123;
/**
 * My Comment Line3
 * My Comment Line4
 */
var b = 456; 
```

我正在使用 node.js 来读取文件并想在这个文件中提取注释。

我使用这个正则表达式

```
/\/\*\*((?:\r|\n|.)*)\*\// 
```

然而，这提取

```
/**
 * My Comment Line1
 * My Comment Line2
 */
var a = 123;
/**
 * My Comment Line3
 * My Comment Line4
 */ 
```

我的程序有一个循环来逐个提取匹配的块。所以我想要一个正则表达式来提取

第一个循环

```
/**
 * My Comment Line1
 * My Comment Line2
 */ 
```

第二循环

```
/**
 * My Comment Line3
 * My Comment Line4
 */ 
```

规则很简单，注释块以 . 开头`/**`和结尾`*/`。在评论中，允许使用所有字符。

有人可以帮我吗？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-11T01:33:36.943

**试试这个：（**它会有很多任何类型的评论） - 现场演示：[http ://regexr.com?30jrh](http://regexr.com?30jrh)

```
(/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+/)|(//.*) 
```

**看一看 ：**

![在此处输入图像描述](../Images/0c9a19a632855cbed566e686eab838fa.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T01:33:27.393

这是一个正则表达式：

```
/\/\*\*(.|\n)+?\*\// 
```

[这是一个演示。](http://jsfiddle.net/minitech/4PEUc/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-20T19:46:27.373

其他答案对我来说不太管用。这是在 Node.js 中解析 Javascript 的方法。

```
/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(\/\/.*)/g 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-20T23:27:27.830

```
/(\/\*).*?(\*\/)|(\/\/).*?(\n|\$)/s 
```

匹配开始和结束多行标签以及介于两者之间的任何内容

```
(\/\*).*?(\*\/) 
```

或匹配以新行或行尾终止的单行打开注释

```
(\/\/).*?(\n|\$) 
```

# ruby-on-rails - rails 3.1.3：尝试在生产中本地运行，资产管道不起作用

> ID：10098743
> 
> 赞同：29
> 
> 时间：2012-04-11T01:31:36.180
> 
> 标签：ruby-on-rails, asset-pipeline

我的应用程序在开发模式下运行良好。

当我在生产模式下运行时`RAILS_ENV=production rails s`，我没有加载任何 .css 或 .js 文件。（我做了预编译资产，使用`RAILS_ENV=production bundle exec rake assets:precompile`。）

webrick 日志显示：

ActionController::RoutingError (没有路由匹配 [GET] "/assets/application-a73ce43be7bf75953cd0c60b2b4a7eb0.js"):

和

ActionController::RoutingError (没有路由匹配 [GET] "/assets/application-986dd79830088c416c1632c12999ec69.css"):

这些文件已编译（根据 log\production.log 文件），我的 public/assets 目录确实显示了那些带有和不带指纹的文件：

```
ls public/assets
application-986dd79830088c416c1632c12999ec69.css
application-986dd79830088c416c1632c12999ec69.css.gz
application-a73ce43be7bf75953cd0c60b2b4a7eb0.js
application-a73ce43be7bf75953cd0c60b2b4a7eb0.js.gz
application.css
application.css.gz
application.js
application.js.gz 
```

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-04-11T02:54:06.990

默认情况下，Rails 不会在生产模式下提供静态资源。如果您想禁用此功能并提供静态资产，请使用以下内容更新您的`config/environments/production.rb`文件：

```
config.serve_static_assets = true 
```

Rails 的默认配置背后的原因是它假设您将在生产模式（Apache、Nginx 等）的标准 Web 服务器后面运行，然后它将请求代理到您的 Rails 应用程序。由于资产是预编译的，Apache/Nginx/etc. 可以直接为它们提供服务，而无需与您的 Rails 进程对话。

# ruby-on-rails - 非法 XML 字符主干.js 模板

> ID：10098746
> 
> 赞同：0
> 
> 时间：2012-04-11T01:31:54.763
> 
> 标签：ruby-on-rails, xml, templates, backbone.js

我有一个 rails 项目，我在其中读取了一个模板文件，在 javascript 控制台中我收到以下错误：

```
illegal XML character
appointment_show.js?body=1()appoin...?body=1 (line 2)
[Break On This Error] this.JST["appointments/show"] = <%= topic %>; 
```

这是我正在使用的当前 Backbone 视图：

```
window.AppointmentView = Backbone.View.extend({
    template: JST["appointments/show"],

    render: function(){
        this.$el.html(this.template(this.model.toJSON()));
        return this;
    }
}); 
```

这是我的 app/assets/templates/appointments/show.jst 文件

```
<%= topic %> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T01:37:53.167

我所要做的就是将我的 app/assets/templates/appointments/show.jst 重命名为 show.jst.ejs

# iphone - 旋转的 UIImageView touchLocationInView 不正确

> ID：10098747
> 
> 赞同：0
> 
> 时间：2012-04-11T01:32:07.503
> 
> 标签：iphone, uiimageview, location, tap

我有一个`UIImageView`，当我触摸它时，我可以通过以下方式获得触摸的位置：

```
[touch locationInView:theUIImageView] 
```

问题是当我旋转 UIImageView 时：

```
theUIImageView.transform = CGAffineTransformMakeRotation(DegreesToRadians(arc4random()%15)); 
```

`[touch locationInView:theUIImageView]`不再返回水龙头的正确位置！*喘气！

关于如何获得的任何建议`real tap location`？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-11T01:41:49.130

选择要在 locationInView 中使用的不同（可能是父级，未旋转的）视图。如果你需要一个不同的坐标系，你总是可以在旋转之前根据 UIImageView 的框架添加自己的偏移量。

# regex - 仅打印具有特定列的行而不是 *

> ID：10098756
> 
> 赞同：0
> 
> 时间：2012-04-11T01:33:05.910
> 
> 标签：regex, perl, bash, awk

我有一个将文本发送到标准输出的程序。但我只想保留第五列不是“*”的那些行。那是星号字符，而不是捕获所有内容的正则表达式。我似乎无法为此使用转义，我已经尝试过

```
./a.out |awk '$5!=* {print}'
awk: $5!=* {print}
awk:     ^ syntax error
./a.out |awk '$5!=\* {print}'
awk: $5!=\* {print}
awk:     ^ backslash not last character on line 
```

awk 当然不是必需的，但我认为这将是最简单的。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T01:34:58.240

`awk`类似于大多数 Algol/C 系列语言；文字字符串需要字符串引号。

```
awk '$5 != "*" {print}' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T01:39:38.813

试试这个：

```
awk '$5!="*"{print}' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-11T01:41:02.657

在 Perl 中：

```
perl -ane 'print unless $F[4] eq q(*)' file 
```

`-n`开关将此循环包装在您的脚本周围，以读取命令行上的文件名参数：

```
LINE:
while (<>) {
    ... # your script here
} 
```

将`-a`行（在空格上）自动拆分为一个名为`@F. Unlike`awk 的预先声明的数组，$F[0] 只是第一个字段。

`-e`参数只是你的脚本。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-11T04:55:46.920

这可能对您有用：

```
awk '$5 !~ /^[*]$/' file 
```

# python - 将 cmp 函数或键函数传递给 python 2.7 中的 Set 差异（或其他集合操作）

> ID：10098761
> 
> 赞同：1
> 
> 时间：2012-04-11T01:33:41.797
> 
> 标签：python, set

我需要在 python 元组中做一个集合差异，但是差异需要考虑我的元组的第一个元素。

为了实现这一点，我（不成功地）使用了此类方法

```
class Filedata(object):
    def __init__(self, filename, path):
        self.filename = filename
        self.path = path + '\\' + filename
    def __eq__(self, other):
        return self.filename==other.filename
    def __ne__(self, other):
        return self.filename!=other.filename
    def __call__(self):
        return self.filename
    def __repr__(self):
        return self.filename 
```

在 sets.py 模块中挖掘我发现该库使用 itertools.ifilterfalse 函数来产生差异

```
def difference(self, other):
    """Return the difference of two sets as a new Set.

    (I.e. all elements that are in this set and not in the other.)
    """
    result = self.__class__()
    data = result._data
    try:
        otherdata = other._data
    except AttributeError:
        otherdata = Set(other)._data
    value = True
    for elt in ifilterfalse(otherdata.__contains__, self):
        data[elt] = value
    return result 
```

但是我无法对此做任何有用的事情。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T01:35:08.593

唯一的方法是定义你自己的序列类，它只使用`__eq__()`and中的第一个元素`__hash__()`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T03:12:08.850

有点晚了，但这里有一个替代方案。它将保留 Set 和 dict 的所有方法。尝试这个：

```
from sets import Set
from itertools import ifilterfalse

class MyDict(dict):
    custom_list = None
    def contains(self, a):
        if not self.custom_list:
            self.custom_list = [key[0] for key in self]
        return a[0] in self.custom_list

    def update_by_dict(self, _dict):
        for key in _dict:
            self[key] = _dict[key]

class MySet(Set):
    def diff_by_first_item(self, other):
        result = self.__class__()
        data = result._data
        try:
            otherdata = other._data
        except AttributeError:
            otherdata = Set(other)._data
        yetanother = MyDict()
        yetanother.update_by_dict(otherdata)
        value = True
        for elt in ifilterfalse(yetanother.contains, self):
            data[elt] = value
        return result

if __name__ == "__main__":
    a = [(0, 'a'), (1, 'b'), (2, 'c')]
    b = [(1, 'c')]
    print MySet(a).diff_by_first_item(b)
    print MySet(a).diff_by_first_item(MySet(b))
    print MySet(a).diff_by_first_item(set(b)) 
```

# javascript - Kendo UI 数据模板 - 如何创建主容器并将模板加载到其中？

> ID：10098763
> 
> 赞同：1
> 
> 时间：2012-04-11T01:35:03.087
> 
> 标签：javascript, jquery, kendo-ui

我试图让这个例子超级（愚蠢）简单，只是为了确保我把这个概念具体化。

假设我有两个这样的剑道视图模型：

```
var usersViewModel = kendo.observable({
    name: "Billy Bob",
    address: "123 Maple St",

});

var postsViewModel = kendo.observable({
    title: "Cool stuff",
    content: "Here is some cool content"

});

kendo.bind($("#users-template"), usersViewModel);
kendo.bind($("#posts-template"), postsViewModel); 
```

（**注意：** 我可能错误地应用了这些绑定 - 如果有更好的方法，请随时告诉我。）

以及将使用这些视图模型的模板：

```
<script id="users-template" type="text/x-kendo-template">
    <tr>
        <td data-bind="text: name"></td>       
        <td data-bind="text: address"></td> 
    </tr>
</script>

<script id="posts-template" type="text/x-kendo-template">
    <tr>
        <td data-bind="text: title"></td>       
        <td data-bind="text: content"></td> 
    </tr>
</script> 
```

好的，现在是棘手的部分......

我想要一个充当“主视图”的 div 容器。这个 div 将是应用程序索引页面上的第一项，所有其他模板都将加载到其中。像这样的东西：

```
<div id="main-content"></div> 
```

左侧会有一个子导航，由无序列表和列表项标签组成。单击列表项时 - 我计划使用 JQuery 清除“主要内容” div 的内容，并使用单击的相应导航元素的模板填充它。

我尝试使用这个：

```
var container = $("#main-content");
container.empty();
container.html("#users-template"); 
```

但是，这不起作用。根据 Kendo 网站，模板是用一个“数据模板”属性指定的，如下所示 `data-template="users-template"`：在 javascript 中使用此属性似乎也不起作用。

**基本上，我正在尝试重新创建他们的示例： [http](http://demos.kendoui.com/web/mvvm/source.html) ://demos.kendoui.c​​om/web/mvvm/source.html 但是......从模板加载到的空白 div 开始。**

我之前用 Backbone.js 创建了类似的界面元素，而且非常轻松。我只是想知道使用剑道的最佳方法。

任何意见，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T07:43:20.090

似乎 Kendo 并不真正支持绑定到脚本标签内的标签。这是一个（有点粗略的）JSFiddle，说明了这种行为：http: [//jsfiddle.net/9tcav/28/](http://jsfiddle.net/9tcav/28/)

当标签仍在脚本标签内时，当我将可观察对象绑定到 tr-tag 时，标签的内容永远不会改变。

但是，如果我实例化模板，将其插入 main-content-div，*然后*将数据绑定到生成的*渲染*模板，一切正常。

您的数据是否需要动态更改？如果不是，如果可能只是使用直接模板，没有可观察的对象，来呈现数据：

```
var template = kendo.template($("#template").html());
$("#main-content").html(template({title: "Title", content: "Content"})); 
```

如果您的数据确实必须动态更改 - 不仅在单击导航链接和实例化视图时 - 那么您首先呈现模板*然后*绑定数据。

# multithreading - ios 5 可以让您的应用程序在后台运行以获取数据吗？

> ID：10098766
> 
> 赞同：0
> 
> 时间：2012-04-11T01:36:00.517
> 
> 标签：multithreading, ios5

使用 iOS 5，即使用户切换到另一个应用程序，是否可以让应用程序在后台运行？我希望我的应用程序继续获取数据，如果数据已更改以通知用户。

这可能吗？或者它仍然一次只有一个应用程序处于活动状态并且后台的所有应用程序都被暂停？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T01:58:25.770

根据 iOS 开发人员库中关于多任务处理的文档，只允许特定应用程序在后台运行。

1.  在后台播放有声内容的应用程序。
2.  让用户随时了解其位置的应用程序。
3.  支持 VoIP 的应用程序。
4.  需要下载和处理新内容的报亭应用。
5.  从外部配件（例如蓝牙）接收定期更新的应用程序。

如果您的申请不符合这些要求，则不允许。

关于在后台执行的操作也有各种规则。

因此，我希望它可以快速切换，但如果您在后台运行，则可以运行多个应用程序，但有严格的限制和要求。

# node.js - 关于节点错误的 Graphics Magick

> ID：10098768
> 
> 赞同：0
> 
> 时间：2012-04-11T01:36:15.150
> 
> 标签：node.js, graphicsmagick

我在 Windows 中运行 nodejs 并使用 npm 安装 gm。

`var readStream = fs.createReadStream(__dirname + '/../temp/a.jpg'); gm(readStream, 'a.jpg').write(__dirname + '/../temp/b.png', function (err) {if (err) console.log(err);});`

然后我得到了味精：

`{ [Error: Command failed: CreateProcessW: ϵͳ�Ҳ���ָ�����ļ���] code: 127, signal: null }`

gm 是否支持 windows 或我该如何处理？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-27T04:37:32.573

将 GraphicsMagick 安装目录放在 PATH 环境变量中为我解决了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T21:34:48.673

您需要先安装 GraphicsMagick (http://www.graphicsmagick.org/)。然后：

```
npm install gm 
```

# algorithm - 用于创建 LaTeX 以外的伪代码的工具

> ID：10098769
> 
> 赞同：0
> 
> 时间：2012-04-11T01:36:18.187
> 
> 标签：algorithm, pseudocode

除了 LaTeX 之外，你知道制作漂亮伪代码的好工具吗？想创建自己的，但想看看是否已经存在其他很棒的工具。

# php - 为什么我必须再次舍入这个值？

> ID：10098775
> 
> 赞同：0
> 
> 时间：2012-04-11T01:37:32.487
> 
> 标签：php, ajax

随着数量的增加，我正在使用 ajax 来生成书籍的价格。我遇到的唯一问题是当我尝试生成总计时（参见 JS 代码），它导致了一些问题（值将连接而不是相加）。我通过四舍五入变量“数量”解决了这个问题。但我试图理解为什么会发生连接。这是我的 PHP 代码：

```
if(isset($_GET["amount1"]) )
{
    $amount1 = $_GET["amount1"];

    $error="";

    if($amount1 == "" || !preg_match("/^[0-9]+$/", $amount1))
    {
        $error .= "Please enter a valid number";
        echo $error;
    }
    else{
        echo round($amount1*16.65, 2);
    }
} 
```

这是JS代码：

```
 if(xhr.status == 200 && xhr.readyState == 4)
      {
        var res = xhr.responseText;

        if(res.match(/\d+/)== null){
            document.getElementById("err3").innerHTML = res;
            document.getElementById("book3").innerHTML = "";
            total(0,3);
        }

        else{
            document.getElementById("book3").innerHTML = res;
            document.getElementById("err3").innerHTML = "";
            total(res,3);
          }
      }

var book1 = 0;
var book2 = 0;
var book3 = 0;

function total(amount, book)
{   
// amount = Math.round(amount*100)/100; --> this is what solved it but I don't    
 //know why I need it since amount was rounded by PHP code
if( book == 1)
    book1 = amount;

if( book == 2)
    book2 = amount;

if( book == 3)
    book3 = amount;

var total = book1 + book2 + book3;

document.getElementById("total").innerHTML = total;

} 
```

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T01:39:12.820

`res`是文本。使用前将其转换为数字。

```
js> parseFloat("3.14")
3.14 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T04:49:27.040

它连接的原因是因为`+`运算符用于字符串连接和添加，这让我抓狂。但更具体地说，这是因为在没有某种包装（json 或 xml）的情况下输入到输入字段或从服务器传递到浏览器的值总是由 javascript 处理为字符串，并且与 PHP 不同，javascript 不支持类型杂耍（至少不在数字和字符串之间）。

由于这是通过 ajax 从 php 发回的，并且由于 php 正在处理数字验证，因此您实际上只需要以 json 格式返回值并更新 javascript 以使用返回的对象，如下所示：

首先，PHP，对验证稍作调整：

```
// 1\. Using ctype_digit function to confirm value is >= 0\. Much faster than regex
// 2\. No need to round, as integer * float is always same or less precision, and
//    PHP sets product to appropriate numeric type.
// 3\. Pushing values into array for json encoding
// 4\. Setting both values (empty if invalid) so that javascript can easily confirm
//    response.
// 5\. Updated Error, as negative numbers and floats are valid, 
//    just not in this case

$amount1 = $_GET["amount1"]);
$response["amount1"] = (ctype_digit($amount1)) ? $amount1 * 16.65 : "";
$response["error"] = (ctype_digit($amount1)) ? "" : "Please enter a valid quantity";

echo json_encode($response); 
```

现在，javascript 必须将响应字符串反序列化为一个对象，使用`eval()`，并获取总数和诸如此类：

javascript（再次，一些小的调整，这次没有注释）

```
if(xhr.status == 200 && xhr.readyState == 4)
{
    var res = eval("(" + xhr.responseText + ")"); 

    amount1 = (!isNaN(res.amount1)) ? res.amount1 : "";     

    document.getElementById("err3").innerHTML = res.error;
    document.getElementById("book3").innerHTML = res.amount1;
    document.getElementById("total").innerHTML = total(Number(res.amount1),3);
}

var book1 = 0;
var book2 = 0;
var book3 = 0;

function total(amount, book)
{
switch (book) {
   case 1:
      book1 = amount;
      break;
   case 2:
      book2 = amount;
      break;
   case 3:
      book3 = amount;
      break;
}

return book1 + book2 + book3;
} 
```

现在，您可能会注意到，当我最终将 amount1 值传递给`total`函数时，我实际上将其包装在`Number()`函数中，这几乎解决了不使用 JSON 的问题。理论上，我不需要这样做，如果 PHP 总是返回一个数值。尽管如此，我还是将其转换为 Number 类型的原因如下：

1.  因为 js 不对数字进行类型处理，所以这只是一个好主意。你永远不知道 PHP 在糟糕的一天会返回什么，并且验证应该在通信的两端进行。

2.  这允许 PHP 为该值返回一个空字符串，您可以将其输出给用户，然后`Number()`将空字符串设置`0`为 total 函数。

3.  如果您决定跳过 ajax 方法并在浏览器端进行定价计算，则必须始终使用 转换值`Number()`，因此在处理来自任何外部来源的数值时，这是一个好习惯（尽管很烦人） .

我将在几篇文章中发布一个 jsfiddle，其中包含我将如何实现您的总体目标的最终版本，您可以忽略或窃取，我只是觉得可以这样做。

# css - AddThis 如何更改图标上的图像

> ID：10098779
> 
> 赞同：2
> 
> 时间：2012-04-11T01:38:15.813
> 
> 标签：css, add-in

所以我有以下标记

```
 <div class="socialMediaPlugin">
                <div class="socialMediaLinks">
                 <label>Share this page</label>
                    <a class="addthis_button_facebook"></a>
                    <a class="addthis_button_twitter"></a>
                    <a class="addthis_button_google_plusone_share"></a>
                    <a class="addthis_button_pinterest_pinit"></a> 
                    <a class="addthis_button_email"></a>
                 </div>
            </div>

            <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid=ra-4f8448d935e2a296"></script> 
```

和CSS

```
 <style type="text/css">
    .socialMediaPlugin 
    {
        width: 738px;
        display: block;
        float: left;
    }

   .socialMediaLinks 
   {
        float: right;
        vertical-align:middle;
        border: 2px solid #DCDCDC;
        border-radius: 5px 5px 5px 5px;
        padding: 0px 0px 0px 10px;
        background-color: white;
    }
    .socialMediaLinks a
    {
        display: inline-block;
        padding: 3px;
        vertical-align:middle; 
    }
    .socialMediaPlugin label
    {
        display: inline-block;
        margin-right: 15px;
    }
</style> 
```

我想知道是否有人知道我可以如何更改社交媒体按钮上的图标？特别是对于 Pinterest，我想这样做。

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T03:13:48.057

```
<a class="addthis_button_pinterest_pinit">
  <img src="my_pintrest_icon.gif" width="16" height="16" border="0" alt="Share" />
</a> 
```

将 img src 更改为您想要的任何内容

[检查此](http://support.addthis.com/customer/portal/articles/381236-custom-buttons#.T4T2tjFlR5Y)以获取更多信息：

# object - 为对象和链接创建版本控制系统

> ID：10098786
> 
> 赞同：2
> 
> 时间：2012-04-11T01:39:08.363
> 
> 标签：object, version-control, hyperlink

我试图通过添加版本控制来为现有系统带来理智。问题是系统不能很好地转换为像布局这样的文件系统。经过几次思想实验后，我有了一种基本的方法来处理这个问题，但在我开始允许使用这个烂摊子之前，我想由集体来运行它。

该系统由类型化的对象和链接组成。对象通过链接表链接在一起以形成有意义的关系。链接也是类型化的对象，可以有自己的属性。

用户可以到达任何级别的对象视图，并沿着链接上下走动以查看关系。

大多数对象都有数百个到其他对象的链接。并非所有对象或链接都将受到版本控制，因为有些对象或链接可以被认为是静态的。允许有到非版本控制对象的版本控制链接。

对对象的更改以包含层次结构部分的整个布局的批处理形式到达，本身没有或很少有用户评论或版本信息。因此，通过将新对象与前一个对象进行比较来检测变化。也以这种方式检测链接更改。对象可以在一个版本中添加，在下一个版本中删除，并在下一个版本中再次添加。大多数物体都有足够的独特信息来检测这确实是同一个物体，它正在突然出现和消失。

未更改的对象和链接不应为单个对象创建新版本，但批量更新产生的整体内容仍应可识别为一个组。

95% 的用户只会对最新版本的对象/关系感兴趣，但我需要能够显示剩余 5% 的先前提交的对象/关系。

我最初的想法是为这批更改实现一个整体版本 uid，并将其与该迭代的所有当前对象/链接相关联。剩下的就等着拿了。如果你做到了这一步，谢谢你。想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T01:45:39.640

这听起来像你在描述一个（关系）数据库。您最喜欢的搜索引擎将为您提供一些关于如何进行数据库版本控制的想法的链接。

[SQL](http://www.red-gate.com/products/sql-development/sql-compare/learn-more/database-version-control)的两个[示例](http://www.users.on.net/~notzed/software/data-versioning.html)。

# javascript - For 循环返回未定义的变量

> ID：10098794
> 
> 赞同：1
> 
> 时间：2012-04-11T01:39:56.063
> 
> 标签：javascript, for-loop

```
var formobj = document.h1;
for (var j = 0; j < formobj.elements.length; j++) {
    if (formobj.elements[j].type == "radiobutton" && formobj.elements[j].checked) {
        var wholebase = formobj.elements[j].value;
    }
} 
```

稍后在脚本中，该变量设置为 div 的内部 html 并标记为未定义。我的 for 循环有缺陷吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T02:29:38.370

没有类型`radiobutton`，我想你想要`type == 'radio'`的。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-11T01:59:22.650

您的`wholesale`变量是在内部范围内定义的。离开此范围后，该变量将不再存在。[在此处](https://stackoverflow.com/questions/500431/javascript-variable-scope)或[此处](http://www.digital-web.com/articles/scope_in_javascript/)阅读有关 Javascript 范围的信息。您可以像这样更改代码：

```
var wholebase = null; //<-- declare the variable here
var formobj = document.h1;   
for (var j = 0; j < formobj.elements.length; j++){
        if (formobj.elements[j].type == "radiobutton" && formobj.elements[j].checked){
        wholebase = formobj.elements[j].value;
    }
} 
```

# php - 从复选框数组中插入数据库

> ID：10098796
> 
> 赞同：0
> 
> 时间：2012-04-11T01:39:59.217
> 
> 标签：php, mysql, html, checkbox, insert

我有一个包含复选框的表单。我将复选框命名为 stream[]，所以它是一个复选框数组。

如果选中，我想插入复选框值。

```
<p><input type="checkbox" name="stream[]" value="survey" id="svy"/>Survey</p>
                <p><input type="checkbox" name="stream[]" value="write_review" id="wr">Write Review</p>
                <p><input type="checkbox" name="stream[]" value="fb post" id="fbp">Facebook Post</p>. 
```

我怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T02:00:39.993

应该没那么难，看看这个[链接](http://www.html-form-guide.com/php-form/php-form-checkbox.html)和[这个](http://www.blog.highub.com/php/php-core/insert-checkbox-values-to-mysql-using-php/)。但基本思想是知道访问复选框的正确方法。以下是总体思路，为您做一些功课，以对下面的代码进行必要的更改以适应您的情况。

```
$streams = $_POST['stream'];
foreach ($streams as $stream) {
  if ($stream == $value)
  {
     // checked value.
  }
} 
```

# ruby-on-rails-3.1 - Formastic Bootstrap Rails 错误 - 没有这样的文件来加载 ButtonsHelpers

> ID：10098801
> 
> 赞同：6
> 
> 时间：2012-04-11T01:40:42.820
> 
> 标签：ruby-on-rails-3.1, twitter-bootstrap, formtastic

我完全陷入了这个错误。使用 Rails 3.1 尝试实现 Formastic Bootstrap gem 并出现错误：

**`': 没有要加载的文件 -- formtastic/helpers/buttons_helper (LoadError)**

**应用程序.css**

```
*= require formtastic
*= require formtastic-bootstrap 
```

**宝石文件**

```
group :assets do
  gem 'sass-rails', "  ~> 3.1.0"
  gem 'coffee-rails', "~> 3.1.0"
  gem 'uglifier'
  gem 'less-rails-bootstrap'
    gem 'bootstrap-sass'
end 
```

**formastic.rb**

```
Formtastic::Helpers::FormHelper.builder = FormtasticBootstrap::FormBuilder

gem 'formtastic'

gem 'formtastic-bootstrap' 
```

**button_helper**

```
module FormtasticBootstrap
  module Helpers
    module ButtonsHelper

      include Formtastic::Helpers::ButtonsHelper

      def buttons(*args, &block)

        html_options = args.extract_options!
        html_options[:class] ||= "actions"

        if html_options.has_key?(:name)
          ActiveSupport::Deprecation.warn('The :name option is not supported')
        end

        if block_given?
          template.content_tag(:div, html_options) do
            yield
          end          
        else
          args = [:commit] if args.empty?
          contents = args.map { |button_name| send(:"#{button_name}_button") }
          template.content_tag(:div, html_options.except(:builder, :parent, :name)) do
            Formtastic::Util.html_safe(contents.join)
          end
        end

      end

      def commit_button(*args)
        options = args.extract_options!
        text = options.delete(:label) || args.shift

        text = (localized_string(commit_button_i18n_key, text, :action, :model => commit_button_object_name) ||
                Formtastic::I18n.t(commit_button_i18n_key, :model => commit_button_object_name)) unless text.is_a?(::String)

        button_html = options.delete(:button_html) || {}
        button_html.merge!(:class => [button_html[:class], "btn commit", commit_button_i18n_key].compact.join(' '))

        # TODO We don't have a wrapper. Add deprecation message.
        # wrapper_html = options.delete(:wrapper_html) || {}
        # wrapper_html[:class] = (commit_button_wrapper_html_class << wrapper_html[:class]).flatten.compact.join(' ')

        accesskey = (options.delete(:accesskey) || default_commit_button_accesskey) unless button_html.has_key?(:accesskey)
        button_html = button_html.merge(:accesskey => accesskey) if accesskey

        Formtastic::Util.html_safe(submit(text, button_html))
      end

    end
  end
end 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-11T16:34:30.447

我有同样的问题。显然最新版本的formtastic 2.2.0（昨天推出）与formtastic-bootstrap不兼容

为此，您必须指定较早版本的 formtastic

只需在上面添加以下行`gem 'formtastic-bootstrap'`

```
gem 'formtastic', " ~> 2.1.1" 
```

它是formtastic 的早期版本。

# vba - VBA-范围内的变量，公式内

> ID：10098802
> 
> 赞同：2
> 
> 时间：2012-04-11T01:40:48.080
> 
> 标签：vba, variables

我有以下代码来计算一系列单元格中的最大值：

```
 Range("E3").Select
 ActiveCell.FormulaR1C1 = "=MAX(RC[-3]:R[50]C[-3])" 
```

如何在我的代码中用变量替换 50？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-11T01:46:37.080

你有没有试过这个：

```
Dim sVal as String
sVal = "50"
ActiveCell.FormulaR1C1 = "=MAX(RC[-3]:R[" & sVal & " ]C[-3])" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T01:45:16.590

像这样的东西：

```
Dim somevar as Integer
somevar = 50
ActiveCell.FormulaR1C1 = "=MAX(RC[-3]:R[" + somevar + "]C[-3])" 
```

# ruby-on-rails - Rails 3 从单个模型和方法创建多个记录条目

> ID：10098805
> 
> 赞同：0
> 
> 时间：2012-04-11T01:40:58.567
> 
> 标签：ruby-on-rails, arrays, forms, view, controller

我已经做了一天多了，我希望有人可以帮助我。我是 ruby​​/rails 的新手，我想我已经接近了。

我有一个视图，而您可以输入有关公寓的基本信息，例如单元号、费率（如果已启用）。然后，您可以输入要创建的公寓数量。此信息被放入会话变量中，并显示预览表单。例如，如果您输入 5 作为您想要创建的公寓数量，您将在表格中获得 5 行，每行都有一个标题为 Unit Number、Rate 和 Enabled。然后，您可以根据需要对任何单个公寓进行修改，然后单击“保存”。

/app/models/apartment.rb

```
def preview
  @count = session['count'].to_i
    @mktg_apartment = []
    1.upto(@count) do |i|
    @mktg_apartment[i] = Apartment.new
    @mktg_apartment[i].rate = session['tmp_rate']
    @mktg_apartment[i].enabled = true
  end
end 
```

/app/views/preview.html.haml

```
=form_for @mktg_apartment, :url => {:action => 'save_preview', :method => 'post'} do
  - 1.upto(@count) do |x|
    text_field "mktg_apartment[#{x}]", :unit
    text_field "mktg_apartment[#{x}]", :rate
    text_field "mktg_apartment[#{x}]", :enabled 
```

我还没有真正创建我的保存方法。我会拿出我所拥有的，在某一时刻它只会保存最后输入的记录，但我知道此时这一切都是错误的。

/app/model/apartment.rb

```
def save_preview
  @mktg_apartment = Mktg::Apartment.new(params[:mktg_apartment])
  respond_to do |format|
    if @mktg_apartment.save
      format.html { redirect_to mktg_apartments_path }
    else
      format.html { render action: "preview" }
    end
  end
end 
```

在我的 preview.html.haml 表单中，我转储了 @mktg_apartment 并看到以下内容：

```
[nil, #<Mktg::Apartment id: nil, created_at: nil, updated_at: nil, unit: nil, rate: 1222.0, enabled: true>, 
#<Mktg::Apartment id: nil, created_at: nil, updated_at: nil, unit: nil, rate: 1222.0, enabled: true>,
#<Mktg::Apartment id: nil, created_at: nil, updated_at: nil, unit: nil, rate: 1222.0, enabled: true>,
#<Mktg::Apartment id: nil, created_at: nil, updated_at: nil, unit: nil, rate: 1222.0, enabled: true>,
#<Mktg::Apartment id: nil, created_at: nil, updated_at: nil, unit: nil, rate: 1222.0, enabled: true>] 
```

当我点击保存错误时，我看到以下参数被传递到我的帖子表单：

```
{"utf8"=>"✓",
"authenticity_token"=>"iGLdu/ZmulcLp4xZEU4a4iuxWV1opzNIyXcnZEQCtj8=",
"mktg_apartment"=>{"1"=>{"unit"=>"",
"rate"=>"",
"enabled"=>"0"},
"2"=>{"unit"=>"",
"rate"=>"",
"enabled"=>"0"},
"3"=>{"unit"=>"",
"rate"=>"",
"enabled"=>"0"},
"4"=>{"unit"=>"",
"rate"=>"",
"enabled"=>"0"},
"5"=>{"unit"=>"",
"rate"=>"",
"enabled"=>"0"}},
"commit"=>"Save",
"method"=>"post"} 
```

所以看起来我在我的预览方法中设置的@mktg_apartment 数组在我的预览视图中没有被正确访问。它实际上看起来像我的预览视图正在将参数传递给我期望的 save_preview post 方法。

请任何帮助，我正在用头撞墙。谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T02:03:05.323

我会使用嵌套形式。将单位拆分成一个单独的模型，并有类似地块（block）的东西有很多单位。然后，您可以使用复杂的表格输入所有信息。

参考：[http ://railscasts.com/episodes/196-nested-model-form-part-1](http://railscasts.com/episodes/196-nested-model-form-part-1)

块模型可以保存整个块的大小，而单元模型可以保存有关特定单元的详细信息。

# javascript - Meteor JS 框架是否与 Google App Engine 兼容？

> ID：10098813
> 
> 赞同：8
> 
> 时间：2012-04-11T01:42:09.400
> 
> 标签：javascript, google-app-engine, node.js, meteor

是否可以`Meteor`在 Google App Engine 上构建和部署应用程序，或者这些技术不兼容？

例如，我知道这`Node.js`与 App Engine 不兼容，而 Meteor 在某些方面似乎与 Node 相似。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-11T02:15:34.853

Meteor 创建 Node.js 应用程序。Google App Engine 没有 JavaScript 运行时，但它有（截至 2013 年 12 月的测试版），[可以运行 Node.js的](https://stackoverflow.com/questions/12450321/why-is-javascript-node-js-not-on-google-app-engine/24427331#24427331)[*托管 VM*](https://stackoverflow.com/questions/12450321/why-is-javascript-node-js-not-on-google-app-engine/24427331#24427331)。

[Google *Compute* Engine（不是 App Engine）](https://stackoverflow.com/questions/22697049/what-is-the-difference-between-google-app-engine-and-google-compute-engine)支持 MEAN 堆栈（Mongo、Express、Angular、Node.js），因此您可以在 GCE 上运行 Meteor。

![谷歌应用引擎截图](../Images/e67b7e725a088fbe3ad0bf67be1c6b3c.png)

* * *

*旧答案*

Meteor 依赖于 node.js，因此在 GAE 支持 node.js（如果有的话）之前不会在 GAE 上运行。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-27T08:24:36.133

Meteor 在 Google Compute Engine (GCE) 中运行，我们使用正常的安装过程将它安装在 GCE vm 上并且运行良好。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-11T10:20:41.970

更好的选择是[Heroku](http://www.heroku.com/)。他们有一个可用的 Node 运行时，并且应该给你类似于 GAE 的体验。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-04-18T03:40:28.853

谷歌确实支持 nodejs。是的，是的。从这里开始：[https ://developers.google.com/datastore/docs/getstarted/start_nodejs/](https://developers.google.com/datastore/docs/getstarted/start_nodejs/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-11T02:15:00.280

我很确定流星依赖于 node.js。我似乎记得在介绍性截屏视频中提到“能够在任何可用 node.js 的地方部署”。

# javascript - 变量设置/定义问题？

> ID：10098816
> 
> 赞同：0
> 
> 时间：2012-04-11T01:42:59.250
> 
> 标签：javascript, jquery, html, forum, mybb

我正在使用一个论坛软件，您可以使用以下方法拉出头像链接：{$mybb->user['avatar']}

如果没有设置头像，则不返回任何内容。如果没有设置头像，我想显示图像。

目前 HTML 设置如下：

```
 <div id="avatar"><div style="background: url({$mybb->user['avatar']}) center center no-repeat;"></div></div> 
```

外部 div 是空的并且在背景中。这个也是我要添加的一个类（.defaultavatar），以便显示默认头像。

内部 div 是显示头像的 div。如果没有上传/选择头像，则它将显示为空白。

这是我正在使用的 javascript：

```
 var myavatar = {$mybb->user['avatar']};

    if(typeof(myavatar) = null){ 
        jQuery('#avatar').addClass('defaultavatar');
    } 
```

如果头像 URL 为空，我希望将类 defaultavatar 添加到第一个 div。

我该怎么做（让它工作）？

非常感谢，杰克克拉克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T01:54:50.710

在您的`if`情况下，语法有问题。单等号是赋值。

至少改变这个

```
if(typeof(myavatar) = null) 
```

到

```
if (typeof myavatar == 'undefined') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T02:26:34.690

根据`{$mybb->user['avatar']`返回的内容，这样做可能就足够了：

```
if (myavatar) {
  // do stuff
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-11T03:05:19.287

`undefined`在javascript中有两种含义。我不确定它们的确切名称是什么，在我的示例中，我将它们称为未定义且真正未定义。

`undefined`当您尝试从已声明但未初始化的内容中获取值时，您会得到常规。换句话说，解释器知道你在说什么，但那个东西还没有价值。

您可以使用简单的 if 语句将变量转换为布尔值，以检查它是否是这种类型的`undefined`. 请注意，此转换也会将空字符串`''`和数字`0`转换`false`为。如果您还需要考虑空字符串和数字`0`，请改用`myDeclaredVariable === undefined`for 条件。

```
if (myDeclaredVariable) {
    // myDeclaredVariable is initialized with a "truthy" value
} else {
    // myDeclaredVariable is either uninitialized or has a "falsey" value
} 
```

`undefined`当您尝试访问一个随机变量而不声明它时，您会得到真正的结果。解释器不知道你在说什么，如果你试图用它做任何事情，它会抛出一个 javascript 异常。要处理这种情况，您需要使用[`typeof`operator](https://developer.mozilla.org/en/JavaScript/Reference/Operators/typeof)。

```
if (typeof myPossiblyDeclaredVariable !== 'undefined') {
    // myPossiblyDeclaredVariable has been declared
} else {
    // myPossiblyDeclaredVariable has not been declared yet
} 
```

[您可以在此处](https://stackoverflow.com/questions/3390396/best-way-to-check-for-undefined-in-javascript/3390426#3390426)查看相关的 StackOverflow 问题。

# php - 为什么 memcache->get() 只从数据库中检索第一行？

> ID：10098817
> 
> 赞同：1
> 
> 时间：2012-04-11T01:43:05.460
> 
> 标签：php, mysql, memcached

只是第一次玩 memcache；这是我的代码：

```
 $memcache = new Memcache();
    $memcache->connect('127.0.0.1', 11211) or die('Memcache connection error');

    // set the key then check the cache
    $key = md5(' SELECT * FROM `users` ');
    $get_result = $memcache->get($key);

    if($get_result) {
        echo "Data Pulled From Cache";
        var_dump($get_result);
    }
    else {
        $query = ' SELECT * FROM `users` ';
        $result = mysql_query($query);
        $row = mysql_fetch_assoc($result);
        $memcache->set($key, $row, TRUE, 20); // stored for 20 seconds

        echo "Data Pulled from the Database";
        var_dump($row);
    } 
```

我的用户表中有 50,000 个虚拟用户，为什么 var 转储只显示第一个用户？如您所见，查询中没有限制子句。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T01:46:12.960

您只从`$result`资源中获取一行。如果你想要一个完整的行集，你需要在一个`while`循环中获取每一行并将它们附加到一个数组中：

```
 $rowset = array();
  while($row = mysql_fetch_assoc($result)) {
    // Fetch all rows in loop, appending each onto $rowset
    $rowset[] = $row;
  }
  // Store $rowset into memcache
  $memcache->set($key, $rowset, TRUE, 20); // stored for 20 seconds 
```

# javascript - jQuery 1.7 .on() 事件委托不适用于禁用元素上的选择器

> ID：10098824
> 
> 赞同：2
> 
> 时间：2012-04-11T01:44:25.313
> 
> 标签：javascript, jquery, jquery-events, event-delegation

我的 HTML（非动态）如下所示：

```
<select id="domain" class="marketplace">
  <option>United States</option>
  ...
</select> 
```

这有效：

```
$("#domain").on("change", function() {
  $("#domain").attr("disabled", "disabled");
  /* do ajaxy stuff */
  $("#domain").removeAttr("disabled");
});
$("select.marketplace").on("change", function() { /* do some general stuff */}); 
```

这不会：

```
$("#domain").on("change", function() {
  $("#domain").attr("disabled", "disabled");
  /* do ajaxy stuff */
  $("#domain").removeAttr("disabled");
});
$(document).on("change", "select.marketplace", function() { /* do some general stuff */}); 
```

删除`$("#domain").attr("disabled", "disabled");`调用会恢复`$(document).on()`委托的功能，因此当元素被禁用时，事件似乎不会冒泡，无论事件是如何触发的（即既不是通过`.trigger`也不`.triggerHandler`是通过用户交互）。但是，我不明白为什么，因为处理程序都没有返回任何内容或进行任何调用以防止事件传播，并且 jQuery 文档没有提到“禁用”属性对传播有任何影响。我在这里想念什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-03-02T19:58:25.160

只是为了重现您的问题，我创建了以下代码段（Click Me 按钮用于触发更改事件，只是为了获得完整的演示）：

```
$(document).on("change", "select.marketplace", function (e) {
  $('#result').append('<p>$(document).on("change", "select.marketplace", function (e) {: This does not work!<p/>');
});
$(function () {
  $("#domain").on("change", function () {
    $("#domain").attr("disabled", "disabled");
    /* do ajaxy stuff */
    //$("#domain").removeAttr("disabled");
  });
  $("select.marketplace").on("change", function (e) {
    $('#result').append('<p>$("select.marketplace").on("change", function (e) {: This work!<p/>');
  });
  $('#btn').on('click', function (e) {
    $('#domain').trigger('change');
  });
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.0/jquery.min.js"></script>

<button id="btn">Click Me</button>
<select id="domain" class="marketplace">
    <option>United States</option>
    <option>United States</option>
    <option>United States</option>
    <option>United States</option>
</select>
<div id="result"></div>
```

我评论了在域更改事件上禁用的 removeAttr 以重现错误。

在 jQuery 1.7 中，关于更改的文档不像您想象的那样工作。

现在让我们使用通用文档更改文档，然后过滤事件目标：

```
$(document).on("change", function (e) {
   if ($(e.target).is('select.marketplace')) {
      $('#result').append('<p>$(document).on("change", function (e) {: This works!<p/>');
   }
});
$(function () {
  $("#domain").on("change", function () {
    $("#domain").attr("disabled", "disabled");
    /* do ajaxy stuff */
    //$("#domain").removeAttr("disabled");
  });
  $("select.marketplace").on("change", function (e) {
    $('#result').append('<p>$("select.marketplace").on("change", function (e) {: This work!<p/>');
  });
  $('#btn').on('click', function (e) {
    $('#domain').trigger('change');
  });
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.0/jquery.min.js"></script>

<button id="btn">Click Me</button>
<select id="domain" class="marketplace">
    <option>United States</option>
    <option>United States</option>
    <option>United States</option>
    <option>United States</option>
</select>
<div id="result"></div>
```

现在您看到了不同的行为，正是您正在寻找的。

当然这不是最好的解决方案，它只是解决问题的一种方法。

我等待其他想法，因为我的解决方案只是一种解决方法。

如果您有兴趣获取更多信息，可以查看 jQuery

`dispatch: function( event ) {`

在源代码[jQuery 1.7](https://ajax.googleapis.com/ajax/libs/jquery/1.7.0/jquery.js)中注意“禁用”一词。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-11T01:55:33.907

您是否尝试过像这样命名事件：

```
$(document).ready(function() {
  $("#domain").on("change.eventOne", function() { /* do some specific stuff */ });
  $(document).on("change.eventTwo", "select.marketplace", function() { /* do some general stuff */ });
}); 
```

您可能还想尝试从身体上连接。我有更好的运气：

```
$(document).ready(function() {
  $("#domain").on("change.eventOne", function() { /* do some specific stuff */ });
  $('body').on("change.eventTwo", "select.marketplace", function() { /* do some general stuff */ });
}); 
```

这是显然有效的 on 事件的小提琴。除非我不理解“工作”对 OP 的实际意义。

[https://jsfiddle.net/szcjszkz/1/](https://jsfiddle.net/szcjszkz/1/)

# sql - Oracle 11g 使用 CONNECT BY 和多个表创建视图

> ID：10098830
> 
> 赞同：6
> 
> 时间：2012-04-11T01:45:51.593
> 
> 标签：sql, oracle, view, oracle11g, hierarchical-data

使用 Oracle 11G（不是 R2）数据库，我们需要创建显示个人报告结构属于哪个领导委员会的报告。

在高层次上，我们通过在表 board_members 中定位员工 ID 来确定个人在董事会中的存在。

board_members 表有一个职位 ID，可用于访问 board_positions，从那里我们可以确定该职位是否在领导委员会中。（以下示例。）

对于领导委员会中的任何员工，他自己的 ID 将代表 BOARD_LEAD。

对于任何其他员工，report_to 值会递归，直到确定领导委员会成员，并且该人的 ID 将为 BOARD_LEAD。

我们的顶级员工有 report_to 等于他们自己的 empl_id，而不是更常见的 NULL。

为了希望证明这一点，我在下面设置了示例表、示例数据和示例所需的输出。

我正在尝试了解如何创建一个视图，该视图将为全职等效和其他报告需求提供此类信息。我确信将涉及 CONNECT BY，但我发现 Oracle 文档令人困惑，并且我没有找到包含多个表的示例。（我担心缺乏例子是有充分理由的。）

甚至可以在 Oracle 11g（不是 R2）上编写这样的视图，而不是在每次位置更改时都必须更新的中间表？

```
Create table board_positions /* If board_position = 'LDRSHPCOMM' this is a top position */
(member_id varchar(6),board_position varchar(18));

Create table board_members 
(empl_id varchar(6), member_id varchar(6));

Create table emp 
(empl_id varchar(6),ename varchar(32),report_to varchar(6));

Insert into board_positions values('CEO','LDRSHPCOMM');
Insert into board_positions Values('COO','LDRSHPCOMM');
Insert into board_positions Values('CFO','LDRSHPCOMM');
Insert into board_positions Values('CIO','LDRSHPCOMM');
Insert into board_positions values('WANABE','NEWBIE');

Insert into emp ('TOPDOG','Big Guy','TOPDOG');
Insert into emp ('WALLET','Money Bags','TOPDOG');
Insert into emp ('OPSGUY','Meikut Work','TOPDOG');
Insert into emp ('INFGUY','Comp U Turk','TOPDOG');
Insert into emp ('HITECH','Number 2','INFGUY');
Insert into emp ('LOTECH','Number 3','HITECH');
Insert into emp ('PROGMR','Nameless Blameless','LOTECH');
insert into emp ('FLUNKY','Ida Dunnit','PROGMR');

Insert into board_members ('TOPDOG','CEO');
Insert into board_members ('WALLET','CFO');
Insert into board_members ('OPSGUY','COO');
Insert into board_members ('INFGUY','CIO');
Insert into board_members ('HITECH','WANABE');  /* Board position not on the leadership committee */ 
```

使用类似的东西：

```
CREATE VIEW LEADER_VIEW AS
   WITH T1 AS (SELECT e.empl_id, (something) as board_lead
                , (something) as board_lead_pos
           FROM emp e
           LEFT OUTER JOIN board_members bm
                        ON bm.empl_id = e.empl_id
           LEFT OUTER JOIN board_positions bp
                        on bp.member_id = bm.member_id
           ...
           CONNECT BY PRIOR empl_id = report_to
           START WITH empl_id = report_to
           )
  SELECT * FROM T1 
```

（但我知道它远不止这些！）

所需的输出示例。. .

```
TOPDOG         TOPDOG  CEO  (Because self is on LDRSHPCOMM)
WALLET         WALLET  CFO  (Because self is on LDRSHPCOMM)
OPSGUY         OPSGUY  COO  (Because self is on LDRSHPCOMM)
INFGUY         INFGUY  CIO  (Because self is on LDRSHPCOMM)
HITECH         INFGUY  CIO  (Because REPORTTO is on LDRSHPCOMM)
LOTECH         INFGUY  CIO  (Because REPORTTO->REPORTTO is on LDRSHPCOMM)
PROGMR         INFGUY  CIO  (REPORTTO->REPORTTO->REPORTTO is on LDRSHPCOMM)
FLUNKY         INFGUY  CIO  (You know by now.) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-11T08:39:48.137

你可以这样做：

```
SQL> SELECT *
  2    FROM (SELECT empl_id, ename, report_to,
  3                 member_id, board_position,
  4                 MAX(lvl) over(PARTITION BY empl_id) maxlvl, lvl
  5             FROM (SELECT connect_by_root(e.empl_id) empl_id,
  6                          connect_by_root(e.ename) ename,
  7                          bm.empl_id report_to,
  8                          LEVEL lvl, bp.*
  9                      FROM emp e
 10                      LEFT JOIN board_members bm
 11                             ON e.empl_id = bm.empl_id
 12                      LEFT JOIN board_positions bp
 13                             ON bm.member_id = bp.member_id
 14                    CONNECT BY NOCYCLE e.empl_id = PRIOR e.report_to
 15                           AND (PRIOR bp.board_position IS NULL
 16                                OR PRIOR bp.board_position != 'LDRSHPCOMM')))
 17   WHERE lvl = maxlvl;

EMPL_ID ENAME                            REPORT_TO MEMBER_ID BOARD_POSITION     
------- -------------------------------- --------- --------- ------------------ 
FLUNKY  Ida Dunnit                       INFGUY    CIO       LDRSHPCOMM         
HITECH  Number 2                         INFGUY    CIO       LDRSHPCOMM         
INFGUY  Comp U Turk                      INFGUY    CIO       LDRSHPCOMM         
LOTECH  Number 3                         INFGUY    CIO       LDRSHPCOMM         
OPSGUY  Meikut Work                      OPSGUY    COO       LDRSHPCOMM         
PROGMR  Nameless Blameless               INFGUY    CIO       LDRSHPCOMM         
TOPDOG  Big Guy                          TOPDOG    CEO       LDRSHPCOMM         
WALLET  Money Bags                       WALLET    CFO       LDRSHPCOMM 
```

我没有 START WITH 子句，因为我想为所有员工启动分层查询。对于每个员工，我都会遍历层级数据，直到找到领导委员会的董事会成员（CONNECT BY 子句）。

外部查询过滤相关行。

# asp.net-mvc - 在 linq c# 中选择新的

> ID：10098841
> 
> 赞同：0
> 
> 时间：2012-04-11T01:47:33.587
> 
> 标签：asp.net-mvc, linq

我在我的 asp.net mvc 项目控制器中有一项操作。

```
public JsonResult GetProductBySearch(string Q)
{
   JsonResult jr = new JsonResult();
   var _product = from a in DataContext.SearchItem(Q)
                  select new { ID = a.ID, ProName = a.Name };
   jr.Data = _product.ToList();
   jr.JsonRequestBehavior = JsonRequestBehavior.AllowGet;
   return jr;
} 
```

我想将此 json 数据返回到我的项目视图中。如果我使用“select new”，它在我看来效果很好，但据我所知，当我们需要数据子集时，select new 正在使用。但在这个查询中，我想从我的表中获取所有字段，如下所示：

```
public JsonResult GetProductBySearch(string Q)
{
  JsonResult jr = new JsonResult();
  var _product = from a in DataContext.SearchItem(Q)
                 select a;
  jr.Data = _product.ToList();
  jr.JsonRequestBehavior = JsonRequestBehavior.AllowGet;
  return jr;
} 
```

这就是我循环查看的内容，如果我与 select new 一起使用，效果会很好。但是当我更改为 SELECT 时，警报不起作用。

```
 $.getJSON(url, data, function (data) {
     alert(1);
   $.each(data, function (index, proValByDep) {

   });
 }); 
```

请有任何想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T01:57:30.993

为什么使用“从 DataContext.SearchItem(Q) 中的 a 选择 a”？

你不能用`jr.Data=DataContext.SearchItem(Q).ToList()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T01:58:07.257

我只是猜测问题，因为问题有点不清楚。

在第一个示例中，我们看到：

```
select new { ID = a.ID, ProName = a.Name }; 
```

在第二个中，字段名将不一样，因此`ProName`生成的 json 将具有`Name`.

`ProName`可能由于未定义，javascript 正在期待并出错。

这并不能解释为什么`alert(1);`不起作用。

# cakephp - 防止 CakePHP 在实例化模型时自动连接数据库

> ID：10098844
> 
> 赞同：2
> 
> 时间：2012-04-11T01:47:59.687
> 
> 标签：cakephp

我公司的 DBA 有一个脚本，可以自动终止对我们生产数据库的长时间运行的数据库连接和查询。我编写了一个循环运行的 CakePHP Shell 应用程序，有点像一个守护进程，它需要定期进行数据库读取和写入。如果运行时间过长，维护脚本会关闭数据库连接，并且我的应用程序会出错。

查看 CakePHP 源代码，似乎在实例化模型时，它会自动尝试连接到适当的数据库。有没有办法只在进行查询时连接到数据库，然后断开连接？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T04:57:44.043

也许您可以在需要时手动连接/断开连接？

DboSource 有很多方法供您使用。以下是可能有用的函数列表：

```
$db = ConnectionManager::getDataSource('local');

$isconnected = $db->isConnected();  //is the connection open?
$db->close();  //close the connection
$db->reconnect();  //reconnect to the db 
```

[DboSource API 文档](http://api20.cakephp.org/class/dbo-source)中列出了更多方法

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T06:58:20.380

也许您可以为此使用 AppModel 中的回调。

我猜您可以使用`beforeFind`and`beforeSafe`建立与数据库的连接，然后使用`afterFind`and`afterSafe`终止您的连接。

至于使用核心 Cake 功能打开和关闭数据库连接的“正确”方式，我不确定，但 Costa 的回答似乎是一个好的（而且干净！）计划。

(1) [http://book.cakephp.org/1.3/en/view/922/Database-Configuration](http://book.cakephp.org/1.3/en/view/922/Database-Configuration)（链接停止工作，猜你现在应该看这里：http: [//book.cakephp.org/1.3/en/ The-Manual/Developing-with-CakePHP/Configuration.html](http://book.cakephp.org/1.3/en/The-Manual/Developing-with-CakePHP/Configuration.html) )

# plone - 如何避免在 Plone 中重氮更改“#”链接？

> ID：10098846
> 
> 赞同：4
> 
> 时间：2012-04-11T01:48:30.333
> 
> 标签：plone, diazo

我正在使用带有 Plone 4 的 Diazo。在其中一个 HTML 模板文件中，我编写了一个指向同一页面的链接，如下所示：

```
 <a href="#">foo</a> 
```

但它呈现为：

```
 <a href="/mysite/++theme++my.theme/">foo</a> 
```

如何避免 Diazo 更改原始模板代码或有特定机制指向同一页面。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T06:22:59.507

不过，这听起来像是 plone.app.theming 中的一个错误。相对到绝对解析器应该忽略锚链接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T05:02:07.507

Plone 上的“重氮主题”控制面板有一个名为“绝对路径前缀”的选项（在“高级设置”选项卡上），它定义了这种魔力。或者，您可以尝试定义一个规则，将“#”链接替换为预定义的 $path 变量。

有关“高级选项卡”或预定义变量的设置的更多信息，请参阅[plone.app.theming 。](http://pypi.python.org/pypi/plone.app.theming)

# ruby-on-rails - 声明式授权嵌套 if_attribute

> ID：10098850
> 
> 赞同：0
> 
> 时间：2012-04-11T01:49:28.863
> 
> 标签：ruby-on-rails, activerecord, declarative-authorization

我在理解声明性授权和嵌套 if_attributes 的文档时遇到了一些困难。

楷模：

```
class Company < ActiveRecord::Base
  has_many :users, :through => :division
end

class Division < ActiveRecord::Base
  belongs_to :company
  has_many :users
end

class User < ActiveRecord::Base
  belongs_to :post
end 
```

我的规则：

```
role :company_admin do
includes :company_admin
  has_permission_on :companies, :to => [:index, :show, :edit, :update] do
  if_attribute :id => is { user.division.company.id } # This is the problem....
end 
```

在我的层次结构中，我定义了一个 company_admin 角色，应该允许编辑他自己的公司以及所有部门和用户。公司管理员上方还有一个角色，可以完全编辑和添加公司以及下面的所有角色。

我似乎挂断了上面列出的规则（我知道这是不正确的，它只是一个例子的填充物）。我需要确定当前用户只能编辑自己的公司，不能编辑其他公司。这似乎是一个嵌套的 if_attribute 但我似乎无法理解文档中嵌套 if_attributes 的示例。

提前感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T13:48:43.400

解析不需要嵌套的 if_attribute。我使用的示例实际上是正确的，我的 authorization_rules.rb 文件中存在其他权限错误，该用户继承了导致混淆的问题。

```
if_attribute :id => is { user.division.company.id } #This was the correct if_attribute 
```

# apache - 在加载网页时将代码放在 Web 服务器上的哪个位置？

> ID：10098852
> 
> 赞同：1
> 
> 时间：2012-04-11T01:49:59.653
> 
> 标签：apache, http

我正在整理我的第一个网页，并且我一直在查看这些 FTP 文件的时间最长，但无法弄清楚将我的代码放在哪里以使其在加载网页时加载。

目前，在访问网页时，它会加载一个 public_html 文件夹，然后作为一个索引，我可以在其中单击 php 文件打开（并访问 html 等。）

不过我不想看索引；我希望它立即加载代码。我在哪里可以做到这一点？（是的，我已经看过了，但我一生都无法弄清楚该怎么做。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T01:57:45.210

Web 服务器有一个“目标”网页的优先列表，当您在没有指定文件的情况下转到目录时，它会转到该列表。

如果你有 PHP 脚本，你将把你的主文件命名为`index.php`. 如果您有 HTML，那么`index.htm`或`index.html`将是所需的。这些几乎适用于所有服务器。3 个文件中的哪一个具有优先级通常取决于服务器的配置，但通常是那个`.php`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T01:56:41.537

如果您希望将文件作为主页加载，以便在您进入`yourdomain.com`浏览器时加载或作为目录的默认文件 ( `yourdomain.com/dir/`)，则该文件应命名为以下之一：

```
index.<ext>
Index.<ext>
default.<ext>
home.<ext> 
```

替换`<ext>`为文件扩展名。此列表因服务器而异，但几乎所有服务器都会识别`index.<ext>`.

# asp.net-mvc-3 - MVC 3 中的路由

> ID：10098854
> 
> 赞同：1
> 
> 时间：2012-04-11T01:50:18.647
> 
> 标签：asp.net-mvc-3, routing

我不太确定该怎么做。基本上我有一个域，我们就叫它 domain.com。域本身就是企业网站，然后是加盟商网站，通过正斜杠参数访问。因此，例如 domain.com/atl 可能是特许经营商网站。这些加盟商网站与公司网站相同，因此您基本上只是为每个加盟商重新创建整个网站。

这对我来说是棘手的部分。加盟商网站上的某些页面需要可定制。所以我的想法是，这应该由数据库控制，我只需将“atl”作为访问数据库并根据单击的链接返回页面内容的参数，这样我基本上就有 1 个视图文件可以服务无限数量的加盟商。

我不明白的是你如何传递这个参数。以链接为例。假设我访问了 domain.com/atl，然后单击了一个名为“stuff”的链接。您将如何将其路由到“stuff”视图并将其显示为 domain.com/atl/stuff 而不是 domain.com/stuff？

有没有一个词来描述这个系统，这将使我的研究更容易？或者有没有人有一个链接可以为我指明正确的方向？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T07:19:59.033

[MikeSW 对路线很接近](https://stackoverflow.com/a/10100300/304832)，但听起来您不希望特许经营商页面与公司页面共享任何控制器。我还有一些其他的想法：

```
routes.MapRoute(null, // do not name your routes, they are "magic strings"
    "{tenant}/{controller}/{action}",
    new
    { 
        // strongly type controller, action, and area names using T4MVC
        controller = MVC.Home.Name,            
        action = MVC.Home.ActionNames.Index,
        // it sounds here like you want this controller for franchisees only, 
        // so corporate pages will use other controllers. if this is the case, 
        // tenant="default" // require the parameter by not supplying a default
    }); 
```

不命名路由的原因是因为不命名它们会迫使您在某些 html 帮助器和控制器方法中使用某些重载。方法中有很多重载，例如`RedirectToRoute`,`@Html.RouteLink`和`@Url.RouteUrl`将路由名称作为第一个参数。通过从路由中省略名称，这迫使我们使用仅依赖于路由参数和 HTTP 方法的重载来解析控制器和操作。（[T4MVC](http://mvccontrib.codeplex.com/wikipage?title=T4MVC)在这里也很有帮助，因为它允许我们为这些方法的参数强输入区域、控制器和动作名称。）

MVC 将在为其呈现视图的 URL 中自动使用“环境”路由参数。因此，如果您在 URL 上`domain.com/atl`并想要链接到`domain.com/atl/stuff`，则可以输出如下超链接：

```
@Html.RouteLink("Stuff", new 
{
    // this will render a link with the URL domain.com/atl/stuff
    controller = MVC.Stuff.Name,
    action = MVC.Stuff.ActionNames.Index,
    // you do not need to include franchisee
}) 
```

（如果您只想呈现普通 HTML`<a>`标记的 href 参数的 URL，请`@Url.RouteUrl`改用。）

另一方面，如果您想从一个加盟商网站链接到另一个，则必须指定加盟商参数：

```
@Html.RouteLink("Another franchisee in this state", new 
{
    // this will render a link with the URL domain.com/macon
    controller = MVC.Home.Name,
    action = MVC.Home.ActionNames.Index,
    franchisee = "macon"
}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T05:27:17.917

在路由中，视图无关紧要，只有控制器在选择要返回的视图时才重要。我认为这毕竟是关于多租户的，至少在这种情况下，anwser 非常简单。有一个包含租户名称或 ID 的路由定义

```
routes.MapRoute("default","{tenant}/{controller}/{action}",new{ tenant="default", controller="home", action="index"}) 
```

使用此路由，如果未指定租户，则假定为“默认”（可能是公司站点本身）。

关于一些需要定制的页面，数据库是用来存储东西的，不是用来控制逻辑的。我认为，事情比你想象的要简单，你只需要在数据库中存储一些自定义细节（某个视图名称或 CSS、js），然后将它们提供给视图。基本上，控制器从数据库中获取所需的最少信息，然后选择相关视图，创建视图模型并返回该视图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T06:02:53.560

您可以通过使用 IOC 容器（如结构图）实际创建多租户 Web 应用程序来采取不同的方法。 [扎克欧文斯有一个关于如何做到这一点的入门样本](http://weblogs.asp.net/zowens/archive/2010/06/23/multi-tenant-asp-net-mvc-inversion-of-control.aspx)

创建一个多租户 Web 应用程序显然不能放在帖子中，但如果你想了解更多信息，可以给我发消息。

我认为，如果您尝试通过路由来处理这一切，您将会造成一团糟。

# r - Data.Frame 到带有彩色文本的 PDF/HTML 表格

> ID：10098856
> 
> 赞同：4
> 
> 时间：2012-04-11T01:51:36.707
> 
> 标签：r, pdf-generation, dataframe

我有一个非常简单的问题。我有一个包含多行和多列的数据框。我的行代表时间点。我的列是潜在条件，我的单元格是这些条件在特定时间发生的概率。

我想将此信息输出到 PDF 表。此外，我想为此添加颜色。例如 < 60% 的灰色文本。60-75 绿色文本。75+ 亮绿色。

有没有办法做到这一点？

此外，是否可以在我的 PDF 输出中有一列由水平条组成。条的大小也将基于我的单元格值。理想情况下，我也可以对此进行着色。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T02:00:08.153

如果您愿意使用 LaTeX，您可以使用[Rd2roxygen](http://cran.r-project.org/web/packages/Rd2roxygen/vignettes/Rd2roxygen.pdf)，有[多种方法可以将表格从 R 导出到 LaTeX 或 HTML](http://www.stat.ucl.ac.be/ISdidactique/Rhelp/library/xtable/html/00Index.html)。

如果您不想使用 LaTeX，则可以使用热图来传达细胞中的差异。这是[Jason Bryer 的一个很好的例子](http://bryer.org/2011/visualizing-likert-items)和[另一个例子](http://www.quantumforest.com/2012/02/revisiting-homicide-rates/)。

[Jason Bryer 博客](http://jason.bryer.org/posts/2011-11-11/visualizing-likert-items.html)中的表格，供那些没有时间点击上面链接的人使用。![Jason Bryer 的热图](../Images/893499907ba8740ac736eedc15f5814f.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T19:38:44.310

使用 ggplot 和热图。

下面的示例代码。

```
df.m = melt(df)
df.m <- ddply(df.m, .(variable), transform,rescale = scale(value))
pp = ggplot(df.m, aes(x = variable, y = Time, fill = rescale, label = sprintf("%1.1f%%", 100*value),size=10))
pp = pp + geom_tile() + geom_text(aes(size=10)) + 
scale_x_discrete(name = '', expand = c(0, 0)) +
scale_y_discrete(name = '', expand = c(0, 0)) +
scale_fill_gradient2(low = 'grey', high = 'steelblue') +
theme_bw() +
opts(legend.position = 'none',
    panel.grid.major = theme_line(colour = NA),
    panel.grid.minor = theme_line(colour = NA)) 
```

# c++ - Objective C 中命名空间 C++ 类的前向声明

> ID：10098857
> 
> 赞同：2
> 
> 时间：2012-04-11T01:52:11.290
> 
> 标签：c++, objective-c, class, namespaces, forward-declaration

是否可以在 Objective C 头文件中对位于命名空间内的 C++ 类进行前向声明？

在 Objective C 中转发声明的 C++ 类：

```
namespace name
{
    class Clazz
    {

    };
} 
```

我知道如果 C++ 类不在命名空间中，我可以。取自[http://www.zedkep.com/blog/index.php?/archives/247-Forward-declaring-C++-classes-in-Objective-C.html](http://www.zedkep.com/blog/index.php?/archives/247-Forward-declaring-C++-classes-in-Objective-C.html)

有什么想法吗？
多谢你们！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T04:58:35.023

`#ifdef`您只需像往常一样声明它，并在 C 和/或 ObjC 翻译中包含标头时将其包装在 C++检查中：

```
#ifdef __cplusplus
namespace name {
class Clazz;
} // << name
#endif 
```

由于显而易见的原因，您不能`name::Clazz`在 C 或 ObjC 翻译中使用，所以这很完美。您要么需要 C++ 翻译中的前向声明，要么不需要对 C 或 ObjC 可见。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T04:51:21.757

您可以在 Objective-C++ 标头中将您的类声明为结构，然后将它们包含在 C 或 obj-c 代码中。通常适用的相同限制也适用于这种情况。唯一需要注意的是，您必须将 ifdef 放在命名空间周围，以便在 C 代码中包含标头时它们不会显示，因为 C 编译器不知道命名空间。

```
#ifdef __cplusplus
namespace name{
#endif
    struct classname;
#ifdef __cplusplus
}
using namespace name;
#endif 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-11T02:00:00.930

你可以像这样在命名空间中声明一个转发类：

`namespace MyNamespace { class MyClass; };`

它应该在 Obj-C++ 中工作，但如果不是，你也可以尝试 obj-c's `@class`，或者只是做一个`typedef void* Clazz`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T02:00:00.713

至少在普通 C++ 中，您会执行以下操作：

```
namespace a {
    class b;
}

int main(){
    a::b *c;
} 
```

我不能说Objective C编译器是否会接受这一点。

# ruby - 是否可以在不使用 Rails 的情况下使用 Cucumber 测试一个大量 javascript 的网络应用程序？

> ID：10098858
> 
> 赞同：2
> 
> 时间：2012-04-11T01:52:52.280
> 
> 标签：ruby, cucumber, capybara, celerity

我正在尝试设置 Cucumber 来测试基于 PHP 的 Web 应用程序。该应用程序具有许多基于 JavaScript 的动态功能。从我的谷歌搜索来看，这似乎意味着我应该选择 Celerity/Culerity 或 Capybara 作为我的网络浏览宝石。但是，我似乎找不到任何关于如何使用这些系统中的任何一个测试非 Rails 应用程序的好例子。他们所有的文档都假设我使用的是 Rails 或 Rack 应用程序。

长话短说：我是不是找错树了？如果没有 Rails，这些中的任何一个都可以使用吗？如果是这样，您能否指出一些资源和/或示例来说明如何做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T06:34:13.517

这绝对是实用的，我们正在使用它来测试一个在 Windows 上使用 Capybara 的 JS 繁重的遗留 .NET Web 应用程序。我能想到的最好的资源是[The Cucumber Book](http://pragprog.com/book/hwcuc/the-cucumber-book)。

一般来说，Capybara 很容易为非 Rack 应用程序设置，您只需将其配置`app_host`为指向已部署的 PHP 站点的 URL。

您也无法访问应用程序中的模型类，这在处理 Rails 应用程序时是一个优势，因此您无法使用相同的模型轻松地将用户注入数据库。我们最终创建了 ActiveRecord 模型，只是为了操作和断言测试数据，这是一个不幸的重复。如果您的应用程序公开了一个可以替代使用的 API，那么这可能是一个更好的解决方案！这在很大程度上取决于您的应用程序如何工作以及您希望如何测试它的细节。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T16:40:01.853

我正在测试一个使用 Perl 构建的网站。我正在使用带有 Watir-webdriver 的 Cucumber。有一些关于使用它的很棒的教程。我发现最容易理解的是来自 Alister Scott 在他的[Watirmelon 博客](http://watirmelon.com/2011/01/21/my-simple-cucumber-watir-page-object-pattern-framework/)上的文章。就像 Jon M 说的，[The Cucumber Book](http://pragprog.com/book/hwcuc/the-cucumber-book)很棒。它会引导您完成所有操作，即使您不使用 Rails，它也很有用。我也在使用[Rubymine](http://www.jetbrains.com/ruby/)，一个支持 Cucumber 的 IDE。它提供语法高亮，甚至帮助存根代码（主要是保存一些复制/粘贴）。此外，它还集成到了我的源代码控制系统中，这对于查看自上次提交以来我接触了哪些文件而无需跳出使用 Tortoise 来查看文件非常有用。

FWIW，我正在Win7上开发。

# mysql - 如何在mysql中获取字符串的中间部分

> ID：10098860
> 
> 赞同：3
> 
> 时间：2012-04-11T01:53:03.527
> 
> 标签：mysql, sql, string

我正在尝试获取字符串的中间部分。我的表如下：

```
id   machine   model
1    lathe     ISO-678-1567 
```

我想从机器模型中获得像 678 这样的中间部分。

预期输出：

```
id   machine   model             midcode
1    lathe     ISO-678-1567      678 
```

目前我正在用 PHP codwe 做同样的事情。但我认为在 Mysql 查询本身中做会更好。请帮我怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-11T01:55:15.473

使用`MID(str,pos,len)`将执行此操作的 mysql 函数。

```
SELECT id,machine,model,MID(model,4,3) as midcode FROM tablename 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-11T01:57:46.690

如果`model`总是固定长度，那么您可以使用[`SUBSTRING()`](http://dev.mysql.com/doc/refman/5.5/en/string-functions.html#function_substring)，如下所示：

```
SELECT SUBSTRING(model, 5, 3) AS 'midcode' FROM Tablename 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-21T18:46:52.450

我使用以下查询创建了一个[sql fiddle ：](http://sqlfiddle.com/#!2/19a09/1)

```
SELECT id,machine,model,
       left(substring(model,(instr(model,'-')+1)),instr(model,'-')-1) AS midcode
FROM tbl_machine; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T02:03:56.370

寻找 SUBSTR/SUBSTRING：[http ://dev.mysql.com/doc/refman/5.5/en/string-functions.html#function_substr](http://dev.mysql.com/doc/refman/5.5/en/string-functions.html#function_substr)

具体用途是 SUBSTRING(field, start_position, length)

```
SELECT SUBSTRING(model, 5, 3) as 'midcode' from Tablename 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-01-18T11:44:21.080

**MID()** - 返回从指定位置开始的子字符串
**SUBSTRING()**返回指定的子字符串

站点参考：文档[官方](http://dev.mysql.com/doc/refman/5.7/en/string-functions.html#function_substring)

# ruby-on-rails-3 - 用于 nil:NilClass 的机车 CMS 未定义方法“计数”

> ID：10098866
> 
> 赞同：1
> 
> 时间：2012-04-11T01:53:57.753
> 
> 标签：ruby-on-rails-3, locomotivecms

我正在尝试设置机车 CMS 并在本地运行，但我遇到了这个错误：

```
NoMethodError in Locomotive/pages#index

Showing /Users/dennismonsewicz/.rvm/gems/ruby-1.9.3-p125/gems/locomotive_cms-2.0.0.rc4/app/views/locomotive/pages/_page.html.haml where line #4 raised:

undefined method `count' for nil:NilClass
Extracted source (around line #4):

1: - if page.not_found?
2:   %li.sep &nbsp;
3: 
4: %li{ :id => "item-#{page.id}", :class => "page #{css_for_page(page)}" }
5: 
6:   - children = can?(:manage, page) ? page.children : page.children.find_all { |p| !p.templatized? }
7: 
```

还有其他人遇到机车这个问题吗？

机车宝石：`gem 'locomotive_cms', '~> 2.0.0.rc.4', :require => 'locomotive/engine'`

我能够获得管理员用户设置，但是当您完成初始设置后，应用程序会将您重定向到 /locomotive/pages，然后我收到该错误

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T15:17:53.180

在机车的文档中，他们声明在您的 Gem 文件中执行以下操作： `gem 'locomotive_cms', '~> 2.0.0.rc4', :require => 'locomotive/engine'`

但您实际上必须执行以下操作： `gem 'locomotive_cms', :require => 'locomotive/engine', :git => "git://github.com/locomotivecms/engine.git"`

# silverlight-5.0 - Silverlight 5 矢量打印问题 - 复制和粘贴时出现奇怪的字符

> ID：10098867
> 
> 赞同：1
> 
> 时间：2012-04-11T01:54:03.273
> 
> 标签：silverlight-5.0

我刚刚将 Silverlight 应用程序升级到 SL5，主要是为了利用新的矢量打印功能。它似乎工作得很好。事实上，如果我打印到 PDF Creator，我可以选择里面的文本（在 SL4 中，所有文本都打印为光栅）。

但是，如果我尝试将选定的文本复制并粘贴到记事本中，我会得到奇怪的字符。

我对带有打印按钮和以下代码的小型测试应用程序有同样的问题：

```
 StackPanel panel = new StackPanel();
  TextBlock tb = new TextBlock();
  tb.Text = "Hello World!";      
  panel.Children.Add(tb);

  PrintDocument document = new PrintDocument();
  document.PrintPage += (s, e) =>
  {
    e.PageVisual = panel;
    e.HasMorePages = false;
  };

  PrinterFallbackSettings settings = new PrinterFallbackSettings();
  settings.ForceVector = true;      
  document.Print("Silverlight Printing Test", settings); 
```

# django - 如何使用美味派将多线程字段公开为资源？

> ID：10098868
> 
> 赞同：4
> 
> 时间：2012-04-11T01:54:08.347
> 
> 标签：django, tastypie

在我当前的代码中，用户有一个他加入的目标列表。我想要一个 API 端点来公开所有用户的加入目标。我希望能够发布、放置和访问此 API 端点。它将获取已加入目标的列表，将目标添加到已加入目标列表中，或对已加入目标列表进行更新。

```
# Joined Goal Resource
class JoinedGoalResource(ModelResource):
  user = fields.ForeignKey(UserResource, 'user')
  joined_goals = fields.ManyToManyField(GoalResource, 'joined_goals', full=True)

  class Meta:
    authentication = Authentication()
    authorization = Authorization()
    queryset = UserProfile.objects.all()
    resource_name = 'joined_goal'
    allowed_methods = ['get', 'post', 'put']
    filtering = {
      'user': ALL_WITH_RELATIONS
    } 
```

上述代码的问题在于它使用 UserProfile 模型作为其查询集，因此如果我在 API 端点上发布、获取或放入，它将影响 UserProfile 而不是用户的joined_goals。

编辑：我已经更改了我的代码，以便加入的资源覆盖 obj_create 方法并仅添加到登录用户的加入目标列表中。问题是该方法要求我返回一个包。如何创建要返回的捆绑包？我正在做这样的事情：

```
goal_resource = GoalResource
goal_obj = goal_resource.obj_get(pk=1)
goal_bundle = goal_resource.build_bundle(obj=goal_obj, request=request)
return goal_bundle 
```

但是当接受 pk=1 的参数时，obj_get 不起作用

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T13:38:38.480

解决方案可能非常简单。

您可以实现常规资源（忘记用户所有权），然后按照[Tastypie 食谱的“创建每个用户资源”部分](http://django-tastypie.readthedocs.org/en/latest/cookbook.html#creating-per-user-resources)缩小 GET 返回的列表并确保新创建的对象归当前用户所有（POST） .

对于 PUT，您只需要授权类来确保用户只被授权更新他/她自己的目标。这是最棘手的部分（但并不难），只需确保当方法为 PUT 时捆绑包的`user`属性值相同，否则会引发异常，您就完成了:)`goal``request.user`

因此，在上面，您将拥有以下 URI：

```
GET,POST,PUT /api/users/ #for interaction with Users
GET,POST,PUT /api/user-goals/ #for interaction with Goals 
```

你可以介绍（对于GET）：

```
GET /api/users/goals/ #for displaying user goals in more natural way 
```

按照说明书的[嵌套资源部分](http://django-tastypie.readthedocs.org/en/latest/cookbook.html#nested-resources)

# java - 在 Android AIR 应用程序中设置广播接收器

> ID：10098874
> 
> 赞同：2
> 
> 时间：2012-04-11T01:54:28.207
> 
> 标签：java, android, actionscript, air, air-native-extension

我正在使用 Adob​​e AIR 编写一个应用程序，并尝试使用本机扩展将其部署到 Android。该应用程序需要能够使用 Google 的 C2DM 服务（相当于 Apple 的推送通知服务）。这需要设置一个 BroadcastReceiver 以便从 Google 接收设备注册。我能够在独立的本机 Android 应用程序（无 AIR）中正常工作，但似乎无法在 AIR 应用程序中正常工作。我想我一定是错误地设置了清单 XML，但我看不出怎么做。

以下是 AIR 应用程序清单文件中 XML 的相关部分：

```
<android>
    <manifestAdditions><![CDATA[
        <manifest android:installLocation="auto">
            <permission android:protectionLevel="signature" android:name="com.example.znotification.permission.C2D_MESSAGE" />

            <uses-permission android:name="com.example.znotification.permission.C2D_MESSAGE" />
            <uses-permission android:name="com.google.android.c2dm.permission.RECEIVE" />
            <uses-permission android:name="android.permission.INTERNET" />

            <application android:enabled="true">
                <receiver android:name="com.example.znotification.C2DMBroadcastReceiver" android:permission="com.google.android.c2dm.permission.SEND">

                    <intent-filter>
                        <action android:name="com.google.android.c2dm.intent.RECEIVE" />
                    </intent-filter>

                    <intent-filter>
                        <action android:name="com.google.android.c2dm.intent.REGISTRATION" />
                    </intent-filter>

                </receiver>
            </application>

        </manifest>

    ]]></manifestAdditions>
</android> 
```

在标签中引用的本机 Java 类 C2DMBroadcastReceiver 中，它所做的只是注销一条消息，说明它已收到广播。我已经验证我正在正确设置 Intent（请参阅下面的 Java 代码），但 BroadcastReceiver 永远不会被击中。

```
Context appContext = context.getActivity().getApplicationContext();
Intent registrationIntent = new Intent("com.google.android.c2dm.intent.REGISTER");
registrationIntent.putExtra("app",PendingIntent.getBroadcast(appContext, 0, new Intent(), 0));
registrationIntent.putExtra("sender", args[0].getAsString());
appContext.startService(registrationIntent); 
```

通常，应如何在 AIR 应用程序的清单 XML 中设置 BroadcastReceiver？具体来说，您如何在 XML 中告诉应用程序在接收到给定广播时运行正确的 BroadcastReceiver？显然，我的做法是不正确的......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T13:20:43.070

您快到了。我认为您只是 AIR 组件的 android 名称略有错误。试试下面的，注意一些类的“air”前缀。

```
<android>
<manifestAdditions><![CDATA[
    <manifest android:installLocation="auto">
        <permission android:protectionLevel="signature" android:name="air.com.example.znotification.permission.C2D_MESSAGE" />

        <uses-permission android:name="air.com.example.znotification.permission.C2D_MESSAGE" />
        <uses-permission android:name="com.google.android.c2dm.permission.RECEIVE" />
        <uses-permission android:name="android.permission.INTERNET" />

        <application android:enabled="true">
            <receiver android:name="com.example.znotification.C2DMBroadcastReceiver" android:permission="com.google.android.c2dm.permission.SEND">

                <intent-filter>
                    <action android:name="com.google.android.c2dm.intent.RECEIVE" />
                    <category android:name="air.com.example.znotification" />
                </intent-filter>

                <intent-filter>
                    <action android:name="com.google.android.c2dm.intent.REGISTRATION" />
                    <category android:name="air.com.example.znotification" />
                </intent-filter>

            </receiver>
        </application>

    </manifest>

]]></manifestAdditions> 
```

# java - 我需要为我的班级项目创建一个 ArrayList

> ID：10098880
> 
> 赞同：0
> 
> 时间：2012-04-11T01:55:03.993
> 
> 标签：java, arrays

我已经写了我能写的，并且已经到了我无法弄清楚为什么它不保存数据的地步。下面是文件测试，然后是文件和我制作的数组文件。请帮忙...

$

```
import java.util.Scanner;

public class FriendsListTest

{

public static void main( String[] args)
{
    FriendsList friendsList = new FriendsList();

    char selection;
    Scanner input = new Scanner( System.in );
    do
        {
            //display menu
            System.out.println("\n--------------");
            System.out.println("Main Menu\n");
            System.out.println("1\. Add a friend ");
            System.out.println("2\. Delete a friend ");
            System.out.println("3\. Show List ");
            System.out.println("4\. Exit");

            //selection results
            selection = input.next().charAt(0);

            switch(selection){
            case '1':
                FriendsList.AddFriends();
                break;
            case '2':
                FriendsList.RemoveFriend();
                break;
            case '3':
                FriendsList.DisplayArray();     
                break;
            case '4':
                break;
            default:
                System.out.println("Invalid Selection");
        }//end Switch   

}while( selection != 4);//end do

}//end main

}//end FriendsListTest 
```

$ $

```
import java.util.Scanner;
import java.util.ArrayList;

public class FriendsList
{

public static void AddFriends()
{
    Scanner input = new Scanner( System.in );
    ArrayList<Friends> friend = new ArrayList<Friends>(20);

    System.out.println("\n--------------");
    System.out.println("Please enter Name");
    String name = input.nextLine(); //reads name
    System.out.println("Please enter Age");
    int Age = input.nextInt();
    friend.add(new Friends( Age, name));

}//end AddFriends
public static void RemoveFriend()
{
    ArrayList<Friends> friend = new ArrayList<Friends>(20);
    Scanner input = new Scanner( System.in );

    System.out.println("\n--------------");
    System.out.println("Please enter Name of person you wish you remove");
    String name = input.nextLine();
    friend.remove(name);

}//End RemoveFriend
public static void DisplayArray()
{
    ArrayList<Friends> friend = new ArrayList<Friends>(20);
    System.out.print(friend);

}//end DisplayArray

 }//end class FriendsList 
```

$ $

```
 class Friends
 {
    private String nName;
    private int nAge;
    public Friends(int Age, String name)
{
    nName = name;
    nAge = Age;
}
public String getName()
{
    return nName;
}
public int getAge()
{
    return nAge;
}
}//end class person 
```

好的，根据您的建议，我能够让它存储数据，但现在我遇到了删除数据的问题。删除数据时它不会抛出任何错误，但数据仍然存在。如果您使用我所做的编辑，我会重新发布该程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T02:00:52.547

每当您想添加或删除朋友而不是作用于类的 ArrayList 时，您都在创建一个新的 ArrayList。做后者而不是前者。换句话说，给你的班级一个`ArrayList<Friend>`变量，并在该数组列表上添加和删除你的朋友。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T02:08:19.707

您需要了解局部变量的生命范围是什么，显然您在这里需要一个成员变量。仅供参考：[成员变量和局部变量有什么区别？](https://stackoverflow.com/questions/1177723/what-is-the-difference-between-a-member-variable-and-a-local-variable)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T02:01:04.193

`ArrayList<Friend>`每次调用 Add、Remove 或 Display 时，您都会创建一个新的。您需要将列表保存为类级字段。

如果您删除所有静态方法并将它们全部设为实例级别，那也是最好的。然后，您的`FriendList`实例将与特定的朋友列表相关联。

例如：

```
public class FriendsList
{

private List<Friend> friends = new ArrayList<Friend>();

public void addFriends()
{
    Scanner input = new Scanner( System.in );

    System.out.println("\n--------------");
    System.out.println("Please enter Name");
    String name = input.nextLine(); //reads name
    System.out.println("Please enter Age");
    int Age = input.nextInt();
    friends.add(new Friends( Age, name));

}//end AddFriends
public void removeFriend()
{
    Scanner input = new Scanner( System.in );

    System.out.println("\n--------------");
    System.out.println("Please enter Name of person you wish you remove");
    String name = input.nextLine();
    friends.remove(name);

}//End RemoveFriend
public void displayArray()
{
    System.out.print(friends);
} 
```

这意味着您需要`friendList`在 main 方法中实际使用您的实例变量，而不是以静态方式调用这些方法（即使用`friendsList.addFriends()`而不是`FriendList.addFriends()`）

另外，请注意我将方法的第一个字母小写。这几乎是 Java 的标准。

***编辑***

您当前的代码正在尝试`String`从您的`List<Friends>`. 它没有删除任何东西，`String`因为`List`. 您将不得不遍历列表并找到`Friend`其名称`name`

所以你的删除方法应该是这样的：

```
public void removeFriend()
{
  Scanner input = new Scanner( System.in );

  System.out.println("\n--------------");
  System.out.println("Please enter Name of person you wish you remove");
  String name = input.nextLine(); 

  Friends friendToRemove = null;
  for (Friends friend : friends) {
    if (name.equals(friend.getName()) {
      friendToRemove = friend;
    }
  } 

  if (friendToRemove != null) {
    friends.remove(friendToRemove)
  }

}//End RemoveFriend 
```

# asp.net-mvc - Ninject 3.0 MVC kernel.bind 错误自动注册

> ID：10098883
> 
> 赞同：3
> 
> 时间：2012-04-11T01:55:33.433
> 
> 标签：asp.net-mvc, ninject, structuremap

kernel.Bind( **scanner** => ... "scanner" 在 VS 2010 中有一条小错误行。

> 无法将 lambda 表达式转换为类型“System.Type[]”，因为它不是委托类型

像 2.0 中的旧 kernel.scan 一样尝试自动注册。我无法弄清楚我做错了什么。添加和删​​除了许多 Ninject 包。完全迷失了，变得非常浪费时间。

```
using System;
using System.Web;

using Microsoft.Web.Infrastructure.DynamicModuleHelper;

using Ninject;
using Ninject.Web.Common;
//using Ninject.Extensions.Conventions;
using Ninject.Web.WebApi;
using Ninject.Web.Mvc;
using CommonServiceLocator.NinjectAdapter;
using System.Reflection;
using System.IO;
using LR.Repository;
using LR.Repository.Interfaces;
using LR.Service.Interfaces;
using System.Web.Http;

public static class NinjectWebCommon 
{
    private static readonly Bootstrapper bootstrapper = new Bootstrapper();

    /// <summary>
    /// Starts the application
    /// </summary>
    public static void Start() 
    {
        DynamicModuleUtility.RegisterModule(typeof(OnePerRequestHttpModule));
        DynamicModuleUtility.RegisterModule(typeof(NinjectHttpModule));
        bootstrapper.Initialize(CreateKernel);
    }

    /// <summary>
    /// Stops the application.
    /// </summary>
    public static void Stop()
    {
        bootstrapper.ShutDown();
    }

    /// <summary>
    /// Creates the kernel that will manage your application.
    /// </summary>
    /// <returns>The created kernel.</returns>
    private static IKernel CreateKernel()
    {
        var kernel = new StandardKernel();
        kernel.Bind<Func<IKernel>>().ToMethod(ctx => () => new Bootstrapper().Kernel);
        kernel.Bind<IHttpModule>().To<HttpApplicationInitializationHttpModule>();

        RegisterServices(kernel);
        return kernel;
    }

    /// <summary>
    /// Load your modules or register your services here!
    /// </summary>
    /// <param name="kernel">The kernel.</param>
            private static void RegisterServices(IKernel kernel)
            {

                kernel.Bind(scanner => scanner.FromAssembliesInPath(Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location))
                    .Select(IsServiceType)
                    .BindToDefaultInterface()
                    .Configure(binding => binding.InSingletonScope())
                    );

            }

            private static bool IsServiceType(Type type)
            {
                // temp return true;
                // .Any() is not recognized either.
                return true; // type.IsClass && type.GetInterfaces().Any(intface => intface.Name == "I" + type.Name);
            } 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-11T08:01:54.003

你必须取消注释

```
//using Ninject.Extensions.Conventions; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T23:24:29.653

只是想浓缩一些我需要摆脱我的错误的程序集。谢谢雷莫斯

```
using System.Linq;  //correct the .Any() error in the IsServiceType
using Ninject;
using Ninject.Web.Common;
using Ninject.Extensions.Conventions; //Corrected the error with kernel.bind 
```

更改了 .BindToDefaultInterface() --> .BindDefaultInterface()

这是我的完整代码，这是有效的。希望能帮助别人。

```
[assembly: WebActivator.PreApplicationStartMethod(typeof(LongRanch.App_Start.NinjectWebCommon), "Start")]
[assembly: WebActivator.ApplicationShutdownMethodAttribute(typeof(LongRanch.App_Start.NinjectWebCommon), "Stop")]

namespace LongRanch.App_Start
{
    using System;
    using System.Web;
    using System.Linq;
    using Microsoft.Web.Infrastructure.DynamicModuleHelper;
    using Ninject;
    using Ninject.Web.Common;
    using Ninject.Extensions.Conventions;
    using System.Reflection;
    using System.IO;
    using LR.Repository;
    using LR.Repository.Interfaces;
    using LR.Service.Interfaces;
    using System.Web.Http;
    using LR.Service;

    public static class NinjectWebCommon
    {
        private static readonly Bootstrapper bootstrapper = new Bootstrapper();

        /// <summary>
        /// Starts the application
        /// </summary>
        public static void Start()
        {
            DynamicModuleUtility.RegisterModule(typeof(OnePerRequestHttpModule));
            DynamicModuleUtility.RegisterModule(typeof(NinjectHttpModule));

            bootstrapper.Initialize(CreateKernel);

        }

        /// <summary>
        /// Stops the application.
        /// </summary>
        public static void Stop()
        {
            bootstrapper.ShutDown();
        }

        /// <summary>
        /// Creates the kernel that will manage your application.
        /// </summary>
        /// <returns>The created kernel.</returns>
        private static IKernel CreateKernel()
        {
            var kernel = new StandardKernel();
            kernel.Bind<Func<IKernel>>().ToMethod(ctx => () => new Bootstrapper().Kernel);
            kernel.Bind<IHttpModule>().To<HttpApplicationInitializationHttpModule>();

            RegisterServices(kernel);

            GlobalConfiguration.Configuration
               .ServiceResolver
               .SetResolver(t => kernel.TryGet(t),
                            t => kernel.GetAll(t));

            return kernel;
        }

        /// <summary>
        /// Load your modules or register your services here!
        /// </summary>
        /// <param name="kernel">The kernel.</param>
        private static void RegisterServices(IKernel kernel)
        {
            //kernel.Bind(scanner => scanner.FromAssembliesInPath(Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location))
            kernel.Bind(scanner => scanner.From("LR.Repository", "LR.Service")
                .Select(IsServiceType)
                .BindDefaultInterface()
                .Configure(binding => binding.InSingletonScope())
            );

        }

        private static bool IsServiceType(Type type)
        {
            return type.IsClass && type.GetInterfaces().Any(intface => intface.Name == "I" + type.Name);
        }
    }
} 
```

# javascript - 强制 heroku 使用特定版本的 Node.js

> ID：10098888
> 
> 赞同：3
> 
> 时间：2012-04-11T01:56:45.877
> 
> 标签：javascript, node.js, heroku

我编写了一个在本地运行良好的 node.js 应用程序，但是当我推送到 heroku 时，我收到以下错误：

```
2012-04-11T00:42:55+00:00 app[web.1]:         throw e; // process.nextTick error, or 'error' event on first tick
2012-04-11T00:42:55+00:00 app[web.1]:         ^
2012-04-11T00:42:55+00:00 app[web.1]: TypeError: Object #<Object> has no method 'isArray' 
```

我发现heroku的节点是v0.4.7，但我的本地是v0.6.3。我指定在我的 package.json 文件中使用 v0.6.3：

```
"engine": {  
    "node": "0.6.3"  
  , "npm": "1.1.9"
} 
```

但这显然没有做任何事情，即使在我推动之后也是如此。

这一直困扰着我一整天，我需要做的就是弄清楚如何让该`util.isArray()` [方法](http://nodejs.org/docs/v0.6.3/api/util.html#util.isArray)再次工作（希望如此）。这就是我得到的错误，这是因为 node.js 的 v0.4.7 不支持它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T23:25:13.840

请注意，您正在使用`engine`而不是`engines`按照[docs](https://devcenter.heroku.com/articles/nodejs-versions)，这将导致`0.4.7`应用默认版本。

# jquery - 如何使循环中的多个ajax请求按顺序返回值？

> ID：10098890
> 
> 赞同：5
> 
> 时间：2012-04-11T01:57:25.597
> 
> 标签：jquery, ajax, request, sync

我必须在一个循环中发出一系列 Ajax 请求。其中大约100个。每个请求都返回一个 JSONP 变量。我从 JSON 中提取数据并继续将值附加到 div 中。问题是我希望 div 按函数调用的顺序附加数据。即顺序。现在，每次刷新页面时，我都会根据请求完成的顺序获得不同的顺序。这是我的代码。

```
 $.each(elem, function (index, item) {

            $.ajax({
                type: 'post' ,
                url: moviesSearchUrl + '&q=' + encodeURI(item) + '&page_limit=1',
                dataType: "jsonp",
                async: false, 
                success: searchCallback
            });

            function searchCallback(data) {
                var movies = data.movies;

                var markup = index + ': '+   movies[0].title + '<img class=" bord" src="' + movies[0].posters.thumbnail + '" /><br/>';

                $("div.content").append(markup);
            }

        });
}); 
```

当我在 div 内显示索引的值时，每次我得到随机订单。2 4 3 1 7 有时和 1 5 2 7 4 有时。我什至尝试 async: false 。那没有帮助。我在某处读到 JSONP 不能用 async: false 完成。请帮帮我。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-12-21T06:39:55.747

不要使用 for 循环。使用递归函数：

```
var i = 1;

function loadNext(){
    if (i < 5){
        $.ajax({
            type: "GET",
            url: "results/result_html.php?usn="+i+"&resultType="+resultType,
            dataType:"JSON",
            success:function(result){
                finalResult+=result;
                result=result+htmlMessage;
                $("#info").hide();
                $("#result").html(result);              
                $("#usn").attr("placeholder", "Class USN");
                loadNext();
            }
        });
        i++;
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-11T02:01:27.140

您可以使用占位符。

```
 $.each(elem, function (index, item) {

            var $placeholder = $('<div>').appendTo("div.content");

            $.ajax({
                type: 'post' ,
                url: moviesSearchUrl + '&q=' + encodeURI(item) + '&page_limit=1',
                dataType: "jsonp",
                async: false, 
                success: searchCallback
            });

            function searchCallback(data) {
                var movies = data.movies;

                var markup = index + ': '+   movies[0].title + '<img class=" bord" src="' + movies[0].posters.thumbnail + '" /><br/>';

                $placeholder.replaceWith(markup);
            }

        });
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-11T02:05:49.257

就像是：

```
// iterate over your set
$.each(myset, function(i,e){

  // placeholder div (hidden from view until it's populated)
  var $placeholder = $('<div>').hide().appendTo('div.content');

  // make your ajax call
  $.getJSON('/link/to/resource','{date:here}',function(d){

    // insert the content in to the div and re-show it
    $placeholder.text(i + ': ' + d.movies[0].title).show();
  });
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-11-29T08:22:37.073

```
 const j = 10;
    for (let i = 1; i <= j; i++) {
        // wait for the promise to resolve before advancing the for loop
        await ajaxcall(i);
        console.log(i);
    }
}

function ajaxcall(id){
   return new Promise(function(resolve, reject){
      var sUrl = "https://jsonplaceholder.typicode.com/todos/"+id;

      $.get(sUrl, function(data) {
           alert( "Load was performed."+JSON.stringify(data));
           resolve(data); 
      });

   }); 
}
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<button onclick="someFunction()"> Test </button>
```

# php - PHP 中的 eval() 问题

> ID：10098894
> 
> 赞同：0
> 
> 时间：2012-04-11T01:57:44.130
> 
> 标签：php

```
function funct($matches)
{
$fff = "hello";
$var1 = 'fff';
eval("\$woot = \$$var1;");
echo $woot;
} 
```

为什么这样的东西不起作用？我已经搞砸了一段时间。我希望回声打印“你好”，但我显然错过了一些东西:(

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T02:12:25.850

我不确定你的错误是什么，但你的代码似乎工作正常......

这里有一些游戏

```
$value = " xxx";

function funct() {
    $fff = "user";
    $var1 = 'fff';
    eval ( "\$woot = \$$var1;" );
    echo $woot;
}

function funct1(&$value) {
    $fff = "1222728";
    $var1 = 'fff';
    eval ( "\$value = \$$var1;" );
    echo $value;
}

funct ();
funct1 ( $value ); 
```

输出

```
 user1222728 
```

# javascript - 从链接中删除所有 target="_blank"

> ID：10098898
> 
> 赞同：16
> 
> 时间：2012-04-11T01:58:11.477
> 
> 标签：javascript, jquery

我在搞乱 jQuery 并遇到了一个我似乎无法解决的问题。我知道使用 jQuery 是可能的，但找不到合适的示例来解决。我有一个带有几个常规链接的页面，其中`target="_blank"`添加了属性/值。

使用 jQuery/JavaScript 从页面上的每个链接中删除该值的最佳方法是什么？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-04-11T01:59:52.533

这应该用jQuery来做......

```
$('a[target="_blank"]').removeAttr('target'); 
```

使用现代浏览器...

```
Array.from(document.querySelectorAll('a[target="_blank"]'))
  .forEach(link => link.removeAttribute('target')); 
```

使用较旧的浏览器（例如较早的 IE）...

```
var links = document.links, i, length;

for (i = 0, length = links.length; i < length; i++) {
    links[i].target == '_blank' && links[i].removeAttribute('target');
} 
```

# ios - 如何判断用户关闭推送通知或删除应用

> ID：10098901
> 
> 赞同：0
> 
> 时间：2012-04-11T01:58:41.947
> 
> 标签：ios, apple-push-notifications

我的测试应用程序可以接收苹果推送通知，我的服务器将用户的令牌保存在数据库中。

我想知道如何判断用户关闭推送通知或删除我的应用程序，然后我可以通过webservice删除用户的信息，这样可以减轻服务器压力。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T10:52:14.723

不幸的是，您将无法检测到用户何时关闭推送通知对话框。但是您可以为非活动/卸载的设备拉取 APNS 反馈服务。

[您可以在本文档](http://developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/CommunicatingWIthAPS/CommunicatingWIthAPS.html#//apple_ref/doc/uid/TP40008194-CH101-SW3)末尾阅读反馈服务的工作原理。

# wordpress - 清漆和 WordPress 端口：URL 中的 8080

> ID：10098905
> 
> 赞同：0
> 
> 时间：2012-04-11T01:59:54.330
> 
> 标签：wordpress, centos, port, varnish

我已经在运行多个 WordPress 站点的服务器上安装了 Varnish，我发现有时，这只是我登录给定站点的每隔几次，即：8080，Apache 现在使用的端口，出现在 TLD 之后我浏览器的地址栏。

这是一个问题，因为它使得在 WordPress 后端保存许多更改变得不可能，并且可能会导致很多沮丧的用户。

我已经准备好几篇关于这个主题的帖子，但没有一个给出一个真正明确的答案来解决这个问题。

我正在使用此站点中的“选项 2”作为我的 .vlc：

[http://crlog.info/2011/09/10/install-and-configure-varnish-3-0-1-cache-with-wordpress/](http://crlog.info/2011/09/10/install-and-configure-varnish-3-0-1-cache-with-wordpress/)

我所有的 WordPress 实例都是最新的，我的服务器正在运行以下内容：

*   CentOS 5.7 x86_64（64 位）
*   阿帕奇 2.2.19
*   MySQL 5.1.54
*   PHP 5.3.5

是否需要应用程序级别的更改？这是 Apache 设置吗？我要修改清漆吗？

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-12-24T14:08:28.377

只需将 Varnish 绑定到公共 IP，而将 Apache 绑定到 127.0.0.1（通过`Listen`指令）。

这样您就可以在同一个端口 80 上运行两者。将 Apache 从 8080 更改为 80。它将允许您避免任何与端口相关的问题。

# java - Eclipse 还原点

> ID：10098914
> 
> 赞同：1
> 
> 时间：2012-04-11T02:00:47.593
> 
> 标签：java, eclipse

我在 java 代码中更改了很多东西，但现在我想找回我的原始代码（更改前的代码）
例如大约 2 天前
有什么解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T02:55:10.700

您是否尝试过从 Eclipse 的本地历史中恢复您的代码？右键单击一个类，然后选择比较 -> 或替换为 -> 本地历史...或从本地历史恢复。

# delphi - IE 是否会在其中将空闲事件引发到 ActiveX？如果有的话，如何将我自己的代码注册到空闲事件

> ID：10098920
> 
> 赞同：0
> 
> 时间：2012-04-11T02:01:15.200
> 
> 标签：delphi, internet-explorer, activex, python-idle

我使用 Delphi 2007 for win32 为 IE 开发了一个 activex。我的问题是：我怎样才能得到一个空闲事件，比如从 TApplication 的消息循环中得到一个？

我当然可以使用定时器，但如果 IE 有定时器，为什么不使用呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T03:36:22.593

IE没有暴露这样的事件。

# wpf - DataGrid 绑定到 SQL Server CE 上的实体框架

> ID：10098922
> 
> 赞同：0
> 
> 时间：2012-04-11T02:01:48.897
> 
> 标签：wpf, entity-framework, entity-framework-4, sql-server-ce, wpfdatagrid

我正在尝试做一件简单的事情，但找不到有效的方法。我有一个具有 DataGrid 的 WPF 应用程序。我希望 DataGrid 显示表的所有条目（在 SQL Server CE 3.5 数据库中）。这部分通过设置 DataGrid 的 ItemsSource 很容易完成。

现在我需要用户能够使用在网格的最后一行中输入数据的内置功能来添加行。

我的表有一`Id`列是表的 PK（它不是一`Identity`列，因为 SQL Server CE 3.5 不支持 EF）。`Id`所以我每次输入新项目时都需要计算最大值。

我正在努力使用 DataGrid 事件来实现这个简单的事情，但找不到我的出路。任何人都有如何做到这一点的例子？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T19:10:42.897

您可以使用该[`InitializingNewItem`](http://msdn.microsoft.com/en-us/library/system.windows.controls.datagrid.initializingnewitem.aspx)事件。`InitializingNewItemEventArgs`有一个属性`NewItem`（对象），您可以将其转换为数据类型并设置其键值。您可能希望获得一次最大值并在内存中增加它。

我假设这是创建新对象的唯一地方（因为它是 sql-ce，没有并发性），但是如果您的应用程序中有另一个地方可能发生这种情况，您需要确保唯一键。

# php - 切诺基上的 Lua

> ID：10098923
> 
> 赞同：1
> 
> 时间：2012-04-11T02:01:51.413
> 
> 标签：php, lua, webserver, cherokee

是否有人在 Cherokee Web Server 上配置或尝试配置 CGILua。

我真正想要的是在 Cherokee 上与 PHP 一起处理 lua 页面（.lp）（PHP 用于在 DB 上写入并处理用户数据，而 Lua 用于从数据库读取并处理其他页面）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-05T14:52:01.450

你看过[http://www.cherokee-project.com/doc/modules_handlers_scgi.html](http://www.cherokee-project.com/doc/modules_handlers_scgi.html)吗？如果您在 Lua 中有良好的套接字支持（带有一些模块）并且有良好的网络编程知识，您可以制作类似 SCGI 服务器的东西。我正在开发这样的东西，目前它真的很好用（但我正在使用 nginx）。

[SCGI 协议](http://www.python.ca/scgi/protocol.txt)

[SCGI 维基文章](http://en.wikipedia.org/wiki/Simple_Common_Gateway_Interface)

# emacs - ^M 字符显示在 clojure slime-repl

> ID：10098925
> 
> 赞同：5
> 
> 时间：2012-04-11T02:02:27.227
> 
> 标签：emacs, clojure, slime, termination

我的代码中的每个都会`(println...)`导致 REPL 中出现终止 ^M 字符。我`lein swank`在一个单独的窗口中运行，我已经通过`M-x slime-connect`

我认为这可能与[Emacs 在进程缓冲区中显示 ^M 的](https://stackoverflow.com/questions/4120054/emacs-showing-m-in-a-process-buffer)问题相同，但我还没有尝试过该修复。

我尝试将行尾样式更改为 unix/dos/mac，并遵循我在网上找到的其他一些规定，但我认为其中大多数与实际替换文件中的 ^M 有关或者在缓冲区中，或者写一些我认为可能是矫枉过正的elisp。这真的应该是某个地方的复选框，如果不是字面上至少在概念上。

我在 Win7 x64 上使用 Emacs 24 + clojure mode + slime + swank。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-03T00:06:07.433

这种方法对我有用：[https ://stackoverflow.com/a/750933](https://stackoverflow.com/a/750933)

基本上只需将此代码添加到您的 .emacs 中：

```
(defun remove-dos-eol ()
  "Do not show ^M in files containing mixed UNIX and DOS line endings."
  (interactive)
  (setq buffer-display-table (make-display-table))
  (aset buffer-display-table ?\^M []))

(add-hook 'slime-repl-mode-hook 'remove-dos-eol) ;Remove ^M from clojure repl in windows 
```

# api - googlemaps api 响应错误消息“资源解释为图像但使用 MIME 类型文本/html 传输”

> ID：10098929
> 
> 赞同：3
> 
> 时间：2012-04-11T02:02:53.280
> 
> 标签：api, google-maps

我刚开始使用 googlemaps api。当我打开页面时，它总是给我同样的错误消息，上面写着“资源解释为图像但使用 MIME 类型文本/html 传输”。页面上什么也看不到。

我完全不知道如何找出问题所在。我将代码粘贴在下面。谢谢您的帮助。

----------我的代码来自这里------------------------------------ --------

```
<!DOCTYPE html>
<html lang="ja">
<head>
<meta charaset="utf-8">
<title>Googlemap</title>
<script src="http://maps.google.com/maps/api/js?sensor=true&language=ja"></script>
<style>
    #map {
            width: 100%;
            height: 100%;
            }
</style>
</head>
<body>
<div id="map"></div>
<script>
    var latlng = new google.maps.LatLng(35.66, 139.69);
    var options = {
        zoom: 15,
        center: latlng,
        mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    var map = new google.maps.Map(document.getElementById('map'), options);
</script>

</body>
</html> 
```

----------我的代码直到这里------------------------------------ --------

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T02:22:52.897

您正在为`map`DIV 分配相对宽度和高度，但您还需要为父元素（即 html 和 body）分配绝对或相对宽度和高度。

例子：

```
html, body, #map {
  width: 100%;
  height: 100%;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T18:30:43.360

请将此代码用作示例代码并遵循它，也请不要忘记下载`default.css`相同代码中提到的代码。

[https://google-developers.appspot.com/maps/documentation/javascript/examples/circle-simple](https://google-developers.appspot.com/maps/documentation/javascript/examples/circle-simple)

转到此链接并按`Ctrl`+`U`查看此页面的来源，然后使用`.html`扩展名保存。

它会起作用的。

# java - 在 Java 实验室中使用 While（用户输入无效输入）

> ID：10098930
> 
> 赞同：2
> 
> 时间：2012-04-11T02:02:59.690
> 
> 标签：java, while-loop

我在课堂实验室的一部分方面遇到了一些麻烦，其中大部分都很容易，但由于某种原因，我的 while 语句没有按照我的意愿去做。它应该返回无效输入，然后提示用户租用；但是，它认为每个输入都是无效的。（应该很容易在代码中看到）我该如何解决这个问题？或者我可以找到这些信息，因为我在我的书中找不到它。（第二个while循环，第一个有效）

```
import java.util.ArrayList;
import java.util.Scanner;
import javax.swing.JOptionPane;

public class lab8
{
    public static void main (String[] args)
    {
        int choice;
        String item;
        double costper;
        ArrayList <String> Items = new ArrayList <String> (); 
        Items.add ("computer");
        Items.add ("Monitor");
        Items.add ("Color Printer");
        Items.add ("Color Scanner");
        Items.add ("DVD/CDROM");
        Items.add ("To Quit");

        ArrayList <Integer> Num = new ArrayList <Integer> ();
        Num.add (0);
        Num.add (1);
        Num.add (2);
        Num.add (3);
        Num.add (4);
        Num.add (5);

        System.out.println ("\t\tMy Super Computer Store\n");
        int index=0;
        int endex= 0;
        while (index < Items.size() && endex < Num.size())
        {
            System.out.println ("\t" +Num.get(index)+"\t"+Items.get (endex));
            index++;
            endex++;
        }
        Scanner scan = new Scanner (System.in);
        System.out.print ("\n\t\t\tEnter the item to purchase: ");
        choice = scan.nextInt ();
        {
            if (choice==5)
            {
                JOptionPane.showMessageDialog (null, "Thanks for considering My Super Computer Store");
                System.exit (0);
            }
        }
        {
            if (choice==0 || choice==1 || choice==2 || choice==3 || choice==4)
            {
                item = Items.get (choice);
            }
        }
        while (choice!=0 || choice!=1 || choice!=2 || choice!=3 || choice!=4 || choice!=5)
        {
            System.out.println ("Invalid Input, Please enter a integer between 0 and 5\. ");
            System.out.print ("\n\t\t\tEnter the item to purchase: ");
            choice = scan.nextInt ();    
        }
        System.out.print ("\n\n\t\t\tEnter the quantity to purchase: ");
        int Qty = scan.nextInt ();
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-11T02:06:43.903

你的逻辑是错误的。

你要：

```
!(choice == 0 || choice == 1 || choice == 2 || choice == 3 || choice == 4) 
```

这和你写的**不一样。**

[德摩根定律](http://en.wikipedia.org/wiki/De_Morgan's_laws)是你的朋友:)

请注意，根据德摩根定律

```
!(choice == 0 || choice == 1 || choice == 2 || choice == 3 || choice == 4) 
```

是

```
(choice != 0 && choice != 1 && choice !=2 && choice !=3 && choice != 4) 
```

当然，由于您使用整数作为有效选择，您也可以使用以下条件：

```
(choice < 0 || choice > 4) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T02:08:51.400

你用过|| 在您的循环条件中。从逻辑上讲，您是在说：

“如果选择不是 0，或者不是 1，或者不是 2，等等”，这意味着 '1' 的值满足条件，因为它不是 0，也不是 2。替换你的 while 循环和：

```
while (choice!=0 && choice!=1 && choice!=2 && choice!=3 && choice!=4) 
```

你会没事的。

# ruby - 为什么我的代码在使用哈希符号而不是哈希字符串时会中断？

> ID：10098935
> 
> 赞同：2
> 
> 时间：2012-04-11T02:03:59.010
> 
> 标签：ruby, string, hash, symbols

我有一个场景，当我尝试使用符号访问哈希键时它不起作用，但是当我使用字符串访问它时它工作正常。据我了解，建议使用符号而不是字符串，因此我正在尝试清理我的脚本。我在脚本的其他地方使用哈希符号，只是这个特定的场景不起作用。

这是片段：

```
account_params ={}
File.open('file', 'r') do |f|
  f.each_line do |line|
    hkey, hvalue = line.chomp.split("=")
    account_params[hkey] = hvalue
  end
end

account_scope = account_params["scope"] 
```

这有效，但是如果我使用符号则无效，如下所示：

```
account_scope = account_params[:scope] 
```

当我使用符号时，我得到：

```
can't convert nil into String (TypeError) 
```

我不确定它是否重要，但这个特定哈希值的内容看起来像这样：

```
12345/ABCD123/12345 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T02:06:45.310

您从文件中读取的键是一个字符串。事实上，您从文件中读取的所有内容都是一个字符串。如果您希望散列中的键是符号，您可以更新脚本来代替：

```
account_params[hkey.to_sym] = hvalue 
```

这会将“hkey”变成一个符号，而不是使用字符串值。

Ruby 提供了多种这些类型的方法，它们会将值强制转换为不同的类型。例如：to_i 将其转换为整数，to_f 转换为浮点数，to_s 将返回字符串值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T21:09:28.340

你可以使用这个 Mix-In：[https ://gist.github.com/3778285](https://gist.github.com/3778285)

这将为现有的单个哈希实例添加“具有无关访问的哈希”行为，而无需复制或复制该哈希实例。这在您的情况下很有用，在从 File 读取时，或者在从 Redis 读取参数哈希时。

有关详细信息，请参阅 Gist 中的评论。

```
require 'hash_extensions' # Source: https://gist.github.com/3778285

account_params = {'name' => 'Tom' } # a regular Hash

class << account_params
  include Hash::Extensions::IndifferentAccess  # mixing-in Indifferent Access on the fly
end

account_params[:name] 
 => 'Tom'
account_params.create_symbols_only # (optional) new keys will be created as symbols
account_params['age'] = 22
 => 22
account_params.keys
 => ['name',:age] 
```

# .net - 实体框架复合外键和导航属性在包含期间未填充到实体中

> ID：10098938
> 
> 赞同：3
> 
> 时间：2012-04-11T02:04:52.457
> 
> 标签：.net, entity-framework, asp.net-web-api

有两个实体指向遗留数据库，主要实体应该使用 Include 接收辅助实体并急切加载数据。不幸的是，**即使 SQL Profiling 演示了正确选择了附加字段数据，该实体仍为 null**。

**零件实体**

```
[Table("pt_mstr")]
public class QadPart
{
    public QadPart()
    {
        this.PartGroup = new QadPartGroup();
    }

    [Column("pt_part", Order = 0), Key]
    public string Number { get; set; }

    [Column("pt_group", Order = 0), ForeignKey("PartGroup")]
    public string PartGroupCode { get; set; }

    [Column("pt_domain", Order = 1), ForeignKey("PartGroup"), Key]
    public string Domain { get; set; }

    public QadPartGroup PartGroup { get; set; }
} 
```

**PartGroup 实体**

```
[Table("PartGroups")]
public class QadPartGroup
{
    [Column("code_value", Order = 0), Key]
    public string Code { get; set; }

    [Column("code_cmmt")]
    public string Name { get; set; }

    [Column("code_domain", Order = 1), Key]
    public string Domain { get; set; }
} 
```

零件实体中的 pt_mstr 是一个 SQL 表。PartGroups 中的partgroup 实体是一个sql 视图。

零件实体有一个复合键（pt_part、pt_domain）。部件组实体有一个复合键（code_value、code_domain）。

**Linq 查询**

```
var data = db.Parts.Include<QadPart>(a => a.PartGroup).Where(a => a.Domain == domain && a.Status == "AC").ToList(); 
```

SQL 配置文件显示正在返回所有字段，包括来自 Include 的 PartGroup 字段。

在调查“数据”变量（列表）时，会填写与部件相关的字段（包括 PartGroupCode） - 但是，**PartGroup（主要包含 PartGroup.Name 和 PartGroup.Code）为空。**

PS - 我不相信这是相关的，但我也在使用 WebApi，但是这种行为也发生在 WebApi 之外。

非常感谢您提供的任何帮助。

# ckeditor - CKEditor - 使用 JQuery 即时更改样式集

> ID：10098939
> 
> 赞同：2
> 
> 时间：2012-04-11T02:04:53.887
> 
> 标签：ckeditor

我想使用从数据库中提取的样式在 CKEditor 中即时设置和重新设置样式下拉列表。我在尝试使用 JQuery 动态设置它时遇到问题。这是一个愚蠢的场景：

例如，使用 CKEditor 旁边有一个额外的下拉菜单。在下拉菜单中有一个样式集列表：Cool、Warm、Hot

当用户选择一种样式时，我会从数据库中提取相应的样式并创建一个数组来更改 CKEditor 中的默认样式下拉列表以及与该集合关联的样式。

目前，我能够让它工作的唯一方法是销毁 CKEditor 的实例并使用以下样式重新实例化一个新实例：

```
 var editor = $('#editor').ckeditorGet(); 
 editor.destroy();

 if(set == "cool"){
  //AJAX Call to get styles from DB.....
  //loop through results and build styleArray

  CKEDITOR.stylesSet.add('cold', styleArray);

   $('#editor').ckeditor( function() { /* callback code */ }, 
      { 
    stylesSet: 'cold'
   });

 }
 ... 
```

有没有办法在不破坏编辑器的情况下清除下拉列表中的当前样式并重新填充它？当 UI 不得不暂停并等待编辑器的死亡和重生时，UX 就被抬高了。

# jquery - 用jquery从html字符串中提取文本

> ID：10098940
> 
> 赞同：0
> 
> 时间：2012-04-11T02:04:54.183
> 
> 标签：jquery, html, string, text, extraction

```
html_string "<span class=\"verse\"><strong>1<\/strong>\u00a0hello world how are you?,<span class=\"trans\" title=\"\u00a0Greek brothers.\">t<\/span> I am fine thank you.<\/span><span class=\"verse\"><strong>2<\/strong>\u00a0this world is very bad.<\/span><span class=\"verse\"><strong>3<\/strong>\u00aall me are good,<\/span>" 
```

我只想提取具有类**verse**的跨度内的文本，并且它不应该包含具有类**trans**的跨度文本。

结果必须是数组形式。

从上面的字符串我必须得到这样的结果

```
["\u00a0hello world how are you? I am fine thank you","\u00a0this world is very bad.","\u00aall me are good,"] 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T02:09:47.730

这个怎么样：

```
var html_string = "<span class=\"verse\">"
                    + "<strong>1</strong>\u00a0hello world how are you?,"
                    + "<span class=\"trans\" title=\"\u00a0Greek brothers.\">t<\/span> "
                    + "I am fine thank you."
                + "</span>"
                + "<span class=\"verse\">"
                    + "<strong>2</strong>\u00a0this world is very bad."
                + "</span>"
                + "<span class=\"verse\">"
                    + "<strong>3<\/strong>\u00aall me are good,"
                + "</span>";

// Build up the DOM in a hidden element we can parse through
var $html = $('<div>',{html:html_string}).hide().appendTo('body');

// loop through each verse    
$html.find('.verse').each(function(i,e){
    // grab the verse, but first delete any span.trans
    var verse = $(e).find('span.trans').remove().end().text();
    // console.log(verse);
});
// remove the html from the DOM
$html.remove(); 
```

您应该能够在不将其添加到 DOM 的情况下循环它，但由于某种原因，我无法让它工作。可能是因为太晚了，或者我的手指在晚上罢工。无论哪种方式，如果有人找到一种不附加它的方法，请发布，我会投票。

# sql - Oracle SQL 语法错误

> ID：10098941
> 
> 赞同：0
> 
> 时间：2012-04-11T02:05:06.320
> 
> 标签：sql, oracle10g

我创建了这张表：

```
CREATE TABLE diagnosis(
  diag_id NUMBER(8),
  SCT_CODE CHAR(10),
  diag_date DATE NOT NULL,
  GP_ID CHAR(5),
  PHN CHAR(5),
  Rx CHAR(3),
  CONSTRAINT diagnosis_PK PRIMARY KEY (diag_id, SCT_CODE),
  CONSTRAINT diagnosis_FK4 FOREIGN KEY (SCT_CODE)
    REFERENCES symptom (SCT_CODE) ON DELETE CASCADE,
  CONSTRAINT diagnosis_FK1 FOREIGN KEY (GP_ID)
    REFERENCES GP (GP_ID) ON DELETE CASCADE,
  CONSTRAINT diagnosis_FK2 FOREIGN KEY (PHN)
    REFERENCES Patient (PHN) ON DELETE CASCADE,
  CONSTRAINT diagnosis_FK3 FOREIGN KEY (Rx)
    REFERENCES drug (Rx)
  ON DELETE CASCADE); 
```

我已经尝试了这两种方法来填充表格，但它不起作用。请帮助我的语法有什么问题

```
INSERT ALL
  INTO DIAGNOSIS VALUES ('10000001', '38341003', '04-APR-12', ‘GP001’, ‘p1001’, ‘Rx1’)
  INTO DIAGNOSIS VALUES ('10000002', '423430007', '07-APR-12', ‘GP001’, ‘p1001’, ‘Rx1’)
  INTO DIAGNOSIS VALUES ('10000003', '371032004', '05-APR-12', ‘GP002’, ‘p1002’, ‘Rx2’)
  INTO DIAGNOSIS VALUES ('10000004', '38341003', '08-APR-12', ‘GP003’, ‘p1003’, ‘Rx1’)
  INTO DIAGNOSIS VALUES ('10000005', '73211009', '07-APR-12', ‘GP003’, ‘p1003’, ‘Rx3’)
  INTO DIAGNOSIS VALUES ('10000006', '73211009', '06-APR-12', ‘GP004’, ‘p1004’, ‘Rx3’)
  INTO DIAGNOSIS VALUES ('10000007', '38341003', '10-APR-12', ‘GP001’, ‘p1005’, ‘Rx1’)
  SELECT * FROM DUAL;

/* Populate Diagnosis Table */

INSERT INTO Diagnosis(diag_id, SCT_CODE, diag_date, GP_ID, PHN, Rx)
  VALUES ('10000001', ‘38341003’, '04-Apr-12', 'GP001', 'p1001', 'Rx1');
INSERT INTO Diagnosis(diag_id, SCT_CODE, diag_date, GP_ID, PHN, Rx)
  VALUES ('10000002', ‘423430007’, '07-Apr-12', 'GP001', 'p1001', 'Rx1');
INSERT INTO Diagnosis(diag_id, SCT_CODE, diag_date, GP_ID, PHN, Rx)
  VALUES ('10000003', ‘371032004’, '05-Apr-12', 'GP003', 'p1002', 'Rx2');
INSERT INTO Diagnosis(diag_id, SCT_CODE, diag_date, GP_ID, PHN, Rx)
  VALUES ('10000004', ‘38341003’, '08-Apr-12', 'GP003', 'p1003', 'Rx1');
INSERT INTO Diagnosis(diag_id, SCT_CODE, diag_date, GP_ID, PHN, Rx)
  VALUES ('10000005’, ‘73211009’, '07-Apr-12', 'GP003', 'p1003', 'Rx3');
INSERT INTO Diagnosis(diag_id, SCT_CODE, diag_date, GP_ID, PHN, Rx)
  VALUES ('10000006', ‘73211009’, '06-Apr-12', 'GP004', 'p1004', 'Rx3');
INSERT INTO Diagnosis(diag_id, SCT_CODE, diag_date, GP_ID, PHN, Rx)
  VALUES ('10000006', ‘38341003’, '10-Apr-12', 'GP001', 'p1005', 'Rx1'); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T03:17:24.283

正如评论者（@Glenn）所说，您的问题很可能是单引号的使用非常不一致。

这两项工作：

```
INSERT ALL
  INTO DIAGNOSIS VALUES 
      ('10000001', '38341003', '04-APR-12', 'GP001', 'p1001', 'Rx1')
  INTO DIAGNOSIS VALUES 
      ('10000002', '423430007', '07-APR-12', 'GP001', 'p1001', 'Rx1')
SELECT * FROM DUAL;

INSERT INTO Diagnosis(diag_id, SCT_CODE, diag_date, GP_ID, PHN, Rx)
  VALUES ('10000003', '371032004', '05-Apr-12', 'GP003', 'p1002', 'Rx2');
INSERT INTO Diagnosis(diag_id, SCT_CODE, diag_date, GP_ID, PHN, Rx)
  VALUES ('10000004', '38341003', '08-Apr-12', 'GP003', 'p1003', 'Rx1'); 
```

我所做和经历的一切，并确保`'`始终使用它。

看到这个 sqlfiddle： [http](http://sqlfiddle.com/#!4/c824d/1) ://sqlfiddle.com/#!4/c824d/ 1（我已经删除了约束，因为我不想输入所有这些。）

不过，就我个人而言，我一直不喜欢第一种方法，因为这`select * from dual`看起来太武断了（是的，我知道它有效——这更像是一个审美问题。）

# php - PHP mkdir 权限

> ID：10098944
> 
> 赞同：1
> 
> 时间：2012-04-11T02:05:56.777
> 
> 标签：php, linux, cpanel, mkdir

我尝试了以下方法，但似乎该文件夹是在服务器（cPanel Linux）上创建的，`755`而不是`777`为什么？我怎样才能让它写权限777

```
mkdir($location.$folderName, 0777);
mkdir($location.$folderName, 777); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T02:15:49.607

尝试

```
chmod($location.$folderName, 0777); 
```

有关更改文件模式的更多示例和文档，请参阅[http://php.net/manual/en/function.chmod.php](http://php.net/manual/en/function.chmod.php)

如果您仍然有问题...有时您需要更改所有权

```
 chown($location.$folderName, "root"); 
```

有关文档，请参阅[http://www.php.net/manual/en/function.chown.php](http://www.php.net/manual/en/function.chown.php)

# php - 在 Jquery 中，如何提醒 JSON 对象的一部分？我得到“未定义”

> ID：10098946
> 
> 赞同：1
> 
> 时间：2012-04-11T02:06:11.270
> 
> 标签：php, javascript, jquery

我有一个数组：

```
$result = array('statusAlert' => 'Your input was validated'
                 'input' => $input); // $input is a string

json_encode($result); 
```

在 jQuery 中，我想分别提醒 'statusAlert' 和 'input' 吗？我如何访问它们？

我试过`alert(result.statusAlert)`, `alert(result[0])`，`alert(result.statusAlert[0])`但没有一个奏效。

## 编辑

我试图`ajax()`在 jQuery的“成功”回调函数中做到这一点

当我提醒（结果）时，我得到：

```
{"statusAlert":"Your input was validated","input":"this is the string input"} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T02:19:19.767

你在参数中指定`dataType: 'json'`了`$.ajax`吗？

假设你有并且你已经使用了 jQuery`$.getJSON`或`$.ajax`函数并且它仍然无法工作，那么你的结果应该是一个数组，而不是一个对象，因为你在 PHP 中将它创建为一个数组。你会想把它读成：

```
alert(result['statusAlert']); 
```

和

```
alert(result['input']); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T02:22:31.950

更改您的`.ajax()`请求以包括`dataType:'json'`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-11T02:29:23.443

如果你有一个像这样的有效 json

```
'{"statusAlert":"Your input was validated","input":"this is the string input"}' 
```

你可以得到这样的值

```
jsonObj.statusAlert

jsonObj.input 
```

这是示例[http://jsfiddle.net/kfrTz/8/](http://jsfiddle.net/kfrTz/8/)

您可以使用[http://jsonlint.com/](http://jsonlint.com/)来验证您的 JSON 格式是否正确。

在 ajax 请求中指定`json`为数据类型值将确保响应以`json`格式返回到成功回调。

```
$.ajax({
   url:"yourserverpage.php",
   datatype='json',
   success: function(data) {
      alert(data.statusAlert);
   }

 }); 
```

# php - JQuery - 我如何操作选项卡

> ID：10098948
> 
> 赞同：0
> 
> 时间：2012-04-11T02:06:25.433
> 
> 标签：php, jquery, jquery-ui-tabs

如何操作 jquery 选项卡，例如，当在 tab2 中触发提交表单时，选择的页面选项卡应该是 tab2 而不是 tab1？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T02:09:14.380

如果您使用 jQuery UI 选项卡，请检查它们的`selected`选项。[文档](http://jqueryui.com/demos/tabs/)。

因此，在您的`php`代码中，您必须在选项卡上设置此选项，如下所示：

```
$('#tabs').tabs({ selected: 2}); // 2nd tab will be default selected 
```

或者，在标签创建之后（例如，如果在单独的文件中创建代码）：

```
$('#tabs').tabs('option', 'selected', 2); 
```

此外，您可以使用以下方法模拟按选项卡单击：

```
$('#tabs a[href=#tab_id]').click(); // where `tab_id` is tab content identifier 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T02:13:08.173

如果它只是用于 UI 显示，只需像这样以编程方式触发选项卡单击操作`$("tab2Selector").click();`

# c# - 需要使用按位运算先升后降的快速函数

> ID：10098949
> 
> 赞同：2
> 
> 时间：2012-04-11T02:06:28.087
> 
> 标签：c#, bit-manipulation

我需要一个整数值函数，它返回一个升序，直到它达到给定的最大值，然后再次下降。我称它为Ziggurat：

0 1 2 3 4 5 6 6 5 4 3 2 1 0

步骤都是一个。最大值（在序列的中间）必须出现两次。在零到最大 2* 的范围之外，我不在乎会发生什么。

我希望函数快速 - 没有分支。我更喜欢按位运算。

作为一个不起作用的例子，这是我的 Pyramid 函数，以及我的绝对值实现：

```
private static readonly int LONG_ABS_MASK_SHIFT = sizeof(long) * 8 - 1;

/// <summary>
/// Compute the Absolute value of a long without branching.
/// 
/// Note: This will deviate from Math.Abs for Int64.MinValue, where the .NET library would throw an exception.
/// The most negative number cannot be made positive.
/// </summary>
/// <param name="v">Number to transform.</param>
/// <returns>Absolute value of v.</returns>
public static long Abs(this long v)
{
    long mask = v >> LONG_ABS_MASK_SHIFT;
    return (v ^ mask) - mask;
}

public static long Pyramid(this long N, long max)
{
    return max - (max - N).Abs();
} 
```

这个 Pyramid 函数创建像 0 1 2 3 4 5 6 5 4 3 2 1 0 这样的序列

请注意，中间的数字只出现一次。

我有一个想法，将查找表存储为 long 或 BigInteger 中的连续位块，并将它们移位和屏蔽掉，但这对于长系列来说占用了太多内存。不过，它使用的指令很少。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T02:23:37.360

尝试这个：

```
public static long Pyramid2(this long N, long max)
{
    return N.Pyramid(max + 1) + ((max - N) >> -1);
} 
```

*结果：*

0 1 2 3 4 5 6 6 5 4 3 2 1 0

* * *

结果如下：

```
 \ N=0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18
  N.Pyramid(6 + 1)    0  1  2  3  4  5  6  7  6  5  4  3  2  1  0 -1 -2 -3 -4
+ ((max - N) >> -1)   0  0  0  0  0  0  0 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
=                     0  1  2  3  4  5  6  6  5  4  3  2  1  0 -1 -2 -3 -4 -5 
```

*Pyramid* 是问题中定义的原始*Pyramid*方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T05:28:39.520

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-11T02:11:12.510

```
public static IEnumerable<long> getPyramid(long maxValue)
{
    for(long i = 0; i <= maxValue; i++)
    {
        yield return i;
    }

    for(long i = maxValue; i >=0; i--)
    {
        yield return i;
    }
} 
```

一个人可能会使用 select/reverse 或类似的东西来处理整个事情`Concat` `Enumerable.Range`，但它的效率可能会稍微低一些，因为我不知道让它倒计时的简单方法。反向将比产生 for 循环更多“工作”，并且选择（执行 maxvalue 减去 的当前迭代`Enumerable.Range`）将执行一堆额外的算术，所有这些都是为了避免几行代码。

IE：

```
public static IEnumerable<long getPyramid(long maxValue)
{
  return Enumerable.Range(0, maxValue)
  .Concat(Enumerable.Range(0, maxValue).Select(num => maxValue - num));
} 
```

# python - csvkit & django aka 使用 csvkit 作为模块而不是从命令行

> ID：10098950
> 
> 赞同：2
> 
> 时间：2012-04-11T02:06:35.497
> 
> 标签：python, django, csv, django-views

我需要在 django 应用程序中进行一些 csv 文件处理。
我听说过 csvkit，它看起来很酷。
[github页面](https://github.com/onyxfish/csvkit)

想尝试一下，但我不知道如何将 csvkit 作为模块使用。具体来说，我想使用 CSVJSON 实用程序。我需要向它传递一个 csv 文件（并希望有一些其他参数），但不能完全弄清楚如何做到这一点。
[CSV JSON 文档](http://csvkit.readthedocs.org/en/latest/scripts/csvjson.html)

我想向实用程序传递一个上传的 csv 文件，上传的文件可以在内存中（如果它足够小）或在临时存储区域中。CSVJSON 看起来需要一个文件路径或流。如果有人能告诉我我需要对上传的文件执行哪些操作以使 CSVJSON 能够使用它，那将是一个很好的奖励。

在 django 1.3 中，我计划在 form_valid 方法中完成这项工作。

希望有一些 python 技能的人可以帮助告诉我我需要做什么。谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-18T04:59:46.743

您可以使用以下代码导入 CSVKit JSON 类：

```
from csvkit.utilities.csvjson import CSVJSON 
```

CSVKit 类有 2 个构造函数选项；第一个是命令行参数列表，第二个是输出流。如果未提供输出流，它将打印到标准输出。

argparser 模块用于解析命令行参数，因此[它的文档](http://argparse.googlecode.com/svn/trunk/doc/parse_args.html)会很有帮助。简短的版本就像将您在实际命令行中使用的原始参数字符串用空格分开一样。例如：

```
$ csvjson --key Date /path/to/input/file 
```

将转化为：

```
from csvkit.utilities.csvjson import CSVJSON
args = ["--key", "Date", "/path/to/input/file"]
CSVJSON(args).main() 
```

如果您不想从输入文件中读取，但无法从命令行将输入文件传递到标准输入，您可以将 sys.stdin 对象替换为您的内存版本。唯一的规定是对象的行为必须像输入文件。**假设您在名为input_string**的变量中有 CSV 文件的字符串版本，您可以使用[StringIO 库](http://docs.python.org/library/stringio.html)来创建字符串缓冲区：

```
import StringIO
import sys
new_stdin = StringIO.StringIO(input_string)
sys.stdin = new_stdin
args = ["--key", "Date"]
CSVJSON(args).main() 
```

最后，如果要打印到文件而不是标准输出，请将打开的文件对象作为第二个参数传递：

```
output_file = open("/path/to/output.txt", "w")
CSVJSON(args, output_file).main()
output_file.close() 
```

请记住，在您自己关闭文件对象之前，它不会刷新缓冲区；CSVJSON 不会为您关闭它。

# opengl-es - 绘制 BACK 面时，它们的法线是否会自动反转？

> ID：10098954
> 
> 赞同：5
> 
> 时间：2012-04-11T02:07:17.290
> 
> 标签：opengl-es, webgl

我通过调用仅绘制几何图形的背面`gl.cullFace(gl.FRONT)`。我注意到这些表面上的光影与我的预期相反。为了正确渲染，我是否必须明确反转背面表面法线的方向，还是 OpenGL 子系统会自动执行此操作？

编辑：想一想，如果我手动反转它们的法线，它们将成为正面并被剔除。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-11T02:21:54.667

OpenGL前/后检测基于缠绕，而不是正常。法线向量对多边形是正面还是背面没有任何影响。

我认为您想要做的是设置[glLightModel](http://www.opengl.org/sdk/docs/man/xhtml/glLightModel.xml)`GL_LIGHT_MODEL_TWO_SIDE`的选项。

> GL_LIGHT_MODEL_TWO_SIDE
> 
> params 是一个整数或浮点值，用于指定是否对多边形进行单面或双面光照计算。它对点、线或位图的光照计算没有影响。如果 params 为 0（或 0.0），则指定单面光照，光照方程中仅使用正面材质参数。否则，将指定两侧照明。在这种情况下，使用背面材质参数照亮背面多边形的顶点 **并在计算照明方程之前反转它们的法线**。正面多边形的顶点始终使用正面材质参数进行照明，其法线不变。初始值为 0。

请注意，这仅适用于固定管道。

===编辑===

使用自定义着色器（GLES2.0 或 OpenGL3+），然后在片段着色器中您可以访问特殊的 boolean `gl_FrontFacing`。要在着色器中模拟两侧照明，只需测试`gl_FrontFacing`并将 normal 乘以负值 if `false`。

# java - Java 复数，3 类

> ID：10098958
> 
> 赞同：1
> 
> 时间：2012-04-11T02:09:01.047
> 
> 标签：java, java

我将重复我在[java](/questions/tagged/java "显示标记为“java”的问题")中必须做的事情，以我认为我需要思考的方式来完成这个任务。（对不起，我是编程新手）。

头等舱；为复数定义类。我发现这很容易，我的答案如下。

```
public class Complex {
    private double real;
    private double imaginary;

    public Complex()
    {
        this( 0.0, 0.0 );
    }

    public Complex( double r, double i )
    {
        real = r;
        imaginary = i;
    } 
} 
```

二等舱；使用公共静态方法进行加法和减法，从第一类中调用实数和虚数。我发现这部分更具挑战性，因为我没有 100% 掌握这一点。

```
Public class ComplexArith
public static ComplexAdd(Complex one, Complex two)
return Complex(one.getReal() + two.getReal(), one.getImaginary() + two.getImaginary());

public static ComplexSub(Complex one, Complex two)
return Complex(one.getReal() - two.getReal(), one.getImaginary - two.getImaginary()); 
```

第三部分是要求用户输入，并对复数集进行加减运算。我对此并不熟悉，因为我从来不需要以 (0.0,0.0) 格式要求用户输入。

对整体代码有任何见解吗？我什至走在正确的轨道上吗？

编辑：

第一节课我撞了。谢谢你们。

第二节课我有编译问题，因为我没有完全理解一些东西。

```
public class ComplexArith{
public static Complex add(Complex one, Complex two)
{
return Complex(one.getReal() + two.getReal(), one.getImaginary() + two.getImaginary());
}
public static Complex sub(Complex one, Complex two)
{
return Complex(one.getReal() - two.getReal(), one.getImaginary - two.getImaginary());
}
} 
```

我知道需要定义一和二，但我不明白如何定义它们。我会将它们定义为什么？我以为它是从 double r, double i 的 Complex 类中调用的。

我还认为`.getImaginary`在第一堂课中也被定义了。这里是第一堂课。

```
public class Complex
{
private double real;
private double imaginary;

public Complex()
{
    this( 0.0, 0.0 );
}

public Complex( double r, double i )
{
    real = r;
    imaginary = i;
}

public double getReal() {
  return this.real;
}

public double getImaginary() {
  return this.imaginary;
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-26T23:02:54.033

这是我的实现，我在一堂课上做所有事情：

```
package name.puzio.math;

public final class ComplexNumber {
private final double imaginary;
private final double real;

@Override
public final boolean equals(Object object) {
    if (!(object instanceof ComplexNumber))
        return false;
    ComplexNumber a = (ComplexNumber) object;
    return (real == a.real) && (imaginary == a.imaginary);
}

public ComplexNumber(double real, double imaginary) {
    this.imaginary = imaginary;
    this.real = real;
}

public static final ComplexNumber createPolar(double amount, double angel) {
    return new ComplexNumber(amount * Math.cos(angel), amount * Math.sin(angel));
}

public final double getImaginary() {
    return imaginary;
}

public final double getReal() {
    return real;
}

public final double getAmount() {
    return Math.sqrt((real * real) + (imaginary * imaginary));
}

public final double getAngle() {
    return Math.atan2(imaginary, real);
}

public final ComplexNumber add(ComplexNumber b) {
    return add(this, b);
}

public final ComplexNumber sub(ComplexNumber b) {
    return sub(this, b);
}

public final ComplexNumber div(ComplexNumber b) {
    return div(this, b);
}

public final ComplexNumber mul(ComplexNumber b) {
    return mul(this, b);
}

public final ComplexNumber conjugation() {
    return conjugation(this);
}

/**
 * Addition:
 * @param a
 * @param b
 * @return
 */
private final static ComplexNumber add(ComplexNumber a, ComplexNumber b) {
    return new ComplexNumber(a.real + b.real, a.imaginary + b.imaginary);
}

/**
 * Subtraktion:
 * @param a
 * @param b
 * @return
 */
private final static ComplexNumber sub(ComplexNumber a, ComplexNumber b) {
    return new ComplexNumber(a.real - b.real, a.imaginary - b.imaginary);
}

/**
 * Multiplikation:
 * @param a
 * @param b
 * @return
 **/
private final static ComplexNumber mul(ComplexNumber a, ComplexNumber b) {
    return new ComplexNumber((a.real * b.real) - (a.imaginary * b.imaginary), (a.imaginary * b.real) + (a.real * b.imaginary));
}

/**
 * Division:
 * @param a
 * @param b
 * @return
 **/
private final static ComplexNumber div(ComplexNumber a, ComplexNumber b) {
    double d = (b.real * b.real) + (b.imaginary * b.imaginary);
    if (d == 0)
        return new ComplexNumber(Double.NaN, Double.NaN);
    return new ComplexNumber(((a.real * b.real) + (a.imaginary * b.imaginary)) / d, ((a.imaginary * b.real) - (a.real * b.imaginary)) / d);
}

/**
 * Konjugation:
 * @param a
 * @return
 **/

private final static ComplexNumber conjugation(ComplexNumber a) {
    return new ComplexNumber(a.real, -a.imaginary);
}
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T02:16:56.993

好吧，您走在正确的轨道上，但是您的`Complex`对象需要吸气剂。

例如：

```
 public class Complex
{
    private double real;
    private double imaginary;

    public Complex()
    {
        this( 0.0, 0.0 );
    }

    public Complex( double r, double i )
    {
        real = r;
        imaginary = i;
    }

    public double getReal() {
      return this.real;
    }

    public double getImaginary() {
      return this.imaginary;
    }
} 
```

您还需要方法的返回类型：

```
public class ComplexArith
{   
    public static Complex complexAdd(Complex one, Complex two) {
        return Complex(one.getReal() + two.getReal(),
                      one.getImaginary() + two.getImaginary());
    }

    public static Complex complexSub(Complex one, Complex two) {
        return Complex(one.getReal() - two.getReal(),
                       one.getImaginary - two.getImaginary());
    }
} 
```

此外，它与您的程序的功能无关，但习惯上让您的方法使用`camelCase`. 所以你的方法应该是这样的：

```
public static Complex complexAdd(Complex one, Complex two) {
    return Complex(one.getReal() + two.getReal(), 
                  one.getImaginary() + two.getImaginary());
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-11T02:18:18.190

就个人而言，我会将这些算术运算放在 Complex 类中。这些是对复数的真正操作，所以我不会将它们封装在 Complex 类之外。

我会考虑使 Complex 不可变。这样是线程安全的。

我喜欢静态的 add、sub、mul、div 方法。确保他们返回一个 Complex（现在没有）。其他方法，如余弦、正弦等，可能属于复杂包中的 Math 类。有关实数的示例，请参见 java.lang.Math。

您需要返回“新复合体”。你写的代码不会编译。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T02:15:48.110

鉴于您所说的是作业，您在某种程度上走在正确的轨道上。

但是，在您的第二堂课中，您正在调用对象上`getReal()`的`getImaginary()`方法。`Complex`但是它们的定义并没有出现在`Complex`类定义的任何地方。

而且您的方法`ComplexArith`没有返回类型。

仅这些将阻止您的代码按原样编译。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-11T02:48:14.587

将格式中的a转换为 a的*正确*方法是使用正则表达式。但是，如果您不熟悉编程，您的讲师可能会怀疑您从 Internet 上复制了该解决方案 :) 尝试以下操作：`String``(r,i)``Complex`

```
public static Complex fromString(String str) {
    str = str.substring(1, str.length() - 1);
    String[] parts = str.split(",");
    double r = Double.valueOf(parts[0]);
    double i = Double.valueOf(parts[1]);
    return new Complex(r, i);
} 
```

您可以在此处找到有关 Java String 类的更多信息：http: [//docs.oracle.com/javase/6/docs/api/java/lang/String.html](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-07-03T13:29:20.817

虽然这已经得到回答，但我认为人们可能会受益于下面的类，它执行了许多与复数相关的功能。

这已在 MIT 许可下发布，GitHub 项目在[这里](https://github.com/abdulfatir/jcomplexnumber/)。

```
/**
 * <code>ComplexNumber</code> is a class which implements complex numbers in Java. 
 * It includes basic operations that can be performed on complex numbers such as,
 * addition, subtraction, multiplication, conjugate, modulus and squaring. 
 * The data type for Complex Numbers.
 * <br /><br />
 * The features of this library include:<br />
 * <ul>
 * <li>Arithmetic Operations (addition, subtraction, multiplication, division)</li>
 * <li>Complex Specific Operations - Conjugate, Inverse, Absolute/Magnitude, Argument/Phase</li>
 * <li>Trigonometric Operations - sin, cos, tan, cot, sec, cosec</li>
 * <li>Mathematical Functions - exp</li>
 * <li>Complex Parsing of type x+yi</li>
 * </ul>
 * 
 * @author      Abdul Fatir
 * @version     1.1
 * 
 */
public class ComplexNumber
{
    /**
    * Used in <code>format(int)</code> to format the complex number as x+yi
    */
    public static final int XY = 0;
    /**
    * Used in <code>format(int)</code> to format the complex number as R.cis(theta), where theta is arg(z)
    */
    public static final int RCIS = 1;
    /**
    * The real, Re(z), part of the <code>ComplexNumber</code>.
    */
    private double real;
    /**
    * The imaginary, Im(z), part of the <code>ComplexNumber</code>.
    */
    private double imaginary;
    /**
    * Constructs a new <code>ComplexNumber</code> object with both real and imaginary parts 0 (z = 0 + 0i).
    */
    public ComplexNumber()
    {
        real = 0.0;
        imaginary = 0.0;
    }

    /**
    * Constructs a new <code>ComplexNumber</code> object.
    * @param real the real part, Re(z), of the complex number
    * @param imaginary the imaginary part, Im(z), of the complex number
    */

    public ComplexNumber(double real, double imaginary)
    {
        this.real = real;
        this.imaginary = imaginary;
    }

    /**
    * Adds another <code>ComplexNumber</code> to the current complex number.
    * @param z the complex number to be added to the current complex number
    */

    public void add(ComplexNumber z)
    {
        set(add(this,z));
    }

    /**
    * Subtracts another <code>ComplexNumber</code> from the current complex number.
    * @param z the complex number to be subtracted from the current complex number
    */

    public void subtract(ComplexNumber z)
    {
        set(subtract(this,z));
    }

    /**
    * Multiplies another <code>ComplexNumber</code> to the current complex number.
    * @param z the complex number to be multiplied to the current complex number
    */

    public void multiply(ComplexNumber z)
    {
        set(multiply(this,z));
    }
    /**
    * Divides the current <code>ComplexNumber</code> by another <code>ComplexNumber</code>.
    * @param z the divisor
    */  
    public void divide(ComplexNumber z)
    {
        set(divide(this,z));
    }
    /**
    * Sets the value of current complex number to the passed complex number.
    * @param z the complex number
    */
    public void set(ComplexNumber z)
    {
        this.real = z.real;
        this.imaginary = z.imaginary;
    }
    /**
    * Adds two <code>ComplexNumber</code>.
    * @param z1 the first <code>ComplexNumber</code>.
    * @param z2 the second <code>ComplexNumber</code>.
    * @return the resultant <code>ComplexNumber</code> (z1 + z2).
    */
    public static ComplexNumber add(ComplexNumber z1, ComplexNumber z2)
    {
        return new ComplexNumber(z1.real + z2.real, z1.imaginary + z2.imaginary);
    }

    /**
    * Subtracts one <code>ComplexNumber</code> from another.
    * @param z1 the first <code>ComplexNumber</code>.
    * @param z2 the second <code>ComplexNumber</code>.
    * @return the resultant <code>ComplexNumber</code> (z1 - z2).
    */  
    public static ComplexNumber subtract(ComplexNumber z1, ComplexNumber z2)
    {
        return new ComplexNumber(z1.real - z2.real, z1.imaginary - z2.imaginary);
    }
    /**
    * Multiplies one <code>ComplexNumber</code> to another.
    * @param z1 the first <code>ComplexNumber</code>.
    * @param z2 the second <code>ComplexNumber</code>.
    * @return the resultant <code>ComplexNumber</code> (z1 * z2).
    */  
    public static ComplexNumber multiply(ComplexNumber z1, ComplexNumber z2)
    {
        double _real = z1.real*z2.real - z1.imaginary*z2.imaginary;
        double _imaginary = z1.real*z2.imaginary + z1.imaginary*z2.real;
        return new ComplexNumber(_real,_imaginary);
    }
    /**
    * Divides one <code>ComplexNumber</code> by another.
    * @param z1 the first <code>ComplexNumber</code>.
    * @param z2 the second <code>ComplexNumber</code>.
    * @return the resultant <code>ComplexNumber</code> (z1 / z2).
    */      
    public static ComplexNumber divide(ComplexNumber z1, ComplexNumber z2)
    {
        ComplexNumber output = multiply(z1,z2.conjugate());
        double div = Math.pow(z2.mod(),2);
        return new ComplexNumber(output.real/div,output.imaginary/div);
    }

    /**
    * The complex conjugate of the current complex number.
    * @return a <code>ComplexNumber</code> object which is the conjugate of the current complex number
    */

    public ComplexNumber conjugate()
    {
        return new ComplexNumber(this.real,-this.imaginary);
    }

    /**
    * The modulus, magnitude or the absolute value of current complex number.
    * @return the magnitude or modulus of current complex number
    */

    public double mod()
    {
        return Math.sqrt(Math.pow(this.real,2) + Math.pow(this.imaginary,2));
    }

    /**
    * The square of the current complex number.
    * @return a <code>ComplexNumber</code> which is the square of the current complex number.
    */

    public ComplexNumber square()
    {
        double _real = this.real*this.real - this.imaginary*this.imaginary;
        double _imaginary = 2*this.real*this.imaginary;
        return new ComplexNumber(_real,_imaginary);
    }
    /**
    * @return the complex number in x + yi format
    */
    @Override
    public String toString()
    {
        String re = this.real+"";
        String im = "";
        if(this.imaginary < 0)
            im = this.imaginary+"i";
        else
            im = "+"+this.imaginary+"i";
        return re+im;
    }
    /**
    * Calculates the exponential of the <code>ComplexNumber</code>
    * @param z The input complex number
    * @return a <code>ComplexNumber</code> which is e^(input z)
    */
    public static ComplexNumber exp(ComplexNumber z)
    {
        double a = z.real;
        double b = z.imaginary;
        double r = Math.exp(a);
        a = r*Math.cos(b);
        b = r*Math.sin(b);
        return new ComplexNumber(a,b);
    }
    /**
    * Calculates the <code>ComplexNumber</code> to the passed integer power.
    * @param z The input complex number
    * @param power The power.
    * @return a <code>ComplexNumber</code> which is (z)^power
    */
    public static ComplexNumber pow(ComplexNumber z, int power)
    {
        ComplexNumber output = new ComplexNumber(z.getRe(),z.getIm());
        for(int i = 1; i < power; i++)
        {
            double _real = output.real*z.real - output.imaginary*z.imaginary;
            double _imaginary = output.real*z.imaginary + output.imaginary*z.real;
            output = new ComplexNumber(_real,_imaginary);
        }
        return output;
    }
    /**
    * Calculates the sine of the <code>ComplexNumber</code>
    * @param z the input complex number
    * @return a <code>ComplexNumber</code> which is the sine of z.
    */
    public static ComplexNumber sin(ComplexNumber z)
    {
        double x = Math.exp(z.imaginary);
        double x_inv = 1/x;
        double r = Math.sin(z.real) * (x + x_inv)/2;
        double i = Math.cos(z.real) * (x - x_inv)/2;
        return new ComplexNumber(r,i);
    }
    /**
    * Calculates the cosine of the <code>ComplexNumber</code>
    * @param z the input complex number
    * @return a <code>ComplexNumber</code> which is the cosine of z.
    */
    public static ComplexNumber cos(ComplexNumber z)
    {
        double x = Math.exp(z.imaginary);
        double x_inv = 1/x;
        double r = Math.cos(z.real) * (x + x_inv)/2;
        double i = -Math.sin(z.real) * (x - x_inv)/2;
        return new ComplexNumber(r,i);
    }
    /**
    * Calculates the tangent of the <code>ComplexNumber</code>
    * @param z the input complex number
    * @return a <code>ComplexNumber</code> which is the tangent of z.
    */
    public static ComplexNumber tan(ComplexNumber z)
    {
        return divide(sin(z),cos(z));
    }
    /**
    * Calculates the co-tangent of the <code>ComplexNumber</code>
    * @param z the input complex number
    * @return a <code>ComplexNumber</code> which is the co-tangent of z.
    */
    public static ComplexNumber cot(ComplexNumber z)
    {
        return divide(new ComplexNumber(1,0),tan(z));
    }
    /**
    * Calculates the secant of the <code>ComplexNumber</code>
    * @param z the input complex number
    * @return a <code>ComplexNumber</code> which is the secant of z.
    */
    public static ComplexNumber sec(ComplexNumber z)
    {
        return divide(new ComplexNumber(1,0),cos(z));
    }
    /**
    * Calculates the co-secant of the <code>ComplexNumber</code>
    * @param z the input complex number
    * @return a <code>ComplexNumber</code> which is the co-secant of z.
    */
    public static ComplexNumber cosec(ComplexNumber z)
    {
        return divide(new ComplexNumber(1,0),sin(z));
    }
    /**
    * The real part of <code>ComplexNumber</code>
    * @return the real part of the complex number
    */
    public double getRe()
    {
        return this.real;
    }
    /**
    * The imaginary part of <code>ComplexNumber</code>
    * @return the imaginary part of the complex number
    */
    public double getIm()
    {
        return this.imaginary;
    }
    /**
    * The argument/phase of the current complex number.
    * @return arg(z) - the argument of current complex number
    */
    public double getArg()
    {
        return Math.atan2(imaginary,real);
    }
    /**
    * Parses the <code>String</code> as a <code>ComplexNumber</code> of type x+yi.
    * @param s the input complex number as string
    * @return a <code>ComplexNumber</code> which is represented by the string.
    */
    public static ComplexNumber parseComplex(String s)
    {
        s = s.replaceAll(" ","");
        ComplexNumber parsed = null;
        if(s.contains(String.valueOf("+")) || (s.contains(String.valueOf("-")) && s.lastIndexOf('-') > 0))
        {
            String re = "";
            String im = "";
            s = s.replaceAll("i","");
            s = s.replaceAll("I","");
            if(s.indexOf('+') > 0)
            {
                re = s.substring(0,s.indexOf('+'));
                im = s.substring(s.indexOf('+')+1,s.length());
                parsed = new ComplexNumber(Double.parseDouble(re),Double.parseDouble(im));
            }
            else if(s.lastIndexOf('-') > 0)
            {
                re = s.substring(0,s.lastIndexOf('-'));
                im = s.substring(s.lastIndexOf('-')+1,s.length());
                parsed = new ComplexNumber(Double.parseDouble(re),-Double.parseDouble(im));
            }
        }
        else
        {
            // Pure imaginary number
            if(s.endsWith("i") || s.endsWith("I"))
            {
                s = s.replaceAll("i","");
                s = s.replaceAll("I","");
                parsed = new ComplexNumber(0, Double.parseDouble(s));
            }
            // Pure real number
            else
            {
                parsed = new ComplexNumber(Double.parseDouble(s),0);
            }
        }
        return parsed;
    }
    /**
    * Checks if the passed <code>ComplexNumber</code> is equal to the current.
    * @param z the complex number to be checked
    * @return true if they are equal, false otherwise
    */
    @Override
    public final boolean equals(Object z) 
    {
        if (!(z instanceof ComplexNumber))
            return false;
        ComplexNumber a = (ComplexNumber) z;
        return (real == a.real) && (imaginary == a.imaginary);
    }
    /**
    * The inverse/reciprocal of the complex number.
    * @return the reciprocal of current complex number.
    */
    public ComplexNumber inverse()
    {
        return divide(new ComplexNumber(1,0),this);
    }
    /**
    * Formats the Complex number as x+yi or r.cis(theta)
    * @param format_id the format ID <code>ComplexNumber.XY</code> or <code>ComplexNumber.RCIS</code>.
    * @return a string representation of the complex number
    * @throws IllegalArgumentException if the format_id does not match.
    */
    public String format(int format_id) throws IllegalArgumentException
    {
        String out = "";
        if(format_id == XY)
            out = toString();
        else if(format_id == RCIS)
        {
            out = mod()+" cis("+getArg()+")";
        }
        else
        {
            throw new IllegalArgumentException("Unknown Complex Number format.");
        }
        return out;
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-05-22T16:32:25.300

这是不正确的！

```
 public static ComplexNumber exp(ComplexNumber z)
{
    double a = z.real;
    double b = z.imaginary;
    double r = Math.exp(a);
    a = r*Math.cos(b);
    b = r*Math.sin(b);
    return new ComplexNumber(a,b);
} 
```

应该

```
 public static ComplexNumber exp(ComplexNumber z)
{
    double theta = Math.atan2(r.real/r.imag);
    double r =  mod();
    double a = r*Math.cos(theta );
    double b = r*Math.sin(theta );
    return new ComplexNumber(a,b);
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-10-29T17:44:17.083

或者.......你可以放弃所有这些废话，只使用 Apache Commons 库，它比这里的任何东西都好用，并且包括复杂的幂运算等基本操作。

[https://commons.apache.org/proper/commons-math/userguide/complex.html](https://commons.apache.org/proper/commons-math/userguide/complex.html)

但前提是您不想重新发明轮子。

# asp.net - 如何将表格数据显示为用户评分

> ID：10098962
> 
> 赞同：1
> 
> 时间：2012-04-11T02:09:14.697
> 
> 标签：asp.net

我想在我的 asp.net 站点中使用条形和评级显示用户评级。该值是从数据表中检索的（它类似于 YouTube 的喜欢/不喜欢栏）有人可以指导我在 asp.net 网页中进行操作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T02:10:49.693

微软最近发布了一个很酷的新的 ASP.NET 服务器控件——它可以与 ASP.NET 3.5 一起免费使用，以启用丰富的基于浏览器的图表场景：[http ://weblogs.asp.net/scottgu/archive/2008/11 /24/new-asp-net-charting-control-lt-asp-chart-runat-quot-server-quot-gt.aspx](http://weblogs.asp.net/scottgu/archive/2008/11/24/new-asp-net-charting-control-lt-asp-chart-runat-quot-server-quot-gt.aspx)

![在此处输入图像描述](../Images/e5f115d2f59cbe5c620672d21cdf6433.png)

# java - 如何通过软件浏览网站？

> ID：10098963
> 
> 赞同：2
> 
> 时间：2012-04-11T02:09:29.020
> 
> 标签：java, javascript, python, html, navigation

我需要浏览一个主要用 Javascript 编写的网站。根本没有硬链接，因为页面只是通过脚本修改。我可以做我需要一个接一个地使用 Javascript 注入，但是 chrome 开始搜索我的输入，而不是在某个字符串长度后注入它。我尝试在 HTML 中使用框架来执行此操作，但 chrome 不允许我在框架内使用 Javascript，因为源来自不同的域。有什么好方法可以做到这一点吗？我已经研究过使用 Java 或 Python，但我没有看到任何可以让您使用 Javascript 的东西。

编辑：感谢您告诉我有关不同软件的信息，但我不想使用其他第三方软件。我真的很想知道如何从 HTML 页面以系统的方式执行 Javascript 注入。我可以从浏览器中完成，那么为什么我不能从 HTML 文档中完成呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T02:43:57.777

您可以使用 Selenium 之类的工具来模拟用户在 Web 浏览器中单击内容（我相信它实际上“驱动”了您选择的任何浏览器的真实实例。）

Selenium 有一种特定于域的语言，用于指定您想要执行的操作，以及用于以编程方式控制它的 Python 绑定。我还没有真正使用它，所以我不能多说，但你应该去看看。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T05:17:50.087

也许[Phantom JS](http://www.phantomjs.org/ "幻影JS")是您正在寻找的？这是一个带有 JavaScript API 的 Headless Webkit - 不需要浏览器。还没有使用它，但我们公司正在研究它用于 JavaScript 单元测试自动化。

# jquery - jQuery 在函数之间切换 - 执行零、一、二、三...次

> ID：10098966
> 
> 赞同：1
> 
> 时间：2012-04-11T02:09:55.700
> 
> 标签：jquery, function, toggle

我正在尝试使用 jQuery 切换在两个函数之间移动。迄今为止的结果参差不齐。下面是一个试验场景的完整代码。

```
<html>
<head>
  <script type="text/javascript" src="../js/jquery.js"></script>
  <script>
  $(document).ready(function(){
     $('#id').on('click',function(event){
         $(this).toggle(
             function(){console.log('Hide');},
             function(){console.log('Show');}
         );
     });
  });
  </script> 
</head>

<body>
  <div id="id">Hello</div>
</body>
</html> 
```

因此，当我第一次单击“Hello”时，日志中没有任何内容。

```
[Nothing] 
```

在第二次点击时，我得到：

```
Hide 
```

第三，它补充说：

```
Show
Hide 
```

第四，它补充说：

```
Hide
Show
Hide 
```

第五，它补充说：

```
Show
Hide
Show
Hide 
```

我相信您可以看到模式:) 为什么要这样做？我尝试过`.stop(true)`但没有用。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-11T02:11:49.953

`toggle()`在单击时执行，因此您不需要`click`事件包装器。

```
$('#id').toggle(
         function(){console.log('Hide');},
         function(){console.log('Show');}
     ); 
```

您当前的代码会在第一次单击`toggle()`该事件时附加触发`click`，这就是为什么您第一次单击该元素时没有得到任何东西的原因。

# ruby-on-rails - 为什么 Heroku 呈现方括号语法但在开发中解释？

> ID：10098967
> 
> 赞同：0
> 
> 时间：2012-04-11T02:10:35.670
> 
> 标签：ruby-on-rails, heroku

在 Rails 3.2 应用程序中，我使用`<% title "Title Text" %>`.

`<title>`这将按如下方式传递给标签：

```
<head>
    <title>AppName | <%= yield (:title) || "Default Title" %></title>
</head> 
```

并呈现如下：

```
<h1><%= yield(:title) %></h1> 
```

通过以下辅助方法：

```
def title(page_title, show_title = true)
    content_for(:title) { h(page_title.to_s) }
    @show_title = show_title
end

def show_title?
    @show_title
end 
```

这在开发中按预期工作，并且在大多数情况下在 Heroku 上的生产中工作。

在一些地方，我有更复杂的标题，例如`<% title ["Edit ",(@model.name)] %>`.

这在开发中按预期工作，并显示`Edit Foo Bar`.

但是在 Heroku 上，这呈现为`["Edit ", "Foo Bar"]`.

为什么要在 Heroku 上呈现语法？我有一种感觉，这可能与使用方括号定义数组有关，但是在搜索 Heroku 文档和 Google 之后，我没有找到任何有关此的信息。

感谢您提供任何帮助的想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T02:22:16.297

听起来您在家里使用的是 Ruby 1.8，而 Heroku 使用的是 1.9——`Array#to_s`两者之间的结果不同。为避免歧义，最好明确说明您希望如何打印数组。例如，如果您希望您的标题助手专门处理数组，这样的事情应该可以工作：

```
def title (page_title, show_title =true)
    page_title = page_title.join(' ') if page_title.respond_to? :join
    base_title = "AppName"
    @content_for_title = page_title.to_s
    @show_title - show_title
    if @content_for_title.nil?
      base_title
    else
      "#{base_title} | #{@content_for_title}"
    end
end 
```

# javafx-2 - JavaFX 有类似 Swing 的 TransferHandler 的东西吗？

> ID：10098968
> 
> 赞同：0
> 
> 时间：2012-04-11T02:10:39.720
> 
> 标签：javafx-2

我想要实现的是“秘密”编辑一些 html 代码，然后再将其粘贴到 HTMLEditor 中。谁能想到在 JavaFX 2 中做这样的事情的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T22:14:45.210

通常你可以做的是将 a 添加`ChangeListener`到正在更改的属性（例如 a `TextArea`）`TextProperty`中检查更改侦听器中的新值并将其修改为你想要的东西。这种策略与 a 并不完全相同`TransferHandler`，但（我认为）在某些地方你会`TransferHandler`在 Swing 中使用 a 时会起作用。不幸的是，在 a 的情况下`HtmlEditor`，您将无法使用这样的策略，因为`HtmlEditor`text 没有实现为可侦听的属性（尽管在未来的 JavaFX 版本中要求将其设为属性：[RT-18436](http://javafx-jira.kenai.com/browse/RT-18436)）。

查看[JavaFX 拖放文档](http://docs.oracle.com/javafx/2.0/drag_drop/jfxpub-drag_drop.htm)，JavaFX 确实支持[TransferMode](http://docs.oracle.com/javafx/2.0/api/javafx/scene/input/TransferMode.html)，它可以在接收到拖动事件时进行查询以执行不同的操作（例如复制、链接或移动数据）。

此外，如果您查看拖放文档中的示例 6，您可以看到可以为节点设置[onDragDropped](http://docs.oracle.com/javafx/2.0/api/javafx/scene/Node.html#onDragDroppedProperty)事件处理程序，该处理程序可以拦截并在当时采取`DragEvent`适当的操作（例如`htmlText`将`HtmlEditor`拖动数据的修改版本）。如果您难以覆盖 的默认`onDragDropped`功能`HtmlEditor`，那么您可以在 上放置一个[事件过滤器](http://docs.oracle.com/javafx/2.0/api/javafx/scene/Node.html#addEventFilter%28javafx.event.EventType,%20javafx.event.EventHandler%29)，`HtmlEditor`让您可以根据需要捕获、处理和使用相关的拖动事件。

# vb.net - 创建一个（VB）APP，它不能正常工作

> ID：10098974
> 
> 赞同：-4
> 
> 时间：2012-04-11T02:11:57.637
> 
> 标签：vb.net

我在大学，正在创建一个应用程序。但是我的应用程序中有两个主要问题。我的应用程序是一个比萨应用程序，它将允许比萨店内的员工将订单发送到厨房（这只是一个列表框）。但是，数学不起作用，由于某种原因，订单的标签中没有显示正确的定价。我尝试了不同的编写和放置代码的方式，但结果总是一样的。另外，我每桌有五个顾客。如果我选择所有客户订单并单击发送，则只会发送客户二的订单。不是任何其他客户，但如果我自己做客户，它就可以了。

下面是我的代码，希望有人能够告诉我我哪里出错了，因为我认为我只是盲目地浏览了整个事情并且看不到它的问题。提前感谢您对解决方案的任何给定帮助/反馈。

应用代码：

```
Public Class Form1
    Dim myformat As String = "{0,-10}{1,-25}{2,-15}{3,-30}{4,-10}"
    Dim cost As Single
    Dim base As String
    Dim pizza As String
    Dim table As String
    Dim topping As String
    Dim drink As String
    Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        ListBox1.Items.Add(String.Format(myformat, "table", "pizza", "base", "topping", "drink"))
    End Sub
    Private Sub STK_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles STK.Click

    '------------------table no-------------------'
    If tableno.Text = "1" Then
        table = "1"
    ElseIf tableno.Text = "2" Then
        table = "2"
    ElseIf tableno.Text = "3" Then
        table = "3"
    ElseIf tableno.Text = "4" Then
        table = "4"
    ElseIf tableno.Text = "5" Then
        table = "5"
    ElseIf tableno.Text = "6" Then
        table = "6"
    ElseIf tableno.Text = "7" Then
        table = "7"
    ElseIf tableno.Text = "8" Then
        table = "8"
    ElseIf tableno.Text = "9" Then
        table = "9"
    ElseIf tableno.Text = "10" Then
        table = "10"
    ElseIf tableno.Text = "11" Then
        table = "11"
    ElseIf tableno.Text = "12" Then
        table = "12"
    ElseIf tableno.Text = "13" Then
        table = "13"
    ElseIf tableno.Text = "14" Then
        table = "14"
    ElseIf tableno.Text = "15" Then
        table = "15"
    ElseIf tableno.Text = "16" Then
        table = "16"
    ElseIf tableno.Text = "17" Then
        table = "17"
    ElseIf tableno.Text = "18" Then
        table = "18"
    ElseIf tableno.Text = "19" Then
        table = "19"
    ElseIf tableno.Text = "20" Then
        table = "20"
    ElseIf tableno.Text = "21" Then
        table = "21"
    ElseIf tableno.Text = "22" Then
        table = "22"
    ElseIf tableno.Text = "23" Then
        table = "23"
    ElseIf tableno.Text = "24" Then
        table = "24"
    ElseIf tableno.Text = "25" Then
        table = "25"
    End If
    '---------------pizza type 1----------------'
    If pizza1.Text = "Planet Cheese" Then
        pizza = "Planet Cheese"
        cost = 4.0
    ElseIf pizza1.Text = "Planet Special" Then
        pizza = "Planet Special"
        cost = 5.0
    ElseIf pizza1.Text = "Planet Vegi" Then
        pizza = "Planet Vegi"
        cost = 4.5
    ElseIf pizza1.Text = "Planet Feast" Then
        pizza = "Planet Feast"
        cost = 6.0
    ElseIf pizza1.Text = "Planet Itella" Then
        pizza = "Planet Itella"
        cost = 6.5
    End If
    '---------------pizza type 2----------------'
    If pizza2.Text = "Planet Cheese" Then
        pizza = "Planet Cheese"
        cost = 4.0
    ElseIf pizza2.Text = "Planet Special" Then
        pizza = "Planet Special"
        cost = 5.0
    ElseIf pizza2.Text = "Planet Vegi" Then
        pizza = "Planet Vegi"
        cost = 4.5
    ElseIf pizza2.Text = "Planet Feast" Then
        pizza = "Planet Feast"
        cost = 6.0
    ElseIf pizza2.Text = "Planet Itella" Then
        pizza = "Planet Itella"
        cost = 6.5
    End If

    '---------------pizza type 3----------------'
    If pizza3.Text = "Planet Cheese" Then
        pizza = "Planet Cheese"
        cost = 4.0
    ElseIf pizza3.Text = "Planet Special" Then
        pizza = "Planet Special"
        cost = 5.0
    ElseIf pizza3.Text = "Planet Vegi" Then
        pizza = "Planet Vegi"
        cost = 4.5
    ElseIf pizza3.Text = "Planet Feast" Then
        pizza = "Planet Feast"
        cost = 6.0
    ElseIf pizza3.Text = "Planet Itella" Then
        pizza = "Planet Itella"
        cost = 6.5
    End If

    '---------------pizza type 4----------------'
    If pizza4.Text = "Planet Cheese" Then
        pizza = "Cheese and Tamato"
        cost = 4.0
    ElseIf pizza4.Text = "Planet Special" Then
        pizza = "Planet Special"
        cost = 5.0
    ElseIf pizza4.Text = "Planet Vegi" Then
        pizza = "Planet Vegi"
        cost = 4.5
    ElseIf pizza4.Text = "Planet Feast" Then
        pizza = "Planet Feast"
        cost = 6.0
    ElseIf pizza4.Text = "Planet Itella" Then
        pizza = "Planet Itella"
        cost = 6.5
    End If

    '---------------pizza type 5----------------'
    If pizza5.Text = "Planet Cheese" Then
        pizza = "Planet Cheese"
        cost = 4.0
    ElseIf pizza2.Text = "Planet Special" Then
        pizza = "Planet Special"
        cost = 5.0
    ElseIf pizza5.Text = "Planet Vegi" Then
        pizza = "Planet Vegi"
        cost = 4.5
    ElseIf pizza2.Text = "Planet Feast" Then
        pizza = "Planet Feast"
        cost = 6.0
    ElseIf pizza5.Text = "Planet Itella" Then
        pizza = "Planet Itella"
        cost = 6.5
    End If

    '---------------base 1 ------------'
    If norm1.Checked Then
        base = "norm"
    ElseIf thin1.Checked Then
        base = "thin"
    ElseIf CB1.Checked Then
        base = "CB"
    ElseIf BSC1.Checked Then
        base = "BSC"
    End If
    '---------------base 2 ------------'
    If norm2.Checked Then
        base = "norm"
    ElseIf thin2.Checked Then
        base = "thin"
    ElseIf CB2.Checked Then
        base = "CB"
    ElseIf BSC2.Checked Then
        base = "BSC"
    End If
    '---------------base 3 ------------'
    If norm3.Checked Then
        base = "norm"
    ElseIf thin3.Checked Then
        base = "thin"
    ElseIf CB3.Checked Then
        base = "CB"
    ElseIf BSC3.Checked Then
        base = "BSC"
    End If
    '---------------base 4 ------------'
    If norm4.Checked Then
        base = "norm"
    ElseIf thin4.Checked Then
        base = "thin"
    ElseIf CB4.Checked Then
        base = "CB"
    ElseIf BSC4.Checked Then
        base = "BSC"
    End If
    '---------------base 5 ------------'
    If norm5.Checked Then
        base = "norm"
    ElseIf thin5.Checked Then
        base = "thin"
    ElseIf CB5.Checked Then
        base = "CB"
    ElseIf BSC5.Checked Then
        base = "BSC"
    End If

    '----------topping1----'
    If cheese1.Checked = True Then
        topping = "Cheese"
        cost = cost + 1.0
    End If
    If pepperoni1.Checked = True Then
        topping = "Pepperoni"
        cost = cost + 1.0
    End If
    If onion1.Checked = True Then
        topping = "onion"
        cost = cost + 1.0
    End If
    If peppers1.Checked = True Then
        topping = "Peppers"
        cost = cost + 1.0
    End If
    If sausage1.Checked = True Then
        topping = "sausage"
        cost = cost + 1.0
    End If
    If tuna1.Checked = True Then
        topping = "tuna"
        cost = cost + 1.0
    End If
    If meatballs1.Checked = True Then
        topping = "meatballs"
        cost = cost + 1.0
    End If

    '----------topping2----'
    If cheese2.Checked = True Then
        topping = "Cheese"
        cost = cost + 1.0
    End If
    If pepperoni2.Checked = True Then
        topping = "Pepperoni"
        cost = cost + 1.0
    End If
    If onion2.Checked = True Then
        topping = "onion"
        cost = cost + 1.0
    End If
    If peppers2.Checked = True Then
        topping = "Peppers"
        cost = cost + 1.0
    End If
    If sausage2.Checked = True Then
        topping = "sausage"
        cost = cost + 1.0
    End If
    If tuna2.Checked = True Then
        topping = "tuna"
        cost = cost + 1.0
    End If
    If meatballs2.Checked = True Then
        topping = "meatballs"
        cost = cost + 1.0
    End If

    '----------topping3----'
    If cheese3.Checked = True Then
        topping = "Cheese"
        cost = cost + 1.0
    End If
    If pepperoni3.Checked = True Then
        topping = "Pepperoni"
        cost = cost + 1.0
    End If
    If onion3.Checked = True Then
        topping = "onion"
        cost = cost + 1.0
    End If
    If peppers3.Checked = True Then
        topping = "Peppers"
        cost = cost + 1.0
    End If
    If sausage3.Checked = True Then
        topping = "sausage"
        cost = cost + 1.0
    End If
    If tuna3.Checked = True Then
        topping = "tuna"
        cost = cost + 1.0
    End If
    If meatballs3.Checked = True Then
        topping = "meatballs"
        cost = cost + 1.0
    End If

    '----------topping4----'
    If cheese4.Checked = True Then
        topping = "Cheese"
        cost = cost + 1.0
    End If
    If pepperoni4.Checked = True Then
        topping = "Pepperoni"
        cost = cost + 1.0
    End If
    If onion4.Checked = True Then
        topping = "onion"
        cost = cost + 1.0
    End If
    If peppers4.Checked = True Then
        topping = "Peppers"
        cost = cost + 1.0
    End If
    If sausage4.Checked = True Then
        topping = "sausage"
        cost = cost + 1.0
    End If
    If tuna4.Checked = True Then
        topping = "tuna"
        cost = cost + 1.0
    End If
    If meatballs4.Checked = True Then
        topping = "meatballs"
        cost = cost + 1.0
    End If

    '----------topping5----'
    If cheese5.Checked = True Then
        topping = "Cheese"
        cost = cost + 1.0
    End If
    If pepperoni5.Checked = True Then
        topping = "Pepperoni"
        cost = cost + 1.0
    End If
    If onion5.Checked = True Then
        topping = "onion"
        cost = cost + 1.0
    End If
    If peppers5.Checked = True Then
        topping = "Peppers"
        cost = cost + 1.0
    End If
    If sausage5.Checked = True Then
        topping = "sausage"
        cost = cost + 1.0
    End If
    If tuna5.Checked = True Then
        topping = "tuna"
        cost = cost + 1.0
    End If
    If meatballs5.Checked = True Then
        topping = "meatballs"
        cost = cost + 1.0
    End If

    '---------------drink1-----------------------'
    If drink1.Text = "Cola" Then
        drink = "Cola"
        cost = cost + 0.9
    ElseIf drink1.Text = "Fruit Punch" Then
        drink = "Fruit Punch"
        cost = cost + 0.8
    ElseIf drink1.Text = "J2o" Then
        drink = "J2o"
        cost = cost + 0.9
    ElseIf drink1.Text = "Alien Blaster" Then
        drink = "Alien Blaster"
        cost = cost + 0.9
    ElseIf drink1.Text = "Alien Brains" Then
        drink = "Alien Brains"
        cost = cost + 0.9
    End If

    '---------------drink2-----------------------'
    If drink2.Text = "Cola" Then
        drink = "Cola"
        cost = cost + 0.9
    ElseIf drink2.Text = "Fruit Punch" Then
        drink = "Fruit Punch"
        cost = cost + 0.8
    ElseIf drink2.Text = "J2o" Then
        drink = "J2o"
        cost = cost + 0.9
    ElseIf drink1.Text = "Alien Blaster" Then
        drink = "Alien Blaster"
        cost = cost + 0.9
    ElseIf drink1.Text = "Alien Brains" Then
        drink = "Alien Brains"
        cost = cost + 0.9
    End If

    '---------------drink3-----------------------'
    If drink3.Text = "Cola" Then
        drink = "Cola"
        cost = cost + 0.9
    ElseIf drink3.Text = "Fruit Punch" Then
        drink = "Fruit Punch"
        cost = cost + 0.8
    ElseIf drink3.Text = "J2o" Then
        drink = "J2o"
        cost = cost + 0.9
    ElseIf drink1.Text = "Alien Blaster" Then
        drink = "Alien Blaster"
        cost = cost + 0.9
    ElseIf drink1.Text = "Alien Brains" Then
        drink = "Alien Brains"
        cost = cost + 0.9
    End If

    '---------------drink4-----------------------'
    If drink4.Text = "Cola" Then
        drink = "Cola"
        cost = cost + 0.9
    ElseIf drink4.Text = "Fruit Punch" Then
        drink = "Fruit Punch"
        cost = cost + 0.8
    ElseIf drink4.Text = "J2o" Then
        drink = "J2o"
        cost = cost + 0.9
    ElseIf drink1.Text = "Alien Blaster" Then
        drink = "Alien Blaster"
        cost = cost + 0.9
    ElseIf drink1.Text = "Alien Brains" Then
        drink = "Alien Brains"
        cost = cost + 0.9
    End If

    '---------------drink5-----------------------'
    If drink5.Text = "Cola" Then
        drink = "Cola"
        cost = cost + 0.9
    ElseIf drink5.Text = "Fruit Punch" Then
        drink = "Fruit Punch"
        cost = cost + 0.8
    ElseIf drink5.Text = "J2o" Then
        drink = "J2o"
        cost = cost + 0.9
    ElseIf drink1.Text = "Alien Blaster" Then
        drink = "Alien Blaster"
        cost = cost + 0.9
    ElseIf drink1.Text = "Alien Brains" Then
        drink = "Alien Brains"
        cost = cost + 0.9
    End If

    ListBox1.Items.Add(String.Format(myformat, table, pizza, base, topping, drink))

    totallabel.Text = Format(cost, "currency")
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T05:51:36.407

欢迎来到 StackOverflow。是时候让您学习如何调试了，这是一个开始（诚然，这家伙不是那么好（他甚至不使用快捷键 - 但它应该足够简单，任何人都可以理解）：[http调试完代码后， ://www.youtube.com/watch?v=jxR_ngGIpQM](http://www.youtube.com/watch?v=jxR_ngGIpQM)会回来。

同时，这里有一些提示：

a) 使用 Switch（或在 VB.Net 中称为 Select）代替所有 If、ElseIf 语句。例如这个：

```
If tableno.Text = "1" Then
table = "1"
ElseIf tableno.Text = "2" Then
table = "2" 
```

可以更好地表示：

```
Select Case tableno.Text
Case Is = 1

Case Is < 5

Case Is < 10

Case Is > 9

End Select 
```

table 变量只是复制文本框的 Text 属性对我来说仍然没有意义，因此您可以使用 tableno.Text 代替名为 table 的变量。如果您打算将此变量传递给其他函数，那么只需像这样编写代码：

```
tableno = tableno.Text  ' 50 lines less of code! 
```

b）这是另一个例子，看看你如何在 If 语句中赋值，当你可以只做一次赋值时，例如：

```
If drink1.Text = "Cola" Then
drink = "Cola"
cost = cost + 0.9
ElseIf drink1.Text = "Fruit Punch" Then
drink = "Fruit Punch" 
```

在 If Else 语句末尾的一行中执行此操作要容易得多，例如：

```
drink = drink1.Text 
```

c) 不要对值（价格、产品名称等）进行硬编码！将值存储在数据库甚至文本文件中！

d) 如果测试一个布尔条件，不要打扰测试它是否等于真。例如

```
If cheese3.Checked Then 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T02:22:11.527

尝试将 C# 与 switch case 一起使用。代码将更具可读性。据我所知，Pizzas 的成本并没有增加。在 pizas 检查后，代码应该是 cost+=price 而不是 cost=pizzaprice

还要编辑代码的顺序。Pizzaone 后跟 base1、topping 1、drink1 等和 ListBox.Add 。然后对 Pizza2、pizza3 等执行相同操作，然后是 listbox.add

# android - android交叉编译，ndk，工具链

> ID：10098978
> 
> 赞同：0
> 
> 时间：2012-04-11T02:13:22.380
> 
> 标签：android, android-ndk, cross-compiling

我想为android构建一个内核模块。而且我知道我使用交叉编译。在内核内部，我想我可以使用一些通用的交叉编译，例如 arm-none-linux-gnueabi-gcc。我的想法正确吗？或者任何其他用于 android 的交叉编译，你可以提示给我？还有关于如何在 ubuntu 中为交叉编译构建环境的文章？其次，每当我编译模块时，如何将它作为模块加载到内核中？最后，有人解释一下NDK，交叉编译和工具链之间的关系吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T14:03:20.067

好吧，这是一个很大的问题，但我至少会尝试回答我所知道的。我相信特定的硬件制造商将拥有一个包含一整套工作软件的 Android“捆绑包”。这将包括工具链、Linux 内核源代码、u-boot 引导程序和整个 Android 系统。就我而言，飞思卡尔为他们提供的特定处理器和评估板提供了 Android 捆绑包。

就术语而言，“交叉编译器”将包含在“工具链”中。术语“工具链”涵盖了整个交叉编译器、交叉库等。每个工具链都是为主机（即 Linux、cygwin 等）和目标处理器（arm、mips、PowerPC 等）构建的。

为 Android 构建 Linux 与构建 Linux 并没有什么不同。建议使用与构建 Android 系统其余部分相同的工具链来构建 Linux。要构建 Linux，请设置环境变量“ARCH=arm”和“CROSS_COMPILE=arm-none-linux-gnueabi-”（或您正在使用的实际交叉编译器的前缀）。注意结尾的“-”在交叉编译前缀中很重要。

以下链接介绍了如何设置开发环境。

[安卓开发环境搭建。](http://source.android.com/source/initializing.html)

注意，Ubuntu 10.04 到 11.04 运行良好。建议保持在这些版本之一内。

将 Linux 内核放到目标上完全取决于目标。对于我正在使用的飞思卡尔，它希望在 SD 卡上的偏移 0x800 块处找到 Linux 内核（SD 卡上的每个块为 512 字节）。我使用以下内容写入 SD 卡原始数据：

sudo dd if=uImage of=/dev/sdb bs=1M seek=1; 同步

就NDK而言，我根本没有经验。我对它的理解是，它是 Android Java 应用程序调用“C”和“CPP”代码以实现计时关键功能的接口。我不知道的是它相对于 JNI 接口的优势，以及它与 JNI 接口的不同之处。

我希望你觉得这很有用和有帮助。

# android - Android 电池健康状况如何确定？

> ID：10098979
> 
> 赞同：6
> 
> 时间：2012-04-11T02:13:29.920
> 
> 标签：android, power-management

我不是在谈论如何读取值。

相反，我对如何设置 BatteryManager.EXTRA_HEALTH 的值感兴趣。

它来自固件吗？制造商具体？

是什么决定了这些价值观？

```
int BATTERY_HEALTH_COLD 
int BATTERY_HEALTH_DEAD 
int BATTERY_HEALTH_GOOD 
int BATTERY_HEALTH_OVERHEAT 
int BATTERY_HEALTH_OVER_VOLTAGE 
int BATTERY_HEALTH_UNKNOWN  
int BATTERY_HEALTH_UNSPECIFIED_FAILURE 
```

谢谢，西蒙

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-08-12T16:02:24.983

更具体地说：电池健康状况由驱动程序（在内核中）确定。所述驱动程序通过 sys 文件系统（准确地说是 /sys/class/power_supply）导出信息。Android 守护程序 healthd（截至 KK，4.4.x）获取此信息，并在其上实现 IBatteryPropertiesRegistrar 接口。它连续轮询（使用 epoll_wait 在超时循环中运行以进行定期更新，以及 POWER 子系统的 netlink 通知 - 例如，如果您连接或断开充电器）。然后系统的 BatteryStatsService 向 healthd 注册一个监听器（通过 binder），然后获取 healthd 发布的数据，

查看 /sys/class/power_supply，您将看到：

```
lrwxrwxrwx root     root              1970-02-05 14:20 ac -> ../../devices/f9923000.i2c/i2c-84/84-006b/power_supply/ac
lrwxrwxrwx root     root              1970-02-05 14:20 batt_therm -> ../../devices/battery_tm_ctrl.78/power_supply/batt_therm
lrwxrwxrwx root     root              1970-02-05 14:20 battery -> ../../devices/f9923000.i2c/i2c-84/84-0036/power_supply/battery
lrwxrwxrwx root     root              1970-02-05 14:20 touch -> ../../devices/virtual/power_supply/touch
lrwxrwxrwx root     root              1970-02-05 14:20 usb -> ../../devices/msm_dwc3/power_supply/usb
lrwxrwxrwx root     root              1970-02-05 14:20 wireless -> ../../devices/bq51013b_wlc.77/power_supply/wireless 
```

然后查看“电池”

```
/sys/devices/f9923000.i2c/i2c-84/84-0036/power_supply/battery:
-r--r--r-- root     root         4096 2014-02-26 13:26 capacity
-r--r--r-- root     root         4096 2014-02-26 13:26 charge_full_design
-r--r--r-- root     root         4096 2014-02-26 13:26 current_now
lrwxrwxrwx root     root              2014-02-26 13:26 device -> ../../../84-0036
-r--r--r-- root     root         4096 2014-02-26 13:26 health
drwxr-xr-x root     root              2014-02-26 13:26 power
-r--r--r-- root     root         4096 2014-02-26 13:26 present
-r--r--r-- root     root         4096 2014-02-26 13:26 status
lrwxrwxrwx root     root              2014-02-26 13:26 subsystem -> ../../../../../../class/power_supply
-r--r--r-- root     root         4096 2014-02-26 13:26 technology
-r--r--r-- root     root         4096 2014-02-26 13:26 temp
-r--r--r-- root     root         4096 2014-02-26 13:26 type
-rw-r--r-- root     root         4096 2014-02-26 13:26 uevent
-r--r--r-- root     root         4096 2014-02-26 13:26 voltage_max_design
-r--r--r-- root     root         4096 2014-02-26 13:26 voltage_min_design
-r--r--r-- root     root         4096 2014-02-26 13:26 voltage_now 
```

通过查看文件，所有细节都将被揭示。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-11T12:42:58.260

通过使用此代码，您可以获得有关电池的信息。

```
private BroadcastReceiver battery_receiver = new BroadcastReceiver()
{
    @Override
    public void onReceive(Context context, Intent intent)
    {
        boolean isPresent = intent.getBooleanExtra("present", false);
        String technology = intent.getStringExtra("technology");
        int plugged = intent.getIntExtra("plugged", -1);
        int scale = intent.getIntExtra("scale", -1);
        int health = intent.getIntExtra("health", 0);
        int status = intent.getIntExtra("status", 0);
        int rawlevel = intent.getIntExtra("level", -1);
        int level = 0;
        String temp=null;

        Bundle bundle = intent.getExtras();

        Log.i("BatteryLevel", bundle.toString());

        if(isPresent)
        {
            if (rawlevel >= 0 && scale > 0) {
                level = (rawlevel * 100) / scale;
            }

            String info = "Battery Level: " + level + "%\n";

            info += ("Technology: " + technology + "\n");
            info += ("Plugged: " + getPlugTypeString(plugged) + "\n");
            info += ("Health: " + getHealthString(health) + "\n");
            info += ("Status: " + getStatusString(status) + "\n");
            info += ("Temp: "+getTempStatus(temp,intent)+"\n");

            setBatteryLevelText(info + "\n\n" + bundle.toString());
        }
        else
        {
            setBatteryLevelText("Battery not present!!!");
        }
    }
};
private void registerBatteryLevelReceiver(){
    IntentFilter filter = new IntentFilter(Intent.ACTION_BATTERY_CHANGED);

    registerReceiver(battery_receiver, filter);
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-11T02:18:00.997

锂离子电池具有简单的车载计算机，可以跟踪和报告健康状况；状态指标是标准化的，但触发它们由电池报告的条件由电池制造商确定。

# qt - 在 textBrowser 中实时显示 QProcess 输出

> ID：10098980
> 
> 赞同：4
> 
> 时间：2012-04-11T02:13:32.480
> 
> 标签：qt, qt-creator, qprocess

我是 qt 开发的新手，我想将 QProcess 的输出实时传输到 textBrowser。我从执行一个简单的 echo 命令开始，但没有显示程序的输出。我究竟做错了什么？？？？

```
QProcess p;
p.start("echo hye");
QByteArray byteArray = p.readAllStandardOutput();
    QStringList strLines = QString(byteArray).split("\n");
    QString line= p.readAllStandardOutput();
    if(p.state()==QProcess::NotRunning)
        ui->textBrowser->append("not running");
    foreach (QString line, strLines){
    ui->textBrowser->append(line);} 
```

PS我在一台linux机器上。

编辑：我仍然无法在 textBrowser 中获得输出。

我更改了 Qprocess 参数并尝试了 waitForStarted() 和 waitForReadyRead() ，以便进程及时启动并且结果可用。

我添加了 waitForFinished() 以便进程在超出范围时不会终止。

```
QProcess p;
    p.start("echo", QStringList() << "hye");
    p.waitForStarted();
    QByteArray byteArray = p.readAllStandardOutput();
    QStringList strLines = QString(byteArray).split("\n");
    QString line= p.readAllStandardOutput();
    if(p.state()==QProcess::NotRunning)
        ui->textBrowser->append("not running");
    ui->textBrowser->append(line);
    p.waitForFinished(); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-11T04:34:06.877

要读取标准输出，您需要在读取标准输出`waitForReadyRead()`之前调用，或者您需要将 Qprocess 的信号连接`readyReadStandardOutput()`到您的插槽并从插槽读取标准输出。

还要确保您的 QProcess 不在堆栈上。

我尝试以下代码工作正常。

编辑：

```
MyProcess::MyProcess(QObject *parent) :
    QObject(parent)
{
    QString program = "echo";
    QStringList arguments;
    arguments << "Hello";
    mProcess.start(program,arguments);
    connect(&mProcess,SIGNAL(readyReadStandardOutput()),this,SLOT(readyReadStandardOutput()));
    connect(&mProcess,SIGNAL(readyReadStandardError()),this,SLOT(readyReadStandardError()));
}

void MyProcess::readyReadStandardOutput(){
    qDebug()<< mProcess.readAllStandardOutput();
}

void MyProcess::readyReadStandardError(){
    qDebug() << mProcess.readAllStandardError();
} 
```

# android - BroadcastReceiver 中的 SharedPreferences 似乎没有更新？

> ID：10098981
> 
> 赞同：13
> 
> 时间：2012-04-11T02:13:49.297
> 
> 标签：android, broadcastreceiver, sharedpreferences, alarmmanager

我有一个更新 SharedPreferences 中的字符串的活动。

```
SharedPreferences settings = PreferenceManager.getDefaultSharedPreferences(this);
SharedPreferences.Editor editor = settings.edit();
editor.putString("username", username);
editor.commit(); 
```

然后我启动一个服务：

```
startService(new Intent(this, MyService.class)); 
```

该服务创建一个对扩展 BroadcastReceiver 的 Alarm 的引用：

```
Alarm alarm = null;
public void onCreate() {
    alarm = new Alarm();
}
@Override
public int onStartCommand(Intent intent, int flags, int startId) {
    alarm.SetAlarm(this);
} 
```

在 SetAlarm 中，我进行了所有基本设置（此时，“用户名”仍然正确。我检查了）：

```
public void SetAlarm(Context context) {
    AlarmManager am=(AlarmManager)context.getSystemService(Context.ALARM_SERVICE);
    PendingIntent pi = PendingIntent.getBroadcast(context, 0, i, 0);
    am.setRepeating(AlarmManager.ELAPSED_REALTIME_WAKEUP, SystemClock.elapsedRealtime(), 1000 * 60 * interval, pi);
} 
```

然后我停止该服务，然后再次启动它（使用 SetAlarm）。

```
public void CancelAlarm(Context context) {
   Intent intent = new Intent(context, Alarm.class);
   PendingIntent sender = PendingIntent.getBroadcast(context, 0, intent, 0);
   AlarmManager alarmManager = (AlarmManager) context.getSystemService(Context.ALARM_SERVICE);
   alarmManager.cancel(sender);
} 
```

问题出在 onReceive 中。第一次“用户名”字段是正确的。第二次，如果用户名在服务停止和启动之间更新，但是，它返回第一个值。该值似乎没有更新...

```
public void onReceive(Context context, Intent intent) {   
    SharedPreferences settings = PreferenceManager.getDefaultSharedPreferences(context);
    Log.e("hi", settings.getString("username", ""));
} 
```

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2012-05-26T22:10:37.027

我遇到了同样的问题，经过几个小时的努力解决它，我终于找到了导致它的问题。在您的 AndroidManifest 中，您可能有类似的内容：

```
<receiver android:name="AlarmReceiver" android:process=":remote" /> 
```

最后一个属性 (process:remote) 导致接收器在被调用时在不同的/新进程上运行。但不同进程之间不支持 SharedPreferences。

所以我所做的是从清单中删除最后一个属性。这意味着代码现在将在主线程上运行 - 但如果您只有几行来显示通知，那么这应该不是问题。另一种方法是调用服务来运行长操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-01-04T21:09:36.293

不幸的是，Amir Naor 的解决方案在我的 Android 7 应用程序中不起作用。似乎每个接收者总是在一个新的过程中开始。

**API < 23**

因此，如果您的应用程序 < API 级别 23，您可以使用以下标志`Context.MODE_MULTI_PROCESS`：

```
context.getSharedPreferences("mypreferences", Context.MODE_PRIVATE | Context.MODE_MULTI_PROCESS); 
```

**API >= 23**

真是个惊喜。由于 API 级别 23 已`Context.MODE_MULTI_PROCESS` [弃用](https://developer.android.com/reference/android/content/Context.html#MODE_MULTI_PROCESS)，我们应该使用[ContentProvider](https://developer.android.com/reference/android/content/ContentProvider.html)在进程之间共享属性。

* * *

github 上有一个非常不错的库：[Tray - Android 的 SharedPreferences 替代品](https://github.com/grandcentrix/tray)。这个库是一个`ContentProvider`包含其他一些有用特性的包装器。试试看。

# ruby-on-rails - 在 Rails 3 中添加来自 URL 的图像作为附件

> ID：10098986
> 
> 赞同：3
> 
> 时间：2012-04-11T02:14:35.433
> 
> 标签：ruby-on-rails, ruby-on-rails-3, email, actionmailer

我知道您可以在 Rails 3 中将图像作为附件添加到电子邮件中

```
def email_image(email)
  attachments["img"] = File.read('/path to image')
  mail(:to => email)
end 
```

但是有没有办法从 url 附加图像而不是本地保存的图像？我想附上一张用回形针保存在 S3 上的图像。有没有简单的方法可以做到这一点，还是我需要先下载图像？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-09T21:27:48.287

你需要

```
require 'open-uri' 
```

然后做

```
attachments["filename"] = open(url-to-image).read 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T09:47:22.010

如果您使用的是 html，那么您只需插入一个图像标签。唯一的问题是大多数电子邮件客户端会阻止图像，直到用户“信任”你。

如果您希望图像更有可能被显示，那么最好的办法是下载并嵌入它。但是，这会增加下载图像然后将其发送到每个邮件客户端的开销。

# ruby - 为包含 ActiveModel::Validations 的类编写测试

> ID：10098987
> 
> 赞同：1
> 
> 时间：2012-04-11T02:14:43.060
> 
> 标签：ruby, ruby-on-rails-3, rspec2, shoulda

如果你使用 shoulda-matchers + rspec 来测试 ActiveRecord 类，你可以这样做：

```
class PersonAsActiveRecord < ActiveRecord::Base
  validates :title, :presence => true
end

describe PersonAsActiveRecord do
  subject { PersonAsActiveRecord.new(:title => 'Lt Wiggles') } 

  it { should validate_presence_of(:title) }
end 
```

但是，如果这似乎不起作用：

```
class PersonAsJustClass
  include ActiveModel::Validations
  attr_accessor :title
  validates :title, :presence => true
end

describe PersonAsJustClass do
  subject { PersonAsJustClass.new(:title => 'Lt Wiggles') } 

  it { should validate_presence_of(:title) }
end 
```

为什么会这样？还是我做错了什么？

# .net - 在VB中杀死几个进程？

> ID：10098996
> 
> 赞同：0
> 
> 时间：2012-04-11T02:16:09.770
> 
> 标签：.net, vb.net, process, kill, kill-process

我目前在 VS 2010 中进行了跟进

```
 Dim myProcess() As Process = System.Diagnostics.Process.GetProcessesByName("calc")

    For Each myKill As Process In myProcess
        myKill.Kill() 
```

但是，我似乎无法让它杀死多个进程。我试过的例子

```
("calc",mspaint")
("calc,mspaint")
("calc"),("mspaint") 
```

有任何想法吗？感谢您的时间/支持

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T02:21:57.357

引用[GetProcessByName](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.getprocessesbyname.aspx)的 MSDN 文档：

> 创建一个新流程组件的数组，并将它们与现有的流程资源相关联，这些现有流程资源都共享指定的流程名称。

您不能将参数数组传递给它。相反，您可以使用[GetProcesses](http://msdn.microsoft.com/en-us/library/1f3ys1f9.aspx)方法获取所有进程，遍历所有进程并检查其名称是否与您想要的名称之一匹配：

```
 Dim procs = System.Diagnostics.Process.GetProcesses().Where((Function(p) p.ProcessName = "calc" Or p.ProcessName = "mspaint"))
            For Each p As Process In procs
                p.Kill()
            Next 
```

非LINQ方式：

```
 For Each p As Process In Process.GetProcesses()
            If p.ProcessName = "calc" Or p.ProcessName = "mspaint" Then
                p.Kill()
            End If
        Next 
```

# android - 找不到 R.xml.preferences？

> ID：10098997
> 
> 赞同：10
> 
> 时间：2012-04-11T02:16:41.190
> 
> 标签：android, android-layout

我正在尝试为 Android 应用程序设置一些简单的首选项，但无法克服此错误：“xml 无法解析或不是字段。” 我已经清理、刷新、重新启动了 eclipse 并跳起了舞步——但我无法摆脱错误。我究竟做错了什么？

首选项.xml 文件：

```
<?xml version="1.0" encoding="utf-8"?>

<PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android">

    <PreferenceCategory
        android:title="Dev options">

        <CheckBoxPreference
            android:key="devtools"
            android:title="Enable clearing user"
            android:summary="Enable clearing user" />

    </PreferenceCategory>

</PreferenceScreen> 
```

java类文件：

```
package com.myapp.prototype;

import android.os.Bundle;
import android.preference.PreferenceFragment;

public class GCPreferencesActivity extends PreferenceFragment {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        // Load preferences from XML resource
        addPreferencesFromResource(R.xml.preferences);    // error on this line ??
    }
} 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-01T14:25:44.367

我认为您错过了导入（如文森特在评论中所说）。你应该添加：

```
import com.myapp.prototype.R; 
```

如果您输入代码，也会出现错误：

```
import android.R; 
```

这令人困惑，因为 R 已解析但没有您在 XML 文件中定义的属性（当然，它不是好的 R！）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-21T16:18:40.097

您的`res/`目录中必须有一个名为的文件夹`res/xml`，其中包含您的`.xml`文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-30T02:58:43.683

这是一个老问题，但我的回答可能对未来的观众有所帮助。我遇到了同样的问题，这是因为我导入了错误的 R 类：

```
import android.R 
```

您必须导入自己项目生成的 R 类：

```
import your.full.package.name.R 
```

当然，您的项目中需要有 res/xml/preferences.xml 文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-06T09:43:07.220

对于未来的访客：我遇到了同样的问题。我从 lynda.com 浏览的视频之一说，如果我们没有文件名 .xml ，文件夹 XML 将被创建。但它不会像解释的那样发生。我不得不在“RES”文件夹下手动创建一个名为“XML”的文件夹并将该xml文件拖到它下面，错误就消失了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-10-21T10:25:20.843

我遇到了问题，因为我从另一个项目复制/粘贴了 xml。使用 File=>new=>Android xml 在项目中创建 xml，然后将 xml 代码从另一个项目复制粘贴到您刚刚创建的 xml。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-05-27T20:55:16.437

好吧，对于那些即使在导入自己的资源文件后仍然存在此错误的人，在我的情况下，我只是将我的项目与 Gradle 文件同步，它自动解决了这个问题。

在 Android Studio 中命中

> 文件 -> 将项目与成绩文件同步

希望它有所帮助！

# mysql - “MySQL 中“ORDER BY order DESC”附近的语法错误”

> ID：10098998
> 
> 赞同：5
> 
> 时间：2012-04-11T02:16:44.433
> 
> 标签：mysql, sql-order-by, mysql-error-1064

为什么，当我尝试按查询进行排序时，总是收到错误消息，告诉我通过 ORDER BY 'order' DESC 检查语法？

这是我的查询：

```
SELECT * FROM posts ORDER BY order DESC; 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-11T02:18:02.900

`order`是 SQL 中的保留字；大小写无关紧要。[用作标识符](http://dev.mysql.com/doc/refman/5.5/en/identifiers.html)时*必须*加引号。来自[MySQL 保留字](http://dev.mysql.com/doc/refman/5.5/en/reserved-words.html)文档：

> 某些单词，如 SELECT、DELETE 或 BIGINT [或 ORDER] 是保留的，需要特殊处理才能用作表名和列名等标识符。

传统的 MySQL 报价：

```
SELECT * FROM posts ORDER BY `order` DESC; 
```

[正确的 (ANSI) SQL 引号](http://dev.mysql.com/doc/refman/5.5/en/server-sql-mode.html#sqlmode_ansi_quotes)（一些数据库也支持`[order]`）：

```
SELECT * FROM posts ORDER BY "order" DESC; 
```

尽管我会考虑重命名该列以避免将来出现此类令人困惑的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T02:18:34.223

订单是保留关键字。

尝试，

```
SELECT * FROM posts ORDER BY `order` DESC; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-11T02:18:43.817

列名是`order`关键字。你需要这样做：

```
SELECT * FROM posts ORDER BY `order` DESC; 
```