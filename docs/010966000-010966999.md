# StackOverflow 问答 10966000-10966999

# android - 将 .apk 上传到 google play 时出错：此文件无效：获取服务的“android 名称”属性时出错：属性不是字符串值

> ID：10966002
> 
> 赞同：0
> 
> 时间：2012-06-10T02:35:03.693
> 
> 标签：android, upload, android-manifest, google-play

我正在将我的动态壁纸草稿 .apk 文件上传到 Google Play，但出现此错误：

`this file is invalid: error getting 'android name' attribute for service: attribute is not a string value`

我已经在我的模拟器+真实设备中进行了测试，一切正常。

我也在上传之前签署了apk文件。

网上的一些资源告诉我，出现这个问题是因为manifest.xml，但是还是找不到问题。。

这是我的 manifest.xml：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.test.wallpaper"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="8" />
    <uses-feature android:name="android.software.live_wallpaper" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >

            <activity android:name="com.test.wallpaper.SplashActivity"
            android:label="@string/app_name" android:configChanges="keyboardHidden"
            android:windowSoftInputMode="adjustPan" android:launchMode="singleTop"
            android:screenOrientation="portrait">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

      <service
            android:permission="android.permission.BIND_WALLPAPER"
            android:name    = "@string/app_name"
            android:label   = "@string/app_name"
            android:icon    = "@drawable/icon"
        >

            <intent-filter>
                <action android:name="android.service.wallpaper.WallpaperService" />
            </intent-filter>

            <meta-data android:name="android.service.wallpaper" android:resource="@xml/wallpaper"/>

        </service>

        <activity
            android:label       = "Settings"
            android:name        = "Settings"
            android:theme       = "@android:style/Theme.Black"
            android:exported    = "true">
        </activity>
         <activity
            android:name        = "GalleryPreference"
            android:label       = "GalleryPreference"
            android:theme       = "@android:style/Theme.Black"
            android:exported    = "true"
        />

        <activity
            android:name        = "GalleryActivity"
            android:label       = "GalleryActivity"
            android:exported    = "true"
        />

        <service android:name = "com.test.wallpaper.AdapterService" android:enabled="true" android:exported="true"/>
    </application>

</manifest> 
```

任何想法或建议表示赞赏！

谢谢，
宾邦

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T02:52:53.703

清单中的第一个服务将`android:name`属性定义为`"@string/app_name"`。根据 Android[文档](http://developer.android.com/guide/topics/manifest/service-element.html)，这必须是一个完全限定的类名，就像清单中的服务定义一样。我猜字符串“app_name”不是一个完全限定的类名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T05:35:28.467

就我而言，它是 app_name 字符串中的“\n”。那是错误的。

# javascript - 散列 Web 应用程序中的每一行文本

> ID：10966003
> 
> 赞同：0
> 
> 时间：2012-06-10T02:35:16.377
> 
> 标签：javascript, jsp, plagiarism-detection

我有这样的需求，

我有一个网络应用程序，工作人员会更新内容，每个人都有自己的帐户。我们在工人中分组，我们将为每个组分配相同的任务。

说第 1 组将首先更新，并在门户中解释了这个概念现在所有其他组都可以自由查看内容，但我们期待其他组的其他一些不错的内容。所以其他人必须更新他们的内容。

我们想避免复制粘贴的事情，一件事是我们不想禁用复制粘贴，但我们打算做的是，监控复制粘贴的东西。就像有人从其他页面复制内容一样，我们应该知道内容是从哪里复制的，从哪一行/哪一页复制。如果我们能够抓住它，那么我们计划对该内容给予负面评价。

有没有办法对每一行进行散列，当复制操作完成时，将隐藏的散列值与内容一起存储，并将其映射到从哪里复制

还是有其他处理方式？

谢谢和问候，萨达南德。

# list - Erlang遍历列表删除一个元素

> ID：10966004
> 
> 赞同：0
> 
> 时间：2012-06-10T02:35:23.373
> 
> 标签：list, functional-programming, erlang, runtime

我有以下二郎代码：

```
lists:all(fun(Element) -> somefunction(TestCase -- [Element]) end, TestCase). 
```

其中 TestCase 是一个数组。我正在尝试遍历缺少一个元素的列表/数组。

`--`问题是这段代码在最坏的情况下需要 O(N^2) 时间，因为每次调用TestCase 数组的副本。在非函数式语言中有一个明确的 O(N) 解决方案。

```
saved = TestCase[0]
temp = 0
NewTestCase = TestCase[1:] 
for a in range(length(NewTestCase)):
  somefunction(NewTestCase)
  temp = NewTestCase[a]
  NewTestCase[a] = saved
  saved = temp 
```

... 或类似的东西。

erlang中是否有O（N）解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T08:32:06.607

当然有，但它有点复杂。我假设这`some_function/1`确实是一个布尔函数，您想测试它是否为每个子列表返回 true。

```
test_on_all_but_one([], _Acc) -> true;
test_on_all_but_one([E|Rest], Acc) ->
  case somefunction(lists:reverse(Acc,Rest)) of
    true  -> test_on_all_but_one(Rest, [E|Acc]);
    false -> false
  end. 
```

这个实现仍然是 O(length(List)^2)，因为`lists:reverse/2`调用仍然需要 O( `length(Acc)`)。如果您可以修改`somefunction/1`以在分成两部分的列表上进行计算，那么您可以修改先前对`somefunction(lists:reverse(Acc,Rest))`with`somefunction(Acc, Rest)`或类似的调用并避免重建。

修改取决于`somefunction/1`. 如果您需要更多帮助，请提供一些代码！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T08:23:01.457

如果可以接受，您可以将列表拆分为 2 个子列表。

```
witerate(Fun, [Tail], Acc) ->
  Fun([], Acc);

witerate(Fun, [Head | Tail], Acc) ->
  Fun(Tail, Acc),
  witerate(Fun, Tail, [Head | Acc]). 
```

# python - Django 中间件 - 如何编辑 Django 响应对象的 HTML？

> ID：10966006
> 
> 赞同：6
> 
> 时间：2012-06-10T02:35:56.557
> 
> 标签：python, html, django

我正在创建一个自定义中间件来 django 编辑响应对象以充当审查员。我想找到一种方法来进行一种搜索和替换，用我选择的一个词替换某个词的所有实例。

我已经创建了我的中间件对象，将它添加到我`MIDDLEWARE_CLASSES`的设置中，并设置它来处理响应。但到目前为止，我只找到了添加/编辑 cookie、设置/删除字典项或写入 html 末尾的方法：

```
class CensorWare(object):
    def process_response(self, request, response):
        """
        Directly edit response object here, searching for and replacing terms
        in the html.
        """
        return response 
```

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-10T02:38:32.927

您可以简单地修改`response.content`字符串：

```
response.content = response.content.replace("BAD", "GOOD") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-06T05:16:22.100

也许我的回答好一点。当你尝试做 response.content.replace("BAD", "GOOD") 时，你会得到错误，你不能用字符串来做，因为 response.content 是字节数组。我已将语法字符串“gen_duration_time_777”和“server_time_777”添加到基本模板。这对我有用。

```
import time
from datetime import datetime

class StatsMiddleware(object):
    duration = 0

    def process_request(self, request):
        # Store the start time when the request comes in.
        request.start_time = time.time()

    def process_response(self, request, response):
        # Calculate and output the page generation duration
        # Get the start time from the request and calculate how long
        # the response took.
        self.duration = time.time() - request.start_time

        response["x-server-time"] = datetime.now().strftime("%d/%m/%Y %H:%M")
        response.content = response.content.replace(b"server_time_777", str.encode(response["x-server-time"]))
        response["x-page-generation-duration-ms"] = '{:.3f}'.format(self.duration)
        response.content = response.content.replace(b"gen_duration_time_777", str.encode(response["x-page-generation-duration-ms"]))
        return response 
```

# c++ - 在本机 Win32 GDI 中绘制略透明的蓝色矩形

> ID：10966008
> 
> 赞同：9
> 
> 时间：2012-06-10T02:36:36.240
> 
> 标签：c++, winapi, gdi

**如何在 Native Win32 C++ 中绘制 alpha/透明度值为 0.5（即 50% 透明度）的蓝色矩形？**

使用像 RGBA() 这样的宏失败，我不确定如何指定画笔的 alpha 值。

```
SetDCPenColor(hdc, RGBA(255,255,0,127));
SetDCBrushColor(hdc, RGBA(255,255,0,127));
Rectangle(hdc, 0, 0, width, height); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-10T02:45:52.037

我很确定你需要[GDI+](http://msdn.microsoft.com/en-us/library/windows/desktop/ms533799%28v=vs.85%29.aspx)来做到这一点，但它应该与 GDI 一起存在：

```
//in rendering function
using namespace Gdiplus;
Graphics g (hdc);
SolidBrush brush (Color (127 /*A*/, 0 /*R*/, 0 /*G*/, 255 /*B*/));
g.FillRectangle (&brush, 0, 0, width, height); 
```

从好的方面来说，GDI+，虽然没有那么快，但具有更强大的功能和视觉效果，并且是面向对象的，这也意味着您无需担心所有这些`SelectObject`和`DeleteObject`调用。

请注意，在初始化/结束程序以使用 GDI+ 时有几个[额外的步骤](http://msdn.microsoft.com/en-us/library/windows/desktop/ms533895%28v=vs.85%29.aspx)`Gdiplus`，并且所有内容都在命名空间中，并且`-lgdiplus`.

如果你真的需要 GDI，我知道的唯一解决方案是[AlphaBlend](http://msdn.microsoft.com/en-us/library/windows/desktop/dd183351%28v=vs.85%29.aspx)，它确实是一种比简单地在设备上下文中绘制形状更复杂的方法。开始使用 GDI+ 总是好的，因为它仍在使用中，并且比 GDI 更易于使用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-10T02:47:34.520

您需要使用 AlphaBlend 功能 -
[http://msdn.microsoft.com/en-us/library/windows/desktop/dd183351(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/dd183351(v=vs.85).aspx)
[http://www.codeproject.com/Articles/ 286/使用-the-AlphaBlend-function](http://www.codeproject.com/Articles/286/Using-the-AlphaBlend-function)

# c++ - QFile VS ifstream。哪个更快？

> ID：10966015
> 
> 赞同：1
> 
> 时间：2012-06-10T02:39:41.120
> 
> 标签：c++, qt, benchmarking, ifstream, qfile

我试图找出哪个更快，以及学习如何进行基准测试。您认为这是测试 QFile VS ifstream 的准确方法吗？

[http://ideone.com/ipkGh](http://ideone.com/ipkGh)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-10T02:52:07.570

速度和优化是每个程序的两个重要因素。它们比语言或实现更依赖于程序员。很多时候，当我们需要优化时，我们认为当前的语言或实现没有优化。`ifstream`是 C++ 中的标准类，我认为 QFile 使用它。您想要测量的速度和比率可以在定义的环境中描述和测量，最好描述您所面临的情况。

另一个重要的一点，我不明白为什么文件操作符类的速度对你很重要？！许多与文件相关的操作可以而且应该在内存中完成，并且对硬盘的陷阱应该保持在最低限度。因此，在理想情况下，我认为 . 或任何较慢的文件访问框架之间没有`ifstream`区别`QFile`。对于您和一般来说，这两个类都使用本机操作系统库。我认为`QFile`使用`ifstream`. `ifstream`是本机操作系统库的包装器，并且`QFile`由于附加属性而成为更厚的包装器。但是当您想以优化和托管的方式使用内存时，我认为这不是很重要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T02:52:19.157

好吧，我会说他们都很快。您始终可以检查执行 ifstream 和 QFile 操作所需的时间。但就像有人说的那样，如果你使用 QFile 你写的行更少。

# java - 使用内联 CSS 提取 HTML 文章文本

> ID：10966017
> 
> 赞同：1
> 
> 时间：2012-06-10T02:40:04.510
> 
> 标签：java, extraction, boilerpipe

我想从抓取的 html 网页中提取文本。我正在使用优秀的开源[Boilerpipe](http://code.google.com/p/boilerpipe)库来做到这一点。但是，使用 Boilerpipe 我只能得到原始文本。除了原始文本之外，我还需要使用原始源格式信息捕获文本，并内联所有 css 样式信息。

有没有办法用 Boilerpipe 或任何其他 java 库来做到这一点，最好是开源的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T03:58:52.970

我应该首先说我从未使用过 Boilerpipe ......甚至直到现在才听说过它。

但是看看网站和javadocs，我会说你不能用它来提取带有样式的文本。基本的概念问题是该样式将/可以如何表示。例如，[`BoilerpipeExtractor`](http://boilerpipe.googlecode.com/svn/trunk/boilerpipe-core/javadoc/1.0/de/l3s/boilerpipe/BoilerpipeExtractor.html)接口有 4 个`getText`方法，每个方法都将提取的文本作为字符串返回。您将如何表示字符串中的样式？您必须嵌入某种标记，但是...

*   什么样的标记，以及
*   您如何将其与接口的描述相协调，该描述表示方法返回“文本”......而不是“带有标记的文本”。

所以，我的评估是，使用 Boilerpipe 来提取带有样式的文本是完全不可能的。因此，请选择您已经确定的其他替代方案。

# asp.net-mvc-3 - MVC 默认重定向错误页面并不总是显示

> ID：10966022
> 
> 赞同：4
> 
> 时间：2012-06-10T02:40:59.173
> 
> 标签：asp.net-mvc-3, error-handling

我的 MVC 应用程序中有一个自定义错误页面，它只是 ~/error/ 但是当我在 Web.Config 中打开自定义错误时，如下所示：

```
<customErrors mode="On" defaultRedirect="~/error/" /> 
```

它仅适用于 400 错误而不是服务器端 500 错误，而是在白页上给我以下错误消息：

“抱歉，处理您的请求时出现了一个错误。”

我怎样才能让每一个错误都转到 defaultRedirect 页面？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T03:50:55.573

500 错误应该由 MVC 应用程序自己处理。定义的自定义错误`web.config`用于 500 错误以外的错误。

基本上，您需要使用`RegisterGlobalFilter`方法 (in `global.asax`) 向过滤器集合添加一个新`HandleErrorAttribute`的（您将在 HandleErrorAttribute 中命名用于错误的视图），然后创建一个将其作为模型的视图`System.Web.Mvc.HandleErrorInfo`。没有控制器可以处理这些错误或将模型发送到视图，因此您不能只重定向到错误页面。

[您可以在http://community.codesmithtools.com/CodeSmith_Community/b/tdupont/archive/2011/03/01/error-handling-and-customerrors-and-mvc3-oh-my.aspx](http://community.codesmithtools.com/CodeSmith_Community/b/tdupont/archive/2011/03/01/error-handling-and-customerrors-and-mvc3-oh-my.aspx)获得更多信息。

**编辑**有一种替代方法，其中所有错误都通过 MVC 处理，如[如何在 Asp.Net Mvc 3 中显示自定义错误页面？](https://stackoverflow.com/questions/6733064/how-do-i-display-custom-error-pages-in-asp-net-mvc-3). 基本上，您在 global.asax 文件中设置一个`protected void Application_Error()`来处理所有错误，而无需通过 web.config。

# javascript - 使用 JavaScript 单击 HTML 中的链接

> ID：10966027
> 
> 赞同：-4
> 
> 时间：2012-06-10T02:43:04.067
> 
> 标签：javascript, dom, hyperlink, click

请帮助我，我想使用 JavaScript 单击此 html 代码上的链接：

```
<form id="xForm" method="post" action="">
<table>
  <tr id="abc">
    <td class="goTo" id="goToLINK">
      <a class="gotoLINK arrow" href="start.php?from=list&amp;kid=123">LINK</a>
    </td>
  </tr>
</table>
</form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T02:53:38.400

```
document.getElementsByClassName("gotoLINK")[0].click(); 
```

[MDN 参考](https://developer.mozilla.org/en/DOM/element.click)

它适用于所有支持 JavaScript 并遵循 HTML5 规范的浏览器，包括 Internet Explorer 和 Firefox。

> 但是，现在所有元素都支持它，正如 HTML5 所要求的那样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T07:19:49.083

```
document.getElementsByClassName("gotoLINK")[0].click(); 
```

但请记住，这种方法不适用于 Firefox（据我所知）的安全问题，并且不建议使用它，因为它可能会烦人页面访客

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-10T03:49:42.340

```
document.getElementById('goToLINK').children[0].click() 
```

# ruby-on-rails - 在面向服务的架构中传递更大的数据

> ID：10966028
> 
> 赞同：0
> 
> 时间：2012-06-10T02:43:24.883
> 
> 标签：ruby-on-rails, ruby-on-rails-3, distributed-system

我有一个面向服务的架构，许多系统相互通信，但最终通过一个 Web 前端应用程序。将存储在一个应用程序上的视图传递给前端应用程序以呈现给最终用户的好方法是什么？

这样做的原因是视图所在的应用程序是控制信息的逻辑位置，我只希望前端简单地呈现文档。有时这甚至可能是一个需要输入的表单（这使得它更加复杂）。我很想看看其他人是如何处理这个问题的。

问题是，这样做是否可取，以及如何做到这一点的解决方案可能是什么？

# jquery - 缓存页面上的就绪事件？

> ID：10966030
> 
> 赞同：3
> 
> 时间：2012-06-10T02:43:38.197
> 
> 标签：jquery

每当浏览器中显示页面时，我想触发一些代码：

```
$(function() {
   console.log('got ready event!');
}); 
```

仅当浏览器下载页面时才会触发此事件。如果我导航到不同的页面，然后返回，则不会触发上述代码段。似乎浏览器缓存了页面状态，因为在显示页面时服务器没有收到任何请求。因此，当我返回页面时，它会在不触发`ready`事件的情况下恢复缓存的页面状态。

每当显示页面时，无论页面是否被缓存，我都可以收听一个事件吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T03:04:34.673

试试这个，该指令`cashe-control:no-cashe`指示不应使用缓存信息，而应将请求转发到源服务器。

```
<meta http-equiv="cashe-control" content="no-cashe"> 
```

* * *

尝试[`pageshow`](https://developer.mozilla.org/en/using_firefox_1.5_caching#pageshow_event)事件：

> 此事件的工作方式与 load 事件相同，只是它在每次加载页面时触发。第一次加载页面时，pageshow 事件会在 load 事件触发后触发。pageshow 事件使用一个名为persisted 的布尔属性，在初始加载时设置为false。如果不是初始加载，则设置为 true（换句话说，在页面缓存时设置为 true）。

```
$(document).bind('pageshow', function(){

}) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-02-24T17:14:57.937

我知道这是一个老案子，但我也为此苦苦挣扎。“pageshow”可以完成这项工作，但似乎您必须将此事件绑定到窗口而不是文档。因此，代码必须如下所示：

```
$(window).on('pageshow', function(){ alert('page show'); }); 
```

# c++ - 在 crtp 基类中延迟成员函数实例化

> ID：10966031
> 
> 赞同：2
> 
> 时间：2012-06-10T02:43:44.973
> 
> 标签：c++, c++11, visual-studio-2012

目前，我有一个 CRTP 基类，它利用特征类来确定其成员函数的返回类型。我一直在玩 C++11 并有以下代码，它消除了对特征类的需要，但需要默认函数模板参数。是否有某种方法可以修改它以在不支持 C++11 的该功能的 Visual Studio 2012 中工作？

```
#include <iostream>

using namespace std;

template<typename T, typename Ignore> 
struct ignore { typedef T type; };

template<typename T> 
struct A 
{
    template<class IgnoredParam = void>
    auto foo() -> decltype(declval<typename ignore<T*, IgnoredParam>::type >()->foo_impl()) 
    {
        return static_cast<T*>(this)->foo_impl();
    }        
};

struct B : public A<B> 
{
    int foo_impl() { return 0;}

};

int main()
{
    B b;
    int i = b.foo();
    cout << i << '\n';
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T02:51:49.003

你可以简单地使用

```
decltype(declval<T>()->foo_impl()) 
```

作为延迟返回类型。

# android - 自定义视图按钮

> ID：10966036
> 
> 赞同：0
> 
> 时间：2012-06-10T02:46:07.520
> 
> 标签：android, class, view, android-widget

我这里有一个自定义视图，然后我想要一些小部件来配合它。

```
<com.zone.manager.Tab3
    android:id="@+id/tab3_display"
    android:layout_width="fill_parent"
    android:layout_height="620dp" >

<Button
    android:id="@+id/addZone"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Add Zone" />

</com.zone.manager.Tab3> 
```

现在我想将该按钮设置为 onclicklistener 以便我可以在 View 类中使用它做一些事情，所以我这样做了......

```
addZone = (Button) findViewById(R.id.addZone);

  addZone.setOnClickListener(this); 
```

我把它设置在

```
public class Tab3 extends ViewGroup implements OnTouchListener, OnClickListener
    Public Tab3(Context context, AttributeSet attrs) 
    {
    super (context, attrs); 
    // here
    } 
```

当我扩展 ViewGroup 时，它让我实现了这个

```
@Override
    protected void onLayout(boolean changed, int l, int t, int r, int b) 
    {
        // TODO Auto-generated method stub

    } 
```

为了完成这项工作，我是否应该在这里放一些东西？

但是当我尝试运行应用程序时它崩溃了，但是如果我 //`addZone.setOnClickListener(this);`应用程序运行良好，对我有什么帮助吗？

标签

```
 th.setup();
        TabSpec specs = th.newTabSpec("tag0");
        specs.setContent(R.id.connecttionTab);
        specs.setIndicator("Connection Tab");
        th.addTab(specs);
        specs = th.newTabSpec("tag1");
        specs.setContent(R.id.tab1);
        specs.setIndicator("Zone Manager");
        th.addTab(specs);
        specs = th.newTabSpec("tag2");
        specs.setContent(R.id.tab2);
        specs.setIndicator("",res.getDrawable(R.drawable.ic_tab_vaccontrol));
        th.addTab(specs);
        //this is the tab that has all this vvv
        specs = th.newTabSpec("tag3");
        specs.setContent(R.id.tab3);
        specs.setIndicator("Graphical Layout");
        th.addTab(specs); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T02:52:51.470

在您的 xml 中，您的自定义视图不*包含*按钮；这是一个兄弟视图。您的应用程序崩溃的原因是`findViewById(R.id.addZone)`正在返回`null`，因此您`NullPointerException`在调用时会收到一个`addZone.setOnClickListener(this)`。如果您希望自定义视图包含按钮，则​​ xml 必须如下所示：

```
<com.zone.manager.Tab3
    android:id="@+id/tab3_display"
    android:layout_width="fill_parent"
    android:layout_height="620dp" >

    <Button
        android:id="@+id/addZone"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Add Zone" />

</com.zone.manager.Tab3> 
```

此外，您的`Tab3`课程必须扩展`ViewGroup`，而不是`View`. 这可能会有点复杂，因为您还需要编写代码来进行布局。该按钮也将显示在`Tab3`视图内。

**编辑**

根据您对您正在尝试做的事情的评论，我不推荐上述方法。相反，您应该将自定义视图和 Button 包装在`LinearLayout`. 例如，下面的布局会将按钮放在屏幕的左下角，并且会有一个 Tab3 视图填充其上方的区域：

**res/layout.tab3.xml**

```
<LinearLayout
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical" >

    <com.zone.manager.Tab3
        android:id="@+id/tab3_display"
        android:layout_width="fill_parent"
        android:layout_height="0dp"
        android:layout_weight="1" />

    <Button
        android:id="@+id/addZone"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:onClick="onAddZone"
        android:text="Add Zone" />

</LinearLayout> 
```

然后，将点击处理逻辑移动到您的类`Tab3`可见的单独方法中。`Activity`（让我们假设它被调用`addZone()`。）`Tab3`该类不应该实现`OnClickListener`并且应该扩展`View`（不像`ViewGroup`上面那样）。通过将`android:onClick`属性添加到按钮，您不需要添加`OnClickListener`按钮。相反，您需要在活动中实现该名称的 click 方法：

```
private Tab3 mTab3;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.tab3);
    mTab3 = (Tab3) findViewById(R.id.tab3_display);
    // . . .
}

@Override
/**
 * Called when a view with attribute android:onClick="onAddZone"
 * is clicked.
 *
 * @param view the view that was clicked.
 */
public void onAddZone(View view) {
    mTab3.addZone();
} 
```

尽管您的代码中没有关于按钮的任何内容，但框架将使用反射自动将所有内容连接起来，以便在`onAddZone`单击按钮时调用活动的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-06-23T23:17:39.577

这不是在 xml 文件中具有布局时扩展视图组的正确方法。您需要将 xml 更改为如下所示：

**R.layout.xml_file_for_custom_view**

```
<merge xmlns:android="http://schemas.android.com/apk/res/android" 
       xmlns:tools="http://schemas.android.com/tools"

       tools:parentTag="com.zone.manager.Tab3">

    <Button
        android:id="@+id/addZone"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Add Zone" />

</merge> 
```

在自定义视图的代码中，您需要扩展 xml 并添加您的 onclick 侦听器：

**Tab3.java**

```
public class Tab3 extends ViewGroup implements OnTouchListener, OnClickListener

    public Tab3(Context context, AttributeSet attrs) {
        super (context, attrs);
        // inflate and attach the layout to this viewgroup
        View.inflate(getContext(), R.layout.xml_file_for_custom_view, this);
    }

    @Override
    public void onFinishInflate() {
        super.onFinishInflate();
        // Now you can find the button
        addZone = (Button) findViewById(R.id.addZone);
        addZone.setOnClickListener(this);
    }
} 
```

现在，无论您在何处使用自定义视图，您都可以执行以下操作：

```
<com.zone.manager.Tab3
    android:id="@+id/tab3_display"
    android:layout_width="fill_parent"
    android:layout_height="620dp"/> 
```

至于您对`onLayout`方法的问题：

```
@Override
protected void onLayout(boolean changed, int l, int t, int r, int b) {
    // TODO Auto-generated method stub
} 
```

是的，您需要在其中放置一些代码。请参阅[本指南](https://developer.android.com/reference/android/view/ViewGroup#developer-guides)以帮助您入门。

# excel - Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean) 和 Range 错误

> ID：10966037
> 
> 赞同：2
> 
> 时间：2012-06-10T02:46:12.093
> 
> 标签：excel, double-click, vba

希望有人可以帮助解决我遇到的 VBA 问题。

当用户双击单元格时，我想更改命名范围的值。有两个工作表，一个是单元格中的值的初始工作表，另一个是包含命名范围 Account_Number 的目标工作表。

这是我的代码：

```
Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)

    [Account_Number] = ActiveCell.Value 'assign the value to the Named Range

    Range([Account_Number]).Select ' go to the Named Range on the other worksheet

   'Sheets("Transaction Listing_LINKS").Select 'the workaround to the problem below
End Sub 
```

我期望的是命名范围被填充和选择。

问题是我得到一个

> “1004 错误：对象 '_Worksheet' 的方法 'Range' 失败”

双击单元格时出错。

奇怪的是，如果我只使用一个工作表，它就可以正常工作。

谁能向我解释为什么会发生这种情况以及如何避免它？

我能想到的唯一修复/解决方法是对工作表的选择进行编码以强制它选择它。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T03:27:31.270

尝试：

```
Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)
  'assign the value to the Named Range
  Sheet2.Range("Account_Number").Value = ActiveCell.Value
  ' go to the Named Range on the other worksheet
  Application.GoTo Reference:="Account_Number" 
 'Sheets("Transaction Listing_LINKS").Select 'the workaround to the problem below
End Sub 
```

当然，您需要将“Sheet2”更改为包含命名范围的目标工作表名称。

# vb.net - 将用户控件添加到 vb.net 标签页后，标签页为空

> ID：10966039
> 
> 赞同：1
> 
> 时间：2012-06-10T02:46:30.297
> 
> 标签：vb.net, tabs

我正在尝试在标签页上显示一个用户控件（**在另一个面板的顶部有几个面板**）。我正在使用下面的代码来实现这一点。

```
Dim ctrl As TechniciansControl = New TechniciansControl
TabControl1.TabPages(2).Controls.Add(ctrl) 
```

问题是控件不显示任何内容。我验证了控件是否正确创建。标签页为空。**它适用于只有一个面板的其他用户控件。**

感谢任何解决此问题的想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T03:19:18.653

确保控件是可见的，并且确保它的位置在选项卡控件的可见客户区域内。

# objective-c - 尝试侦听 UIApplicationDidReceiveMemoryWarningNotification 时出现“无法识别的选择器”

> ID：10966044
> 
> 赞同：1
> 
> 时间：2012-06-10T02:48:09.373
> 
> 标签：objective-c, ios, nsnotificationcenter

我有一个类似“静态”的类，我希望能够响应低内存警告。但是，当我从模拟器手动触发内存不足警告时，我收到“无法识别的选择器”错误。

相关代码：

```
@interface MyClass : NSObject
+ (void) receiveNotification:(NSNotification*) notification;
@end 

@implementation MyClass
+ (void) initialize {
    [super initialize];
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(receiveNotification) name:@"UIApplicationDidReceiveMemoryWarningNotification" object:nil];
}
+ (void) receiveNotification:(NSNotification*) notification {
    // Breakpoint here never hits.
    // I instead receive error "+[MyClass receiveNotification]: unrecognized selector sent to class".
}
@end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T02:52:54.727

您的方法名称是`receiveNotification:`（注意冒号是名称的一部分）

所以选择器应该是`@selector(receiveNotification:)`

编辑：另外，顺便说一句，我不会在类初始化程序中调用 [super initialize] 。同样，您应该防止子类导致您编写的此初始化程序被调用两次。有关更多信息，请参阅 Mike Ash 的这篇非常好的帖子：[类加载和初始化](http://www.mikeash.com/pyblog/friday-qa-2009-05-22-objective-c-class-loading-and-initialization.html)

我希望这会有所帮助。

# javascript - keyup 在 IE 8 中不起作用

> ID：10966046
> 
> 赞同：1
> 
> 时间：2012-06-10T02:48:26.480
> 
> 标签：javascript, jquery, html, internet-explorer

我刚刚意识到这段代码在 Firefox 中运行良好，但在 IE 8 中运行良好。当用户在输入字段中输入至少 8 个字符时，我需要自动填充列表。

```
$('#inputField').keyup(function (event) { 
    var $inputField = $(this); 
        if ($inputField.val().length >= 8) { popularListBox(); } 
});

function populateListBox(){
    $.get("Default.aspx?name=test", function(data) {
        $('#listBox').children().remove();
        var options = data;
        $("#listBox").html(data);
    });
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-10T05:34:05.370

您想检测输入字段的变化，然后执行一些操作，对吗？

我认为您可能会检测到更改，而不仅仅是键盘操作。例如，如果用户从剪贴板粘贴呢？

请尝试以下代码：

```
$('#inputField').bind('propertychange input paste', function() {
  // do poppularListBox()
}); 
```

它适用于大多数输入字段，包括 textarea。请查看 jQuery 站点以获取更多信息。

根据我的经验，.keyup() 和 .keypress() 经常在 IE 中出错。如果可能的话，我想使用 .keydown() （逐案）

# windows - inconsolata 不工作 Windows 7

> ID：10966049
> 
> 赞同：0
> 
> 时间：2012-06-10T02:49:25.270
> 
> 标签：windows, fonts

我不知道要在哪个 SE 站点上询问这个问题（没有像[**linux**](http://unix.stackexchange.com)上那样的 Windows SE 站点；）所以我会试试这个。

我尝试安装[**inconsolata**](http://levien.com/type/myfonts/inconsolata.html)作为我的默认编程字体。问题是，它看起来要么一团糟，要么完全是胡言乱语。如果有帮助，我正在使用 Windows 7 Home Premium。

我已经包含了一些屏幕截图，因此您可以自己查看。第一个是 jsfiddle（使用 inconsolata），第二个是 netbeans，其代码与 jsfiddle 相同：

![jsfiddle](../Images/127fd1f831404fd7b035614795cd74b0.png)

* * *

![网豆](../Images/b1866d365d8626676204f179bf8ea23e.png)

有人对这个有经验么？有解决这个问题的方法吗？

我也刚刚注意到该字体甚至没有出现在 Windows 字体列表中

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T04:52:12.430

我能想到的唯一建议是增加字体的大小，看看它是否以这种方式呈现得更好一些。

我在 Windows 7 和 8 (RP) 上都使用过 Inconsolata，根据我的经验，它似乎运行良好。我也将它与我自己的软件一起使用，没有问题。我不完全确定为什么会发生这种情况。

# java - 对象输出流不写入自定义对象

> ID：10966052
> 
> 赞同：2
> 
> 时间：2012-06-10T02:50:31.853
> 
> 标签：java, serialization

我正在使用 socketserver 通过`ObjectOutputStream`. 它适用于任何标准 Java 对象，但我无法发送我的自定义对象。我明白了

> java.io.NotSerializableException：MyObject。

我对序列化一无所知，但我做到了，Eclipse 告诉我。还尝试在任何地方删除它，没有任何帮助。我的对象是从其他自定义抽象类继承的，尚未对其他自定义对象进行测试。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-10T02:53:48.450

您的对象必须实现[`Serializable`](http://docs.oracle.com/javase/6/docs/api/java/io/Serializable.html). 您的“自定义”抽象类也必须是可序列化的。如果您无法更改抽象类（即它不受您的控制），则适用以下情况：

> 为了允许序列化不可序列化类的子类型，子类型可以负责保存和恢复超类型的公共、受保护和（如果可访问）包字段的状态。仅当它扩展的类具有可访问的无参数构造函数来初始化类的状态时，子类型才可以承担此责任。如果不是这种情况，则声明类 Serializable 是错误的。将在运行时检测到错误。

关于你的句子：

> 我对序列化一无所知

那我建议你去研究一下……从阅读开始：

*   [发现 Java 序列化 API 的秘密](http://java.sun.com/developer/technicalArticles/Programming/serialization/)
*   [`Serializable`](http://docs.oracle.com/javase/6/docs/api/java/io/Serializable.html)Javadoc
*   [`ObjectOutputSteam`](http://docs.oracle.com/javase/6/docs/api/java/io/ObjectOutputStream.html)Javadoc

# javascript - 在骨干网中过滤的 ID 数组上使用 .set

> ID：10966056
> 
> 赞同：0
> 
> 时间：2012-06-10T02:51:07.827
> 
> 标签：javascript, backbone.js, underscore.js

我使用 Underscore.js`_.filter`来获取对象 ID 数组，如下所示：

```
var downstreamMeters = _.filter(that.collection.models, function(item) { return item.get("isdownstreammeter"); }); 
```

现在我想设置数组中每个模型的某个属性。我认为这样做是有意义的：

```
for (var i = 0; i < downstreamMeters.length; i++) {
    var sum = 0;
    inputMeters = downstreamMeters[i].get("inputmeters");
    for (var i = 0; i < inputMeters.length; i++) {
        var flow = parseFloat(that.collection.get(inputMeters[i]).get("adjustedflow"));
        sum += flow;
    }
    downstreamMeters[i].set({incrementalflow: sum});
} 
```

但是，我收到错误：

```
Uncaught TypeError: Cannot call method 'set' of undefined 
```

我检查了`downstreamMeters`数组，它里面有正确的对象。我需要做什么来为数组中的每个模型设置属性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T19:56:48.223

说`for(var i = 0; ...)`的有些误导。JavaScript 将所有`var`声明提升到最近范围的顶部，并且`for`循环不会创建自己的范围。结果是这样的：

```
for (var i = 0; i < downstreamMeters.length; i++) {
    var sum = 0;
    inputMeters = downstreamMeters[i].get("inputmeters");
    for (var i = 0; i < inputMeters.length; i++) {
        var flow = parseFloat(that.collection.get(inputMeters[i]).get("adjustedflow"));
        sum += flow;
    }
    downstreamMeters[i].set({incrementalflow: sum});
} 
```

与此相同：

```
var i, sum, flow;
for (i = 0; i < downstreamMeters.length; i++) {
    sum = 0;
    inputMeters = downstreamMeters[i].get("inputmeters");
    for (i = 0; i < inputMeters.length; i++) {
        flow = parseFloat(that.collection.get(inputMeters[i]).get("adjustedflow"));
        sum += flow;
    }
    downstreamMeters[i].set({incrementalflow: sum});
} 
```

`i`现在您可以看到您在外部和内部循环中使用完全相同的内容。在第一次运行循环时，`i`将`inputMeters.length`在您说`downstreamMeters[i].set(...)`. 显然，`inputMeters.length > downstreamMeters.length`所以你最终跑完了`downstreamMeters`; 如果您尝试访问超出数组末尾的数组元素，您会得到`undefined`并且有您的

> 无法调用未定义的方法“设置”。

错误。

嵌套循环很好，但您应该使用不同的变量：

```
var i, j, sum, inputMeters;
for (i = 0; i < downstreamMeters.length; i++) {
    sum = 0;
    inputMeters = downstreamMeters[i].get("inputmeters");
    for (j = 0; j < inputMeters.length; j++)
        sum += parseFloat(that.collection.get(inputMeters[j]).get("adjustedflow"));
    downstreamMeters[i].set({incrementalflow: sum});
} 
```

# multithreading - 带有线程类的 Qt 信号和槽

> ID：10966061
> 
> 赞同：1
> 
> 时间：2012-06-10T02:52:25.390
> 
> 标签：multithreading, qt, signals, slot

我有一个显示表格、计算数据等的 QWidget TableView 类...

在它的构造函数中，我启动了该类的 FortuneServer 服务器：

```
FortuneServer::FortuneServer(QObject *parent)
    : QTcpServer(parent)
{
... 
```

此类在 FortuneServer::incomingConnection 上启动一个新线程，如下所示：

```
FortuneThread::FortuneThread(int socketDescriptor, const QString &fortune, QObject     *parent)
: QThread(parent), socketDescriptor(socketDescriptor), text(fortune)
{
}

void FortuneThread::run()
{
    QTcpSocket tcpSocket;
    if (!tcpSocket.setSocketDescriptor(socketDescriptor)) {
        emit error(tcpSocket.error());
        cout<<"socket error"<<endl;
        return;
    }
    tcpSocket.waitForReadyRead(10000);
    // this where sockets opens and waits for incoming data... 
```

我需要执行以下操作：

1.  我需要连接从客户端在此线程中获得的字符串，与 TableView 类中的某个函数计算另一个字符串并将其返回到该线程并将其发送到客户端。

2.  如果我从线程使用发射，我如何让线程等待结果？

这是如何正确完成的？

泰

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T03:16:39.507

从网络上的源读取字节时，您可以：

1-使用固定长度的二进制消息。所以你可以等待字节块被读取并做任何你需要做的事情。2- 使用基于字符串的协议，该协议使用分隔符来分隔消息。当看到分隔符时，您需要提取新的收入消息。3- 使用 Content Length 之类的东西来了解有多少字节来了，你应该阅读。

在 Qt 中，您需要`slot`在**Called**类中有一个。以及**Caller**类`signal`中的一个。当一个新字符串到达​​时（使用任何方法），您只需发出信号，被调用的类就会得到通知。您必须使用方法将插槽连接到信号。我认为which is a parent for有一个名为 readyRead() 的信号，当有新数据可用时，它会为您提供信号。**`connect()``QIODevice``QTcpSocket`**

 **永远不要做可能在构造函数中抛出异常的操作。最好以不同的方法从构造函数中创建和启动服务器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-10T03:22:45.377

我认为最好的方法不是启动一个单独的线程，而是将你的 socketDescriptor int 提供给一个 QSocketNotifier 对象（类型为 QSocketNotifier::Read）并将 QSocketNotifier 的 activate(int) 信号连接到你的 GUI 中的一个插槽班级。然后，每当字节准备好从网络读取时，您的插槽将在主线程中被调用，您可以在那里读取它们并处理它们，而无需处理线程间消息传递或信令或阻塞问题。这样容易得多:)**

# objective-c - xcode 中的 sqrtf(6)*sqrtf(6) != 6

> ID：10966071
> 
> 赞同：2
> 
> 时间：2012-06-10T02:54:03.873
> 
> 标签：objective-c, macos, xcode4, sqrt

我正在尝试创建一个软件来显示两个向量之间的角度，当它等于 (1,1,2) 时它不起作用，因此这个向量的模数是 sqrtf(6)，它是 2.449490 并且它应该是 2.44948974278318。

有没有办法提高这个操作的精度？

在我的软件的后续步骤中，我进行了此操作：

```
float angle = acos(dot/(modulus1*modulus2)); 
```

如果模数 1 == 模数 2，则模数 1*模数 2 = 点，但某些值不会发生这种情况。

我希望我说清楚了。

在此先感谢，格鲁伯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-10T03:02:00.053

`double`如果您想要更高的精度，可以使用。但是，请注意，`==`浮点数的操作永远不会像整数类型那样工作。使用 epsilon 调整细微差异。

# c# - 通过 Properties 重定向到其他类是否会导致 C# 中的速度变慢和/或节省空间？

> ID：10966075
> 
> 赞同：0
> 
> 时间：2012-06-10T02:55:54.357
> 
> 标签：c#, c#-4.0

因此，假设我有一个具有这些属性的 Clone 对象。克隆可能具有不同的质量或名称，具体取决于加载它的文件，但这些值在运行时永远不会改变。但是，克隆实例具有一些自主权和属性，每个实例都会发生变化，因此它们不能都是同一个实例。

```
public class Clone
{
    public float Mass { get; protected set; }
    public string Name { get; protected set; }
    public Clone(string filePath)
    {
        Name = //read name from file
        Mass = //read mass from file
    }
} 
```

现在，我想知道的是，这样做的好处和缺点（如果有的话）是什么：

```
public class CloneInfo
{
    public float Mass;
}
public static class Database
{
    public static Dictionary<string, CloneInfo> Lookup;
    [...load whole dictionary from files...]
}
public class Clone
{
    public string Name { get; protected set; }
    public float Mass { get { return Database.Lookup[Name].Mass; } }
    public Clone(string name)
    {
        Name = name;
    }
} 
```

使用这种“重定向”方法，我保留了 Clone.Mass 的简单语法，但不必为每个实例存储一个 Mass 值。既然我有成千上万的克隆人四处游荡，这是一件好事。由于语法，我主要对“重定向”感兴趣。我意识到每次我想要一个特定克隆的质量时，我都可以简单地手动进行数据库查找，但我宁愿保持类的使用简单明了。这有什么缺点吗？该属性会比在静态数据库中直接查找要慢吗？该属性是否占用克隆实例中的任何空间？

或者，也许，这是一个用例 C# 已经有一个我不知道的答案？似乎在许多实例中常见的一次性写入属性*可能*在这种美丽的语言中的某个地方。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T03:17:10.837

如果某种类型的所有克隆都具有相同的质量，这听起来像是子类化的工作：

```
class Clone
{
    public abstract float Mass { get; }
}
class HeavyClone : Clone
{
    public override float Mass { get { return 12345.6; } }
}
class LightClone : Clone
{
    public override float Mass { get { return 1.23456; } }
} 
```

更重要的是您的问题：如果您受内存的限制多于处理时间，那么您的方法可能会带来一些好处。如果内存充足，并且缓存性能不是问题，那么您建议的方法可能没有什么价值。当然，这似乎使代码变得相当复杂。

通常的建议是：编写简单的代码，测量性能，如果性能不足，解决性能瓶颈。这样一来，您只有在真正有助于提高应用程序性能的地方拥有复杂的代码。

另一个想法：与其将克隆索引与`Name`字符串一起放入字典中，不如只使用一个 CloneInfo 字段：

```
public class CloneInfo  
{  
    public float Mass;  
}  
public class Clone  
{  
    private CloneInfo _info;  
    public float Mass { get { return _info.Mass; } }  
    public Clone(CloneInfo info)  
    {  
        _info = info;
    }  
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T03:02:47.017

假设我们有很多对 Mass 属性的访问。如果在每次访问中您都尝试从数据库中加载 Mass 值，那么这对您的应用程序来说可能是一项非常繁重的任务，这将是一个瓶颈。如果质量值可以缓存在对象中，您可以轻松加载它一次并保留它以供进一步使用。

# parsing - Scala 使用 StandardTokenParsers 解析浮点数

> ID：10966078
> 
> 赞同：2
> 
> 时间：2012-06-10T02:57:33.573
> 
> 标签：parsing, scala

这是一阶 ODE 系统的语法：

```
system ::= equation { equation }

equation ::= variable "=" (arithExpr | param) "\n"

variable ::= algebraicVar | stateVar

algrebraicVar ::= identifier

stateVar ::= algebraicVar'

arithExpr ::= term { "+" term | "-" term }

term ::= factor { "*" factor | "/" factor }

factor ::= algebraicVar
          | powerExpr
          | floatingPointNumber
          | functionCall
          | "(" arithExpr ")"

powerExpr ::= arithExpr {"^" arithExpr} 
```

笔记：

*   标识符应该是有效的 Scala 标识符。
*   stateVar 是一个 algebraicVar 后跟一个撇号（x' 表示 x 的一阶导数——关于时间——）
*   我没有为 a 编写任何代码，`functionCall`但我的意思是`Cos[Omega]`

这是我已经拥有的

```
package tests

import scala.util.parsing.combinator.lexical.StdLexical
import scala.util.parsing.combinator.syntactical.StandardTokenParsers
import scala.util.parsing.combinator._
import scala.util.parsing.combinator.JavaTokenParsers
import token._

object Parser1 extends StandardTokenParsers {

  lexical.delimiters ++= List("(", ")", "=", "+", "-", "*", "/", "\n")
  lexical.reserved ++= List(
    "Log", "Ln", "Exp",
    "Sin", "Cos", "Tan",
    "Cot", "Sec", "Csc",
    "Sqrt", "Param", "'")

  def system: Parser[Any] = repsep(equation, "\n")
  def equation: Parser[Any] = variable ~ "=" ~ ("Param" | arithExpr )
  def variable: Parser[Any] = stateVar | algebraicVar
  def algebraicVar: Parser[Any] = ident
  def stateVar: Parser[Any] = algebraicVar ~ "\'"
  def arithExpr: Parser[Any] = term ~ rep("+" ~ term | "-" ~ term)
  def term: Parser[Any] = factor ~ rep("*" ~ factor | "/" ~ factor)
  def factor: Parser[Any] = algebraicVar | floatingPointNumber | "(" ~ arithExpr ~ ")"
  def powerExpr: Parser[Any] = arithExpr ~ rep("^" ~ arithExpr)

  def main(args: Array[String]) {
    val code = "x1 = 2.5 * x2"
    equation(new lexical.Scanner(code)) match {
      case Success(msg, _) => println(msg)
      case Failure(msg, _) => println(msg)
      case Error(msg, _) => println(msg)
    }
  }
} 
```

但是这条线不起作用：

```
def factor: Parser[Any] = algebraicVar | floatingPointNumber | "(" ~ arithExpr ~ ")" 
```

因为我还没有定义什么是`floatingPointNumber`. 首先，我尝试混合使用 JavaTokenParsers，但随后我得到了相互冲突的定义。我尝试使用 StandardTokenParsers 而不是 JavaTokenParsers 的原因是能够使用一组预定义的关键字

```
lexical.reserved ++= List(
    "Log", "Ln", "Exp",
    "Sin", "Cos", "Tan",
    "Cot", "Sec", "Csc",
    "Sqrt", "Param", "'") 
```

我在 Scala 用户邮件列表 ( [https://groups.google.com/forum/?fromgroups#!topic/scala-user/KXlfGauGR9Q](https://groups.google.com/forum/?fromgroups#!topic/scala-user/KXlfGauGR9Q) ) 上问过这个问题，但我没有收到足够的回复。非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T03:50:18.070

鉴于混入`JavaTokenParsers`不起作用，您可以尝试混入并仅从源中`RegexParsers`复制 for 的定义。`floatingPointNumber``JavaTokenParsers`

这个定义，至少在[这个版本](https://github.com/scala/scala/blob/v2.9.2/src/library/scala/util/parsing/combinator/JavaTokenParsers.scala#L1)中只是一个正则表达式：

```
 def floatingPointNumber: Parser[String] =
    """-?(\d+(\.\d*)?|\d*\.\d+)([eE][+-]?\d+)?[fFdD]?""".r 
```

# c# - 在 C# 的泛型方法中使用枚举

> ID：10966079
> 
> 赞同：3
> 
> 时间：2012-06-10T02:57:39.067
> 
> 标签：c#, generics, methods, enums

我今天刚开始学习 C#，我正在尝试制作一个可以对不同枚举进行操作的通用方法。我得到了一些我在纸上的另一个问题中找到的代码，但编译器一直在抱怨。我想知道是否有人可以帮我一把。这是我到目前为止所拥有的：

```
 static void ReadMenuInput<T>(out T menuInput)
    {
        while (true)
        {
            if (enum<T>.TryParse(Console.ReadLine(), out menuInput) && menuInput < sizeof(T))
            {
                break;
            }
            Console.WriteLine("Please enter a valid input.");
        } 
    } 
```

感谢您的帮助！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-10T03:20:43.423

该特定代码片段有几个不同的问题，其中一些问题比其他问题更容易处理。其中一些只是表明您缺乏经验：

*   `enum`并且`Enum`不可互换；一个是类名，一个是 C# 关键字。在某些情况下（比如`string`and `String`），关键字只是类型的别名，而`enum`不是类型名称，它用于*定义*类型名称。要调用类方法，您需要使用`Enum`.
*   您正在尝试`TryParse<>`使用错误的语法调用泛型方法；它应该是`Enum.TryParse<T>`。
*   枚举和整数不是同一类型，不能只比较它们。但是，它们可以通过显式类型转换相互转换*。*由于`sizeof`返回 an `int`，因此您需要这样的类型转换（但请参见下文）。

您的代码示例更复杂的问题：

*   `sizeof(enum)`我认为并没有达到你的预期；它返回枚举*的字节*大小，通常为 4。您可能需要该[`IsDefined`](http://msdn.microsoft.com/en-us/library/system.enum.isdefined.aspx)方法，它可以让您知道是否在枚举类型中定义了特定的整数值
*   正如编译器会告诉您的那样，您只能在此上下文中使用不可为空的泛型类型。定义它的方法是对泛型类型进行[`where T: struct`约束。](http://msdn.microsoft.com/en-us/library/d5x73970.aspx)请注意，尽管它的名字，这并不强制你的类型是一个结构。它只是强制它成为一个值类型。
*   您无法在泛型类型上指定它必须是枚举类型的约束；如果您将一些其他值类型传递给该方法，它将在运行时引发异常。正确处理此案由您决定。

这是您想要的代码片段的工作（如 - 它编译 - 我还没有实际测试过）版本。但是，我要指出的是，您的原始代码中的每一个问题都可以通过阅读和理解错误消息来解决；这是作为 C# 开发人员应该掌握的最重要的技能之一。

```
static void ReadMenuInput<T>(out T menuInput) where T : struct
{           
  while (true)
  {
    if (Enum.TryParse<T>(Console.ReadLine(), out menuInput)
     && Enum.IsDefined(typeof(T), menuInput))
    {
      break;
    }

    Console.WriteLine("Please enter a valid input.");
  } 
} 
```

# php - 改进此 PHP 功能的任何建议

> ID：10966082
> 
> 赞同：0
> 
> 时间：2012-06-10T02:59:00.170
> 
> 标签：php, function

这是一个简单的函数，它将邮政编码作为输入，在正确的数组中找到邮政编码并返回相应的城市。

```
function zipcode_search($a){

$zip = (int)$a;
//arrays of zipcodes to corresponding cities
$FtMyers = array(33901,33902,33903,33905,33906,33907,33908,33911,33912,33913,33916,33917,33918,33919,33965,33966,33967,33990,33993,33994);
$Naples  = array(34101,34102,34103,34104,34105,34106,34107,34108,34109,34110,34112,34113,34114,34116,34117,34119,34120);
$Cape    = array(33904,33909,33910,33914,33915,33990,33991,33993);
$PtChar  = array(33948,33949,33952,33953,33954,33980,33981,33983);
$Bonita  = array(34133,34134,34135,34136);
$Marco   = array(34145,34146);
$Estero  = array(33928,33929);
$FMBeach = array(33931,33932);
$Sanibel = array(33957);

    if (in_array($zip, $Naples))
        {
            return "Naples, FL";
        }
elseif (in_array($zip, $Marco))
        {
            return "Marco Island, FL";
        }
elseif (in_array($zip, $Bonita))
        {
            return "Bonita Springs, FL";
        }
elseif (in_array($zip, $Estero))
        {
            return "Estero, FL";
        }
elseif (in_array($zip, $FtMyers))
        {
            return "Fort Myers, FL";
        }
elseif (in_array($zip, $FMBeach))
        {
            return "Ft. Myers Beach, FL";
        }
elseif (in_array($zip, $Cape))
        {
            return "Cape Coral, FL";
        }   
elseif (in_array($zip, $Sanibel))
        {
            return "Sanibel Island, FL";
        }
elseif (in_array($zip, $PtChar))
        {
            return "Port Charlotte, FL";
        }
else    {   return "Florida";}  
} 
```

我知道我可以做得更好，同时提高它的功效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T03:02:14.640

```
$pcodes = array(33901 => "Fort Myers, FL", 33902 => "Fort Myers, FL",
  33903 => "Fort Myers, FL", ...);

if (isset($pcodes[$zip]))
{
  return $pcodes[$zip];
}
else
{
  return 'Florida';
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-10T03:16:57.190

*   邮政编码会随着时间而变化，因此您的功能不会是防弹的。如果需要，请使用像前锋这样的服务。
*   您最好将这样的列表存储在数据库中。（除非您列出了您需要处理的每个邮政编码。它只是我所说的应该在数据库中的风口浪尖）

恕我直言，Ignacio Vazquez-Abrams 的解决方案很难维护——那里有很多复制和粘贴。这是一个替代方案，与您最初的类似：

```
function zipcode_search($zip){
    $city_zips = array(
        "Naples, FL" => array(34101,34102,34103,34104,34105,34106,34107,34108,34109,34110,34112,34113,34114,34116,34117,34119,34120),
        "Marco Island, FL" => array(34145,34146),
        // etc
    );

    foreach( $city_zips as $city => $zips ){
        if( in_array($zip, $zips) ){
            return $city;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-10T03:14:47.593

```
function zipcode_search($zip){
    $zip_array['Fort Myers, FL'] = array(33901,33902,33903,33905,33906,33907,33908,33911,33912,33913,33916,33917,33918,33919,33965,33966,33967,33990,33993,33994);
    //... continue....

    foreach($zip_array as $city => $zips){
        if(in_array($zip, $zips)){
            return $city;
        }
    }
} 
```

# objective-c - iOS Tweet 透明的未压缩图像

> ID：10966089
> 
> 赞同：1
> 
> 时间：2012-06-10T03:01:08.237
> 
> 标签：objective-c, ios, twitter, png, ios6

我正在开发一个处理图像编辑的应用程序，并且我正试图集成 twitter。到目前为止，它运行良好，我可以从应用程序内发送推文并附加用户正在编辑的图像。我注意到的缺点是图像会自动压缩。这意味着用户正在编辑的 PNG，如果它具有透明度，则不再具有透明度。这不好。有没有解决的办法？我希望能够发送推文并附加透明的PNG图像，基本上防止它在发送后转换为JPG。

这是我到目前为止的代码。非常不言自明和直截了当。

```
SLComposeViewController *tweetSheet = [SLComposeViewController composeViewControllerForServiceType: SLServiceTypeTwitter];

[tweetSheet addImage:self.workingImage];

[self presentModalController:tweetSheet animated:YES completion:nil]; 
```

`self.workingImage`是用户正在处理的图像。

**编辑：**我已经更新了上面的代码以在 iOS6 上工作，并且似乎有完全相同的问题（我猜这并不奇怪）。看起来一旦图像在 Twitter 上，它是 JPG 格式。有没有办法保持PNG格式？

我不想失去所有这些简单的代码，只是为了走上使用 3rd 方图像托管网站的路线。

**编辑 2：**我现在已将所有代码转换为不再使用 alpha 通道。这意味着我不再关心图像是 PNG 还是 JPEG 格式，因为所有 3 个 RGB 通道将始终存在。无论原始图像的质量如何，发布推文**仍然会在发布之前压缩图像。**

我什至使用该应用程序将图像发布到推特，将其通过推特压缩，保存图像并尝试使用新压缩的图像重复，但推特**仍然被压缩！**

我迷路了。推特（甚至脸书）无论如何都会压缩图像吗？我唯一的选择是第三方图片托管网站吗？我不想失去 iOS6 框架内置的所有不错的社交功能，转而使用第三方网站...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T04:16:14.203

这是推特方面的问题。无论如何，它都会压缩您的图像。也许您应该考虑将 .png 上传到您自己的服务器，然后在推文中发布它的链接。

您还可以使用其他图像托管服务..

# php - MySQLi查询以获取表中的最大ID？

> ID：10966095
> 
> 赞同：1
> 
> 时间：2012-06-10T03:02:42.970
> 
> 标签：php, mysqli

```
 $mysqli = new mysqli("localhost","root","","mydatabase");

 if ($result = $mysqli->prepare("SELECT MAX(`id`) AS `id` FROM `mytable` WHERE `row1`=? OR `row2`=?"))
 {

    $id = 2;
    $result->bind_param("ii",$id,$id);
    $result->execute();
    $result->bind_result($max);
    $result->close();

    var_dump($max);

 }

 $mysqli->close(); 
```

不幸的是，这段代码总是显示**NULL**，你能解释我如何得到结果吗？

**更新：**

在控制台模式下，这样的工作人员效果很好。字段`id`是 int 和增量（作为 PRIMARY INDEX），其他字段只是具有不同 int 值的行，我无法更改任何内容。

**更新：**

好吧，似乎我找到了解决方案：

```
 $mysqli = new mysqli("localhost","root","","mydatabase");

 if ($result = $mysqli->prepare("SELECT MAX(`id`) AS `id` FROM `mytable` WHERE `row1`=? OR `row2`=?"))
 {

    $id = 2;
    $result->bind_param("ii",$id,$id);
    $result->execute();
    $obj = $result->get_result()->fetch_object();
    $max = $obj->id;
    $result->close();

    var_dump($max);

 }

 $mysqli->close(); 
```

就是这个。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-04-10T23:24:44.980

我是这样想的：

```
$result = mysqli_query($con, "SELECT * FROM `TableName` ORDER BY `PID` DESC LIMIT 1");
$row = mysqli_fetch_array($result);
$pidmax=$row['PID']; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-10T03:35:45.197

您仍然需要调用 fetch，因为 max 仅在该点之后可用。见文档： http: [//php.net/manual/en/mysqli-stmt.bind-result.php](http://php.net/manual/en/mysqli-stmt.bind-result.php)

```
$result->bind_result($max);

/* fetch values */
while ($result->fetch()) {
    printf("Max ID %i\n", $max);
}

$result->close(); 
```

# zlib - gzopen() 导致 ENOMEM 的原因

> ID：10966103
> 
> 赞同：0
> 
> 时间：2012-06-10T03:04:59.950
> 
> 标签：zlib, enomem

我有一个程序，其总内存占用约为 100 MiB（VM 大小，在顶部，而在 中停止`gdb`），它试图使用`gzopen`. 尽管系统有 6GB 内存完全空闲（甚至不包含缓存），并且文件系统上有大量空间（我知道，那将是 ），但`errno`设置为时失败。是否有更模糊的问题可能导致这种情况？库中的某些东西是否无缘无故地在千兆字节的内存上分配了千兆字节？`ENOMEM``ENOSPC`

请注意，我的 ulimit 设置为无限制。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T14:54:20.753

不，zlib 中没有任何东西可以分配超过一两个 MiB。zlib 只会将 errno 设置为零。就其本身而言，它永远不会将 errno 设置为 ENOMEM。它调用的库函数可能。你用的是什么版本的zlib？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T20:06:19.853

原来 zlib 没有返回`ENOMEM`。它之所以退出是因为我们向它传递了一个模式参数`w+`，这是无效的，因为它不能同时读取和写入给定的 gzip 文件。来自以前的库/系统调用`ENOMEM`发生的事情。`errno`

# python - Python包装器阻止函数调用？

> ID：10966104
> 
> 赞同：0
> 
> 时间：2012-06-10T03:05:00.050
> 
> 标签：python, sqlite, cursor, wrapper

我编写了一堆辅助函数来包装常用函数，例如插入和选择。下面包含的只是其中一个包装器......我似乎无法弄清楚它为什么不起作用。

我怀疑这与包装器有关：

```
from collections import Mapping
import sqlite3

def counter(func):
    def wrapper(*args, **kwargs):
        wrapper.count = wrapper.count + 1
    wrapper.count = 0
    return wrapper

@counter
def insert(val, cursor, table="reuters_word_list", logfile="queries.log"):
    if val:
        if isinstance(val, (basestring, Mapping)):
            val='\"'+val+'\"'
        query = ("insert into %s values (?);" % 'tablename', val)
        if logfile:
            to_logfile(query + '\n', logfile)
        cursor.execute(query)

if __name__ == '__main__':
    connection = sqlite3.connect('andthensome.db')
    cursor = connection.cursor()
    cursor.execute("create table wordlist (word text);")
    insert("foo", cursor)
    connection.commit()
    cursor.execute("select * from wordlist;")
    print cursor.fetchall()
    cursor.close() 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-10T03:06:13.407

你的柜台装饰师从不真正*调用*func。

尝试

```
def counter(func):
    def wrapper(*args, **kwargs):
        wrapper.count += 1
        return func(*args, **kwargs)       # <- this line is important!!
    wrapper.count = 0
    return wrapper 
```

# ruby-on-rails - Rails - 使用带有 pow 测试域的测试数据库

> ID：10966107
> 
> 赞同：2
> 
> 时间：2012-06-10T03:06:02.090
> 
> 标签：ruby-on-rails, rack-pow

我目前正在使用[Pow](http://pow.cx/manual.html)来管理我的 Rails 应用程序，并且 .dev 和 .test 都在运行。我想知道如何设置 .test 域以使用测试数据库而不是开发数据库。

基本上，我可以让 appname.dev 加载开发环境，而 appname.test 加载测试环境吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T02:28:31.027

您可能可以使用[此 Gist](https://gist.github.com/2914870)的变体来确定正在访问的域，并让 Rails 应用程序从那时起相应地运行。

您将在应用程序控制器上添加一个 before_filter，`session[:site]`根据它是开发环境还是测试环境进行设置（也可以选择通过标准 Rails 服务器`site=development`或`site=testing`从标准 Rails 服务器传递）。

以下是我认为上面链接的 Gist 的相关摘录：

```
session[:site] = case request.domain
  when "appname.dev" then "development"
  when "appname.test" then "testing"
  else ENV['site'] || "development"
end 
```

Rails 应用程序的其余部分将根据`session[:site]`. [我也在这里](http://www.commonmediainc.com/blog/how-serve-multi-site-rails-apps-and-use-pow-make-it-easy)写了更多关于多站点 Rails 应用程序的内容。

# r - 如何获取 R Markdown 文件，如`source('myfile.r')`？

> ID：10966109
> 
> 赞同：98
> 
> 时间：2012-06-10T03:06:23.537
> 
> 标签：r, markdown, knitr

我经常有一个主要的 R Markdown 文件或 knitr LaTeX 文件，其中我`source`有一些其他 R 文件（例如，用于数据处理）。但是，我认为在某些情况下，将这些源文件作为它们自己的可重现文档会是有益的（例如，一个 R Markdown 文件，它不仅包含用于数据处理的命令，而且还生成一个可重现的文档来解释数据处理决策）。

因此，我想`source('myfile.rmd')`在我的主 R Markdown 文件中有一个命令。这将提取和获取 .R 代码块中的所有 R 代码`myfile.rmd`。当然，这会产生错误。

以下命令有效：

```
```{r message=FALSE, results='hide'}
knit('myfile.rmd', tangle=TRUE)
source('myfile.R')
``` 
```

`results='hide'`如果需要输出，可以省略where 。即，knitr 从`myfile.rmd`into输出 R 代码`myfile.R`。

但是，它似乎并不完美：

*   它会导致创建一个额外的文件
*   如果需要控制显示，它需要出现在自己的代码块中。
*   它不像简单那么优雅`source(...)`。

因此我的问题是： **有没有更优雅的方式来获取 R Markdown 文件的 R 代码？**

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-06-10T15:44:45.243

看来您正在寻找单线。把这个放在你的 中`.Rprofile`怎么样？

```
ksource <- function(x, ...) {
  library(knitr)
  source(purl(x, output = tempfile()), ...)
} 
```

但是，我不明白你为什么要`source()`在 Rmd 文件本身的代码。我的意思是`knit()`将运行本文档中的所有代码，如果您提取代码并以块的形式运行它，那么当您编写本文档时，所有代码将运行两次`knit()`（您自己在内部运行）。这两个任务应该是分开的。

如果你真的想运行所有代码，RStudio 让这变得相当简单：`Ctrl + Shift + R`. 它基本上调用`purl()`和`source()`幕后。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-05-31T13:40:15.723

将通用代码分解到一个单独的 R 文件中，然后将该 R 文件源到您想要的每个 Rmd 文件中。

例如，假设我需要制作两份报告，流感爆发和枪支与黄油分析。自然我会创建两个 Rmd 文档并完成它。

现在假设老板出现并想查看流感爆发与黄油价格的变化（控制 9 毫米弹药）。

*   复制并粘贴代码以分析报告到新报告中对于代码重用等来说是一个坏主意。
*   我希望它看起来不错。

我的解决方案是将项目分解为这些文件：

*   流感
    *   流感数据导入.R
*   Guns_N_Butter.Rmd
    *   guns_data_import.R
    *   黄油数据导入.R

在每个 Rmd 文件中，我都会有类似的内容：

```
```{r include=FALSE}
source('flu_data_import.R')
``` 
```

这里的问题是我们失去了可重复性。我的解决方案是创建一个公共子文档以包含到每个 Rmd 文件中。因此，在我创建的每个 Rmd 文件的末尾，我添加了以下内容：

```
```{r autodoc, child='autodoc.Rmd', eval=TRUE}
``` 
```

当然，还有 autodoc.Rmd：

```
Source Data & Code
----------------------------
<div id="accordion-start"></div>

```{r sourcedata, echo=FALSE, results='asis', warnings=FALSE}

if(!exists(autodoc.skip.df)) {
  autodoc.skip.df <- list()
}

#Generate the following table:
for (i in ls(.GlobalEnv)) {
  if(!i %in% autodoc.skip.df) {
    itm <- tryCatch(get(i), error=function(e) NA )
    if(typeof(itm)=="list") {
      if(is.data.frame(itm)) {
        cat(sprintf("### %s\n", i))
        print(xtable(itm), type="html", include.rownames=FALSE, html.table.attributes=sprintf("class='exportable' id='%s'", i))
      }
    }
  }
}
```
### Source Code
```{r allsource, echo=FALSE, results='asis', warning=FALSE, cache=FALSE}
fns <- unique(c(compact(llply(.data=llply(.data=ls(all.names=TRUE), .fun=function(x) {a<-get(x); c(normalizePath(getSrcDirectory(a)),getSrcFilename(a))}), .fun=function(x) { if(length(x)>0) { x } } )), llply(names(sourced), function(x) c(normalizePath(dirname(x)), basename(x)))))

for (itm in fns) {
  cat(sprintf("#### %s\n", itm[2]))
  cat("\n```{r eval=FALSE}\n")
  cat(paste(tryCatch(readLines(file.path(itm[1], itm[2])), error=function(e) sprintf("Could not read source file named %s", file.path(itm[1], itm[2]))), sep="\n", collapse="\n"))
  cat("\n```\n")
}
```
<div id="accordion-stop"></div>
<script type="text/javascript">
```{r jqueryinclude, echo=FALSE, results='asis', warning=FALSE}
cat(readLines(url("http://code.jquery.com/jquery-1.9.1.min.js")), sep="\n")
```
</script>
<script type="text/javascript">
```{r tablesorterinclude, echo=FALSE, results='asis', warning=FALSE}
cat(readLines(url("http://tablesorter.com/__jquery.tablesorter.js")), sep="\n")
```
</script>
<script type="text/javascript">
```{r jqueryuiinclude, echo=FALSE, results='asis', warning=FALSE}
cat(readLines(url("http://code.jquery.com/ui/1.10.2/jquery-ui.min.js")), sep="\n")
```
</script>
<script type="text/javascript">
```{r table2csvinclude, echo=FALSE, results='asis', warning=FALSE}
cat(readLines(file.path(jspath, "table2csv.js")), sep="\n")
```
</script>
<script type="text/javascript">
  $(document).ready(function() {
  $('tr').has('th').wrap('<thead></thead>');
  $('table').each(function() { $('thead', this).prependTo(this); } );
  $('table').addClass('tablesorter');$('table').tablesorter();});
  //need to put this before the accordion stuff because the panels being hidden makes table2csv return null data
  $('table.exportable').each(function() {$(this).after('<a download="' + $(this).attr('id') + '.csv" href="data:application/csv;charset=utf-8,'+encodeURIComponent($(this).table2CSV({delivery:'value'}))+'">Download '+$(this).attr('id')+'</a>')});
  $('#accordion-start').nextUntil('#accordion-stop').wrapAll("<div id='accordion'></div>");
  $('#accordion > h3').each(function() { $(this).nextUntil('h3').wrapAll("<div>"); });
  $( '#accordion' ).accordion({ heightStyle: "content", collapsible: true, active: false });
</script> 
```

注意，这是为 Rmd -> html 工作流设计的。如果您使用乳胶或其他任何东西，这将是一个丑陋的混乱。此 Rmd 文档在全局环境中查找所有 source() 文件，并在文档末尾包含它们的源代码。它包括 jquery ui、tablesorter，并将文档设置为使用手风琴样式来显示/隐藏源文件。这是一项正在进行的工作，但请随时根据自己的用途进行调整。

不是单行，我知道。希望它至少能给你一些想法:)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2020-02-03T10:24:36.010

试试 knitr 的 purl 函数：

`source(knitr::purl("myfile.rmd", quiet=TRUE))`

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-04-29T07:07:30.363

也许一个人应该开始思考不同的事情。我的问题如下：在 .R 文件中的 .Rmd 块中编写您通常拥有的每个代码。而对于你用来编织的 Rmd 文档，即一个 html，你只剩下

```
```{R Chunkname, Chunkoptions}  
source(file.R)  
``` 
```

这样，您可能会创建一堆 .R 文件，并且您失去了使用 ctrl+alt+n（或 +c，但通常这不起作用）处理所有代码“一个接一个块”的优势。但是，我读了 Gandrud 先生关于可重复研究的书，并意识到，他绝对使用 knitr 和 .Rmd 文件来创建 html 文件。主要分析本身是一个 .R 文件。如果您开始在内部进行整个分析，我认为 .Rmd 文档会迅速变得太大。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-06-10T12:16:09.777

如果您只是在代码之后，我认为这些方面的东西应该可以工作：

1.  阅读markdown/R文件`readLines`
2.  用于查找代码块，例如`grep`搜索以开头的行`<<<`
3.  获取包含原始行的对象的子集以仅获取代码
4.  使用转储到临时文件`writeLines`
5.  将此文件源到您的 R 会话中

将其包装在一个函数中应该可以满足您的需求。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-10-19T20:40:46.670

以下黑客对我来说效果很好：

```
library(readr)
library(stringr)
source_rmd <- function(file_path) {
  stopifnot(is.character(file_path) && length(file_path) == 1)
  .tmpfile <- tempfile(fileext = ".R")
  .con <- file(.tmpfile) 
  on.exit(close(.con))
  full_rmd <- read_file(file_path)
  codes <- str_match_all(string = full_rmd, pattern = "```(?s)\\{r[^{}]*\\}\\s*\\n(.*?)```")
  stopifnot(length(codes) == 1 && ncol(codes[[1]]) == 2)
  codes <- paste(codes[[1]][, 2], collapse = "\n")
  writeLines(codes, .con)
  flush(.con)
  cat(sprintf("R code extracted to tempfile: %s\nSourcing tempfile...", .tmpfile))
  source(.tmpfile)
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2019-08-30T22:11:22.970

我使用以下自定义函数

```
source_rmd <- function(rmd_file){
  knitr::knit(rmd_file, output = tempfile())
}

source_rmd("munge_script.Rmd") 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-05-19T22:44:03.373

我建议将主要分析和计算代码保留在 .R 文件中，并根据需要在 .Rmd 文件中导入块。我已经解释了[这里](https://stackoverflow.com/a/37335085/2864184)的过程。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-06-08T19:38:21.087

sys.source("./your_script_file_name.R", envir = knitr::knit_global())

在调用 your_script_file_name.R 中包含的函数之前放置此命令。

如果您已经创建了项目，则在 your_script_file_name.R 之前添加“./”以显示文件的方向。

您可以查看此链接了解更多详情：[https ://bookdown.org/yihui/rmarkdown-cookbook/source-script.html](https://bookdown.org/yihui/rmarkdown-cookbook/source-script.html)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-06-12T14:55:46.380

我使用这个单线：

```
```{r optional_chunklabel_for_yourfile_rmd, child = 'yourfile.Rmd'}
``` 
```

请参阅： [我的 .Rmd 文件变得非常冗长。是否可以将它和 source() 拆分为主要 .Rmd 的较小部分？](https://stackoverflow.com/questions/56049459/my-rmd-file-becomes-very-lengthy-is-that-possible-split-it-and-source-its-s)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-02-26T16:57:42.823

这对我有用

```
source("myfile.r", echo = TRUE, keep.source = TRUE) 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-12-12T08:24:38.483

我想说没有一种更优雅的方式来获取 Rmarkdown 文件。Rmd 的精神是报告是可重复的，并且充其量是自包含的。但是，添加到 OP 的原始解决方案中，以下方法避免了在磁盘上永久创建中间文件。它还做出了一些额外的努力来确保块输出不会出现在渲染文档中：

```
knit_loc <- tempfile(fileext = ".R")
knitr::knit("myfile.rmd",
            output = knit_loc,
            quiet = TRUE,
            tangle = TRUE)
invisible(capture.output(source(knit_loc, verbose = FALSE))) 
```

我还要补充一点，如果子 Markdown 依赖项在您的 R 环境之外（例如，将文件写入磁盘、下载一些外部资源、与 Web api 交互等），那么`knit()`我会选择`rmarkdown::render()`：

```
rmarkdown::render("myfile.rmd") 
```

# opengl - OpenCL 不更新 OpenGL VBO

> ID：10966112
> 
> 赞同：1
> 
> 时间：2012-06-10T03:07:56.753
> 
> 标签：opengl, opencl

我正在向 OpenCL 编码迈出第一步。我有一个框架，我知道它至少可以从 CPU 中获取一个数组，在 OpenCL 中进行操作，然后读回该数组（给出正确答案）。我目前正在尝试通过添加在[此 OpenCL 示例](http://sa09.idav.ucdavis.edu/docs/SA09_GL_interop.pdf)中找到的位移网格来改进这一点（幻灯片 18-23；唯一显着的改进是我将 VBO 更改为 float3 而不是 float4）。

我已经按照前面那些幻灯片和[这个资源](http://www.dyn-lab.com/articles/cl-gl.html)中的内容设置了一个共享上下文。我用 CPU 输入数据测试了 VBO（所以我知道它绘制正确）。另外，我在 VBO 之前创建了上下文（[受此线程](http://devgurus.amd.com/thread/159011)的启发）。最后，我尝试将内核改造成以下[已编辑]：

```
__kernel void sine_wave(__global float3* pos, int width, int height, float time) {
    uint x = get_global_id(0); uint y = get_global_id(1);
    pos[y*width+x] = (float3)(1.0f,1.0f,1.0f);
} 
```

然而，无论我做什么，我都无法让 OpenCL 程序更新任何内容。没有错误，什么都没有，但 VBO 与输入数据保持一致。如果我不指定输入数据，则所有点都呈现在 (0,0,0)。我不知道是什么原因造成的。

想法？谢谢，
伊恩

PS #1：当前系统是 NVIDIA GTX 580M，在 Windows 7 x64 上，尽管编写的代码是为了便于移植。

PS #2：如果没有人有任何线索，我可以提供代码。. .

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T07:48:00.693

嗯，我想通了。经过数小时的搜索，我下载了 NVIDIA 的 GPU 计算工具包，这似乎是链接演示的来源。然后，我将他们的代码大大减少到以下约 220 行源代码（可能对你们未来的编码人员有所帮助）：

```
#pragma comment(lib,"Opengl32.lib")
#pragma comment(lib,"glu32.lib")
#pragma comment(lib,"OpenCL.lib")
#pragma comment(lib,"glew32.lib")
#pragma comment(lib,"glut32.lib")

// OpenGL Graphics Includes
#include <GL/glew.h>
#if defined (__APPLE__) || defined(MACOSX)
    #include <OpenGL/OpenGL.h>
    #include <GLUT/glut.h>
#else
    #include <GL/glut.h>
    #ifdef UNIX
        #include <GL/glx.h>
    #endif
#endif

#include <CL/opencl.h>

// Rendering window vars
const unsigned int window_width = 512;
const unsigned int window_height = 512;
const unsigned int mesh_width = 256;
const unsigned int mesh_height = 256;

// OpenCL vars
cl_context cxGPUContext;
cl_device_id* cdDevices;
cl_command_queue cqCommandQueue;
cl_kernel ckKernel;
cl_mem vbo_cl;
cl_program cpProgram;
size_t szGlobalWorkSize[] = {mesh_width, mesh_height};

// vbo variables
GLuint vbo;

int mouse_old_x, mouse_old_y;
int mouse_buttons = 0;
float rotate_x = 0.0, rotate_y = 0.0;
float translate_z = -3.0;
void mouse(int button, int state, int x, int y) {
    if (state == GLUT_DOWN) {
        mouse_buttons |= 1<<button;
    } else if (state == GLUT_UP) {
        mouse_buttons = 0;
    }

    mouse_old_x = x;
    mouse_old_y = y;
}
void motion(int x, int y) {
    float dx, dy;
    dx = (float)(x - mouse_old_x);
    dy = (float)(y - mouse_old_y);

    if (mouse_buttons & 1) {
        rotate_x += dy * 0.2f;
        rotate_y += dx * 0.2f;
    } else if (mouse_buttons & 4) {
        translate_z += dy * 0.01f;
    }

    mouse_old_x = x;
    mouse_old_y = y;
}

void DisplayGL(void) {
    static float anim = 0.0f;

    // run OpenCL kernel to generate vertex positions
    glFinish();
    clEnqueueAcquireGLObjects(cqCommandQueue, 1, &vbo_cl, 0,0,0);

    clSetKernelArg(ckKernel, 3, sizeof(float), &anim);
    clEnqueueNDRangeKernel(cqCommandQueue, ckKernel, 2, NULL, szGlobalWorkSize, NULL, 0,0,0 );

    clEnqueueReleaseGLObjects(cqCommandQueue, 1, &vbo_cl, 0,0,0);
    clFinish(cqCommandQueue);

    // set view matrix
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
    glLoadIdentity();
    glTranslatef(0.0, 0.0, translate_z);
    glRotatef(rotate_x, 1.0, 0.0, 0.0);
    glRotatef(rotate_y, 0.0, 1.0, 0.0);

    glBindBuffer(GL_ARRAY_BUFFER, vbo);
    glVertexPointer(4, GL_FLOAT, 0, 0);
    glEnableClientState(GL_VERTEX_ARRAY);
    glColor3f(1.0, 0.0, 0.0);
    glDrawArrays(GL_POINTS, 0, mesh_width * mesh_height);
    glDisableClientState(GL_VERTEX_ARRAY);

    // flip backbuffer to screen
    glutSwapBuffers();

    anim += 0.01f;
}

void timerEvent(int value) {
    glutPostRedisplay();
    glutTimerFunc(10, timerEvent,0);
}

int main(int argc, char** argv) {
    glutInit(&argc, argv);
    glutInitDisplayMode(GLUT_RGBA | GLUT_DOUBLE);
    glutInitWindowPosition (glutGet(GLUT_SCREEN_WIDTH)/2 - window_width/2,  glutGet(GLUT_SCREEN_HEIGHT)/2 - window_height/2);
    glutInitWindowSize(window_width, window_height);
    glutCreateWindow("OpenCL/GL Interop (VBO)");

    glutDisplayFunc(DisplayGL);
    glutMouseFunc(mouse);
    glutMotionFunc(motion);
    glutTimerFunc(10, timerEvent,0);

    glewInit();

    glClearColor(0.0, 0.0, 0.0, 1.0);
    glDisable(GL_DEPTH_TEST);

    glViewport(0, 0, window_width, window_height);
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    gluPerspective(60.0, (GLfloat)window_width / (GLfloat) window_height, 0.1, 10.0);
    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();

    //Get the NVIDIA platform
    cl_platform_id cpPlatform;
    clGetPlatformIDs(1,&cpPlatform,NULL);

    // Get the number of GPU devices available to the platform
    cl_uint uiDevCount;
    clGetDeviceIDs(cpPlatform, CL_DEVICE_TYPE_GPU, 0, NULL, &uiDevCount);

    // Create the device list
    cdDevices = new cl_device_id [uiDevCount];
    clGetDeviceIDs(cpPlatform, CL_DEVICE_TYPE_GPU, uiDevCount, cdDevices, NULL);
    // Define OS-specific context properties and create the OpenCL context
#if defined (__APPLE__)
    CGLContextObj kCGLContext = CGLGetCurrentContext();
    CGLShareGroupObj kCGLShareGroup = CGLGetShareGroup(kCGLContext);
    cl_context_properties props[] = 
    {
        CL_CONTEXT_PROPERTY_USE_CGL_SHAREGROUP_APPLE, (cl_context_properties)kCGLShareGroup, 
        0 
    };
    cxGPUContext = clCreateContext(props, 0,0, NULL, NULL, &ciErrNum);
#else
#ifdef UNIX
    cl_context_properties props[] = 
    {
        CL_GL_CONTEXT_KHR, (cl_context_properties)glXGetCurrentContext(), 
        CL_GLX_DISPLAY_KHR, (cl_context_properties)glXGetCurrentDisplay(), 
        CL_CONTEXT_PLATFORM, (cl_context_properties)cpPlatform, 
        0
    };
    cxGPUContext = clCreateContext(props, 1, &cdDevices[uiDeviceUsed], NULL, NULL, &ciErrNum);
#else // Win32
    cl_context_properties props[] = 
    {
        CL_GL_CONTEXT_KHR, (cl_context_properties)wglGetCurrentContext(), 
        CL_WGL_HDC_KHR, (cl_context_properties)wglGetCurrentDC(), 
        CL_CONTEXT_PLATFORM, (cl_context_properties)cpPlatform, 
        0
    };
    cxGPUContext = clCreateContext(props, 1, &cdDevices[0], NULL, NULL, NULL);
#endif
#endif

    // create a command-queue
    cqCommandQueue = clCreateCommandQueue(cxGPUContext, cdDevices[0], 0, NULL);

    const char* cSourceCL = "__kernel void sine_wave(__global float4* pos, unsigned int width, unsigned int height, float time)\n"
    "{\n"
    "   unsigned int x = get_global_id(0);\n"
    "   unsigned int y = get_global_id(1);\n"
    "\n"
    "   // calculate uv coordinates\n"
    "   float u = x / (float) width;\n"
    "   float v = y / (float) height;\n"
    "   u = u*2.0f - 1.0f;\n"
    "   v = v*2.0f - 1.0f;\n"
    "\n"
    "   // calculate simple sine wave pattern\n"
    "   float freq = 4.0f;\n"
    "   float w = sin(u*freq + time) * cos(v*freq + time) * 0.5f;\n"
    "\n"
    "   // write output vertex\n"
    "   pos[y*width+x] = (float4)(u, w, v, 1.0f);\n"
    "}\n";
    cpProgram = clCreateProgramWithSource(cxGPUContext, 1, (const char **) &cSourceCL, NULL, NULL);

    clBuildProgram(cpProgram, 0, NULL, "-cl-fast-relaxed-math", NULL, NULL);

    // create the kernel
    ckKernel = clCreateKernel(cpProgram, "sine_wave", NULL);

    // create VBO (if using standard GL or CL-GL interop), otherwise create Cl buffer
    unsigned int size = mesh_width * mesh_height * 4 * sizeof(float);

    glGenBuffers(1,&vbo);
    glBindBuffer(GL_ARRAY_BUFFER,vbo);
    // initialize buffer object
    glBufferData(GL_ARRAY_BUFFER, size, 0, GL_DYNAMIC_DRAW);

    // create OpenCL buffer from GL VBO
    vbo_cl = clCreateFromGLBuffer(cxGPUContext, CL_MEM_WRITE_ONLY, vbo, NULL);

    // set the args values 
    clSetKernelArg(ckKernel, 0, sizeof(cl_mem), (void *) &vbo_cl);
    clSetKernelArg(ckKernel, 1, sizeof(unsigned int), &mesh_width);
    clSetKernelArg(ckKernel, 2, sizeof(unsigned int), &mesh_height);

    glutMainLoop();
} 
```

在与我的原始代码比较之后，我（最终）发现了关键区别。

对：

```
clEnqueueNDRangeKernel(context->command_queue, kernel->kernel, 2, NULL, global,NULL, 0,0,0 ); 
```

错误的：

```
clEnqueueNDRangeKernel(context->command_queue, kernel->kernel, 2, NULL, global,local, 0,0,0 ); 
```

事实证明，我使用的网格大小为 10x10，比我在其他地方看到的示例要小，这告诉我使用 16x16 表示“本地”。因为“global”是网格大小，所以“global”*小于*“local”。

出于某种原因，这并没有导致任何错误，尽管在这一点上老实说我不能说我完全理解这些变量的目的。

伊恩

# android - 安装 Android SDK 2.3.3（避免 motodev 登录）

> ID：10966113
> 
> 赞同：0
> 
> 时间：2012-06-10T03:08:02.083
> 
> 标签：android, sdk, android-sdk-2.3

编辑：不得不修改整个问题

Android SDK 管理器。我检查了 2.3.3 (API 10) 下的所有内容，当我尝试安装它时，它只是通过并说“没有安装任何东西”。

就是这样，我根本无法安装 2.3。怎么了:(这就是日志所说的

找不到文件：程序文件/android/android sdk/samples-2.3.3_r01-linux.zip（访问被拒绝）

然后它跳过跳过完成的所有内容。什么都没有安装。

编辑*答案。我是个白痴。右键，以管理员身份运行。愤怒@win7

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T16:21:14.340

如果您没有安装任何摩托罗拉插件，则根本不应该获得 MOTODEV 登录。在 SDK 管理器中，执行“按存储库排序”并确保未选中摩托罗拉的所有插件。至少它是这样设计的。如果发生其他事情，请告诉我。我们在许多不同的配置上测试了该场景，尤其是 Win7，但可能存在配置错误。

此外，您可以进入“工具->管理附加站点”并删除您不想看到的任何非 Google 站点。

![在此处输入图像描述](../Images/00b7210cdfe75fa32565fed943174e31.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T03:10:46.237

你可以跳过它会正常工作。它问我同样的问题，我只是点击取消。

应该有一个选项要求您登录或取消。所以点击取消。

# scala - 如何从 PlayFramework 中截获的请求中将变量传递给 Action？

> ID：10966114
> 
> 赞同：6
> 
> 时间：2012-06-10T03:08:46.130
> 
> 标签：scala, playframework-2.0

我通过覆盖 GlobalSettings 的 onRouteRequest 方法来拦截对我的播放应用程序的所有请求。现在，我需要从这里将一些数据发送到发送的操作，这样我就不会在所有操作中执行所有这些计算。如何为传递给超级 onRouteRequest 方法的请求 (play.api.mvc.RequestHeader) 对象设置属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T12:51:55.137

为了您的需要，我不会使用`onRouteRequest`will 工作（至少优雅地）。

但是让我们尝试使用专用的结构进行拦截。

以下是您如何拦截请求、计算一些通用内容并将其传递给 Action

首先，这是一个`Interceptor`具有方法`intercept`和便捷方法的对象`username`：

```
object Interceptor {

  def intercept[A, B](f: RequestHeader => Option[B], e: RequestHeader => Result)(action: B => Action[A]): Action[(Action[A], A)] = {

    val bodyParser = BodyParser {
      request =>
        f(request) map {
          b =>
            val innerAction = action(b)
            innerAction.parser(request).mapDone {
              body => body.right.map(innerBody => (innerAction, innerBody))
            }
        } getOrElse {
          Done(Left(e(request)), Input.Empty)
        }
    }

    Action(bodyParser) {
      request =>
        val (innerAction, innerBody) = request.body
        innerAction(request.map(_ => innerBody))
    }
  }

  def username[A](check: RequestHeader => Option[String]): ((String) => Action[A]) => Action[(Action[A], A)] = intercept(check, r => Results.Unauthorized("not logged in"))

} 
```

如您所见，worker 函数`intercept`使您有机会根据请求内容计算一些东西。哪种类型的计算结果`B`可能会失败（`Option`），在这种情况下，有一个处理程序来告诉该做什么。

定义了要计算的内容后，您可以定义`action`使用接受 a`B`并给出. 的函数`Action[A]`。

该`username`方法只是一个简单的预定义拦截器，可以让我们定义如何检索登录的用户名，仅用于说明。

现在这是我们如何在您的`Controller`

```
 //index is defined for both GET and POST in routes, but fails on POST
  //  thanks to the interceptor that checks at first the used method
  //  the case mustn't be handled in the Action definition
  def index = Interceptor.intercept(
    /*check the method*/
    request => if (request.method == "GET") Some(request.method) else None,

    /*not a GET => bad request*/
    request => BadRequest(request.method + " not allowed")

  ) { /*the computation result*/method => Action {
      Ok("The method : " + method)
    }
  }

  //this controller retrieve the username in the session and renders it in a OK response
  def secured = Interceptor.username(r => r.session.get("username")) { username => Action {
      Ok("You're logged in as " + username)
    }
  }

  //this enables you to logged in => store in session
  def login(u:String) = Action { request => {
      Ok("Logged in as " + u) withSession(("username" -> u))
    }
  } 
```

现在，如果您有通用计算，则可以创建预配置的拦截器（这里我使用的是案例类，但只需定义一个部分应用的函数`interceptor`就足够了）

```
 case class Intercept[B] (f: RequestHeader => Option[B], e: RequestHeader => Result) {

    def apply[A](action: B => Action[A]) = Interceptor.intercept[A,B](f, e)(action)

  }

  val getInterceptor = Intercept[String](
    request => if (request.method == "GET") Some(request.method) else None,
    request => BadRequest(request.method + " not allowed")
  )

  def index2 = getInterceptor { method => Action {
      Ok("Da method : " + method)
    }
  } 
```

**与评论相关的编辑**：

根据您的评论，以下是使用拦截器的方法（请注意，我已经模拟了主机检索和检查）

使用`hosted`and `anotherHosted`，您将能够测试此工作流程：

*   /hosted/false?host=myhost => 404 因为起初 myhost 没有被缓存，我为检查的模型提供了 false
*   /hosted/true?host=myhost => 不在缓存中但它会添加它，然后没有 404
*   /hosted/anotherHosted/false?host=myhost => 在缓存中，因为它是托管的 => 没有 404
*   /hosted/anotherHosted/false?host=notMyhost => 404

这是代码

```
def getHost(request:RequestHeader) = request.queryString.get("host").get.head
def checkHost(host:String, b: Boolean) = b

val checkHosted = (b: Boolean) => Intercept[String](
  request => {
    val host = getHost(request)
    Cache.getAs[String](host) match {
      case x@Some(_) => x
      case None => if (checkHost(host, b)) {
        Cache.set(host, host)
        Some(host)
      } else None
    }

  },
  request => NotFound(getHost(request) + "not hosted")
)

def hosted(b:String) = checkHosted(b.toBoolean) {
  host => Action {
    Ok("this host is ok : " + host)
  }
}
def anotherHosted(b:String) = checkHosted(b.toBoolean) {
  host => Action {
    Ok("this host is ok : " + host)
  }
} 
```

# php - ffmpeg 最多只能压缩 32 kbps

> ID：10966115
> 
> 赞同：6
> 
> 时间：2012-06-10T03:09:49.027
> 
> 标签：php, ffmpeg

我创建了一个 PHP 代码，它在上传到 32kbps 比特率时压缩 mp3 我参考了这个线程

[如何从 PHP 压缩或转换为低质量的 Mp3 文件](https://stackoverflow.com/questions/4628221/how-to-compress-or-convert-to-low-quality-mp3-file-from-php)

使用此代码

```
exec("ffmpeg -i inputfile.mp3 -ab 24000 outputfile.mp3") 
```

但问题是我不能压缩超过 32kbps。我的代码指示压缩到 24kbps 但执行后，我可以看到输出文件是 32kbps。谁能告诉我该怎么做才能压缩超过32kbps。或者ffmpeg有什么限制吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-10T03:39:32.110

您无法达到低于 32kbps 的原因是因为采样率很可能仍然是 44100-Hz，这意味着更大的流大小，您有几个选项`44100-Hz, 22050-Hz, and 11025-Hz`作为有效频率。

尝试（质量非常低）：

`ffmpeg -i inputfile.mp3 -acodec libmp3lame -b:a 8k -ac 1 -ar 11025 outputfile.mp3`

-b:a = 音频比特率

-ar = 采样率

# c# - 时间：2019-04-10 标签：c#grabbinggoogle maps api address_components

> ID：10966116
> 
> 赞同：1
> 
> 时间：2012-06-10T03:09:52.607
> 
> 标签：c#, google-maps-api-3

我无法从谷歌地图的 api 结果中提取单个地址组件。

以下是从此 url 收到的结果：

> [http://maps.googleapis.com/maps/api/geocode/json?address=jobing.com+glendale+arizona&sensor=false](http://maps.googleapis.com/maps/api/geocode/json?address=jobing.com+glendale+arizona&sensor=false)

这个 url 在“uri”变量中。这是我用来尝试按类型检索 address_component 的代码。考虑到我对 c# 有点陌生。

```
String Output = client.DownloadString(uri);
Dictionary<String, Object> RinkData = JsonConvert.DeserializeObject<Dictionary<String, Object>>(Output);
Dictionary<String, Object> RinkDataResults = (Dictionary<String, Object>) RinkData["results"];
if (RinkDataResults.ContainsKey("formatted_address"))
{
  Route = GetAddressComponentByType(RinkDataResults["address_components"], "route");
} 
```

这是我正在使用的函数“GetAddressComponentByType”

```
protected String GetAddressComponentByType(Object AddressComponents, String AddressType)
{
  Boolean MatchFound = false;
  String MatchingLongName = "";
  Dictionary<String, Object> AddressComponentsDict = (Dictionary<String, Object>)AddressComponents;
  foreach (KeyValuePair<String, Object> ac in AddressComponentsDict)
  {
    Dictionary<String, Object> acDict = (Dictionary<String, Object>) ac.Value;
    ArrayList acTypes = (ArrayList) acDict["types"];
    foreach (String acType in acTypes)
    {
      if (acType == AddressType)
      {
        MatchFound = true;
        break;
      }
    }
    if (MatchFound)
    {
      MatchingLongName = (String) acDict["long_name"];
    }
  }
  return MatchingLongName;
} 
```

问题是，它甚至没有用到我的组件检索功能。它炸弹将 RinkData["results"] 转换为 Dictionary 说这是一个无效的转换。

有谁看到我做错了什么？或者也许有人有一个自定义对象，我可以将谷歌地图地理编码结果读入该作品？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T12:47:35.330

啊没关系。如果我从这个对象开始，我可以很容易地提取地址组件

```
 dynamic googleResults = new Uri(uri).GetDynamicJsonObject();
  foreach (var result in googleResults.results)
  {
    foreach (var addressComp in result.address_components)
    {
      Literal1.Text += "<br />" + addressComp.long_name;
    }
  } 
```

[它是此处](http://pastebin.com/6b2fLChA)找到的 JSON.NET 的扩展类。从LB对[这个问题](https://stackoverflow.com/questions/7942095/google-maps-v3-geocoding-server-side)的回答。

# google-apps-script - 如何使用应用程序脚本在谷歌网站中获取 url 查询参数

> ID：10966119
> 
> 赞同：0
> 
> 时间：2012-06-10T03:10:54.847
> 
> 标签：google-apps-script, google-sites

我需要一种使用 Apps 脚本在 Google 协作平台中获取 url 查询参数的方法。

我正在寻找类似于`$_GET`PHP 的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T10:36:00.880

该`doGet`函数有一个参数 - `e`。访问一个 url 参数 services `e.parameter.Param_Name`。这里有更多细节 -[链接](http://google-data-api.blogspot.de/2011/06/get-url-parameter-from-published-google.html)

# c - errno 什么时候应该分配给 ENOMEM？

> ID：10966121
> 
> 赞同：10
> 
> 时间：2012-06-10T03:11:48.983
> 
> 标签：c, linux, linux-kernel, malloc

以下程序在内存耗尽时被内核杀死。我想知道何时应将全局变量分配给“ENOMEM”。

```
#define MEGABYTE 1024*1024
#define TRUE 1
int main(int argc, char *argv[]){

    void *myblock = NULL;
    int count = 0;

    while(TRUE)
    {
            myblock = (void *) malloc(MEGABYTE);
            if (!myblock) break;
            memset(myblock,1, MEGABYTE);
            printf("Currently allocating %d MB\n",++count);
    }
    exit(0);
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-10T03:16:55.597

首先，修复你的内核不要过度使用：

```
echo "2" > /proc/sys/vm/overcommit_memory 
```

现在`malloc`应该行为正常。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-10T05:46:16.277

正如“R”所暗示的，问题在于 Linux 内存管理的默认行为，即“过度使用”。这意味着内核声称已成功分配内存，但直到稍后您尝试访问它时才真正分配内存。如果内核发现它分配了太多内存，它会使用“OOM（Out Of Memory）杀手”杀死一个进程以释放一些内存。它选择要杀死的进程的方式很复杂，但是如果您刚刚分配了系统中的大部分内存，那么可能会是您的进程获得子弹。

如果您认为这听起来很疯狂，那么有些人会同意您的看法。

为了让它像你期望的那样运行，正如 R 所说：

`echo "2" > /proc/sys/vm/overcommit_memory`

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-10T03:17:39.403

当您尝试*一次*分配太多内存时，就会发生这种情况。

```
#include <stdlib.h>
#include <stdio.h>
#include <errno.h>

int main(int argc, char *argv[])
{
  void *p;

  p = malloc(1024L * 1024 * 1024 * 1024);
  if(p == NULL)
  {
    printf("%d\n", errno);
    perror("malloc");
  }
} 
```

在您的情况下，OOM 杀手首先进入流程。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-10T03:19:13.307

我认为`errno`将设置为`ENOMEM`：

中定义的宏`stdio.h`。这是[文档](http://lxr.free-electrons.com/source/arch/powerpc/boot/stdio.h#L6)。

```
#define ENOMEM          12      /* Out of Memory */ 
```

在此语句中调用 malloc 后：

`myblock = (void *) malloc(MEGABYTE);`

并且函数返回`NULL`-因为系统内存不足-。

我发现[这个](https://stackoverflow.com/questions/8370264/malloc-returns-null-and-sets-errno-to-enomem-but-there-is-plenty-of-heap-space)SO 问题非常有趣。

希望能帮助到你！

# android - Gson fromJson 到不同的类

> ID：10966122
> 
> 赞同：0
> 
> 时间：2012-06-10T03:12:05.710
> 
> 标签：android, json, gson, pojo

我正在编写我的第一个 android 应用程序，并且在将 Json 数据解析回 POJO 方面的经验非常有限。我正在使用 GSON，它的方法来自 Json()。它在某种程度上起作用，但并非所有课程都已完成。

我正在序列化的课程是

```
public class User  extends Model
{
   public String id;
   public String name;
   public List<User> friends = new ArrayList<User>();
   public List<Match> matches = new ArrayList<Match>();
} 
```

是否可以将 User 解析为一个名为 User. 但是将用户列表放入另一个名称不同且参​​数少得多的类中

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T04:03:16.623

为 List 创建并注册一个类型适配器。创建它看起来像这样：

```
private final TypeAdapter<List<User>> listOfUsersTypeAdapter = new TypeAdapter<List<User>>() {
    @Override public void write(JsonWriter out, List<User> value) throws IOException {
        out.beginArray();
        for (User user : value) {
            out.value(user.id);
        }
        out.endArray();
    }
    @Override public List<User> read(JsonReader in) throws IOException {
        in.beginArray();
        List<User> result = new ArrayList<User>();
        while (in.hasNext()) {
            User user = new User();
            user.id = in.nextString();
        }
        in.endArray();
        return result;
    }
}.nullSafe(); 
```

并在创建`Gson`对象时注册它：

```
 Gson gson = new GsonBuilder()
        .registerTypeAdapter(new TypeToken<List<User>>() {}.getType(), listOfUsersTypeAdapter)
        .create(); 
```

I haven't tested this but it should work. Note that when you deserialize your users won't have any of their friends or matches fields filled in. You can reconstruct that from the graph in a post-processing step. Or use [GraphAdapterBuilder](https://code.google.com/p/google-gson/source/browse/trunk/extras/src/main/java/com/google/gson/graph/GraphAdapterBuilder.java) to do it automatically.

# php - PHP脚本是从上到下读取的吗？

> ID：10966125
> 
> 赞同：0
> 
> 时间：2012-06-10T03:13:43.023
> 
> 标签：php

PHP 脚本是从上到下读取的吗？像 HTML 一样？因为在这段代码中

```
<?php require_once("./includes/connection.php")?>
<?php require_once("./includes/functions.inc.php"); ?>
<?php 

    if(isset($_GET['subj']))
    {
        $sel_subj = get_subject_by_id($_GET['subj']);
        $sel_page = NULL;

    }else if(isset($_GET['page']))
    {
        $sel_subj = NULL;
        $sel_page = get_page_by_id($_GET['page']);
    }else
    {
        $sel_subj = NULL;
        $sel_page = NULL;
    }

?>
<?php include("includes/header.inc.php"); ?>
<table id="structure">
    <tr>
        <td id="navigation">
            <ul class = "subjects">
                <?php

                    $subject_set = get_all_subjects();

                    while($subject = mysql_fetch_array($subject_set))
                    {
                        echo "<li";
                        if($subject['id'] == $sel_subj['id']) {echo " class =\"selected\"";}
                        echo "><a href=\"content.php?subj=" . urlencode($subject["id"]) . 
                        "\">{$subject["menu_name"]}</a></li>";

                        echo "<ul class = 'pages'>";

                        $page_set = get_pages_for_subject($subject['id']);

                        while($page = mysql_fetch_array($page_set))
                        {
                            echo "<li"; 
                            if($page['id'] == $sel_page['id']){echo " class = \"selected\"";}
                            echo"><a href=\"content.php?page=" . urlencode($page["id"]) .
                            "\">{$page["menu_name"]}</a></li>";
                        }
                        echo "</ul>";
                    }
                ?>
                </ul>
        </td>
        <td id="page">
                <?php if(isset($sel_subj)){?>
                    <h2><?php echo "{$sel_subj['menu_name']}";?></h2>
                <?php } ?>  
                <?php if(isset($sel_page)){?>
                    <h2><?php echo "{$sel_page['menu_name']}"?> </h2>
                <?php }?>
        </td>
    </tr>
</table>
<?php require("includes/footer.inc.php"); ?> 
```

特别是这部分

```
if(isset($_GET['subj']))
        {
            $sel_subj = get_subject_by_id($_GET['subj']);
            $sel_page = NULL;

        }else if(isset($_GET['page']))
        {
            $sel_subj = NULL;
            $sel_page = get_page_by_id($_GET['page']);
        }else
        {
            $sel_subj = NULL;
            $sel_page = NULL;
        } 
```

如果这个 if-else 块位于页面顶部，如何调用它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T04:17:25.157

*每个页面视图*从上到下运行一次。在初始视图中，假设 URL 没有参数，则既不设置`$_GET['subj']`也不`$_GET['page']`设置。

如果单击指向同一页面的链接，则将重新处理整个 PHP 文件。如果该链接包含`subj`或`page`作为查询变量包含在 URL 中，则将`if`执行相应的块并相应地更改页面。

将 PHP 服务器视为动态创建一些发送到 Web 浏览器的 HTML 文件。一旦发送，服务器就完成了，PHP 代码“消失了”。运行更多 PHP 代码的唯一方法是请求一个新页面，该过程从该页面重新开始。

（即使 AJAX 也遵循相同的原则，尽管通常您处理的是部分数据请求而不是完整页面视图。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-10T03:19:02.830

是的，脚本从上到下运行。我不明白你为什么认为 if-else 块有什么不同？在执行和输出页面的其余部分之前，运行这些 if 子句以设置`$sel_subj`and变量。`$sel_page`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-10T03:19:45.070

PHP 脚本从上到下执行。你的问题到底是什么？

# android - Android：以指定的显示分辨率在屏幕外渲染 WebView

> ID：10966126
> 
> 赞同：2
> 
> 时间：2012-06-10T03:14:01.843
> 
> 标签：android, webview, webkit, rendering

有没有办法以指定的显示分辨率将 WebView 客户端呈现到屏幕外缓冲区？

我确实找到了一些代码来捕获 WebView 客户端并将其放置在位图中，但我不想将输出转换为位图，我只想将 WebView 渲染覆盖定向到内存中的不同位置并指定显示尺寸。

本质上，我想为 WebView 指定一个屏幕外帧缓冲区来写入。

谢谢。

# objective-c - 使用 NSString drawAtPoint 时，平滑看起来与系统不同：

> ID：10966127
> 
> 赞同：4
> 
> 时间：2012-06-10T03:14:21.250
> 
> 标签：objective-c, cocoa, fonts, drawing, smoothing

`NSString`我有一个自定义状态项视图，我在其中使用's绘制字符串`drawAtPoint:withAttributes:`。当与具有相同文本的系统时钟进行比较时，我的文本似乎缺少亚像素平滑并且看起来有点颗粒感。我找到了将绘图点从 (x,y) 转移到 (x+0.5,y+0.5) 的建议，但它没有帮助。默认视图并`setTitle:`产生相同的结果。

这就是它的外观：

![在此处输入图像描述](../Images/1b99ee97d15081c938a6df2b12029fae.png)

似乎系统时钟下面有一些浅灰色边框，但我无法通过第二次用浅灰色绘制字符串来模仿它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T04:29:57.120

我在系统的渲染中或我机器上的任何菜单标题中都没有看到任何“字体平滑”。如果打开它，您会在字符边缘看到红色和蓝色的着色像素，而不仅仅是灰色。放大后差异非常明显。

您可能想尝试打开或关闭子像素定位和量化，使用 [`CGContextSetShouldSubpixelPositionFonts`](https://developer.apple.com/library/mac/documentation/graphicsimaging/reference/CGContext/Reference/reference.html#//apple_ref/c/func/CGContextSetShouldSubpixelPositionFonts),[`CGContextSetShouldSubpixelQuantizeFonts`](https://developer.apple.com/library/mac/documentation/graphicsimaging/reference/CGContext/Reference/reference.html#//apple_ref/c/func/CGContextSetShouldSubpixelQuantizeFonts)等。

否则，主要区别确实是系统渲染中的微弱白色阴影。尝试[将上下文的阴影设置](https://developer.apple.com/library/mac/documentation/graphicsimaging/reference/CGContext/Reference/reference.html#//apple_ref/c/func/CGContextSetShadowWithColor)为 {0,1} 的偏移量（或者如果您的上下文被翻转，则可能是 {0,-1}？），模糊 0 或 1，以及 100% 白色和 30% alpha 的颜色——看起来很接近我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-20T14:07:51.663

尝试：

```
CGContextRef  ctx = [NSGraphicsContext currentContext].graphicsPort;
CGContextSetShouldSmoothFonts(ctx, true); 
```

我也找了很久。从 WWDC 视频中得到它（我认为这是“可可动画的最佳实践”）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-14T10:17:18.330

I guess you use

```
 UIGraphicsBeginImageContext(<#CGSize size#>); 
```

for context initialization. On retina displays it leads to blured renderings of fonts. Use

```
 UIGraphicsBeginImageContextWithOptions(myFrameSize, NO, 0.0f); 
```

instead to fix it.

Also, it seems if you use a Layer, set yourself as the layer delegate and do your drawing in:

```
- (void)drawLayer:(CALayer *)layer inContext:(CGContextRef)ctx
{
    NSGraphicsContext *nsGraphicsContext;
    nsGraphicsContext = [NSGraphicsContext graphicsContextWithGraphicsPort:ctx
                                                                   flipped:NO];
    [NSGraphicsContext saveGraphicsState];
    [NSGraphicsContext setCurrentContext:nsGraphicsContext];

    // drawing here...

    [NSGraphicsContext restoreGraphicsState];
} 
```

It will also work.

# php - JSON没有显示响应

> ID：10966130
> 
> 赞同：1
> 
> 时间：2012-06-10T03:16:25.233
> 
> 标签：php, json

以下代码对我不起作用。

```
<?php
$json_string =    file_get_contents("http://api.wunderground.com/api/7ec5f6510a4656df/geolookup/forecast/q/40121    .json");
$parsed_json = json_decode($json_string);
$temp = $parsed_json->{'forecast'}->{'date'};
echo "Current date is ${temp}\n";

?> 
```

当我这样说时它会起作用：

```
$temp = $parsed_json->{'location'}->{'city'}; 
```

我在这里想念什么哈哈

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T03:22:24.677

它应该是：

```
$temp = $parsed_json->{'forecast'}->{'txt_forecast'}->{'date'}; 
```

如需查看 JSON 对象的更好方法，请查看[此站点](http://jsonviewer.stack.hu/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T03:18:29.813

~~看起来你的 URL 中有多余的空格`40121 .json"`~~实际上最后的空格似乎被忽略了

[带空格](http://api.wunderground.com/api/7ec5f6510a4656df/geolookup/forecast/q/40121%20%20%20%20.json)

[没有空间](http://api.wunderground.com/api/7ec5f6510a4656df/geolookup/forecast/q/4012.json)

# android - 完成 Twitter 的 OAUTH 后，如何返回子活动？

> ID：10966132
> 
> 赞同：0
> 
> 时间：2012-06-10T03:16:35.377
> 
> 标签：android, twitter-oauth

对于我的应用程序，有一个选项卡主机，其中 5 个选项卡有 5 个不同的活动。其中一个实际上是一个活动组，其中包含 4 个子活动，用户可以为这些子活动来回切换。

现在其中一项子活动用于发布推文。OAUTH 的东西很好。但是我发现回调实际上不能指向活动，而是指向父活动组甚至选项卡活动。我不确定它指向哪里，但结果是当用户授权我的 twitter 应用程序并返回到 android 应用程序时，活动将重新启动并调用 onCreate 而不是 onResume 或 onNewIntent。这会导致无限循环，要求用户一次又一次地进行身份验证。我试图添加 android:launch:singleInstance 但这没有帮助。

如果我不是作为一个孩子开始活动而是一个新活动，一切都很好。我可以回到 onNewIntent 并成功发布推文。所以我很确定原因是活动组或选项卡活动。

我实际上不是很熟悉意图过滤器在选项卡/活动组下的工作原理，谁能为我解释一下这个案例？

清单.xml

```
<activity android:name="TwitterAct" android:launchMode="singleInstance">
        <intent-filter>
            <action android:name="android.intent.action.VIEW" />
            <category android:name="android.intent.category.DEFAULT" />
            <category android:name="android.intent.category.BROWSABLE" />
            <data android:scheme="myapp" android:host="twitteract" />       
        </intent-filter>
</activity> 
```

推特法案

```
private final String CALLBACKURL = "myapp://twitteract"; 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-20T00:49:05.630

这对我有用：在您控制的 WebView 中呈现 oauth 网页，而不是启动到浏览器应用程序。

oauth 网页在调用其回调时实际上将在 webview 中替换自身，您的 WebViewClient 可以在其中捕获预期的 URL、处理结果并完成（） webview（将其从活动堆栈中删除）。

换句话说，您的清单条目可以消失。您的回调可以是任何 URL，只要您在创建的 WebViewClient 中识别它即可。

# for-loop - :while 和 :when 在 clojure 中有什么区别？

> ID：10966142
> 
> 赞同：16
> 
> 时间：2012-06-10T03:19:16.893
> 
> 标签：for-loop, clojure

我正在研究clojure，但不太清楚`:while`和`:when`测试之间的区别：

```
=> (for [x [1 2 3] y [1 2 3] :while (= (mod x y) 0)] [x y])
([1 1] [2 1] [2 2] [3 1])
=> (for [x [1 2 3] y [1 2 3] :when (= (mod x y) 0)] [x y])
([1 1] [2 1] [2 2] [3 1] [3 3]) 
```

任何人都可以通过详细说明来提供帮助吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-06-10T05:32:34.770

`:when`迭代绑定，但仅在条件为真时评估循环体。`:while`迭代绑定并评估主体*，直到*条件为假：

```
(for [x (range 20) :when (not= x 10)] x)
; =>(0 1 2 3 4 5 6 7 8 9 11 12 13 14 15 16 17 18 19)

(for [x (range 20) :while (not= x 10)] x)
; => (0 1 2 3 4 5 6 7 8 9) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-10T05:05:50.377

:when 防止任何内部 'for' 绑定或其主体表达式针对该一次迭代进行评估，就像 'filter' 函数一样。

:while 停止此绑定继续进行，更像是 'take-while'

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-10T05:13:28.107

看看这里的最后一个例子：http: [//clojuredocs.org/clojure_core/clojure.core/for#example_913](http://clojuredocs.org/clojure_core/clojure.core/for#example_913)

# javascript - 通过 node.js 在 HTML 中使用非内联 javascript

> ID：10966145
> 
> 赞同：2
> 
> 时间：2012-06-10T03:19:40.587
> 
> 标签：javascript, node.js

我对 node.js 很陌生，所以如果这是一个糟糕的问题，我深表歉意。我在这里有一个简单的 HTTP 服务器：

```
var http = require('http');

http.createServer(function (request, response){

    response.writeHead(200, {"Content-Type":"text/html"});
//  response.write("<html><head><script type = 'text/javascript'>alert('hello');</script></head></html>");
    response.write("<html><head><script type = 'text/javascript' src = 'alerter.js'></script></head></html>");
    response.end();
}).listen(8000);

console.log("Server has started."); 
```

alerter.js 包含一行：

```
alert("hello"); 
```

为什么使用注释掉的行会正确地引起警报，但调用 alerter.js 什么也没做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-10T03:54:29.867

正如 Paul 和 Timothy 所指出的，您的问题是，当浏览器使用外部引用获取您的 html 时，它会返回服务器并要求它提供 alerter.js，并期望将脚本交付给它。但是，无论请求要求什么，您的服务器总是发送相同的内容，因此浏览器永远不会获取脚本。

您至少需要将服务器更改为处理对 alerter.js 的请求。实际上，我会使用 Connect 的静态文件处理程序来执行此操作；将脚本、样式表和图像等所有资产放在一个目录（通常称为“公共”）中，并告诉静态处理程序从那里为它们提供服务。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-10T03:26:03.770

您缺少一个 ' 来结束 type 属性。

# node.js - 为什么我不能在 node.js 中要求 express

> ID：10966156
> 
> 赞同：0
> 
> 时间：2012-06-10T03:23:02.353
> 
> 标签：node.js, express

我试图让最简单的 node.js 脚本工作。这是javascript文件：

**服务器.js**

```
require("express"); 
```

我使用常规节点命令启动脚本：

```
$ node server.js 
```

但我收到一个错误：

```
node.js:201
        throw e; // process.nextTick error, or 'error' event on first tick
              ^
Error: require.paths is removed. Use node_modules folders, or the NODE_PATH environment variable instead.
    at Function.<anonymous> (module.js:378:11)
    at Object.<anonymous> (/home/shawn/.node_libraries/express@2.5.9/index.js:4:21)
    at Module._compile (module.js:441:26)
    at Object..js (module.js:459:10)
    at Module.load (module.js:348:32)
    at Function._load (module.js:308:12)
    at Module.require (module.js:354:17)
    at require (module.js:370:17)
    at Object.<anonymous> (/home/shawn/Documents/Projets/passingData/server.js:3:15)
    at Module._compile (module.js:441:26) 
```

这是怎么回事？

**更新**

有趣的是，使用`npm install express`输出类似的结果：

```
node.js:201
        throw e; // process.nextTick error, or 'error' event on first tick
              ^
Error: require.paths is removed. Use node_modules folders, or the NODE_PATH environment variable instead.
    at Function.<anonymous> (module.js:378:11)
    at Object.<anonymous> (/home/shawn/.node_libraries/mkdirp@0.3.0/index.js:4:21)
    at Module._compile (module.js:441:26)
    at Object..js (module.js:459:10)
    at Module.load (module.js:348:32)
    at Function._load (module.js:308:12)
    at Module.require (module.js:354:17)
    at require (module.js:370:17)
    at Object.<anonymous> (/usr/lib/nodejs/fstream/lib/dir-reader.js:11:13)
    at Module._compile (module.js:441:26) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T21:14:10.140

您需要像这样全局安装它（如果您不将其构建为包）

```
npm install express -g 
```

或者如果你有它，`package.json`你必须进行本地安装`npm install -l`，它会正常工作。

# jquery - 使用 jQuery 自动完成返回多个值

> ID：10966160
> 
> 赞同：2
> 
> 时间：2012-06-10T03:24:36.243
> 
> 标签：jquery, jquery-ui, api, autocomplete, spotify

我正在尝试使用 jQuery 自动完成小部件从 spotify api 返回轨道“href”值。这是我的代码：

```
 $(function() {
    $("#spotify_song_search").autocomplete({
        source: function(request, response) {
            $.get("http://ws.spotify.com/search/1/track.json", {
                q: request.term
            }, function(data) {
                response($.map(data.tracks, function(el, ui) {
                    return el.name;
                }));
            });
        },
        select: function(el, ui) {
            alert(ui.item.href);
        }
    });
});​ 
```

响应网址：[http ://ws.spotify.com/search/1/track.json?q=time](http://ws.spotify.com/search/1/track.json?q=time)

在当前状态下，它会发出警报`[object Object]`。我需要做什么才能返回 href 值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T03:57:19.113

这个怎么样：http: [//jsfiddle.net/MMPTC/](http://jsfiddle.net/MMPTC/)

```
 $(function() {
    $("#spotify_song_search").autocomplete({
        source: function(request, response) {
            $.get("http://ws.spotify.com/search/1/track.json", {
                q: request.term
            }, function(data) {
                response($.map(data.tracks, function(item) {
                    return {label: item.name, track: item};
                }));
            });
        },
        select: function(el, ui) {
                console.log(ui);
            $("#track").attr("href",ui.item.track.href).text("Listen");
        }
    });
});​

<input type="text" id="spotify_song_search">
<a id='track'></a>​ 
```

PS 这么多代码实际上让我可以搜索曲目并实际播放它们，这让我大吃一惊。互联网是......真棒。:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-10T04:00:28.010

这是我使用的一个示例，我在调用时返回了一些值以在页面的其他位置使用

```
$("#SearchField").autocomplete({
    source: function (request, response) {
        var term = request.term;
        if (term in entityCache) {
            response(entityCache[term]);
            return;
        }
        if (entitiesXhr != null) {
            entitiesXhr.abort();
        }
        $.ajax({
            url: actionUrl,
            data: request,
            type: "GET",
            contentType: "application/json; charset=utf-8",
            timeout: 10000,
            dataType: "json",
            success: function (data) {
                response($.map(data, function (item) {
                    return { label: item.SchoolName, value: item.EntityName, id: item.EntityID, code: item.EntityCode };
                }));
            }
        });
    },
    minLength: 3,
    select: function (event, result) {
        $("#EntityID").val(result.item.id);
        $("#Code").val(result.item.code);
    }
}); 
```

它也有一个缓存机制:-)

# backbone.js - Backbone.js：填充事件时间线

> ID：10966164
> 
> 赞同：0
> 
> 时间：2012-06-10T03:26:06.953
> 
> 标签：backbone.js

为了更好地了解使用 Backbone 的组织，我正在尝试创建一个时间线，类似于 Heroku 的状态页面 ( [https://status.heroku.com](https://status.heroku.com) )，当然还有 Facebook。简而言之，时间线仅由包含各自事件的日期组成。我可能离这里很远，但这是我采取的方法：

路由器呈现`days`包含子视图的索引视图`day`。`day`你猜对了，每个人都`event`包含那天发生的观点。注意：我认为不需要`day`模型支持视图，只有`event`视图，因为事件显然存储在数据库中。

假设这种方法是可以接受的（？），这就是我不清楚的地方：我从哪里实例化（和渲染）`event`视图？视图是否应该`day`获取它们各自的`event`视图？如果不是（并且我假设“不是”），我如何确保`day`在获取和分发事件之前已呈现所有视图？此外，是否应该有一个`events`索引视图来获取和分发事件？

任何有关此主题的相关文档或博客文章将不胜感激:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T03:51:25.033

感觉就像您已经回答了自己的问题 - 正如您所说，每个单独`day`的视图都包含`event`当天的视图。

因此，您的`day`视图将实例化`event`视图并管理它们。您可能需要重新考虑一下您的模型 - 每天包含事件数据可能更有意义 - 这将简化事情。换句话说，在实例化 a 时`day`，您将 a 传递`DayModel`给它。里面`DayModel`是一个事件数组，并且为每个事件实例化一个`event`视图，并将其传递`EventModel`给它。

当然，这都是基于您上面给出的简单描述的推测。根据您希望如何在视觉上呈现所有内容，您可能会发现事件需要存在于 Days 之外。

请记住，Backbone.js 是一个非常“开放”的框架 - 没有一种或正确的方法可以做某事 - 所以做最适合您项目的特定需求的方法。

# c++ - 为什么这段代码会起作用？

> ID：10966166
> 
> 赞同：0
> 
> 时间：2012-06-10T03:27:12.287
> 
> 标签：c++, variadic-functions

几天前我开始编写这段代码。我在这里看到一个问题，让我想知道变量参数列表，所以我写了（从未真正完成，但它具有我很好奇的功能）这段代码：

```
void VendingMachine::setStamps(int largest, ...)
{
   cout << "Setting stamps to: \n";
   vector<int> tmp;
   vector<int>::iterator iter;
   int next = largest;
   va_list lst;
   va_start(lst, largest);
   while(next != NULL)
   {
      cout << next << "\n";
      tmp.push_back(next);
      next = va_arg(lst,int);
   }
   va_end(lst);

   stamps = new int[tmp.size()-1];

   int i = 0;
   for(iter = tmp.begin(); iter != tmp.end();)
   {
      stamps[i] = *iter;
      iter++;
      i++;
   }

   cout << "The array is now: ";
   showStamps();
}

void VendingMachine::showStamps()
{
   cout << sizeof(stamps) << " " << sizeof(*stamps);
   for(int i = 0; i < NUM_OF(stamps); i++)
      cout << stamps[i] << ", ";
   cout << "\n";
} 
```

现在，我期望 setStamps 永远不会完成。或者至少需要很长的时间和可变的时间，因为列表的任何部分都不能保证为 NULL，除非它被提供。事实并非如此。我调用 setStamps`v.setStamps(90,30,24,15,12,10,5,3,2,1);`并打印出来：

> 将标记设置为：
> 90
> 30
> 24
> 15
> 12
> 10
> 5
> 3
> 2
> 1
> -217832717
> 数组现在是：4 490，

忽略最后一行，因为那是我试图弄清楚如何确定数组的长度，这是没有意义的。它在传递的参数之外的第一个值之后停止。它应该一直持续到出现 NULL 值，并且每次都不应该有一个在同一个地方。但结果总是一样的：90、30、24、15、12、10、5、3、2、1，[每次都会改变的数字]。从来没有任何额外的价值。这是一个谜。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T03:36:57.947

> 并且每次都不应该有一个在同一个地方

谁说每次都不会出现在同一个地方？行为是未定义的，因此每次都在同一个地方有一个 NULL 值是完全可能的。

# c++ - *(char**) 如何理解这个构造？

> ID：10966172
> 
> 赞同：2
> 
> 时间：2012-06-10T03:28:22.157
> 
> 标签：c++, c, pointers

最近，在我当前的项目中阅读前任的代码时，我遇到了以下问题：

在实现队列时，我的前任写了这样的代码：

```
while(uq->pHead)
{
    char *tmp = uq->pHead;
    uq->pHead = *(char **)tmp;
    //...
} 
```

uq->pHead 的定义如下：

```
typedef struct {
        char* pHead;
        //...
} Queue; 
```

好吧，我对 " `uq->pHead = *(char**)tmp`" 的用法感到很困惑，有人可以详细解释一下吗？

如果我们假设 *(uq->pHead) = 32(ie ' ') ，`*(char**)tmp`会将其转换为指针形式，但是......它怎么可能有意义？

非常感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-10T03:46:38.177

假设我们将您的队列实现为链表。我们可能有：

```
struct data_type;

struct node
{
    node *next;
    data_type item;
};

struct linked_list
{
    node *pHead;
    // ...
}; 
```

要清空链表，我们可以这样写：

```
linked_list *uq=...;
while (uq->pHead)
{
    // unlink the first node from the list
    node *tmp = uq->pHead;
    uq->pHead = tmp->next; 

    // do something with that node
    // ...

    // deallocate the node
    free(tmp);
} 
```

现在假设我们并不真正关心可维护的代码，或者是懒惰的。相反，我们可能只是想出任何指针都会做的事情，并将“节点”的结构保留在我们的脑海中，然后写：

```
linked_list *uq=...;
while (uq->pHead)
{
    // unlink the first node
    char *tmp = uq -> pHead;     // tmp points to the first 'node'
    uq -> pHead = *(char**)tmp;  // The first thing in a 'node' is a pointer to
                                 // the next node.

    // do something with 'tmp', the now unlinked node
    data_type *item=(data_type*) ( ((char**)tmp) + 1 ); // after the 'next' pointer
                                                        // is the real data.
    // ...

    // free up the node
    free(tmp);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-10T03:58:23.147

该`Queue`结构很可能是......一个队列。它的第一个元素似乎是指向队列的下一个或上一个项目的指针。听起来编码员对不得不使用他正在创建的类型 - 队列 - 在队列本身内部感到不舒服。

例如，一个解决方案是

```
 typedef struct Queue {
    struct Queue *pHead;
    //...
  } Queue; 
```

回到你的问题，

```
 char *tmp = uq->pHead; 
```

设置`tmp`为当前队列项（保存以备后用）

```
 uq->pHead = *(char **)tmp; 
```

将`uq->pHead`指针值设置为当前项目的 pHead。由于编码器没有正确声明 pHead （`char *`而不是`struct Queue *`），因此它将结构指针（`uq->pHead`== `tmp`）转换为`char **`然后`*(char **)`检索结构的第一个指针，即`pHead`.

使用我上面的声明，代码可能是

```
 while(uq->pHead)
  {
    Queue *tmp = uq->pHead;
    uq->pHead = tmp->pHead; // or uq->pHead = uq->pHead->pHead
    //... 
  } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-10T04:35:22.357

在这个队列中，pHead 是指向另一个 pHead 的指针。更恰当地说，它可以写成：

```
 void *pHead; 
```

tmp 也可以写成：

```
void *tmp;  
tmp = uq->pHead; 
```

将当前 pHead 指针保存到 tmp 变量。
现在， tmp 被强制转换为`(void **)`tmp 被视为指向另一个指针。
`*(void **) tmp;`是 tmp 处的值，也被视为指针。

```
uq->pHead = *(void **) tmp; 
```

因此，这会将 pHead 增加到下一个元素。
这个语句也可以写成：

```
uq->pHead = uq->pHead->pHead; 
```

对不起，如果我让你感到困惑。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-10T06:19:41.827

假设你的 Queue 结构有一个名为 qa 的对象，qa 的第一个数据的地址与 qa 的相同。在 C++ 中，您可以通过多种方式调用数据，例如,".","->" 。但他们都真的像使用偏移量一样

```
`#include<cstdio>        
using namespace std;        
class A        
{        
public:        
    int a;        
    int b;        
};        
int main()        
{        
    A a;        
    printf("%p\n",&a);        
    printf("%p\n",& A::a);        
    printf("%p\n",& A::b);        
    printf("%p\n",&(a.a));        
    printf("%p\n",&(a.b));        
    return 0;        
}` 
```

你可以从这段代码中得到你想要的。

# extjs - Sencha中的“用facebook登录”代码！集成到应用程序中

> ID：10966174
> 
> 赞同：4
> 
> 时间：2012-06-10T03:29:41.597
> 
> 标签：extjs

我正在使用 Sencha 创建一个应用程序，我需要在其中集成 facebook 登录。当我点击“用 facebook 登录”按钮时，如果用户没有登录 facebook，它应该显示一个弹出窗口来输入 facebook 电子邮件 ID 和密码，否则如果用户已经登录它应该只是签名- 使用 facebook 身份验证。如何使用 sencha touch 实现这一点。请帮忙 。如果提供此功能的代码将很有帮助。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-26T10:37:48.110

首先，您必须使用 facebook 创建 JavaScript SDK 应用程序（[请点击此链接](https://developers.facebook.com/apps)）。创建应用程序后，您将拥有 APP ID。然后将以下代码添加到 app.js

```
Ext.application({
    name: 'FBLogin',
    launch: function() {
        Ext.create('Ext.container.Viewport', {
            items:[
                {
                    xtype: 'panel',
                    html: '<center><div id="fblogin" class="fb-login-button">Login with Facebook</div></center>'
                }
            ],
            listeners:{
                render: function(obj, eOpts){
                    window.fbAsyncInit = Ext.bind(this.onFacebookInit, this);
                    (function(d){
                        var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
                        if (d.getElementById(id)) {return;}
                        js = d.createElement('script'); js.id = id; js.async = true;
                        js.src = "//connect.facebook.net/en_US/all.js";
                        ref.parentNode.insertBefore(js, ref);
                    }(document));
                }
            },
            onFacebookInit: function(){
                console.log('onFacebookInit');
                var me = this;
                FB.init({
                    appId      : 'YOUR_APP_ID',
                    status     : true,
                    xfbml      : true
                });
                FB.Event.subscribe('auth.authResponseChange', Ext.bind(me.onFacebookAuthResponseChange, me));
            },
            onFacebookAuthResponseChange: function(response){
                this.down('panel').setVisible(false);
                alert("Success fully Logged in");
            }
        });
    }
}); 
```

创建 Facebook APP 时，在使用 facebook 登录的网站下会有一个名为“SiteURL:”的字段。这应该指向您的网络应用程序 URL。（例如：[http](http://example.com) ://example.com ）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-06-04T06:11:45.453

您可以尝试使用[Phonegap Facebook Connect Plugin](https://github.com/phonegap/phonegap-facebook-plugin) 0.4.0（稳定版）和使用[Phonegap Plugin Build](http://docs.build.phonegap.com/en_US/#googtrans%28en%29)为Android、Iphone、windows phone、blackbery 等构建包。

```
//on Device Ready
    FB.init({ appId: "appid", nativeInterface: CDV.FB, useCachedDialogs: false });
   // call for native app if there else give a popup for login
    FB.login(
                             function(response) {
                             if (response.session) {
                             alert('logged in');
                             } else {
                             alert('not logged in');
                             }
                             },
                             { scope: "email" }
                             ); 
```

为了与 sencha 集成，需要在 index.html 文件中添加三个脚本文件 cdv-plugin-fb-connect.js、phonegap.js 和 facebook-js-sdk.js 并将 config.xml 文件添加到项目构建中以用于 phone gap build 用于构建原生应用程序（不使用 sencha 原生打包）。对于 config.xml 文件配置，请参阅此[配置帮助](http://docs.build.phonegap.com/en_US/configuring_basics.md.html#The%20Basics) 如果有任何疑问，请参阅 [此处的](https://github.com/phonegap/phonegap-facebook-plugin/blob/master/example/Simple/index.html)github 示例 希望它有效

# collections - 从 groovy 中的嵌套列表中获取值

> ID：10966177
> 
> 赞同：6
> 
> 时间：2012-06-10T03:31:18.413
> 
> 标签：collections, groovy

我在 groovy 中有一个像这样的 3 级嵌套列表

```
rList = [[[12, name1],[22,name2],[49,name3]],[[33, name5],[22,name6],[21, name7]]] 
```

我如何迭代它以从第一个子列表中获取名称值，所以我想要`rsublist = [name1, name2, name3]`

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-10T03:46:16.627

```
rList = [[[12, 'name1'], [22, 'name2'], [49, 'name3']], [[33, 'name5'], [22, 'name6'], [21, 'name7']]]
names = rList[0]*.getAt(1)
assert names == ['name1', 'name2', 'name3'] 
```

首先，`rList[0]`为您提供第一个子列表，即`[[12, name1], [22, name2], [49, name3]]`. 然后，[展开运算符](http://groovy.codehaus.org/Operators#Operators-SpreadOperator), `*.`, 用于将相同的方法 , 应用于`getAt(1)`该列表的每个元素，这将返回一个包含子列表的每个第二个元素的列表，这些元素是您要查找的值 :)

`rList[0].collect { it[1] }`如果您不习惯扩展运算符，您也可以使用which 等价的并且可能更熟悉。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-10T15:48:37.163

根据[@epidemian 的回答](https://stackoverflow.com/a/10966219/462015)，这里有一个更易读的版本：

```
rList.first()*.last() 
```

# node.js - 节点模块 fbgraph：这能很好地处理大量用户吗？

> ID：10966178
> 
> 赞同：4
> 
> 时间：2012-06-10T03:31:47.373
> 
> 标签：node.js, facebook-graph-api

我希望将 facebook Graph API 集成到我的 NodeJS 服务器中。现在，[fbgraph 模块](https://github.com/criso/fbgraph)看起来是一个非常简单直接的解决方案，可以满足我的需求。我唯一关心的是 fbgraph 为 facebook 用户设置 accessTokens 的方式。根据api描述，accessToken设置如下：

```
graph.setAccessToken(access_token); 
```

我的一个担心如下：如果我的网站获得了很高的人气，并且我每秒有数百个对 facebook 图表的请求，我将不得不为我想要的每个用户设置（似乎是）全局变量与。。。相互作用。在处理前一个用户的 api 请求之前，图形 api 是否有可能为用户设置访问令牌？直觉上我觉得我应该在每个单独的 API 调用中使用一个包含访问令牌的模块，但也许这不是必需的......

任何人都可以澄清我的担忧是否有任何理由？

最好的，
萨米

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T04:07:25.400

这是一个有效的担忧，实际上已经[提出了一个问题](https://github.com/criso/fbgraph/issues/5)：

> **criso 评论**：
> 
> 哦！好点子。我认为这可能应该作为中间件添加，以便请求始终与会话相关联。不知道我什么时候能够实现这一点。如果你有时间，去疯吧！

然后

> **criso 评论**：
> 
> 实际上，而不是这样做：
> 
> ```
> graph.get("/me", req.session.access_token, function(err, data) {
>     console.log(data);
> }); 
> ```
> 
> 做就是了：
> 
> ```
> graph
>   .setAccessToken(req.session.access_token)
>   .get("/me", function(err, data) {
>       console.log(data);
>   }); 
> ```

# java - 你能用 Guava 复制 Clojure 的（分区）或 Scala 的sliding() 函数吗？

> ID：10966183
> 
> 赞同：7
> 
> 时间：2012-06-10T03:34:10.877
> 
> 标签：java, scala, clojure, guava

我有一个列表，我想以类似于`(partition sz step col)`Clojure 的方法或`IterableLike.sliding(size: Int, step: Int)`Scala 的函数的方式拆分它。具体来说，给定如下列表：

```
(1, 2, 3) 
```

我希望能够遍历子列表，例如：

```
(1, 2), (2, 3) 
```

在 Clojure 中，这将通过以下方式完成：

```
(partition 2 1 (1, 2, 3)) 
```

使用 Scala 将是：

```
val it = Vector(1, 2, 3).sliding(2) 
```

但是我没有这样的奢侈，我希望避免自己动手。Guava 有一种接近的分区方法，但不提供重叠。谷歌搜索也没有结果。这种方法是否存在，还是我必须自己动手？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T14:58:42.110

番石榴没有这个，但它`AbstractIterator`可能会使“滚动你自己的”更容易。

可能已经为其提交了[功能请求；](https://code.google.com/p/guava-libraries/issues/list)如果没有，请随意。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T21:18:35.843

Guava 目前没有这样的东西，但如果你提出[问题](http://code.google.com/p/guava-libraries/issues/list)，我们可以讨论添加它。

对于我自己，我会使用 an`ArrayDeque`来存储正在运行的窗口，但这对于库方法没有意义。

# java - 将 ObjectOutputStream 传递给另一个类

> ID：10966188
> 
> 赞同：0
> 
> 时间：2012-06-10T03:35:34.697
> 
> 标签：java, parameter-passing, objectoutputstream, objectinputstream

我正在开发一个在客户端/服务器系统中使用的 GUI 程序，它将数据保存在`Vector`. 我有一个`ObjectOutputStream`并且`ObjectInputStream`是在我建立连接时创建的，但是当我尝试打开一个时我不确定如何将它传递给新类。在我的`Startup`类中，我有一个`Serializable`对象 ( `Message m`)，它被创建并传递给不同的类以修改不同的字段，以及在客户端和服务器之间建立连接

在我的`Startup`课堂上，我有这个代码......

```
m.yourName = tmyName.getText();
m.department = tdepartment.getText();

if (m.yourName != null && m.department != null) {
    client = new Socket(server, port);
    oout = new ObjectOutputStream(client.getOutputStream());
    oin = new ObjectInputStream(client.getInputStream());
    toutput.setText("Connected");
    oout.writeObject(m);
    new WhatToDo (m, oout, oin);
} 
```

在`WhatToDo`课堂上我有这个代码......

```
Message m;
ObjectOutputStream oout;
ObjectInputStream oin;

public WhatToDo(Message a, ObjectOutputStream oout2, ObjectInputStream oin2){
    m = new Message();
    m = a;

    // this is what i'm unsure about and need help with
    oout = oout2; //but need to construct oout first
    oin = oin2; //but need to construct oin first
} 
```

如果我像在 中那样做新的`ObjectOutputStream`，我将创建一个到服务器的新连接。我希望使用在中创建的现有。提前谢谢你的帮助！`ObjectInputStream``Startup``Streams``Startup``WhatToDo`

我正在使用`ActionListener`带有按钮的按钮，因此需要将流保存在构造函数中以供以后在`ActionListener`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T04:19:24.037

> 我希望使用现有的 Streams

这正是您的代码现在所做的。您对“但需要构建”的评论是不正确的。

# c++ - 多组对象

> ID：10966191
> 
> 赞同：0
> 
> 时间：2012-06-10T03:36:05.070
> 
> 标签：c++, set, multiset

我有`multiset < Class1 > myset`；所以我创建了一个新对象：`Class1* c1 = new Class1();` 我期望能够`myset.insert(c1)`或`myset.insert(new Class1());`但它们都不起作用。

```
class Class1{
 int time;
public:
  CLass1(int t) : time(t) {}
  bool operator<(Class1 &c2) {return time < c2.time;}
} 
```

插入对象与插入整数有何不同？我能够插入整数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T03:49:04.500

在您的定义中，`myset`持有`Class1`对象，`c1`而是指向`Class1`对象的指针。这就是类型问题。

要么你`myset`用来保存指向对象的指针 - `multiset<Class1 *> myset`，要么将新创建的对象复制到`myset`-`myset.insert(*c1); delete c1;`中。请注意，容器要求对象必须是可复制和可分配的，并且应该通过实现可比较`operator<`。

# ruby-on-rails - rails rspec -（第二次测试）预期的响应是 <:redirect>，但是是 <200>

> ID：10966193
> 
> 赞同：1
> 
> 时间：2012-06-10T03:36:40.950
> 
> 标签：ruby-on-rails, ruby, testing, rspec, controller

预期响应为 <:redirect>，但为 <200>

我的测试有：

```
describe "Link POST #create" do

  context "with valid attributes" do
    it "creates a new link" do
      expect{
        post :create, link: FactoryGirl.create(:link, :group => @group)
      }.to change(Link,:count).by(1)
    end

    it "redirects to the new link" do
      post :create, link: FactoryGirl.create(:link, :group => @group)
      # response.should redirect_to @link # Link.unscoped.last
      response.should redirect_to Link.unscoped.last # render_template :show
    end
  end 
```

第一次测试通过但第二次失败。

我的代码是：

```
 def create
    @link = Link.new(params[:link])

    respond_to do |format|
      if @link.save
        flash[:notice] = 'Link was successfully created.'
        format.html { redirect_to(@link) }
        format.xml  { render :xml => @link, :status => :created, :location => @link }
      else
        @selected_group = params[:group_id]
        format.html { render :action => "new" }
        format.xml  { render :xml => @link.errors, :status => :unprocessable_entity }
      end
    end
  end 
```

我尝试过重定向和渲染，但无法通过第二次测试。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T04:02:57.387

这是应该使它起作用的东西：

```
describe "Link POST #create" do

  context "with valid attributes" do

    def do_post( format = 'html' )
      attributes = FactoryGirl.build(:link).attributes.merge( :group_id => @group.id )
      post :create, :link => attributes, :format => 'html'
    end

    it "creates a new link" do
      expect{
        do_post
      }.to change(Link,:count).by(1)
    end

    it "redirects to the new link" do
      do_post
      response.should redirect_to( assigns[:link] )
    end
  end 
```

第一个规范之所以有效，只是因为您正在调用**FactoryGirl.create**，因此从控制器中创建了一条记录，但很可能控制器调用不起作用。

# jquery - jQuery 在 iPad 和 IE 8 上可调整大小

> ID：10966201
> 
> 赞同：3
> 
> 时间：2012-06-10T03:41:42.413
> 
> 标签：jquery, ipad, internet-explorer-8, jquery-ui-resizable

我有一个 div，我已经成功地在除 IE 8 之外的所有浏览器和 iPad 上的任何浏览器中水平调整大小。任何人都知道是否有什么特别的方法可以让可调整大小的 div 在这些浏览器中工作？

我正在使用默认的 jqueryui css 主题并使用以下 jquery 代码设置 div resizble ...

```
$(".treeMenu").resizable({
     handles: 'e, w'

}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-05T23:41:30.573

您可以使用[jQuery Touch Punch](http://touchpunch.furf.com/)来支持 iPad。这是让 jQuery UI 处理 iPad 触摸事件的简单方法。

包含它后，您将`resizable`照常使用该事件。

# c# - 无法进入统一应用程序块配置的接口实现

> ID：10966203
> 
> 赞同：0
> 
> 时间：2012-06-10T03:41:58.520
> 
> 标签：c#, model-view-controller, dependency-injection, unity-container, enterprise-library

我已经用 EntLib 配置了一组接口实现。统一块。一运行应用程序，实现类的构造函数就可以正常工作：1.要实现的接口 ![实现接口](../Images/736f4226a7eae2e7443ad68788bc7e1b.png)

当我运行应用程序时，cctor 运行良好，这表明统一解析是成功的： ![统一解析成功](../Images/7445d9b9a086a5c5a9aff15e6051a43d.png)

但是当我尝试调用这个类的方法时，代码只是通过而没有实际调用实现类的函数： ![没有调用实现](../Images/842fcff66b5801df7ed411dcaf180507.png)

> > 编辑：2012 年 6 月 11 日添加以下是我拥有的 Unity 配置。（这是我正在做的所有统一配置）

```
 public class UnityControllerFactory : DefaultControllerFactory
{
    private static readonly IUnityContainer container;
    private static UnityControllerFactory factory = null;

    static UnityControllerFactory()
    {
        container = new UnityContainer();
        UnityConfigurationSection section = (UnityConfigurationSection)ConfigurationManager.GetSection("unity");
        section.Configure(container);
        factory = new UnityControllerFactory();
    }

    public static UnityControllerFactory GetControllerFactory()
    {
        return factory;
    }

    protected override IController GetControllerInstance(RequestContext requestContext, Type controllerType)
    {
        return container.Resolve(controllerType) as IController;
    }
} 
```

我无法进入此代码，并且实现只是跳过而不执行任何操作。这里有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T18:07:24.160

当调试器在断点处停止时，右键单击该行并选择“单步执行”，然后选择您要单步执行的方法。

这个类/方法是否在另一个程序集中（不是另一个项目）？可能没有加载这个类的源代码（或者调试符号没有正确刷新，如果是这种情况，重新启动 VS 可能会修复它。），所以调试器跳过它。该方法也可能用 装饰`DebuggerStepThroughAttribute`，这会导致调试器跳过它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-24T09:10:56.327

实际的问题在于一个 yield 语句，它在解析结果之前不会进入代码。

# c# - 用于传输批量数据的格式？

> ID：10966207
> 
> 赞同：0
> 
> 时间：2012-06-10T03:42:54.063
> 
> 标签：c#, flat-file

我计划要求我的 Web 应用程序的用户以以下格式提交批量数据。

```
BatchID:1
TotalRecords:200

Cust:CustID~FirstName~LastName~Age~Dob~City~State~Country
1~John~Abraham~35~10/10/1974~New York~NY~US

Order:OrderID~CustID~Qty~Amount~DOS
1~1~10~100.00~1/1/2012
2~1~100~1000.00~1/1/2012
1~1~10~100.00~1/1/2012

OrderDet:OrderDetID~OrderID~Reg1~Remarks
1~1~12393A~Testing order
2~1~23123B~tesitng order 1 
```

上面显示的只是一组记录。一个平面文件最多可包含 200 个文件。

你认为这是正确的做法吗？我们需要允许批量上传，这样用户就不需要从网站一次输入每条记录。

如果您能想到任何其他有很大帮助的格式

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T03:48:40.100

我强烈建议您将 XML 用于新项目。您的数据似乎有一些层次结构（例如，客户有订单）。这强烈支持使用 XML，因为您可以自然地反映这些关系。

如果由于某种原因您的用户不能这样做，CSV 仍然被广泛使用，并且有比 ~ 分隔文件更好的工具支持（例如，可以从 Excel 保存到 CSV）。

我可以根据经验告诉你，有一天某人的订单描述中会有一个 ~ 字符。我曾经在一家使用竖线 (|) 作为分隔符的公司工作。在有人想给他的公司命名之前工作得很好`Acme ||`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T03:51:45.680

具有已定义模式的 XML 将是一个不错的选择。

您的格式有几个问题：

*   如果备注中包含 ~ 会发生什么？例如。测试~测试备注。如何逃避这个？
*   您的应用程序的用户是否都在同一个语言环境中？他们都希望输入日期为月/日/年吗？还是日/月/年？这些是 UTC 日期吗？
*   您是否需要快速确定用户是否输入了“无效”数据（例如缺少必填字段？）

有众所周知的 XML 工具可以帮助验证用户上传的内容。值得考虑...

我不是 CSV 的忠实粉丝，但至少有众所周知的工具可以使用它。但是，我记得 CSV 格式存在一些差异。例如，如何转义逗号？是通过将字符串字段放在双引号中，例如。“我的第一，第二，第三”等。是通过使用`\,`吗？等等

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-10T04:21:04.220

我注意到没有人说 JSON。因此，如果实际 CSV 不适用，请使用 JSON。它比 XML 更整洁，也更短。而且，如果您希望您的用户理解您的自定义格式，那么他们肯定能够在没有 XML 模式友好的编辑器的情况下处理 JSON。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-10T03:53:47.940

一般来说：

*   如果发送方和接收方都使用相同的技术（例如，批量导入到 Microsoft SQL Server），则使用可提供最佳性能的任何特定于技术的格式。

*   如果您想要最大的灵活性，那么 XML 是您的最佳选择。创建一个匹配的 XSchema，并验证您的导出和导入，也不是一个坏主意。

*   否则，“无论如何”。CSV 是流行的最爱，前提是您的数据适合简单、同质的表格格式。

在所有条件相同的情况下，我可能会投票“XML”。

恕我直言.. PSM

# javascript - 排列图像缩略图

> ID：10966209
> 
> 赞同：0
> 
> 时间：2012-06-10T03:43:14.690
> 
> 标签：javascript, jquery, css, jquery-masonry, jquery-hover

我正在使用 JQuery 悬停缩放 (http://jmar.github.com/jquery-hoverZoom/) 它工作正常。

我拥有的缩略图大小不同。所以我说使用 masonry 插件来安排它。它们在隔离时都可以正常工作，但总体而言，砌体插件无法按预期工作。图片开始相互重叠。

我的感觉是 Masonry 和 JQuery hover zoom 都与导致问题的同一个 div 元素交互，两者都在添加它们的属性。

我怎样才能解决这个问题 ？

有没有什么方法可以让我在没有砖石的情况下排列行？这样冲突就不会发生了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T16:35:55.963

你能给我们看一下代码吗？这大概就是`z-index`错了。我的猜测会设置非常高（首先尝试 9999，然后根据您的需要证明它的合理性） （悬停时添加到元素`z-index`的类）的值。`.zoomed`

# java - dotnet 等效于 ObjectWeb 的 ASM 以访问 dot net *.dll 内容

> ID：10966210
> 
> 赞同：2
> 
> 时间：2012-06-10T03:43:43.383
> 
> 标签：java, .net

我只是想知道是否有一个等价物可以访问，更新点网程序集中的类文件......

# java - 外部库在 APK 中的什么位置？

> ID：10966211
> 
> 赞同：1
> 
> 时间：2012-06-10T03:44:13.760
> 
> 标签：java, android, jar, apk, dex

我想知道，在将外部 jar 添加到 android 项目时，它们实际上位于 APK 包中的哪个位置？我似乎找不到他们。

由于 Java 通常会根据需要在运行时加载类，所以让我感到奇怪的是它们似乎不在可分发文件中。

dex不一样吗？这些是静态构建吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T03:57:21.837

如果“外部库”是指“库项目”，则可以在[文档](http://developer.android.com/guide/developing/projects/index.html#LibraryProjects)中找到此问题的答案：

> 当您构建依赖于库项目的应用程序时，SDK 工具会将库编译为临时 JAR 文件并在主项目中使用，然后使用结果生成 .apk。

您所指的单独`.jar`的 s 不存在；`.apk`它们在编译时合并为一个。

# c - 为什么调用lseek后读取的文件总是返回0？

> ID：10966218
> 
> 赞同：1
> 
> 时间：2012-06-10T03:46:04.673
> 
> 标签：c, linux, ubuntu

我不明白为什么在 lseek 之后调用 read 会返回 0 读取的字节数。

```
//A function to find the next note for a given userID;
//returns -1 if at the end of file is reached;
//otherwise, it returns the length of the found note.
int find_user_note(int fd, int user_uid) {
    int note_uid = -1;
    unsigned char byte;
    int length;

    while(note_uid != user_uid) { // Loop until a note for user_uid is found.
        if(read(fd, &note_uid, 4) != 4) // Read the uid data.
            return -1; // If 4 bytes aren't read, return end of file code.
        if(read(fd, &byte, 1) != 1) // Read the newline separator.
            return -1;

        byte = length = 0;
        while(byte != '\n') { // Figure out how many bytes to the end of line.
            if(read(fd, &byte, 1) != 1) // Read a single byte.
                return -1; // If byte isn't read, return end of file code.

            //printf("%x ", byte);
            length++;
        }
    }
    long cur_position = lseek(fd, length * -1, SEEK_CUR ); // Rewind file reading by length bytes.

    printf("cur_position: %i\n", cur_position);

    // this is debug
    byte = 0;
    int num_byte = read(fd, &byte, 1);

    printf("[DEBUG] found a %d byte note for user id %d\n", length, note_uid);
    return length;
} 
```

当存在外部while循环时，可变长度值为34，并且上面的代码产生cur_position 5（因此lseek函数返回后肯定至少有34个字节），但是从函数读取返回的变量num_byte总是返回0，即使有还有更多字节要读取。

有谁知道 num_byte 总是返回 0 的原因？如果这是我的代码中的错误，我看不到它是什么。

仅供参考，上面的代码是在以下机器上运行的

```
$ uname -srvpio
Linux 3.2.0-24-generic #39-Ubuntu SMP Mon May 21 16:52:17 UTC 2012 x86_64 x86_64 GNU/Linux 
```

更新：

*   [我在这里](http://dl.dropbox.com/u/13414424/notesearch.c)上传完整的代码
*   这是我尝试阅读的文件内容

> ```
> $ sudo hexdump -C /var/notes
> 00000000  e8 03 00 00 0a 74 68 69  73 20 69 73 20 61 20 74  |.....this is a t|
> 00000010  65 73 74 20 6f 66 20 6d  75 6c 74 69 75 73 65 72  |est of multiuser|
> 00000020  20 6e 6f 74 65 73 0a                              | notes.|
> 00000027
> 
> $ 
> ```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-10T04:33:11.910

如果`length`是小于的无符号类型`off_t`（例如，`size_t`在 32 位机器上），那么`length*-1`将是一个巨大的值（可能在 4GB 左右）。这可能是问题所在。将结果存储`lseek`到 a `long`（同样，如果它是 32 位）将应用实现定义的转换，可能会截断，这会再次给您留下一个小值。

我看到您的机器是 64 位的，但也许您正在运行 32 位用户空间？

在任何情况下，为什么不运行你的程序`strace`来看看它在做什么系统调用呢？这几乎肯定会很快解决这个问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-18T01:23:46.377

终于找到问题了！！！我必须`#include <unistd.h>`输入才能使用正确的 lseek()。但是，我不确定为什么不包含`unistd.h`它是可编译的，尽管会导致意外行为。我认为如果不包括函数的原型，它甚至不应该是可编译的。

代码是由 Jon Erickson 在[Hacking: The Art of Exploitation 2nd Edition](https://rads.stackoverflow.com/amzn/click/com/1593271441)中编写的，我已经证实在书中没有`#include <unistd.h>`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-10T10:46:46.910

> 将初始可变长度设置为 34，上述代码将产生 cur_position 5（因此 lseek 函数返回后肯定至少有 34 个字节）

这不一定是这种情况，因为人们可以在文件末尾之外四处寻找而不会出现任何错误。

`lseek()`请参阅下面的手册页摘录：

> lseek() 函数允许将文件偏移量设置为超出文件末尾（但这不会改变文件的大小）。

因此，人们很可能会收到一个值 form `lseek()`ing，它仍然指向文件末尾之外。所以`read()`从这个位置 ing 仍然会返回 0 （因为它超出了文件结尾）。

* * *

我也同意 R..，在使用正确的类型（使用的方法使用的类型）时更加小心并不是一个坏主意。

* * *

**更新**：您还可以注意包含您调用的系统函数的所有标题。要检查这种情况，我**强烈**建议使用`gcc`s 选项`-Wall`来打开所有编译器警告，它们是免费的...... ;-)

# javascript - 更改 google Directions Service 的响应语言

> ID：10966221
> 
> 赞同：3
> 
> 时间：2012-06-10T03:46:50.010
> 
> 标签：javascript, google-maps-api-3

我正在使用此功能通过 google Directions Service 获取从起点到另一点的所有指令：

```
function calcRoute(mode,_originlat,_originlong,_destinationlat,_destinationlong,_waypoints,_sensor,_language) {
  var start = _originlat+','+_originlong;
  var end = _destinationlat+','+_destinationlong;
  var request = {
      origin: start,
      destination: end,
      waypoints: waypts,
      region:"us",//Region to change language
      optimizeWaypoints: true,
      travelMode: google.maps.TravelMode.DRIVING
  };
  directionsService.route(request, function(response, status) {
    if (status == google.maps.DirectionsStatus.OK) {
      //directionsDisplay.setDirections(response);
      var route = response.routes[0];
      var summaryPanel = document.getElementById("directions_panel");
      summaryPanel.innerHTML = "";
      // For each route, display summary information.
      for (var i = 0; i < route.legs.length; i++) {
        var routeSegment = i+1;
        summaryPanel.innerHTML += "<b>Leg: " + routeSegment + "</b> ";
        summaryPanel.innerHTML +=" "+ route.legs[i].start_address + " to ";
        summaryPanel.innerHTML += route.legs[i].end_address + "<br />";
        summaryPanel.innerHTML += route.legs[i].distance.text + "<br /><br />";
        for (var j = 0; j < route.legs[i].steps.length; j++) {
            var step=j+1;
            summaryPanel.innerHTML += "step"+step+":"+route.legs[i].steps[j].instructions  + "<br />";
        }
      }
    }
  });} 
```

但是标签区域不会对结果生效：

```
Leg: 1 255 Rue Nepean, Ottawa, ON K2P 2N2, Canada to Ontario 637, Killarney, ON P0M, Canada
558 km

step1:Prendre la direction nord-est sur Nepean St vers Bank St/Ottawa Road 31
step2:Prendre la 1re à droite et rester sur Bank St/Ottawa Road 31
step3:Prendre à droite sur Catherine St/Ottawa Road 60
step4:Tourner à gauche pour rejoindre ON-417 W
step5:Continuer sur Trans-Canada Hwy/ON-17 W
step6:Au rond-point, prendre la 3e sortie sur McConnell St/Trans-Canada Hwy/ON-17 E
Continuer de suivre Trans-Canada Hwy/ON-17 E

step7:Rester sur la file de droite et suivre ON-17 N/ON-11 N/Twin Lakes Road pour rejoindre Trans-Canada Hwy/ON-11 N/ON-17 W
Continuer de suivre Trans-Canada Hwy/ON-17 W

step8:Prendre à gauche sur ON-64 N (panneaux vers Lavigne/Noël Ville)
step9:Tourner à gauche pour rester sur ON-64 N
step10:Prendre à droite sur Trans-Canada Hwy/ON-69 N
step11:Prendre à gauche sur ON-637 W (panneaux vers Killarney)
Leg: 2 Ontario 637, Killarney, ON P0M, Canada to 2241-2295 Madison Ave, Grand Sudbury, ON P3A 2R2, Canada
110 km

step1:Prendre la direction est sur ON-637 E
step2:Prendre à gauche sur Trans-Canada Hwy/ON-69 N
step3:À gauche, rejoindre SW Bypass/Trans-Canada Hwy/ON-17 E en direction de North Bay
step4:Prendre à gauche sur Kingsway/Regional Road 55 (panneaux vers Sudbury)
step5:Prendre à droite sur Falconbridge Rd/Regional Road 86
step6:Prendre à gauche sur Old Falconbridge Rd
step7:Prendre à gauche sur Madison Ave
Votre destination se trouvera sur la gauche 
```

结果总是法语。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-21T21:41:47.973

`region`选项不设置语言。

正如[地图概念：本地化](https://developers.google.com/maps/documentation/javascript/basics#Localization)中所解释的那样：

*Google Maps API 在显示文本信息（例如控件名称、版权声明、行车路线和地图上的标签）时使用浏览器的首选语言设置。在大多数情况下，这是更可取的；您通常不希望覆盖用户的首选语言设置。但是，如果您希望更改 Maps API 以忽略浏览器的语言设置并强制它以特定语言显示信息，您可以在包含 Maps API JavaScript 代码时向标记添加可选语言参数，指定要使用的语言.*

例如，如果您想拥有法语中的所有信息，则必须设置：

```
<script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false&language=fr"></script> 
```

唯一的其他选项是更改浏览器的首选语言设置，如在[浏览器中设置语言首选项中所述](http://www.w3.org/International/questions/qa-lang-priorities.en.php)。要使更改可见，您必须在更改完成后重新加载页面。

法语首选语言设置中的类似示例：

```
step1:Prendre la direction sud sur Rue des Bleuets vers Allée des Épines 
step2:Tourner à droite pour rester sur Rue des Bleuets 
step3:Continuer sur Rue des Blés d'Or 
step4:Prendre à gauche sur Rue du Champ d'Avoine 
Votre destination se trouvera sur la gauche 
```

和英语首选语言设置：

```
step1:Head south on Rue des Bleuets toward Allée des Épines
step2:Turn right to stay on Rue des Bleuets
step3:Continue onto Rue des Blés d'Or
step4:Turn left onto Rue du Champ d'Avoine
Destination will be on the left 
```

# php - 为什么我的链接没有将 mysql 行值传递给 php 编辑表单？

> ID：10966222
> 
> 赞同：0
> 
> 时间：2012-06-10T03:47:04.437
> 
> 标签：php, mysql, forms, edit

我成功地在网页上显示来自我的数据库的信息行。我希望能够从表单中编辑该数据。出于某种原因，我的表单链接没有传递数据。

以下是显示数据的相关代码（包括 EDIT 链接）：

```
<table cellspacing="0" cellpadding="5" border="1" width="560">
<tr style="text-align:center">
<td style="text-align:left ; width:175px">Player Name</td>
<td>Team</td>
<td>Pass Yds</td>
<td>Pass TDs</td>
<td>Int Thrown</td>
<td>Rush Yds</td>
<td>Rush TDs</td>
<td></td>
</tr>
<?php
    $result = mysql_query("SELECT ID, Player, Team, Pass_Yds, Pass_TDs, Int_Thrown, Rush_Yds, Rush_TDs, Total_Fantasy_Pts FROM ff_projections WHERE Position = 'QB' ORDER BY ID;");

    while($row = mysql_fetch_array($result))
    {
    ?>

    <tr style="text-align:center">
    <td style="text-align:left"><? echo $row['Player']; ?></td>
    <td><? echo $row['Team']; ?></td>
    <td><? echo $row['Pass_Yds']; ?></td>
    <td><? echo $row['Pass_TDs']; ?></td>
    <td><? echo $row['Int_Thrown']; ?></td>
    <td><? echo $row['Rush_Yds']; ?></td>
    <td><? echo $row['Rush_TDs']; ?></td>
    <td><a href="edit.php?id=<? echo $row['ID']; ?>">Edit</a></td></tr>
<?php
    }
    ?>
</table> 
```

这是来自edit.php的代码：

```
<?php
// contact to database
$connect = mysql_connect("localhost", "xxx", "xxx") or die ("Error , check your server connection.");
mysql_select_db("xxx");
$ID=$_GET['ID'];

$result = mysql_query("SELECT * FROM ff_projections WHERE ID = '$ID'") or die ("Error in query");
$row=mysql_fetch_array($result);
?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
</head>

<body>

<form name="edit" method="post" action="confirm.php">
<input name="ID" type="hidden" id="ID" value="<? echo $row['ID']; ?>">
<table width="560" cellspcing="0" cellpadding="5" border="0">
<tr style="text-align:center">
<td style="text-align:left ; width:175px">Player Name</td>
<td>Team</td>
<td>Pass Yds</td>
<td>Pass TDs</td>
<td>Int Thrown</td>
<td>Rush Yds</td>
<td>Rush TDs</td>
<td></td>
</tr>
<tr>
<td><? echo $row['Player']; ?></td>
<td><? echo $row['Team']; ?></td>
<td><input class="edit" name="Pass_Yds" type="text" id="Pass_Yds" value="<? echo $row['Pass_Yds']; ?>"></td>
<td><input class="edit" name="Pass_TDs" type="text" id="Pass_TDs" value="<? echo $row['Pass_TDs']; ?>"></td>
<td><input class="edit" name="Int_Thrown" type="text" id="Int_Thrown" value="<? echo $row['Int_Thrown']; ?>"></td>
<td><input class="edit" name="Rush_Yds" type="text" id="Rush_Yds" value="<? echo $row['Rush_Yds']; ?>"></td>
<td><input class="edit" name="Rush_TDs" type="text" id="Rush_TDs" value="<? echo $row['Rush_TDs']; ?>"></td>
<td><input type="submit" name="Submit" value="Submit"></td>
</tr>
</table>
</form>

</body>
</html> 
```

我知道大部分代码已被弃用。一旦我得到这个版本的工作，我将把注意力转向支持代码 - 最有可能使用 mysqli API。

同时，我们将非常感谢您对此提供任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T03:56:14.870

PHP 区分大小写（大部分时间）。所以

```
$ID=$_GET['ID']; 
```

需要是

```
$ID=$_GET['id']; 
```

# jquery - 使用 jQuery 对 CSS 变换进行动画处理

> ID：10966223
> 
> 赞同：7
> 
> 时间：2012-06-10T03:47:18.617
> 
> 标签：jquery, css, jquery-animate, transform, rotation

我正在尝试为 div 设置动画，并让它围绕 y 轴旋转 180 度。当我调用以下代码时，我得到一个 jQuery 错误：

```
$("#my_div").animate({
       "transform": "rotateY(180deg)",
       "-webkit-transform": "rotateY(180deg)",
       "-moz-transform": "rotateY(180deg)"
    }, 500, function() {
        // Callback stuff here
    });
}); 
```

它说“Uncaught TypeError：无法读取未定义的属性'defaultView'”并说它在jQuery文件本身中......我做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-11-26T11:03:07.783

您还可以在 CSS 类中预定义旋转并使用 jQuery 添加/删除该类：

*CSS：*

```
#my_div {
    -moz-transition: all 500ms ease;
    -o-transition: all 500ms ease;
    -webkit-transition: all 500ms ease;
    transition: all 500ms ease;
}
.rotate {
    -moz-transform: rotate(180deg);
    -o-transform: rotate(180deg);
    -webkit-transform: rotate(180deg);
    transform: rotate(180deg);
} 
```

*jQuery：*

```
$("#my_div").addClass('rotate'); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-10T04:24:45.053

尝试这个：

```
$('#myDiv').animate({ textIndent: 0 }, {
    step: function(go) {
      $(this).css('-moz-transform','rotate('+go+'deg)');
      $(this).css('-webkit-transform','rotate('+go+'deg)');
      $(this).css('-o-transform','rotate('+go+'deg)');
      $(this).css('transform','rotate('+go+'deg)');
    },
    duration: 500,
    complete: function(){ alert('done') }
}); 
```

[http://jsfiddle.net/RPSzb/2/](http://jsfiddle.net/RPSzb/2/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-02-16T20:10:40.130

jQuery 无法开箱即用地为变换属性设置动画。[但是您可以使用以下功能](http://api.jquery.com/animate/#step)为自定义属性设置动画`.animate()`并“手动”进行转换：[`step`](http://api.jquery.com/animate/#step)

```
var $myDiv = $("#my_div"),
    ccCustomPropName = $.camelCase('custom-animation-degree');
$myDiv[0][ccCustomPropName ] = 0; // Set starting value
$myDiv.animate({ccCustomPropName : 180},
    {
        duration: 500,
        step: function(value, fx) {
            if (fx.prop === ccCustomPropName ) {
                $myDiv.css('transform', 'rotateY('+value+'deg)');
                // jQuery will add vendor prefixes for us
            }
        },
        complete: function() {
            // Callback stuff here
        }
    }); 
```

请参阅[此小提琴](http://jsfiddle.net/Ignitor/SyQH3/)以获取工作示例（单击蓝色框）。

这类似于[未定义的答案](https://stackoverflow.com/a/10966355/490560)，但它不会滥用真正的 CSS 属性。

**注意：**自定义属性的名称应该是[jQuery.camelCase()](https://github.com/jquery/jquery/blob/eda283d0e4d59074ae98af0fdc2951e6c109d5fd/src/core.js#L285)名称，因为`.animate()`在内部使用驼峰命名，因此，将使用驼峰命名存储属性的当前值，并且`fx.prop`也将是驼峰命名。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-20T22:41:43.963

忘记 jQuery 的`$.animate()`，而是使用`$.velocity()`. [Velocity.js](http://julian.com/research/velocity/)是 jQuery 的动画扩展。它使用与 jQuery 相同的语法，并允许您对 CSS3 进行动画处理，例如 3D 变换、平移、旋转、褪色、过渡、倾斜……任何您想要的。而且由于它足够聪明，可以在可能的情况下使用 CSS3 而不是 JS，因此它的动画性能也更好。我不明白为什么 jQuery 还没有这样做！

[http://julian.com/research/velocity/](http://julian.com/research/velocity/)

# ios - 在编辑模式下检查双击

> ID：10966225
> 
> 赞同：2
> 
> 时间：2012-06-10T03:47:56.753
> 
> 标签：ios, iphone, objective-c, theos

我正在做一个调整，当用户在编辑模式下双击一个图标时会弹出一个警报。我已经尝试过

```
- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event 
```

的`SBIcon`然后

```
{
    %orig;
    UITouch *touch = [touches anyObject];
    if (touch.tapCount == 2 && [[objc_getClass("SBIconController") sharedInstance] isEditing])
    {
        //pop an alert and do stuff
    }
} 
```

但这似乎根本不起作用。谁能告诉我上述有什么问题并提出替代方法来实现这一目标？

编辑：如果重要的话，我正在使用theos。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-02T04:50:49.873

适合您的替代方法

`UIControlEventTouchDownRepeat`如果您的图标是一个按钮，那么您可以通过添加事件轻松检测双标签

```
[yourIconButton addTarget:self action:@selector(multipleTap:withEvent:) 
             forControlEvents:UIControlEventTouchDownRepeat];

-(IBAction)multipleTap:(id)sender withEvent:(UIEvent*)event 
{
   UITouch* touch = [[event allTouches] anyObject];
   if (touch.tapCount == 2) {
     // Do all your actions here
   }
} 
```

如果您正在考虑整体视图，请使用 UITapGesture

```
UITapGestureRecognizer *tap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(tapAction:)];
[tap setNumberOfTapsRequired:2];
[yourIconView addGestureRecognizer:tap];

- (void)tapAction:(UIGestureRecognizer *)gestureRecognizer
{
    //Do your action
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T04:52:37.887

我会建议你使用 Tap 手势识别器。它更具体并且工作非常准确。

有关更多信息，您可以查看此链接：http: [//developer.apple.com/library/ios/#documentation/EventHandling/Conceptual/EventHandlingiPhoneOS/GestureRecognizers/GestureRecognizers.html](http://developer.apple.com/library/ios/#documentation/EventHandling/Conceptual/EventHandlingiPhoneOS/GestureRecognizers/GestureRecognizers.html)

# yql - YQL 在国家/地区获得股票报价

> ID：10966233
> 
> 赞同：4
> 
> 时间：2012-06-10T03:49:46.793
> 
> 标签：yql, stock, stockquotes

最近几天我一直在寻找这个。我已经通过 YQL 实现了获取基本的东西，比如他们的股票、价格等等。

像这样 ：

> 从 yahoo.finance.quotes 中选择 Name、Symbol、LastTradePriceOnly、LastTradeDate、LastTradeTime、Change、ChangeInPercentage、PreviousClose、Open、Bid、Ask、DaysRange、YearRange、Volume 、Average、MarketCapitalization、PERatio、EPSEstimateCurrentYear、TralingAnnualDividendYield，其中 symbol = 'aapl'

但我不知道如何在国家/地区获得股票报价。首先，我没有获得 YQL 来获取与股票相关的国家/地区。

例如：从 yahoo.finance.quotes 中选择 Name,Symbol，其中 Country = "India"。

谢谢你的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T00:51:44.500

以这种方式使用 YQL 基本上是查找您提供的给定股票代码的结果。（在幕后，这个 YQL 表正在查询 Yahoo Finance 使用的数据源。）它不是一个通用数据库，您可以在其中进行查询，例如获取给定国家/地区的符号或市场列表。

YQL 确实适用于一些国际市场股票，但您需要再次知道该符号。例如：

[`select * from yahoo.finance.quotes where symbol="arm.l"`](http://developer.yahoo.com/yql/console/?q=select%20%2a%20from%20yahoo.finance.quotes%20where%20symbol=%22arm.l%22&env=store://datatables.org/alltableswithkeys)

[`select * from yahoo.finance.quotes where symbol="kfa.bo"`](http://developer.yahoo.com/yql/console/?q=select%20%2a%20from%20yahoo.finance.quotes%20where%20symbol=%22kfa.bo%22&env=store://datatables.org/alltableswithkeys)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-12T07:53:46.170

雅虎 API 似乎不适用于国际交易所。尝试这个：

select * from yahoo.finance.quotes where symbol="ril.bo"

查询有效并且不返回任何数据。这是我得到的样本：

```
"Name": "RIL.BO",
"Notes": null,
"Open": null,
"PreviousClose": null,
"PricePaid": null,
"ChangeinPercent": null,
"PriceSales": null,
"PriceBook": null,
"ExDividendDate": null,
"PERatio": null,
"DividendPayDate": null,
"PERatioRealtime": null,
"PEGRatio": null,
"PriceEPSEstimateCurrentYear": null,
"PriceEPSEstimateNextYear": null,
"Symbol": "RIL.BO", 
```

YQL 提供了一个线索，表明它不是为国际交易所设置的。隐藏在 JSON 中的是消息：

```
"ErrorIndicationreturnedforsymbolchangedinvalid": "No such ticker symbol. <a href=/l>Try Symbol Lookup</a> (Look up: <a href=/l?s=RIL.BO>RIL.BO</a>)", 
```

请注意，我使用的符号是有效的，并且来自 Yahoo! 自己的查找。

对于美国交易所来说，一切都很好。尝试用 GOOG 或 YHOO 代替 RIL.BO。奇迹般有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T10:29:01.583

我正在寻找同样的东西，我原以为你需要使用市场名称而不是国家名称。即纳斯达克、富时或疯牛病。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-05T15:53:42.583

有一个世界明智地区的重要证券交易所代码列表-http: [//finance.yahoo.com/intlindices](http://finance.yahoo.com/intlindices?e=asia) ?e=asia ，我在这里解释了 URL 和查询逻辑[-http://prasanta-paul.blogspot。 kr/2013/01/accessing-yahoo-finance-api.html](http://prasanta-paul.blogspot.kr/2013/01/accessing-yahoo-finance-api.html)

希望能帮助到你！

# c++ - 如何跨进程协调端口使用？

> ID：10966236
> 
> 赞同：2
> 
> 时间：2012-06-10T03:50:36.683
> 
> 标签：c++, resources, port, contention, collision

我需要在一台机器上让多个进程相互协调，以便每个进程选择不同的端口来创建套接字以与不同的机器通信。每个进程必须从一系列可用端口中选择一个端口号，以便在任何时间点只有一个进程使用给定的端口号。

是否有现有的机制来进行这种协调，还是我需要建立自己的机制？

目前，我正在使用磁盘上的文件来注册端口号和使用该端口的 PID。如果找到一个不再运行 PID 的条目，则删除该条目，因为假定进程已非正常退出，因此需要获取该条目。

但是，我似乎有某种竞争条件，因为在极少数情况下，我最终有两个进程使用相同的端口，而第二个进程看不到显示保留端口的文件内容并最终再次使用它。

与其解决这个问题，我宁愿采用现有的机制来避免端口冲突，所以我想问这样的实用程序是否已经存在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T10:15:02.790

与 TCP 或 UDP 通信时，套接字由 4 元组区分：

*   本地地址
*   本地端口
*   远程地址
*   远程端口

如果您不理会本地分配，并且正在使用连接的协议进行通信，则该`connect`调用将为您找到可用的本地端口。如果您仅限于特定范围的端口，则需要进行本地地址和端口绑定。但是，在这种情况下，由于每个进程只处理一个连接，我只会在每个进程启动时为其分配一个唯一的端口，而不是让它尝试找到一个可用的端口。

也就是说，假设有一个进程负责启动所有其他进程，那么该进程将决定启动时的进程应该使用哪个端口。这更简单，因为决策是由单个实体做出的，因此它可以使用简单的算法，例如：

```
for (unsigned short p = minPort; p < maxPort; ++p) {
    child_pid = startWorker(p);
    child_pid_map[child_pid] = p;
} 
```

如果孩子死了，启动进程可以`child_pid_map`立即咨询重用该端口。

如果无法使用外部代理来分配端口，最简单的技术就是尝试`bind`调用范围内的随机端口。如果失败并显示`EADDRINUSE`，则逐步尝试序列中的下一个端口号（必要时包装），直到成功，或者您已尝试所有端口。

# android - Android：使用 WebView 播放资产声音

> ID：10966245
> 
> 赞同：11
> 
> 时间：2012-06-10T03:51:50.623
> 
> 标签：android, audio, webview, android-assets

当用户单击我的应用程序 WebView 上的标签时，我试图从资产文件夹中播放声音。我发现我可以使用扩展 WebViewClient 的新类来检测链接的扩展名，如果它是 mp3 文件，它可以通过默认的音频播放器播放它。但我希望它在不开始新活动的情况下在活动中播放。

我使用以下链接作为参考： [Webview 中的声音](https://stackoverflow.com/questions/8403271/sound-in-webview) 和[使用 Uri 或资产中的文件创建 MediaPlayer 时出错](https://stackoverflow.com/questions/3093562/error-creating-mediaplayer-with-uri-or-file-in-assets)

但它没有用。

我尝试使用以下代码来做到这一点：

```
package com.rangga.test.webview.sound;

import android.content.Intent;
import android.content.res.AssetFileDescriptor;
import android.media.MediaPlayer;
import android.net.Uri;
import android.webkit.WebView;
import android.webkit.WebViewClient;

public class MyWebViewClient extends WebViewClient{

    public MediaPlayer mp;

    @Override
    public boolean shouldOverrideUrlLoading(WebView view, String url){
        if(url.endsWith(".mp3")){
            mp = new MediaPlayer();
            AssetFileDescriptor afd = getAssets().openFd(url);
            mp.setDataSource(afd.getFileDescriptor());
            mp.start();

            return true;
        }else{
            return true;
        }

    }

} 
```

我在 getAssets() 上收到一个未定义的方法错误，我尝试用 Google 搜索它，它说有关传递上下文的信息。我对 Android 和面向对象编程非常陌生，所以我想知道这是否是正确的方法，以及是否有关于 Context 是什么的简单解释。谢谢你。

以下是我的完整代码：

MainActivity.class

```
package com.rangga.test.webview.sound;

import android.app.Activity;
import android.os.Bundle;
import android.webkit.WebView;

public class MainActivity extends Activity {

    WebView webMain;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        webMain = (WebView) findViewById(R.id.webMain);

        webMain.loadUrl("file:///android_asset/webpages/test.html");
        webMain.setWebViewClient(new MyWebViewClient());
    }

} 
```

**编辑**

因此，由于[https://stackoverflow.com/users/488241/squonk](https://stackoverflow.com/users/488241/squonk) ，代码有效，但现在出现另一个问题，我将 MyWebViewClient 更新为以下内容：

```
package com.rangga.test.webview.sound;

import java.io.IOException;

import android.content.Context;
import android.content.res.AssetFileDescriptor;
import android.media.MediaPlayer;
import android.webkit.WebView;
import android.webkit.WebViewClient;

public class MyWebViewClient extends WebViewClient{

    public MediaPlayer mp;
    private Context context = null;

    public MyWebViewClient(Context c){
        this.context = c;
    }

    @Override
    public boolean shouldOverrideUrlLoading(WebView view, String url){
        if(url.endsWith(".mp3")){

            mp = new MediaPlayer();
            try {
                AssetFileDescriptor afd = context.getAssets().openFd(url);
                mp.setDataSource(afd.getFileDescriptor(), afd.getStartOffset(), afd.getLength());
                afd.close();
                mp.prepare();
                mp.start();
            } catch (IllegalArgumentException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (IllegalStateException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

            return true;
        }else{
            return true;
        }   
    }
} 
```

但我得到一个 java.io.FileNotFoundException，但路径似乎是正确的。我在 assets/webpages/sounds/1.mp3 和 assets/webpages/1.mp3 中放置了 2 个 mp3 文件，并使用以下 html 代码对其进行了测试：

```
<html>
    <head>
        <title>Test Audio</title>
    </head>
    <body>
        <a href="file:///android_asset/webpages/sounds/1.mp3">File Asset</a><br/>
        <a href="1.mp3">Same Folder</a>
    </body>
</html> 
```

但是我在 LogCat 上收到以下错误：

```
06-11 06:20:37.955: W/System.err(377): java.io.FileNotFoundException: file:///android_asset/webpages/1.mp3
06-11 06:20:37.966: W/System.err(377):  at android.content.res.AssetManager.openAssetFd(Native Method)
06-11 06:20:37.974: W/System.err(377):  at android.content.res.AssetManager.openFd(AssetManager.java:314)
06-11 06:20:37.974: W/System.err(377):  at com.rangga.test.webview.sound.MyWebViewClient.shouldOverrideUrlLoading(MyWebViewClient.java:30)
06-11 06:20:37.985: W/System.err(377):  at android.webkit.CallbackProxy.uiOverrideUrlLoading(CallbackProxy.java:193)
06-11 06:20:38.000: W/System.err(377):  at android.webkit.CallbackProxy.handleMessage(CallbackProxy.java:304)
06-11 06:20:38.005: W/System.err(377):  at android.os.Handler.dispatchMessage(Handler.java:99)
06-11 06:20:38.005: W/System.err(377):  at android.os.Looper.loop(Looper.java:123)
06-11 06:20:38.014: W/System.err(377):  at android.app.ActivityThread.main(ActivityThread.java:4363)
06-11 06:20:38.014: W/System.err(377):  at java.lang.reflect.Method.invokeNative(Native Method)
06-11 06:20:38.024: W/System.err(377):  at java.lang.reflect.Method.invoke(Method.java:521)
06-11 06:20:38.024: W/System.err(377):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:860)
06-11 06:20:38.024: W/System.err(377):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:618)
06-11 06:20:38.054: W/System.err(377):  at dalvik.system.NativeStart.main(Native Method) 
```

我调用文件的方式有问题吗？之前谢谢。

**解决了**

感谢 squonk 的建议，我尝试了以下代码使其工作并且运行良好，谢谢 squonk！

```
package com.rangga.test.webview.sound;

import java.io.IOException;

import android.content.Context;
import android.content.res.AssetFileDescriptor;
import android.media.MediaPlayer;
import android.util.Log;
import android.webkit.WebView;
import android.webkit.WebViewClient;

public class MyWebViewClient extends WebViewClient{

    public MediaPlayer mp;
    private Context context = null;

    public MyWebViewClient(Context c){
        this.context = c;
        mp = new MediaPlayer();
    }

    @Override
    public boolean shouldOverrideUrlLoading(WebView view, String url){
        if(url.endsWith(".mp3")){
            url = url.replace("file:///android_asset/webpages/", "");
            Log.i("MyWebViewClient", url);
            try {
                AssetFileDescriptor afd = context.getAssets().openFd(url);
                mp = new MediaPlayer();
                mp.setDataSource(afd.getFileDescriptor(), afd.getStartOffset(), afd.getLength());
                afd.close();
                mp.prepare();
                mp.start();
            } catch (IllegalArgumentException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (IllegalStateException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

            return true;
        }else{
            return true;
        }   
    }
} 
```

以及测试它的html：

```
<html>
    <head>
        <title>Test Audio</title>
    </head>
    <body>
        <a href="webpages/1.mp3">File Asset</a><br/>
    </body>
</html> 
```

尽管如果我反复单击它确实会出现错误，但这是另一个问题：D 如何结束一个问题？>.<

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T06:08:45.983

在您声明`MediaPLayer`in 的地方`MyWebViewClient`，添加以下内容...

```
public class MyWebViewClient extends WebViewClient{

    public MediaPlayer mp;
    private Context context = null; // Add this line

    ...
} 
```

然后添加一个构造函数`MyWebViewClient`如下...

```
public MyWebViewClient(Context context) {
    this.context = context;
} 
```

然后`shouldOverrideUrlLoading(...)`按如下方式获取您的资产...

```
AssetFileDescriptor afd = context.getAssets().openFd(url); 
```

在您的`MainActivity`设置中，`WebViewClient`通过传递`this`（即 Activity `Context`）如下...

```
webMain.setWebViewClient(new MyWebViewClient(this)); 
```

如果 url 以 '.mp3' 结尾，你也应该返回 - 这表明你`false`正在处理事情并且'host'应用程序不应该启动股票网络浏览器的实例。`shouldOverrideUrlLoading(...)``WebView`

**编辑：**要从 assets 目录播放音频文件，您需要以不同的方式设置数据源 - 请参阅[play-audio-file-from-the-assets-directory](https://stackoverflow.com/questions/3289038/play-audio-file-from-the-assets-directory)的已接受答案。

你也应该在打电话`mp.prepare()`之前打电话`mp.start()`。

# ruby-on-rails - 根据响应代码更改操作 respond_to

> ID：10966249
> 
> 赞同：0
> 
> 时间：2012-06-10T03:53:50.520
> 
> 标签：ruby-on-rails

我有以下`create`动作：

```
def create

  @report = Report.new(params[:report])
  @file = params[:report][:data_file]

  res = @report.get_report(@file, @report.year, @report.month)

  file = open('report.pdf','wb')
  file.write(res.body)

  @report.file = file

  respond_to do |format|
    if @report.save
      format.html { redirect_to @report, notice: 'Report was successfully created.' }
      format.json { render json: @report, status: :created, location: @report }
    else
      format.html { render action: "new" }
      format.json { render json: @report.errors, status: :unprocessable_entity }
    end
  end

end 
```

但是，存储在`res`变量中的 HTTP 响应可以有一个`200`代码，或者一个`400`指示错误请求的代码。我希望如果`res.code`是 400，它也会返回到`new`带有警告消息的操作。

如果如下所示，我尝试在 response_to 中包含该条件，但没有成功。似乎在创建实例后它重定向到`edit`操作。这没有道理。

```
 respond_to do |format|
    if @report.save and res.code == 200
      format.html { redirect_to @report, notice: 'Report was successfully created.' }
      format.json { render json: @report, status: :created, location: @report }
    else
      format.html { render action: "new" }
      format.json { render json: @report.errors, status: :unprocessable_entity }
    end
  end 
```

正确的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T04:22:51.487

这是一个有点复杂的工作流程，但看起来如果 res 的状态是 400，你只是想再次渲染新表单。因此，您可以使用以下方法提前逃脱：

```
 if res.status != 200
    render :new
    return
  end
  respond_to do |format|
    if @report.save
      format.html { redirect_to @report, notice: 'Report was successfully created.' }
      format.json { render json: @report, status: :created, location: @report }
    else
      format.html { render action: "new" }
      format.json { render json: @report.errors, status: :unprocessable_entity }
    end
  end 
```

# php - SQLSTATE[HY093]：参数号无效：参数未定义

> ID：10966251
> 
> 赞同：41
> 
> 时间：2012-06-10T03:54:40.653
> 
> 标签：php, mysql, pdo

```
// BUILD VALUES
$count = count($matches);
for($i = 0; $i < $count; ++$i) {
    $values[] = '(?)';
}
// INSERT INTO DATABASE
$q = $this->dbc->prepare("INSERT INTO hashes (hash) VALUES " . implode(', ', $values) . " ON DUPLICATE KEY UPDATE hash = hash");
$q->execute($matches); 
```

上面的代码失败并出现以下错误

**SQLSTATE[HY093]：参数号无效：参数未定义**

虽然`count($matches) == count($values)`在执行之前什么时候被调用？

这里发生了什么？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-06-10T10:03:58.703

您收到的此错误：

> **SQLSTATE[HY093]：参数号无效：参数未定义**

是因为`$values`&中的元素个数`$matches`不一样或者`$matches`包含的元素多于1个。

如果`$matches`包含超过 1 个元素，则插入将失败，因为在 query( `hash`)中只引用了 1 个列名

如果`$values`&`$matches`不包含相同数量的元素，则插入也将失败，因为查询需要 x 参数但它正在接收 y 数据`$matches` 。

我相信您还需要确保列哈希也具有唯一索引。

试试[这里](http://codepad.org/L5FqIQ5k)的代码：

```
<?php

/*** mysql hostname ***/
$hostname = 'localhost';

/*** mysql username ***/
$username = 'root';

/*** mysql password ***/
$password = '';

try {
    $dbh = new PDO("mysql:host=$hostname;dbname=test", $username, $password);
    /*** echo a message saying we have connected ***/
    echo 'Connected to database';
    }
catch(PDOException $e)
    {
    echo $e->getMessage();
    }

$matches = array('1');
$count = count($matches);
for($i = 0; $i < $count; ++$i) {
    $values[] = '?';
}

// INSERT INTO DATABASE
$sql = "INSERT INTO hashes (hash) VALUES (" . implode(', ', $values) . ") ON DUPLICATE KEY UPDATE hash='hash'";
$stmt = $dbh->prepare($sql);
$data = $stmt->execute($matches);

//Error reporting if something went wrong...
var_dump($dbh->errorInfo());

?> 
```

你需要稍微调整一下。

我使用的表结构[在这里](http://codepad.org/m2Vv1lPY)：

```
CREATE TABLE IF NOT EXISTS `hashes` (
  `hashid` int(11) NOT NULL AUTO_INCREMENT,
  `hash` varchar(250) NOT NULL,
  PRIMARY KEY (`hashid`),
  UNIQUE KEY `hash1` (`hash`)
) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ; 
```

代码在我的 XAMPP 服务器上运行，该服务器使用 PHP 5.3.8 和 MySQL 5.5.16。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2018-02-12T17:05:38.933

> **SQLSTATE[HY093]：参数号无效：参数未定义**

不幸的是，此错误不能描述与同一问题相关的一系列不同问题 - 绑定错误。它也没有指定错误在哪里，因此您的问题不一定在执行中，而是已经“准备好”的 sql 语句。

这些是可能的错误及其解决方案：

1.  存在参数不匹配 - 字段数与已绑定的参数不匹配。注意数组中的数组。仔细检查 - 使用*var_dump($var)*。“ *print_r* ”不一定会显示数组中的索引是否是另一个数组（如果数组中有一个值），而*var_dump*会。

2.  您尝试使用相同的绑定值进行绑定，例如：“:hash”和“:hash”。每个索引都必须是唯一的，即使在逻辑上对两个不同的部分使用相同的索引是有意义的，即使它是相同的值。（它类似于一个常量，但更像一个占位符）

3.  如果您在一个语句中绑定了多个值（通常是使用“INSERT”的情况），您需要先绑定参数，然后再绑定值到参数。这里的过程是将参数绑定到字段，然后将值绑定到参数。

    ```
    // Code snippet
    $column_names = array();
    $stmt->bindParam(':'.$i, $column_names[$i], $param_type);
    $stmt->bindValue(':'.$i, $values[$i], $param_type);
    $i++;
    //..... 
    ```

4.  将值绑定到 column_names 或 table_names 时，您可以使用 `` 但它不是必需的，但请确保保持一致。

5.  '' 单引号中的任何值始终被视为字符串，不会被读取为要绑定的列/表名称或占位符。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-06-07T00:53:19.670

绑定时使用错误的参数名称后，我遇到了同样的错误。

注意**:tokenHash**在`VALUES`查询的子句中，但**:token_hash**在绑定时。

修复一个或另一个解决了错误。

```
// Prepare DB connection
$sql = 'INSERT INTO rememberedlogins (token_hash,user_id,expires_at)
        VALUES (:tokenHash,:user_id,:expires_at)';
$db = static::getDB();
$stmt = $db->prepare($sql);

// Bind values
$stmt->bindValue(':token_hash',$hashed_token,PDO::PARAM_STR); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-11-16T19:50:13.900

如果您在 PHP 中的列名与数据库列名不匹配，我发现的相同错误将显示，请仔细检查。这就是我错了。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2019-12-14T22:44:41.117

我知道答案很有用但是由于某种原因它对我不起作用但是我已经使用以下代码改变了情况并且它是完美的

```
 <?php

$codigoarticulo = $_POST['codigoarticulo'];
$nombrearticulo = $_POST['nombrearticulo'];
$seccion        = $_POST['seccion'];
$precio         = $_POST['precio'];
$fecha          = $_POST['fecha'];
$importado      = $_POST['importado'];
$paisdeorigen   = $_POST['paisdeorigen'];
try {

  $server = 'mysql: host=localhost; dbname=usuarios';
  $user   = 'root';
  $pass   = '';
  $base   = new PDO($server, $user, $pass);

  $base->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

  $base->query("SET character_set_results = 'utf8',
                     character_set_client = 'utf8',
                     character_set_connection = 'utf8',
                     character_set_database = 'utf8',
                     character_set_server = 'utf8'");

  $base->exec("SET character_set_results = 'utf8',
                     character_set_client = 'utf8',
                     character_set_connection = 'utf8',
                     character_set_database = 'utf8',
                     character_set_server = 'utf8'");

  $sql = "
  INSERT INTO productos
  (CÓDIGOARTÍCULO, NOMBREARTÍCULO, SECCIÓN, PRECIO, FECHA, IMPORTADO, PAÍSDEORIGEN)
  VALUES
  (:c_art, :n_art, :sec, :pre, :fecha_art, :import, :p_orig)";
// SE ejecuta la consulta ben prepare
  $result = $base->prepare($sql);
//  se pasan por parametros aqui
  $result->bindParam(':c_art', $codigoarticulo);
  $result->bindParam(':n_art', $nombrearticulo);
  $result->bindParam(':sec', $seccion);
  $result->bindParam(':pre', $precio);
  $result->bindParam(':fecha_art', $fecha);
  $result->bindParam(':import', $importado);
  $result->bindParam(':p_orig', $paisdeorigen);
  $result->execute();
  echo 'Articulo agregado';
} catch (Exception $e) {

  echo 'Error';
  echo $e->getMessage();
} finally {

}

?> 
```

# python - GData 文档列表 API 的 Python 代码示例

> ID：10966252
> 
> 赞同：0
> 
> 时间：2012-06-10T03:54:42.813
> 
> 标签：python, google-docs, google-docs-api, google-drive-api, gdata-python-client

由于更改了 Google 的开发人员文档，我似乎找不到任何代码示例。特别是我正在寻找使用示例

*   搜索文档
*   以各种格式导出文档
*   Google Apps 用户的用户模拟

我正在关注开发人员页面上的链接 [https://developers.google.com/google-apps/documents-list/](https://developers.google.com/google-apps/documents-list/)

有谁知道官方示例的链接？替代其他示例资源？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T18:01:03.067

Python 文档正在重写，同时您可以使用库中包含的示例来查看如何执行所有常见任务：

[http://code.google.com/p/gdata-python-client/source/browse/samples/docs/docs_v3_example.py](http://code.google.com/p/gdata-python-client/source/browse/samples/docs/docs_v3_example.py)

API 文档在这里：[http ://packages.python.org/gdata/docs/api.html](http://packages.python.org/gdata/docs/api.html)

# java - java库中的LLVM仿真？

> ID：10966255
> 
> 赞同：1
> 
> 时间：2012-06-10T03:56:34.860
> 
> 标签：java, llvm

只是出于好奇想知道是否存在？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-31T10:00:53.150

为了获得更多信息，David A. Roberts 将[LLJVM](http://da.vidr.cc/projects/lljvm) ( [@Github](https://github.com/davidar/lljvm) ) 放在一起。该项目还用于在 Java JVM 上执行 LLVM 派生的位码。

请参阅[我关于此的 SO 回答](https://stackoverflow.com/questions/4934707/is-it-possible-to-transform-llvm-bytecode-into-java-bytecode#13540256)，因为其他一些社区成员已经推进了他的代码/创建的补丁。

[更新] - [LLJVM](http://da.vidr.cc/projects/lljvm)似乎已经死了一段时间，但是 Howard Chu ( [https://github.com/hyc](https://github.com/hyc) ) 看起来已经使[LLJVM](http://da.vidr.cc/projects/lljvm)与最新版本的 LLVM (3.3) 兼容。在 Github 上查看[Howard 的 LLJVM-LLVM3.3 分支，这里](https://github.com/hyc/lljvm/tree/llvm3.3)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T04:35:49.160

我在 GoogleCode 上发现了一个名为[java-lli](http://code.google.com/p/java-lli/)的项目，它似乎正在尝试这样做。但目前尚不清楚取得了多少进展。（没有可下载的人工制品，Wiki 中也没有任何东西。只是 SVN 中的东西，最后一次提交是在 2011 年 5 月。）

FWIW，如果您搜索“解释器”而不是“模拟器”，您将获得更多结果。

# erlang - Erlang - 导入 GPG 公钥

> ID：10966256
> 
> 赞同：2
> 
> 时间：2012-06-10T03:56:49.917
> 
> 标签：erlang, rsa, gnupg, public-key

我正在尝试在 Erlang 中做一些与公钥相关的事情，它们要求我跟踪公钥。根据[this page](http://www.erlang.org/doc/apps/public_key/using_public_key.html#id61611)，我应该可以使用`file:read_file/1`and导入 PEM 格式密钥`public_key:decode_pem/1`。问题是，当我尝试导入 GPG 公钥时，我没有得到结果。

我有一个名为`inaimathi.pubkey`以下内​​容的文件：

```
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: GnuPG v1.4.11 (GNU/Linux)

mQINBE9NBIQBEADMSzN6b0FaPP0rGiLDWKfH4ehN66Z0SAIynXm6lBHjmO69pNsm
iIe4p1X9aXhr7EgEZKdbqevfXW7NuA/oL7Rbt+tzBT5nS2cYSHoZhUC/onVhJxUb
drCR9NsBDZc1wZs+b95K3vWW91wMPYs4tn71DeeNgUVCcZOGofWltI7+etTVVIyG
zMEW4lOiEwBgLee+5u3XyGsBbyhtWnbp8ZMewiXjo14w0UCMEQxvf55NjggAO/vR
C+Czz5FQ7m9AnZwqIZJfaAw+aM81lmcXRZenGZ/H25H6WLq2DrVXnRjEyUvK+juj
K6rTHcot6K4Cgvo3P47uZcze92c4KaI22jTePRB1qov8ygAQw8BPsaZ+cA3AQ2Zv
4hjIyx2Qovs+vb1xWhk9Mgqyt0ToMZ6HNn386ICxaeYR8XY/rhf9ej0PJOS5c9Nx
reeTdrYXeco27kp/x+nDSWzqy0MrSAAD19xCK1w8Eiwc9MmjAAX1yarQzUy/ICey
eY6SaBfdK7x7A1ecUSu7mS7LmGFWB49Tx5u3ENXw9rU2hKbmGbbQsc+xCx5s7ZM1
q0aATJsUO4fsNe+4/9cBXCSP+4P6irX1EfliqaySt0LEr0WYhIgNgYq8PB7yx4Cv
0mOMv8lXBMYZs8NTrMJl2XHfi3egu8Ti14VChCklnWe95sZvKrk9/3BYxwARAQAB
tCtMZW8gWm92aWMgKEluYWltYXRoaSkgPGxlby56b3ZpY0BnbWFpbC5jb20+iQI4
BBMBAgAiBQJPTQSEAhsDBgsJCAcDAgYVCAIJCgsEFgIDAQIeAQIXgAAKCRDlo9AP
+vpofbYuD/9luGWbbw0ia5EfsDArk+iAs55HdmgjtVrcEqASR92bSbXxUylvM41T
Gd4nrM7Ri9XVgUSj6ZMnvPJihk08dkjWtoz83JQFdyJ9u7vIqs0LU4awrbNQ8l7P
M3fVKOme/vwQQ7kyIWkIYB0bl+CDRnldYGyBbV0lzh25/eVnhE8AsDltHJjhwe17
GVQPQfk/4B9SY0bTuAojZCUpMtI4cSBaI4v+xojewFt9B53oxW/KrLOvCVYUE9m2
TiJrtWcQjYqrlY9Ku203LzIZWbsFt9NEM6I26ewL3Iqn687fLgdkXZ2TuomJEcY+
5UxPIZfdiXqNG/nFLSII3v9kWA/f6ysXn7NTFx594+5KUqwjPke9ZFxi7gmyuRtK
KQyz1P+fRpkHqdP+OdNASDZ66CUaOqJrea6N+HpGIdBgRVfaYezl0wy9QfPe/PV7
ewYlP/nEpXDNpnr4cOvvD52VeoW9oiZEt0UFZ5iWEVepZlJ9uNq1QKkKDGHjBA/n
Mgd/Mc/Bg6sTfs6gtKfiX5MoPhZd/WDonAZyimJMY23Dw31TuIjmEmO1MuNNxj6c
Q2qWCVsQED6GgkPSRMwZ4+6Dh8DsLrt5xQp68I204XnT+ppgkXY/f4ALseRlOXeQ
9TeqeMcq7lO9DVULHLfXELw5/ijN08BBToZBIaBPKKoGhEdWBl9P3bkCDQRPTQSE
ARAAt9MpaK5TzTOzO/IenaHpfu0EoI4ZQSiWD4ZujvyuMEscdPQ4wDRMVwh66FAW
jeRE4O/m1q4rt/qDKqa0VCSGmap9gj7iLZ9+Fu5n3jyentzmoe22ATO7jOITGbW2
+0D56U3jCRRoSsY8ZSqECBLhsKbc7WIBX8yVxvpHYaqTOwM2+CIqDda5vgKeNxzk
cVDgUBnYj1nNpklGCs3494IVQ8aLVo5nOm8J0vY/n/YK5sAf6RlK+MEXCEyMVoiG
V4wo4fGLJXkhky5yL9vW+vmkUslw7mbAFRIC2KLg0CxXaGychsScpDlpmHkcxmsl
riGbEaKe0kMOM4KkXdopoGB66T0sEftL+hJmrAVe3H4iyldh/d5Hf1ez670m4ZZ6
gNdRCv3WJ72mZv4pqFH94NUksHvPrmot0B23ne6y/MqxYLIweIjJkD1ePxqpffMq
Ktkq9ooH7SB2GAMihCWiY/orSi6bt670Y9P3pzrwolErCWxieX8dg3H04z5nA7J3
6mqxQXLQvY6lXZYANOEKmm1qyoDgeBJoJdYUFbHrb83xcxQUqp8zikKneQ0rJfVG
dj38smSNAMqOeQQwZlmKFVwmIu4ozqszgZ2oqWS7q2NJgg64dnQlA60VMebQ0e8d
MMqy41VJ1FF8PCT1GGMsL+H4vdoZ+/wF2bhMQISWqFSVa5EAEQEAAYkCHwQYAQIA
CQUCT00EhAIbDAAKCRDlo9AP+vpofVp4D/9WqB4h9T5kGLBvuGUebjSqBuv6XfUd
q8vrvrMbSiLTLj2Gk58FjXdTPKCAuTkTtiYjMIXR0cF30uGRccM/tOMSp0xQYVT6
ueBhDZHaWaAEr2408j7/+tVg5CaLO/dVVfxpHIJ+8Bf1YmRRMpDm94i8X5j4rxPv
GNaOa6CgqWGlXsqFUw19OqXI5pK+hBH/GEpVPawr8/JLauc24ovt76gLGXDHrmKV
aeryKzy3TWikj3cq8Mdj2mKqNwkn1uu89j3xvxbq6gxX7lGX8pCLS2W6a7PYDaXf
no1/C31//Shn26LD9YfzRhcA/B/uXtEST3eShM5uS2sm+oOpxpiRaBv477K2TLpn
zh82VgwRTDkelpYJG8R8eBXwbBik+WSeIprZ8IrMfzZNs7xwn+z9isB0P3+VObWj
tBYKdMoF1mu40O1I7hsWV9UpJjRw2WrI8WpZMQTInXcaDWomWRgVhQjVhenYf6u2
nVoN3MM47hR7OR6KtcQ59lwlBeLcK9ImFuXjPK1GG9LtHzkKVOTI6p51S6Ug5MPu
7BuJxpxwDiohhVizBk3oZWInpNiXomk7Q6XwQ65mFTB11bX+wn0JIWO7BUWxK+dH
E+8YuCe53OAvNU0BFT8MAe/vB9kMl4N3p/3bJPuzmP4lnAGrLwzBZPkiQTNq8aj8
5NsttvIOclBY5A==
=Zqph
-----END PGP PUBLIC KEY BLOCK----- 
```

这似乎是正确的格式，但我得到的结果是

```
1> {ok, GpgBin} = file:read("inaimathi.pubkey").
{ok,<<"-----BEGIN PGP PUBLIC KEY BLOCK-----\nVersion: GnuPG v1.4.11 (GNU/Linux)\n\nmQINBE9NBIQBEADMSzN6b0FaPP0rGiLDWKf"...>>}
2> public_key:pem_decode(GpgBin).
[] 
```

根据文档，我希望这会返回一个`RSAEntry`然后我可以将其解码为公钥。通过这种机制导入公钥是否需要做一些特别的事情？GPG 密钥实际上是有效的 PEM 文件吗？我还缺少其他东西吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T09:52:35.960

ASCII 装甲和 PEM 非常相似。您只需要更改 BEGIN/END 标记，去除 PGP 标头和校验和（校验和是最后一行`=Zqph`），然后添加 PEM 标头。所以，你必须改变`inaimathi.pubkey`这个文件：

```
-----BEGIN RSA PUBLIC KEY-----
mQINBE9NBIQBEADMSzN6b0FaPP0rGiLDWKfH4ehN66Z0SAIynXm6lBHjmO69pNsm
iIe4p1X9aXhr7EgEZKdbqevfXW7NuA/oL7Rbt+tzBT5nS2cYSHoZhUC/onVhJxUb
drCR9NsBDZc1wZs+b95K3vWW91wMPYs4tn71DeeNgUVCcZOGofWltI7+etTVVIyG
zMEW4lOiEwBgLee+5u3XyGsBbyhtWnbp8ZMewiXjo14w0UCMEQxvf55NjggAO/vR
C+Czz5FQ7m9AnZwqIZJfaAw+aM81lmcXRZenGZ/H25H6WLq2DrVXnRjEyUvK+juj
K6rTHcot6K4Cgvo3P47uZcze92c4KaI22jTePRB1qov8ygAQw8BPsaZ+cA3AQ2Zv
4hjIyx2Qovs+vb1xWhk9Mgqyt0ToMZ6HNn386ICxaeYR8XY/rhf9ej0PJOS5c9Nx
reeTdrYXeco27kp/x+nDSWzqy0MrSAAD19xCK1w8Eiwc9MmjAAX1yarQzUy/ICey
eY6SaBfdK7x7A1ecUSu7mS7LmGFWB49Tx5u3ENXw9rU2hKbmGbbQsc+xCx5s7ZM1
q0aATJsUO4fsNe+4/9cBXCSP+4P6irX1EfliqaySt0LEr0WYhIgNgYq8PB7yx4Cv
0mOMv8lXBMYZs8NTrMJl2XHfi3egu8Ti14VChCklnWe95sZvKrk9/3BYxwARAQAB
tCtMZW8gWm92aWMgKEluYWltYXRoaSkgPGxlby56b3ZpY0BnbWFpbC5jb20+iQI4
BBMBAgAiBQJPTQSEAhsDBgsJCAcDAgYVCAIJCgsEFgIDAQIeAQIXgAAKCRDlo9AP
+vpofbYuD/9luGWbbw0ia5EfsDArk+iAs55HdmgjtVrcEqASR92bSbXxUylvM41T
Gd4nrM7Ri9XVgUSj6ZMnvPJihk08dkjWtoz83JQFdyJ9u7vIqs0LU4awrbNQ8l7P
M3fVKOme/vwQQ7kyIWkIYB0bl+CDRnldYGyBbV0lzh25/eVnhE8AsDltHJjhwe17
GVQPQfk/4B9SY0bTuAojZCUpMtI4cSBaI4v+xojewFt9B53oxW/KrLOvCVYUE9m2
TiJrtWcQjYqrlY9Ku203LzIZWbsFt9NEM6I26ewL3Iqn687fLgdkXZ2TuomJEcY+
5UxPIZfdiXqNG/nFLSII3v9kWA/f6ysXn7NTFx594+5KUqwjPke9ZFxi7gmyuRtK
KQyz1P+fRpkHqdP+OdNASDZ66CUaOqJrea6N+HpGIdBgRVfaYezl0wy9QfPe/PV7
ewYlP/nEpXDNpnr4cOvvD52VeoW9oiZEt0UFZ5iWEVepZlJ9uNq1QKkKDGHjBA/n
Mgd/Mc/Bg6sTfs6gtKfiX5MoPhZd/WDonAZyimJMY23Dw31TuIjmEmO1MuNNxj6c
Q2qWCVsQED6GgkPSRMwZ4+6Dh8DsLrt5xQp68I204XnT+ppgkXY/f4ALseRlOXeQ
9TeqeMcq7lO9DVULHLfXELw5/ijN08BBToZBIaBPKKoGhEdWBl9P3bkCDQRPTQSE
ARAAt9MpaK5TzTOzO/IenaHpfu0EoI4ZQSiWD4ZujvyuMEscdPQ4wDRMVwh66FAW
jeRE4O/m1q4rt/qDKqa0VCSGmap9gj7iLZ9+Fu5n3jyentzmoe22ATO7jOITGbW2
+0D56U3jCRRoSsY8ZSqECBLhsKbc7WIBX8yVxvpHYaqTOwM2+CIqDda5vgKeNxzk
cVDgUBnYj1nNpklGCs3494IVQ8aLVo5nOm8J0vY/n/YK5sAf6RlK+MEXCEyMVoiG
V4wo4fGLJXkhky5yL9vW+vmkUslw7mbAFRIC2KLg0CxXaGychsScpDlpmHkcxmsl
riGbEaKe0kMOM4KkXdopoGB66T0sEftL+hJmrAVe3H4iyldh/d5Hf1ez670m4ZZ6
gNdRCv3WJ72mZv4pqFH94NUksHvPrmot0B23ne6y/MqxYLIweIjJkD1ePxqpffMq
Ktkq9ooH7SB2GAMihCWiY/orSi6bt670Y9P3pzrwolErCWxieX8dg3H04z5nA7J3
6mqxQXLQvY6lXZYANOEKmm1qyoDgeBJoJdYUFbHrb83xcxQUqp8zikKneQ0rJfVG
dj38smSNAMqOeQQwZlmKFVwmIu4ozqszgZ2oqWS7q2NJgg64dnQlA60VMebQ0e8d
MMqy41VJ1FF8PCT1GGMsL+H4vdoZ+/wF2bhMQISWqFSVa5EAEQEAAYkCHwQYAQIA
CQUCT00EhAIbDAAKCRDlo9AP+vpofVp4D/9WqB4h9T5kGLBvuGUebjSqBuv6XfUd
q8vrvrMbSiLTLj2Gk58FjXdTPKCAuTkTtiYjMIXR0cF30uGRccM/tOMSp0xQYVT6
ueBhDZHaWaAEr2408j7/+tVg5CaLO/dVVfxpHIJ+8Bf1YmRRMpDm94i8X5j4rxPv
GNaOa6CgqWGlXsqFUw19OqXI5pK+hBH/GEpVPawr8/JLauc24ovt76gLGXDHrmKV
aeryKzy3TWikj3cq8Mdj2mKqNwkn1uu89j3xvxbq6gxX7lGX8pCLS2W6a7PYDaXf
no1/C31//Shn26LD9YfzRhcA/B/uXtEST3eShM5uS2sm+oOpxpiRaBv477K2TLpn
zh82VgwRTDkelpYJG8R8eBXwbBik+WSeIprZ8IrMfzZNs7xwn+z9isB0P3+VObWj
tBYKdMoF1mu40O1I7hsWV9UpJjRw2WrI8WpZMQTInXcaDWomWRgVhQjVhenYf6u2
nVoN3MM47hR7OR6KtcQ59lwlBeLcK9ImFuXjPK1GG9LtHzkKVOTI6p51S6Ug5MPu
7BuJxpxwDiohhVizBk3oZWInpNiXomk7Q6XwQ65mFTB11bX+wn0JIWO7BUWxK+dH
E+8YuCe53OAvNU0BFT8MAe/vB9kMl4N3p/3bJPuzmP4lnAGrLwzBZPkiQTNq8aj8
5NsttvIOclBY5A==
-----END RSA PUBLIC KEY----- 
```

# java - 如何在 servlet 中运行 jasper 报告

> ID：10966257
> 
> 赞同：2
> 
> 时间：2012-06-10T03:56:55.690
> 
> 标签：java, servlets, jasper-reports

我有一个简单的碧玉报告，其中显示了数据库中的一些数据。jasper 报告在 ireport 设计器上运行良好。问题是当我尝试从 servlet 运行报告时。从 servlet 运行时，我试图将报告导出为 pdf。我包括依赖项，如

```
- jasperreports-4.6.0.jar
- itextpdf-5.1.1.jar
- commons-logging-1.1.1.jar
- commons-collections-3.2.1.jar
- commons-beanutils-1.8.3.jar
- commons-digester3-3.2.jar
- cglib-2.2.jar 
```

我已将我的 report1.jasper 文件放入 /web/report1.jasper 这是我的 servlet 文件：

```
protected void doGet(HttpServletRequest request, HttpServletResponse response)
        throws ServletException, IOException {
    Connection connection;
    ServletOutputStream servletOutputStream =response.getOutputStream();

    InputStream reportStream =getServletConfig().getServletContext().getResourceAsStream("/report1.jasper");

    HashMap parameterMap = new HashMap();
    String stdID="510BCT2010";
    String semester="1";
    parameterMap.put("stdID", stdID);
    parameterMap.put("semester", semester);
    try
    {
        Class.forName("sun.jdbc.odbc.JdbcOdbcDriver");
        connection = DriverManager.getConnection ("jdbc:odbc:ACEM","","");
        JasperRunManager.runReportToPdfStream(reportStream,servletOutputStream, parameterMap, connection);

        connection.close();
        response.setContentType("application/pdf");
        servletOutputStream.flush();
        servletOutputStream.close();
    }
    catch (Exception e)
    {
        // display stack trace in the browser
        StringWriter stringWriter = new StringWriter();
        PrintWriter printWriter = new PrintWriter(stringWriter);
        e.printStackTrace(printWriter);
        response.setContentType("text/plain");
        response.getOutputStream().print(stringWriter.toString());
    }
} 
```

当我第一次运行 servlet 时，出现以下错误：

```
java.lang.NoClassDefFoundError: org/apache/commons/digester/Rule
net.sf.jasperreports.components.ComponentsExtensionsRegistryFactory.<clinit>(ComponentsExtensionsRegistryFactory.java:100)
java.lang.Class.forName0(Native Method)
java.lang.Class.forName(Class.java:247)
net.sf.jasperreports.engine.util.JRClassLoader.loadClassForRealName(JRClassLoader.java:157)
net.sf.jasperreports.engine.util.JRClassLoader.loadClassForName(JRClassLoader.java:115)
net.sf.jasperreports.engine.util.ClassUtils.instantiateClass(ClassUtils.java:53)
net.sf.jasperreports.extensions.DefaultExtensionsRegistry.instantiateRegistry(DefaultExtensionsRegistry.java:237)
net.sf.jasperreports.extensions.DefaultExtensionsRegistry.loadRegistries(DefaultExtensionsRegistry.java:214)
net.sf.jasperreports.extensions.DefaultExtensionsRegistry.loadRegistries(DefaultExtensionsRegistry.java:162)
net.sf.jasperreports.extensions.DefaultExtensionsRegistry.getRegistries(DefaultExtensionsRegistry.java:133)
net.sf.jasperreports.extensions.DefaultExtensionsRegistry.getExtensions(DefaultExtensionsRegistry.java:105)
net.sf.jasperreports.engine.util.JRStyledTextParser.<clinit>(JRStyledTextParser.java:83)
net.sf.jasperreports.engine.fill.JRBaseFiller.<init>(JRBaseFiller.java:121)
net.sf.jasperreports.engine.fill.JRVerticalFiller.<init>(JRVerticalFiller.java:88)
net.sf.jasperreports.engine.fill.JRVerticalFiller.<init>(JRVerticalFiller.java:103)
net.sf.jasperreports.engine.fill.JRVerticalFiller.<init>(JRVerticalFiller.java:61)
net.sf.jasperreports.engine.fill.JRFiller.createFiller(JRFiller.java:153)
net.sf.jasperreports.engine.fill.JRFiller.fill(JRFiller.java:55)
net.sf.jasperreports.engine.JasperFillManager.fill(JasperFillManager.java:446)
net.sf.jasperreports.engine.JasperFillManager.fill(JasperFillManager.java:407)
net.sf.jasperreports.engine.JasperRunManager.runToPdfStream(JasperRunManager.java:201)
net.sf.jasperreports.engine.JasperRunManager.runReportToPdfStream(JasperRunManager.java:720)
com.reports.reportGenerator.doGet(reportGenerator.java:54)
javax.servlet.http.HttpServlet.service(HttpServlet.java:621)
javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
org.netbeans.modules.web.monitor.server.MonitorFilter.doFilter(MonitorFilter.java:393) 
```

之后当我运行 servlet 时，出现以下错误

```
java.lang.NoClassDefFoundError: Could not initialize class net.sf.jasperreports.engine.util.JRStyledTextParser
net.sf.jasperreports.engine.fill.JRBaseFiller.<init>(JRBaseFiller.java:121)
net.sf.jasperreports.engine.fill.JRVerticalFiller.<init>(JRVerticalFiller.java:88)
net.sf.jasperreports.engine.fill.JRVerticalFiller.<init>(JRVerticalFiller.java:103)
net.sf.jasperreports.engine.fill.JRVerticalFiller.<init>(JRVerticalFiller.java:61)
net.sf.jasperreports.engine.fill.JRFiller.createFiller(JRFiller.java:153)
net.sf.jasperreports.engine.fill.JRFiller.fill(JRFiller.java:55)
net.sf.jasperreports.engine.JasperFillManager.fill(JasperFillManager.java:446)
net.sf.jasperreports.engine.JasperFillManager.fill(JasperFillManager.java:407)
net.sf.jasperreports.engine.JasperRunManager.runToPdfStream(JasperRunManager.java:201)
net.sf.jasperreports.engine.JasperRunManager.runReportToPdfStream(JasperRunManager.java:720)
com.reports.reportGenerator.doGet(reportGenerator.java:54)
javax.servlet.http.HttpServlet.service(HttpServlet.java:621)
javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
org.netbeans.modules.web.monitor.server.MonitorFilter.doFilter(MonitorFilter.java:393) 
```

它说 java.lang.NoClassDefFoundError。我错过了一些依赖项吗？我的报告没有图表，只从数据库中获取数据

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T02:28:44.193

我解决了这个问题。Jasper 报告库依赖项取决于其版本。jasperreport 4.6 需要[groovy](http://groovy.codehaus.org/Download)。我也有新的 itext 库（5.1），但 jasper 报告 4.6 仍然使用 iText-2.1.7。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T06:32:47.243

鉴于堆栈跟踪，您的依赖项中似乎缺少 apache commons digester。

# winforms - 将鼠标悬停在 ToolStripStatusLabel 上时如何显示工具提示？

> ID：10966258
> 
> 赞同：19
> 
> 时间：2012-06-10T03:57:02.680
> 
> 标签：winforms

我想在我的状态条上显示一个文件名，以及当用户将鼠标悬停在它上面时的完整路径。这是我所做的：

```
lblFileName.Text = fi.Name;
lblFileName.ToolTipText = fi.FullName; 
```

但是当我将鼠标悬停在它上面时，工具提示文本永远不会出现。怎么来的？

![](../Images/8e7be49ca6c311263b6e2783c9ce6c1e.png)

（将鼠标悬停在“waterfall.png”上什么都不做）

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-06-10T04:49:05.930

强制猜测，我会说您忘记将 StatusStrip 设置`ShowItemToolTips`为`True`.

# .net - 如何在 Xcode 中打包和发布 Foundation 命令行工具？

> ID：10966260
> 
> 赞同：0
> 
> 时间：2012-06-10T03:57:10.130
> 
> 标签：.net, macos, command-line, xcode4

我正在尝试学习 Mac 开发，因此决定从 Foundation 命令行应用程序开始。

我正在使用 Xcode 4.3.2。

在 .NET 中，您只需从 bin 文件夹中获取 .exe 并从它的位置运行，或者您可以将它放在 Windows 中的特定文件夹中，然后您可以从任何地方运行它。

你在mac上是这样吗？我知道 Mac 应用程序是带有 .app 扩展名的“文件夹”。但是命令行工具不是这样的，对吧？

那么，在 XCode 中，命令行工具的最终输出是什么？我该如何打包？它在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T06:53:08.873

尝试去产品--->存档

# c++ - 棘手的动态对象和指针

> ID：10966269
> 
> 赞同：0
> 
> 时间：2012-06-10T03:58:55.250
> 
> 标签：c++

我在理解我设置指针的方式有什么问题时遇到了问题。我正在尝试按照以下方式做一些事情：

```
matrix[0] = new Array<T>(columnSize); 
```

但它不编译。我认为问题在于 matrix[0] 返回一个引用，并且将 new Array(columnSize) 分配给它是不合法的？

这是错误

```
/Users/Ezequiel/desktop/wow/Matrix.h: In constructor ‘Matrix<T>::Matrix(size_t, size_t) [with T = int]’:
main.cpp:8:   instantiated from here
/Users/Ezequiel/desktop/wow/Matrix.h:18: error: invalid conversion from ‘Array<int>*’ to ‘long unsigned int’
/Users/Ezequiel/desktop/wow/Matrix.h:18: error:   initializing argument 1 of ‘Array<T>::Array(size_t) [with T = Array<int>*]’ 
```

我在下面附上了我的所有代码。

```
// Array.h

#ifndef ARRAY_H
#define ARRAY_H

#include <string>
#include <iostream>
#include <algorithm>

template<class T>
    class Array {
        private:
            T* elements;
            size_t low, high;
            void init(const size_t, const size_t);
            void copy(const Array<T>&);

        public:
            size_t size;
            Array();
            ~Array();
            Array(const size_t);
            Array(const size_t, const size_t);
            Array(const Array<T>&);

            T& operator[](const size_t);
            Array<T>& operator=(const Array<T>&);

            template<class X>
                friend std::ostream& operator<<(std::ostream&, const Array<X>&);
    };

template<class T>
    void Array<T>::init(const size_t low, const size_t high) {
        if (high < low || (high - low + 1 <= 0)) {
            std::cout << "An error was found in the bounds passed to the constructor.\n";
            exit(1);
        }

        size = high - low + 1;
        elements = new T[size];

        this->low = low;
        this->high = high;
    }

template<class T>
    void Array<T>::copy(const Array<T>& someArray) {        
        delete[] elements;

        if (someArray.size) {
            elements = new T[someArray.size];
            std::copy(someArray.elements, someArray.elements + someArray.size, elements);
            low = someArray.low;
            high = someArray.high;
            size = someArray.size;
        } else {
            size = 0;
            elements = 0;
            low = high = -1;    
        }
    }

template<class T>
    Array<T>::Array() {
        size = 0;
        elements = 0;
        low = high = -1;
    }

template<class T>
    Array<T>::Array(const size_t size) {
        init(0, size - 1);
    }

template<class T>
    Array<T>::Array(const size_t low, const size_t high) {
        init(low, high);
    }

template<class T>
    Array<T>::~Array() {
        delete[] elements;
    }

template<class T>
    Array<T>::Array(const Array<T>& someArray) {
        copy(someArray);
    }

template<class T>
    Array<T>& Array<T>::operator=(const Array& someArray) {
        if (this == &someArray) {
            return *this;
        }

        copy(someArray);

        return *this;   
    }

template<class T>
    T& Array<T>::operator[](const size_t index) {
        if (index < low || index > high || size <= 0) {
            std::cout << "The index " << index << " goes out of bounds.\n";
            exit(1);
        }
        return elements[index - low];
    }

template<class X>
    std::ostream& operator<<(std::ostream& os, const Array<X>& someArray) {
        if (someArray.elements) {
            for (size_t i = 0; i < someArray.size - 1; ++i) {
                os << someArray.elements[i] << ", ";
            }
            os << someArray.elements[someArray.size - 1];
        } else {
            os << 0;
        }
    }

#endif

// Matrix.h
#include "Array.h"

template<class T>
    class Matrix {
        private:
            Array< Array<T>* > *matrix;
            size_t rowSize, columnSize;
        public:
            Matrix(const size_t rowSize, const size_t columnSize);
    };

template<class T>
    Matrix<T>::Matrix(const size_t rowSize, const size_t columnSize) {
        matrix = new Array< Array<T>* >(rowSize);

        // Compiles perfectly fine, except after I uncomment this line:
        // matrix[0] = new Array<T>(columnSize);

        this->rowSize = rowSize;
        this->columnSize = columnSize;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T05:00:03.047

`matrix`不是一个`Array<Array<T>*>`。它是一个`Array<Array<T>*>*`-- 指向一个`Array<Array<T>*>`. 这意味着`matrix[0]`（更好地写为`*matrix`；见下文）是类型`Array<Array<T>*>`。

您正在分配`matrix`via`new`而不是`new[]`. 只分配了一个对象。您可以使用`matrix[0]`来引用这个单个对象，但由于您使用 进行分配`new`，因此最好使用取消引用运算符。使用`matrix[0]`可能会导致您或您的代码的读者认为可能存在`matrix[1]`. 没有。

修复该注释掉的语句的方法是使用

```
(*matrix)[0] = new Array<T>(columnSize); 
```

如果您在循环中分配，

```
(*matrix)[idx] = new Array<T>(columnSize); 
```

请注意，引用矩阵的*i,j*元素是通过 完成的`(*matrix)[i][j]`。

如果您坚持使用`matrix[0]`，您将需要使用

```
matrix[0][idx] = new Array<T>(columnSize); 
```

分配和`matrix[0][i][j]`引用矩阵的*i,j*元素。

# java - Android中的Google +1按钮

> ID：10966270
> 
> 赞同：-4
> 
> 时间：2012-06-10T03:59:37.997
> 
> 标签：java, android, debugging, google-plus

> **可能重复：**
> [在 Android 应用中添加 Google +1 按钮](https://stackoverflow.com/questions/8843550/adding-a-google-1-button-in-android-app)

是否有任何 API 可以在 android 中放置 +1 按钮？如果没有，如何实现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T04:09:11.343

AFAIk，谷歌已经为它提供了 JavaScript。查看：[http](http://www.google.com/webmasters/+1/button/) ://www.google.com/webmasters/+1/button/了解详细信息并根据您的需要自定义 JavaScript

# java - Java MySQL 如何在 ResultSet 中选择行？

> ID：10966272
> 
> 赞同：0
> 
> 时间：2012-06-10T03:59:49.507
> 
> 标签：java, mysql, jdbc, resultset

我有一个非常基本的 MySQL 数据库。这是我用来创建它的查询：

```
CREATE TABLE SC_Users(
ID int(11) NOT NULL AUTO_INCREMENT, 
PRIMARY KEY (ID), 
Username varchar(255) NOT NULL, 
Class varchar(255) NOT NULL
) 
```

我通过查询我的数据库得到一个 ResultSet：

```
SELECT * FROM SC_Users 
```

我希望能够搜索用户名，然后找到该用户名的相应类。如果不使用不同的查询，我将如何做到这一点？

我知道可以通过使用以下方法轻松找到它：

```
SELECT * FROM SC_Users WHERE `Username` = Username 
```

但如果可能的话，我宁愿只使用 1 个查询来找到我想要的用户的任何值。在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T04:05:06.840

您可以简单地`PreparedStatement`用于您的目的。

```
 PreparedStatement pst=null;
    ResultSet rs=null;
    String userName = "someUser";
    String userClass;
    pst=con.prepareStatement("select * from SC_users where Username=? ");
    pst.setString(1,userName);
    rs=pst.executeQuery();
        if(rs.next())
        {
            userClass=rs.getString("Class");
        } 
```

# jquery - JQuery UI Drop Disable on selected elements

> ID：10966280
> 
> 赞同：0
> 
> 时间：2012-06-10T04:02:45.610
> 
> 标签：jquery, jquery-ui, drag-and-drop

我想在圈子上添加下落限制，我写了一个用于拖动圈子的脚本

**问题是用户可以将圆圈放在另一个圆圈上，我不想允许它，只是如果用户将圆圈拖放到另一个圆圈上，我需要还原。**

我为此写了一些代码。但这对我不起作用，它总是恢复掉线。这是我的示例网址

[http://webxtreams.net/demoprofiles004/circledragger.html](http://webxtreams.net/demoprofiles004/circledragger.html)

这是我在火灾错误上运行的 js 代码

```
$(".circle").draggable({
    revert: 'invalid'
});

$(".circle").droppable({
    accept: function(el) {        
        return el.hasClass('.circle');
    }
}); 
```

请帮我这样做。

还有一个小问题 - 我们可以在此跟踪还原事件吗，我需要在还原圆圈时重新绘制线条:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T04:32:26.603

为了使可拖动元素能够识别它们是相互放置的，您需要实现某种形式的碰撞检测。如果您想实现自己的解决方案，有很多在线资源可以解释碰撞检测的基本概念，或者您可以使用已经实现它的库。

这是一个使用碰撞检测的 Jquery 开源库：http: [//sourceforge.net/projects/jquidragcollide/](http://sourceforge.net/projects/jquidragcollide/)

# java - 将 ImageIcon 加载到现有的 JLabel

> ID：10966284
> 
> 赞同：0
> 
> 时间：2012-06-10T04:03:33.173
> 
> 标签：java, jlabel, imageicon

我已经知道 a可以在声明中`JLabel`使用 an ，就像这样。`ImageIcon``JLabel`

```
JLabel stick = new JLabel(new ImageIcon("stickPicture.gif")); 
```

我的问题是，如何将图片分配给`JLabel`after 声明。例如（这实际上不是有效的代码，这只是我认为可能有效的技术）

```
JLabel stick = new JLabel();
stick = new ImageIcon("stickPicture.gif")); 
```

有点奇怪的问题，只是想知道是否可以完成。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-10T04:08:19.353

使用 JLabel#setIcon(Icon)。

```
JLabel stick = new JLabel();
stick.setIcon(new ImageIcon("stickPicture.gif")); 
```

# sql-server-2008 - 这个计数是如何工作的？

> ID：10966287
> 
> 赞同：-2
> 
> 时间：2012-06-10T04:04:53.123
> 
> 标签：sql-server-2008, count, group-by

我的查询如下：

```
select     vend_id,
           COUNT(*) as num_prods
from       Products
group by   vend_id; 
```

请告诉我这部分是如何工作的——`select vend_id, COUNT(vend_id)`而不是`select COUNT(vend_id)`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T04:09:33.990

```
select COUNT(vend_id) 
```

这将返回供应商 ID 不为空的行数

```
select     vend_id, COUNT(*) as num_prods
from       Products
group by   vend_id 
```

这将按 ID 对元素进行分组，并为每个 ID 返回您拥有的行数。一个例子：

```
ID          name       salary      start_date              city       region
----------- ---------- ----------- ----------------------- ---------- ------
          1 Jason            40420 1994-02-01 00:00:00.000 New York   W
          2 Robert           14420 1995-01-02 00:00:00.000 Vancouver  N
          3 Celia            24020 1996-12-03 00:00:00.000 Toronto    W
          4 Linda            40620 1997-11-04 00:00:00.000 New York   N
          5 David            80026 1998-10-05 00:00:00.000 Vancouver  W
          6 James            70060 1999-09-06 00:00:00.000 Toronto    N
          7 Alison           90620 2000-08-07 00:00:00.000 New York   W
          8 Chris            26020 2001-07-08 00:00:00.000 Vancouver  N 
```

如果你运行这个查询，你会得到一个城市的行，你可以应用一个函数（在本例中为计数）到该行。因此，对于每个城市，您将获得行数。您还可以使用其他功能。

```
SELECT     City, COUNT(*) as Employees
FROM       Employee
GROUP BY   City 
```

结果是：

```
City       Employees
---------  ---------
New York           3
Toronto            2
Vancouver          3 
```

因为您可以比较每个城市的行数

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T05:06:53.393

`select vend_id, COUNT(vend_id)`只要`select COUNT(vend_id)`您使用`group by vend_id`. 当你使用时，`select vend_id, COUNT(vend_id)`你必须使用它来分组`vend_id`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-10T04:09:20.773

当您简单地选择`COUNT(vend_id)`不带`GROUP BY`子句时，您会得到一行，其中包含具有非 NULL 供应商 ID 的总行数 - 最后一位很重要，也是您可能更喜欢`COUNT(*)`避免“丢失”行的原因之一。有些人可能会争辩说这`COUNT(*)`在某种程度上效率较低，但在我使用过的任何 DBMS 中都是如此。无论如何，如果您*使用*的是脑死 DBMS，您可以随时尝试`COUNT(1)`.

当您按 分组时`vend_id`，您会得到每个供应商 ID 的一行，计数是该 ID 的行数。

在一步一步的细节中（从概念上讲，尽管几乎可以肯定通过优化可以获得效率），第一个查询：

```
SELECT COUNT(vend_id) AS num_prods FROM products 
```

*   获取 中所有行的列表`products`。
*   计算`vend_id`不为 NULL 的行，然后在单列中提供包含该计数的一行`num_prods`。

对于分组一：

```
SELECT vend_id, COUNT(vend_id) AS num_prods FROM products GROUP BY vend_id 
```

*   获取 中所有行的列表`products`。
*   对于 的每个值`vend_id`：
    *   `vend_id`计算与where不为 NULL的行匹配的行数`vend_id`，然后传递包含`vend_id`第一列中的行和第二`num_prods`列中的计数的行。

请注意，那些带有 null 的行`vend_id`对聚合函数没有贡献（`count`在这种情况下）。

在第一个查询中，这仅仅意味着它们没有出现在总体总数中。

在第二种情况下，这意味着输出行仍然存在，但计数为零。`COUNT(*)`这是使用or的另一个好理由`COUNT(1)`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-10T04:10:13.370

`select vend_id`只会选择`vend_id`字段，where`select *`会选择所有字段

# java - 由于 JButton 数组，如何删除 NullPointerExceptions

> ID：10966289
> 
> 赞同：1
> 
> 时间：2012-06-10T04:05:49.587
> 
> 标签：java, arrays, swing, jbutton

我对摇摆非常不熟悉，但在这里我正在尝试制作一个“clacker”游戏，每次掷两个骰子时，要么单击两个（如果它们是相同的数字，则单击 1）按钮代表两个数字或者只是一个代表两个数字之和的按钮。如果单击按钮，则可见设置为 false。我有一个 JButton 数组来保存 12 个按钮，但每次引用数组*按钮*时，它都会抛出 NullPointerException。我尝试将创建 JButton 数组的代码放在构造函数和 actionPerformed 中，但它仍然抛出相同的异常。

这是代码：

```
import javax.swing.*;
import java.awt.*;
import java.awt.event.*;
import java.util.Random;

public class Clacker implements ActionListener
{
    JPanel panel;
    JFrame frame;
    JLabel dieFace1, dieFace2, numTurns;
    JButton[] buttons;
    JButton rollDie, reset;
    String turn="Turns: ";
    int turns, numCovered;

public Clacker()
{
    frame = new JFrame("clacker");
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    panel=new JPanel();
    panel.setBorder(BorderFactory.createEmptyBorder(50,30,50,30));
    panel.setBackground(Color.gray);
    panel.setLayout(new GridLayout(5,10,1,1));

    dieFace1=new JLabel(new ImageIcon("die3.jpg"));
    dieFace1.setAlignmentX(JLabel.RIGHT_ALIGNMENT);
    dieFace1.setBorder(BorderFactory.createEmptyBorder(0,0,10,0));
    panel.add(dieFace1);

    dieFace2=new JLabel(new ImageIcon("die3.jpg"));
    dieFace2.setAlignmentX(JLabel.RIGHT_ALIGNMENT);
    dieFace2.setBorder(BorderFactory.createEmptyBorder(0,0,10,0));
    panel.add(dieFace2);

    rollDie=new JButton("Roll Die");
    rollDie.setAlignmentX(JButton.RIGHT_ALIGNMENT);
    rollDie.addActionListener(this);
    panel.add(rollDie);

    numTurns=new JLabel(turn+turns);
    numTurns.setAlignmentX(JLabel.LEFT_ALIGNMENT);
    numTurns.setBorder(BorderFactory.createEmptyBorder(10,10,10,10));
    panel.add(numTurns);

    setArray();

    reset=new JButton("Reset");
    reset.setAlignmentX(JButton.LEFT_ALIGNMENT);
    reset.addActionListener(this);
    panel.add(reset);

    frame.setContentPane(panel);

    frame.pack();
    frame.setVisible(true);
}

public void setArray()
{
    JButton[] buttons = new JButton[12];
    for (int i=0; i<12; i++)
    {

        buttons[i]= new JButton(i+1+"");
        buttons[i].setActionCommand(i+"");
        buttons[i].addActionListener(this);
        panel.add(buttons[i]);
        buttons[i].setEnabled(false);
        System.out.println(buttons[i]); 
    }
}

public void actionPerformed(ActionEvent event)
{
    if (event.getActionCommand().equals("Roll Die"))
    {   
        Random asdf = new Random();
        int newRoll= asdf.nextInt(6)+1;
        dieFace1.setIcon(new ImageIcon("die"+newRoll+".jpg"));

        Random asdf2 = new Random();
        int newRoll2= asdf2.nextInt(6)+1;
        dieFace2.setIcon(new ImageIcon("die"+newRoll2+".jpg"));

        int sum=newRoll+newRoll2;
        turns++;
        numTurns.setText(turn+turns);

        for (int i=0; i<7; i++)                                    ////here                          
        {
            if (i==newRoll)
                buttons[i].setEnabled(true);
            if (i==newRoll2)
                buttons[i].setEnabled(true);
        }

        for (int i=7; i<13; i++)
        {
            if (sum==i)
                buttons[i].setEnabled(true);
        }

        String eventName = event.getActionCommand();
        for (int b=1; b<13; b++)
        {
        if (eventName.equals(buttons[b].getActionCommand()))       ////here            
            {
                if (Integer.parseInt(eventName)>6)
                {
                    buttons[b].setText("");
                    numCovered++;
                    buttons[b].setVisible(false);
                    for (int i=0; i<7; i++)
                        buttons[i].setEnabled(false);
                }
            }   
        }

        for (int i=0; i<buttons.length; i++)                       ////here                            
            buttons[i].setEnabled(false);

        if (numCovered==12)
        {
            rollDie.setEnabled(false);
            numTurns.setText("Win! "+turns+" turns");
        }

    }

    else if (event.getActionCommand().equals("Reset"))
    {
        turns=0;
        numTurns.setText(turn+turns);
        rollDie.setEnabled(true);
        numCovered=0;
        for (int i=0; i<buttons.length; i++)                       ////here                             
        {
            buttons[i].setVisible(true);
            buttons[i].setEnabled(false);
        }
    }
}

private static void runGUI()
{ JFrame.setDefaultLookAndFeelDecorated(true); Clacker game = new Clacker();}

public static void main(String[] args)
{ javax.swing.SwingUtilities.invokeLater(new Runnable() {public void run() { runGUI();}});}
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-10T04:09:51.557

在`setArray`您声明一个局部变量而不是引用类成员变量时。只是改变

```
JButton[] buttons = new JButton[12]; 
```

到

```
this.buttons = new JButton[12]; 
```

# iphone - 在物理 iOS 设备上运行时发生内存泄漏

> ID：10966293
> 
> 赞同：0
> 
> 时间：2012-06-10T04:07:14.983
> 
> 标签：iphone, ios, ipad, memory-leaks

在测试我的应用程序时，一切在 iOS 模拟器上运行良好，但在物理 iOS 设备上运行同一个应用程序时，我遇到了内存泄漏。我是开发 iOS 应用程序的新手，我知道这有很多潜在的原因。我想知道为什么模拟器和物理设备之间会有所不同，是否有办法解决我的内存泄漏问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T04:11:32.753

我建议您阅读下面的教程。它将帮助您了解如何调试内存问题和其他问题。

* * *

1.  [我的应用程序崩溃了——现在怎么办？1/2](http://www.raywenderlich.com/10209/my-app-crashed-now-what-part-1)
2.  [我的应用程序崩溃了——现在怎么办？2/2](http://www.raywenderlich.com/10505/my-app-crashed-now-what-part-2)

提示：你的问题可以用僵尸对象解决；但我建议您先按照教程进行操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T17:06:07.470

令我惊讶的是，您的设备而不是模拟器中有泄漏。你是怎么得出结论的？两者都可能泄漏，但问题只是在不同平台上的表现不同，或者只是在设备上比模拟器更快地遇到问题。

如果您有泄漏，我建议您做两件事：

1.  通过静态分析器运行您的代码（从 Xcode 的“产品”菜单中选择“分析”）。较新的开发人员往往会忽略这个非常有用的工具。我知道只有在查看了分析器结果并真正理解（并解决）了我拥有的一个非常大的项目中的每一个问题之后，我才最终掌握了我的 Objective C 内存管理技术。无论如何，如果你在那里收到任何警告，你真的应该修复它们，因为它们通常表明内存管理问题。

2.  通过探查器运行程序。请参阅[查找泄漏](http://developer.apple.com/library/ios/#DOCUMENTATION/Performance/Conceptual/ManagingMemory/Articles/FindingLeaks.html#//apple_ref/doc/uid/20001883-CJBJFIDD)文档。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-10T04:26:05.623

是的，模拟器和设备之间存在差异（有时是令人讨厌的大差异）。这是因为每个的底层硬件是完全不同的。显然模拟器是在*模拟*iOS 硬件，但这并不是万无一失的。对于某些 API 和框架，事情可能只在硬件上工作，有时硬件上会出现在模拟器上没有出现的错误。只需将其视为 iOS 开发的“冒险”。

至于资源，我会看一下@Arab_Geek 的链接，以及 Apple 的[iOS 开发工具](http://developer.apple.com/library/ios/#referencelibrary/GettingStarted/URL_Tools_for_iPhone_OS_Development/_index.html)——特别是[Instruments](http://developer.apple.com/library/ios/#documentation/DeveloperTools/Conceptual/InstrumentsUserGuide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40004652)，比如 Leaks。

# c++ - C++实现堆中值函数

> ID：10966298
> 
> 赞同：4
> 
> 时间：2012-06-10T04:07:43.227
> 
> 标签：c++, heap, median

按照此处找到的答案[https://stackoverflow.com/a/10931091/1311773](https://stackoverflow.com/a/10931091/1311773)，我正在尝试实现两个堆，以便计算运行中位数。

我对堆不熟悉，并且不确定从哪里开始实现这里描述的这个功能。[http://programmingpraxis.com/2012/05/29/streaming-median/](http://programmingpraxis.com/2012/05/29/streaming-median/)

我的目标是创建一个小型测试程序，可以有效地计算运行中位数，因此随着列表的增长，中位数不需要从头开始重新计算。使用两个堆，我应该能够做到，我只是不知道如何开始实施它。

对此的任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-10T04:30:07.070

该`std::priority_queue`模板提供了堆的所有属性。恒定时间最大或最小提取（取决于项目的比较方式）和对数时间插入。它可以在`<queue>`头文件中找到。

默认情况下，`priority_queue`是一个最大堆。

```
int numbers[11] = { 0, 9, 3, 4, 8, 12, 2, 11, 10, 1, 5 };
std::priority_queue<int> myheap(numbers, numbers + 11);
std::cout << "biggest " << myheap.top() << std::endl; // 12
myheap.pop();
std::cout << "biggest " << myheap.top() << std::endl; // 11
myheap.push(6);
std::cout << "biggest " << myheap.top() << std::endl; // 11
myheap.push(13);
std::cout << "biggest " << myheap.top() << std::endl; // 13 
```

以下是如何创建最小堆的示例：

```
std::priority_queue<
    int,
    std::priority_queue<int>::container_type,
    std::greater<int>
>; 
```

要实现流式中位数算法，方法类似于：

*   为小于中位数的项目创建一个最大堆
*   为大于中位数的项目创建一个最小堆
*   将新项目推入堆时
    *   决定应该将其推入哪个堆，然后将其推到那里
    *   如果其中一个堆的大小比另一个堆大 1 以上，则弹出较大的堆，然后将该元素放入较小的堆中

然后，中位数是较大堆的顶部，或者是两个堆顶部的平均值。

如果您觉得需要手动管理堆，`C++`请提供允许您在自己的随机访问数据结构上执行此操作的算法。

*   `std::make_heap`-- heapify 迭代器端点指定的区域
*   `std::push_heap`-- 假设前 N-1 个元素已经是一个堆，并将第 N 个元素合并到堆中
*   `std::pop_heap` -- 将区域中的第一个元素放在最后一个位置，并重新堆集该区域，但不理会最后一个元素

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-28T22:58:47.027

我想这会有所帮助。谢谢。

```
 #include<cstdio>
    #include<iostream>
    #include<queue>
    #include <vector>         
    #include <functional>

    typedef priority_queue<unsigned int> type_H_low;
    typedef priority_queue<unsigned int, std::vector<unsigned int>, std::greater<unsigned int> > type_H_high;

    size_t signum(int left, int right) {
        if (left == right){
            return 0;
        }
        return (left < right)?-1:1;
    }

    void get_median( unsigned int x_i, unsigned int &m, type_H_low *l, type_H_high *r) {

        switch (signum( l->size(), r->size() )) {
        case 1: // There are more elements in left (max) heap
            if (x_i < m) {
                r->push(l->top());
                l->pop();
                l->push(x_i);
            } else {
                r->push(x_i);
            }
            break;

        case 0: // The left and right heaps contain same number of elements
            if (x_i < m){
                l->push(x_i);
            } else {
                r->push(x_i);
            }
            break;

        case -1: // There are more elements in right (min) heap
            if (x_i < m){
                l->push(x_i);
            } else {
                l->push(r->top());
                r->pop();
                r->push(x_i);
            }
            break;
        }

        if (l->size() == r->size()){
            m = l->top();
        } else if (l->size() > r->size()){
            m = l->top();
        } else {
            m = r->top();
        }

        return;
    }

    void print_median(vector<unsigned int> v) {
        unsigned int median = 0;
        long int sum = 0;
        type_H_low  H_low;
        type_H_high H_high;

        for (vector<unsigned int>::iterator x_i = v.begin(); x_i != v.end(); x_i++) {
            get_median(*x_i, median, &H_low, &H_high);
            std::cout << median << std::endl;
        }
    } 
```

# wpf - 如果线程挂起，则在 VB.net 中终止 BackgroundWorker - 使用 COM 对象

> ID：10966300
> 
> 赞同：0
> 
> 时间：2012-06-10T04:08:04.067
> 
> 标签：wpf, vb.net, multithreading, backgroundworker

我有一个与第三方 COM 对象交互的应用程序。我调用的 COM 对象的方法有时会停止响应。我创建了一个 Backgroundworker 线程来调用该函数，并且我试图从我的主线程监视它以在它挂起时将其杀死。我有额外的代码（未提供）使用主线程中的 system.timer 跟踪处理时间，如果它超过我的阈值，我会引发一个事件（这部分很好）。这是我想杀死线程并停止代码执行的时候。问题是.. 如果我使用 cancelasync 方法，它只会挂起，因为代码执行卡在函数调用上。

挂起的代码片段中的特定函数调用是“objCOM.SendDataToServer()”。返回通常需要 1-3 秒，但如果它没有得到响应，它将无限期挂起并且根本不会返回（没有错误只是挂起）.. 没有超时......因为我没有访问源函数我无法提供。我尝试了线程的 .dispose() 方法，但显然这并没有杀死它，cancelasync 也没有。我只需要帮助弄清楚如何杀死这个线程，这样我就可以重置服务器连接并再次调用该函数。任何帮助深表感谢！

```
Public Class COMobject
    Private objCOM as new acs.manager

    Public Sub CallComFunction()
        Dim bw_com as New Backgroundworker
        AddHandler bw_com.DoWork, AddressOf bw_com_dowork
        AddHandler bw_com.RunWorkerCompleted, AddressOf bw_com_runworkercompleted
        AddHandler bw_com.ProgressChanged, AddressOf bw_com_progresschanged

        bw_com.WorkerReportsProgress = True
        bw_com.RunWorkerAsync()
    End Sub

    Private Sub bw_com_dowork(byval sender as object,byval e as doworkeventargs)
        'this is the long running function that will hang
        call objCOM.SendDataToServer()
    End sub
End Class 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T13:31:46.957

我有点犹豫是否建议这样做-但您可能要考虑使用[Win32 API-Terminate 线程](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686717%28v=vs.85%29.aspx)。

这是一个非常危险的 API，可能会使您的应用程序处于潜在危险/不一致的状态，但对于给定的场景 - 这是我能想到的唯一方法。

如果允许在单独的过程中执行工作 - Hans Passant 的建议是更好的建议。终止进程比终止线程要安全得多。

# php - 通过 PHP 的系统托盘通知

> ID：10966313
> 
> 赞同：0
> 
> 时间：2012-06-10T04:10:57.733
> 
> 标签：php, notifications, system-tray

我想创建一个简单的通知图标，在用户系统托盘中显示一个数字。

应用程序只需要允许输入用于从服务器获取信息的 API 密钥。因此，例如：

[http://www.example.com/api.php?key=dfg45tgyy67h](http://www.example.com/api.php?key=dfg45tgyy67h)

PHP 文件将返回两个值，一个数字和一个 URL。该数字应该出现在系统托盘中，单击它应该会将您带到 URL。应用程序应该以指定的时间间隔更新信息，这些信息可以硬编码到应用程序中。

我真的不知道如何做到这一点，但可以很快学会这样的事情。所以我想知道一些方法来完成这个，或者最简单的方法是什么。

**编辑**当我说 PHP 时，我的意思是在服务器上它将是一个 PHP 文件，为应用程序提供信息。我不打算在 PHP 中创建客户端应用程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T04:13:45.033

你不能用 PHP 做到这一点，因为它无法与用户的计算机交互，并且包括系统托盘。您需要编写一些可以在他们的计算机上运行的东西，然后轮询您的 PHP 脚本以获取此信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T04:13:58.170

使用具有浏览器启动和系统托盘功能的跨平台语言和小部件工具包。

# apache - 在mahout的聚类算法中找到最近的'n'邻居

> ID：10966314
> 
> 赞同：3
> 
> 时间：2012-06-10T04:11:22.343
> 
> 标签：apache, cluster-analysis, mahout, nearest-neighbor

当我运行 DisplayDirichlet.java、DisplayClustering.java 等的 apache mahout 集群示例时，输出为图形格式。

1.  如何从给定项目中找到包含“n”个项目的最近邻居？
2.  我如何知道哪些项目（通过他们的 item_id）落在一个集群中？

# wordpress - custom_functions wordpress enqueue_script 在页脚而不是页眉中

> ID：10966316
> 
> 赞同：0
> 
> 时间：2012-06-10T04:12:57.877
> 
> 标签：wordpress, scripting, footer

我可以让它在页眉中工作，但我怎样才能在页脚中得到它。我在我的 wordpress 上使用论文框架。

```
function load_scripts() {
    wp_deregister_script( 'jquery' );
    wp_register_script( 'jquery', 'http://code.jquery.com/jquery-1.7.2.min.js');
    wp_enqueue_script( 'jquery');
    wp_register_script( 'bootstrap', '/wp-content/themes/thesis/custom/js/bootstrap.min.js', true);
    wp_enqueue_script( 'bootstrap');
}    
add_action('wp_enqueue_scripts', 'load_scripts'); 
```

我说的是真的，它似乎不起作用。我一直用这个作为参考。wp_enqueue_script($handle,$src,$deps,$ver,$in_footer);

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T07:05:50.037

看起来您传入`true`了错误的位置 - WordPress 会将其解释为`$deps`. 虽然`$deps`是可选的，但如果要指定后续参数，则需要提供。 [wp_register_script 的 codex 条目](http://codex.wordpress.org/Function_Reference/wp_register_script)告诉您默认值 - 只需传递这些值。

所以你的`wp_register_script`电话应该是：

```
wp_register_script( 'bootstrap', '/wp-content/themes/thesis/custom/js/bootstrap.min.js', array(), false, true); 
```

可能值得使用[get_bloginfo](http://codex.wordpress.org/Function_Reference/get_bloginfo#Template_Directory)来获取您的模板目录，而不是对其进行硬编码。

# mysql - MySQL 表汇总级联

> ID：10966318
> 
> 赞同：0
> 
> 时间：2012-06-10T04:13:28.983
> 
> 标签：mysql, database-design, triggers, structure, cascade

我正在为管理全球 300 多个远程销售地点的销售组织设计一个统计跟踪系统。系统接收有关销售数据的每日报告（原始美元价值和信息统计，例如已售出多少 X 商品等）。

我正在使用 MAMP 构建系统。

我计划将这些数字存储在一个 MySQL 大表中，因此每一行都是来自一个位置的一天的统计数据。这是一个示例：

```
------------------------------------------------------------------
| LocationID | Date | Sales$ | Item1Sold | Item2Sold | Item3Sold |
------------------------------------------------------------------
| Hawaii     | 3/4  | 100    | 2         | 3         | 4         |
| Turkey     | 3/4  | 200    | 1         | 5         | 9         |
------------------------------------------------------------------ 
```

因为该组织每天可能会收到来自 300 个位置中的每一个的统计更新，我估计该表在一个月内将有 9,000 条记录，一年内将有大约 108,000 条记录。因此，基于年份的 MySQL 表分区应该将查询保持在 100,000 条记录范围内，我认为这将使性能随着时间的推移保持稳定。

（如果有人发现我上面的“背景数据”中的理论有问题，请随时提及，因为我没有构建大型数据库的经验，这只是我在网上搜索所收集到的。）

* * *

现在，在这个系统的前端，它是基于 Web 的，主要关注 PHP。我打算使用我在网上找到的 YUI 框架来显示图形信息。

组织需要查看的是其偏远地区的销售数据的每日/每周图表，以及任何“细分”统计数据，例如已售商品（因此您可以“深入”到货币图表中，查看该收入的百分比来自项目 X)。

因此，如果我有 LocationID 的统计信息，那么按大陆组织这些信息是一件相当简单的事情。如果系统需要显示欧洲所有位置的销售数据图表，我可以执行一个查询，为 LocationID 加入一个维度表，该表给出其“大陆”类别，从而（按日期）汇总所有这些数据和将它们显示在图表上。或者，要显示每周信息，请将给定一周内的所有每日报告相加，并将它们作为 JSON 数组返回到我的 JS 图形对象，瞧。据我所知，非常简单的东西。

现在，我的想法是创建这些常见查询的“汇总”表。当用户想要拉起非洲最近 3 个月的销售额，并且查询必须一直深入到每日级别并使用各种 WHERE 和 JOIN 子句时，每周汇总适当的 LocationID 数字，并且然后显示给用户......好吧，拥有一个不太细化的表格似乎更有效。这样的表格需要通过新的每日报告自动更新到主表格中。

以下是需要存在的数据层次结构：

1) 地点的每日数据 2) 大陆的每日数据基于地点的每日数据 3) 星球的每日数据基于大陆的每日数据

4) 地点的每周数据（基于地点的每日数据） 5) 大陆的每周数据（基于地点的每周数据） 6) 地球的每周数据（基于大陆的每周数据）

所以我们这里有一种树，最细粒度的信息在底部（在一个表中，诚然）和一系列越来越细粒度的表，以便更容易获取长期查询的数据（分区如果它接收到地球 3 年每周数据的查询，则按年的每日数据表将毫无用处）。

现在，第一个问题：这有必要吗？在我所描述的场景中，是否有更好的方法来实现广泛的查询效率？

* * *

假设没有特别好的方法可以做到这一点，该怎么做呢？

我发现了 MySQL 触发器，在我看来，它似乎能够“级联更新”。在对 Daily Figures 表进行 INSERT 之后，理论上触发器可以读取插入记录的信息，并根据其值对更高级别表的相应记录调用 UPDATE。即，4 月 12 日在乔治亚州制造的 100 美元将提示美国表的“4 月 10 日至 4 月 17 日”记录更新该范围内所有每日记录的总和，这当然会看到新输入的 100 美元和新的值将是正确的。

好的，理论上这是可能的，但它似乎太硬编码了。我想构建系统，以便组织可以添加/删除位置并设置它们所在的大陆，这意味着必须重新配置触发器以包含该 LocationID。无法为给定的命令和表创建多个触发器意味着我必须单独存储触发器数据或从触发器对象中提取它，然后解析输入/输出添加或删除的特定规则，或者保留一个外部在这一步之前我用 PHP 处理的数组，或者......基本上，大量烦人的工作。

虽然 MySQL 触发器最初似乎是我的救星，但我越是了解以我需要的方式实现它们有多棘手，我就越觉得我*完全*偏离了我的想法，所以我想要从更有经验的数据库人员那里获得一些反馈。

* * *

虽然我会很欣赏关于如何完成我正在尝试做的事情的技术建议的智能答案，但我会更深入地欣赏解释正确行动（即使这是我正在做的）以及为什么它是正确的明智答案。

# windows-runtime - 有什么方法可以在动画完成之前中途引发一个事件？

> ID：10966321
> 
> 赞同：0
> 
> 时间：2012-06-10T04:14:07.680
> 
> 标签：windows-runtime

我有一个 AutoReverses 的动画，并且有兴趣在它完成之前中途获得一个事件（我正在尝试模拟硬币的翻转，并且在中途我需要将图像从正面更改为反面）。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T15:09:08.773

对于中途获取事件的一般解决方案是放置类似 ObjectAnimationUsingKeyFrames 的东西，并在 DiscreteObjectKeyFrame 中切换像 IsGoingUp 这样的属性的值，然后在 IsGoingUp 属性更改处理程序中 - 对该更改做出反应 - 也许通过引发事件。

对于您的特定问题 - 您可以将两个 ObjectAnimationUsingKeyFrames 与 DiscreteObjectKeyFrame 一起使用，只需在其中一个动画中将一个图像的可见性设置为折叠，在另一个动画中设置为可见。

# c# - ViewData 出现为空

> ID：10966322
> 
> 赞同：0
> 
> 时间：2012-06-10T04:14:30.327
> 
> 标签：c#, asp.net-mvc-3

我有这个测试页。这是行动方法。

```
public ActionResult TestView()
{
    ViewData["Test"] = "1";
    return View("TestView");
} 
```

在 TestView.cshtml 中，我有这行代码

```
@ViewData["Test"] 
```

它出现为空，它没有打印“1”。

知道我做错了什么吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T05:00:46.487

MV3 将 ViewBag 作为一个新对象，可以将动态属性保存为键/值对。

因此，您可以使用 ViewBag 直接分配属性。例如 -

在控制器中的操作中，您可以编写类似

```
ViewBag.Message = "1"; 
```

现在检索您可以在 .cshtml 中写入的值

```
<h2>@ViewBag.Message</h2> 
```

# tmux - 如何让 tmux 的反应更快？

> ID：10966323
> 
> 赞同：4
> 
> 时间：2012-06-10T04:14:49.420
> 
> 标签：tmux

我使用 tmux 并发现它的一个问题。例如，我在 tmux 下的 1 个窗口内制作了 2 个窗格。在一个窗格中，我编译 Linux 内核，如您所知，它会在那里输出大量消息。在编译过程中，在 tmux 的另一个窗格中，当我尝试输入一些命令时，它会反应很慢。如何解决这个问题？谢谢！

BR

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-10T19:22:08.097

使用两个窗格，`tmux`必须一次更新屏幕的两个部分。我的建议是让编译在一个单独的窗口中运行，这样`tmux`就不需要在可见屏幕上渲染太多输出，并在编译窗口上配置某种监视器，以便在编译完成时通知您。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-12-10T15:55:49.670

正如 chepner 所说，tmux 必须发送更多字符来更新屏幕的更大部分。就我而言，启用 ssh 压缩大大减少了这种缓慢。您可以尝试一下：

```
ssh -C user@host 
```

或放入`Compression yes`您`~/.ssh/config`的使其永久化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-22T01:38:20.897

2012 年 6 月问的问题？！^^ 如果您使用的是 X11，请尝试不同的终端。除了基于 xterm 的还有 KDE 的 konsole 及其变体（如 yakuake 下拉终端）和 GNOME 的 VTE 及其后代（如 guake 下拉终端:)），显示更新速度可能会有很大不同。此外，在 3 月份实施了速率限制功能，该功能将很快在 1.7 版本中发布。

# php - 使用 Zend 服务亚马逊

> ID：10966327
> 
> 赞同：2
> 
> 时间：2012-06-10T04:15:04.037
> 
> 标签：php, zend-framework, amazon-web-services, amazon

最初，我正在寻找如何使用 php 从亚马逊检索书籍信息。我发现了这个问题：

[如何在 PHP 中使用 Amazon 的 API 来搜索书籍？](https://stackoverflow.com/questions/2954264/how-can-i-use-amazons-api-in-php-to-search-for-books)

我认为这可行，但我有一个愚蠢的问题。我无法安装和使用[Zend Service Amazon](http://zendframework.com/manual/en/zend.service.amazon.html)。我下载了大约 60 MB 的软件，但已损坏。

可能是，我实际上想要一些 php 文件来实现它。但是，它提供了某种 exe 文件。

所以，我的问题是；

我在哪里下载 Zend 框架？我该如何安装它？我该如何使用它？

提前致谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-10T04:59:29.650

Zend Framework 的官方下载可以在[这里](http://framework.zend.com/downloads/latest)找到。由于您打算将 ZF 用作库而不是 MVC 应用程序框架，因此您只需要下载更小的最小包。

通过查看您感兴趣的 Amazon 文件，我认为您需要将以下文件列表复制到您的应用程序中才能使用 Zend Framework Amazon 服务 API（*当我使用 ZF 作为库时，我总是尝试只包含我将使用的实际文件，而不是整个包，但对于初学者来说，你可以复制整个`Zend`文件夹来开始*）：

```
Zend/Exception.php

Zend/Loader.php
Zend/Loader/Autoloader.php
Zend/Loader/Exception.php

Zend/Uri.php
Zend/Uri/Exception.php

Zend/Service/Abstract.php
Zend/Service/Amazon.php
Zend/Service/Exception.php

Zend/Service/Amazon/Abstract.php
Zend/Service/Amazon/Accessories.php
Zend/Service/Amazon/Authentication.php
Zend/Service/Amazon/CustomerReview.php
Zend/Service/Amazon/EditorialReview.php
Zend/Service/Amazon/Image.php
Zend/Service/Amazon/Item.php
Zend/Service/Amazon/ListmaniaList.php
Zend/Service/Amazon/Offer.php
Zend/Service/Amazon/OfferSet.php
Zend/Service/Amazon/Query.php
Zend/Service/Amazon/ResultSet.php
Zend/Service/Amazon/SimilarProduct.php

Zend/Rest/Client.php
Zend/Rest/Client/Result.php
Zend/Rest/Client/Result/Exception.php

Zend/Crypt.php
Zend/Crypt/Exception.php
Zend/Crypt/Hmac.php
Zend/Crypt/Hmac/Exception.php 
```

如果我错过了，请原谅我；如果我遗漏了任何内容，您应该会得到一个异常`class not found`，这应该很容易解决您需要包含哪些附加文件。

*为了使用 Zend Framework*，我建议执行以下操作：

首先，**将 Zend Framework 的文件添加到 PHP 的 include_path**中。为了使用 ZF 文件，您需要保留它们使用的目录结构，至少，您需要一个`Zend`包含所有 ZF 文件的文件夹。

添加到您的包含路径中，如下所示：

```
set_include_path(get_include_path() . PATH_SEPARATOR . '/zf/folder/path'); 
```

`zf/folder/path`应该是该`Zend`目录所在文件夹的路径，但请确保不要`Zend`在包含路径中实际包含该文件夹（因为 Zend 包含`require_once 'Zend/File.php';`

其次，尽可能**设置自动装载机。**如果您决定使用 Zend Framework 自动加载器，您将不必手动“require_once”许多 ZF 文件。

要设置他们的自动加载器，您所要做的就是获取它的一个实例：

```
require_once 'Zend/Loader/Autoloader.php';
$autoloader = Zend_Loader_Autoloader::getInstance(); 
```

您无需保存或使用`$autoloader`. 仅仅这个调用就足以注册 Zend 自动加载器。由于 ZF 文件在您的路径中，它会自动知道如何加载和定位所有 ZF 文件。

执行这些步骤后，您可以在 PHP 应用程序中通过 Zend Framework 使用 Amazon 服务。

至于使用它的细节，希望你能在[Zend_Service_Amazon 参考指南](http://framework.zend.com/manual/en/zend.service.amazon.html)中找到你需要的所有细节和帮助。参考指南应该是你最好的选择，但你总是可以在[这里](http://framework.zend.com/apidoc/1.11/)找到 phpDocumentor 类文档。

希望有帮助！随意询问您是否需要澄清任何事情。

# asp.net-mvc - 得到“JSON 请求太大而无法反序列化”

> ID：10966328
> 
> 赞同：220
> 
> 时间：2012-06-10T04:15:36.817
> 
> 标签：asp.net-mvc, knockout.js

我收到此错误：

> JSON 请求太大而无法反序列化。

这是发生这种情况的场景。我有一个国家类别，其中包含该国家/地区的运输港口列表

```
public class Country
{
    public int Id { get; set; }
    public string Name { get; set; }
    public List<Port> Ports { get; set; }
} 
```

我在客户端使用 KnockoutJS 进行级联下拉。所以我们有两个下拉列表，第一个是国家，第二个是那个国家的港口。

到目前为止一切正常，这是我的客户端脚本：

```
var k1 = k1 || {};
$(document).ready(function () {

    k1.MarketInfoItem = function (removeable) {
        var self = this;
        self.CountryOfLoadingId = ko.observable();
        self.PortOfLoadingId = ko.observable();
        self.CountryOfDestinationId = ko.observable();
        self.PortOfDestinationId = ko.observable();  
    };

    k1.viewModel = function () {
        var marketInfoItems = ko.observableArray([]),
            countries = ko.observableArray([]),

            saveMarketInfo = function () {
                var jsonData = ko.toJSON(marketInfoItems);
                $.ajax({
                    url: 'SaveMarketInfos',
                    type: "POST",
                    data: jsonData,
                    datatype: "json",
                    contentType: "application/json charset=utf-8",
                    success: function (data) {
                        if (data) {
                            window.location.href = "Fin";
                        } else {
                            alert("Can not save your market information now!");
                        }

                    },
                    error: function (data) { alert("Can not save your contacts now!"); }
                });
            },

            loadData = function () {
                $.getJSON('../api/ListService/GetCountriesWithPorts', function (data) {
                    countries(data);
                });
            };
        return {
            MarketInfoItems: marketInfoItems,
            Countries: countries,
            LoadData: loadData,
            SaveMarketInfo: saveMarketInfo,
        };
    } (); 
```

The problem occurs when a country like China is selected, which has *lots* of ports. 因此，如果您的阵列中有 3 或 4 次“中国”，我想将其发送到服务器进行保存。发生错误。

我应该怎么做才能解决这个问题？

* * *

## 回答 #1

> 赞同：429
> 
> 时间：2012-06-10T14:14:00.490

~~您必须将[maxJsonLength](http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.maxjsonlength.aspx)属性调整为更高的值`web.config`才能解决此问题。~~

 ~~```
<system.web.extensions>
    <scripting>
        <webServices>
            <jsonSerialization maxJsonLength="2147483644"/>
        </webServices>
    </scripting>
</system.web.extensions> 
```~~  ~~`aspnet:MaxJsonDeserializerMembers`在 appSettings 中设置更高的值：

```
<appSettings>
  <add key="aspnet:MaxJsonDeserializerMembers" value="150000" />
</appSettings> 
```

如果这些选项不起作用，您可以尝试使用此[线程](https://stackoverflow.com/questions/9509721/jsonvalueproviderfactory-throws-request-too-large)中指定的 JSON.NET 创建自定义 json 值提供程序工厂。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-04-03T13:26:56.627

## 如果您不想更改 Web 配置中的全局设置

使用全局设置将激活整个应用程序中的大型 json 响应，这可能会使您面临拒绝服务攻击。

如果允许几个选择位置，您可以使用 Content 方法非常快速地使用另一个 json 序列化器，如下所示：

```
using Newtonsoft.Json;

// ...

public ActionResult BigOldJsonResponse() 
{
    var response = ServiceWhichProducesLargeObject();
    return Content(JsonConvert.SerializeObject(response));
}
// ... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-09-14T19:30:14.533

设置并不总是有效。处理此问题的最佳方法是通过控制器，您必须编写自己的序列化 JSON 方法。这就是我解决返回一个非常大的 json 序列化对象作为对 jquery .Ajax 调用的响应的方法。

C#：将 JsonResult 数据类型替换为 ContentResult

```
// GET: Manifest/GetVendorServiceStagingRecords
[HttpGet]
public ContentResult GetVendorServiceStagingRecords(int? customerProfileId, int? locationId, int? vendorId, DateTime? invoiceDate, int? transactionId, int? transactionLineId)
{
    try
    {
        var result = Manifest.GetVendorServiceStagingRecords(customerProfileId, locationId, vendorId, invoiceDate, null, null, transactionId, transactionLineId);
        return SerializeJSON(result);
    }
    catch (Exception ex)
    {
        Log.Error("Could not get the vendor service staging records.", ex);

        throw;
    }
}

private ContentResult  SerializeJSON(object toSerialize)
{
    JavaScriptSerializer serializer = new JavaScriptSerializer();
    serializer.MaxJsonLength = Int32.MaxValue; // Wahtever max length you want here
    var resultData = toSerialize; //Whatever value you are serializing
    ContentResult result = new ContentResult();
    result.Content = serializer.Serialize(resultData);
    result.ContentType = "application/json";
    return result;
} 
```

然后在 Web.config 文件中增加到最大大小

```
<system.web.extensions>
  <scripting>
    <webServices>
      <jsonSerialization maxJsonLength="999999999" />
    </webServices>
  </scripting>
</system.web.extensions> 
```

那对我有用。~~

# wpf - INotifyPropertyChanged 在以特定语法声明时不会触发

> ID：10966329
> 
> 赞同：1
> 
> 时间：2012-06-10T04:15:52.510
> 
> 标签：wpf, binding, inotifypropertychanged

在调查[一个看似无关的问题](https://stackoverflow.com/questions/10949700/add-initially-missing-collection-items-via-binding)时，我遇到了一些意想不到的绑定行为。有

```
class StringRecord : INotifyPropertyChanged
{
    public string Key {get; set; }    // real INPC implementation is omitted
    public string Value { get; set; } // real INPC implementation is omitted
    ...
}

class Container
{
    public ObservableKeyedCollection<string, StringRecord> Params { get; set; }
    ...
{ 
```

现在，当 TextBox 以明显的方式绑定到集合项之一时

```
<TextBox Text="{Binding Params[APN_HOST].Value}" /> 
```

编辑文本时不会触发 StringRecord 实例的 PropertyChanged 事件。但是，将其重写为

```
<TextBox DataContext="{Binding Params[APN_HOST]}" Text="{Binding Value}" /> 
```

创造奇迹，事件开始正确触发。

为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T06:38:20.663

在第二个 xaml 示例中，绑定正在观察实现 INotifyPropertyChanged 的​​ StringRecord，因此会收到有关对象更改的通知。

在第一个 xaml 示例中，不清楚您要绑定什么。

如果将 DataContext 设置`Container`为绑定，则观察未实现 INotifyPropertyChanged 接口的对象。因为路径仍然正确，仍然可以读取 Value 属性，但您错过了通知。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T10:34:42.250

如果您希望绑定系统了解通过字符串索引访问的属性的更改，则该类`ObservableKeyedCollection`需要触发`PropertyChanged`事件和事件。`CollectionChanged`

为此，请 make `ObservableKeyedCollection`implement `INotifyPropertyChanged`，然后将以下代码添加到`OnCollectionChanged`：

```
if (PropertyChanged != null)
{
    PropertyChanged(this, new PropertyChangedEventArgs("Item[]"));
} 
```

另请参阅此答案： [PropertyChanged for indexer property](https://stackoverflow.com/questions/657675/propertychanged-for-indexer-property)。

# c# - C#中的双向/双向字典？

> ID：10966331
> 
> 赞同：113
> 
> 时间：2012-06-10T04:16:12.837
> 
> 标签：c#, .net, dictionary

我想通过以下方式将单词存储在字典中：

我可以逐字获取代码：`dict["SomeWord"]`->`123`并逐字获取代码：`dict[123]`->`"SomeWord"`

这是真的吗？当然，一种方法是使用两本词典：但`Dictionary<string,int>`还有`Dictionary<int,string>`另一种方法吗？

* * *

## 回答 #1

> 赞同：125
> 
> 时间：2012-06-10T06:02:55.210

我写了几个快速的类，可以让你做你想做的事。您可能需要使用更多功能对其进行扩展，但这是一个很好的起点。

代码的使用是这样的：

```
var map = new Map<int, string>();

map.Add(42, "Hello");

Console.WriteLine(map.Forward[42]);
// Outputs "Hello"

Console.WriteLine(map.Reverse["Hello"]);
//Outputs 42 
```

这是定义：

```
public class Map<T1, T2>
{
    private Dictionary<T1, T2> _forward = new Dictionary<T1, T2>();
    private Dictionary<T2, T1> _reverse = new Dictionary<T2, T1>();

    public Map()
    {
        this.Forward = new Indexer<T1, T2>(_forward);
        this.Reverse = new Indexer<T2, T1>(_reverse);
    }

    public class Indexer<T3, T4>
    {
        private Dictionary<T3, T4> _dictionary;
        public Indexer(Dictionary<T3, T4> dictionary)
        {
            _dictionary = dictionary;
        }
        public T4 this[T3 index]
        {
            get { return _dictionary[index]; }
            set { _dictionary[index] = value; }
        }
    }

    public void Add(T1 t1, T2 t2)
    {
        _forward.Add(t1, t2);
        _reverse.Add(t2, t1);
    }

    public Indexer<T1, T2> Forward { get; private set; }
    public Indexer<T2, T1> Reverse { get; private set; }
} 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2018-05-17T08:50:05.757

Regrettably, you need two dictionaries, one for each direction. However, you can easily get the inverse dictionary using LINQ:

```
Dictionary<T1, T2> dict = new Dictionary<T1, T2>();
Dictionary<T2, T1> dictInverse = dict.ToDictionary((i) => i.Value, (i) => i.Key); 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2017-01-28T07:52:54.957

Expanded on Enigmativity code by adding initializes and Contains method.

```
public class Map<T1, T2> : IEnumerable<KeyValuePair<T1, T2>>
{
    private readonly Dictionary<T1, T2> _forward = new Dictionary<T1, T2>();
    private readonly Dictionary<T2, T1> _reverse = new Dictionary<T2, T1>();

    public Map()
    {
        Forward = new Indexer<T1, T2>(_forward);
        Reverse = new Indexer<T2, T1>(_reverse);
    }

    public Indexer<T1, T2> Forward { get; private set; }
    public Indexer<T2, T1> Reverse { get; private set; }

    public void Add(T1 t1, T2 t2)
    {
        _forward.Add(t1, t2);
        _reverse.Add(t2, t1);
    }

    public void Remove(T1 t1)
    {
        T2 revKey = Forward[t1];
        _forward.Remove(t1);
        _reverse.Remove(revKey);
    }

    public void Remove(T2 t2)
    {
        T1 forwardKey = Reverse[t2];
        _reverse.Remove(t2);
        _forward.Remove(forwardKey);
    }

    IEnumerator IEnumerable.GetEnumerator()
    {
        return GetEnumerator();
    }

    public IEnumerator<KeyValuePair<T1, T2>> GetEnumerator()
    {
        return _forward.GetEnumerator();
    }

    public class Indexer<T3, T4>
    {
        private readonly Dictionary<T3, T4> _dictionary;

        public Indexer(Dictionary<T3, T4> dictionary)
        {
            _dictionary = dictionary;
        }

        public T4 this[T3 index]
        {
            get { return _dictionary[index]; }
            set { _dictionary[index] = value; }
        }

        public bool Contains(T3 key)
        {
            return _dictionary.ContainsKey(key);
        }
    }
} 
```

Here is a use case, check valid parentheses

```
public static class ValidParenthesisExt
{
    private static readonly Map<char, char>
        _parenthesis = new Map<char, char>
        {
            {'(', ')'},
            {'{', '}'},
            {'[', ']'}
        };

    public static bool IsValidParenthesis(this string input)
    {
        var stack = new Stack<char>();
        foreach (var c in input)
        {
            if (_parenthesis.Forward.Contains(c))
                stack.Push(c);
            else
            {
                if (stack.Count == 0) return false;
                if (_parenthesis.Reverse[c] != stack.Pop())
                    return false;
            }
        }
        return stack.Count == 0;
    }
} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-06-10T04:18:12.630

正如其他人所说，您可以使用两个字典，但还要注意，如果两者`TKey`和`TValue`都是相同类型（并且它们的运行时值域已知是不相交的），那么您可以通过为每个键创建两个条目来使用相同的字典/值配对：

`dict["SomeWord"]= "123"`和`dict["123"]="SomeWord"`

这样，单个字典可以用于任何一种类型的查找。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2019-03-04T20:34:19.730

What the heck, I'll throw my version into the mix:

```
public class BijectiveDictionary<TKey, TValue> 
{
    private EqualityComparer<TKey> _keyComparer;
    private Dictionary<TKey, ISet<TValue>> _forwardLookup;
    private EqualityComparer<TValue> _valueComparer;
    private Dictionary<TValue, ISet<TKey>> _reverseLookup;             

    public BijectiveDictionary()
        : this(EqualityComparer<TKey>.Default, EqualityComparer<TValue>.Default)
    {
    }

    public BijectiveDictionary(EqualityComparer<TKey> keyComparer, EqualityComparer<TValue> valueComparer)
        : this(0, EqualityComparer<TKey>.Default, EqualityComparer<TValue>.Default)
    {
    }

    public BijectiveDictionary(int capacity, EqualityComparer<TKey> keyComparer, EqualityComparer<TValue> valueComparer)
    {
        _keyComparer = keyComparer;
        _forwardLookup = new Dictionary<TKey, ISet<TValue>>(capacity, keyComparer);            
        _valueComparer = valueComparer;
        _reverseLookup = new Dictionary<TValue, ISet<TKey>>(capacity, valueComparer);            
    }

    public void Add(TKey key, TValue value)
    {
        AddForward(key, value);
        AddReverse(key, value);
    }

    public void AddForward(TKey key, TValue value)
    {
        ISet<TValue> values;
        if (!_forwardLookup.TryGetValue(key, out values))
        {
            values = new HashSet<TValue>(_valueComparer);
            _forwardLookup.Add(key, values);
        }
        values.Add(value);
    }

    public void AddReverse(TKey key, TValue value) 
    {
        ISet<TKey> keys;
        if (!_reverseLookup.TryGetValue(value, out keys))
        {
            keys = new HashSet<TKey>(_keyComparer);
            _reverseLookup.Add(value, keys);
        }
        keys.Add(key);
    }

    public bool TryGetReverse(TValue value, out ISet<TKey> keys)
    {
        return _reverseLookup.TryGetValue(value, out keys);
    }

    public ISet<TKey> GetReverse(TValue value)
    {
        ISet<TKey> keys;
        TryGetReverse(value, out keys);
        return keys;
    }

    public bool ContainsForward(TKey key)
    {
        return _forwardLookup.ContainsKey(key);
    }

    public bool TryGetForward(TKey key, out ISet<TValue> values)
    {
        return _forwardLookup.TryGetValue(key, out values);
    }

    public ISet<TValue> GetForward(TKey key)
    {
        ISet<TValue> values;
        TryGetForward(key, out values);
        return values;
    }

    public bool ContainsReverse(TValue value)
    {
        return _reverseLookup.ContainsKey(value);
    }

    public void Clear()
    {
        _forwardLookup.Clear();
        _reverseLookup.Clear();
    }
} 
```

Add some data to it:

```
var lookup = new BijectiveDictionary<int, int>();

lookup.Add(1, 2);
lookup.Add(1, 3);
lookup.Add(1, 4);
lookup.Add(1, 5);

lookup.Add(6, 2);
lookup.Add(6, 8);
lookup.Add(6, 9);
lookup.Add(6, 10); 
```

And then do the lookup:

```
lookup[2] --> 1, 6
lookup[3] --> 1
lookup[8] --> 6 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2012-06-10T04:47:42.250

您可以使用此扩展方法，尽管它使用枚举，因此对于大型数据集的性能可能不那么好。如果您担心效率，那么您需要两个字典。如果要将两个字典包装到一个类中，请参阅此问题的公认答案：[Bidirectional 1 to 1 Dictionary in C#](https://stackoverflow.com/questions/268321/bidirectional-1-to-1-dictionary-in-c-sharp)

```
public static class IDictionaryExtensions
{
    public static TKey FindKeyByValue<TKey, TValue>(this IDictionary<TKey, TValue> dictionary, TValue value)
    {
        if (dictionary == null)
            throw new ArgumentNullException("dictionary");

        foreach (KeyValuePair<TKey, TValue> pair in dictionary)
            if (value.Equals(pair.Value)) return pair.Key;

        throw new Exception("the value is not found in the dictionary");
    }
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2020-04-24T14:17:53.700

There is an expanded version of Enigmativity's answer available as a nuget package [https://www.nuget.org/packages/BidirectionalMap/](https://www.nuget.org/packages/BidirectionalMap/)

It is open sourced [here](https://github.com/farlee2121/BidirectionalMap)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-03-04T06:07:42.493

A modified version of Xavier John's answer, with an additional constructor to take forward and reverse Comparers. This would support case-insensitive keys, for example. Further constructors could be added, if needed, to pass further arguments to the forward and reverse Dictionary constructors.

```
public class Map<T1, T2> : IEnumerable<KeyValuePair<T1, T2>>
{
    private readonly Dictionary<T1, T2> _forward;
    private readonly Dictionary<T2, T1> _reverse;

    /// <summary>
    /// Constructor that uses the default comparers for the keys in each direction.
    /// </summary>
    public Map()
        : this(null, null)
    {
    }

    /// <summary>
    /// Constructor that defines the comparers to use when comparing keys in each direction.
    /// </summary>
    /// <param name="t1Comparer">Comparer for the keys of type T1.</param>
    /// <param name="t2Comparer">Comparer for the keys of type T2.</param>
    /// <remarks>Pass null to use the default comparer.</remarks>
    public Map(IEqualityComparer<T1> t1Comparer, IEqualityComparer<T2> t2Comparer)
    {
        _forward = new Dictionary<T1, T2>(t1Comparer);
        _reverse = new Dictionary<T2, T1>(t2Comparer);
        Forward = new Indexer<T1, T2>(_forward);
        Reverse = new Indexer<T2, T1>(_reverse);
    }

    // Remainder is the same as Xavier John's answer:
    // https://stackoverflow.com/a/41907561/216440
    ...
} 
```

Usage example, with a case-insensitive key:

```
Map<int, string> categories = 
new Map<int, string>(null, StringComparer.CurrentCultureIgnoreCase)
{
    { 1, "Bedroom Furniture" },
    { 2, "Dining Furniture" },
    { 3, "Outdoor Furniture" }, 
    { 4, "Kitchen Appliances" }
};

int categoryId = 3;
Console.WriteLine("Description for category ID {0}: '{1}'", 
    categoryId, categories.Forward[categoryId]);

string categoryDescription = "DINING FURNITURE";
Console.WriteLine("Category ID for description '{0}': {1}", 
    categoryDescription, categories.Reverse[categoryDescription]);

categoryDescription = "outdoor furniture";
Console.WriteLine("Category ID for description '{0}': {1}", 
    categoryDescription, categories.Reverse[categoryDescription]);

// Results:
/*
Description for category ID 3: 'Outdoor Furniture'
Category ID for description 'DINING FURNITURE': 2
Category ID for description 'outdoor furniture': 3
*/ 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-09-19T17:55:40.960

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-09-26T19:28:15.663

This is an old issue but I wanted to add a two extension methods in case anyone finds it useful. The second is not as useful but it provides a starting point if one to one dictionaries need to be supported.

```
 public static Dictionary<VALUE,KEY> Inverse<KEY,VALUE>(this Dictionary<KEY,VALUE> dictionary)
    {
        if (dictionary==null || dictionary.Count == 0) { return null; }

        var result = new Dictionary<VALUE, KEY>(dictionary.Count);

        foreach(KeyValuePair<KEY,VALUE> entry in dictionary)
        {
            result.Add(entry.Value, entry.Key);
        }

        return result;
    }

    public static Dictionary<VALUE, KEY> SafeInverse<KEY, VALUE>(this Dictionary<KEY, VALUE> dictionary)
    {
        if (dictionary == null || dictionary.Count == 0) { return null; }

        var result = new Dictionary<VALUE, KEY>(dictionary.Count);

        foreach (KeyValuePair<KEY, VALUE> entry in dictionary)
        {
            if (result.ContainsKey(entry.Value)) { continue; }

            result.Add(entry.Value, entry.Key);
        }

        return result;
    } 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-05-12T07:21:56.103

Here's my code. Everything is O(1) except for the seeded constructors.

```
using System.Collections.Generic;
using System.Linq;

public class TwoWayDictionary<T1, T2>
{
    Dictionary<T1, T2> _Forwards = new Dictionary<T1, T2>();
    Dictionary<T2, T1> _Backwards = new Dictionary<T2, T1>();

    public IReadOnlyDictionary<T1, T2> Forwards => _Forwards;
    public IReadOnlyDictionary<T2, T1> Backwards => _Backwards;

    public IEnumerable<T1> Set1 => Forwards.Keys;
    public IEnumerable<T2> Set2 => Backwards.Keys;

    public TwoWayDictionary()
    {
        _Forwards = new Dictionary<T1, T2>();
        _Backwards = new Dictionary<T2, T1>();
    }

    public TwoWayDictionary(int capacity)
    {
        _Forwards = new Dictionary<T1, T2>(capacity);
        _Backwards = new Dictionary<T2, T1>(capacity);
    }

    public TwoWayDictionary(Dictionary<T1, T2> initial)
    {
        _Forwards = initial;
        _Backwards = initial.ToDictionary(kvp => kvp.Value, kvp => kvp.Key);
    }

    public TwoWayDictionary(Dictionary<T2, T1> initial)
    {
        _Backwards = initial;
        _Forwards = initial.ToDictionary(kvp => kvp.Value, kvp => kvp.Key);
    }

    public T1 this[T2 index]
    {
        get => _Backwards[index];
        set
        {
            if (_Backwards.TryGetValue(index, out var removeThis))
                _Forwards.Remove(removeThis);

            _Backwards[index] = value;
            _Forwards[value] = index;
        }
    }

    public T2 this[T1 index]
    {
        get => _Forwards[index];
        set
        {
            if (_Forwards.TryGetValue(index, out var removeThis))
                _Backwards.Remove(removeThis);

            _Forwards[index] = value;
            _Backwards[value] = index;
        }
    }

    public int Count => _Forwards.Count;

    public bool Contains(T1 item) => _Forwards.ContainsKey(item);
    public bool Contains(T2 item) => _Backwards.ContainsKey(item);

    public bool Remove(T1 item)
    {
        if (!this.Contains(item))
            return false;

        var t2 = _Forwards[item];

        _Backwards.Remove(t2);
        _Forwards.Remove(item);

        return true;
    }

    public bool Remove(T2 item)
    {
        if (!this.Contains(item))
            return false;

        var t1 = _Backwards[item];

        _Forwards.Remove(t1);
        _Backwards.Remove(item);

        return true;
    }

    public void Clear()
    {
        _Forwards.Clear();
        _Backwards.Clear();
    }
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-05-15T17:02:41.733

Here's an alternative solution to those that were suggested. Removed the inner class and insured the coherence when adding/removing items

```
using System.Collections;
using System.Collections.Generic;

public class Map<E, F> : IEnumerable<KeyValuePair<E, F>>
{
    private readonly Dictionary<E, F> _left = new Dictionary<E, F>();
    public IReadOnlyDictionary<E, F> left => this._left;
    private readonly Dictionary<F, E> _right = new Dictionary<F, E>();
    public IReadOnlyDictionary<F, E> right => this._right;

    public void RemoveLeft(E e)
    {
        if (!this.left.ContainsKey(e)) return;
        this._right.Remove(this.left[e]);
        this._left.Remove(e);
    }

    public void RemoveRight(F f)
    {
        if (!this.right.ContainsKey(f)) return;
        this._left.Remove(this.right[f]);
        this._right.Remove(f);
    }

    public int Count()
    {
        return this.left.Count;
    }

    public void Set(E left, F right)
    {
        if (this.left.ContainsKey(left))
        {
            this.RemoveLeft(left);
        }
        if (this.right.ContainsKey(right))
        {
            this.RemoveRight(right);
        }
        this._left.Add(left, right);
        this._right.Add(right, left);
    }

    public IEnumerator<KeyValuePair<E, F>> GetEnumerator()
    {
        return this.left.GetEnumerator();
    }

    IEnumerator IEnumerable.GetEnumerator()
    {
        return this.left.GetEnumerator();
    }
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-10-02T13:27:39.087

这使用索引器进行反向查找。
反向查找是 O(n) 但它也不使用两个字典

```
public sealed class DictionaryDoubleKeyed : Dictionary<UInt32, string>
{   // used UInt32 as the key as it has a perfect hash
    // if most of the lookup is by word then swap
    public void Add(UInt32 ID, string Word)
    {
        if (this.ContainsValue(Word)) throw new ArgumentException();
        base.Add(ID, Word);
    }
    public UInt32 this[string Word]
    {   // this will be O(n)
        get
        {
            return this.FirstOrDefault(x => x.Value == Word).Key;
        }
    } 
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-09-18T22:05:35.420

以下封装类在 1 个字典实例上使用 linq（IEnumerable Extensions）。

```
public class TwoWayDictionary<TKey, TValue>
{
    readonly IDictionary<TKey, TValue> dict;
    readonly Func<TKey, TValue> GetValueWhereKey;
    readonly Func<TValue, TKey> GetKeyWhereValue;
    readonly bool _mustValueBeUnique = true;

    public TwoWayDictionary()
    {
        this.dict = new Dictionary<TKey, TValue>();
        this.GetValueWhereKey = (strValue) => dict.Where(kvp => Object.Equals(kvp.Key, strValue)).Select(kvp => kvp.Value).FirstOrDefault();
        this.GetKeyWhereValue = (intValue) => dict.Where(kvp => Object.Equals(kvp.Value, intValue)).Select(kvp => kvp.Key).FirstOrDefault();
    }

    public TwoWayDictionary(KeyValuePair<TKey, TValue>[] kvps)
        : this()
    {
        this.AddRange(kvps);
    }

    public void AddRange(KeyValuePair<TKey, TValue>[] kvps)
    {
        kvps.ToList().ForEach( kvp => {        
            if (!_mustValueBeUnique || !this.dict.Any(item => Object.Equals(item.Value, kvp.Value)))
            {
                dict.Add(kvp.Key, kvp.Value);
            } else {
                throw new InvalidOperationException("Value must be unique");
            }
        });
    }

    public TValue this[TKey key]
    {
        get { return GetValueWhereKey(key); }
    }

    public TKey this[TValue value]
    {
        get { return GetKeyWhereValue(value); }
    }
} 
```

* * *

```
class Program
{
    static void Main(string[] args)
    {
        var dict = new TwoWayDictionary<string, int>(new KeyValuePair<string, int>[] {
            new KeyValuePair<string, int>(".jpeg",100),
            new KeyValuePair<string, int>(".jpg",101),
            new KeyValuePair<string, int>(".txt",102),
            new KeyValuePair<string, int>(".zip",103)
        });

        var r1 = dict[100];
        var r2 = dict[".jpg"];

    }

} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-04-05T17:31:02.907

There is a `BijectionDictionary` type available in this open source repo:

[https://github.com/ColmBhandal/CsharpExtras](https://github.com/ColmBhandal/CsharpExtras).

It isn't qualitatively much different to the other answers given. It uses two dictionaries, like most of those answers.

What is novel, I believe, about this dictionary vs. the other answers so far, is that rather than behaving like a two way dictionary, it just behaves like a one-way, familiar dictionary and then dynamically allows you to flip the dictionary using the Reverse property. The flipped object reference is shallow, so it will still be able to modify the same core object as the original reference. So you can have two references to the same object, except one of them is flipped.

Another thing that is probably unique about this dictionary is that there are some tests written for it in the test project under that repo. It's been used by us in practice and has been pretty stable so far.

# oracle10g - oracle 11g和10g和9i的区别——详细对比

> ID：10966340
> 
> 赞同：-5
> 
> 时间：2012-06-10T04:19:11.530
> 
> 标签：oracle10g, oracle11g, oracle9i

任何人都可以帮助我了解各种版本的 oracle db 之间的详细区别。我在这里寻找的不是供应商差异，而是客观差异。任何要了解的链接或网站或书籍。

素佳塔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T04:29:09.820

版本名称的“i”和“g”部分仅代表“Internet”或“Grid”。

Oracle 9i 中的新特性： [http ://www.orafaq.com/wiki/Oracle_9i#Features_introduced](http://www.orafaq.com/wiki/Oracle_9i#Features_introduced)

Oracle 10g 中的新特性： [http ://www.oracle-base.com/articles/10g/articles-10g.php](http://www.oracle-base.com/articles/10g/articles-10g.php)

Oracle 11g 中的新特性： [http ://www.dba-oracle.com/oracle11g/oracle_11g_new_features.htm](http://www.dba-oracle.com/oracle11g/oracle_11g_new_features.htm)

# java - jpa : 如何在 java se 开发中使用 jpa

> ID：10966347
> 
> 赞同：0
> 
> 时间：2012-06-10T04:21:32.463
> 
> 标签：java, jpa, entitymanager

我正在开发一个使用 jpa 将数据保存到数据库的 java se 项目。

现在我为每个数据库操作获得一个新的实体管理器，并在函数调用结束时关闭它。喜欢

```
public void save(T entity){
  em = getNewEntity();
  em.persisty(entity);
  em.close;
} 
```

但是管理多对多关系非常困难。例如，
我有一个与 B 实体有多对多关系的实体。他们有 CascadeType.MERGE。

一旦我创建 A，我创建 B，并运行多个线程来为 A 和 B 生成信息。但有时 B 会保持 A 的过时，如果我合并 B，那么 A 的数据将被清除。

例如 。A 是音乐，B 是音乐专辑，所以一个 B 会有一个 A 列表。另一个线程将读取音乐元数据并获取音乐标签信息并更新 A ，当在 FS 中找到新的 A 时，B 将被更新。
由于实体管理器关闭，B 的 A 列表中的实体已过期，这意味着当 A 更新自身时，B 不知道 A 更新了。一旦合并 B ，jpa 将帮助我们使用 B 的 A 列表中的实体合并 A。

为了解决这个问题，我决定使用一个实体管理器并将所有数据库操作放在一个线程中。然后新的问题就出来了。

当交易处于活动状态并且交易应该为实体之间打开时

```
transaction.begin();
....
transaction.end(); 
```

但是有很多线程正在运行，这些线程也可能会改变实体。

我的问题是：如何在 java se 开发中使用 jpa ？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T17:22:44.130

如果关系不同步，你不能责怪 JPA。应用程序有责任保持关系正常。

> 在 JPA 中，就像在 Java 中一般，维护关系是应用程序或对象模型的责任。

[资源](http://en.wikibooks.org/wiki/Java_Persistence/Relationships#Object_corruption.2C_one_side_of_the_relationship_is_not_updated_after_updating_the_other_side)

正如@home 所说，您需要正确同步。

话虽如此，EntityManager 不是线程安全的，因此您需要以某种方式解决此问题。同步您的应用程序，每个线程使用一个 EntityManager，使用 @PersistenceContext 等。

编辑：[这](https://stackoverflow.com/questions/10930280/synchronize-access-to-jpa-entitymanager)是一个关于同步访问 EntityManager 的问题。我想它可能对你有用。

# json - 支持 JSON 数组的 Hive 的 JSON SerDe

> ID：10966349
> 
> 赞同：7
> 
> 时间：2012-06-10T04:22:00.553
> 
> 标签：json, serialization, hive

我已经尝试过 Amazon 为 EMR 实例提供的 JSON SerDe，如果您需要将 JSON 字典字段寻址/映射到列，效果很好。但是我无法弄清楚如何对 JSON 数组做同样的事情。例如，如果有一个 JSON 数组如下：

> [23123.32，“文本文本”，{“key1”：“value1”}]

有没有办法将数组的第一个元素映射到 Hive 表中的列？嵌入的字典字段呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-26T22:31:07.630

我一直在为同样的问题苦苦挣扎，直到我在 github 上找到了这个 serde - [https://github.com/rcongiu/Hive-JSON-Serde](https://github.com/rcongiu/Hive-JSON-Serde) 启动 hive 后只需使用“添加 jar”命令将其包含在内，它就像一个魅力.

# asp.net-mvc - 无法将枚举值从 DropDownList 保存到实体字段中 - EF Code First MVC3

> ID：10966351
> 
> 赞同：2
> 
> 时间：2012-06-10T04:22:56.827
> 
> 标签：asp.net-mvc, ef-code-first

我有一个 DropDownList，其中包含在呈现视图时正确的项目和值，但选定的值未保存在指定的实体字段 Garage 中。目前在创建或编辑帖子方法中保存和返回的值都是 0（无）。我确定这很简单，但我无法弄清楚...在此先感谢！

模型类：

```
public enum GarageType { None = 0, One = 1, Two = 2, Three = 3, Four = 4 }

public int Garage { get; set; }

[NotMapped]
public GarageType GarageEnumValue
{
    get { return (GarageType)Garage; }
    set{ Garage = (int)value; }
} 
```

控件的 Create 和 Edit 方法都如下所示：

```
var statuses = from Property.GarageType s in Enum.GetValues(typeof(Property.GarageType))
                       select new { ID = (int)s, Name = s.ToString() };
ViewBag.GarageId = new SelectList(statuses, "ID", "Name", statuses.FirstOrDefault().ID); 
```

最后的视图：

```
@Html.DropDownList("GarageId", String.Empty) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T05:16:17.363

使用以下[`DropDownList`](http://msdn.microsoft.com/en-us/library/dd492883.aspx)方法重载

```
@Html.DropDownList("GarageEnumValue", (SelectList)ViewBag.GarageId, String.Empty) 
```

如果您有强类型模型，请使用

```
@Html.DropDownListFor(m => m.GarageEnumValue, (SelectList)ViewBag.GarageId, String.Empty) 
```

两种情况下的第一个参数都应该是您要绑定列表的**属性。**

# php - 不能将字符串偏移量用作数组

> ID：10966352
> 
> 赞同：0
> 
> 时间：2012-06-10T04:23:20.243
> 
> 标签：php

我有一个数组 $aMethods ，它的 print_r 输出是这样的：

```
 Array
 (
     [0] => Array
         (
             [pattern] => 
             [return_media] => 1
             [return_name] => 
         )

 ) 
```

我正在尝试使用以下代码访问“return_media”：

```
 $iReturnMedia = $aMethods[0]->return_media;
 echo $iReturnMedia; 
```

另外，当我尝试这个时：

```
 $iReturnMedia = $aMethods[0]['return_media']; 
```

我收到一条错误消息：不能在...中使用字符串偏移作为数组

但它不起作用， $iReturnMedia 以空白返回。有人可以告诉我我在这里做错了什么吗？

编辑： $aMethods 在 foreach 循环中设置如下：

```
 foreach ($aMethodList as $sMethodGroup => $aMethods) { //insert code from above } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T04:24:48.040

你需要使用：

```
$iReturnMedia = $aMethods[0]['return_media']; 
```

该操作`->`用于访问对象属性。由于您只是在处理嵌套数组，因此您需要使用`[]`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T08:18:39.013

在代码下方找到访问数组值 -

```
foreach ($aMethodList as $sMethodGroup => $aMethods) { 
 echo $aMethods[0]['return_media'];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-10T04:25:13.527

按键访问数组值。

```
$iReturnMedia = $aMethods[0]['return_media'];
echo $iReturnMedia; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-10T04:25:19.197

您像访问数组中的对象一样访问它，您可以这样做：

```
$iReturnMedia = $aMethods[0]['return_media'];
 echo $iReturnMedia; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-10T04:52:22.720

尝试这个，

```
$iReturnMedia = $aMethodList[$sMethodGroup][0]['return_media'];
echo $iReturnMedia; 
```

尝试`var_dump($aMethods)`。它将给出该数组的确切概念......

# c# - 记录到内存然后写入文件，比较内存流与文件

> ID：10966353
> 
> 赞同：2
> 
> 时间：2012-06-10T04:23:51.647
> 
> 标签：c#, performance, file-io, io, stream

这是对我之前的问题[Log to memory 然后 write to file](https://stackoverflow.com/questions/10867875/log-to-memory-and-then-write-to-file/10867962)的引用，实际上是该问题的编辑部分，我在编辑部分询问如果我写入内存会比写入文件更快吗？我做了一个简单的测试，结果令人震惊！我想与社区分享。所以这是代码

```
private void Button1Click(object sender, EventArgs e)
{
    var stopwatch = new Stopwatch();
    stopwatch.Start();
    File.AppendAllText(@"D:\File1.txt", string.Format("{0}Start! : {1}", Environment.NewLine, DateTime.Now.ToString(CultureInfo.InvariantCulture)));
    for (int i = 0; i < 6; i++)
    {
        for (int j = 0; j < 1000000; j++)
        {
             File.AppendAllText(@"D:\File1.txt", string.Format("{0}{1}:{2}", Environment.NewLine, i.ToString(CultureInfo.InvariantCulture), j.ToString(CultureInfo.InvariantCulture)));
         }
    }
    File.AppendAllText(@"D:\File1.txt", string.Format("{0}Done!{1}", Environment.NewLine, DateTime.Now.ToString(CultureInfo.InvariantCulture)));
    stopwatch.Stop();
    File.AppendAllText(@"D:\File1.txt",
                       string.Format("{0}{1}:{2}",Environment.NewLine,              stopwatch.Elapsed.ToString(), stopwatch.ElapsedMilliseconds.ToString(CultureInfo.InvariantCulture)));
    MessageBox.Show("Done!");
}

private void Button2Click(object sender, EventArgs e)
{
     var stopwatch = new Stopwatch();
     using (var mem = new MemoryStream())
     {
         using (var binaryWriter = new BinaryWriter(mem))
         {
             stopwatch.Start();
             {
                 binaryWriter.Write("start! : " + DateTime.Now.ToString(CultureInfo.InvariantCulture));
                 for (int i = 0; i < 6; i++)
                 {
                     for (int j = 0; j < 1000000; j++)
                     {
                         binaryWriter.Write(i.ToString(CultureInfo.InvariantCulture) + ":" + j.ToString(CultureInfo.InvariantCulture));
                     }
                 }
                 stopwatch.Stop();
                 binaryWriter.Write("Done! " + DateTime.Now.ToString(CultureInfo.InvariantCulture));
                 binaryWriter.Write(stopwatch.Elapsed.ToString() + ":" + stopwatch.ElapsedMilliseconds.ToString(CultureInfo.InvariantCulture));
                 binaryWriter.Flush();
                 var file = new FileStream(@"D:\File2.txt", FileMode.Create);
                 mem.WriteTo(file);
             }
         }
     }
     MessageBox.Show("Done!");
} 
```

因为代码应该很容易理解

![性能比较](../Images/9671c875d5edd0bc7726b4046f113c4c.png)

```
Elapsed time in File1.txt = 00:50:24.5654918  
Elapsed milliseconds in File1.txt = 3024565  
Elapsed time in File2.txt = 00:00:04.7430152  
Elapsed milliseconds in File2.txt = 4743 
```

**因此，正如您自己所见，大约有 50 分钟的差异！**这可能是导致性能不佳的真正原因，如果您将所有内容直接记录到 IO 文件，而不使用内存流或任何用于记录的自定义工具，OTOH***与 File.AppendAllText 的 50 分钟相比，使用 MemoryStream 只需要大约 4 和四分之一第二***。（*我仍然对为什么 Windows 资源管理器中显示的时间与 stopwatch.ShowElapasedTime 最后显示的文件中的时间不对应感到困惑，但尽管如此，即使我们看到 Windows 资源管理器时间，它仍然快了大约 45 分钟！*）所以，这可能是一个非常有用的东西，我想分享它！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T04:26:17.493

这是因为 File.AppendAllText 打开文件、写入、刷新缓冲区并关闭它。如果您保持日志文件打开并使用流向其写入（而不是 MemoryStream），您将获得非常接近您使用 MemoryStream 看到的结果 - 它甚至可能无法区分。

试试看。

# node.js - 如何在 express 中从 app 对象中获取请求对象？

> ID：10966357
> 
> 赞同：4
> 
> 时间：2012-06-10T04:24:51.597
> 
> 标签：node.js, express

在快递中，您调用`var app = module.exports = express.createServer();`which 创建一个新`HTTPServer`对象。我想`req`从此`app`( `HTTPServer`) 对象访问当前对象。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-10T05:13:09.157

该`req`对象仅在底层`HTTPServer`实际收到请求时创建，并且仅在请求被处理期间持续存在。所以在回调的上下文之外谈论它并没有真正的意义。

在回调期间，您可以简单地从其他地方的会话对象复制适当的数据，并在您的 websockets 代码中使用该副本。但是你不能指望请求对象，甚至会话对象，在你处理完请求后仍然存在。

显示一个小代码示例会很有帮助；听起来你有一个“XY 问题”（你想完成一个目标 X，并且你已经确定技术 Y 是正确的方法，而实际上技术 Z 可能会更好）。

# ruby-on-rails - has_one 与同一类的关系

> ID：10966360
> 
> 赞同：5
> 
> 时间：2012-06-10T04:26:00.710
> 
> 标签：ruby-on-rails, activerecord

我有以下`Person`类，它的父类也是另一个人。我似乎无法弄清楚如何让关系发挥作用。

```
class Person < ActiveRecord::Base
  attr_accessible :mom, :dad

  has_one :mom, :class_name => 'Person', :primary_key => "mom_id", :foreign_key => "id"
  has_one :dad, :class_name => 'Person', :primary_key => "dad_id", :foreign_key => "id"    
end 
```

我已通过迁移将“mom_id”和“dad_id”作为整数添加到我的模型中。但是，当我使用 时，在设置and后`rails console`我无法访问`mom`或`dad`属性。他们还是回来了。`mom_id``dad_id``nil`

任何指向我做错了什么的指针？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-10T05:15:47.927

我同意@Andrew，这应该是`belongs_to`

```
belongs_to :mom, :class_name => "Person", :foreign_key => "mom_id"
belongs_to :dad, :class_name => "Person", :foreign_key => "dad_id" 
```

# c++ - C++ srand，rand 在一个 DLL 中的奇怪行为

> ID：10966363
> 
> 赞同：5
> 
> 时间：2012-06-10T04:26:57.850
> 
> 标签：c++, dll, random, srand

我正在为 AI 竞赛做主持人，并且有一个 randomBot 可以选择随机的可能值。

该机器人有 2 个导出函数：Init(_seed) 和 MakeMove()

为了玩完全相同的游戏，主机为每个机器人定义了种子值。并将其传递给 Init 函数。

random bot 的 Init 函数有一个 srand(_seed) 函数调用。random bot 的 MakeMove 函数有一个 rand() 函数调用。

现在的问题是，在加载 2 个机器人后，每个游戏都应该具有相同的种子值，但它们是不同的。

据我所知，srand 应该为每个模块/线程存储它的值，而不是共享它。

我做了一个测试并创建了一个函数 mysrand 和 myrand ，它们不会分别通过调用 srand 和 rand 导出。

我用 mysrand 和 myrand 替换了导出函数中的 srand 和 rand ......它起作用了......

我知道为什么会发生这种情况，但不确定...

那么为什么它会发生以及如何避免它，因为我希望参赛者在导出的函数中使用他们想要的任何函数（不想使用我的代理函数）。

谢谢。

我正在使用 windows，编译器：gcc、visual C++、borland C++ builder

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-10T06:21:59.210

如果你想获得一致的行为，`<random>`图书馆可能是一个更好的选择。您可以控制 RNG 状态的存储位置，并且引擎可以在实现之间产生相同的值（尽管标准分布不需要在实现之间产生相同的输出）。

```
#include <random>
#include <iterator>
#include <algorithm>
#include <iostream>

int main() {
    std::mt19937 eng;
    std::generate_n(std::ostream_iterator<int>(std::cout, " "), 10, [&] {
        // A simple example distribution function; not intended for real use.
        return static_cast<int>(eng()/static_cast<double>(eng.max() + 1ull) * 20.0) + 1;
    });
} 
```

这应该在所有实现上输出以下内容：

> 17 3 19 17 3 20 19 5 13 7

如果您只需要在实现中而不是跨实现的一致行为，那么您可以使用标准分布，并且您仍然可以控制 RNG 的状态。

```
#include <random>
#include <iterator>
#include <algorithm>
#include <iostream>

int main() {
    std::mt19937 eng;
    std::uniform_int_distribution<> dist(1,20);
    std::generate_n(std::ostream_iterator<int>(std::cout, " "), 10, [&] { return dist(eng); });
} 
```

标准发行版应该比编写自己的发行版更受欢迎。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-10T04:31:13.033

> 据我所知，srand 应该为每个模块/线程存储它的值，而不是共享它。

这不一定是真的。从`rand`Ubuntu 的手册页：

> ```
>  The function rand() is not reentrant or thread-safe, since it uses hid‐
>    den state that is modified on each call.  This might just be  the  seed
>    value to be used by the next call, or it might be something more elabo‐
>    rate.  In order to get reproducible behavior in a threaded application,
>    this  state must be made explicit; this can be done using the reentrant
>    function rand_r(). 
> ```

如果您的 C 库实现没有明确使用本地状态而不是共享状态，您最终可能会破坏 RNG 状态`rand`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-10T04:48:22.330

您可以将每个 dll 静态链接到 CRT，它将为每个 dll 提供自己的 rand 状态。

# iphone - NSFetchedResultsController 对不同的部分进行不同的排序（升序/降序）？

> ID：10966365
> 
> 赞同：3
> 
> 时间：2012-06-10T04:27:43.700
> 
> 标签：iphone, objective-c, ios, sorting, core-data

在我的应用程序中，我有一个任务列表（不，它不仅仅是另一个待办事项应用程序），我`UITableView`使用`NSFetchedResultsController`. 以下是相关的初始化代码：

```
NSSortDescriptor *dueDateSortDescriptor = [NSSortDescriptor sortDescriptorWithKey:@"due" YES];
NSSortDescriptor *completionSortDescriptor = [NSSortDescriptor sortDescriptorWithKey:@"completed" ascending:YES];
[fetchRequest setSortDescriptors:[NSArray arrayWithObjects:completionSortDescriptor, dueDateSortDescriptor, nil]];

_fetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:fetchRequest managedObjectContext:context sectionNameKeyPath:@"completed" cacheName:nil]; 
```

这样做是对任务进行排序，使我在顶部有一个不完整的任务部分，将首先到期的任务排序在顶部，然后将到期的任务进一步向下排序。这一切都有效。

**但是**，这意味着第二部分，即已完成任务的部分，也是这样排序的，因此最早到期的任务在最前面。我想要做的是更改它，以便第二部分以相反的方式排序（按降序排列），但第一部分保持按升序排序。这甚至可能吗？我该怎么办？

**我为什么要这样做：**它目前的工作方式，第二部分顶部的任务（因此也是最明显的）是很久以前完成的任务。用户更有可能希望查看最近完成的任务（如果不小心选中了则取消选中），并且可能具有较近截止日期的任务是最近完成的。如有必要，我很乐意为 Core Data 任务对象添加一个单独的完成日期字段（这还不是一个运输应用程序，所以我可以随意更改数据格式）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T04:51:24.990

~~这在使用 NSFetchedResultsController 时是不可能的。您必须手动获取数据并实现 UITableView 的委托方法。~~

**编辑**：哇，我的错误，有一个相当简单的解决方案。设置两个排序描述符：

*   第一个用于`completedDate`（降序）。`nil`对于所有未完成的任务，该字段都是相同的 ( )。

*   `addedDate`为（升序）添加第二个。它将按完成日期排序（最新的在前），但在第一部分中您不会有任何已完成的日期，因此它将使用添加的日期（最旧的在前）。

对于第二部分，它将只使用`completedDate`（最新的优先），所以你去。

# iphone - UITextField inputview 属性出现问题，拉起自定义 UIPickerView

> ID：10966366
> 
> 赞同：2
> 
> 时间：2012-06-10T04:27:49.010
> 
> 标签：iphone, objective-c, uitextfield, uipickerview, inputview

我一直无法从文本字段的 inputview 属性中提取自定义 UIPickerView。我已经为此工作了一段时间，做了一些研究，并尝试根据 Apple 的 UICatalog 示例组合一个单独的项目。

但是，每当我在文本字段内点击时，我得到的只是一个黑屏，它会弹出来代替选择器视图。我确定我忽略了一些东西，但我一直在寻找几天任何帮助将不胜感激。

请记住，这是我的测试项目，看看我是否可以将此功能添加到我的其他应用程序以及我尝试从 UICatalog 应用程序复制的大量代码。抱歉，如果有任何不合理的地方，请随时提出您可能遇到的任何问题。谢谢你。

```
//  ViewController.h
//  TestPicker

#import <UIKit/UIKit.h>

@interface ViewController : UIViewController<UITextFieldDelegate,UIPickerViewDelegate,UIPickerViewDataSource>{

UIPickerView *picker;
     //The picker view the textfield responds to.

IBOutlet UITextField *myText;
     //The textfield which has the input view of a picker.

NSArray *testArray;
     //The array which values are loaded into the picker.
}

@end

//  ViewController.m
//  TestPicker

#import "ViewController.h"

@interface ViewController ()

@end

@implementation ViewController

- (void)viewDidLoad
{
    picker.delegate=self;
    picker.dataSource=self;
    myText.delegate=self;

    [self createPicker];

    [super viewDidLoad];
// Do any additional setup after loading the view, typically from a nib.
}

- (void)viewDidUnload
{
    myText = nil;
    [super viewDidUnload];
    // Release any retained subviews of the main view.
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone) {
        return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
    } 
    else {
        return YES;
    }
}

-(BOOL)textFieldShouldBeginEditing:(UITextField *)textField{
    picker = [[UIPickerView alloc] initWithFrame:CGRectZero];
    myText.inputView=picker;
    return YES;
}

-(void)textFieldDidBeginEditing:(UITextField *)textField{

}

- (NSString *)pickerView:(UIPickerView *)pickerView titleForRow:(NSInteger)row forComponent:(NSInteger)component
{
    NSString *returnStr = @"";

    if (pickerView == picker)
    {
        if (component == 0)
        {
            returnStr = [testArray objectAtIndex:row];
        }
        else
        {
            returnStr = [[NSNumber numberWithInt:row] stringValue];
        }
    }

    return returnStr;
}

- (NSInteger)pickerView:(UIPickerView *)pickerView numberOfRowsInComponent:(NSInteger)component
{
    return [testArray count];
}

- (NSInteger)numberOfComponentsInPickerView:(UIPickerView *)pickerView
{
    return 1;
}

- (void)createPicker
{
    testArray = [NSArray arrayWithObjects:
                            @"John Appleseed", @"Chris Armstrong", @"Serena Auroux",
                            @"Susan Bean", @"Luis Becerra", @"Kate Bell", @"Alain Briere",
                        nil];

    picker = [[UIPickerView alloc] initWithFrame:CGRectZero];

    picker.showsSelectionIndicator = YES;   // note this is default to NO

    picker.delegate = self;
    picker.dataSource = self;

}

@end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T05:33:04.080

问题出在这种方法中：

```
-(BOOL)textFieldShouldBeginEditing:(UITextField *)textField{
    picker = [[UIPickerView alloc] initWithFrame:CGRectZero];
    myText.inputView=picker;
    return YES;
} 
```

您已经在 createPicker 方法中创建了选取器，从 viewDidLoad 调用，因此这会创建另一个实例（此实例不会将委托或数据源设置为 self，因为这些是在您创建的第一个实例上设置的）。如果您只是删除此方法的第一行，它应该可以工作。

对您的代码的另外两条评论。viewDidLoad 方法中的前两行没有做任何事情，因为您还没有创建选择器——它们应该被删除。您还需要实现 pickerView:didSelectRow:inComponent: 方法，以便将选择器的选定值放入文本字​​段。

# php - mod_rewrite 和 PHP 的错误？

> ID：10966368
> 
> 赞同：0
> 
> 时间：2012-06-10T04:28:55.280
> 
> 标签：php, apache, mod-rewrite

我遇到了一个错误，我不确定它的来源。我将 mod_rewrite 用于以下内容：

```
 RewriteRule ^stuff$ index.php?page=stuff [L] 
```

它工作得很好，但是当我使用

```
 RewriteRule ^(.+?)$ index.php?page=$1 [L] 
```

CSS 不再应用于页面，并且代码似乎没有读取 GET 请求。

有人可以详细说明为什么会发生这种情况吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-10T04:34:19.553

如果文件存在，则添加重写条件以不重写并使用 QSA 标志以允许附加参数：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*)$ index.php?page=$1 [L,QSA] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T04:38:30.210

由于您的查询字符串已转换为类似目录的结构，因此如果您未使用任何路径披露，apache 将检查目录。

因此，如果您像这样包含 css 文件： `<link href="skins/style.css">`

您需要公开文件的完整网络路径：

```
<link href="http://site.com/skins/style.css">` 
```

此外，对于您的 css 文件中的所有图像，您需要执行相同的操作，包括完整的 web 路径以避免将来重写时出现问题。

# layout - 三星 Galaxy Tab 1 布局问题

> ID：10966370
> 
> 赞同：0
> 
> 时间：2012-06-10T04:29:48.457
> 
> 标签：layout, tabs, resize, galaxy

我在 Galaxy tab original 7" 上运行我的应用程序时遇到问题。它似乎使所有内容都大了 1.5 倍，即如果我在布局中为 textSize 指定 40dip，当我在平板电脑上运行它时它将显示为 60 dip .

我尝试弄乱显示指标并将密度和密度Dpi 更改为 1。（当我在 Galaxy 选项卡 2 中运行显示指标的 toString 时，它们都是 1，而 Galaxy 选项卡 1 的值为 1.5）

该应用程序在我测试过的每部手机以及 Galaxy tab 2 上都运行良好，所以我无法弄清楚问题出在哪里。我什至尝试使用大小为 40dip 的 textView 创建一个虚拟应用程序，但它仍然将其转换为 60。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T04:34:53.843

这个问题的答案对你有帮助吗？似乎他遇到了相同（或相似）的问题。

[模拟器与设备上的Android布局](https://stackoverflow.com/questions/10057410/android-layout-on-emulator-vs-device)

[Android，关于用户界面设计](https://stackoverflow.com/questions/8988473/android-concerning-the-user-interface-design)

# visual-studio-2010 - 签入项目时如何自动创建工作项？

> ID：10966377
> 
> 赞同：2
> 
> 时间：2012-06-10T04:32:24.633
> 
> 标签：visual-studio-2010, tfs, c#-3.0, tfsbuild

我想在 tfs 2010 中签入项目时自动创建一个工作项（例如任务并分配给管理员）。感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T06:35:59.090

您可以配置 CI 以构建每个签入并自定义构建过程以创建任务工作项并将其分配给管理员。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T07:40:42.447

您可以设置 WCF 服务端点并订阅各种 TFS 事件。

检查[此](http://go4answers.webhost4life.com/Example/consume-events-tfs-3530.aspx)答案 5 ，例如 Checkin-Notification。
一旦你成功了，[在这里](http://social.msdn.microsoft.com/Forums/pl-PL/tfsgeneral/thread/1ff5415e-0ef2-4c65-b0b7-a109187adf51)查看关于如何使用 TFS-SDK 生成任何工作项的介绍。

# java - Java BCEL用sipush创建方法？

> ID：10966387
> 
> 赞同：0
> 
> 时间：2012-06-10T04:34:59.397
> 
> 标签：java

好吧，我正在尝试重新创建此方法：

```
 public int getBaseX() {
    return this.x + 10000;
} 
```

它返回这些指令

```
0 aload_0
1 getfield #18 <TestClass.x>
4 sipush 10000
7 iadd
8 ireturn 
```

现在我在使用 sipush 时遇到了麻烦，iadd。

```
 ClassGen injCG = cg;   
        ConstantPoolGen cpg = injCG.getConstantPool();
        InstructionList il = new InstructionList();
        MethodGen mg = new MethodGen(Constants.ACC_PUBLIC, f.getType(), Type.NO_ARGS, null,
                name, injCG.getClassName(), il, cpg);
        InstructionFactory instrF = new InstructionFactory(injCG, cpg);
        if (!f.isStatic()) il.append(new org.apache.bcel.generic.ALOAD(0));
        il.append(instrF.createFieldAccess(cg.getClassName(), f.getName(), f.getType(),
                (f.isStatic() ? Constants.GETSTATIC : Constants.GETFIELD)));
        il.append(InstructionFactory.createPop(1000));
        il.append(InstructionFactory.createReturn(f.getType()));
        //il.append(InstructionFactory.createReturn(f.getType()), InstructionFactory.createDup(1000));
        mg.setMaxLocals();
        mg.setMaxStack();
        injCG.addMethod(mg.getMethod()); 
```

这就是我尝试过的，但失败了。

# c - 如何在并行重复调用中生成不相关的随机数？

> ID：10966390
> 
> 赞同：0
> 
> 时间：2012-06-10T04:36:03.623
> 
> 标签：c, random, parallel-processing, openmp

我想写一个函数，它会被其他函数多次重复调用。在这个函数内部，它应该生成很多随机数，这部分将被并行处理。如果只运行一次，则可以为每个线程选择不同的种子，以便随机数不相关。但是，如果此函数将被第二次调用，则似乎随机数会重复，除非在以后的调用中再次更改种子。

所以我的问题是，是否有一种生成随机数或重置种子的好方法，以便重复调用此函数以及不同线程生成的随机数真的是随机的？

我需要在 openMP 中执行此操作。是否可以在每次调用函数后分别存储每个线程的生成器状态，以便下次调用该函数时，随机数生成器从上一个状态开始，继续生成不相关数？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T04:43:27.090

首先使用像 MT 这样的强随机数生成器。为了解决您的线程问题，请使用互斥锁保护一个生成器，该互斥锁将为每个线程生成种子。然后在每个线程上使用不同的生成器。
关键是初始化您需要的最少次数，因为您可能需要为种子生成器设置全局程序，并为每个线程的生成器设置线程本地存储。

# c - C(Linux) 中的 fopen 返回“打开的文件太多”

> ID：10966392
> 
> 赞同：2
> 
> 时间：2012-06-10T04:36:23.483
> 
> 标签：c, linux, fopen

```
static char filename[128] = "trace.txt";

g_file = fopen(filename, "w");
if(NULL == g_file)
{
       printf("Cannot open file %s.error %s\n",filename,strerror(errno));
       exit(1);
} 
```

我正在尝试以写入模式（在我的工作目录中）打开一个名为 trace.txt 的空文本文件。程序正在我的目录中创建一个空文件 trace.txt。但是检查（NULL == g_file）返回 true 并且它返回错误代码 24（打开的文件太多。）。知道为什么会这样。这是我在程序中打开的第一个文件。

令人惊讶的是，代码在我的工作目录中创建了一个指定名称的空文件。但是由于某种原因，检查空文件指针成功了。？:(

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-10T06:58:20.433

您可能有文件描述符泄漏。
如果你的代码一直打开文件，从不关闭它们，你迟早会达到限制，然后`fopen`会失败。

您可以通过打印打开文件时获得的文件描述符编号来检查这一点。如果他们继续增长，你就有泄漏。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-10T04:53:36.030

这很可能是由于您的系统达到了允许的最大打开文件句柄。

您可以通过运行以下命令轻松测试：

```
$ dd if=/dev/urandom of=test.dat bs=16 count=1 
```

如果您没有文件句柄，这应该会提供相同或相似的错误。

您可以使用以下一些命令解决此问题：

要查看允许打开的最大文件数：

```
$ cat /proc/sys/fs/file-max 
```

要查看当前打开的文件（记住这包括设备文件、套接字等）：

```
$ lsof 
```

您还可以使用`lsof`来获取打开文件的计数：

```
$ lsof | wc -l 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-10T04:42:58.643

这看起来与您遇到的问题相似，但我不完全确定它是否会帮助您解决问题。也许值得一瞧：

[在 C 中写入文件的问题](https://stackoverflow.com/questions/5607533/problem-with-writing-to-file-in-c)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-07-22T10:37:26.697

正确，我遇到了同样的错误消息，发现我试图在函数中关闭文件，但不是在打开文件的位置。所以我然后关闭了它打开的功能，后来一切都很好。

# c# - 如何使用 Facebook 授权我的应用

> ID：10966393
> 
> 赞同：0
> 
> 时间：2012-06-10T04:36:39.887
> 
> 标签：c#, facebook, windows-phone-7

我知道我见过一些应用程序让我使用 Facebook 登录，但从未向我显示授权屏幕。在我的一生中，我无法弄清楚如何使用 Windows Phone 7 做到这一点。我能得到的最好的方法是使用 Facebook for C# SDK 在 WebView 中获取授权屏幕。这看起来很可怕，页面甚至看起来都没有移动设备。

我到处寻找答案，但一无所获。想知道是否有人可以为我指明正确的方向以使其发挥作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T08:13:17.917

是的，我也看到了这种应用程序（例如，Spotify 提示您输入您的 Facebook 帐户凭据，而不是使用正常的授权流程）。我最好的猜测是，他们要么是某种高级合作伙伴，并且可以访问某些私有 API，要么他们使用自定义授权流程（例如，当您在网站上授权应用程序时，系统会将授权密钥保存在数据库中。相同的应用程序 id/然后在 Windows Phone 应用程序中使用秘密，您需要做的就是输入您的电子邮件/用户名，以便系统找到之前保存的授权密钥）。

我也不喜欢使用 WebBrowser 控件显示 Facebook 登录/身份验证的方法（主要是因为 UI 不一致），但我想说在大多数情况下这仍然是要走的路（因为这是官方和推荐的方式授权应用程序和所有其他方法对我来说似乎很老套，也有它们的缺点）。

您将希望使用“服务器端身份验证”方法。以下文档描述了它的工作原理：[服务器端身份验证](https://developers.facebook.com/docs/authentication/server-side/)（另请阅读[OAuth 对话框](https://developers.facebook.com/docs/reference/dialogs/oauth/)文档以了解如何配置身份验证对话框）。您可以通过传递`display`参数（到`touch`或`wap`）来更改 UI 的外观。

请注意，`display=touch`目前在 Windows Phone 中已损坏 - Facebook 始终回退到`wap`已弃用的位置，并将根据[2012 年 7 月的更新](https://developers.facebook.com/roadmap/)将其删除（对应情况：[Facebook API 不能与 Windows Phone 应用程序一起使用](https://developers.facebook.com/bugs/355102764525510)）。它也是 Facebook C# SDK 项目页面上的已知问题之一：[Facebook C# SDK - 已知问题](http://csharpsdk.org/docs/known-issues)。

希望这能澄清一些事情。

# haskell - 有人可以向我解释 gtk2hs 拖放吗，listDND.hs 演示只是不适合我吗？

> ID：10966397
> 
> 赞同：1
> 
> 时间：2012-06-10T04:38:05.330
> 
> 标签：haskell, drag-and-drop, gtk2hs

正如标题所说，我只是不明白DND（或者我理解这个概念并且我理解回调的顺序，我只是不明白如何设置DND以供实际使用。）我想说我以前在 C 中做过 DND 的东西，但考虑到我从来没有真正做到过......

所以我正在尝试（并且大部分成功，保存DND）编写一个文本编辑器（使用gtksourceview，因为它内置了代码突出显示。）如果你想要的话，原因如下。无论如何，对于 gtk2hs 并没有真正好的 DND 演示或教程（listDND.hs 在我的脑海中翻译得不好。）所以我要的是在窗口小部件上演示简单 DND 的代码（例如。 ) 理想情况下，它应该接受来自其他窗口（例如 Thunar）的丢包并以字符串形式打印出信息。我想我可以从那里拿走它...

* * *

原因：我正在运行一个相当轻量级的设置、dwm 和一些 gtk+2 程序。我真的不想引入 gtk+3 来从存储库（Arch Linux）中获取当前的 gedit。目前，我正在使用 geany 来满足我所有的文本编辑需求，但是，geany 对于编辑配置文件。此外，geany 并不关心我选择的终端 (st;)，所以我什至没有将它用作 IDE 的好处。这意味着我想要一个带有语法突出显示的轻量级文本编辑器。我可以配置 emacs 或 vim 或其他东西，但在我看来，这更像是一种 hack，而不是一个适当的解决方案。于是我的项目诞生了。它大部分都在工作（除了DND，剩下的就是适当的多标签支持。）诚然，如果我用C编写它，我可能会解决这个问题，但是没有'

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T21:45:18.377

按照[我链接的教程](https://live.gnome.org/GnomeLove/DragNDropTutorial)和[gtk2hs 文档](http://hackage.haskell.org/packages/archive/gtk/latest/doc/html/Graphics-UI-Gtk-General-Drag.html)，我编写了以下接收文本的最小应用程序。我很快会将它添加到 gtk2hs 演示目录中。

```
import Control.Monad.IO.Class
import Graphics.UI.Gtk

main = do
    initGUI
    w <- windowNew
    l <- labelNew $ Just "drag here lol"
    onDestroy w mainQuit
    containerAdd w l
    dragDestSet w [DestDefaultMotion, DestDefaultDrop] [ActionCopy]
    dragDestAddTextTargets w
    w `on` dragDataReceived $ \dc pos id ts -> do
        s <- selectionDataGetText
        liftIO . putStrLn $ case s of
            Nothing -> "didn't understand the drop"
            Just s  -> "understood, here it is: <" ++ s ++ ">"
    widgetShowAll w
    mainGUI 
```

我不知道 thunar 是否提供文本作为其选择格式之一，但如果没有，它提供的格式肯定会记录在某处。

# c# - c#如何打印没有窗体边框的窗体

> ID：10966400
> 
> 赞同：0
> 
> 时间：2012-06-10T04:38:38.677
> 
> 标签：c#

我有一个窗体。我想打印没有窗口外观的表单内容。我的意思是我想像收据一样打印它，没有窗口边框。我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T06:27:20.800

您可以参考 MSDN 示例，了解如何[打印到 Windows 窗体](http://msdn.microsoft.com/en-us/library/6he9hz8c.aspx)，将正在打印的表面从窗体更改为面板控件，这将使您能够无边框打印。您的内容必须添加到面板而不是表单，但它会起作用。这是 MSDN 示例的修改示例。

```
public class Form1 : Form
{
    private Panel printPanel = new Panel();
    private Button printButton = new Button();
    private PrintDocument printDocument1 = new PrintDocument();

    public Form1()
    {
        printPanel.Size = this.ClientSize;
        this.Controls.Add(printPanel);
        printButton.Text = "Print Form";
        printButton.Click += new EventHandler(printButton_Click);
        printDocument1.PrintPage += new PrintPageEventHandler(printDocument1_PrintPage);
        printPanel.Controls.Add(printButton);

    }

    void printButton_Click(object sender, EventArgs e)
    {
        CaptureScreen();
        printDocument1.Print();
    }

    Bitmap memoryImage;

    private void CaptureScreen()
    {
        Graphics myGraphics = printPanel.CreateGraphics();
        Size s = printPanel.Size; 
        memoryImage = new Bitmap(s.Width, s.Height, myGraphics);
        Graphics memoryGraphics = Graphics.FromImage(memoryImage);
        Point screenLoc = PointToScreen(printPanel.Location); // Get the location of the Panel in Screen Coordinates
        memoryGraphics.CopyFromScreen(screenLoc.X, screenLoc.Y, 0, 0, s);
    }

    private void printDocument1_PrintPage(System.Object sender,
           System.Drawing.Printing.PrintPageEventArgs e)
    {
        e.Graphics.DrawImage(memoryImage, 0, 0);
    }

    public static void Main()
    {
        Application.Run(new Form1());
    }
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-10T04:48:19.097

你可以通过做这样的事情来获得一个空白屏幕

```
this.FormBorderStyle = System.Windows.Forms.FormsBorderStyle.None;
this.ControlBox = false;
this.Text = String.Empty; 
```

# iis - 如何托管多个 iis 网站干净地映射到不同的端口？

> ID：10966403
> 
> 赞同：1
> 
> 时间：2012-06-10T04:39:40.923
> 
> 标签：iis, web, localhost

我无法找到有关此信息的信息，即使可以访问我的公司域控制器，我仍然看不到是什么配置导致了我想在我的家庭服务器上模仿的相同行为。

我正在家用 PC 上的测试环境中工作，并且想要以下行为。请注意，除了我的本地机器之外，我不需要任何地方都可以访问这些站点，我只是想学习。

我的目标：

将 IIS 配置为托管多个站点，可通过映射到不同端口的“别名”访问。例如：

*   主页 -> 本地主机：81
*   测试-> 本地主机：82
*   开发 -> 本地主机：83

此外，我希望地址栏中的 url 实际上是它在左边所说的，而不是简单地重定向，BLEH！因此，如果我在地址栏中键入“home/”，它应该会在“ [http://home/](http://home/) ”处加载页面。

我怎样才能做到这一点？谢谢... ;）

到目前为止，这是我在网站绑定中配置的内容，但没有雪茄……

![在此处输入图像描述](../Images/d820a03450987cd2b9927a49db73ee72.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T04:51:01.490

首先您需要编辑您的主机文件（可能是 C:\WINDOWS\System32\drivers\etc），以便将 home 解析为例如 localhost，添加如下记录：

```
127.0.0.1 home
127.0.0.1 test 
```

...

然后您应该能够将您的 IIS 站点设置为主机名作为 home，但将端口保留为默认值 80。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T21:30:52.197

当我在 IIS 中创建站点时，我选择 IP “All Unassigned”，然后创建一个唯一端口。

我通过外部世界访问我的网站，如下所示：

[http://mbdev.myftp.biz:8004](http://mbdev.myftp.biz:8004)

[http://mbdev.myftp.biz:8006](http://mbdev.myftp.biz:8006)

这些都去演示网站。

# ajax - MVC JSON AJAX 日期时间格式

> ID：10966404
> 
> 赞同：1
> 
> 时间：2012-06-10T04:39:54.960
> 
> 标签：ajax, json, asp.net-mvc-3

您好我正在尝试使用 AJAX 来编辑网格。

首先我制作了模型（BPViewModel）：

```
 public DateTime Day { get; set; } 
```

存储库：

```
public static IList<BPViewModel> All()
    {
        IList<BPViewModel> result = (IList<BPViewModel>)HttpContext.Current.Session["BloodPressures"];
        //     string id = "2222222222";
        //    id = Session["PHN"].ToString();
        if (result == null)
        {
            HttpContext.Current.Session["BloodPressures"] = result =
                (from bloodpressure in new DALDataContext().BloodPressures
                 select new BPViewModel
                 {
                 .......
                     Day = bloodpressure.Day 
                 }).ToList();
        }

        return result;
    } 
```

在控制器中，我使用“获取数据”

```
 public ActionResult BloodPressure_Read([DataSourceRequest] DataSourceRequest request)
        {
         return Json(BPRepository.All().ToDataSourceResult(request));
        } 
```

在视图中：

```
@(Html.Kendo().Grid<BPViewModel>()

    .Name("Grid")
    .Columns(columns =>
    columns.Bound(p => p.Day).Format("{0:d}"); 
```

日期显示为 1/1/2012；但是，当我编辑它（使用 Ajax）时，它显示为 Sun Jan 1 00:00:00 PST 2012！当我尝试更新该行时，我得到“Day is invalid Date.

我尝试使用 bloodpressure.Day.ToShortDateString()，它不起作用。

知道如何将日期转换为 yyyy,mm,dd 吗？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T17:58:59.283

作为参考，这里是 MSDN 上有关日期时间格式的一些阅读材料：http: [//msdn.microsoft.com/en-us/library/8kb3ddd4](http://msdn.microsoft.com/en-us/library/8kb3ddd4)

也就是说，您是否尝试过以下简单的方法：

```
yourdate.ToString("yyyy-MM-dd"); 
```

# macos - Textmate，从项目搜索中排除文件（类型？）

> ID：10966406
> 
> 赞同：8
> 
> 时间：2012-06-10T04:40:57.853
> 
> 标签：macos, development-environment, textmate, text-editor

在 TextMate 中，当我用 apple-shift-F 搜索我的项目时，我必须等待一个旋转的沙滩球告诉我我没有足够的内存来加载 development.log 。如何从项目范围的搜索中排除 (development).log？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-05T19:55:52.127

在高级的首选项下，有一个文件和文件夹模式的设置。要了解如何使用它们，请看[这里](http://www.rngtng.com/2009/06/18/pimp-my-textmate-how-to-speed-up-search-load/)。

# heroku - Heroku 和 Zerigo 设置问题

> ID：10966407
> 
> 赞同：2
> 
> 时间：2012-06-10T04:41:04.890
> 
> 标签：heroku

**EDIT2：等待查看我的更改是否成功。**

* * *

编辑：我使用命令行 Zerigo install 命令重新安装了所有内容（最初的问题是手动设置）。现在的问题是：我设置的自定义域无法正常工作。访问自定义域只会在 Chrome 中返回错误：“糟糕！Google Chrome 找不到 www.myapp.com”，即使我添加的自定义域是“www.myapp.com?

* * *

[我一直在尝试按照https://devcenter.heroku.com/articles/custom-domains](https://devcenter.heroku.com/articles/custom-domains)和[https://devcenter.heroku.com/articles/zerigo_dns](https://devcenter.heroku.com/articles/zerigo_dns)上的说明在我的 Cedar Heroku 应用程序上设置自定义域。

在 Zerigo 上设置域的教程中，添加主机的说明之一是添加 Web 服务器的 IP 地址。我该如何寻找这些信息？我无法找到任何可以帮助我解决此问题的资源。

我应该在**_** .herokuapp.com 添加我的应用程序的 IP 地址吗？当我尝试查找此地址时，我从未得到一致的地址（可能是因为 Heroku 的许多服务器）。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-21T18:33:11.283

链接 Zerigo 和 Heroku 是一个三步过程。

(1) 使用`heroku addons:add zerigo_dns:basic`命令或通过 Heroku 应用程序上的附加组件页面手动添加 Zerio。

(2) 与您的注册商或托管服务提供商一起正确解析域。对于 Zerigo，添加所有名称服务器：

a.ns.zerigo.net

b.ns.zerigo.net

es.zerigo.net

c.ns.zerigo.net

dns.zerigo.net

(3) 这是我认为您可能缺少的步骤。通过“附加组件”下的 Heroku 配置面板登录 Zerigo，或直接登录 Zerigo。选择帐户和服务器旁边的 DNS 选项卡。在左侧面板上选择您已解析到 Zerigo 的域：该域将出现。在此域中，在“主机”旁边的“名称服务器”下单击“添加代码段”。添加推荐的代码片段 proxy.heroku.com 和不包括 www 的重定向记录。

等待 TTL 周期（通常为 15 分钟），您的域将按预期工作。

# javascript - 使用 createElement 而不是 getElementById 动态创建音频元素

> ID：10966408
> 
> 赞同：2
> 
> 时间：2012-06-10T04:41:56.073
> 
> 标签：javascript, html, html5-audio

我有一些像这样运行的javascript：

```
document.getElementById("audio").innerHTML = ("<audio id=\"player\" src=\"data:audio/x-wav;base64,"+encode64(wav)+"\">");
return document.getElementById("player"); 
```

我想把它改成这样：

```
audio = document.createElement("audio");
audio.src = "data:audio/x-wav;base64,"+encode64(wav)+"\">";
document.body.appendChild(audio);
return audio; 
```

但是，这不是以同样的方式工作的。为什么这在返回带有`play`方法的元素时本质上不等效？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T04:50:02.273

`src`不应该有关闭标签部分：

```
//                                                  ↓↓↓↓↓↓
audio.src = "data:audio/x-wav;base64,"+encode64(wav)+"\">"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T04:50:21.510

最后补充`"\">"`。

```
audio.src = "data:audio/x-wav;base64,"+encode64(wav)+"\">"; 
```

# php - PHP在Windows中创建具有777权限的目录

> ID：10966409
> 
> 赞同：0
> 
> 时间：2012-06-10T04:42:03.600
> 
> 标签：php, linux, windows, permissions

我读过这个：- [为什么 PHP 不能创建具有 777 权限的目录？](https://stackoverflow.com/questions/3997641/why-cant-php-create-a-directory-with-777-permissions)

我可以看到通过应用以下内容创建了一个新文件夹：-

```
// Desired folder structure
$structure = "../../../".$flash_dir."HELLO";

// To create the nested structure, the $recursive parameter 
// to mkdir() must be specified.

    $oldmask = umask(0);
    mkdir($structure, 0777);
    umask($oldmask); 
```

用 DreamWeaver 查看 HELLO 的文件权限时，是 777。但是，我怀疑它是 Linux 0777 而不是 Windows 777，因此我仍然无法将内容上传到 HELLO。

是否有任何替代方法可以使用 Windows 777 创建目录？谢谢！

PS。当我手动创建一个新目录并右键设置777时，它完美运行，所以我真的认为它与Linux vs Windows有关~

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T04:52:00.210

**`0777`与`777`**

但我仍然不能说问题是什么。在您创建它之后，我会尝试再次对其进行 chmod。

```
$oldmask = umask(0);
chmod($structure, 0777);
umask($oldmask); 
```

# php - PHP（cURL、标头、COOKIES）等

> ID：10966414
> 
> 赞同：0
> 
> 时间：2012-06-10T04:44:38.960
> 
> 标签：php, cookies, curl, request-headers

我会尽力解释我试图达到的最佳方式。

假设有一个页面显示信息并且它有 cookie（我可以通过 Firecookie [Firebug 中的 Firefox 插件] 查看 cookie）我可以通过

```
$cookies = array();
foreach ($http_response_header as $hdr) {
    if (preg_match('/^Set-Cookie:\s*([^;]+)/', $hdr, $matches)) {
        parse_str($matches[1], $tmp);
        $cookies += $tmp;
    }
}

print_r($cookies); 
```

但是原始页面有请求标头，我想做的是获取请求标头并向同一页面发出请求。我想我有两个问题，我是通过 COOKIES 还是单独获取请求标头。以及如何获取页面的请求标头并使用这些请求标头向该页面发送请求？我尝试了很多东西，但都没有成功。我没有尝试过的代码，因为我不断尝试新事物，因此无法粘贴我拥有的代码，只能粘贴我粘贴的文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T04:48:00.703

如果您将 PHP 与 apache 一起使用，则可以使用 function 获取请求标头`apache_request_headers`。

[http://php.net/manual/en/function.apache-request-headers.php](http://php.net/manual/en/function.apache-request-headers.php)

# c# - 自动部署，Global.asax：无法加载类型 Namespace.Global

> ID：10966416
> 
> 赞同：3
> 
> 时间：2012-06-10T04:46:41.037
> 
> 标签：c#, web-services, deployment, compilation, global-asax

这是我的第一篇 StackOverflow 帖子。提前致谢！我在这里找到了很多答案，但在网络上的任何地方都找不到关于我当前问题的任何信息。=(

我有一个 C# 服务，我使用 Visual Studio 2010 Express 中在线找到的 WCFRestWebService 模板进行了测试和部署。当我将项目“发布”到我的 Web 服务器时，服务会按需要运行。该服务需要三个文件才能在线运行，即我的 web.config、global.asax 和 bin/WCFRestWebService1.dll。

于是我想，为什么我不能编写一个程序来生成这三个文件并将这些文件通过 FTP 传输到我的网络服务器。所以我写了这个：

```
namespace Edifice
{
    //code behind for ASP.Net page
    public partial class SiteMaster : System.Web.UI.MasterPage
    { 
        protected void Page_Load(object sender, EventArgs e) { }
        protected void Button1_Click(object sender, EventArgs e) {
            //the first Write() method returns an array of strings 
            //containing .cs files for the project, in this particular 
            //case, 2 strings, one containing the service.cs and one 
            //containing global.asax.cs
            string[] parameters = eConfig.midTier.Write(eConfig);
            string webConfig = eConfig.midTier.WriteWebConfig(eConfig);
            string globalAsax = eConfig.midTier.WriteGlobalAsax(eConfig);
            Assembly assembly = ECompiler.BuildAssembly(eConfig.className, parameters);
            EFTP.Upload(assembly, webConfig, globalAsax, eConfig);
        }
    }
    public static class EFTP
    {
        //for this sample, FTP merely saves the file to the current file system for testing
        public static void Upload(Assembly sourceFile, string webConfig, string globalAsax, EConfiguration eConfig)
        {
            string filepath = "C:\\EdificeTest\\dlls\\";
            using (Stream oStream = new FileStream(filepath + "bin\\" + "WCFRESTService2.dll", FileMode.Create))
            {
                StreamWriter sWriter = new StreamWriter(oStream);
                sWriter.Write(sourceFile);
                sWriter.Close();
            }
            using (Stream oStream = new FileStream(filepath + "Web.config", FileMode.Create))
            {
                StreamWriter sWriter = new StreamWriter(oStream);
                sWriter.Write(webConfig);
                sWriter.Close();
            }
            using (Stream oStream = new FileStream(filepath + "Global.asax", FileMode.Create))
            {
                StreamWriter sWriter = new StreamWriter(oStream);
                sWriter.Write(globalAsax);
                sWriter.Close();
            }
        }
    }
    public static class ECompiler
    {
        public static Assembly BuildAssembly(string assemblyName, string[] sources)
        {
            List<string> WCFRestServiceAssemblies = new List<string>();
            WCFRestServiceAssemblies.Add("Microsoft.CSharp.dll");
            WCFRestServiceAssemblies.Add("System.dll");
            WCFRestServiceAssemblies.Add("System.Configuration.dll");
            WCFRestServiceAssemblies.Add("System.Core.dll");
            WCFRestServiceAssemblies.Add("System.Data.dll");
            WCFRestServiceAssemblies.Add("System.Drawing.dll");
            WCFRestServiceAssemblies.Add("System.EnterpriseServices.dll");
            WCFRestServiceAssemblies.Add("System.Runtime.Serialization.dll");
            WCFRestServiceAssemblies.Add("System.ServiceModel.dll");
            WCFRestServiceAssemblies.Add("System.ServiceModel.Activation.dll");
            WCFRestServiceAssemblies.Add("System.ServiceModel.Web.dll");
            WCFRestServiceAssemblies.Add("System.Web.dll");
            WCFRestServiceAssemblies.Add("System.Web.ApplicationServices.dll");
            WCFRestServiceAssemblies.Add("System.Web.DynamicData.dll");
            WCFRestServiceAssemblies.Add("System.Web.Entity.dll");
            WCFRestServiceAssemblies.Add("System.Web.Extensions.dll");
            WCFRestServiceAssemblies.Add("System.Web.Services.dll");
            WCFRestServiceAssemblies.Add("System.Xml.dll");
            WCFRestServiceAssemblies.Add("System.Xml.Linq.dll");

            Microsoft.CSharp.CSharpCodeProvider provider = new CSharpCodeProvider(new Dictionary<String, String> { { "CompilerVersion", "v4.0" } });
            ICodeCompiler compiler = provider.CreateCompiler();
            CompilerParameters compilerparams = new CompilerParameters(WCFRestServiceAssemblies.ToArray());
            compilerparams.OutputAssembly = assemblyName + ".dll";
            compilerparams.GenerateExecutable = false;
            compilerparams.GenerateInMemory = true;
            CompilerResults results = compiler.CompileAssemblyFromSourceBatch(compilerparams, sources);

            if (results.Errors.HasErrors)
            {
                StringBuilder errors = new StringBuilder("Compiler Errors :\r\n");
                foreach (CompilerError error in results.Errors)
                {
                    errors.AppendFormat("Line {0},{1}\t: {2}\n",
                           error.Line, error.Column, error.ErrorText);
                }
                throw new Exception(errors.ToString());
            }
            else
            {
                return results.CompiledAssembly;
            }
        }
    }
} 
```

那么，问题是即使可以将完全相同的代码粘贴到 Visual Studio 项目中，并且我可以从 Visual Studio 编译和发布该服务（并且它可以工作！），但当我尝试使用由这些生成的相同文件时方法，当我尝试调用服务时出现错误：

> [HttpException]：无法加载类型“EdificeTest.Global”。
> 在 System.Web.UI.TemplateParser.GetType(String typeName, Boolean ignoreCase, Boolean throwOnError) 在 System.Web.UI.TemplateParser.ProcessInheritsAttribute(String baseTypeName, String codeFileBaseTypeName, String src, Assembly assembly) 在 System.Web.UI。 TemplateParser.PostProcessMainDirectiveAttributes(IDictionary parseData)

“EdificeTest”是 Web 服务的命名空间，被 Global.asax 文件引用。根据我的分析，似乎对于“已发布”服务，Global.asax.cs 文件被编译并添加到程序集中，并且 Global.asax 文件在程序集中引用其“代码隐藏”文件。当 Visual Studio 负责打包项目时，这似乎有效，但是我必须在我的自动部署中错过一个步骤，因为它在 Global.asax 中找不到“Inherits =”属性的类型，并且会引发错误.

请帮忙？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-16T05:53:33.283

请拖动并`drop your Global.asax.cs`归档到`App_Code folder`. 它将解决您与 Global.asax.cs 文件相关的所有无聊问题。

干杯，Jignesh Jinjariya

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T04:29:55.453

我不确定我是否完全理解您的问题。如果您不希望您的全局代码隐藏类在汇编中，您可以在 global.asax 中使用内联代码，而不是继承/代码隐藏：

```
<%@ Application Language="C#" %>
<script RunAt="server">
    protected void Application_Start(object sender, EventArgs e)
    {
    }

    protected void Session_Start(object sender, EventArgs e)
    {

    }

    protected void Application_BeginRequest(object sender, EventArgs e)
    {

    }

    protected void Application_AuthenticateRequest(object sender, EventArgs e)
    {

    }

    protected void Application_Error(object sender, EventArgs e)
    {

    }

    protected void Session_End(object sender, EventArgs e)
    {

    }

    protected void Application_End(object sender, EventArgs e)
    {

    }
</script> 
```

# c# - xna 4.0 如何使前景纹理透明以显示背景纹理

> ID：10966419
> 
> 赞同：0
> 
> 时间：2012-06-10T04:47:03.530
> 
> 标签：c#, xna, transparency, xna-4.0

我希望这是一个简单的问题和答案，但是 xna 和微软似乎不必要地使事情复杂化。

我有一个覆盖整个屏幕的背景纹理。然后我有一个前景纹理，我想在背景纹理上绘制。如您所料，前景纹理具有透明区域。我遇到的问题是，无论前景纹理是透明的，我都会看到蓝色的图形设备颜色，而不是背景图像。

我已经追踪了更多信息。我正在调整前景纹理的大小，似乎调整大小是造成悲伤的原因。

任何建议或指示都非常感谢。

```
Draw(...)
{
ScreenManager.Game.GraphicsDevice.Clear(Color.DarkBlue);
SpriteBatch spriteBatch = this.ScreenManager.SpriteBatch;
spriteBatch.Begin();

// draw the background
spriteBatch.Draw(_backgroundTexture, _backgroundPosition, null, Color.White, 0f,
                 Vector2.Zero, 1.0f, SpriteEffects.None, 0f);
spriteBatch.Draw(Resize(_foregroundTexture,100,100), _foregroundPosition, null, Color.White, 0f,
                 Vector2.Zero, 1.0f, SpriteEffects.None, 0f);

spriteBatch.End();
}

Texture2D Resize(texture2D, float newWidth, float newHeight)
{
RenderTarget2D renderTarget;
Rectangle destinationRectangle;
SpriteBatch spriteBatch;

renderTarget = new RenderTarget2D(graphicsDevice, (int)newWidth, (int)newHeight);
destinationRectangle = new Rectangle(0, 0, (int)newWidth, (int)newHeight);
spriteBatch = new SpriteBatch(graphicsDevice);

graphicsDevice.SetRenderTarget(renderTarget);

spriteBatch.Begin();
spriteBatch.Draw(texture2D, destinationRectangle, Color.White);
spriteBatch.End();

graphicsDevice.SetRenderTarget(null);

return renderTarget;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T05:17:38.877

当我调整大小时，我需要指定以下精灵批处理参数...

spriteBatch.Begin(SpriteSortMode.Deferred, BlendState.Opaque);

# php - PHP 开关未按预期工作

> ID：10966423
> 
> 赞同：0
> 
> 时间：2012-06-10T04:47:44.787
> 
> 标签：php, oop, class

我有一个名为 ResetPassword 的 PHP 类。在这个类中有一个开关，它将返回一个包含所需 HTML 的不同字符串。

这是下面的代码（为简洁起见，我省略了一些情况，还有一个返回 NULL 的默认情况）

```
 public function get_display_block($displayblock) {
     switch ($displayblock) {
    case 'EnterNewPassword':
        $displayblock = '
                        <form action="resetpassword.php" method="post">
                        <fieldset class="login">
                        <legend>Enter your information in the form below to reset your password: </legend>
                        <div><label for="password1">Password :</label>
                        <p><input type="password" name="password1" size="40" maxlength="60" /></p> </div>
                        <div><label for="password2"><span class="required">*</span>Retype Password :</label>
                        <p><input type="password" name="password2" size="40" maxlength="60" /></p>  </div>

                        <br />
                        </fieldset><br />
                        <br />
                        <div align="center"><input type="submit" name="submit" value="Submit My Information!" \></div>
                        </form>
                        ';
            return $displayblock;
        break;

    case 'THIS_ISNT_WORKING':
        $displayblock = '
                        <form action="changepassword.php" method="post">
                        <fieldset class="login">
                        <legend>Enter your information in the form below to reset your password: </legend>
                        <div><label for="password1">Old Password : </label>
                        <p><input type="password" name="oldpassword" size="40" maxlength="60" /></p> </div>
                        <div><label for="password1">New Password :</label>
                        <p><input type="password" name="password1" size="40" maxlength="60" /></p> </div>
                        <div><label for="password2"><span class="required">*</span>Retype New Password :</label>
                        <p><input type="password" name="password2" size="40" maxlength="60" /></p>  </div>

                        <br />
                        </fieldset><br />
                        <br />
                        <div align="center"><input type="submit" name="submit" value="Submit My Information!" \></div>
                        </form>
                        ';
        return $displayblock;
     break;
}  // end of switch

} //end of method 
```

在我的主页上调用类/开关时，下面的代码工作正常。

```
$reset = new ResetPassword(); 
$displayblock = $reset->get_display_block('EnterSecretAnswer'); 
```

但是，当尝试调用 THIS_ISNT_WORKING 时，没有任何显示。$displayblock 上的 var_dump 返回 NULL。

```
$reset = new ResetPassword();
$displayblock = $reset->get_display_block('THIS_ISNT_WORKING');
var_dump($displayblock); 
```

如果我调用任何其他情况（之前省略的情况），它会返回所需的 HTML。

谁能看到我在这里缺少的东西？像往常一样的任何帮助将不胜感激。

编辑：我已经按照下面的要求更新了开关，以便返回语句在开关之外。最后的结果还是一样的。我还更改了默认情况以返回一个字符串（“abcd”），只是为了验证默认情况没有被调用，它不是。仍然返回 NULL。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T04:52:31.553

```
public function get_display_block($displayblock) {
 switch ($displayblock) {
    case 'EnterNewPassword':
         $displayblock = '
                    <form action="resetpassword.php" method="post">
                    <fieldset class="login">
                    <legend>Enter your information in the form below to reset your password: </legend>
                    <div><label for="password1">Password :</label>
                    <p><input type="password" name="password1" size="40" maxlength="60" /></p> </div>
                    <div><label for="password2"><span class="required">*</span>Retype Password :</label>
                    <p><input type="password" name="password2" size="40" maxlength="60" /></p>  </div>

                    <br />
                    </fieldset><br />
                    <br />
                    <div align="center"><input type="submit" name="submit" value="Submit My Information!" \></div>
                    </form>
                    ';
    break;

   case 'THIS_ISNT_WORKING':
      $displayblock = '
                    <form action="changepassword.php" method="post">
                    <fieldset class="login">
                    <legend>Enter your information in the form below to reset your password: </legend>
                    <div><label for="password1">Old Password : </label>
                    <p><input type="password" name="oldpassword" size="40" maxlength="60" /></p> </div>
                    <div><label for="password1">New Password :</label>
                    <p><input type="password" name="password1" size="40" maxlength="60" /></p> </div>
                    <div><label for="password2"><span class="required">*</span>Retype New Password :</label>
                    <p><input type="password" name="password2" size="40" maxlength="60" /></p>  </div>

                    <br />
                    </fieldset><br />
                    <br />
                    <div align="center"><input type="submit" name="submit" value="Submit My Information!" \></div>
                    </form>
                    ';
         break;
    }

  return $displayblock;
} 
```

**更新**

这是否有效：

```
 <?php

   $reset = new Reset;
   $displayblock = $reset->get_display_block('THIS_ISNT_WORKING');
   var_dump($displayblock);

   class Reset{
    public function get_display_block($displayblock) {
    switch ($displayblock) {
       case 'EnterNewPassword':
            $displayblock = '
                <form action="resetpassword.php" method="post">
                <fieldset class="login">
                <legend>Enter your information in the form below to reset your password: </legend>
                <div><label for="password1">Password :</label>
                <p><input type="password" name="password1" size="40" maxlength="60" /></p> </div>
                <div><label for="password2"><span class="required">*</span>Retype Password :</label>
                <p><input type="password" name="password2" size="40" maxlength="60" /></p>  </div>

                <br />
                </fieldset><br />
                <br />
                <div align="center"><input type="submit" name="submit" value="Submit My Information!" \></div>
                </form>
                ';
       break;

      case 'THIS_ISNT_WORKING':
         $displayblock = '
                <form action="changepassword.php" method="post">
                <fieldset class="login">
                <legend>Enter your information in the form below to reset your password: </legend>
                <div><label for="password1">Old Password : </label>
                <p><input type="password" name="oldpassword" size="40" maxlength="60" /></p> </div>
                <div><label for="password1">New Password :</label>
                <p><input type="password" name="password1" size="40" maxlength="60" /></p> </div>
                <div><label for="password2"><span class="required">*</span>Retype New Password :</label>
                <p><input type="password" name="password2" size="40" maxlength="60" /></p>  </div>

                <br />
                </fieldset><br />
                <br />
                <div align="center"><input type="submit" name="submit" value="Submit My Information!" \></div>
                </form>
                ';
            break;
       }

     return $displayblock;
   }

} 
```

它为我返回一个非空响应。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T04:51:02.700

你不应该`return`在 switch 中使用语句。据我所知，基本上`return`在函数中使用语句一次被称为一种好的做法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-10T08:16:04.813

我找到了解决方案，令人尴尬的是，错误不在开关或我调用它的方式中。我有一个配置文件，它包含在每个页面中（没有提及，因为认为它不相关），我忘记添加该类。

让我困惑这么久的事情是，我不会认为 switch 中的其他情况也可以工作，但他们确实......哦，好吧。

感谢所有回答的人。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-10T04:57:07.513

像这样使用它

```
function get_display_block($displayblock) {
    switch ($displayblock) {
        case 'EnterNewPassword':
            echo '<form action="resetpassword.php" method="post">' .
                 '<fieldset class="login">' .
                 '<legend>Enter your information in the form below to reset your password: </legend>' .
                 '<div><label for="password1">Password :</label>' .
                 '<p><input type="password" name="password1" size="40" maxlength="60" /></p> </div>'.
                  '<div><label for="password2"><span class="required">*</span>Retype Password :</label>'.
                  '<p><input type="password" name="password2" size="40" maxlength="60" /></p>  </div>'.
                  '<br />'.
                  '</fieldset><br />'.
                  '<br />'.
                  '<div align="center"><input type="submit" name="submit" value="Submit My Information!" \></div>'.
                  '</form>';
            break;
      }
} 
```

对你的其他情况也一样。虽然这样做可能有点草率，但你只需要通过调用在你的脚本上使用它`<? get_displaying_block($yourString); ?>`

# python - BeautifulSoup 中的 navigablestrings 和 unicode 问题

> ID：10966429
> 
> 赞同：1
> 
> 时间：2012-06-10T04:49:36.727
> 
> 标签：python, beautifulsoup

我在 BeautifulSoup（python）中的 navigablestrings 和 unicode 有一些问题。

基本上，我正在解析来自 youtube 的四个结果页面，并将顶部结果的扩展名（在 youtube.com/watch?= 之后的 url 结尾）放入列表中。

然后，我在其他两个函数中循环列表，其中一个会引发此错误：`TypeError: 'NavigableString' object is not callable`. 然而，另一个说`TypeError: 'unicode' object is not callable`。两者都使用相同的字符串。

我在这里做错了什么？我知道我的解析代码可能并不完美，我同时使用 BeautifulSoup 和正则表达式。过去，每当我遇到 NavigableString 错误时，我都会抛出一个“.encode('ascii', 'ignore') 或简单的 str()，这似乎有效。任何帮助将不胜感激！

```
 for url in urls:
        response = urllib2.urlopen(url)
        html = response.read()
        soup = BeautifulSoup(html)
        link_data = soup.findAll("a", {"class":"yt-uix-tile-link result-item-translation-title"})[0]
        ext = re.findall('href="/(.*)">', str(link_data))[0]
        if isinstance(ext, str):
            exts.append('http://www.youtube.com/'+ext.replace(' ','')) 
```

接着：

```
 for ext in exts:
        description = description(ext)
        embed = embed(ext) 
```

我只添加了 isinstance() 行来尝试查看问题所在。当 'str' 更改为 'unicode' 时，exts 列表为空（意味着它们是字符串，而不是 unicode（甚至是可导航字符串？））。我很困惑...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T04:58:04.597

`description = description(ext)`在循环中的第一次迭代后用字符串替换函数。对`embed`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T06:12:04.720

```
for ext in exts:
    description = description(ext)
    embed = embed(ext) 
```

`description()`并且`embed()`是函数。例如

```
def description():  #this is a function
    return u'result' 
```

然后

```
description = description(ext) 
#now description is a unicode object, and it is not callable.
#It is can't call like this description(ext) again 
```

我认为这两个函数`description()`和`embed()`是返回`'NavigableString' object`和`'unicode' object`。那两个对象都不是`callable`。

所以你应该替换这两行，例如：

```
for ext in exts:
    description_result = description(ext)
    embed_result = embed(ext) 
```

# operating-system - 如果一个线程忙于 I/O 会阻塞整个进程

> ID：10966432
> 
> 赞同：4
> 
> 时间：2012-06-10T04:50:26.730
> 
> 标签：operating-system

在多线程进程中，如果一个线程忙于I/O，整个进程会被阻塞吗？

AFAIK，这完全取决于程序员他们如何管理程序中的线程。如果另一个线程没有 I/O，处理器将永远不会闲置并开始执行该线程。但是，在拆分线程中的进程使得一个线程等待另一个线程的结果，整个进程将被阻塞。

如果需要添加更多信息，请发表评论。是否存在任何其他解释？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-10T06:49:49.427

如果进程只有一个线程，那么是的。

如果进程有多个线程，那么如果操作系统支持多线程，则通常不会。

这个问题也可以根据用户线程的底层实现来解决。多线程模型有不同的模型，为了实现用户线程，它们必须映射到内核线程：

*   **多对一**：多用户线程到一个内核线程

*   **一对一**：每个用户线程都分配给一个内核线程。

*   **多对多**：许多用户线程被分割在不同的内核线程上。

在**多对一的**情况下，线程内的单个阻塞操作（系统调用）可以**阻塞**整个进程。这种缺点在**一对一模型**中不存在。

# php - 使用 PHP 创建文件以供下载而不保存在服务器上

> ID：10966433
> 
> 赞同：6
> 
> 时间：2012-06-10T04:50:42.173
> 
> 标签：php, file, download, save

说我的 PHP 代码是

```
<?php

// Get form variables using POST method
$MarriagePostMortem=stripslashes($_POST['MarriagePostMortem']);
$AutoSavesToKeep=stripslashes($_POST['AutoSavesToKeep']);

// Open and write file
$myFile="S3S.cfg";
$fh = fopen($myFile, 'w+') or die("can't open file");
fwrite($fh, "The Sims 3 Starter Configuration
-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
MarriagePostMortem  $MarriagePostMortem
AutoSavesToKeep $AutoSavesToKeep
-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-");
fclose($fh); 

//echo "file written\n";
?> 
```

我想将文件直接发送给用户进行下载，而不将其保存到服务器。我对PHP**真的**不是很好，那么我到底需要添加/更改什么来做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-10T04:58:22.477

```
header ("Content-Type: application/octet-stream");
header ("Content-disposition: attachment; filename=S3S.cfg");
echo $string; //the string that is the file 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-06-10T05:48:39.673

这是你应该怎么做的，你的 html 标签应该是小写的，除非你输出一个值表，否则你的 html 标签应该是小写的，并且不要使用表格，使用带有 css 的 div。您也可以发回脚本，因为从表单接收到的变量是特定的，您只需检查正确的值，然后将数据发送回用户。

```
<?php
if($_SERVER['REQUEST_METHOD']=='POST'){

    $mpm = (!empty($_POST['mpm']) && ($_POST['mpm']=='true' || $_POST['mpm']=='false'))?$_POST['mpm']:die('Wrong parameter type');
    $astk = (!empty($_POST['astk']) && is_numeric($_POST['astk']))?$_POST['astk']:die('Wrong parameter type');

    $content  = "The Sims 3 Starter Configuration".PHP_EOL;
    $content .= "-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-".PHP_EOL;
    $content .= "MarriagePostMortem  $mpm".PHP_EOL;
    $content .= "AutoSavesToKeep $astk".PHP_EOL;
    $content .= "-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-".PHP_EOL;

    header('Content-Description: File Transfer');
    header('Content-Type: application/octet-stream');
    header('Content-disposition: attachment; filename=S3S.cfg');
    header('Content-Length: '.strlen($content));
    header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
    header('Expires: 0');
    header('Pragma: public');
    echo $content;
    exit;
}
?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Sims 3 Starter Configuration</title>
</head>

<body>

<h1>Sims 3 Starter Configuration</h1>

<form action="" method="post">
<input type="reset" value="Clear changes">
<br />  
<p>marriagepostmortem
  <select name="mpm">
    <option value="true">enabled</option>
    <option value="false" selected="selected">disabled</option>
  </select>
  Keep marriage lines on family tree entries after death. experimental!</p>

<p>autosavestokeep
  <select name="astk">
    <option value="1">1</option>
    <option value="2" selected="selected">2</option>
    <option value="3">3</option>
    <option value="4">4</option>
    <option value="5">5</option>
    <option value="6">6</option>
    <option value="7">7</option>
    <option value="8">8</option>
    <option value="9">9</option>
    <option value="10">10</option>
  </select>
  Number of autosaves to keep.</p>

<p><input type="submit" value="Generate"></p>
</form>
<p>Drag the file onto the sims 3 starter to add configurations.</p>
</body>
</html> 
```

# iphone - 通过 NSURLConnection 或 JSon 从 UITextField 发送数据到 PHP 脚本

> ID：10966434
> 
> 赞同：0
> 
> 时间：2012-06-10T04:50:50.100
> 
> 标签：iphone, sdk, uitextfield

嗨，我想知道如何使用 NSURLConnection 或 JSon 将数据从 4 个 UITextField 发送到网站上的 PHP 脚本。无论更容易，我怎么能准确地做到这一点？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T05:38:36.930

Easiest way (synchronous)

```
NSString strForTextField1 = textField1.text;
NSString strForTextField2 = textField1.text;
NSString strForTextField3 = textField1.text;
NSString strForTextField4 = textField1.text;

//Build the request
NSString *stringOfRequest = [NSString stringWithFormat:@"www.yourserver.com?var1=%@&var2=%@&var3=%@&var4=%@", strForTextField1, strForTextField2, strForTextField3, strForTextField4];
NSURL *url = [NSURL URLWithString:stringOfRequest];
NSURLRequest *request = [NSURLRequest requestWithURL:url];

NSURLResponse *response;
NSError *error;
//send it synchronous
NSData *responseData = [NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&error];
NSString *responseString = [[NSString alloc] initWithData:responseData encoding:NSUTF8StringEncoding];

if(!error)
{
    //log response
    NSLog(@"Response from server = %@", responseString);
} 
```

# javascript - 在主干 js 中重新创建已删除的视图

> ID：10966440
> 
> 赞同：8
> 
> 时间：2012-06-10T04:51:47.303
> 
> 标签：javascript, backbone.js

主干 js 中的 View.remove() 函数从 DOM 中删除视图本身的容器元素，防止重新创建已删除的视图。知道如何处理这种情况

这是我的代码，

```
var AttributeView = Backbone.View.extend({
        el: $("#attrs"),
        template:_.template($('#attrs-template').html()),

        initialize:function() {
        },

        render:function (eventName) {
            $(this.el).html(this.template(this.model.toJSON()));
            return this;
            },

        dispose:function(eventName){
            this.unbind();
            this.remove();
        },

    });

var attrView = new AttributeView();
....
attrView.dispose();
//Later on some event I do the below
attrView = new AttributeView()
attrView.render(); 
```

上面的最后两行不会重新创建视图，因为 id="attrs" 的 div 不再存在。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-06-10T05:21:40.673

首先，你不需要你的`dispose`方法，标准`remove`就足够了：

```
var attrView = new AttributeView();
//....
attrView.remove();  // <--------- Do this instead
//...
attrView = new AttributeView()
attrView.render(); 
```

[`remove`](http://backbonejs.org/#View-remove)其次，如果标准版本不能满足您的需求，您可以覆盖。[默认实现](https://github.com/jashkenas/backbone/blob/1.0.0/backbone.js#L1020)只是简单地删除`this.el`和清理一些事件监听器：

```
remove: function() {
  this.$el.remove();
  this.stopListening();
  return this;
}, 
```

在您的情况下，您想要撤消所做的一切，`render`这意味着清除*内部* `this.el`的 HTML并通过调用删除事件[`undelegateEvents`](http://backbonejs.org/#View-undelegateEvents)：

```
remove: function() {
    this.undelegateEvents();
    this.$el.empty();
    this.stopListening();
    return this;
}, 
```

然后你可以调用`attrView.remove()`并杀死它并`(new AttributeView()).render()`把它带回来。

演示：http: [//jsfiddle.net/ambiguous/Pu9a2/3/](http://jsfiddle.net/ambiguous/Pu9a2/3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T15:04:02.980

看看[LayoutManager](https://github.com/tbranyen/backbone.layoutmanager) for Backbone Views，它知道当你删除一个视图（父级 - 在包含意义上而不是对象层次结构意义上）时，它的子视图也应该被删除。

# python - 如何使用 Tkinter 模块在 Python 中创建用户登录部分

> ID：10966441
> 
> 赞同：1
> 
> 时间：2012-06-10T04:51:55.170
> 
> 标签：python, tkinter, password-protection

我正在开发一个小型 uni 项目，其中我有一个使用 tkinter 模块的 Python 中单个用户的程序。我想创建一个屏幕，要求他们输入密码。我不确定如何执行此操作以及将密码存储在哪里？

我没有数据库经验，但我听说过 MD5 和 SHA256，我正在考虑将散列或加密密码写入文本文件，然后读取它，但我不确定这是否安全。

密码功能是为了防止其他人查看用户的个人日记条目。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T05:27:41.327

*这个答案采取了最简单的方法来实现安全措施。@JFSebastian 在评论中指出，您绝对可以探索更强大的安全程序和更大的加密，但这真的取决于您的需求*

如果您的目标只是试验和创建概念验证登录系统，则可以使用加密 + 平面文件的方法。对于存储密码，您可能只需要 SHA1，因为您要加密的是密码的变体，而不是敏感数据本身。我的意思是你不关心数据本身。您只关心比较加密结果...

首先，您将选择一个秘密字符集作为“盐”。不幸的是，您使用的是未编译的语言，因此您的 salt 可能会存在于您的程序中。但至少密码文件本身是不可用的。*（“salt”在这里用作您唯一的秘密值。在更安全的方法中，秘密将是在密码+盐的散列之外使用的单独密钥）*

```
import hashlib
salt = "-WOu@p.Za,>W+6&`A63/"
user_password = "password"
sha1 = hashlib.sha1()
sha1.update(user_password + salt)
encrypted = sha1.hexdigest()
print encrypted
# 476dc4076d1c7eb43152b78e9dc20d892f660f24 
```

您可以将该加密的 sha1 值存储到文件中。如果没有秘密的盐值，它对任何人都没有用。您要做的就是在用户进行身份验证时使用此值与未来的 sha1 值进行比较

```
test_sha1 = hashlib.sha1(raw_input("Enter password: ") + salt).hexdigest()
# Enter password:  password
print encrypted == test_sha1
# True 
```

你永远不会真正知道他们的密码。您只知道从它派生的 sha1 值加上盐。可以把它想象成两个守卫，每个人都需要提供一把钥匙，同时转动，打开保险库。

否则......您可以将其与盐值一起存储在数据库中。该过程仍然是相同的，但您将盐移动到一个更安全的位置，这需要 auth 甚至查询它。不管怎样，你的盐秘诀是最珍贵的财产。

解决 SHA256... 需要更强大的加密算法来以需要保护的有形格式存储真实数据*（或为密码创建较慢的散列过程以使暴力破解需要更长时间才能完成）*。例如，如果您决定存储用户的私人日记条目，您可能会针对他们的密码进行加密，并且仅将这种加密格式存储在磁盘或数据库中。当用户进行身份验证时，您可以通过他们的密码向他们提供解密的数据。您永远不会存储密码，因此即使您作为软件的作者也无法在没有原始密码的情况下访问他们的数据。

Again, as @J.F.Sebastian points out, the more robust approach would be using a bcrypt library: [http://www.mindrot.org/projects/py-bcrypt/](http://www.mindrot.org/projects/py-bcrypt/)

# c++ - 将字符串传递给 file.open();

> ID：10966446
> 
> 赞同：13
> 
> 时间：2012-06-10T04:52:28.270
> 
> 标签：c++, string, pointers

我习惯了高级语言（java、python 等），这很明显。我正在尝试将用户输入的字符串传递给 cin，即要打开的文件的名称。似乎存在某种指针疯狂错误，我的代码将无法编译。我删除了一些代码以使其更清晰。

```
 #include <iostream>
   #include <fstream>
   using namespace std;

   string hash(string filename);

   int main(){
           cout << "Please input a file name to hash\n";
           string filename;
           cin >> filename;
           cout <<hash(filename);
           return 0;
   }

    string hash(string filename){
            file.open(filename);
            if(file.is_open()){

                   file.close();
            }

            return returnval;
    } 
```

这是编译时错误。

```
<code>
$ g++ md5.cpp
md5.cpp: In function ‘std::string hash(std::string)’:
md5.cpp:22: error: no matching function for call to ‘std::basic_ifstream<char, std::char_traits<char> >::open(std::string&)’
/usr/include/c++/4.2.1/fstream:518: note: candidates are: void std::basic_ifstream<_CharT, _Traits>::open(const char*, std::_Ios_Openmode) [with _CharT = char, _Traits = std::char_traits<char>]
</code> 
```

（我知道有 md5 散列的库，但我正在尝试了解散列的工作原理，并最终了解散列冲突）

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-06-10T04:54:30.213

`open()`采用 C 风格的字符串。用于`std::string::c_str()`得到这个：

```
file.open (filename.c_str()); 
```

为了只使用字符串，如下所述，您需要使用支持 C++11 的编译器，因为为 C++11 添加了重载。

它不像 Java 等的原因是它来自 C。C 中不存在类（嗯，不如 C++ 中的那么好），更不用说`String`类了。为了让 C++ 提供一个字符串类并保持兼容性，它们需要是不同的东西，并且该类为 提供转换构造函数`const char * -> std::string`，以及`c_str()`反之亦然。

考虑传递参数（也可能是返回）`const std::string &`；没有不必要的副本。优化可能会抓住这些，但这样做总是好的。

# jquery - 返回 jQuery $.ajax() 的错误代码是什么？

> ID：10966448
> 
> 赞同：0
> 
> 时间：2012-06-10T04:52:33.033
> 
> 标签：jquery

我需要什么 HTTP 错误代码才能返回到可用于设置响应方法的 jQuery ajax？使用 jQuery 1.7。

例如，我有以下代码：

```
var request = $.ajax({
            type: "POST",
            url: "/report/template/save",
            data: formData,
            success: function() {

            },
            statusCode: {
                400: function() {
                  $('#template_form .ajax-msg').show();
                  $('#template_form .ajax-msg').html('<strong>Sorry, save failed.');
                }
            }
        });
request.fail(function(data) {
            $('#template_form .ajax-msg').show();
            $('#template_form .ajax-msg').html('<strong>Sorry, save failed.');
        }); 
```

我确实可以验证正在返回 400。

如果表单不验证服务器端，我尝试返回状态 500 和 400 都没有运气。相反，发生的是代码被暂停并且`.ajax-msg`不显示任何内容。`$.ajax`期待什么？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T05:14:06.050

存在多个冲突，多亏了评论，我才得以解决。

首先，成功处理程序太多（在我看来，命名有点模糊）。我删除`statusCode`并替换为`request.fail`and`request.always`它允许我对每个响应执行操作。

其次，代码实际上并没有停止，但我错误地搞砸了选择器`$('#template_form .ajax-msg')`并被更改为`'$('.modal .ajax-msg')`.

我希望这有助于未来的问题！

# php - 向 ACL 添加权限

> ID：10966453
> 
> 赞同：2
> 
> 时间：2012-06-10T04:53:57.697
> 
> 标签：php, symfony, acl

因为文档太少，学习 Symfony2 的 ACL 系统的来龙去脉一直很困难，但到目前为止，我已经设法理解了大部分概念。然而，有一个问题……

我希望能够添加一个权限，该权限`ADMIN`继承与 ACL 使用相同的条件`OWNER`。我的目标是在帖子页面中指定管理员控件，同时让管理员访问授予所有者的其他控件。

如果有人可以提供清晰的示例、文档或链接作为帮助，将不胜感激，甚至欢迎在正确的道路上轻推。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T09:02:26.107

来自[官方文档](http://symfony.com/doc/current/cookbook/security/acl.html#cumulative-permissions)

```
$builder = new MaskBuilder();
$builder
    ->add('owner')
;
$mask = $builder->get();

$acl->insertObjectAce(new UserSecurityIdentity('user1'), $mask); 
```

然后将相同的掩码应用于您的“管理员”用户。

那是你要找的吗？希望无论如何都能有所帮助；）

# javascript - 根据元素计数计算行号

> ID：10966455
> 
> 赞同：1
> 
> 时间：2012-06-10T04:54:37.670
> 
> 标签：javascript, html

我有一个指定宽度为 980px 的容器，其中包含内联块元素。每个元素的宽度和高度为 140px，这意味着每行/行可以包含 7 个元素，然后再下推到下一行/行。

```
<div id="container"><div id="ele1"></div><div id="ele2"></div><div id="ele3"></div><div id="ele4"></div><div id="ele5"></div><div id="ele6"></div><div id="ele7"></div><div id="ele8"></div><div id="ele9"></div><div id="ele10"></div><div id="ele11"></div><div id="ele12"></div><div id="ele13"></div><div id="ele14"></div></div> 
```

知道元素的数量后，如何使用 JavaScript（不是 jQuery）确定该元素所在的行/行和列？我需要能够对任意数量的元素执行此操作，因为该数字是动态的并且不是由脚本设置的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T05:03:11.410

这可能有效：

```
column = Number(yourNumber) % 7
row = Math.floor(Number(yourNumber) / 7) 
```

这假设您从 0 开始，然后第一个元素是 (0, 0)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-10T05:05:40.690

如果您知道从 0、1、... 开始的元素编号，请使用以下代码：

```
function getRowColNoFor(elementNo) {
    var col = elementNo % 7;

    return {
        col: col,
        row: (elementNo - col) / 7
    };
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-10T05:23:41.873

如果您知道您将有 7 个元素，您只需将元素的编号（从 0 开始）除以 7 即可得到它的位置。

如果将元素的数字除以 7，“整数”值就是它的行，余数就是它的列。

因此，要获得网格中的位置，您可以这样做：

```
function getPositon(index) {
    return {
        row: Math.floor(index / 7),
        column: index % 7
    };
} 
```

演示：http: [//jsfiddle.net/UVZ5f/1/](http://jsfiddle.net/UVZ5f/1/)

# web-services - 使用 Hibernate in Memory 缓存 Web 服务结果并运行查询

> ID：10966457
> 
> 赞同：0
> 
> 时间：2012-06-10T04:56:19.553
> 
> 标签：web-services, hibernate, caching, in-memory-database

我正在考虑在内存数据库（休眠）中缓存 Web 服务结果，并在缓存上运行查询以执行一些过滤和连接（对来自多个 Web 服务的数据。）

这是一个好主意（特别是从性能的角度来看，因为我必须将响应返回给客户）？有没有人做过类似的事情？还有其他选择吗？

谢谢。

# jquery - 使用带有自动完成功能的 jQuery 模板而不使用 ul/li

> ID：10966459
> 
> 赞同：0
> 
> 时间：2012-06-10T04:56:41.817
> 
> 标签：jquery, jquery-ui, autocomplete, jquery-autocomplete

@swatkins 对他自己关于使用带有 jquery UI 自动完成功能的 jQuery 模板的问题给出了一个绝妙的答案：[Is there a way to use jQuery templates (official plugin) with jQuery UI Autocomplete?](https://stackoverflow.com/questions/7288232/is-there-a-way-to-use-jquery-templates-official-plugin-with-jquery-ui-autocomp)

我的问题就是以此为基础的。

基本上我想知道如何使用 jQuery 模板构建一个不使用任何列表的自动完成功能？

我问的原因是我想在一个很小的空间中显示很多信息，并且用列表对其进行样式化似乎不允许这样做......另外，我真的很好奇:)

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T20:20:16.053

使用列表项，但嵌套 html 以在其中显示。然后，您可以根据需要设置列表项的样式以显示在列中。

这是我更新的小提琴：

[http://jsfiddle.net/XXeDd/8/](http://jsfiddle.net/XXeDd/8/)

# c - Win32在当前控制台执行子进程，不返回父进程退出

> ID：10966465
> 
> 赞同：0
> 
> 时间：2012-06-10T04:59:02.643
> 
> 标签：c, multithreading, winapi, process

我目前正在开发一个小的 win32 实用程序来读取配置文件/注册表项，并根据值，使用当前进程命令行参数执行子进程。这听起来很简单，并且已经与许多其他程序一起完成了很多次。在这种情况下，唯一的区别是，我希望能够在等待子进程结束时不让当前进程在后台运行。基本上，我想在当前控制台中启动子进程，传递标准输入等，然后退出当前进程，而不会退出子进程、丢失其控制台或返回当前进程的父进程。

到目前为止，这是我为尝试找出一种方法而写的内容：

```
#include <tchar.h>
#include <windows.h>
#include <tlhelp32.h>
#include <direct.h>
#include <string.h>
#include <stdio.h>

/* Macros for prettier code. */
#ifndef MAX_PATH
#   define MAX_PATH _MAX_PATH
#endif

#ifndef MAX_ENV
#   define MAX_ENV _MAX_ENV
#endif

/* Function Annotations/Declarations */
// Declare inline for MSVC's C compiler
#ifndef inline
#   define inline __inline
#endif

#ifndef bool
#   define bool BOOL
#   define true TRUE
#   define false FALSE
#endif

/* Utility macros */
#define log(x,...) _tprintf(TEXT("%s\n"), TEXT(x), __VA_ARGS__)
#define fatal(x,...) _tprintf(TEXT("ERROR: %s\n"), TEXT(x), __VA_ARGS__); ExitProcess(1)

// Search each process in the snapshot for id.
bool find_proc_id( HANDLE snap, DWORD id, LPPROCESSENTRY32 ppe )
{
    bool fOk;
    ppe->dwSize = sizeof(PROCESSENTRY32);
    for (fOk = Process32First( snap, ppe ); fOk; fOk = Process32Next( snap, ppe ))
        if (ppe->th32ProcessID == id)
            break;
    return fOk;
}

// Obtain the process and thread identifiers of the parent process.
bool parent_process(LPPROCESS_INFORMATION ppi)
{
    HANDLE hSnap;
    PROCESSENTRY32 pe;
    THREADENTRY32   te;
    DWORD id = GetCurrentProcessId();
    bool fOk;

    hSnap = CreateToolhelp32Snapshot( TH32CS_SNAPPROCESS|TH32CS_SNAPTHREAD, id );

    if (hSnap == INVALID_HANDLE_VALUE)
        return FALSE;

    find_proc_id( hSnap, id, &pe );
    if (!find_proc_id( hSnap, pe.th32ParentProcessID, &pe ))
    {
        CloseHandle( hSnap );
        return FALSE;
    }

    te.dwSize = sizeof(te);
    for (fOk = Thread32First( hSnap, &te ); fOk; fOk = Thread32Next( hSnap, &te ))
        if (te.th32OwnerProcessID == pe.th32ProcessID)
            break;

    CloseHandle( hSnap );

    ppi->dwProcessId = pe.th32ProcessID;
    ppi->dwThreadId = te.th32ThreadID;

    return fOk;
}

void execute_child(TCHAR *AppName)
{
    BOOL result;
    HANDLE hStdInput, hStdOutput, hStdError, hParent;
    TCHAR tempCmdLine[MAX_PATH * 2];  //Needed since CreateProcessW may change the contents of CmdLine
    PROCESS_INFORMATION processInformation, parentInformation;
    STARTUPINFO startupInfo;

    if (!parent_process( &parentInformation )) {
        fatal("Could not get parent process.");
    }

    if(!(hParent = OpenProcess(
        PROCESS_QUERY_INFORMATION |   
        PROCESS_CREATE_THREAD     | 
        PROCESS_VM_OPERATION |
        PROCESS_VM_WRITE,  // For CreateRemoteThread/WriteVirtualMemory
        FALSE, parentInformation.dwProcessId
    ))) {
        fatal("Could not open a handle to the parent process.");
    }

    memset(&processInformation, 0, sizeof(processInformation));
    memset(&startupInfo, 0, sizeof(startupInfo));

    if((hStdInput = GetStdHandle(STD_INPUT_HANDLE)) == INVALID_HANDLE_VALUE || !hStdInput) {
        CloseHandle(hParent);
        fatal("Failed to get stdin.");
    }

    if((hStdOutput = GetStdHandle(STD_OUTPUT_HANDLE)) == INVALID_HANDLE_VALUE || !hStdOutput) {
        CloseHandle(hParent);
        CloseHandle(hStdInput);
        fatal("Failed to get stdout.");
    }

    if((hStdError = GetStdHandle(STD_ERROR_HANDLE)) == INVALID_HANDLE_VALUE || !hStdError) {
        CloseHandle(hParent);
        CloseHandle(hStdInput);
        CloseHandle(hStdOutput);
        fatal("Failed to get stderr.");
    }

    startupInfo.cb = sizeof(startupInfo);
    startupInfo.dwFlags = STARTF_USESTDHANDLES;
    startupInfo.hStdInput = hStdInput;
    startupInfo.hStdOutput = hStdOutput;
    startupInfo.hStdError = hStdError;

    if (!CreateProcess(
            AppName,
            NULL,
            NULL,
            NULL,
            TRUE,
            CREATE_DEFAULT_ERROR_MODE|NORMAL_PRIORITY_CLASS|CREATE_NEW_PROCESS_GROUP|CREATE_SUSPENDED,
            NULL,
            NULL,
            &startupInfo,
            &processInformation
    )){
        CloseHandle(hParent);
        CloseHandle(hStdInput);
        CloseHandle(hStdOutput);
        CloseHandle(hStdError);
        fatal("CreateProcess failed!");
    }

    CloseHandle( hParent );
    CloseHandle( hStdInput );
    CloseHandle( hStdOutput );
    CloseHandle( hStdError );
    FreeConsole();
    ResumeThread(processInformation.hThread);
    CloseHandle( processInformation.hProcess );
    CloseHandle( processInformation.hThread );
    ExitProcess(0);
}

int _tmain(int argc, _TCHAR* argv[])
{
    execute_child(TEXT("python.exe"));

    return 0;
} 
```

现在，当从控制台外部执行时，这正是我想要的。打开一个 python shell 并且从上面的源代码编译的 parent.exe 没有运行。但是，当从现有命令提示符运行时，会发生以下情况：

```
Microsoft Windows [Version 6.1.7601]
Copyright (c) 2009 Microsoft Corporation.  All rights reserved.

C:\ShellEnv\j-tree\sbin\python\2.7x86>parent.exe

C:\ShellEnv\j-tree\sbin\python\2.7x86>ActivePython 2.7.2.5 (ActiveState Software Inc.) based on
Python 2.7.2 (default, Jun 24 2011, 12:21:10) [MSC v.1500 32 bit (Intel)] on win32
Type "help", "copyright", "credits" or "license" for more information.
>>> print 'hi'
Unable to initialize device PRN

C:\ShellEnv\j-tree\sbin\python\2.7x86> 
```

控制台最终陷入了一种奇怪的情况，即 Python 和命令提示符都在当前窗口中执行，并且任何输入都被传递给一个或另一个，或者在两者之间拆分。

我假设命令提示符在 parent.exe 的进程/主线程上使用 WaitForSingleObject，当该进程退出时，继续执行。我想出了一些我可以尝试解决这个问题的理论：

*   假设从 parent_process 返回的 dwThreadId 是正确的，我可以尝试挂起负责创建当前进程的线程，然后将代码注入我的子进程，以便在退出时恢复线程。这个想法的缺陷是它假设 parent.exe 是从命令提示符运行的，或者类似的东西正在等待 parent.exe 的退出。在 parent.exe 异步运行的情况下（例如，来自资源管理器的 ShellExecute），它将使该应用程序死锁。

*   同样，假设我有正确的信息，我可以尝试将包含 parent.exe 的 PROCESS_INFORMATION 结构的虚拟内存重写为子进程的虚拟内存。然而，这将需要一种可移植的方式来定位该内存块，并且还需要我检查当前进程和父进程的进程架构，并考虑数据类型大小可能存在的任何差异，等等。我也不是 100% 关于进程的写入限制是否允许我从子进程中执行此操作。（这意味着我可能必须将代码注入父进程中的远程线程来实现这一点，这是一个全新的头痛）

无论如何，我真的希望有一些我无法找到的内置 API 来处理这个问题。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T14:04:50.200

`exec` [使用函数家族的](http://msdn.microsoft.com/en-US/library/431x4c1w%28v=vs.110%29)成员怎么样？

调用这些函数之一会将当前进程替换为新创建的进程。

# clojure - Clojure, Closure, WebSocket, 在线聊天演示

> ID：10966471
> 
> 赞同：3
> 
> 时间：2012-06-10T05:00:39.790
> 
> 标签：clojure, websocket, closures

## 语境

我已经使用 Clojure 4 年多了。我最近设置了 Ring + Compojure，并且对它们的工作原理有了很好的了解。我对SVG也有很深的了解。

现在，我知道诸如 ClojureScriptOne、Google Closure 库以及设置 Clojure + JQuery + WebSocket 的各种在线演示之类的东西。

## 问题：

任何人都可以提供一个最小的演示来设置：

```
* WebSocket in ClojureScript with the google Closure Library?

* Perferably with something involving a basic 2 person chat. 
```

现在，我查看了 Google Closure 这本书。不幸的是，当这本书出版时，它主要关注拉机制（AJAX），它对基于推送机制的唯一建议是一个长期存在的 ajax 会话（通过 Comet 之类的东西）。显然，当时 WebSockets 还不成熟。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T07:47:39.487

[Aleph](https://github.com/ztellman/aleph)有这样一个例子

您需要对 Closure 的 WebSocket 对象做的唯一一件事就是将包装套接字的构造函数更改为 Firefox 的任何 Firefox 的 websocket 用于 Firefox（不记得它是什么，但它不是 WebSocket），或者至少那是你以前的必须这样做，但无论如何它都适用于 Chrome。Websockets 适用于 Chrome、Firefox、Opera 但不适用于 IE，但如果 IE 很重要，您可以使用一个库来修复使用 Flash 的问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-17T22:04:06.443

看看[httpkit](http://http-kit.org/ "httpkit") websocket 支持

# sql - SQL Server 2008 查找时间

> ID：10966473
> 
> 赞同：0
> 
> 时间：2012-06-10T05:01:11.377
> 
> 标签：sql, sql-server-2008

我试图获得两次之间的访问时间。

例子

```
accesstime    starttime   endtime
23:00         22:00       00:00:00 
```

我的查询看起来像这样

```
select accesstime 
from myTable 
where accesstime  between '22:00:00'and '00:00:00' 
```

当我运行查询时，我没有得到任何结果

为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T05:08:58.720

因为时间从`00:00:00`到`23:59:59`

所以，`22:00`比`00:00:00`同一天大

编辑：这考虑为`DateTime`. 如果他们是`Varchar`，你有同样的问题，因为`22:00`a`Varchar`大于`00:00:00`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T05:24:22.123

[BETWEEN](http://msdn.microsoft.com/en-us/library/ms187922.aspx)的相关资料：

> **如果test_expression**的值大于或等于 begin_expression 的值**且**小于或等于**end_expression**的值，则BETWEEN 返回 TRUE 。

 **在您的表中，访问时间“23:00”（测试表达式）大于“22:00:00”（开始表达式）但**不**小于“00:00:00”（结束表达式），因此它返回 false。

为了查看结果，请将您的查询更改为：

```
select accesstime from myTable 
where accesstime  between '00:00:00' and '23:00:01' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-10T06:00:14.723

我认为您可以**将**时间转换为**日期**时间，并通过**dateadd**函数将一天添加到时间“00:00:00”，然后它就可以正常工作。

示例代码在这里：

```
CREATE table EX_Time (accesstime nvarchar(100),starttime nvarchar(100),endtime nvarchar(100)) 

INSERT INTO EX_Time(accesstime,starttime,endtime)
VALUES (N'23:00:00',N'22:00:00',N'00:00:00')

select * 
FROM Ex_Time
Where convert(datetime,accesstime) BETWEEN convert(datetime,'22:00:00')
AND dateadd(day,1,convert(datetime,'00:00:00')) 
```**

# android - Android：当我在 Activity.onCreate 方法中请求启动两个服务时，2.3.6 主线程阻塞

> ID：10966474
> 
> 赞同：0
> 
> 时间：2012-06-10T05:01:30.073
> 
> 标签：android, multithreading, service, block, main

我正在开发一个应用程序，当应用程序启动时我需要启动后台服务。

最初我在 Application.onCreate() 方法中添加了第一个服务的启动过程。

之后，我意识到如果用户出于某种原因停止了后台线程，我需要重新启动服务。因此，我将服务启动代码从 Application.onCreate() 移至主 Activivity.onResume()。

根据文档，在已经运行的服务上调用 startService() 没有问题。

在那之前，一切都很好。我的第一个后台服务实现得很好。当它启动时，它会创建一个新线程来运行后台处理，而不会出现重大问题。

实施第一项服务后，我转到了第二项服务。这里没有问题。但是在实现它并在 Activity.onResume() 方法上添加服务启动调用之后。

```
private void startServices() {
    startTrackingService();
    startBacklogService();
}

private void startTrackingService() {
    if (Z10.DEBUG) {
        Log.i(LOG_TAG, "REQUESTING TRACKING SERVICE START");
    }  

    Intent serviceLauncher = new Intent(Main.this, TrackingService.class);
    startService(serviceLauncher);
    if (Z10.DEBUG) {
        Log.i(LOG_TAG, "TRACKING SERVICE START REQUESTED");
    }  
}

private void startBacklogService() {
    if (Z10.DEBUG) {
        Log.i(LOG_TAG, "REQUESTING BACKLOG SERVICE START");
    }  

    Intent serviceLauncher = new Intent(Main.this, BacklogService.class);
    startService(serviceLauncher);
    if (Z10.DEBUG) {
        Log.i(LOG_TAG, "BACKLOG SERVICE START REQUESTED");
    }  
} 
```

这段代码阻塞了 main 方法并且应用程序必须被杀死。

尝试调试应用程序（没有android源代码很难！！！），我意识到startService并没有真正启动服务，它只是将操作添加到待处理的Looper队列上。

如果我按顺序执行两个 startService 操作，主线程会阻塞，但如果在主线程上执行其他操作（与 UI 相关）之后，然后启动第二个服务，它就可以正常工作。

问题是我真的需要在应用程序启动时启动这两个服务，或者在主活动恢复时重新启动它们中的任何一个。

# c# - 如何使用左连接、聚合和 where 子句创建 Linq to Sql

> ID：10966479
> 
> 赞同：1
> 
> 时间：2012-06-10T05:03:38.490
> 
> 标签：c#, database, entity-framework, linq-to-sql

有谁知道如何将此查询转换为 LINQ to SQL？

```
SELECT posts.*, count(COMMENTS.*) AS comment_count FROM POSTS
LEFT JOIN COMMENTS on POSTS.id = COMMENTS.post_id
WHERE comments.date IS NULL OR comments.date >= [NOW]
GROUP BY posts.id
ORDER BY comment_count DESC 
```

它在 SQL 中很简单，但是我无法将 linq 转为 sql。任何帮助，将不胜感激！

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-10T05:19:15.667

你想要这样的东西：

```
var query =
    from p in POSTS
    join c in COMMENTS on p.id equals c.post_id into cs
    group new
    {
        Post = p,
        Comments = cs
            .Where(c1 => c1.date >= DateTime.Now)
            .Count(),
    } by p.id; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T05:14:36.547

只是一个建议，您可以随时使用这个很棒的工具

[http://www.sqltolinq.com/](http://www.sqltolinq.com/)

帮助转换

# c++ - 推送到成员向量时的段错误

> ID：10966480
> 
> 赞同：2
> 
> 时间：2012-06-10T05:04:23.060
> 
> 标签：c++, vector, segmentation-fault, push-back

这是一个相对较小但有段错误的项目。我搜索了很多做类似事情的帖子，虽然很多人似乎遇到了同样的问题，但没有一个能解决我的问题。

基本问题是这样的：我有一个`myGraph`带有成员向量的对象 ( ) 和一些方法。另一个类中的方法调用`myGraph`'s 方法之一，后者又调用另一个方法。在*该*函数内部，对 int 中的整数向量进行推送`myGraph`。但是，此推送会导致段错误。

在某种程度上，我一直在注释掉大部分代码（当然是在一个新的分支上）并将我的代码减少到稀疏的几个项目。（[其他帖子](https://stackoverflow.com/questions/2739354/segfault-on-vectorstruct)似乎表明这种事情可能是由其他地方的错误代码引起的）但我仍然遇到段错误。

接下来是淡化的文件，由少数未注释的内容组成。我说“淡化”是因为许多声明（现在为空的函数等）已被删除。如果您需要其他信息（例如，如果重要 - 不知何故 - 我在某处使用虚函数......作为一个激进的例子）请告诉我。

在 Dispatcher.h 中：

```
class myGraph;

class CDispatcher
{
public:
    CDispatcher(void);
    ~CDispatcher(void);

    void ProcessCall(string buf);

    myGraph* mymap;

}; 
```

在 Dispatcher.cpp 中：

```
void CDispatcher::ProcessCall(string buf) 
{
    mymap->getDistance(0,1);
}; 
```

在 mygraph.cpp 中：

```
int myGraph::getDistance(int start, int end) {
    Dijkstras(start,end);

    // This is just to return something
    return 5;
};

vector<int> myGraph::Dijkstras(int startVert,int endVert) {

    vertices_i.push_back(2); // This line results in a segfault
    cout << "push successful" << endl;

    // This is just to return something
    vector<int> unvisited;
    return unvisited;
}; 
```

mygraph.h：

```
typedef struct edge
{
    int endVert;
    int weight;
} edge;

typedef struct vertex
{
    long dist;
    bool visited;
    int prev;

    vector<edge> edges;
} vertex;
class myGraph
{
public:
    myGraph(int initSize);
    ~myGraph(void);

    int getDistance(int start, int end);
    vector<int> Dijkstras(int startVert,int endVert);

    //vector<vertex> vertices; // The original vector that was segfaulting
    vector<int> vertices_i; // Simpler vector, of just ints. Still segfaults

}; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-10T05:16:55.957

不可避免的结论是成员指针`myGraph* mymap`指向垃圾；您显然忽略了将其初始化为指向一个`myGraph`对象。您需要创建一个对象以在`CDispatcher`构造函数中引用它 - 即，

```
CDispatcher(void) : mymap(new myGraph(1)) {} 
```

# asp.net-mvc - 从 JQuery 调用中调用控制器方法发生两次并且还返回错误？

> ID：10966490
> 
> 赞同：0
> 
> 时间：2012-06-10T05:07:40.837
> 
> 标签：asp.net-mvc, asp.net-mvc-3, jquery, asp.net-ajax

大家好，我之前发布过类似的帖子，但这是另一个帖子，现在我的 Jquery 代码遇到了一个奇怪而奇怪的问题。在这里，我使用 Jquery 调用了一个控制器方法，但它调用了两次，所以这可能会导致我的数据库中有两个条目。这是我在 JQuery 中写的

```
<script type="text/javascript">
    $('#btnSubmit').click(function () {
        var instructorUrl = '@Url.Action("ApplyToBecomeInstructor", "InstructorApplication")';
        var currentUser = '@Model.CurrentUserId';
        var user = [];
        var educationList = [];
        var experience = $('#Experience').val();
        var isWilling = $('#WillingToTravel').is(":checked");
        $('#editorRows .editorRow').each(function () {
            var education = {
                UniversityOrCollege: $(this).find('.university').val(),
                AreaOfStudy: $(this).find('.area').val(),
                Degree: $(this).find('.degree').val(),
                YearReceived: $(this).find('.year').val()
            }
            educationList.push(education);
        });
        var applicationFromView = {
            EducationalBackgrounds: educationList,
            CurrentUserId: currentUser,
            Experience: experience,
            WillingToTravel: isWilling
        }
        $.ajax({
            type: 'POST',
            url: instructorUrl,
            dataType: 'JSON',
            async: false,
            data: JSON.stringify(applicationFromView),
            contentType: 'application/json; charset=utf-8',
            success: function (data) {
                return false;
            },
            error: function (data) {
            alert(xhr.status);
            alert(thrownError);
            alert(xhr.responseText);
                return false;
            }
        });
    });
</script> 
```

我的控制器动作看起来像这样

```
[HttpPost]
public ActionResult ApplyToBecomeInstructor(InstructorApplicationViewModel applicationFromView)
{
    Student thisStudent = this.db.Students.Where(o => o.StudentID == applicationFromView.CurrentUserId).FirstOrDefault();
    List<PaulSchool.Models.EducationalBackground> educationList = new List<EducationalBackground>();
    foreach (var educate in applicationFromView.EducationalBackgrounds)
    {
        var education = new Models.EducationalBackground
        {
            YearReceived = educate.YearReceived,
            Degree = educate.Degree,
            AreaOfStudy = educate.AreaOfStudy,
            UniversityOrCollege = educate.UniversityOrCollege
        };
        educationList.Add(education);
    }
    var instructorApplication = new InstructorApplication
    {
        BasicInfoGatheredFromProfile = thisStudent,
        Experience = applicationFromView.Experience,
        EducationalBackground = new List<Models.EducationalBackground>(),
        WillingToTravel = applicationFromView.WillingToTravel
    };
    instructorApplication.EducationalBackground.AddRange(educationList);
    this.db.InstructorApplication.Add(instructorApplication);
    this.db.SaveChanges();
    return this.Redirect("Index");
} 
```

显示的错误消息是 JSON Parsing error.. 但它让我感到困惑。我真的很想知道为什么会这样，有人可以看看并帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T05:14:09.873

这就是您的代码的作用：

```
$('#btnSubmit').click(function () { // attach a click handler for the button.
...
...
// Look for elements inside the button... 
UniversityOrCollege: $(this).find('.university').val(), 
```

从更改`click`为`submit`：

```
$('#formId').submit(function (e) { 
    ...
    // Now "this" is the form - not the button.
    // Look for elements inside the <form>
    UniversityOrCollege: $(this).find('.university').val(), 
    // Prevent the default form submition
    return false // Or: e.preventDefault(); 
```

另一个提示：使用 jQuery[`serialize`](http://api.jquery.com/serialize/)函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T05:13:48.707

`$('#btnSubmit').click()`每次按下按钮都会触发。用户经常双击按钮，即使它只需要单击一次，或者如果你没有给出任何迹象表明正在发生某些事情，他们会不耐烦并再次单击它。您需要一些方法来确定请求是否已发出。有办法做这个客户端和服务器端。最简单的客户端方法是禁用按钮以防止多次单击：

```
$('#btnSubmit').click(function () {
    // Disable the button so it can't be clicked twice accidentally
    $('#btnSubmit').attr('disabled', 'disabled');
    //...
    $.ajax({
        //...
        complete: function() {
            // Make sure we re-enable the button on success or failure so it can be used again
            $('#btnSubmit').removeAttr('disabled');
        }
    });
}); 
```

# django - 无需调用即可找到 Django URL 所需的权限？

> ID：10966493
> 
> 赞同：8
> 
> 时间：2012-06-10T05:08:42.223
> 
> 标签：django, menu, authorization

我的 Django 应用程序当前具有受“permission_required()”函数保护的 URL。

该函数以三种不同的方式调用。

1.  作为views.py 中的装饰器，带有硬编码的参数。
2.  作为一个普通函数，具有自动生成的参数，在自定义基于类的通用视图中。
3.  作为在 urls.py 中调用视图的函数，带有硬编码参数。

我现在正在向应用程序添加一个菜单系统，我需要让菜单条目反映用户是否有权请求每个菜单条目的 URL。（通过灰显或隐藏所述条目。）

*有没有一种方法可以在不*请求URL 的情况下查询 URL 所需的权限？

到目前为止，我想到的唯一解决方案是用无参数的“menu_permssion_required()”装饰器替换装饰器，并将所有权限硬编码到 Python 结构中。这似乎是倒退了一步，因为我的自定义基于类的通用视图已经自动生成了它们所需的权限。

有关如何制作反映当前用户 URL 权限的菜单系统的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T19:15:07.300

> 有没有一种方法可以在不请求 URL 的情况下查询 URL 所需的权限？

[User.has_perm()](https://docs.djangoproject.com/en/1.0/topics/auth/#django.contrib.auth.models.User.has_perm)和[User.has_module_perms()](https://docs.djangoproject.com/en/1.0/topics/auth/#django.contrib.auth.models.User.has_module_perms)

> 有关如何制作反映当前用户 URL 权限的菜单系统的任何建议？

我真的很喜欢这个问题，因为它涉及使用 django 制作网站的任何人，所以我觉得它非常相关。我自己也经历过，甚至在 2008 年的第一个 django 项目中[编写了一个菜单“系统”](http://djangosnippets.org/snippets/1091/)。但从那以后我尝试了 Pinax，我从他们的示例项目中学到的（这么多）东西之一是完全不必要的膨胀。

所以，我没有建议我会支持如何制作一个尊重请求用户权限的菜单“系统”。

我确实有一个关于如何制作一个尊重请求用户权限的简单菜单的建议，所以这可能不是完全无关的。

1.  **只需用纯 HTML 制作您的菜单**，它不会经常更改以至于必须生成它。这也将使您的 Python 代码更简单。

2.  添加到`settings.TEMPLATE_CONTEXT_PROCESSORS`：`'django.core.context_processors.PermWrapper'`

3.  使用[`{{ perms }} proxy`](https://docs.djangoproject.com/en/1.0/topics/auth/#id6)到 User.has_perms。

例子：

```
{% if perms.auth %}
    <li class="divider"></li>

    {% if perms.auth.change_user %} 
    <li>
        <a href="{% url admin:auth_user_changelist %}">{% trans 'Users' %}</a>
    </li>
    {% endif %} 

    {% if perms.auth.change_group %} 
    <li>
        <a href="{% url admin:auth_group_changelist %}">{% trans 'User groups' %}</a>
    </li>
    {% endif %} 

{% endif %} 
{# etc, etc #} 
```

这就是我保持导航**简单**、**愚蠢**和**不碍事的方式**。但我也总是在离菜单不远的地方包含[一个自动完成功能，以允许用户轻松导航到任何详细信息页面。](http://django-autocomplete-light.readthedocs.org/en/latest/navigation.html)所以，这就是我对 django 项目中导航的了解，我很想阅读其他答案！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-10T19:59:59.183

以下是如何解决您的问题的示例：

首先，创建一个装饰器包装器来代替permission_required：

```
from django.contrib.auth.decorators import login_required, permission_required, user_passes_test
from django.core.exceptions import PermissionDenied
from functools import wraps
from  django.utils.decorators import available_attrs

def require_perms(*perms):
    def decorator(view_func):
        view_func.permissions = perms
        @wraps(view_func, assigned=available_attrs(view_func))
        def _wrapped_view(request, *args, **kwargs):
            for perm in perms:
                return view_func(request, *args, **kwargs)
            raise PermissionDenied()
        return _wrapped_view
    return decorator 
```

然后，用它来装饰你的视图：

```
@require_perms('my_perm',)
def home(request):
..... 
```

然后，为您的菜单项添加一个标签：

```
from django.core.urlresolvers import resolve

def check_menu_permissions(menu_path, user):
    view = resolve(menu_path)
    if hasattr(view.func, "permissions"):
        permissions = view.func.permissions
        for perm in permissions:
            if user.has_perm(perm):
                return True # Yep, the user can access this url
            else:
                return False # Nope, the user cannot access this url
    return True #  or False - depending on what is the default behavior 
```

最后，在您的模板中，在构建菜单树时：

```
<button href="{{ some_path }} {% if not check_menu_permissions some_path request.user %}disabled="disabled"{% endif %} /> 
```

注意我没有用标签测试最后一部分，但我希望你明白了。这里的神奇之处在于在装饰器中为 view_func 添加权限，然后您可以使用 resolve(path) 访问它。我不确定这在性能方面的表现如何，但毕竟这只是一个想法。

**编辑**：刚刚修复了示例中的错误..

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-11T11:46:31.517

我有一个类似的问题，但它更深入一点。除了权限之外，我还想要基于隐藏在用户中的其他测试（即`is_staff`，或`user.units.count() > 1`）。在视图和模板中复制这些似乎容易出错。

您可以内省视图对象，并查看包装它的所有装饰器，并确定它们是否是检查（在我的情况下：第一个参数 Id`u`或`user`）。如果它们都通过，则允许呈现链接。

[获取包装函数的所有装饰器](http://schinckel.net/2012/01/20/get-decorators-wrapping-a-function/)更详细地描述了该技术。`{% url %}`您可以在[Django-menus](http://Bitbucket.org/schinckel/django-menus)找到将其包装成方便替代品的应用程序。

# protobuf-net - 没有为类型定义序列化程序：System.Drawing.Color

> ID：10966495
> 
> 赞同：3
> 
> 时间：2012-06-10T05:09:30.300
> 
> 标签：protobuf-net

为了减少网络流量，我想使用 protobuf-net 来代替`BinaryFormatter`，但是发生了以下错误：

```
No serializer defined for type: System.Drawing.Color 
```

**WB消息：**

```
[ProtoContract]
[Serializable]
public abstract class WBMessage
{
    [ProtoMember(1)]
    public Color setColor1;

    [ProtoMember(2)]
    public UInt16 userNo;

    public abstract WHITEBOARD_MESSAGE_TYPE MessageType
    {
        get;
    }

    [ProtoMember(3)]
    public string age;

    public enum WHITEBOARD_MESSAGE_TYPE
    {
        enWBBegin,
        enWBLine,
        enWBRectangle,
        enWBRectangleF,
        enWBEllipse,
        enWBEllipseF,
        enWBClearScreen,
        enWBText,
        enWBEnd
    };
} 
```

**WBMsgDrawBegin：**

```
[ProtoContract]
[ProtoInclude(1, typeof(WBMessage))]
public class WBMsgDrawBegin : WBMessage
{
    private const WHITEBOARD_MESSAGE_TYPE m_enMsgType =   WHITEBOARD_MESSAGE_TYPE.enWBBegin;
    public override WHITEBOARD_MESSAGE_TYPE MessageType
    {
        get
        {
            return m_enMsgType;
        }
    }

    [ProtoMember(4)]
    public int x;

    [ProtoMember(5)]
    public int y;

    [ProtoMember(6)]
    public bool m_bMouseDown;

    [ProtoMember(7)]
    public string name;
} 
```

**用法：**

```
WBMsgDrawBegin item1 = new WBMsgDrawBegin();
item1.setColor1 = Color.AliceBlue;
item1.name = "test";
item1.age = "31";

item1.x = 10998;
item1.y = 10089;

Stream stream = new MemoryStream();
MemoryStream ms = new MemoryStream();
Serializer.SerializeWithLengthPrefix<WBMsgDrawBegin>(ms, item1, PrefixStyle.Base128, 0); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-10T08:41:39.033

它不能保证处理所有已知的 BCL 类型，尤其是来自图形库之类的东西，这些类型并非在所有平台上都受支持。我会推荐：

```
public Color Foo {get;set;}

[ProtoMember(n, DataFormat=DataFormat.Fixed)]
private int FooSerialized {
    get { return Foo.ToArgb(); }
    set { Foo = Color.FromArgb(value); }
} 
```

这会将其序列化为固定的 4 字节块。如果你有很多颜色属性，你也可以使用“代理”来做一些非常相似的事情（更少的代码，但每个项目多出 2 个字节）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-10T06:07:44.897

那么问题是什么？

内置颜色类没有序列化程序。

如果您想通过线路传达颜色，您将不得不以其他一些表示形式进行，例如为 ARGB 发送一个 32 位整数，这对于颜色来说是非常常见的做法。

有许多传达颜色的标准方法。不过，我建议您坚持使用标准方式，而不是尝试定义自己的方式。只需坚持使用 32 位整数或 4 字节 ARGB。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-20T19:19:28.193

由于我整个早上都在与类似的东西搏斗，所以我要补充一点，另一种存储点、大小、矩形和颜色等的方法是使用 NET 的内置转换器。代码在 VB 中，但你应该足够好地理解漂移：

```
Imports System.Drawing
Imports System.ComponentModel

Private Function GetInvariantString(ByVal v As Object) As String
    Dim conv As TypeConverter = TypeDescriptor.GetConverter(v.GetType)
    Dim t As System.Type = v.GetType

    ' at least in VB '=' and 'Is' are not defined for Boolean 
    '  and System.Type so I cant find a way to word the Case 
    '  test so, it's inverted...only one Case can be true anyway
    Select Case True
        ...
        Case t Is GetType(Drawing.Point)
            Return conv.ConvertToInvariantString(v)

        Case t Is GetType(Drawing.Size)
            Return conv.ConvertToInvariantString(v)

        Case t Is GetType(Drawing.Color)
            Return conv.ConvertToInvariantString(v)

        Case Else
            Throw New ArgumentException("Unknown Type " & v.type.ToString)
    End Select

End Function 
```

的简单方法`myPoint.ToString`将返回类似`{X=11 Y=156}`但并不总是`FromString`对此处处理的类型的补充方法。 `ConvertToInvariantString`返回`11, 156`并可用于重构 Point（和其余部分）：

```
Private Function TypeFromInvariantString(ByVal pbnString As String,  _
            ByVal ttype As Type) As Object

    ' same thing...
    Select Case True
        Case ttype Is GetType(Point)
            Return TypeDescriptor.GetConverter(GetType(Drawing.Point)).ConvertFromInvariantString(pbnString)

        Case ttype Is GetType(Size)
            Return TypeDescriptor.GetConverter(GetType(Drawing.Size)).ConvertFromInvariantString(pbnString)

        Case ttype Is GetType(Color)
            Return TypeDescriptor.GetConverter(GetType(Drawing.Color)).ConvertFromInvariantString(pbnString)

        Case Else
            Throw New ArgumentException("Unknown Type " & ttype.ToString)
    End Select

End Function 
```

矩形、SizeF 等（甚至是字体）都可以以相同的方式处理。就我个人而言，`Color`我更喜欢存储/传递一个表示 ARGB 值的 Int，但 Invariant 字符串方法也很有效，如果颜色是像“Red”这样的命名颜色，那么`Red`就是返回/序列化的所有内容。用法：

```
' serializer version
<ProtoMember(6)> _
Private Property PBNImgPoint() As String
    Get
        Return GetInvariantString(_ImgPoint)
    End Get
    Set(ByVal value As String)
        _ImgPoint = TypeFromInvariantString(value, GetType(Point))
    End Set
End Property

' method used in code/program....
Friend Property ImgPoint() As Point
    Set(ByVal value As Point)
        _ImgPoint = value
    End Set
    Get
        Return _ImgPoint
    End Get
End Property 
```

显然，转换可以在每个 Getter/Setter 而不是调用的过程中发生，但我的试点/测试用例有多个点、矩形和大小，我想确保它们都得到相同的处理。

高温高压

# crystal-reports - 该字段不能汇总水晶报错

> ID：10966497
> 
> 赞同：0
> 
> 时间：2012-06-10T05:10:51.903
> 
> 标签：crystal-reports

我有关于水晶报告的问题。我创建了一个名为**PAT_DEP**的公式字段，公式如下。

```
Local NUMBERVAR PAT_DEP_AMT := 0;

IF NextIsNull({MYOBJ.PAT_DEPOSIT}) = TRUE THEN
    (        
        IF {MYOBJ.PAT_DEPOSIT} = PREVIOUS({MYOBJ.PAT_DEPOSIT}) THEN
            (                
                PAT_DEP_AMT := 0;
            )

        ELSE
           (
                PAT_DEP_AMT  := {MYOBJ.PAT_DEPOSIT};
            );
    )
ELSE
    (
        IF PREVIOUS({MYOBJ.PAT_DEPOSIT}) = NEXT({MYOBJ.PAT_DEPOSIT}) THEN
            (
                PAT_DEP_AMT := ToNumber(0);
            )
        ELSE
            (
                PAT_DEP_AMT  := {MYOBJ.PAT_DEPOSIT};
            );
    ) 
```

然后我创建了另一个名为**TOT_PAT_DEP**的公式字段，公式如下，就像上面的公式字段一样。

```
TOTAL_PAT_DEP := SUM(@PAT_DEP) 
```

但是得到水晶报告错误**该字段不能汇总**水晶报告错误。请帮助我怎么会得到这个错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T12:12:37.833

根据您的解释和公式，您似乎有一对多的关系，这给您带来了一些困难。举个例子：

订单表订单编号，总计，已付款

订单项目表订单号、行号、描述

当您加入这两个表时，您不能再对总计/已付列求和，因为它们将乘以订单行数。

克服这个问题的方法是使用密钥创建一个组。在我的示例中，您将按订单号进行分组。然后，您可以创建一个运行总计来对总计/已付列求和，但只会评估您的 Order # 组的变化。

那有意义吗？

# git - Git：Branch 领先于 X 次提交。没有帮助做 git pull

> ID：10966498
> 
> 赞同：5
> 
> 时间：2012-06-10T05:11:06.617
> 
> 标签：git

我确实看到了其他类似的问题，但我真的不明白为什么会发生这种情况。现在，我正在使用`git reset --hard HEAD`然后手动添加我的更改。建议的解决方案似乎是`git pull origin master`？但在那之后我仍然收到同样的信息。怎么了？如何进行合并？我对 GIT 还是比较陌生

```
$ git pull origin master
Nodester!
Enter passphrase for key '/home/jiewmeng/.ssh/id_rsa': 
From nodester.com:/node/git/jiewmeng/10267-f62c0a21d1a9d75ab7b6ace5858921d0
 * branch            master     -> FETCH_HEAD
Merge made by the 'recursive' strategy.

$ git branch -a
* master
  remotes/origin/master 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-10T06:20:39.803

正如“[为什么 Git 告诉我“你的分支比 'origin/master' 领先 11 次提交”中提到的那样。以及如何让它停止？](https://stackoverflow.com/questions/277077/why-is-git-telling-me-your-branch-is-ahead-of-origin-master-by-11-commits-a) ”

> “您的分支在...之前” =>**您需要推送到远程 master**。
> 运行“ `git diff origin/master`”查看本地存储库和远程主存储库之间的差异。

如果您在一次提交之前领先于远程存储库，那么远程存储库已经过时，而不是您。
拉扯也没用。

现在还要检查你是否真的在一个分支上（而不是在一个分离的头上）。
这是你的情况（你确实在`master`分支上）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-23T14:54:57.077

“分支在 X 提交之前领先”可能有 2 个原因：1）你有*真正的*本地提交，你需要做 'git push' 2）你的 'origin' 分支与远程端不同步。做：

```
git fetch 
```

（根本原因似乎与执行“git pull origin master”而不是“git pull”有关）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-10T06:12:02.260

分支通过 X 提交“领先”意味着您的本地存储库有一些远程存储库中不存在的新提交。首先尝试“git fetch”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-30T10:53:36.230

我在我的环境中调查了同样的问题并发现了这些事实：

Origin/master 是我执行克隆的提交时的标记（标签）。我没有在我这边创建任何提交，只是从原点拉动而没有变基。这导致同步我的仓库，但没有移动或更新原点/主位置。如果您执行推送（原点/主标签移动到您的推送位置）然后执行一些拉取一些新提交，则会出现相同的情况。

```
git log --graph --oneline -X master 
```

其中 X 是数字 >= 提交次数“提前”，您可以在 git status 调用之后看到。您可以在日志结果中看到原点/主标记的位置。这个内部 git 标记用于计算我们害怕的状态消息。

提交的哈希存储在 refs/remotes/origin/master 文件中。如果您删除此文件，源/主标记将消失，并且有关提前提交的信息也将不再显示。

如果您想将原点/主标记同步到当前主 HEAD，只需键入

```
git update-ref refs/remotes/origin/master cac0cab538b970a37ea1e769cbbde608743bc96d 
```

而不是我的哈希将你的头部哈希从：

```
git log -1 
```

或根据需要在文件内容上使用复制/粘贴。结果应该是一样的。

这对我有帮助，但我不知道还有什么受到影响。据我所知，此消息仅具有信息意义，而不是错误或警告。一切都按预期对我有用，没有任何限制。

# java - 将加速度计值推送到另一个类

> ID：10966503
> 
> 赞同：0
> 
> 时间：2012-06-10T05:12:09.967
> 
> 标签：java, android, class, accelerometer

我查看了许多其他线程，这些线程显示了如何使用加速度计值，甚至跨越多个类，但是我发现的方法都没有工作，无论我做什么，我都无法在其他类中显示这些值比定义它们的那个。我知道我有一个可以工作的加速度计，并且我的 AccelerometerReader 类正在正确获取值，因为我已经通过在该类中打印它们来测试它们。我在下面有一些代码，但我不知道为什么它不起作用，尽管我相信只有起始值被传递到另一个类，并且它们没有更新。任何帮助将非常感激！

**AccelerometerReader 类**

```
import android.app.Activity;
import android.hardware.Sensor;
import android.hardware.SensorEvent;
import android.hardware.SensorEventListener;
import android.hardware.SensorManager;
import android.os.Bundle;

public class AccelerometerReader extends Activity implements SensorEventListener {

private SensorManager sensorManager;
private float ax;   // these are the acceleration in x, y and z axes
private float ay;
private float az;

public AccelerometerReader(float x, float y, float z) {
    this.ax = x;
    this.ay = y;
    this.az = z;
}

@Override
public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        //setContentView(R.layout.main);

        sensorManager=(SensorManager) getSystemService(SENSOR_SERVICE);
        sensorManager.registerListener(this, sensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER), SensorManager.SENSOR_DELAY_FASTEST);
   }

 @Override
 public void onAccuracyChanged(Sensor sensor, int accuracy) {
   }

 @Override
 public void onSensorChanged(SensorEvent event) {
     if (event.sensor.getType() != Sensor.TYPE_ACCELEROMETER)
           return;

     if (event.sensor.getType()==Sensor.TYPE_ACCELEROMETER){
           setValueX(event.values[0]);
           setValueY(event.values[1]);
           setValueZ(event.values[2]);

     }

 }

 public void setValueX(float x) {
     ax=x;
 }

 public float getValueX() {
    return ax;
 }

 public void setValueY(float y) {
     ay=y;
 }

 public float getValueY() {
     return ay;
 }

 public void setValueZ(float z) {
     az=z;
 }

 public float getValueZ() {
     return az;
 }
} 
```

**加速度计类**

```
import android.app.Activity;
import android.os.Bundle;
import android.widget.TextView;

public class Accelerometer extends Activity {

private float ax, ay, az;
TextView tvX, tvY, tvZ;
AccelerometerReader acc = new AccelerometerReader(ax, ay, az);

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    tvX = (TextView) findViewById(R.id.tvX);
    tvY = (TextView) findViewById(R.id.tvY);
    tvZ = (TextView) findViewById(R.id.tvZ);

    tvX.setText("" + ax);
    tvY.setText("" + ay);
    tvZ.setText("" + az);
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T05:42:14.477

您在代码中有很多问题：

1.  您有一个**Activity**执行一项功能（即获取“ACCELEROMETER”值），但是您希望在用户查看其他 Activity 时执行此功能。这通常很糟糕，并且不起作用。您将需要创建一个**Service**。

2.  您将值从一个类传递到另一个类，当您传递这些值时，它们只是副本。因此，对其他类的这些值所做的任何事情都不会影响原始类。

    ```
    //What ever happens to ax, ay, and az will never be known to your class!
    AccelerometerReader acc = new AccelerometerReader(ax, ay, az); 
    ```

3.  你这样做一次：

    ```
    tvX.setText("" + ax);
    tvY.setText("" + ay);
    tvZ.setText("" + az); 
    ```

    即使 ax、ay 和 az 更改了当前代码，它们也只会显示一次。每次值更改时，您都必须调用该代码才能显示它们。

好吧，祝你好运！

# session - 使用 shiro 和 mvn jetty 插件

> ID：10966504
> 
> 赞同：0
> 
> 时间：2012-06-10T05:12:28.997
> 
> 标签：session, jetty, shiro, maven-jetty-plugin

我从 apache shiro doc 页面下载了“ [Spring MVC + Shiro + myBatis + JSR-303 Validation](http://bubba-h57.github.com/H57_Shiro/) ”示例，我想用 maven jetty 插件运行它，所以我打开 pom.xml 并放置这样的东西

```
<plugin>
            <groupId>org.mortbay.jetty</groupId>
            <artifactId>maven-jetty-plugin</artifactId>
            <version>6.1.10</version>
                    <configuration>
                            <scanIntervalSeconds>10</scanIntervalSeconds>
                            <stopKey>foo</stopKey>
                            <stopPort>9999</stopPort>
                            <webAppConfig>
                            <contextPath>/</contextPath>
                            </webAppConfig>
                            <scanIntervalSeconds>10</scanIntervalSeconds>
                            <!-- <webAppSourceDirectory></webAppSourceDirectory> -->
                    </configuration>
                    <executions>
                            <execution>
                                    <id>start-jetty</id>
                                    <phase>pre-integration-test</phase>
                                    <goals>
                                            <goal>run</goal>
                                    </goals>
                                    <configuration>
                                            <scanIntervalSeconds>0</scanIntervalSeconds>
                                            <daemon>true</daemon>
                                    </configuration>
                            </execution>
                            <execution>
                                    <id>stop-jetty</id>
                                    <phase>post-integration-test</phase>
                                    <goals>
                                            <goal>stop</goal>
                                    </goals>
                            </execution>
                    </executions>
            </plugin> 
```

之后我使用 mvn jetty:run 启动应用程序，我尝试在示例中注册一个用户，我得到一个异常，例如：“ **java.lang.ClassCastException: org.apache.shiro.web.servlet.ShiroHttpSession 不能转换为org.mortbay.jetty.servlet.AbstractSessionManager$SessionIf** "，谁能告诉我为什么，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T15:49:53.977

ShiroHttpSession 很可能无法转换为 AbstractSessionManager$SessionIf 因为它不是它的实例。这看起来像 Jetty 中的一个错误。我复制了这个，然后将码头插件升级到版本 6.1.26 并且错误消失了。

# localhost - 修改我的 /etc/hosts 以使用不同端口上的两个应用程序？

> ID：10966506
> 
> 赞同：0
> 
> 时间：2012-06-10T05:13:17.650
> 
> 标签：localhost, development-environment, host

我正在开发一个 Web 应用程序，它将有两个部分在两个单独的域上运行（在 mydomain.com 上的 RoR 和在 sub.mydomain.com 上的另一台服务器）。在本地开发时，我可以在 localhost:port1 和 localhost:port2 上运行应用程序。

为了测试，修改我的 /etc/hosts 文件以使其工作很方便：

```
mydomain.com -> localhost:port1
sub.mydomain.com -> localhost:port2 
```

有没有办法做到这一点？人们建议如何同时开发两者？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T05:27:17.897

hosts 文件完全不知道 TCP 端口。它仅用于名称到第 3 层分辨率。

mfussenegger 发布的解决方案很有趣，但我认为更容易提出的问题是：为什么有必要在不同的端口上运行它们？使用任何支持 HTTP 1.0 的 Web 服务器，您可以简单地将每个站点的主机标头定义为该站点的域名，请求将被路由到相应的站点。

您的主机文件将有两个条目都指向本地主机。

链接到有关如何配置的 apache 文档： [http ://httpd.apache.org/docs/2.2/vhosts/examples.html](http://httpd.apache.org/docs/2.2/vhosts/examples.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T05:23:33.580

您必须运行像 nginx 或 apache 这样的网络服务器。nginx 配置可能如下所示：

```
server {
    listen          8080;
    server_name     mydomain.com

    root            /path/to/your/static/files;

    location    / {
        proxy_pass_header Server;
        proxy_set_header Host $http_host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Scheme $scheme;
        proxy_pass http://127.0.0.1:8090;
    }
}

server {
    listen          8080;
    server_name     sub.mydomain.com

    root            /path/to/your/static/files;

    location    / {
        proxy_pass_header Server;
        proxy_set_header Host $http_host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Scheme $scheme;
        proxy_pass http://127.0.0.1:8092;
    }
} 
```

`proxy_pass http://127.0.0.1:8092;`作为您的 RoR 应用程序的 url。

# vb.net - RichEdit 控件的字体属性

> ID：10966507
> 
> 赞同：0
> 
> 时间：2012-06-10T05:13:20.237
> 
> 标签：vb.net, user-interface, richedit

我在最新版本的 VB.NET 中使用旧的优质 RichEdit 控件我想为将不时键入的文本设置字体属性。因此，RichEdit.Font 和 RichEdit.SelectedFont 不是一个选项。

正确的做法应该是什么？

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T05:30:01.573

它实际上是 SelectionFont。一些示例代码，用一个按钮和一个放在表单上的 RTB 试试：

```
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
    With RichTextBox1
        .SelectionLength = 0
        .SelectionFont = New Font(.Font, FontStyle.Bold)
        .Focus()
    End With
End Sub 
```

输入内容，单击按钮，注意您现在输入的所有内容都是粗体的。

# jquery - 访问/解码 JSON 数据

> ID：10966508
> 
> 赞同：0
> 
> 时间：2012-06-10T05:13:24.700
> 
> 标签：jquery, json

改写这个问题。

1.  用户点击一个链接，将他们带到**editUser.php?id=1**（其中 ID 是用户 ID 号）
2.  文档就绪的 editUser.php 页面调用该函数`loadAjaxVals(script, json_action, id);`。此函数位于外部 JS 库中。script 和 json_action 值与这个问题无关。ID 是来自 URL 查询字符串的 ID
3.  loadAjaxVals() 向 PHP 脚本发送请求，该脚本将数据作为 json_encoded() 数据返回给 loadAjaxVals(script, json_action, id)
4.  loadAjaxVals() 获取 json 编码数据并循环遍历它，将结果输出到 editUser.php 上的表单。该脚本从 JSON 编码数据中获取名称值对，这些数据成为表单元素 ID 和值
5.  表格已填充并且全部完成。

但是，我想要位于 editUser.php 上的第二个脚本来解析 JSON 并从中提取 1 条数据。

我不知道如何访问 JSON 或解析 JSON。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T07:13:13.007

JSON 仅在`loadAjaxVals`函数中可用。我建议您编辑`loadAjaxVals`以接受回调函数。

像这样的东西：

```
function loadAjaxVals(script, json_action, id, callback){
    // get JSON
    // code
    // parse JSON
    // more code
    if($.isFunction(callback)){
        callback(data); // pass callback the parsed JSON data
    }
} 
```

然后这样称呼它：

```
loadAjaxVals(script, json_action, id, function(data){
    // use data
    console.log(data);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T05:37:22.913

好吧，您可以使用“in”运算符来检查对象是否具有属性...

```
alert('enable_class' in obj) 
```

如果该对象确实具有 enbable_class ，则应该为 true 或 false

至于您的第二个问题，您可能正在使用对象的缓存版本，这很常见，相信我，我建议您清除缓存并重试，我还推荐 Google Chrome javascript 调试器内置并附带一个非常好的控制台和许多其他细节...... :)

如果确实问题出在缓存上，那么它们有几种解决方法……一旦您确认，我会详细说明。

# http - HTTP GET 和 POST 语义和限制

> ID：10966519
> 
> 赞同：10
> 
> 时间：2012-06-10T05:15:21.000
> 
> 标签：http, http-post, http-get

本周早些时候，我不得不做一些感觉像是违反语义的事情。让我解释。

我正在制作一个简单的 AJAX 客户端应用程序，它是向具有给定数量参数的服务发出请求。由于整个应用程序基本上是只读的，我认为使用 HTTP GET 是要走的路。我必须传递的一些参数很简单（例如排序顺序或页码）。

但是，所需参数之一可能是可变长度的，这让我很担心。由于我正在对 GET 请求的查询字符串中的所有参数进行编码，因此在我看来，这[为请求 URL 设置了（大约）2000 个字符的不必要上限](https://stackoverflow.com/questions/417142/what-is-the-maximum-length-of-a-url)。无论如何，我不喜欢看到 500 个字符长的请求 URL。

因此，由于 POST 请求没有这样的限制，我决定切换。但这感觉不对。我的印象是 POST 表示修改数据 - 但我将它用于简单的只读请求。

有一个更好的方法吗？执行一个 GET，有很多参数？我听说过一种方法 - 您自己执行*参数*的初步 POST ，然后执行 GET。但是，这种技术还有很多不足之处。

但回顾这个具体案例，**HTTP 请求方法的真正语义和限制是什么？**为什么 GET 不支持任何类型的参数负载？在 URL 中使用查询字符串对我来说几乎是一种 hack。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-10T05:41:19.853

关于这个问题的几点：

*   HTTP 规范 (RFC 2616) 不禁止 GET 请求带有参数，因此这与 HTTP GET 本身的语义无关。但是，许多 HTTP 堆栈（用于客户端、服务或代理）禁止 HTTP 请求中的主体，您不能使用它们的事实主要是实现细节（相当普遍），而不是 HTTP GET 请求的语义问题
*   同样，RFC 也没有指定 URI（或查询字符串）长度的限制。它主要是由几个 HTTP 服务器堆栈实现的安全缓解措施，以防止不良客户端消耗服务器资源（例如，在 IIS/ASP.NET 中，默认限制为 2k，但您可以通过 web.config 中的某些元素增加它）。同样，这不是语义问题，而是实际问题。
*   如果您遵循 REST 理念，POST 请求确实表明数据修改，但是有许多用于只读操作的 HTTP POST 请求示例。SOAP 在其所有请求中都使用 POST，无论它调用的操作是“安全的”还是“修改的”操作。因此，您也可以将 POST 用于这些操作。但是，如果偏离 REST（以及“规范的”HTTP）使用，您将失去该协议的一些特性，例如可应用于 GET 请求但不适用于 POST 的缓存。
*   您使用两个请求的示例（带有参数的 POST + GET 来“获取”结果）似乎有点矫枉过正。正如我所提到的，POST 请求并不一定意味着修改资源，因此当一个请求足够时，您不必创建新的“协议”（POST+GET）来访问您的操作。

# algorithm - 计算可见建筑物最小数量的算法？

> ID：10966521
> 
> 赞同：1
> 
> 时间：2012-06-10T05:15:48.910
> 
> 标签：algorithm

我一直在尝试制定一种算法来解决问题。在这个问题中，我们有一张包含一些建筑物的照片。将照片分成 n 个垂直区域（称为碎片），并给出每个碎片中建筑物的高度。

一座建筑可能跨越多个连续的部分，但每部分只能包含一个可见的建筑物，或者根本没有建筑物。我们需要找到最少的建筑物数量。

例如给定，

3（件数）

1 2 3（高度）ans = 3

3

1 2 1 答案 = 2

6

1 2 3 1 2 3 ans = 5（一个数字有助于显示重叠。）。

虽然我觉得我明白了，但我无法得到一个可靠的算法。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T06:09:10.360

您可以从给定数组中找到最小的数字，并考虑该数字的所有出现。这会将数组拆分为多个子数组，现在您需要递归地解决每个子数组的问题。

在示例中：

```
1 2 3 1 2 3 (total = 0) 
```

最小的数是 1：

```
x 2 3 x 2 3 (total = 1) 
```

现在你有 2 个子数组。求解第一个 - 最小的数字是 2：

```
 x 3       (total = 2) 
```

最后你有一个元素：total = 3 求解另一个子数组使其成为 5。

以下是 C# 中的一些代码：

```
int Solve(int[] ar, int start, int end){
    //base for the recursion -> the subarray has single element
    if(end-start == 1) return 1;

    //base for the recursion -> the subarray is empty
    if(end-start < 1) return 0;

    //find min
    int m = int.MaxValue;
    for(int i = start; i < end; i++)
        if (ar[i] < m) m = ar[i];

    int total = 1;
    //find the subarrays and their contribution recursively
    int subStart = start;
    for(int subEnd = start; subEnd < end; subEnd++){
        if(ar[subEnd] == m) {
            total += Solve(ar, subStart, subEnd);
            subStart = subEnd + 1;
        }
    }
    total += Solve(ar, subStart, ar.Length);

    return total;
} 
```

# python - 在浏览器上打开 python 文件时出现 500 Internal Server Error

> ID：10966526
> 
> 赞同：0
> 
> 时间：2012-06-10T05:17:33.823
> 
> 标签：python, apache, server-configuration

我无法打开我的 python 文件。我是使用 python 的新手，我来自 PHP 背景，这对我来说完全不同。我在服务器“public_html/python/index.py”上创建了一个测试文件，其中包含一个简单的 hello world 代码：

```
#!/usr/bin/python

print 'Content-type: text/html\r\n'
print '\r\n'
print 'Hello, World!' 
```

我一直在环顾四周，显然我需要执行一些配置步骤才能运行 python 文件。

在 shell y 上，确保通过运行`python`和工作安装了 python：

```
Python 2.4.3 (#1, Feb 22 2012, 16:05:45) 
[GCC 4.1.2 20080704 (Red Hat 4.1.2-52)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> 
```

然后我寻找安装python的正确路径，`type -p python`它是正确的：

```
user@domain.com [~]# type -p python
/usr/bin/python 
```

最后，我在一篇博客中读到，为了在 cgi-bin 文件夹之外执行 python 文件，我需要使用以下几行修改我的 .htaccess 文件：

```
Options +ExecCGI
AddHandler cgi-script .cgi .pl .py 
```

这也不起作用，但即使我尝试在`cgi-bin`文件夹中运行它，我仍然会遇到同样的错误。

以防万一我也更改了文件的权限，但什么也没有：

```
user@domain.com [~]# chmod a+x public_html/python/index.py 
```

毕竟，当我尝试在 Web 浏览器上打开 url 时，我仍然收到 500 内部服务器错误。

当我执行时，`od index.py -c`我得到以下信息：

```
0000000   #   !   /   u   s   r   /   b   i   n   /   p   y   t   h   o
0000020   n  \r  \n  \r  \n   p   r   i   n   t       '   C   o   n   t
0000040   e   n   t   -   t   y   p   e   :       t   e   x   t   /   h
0000060   t   m   l   \   r   \   n   '  \r  \n   p   r   i   n   t    
0000100   '   \   r   \   n   '  \r  \n   p   r   i   n   t       '   H
0000120   e   l   l   o   ,       W   o   r   l   d   !   '
0000135 
```

感谢您对这个不起眼的 python 新手的帮助和指导。顺便说一句，我在专用服务器中使用 WHM 和 CPanel。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T05:26:17.953

要将标题与正文分开，您需要添加`\r\n` **两次**。此外，所有标题都需要用一个单独的分隔`\r\n`

源应该是这样的，

```
import sys

sys.stdout.write('Content-type: text/html\r\n')
sys.stdout.write('\r\n')
sys.stdout.write('Hello, World!') 
```

另一个问题可能是您的 shebang 行的行尾。它应该是unix之类的。这意味着`#!/usr/bin/env python`应该以`\n`. 尝试使用一些显示行尾的编辑器打开它。或在命令提示符下`od -c index.py`。它将显示行尾。如果是`\r\n`，您需要制作`\n`.

### 更新：

在偏移量 21 处，您有`\r`. 那就是问题所在。`\r`通过以下命令删除

```
tr -d \r < index.py > new.index.py 
```

现在`new.index.py`应该是`\n`行结束了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T05:27:31.587

如果您使用的是 Apache，那么您应该使用`mod_python`and `WSGI`.

# c++ - 如何使用 boost atomic 来消除竞争条件？

> ID：10966528
> 
> 赞同：3
> 
> 时间：2012-06-10T05:18:11.237
> 
> 标签：c++, linux, atomic, boost-thread, race-condition

我正在尝试使用 boost::atomic 在 linux 上进行多线程同步。

但是，结果并不一致。

任何帮助将不胜感激。

谢谢

```
#include <boost/bind.hpp>
#include <boost/threadpool.hpp>
#include <boost/thread/mutex.hpp>
#include <boost/thread.hpp>
#include <boost/atomic.hpp>

boost::atomic<int> g(0) ;

void f()
{

    g.fetch_add(1, boost::memory_order_relaxed);

    return ;
 }
 const int threadnum = 10;
 int main()
 {
    boost::threadpool::fifo_pool tp(threadnum);
    for (int i = 0 ; i < threadnum ; ++i)
            tp.schedule(boost::bind(f));
    tp.wait();
    std::cout << g << std::endl ;
    return 0 ;
  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T05:25:42.463

我不熟悉 boost 线程库或 boost::threadpool，但在我看来，当您访问 g 的值时，线程不一定完成，因此您将获得 0 到 10 之间的一些值。

这是你的程序，修改为使用标准库，插入了连接，以便提取添加发生在 g 的输出之前。

```
std::atomic<int> g(0);

void f() {
    g.fetch_add(1, std::memory_order_relaxed);
}

int main() {
    const int threadnum = 10;
    std::vector<std::thread> v;

    for (int i = 0 ; i < threadnum ; ++i)
        v.push_back(std::thread(f));

    for (auto &th : v)
        th.join();

    std::cout << g << '\n';
} 
```

### 编辑：

如果您的程序即使与添加的程序仍然不一致，`tp.wait()`那就令人费解了。添加应该在线程结束之前发生，我认为线程结束将与 同步`tp.wait()`，这发生在读取之前。所以所有的加法都应该在打印 g 之前发生，即使你使用 memory_order_relaxed，所以打印的值应该是 10。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T05:32:24.447

以下是一些可能有帮助的示例：

*   [http://www.chaoticmind.net/~hcb/projects/boost.atomic/doc/atomic/usage_examples.html](http://www.chaoticmind.net/~hcb/projects/boost.atomic/doc/atomic/usage_examples.html)

基本上，您正在尝试使用“锁定”来“保护”“关键区域”。

您可以设置或取消设置信号量。

或者你可以“交换”一个提升“原子”变量。例如（来自上面的链接）：

```
class spinlock {
private:
  typedef enum {Locked, Unlocked} LockState;
  boost::atomic<LockState> state_;

public:
  spinlock() : state_(Unlocked) {}

  lock()
  {
    while (state_.exchange(Locked, boost::memory_order_acquire) == Locked) {
      /* busy-wait */
    }
  }
  unlock()
  {
    state_.store(Unlocked, boost::memory_order_release);
  }
}; 
```

# batch-file - 批处理：将制表符分隔为管道分隔

> ID：10966530
> 
> 赞同：0
> 
> 时间：2012-06-10T05:18:41.260
> 
> 标签：batch-file, csv

编辑问题：

现在，我可以从制表符更改为管道分隔符。但是数据在文本之后有空格。如何在 bat 中添加代码以修剪空间？

原始问题：

我想创建夜间批处理来更改由制表符分隔的文本文件分隔为管道分隔。如果数据在文本后有空格。如何修剪空间？

前 ：

FileName : Customer_Tab.pwf --> 即文本文件

按制表符分隔列的数据：

```
Customer Number Customer Name   Partner Number  Partner Name    Customer Country

1ABC    Jame    1234    Anny    USA

2DEF    Susan   5678    Prissy  UK 
```

转换为由管道分隔的数据

文件名：Customer_Pipe.csv

数据 ：

```
Customer Number|Customer Name|Partner Number|Partner Name|Customer Country

1ABC|Jame|1234|Anny|USA

2DEF|Susan|5678|Prissy|UK 
```

请帮我创建批处理。

我不知道如何为这个问题创建批处理。提前谢谢了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T13:19:56.947

批处理是修改文本文件的糟糕选择。获得一个健壮的解决方案过于复杂，而且速度很慢。但这是可以完成的。

```
@echo off
setlocal disableDelayedExpansion

set input="Customer_Tab.pwf"
set output="Customer_Pipe.csv"

::There should be a TAB character after the equal below
set "tab=   "

>%output% (
  for /f "delims=" %%A in ('findstr /rn "^" %input%') do (
    set ln=%%A
    setlocal enableDelayedExpansion
    set "ln=!ln:*:=!"
    if defined ln set "ln=!ln:%tab%=|!"
    echo(!ln!
    endlocal
  )
) 
```

该解决方案将读取 Unix ( `<LF>`) 和 Windows 样式 ( `<CR><LF>`) 行。输出将是 Windows 风格的线条。

对上述内容的唯一限制是每行的长度必须 < ~8k。

该`tab`变量不是必需的。我用它来使代码的作用更加明显。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-10T05:36:40.827

Assuming you mean batch as in Windows, the easiest way is to probably head on over to the [GnuWin32 packages page](http://gnuwin32.sourceforge.net/packages.html) and pick up a copy of `sed`.

Then you can simply replace tabs with pipe symbols with something like:

```
sed "s/\t/|/g" inputfile >outputfile 
```

Or, if you don't mind getting your hands dirty with a little C coding:

```
#include <stdio.h>
int main (void) {
    int ch;
    while ((ch = fgetc (stdin)) != EOF)
        putchar ((ch == '\t') ? '|' : ch);
    return 0;
} 
```

Compiling that program `tab2pipe.c` into the executable `tab2pipe` will allow you to run it as:

```
tab2pipe <inputfile >outputfile 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-10T08:18:40.487

```
setlocal enabledelayedexpansion
del Customer_Pipe.csv
for /f "delims=" %%i in (Customer_Tab.pwf) do (
    set line=%%i
    >> Customer_Pipe.csv echo !line:    =^|!
) 
```

`!line:`最后一行后面有一个制表符

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-10T05:35:53.787

I'm not sure how to do this through a batch file, but if you have php installed on your system you could use simply call a small php script from your batch file like this:

```
 [convert.batch]
 php -f covert.php

 [convert.php]
 <?php
 // read entire file into an array
 $rows = file('Customer_Tab.pwf');
 // create output file
 $fp = fopen('Customer_Pipe.csv', 'w');
 foreach($rows as $row) {
   // replace tabs with pipes
   $data = str_replace("\t", "|", $row);
   // write formatted row to output file
   fwrite($fp, $data);
 }
 fclose($fp);
 ?> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-11-06T09:21:48.027

在记事本中打开制表符分隔文件

`"`删除每行开头和结尾的引号 ( )（如果有的话）。加上最顶部的任何单个单词，在您可能认为的列标题之上......稍后再次打开文件时，它们都会抛出列标题识别

在*“标点符号视图”*中打开**Microsoft Word**（通过单击顶部工具栏上看起来像音乐符号的那个斑点）

 *在 Word 中，键入“制表符”空格，您将看到一个指向右侧的箭头。将其复制到剪贴板

在记事本中，选择*编辑->替换*并将标签标记粘贴到“查找内容”字段中，并将管道符号放在“替换为”字段中，然后选择“全部替换”

任务完成。将文件另存为，`*.txt`但在其前面加上单词前缀，`pipe`以便您知道它在文件夹中是哪一个。在**Excel**中将其作为`*.txt`文件打开，使用管道作为*“其他”*中的分隔符并取消选中选项卡复选框。*

# android - Android 浏览器自动调整文本大小

> ID：10966534
> 
> 赞同：5
> 
> 时间：2012-06-10T05:19:53.893
> 
> 标签：android, html, css, media-queries

**我有一个项目在 iPhone 上以 0.5ems**链接显示16px 文本字体非常好。

但是，当我切换到 Android 浏览器时，文本字体会自行放大，并且我的链接位置会出错。

我的链接在一个

```
<p><a>[Link]</a></p> 
```

陈述。

有什么方法可以防止 Android 文本自行调整大小？或者有更好的解决方案吗？

编辑：

我刚刚意识到安卓浏览器也不允许自动滚动。为什么会这样？iPhone 和 Android 浏览器不是都以 webkits 为基础吗？即使使用相同的技术，为什么它们如此不同？是否有任何额外的属性我应该在 CSS 中声明以使其与 Safari 对应项一样工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-18T20:40:28.750

我也有类似的问题。我有一个专为 Retina 显示器设计的设计，但视网膜显示器的像素密度实际上为 2，因此像素不一定是像素（非视网膜 iphone 像素宽度：320 像素，视网膜：640 像素）。

为了解决这个问题，我把它放在`<head>`:中`<meta name='viewport' content='width=device-width, initial-scale=.5, maximum-scale=.5'>`，这样普通手机就会按我的预期缩放，而视网膜显示屏也会适当地缩放（半比例）。

我不确定您使用的是哪种设计，但我会尝试使用初始比例和最大比例，尝试 0.5 和 1 看看你会得到什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-10T05:28:09.683

如果使用像素（px），则与屏幕像素密度有关。iPhone“视网膜”显示屏显示的文本与您的 Android 设备不同。

这篇文章很好地涵盖了这个主题：http: [//kyleschaeffer.com/best-practices/css-font-size-em-vs-px-vs-pt-vs/](http://kyleschaeffer.com/best-practices/css-font-size-em-vs-px-vs-pt-vs/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-18T21:46:19.140

我发现了一个可能有助于解决另一个问题的设置，即[iPhone 上的字体大小呈现不一致](https://stackoverflow.com/questions/2545542/font-size-render-in-iphone)：

```
body {
    -webkit-text-size-adjust: 100%;
} 
```

另一个问题描述了另一个值[，iPhone 的字体大小问题](https://stackoverflow.com/questions/3466434/font-size-issue-with-iphone)：

```
html {
    -webkit-text-size-adjust: none; /* Prevent font scaling in landscape */
} 
```

似乎其中之一可能会阻止 android 浏览器调整大小。希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-22T07:17:30.603

如果您想阻止 Android 自动缩放像素值，可以尝试将其添加到视口元数据中：

```
target-densitydpi=device-dpi 
```

这是一个很好的参考：

[http://designbycode.tumblr.com/post/1127120282/pixel-perfect-android-web-ui](http://designbycode.tumblr.com/post/1127120282/pixel-perfect-android-web-ui)

# php - 通过 Zend_Form_Element_Select 传递 SQL 数组

> ID：10966540
> 
> 赞同：0
> 
> 时间：2012-06-10T05:23:09.700
> 
> 标签：php, zend-framework, zend-form

我目前正在尝试以下代码：

```
 $sql = $db->query("select id,username,fullname from userss ORDER BY fullname ASC");
        while($row = $sql->fetch()) {
            $username[] = $row['username'];
        }
        $form = new Zend_Form();
        $form->setAction('/index/change')
             ->setMethod('post');

        $element = new Zend_Form_Element_Select('foo', array(
            'multiOptions' => array(
                $username,
                )));
        $form->addElement($element);
        echo $form; 
```

所需的结果是显示用户名来自 SQL 和全名来自 sql`<select>`的元素的表单。`<option value='username'>Full Name</option>``username``fullname`

现在，它显示`<option value='0'>Full Name</option>`

我不太确定如何指定数组的第一部分，以便它本质上是用户名 => 全名

有什么建议么？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T05:44:22.903

要在 a 中设置选项的`Zend_Form_Element_Select`值，数组键定义值，数组值定义用户看到的选择中的文本。

试试这个：

```
$element = new Zend_Form_Element_Select('foo', array(
    'multiOptions' => array(
        $username  => $fullname,
        $username2 => $fullname2,
))); 
```

您看到 0 因为数组没有字符串键，它默认使用数字索引的数组键作为值。

给定您的代码，您可以这样做：

```
$username = array();

while($row = $sql->fetch()) {
    $username[$row['username']] = $row['fullname'];
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-10T06:27:54.397

为了使填充选择元素更容易，ZF 提供了 fetchPairs

```
 $sql = "select username,fullname from userss ORDER BY fullname ASC";
      $db =  Zend_Db_Table::getDefaultAdapter();
     $select = new Zend_Form_Element_Select('foo');
     $select->setMultiOptions($db->fetchPairs($sql)); 
```

这种方式可以避免您自己迭代数据（for、while 循环）。

# javascript - 使用花哨的框获取“无法加载请求的内容”（尽管控制台中没有错误）

> ID：10966547
> 
> 赞同：1
> 
> 时间：2012-06-10T05:24:23.287
> 
> 标签：javascript, jquery, fancybox

我正在使用 fancybox 来弹出一个简单的 vimeo 弹出窗口：http: [//fancyapps.com/fancybox/](http://fancyapps.com/fancybox/)

这是我的 jQuery：

```
$(".fancybox").fancybox({
    openEffect: 'none',
    closeEffect: 'none',
    padding: 0
}); 
```

这是我的 HTML：

```
<a class="fancybox" href="http://vimeo.com/5319920">
    <img class="video_preview" src="/assets/home/video_preview.png">
</a> 
```

问题是我得到一个`The requested content cannot be loaded`没有任何记录错误的错误。显然脚本被调用了。

这里可能会发生什么，有什么想法吗？我完全不知所措。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-10T21:37:47.920

你只需要另外两件事：

1）。添加 fancybox-media 帮助`js`文件，如（检查您自己的路径）：

```
<script type="text/javascript" src="{your_path}/helpers/jquery.fancybox-media.js"></script> 
```

2）。将 helpers 媒体选项添加到您的脚本中：

```
$(".fancybox").fancybox({
    openEffect: 'none',
    closeEffect: 'none',
    padding: 0, //<-- notice I added a comma here ;)
    helpers : {
     media : {}
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T06:04:36.177

可能存在一些问题，但我知道以下应该有效：将 href 更改为：

```
//player.vimeo.com/video/36031564?hd=1&autoplay=1&show_title=1&show_byline=1&show_portrait=0&color=&fullscreen=1 
```

或者

```
http://player.vimeo.com/video/36031564?hd=1&autoplay=1&show_title=1&show_byline=1&show_portrait=0&color=&fullscreen=1 
```

并添加`data-fancybox-type="iframe"`

演示：http: [//jsfiddle.net/lucuma/9wAdV/180/](http://jsfiddle.net/lucuma/9wAdV/180/)

```
<a class="fancybox" href="//player.vimeo.com/video/36031564?hd=1&autoplay=1&show_title=1&show_byline=1&show_portrait=0&color=&fullscreen=1" data-fancybox-type="iframe"><img src="http://fancyapps.com/fancybox/demo/1_s.jpg" alt=""/></a>

$(document).ready(function() {
    $('.fancybox').fancybox({

    });
});​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-10T07:01:11.773

如果您在计算机上本地尝试此操作，则加载项可能正在尝试使用链接访问视频

> file://player.vimeo.com/video/5319920?hd=1&autoplay=1&show_title=1&show_byline=1&show_portrait=0&color=&fullscreen=1

您可以通过提供以[http://player.vimeo.com](http://player.vimeo.com)开头的完整 URL （由 @lucuma 回答）或更改 $.fancybox.helpers.media.beforeLoad 方法来更改此设置。此方法为包括 vimeo 在内的许多网站提供支持。此方法覆盖您提供的 href 例如它转换

[http://vimeo.com/5319920](http://vimeo.com/5319920)

到（如果您在本地运行）

file://player.vimeo.com/video/5319920?hd=1&autoplay=1&show_title=1&show_byline=1&show_portrait=0&color=&fullscreen=1

尝试如下更改 media.beforeLoad 函数，将 http:// 附加到最后一行的 href，它应该可以工作..

```
$.fancybox.helpers.media.beforeLoad = function(opts, obj) {
    var href = obj.href || '',
        type = false,
        rez;

    if ((rez = href.match(/(youtube\.com|youtu\.be)\/(v\/|u\/|embed\/|watch\?v=)?([^#\&\?]*).*/i))) {
        href = '//www.youtube.com/embed/' + rez[3] + '?autoplay=1&autohide=1&fs=1&rel=0&enablejsapi=1';
        type = 'iframe';

    } else if ((rez = href.match(/vimeo.com\/(\d+)\/?(.*)/))) {
        href = '//player.vimeo.com/video/' + rez[1] + '?hd=1&autoplay=1&show_title=1&show_byline=1&show_portrait=0&color=&fullscreen=1';
        type = 'iframe';

    } else if ((rez = href.match(/metacafe.com\/watch\/(\d+)\/?(.*)/))) {
        href = '//www.metacafe.com/fplayer/' + rez[1] + '/.swf?playerVars=autoPlay=yes';
        type = 'swf';

    } else if ((rez = href.match(/dailymotion.com\/video\/(.*)\/?(.*)/))) {
        href = '//www.dailymotion.com/swf/video/' + rez[1] + '?additionalInfos=0&autoStart=1';
        type = 'swf';

    } else if ((rez = href.match(/twitvid\.com\/([a-zA-Z0-9_\-\?\=]+)/i))) {
        href = '//www.twitvid.com/embed.php?autoplay=0&guid=' + rez[1];
        type = 'iframe';

    } else if ((rez = href.match(/twitpic\.com\/(?!(?:place|photos|events)\/)([a-zA-Z0-9\?\=\-]+)/i))) {
        href = '//twitpic.com/show/full/' + rez[1];
        type = 'image';

    } else if ((rez = href.match(/(instagr\.am|instagram\.com)\/p\/([a-zA-Z0-9_\-]+)\/?/i))) {
        href = '//' + rez[1] + '/p/' + rez[2] + '/media/?size=l';
        type = 'image';

    } else if ((rez = href.match(/maps\.google\.com\/(\?ll=|maps\/?\?q=)(.*)/i))) {
        href = '//maps.google.com/' + rez[1] + '' + rez[2] + '&output=' + (rez[2].indexOf('layer=c') ? 'svembed' : 'embed');
        type = 'iframe';
    }
    console.log(type);
    console.log(href);
    if (type) {
        obj.href = "http://" + href;
        obj.type = type;
    }
}​ 
```

# php - 在同一浏览器中限制用户访问

> ID：10966548
> 
> 赞同：0
> 
> 时间：2012-06-10T05:24:39.737
> 
> 标签：php, login, restrictions

我正在制作一个基于 php 的应用程序。当两个用户从同一浏览器中的不同选项卡登录时，他们可以访问彼此的页面。如何防止这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T05:29:20.283

我看到有4个解决方案：

1.  您可以尝试为该窗口（在本例中为选项卡）命名以使用 JavaScript 检测特殊窗口：

    ```
    if(window.name==4711) {...} 
    ```

2.  使用带有 GET 参数而不是 cookie 的会话。

3.  使用具有在该子域上运行的正常 cookie 的随机子域。

4.  使用一个普通的 cookie，它被限制在一个“虚拟”目录中，使用 mod_rewrite 时该目录并不真正存在。[基于此评论的想法](https://stackoverflow.com/questions/10966548/restrict-user-acess-in-same-browser/10966565?__=1212380324#comment14319063_10966548)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T05:32:54.097

使用`$_SESSION`或`$_COOKIE`存储在用户登录和更新数据库时创建的生成密钥，以便当用户更改页面时，您可以根据该生成的密钥访问他们的信息。此外，您可能需要创建一个简单`function`的检查密钥而不是为您的页面使用另一个功能，如果它像一个菜单栏或登录框，将它包装在一个`if statement`类似的

```
if(checkUser($_COOKIE['MYSID'])){
   // User is logged in so show whatever
} else {
   // Login box here
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-10T05:47:19.283

`window.name`在打开浏览器选项卡时为每个用户使用属性或设置 cookie。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-10T06:34:10.793

您的应用程序没有检查用户当前是否已登录，因此当用户输入凭据并登录时您必须首先执行设置会话变量

```
$_SESSION['logged_in'] = "true"; 
```

那么您必须在页面开头对索引页面进行如下修改

```
<?
if($_SESSION['logged_in']=='true'){
header('location:USERS_SPECIFIC_PAGE_AFTER_LOGIN.EXT')
}
else{
header('location:login_page.ext');
}

?> 
```

# vb.net - 日期在 VB.net 中没有正确转换

> ID：10966551
> 
> 赞同：2
> 
> 时间：2012-06-10T05:25:29.750
> 
> 标签：vb.net, date, cultureinfo

似乎我一直在约会方面遇到问题。我正在使用以下代码：

```
 Dim LocalDateCultureProvider As New CultureInfo(CultureInfo.CurrentCulture.ToString)
         Dim CurrentDate As DateTime = Convert.ToDateTime(System.DateTime.Now.ToString("dd/MM/yyyy"), System.Globalization.CultureInfo.InvariantCulture)

        ExpiryDate = DateTime.ParseExact(strDate, "dd/MM/yyyy", LocalDateCultureProvider)
        If DateTime.Compare(ExpiryDate, CurrentDate) < 0 Then

MsgBox("This file has expired.")
            Exit Sub
        End If 
```

在这里，我将 strDate 读取为一个字符串，例如，它的值为“29/09/2012”但是，在 ExpiryDate 行中，它转换为 #09/29/2012# 以便与今天的日期进行比较在 CurrentDate 中存储（在我看来是正确的）为 #10/6/2012# 我得到 If 条件为真（错误地）。

顺便说一句，我也试过 Dim LocalDateCultureProvider As New CultureInfo(System.Globalization.CultureInfo.InvariantCulture.ToString)

只是看看这是否导致了问题。我正在尝试构建适用于所有文化的东西。无论本地设置是什么，我都想通过将当前系统日期与作为字符串接收的到期日期进行比较来测试到期日期。请告诉我如何去做，这样我才能得到一致的结果。

TIA，奇达

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T05:42:35.623

不，您错误地解析了 CurrentDate 。CultureInfo.InvariantCulture 需要前一个月，但您先将其格式化为当天。您正在编写不必要的代码，只需修复：

```
 If DateTime.Compare(ExpiryDate, DateTime.Now) < 0 Then 
```

# backbone.js - 无法填充简单的集合和输出以查看

> ID：10966553
> 
> 赞同：0
> 
> 时间：2012-06-10T05:25:44.883
> 
> 标签：backbone.js

正如你所看到的，我在骨干方面很新，我不知道为什么这不起作用？？？

我收到这个错误？

> 未捕获的类型错误：无法调用未定义的“on”方法

## 代码

```
TodoItem = Backbone.Model.extend({});

TodoList = Backbone.Collection.extend({
    model: TodoItem,
    url: "todo"
});

var TodoView = Backbone.View.extend({
    el: '#content',
    initialize: function() {
        this.model.bind('change', this.render, this);
    },
    render: function(model) {
        this.$el.html('test');
    }
});

$(function() {

    var todoList = new TodoList();

    todoList.fetch();

    new TodoView();

}); 
```

## URL TODO - JSON

> [ {description: 'Pick up milk.', status: 'incomplete', id: 1},
> {description: '去洗车', status: 'incomplete', id: 2} ]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T05:35:49.990

您`this.model`在视图中使用：

```
initialize: function() {
    this.model.bind('change', this.render, this);
}, 
```

但是您在创建视图时没有指定模型：

```
new TodoView(); 
```

这应该看起来更像：

```
new TodoView({ model: some_model }) 
```

如果您想`TodoView`查看整个集合，请使用`this.collection`：

```
initialize: function() {
    this.collection.on('change', this.render, this);
} 
```

并`collection`在创建视图时提供选项：

```
new TodoView({ collection: todoList }); 
```

另请注意，这`todoList.fetch();`是一个 AJAX 调用，因此您在创建视图时可能没有任何内容`todoList`，您可以绑定到`'reset'`事件以在出现某些内容时重新渲染：

```
initialize: function() {
    _.bindAll(this, 'render');
    this.collection.on('change', this.render);
    this.collection.on('reset',  this.render);
} 
```

您也可以使用[`_.bindAll`](http://documentcloud.github.com/underscore/#bindAll)将函数绑定到`this`，这样您就不需要使用第三个参数到`on`。

顺便说一句，`bind`是 的别名`on`，`bind`仍然有效，但`on`它是新代码的首选方法；AFAIK，名称已更改为`on`更好地匹配较新的 jQuery 命名方案。

# facebook - Facebook Graph API 事件分页不起作用？

> ID：10966555
> 
> 赞同：2
> 
> 时间：2012-06-10T05:26:44.883
> 
> 标签：facebook, facebook-graph-api, pagination

我正在尝试通过 Facebook 的 Graph API 访问过去的事件。

我得到了恰到好处的时事（我上个月参加的那个和将来的那个）

> https://graph.facebook.com/me/events?access_token=[ACCESS_TOKEN]

然而，分页组件“previous”和“next”并没有真正起作用，“previous”实际上指向已经在“me/events”中列出的未来事件。而“下一个”只返回一个空的“数据”结构。

我还尝试了具有不同先前时间戳的“since”（例如“me/events?since=1304238280”），但它不起作用，它总是返回与“me/events”返回的事件相同的事件. 但是当我访问时，我肯定有更多过去的事件

> [https://www.facebook.com/events/past/](https://www.facebook.com/events/past/)

我没有正确使用图形 API 还是什么？我还注意到关于 Graph API 的分页问题有很多问题，但似乎还没有一个明确的答案。

任何信息/建议/参考将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T14:05:04.567

从我所见，似乎在事件结束后大约两周，Facebook 将事件数据从`events`表中移出并移到另一个未通过 API 公开的数据中。内部 Facebook 服务器可以访问此表，因此您可以从 Facebook webapp 中查看过去的事件。

我假设这是一个隐私问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-29T08:43:19.527

尝试使用第一个事件的 ID 添加“之前”查询字符串，例如：[https](https://graph.facebook.com/me/events?&before=388551911259170) ://graph.facebook.com/me/events?&before=388551911259170 。您可以参考以下链接：[https ://developers.facebook.com/docs/reference/api/pagination/](https://developers.facebook.com/docs/reference/api/pagination/)

# c# - 如何创建 SQL Server Compact 3.5 .sdf 文件并连接到它？

> ID：10966559
> 
> 赞同：2
> 
> 时间：2012-06-10T05:27:37.847
> 
> 标签：c#, .net, sql-server-ce

我创建了一个 SQL Server Compact 数据库（`.sdf`文件），我想连接到它以执行一些插入、删除...。

这是我的创建代码：

```
 if (File.Exists(dbfilename))
     File.Delete(dbfilename);

  string connectionString = "Data Source=" + dbfilename + "&quot;";

  SqlCeEngine engine = new SqlCeEngine(connectionString);
  engine.CreateDatabase();
  engine.Dispose();

  SqlCeConnection conn = null;

  try
  {
        conn = new SqlCeConnection(connectionString);
        conn.Open();

        SqlCeCommand cmd = conn.CreateCommand();
        cmd.CommandText = "CREATE TABLE Contacts (ID uniqueidentifire, Address ntext)";
        cmd.ExecuteNonQuery();
  }
  catch { }
  finally
  {
         conn.Close();
  } 
```

这是真的吗？

我怎样才能连接到它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T05:35:20.920

That connection string is broken.

```
&quot; 
```

is not a valid entity where you are trying to use it. Fix your connection string.

Also, you will need to associate the command with the connection, either in the constructor or after the fact.

Please read through an example [such as this one](http://arcanecode.com/2007/04/13/sql-server-compact-edition-with-c-and-vbnet/), which was the first google result for "connect sql compact example c#":

# configuration - 您希望如何安装 clojure 模块化贡献？

> ID：10966566
> 
> 赞同：3
> 
> 时间：2012-06-10T05:29:47.500
> 
> 标签：configuration, clojure, clojure-contrib

旧的整体式 clojure.contrib 可作为 .jar 从您获得 clojure .jar 的同一位置获得，您可以通过将类路径指向它来使用它。据我所知，新的模块化贡献在 clojure .jar 中不可用——相反，它们作为源文件存在于 github 上。您使用它们的预期方式是什么？比如说，我想在 clojure.math.numeric-tower 中使用一些东西。我会怎么做？

我发现[如何在 RHEL 6.1/JDK7 上安装 Clojure 1.3 with contribs？](https://stackoverflow.com/questions/8617541/how-do-i-install-clojure-1-3-with-contribs-on-rhel-6-1-jdk7)，但唯一的答案（“使用 leiningen”）不够详细，我无法弄清楚。（在 clojars 中搜索 numeric-tower 产生的结果......什么也没有。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T08:09:20.530

如[Maven 设置和存储库](http://dev.clojure.org/display/doc/Maven+Settings+and+Repositories)中所述，部署所有 clojure 工件的存储库是[Sonatype OSS Nexus](https://oss.sonatype.org/content/groups/public/)。如果您不想采用 leiningen 或 maven 方式，我仍然建议您考虑一次性实验，您仍然可以从该存储库手动下载所有工件。具体来说，[这里](https://oss.sonatype.org/content/groups/public/org/clojure/math.numeric-tower/)是所有上传的`clojure.math.numeric-tower`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-10T09:32:12.703

我可以理解不愿意使用 leiningen，尽管我写这句话比创建一个新项目花费了更长的时间。

对于这类问题，我通常的第一站是[http://dev.clojure.org/display/design/Where+Did+Clojure.Contrib+Go](http://dev.clojure.org/display/design/Where+Did+Clojure.Contrib+Go) 然后单击最新版本并获取我想要的工件和版本，然后添加一个像这样到 project.clj 的依赖项部分的行

```
[math.numeric-tower "0.0.1"] 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-10T16:18:22.163

您可以通过将其信息添加到 project.clj 文件中的 :dependencies 来安装一个 contrib 模块。下次您运行`lein`某项内容时，它会注意到您的更改并自动为您抓取库。

我[在这里写了一些更详细的说明](http://www.unexpected-vortices.com/clojure/brief-beginners-guide/libs-management-and-use.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-11T08:42:26.327

如果你使用 Clojure，你真的应该使用 Leiningen 或 Maven 来管理你的依赖。我相信随着您的项目变得更大并且具有更复杂的构建要求，这些是保持复杂依赖关系图的唯一明智的方法。

例如，我使用 Maven 并在我的项目的 pom.xml 中包含以下内容以包含数字依赖项：

```
 <dependency>
        <groupId>org.clojure</groupId>
        <artifactId>math.numeric-tower</artifactId>
        <version>0.0.1</version>
    </dependency> 
```

所有模块化的 Clojure 贡献库都可以以相同的方式包含在内。

# android - mobile app dev - how to create crossplatform app with automatic file download with access to mobile file system? (sample code?)

> ID：10966569
> 
> 赞同：0
> 
> 时间：2012-06-10T05:30:11.093
> 
> 标签：android, mobile, filesystems, windows-mobile

I need to create some kind of automatic file downloader (for a specific website - over HTTP or HTTPS) which is able to place the downloaded files in a directory on the mobile which can accessed e.g. bei media players (to play mp3 files) or other software (e.g. to open pdf files). In other words: Which have "file-system-access" on the mobile.

It should be crossplattform, so I should be able to create a native app (and distribute it via the respective app-stores) of (must-have) Android, iOS, Windows Phone and (nice-to-have) the "other" plattforms like blackberry and so on.

It would be great if someone could post some lines of sample-code or link to small sample apps.

PS: It would be nice if the SMS-inbox could be read, but that's (nice-to-have), too.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T13:27:34.743

您将无法跨平台执行此操作。

Win Phone、Android 和 iOS 是完全不同的操作系统。

您将需要 3 种不同的软件工具来开发您的应用程序（Visual Studio 和其他 2 种），并且您将必须拥有并维护 3 种不同的安装。

# javascript - ajax error with javascript

> ID：10966570
> 
> 赞同：1
> 
> 时间：2012-06-10T05:30:30.757
> 
> 标签：javascript, ajax, dom

I am using the following function which has worked fine up until now, but I am frequently getting the following error:

> [Exception... "Component returned failure code: 0x80004005 (NS_ERROR_FAILURE) [nsIXMLHttpRequest.send]" nsresult: "0x80004005 (NS_ERROR_FAILURE)" location: "JS frame :: [http://www.myURL.info/manage/sharedLibrary.js](http://www.myURL.info/manage/sharedLibrary.js) :: getFile :: line 406" data: no]

**NOTE** error line is indicated below directly after comment in code block.

**ADDITIONAL RESEARCH** this is apparently a common issue with firefox. Does anyone have a cleaner way to do [this]?[1](http://www.quirksmode.org/blog/archives/2005/09/xmlhttp_notes_a_1.html)

The function has worked perfectly up until now and is as follows:

```
function getFile(url){
    var AJAX = null;
    try{
        if(window.XMLHttpRequest){
            AJAX = new XMLHttpRequest();
        }else{
            AJAX = new ActiveXObject("Microsoft.XMLHTTP");
        }
        if(AJAX){
            AJAX.open("GET", url, false);
            //The line below is line 406 in the error code.
            AJAX.send(null);
            return AJAX.responseText;
        }else{
            return false;
        }
    }catch(err){
        var a = prompt("", err);
    }
} 
```

I am using firefow as my browser. if I crash Firefox and relaunch the error is no longer present yet does resurface after a bit of time. The use case is not totally precise.

Is there some variable I should be resetting with each request?

If I try and catch, the error seems to break some underlying functionality that is not reset until the browser is relaunched.

Any help would be appreciated!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T06:49:29.970

尝试

```
AJAX.onreadystatechange = function(){ var text = AJAX.responseText}; 
```

前

```
AJAX.send(null); 
```

# database-design - Educational project for Database systems like PintOS?

> ID：10966571
> 
> 赞同：3
> 
> 时间：2012-06-10T05:31:27.350
> 
> 标签：database-design, language-agnostic, operating-system, computer-science

[Pintos Project](http://www.scs.stanford.edu/10wi-cs140/pintos/pintos.html) was a very educational experience for me. I like the idea of making a set of test cases pass and working with a live system.

Are there educational projects like this for Database Systems?

Edit: My focus would be to create a dbms engine

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T12:04:46.527

我想您需要一个专注于教育并因此易于阅读的代码项目（更具体地说，是一个 DBMS？）？

在这件事上，我没有发现任何过分有用的东西。通常，大多数“免费”课程和在线资源都提供例如关于高效 SQL 使用的说明，而其他的则侧重于开发简单（并且非常专注）的 DBMS 系统。以 db-class 为例

或多或少有两个教育/学术 DBMS 系统“学校”：

*   第一个当然更受欢迎，它基于 Elmasri 和 Navathe 的“数据库系统基础”，被认为是该领域的“圣经”。这些课程通常促进“组件堆栈”的创建，例如（从低级到高级）：

    *   磁盘块和中间内存管理
    *   记录和索引管理
    *   查询解析、优化和实用程序
    *   意见
*   另一个基于“The Third Manifestor”的教程 D（未来数据库系统的基础，作者：Date 和 Darwen）。网上有很多这样的实现，例如“Rel”、“Dee”、“Duro”、“MightTyD”等，可能值得一看，但不是最好的资源。

PS：MINIX 和 PintOS 都是教操作系统的好软件！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-17T11:40:03.647

几年前[loxim](http://loxim.sourceforge.net/)项目已经启动。它是实验性的半结构和对象数据库。它使用完全组合语言 SQBL。人们正在攻读博士学位和开发它的硕士论文。我不知道它仍在开发中，但您可以联系项目负责人并尝试一下。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-20T14:08:34.007

尽管它不是一个设计为教育程序的项目，但参与开源数据库将是一个不错的选择。关系方面有大佬 MySQL (http://www.mysql.com/) 和 PostgreSQL (http://www.postgresql.org/)，然后是 CouchDB (http://couchdb.apache. org/) 或 MongoDB (http://www.mongodb.org/) 用于“NOSQL”端。

当然，在这些努力中，从小处着手总是最好的，所以我会推荐 SQLite (http://www.sqlite.org/) 之类的东西。

事实上，如果你有足够的野心，你可以围绕理解 SQLite 设计、架构和代码来设计自己的教育计划。然后将其发布到网上供其他人欣赏和吸收。

# css - Seo and div display:none

> ID：10966575
> 
> 赞同：1
> 
> 时间：2012-06-10T05:31:49.753
> 
> 标签：css, wordpress, seo, hidden-field

I'm just wondering if display:none is affecting my sites seo as I have for certain keywords dropped rank in google over the past few days since implementing this into a new homepage re-design.

I am using wordpress and displaying random post images on the homepage, getting the excerpt and hiding it using display:none and when a user hovers the image it displays the excerpt as a tooltip.

I have read a few conflicting articles on this and watched Matt Cutts youtube video but that doesnt really give me an answer for the way I have implemented it.

So I am hoping someone on here can give me a bit more insight as to whether it is not good seo practice or doesn't make much difference?

Thanks

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-10T06:21:21.733

Google bot 不关心 CSS display:none，googlebot 看到的是您的 html 源代码。用 css 隐藏的任何内容在 html 源代码中都是可见的。

对您的 CSS 文件进行二次检查，检查您是否有任何显示：无；在你的 CSS 上如果有的话，会对隐藏的内容（链接、关键字块等）进行某种检查。如果发现您隐藏关键字或链接，您将受到惩罚:)

其他常见的检查是你的链接的css，比如`a {display: none;}`或者`a {color: #ffffff;}`会引发一个标志。在最后一项中，检查以确定主体或任何容器的背景颜色。

Matt Cutts 不会告诉你它是如何工作的，因为它是一项艰巨的任务，到目前为止有很大的失败，因为 css 有时会变得复杂并且你需要进行大量检查。

如果有显示，则站点上只有简单的危险信号：无；

附带说明一下，如果您的 html ( `<style type="text/css"> .some-class {display: none;}</style>`) 上有样式块或带有样式的 div ( `<div style="display:none;">keyword</div>`)，Googlebot 会更快地选择它，因为它在您的 html 源中可见。

你提到你已经在一个新的主页重新设计中实现了这一点，我想知道你是否给了谷歌时间来选择你网站上的变化？请记住，您可以在您的网站上进行改进，但 googlebot 会看到它们“谁知道什么时候”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-10T07:21:44.657

尽管您将`display:none`样式应用于您的元素，但与 seo 无关，因为您的元素 dom 仍然存在，并且 seo 寻找的是 dom 及其内容，而不是 UI。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-11T13:16:48.723

我从您的问题中了解到，谷歌可能会将您的网站链接列入黑名单。由于隐藏的文本/div 被认为是黑帽 SEO 技术并且非常伤害您的网站。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-10T05:50:34.627

我不声称自己是 SEO 专家，但一般来说，如果您试图欺骗网站爬虫（通过隐藏大量关键字），这对 SEO 不利，因为您可能会被列入黑名单。如果您隐藏内容是因为它有助于用户界面，不应该有任何负面影响。由于它是一个自动化的过程，因此通常要谨慎行事，因为例如，如果您被列入黑名单，您就不能主张将州下半部分的每个城市名称都包含在隐藏的 div 中。

爬虫显然对 JavaScript 不是很好（而且许多用户都禁用了 JS）所以可能默认显示内容然后用 JS/CSS 悬停隐藏它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-10T07:59:57.863

```
.keywords
{
    visibility:hidden;
}

<div class="keywords">
    <a href="#">keyword 1</a> 
    <a href="#">keyword 2</a> 
    <a href="#">keyword 3</a> 
    <a href="#">keyword 4</a> 
</div> 
```

或更好 ：

```
.keywords
{
    display:none;
}

<div class="keywords">
    <a href="#">keyword 1</a> 
    <a href="#">keyword 2</a> 
    <a href="#">keyword 3</a> 
    <a href="#">keyword 4</a> 
</div> 
```

# android - Unable to change Project Target from Properties

> ID：10966577
> 
> 赞同：0
> 
> 时间：2012-06-10T05:32:20.843
> 
> 标签：android

Error occurred(An error occurred. see error log for more details. Widget is disposed) while changing the project target from project properties. And even project target some times cannot be seemed in the table. Can any one help with an ideas... Thanks

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T05:37:50.533

if any other projet have default.properties file then copy that file at same place in your project and refresh the project in eclipse and now try to change .............

or

[Project has no default.properties file!](https://stackoverflow.com/questions/3426011/project-has-no-default-properties-file)

# javascript - 更改 ToggleID 链接的颜色

> ID：10966585
> 
> 赞同：-3
> 
> 时间：2012-06-10T05:34:10.457
> 
> 标签：javascript, toggle

我参与的网站不允许添加导航页面。因此，为了获得具有相应信息的类似导航的功能，我认为最好使用 Javascript 进行切换导航。由于我是 javascript 新手，所以我已经让切换工作正常了。如何突出显示选定的导航链接？其次，如何突出显示选定的导航链接 onload？

```
<script>
    function toggleID(IDS) {
        var area = document.getElementById('content');
        var sel = area.getElementsByTagName('div');
        for (var i=0; i<sel.length; i++) { sel[i].style.display = 'none'; }
        if (IDS == '') { return; }
        document.getElementById(IDS).style.display = 'block';    
    }
    onload = function() {
        toggleID('level1');
    }
</script>

<body>
    <ul id="nav-vertical">
        <li onclick="toggleID('level1')">level 1</li>
        <li onclick="toggleID('level2')">level 2</li>
    </ul><!-- /.nav-vertical -->
    <div id="content">
    <div id="level1">
      <p>this is content for level1.</p>
    </div>
    <div id="level2">
      <p>this is content for level2.</p>
    </div>
    </div>
</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T08:18:36.697

要实现颜色变化，您可以修改您的功能`toggleID`：

```
<script>
    function toggleID(IDS, clickedObject) {

        // toggle the color of the clickedObject too
        if ( clickedObject && clickedObject.style.backgroundColor == 'red' ) {
            clickedObject.style.backgroundColor = 'transparent';
        }
        else if ( clickedObject ) {
            clickedObject.style.backgroundColor = 'red';
        }

        var area = document.getElementById('content');
        var sel = area.getElementsByTagName('div');
        for (var i=0; i<sel.length; i++) { sel[i].style.display = 'none'; }
        if (IDS == '') { return; }
        document.getElementById(IDS).style.display = 'block';    
    }
    onload = function() {
        toggleID('level1');
    }
</script>

<body>
    <ul id="nav-vertical">
        <li onclick="toggleID('level1', this)">level 1</li>
        <li onclick="toggleID('level2', this)">level 2</li>
    </ul><!-- /.nav-vertical -->
</body> 
```

您可以将单击的链接作为函数的第二个参数提供，并在函数中切换其背景颜色属性。

# ruby-on-rails - Rails Devise generate error

> ID：10966590
> 
> 赞同：1
> 
> 时间：2012-06-10T05:35:32.067
> 
> 标签：ruby-on-rails, devise, rails-generate

I'm fairly new to rails and I'm trying to set up devise and omniauth to allow users to login to my website with the Facebook API. I'm using this tutorial [http://www.ruby-on-rails-outsourcing.com/articles/2012/01/20/adding-facebook-auth-to-rails-3-1-app/](http://www.ruby-on-rails-outsourcing.com/articles/2012/01/20/adding-facebook-auth-to-rails-3-1-app/) to do this. However, when I try to run `rails generate devise User` , I get this error: `undefined local variable or method config for main:Object (NameError)`. How do I fix this?

devise.rb file :

```
Devise.setup do |config|
  config.mailer_sender = "please-change-me-at-config-initializers-devise@example.com" 
  require 'devise/orm/active_record'
  config.case_insensitive_keys = [ :email ]
  config.strip_whitespace_keys = [ :email ]
  config.skip_session_storage = [:http_auth]
  config.stretches = Rails.env.test? ? 1 : 10
  config.reconfirmable = true
  config.reset_password_within = 6.hours
  config.sign_out_via = :delete 
```

development.rb:

```
*******::Application.configure do
  config.action_mailer.default_url_options = { :host => 'localhost:3000' }
  config.cache_classes = false
  config.whiny_nils = true
  config.consider_all_requests_local       = true
  config.action_controller.perform_caching = false
  config.action_mailer.raise_delivery_errors = false
  config.active_support.deprecation = :log
  config.action_dispatch.best_standards_support = :builtin
  config.active_record.mass_assignment_sanitizer = :strict
  config.active_record.auto_explain_threshold_in_seconds = 0.5
  config.assets.compress = false
  config.assets.debug = true
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-26T04:30:24.950

我有同样的问题。评论中的 abhas 帮助我走上了正轨！

我已经把文件夹放在块`config.assets.initialize_on_precompile = false`外。我将该配置行放在 Module 块中，一切都开始正常工作！`Module ApplicationName``config/Application.rb`

```
module VitogoWeb2
  class Application < Rails::Application

    # A devise setting to prevent Heroku from accessing the DB or load models when precompiling the assets.
    config.assets.initialize_on_precompile = false

  end
end 
```

# java - How to make a toggle button for a widget android

> ID：10966595
> 
> 赞同：1
> 
> 时间：2012-06-10T05:36:13.767
> 
> 标签：java, android, button, widget, togglebutton

So I've created a widget, and I'm tried my best to simulate a toggle button. Sense Widget doesn't support a toggle button I'm using a imagebutton and plan on changing the image depending on it's state.

Only problem is it's state isn't being saved and I'm not sure why.

```
package com.tdubstudios.beastmode;

import android.app.PendingIntent;
import android.appwidget.AppWidgetManager;
import android.appwidget.AppWidgetProvider;
import android.content.ComponentName;
import android.content.Context;
import android.content.Intent;
import android.widget.RemoteViews;
import android.widget.Toast;

public class WidgetClass extends AppWidgetProvider{

private static final String ACTION_WIDGET_RECEIVER = "ActionRecieverWidget";  
private RemoteViews views;  

public boolean beastmodeOn = false;

public void onUpdate(Context context, AppWidgetManager appWidgetManager,  
       int[] appWidgetIds) {  
   final int N = appWidgetIds.length;
   views = new RemoteViews("com.tdubstudios.beastmode", R.layout.widget_layout);

   // Perform this loop procedure for each App Widget that belongs to this  
   // provider  
   for (int i = 0; i < N; i++) {  
       int appWidgetId = appWidgetIds[i];  
       Intent intent = new Intent(context, WidgetClass.class);  
       intent.setAction(ACTION_WIDGET_RECEIVER);  
       PendingIntent pendingIntent = PendingIntent.getBroadcast(context, 0, intent, 0);  

       views.setOnClickPendingIntent(R.id.widget_ib, pendingIntent);  

       // Tell the AppWidgetManager to perform an update on the current App  
      // Widget  
       appWidgetManager.updateAppWidget(appWidgetId, views);  
   }
}  

@Override  
public void onReceive(Context context, Intent intent) {  
     if (intent.getAction().equals(ACTION_WIDGET_RECEIVER)) { 
         if(beastmodeOn){
             beastmodeOn = false;
             Toast.makeText(context, "beastmode is now off", Toast.LENGTH_SHORT).show();
         }else{
             beastmodeOn = true;
             Toast.makeText(context, "beastmode is now ON", Toast.LENGTH_SHORT).show();
         }
     }  
     super.onReceive(context, intent);  
}  

@Override
public void onDeleted(Context context, int[] appWidgetIds) {
    super.onDeleted(context, appWidgetIds);
    Toast.makeText(context, "onDelete has been called in widgetClass", Toast.LENGTH_LONG).show();
}

} 
```

No matter how many times I press the button I always get the toast "beastmode is now ON"

Any suggestions?

Thank you.

EDIT:

Ok so I added this code:

```
Log.i("widget","BEFORE beastmode is: "+beastmodeOn);
             beastmodeOn = true;
             Toast.makeText(context, "beastmode is now ON", Toast.LENGTH_SHORT).show();
             Log.i("widget","AFTER beastmode is: "+beastmodeOn); 
```

and my log gives me this back:

```
 BEFORE beastmode is: false
 AFTER beastmode is: true 
```

It gives me this EVERY time I press the button. So obviously it creates a new instance or something to that effect. Once it executes it must destroy all variable values or something, maybe someone with more knowledge knows the right words.

So does anyone know a work around then?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T06:15:03.577

So I don't exactly know why the above didn't work, I'm assuming because it creates a new instance. I've managed to make a work around though by using SharedPreferences to keep track of the toggle. Probably not the best way to do it but it works, so I'm happy.

For anyone else having this problem here ya go:

```
package com.tdubstudios.beastmode;
import android.app.PendingIntent;
import android.appwidget.AppWidgetManager;
import android.appwidget.AppWidgetProvider;
import android.content.Context;
import android.content.Intent;
import android.content.SharedPreferences;
import android.content.SharedPreferences.Editor;
import android.preference.PreferenceManager;
import android.widget.RemoteViews;
import android.widget.Toast;

public class WidgetClass extends AppWidgetProvider {

    private static final String ACTION_WIDGET_RECEIVER = "ActionRecieverWidget";
    private RemoteViews views;

    public boolean beastmodeOn;

    public void onUpdate(Context context, AppWidgetManager appWidgetManager,
            int[] appWidgetIds) {
        final int N = appWidgetIds.length;
        views = new RemoteViews("com.tdubstudios.beastmode",
                R.layout.widget_layout);

        // Perform this loop procedure for each App Widget that belongs to this
        // provider
        for (int i = 0; i < N; i++) {
            int appWidgetId = appWidgetIds[i];
            Intent intent = new Intent(context, WidgetClass.class);
            intent.setAction(ACTION_WIDGET_RECEIVER);
            PendingIntent pendingIntent = PendingIntent.getBroadcast(context,
                    0, intent, 0);

            views.setOnClickPendingIntent(R.id.widget_ib, pendingIntent);

            SharedPreferences prefs = PreferenceManager
                    .getDefaultSharedPreferences(context);
            boolean value = prefs.getBoolean("beastmodeOn", false);

            if (value) {
                Editor editor = prefs.edit();
                editor.putBoolean("beastmodeOn", false);
                editor.commit();
            }

            appWidgetManager.updateAppWidget(appWidgetId, views);
        }
    }

    @Override
    public void onReceive(Context context, Intent intent) {
        if (intent.getAction().equals(ACTION_WIDGET_RECEIVER)) {

            SharedPreferences prefs = PreferenceManager
                    .getDefaultSharedPreferences(context);
            boolean value = prefs.getBoolean("beastmodeOn", false);
            Editor editor = prefs.edit();

            if (value) {
                beastmodeOn = true;
            } else {
                beastmodeOn = false;
            }

            if (beastmodeOn) {
                Toast.makeText(context, "beastmode is now off",
                        Toast.LENGTH_SHORT).show();

                editor.putBoolean("beastmodeOn", false);
                editor.commit();
            } else {
                Toast.makeText(context, "beastmode is now ON",
                        Toast.LENGTH_SHORT).show();

                editor.putBoolean("beastmodeOn", true);
                editor.commit();
            }
        }
        super.onReceive(context, intent);
    }

    @Override
    public void onDeleted(Context context, int[] appWidgetIds) {
        SharedPreferences prefs = PreferenceManager
                .getDefaultSharedPreferences(context);
        boolean value = prefs.getBoolean("beastmodeOn", false);

        if (value) {
            Editor editor = prefs.edit();
            editor.putBoolean("beastmodeOn", false);
            editor.commit();
        }

        super.onDeleted(context, appWidgetIds);
    }
} 
```

# excel - Worksheet_FollowHyperlink - 获取超链接所在的单元格值

> ID：10966597
> 
> 赞同：2
> 
> 时间：2012-06-10T05:36:48.757
> 
> 标签：excel, vba

我在一个单元格中有一个值，当我双击它时，它会将我带到命名范围 Account_Number（位于另一个工作表上）并更新该值。

我的问题是我想修改下面的代码，以便它可以与 Worksheet_FollowHyperlink(ByVal Target As Hyperlink) 事件一起使用。

```
Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)

If (ActiveCell.Column = 23 And Not ActiveCell.Value = "") Then   
    [Account_Number] = ActiveCell.Value
    Application.GoTo Reference:=[Account_Number]
End If

End Sub 
```

例如，我想在包含值 4111 的单元格 J9 中放置一个超链接，当我单击超链接时，它会将我带到另一个工作表中的命名范围并将命名范围的值更新为 4111。

我不确定如何将值动态分配给命名范围。有人可以让我知道这是否可能以及代码应该是什么？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T05:55:46.530

如果您已对命名单元格进行了超链接，则将值从超链接源单元格复制到其目标的方法是：

```
Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)
    ActiveCell.Value = Target.Parent.Value
End Sub 
```

您可能只想将此应用于特定命名单元格的超链接，例如：

```
Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)
  If Target.SubAddress = "Account_Number" Then
    ActiveCell.Value = Target.Parent.Value
  End If
End Sub 
```

# c# - 将 C# 中的多个值插入 SQL 表中的一行

> ID：10966599
> 
> 赞同：0
> 
> 时间：2012-06-10T05:37:28.513
> 
> 标签：c#, sql, visual-studio-2010

我有一张表，我想将所有输出存储到由空格分隔的一行中（例如“textbox1 textbox2 textbox3”。我该怎么做？目前它试图将它们放入不同的列中。给我一个错误说明我使用更少的列。

```
 }
            using (SqlCommand cmd = new SqlCommand("INSERT INTO [user] (solution) VALUES (@textbox1, @textbox2, @textbox3)", cn))
            {
                cmd.Parameters.AddWithValue("@textbox1", textBox1.Text);
                cmd.Parameters.AddWithValue("@textbox2", textBox2.Text);
                cmd.Parameters.AddWithValue("@textbox3", textBox3.Text);
                cmd.ExecuteNonQuery(); // or int affected = cmd.ExecuteNonQuery() 
                MessageBox.Show("Success!");

            }
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T05:42:03.343

试试这个：

```
using (SqlCommand cmd = new SqlCommand("INSERT INTO [user] (solution) VALUES (@text)", cn))
            {
                cmd.Parameters.AddWithValue("@text", textBox1.Text + " " + textBox2.Text + " " + textBox3.Text);

                cmd.ExecuteNonQuery(); // or int affected = cmd.ExecuteNonQuery() 
                MessageBox.Show("Success!");

            } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T05:52:05.600

您在比您指定的更多列中插入数据，所以我认为您在该部分中遇到了错误。因此，对代码进行一些修改以消除错误：

```
 }
            using (SqlCommand cmd = new SqlCommand("INSERT INTO [user] (solution) VALUES (@textbox1+' '+ @textbox2+' '+ @textbox3)", cn))
            {
                cmd.Parameters.AddWithValue("@textbox1", textBox1.Text);
                cmd.Parameters.AddWithValue("@textbox2", textBox2.Text);
                cmd.Parameters.AddWithValue("@textbox3", textBox3.Text);
                cmd.ExecuteNonQuery(); // or int affected = cmd.ExecuteNonQuery() 
                MessageBox.Show("Success!");

        }
    } 
```

# ajax - 即使浏览器中的 URL 发生更改，也可能存在 AJAX 行为？

> ID：10966608
> 
> 赞同：0
> 
> 时间：2012-06-10T05:41:20.610
> 
> 标签：ajax, browser

如果使用当前的 Chrome、Firefox 和 Safari，在切换时

> [http://www.facebook.com/my_name](http://www.facebook.com/my_name)
> [http://www.facebook.com](http://www.facebook.com)

用于提要和聊天的侧面板，以及任何聊天框实际上都保留了下来。我以为当 URL 发生变化时，页面*必须*整体刷新，但显然，这里不是这样。这是怎么做的？

在IE 9上，URL实际上变成`http://www.facebook.com/#!`了并使用“hash”来做ajax而不刷新页面，这更容易理解。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T05:49:47.513

您可以从 javascript 更改 URL 和页面历史记录，而无需实际重新加载页面。

在另一个问题上看到[这个答案。](https://stackoverflow.com/a/3354511/401728)

请注意，如果您自己键入新 URL 并按 enter，整个页面会重新加载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T02:55:15.197

这可能是网页中的内部链接，其中包含带有 ID 的隐藏 DIV，并且 onClick 那些隐藏的 DIV 可以通过 javascript 显示并加载 AJAX 内容，如果您浏览禁用 javascipt 的站点会很好

# android - 如何在Android中通过代码在主屏幕之间切换

> ID：10966609
> 
> 赞同：0
> 
> 时间：2012-06-10T05:41:27.897
> 
> 标签：android

是否可以通过代码在屏幕之间切换？我们向右/向左滑动以在我们拥有的多个屏幕之间切换。是否可以通过代码模拟？我们应该以编程方式模拟滑动来实现这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T11:40:12.597

首先，您不能通过在其中注入按键或触摸事件来攻击其他应用程序，除非这些是您自己的应用程序，即便如此，也只能通过创建特殊的单元测试套件项目。

其次，你假设“主屏”有“多屏”的概念。并非所有人都这样做。

# java - 保存自定义类对象的数组

> ID：10966613
> 
> 赞同：2
> 
> 时间：2012-06-10T05:42:33.187
> 
> 标签：java, arrays, multidimensional-array

我想知道是否有一种简单的方法可以保存对象数组，而不必遍历并保存对象的各个方面。在我的示例中，我有两个数组，一个是单个数组，另一个是二维数组，其中包含引用自定义类的对象。每个对象都有特定的细节，如 x 和 y 整数、布尔值、字符串等。附加到它们（块[0].x，块[0].canWalk，块[0].name），我想知道是否有一种简单的方法可以将这些数组保存到文件中而不必使用for循环和保存每个部分。多维数组只是一个与第一个相同的已保存数组的数组 (savedBlock[0][0].x ...)

到目前为止我所拥有的（抛出 NotSerializableException）：

```
public class Save
{
    static File f;
    static ObjectOutputStream os;
    public static void openFile()
    {
        try
        {
            if(!new File("c:\\IDsGame").exists())
            {
                new File("c:\\IDsGame").mkdirs();
            }

            f = new File("c:\\IDsGame\\data.bin");
            os = new ObjectOutputStream(new FileOutputStream(f));

            writeFile();
        }
        catch(Exception e)
        {
            System.err.println("creating file");
        }
    }

    public static void writeFile()
    {
        try
        {
            ArrayList<Object> map = new ArrayList<Object>(Arrays.asList(Map.block));
            ArrayList<Object> savedMaps = new ArrayList<Object>(Arrays.asList(Map.savedMaps));
            os.writeObject(map);
            os.writeObject(savedMaps);
            os.close();
        }
        catch (IOException e) {System.out.println(e);}

    }
} 
```

在我的地图类中，我初始化了块 (Blocks[]) 和 savedMaps(Blocks[][])。我的 Blocks 课程包含以下内容：

```
public class Blocks implements Serializable
{
    public boolean canWalk, onTop, itemTaken;
    public Image img = null, imgBack = null;
    public final Image (a ton of different images)
    public String name, item, message, title;
    public char initMap, initEx, initIt;
    public int x, y, height, width;

    public Blocks()
    {
        canWalk = true;
        onTop = false;
        itemTaken = false;
        img = null;
        name = null;
        item = null;
        message = null;
        x = 0;
        y = 0;
        height = 0;
        width = 0;
    }
} 
```

显然，我在 Map 类中更改了某些部分不同的数组，我想知道是否有任何更简单的方法（根本）来保存块对象的数组。

感谢您抽出宝贵时间提供帮助，如果您需要更具体的信息，请告诉我。

ID

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T05:49:06.607

图像不可序列化，因此当 Blocks 类被序列化时，您会收到 NotSerializableException。ImageIcon 可以序列化，因此在 ImageIcons 中包装 Image 实例将解决该问题。

```
public class Blocks implements Serializable
{
    public boolean canWalk, onTop, itemTaken;
    public ImageIcon img = null, imgBack = null;
    public final ImageIcon (a ton of different images)
    public String name, item, message, title;
    public char initMap, initEx, initIt;
    public int x, y, height, width;

    public Blocks()
    {
        canWalk = true;
        onTop = false;
        itemTaken = false;
        img = null;
        // img = new ImageIcon(someImageInstance)
        name = null;
        item = null;
        message = null;
        x = 0;
        y = 0;
        height = 0;
        width = 0;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T06:18:55.800

仅仅实现一个类`Serializable`是不够的：所有的字段都必须是`Serializable`。

你的`Block`班级可能有问题。所有常见的 java 类都有`Serializable`，而且`Block`也有类型的字段`Image`。如果`Image`不是`Serializable`，则尝试序列化`Block`将抛出`NotSerializableException`.

# mysql - mysql索引未优化查询

> ID：10966615
> 
> 赞同：0
> 
> 时间：2012-06-10T05:43:17.473
> 
> 标签：mysql, sql-execution-plan

我有 mysql MyISAM 表，我在上面做一个简单的`select id from mytable limit 1;`. 这只会冻结系统。

我试过了`explain select id from mytable limit 1;`。它再次冻结了我的系统。表人口统计：50k 条记录，10 mbs 大小，2 个索引（主键自动增量），8 列。

我不知道为什么该`explain`语句失败，因为它应该显示查询计划，仅此而已。表的大小和记录的数量都不是很大，那为什么mysql工作这么慢？相反，我在这里缺少什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T06:18:54.817

这是由于 mytable 上的等待状态。[eggyal](https://stackoverflow.com/users/623041/eggyal)给了我使用的线索`show processlist`。这显示了：

```
+-----+---------+-----------------+----------------+---------+------+---------------------------------+----------------------------------------------------+
| Id  | User    | Host            | db             | Command | Time | State                           | Info                                               |
+-----+---------+-----------------+----------------+---------+------+---------------------------------+----------------------------------------------------+
| 349 | root    | localhost:56612 | mydb           | Query   | 3582 | Waiting for table metadata lock | ALTER TABLE `mytable` ADD INDEX(`fk_to_02`) | 
```

我种了一个`kill 349`来终止等待链，现在解释语句按预期工作。

# java - 如何在 gwt 中使用谷歌应用引擎

> ID：10966616
> 
> 赞同：2
> 
> 时间：2012-06-10T05:43:45.897
> 
> 标签：java, google-app-engine, google-maps, gwt, google-places-api

我想使用 Google Places API 并想知道可用于调用地图 API url 并解析 json 结果的可用兼容 jar 或库。

我看到有许多可用的 json 解析器，但不确定这是否与带有 gwt 的 java 的 google app engine 兼容。

请指教。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T07:07:48.777

在以下位置找到它：

[http://nadacode.com/2010/06/30/using-json-in-your-google-app-engine-java-app/](http://nadacode.com/2010/06/30/using-json-in-your-google-app-engine-java-app/)

# android - 如何在phonegap应用程序的android选择菜单中检测软键盘完成按钮单击

> ID：10966622
> 
> 赞同：1
> 
> 时间：2012-06-10T05:46:00.240
> 
> 标签：android, events, cordova

这篇文章与这个问题有关。 [https://stackoverflow.com/a/9378676](https://stackoverflow.com/a/9378676)

网页视图中的 Android 选择菜单会在每次单击项目时触发更改事件。我只想在更改后单击完成按钮后才能做到这一点。

# javascript - 最初执行并通过函数调用

> ID：10966624
> 
> 赞同：0
> 
> 时间：2012-06-10T05:46:17.637
> 
> 标签：javascript

包装一些代码以便我可以调用它`foo();`并在加载 javascript 时执行它的最佳方法是什么？

我希望在加载 javascript 时执行 foo 并能够使用 foo(); 调用 foo

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T05:54:15.480

您可以将函数赋值包装在函数包装器中并将参数传递给它。

```
(test = function(a) {
    return a + 7;
})(6); // returns 13

test(2); // returns 9 
```

[使用 console.log 进行演示](http://jsfiddle.net/NtM5R/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-10T06:38:18.140

我不太明白这个问题，但是如果您想`foo`在脚本开头运行，那么只需`foo`在脚本开头调用即可。

```
<script>
function foo(bar){
    console.log(bar);
}

foo(8); // call at start of script

// more code

foo(9); // call later in script
</script> 
```

# php - substr 返回空字符串

> ID：10966626
> 
> 赞同：2
> 
> 时间：2012-06-10T05:46:33.517
> 
> 标签：php

我对 substr 函数的 $length 有疑问

我的代码

```
$string='I love stackoverflow.com';
function arabicSubStr($value,$start,$length=false){
    return mb_substr($value,$start,$length,'UTF-8');
}

echo arabicSubStr($string,7);//outputs nothing
echo substr($string,7);//outputs stackoverflow.com 
```

问题的原因是：

> 如果给定长度并且为 0、FALSE 或 NULL，则将返回一个空字符串。

那么，我该如何解决这个问题？

我不会用`strlen($string)`

# 编辑

我知道原因是因为我将 $length 定义为 false

我在这里知道我应该在 $length 参数中输入什么以避免此错误？

我试图把 -1 它返回 //stackoverflow.co

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T05:51:14.883

由于您获得空字符串的原因*完全*由您的问题内容指定（使用 0、FALSE 或 NULL），我假设您只是想要一种方法来获取字符串的其余部分。

在这种情况下，我会使用类似的东西：

```
function arabicSubStr ($value, $start, $length = -1) {
    if ($length == -1)
        $length = mb_strlen ($value, 'UTF-8') - $start;
    return mb_substr ($value, $start, $length, 'UTF-8');
} 
```

您需要这样做，因为没有长度的标记值表示“字符串的其余部分”。正数（和零）会将大小限制为给定的大小，负数将剥离字符串的末尾（如您在问题编辑中所示）。

如果您*真的*不想使用字符串长度函数，您可以*尝试*9999（甚至更高）的值并希望：

*   该`mb_substr()`函数只会将其用作*最大值*；和
*   您不会传递任何 10K 或更多的字符串。

换句话说，类似于以下内容：

```
function arabicSubStr ($value, $start, $length = 9999){
    return mb_substr ($value, $start, $length, 'UTF-8');
} 
```

虽然请记住我没有测试过，但我当前位置没有任何 PHP 环境。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T05:53:31.273

这是因为您已将其`$length`设置`false`为函数的默认参数，这意味着您希望它返回一个长度为 0 的子字符串。

不幸的是，如果您必须设置我想象的最终参数（字符集），那么您必须首先计算字符串的长度，例如：

```
function arabicSubStr($value,$start,$length=false){
    $length = ($length) ? $length : mb_strlen($value,'UTF-8') - $start;
    return mb_substr($value,$start,$length,'UTF-8');
} 
```

# arduino - 如何将二维数组转换为从 PROGMEM 调用

> ID：10966628
> 
> 赞同：0
> 
> 时间：2012-06-10T05:47:14.917
> 
> 标签：arduino

我有一个非常大的阵列，我不想用完我宝贵的 SRAM。在 PROGMEM 中还有一个我想要的辅助数组。

数组是：

```
fontLookUp[265]
font[96][8] 
```

使用这些数组，我通过调用引用此地址的进程八次（每个字符八个字节中的一个）来获取字符的数据：

```
font[fontLookUp[character]][x] 
```

我只知道如何从 PROGMEM 中读取一维数组...我将如何处理第二维 [x]？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T08:25:13.323

数组只是指向内存地址的指针。

```
int font [3][5];
int font [15]; 
```

是等价的：

```
font[2][1];
font[2*5+1]; // multiply by the 5 in font[3][->5<-]
*(font+2*5+1); 
```

您只需将多维数组视为单维数组。

# javascript - 通过 Javascript 方法从 Google 电子表格中获取光标行/列

> ID：10966631
> 
> 赞同：2
> 
> 时间：2012-06-10T05:48:28.830
> 
> 标签：javascript, google-apps-script, google-sheets, google-spreadsheet-api

2010 年 3 月 29 日，Jason Hale 想使用电子表格光标位置为他正在编写的 Javascript 应用程序选择一个电子邮件地址 - 请参阅[http://productforums.google.com/forum/#!topic/apps-script/ U10q44vptPU](http://productforums.google.com/forum/#!topic/apps-script/U10q44vptPU)。受访者建议使用 getActiveSelection 和伴随的 getRowIndex/getColumnIndex 方法。不幸的是，他们没有为 Hale 工作，两年后当我想编写一个类似的应用程序时，他们也没有为我工作。光标的位置对 getRowIndex 和 getColumnIndex 没有影响。这些方法总是返回 1，这是无用的，可能是一个错误。Google Apps 缺少 Python 提供的光标服务。有没有人发现 Google Apps 返回的任何内容在这种情况下可能有用？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-10T06:13:20.983

您是否尝试过像这样的简单功能？

```
function getRCposition(){
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var cell = ss.getActiveCell();
  var R = cell.getRow();
  var C = cell.getColumn();
  Browser.msgBox('Row = '+R+' and Col = '+C);
  } 
```

或更“通用”的功能，例如：

```
function getposition(){
   var sh = SpreadsheetApp.getActiveSheet();
   var ss = SpreadsheetApp.getActiveSpreadsheet();
  var range = ss.getActiveRange();
  var R = range.getRowIndex();
  var C = range.getColumnIndex();
  var W = range.getWidth();
  var H = range.getHeight();
  var A1not = range.getA1Notation();
  Browser.msgBox('Row = '+R+' / Col = '+C+' Width = '+W+'  / Heigth = '+H+'  A1 notation = '+A1not);
  } 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-10T06:15:19.033

The following code works for me. It prompts me with the row number of my current position in the spreaadsheet:

```
function onOpen() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var menuEntries = [ {name: "Test1", functionName: "menuItem1"}];
  ss.addMenu("Tests", menuEntries);
}

function menuItem1() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  Browser.msgBox("You have selected row " + ss.getActiveCell().getRow());
} 
```

# php - 在链接到内部页面时将用户重定向到外部站点？

> ID：10966632
> 
> 赞同：1
> 
> 时间：2012-06-10T05:48:35.827
> 
> 标签：php, url, redirect, seo

如何在链接到内部页面时将用户重定向到外部站点？

我见过这样的例子：

*   example.com/go/ksdjfksjdhfls
*   example.com/?go=http://www.new-example.com
*   ... 还有很多...

这是如何在 php 中实现的？

这对 SEO 有任何优点/缺点吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-10T06:16:20.763

我认为这种方法没有任何好处，但有几种方法可以实现它。要使用`GET`查询执行此操作，您只需要以下代码：

### HTML：

```
 <a href="http://example.com/link.php?site=http://www.google.com">Google!</a> 
```

### PHP：

```
if (filter_var($_GET['site'], FILTER_VALIDATE_URL)) {
          header('Location: ' . $_GET['site']);
} 
```

对于上面的示例，它实际上会将用户带到该位置，而不是：

```
 http://example.com/link.php?site=http://www.google.com 
```

要在拉起远程站点时使 url 成为“本地”，您要么必须：

*   与 URL 重写混淆，这可能会变得混乱，我不确定是否会让您执行上述操作
*   通过 curl 检索远程页面并显示它，这可能会破坏“远程”页面上的链接
*   使用 iframe 并将 iframe 设置为页面大小。请注意，这最后一种方法虽然攻击性最小，但被认为是一种潜在的安全漏洞，称为“点击劫持”，因为它用于诱骗用户单击一个页面的链接，而该页面隐藏了指向另一个站点的恶意链接。许多服务器和浏览器正在采取措施避免这种情况（例如，谷歌不允许对其主页进行 iframe），因此这也可能会走到死胡同。

所以在我能想到的三种服务器端方法中，一种可能可行，也可能不可行，而且很痛苦。一个会瘫痪并给服务器带来沉重的负担。最后一个是已知的坏人，在很多情况下可能不起作用。

所以我只需要重定向，实际上，如果您不需要地址栏来显示本地 URL，那么我只需要一个直接链接。

所有这些都提出了一个问题：您希望完成什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T06:15:56.577

把它放在任何输出到浏览器之前

```
<?
header('location:example.com\index.php');
?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-10T06:18:40.937

设置一个 index php 文件，它将标头位置设置为 get 参数中的 url。

example.com/?go=http://www.new-example.com ：

```
// example.com/index.php
<?php
if (isset($_GET['go'])) {
    $go = $_GET['go'];
    header('Location: $go');
} // else if other commands
// else (no command) load regular page
?> 
```

example.com/go/ksdjfksjdhfls ：

```
// example.com/go/ksdjfksjdhfls/index.php
<?php
header('Location: http://someurl.com');
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-10T06:10:19.653

example.com/?go=http://www.new-example.com

您可以使用 iframe 并将 src 属性设置为[http://www.new-example.com](http://www.new-example.com)

```
<!DOCTYPE HTML>
<html>
<head>

</head>

<body>
   <iframe src="http://www.new-example.com" width="100%" height="100%"></iframe>

</body>
</html> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-22T00:17:21.543

我为此使用 .htaccess 规则。不需要 PHP。

IE

```
Redirect 307 /go/somewhere-else http://www.my-affiliate-link.com/ 
```

所以访问`http://www.mywebsite.com/go/somewhere-else`将重定向到`http://www.my-affiliate-link.com/`.

在我的网站上，我使用“nofollow”来告诉搜索引擎不要跟随链接。状态码的`307`意思是“临时重定向”。

`<a href="http://www.mywebsite.com/go/somewhere-else" rel="nofollow">Click here!</a>`

# javascript - wicket：使用目标从 java 类调用 javascript 函数

> ID：10966634
> 
> 赞同：0
> 
> 时间：2012-06-10T05:48:52.740
> 
> 标签：javascript, wicket

我要做的是使用目标将 wickets java 代码中的值传递给 javascript 函数。
为此，我有使用目标从 wickets java 类调用 javascript 函数的方法。

我的Java代码是：

```
target.addJavascript("show();"); 
```

html代码。脚本函数

但它没有调用 javascript 函数 - 我该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-14T14:03:16.997

如果你想在更新事件中调用一些 JS，你必须实现一个名为：“wantOnSelectionChangedNotifications()”的布尔方法

例如：

```
new DropDownChoice("drop"){

  @Override
        protected boolean wantOnSelectionChangedNotifications() {
            return true;
        }

  @Override
        protected void onUpdate(AjaxRequestTarget target) {
         target.appendJavaScript("put your JavaScript here");
   }

} 
```

# macos - 在 MAC OS X 上：如何注册回调以检测物理链路 UP/Down 事件？

> ID：10966636
> 
> 赞同：3
> 
> 时间：2012-06-10T05:49:16.923
> 
> 标签：macos, operating-system, nic

我是 mac os x 的新手。我喜欢有一个线程来检测物理网卡链接打开/关闭事件，而不是外部可访问的 ip 网络。

我得到的旧方法是使用 select/timer 通过 ioctl 轮询接口标志...

有人有来自苹果的 API 的完整示例吗？像注册一个回调到内核并永远运行？如果有任何更改（linkup <--> kink down）会触发回调？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T09:49:01.773

尚未使用 up/down 事件测试代码，但它适用于开/关，因此它可能会起作用。而且，我知道没有错误处理。

```
#include <sys/socket.h>
#include <sys/ioctl.h>
#include <sys/types.h>
#include <net/if.h>
#include <sys/kern_event.h>

int main(int argc,char** argv) {
   // create a socket of type PF_SYSTEM to listen for events
   int s = socket(PF_SYSTEM, SOCK_RAW, SYSPROTO_EVENT);
   // make sure we get receive the correct events
   kev_request key;
   key.vendor_code = KEV_VENDOR_APPLE;
   key.kev_class = KEV_NETWORK_CLASS;
   key.kev_subclass = KEV_ANY_SUBCLASS;
   //
   int code = ioctl(s, SIOCSKEVFILT, &key);
   kern_event_msg msg;
   // endless loop
   while(1) {
        // get notification
        code = recv(s, &msg, sizeof(msg), 0);
        // check type of event
        switch(msg.event_code) {
           case KEV_DL_IF_DETACHED:
              // interface is detached
              break;
           case KEV_DL_IF_ATTACHED:
              // interface is attached
              break;
           case KEV_DL_LINK_OFF:
              // interface is turned off
              break;
           case KEV_DL_LINK_ON:
              // interface is turned on
              break;
        }
   }
   return 0;
} 
```

# sql - 为什么我会收到 sql server 错误“列无效”？

> ID：10966637
> 
> 赞同：-1
> 
> 时间：2012-06-10T05:49:21.030
> 
> 标签：sql, sql-server

考虑下面的代码：

```
select vend_id, COUNT(vend_id) as num_prods
from Products
group by vend_id 
```

当我删除最后一行时，我收到以下错误：

> 列“Products.vend_id”在选择列表中无效，因为它既不包含在聚合函数中，也不包含在 GROUP BY 子句中。

为什么我会收到此错误？我犯了什么错误（理解 count 的工作原理）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T05:55:36.177

计数是一个聚合函数。

它返回查询定义的集合中的项目数。

如果查询中没有列，count 将只计算查询返回的总行数。

如果将其他列添加到选择列表中，则需要添加一个 group by 语句以赋予计数含义。Group by 告诉聚合函数对 group by 语句中的列具有相同值的所有行进行操作。

您在问题中提供的查询将返回唯一 vend_id 值的列表以及这些值在给定表中存在的次数。如果 vend_id 列是该表上的唯一键，那么您将只获得一个 vend_id 列表和每行 1 的列表。

COUNT函数的详细解释请看这篇文档：http: [//msdn.microsoft.com/en-us/library/ms175997 (v=sql.105).aspx](http://msdn.microsoft.com/en-us/library/ms175997(v=sql.105).aspx)

有关聚合函数的说明，请参阅本文档，一般来说： http: [//msdn.microsoft.com/en-us/library/ms173454 (v=sql.105).aspx](http://msdn.microsoft.com/en-us/library/ms173454(v=sql.105).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T05:53:20.467

**在不使用 Group By 的情况下编写查询的替代方法：**

```
select vend_id, (select COUNT(*) from Products as products1 where products1.vend_id = Products.vend_id) as num_prods
from Products 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-10T05:55:55.577

您收到错误是因为当您从查询中删除最后一行时，您在聚合函数`count(vend_id)`和非聚合函数中都选择了 vend_id `vend_id`。您要求一列总计（计数一）和一详细信息（不计数）。您需要告诉 SQL Server 如何处理任何未总计的列。

```
select vend_id
from Products

select count(vend_id)
from Products 
```

上面的两个查询都是有效的。如果要选择 vend_id 并按它计数，则必须按它分组。

# php - 如果没有找到所有数据，Mysql 查询返回 false

> ID：10966641
> 
> 赞同：1
> 
> 时间：2012-06-10T05:49:47.437
> 
> 标签：php, mysql, codeigniter

我需要从几个表中获取一些用户信息，但是如果缺少某些内容，例如 c.comp_title，则查询返回 false。我怎样才能让它返回它找到的任何数据？

```
 function one_edu($end_user, $one_id)
    {
    $query_str = "SELECT *
                FROM edu a
                JOIN user_profiles b ON a.user_id=b.user_id
                JOIN (SELECT c.user_id, GROUP_CONCAT(c.comp_title) as comp_title, GROUP_CONCAT(c.comp) as comp
                   FROM comp c
                   GROUP BY c.user_id) c ON a.user_id = c.user_id
                JOIN (SELECT s.user_id, GROUP_CONCAT(s.skill_title) as skill_title, GROUP_CONCAT(s.skill) as skill
                   FROM skills s
                   GROUP BY s.user_id) d ON a.user_id = d.user_id
                JOIN (SELECT t.user_id, GROUP_CONCAT(t.exp_title) as exp_title, GROUP_CONCAT(t.experience) as experience
                   FROM exp t
                   GROUP BY t.user_id) e ON a.user_id = e.user_id
                JOIN (SELECT e.user_id, GROUP_CONCAT(e.edu_title) as edu_title, GROUP_CONCAT(e.education) as education
                   FROM edu e
                   GROUP BY e.user_id) f ON a.user_id = f.user_id
                 WHERE a.user_id = ?";

            $query = $this->db->query($query_str, $end_user);

            if($query->num_rows() > 0)
                    {
                    foreach($query->result_array() as $stuff) {
                            $data[] = $stuff;
                    }
                            return $data;
                    }else{
                            return false;
                    }

    }//end one_edu 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T05:59:52.867

了解[SQL 连接](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html)。您需要使用外部连接 -即使要连接的表没有匹配的记录（或者如果您想要结果，即使前面提到的表没有匹配的记录）也需要替换`JOIN`为任何您想要的结果。`LEFT JOIN``RIGHT JOIN`

# php - 如何在 Pyro CMS 导航中添加分隔符

> ID：10966642
> 
> 赞同：0
> 
> 时间：2012-06-10T05:50:31.340
> 
> 标签：php, html, pyro

我想`li`在 PyroCMS Navigation 中的每个项目之间添加一个管道“|”

在我们使用的 HTML 模板视图中

**代码**

```
{{ navigation:links group="main_nav" }} 
```

哪个输出

**输出**

```
#li><a href='#'>home</a></li>
#li><a href='#'>contact</a></li> 
```

我想做的是在链接之后有管道

**输出**

```
#li><a href='#'>home</a> | </li>
#li><a href='#'>contact</a> | </li> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T06:05:01.757

我找到了火焰兵的资料，

[http://docs.pyrocms.com/2.1/manual/index.php/modules-and-tags/tag-reference/navigation](http://docs.pyrocms.com/2.1/manual/index.php/modules-and-tags/tag-reference/navigation)

在底部有高级选项。看起来我可以使用 attribv

```
 separator="|" 

{{ navigation:links group="main_nav"  separator="|"  }} 
```

# android - 样式通知样式，如音乐播放器 android

> ID：10966649
> 
> 赞同：1
> 
> 时间：2012-06-10T05:52:47.283
> 
> 标签：android, android-layout, android-notifications

如何为android通知制作自定义布局。就像 android 的有按钮的音乐播放器一样，在它的通知音乐中覆盖图像。你有想法吗？能给我举个例子吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-02-15T02:19:43.280

这就是我为我的音乐播放器应用程序制作自定义通知的方式。首先创建一个notification_expanded.xml 可以用于Android Lollipop 及以上版本

```
<RelativeLayout
android:id="@+id/notificationbg"
android:layout_width="match_parent"
android:layout_height="125dp"
android:background="#212121"
xmlns:android="http://schemas.android.com/apk/res/android">

<ImageView
    android:id="@+id/status_bar_album_art"
    android:layout_width="@dimen/notification_expanded_height"
    android:layout_height="@dimen/notification_expanded_height"
    android:scaleType="fitXY"
    android:layout_marginTop="10dp"
    android:layout_toRightOf="@+id/status_bar_collapse"/>

 <ImageButton
    android:id="@id/status_bar_collapse"
    android:background="?android:selectableItemBackground"
    android:padding="2dp"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:src="@android:drawable/ic_menu_close_clear_cancel"
    android:layout_alignParentTop="true"
    android:layout_alignParentLeft="true" />

 </RevaliveLayout> 
```

上面的代码只是随机的。[当通知像这样](http://i.stack.imgur.com/rNo26.jpg)完全展开时，您可以将任何您想要的东西放在那里。

然后创建一个 notification_small_view.xml 来显示通知何时很小。

在您启动通知的服务中，设置适当的大视图和小视图。

```
RemoteViews views = new RemoteViews(getPackageName(),
                R.layout.notification_small_view);
RemoteViews bigViews = new RemoteViews(getPackageName(),
                R.layout.notification_expanded); 
```

像这样在扩展或小型通知中动态设置数据。

```
bigViews.setTextViewText(R.id.status_bar_track_name, songTitle);
views.setTextViewText(R.id.status_bar_track_name, songTitle); 
```

然后将这些布局设置为您的通知。

```
Notification notification.contentView = views;
notification.bigContentView = bigViews; 
```

# cocoa - Cocoa：当 iTunes 歌曲改变时接收回调

> ID：10966651
> 
> 赞同：2
> 
> 时间：2012-06-10T05:53:03.630
> 
> 标签：cocoa, itunes, scripting-bridge

我正在为我的聊天客户端编写一个功能，它将使用他们当前正在播放的 iTunes 歌曲更新用户的状态，就像 Skype 和类似的其他聊天客户端一样。我目前只是使用 ScriptingBridge 的方法来获取 iTunes 的当前歌曲。

但是，我似乎无法弄清楚是否可以以某种方式注册一个回调，该回调将在 iTunes 中当前播放的歌曲发生变化时被调用。我显然可以连续触发 NSTimer，它会每隔 10 秒触发一次，并检查 iTunes 是否正在运行，如果是，则获取歌曲信息并将其与存储的信息进行比较。这可能不是最好的方法，但我还没有找到任何其他方法。

谢谢，如果有人可以帮助我。非常感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T18:09:35.433

似乎 iTunes 实际上发送了一个名为**com.apple.iTunes.playerInfo**的分布式通知。

有关这方面的更多信息，请参阅[这篇文章。](https://stackoverflow.com/questions/4888816/objective-c-mac-os-x-distributed-notifications-itunes?rq=1)

# jquery - JQuery .post 期间变量值丢失

> ID：10966656
> 
> 赞同：0
> 
> 时间：2012-06-10T05:54:09.920
> 
> 标签：jquery, ajax, http-post

我正在尝试使用 .post 将一些数据传递到 PHP 文件，但在此过程中的某个地方，我传递的字符串的值丢失了，我收到了 NULL。

这是脚本：

```
<script type="text/javascript">
    $("select").change(function () {
        var tmp = "";
        $("select option:selected").each(function () {
            tmp = $(this).text();
        });
        $(".title").text(tmp);

        $.ajax({
            url:"php/description.php",
            type:"POST",
            data: { major:tmp },
            success: function(result) {
            alert(result);
            }
        });       
    });
</script> 
```

还有我用来测试它的简单 PHP 文件。

```
<?php
    $major = empty($_POST['tmp']);
    echo $major;
?> 
```

当用户单击选择列表中的新选项/项目时，将调用它。脚本的顶部可以正常工作（只需获取他们单击的值并将其放在页面上的某个位置），但 post 方法不起作用。它正在警告NULL。我找不到问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-10T05:56:19.433

似乎应该是

```
$_POST['major'] 
```

# java - zxing onActivityResults 没有触发

> ID：10966658
> 
> 赞同：0
> 
> 时间：2012-06-10T05:54:34.743
> 
> 标签：java, android, android-intent, zxing

我正在尝试使用以下代码通过 zxing 从 QR 码中提取数据（基本上是从教程中复制粘贴，更改名称以保护无辜者）：

```
 //Check for Barcode scanner, if not found put up an alert that allows user to install it.
            PackageManager pm = getPackageManager();
            try {
                ApplicationInfo appInfo = pm.getApplicationInfo("com.google.zxing.client.android", 0);
                Intent intent = new Intent(
                "com.google.zxing.client.android.SCAN");
                intent.putExtra("SCAN_MODE", "QR_CODE_MODE");//for Qr code, its "QR_CODE_MODE" instead of "PRODUCT_MODE"
                intent.putExtra("SAVE_HISTORY", false);//this stops saving ur barcode in barcode scanner app's history
                startActivityForResult(intent, 0);
            } catch (NameNotFoundException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
                 new AlertDialog.Builder(BitcoinAddressUtilityActivity.this)
                    .setTitle("WARNING:")
                    .setMessage("You don't have Barcode Scanner installed. Please install it.")
                     .setCancelable(false)
                    .setNeutralButton("Install it now", new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog, int whichButton) {         
                                  Uri uri = Uri.parse("market://search?q=pname:com.google.zxing.client.android");
                                  startActivity(new Intent(Intent.ACTION_VIEW, uri));
                            }
                    })
                    .show();

            }

        }

        public void onActivityResult(int requestCode, int resultCode, Intent intent) {
               if (requestCode == 0) {
                  if (resultCode == RESULT_OK) {
                     String contents = intent.getStringExtra("SCAN_RESULT");
                     String format = intent.getStringExtra("SCAN_RESULT_FORMAT");
                     // Handle successful scan
                     EditText passphrase = (EditText) findViewById(R.id.txtPassphrase);
                     passphrase.setText(contents);
                  } else if (resultCode == RESULT_CANCELED) {
                     // Handle cancel
                  }
               }
            }

    }); 
```

它执行得很好，没有错误，但 onActivityResults 永远不会触发，我什至收到警告：

`The method onActivityResult(int, int, Intent) from the type new View.OnClickListener(){} is never used locally`

我完全承认我是一个活动/意图菜鸟，所以如果有人想以教程的形式回答，我很乐意接受——我不只是想要修复代码，我想知道为什么会这样一开始不工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T06:27:12.540

您的代码中有以下问题

`public void onActivityResult(int requestCode, int resultCode, Intent intent)`您已经在按钮 onclick 侦听器中编写了方法。把它移到外面。

你的代码片段应该是这样的

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

            ----
            ----
}

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent intent) {
    super.onActivityResult(requestCode, resultCode, intent);

    if (requestCode == 0) {
              if (resultCode == RESULT_OK) {
                 String contents = intent.getStringExtra("SCAN_RESULT");
                 String format = intent.getStringExtra("SCAN_RESULT_FORMAT");
                 // Handle successful scan
                 EditText passphrase = (EditText) findViewById(R.id.txtPassphrase);
                 passphrase.setText(contents);
              } else if (resultCode == RESULT_CANCELED) {
                 // Handle cancel
              }
           }

} 
```

# ios - 将 UIImage 导出为 stretchableImage 导出图像，并在图像上绘制水平和垂直线

> ID：10966659
> 
> 赞同：3
> 
> 时间：2012-06-10T05:54:45.477
> 
> 标签：ios, uiimage

我试图构建一个应用程序，它结合了背景图像和顶部的文本气泡。我将文本气泡初始化为定义了 leftCapWidth 和 topCapHeight 的可拉伸 UIImages。在应用程序本身中显示文本气泡时，一切正常，文本气泡正常显示，顶部没有绘制任何线条。

但是，当我尝试导出图像时，我使用 UIGraphicsBeginImageContext() 函数将背景图像与顶部的文本气泡组合在一起，我看到文本气泡上有一条垂直线和一条水平线。它们似乎是在由 leftCapWidth 和 topCapHeight 定义的点绘制的。以前有人遇到过这样的问题吗？

在我的应用程序中渲染图像并导出它时，我看到的唯一区别是我使用 UIImageViews 来保存可拉伸图像，而导出我只是使用 UIImages。

将气泡图像与背景图像组合的代码：

```
UIGraphicsBeginImageContext(mainImage.size);

[fullSectionImage drawInRect:CGRectMake(0, 0, mainImage.size.width, mainImage.size.height) blendMode:kCGBlendModeNormal alpha:1.0 ];

UIImage *bubbleImage = [UIImage imageNamed:@"bubble1.png"];
stretchableImage = [bubbleImage stretchableImageWithLeftCapWidth:40 topCapHeight:15];
[stretchableImage drawInRect:CGRectMake(originX,originY,width,height) blendMode: kCGBlendModeNormal alpha:1.0 ];
UIImage *newImage = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext();   
UIImageWriteToSavedPhotosAlbum(newImage, nil,nil,nil); 
```

在应用程序中显示与背景图像相同的气泡的代码：

```
UIImageView *bubbleImageView;
UIImage *bubbleImage = [UIImage imageNamed:@"bubble1.png"];
stretchableImage = [bubbleImage stretchableImageWithLeftCapWidth:40 topCapHeight:15];
bubbleImageView = [[UIImageView alloc] initWithImage:stretchableImage];
[bubbleImageView setFrame:CGRectMake(0,0,width,height)];
bubbleImageView.autoresizingMask = YES;
[self addSubview:bubbleImageView]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T11:26:55.153

为了解决这个问题，stretchableImage 应该使用 drawInRect 方法，将所有整数值作为参数。

```
[stretchableImage drawInRect:CGRectMake(originX,originY,width,height) blendMode: kCGBlendModeNormal alpha:1.0 ]; 
```

在这种情况下，originX、originY、width、height 需要是整数值。这为我解决了这个问题。

# google-maps-api-3 - 提供的密钥不是有效的 Google API 密钥

> ID：10966668
> 
> 赞同：9
> 
> 时间：2012-06-10T05:57:34.490
> 
> 标签：google-maps-api-3

我收到错误

```
Google has disabled use of the Maps API for this application. The provided key is not a valid Google API Key, or it is not authorized for the Google Maps Javascript API v3 on this site. If you are the owner of this application, you can learn about obtaining a valid key here: https://developers.google.com/maps/documentation/javascript/tutorial#Obtaining_Key 
```

我已经从 api-console 生成了一个 API，并将其用于我的本地/本地主机网站，但每次我都收到上述错误。如何在本地服务器上显示谷歌地图？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-10-10T10:52:04.527

我今天遇到了和你类似的问题，我想我解决了。

首先，我假设您已经有一个 google map api 密钥。我想你需要做的是去[API Console - Google Code](http://code.google.com/apis/console)然后点击`API access`左边的。您可以看到您的 api 密钥，并在密钥下方`Referers:`显示您允许的引用者。您需要做的是单击`Edit allowed referers...`然后添加

> 本地主机/*

允许的推荐人。

我正在使用 MAMP 来托管我的 html，并监视我的浏览器发送给 google 的请求以获取 api，并得到以下标头：![在此处输入图像描述](../Images/bc1429e5addacbb1c8e3bde65014d767.png)

将推荐人显示为`localhost/*`

更改引荐来源后，Google 需要几分钟的时间来处理，但对我来说效果很好。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-05-05T02:03:45.097

@Fei 的回答帮助了我。我遇到的问题是包括多个推荐。以下对我来说效果很好。在添加每条记录之前输入回车符（而不是逗号或其他分隔符）。![在此处输入图像描述](../Images/975db5a7c536c3057fe44dfa3109e4cc.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-08T15:14:06.720

我有同样的问题。我没有正确地将我的域列入白名单。它应该被列入白名单，如下所示：

转到：[https](https://console.developers.google.com/) ://console.developers.google.com/ 转到：凭据。单击浏览器 API 密钥的“编辑允许的引用者”。添加以下引荐来源网址：

```
yourdomain.com
*.yourdomain.com 
```

或查看此链接以正确将您的域列入白名单：[https ://developers.google.com/console/help/#whitelistingbyhost](https://developers.google.com/console/help/#whitelistingbyhost)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-06-18T12:21:29.960

不知道这是否是同一个问题，但对我来说，它原来不是推荐人。我将 map.google.com 的网址更改为下面的网址，并将引荐来源网址更改为“允许的任何引荐来源网址”或列入白名单的模式之一[https://developers.google.com/console/help/#whitelistingbyhost](https://developers.google.com/console/help/#whitelistingbyhost)。

我从 url 中删除了版本和文件参数（即使版本为 3，它仍在通过 v2 授权）

```
<script src="http://maps.google.com/maps?sensor=false&amp;key=${YOUR_KEY}" type="text/javascript"></script> 
```

人们说你不需要钥匙，但没有它就无法让它工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-11-11T09:44:14.007

让我们试试这个方法。

*   将“密钥限制”设置为“无”。 [键限制自动搜索](https://i.stack.imgur.com/P0KrW.png)
*   使用您的本地主机 IP 地址来浏览该站点，而不是“本地主机 /”，在我的情况下它是“http://192.168.0.103/”检查下面的链接以获取您的 IP 地址[http://lifehacker.com/5833108/how-查找您的本地和外部 IP 地址](http://lifehacker.com/5833108/how-to-find-your-local-and-external-ip-address)

**但在此之前你必须**

*   来自 console.developers.google.com 的 Genarete API 代码

*   启用它并在您链接 api 的站点上使用它。

# .htaccess - 根据 URL 动态设置元标记

> ID：10966669
> 
> 赞同：-1
> 
> 时间：2012-06-10T05:57:43.423
> 
> 标签：.htaccess, facebook-graph-api, server-side, meta-tags

让我有一个搜索引擎来搜索 URL 中指定的查询，例如：-

```
1\. xyz.com/apple-ipod-touch
2\. xyz.com/apple-macbook-pro
3\. xyz.com/reebok-shoes 
```

现在，根据 URL，我希望设置页面的元标记。

请注意，我不希望使用 javascript 更改这些元标记，因为 Facebook 必须读取这些元标记才能发布流。所以，我期待一些改变服务器端本身的元标记的东西（比如通过.htaccess）。有没有办法做同样的事情？

任何建议或链接都​​可以。

如果我不清楚我的疑问，请发表评论。

谢谢 ！

谢谢 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T06:07:36.870

如果页面是动态创建的，那么我会假设您正在使用某种数据库来存储与每个产品有关的信息。因此，当您拨打电话时，只需简单地放置一些类似的东西

```
<?
    $ogtitle = ($mysqlrow["product_title"])? $mysqlrow["product_title"] : "Use normal site title here";
?>
<meta property="og:title" content="<?=$ogtitle;?>" /> 
```

这是假设您使用的是 PHP，但也是其他服务器端语言的基本场景。

# php - 从变量调用命名空间

> ID：10966674
> 
> 赞同：2
> 
> 时间：2012-06-10T05:59:41.587
> 
> 标签：php, namespaces, instance

我需要创建一个动态命名空间：`[module]\controller\[controller]Controller`，但以下代码不起作用：

```
$namespace = '\Account\Controller\LoginController()';
new $namespace; 
```

像这样：

```
new \Account\Controller\LoginController(); 
```

我忘记了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T06:07:28.593

不要添加`()`到字符串中。`()`是在调用函数时使用，而不是在其名称中。

```
$namespace = '\Account\Controller\LoginController';
new $namespace; 
```

如果要传递参数，请将 添加`()`到`new`调用中。

```
$namespace = '\Account\Controller\LoginController';
new $namespace('abc'); 
```

# xcode - 故事板：使用委托/协议方法关闭 Popover

> ID：10966677
> 
> 赞同：11
> 
> 时间：2012-06-10T06:00:21.700
> 
> 标签：xcode, uibutton, storyboard, popover

我已经阅读了*很多*关于这方面的内容，虽然大多数似乎都是关于非故事板方法的，但我认为我已经拼凑起来并弄清楚了。但是，以下代码不会导致我的弹出框被解除。Popover 中的dismissPopoverButtonPressed 按钮执行，但委托中的dismissPopover 方法中的断点从未命中。非常感谢有人注视代码以发现错误。

谢谢

在下面，NewGameViewController 包含一个 UIButton。按下此按钮会导致 Popover Segue 并随后显示包含 PopViewController UIView 的弹出框。

**新游戏视图控制器.h**

```
#import "PopViewController.h"
@interface NewGameViewController: UIViewController <DismissPopoverDelegate>
{
    UIPopoverController *popover;
} 
```

**新游戏视图控制器.m**

```
@implementation NewGameViewController
-(void)prepareForSegue:(UIStoryboardPopoverSegue *)segue sender:(id)sender
{
    if ([[segue identifier] isEqualToString:@"popoverSegue"])
    {
        popover = [(UIStoryboardPopoverSegue *)segue popoverController];
        // getting warning: Assigning to 'id<UIPopoverControllerDelegate>' from incompatible type 'NewGameViewController *const__strong'
        //popover.delegate = self;
    }
}

-(void)dismissPopover
{
    [popover dismissPopoverAnimated:YES];
} 
```

**PopViewController.h**

```
@protocol DismissPopoverDelegate <NSObject>
-(void) dismissPopover;
@end

@interface PopViewController: UIViewController
{
    __unsafe_unretained id<DismissPopoverDelegate> delegate;
}

@property (nonatomic, assign) id<DismissPopoverDelegate> delegate;
-(IBAction)dismissPopoverButtonPressed:(id)sender;
@end 
```

**PopViewController.m**

```
#import "NewGameViewController.h"
@implementation PopViewController
@synthesize delegate;
-(IBAction)dismissPopoverButtonPressed:(id)sender
{
    [self.delegate dismissPopover];
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-10T06:41:47.903

当从故事板 segue 链接到 popover 控制器时，segue 的`popoverController`属性指的是标准的 UIPopoverController。这个控制器本身有一个属性，[`contentViewController`](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIPopoverController_class/Reference/Reference.html)，它将代表实际上在弹出窗口中呈现的视图控制器，在你的例子中是`PopViewController`.

因此，您当前的代码将自己设置为弹出框控制器的委托，而它确实需要将自己设置为弹出框*内容*视图控制器的委托。

您仍然需要保留对 popover 控制器的引用以关闭，因此保留现有代码，但进行以下更改：

```
-(void)prepareForSegue:(UIStoryboardPopoverSegue *)segue sender:(id)sender
{
    if ([[segue identifier] isEqualToString:@"popoverSegue"])
    {
        popover = [(UIStoryboardPopoverSegue *)segue popoverController];
        // Get a reference to the content view controller of the popover
        PopViewController *popVC = (PopViewController*)popover.contentViewController;
        // Set ourselves as the content VC's delegate
        popVC.delegate = self;
    }
} 
```

# mysql - 带有条件If（更新或插入）的SQL查询？

> ID：10966681
> 
> 赞同：2
> 
> 时间：2012-06-10T06:01:21.493
> 
> 标签：mysql, sql, database

我有 4 个单元格（`A`, `B`, `C`, `D`），如果它们是空的，我需要更新它们，但不是同时更新它们，例如：如果为空`A`而不是更新`A`-> 设置为 10，如果`A`已满，则检查`B`单元格，如果它是空的，则放 10 个，这也可能分配给其他最后两个单元格`C`，`D`如果更新了 1 个单元格，则不需要更新其他 3 个单元格，如果所有单元格都比 INSERT INTO `table` ( `A`) VALUES(10) 满。

我做了一个，但这是错误的查询，因为它正在更新所有单元格：

```
mysql> UPDATE `mytable` SET `A`=10,`B`=10,`C`=10,`D`=10 WHERE `A` IS NULL OR `B` IS NULL OR `C` IS NULL OR `D` IS NULL LIMIT 1;
Query OK, 1 row affected (0.06 sec)
Rows matched: 1 Changed: 1 Warnings: 0 
```

希望得到帮助。

**更新** 似乎真的是程序中的逻辑问题，首先我需要选择所有单元格，这个查询将是这样的：

```
mysql> SELECT `A`,`B`,`C`,`D` FROM `mytable` WHERE `A` IS NULL OR `B` IS NULL OR `C` IS NULL OR `D` IS NULL LIMIT 1; 
```

然后进行下一步。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T06:20:52.950

您的数据结构似乎特别奇怪：也许另一种结构会以更好的方式实现您想要的结果？但是，如果没有有关您尝试建模的问题的更多信息，您可以使用以下内容执行您提到的更新：

```
LOCK TABLES mytable WRITE;

INSERT INTO `table` (A) SELECT 10 FROM mytable WHERE
  A IS NOT NULL AND B IS NOT NULL AND C IS NOT NULL AND D IS NOT NULL;

UPDATE mytable SET
  D = IF(A IS NOT NULL AND B IS NOT NULL AND C IS NOT NULL AND D IS NULL, 10, D),
  C = IF(A IS NOT NULL AND B IS NOT NULL AND C IS NULL, 10, C),
  B = IF(A IS NOT NULL AND B IS NULL, 10, B),
  A = IF(A IS NULL, 10, A);

UNLOCK TABLES; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T06:10:42.880

您可以执行以下操作：http: [//dev.mysql.com/doc/refman/5.0/en/insert-on-duplicate.html](http://dev.mysql.com/doc/refman/5.0/en/insert-on-duplicate.html)

```
INSERT INTO <table> 
 VALUES (1, 2, 3 ,4) 
 ON DUPLICATE KEY
UPDATE a=1,b=2,c=3,d=4 
```

但我认为这不会达到你的目的。您只需要用 PHP 或您的服务器端语言编写逻辑。

# ruby-on-rails-3 - 乘客 Nginx 上运行的 Rails 的 Web 服务器日志文件在哪里？

> ID：10966686
> 
> 赞同：1
> 
> 时间：2012-06-10T06:03:18.500
> 
> 标签：ruby-on-rails-3, logging, passenger

我知道这是一个非常愚蠢的问题，但我自己无法弄清楚：我有一个 Rails 服务器在乘客 Nginx 上运行。我注意到有 3 个可能相关的日志文件： `$app/current/logs/production.log`和`$nginx/logs/access.log`和`$nginx/logs/error.log`. 最近我的应用程序遇到错误。我希望将错误转储到上述 3 个文件中的任何一个。但事实上，当我查看它们时，没有一个包含错误。除了资产编译输出之外，production.log 不包含任何内容。access.log 和 error.log 仅包含来自 nginx 本身的非常基本的日志记录。

我没有在我的应用程序中自定义任何关于 Rails.logger 的内容。

我错过了什么？我现在在哪里可以查找应用程序错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T06:33:04.573

Josh，原来是最近一期的 Rails（我正在运行的 3.2.1）。@babatakao 提出了一个修复建议（如[https://github.com/rails/rails/issues/4277](https://github.com/rails/rails/issues/4277)中所指定）：

```
Rails.logger.instance_variable_get(:@logger).instance_variable_get(:@log_dest).sync = true if Rails.logger 
```

# jquery - 如何使用 jQuery 找到每个表格单元格的“视觉位置”？

> ID：10966687
> 
> 赞同：11
> 
> 时间：2012-06-10T06:03:19.560
> 
> 标签：jquery, html, algorithm, html-table

我有一个包含 ROWSPAN 和 COLSPAN 的 HTML 表。

如何使用 jQuery 找到每个单元格的“视觉位置”？

例如，这是我的表格的可视化表示，每个单元格都填充了“视觉位置”算法应返回的内容：（
*注意：我只关心其中的单元格`<tbody>`，列引用可以是整数，而不是字母字符，我这样做只是为了轻松突出问题）*

```
+--+--+--+--+--+
|  |A |B |C |D |
+--+--+--+--+--+
|1 |A1|B1   |D1|
+--+--+--+--+  +
|2 |A2   |C2|  |
+--+     +--+  +
|3 |     |C3|  |
+--+--+--+--+--+
|4 |A4|B4|C4|D4|
+--+--+--+--+--+
|XYZ           |
+--+--+--+--+--+ 
```

我已经尝试实现第一个，但是单元格 C3 的引用不准确，因为它没有考虑 ROWSPANS。第二个链接可能能够合并到第一个的解决方案中，但我不知道如何。

*   [在 jQuery 中处理表格 | 我的科技世界](http://mytechworld.officeacuity.com/index.php/2009/09/working-with-tables-in-jquery/)
*   [检索受“行跨度”影响的行列的最有效方法是什么？- 堆栈溢出](https://stackoverflow.com/a/1452582)

我希望将其用作一个调用的函数，该函数`getCellLocation(cell)`将返回一个关联数组，该数组返回如下所示的位置：

```
function getCellLocation(cell)
{
  var row_number = parseInt($(cell).parent().prevAll().length) + 1;
  var col_number = 1;
  $(cell).prevAll('td').each(function() {
      col_number += $(this).attr('colspan') ? parseInt($(this).attr('colspan')) : 1;
  });

  var location = new Array();
  location['row'] = row_number;
  location['col'] = col_number;
  location['index'] = $('td').index(cell) + 1;
  return location;
}

$('table td').each(function(i){
  var cell = getCellLocation($(this));
  $(this).prepend('<span class="ref">R' + cell['row'] + ':C' + cell['col'] + ':D' + cell['index'] + '</span>');
}); 
```

这是示例表的 HTML：

```
<table border="1" cellspacing="0">
  <thead>
    <tr>
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td colspan="2">B1</td>
      <td rowspan="3">D1</td>
    </tr>
    <tr>
      <th>2</th>
      <td rowspan="2" colspan="2">A2</td>
      <td>C2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>C3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A4</td>
      <td>B4</td>
      <td>C4</td>
      <td>D4</td>
    </tr>
  </tbody>
  <tfoot>
    <tr>
      <td colspan="5">XYZ</td>
    </tr>
  </tfoot>
</table>
<style> span { background-color: #ffc; margin-right: .5em;} </style> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-10T08:57:50.377

这是我的解决方案：

```
function getCellLocation(cell) {

    var cols = cell.closest("tr").children("td").index(cell);
    var rows = cell.closest("tbody").children("tr").index(cell.closest("tr"));
    var coltemp = cols;
    var rowtemp = rows;

    cell.prevAll("td").each(function() {
        cols += ($(this).attr("colspan")) ? parseInt($(this).attr("colspan")) - 1 : 0;
    });

    cell.parent("tr").prevAll("tr").each(function() {
        //get row index for search cells
        var rowindex = cell.closest("tbody").children("tr").index($(this));
        // assign the row to a variable for later use
        var row = $(this);
        row.children("td").each(function() {
            // fetch all cells of this row
            var colindex = row.children("td").index($(this));
            //check if this cell comes before our cell
            if (cell.offset().left > $(this).offset().left) {
                // check if it has both rowspan and colspan, because the single ones are handled before
                var colspn = parseInt($(this).attr("colspan"));
                var rowspn = parseInt($(this).attr("rowspan"));
                if (colspn && rowspn) {
                    if(rowindex + rowspn > rows)
                    cols += colspn;                    
                }
                if(rowspn && rowindex + rowspn > rows) cols +=1;
            }

        });
    }); 
```

我正在检查同时具有 colspan 和 rowspan 的单元格，因为其余部分由该代码的前五行处理。如果单元格同时具有行跨度和跨度，它们应该会影响不低于或除此单元格之外的其他单元格，因此我需要搜索每个单元格的先前单元格以进行交互。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-05-21T15:38:31.390

```
your solution        my proposed table design
+--+--+--+--+--+     +--+--+--+--+--+
|  |A |B |C |D |     |  |A |B |C |D |     length 5 vs 5
+--+--+--+--+--+     +--+--+--+--+--+
|1 |A1|B1   |D1|     |1 |A1|B1|//|D1|
+--+--+--+--+  +     +--+--+--+--+--+
|2 |A2   |C2|  |     |2 |A2|//|C2|//|     length 3 vs 5
+--+     +--+  +     +--+--+--+--+--+
|3 |     |C3|  |     |3 |//|//|C3|//|
+--+--+--+--+--+     +--+--+--+--+--+
|4 |A4|B4|C4|D4|     |4 |A4|B4|C4|D4|
+--+--+--+--+--+     +--+--+--+--+--+
|XYZ           |     |XY|//|//|//|//|     length 1 vs 5
+--+--+--+--+--+     +--+--+--+--+--+ 
```

```
// cells labeled '//' above have this class

td.stuffing { display: none; } 
```

你看到我在那里做了什么吗？

这是第三行，例如：

```
<tr>
  <th>2</th>
  <td rowspan="2" colspan="2">A2</td>
  <td class="stuffing"></td>
  <td>C2</td>
  <td class="stuffing"></td>
</tr> 
```

现在检索正确索引的功能非常简单。

```
function getCellLocation(cell) {
    return {row:cell.parentNode.rowIndex, cell:cell.cellIndex}
} 
```

* * *

这是一个奖金。如果您要访问隐藏的单元格，它将自动遍历到正确的单元格，该单元格跨越隐藏的单元格。

```
function getSmartCell(table, row, col) {
    var cell = table.rows[row].cells[col];
    if (cell.className.indexOf("stuffing") == -1) return cell;

    // traverse Left
    while ((row>0) && (col>0) && (cell.className.indexOf("stuffing") >= 0)) {
        cell = table.rows[row].cells[--col];
    }

    // roll back one cell if no colSpan is found
    if (cell.colSpan == 1) cell = table.rows[row].cells[++col];

    // traverse Up
    while ((row>0) && (col>0) && (cell.className.indexOf("stuffing") >= 0)) {
        cell = table.rows[--row].cells[col];
    }

    return cell;
} 
```

用法：

```
var tb = document.querySelector("table");
getCellLocation(getSmartCell(tb,3,2)); // {row: 2, cell: 1} 
```

**注意** 我刚刚检查了代码，`getSmartCell`如果有两个相邻的行跨度，它会返回错误的结果。我需要解决这个问题。

这是一个示例[https://jsfiddle.net/goua3m13/](https://jsfiddle.net/goua3m13/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T18:23:53.433

这是一个能够处理复杂表结构的 jQuery 解决方案。此解决方案使用此处提供的[开源 WxT 表解析器](https://github.com/wet-boew/wet-boew/blob/master/src/js/dependencies/parserTable.js)：[https ://raw.github.com/wet-boew/wet-boew/master/src/js/dependencies/parserTable.js](https://raw.github.com/wet-boew/wet-boew/master/src/js/dependencies/parserTable.js)

您将在[Table Usability Concept Github 存储库](https://github.com/duboisp/Table-Usability-Concept)中找到文档。使用“Table Parser - WET 3.0 release”下的 API 文档。

表格解析是通过使用 HTML 表格标记和数据单元格 (td) 和标题单元格 (th) 之间的视觉关系来完成的

```
// Used to get the reference to the WxT table parser
var _pe = window.pe || {
    fn : {}
};

// For each table elements
$('table').each(function () {

    var $tbl = $(this);

    // Parse the table
    _pe.fn.parsertable.parse($tbl);

    // For each data cell
    $('td', $tbl).each(function () {

        var $td = $(this),
            tblparser;

        // Get the API structure as defined under "Table Parser - WET 3.0 release" (https://github.com/duboisp/Table-Usability-Concept/blob/master/API/td.md#table-parser---wet-30-release)
        tblparser = $td.data().tblparser;

        // Set the cell location (x, y)
        $td.html(tblparser.row.rowpos + ', ' + tblparser.col.start);

    });
}); 
```

你会在这里找到一个工作示例：http: [//jsfiddle.net/TVttA/](http://jsfiddle.net/TVttA/)

干杯

:-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-10T07:56:08.517

对于这种特定的布局（即，如果您的第一行没有 colspan 和或多或少统一的单元格边框），您可以这样做：

```
function getCellLocation(cell)
{
    var row_number = cell.parentNode.rowIndex;
    var col_number = "";
    $(cell).parents('table').find('tr:first th').each( function()
    {
        if (cell.offsetLeft >= this.offsetLeft)
        {
            col_number = $(this).text();
        }
        else return false;
    });
    return col_number + row_number;
} 
```

如果你想要数字列将其更改为

```
var col_number = 0;
    ...
if (cell.offsetLeft >= this.offsetLeft)
{
    col_number++;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-07-08T17:22:19.337

由于接受的答案缺少`return`声明并且仅适用于 tbody 和 td（而不适用于 thead 和 th），因此我做了一些细微的调整以使其工作：

```
function getCellLocation(cell) {

    var cols = cell.closest("tr").children("th, td").index(cell);
    var rows = cell.closest("thead, tbody").children("tr").index(cell.closest("tr"));

    cell.prevAll("th, td").each(function() {
        cols += ($(this).attr("colspan")) ? parseInt($(this).attr("colspan")) - 1 : 0;
    });

    cell.parent("tr").prevAll("tr").each(function() {
        //get row index for search cells
        var rowindex = cell.closest("thead, tbody").children("tr").index($(this));
        // assign the row to a variable for later use
        var row = $(this);
        row.children("th, td").each(function() {
            //check if this cell comes before our cell
            if (cell.offset().left > $(this).offset().left) {
                // check if it has both rowspan and colspan, because the single ones are handled before
                var colspn = parseInt($(this).attr("colspan"));
                var rowspn = parseInt($(this).attr("rowspan"));
                if (rowspn && rowindex + rowspn > rows) {
                    cols += colspn ? colspn : 1;
                }
            }

        });
    });
    return cols;
} 
```

# node.js - 在 Express 中设置客户端可访问的 Cookie

> ID：10966689
> 
> 赞同：34
> 
> 时间：2012-06-10T06:03:42.137
> 
> 标签：node.js, cookies, express, socket.io

我正在开发一个使用 Express 和 SocketIO 的 Node 应用程序。我想在我的 Express 控制器中设置一个 cookie，然后可以从我的客户端 Javascript 代码访问它。我尝试的一切似乎都不起作用：

```
res.setHeader('Set-Cookie','test=value');
res.cookie('rememberme', 'yes', { maxAge: 900000 }); 
```

我在这里缺少什么吗？提前致谢！

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-06-11T05:00:36.630

弄清楚了！默认情况下，Express 将选项 httpOnly 设置为 true。这意味着客户端 Javascript 无法访问您的 cookie。为了正确设置客户端可访问的 cookie，只需使用如下代码段：

```
res.cookie('rememberme', 'yes', { maxAge: 900000, httpOnly: false}); 
```

我还注意到，如果您调用此命令然后调用 res.redirect，则不会设置 cookie。该命令需要在某些时候跟随 res.render 才能工作。不知道为什么会这样。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-11-12T14:50:54.180

实际上，我已经经历了几个小时的相同问题。

这是我的代码：

```
res.cookie("mycookie", "1234567890", { secure:true, maxAge:120000, httpOnly: true }); 
```

我可以在响应标头中看到 Set-Cookie 指令，但在 Chrome 中我找不到 cookie，并且我无法通过 req.cookies['mycookie'] 找到 cookie。

这个问题的根本原因是我没有使用HTTPS连接。（带有 cookie-parser 中间件的 Express 4.x）

根据此文档：[保护 Express 节点应用程序的简单步骤](http://scottksmith.com/blog/2014/09/04/simple-steps-to-secure-your-express-node-application/)

如果我设置选项 secure=true，那么浏览器将不会在任何 HTTP 请求中发送我的 cookie，而是在 HTTPS 安全连接中发送。然后在我删除了 secure:true 选项后，我得到了我的 cookie 工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-06T08:09:50.150

所以要在 http 中访问，我们可以使用：

```
res.cookie("mycookie", "1234567890", { secure:false, maxAge:120000, httpOnly: true });? 
```

# java - 线程在 JBoss 5 上停止响应

> ID：10966694
> 
> 赞同：2
> 
> 时间：2012-06-10T06:05:52.587
> 
> 标签：java, multithreading, jakarta-ee, jboss

我在 JBoss 5.1 服务器（Java 6u22）中产生了许多线程，它们并行处理大量输入文件。

突然，其中一个线程停止了响应。其他线程都很好。我无法再从该服务器获取线程转储。任何人都可以就可能导致这种情况的原因提供一些想法吗？

这是我在日志中的所有内容：

```
WARN    (Thread-9) [arjLoggerI18N] [com.arjuna.ats.arjuna.coordinator.TransactionReaper_18] - TransactionReaper::check timeout for TX 7f000001:bb15:4fd24ef6:6f42 in state  RUN
WARN    (Thread-10) [arjLoggerI18N] [com.arjuna.ats.arjuna.coordinator.BasicAction_58] - Abort of action id 7f000001:bb15:4fd24ef6:6f42 invoked while multiple threads active within it.
WARN    (Thread-10) [arjLoggerI18N] [com.arjuna.ats.arjuna.coordinator.CheckedAction_2] - CheckedAction::check - atomic action 7f000001:bb15:4fd24ef6:6f42 aborting with 1 threads active!
WARN    (Thread-9) [arjLoggerI18N] [com.arjuna.ats.arjuna.coordinator.TransactionReaper_18] - TransactionReaper::check timeout for TX 7f000001:bb15:4fd24ef6:6f42 in state  CANCEL
WARN    (Thread-9) [arjLoggerI18N] [com.arjuna.ats.arjuna.coordinator.TransactionReaper_18] - TransactionReaper::check timeout for TX 7f000001:bb15:4fd24ef6:6f42 in state  CANCEL_INTERRUPTED
WARN    (Thread-9) [arjLoggerI18N] [com.arjuna.ats.arjuna.coordinator.TransactionReaper_6] - TransactionReaper::check worker Thread[Thread-10,5,jboss] not responding to interrupt when cancelling TX 7f000001:bb15:4fd24ef6:6f42 -- worker marked as zombie and TX scheduled for mark-as-rollback
WARN    (Thread-9) [arjLoggerI18N] [com.arjuna.ats.arjuna.coordinator.TransactionReaper_11] - TransactionReaper::check failed to mark TX 7f000001:bb15:4fd24ef6:6f42  as rollback only
WARN    (Thread-10) [arjLoggerI18N] [com.arjuna.ats.arjuna.coordinator.TransactionReaper_13] - TransactionReaper::doCancellations worker Thread[Thread-10,5,jboss] missed interrupt when cancelling TX 7f000001:bb15:4fd24ef6:6f42 -- exiting as zombie (zombie count decremented to 0) 
```

# java - mysql stored procedure always returning out parameter value = 0

> ID：10966695
> 
> 赞同：1
> 
> 时间：2012-06-10T06:06:00.927
> 
> 标签：java, mysql, stored-procedures, return, return-value

**MySql Stored Procedure**

```
DELIMITER $$

USE `RMS`$$

DROP PROCEDURE IF EXISTS `posHdrTrxEntry`$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `posHdrTrxEntry`(

IN mbrID INT,
IN usrID INT,
IN unqID VARCHAR(50),

OUT trxID INT
)
BEGIN
DECLARE trxID INT;

INSERT INTO `RMS`.`transaction`
(`MemberID`,`UserID`,`UID`)
VALUES (mbrID,usrID,unqID);

IF  ROW_COUNT() > 0 THEN
SET trxID=(SELECT ID FROM `transaction` WHERE `transaction`.`UID`=unqID);
END IF;

IF trxID > 0 THEN
UPDATE `transaction` SET `transaction`.`UID`=0 WHERE `transaction`.`ID`=trxID;
END IF;

END$$

DELIMITER ; 
```

**Java** **--Code Snippet**

```
Connection connection = null;
    int trxID;
    try {
        connection = new DbService().getConnection();
 CallableStatement cs = connection.prepareCall("{ CALL posHdrTrxEntry(?,?,?,?) }");
        cs.setString(1, null);
        cs.setInt(2, item.getUserID());
        cs.setString(3, item.getUid());
        cs.registerOutParameter(4, java.sql.Types.INTEGER);
        cs.execute();
        trxID=cs.getInt(4);
        cs.close(); 
```

Stored Procedure always returning out parameter value = 0, even stored procedure last update statement execute successfully

```
IF trxID > 0 THEN
UPDATE `transaction` SET `transaction`.`UID`=0 WHERE `transaction`.`ID`=trxID;
END IF; 
```

Its means that TrxID is greater than 0, why I get value only 0 in java?

**Edit** **(Picture View)** ![enter image description here](../Images/ee6d97327810377e131e34525d4faba9.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T07:02:07.780

Dear just remove the first statement after BEIGN

Remove the Following:

```
DECLARE trxID INT; 
```

Because this is out parameter , u can just use SET to assign the value.

I think It will work fine!

# java - java.lang.StringIndexOutOfBoundsException: index=0 length=0 in get sqlite database

> ID：10966705
> 
> 赞同：5
> 
> 时间：2012-06-10T06:08:04.610
> 
> 标签：java, android, database, sqlite, indexoutofboundsexception

我正在尝试使用此代码打开一个可写的 SQLite 数据库...

```
public DataAdapterForServieClass open() throws SQLException {
    db = DBHelper.getWritableDatabase();
    return this;
} 
```

但是我`db = DBHelper.getWritableDatabase();`在线上收到以下错误...

```
06-10 11:58:13.995: ERROR/AndroidRuntime(548): FATAL EXCEPTION: main
06-10 11:58:13.995: ERROR/AndroidRuntime(548): java.lang.StringIndexOutOfBoundsException: index=0 length=0
06-10 11:58:13.995: ERROR/AndroidRuntime(548):     at android.app.ContextImpl.validateFilePath(ContextImpl.java:1518)
06-10 11:58:13.995: ERROR/AndroidRuntime(548):     at android.app.ContextImpl.openOrCreateDatabase(ContextImpl.java:725)
06-10 11:58:13.995: ERROR/AndroidRuntime(548):     at android.content.ContextWrapper.openOrCreateDatabase(ContextWrapper.java:221)
06-10 11:58:13.995: ERROR/AndroidRuntime(548):     at android.database.sqlite.SQLiteOpenHelper.getWritableDatabase(SQLiteOpenHelper.java:149) 
```

这是我`DBHelper`班的代码...

```
static class DatabaseHelper extends SQLiteOpenHelper {
    DatabaseHelper(Context context) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);
    }

    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        Log.w(TAG, "Upgrading database from version " + oldVersion 
            + " to "
            + newVersion + ", which will destroy all old data");
        db.execSQL("DROP TABLE IF EXISTS titles");
        onCreate(db);
    }

    public void onCreate(SQLiteDatabase arg0) {
        // TODO Auto-generated method stub
    }
} 
```

有人可以帮助我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T06:21:04.240

当您第一次调用`getWritableDatabase()`时，它将调用以下方法，根据[Android文档](http://developer.android.com/reference/android/database/sqlite/SQLiteOpenHelper.html)...

```
onCreate(SQLiteDatabase)
onUpgrade(SQLiteDatabase, int, int)
onOpen(SQLiteDatabase) 
```

您的方法中没有任何代码`onCreate()`- 您需要在这里做一些事情才能工作，例如这个......

```
public void onCreate(SQLiteDatabase database) {
    database.openOrCreateDatabase("/come/example/mydatabase",null);
} 
```

查看[您发布](http://www.reigndesign.com/blog/using-your-own-sqlite-database-in-android-applications/)`checkDataBase()`的链接中它调用的方法- 这做同样的事情，并且是您缺少的重要代码片段。您需要先创建数据库，然后才能对其进行任何操作。`openDatabase()`

还要确保在代码中的某处创建 DBHelper 实例，以便它调用该`super()`方法。像这样...

```
DBHelper helper = new DatabaseHelper(context); 
```

# php - ActionScript 将异步数据发送到 PHP 文件

> ID：10966706
> 
> 赞同：0
> 
> 时间：2012-06-10T06:08:27.590
> 
> 标签：php, actionscript-3, asynchronous

我必须将 300 个位图数据发送到一个 PHP 文件，该文件将它们保存为 PNG。我不能只添加一个`addEventListener`and `Event.COMPLETE`。我在一些循环中解析和创建这些位图数据，当创建位图时，它将它发送到 PHP 文件。问题是它对前 130 个 +/- 图像工作正常，但随后我不断收到此错误：

> 错误 #2044：未处理的 ioError:。文本=错误 #2032：流错误

有没有办法异步发送数据？因为我认为 PHP 文件不能同时处理这么多的请求。

这是代码：

```
import flash.events.Event;
import flash.net.URLLoader;
import flash.net.URLRequest;
import com.*;

var loadFurni = new Object();
var loaderID = 0;
var furniName = "tv_luxus";
var furniSwf = "swf/"+furniName+".swf";

loadFurni[loaderID] = new Loader();
var swfRequest = new URLRequest(furniSwf);

loadFurni[loaderID].load(swfRequest);
loadFurni[loaderID].contentLoaderInfo.addEventListener(Event.COMPLETE, onLoaded);

function onLoaded(event:Event){

    var getAssetXML = event.target.applicationDomain.getDefinition(furniName+"_"+furniName+"_assets");
    getAssetXML = new getAssetXML;
    var assets = new XML(getAssetXML);
    var getVisualXML = event.target.applicationDomain.getDefinition(furniName+"_"+furniName+"_visualization");
    getVisualXML = new getVisualXML;
    var visualization = new XML(getVisualXML);

    var colorsStr = "";
    var colors = colorsStr.split(",");

    //possible sizes
    var furniSizes = new Array(32, 64);

    for each(var furniSize in furniSizes){

        var furniBgWidth;
        var furniBgHeight;
        var furniBg:Bitmap;

        var furniBgX = 0;
        var furniBgY = 0;

        var visualizationID;
        var layerCount;
        var dirs = new Array();
        var blendModes = new Array();
        var alphaModes = new Array();
        var zModes = new Array();

        var paddingBottom = 30;

        //getting the layercount + visualizationID
        for(var l=0; l<visualization.visualization.length(); l++){
            if(visualization.visualization[l].@size == furniSize){
                layerCount = visualization.visualization[l].@layerCount;
                visualizationID = l;
            }
        }

        //now searching the possible directions
        for(var d=0; d<visualization.visualization[visualizationID].directions.direction.length(); d++){
            dirs.push(visualization.visualization[visualizationID].directions.direction[d].@id);
        }

        for each(var dir in dirs){

            var animations = new Array();

            //searching the possible animations
            for(var ta=0; ta<visualization.visualization[visualizationID].animations.animation.length(); ta++){
                animations.push(visualization.visualization[visualizationID].animations.animation[ta].@id);
            }

            //if there's no animation
            if(animations[0] == undefined){ animations = new Array("0"); }

            for each(var animation in animations){
                //getting layersinformations such as blendmodes, zindex and alpha
                var layers = visualization.visualization[visualizationID].layers[0];
                if(layers != undefined && layers.layer[0] != undefined){
                    for each(var layer in layers.layer){
                        blendModes[layer.@id] = (layer.@ink!= undefined) ? layer.@ink : "NORMAL";
                        alphaModes[layer.@id] = (layer.@alpha!= undefined) ? int(layer.@alpha): 255;
                        zModes[layer.@id] = (layer.@z!= undefined) ? int(layer.@z): 0;
                    }
                }

                //zIndex fix. sometimes the zindex is saved in the <direction/>
                for(var zfix=0; zfix<visualization.visualization[visualizationID].directions.direction.length(); zfix++){
                    if(visualization.visualization[visualizationID].directions.direction[zfix].@id == dir){
                        for(var zfixl=0; zfixl<visualization.visualization[visualizationID].directions.direction[zfix].layer.length(); zfixl++){
                            if(visualization.visualization[visualizationID].directions.direction[zfix].layer[zfixl].@z != undefined){
                                zModes[visualization.visualization[visualizationID].directions.direction[zfix].layer[zfixl].@id] = visualization.visualization[visualizationID].directions.direction[zfix].layer[zfixl].@z;
                            }
                        }
                    }
                }

                var frames = new Array();

                //settings the default frames
                if(visualization.visualization[visualizationID].animations != undefined && visualization.visualization[visualizationID].animations.animation != undefined){
                    for each(var animationLayer in visualization.visualization[visualizationID].animations.animation[0].animationLayer){
                        frames[animationLayer.@id] = new Array( );
                        //the problem is, that sometimes there aint no framesequences. so we just add 0 as default.
                        if(animationLayer.frameSequence !=undefined){
                            for each(var sframe in animationLayer.frameSequence.frame){
                                frames[animationLayer.@id].push(sframe.@id);
                            }
                        }
                        else {
                            frames[animationLayer.@id].push(0);
                        }
                    }
                }

                //overwriting the stuff with the animation layers
                if(animation>0){
                    for each(animationLayer in visualization.visualization[visualizationID].animations.animation[animation].animationLayer){
                        if(animationLayer.frameSequence !=undefined){
                            if(frames[animationLayer.@id] !=undefined){
                                //clearing the array, so we can overwrite it.
                                frames[animationLayer.@id].splice(0);
                                for each(sframe in animationLayer.frameSequence.frame){
                                    frames[animationLayer.@id].push(sframe.@id);
                                }
                            }
                            else {
                                //creating a new array
                                frames[animationLayer.@id].push(0);
                            }
                        }
                    }
                }

                //count lowest framerate
                var lowestFrameRate = 9999;
                for(var low in frames){
                    if(lowestFrameRate > frames[low].length){ 
                        lowestFrameRate = frames[low].length;
                    }
                }

                if(lowestFrameRate == 9999){
                    lowestFrameRate=0;
                }

                //count highest framerate
                var highestFrameRate = 0;
                if(frames[lowestFrameRate] != undefined){
                    for(var high in frames){
                        if(highestFrameRate < frames[high].length){ 
                            highestFrameRate = frames[high].length;
                        }
                    }
                }

                if(!highestFrameRate){
                    highestFrameRate=1;
                }

                for(var frame=0; frame<(highestFrameRate); frame++){

                    //trace("[size: "+furniSize+"; dir: "+dir+"; animation: "+animation+"; frame: "+frame+"] {");
                    var furniParts = new Array();
                    var cordHX = 0;
                    var cordLX = 10000;
                    var cordHY = 0;
                    var cordLY = 10000;
                    var cordHYC =0;
                    var actualFrame;

                    for(var i = 0; i<layerCount; i++){
                        if(frames[i] == undefined) actualFrame = 0;
                        else actualFrame = (!frames[i][frame]) ? frames[i][0] : frames[i][frame];

                        for each(var asset in assets.asset){
                            var furniClass = furniName+"_"+furniSize+"_"+String.fromCharCode(97+i)+"_"+dir+"_"+actualFrame;
                            if(asset.@name == furniClass){
                                var flip = false;
                                if(asset.@flipH == "1") {
                                    furniClass = asset.@source;
                                    flip = true;
                                }
                                else if(asset.@source != undefined){
                                    furniClass = asset.@source;
                                }

                                //trace(furniClass);

                                var bmp;

                                if(event.target.applicationDomain.hasDefinition(furniName+"_"+furniClass)){
                                    bmp = event.target.applicationDomain.getDefinition(furniName+"_"+furniClass);
                                    bmp = new bmp;
                                }

                                else  { trace("CONTINUED"); continue; };

                                if(((asset.@x*-1) + (bmp["width"]*1)) > cordHX){
                                    cordHX = (asset.@x*-1) + (bmp["width"]*1);
                                }
                                if(((asset.@x*-1) < cordLX)){
                                    cordLX = (asset.@x*-1);
                                }

                                if(((asset.@y*-1) + (bmp["height"]*1)) > cordHY){
                                    cordHY = (asset.@y*-1) + (bmp["height"]*1);
                                }

                                if(((asset.@y*-1) < cordLY)){
                                    cordLY = (asset.@y*-1);
                                }
                                if(((asset.@y*-1) < cordHYC)){
                                    cordHYC = (asset.@y*-1);
                                }

                                //might not always exist, so we check and set 255 for sure. 
                                if(!alphaModes[i]) alphaModes[i] = 255;

                                var canvas = new Bitmap();
                                canvas.bitmapData = new BitmapData(bmp["width"], bmp["height"], true, 0);

                                //draws the image on the canvas + alpha
                                var matrix = new Matrix();
                                var transforming = new ColorTransform();
                                transforming.alphaMultiplier = (alphaModes[i]/255);
                                canvas.bitmapData.draw(bmp, matrix, transforming);

                                //redraws the image on the canvas + alpha + color
                                if(colors[i]){
                                    var coloring = new ColorTransform();
                                    coloring.color = ("0x"+colors[i]);  //defines colors token by the colors array
                                    coloring.alphaMultiplier = (alphaModes[i]/255);
                                    canvas.bitmapData.draw(bmp, matrix, coloring, BlendMode.MULTIPLY);
                                }

                                if(!zModes[i]){ //fixing zModes
                                    zModes[i] = 0;
                                }

                                //now we'll add all the data into an array(object()). later we'll build it together out of that array
                                furniParts.push({ "daI" : i,"daZ": int(zModes[i]), "daB": blendModes[i], "x" : int(asset.@x), "y" : int(asset.@y), "daC" : canvas });

                            }
                        }

                    }
                    var furniWidth = ((cordHX * 1 - cordLX*1));
                    var furniCenter = Math.abs(int(cordHX)) -  Math.abs(int(cordLX));

                    var furniHeight = ((cordLY*1 - cordHY * 1)*-1);
                    var furniYFix = (cordHYC*-1);

                    //medium 400x400
                    if(furniHeight > (200-paddingBottom) || furniWidth > (200-paddingBottom)){
                        furniBgWidth = 400;
                        furniBgHeight = 400;
                        furniBg = new Bitmap();
                        var bgDataM:bgMedium = new bgMedium(furniBgWidth, furniBgHeight);
                        furniBg.bitmapData = bgDataM;
                    }
                    //large 600x600
                    else if(furniHeight > (400-paddingBottom) || furniWidth > (400-paddingBottom)){
                        furniBgWidth = 600;
                        furniBgHeight = 600;
                        furniBg = new Bitmap();
                        var bgDataL:bgLarge = new bgLarge(furniBgWidth, furniBgHeight);
                        furniBg.bitmapData = bgDataL;

                    }
                    //default, small
                    else {
                        furniBgWidth = 200;
                        furniBgHeight = 200;
                        furniBg = new Bitmap();
                        var bgDataS:bgSmall = new bgSmall(furniBgWidth, furniBgHeight);
                        furniBg.bitmapData = bgDataS;
                    }

                    furniParts.sortOn(["daZ","daI"], [Array.NUMERIC, Array.NUMERIC]);

                    //now let's build it
                    for each(var furniPart in furniParts){
                        //draws canvas on furniBg (?+ blendmode)
                        var finalBlendMode = furniPart.daB;
                        var finalCanvas = furniPart.daC;

                        var posx = (furniBgWidth/2) - (furniCenter/2) - furniPart.x;
                        var posy = furniYFix + furniBgHeight - furniHeight - paddingBottom - furniPart.y;

                        var daMatrix = new Matrix();
                        daMatrix.translate(posx,posy);

                        if(finalBlendMode){
                            if(finalBlendMode == "ADD") furniBg.bitmapData.draw(finalCanvas, daMatrix, null, BlendMode.ADD);
                            else if(finalBlendMode == "NORMAL") furniBg.bitmapData.draw(finalCanvas, daMatrix, null, BlendMode.NORMAL);
                            else if(finalBlendMode == "OVERLAY") furniBg.bitmapData.draw(finalCanvas, daMatrix, null, BlendMode.OVERLAY);
                            else if(finalBlendMode == "ERASE") furniBg.bitmapData.draw(finalCanvas, daMatrix, null, BlendMode.ERASE);
                            else if(finalBlendMode == "ALPHA") furniBg.bitmapData.draw(finalCanvas, daMatrix, null, BlendMode.ALPHA);
                            else if(finalBlendMode == "INVERT") furniBg.bitmapData.draw(finalCanvas, daMatrix, null, BlendMode.INVERT);
                            else if(finalBlendMode == "SUBTRACT") furniBg.bitmapData.draw(finalCanvas, daMatrix, null, BlendMode.SUBTRACT);
                            else if(finalBlendMode == "DIFFERENCE") furniBg.bitmapData.draw(finalCanvas, daMatrix, null, BlendMode.DIFFERENCE);
                            else if(finalBlendMode == "LIGHTEN") furniBg.bitmapData.draw(finalCanvas, daMatrix, null, BlendMode.LIGHTEN);
                            else if(finalBlendMode == "DARKEN") furniBg.bitmapData.draw(finalCanvas, daMatrix, null, BlendMode.DARKEN);
                            else if(finalBlendMode == "SCREEN") furniBg.bitmapData.draw(finalCanvas, daMatrix, null, BlendMode.SCREEN);
                            else if(finalBlendMode == "MULTIPLY") furniBg.bitmapData.draw(finalCanvas, daMatrix, null, BlendMode.MULTIPLY);
                            else if(finalBlendMode == "LAYER") furniBg.bitmapData.draw(finalCanvas, daMatrix, null, BlendMode.LAYER);
                            else furniBg.bitmapData.draw(finalCanvas, daMatrix, null, BlendMode.NORMAL);
                        }
                        else {              
                            furniBg.bitmapData.draw(finalCanvas, daMatrix);
                        }
                    }

                    if(flip){
                        var flipMatrix = new Matrix();
                        flipMatrix.scale(-1,1);
                        flipMatrix.translate(furniBg.width,0);
                        var flipped = new Bitmap();
                        flipped.bitmapData = new BitmapData(furniBg.width, furniBg.height, true, 0);
                        flipped.bitmapData.draw(furniBg, flipMatrix);
                        furniBg = flipped;
                        //trace("dir: "+dir+" - flipped ["+furniSize+"]");
                    }

                    furniBg.x = furniBgX;
                    addChild(furniBg);
                    furniBgX = furniBgX + 200;

                    exportFurni(furniBg, dir, frame, animation, furniSize, furniName);

                    furniBg = null;

                    //trace("}\n\n");

                }
            }
        }
    }
}

function exportFurni(furni, var1, var2, var3, var4,var5){
    var finalFurni = PNGEncoder.encode(furni.bitmapData);
    var reqHeader:URLRequestHeader = new URLRequestHeader("Content-type", "application/octet-stream");
    var reqURL:URLRequest = new URLRequest("http://localhost/furniviewer_flash/export/exporter.php?name="+var5+"&v1="+var1+"&v2="+var2+"&v3="+var3+"&v4="+var4);
    reqURL.method = URLRequestMethod.POST;
    reqURL.data = finalFurni;
    reqURL.requestHeaders.push(reqHeader);
    var reqLoader = new URLLoader();
/*  reqLoader.addEventListener(Event.COMPLETE, exported);
    reqLoader.addEventListener(IOErrorEvent.IO_ERROR, notexported);
*/
    reqLoader.load(reqURL);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T13:08:59.363

听那个 IOError。您可能会从中获得更多详细信息：

```
loadFurni[loaderID].contentLoaderInfo.addEventListener(Event.COMPLETE, onLoaded);
loadFurni[loaderID].contentLoaderInfo.addEventListener(IOErrorEvent.IO_ERROR, onIoError);

function onIoError( event : IOErrorEvent ) : void {
    // trace/debug the event here...
} 
```

HTTPStatusEvent 还有助于安全和受控地处理服务器连接。

我猜你的 PHP 脚本中有什么地方出错了，是什么引发了这个错误......

# javascript - Chrome 和 IE 上的 Choppy/Laggy 滚动事件

> ID：10966710
> 
> 赞同：28
> 
> 时间：2012-06-10T06:09:09.037
> 
> 标签：javascript, jquery, google-chrome, scroll, scrolltop

我试图让内容块始终显示给用户，即使他向下滚动页面。他还应该能够上下滚动内容块。这是一个精简版本的小提琴，向您展示我的意思：

[http://jsfiddle.net/9ehfV/2/](http://jsfiddle.net/9ehfV/2/)

向下滚动时要注意，直到到达红色块的底部，它会将块固定在窗口上，向上滚动时将其放回原处。

在 Firefox 中，可以上下滚动，上面描述的固定/取消固定是不可察觉的——像丝绸一样光滑。

但是，一旦尝试在 Chrome 或 IE 中滚动，滚动事件似乎就会滞后，并且可以看到块“故障”一秒钟。这不是代码延迟——这似乎与浏览器有关。

有没有什么办法解决这一问题？我无计可施。

我很感激有关如何以不同方式实现相同效果的建议...谢谢

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-06-14T18:47:20.193

由于 JavaScript 在与 UI 相同的线程中运行，滚动事件回调可能会阻塞 UI 线程，从而导致延迟。您需要限制滚动事件侦听器，因为某些浏览器会触发很多事件侦听器。特别是如果您在 OS X 上使用模拟滚动设备。由于您在侦听器中进行了大量高度计算，[因此它会](http://www.phpied.com/rendering-repaint-reflowrelayout-restyle/)为每个触发的滚动事件触发重排（非常昂贵）。

要限制侦听器，您必须防止侦听器每次都触发。通常你会等到浏览器在 x 毫秒内没有触发事件，或者在调用你的回调之间有最短时间。尝试调整值以查看效果。即使是 0 毫秒也有帮助，因为它会延迟回调的执行，直到浏览器有时间（通常是 5-40 毫秒）。

切换类以在状态（静态和固定位置）之间切换而不是在 JavaScript 中对其进行硬编码也是一个好习惯。然后，您可以更清晰地分离关注点并[避免潜在的额外重绘错误](http://www.phpied.com/rendering-repaint-reflowrelayout-restyle/)（请参阅“浏览器很聪明”部分）。（[关于 jsfiddle 的示例](http://jsfiddle.net/b5hU8/4/)）

**等待 x 毫秒的暂停**

```
// return a throttled function
function waitForPause(ms, callback) {
    var timer;

    return function() {
        var self = this, args = arguments;
        clearTimeout(timer);
        timer = setTimeout(function() {
            callback.apply(self, args);
        }, ms);
    };
}

this.start = function() {
    // wrap around your callback
    $window.scroll( waitForPause( 30, self.worker ) );
}; 
```

**至少等待 x 毫秒**（[jsfiddle](http://jsfiddle.net/b5hU8/1/)）

```
function throttle(ms, callback) {
    var timer, lastCall=0;

    return function() {
        var now = new Date().getTime(),
            diff = now - lastCall;
        console.log(diff, now, lastCall);
        if (diff >= ms) {
            console.log("Call callback!");
            lastCall = now;
            callback.apply(this, arguments);
        }
    };
}

this.start = function() {
    // wrap around your callback
    $window.scroll(throttle(30, self.worker));
}; 
```

**jQuery Waypoints** 既然您已经在使用 jQuery，我会看看[jQuery Waypoints](http://imakewebthings.com/jquery-waypoints/)插件，它为您的问题提供了一个简单而优雅的解决方案。只需在用户滚动到某个航点时定义一个回调。

示例：（[jsfiddle](http://jsfiddle.net/vWTXW/2/)）

```
$(document).ready(function() {
    // throttling is built in, just define ms
    $.waypoints.settings.scrollThrottle = 30;

    $('#content').waypoint(function(event, direction) {
        $(this).toggleClass('sticky', direction === "down");
        event.stopPropagation();
    }, {
        offset: 'bottom-in-view' // checkpoint at bottom of #content
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T16:23:32.143

您是否尝试过一些用于滚动条的 jquery 插件或使用动画向下和向上滚动？它将强制所有浏览器以相同的方式工作（或关闭足够的）..

发生的事情是firefox（至少v12）有一个“本机”滚动动画。当您浏览任何 URL 时，您会注意到滚动操作的流畅度，这在其他浏览器（如 Chrome 或 IE）中未实现。

jquery滚动插件的例子：

*   [http://pagescroller.com/](http://pagescroller.com/)
*   [http://johnpolacek.github.com/scrollorama/](http://johnpolacek.github.com/scrollorama/)
*   [http://slodive.com/web-development/jquery-scroll/](http://slodive.com/web-development/jquery-scroll/)

# image - 如何创建当前安装的 ubuntu 的映像（在我的笔记本电脑上）？

> ID：10966712
> 
> 赞同：3
> 
> 时间：2012-06-10T06:09:15.300
> 
> 标签：image, ubuntu

**要求：**

我想做的只是*将整个 Ubuntu*（目前我正在使用）从我的笔记本电脑复制到另一台。

我的想法是*创建*我正在使用的 Ubuntu 的映像，然后用该映像安装另一台笔记本电脑。

**问题：**

任何工具或我应该采取哪些步骤？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-10T18:05:00.213

您可以使用 remastersys，但通常在您知道要对许多具有相同自定义设置的机器进行重新安装时使用。您可以在此处找到该信息：http: [//debianhelp.wordpress.com/2012/04/20/how-to-install-and-use-remastersys-in-ubuntu-os/](http://debianhelp.wordpress.com/2012/04/20/how-to-install-and-use-remastersys-in-ubuntu-os/)

如果您只想克隆一个分区并将其移动到新磁盘，您应该查看 clonezilla。[http://clonezilla.org/](http://clonezilla.org/)

如果磁盘大小完全相同并且不想使用 clonezilla，我已经成功使用了“dd”命令。[为方便起见，我还使用了一个类似http://j.mp/KVMJUe](http://j.mp/KVMJUe)的 USB 磁盘扩展坞。您需要将映像放在磁盘上（因为它太大而无法放入笔记本电脑本身），从 live cd 启动新笔记本电脑，进入命令提示符，然后将映像复制到新笔记本电脑驾驶。

作为参考，我会检查这些地方：

[http://www.debianhelp.co.uk/ddcommand.htm](http://www.debianhelp.co.uk/ddcommand.htm)

[http://www.backuphowto.info/linux-backup-hard-disk-clone-dd](http://www.backuphowto.info/linux-backup-hard-disk-clone-dd)

这是一个报价：

制作硬盘映像文件

大多数时候，您不想完全复制您的硬盘。您可能更喜欢创建硬盘的映像文件并将其保存在其他存储设备中。以下命令将在 /dev/sda 的用户目录中创建一个映像文件“disk1.img”：

```
 dd if=/dev/sda of=~/disk1.img 
```

由于您已经创建了一个图像文件，您可以使用“gzip”或“bzip2”对其进行压缩：

```
 gzip disk1.img #generates disk1.img.gz or

    bzip2 disk1.img #generates disk1.img.bz2 
```

您可以通过压缩节省大量存储空间。但这需要很长时间。

从图像文件恢复

要从映像文件恢复分区或硬盘，只需交换参数“if”和“of”。例如，从镜像文件“disk1.img”恢复整个硬盘：

```
 dd if=disk1.img of=/dev/sda 
```

从镜像文件“disk2.img”恢复/dev/sda的第一个分区：

```
 dd if=disk2.img of=/dev/sda1 
```

# c++ - 通过类附加到父函数？

> ID：10966714
> 
> 赞同：0
> 
> 时间：2012-06-10T06:09:44.870
> 
> 标签：c++, class

在我的项目中，我有一个父类 CWnd，它是链下类的基本 win32 窗口。然后我使用模板声明创建这个类的实例，这样我就可以拥有许多不同类型的窗口。

然后我像这样添加成员：

```
void CChildWndClass::OnSize(HWND hWnd, UINT state, int nWidth, int nHeight)
{
    // do something
} 
```

问题是这些成员是虚拟的。在某些事件（即：OnDestroy）中，我想在每个窗口类中执行一些代码，而不必将粘贴复制到每个子类中，因为它会覆盖父级原始代码。

如何让子类中的函数将它们的代码附加到它们自己，而不是覆盖？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T06:20:00.187

子类化为具有您想要的功能的类，然后从您自己的类中子类化以获得类似的子类。

你不想实现的方法，干脆不要，它们在子子类中仍然是虚拟的。

在这些情况下，人们还使用制作库。

# c# - 使用 Ninject 自动装配

> ID：10966716
> 
> 赞同：4
> 
> 时间：2012-06-10T06:10:04.850
> 
> 标签：c#, dependency-injection, ninject

我有一个最近开始使用 Ninject 的 WinForms 应用程序。Ninject 的大多数教程都显示了自动装配的设置，如下所示：

```
using (IKernel kernel = new StandardKernel())
{
     kernel.Bind<ITaxCalculator>()
        .To<TaxCalculator>()
        .WithConstructorArgument("rate", .2M);

     var tc = kernel.Get<ITaxCalculator>();
     Assert.Equal(20M, tc.CalculateTax(100M));
} 
```

如果您打算在启动时为一个简短的脚本实现该类，那就太好了，但我不确定如何在应用程序的其他类和库中使用这些对象。我很好奇 Ninject 是否可以处理类似于[本文](http://www.vogella.com/articles/SpringDependencyInjection/article.html)中的 Spring 的依赖项。

```
package testbean;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import writer.IWriter;

@Service
public class MySpringBeanWithDependency {
    private IWriter writer;

    @Autowired
    public void setWriter(IWriter writer) {
        this.writer = writer;
    }

    public void run() {
        String s = "This is my test";
        writer.writer(s);
    }
} 
```

然后，您可以在 XML 中指定要注入 IWriter 的实例。然后运行代码，这就是所有需要的：

```
package main;

import org.springframework.beans.factory.BeanFactory;
import org.springframework.context.ApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;

import testbean.MySpringBeanWithDependency;

public class Main {
    public static void main(String[] args) {
        ApplicationContext context = new ClassPathXmlApplicationContext("META-    INF/beans.xml");
        BeanFactory factory = context;
        MySpringBeanWithDependency test = (MySpringBeanWithDependency) factory
                .getBean("mySpringBeanWithDependency");
        test.run();
    }
} 
```

使用 Spring，它可以自动创建和注入 IWriter 依赖项，因此您不必担心如何将其获取到应用程序的其余部分。使用当前的 Ninject 教程，我一直无法找到一种方法来做到这一点，而是求助于将对象存储到另一个对象中，然后调用它，这不是最好的方法。

我一直在寻找一种使用 Ninject 自动装配依赖关系的方法，但还没有找到这个特定问题的答案。任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-10T10:12:17.063

首选方法是进行构造函数注入

```
public class MySpringBeanWithDependency {
    private IWriter writer;

    public MySpringBeanWithDependency(IWriter writer) {
        this.writer = writer;
    }

    public void run() {
        String s = "This is my test";
        writer.writer(s);
    }
}

Kernel.Bind<IWriter>().To<SomeWriter>();
Kernel.Get<MySpringBeanWithDependency>(); 
```

而不是像上面那样的一一绑定，您应该使用约定来指定您的绑定[https://github.com/ninject/ninject.extensions.conventions/wiki/What-is-configuration-by-convention](https://github.com/ninject/ninject.extensions.conventions/wiki/What-is-configuration-by-convention)

而且您应该从更大的角度进行思考，并在应用程序启动时一次获得尽可能多的信息。

# javascript - 使用音频元素的播放方法作为 setTimeout 的回调，为什么不呢？

> ID：10966718
> 
> 赞同：3
> 
> 时间：2012-06-10T06:10:13.080
> 
> 标签：javascript, settimeout, html5-audio

我有一个`audio`标签的引用，`play`我可以像这样调用它的方法：

```
voice["blessed be"].play() 
```

如果我尝试这样称呼它：

```
setTimeout(voice["blessed be"].play, 1000) 
```

我得到：

```
Uncaught TypeError: Illegal invocation 
```

我不一定会`setTimeout`在最终实现中使用；但是，为什么这不起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T06:13:34.173

这是因为如何`setTimeout`调用它的回调。它调用上下文设置为的回调函数`window`。

所以，它在调用`voice["blessed be"].play.call(window)`. ~~这就像 call 一样`window.play`，不起作用。~~ 您正在使用 audo 元素的播放功能，并强制它在`window`对象上运行。 `window`不是 audo 元素，因此您会收到错误消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-29T06:14:57.553

你需要使用一些类似的东西

```
var sound = voice[ 'blessed be' ];
setTimeout( sound.play.bind( sound ), 1000 ); 
```

# android - 这些应用程序中的动画是如何完成的？

> ID：10966722
> 
> 赞同：1
> 
> 时间：2012-06-10T06:11:26.200
> 
> 标签：android

大多数 Android 用户使用[GO SMS](http://www.talkandroid.com/23387-go-sms-for-android-is-a-clean-alternative-sms-app/)应用程序，而 iPhone 用户使用他们的普通消息应用程序（Android Rocks）。现在，每当用户键入消息并按下发送按钮时，消息的编辑文本字段都会设置一个有光泽的绿色背景，并且绿色背景也会浮动在编辑文本字段的后面。他们是怎么做到的呢？

（我已经搜索了一段时间，但无法找到答案。）

# c++ - 递归函数中的Cin

> ID：10966734
> 
> 赞同：0
> 
> 时间：2012-06-10T06:15:54.963
> 
> 标签：c++, iostream

为什么这个东西一直循环？.. 我尝试清除 cin 流，但如果我输入的不是数字，它仍然会循环。

```
void AskQuestion()
{
    DisplayQuestion();
    bool Exit = false;
    int input = 0;
    cout<<"Input : ";
    if(!(cin>>input))
    {
        cout<<"Invalid Input"<<endl;
        cin.ignore(10000,'\n');
        cin.clear();
    }
    else
    {
        Exit = ProcessInput(input);
    }
    if(!Exit) AskQuestion();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T06:28:40.323

首先，不要使用递归：将其设为`while`.

其次，使用同步：

```
int number;
while (true) {
    if (cin >> number)
        break;
    cout << "Invalid number.\n";
    cin.sync();
    cin.clear();
}
cout << "Number: " << number; 
```

# objective-c - Issue with Core Data and fetchedResultsController

> ID：10966740
> 
> 赞同：1
> 
> 时间：2012-06-10T06:17:04.493
> 
> 标签：objective-c, nsfetchedresultscontroller

I have the following setup:

UITableViewController that uses self.fetchedResultsController to fetch entities sorted by a number attribute, which starts at 1 & so on.

A UIButton is used to create a new entity. New entities are inserted at the beginning of the list, and the existed entities are shifted down.

the UITableViewController handles adding one entity just fine. But after I add another, I get the following error:

```
CoreData: error: Serious application error.Exception was caught during Core Data change processing.  This is usually a bug within an observer of NSManagedObjectContextObjectsDidChangeNotification.  -[__NSCFNumber localizedCaseInsensitiveCompare:]: unrecognized selector sent to instance 0x6d275b0 with userInfo (null) 
```

My code for adding the entities is fine, I can see it work ok. The fetchedResultsController delegate methods are in my superclass and work fine in other subclasses.

I'm going crazy, can anyone guess whats going on?

The only thing I can think of is that it is trying to sort the entities using an integer. Can that be it?

# class - 如何在python3.2中实例化未知数量的实例

> ID：10966741
> 
> 赞同：1
> 
> 时间：2012-06-10T06:17:15.477
> 
> 标签：class, instantiation, instances, python-3.2

我一直在使用 python 3.2 开发纸牌游戏，但不确定如何实例化单独的玩家。游戏可以有 2 到 8 名玩家。我在想我可以使用蛮力并有类似的东西：

```
 players = int(input('how many players?: ))
   if players ==2:
       p1 = Player()
       p2 = Player()
   elif players ==3:
       p1 = Player()
       p2 = Player()
       p3 = Player()
   elif players ==4:
       p1 = Player()
       p2 = Player()
       p3 = Player()
       p4 = Player() 
```

ETC...

看起来很脏。有没有更清洁的方法来解决这个问题？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T06:39:48.700

使用列表和 for 循环：

```
players = int (input ('how many players?: '))
if not 2 <= players <= 8:
  <raise an exception or something>

p = []
for _ in range (players):
  p.append (Player()) 
```

现在你有一个玩家列表，你可以随心所欲。

# c++ - C++ Mini-program to print out randomized data pairs

> ID：10966742
> 
> 赞同：0
> 
> 时间：2012-06-10T06:17:31.690
> 
> 标签：c++

I basically, for this assignment, have to make a mini-program that randomly generates a string of letters based on randomized numbers (for which 0 corresponds to A, 1 corresponds to B, 2 corresponds to C, and so on) alongside with a number n corresponding to the nth string generated. These strings and their corresponding numbering are to be printed out to a text file. For example, if my function was called `myFunction`:

```
myFunction("file.txt", 3) 
```

Produces a text file called "file.txt" with the following contents:

```
AAAAAAAA 1
IWFNWEFS 2
WEWEFCSD 3 
```

Where the strings' letters are each supposed to be randomized.

However, for some reason each of my strings are identical for some reason. That is, for each row of string-number pairs, all the strings turn out to be the same (when I am supposed to make them all different/random). Why is this happening? Here is my code:

```
#include <iostream>
#include <vector>
#include <cstdlib>
#include "math.h"
#include <fstream>
using namespace std;

string key = ""; // Empty initial key for use in "makeKey".

// "makeKey" function to create an alphabetical key 
// based on 8 randomized numbers 0 - 25.
void makeKey() {
    int k;
    for (k = 0; k < 8; k++) {
        int keyNumber = (rand() % 25);
        if (keyNumber == 0)
            key.append("A");
        if (keyNumber == 1)
            key.append("B");
        if (keyNumber == 2)
            key.append("C");
        if (keyNumber == 3)
            key.append("D");
        if (keyNumber == 4)
            key.append("E");
        if (keyNumber == 5)
            key.append("F");
        if (keyNumber == 6)
            key.append("G");
        if (keyNumber == 7)
            key.append("H");
        if (keyNumber == 8)
            key.append("I");
        if (keyNumber == 9)
            key.append("J");
        if (keyNumber == 10)
            key.append("K");
        if (keyNumber == 11)
            key.append("L");
        if (keyNumber == 12)
            key.append("M");
        if (keyNumber == 13)
            key.append("N");
        if (keyNumber == 14)
            key.append("O");
        if (keyNumber == 15)
            key.append("P");
        if (keyNumber == 16)
            key.append("Q");
        if (keyNumber == 17)
            key.append("R");
        if (keyNumber == 18)
            key.append("S");
        if (keyNumber == 19)
            key.append("T");
        if (keyNumber == 20)
            key.append("U");
        if (keyNumber == 21)
            key.append("V");
        if (keyNumber == 22)
            key.append("W");
        if (keyNumber == 23)
            key.append("X");
        if (keyNumber == 24)
            key.append("Y");
        if (keyNumber == 25)
            key.append("Z");
    }
    return;
}

// "makeFile" function to produce the desired text file.
// Note this only works as intended if you include the ".txt" extension,
// and that a file of the same name doesn't already exist.
void makeFile(string fileName, int n) {
    ofstream ourFile;
    ourFile.open(fileName);
    int k; // For use in below loop to compare with n.
    int l; // For use in the loop inside the below loop.
    for (k = 1; k <= n; k++) {
        for (l = 0; l < 8; l++) {  // To write to the file ONE key
        ourFile << key[l];         // C++ only lets me do it this way...
        }
        ourFile << "  " << k << "\n"; // Writes two spaces and the data value
    }
}

// Primary function to create our desired file!
void mainFunction(string fileName, int n) {
    makeKey();
    makeFile(fileName, n);
}

int main() {
    mainFunction("file.txt", 3); // To test program
    cin.get();
    return 0;
} 
```

I tried using both `srand ( time(NULL) );` and `srand (1);` in the first part, but that didn't work for me either.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T06:26:49.857

每次调用`makeKey`，它会在 末尾追加 8 个字符`key`，但不会清除之前的内容，调用 后`makeKey`会打印出前 8 个字符，这些字符没有变化。

我会摆脱全局变量`key`，并在每次调用时都`makeKey`返回一个（新创建的） 。`std::string`

FWIW，我还会重写`makeKey`以通过索引到字符数组来将数字转换为字母。

编辑（针对问题中的编辑）：是的，您可能还想`srand(time(NULL));`在程序开始时使用。`srand(1);`就好像你根本不打电话一样`srand`。每次运行程序时，使用`srand(time(NULL));`通常应该给出不同的结果序列（除非你运行它两次的速度如此之快以至于系统时钟不会在两者之间改变——通常在同一秒内两次）。

现在你得到一个字符串重复 8 次。解决上面提到的问题会给你 8 个不同的字符串——但是如果没有类似的东西`srand(time(NULL));`，你每次运行程序都会得到相同的 8 个字符串组。如果你只是添加`srand(time(NULL));`而不修复其余部分，你会得到一个字符串 8 次，但每次运行程序都会是一个不同的字符串（而现在，即使你得到的一个字符串也是一样的每次运行程序时一样）。

# actionscript-3 - Finding the point where a line crosses a nonlinear path

> ID：10966743
> 
> 赞同：2
> 
> 时间：2012-06-10T06:17:41.313
> 
> 标签：actionscript-3, geometry, collision-detection, trigonometry, intersection

Diagram: [http://i.stack.imgur.com/gpL0P.png](http://i.stack.imgur.com/gpL0P.png)

Summary: How do I find the coordinates of the blue point in the diagram so I can calculate the positions of the red points adjacent to it and draw my triangle?

Details of problem: I am trying to make a tail on a drag-able tool-tip balloon for a map application I am making. I would like the the tail to be drawn from the location where the balloon is placed (point 0,0 of the sprite containing both balloon and tail) to the edge of the balloon, with the base of the tail always being the same arbitrary width width it connects to the balloon. The tail would be redrawn at the new coordinates every frame.

I would prefer not to hide part of the tail underneath the balloon, as I intend to use some transparency on it.

If the path were a circle or ellipse, I could use the angleToProgress method (along with some trig) of the CirclePath2D class of greensock's motion path library I could place a hidden path follower and get it's xy... However I am using a roundedRectangle... So I was thinking a better method would be some kind of collision detection between a line and wherever it crosses a path drawn around the perimeter of the balloon. However, I can't find any collision functions that return the xy of the collision.

So I'm stumped. I'm thinking what I want to do may not be easily doable in AS3 using the built in collision methods. Is there a collision library that will let me do this, or, perhaps preferably, some math that is eluding me? Because this seems like I'm over thinking it and it shouldn't be this hard.

[Note: I can't insert the diagram because I don't have enough reputation.]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T06:33:50.743

如果蓝色的交点在圆角之一上，你会怎么做？除此之外，它应该很容易弄清楚 - 您可以进行简单的线几何和键检查，以查看线与构成框边界的四条无限线相交的位置，然后确定哪个实际上是勾股算式的第一个交点线长。

如果您使用此方法，则需要检查放置相对于气球边缘的位置，以跳过计算明显错误（有时不存在）的交叉点（例如，如果气球中心直接位于放置的西边点，那么你应该跳过计算垂直线的交点）。事实上，您可以使用类似的逻辑来跳过 2 或 3 条边，具体取决于几何形状。

# javascript - link that moves you to div on same page that doesn't have ID (only class, and data-full)

> ID：10966747
> 
> 赞同：0
> 
> 时间：2012-06-10T06:18:17.297
> 
> 标签：javascript, jquery, html

just as title reads. multiple "posts" that have a class that has a unique name, also a data-fullname that is unique as well. I know how to do this with IDs but don't know if you can otherwise.

sorry if this isn't specific enough. here's a fiddle that demonstrates the ID method: [http://jsfiddle.net/avYBz/](http://jsfiddle.net/avYBz/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T06:32:16.777

我只是将类放在 href 中。您可以通过多种方式执行此操作，但超链接至少需要一个属性，该属性具有您要滚动到的元素的类。

演示：http: [//jsfiddle.net/lucuma/jK5T3/1/](http://jsfiddle.net/lucuma/jK5T3/1/)

```
<a href=".uniqueID"   >Go to post</a>

<div style="height:1300px"></div> 

<div class="uniqueID" id="1234">This is the post </div>​

$('a').click(function(e) {
    e.preventDefault();

    var scrollto = $(this).attr('href');
    $('html, body').animate({
            scrollTop: $(scrollto).offset().top
        }, 1500);
});

​ 
```

我不是 100% 确定 href 可以以句点开头（关于在代码工作时有效），因此可以替代：

```
<a href="#" data-link="uniqueID"   >Go to post</a>
<div style="height:1300px"></div> 
<div class="uniqueID" id="1234">This is the post </div>​

$('a[data-link]').click(function(e) {
    e.preventDefault();

    var scrollto = '.' + $(this).attr('data-link');
    $('html, body').animate({
            scrollTop: $(scrollto).offset().top
        }, 1500);
}); 
```

最后，您可以在每个 div 中附加一个锚点，然后在 href 中使用它，就像普通的本地散列链接一样。由于所有这些解决方案都需要 javascript，我不确定您使用哪个真的很重要，但此解决方案将 href 设置为我们在加载时添加到页面的有效本地锚点。您可以在这部分删除点击事件，它仍然可以工作，但页面会跳转而不是很好地滚动。

演示：http: [//jsfiddle.net/lucuma/jK5T3/3/](http://jsfiddle.net/lucuma/jK5T3/3/)

```
$('#container div').each(function() {
   $(this).append('<a id="' + $(this).attr('class') + '" />');
});

$('a').click(function(e) {
    e.preventDefault();

    var scrollto = $(this).attr('href');
    $('html, body').animate({
            scrollTop: $(scrollto).offset().top
        }, 1500);
}); 
```

​</p>

# macos - Is there any way to know if another application changed the display resolution in Cocoa?

> ID：10966751
> 
> 赞同：5
> 
> 时间：2012-06-10T06:19:00.667
> 
> 标签：macos, cocoa, notifications, resolution

I need to monitor for any screen resolution changes in my app, coming with my app in front or not.

I searched a lot on the internet yesterday and tried all these options:

```
applicationDidChangeScreenParameters;
CGDisplayRegisterReconfigurationCallback;
NSApplicationDidChangeScreenParametersNotification; 
```

I get notifications when I change the resolution manually or plug/unplug a new display.

But I do not get notifications when other applications changes the screen parameters (most games made before 2011).

**Is there any way to know if *Any* mac application changes the screen resolution? Even if my app is in the background?** Any notification? Hopefully without Accessibility API...?

Thank you very much

* * *

EDIT (June 9)

This answer [Events when dock is showing or hiding](https://stackoverflow.com/questions/6135265/events-when-dock-is-showing-or-hiding) helped me a little bit. Since I get the notification when another app enters/exits fullscreen, but not when it changes the resolution without changing the fullscreen state =/ And it relies on Carbon APIs which are deprecated on 10.8...

It is not exactly what I want but works for most cases... Is there any other way to achieve on cocoa? Any global notification for this?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T20:55:36.347

你可能已经看过这个页面：

[https://developer.apple.com/library/mac/#documentation/GraphicsImaging/Conceptual/QuartzDisplayServicesConceptual/Articles/Notification.html%23//apple_ref/doc/uid/TP40004235-SW1](https://developer.apple.com/library/mac/#documentation/GraphicsImaging/Conceptual/QuartzDisplayServicesConceptual/Articles/Notification.html%23//apple_ref/doc/uid/TP40004235-SW1)

此外，您似乎需要考虑来自其他应用程序的通知，因此使用`NSDistributedNotificationCenter`而不仅仅是`NSNotificationCenter`.

# css - 不扩展父元素高度的元素

> ID：10966752
> 
> 赞同：1
> 
> 时间：2012-06-10T06:19:00.827
> 
> 标签：css, html, containers, parent-child

我有一个容器，我在其中放置了一堆元素，我的期望是容器会随着容器填充元素而向下扩展。不幸的是，这种情况并非如此。我有一些 div 漂浮在我的容器边缘。我可以用一堆中断标签来解决这个问题，但这是一个草率的解决方案。

也许我的 CSS 不正确，但我不知道在哪里。长选择列表和主要描述**应**位于上方的白框中。

这是一个[小提琴](http://jsfiddle.net/T2fG2/)。

编辑：Uwe 带领我研究花车。我发现在正常流程布局中不考虑浮动。那么这是如何解决的呢？

编辑 2：我找到了一个 clearfix 解决方案。

```
.clearfix:after {
    content: ".";
    display: block;
    height: 0;
    clear: both;
    visibility: hidden;
}
.clearfix {
    display: inline-block;
}
* html .clearfix {
    height: 1%;
} /* Hides from IE-mac \*/
    .clearfix {
        display: block;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T09:59:01.253

清除浮动的方法有很多；只需附加`overflow: hidden;`到即可`.main`解决您的问题。

但在实践中，最好直接清除导致问题的浮动，而不是对父 div 进行修复。我实际上建议将以下属性附加到 .bottom 中：

```
.bottom {
    clear: both;
    overflow: hidden;
} 
```

*   `clear: both`负责清除`.content`.
*   `overflow: hidden`负责清除浮动`.bottom`

[`id`](http://reference.sitepoint.com/html/core-attributes/id)除了`class`HTML 标签的属性之外，您还应该考虑使用该属性。

# ios - 在 iOS 中创建多步注册

> ID：10966753
> 
> 赞同：7
> 
> 时间：2012-06-10T06:19:18.083
> 
> 标签：ios, forms, uiscrollview, registration, pagecontrol

如何在 iOS 中创建多步骤注册表单。哪个是最好的方法？

总共有大约5个步骤。两个刚刚同意和不同意按钮。其他的都有prev和next，最后提交。

1）为每个步骤创建单独的控制器？或者 2) 一个带有滚动视图和页面控制的控制器，让它看起来像多个步骤？

第二个是更简单的，但找不到任何教程或代码开始，喜欢在滚动视图内的每个视图中添加下一个上一个按钮，其中包含不同的步骤操作、验证和许多东西。想想那将是真正混乱的代码。

google了很多，但找不到这个想法的任何链接..

欢迎任何链接和代码..

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T06:31:15.850

首先，从用户体验的角度来看，我会尝试减少注册步骤的数量。在移动设备上，注册应该简短而轻松。删去所有非绝对必要的步骤，并捕获最低限度的数据以让用户开始。

对于您同意/不同意的步骤，我会调查修改 EULA 是否可以帮助您删除这些步骤。或者，您可能已经使用 Apple 的标准 EULA。

如果您是 iOS 编程新手，如果您在去除不必要的数据注册字段后仍需要多步骤流程，我的建议是 #1。使用单独的视图控制器，您可以利用故事板，更轻松地在每个步骤验证数据，并使您能够相当快速地添加、删除和/或重新排序注册步骤。

# ruby-on-rails - 如何在 Mongo Mapper 中实现全文搜索？

> ID：10966759
> 
> 赞同：0
> 
> 时间：2012-06-10T06:20:51.687
> 
> 标签：ruby-on-rails, full-text-search, mongomapper

我需要在 mongomapper 模型中实现全文搜索。我已经尝试过 mongomapper_search gem，但它对我不起作用。我没有得到任何结果。是否有任何其他 gem 可用于此类功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T12:40:08.463

猜测一下——但是当您第一次安装全文引擎时，您需要创建索引。我查看了[mongomapper_search 代码](https://github.com/mariopeixoto/mongomapper_search/blob/master/lib/mongomapper_search/search.rb)，看到了以下命令（比如产品）

```
Product.index_keywords! 
```

尝试在您的模型上运行它，然后执行搜索。

# heroku - 同一个heroku帐户上的两个应用程序是否可以访问同一个RedisToGo服务器？

> ID：10966765
> 
> 赞同：5
> 
> 时间：2012-06-10T06:21:50.480
> 
> 标签：heroku, redistogo

同一个heroku帐户上的两个应用程序可以访问同一个RedisToGo服务器吗？我们有两个应用程序都需要网络访问，但结构却大不相同。所以它们不能是同一个应用程序中的测功机类型——但如果一个人可以通过 Redis 排队作业让另一个人去做，那就太好了。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-10T20:08:53.557

是的，只需`heroku config`在包含 redistogo 的应用程序上使用并查找 REDISTOGO_URL 配置变量，然后复制该值，然后在第二个应用程序中创建一个 heroku 配置变量，设置相同的值

`heroku config:add REDISTOGO_URL=<value_from_app_a>`

# eclipse - 未为 Eclipse 上的模式生成 JAXB 类

> ID：10966766
> 
> 赞同：2
> 
> 时间：2012-06-10T06:21:55.150
> 
> 标签：eclipse, jaxb

我是 JAXB 的新手，无法让它在 Eclipse 上运行。我下载了eclipse的jaxb插件。我现在得到一个新的 JAXB 项目向导，但是当我右键单击一个 xsd 或 xml 文件时，没有“生成 jaxb 类”选项。当我在实例文件夹中添加一个 xml 文件时，Castor 会自动运行并生成类。但是当我在模式文件夹中添加一个 xsd 文件时，Castor 再次运行，我收到一条“已完成”消息，但在 jaxb 文件夹中没有创建任何类。我哪里会出错？

我尝试在 Eclipse Europa 和 Indigo 上获得相同的结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T14:41:13.473

我得到了解决方案。我将 Eclipse 用于 Java EE。现在我得到了 Generate JAXB Classes 选项，它可以工作了！

# .htaccess - 通过 .htaccess 更改 URL

> ID：10966769
> 
> 赞同：0
> 
> 时间：2012-06-10T06:23:19.857
> 
> 标签：.htaccess

我有这种类型的页面：-

```
xyz.com?q=Apple+Ipod+touch 
```

我希望将其转换为类型

```
xyz.com/Apple+Ipod+touch 
```

如何才能做到这一点 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T06:37:08.167

尝试：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ /index.php?q=$1 [L,QSA] 
```

如果您有更具体的 URL 格式，您可以将其细化`RewriteRule`为不那么通用（即不匹配所有内容）并且更具体到您的 URL，但这应该有效。

# ios - 如何使用 Open CV 检测打哈欠

> ID：10966772
> 
> 赞同：10
> 
> 时间：2012-06-10T06:24:30.690
> 
> 标签：ios, opencv, haar-wavelet

我正在开发一个需要检测用户何时打哈欠的 iOS 应用程序。

我所做的是包括 Open CV 并使用 haar 级联查找面孔，然后在面孔内找到嘴巴（也使用 haarcascade）。

我遇到的麻烦是，我相信像 (face.y - mouth.y) < something = 打哈欠这样的事情很容易检测到打哈欠。

但是我遇到的问题是面部和嘴巴的矩形是“不稳定的”，我的意思是每次循环运行面部和嘴巴的矩形的 X 和 Y 值（显然）不一样。

有没有我可以使用的“张开嘴”haar 级联，或者我怎么知道用户何时张开嘴？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-10T12:00:03.990

一般来说，支持向量机 (SVM) 用于面部表情识别，如愤怒、微笑、惊讶等仍在积极发展的地方。谷歌搜索给你很多关于这个主题的论文，（甚至我的一个同学也做了这个作为他最后一年的项目）。为此，首先您需要训练 SVM，为此，您需要打哈欠和正常人脸的样本图像。

打哈欠几乎与惊讶相似，在这两种情况下都张开嘴。我建议您查看以下论文的第 3 页：[Real Time Facial Expression Recognition in Video using Support Vector Machines](https://docs.google.com/viewer?a=v&q=cache:RfIgzqPKJwMJ:klucv2.googlecode.com/svn/trunk/docs/Real%2520Time%2520Facial%2520Expression%2520Recognition%2520in%2520Video%2520using%2520Support%2520Vector%2520Machines.pdf%20&hl=en&gl=in&pid=bl&srcid=ADGEESivtMBqO8oomReO4ng1dASxzpKxFak3KfYYEOsWLE68ac7x1P-C2eS3ch27OZxtxtltwgPTSOgxiYsH_Jx9K7xpMdWiFH-j99-r68bJRE4HYvWwXQOVfOTxoznPrpIUmGi5jNqf&sig=AHIEtbTEEEb0O0BPnsujK82di9rjZuUxFA)（如果您无法访问链接，请按论文名称谷歌）

论文（甚至我的同学）使用**了面部特征的位移向量**。为此，您会在脸上找到一些特征点。例如，在论文中，他们使用了**眼睛瞳孔、眼睑的极值点、鼻尖、嘴部区域（嘴唇）的极值点**等。然后他们不断跟踪特征的位置并找到它们之间的欧几里得距离。它们用于训练 SVM。

查看以下两篇论文：

[从人脸中提取特征点](https://docs.google.com/viewer?a=v&q=cache:SWD_ErOjZxQJ:startrinity.com/videorecognition/Resources/FacialFeaturePointsDetection/feature%2520points%2520extraction%2520from%2520faces.pdf%20&hl=en&gl=in&pid=bl&srcid=ADGEESh5-n4OQ9yxEhQuizwz5q4ScewZVWZElWJYpQldS1g5DlgEsIw7JKt4kotfW0MTNvM2tx8MCxL7ER4sZnmmET_aob50zOw3GZ65kKVUMLGwo1WMP2IH2DEe-JP_Ob1vo2LMnQW-&sig=AHIEtbROGc7HX-ksLQj6S2q_lqAikMuzCA)

[使用基于 Gabor 特征的增强分类器的全自动面部特征点检测](https://docs.google.com/viewer?a=v&q=cache:mDUsa-YnbBYJ:www.inf.unideb.hu/~sajolevente/papers2/facialfeature/VukadinovicPantic-SMC05-Fully%2520Automatic%2520Facial%2520Feature%2520Point%2520Detection%2520Using%2520Gabor%2520%282005%29.pdf%20&hl=en&gl=in&pid=bl&srcid=ADGEESjZENnOObksjlxLjuQ77hLXtky_w5EPtt02y1onepREvorDQVWLwR6fYym0FZMZ68242B3Bwn4b2GDWY-YJgUgsK3kLDjjur4SSqDGqFIDhrM8kgIHbmTkRzP-lAYDFv4qLgeQG&sig=AHIEtbRUiR42MslGvl1zrGqmFd4eFj09ew)

看下面我所说的面部特征点的图像：

![在此处输入图像描述](../Images/eb9427e20dd1afca35c7ccacf4145be7.png)

**就您而言**，我认为您正在 iPhone 中实时实现它。所以可能你可以避免眼睛的特征点（虽然不是一个好主意，因为当你打哈欠时，眼睛会变小）。但与之相比，嘴唇的特征点表现出更多的变化和优势。因此，仅在唇上实施可能会节省时间。（嗯，这一切都取决于你）。

**唇部分割**：已经在 SOF 中讨论过并查看这个问题：[OpenCV 唇部分割](https://stackoverflow.com/questions/8840127/opencv-lip-segmentation)

最后，我相信你可以找到很多关于谷歌搜索的细节，因为它是一个活跃的发展领域，而且有很多论文。

**另一种选择**：

这个地区的另一个选择，我听过好几次了，是`Active Appearance Model`。但我对此一无所知。自己谷歌一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T07:01:36.780

OpenCV 还具有人脸识别/检测功能（请参阅 openCV SDK 附带的示例）。我认为这些会是一个更好看的地方，因为 haar cascade 并没有真正按照你需要的方式分析面部表情。尝试运行示例并亲自查看 - 您将获得有关检测到的眼睛/嘴巴等的实时数据。

祝你好运

# php - Vqmod 仅在搜索不存在时进行更改

> ID：10966773
> 
> 赞同：0
> 
> 时间：2012-06-10T06:24:41.510
> 
> 标签：php, opencart

在 vQmod 中可以检查类中是否存在方法。只有当它不存在时，它才会做出改变。

例如，目前我有一个简单的 vqmod，它导致另一个扩展出现问题，该扩展也在进行相同的更改并导致重复方法错误。

```
<file name="catalog/model/tool/image.php">
    <operation>
        <search position="after"><![CDATA[
            class ModelToolImage extends Model {
        ]]></search>
        <add><![CDATA[
            public function get($filename) {
                if (!file_exists(DIR_IMAGE . $filename) || !is_file(DIR_IMAGE . $filename)) {
                    return;
                } 

                if (isset($this->request->server['HTTPS']) && (($this->request->server['HTTPS'] == 'on') || ($this->request->server['HTTPS'] == '1'))) {
                    return HTTPS_IMAGE . $filename;
                } else {
                    return HTTP_IMAGE . $filename;
                }   
            }
        ]]></add>
    </operation>
</file> 
```

还有什么方法可以让一个 vqmod 优先于另一个。我之前需要 2 个 vqmod 文件来获得 vqmod 的代码吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T11:37:48.323

只有在方法不存在的情况下才能添加 no。诀窍是“劫持”原始文件或重命名它。至于优先级，它们会从 a 到 z 进行解析，因此如果您想先应用它，请将其命名为按字母顺序排列在另一个之前的名称，或者只是在名称前加上 aaa

# java - 读写JSON文件Java

> ID：10966776
> 
> 赞同：2
> 
> 时间：2012-06-10T06:24:57.100
> 
> 标签：java, json

我正在尝试将 JSON 文件读入数据结构，以便可以计算一堆元素。

JSON 文件的格式为`[{String, String, [], String } ... ]`. 现在在这个对象数组中，我需要找到第一个字符串字段（比如说关联）与数组字段（成员名称）的关系。我需要弄清楚每个成员所属的协会有多少。

我目前正在使用 json-simple，这就是我的做法。

```
Object obj = parser.parse(new FileReader("c://Users/James McNulty/Documents/School/CMPT 470/Ex 4/exer4-courses.json"));

        JSONArray jsonArray = (JSONArray) obj;

        ArrayList<JSONObject> courseInfo = new ArrayList<JSONObject>();
        Iterator<JSONObject> jsonIterator = jsonArray.iterator();

        while (jsonIterator.hasNext()) {
            courseInfo.add(jsonIterator.next());
            count++;
            //System.out.println(jsonIterator.next());
        }
        //System.out.println(count);

        String course = "";
        String student = "";
        ArrayList<JSONArray> studentsPerCourse = new ArrayList<JSONArray>();
        for (int i=0; i<count; i++) {
            course = (String) courseInfo.get(i).get("course");
            studentsPerCourse.add((JSONArray) courseInfo.get(i).get("students"));
            System.out.println(course);
            System.out.println(studentsPerCourse.get(i));
        }

        ArrayList<String> students = new ArrayList<String>();
        for (int i=0; i<count; i++) {
            for (int j=0; j< (studentsPerCourse.get(i).size()); j++) {
                students.add((String) studentsPerCourse.get(i).get(j));
                //System.out.println(studentsPerCourse.get(i).get(j));
            }
            //System.out.println(student);
        }

        JSONObject object = new JSONObject();
        Map<String, Integer> studentCourses = new HashMap<String, Integer>();
        Set<String> unique = new HashSet<String>(students);
        for (String key : unique) {
            studentCourses.put(key, Collections.frequency(students, key));
            object.put(key, Collections.frequency(students, key));
            //System.out.println(key + ": " + Collections.frequency(students, key));   
        }

        FileWriter file = new FileWriter("c://Users/James McNulty/Documents/School/CMPT 470/Ex 4/output.json");
        file.write(object.toJSONString());
        file.flush();
        file.close();

        System.out.print(object); 
```

想知道 simple-json 本身是否有更简单的方法，或者是否有其他更好的库。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T06:34:52.147

[谷歌 gson](http://code.google.com/p/google-gson/)用于编码和解码都非常简单。

最简单的方法是通过简单地让引擎使用反射填充字段以将它们映射到文件的内容来填充对象，如此处[所述](https://sites.google.com/site/gson/gson-user-guide#TOC-Object-Examples)：反序列化只是对`gson.fromJson(json, MyClass.class);`创建类的调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T06:35:57.623

似乎您正在尝试在 Java 中做他们所谓的集合。首先我会看看你的 json 模型。构建一个包含您上面列出的属性的类。然后代码将如下所示。

```
 public void parseJson(){
      // Read your data into memory via String builder or however you choose. 
     List<modelthatyoubuilt> myList = new ArrayList<modelthatyoubuilt>();
     JSONArray myAwarry = new JSONArray(dataString);
     for(int i = 0; i < myAwarry.size(); i++){
     JSONObject j = myAwarry.get(i); 
     modelthatyoubuilt temp = new modelthatyoubuilt();
     temp.setProperty(j.getString("propertyname");
     //do that for the rest of the properties
     myList.add(temp); 

 }

 public int countObjects(ArrayList<modelthatyoubuilt> s){
      return s.size(); 
 } 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-04-20T05:00:42.133

```
public class AccessData {

    /**
     * @param args
     */
    public static void main(String[] args) throws Exception {
        // TODO Auto-generated method stub
        String USER_AGENT = "Mozilla/5.0";
        try {

            String url = "https://webapp2017sql.azurewebsites.net/api/customer";
            URL obj = new URL(url);
            HttpsURLConnection con = (HttpsURLConnection) obj.openConnection();

            //add reuqest header
            con.setRequestMethod("POST");
            con.setRequestProperty("User-Agent", USER_AGENT);
            con.setRequestProperty("Accept-Language", "en-US,en;q=0.5");
            con.setRequestProperty("Content-Type", "application/json");

            // Send post request
            con.setDoOutput(true);
            DataOutputStream wr = new DataOutputStream(con.getOutputStream());
            wr.writeBytes("{\"Id\":1,\"Name\":\"Kamlesh\"} ");
            wr.flush();
            wr.close();

            int responseCode = con.getResponseCode();
            System.out.println("\nSending 'POST' request to URL : " + url);
            System.out.println("Post parameters : " + urlParameters);
            System.out.println("Response Code : " + responseCode);

            BufferedReader in = new BufferedReader(
                    new InputStreamReader(con.getInputStream()));
            String inputLine;
            StringBuffer response = new StringBuffer();

            while ((inputLine = in.readLine()) != null) {
                response.append(inputLine);
            }
            in.close();

            //print result
            System.out.println(response.toString());

        }catch (Exception ex) {
            System.out.print(ex.getMessage());

            //handle exception here

        } finally {
            //Deprecated
            //httpClient.getConnectionManager().shutdown(); 
        }
    }

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-08-29T06:58:51.867

# 如果您是 JSON 新手，请先尝试以下示例来创建 json 文件并在其中写入数据；

```
public class JSONWrite 

{

    public static void main(String[] args) 

    {
//      JSONObject class creates a json object

        JSONObject obj= new JSONObject();
//      provides a put function to insert the details into json object

        obj.put("name", "Dinesh");
        obj.put("phone", "0123456789");
        obj.put("Address", "BAngalore");

//      This is a JSON Array List where we Creates an array 

        JSONArray Arr = new JSONArray();

//      Add the values in newly created empty array 

        Arr.add("JSON Array List 1");
        Arr.add("JSON Array List 2");
        Arr.add("JSON Array List 3");

//      adding the array with elements to our JSON Object

        obj.put("Remark", Arr);

        try{

//          File Writer creates a file in write mode at the given location

            FileWriter file = new FileWriter(IAutoconstant.JSONLPATH);

//          Here we convert the obj data to string and put/write it inside the json file

            file.write(obj.toJSONString());
            file.flush();
        }
            catch(Exception e)
            {
                e.printStackTrace();
            }
        }
} 
```

# 请找到以下代码以从上述 json 文件中读取数据

// 使用 JsonParser 将 JSON 字符串转换为 Json 对象

```
 JSONParser parser= new JSONParser(); 
```

// 解析我们之前创建的文件中的 JSON 字符串

```
 Object obj=parser.parse(new FileReader(IAutoconstant.JSONLPATH)); 
```

// Json 字符串已经转换为 JSONObject

```
 JSONObject jsonObject =(JSONObject)obj; 
```

// 使用 Keys 显示来自 JSON OBject 的值

```
 String value1 = (String) jsonObject.get("name");

    System.out.println("value1 is "+value1); 
```

// 将 JSONObject 转换为 JSONArray，因为备注是一个数组。

```
 JSONArray arrayobject=(JSONArray) jsonObject.get("Remark"); 
```

// 迭代器用于访问列表中的每个元素

```
 Iterator<String> it = arrayobject.iterator(); 
```

// 只要数组中有元素，循环就会继续。

```
 while(it.hasNext())
            {
            System.out.println(it.next());
            }
} 
```

希望对理解 json read.write 的概念有所帮助

# c++ - 无效使用非静态数据成员（typedef map）

> ID：10966777
> 
> 赞同：2
> 
> 时间：2012-06-10T06:25:19.343
> 
> 标签：c++, typedef

在我的头文件中，我有

```
 typedef map <string, MyClass*> myMap;

    class MainClass {
      myMap map;
    public:
      friend istream& operator>> (istream &is, MainClass &mainc) {
        string name = "Geo";
        MyClass* sample = new MyClass();
        map.insert(myMap::value_type(name, sample) );
        return is; }
    }; 
```

在编译期间，我得到：

```
line 4: error: invalid use of non-static data member 'MainClass::map'
line 9: error: from this location 
```

我尝试将 myMap 地图更改为 myMap 地图，但我遇到了同样的错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-10T06:38:35.657

由于您`operator>>`是 的朋友`MainClass`，因此它不与 的特定实例相关联`MainClass`（即，它不接收`this`指针）。

因此，当您尝试执行以下操作时：

```
map.insert(myMap::value_type(name, sample) ); 
```

编译器不知道`map`您要引用哪个实例的成员。显然，在这种情况下，您的意思是：

```
mainc.map.insert(myMap::value_type(name, sample)); 
```

...因为`mainc`是您收到的引用的实例，`MainClass`作为您读取的数据的目的地。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T06:32:43.910

首先，您必须决定您的操作员>> 做什么以及它使用什么“地图”成员实例。

# asp.net - 无法检索单个实体

> ID：10966778
> 
> 赞同：2
> 
> 时间：2012-06-10T06:25:34.643
> 
> 标签：asp.net, silverlight, wcf-ria-services, domainservices

我正在尝试通过其 ID 检索单个实体`DomainService`。

但是，该实体的类型不会在客户端中生成。这是我的查询：

```
public Contact GetContact(int contactId)
{
  return DbContext.Contacts
    .Include(c => c.Phones)
    .Include(c => c.Addresses)
    .SingleOrDefault(c => c.ContactId == contactId);
} 
```

该`Phone`实体不是在客户端上生成的。

我尝试用 装饰此方法`[Query]`，但随后出现以下编译时异常：

> 查询操作“GetContact”不能标记为可组合，因为它的返回类型“Models.Contact”没有实现 T 的 IEnumerable。

有什么方法可以创建按 ID 返回单个实体的 WCF RIA 查询？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T14:46:53.427

设置`IsComposable`属性将允许它构建。但正如在我们的讨论中一样，我不知道为什么没有生成您`Phone`和`Address`实体。

```
[Query(IsComposable=false)]
public Contact GetContact(int contactId)
{
  return DbContext.Contacts
    .Include(c => c.Phones)
    .Include(c => c.Addresses)
    .SingleOrDefault(c => c.ContactId == contactId);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T10:46:56.750

RIA 服务方法需要`IQueryable<T>`or`IEnumerable<T>`才能工作。它适用于变更集，而不是单个元素。

将其更改为此（并停止尝试返回单个对象）：

```
public IQueryable<Contact> GetContact(int contactId)
{
  return DbContext.Contacts
    .Include(c => c.Phones)
    .Include(c => c.Addresses)
    .Where(c => c.ContactId == contactId);
} 
```

只需将您的 FirstOrDefault() 应用于客户端代码（当然，一旦加载数据）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-18T19:47:13.730

启用 RIA 的控件（如 DomainDataSource 和 DataPager）使用 LINQ 'Take()' 来处理它们生成的几乎每个加载操作（检查您的 Fiddler 跟踪以了解我的意思）。我没有看足够长的时间来说它 100% 的时间，但它的大部分时间。这些控件需要一个 IQueryable，否则当您尝试执行排序、分页、分组等操作时，它们会随机弹出。调用 .FirstOrDefault() 真的没什么大不了的。

# asp.net - 我可以在默认会员表和新表之间建立关系吗

> ID：10966779
> 
> 赞同：0
> 
> 时间：2012-06-10T06:25:47.093
> 
> 标签：asp.net, asp.net-mvc-3, membership, relation

我在会员数据库中创建了一个新表。现在我想与 _aspnet_Users_ 表建立关系。我已经建立了关系，但是当我从数据库中建立一个 asp.net 实体模型时，`Model1.edmx`显示的表没有关系。

这可能吗 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T09:47:48.977

这是您要做的事情：在服务器资源管理器或管理工作室中将表添加到数据库并设置关系后，您应该重新打开 Model1.edmx 并右键单击设计区域并单击从数据库更新模型然后检查表并单击完成，Visual Studio 将自动将新表和关系添加到您的 Model.edmx

问题是你不能在两个表列之间建立关系，它们都不是关键列！

aspnet_User 是主键表，Post 表是外键表，所以需要把 aspnet_User 表的 UserID 列和 Posts 表中的同类型（uniqeidentifier）列对应起来，表示发帖的用户 ID帖子。

# c - 在 Linux 上执行进程之前获取 pid

> ID：10966787
> 
> 赞同：2
> 
> 时间：2012-06-10T06:27:23.253
> 
> 标签：c, linux, process

在进程实际执行之前，我将如何打印进程 ID？有没有办法可以获取先前执行的进程 ID 并增加？

IE

```
printf(<process id>);
execvp(process->args[0], process->args); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-10T06:29:40.987

**系统调用的exec**系列保留当前 PID，因此只需执行以下操作：

```
if(fork() == 0) {
    printf("%d\n", getpid());
    execvp(process->args[0], process->args);
} 
```

**在fork(2)**上分配新的 PID ，它将**0**返回给子进程，将子进程的 PID 返回给父进程。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-10T08:21:19.753

您需要 fork() 然后运行其中一个 exec() 函数。要从子进程获取数据，您需要在子进程和父进程之间进行某种形式的通信，因为 fork() 将创建父进程的单独副本。在此示例中，我使用 pipe() 将数据从子进程发送到父进程。

```
int fd[2] = {0, 0};
char buf[256] = {0};
int childPid = -1;

if(pipe(fd) != 0){
   printf("pipe() error\n");
   return EXIT_FAILURE;
}

pid_t pid = fork();
if(pid == 0) {
   // child process
   close(fd[0]);
   write(fd[1], getpid(), sizeof(int));
   execvp(process->args[0], process->args);
   _exit(0)
} else if(pid > 0){
   // parent process
   close(fd[1]);
   read(fd[0], &childPid, sizeof(childPid));
} else {
   printf("fork() error\n");
   return EXIT_FAILURE;
}
printf("parent pid: %d, child pid: %d\n", getpid(), childPid);
return 0; 
```

# android - 如何比较 3 个数组列表并替换第三个数组列表中的数据？

> ID：10966793
> 
> 赞同：1
> 
> 时间：2012-06-10T06:28:42.553
> 
> 标签：android, arraylist, sms

我有一个独特的短信问题：

最终目标是将列表中显示的电话号码替换为联系人姓名

*（这些都是字符串数组列表）*

**ArrayList3**包含代表电话号码选择的 6 个元素。 **ArrayList2**包含代表所有可用电话号码的 31 个元素。 **ArrayList1包含 31 个元素，分别以与****ArrayList2**相同的顺序表示所有电话号码的名称。

 **我如何将它们与这种效果进行比较：

“如果**Arraylist3 的**元素等于 ArrayList2 中的元素，则将**ArrayList3**复制到**ArrayList2**的相同位置，并将其放入**ArrayList3****中。”**

粗略地说，我试图做的是将 ArrayList3 的元素与**ArrayList2****中**的相同元素相匹配。从那里，使用 ArrayList2 的位置**来获得****ArrayList1**的相同位置，然后将该位置的数据（**ArrayList1**）复制到**ArrayList3**。

 ******关于如何实现这一目标的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T07:04:11.367

不要`ArrayList<String>`用于 ArrayList1 和 ArrayList2。将数据合并为`Map<String,String>`。

Map 基本上使用`<key, value>`结构，因此不是`ArrayList1`包含“名称”和`ArrayList2`包含“数字”，而是采取一种`Map<name,number>`方法，然后找到`ArrayList3`从`Map`.

见[地图](http://developer.android.com/reference/java/util/Map.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T07:29:11.500

我尝试了以下方法，它对我有用：

```
ArrayList<String> arrayList1 = new ArrayList<String>();
    ArrayList<String> arrayList2 = new ArrayList<String>();
    ArrayList<String> arrayList3 = new ArrayList<String>();
    arrayList1.add("Welcome");
    arrayList1.add("Home");

    arrayList2.add("1");
    arrayList2.add("2");

    arrayList3.add("2");

    for(int i=0; i< arrayList3.size(); i++){
        if(arrayList2.contains(arrayList3.get(i))){
            int index = arrayList2.indexOf(arrayList3.get(i));
            arrayList3.set(i, arrayList1.get(index));
            //Toast.makeText(this, "Found " + arrayList3.get(i), Toast.LENGTH_LONG).show();
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-10T06:40:45.113

基本上，您只是尝试使用 ArrayList1 （有名称）和 ArrayList2 （有数字）以相同的顺序将数字转换为 ArrayList3 中的名称（带有更新的索引）......

在同一个 ArrayList3 中读取和写入数据时，应该多使用一个数组列表。所以有可能任何名称都可以替换 i+ 索引处的任何数字，这还不是进程........********

# javascript - 为什么我收到此消息“Telerik 未定义”？

> ID：10966795
> 
> 赞同：2
> 
> 时间：2012-06-10T06:30:27.080
> 
> 标签：javascript, asp.net, telerik

我正在开发一个基于 Web 的 ASP.NET 应用程序，并且我正在使用 Telerik 工具。即使在我公司的生产服务器中也一切正常。现在，我们有另一个服务器，我们用它来测试我们正在开发的基于 Web 的应用程序。我将我的应用程序从生产服务器复制到了这个测试服务器，但它在它上面运行不佳。它打开了网站，但它在 IE 浏览器的左下角显示错误消息。它给了我以下错误：

**Telerik 未定义。**

由于这个错误，应用程序没有从 Telerik 工具控件上的数据库中检索任何数据。

我没有更改应用程序中的任何内容，我使用的是 .NET 4，它安装在两台服务器中。一切都是一样的，但我不知道为什么我会收到这个错误。你有什么办法解决这个问题。

当我在网上搜索时，我发现了很多资源，其中大多数都在谈论 web.config 文件，我尝试了大多数这些解决方案，但没有任何运气。为什么应用程序在第一台服务器上工作，而在第二台服务器上却不工作？

以下快照显示了错误： ![在此处输入图像描述](../Images/16373b311dbc22e8c1c10bc2885631b1.png)

我的 web.config 文件是：

```
<configuration>
    <connectionStrings>
  <add connectionString="Data Source=localhost\sqlexpress;Initial Catalog=PMODServices;Integrated Security=True" name="PMODServicesConnectionString" providerName="System.Data.SqlClient" />
   </connectionStrings>
    <system.web>
         <customErrors mode="Off" />
        <compilation debug="true" targetFramework="4.0">
            <assemblies>
                <add assembly="System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A" />
                <add assembly="System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089" />
                <add assembly="System.Speech, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
                <add assembly="System.Web.Extensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
                <add assembly="System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089" />
                <add assembly="System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089" />
                <add assembly="System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089" />
                <add assembly="System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089" />
                <add assembly="System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089" />
                <add assembly="Microsoft.ReportViewer.WebForms, Version=10.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A" />
                <add assembly="Microsoft.ReportViewer.Common, Version=10.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A" />
                <add assembly="Microsoft.Build.Framework, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A" />
                <add assembly="System.Management, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A" />
            <!--    <add assembly="office, Version=14.0.0.0, Culture=neutral, PublicKeyToken=71E9BCE111E9429C"/>  -->
                <add assembly="stdole, Version=7.0.3300.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A" /></assemblies>
            <buildProviders>
                <add extension=".rdlc" type="Microsoft.Reporting.RdlBuildProvider, Microsoft.ReportViewer.WebForms, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" />
            </buildProviders>
        </compilation>
        <httpHandlers>
            <!-- <add path="Telerik.Web.UI.WebResource.axd" verb="*" type="Telerik.Web.UI.WebResource" validate="false" />-->
            <add path="Telerik.Web.UI.WebResource.axd" verb="*" type="Telerik.Web.UI.WebResource, Telerik.Web.UI" validate="false" />
            <add path="ChartImage.axd" verb="*" type="Telerik.Web.UI.ChartHttpHandler" validate="false" />
            <add path="Telerik.Web.UI.SpellCheckHandler.axd" verb="*" type="Telerik.Web.UI.SpellCheckHandler" validate="false" />
            <add path="Telerik.Web.UI.DialogHandler.aspx" verb="*" type="Telerik.Web.UI.DialogHandler" validate="false" />
            <add path="Telerik.RadUploadProgressHandler.ashx" verb="*" type="Telerik.Web.UI.RadUploadProgressHandler" validate="false" />
            <add path="Reserved.ReportViewerWebControl.axd" verb="*" type="Microsoft.Reporting.WebForms.HttpHandler, Microsoft.ReportViewer.WebForms, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" validate="false" />
        </httpHandlers>
        <authentication mode="Windows"/>

        <pages>
            <controls>
                <add tagPrefix="telerik" namespace="Telerik.Web.UI" assembly="Telerik.Web.UI" />
            </controls>
        </pages>
        <httpModules>
            <add name="RadUploadModule" type="Telerik.Web.UI.RadUploadHttpModule" />
            <add name="RadCompression" type="Telerik.Web.UI.RadCompression" />
        </httpModules>
    </system.web>

    <location path="Users/Telerik.Web.UI.WebResource.axd">
            <system.web>
                <authorization>
                    <allow users="*"/>
                </authorization>
            </system.web>
        </location>
        <location path="Telerik.Web.UI.WebResource.axd">
            <system.web>
                <authorization>
                    <allow users="*"/>
                </authorization>
            </system.web>
        </location>

    <system.webServer>
        <validation validateIntegratedModeConfiguration="false" />
        <handlers>
            <remove name="ChartImage_axd" />
            <remove name="Telerik_Web_UI_SpellCheckHandler_axd" />
            <remove name="Telerik_Web_UI_DialogHandler_aspx" />
            <remove name="Telerik_RadUploadProgressHandler_ashx" />
            <remove name="Telerik_Web_UI_WebResource_axd" />
            <add name="Telerik_Web_UI_WebResource_axd" path="Telerik.Web.UI.WebResource.axd" type="Telerik.Web.UI.WebResource" verb="*" preCondition="integratedMode" />
            <add name="ChartImage_axd" path="ChartImage.axd" type="Telerik.Web.UI.ChartHttpHandler" verb="*" preCondition="integratedMode" />
            <add name="Telerik_Web_UI_SpellCheckHandler_axd" path="Telerik.Web.UI.SpellCheckHandler.axd" type="Telerik.Web.UI.SpellCheckHandler" verb="*" preCondition="integratedMode" />
            <add name="Telerik_Web_UI_DialogHandler_aspx" path="Telerik.Web.UI.DialogHandler.aspx" type="Telerik.Web.UI.DialogHandler" verb="*" preCondition="integratedMode" />
            <add name="Telerik_RadUploadProgressHandler_ashx" path="Telerik.RadUploadProgressHandler.ashx" type="Telerik.Web.UI.RadUploadProgressHandler" verb="*" preCondition="integratedMode" />
            <add name="ReportViewerWebControlHandler" preCondition="integratedMode" verb="*" path="Reserved.ReportViewerWebControl.axd" type="Microsoft.Reporting.WebForms.HttpHandler, Microsoft.ReportViewer.WebForms, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" />
        </handlers>
        <modules runAllManagedModulesForAllRequests="true">
            <remove name="RadUploadModule" />
            <remove name="RadCompression" />
            <add name="RadUploadModule" type="Telerik.Web.UI.RadUploadHttpModule" preCondition="integratedMode" />
            <add name="RadCompression" type="Telerik.Web.UI.RadCompression" preCondition="integratedMode" />
        </modules>
    </system.webServer>
    <appSettings>
        <add key="Telerik.ScriptManager.TelerikCdn" value="Enabled" />
        <add key="Telerik.StyleSheetManager.TelerikCdn" value="Enabled" />
    </appSettings>
</configuration> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-11T20:02:56.063

从您的 web.config 中删除这行代码：

```
 <add key="Telerik.ScriptManager.TelerikCdn" value="Enabled" /> 
```

在花了将近两天的时间让我的页面与 RadGrid 一起工作后，这对我有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T12:35:28.877

我认为这是关于 web.config 中的处理程序。检查那个链接。
[http://www.telerik.com/help/aspnet-ajax/introduction-troubleshooting.html](http://www.telerik.com/help/aspnet-ajax/introduction-troubleshooting.html)

# javascript - D3 可以改变投影

> ID：10966799
> 
> 赞同：0
> 
> 时间：2012-06-10T06:31:47.570
> 
> 标签：javascript, transform, d3.js, projection, gis

我正在为一个项目使用 D3.js，我想知道是否可以在更改缩放期间更改 SVG 对象的投影？我想在这种情况下使用它：我正在使用调用的投影`d3.geo.albersUsa()`，当我放大要更改为的对象时`d3.geo.azimuthal()`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T08:57:28.173

是的，这是可能的。只需使用通常的方法在缩放处理程序中设置投影。请注意，以这种方式更改投影可能不是一个好主意。用户可能会感到困惑，因为它在放大时看起来完全不同，这与缩放只是放大的正常行为相反。给用户一个单独的控件来更改投影可能是一个更好的主意。

# applescript - 如何在指定位置使用带有附件的 Apple 脚本打开撰写邮件（新邮件）屏幕？

> ID：10966804
> 
> 赞同：0
> 
> 时间：2012-06-10T06:32:52.883
> 
> 标签：applescript

我有一个苹果脚本，可以在邮件的最后打开带有附件的撰写邮件（新邮件）屏幕。

但我想要一个将附件放在用户指定位置的苹果脚本。我做了很多谷歌搜索，但没有找到任何东西。请给我一些解决方案。

消息正文模板如下：

> 亲爱的名字，
> 
> --------一些文字----------
> 
> --------一些文字------------
> 
> 附件1如下：
> 
> 此处应出现附件 1
> 
> 附件2如下：
> 
> 此处应出现附件 2
> 
> --------一些文字----------
> 
> --------一些文字------------

谢谢并恭祝安康，

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-10T16:47:47.673

这是一个例子：在第三段之后插入两个附件

```
set newOutgoingMessage to make new outgoing message with properties {visible:true, subject:"test", content:someText}
tell newOutgoingMessage
    make new paragraph with data (" " & return & return & return) at after paragraph 3 of content
    make new attachment with properties {file name:filePath1} at after paragraph 4 of content
    make new attachment with properties {file name:filePath2} at after paragraph 5 of content
end tell 
```

# geometry - 给定两个坐标及其对应的角度时如何找到三角形的第三个坐标

> ID：10966805
> 
> 赞同：2
> 
> 时间：2012-06-10T06:32:57.867
> 
> 标签：geometry, coordinates, trigonometry

我正在尝试计算三角形 ABC 的第三个坐标，其中 A(x1,y1) B(x2,y2) 角 CAB=a1 和角 CBA=a2。我需要找到我曾想过使用余弦定律的第三个坐标 C(x3,y3)，但它们可能会导致一些复杂的方程需要求解。

我需要一些简单的技术来解决它们，或者使用一些直接的公式或任何其他可以在计算机程序中实现的方法。

谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T07:31:45.607

至少有两种方法：

1.  通过线
    *   为每个包含未知顶点的三角形边建立一个线方程
    *   找到这些线的交点
2.  通过圈子
    *   [使用http://en.wikipedia.org/wiki/Law_of_sines](http://en.wikipedia.org/wiki/Law_of_sines)查找每个未知边的长度
    *   找到两个圆的交点

# php - PHP用链接替换字符串

> ID：10966807
> 
> 赞同：1
> 
> 时间：2012-06-10T06:33:38.997
> 
> 标签：php, regex

好的，感谢这个论坛上的人们，我终于得到了一个简单的 twitter 在线网站。现在我遇到了另一个问题。

我有一个 twitter 提要说示例文本是：

> 猫总是在包里@folks @charliesheen

现在我有了使用正则表达式查找文本中所有***@_***字符串并将它们替换为的想法

```
<a href="index.php?".$(matched_string - @)>matched_string</a> 
```

关于我如何才能做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-10T06:43:24.143

这是我快速破解的东西。 `\S`意思是“任何不是空格的字符”。

```
$str = 'The cat will always be in the bag @folks @charliesheen';
$str = preg_replace('/@(\S*)/', '<a href="index.php?$1">$1</a>', $str); 
```

编辑：为了安全起见，您应该确保 URL 中的所有字符都是“url-safe”。

```
$str = 'The cat will always be in the bag @folks @charliesheen';
$str = preg_replace_callback('/@(\S*)/', function($x){
    return '<a href="index.php?'.urlencode($x[1]).'">'.$x[1].'</a>';
}, $str); 
```

# c - 一种更好的算法来检查二维数组中的非连续分组

> ID：10966811
> 
> 赞同：2
> 
> 时间：2012-06-10T06:34:00.467
> 
> 标签：c, arrays, algorithm, multidimensional-array

我正在做一个文字游戏。该板表示为 2D C 数组。我的填充数组的简化版本可能看起来像这样。

```
[x][x][0][0][0][0][0]
[x][0][0][0][x][0][0]
[x][0][0][x][x][x][x]
[0][0][0][0][x][0][0]

```

x块之间没有对角线连接，只有上、下、左、右。

我想要一个算法来检查是否有两个不连续的 X 值“块”。这个算法，给定一个特定的 2D 游戏数组，将使我能够在：

*   是的，只有一个连续的 X 块
*   不，有不止一个连续的 X 块

对于上面显示的示例，我会找到“否”，因为有不止一个连续的 X 块。

我的第一个简单想法是找到一个连续的 X 块并将这些值编入目录。由于对这个问题不重要的原因，我很容易在一个连续块的中间找到一个起点。如果我可以在不在我的编目列表中的任何地方找到 X，我可以返回“否”，否则，“是”。然而，这让我觉得这是一种非常低效的方式。

我知道我需要触摸 2D 数组的每个项目以全面排除另一个连续块。我对找到“不”的最快方法更感兴趣。

因为数组非常小，我可以在没有任何实际性能问题的情况下实现我的想法。但是，我确信有一种更优雅的方法，并且我认为这个问题可能会引起堆栈溢出蜂巢思维中一些喜欢算法的部分的兴趣。

这也可以在另一个 SO 问题或整个互联网的某个地方进行描述。也许我只是不知道表达这个问题的正确方法。如果你这样做，请赐教。最佳解决方案还可以获得尚未完成的 iOS 文字游戏的免费副本。:-D

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T06:51:57.610

您的数组形成了一个图形，并且您在询问该图形是否具有多个连接组件。最简单的方法可能是复制数组，擦除找到的第一个连接组件，然后查找另一个 X。如果找到一个，则开始时有多个组件。

擦除是图形搜索的一个很好的应用。例如，您可以这样做（在 C 中）：

```
#define N_ROWS 4
#define N_COLS 7
typedef char WORD_BOX[N_ROWS][N_COLS];

void erase_cc(WORD_BOX box, int i, int j)
{
  if (i < 0 || j < 0 || i >= N_ROWS || j >= N_COLS || box[i][j] != 'X')
    return;
  box[i][j] = 'O';
  erase_cc(box, i - 1, j);
  erase_cc(box, i + 1, j);
  erase_cc(box, i, j - 1);
  erase_cc(box, i, j + 1);
}

int find_cc(WORD_BOX box, int *i_ret, int *j_ret)
{
  int i, j;
  for (i = 0; i < N_ROWS; i++)
    for (j = 0; j < N_COLS; j++)
      if (box[i][j] == 'X') {
        *i_ret = i;
        *j_ret = j;
        return 1;
      }
  return 0;
}

int more_than_one_cc(WORD_BOX box)
{
  int i,  j;
  WORD_BOX copy;
  memcpy(copy, box, sizeof(WORD_BOX));
  if (find_cc(copy, &i, &j)) {
    erase_cc(copy, i, j);
    return find_cc(copy, &i, &j);
  }
  return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T06:51:26.960

以下*最优*解为 O( *n* ) 的运行时间，不仅计算是否存在两个以上的连续序列，而且计算

*   返回找到的序列的确切数量（水平和垂直）

*   *返回每个*序列在水平和垂直方向上的位置和长度（对代码进行非常小的重新排列）。

您的问题的解决方案可以非常有效且简单地解决，无需使用任何类型的图论，而只需使用您对数组的了解，并利用您对它们在内存中的布局方式的了解。下面的 C 程序演示了这个原理。

```
static inline void TrackLength(int **hpnCountPtr, int *pSeqStart)
{
    (*((*hpnCountPtr) ? (*hpnCountPtr) : (*hpnCountPtr = pSeqStart)))++;
}

static int FindSequences(char *pcbGrid, int nWidth, int nHeight)
{
    int    nColIndex, nRowIndex, nSeqTotal;
    int   *panResult, *pnHorzSeq, *panVTable;
    int  **panVertSeqs;
    size_t nResultLen;
    char  *pcbCheckPtr;

    nResultLen = (size_t) (2 * nWidth * nHeight) * sizeof(int);
    panResult  = (int*) memset(alloca(nResultLen), 0, nResultLen);
    panVTable  = panResult + (nWidth * nHeight);

    panVertSeqs = (int**) alloca(nWidth * sizeof(int*));
    for (nColIndex = 0; nColIndex < nWidth; panVertSeqs[nColIndex++] = (int*) NULL);

    for (pcbCheckPtr = pcbGrid, nRowIndex = 0; nRowIndex < nHeight; nRowIndex++)
        for (pnHorzSeq = (int*) NULL, nColIndex = 0; nColIndex < nWidth; nColIndex++, pcbCheckPtr++)
        {
            if (*pcbCheckPtr != 'X')
            {
                pnHorzSeq = panVertSeqs[nColIndex] = (int*) NULL;
                continue;
            }

            TrackLength(&pnHorzSeq, panResult + (pcbCheckPtr - pcbGrid));
            TrackLength(panVertSeqs + nColIndex, panVTable + (pcbCheckPtr - pcbGrid));
        }

    /* Insert Debug Information Here */

    for (nSeqTotal = 0, nColIndex = nWidth * nHeight; nColIndex; nColIndex--)
        if (*panResult++ > 1)
            nSeqTotal++;

    return nSeqTotal;
} 
```

关键在于您的要求是*只需要找到水平和垂直序列*，而不是对角线。作为一个 2D 数组，这意味着可以通过知道 2D 数组是简单的平坦、*连续*的内存块来进行巨大的优化，可以一次从头到尾遍历。

利用内存安排，可以仅使用单个计数器跟踪水平序列，该计数器针对每个连续的内存位置递增`X`，并且每次`X`遇到非时重置为零。如果在阵列的 2D 视图中每个“行”的末尾强制重置计数器，这将成功跟踪水平序列。

在跟踪水平序列的*同时*，我们可以同时跟踪垂直序列。但是，由于数组中列中的相邻单元格以`width`字节间距出现，因此我们必须保留一个计数器数组，`width`这些计数器在我们扫描行时跟踪行中所有可能的垂直序列，每列一个序列。

最后，我的解决方案的真正美妙之处在于计数器实际上是指向两个 2D 数组的指针（一个用于跟踪垂直序列，一个用于跟踪水平序列）。每个数组中的每个位置都代表一个序列的潜在开始，当函数完成时，每个数组将在每个位置包含从该位置开始的每个序列的长度。

下图最好地说明了这一点：

```
 Grid      Horizontal    Vertical
             Sequences    Sequences

....X...X.   0000100010   0000300030
.X..X...X.   0100100010   0300000000
.XXXX..XXX   0400000300   0011000201
.X.....X..   0100000100   0000000000 
```

水平序列数组中的每个数字代表从该点开始的水平序列的长度。垂直序列的垂直序列数组也是如此。

由于程序使一个并且恰好一个传递输入数组，并且每个数组元素的处理时间是恒定的，因此该算法在 O( *n* ) 中运行并且对于任何大小的网格都是最佳的。

如果在下面的程序中插入上述函数：

```
#include <stdbool.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <alloca.h>

#define GRID_WIDTH  18
#define GRID_HEIGHT  9

static char *s_szGrid =
    "X X X X X X X X X "
    " X X X X X X X X X"
    "X X X X X X X X X "
    " X X X X X X X X X"
    "XXX X X X X X X X "
    " X X X X X X X X X"
    "XXXXX X X X X X X "
    " X X X X X X X X X"
    "X X XXX X X X X X ";

void main(void)
{
    int nSeqTotal = FindSequences(s_szGrid, GRID_WIDTH, GRID_HEIGHT);

    printf("\nGrid has %i contiguous sequences\n", nSeqTotal);

    if (nSeqTotal)
        printf(">>> %sone sequence detected\n", (nSeqTotal > 1) ? "more than " : "");
} 
```

然后将以下调试代码块插入到您看到`/* Insert Debug Information Here */`注释的函数中：

```
{
    int  nXIndex, nYIndex;
    int *pnValue;

    printf("Horizontal:\n");
    for (pnValue = panResult, nYIndex = 0; nYIndex < nHeight; nYIndex++, printf("\n"))
        for (nXIndex = 0; nXIndex < nWidth; nXIndex++, printf("%2i", *pnValue++));

    printf("\nVertical:\n");
    for (nYIndex = 0; nYIndex < nHeight; nYIndex++, printf("\n"))
        for (nXIndex = 0; nXIndex < nWidth; nXIndex++, printf("%2i", *pnValue++));
} 
```

然后程序将产生以下输出：

```
Horizontal:
 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0
 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1
 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0
 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1
 3 0 0 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0
 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1
 5 0 0 0 0 0 1 0 1 0 1 0 1 0 1 0 1 0
 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1
 1 0 1 0 3 0 0 0 1 0 1 0 1 0 1 0 1 0

Vertical:
 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0
 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1
 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0
 0 5 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1
 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0
 0 0 0 3 0 1 0 1 0 1 0 1 0 1 0 1 0 1
 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0
 0 0 0 0 0 2 0 1 0 1 0 1 0 1 0 1 0 1
 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0

Grid has 6 contiguous sequences
>>> more than one sequence detected 
```

但是，如果输入网格更改为此：

```
static char *s_szGrid =
    "X X X X X X X X X "
    " X X X X X X X X X"
    "X X X X X X X X X "
    " X X X X X X X X X"
    "X X X X X X X X X "
    " X X X X X X X X X"
    "X X X X X X X X X "
    " X X X X X X X X  "
    "X X X X X X X X XX"; 
```

然后输出将是：

```
Horizontal:
 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0
 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1
 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0
 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1
 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0
 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1
 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0
 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 0
 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 2 0

Vertical:
 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0
 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1
 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0
 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1
 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0
 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1
 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0
 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 0
 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 1

Grid has 1 contiguous sequences
>>> one sequence detected 
```

# .net - .NET 异常杀死 VB6 应用程序

> ID：10966815
> 
> 赞同：5
> 
> 时间：2012-06-10T06:35:45.687
> 
> 标签：.net, vb6, com-interop

我有一个 VB6 应用程序。它正在调用 .NET 代码。.NET 代码有时会根据设计抛出异常。

VB6 在调用 .NET 代码的函数中有一个 On Error Goto 语句。当 .NET 抛出异常时，VB6 代码应处理错误（在 Goto 块中），将 Err.Description 写入日志，并调用 Err.Clear，并应继续执行。

从 Visual Studio 6.0 运行 VB6 应用程序时，这可以正常工作并且符合预期（如上所述）。当我从已编译的 exe 运行 VB6 应用程序时，我在我的 VB6 日志文件中看到了预期的错误……但在错误发生后，VB6 应用程序挂起片刻，然后意外崩溃。事件查看器中甚至没有 APPCRASH 报告。

有关如何解决此问题的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T17:07:56.883

这听起来确实像一个线程问题，即使您说情况并非如此。我将从 Process Explorer 之类的工具开始，并监视在调用时创建了哪些线程。这可能是无意的。

其次，我也会记录 .NET 代码的成功返回 - 您的代码中可能会出现错误。

# ajax - 设计网络相册：CSS 还是 Ajax？

> ID：10966816
> 
> 赞同：0
> 
> 时间：2012-06-10T06:35:51.050
> 
> 标签：ajax

我想设计一个网络相册，相册中的每张图片都有自己的标题和描述。因此，一次只能看到一组图像、标题和描述。单击下一步按钮时，将出现下一组图像、标题和描述，依此类推。

所以我想知道，最好的设计方法是什么？HTML 还是 AJAX？

我不想使用诸如灯箱之类的现成工具。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T07:02:58.107

你想让浏览器的后退按钮工作吗？如果是这样，那么你应该让你的生活变得简单并使用 html（因为无论哪种方式你一次只会显示一个图像）。

Ajax 意味着使用 html。另一方面，使用 html 并不一定意味着您需要使用 AJAX 来动态加载内容。

这个项目的目的是什么？如果您这样做是为了学习经验，您应该继续使用 AJAX（从头开始）。如果您想要速度和质量，请使用现有的网络图片库。如果您需要自己编写它，请使用纯 html（或 ajax 框架，如 dojo、jquery 等。这将为您节省很多解决跨浏览器怪癖的痛苦）。

此外，如果您希望能够单击按钮将您带到下一个（上一个）图像，并且您不知道事先将拥有多少张图像，那么您正在寻找动态行为。您可以在客户端（javascript）或服务器端（让我们说“php”开始）编写动态逻辑。

另外，您打算如何将相应的（图像、标题、描述）放在一起？如果您只有 3 张图片，假设您可以将每张图片硬编码到相应的 html 文件中。例如。1.html、2.html、3.html。然后，您必须将 a.html 中的前进按钮指向 b.html。ETC...

如果您不想要这种无聊的静态行为并且想要更智能的东西，那么假设您决定使用 AJAX。然后您将只有 1.html 文件，并从那里（使用 javascript）向您的服务器询问（图像、标题、描述）并将所有这些（动态，无需刷新浏览器）加载到同一页面中。从服务器获取此信息的最简单方法是读取包含所有信息（图像 url、标题、描述）的静态（XML 或 JSON）文件。然后使用 javascript 并使用 DOM 操作，您将删除旧图像，并添加新图像。

但是，使用服务器端处理，这一切都会简单得多（值得学习）。在这种情况下，您可以有一个带有图像编号参数的 url。例如。[http://example.com/gallery/index.php?image=X](http://example.com/gallery/index.php?image=X) 然后在服务器用 html 响应客户端之前，它会意识到你想要加载图像 X，所以它会得到它对应的描述、标题和网址。并将它们“嵌入”到文件中。当然，根据数量，它还会为上一个和下一个按钮添加正确的链接。例如。如果当前显示的图像是 9，则前进按钮将“动态”确定链接到 (X+1)：[http ://example.com/gallery/index.php?image=10](http://example.com/gallery/index.php?image=10)

# php - 自定义 PHP 字符串格式

> ID：10966819
> 
> 赞同：-1
> 
> 时间：2012-06-10T06:36:10.523
> 
> 标签：php, arrays, string, loops, foreach

我有一个包含 20 组字段的 HTML 表单。这里有2个例子：

```
<input type="text" class="auto-clear" id="p1weight" name="p1weight" value=""  />     
<input type="text" class="auto-clear" id="p1length" name="p1length" value="" />     
<input type="text" class="auto-clear" id="p1width" name="p1width" value="" />    
<input type="text" class="auto-clear" id="p1height" name="p1height" value="" />    

<input type="text" class="auto-clear" id="p2weight" name="p2weight" value="" />    
<input type="text" class="auto-clear" id="p2length" name="p2length"  value="" />     
<input type="text" class="auto-clear" id="p2width" name="p2width" value="" />    
<input type="text" class="auto-clear" id="p2height" name="p2height" value="" /> 
```

我正在使用以下 PHP 代码生成一个字符串 ( **$all** ) 来存储字段值：

```
foreach( range( 1, 20) as $i)
    {
        // Create an array that stores all of the values for the current number
        $values = array( 
            'p' . $i . 'weight' => $_POST['p' . $i . 'weight'],
            'p' . $i . 'length' => $_POST['p' . $i . 'length'], 
            'p' . $i . 'width' => $_POST['p' . $i . 'width'], 
            'p' . $i . 'height' => $_POST['p' . $i . 'height'] 
        );

        $all .= implode( '|', $values) . "\n\n";
    } 
```

如果我对 2 组字段的输入是 1、2、3 和 4，则我的**$all**值为：`1|2|3|4 1|2|3|4`。

但是，我想对此进行更多自定义。最终，我希望我的**$all**是：

```
Item1: Weight (kg):1 Length (cm): 2 Width (cm): 3 Height (cm): 4
Item2: Weight (kg):1 Length (cm): 2 Width (cm): 3 Height (cm): 4 
```

如何更新上面的 PHP 以实现此目的？

非常感谢您的任何指点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T07:18:02.740

您上面的代码已经很好地将提交的数据标准化为数组。现在要映射数组中的值，您可以使用一个名为[`vsprintf`](http://php.net/vsprintf). 它需要两个参数。第一个是格式化字符串，您可以在其中添加占位符来标记值的格式（例如`%d`，显示为整数 (d = digit)），第二个参数是包含值的数组：

```
$format = "Item$i: Weight (kg): %d length (cm): %d Width (cm): %d Height (cm): %d \n\n";
$all .= vsprintf($format, $values); 
```

这种方法的好处是您将值提取和格式化解耦了。然后，您可以在将来将这两个部分移得更远，例如多种类型的输出。

此外，这保留了您已经编写的内容，这是在规范化提交的数据方面向前迈出的一大步。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T06:53:15.937

```
foreach( range( 1, 20) as $i)
        {

            $all .= "Item".$i.": Weight (kg):".$_POST['p' . $i . 'weight']." Length (cm): ".$_POST['p' . $i . 'length']." Width (cm): ".$_POST['p' . $i . 'width']." Height (cm): ".$_POST['p' . $i . 'height']."\n";
        } 
```

# java - 为 2D 游戏开发绘制到 JPanel 的适当方法？

> ID：10966821
> 
> 赞同：0
> 
> 时间：2012-06-10T06:36:42.550
> 
> 标签：java, graphics, drawing, 2d

我想做一个 2D 游戏，但我无法找到使用 BufferStrategy 绘制到 2D Surface/Canvas 的最佳和最有效的方法。我将使用 JFrame 作为主窗口，并希望在其表面上进行绘制。我很想看到一些关于如何完成的示例代码（如果这是一个很好的方法）以及其他示例。如果有人也能解释这样做的一些优点和缺点，那就太好了。

我目前正在使用 'frame.add(new Painter());' 将我的绘图类添加到我的 JFrame 然后覆盖paintComponent 方法。我发现的唯一问题是它似乎只调用了一次这个方法。

这是我的画家课：

```
public class Painter extends JPanel{

    public static Player player;

    public Painter() {
        player = new Player(300, 300);

    }

    public void paint(Graphics g) {
        player.x++;
        g.setColor(Color.white);
        g.fillRect(player.x, player.y, 32, 32);
    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T07:50:26.817

在最简单的情况下，您的游戏只需要根据用户操作更新屏幕，您需要`repaint()`在更新某些内容时调用（例如在 JFrame 上）。

在其他情况下，您需要构建一个所谓的**Game Loop**，在其中更新游戏状态并及时渲染更新的游戏状态。可以在此处找到有关使用 Java 代码的简单游戏循环的精彩教程：http: [//obviam.net/index.php/the-android-game-loop/](http://obviam.net/index.php/the-android-game-loop/)

如果您开发一款严肃的游戏，您应该坚持使用游戏引擎来管理游戏循环和其他常规游戏开发方面。可以在这里找到一个好的 Java 游戏引擎：[http ://code.google.com/p/playn/](http://code.google.com/p/playn/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-07-05T00:49:55.953

对于游戏循环和将游戏对象和其他对象（图像、爆炸等）打印到屏幕的有效方式，您需要一个计时机制和一个 JFrame 来一遍又一遍地打印，同时获取更新来自玩家和游戏状态本身。

首先，你需要一个 main 方法，我猜你对 java 中的这种类型的字段很陌生，所以我会尽可能快速和清楚地为你分解它。

```
public static main(String[] args)
{
  yourClassName game = new yourClassName();
  game.run();
  System.exit(0);
} 
```

这个主要方法首先做两件事，为你的 run 方法创建一个对象（因为不建议在游戏循环中使用静态引用），然后用你新创建的对象调用该方法。当该运行方法完成时，系统将退出程序。

现在我不会在这里详细介绍，但是一旦你运行了 run 方法，你需要一个只运行一次的 init 方法。在此方法中，您将创建要渲染到的 JFrame。这样做相当简单，所以我不会再进一步​​创建 JFrame 类。但是，您的 Run 方法应如下所示...

```
void Run()
{
   init();
   while(isRunning)
   {
     update();
     draw();

     time = (1000 / fps) - (System.currentTimeMillis() - time);

            if (time > 0) 
            {
                try 
                { 
                        Thread.sleep(time); 
                } 
                catch(Exception e){} 
            }

   }
} 
```

此方法会将计算速度减慢到您想要的某个 fps（在这种情况下，fps 变量被命名为 fps 用于显示）。

现在在您的更新方法中，您将拥有 keyBinding 和其他东西来查找键盘或鼠标的更改（在我的情况下，目前是服务器）。大多数人不知道如何在不接收 Repaint 方法所需的参数的情况下打印或绘制到 JFrame，因此我们将通过添加双缓冲来覆盖它。

```
BufferedImage backBuffer; 
```

在初始化方法中，您将添加

```
backBuffer = new BufferedImage(getWidth(),getHeight(),
                            BufferedImage.TYPE_INT_RGB) 
```

在 draw 方法中，您将拥有...

```
Graphics g = getGraphics();

Graphics bbg = backBuffer.getGraphics(); 
```

对于那些您可以绘制到由 init 类创建的 JFrame 的能力（此外，通过这样做，您可以从任何类或线程中绘制以减少处理负载）。

要查看它是否有效，请继续使用`bbg.fillRect(updateX,updateY,5,5)`

updateX 和 updateY 表示用于更新矩形位置的变量。将它们保存为全局变量或保存在字符类中的公共变量。

如果一切都失败了，这里是我用来创建自己的游戏引擎的示例代码......

```
import input.InputHandler; 

import java.awt.*; 
import java.awt.event.KeyEvent; 
import java.awt.image.BufferedImage; 
import javax.swing.JFrame; 

/** 
 * Main class for the game 
 */ 
public class GameTutorial extends JFrame 
{        
    boolean isRunning = true; 
    int fps = 30; 
    int windowWidth = 500; 
    int windowHeight = 500; 

    BufferedImage backBuffer; 
    Insets insets; 
    InputHandler input; 

    int x = 0; 

    public static void main(String[] args) 
    { 
            GameTutorial game = new GameTutorial(); 
            game.run(); 
            System.exit(0); 
    } 

    /** 
     * This method starts the game and runs it in a loop 
     */ 
    public void run() 
    { 
            initialize(); 

            while(isRunning) 
            { 
                    long time = System.currentTimeMillis(); 

                    update(); 
                    draw(); 

                    //  delay for each frame  -   time it took for one frame 
                    time = (1000 / fps) - (System.currentTimeMillis()-          time); 

                    if (time > 0) 
                    { 
                            try 
                            { 
                                    Thread.sleep(time); 
                            } 
                            catch(Exception e){} 
                    } 
            } 

            setVisible(false); 
    } 

    /** 
     * This method will set up everything need for the game to run 
     */ 
    void initialize() 
    { 
            setTitle("Game Tutorial"); 
            setSize(windowWidth, windowHeight); 
            setResizable(false); 
            setDefaultCloseOperation(EXIT_ON_CLOSE); 
            setVisible(true); 

            insets = getInsets(); 
            setSize(insets.left + windowWidth + insets.right, 
                            insets.top + windowHeight + insets.bottom); 

        backBuffer = new BufferedImage(windowWidth, windowHeight,   BufferedImage.TYPE_INT_RGB); 
            input = new InputHandler(this); 
    } 

    /** 
     * This method will check for input, move things 
     * around and check for win conditions, etc 
     */ 
    void update() 
    { 
            if (input.isKeyDown(KeyEvent.VK_RIGHT)) 
            { 
                    x += 5; 
            } 
            if (input.isKeyDown(KeyEvent.VK_LEFT)) 
            { 
                    x -= 5; 
            } 
    } 

    /** 
     * This method will draw everything 
     */ 
    void draw() 
    {               
            Graphics g = getGraphics(); 

            Graphics bbg = backBuffer.getGraphics(); 

            bbg.setColor(Color.WHITE); 
            bbg.fillRect(0, 0, windowWidth, windowHeight); 

            bbg.setColor(Color.BLACK); 
            bbg.drawOval(x, 10, 20, 20); 

            g.drawImage(backBuffer, insets.left, insets.top, this); 
    } 
} 
```

我希望这会有所帮助，我知道这可能是一个非常晚的答案，但我还没有看到一个体面的 Java 游戏引擎，它易于理解和使用并且使用起来很有趣。希望你坚持下去，祝你编程愉快！！！

# javascript - 将多个本机事件映射到 Ember.js 中的语义应用程序事件？

> ID：10966823
> 
> 赞同：3
> 
> 时间：2012-06-10T06:37:58.527
> 
> 标签：javascript, ember.js

我以前没有使用过 Ember.js，但是在阅读了 [视图指南](http://emberjs.com/guides/view_layer/#toc_event-bubbling)的部分之后，我想知道 Ember 专家如何处理需要将多个本机事件映射到同一个“应用程序事件”的情况。

在指南中，给出的示例显示将（本机）单击事件映射到（特定于应用程序的）deleteItem 事件。在许多情况下，许多本机事件映射到一个特定于应用程序的事件是很常见的。如果用户使用的触摸设备还连接了键盘和鼠标（例如即将推出的 Windows 8 平板电脑），我需要映射“touchstart”、“click”和“keyup”（例如`[CTRL]-D`）事件怎么办？到同一个特定于应用程序的事件，如 deleteItem？

您是否会在视图上放置 3 个方法——touchStart、click 和 KeyUp——并让它们都调用一个常见的第 4 个方法来发送 deleteItem 事件？

Ember 中是否内置了任何东西来处理这种情况——特别是多个原生事件在应用程序中都具有相同语义的情况？我认为这将变得越来越普遍，因为浏览器支持触摸，笔记本电脑支持触摸，浏览器 API 可以接受来自其他硬件（如麦克风、相机等）的输入......我可以想象一个设备，其中 5 或 6 个本机事件全部对于给定的视图具有相同的语义。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T23:12:22.450

我们一直在谈论类似于支持“点击”事件的东西。

我认为最好的方法是使用注册 jQuery 的“特殊事件”。这是更多信息的链接：http: [//benalman.com/news/2010/03/jquery-special-events/](http://benalman.com/news/2010/03/jquery-special-events/)

要使特殊事件与 Ember 视图一起使用，您需要将其注册为`Ember.Application`实例上的自定义事件：

```
Ember.Application.create({
  customEvents: {
    // key is the jquery event, value is the name used in views
    myeventname: 'myEventName'
  }
}); 
```

# java - Eclipse 错误：无法加载 JNI 共享库“C:\Program Files (x86)\Java\jre6\bin\client\jvm.dll

> ID：10966830
> 
> 赞同：-1
> 
> 时间：2012-06-10T06:39:27.277
> 
> 标签：java, android, eclipse, java-native-interface

> **可能重复：**
> [无法加载 JNI 共享库 (JDK)](https://stackoverflow.com/questions/7352493/failed-to-load-the-jni-shared-library-jdk)

我已经下载了新的经典 eclipse 64 位，我也在 eclipse.ini 中进行了更改，并且还安装了 android jdk 工具，但仍然出现以下错误。JNI共享库“C:\Program Files (x86)\Java\jre6\bin\client\jvm.dll加载失败怎么解决？

请帮我。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-10T06:46:12.740

> C:\Program Files (x86)\Java\jre6\bin\client\jvm.dll 如何解决问题？

从这里我看到的是你正在使用 32 位版本的 java。

**要解决此问题，您必须安装 64 位版本的 Java。**

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-06-10T06:48:04.297

尝试将计算机的路径（在环境变量中）设置为 Java JDK 的 bin 文件（C:\Program Files (x86)\Java\jre6\bin）。

# android - 触摸屏幕时如何使圆圈变大（Android）？

> ID：10966831
> 
> 赞同：2
> 
> 时间：2012-06-10T06:39:33.070
> 
> 标签：android, geometry, touch-event, ontouchlistener

我对 Android 比较陌生，对图形也很陌生。我可以在屏幕上画一个圆圈，甚至在它移动时拖动它并扩大（半径继续增加），但是当我只是触摸屏幕时，圆圈的大小并没有增加。我认为这是因为 MotionEvent。

本质上，我想要做的是在触摸屏幕时增加一个圆的大小，并在用户移动手指时相对于圆心移动，然后在抬起手指时重置为原始半径。任何建议都会很棒，或者如果有人知道涵盖此内容的教程也会很棒。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T06:48:37.527

在您的 onTouchEvent 方法中，使用 getActionMasked() 检查事件类型；

```
int eventType = event.getActionMasked();
if(eventType == MotionEvent.ACTION_DOWN)
   growCircle();
else if(eventType == MotionEvent.ACTION_UP)
  returnCircleToNormal(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-10T06:56:11.573

嗯......你可以做的是覆盖`onDraw()`并直接绘制到提供的画布上`canvas.drawBitmap(bitmap, src, dst, paint)`

以下是对论点的解释：

*   **bitmap**是您要使用的位图
*   **src**是一个`Rect`变量，它允许您选择要使用的位图的哪个部分......`null`如果您想绘制整个位图，只需使用
*   **dst**是另一个`Rect`变量，用于在画布上绘制位图的位置。如果您将矩形的点从它们应该在的位置向上设置，它也会放大您的位图。
*   最后，只需将**paint**设置为null

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T07:38:04.657

在你的`ACTION_DOWN`方法中启动一个线程，每秒增加你的圆的半径。停止线程并将圆圈调整为`ACTION_UP`原始大小。

# ruby-on-rails - 没有路线匹配 [GET] "/say/hello"

> ID：10966834
> 
> 赞同：1
> 
> 时间：2012-06-10T06:39:48.383
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我编写了一个非常小的程序来帮助我学习 ruby​​。以下是我从服务器日志中得到的错误。

这是我从浏览器尝试的 URL，并出现以下错误：`localhost:3000/say/hello`

```
Started GET "/say/hello" for 127.0.0.1 at Sun Jun 10 14:28:45 +0800 2012
ActionController::RoutingError (No route matches [GET] "/say/hello"):
  actionpack (3.2.5) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (3.2.5) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
  railties (3.2.5) lib/rails/rack/logger.rb:26:in `call_app'
  railties (3.2.5) lib/rails/rack/logger.rb:16:in `call'
  actionpack (3.2.5) lib/action_dispatch/middleware/request_id.rb:22:in `call'
  rack (1.4.1) lib/rack/methodoverride.rb:21:in `call'
  rack (1.4.1) lib/rack/runtime.rb:17:in `call'
  activesupport (3.2.5) lib/active_support/cache/strategy/local_cache.rb:72:in `call'
  rack (1.4.1) lib/rack/lock.rb:15:in `call'
  actionpack (3.2.5) lib/action_dispatch/middleware/static.rb:62:in `call'
  railties (3.2.5) lib/rails/engine.rb:479:in `call'
  railties (3.2.5) lib/rails/application.rb:220:in `call'
  rack (1.4.1) lib/rack/content_length.rb:14:in `call'
  railties (3.2.5) lib/rails/rack/log_tailer.rb:17:in `call'
  rack (1.4.1) lib/rack/handler/webrick.rb:59:in `service'
  /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/webrick/server.rb:82:in `start'
  rack (1.4.1) lib/rack/handler/webrick.rb:13:in `run'
  rack (1.4.1) lib/rack/server.rb:265:in `start'
  railties (3.2.5) lib/rails/commands/server.rb:70:in `start'
  railties (3.2.5) lib/rails/commands.rb:55
  railties (3.2.5) lib/rails/commands.rb:50:in `tap'
  railties (3.2.5) lib/rails/commands.rb:50
  script/rails:6:in `require'
  script/rails:6

  Rendered /Library/Ruby/Gems/1.8/gems/actionpack-3.2.5/lib/action_dispatch/middleware/templates/rescues/routing_error.erb within rescues/layout (1.4ms) 
```

# 这是我的 Gemfile 内容

```
source 'https://rubygems.org'

gem 'rails', '3.2.5'
gem 'sqlite3'

group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'coffee-rails', '~> 3.2.1'
  gem 'uglifier', '>= 1.0.3'
end

gem 'jquery-rails' 
```

我查看了其他一些 SO 线程，但似乎没有一个与我的问题特别相关。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T08:38:00.207

在您的 routes.rb 中，您需要：

`match "say/hello" => "myController#myaction"`（用适当的值替换控制器和动作）

或者

`match ':controller(/:action(/:id))(.:format)'`这将允许您使用如下代码：`link_to "hello", :controller => "mycontroller", :action => "myaction"`或输入 URL（如 /say/hello）

前者是首选方法，因为用户无法访问您不希望他们访问的网址。

此外，您的视图应该位于将使用它的控制器名称的子目录中，而不是在实际的“视图”目录中

编辑：

查看下面的答案，您需要将文件设为 html.erb 而不是 rhtml

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T07:45:57.680

键入`bundle execute rake routes`以列出应用程序中的所有路由路径。检查是否`:controller=>"say", :action=>"hello"`存在。

此外，这不遵循 Rails 的宁静规则，因此您可能需要取消注释.`match ':controller(/:action(/:id))(.:format)'`最后一行的`config/routes.rb`.

# facebook - Facebook Graph API 返回数字而不是电子邮件地址

> ID：10966835
> 
> 赞同：5
> 
> 时间：2012-06-10T06:40:24.013
> 
> 标签：facebook, facebook-graph-api

当用户注册我的网站时，我使用 Facebook Connect 和 Facebook Graph API 来获取用户的电子邮件地址。这在 99% 的情况下都能完美运行，但有时当我在用户授予我的站点权限（包括电子邮件权限）后查询 Graph API 以获取用户数据时，Facebook 会返回一个大数字（例如 14036774009）作为此人的电子邮件地址。

到目前为止，这些数字总是不同的，并且总是 11 位长，并且来自 Graph API 的所有其他用户数据都是有效的。我从来没有能够用我控制的 Facebook 帐户复制这个问题。

在某些方面，大量的数字让我想起了 Facebook 为选择为第三方应用程序提供转发地址而不是主地址的人生成的随机代理电子邮件地址（代理地址看起来像这样：apps+148742679521093.617890126.8a2b26037e1ccd06bb81aaec5925f4c7@ proxymail.facebook.com)

谁能解释这种行为或解决它的方法（并始终获得有效的电子邮件地址）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T22:53:09.757

这是一个错误。已向 Facebook 报告：

[https://developers.facebook.com/bugs/298946933534016](https://developers.facebook.com/bugs/298946933534016)

[即使使用图形资源管理器 - https://developers.facebook.com/tools/explorer](https://developers.facebook.com/tools/explorer) ，它似乎也在发生，但仅适用于某些用户。在我的情况下，大约 0.2% 的时间。

因此，在修复之前，您有 2 个选项：

*   如果 Facebook 为您提供了错误的电子邮件值，请手动向用户询问他/她的电子邮件。
*   保存长期存在的访问令牌并定期重试以查看您是否收到正确的电子邮件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T10:28:01.393

您还在以某种方式使用旧的身份验证对话框吗？提供代理电子邮件地址的功能仅在旧的身份验证对话框中

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-03T14:06:51.833

这发生在使用手机号码注册 Facebook 并且返回的号码就是这样的人身上。

无法获取用户的电子邮件地址，因为他可能尚未将其提供给 Facebook。

# c++ - C++ 插入排序中位数计算错误

> ID：10966837
> 
> 赞同：0
> 
> 时间：2012-06-10T06:40:54.590
> 
> 标签：c++, median, insertion

我遇到了一个我以前从未见过的错误，它指出对事物的引用是模棱两可的。

我正在编写一个计算运行中位数的小型测试程序。随着列表的增长，它会重新计算中位数。在这种情况下，中位数表示列表中的中间数字（或上中）。因此，7 的中位数是 7，7 和 9 的中位数是 9，7 3 和 9 的中位数是 7。

我正在用两个动态数组来完成这个（我希望）。最初，将第一个值设置为中位数，然后将输入的每个数字与当前中位数进行比较。中值用于计算两个数组之间的中间元素。

左侧数组用于所有小于中位数的值，右侧数组用于所有大于中位数的值。我使用插入排序来对每个数组中的数字进行排序（这在几乎排序的列表中非常有用）。

我只是不明白我遇到的错误以及我出错的地方。我对 C++ 相当陌生，所以我选择了一种更简单的方法来解决这个问题。

```
#include <cstdlib>
#include <iostream>
#include <string>
#include <vector>

using namespace std;

vector<int> left;
vector<int> right;
int leftCount = 0;
int rightCount = 0;
void leftInsertionSort(int);
void rightInsertionSort(int);
void inputNumber(int, int);

int main(int argc, char** argv) {

    int length = 0;
    int value;
    int median;
    string input;

    while (cin >> input) {
        value = atoi(input.c_str());

        inputNumber(value, median);

        if (leftCount > rightCount) {
            median = (((leftCount + rightCount) / 2) + 1);
            cout << left[median];
        } else {
            median = (((leftCount + rightCount) / 2) + 1) - leftCount;
            cout << right[median];
        }
    }

    return 0;
}

void inputNumber(int value, int median) {
    if (leftCount == 0 && rightCount == 0) {
        left[0] = value;
        median = value;
        leftCount++;
    } else
    if (leftCount == 1 && rightCount == 0) {
        right[0] = value;
        if (left[0] > right[0]) {
            right[0] = left[0];
            left[0] = value;
        }
        median = right[0];
        rightCount++;
    } else
    if (value < median) {
        left[leftCount] = value;
    } else {
        right[rightCount] = value;
    }
}

void leftInsertionSort(int lLength)
{
    leftCount++;
    int key, i;
    for(int j = 1; j < lLength; j++)
    {
        key = left[j];
        i = j - 1;
        while (left[i] > key && i >= 0) {
            left[i+1] = left[i];
            i--;
        }
        left[i+1] = key;
    }
}

void rightInsertionSort(int rLength)
{
    rightCount++;
    int key, i;
    for(int j = 1; j < rLength; j++)
    {
        key = right[j];
        i = j - 1;
        while (right[i] > key && i >= 0) {
            right[i+1] = right[i];
            i--;
        }
        right[i+1] = key;
    }
} 
```

我似乎得到的错误是'错误：对'left'的引用不明确'

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T06:57:35.767

从我在尝试编译时遇到的编译器错误来看，似乎命名空间`std`定义了名称`left`和`right`，您也将其用作变量名称。编译器无法决定使用哪个定义，因此您会收到错误消息。正是出于这样的原因，从命名空间中导入所有内容是不受欢迎的——最好是显式导入所需的名称或使用命名空间限定符。

无论如何，您的算法似乎不必要地复杂。为什么不只保留一个向量，`push_back`当你得到一个新数字时，将数字放在正确的索引处，然后只返回向量的中上部元素？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T07:00:48.433

**[left](http://www.cplusplus.com/reference/iostream/manipulators/left/)**和**[right](http://www.cplusplus.com/reference/iostream/manipulators/right/)**是`iostream`.

只需重命名变量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-10T07:05:42.723

这是一个很好的例子，说明为什么`#using namespace std`不是一个好主意。`left`并且`right`也为`std`命名空间定义，现在有冲突。如果您省略该行并通过显式指定它们的命名空间来引用向量、字符串、cin 和 cout，`std::`则不会遇到此冲突。

# jquery - jquery继续重定向om倒计时

> ID：10966840
> 
> 赞同：0
> 
> 时间：2012-06-10T06:42:00.823
> 
> 标签：jquery, countdown

这是我在 id dlbtn 上触发点击事件时的 jquery 倒计时代码

```
var settimmer = 0;
$(function() {
    $('#dlbtn').click(function() {
        $('#dlnotify').toggle('slow');
        window.setInterval(function() {
            var timeCounter = $("b[id=show-time]").html();
            var updateTime = eval(timeCounter) - eval(1);
            $("b[id=show-time]").html(updateTime);
            if (updateTime <= 0) {
                window.location = ('/dl.php?fid=12');

                $('#dlnotify').hide();
            }
        }, 500);
        updateTime--;
        return false; //Kill the Event after request
    });

});​ 
```

我的脚本继续点击 dl.ph 页面

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T07:10:10.377

我不是 100% 确定问题是什么，但是为了消除`setInterval`你需要打电话给`clearInterval`

[http://www.w3schools.com/jsref/met_win_setinterval.asp](http://www.w3schools.com/jsref/met_win_setinterval.asp)

试试这个代码：

```
var settimmer = 0;
$(function() {
    $('#dlbtn').click(function() {
        $('#dlnotify').toggle('slow');
        settimmer =window.setInterval(function() {
            var timeCounter = $("b[id=show-time]").html();
            var updateTime = eval(timeCounter) - eval(1);
            $("b[id=show-time]").html(updateTime);
            if (updateTime <= 0) {

                window.location = ('/dl.php?fid=12');
                clearInterval(settimmer); // clear the interval to avoid multiple redirects 
                $('#dlnotify').hide();
            }
        }, 500);
        updateTime--;
        return false; //Kill the Event after request
    });

});​ 
```

# google-app-engine - Google App Engine：在数据存储上使用 Big Query？

> ID：10966841
> 
> 赞同：15
> 
> 时间：2012-06-10T06:42:18.687
> 
> 标签：google-app-engine, google-bigquery

拥有一个 GAE 数据存储类型，其中包含数十万个对象。想做几个涉及到的查询（涉及计数查询）。Big Query 似乎很适合这样做。

目前是否有一种使用 Big Query 查询实时 AppEngine Datastore 的简单方法？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-10T15:19:46.857

您不能直接在 DataStore 实体上运行 BigQuery，但您可以编写一个 Mapper Pipeline，从 DataStore 中读取实体，将它们写入 Google Cloud Storage 中的 CSV，然后将它们摄取到 BigQuery - 您甚至可以自动化该过程。[以下是仅将Mapper API](http://code.google.com/p/appengine-mapreduce/wiki/GettingStartedInPython)类用于 DataStore 到 CSV 步骤 的示例：

```
import re
import time
from datetime import datetime
import urllib
import httplib2
import pickle

from google.appengine.ext import blobstore
from google.appengine.ext import db
from google.appengine.ext import webapp

from google.appengine.ext.webapp.util import run_wsgi_app
from google.appengine.ext.webapp import blobstore_handlers
from google.appengine.ext.webapp import util
from google.appengine.ext.webapp import template

from mapreduce.lib import files
from google.appengine.api import taskqueue
from google.appengine.api import users

from mapreduce import base_handler
from mapreduce import mapreduce_pipeline
from mapreduce import operation as op

from apiclient.discovery import build
from google.appengine.api import memcache
from oauth2client.appengine import AppAssertionCredentials

#Number of shards to use in the Mapper pipeline
SHARDS = 20

# Name of the project's Google Cloud Storage Bucket
GS_BUCKET = 'your bucket'

# DataStore Model
class YourEntity(db.Expando):
  field1 = db.StringProperty() # etc, etc

ENTITY_KIND = 'main.YourEntity'

class MapReduceStart(webapp.RequestHandler):
  """Handler that provides link for user to start MapReduce pipeline.
  """
  def get(self):
    pipeline = IteratorPipeline(ENTITY_KIND)
    pipeline.start()
    path = pipeline.base_path + "/status?root=" + pipeline.pipeline_id
    logging.info('Redirecting to: %s' % path)
    self.redirect(path)

class IteratorPipeline(base_handler.PipelineBase):
  """ A pipeline that iterates through datastore
  """
  def run(self, entity_type):
    output = yield mapreduce_pipeline.MapperPipeline(
      "DataStore_to_Google_Storage_Pipeline",
      "main.datastore_map",
      "mapreduce.input_readers.DatastoreInputReader",
      output_writer_spec="mapreduce.output_writers.FileOutputWriter",
      params={
          "input_reader":{
              "entity_kind": entity_type,
              },
          "output_writer":{
              "filesystem": "gs",
              "gs_bucket_name": GS_BUCKET,
              "output_sharding":"none",
              }
          },
          shards=SHARDS)

def datastore_map(entity_type):
  props = GetPropsFor(entity_type)
  data = db.to_dict(entity_type)
  result = ','.join(['"%s"' % str(data.get(k)) for k in props])
  yield('%s\n' % result)

def GetPropsFor(entity_or_kind):
  if (isinstance(entity_or_kind, basestring)):
    kind = entity_or_kind
  else:
    kind = entity_or_kind.kind()
  cls = globals().get(kind)
  return cls.properties()

application = webapp.WSGIApplication(
                                     [('/start', MapReduceStart)],
                                     debug=True)

def main():
  run_wsgi_app(application)

if __name__ == "__main__":
  main() 
```

如果将此附加到 IteratorPipeline 类的末尾：`yield CloudStorageToBigQuery(output)`，则可以将生成的 csv 文件句柄通过管道传输到 BigQuery 摄取管道中……如下所示：

```
class CloudStorageToBigQuery(base_handler.PipelineBase):
  """A Pipeline that kicks off a BigQuery ingestion job.
  """
  def run(self, output):

# BigQuery API Settings
SCOPE = 'https://www.googleapis.com/auth/bigquery'
PROJECT_ID = 'Some_ProjectXXXX'
DATASET_ID = 'Some_DATASET'

# Create a new API service for interacting with BigQuery
credentials = AppAssertionCredentials(scope=SCOPE)
http = credentials.authorize(httplib2.Http())
bigquery_service = build("bigquery", "v2", http=http)

jobs = bigquery_service.jobs()
table_name = 'datastore_dump_%s' % datetime.utcnow().strftime(
    '%m%d%Y_%H%M%S')
files = [str(f.replace('/gs/', 'gs://')) for f in output]
result = jobs.insert(projectId=PROJECT_ID,
                    body=build_job_data(table_name,files)).execute()
logging.info(result)

def build_job_data(table_name, files):
  return {"projectId": PROJECT_ID,
          "configuration":{
              "load": {
                  "sourceUris": files,
                  "schema":{
                      # put your schema here
                      "fields": fields
                      },
                  "destinationTable":{
                      "projectId": PROJECT_ID,
                      "datasetId": DATASET_ID,
                      "tableId": table_name,
                      },
                  }
              }
          } 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-12-03T10:15:16.403

使用新的（从 2013 年 9 月起）[流插入 API](http://googlecloudplatform.blogspot.co.uk/2013/09/google-bigquery-goes-real-time-with-streaming-inserts-time-based-queries-and-more.html)，您可以将记录从您的应用程序导入 BigQuery。

数据会立即在 BigQuery 中可用，因此应该可以满足您的实时需求。

虽然这个问题现在有点老了，但对于任何遇到这个问题的人来说，这可能是一个更简单的解决方案

目前，虽然从本地开发服务器上让它工作充其量是不完整的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-10-19T18:34:36.337

我们正在做一个 Trusted Tester 程序，通过两个简单的操作从 Datastore 迁移到 BigQuery：

1.  使用 Datastore Admin 的备份功能备份数据存储
2.  将备份直接导入 BigQuery

它会自动为您处理架构。

更多信息（申请）：[https ://docs.google.com/a/google.com/spreadsheet/viewform?formkey=dHdpeXlmRlZCNWlYSE9BcE5jc2NYOUE6MQ](https://docs.google.com/a/google.com/spreadsheet/viewform?formkey=dHdpeXlmRlZCNWlYSE9BcE5jc2NYOUE6MQ)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-10T07:27:39.507

对于 BigQuery，您必须将这些 Kind 导出到 CSV 或分隔记录结构中，加载到 BigQuery 中，然后您就可以查询了。据我所知，没有任何设施可以查询实时 GAE 数据存储。

Biquery 是分析查询引擎，这意味着您无法更改记录。不允许更新或删除，只能追加。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-10T07:04:40.600

不，BigQuery 是一种不同的产品，需要将数据上传到其中。它不能在数据存储上工作。您可以使用 GQL 查询数据存储。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-02-22T04:31:53.430

截至 2016 年，现在这很有可能！您必须执行以下操作：

1.  在谷歌存储中创建一个新存储桶
2.  使用 console.developers.google.com 上的数据库管理员备份实体我有一个完整的教程
3.  前往 bigquery Web UI，并导入在步骤 1 中生成的文件。

有关此工作流程的完整示例，请参阅[这篇文章！](http://www.smartgooglecloud.com/gcs/bigquery/datastore-export-to-bigquery-part-1-manual-export/)

# linux - ffmpeg：如何在 video-2 的开头添加 video-1

> ID：10966842
> 
> 赞同：1
> 
> 时间：2012-06-10T06:42:55.207
> 
> 标签：linux, video, ffmpeg

我想在 linux 中用命令行在 video-2 的开头添加 video-1，可以吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T07:28:29.553

运行`ffmpeg -i input.flv output.mpg`将视频格式转换为`mpg`，
然后运行`cat *.mpg > all.mpg`

# iphone - 在 iphone 上删除数据 sqllite - 数据库被锁定

> ID：10966846
> 
> 赞同：1
> 
> 时间：2012-06-10T06:43:44.813
> 
> 标签：iphone, objective-c, database, sqlite

当我尝试从 SqlLite 数据库中删除数据时，我的应用程序崩溃了。

这是错误：`Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'Error while deleting. 'database is locked'`

这是我在数据库上的所有代码：

```
#import "Database.h"

static sqlite3 *database = nil;
static sqlite3_stmt *deleteStmt = nil;
static sqlite3_stmt *addStmt = nil;

@implementation Database

@synthesize id_poi, pathDb, arrPoi;

- (id) initWithData:(NSDictionary *) data {

    [super init];
    NSLog(@"%@",[data objectForKey:@"pathDb"]);
    NSLog(@"id_poi = %@",[data objectForKey:@"id_poi"]);
    //setto l'id nello stato dell'oggetto
    id_poi = [data objectForKey:@"id_poi"];
    pathDb = [data objectForKey:@"pathDb"];

    return self;
}

- (void) deletePoi {

    if (sqlite3_open([pathDb UTF8String], &database) == SQLITE_OK) {
        const char *sql = "delete from Poi where id_poi = ?";
        sqlite3_stmt *deleteStmt;
        if(sqlite3_prepare_v2(database, sql, -1, &deleteStmt, NULL) == SQLITE_OK) {
            //When binding parameters, index starts from 1 and not zero.
            sqlite3_bind_int(deleteStmt, 1, [id_poi integerValue]);

            if (SQLITE_DONE != sqlite3_step(deleteStmt)) {
                NSAssert1(0, @"Error while deleting. '%s'", sqlite3_errmsg(database));
                [[WPActivityIndicator sharedActivityIndicator] hide];
                return;
            }
        } else {
            NSAssert1(0, @"Error while creating delete statement. '%s'", sqlite3_errmsg(database));   
        }
        sqlite3_finalize(deleteStmt);
    } else {
        sqlite3_close(database); //Even though the open call failed, close the database connection to release all the memory.
    }

    [[WPActivityIndicator sharedActivityIndicator] hide];
}

- (BOOL) checkIdPoi {

    // lista temporanea
    NSMutableArray *listaTemp = [[NSMutableArray alloc] init];
    // Oggetto che contiene i vari elementi
    NSMutableDictionary *dictionary;

    NSMutableString *str_id_poi;//id della persona

    if (sqlite3_open([pathDb UTF8String], &database) == SQLITE_OK) {
        // query che ricava i valori
        const char *sql = "select id_poi from Poi where id_poi = ?";
        sqlite3_stmt *selectstmt;

        if(sqlite3_prepare_v2(database, sql, -1, &selectstmt, NULL) == SQLITE_OK) {

            sqlite3_bind_int(selectstmt, 1 , [id_poi integerValue]);
            while(sqlite3_step(selectstmt) == SQLITE_ROW) {
                // ricaviamo i valori letti dalla query
                str_id_poi = [NSMutableString stringWithUTF8String:(char *)sqlite3_column_text(selectstmt, 0)];

                // inseriamo tutti i valori letti in un unico oggetto
                dictionary = [[NSMutableDictionary alloc] initWithObjectsAndKeys:str_id_poi, @"id_poi", nil];
                //NSLog(@"str_id_poi = %@",str_id_poi);
                [listaTemp addObject:dictionary];
                [dictionary release];
                return TRUE;
            }
        } else {
            NSAssert1(0, @"Error while read data. '%s'", sqlite3_errmsg(database));
            return FALSE;
        }
    }
    else {
        sqlite3_close(database);
        return FALSE;
    }

    return FALSE;

}

- (void) addPoi {

    //NSLog(@"%@",pathDb);

    if (sqlite3_open([pathDb UTF8String], &database) == SQLITE_OK) {

        const char *sql = "insert into Poi(id_poi) Values(?)";
        sqlite3_stmt *addStmt;
        if(sqlite3_prepare_v2(database, sql, -1, &addStmt, NULL) == SQLITE_OK) {

            NSString *str_id_poi = [[NSString alloc] initWithFormat:@"%d", [id_poi integerValue]];
            sqlite3_bind_text(addStmt, 1, [str_id_poi UTF8String], -1, SQLITE_TRANSIENT);

            if(SQLITE_DONE != sqlite3_step(addStmt)) {
                NSAssert1(0, @"Error while inserting data. '%s'", sqlite3_errmsg(database));
                [[WPActivityIndicator sharedActivityIndicator] hide];
                return;
            } else {
                //SQLite provides a method to get the last primary key inserted by using sqlite3_last_insert_rowid
                //id_poi = sqlite3_last_insert_rowid(database);
            }

            //Reset the add statement.
            sqlite3_reset(addStmt);

        } else {
            NSAssert1(0, @"Error while creating add statement. '%s'", sqlite3_errmsg(database));            
        }
        sqlite3_finalize(addStmt); 

    } else {
        sqlite3_close(database); //Even though the open call failed, close the database connection to release all the memory.
    }

    sqlite3_close(database);

    [[WPActivityIndicator sharedActivityIndicator] hide];

}

// Carica i valori dal database passato come parametro
-(NSMutableArray*)getIdPOI {

    // lista temporanea
    NSMutableArray *listaTemp = [[NSMutableArray alloc] init];
    // Oggetto che contiene i vari elementi
    NSMutableDictionary *dictionary;

    NSMutableString *str_id_poi;//id della persona

    if (sqlite3_open([pathDb UTF8String], &database) == SQLITE_OK) {
        // query che ricava i valori
        const char *sql = "select id_poi from Poi";
        sqlite3_stmt *selectstmt;

        if(sqlite3_prepare_v2(database, sql, -1, &selectstmt, NULL) == SQLITE_OK) {

            while(sqlite3_step(selectstmt) == SQLITE_ROW) {
                // ricaviamo i valori letti dalla query
                str_id_poi = [NSMutableString stringWithUTF8String:(char *)sqlite3_column_text(selectstmt, 0)];

                // inseriamo tutti i valori letti in un unico oggetto
                dictionary = [[NSMutableDictionary alloc] initWithObjectsAndKeys:str_id_poi, @"id_poi", nil];
                //NSLog(@"str_id_poi = %@",str_id_poi);
                [listaTemp addObject:dictionary];
                [dictionary release];
            }

            //Reset the add statement.
            sqlite3_reset(selectstmt);

        } else {
            NSAssert1(0, @"Error while read data. '%s'", sqlite3_errmsg(database));
        }

        //ADD THIS LINE TO YOUR CODE
        sqlite3_finalize(selectstmt);
    }
    else
        sqlite3_close(database);

    sqlite3_close(database);

    return listaTemp;
}

+ (void) finalizeStatements {
    if(database) sqlite3_close(database);
    if(deleteStmt) sqlite3_finalize(deleteStmt);
    if(addStmt) sqlite3_finalize(addStmt);
}

-(void)dealloc {
    [pathDb release];
    [arrPoi release];

    [super dealloc];
}

@end 
```

有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T05:30:00.457

当为 sqlite db 触发多个查询时，可能会发生这种类型的错误。当您执行任何查询时，您需要同步对数据库的所有调用。

将所有数据库代码包装在 @synchronized 块中，如下所示：

```
@synchronized(self)
{
   // database query code goes here
} 
```

注意。此示例假定所有数据库查询都是从 1 类内部执行的。如果不是，您应该将“self”替换为一个公共对象实例，该对象实例由与数据库接口的所有类共享。或者，您可以在主线程上运行所有数据库语句。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T07:54:15.143

这通常发生在数据库打开然后未正确关闭时。这可能是因为您从其他地方打开了相同的数据库实例。（如不同的类或 SQLite 管理器）。

通常建议创建一个与数据库通信的单例实例，而不是一次又一次地打开和关闭数据库。希望这会有所帮助。

# database - 模特经纪公司数据库意见

> ID：10966850
> 
> 赞同：1
> 
> 时间：2012-06-10T06:44:59.830
> 
> 标签：database, codeigniter, database-design

我想做一个基于codeigniter的模型代理，但我坚持使用数据库，正是注册部分。

我想允许用户注册为模特、摄影师、代理商或化妆师。

那么有人可以给我一个意见如何制作数据库吗？就像把模特、摄影师、经纪公司和艺术家分开放在不同的桌子上，在登记表上只要求基本信息？比如姓名、密码、电子邮件、DOB，还是有其他方法？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T07:10:05.750

为不同类型的注册人创建一个下拉列表，下拉数据`person_type`来自数据库中的单独表（例如），并将人员的基本详细信息与表的 ID 一起保存在单独的`person_type`表中。

为此，您可以制作一个用于获取、插入和更新记录的模型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T12:29:50.643

您应该使用父类型为“USER”的实体子类型，其中包含您的基本信息，以及子类型为“MODEL”、“AGENCY”、“PHOTOGRAPHER”、“MAKEUP_ARTIST”。这将使您在不可避免的重叠情况下获得更好的用户体验。我确信有些摄影师拥有代理机构和代理机构进行化妆等。尽管拥有不同类型的个人资料，但对于这些类型的用户来说，拥有一个用户 ID 和密码会更好。

# ios - 保存前创建对象的iOS模式？

> ID：10966852
> 
> 赞同：3
> 
> 时间：2012-06-10T06:45:04.167
> 
> 标签：ios, cocoa, core-data

我对 iOS 很陌生，目前正在为我的应用程序设计“创建新事件”页面。

一些信息：

1.  用户可以单击创建新事件，然后按返回以取消创建此新事件。（我正在使用 UINavigationController）
2.  可以将 1 个视频附加到特定事件。
3.  用户可以创建一个新事件，录制一个视频，然后决定不继续保存它（通过按下返回）
4.  每个事件都必须生成一个 uuid。需要此 uuid 以防止不同客户端之间创建事件并将它们提交给服务器之间的实体冲突。
5.  每个捕获的视频都被命名为**uuid** .mov 用于在事件上传到服务器之前存储到文件系统中。

来自 rails 背景，我习惯于执行以下操作：

1.  当用户单击“创建新事件页面”时，会创建一个事件但不会保存到数据库中。
2.  然后用户在页面中输入属性并决定他/她是否要提交
3.  当提交发生时，该事件被赋予所提供的信息。然后保存该事件。

但是，我不相信 Core Data 有一个 API 允许开发人员创建一个实体而不保存它。目前，我正在做这样的事情：

1.  当用户访问“创建新事件页面”时，会创建一个空对象并将其存储到数据库中。对事件实例的引用被传递给创建新事件页面的控制器。
2.  当用户输入了所有信息并拍摄了视频（uuid 是在 awakeFromInsert 时创建并在 1 期间设置的），保存只是设置具有所需属性的实体。
3.  如果用户决定取消创建事件，我正在检查是否按下了取消。如果是，则事件和视频文件都将被删除。

检查是否按下取消的代码。

```
- (void)viewWillDisappear:(BOOL)animated {
    [super viewWillDisappear:animated];
    if (![[self.navigationController viewControllers] containsObject:self]) { 
```

老实说，这有点复杂。大家有更好的建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T07:42:19.913

它实际上像您描述的 Rails 工作那样工作：新对象在您提交它们之前不会保存到持久存储中（通过`NSManagedObjectContext`'s`save:`方法）。

请参阅[核心数据编程指南](http://developer.apple.com/library/mac/#documentation/cocoa/conceptual/coredata/cdprogrammingguide.html)的[创建和删除托管对象部分](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreData/Articles/cdCreateMOs.html)。摘录...

> 简单地创建一个托管对象不会导致它被保存到持久存储中。托管对象上下文充当暂存器。您可以使用它创建和注册对象，对对象进行更改，以及根据需要撤消和重做更改。如果您对与给定上下文关联的托管对象进行更改，这些更改将保持在该上下文的本地，直到您通过向上下文发送 save: 消息来提交更改。此时——假设没有验证错误——更改将提交到存储区。

# c# - 如何简单地从一个应用程序调用另一个应用程序？

> ID：10966853
> 
> 赞同：1
> 
> 时间：2012-06-10T06:45:33.830
> 
> 标签：c#, ipc, sendmessage

我是 C# 和编程的新手。我有 2 个具有不同进程的应用程序，我需要能够尽可能简单地从另一个应用程序调用 1 个应用程序的方法。我不需要交换数据或其他任何东西，只需要调用一个方法。我用谷歌搜索了它。我知道有很多不同的方式，比如管道，但我需要最简单的一种。我还发现我可以这样发送消息：

```
const uint WM_COPY = 0x301;

[DllImport("user32.dll", CharSet = CharSet.Auto)]
public static extern int SendMessage(IntPtr hWnd, uint uMsg, int wParam, int lParam);

Process p = Process.GetProcessesByName("appname").FirstOrDefault();
if(p != null)
{
    IntPtr hWnd = p.MainWindowHandle;
    SendMessage(hWnd, WM_COPY , 0, 0);
} 
```

我能够收到带有此代码的消息：

```
protected override void WndProc(ref Message m)
{
    if (m.Msg == WM_COPY)
    {
        //my code
    }
    else
    {
        base.WndProc(ref m);
    }
} 
```

但有一个问题。应该接收消息的应用程序没有表单，它只是一个过程。我使用了 this.Hide()，所以 MainWindowHandle 不起作用。

是否可以向具有隐藏表单的应用程序发送消息？或者也许有更好的方法来调用第二个应用程序上的方法？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T06:59:03.303

好吧，如果您需要做的只是调用一个完全没有参数的方法，最简单的方法是创建一个命名的[Mutex](http://msdn.microsoft.com/en-us/library/system.threading.mutex.aspx)，从调用进程中设置它并从接收进程中检查它。

如果您需要更详细的内容，请查看[WCF](http://msdn.microsoft.com/en-us/netframework/aa663324.aspx)。

# java - 如何在 Java 中创建关联列表？

> ID：10966855
> 
> 赞同：3
> 
> 时间：2012-06-10T06:46:38.757
> 
> 标签：java, list, hashmap

我试图让用户输入 a`String`来搜索列表中的值。这工作正常，但我也希望`String`有一个数值。这样我就可以得到清单价格中的特定项目。我试过：

```
public List<String, double> 
```

然而，这总是给我一个错误。如何存储字符串及其对应的数值？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-10T06:48:29.497

使用地图。

```
Map<String, Double> someMap = new HashMap<String, Double>(); 
```

然后，您可以使用`Map#put(K, V)`and`Map#get(K)`来放置和获取值。

也可以查看[Map 文档](http://docs.oracle.com/javase/7/docs/api/java/util/Map.html)。

从 Java 7 开始，您可以在构造函数的声明中省略泛型类型：

```
Map<String, Double> someMap = new HashMap<>(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-10T06:54:46.063

您是只存储 a`String`和 a `Double`，还是最终需要存储有关每个对象的更多信息？

例如，您正在谈论存储名称和价格。如果这是一个类似购物的程序，您可能最好将每个产品的所有信息存储在一个新类中，然后将该类存储在`HashMap`. 例如..

```
// Class for your product and all related information...
public class Product {
    String name;
    double price;
    String color;
    double weight;

    public Product(String name, double price, String color, double weight){
        this.name = name;
        this.price = price;
        this.color = color;
        this.weight = weight;
    }
}

// Now add each Product to a HashMap (in your main class)...
HashMap<String,Product> products = new HashMap<String,Product>();
products.put("Cheese", new Product("Cheese",1.10,"Yellow",0.5);
products.put("Milk", new Product("Milk",2.0,"White",1.5); 
```

然后，您将能够查询`HashMap`for`"Cheese"`并且您将获得`Product`and 以及它的所有信息......

```
Product cheese = products.get("Cheese");
double price = cheese.getPrice(); 
```

# c - 在 C 中查找函数的大小

> ID：10966856
> 
> 赞同：8
> 
> 时间：2012-06-10T06:46:44.207
> 
> 标签：c

我正在学习函数指针，我知道我们可以使用函数指针来指向函数。然后我假设它们留在内存中。它们是留在堆栈还是堆？我们可以计算它们的大小吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-10T08:42:42.847

代码空间是由链接器在构建代码时静态分配的。在您的代码由操作系统加载的情况下，操作系统加载程序从操作系统请求该内存并将代码加载到其中。类似地，正如其名称所暗示的那样，此时分配了静态数据，初始堆栈也是如此（尽管如果创建了额外的线程，可能会创建更多堆栈）。

关于确定函数的大小，链接器知道此信息，并且在大多数工具链中，链接器可以创建一个映射文件，其中包括所有静态内存对象的大小和位置（即那些未在运行时实例化的对象）堆栈或堆上的时间）。

没有保证在运行时确定函数大小的方法（并且没有理由这样做）但是，如果您假设链接器在内存中按顺序定位源代码中相邻的函数，那么以下可能会给出函数大小的指示：

```
int first_function()
{
   ...
}

void second_function( int arg )
{
    ...
}

int main( void )
{
    int first_function_length = (int)second_function - (int)first_function ;
    int second_function_length = (int)main - (int)second_function ;

} 
```

然而YMMV；我在 VC++ 中试过这个，它只在“发布”版本中给出了有效的结果；“调试”构建的结果没有真正意义。我建议这个练习只是为了兴趣，没有实际用途。

观察代码大小的另一种方法当然是查看调试器中代码的反汇编。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-10T06:49:26.080

函数是文本段的一部分（可能是也可能不是“堆”）或您使用的体系结构的等价物。编译后没有关于它们大小的数据，最多您可以从符号表中获取它们的入口点（不一定可用）。因此，在您将遇到的大多数 C 环境中，您无法在实践中计算它们的大小。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-10T06:50:13.467

它们（通常）与堆栈或堆分开。

有很多方法可以找到它们的大小，但它们都不是便携式的。如果您认为您需要/想知道尺寸，那么您很有可能正在做一些您可能应该避免的事情。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-10T17:13:31.477

为简单起见，函数通常不会进入堆栈或堆，因为它们是只读数据，而堆栈和堆是读写存储器。

你真的需要在运行时知道它的大小吗？如果不是，您可以通过简单的方式获得它，`objdump -t -i .text a.out`其中 a.out 是您的二进制文件的名称。这`.text`是链接器放置代码的地方，加载器可以选择将此内存设为只读（甚至只是只执行）。如果是的话，正如之前的帖子中已经回复的那样，有办法做到这一点，但它很棘手且不可移植...... Clifford给出了最直接的解决方案，但链接器很少将函数以这种顺序的方式放入final二进制。另一种解决方案是使用编译指示在链接器脚本中定义部分，并为全局变量保留一个存储空间，链接器将使用包含您的函数的 SIZEOF(...) 部分填充该全局变量。它依赖于链接器，并非所有链接器都提供此功能。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-11T05:10:27.117

如上所述，函数大小由编译器在编译时生成，所有大小在链接时对链接器都是已知的。如果你必须这样做，你可以让链接器踢出一个包含起始地址、大小，当然还有名字的映射文件。然后，您可以在代码中在运行时解析它。但我认为没有一种可移植的、可靠的方法可以在运行时计算它们而不超出 C 的范围。

linux 内核类似地使用它来进行运行时分析。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-04-08T13:12:36.300

有一种有趣的方法可以发现函数的大小。

```
#define RETN_empty 0xc3
#define RETN_var   0xc2  
typedef unsigned char BYTE;
size_t FunctionSize(void* Func_addr) {
    BYTE* Addr = (BYTE*)Func_addr;
    size_t function_sz = 0;
    size_t instructions_qt = 0;
        while(*Addr != (BYTE)RETN_empty && *Addr != (BYTE)RETN_var) {
            size_t inst_sz = InstructionLength((BYTE*)Addr);
            function_sz += inst_sz;
            Addr += inst_sz;
            ++instructions_qt;
        }
    return function_sz + 1;
} 
```

但是您需要一个返回指令大小的函数。您可以在此处找到查找指令长度的函数：[获取汇编指令的大小](https://stackoverflow.com/questions/23788236/get-size-of-assembly-instructions)。这个函数基本上一直检查函数的指令，直到找到要返回的指令（RETN）[0xc3，0xc2]，并返回函数的大小。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-10T07:01:38.310

C 没有垃圾收集器。有一个指向某物的指针不会让它留在内存中。

函数始终在内存中，无论您是否使用它们，无论您是否保留指向它们的指针。

动态分配的内存可以被释放，但它与保持指向它的指针无关。您不应该保留指向已释放内存的指针，并且应该在丢失指向它的指针之前释放它，但是语言不会自动执行此操作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-06-10T09:59:22.090

如果有类似函数大小的东西，它应该是它的堆栈帧大小。或者更好的是，请尝试考虑一下，根据您的说法，函数的大小应该是多少？你的意思是它的静态大小，即它加载到内存中时所有操作码的大小？如果这是你的意思，那么我看不出他们有任何语言提供的功能来找出它。也许你在寻找一些hack。可以有很多。但我还没有尝试过。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-09-12T06:24:25.463

```
#include<stdio.h>

int main(){
    void demo();
    int demo2();
    void (*fun)();
    fun = demo;
    fun();
    printf("\n%lu", sizeof(demo));
    printf("\n%lu", sizeof(*fun));
    printf("\n%lu", sizeof(fun));
    printf("\n%lu", sizeof(demo2));
    return 0;
}

void demo(){
    printf("tired");    
}

int demo2(){
    printf("int type funciton\n");
    return 1;
} 
```

希望您能得到答案，所有功能都存储在某个地方

这里是代码的输出

![以上代码的输出](../Images/0d83b8f3f71af4c21a519e828a2569ad.png)

# c# - 关于asp.net webAPI的一些问题

> ID：10966857
> 
> 赞同：3
> 
> 时间：2012-06-10T06:46:56.360
> 
> 标签：c#, asp.net, wcf-web-api

我现在正在构建一个在服务器端使用 asp.net webAPI 的应用程序，我遇到了关于验证的问题：

我想为多平台提供我的webAPI，就像浏览器的javascript，或者windows phone等等，所以我决定用HTTP-BASIC隐式验证，“（原谅我的英语不好），问题是，在过去的时间。

我总是在SESSION中获取一些用户信息，但是我们知道RESTful风格的webAPI是无会话状态的，那么如何存储用户信息：

我得到了一些想法，我希望你能帮助我做出正确的选择，非常感谢

1\. 将除用户密码等重要信息外的信息放入浏览器的cookie中。每次我发出http请求时，我都会获取cookies。在服务器端，我可以查询用户的信息。并进行其他步骤。（该序列不适用于移动平台，因为cookies仅在浏览器中）

2.用户HTTP-BASIC验证，每次服务器获取httpRequest，获取HTTP-Headers中的用户名和密码，服务器端也可以查询用户信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T07:13:16.380

我见过的大多数 REST API 都通过以下两种方式之一处理身份验证：

1.  HTTP 标头，无论是基本身份验证，还是一些用于传递凭据的自定义标头。这将是您的选择 2。这仅在您通过 HTTPS 运行时才真正好用，因为凭据将在标头中以明文形式显示。
2.  使用一对令牌，一个作为标识符（有点像用户名）和一个在客户端和服务器之间共享的秘密（有点像密码）。然后由标识符、请求参数的部分和秘密组成散列。然后将该哈希和标识符与请求一起发送。服务器知道秘密，然后使用相同的方法计算哈希，并确保它们匹配（亚马逊网络服务使用这种方法，以及任何使用 OAuth 的方法）。

更多的 Web API 似乎正在迁移到这里的第二种方法，因为它与基本身份验证不同，可以抵抗篡改和重放攻击。当然，它更复杂。

[OAuth 的RFC 5849 第 3.4 节](https://www.rfc-editor.org/rfc/rfc5849#section-3.4)，虽然干读，但通过了用于创建哈希的过程，如果您愿意，可能是实施的一个很好的起点。[OAuth Google Code 网站上提供了](http://oauth.googlecode.com/svn/code/csharp/OAuthBase.cs)C# 的基本实现，这可能是一个更好的选择。

# sql - 在 XML 数据类型中存储特殊字符（例如 &）

> ID：10966858
> 
> 赞同：5
> 
> 时间：2012-06-10T06:47:02.037
> 
> 标签：sql, sql-server, xml, sql-server-2008

如果我做

```
Declare @t table(Email xml)
Declare @email varchar(100) = 'xxx&xx@monop.com'
Insert into @t  
select '<Emails> <Email>' + @email +'</Email></Emails>'
select * From @t 
```

我会收到预期的错误

**消息 9411，级别 16，状态 1，第 8 行 XML 解析：第 1 行，字符 27，需要分号**

我几乎在任何地方（包括 SO）都找到了一种解决方案，`replace '&' with '&amp;`它可以工作

```
Insert into @t  
select CAST('<Emails><Email>' + REPLACE(@email, '&', '&amp;') + '</Email></Emails>' AS XML) 
```

**输出**

```
<Emails><Email>xxx&amp;xx@monop.com</Email></Emails> 
```

但是，我正在尝试使用 CData 方法（只是解决问题的另一种方法）

```
Declare @t table(Email xml)
Declare @email varchar(100) = 'xxx&xx@monop.com'
Insert into @t  
Select CAST('<![CDATA[Emails> <Email>' + @email + '</Email> </Emails]]>' AS XML)
select * From @t 
```

当我得到以下输出时

```
Emails&gt; &lt;Email&gt;xxx&amp;xx@monop.com&lt;/Email&gt; &lt;/Emails 
```

我想要实现的是按原样存储数据，即所需的输出应该是

```
<Emails><Email>xxx&xx@monop.com</Email></Emails> 
```

有可能吗？

我知道如果 xml 无法理解的任何其他特殊字符将作为输入传递给它，则替换函数将失败，例如 '<' i 在这种情况下，我们需要再次替换它......

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T06:52:36.937

标签是 PCDATA，而不是 CDATA，所以不要将它们放在 CDATA 部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-10T08:27:15.717

当您使用 XML 时，您应该使用 SQL Server 的与 XML 相关的功能。

例如：

```
/* Create xml and add a variable to it */
DECLARE 
    @xml xml = '<Emails />',
    @email varchar(100) = 'xxx&xx@monop.com';

SET @xml.modify ('insert (
    element Email {sql:variable("@email")}
) into (/Emails)[1]');

SELECT @xml;

/* Output:
<Emails>
  <Email>xxx&amp;xx@monop.com</Email>
</Emails>
*/

/* Extract value from xml */

DECLARE @email_out varchar(200);

SET @email_out = @xml.value ('(/Emails/Email)[1]', 'varchar (200)');

SELECT @email_out; /* Returns xxx&xx@monop.com */ 
```

祝你好运

罗马

# jquery - 将 jquery 时间选择器添加到表中动态添加的行

> ID：10966861
> 
> 赞同：0
> 
> 时间：2012-06-10T06:47:48.520
> 
> 标签：jquery, html, timepicker

嗨，我在我的页面中创建了一个表格，在其中我使用了 timepicker 功能作为输入元素，并使用下面的函数，每当我到达表格的最后一行时，我都会在表格中添加一个新行：

```
<script type="text/javascript">
    $(document).ready(function(){
    $("#myTable tr:last input").live("click",function(){
    $(this).parent().parent().clone().appendTo("#myTable");
    }); 
    }); 
   </script> 
```

这很好用，我在表中添加了 jquery timepicker：

```
<link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/darkness/jquery-ui.css" rel="stylesheet" type="text/css"/>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script>
<link href="../css/jquery.ui.timepicker.css" rel="stylesheet" />
<script src="../js/jquery.ui.timepicker.js"></script>
  <script>
  jQuery(function($){
    $('#element1').timepicker();
    $('#element2').timepicker();
    $('#element3').timepicker();
    $('#element4').timepicker();
}); 
```

我在页面中的表格如下：

```
<table id="myTable" class="timingtable" border="1" cellpadding="0" cellspacing="0" align="left" style="width:100%; height:170px;">
  <tr>
    <th>Start time</th>
    <th>End time</th>
    <th>Family</th>
  </tr>
  <tr>
    <td><input type="text" name="start" id="element1" value=""></td>
    <td><input type="text" name="end" id="element2" value="" ></td>
    <td><input type="text"/></td>
  </tr>
  <tr>
   <td><input type="text" name="start" id="element3" value=""></td>
    <td><input type="text" name="end" id="element4" value="" ></td>
    <td><input type="text"/></td>
  </tr>
</table> 
```

在这里，我需要动态地将 Jquery Timepicker 功能添加到表中新添加的行中，我该怎么做？非常感谢任何帮助....在此先感谢....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T06:58:51.883

将字段设置为“datefield”类（或者更好，开始使用输入类型“date”），然后执行以下操作：

```
$(document).on("load", ".datefield", function(e){
    $(this).timepicker();
}); 
```

# javascript - 检测悬停并单击透明 div

> ID：10966862
> 
> 赞同：0
> 
> 时间：2012-06-10T06:47:53.440
> 
> 标签：javascript, jquery, hover

我觉得这个问题之前一定有人问过，但我一定不知道正确的术语才能找到答案。

我有一个`transparent`作为命中区域的 div。当用户将鼠标悬停在该区域上时，菜单栏会在屏幕上显示动画。问题是如果光标移到这个菜单上，隐藏菜单的动画就会开始。它感觉不到光标在它上面。我可以通过使点击区域的 z-index 高于菜单来解决这个问题，但是菜单按钮是不可点击的。

这是我的代码。有任何想法吗？

[http://jsfiddle.net/92dYt/1/](http://jsfiddle.net/92dYt/1/)

**CSS**

```
#menu{
  position:fixed;
  top:-40px;
  left:0px;
  width:100%;
  height:40px;
  background-color:#000;
  z-index:50;
}​
#hitarea{
  position:fixed;
  top:0px;
  left:0px;
  width:100%;
  height:150px;
  background-color:#eee;
  z-index:49;
  opacity:0;
} 
```

**HTML**

```
<div id="menu"></div>
<div id="hitarea"></div> 
```

**JAVASCRIPT**

```
$("#hitarea").hover(
    function () {
        $('#menu').delay(500).animate({
            top: 0
          }, 500, function() {
            // Animation complete.

        }); 
    }, 
  function () {
    $('#menu').delay(500).animate({
        top: -40
      }, 500, function() {
        // Animation complete.

    }); 
  }
); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T07:01:25.437

您可能希望将点击区域作为背景嵌套在菜单中，并使用 mouseenter 而不是 hover 来编写您自己的悬停行为。

[http://api.jquery.com/mouseenter/](http://api.jquery.com/mouseenter/)

您可以从示例中看到 mouseover 会为每个子对象触发，而 mouseenter 只会触发一次。（尽管如果嵌套，该解决方案也可能适用于悬停。）

# javascript - DOM Mutation Observers 的跨浏览器支持情况如何？

> ID：10966864
> 
> 赞同：11
> 
> 时间：2012-06-10T06:48:16.167
> 
> 标签：javascript, html, dom, mutation-observers

我用[谷歌搜索](https://www.google.com.au/webhp?sourceid=chrome-instant&ie=UTF-8&ion=1#hl=en&safe=off&sclient=psy-ab&q=dom+mutation+observers+support&oq=dom+mutation+observers+support&aq=f&aqi=&aql=&gs_l=hp.3...69.32879.0.32981.37.32.2.0.0.0.326.6714.2-27j3.30.0...0.0.xsxdy9m5QyQ&pbx=1&bav=on.2,or.r_gc.r_pw.r_cp.r_qf.,cf.osb&fp=6fe1c4b9df5a02ef&ion=1&biw=1440&bih=712)但找不到答案。

此功能是否有可用的跨浏览器兼容性矩阵？

如果有人想知道答案，这里是：[Mutation Observers vs Mutation Events/Browser Availability](http://code.google.com/p/mutation-summary/wiki/DOMMutationObservers#Browser_Availability)。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-10T08:19:08.290

Ido Green 提供了答案，但为了清楚起见，我将在此处发布链接文档的相关片段。

[https://developer.mozilla.org/en-US/docs/DOM/Mutation_events](https://developer.mozilla.org/en-US/docs/DOM/Mutation_events)

> 现在不推荐使用 DOM 突变事件。
> 
> 由于 API 的设计存在缺陷，突变事件在 DOM 事件规范中已被标记为已弃用（请参阅公共 webapps 的“DOM 突变事件替换：迄今为止的故事/现有共​​识点”中的详细信息）。
> 
> 避免突变事件的实际原因是性能问题和跨浏览器支持。
> 
> 这些正在被 DOM Mutation Observers 所取代。

[https://developer.mozilla.org/en-US/docs/DOM/MutationObserver](https://developer.mozilla.org/en-US/docs/DOM/MutationObserver)

> Mutation Observers 为开发人员提供了一种对 DOM 中的变化做出反应的方法。它旨在替代 DOM3 事件规范中定义的突变事件。
> 
> *   [简要概述](http://updates.html5rocks.com/2012/02/Detect-DOM-changes-with-Mutation-Observers)
> *   [更深入的讨论](http://hacks.mozilla.org/2012/05/dom-mutationobserver-reacting-to-dom-changes-without-killing-browser-performance/)
> *   [Chromium 开发人员 Rafael Weinstein 的截屏视频](http://www.youtube.com/watch?v=eRZ4pO0gVWw)
> *   [突变摘要库](http://code.google.com/p/mutation-summary/)
> *   定义`MutationObserver`接口[的 DOM4 规范](http://dvcs.w3.org/hg/domcore/raw-file/tip/Overview.html#mutation-observers)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-10T06:51:29.073

此功能（DOM 突变）适用于 Chrome 18。您可以在此处查看更多详细信息：http: [//updates.html5rocks.com/2012/02/Detect-DOM-changes-with-Mutation-Observers](http://updates.html5rocks.com/2012/02/Detect-DOM-changes-with-Mutation-Observers)

如果您想检查“任何”HTML5 功能和支持它的浏览器：http: [//caniuse.com/](http://caniuse.com/)就是这个地方。其他重要来源是：[http ://html5please.com/](http://html5please.com/)

# javascript - 在javascript中计算减法运算返回不正确的值

> ID：10966867
> 
> 赞同：0
> 
> 时间：2012-06-10T06:48:41.380
> 
> 标签：javascript

这是我的 javascript 代码：

```
var dsum = 0.0;
$.each($("#Report tbody tr"), function () {
    var x = 0.0;

    if ($(this).find("td:eq(3) div").html() != "&nbsp;")
        x = parseFloat($(this).find("td:eq(3) div").html().replace(/,/g, ""));

    dsum += x;

});

var csum = 0.0;

$.each($("#Report tbody tr"), function () {
     var x = 0.0;
     if ($(this).find("td:eq(4) div").html() != "&nbsp;")
         x = parseFloat($(this).find("td:eq(4) div").html().replace(/,/g, ""));
         csum += x;

});

var  lastEvenRow=$("#Report").find("tr:last").hasClass('erow');
$("<tr id='LastRow'><td colspan='3' style='border-top: 1px solid #DDDDDD;'><div style='padding:5px;text-align:right;'>Total :</div></td><td style='text-align:center;height:22px;border-top: 1px solid #DDDDDD;'><div style='padding:5px;'>" + dsum.toString(10).replace( /(\d)(?=(\d\d\d)+(?!\d))/g , "$1,") + "</div></td><td style='text-align:center;border-top: 1px solid #DDDDDD;'><div style='padding:5px;'>" + csum.toString(10).replace( /(\d)(?=(\d\d\d)+(?!\d))/g , "$1,") + "</div></td><td style='text-align:center;border-top: 0px solid #DDDDDD;'><div style='padding:5px;border-top: 1px solid #DDDDDD;'>" + (dsum > csum ? (dsum - csum).toString(10).replace( /(\d)(?=(\d\d\d)+(?!\d))/g , "$1,") : "&nbsp;") + "</div></td><td style='text-align:center;'><div style='padding:5px;'>" + (csum >= dsum ? (csum - dsum).toString(10).replace( /(\d)(?=(\d\d\d)+(?!\d))/g , "$1,") : "&nbsp;") + "</div></td></tr>").appendTo("#Report tbody");
if(lastEvenRow==false)
    $("#LastRow").addClass("erow"); 
```

![在此处输入图像描述](../Images/c360daf3e906513e111c240598426d43.png)

正如我在图片中提到的，我认为结果一定是 104,889.01 但是，如您所见，这是不正确的值

有没有人可以帮助我？抱歉我的英语语法不好（我是英语新手）

**更新1**：

1318114.01 - 1213225 必须是 104889.01 ，那么为什么 javascript 返回 104889.01000000001 呢？！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T06:52:50.907

发生这种情况是因为它适用于从二进制到十进制的转换，然后我们有近似值，其结果是大浮点数。看：

```
var i = 1;//1
i += .1;//1.1
i += .1;//1.2000000000000002 
```

您可以尝试自己的近似值：

```
var result = Math.round((1318114.01-1213225)*1000)/1000; 
```

# jquery-mobile - jquery mobile固定标题中的图像与内容重叠，直到调整大小事件

> ID：10966869
> 
> 赞同：10
> 
> 时间：2012-06-10T06:49:19.667
> 
> 标签：jquery-mobile

我的 jquery 移动固定标题中有一张图片。当页面在 Google Chrome 或 Apple Safari 中加载时，标题内容与标题下方的内容 div 重叠，直到我调整页面大小。Firefox 和 IE 工作得很好。

谢谢！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-06-19T22:50:23.607

I think the problem is that when jQuery Mobile initializes the page, the header image is not loaded and the header is much smaller so jQuery Mobile puts a padding on the `.ui-page` element that is too small once the image loads. A simple fix for this is to manually set the size of the header image so that it takes-up it's required space even before its source loads.

You could also do this, although it seems pretty hacky to me, force a redraw by triggering the `resize` event on `document.ready` or maybe `window.load`:

```
$(window).on('load', function () {
    $(this).trigger('resize');
}); 
```

I pasted this code into the console while on your page and it re-positioned the title element as expected.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-19T13:57:32.113

应用以下 CSS 有帮助吗？

```
.ui-page {
    padding-top: 91px !important;
} 
```

*请注意，您必须优化选择器，因为这也适用于覆盖弹出窗口。*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-01-07T21:06:11.180

*我使用了Jasper*和*Carlos487*提供的相当好的解决方案，**发现这是最新且最可靠的方法（jQM 1.4.x）**：

1.  **如果**这是**由于没有指定尺寸的图像**需要一些时间来加载并因此可能导致标题放大，那么**指定已知尺寸（最好通过 CSS）应该这样做**。否则应该有一种方法来确定它是否已经完成加载，从而应用下面解决方案 3 的想法。

2.  **如果**这是由于某些（可能）**未知的标头调整大小事件**（例如，通过稍后加载的某些图像或某些其他内容缩小标头并因此使其垂直变大），那么这应该与一个合理**的足够大的超时值**一起使用：

    ```
    $( ':mobile-pagecontainer' ).on( 'pagecontainershow', function(e) {
      // maybe value > 100 needed for your scenario / page load speed
      setTimeout( function() { $(window).trigger('resize'); }, 100 /*ms*/ );
    } 
    ```

3.  **如果您知道是什么原因造成** *的（在我的情况下，我通过一些（否则隐藏/覆盖的）左对齐导航面板在大屏幕上右移页面内容）*，那么以下可能会更好，**与蜜蜂无关页面需要**在某些设备或场景上加载的实际时间（可能比您上面预定义的超时时间长）：

    ```
    // if its due to some animation like in my case
    // otherwise try to find a similar way to determine when the resizing event has 
    // completed!
    $('#someAnimated').animate( 'complete', function() { $(window).trigger('resize'); }); 
    ```

（我不确定*Jasper*使用的解决方案`$(window).on( 'load', ...`在所有 jQM 页面加载场景（使用 AJAX 页面导航）中是否正确。这就是为什么我在我的示例中更喜欢*Carlos487*的方法。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-20T00:22:47.450

我遇到了很多麻烦。这一直有效，直到我想添加一个链接：

```
<div data-role="header">
  <img border="0" src="logo.png" style="float:left;display:inline"/> <h1></h1>
</div> 
```

注意空的 h1 标签。

我最终根本没有使用 data-role="header" ，我只是无法让它与链接一起使用。我改用了 ui-bar 类。像这样：

```
<div class="ui-bar ui-bar-a">
    <a href="/" data-role="none">
        <img border="0" src="images/logo.png" style="float: left; display:inline">
    </a>
</div> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-12-12T21:28:21.497

对我有用的基于@Jasper 答案的解决方案是：

```
$(document).on('pageshow', "div[data-role='page']", function () {
    $(window).trigger('resize');
}); 
```

它具有适用于所有**jquery 移动页面的改进**

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-06-30T12:21:30.370

上述解决方案都不适合我。但我发现我的问题在于页面导航后的事件。如果内容 div 在此期间被隐藏，它不会被定位在标题 div 下，而是留在原来的位置：

```
$(document).on("pageshow", "div[data-role='page']", function()
{
   $("#pageContentDiv").hide();
   setTimeout(function()
   {
      $("#pageContentDiv").show();
   }, 0);
}); 
```

**编辑：** 找到更好的解决方案；将标题 div 高度和页面 div 顶部填充设置为相同的值：

```
<div data-role="page" style="padding-top: 60px">
<div data-role="header" data-position="fixed" style="height: 60px"> 
```

希望这可以帮助。

# html - html复选框网址

> ID：10966877
> 
> 赞同：2
> 
> 时间：2012-06-10T06:50:47.780
> 
> 标签：html, url, checkbox

是否可以创建一个 html 复选框表单，该表单将输出为 url 格式，例如：

```
?cat=cars+tree 
```

目前给出这个：

```
<form name="input" action="/" method="post" >
<br />Select Categories: <br />
<input type="checkbox" name = "cat" value="cars" /> Cars <br />
<input type="checkbox" name = "cat" value="tree"  /> Tree <br />
<input type="checkbox" name = "cat" value="drinks"  /> Drinks <br />
<input type="checkbox" name = "cat" value="food" /> Food <br /> <br />
<input type="submit" value="Submit" /> 
```

如果选择了汽车和树，它将创建这个：

```
?cat=cars&cat=tree 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-10T07:08:33.817

不，我担心纯 HTML 这是不可能的，因为在[HTML 4.01 规范的 W3C 推荐中，表单 URL 编码](http://www.w3.org/TR/html401/interact/forms.html#form-content-type)指定如下：

> **应用程序/x-www-form-urlencoded**
> 
> 这是默认的内容类型。使用此内容类型提交的表单必须编码如下：
> 
> 1.  控件名称和值被转义。空格字符被 `+' 替换，然后保留字符被转义，如 [RFC1738] 第 2.2 节所述：非字母数字字符替换为 `%HH'、一个百分号和两个代表 ASCII 码的十六进制数字特点。换行符表示为“CR LF”对（即，`%0D%0A'）。
>     
>     
> 2.  控件名称/值按照它们在文档中出现的顺序列出。名称与值之间用“=”分隔，名称/值对之间用“&”分隔。

# jquery - 使用 Jquery 加载一个 html 文件，延迟，然后是另一个，循环

> ID：10966879
> 
> 赞同：0
> 
> 时间：2012-06-10T06:51:03.513
> 
> 标签：jquery

我想展示一个 html 文件。然后淡入另一个。这是我的代码，它可以工作，除了第一次，它会等待 10 秒才能切换。然后在切换之后，它在切换之间等待 5 秒。我对 jquery 如何处理超时和等待有点困惑。我想每次切换等待 5 秒，从第一个切换开始。

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script>
$(document).ready(function() {
        $("#responsecontainer3").load("ad1.html");
  var refreshId = setInterval(function() {
     $("#responsecontainer3").fadeTo("slow").load('ad1.html?randval='+ Math.random());

setTimeout(function() 
  { 
     $("#responsecontainer3").fadeTo("slow").load('ad2.html?randval='+ Math.random());
  }, 5000); 

 }, 10000);

});
</script>
<div id="responsecontainer3">
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T19:34:27.213

```
<script>
 $(document).ready(function() {
        $("#responsecontainer3").load("ad2.html");

   var index = 1;
   var refreshId = setInterval(function() {
      $("#responsecontainer3").load('ad'+index+'.html');
      index = (index == 2)? 1 : index+1;
   }, 5000);
   $.ajaxSetup({ cache: false });
});
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T06:55:54.457

```
function loadFile(url) {
   $("#responsecontainer3").load(url, function() {
       var index = parseInt( url.replace('ad','').replace('.html','') );
       $("#responsecontainer3").fadeTo('slow', function() {
         setTimeout(function() {
             index++;
             loadFile('ad'+index+'.html');
         }, 5000)
       });
   });
}

loadFile('ad1.html'); 
```

# c++ - 如何过滤 IShellFolder::EnumObjects 结果

> ID：10966881
> 
> 赞同：3
> 
> 时间：2012-06-10T06:51:42.597
> 
> 标签：c++, visual-c++, windows-shell

我正在尝试创建一个 shell 树控件。我不希望从`IShellFilder::EnumObjects`调用返回的所有项目都显示在树上，因为我需要过滤诸如回收站和控制面板之类的项目。

我的代码如下所示：

```
IShellFolder* pDesktopFolder=NULL;
SHGetDesktopFolder(&pDesktopFolder);

LPITEMIDLIST pidlParent=NULL;
IShellFolder* pParentFolder = NULL;
pDesktopFolder->BindToObject(pidlParent,NULL, IID_IShellFolder, (LPVOID*)&pParentFolder);

IEnumIDList* pEnumIDList = NULL;
    SHCONTF SHFlag=NULL;
    SHFlag=SHCONTF_FOLDERS | SHCONTF_INIT_ON_FIRST_NEXT | SHCONTF_NONFOLDERS  | SHCONTF_INCLUDEHIDDEN;

HRESULT hr= pParentFolder->EnumObjects(NULL, SHFlag, &pEnumIDList);

if (NOERROR == hr)
{
     LPITEMIDLIST pidl = NULL, pidlAbs;
     CString csFileType;
     HTREEITEM hItem=NULL;
     while (NOERROR == pEnumIDList->Next(1, &pidl, NULL))
     {
        //Filter out control panel, recycle bin items and other non usable items
     }
} 
```

我不想获取每个项目的显示名称并对其进行字符串比较，因为名称可能会根据操作系统语言而改变。

可以根据每个项目的CLSID进行过滤吗？最好的方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-10T10:27:10.017

当您有一个 IShellFolder 和一个子 pidl 时，您可以使用它[`SHGetDataFromIDList(...,SHGDFIL_DESCRIPTIONID)`](https://docs.microsoft.com/en-us/windows/win32/api/shlobj_core/nf-shlobj_core-shgetdatafromidlista)来获取 pidl 目标的 CLSID。

也可以看看：

*   [我怎么知道一个目录真的是一个回收站？](https://devblogs.microsoft.com/oldnewthing/20080918-00/?p=20843)
*   [如何判断一个目录很奇怪并且应该从用户界面中排除？](https://devblogs.microsoft.com/oldnewthing/20080919-00/?p=20833)（在您的情况下，使用 shell 属性而不是文件属性）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-22T16:30:14.203

如果您只想拥有真正的文件系统项目（就像 BrowseForFolder 一样），那么您可以使用`GetAttributesOf(..)`并检查`SFGAO_FILESYSANCESTOR`，如果它没有属性，它不是文件系统项目..（zip 文件，控制面板， recyclebin 没有该属性）

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-10T09:06:34.280

解决了：

我做了这个并且它的工作，但我需要看看我在哪里可以获得其他文件夹的 GUID 列表：

```
ULONG nEaten=0;
    LPITEMIDLIST PidlCPanel;
    ULONG nCPAttrib = 0;
    HRESULT hr = pFolder->ParseDisplayName(NULL, NULL, _T("::{26EE0668-A00A-44D7-9371-BEB064C98683}"), &nEaten, &PidlCPanel, &nCPAttrib);
    BOOL bRes = ILIsEqual(pidl, PidlCPanel); 
```

# ios - UILabel 不变

> ID：10966883
> 
> 赞同：4
> 
> 时间：2012-06-10T06:52:08.457
> 
> 标签：ios, uilabel

我有两种看法。第一个有 2 个按钮，第二个有一个标签和一个按钮。我正在尝试根据按下的按钮更改标签的文本。在下面的代码中，我正在调用第二个视图的实例并尝试更改标签中的文本。但问题是文本没有改变。如果有人可以在这里帮助我，将不胜感激

```
@interface firstview : UIViewController {
    IBOutlet UIButton *button1;
    IBOutlet UIButton *button2;

    }

    @property(nonatomic, retain) IBOutlet UIButton *button1;
    @property(nonatomic, retain) IBOutlet UIButton *button2;

    -(IBAction)push:(UIButton *)sender;

    @end

    #import "firstview.h"
    #import "secondview.h"

    @implementation firstview

    @synthesize button1;
    @synthesize button2;

    -(IBAction)push:(UIButton *)sender{

    button1.tag = 1;
    button2.tag = 2;

    if(sender.tag == button1.tag){
    secondview *v2 = [[secondview alloc]initWithNibName:@"secondview" bundle:Nil];
    v2.title =@"first button";
    v2.l1.text = @"BUTTON1";
    [self.navigationController pushViewController:v2 animated:YES];
    [v2 release];
    }
    else if(sender.tag == button2.tag){
    secondview *v2 = [[secondview alloc]initWithNibName:@"secondview" bundle:Nil];
    v2.title =@"Select";
    v2.l1.text = @"BUTTON2";
    [self.navigationController pushViewController:v2 animated:YES];
    [v2 release];
    }

    }

    @end

second view

    #import <UIKit/UIKit.h>

    @interface secondview : UIViewController {
        IBOutlet UIButton *b2;
        IBOutlet UILabel *l1;

    }

    @property(nonatomic, retain)IBOutlet UIButton *b2;
    @property(nonatomic, retain)IBOutlet UILabel *l1;

    -(IBAction)pop:(id)sender;

    @end

    #import "secondview.h"

    @implementation secondview

    @synthesize b2;
    @synthesize l1;

    -(IBAction)pop:(id)sender{
    }

    @end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-10T07:01:57.280

在您尝试设置标签文本时，视图尚未加载到您的第二个视图控制器中，因此标签为零。

尝试在推送视图控制器后将调用移至

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T07:08:24.900

来自 jrturton：视图未加载到您的第二个视图控制器中，因此标签为 nil。您可以在 secondview 中声明一个 NSString 属性，您可以从 firstview 设置此属性的值，然后您可以将此值设置为 viewWillAppear 或 viewDidLoad 方法中的标签。

# python - python中的不可变对象在其值更改时会发生什么？

> ID：10966884
> 
> 赞同：5
> 
> 时间：2012-06-10T06:52:23.470
> 
> 标签：python, object, immutability

python中的不可变对象是否意味着它的值在它的概念之后不能改变？如果是这种情况，当我们尝试改变它的值时会发生什么。

让我试着用一个例子来解释我的疑问。

例如，我`S`用 value初始化了一个 String 对象`"Hello World"`。

```
S = 'Hello World' 
```

然后我在行中输入，

```
S = 'Hello Human' 
```

所以当我问解释器时，它告诉我 S 的值是`"Hello Human"`。显然，现在“S”有了新的价值。

价值如何变化？python 是否销毁了旧的字符串对象并使用新值创建了一个新对象？还是只是改变了旧对象的值。这与字符串对象是不可变的事实有什么关系吗？如果是这样，那么可变对象的行为如何？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-10T06:58:49.680

Python 停止`S`指向旧的字符串对象并使其指向一个新对象

```
>>> S="Hello World"
>>> id(S)
32386960
>>> S="Hello Human"
>>> id(S)
32387008
>>> 
```

你不能改变不可变的对象，所以即使你认为你可能（例如与`+=`操作员）你不是

```
>>> S="Hello"
>>> id(S)
32386912
>>> S+=" World"
>>> id(S)
32386960
>>> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-10T06:57:56.253

值没有改变。该**名称**已**绑定**到一个新对象。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-10T07:01:19.947

所以如果你正在做这样的事情：

```
>>> s = "Hello World"
>>> print s
"Hello World"
>>> old_s = s
>>> s = "Hello Human"
>>> print s
"Hello Human"
>>> print old_s
"Hello World" 
```

你可以看到 Python 中的字符串是不可变的（字面意思——你不能改变它们）。

当您添加到字符串（或其他不可变对象，如元组或整数）时，会创建该对象的新副本并删除对旧副本的*引用。*（当不再引用该对象时，Python 会为您处理垃圾收集）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-10T06:59:02.100

```
s = 'helloworld'
>>> id(s)
29779592
>>> s = 'hello'
>>> id(s)
29771680 
```

现在变量 S 引用新对象

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-10T10:57:20.737

> python中的不可变对象是否意味着它的值在它的概念之后不能改变？

是的。

> 如果是这种情况，当我们尝试改变它的值时会发生什么。

这个问题是无效的，因为你从不尝试改变它的值，因为没有办法改变尝试。

您真正要问的是，当我们**分配给一个名为 value 的变量**时会发生什么。

我希望您特别注意那里的“a”一词：多个变量可以命名相同的值。我还希望您特别注意“名称”这个词：Python 变量确实是名称——它们不存储值，而是为它们提供名称。

> 显然，现在“S”有了新的价值。

现在`S` **命名**一个不同的值。

> 价值如何变化？

它没有。`S`停止命名它曾经命名的名称，并开始命名一个新值。

> python是否破坏了旧的字符串对象

**如果**没有其他名称，它**可能**有。如果一个值没有名字，它**最终**会被销毁。作为程序员，这不是您关心的问题。

 ****> 并创造了一个具有新价值的新产品？

是的。

> 如果是这样，那么可变对象的行为如何？

The same way, when you assign to the name. Names are names, and values are values. (In this context, "object" and "value" mean the same thing.) Assignment is the process of causing a name to name a value. It doesn't matter if the object is mutable or not. Mutation is done in other ways. (Although you could make an argument that, for example, a `list` is really a list of names, and you don't really mutate the list, but instead change the quantity of names and their referents.)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-10T08:29:01.940

python中的变量只不过是绑定，所以当你使用赋值运算符时，你要么创建一个新的绑定，要么根据你可能使用的python版本替换以前的绑定......但我认为这是你不知道的实现细节不用担心。

字典/列表等可变对象可以通过各种方法改变其内部状态，无论是内部还是外部，不可变对象没有这样的方法，它们的状态只能在构造过程中设置，对象本身只能被销毁，除非它们被池化以提高性能原因...****

# c - 如何在 BST C 语言中删除子树？

> ID：10966889
> 
> 赞同：1
> 
> 时间：2012-06-10T06:53:13.483
> 
> 标签：c, binary-search-tree, subtree

我想做pop函数来删除节点的节点和子树。这是我的代码

```
void pop(struct data *node,int num)
{
    if(node)
    {
        if(node->num==num)
        {
            pop(node->left,num);
            pop(node->right,num);
            free(node);
            node=NULL;
        }
        else
        {
            if(num> node->num)
                pop(node->right,num);
            else if (num< node->num)
                pop(node->left,num);
        }
    }
}
void pre(struct data *node)
{
    if(node)
    {
        printf("%d ",node->num);
        pre(node->left);
        pre(node->right);
    }
}
void main()
{
    push(&root,37);
    push(&root,20);
    push(&root,45);
    push(&root,5);
    push(&root,15);
    push(&root,40);
    push(&root,50);
    pre(root);
    pop(root,5);
    pre(root);
    getchar();
} 
```

在我使用 pop 之前，Pre 函数运行良好。但是在我使用 pop 功能之后，它就中断了。谁能知道错误在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T06:57:43.710

在`pop`中，您正在做：`node=NULL;`-- 但这只会影响传递给函数的指针的副本，而不影响原始树中的指针。您的树保留了指向您现在已释放的数据的指针。下次您对树进行大量操作时，您尝试取消引用该指针，然后事情就崩溃了（至少您希望他们这样做——更糟糕的是，有时他们似乎可以工作）。

解决此问题的一种方法是将双指针传递给`pop`：

```
void pop(struct data **node, int num) { 

    if ((*node)->num == num)
        // ...
        free(*node);
        *node = NULL;
    }
} 
```

现在您正在更改树中的指针，而不是更改您的函数收到的它的副本。

不过，这仍然无法正常工作-您依赖于`pop(child, num);`销毁当前节点的子树，但是除非将它们`num`设置为相同的值，否则它们不会删除任何内容，只是沿着树向下移动对于具有匹配的节点`num`。

您可能希望一个函数遍历树找到您关心的节点，然后第二个函数从指定节点开始遍历树，并（无条件地）销毁该节点及其子树。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T08:44:50.617

那么你的 pop 函数应该是这样的：

```
struct data* pop(struct data *node,int num)
{
  struct data* temp=null;
if(node)
{
    if(node->num==num)
    {
      if(node->left)
        pop(node->left,node->left->num);
      if(node->right)
        pop(node->right,node->right->num);
      free(node);
    }
    else
    {
        if(num> node->num)
            temp=pop(node->right,num);
        else if (num< node->num)
            temp=pop(node->left,num);

       if(node->right==temp)
        node->right=null;
       else if(node->left==temp)
        node->left=null;
       return temp;
    }
 }
return node;
} 
```

只要您有逻辑从调用它的位置取消树的根，如果所需的节点调整为树的根，这将起作用。

# php - 如何在 PHP 中连接字符串？

> ID：10966893
> 
> 赞同：-5
> 
> 时间：2012-06-10T06:53:56.100
> 
> 标签：php

我正在做一个字符串连接：

```
$url = "http://www.majesticseo.com/reports/site-explorer/summary/"
       + $page['page_url'] + "&IndexDataSource=F"
       ; 
```

这就是我打印它时得到的：

```
0 
```

0从哪里来？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-10T06:55:29.513

这是因为您正在对非数字数据执行算术运算。请改用连接运算符 ( `.`)。

# xml - 第一个元素的 AS3 XML 问题

> ID：10966896
> 
> 赞同：0
> 
> 时间：2012-06-10T06:54:54.893
> 
> 标签：xml, actionscript-3

我今天遇到了这个困扰我的 XML 问题，但我找不到解决方案，因为我不知道如何表达它。我的 XML 文件如下所示：

```
<TEST>
  <ITEM_ID>0123
    <ITEM_SIZE>Medium</ITEM_SIZE>
    <ITEM_COLOR>Red</ITEM_COLOR>
  </ITEM_ID>
</TEST> 
```

一切正常（我可以找到一个随机元素，显示或删除它）并且可以获得我想要的信息，但唯一我无法使用 myXML_XML.ITEM_ID[0] 访问的东西应该说“0123”。我什么都没有，没有错误，什么都没有。当我检查 myXML_XML.ITEM_ID[0].ITEM_SIZE （放入 String Var 时，我得到 "Medium" ）。

我认为 XML 可能具有误导性，所以我尝试使用另一个文件：

```
<TEST>
      <ITEM_ID REF="0123">
        <ITEM_SIZE>Medium</ITEM_SIZE>
        <ITEM_COLOR>Red</ITEM_COLOR>
      </ITEM_ID>
    </TEST> 
```

在检查 myXML_XML.ITEM_ID[0].REF 或 myXML_XML.ITEM_ID[0].REF.text 时，这给了我相同的结果

有哪位好心人给我解惑？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T07:10:17.747

您的第一个 XML 模式似乎有点偏离，但仍然有效。您可能想尝试节点的 children() 方法。

`myXML_XML.ITEM_ID[0].children()[0] // This is the text node`

在另一个实际上更具可读性的示例中，您应该使用 @ 符号来访问属性

`myXML_XML.ITEM_ID[0].@REF`

这是一个完整的例子：

```
var test:XML = new XML(
    <foo>
        <bar id="4444">
            efghi
            <baz>1234</baz>
            <quux>6789</quux>
        </bar>
        <bar id="4445">
            zxcv
            <baz>4567</baz>
            <quux>9876</quux>
        </bar>
    </foo>
);

trace(test.bar[0].children()[0]); // efghi
trace(test.bar[1].@id); // 4445 
```

# google-maps - Google Maps API v3 - 数组和 InfoWindows

> ID：10966916
> 
> 赞同：0
> 
> 时间：2012-06-10T06:59:52.570
> 
> 标签：google-maps

一段时间以来，我一直在尝试为每个标记创建一个信息窗口，但无法使其正常工作。

这就是我想出的：

```
for(var i=0; i<markery.length; i++)
{
    var latt =  parseFloat(markery[i].attributes.getNamedItem("lat").nodeValue);
    var lon =   parseFloat(markery[i].attributes.getNamedItem("lon").nodeValue);
    var ikona_url = markery[i].attributes.getNamedItem("ikona").nodeValue;
    var nazwa = markery[i].attributes.getNamedItem("nazwa").nodeValue;
    var rozmiar = new google.maps.Size(30,23);
    var punkt_startowy = new google.maps.Point(0,0);
    var punkt_zaczepienia = new google.maps.Point(15,12);
    var ikona = new google.maps.MarkerImage(ikona_url, rozmiar, punkt_startowy, punkt_zaczepienia);
    markert.push(new google.maps.Marker({
                    position: new google.maps.LatLng(latt,lon),
                    title: nazwa,
                    icon: ikona,
                    map: map,
                    content: nazwa
                }));

    google.maps.event.addListener(marker, 'click', function() {
        var info = new google.maps.InfoWindow({content: this.content});
    });
} 
```

完整的代码是：

```
<script type="text/javascript">

var map;
var marker1;
var markert = [];
var lati;
var loni;
var infowindow; 
```

我开始地图：

```
 function initialize() {

  lat = 50.42952;
  long = 15.60059;
  var latlng = new google.maps.LatLng(lat, long);
   var myOptions = {
        zoom: 5,
        center: latlng,
        mapTypeId: google.maps.MapTypeId.ROADMAP,
        draggableCursor:'crosshair',
                };

     map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
dymek = new google.maps.InfoWindow();

    google.maps.event.addListener(map, 'click', function(event) {
        add_marker(event.latLng, 'Your new marker', 'Your new marker' );
    });

} 
```

该函数获取点击点的地址：

```
 function findAddress(event) {
    var geocoder = new google.maps.Geocoder();
    geocoder.geocode({latLng: event.latLng}, function(results, status) {
      if (status == google.maps.GeocoderStatus.OK) {
        if (results[0]) {

          infoWindow.setContent(results[0].formatted_address);
          infoWindow.setPosition(event.latLng);
          infoWindow.open(map);
        }
      }
    });
  } 
```

此功能在我单击的地图上添加了一个新标记：

```
function add_marker( pos, pos_title, pos_str ) {

    marker1 = new google.maps.Marker( {
        position: pos,
        map: map,
        draggable: true,
        title: pos_title
    });

    map.setZoom(15);
    map.setCenter(marker1.getPosition());
    LoadMarkers();
                    } 
```

此函数加载我在上面的函数中创建的标记附近的附近点：

```
function LoadMarkers()
        {

var adres='add.xml?lat='+lati+'&long='+loni;
            jx.load(adres, function(xml)
            {
                var markery = xml.getElementsByTagName("marker");
                for(var i=0; i<markery.length; i++)
                {
                    var latt            =   parseFloat(markery[i].attributes.getNamedItem("lat").nodeValue);
                    var lon         =   parseFloat(markery[i].attributes.getNamedItem("lon").nodeValue);
                    var ikona_url   =   markery[i].attributes.getNamedItem("ikona").nodeValue;
                    var nazwa       =   markery[i].attributes.getNamedItem("nazwa").nodeValue;
                var markert     =   addMarkers(latt,lon,ikona_url,nazwa);

                }

            },'xml','get');
        } 
```

这个函数实际上是在地图上广告附近的标记。这些标记是我希望信息窗口显示的标记：

```
 function addMarkers(latt,lon,ikona_url,nazwa)
        {
            var rozmiar = new google.maps.Size(30,23);   
            var punkt_startowy = new google.maps.Point(0,0);   
            var punkt_zaczepienia = new google.maps.Point(15,12);     
            var ikona = new google.maps.MarkerImage(ikona_url, rozmiar, punkt_startowy, punkt_zaczepienia); 
            markert.push(new google.maps.Marker({
                         position: new google.maps.LatLng(latt,lon),
                         title: nazwa,
                         icon: ikona,
                         map: map,
                         animation: google.maps.Animation.DROP }));

 google.maps.event.addListener(markert, 'tilesloaded', function() {
    var info = new google.maps.InfoWindow({content: nazwa});
});

        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T03:41:33.920

您实际上并没有在任何时候打开信息窗口。请查看此[文档和示例](http://goo.gl/m8edf)，并相应地调整您的代码。您实际上需要`open`使用`infowindow`.

# iphone - NSString stringWithContentsOfFile:fileName 非英文字母

> ID：10966927
> 
> 赞同：2
> 
> 时间：2012-06-10T07:02:50.490
> 
> 标签：iphone, objective-c

我有一个由“\n”分隔的多行文件。其中一条是：

```
Christian Grundekjøn 
```

除非删除该行，否则我无法读取文件。我使用以下代码逐行读取：

```
for (NSString *line in [[NSString stringWithContentsOfFile:fileName encoding:NSUTF8StringEncoding error:NULL] componentsSeparatedByString:@"\n"]) 
```

如果我不删除该行，代码甚至根本不会进入 for 循环。什么都没读。如何处理非英文字母？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T08:50:28.163

如果您从 iOS 中生成文本文件，那么您需要确保使用 NSUTF8StringEncoding 对其进行编码。但鉴于您报告的问题，我怀疑您可能是从另一个来源提取数据，并且该来源没有将文本编码为 UTF8。如果是这种情况，您也许可以在您的应用程序之外解决问题，但将源文件转换为 UTF8。

如果你不知道使用了什么编码，例如因为用户提供了文件，iOS 可以尝试为你猜测它。我成功使用的一种模式是首先尝试使用 UTF8 编码获取字符串，例如使用您使用的相同方法。假设您编写了一个方法，您将文件名传递给该方法，以获取类似于以下内容的字符串：

```
- (NSString*) stringFromFile: (NSString*) filePath;
{    
     NSError* error = nil;
     NSString* stringFromFile = [NSString stringWithContentsOfFile: fileName
                                                          encoding: NSUTF8StringEncoding
                                                             error: &error];

     if (stringFromFile) return stringFromFile; // success

     NSLog(@"String is not UTF8 encoded. Error: %@", [error localizedDescription]);

     NSStringEncoding encoding = 0;
     NSError* usedEncodingError = nil;

     NSString* stringFromFile = [NSString stringWithContentsOfFile: path
                                                      usedEncoding: &encoding 
                                                             error: &usedEncodingError];

    if (stringFromFile)
    {
        NSLog(@"Retrieved string using an alternative encoding. Encoding was: %d", encoding);
        return stringFromFile;
    }

   // either handle error or attempt further explicit unencodings here

   return nil;
} 
```

在许多情况下，usedEncoding 效果很好。但是在某些极端情况下，试图找出编码可能非常棘手。这一切都取决于源文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T09:18:41.303

我对日文字符有疑问。我的解决方案是将文件保存到 doc 目录时

```
NSString *fileData = [NSString stringWithFormat:@"%@", noteContent];
BOOL isWriteToFile = [fileData writeToFile:notePath atomically:YES encoding:NSUTF8StringEncoding error:nil]; 
```

读取文件内容时

```
[[NSString alloc] initWithContentsOfFile:fullNotePath usedEncoding:nil error:nil]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-10T07:16:21.593

在文件中，以[unicode](http://en.wikipedia.org/wiki/Unicode)格式存储您的数据，或者您也可以以[unicode](http://en.wikipedia.org/wiki/Unicode)格式存储特殊字符。

# javascript - HTML 格式的选定文本从范围选择中返回空格

> ID：10966934
> 
> 赞同：0
> 
> 时间：2012-06-10T07:04:46.113
> 
> 标签：javascript

我有一个 Javascript 例程，它通过格式化为 HTML 的用户检索选择文本：

```
function getHTMLOfSelection() {
    var range;
    if (document.selection && document.selection.createRange) {
        range = document.selection.createRange();
        return range.htmlText;
    }
    else if (window.getSelection) {
        var selection = window.getSelection();
        if (selection.rangeCount > 0) {
            range = selection.getRangeAt(0);
            var clonedSelection = range.cloneContents();
            var div = document.createElement('div');
            div.appendChild(clonedSelection);
            return div.innerHTML;
        }
        else {
            return '';
        }
    }
    else {
        return '';
    }
} 
```

使用小提琴，确保首先选择引用的文本：

[http://jsfiddle.net/userdude/Y4BBq/13/](http://jsfiddle.net/userdude/Y4BBq/13/)

该代码工作正常，但是，选择`\r\n`在每个`</p>`and之后都包含一个`<br/>`。为什么要添加这些以及在什么时候添加？这似乎是多余的，因为`<p>`and`<br>`标记已经包含了新行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T20:39:06.787

根据 OP 的评论，如果您想返回没有换行符的 HTML，您可以使用正则表达式将`Carriage Return`( `\n`) 和`Line Feed`( `\r`) 字符全局替换为空字符串：

```
//apply this to remove line breaks from your strings, where str is the string
str = str.replace(/\n|\r/g, '');
//or directly in the return inside of your functions:
return range.htmlText.replace(/\n|\r/g, '');
return div.innerHTML.replace(/\n|\r/g, ''); 
```

这将删除所有换行符，请注意如果您选择文档的较长部分，HTML 将失去可读性。

[***JSFiddle***](http://jsfiddle.net/ult_combo/Y4BBq/22/)

# google-api - Google 凭据：此开发者帐户不拥有该应用程序

> ID：10966945
> 
> 赞同：11
> 
> 时间：2012-06-10T07:06:28.267
> 
> 标签：google-api, google-api-java-client

我正在使用 Google 客户端库并尝试`GET`向 Google Play API 发出请求。

```
 GoogleCredential credential= new GoogleCredential.Builder().setTransport(netHttpTransport)
                .setJsonFactory(jacksonFactory)
                .setServiceAccountId(CLIENT_ID)
                .setServiceAccountScopes(SCOPE)
                .setServiceAccountPrivateKeyFromP12File(file)
                .build();
                credential.refreshToken();     
        HttpRequestFactory requestFactory =netHttpTransport.createRequestFactory(credential);
        GenericUrl url = new GenericUrl(URI);
        HttpRequest request = requestFactory.buildGetRequest(url);
        HttpResponse response = request.execute(); 
```

我明白了

```
 {
  "code" : 401,
  "errors" : [ {
    "domain" : "androidpublisher",
    "message" : "This developer account does not own the application.",
    "reason" : "developerDoesNotOwnApplication"
  } ],
  "message" : "This developer account does not own the application."
} 
```

我的应用程序未发布，这会导致问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-29T11:17:15.873

我有同样的问题。发生这种情况是因为您在 Google API 中授权不拥有该应用程序的用户并尝试获取属于您的应用程序的数据。

在这个主题中，它得到了很好的描述。[http://support.google.com/googleplay/android-developer/bin/answer.py?hl=en&answer=2528691&topic=16285&ctx=topic](http://support.google.com/googleplay/android-developer/bin/answer.py?hl=en&answer=2528691&topic=16285&ctx=topic)

您应该通过 OAuth2 授权应用程序的所有者，然后使用 Google API 获取令牌。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-24T15:27:48.353

问题是您正在使用服务帐户 OAuth 2.0 流来授权 android-publisher API。我也是这样做的。然而，Google 要求使用 Web 服务器应用程序流程，这很荒谬，因为需要人工交互才能允许 API 访问。

幸运的是，有办法解决它。您只需要获取 refresh_token，将其存储并继续使用它以供将来的 API 调用。我在我的博客上[写了更详细的内容。](http://milancermak.wordpress.com/2012/08/24/server-side-verification-of-google-play-subsc/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T14:05:39.770

我们也遇到了这个问题，因为我们想在我们的服务器上验证购买以解锁某些功能。我们尝试了多种解决方案和框架，由社区用户甚至官方实现编写，但都没有奏效。

事实证明，我们所要做的就是更新我们的 OAuth 令牌（我们刚刚创建），然后一切都开始工作了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T14:22:20.573

我怀疑这个问题正是在出版中。您首先需要将您的应用程序绑定到您的（开发人员）帐户，然后您将收到 CLIENT_ID 和其他凭据（例如密钥等）。

# .htaccess - 播放直播，使用 RTMP 协议，隐藏实际 IP 与网站子域

> ID：10966947
> 
> 赞同：0
> 
> 时间：2012-06-10T07:07:04.633
> 
> 标签：.htaccess, redirect, streaming, rtmp, wowza

我必须播放使用 RTMP 协议的实时流媒体，并且我想用我网站的子域隐藏我的实际 IP。

我有一个 IP，即 46.xxx，当我使用下面给出的代码时，它可以工作：

```
<object width="550" height="400" data="http://www.hdwebplayer.com/standalone-demo/components/com_webplayer/player.swf" type="application/x-shockwave-flash">
<param value="http://www.hdwebplayer.com/standalone-demo/components/com_webplayer/player.swf" name="movie">
<param value="opaque" name="wmode"><param name="allowfullscreen" value="true" />
    <param value="&amp;stretch=uniform&amp;type=rtmp&amp;streamer=rtmp://46.x.x.x/live&amp;video=mychannel&amp;duration=9999&amp;autoStart=true" name="flashvars">
<param value="always" name="allowscriptaccess">
</object> 
```

但是当我尝试使用子域（例如 test.mysite.com）代替 IP 地址访问它时，它不起作用。

我试过的代码是：

```
<object width="550" height="400" data="http://www.hdwebplayer.com/standalone-demo/components/com_webplayer/player.swf" type="application/x-shockwave-flash">
<param value="http://www.hdwebplayer.com/standalone-demo/components/com_webplayer/player.swf" name="movie">
<param value="opaque" name="wmode"><param name="allowfullscreen" value="true" />
    <param value="&amp;stretch=uniform&amp;type=rtmp&amp;streamer=rtmp://test.mysite.com/live&amp;video=<?php echo $ch; ?>&amp;duration=9999&amp;autoStart=true" name="flashvars">
<param value="always" name="allowscriptaccess">
</object> 
```

我知道我必须在某些地方更改一些 apache 配置。但我不知道必须在哪个文件中编写什么代码（[这篇](http://www.actionscriptdeveloper.co.uk/running-apache-and-wowzaflash-media-serverred5-on-port-80-at-the-same-time/)文章建议，这在 .htaccess 中不起作用）

所以谁能帮帮我...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T13:22:47.930

您需要更改 DNS 设置以使 test.mysite.com 指向 46.xx.xx.xx 而不是您的 apache 网络服务器。

（请注意，因此您也可以不使用 test.example.com 来提供网页服务。换句话说；test.example.com 应该是未使用的子域。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T19:53:10.273

首先，我要感谢 Gerben ... :)

我在我的网站的 Cpanel 中使用 DNS 管理器添加了一条 A 记录，即**http://mysite.com/cpanel**

具有以下设置：

名称：test（它会自动检测已创建的子域，即 test.mysite.com。如果没有自动检测到，请输入完整的子域名称，例如 test.mysite.com [在我的情况下]）

地址：46.xxx

然后单击添加记录按钮。

这就是关于魔法的全部内容。现在它正在工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T12:42:59.663

通过这样做，您并没有真正隐藏您的 IP 地址。任何人仍然可以对主机名 (test.mysite.com) 进行 nslookup 并确定 IP 地址 (46.xyz)

# c# - 如何掌握所有 C# 功能特性？

> ID：10966949
> 
> 赞同：2
> 
> 时间：2012-06-10T07:07:48.043
> 
> 标签：c#, linq, lambda

我在 C# 中使用了很多 lambdas（多种风格的 LINQ、ASP.NET MVC 中的强类型助手、AutoMapper API 等），但我无法在自己的代码中开始使用 C# 功能特性，因为我不能弄清楚我可以用它们做什么很酷的事情。我大部分时间都直观地使用它们。

是否有关于此的任何参考或快速（但完整）指南。我不是在寻找 MSDN 参考，而是为了快速解释 C# 所有功能特性作为一个整体。如果可以将其范围缩小为包含一些博客文章链接的列表——这也是可以接受的。

**问题结束后更新**：似乎我的长解释不清楚，所以我会尝试缩小范围：我需要一个可以用来编写自己的代码的概念列表（不使用其他 API）。接受的答案是我需要的，谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-10T07:10:39.350

这是一篇很好的 CodeProject 文章，它解释了 C# 中引入的功能特性。它还为每个功能提供了易于理解的示例：

[C# 中的函数式编程](http://www.codeproject.com/Articles/375166/Functional-programming-in-Csharp)

文章提供了函数和一等值的解释和示例：

*   函数类型 - 委托、通用函数类型、谓词、动作
*   函数值 - 存储和传递函数作为参数
*   函数算术 - 加减函数

在那之后，文章讨论了 C# 中的函数式编程，涵盖了以下几点：

*   使用函数创建泛型结构
*   使用 LINQ
*   高阶函数——处理其他函数的函数，函数组合
*   异步函数 - 解释`BeginInvoke`、`IsCompleted`、`EndInvoke`和使用带有回调的异步函数
*   元组 - 动态数据结构
*   闭包 - 解释了委托和 lambda 函数中变量的范围，还解释了共享数据和缓存
*   使用高阶函数递归
*   偏函数 - 使用默认值减少函数参数的数量
*   Curry 函数 - 将 N 个参数函数分解为 N 个单参数函数

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T07:21:50.007

只是添加到 Ove 链接的文章中，因为我没有看到明确涵盖该方面：

函数式构造的使用允许将执行顺序与编写代码的顺序分开。这是因为调用定义的 lambda 可能发生在程序知道 lambda 的时间以外的某个时间。

这有时可能有点不直观（LINQ 中的延迟执行），但通常可以让您自由地将相关代码保持在一起，即使它在不同时间运行。

# javascript - 需要像谷歌文档这样的下拉菜单栏这样的应用程序

> ID：10966952
> 
> 赞同：0
> 
> 时间：2012-06-10T07:08:04.570
> 
> 标签：javascript, css, menu, menubar

我需要一个下拉菜单栏，就像谷歌文档中使用的那样。

例如这里： [https ://docs.google.com/document/d/18W9-fKs55wiFNjXL9q50PYOnR7-nnsImzJqHOPPbM4E/edit?pli=1](https://docs.google.com/document/d/18W9-fKs55wiFNjXL9q50PYOnR7-nnsImzJqHOPPbM4E/edit?pli=1)

顶部菜单是文件、编辑、查看、帮助。

我基本上希望能够在我的 CSS 应用程序中使用完全相同的菜单，Javascript 也可以。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T07:12:46.327

有许多 JS/CSS 类型的菜单系统。只需查看我们或使用此处提供的链接。它们都很容易定制

玩得开心。

[http://csswizardry.com/2011/02/creating-a-pure-css-dropdown-menu/](http://csswizardry.com/2011/02/creating-a-pure-css-dropdown-menu/)

[http://www.lwis.net/free-css-drop-down-menu/](http://www.lwis.net/free-css-drop-down-menu/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T11:46:28.997

经过大量谷歌搜索后，我发现了这个[http://www.jqueryload.com/jquery-dropdown-menu-with-google-style](http://www.jqueryload.com/jquery-dropdown-menu-with-google-style)

![在此处输入图像描述](../Images/ff4104f35fe75d500884869c38601f7b.png)

# c# - C# regex.split 从richtextbox 到范围excel

> ID：10966957
> 
> 赞同：0
> 
> 时间：2012-06-10T07:08:53.607
> 
> 标签：c#, .net, excel

我有 52 个项目存储在 RichTextBox 中，每行一个项目。所以我有52行。

我需要将 RichTextBox 中每一行的值写入 Excel 范围 C17:C42 & H17:H42

我使用一种代码在精确单元格中写入数组：

```
//for the first 26 data
range = objSheet.get_Range("C17:C42", Missing.Value);
object[,] numbers1 = new object[26, 1];
for (int i = 0; i <= 25; i++)
{
   numbers1[i, 0] = //here i want a read each line in richtextbox; 
}
range.Value2 = numbers1; 
```

下面是我如何阅读 RichTextBox 的每一行：

```
 string s = richTextBoxReceive.Text;
    var k = Regex.Split(s, "\\n", RegexOptions.Multiline);

    foreach (string str in k)
    {
        //do what you want
        MessageBox.Show(str);
    } 
```

我如何结合这些？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T07:35:32.320

我认为它会工作......

```
void insert( List<string> value)
{
    //for the first 26 data
    range = objSheet.get_Range("C17:C42", Missing.Value);
    object[,] numbers1 = new object[26, 1];
    for (int i = 0; i <= 25; i++)
    {
        //value contains the data
        numbers1[i, 0] = value[i];
    }
     range.Value2 = numbers1;
}

//Get value from richtextbox
string s = richTextBoxReceive.Text;
var k = Regex.Split(s, "\\n", RegexOptions.Multiline);
List<string> allvalue=new List<string>();

foreach (string str in k)
{
    allvalue.Add(str);
}
//call insert method to insert data into excell
insert(allvalue); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T15:09:08.367

好的，我已经自己解决了这个问题。我使用了一个数组并每行读取richtextbox。

```
range = objSheet.get_Range("C17:C42", Missing.Value);
object[,] numbers3 = new object[26,1];
for (int i = 0; i<= richTextBoxReceive.Lines.Length; i++)
{
    for (int j = 0; j <= 25; j++)
    {
        numbers3[j, 0] = richTextBoxReceive.Lines[j + 1];
    }
} 
```

# ruby-on-rails - 如果存在更新，否则创建。任何一种情况都返回记录

> ID：10966958
> 
> 赞同：3
> 
> 时间：2012-06-10T07:09:36.717
> 
> 标签：ruby-on-rails, ruby-on-rails-3

给定`guid`和`value`。如果存在记录`guid`，请更新其`value`. `guid`否则，使用该和创建一个新记录`value`。无论哪种情况，都返回记录，以便我可以得到它的主键`id`。

如何做到这一点：

*   尽可能少的数据库查询
*   尽可能少的代码

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-10T07:59:43.407

最简单的可能是

```
object = Model.find_or_initialize_by_guid(guid)
object.update_attributes :value => value 
```

它总是做 2 个查询（一个查找和一个插入/更新）

如果您提前知道碰撞不太可能发生，您可以这样做

```
begin
  Model.create(:guid => guid, :value => value)
rescue ActiveRecord::RecordNotUnique
  # find and update existing record
end 
```

这需要 guid 列上的唯一索引。它在更新案例中需要 3 个查询，但在创建案例中只需要 1 个查询。

This all assumes we are talking SQL - other datastores, such as mongodb, have the concept of an upsert (update or insert) operation

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T07:12:42.830

此代码将找到 value = params[:guid] 的对象。如果找到对象，它将返回该对象，否则它将实例化一个新对象，但尚未保存。

```
your_object = YOU_MODEL.find_or_initialize_by(params[:guid]) 
```

# sql - 为什么我没有来自数据库的数据？

> ID：10966960
> 
> 赞同：0
> 
> 时间：2012-06-10T07:09:38.277
> 
> 标签：sql, database, sql-server-2008-r2

我正在开发一个基于 Web 的 ASP.NET 应用程序，并且我正在使用 Telerik 工具。即使在我公司的生产服务器中也一切正常。现在，我们有另一个服务器，我们用它来测试我们正在开发的基于 Web 的应用程序。我将我的应用程序（包括它的数据库）从生产服务器复制到了这个测试服务器，但它在它上面运行不佳。它打开了网站，但数据库中没有数据，我不知道为什么？我`connectionstring`在 web.config 文件中有，我在生产服务器中有相同的东西，但仍然没有数据。

我没有更改应用程序中的任何内容，我使用的是 .NET 4，它安装在两台服务器中。一切都是一样的，但我不知道为什么我会收到这个错误。你有解决这个问题的办法吗？

**为什么应用程序在第一台服务器上工作，而在第二台服务器上却不工作？**

我的 web.config 文件是：

```
<configuration>
    <connectionStrings>
  <add connectionString="Data Source=localhost\sqlexpress;Initial Catalog=PMODServices;Integrated Security=True" name="PMODServicesConnectionString" providerName="System.Data.SqlClient" />
   </connectionStrings>
    <system.web>
         <customErrors mode="Off" />
        <compilation debug="true" targetFramework="4.0">
            <assemblies>
                <add assembly="System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A" />
                <add assembly="System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089" />
                <add assembly="System.Speech, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
                <add assembly="System.Web.Extensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
                <add assembly="System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089" />
                <add assembly="System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089" />
                <add assembly="System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089" />
                <add assembly="System.Xml.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089" />
                <add assembly="System.Data.DataSetExtensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089" />
                <add assembly="Microsoft.ReportViewer.WebForms, Version=10.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A" />
                <add assembly="Microsoft.ReportViewer.Common, Version=10.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A" />
                <add assembly="Microsoft.Build.Framework, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A" />
                <add assembly="System.Management, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A" />
            <!--    <add assembly="office, Version=14.0.0.0, Culture=neutral, PublicKeyToken=71E9BCE111E9429C"/>  -->
                <add assembly="stdole, Version=7.0.3300.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A" /></assemblies>
            <buildProviders>
                <add extension=".rdlc" type="Microsoft.Reporting.RdlBuildProvider, Microsoft.ReportViewer.WebForms, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" />
            </buildProviders>
        </compilation>
        <httpHandlers>
            <!-- <add path="Telerik.Web.UI.WebResource.axd" verb="*" type="Telerik.Web.UI.WebResource" validate="false" />-->
            <add path="Telerik.Web.UI.WebResource.axd" verb="*" type="Telerik.Web.UI.WebResource, Telerik.Web.UI" validate="false" />
            <add path="ChartImage.axd" verb="*" type="Telerik.Web.UI.ChartHttpHandler" validate="false" />
            <add path="Telerik.Web.UI.SpellCheckHandler.axd" verb="*" type="Telerik.Web.UI.SpellCheckHandler" validate="false" />
            <add path="Telerik.Web.UI.DialogHandler.aspx" verb="*" type="Telerik.Web.UI.DialogHandler" validate="false" />
            <add path="Telerik.RadUploadProgressHandler.ashx" verb="*" type="Telerik.Web.UI.RadUploadProgressHandler" validate="false" />
            <add path="Reserved.ReportViewerWebControl.axd" verb="*" type="Microsoft.Reporting.WebForms.HttpHandler, Microsoft.ReportViewer.WebForms, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" validate="false" />
        </httpHandlers>
        <authentication mode="Windows"/>

        <pages>
            <controls>
                <add tagPrefix="telerik" namespace="Telerik.Web.UI" assembly="Telerik.Web.UI" />
            </controls>
        </pages>
        <httpModules>
            <add name="RadUploadModule" type="Telerik.Web.UI.RadUploadHttpModule" />
            <add name="RadCompression" type="Telerik.Web.UI.RadCompression" />
        </httpModules>
    </system.web>

    <location path="Users/Telerik.Web.UI.WebResource.axd">
            <system.web>
                <authorization>
                    <allow users="*"/>
                </authorization>
            </system.web>
        </location>
        <location path="Telerik.Web.UI.WebResource.axd">
            <system.web>
                <authorization>
                    <allow users="*"/>
                </authorization>
            </system.web>
        </location>

    <system.webServer>
        <validation validateIntegratedModeConfiguration="false" />
        <handlers>
            <remove name="ChartImage_axd" />
            <remove name="Telerik_Web_UI_SpellCheckHandler_axd" />
            <remove name="Telerik_Web_UI_DialogHandler_aspx" />
            <remove name="Telerik_RadUploadProgressHandler_ashx" />
            <remove name="Telerik_Web_UI_WebResource_axd" />
            <add name="Telerik_Web_UI_WebResource_axd" path="Telerik.Web.UI.WebResource.axd" type="Telerik.Web.UI.WebResource" verb="*" preCondition="integratedMode" />
            <add name="ChartImage_axd" path="ChartImage.axd" type="Telerik.Web.UI.ChartHttpHandler" verb="*" preCondition="integratedMode" />
            <add name="Telerik_Web_UI_SpellCheckHandler_axd" path="Telerik.Web.UI.SpellCheckHandler.axd" type="Telerik.Web.UI.SpellCheckHandler" verb="*" preCondition="integratedMode" />
            <add name="Telerik_Web_UI_DialogHandler_aspx" path="Telerik.Web.UI.DialogHandler.aspx" type="Telerik.Web.UI.DialogHandler" verb="*" preCondition="integratedMode" />
            <add name="Telerik_RadUploadProgressHandler_ashx" path="Telerik.RadUploadProgressHandler.ashx" type="Telerik.Web.UI.RadUploadProgressHandler" verb="*" preCondition="integratedMode" />
            <add name="ReportViewerWebControlHandler" preCondition="integratedMode" verb="*" path="Reserved.ReportViewerWebControl.axd" type="Microsoft.Reporting.WebForms.HttpHandler, Microsoft.ReportViewer.WebForms, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" />
        </handlers>
        <modules runAllManagedModulesForAllRequests="true">
            <remove name="RadUploadModule" />
            <remove name="RadCompression" />
            <add name="RadUploadModule" type="Telerik.Web.UI.RadUploadHttpModule" preCondition="integratedMode" />
            <add name="RadCompression" type="Telerik.Web.UI.RadCompression" preCondition="integratedMode" />
        </modules>
    </system.webServer>
    <appSettings>
        <add key="Telerik.ScriptManager.TelerikCdn" value="Enabled" />
        <add key="Telerik.StyleSheetManager.TelerikCdn" value="Enabled" />
    </appSettings>
</configuration> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T12:28:57.123

您是否尝试过重新安装 Telerik 或将程序集放入 GAC 中？据我所知，telerik 需要的程序集比您在 VS 中添加的程序集更多作为参考才能正常运行。

# android - setBackgroundResource 的问题

> ID：10966964
> 
> 赞同：2
> 
> 时间：2012-06-10T07:10:11.647
> 
> 标签：android, android-view, setbackground

我在使用 setBackgroundResource 时遇到了奇怪的问题。由于某种原因，当我运行以下代码时，它没有设置背景。

layoutId 是我希望添加到另一个布局的 id。这是在此之前执行的，然后我运行此代码。

viewToBorderId 是该布局中视图的 ID。我希望围绕该视图放置边界。

```
 ViewGroup contentView = (ViewGroup) this.getLayoutInflater().inflate(layoutId, null);
    RelativeLayout contentScreenRoot = (RelativeLayout) this.findViewById(R.id.content_screen_root);
    RelativeLayout.LayoutParams lp = new RelativeLayout.LayoutParams(
        ((ScrollView) contentScreenRoot.findViewById(R.id.content_screen_scroll_view)).getLayoutParams());
    lp.addRule(RelativeLayout.BELOW, R.id.content_screen_user_details);
    lp.setMargins(2, 0, 2, 0);

    contentScreenRoot.addView(contentView, lp);
    ViewGroup contentViewParent = (ViewGroup) this.getLayoutInflater().inflate(layoutId, null);
    ViewGroup contentView = (ViewGroup) contentViewParent.findViewById(viewToBorderId);

    GradientDrawable gd ;
    gd = (GradientDrawable) contentView.getBackground();
    if (gd == null){
        contentView.setBackgroundResource(R.drawable.content_screen_borders_no_rounding);
        gd = (GradientDrawable) contentView.getBackground();
    }

    gd.setCornerRadii(new float[]{0,0,0,0,0,0,20-3,20-3});

    contentView.setBackgroundDrawable(gd); 
```

R.drawable.content_screen_borders_no_rounding

```
 <?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android"
    >
    <stroke
        android:width="@dimen/content_screen_scroll_view_border"
        android:color="@color/content_screen_scroll_view_border"
        />
    <padding
        android:left="0dip"
        android:top="@dimen/content_screen_scroll_view_border"             
        android:right="0dip" 
        android:bottom="@dimen/content_screen_scroll_view_border"
        />
    <gradient
        android:angle="270"
        android:startColor="@color/listview_selected_item_start"
        android:endColor="@color/listview_selected_item_end"
        android:type="linear"
        />
</shape> 
```

奇怪的是，如果我提前使用 android:background="@drawable/content_screen_borders_no_rounding" 设置背景，那么它可以正常工作。边框就在那里，当我为圆角做最后一点代码时，它就可以工作了。只有当我从代码中完成所有工作时，它才会失败。

插入其他布局的“基本”布局：

```
<?xml version="1.0" encoding="UTF-8"?> 
```

```
<RelativeLayout
    android:id="@+id/content_screen_secondary_title"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_marginBottom="5dip"
    >

    <ImageView 
        android:id="@+id/content_screen_icon"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:paddingLeft="20dip"
        android:paddingRight="20dip"
        android:layout_alignParentLeft="true"
        android:gravity="top|left"
        />

    <!-- The following RelativeLayout container is required to force the Hebrew text on some devices to appear at the right of the background image instead of the left on certain devices -->
    <RelativeLayout
        android:id="@+id/content_screen_helper"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_toRightOf="@id/content_screen_icon"
        android:background="@drawable/title_bg"
        android:layout_alignParentRight="true"
        android:gravity="center_vertical"
        android:layout_centerVertical="true"
        >

        <TextView
            android:id="@+id/content_screen_title_text"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:textColor="@color/content_text_color"
            android:textSize="18sp"
            android:textStyle="bold"
            android:gravity="center_vertical|right"
            android:layout_alignParentRight="true"
            android:paddingRight="25dip"
            />

    </RelativeLayout>

</RelativeLayout>

<RelativeLayout
    android:id="@+id/content_screen_user_details"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:background="@drawable/user_details_bg"
    android:layout_below="@id/content_screen_secondary_title"
    android:layout_marginBottom="4dip"
    android:layout_marginLeft="20dip"
    android:visibility="gone"
    >
    <!-- value for visibility can be either 'visible' or 'gone' -->

    <TextView
        android:id="@+id/content_screen_user_name_prompt"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:paddingRight="25dip"
        android:text="@string/content_screen_name_prompt"
        android:textSize="12sp"
        android:textColor="@color/content_text_color"
        android:layout_centerVertical="true"
        android:gravity="center_vertical"
        />
    <TextView
        android:id="@+id/content_screen_user_name"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_toLeftOf="@id/content_screen_user_name_prompt"
        android:paddingRight="5dip"
        android:textSize="12sp"
        android:textColor="@color/content_text_color"
        android:layout_centerVertical="true"
        android:gravity="center_vertical"
        />
    <TextView
        android:id="@+id/content_screen_user_id_prompt"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_toRightOf="@+id/content_screen_user_id"
        android:layout_centerVertical="true"
        android:paddingLeft="5dip"
        android:text="@string/content_screen_id_prompt"
        android:textSize="12sp"
        android:textColor="@color/content_text_color"
        />
    <TextView
        android:id="@+id/content_screen_user_id"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_centerVertical="true"
        android:paddingLeft="20dip"
        android:textSize="12sp"
        android:textColor="@color/content_text_color"
        />

</RelativeLayout>

<ScrollView
    android:id="@+id/content_screen_scroll_view"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_below="@id/content_screen_user_details"
    android:background="@drawable/content_screen_borders"
    android:layout_marginRight="10dip"
    android:layout_marginLeft="10dip"
    android:layout_marginBottom="10dip"
    android:layout_marginTop="@dimen/content_screen_scroll_view_margintop"
    android:visibility="gone"
    >
    <!-- Set visibility to gone, until the user calls the method: setMainContent(), which causes this ScrollView to become visible and also assigns it with its content -->

</ScrollView>

<!-- The following RelativeLayyout container is required to make the Hebrew text on some devices to start at the right of the background image instead of the left -->
<RelativeLayout
    android:id="@+id/content_screen_details_container"
    android:layout_width="150dip"
    android:layout_height="wrap_content"
    android:layout_marginRight="10dip"
    android:layout_above="@id/content_screen_scroll_view"
    android:background="@drawable/details_bg"
    android:gravity="center_vertical|right"
    android:layout_alignParentRight="true"
    android:visibility="invisible"
    >
    <!-- Value for visibility can be 'visible' or 'invisible' -->

    <TextView
        android:id="@+id/content_screen_details"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textColor="@color/content_text_color"
        android:layout_centerVertical="true"
        android:gravity="center_vertical|right"
        android:paddingRight="10dip"
        />

</RelativeLayout> 
```

然后我调用上面的代码来添加一些东西。

这是我要补充的东西：

```
<LinearLayout
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:orientation="vertical"
    >

    <ListView
        android:id="@+id/searchable_list_list_view"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" 
        android:paddingLeft="2dip" 
        android:paddingRight="2dip" 
        android:dividerHeight="1dip"
        android:footerDividersEnabled="true"
        android:listSelector="@drawable/listview_selected_item_background"
        android:fadingEdge="none"
        android:cacheColorHint = "#00000000"

        >

    </ListView>

</LinearLayout> 
```

我会调用上述方法，将布局作为第一个 id，将“searchable_list_list_view”的 id 作为发送。这告诉它在屏幕中插入此布局并在该特定视图周围放置边框。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T07:33:53.490

闪电战，

你说只有在你尝试用代码完成整个事情之后它才不起作用。这意味着您更改了代码以增强功能。在仔细检查了你的代码到最精细的细节之后，我相信这里的错误是你将 View 膨胀了两次，添加了一次，并更改了未添加的 View 的背景。这可能发生在进行更改时。我会解释：

在块的开头：

```
ViewGroup contentView = (ViewGroup) this.getLayoutInflater().inflate(layoutId, null); 
```

稍后，您添加了新视图：

```
contentScreenRoot.addView(contentView, lp); 
```

你还没有做任何背景的东西，那么我们进入下一部分。

```
ViewGroup contentViewParent = (ViewGroup) this.getLayoutInflater().inflate(layoutId, null); 
```

这与 contentView 具有相同的 ID，因此我们知道您正在膨胀相同的布局。但是，`addView`从来没有执行过，所以它只是坐在那里，稍后会消失。显然，您不能让父级和视图相同，因此您从父级获得了实际视图。

```
ViewGroup contentView = (ViewGroup) contentViewParent.findViewById(viewToBorderId); 
```

就是这样，除了有一个问题。首先，contentView 已经定义好了。其次，它在未添加的组中查找视图。它改变了新 contentView 的背景，但是因为它从未显示，所以不做任何其他事情。

**建议的解决方案：**

将您的代码更改为以下内容（注释说明更改）

```
// --> Rename this variable. It IS the inflated Parent and we only need to do this once.
  ViewGroup contentViewParent = (ViewGroup) this.getLayoutInflater().inflate(layoutId, null);
  RelativeLayout contentScreenRoot = (RelativeLayout) this.findViewById(R.id.content_screen_root);
  RelativeLayout.LayoutParams lp = new RelativeLayout.LayoutParams(
    ((ScrollView) contentScreenRoot.findViewById(R.id.content_screen_scroll_view)).getLayoutParams());
  lp.addRule(RelativeLayout.BELOW, R.id.content_screen_user_details);
  lp.setMargins(2, 0, 2, 0);

// --> Align the addView statement to use the new name
  contentScreenRoot.addView(contentViewParent, lp);

// --> Delete this line completely. (see? its the same ID)
//ViewGroup contentViewParent = (ViewGroup) this.getLayoutInflater().inflate(layoutId, null);

// Now this should be using the added ViewGroup, rather than the unadded one.
// AND it is not being redefined, like it was before.
  ViewGroup contentView = (ViewGroup) contentViewParent.findViewById(viewToBorderId);

  GradientDrawable gd ;
  gd = (GradientDrawable) contentView.getBackground();
  if (gd == null){
      contentView.setBackgroundResource(R.drawable.content_screen_borders_no_rounding);
      gd = (GradientDrawable) contentView.getBackground();
  }

gd.setCornerRadii(new float[]{0,0,0,0,0,0,20-3,20-3});

contentView.setBackgroundDrawable(gd); 
```

希望这可以帮助，

模糊逻辑

# ios - 枚举我的 iOS 应用程序中的所有钥匙串项

> ID：10966969
> 
> 赞同：44
> 
> 时间：2012-06-10T07:11:22.243
> 
> 标签：ios, security, keychain

以编程方式（从我的应用程序中）获取存储在钥匙串中的所有项目的最简单方法是什么？

它可能与 SecItemCopyMatching() 有关，但该函数的文档不是很清楚（我未能在网络上找到合适的示例）。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-07-26T15:37:15.123

`SecItemCopyMatching`这是正确的呼吁。首先，我们构建查询字典，以便在字典中返回项目的属性，并返回所有项目：

```
NSMutableDictionary *query = [NSMutableDictionary dictionaryWithObjectsAndKeys:
    (__bridge id)kCFBooleanTrue, (__bridge id)kSecReturnAttributes,
    (__bridge id)kSecMatchLimitAll, (__bridge id)kSecMatchLimit,
    nil]; 
```

由于`SecItemCopyMatching`至少需要返回`SecItem`的 s 的类，我们创建一个包含所有类的数组...</p>

```
NSArray *secItemClasses = [NSArray arrayWithObjects:
                           (__bridge id)kSecClassGenericPassword,
                           (__bridge id)kSecClassInternetPassword,
                           (__bridge id)kSecClassCertificate,
                           (__bridge id)kSecClassKey,
                           (__bridge id)kSecClassIdentity,
                           nil]; 
```

...对于每个类，在我们的查询中设置类，调用`SecItemCopyMatching`并记录结果。

```
for (id secItemClass in secItemClasses) {
    [query setObject:secItemClass forKey:(__bridge id)kSecClass];

    CFTypeRef result = NULL;
    SecItemCopyMatching((__bridge CFDictionaryRef)query, &result);
    NSLog(@"%@", (__bridge id)result);
    if (result != NULL) CFRelease(result);
} 
```

在生产代码中，您应该检查`OSStatus`返回的`SecItemCopyMatching`是`errSecItemNotFound`（未找到项目）或`errSecSuccess`（至少找到一个项目）。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2018-08-18T06:45:30.553

[@Cosmin 的 Swift 3 答案的](https://stackoverflow.com/a/44310869/814730)Swift **4**更新。

```
open func getAllKeyChainItemsOfClass(_ secClass: String) -> [String:String] {
    let query: [String: Any] = [
        kSecClass as String : secClass,
        kSecReturnData as String  : kCFBooleanTrue,
        kSecReturnAttributes as String : kCFBooleanTrue,
        kSecReturnRef as String : kCFBooleanTrue,
        kSecMatchLimit as String: kSecMatchLimitAll
    ]

    var result: AnyObject?

    let lastResultCode = withUnsafeMutablePointer(to: &result) {
        SecItemCopyMatching(query as CFDictionary, UnsafeMutablePointer($0))
    }

    var values = [String:String]()
    if lastResultCode == noErr {
        let array = result as? Array<Dictionary<String, Any>>

        for item in array! {
            if let key = item[kSecAttrAccount as String] as? String,
               let value = item[kSecValueData as String] as? Data {
                   values[key] = String(data: value, encoding:.utf8)
             }
         }
    }

    return values
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2017-06-01T14:53:36.300

Swift 3+ 版本也返回键（kSecAttrAccount）：

```
open func getAllKeyChainItemsOfClass(_ secClass: String) -> [String:String] {

        let query: [String: Any] = [
            kSecClass : secClass,
            kSecReturnData  : kCFBooleanTrue,
            kSecReturnAttributes : kCFBooleanTrue,
            kSecReturnRef : kCFBooleanTrue,
            kSecMatchLimit : kSecMatchLimitAll
        ]

        var result: AnyObject?

        let lastResultCode = withUnsafeMutablePointer(to: &result) {
            SecItemCopyMatching(query as CFDictionary, UnsafeMutablePointer($0))
        }

        var values = [String:String]()
        if lastResultCode == noErr {
            let array = result as? Array<Dictionary<String, Any>>

            for item in array! {
                if let key = item[kSecAttrAccount] as? String, 
                   let value = item[kSecValueData] as? Data {
                   values[key] = String(data: value, encoding:.utf8) 
                }
            }
        }

        return values
    } 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-02-20T23:19:37.600

带有 xcode 9.1 的 Swift 3 版本

```
func getAllKeyChainItemsOfClass(_ secClass: String) -> [String:String] {

    let query: [String: Any] = [
        kSecClass as String : secClass,
        kSecReturnData as String  : kCFBooleanTrue,
        kSecReturnAttributes as String : kCFBooleanTrue,
        kSecReturnRef as String : kCFBooleanTrue,
        kSecMatchLimit as String : kSecMatchLimitAll
    ]

    var result: AnyObject?

    let lastResultCode = withUnsafeMutablePointer(to: &result) {
        SecItemCopyMatching(query as CFDictionary, UnsafeMutablePointer($0))
    }

    var values = [String:String]()
    if lastResultCode == noErr {
        let array = result as? Array<Dictionary<String, Any>>

        for item in array! {
            if let key = item[kSecAttrAccount as String] as? String,
                let value = item[kSecValueData as String] as? Data {
                values[key] = String(data: value, encoding:.utf8)
            }
        }
    }

    return values
} 
```

可以这样称呼：

```
debugPrint(getAllKeyChainItemsOfClass(kSecClassGenericPassword as String)) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2020-07-21T21:48:24.563

其他 Swift 代码片段看起来都有些复杂。您实际上不必过多地处理 MutablePointers，并且您可能希望进行适当的错误管理。[我只是通过调整Apple 文档](https://developer.apple.com/documentation/security/keychain_services/keychain_items/searching_for_keychain_items)中的代码在 Swift 中实现了我的版本。这是为那些使用 Xcode 11 的人准备的。

```
let query: [String: Any] = [kSecClass as String: kSecClassInternetPassword, // change the kSecClass for your needs
                            kSecMatchLimit as String: kSecMatchLimitAll,
                            kSecReturnAttributes as String: true,
                            kSecReturnRef as String: true]
var items_ref: CFTypeRef?
let status = SecItemCopyMatching(query as CFDictionary, &items_ref)
guard status != errSecItemNotFound else { throw KeychainError.noPassword }
guard status == errSecSuccess else { throw KeychainError.unhandledError(status: status) }
let items = items_ref as! Array<Dictionary<String, Any>>

// Now loop over the items and do something with each item
for item in items {
    // Sample code: prints the account name
    print(item[kSecAttrAccount as String] as? String)
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-07-18T13:06:24.570

**更新为在字典中包含 kSecClassIdentity 和 kSecClassCertificate 信息**

我也不认为调用*withUnsafeMutablePointer(to:_:)*是必要的。

```
func getAllKeyChainItemsOfClass(_ secClass: String) -> [String:AnyObject] {

    let query: [String: Any] = [
        kSecClass as String : secClass,
        kSecReturnData as String  : true,
        kSecReturnAttributes as String : true,
        kSecReturnRef as String : true,
        kSecMatchLimit as String: kSecMatchLimitAll
    ]

    var result: AnyObject?

    let lastResultCode = withUnsafeMutablePointer(to: &result) {
        SecItemCopyMatching(query as CFDictionary, UnsafeMutablePointer($0))
    }

//  this also works, although I am not sure if it is as save as calling withUnsafeMutabePointer
//  let lastResultCode = SecItemCopyMatching(query as CFDictionary, &result)

    var values = [String: AnyObject]()
    if lastResultCode == noErr {
        let array = result as? Array<Dictionary<String, Any>>

        for item in array! {
            if let key = item[kSecAttrAccount as String] as? String,
                let value = item[kSecValueData as String] as? Data {
                values[key] = String(data: value, encoding:.utf8) as AnyObject?
            }
            // including identities and certificates in dictionary
            else if let key = item[kSecAttrLabel as String] as? String,
                let value = item[kSecValueRef as String] {
                values[key] = value as AnyObject
            }
        }
    }

    return values
} 
```

# ruby - Ruby 中的横向滚动游戏

> ID：10966971
> 
> 赞同：2
> 
> 时间：2012-06-10T07:12:28.820
> 
> 标签：ruby

有人对在 Ruby 中创建横向卷轴动作游戏有什么建议吗？

我特别在寻找库、工具或指南。我已经构建了一个基于终端文本的游戏，但是现在我想涉及图形并可能在终端之外运行游戏。

对我来说重要的是它是在 Ruby 中的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T07:32:03.593

用于制作 2D 图形的一个非常好的工具包是 SDL，在 [http://www.kmc.gr.jp/~ohai/rubysdl.en.html上提供了 ruby​​ 绑定](http://www.kmc.gr.jp/%7Eohai/rubysdl.en.html)

oreilly net 有一篇关于使用 ruby​​ 编写游戏的非常好的文章 [https://web.archive.org/web/20170813235228/http://archive.oreilly.com/pub/a/ruby/2007/12/04/creating -games-in-ruby.html](https://web.archive.org/web/20170813235228/http://archive.oreilly.com/pub/a/ruby/2007/12/04/creating-games-in-ruby.html)

如果 jruby 适合您，您可以将各种 java 库用于 gfx 部分，如 java2D 或处理（[http://www.rubyinside.com/using-the-processing-graphics-system-from-ruby-780.html](http://www.rubyinside.com/using-the-processing-graphics-system-from-ruby-780.html)）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-10T07:56:10.670

libgosu怎么样？

[http://www.libgosu.org/](http://www.libgosu.org/)

“Gosu 是一个用于 Ruby 和 C++ 编程语言的 2D 游戏开发库，可用于 Mac OS X、Windows 和 Linux。它自 2001 年以来一直在开发中。”

“Ruby/Gosu 集成得很好：

```
 gem install gosu 
```

完整的示例，为 Windows 和 OS X 预编译"

# c# - 应用程序的入口点

> ID：10966972
> 
> 赞同：1
> 
> 时间：2012-06-10T07:12:30.300
> 
> 标签：c#, reflection

应该调用 Assembly 类的什么静态方法来保证返回具有应用程序入口点的程序集实例？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-10T07:30:22.877

你在找[`Assembly.GetEntryAssembly()`](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.getentryassembly)吗？

# asp.net - ckeditor - mediaEmbed 上传图片

> ID：10966982
> 
> 赞同：1
> 
> 时间：2012-06-10T07:13:24.157
> 
> 标签：asp.net, vb.net, ckeditor

我有 CKEDITOR 可以选择上传图像，现在我想添加 mediaembed 以将 youtube 视频添加到编辑器。

我添加了一行：`config.extraPlugins = 'MediaEmbed';`但什么也没发生，mediaembed 的新按钮不存在。

我有下一个 config.js：

```
CKEDITOR.editorConfig = function( config )
{

config.filebrowserImageBrowseUrl = "ckeditor/ImageBrowser.aspx";
config.filebrowserImageWindowWidth = 780;
config.filebrowserImageWindowHeight = 720;
config.filebrowserBrowseUrl = "ckeditor/LinkBrowser.aspx";
config.filebrowserWindowWidth = 500;
config.filebrowserWindowHeight = 650;
config.htmlEncodeOutput = true;
config.extraPlugins = 'MediaEmbed';

}; 
```

mediaembed 文件夹位于 ~/ckedtior/plugins/

我哪里错了？mediaembed 的按钮未显示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T09:45:08.420

答案是将 'MediaEmbed' 添加到 ckeditor.js 与 'Flash','Table' ... 的行中。

# java - SYSO (System.out.println()) 的作用是什么？

> ID：10966984
> 
> 赞同：1
> 
> 时间：2012-06-10T07:13:42.213
> 
> 标签：java, system, out, println

SYSO-的作用是什么`System.out.println()`？如果我的计算机正在执行一项大型作业，例如从数据库中获取 20 万（约 2,000,000）条记录到文件中，SYSO 会影响执行时间吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-10T07:18:04.303

当然会影响它。每一次手术都是有代价的。写入系统输出是 IO，并且具有不可忽略的成本。要了解对*您的*程序的确切影响，除了基准测试之外没有其他解决方案：运行带有和不带有 println 调用的程序，并测量两个版本所花费的时间，或者使用分析器。

您应该使用日志框架（如 slf4j、log4j 或 java util logging），它允许各种类型的输出（sysout、文件等），并且还允许通过更改某些属性来停用输出日志配置文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-03T05:49:15.067

对性能的影响在很大程度上取决于接收方（通常是控制台或文件系统）从流中读取的速度以及缓冲区的大小。例如，当程序正在打印时，实际查看控制台通常会使其非常慢，但是当您最小化控制台窗口时，它会更快。

# android - 等待线程中的响应

> ID：10966995
> 
> 赞同：0
> 
> 时间：2012-06-10T07:18:06.747
> 
> 标签：android

我想回收我的图像，但由于另一个线程正在渲染它们，我需要确保渲染已经停止：

```
 private void unload() {
        System.out.println("Unloading menu...");
        loaded = false;
        while(rendering) {
            //wait
        }
        background.recycle();  
        button.recycle();
        button_pushed.recycle();
     } 
```

但我认为这不是最好的方法，他们还有其他方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T07:23:17.060

使用线程 wait()/notify() 机制。你会在网上找到很多不错的 tuts

# java - Eclipse AST 中的变量类型

> ID：10966998
> 
> 赞同：1
> 
> 时间：2012-06-10T07:20:11.283
> 
> 标签：java, eclipse, types, abstract-syntax-tree

我是 Eclipse AST 的新手，我想知道在树的遍历过程中是否可以获取变量的类型？我在某处读到可以通过设置 setResolveBindings 来获取它。但是，我不知道在访问方法中需要做什么。具体来说，我想在处理 SimpleName 访问时获取变量的类型。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-05T15:18:36.457

`resolveTypeBinding()` from the `Expression` class - a superclass of `SimpleName` and `NumberLiteral` - will return an `ITypeBinding`. A method such as `getName()` will get you the type.

# java - 如何制作一个按钮，单击时会打开 %appdata% 目录？

> ID：10966999
> 
> 赞同：2
> 
> 时间：2012-06-10T07:20:11.910
> 
> 标签：java, eclipse, directory, jframe

我已经制作了一个按钮，但我现在不知道如何让它打开一个特定的目录，就像`%appdata%`单击按钮时一样。

这是代码->

```
//---- button4 ----
        button4.setText("Texture Packs");
        button4.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e)
            {
                JFileChooser fileChooser=new JFileChooser("%appdata%");
                int status = fileChooser.showOpenDialog(this);
                fileChooser.setMultiSelectionEnabled(false);

                if(status == JFileChooser.APPROVE_OPTION) {
                    File file = fileChooser.getSelectedFile();
                    // do something on the selected file.
                }

            } 
```

我想做这样的东西->

```
private void button4MouseClicked(MouseEvent e) throws IOException {

           open folder %appdata% 
           // Open the folder in the file explorer not in Java.
           // When I click on the button, the folder is viewed with the file explorer on the screen
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T08:28:09.860

```
import java.awt.Desktop;
import java.io.File;

public class OpenAppData {

    public static void main(String[] args) throws Exception {
        // Horribly platform specific.
        String appData = System.getenv("APPDATA");
        File appDataDir = new File(appData);
        // Get a sub-directory named 'texture'
        File textureDir = new File(appDataDir, "texture");
        Desktop.getDesktop().open(textureDir);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T08:29:34.377

使用 Runtime.exec(..) 执行命令。但是，并非每个操作系统都有相同的文件资源管理器，因此您需要处理操作系统。

视窗：`Explorer /select, file`

苹果电脑：`open -R file`

Linux：`xdg-open file`

我编写了一个 FileExplorer 类，目的是在本机文件资源管理器中显示文件，但您需要对其进行编辑以检测操作系统。 [http://textu.be/6](http://textu.be/6)

注意：这是如果您希望显示单个文件。`Desktop#open(File)`正如 Andrew Thompson 所说，显示目录要简单得多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-10T10:00:54.353

如果你使用的是 Windows Vista 及更高版本， `System.getenv("APPDATA");`将返回你`C:\Users\(username}\AppData\Roaming`，所以你应该去一次，并使用这个路径`filechooser`，只是一个简单的修改安德鲁的例子，

```
 String appData = System.getenv("APPDATA");
    File appDataDir = new File(appData); // TODO: this path should be changed! 
    JFileChooser fileChooser = new JFileChooser(appData);
    fileChooser.showOpenDialog(new JFrame()); 
```

更多关于[windows xp](http://best-windows.vlaurie.com/environment-variables.html)和[windows vista/7/8](http://windows7tips.com/environment-variables-windows-vista-7.html)