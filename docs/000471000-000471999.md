# StackOverflow 问答 000471000-000471999

# java - Jython 和 python 模块

> ID：471000
> 
> 赞同：20
> 
> 时间：2009-01-22T21:57:46.760
> 
> 标签：java, python, interop, jython

我刚刚开始`PythonInterpreter`在我的 Java 类中使用 from ，而且效果很好！但是，如果我尝试包含 python 模块（`re`、`HTMLParser`等），我会收到以下异常（for `re`）：

```
线程“main” Traceback 中的异常（最里面的最后一个）：
  文件“”，第 1 行，在？
ImportError：没有名为 re 的模块

```

如何让 jython jar 中的类“看到”python 可用的模块？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-27T12:09:48.667

您嵌入了 jython，您将在某些地方使用一些 Python 模块：

如果要在 Java-Code 中设置路径（sys.path）：

```
public void init() {
        interp = new PythonInterpreter(null, new PySystemState());

        PySystemState sys = Py.getSystemState();
        sys.path.append(new PyString(rootPath));
        sys.path.append(new PyString(modulesDir));
    } 
```

Py 在 org.python.core 中。

rootPath 和 modulesDir 是你想要的！

让 rootPath 指向您找到标准 jython-lib 的位置

例如，查看 Jython-Source-Code 中的 src/org/python/util/PyServlet.java

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-22T22:39:59.247

根据[常见问题解答](http://www.jython.org/Project/userfaq.html#jython-modules)：

> ## 4.1 支持 Python 库的哪些部分？
> 
> 好消息是 Jython 现在支持绝大多数标准 Python 库。坏消息是，这发展得太快了，很难让文档保持最新。
> 
> 内置模块（例如那些为 CPython 用 C 语言编写的模块）是另一回事。这些必须移植到 Java，或使用 JNI 桥实现，以便 Jython 使用。一些内置模块已移植到 JPython，最著名的是 cStringIO、cPickle、struct 和 binascii。不过，JNI 模块不太可能包含在 Jython 中。
> 
> 如果您想使用标准 Python 模块，只需尝试导入它。如果这行得通，你可能已经准备好了。您还可以对模块执行 dir() 以检查它实现的功能列表。
> 
> 如果有一些您真正需要的标准 Python 模块还不能与 Jython 一起使用，请给我们发送邮件。

换句话说，您*可以*直接使用来自 Jython 的 Python 模块，除非您尝试使用内置模块，在这种情况下，您会被移植到 Jython 的任何东西卡住。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T22:44:13.967

检查您的 jython sys.path 。确保您要加载的库位于此路径中。查看[jython 常见问题](http://www.jython.org/cgi-bin/faqw.py?req=show&file=faq02.003.htp)以获取更多详细信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-11-26T10:30:07.463

您可以参考这里的解决方案[Importing python modules in jython](https://stackoverflow.com/questions/3256135/importing-python-modules-in-jython/33936158#33936158)

`ez_setup.py`从这里下载[http://peak.telecommunity.com/dist/ez_setup.py](http://peak.telecommunity.com/dist/ez_setup.py)

然后运行`jython ez_setup.py <any module name>`。

在任何文件夹路径上运行它都没有关系。

我可以用它安装pymysql，没问题。

# java - 通过扫描仪保证整数输入的更简单方法？

> ID：471013
> 
> 赞同：1
> 
> 时间：2009-01-22T22:02:14.190
> 
> 标签：java, parsing, integer, user-input, java.util.scanner

对于我正在编写的程序，我需要向用户询问 1 到 8 之间的整数。我尝试了多种（更简洁的）方法，但没有一种方法有效，所以我只剩下这个：

```
 int x = 0;
    while (x < 1 || x > 8)
    {   
        System.out.print("Please enter integer  (1-8): ");

        try
        {
            x = Integer.parseInt(inputScanner.next());
        }
        catch(NumberFormatException e)
        {
            x = 0;
        }
    } 
```

扫描仪在哪里`inputScanner`。肯定有更好的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-22T22:06:55.493

扫描仪做正则表达式，对吧？为什么不先检查它是否匹配“^[1-8]$”？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T22:09:05.737

与简单地使用 next() 方法相比，使用 nextInt() 已经是一种改进。在此之前，您可以使用 hasNextInt() 来避免出现所有这些无用的异常。

导致这样的事情：

```
int x = 0;
do {
  System.out.print("Please...");
  if(scanner.hasNextInt()) x = scanner.nextInt();
  else scanner.next();
} while (x < 1 || x > 8); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-06T17:22:59.347

我必须做一个图形界面计算器（仅适用于整数），问题是，如果输入不是整数，测试不允许抛出任何异常。所以我无法使用

```
try { int x = Integer.parseInt(input)} catch (Exception e) {dosomethingelse} 
```

因为 Java 程序通常将 JTextField 的输入视为字符串，所以我使用了这个：

```
if (input.matches("[1-9][0-9]*"){ // String.matches() returns boolean
   goodforyou
} else {
   dosomethingelse
}

// this checks if the input's (type String) character sequence matches
// the given parameter. The [1-9] means that the first char is a Digit
// between 1 and 9 (because the input should be an Integer can't be 0)
// the * after [0-9] means that after the first char there can be 0 - infinity
// characters between digits 0-9 
```

希望这可以帮助 ：）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-03-25T05:23:27.643

你可以尝试这样的事情：

```
Scanner cin = new Scanner(System.in);
int s = 0;    
boolean v = false;
while(!v){
    System.out.print("Input an integer >= 1: ");

    try {    
        s = cin.nextInt();
        if(s >= 1) v = true;
        else System.out.println("Please input an integer value >= 1.");
    } 
    catch(InputMismatchException e) {
        System.out.println("Caught: InputMismatchException -- Please input an integer value >= 1\. ");
        cin.next();
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-22T22:10:56.420

```
String input;
int number;

while (inputScanner.hasNextLine())
{
    input = inputScanner.nextLine();

    if (input.equals("quit")) { System.exit(0); }
    else
    {
        //If you don't want to put your code in here, make an event handler
        //that gets called from this spot with the input passed in
        try
        {
            number = Integer.parseInt(input);
            if ((number < 1) || (number > 8))
            { System.out.print("Please choose 1-8: "); }
            else { /* Do stuff */ }
        }
        catch (NumberFormatException e) { number = 0; }
    }
} 
```

我总是喜欢拉入完整的字符串，这样您就可以确定用户按下了 Enter 按钮。如果你只是使用`inputScanner.nextInt()`，你可以把两个`int`s 放在一条线上，它会拉一个，然后另一个。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-22T22:33:04.910

Apache Commons 是您的朋友。请参阅[NumberUtils.toInt(String, int)](http://commons.apache.org/lang/api/org/apache/commons/lang/math/NumberUtils.html#toInt(java.lang.String,%20int))

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-09-08T17:55:22.350

示例代码：

```
int x;
Scanner in = new Scanner(System.in);
System.out.println("Enter integer value: ");
x = in.nextInt(); 
```

数组也可用于存储整数。

# php - 代码翻译：PHP 中的 ASP.NET Server.Transfer

> ID：471014
> 
> 赞同：3
> 
> 时间：2009-01-22T22:02:56.047
> 
> 标签：php, asp.net

我将如何在 PHP 中执行此操作？

```
Server.Transfer("/index.aspx") 
```

（为 C# 添加 ';'）

**编辑：**

保持 URL 与以前相同很重要；你知道，对于谷歌。在我的情况下，我们有一堆要传输的 .html 文件，对于客户端来说，地址栏不会改变很重要。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-22T22:46:18.860

据我所知，PHP 没有真正的传输能力，但您可以通过使用 include() 或 require() 获得完全相同的效果，如下所示：

```
require_once('/index.aspx"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T22:05:18.193

最简单的方法是使用`header` 重定向。

```
header('Location: /index.php'); 
```

编辑：或者如果您不想使用 HTTP 标头，您可以只包含文件并退出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-27T05:19:47.870

使用 require 将类似于 server.transfer 但在某些情况下它的行为会略有不同。例如，当输出已经发送到浏览器并使用 require 时，将显示已经发送到浏览器的输出以及您需要的路径。

模仿 C#/ASP.NET Server.Transfer() 的最佳方法是正确设置 PHP 输出缓冲，然后使用我编写的以下函数。

```
function serverTransfer($path) { 
    if (ob_get_length() > 0) { 
        ob_end_clean(); 
    }
    require_once($path); 
    exit; 
} 
```

设置输出缓冲就像使用 ob_start() 作为 PHP 应用程序调用的第一行一样简单。更多信息可以在这里找到：http: [//php.net/manual/en/function.ob-start.php](http://php.net/manual/en/function.ob-start.php)

ASP.NET 默认启用输出缓冲，这就是为什么在使用 Server.Transfer() 时不必这样做的原因；

# php - 以与 MySQL 相同的方式比较 PHP 中的字符串

> ID：471021
> 
> 赞同：6
> 
> 时间：2009-01-22T22:05:47.820
> 
> 标签：php, mysql, utf-8, collation, mysql-error-1062

我将 varchar 存储在 utf8 MySQL 表中并使用 utf8_general_ci 排序规则。我在 varchar 上有一个唯一索引。我想在 PHP 中做一个字符串比较，这相当于 MySQL 对索引所做的事情。

一个具体的例子是，我希望能够在这种情况发生之前检测到“a”被认为等同于 PHP 中的“À”：

```
mysql> insert UniTest (str) values ('a');                                   
Query OK, 1 row affected (0.00 sec)

mysql> insert UniTest (str) values ('À');                                   
ERROR 1062 (23000): Duplicate entry 'À' for key 1 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-23T09:25:57.633

排序规则与存储无关。您需要设置字符集来确定存储编码。排序规则控制应该如何进行比较和排序。排序规则必须是字符集感知的，否则它与字符集无关。

要回答您的问题，您可以使用`iconv`转写文本，然后进行比较。例如：

```
function compare($s1, $s2) {
  return strcmp(
    iconv('UTF-8', 'ISO-8859-1//TRANSLIT', $s1),
    iconv('UTF-8', 'ISO-8859-1//TRANSLIT', $s2));
} 
```

这基本上是 MySql 将为您做的事情，尽管它可能更快，并且它的排序表可能与`ISO-8859-1//TRANSLIT`. 对此并不完全确定。

正如其他人已经建议的那样，使用数据库可能会更容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T22:10:59.993

通过向 MySQL 提交如下查询，让 MySQL 完成这项工作是否合理：

```
SELECT CASE WHEN '$a' = '$b' THEN 1 ELSE 0 END 
```

* * *

编辑后澄清：

您可以一次性遍历整个感兴趣的笛卡尔字符集，并构建一个标准的 php 等价集关联数组。

```
    对于 $charset {中的每个 $char1  
        对于 $charset {中的每个 $char2  
            $charmatch[$char1][$char2] = mysqlTestMatch($char1, $char2));  
        }  
    }  

```

然后你需要逐个字符地测试每个字符串，看看a）它们是否相同，或者如果不是，b）它们是等价的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T22:14:20.343

为什么不让 MySQL 决定是否已经存在具有相同键的记录？

您可以运行`SELECT`查询以询问是否已经有具有此属性的记录：

```
SELECT 1
FROM UniTest
WHERE str = "À" 
```

或者您只是尝试插入新记录并使用函数[mysql_error()](http://docs.php.net/manual/en/function.mysql-error.php)和[mysql_errno()](http://docs.php.net/manual/en/function.mysql-errno.php)来查看是否发生错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T20:33:11.993

所以，如果我理解正确，您想在 PHP 中进行类似的比较，就像在 MySQL 中检查 UTF-8 通用索引检查一样？

最简单的方法是创建一个辅助函数，根据 MySQL 使用的 utf8_general_ci 规则转换字符串，主要是将某些字母转换为基本字母。

此处列出了该 MySQL 排序规则的规则：

```
http://www.collation-charts.org/mysql60/mysql604.utf8_general_ci.european.html 
```

例如，如果您向下滚动一点到左侧的“金色 A”，您将看到所有转换为该 A 的字符。

给定一个名为 example 的辅助函数，`utf8g_to_ascii()`您可以编写一个函数：

```
function utf8_compare($s1, $s2) {
   $a = utf8g_to_ascii($s1);
   $b = utf8g_to_ascii($s2);
   return strcmp( $a, $b );
} 
```

我将在以下之后建模我的代码：

```
http://dev.splitbrain.org/view/darcs/dokuwiki/inc/utf8.php 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-19T07:50:34.953

使用 intl 的 Collat​​or 或 Transliterator。

```
$s1 = 'a';
$s2 = 'À';

var_dump(
    is_same_string($s1, $s2),
    $s1 === transliterator_transliterate('Any-Latin; Latin-ASCII; Lower()', $s2)
);

function is_same_string($str, $str2, $locale = 'en_US')
{
    $coll = collator_create($locale);
    collator_set_strength($coll, Collator::PRIMARY);  
    return 0 === collator_compare($coll, $str, $str2);
} 
```

# linux - 如何让 cron 每“N”分钟运行一次，其中 n % 5 == 1？

> ID：471026
> 
> 赞同：48
> 
> 时间：2009-01-22T22:07:04.277
> 
> 标签：linux, unix, cron, sysadmin

我知道我可以在 cron 中每五分钟运行一次，如下所示：

```
 */5 * * * * /my/script 
```

如果我不想让它在 12:00、12:05、12:10 运行，而是在 12:01、12:06、12:11 等运行，该怎么办？我想我可以这样做：

```
 1,6,11,16,21,26,31,36,41,46,51,56 * * * * /my/script 
```

......但这很丑陋。有没有更优雅的方法来做到这一点？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2009-01-22T22:57:48.243

```
1-56/5 * * * * /my/script 
```

这应该适用于 vixiecron，我不确定其他实现。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-01-22T22:15:09.873

使用您的第一个时间表：

```
*/5 * * * * /my/script 
```

并将其添加到脚本的开头：

```
sleep 60 
```

（是的，这是个笑话）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-25T09:24:37.103

这是一个相当古老的话题，但是随着时间的流逝，现在还有其他一些选择。其中之一是根本不使用 cron，而使用 systemd 计时器。使用这些为您提供比秒更高的粒度以及许多其他选项

更多信息在这里[https://wiki.archlinux.org/index.php/Systemd/Timers](https://wiki.archlinux.org/index.php/Systemd/Timers)

例如运行临时命令

```
# systemd-run --on-calendar="*:1/5" /bin/touch /tmp/foo2
Running timer as unit run-r31335c4878f24f90b02c8ebed319ca60.timer.
Will run service as unit run-r31335c4878f24f90b02c8ebed319ca60.service.

# systemctl status run-r31335c4878f24f90b02c8ebed319ca60.timer
● run-r31335c4878f24f90b02c8ebed319ca60.timer - /bin/touch /tmp/foo2
   Loaded: loaded
Transient: yes
  Drop-In: /run/systemd/system/run-r31335c4878f24f90b02c8ebed319ca60.timer.d
           └─50-Description.conf, 50-OnCalendar.conf, 50-RemainAfterElapse.conf
   Active: active (waiting) since Wed 2017-10-25 09:05:13 UTC; 40s ago

# ls -l  /tmp/foo*
-rw-r--r-- 1 root root 0 Oct 25 09:06 /tmp/foo2

# sleep 300; ls -l  /tmp/foo*
-rw-r--r-- 1 root root 0 Oct 25 09:11 /tmp/foo2

# date; ls -l /tmp/foo2
Wed Oct 25 09:21:42 UTC 2017
-rw-r--r-- 1 root root 0 Oct 25 09:21 /tmp/foo2 
```

编辑：这些类型的计时器不会在重新启动后持续存在，如果您希望它们确保生成正确的服务文件，以及相关的 oncalendar 行

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-09-24T21:32:37.070

我将创建一个新脚本“delaystart”，它将睡眠时间作为第一个参数，并将脚本作为其余参数运行。我会让脚本检查带有脚本的行的 crontab 行，并且仅在未注释掉该行时才启动脚本。这使得它可重用，并且 ps 不会在脚本确实没有运行时报告脚本正在运行。

```
#!/bin/bash
sleeptime=$1
sleep ${sleeptime}
shift
if ( ! crontab -l | grep -e '#.+delaystart '${sleeptime} $* ) then
  $*
fi 
```

* * *

## 回答 #5

> 赞同：-5
> 
> 时间：2009-01-22T22:34:27.433

sean.bright 的笑话让我开始思考……为什么不使用……

```
* * * * * /my/script 
```

...并在脚本中执行此操作...

```
#!/bin/bash
export WHEN=`date '+%M'`
echo $WHEN
export DOIT=`echo "$WHEN % 5" | bc` 
echo $DOIT
if [ $DOIT != 0 ] ; then
    echo "ha ha ha"
fi
echo "done" 
```

......一个kludge......也许，但像crontab一样丑陋......我不知道。

# software-distribution - 出售源代码，我应该注意什么

> ID：471027
> 
> 赞同：10
> 
> 时间：2009-01-22T22:07:45.350
> 
> 标签：software-distribution

我收到了购买我开发的网站源代码的请求，我想知道是否有人遇到过同样的情况，是否有什么我应该特别注意的。有人对我应该如何处理这种情况有一些建议吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-22T22:28:30.380

首先 - 一个警告 - 我不是律师。一点也不。但我非常关心知识产权而不是被起诉，所以我试着了解一下。

没有特别的顺序：

*   **仔细检查您的就业规则**- 当您接受目前支付给您的工作时，您的安排是什么？您是否必须签署任何声明，让您的公司控制您生成的所有代码？即使这是一个个人的、无偿的项目——如果你签署了严格的知识产权协议，公司所有权也可以让你受益。
*   **使用开源？**- 有一些主要的开源许可证，通读并检查它们以查看依赖开源的产品的销售条款。
*   **买方期望什么交付物？**- 内置代码？源代码？另外 - 你可以做些什么来保护你的代码（混淆）。
*   **他们期待支持吗？**- 小心，根据我与企业客户打交道的经验，一个有用的、免费的“当然，如果你有一个快速的问题就给我打电话”很快就会变得很耗时。如果您愿意投入几个小时的免费时间，请非常清楚您将免费放弃 X 小时的支持。并清楚您的计费率是多少。如果你真的不想支持它，那就让你的时间成本非常高。
*   **他们想要什么样的支持？**- 答案和配置帮助？Bug修复？
*   **需要什么样的安装说明？**
*   **当他们购买这个时，他们拥有什么？**- 单个服务器的单个安装？一个站点范围的许可证，可以将它安装在他们希望的任何地方？或者——最坏的情况——他们是否拥有这把锁、枪托和枪管，这样你就可以不再开发它并继续自己使用它？

以书面形式，用签名来澄清这些答案。
让外部人员阅读以检查歧义是个好主意。起草协议并让律师阅读是一个更好的主意——你的律师，而不是买方的律师。

避免任何点头/眨眼/握手交易。个人信任很好，但如果情况变得有压力，人们就会改变。或者人们在公司内部来来去去——今天的买家明天可能是另一个人。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T22:16:32.663

您需要考虑的第一件事是：

**您在什么许可证下提供代码？**

如果您不规定许可证，他们几乎可以随意使用它。那是你要的吗？在不了解具体情况的情况下很难回答这个问题：你为什么要出售源代码？

如果这是客户，因此他们可以进行自己的自定义修改，而这些修改是您付钱去做的，那么价格应该反映“丢失的工作”。此外，您将希望限制他们重新分发或转售该源代码的能力。

如果有人只是喜欢您的网站并想要代码，请非常小心，因为他们很有可能会接受并设置自己的代码。这对您来说可能是也可能不是问题。但再次考虑转售、再分配、使用权和所有权的问题。

根据代码的用途，您可能还需要考虑它的用途、可用于什么以及这将如何影响您的专业或其他方面。您可能希望限制代码用于某些事情（例如成人或扑克网站），或者您希望要求署名。

同样对于所有这些事情，您需要考虑在重新分发时会转移哪些条款（即您的许可证有多“病毒”）。

那里有很多开源许可证（GPL、Apache、MIT、BSD、MPL、LGPL 等）。我建议您以一个为基础并对其进行修改以适合您的口味。与提出自己的条款相比，您遇到麻烦的可能性要小得多。

# parsing - 规范化 NFL 球队名称

> ID：471029
> 
> 赞同：4
> 
> 时间：2009-01-22T22:07:55.490
> 
> 标签：parsing, machine-learning, canonical-form

这实际上是一个机器学习分类问题，但我想有一个非常好的快速而简单的方法来做到这一点。我想将描述 NFL 球队的字符串（如“San Francisco”或“49ers”或“San Francisco 49ers”或“SF 49ers”）映射到球队的规范名称。（有 32 支 NFL 球队，所以这实际上只是意味着找到 32 个箱中最近的一个来放入给定的字符串。）

传入的字符串实际上并不是完全任意的（它们来自这样的结构化数据源：[http](http://www.repole.com/sun4cast/stats/nfl2008lines.csv) ://www.repole.com/sun4cast/stats/nfl2008lines.csv ），因此并不需要像在上面的 49 人示例。

我还应该补充一点，如果有人知道包含拉斯维加斯赔率以及过去几年 NFL 比赛的实际比赛结果的数据来源，那就不需要这样做了。我需要规范化的原因是为了匹配这两个不同的数据集，一个带有赔率，一个带有结果：

*   [http://www.footballlocks.com/nfl_odds.shtml](http://www.footballlocks.com/nfl_odds.shtml)
*   [http://www.repole.com/sun4cast/freepick.shtml](http://www.repole.com/sun4cast/freepick.shtml)

非常欢迎关于更好、更可解析的数据源的想法！

补充：子串匹配的想法可能对这个数据就足够了；谢谢！是否可以通过选择距离最近的队名来使其更健壮一些？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T07:49:04.740

我认为，即使对于任意用户输入，这里也有一些强大的功能。首先，将每个团队（我使用 3 个字母的代码作为每个团队的规范名称）映射到一个完整拼写的版本，其中包含城市和团队名称以及城市和团队名称之间括号中的任何昵称。

```
Scan[(fullname[First@#] = #[[2]])&, {
  {"ari", "Arizona Cardinals"},                 {"atl", "Atlanta Falcons"}, 
  {"bal", "Baltimore Ravens"},                  {"buf", "Buffalo Bills"}, 
  {"car", "Carolina Panthers"},                 {"chi", "Chicago Bears"}, 
  {"cin", "Cincinnati Bengals"},                {"clv", "Cleveland Browns"}, 
  {"dal", "Dallas Cowboys"},                    {"den", "Denver Broncos"}, 
  {"det", "Detroit Lions"},                     {"gbp", "Green Bay Packers"}, 
  {"hou", "Houston Texans"},                    {"ind", "Indianapolis Colts"}, 
  {"jac", "Jacksonville Jaguars"},              {"kan", "Kansas City Chiefs"}, 
  {"mia", "Miami Dolphins"},                    {"min", "Minnesota Vikings"}, 
  {"nep", "New England Patriots"},              {"nos", "New Orleans Saints"}, 
  {"nyg", "New York Giants NYG"},               {"nyj", "New York Jets NYJ"}, 
  {"oak", "Oakland Raiders"},                   {"phl", "Philadelphia Eagles"}, 
  {"pit", "Pittsburgh Steelers"},               {"sdc", "San Diego Chargers"}, 
  {"sff", "San Francisco 49ers forty-niners"},  {"sea", "Seattle Seahawks"}, 
  {"stl", "St Louis Rams"},                     {"tam", "Tampa Bay Buccaneers"}, 
  {"ten", "Tennessee Titans"},                  {"wsh", "Washington Redskins"}}] 
```

然后，对于任何给定的字符串，找到每个团队全名的最长公共子序列。为了优先匹配开头或结尾的字符串（例如，“car”应该匹配“carolina panthers”而不是“arizona cardinals”）将输入字符串和全名夹在空格之间。无论哪个团队的全名具有输入字符串的 [sic:] 最长最长公共子序列，都是我们返回的团队。这是该算法的 Mathematica 实现：

```
teams = keys@fullnames;

(* argMax[f, domain] returns the element of domain for which f of that element is
   maximal -- breaks ties in favor of first occurrence. *)
SetAttributes[argMax, HoldFirst];
argMax[f_, dom_List] := Fold[If[f[#1] >= f[#2], #1, #2] &, First@dom, Rest@dom]

canonicalize[s_] := argMax[StringLength@LongestCommonSubsequence[" "<>s<>" ", 
                                 " "<>fullname@#<>" ", IgnoreCase->True]&, teams] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T00:11:44.727

通过视觉快速检查显示两个数据集都包含团队的位置（即“明尼苏达”）。其中只有一个有球队的名字。也就是说，一个列表如下所示：

```
Denver
Minnesota
Arizona
Jacksonville 
```

另一个看起来像

```
Denver Broncos
Minnesota Vikings
Arizona Cardinals
Jacksonville Jaguars 
```

似乎在这种情况下，一些非常简单的子字符串匹配就可以了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T22:19:41.037

如果您知道源名称和目标名称，那么您只需要映射它们。在 php 中，您只需使用一个数组，其中包含来自数据源的键和来自目标的值。然后你会像这样引用它们：

```
$map = array('49ers' => 'San Francisco 49ers',
             'packers' => 'Green Bay Packers');

foreach($incoming_name as $name) {
   echo $map[$name];
} 
```

# usability - recaptcha.net 是否有任何替代品来阻止垃圾邮件？

> ID：471031
> 
> 赞同：12
> 
> 时间：2009-01-22T22:08:08.390
> 
> 标签：usability, captcha, spam-prevention, recaptcha

我公司的一位比我排名更高的成员拒绝在他的网站上使用 recaptcha.net 来阻止来自公共表单的垃圾邮件。他认为任何来到我们网站的人都很难输入他们的信息，因为图灵测试“非常难以阅读”。

**有没有使用这种方法的替代方法？** 那不包含这些难以阅读的图像？

（好吧，愚蠢的问题......如果由我决定，我们会使用recaptcha，因为地球上的其他人都这样做......但我只是想我还是会检查一下。）

**此外，使用由 Javascript 设置并随后在服务器上检查的隐藏字段真的是阻止垃圾邮件的好方法吗？**

我自己并不真正相信它......因为有各种各样的 Javascript 引擎不能在浏览器中运行但可以运行 Javascript（Rhino 等......），这很容易被用来阻止 JS /服务器端反垃圾邮件方法。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-22T22:24:57.857

CAPTCHA 将减少您的垃圾邮件，但不会消除它。人们得到报酬来破译这些字形。一些网站将呈现给他们的字形用于他们自己的网站，因此一些倒霉的访问者会破译它。

只是为了让您知道这不是一个完美的解决方案。

基于不解决问题直到问题出现的原则：垃圾邮件是您网站上的一个重大问题吗？为了不惹恼您的客户/访客，有话要说。即使在这里，有时我也需要进行一些编辑，并且通常在我需要进行的最后一次编辑时，我会得到令人讨厌的“我是人类”测试。它很烦人。

人们已经提出了各种其他方法来处理这个问题。我读过一篇关于猫和狗的旧照片，你必须对其进行分类，因为显然在美国有一个包含 30 多万张关于被遗弃的动物或类似动物的数据库。这个或任何被广泛使用的东西都将被击败。

网站上垃圾邮件的最大问题是如果您使用广泛使用的软件（例如 phpBB）。您最好的选择是进行足够的修改以击败开箱即用的脚本。无论如何，您可能会成为目标，但垃圾邮件是一种高容量低成功率的游戏。在您的网站占据大量流量之前，没有真正的理由来定位您的网站。

另一件值得一提的是可以用来击败脚本垃圾邮件的技术：

*   使用 Javascript 编写关键内容，而不是将其包含为静态 HTML。这很难处理（但并非不可能）；
*   重命名和/或重新排序用户名和密码等关键字段。例如，生成用户名和密码表单字段并将它们存储为会话变量，以便它们仅适用于该用户。然后要求用户使用登录表单访问页面（而不是编写可以直接发布的表单响应脚本）；
*   混淆表单提交。可以在 jQuery 和类似框架中执行的不显眼的 Javascript 之类的事情使这变得非常容易；
*   包括验证码图像和字段框，然后不显示它们（在 CSS 中显示：无）。你会混淆解析器。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-22T22:39:52.523

对于不太受欢迎的网站，最好的方法是插入一个隐藏字段并检查它。如果它被填满，那么它就是垃圾邮件，因为这些机器人只是填写他们找到的任何字段。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-22T23:19:25.127

您可能想研究[Akistmet](http://akismet.com/)和/或[Mollom](http://mollom.com/)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-22T22:22:36.617

添加一个非标准的必填字段。例如，要求选中一个显示“检查我”的复选框。这将击败任何不是为您的网站量身定制的自动化脚本。请记住，它不会击败专门针对您网站的任何人。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-11T17:37:16.730

一种简单的方法是显示一个“橙色”的图像，并要求用户输入。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-09T19:08:22.180

是的，recaptcha 会减少垃圾邮件，但也会减少转换！您应该考虑使用 XVerify 进行实时数据验证。使这些注册成为垃圾邮件的是虚假数据，XVerify 将通过验证用户的电子邮件地址、电话号码和实际地址来确保您输入的信息是真实数据。如果信息是假的，用户不能点击继续！简单的！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-19T01:15:37.680

我曾经认为 CAPTCHA 很好，并在公共表单上使用了 reCAPTCHA。我注意到垃圾邮件提交消失了，但我也注意到真正的提交也大幅减少。

现在我不相信验证码。他们工作，但我觉得他们弊大于利。在不得不在其他网站上输入难以阅读的验证码后，我明白为什么我没有得到尽可能多的真实提交。用户必须采取的与其主要目标无关的任何输入都是一种威慑。

我通常使用几种方法来防止垃圾邮件，这取决于我期望表单中的内容类型。我创建了服务器方法来扫描评论并将其标记为基于内容的垃圾邮件。它工作正常，但我不是垃圾邮件专家，所以它不能很好地工作。我希望有人会做一个这样做的网络服务。

我认为埃文的链接很有趣！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-18T16:07:33.637

我听说的另一种方法，它基本上扩展了 javascript 的思想，是让客户端的浏览器执行可配置的 JavaScript 计算。

它已在 NoBot 示例中实现，作为 Microsoft AJAX 控制工具包 [http://www.asp.net/AJAX/AjaxControlToolkit/Samples/NoBot/NoBot.aspx](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/NoBot/NoBot.aspx)的一部分，以了解有关其工作原理的更多详细信息。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-09-28T06:24:00.463

[我找到了一个名为Are You A Human](http://areyouahuman.com/)的替代方法。并不是说程序员应该凭直觉行事，而是从一开始它就显得不安全。因为你玩的游戏很有趣，所以我决定试一试。它对我不起作用。主机可能没有为此设置。这是我检查的最后一件事。

如果其他人尝试过，我想知道它是如何工作的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-10-03T16:45:15.437

我以前使用过[Confident Captcha](http://www.confidenttechnologies.com)，它很容易设置和运行。此外，我在我管理的论坛上没有收到任何垃圾邮件。

它不是基于文本的验证码，而是使用类似于 picaptcha 的图像。我之前尝试过“你是人类吗”，这绝对是一个有趣的概念。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-06-13T18:57:23.380

找到一个名为[NuCaptcha](http://www.nucaptcha.com/)的显示移动字母的...

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-10-29T12:44:23.817

**8年后...**

我一直在寻找 Google 的 reCaptcha 的替代品，它不会破坏用户体验、跟踪用户等，并找到了这个宝石：[Coinhive Captcha](https://coinhive.com/documentation/captcha)。

[![在此处输入图像描述](https://i.stack.imgur.com/D9NZW.gif)](https://i.stack.imgur.com/D9NZW.gif)

它通过在后台挖掘[门罗](https://getmonero.org/)币（哈希计数可调整）来工作，并提供服务器端 API 来验证它。应该注意的是 - 根据要解决的所选哈希计数 - 它可能会很慢，特别是在移动设备上。

# c# - 无法通过分隔符分隔文本文件 |

> ID：471039
> 
> 赞同：3
> 
> 时间：2009-01-22T22:10:52.270
> 
> 标签：c#, text-files, flat-file, csv

我正在使用 C#。

我正在尝试将文本文件拉入对象。我正在使用 ODBC 连接，它看起来像这样

Driver={Microsoft 文本驱动程序 (*.txt; *.csv)};Dbq=C:\Users\Owner\Desktop\IR\IR_Files\Absolute;Extensions=asc,csv,tab,txt;

我能够建立连接，但我无法将我的列分开。我正在使用 schema.ini 文件，但它不起作用。这是我的架构文件。

[MyTextFile.CSV]
Format=Delimited(|)
ColNameHeader=False
Col1=fullstockn Text
col2=FULLINFO Text
MaxScanRows=0
CharacterSet=ANSI

文本文件如下所示。

fullstockn|FULLINFO

“555555”|

Contenu : Neuf Ttudes sur l Some more text here.....

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-22T22:53:06.117

我使用以下连接字符串

```
string connectionString = String.Format("Provider=Microsoft.Jet.OLEDB.4.0;Data Source={0};Extended Properties=\"text;HDR=YES;Format=Delimited(|)\";", Path.GetDirectoryName(path)); 
```

和一个通常开始的 Schema.ini 文件

```
[myFile.txt]
Format=Delimited(|)
TextDelimiter="none" 
```

我将通过

```
command.CommandText = String.Format("SELECT * FROM [{0}]", Path.GetFileName(path));
OleDbDataReader reader = command.ExecuteReader(); 
```

此外，当我第一次调查此问题时，文本文件驱动程序上的[MSDN 页面](http://tinyurl.com/caqkpr)也很有帮助。具体来说，文件上的[页面](http://msdn.microsoft.com/en-us/library/ms709353.aspx)`Schema.ini`非常有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T22:16:32.227

您是否有理由为此需要使用 ODBC 连接？我认为直接打开文本文件并自己解析会更容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T22:16:53.570

我不知道这是否重要，但...

您可能缺少 dbq 属性中的结尾“\”...

编辑：实际上...在您发布的文本中，您有 3 列，而不是 2...（2 个管道而不是 1 个）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T22:36:54.293

我总是自己为这种操作编写代码。这是我不久前为此目的编写的一个抽象类的示例。如果您愿意，可以对其进行修改或子类化

```
public abstract class ReadTextFile : ILoadable
{
    public string Path { get; set; }
    public UploadFileType FileType { get; set; }
    protected internal List<List<string>> Table { get; set; }
    public Guid BatchID { get; set; }

    /// <summary>
    /// Method that loads the raw text into a collection of strings
    /// </summary>
    /// <returns></returns>
    public bool Load()
    {
        Table = new List<List<string>>();
        var splitter = Convert.ToChar("\t");
        try
        {
            using (TextReader tr = new StreamReader(Path))
            {
                // Discard the first line
                String line = tr.ReadLine();

                // Read and display lines from the file until the end of the file is reached.
                while ((line = tr.ReadLine()) != null)
                {
                    Table.Add(line.Split(splitter).ToList<string>());
                }
                tr.Close();
                tr.Dispose();
            }
            return true;

        }
        catch (Exception e)
        {
            Console.WriteLine(e.Message);
            return false;
        }
    }
    public string Left(string param, int length)
    {
        //we start at 0 since we want to get the characters starting from the
        //left and with the specified lenght and assign it to a variable
        string result = param.Substring(0, length);
        //return the result of the operation
        return result;
    }
    public string Right(string param, int length)
    {
        //start at the index based on the lenght of the sting minus
        //the specified lenght and assign it a variable
        string result = param.Substring(param.Length - length, length);
        //return the result of the operation
        return result;
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-22T22:47:24.943

尝试使用此连接字符串

```
Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\Users\Owner\Desktop\IR\IR_Files\Absolute\MyTextFile.CSV;Extended Properties='text' 
```

和：

*   注意列数
*   将 schema.ini 放在可执行文件的同一文件夹中。

# c# - 加载了错误的 App.config

> ID：471042
> 
> 赞同：4
> 
> 时间：2009-01-22T22:11:21.397
> 
> 标签：c#, .net, .net-3.5, configuration, c#-3.0

我有一个我构建的 .NET 3.5 类库，它读取 App.config 文件以获取所需的值。当我在 Visual Studio 中测试它时，它可以很好地提取配置值。为了测试它，我只是将项目更改为控制台应用程序并执行方法调用。

我需要从许多其他.NET程序调用这个类库，我希望类库是自给自足的（我应该能够从任何其他程序调用它，它应该使用自己的配置文件，不知道关于任何调用配置文件等）。

我可以添加对 dll 的引用（因为我仍在开发中，我正在使用 VS 2008，还没有向 GAC 中添加任何内容）但是类库正在读取的 App.config 来自调用程序的 App.config，不是类库的 App.config。

类库 dll 的配置文件在同一个目录下，所以它应该能够找到它，并且调用应用程序的名称不同。我在 App.config 中使用标准键值对（例如配置文件 myClassLibrary.dll.config 的名称）并使用以下代码行获取值：

```
String myVal = ConfigurationSettings.AppSettings["myConfigSetting"]; 
```

有谁知道如何解决这一问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-22T22:25:03.287

C# 中的应用程序域只能有一个程序集级 app.config 文件。[请参阅 MSDN 上的此处](http://msdn.microsoft.com/en-us/library/system.appdomainsetup.configurationfile.aspx)。可执行文件将始终启动 AppDomain 并默认查找名称为：EXECUTABLE_NAME.config 的配置文件。例如，SampleApp01.exe 将查找 SampleApp01.exe.config 作为其配置文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T23:54:47.270

您可以通过这种方式将您的配置放在框架文件夹内的 machine.config 文件中，您可以在该机器上运行的所有 .Net 应用程序中全局使用您的配置，

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T22:17:37.110

我相信 app.config 将始终被可执行文件使用。只需将其放在该目录中即可。

他们会这样做以确保可以共享 dll 而不必共享相同的 .config 文件。

您也许可以从可执行的 .config 文件创建链接

```
<appSettings configSource="\lib\app.config"> 
```

或更改其名称，我不明白您如何将两个 app.config 文件放在同一个目录中。它们不是同名吗？

```
<appSettings configSource="\lib.app.config"> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-25T20:50:16.427

我找不到避免为调用 dll/exe 等获取 app.config 的方法。我发现的唯一方法是使用硬编码路径并以这种方式加载它。这是我用来执行此操作的代码：

```
using System.Configuration;
...
public static KeyValueConfigurationCollection getAppSettingsFromAppConfig(String appConfigPath) {
    ExeConfigurationFileMap fileMap = new ExeConfigurationFileMap();
    fileMap.ExeConfigFilename = appConfigPath;
    Configuration config = ConfigurationManager.OpenMappedExeConfiguration(fileMap, ConfigurationUserLevel.None);
    AppSettingsSection section = config.AppSettings;
    KeyValueConfigurationCollection appsettings = section.Settings;
    return appsettings;
} 
```

然后你有一个集合`KeyValueConfigurationElement`，你可以用它`.Value`来从配置文件中获取字符串。

# visual-studio - 从 Visual Studio 6 中删除 SourceSafe 集成

> ID：471056
> 
> 赞同：4
> 
> 时间：2009-01-22T22:16:22.633
> 
> 标签：visual-studio, visual-sourcesafe, visual-c++-6

最近，由于我们搬家了，SourceSafe 与 Visual Studio 的集成开始表现不佳，而且 SourceSafe“服务器”位于 VPN 上，而 VPN 连接速度很慢。这使得在 Visual c++ 6 中加载大型项目需要 5 分钟以上，因为它必须与每个项目的“服务器”对话。此外，集成中存在一些危险的错误（某些共享项目的自动签出将获取最新版本的分支文件）。这导致我想要禁用 SourceSafe 集成，但是我没有找到任何菜单选项或卸载选项。谷歌报告了一些注册表调整，但似乎都没有奏效。

有谁知道从 Visual C++ 6 中删除 SourceSafe 集成而不完全卸载 SourceSafe 的简单方法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-22T23:01:22.107

来自[http://support.microsoft.com/kb/236399](http://support.microsoft.com/kb/236399)：

> 与 Visual C++ 集成开发环境 (IDE) 集成的源代码控制软件，例如 Microsoft Visual SourceSafe，可以配置为在 Visual C++ 启动期间连接到源代码服务器。在这种情况下，网络连接丢失将导致 Visual C++ 启动非常缓慢。要提高性能，请确保正确的网络连接或禁用源代码控制软件与 Visual C++ IDE 的集成。要执行后者，请退出 Visual C++，然后使用 RegEdit.Exe 找到以下注册表项并将其 Disabled 值设置为 (DWORD) 0x00000001：

```
HKEY_CURRENT_USER\Software\Microsoft\DevStudio\6.0\Source Control\Disabled 
```

我跟着这个，它似乎在再次尝试时起作用。我想我第一次做的时候可能已经运行了第二个 Visual Studio 副本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T22:29:07.257

在文本编辑器中打开 .dsp 和 .dsw 文件，然后从 .dsp 和 .dsw 文件中删除相应的条目。此外，删除 .scc 文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T22:32:51.540

有一篇关于如何做到这一点的 Microsoft 知识库[文章。](http://support.microsoft.com/kb/180945)

它的要点是您必须在文本编辑器中手动编辑 .dsw 和 .dsp 文件，并删除其他一些文件。有关更多详细信息，请参阅文章。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-06-10T21:54:11.873

如果上述解决方案对您失败，请执行以下操作：

重命名文件夹：\Program Files\Microsoft\%vs%\Common7\IDE\VS SCC

VS 会抱怨一次插件不存在，而您说“是”以永久忽略它。

所有“最新”、“只读”和在 VS 中编辑的文件都会让 VS 抱怨并提供“覆盖”，这对我来说很好用。

你有什么收获：

*   无需 VS 将内容匹配到 VSS 服务器即可快速打开 VSS 链接的解决方案。

*   打开 VSS 链接的解决方案并随意编辑文件，而不会陷入“签出”bs。

*   这使得在项目树顶部使用具有 VSS 绑定的其他分布式源代码控制系统变得轻松。

*   VSS 客户端仍然可以正常工作，包括 diff、checkout、checkin。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-06T11:18:36.020

HKEY_CURRENT_USER\Software\Microsoft\DevStudio\6.0\Source Control\Disabled 我跟着这个，它似乎在再次尝试时起作用。我想我第一次做的时候可能已经运行了第二个 Visual Studio 副本。

它的工作......谢谢阿杰

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-14T21:15:34.377

对我们有用并且更容易的方法不需要手动编辑注册表/文件，我认为更安全的是：

1) 完全退出 Visual Studio。

2) 断开网络连接（拔掉网线并关闭无线，或禁用网络适配器）

3) 打开项目的 VS6 工作区 (DSW)。当它启动时，它会发现它无法连接到它想要连接的 VSS 数据库，并询问你这个问题......

4) 告诉 VS 以后不要再尝试重新连接到源代码控制数据库。

5) 完成... VS 为您完成了对 WORKSPACE/PROJECT 设置的所有更改。通常，您不会将 VS 与源代码控制断开连接（就像注册表编辑一样），也不会手动编辑文件。

# version-control - 所有更改注释以在 2 个标签之间执行分支？（包括合并）

> ID：471072
> 
> 赞同：1
> 
> 时间：2009-01-22T22:19:50.910
> 
> 标签：version-control, merge, perforce

我们的 perforce 管理员限制了“最大行”扫描，因此我运行以下命令的第一个想法将不起作用：

1.  所有更改，包括在特定标签时间 1 集成到分支中
2.  所有更改，包括在特定的早期标签时间集成到分支中 2
3.  从时间 1 中减去时间 2 更改以获得带有注释的新更改。

是否有另一种方法可以在没有如此庞大的查询的情况下获得相同的结果（当 perforce 包含 7 年的历史并且 -i 触发扫描回到历史的曙光时）

根据 Gregs 的评论添加了这条评论：

基本上，重点是查看在 2 个标签（或更常见的是一些旧标签和今天）之间的特定发布分支中修复了哪些错误。我希望简化（加速）我们目前拥有的过于复杂的脚本，它查看进入发布分支的更改，它遵循进入它们的文件至少 2 个分支，以便打印出原始更改中的所有变更集注释（临时合并评论往往只是说诸如 merge123 之类的东西，而不是描述实际的更改评论，所以我们也需要沿着树走到原始评论），脚本最终输出如下内容（我们放置质量中心 ID进入变更集评论）：

1.  *qualityCenterId123 - 修复了一些错误*
2.  *在 gui qcId124 中 - 修复了其他一些*
3.  *错误 qcId125 - 修复了一些其他错误*
4.  *合并123*

根据评论更新：

Toby 的方法的问题是代码分支的大部分更改都是通过集成来实现的，-i 将包括这些更改，但正如所述，由于 perforce 服务器上的负载，我们的管理员不允许查询的程度会爆炸跑步。所以这就是为什么我正在寻找一种替代方法来获得相同的结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T23:20:32.140

我看不到一个简单的答案，但确实有更多建议可能有助于指出正确的方向。

1.  说服您的管理员提高最大扫描行数限制。如果他担心这会导致整个用户群出现问题，只需让他将您添加到一个新用户组（例如“脚本”），并为该组设置限制。这将产生只有该组的成员才能使用上限的效果，然后您可以协商合适的时间来运行脚本。你甚至可以在一夜之间完成。
2.  看看[P4 管理指南](http://www.perforce.com/perforce/doc.082/manuals/p4sag/07_perftune.html#1042633)，看看是否有任何关于脚本的提示会有所帮助——例如，更严格的数据视图可能会限制查询足以不打破 maxscanrows 限制。
3.  你的 SQL 怎么样？您可以使用[P4Report](http://www.perforce.com/perforce/doc.current/manuals/p4report/index.html)工具构建高效的查询。
4.  尝试在 Perforce 邮件列表上提问。这是一个非常活跃的列表，其中有很多非常有经验的人，他们非常乐于助人。请参阅[此链接](http://maillist.perforce.com/mailman/listinfo/perforce-user)以获取注册页面。他们很有可能会提出一些好的方法。
5.  对于你现有的标签来说可能为时已晚，但考虑使用工作系统来跟踪工作。Perforce 具有内置的查询工具来跟踪哪些工作已进入不同的分支。但是，它确实需要您的团队改变工作实践。

抱歉，我无法提供更具体的答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T17:27:22.567

您的标签是否不仅仅是创建时的最新更改列表？例如，您真的需要在客户端工作区中记录特定文件吗？如果不是，您可以很容易地比较最接近标签的两个更改列表。

假设与您的第一个标签日期最接近的更改是 23000 并且您对第二个标签日期的关闭更改是 25000 然后

p4 更改 //depot/PATHTOMYCODE/...@23000,@25000

将为您提供这两个更改列表之间的代码路径的所有更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T13:28:21.423

普通的标签差异不会做你想要的吗？

*   从 P4V，工具-> 差异。选择两个标签
*   在 P4Win 中，右键单击标签，选择 2 个标签中的差异文件
*   从命令行， p4 diff2 //codeline/...@label1 //codeline/...@label2

还是我错过了你所追求的东西？

## Ville 对上述内容发表评论后的进一步建议

如果您只关注每个更改列表的信息，而不是每个文件，请从命令行尝试“p4 交换”。这将为您提供一个分支中没有发生在另一个分支中的哪些更改的摘要，并且您可以提供一个修订范围以将其限制为您需要的标签。

从命令行执行“p4 帮助交换”以获取详细信息。

不幸的是，交换命令尚未在 P4V 或 P4Win 中公开。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T20:30:02.797

如果您的标签是简单的更改列表，那么 Toby Allen 的答案是最好的方法。

如果标签更复杂，那么我认为您需要查看每个标签中的所有文件以及它们的版本不同的地方，找到版本更改的更改列表。

您可以通过以下方式获取文件和版本列表：

```
p4 fstat -Of //...@MyLabel 
```

编辑：

考虑两个复杂的标签：

```
VERSION_A:
 //depot/file_A.cpp#4
 //depot/file_B.cpp#7
 //depot/file_C.cpp#1

VERSION_B:
 //depot/file_A.cpp#6
 //depot/file_B.cpp#5
 //depot/file_C.cpp#4 
```

在此示例中，标签没有描述特定的更改列表，每个文件的头部更改可能不同。

如果你可以有这样的标签，那么你可以在每个标签上运行 p4 fstat 命令，然后找出不同之处。在这个例子中，`file_A.cpp`改变了两次和`file_C.cpp`改变了 3 次。 `file_B.cpp`在第二个标签中较旧，因此可以忽略。

因此，现在您需要查看涉及这些版本的更改：

```
file_A.cpp#5
file_A.cpp#6
file_C.cpp#2
file_C.cpp#3
file_C.cpp#4 
```

可以使用 p4 文件日志检索这些更改，因此您希望运行如下内容：

```
p4 filelog file_A.cpp#6
p4 filelog file_C.cpp#4 
```

然后，您需要删除早期版本的所有重复项和任何历史记录。

就像我说的，只有当你有凌乱的标签时，你才需要这个。如果有任何方法可以让您的标签代表变更列表，您应该使用 Toby Allen 的答案。

# compare - 比较 Oracle Forms 模块

> ID：471078
> 
> 赞同：3
> 
> 时间：2009-01-22T22:20:33.890
> 
> 标签：compare, oracleforms

我们继承了一个大型 Oracle 项目，该项目最初是 Oracle 9，现在是 Oracle 11。

我们对表格变更登记册没有太多信心。

有什么工具可以用来比较这两个 Forms 项目吗？

（由于涉及到两个不同版本的Forms，即使底层代码没有改变，也会有差异）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T01:00:06.970

[Oracle Tools Developers Users Group](http://www.odtug.com/apex/f?p=500:1:800963984291887 "Oracle 工具开发人员用户组")的普遍共识是 ORCL Toolbox FormsTool diff 能力是最好的和最聪明的。如果您对表格有不同的需求，那么值得购买许可证。

FMB->FMT 的问题在于表单中的查询被转换为人类无法阅读的二进制格式。

假设您可以读取 XML 文件并进行比较，Forms 版本 10 能够将 FMB 转换为 XML 文件。

不要认为仅仅因为您使用了两个版本的表单，底层的 FMB 文件就需要更改。我已经为 Forms 4.5 获取了 FMB 文件，并通过 Forms 4.5、6i 和 9i 的编译器运行它们，并让它们都正常工作。

您使用的是哪个版本的表单？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T00:30:19.680

还没有答案，但做一些研究：

*   免费的[Caffo Forms Diff](http://www.rhea.be/Website/products.htm?id=2)

*   [Forms Tool](http://www.orcl-toolbox.com/download.asp) 30 天免费试用，但有一些限制

*   将 FMB（二进制文件）转换为 FMT（文本文件）。从表格中，选择菜单*File/Administration/Convert/Binary_to_text*，这会生成“源代码”，可以与普通的文本比较工具进行比较，例如 diff / Beyond Compare 等。但是你必须单独做每个表格，我们有很多形式！

有人用过这些吗？有什么建议吗？其他工具/更好的方法？

更新：[Beyond Compare](http://www.scootersoftware.com/)也有一个比较工具。参考[这里](http://www.scootersoftware.com/vbulletin/showthread.php?p=14525)。

# php - 将 RSS 提要导入 MySQL 数据库的最佳方法是什么

> ID：471103
> 
> 赞同：9
> 
> 时间：2009-01-22T22:29:24.760
> 
> 标签：php, mysql, rss

我正在尝试获取几个 RSS 提要，并使用 PHP 将它们的内容放入 MySQL 数据库中。存储此内容后，我将显示在自己的页面上，并将内容合并到一个 RSS Feed 中。（可能过滤后）

我以前没有处理过 RSS 提要，所以我想知道这样做的最佳框架/方法是。我已经阅读了有关基于 DOM 的解析，但听说它需要大量内存，有什么建议吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-22T22:31:52.400

[Magpie](http://magpierss.sourceforge.net/)是一个合理的 PHP RSS 解析器。便于使用：

```
require('rss_fetch.inc');
$rss = fetch_rss($url); 
```

例如这样的一个项目：

```
<item rdf:about="http://protest.net/NorthEast/calendrome.cgi?span=event&ID=210257">
<title>Weekly Peace Vigil</title>
<link>http://protest.net/NorthEast/calendrome.cgi?span=event&ID=210257</link>
<description>Wear a white ribbon</description>
<dc:subject>Peace</dc:subject>
<ev:startdate>2002-06-01T11:00:00</ev:startdate>
<ev:location>Northampton, MA</ev:location>
<ev:enddate>2002-06-01T12:00:00</ev:enddate>
<ev:type>Protest</ev:type>
</item> 
```

会变成这样的数组：

```
array(
    title => 'Weekly Peace Vigil',
    link => 'http://protest.net/NorthEast/calendrome.cgi?span=event&ID=210257',
    description => 'Wear a white ribbon',
    dc => array (
            subject => 'Peace'
        ),
    ev => array (
        startdate => '2002-06-01T11:00:00',
        enddate => '2002-06-01T12:00:00',
        type => 'Protest',
        location => 'Northampton, MA'
    )
); 
```

然后你就可以挑选出你想保存在数据库中的位，然后你就可以走了！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-05-06T22:18:40.787

最好的 PHP 解析器是[SimplePie](http://simplepie.org/)，恕我直言。我已经使用它多年了。它非常擅长抓取和解析以下内容：RSS 0.90、RSS 0.91 (Netscape)、RSS 0.91 (Userland)、RSS 0.92、RSS 1.0、RSS 2.0、Atom 0.3、Atom 1.0；包括以下命名空间：Dublin Core 1.0、Dublin Core 1.1、GeoRSS、iTunes RSS 1.0（大部分完成）、Media RSS 1.1.1、RSS 1.0 Content Module、W3C WGS84 Basic Geo、XML 1.0、XHTML 1.0

SimplePie 1.2 甚至有数据库缓存，所以它应该有你需要做的一切。

如果您需要解析原始 XML 文件，请尝试使用 XMLize

-崔斯特

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-10-31T14:09:32.867

对于一个非常简单的脚本，它只是端到端工作（解析 RSS，插入数据库）；

[http://code.google.com/p/rssingest/](http://code.google.com/p/rssingest/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T22:36:48.677

有几个 RSS 解析库，包括[Magpie](http://magpierss.sourceforge.net/)和[pear 中的一个](http://pear.php.net/package/XML_RSS)。

我会选择一个解析器，然后用数据循环运行它以将其输入数据库。确保你弄清楚你想要运行脚本的频率，并考虑它是从 cron 运行，还是从不经常加载的页面的一部分运行。

# sql - 如何使用 Perl 获取 SQL 表上的索引列表？

> ID：471106
> 
> 赞同：4
> 
> 时间：2009-01-22T22:29:53.183
> 
> 标签：sql, perl, sybase, dbi

如何使用 Perl 获取 sybase 数据库中表的索引列表？目标是将表中的所有索引“复制”到几乎相同的表中。

`$dbh->selectarray_ref('sp_helpindex $table')`我能做到最好吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T22:57:57.293

DBI 中有一个 statistics_info() 方法，但不幸的是，到目前为止，我看到它实现的唯一 DBD 是 DBD::ODBC 。因此，如果您使用 ODBC（更新：或 PostgreSQL！），那么您很幸运。否则 sp_helpindex（或 sysindexes 表）与 Sybase 的性能差不多。

这是我用于 Sybase 的内容（在我自己的 OO 模块中 - 它只返回唯一索引，除非 all_indexes 参数为真）：

```
{
my $sql_t = <<EOT;
select
  sysindexes.name,
  index_col(object_name(sysindexes.id), sysindexes.indid, syscolumns.colid) col_name
from sysindexes, syscolumns
where sysindexes.id = syscolumns.id
  and syscolumns.colid <= sysindexes.keycnt
  and sysindexes.id = object_id(%s)
EOT

sub index_info {
  my ( $self, $table, $all_indexes ) = @_;

  my $dbh = $self->{DBH};
  my $sql = sprintf $sql_t, $dbh->quote($table);
  $sql .= "and sysindexes.status & 2 = 2\n" unless $all_indexes;
  my $sth = $dbh->prepare($sql);
  $sth->execute();
  my @col_names = @{$sth->{NAME_lc}};
  my %row; $sth->bind_columns(\@row{@col_names});
  my %ind;
  while ($sth->fetch()) {
    if ( $row{col_name} ) {
      push @{$ind{$row{name}}}, lc($row{col_name});
    }
  }
  return unless %ind;
  return \%ind;
}

} 
```

或者，如果您的目标只是复制索引，也许您应该获取[dbschema.pl](http://freshmeat.net/projects/dbschema.pl/)实用程序（它使用 Sybase::DBlib）。它将为您生成“CREATE INDEX”语句。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T22:36:29.160

```
SELECT i.*
FROM sysobjects o, sysindexes i
WHERE o.name = $name
  AND i.id = o.id 
```

# asp.net - ASP.net 模态弹出扩展器和 DropDownlist 自动回发

> ID：471111
> 
> 赞同：0
> 
> 时间：2009-01-22T22:31:33.197
> 
> 标签：asp.net, ajax

我有一个`GridView`控件，如果用户单击自动生成的编辑按钮。将使用模态弹出扩展器弹出一个窗口，其中包含一个供用户选择的下拉列表。问题是如果设置为 false ，`SelectedIndexChanged`事件将不会触发。`AutoPostBack`

但是，如果我将其设置`AutoPostBack`为 true，则弹出窗口将在不触发`SelectedIndexChanged`事件的情况下消失。

是否可以`AutoPostBack`在模态弹出窗口中设置一个设置为 true 的控件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T08:43:38.087

请在下拉服务器端更改事件上输入以下代码

modalpopup.show(); 更新面板.更新（）；

其中 modalpopup 是 modalpopupextender 的“ID”，而 updatepanel 是 updatepanel 的“ID”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T22:03:56.697

> 问题是如果 autopostback 设置为 false，则 selectedindexchange 事件将不会触发...

我不确定这种说法是否完全正确。如果 autopostback 为 false，SelectedIndexChange 事件是否会在下一次回发期间触发？因此，如果您更改索引，然后单击提交按钮，即触发索引更改事件。

如果您需要在弹出窗口仍在显示时运行服务器代码以响应索引更改，这并不是很好，但除此之外，您仍然可以响应索引更改。

如果您需要更改弹出窗口中的某些内容以响应索引更改，您始终可以使用客户端 JavaScript。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-28T22:17:33.677

您可以使用 an`UpdatePanel`来解决此问题。`DropDownList`将和任何其他可能产生类似问题的控件包装在`UpdatePanel`弹出控件的 , 内。这将允许弹出窗口继续显示，同时在正确的时间执行您的回发代码。

# java - java声音淡出

> ID：471112
> 
> 赞同：1
> 
> 时间：2009-01-22T22:31:34.803
> 
> 标签：java, audio, fade

使用 javax.sound.sampled，我想淡出我开始无限循环的声音。这就是我开始声音的方式：

```
Clip clip = AudioSystem.getClip();
AudioInputStream inputStream = AudioSystem
.getAudioInputStream(new File("x.wav"));
clip.open(inputStream);
clip.loop(clip.LOOP_CONTINUOUSLY); 
```

谁能指出我该怎么做？我是否应该使用不同的声音系统，例如 FMOD（如果这在 Java 中可行）？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-25T17:11:02.053

看看这里： 他们使用的[Openjava 声音演示](http://potatoland.com/openjava/demo/Sound.java)
`FloatControl gainControl; // for volume`

```
/**
 * Set the volume to a value between 0 and 1.
 */
public void setVolume(double value) {
    // value is between 0 and 1
    value = (value<=0.0)? 0.0001 : ((value>1.0)? 1.0 : value);
    try {
        float dB = (float)(Math.log(value)/Math.log(10.0)*20.0);
        gainControl.setValue(dB);
    } catch (Exception ex) {
        ex.printStackTrace();
    }
}

/**
 * Fade the volume to a new value.  To shift volume while sound is playing,
 * ie. to simulate motion to or from an object, the volume has to change
 * smoothly in a short period of time.  Unfortunately this makes an annoying
 * clicking noise, mostly noticeable in the browser.  I reduce the click
 * by fading the volume in small increments with delays in between.  This
 * means that you can't change the volume very quickly.  The fade has to
 * to take a second or two to prevent clicks.
 */
float currDB = 0F;
float targetDB = 0F;
float fadePerStep = .1F;   // .1 works for applets, 1 is okay for apps
boolean fading = false;

public void shiftVolumeTo(double value) {
    // value is between 0 and 1
    value = (value<=0.0)? 0.0001 : ((value>1.0)? 1.0 : value);
    targetDB = (float)(Math.log(value)/Math.log(10.0)*20.0);
    if (!fading) {
        Thread t = new Thread(this);  // start a thread to fade volume
        t.start();  // calls run() below
    }
}

/**
 * Run by thread, this will step the volume up or down to a target level.
 * Applets need fadePerStep=.1 to minimize clicks.
 * Apps can get away with fadePerStep=1.0 for a faster fade with no clicks.
 */
public void run()
{
    fading = true;   // prevent running twice on same sound
    if (currDB > targetDB) {
        while (currDB > targetDB) {
            currDB -= fadePerStep;
            gainControl.setValue(currDB);
            try {Thread.sleep(10);} catch (Exception e) {}
        }
    }
    else if (currDB < targetDB) {
        while (currDB < targetDB) {
            currDB += fadePerStep;
            gainControl.setValue(currDB);
            try {Thread.sleep(10);} catch (Exception e) {}
        }
    }
    fading = false;
    currDB = targetDB;  // now sound is at this volume level
} 
```

# php - 如何从 PHP 发布 SOAP 请求

> ID：471115
> 
> 赞同：55
> 
> 时间：2009-01-22T22:32:33.833
> 
> 标签：php, web-services, soap

任何人都知道如何从 PHP 发布 SOAP 请求？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2010-01-14T10:46:16.653

根据我的经验，事情并不是那么简单。内置的[PHP SOAP 客户端](http://www.php.net/manual/en/book.soap.php)无法与我们必须使用的基于 .NET 的 SOAP 服务器一起使用。它抱怨无效的模式定义。即使 .NET 客户端与该服务器配合得很好。顺便说一句，让我声明 SOAP 互操作性是一个神话。

下一步是[NuSOAP](http://sourceforge.net/projects/nusoap/)。这工作了很长一段时间。顺便说一句，看在上帝的份上，别忘了缓存 WSDL！但即使有 WSDL 缓存的用户也抱怨这该死的东西很慢。

然后，我们决定使用纯 HTTP，组装请求并使用 读取响应`SimpleXMLElemnt`，如下所示：

```
$request_info = array();

$full_response = @http_post_data(
    'http://example.com/OTA_WS.asmx',
    $REQUEST_BODY,
    array(
        'headers' => array(
            'Content-Type' => 'text/xml; charset=UTF-8',
            'SOAPAction'   => 'HotelAvail',
        ),
        'timeout' => 60,

    ),
    $request_info
);

$response_xml = new SimpleXMLElement(strstr($full_response, '<?xml'));

foreach ($response_xml->xpath('//@HotelName') as $HotelName) {
    echo strval($HotelName) . "\n";
} 
```

请注意，在 PHP 5.2 中，您需要 pecl_http，因为（惊喜！）没有内置 HTTP 客户端。

*使用裸 HTTP 使我们的 SOAP 请求时间提高了 30% 以上。*从那时起，我们将所有性能投诉重定向到服务器人员。

最后，我推荐后一种方法，而不是因为性能。我认为，一般来说，在像 PHP 这样的动态语言中，所有 WSDL/类型控制*都没有好处。*您不需要花哨的库来读取和写入 XML，以及所有存根生成和动态代理。您的语言已经是动态的，并且`SimpleXMLElement`运行良好，而且非常易于使用。此外，您将拥有*更少的代码*，这总是好的。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2010-11-15T01:08:03.597

PHP has SOAP support. Just call

```
$client = new SoapClient($url); 
```

to connect to the SoapServer and then you can get list of functions and call functions simply by doing...

```
$client->__getTypes();      
$client->__getFunctions();  

$result = $client->functionName(); 
```

for more [http://www.php.net/manual/en/soapclient.soapclient.php](http://www.php.net/manual/en/soapclient.soapclient.php)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-04-15T21:24:17.300

我需要执行许多非常简单的 XML 请求，在阅读了@Ivan Krechetov 关于 SOAP 速度影响的评论后，我尝试了他的代码，发现 http_post_data() 没有内置到 PHP 5.2 中。我真的不想安装它，我尝试了我所有服务器上的 cURL。尽管我不知道 cURL 与 SOAP 相比有多快，但它确实很容易满足我的需求。下面是一个带有 cURL 的示例，供任何需要它的人使用。

```
$xml_data = '<?xml version="1.0" encoding="UTF-8" ?>
<priceRequest><customerNo>123</customerNo><password>abc</password><skuList><SKU>99999</SKU><lineNumber>1</lineNumber></skuList></priceRequest>';
$URL = "https://test.testserver.com/PriceAvailability";

$ch = curl_init($URL);
curl_setopt($ch, CURLOPT_HTTPHEADER, array('Content-Type: text/xml'));
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, "$xml_data");
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
$output = curl_exec($ch);
curl_close($ch);

print_r($output); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2016-02-17T19:38:33.463

我们可以使用 PHP cURL 库来生成简单的 HTTP POST 请求。以下示例向您展示了如何使用 cURL 创建一个简单的 SOAP 请求。

创建将 SOAP 请求写入 web 文件夹中的 soap-request.xml 的 soap-server.php。

```
We can use the PHP cURL library to generate simple HTTP POST request. The following example shows you how to create a simple SOAP request using cURL.

Create the soap-server.php which write the SOAP request into soap-request.xml in web folder.

<?php
  $HTTP_RAW_POST_DATA = isset($HTTP_RAW_POST_DATA) ? $HTTP_RAW_POST_DATA : '';
  $f = fopen("./soap-request.xml", "w");
  fwrite($f, $HTTP_RAW_POST_DATA);
  fclose($f);
?>

The next step is creating the soap-client.php which generate the SOAP request using the cURL library and send it to the soap-server.php URL.

<?php
  $soap_request  = "<?xml version=\"1.0\"?>\n";
  $soap_request .= "<soap:Envelope xmlns:soap=\"http://www.w3.org/2001/12/soap-envelope\" soap:encodingStyle=\"http://www.w3.org/2001/12/soap-encoding\">\n";
  $soap_request .= "  <soap:Body xmlns:m=\"http://www.example.org/stock\">\n";
  $soap_request .= "    <m:GetStockPrice>\n";
  $soap_request .= "      <m:StockName>IBM</m:StockName>\n";
  $soap_request .= "    </m:GetStockPrice>\n";
  $soap_request .= "  </soap:Body>\n";
  $soap_request .= "</soap:Envelope>";

  $header = array(
    "Content-type: text/xml;charset=\"utf-8\"",
    "Accept: text/xml",
    "Cache-Control: no-cache",
    "Pragma: no-cache",
    "SOAPAction: \"run\"",
    "Content-length: ".strlen($soap_request),
  );

  $soap_do = curl_init();
  curl_setopt($soap_do, CURLOPT_URL, "http://localhost/php-soap-curl/soap-server.php" );
  curl_setopt($soap_do, CURLOPT_CONNECTTIMEOUT, 10);
  curl_setopt($soap_do, CURLOPT_TIMEOUT,        10);
  curl_setopt($soap_do, CURLOPT_RETURNTRANSFER, true );
  curl_setopt($soap_do, CURLOPT_SSL_VERIFYPEER, false);
  curl_setopt($soap_do, CURLOPT_SSL_VERIFYHOST, false);
  curl_setopt($soap_do, CURLOPT_POST,           true );
  curl_setopt($soap_do, CURLOPT_POSTFIELDS,     $soap_request);
  curl_setopt($soap_do, CURLOPT_HTTPHEADER,     $header);

  if(curl_exec($soap_do) === false) {
    $err = 'Curl error: ' . curl_error($soap_do);
    curl_close($soap_do);
    print $err;
  } else {
    curl_close($soap_do);
    print 'Operation completed without any errors';
  }
?>

Enter the soap-client.php URL in browser to send the SOAP message. If success, Operation completed without any errors will be shown and the soap-request.xml will be created.

<?xml version="1.0"?>
<soap:Envelope xmlns:soap="http://www.w3.org/2001/12/soap-envelope" soap:encodingStyle="http://www.w3.org/2001/12/soap-encoding">
  <soap:Body xmlns:m="http://www.example.org/stock">
    <m:GetStockPrice>
      <m:StockName>IBM</m:StockName>
    </m:GetStockPrice>
  </soap:Body>
</soap:Envelope>

Original - http://eureka.ykyuen.info/2011/05/05/php-send-a-soap-request-by-curl/ 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-22T22:36:01.580

你可能想看看[这里](http://developer.apple.com/internet/webservices/soapphp.html)和[这里](http://se.php.net/soap)。

第一个链接中的一个小代码示例：

```
<?php
// include the SOAP classes
require_once('nusoap.php');
// define parameter array (ISBN number)
$param = array('isbn'=>'0385503954');
// define path to server application
$serverpath ='http://services.xmethods.net:80/soap/servlet/rpcrouter';
//define method namespace
$namespace="urn:xmethods-BNPriceCheck";
// create client object
$client = new soapclient($serverpath);
// make the call
$price = $client->call('getPrice',$param,$namespace);
// if a fault occurred, output error info
if (isset($fault)) {
        print "Error: ". $fault;
        }
else if ($price == -1) {
        print "The book is not in the database.";
} else {
        // otherwise output the result
        print "The price of book number ". $param[isbn] ." is $". $price;
        }
// kill object
unset($client);
?> 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2019-01-02T15:18:33.840

如果 XML 在不同级别具有相同名称的身份，则有一个解决方案。您不必提交原始 XML（此 PHP SOAP 对象不允许发送原始 XML），因此您必须始终将 XML 转换为数组，如下例所示：

```
$originalXML = "
<xml>
  <firstClient>
      <name>someone</name>
      <adress>R. 1001</adress>
  </firstClient>
  <secondClient>
      <name>another one</name>
      <adress></adress>
  </secondClient>
</xml>"

//Translate the XML above in a array, like PHP SOAP function requires
$myParams = array('firstClient' => array('name' => 'someone',
                                  'adress' => 'R. 1001'),
            'secondClient' => array('name' => 'another one',
                                  'adress' => ''));

$webService = new SoapClient($someURL);
$result = $webService->someWebServiceFunction($myParams); 
```

或者

```
$soapUrl = "http://privpakservices.schenker.nu/package/package_1.3/packageservices.asmx?op=SearchCollectionPoint";

$xml_post_string = '<?xml version="1.0" encoding="utf-8"?><soap12:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap12="http://www.w3.org/2003/05/soap-envelope"><soap12:Body><SearchCollectionPoint xmlns="http://privpakservices.schenker.nu/"><customerID>XXX</customerID><key>XXXXXX-XXXXXX</key><serviceID></serviceID><paramID>0</paramID><address>RiksvŠgen 5</address><postcode>59018</postcode><city>Mantorp</city><maxhits>10</maxhits></SearchCollectionPoint></soap12:Body></soap12:Envelope>';

$headers = array(
"POST /package/package_1.3/packageservices.asmx HTTP/1.1",
"Host: privpakservices.schenker.nu",
"Content-Type: application/soap+xml; charset=utf-8",
"Content-Length: ".strlen($xml_post_string)
); 

$url = $soapUrl;

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_POST, true);
curl_setopt($ch, CURLOPT_POSTFIELDS, $xml_post_string);
curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);

$response = curl_exec($ch); 
curl_close($ch);

$response1 = str_replace("<soap:Body>","",$response);
$response2 = str_replace("</soap:Body>","",$response1);

$parser = simplexml_load_string($response2); 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-10-23T10:20:29.583

[下面是我在这个网站](http://www.doublehops.com/2009/07/07/quick-tutorial-on-getting-started-with-soap-in-php/comment-page-1/)上基本上找到的如何执行此操作的快速示例（它最好地向我解释了这个问题）。该网站链接还解释了 WSDL，这对于使用 SOAP 服务很重要。

但是，我不认为他们在下面的示例中使用的 API 地址仍然有效，因此只需切换您自己选择的一个。

```
$wsdl = 'http://terraservice.net/TerraService.asmx?WSDL';

$trace = true;
$exceptions = false;

$xml_array['placeName'] = 'Pomona';
$xml_array['MaxItems'] = 3;
$xml_array['imagePresence'] = true;

$client = new SoapClient($wsdl, array('trace' => $trace, 'exceptions' => $exceptions));
$response = $client->GetPlaceList($xml_array);

var_dump($response); 
```

# delphi - 在 Delphi 中访问 LocalApplicationData 等价物

> ID：471123
> 
> 赞同：7
> 
> 时间：2009-01-22T22:35:26.700
> 
> 标签：delphi, environment-variables

使用 Delphi，我如何访问等效于 .NET 的 System.Environment.SpecialFolder.LocalApplicationData 变量（适用于任何版本的 Windows）？我以为我可以这样做：

```
dir := GetEnvironmentVariable('LOCALAPPDATA'); 
```

这适用于 Vista，但 XP 似乎并没有默认设置该环境变量，至少在我的测试机器上是这样。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-23T03:10:52.133

在 Delphi 中，特殊的系统文件夹路径常量在 ShlObj.DCU 中定义，并以 CSIDL_ 后跟符号名称的形式引用。例子：

*   CSIDL_DESKTOPDIRECTORY 返回当前桌面的路径
*   CSIDL_PERSONAL 是*我的文档*目录
*   CSIDL___LOCAL_APPDATA 是 *（用户名）\Local Settings\Application Data*目录

这是一个快速函数，当给定符号名称时，它将返回适当的特殊文件夹路径。确保在 USES 语句中包含 SHLOBJ.DCU 单元，并使用以下内容：

```
function GetSpecialFolderPath(Folder: Integer; CanCreate: Boolean): string;

// Gets path of special system folders
//
// Call this routine as follows:
// GetSpecialFolderPath (CSIDL_PERSONAL, false)
//        returns folder as result
//
var
   FilePath: array [0..255] of char;

begin
 SHGetSpecialFolderPath(0, @FilePath[0], FOLDER, CanCreate);
 Result := FilePath;
end; 
```

==================================================== ===============

作为参考，常量如下：

```
 CSIDL_DESKTOP                       = $0000; { <desktop> }
  CSIDL_INTERNET                      = $0001; { Internet Explorer (icon on desktop) }
  CSIDL_PROGRAMS                      = $0002; { Start Menu\Programs }
  CSIDL_CONTROLS                      = $0003; { My Computer\Control Panel }
  CSIDL_PRINTERS                      = $0004; { My Computer\Printers }
  CSIDL_PERSONAL                      = $0005; { My Documents.  This is equivalent to CSIDL_MYDOCUMENTS in XP and above }
  CSIDL_FAVORITES                     = $0006; { <user name>\Favorites }
  CSIDL_STARTUP                       = $0007; { Start Menu\Programs\Startup }
  CSIDL_RECENT                        = $0008; { <user name>\Recent }
  CSIDL_SENDTO                        = $0009; { <user name>\SendTo }
  CSIDL_BITBUCKET                     = $000a; { <desktop>\Recycle Bin }
  CSIDL_STARTMENU                     = $000b; { <user name>\Start Menu }
  CSIDL_MYDOCUMENTS                   = $000c; { logical "My Documents" desktop icon }
  CSIDL_MYMUSIC                       = $000d; { "My Music" folder }
  CSIDL_MYVIDEO                       = $000e; { "My Video" folder }
  CSIDL_DESKTOPDIRECTORY              = $0010; { <user name>\Desktop }
  CSIDL_DRIVES                        = $0011; { My Computer }
  CSIDL_NETWORK                       = $0012; { Network Neighborhood (My Network Places) }
  CSIDL_NETHOOD                       = $0013; { <user name>\nethood }
  CSIDL_FONTS                         = $0014; { windows\fonts }
  CSIDL_TEMPLATES                     = $0015;
  CSIDL_COMMON_STARTMENU              = $0016; { All Users\Start Menu }
  CSIDL_COMMON_PROGRAMS               = $0017; { All Users\Start Menu\Programs }
  CSIDL_COMMON_STARTUP                = $0018; { All Users\Startup }
  CSIDL_COMMON_DESKTOPDIRECTORY       = $0019; { All Users\Desktop }
  CSIDL_APPDATA                       = $001a; { <user name>\Application Data }
  CSIDL_PRINTHOOD                     = $001b; { <user name>\PrintHood }
  CSIDL_LOCAL_APPDATA                 = $001c; { <user name>\Local Settings\Application Data (non roaming) }
  CSIDL_ALTSTARTUP                    = $001d; { non localized startup }
  CSIDL_COMMON_ALTSTARTUP             = $001e; { non localized common startup }
  CSIDL_COMMON_FAVORITES              = $001f;
  CSIDL_INTERNET_CACHE                = $0020;
  CSIDL_COOKIES                       = $0021;
  CSIDL_HISTORY                       = $0022;
  CSIDL_COMMON_APPDATA                = $0023; { All Users\Application Data }
  CSIDL_WINDOWS                       = $0024; { GetWindowsDirectory() }
  CSIDL_SYSTEM                        = $0025; { GetSystemDirectory() }
  CSIDL_PROGRAM_FILES                 = $0026; { C:\Program Files }
  CSIDL_MYPICTURES                    = $0027; { C:\Program Files\My Pictures }
  CSIDL_PROFILE                       = $0028; { USERPROFILE }
  CSIDL_SYSTEMX86                     = $0029; { x86 system directory on RISC }
  CSIDL_PROGRAM_FILESX86              = $002a; { x86 C:\Program Files on RISC }
  CSIDL_PROGRAM_FILES_COMMON          = $002b; { C:\Program Files\Common }
  CSIDL_PROGRAM_FILES_COMMONX86       = $002c; { x86 C:\Program Files\Common on RISC }
  CSIDL_COMMON_TEMPLATES              = $002d; { All Users\Templates }
  CSIDL_COMMON_DOCUMENTS              = $002e; { All Users\Documents }
  CSIDL_COMMON_ADMINTOOLS             = $002f; { All Users\Start Menu\Programs\Administrative Tools }
  CSIDL_ADMINTOOLS                    = $0030; { <user name>\Start Menu\Programs\Administrative Tools }
  CSIDL_CONNECTIONS                   = $0031; { Network and Dial-up Connections }
  CSIDL_COMMON_MUSIC                  = $0035; { All Users\My Music }
  CSIDL_COMMON_PICTURES               = $0036; { All Users\My Pictures }
  CSIDL_COMMON_VIDEO                  = $0037; { All Users\My Video }
  CSIDL_RESOURCES                     = $0038; { Resource Directory }
  CSIDL_RESOURCES_LOCALIZED           = $0039; { Localized Resource Directory }
  CSIDL_COMMON_OEM_LINKS              = $003a; { Links to All Users OEM specific apps }
  CSIDL_CDBURN_AREA                   = $003b; { USERPROFILE\Local Settings\Application Data\Microsoft\CD Burning }
  CSIDL_COMPUTERSNEARME               = $003d; { Computers Near Me (computered from Workgroup membership) }
  CSIDL_PROFILES                      = $003e; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T22:45:22.153

见[这篇文章](http://delphi.about.com/cs/adptips2003/a/bltip0703_2.htm)。

**编辑：**

正如 stukelly 在评论中所添加的，有更多关于 SHGetFolderPath() 功能的信息。Delphi VCL 确实应该具有获取标准路径的功能，如果 Embarcadero 确实要在另一个操作系统上拥有另一个类似 Delphi 的工具，这将更加重要。有关系统标准路径的多平台实现，另请参阅wxWidgets[中的 wxStandardPaths 文档](http://docs.wxwidgets.org/trunk/classwx_standard_paths.html)。在 MSW 上，这使用各种*CSIDL_XXX*常量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T22:49:25.233

假设您可以从 Delphi 进行 WinAPI 调用（您可以使用 ISTR），那么您过去可以通过 API 调用（例如 GetSystemFolder 或 GetUserDataFolder）来做到这一点。自从我不得不这样做已经有一段时间了，但我认为您现在可以通过传入 CSIDL_LOCAL_APPDATA来使用[SHGetFolderPath来做到这一点。](http://msdn.microsoft.com/en-us/library/bb762181(VS.85).aspx)

# autofac - Autofac参数传递

> ID：471125
> 
> 赞同：1
> 
> 时间：2009-01-22T22:35:56.963
> 
> 标签：autofac

我一直在尝试集成最新版本的 autofac (1.3.3.54)，但遇到了以下问题。

根据项目的 Google 代码 wiki，在注册回调中使用参数的推荐方式如下：

builder.Register((c, p) => new Foo(p.Get("arg1")));

但是，这不会与提到的 autofac 代码版本一起编译。我查看了源代码，发现 p 是一个 IEnumerable (ComponentActivatorWithParameters)。相对于文档，代码是否已过时？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-10T20:18:10.330

似乎代码已更改，Wiki 上的文档尚未更新。“Get”方法现在是“Named”，“Parameter”类现在是“NamedParameter”。请参见以下示例：

```
var builder = new ContainerBuilder();
builder.Register((c, p) => new Person(p.Named<string>("name")));

using (var container = builder.Build())
{
    var person = container.Resolve<Person>(new NamedParameter("name", "Fred"));    
} 
```

希望有人可以尽快更新文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-30T04:57:28.480

我已将[AutoFac 1.3 的新构建文档](http://autofac.googlecode.com/issues/attachment?aid=6293300825444929666&name=autofac-1.3.chm)附加到 AutoFac 问题[#121](http://code.google.com/p/autofac/issues/detail?id=121)。我希望他们至少在他们退出 1.3 分支并支持 .NET 2.0 之前恢复发布官方 1.3 文档。

# gwt - GWT 获取用户本地十进制分隔符 char

> ID：471132
> 
> 赞同：3
> 
> 时间：2009-01-22T22:36:23.497
> 
> 标签：gwt, formatting

如何从 GWT 获取用户本地小数分隔符。我找到了 NumberFormat 实用程序，它只返回整个格式并提供解析。

```
NumberFormat.getDecimalFormat()... 
```

有没有一种（简单的）方法可以从十进制格式中获取小数分隔符、千位分隔符。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2011-05-02T10:04:11.777

```
import com.google.gwt.i18n.client.LocaleInfo;

String decimalSeparator = LocaleInfo.getCurrentLocale().getNumberConstants().decimalSeparator();
String thousandSeparator = LocaleInfo.getCurrentLocale().getNumberConstants().groupingSeparator(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-25T07:23:34.883

您可以使用已知数字对其进行播种，然后将其解析为您想要的字符。

```
import com.google.gwt.i18n.client.NumberFormat;

NumberFormat fmt = NumberFormat.getDecimalFormat();
double value = 1234.5;
String formatted = fmt.format(value);
String thousandSeparator = formatted.substring(1,2);
String decimalSeparator = formatted.substring(5,6); 
```

# silverlight - 在 Linux 服务器上托管 Silverlight 应用程序有什么问题吗？

> ID：471139
> 
> 赞同：4
> 
> 时间：2009-01-22T22:39:06.287
> 
> 标签：silverlight, hosting, web-hosting, lamp

我正在为摄影工作室构建一个新的 Silverlight 应用程序。我正要说“你必须有一个基于 Windows 的服务器来托管它”，然后我想，等一下，对吗？好像不是。所以我可以将他指向一个 Linux 主机。

我知道您必须注册 MIME 类型（来自不同的 SO 线程）。还有其他需要了解的注意事项或陷阱吗？假设我对 Linux 几乎一无所知。

编辑：如果应用程序需要与数据库（mySQL）通信怎么办？好像我需要有月光才能做到这一点，这不会飞。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-22T23:12:38.120

您唯一需要做的就是确保 Web 服务器为 .xap 提供正确的 MIME 类型（即 application/x-silverlight-app）。就是这样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T22:43:36.150

没有什么能阻止您在任何平台上的任何网络服务器中托管 Silverlight 应用程序（客户端插件）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T02:58:45.590

Silverlight 是客户端技术。在非 MS 服务器上托管不需要任何东西（但 MIME 类型）。但是，如果您有服务器端代码（例如，Web 服务或 REST API 与您的 mySQL 数据库通信），那么该服务器端技术将需要在 Linux 上运行。这与 Silverlight 完全不同。您可能想用 Java 或 PHP（或其他 Linux 友好平台）来做服务器工作，但 Silverlight 并不关心它与什么对话，并且可以轻松地在非 MS 平台上提供服务。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-24T21:33:39.443

关于您的编辑（在 mysql 上）——不，您不需要 Moonlight（因为那也只是客户端）。正如 Shawn 所说，您需要通过某种服务层来公开您的数据库功能。

# javascript - 你能让我轻松理解动态的抽象事件对象吗？

> ID：471144
> 
> 赞同：2
> 
> 时间：2009-01-22T22:40:12.493
> 
> 标签：javascript, event-driven

我已经使用 MFC 为 GUI 按钮编写了 C++ 事件驱动应用程序，并且我使用诸如 onmousedown 之类的 HTML 事件来触发网页中的一些 Javascript。当您使用界面并且事件是硬编码的时，事件驱动编程的想法很直观。

我知道如何在 C 中使用函数指针，并且了解 Windows 如何使用它们来运行事件循环。我可以编写代码来动态调用不同的函数。

我的问题是，从编译时转移到运行时。我在这里说的是任何语言，但是如果您需要一种语言，请选择 Javascript 或 PHP，因为这些天我最常使用它们。我完全不知道如何使用自己的事件对象来完成某事。这不是我得到的概念。而且由于我不使用它们，我不知道它们的实际用途可能是什么。

例如，我假设如果我想制作一个自定义的回合制游戏，我可能会使用事件对象来表示某个游戏片段能力的效果，该效果只需要“发生”。

有人可以给我简单地使用自定义事件吗？或者它有用或实用的情况？它是否很大程度上取决于语言和环境以及事件的处理方式？一个 Javascript 答案会很好，但我读过很多语言。

抱歉，我只是在这方面有欠缺，需要一些实用的、高级的（中级？）洞察力。这就像 C 中的指针。我“得到”指针以及它们如何成为你的朋友。但有一段时间我没有，我认识的很多人仍然没有。一旦你得到它就很简单，我只是不会以这种方式获得自定义的动态事件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-23T08:38:42.377

当我们谈论面向事件的编程时，我们通常谈论的是[观察者设计模式](http://www.google.com/search?hl=en&client=firefox-a&rls=org.mozilla%3Aen-US%3Aofficial&hs=E6G&q=observer+design+pattern&btnG=Search)的一种或多种实现。观察者设计模式的一个目标是实现对象之间的[松散耦合](http://www.google.com/search?q=loose+coupling&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:official&client=firefox-a)。

如果没有一个好的例子，这可能并没有多大意义，而且肯定有很多好的例子；我怀疑我的会是他们中最好的，但我还是会尝试一下。想象两个物体。一个对象想知道另一个对象什么时候发生了什么事，所以它可以自己做一些事情——也许家里的狗 Rover 想在爸爸下班回家时在门口迎接他。有几种方法可以编程该场景，对吧？

*   确保爸爸有对 Rover 的引用，当他回家时，调用 Rover 的 greetDatAtTheDoor() 方法，或者

*   给 Rover 一个对 dad 的引用，监听 Dad 的 onArriveHome 事件，当它触发时，在内部调用 greetDadAtTheDoor()。

从表面上看，两者似乎没有太大区别，但实际上，爸爸对罗孚的一些执行情况有一些印象；如果出于某种原因必须更改 Rover 的实现，我们必须在两个地方进行更改：一次在 Rover 中，然后再次在 Dad 中。也许不是什么大不了的事，但仍然不理想。

现在想象妈妈也想和爸爸打招呼。而猫，Bigglesworth先生，他不太喜欢爸爸，想确保他不在身边，所以他宁愿出去。邻居乔想知道爸爸什么时候回家，这样他就可以因为爸爸欠他的二十美元而烦恼他。我们如何解释所有这些情况，以及不可避免地会出现的其他情况？将对妈妈的 greetHusband() 方法、猫的 getOutNow() 方法、狗的 greetDadAtTheDoor() 方法和 Joe 的 goGetMyMoney() 方法的引用放入爸爸的类定义中，这对爸爸来说很快就会搞砸——而且没有充分的理由，因为所有爸爸真正需要做的，就是自己回家。妈妈、狗、猫和邻居只想在发生这种情况时得到通知，

语言以不同的方式处理这些东西的细节，但是当你开始谷歌搜索时你会看到，这种模式通常涉及在事件“调度程序”上存在一个数组或类似数组的结构（在这种情况下，爸爸-- 即，其他人都感兴趣的对象）和“订阅者”（例如，妈妈、猫、Rover 和乔）都通过调用调度程序上公开的方法并传递对自己的引用来“注册” ——以某种形式出现在爸爸的“订阅者”数组中的引用。然后，当爸爸回家时，他“调度”了一个事件——“我到家了！” 比如说事件——本质上是一个函数，它循环遍历他的每个订阅者，并用他们自己的一些可公开访问的方法调用它们——只有它'

由于这些天我碰巧主要编写 ActionScript 代码，这就是它在我的世界中的样子——比如说，正如我在 Mom 类中声明的那样：

```
var dad:Dad = new Dad();
dad.addEventListener(DadEvent.ARRIVED_HOME, greetHusbandAtDoor);

private function greetHusbandAtDoor(event:DadEvent):void
{
   // Go greet my husband
} 
```

那么，在爸爸身上，当我回家时，我所要做的就是：

```
dispatchEvent(new DadEvent(DadEvent.ARRIVED_HOME)); 
```

...并且因为 Flash 为我处理事件调度和通知细节（同样，每个人的做法都有些不同，但在内部，Flash 遵循我所描述的概念模型），我爸爸回家了，每个家庭成员都这样做了它注册后自动执行的操作。

希望这能解释一些事情——事件思考是什么样的，松散耦合意味着什么，为什么它很重要，等等。祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T23:49:39.823

在编译语言中，您编写自己的事件循环。在运行时语言中，它已经由宿主环境实现，程序员只得到一个抽象的接口进入事件系统。你永远不会看到事件循环。

使用事件构建功能有两个方面。首先是定义事件触发的条件。在浏览器中的 javascript 中，没有单个`mousedown`事件。事实上，页面上的每个元素都有一个。在这种情况下，它们中的任何一个何时触发的条件都基于鼠标光标的位置，以及鼠标按钮是否刚刚从向上状态切换到向下状态。这种情况可能会导致触发多个事件。（在浏览器中，有一个`bubbling`与此相关的称为事件的东西。但这超出了这里的范围）。

另一个方面是事件处理程序。无论是否有处理程序，事件都会发生。提供处理程序取决于您。在 javascript 中，函数是一等值。它们是在运行时定义的，而不是在编译时定义的。所以不需要指针或跳转表。您在运行时创建一个新函数，并将其分配给宿主环境在特定事件触发时查找的特殊属性。

所以在堆栈溢出时，每个向下箭头的事件都会有一个事件处理程序`onclick`，它将箭头变为红色，减少一个数字，检查一些其他变量并有条件地显示一个通知。然后当处理程序返回时，它将线程的控制权返回给浏览器，哈利路亚用户可以再次与浏览器交互。（处理事件时所有交互都会停止，因此您最好尽快处理）。这是一个使用 jquery 库的示例。

```
jQuery("a .downarrow")
.click(function(e){ e.target.style.color="red" /* ... do other things */ }); 
```

或者在原始 JavaScript（1.6 版）中，它可能是

```
Array.prototype.slice.apply(document.getElementsByTagName("a"))
.filter(function(o){ return !!(/downarrow/).exec(o.className)})
.forEach(function(o){ 
    o.onclick= function(e){ 
        e.target.style.color="red" /* ...do other things * / 
    }
 }); 
```

真的就是这么简单。你会做这样的事情的主要原因是它允许异步交互。GUI 应用程序不会一步一步地直线前进。它必须动态响应用户的输入。事件是一种伪造多线程应用程序外观的方法。它可以让用户看到许多事情正在同时发生而不会相互中断。

您可以使用库来定义自定义事件。这可能会编码一些特定领域的事件。例如：您有一个国际象棋游戏正在考虑下一步行动。搜索移动的过程超时。国际象棋游戏可以触发一个`onComputerMove`事件。您可以使用获取移动规范的函数来处理该事件，并更新棋盘的视觉表示，并为用户弹出一条消息，然后退出。然后，当玩家移动时，您可以触发一个`onPlayerMove`事件，它的作用大致相同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T02:21:37.927

事件最美妙的地方在于减少了两个模块或类之间的双向显式耦合。

所以假设我有两个班级：宝贝和妈妈

* * *

没有事件，我大致看到了两种让妈咪喂宝宝的方法：

*   妈妈`baby.pokeBelly()`每半小时调用一次 Baby 上的方法，以了解您是否需要调用`baby.fillWith(milk)`。
    *问题是妈咪的线程要在一个while循环中baby之后等待一整天*
*   Baby 知道其关联的 Mommy 并调用一个`mommy.feed(me)`方法，该方法又调用`baby.fillWith(milk)`.
    *那么问题来了，让一个简单的婴儿请合适的妈妈来填饱肚子。
    婴儿不这样做，因为他们应该保持简单。*

* * *

使用事件，您可以将 a 绑定`Mommy.OnBabyCries(baby)`到其婴儿的`baby.Cry`事件：

> ```
> void Mommy.OnBabyCries(baby) {
>     baby.fillWith(milk)
> } 
> ```

在此之后，如果婴儿想吃东西，它所要做的就是提高它的 Cry 事件。

逻辑留在妈妈身上，甚至以后在任何保姆身上，宝贝都保持快乐，而不必担心。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T22:53:03.557

我不知道我是否完全理解你的问题，但是一个带有事件的类就像一个带有按钮的 GUI。把它想象成一个homnculus......在每个有事件的班级里都有一个小人，有一个可以按下的虚拟按钮。他不知道按钮会做什么，但他知道什么时候按下它。现在想想一个相关的类，里面有另一个小人物。那个人知道，当他听到按下按钮的消息时，他应该做点什么。

每当您想让第二个人知道第一个人所做的事情时，您可以在第一类和第二类之间连接总机（订阅事件）。当第一个人按下按钮（触发事件）时，第二个人做他知道他应该做的任何事情......

我不知道这是否有帮助，或者我只是在想我的程序中的小人物。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-22T23:07:35.137

在`StackOverflow`，当您投反对票时，您的声望下降并且您的向下箭头变为红色。

通常，您编写一个`onclick`，更新其中的所有元素，并尽量不要忘记在每次页面布局更改时更改它。

相反，您可以声明`onVoteDown`事件、触发它`onclick`并订阅此事件：

*   你的声誉`div`
*   你的箭`img`
*   您`XmlHTTPRequest`将您的投票发送到服务器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-22T23:31:35.837

我不完全确定您正在寻找什么样的答案，所以如果这不是很接近，我深表歉意。;)

* * *

***自定义***是指***自定义操作***、***自定义触发器***还是真正***自定义的事件***？

例如：***自定义操作***将响应预定义的事件（例如，鼠标单击），***自定义触发器***将通过脚本伪造鼠标单击，***自定义事件***将是未由语言定义或未定义的侦听器t 随时可用。

如果您正在寻找**自定义事件**，我真的无法帮助您。不过，我认为 JavaScript 对它们的支持并不多。

* * *

定义一个**动作**...

事件通常是通过对象的预定义属性建立的，比如`window.onload`。默认情况下，它们都等于`undefined`或`null`。因此，要使用它们，您必须将它们设置为函数的值。

您可以使用“匿名”功能：

```
window.onload = function (eventObject) {
    /* ... */
}; 
```

或者将它们设置为函数引用（不一样，但类似于指针）：

```
function handleOnload(eventObject) {
    /* ... */
}

window.onload = handleOnload; /* note the lack of parenthesis */ 
```

当事件被触发时，函数被调用。因此，在任一设置中，当页面完成加载时，您放置的代码`/* ... */`将被执行。

还有更正式的方法可用于创建事件。W3C 定义`addEventListener`，而 IE 使用`attachEvent`. [更多信息](http://www.quirksmode.org/js/events_advanced.html)。

有很多参考资料可用于了解可用事件列表。这里有两个应该给你一个很好的基础：

*   [W3学校](http://www.w3schools.com/jsref/jsref_events.asp)
*   [数据中心](https://developer.mozilla.org/en/DOM/element#Event_Handlers)

* * *

浏览器通常处理事件的触发——浏览器事件 ( `onload`) 或用户事件 ( `onclick`)。属性和函数是用来响应的。

**触发**您自己的事件并不是最容易完成的事情。完全定义一个`Event`对象需要一些工作 - 并且[因浏览器](http://www.javascriptkit.com/jsref/event.shtml)而异。

但是，如果您不需要该`Event`对象，则可以简单地调用该事件：

```
window.onload(); 
```

# visual-studio - 如何确定哪些 Visual Studio 解决方案使用哪些项目？

> ID：471154
> 
> 赞同：5
> 
> 时间：2009-01-22T22:44:18.100
> 
> 标签：visual-studio, projects-and-solutions

我有一个由多个项目文件和多个解决方案文件组成的软件项目。解决方案文件与项目文件具有一对多的关系，并且给定的项目文件可能出现在多个不同的解决方案文件中。

有没有什么好的/漂亮的方法来绘制解决方案文件和项目文件之间的关系图？通过VS或某种实用程序。

我想做的是说“嘿，在这个目录及其子目录中有许多解决方案文件和项目文件 - 请告诉我哪些解决方案使用哪些项目并为我映射出来”

我意识到可以通过打开每个解决方案文件并检查它来产生净效果，但我正在寻找一种自动化的、可重复的操作。

**编辑：**恐怕我也有可以追溯到 VS2003 的解决方案/项目组合，所以我也需要映射它们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-23T01:29:12.837

除了 Gordon Wilson 的帖子之外，您还可以尝试在 C# 中构建相同的内容，并使用[QuickGraph](http://www.codeplex.com/quickgraph)和[GraphViz](http://www.graphviz.org/)创建一个显示相同内容的图表。

QuickGraph 可用于在内存中创建图形结构并输出点文件，Graphviz 可以从中加载并创建漂亮的图表。两个站点上的文档都应该为您提供足够的信息。

** 编辑 ** 请参阅[此处](http://www.jamiepenney.co.nz/2009/02/10/viewing-dependencies-between-projects-in-visual-studio)了解我开始的一个小型项目，它可以满足您的一些需求。您最多可以在几个小时内添加您需要的任何内容。随意拿走它并随心所欲地使用它，如果您愿意，请给我留言。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T23:00:22.607

项目文件和解决方案文件都是文本文件。项目文件不知道他们的解决方案，所以我们必须查看他们项目的解决方案。

解决方案文件中的项目条目如下所示：

```
Project("{9AC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "ProjectName", "ProjectDirectory\ProjectFileName.vcproj","{9A95F635-B74F-4640-BBCF-E324D0972CA9}"
EndProject 
```

所以你可以看到，我们可以抓取项目名称和项目文件的相对路径。

使用您最喜欢的脚本语言，您可以执行以下操作。（红宝石示例）

```
require 'find'

def project_name(string)
  string =~ /= "(.+?)"/
  $1
end

#the script doesn't use this method but you may want it
def project_path(string)
  string =~ /, "(.+?)"/
  $1
end

def find_projects(path)
  puts "#{path} contains the following projects:"
  open(path).read.gsub(/Project\(.+?EndProject/m) do |match|
    puts project_name(match)
  end
  puts ""
end

#change File.dirname(__FILE__)) to the name of the directory you want to search.
Find.find(File.dirname(__FILE__)) do |path|
  if FileTest.directory?(path)
    if File.basename(path) =~ /^\../ # Directory name starts with .
      Find.prune       # Don't look any further into this directory.
    else
      next
    end
  elsif path =~ /\.sln$/
    find_projects(path)
  end
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T22:58:04.110

一个简单的 python (perl?) 脚本，带有几个很好的位置正则表达式。
每个项目都有自己的 GUID。查找映射只是查找项目的 GUIDS 并在解决方案文件中查找它们的问题。

# random - 随机序列的子集是否也是随机的？

> ID：471157
> 
> 赞同：8
> 
> 时间：2009-01-22T22:45:00.610
> 
> 标签：random

鉴于：

*   一系列随机数
*   X 客户端从序列中选择 Y 号，形成自己的子序列
*   管理选择过程的规则未知

是否有一个数学属性可以保证每个客户端最终都会得到一个随机的数字序列？也就是说，无论选择过程如何，随机序列的子集是否也保证是随机的？

**更新**：我试图确定是否可以使用单个随机数生成器将值分发给多个客户端：[是否存在无状态随机数生成器？](https://stackoverflow.com/questions/203382/do-stateless-random-number-generators-exist)-- 即客户端从序列中选择元素而不进行替换。话虽如此，我也想知道一般情况（当不知道选择规则时）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-22T22:48:43.083

如果控制选择过程的规则包括对实际值的认识（可能是这种情况，因为这些规则是未知的），则子集将不是随机的。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-22T23:17:01.857

是的，您的子序列将是随机的（[联合熵](http://en.wikipedia.org/wiki/Joint_entropy)），假设对您的选择标准的一个限制是您“不放回任何东西”。换句话说，您不能在选择子序列时优先过滤它。那么选择的类型就无关紧要了……您总是可以选择奇数位或偶数位或前 10 位，或者您想选择的任何方式，并且您的子序列将具有那么多的熵位。

当然，选择相同的位不会添加到您的总熵中，因为该位中没有剩余的熵可以添加到您的系统中。但是第二次选择该位的方式（即，如果它是随机选择）本身可能会增加一些熵。

也就是说，每个客户获得的每个子序列之间可能存在高度相关性，原因很明显，他们可能使用相同或重叠的选择标准。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-23T00:01:25.043

“随机数序列”中的“随机”一词通常被解释为表示从查看序列的任何其他元素中没有关于该序列的任何元素的附加信息。（即元素 X [i][的先验和后验概率分布](http://en.wikipedia.org/wiki/Prior_probability)在研究任何其他元素之前和之后是相同的。）

只要没有一个数字被多个客户使用，你应该没问题。（编辑：正如其他人所提到的，在查看其中一个元素的价值后，您不能决定接受它。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-22T22:49:11.693

不，因为如果两个客户端都选择相同或接近的位置来开始序列，则两者都具有相同的数据。他们单独拥有随机数据，但如果您尊重超过 1 个用户，则不会。

只有确保每个号码只能由一个用户访问，然后可能会从列表中删除，才能生成随机数据。当然，在这种情况下，您也可以只使用普通的随机数生成器。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-22T23:18:15.800

> 是否有一个数学性质可以保证...

除了“MusiGenesis”和“gs”给出的反例之外，我认为统计学中有一个数学属性（公理或定理，我不知道是哪个）：这说明了**统计**父母群体的属性或多或少地反映在随机选择的样本的属性中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-22T22:56:21.117

如果

*   客户数量是随机的
*   选择的数量是随机的
*   第一个随机序列的大小是随机的

然后......不，它似乎仍然不是因为客户的选择数量可能大于第一个序列，在这种情况下，随机性将消失，因为客户必须决定在制作时要做什么挑选，一无所获。

如果第一个序列的大小是无限的，也许它会起作用。

编辑：对不起，你可能在这里寻找数学的东西，以证明的形式。我没有这样的证据:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-22T23:16:06.507

我认为使序列随机的部分原因是能够运行相同的算法并获得不同的、不可预测的结果。

在您的描述中，如果您重复该过程并且相同的 X 客户从原始序列中选择 Y 数字，他们是否会选择相同的子序列，从而获得可重复、可预测的结果？

如果是这样，我会说这似乎不是一个随机过程。但是，如果您的子序列选择包含随机性元素，那么子序列将在连续运行时有所不同，否则相同运行，并且子序列可以被认为是随机的。

# comparison - 比较声音文件（如果不完全相同）

> ID：471165
> 
> 赞同：26
> 
> 时间：2009-01-22T22:48:41.117
> 
> 标签：comparison, audio

有没有办法以编程方式比较两个声音文件以确定它们是否相同或几乎相同？这些不是 mp3 文件，也没有任何 ID3 或其他元数据，而是纯 wav 文件。比较校验和值可能不起作用，因为它们可能不完全相同。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-22T23:01:04.867

关于声学指纹的[维基百科文章](http://en.wikipedia.org/wiki/Acoustic_fingerprint)提到了许多产品，包括开源 libfooid。基本上，您正在考虑进入频域，在相对较少的频段（例如 32 个）上获取粗略的电平，为您提供一个代表 25 毫秒声音的字符串，对整个文件执行此操作，然后执行对不同文件的这些字符串进行模糊比较。这是相当复杂的，但需要做 - 比较实际样本不会让你得到任何结果，因为像音量变化几个百分比这样简单的事情会抛出整个匹配。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-23T13:13:00.810

在计算机科学研究中，比较一组声音的相似性的过程称为基于内容的音频[索引](http://www.google.com/search?q=content+based+audio+indexing)、[检索](http://www.google.com/search?hl=en&sa=X&oi=spell&resnum=0&ct=result&cd=1&q=content+based+audio+retrieval&spell=1)和[指纹识别。](http://www.google.com/search?hl=en&q=content+based+audio+fingerprinting&btnG=Search)

一种方法是：

1) 对每个音频文件运行几位信号处理以提取特征，例如随时间变化的音高、频谱、自相关、动态范围、瞬态等。

2）将每个音频文件的所有特征放入一个多维数组中，并将每个多维数组转储到数据库中

3) 使用优化技术（例如[梯度下降](http://en.wikipedia.org/wiki/Gradient_descent)）在您的多维数据数据库中找到给定音频文件的最佳匹配。

使这项工作顺利进行的诀窍是哪些功能

有几个项目可以做这样的事情，包括[MusicBrainz](http://musicbrainz.org/)和[EchoNest](http://the.echonest.com)。

Echonest 拥有我在这个领域见过的[最简单的 API之一。](http://developer.echonest.com/)很容易上手。

PS 不，我不为 Echonest 工作，也不认识在那里工作的任何人。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-22T22:58:27.433

您可以尝试的一件可以为您提供相当不错的文件指纹的方法是进行[傅里叶变换](http://en.wikipedia.org/wiki/Fourier_transform)并查看文件中存在的不同频率的分布。仍然很有可能制作两个具有相同傅立叶变换的非常不同的声音文件，但如果您的文件来自非人为的来源，这有点不太可能......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T22:53:30.873

您可以逐个样本比较两个 WAV 文件，并计算每个样本的平均差异。为了加快速度，您可以使用相同的方法，但每 10 个样本或每 100 个样本进行比较并得出基本相同的值（两个不同甚至接近的文件将具有巨大的每个样本平均差异）。

# html - 如何对齐 MySpace 页面上的图像？

> ID：471174
> 
> 赞同：3
> 
> 时间：2009-01-22T22:52:30.173
> 
> 标签：html, css, myspace

我想将图片放在我的 myspace 页面顶部，在我的乐队资料上的广告上方。我可以很好地放一张图片，但是当我尝试将图片放在一张上时，它们只会相互重叠。

我想做这样的[事情](http://www.myspace.com/adaytoremember)。

关于如何解决这个问题的任何提示？

我用了：

```
<style type="text/css"> 
  body { 
    background-position:top center;margin-top: H;
  }
  div.topbanner {
    top: 150%;
    left: 49%;
    margin-left: -600px;
    width: 100%;
    height: 800px;
    position: absolute;
  }
</style>
<div class="topbanner">
  <IMG SRC="http://www.victoryhardcore.com/myspaceimages/atdr/homesick/adtr_myspace_top_26.jpg" border="0">
</div> 
```

这是我到目前为止所拥有的：

[http://profile.myspace.com/index.cfm?fuseaction=user.viewprofile&friendid=446378267](http://profile.myspace.com/index.cfm?fuseaction=user.viewprofile&friendid=446378267)

我想要一张上面的图片，但是每当我再次输入代码时，新图片就位于旧图片的顶部。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T23:13:50.367

您要复制的页面使用表格布局，每个单元格中都有图像：

只是为了显示第一行：

```
<table width="1260" height="1414" border="0" cellpadding="0" cellspacing="0">
  <tr>
    <td colspan="5" rowspan="2">
      <img src="image01.jpg" width="481" height="107" alt="">
    </td>
    <td colspan="6">
      <img src="image02.jpg" width="290" height="47" alt="">
    </td>
    <td colspan="5" rowspan="2">
      <img src="image03.jpg" width="489" height="107" alt="">
    </td>
  </tr>
  <tr>
    <td colspan="6">
    </td>
  </tr>
  <tr>
    <td>
      <img src="image05.jpg" width="239" height="428" alt="">
    </td>
    <td colspan="14">
    </td>
    <td>
      <img src="image07.jpg" width="244" height="428" alt="">
    </td>
  </tr>
</table> 
```

复制它需要一些时间;-)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T23:03:04.520

这是因为您正在使用`position: absolute`，大概是两个，所以他们试图坐在彼此之上。尝试制作第二个`position:relative`。

# linux - 命令行：在 grep 匹配的所有文件名中搜索和替换

> ID：471183
> 
> 赞同：81
> 
> 时间：2009-01-22T22:54:15.850
> 
> 标签：linux, perl, awk, sed, grep

我正在尝试在 grep 匹配的所有文件中搜索和替换字符串：

`grep -n 'foo' *`将以以下形式给我输出：

```
[filename]:[line number]:[text] 
```

对于 grep 返回的每个文件，我想通过替换为来修改`foo`文件`bar`。

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2009-01-23T01:41:57.227

This appears to be what you want, based on the example you gave:

```
sed -i 's/foo/bar/g' * 
```

It is not recursive (it will not descend into subdirectories). For a nice solution replacing in selected files throughout a tree I would use find:

```
find . -name '*.html' -print -exec sed -i.bak 's/foo/bar/g' {} \; 
```

The `*.html` is the expression that files must match, the `.bak` after the `-i` makes a copy of the original file, with a .bak extension (it can be any extension you like) and the `g` at the end of the sed expression tells sed to replace multiple copies on one line (rather than only the first one). The `-print` to find is a convenience to show which files were being matched. All this depends on the exact versions of these tools on your system.

* * *

## 回答 #2

> 赞同：70
> 
> 时间：2009-01-22T22:57:36.293

您的意思是在所有与 grep 匹配的文件中搜索并替换字符串？

```
perl -p -i -e 's/oldstring/newstring/g' `grep -ril searchpattern *` 
```

**编辑**

因为这似乎是一个相当受欢迎的问题，所以我想更新一下。

现在我主要使用`ack-grep`它，因为它更加用户友好。所以上面的命令是：

```
perl -p -i -e 's/old/new/g' `ack -l searchpattern` 
```

要处理文件名中的空格，您可以运行：

```
ack --print0 -l searchpattern | xargs -0 perl -p -i -e 's/old/new/g' 
```

你可以做更多的事情`ack-grep`。假设您只想将搜索限制为 HTML 文件：

```
ack --print0 --html -l searchpattern | xargs -0 perl -p -i -e 's/old/new/g' 
```

如果空白不是问题，它甚至更短：

```
perl -p -i -e 's/old/new/g' `ack -l --html searchpattern`
perl -p -i -e 's/old/new/g' `ack -f --html` # will match all html files 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-01-22T22:59:28.007

If your `sed(1)` has a `-i` option, then use it like this:

```
for i in *; do
  sed -i 's/foo/bar/' $i
done 
```

If not, there are several ways variations on the following depending on which language you want to play with:

```
ruby -i.bak -pe 'sub(%r{foo}, 'bar')' *
perl -pi.bak -e 's/foo/bar/' * 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-07-20T18:14:03.427

I like and used the above solution or a system wide search and replace among thousands of files:

```
find -name '*.htm?' -print -exec sed -i.bak 's/foo/bar/g' {} \; 
```

I assume with the '*.htm?' instead of .html it searches and finds .htm and .html files alike.

I replace the .bak with the more system wide used tilde (~) to make clean up of backup files easier.

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-12-21T16:58:47.337

This works using grep without needing to use perl or find.

```
grep -rli 'old-word' * | xargs -i@ sed -i 's/old-word/new-word/g' @ 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-12-01T13:40:56.393

`find . -type f -print0 | xargs -0 <sed/perl/ruby cmd>` will process multiple space contained file names at once loading one interpreter per batch. Much faster.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-03-22T06:15:52.003

The answer already given of using **find** and **sed**

`find -name '*.html' -print -exec sed -i.bak 's/foo/bar/g' {} \;`

is probably the standard answer. Or you could use `perl -pi -e s/foo/bar/g'` instead of the `sed` command.

For most quick uses, you may find the command **rpl** is easier to remember. Here is replacement (foo -> bar), recursively on all files in the current directory:

`rpl -R foo bar .`

It's not available by default on most Linux distros but is quick to install (`apt-get install rpl` or similar).

However, for tougher jobs that involve regular expressions and back substitution, or file renames as well as search-and-replace, the most general and powerful tool I'm aware of is **repren**, a small Python script I wrote a while back for some thornier renaming and refactoring tasks. The reasons you might prefer it are:

*   Support renaming of files as well as search-and-replace on file contents (including moving files between directories and creating new parent directories).
*   See changes before you commit to performing the search and replace.
*   Support regular expressions with back substitution, whole words, case insensitive, and case preserving (replace foo -> bar, Foo -> Bar, FOO -> BAR) modes.
*   Works with multiple replacements, including swaps (foo -> bar and bar -> foo) or sets of non-unique replacements (foo -> bar, f -> x).

[Check the README](https://github.com/jlevy/repren) for examples.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-11-19T03:35:32.500

This is actually easier than it seems.

```
grep -Rl 'foo' ./ | xargs -n 1 -I % sh -c "ls %; sed -i 's/foo/bar/g' %"; 
```

*   grep recurses through your tree (-R) and prints just the file name (-l), starting at the current directory (./)
*   that gets piped to xargs, which processes them one at a time (-n 1), and uses % as a placeholder (-I %) in a shell command (sh -c)
*   in the shell command, first the file name is printed (ls %;)
*   then sed does an inline operation (-i), a substution('s/') of foo with bar (foo/bar), globally (/g) on the file (again, represented by %)

Easy peasy. If you get a good grasp on find, grep, xargs, sed, and awk, almost nothing is impossible when it comes to text file manipulation in bash :)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2022-01-13T09:14:37.660

2022 answer.
[https://github.com/BurntSushi/ripgrep/blob/master/FAQ.md#how-can-i-search-and-replace-with-ripgrep](https://github.com/BurntSushi/ripgrep/blob/master/FAQ.md#how-can-i-search-and-replace-with-ripgrep)

```
rg foo --files-with-matches | xargs sed -i 's/foo/bar/g' 
```

will replace all instances of 'foo' with 'bar' in the files in which ripgrep finds the foo pattern. The -i flag to sed indicates that you are editing files in place, and s/foo/bar/g says that you are performing a substitution of the pattern foo for bar, and that you are doing this substitution globally (all occurrences of the pattern in each file).

# python - 如何从 VS 网站中删除 VSS 挂钩？

> ID：471190
> 
> 赞同：0
> 
> 时间：2009-01-22T22:56:34.957
> 
> 标签：python, visual-studio, visual-sourcesafe

我有一个 Visual Studio 2008 解决方案，其中包含 7 个不同的项目。其中 3 个“项目”是网站（没有项目文件的项目）。

我已经从所有目录中剥离了所有各种 Visual Sourcesafe 文件，删除了 SLN 文件中的 Scc 引用和所有存在的项目文件。我也删除了 SUO 文件和所有 USER 文件。Visual Studio 仍然认为其中 2 个网站仍处于源代码控制之下，它为我将 Scc 条目重新添加到 SLN 文件中。

**有人知道VS*如何*仍然了解旧的源代码控制吗？**

*编辑：* 我没有提到的另一件事是，我试图从中删除 VSS 挂钩的文件已被复制到 VSS 的已知工作目录之外，python 脚本运行和手动编辑在解决方案中打开之前所做的文件在 VS 2008 年或 VS 2005 年（我都遇到了问题）。

这是我用来清除这些文件并让我知道哪些文件需要手动编辑的 python 脚本。

```
import os, stat
from os.path import join

def main():
  startDir = r"C:\Documents and Settings\user\Desktop\project"

  manualEdits = []

  for root, dirs, files in os.walk(startDir, topdown=False):
    if '.svn' in dirs:
      dirs.remove('.svn')
    for name in files:
      os.chmod(join(root,name), stat.S_IWRITE)
      if name.endswith(".vssscc") or name.endswith(".scc") or name.endswith(".vspscc") or name.endswith(".suo") or name.endswith(".user"):
        print "Deleting:", join(root, name)
        os.remove(join(root,name))
      if name.endswith("sln") or name.endswith("dbp") or name.endswith("vbproj") or name.endswith("csproj"):
        manualEdits.append(join(root, name))

  print "Manual Edits are needed for these files:"
  for name in manualEdits:
    print name

if __name__ == "__main__":
  main() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T02:19:56.230

那些东西是有害的！Visual Studio 在任何地方都坚持到 SourceSafe 的链接，包括到构成 sln 文件的 XML 中。

我写了[一篇](http://billmill.org/ss2svn.html)关于我将 sourcesafe 转换为 subversion 的经验的文章，并附上了我用来清理垃圾的 python 脚本。请注意：

1）这是非常轻微的测试。进行备份，以免搞砸 sln/*proj 文件。前后运行你的测试套件，以确保它没有搞砸什么（怎么可能？谁知道呢！但奇怪的事情已经发生了。）

2) 这可能是考虑到不同版本的 sourcesafe 和 Visual Studio，因此您可能需要对其进行调整。无论如何，事不宜迟：

```
import os, re

PROJ_RE = re.compile(r"^\s+Scc")
SLN_RE = re.compile(r"GlobalSection\(SourceCodeControl\).*?EndGlobalSection",
                    re.DOTALL)
VDPROJ_RE = re.compile(r"^\"Scc")

for (dir, dirnames, filenames) in os.walk('.'):
    for fname in filenames:
        fullname = os.path.join(dir, fname)
        if fname.endswith('scc'):
            os.unlink(fullname)
        elif fname.endswith('vdproj'):
            #Installer project has a different format
            fin = file(fullname)
            text = fin.readlines()
            fin.close()

            fout = file(fullname, 'w')
            for line in text:
                if not VDPROJ_RE.match(line):
                    fout.write(line)
            fout.close()
        elif fname.endswith('csproj'):
            fin = file(fullname)
            text = fin.readlines()
            fin.close()

            fout = file(fullname, 'w')
            for line in text:
                if not PROJ_RE.match(line):
                    fout.write(line)
            fout.close()
        elif fname.endswith('sln'):
            fin = file(fullname)
            text = fin.read()
            fin.close()

            text = SLN_RE.sub("", text)

            fout = file(fullname, 'w')
            fout.write(text) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T00:11:25.007

它可能只是试图将它添加到您的 VS 实例上。您必须删除缓存，以便 VS 认为它不再属于 SS

1.  在文件 -> SourceControl -> 工作区下
2.  选择 SS 位置
3.  编辑
4.  选择工作文件夹
5.  消除！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T12:11:59.647

在您的 %APPDATA% 目录中，Visual Studio 保存了 Visual Studio 中使用的网站列表，以及该网站的一些设置：

在我的 Vista 机器上，文件的确切位置是

```
C:\Users\{name}\AppData\Local\Microsoft\WebsiteCache\Websites.xml 
```

该文件包含类似的条目

```
<?xml version="1.0" encoding="utf-16"?>
<DesignTimeData>
  <Website RootUrl="e:\Documents\Visual Studio 2008\WebSites\WebSite\"
      CacheFolder="WebSite" sccprovider="SubversionScc" scclocalpath="Svn"
      sccauxpath="Svn" addnewitemlang="Visual Basic" sccprojectname="Svn"
      targetframework="3.5" vwdport="60225" 
      _LastAccess="11-11-2008 10:58:03"/>
    <Website RootUrl="E:\siteje.webproj\" CacheFolder="siteje.webproj"
      _LastAccess="11-6-2008 14:43:45"/>
    <!-- And many more -->
</DesignTimeData /> 
```

如您所见，它包含 Scc 引用，这些引用也是您的解决方案文件的一部分。（在这种情况下，SCC 提供者是 AnkhSVN 2.0，因此它不包含实际的 SCC 映射；只是一些告诉 SCC 提供者查看工作副本的常量字符串）。

我认为试图通过在多个位置缓存此信息来修复丢失的项目文件。但是，如果该文件被正确记录，那将是受欢迎的。

# python - 为什么要编译 Python 代码？

> ID：471191
> 
> 赞同：277
> 
> 时间：2009-01-22T22:57:34.580
> 
> 标签：python, compilation

为什么要编译 Python 脚本？您可以直接从 .py 文件运行它们，它工作正常，那么有性能优势还是什么？

我还注意到我的应用程序中的一些文件被编译成 .pyc 而其他文件没有，这是为什么呢？

* * *

## 回答 #1

> 赞同：307
> 
> 时间：2009-01-22T23:06:13.687

它被编译成字节码，可以更快地使用。

`python main.py`某些文件未编译的原因是每次运行脚本时都会重新编译您调用的主脚本。所有导入的脚本都将被编译并存储在磁盘上。

*[Ben Blank](https://stackoverflow.com/users/46387/ben-blank)的重要补充：*

> 值得注意的是，虽然运行已编译的脚本具有更快的*启动* 时间（因为它不需要编译），但它并没有*运行*得更快。

* * *

## 回答 #2

> 赞同：87
> 
> 时间：2009-01-22T23:14:33.407

.pyc 文件是已经编译为字节码的 Python。如果 Python 找到与您调用的 .py 文件同名的文件，它会自动运行一个 .pyc 文件。

“Python 简介”这样[说](http://www.network-theory.co.uk/docs/pytut/CompiledPythonfiles.html)关于编译的 Python 文件：

> 从 '.pyc' 或 '.pyo' 文件读取程序不会比从 '.py' 文件读取程序运行得更快；'.pyc' 或 '.pyo' 文件唯一更快的是它们的加载速度。

运行 .pyc 文件的优点是 Python 不必在运行之前产生编译它的开销。由于 Python 无论如何都会在运行 .py 文件之前编译为字节码，因此除此之外不应该有任何性能改进。

使用已编译的 .pyc 文件可以获得多少改进？这取决于脚本的作用。对于仅打印“Hello World”的非常简短的脚本，编译可能占总启动和运行时间的很大一部分。但是对于运行时间较长的脚本，编译脚本相对于总运行时间的成本会降低。

您在命令行上命名的脚本永远不会保存到 .pyc 文件中。只有由该“主”脚本加载的模块才会以这种方式保存。

* * *

## 回答 #3

> 赞同：61
> 
> 时间：2014-04-23T22:26:10.910

**优点：**

第一：温和的、可战胜的混淆。

第二：如果编译后的文件明显更小，您将获得更快的加载时间。很适合网络。

第三：Python可以跳过编译步骤。在初始负载下更快。非常适合 CPU 和网络。

第四：你评论的越多，`.pyc`or`.pyo`文件与源`.py`文件相比就越小。

第五：手头只有一个`.pyc`或`.pyo`文件的最终用户不太可能向您展示由于他们忘记告诉您的未还原更改而导致的错误。

第六：如果你的目标是嵌入式系统，获得一个更小的文件来嵌入可能是一个很大的优势，而且架构是稳定的，所以下面详述的缺点之一不会发挥作用。

**顶级编译**

知道您可以通过这种方式将顶级 python 源文件编译成`.pyc`文件是很有用的：

```
python -m py_compile myscript.py 
```

这会删除评论。它`docstrings`完好无损。如果您也想摆脱`docstrings`（您可能想认真考虑为什么要这样做），然后以这种方式编译...

```
python -OO -m py_compile myscript.py 
```

...你会得到一个`.pyo`文件而不是一个`.pyc`文件；在代码的基本功能方面同样可分配，但与剥离的大小相比更小`docstrings`（如果它一开始就很体面，那么以后的工作就不太容易理解`docstrings`）。但请参阅下面的缺点三。

请注意，python 使用`.py`文件的日期（如果存在）来决定它是否应该执行`.py`文件而不是`.pyc`or`.pyo`文件 --- 因此编辑您的 .py 文件，并且`.pyc`or`.pyo`已过时并且您获得的任何好处都将丢失。您需要重新编译它才能再次获得`.pyc`或`.pyo`收益，就像它们可能一样。

**缺点：**

`.pyc`首先：和文件中有一个“魔术cookie” `.pyo`，指示编译python文件的系统架构。如果将这些文件中的一个分发到不同类型的环境中，它将破坏。如果您分发`.pyc`or`.pyo`没有关联`.py`的重新编译，或者`touch`它取代`.pyc`or `.pyo`，最终用户也无法修复它。

第二：如果如上所述`docstrings`使用`-OO`命令行选项跳过，则没有人能够获得该信息，这会使代码的使用更加困难（或不可能）。

第三：Python的`-OO`选项也按照`-O`命令行选项实现了一些优化；这可能会导致操作发生变化。已知的优化是：

*   `sys.flags.optimize`= 1
*   `assert`语句被跳过
*   `__debug__`= 假

第四：如果你故意让你的 python 脚本`#!/usr/bin/python`在第一行的顺序上是可执行的，那么这将被剥离到文件中`.pyc`，`.pyo`并且该功能将丢失。

第五：有点明显，但是如果你编译你的代码，不仅会影响它的使用，而且其他人从你的工作中学习的可能性也会降低，而且通常会很严重。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2017-12-23T19:30:11.707

没有涉及的是[source-to-source-compiling](https://en.wikipedia.org/wiki/Source-to-source_compiler)。例如，`nuitka`将 Python 代码转换为 C/C++，并将其编译为直接在 CPU 上运行的二进制代码，而不是在较慢的虚拟机上运行的 Python 字节码。

这可能会导致显着的加速，或者它可以让您在您的环境依赖于 C/C++ 代码时使用 Python。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-01-22T23:03:26.470

运行已编译的 python 会提高性能。但是，当您将 .py 文件作为导入模块运行时，python 将编译并存储它，只要 .py 文件不更改，它将始终使用编译后的版本。

使用文件时使用任何被解释的语言，该过程看起来像这样：
1\. 文件由解释者处理。
2\. 文件被编译
3\. 编译后的代码被执行。

显然，通过使用预编译代码，您可以消除第 2 步，这适用于 python、PHP 等。

这是一篇有趣的博客文章，解释了不同之处[http://julipedia.blogspot.com/2004/07/compiled-vs-interpreted-languages.html](http://julipedia.blogspot.com/2004/07/compiled-vs-interpreted-languages.html)
这是一个解释 Python 编译过程的条目[http://effbot.org/zone /python-compile.htm](http://effbot.org/zone/python-compile.htm)

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-01-22T23:09:53.650

如前所述，您可以通过将 python 代码编译成字节码来提高性能。这通常由 python 本身处理，仅用于导入的脚本。

您可能想要编译您的 python 代码的另一个原因可能是保护您的知识产权不被复制和/或修改。

[您可以在Python 文档](http://docs.python.org/tutorial/modules.html#compiled-python-files)中阅读更多相关信息。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-01-22T23:02:39.467

运行已编译的脚本时肯定存在性能差异。如果您运行普通`.py`脚本，机器每次运行时都会编译它，这需要时间。在现代机器上，这几乎不明显，但随着脚本的增长，它可能会成为一个更大的问题。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2015-06-15T16:14:32.880

我们使用编译后的代码分发给无权访问源代码的用户。基本上是为了阻止没有经验的程序员在不告诉我们的情况下意外更改某些内容或修复错误。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-22T23:03:58.043

是的，性能是主要原因，据我所知，也是唯一的原因。

如果您的某些文件没有被编译，可能 Python 无法写入 .pyc 文件，可能是因为目录权限或其他原因。或者也许未编译的文件只是没有被加载......（脚本/模块只有在它们第一次加载时才被编译）

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-01-08T14:13:34.350

初学者假设 Python 是因为 .pyc 文件而编译的。.pyc 文件是编译后的字节码，然后会被解释。因此，如果您之前运行过 Python 代码并且手边有 .pyc 文件，那么第二次运行速度会更快，因为它不必重新编译字节码

**编译器：** 编译器是将高级语言翻译成机器语言的一段代码

**口译员：** 口译员还将高级语言转换为机器可读的二进制等价物。每当解释器获得要执行的高级语言代码时，它都会先将代码转换为中间代码，然后再将其转换为机器代码。代码的每一部分都被解释，然后按顺序单独执行，如果在代码的一部分中发现错误，它将停止代码的解释，而不翻译下一组代码。

**资料来源：** [http ://www.toptal.com/python/why-are-there-so-many-pythons](http://www.toptal.com/python/why-are-there-so-many-pythons) [http://www.engineersgarage.com/contribution/difference-between-compiler-and-interpreter](http://www.engineersgarage.com/contribution/difference-between-compiler-and-interpreter)

# c++ - 有没有使用 WinInet c++ 库进行 http 上传的好例子

> ID：471198
> 
> 赞同：5
> 
> 时间：2009-01-22T22:58:37.510
> 
> 标签：c++, http, upload, wininet

我无法让我的代码工作：/

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-28T15:15:20.193

[最终我在网上](http://forum.powweb.com/showthread.php?t=69737)找到了一些工作示例

```
static char szRawData[5000];
  memset(szRawData, 0x11, sizeof(szRawData));

  //
  // CIHandle is just a wrapper class for HINTERNET, that closes handle in destructor
  //
  CIHandle hIntrn = InternetOpen( "LiveUpdate"), 
                                  INTERNET_OPEN_TYPE_PRECONFIG_WITH_NO_AUTOPROXY,
                                  NULL,
                                  NULL,
                                  0);
  if (!hIntrn)
    return printf("No Internet connection: %li.\n", GetLastError());

  CIHandle hConn = InternetConnect( hIntrn, 
                                    "65.254.250.104",
                                    INTERNET_DEFAULT_HTTP_PORT,
                                    NULL,
                                    NULL,
                                    INTERNET_SERVICE_HTTP,
                                    0,
                                    NULL);
  if (!hConn)
    return printf("Connection to update server failed: %li.\n", GetLastError());

  DWORD dwOpenRequestFlags = INTERNET_FLAG_IGNORE_REDIRECT_TO_HTTP |
                             INTERNET_FLAG_IGNORE_REDIRECT_TO_HTTPS |
                             INTERNET_FLAG_KEEP_CONNECTION |
                             INTERNET_FLAG_NO_AUTO_REDIRECT |
                             INTERNET_FLAG_NO_COOKIES |
                             INTERNET_FLAG_NO_CACHE_WRITE |
                             INTERNET_FLAG_NO_UI |
                             INTERNET_FLAG_RELOAD;

  CIHandle hReq = HttpOpenRequest(hConn,
                                  "POST",
                                  "upload.php",
                                  "HTTP/1.0",
                                  NULL,
                                  NULL,
                                  dwOpenRequestFlags,
                                  NULL);

  ZString strBoundary = "---------------------------autoupdater";
  ZString strContentHeader =  "Host: www.mydomain_at_powweb.com\r\n"
                              "Content-Type: multipart/form-data; boundary=";
  strContentHeader+=strBoundary;

  HttpAddRequestHeaders(hReq, strContentHeader, strContentHeader.length(), HTTP_ADDREQ_FLAG_ADD);

  ZString strHeaders;
  strHeaders.precache(16384);
  sprintf(strHeaders,
          "--%s\r\n"
          "Content-Disposition: form-data; name=\"userfile\"; "
          "filename=\"test.raw\"\r\n"
          "Content-Type: application/octet-stream\r\n\r\n",
          (LPCTSTR)strBoundary);

  tCharSeq s;//this is a just a dynamic array of bytes;
  //
  // append headers and file to request:
  //
  s.precache(16384);
  s.append(strHeaders.length(), strHeaders);
  //append with file data:
  s.append(2000, szRawData); //<------------------- depending on this size, SendRequest fails.
  //trailing end of data:
  s.append(4,"\r\n--");
  s.append(strBoundary.length(), (LPTSTR)strBoundary);
  s.append(4,"--\r\n");

  InternetSetOption(hReq, INTERNET_OPTION_USERNAME, "username\0", 9);
  InternetSetOption(hReq, INTERNET_OPTION_PASSWORD, "password\0", 9);

  if (!HttpSendRequest(hReq, NULL, 0, (void*)s.getBuffer(), s.length()))
    return printf("HttpSendRequest failed: %li.\n", GetLastError()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T00:11:08.503

这是 Microsoft 的一个简单示例。

```
 static TCHAR hdrs[] =
      _T("Content-Type: application/x-www-form-urlencoded");
   static TCHAR frmdata[] =
      _T("name=John+Doe&userid=hithere&other=P%26Q");
  static LPSTR accept[2]={"*/*", NULL};

   // for clarity, error-checking has been removed
   HINTERNET hSession = InternetOpen("MyAgent",
      INTERNET_OPEN_TYPE_PRECONFIG, NULL, NULL, 0);
   HINTERNET hConnect = InternetConnect(hSession, _T("ServerNameHere"),
      INTERNET_DEFAULT_HTTP_PORT, NULL, NULL, INTERNET_SERVICE_HTTP, 0, 1);
   HINTERNET hRequest = HttpOpenRequest(hConnect, "POST",
      _T("FormActionHere"), NULL, NULL, accept, 0, 1);
   HttpSendRequest(hRequest, hdrs, strlen(hdrs), frmdata, strlen(frmdata));
   // close any valid internet-handles 
```

示例来自[这里](http://support.microsoft.com/kb/165298)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-13T07:25:57.283

MSDN 有一个很好的示例[SAMPLE：Using HttpSendRequestEx for Large POST Requests](http://support.microsoft.com/kb/177188/en-us "示例：使用 HttpSendRequestEx 处理大型 POST 请求")
它还包含一个用于 HTTP 服务器接收数据的 ASP 文件，请在 msdn 页面下载自解压文件“Hsrex.exe”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-04-27T11:25:49.070

我找不到如何在 c/c++ 中使用 wininet 的简单而完整的代码，所以我从零碎中写了一个简单而简单的 c 代码，供将来访问但无法弄清楚的人使用。该代码可以上传任何文件（二进制，文本，mp3 ....）到您指定的主机名，对于后端我使用php（下面的代码）。

```
#include<windows.h>
#include<stdio.h>
#include<wininet.h>

int main(int argc,char *argv[])
{
    if(argc!=4)
    {
        printf("USAGE:fileuploader.exe hostname scriptname filename");
        exit(1);
    }
    HANDLE hfile=CreateFile(argv[3],GENERIC_READ,FILE_SHARE_READ,NULL,OPEN_EXISTING,0,NULL);
    if(hfile==INVALID_HANDLE_VALUE)
    {
        printf("creatfile error %lu",GetLastError());
        exit(1);
    }
    DWORD filesize=GetFileSize(hfile,NULL);
    //STARTING PREPARING THE WININET CODE.
    PCHAR szstart = "Content-Type: multipart/form-data; boundary=----qwerty";
    PCHAR szData    = "------qwerty\r\n"
                      "Content-Disposition: form-data; name=\"%s\"; filename=\"%s\"\r\n"
                      "Content-Type: application/octet-stream\r\n"
                      "Content-Transfer-Encoding: binary\r\n\r\n";
    PCHAR szDataEnd = "\r\n------qwerty--\r\n";
    char szheaders[1024];
    wsprintf(szheaders,szData,"filetoupload",argv[3]);
    HINTERNET hsession,hconnect,hrequest;
    DWORD bytesread,byteswritten,contentlen;
    hsession=InternetOpen("fileuploader",INTERNET_OPEN_TYPE_DIRECT,NULL,NULL,0);
    if(!hsession)
    {
        printf("internet open error %lu",GetLastError());
        exit(1);
    }
    hconnect=InternetConnect(hsession,argv[1],INTERNET_DEFAULT_HTTP_PORT,NULL,NULL,INTERNET_SERVICE_HTTP,0,0);
    hrequest=HttpOpenRequest(hconnect,"POST",argv[2],NULL,NULL,0,0,0);
    contentlen=lstrlen(szheaders)+filesize+lstrlen(szDataEnd);
    LPBYTE pbuf=(LPBYTE)malloc(contentlen);
    CopyMemory(&pbuf[0],szheaders,lstrlen(szheaders));
    ReadFile(hfile,&pbuf[lstrlen(szheaders)],filesize,&bytesread,NULL);
    CopyMemory(&pbuf[lstrlen(szheaders)+filesize],szDataEnd,lstrlen(szDataEnd));
    HttpSendRequest(hrequest,szstart,lstrlen(szstart),pbuf,contentlen);
    char testbuf[1024];
    InternetReadFile(hrequest,testbuf,(DWORD)sizeof(testbuf),&byteswritten);
    printf("%s",testbuf);

} 
```

这是我一起使用的php代码

```
<?php
if(isset($_FILES["filetoupload"]))
{
    $path="C:/xampp/htdocs/";
    $path=$path.basename($_FILES['filetoupload']['name']);
    print($path);
    if(move_uploaded_file($_FILES['filetoupload']['tmp_name'],$path))
    {
        print("upload success");
    }
    else
    {
        print("no success");

    }

}

?>

<html>
<body>
<form action="fileupload.php" method="post" enctype="multipart/form-data">  
    Select File:  
    <input type="file" name="filetoupload"/>  
    <input type="submit" value="Upload Image" name="submit"/>  
</form>  
</body>
</html> 
```

# big-o - Θ(n) 和 O(n) 有什么区别？

> ID：471199
> 
> 赞同：451
> 
> 时间：2009-01-22T22:58:39.193
> 
> 标签：big-o, time-complexity, notation, big-theta

有时我看到 Θ(n) 带有奇怪的 Θ 符号，中间有东西，有时只是 O(n)。只是懒惰打字，因为没有人知道如何输入这个符号，还是意味着不同的东西？

* * *

## 回答 #1

> 赞同：632
> 
> 时间：2009-01-22T23:00:00.597

### 简短说明：

> 如果一个算法是 Θ(g(n))，这意味着随着 n（输入大小）变大，算法的运行时间与 g(n) 成正比。
> 
> 如果一个算法是 O(g(n))，这意味着随着 n 变大，算法的运行时间**最多**与 g(n) 成正比。

通常，即使人们谈论 O(g(n)) 他们实际上是指 Θ(g(n)) 但从技术上讲，还是有区别的。

* * *

### 从技术上讲：

O(n) 表示上限。Θ(n) 表示紧界。Ω(n) 表示下限。

> > f(x) = Θ(g(x)) 当且仅当 f(x) = O(g(x)) 且 f(x) = Ω(g(x))

基本上，当我们说一个算法是 O(n) 时，它也是 O(n ² )、O(n ^(1000000) )、O(2 ^n )，...但是 Θ(n) 算法**不是**Θ(n ² ) .

事实上，由于 f(n) = Θ(g(n)) 意味着对于足够大的 n 值，对于某些 c值，f(n) 可以限制在 c [1] g(n) 和 c [2 g(n) 内][1]和c [2]，即f 的增长率渐近地等于g：g 可以是f 的下界**和**上界。这直接意味着 f 可以是 g 的下限和上限。最后，

> f(x) = Θ(g(x)) 当且仅当 g(x) = Θ(f(x))

类似地，要证明 f(n) = Θ(g(n))，只要证明 g 是 f 的上界（即 f(n) = O(g(n))）而 f 是 f 的下界就足够了g (即 f(n) = Ω(g(n)) 这与 g(n) = O(f(n)) 完全相同。简而言之，

> f(x) = Θ(g(x)) 当且仅当 f(x) = O(g(x)) 且 g(x) = O(f(x))

* * *

还有 little-oh 和 little-omega ( `ω`) 符号表示函数的松散上限和松散下限。

总结一下：

> `f(x) = O(g(x))`(big-oh) 表示 的增长率`f(x)`逐渐**小于或等于**的增长率`g(x)`。
> 
> `f(x) = Ω(g(x))`(big-omega) 表示 的增长率`f(x)`逐渐**大于或等于**的增长率`g(x)`
> 
> `f(x) = o(g(x))`(little-oh) 表示 的增长率`f(x)`逐渐**小于**的增长率`g(x)`。
> 
> `f(x) = ω(g(x))`(little-omega) 表示 的增长率`f(x)`逐渐**大于**的增长率`g(x)`
> 
> `f(x) = Θ(g(x))`(theta) 表示 的增长率渐近`f(x)`地**等于**`g(x)`

有关更详细的讨论，您可以[阅读 Wikipedia 上的定义](http://en.wikipedia.org/wiki/Big_O_notation)或查阅经典教科书，例如 Cormen 等人的算法介绍。

* * *

## 回答 #2

> 赞同：345
> 
> 时间：2009-01-23T00:50:42.743

有一个简单的方法（我猜是一个技巧）来记住哪个符号意味着什么。

所有的 Big-O 符号都可以被认为有一个条形图。

当查看 Ω 时，条形图位于底部，因此它是（渐近的）下限。

查看 Θ 时，条形图显然位于中间。所以它是一个（渐近的）紧界。

手写 O 时，通常在顶部完成，然后画一个波浪线。因此 O(n) 是函数的上限。公平地说，这不适用于大多数字体，但它是名称的原始理由。

* * *

## 回答 #3

> 赞同：56
> 
> 时间：2009-01-22T23:01:36.833

一个是大“O”

一个是大Theta

[http://en.wikipedia.org/wiki/Big_O_notation](http://en.wikipedia.org/wiki/Big_O_notation)

大 O 意味着您的算法将在不超过给定表达式的步骤中执行 (n^2)

Big Omega 意味着您的算法执行的步骤不会少于给定表达式（n^2）

当同一表达式的两个条件都为真时，您可以使用大 theta 表示法....

* * *

## 回答 #4

> 赞同：42
> 
> 时间：2012-09-27T19:17:55.620

我将举一个简单的例子，而不是提供一个理论定义，这里已经很好地总结了：

假设运行时间`f(i)`为`O(1)`。下面是一个渐近运行时为`Θ(n)`. 它**总是**调用函数`f(...)` `n`时间。下界和上界都是 n。

```
for(int i=0; i<n; i++){
    f(i);
} 
```

下面的第二个代码片段的渐近运行时间为`O(n)`. `f(...)` **它在大多数** 时候调用该函数`n`。上限是 n，但下限可能是`Ω(1)`或`Ω(log(n))`，具体取决于 内部发生的情况`f2(i)`。

```
for(int i=0; i<n; i++){
    if( f2(i) ) break;
    f(i);
} 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2015-01-07T06:58:18.080

Theta 是指大 O 和 Omega 相同的特殊情况的简写方式。

因此，如果有人声称`The Theta is expression q`，那么他们也必然声称`Big O is expression q`并且`Omega is expression q`。

* * *

粗略的类比：

如果： Theta 声称，“那只动物有 5 条腿。” 然后得出这样的结论：Big O 为真（“该动物的腿少于或等于 5 条。”）并且 Omega 为真（“该动物的腿大于或等于 5 条。”）

这只是一个粗略的类比，因为表达式不一定是特定的数字，而是不同数量级的函数，例如 log(n)、n、n^2 等。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2015-05-20T04:17:16.573

[图表](http://www.personal.kent.edu/%7Ermuhamma/Algorithms/MyAlgorithms/intro.htm)可以使之前的答案更容易理解：

### Θ-符号 - 相同的顺序 | O 表示法 - 上限

![Θ(n) - 相同的顺序](https://i.stack.imgur.com/4U2AF.gif) ![O(n) - 上限](https://i.stack.imgur.com/TNehz.gif)

用英语，

请注意，在左侧，有一个上限和一个下限，它们的数量级相同（即*g(n)*）。忽略常数，如果上限和下限具有相同的数量级，则可以有效地说*f(n) = Θ(g(n))*或*f(n) 处于 g(n) 的大 theta 中*。

从右边开始，更简单的例子，它说上界*g(n)*只是数量级，忽略了常数*c*（就像所有*大 O*表示法一样）。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-01-22T23:04:04.130

`f(n)`属于`O(n)`如果存在`k`为正`f(n)<=k*n`

`f(n)`属于`Θ(n)`if 存在 正`k1`, `k2`as`k1*n<=f(n)<=k2*n`

[维基百科关于大 O 表示法的文章](http://en.wikipedia.org/wiki/Big_O_notation)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2016-01-27T08:14:32.980

## 使用限制

让我们考虑`f(n) > 0`一下。考虑到这一点是可以的，因为最快的真实算法至少有一个操作，并在开始后完成它的执行。这将简化微积分，因为我们可以使用值 ( ) 而不是绝对值 ( )。`g(n) > 0``n``f(n)``|f(n)|`

1.  ### `f(n) = O(g(n))`

    **一般的：**

    ```
     f(n)     
    0 ≤ lim ──────── < ∞
        n➜∞   g(n) 
    ```

    **对于`g(n) = n`：**

    ```
     f(n)     
    0 ≤ lim ──────── < ∞
        n➜∞    n 
    ```

    **例子：**

    ```
     Expression               Value of the limit
    ------------------------------------------------
    n        = O(n)                      1
    1/2*n    = O(n)                     1/2
    2*n      = O(n)                      2
    n+log(n) = O(n)                      1
    n        = O(n*log(n))               0
    n        = O(n²)                     0
    n        = O(nⁿ)                     0 
    ```

    **反例：**

    ```
     Expression                Value of the limit
    -------------------------------------------------
    n        ≠ O(log(n))                 ∞
    1/2*n    ≠ O(sqrt(n))                ∞
    2*n      ≠ O(1)                      ∞
    n+log(n) ≠ O(log(n))                 ∞ 
    ```

2.  ### `f(n) = Θ(g(n))`

    **一般的：**

    ```
     f(n)     
    0 < lim ──────── < ∞
        n➜∞   g(n) 
    ```

    **对于`g(n) = n`：**

    ```
     f(n)     
    0 < lim ──────── < ∞
        n➜∞    n 
    ```

    **例子：**

    ```
     Expression               Value of the limit
    ------------------------------------------------
    n        = Θ(n)                      1
    1/2*n    = Θ(n)                     1/2
    2*n      = Θ(n)                      2
    n+log(n) = Θ(n)                      1 
    ```

    **反例：**

    ```
     Expression                Value of the limit
    -------------------------------------------------
    n        ≠ Θ(log(n))                 ∞
    1/2*n    ≠ Θ(sqrt(n))                ∞
    2*n      ≠ Θ(1)                      ∞
    n+log(n) ≠ Θ(log(n))                 ∞
    n        ≠ Θ(n*log(n))               0
    n        ≠ Θ(n²)                     0
    n        ≠ Θ(nⁿ)                     0 
    ```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-11-30T18:22:26.710

> 结论：我们认为大O、大θ和大Ω是一回事。
> 
> 为什么？下面我说一下原因：
> 
> 首先，我要澄清一个错误的说法，有些人认为我们只关心最坏的时间复杂度，所以我们总是使用大 O 而不是大 θ。我会说这个人在胡说八道。上下界用于描述一个函数，不用于描述时间复杂度。最差时间函数有上下界；最佳时间函数也有其上限和下限。
> 
> 为了把大O和大θ的关系解释清楚，我先解释一下大O和小o的关系。从定义我们可以很容易的知道小o是大O的一个子集。例如：</p>

*T(n)= n^2 + n，我们可以说 T(n)=O(n^2)，T(n)=O(n^3)，T(n)=O(n^4)。但是对于小o，T(n)=o(n^2)不满足小o的定义。所以只有 T(n)=o(n^3), T(n)=o(n^4) 对小 o 是正确的。多余的 T(n)=O(n^2) 是什么？大θ！*

> 一般来说，我们说大O是O(n^2)，很难说T(n)=O(n^3)，T(n)=O(n^4)。为什么？因为我们下意识地把大 O 当作大 θ。
> 
> 同样，我们也下意识地将大Ω视为大θ。
> 
> 总之，big O、big θ 和 big Ω 从定义上看不是同一个东西，但在我们的嘴和大脑中它们是同一个东西。

# javascript - 如何从两个不同的页面引用弹出窗口？

> ID：471200
> 
> 赞同：6
> 
> 时间：2009-01-22T22:58:45.090
> 
> 标签：javascript, popup

我需要允许用户单击“page-1.htm”中的链接并打开一个弹出窗口。然后，当用户在主浏览器窗口中浏览到“page-2.htm”时，我需要能够引用弹出窗口。

**“page-1.htm”中的 JavaScript**

```
var playerWin = window.open("player.htm", "playerWin", "width=300,height=130");
playerWin.play("song.mp3");  // play() is a function in player.htm 
```

**“page-2.htm”中的 JavaScript**

```
playerWin.play("tune.mp3"); 
```

page-2.htm 中的此代码会生成错误“playerWin 未定义”。这是可以理解的，因为在 page-2.htm 上没有定义名为*playerWin的变量。*

我的问题是：我可以从 page-2.htm 引用弹出窗口吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-22T23:42:26.330

即使在您离开开启器页面后，我也做了一个快速测试，弹出窗口仍然有“开启器”对象，您可以访问它。因此，要么轮询开启者并重置引用，要么在离开页面后添加一个计时器等待然后重新链接。

1.htm

```
<script>
var w = window.open("p.htm", "playerWin", "width=300,height=130");
</script>
<a href="2.htm">2</a> 
```

p.htm

```
<a href="javascript:opener.w=this;">re-link</a> 
```

2.htm

```
<script>
    var w;
</script>
<a  href="javascript:alert(w);">check</a> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T23:08:16.273

答案是不。大多数浏览器会将窗口和文档从一个导航完全隔离到下一个导航。没有地方可以放置对弹出窗口的引用，当您导航到 page2 时该弹出窗口将继续存在。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T23:46:20.597

您需要将 page-1.htm 放在 iframe 中（占据整个浏览器窗口）...然后通过 page-1 的父窗口启动并与弹出窗口通信。

IE。（抱歉伪代码）

```
user clicks on link in page-1
page-1 asks it's parent window to open a popup
popup opens

user navigates away (in the iframe)
user clicks a link in page-2
page-2 asks it's parent window to close it's popup 
```

只要一切都在同一个域上，并且导航保持在 iframe 内，这应该可以工作

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-08T14:44:34.693

接受的答案在 Firefox 12.0 中对我不起作用。我目前正在开发一个项目，在该项目中，应用程序在从页面导航到页面或刷新当前页面时必须持久了解哪些弹出窗口是打开/关闭的。每次弹出窗口打开或关闭时，我都使用 JavaScript cookie 将信息存储在客户端上。不完美，但如果您不需要 100% 万无一失的东西，这是一个不错的选择。在我看来，在重新加载页面时尝试维护 JavaScript 变量总是会变得不那么可靠，并且尝试在服务器上存储有关弹出窗口的信息根本没有意义，那么除了 cookie 还剩下什么？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-22T23:07:09.520

以前没见过……我假设您正在这样做，因为您必须也不能选择以不同的方式组织您的页面。

由于您使用的是 ASP.NET，因此只需让 page-2 设置一个会话值。然后让您的播放器页面运行 AJAX 计时器来检查会话变量，然后执行适当的操作，因为它在弹出窗口上有句柄。

# python - 从 Python 中的字符串中提取负载平均浮点值的最佳方法是什么？

> ID：471211
> 
> 赞同：1
> 
> 时间：2009-01-22T23:01:19.017
> 
> 标签：python, string, floating-point

如果我有一个字符串，例如

“17:31:51 上升 134 天，11:26，1 个用户，平均负载：0.22、0.15、0.10”

最后提取 x3 负载平均值的最佳方法是什么？我写了一个正则表达式，但这是最有效/最快的方法吗？

```
>>> s = "17:31:51 up 134 days, 11:26,  1 user,  load average: 0.22, 0.15, 0.10"
>>> print re.findall(r"([0-9]\.\d+)", s)
['0.22', '0.15', '0.10'] 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-22T23:08:04.543

这应该有效：

```
# s is the string to parse
loadavg = [float(x) for x in s.rsplit('load average: ', 1)[1].split(', ')] 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-22T23:08:32.387

您在特殊文件中有相同的信息`/proc/loadavg`，因此您可以执行以下操作：

```
>>> open("/proc/loadavg").readline().split(" ")[:3] 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-18T05:22:11.173

或者，如果您实际上是在寻找平均负载，那么在 Python 2.3+ 中，您有：

```
import os
os.getloadavg() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T23:08:51.967

你的方法看起来不错。如果你想避免正则表达式，你可以做类似的事情

```
>>> print s.split(': ')[1].split(', ')
['0.22', '0.15', '0.10'] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-22T23:09:07.287

我肯定会使用正则表达式。`s.find('load average')`您可以通过首先从该位置而不是在字符串的开头（这是默认设置）调用和启动正则表达式匹配来提高效率。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-22T23:11:09.670

正则表达式是一种方式。但也许更强大：

```
re.search(r"load average: (\d+.\d\d), (\d+.\d\d), (\d+.\d\d)$", s).groups() 
```

除非您经常在紧密循环中执行此操作，否则您不必担心性能。清晰是最重要的。我想说这个正则表达式很难被​​击败。

# c# - GetLineFromCharIndex() 真正做什么？

> ID：471224
> 
> 赞同：1
> 
> 时间：2009-01-22T23:04:12.163
> 
> 标签：c#, unit-testing

我正在阅读 Ron Jeffries 的 C# 极限编程冒险。他的主要示例是一个简单的 XML 文本编辑器。考虑到这本书的年代（2004 年出版），我怀疑他的很多初始编码，找到光标在哪一行以及插入点在哪里，可以用新的 TextBox 方法或属性替换。我是Visual Studio 2005。为了保持敏捷开发和XP的精神，我先写了一些测试：

```
[Test]
public void TestGetFirstCharIndexOfCurrentLine() {
  String[] newlines = new string[] { "<P>one</P>", "<P>two</P>" }; //TextLength == 20
  notepad.txtbox.Lines = newlines;
  Expect(notepad.txtbox.SelectionStart, EqualTo(20));
  Expect(notepad.txtbox.GetFirstCharIndexOfCurrentLine(), EqualTo(11));
  Expect(notepad.txtbox.GetLineFromCharIndex(11), EqualTo(1));
} 
```

（我很懒（呃......我的意思是我正在努力节省空间）。这段代码实际上结合了我实际在不同方法中运行的三个测试。）

无论如何，每个测试都失败了。首先， txtbox.SelectionStart 返回 0。这可能与文档建议的一致，但是当我在调试中逐步执行时，该值为 20。其他两个测试产生类似的结果；一个零，我期望一个正整数值。尤其是后两种情况，不符合我对文档的阅读。

我真的很感激我哪里出错了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T11:17:10.500

不确定这是否会解决它，但在完成所有 TextBox 操作后尝试插入以下行（即在第一个 Expect 调用之前）：

```
Application.DoEvents(); 
```

这应该允许 Windows 消息泵短暂运行，并确保 TextBox 处于正确状态，而不管其他一切。此外，您上一篇文章的第二次测试可能会失败，因为您在调用 AppendText 时使用了 \n 而不是 \r\n （标准换行符序列）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T23:22:13.327

好的，我还没有测试过这些，但我可以对你的每个结果的原因做出相当有根据的猜测：

1.  正常执行时（不单步执行），您会期望 SelectionStart 保持为 0，因为需要通过 Windows 消息泵获取属性值，而该消息泵还没有时间运行。但是，在单步执行时，消息泵*确实*有时间执行，因此 SelectionStart 将引用文本的结尾。我对此没有信心，所以我建议进行一些测试。
2.  这现在应该很明显了，前提是第 1 点是有效的。
3.  我相信位置 11 的字符实际上是一个 CR（ASCII 13），它可以被解释为第一行的一部分。诚然，这有点令人困惑。对于第二行，位置 12（或者肯定是 13）应该返回 1。

这应该可以解释一些事情，但如果有任何进一步的测试不同意我的解释，请告诉我。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T01:01:30.023

我想我有一个答案。这似乎是诺多林所说的 message.pump 的扩展。

如果我这样做：

```
 String[] newlines = new string[] { "<P>one</P>" }; //TextLength == 10
  notepad.txtbox.Lines = newlines;
  notepad.txtbox.AppendText("\n<P>two</P>");
  Expect(notepad.txtbox.SelectionStart, EqualTo(21)); 
```

测试通过。（顺便说一句，我首先使用此表单只是为了向自己证明 AppendText 方法有效。）但是，如果我这样做：

```
 String[] newlines = new string[] { "<P>one</P>","<P>two</P>" };
  notepad.txtbox.Lines = newlines;
  Expect(notepad.txtbox.SelectionStart, EqualTo(21)); 
```

测试失败。

我没有真正的解释，除了第一种情况会触发一些重置 SelectionStart 属性的事件。第二种情况只是简单地用两行实例化文本框，不触发任何事件，并将 SelectionStart 保留为 0。

有趣的是，下面的工作正好相反：

```
[Test]
public void TestGetLineFromCharIndex_UseAppendText() {
  String[] newlines = new string[] { "<P>one</P>" }; //TextLength == 10
  notepad.txtbox.Lines = newlines;
  notepad.txtbox.AppendText("\n<P>two</P>");
  Expect(notepad.txtbox.GetLineFromCharIndex(15), EqualTo(1));    
}

[Test]
public void TestGetLineFromCharIndex() {
  String[] newlines = new string[] { "<P>one</P>", "<P>two</P>" };
  notepad.txtbox.Lines = newlines;
  Expect(notepad.txtbox.GetLineFromCharIndex(15), EqualTo(1));
} 
```

第一次测试失败；第二次通过！生活不是很精彩吗？我会再胡闹一点；我希望这对某人有帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T23:15:58.147

从阅读测试来看，GetLineFromCharIndex 似乎应该返回与组合字符串中字符索引对应的行号。我怀疑我们在测试中遗漏了一些设置，因为 GetFirstCharIndexOfCurrentLine() 应该返回 0（我认为它是从零开始的）而不是 11，因为当前行应该从 0 开始。

# c++ - 错误：从 long int 转换为非标量类型，将迭代器与 null 进行比较

> ID：471228
> 
> 赞同：2
> 
> 时间：2009-01-22T23:06:15.823
> 
> 标签：c++, iterator

您好，我希望有人可以解释这个问题。这是代码：

```
class Memory{
public:
   PacketPtr   pkt;
   MemoryPort* port;
   MemCtrlQueueEntry(){}; 
```

};

在我这样做之后：

```
std::list<Memory*>::iterator lastIter = NULL; 
```

我收到以下错误：

```
 error: conversion from long int to non-scalar type std::_List_iterator<DRAMMemory::MemCtrlQueueEntry*> requested 
```

将迭代器初始化为 NULL 的问题在哪里？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T23:10:02.120

迭代器不是指针。如果要将它们初始化为非值，请使用 list::end()。有时使用指针实现的事实`vector<T>::iterator`是您不能依赖的实现细节。

如果要将 NULL 分配给迭代器所引用位置的值，则必须先取消引用它：

```
std::list<Memory *> aList;
aList.push_back(new Memory())
std::list<Memory*>::iterator listIter = aList.begin();
delete *listIter;
*listIter = NULL; 
```

用 list::end() 初始化：

```
std::list<Memory *> aList;
std::list<Memory*>::iterator listIter = aList.end(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T23:11:58.433

迭代器是类引用，而不是指针。

初始化它们没有任何用处，除非与`std::list::begin()`

# vb.net - 我可以自定义在 Visual Studio 中调试时悬停时显示的智能感知值吗？

> ID：471241
> 
> 赞同：8
> 
> 时间：2009-01-22T23:09:52.527
> 
> 标签：vb.net, visual-studio, visual-studio-2008, intellisense

当我将鼠标悬停在 Visual Studio 中的变量上时，它会弹出一个小控件，其中显示变量名称、类型和用于查看成员的 + 框等。但对于某些类型，变量类型被替换为更有用的信息，例如“ {X = 0.0 Y = 0.0 宽度 = 0.0 高度 = 0.0}" 对于 RectangleF。

有没有办法指定应该显示什么？有IDE设置吗？有函数属性吗？

我使用的是visual studio 2008，语言是visual basic。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-22T23:14:09.053

DebuggerDisplay 属性将是您正在寻找的：

```
[DebuggerDisplay("x={xvar} Y={yvar} Width = {widthvar} Height = {heightvar}")] 
```

更多信息可以在[这里找到](http://msdn.microsoft.com/en-us/library/ms228992.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T23:13:07.450

你正在寻找[`DebuggerDisplayAttribute`](http://msdn.microsoft.com/en-us/library/system.diagnostics.debuggerdisplayattribute.aspx). [我在这里](http://gregbeech.com/blogs/tech/archive/2008/07/28/tips-amp-tricks-use-debuggerdisplayattribute-for-easier-debugging.aspx)写了更多关于使用它和它的功能的信息。

# c - time_t 最终的 typedef 是什么？

> ID：471248
> 
> 赞同：218
> 
> 时间：2009-01-22T23:12:55.203
> 
> 标签：c, linux, types

我搜索了我的 Linux 机器并看到了这个 typedef：

```
typedef __time_t time_t; 
```

但我找不到`__time_t` 定义。

* * *

## 回答 #1

> 赞同：192
> 
> 时间：2009-01-22T23:29:26.887

[time_t 维基百科文章](http://en.wikipedia.org/w/index.php?title=Time_t&oldid=450752800)文章对此有所了解。底线是`time_t`C 规范中不保证的类型。

> `time_t`数据类型是 ISO C 库中定义用于存储系统时间值的数据类型。这些值是从标准`time()` 库函数返回的。此类型是标准头文件中定义的 typedef。**ISO C 将 time_t 定义为算术类型，但没有为其指定任何特定的类型**、范围、分辨率或编码。同样未指定的是应用于时间值的算术运算的含义。
> 
> **Unix 和 POSIX 兼容系统将该`time_t`类型实现为 a `signed integer`（通常为 32 或 64 位宽），它表示自 Unix 纪元开始以来的秒数**：1970 年 1 月 1 日午夜 UTC（不包括闰秒）。一些系统正确处理负时间值，而其他系统则不能。使用 32 位`time_t`类型的系统容易受到[2038 年问题](http://en.wikipedia.org/wiki/Year_2038_problem)的影响。

* * *

## 回答 #2

> 赞同：117
> 
> 时间：2009-01-22T23:23:29.707

`[root]# cat time.c`

```
#include <time.h>

int main(int argc, char** argv)
{
        time_t test;
        return 0;
} 
```

`[root]# gcc -E time.c | grep __time_t`

`typedef long int __time_t;`

它`$INCDIR/bits/types.h`通过以下方式定义：

```
# 131 "/usr/include/bits/types.h" 3 4
# 1 "/usr/include/bits/typesizes.h" 1 3 4
# 132 "/usr/include/bits/types.h" 2 3 4 
```

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2016-03-18T23:48:05.813

**标准**

[威廉布伦德尔](https://stackoverflow.com/a/471287/895245)引用了维基百科，但我更喜欢从马的嘴里说出来。

[C99 N1256 标准草案](http://www.open-std.org/JTC1/SC22/WG14/www/docs/n1256.pdf) *7.23.1/3“时间的组成部分”*说：

> 声明的类型是 size_t（在 7.17 中描述）clock_t 和 time_t，它们是能够表示时间的算术类型

和*6.2.5/18“类型”*说：

> 整数和浮点类型统称为算术类型。

[POSIX 7 sys_types.h](http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/sys_types.h.html)说：

> [CX] time_t 应为整数类型。

其中`[CX]`定义[为](http://pubs.opengroup.org/onlinepubs/9699919799/help/codes.html#CX)：

> [CX] 对 ISO C 标准的扩展。

它是一个扩展，因为它提供了更强大的保证：浮点数已出。

**gcc 单线**

无需创建[Quassnoi](https://stackoverflow.com/a/471274/895245)提到的文件：

```
echo | gcc -E -xc -include 'time.h' - | grep time_t 
```

在 Ubuntu 15.10 GCC 5.2 上，前两行是：

```
typedef long int __time_t;
typedef __time_t time_t; 
```

带有以下引用的命令细分`man gcc`：

*   `-E`：“在预处理阶段后停止；不要正确运行编译器。”
*   `-xc`: 指定 C 语言，因为输入来自没有文件扩展名的标准输入。
*   `-include file`：“处理文件好像“#include“文件””作为主要源文件的第一行出现。”
*   `-`: 来自标准输入

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2012-06-13T04:26:34.167

答案肯定是特定于实现的。要明确了解您的平台/编译器，只需在代码中的某处添加此输出：

```
printf ("sizeof time_t is: %d\n", sizeof(time_t)); 
```

如果答案是 4（32 位）并且您的数据打算超过[2038](http://en.wikipedia.org/wiki/Year_2038_problem)，那么您有 25 年的时间来迁移您的代码。

如果您将数据存储为字符串，您的数据会很好，即使它很简单，例如：

```
FILE *stream = [stream file pointer that you've opened correctly];
fprintf (stream, "%d\n", (int)time_t); 
```

然后以相同的方式读回它（fread、fscanf 等到 int 中），你就有了你的纪元偏移时间。.Net 中存在类似的解决方法。我在 Win 和 Linux 系统之间传递 64 位纪元数没有问题（通过通信通道）。这带来了字节排序问题，但这是另一个主题。

为了回答 paxdiablo 的问题，我会说它打印了“19100”，因为程序是这样编写的（我承认我自己在 80 年代就是这样做的）：

```
time_t now;
struct tm local_date_time;
now = time(NULL);
// convert, then copy internal object to our object
memcpy (&local_date_time, localtime(&now), sizeof(local_date_time));
printf ("Year is: 19%02d\n", local_date_time.tm_year); 
```

该`printf`语句打印固定字符串“Year is: 19”，后跟带有“years since 1900”的零填充字符串（定义`tm->tm_year`）。在 2000 年，这个值显然是 100。`"%02d"`用两个零填充，但如果超过两位数则不截断。

正确的方法是（仅更改为最后一行）：

```
printf ("Year is: %d\n", local_date_time.tm_year + 1900); 
```

新问题：这种想法的基本原理是什么？

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-01-22T23:21:31.643

在 Visual Studio 2008 下，`__int64`除非您定义`_USE_32BIT_TIME_T`. 你最好假装你不知道它的定义是什么，因为它可以（并且将会）从一个平台到另一个平台发生变化。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2014-08-24T15:01:56.620

`time_t`是 64 位机器上的类型**`long int`**，否则是**`long long int`**.

您可以在这些头文件中验证这一点：

`time.h`:`/usr/include`
`types.h`和`typesizes.h`:`/usr/include/x86_64-linux-gnu/bits`

（下面的语句不是一个接一个，可以在相应的头文件中使用Ctrl+f搜索找到。）

1)在`time.h`

```
typedef __time_t time_t; 
```

2)在`types.h`

```
# define __STD_TYPE     typedef  
__STD_TYPE __TIME_T_TYPE __time_t; 
```

3)在`typesizes.h`

```
#define __TIME_T_TYPE       __SYSCALL_SLONG_TYPE  
#if defined __x86_64__ && defined __ILP32__  
# define __SYSCALL_SLONG_TYPE   __SQUAD_TYPE  
#else
# define __SYSCALL_SLONG_TYPE   __SLONGWORD_TYPE
#endif 
```

4）再次进入`types.h`

```
#define __SLONGWORD_TYPE    long int
#if __WORDSIZE == 32
# define __SQUAD_TYPE       __quad_t
#elif __WORDSIZE == 64
# define __SQUAD_TYPE       long int  

#if __WORDSIZE == 64
typedef long int __quad_t;  
#else
__extension__ typedef long long int __quad_t; 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-01-22T23:26:37.780

它是大多数遗留平台上的 32 位有符号整数类型。但是，这会导致您的代码遭受[2038 年错误](http://en.wikipedia.org/wiki/Year_2038_problem)。因此，现代 C 库应该将其定义为有符号的 64 位 int，这在数十亿年内是安全的。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-02-21T01:59:38.610

`bits`通常，您会在或`asm`头目录中找到这些底层实现特定的 gcc 类型定义。对我来说，是`/usr/include/x86_64-linux-gnu/bits/types.h`。

您可以只使用 grep，或使用[Quassnoi 建议的预处理器调用](https://stackoverflow.com/a/471274/243712)来查看哪个特定标头。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-01-04T21:44:48.163

> time_t typedef 最终是什么？

健壮的代码不关心类型是什么。

C 种`time_t`是一个*真正的类型*，比如`double, long long, int64_t, int`等。

它甚至可能是`unsigned`许多时间函数的返回值，指示错误不是`-1`，但是`(time_t)(-1)`- 这种实现选择并不常见。

关键是“需要知道”的类型很少见。应编写代码以避免需要。

* * *

然而，当代码想要打印原始的`time_t`. 转换为最宽的整数类型将适应大多数现代情况。

```
time_t now = 0;
time(&now);
printf("%jd", (intmax_t) now);
// or 
printf("%lld", (long long) now); 
```

转换为`double`or`long double`也可以，但可能提供*不精确*的十进制输出

```
printf("%.16e", (double) now); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-10-09T07:18:17.417

您可以使用`typeid`来了解`time_t`系统中的定义方式。

```
#include <iostream> // cout
#include <ctime>    // time_t
#include <typeinfo> // typeid, name

using namespace std;

int main()
{
    cout << "Test 1: The type of time_t is: \t\t" 
         << typeid(time_t).name() << endl;
    cout << "Test 2: time_t is a signed long?: \t"
         << (typeid(time_t) == typeid(signed long) ? "true" : "false") << endl;
    cout << "Test 3: time_t is an unsigned long?: \t" 
         << (typeid(time_t) == typeid(unsigned long) ? "true" : "false") << endl;
    return 0;
} 
```

在我的系统中，输出是：

```
测试一：time_t的类型为：l
测试 2：time_t 是有符号的 long？：true
测试 3：time_t 是无符号长整数？：假

```

* * *

## 回答 #11

> 赞同：-4
> 
> 时间：2011-10-28T17:52:17.343

`time_t`仅适用于所有编译器和操作系统都理解`typedef`的 8 个字节 ( )。`long long/__int64`过去，它曾经只是`long int`（4 个字节），但不是现在。如果您查看`time_t`in`crtdefs.h`您会发现这两种实现，但操作系统将使用`long long`.

# java - 用于从字符串解码二进制编码的十进制 (BCD) 的 Java 代码或库

> ID：471253
> 
> 赞同：4
> 
> 时间：2009-01-22T23:15:06.370
> 
> 标签：java, binary, decimal, decode, bcd

我有一个由 1 ('\u0031') 和 0's('\u0030') 组成的字符串，代表 BCD 值。

具体来说，该字符串是 112 个字符，分别是 1 和 0，我需要一次提取 8 个或 16 个字符，并将它们从 BCD 解码为十进制。

想法？包裹？库？代码？欢迎一切。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-22T23:21:22.923

一次提取 4 个字符并使用 Integer.parseInt(string, 2) 应该给出每个数字。将您认为合适的数字组合起来。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T23:48:47.813

我认为你错过了所有的乐趣：

这是 Pete Kirkham 建议的基本实现。

花了大约5分钟。

```
import java.util.List;
import java.util.ArrayList;

public class Binary { 

        public static void main( String [] args ) { 

            for ( int i : Binary.fromString("0000000100100011010001010110011110001001") ) {
                System.out.print( i );      
             }  
             System.out.println();
        }

        public static List<Integer> fromString( String binaryString ) { 

            List<Integer> list   = new ArrayList<Integer>();
            StringBuilder buffer = new StringBuilder();
            int count            = 0;

            for ( char c : binaryString.toCharArray() ) {
                buffer.append( c );
                count++;

                if ( count >= 4 ) { 
                    list.add( Integer.parseInt( buffer.toString(), 2 ) );
                    count = 0;
                    buffer.delete( 0 , 4 );
                }
            }

            return list;
       }
} 
```

# mysql - mySQL 数据库密码更改现在使 Joomla 崩溃

> ID：471257
> 
> 赞同：2
> 
> 时间：2009-01-22T23:16:08.003
> 
> 标签：mysql, backup, joomla, passwords, revert

我在安装 Joomla 后有一个 mySQL 数据库。我更改了数据库密码，因为我忘记了它，但现在 Joomla 崩溃寻找数据库。

我猜 joomla 的密码写在某处——如果有人知道我可以手动编辑它并输入新的数据库密码。

否则，我希望手动安装原始数据库的备份将起作用。我需要知道备份是否包含数据库密码。如果是，恢复我的原始数据库是否会通过将系统恢复为原始密码来解决我的问题？

请帮忙。thx, s.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-22T23:25:40.903

您可能想查看设置数据库连接的 configuration.php 和 thease 变量：

```
var $dbtype = 'mysql';
var $host = 'localhost';
var $user = 'your database username';
var $password = 'your database password';
var $db = 'database name';
var $dbprefix = 'jos_'; 
```

该文件应该在您的 joomla-root 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-02-17T04:53:46.947

我有同样的问题，但即使更改 $password joomla 仍然崩溃。事实证明，当我更改密码时，新密码太长，并且被截断（通过 joomla 或 mysql，我不确定哪个）。因此，如果上述解决方案不起作用，您可以尝试使用较短的密码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-26T10:59:29.710

我遇到了同样的问题，上面的方法对我有用，但是密码应该在 var 列表的底部

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-05-31T23:57:50.770

**最简单的解决方案是：-**

1.  使用 phpMyAdmin 更改“电子邮件”地址并复制 Admin 的“用户名”

2.  转到“yoursite.com/administrator”

3.  点击忘记密码，然后粘贴“用户名”

4.  单击电子邮件应用程序中的密码重置

# c# - 自定义控件事件未触发

> ID：471260
> 
> 赞同：1
> 
> 时间：2009-01-22T23:17:45.380
> 
> 标签：c#, events, asp.net-3.5

我有一个带有 LinkBut​​ton 的自定义控件。当我单击 LinkBut​​ton 时，它的单击事件不会触发。

```
[ToolboxData("<{0}:View runat=server></{0}:View>")]
public class View : Control
{
    private LinkButton lbNextPage;
    protected override void CreateChildControls()
    {
        lbNextPage = new LinkButton() { ID = "lbNextPage", Text = "Next Page" };

        lbNextPage.Click += delegate(object sender, EventArgs e)
        {
            Page.Response.Write("Event Fires!");
        };

        Controls.Add(lbNextPage);
    }
} 
```

我只提取了负责渲染 LinkBut​​ton 及其事件的代码（即上面包含的内容），以消除所有其他因素。

知道为什么事件没有触发吗？我错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T23:27:29.433

本质上是因为控件在页面生命周期中创建得太晚。根据[MSDN 生命周期文档](http://msdn.microsoft.com/en-us/library/ms178472.aspx)，您需要在 PreInit 而不是 CreateChildControls 中创建任何动态控件。如果您按原样开发自定义控件，则需要在 Init 覆盖中创建所有动态控件，并将事件连接在那里。

希望这可以帮助！:)

# html - 符合 CSS 2.1 的 HTML 到 Microsoft Word 的转换？

> ID：471262
> 
> 赞同：3
> 
> 时间：2009-01-22T23:18:14.507
> 
> 标签：html, linux, ms-word, css

我在[Prince XML](http://www.princexml.com)中找到了一个极好的 HTML 到 PDF 转换器。现在我正在寻找类似质量的东西来从 HTML + CSS 生成 Word 文档。这是在 PHP/Linux 上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-19T20:37:38.100

三个选项取决于您需要做什么：

1.  对于简单的情况，您只需将 HTML 写入 .doc 文件即可。样品[在这里](http://www.ozzu.com/programming-forum/php-create-word-document-t65376.html)。但是，这是有限的，并且会提示用户在进行更新时将其另存为 HTML。

2.  如果您需要 Word 2007，您可以生成 Office Open XML，它基本上是一个包含 XML 文档的 zip 文件。我还没有找到可以做到这一点的库，但是您可以通过将示例 .docx 文件重命名为 .zip 文件并查看包含的内容，然后从 PHP 生成它来开始。[这个 SO question](https://stackoverflow.com/questions/188452/readingwriting-a-ms-word-file-in-php)中的一些信息。

3.  如果您需要支持 Word 2003，则需要使用 Word 2003 的 XML 格式。它与 2007 格式不同，但至少向前兼容（因此它也适用于 2007）。最简单的方法是从 Word 中另存为 Word 2003 XML 文档，然后在文本编辑器中打开该文档，然后开始编写 XSLT，将您的 HTML 转换为正确的 XML。我已经做到了，而且很有效，但工作量很大。[这里](http://www.devx.com/codemag/Article/18227)有关于格式的信息。

这些都不是那么容易，因此可能值得购买为您进行转换的软件产品。

[此 SO question](https://stackoverflow.com/questions/124959/create-word-document-using-php-in-linux)中也提供了有关此问题的更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T16:25:22.487

OpenOffice 可用于服务器/无头模式以生成多种格式的文档。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T22:30:38.267

几年前我不得不这样做，最终推出了我自己的定制解决方案。我以我想要的格式创建了一个 Word 文档，保存为 HTML，然后在需要的地方添加了代码，以从数据库中检索文本并按照 MS Word 喜欢的方式格式化。我强制标头使客户端认为它正在接收 Word 文档而不是 HTML 文件。Microsoft Word 愉快地打开了该文件，就好像它是一个普通的 Word 文档一样。

如果可以改为输出 DOCX 文件，则可以进行 XSL 转换。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T23:41:09.343

如果您已经解决了一半的问题，那么寻找 PDF -> DOC 转换器可能会更容易。也就是说，我也不知道有什么好的 PDF -> DOC 转换器 :(

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-31T22:28:57.753

[这](http://www.freewaregenius.com/2008/03/28/how-to-convert-pdf-to-word-doc-for-free-a-comparative-test/)是 pdf => doc 的另一种选择。没试过，祝你好运！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-28T08:08:30.477

您可能想尝试将 HTML 文件作为 DOC 发送（类似于它描述[链接文本](http://conort.googlepages.com/generate-word-from-php)的方式，但使用正确的 Contet-Type 标头:-)）并让最终用户的系统进行转换（AFAIK 你可以做类似的事情Excel也是）。

# c++ - 在 Visual Studio C++ 资源编辑器中导入 png 文件

> ID：471265
> 
> 赞同：4
> 
> 时间：2009-01-22T23:19:05.253
> 
> 标签：c++, png, embedded-resource

我希望能够在 Visual Studio 资源编辑器中导入 png 文件，以便能够在不同的其他项目中使用嵌入的资源。有解决方案吗？我知道它适用于位图，但我对 png 很感兴趣，因为即使在较低格式 [16x16] 或 [32x32]（但缺少位图）上也可以使用“透明度”。有任何想法吗？谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-23T14:37:23.887

使用 VS 2008，您可以导入 png，它们将被识别为图像，即您将能够“看到”它，但您将无法在资源编辑器中进行修改。

但无论如何，问题是它们不会被视为位图，因此您不能将其嵌入对话框中。但是您可以使用通常的 FindResource/LockResource 访问它。

此外，由于 MFC 依赖于 GDI，并且它本身不支持 PNG（至少在 XP 上，我没有在 Vista 或 Win7 上尝试过），所以无论如何您都需要将它们转换为 BMP。在这里 Gdi+ 可能会有所帮助。

我也没有检查 VS 2010，如果它有更好的 C++ 资源编辑器，也许值得一试。

# c# - C# WinForms 命名约定

> ID：471268
> 
> 赞同：4
> 
> 时间：2009-01-22T23:21:06.310
> 
> 标签：c#, winforms

C# WinForms 代码有任何命名约定吗？我在谷歌上搜索了一下，没有快速找到。

我正在设计一个 WinForms 应用程序，并且类视图变得难以快速导航，因此我需要应用一些标准来更快地找到东西。

1.  新（典型）控件 当您将新控件拖到 VS 中的窗体上时，它会为其分配一个驼峰式名称，但会生成一个私有成员字段。我认为私有类成员的约定是驼峰式大小写，前缀为下划线？

2.  放置在表单上的控件的事件和方法呢？ControlName_MethodName 的 Studio 默认设置是解决所有问题的方法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-22T23:29:07.433

不，.NET 中的约定通常是根本不使用下划线。事件处理程序中存在异常，但对于大多数情况，通常没有下划线。除了事件处理程序，我不使用下划线。我对私有成员和函数使用骆驼套管，对公共成员（属性）和函数使用帕斯卡套管。但是，其他人有不同的标准。有些人喜欢使用 C++ 约定做 _someVariable 或 m_someVariable。不过我不这样做。

我很少使用匈牙利语，但我确实将匈牙利语用于 GUI 控件（因此提交按钮可能是 btnSubmit，或者客户列表框可能是 lstCustomers）。

就事件处理程序而言，你知道，这对我来说有点灰色地带。如果我使用 Visual Studio 的“tab-complete”方式来创建事件处理程序，我通常会保持原样。当然，这引入了下划线。但是，如果我不这样做，并且它不是 GUI 组件，有时我只使用 camelCasing。可能对于事件处理程序，使用 VS 默认命名方案将是一个好习惯。我认为只要你保持相对一致就可以了。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-22T23:36:16.543

Microsoft 非常明确地说明了适合 .Net 命名约定的内容。这是详细的文档：

[http://msdn.microsoft.com/en-us/library/ms229002.aspx](http://msdn.microsoft.com/en-us/library/ms229002.aspx)

# asp.net - CruiseControl.Net 仪表板 + Apache

> ID：471276
> 
> 赞同：3
> 
> 时间：2009-01-22T23:24:28.580
> 
> 标签：asp.net, apache, cruisecontrol.net

我试图让 cc.net 仪表板在也有 apache 的构建机器上运行。

[我已尝试按照此处](http://weblogs.asp.net/israelio/archive/2005/09/11/424852.aspx)所述安装 mod_aspdotnet 。我可以运行示例 aspx 页面，但无法让 cc.net 运行。我需要做一些魔法吗？

对于它的价值，[http://localhost/ccnet](http://localhost/ccnet)设法将我重定向到[http://localhost/ccnet/ViewFarmReport.aspx](http://localhost/ccnet/ViewFarmReport.aspx) 但这给了我一个 404 错误。

以下是相关的 httpd.conf 部分：

```
#asp.net
LoadModule aspdotnet_module "modules/mod_aspdotnet.so"

AddHandler asp.net asax ascx ashx asmx aspx axd config cs csproj licx rem resources resx soap vb vbproj vsdisco webinfo

<IfModule mod_aspdotnet.cpp> 
  # Mount the ASP.NET /asp application
  AspNetMount /ccnet "C:/Program Files/CruiseControl.NET/webdashboard"
  #/SampleASP is the alias name for asp.net to execute

  # Map all requests for /asp to the application files
  Alias /ccnet "C:/Program Files/CruiseControl.NET/webdashboard"
  #maps /ccnet request to "C:/Program Files/CruiseControl.NET/webdashboard"
  #now to get to the /ccnet type http://localhost/ccnet
  #It'll redirect http://localhost/ccnet to "C:/Program Files/CruiseControl.NET/webdashboard"

  # Allow asp.net scripts to be executed in the /SampleASP example
  <Directory "C:/Program Files/CruiseControl.NET/webdashboard">
    Options FollowSymlinks ExecCGI
    Order allow,deny
    Allow from all
    DirectoryIndex index.htm index.aspx default.aspx
   #default the index page to .htm and .aspx
  </Directory>

  # For all virtual ASP.NET webs, we need the aspnet_client files
  # to serve the client-side helper scripts.
  AliasMatch /aspnet_client/system_web/(\d+)_(\d+)_(\d+)_(\d+)/(.*) "C:/Windows/Microsoft.NET/Framework/v$1.$2.$3/ASP.NETClientFiles/$4"
  <Directory "C:/Windows/Microsoft.NET/Framework/v*/ASP.NETClientFiles">
    Options FollowSymlinks
    Order allow,deny
    Allow from all
  </Directory>
</IfModule>
#asp.net 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-26T14:53:50.763

这就是我所做的，灵感来自亚当的回答：

```
AliasMatch /ccnet(.*\.aspx.*) "C:/Program Files/CruiseControl.NET/webdashboard/default.aspx" 
Alias /ccnet/ "C:/Program Files/CruiseControl.NET/webdashboard/ 
```

尝试将所有 .aspx 文件与 webdashboard 应用程序匹配，否则只需从文件系统中提取内容。

我现在有工作的 css、图像、应用程序、CCTray 下载链接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T20:19:55.490

我需要同时添加：

*   AliasMatch /aspnet_client/system_web/(\d+) *(\d+)* (\d+)_(\d+)/(.*) "C:/Windows
*   AspNet 文件目录虚拟

见 xml：

```
<IfModule mod_aspdotnet.cpp> 
  # Mount the ASP.NET /asp application
  AspNetMount /ccnet "C:/Program Files/CruiseControl.NET/webdashboard"

  #maps /ccnet request to "C:/Program Files/CruiseControl.NET/webdashboard/default.aspx"
  AliasMatch /ccnet/(.*) "C:/Program Files/CruiseControl.NET/webdashboard/default.aspx" 

  # Allow asp.net scripts to be executed in the /SampleASP example
  <Directory "C:/Program Files/CruiseControl.NET/webdashboard">
    Options FollowSymlinks ExecCGI
    AspNet Files Directories Virtual
    Order allow,deny
    Allow from all
    DirectoryIndex index.htm index.aspx default.aspx
   #default the index page to .htm and .aspx
  </Directory>      

  # For all virtual ASP.NET webs, we need the aspnet_client files
  # to serve the client-side helper scripts.
  AliasMatch /aspnet_client/system_web/(\d+)_(\d+)_(\d+)_(\d+)/(.*) "C:/Windows/Microsoft.NET/Framework/v$1.$2.$3/ASP.NETClientFiles/$4"
  <Directory "C:/Windows/Microsoft.NET/Framework/v*/ASP.NETClientFiles">
    Options FollowSymlinks
    Order allow,deny
    Allow from all
  </Directory>
</IfModule> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T19:32:05.023

I thought I was the only one in the world trying to get such a setup working.

I fixed this by adding the line: AspNet Files Directories Virtual

```
 <Directory "C:/Program Files/CruiseControl.NET/webdashboard">
    Options FollowSymlinks ExecCGI
    AspNet Files Directories Virtual
    Order allow,deny
    Allow from all
    DirectoryIndex index.htm index.aspx default.aspx
   #default the index page to .htm and .aspx
  </Directory> 
```

I also card-coded the path to my dotnet framework, but I'm not sure if that is necessary:

```
<Directory "C:/Windows/Microsoft.NET/Framework/v2.0.50727">
    Options FollowSymlinks
    Order allow,deny
    Allow from all
</Directory> 
```

# python - 组织 GUI 应用程序

> ID：471279
> 
> 赞同：9
> 
> 时间：2009-01-22T23:25:40.950
> 
> 标签：python, model-view-controller, user-interface, architecture, wxpython

这将是一个通用问题。

我正在努力设计一个 GUI 应用程序，尤其是。处理不同部分之间的交互。

我不知道应该如何处理共享状态。一方面，共享状态是不好的，事情应该尽可能明确。另一方面，没有共享状态会在组件之间引入不必要的耦合。

一个例子：

我希望我的应用程序可以通过脚本以 Emacs/Vim 的方式进行扩展。显然，需要修改某种共享状态，以便 GUI 使用它。我最初的计划是有一个可以从任何地方访问的全球“会话”，但我不太确定。

一个棘手的用例是键绑定。我希望用户能够从脚本中指定自定义键绑定。每个键绑定映射到一个任意命令，该命令接收会话作为唯一参数。

现在，编辑器组件捕获按键。它必须有权访问每个会话的键映射，因此它需要访问会话。将编辑器与会话耦合是个好主意吗？其他组件也需要访问键绑定，因此会话现在变为共享并且可以是单例...

是否有任何关于设计超越 MVC 的 GUI 应用程序的好读物？

这是 Python 和 wxPython，FWIW。

[编辑]：添加了具体用例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T23:36:00.367

如果您看过 MVC，那么您可能正朝着正确的方向前进。MVC、MVP、被动视图、监督控制器。这些都是不同的方式，每一种都有自己的优点和缺点，来完成你所追求的。我发现被动视图是“理想的”，但它会导致您在 GUI 界面（即 IInterface）中引入太多小部件。总的来说，我发现监督控制器是一个很好的折衷方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-03T02:39:33.470

很抱歉这么晚才回答这个问题，但没什么，我的意思是*没有什么*比查看执行类似操作的应用程序的源代码更好的了。（我可能会推荐类似[http://pida.co.uk](http://pida.co.uk)的东西，但是那里有很多可扩展的 wx+Python IDE，因为这听起来就像你在做的那样）。

如果我可以做一些笔记：

1.  消息传递本身并不是坏事，只要组件遵守接口，它不一定会导致组件之间的耦合。

2.  共享状态本质上并不坏，但我会根据你的直觉并尽可能少地使用。由于宇宙本身是有状态的，因此您无法真正完全避免这种情况。我倾向于使用共享的“Boss”对象，它通常是每个应用程序的非单一实例，并负责代理其他组件。

3.  对于键绑定，我倾向于使用某种“动作”系统。操作是用户可以执行的高级操作，例如：“保存当前缓冲区”，它们可以通过工具栏按钮或菜单项方便地在 UI 中表示。因此，您的脚本/插件会创建操作，并将它们注册到中心位置（例如，某种注册表对象 - 参见 1 和 2）。他们的参与到此为止。最重要的是，您有某种键绑定服务，可以将键映射到操作（它从注册表中列出，每个会话或其他）。这样就实现了插件和键绑定代码的分离，编辑器和动作代码的分离。作为额外的奖励，您的“配置快捷方式”或“用户定义的键映射”任务变得特别容易。

I could go on, but most of what I have to say is in the PIDA codebase, so back to my original point...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T23:40:19.860

在 MVC 中，模型的东西*是*信息的共享状态。

控制的东西是 GUI 控制设置的共享状态和对鼠标点击的响应等等。

你的脚本角度可以

1) 更新模型对象。这很好。控件可以是模型对象的“观察者”，并且可以更新视图以反映观察到的变化。

2) 更新控制对象。这不是很好，但是...... 然后控制对象可以对模型和/或视图进行适当的更改。

我不确定 MVC 有什么问题。您能否提供更详细的设计示例，说明具体问题或顾虑？

# internet-explorer - IE url 长度限制是否适用于“#”之后的内容？

> ID：471284
> 
> 赞同：4
> 
> 时间：2009-01-22T23:27:41.803
> 
> 标签：internet-explorer, url, fragment-identifier

我见过很多地方 IE 将 url 的长度限制为 2000 个左右的字符。但是，我不知道这是否也适用于 # 之后的部分？该部分未发送到服务器，因此看起来可能有所不同。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-09-30T00:13:38.950

它实际上是一个 URL 的 2083 个字符（这意味着*所有*URL）和一个路径的 2048 个字符。有关详细信息，请参阅[此知识库](http://support.microsoft.com/kb/208427)文章。

# database - 黑鱼数据库怎么样

> ID：471288
> 
> 赞同：1
> 
> 时间：2009-01-22T23:30:03.843
> 
> 标签：database, blackfish

我发布了一个关于小型项目的数据库选择的问题，但没有人选择或提到 Blackfish [。](https://stackoverflow.com/questions/445357/best-database-for-small-applications-and-tools)我使用了一段时间，我喜欢它，在某种程度上比 SQLserver 更好。我想知道它的其他经验、问题、限制、管理它正在构建的工具。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T08:04:46.783

有几个（小型）数据库，所以如果都提到它们，那将是例外。

[也许您可以提供有关blackfish](http://www.codegear.com/products/blackfish)的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T19:03:20.713

MySQL 在开源语言（PHP、Java 等）中很受欢迎。对于 .NET 系统，人们使用免费的 SQL Server Express Edition。

# java - "while (i == i) ;" 怎么办？是单线程应用程序中的非无限循环？

> ID：471296
> 
> 赞同：142
> 
> 时间：2009-01-22T23:35:15.050
> 
> 标签：java

我只是有一个我无法回答的问题。

假设你在 Java 中有这个循环定义：

```
while (i == i) ; 
```

如果循环不是无限循环并且**程序只使用一个线程**，那么它的类型`i`和值是什么？`i`

 *** * *

## 回答 #1

> 赞同：126
> 
> 时间：2009-01-22T23:41:55.037

```
double i = Double.NaN; 
```

[Double.equals()](http://java.sun.com/javase/6/docs/api/java/lang/Double.html#equals(java.lang.Object))的 API给出了答案：“Double.NaN==Double.NaN 的值为 false”。这在“[浮点类型、格式和值](http://java.sun.com/docs/books/jls/third_edition/html/typesValues.html#4.2.3)”下的 Java 语言规范中进行了详细说明：

> `NaN`是无序的，所以数值比较运算符`<`, `<=`,`>`和`>=` return`false`如果其中一个或两个操作数是`NaN`. 如果任一操作数为，则相等运算符`==`返回`false`，如果任一操作数为，则不等运算符返回。**特别****是****当且仅当is 时****is**，并且will be if or is 。`NaN``!=``true``NaN`**`x!=x``true``x``NaN`**`(x<y) == !(x>=y)``false``x``y``NaN`

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-01-22T23:37:39.320

那么的值`i`是无效的。“不是一个数字”。

经过一番谷歌搜索，我发现你可以在 Java 中使用 NaN（不是数字）！因此，浮点数是数据类型，值是 NaN。看[这里](http://www.concentric.net/~Ttwang/tech/javafloat.htm)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-01-22T23:42:45.970

```
double i = Double.NaN; 
```

NaN 不等于任何东西，包括它自己。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-01-22T23:42:39.153

```
float i = Float.NaN;
while(i == i) ;
System.out.println("Not infinite!"); 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2011-07-28T08:29:05.480

由于其他人说它是 NaN，所以我对 的官方（JDK 6）实现感到好奇`Double.isNaN`，并且看：

```
/**
 * Returns <code>true</code> if the specified number is a
 * Not-a-Number (NaN) value, <code>false</code> otherwise.
 *
 * @param   v   the value to be tested.
 * @return  <code>true</code> if the value of the argument is NaN;
 *          <code>false</code> otherwise.
 */
static public boolean isNaN(double v) {
    return (v != v);
} 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-01-23T02:11:13.143

我不确定，但我相信 (i == i) 不是多线程进程中的原子操作，所以如果 i 值将被其他线程在将其值推送到执行循环的线程上堆栈之间进行更改，那么该条件可以是假的。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-23T07:37:11.237

我会补充

```
float i = Float.NaN; 
```

也

```
double i = Double.NaN; 
```

* * *

这类问题的一个常见技巧是假设您假设 i 是一个 int。其他常见的假设可能是 s 是 String，x,y 是 double，ch 是 char，b 是 byte 等。如果你看到这样的问题，你可以打赌 'i' 不是它的预期类型。

一个类似的问题是；这永远不会循环，什么是'x'

```
while(x == x && x != x + 0) { } 
```

我非常喜欢的另一个问题是；这个循环是一个无限循环，x的可能值是多少。（：我数了其中四个，正如@Clement 在下面指出的那样：）

```
while(x != 0 && x == -x) { } 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-23T00:12:24.740

将 Nan 视为异常的等价物，但在计算中使用了一个神奇的值。因为计算失败 - 例如负数的平方根，除以零等 - 将它们与其他任何东西进行比较是没有意义的。毕竟，如果除以零是一个 nan 是等于 -2 的平方根还是 -3 的平方根？

Nan 允许计算包含一个返回无效答案的步骤来完成，而不会引入额外的异常。要验证答案是价值，只需通过 Float.isNan() o 等效项测试非 nandness （如果不是我的话，那就是这个词）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-23T03:04:19.010

我知道这是一个 Java 问题，但考虑到其他语言的问题很有趣。

在 C 语言中，如果将“i”声明为 volatile，则诸如“int”之类的简单类型可能会表现出“在宇宙变冷之前终止”行为（因此编译器将被迫为每次迭代执行两次“i”读取）如果“我”实际上在内存中，其他东西可能会影响它。然后，当“i”在单次迭代的两次读取之间发生变化时，循环将终止。（*补充*：一个可能的地方 - 在微型计算机中，“i”实际上位于 I/O 端口的地址，可能连接到位置传感器。如果“i”是指针变量会更合理（指向易失性内存的指针）并且语句是' `while (*i == *i);`'。）

正如其他答案所证明的那样，在 C++ 中，如果 i 属于用户定义的类，则用户可以提供“==”运算符，因此一切皆有可能。

与 NaN 类似，在基于 SQL 的语言中，如果 i 的值为 NULL，则循环不会是无限的；但是，任何非 NULL 值都会使循环无限。这很像 Java，其中任何数字（而不是 NaN）都会使循环无限。

我认为该构造没有任何实际用途，但这是一个有趣的琐事问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-07-19T01:45:02.673

我很惊讶没有看到这个解决方案：

```
while (sin(x) == sin(x)) //probably won't eval to true 
```

作为对评论的回应，请尝试运行以下命令：

```
double x = 10.5f;
assert (x == asin(sin(x))); 
```

x 理论上应该总是等于反正弦(sin(x))，但实际上它不等于。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-07-28T00:21:52.757

不是无限循环，一个线程:)

```
import static B.*;
public class A {
    public static void main(String[] args) {
        System.out.println("Still Running");
        while (i == i) ;
    }
}

public class B {

    public static int i;
    static {
        System.exit(0);
    }
} 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2011-07-27T23:23:40.090

`i == i`不是原子的。由这样的程序证明：

```
static volatile boolean i = true;
public static void main(String[] args) throws InterruptedException
{
    new Thread() {
        @Override
        public void run() {
            while (true) {
                i = !i;
            }
        }
    }.start();

    while (i == i) ;
    System.out.println("Not atomic! i: " + i);
} 
```

**更新** 这里是另一个非无限循环的例子（没有创建新线程）。

```
public class NoNewThreads {
    public static void main(String[] args) {
        new NoNewThreads();
        System.gc();
        int i = 500;
        System.out.println("Still Running");
        while (i == i) ;
    }

    @Override
    protected void finalize() throws Throwable {
        super.finalize();
        Thread.sleep(1000);
        System.exit(0);
    }
} 
```

# git - git：在不分离头的情况下切换分支

> ID：471300
> 
> 赞同：106
> 
> 时间：2009-01-22T23:37:05.980
> 
> 标签：git, version-control

我在 github 上有一个存储库，其中有一个主分支（master）和一个用于一些实验工作的分支。我做了一些提交并推送到实验分支，一切都很好。

现在，在另一台机器上，我尝试克隆我的存储库（git clone *repository*），然后切换到实验分支（git checkout *branchname*），但每次我这样做时，我的头都会分离，我无法推送我的更改。我究竟做错了什么？我觉得我在某个地方错过了一个基本的 git 概念，但是阅读随机的 git 手册页并没有给我任何线索。

我是 git 的新手，所以如果我是个白痴，我很抱歉，但我在文档中找不到任何可以帮助我重新思考的东西。

**编辑**

跟踪分支的概念是我所缺少的。现在我理解了这个概念，一切都清楚了。就个人而言，我发现`git branch --track`语法比`git checkout -b branch-name origin/branch-name`.

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：119
> 
> 时间：2009-01-22T23:44:48.883

```
# first time: make origin/branchname locally available as localname
git checkout -b localname origin/branchname 

# othertimes 
git checkout localname 

git push origin 
```

为方便起见，您可以对本地名称和分支名称使用相同的字符串。
当您签出时，`origin/branchname`您并没有真正签出分支。 `origin/branchname`是一个“远程”名称，您可以通过以下方式获取它们的列表

```
branch -a 
```

如果您启用了颜色，则本地分支将是一种颜色，而远程分支将是另一种颜色。

您必须首先在本地跟踪一个远程分支，以便能够切换到并处理它。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-01-23T00:38:48.807

```
git clone git@github.com:abc/def.git
cd def 
```

现在创建一个跟踪分支：

```
git branch --track experimental origin/experimental
git checkout experimental 
```

然后，在那里工作后，只需通过

```
git push 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-01-23T00:41:05.977

为了扩展 Kent 的回复，在您进行克隆之后，您将拥有的唯一分支（远程不计算在内）是您克隆的存储库中处于活动状态的分支——在您的情况下为 master。

因此，首先您需要创建一个新分支来跟踪远程实验分支：

```
$ git branch experimental origin/experimental 
```

然后检查一下：

```
$ git checkout experimental 
```

然而，Kent 是正确的——这两个命令可以组合

```
$ git checkout -b experimental origin/experimental 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-08-20T17:06:12.497

使用 Git 2.23（2019 年 8 月），您将使用以下[**`git switch`**命令](https://stackoverflow.com/a/57066202/6309)

如果你有一个同名的远程分支，它会被自动跟踪：

```
$ git switch new-topic
Branch 'new-topic' set up to track remote branch 'new-topic' from 'origin'
Switched to a new branch 'new-topic' 
```

# c# - Web 服务是否有任何替代 Application.DoEvents() 的方法

> ID：471304
> 
> 赞同：1
> 
> 时间：2009-01-22T23:38:44.777
> 
> 标签：c#, .net, vb.net, multithreading

System.Windows.Forms.Application.DoEvents() 是否有任何替代方法来刷新不使用 System.Windows.Forms 命名空间的事件队列？如果不是，是否可以在 Web 服务中使用上述方法/命名空间。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-22T23:50:03.413

Application.DoEvents 用于在阻止引发表单绘制事件的过程中重绘表单元素，因此我不能在 Web 服务中使用。在 Web 服务中，您没有用户界面、窗口和消息循环，因此 DoEvents 不会做任何事情。

为什么您认为需要在 Web 服务中使用 Application.DoEvents？

您很可能正在寻找多线程。如果您需要并行执行几件事，则应该使用线程。

编辑查看 cackes 帖子了解更多信息

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-23T00:05:55.360

正如 Nathan 所指出的，DoEvents 实际上只是循环 Windows 消息泵，导致队列中的顶部消息被翻译和分派。在 Web 服务中，它不太可能做任何事情（除非您使用 IPC 的 Windows 消息或一些古怪的东西）。

如果你有一个线程窃取过多调度程序量子的问题，你可以调用 Thread.Sleep(0) 强制调用线程在下一个调度程序滴答之前让步，这可能会给你的其他饥饿线程更多运行机会，尤其是如果它们的优先级相同或更低。

尽管如此，如果您对此有所帮助，那么您很可能需要重新编写代码以首先防止这种情况发生，而不是试图通过调度程序产生来修复它。

# sql-server-2008 - TFS 2008：它是否附带 SQL Server 2008 的许可证？

> ID：471305
> 
> 赞同：4
> 
> 时间：2009-01-22T23:38:45.837
> 
> 标签：sql-server-2008, licensing

当您购买 TFS 2008 时，您将获得运行 SQL Server 2005 作为 TFS 数据存储库的许可证。

使用 TFS 2008 的 SP1，现在支持 SQL Server 2008。有谁知道 TFS 2008 许可证是否允许我们安装 SQL Server 2008 而不是 SQL Server 2005？

与 SQL Server 2005 相比，使用 SQL Server 2008 作为 TFS 2008 的数据库是否有任何优势（除了减轻以后升级的痛苦）？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-22T23:45:37.103

SQL 2008 没有许可证，需要单独的许可证才能安装。有趣的是，如果您在另一台服务器上运行数据层，则无论如何都需要单独的 SQL 许可证，就像您想使用 TFS 附带的 SQL 许可证一样，它必须在应用程序层上运行。

[更多信息。](http://internationalized.spaces.live.com/Blog/cns!43F3A7682D1564E4!972.entry)

从优势来看，SQL 2008 报告服务有了很大改进，总体速度和查询计划的增强确实使它成为一个可行的选择，并且性能更高。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T01:49:48.720

我只是想补充一点——您可以从白皮书中获得这一点——Team Foundation Server 许可证包括“Team Foundation Server 中包含一个限制使用版本的 SQL Server Standard Edition，它是单独安装的。”。

但是，正如 Ray 所指出的 - 它适用于**SQL Server 2005**。AFAIK 这还没有随着 Service Pack 1 的发布而更新。

编辑：与联系人@Microsoft 核对 - 许可证未使用 Service Pack 1 更新（尽管已考虑）。换言之，可以为 SQL Server 2008 购买单独的 SKU 并将其与 TFS 一起使用，但附加到 TFS 许可证的受限使用 SQL 许可证仅适用于 SQL Server 2005（作为 TFS 产品材料的一部分提供）。

至于带有 TFS 的 SQL 2008 的优势 - 一切都与 BI 有关。分析服务、报告和集成服务已经完全重构，因此您可以在 TFS 数据报告方面做更多事情。

有一些数据库引擎更改（例如压缩），但我真的认为这是对 2005 年的整体升级（在 TFS 上下文中）。

希望它有帮助..抢

# cocoa - 在 OS X 上，将 GUI 分成多个 NIB 文件和 NSView 子类

> ID：471308
> 
> 赞同：2
> 
> 时间：2009-01-22T23:40:27.223
> 
> 标签：cocoa, interface-builder

我正在开发一个 OS X/Cocoa 应用程序，我想要这样的行为：

*   有一个带有不同选项的侧边栏，比如说“选项 A”、“选项 B”和“选项 C”。
*   当您单击 A、B 或 C 时，它会将相应的 GUI 加载到主窗格中。每个 GUI 都是不同的 NSView 子类，并且在不同的 NIB/XIB 文件中定义。例如，选项 A 可能有 3 个按钮并且是 NSViewSubclassA 的一个实例，而选项 B 可能有 1 个按钮和一个文本字段并且是 NSViewSubclassB 的一个实例。

我将如何进行编程？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-22T23:48:04.413

首先继承 NSViewController，所以你的每个子视图都有一个控制器。在用户单击按钮以在视图之间切换时的操作方法中，您可以使用适当的类和 nib 创建一个新的视图控制器（在窗口控制器的 ivar 中保留对它的引用）。视图控制器充当 nib 的所有者。然后你所要做的就是在主窗口中添加视图控制器的视图作为子视图，然后你就设置好了。

这是一个简单的例子。在执行一些不相关的任务后，在主窗口控制器中从操作方法（以及启动后）调用它；唯一棘手的部分是修补响应者链（如果幸运的话，您可能不需要这样做）。

```
- (void)_setAccessoryViewControllerFromTag:(NSInteger)tag;
{
    if ( _accessoryContentViewController != nil )
    {
        [self setNextResponder:[_accessoryContentViewController nextResponder]];
        [_accessoryContentViewController release];
    }

    switch ( tag )
    {
        case 0:
            _accessoryContentViewController = [[RLGraphsViewController alloc] initWithNibName:@"GraphsView" bundle:nil];
            break;
        case 1:
            _accessoryContentViewController = [[RLSummaryViewController alloc] initWithNibName:@"SummaryView" bundle:nil];
            break;
        case 2:
            _accessoryContentViewController = [[RLEquipmentViewController alloc] initWithNibName:@"EquipmentView" bundle:nil];
            break;
        default:
            _accessoryContentViewController = [[RLLocationsViewController alloc] initWithNibName:@"LocationsView" bundle:nil];
            break;
    }

    [_accessoryContentViewController setNextResponder:[self nextResponder]];
    [self setNextResponder:_accessoryContentViewController];        
    [self.accessoryView setContentView:[_accessoryContentViewController view]];
} 
```

# java - Eclipse 中 Thread.run() 的调用层次结构

> ID：471311
> 
> 赞同：1
> 
> 时间：2009-01-22T23:40:56.830
> 
> 标签：java, eclipse, multithreading, eclipse-plugin

我倾向于大量使用 eclipse 的“Open Call Hierarchy”功能，来跟踪大型 Java 项目中方法调用的去向。我对线程感到恼火，因为调用层次结构将`Thread.run()`方法的调用者显示为各种内部 Java 线程函数，而不是`Thread.start()`有效地导致线程运行的调用。

有什么方法可以让 Eclipse 将 Thread.start 调用显示为`Thread.run()`方法的父级。也许一个插件可以做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-23T00:43:43.633

如果我理解你的问题：你想找到`Thread.start()`给定`Runnable.run()`方法的方法调用者吗？

我发现这对于非常小的、短期运行的匿名 Runnables 很有用。

但是，在更一般的情况下，我不确定进一步的实用性：

*   标准做法是将 Runnable 作为构造函数参数传递给 Thread。通常情况下，Runnable 被预先构建的线程（例如 Executors、asynchExec）调用。在这种情况下，您感兴趣的是构造函数的调用者。
*   可以通过其构造函数追溯非匿名 Runnables（在该 ctor 上调用层次结构将是一个好方法）
*   方法的覆盖`Thread.run()`可能会做到这一点，但是您对`Thread.start()`方法的调用者更感兴趣
*   调用层次结构视图（AFAIK）不是很可扩展（但是，[实施者](http://eclipse-tools.sourceforge.net/implementors/)曾经这样做，但在集成到核心 JDT 之前，是由与原始调用层次结构相同的人编写的）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T06:39:16.910

有趣的问题。

欢迎您查看[nWire](http://www.nwiresoftware.com/)。它是一种新工具，用于在一个动态视图中探索代码的所有关联。非常方便且易于使用。它将调用者和实现者（以及所有其他关联）组合在一起。希望得到您的反馈。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T10:17:33.103

感谢您的回复詹姆士。根据您提出的前两点，您说（在匿名和非匿名 Runnable 中）查看 Runnable 构造函数的调用层次结构会很有用 - 是的，我同意！这通常是我最终会做的事情。但这通常意味着在两个层次结构之间频繁切换，一次只能显示其中一个。我想通过保留一个层次结构来避免这种情况。

在 Runnable 构造函数和对 run() 的调用之间没有直接的调用层次结构，因此在我看来，通过将构造函数添加为 run() 的“调用者”来扩展调用层次结构是不合适的。但是，调用 start() 或将线程添加到 Executor （或者可能是 executor 中的 run() 调用）可能适合显示在调用层次结构中。

我真的只是想知道是否有一个我无法找到的现有解决方案。我想如果我足够想要的话，我只需要自己尝试一个插件。

我尝试了实施者插件。它很有用，但不适用于这个特殊问题！

我还尝试了 nWire。它有很多我没有时间充分探索的功能，但我找不到一种方法来做我正在寻找的东西。

# performance - 我总是需要考虑性能吗？

> ID：471313
> 
> 赞同：18
> 
> 时间：2009-01-22T23:41:50.963
> 
> 标签：performance, optimization

我来自 DBA 世界，性能一直是我的痴迷。我正在转向开发，我一直在不断地考虑性能。

阅读 SO 有时似乎性能并不重要。例如，对于 hibernate（或任何其他 ORM）的传教士。

作为开发人员，我什么时候需要考虑性能，什么时候不需要？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-22T23:47:50.250

一般来说，痴迷于性能或优化是软件开发中的祸根。通常，只有大约 5%（或更少！）的代码对整个系统的性能有任何影响。首先，作为大多数项目的软件开发人员，您的主要目标是获得正确和可靠的功能，当然还有系统的可维护性。然后，一旦实施并正常工作，您就可以评估性能，找出瓶颈所在，并相应地优化它们以满足您的总体目标。

***一个警告***：对您对事物采取的方法进行 O(n) 类型评估是合理的事情，作为原始系统设计和算法选择等的一部分提前考虑，只是为了确信性能将“在球场上” . 但除此之外，大多数在实际测量瓶颈所在之前优化事物的尝试将导致优化无关紧要的事物，并且通常会使事物更难维护、更难理解等。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-22T23:47:34.150

[Knuth](http://en.wikipedia.org/wiki/Optimization_(computer_science))的名言（“我们应该忘记小的效率，比如大约 97% 的时间：过早的优化是万恶之源”）可能适用。

当你开车时，你是否经常有意识地检查你的车离路边有多近？如果你有足够的驾驶经验，你就会知道它的边缘在哪里，以及大致如何在不撞到附近的东西的情况下驾驶和停车。

编程性能的类似直觉/经验对于通过试验/错误和问题获得很重要，但您不应该花时间不断地检查自己。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-22T23:48:14.697

什么时候做？

不，认真的。有一些应用程序永远不会有足够的用户来保证比数据库中的基本索引和键关系更多的保证。他们不需要调整代码的内部循环。例如，工作组大小的应用程序。

随着事情的发展，对优化路径的需求也在增加，包括代码、数据访问和通信。如果您正在使用有限的硬件（嵌入式系统），那么您会*非常*关心性能。但是有很多很多的应用程序永远不会看到足够的用户来让系统资源甚至注意到你在那里。

在这些情况下，所有额外的工作都是*浪费金钱和精力*。在某些情况下，您的规范清楚地表明您需要额外的努力。在某些情况下，它清楚地表明*你永远不会*。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-23T00:54:21.783

我认为这里有两个相互矛盾的谚语是相关的。

1：过早的优化是万恶之源。

2：跳之前先看。

以我个人的经验，在第一次编写代码时，很容易找到使用 90% 资源的神奇 3% 代码的概率。这是第一句谚语的相关之处，并且似乎产生了很好的结果。然而，随着代码库的成熟，似乎不是 3% 的人使用了 90% 的资源，而是突然有 50% 的人使用了 90% 的资源。如果你想象一个水管的类比，而不是几个大的泄漏，你现在有多个小泄漏的问题，到处都是。这使整个应用程序的性能变慢，即使很难确定任何一个单独的功能。

这就是谚语 2 似乎相关的地方。不要依赖第一条谚语不做任何绩效计划，要有一个整体计划，即使它是一个不断发展的计划。尝试制定一些可接受的性能指标并为您的程序计时。考虑设计选择的后期性能影响。例如，如果只需要一个元组存储，则可能会提前计划使用元组存储而不是数据库。从 SQL 数据库开始，然后再更改为元组存储非常困难。

最重要的是，请尝试在容易的地方进行优化，并记录可以优化的情况。如果你不这样做，随着时间的推移，程序往往会遭受千次削减，因为函数的效果比它们需要相加和相乘的速度要慢 5-20%。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-23T01:52:33.260

引用 Knuth 的“过早优化......邪恶”对于编写草率和缓慢的代码（正确与否）是一个糟糕的论据。

1.  您需要指标来优化。
2.  在编写代码时，您需要考虑代码。
3.  您只优化重要的代码子集。

如果您正在编写一个简单的表单来更新一些细节，那么它可能不值得优化。

如果您正在编写一个 google 搜索引擎替代品，并且您希望获得大量流量，那么您应该想办法让搜索速度尽可能快。

您只需要优化重要的代码，并且程序中有很多代码用于做一次性的事情或很少发生的事件。

* * *

假设我们满足上面的 1、2 和 3：

在进行任何性能测试和优化之前，等待应用程序完成 90% 是没有意义的。性能通常是不成文的非功能性要求。您需要确定并写下其中一些不成文的要求并承诺执行。

如果您需要进行架构或其他重大更改，那么完成 90% 也可能为时已晚。编写的代码越多，改变事物就越难，即使只是因为有更多的代码需要考虑。您需要不断确保您的应用程序将在需要的时间和地点执行。

再说一次，如果您编写了良好的单元测试，您应该能够将性能测试作为这些测试的一部分。

至少我的2先令。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-22T23:49:50.650

我有一个阶段，我对性能绝对偏执。我花了很多时间试图提高性能，以至于我的代码从未真正取得进展。不要养成那个习惯:-)

代码，然后优化，而不是同时优化。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-05T21:18:58.860

> 性能不是可以在项目结束时粘贴的东西。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-23T00:28:02.523

在你让它正常工作之前不要考虑性能。如果它工作正常，并且没有任何用户注意到的性能问题，请不要优化。

如果它工作正常并且有显着且明显的延迟，*请不要优化*. 个人资料代替。应用程序的大部分时间将花费在单个“热”循环中，而它是哪个循环很少是直观的。你需要真正的测量和科学来告诉你发生了什么。获得个人资料数据后，您的优化任务应该从大到小进行：

1.  架构优化。应用程序的整体结构是无效率的根源吗？

2.  算法优化：您是否使用了正确的数据结构？您是否以正确的方式访问它们？您的应用程序是花费大部分时间编写，还是花费大部分时间阅读？优化该问题的答案。

3.  最后一招。微优化。简化热循环，或展开一些循环。达夫的装置。在您确定无法对其他两个级别进行进一步改进之前，不要在此级别进行优化，并且您仍然没有达到您的性能目标。这种级别的优化很可能会破坏狗屎，并使您的应用程序更难以增长，更脆弱，所以除非您真的必须这样做，否则不要这样做。

我再次强调，不要浪费时间优化任何看起来低效的随机代码。优化时间是一项重大投资。在你把时间赌在失败者身上之前，你应该有证据支持你。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-22T23:49:34.863

您应该在构建应用程序*后*优化性能，并且只有当您有证据证明您的瓶颈在哪里时。（例如通过分析）也许您发现没有必要进行优化，尤其是因为编译器通常比您更擅长。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-22T23:55:09.830

> 我什么时候需要考虑性能，什么时候不需要？

只要您从考虑正确性的任何周期中抽出时间，您就可以考虑性能。:-)

然而，大多数时候，你的想法是“**这个**位的性能并不重要：要么，因为即使有了这个位，整个应用程序的性能仍然没问题，或者因为这个位的成本可以忽略不计或无穷小与其他位的成本相比。”

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-23T00:07:13.377

对我来说，当我处理图像处理、多个超过 100k 标记的大型 sql 查询或循环时，我会考虑优化。否则我不会，除非我看到它在工作时很慢。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-23T00:11:16.507

我正在开发一个搜索引擎。优化是用户继续搜索或离开网站的区别所在。我认为对于许多应用程序来说都是如此，不幸的是，他们中的许多人对此并不够关心。有时在问题上投入更多硬件会便宜得多。不幸的是后者更容易。总而言之，我想说，每当您必须处理大量数据和/或非常快速地处理数据时，您都必须进行优化。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-23T00:15:22.597

我发现我通过一个开发单元工作的典型模式是：

1.  从头到尾将适用于主要用例的最小版本放在一起。在这一步中，我主要关注基本的简单性和任何应用模式的良好实现。

2.  第 2 步是重构第 1 步，主要着眼于简化。由于我一直在做 OOP，我似乎可以指望的一件事是，这一步总是呈现出许多明显的简化和代码的实际减少。这也是明显的抽象失效的地方（这是另一个简化。）重要说明：这对解决性能有很大的次要影响，尤其是当您这样做了几次并且您知道高性能反模式在哪里时。

3.  通常，当 #2 完成时，事情的性能令人满意，但测试会证实这一点。并指出需要进行优化的（通常很少）位置。

我越来越多地发现，任何时候我在第一阶段和第二阶段考虑高效设计都会破坏简单性，而这在那时是主要的。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-23T00:29:16.140

就像其他人所说的那样，在发现问题之前进行优化是浪费时间。我最近处理了一些有很多优化的代码，我大部分时间都花在了删除优化上！问题在于它使添加关键功能变得不可能。

另一个例子……在我之前的工作中，我从事数据处理工作，围绕可执行程序编写脚本。如果我在晚上 5 点开始一个程序，并在第二天早上 8 点完成，它已经足够快了。当然，在紧急情况下，用 1 小时而不是 10 小时要好得多，更快的代码使我的工作更轻松，但*只要运行正确，* 30 分钟就相当于 16 小时。

这完全取决于您的项目......并且应该在您的项目要求中考虑。

还要记住，使程序更高效需要更长的时间……您正在权衡开发速度以换取执行速度。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-01-23T01:12:17.023

它通常归结为要求。在某些情况下，您对响应时间等有非常严格的非功能性要求。在这些情况下，您应该付出额外的努力来调整您的代码、程序等。

但根据经验（恕我直言），您应该根据围绕可靠性和可维护性的最佳实践来构建代码，然后围绕性能进行特定的一轮测试。这样，您将知道您将只调整实际影响性能的代码位。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-01-23T01:35:42.433

**答案1：**

许多人正确地说“不要考虑性能，以后再优化”，但请记住**他们有单元测试**。他们可以重写大部分代码库，而不必担心引入错误。如果您在没有任何单元测试的情况下重写，则必须*再次*手动测试所有内容，而这一次更难，因为算法更复杂。

您*可以*将优化推迟到以后，但您必须确保已为此做好准备。如果您没有一个可行的稍后优化计划（单元测试、分析代码的工具），那么您最好现在考虑性能，因为它会在以后对您造成更大的伤害。

**答案 2：**

有时，您首先提出的简单可行的解决方案会及时运行`O(n^n)`。如果您*知道*您将拥有大型数据集，那么现在就继续优化它。

**答案 3：**

前段时间，我厌倦了 PHP 中的缺陷并试图修复其中的一些。*我编写了一个框架，其中包含一个所有东西都*必须继承的基类。它使用方法和属性重载、反射以及几乎所有其他高级功能来使其工作。然后我继续在一个大型项目中使用它，使用我自己的框架特性而不是像`isset()`和`static`. 该项目的代码更整洁一些，但魔法减慢了每个方法调用，并将属性访问速度降低了大约 50 倍。

*如果您要尝试扩展语言本身，您现在*需要考虑性能，因为如果您无法优化它，您必须重新编写*所有内容。*C拥有零成本的宏系统，为你的生活加油。Javascript没有这样的系统，要非常小心地编写一个你想在任何地方都使用的新的对象继承系统。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-01-23T01:38:15.190

您想考虑与特定问题相关的性能，就像您每天可能必须处理每个问题的性能问题一样。

意思是——如果它不会得到大量使用，请相应地担心。不要太懒惰或效率低下，也不要过分痴迷于每次都获得算法的必杀技。通常最好编写最简单的代码，并在需要时使其更快/优化。与此同时，任何开发人员都可以编写简单的代码，这是值得考虑的事情。

如果您看到它的重要性在增加，那么现在您知道要多考虑一下，因为它会在后面咬您一口。

作为开发人员，我们有一个想要完美 v1.0 的问题。一个有效的 v1.0 是有效的，并不适合未来可能带来的每一种情况。

对我来说，一个很好的例子是多年前我开始使用数据库时。我不知道额外的索引是什么，也不知道当查询速度慢得难以想象时它们会带来哪些巨大的性能提升。

我们无法预测每一个问题。我努力做好设计，让问题争夺我的注意力。

希望有什么用处。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-01-23T06:26:48.183

最好先编写代码，然后确定最能从优化中受益的关键领域。

有时代码会被替换、删除或重构。优化过多的代码可能会浪费宝贵的时间。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-03-05T21:31:03.183

不，如果您要考虑一些事情，那么请考虑为您的雇主/客户和客户提供价值。想想什么对他们很重要。

也就是说，性能*很*重要，但它可能导致毁灭。

战争黎明 2 于 2 月发布，带有破坏多人游戏的游戏漏洞。问题？人口上限。当一个小队被重新执行时，由于编码错误，最后一个单位占用了两倍的上限。这意味着您可能会遇到这样的情况：您的军队非常少，当您尝试创建新单位时，游戏会告诉您战场上的单位太多。最令人沮丧。

为什么这应该是一个问题？这怎么可能是仅在重新执行时才会出现的问题？如果只是购买该设备有问题，那么肯定会在测试中发现它！

好吧，我的猜测是这是由于过早的优化。当您单击“购买单元”按钮时，开发人员不想遍历所有单元，而是像银行一样制作弹出式盖帽，因此当创建一个单元时，它会从银行中取出盖帽，当它死亡时弹出盖帽被放入回到银行。当然，这更有效，但一个小错误会使整个银行步履蹒跚。

那么更糟糕的是，当您按下“购买单元”按钮时会出现小故障，或者在 Dow2 论坛上出现大量火焰，愤怒的客户和 MS 拖着脚跟证明修复意味着它还没有修复？

在很多情况下，最好标记一个

```
// todo: performance could be better
// try doing xyz if we need to improve it 
```

因为高性能版本需要更多时间并且增加了代码的维护成本。

您应该担心的性能是为您的客户提供令人满意的解决方案并满足他们的需求。到达发布日期的速度通常更为重要。

在某些情况下，一般性能很重要，例如嵌入式系统，但这应该被称为预先限制，并且是您在编写代码之前应该了解的特殊上下文。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2010-08-15T16:37:46.657

我可能不同意普遍接受的智慧，但我认为你确实必须一直考虑性能。重要的是你**如何**看待性能。

通常，如果您开始谈论性能，其他人就会开始谈论优化，您可能会过早地说，因为性能和优化不是一回事。

**对性能的关注太少会过早地优化因未过早优化而受到指责的荣誉。**

*Optimize*是一个带宾语的动词。在您拥有该对象之前，您无法优化它。您可以在编写代码后对其进行优化（尽管它可能只是一种方法）。您可以在编写类模型或功能规范后对其进行优化。

无论*是先验的*还是*后验*的，性能工作都是以最优为目标的问题。某种性能工作只是*后验*性的，这应该被认为是优化，并且做*先验*性还为时过早。某种表演工作是*先验的，或更多的，适当的*。

尝试*先验*正确的主要事情是您的基本方法是否合理。这里经常给出的一个例子是算法的时间复杂度，但我不同意。在 O(1) 或 O(n log n) 中做某事并不总是比在 O(n) 中更好。当 n 为 1 时 O(n) 时间与 O(1) 时间相同，当 n 为 0 时 O(1) 时间更快，并且在很多情况下具有 0 或 1 项的数据集很常见。更重要的是，时间复杂度表示法故意忽略了低阶项和常数。真正的 O(n) 时间意味着 kn + c（可能还有其他低阶项），而 O(1) 时间意味着 k + c，**但对于 k 和 c 的不同值**。如果这个算法本身在一个循环中，那么 O(n) 可能会大大超过 O(1)。

所以时间复杂度不是这里需要考虑的事情。这里需要考虑的事情是时间复杂度**是否是这里要考虑的事情。**如果是，那么是时候看看是否因为缺少开销而导致 O(n) 击败 O(1) 的情况适用，或者是否应该采用 O(n) 击败 O(1) 的更常见情况，或者**是否应该在这里忽略时间复杂度，而只做阅读更自然的事情**。例如，时间复杂度竞争的常见情况是是使用列表并搜索它，还是使用基于散列的集合并基于散列查询它。然而，对于大多数库来说，每个库的代码看起来会有所不同，因此会有一个更好地描述意图的代码，这就是当它不是性能关键时要使用的代码。

这里关于性能的重要*先验*知识是是否值得考虑现阶段的性能。

基本方法的另一种情况是如何处理远程资源。如果您打算每秒多次访问同一个很少更改的远程资源，您需要确保您的访问代码具有某种程度的缓存，或者至少您可以轻松地放入该缓存。锁定到特定的缓存方法可能为时过早，也可能不为时过早，但是将您的访问与其他事项紧密混合，因此以后很难添加缓存几乎可以肯定是过早的悲观！

所以我们从一开始就需要一些想法，尽管我们不需要在这个阶段解决所有问题。

一开始还有一个合理的想法，就是*我现在不需要考虑这部分的表现*。*这与那些说不要先验*地关注性能，而是在更细粒度的水平上的人一样。稍微考虑一下就可以合理地确信不用更详细地考虑性能确实是可以的。

另一个合理的想法是*我很确定这部分的性能将是至关重要的，但我还不能衡量不同方法的影响*。在这里，您已经决定优化可能是必要的，但现在瞄准最佳状态确实为时过早。但是，您可以通过设置功能边界来奠定基础，这样您就可以更轻松地更改可疑关键部分的实现，或者可能将时间记录代码放入该功能 esp。在调试版本上，尤其是。如果它离调用公共方法很远（所以它不等同于在外部测试中记录时间）。在这里，您没有*事先*做任何事情来使代码更快，但是您已经努力帮助以后进行优化。

另一个值得考虑的事情是是否应该以多线程的方式完成某件事，但请注意这里有三个合理的想法；除了*这将需要多线程*而且*这不需要多线程*还有*这**可能**需要多线程*。同样，您可以定义功能边界，以便以后更容易重新编写代码，以便与其他工作并行调用该特定方法。

最后，您需要考虑在事后衡量绩效的能力，以及您必须多久进行一次。

这里的一个重要案例是基础数据将在项目生命周期中发生变化。凭借您的 DBA 背景，您将清楚地知道，对于具有特定操作频率平衡的特定数据集的最佳解决方案对于具有不同操作频率的不同数据是不一样的，即使数据符合相同的模式（例如小表与具有更多行、较少写入和许多读取的相同表模式相比，重度读取和写入从重度索引中获益更少）。这同样适用于应用程序，因此您需要考虑是否只需要在以后的优化阶段进行优化，或者是否必须随着条件的变化而频繁地返回优化。在后一种情况下，现在值得确保它'

另一个重要的情况是您将无法轻松获得有关如何使用代码的信息。如果您正在编写一个在单个站点中使用的应用程序，您将能够很好地衡量这一点。如果您正在编写一个将被分发的应用程序，这将变得更加困难。如果您正在编写一个将在多个不同应用程序中使用的库，那就更难了。在后一种情况下，YAGNI 的论点变得更弱；也许那里的某个人确实需要这种缓慢的方法来大大改进，而您对此一无所知。不过，您需要采取的方法并不总是相同的。而一种方法是预先进行工作以使其在这种情况下具有更高的性能（不是*先验*的，因为它是*后验的*到您的库正在编写但*先验*地使用它）另一种方法是简单地记录特定方法必然是昂贵的，并且调用代码应该记住或以其他方式优化他们自己的代码使用它的方式（**如果合适**的话）。

不断地，如果主要是潜意识地思考性能是很重要的，只是对这种想法的适当反应并不总是*让它现在变得更快*。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2010-08-15T17:35:13.117

我会在某种程度上不同意这里的包。

你总是考虑性能——但这种考虑通常是忽略它。查看代码运行的频率。如果答案是“一次”或“很少”，性能基本上不成问题。

只有当一段代码要频繁执行时，才需要注意性能。即使在这种情况下，您通常也应该只查看例程的 O() 类，直到分析显示问题。

当我最初编写时，我唯一会考虑诸如详细优化之类的事情是在 O（可怕）例程中的代码。（示例：确保一组数据不包含死胡同的测试。O(n^8)，尽管进行了大量修剪。我从第一行开始就很注意性能。）

# web - 如果搜索引擎蜘蛛正在攻击我的网站，我该怎么办？

> ID：471341
> 
> 赞同：0
> 
> 时间：2009-01-22T23:50:18.730
> 
> 标签：web, search-engine, web-crawler

我运行了一个小型网络服务器，最近它被搜索引擎蜘蛛所困扰。冷却它的正确方法是什么？我应该定期向它发送 5xx 响应吗？我应该使用 robots.txt 设置吗？或者是其他东西？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-22T23:54:43.183

假设蜘蛛非常友好地尊重 robots.txt，您可以通过以下方式限制它访问您的网站：

```
User-agent: *
Disallow: / 
```

这将影响所有蜘蛛。通过为蜘蛛指定正确的用户代理来缩小范围。

如果爬虫不尊重您的 robots.txt，您可能希望通过在防火墙中阻止其 IP 来限制它访问您的站点。

[编辑：您可以在此处](http://www.robotstxt.org/)阅读有关 robots.txt的更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T23:55:32.997

Robots.txt 应该是您的第一站。搜索机器人应该记下这些设置并停止访问您拒绝访问的页面。这很容易通过在您网站的根目录中使用以下语法创建一个文件来完成：

```
User-agent: *
Disallow: / 
```

该语法本质上是说：所有搜索机器人（通配符 *），您不得在 / 下索引任何内容。更多信息请访问[robotstxt.org](http://www.robotstxt.org/)

如果这不起作用，下一步是尽可能禁止 IP 地址。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T00:08:15.030

您还可以构建[站点地图](http://www.sitemaps.org)并将站点地图注册到有问题的机器人。搜索引擎将使用站点地图来确定要访问哪些页面以及访问频率。如果您的网站是完全动态的，它可能没有太大帮助，但如果您有很多静态页面，这是告诉蜘蛛每天没有任何变化的好方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-24T05:45:06.673

如果它忽略了 robots.txt，那么第二好的做法是通过它的 useragent 字符串来禁止它。仅仅禁止 IP 不会有多大用处，因为如今 99% 的蜘蛛都分布在一堆服务器上。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-24T05:27:55.350

robots.txt 应该是您的首选。但是，如果机器人行为不端并且您无法控制防火墙，则可以设置 .htaccess 限制以通过 IP 禁止它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-22T23:55:56.847

```
User-agent: *
Disallow: / 
```

# java - Java 套接字编程

> ID：471342
> 
> 赞同：4
> 
> 时间：2009-01-22T23:52:07.247
> 
> 标签：java, sockets, network-programming, objectinputstream

我正在使用 java 套接字构建一个简单的客户端/服务器应用程序并尝试使用 ObjectOutputStream 等。

当它谈到通过套接字传输对象时，我一直在关注这个 url [http://java.sun.com/developer/technicalArticles/ALT/sockets上的教程。](http://java.sun.com/developer/technicalArticles/ALT/sockets/)

请参阅我的客户端代码[http://pastebin.com/m37e4c577](http://pastebin.com/m37e4c577 "http://pastebin.com/m37e4c577")但是这似乎不起作用，我无法弄清楚什么不起作用。底部注释掉的代码是直接从教程中复制出来的——当我只使用它而不是创建客户端对象时，这很有效。

谁能看到我做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-23T12:01:15.823

问题是您创建流的顺序：

在文章中的服务器（我假设您正在使用的服务器）中，当打开新连接时，服务器首先打开一个输入流，然后打开一个输出流：

```
public Connect(Socket clientSocket) {
 client = clientSocket;
 try {
  ois = new ObjectInputStream(client.getInputStream());
  oos = new ObjectOutputStream(client.getOutputStream());
 } catch(Exception e1) {
     // ...
 }
 this.start();
} 
```

注释的示例代码使用相反的顺序，首先建立输出流，然后是输入流：

```
// open a socket connection
socket = new Socket("localhost", 2000);
// open I/O streams for objects
oos = new ObjectOutputStream(socket.getOutputStream());
ois = new ObjectInputStream(socket.getInputStream()); 
```

但是您的代码以相反的方式执行此操作：

```
server = new Socket(host, port);
in = new ObjectInputStream(server.getInputStream());
out = new ObjectOutputStream(server.getOutputStream()); 
```

建立输出流/输入流对将停止，直到它们交换了握手信息，因此您必须匹配创建顺序。您可以通过在示例代码中交换第 34 行和第 35 行来做到这一点。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-22T23:59:18.277

您没有在任何地方写对象。

再次查看该链接，您必须在某处写：

```
 oos.writeObject( new Date() ); 
```

在您的代码中，您只有

```
ois.readObject(); 
```

这就是为什么

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-23T00:31:29.490

可能你会想先学习最基本的。

这是我刚刚编码的示例。

它启动一个*服务器*，它只参与一个客户端，它发送一个对象并死掉。

当用户（你）按下回车键时，一个新的*客户端*被创建，它连接到先前创建的服务器并读取服务器将发送的对象。

这里不处理任何异常。只是为了让事情更简单，但这不是处理异常的方式。

当您理解了这里的所有概念后，将更容易理解本教程中的那些概念。

```
import java.io.*;
import java.net.*;
import java.util.*;

public class SimpleServer implements Runnable { 

     // Creates the server, send a "date" and die.
    public void run() { 
        try {
            ServerSocket server = new ServerSocket( 8090 );
            Date creationDate = new Date();
            System.out.println("(Server) Server is ready " 
                                 + "and running at " + creationDate );

            Socket uniqueClient = server.accept();

            // We will write using this "chained" object.
            ObjectOutputStream out = new ObjectOutputStream( 
                                                 uniqueClient.getOutputStream());

            out.writeObject( creationDate );

            // close all, at this point forget about the exceptions.
            // this is lesson #1      
            out.close();

            uniqueClient.close();

            server.close();        

            System.out.println("(Server) The server is down");
        }catch( IOException ioe ) {}

     }

    public static void main ( String [] args ) throws IOException ,
                                                 ClassNotFoundException { 

         Thread serverThread = new Thread( new SimpleServer() );

         serverThread.start(); // start the server thread ... doh..

         System.out.println("(Client) Press enter when you want "+ 
                               " to connect to the server...");

         Scanner scanner = new Scanner( System.in );

         scanner.nextLine();

         Socket client = new Socket("localhost", 8090 );

         // Read from this object.
         ObjectInputStream in = new ObjectInputStream( client.getInputStream() );

         Date date = ( Date ) in.readObject();

         System.out.println("(Client) Current time is:          " + new Date() );
         System.out.println("(Client) Object read from server : " + date );

         in.close();
         client.close();

    }
} 
```

我希望这有帮助。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-23T07:22:29.333

如果您尝试使用调试器，它会告诉您问题出在哪里。（也许不是为什么）

您遇到的问题是 ObjectOutputStream 写入了一个标头，而 ObjectInputStream 读取了该标头。您首先创建了 ObjectInputStream，这意味着它正在尝试读取一个永远不会被写入的标头。

解决方案：始终先创建 ObjectOutputStream，然后在创建 ObjectInputStream 之前对其进行 flush()。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-23T11:37:31.347

只是提醒。

当您使用 ObjectOutputStream 时，请记住它保留了一个引用缓存。如果你写了一个对象，改变了对象的内容，然后再次发送相同的对象，你会得到重复的数据。例如：

```
List list = new ArrayList();
list.add("value1");
out.writeObject(list);
list.clear();
list.add("value2");
out.writeObject(list); 
```

将在客户端生成两个带有字符串“value1”的列表。

为了避免这种情况，当多次写入同一个对象引用时，必须调用 reset 方法来重置流缓存：

```
List list = new ArrayList();
list.add("value1");
out.writeObject(list);
out.reset();
list.clear();
list.add("value2");
out.writeObject(list); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-10-07T05:42:51.863

最好打开一个，`outputStream`因为输出流不会阻塞。然后，您有等待`Stream`. 在所有流之后，您写入流并刷新它 -`outputStream.flush()`以发送数据字节。您还需要在另一端有一个方法来读取输入，无论是简单地`inputStream.read()`将每个字节读取为 a 的整数`char`，还是使用 a`BufferedReader`或`Scanner`。我已经使用了几乎所有可能的方法，但最有效的发送方法是将s`outputStream.write(String)`的序列写入流中，读取读取单个. 我希望这有帮助。`char``byte``inputStream.read()``char`

# c++ - 程序终止时保证文件删除 (C/C++)

> ID：471344
> 
> 赞同：21
> 
> 时间：2009-01-22T23:53:59.443
> 
> 标签：c++, c, file, termination, unlink

Win32[`CreateFile`](http://msdn.microsoft.com/en-us/library/aa363858(VS.85).aspx)有`FILE_FLAG_DELETE_ON_CLOSE`，但我在 Linux 上。

我想打开一个临时文件，该文件将在程序终止时被删除。我可以理解，在程序崩溃的情况下，保证这一点可能不切实际，但在任何其他情况下，我希望它能够工作。

我知道RAII。我知道信号。我知道`atexit(3)`。我知道我可以打开文件并立即删除它，并且文件将保持可访问状态，直到文件描述符关闭（甚至可以处理崩溃）。这些似乎都不是一个完整而直接的解决方案：

1.  RAII：去过那里，做到了：我有一个对象，其析构函数会删除文件，但如果程序被信号终止，则不会调用析构函数。
2.  信号：我正在编写一个低级库，它使注册信号处理程序成为一个棘手的命题。例如，如果应用程序本身使用信号怎么办？我不想踩到任何脚趾头。我可能会考虑一些巧妙的使用`sigaction(2)`来应对……但还没有对这种可能性进行足够的思考。
3.  `atexit(3)`: 显然没用，因为在异常终止期间（例如通过信号）不会调用它。
4.  preemptive `unlink(2)`：这很好，除了我需要文件在文件系统中保持可见（否则系统更难监控/故障排除）。

你会在这里做什么？

**进一步说明**

我在原来的帖子中省略了一个细节，现在我意识到我应该包括在内。在这种情况下，“文件”并不是严格意义上的普通文件，而是一个 POSIX 消息队列。我通过创建它`mq_open()`。它可以通过`mq_close()`or关闭`close()`（前者是我系统上后者的别名）。可以通过 将其从系统中删除`mq_unlink()`。所有这些都使它类似于普通文件，*除了*我无法选择文件所在的目录。这使得当前最流行的答案（将文件放在 中`/tmp`）不可行，因为“文件”是由系统在容量非常有限的虚拟文件系统中创建的。（我已经`/dev/mqueue`按照 中的示例安装了虚拟文件系统`man mq_overview`）。

这也解释了为什么我需要名称保持可见（使立即取消链接方法不可行）：“文件”必须在两个或多个进程之间共享。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-23T02:52:42.793

在进程运行时名称保持可见的要求使得这很难实现。你能重新审视这个要求吗？

如果没有，那么可能没有完美的解决方案。我会考虑将信号处理策略与 Kamil Kisiel 的建议结合起来。您可以在安装信号处理程序之前跟踪安装的信号处理程序。如果默认处理程序是 SIG_IGN，您通常不会安装自己的处理程序；如果是 SIG_DFL，你会记得的；如果它是其他东西——用户定义的信号处理程序——你会记住那个指针，并安装你自己的。当你的处理程序被调用时，你会做任何你需要做的事情，然后调用记住的处理程序，从而链接处理程序。您还将安装 atexit() 处理程序。您还将记录您执行此操作以及您执行此操作的信号。

请注意，信号处理是一种不完美的策略；SIGKILL 不能被捕获，并且 atexit() 处理程序不会被调用，并且文件将被保留。

David Segond 的建议 - 一个临时文件名守护进程 - 很有趣。对于简单的过程，就足够了；如果请求临时文件的进程分叉并期望子进程在此后拥有该文件（并退出），那么守护进程在检测使用它的最后一个进程何时死亡时会出现问题 - 因为它不会自动知道打开它的进程。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-23T00:00:41.690

如果您只是制作一个临时文件，只需在`/tmp`其或其子目录中创建它。然后尽最大努力在完成`atexit(3)`或类似操作时将其删除。只要您使用通过`mkstemp(3)`或类似选择的唯一名称，即使由于程序崩溃而无法删除它，您也不会冒险在后续运行或其他此类情况下再次阅读它。

那时，它只是保持`/tmp`清洁的系统级问题。大多数发行版在启动或关闭时擦除它，或运行常规 cronjob 以删除旧文件。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-23T14:21:01.033

也许有人已经提出了这个建议，但是我无法发现它，考虑到您的所有要求，我能想到的最好的办法是以某种方式将文件名传达给父进程，例如启动脚本，它将在之后清理如果它没有这样做，该过程就会死亡。这可能主要被称为看门狗，但随后添加了更常见的用例以在进程以某种方式失败时终止和/或重新启动进程。

如果你的父进程也死掉了，那你就很不走运了，但是大多数脚本环境都相当健壮，除非脚本被破坏，否则很少会死掉，这通常比程序更容易保持正确。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-23T00:02:42.763

过去，我建立了一个“临时文件管理器”来跟踪临时文件。

有人会向经理请求一个临时文件名，并且该名称已注册。

一旦您不再需要临时文件名，您通知管理员并且文件名被取消注册。

收到终止信号后，所有已注册的临时文件都被销毁。

临时文件名基于 UUID 以避免冲突。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-23T14:19:19.337

您可以在创建文件后让进程分叉，然后等待子进程关闭，然后父进程可以取消链接文件并退出。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-28T16:45:23.107

我刚刚加入了 stackoverflow 并在这里找到了你 :)

如果您的问题是管理 mq 文件并防止它们堆积，那么您实际上不需要保证在终止时删除文件。如果您只是想避免堆积无用的文件，那么您可能只需要写日记。打开 mq 后向日志文件添加一个条目，关闭时添加另一个条目，以及初始化库时，检查日志中的不一致并采取任何必要的措施来纠正不一致。如果您担心`mq_open/mq_close`调用时崩溃，您还可以在调用这些函数之前添加一个日记条目。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-08-14T00:35:40.837

你*真的*需要名字保持可见吗？

假设您选择立即取消链接文件。然后：

*   > preemptive unlink(2)：这很好，除了我需要文件在文件系统中保持可见（否则系统更难监控/故障排除）。

    您仍然可以对已删除的文件进行调试，因为它仍然在`/proc/$pid/fd/`. 只要您知道进程的 pid，枚举它们打开的文件应该很容易。

*   > 这些名称需要在正常操作期间保持可见，因为它们在程序之间共享。

    您仍然可以通过在 Unix 域套接字上传递文件描述符来在进程之间共享已删除的打开文件。有关更多信息，请参阅[在不同进程之间传递文件描述符的可移植方式](https://stackoverflow.com/questions/909064/portable-way-to-pass-file-descriptor-between-different-processes)。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-08-05T06:48:11.077

*   在您的点目录下有一个临时文件的簿记目录。
*   在创建临时文件时，首先在包含路径或 UUID 到您的临时文件的簿记目录中创建簿记文件。
*   创建该临时文件。
*   删除临时文件后，再删除簿记文件。
*   当程序启动时，扫描簿记目录以查找包含临时文件路径的任何文件，如果找到，则尝试删除它们，它们会删除簿记文件。
*   （如果任何步骤失败，请大声记录。）

我没有看到更简单的方法。这是任何生产质量计划都必须经过的样板；+500 线轻松。

# sharepoint - SharePoint 初学者用户教程有什么好处？

> ID：471351
> 
> 赞同：5
> 
> 时间：2009-01-22T23:56:13.010
> 
> 标签：sharepoint, sharepoint-2007, wss-3.0

好的，我的任务是为一个内部 SharePoint 经验很少的政府内部网站创建一个 wss v3.0 网站（尽管它是一个 IT 部门，所以他们非常懂技术）。我已经相当擅长 SharePoint（在 SharePoint 中获得了一些 Microsoft 认证并为自己做了很多事情），但需要教育其他人。其中一部分涉及培训、面对面和在线培训。我已经完成了我自己的一系列 SharePoint wiki，内容涉及我预计最常用的内容，但我希望这里的其他人过去使用过的一些富有成效的链接。那么在学习 SharePoint 的过程中对自己有什么好处呢？

编辑：我想强调这个的“开始”方面，不是开发人员教程，而是简单的东西，比如“如何提交到文档库”等。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T00:06:46.063

您看过[Microsoft Sharepoint 学习网站](http://www.microsoft.com/sharepoint/learning/default.mspx)吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-23T18:32:46.500

那里有一些播客 - 但您需要筛选它们以找到在您感兴趣的级别（最终用户、开发人员和管理员等）讨论主题的播客

由于 SharePoint 是 Office 系列的一部分，因此请不要忘记查看像这样的 Office 资源站点：http: [//office.microsoft.com/en-us/training/default.aspx](http://office.microsoft.com/en-us/training/default.aspx)

从最终用户的角度来看，这很棒。更多“如何将文档添加到文档库”类型的说明，而不是“如何创建新的 SharePoint 网站集”。

我有一段时间没去过那里了，但我花了相当多的时间在该网站上浏览我发送的团队“本周 SharePoint 提示”文档的想法（并且“发送”我的意思是发布到我们的门户的文档中心，并将链接发送给每个人，以便他们有时间查看）。我找到了一些简单的东西，比如“如何将团队的 SharePoint 日历添加到 Outlook”，然后输入带有屏幕截图的分步说明。根据内容，我尝试将其保留 1-2 页。我还设置了一个讨论板，其中包含每个提示的主题、摘要、提示的链接等，以便人们可以添加评论和问题。

最后一件事 - 检查这个地方： [http ://www.customguide.com/quick_references.htm](http://www.customguide.com/quick_references.htm)

他们有很多应用程序/平台的“快速参考”。如果您刚刚升级到 Office 2007 或类似情况，这是一个很好的小资源分发给人们。请注意，他们会跟进您，试图向您推销他们的培训。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T00:12:46.830

[为创业公司加油](http://www.andrewconnell.com/blog/)，一旦你想完成某事，天才[安德鲁康奈尔。](http://msdn.microsoft.com/en-us/rampup/default.aspx)

还有很多链接，这些是您初学者需要的东西（恕我直言）

如果你只是喜欢教程有人编译了这个[很酷的页面](http://blog.sharepointhosting.com/Downloads/SharePoint-Tutorials.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-23T00:17:45.120

你就是我。

通过订阅这个提要，我知道了我想问什么。 [http://feeds.feedburner.com/sharepointmvpblogs?format=xml](http://feeds.feedburner.com/sharepointmvpblogs?format=xml) 然后当我知道我喜欢谁和不喜欢谁时，我只挑了几个来阅读。（安德鲁·康奈尔当然晋级了）

然后我开始去我当地的用户组听演讲。首先，你需要学习你需要学习的东西，因为 sharepoint 可以做很多事情。然后你需要在自己身上留下印记，不要自定义并一遍又一遍地重复。

一旦您有时间并发现了错误和错误，那么您才能考虑自定义 Share Point。爬之前先走。

此外，[Heather Solomon](http://feeds.feedburner.com/HeathersBlog)非常适合解决设计问题和想法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-23T09:59:26.270

Andrew Connel 的书：“Real World SharePoint 2007”……好书……

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-23T20:24:54.713

访问[http://www.safaribooksonline.com/](http://www.safaribooksonline.com/)并准备好图书馆。我发现它对我需要的几乎所有主题都很有用。我想为 SharePoint 升级创建一个 powershell 脚本，所以我在我的图书馆中放了 4 或 5 本书，并且有足够的信息让我开始。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-03-21T18:28:43.673

结帐，[http://sharepoint-training-videos.com](http://sharepoint-training-videos.com)。这对于刚开始使用 SharePoint 的初学者用户来说非常有用。把它放在你的门户中，让他们看到动画短片。

另请参阅[免费快速操作指南](http://sharepoint-training-videos.com/helpenduser/)

[培训视频 http://sharepoint-training-videos.com/images/enduserlogo.gif](http://sharepoint-training-videos.com/images/enduserlogo.gif)

这是来自高级视频[的示例视频。](http://sharepoint-training-videos.com/Demos/Concurrent%20Editing/05-Concurrent%20Editing.html)

这是大纲：

1 简介 涵盖课程中预期的内容以及受训者在结束培训时应具备的技能。

2 了解您的角色 概述 SharePoint 用户可以拥有的不同角色，主要是 SharePoint 管理员、网站所有者和最终用户

3 为什么使用 SharePoint 描述在协作、文档管理、警报、自助服务、表单和工作流方面使用 SharePoint 的重要关键优势

4 了解关键概念 介绍在使用 SharePoint 之前需要了解的重要概念。这些概念包括站点、列表、权限、导航、Webparts、视图和元数据。

5 文档库陷阱 警告用户在使用文档库而不是共享驱动器时要遵循的限制和最佳实践。

6 文档库基础 演示如何导航到文档库以及如何打开文档和上传文档。

7 在 SharePoint 中创建文档 演示如何直接在 SharePoint 中创建文档。

8 将文档直接保存到 SharePoint 演示如何在不打开浏览器的情况下将 Office 文档直接保存到 SharePoint 库。

9 在 Office 中向 SharePoint 库添加快捷方式 演示如何将快捷方式保存到 Office 中更相关的文档库和文件夹。一个可以为最终用户节省宝贵时间挫败感的技巧。

10 了解并发编辑 描述用户在 SharePoint 中必须习惯的新工作习惯，并演示多个用户如何同时处理文档。

11 移动SharePoint 文档 演示如何将文档从一个位置复制和移动到另一个位置、不同的站点、列表或门户。

12 了解入住和退房演示并介绍入住和退房流程，解释好处和最佳实践。

13 使用版本 演示并解释版本如何工作、版本化的内容以及如何恢复版本，指出最佳实践和流程中的重要细节。

14 使用元数据 定义元数据并解释元数据与文档的好处。还展示了如何使用元数据以及如何更新它们。

15 在数据表中编辑元数据 展示了处理元数据时可以节省宝贵时间的技巧。数据表允许用户快速编辑元数据，而无需经过多次点击和屏幕。

16 排序和过滤文档 演示如何通过对列表进行排序和过滤来处理文档集合。

17 了解视图 解释视图及其优点以及如何修改视图。

18 使用文档和电子邮件链接协作 展示如何在 SharePoint 中处理文档以及如何与他人共享它们。在您的组织中理解和掌握的关键概念。

19 了解警报 描述警报的好处并演示如何在文档或文档库上设置警报。

20 Working Offline Desribes how to work in a disconnected fashion with SharePoint and how to re-sync once the user is connected.

21 Understanding the Recycle Bin Explains how the recycle bin works and demos how to retrieve documents from it

hope that helps

# c# - 在接口中引发事件

> ID：471352
> 
> 赞同：1
> 
> 时间：2009-01-22T23:58:46.467
> 
> 标签：c#, events, interface

我正在以 MVP 模式实现一个项目，并且我有一些这样的接口：

```
public interface IWizardStep {
  event EventHandler NextStep;
}

public interface ISubmitable {
  event EventHandler Submit;
}

 public interface IStep : ISubmitable, IWizardStep {
  string SomeProperty { get; set; }
 } 
```

然后我的演讲者班有这个：

```
public class StepPresenter {
  public IStep View { get; set; }

  public StepPresenter() {
    this.View.Submit += new EventHandler(StepSubmitted);
  }

  void StepSubmitted(object sender, EventArgs e){
    //do some processing

    //Now I want to raise the Next event
    //this.View.NextStep(sender, e) throws a compile error
  }

} 
```

因此，当尝试在视图中引发 NextStep 事件时，我遇到了编译错误。我很确定这是个问题，因为我还没有为 NextStep*实现*事件处理程序，但是这个演示者不会处理该事件。

演示者将在表单（ASP.NET，但这没有任何区别）上的向导中作为许多步骤中的一个步骤来实现，并且向导将捕获 NextStep 事件并显示向导中的下一步。

那么我怎样才能在像这样引发的接口上发生事件，或者它是不可能的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T00:07:34.047

这是因为 NextStep 是一个事件处理程序。您不能调用必须引发的事件处理程序。我希望 IStep 有一个方法调用，例如 MoveToStep() ，具体实现将按预期引发事件，您可以在其他地方订阅该事件。

您对 IWizardStep 中的 NextStep eventHandler 的推理是什么？如果它是您所追求的方法，请在您的界面而不是事件中创建它。您的消费者类应该期望在需要“做”某事时调用一个方法，并在 IWizardStep 有一些东西要传回（数据或其他）时订阅一个事件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T00:36:32.913

@Ray Booysen：

是的，我在发布后意识到我不应该尝试在界面上引发事件，但我应该调用一个在视图中引发事件的方法。所以我修改了我的接口和类，如下所示：

```
public interface IWizardStep<TEventArgs> {
  event EventHandler<TEventArgs> NextStep;

  void RaiseNextStep<TSender>(TSender sender, TEventArgs e);
}

public class Step {
  void StepSubmitted(object sender, EventArgs e) {
    this.View.RaiseNextStep(sender, e);
  }
} 
```

然后在 View 实现上我有：

```
public void RaiseNextStep<TSender>(TSender sender, EventArgs e) {
  if(this.NextStep != null) this.NextStep(sender, e);
} 
```

# .net - 使用反射将属性值设置为 Nothing (Null)

> ID：471360
> 
> 赞同：0
> 
> 时间：2009-01-23T00:00:47.133
> 
> 标签：.net, vb.net, reflection, null

编辑：根据 LoveMeSomeCode 的回答，我相信这个问题只出现在 VB.Net 中。

我试图通过将更改的属性的旧值保存在字典中并在需要恢复时通过反射设置它们来将类恢复到以前的状态。我遇到了一个问题，如果旧值是 Nothing (null)，我在尝试设置属性时会得到一个空引用异常。这是我尝试过的。

假设每个循环都像这样：

```
For Each pair As KeyValuePair(Of String, Object) In myOldValues
...
Next 
```

方法一：

```
CallByName(Me, pair.Key, CallType.Set, pair.Value) 
```

方法二：

```
Me.GetType().InvokeMember(pair.Key, Reflection.BindingFlags.SetProperty, Nothing, Me, pair.Value) 
```

方法三：

```
Dim propInfo As System.Reflection.PropertyInfo = Me.GetType.GetProperty(pair.Key)
propInfo.SetValue(Me, Convert.ChangeType(pair.Value, propInfo.PropertyType), Nothing) 
```

对于这些方法中的每一个，当 pair.Value 为空时，我都会得到一个空引用异常。setter 能够保存一个空值（通常该属性是一个字符串）。我做错了什么或者我该如何解决？

**编辑：**如果我也直接将它传递给 null，则每种方法都会失败。

**编辑：**如果他们帮助任何人，这里是堆栈跟踪：

**方法 1** System.NullReferenceException：对象引用未设置为对象的实例。在 Microsoft.VisualBasic.CompilerServices.Symbols.Container.InvokeMethod(Method TargetProcedure, Object[] Arguments, Boolean[] CopyBack, BindingFlags Flags) 在 Microsoft.VisualBasic.CompilerServices.NewLateBinding.LateSet(Object Instance, Type Type, String MemberName, Object [] Arguments, String[] ArgumentNames, Type[] TypeArguments, Boolean OptimisticSet, Boolean RValueBase, CallType CallType) at Microsoft.VisualBasic.CompilerServices.Versioned.CallByName(Object Instance, String MethodName, CallType UseCallType, Object[] Arguments) 在*myProject* .Presenter.CustomerDetailPresenter.RevertCustomer() 在我的*文件*中：第 378 行

**方法 2** System.Reflection.TargetInvocationException：调用的目标已抛出异常。---> System.NullReferenceException：对象引用未设置为对象的实例。在我的*项目*.Presenter.CustomerDetailPresenter.set_City(String value) --- 内部异常堆栈跟踪结束 --- 在 System.RuntimeMethodHandle._InvokeMethodFast(Object target, Object[] arguments, SignatureStruct& sig, MethodAttributes methodAttributes, RuntimeTypeHandle typeOwner) 在 System.RuntimeMethodHandle .InvokeMethodFast(Object target, Object[] arguments, Signature sig, MethodAttributes methodAttributes, RuntimeTypeHandle typeOwner) at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfoculture, Boolean skipVisibilityChecks) at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfoculture) at System.RuntimeType.InvokeMember(String name, BindingFlags bindingFlags, Binder binder,System.Type.InvokeMember(String name, BindingFlags invokeAttr, Binder binder, Object target, Object[] args) at System.Type.InvokeMember(String name, BindingFlags invokeAttr, Binder binder, Object target, Object[] args) 在*myProject .Presenter.CustomerDetailPresenter.RevertCustomer* ()

**方法 3** System.Reflection.TargetInvocationException：调用的目标已抛出异常。---> System.NullReferenceException：对象引用未设置为对象的实例。在我的*项目*.Presenter.CustomerDetailPresenter.set_City(String value) --- 内部异常堆栈跟踪结束 --- 在 System.RuntimeMethodHandle._InvokeMethodFast(Object target, Object[] arguments, SignatureStruct& sig, MethodAttributes methodAttributes, RuntimeTypeHandle typeOwner) 在 System.RuntimeMethodHandle .InvokeMethodFast（对象目标，对象 [] 参数，签名 sig，MethodAttributes 方法属性，RuntimeTypeHandle typeOwner）在 System.Reflection.RuntimeMethodInfo.Invoke（对象 obj，BindingFlags invokeAttr，Binder binder，Object[] 参数，CultureInfo 文化，布尔 skipVisibilityChecks）

在 System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfoculture) at System.RuntimeType.InvokeMember(String name, BindingFlags bindingFlags, Binder binder, Object target, Object[] providedArgs, ParameterModifier[] 修饰符，CultureInfo 文化，String[] namedParams) 在 System.Type.InvokeMember(String name, BindingFlags invokeAttr, Binder binder, Object target, Object[] args) 在*myProject .Presenter.CustomerDetailPresenter.RevertCustomer* ()

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-17T19:04:01.937

您在第二个和第三个选项堆栈跟踪中看到这一点的事实

> System.NullReferenceException：对象引用未设置为对象的实例。在 myProject.Presenter.CustomerDetailPresenter.set_City（字符串值）

让我觉得您的 CustomerDetailPresenter.City 属性设置器中有一些东西没有处理空值。您的属性设置器的实现是什么？那是任何可能失败的验证或审计代码吗？

2009 年 3 月 24 日更新：VB 中的快速测试，此代码按预期工作。我试图捕捉你描述的场景。

我的测试类具有其属性集（部分）：

```
Public Class MyObject

    Private mId As Integer
    Private mName As String
    Private mDOB As Date
     .......
     .......
    Public Property Name() As String
        Get
            Return mName
        End Get
        Set(ByVal Value As String)
            mName = Value
        End Set
    End Property 
```

我创建了一个包含属性名称、值和类型的 PropertyState 类。动态设置属性的代码是：

```
Private Sub SetValues()
        'get object that we are working with
        Dim ty As Type = mObjectInstance.GetType

        'create our property name/value info
        Dim info As New PropertyState
        With info
            .PropName = "Name"
            .OriginalValue = Nothing
            .ValueType = GetType(String)
        End With

        'now use reflection to set value on object
        Dim prop As PropertyInfo = ty.GetProperty("Name", BindingFlags.Instance Or BindingFlags.Public)
        'use Convert.ChangeType to duplicate problem scenario
        Dim newValue = Convert.ChangeType(Nothing, GetType(String))
        'prop.SetValue(mObjectInstance, newValue, BindingFlags.Instance Or BindingFlags.Public, Nothing, Nothing, Globalization.CultureInfo.CurrentUICulture)
        prop.SetValue(mObjectInstance, Convert.ChangeType(info.OriginalValue, info.ValueType), Nothing)

        DisplayValues(CType(mObjectInstance, MyObject))
    End Sub 
```

我使用了 SetValue 方法的两种不同重载，我发现不明确设置 BindingFlags 有时会导致反射问题。但是，在这种情况下，两个重载都可以正常工作。

因此，我回顾一下您在问题中发布的堆栈跟踪：

> System.NullReferenceException：对象引用未设置为对象的实例。在 myProject.Presenter.CustomerDetailPresenter.set_City（字符串值）

set_City() setter 是引发异常的事实，表明该方法已被成功找到并调用。正在按请求传入 null(nothing) 值。因此，错误不在反射中，而是在调用属性设置器时发生的事情。您可能已经尝试过，但是在设置器中设置断点或设置 IDE 以中断所有托管异常以查看是否可以捕获实际原因？或者，存储的属性信息的状态是预期的吗？名称、类型和值是否同步？

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T15:22:15.730

好吧，这是 C# 而不是 VB.NET，但这似乎可行：

```
private Dictionary<string, object> MemoryValues = new Dictionary<string, object>();

        public void Store()
        {
            foreach (PropertyInfo info in this.GetType().GetProperties())
            {
                if (MemoryValues.ContainsKey(info.Name))
                    MemoryValues[info.Name] = info.GetValue(this, null);
                else
                    MemoryValues.Add(info.Name, info.GetValue(this, null));
            }
        }

        public void Recall()
        {
            foreach (PropertyInfo info in this.GetType().GetProperties())
            {
                info.SetValue(this, MemoryValues[info.Name], null);
            }
        } 
```

因此您可以设置属性并调用 Store()，它们将被保存到字典中。然后您可以更改它们并调用 Recall()，它们将被恢复。它似乎至少对字符串有效。放在基类中似乎是一组很好的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-23T00:38:58.477

在`SetValue`,上`Convert.ChangeType`调用`IConvertible`方法`pair.Value`，当您尝试在`null`实例上调用它们时，它们肯定会失败。

检查是否为空，如果是则`pair.Value`传递一个显式。`null`

`InvokeMember`需要一个数组作为第 5 个参数。尝试：

```
Params(0) = pair.Value
Me.GetType().InvokeMember(pair.Key, Reflection.BindingFlags.SetProperty, Nothing, Me, Params) 
```

# mysql - MySQL 连接查询帮助

> ID：471362
> 
> 赞同：0
> 
> 时间：2009-01-23T00:01:08.570
> 
> 标签：mysql, select, join, left-join, inner-join

基本上我有一个类似以下的mysql查询：

```
mysql_query("SELECT n.title, v.value FROM posts n INNER JOIN votes v ON n.id = v.id"); 
```

而我需要做的是从帖子表中获取标题，并从投票表中获取当前投票值。

目前，除非发生投票，否则投票不会存储到投票表中。因此，所有票数为 0 的帖子都不在投票表中。

这会导致错误，它试图获取帖子 id = 投票值 id 的标题和投票值。如果投票表中没有任何记录，则值应返回为 NULL 或 0，但此时整个查询返回为 null，因此我什至无法返回标题。

如何在一个查询中解决所有问题？我不想使用多个查询...谢谢:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-23T00:02:52.840

使用左连接而不是内部连接

内连接需要连接两侧的表中的匹配行。

左连接（或使用其全名的左外连接）选择左表中的所有行，然后从右表匹配行，如果右表中没有匹配的行，则返回空值，就像您要求的那样.

（也有右外连接，但是在ON子句中改变周围的条件也可以达到同样的效果）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T00:03:56.800

```
SELECT n.title, v.value FROM posts n LEFT JOIN votes v ON n.id = v.id 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-01-23T00:04:00.497

SELECT n.title, v.value FROM posts as n, votes as v WHERE n.id = v.id

试试看。

# .net - 我可以将 DataMember 添加到 WCF 中的 CollectionDataContract 吗？

> ID：471364
> 
> 赞同：14
> 
> 时间：2009-01-23T00:01:25.213
> 
> 标签：.net, wcf

我有一个用 CollectionDataContract 装饰的集合类。集合类还具有我想传递给服务客户端的类的属性。我已经尝试将 [DataMember] 添加到该属性，但是当我更新时它没有将它添加到客户端的类中。

有任何 WCF 专家可以提供任何帮助吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-16T16:20:21.987

我的博客上发布了一个可行的解决方案：

[http://borismod.blogspot.com/2009/04/wcf-collectiondatacontract-and.html](http://borismod.blogspot.com/2009/04/wcf-collectiondatacontract-and.html)

UPD：谢谢你的评论，杰夫。这是一个非泛型类的摘要。一个完整的通用解决方案可以在我的博客的新帖子中找到：http: [//borismod.blogspot.com/2009/06/v2-wcf-collectiondatacontract-and.html](http://borismod.blogspot.com/2009/06/v2-wcf-collectiondatacontract-and.html)[](http://borismod.blogspot.com/2009/06/v2-wcf-collectiondatacontract-and.html)

```
 [DataContract(IsReference = true)]    
public class EntityCollectionWorkaround : ICollection 
    {

        #region Constructor
        public EntityCollectionWorkaround()
        {
            Entities = new List();
        } 
        #endregion

        [DataMember]
        public int AdditionalProperty { get; set; }

        [DataMember]
        public List Entities { get; set; }

        #region ICollection Members
          // Implement here members of ICollection by wrapping Entities methods
        #endregion

        #region IEnumerable Members
          // Implement here members of IIEnumerable by wrapping Entities methods
        #endregion

    } 

```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-23T01:23:15.127

您可能需要考虑为您的类实现自定义序列化。它可能是最容易实现[`IXmlSerializable`](http://msdn.microsoft.com/en-us/library/system.xml.serialization.ixmlserializable.aspx)的，输出自定义属性的值，然后使用 将[`DataContractSerializer`](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.datacontractserializer.aspx)集合中的子项的实例序列化到输出。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-12T14:50:19.637

此答案旨在作为@BorisModylevsky 给出的答案的附加内容。我可以找到的每个解决方案都建议使用`IXmlSerializable`. 但这是我的问题：我有一个像这样的分层父子结构

```
public class Project 
{
    //Several properties here...

    public ItemCollection Items { get; private set; }

    public Project() 
    { 
        Items = new ItemCollection();
    }
}

public class ItemCollection : IList<ItemDetails>
{
    private List<ItemDetails> _list =  new List<ItemDetails>();

    public Project Parent { get; private set; }

    ///dependency injection...
    public ItemCollection(Project parent)
    {
        this.Parent = parent;
    }

    //Interface methods here working with _list...
    //In the `Add(ItemDetails item)` method, I update incoming items with item.Parent = this.Parent.
}

public class ItemDetails
{
    public Project Parent { get; set; }

    //Several properties here, including some sub classes

    ///dependency injection...
    public ItemDetails(Project parent)
    {
        this.Parent = parent;
    }
} 
```

为了使它工作，[`DataContractSerializer`](https://msdn.microsoft.com/en-us/library/system.runtime.serialization.datacontractserializer.aspx)我必须添加一些私有构造函数和所需的属性：

```
[DataContract(IsReference=true)]
public class Project 
{
    [DataMember(Order=0)]
    public ItemCollection Items { get; private set; }

    //[DataMember(Order=##)]
    //Several properties here, including some other sub classes

    public Project() 
    { 
        Items = new ItemCollection();
    }
}

[CollectionDataContract(IsReference=true)]
public class ItemCollection : IList<ItemDetails>
{
    private List<ItemDetails> _list = new List<ItemDetails>();

    [DataMember(Order=0)]
    public Project Parent { get; private set; }

    ///dependency injection...
    public ItemCollection(Project parent)
    {
        this.Parent = parent;
    }

    //Private constructor for use with DataContractSerializer
    private ItemCollection() { }

    //Interface methods here working with _list...
}

[DataContract(IsReference=true)]
public class ItemDetails
{
    [DataMember(Order=0)]
    public Project Parent { get; private set; }

    //[DataMember(Order=##)]
    //Several properties here, including some sub classes

    ///dependency injection...
    public ItemDetails(Project parent)
    {
        this.Parent = parent;
    }

    //Private constructor for use with DataContractSerializer
    private ItemDetails() { }
} 
```

问题是为集合创建的 XML 如下所示：

```
<Project>
    <!--OTHER PROJECT PROPERTIES HERE-->
    <Items z:Id="i11">
        <ItemDetails z:Id="i12">
            <Parent z:Ref="i1"/>
            <!--OTHER PROPERTIES HERE-->
        </ItemDetails>
        <ItemDetails z:Id="i16">
            <Parent z:Ref="i1"/>
            <!--OTHER PROPERTIES HERE-->
        </ItemDetails>
    </Items>
</Project> 
```

XML 下没有`Parent`属性`Items`。我能说的最好的，`CollectionDataContract`不支持集合类中的任何附加属性。

在这种情况下，如果我`IXmlSerializable`像很多人建议的那样实现，那么我将不得不手动序列化和反序列化 ItemDetails 中的大量结构（为简洁起见，我没有在这里显示）。在这种情况下，DataContractSerializer 对我来说几乎毫无价值。

但是有了上面的@BorisModylevsky 回答，我将代码更改为：

```
[DataContract(IsReference=true)]
public class Project 
{
    [DataMember(Order=0)]
    public ItemCollection Items { get; private set; }

    //[DataMember(Order=##)]
    //Several properties here, including some other sub classes

    public Project() 
    { 
        Items = new ItemCollection();
    }
}

[DataContract(IsReference=true)]
public class ItemCollection : IList<ItemDetails>
{
    //Refactored _list to ItemsList. I didn't have to; I could have used [DataMember(Name="ItemsList", Order=1)]
    [DataMember(Order=1)]
    private List<ItemDetails> ItemsList = new List<ItemDetails>();

    [DataMember(Order=0)]
    public Project Parent { get; private set; }

    ///dependency injection...
    public ItemCollection(Project parent)
    {
        this.Parent = parent;
    }

    //Private constructor for use with DataContractSerializer
    private ItemCollection() { }

    //Interface methods here working with ItemsList...
}

[DataContract(IsReference=true)]
public class ItemDetails
{
    [DataMember(Order=0)]
    public Project Parent { get; private set; }

    //[DataMember(Order=##)]
    //Several properties here, including some sub classes

    ///dependency injection...
    public ItemDetails(Project parent)
    {
        this.Parent = parent;
    }

    //Private constructor for use with DataContractSerializer
    private ItemDetails() { }
} 
```

总结一下：我更改`CollectionDataContract`为`DataContract`并添加`DataMember`到我在收藏中使用的私人列表。这很有效，因为`DataContractSerializer`可以获取和设置私有属性/字段。现在 XML 看起来像这样：

```
<Project>
    <!--OTHER PROJECT PROPERTIES HERE-->
    <Items z:Id="i11">
        <Parent z:Ref="i1"/>
        <ItemsList>
            <ItemDetails z:Id="i12">
                <Parent z:Ref="i1"/>
                <!--OTHER PROPERTIES HERE-->
            </ItemDetails>
            <ItemDetails z:Id="i16">
                <Parent z:Ref="i1"/>
                <!--OTHER PROPERTIES HERE-->
            </ItemDetails>
        </ItemsList>
    </Items>
</Project> 
```

就我的目的而言，这非常有效。它根据需要进行序列化和反序列化。

# mysql - 何时在 MySQL 表中使用 NULL

> ID：471367
> 
> 赞同：50
> 
> 时间：2009-01-23T00:03:56.503
> 
> 标签：mysql, null

我很欣赏数据库表中 NULL 值的语义含义，它不同于 false 和空字符串 ''。但是，我经常阅读有关字段可为空时的性能问题，并建议在 NULL 实际上语义正确的情况下使用空字符串。

什么情况下适合使用可空字段和空值？有哪些取舍？简单地完全避免使用 NULL 并简单地使用空字符串、false 或 0 来表示不存在值是否明智？

**更新**

好的 - 我了解 '' 和 NULL 之间的语义差异以及 NULL 是适当字段值的（与性能无关的）情况。但是，让我扩展一下暗示的性能问题。这是来自 Schwartz、Zeitsev 等人的优秀“高性能 MySQL” [http://www.borders.co.uk/book/high-performance-mysql-optimization-backups-replication-and-more/857673/](http://www.borders.co.uk/book/high-performance-mysql-optimization-backups-replication-and-more/857673/)：

> MySQL 更难优化引用可空列的查询，因为它们使索引、索引统计和值比较更加复杂。可为空的列使用更多的存储空间，并且需要在 MySQL 内部进行特殊处理。当一个可为空的列被索引时，每个条目需要一个额外的字节，甚至可以导致固定大小的索引（例如单个整数列上的索引）在 MyISAM 中转换为可变大小的索引。

更多内容： [Google 图书预览](http://books.google.com/books?id=BL0NNoFPuAQC&pg=PA81&lpg=PA81&dq=%22avoid+null+if+possible%22&source=web&ots=CNSMtvsC4R&sig=Bbp2iSaTdzWpgYhOOcat3aKLuzI&hl=en&sa=X&oi=book_result&resnum=3&ct=result)

这很可能是确定的答案——我只是在寻找一线的第二意见和经验。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-01-23T02:25:40.853

> 但是，我经常阅读有关字段可为空时的性能问题，并建议在 NULL 实际上语义正确的情况下使用空字符串。

我将暂时对单词选择挑剔：

*   即使它是一个重要的性能因素，但这并不意味着使用值而不是 NULL在*语义上是正确的。*在 SQL 中，NULL 具有语义作用，表示缺失或不适用的值。给定 RDBMS 实现中 NULL 的性能特征与此无关。性能可能因品牌或版本而异，但语言中NULL的目的是一致的。

无论如何，我没有听说过任何证据表明 NULL 表现不佳。我会对任何显示可空列性能比不可空列差的性能测量参考感兴趣。

我并不是说我没有错，或者在某些情况下它不可能是真的——只是做空洞的假设没有意义。科学不是由猜想组成的；必须通过可重复的测量来证明证据。

指标还告诉您性能差异*有多大*，因此您可以判断这是否值得担心。也就是说，影响可能是可测量的且非零，但与更大的性能因素（例如正确索引表或调整数据库缓存大小）相比仍然微不足道。

在 MySQL 中，搜索 NULL 可以从索引中受益：

```
mysql> CREATE TABLE foo (
  i INT NOT NULL,
  j INT DEFAULT NULL,
  PRIMARY KEY (i),
  UNIQUE KEY j_index (j)
);

mysql> INSERT INTO foo (i, j) VALUES 
  (1, 1), (2, 2), (3, NULL), (4, NULL), (5, 5);

mysql> EXPLAIN SELECT * FROM foo WHERE i = 3;
+----+-------------+-------+-------+---------------+---------+---------+-------+------+-------+
| id | select_type | table | type  | possible_keys | key     | key_len | ref   | rows | Extra |
+----+-------------+-------+-------+---------------+---------+---------+-------+------+-------+
|  1 | SIMPLE      | foo   | const | PRIMARY       | PRIMARY | 4       | const |    1 |       | 
+----+-------------+-------+-------+---------------+---------+---------+-------+------+-------+

mysql> EXPLAIN SELECT * FROM foo WHERE j IS NULL;
+----+-------------+-------+------+---------------+---------+---------+-------+------+-------------+
| id | select_type | table | type | possible_keys | key     | key_len | ref   | rows | Extra       |
+----+-------------+-------+------+---------------+---------+---------+-------+------+-------------+
|  1 | SIMPLE      | foo   | ref  | j_index       | j_index | 5       | const |    2 | Using where | 
+----+-------------+-------+------+---------------+---------+---------+-------+------+-------------+ 
```

请注意，这仍然不是性能的衡量标准。我只展示了您可以在搜索 NULL 时使用索引。我要断言（诚然没有测量，但这只是 StackOverflow），索引的好处掩盖了在搜索 NULL 与空字符串时任何可能的惩罚。

选择零或空白或任何其他值来代替 NULL 不是正确的设计决定。您可能需要在列中使用这些值作为重要值。这就是为什么 NULL 存在的原因，作为一个定义在任何数据类型的值域之外的值，因此您可以使用整数或字符串或其他任何值的全部范围，并且仍然有一些东西来表示“没有上述值。 "

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-23T00:09:41.093

MySQL 手册实际上有一篇关于[NULL 问题的好文章。](http://dev.mysql.com/doc/refman/5.0/en/problems-with-null.html)

希望能帮助到你。

还发现了关于 NULL 和 Performance 的其他[SO 帖子](https://stackoverflow.com/questions/229179/null-in-mysql-performance-storage)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-27T13:32:17.733

我们不允许在我们的数据库中使用 NULL 值，除非它用于数值或日期。我们这样做的原因是因为数值有时不应该默认为零，因为这非常非常糟糕。**我是股票经纪人的开发人员， NULL**和**0**之间有很大的区别。如果我们确实想将默认值恢复为零，即使我们不这样存储它们，使用 COALESCE 也会派上用场。

```
MyVal = COALESCE(TheData, 0) 
```

当我们从平面文件中批量插入数据时，我们使用格式文件来确定数据的条目，无论如何都会自动将空值转换为空白字符串。

日期默认为取决于我认为的排序规则可能出现的任何值，但我们默认为 1900 之类的值，而且日期非常重要。其他纯文本值并不那么重要，如果留空通常符合条件。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-23T00:08:42.250

通常，如果需要属性，则将其定义为 Not NULL，如果可以省略，则将其定义为可为空。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-23T00:20:47.657

不应使用空字符串代替`NULL`. `NULL`代表什么都没有，因为空字符串是什么，里面什么都没有。与另一个值（偶数）`NULL`比较时总是为假，并且不会在函数中求和。`NULL``NULL``COUNT`

如果您需要表示未知信息，则无法替代`NULL`.

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-06-30T20:57:55.263

正如@ForYourOwnGood 所说 - Null 应该用于“未知”信息。例如：如果您有很多字段需要客户在注册时填写，其中一些是可选的。出于某种原因，您可能希望为该特定客户保留一个 ID，并且由于您不知道可选字段是否是客户真正选择的留空，您应该在第一次保存时将它们设置为 NULL 即“未知”行。如果客户提交了表单，通过了您的所有验证，然后您保存了信息，那么您就知道该可选字段是有意留空的。

这只是使用 NULL 的一个很好的例子。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-23T00:17:06.977

NULL 列的含义或多或少是“不适用于此上下文”。我通常在两种情况下使用 NULL 列：

*   如果该字段不适用（假设您有一个布尔列 is_thirsty 并添加了两个数据集。一个人和一块石头。如果是人，则将 is_thirsty 设置为 true 或 false，而对于石头，您可能会将其设置为 NULL。
*   如果我需要标记某些内容并使用该值存储一些数据。就像库存关闭日期一样，您可以使用它来 a) 指定不能再更改库存和 b) 指定库存关闭的时间。如果库存集仍然可以更改，我只是创建了 closed_at 列并将其设置为 NULL ，而不是有两列（`closed_at`和），但在它关闭后设置日期。`is_closed`

基本上它归结为这样一个事实，即当字段的空性具有与空字段不同的唯一语义时，我使用 NULL。没有中间首字母就是这样。没有结束日期意味着库存集仍然可以更改。

NULL 值可能会产生令人讨厌的副作用，它们会使您难以将数据添加到表中，而且通常情况下，您最终会得到 NULL 值和空字符串的混杂。

此外，NULL 不等于任何东西，如果你不小心的话，它会在所有地方搞砸查询。

就个人而言，我仅在上述两种情况之一适用时才使用 NULL 列。当空值除了没有值之外没有任何意义时，我从不使用它来表示空字段。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-07-06T06:19:37.893

我知道有时 MySQL 的 NULL 语义是完全合适的。

也就是说，它们确实会妨碍您，尤其是在文本字段中。

这是一个真实世界的例子。

我们希望将数据从 FileMaker 数据库复制到 mysql 表中。

如果我们执行“SELECT * from table where textfield <> 'test'”，则不会返回文本字段为 NULL 的行。这很可能不是您所期望或想要的。

如果在 where 查询中使用可为空的字段，无论是单独使用还是作为 AND 的一部分，除非使用 IS NULL 测试，否则永远不会返回为空的条目。我们必须做一些类似“where ((textfield<>"test") OR (textfield IS NOT NULL))”的事情，这充其量是丑陋的。

所以在这种情况下，我们可能不希望该字段可以为空。

这里的问题是您不能使用 Filemaker 将空字符串插入 MySQL。它被转换为 NULL，如果您使列不为空，则会出错！如果您确实允许 NULL，那么到 mysql 的传输工作，但是您的 not 查询无法按照您想要的方式运行！

解决方法是更改​​表两次，将导入后的现有空值转换为空字符串，然后将表更改回再次允许空值。你！

该死的文件制作者。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-23T00:15:48.087

当然，主要的好处是你提到的 NULL 的语义含义。

除此之外——它可能取决于你的存储引擎，一如既往，检查文档——但至少在某些数据库中，NULL 占用的空间比常规值小得多。例如，如果您有一个声明为 20 个字符的“varchar”列，并且很少填充，则可以通过将其设置为 NULL 而不是空字符串来节省大量磁盘空间。

我从来没有听说过使用 NULL 的任何性能问题，相反。我听说有人搞砸了他们的计数，因为他们计算了 NULL 错误，但从来没有计算过性能。如果这是真的，我很想听听！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-23T00:18:24.480

如今，任何自重的数据库引擎都不会因为正确使用 NULL 而受到惩罚，除非您的查询设计不正确（这通常不是您经常遇到的关于 NULL 的问题）。

您应该首先注意按预期使用数据库（包括 NULL）；然后担心何时以及是否发生优化后果。

在 SQL 复杂性和准确性方面，不正确的 NULL 列值的累积影响几乎肯定会超过愚弄 Mother DBMS 的好处。此外，它会弄乱你的头脑，以及以后试图弄清楚你在做什么的任何人的头脑。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-23T00:22:06.467

在 Oracle 等一些数据库上，MySQL 上的某些想法可能是真的：

*   空值没有被索引，那么如果寻找空值可能是瓶颈。
*   行上的尾随空值可以节省空间。

# css - 在 IE7 中调试 CSS 问题？

> ID：471392
> 
> 赞同：5
> 
> 时间：2009-01-23T00:11:36.880
> 
> 标签：css, internet-explorer, debugging, internet-explorer-7

我需要在 IE7 上调试一些恼人的 CSS 问题，我已经安装了 Internet Explorer 开发工具栏。它无法解决所有正在应用的样式。

我也在使用[Firebug lite](http://getfirebug.com/lite.html)，它很有帮助，但太基础了。

由于这个 Intranet 网站的设计不佳，在 Firefox 中调试这些东西不是一种选择。

是否有任何其他工具可以帮助我在 IE7 上调试 CSS 问题。

相关问题：[Debugging JavaScript in IE7](https://stackoverflow.com/questions/361635/debugging-javascript-in-ie7)。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-23T00:32:07.697

我刚刚找到[了 DebugBar](http://www.my-debugbar.com)，它似乎给了我很多帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T00:13:33.927

XRAY 是一个对跨浏览器调试非常有帮助的书签。

[关联](http://www.westciv.com/xray/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-23T00:27:48.017

谷歌浏览器的“检查元素”对我很有帮助——尤其是对于我自己没有编写的标记。能够看到哪个元素引用了哪个样式表是天赐之物。

# c# - C#，如何让对象重新初始化自身？

> ID：471396
> 
> 赞同：2
> 
> 时间：2009-01-23T00:13:13.973
> 
> 标签：c#, regex, object

好的，在 Perl 中使对象重新初始化本身很容易，因为它由可分配的引用或指针表示。然而，C# 似乎并不喜欢这样。

我想创建一个 System.Text.RegularExpressions.Regex 的子类，它的模式可以在不使用新对象并为每个对象消耗内存的情况下更改。（私有初始化引用不会让我再次运行它，所以我尝试重新创建对象引用）。

这是否可以在不围绕父对象创建完整包装器的情况下通过重新实现每个方法来指向为每次新使用重新初始化的私有正则表达式对象？有没有更好的办法？

```
public class m_Regex : System.Text.RegularExpressions.Regex{

    public m_Regex(string pattern): base (pattern){

    }

    public void Pattern(string pattern){
        this = new m_Regex(pattern);
    }   
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T00:26:32.713

我不确定您要解决的确切问题。如果您担心正在使用的内存量，可能是由于 Regex 对象的快速创建/删除，那么您可以让您的包装器实现 IDisposable 并将它们包装在一个`using`块中，以便更快地释放资源。如果 Regex 对象的数量相当少，那么我不确定我是否会为此担心太多。一旦对象超出范围，它就可以被垃圾回收。如果 Regex 对象是固定的，您可能还需要考虑在“regex factory”中创建每个对象的静态实例，您可以一遍又一遍地使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-23T00:39:00.660

[System.Text.RegularExpressions.Regex](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.regex(VS.80).aspx)类以这种方式运行的原因是因为它是不可变的。因此，一旦创建了 Regex 对象，您就无法更改模式。简而言之，没有办法做你想做的事，即用新模式重新初始化现有对象。如果要更改模式，根据定义，您必须创建一个新的 Regex 对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T10:16:11.307

```
//First use
myregex = new RegEx("^Pattern$");    
// later on in the code, i need to change pattern
// this call is different to the first, and i can't tell why..
myregex = myregex.Pattern("^NewPattern$"); 
```

如果我要查看使用此模式的代码，我会立即跳转到 .Pattern 的实现，以了解为什么 myregex 的“下一次”使用与第一次不同。我的期望是新正则表达式的构造会受到当前正则表达式实例状态的影响（尽管我一直在尝试但未能成功）。

.Pattern 有一种工厂方法的感觉，但它是在自身的一个实例上，我觉得这很混乱，并且似乎没有比直接使用 RegEx 构造函数增加任何价值。

关于 GC 问题，可以通过调用 GC.Collect() 强制 GC 运行，但它要求收集是一件特殊的事情，通常不应该被调用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-23T04:22:22.677

经过一番讨论后，我发现这可以满足我想要的一些（次要）语义差异

`公共类 m_Regex : System.Text.RegularExpressions.Regex{

```
 public m_Regex(string pattern): base (pattern){

    }

    public m_Regex Pattern(string pattern){

        return new m_Regex(pattern);
    }

}` 
```

所以现在我可以使用模式来“重新定义”当前的正则表达式，方法是为持有变量分配一个新的对象引用，而不是替换实例本身。所以现在（大概）之前的正则表达式引用被标记为 GC，因为没有人再使用它并且更可口和自我记录

myregex = myregex.Pattern("^NewPattern$"); 可以用来给出模式更改正则表达式的功能错觉，尽管我认为我仍然希望能够简单地调用成员并使其完全在幕后发生。

那我说得对吗？GC 会按照这种模式拾取所有使用过的正则表达式吗？即使当前实例化在范围内，它也会这样做吗？GC什么时候发生？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-23T00:16:36.680

C# 不支持这样的语法。事实上，如果你尝试编译你的代码，你会得到一个编译错误，指出：“这是一个只读属性”。不幸的是，你今天运气不好。:)

另一种方法是不要让你的类基于正则表达式，而是有一个包装类。例如。

```
public class Wrapper
{
 private Regex _regex;
 public Wrapper(string pattern)
 {
  _regex = new Regex(pattern);
 }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-23T00:23:55.747

我想知道内置.NET 是否有一个好的外部正则表达式“竞争对手”可以用于此目的。

也许 = [http://www.codeguru.com/Cpp/Cpp/string/regex/article.php/c2779/](http://www.codeguru.com/Cpp/Cpp/string/regex/article.php/c2779/)

# .net - 引导程序先决条件订购

> ID：471405
> 
> 赞同：4
> 
> 时间：2009-01-23T00:19:20.170
> 
> 标签：.net, installation, bootstrapper

将通用引导程序与 MSBuild 一起使用时，如何确定必备项的安装顺序？

例如，给定：

```
<Project ToolsVersion="3.5" xmlns='http://schemas.microsoft.com/developer/msbuild/2003'>
  <ItemGroup>
    <BootstrapperFile Include='A' />
    <BootstrapperFile Include='B' />
    <BootstrapperFile Include='C' />
    <BootstrapperFile Include='D' />
  </ItemGroup>

  <Target Name='MySetup'>
    <GenerateBootstrapper
      Path='C:\Program Files\Microsoft SDKs\Windows\v6.0A\Bootstrapper'
      ApplicationName='My Program'
      ApplicationFile='MyProgram.msi'
      BootstrapperItems='@(BootstrapperFile)'
      Culture='en'
      CopyComponents='true'
      ComponentsLocation='HomeSite'
      OutputPath='.\' />
  </Target>
</Project> 
```

A、B、C、D 的安装顺序是什么？我如何控制该订单？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-23T00:33:19.800

看起来我可以在带有`DependsOnProduct`标签的产品清单中指定：

```
<Product ProductCode="A">
  <PackageFiles>...</PackageFiles>
  <RelatedProducts>
    <DependsOnProduct Code="B" />
  </RelatedProducts>
  ...
</Product> 
```

这应该会导致`B`之前被安装`A`。

[http://msdn.microsoft.com/en-us/library/ms229456.aspx](http://msdn.microsoft.com/en-us/library/ms229456.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T00:51:28.233

你似乎已经回答了你自己的问题。正如您在回答中提到的那样，产品的顺序由包装本身决定。您的 msi 始终是最后安装的。

这些包可以在（对于 VS2008）中找到：
C:\Program Files\Microsoft SDKs\Windows\v6.0A\Bootstrapper\Packages

每个包都包含它自己的引导程序清单文件，其中设置了先决条件。对于 microsoft 提供的软件包，您不必担心这一点。你真的应该只关心你是否为你的先决条件创建自己的包。

# php - 如何以设定的间隔单独显示行？

> ID：471408
> 
> 赞同：0
> 
> 时间：2009-01-23T00:21:35.207
> 
> 标签：php, javascript, css

这是问题.... 我有一个 PHP 程序读取和显示 MySQL 数据库的内容（4 个文本字段）。这些记录在页面下方按顺序显示。我希望做的是读取一条记录并显示文本，有一个小计时器暂停，然后在页面的同一位置显示下一条记录。就像文本的幻灯片放映一样。

如果我使用 CSS 位置命令，文本将定位在同一个位置，但它只是写在前一条记录上。有没有办法清除/删除页面上特定位置的内容....或其他一些方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T19:48:07.297

如果你使用像 jQuery 这样的库来做你的 JavaScript 肮脏的工作，那么我会在某种程度上提出一些建议。

```
<style type="text/css">
    ul {
        margin:0;
        padding:0;
        list-style:none;
        width:300px;
        height:300px;
        overflow:hidden;
        border:#000 1px solid;
    }
    ul li{
        margin:0;
        padding:0;
        list-style:none;
        width:300px;
        height:300px;
        display:none;
    }
    .active{
        display:block;
    }
</style>

<ul>
   <li class="active">1 Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum. </li>
   <li>2 Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum. </li>
   <li>3 Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum. </li>
   <li>4 Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum. </li>
</ul>​​​​​​​​​​​​​

<script type="text/javascript">
​setInterval(function()
{
   if($('ul li[class="active"]').is(':last-child'))
   {
       $('ul li[class="active"]').removeClass('active');
       $('ul li:first').addClass('active')
   }   
   else
   {
       $('ul li[class="active"]').removeClass('active').next().addClass('active');
   }
},5000);
​&lt;/script> 
```

Ipsum 文本可以是您从查询中回显的结果，您可以将整个无序列表放入您的 div 中，您只需要相应地调整大小以满足您的需求。

[jsFiddle 演示](http://jsfiddle.net/BsREB/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T16:48:33.280

你想要显示属性；具体来说，显示：无和显示：块。从具有 display:block 的第一行开始，其余的具有 display:none，然后当计时器前进时，将第一行切换为 display:none，将第二行切换为 display:block。

你可能想纯粹通过一个类来处理这个问题。在 CSS 中将所有行设置为 display:none，然后一次只有一行使用“活动”类或类似的具有 display:block 的东西。

# css - IE的对齐问题

> ID：471411
> 
> 赞同：0
> 
> 时间：2009-01-23T00:23:13.283
> 
> 标签：css, internet-explorer

我正在为我的网页使用蓝图 CSS 框架，现在我遇到了 IE 浏览器的对齐问题。它适用于 mozilla。

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T01:43:03.497

您需要使用[条件注释](http://www.quirksmode.org/css/condcom.html)来赋予 IE 特定的样式。您可能还想尝试[IE7-js](http://code.google.com/p/ie7-js/)。

# javascript - 修改javascript以在没有表单的情况下工作？

> ID：471412
> 
> 赞同：-1
> 
> 时间：2009-01-23T00:23:43.453
> 
> 标签：javascript, html, forms

我想用它来隐藏/扩展列：
[http](http://www.fiendish.demon.co.uk/html/javascript/hidetablecols.html)
://www.fiendish.demon.co.uk/html/javascript/hidetablecols.html 但删除与表单有关的一切。必须相应地更改 java 脚本函数，但我没有任何运气。有什么建议么？
谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T00:43:29.437

代码测试和工作。随时提出有关它的问题:)

```
<script language="javascript">

// Set the default "show" mode to that specified by W3C DOM
// compliant browsers

var showMode = 'table-cell';

// However, IE5 at least does not render table cells correctly
// using the style 'table-cell', but does when the style 'block'
// is used, so handle this

if (document.all) showMode='block';

// This is the function that actually does the manipulation

var States = { };

function toggleVis(col){

    if (!States[col] || States[col].IsOpen == null)
    {
        States[col] = {isOpen : true}; // This assumes the cell is already shown
    } 

    mode =  States[col].IsOpen ? showMode : 'none';

    cells = document.getElementsByName(col);
    for(j = 0; j < cells.length; j++) cells[j].style.display = mode;

    States[col].IsOpen = !States[col].IsOpen;
}

</script>

<a href="#" onclick="toggleVis('tcol1'); return false;">Toggle 1</a>
<a href="#" onclick="toggleVis('tcol2'); return false;">Toggle 2</a>
<a href="#" onclick="toggleVis('tcol3'); return false;">Toggle 3</a>
<a href="#" onclick="toggleVis('tcol4'); return false;">Toggle 3</a>

<table border=1>
<tr>
<td name="tcol1" class="bold">column 1 text</td>
<td name="tcol2" >column 2 text</td>
<td name="tcol3" class="italic">column 3 text</td>
<td name="tcol4" >column 4 text</td>
</tr>
<tr>
<td name="tcol1" class="bold">column 1 text</td>
<td name="tcol2" >column 2 text</td>
<td name="tcol3" class="italic">column 3 text</td>
<td name="tcol4" >column 4 text</td>
</tr>
</table> 
```

# sharepoint - Sharepoint 中自定义列类型中的只读属性

> ID：471414
> 
> 赞同：1
> 
> 时间：2009-01-23T00:24:43.623
> 
> 标签：sharepoint, sharepoint-2007, moss, field, customcolumn

我正在为 Sharepoint 的功能中创建一个自定义列。本质上是这样的：

```
<Field 
  Type="Integer" 
  ID="<insert guid here>" 
  ReadOnly="true"
  Name="xxx"
  DisplayName="XXX"
  Group="YYY" /> 
```

当字段被部署并附加到内容类型时，内容类型显示没有附加此字段的实例。关于 ReadOnly的[文档](http://msdn.microsoft.com/en-us/library/ms437580.aspx)有点含糊，但明确指出该列将可用于在视图中查看。但是，当我创建视图时，它不可用。

当我从该字段中删除 ReadOnly 时，它在内容类型上可用，没有任何问题。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-25T20:47:44.940

我已经使用 SharePoint 设计器在开发框中尝试了相同的架构来创建它。在将类型从“整数”更改为“数字”之前，我无法看到该列

不确定是否支持“整数”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T23:56:22.960

您是否尝试将 ReadOnly 放在内容类型的 FieldRef 而不是 Field 元素上？

# ruby-on-rails - 你如何编写一个迁移来重命名一个 ActiveRecord 模型及其在 Rails 中的表？

> ID：471416
> 
> 赞同：428
> 
> 时间：2009-01-23T00:25:42.187
> 
> 标签：ruby-on-rails, migration, rails-activerecord

我不擅长命名，并意识到在我的 Rails 应用程序中有一组更好的模型名称。
有没有办法使用迁移来重命名模型及其对应的表？

* * *

## 回答 #1

> 赞同：609
> 
> 时间：2009-01-23T00:29:42.660

这是一个例子：

```
class RenameOldTableToNewTable < ActiveRecord::Migration
  def self.up
    rename_table :old_table_name, :new_table_name
  end

  def self.down
    rename_table :new_table_name, :old_table_name
  end
end 
```

我不得不手动重命名模型声明文件。

**编辑：**

在 Rails 3.1 和 4 中，`ActiveRecord::Migration::CommandRecorder`知道如何反向 rename_table 迁移，所以你可以这样做：

```
class RenameOldTableToNewTable < ActiveRecord::Migration
  def change
    rename_table :old_table_name, :new_table_name
  end 
end 
```

（您仍然需要手动重命名文件。）

* * *

## 回答 #2

> 赞同：76
> 
> 时间：2013-12-17T01:27:55.740

在 Rails 4 中，我所要做的就是更改 def

```
def change
  rename_table :old_table_name, :new_table_name
end 
```

我所有的索引都为我处理好了。我不需要通过删除旧索引并添加新索引来手动更新索引。

它也可以使用索引的上升或下降变化来工作。

* * *

## 回答 #3

> 赞同：54
> 
> 时间：2012-09-17T20:06:35.990

其他答案和评论包括表重命名、文件重命名和通过代码查找。

我想补充一些注意事项：

让我们使用我今天遇到的一个真实示例：将模型从“Merchant”重命名为“Business”。

*   不要忘记在同一迁移中更改依赖表和模型的名称。我同时将 Merchant 和 MerchantStat 模型更改为 Business 和 BusinessStat。否则，在执行搜索和替换时，我不得不做太多的挑选和选择。
*   对于通过外键依赖于您的模型的任何其他模型，其他表的外键列名称将从您的原始模型名称派生。因此，您还需要对这些依赖模型进行一些 rename_column 调用。例如，我必须在各种连接表（对于 has_and_belongs_to_many 关系）和其他依赖表（对于正常的 has_one 和 has_many 关系）中将“merchant_id”列重命名为“business_id”。否则我最终会得到像“business_stat.merchant_id”这样指向“business.id”的列。[这是关于进行列重命名的一个很好的答案。](https://stackoverflow.com/questions/1992019/how-can-i-rename-a-database-column-in-a-rails-migration)
*   grepping 时，请记住搜索字符串的单数、复数、大写、小写甚至大写（可能出现在注释中）版本。
*   最好先搜索复数版本，然后再搜索单数。这样，如果您有不规则复数 - 例如在我的商人 :: 企业示例中 - 您可以正确获取所有不规则复数。否则，您最终可能会以“businesss”（3 s）作为中间状态，从而导致更多的搜索和替换。
*   不要盲目地替换每一次出现。如果您的模型名称与常见的编程术语、其他模型中的值或视图中的文本内容相冲突，您最终可能会过于急切。在我的示例中，我想将模型名称更改为“业务”，但在 UI 的内容中仍将它们称为“商家”。在 CanCan 中，我还为我的用户设置了一个“商人”角色——正是商人角色和商人模型之间的混淆导致我首先重命名了该模型。

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2012-12-05T07:30:48.093

您还需要替换索引：

```
class RenameOldTableToNewTable< ActiveRecord:Migration
  def self.up
    remove_index :old_table_name, :column_name
    rename_table :old_table_name, :new_table_name
    add_index :new_table_name, :column_name
  end 

  def self.down
    remove_index :new_table_name, :column_name
    rename_table :new_table_name, :old_table_name
    add_index :old_table_name, :column_name
  end
end 
```

并按照此处描述的其他答案手动重命名您的文件等。

请参阅：[http ://api.rubyonrails.org/classes/ActiveRecord/Migration.html](http://api.rubyonrails.org/classes/ActiveRecord/Migration.html)

确保在编写此迁移后可以回滚和前滚。如果您遇到错误并陷入试图影响不再存在的某些东西的迁移中，这可能会变得很棘手。如果无法回滚，最好丢弃整个数据库并重新开始。因此请注意，您可能需要备份某些内容。

另外：检查 schema_db 以获取由 has_ 或 belongs_to 或其他东西定义的其他表中的任何相关列名。您可能还需要编辑它们。

最后，在没有回归测试套件的情况下这样做会很疯狂。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-09-17T11:11:00.820

您可以执行以下命令： rails g migration rename_{old_table_name} *to* {new_table_name}

编辑文件并在方法更改中添加此代码后

重命名表：{old_table_name}，：{new_table_name}

# networking - 从远程共享分页

> ID：471421
> 
> 赞同：1
> 
> 时间：2009-01-23T00:28:06.033
> 
> 标签：networking, paging, share, fault

假设我有一个在 Windows XP 上运行的应用程序，它是从映射的网络驱动器“启动”的。当此应用程序的执行触发页面错误并且需要从磁盘读取代码页时，假设它不在页面文件中，Windows 将转到映射的网络共享以从磁盘中读取必要的代码页还是将首次执行时它会在本地复制它吗？我意识到有不同类型的页面错误，但我特别询问必须从磁盘上的文件中读取代码的情况。在这种情况下，由于应用程序的图像存在于远程共享上，我假设页面错误处理程序必须前往网络共享以检索代码页。这个对吗？

我有一个以这种方式运行的应用程序，它似乎会定期“挂起”系统，但系统会在短时间内响应，有时只需几秒钟，在其他情况下为 10-15 分钟。该系统还安装了许多 A/V 和 DLP 产品，因此有几个 TDI 过滤器驱动程序和文件系统过滤器驱动程序似乎会增加处理页面错误的延迟，特别是如果代码必须从进程中调入存在于远程共享上的图像。

我一直在阅读 Windows Internals 并讨论了页面错误处理，但在处理远程映射驱动器时我没有看到任何提及该案例。我假设它必须到网络共享来检索必要的代码页，但我只是想确定我是对的。如果有人有其他推荐的读物，我很想听听。我目前有一个内核调试器连接到一个有问题的系统，所以我可以在行动中抓住它，但是，当然，因为我已经连接了内核调试器并且已经运行了 2 天，所以我还没有看到问题再次发生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-24T20:54:19.493

我不确定这个问题是否正确。

> Windows 会去映射的网络共享以从磁盘中读取必要的代码页，还是会在首次执行时在本地复制它？”

所有代码必须在本地内存中才能执行。网络映射驱动器上的页面错误将导致网络 I/O 获取适当的页面，该页面将加载到本地内存中然后使用。

> 在这种情况下，由于应用程序的图像存在于远程共享上，我假设页面错误处理程序必须前往网络共享以检索代码页。这个对吗？”

是的。页面错误处理程序不知道驱动器是网络映射的。它将发出一个文件系统 IRP。网络映射驱动程序将拦截它并将其转换为网络 IRP。所以页面错误处理程序只是在做正常的事情；它不知道你在后台做巫术。

> 我有一个以这种方式运行的应用程序，它似乎会定期“挂起”系统，但系统会在短时间内响应，有时只需几秒钟，在其他情况下为 10-15 分钟。该系统还安装了许多 A/V 和 DLP 产品，因此有几个 TDI 过滤器驱动程序和文件系统过滤器驱动程序似乎会增加处理页面错误的延迟，特别是如果代码必须从进程中调入存在于远程共享上的图像。

呃，上面有这么多内核黑客的东西，我的第一个想法是你的 Windows 安装只是简单粗暴。A/V 的东西对 Windows 来说是毒药，你似乎有很多东西被塞进内核——你在自*找麻烦*，似乎麻烦已经来了。

最简单的解释是最有可能的；考虑到您这里有大量的恶意软件，Windows 很可能只是被搞砸了。您不需要更深入的技术解释！

# c# - 传达构造函数在 C# 中失败的最佳方式是什么？

> ID：471422
> 
> 赞同：13
> 
> 时间：2009-01-23T00:28:21.837
> 
> 标签：c#, exception, constructor

在 C# 中，我想向调用方法传达传递给对象的参数导致其实例化失败。

```
// okay
Banana banana1 = new Banana("green");

// fail
Banana banana2 = new Banana("red"); 
```

抛出异常？如果有怎么办？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-01-23T00:30:30.740

```
throw new ArgumentException("Reason", "param name"); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-23T00:56:32.280

很多（全部？）答案都说要抛出异常，但我确信我已经看到框架设计团队的官方声明建议不要从构造函数中抛出异常。

请注意，.NET 框架中的行为类似于您的“香蕉”示例（其中只有某些值适合实例化对象）的类不使用构造函数，而是使用静态工厂方法。例如，[System.Net.WebRequest](http://msdn.microsoft.com/en-us/library/system.net.webrequest.aspx)没有公共构造函数，而是使用静态[Create](http://msdn.microsoft.com/en-us/library/system.net.webrequest.create.aspx)方法，如果提供的字符串不是有效的 URI，该方法会引发异常。*除了一些例外 - 请参阅下面的更新。*

因此，对于您的代码，我会将 Banana 的构造函数更改为 protected，并引入如下方法：

```
public static Banana Create(string color) 
{
    if (color != "green" && color != "yellow")
    {
        throw new ArgumentException("Color must be 'green' or 'yellow'", 
            "color");
    }
    return new Banana(color);
} 
```

**更新**

好的，从构造函数中抛出异常似乎不是一个*坏主意。*事实上，如果您将无效的文件名传递给它的构造函数，System.IO.FileStream 就是这样做的。我想使用静态工厂方法的想法只是更明确地说明如何创建实例的一种方式（例如，如果上面的方法被称为“FromColor”）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-23T00:32:54.357

最被接受的解决方案是抛出异常。为了证明这一点，打开反射器并查看 BCL 中的大多数类以及它们在构造时可能引发的异常。

举个例子。如果集合为空，List(IEnumerable collection) 将抛出异常。向调用者传达错误的一种完全有效的方式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-23T00:38:45.450

如果你的构造函数失败，你应该抛出一个异常。按照定义，构造函数不返回值，因此您不能返回错误代码。

```
public class Banana 
{
    public Banana(string color)
    {
        if ( color == "red" )
          throw new SomeException("intialization failed, red is an invalid color");

    }
}
//////////////////////////////////////////////////////////     
try
{
    Banana banana1 = new Banana("green");
    banana1.whatever();
}
catch( SomeException error )
{
    // do something
}
finally
{
    // always do  this stuff
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-23T00:32:54.043

我想你想要 ArgumentException ......

# wix - WiX 技巧和窍门

> ID：471424
> 
> 赞同：264
> 
> 时间：2009-01-23T00:29:24.520
> 
> 标签：wix, wix3.5, wix3

我们使用 WiX 已经有一段时间了，尽管通常会抱怨易用性，但它运行得相当好。我正在寻找的是关于以下方面的有用建议：

*   设置 WiX 项目（布局、参考、文件模式）
*   将 WiX 集成到解决方案和构建/发布流程中
*   为新安装和升级配置安装程序
*   您想分享的任何好的 WiX hack

* * *

## 回答 #1

> 赞同：157
> 
> 时间：2009-02-23T14:25:51.730

1.  将变量保存在单独`wxi`的包含文件中。可以重复使用，变量查找速度更快，并且（如果需要）允许通过外部工具更轻松地进行操作。

2.  为 x86 和 x64 构建定义平台变量

    ```
    <!-- Product name as you want it to appear in Add/Remove Programs-->
    <?if $(var.Platform) = x64 ?>
      <?define ProductName = "Product Name (64 bit)" ?>
      <?define Win64 = "yes" ?>
      <?define PlatformProgramFilesFolder = "ProgramFiles64Folder" ?>
    <?else ?>
      <?define ProductName = "Product Name" ?>
      <?define Win64 = "no" ?>
      <?define PlatformProgramFilesFolder = "ProgramFilesFolder" ?>
    <?endif ?> 
    ```

3.  将安装位置存储在注册表中，使升级能够找到正确的位置。例如，如果用户设置自定义安装目录。

    ```
     <Property Id="INSTALLLOCATION">
        <RegistrySearch Id="RegistrySearch" Type="raw" Root="HKLM" Win64="$(var.Win64)"
                  Key="Software\Company\Product" Name="InstallLocation" />
     </Property> 
    ```

    **注意**：WiX 大师[Rob Mensching](https://stackoverflow.com/users/23852/rob-mensching)发布了一篇[出色的博客文章](http://robmensching.com/blog/posts/2010/5/2/The-WiX-toolsets-Remember-Property-pattern)，其中更详细地介绍了从命令行设置属性时的边缘情况。

    使用 1\. 2\. 和 3 的示例。

    ```
    <?include $(sys.CURRENTDIR)\Config.wxi?>
    <Product ... >
      <Package InstallerVersion="200" InstallPrivileges="elevated"
               InstallScope="perMachine" Platform="$(var.Platform)"
               Compressed="yes" Description="$(var.ProductName)" /> 
    ```

    和

    ```
    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="$(var.PlatformProgramFilesFolder)">
        <Directory Id="INSTALLLOCATION" Name="$(var.InstallName)"> 
    ```

4.  最简单的方法总是进行[重大升级](http://blogs.technet.com/b/alexshev/archive/2008/02/15/from-msi-to-wix-part-8-major-upgrade.aspx)，因为它允许在单个 MSI 中进行新安装和升级。[UpgradeCode](https://stackoverflow.com/questions/114165/how-to-implement-wix-installer-upgrade/724098#724098)固定为唯一的 Guid 并且永远不会改变，除非我们不想升级现有产品。

    **注意**：在 WiX 3.5 中有一个新的[MajorUpgrade](http://wix.sourceforge.net/manual-wix3/wix_xsd_majorupgrade.htm)元素，它让生活[更加轻松](http://www.joyofsetup.com/2010/01/16/major-upgrades-now-easier-than-ever/)！

5.  在添加/删除程序中创建图标

    ```
    <Icon Id="Company.ico" SourceFile="..\Tools\Company\Images\Company.ico" />
    <Property Id="ARPPRODUCTICON" Value="Company.ico" />
    <Property Id="ARPHELPLINK" Value="http://www.example.com/" /> 
    ```

6.  在发布版本中，我们对安装程序进行版本控制，将 msi 文件复制到部署目录。使用从 AfterBuild 目标调用的 wixproj 目标的示例：

    ```
    <Target Name="CopyToDeploy" Condition="'$(Configuration)' == 'Release'">
      <!-- Note we append AssemblyFileVersion, changing MSI file name only works with Major Upgrades -->
      <Copy SourceFiles="$(OutputPath)$(OutputName).msi" 
            DestinationFiles="..\Deploy\Setup\$(OutputName) $(AssemblyFileVersion)_$(Platform).msi" />
    </Target> 
    ```

7.  使用 heat 收集带有通配符 (*) Guid 的文件。如果您想跨多个项目重用 WXS 文件，这很有用（请参阅我对同一产品的多个版本的回答）。例如，此批处理文件自动收集 RoboHelp 输出。

    ```
    @echo off  
    robocopy ..\WebHelp "%TEMP%\WebHelpTemp\WebHelp" /E /NP /PURGE /XD .svn  
    "%WIX%bin\heat" dir "%TEMP%\WebHelp" -nologo -sfrag -suid -ag -srd -dir WebHelp -out WebHelp.wxs -cg WebHelpComponent -dr INSTALLLOCATION -var var.WebDeploySourceDir 
    ```

    有一些事情发生，`robocopy`在收获之前剥离 Subversion 工作副本元数据；根`-dr`目录引用设置为我们的安装位置，而不是默认的 TARGETDIR；`-var`用于创建变量以指定源目录（Web 部署输出）。

8.  通过使用 Strings.wxl 进行本地化，可以轻松地将产品版本包含在欢迎对话框标题中。（信用：[saschabeaumont](https://stackoverflow.com/users/592/saschabeaumont)。添加，因为这个很棒的提示隐藏在评论中）

    ```
    <WixLocalization Culture="en-US" xmlns="http://schemas.microsoft.com/wix/2006/localization">
        <String Id="WelcomeDlgTitle">{\WixUI_Font_Bigger}Welcome to the [ProductName] [ProductVersion] Setup Wizard</String>
    </WixLocalization> 
    ```

9.  省去一些痛苦，并遵循[Wim Coehen 关于](https://stackoverflow.com/questions/1602831/wix-one-file-per-component-or-several-files-per-component/1604348#1604348)每个文件一个组件的建议。这也允许您省略（或通配符`*`）[组件 GUID](http://wix.sourceforge.net/manual-wix3/wix_xsd_component.htm)。

10.  Rob Mensching 有一种[巧妙的方法](http://robmensching.com/blog/posts/2010/8/2/The-first-thing-I-do-with-an-MSI-log)，可以通过搜索`value 3`. 请注意有关国际化的注释。

11.  添加条件功能时，将默认功能级别设置为 0（禁用），然后将条件级别设置为您想要的值会更直观。如果您将默认功能级别设置为 >= 1，则条件级别必须为 0 才能禁用它，这意味着条件逻辑必须与您期望的相反，这可能会令人困惑:)

    ```
    <Feature Id="NewInstallFeature" Level="0" Description="New installation feature" Absent="allow">
      <Condition Level="1">NOT UPGRADEFOUND</Condition>
    </Feature>
    <Feature Id="UpgradeFeature" Level="0" Description="Upgrade feature" Absent="allow">
      <Condition Level="1">UPGRADEFOUND</Condition>
    </Feature> 
    ```

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2009-03-05T16:13:17.347

Checking if IIS is installed:

```
<Property Id="IIS_MAJOR_VERSION">
    <RegistrySearch Id="CheckIISVersion" Root="HKLM" Key="SOFTWARE\Microsoft\InetStp" Name="MajorVersion" Type="raw" />
</Property>

<Condition Message="IIS must be installed">
    Installed OR IIS_MAJOR_VERSION
</Condition> 
```

Checking if IIS 6 Metabase Compatibility is installed on Vista+:

```
<Property Id="IIS_METABASE_COMPAT">
    <RegistrySearch Id="CheckIISMetabase" Root="HKLM" Key="SOFTWARE\Microsoft\InetStp\Components" Name="ADSICompatibility" Type="raw" />
</Property>

<Condition Message="IIS 6 Metabase Compatibility feature must be installed">
    Installed OR ((VersionNT &lt; 600) OR IIS_METABASE_COMPAT)
</Condition> 
```

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2009-11-26T04:01:10.417

**Keep all IDs in separate namespaces**

*   Features begin with `F.` Examples: F.Documentation, F.Binaries, F.SampleCode.
*   Components begin with `C.` Ex: C.ChmFile, C.ReleaseNotes, C.LicenseFile, C.IniFile, C.Registry
*   CustomActions are `CA.` Ex: CA.LaunchHelp, CA.UpdateReadyDlg, CA.SetPropertyX
*   Files are `Fi.`
*   Directories are `Di.`
*   and so on.

I find this helps immensely in keeping track of all the various id's in all the various categories.

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2009-02-07T03:16:43.253

很棒的问题。我很想看到一些最佳实践。

我有很多要分发的文件，所以我将我的项目设置为几个 wxs 源文件。

我有一个名为 Product.wxs 的顶级源文件，它基本上包含安装结构，但不包含实际组件。该文件有几个部分：

```
<Product ...>
  <Package ...>
    <Media>... 
   <Condition>s ...
   <Upgrade ..>
   <Directory> 
        ...
   </Directory>
   <Feature>
      <ComponentGroupRef ... > A bunch of these that
   </Feature>
   <UI ...>
   <Property...>
   <Custom Actions...>
   <Install Sequences....
  </Package>
</Product> 
```

.wix 文件的其余部分由包含在 Product.wxs 的 Feature 标记中引用的 ComponentGroups 的 Fragment 组成。我的项目包含我分发的文件的一个很好的逻辑分组

```
<Fragment>
   <ComponentGroup>
     <ComponentRef>
     ....
    </ComponentGroup>
    <DirectoryRef>
      <Component... for each file
      .... 
    </DirectoryRef>
</Fragment> 
```

这并不完美，我的 OO 蜘蛛感觉有点刺痛，因为片段必须引用 Product.wxs 文件中的名称（例如 DirectoryRef），但我发现维护单个大型源文件更容易。

我很想听听对此的评论，或者如果有人也有任何好的建议！

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2009-11-26T03:47:55.590

**在退出对话框中添加一个复选框以启动应用程序或帮助文件。**

...

```
<!-- CA to launch the exe after install -->
<CustomAction Id          ="CA.StartAppOnExit"
              FileKey     ="YourAppExeId"
              ExeCommand  =""
              Execute     ="immediate"
              Impersonate ="yes"
              Return      ="asyncNoWait" />

<!-- CA to launch the help file -->
<CustomAction Id         ="CA.LaunchHelp"
              Directory  ="INSTALLDIR"
              ExeCommand ='[WindowsFolder]hh.exe IirfGuide.chm'
              Execute    ="immediate"
              Return     ="asyncNoWait" />

<Property Id="WIXUI_EXITDIALOGOPTIONALCHECKBOXTEXT"
          Value="Launch MyApp when setup exits." />

<UI>
  <Publish Dialog  ="ExitDialog"
           Control ="Finish"
           Order   ="1"
           Event   ="DoAction"
           Value   ="CA.StartAppOnExit">WIXUI_EXITDIALOGOPTIONALCHECKBOXTEXT</Publish>
</UI> 
```

如果你这样做，“标准”外观就不太对了。复选框始终为灰色背景，而对话框为白色：

[替代文字 http://www.dizzymonkeydesign.com/blog/misc/adding-and-customizing-dlgs-in-wix-3/images/exit_dlg_1.gif](http://www.dizzymonkeydesign.com/blog/misc/adding-and-customizing-dlgs-in-wix-3/images/exit_dlg_1.gif)

解决此问题的一种方法是[使用不同位置的复选框指定您自己的自定义 ExitDialog](http://www.dizzymonkeydesign.com/blog/misc/adding-and-customizing-dlgs-in-wix-3/)。这可行，但似乎只是为了更改一个控件的颜色需要做很多工作。解决同一问题的另一种方法是对生成的 MSI 进行后处理，以更改该特定 CheckBox 控件的控制表中的 X、Y 字段。javascript 代码如下所示：

```
var msiOpenDatabaseModeTransact = 1;
var filespec = WScript.Arguments(0);
var installer = new ActiveXObject("WindowsInstaller.Installer");
var database = installer.OpenDatabase(filespec, msiOpenDatabaseModeTransact);
var sql = "UPDATE `Control` SET `Control`.`Height` = '18', `Control`.`Width` = '170'," +
          " `Control`.`Y`='243', `Control`.`X`='10' " +
          "WHERE `Control`.`Dialog_`='ExitDialog' AND " + 
          "  `Control`.`Control`='OptionalCheckBox'";
var view = database.OpenView(sql);
view.Execute();
view.Close();
database.Commit(); 
```

* * *

在生成 MSI 后（从 light.exe）将此代码作为命令行脚本（使用 cscript.exe）运行将产生一个看起来更专业的 ExitDialog：

[替代文字 http://www.dizzymonkeydesign.com/blog/misc/adding-and-customizing-dlgs-in-wix-3/images/exit_dlg_2.gif](http://www.dizzymonkeydesign.com/blog/misc/adding-and-customizing-dlgs-in-wix-3/images/exit_dlg_2.gif)

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2009-02-23T16:42:59.840

## 使用相同的源文件创建 Live、Test、Training 等版本。

简而言之：为每个安装程序创建唯一的 UpgradeCode，并自动为每个安装程序定义每个 Guid 的第一个字符，剩下的 31 个是唯一的。

### 先决条件

*   [MSBuild 社区任务](http://msbuildtasks.tigris.org/)

### 假设

*   WiX 变量用于定义 UpgradeCode、ProductName、InstallName。
*   您已经有一个工作安装程序。在你这样做之前，我不会尝试这个。
*   您的所有组件都保存在一个文件中（Components.wxs）。如果您有多个文件，此过程将起作用，只是需要做更多的工作。

### 目录结构

*   **安装程序库**
    *   所有 wxs 文件（组件、功能、UI 对话框……）
    *   Common.Config.wxi (ProductCode="*", ProductVersion, PlatformProgramFilesFolder, ...)
*   **Setup.Live** (wixproj)
    *   使用“添加现有文件”->“添加为链接”链接所有 Setup.Library 文件（Visual Studio 中“添加”按钮旁边的小向下箭头按钮）
    *   Config.wxi（具有唯一的 UpgradeCode、ProductName、InstallName，...）
*   **设置.测试**，...
    *   根据现场情况，但为测试环境配置了 Config.wxi。

### 过程

*   创建 Setup.Library 目录并从现有项目中移动所有 wxs 和 wxi 文件（Config.wxi 除外）。
*   按照普通的 wixproj 创建 Setup.Live、Setup.Test 等。
*   在 Setup.Live 等中的 wixproj 中添加 BeforeBuild 目标以执行 MSBuild 社区任务*FileUpdate*以修改 Guid（我使用 A 表示 Live，B 表示测试，C 表示训练）
*   添加 AfterBuild 目标以将 Components.wxs Guids 恢复为 0。
*   与 Orca 确认每个 MSI 中的每个组件都具有修改后的 guid。
*   验证原始指南是否已恢复。
*   验证每个 MSI 是否安装（和升级）正确的产品和位置。

**示例 Config.wxi**

```
<?xml version="1.0" encoding="utf-8"?>
<Include>
<!-- Upgrade code should not change unless you want to install 
     a new product and have the old product remain installed, 
     that is, both products existing as separate instances. -->
<?define UpgradeCode = "YOUR-GUID-HERE" ?>

<!-- Platform specific variables -->
<?if $(var.Platform) = x64 ?>
  <!-- Product name as you want it to appear in Add/Remove Programs-->
  <?define ProductName = "Foo 64 Bit [Live]" ?>
<?else ?>
  <?define ProductName =  "Foo [Live]" ?>
<?endif ?>

<!-- Directory name used as default installation location -->
<?define InstallName = "Foo [Live]" ?>

<!-- Registry key name used to store installation location -->
<?define InstallNameKey = "FooLive" ?>

<?define VDirName = "FooLive" ?>
<?define AppPoolName = "FooLiveAppPool" ?>
<?define DbName = "BlahBlahLive" ?>
</Include> 
```

**示例 Config.Common.wxi**

```
<?xml version="1.0" encoding="utf-8"?>
<Include>
<!-- Auto-generate ProductCode for each build, release and upgrade -->
<?define ProductCode = "*" ?>

<!-- Note that 4th version (Revision) is ignored by Windows Installer -->
<?define ProductVersion = "1.0.0.0" ?>

<!-- Minimum version supported if product already installed and this is an upgrade -->
<!-- Note that 4th version (Revision) is ignored by Windows Installer -->
<?define MinimumUpgradeVersion = "0.0.0.0" ?>

<!-- Platform specific variables -->
<?if $(var.Platform) = x64 ?>
   <?define Win64 = "yes" ?>
   <?define PlatformProgramFilesFolder = "ProgramFiles64Folder" ?>
<?else ?>
   <?define Win64 = "no" ?>
   <?define PlatformProgramFilesFolder = "ProgramFilesFolder" ?>
<?endif ?>

<?define ProductManufacturer = "Foo Technologies"?>

<!-- Decimal Language ID (LCID) for the Product. Used for localization. -->
<?define ProductLanguage = "1033" ?>

<?define WebSiteName = "DefaultWebSite" ?>
<?define WebSitePort = "80" ?>

<?define DbServer = "(local)" ?>
</Include> 
```

**示例组件.wxs**

```
<?xml version="1.0" encoding="utf-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <!-- The pre-processor variable which allows the magic to happen :) -->
  <?include $(sys.CURRENTDIR)\Config.wxi?>
  <?include ..\Setup.Library\Config.Common.wxi?>
  <Fragment Id="ComponentsFragment">
    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="$(var.PlatformProgramFilesFolder)">
        <Directory Id="INSTALLLOCATION" Name="$(var.InstallName)">
          <Component Id="ProductComponent" Guid="0XXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX" KeyPath="yes">
          ... 
```

注意：我现在建议将 Guid 属性排除在 Component 之外（相当于`*`），每个组件使用一个文件并将该文件设置为 keypath。这消除了对调用`ModifyComponentsGuids`和`RevertComponentsGuids`目标的需要，如下所示。不过，这可能不适用于您的所有组件。

**示例 Setup.Live.wixproj**

```
<Import Project="$(MSBuildExtensionsPath)\MSBuildCommunityTasks\MSBuild.Community.Tasks.Targets" />
<Target Name="BeforeBuild">
  <CallTarget Targets="ModifyComponentsGuids" />
</Target>
<Target Name="AfterBuild">
  <CallTarget Targets="RevertComponentsGuids" />
</Target>
<!-- Modify the first character of every Guid to create unique value for Live, Test and Training builds -->
<Target Name="ModifyComponentsGuids">
  <FileUpdate Files="..\Setup.Library\Components.wxs" Regex="Guid=&quot;([a-f]|[A-F]|\d)" ReplacementText="Guid=&quot;A" />
</Target>
<!-- Revert the first character of every Guid back to initial value -->
<Target Name="RevertComponentsGuids">
  <FileUpdate Files="..\Setup.Library\Components.wxs" Regex="Guid=&quot;([a-f]|[A-F]|\d)" ReplacementText="Guid=&quot;0" />
</Target> 
```

**最后的想法**

*   此过程也适用于为同一安装程序的不同合并模块（实时、测试、...作为功能）创建不同的安装程序。我选择了不同的安装程序，因为这似乎是一个更安全的选择，如果他们在同一个盒子上并且你只是使用不同合并模块的功能，那么有人可能会升级 Live 而不是 Training 的风险更大。
*   如果您使用您的 MSI 执行升级以及新安装，即仅主要升级的方法，并且您将安装位置保存在注册表中，请记住为每次安装的键名创建一个变量。
*   我们还在每个 Config.wxi 中创建变量，以便为每个安装程序启用唯一的虚拟目录名称、应用程序池、数据库名称等。

**更新 1：** [自动生成组件 Guids](http://n2.nabble.com/Multipe-products-tt2449390.html#a2452738)无需调用 FileUpdate 任务，如果您为每个文件创建带有 Guid="*" 的组件，并将文件设置为 keypath。

~~**更新 2：**我们遇到的问题之一是，如果您不自动生成组件 Guid 并且构建失败，则需要手动删除临时文件。~~

**更新 3：**找到了一种方法来消除对 svn:externals 和临时文件创建的依赖。这使构建过程更具弹性（如果您不能通配您的 Guid，这是最好的选择），并且如果在光线或蜡烛中出现构建失败，则不那么脆弱。

**更新 4：**在 WiX 3.0+ 中支持使用实例转换的[多个实例](https://stackoverflow.com/questions/499728/how-to-create-where-to-get-wix-bootstrapper-for-multiple-instances)，绝对值得一看。

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2009-11-26T04:28:03.607

**使用 Javascript CustomActions，因为它们非常简单**

人们说[MSI CustomActions 使用 Javascript 是错误的](http://blogs.msdn.com/robmen/archive/2004/05/20/136530.aspx)。给出的原因：难以调试，难以使其可靠。我不同意。调试并不难，当然不比 C++ 难。它只是不同。我发现用 Javascript 编写 CustomAction 超级简单，比使用 C++ 容易得多。快多了。同样可靠。

只有一个缺点：Javascript CustomAction 可以通过 Orca 提取，而 C/C++ CA 则需要逆向工程。如果您认为您的安装程序魔法是受保护的知识产权，您将希望避免使用脚本。

如果你使用脚本，你只需要从一些结构开始。这里有一些可以帮助您入门。

* * *

CustomAction 的 Javascript“样板”代码：

```
//
// CustomActions.js 
// 
// Template for WIX Custom Actions written in Javascript.
// 
// 
// Mon, 23 Nov 2009  10:54
// 
// ===================================================================

// http://msdn.microsoft.com/en-us/library/sfw6660x(VS.85).aspx
var Buttons = {
        OkOnly           : 0,
        OkCancel         : 1,
        AbortRetryIgnore : 2,
        YesNoCancel      : 3
};

var Icons = {
        Critical         : 16,
        Question         : 32,
        Exclamation      : 48,
        Information      : 64
};

var MsgKind = {
        Error            : 0x01000000,
        Warning          : 0x02000000,
        User             : 0x03000000,
        Log              : 0x04000000
};

// http://msdn.microsoft.com/en-us/library/aa371254(VS.85).aspx
var MsiActionStatus = {
        None             : 0,
        Ok               : 1, // success
        Cancel           : 2,
        Abort            : 3,
        Retry            : 4, // aka suspend?
        Ignore           : 5  // skip remaining actions; this is not an error.
};

function MyCustomActionInJavascript_CA() {
    try {
        LogMessage("Hello from MyCustomActionInJavascript");
        // ...do work here...
        LogMessage("Goodbye from MyCustomActionInJavascript");
    }
    catch (exc1) {
        Session.Property("CA_EXCEPTION") = exc1.message ;
        LogException(exc1);
        return MsiActionStatus.Abort;
    }
    return MsiActionStatus.Ok;
}

// Pop a message box.  also spool a message into the MSI log, if it is enabled. 
function LogException(exc) {
    var record = Session.Installer.CreateRecord(0);
    record.StringData(0) = "CustomAction: Exception: 0x" + decimalToHexString(exc.number) + " : " + exc.message;
    Session.Message(MsgKind.Error + Icons.Critical + Buttons.btnOkOnly, record);
}

// spool an informational message into the MSI log, if it is enabled. 
function LogMessage(msg) {
    var record = Session.Installer.CreateRecord(0);
    record.StringData(0) = "CustomAction:: " + msg;
    Session.Message(MsgKind.Log, record);
}

// http://msdn.microsoft.com/en-us/library/d5fk67ky(VS.85).aspx
var WindowStyle = {
    Hidden : 0,
    Minimized : 1,
    Maximized : 2
};

// http://msdn.microsoft.com/en-us/library/314cz14s(v=VS.85).aspx
var OpenMode = {
    ForReading : 1,
    ForWriting : 2,
    ForAppending : 8
};

// http://msdn.microsoft.com/en-us/library/a72y2t1c(v=VS.85).aspx
var SpecialFolders = {
    WindowsFolder : 0, 
    SystemFolder :  1, 
    TemporaryFolder : 2
};

// Run a command via cmd.exe from within the MSI
function RunCmd(command)
{
    var wshell = new ActiveXObject("WScript.Shell");
    var fso = new ActiveXObject("Scripting.FileSystemObject");
    var tmpdir = fso.GetSpecialFolder(SpecialFolders.TemporaryFolder);
    var tmpFileName = fso.BuildPath(tmpdir, fso.GetTempName());

    LogMessage("shell.Run("+command+")");

    // use cmd.exe to redirect the output
    var rc = wshell.Run("%comspec% /c " + command + "> " + tmpFileName, WindowStyle.Hidden, true);
    LogMessage("shell.Run rc = "  + rc);

    // here, optionally parse the output of the command 
    if (parseOutput) {
        var textStream = fso.OpenTextFile(tmpFileName, OpenMode.ForReading);
        while (!textStream.AtEndOfStream) {
            var oneLine = textStream.ReadLine();
            var line = ParseOneLine(oneLine);
                ...
        }
        textStream.Close();
    }

    if (deleteOutput) {
        fso.DeleteFile(tmpFileName);
    }

    return {
        rc : rc,
        outputfile : (deleteOutput) ? null : tmpFileName
    };
} 
```

* * *

然后，使用以下内容注册自定义操作：

```
<Fragment>
  <Binary Id="IisScript_CA" SourceFile="CustomActions.js" />

  <CustomAction Id="CA.MyCustomAction"
              BinaryKey="IisScript_CA"
              JScriptCall="MyCustomActionInJavascript_CA"
              Execute="immediate"
              Return="check" />
</Fragmemt> 
```

* * *

当然，您可以为多个自定义操作插入任意数量的 Javascript 函数。一个例子：我使用 Javascript 在 IIS 上执行 WMI 查询，以获取现有网站的列表，可以在其中安装 ISAPI 过滤器。该列表随后用于填充稍后在 UI 序列中显示的列表框。一切都很容易。

在 IIS7 上，没有用于 IIS 的 WMI 提供程序，因此我使用`shell.Run()`调用 appcmd.exe 的方法来执行工作。简单的。

相关问题：[关于 Javascript CustomActions](https://stackoverflow.com/questions/1785013)

* * *

## 回答 #8

> 赞同：17
> 
> 时间：2010-06-03T14:22:39.827

**使用 Msi 诊断日志记录获取详细的故障信息**

`msiexec /i Package.msi /l*v c:\Package.log`

在哪里

```
包.msi
```

是您的包裹的名称，并且

```
c:\Package.log
```

是你想要输出日志的地方

[Msi 错误代码](http://msdn.microsoft.com/en-us/library/aa368542(VS.85).aspx)

**Wix 介绍视频**
[哦和以“WiX 先生”Rob Mensching 为特色的随机 Wix 介绍视频对“概念性大图”很有帮助。](http://channel9.msdn.com/posts/scobleizer/Wix-team-The-most-used-piece-of-software-at-Microsoft-and-its-open-source/#Page=2)

* * *

## 回答 #9

> 赞同：12
> 
> 时间：2009-02-26T20:01:28.653

Peter Tate 已经展示了如何在单独的 wix 片段中定义可重用的 ComponentGroup 定义。与此相关的一些额外技巧：

**目录别名**

组件组片段不需要知道主产品 wxs 定义的目录。在您的组件组片段中，您可以谈论这样的文件夹：

```
<DirectoryRef Id="component1InstallFolder">
...
</DirectoryRef> 
```

然后主产品可以为其目录之一（例如“productInstallFolder”）设置别名，如下所示：

```
<Directory Id="productInstallFolder" Name="ProductName">
   <!-- not subfolders (because no Name attribute) but aliases for parent! -->
   <Directory Id="component1InstallFolder"/> 
   <Directory Id="component2InstallFolder"/> 
</Directory> 
```

**依赖图**

ComponentGroup 元素可以包含 ComponentGroupRef 子元素。如果您有大量可重用组件，并且它们之间存在复杂的依赖关系图，这将非常棒。您只需在其自己的片段中为每个组件设置一个 ComponentGroup 并声明依赖项，如下所示：

```
<ComponentGroup Id="B">
   <ComponentRef Id="_B" />
   <ComponentGroupRef Id="A">
</ComponentGroup> 
```

如果您现在在设置中引用组件组“B”，因为它是应用程序的直接依赖项，即使应用程序作者从未意识到它是“B”的依赖项，它也会自动拉入组件组“A”。只要您没有任何循环依赖项，它就“正常工作”。

**可重用的wixlib**

如果您使用 lit.exe 将 big-pool-o-reusable-components 编译成可重用的 wixlib，则上述依赖关系图的想法效果最好。创建应用程序设置时，您可以像 wixobj 文件一样引用此 wixlib。Candle.exe 链接器将自动消除任何未被主产品 wxs 文件“拉入”的片段。

* * *

## 回答 #10

> 赞同：12
> 
> 时间：2010-06-03T14:19:35.873

**使用 Heat.exe 砸脸并在痛苦的大型安装中造成“史诗般的 Pwnage”**

扩展[Si](https://stackoverflow.com/users/44540/si)和 [Robert-P](https://stackoverflow.com/users/18097/robert-p)关于热量的答案。

翻译：（使用 heat 来避免手动将单个文件输入到项目中，并自动构建以使整个过程更容易。）

[WiX 2.0 Heat 语法详细](http://wix.sourceforge.net/manual-wix3/heat.htm)

对于较新的版本（与旧版本没有什么不同，但可能存在令人讨厌的语法更改......）从 cmd.exe 转到 Heat 所在的目录，然后输入 heat 但我在这里有一个示例以寻求帮助如果需要，使用更新的版本。

在Visual Studio 2010中将以下内容添加到您的构建事件中。
（右键单击项目->属性->构建事件->预构建事件）

`$(WIX)bin\heat.exe" dir "$(EnviromentVariable)" -cg GroupVariable -gg -scom -sreg -sfrag - srd -dr INSTALLLOCATION -var env.LogicPath -out "$(FragmentDir)\FileName.wxs`

```
-gg
```

运行加热时生成 Guid（如执行上述命令时）

```
-scom
```

不要抓取“COM文件”

```
-sreg
```

不要抢“注册表文件”

```
-sfrag
```

不要抢“碎片”

```
-srd
```

不要抓住“根目录”

```
目录
```

dir 表示您希望 Heat 在文件夹中查找

```
“$（环境变量）”
```

您将添加到（右键单击项目，转到属性）项目属性->构建部分中的预处理器变量的变量的名称，其中显示定义预处理器变量（假设 Visual Studio 2010）

```
例子：
环境变量=C:\Project\bin\Debug；
```

没有双引号，但以分号结尾

```
-cg 组变量
```

将从创建到主 wxs 文件的片段中引用的 ComponentGroup

```
片段目录
```

将存储输出 wxs 片段的片段目录

```
文件名.wxs
```

文件名

完整教程在这里，非常有帮助

[第 1](http://weblogs.sqlteam.com/mladenp/archive/2010/02/11/WiX-3-Tutorial-SolutionProject-structure-and-Dev-resources.aspx) [部分 第 2 部分](http://weblogs.sqlteam.com/mladenp/archive/2010/02/23/WiX-3-Tutorial-Generating-filedirectory-fragments-with-Heat.exe.aspx)

* * *

## 回答 #11

> 赞同：12
> 
> 时间：2009-12-14T21:11:42.517

我很惊讶没有人提到在构建过程中使用 T4 生成 WXS 文件。[我通过 Henry Lee @New Age Solutions](http://blog.newagesolution.net/2008/06/how-to-use-msbuild-and-wix-to-msi.html)了解了这一点。

本质上，您创建了一个自定义 MSBuild 任务来执行 T4 模板，并且该模板在 Wix 项目编译之前输出 WXS。这允许您（取决于您如何实现它）自动包含编译另一个解决方案的所有程序集输出（这意味着您不再需要在每次添加新程序集时编辑 wxs）。

* * *

## 回答 #12

> 赞同：9
> 
> 时间：2009-03-05T22:54:48.850

**Including COM Objects:**

`heat` generates all most (if not all) the registry entries and other configuration needed for them. Rejoice!

**Including Managed COM Objects (aka, .NET or C# COM objects)**

Using `heat` on a managed COM object will give you an almost complete wix document.

If you don't need the library available in the GAC (ie, globally available: MOST of the time you do not need this with your .NET assemblies anyway - you've probably done something wrong at this point if it's not intended to be a shared library) you will want to make sure to update the `CodeBase` registry key to be set to `[#ComponentName]`. If you ARE planning on installing it to the GAC (eg, you've made some new awesome common library that everyone will want to use) you must remove this entry, and add two new attributes to the `File` element: `Assembly` and `KeyPath`. Assembly should be set to ".net" and `KeyPath` should be set to "yes".

However, some environments (especially anything with managed memory such as scripting languages) will need access to the Typelib as well. [Make sure to run `heat` on your typelib](http://www.wixwiki.com/index.php?title=Heat) and include it. `heat` will generate all the needed registry keys. How cool is that?

* * *

## 回答 #13

> 赞同：8
> 
> 时间：2010-08-18T12:38:53.607

**安装到`C:\ProductName`**

一些应用程序需要安装到`C:\ProductName`或类似的东西，但网络中 99.9%（如果不是 100%）的示例安装到`C:\Program Files\CompanyName\ProductName`.

以下代码可用于将`TARGETDIR`属性设置为驱动器的根目录`C:`（取自[WiX-users list](http://www.mail-archive.com/wix-users@lists.sourceforge.net/msg07900.html)）：

```
<CustomAction Id="AssignTargetDir" Property="TARGETDIR" Value="C:\" Execute="firstSequence" />
<InstallUISequence>
    <Custom Action="AssignTargetDir" Before="CostInitialize">TARGETDIR=""</Custom>
</InstallUISequence>
<InstallExecuteSequence>
    <Custom Action="AssignTargetDir" Before="CostInitialize">TARGETDIR=""</Custom>
</InstallExecuteSequence> 
```

**注意：**默认情况下，`TARGETDIR` *不*指向`C:\`! 而是指向`ROOTDRIVE`which 又指向*具有最多可用空间的驱动器的根目录*（[请参见此处](http://www.mail-archive.com/wix-users@lists.sourceforge.net/msg06706.html)） - 这不一定是`C:`驱动器。可能有另一个硬盘驱动器、分区或 USB 驱动器！

然后，在您的标签下方的某处`<Product ...>`，您像往常一样需要以下目录标签：

```
<Directory Id="TARGETDIR" Name="SourceDir">
    <Directory Id="APPLICATIONFOLDER" Name="$(var.ProductName)">
        <!-- your content goes here... -->
    </Directory>
</Directory> 
```

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2011-05-13T07:48:06.273

**编辑对话框**

编辑对话框的一项很好的功能是在 4.0.1.7090（或更高版本）中使用 SharpDevelop。借助此工具，可以在设计视图中打开、预览和编辑独立对话框（来自 WiX 源的 wxs 文件，例如 InstallDirDlg.wxs）。

* * *

## 回答 #15

> 赞同：7
> 
> 时间：2009-04-09T23:47:57.790

**环境变量**

在将你的 Wxs 文件编译成 wixobj 代码时，你可以利用环境变量来确定各种信息。例如，假设您想更改项目中包含的文件。假设您有一个名为 RELEASE_MODE 的环境变量，您在构建 MSI 之前设置了它（使用脚本或手动，没关系）在您的 wix 源中，您可以执行以下操作：

```
<define FILESOURCE = c:\source\output\bin\$(env.RELEASE_MODE) > 
```

然后稍后在您的代码中，使用它来即时更改您的 wxs 文档，例如：

```
<Icon Id="myicon.ico" SourceFile="$(var.FILESOURCE)" /> 
```

* * *

## 回答 #16

> 赞同：7
> 
> 时间：2010-11-15T21:25:48.333

使用 RobM 特殊的**“记住属性”**模式

[http://robmensching.com/blog/posts/2010/5/2/The-WiX-toolsets-Remember-Property-pattern](http://robmensching.com/blog/posts/2010/5/2/The-WiX-toolsets-Remember-Property-pattern)

* * *

## 回答 #17

> 赞同：7
> 
> 时间：2010-12-02T11:58:50.753

为使用托管代码 (C#) 编写的 WIX 创建自定义操作，无需 Votive

[http://www.codeproject.com/KB/install/wixcustomaction.aspx](http://www.codeproject.com/KB/install/wixcustomaction.aspx)

* * *

## 回答 #18

> 赞同：6
> 
> 时间：2011-07-08T00:21:28.753

设置 IIS enable32BitAppOnWin64 标志[http://trycatchfail.com/blog/post/WiX-Snippet-change-enable32BitAppOnWin64.aspx](http://trycatchfail.com/blog/post/WiX-Snippet-change-enable32BitAppOnWin64.aspx)

```
<InstallExecuteSequence>
   <RemoveExistingProducts After="InstallFinalize" />
   <Custom Action="ConfigureAppPool" After="InstallFinalize" >
     <![CDATA[NOT Installed AND VersionNT64 >= 600]]>         
   </Custom>
</InstallExecuteSequence>

<CustomAction Id="ConfigureAppPool" Return="check" Directory="TARGETDIR" ExeCommand="[SystemFolder]inetsrv\appcmd set apppool /apppool.name:[APPPOOLNAME] /enable32BitAppOnWin64:false" /> 
```

* * *

## 回答 #19

> 赞同：5
> 
> 时间：2009-01-23T14:41:35.187

*   我们在 GUI 的第一个屏幕中的某处（微小）显示产品版本。因为人们在每次选择正确的版本时都会犯错误。（并让我们的开发人员搜索年龄......）

*   我们设置了 TFSBuild 以生成转换（.mst 文件），并为我们的不同环境配置配置。（我们知道我们需要部署到的所有环境）。

由于格兰特霍利迪的原始博客文章已关闭，我将其内容复制粘贴在这里：

* * *

用于从 XML 生成 MSI 转换文件的 MSBuild 任务 2008 年 3 月 11 日

在我之前的文章中，我描述了如何使用 MSI 转换 (*.mst) 文件将特定于环境的配置设置与通用 MSI 包分开。

尽管这为您的配置提供了一定程度的灵活性，但转换文件有两个缺点：

1.  它们是二进制格式
2.  您不能“编辑”或“查看”转换文件。您必须应用它或重新创建它以查看它包含哪些更改。

幸运的是，我们可以使用 Microsoft Windows Installer 对象库 (c:windowssystem32msi.dll) 打开 MSI“数据库”并创建转换文件。

再次感谢[Alex Shevchuk - 从 MSI 到 WiX - 第 7 部分](http://blogs.technet.com/b/alexshev/archive/2008/02/15/from-msi-to-wix-part-7-customizing-installation-using-transforms.aspx)- 使用转换自定义安装，向我们展示了如何使用 VbScript 实现这一目标。基本上我所做的一切都是以 Alex 的例子，并使用 Interop.WindowsInstaller.dll 我实现了一个 MSBuild 任务。MSBuild 任务

[在此处下载](http://cid-5138246aadded1c2.skydrive.live.com/self.aspx/Public/Website/GenerateMsiTransform.Source.zip "下载")源代码和示例 transforms.xml（~7Kb 压缩 VS2008 解决方案）

* * *

* * *

## 回答 #20

> 赞同：5
> 
> 时间：2009-11-26T03:55:53.640

**Modify the "Ready to install?" dialog (aka VerifyReadyDlg) to provide a summary of choices made.**

It looks like this:
[alt text http://i46.tinypic.com/s4th7t.jpg](http://i46.tinypic.com/s4th7t.jpg)

Do this with a Javascript CustomAction:

* * *

Javascript code:

```
// http://msdn.microsoft.com/en-us/library/aa372516(VS.85).aspx
var MsiViewModify = 
    {
        Refresh          : 0,
        Insert           : 1,
        Update           : 2,
        Assign           : 3,
        Replace          : 4,
        Merge            : 5,
        Delete           : 6,
        InsertTemporary  : 7,   // cannot permanently modify the MSI during install
        Validate         : 8,
        ValidateNew      : 9,
        ValidateField    : 10,
        ValidateDelete   : 11
    };

// http://msdn.microsoft.com/en-us/library/sfw6660x(VS.85).aspx
var Buttons = 
    {
        OkOnly           : 0,
        OkCancel         : 1,
        AbortRetryIgnore : 2,
        YesNoCancel      : 3
    };

var Icons= 
    {
        Critical         : 16,
        Question         : 32,
        Exclamation      : 48,
        Information      : 64
    }

var MsgKind =
    {
        Error            : 0x01000000,
        Warning          : 0x02000000,
        User             : 0x03000000,
        Log              : 0x04000000
    };

// http://msdn.microsoft.com/en-us/library/aa371254(VS.85).aspx
var MsiActionStatus = 
    {
        None             : 0,
        Ok               : 1, // success
        Cancel           : 2,
        Abort            : 3,
        Retry            : 4, // aka suspend?
        Ignore           : 5  // skip remaining actions; this is not an error.
    };

function UpdateReadyDialog_CA(sitename)
{
    try 
    {
        // can retrieve properties from the install session like this:
        var selectedWebSiteId = Session.Property("MSI_PROPERTY_HERE");

        // can retrieve requested feature install state like this:
        var fInstallRequested   = Session.FeatureRequestState("F.FeatureName");

        var text1 = "This is line 1 of text in the VerifyReadyDlg";

        var text2 = "This is the second line of custom text";

        var controlView     = Session.Database.OpenView("SELECT * FROM Control");
        controlView.Execute();

        var rec             = Session.Installer.CreateRecord(12);
        rec.StringData(1)   = "VerifyReadyDlg";    // Dialog_
        rec.StringData(2)   = "CustomVerifyText1"; // Control - can be any name
        rec.StringData(3)   = "Text";              // Type
        rec.IntegerData(4)  = 25;                  // X
        rec.IntegerData(5)  = 60;                  // Y
        rec.IntegerData(6)  = 320;                 // Width
        rec.IntegerData(7)  = 85;                  // Height
        rec.IntegerData(8)  = 2;                   // Attributes
        rec.StringData(9)   = "";                  // Property
        rec.StringData(10)  = vText1;              // Text
        rec.StringData(11)  = "";                  // Control_Next
        rec.StringData(12)  = "";                  // Help
        controlView.Modify(MsiViewModify.InsertTemporary, rec);

        rec                 = Session.Installer.CreateRecord(12);
        rec.StringData(1)   = "VerifyReadyDlg";    // Dialog_
        rec.StringData(2)   = "CustomVerifyText2"; // Control - any unique name
        rec.StringData(3)   = "Text";              // Type
        rec.IntegerData(4)  = 25;                  // X
        rec.IntegerData(5)  = 160;                 // Y
        rec.IntegerData(6)  = 320;                 // Width
        rec.IntegerData(7)  = 65;                  // Height
        rec.IntegerData(8)  = 2;                   // Attributes
        rec.StringData(9)   = "";                  // Property
        rec.StringData(10)  = text2;               // Text
        rec.StringData(11)  = "";                  // Control_Next
        rec.StringData(12)  = "";                  // Help
        controlView.Modify(MsiViewModify.InsertTemporary, rec);

        controlView.Close();
    }
    catch (exc1)
    {
        Session.Property("CA_EXCEPTION") = exc1.message ;
        LogException("UpdatePropsWithSelectedWebSite", exc1);
        return MsiActionStatus.Abort;
    }
    return MsiActionStatus.Ok;
}

function LogException(loc, exc)
{
    var record = Session.Installer.CreateRecord(0);
    record.StringData(0) = "Exception {" + loc + "}: " + exc.number + " : " + exc.message;
    Session.Message(MsgKind.Error + Icons.Critical + Buttons.btnOkOnly, record);
} 
```

* * *

Declare the Javascript CA:

```
<Fragment>
  <Binary Id="IisScript_CA" SourceFile="CustomActions.js" />

  <CustomAction Id="CA.UpdateReadyDialog"
              BinaryKey="IisScript_CA"
              JScriptCall="UpdateReadyDialog_CA"
              Execute="immediate"
              Return="check" />
</Fragment> 
```

* * *

Attach the CA to a button. In this example, the CA is fired when Next is clicked from the CustomizeDlg:

```
<UI ...>
  <Publish Dialog="CustomizeDlg" Control="Next" Event="DoAction" 
           Value="CA.UpdateReadyDialog" Order="1"/>
</UI> 
```

* * *

Related SO Question: [How can I set, at runtime, the text to be displayed in VerifyReadyDlg?](https://stackoverflow.com/questions/1791041)

* * *

## 回答 #21

> 赞同：5
> 
> 时间：2010-06-25T18:36:02.677

**将可以单独修补的组件放在自己的片段中**

它适用于制作产品安装程序和补丁，如果您在片段中包含任何组件，则必须在该片段中包含*所有*组件。在构建安装程序的情况下，如果您错过任何组件引用，您将收到来自 light.exe 的链接错误。但是，当您制作补丁时，如果您在片段中包含单个组件引用，则该片段中*所有*更改的组件都将显示在您的补丁中。

像这样：

```
<Fragment>
    <DirectoryRef Id="SampleProductFolder">
        <Component Id="SampleComponent1" Guid="{C28843DA-EF08-41CC-BA75-D2B99D8A1983}" DiskId="1">
            <File Id="SampleFile1" Source=".\$(var.Version)f\Sample1.txt" />
        </Component>
    </DirectoryRef>
</Fragment>

<Fragment>
    <DirectoryRef Id="SampleProductFolder">
        <Component Id="SampleComponent2" Guid="{6CEA5599-E7B0-4D65-93AA-0F2F64402B22}" DiskId="1">
           <File Id="SampleFile2" Source=".\$(var.Version)f\Sample2.txt" />
        </Component>
    </DirectoryRef>
</Fragment>

<Fragment>
    <DirectoryRef Id="SampleProductFolder">
        <Component Id="SampleComponent3" Guid="{4030BAC9-FAB3-426B-8D1E-DC1E2F72C2FC}" DiskId="1">
           <File Id="SampleFile3" Source=".\$(var.Version)f\Sample3.txt" />
        </Component>
    </DirectoryRef>
</Fragment> 
```

而不是这个：

```
<Fragment>
    <DirectoryRef Id="SampleProductFolder">
        <Component Id="SampleComponent1" Guid="{C28843DA-EF08-41CC-BA75-D2B99D8A1983}" DiskId="1">
            <File Id="SampleFile1" Source=".\$(var.Version)\Sample1.txt" />
        </Component>

        <Component Id="SampleComponent2" Guid="{6CEA5599-E7B0-4D65-93AA-0F2F64402B22}" DiskId="1">
           <File Id="SampleFile2" Source=".\$(var.Version)\Sample2.txt" />
        </Component>

        <Component Id="SampleComponent3" Guid="{4030BAC9-FAB3-426B-8D1E-DC1E2F72C2FC}" DiskId="1">
           <File Id="SampleFile3" Source=".\$(var.Version)\Sample3.txt" />
        </Component>
    </DirectoryRef>
</Fragment> 
```

此外，当使用 WiX.chm 帮助文件中的“使用 Purely WiX”主题进行修补时，使用以下过程生成修补程序：

```
torch.exe -p -xi 1.0\product.wixpdb 1.1\product.wixpdb -out patch\diff.wixmst
candle.exe patch.wxs
light.exe patch.wixobj -out patch\patch.wixmsp
pyro.exe patch\patch.wixmsp -out patch\patch.msp -t RTM patch\diff.wixmst 
```

仅使用单独片段中的组件构建 1.1 版本的 product.wixpdb 是不够的。因此，请务必在发货前正确分割您的产品。

* * *

## 回答 #22

> 赞同：5
> 
> 时间：2011-05-20T12:46:25.393

在部署安装包之前，我总是控制它的内容。

这只是在命令行中的一个简单调用（根据 Terrences 的帖子）打开命令行并输入

```
msiexec /a Package.msi /qb TARGETDIR="%CD%\Extract" /l*vx "%CD\install.log%" 
```

这会将包内容提取到具有当前路径的子目录“Extract”。

* * *

## 回答 #23

> 赞同：5
> 
> 时间：2010-11-02T15:11:34.413

## **从 Wix3.0 及更高版本打印 EULA**

1) 编译 wix 源代码时，light.exe 必须在命令行中引用 WixUIExtension.dll。为此，请使用命令行开关 -ext。

2) 如果当您添加对 WixUIExtension.dll 的引用时，您的项目无法编译，这很可能是因为对话框 ID 冲突，即您的项目使用的对话框 ID 与 WixUIExtension.dll 中的某些标准对话框相同，为您的对话框提供不同的 ID。这是一个很常见的问题。

3) 您的许可证对话框必须具有 ScrollableText 控件，其 id 为“LicenseText”。Wix 在打印时会准确搜索此控件名称。

```
<Control Id="LicenseText" Type="ScrollableText" X="20" Y="60" Width="330" Height="160" Sunken="yes" TabSkip="no">
    <Text SourceFile="License.rtf" />
</Control> 
```

和一个引用自定义操作的 PushButton

```
<Control Type="PushButton" Id="PrintButton" Width="57" Height="17" X="19" Y="244" Text="Print">
    <Publish Event="DoAction" Value="PrintEula">1</Publish>
</Control> 
```

4) 使用 Id="PrintEula" 定义 CustomAction，如下所示：

```
<CustomAction Id="PrintEula" BinaryKey="WixUIWixca" DllEntry="PrintEula" Return="ignore" Execute="immediate" /> 
```

注意：与 Wix2.0 相比，Wix3.0 中的 BinaryKey 不同，并且必须完全是“WixUIWixca”（区分大小写）。

当用户按下按钮时，他/她将看到标准的选择打印机对话框，并且能够从那里进行打印。

* * *

## 回答 #24

> 赞同：4
> 
> 时间：2011-07-19T23:58:19.347

## 为具有 x86/x64 兼容性的 COM 互操作注册 .NET 程序集

**NB 这个片段本质上与*REGASM Assembly.dll /codebase相同***

这个示例中发生了一些事情，所以这里是代码，我会在之后解释它......

```
 <Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <?include $(sys.CURRENTDIR)\Config.wxi?>
  <?if $(var.Win64) ?>
  <?define CLSIDRoots = "CLSID;Wow6432Node\CLSID"?>
  <?else ?>
  <?define CLSIDRoots = "CLSID"?>
  <?endif?>
  <!-- ASCOM Driver Assembly with related COM registrations -->
  <Fragment>
    <DirectoryRef Id="INSTALLLOCATION" />
  </Fragment>
  <Fragment>
    <ComponentGroup Id="cgAscomDriver">
      <Component Id="cmpAscomDriver" Directory="INSTALLLOCATION" Guid="{0267031F-991D-4D88-A748-00EC6604171E}">
        <File Id="filDriverAssembly" Source="$(var.TiGra.Astronomy.AWRDriveSystem.TargetPath)" KeyPath="yes" Vital="yes" Assembly=".net" AssemblyApplication="filDriverAssembly"  />
        <RegistryKey Root="HKCR" Key="$(var.DriverId)"  Action="createAndRemoveOnUninstall">
          <RegistryValue Type="string" Value="$(var.DriverTypeName)"/>
          <RegistryKey Key="CLSID">
            <RegistryValue Type="string" Value="$(var.DriverGuid)" />
          </RegistryKey>
        </RegistryKey>
        <?foreach CLSID in $(var.CLSIDRoots) ?>
        <RegistryKey Root="HKCR" Key="$(var.CLSID)" Action="none">
          <RegistryKey Key="$(var.DriverGuid)" Action="createAndRemoveOnUninstall">
            <RegistryValue Type="string" Value="$(var.DriverTypeName)"/>
            <RegistryKey Key="InprocServer32">
              <RegistryValue Type="string" Value="mscoree.dll" />
              <RegistryValue Type="string" Name="ThreadingModel" Value="Both"/>
              <RegistryValue Type="string" Name="Class" Value="$(var.DriverTypeName)"/>
              <RegistryValue Type="string" Name="Assembly" Value="!(bind.assemblyFullname.filDriverAssembly)" />
              <RegistryValue Type="string" Name="RuntimeVersion" Value="v2.0.50727"/>
              <RegistryValue Type="string" Name="CodeBase" Value="file:///[#filDriverAssembly]" />
              <RegistryKey Key="!(bind.fileVersion.filDriverAssembly)" >
                <RegistryValue Type="string" Name="Class" Value="$(var.DriverTypeName)"/>
                <RegistryValue Type="string" Name="Assembly" Value="!(bind.assemblyFullname.filDriverAssembly)" />
                <RegistryValue Type="string" Name="RuntimeVersion" Value="v2.0.50727"/>
                <RegistryValue Type="string" Name="CodeBase" Value="file:///[#filDriverAssembly]" />
              </RegistryKey>
            </RegistryKey>
            <RegistryKey Key="ProgId" Action="createAndRemoveOnUninstall">
              <RegistryValue Type="string" Value="$(var.DriverId)" />
            </RegistryKey>
            <RegistryKey Key="Implemented Categories" Action="createAndRemoveOnUninstall" >
              <RegistryKey Key="{62C8FE65-4EBB-45e7-B440-6E39B2CDBF29}" Action="createAndRemoveOnUninstall" />
            </RegistryKey>
          </RegistryKey>
        </RegistryKey>
        <?endforeach?>
      </Component>
    </ComponentGroup>
  </Fragment>
</Wix> 
```

如果您想知道，这实际上是针对[ASCOM Telescope Driver](http://ascom-standards.org/About/Index.htm)的。

首先，我听取了上面的建议，在一个单独的文件中创建了一些平台变量，您可以通过 XML 看到这些变量。

靠近顶部的 if-then-else 部分处理 x86 与 x64 的兼容性。我的程序集以 x64 系统上的“任何 CPU”为目标，我需要注册两次，一次在 64 位注册表中，一次在 32 位`Wow6432Node`区域中。if-then-else 为此设置了我，`foreach`稍后将在循环中使用这些值。这样，我只需编写一次注册表项（DRY 原则）。

file 元素指定正在安装和注册的实际程序集 dll：

```
<File Id="filDriverAssembly" Source="$(var.TiGra.Astronomy.AWRDriveSystem.TargetPath)" KeyPath="yes" Vital="yes" Assembly=".net" AssemblyApplication="filDriverAssembly"  /> 
```

没有什么革命性的，但请注意`Assembly=".net"`- 仅此属性会导致程序集被放入 GAC，这不是我想要的。使用`AssemblyApplication`属性指向自身只是阻止 Wix 将文件放入 GAC 的一种方法。现在，Wix 知道它是一个 .net 程序集，但它允许我在我的 XML 中使用某些绑定变量，例如`!(bind.assemblyFullname.filDriverAssembly)`获取程序集全名。

* * *

## 回答 #25

> 赞同：4
> 
> 时间：2011-05-20T12:32:48.620

[使用InstEd](http://www.instedit.com/)代替 ORCA ，它是查看 MSI 表的好工具。它还可以通过 Transform -> Compare To... 来区分两个包

此外，还提供具有附加功能的[Plus 版本。](http://www.instedit.com/instedplus.html)但免费版本也为 Orca 提供了一个很好的选择。

* * *

## 回答 #26

> 赞同：3
> 
> 时间：2011-06-16T23:20:48.287

设置该`DISABLEADVTSHORTCUTS`属性以强制安装程序中的所有广告快捷方式成为常规快捷方式，并且您不需要包含一个虚拟 reg 键来用作键路径。

```
<Property Id="DISABLEADVTSHORTCUTS" Value="1"/> 
```

我认为 Windows Installer 4.0 或更高版本是[必需](http://msdn.microsoft.com/en-us/library/aa368297%28v=vs.85%29.aspx)的。

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2009-03-23T19:14:57.117

[这是](https://stackoverflow.com/questions/668122/how-to-extract-data-file-count-from-msi-file-table)一种帮助大型 Web 项目验证已部署文件的数量是否与内置于 MSI（或合并模块）中的文件数量相匹配的方法。我刚刚针对我们的主应用程序（仍在开发中）运行了自定义 MSBuild 任务，它捡起了很多丢失的文件，主要是图像，但一些 javascript 文件已经溜走了！

这种方法（通过挂钩到 WiX 项目的 AfterBuild 目标来查看 MSI 的文件表）可以适用于您可以访问完整的预期文件列表的其他应用程序类型。

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2009-02-23T17:07:19.827

这是一个很好的结构，但根据我的经验，我想知道您如何解决这些条件：

A. 您的安装似乎都落在同一个目的地。如果用户需要一次安装所有 3 个版本，您的流程是否允许这样做。他们能清楚地告诉他们正在触发的每个可执行文件的哪个版本吗？

B. 您如何处理存在于 TEST 和/或 TRAINING 但尚未在 LIVE 中的新文件？

* * *

## 回答 #29

> 赞同：2
> 
> 时间：2011-06-22T00:17:52.810

创建一个具有自定义操作的 UI，该操作将设置一个变量，并且 UI 将根据自定义操作中设置的变量禁用/启用下一个按钮（或类似按钮）。

不像你想象的那么简单，也不是太难，只是没有在任何地方记录！

[Wix 与条件、属性和自定义操作的交互](https://stackoverflow.com/questions/4241863/wix-interactions-with-conditions-properties-custom-actions/6433364#6433364)

* * *

## 回答 #30

> 赞同：2
> 
> 时间：2010-06-03T14:29:45.287

**当安装不允许卸载或重新安装且不回滚时执行强制重新安装。**

VBscript 脚本用于覆盖因任何原因未卸载的安装..

```
Dim objShell
set objShell = wscript.createObject("wscript.shell")

iReturn = objShell.Run("CMD /K MsiExec.exe /I ""C:\Users\TheUser\Documents\Visual Studio 2010\Projects\InstallationTarget\HelloInstaller\bin\Debug\HelloInstaller.msi"" REINSTALLMODE=vomus REINSTALL=ALL",,True) 
```

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2009-11-26T04:05:05.430

**Fix the ProgressDlg so that it displays properly.**

I've increased the font size for my installer from 8 to 10, to make the font a more human, usable scale on high-res monitors. I do this with this XML magic:

```
<UI Id="MyCustomUI">
  <TextStyle Id="WixUI_Font_Normal" FaceName="Tahoma" Size="10" />
  <TextStyle Id="WixUI_Font_Big"    FaceName="Tahoma" Size="12" />
  <TextStyle Id="WixUI_Font_Bigger" FaceName="Tahoma" Size="14" />
  <TextStyle Id="WixUI_Font_Title"  FaceName="Tahoma" Size="12" Bold="yes" />

  <Property Id="DefaultUIFont" Value="WixUI_Font_Normal" />
</UI> 
```

But this means the ProgressDlg doesn't display properly any longer. This is the one that displays the progress of the install, right at the very end. The ActionText gets clipped, so descenders on letters like g and j do not display. Fix this by adjusting the size and position of the various controls on the Progressdialog, in a post-processing Javascript. Run this script after generating the MSI:

```
var msiOpenDatabaseModeTransact = 1;
var filespec = WScript.Arguments(0);
var installer = new ActiveXObject("WindowsInstaller.Installer");
var database = installer.OpenDatabase(filespec, msiOpenDatabaseModeTransact);

// The text on the exit dialog is too close to the title.  This 
// step moves the text down from Y=70 to Y=90, about one line. 
sql = "UPDATE `Control` SET `Control`.`Y` = '90' " +
    "WHERE `Control`.`Dialog_`='ExitDialog' AND `Control`.`Control`='Description'";
view = database.OpenView(sql);
view.Execute();
view.Close();

// The progressbar is too close to the status text on the Progress dialog. 
// This step moves the progressbar down from Y=115 to Y=118, about 1/3 line. 
sql = "UPDATE `Control` SET `Control`.`Y` = '118' " +
    "WHERE `Control`.`Dialog_`='ProgressDlg' AND `Control`.`Control`='ProgressBar'";
view = database.OpenView(sql);
view.Execute();
view.Close();

// The StatusLabel and ActionText controls are too short on the Progress dialog,
// which means the bottom of the text is cut off.  This step
// increases the height from 10 to 16.
sql = "UPDATE `Control` SET `Control`.`Height` = '16' " +
    "WHERE `Control`.`Dialog_`='ProgressDlg' AND `Control`.`Control`='StatusLabel'";
view = database.OpenView(sql);
view.Execute();
view.Close();
sql = "UPDATE `Control` SET `Control`.`Height` = '16' " +
    "WHERE `Control`.`Dialog_`='ProgressDlg' AND `Control`.`Control`='ActionText'";
view = database.OpenView(sql);
view.Execute();
view.Close();

database.Commit(); 
```

# c++ - 在哪种情况下使用特定的 STL 容器？

> ID：471432
> 
> 赞同：203
> 
> 时间：2009-01-23T00:31:33.577
> 
> 标签：c++, stl, container-data-type

在我的 C++ 书中，我一直在阅读有关 STL 容器的内容，特别是有关 STL 及其容器的部分。现在我确实了解它们中的每一个都有自己的特定属性，并且我已经快要记住所有这些属性了……但是我还没有掌握的是它们每个都在哪种情况下使用。

解释是什么？示例代码更受欢迎。

* * *

## 回答 #1

> 赞同：367
> 
> 时间：2009-01-23T00:42:40.840

[这份备忘单](https://web.archive.org/web/20180824133558/homepages.e3.net.nz/%7Edjm/cppcontainers.html)很好地总结了不同的容器。

请参阅底部的流程图作为在不同使用场景中使用的指南：

![http://linuxsoftware.co.nz/containerchoice.png](https://i.stack.imgur.com/kQnCS.png)

[由[David Moore](http://linuxsoftware.co.nz/)创建并[获得 CC BY-SA 3.0 许可](http://creativecommons.org/licenses/by-sa/3.0/nz/)]

* * *

## 回答 #2

> 赞同：208
> 
> 时间：2014-03-26T19:49:51.180

这是一个受我创建的 David Moore 版本（见上文）启发的流程图，它（大部分）与新标准 (C++11) 保持同步。这只是我个人的看法，不是无可争辩的，但我认为它可能对这次讨论很有价值：

![在此处输入图像描述](https://i.stack.imgur.com/G70oT.png)

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2009-01-23T16:35:27.923

简单的答案：`std::vector`用于一切，除非你有真正的理由不这样做。

当你发现一个你在想“哎呀，`std::vector`因为 X 在这里不好用”的案例时，请在 X 的基础上继续。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-01-23T01:21:11.980

看看 Scott Meyers 的 Effective STL。它擅长解释如何使用 STL。

如果您想存储已确定/未确定数量的对象并且您永远不会删除任何对象，那么您想要的是矢量。它是 C 数组的默认替代品，它的工作原理与一个类似，但不会溢出。您也可以使用 reserve() 预先设置其大小。

如果您想存储不确定数量的对象，但您将添加和删除它们，那么您可能需要一个列表...因为您可以在不移动任何后续元素的情况下删除一个元素 - 与向量不同。但是，它比向量需要更多的内存，并且您不能顺序访问一个元素。

如果您想获取一堆元素并仅找到这些元素的唯一值，则将它们全部读入一个集合中就可以了，它也会为您排序。

如果您有很多键值对，并且想按键对它们进行排序，那么映射很有用……但每个键只能保存一个值。如果每个键需要多个值，则可以将向量/列表作为映射中的值，或者使用多映射。

它不在 STL 中，但在 STL 的 TR1 更新中：如果您有很多键值对要通过键查找，并且您不关心它们的顺序，您可能想要使用哈希 - 即 tr1::unordered_map。我在 Visual C++ 7.1 中使用过它，它被称为 stdext::hash_map。它查找 O(1) 而不是查找地图的 O(log n)。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2018-11-15T15:04:12.200

我重新设计了流程图，使其具有 3 个属性：

1.  我认为 STL 容器分为 2 个主要类。基本容器和那些利用基本容器来实施策略的容器。
2.  首先，流程图应该将决策过程划分为我们应该决定的主要情况，然后对每个案例进行详细说明。
3.  一些扩展容器可以选择不同的基本容器作为它们的内容器。流程图应考虑可以使用每个基本容器的情况。

流程图：[![在此处输入图像描述](https://i.stack.imgur.com/9l8Qd.png)](https://i.stack.imgur.com/9l8Qd.png)

[此链接](https://medium.com/@ebrahim.bararian/c-stl-containers-selection-flowchart-d64230ccacfd)中提供的更多信息。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-12-01T17:44:14.897

到目前为止仅简要提及的重要一点是，如果您需要连续的内存（如 C 数组提供的），那么您只能使用`vector`、`array`或`string`.

`array`如果大小在编译时已知，则使用。

如果您只需要使用`string`字符类型并且需要一个字符串，而不仅仅是一个通用容器，请使用它。

`vector`在所有其他情况下使用（`vector`无论如何应该是大多数情况下容器的默认选择）。

通过所有这三个，您可以使用`data()`成员函数获取指向容器第一个元素的指针。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-23T00:59:35.067

这完全取决于您要存储的内容以及您要对容器执行的操作。以下是我最常使用的容器类的一些（非常非详尽的）示例：

`vector`：紧凑的布局，每个包含的对象几乎没有内存开销。有效地迭代。追加、插入和擦除可能会很昂贵，特别是对于复杂对象。通过索引查找包含的对象很便宜，例如 myVector[10]。在 C 中使用数组的地方使用。在有很多简单对象（例如 int）的地方很好。`reserve()`在向容器中添加大量对象之前不要忘记使用。

`list`：每个包含的对象的内存开销很小。有效地迭代。追加、插入和擦除都很便宜。在 C 中使用链表的地方使用。

`set`（和`multiset`）：每个包含的对象的显着内存开销。使用您需要快速找出该容器是否包含给定对象或有效合并容器的地方。

`map`（和`multimap`）：每个包含的对象的显着内存开销。使用您想要存储键值对的位置并通过键快速查找值。

zdan 建议的[备忘单](http://linuxsoftware.co.nz/cppcontainers.html "备忘单")上的流程图​​提供了更详尽的指南。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-23T16:22:40.943

我学到的一个教训是：尝试将它包装在一个类中，因为在美好的一天改变容器类型会产生很大的惊喜。

```
class CollectionOfFoo {
    Collection<Foo*> foos;
    .. delegate methods specifically 
} 
```

它的前期成本并不高，并且当您想在有人对该结构执行 x 操作时中断时，可以节省调试时间。

为工作选择完美的数据结构：

每个数据结构都提供了一些操作，这些操作可能具有不同的时间复杂度：

O(1)、O(lg N)、O(N) 等。

您基本上必须做出最好的猜测，哪些操作将完成最多，并使用该操作为 O(1) 的数据结构。

很简单，不是吗（-：

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2018-12-19T19:46:23.993

我在另一个问题中回答了这个问题，该问题被标记为这个问题的重复。但我觉得参考一些关于选择标准容器的决定的好文章是很好的。

正如@David Thornley 回答的那样，如果没有其他特殊需求，std::vector 就是要走的路。这是 C++ 的创建者 Bjarne Stroustrup 在 2014 年的博客中给出的建议。

这是文章的链接 [https://isocpp.org/blog/2014/06/stroustrup-lists](https://isocpp.org/blog/2014/06/stroustrup-lists)

并引用那个，

> 而且，是的，我的建议是默认使用 std::vector。

在评论中，用户@NathanOliver 还提供了另一个不错的博客，其中有更具体的测量。[https://baptiste-wicht.com/posts/2012/12/cpp-benchmark-vector-list-deque.html](https://baptiste-wicht.com/posts/2012/12/cpp-benchmark-vector-list-deque.html)。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-07-16T19:17:22.773

我扩展了[Mikael Persson 的](https://stackoverflow.com/users/491645/mikael-persson)精彩流程图。我添加了一些容器类别、数组容器和一些注释。如果您想要自己的副本，[这里](https://docs.google.com/drawings/d/1c-qvy499kxaYXM70DM34rOnEBCzgQLopyNDEXdaK0eU/edit)是 Google 绘图。谢谢，Mikael 做基础工作！ [C++ 容器选择器](https://i.stack.imgur.com/fMhpu.png)

# c# - C#：如何从另一个线程访问主 UI 线程中的整数？

> ID：471434
> 
> 赞同：1
> 
> 时间：2009-01-23T00:32:18.990
> 
> 标签：c#, multithreading, integer

如何从异步回调函数的方法中访问主形式的整数（递增 nCount++）？

我知道对于方法，您必须检查是否需要调用，然后将预期方法作为委托调用 begininvoke，以避免非法线程操作，但是您如何从另一个线程执行简单的操作，例如 nCount++？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-23T00:33:39.283

```
Interlocked.Increment(ref variable); 
```

# vba - Excel 宏 - 逗号分隔的单元格到行

> ID：471435
> 
> 赞同：5
> 
> 时间：2009-01-23T00:32:41.593
> 
> 标签：vba, excel

我在excel中有以下数据：

```
a, b, c
d
e
f, g
h
i 
```

每一行，代表一行和一个单元格。

我想将其转换为：

```
a
b
c
d
e
f
g
h
i 
```

我正在使用以下宏，但我无法使用自动调整大小来进行插入，而不是覆盖单元格值。任何帮助表示赞赏。

```
 Sub SplitCells()

    Dim i As Long

    With Application

        .Calculation = xlCalculationManual

        .ScreenUpdating = False

    For i = 1 To Selection.Rows.Count

        Dim splitValues As Variant

        splitValues = split(Selection.Rows(i).Value, ",")

        Selection.Rows(i).Resize(UBound(splitValues) - LBound(splitValues) + 1).Value = Application.Transpose(splitValues)

    Next i

        .Calculation = xlCalculationAutomatic

        .ScreenUpdating = True

    End With

End Sub 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-23T01:39:11.087

此宏将从 A 列中获取您的数据并将其“提取”到 B 列。结果如下所示，请随意畏缩我的图形表示技巧 :-)

```
 <- A ->   <- B ->
1   a, b, c   a
2   d         b
3   e         c
4   f, g      d
5   h         e
6   i         f
7             g
8             h
9             i 
```

出于测试目的，我将其保留为非破坏性的，并且由于创建新列相对容易，因此填充它并删除 VBA 中的旧列。给读者的练习...

这是宏：

```
Option Explicit
Sub Macro1()
    Dim fromCol As String
    Dim toCol As String
    Dim fromRow As String
    Dim toRow As String
    Dim inVal As String
    Dim outVal As String
    Dim commaPos As Integer

    ' Copy from column A to column B.'
    fromCol = "A"
    toCol = "B"
    fromRow = "1"
    toRow = "1"

    ' Go until no more entries in column A.'
    inVal = Range(fromCol + fromRow).Value
    While inVal <> ""

        ' Go until all sub-entries used up.'
        While inVal <> ""
            Range(fromCol + fromRow).Select

            ' Extract each subentry.'
            commaPos = InStr(1, inVal, ",")
            While commaPos <> 0

                ' and write to output column.'
                outVal = Left(inVal, commaPos - 1)
                Range(toCol + toRow).Select
                Range(toCol + toRow).Value = outVal
                toRow = Mid(Str(Val(toRow) + 1), 2)

                ' Remove that sub-entry.'
                inVal = Mid(inVal, commaPos + 1)
                While Left(inVal, 1) = " "
                    inVal = Mid(inVal, 2)
                Wend
                commaPos = InStr(1, inVal, ",")
            Wend

            ' Get last sub-entry (or full entry if no commas).'
            Range(toCol + toRow).Select
            Range(toCol + toRow).Value = inVal
            toRow = Mid(Str(Val(toRow) + 1), 2)
            inVal = ""
        Wend

        ' Advance to next source row.'
        fromRow = Mid(Str(Val(fromRow) + 1), 2)
        Range(fromCol + fromRow).Select
        inVal = Range(fromCol + fromRow).Value
    Wend
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T00:36:55.207

这是未经测试的，但它是我多次使用的算法模式。不过已经有一段时间了，所以不要完全相信语法。

```
sub SplitCells()  
    Dim c as Range      ' iterator for cells in Selection  
    dim r as Range      ' to hold the range which is the first cell in Selection  
    Dim r2 as Range     ' variable range for single cell which is the target for inserting the result  
    Dim a() a Variant   ' array of variants to hold each cell's value after it's split  
    Dim b() as Variant  ' array of variants to hold the accumulation of values to spread into the destination  
    Dim v ar Variant    ' variant to iterate through b for insertion  
    Dim i as Integer    ' cumulative offset from top of destination range while inserting  

    For each c in Selection.Cells  
        a = Split(Replace(c.Text, ",", "")) ' will split on whitespace  
        for each v in a  
            b.Add v  
        next v  
    next c  

    ' now you have a new array with the full set of values  

    ' insert them a row at a time using Range.Offset  
    i = 0  
    Set r = Selection.Cells(0)  
    For Each v in b  
        Set r2 = r.Offset(1, 0)  
        r2.Value = v  
        i = i + 1  
    next v  
End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-23T02:01:22.680

我不太擅长 Excel VBA，但这有效（不知何故！！）

```
Sub arrange()

' get the current range from the sheet
    curr_range = ActiveSheet.Range("A1:A6")

' for each cell in that range ...
    For Each Row In curr_range

' ...put the contents into an array
        arr = Split(Row, ",")

' for each cell in that array ...
        For Each cell In arr

' ...output it into a string
            output_str = output_str & "," & cell
        Next cell

    Next Row

' remove spaces
    output_str = Replace(output_str, " ", "")
' remove left ,
    output_str = Right(output_str, Len(output_str) - 1)

' make it into an array
    output_arr = Split(output_str, ",")

' populate the sheet back
    ActiveSheet.Range("A:A").Value = Application.WorksheetFunction.Transpose(output_arr)

End Sub 
```

# c++ - std::tr1 中的 shared_ptr

> ID：471438
> 
> 赞同：9
> 
> 时间：2009-01-23T00:33:18.740
> 
> 标签：c++, gcc, boost, shared-ptr, tr1

我正在使用 gcc 编译器的平台上工作，但是 boost 无法在其上编译。

我想知道在 gcc 的 std:tr1 中包含 shared_ptr 的正确方法是什么？我查看的文件说不直接包含它，据我所知没有其他文件包含它：|

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-04T22:55:01.967

在**G++ 4.3**中，

```
#include <tr1/memory> 
```

应该做的伎俩。您会`shared_ptr`在`std::tr1::shared_ptr`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-27T21:15:03.290

[Boost 本身就有答案](http://www.boost.org/doc/libs/1_37_0/doc/html/boost_tr1/usage.html#boost_tr1.usage.include_style)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-11T22:39:42.720

Boost就不能编译了吗？大多数 boost 库都不需要编译才能使用，我猜 shared_ptr 也不需要。

# .net - 寻找 ASP.NET MVC PartialView 和高级 AJAX 文档

> ID：471443
> 
> 赞同：0
> 
> 时间：2009-01-23T00:35:18.780
> 
> 标签：.net, asp.net-mvc, documentation

[通过 ASP.NET 网站演练](http://quickstarts.asp.net/previews/mvc/)和[教程](http://www.asp.net/learn/mvc/)，我在 ASP.NET MVC 方面做得很好。

现在我完全意识到该文档并不完整，只是测试版，但似乎缺少一些重要的文档。

我在哪里可以找到有关以下主题的最佳信息（主要文档中似乎缺少这些信息）：

*   部分视图
*   高级 AJAX - Ajax.ActionLink 和 IsAjaxRequest
*   我可以在我的控制器中装饰方法的每个属性的详细描述

我发现了一些博客文章，但其中一些非常古老。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T00:46:42.220

[在www.codeplex.com/aspnet](http://www.codeplex.com/aspnet)上深入研究实际的源代码。这些天来，我经常使用它作为主要来源来补充各种博客/教程。源代码是唯一永不过时的*文档。*也就是说，MSDN 已经提供了已发布版本的[参考文档](http://msdn.microsoft.com/en-us/library/dd566232.aspx)。

# ruby - 将 Ruby 类加载到应用程序中的最佳方法是什么？

> ID：471445
> 
> 赞同：11
> 
> 时间：2009-01-23T00:36:13.147
> 
> 标签：ruby

目前我正在使用 require 命令将 Ruby 类加载到每个类文件中，例如：

```
require File.join(File.dirname(__FILE__), 'observation_worker')
require File.join(File.dirname(__FILE__), 'log_worker') 
```

对于每个类，我都在定义它需要的类。如果我可以在我的应用程序的入口点执行此操作，那就太好了。

有没有一种简单的方法可以在应用程序开始时加载所有 Ruby 类？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-23T04:48:34.497

如果您对代码所在的目录结构有一定的了解，则可以将特定的目录路径添加到加载路径中，例如

```
$LOAD_PATH.unshift( File.join( File.dirname(__FILE__), 'lib' ) ) 
```

然后在代码的其他部分中，您可能需要像这样的相对路径：

```
require 'observation_worker'
require 'logger_worker' 
```

或者如果你在 lib 中有文件夹，你甚至可以这样做

```
require 'workers/observation'
require 'workers/logger' 
```

在我看来，这可能是在库的上下文中处理加载的最干净的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-23T01:22:12.383

不确定我是否完全理解，因为您总是必须告诉您的程序它需要哪些文件，但您可以执行以下操作：

```
Dir["#{File.dirname(__FILE__)}/*.rb"].each { |f| require(f) } 
```

这将包括当前文件目录中的所有 .rb 文件。尽管如果您开始使用 RDoc，它不会对您感到满意。

明确列出您的需求通​​常不是一件坏事，它可以让其他开发人员清楚阅读您的代码发生了什么。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-23T04:49:53.090

这是我喜欢使用的一个选项。

[http://github.com/dyoder/autocode/tree/master](http://github.com/dyoder/autocode/tree/master)

来自 github 文档

```
 require 'autocode'

  module Application
    include AutoCode
    auto_load true, :directories => [ :configurations, :models, :views, :controllers ]
  end 
```

这将尝试从给定目录动态加载代码，使用模块名称来确定要查看的目录。因此，Application::CustomerModel 可以加载文件 models/customer_model.rb。

此外，您可以查看导轨引导的方式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-23T01:40:29.897

*正如 jtzero 所评论的，自动加载已被弃用*

* * *

您仍然需要指定要加载的内容，但您可以尝试`autoload`.

```
autoload :Module, "module" 
```

首次使用该常量时，`Module`该文件`"module"`将`require`自动 d。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-02-07T19:25:01.030

签出这个类加载器

[http://github.com/alexeypetrushin/class_loader](http://github.com/alexeypetrushin/class_loader)

假设您具有以下目录结构

```
/your_app
    /lib            
        /animals
            /dog.rb
        /zoo.rb 
```

只需将 ClassLoader 指向您的应用程序的根目录，它就会自动查找并加载所有其他类

```
require 'class_loader'
autoload_dir '/your_app/lib'

Zoo.add Animals::Dog.new # <= all classes loaded automatically 
```

# c# - 从 C# 迁移到 Java 的提示？

> ID：471448
> 
> 赞同：17
> 
> 时间：2009-01-23T00:36:43.100
> 
> 标签：c#, java

所以我下周要去一个 Java 的地方面试，我不想让人觉得一无所知。我是一个非常自信的 C#/.NET 开发人员，并且（显然！）愿意考虑跳槽到 Java——我想要人们推荐的资源链接。我对以下问题的答案感兴趣：

*   [任何与Justin Etheridge 为 C# 开发人员编写的 Ruby](http://www.codethinked.com/post/2008/07/21/Learning-Ruby-via-IronRuby-and-C-Part-1.aspx)大致相当的指南？当我决定要学习 Ruby 的 rake（因此至少要学一点 Ruby）时，这真的很有用。不过，似乎还有更多页面可供人们走另一条路……
*   使用哪个 IDE？实际上，我已经购买了自己的 IntelliJ，因为我喜欢它的 HTML/CSS/JS，但还没有触及它真正存在的理由，嗯，“那个 Java 东西”。但是，我怀疑我将要使用 Eclipse 的地方。所以 - 推荐资源在 Mac 或 Windows 上启动和运行（我不挑剔）？
*   这可能是一次 TDD 编码面试；我想 JUnit 是在这里学习一点的事实上的选择？

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-23T00:40:46.290

查看[此链接](http://www.25hoursaday.com/CsharpVsJava.html)，其中详细介绍了两种语言之间的许多差异。

至于 IDE，很多人喜欢 Eclipse 或 Netbeans（我最喜欢）——两者都是免费的。由于您已经拥有 IntelliJ，您可以尝试一下。

FYO的一些主要区别是：

*   缺乏属性/自动属性
*   没有“事件”类型（处理事件的不同方式）
*   foreach 循环语法
*   “泛型”实现
*   已检查的异常

可能还有更多:)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-23T03:05:53.970

**IDE**

你有 IntelliJ。相信我是最好的。我用了两年，然后不得不改用一些免费的东西。我尝试了 Eclipse，这很痛苦，只是告诉你我的经验并没有冒犯。现在，和 Netbeans 一起工作，我很开心，但还是一天一次想念 IntelliJ。

**TDD**

是的，您对 JUnit 的看法非常正确。在充分了解之后，看看其他专业库，如 HtmlUnit、DBUnit 是很好的。此外，还有像 Cobertura 或 Emma 这样的代码覆盖工具。由于您必须使用 IntelliJ，您可能会喜欢查看 Emma，因为它与 IDEA 有很好的集成。

**过渡**

我认为您在过渡期间不会遇到困难。IMO，阅读文档和规范会让你继续前进。或许你可以继续阅读一些书籍，但就核心 Java 而言，阅读 API 文档和规范将是一个好的开始。您可以使用 SO 来提问。我见过很多问题，比如“Java 中的 C# 等价物……”。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-23T05:40:32.083

由于您只有一周的时间，因此我会赞同将重点放在*Effective Java*所指出的那类事情上的建议。

了解集合 API。当我采访人们时，这是我淘汰人们的一种方式。尤其要了解 、 和 之间的区别`equals()`，`hashCode()`以及`compareTo()`正确实现它们所需的条件。

了解如何在 Java 中处理异常，以及它如何与标准 EJB 事务交互。

如果你有幸得到这份工作，我会花一些时间去了解 J2EE 领域，它是相当广阔的。这些天来，我认为 J2EE 的基础是 EJB、MDB、servlet 和 JPA。

我不会太担心 IDE 或 xUnit API。对于任何有经验的体面的开发人员来说，这些事情都是微不足道的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-23T01:41:09.287

Netbeans 是 Java 开发人员最好的（并且最像 Visual Studio）IDE。如果你有足够的内存，你会喜欢它的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-23T05:22:43.100

如果您有一周的时间 - 尝试尽可能多地编写 Java 代码。

我发现从 Java 到 C# 很容易，而且它应该是相同的其他方式。

拿起一本 Effective Java 并通读一遍——它确实非常好。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-23T00:42:57.987

正如您所提到的，对于 IDE，您应该考虑 Eclipse，它是免费的，并且是用于基本开发的不错的 IDE。但是，如果您打算使用 Java EE，这可能还不够，但它会帮助您快速学习基础知识。

有很多书涵盖了基本语法和编程风格，假设您是一名优秀的 C# 开发人员，任何书都可能足以让您继续前进。我不知道你提到的那种副手。

我最近做了相反的转换，从 Java 到 C#。我发现用新语言重写现有应用程序比我想象的要容易得多。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-23T05:38:13.863

我认为最大的不同是两个平台周围的社区和环境。在 .NET 世界中，Microsoft 做出重大决策并推出功能集。另一方面，Java 世界中有许多第三方库几乎是对平台的补充，如果您从事某种开发，您应该了解它们。请参阅[最有用的免费 Java 库](https://stackoverflow.com/questions/130095/most-useful-free-java-libraries)。

# c# - 在 C# 中隐藏表单

> ID：471451
> 
> 赞同：0
> 
> 时间：2009-01-23T00:37:45.283
> 
> 标签：c#

我有一个名为 C# 的表单`MainPanel`和一个名为`Login`. 当程序启动时，我想要`MainPanel`加载，但被禁用，并且有`Login`要加载的表单，位于屏幕的前面并处于活动状态。我加载`Login`表单的代码如下所示：

```
Login l = new Login();
l.setParent(this);
l.Show();
l.BringToFront(); 
```

这段代码在函数中`MainPanel`：

```
private void Form1_Load(object sender, EventArgs e) 
```

并且被调用，但是，`Login`表格不在前面。我如何强制它显示在前面，启用，同时保持`MainPanel`禁用（我通过设置`enabled = false`which 工作正常）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-23T00:40:57.477

尝试使用 .ShowDialog() 而不是 .Show()

# python - Python 是否有 Term::ANSIScreen 等价物？

> ID：471463
> 
> 赞同：3
> 
> 时间：2009-01-23T00:43:24.367
> 
> 标签：python, perl, ansi

Perl 具有出色的模块`Term::ANSIScreen`，可以进行各种精美的光标移动和终端颜色控制。我想用 Python 重新实现当前在 Perl 中的程序，但终端 ANSI 颜色是其功能的关键。有人知道等价物吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-12-29T21:18:25.943

如果你只需要颜色你可能想借用 pygments 的实现。IMO 它比 ActiveState 的干净得多

[http://dev.pocoo.org/hg/pygments-main/file/b2deea5b5030/pygments/console.py](http://dev.pocoo.org/hg/pygments-main/file/b2deea5b5030/pygments/console.py)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-23T01:19:26.913

这是关于 ActiveState 的[食谱](http://code.activestate.com/recipes/574451/)，可帮助您入门。它涵盖了颜色和定位。

*[编辑：上面由 Jorge Vargas 提交的 pygments 代码是一种更好的方法。]*

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-02-13T09:56:43.597

还有[termcolor](http://pypi.python.org/pypi/termcolor)和[termstyle](https://github.com/gfxmonk/termstyle)包。如果 stdout 不是终端，后者能够禁用颜色输出。

另请参阅[此问题](https://stackoverflow.com/questions/287871/print-in-terminal-with-colors-using-python)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-23T00:48:12.920

虽然我自己没有使用过，但我相信 curses 库通常用于此目的：

[http://docs.python.org/library/curses.html](http://docs.python.org/library/curses.html)

和操作方法：

[http://docs.python.org/howto/curses.html#curses-howto](http://docs.python.org/howto/curses.html#curses-howto)

不幸的是，这个模块似乎在 windows 的标准库中不可用。该站点显然有一个Windows解决方案：

[http://adamv.com/dev/python/curses/](http://adamv.com/dev/python/curses/)

# c# - OpenGLES中的纹理映射问题

> ID：471468
> 
> 赞同：1
> 
> 时间：2009-01-23T00:48:43.230
> 
> 标签：c#, graphics, opengl-es

我对 OpenGL 很陌生，我正在使用为 Windows Mobile 手机（[OpenGLES Windows Mobile](http://www.koushikdutta.com/2008/08/net-compact-framework-wrapper-for.html)）编写的托管 OpenGLES 包装器。我有一个简单的任务是绘制一个正方形（得到那个）并用磁盘中的图像对其进行纹理化，所以我基本上只想在屏幕上显示一个 jpg 文件。但是，每次我尝试这样做时，都会显示一个白色方块，没有纹理。我验证了我的纹理加载正确（使用一些现有的例子，只是用我的纹理替换）。所以我认为我的问题是将纹理正确映射到对象。这是我的代码（为了简单起见，删除了函数和对象）：

```
 private Bitmap image = new Bitmap(@"\Storage Card\someimage.jpg");
        using (MemoryStream ms = new MemoryStream())
        {
            Image.Save(ms, System.Drawing.Imaging.ImageFormat.Bmp);
            myImage = Texture.LoadStream(ms, false);
        }
        gl.ShadeModel(gl.GL_SMOOTH);
        gl.ClearColor(0.0f, 0.0f, 0.0f, 0.5f);
        gl.BlendFunc(gl.GL_SRC_ALPHA, gl.GL_ONE_MINUS_SRC_ALPHA);
        gl.Hint(gl.GL_PERSPECTIVE_CORRECTION_HINT, gl.GL_NICEST);
        glLocation.Clear();
        gl.Clear(gl.GL_COLOR_BUFFER_BIT);
        gl.MatrixMode(gl.GL_PROJECTION);
        gl.LoadIdentity();
        gl.Orthof(0, ClientSize.Width, ClientSize.Height, 0, 0, 1);
        gl.Disable(gl.GL_DEPTH_TEST);

        gl.MatrixMode(gl.GL_MODELVIEW);
        gl.LoadIdentity();
        float[] rectangle = new float[] {
            0, 0,
            myImage.Width, 0,
            0,  myImage.Height,
            myImage.Width,  myImage.Height
        };

        float[] texturePosition = new float[] {
            0, 0,
            myImage.Width, 0,
            0,  myImage.Height,
            myImage.Width,  myImage.Height
        };

        //Bind texture
        gl.BindTexture(gl.GL_TEXTURE_2D, myImage.Name);
        gl.TexParameteri(gl.GL_TEXTURE_2D, gl.GL_TEXTURE_MIN_FILTER, gl.GL_LINEAR);
        gl.TexParameteri(gl.GL_TEXTURE_2D, gl.GL_TEXTURE_MAG_FILTER, gl.GL_LINEAR);
        //move cursor
        glLocation.MoveCursor(Location.X, Location.Y);
        gl.EnableClientState(gl.GL_TEXTURE_COORD_ARRAY);
        gl.EnableClientState(gl.GL_VERTEX_ARRAY);

        //draw square and texture it.
        fixed (float* rectanglePointer = &rectangle[0], positionPointer = &texturePosition[0])
        {
            gl.TexCoordPointer(2, gl.GL_FLOAT, 0, (IntPtr)positionPointer);
            gl.VertexPointer(2, gl.GL_FLOAT, 0, (IntPtr)rectanglePointer);
            gl.DrawArrays(gl.GL_TRIANGLE_STRIP, 0, 4);
        }

        gl.DisableClientState(gl.GL_TEXTURE_COORD_ARRAY);
        gl.DisableClientState(gl.GL_VERTEX_ARRAY);
        egl.SwapBuffers(myDisplay, mySurface);
        gl.Clear(gl.GL_COLOR_BUFFER_BIT); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-12-18T14:34:58.840

您尚未启用 GL_TEXTURE_2D - 添加此行

```
gl.glEnable(gl.GL_TEXTURE_2D) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T14:47:54.620

尝试将纹理位置坐标从 myImage.Width 和 myImage.Height 更改为 1.0。纹理坐标从 0.0 到 1.0。

# java - 用于解析 CTXCAT 查询语法的 Java 库或代码示例（用于 Oracle CATSEARCH）

> ID：471475
> 
> 赞同：1
> 
> 时间：2009-01-23T00:54:43.127
> 
> 标签：java, oracle

我有兴趣通过 Java 预先解析用户的输入以获得有效的 CTXCAT 语法，然后再将其用于搜索 Oracle CATSEARCH 实现（[http://www.oracle.com/technology/products/text/htdocs/ctxcat_primer.html](http://www.oracle.com/technology/products/text/htdocs/ctxcat_primer.html)） .

原因是，如果查询包含任何无效语法（例如没有后面的术语的“NOT”运算符等），Oracle 会返回通用解析异常，其想法是为用户提供一些有用的反馈，而不是通用的“您的查询失败”错误消息。

由于查询语法相当简单，因此编写这可能不是一件非常困难的事情，但如果有预先存在的实现，我也不想重新发明轮子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T01:11:29.447

您可以使用[ANTLR](http://www.antlr.org)非常轻松地制作 java 解析器

# java - Java 虚拟机规范的当前版本在哪里？

> ID：471476
> 
> 赞同：7
> 
> 时间：2009-01-23T00:55:48.100
> 
> 标签：java, jvm, specifications

似乎获得 Java 6 版本的[Java 虚拟机规范](http://java.sun.com/docs/books/jvms/)的唯一方法是采用[第二版](http://java.sun.com/docs/books/jvms/second_edition/html/VMSpecTOC.doc.html)，合并[现有更改](http://java.sun.com/docs/books/jvms/second_edition/jvms-clarify.html)，然后在此基础上添加[Java 6 提议的更改](http://jcp.org/en/jsr/detail?id=202)，这些更改不再真正提议，但实际。

真的吗？

由此产生两个问题：

1.  这就是所有的三角洲吗？
2.  为什么没有官方的当前版本？

有人知道我想念的任何东西吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-23T03:21:18.697

> 这就是所有的三角洲吗？

是的，您链接到的文档是 JVM 规范当前状态的最新信息来源。

> 为什么没有官方的当前版本？

这只是一个猜测，但我会说这是因为“ [JCP 有超过 1200 名企业和个人参与者。](http://www.jcp.org/en/introduction/faq) ”厨师太多。

另一种可能性是，随着 Java 7 的出现，他们正在等待发布新的 JVM 规范，直到新版本发布。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-10-31T02:16:14.810

Java 7 的发布解决了这个问题[。Java 7 文档](http://download.oracle.com/javase/7/docs/)包含一个[规范](http://docs.oracle.com/javase/specs/index.html)侧边栏链接（看到了吗？），它链接到两个新的 PDF（[JLS](http://docs.oracle.com/javase/specs/jls/se7/jls7.pdf)和[JVMS](http://docs.oracle.com/javase/specs/jvms/se7/jvms7.pdf)）。

正如@Andrey Loskutov 在与此问题的评论链接的[博客文章](http://www.jroller.com/andyl/entry/updated_jvm_specs_for_java)中指出的那样， [JSR-000336 Java SE 7 发布内容最终发布规范](http://download.oracle.com/otndocs/jcp/java_se-7-final-eval-spec/index.html)包含一个附件，其中包含这些工件的各种版本和一些周围的措辞，包括以下文本：

> Java 虚拟机的最后一个独立规范是 1999 年的第二版。它在 2004 年受到 Java SE 5.0 的 JSR 的影响。例如，JSR 14 对 ClassFile 章节进行了深度修改。没有发布集成文档，但 Java 虚拟机的规范在 2004 年正式更新。1999 年和 2004 年之间的更改在当时的各个章节中进行了标识，并且不再可能确定专门针对 Java SE 5.0 所做的更改.
> 
> 2004 年规范随后在 2006 年受到 Java SE 6 的 JSR 的影响。例如，JSR 202 对链接章节进行了深入修改。同样，没有发布集成文档，但 Java 虚拟机的规范在 2006 年正式更新。同样，2004 年和 2006 年之间的更改在当时的各个章节中被识别，并且不再可能识别出具体所做的更改对于 Java SE 6。

为什么 Sun/Oracle 通过查找他们的文档来进行研究项目是另一个论坛的问题。然而，我只想说，他们分散的文档方法加上没有任何链接到其他任何东西的事实使得处理 Java 比它应该做的要困难得多。

# javascript - 从复选框突出显示条纹gridview的gridview行

> ID：471485
> 
> 赞同：1
> 
> 时间：2009-01-23T01:03:13.483
> 
> 标签：javascript, jquery, gridview, checkbox

在我拥有的 gridview 中，我试图让它在用户选中该行的复选框时突出显示该行。现在，这个 GridView 是条纹的（意味着偶数行有一种背景颜色，奇数行有另一种背景颜色）。执行此操作的代码以各种形式在网络上漂浮......

```
 var color = '';
function changeColor(obj) {
  var rowObject = getParentRow(obj);
  var parentTable = document.getElementById("gvCategories");
  if(color == ''){
    color = getRowColor();
  }
  if(obj.checked){
    rowObject.style.backgroundColor = 'Yellow';
  }
  else{
    rowObject.style.backgroundColor = color;
    color = '';
  }

  // private method
  function getRowColor(){
  if(rowObject.style.backgroundColor == '') return parentTable.style.backgroundColor;
  else return rowObject.style.backgroundColor;
  }
}

// This method returns the parent row of the object
function getParentRow(obj){
  do{
    obj = obj.parentElement;
  }
  while(obj.tagName != "TR")
  return obj;
} 
```

这是从这里直接复制和粘贴... [http://aspadvice.com/blogs/azamsharp/archive/2007/06/26/Highlight-GridView-Rows-Using-CheckBox.aspx](http://aspadvice.com/blogs/azamsharp/archive/2007/06/26/Highlight-GridView-Rows-Using-CheckBox.aspx)

如果您的 GridView 没有条纹，这很好。然而，正如我之前提到的，我的是条纹的。这里的问题是，如果您根据选择项目的顺序取消选中某个框，则行背景颜色可能会恢复为不正确的颜色。

我已经尝试过考虑一些算法来做到这一点，但我运气不佳。我最初的想法是堆栈的一些诡计，但我很快意识到这将要求用户以他们检查项目的相反顺序取消检查。

我能想到的唯一另一件事是以某种方式检查行索引是奇数还是偶数，如果奇数恢复为特定颜色，是否偶数恢复为特定颜色。但是，我不确定如何从 javascript 检查 gridview 的特定索引。

我最终将为此使用 jQuery，因此任何关于带有或不带有 jquery 的 javascript 的建议都可以。关于如何实现这一目标的任何想法？

**编辑：** 所以我仍然没有运气，我想我会发布我目前拥有的东西。

```
 function highlightRow(object) {
    if ($(object).attr("checked") == true) {
        alert('is checked!'); // this will fire
        $(object).parent('tr').addClass("highlightedRow");
    }
    else {
        alert('is not checked!');
        $(object).parent('tr').removeClass("highlightedRow");
    }
} 
```

正如那里的评论所说，我可以判断是否正在检查某个项目，但似乎没有应用类切换。突出显示的行在它应该在 CSS 文件中覆盖的类之后声明。这是否提供了有关可能出现问题的任何额外信息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T01:07:46.000

我认为在选中复选框时应用和删除设置背景颜色的类会更好。这样，您可以在未选中时简单地删除该类，并应用原始 CSS。只需确保“突出显示”的类出现在 CSS 文件中的其他类之后，以便它覆盖它们的设置。这应该很容易（更容易）使用 jQuery 来完成。

以下假设该类`rowCheckbox`已应用于所有复选框，但您可以根据需要选择它们。它依赖于`highlight`定义的类来覆盖选定行的背景颜色。您的正常行着色也将通过类应用。

```
$(document).ready( function() {
    $('.rowCheckbox').click( function() {
       if (this.checked) {
           $(this).parent('tr').addClass('highlight');
       }
       else {
           $(this).parent('tr').removeClass('highlight');
       }
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-09-30T18:43:49.277

对我来说，直到我将父母改为父母，它才起作用：

```
 $(this).parents('tr').addClass('highlight'); 
```

与父母一起，它没有正确找到 tr

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-23T01:13:03.573

一种方法（可能不是最好的方法）....您可以修改上面的方法，以便使用类似“哈希表”的结构，并将行（tr）的ID与其原始颜色存储起来，这样在取消选中该复选框时，您可以查找其原始颜色并进行相应设置...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-18T23:41:29.873

我终于有时间回到这个问题上，我想通了。出于某种原因，这里有点...

```
$(object).parent('tr') 
```

没有抓住这一行。老实说，我没有深入研究为什么，因为这导致我遇到了真正的问题。

发生的事情是已经设置的背景颜色样式没有被通过...设置的样式覆盖

```
.addClass('highlight'); 
```

因此，给“highlight”类背景样式赋予重要标签就可以了。

```
.SpatialDataHighlightedRow {
    background-color: #DDDDDD !important;
} 
```

# delphi - Delphi Library Path - 真正应该在那里做什么？

> ID：471489
> 
> 赞同：8
> 
> 时间：2009-01-23T01:06:32.370
> 
> 标签：delphi, ide, packages

**我一直将我们包的单元（.pas）文件夹的路径放入Delphi库路径中，但我开始怀疑这是否是一个错误！**以这个问题为例：

我有两个自制的包：

*   低级包
*   高级封装

HighLevelPackage 使用 LowLevelPackage 中包含的单位。

如果两个包的单元文件夹的路径都在库路径中，那么我有可能在 LowLevelPackage 和 HighLevelPackage 隐含包含 LowLevelPackage 的单元之前构建 HighLevelPackage（我认为？）。

**我想知道是否应该将这些包的 DCU 的路径放入库路径中。并且可能将实际源单元的路径放在浏览路径中，以便我们在调试时仍然可以进入它们。**

**听起来对吗？真正应该进入图书馆路径的是什么？*.DCU*的路径？*.DCP？.BPL？还是.PASS？***

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-23T01:58:46.710

```
Library Path: *.dcu, *.inc, *.dfm
Package Output: *.bpl
Dcp Output: *.dcp
Browsing Path: *.pas 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-23T02:19:54.030

嗯，我刚刚看了 Delphi Help 在库路径上的文字：

> 库路径 指定编译器可以找到包源文件的搜索路径。编译器只能找到库路径中列出的那些文件。如果您尝试使用不在库路径上的文件构建包，您将收到编译器错误。

我不确定我是否同意这一点，因为这意味着每个包都可以看到每个其他包的源单元，所以如果一个包使用另一个包单元并且你构建它们的顺序不正确，我相信依赖关系可能会搞砸。哦，好吧，我是谁来质疑德尔福帮助，大声笑。;)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-23T08:39:56.760

我通常根本不将任何包源放入库路径。这是因为项目使用的所有 3rd 方库都进入项目的子目录 (svn:external)，因此将它们放在库路径中会导致将错误的源添加到项目中。相反，我将相对路径添加到项目的搜索路径中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-23T02:02:36.123

+1 给 Cesar，虽然我不知道“浏览路径”选项......我很确定它在 D7 中不存在。这肯定会省去将 PAS 文件添加到库路径以逐步执行代码的操作。

# c# - 什么是 LINQ，它有什么作用？

> ID：471502
> 
> 赞同：136
> 
> 时间：2009-01-23T01:15:28.513
> 
> 标签：c#, linq

什么是 LINQ？我知道它适用于数据库，但它有什么作用？

* * *

## 回答 #1

> 赞同：179
> 
> 时间：2009-01-23T01:53:15.643

[LINQ](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/linq/)代表*语言集成查询*。

Microsoft 语言开发人员没有编写 YAQL（另一种查询语言），而是提供了一种直接用他们的语言（例如 C# 和 Visual Basic）表达查询的方法。形成这些查询的技术不依赖于被查询事物的实现细节，因此您可以针对许多目标（数据库、内存中对象、XML）编写有效查询，而实际上无需考虑查询的底层方式。将执行查询。

让我们从属于 .NET Framework (3.5) 的部分开始探索。

*   LINQ To Objects - 检查[System.Linq.Enumerable](http://msdn.microsoft.com/en-us/library/system.linq.enumerable_members.aspx)的查询方法。这些目标`IEnumerable<T>`，允许以类型安全的方式查询任何类型化的可循环集合。这些查询依赖于已编译的 .NET 方法，而不是表达式。

*   LINQ To Anything - 检查[System.Linq.Queryable](http://msdn.microsoft.com/en-us/library/system.linq.queryable_members.aspx)的某些查询方法。这些目标`IQueryable<T>`，允许构建可由底层实现翻译的表达式树。

*   表达式树 - 检查[System.Linq.Expressions](http://msdn.microsoft.com/en-us/library/system.linq.expressions.aspx)命名空间。这是代码即数据。在实践中，您应该了解这些内容，但实际上并不需要针对这些类型编写代码。语言特性（例如 lambda 表达式）可以让您使用各种速记来避免直接处理这些类型。

*   LINQ To SQL - 检查[System.Data.Linq](http://msdn.microsoft.com/en-us/library/system.data.linq.aspx)命名空间。特别注意`DataContext`. 这是由 C# 团队构建的 DataAccess 技术。它只是工作。

*   LINQ To Entities - 检查[System.Data.Objects](http://msdn.microsoft.com/en-us/library/system.data.objects.aspx)命名空间。特别注意`ObjectContext`. 这是由 ADO.NET 团队构建的 DataAccess 技术。它比 LINQ To SQL 复杂、强大且更难使用。

*   LINQ To XML - 检查[System.Xml.Linq](http://msdn.microsoft.com/en-us/library/system.xml.linq.aspx)命名空间。本质上，人们对`System.Xml`. 所以微软重新编写了它，并利用重新编写的优势引入了一些方法，使使用 LINQ To Objects 处理 XML 变得更容易。

*   一些不错的辅助类型，例如[Func](http://msdn.microsoft.com/en-us/library/bb534960.aspx)和[Action](http://msdn.microsoft.com/en-us/library/system.action.aspx)。这些类型是具有通用支持的委托。声明您自己的自定义（和不可互换的）委托类型的日子已经一去不复返了。

以上所有内容都是 .NET Framework 的一部分，可从任何 .NET 语言（VB.NET、C#、IronPython、COBOL .NET 等）中获得。

* * *

好的，关于语言功能。我将坚持使用 C#，因为这是我最了解的。VB.NET 也有一些类似的改进（还有一些 C# 没有得到的改进——XML 文字）。这是一个简短且不完整的列表。

*   扩展方法 - 这允许您“添加”一个方法来键入。该方法实际上是一个静态方法，它传递了一个类型的实例，并且仅限于该类型的公共契约，但它对于向您不控制的类型（字符串）添加方法非常有用，或者添加（完全实现) 接口的辅助方法。

*   查询理解语法 - 这允许您编写 SQL Like 结构。所有这些东西都被转换为 System.Linq.Queryable 或 System.Linq.Enumerable 上的方法（取决于 myCustomers 的类型）。它是完全可选的，没有它你也可以很好地使用 LINQ。这种查询声明风格的一个优点是范围变量是有范围的：不需要为每个子句重新声明它们。

    ```
    IEnumerable<string> result =
     from c in myCustomers
     where c.Name.StartsWith("B")
     select c.Name; 
    ```

*   Lambda 表达式 - 这是指定方法的简写。C# 编译器将每个转换为匿名方法或 true `System.Linq.Expressions.Expression`。你真的需要了解这些才能很好地使用 Linq。共有三个部分：参数列表、箭头和方法体。

    ```
    IEnumerable<string> result = myCustomers
     .Where(c => c.Name.StartsWith("B"))
     .Select(c => c.Name);` 
    ```

*   匿名类型 - 有时编译器有足够的信息为您创建类型。这些类型并不是真正的匿名：编译器在生成它们时会命名它们。但是这些名称是在编译时生成的，开发人员在设计时使用该名称为时已晚。

    ```
    myCustomers.Select(c => new 
    {
      Name = c.Name;
      Age = c.Age;
    }) 
    ```

*   隐式类型 - 有时编译器从初始化中获得足够的信息，它可以为您找出类型。您可以使用 var 关键字指示编译器这样做。为匿名类型声明变量需要隐式类型，因为程序员可能不会使用*匿名*类型的名称。

    ```
    // The compiler will determine that names is an IEnumerable<string>
    var names = myCustomers.Select(c => c.Name); 
    ```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-23T01:21:10.717

LINQ（语言集成查询）可以指：

*   集合和迭代器操作库，广泛使用高阶函数作为参数 (System.Linq)

*   用于将简单函数作为抽象语法树进行传递和操作的库 (System.Linq.Expressions)

*   对各种语言的语法扩展，为处理集合提供更类似于 SQL 的语法，为匿名函数提供更紧凑的表示法，以及引入在语法上与最终成员函数没有区别的静态辅助函数的机制

*   数据提供者可能遵守的接口定义，以便接收查询结构并可能对其执行优化，或者有时兼容的数据提供者本身

这些成分可以单独使用或组合使用。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-01-23T01:21:58.483

简而言之，LINQ（语言集成查询）允许您直接在代码中编写查询。这些查询可以在关系数据库上，也可以在 XML 或内存容器对象上，例如数组和列表。MSDN 库中提供了更多信息：http: [//msdn.microsoft.com/en-us/library/bb308959.aspx](http://msdn.microsoft.com/en-us/library/bb308959.aspx)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-01-23T01:23:51.303

我将尝试一个简单的答案：LINQ 是一种让您使用类似于 SQL 但可以在 .NET 应用程序中编译的查询语言来查询数据库（或其他数据存储、XML 等）的方法。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-01-23T01:50:25.883

LINQ 代表[Language Integrated Query](http://en.wikipedia.org/wiki/Language_Integrated_Query)，是一种在 CLR 中提供通用“查询”机制的方法。

在最基本的层面上，这由 IEnumerable<T> 上的一组方法组成 - 例如，Select、Sum、Where - 可用于限制、预测等。[1]

更进一步，LINQ 还定义了一个新的 LINQ 提供程序模型，该模型可以采用表达式树并使用它对 CLR 之外的数据源运行“本机”查询 - 例如，LINQ to SQL、LINQ to XML、LINQ到 NHibernate 等。

C# 和 VB.NET 还定义了一种查询语法，允许您在内联编写强类型查询（看起来与 SQL 非常相似），然后编译器将其转换为等效的 IEnumerable<T> 调用。

对我来说，LINQ 最有趣的地方在于支持它所需的所有 C# 和 VB.NET 特性本身就很有用。扩展方法、匿名类型、lambda 表达式和隐式类型都是支持 LINQ 所必需的——但我们倾向于在纯 LINQ 上下文之外使用这些特性。

[1] 这些是关系术语，函数式程序员可能更喜欢 Map、Reduce、Fold 等。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-01-23T02:04:09.977

LINQ 是一种使用源自 C# 编程语言的习语提取数据的技术。虽然它在功能设计上很大程度上归功于 SQL，但它基本上是它自己的数据查询语言。它在广泛的数据源（SQL 数据库、内存表示、XML 等）中运行。特别是 LINQ-To-SQL 应该被视为与传统使用嵌入式 SQL 的对比，后者通常被称为 SQL 编程和 C#/VB 编程之间的“阻抗不匹配”。

有关 LINQ 及其局限性的讨论，您可能想看看这个相关的问题：[LINQ to SQL 是否没有抓住重点？](https://stackoverflow.com/questions/458802/doesnt-linq-to-sql-miss-the-point-arent-orm-mappers-subsonic-etc-sub-opti)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-23T01:18:35.510

[http://msdn.microsoft.com/en-us/netframework/aa904594.aspx](http://msdn.microsoft.com/en-us/netframework/aa904594.aspx)

“LINQ 项目是 .NET Framework 的一组扩展的代号，其中包含语言集成的查询、设置和转换操作。它使用本机语言语法扩展了 C# 和 Visual Basic，并提供了类库以利用这些能力。”

# eclipse - Eclipse CDT - 链接到 Windows lib 文件的问题

> ID：471503
> 
> 赞同：5
> 
> 时间：2009-01-23T01:16:36.030
> 
> 标签：eclipse, g++, mingw, eclipse-cdt

使用 gcc 编译时出现以下链接器错误：

```
undefined reference to `SetStretchBltMode@8' 
undefined reference to `StretchDIBits@52' 
undefined reference to `SetDIBitsToDevi 
```

这些函数是否在 Windows 库中定义？

如果是这样，它们是随 Vista 一起安装的，还是我需要安装它们，如果是，我在哪里可以下载它们。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-23T01:31:02.320

好的 - 解决了这个问题：

libgdi32.a 带有 mingw。

您需要将 -lgdi32 添加到 g++ 命令！

确保 mingw/lib 的路径也提供给 g++，例如：-Lc:/mingw/lib

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-29T09:00:58.967

我知道你很久以前就解决了你的问题，但作为参考，我认为你应该能够运行 g++`-mwindows`并且它会自动将 gdi32.dll 和 comdlg32.dll 与你的二进制文件链接。

[此页面](http://mingw-cross.sourceforge.net/hello_win32api.html)有 MinGW 上的 Win32 教程

# cocoa - NSMutableDictionary/NSDictionary 与 std::multimap

> ID：471505
> 
> 赞同：1
> 
> 时间：2009-01-23T01:17:48.307
> 
> 标签：cocoa

它们是 Cocoa 容器类，其功能类似于标准模板库的 multimap，即让您对相同的键有多个值吗？我一直在尝试筛选 Cocoa 文档，但没有这样的运气，也许我只是智障？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-23T10:56:32.663

您的选择：

*   使用 NSMutableSet、NSCountedSet 或 NSMutableArray 实例作为字典值。这很方便，但确实有将数据结构的可变性暴露给所有与之接触的人的缺点。

*   自己写；要么作为 NSMutableDictionary 的子类，要么作为 NSObject。

*   使用现有的解决方案，例如来自 OmniGroup 的[OFMultiValueDictionary](http://www.omnigroup.com/ftp/pub/software/Source/MacOSX/Frameworks/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-23T07:43:56.793

没有。

获得该行为的最简单方法是使用值为`NSSet`s、`NSCountedSet`s 或`NSArray`s 的字典。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-15T19:35:21.277

要直接使用标准模板库的 multimap，可以使用 Objective C++。

# php - 使用 PHP 将 XML 发布到 URL 并处理响应

> ID：471506
> 
> 赞同：2
> 
> 时间：2009-01-23T01:18:01.410
> 
> 标签：php, xml, api, post

多年来，我已经看到了许多使用 PHP 发布数据的方法，但我很好奇建议的方法是什么，假设有一个。或者也许有一种不言而喻但半普遍接受的方法。这也包括处理响应。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-02-01T19:28:14.163

虽然 Snoopy 脚本可能很酷，但如果您*只想使用 PHP 发布 xml 数据*，为什么不使用 cURL？它很简单，具有错误处理功能，并且是您包中已有的有用工具。下面是如何在 PHP 中使用 cURL 将 XML 发布到 URL 的示例。

```
// url you're posting to        
$url = "http://mycoolapi.com/service/";

// your data (post string)
$post_data = "first_var=1&second_var=2&third_var=3";

// create your curl handler     
$ch = curl_init($url);

// set your options     
curl_setopt($ch, CURLOPT_MUTE, 1);
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 0); //ssl stuff
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 0);
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_HTTPHEADER, array('Content-Type:  application/x-www-form-urlencoded'));
curl_setopt($ch, CURLOPT_POSTFIELDS, $post_data);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);

// your return response
$output = curl_exec($ch); 

// close the curl handler
curl_close($ch); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T02:24:24.897

除了使用[socket之外，](http://php.net/fsockopen) [cURL](http://php.net/curl)是我所知道的唯一可靠的 POST 数据方式。

现在，如果您想通过 GET 发送数据，有几种方法：
[cURL](http://php.net/curl)
[套接字](http://php.net/fsockopen)
[file_get_contents](http://php.net/file_get_contents)
[文件](http://php.net/file)
和其他

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T03:30:34.857

您可以尝试[Snoopy 脚本](http://sourceforge.net/projects/snoopy/)
它对不允许使用[fopen 包装器](http://us2.php.net/manual/en/filesystem.configuration.php#ini.allow-url-fopen)
的托管服务提供商很有用， 我已经使用它几年来获取 RSS 提要。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-23T09:55:30.820

我喜欢[Zend Framework](http://framework.zend.com/)的[Zend_Http_Client](http://framework.zend.com/manual/en/zend.http.html)。

它基本上使用[stream_context_create()](http://de.php.net/manual/en/function.stream-context-create.php)和[stream_socket_client()](http://de.php.net/manual/en/function.stream-socket-client.php)工作。

小例子：

```
$client = new Zend_Http_Client();
$client->setUri('http://example.org');
$client->setParameterPost('foo', 'bar')
$response = $client->request('POST');

$status = $response->getStatus();
$body = $response->getBody(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-23T08:30:31.800

没有真正的标准方法。在用于分发的代码中，我通常使用找到的第一个来检查[cURL](http://php.net/curl)、[file_get_contents](http://php.net/file_get_contents)和[sockets 。](http://php.net/fsockopen)它们中的每一个都支持 GET 和 POST，并且根据 PHP 版本和配置，它们中的每一个都可能可用或不可用（或工作）。

基本上是这样的：

```
function do_post($url, $data) {
  if (function_exists('curl_init') && ($curl = curl_init($url))) {
    return do_curl_post($curl, $data);
  } else if (function_exists('file_get_contents') && ini_get('allow_url_fopen') == "1") {
    return do_file_get_contents_post($url, $data);
  } else {
    return do_socket_post($url, $data);
  }
} 
```

# css - 使用 css 隐藏文本

> ID：471510
> 
> 赞同：345
> 
> 时间：2009-01-23T01:19:06.477
> 
> 标签：css

我的 html 中有一个标签，如下所示：

```
<h1>My Website Title Here</h1> 
```

使用 css 我想用我的实际徽标替换文本。通过调整标签大小并通过css放入背景图像，我已经获得了徽标没有问题。但是，我不知道如何摆脱文本。我以前基本上是通过将文本从屏幕上推开来完成的。问题是我不记得我在哪里看到的。

* * *

## 回答 #1

> 赞同：449
> 
> 时间：2009-01-23T01:30:09.560

这是一种方式：

```
h1 {
    text-indent: -9999px;                 /* sends the text off-screen */
    background-image: url(/the_img.png);  /* shows image */
    height: 100px;                        /* be sure to set height & width */
    width: 600px;
    white-space: nowrap;            /* because only the first line is indented */
}

h1 a {
    outline: none;  /* prevents dotted line when link is active */
} 
```

这是[另一种](http://www.zeldman.com/2012/03/01/replacing-the-9999px-hack-new-image-replacement/)隐藏文本同时避免浏览器将创建的巨大的 9999 像素框的方法：

```
h1 {
    background-image: url(/the_img.png);  /* shows image */
    height: 100px;                        /* be sure to set height & width */
    width:  600px;

    /* Hide the text. */
    text-indent: 100%;
    white-space: nowrap;
    overflow: hidden;
} 
```

* * *

## 回答 #2

> 赞同：213
> 
> 时间：2011-11-04T22:49:03.223

为什么不简单地使用：

```
h1 { color: transparent; } 
```

* * *

## 回答 #3

> 赞同：203
> 
> 时间：2011-06-27T05:37:41.903

只需添加`font-size: 0;`到包含文本的元素。

```
.hidden { font-size: 0; }
```

```
 font-size: 0; hides text. <span class="hidden"> You can't see me :) </span>
```

* * *

## 回答 #4

> 赞同：33
> 
> 时间：2009-01-23T01:26:12.220

最跨浏览器友好的方式是将 HTML 编写为

```
<h1><span>Website Title</span></h1> 
```

然后使用 CSS 隐藏跨度并替换图像

```
h1 {background:url(/nicetitle.png);}
h1 span {display:none;} 
```

如果您可以使用 CSS2，那么有一些更好的方法可以使用该`content`属性，但不幸的是，网络还不是 100%。

* * *

## 回答 #5

> 赞同：28
> 
> 时间：2015-01-04T19:26:37.007

## 考虑到可访问性隐藏文本：

除了其他答案之外，这是隐藏文本的另一种有用方法。

这种方法有效地隐藏了文本，但允许它对屏幕阅读器保持可见。如果可访问性是一个问题，这是一个考虑的选项。

```
.sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0,0,0,0);
    border: 0;
} 
```

值得指出的是，这个类目前在[Bootstrap 3](https://stackoverflow.com/questions/19758598/what-is-sr-only-in-bootstrap-3/19758620#19758620)中使用。

* * *

如果您有兴趣阅读有关可访问性的信息：

*   [无障碍网页倡议 (WAI)](http://www.w3.org/WAI/)

*   [MDN 可访问性文档](https://developer.mozilla.org/en-US/docs/Web/Accessibility?redirectlocale=en-US&redirectslug=Accessibility)

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2014-11-14T15:01:17.913

Jeffrey Zeldman 建议以下解决方案：

```
.hide-text {
  text-indent: 100%;
  white-space: nowrap;
  overflow: hidden;
} 
```

它的资源密集度应该低于`-9999px;`

请在此处阅读所有相关信息：

[http://www.zeldman.com/2012/03/01/replacing-the-9999px-hack-new-image-replacement/](http://www.zeldman.com/2012/03/01/replacing-the-9999px-hack-new-image-replacement/)

* * *

## 回答 #7

> 赞同：18
> 
> 时间：2019-01-24T07:36:07.240

您可以通过添加此属性来简单地隐藏您的文本：

```
font-size: 0 !important; 
```

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2016-08-12T20:38:45.030

这么多复杂的解决方案。

最简单的就是简单地使用：

```
color:rgba(0,0,0,0) 
```

* * *

## 回答 #9

> 赞同：14
> 
> 时间：2009-05-08T10:54:52.133

请参阅[mezzoblue](http://www.mezzoblue.com/tests/revised-image-replacement/)以获得每种技术的精彩总结，包括优点和缺点，以及示例 html 和 css。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2011-03-16T22:34:22.923

不要使用`{ display:none; }`它会使内容无法访问。您希望屏幕阅读器看到您的内容，并通过将文本替换为图像（如徽标）来直观地对其进行样式设置。通过使用`text-indent: -999px;`或类似的方法，文本仍然存在——只是视觉上不存在。使用`display:none`，文本消失了。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2011-07-03T09:35:23.150

```
<style>
body {
     visibility:hidden
}
body .moz-signature p{
    visibility:visible
}
</style> 
```

以上在最新的 Thunderbird 中也很有效。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2009-01-23T01:27:26.337

您可以使用 css`background-image`属性并`z-index`确保图像保持在文本前面。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2013-05-02T10:31:04.543

你为什么不使用：

```
<li><a href="#">bla</a></li>

a {
    opacity: 0.0;
    font-size: 1px;
}

li {
    background-image: url('test.jpg');
} 
```

如果您没有任何 span 或 div 元素，则它非常适合链接。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2009-01-23T01:24:14.220

答案是使用该属性创建一个跨度

`{display:none;}`

[你可以在这个网站](http://stopdesign.com/articles/replace_text/)上找到一个例子

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2009-01-23T04:02:25.650

这实际上是一个可以讨论的领域，有许多微妙的技术可供使用。选择/开发一种满足您需求的技术非常重要，包括：屏幕阅读器、图像/css/脚本开/关组合、seo 等。

以下是一些很好的资源，可以帮助您开始使用标准图像替换技术：

[http://faq.css-standards.org/Image_Replacement](http://faq.css-standards.org/Image_Replacement)

[http://www.alistapart.com/articles/fir](http://www.alistapart.com/articles/fir)

[http://veerle.duoh.com/blog/links/#l-10](http://veerle.duoh.com/blog/links/#l-10)

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2017-05-22T14:28:52.337

我不记得我是在哪里捡到它的，但多年来一直成功使用它。

```
 =hide-text()
    font: 0/0 a
    text-shadow: none
    color: transparent 
```

我的 mixin 在 sass 中，但是你可以以任何你认为合适的方式使用它。为了更好地衡量，我通常`.hidden`在我的项目中保留一个类以附加到元素以避免重复。

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2017-07-03T08:55:56.977

用 CSS 替换内容

```
 h1{  font-size: 0px;}
 h1:after {
    content: "new content";
    font-size: 15px;
  } 
```

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2012-06-07T12:25:56.557

对不同的浏览器使用 Condition 标签，并使用你必须放置的 css `height:0px`并且`width:0px`你必须放置`font-size:0px`.

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2014-06-19T08:49:41.440

如果只是为了使元素内的文本不可见，请使用诸如`color:rgba(0,0,0,0);`clean and simple 之类的 rgba 值将 color 属性设置为不透明度为 0。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2012-01-26T17:11:46.943

```
h1 {
    text-indent: -3000px; 
    line-height: 3000px;
    background-image: url(/LOGO.png);
    height: 100px; width:  600px;  /* height and width are a must */

} 
```

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2015-04-17T03:16:14.300

试试这个代码来缩短和隐藏文本

```
.hidetxt{

  width: 346px;
  display: table-caption;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  cursor: no-drop;

}

.hidetxt:hover { 

  visibility: hidden;

}
```

```
<div class="hidetxt">
<p>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when</p>
</div>
```

或隐藏在您的 css 类中的使用`.hidetxt { visibility: hidden; }`

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2012-04-12T21:57:53.127

如果我们可以编辑标记，生活会更轻松，只需删除文本并快乐。但有时标记是由 JS 代码放置的，或者我们根本不允许编辑它，太糟糕的 css 变成了我们唯一可以使用的武器。

我们不能放置一个`<span>`环绕文本并隐藏整个标签。顺便说一句，一些浏览器不仅会隐藏元素，`display:none`还会禁用其中的组件。

两者都`font-size:0px`可能`color:transparent`是很好的解决方案，但有些浏览器不理解它们。我们不能依赖他们。

我建议：

```
h1 {
  background-image: url(/LOGO.png);  /* Our image */
  text-indent: -3000px;  /* Send text out of viewable area */
  height: 100px; width: 600px;  /* height and width are a must, agree */
  overflow:hidden;  /* make sure our size is respected */
} 
```

使用`overflow:hidden`强制我们的宽度和高度。一些浏览器（不会命名它们...... *IE*）可能会将宽度和高度读取为`min-width`and `min-height`。我想防止盒子被放大。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2012-05-03T08:45:13.507

我通常使用：

```
span.hide
{
  position:fixed;
  right:-5000px;
} 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2016-01-05T20:07:07.223

在元素中使用零值对我`font-size`有用：`line-height`

```
<style>
    .text {
        display: block;
        width: 200px;
        height: 200px;

        font-size: 0;
        line-height: 0;
    }
</style>

<span class="text">
    Invisible Text
</span> 
```

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2016-02-09T11:59:48.210

要从 html 中隐藏文本，请在 css 中使用 text-indent 属性

```
.classname {
 text-indent: -9999px;
 white-space: nowrap; 
} 
```

/* 对于动态文本，您需要添加空格，因此您应用的 css 不会打扰。nowrap 意味着文本永远不会换行到下一行，文本继续在同一行，直到`<br>`遇到标签

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2018-02-26T16:05:47.793

我实现此目的的方法之一是使用`:before`or `:after`。我已经使用这种方法好几年了，特别适用于字形矢量图标。

```
h1 {
    position: relative;
    text-indent: -9999px;                 /* sends the text off-screen */
    }
h1:before {
    position: absolute;
    top: 0;
    left: 0;
    z-index: 1;
    display: block;
    width: 600px;
    height: 100px;
    content: ' ';
    background: transparent url(/the_img.png) 0 0 no-repeat;
    } 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2013-08-30T03:15:24.230

这对我来说适用于跨度（敲除验证）。

```
<span class="validationMessage">This field is required.</span>

.validationMessage {
    background-image: url('images/exclamation.png');
    background-repeat: no-repeat;
    margin-left: 5px;
    width: 16px;
    height: 16px;
    vertical-align: top;

    /* Hide the text. */
    display: inline-block;
    overflow: hidden;
    font-size: 0px;
} 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2014-12-16T21:34:56.023

一个适合我的解决方案：

HTML

```
<div class="website_title"><span>My Website Title Here</span></div> 
```

CSS

```
.website_title {
    background-image: url('../images/home.png');
    background-repeat: no-repeat;
    height: 18px;
    width: 16px;
}

.website_title span {
    visibility: hidden;
} 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2021-05-02T12:53:53.053

`content`使用该属性可以直接在 CSS 中进行内容替换。

这似乎最常用于生成伪元素`::before`，`::after`但也可用于替换现有 HTML 元素的内容。

对于原始示例

```
<h1>My Website Title Here</h1> 
```

这是将用徽标替换文本的 CSS：

```
 h1 {
            content: url(mywebsitelogo.png);
            width: 100%;
        } 
```

虽然在伪元素中，任何图像内容都无法调整大小（除非将其用作背景图像），但替换内容*并非*如此。

默认情况下，图像将以实际大小显示，必要时扩展容器，就像它包含实际`<img>`元素一样。

在此示例中，`width: 100%`用于使徽标图像适合整个宽度。如果图像应该缩小以适应，如果需要，但如果容器大于图像，则永远不要扩展，那么`max-width: 100%`可以使用代替。

[根据 MDN](https://developer.mozilla.org/en-US/docs/Web/CSS/content#browser_compatibility)，唯一*不*支持 CSS 内容替换的常规浏览器是 Internet Explorer。

* * *

## 回答 #30

> 赞同：-1
> 
> 时间：2014-11-20T22:47:36.243

最佳答案适用于短文本，但如果文本换行，它只会显示在图像中。

一种方法是使用 jquery 处理程序捕获错误。尝试加载图像，如果失败则会引发错误。

```
$('#logo img').error(function(){
    $('#logo').html('<h1>My Website Title Here</h1>');
}); 
```

见[示例代码](http://jsbin.com/boposi/1/edit?html,js,output)

* * *

## 回答 #31

> 赞同：-1
> 
> 时间：2016-03-16T05:52:13.300

```
h1{
   background:url("../images/logo.png") no-repeat;
   height:180px;
   width:200px;
   display:inline-block;
   font-size:0px !important;
   text-intent:-9999999px !important;
   color:transparent !important;
 } 
```

# mysql - 是否可以从 Ruby 调用 MySQL 存储过程？

> ID：471517
> 
> 赞同：5
> 
> 时间：2009-01-23T01:21:24.383
> 
> 标签：mysql, ruby-on-rails, stored-procedures

当我尝试从 Rails 调用存储过程时，出现以下异常：

```
ActiveRecord::StatementInvalid: Mysql::Error: PROCEDURE pipeline-ws_development.match_save_all can't return a result set in the given context: call match_save_all()
    from /Users/otto/Projects/Futures/src/pipeline-ws/vendor/rails/activerecord/lib/active_record/connection_adapters/abstract_adapter.rb:150:in `log'
    from /Users/otto/Projects/Futures/src/pipeline-ws/vendor/rails/activerecord/lib/active_record/connection_adapters/mysql_adapter.rb:281:in `execute'
    from (irb):3 
```

[Rails Wiki 中](http://wiki.rubyonrails.org/rails/pages/StoredProceduresInMySql)有一个页面讨论了解决此问题的 MySQL 适配器补丁，但它已经过时并且似乎不再起作用。

配置代码正确启用了存储过程，但在存储过程调用后仍然存在连接不同步的问题，并且新`call_sp`方法不再起作用。

关于如何使它工作的任何建议？

这是我正在使用的代码：

```
ActiveRecord::Base.connection("call storedproc()") 
```

`storedproc()`无论是否返回任何结果，它都会引发相同的异常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-09-06T18:39:13.597

我已经向 Rails 2.3.4 提交了一个补丁，它提供了一个配置选项来解决这个问题。请停在我的票上，并表示您对它的支持！

[https://rails.lighthouseapp.com/projects/8994/tickets/3151-mysql-adapter-update-to-enable-use-of-stored-procedures](https://rails.lighthouseapp.com/projects/8994/tickets/3151-mysql-adapter-update-to-enable-use-of-stored-procedures)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T04:52:55.097

将过程包装在一个函数中会起作用吗？如果 Ruby 因没有返回行而出现问题 ( `...can't return a result set in the given context...`)，这可能会解决它：

```
分隔符 $

创建过程 tProc()
开始
    SET @a = '测试';
结尾;
$

创建函数 tFunc()
返回整数
开始
    调用 tProc();
    返回 1；
结尾;
$

分隔符；

从 DUAL 中选择 tFunc()；
>> 1

从双重中选择@a；
>> '测试'

```

虽然，实际上，这不是一个非常可扩展的解决方案。

**跟进：我在 Ruby/ActiveRecord 上很n00by，但这个例子绝对有效**

```
ActiveRecord::Base.establish_connection(authopts)

类 TestClass < ActiveRecord::Base
结尾

test_class = TestClass.new
puts %{#{test_class.connection.select_one('SELECT tFunc() AS tf FROM DUAL')}}
>> tf1

```

使用`CALL tProc()`导致类似于您的错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T05:41:57.587

你在使用 ActiveRecord::Base.connection.execute 吗？此方法应该允许您执行一些在 Active Record 包装器中不受支持的任意 SQL 语句。

# c# - 如何以编程方式从 Visual Studio 安装项目中检索安装程序版本

> ID：471537
> 
> 赞同：1
> 
> 时间：2009-01-23T01:30:07.843
> 
> 标签：c#, installation

我用 C# 编写了一个应用程序，并设置了一个单独的安装项目来为该应用程序创建 MSI 安装程序。我想知道是否可以检索安装程序的版本并将其显示在我的应用程序的“关于”对话框中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T01:39:04.987

通常，您会查看当前程序集的版本以查找此类内容，查找 MSI 需要进行注册表搜索以查找 MSI，然后进行一些互操作以使用某些 COM 接口提取版本。

要开始这些路线，请看这里： http: [//www.codeproject.com/KB/cs/msiinterop.aspx](http://www.codeproject.com/KB/cs/msiinterop.aspx)，这是很多工作。

相反，只需使用：

```
Assembly.GetExecutingAssembly().GetName().Version; 
```

并确保您的应用程序版本与您的 msi 版本相匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T01:44:27.863

MSI 就像一个具有完整 API 的数据库。您的版本号和其他相关数据位于 MSI 的数据库中。

您可以使用类似 sql 的语法查询数据库。

[http://msdn.microsoft.com/en-us/library/aa369426(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa369426(VS.85).aspx)

如何查询的示例：http: [//msdn.microsoft.com/en-us/library/aa372021.aspx](http://msdn.microsoft.com/en-us/library/aa372021.aspx)

更好的示例和脚本：

[http://msdn.microsoft.com/en-us/library/aa368562(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa368562(VS.85).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-19T06:42:12.823

一种想法是将安装程序版本存储在注册表中或在安装时在 application.exe.config 中预定义。稍后关于框从那里加载版本号。

# user-interface - 统领 GTKWindow

> ID：471541
> 
> 赞同：0
> 
> 时间：2009-01-23T01:31:37.543
> 
> 标签：user-interface, gtk, window, gtk#

有没有一种方法可以轻松地让子 GTK 应用程序在父应用程序选择的 GtkWindow 中启动？或者这需要更改 Gtk 库吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T07:25:52.737

如果我正确理解了问题，那么您应该使用 GtkPlug/GtkSocket 将一个应用程序嵌入到另一个应用程序中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T07:47:57.503

有`[GtkSocket::steal()](http://library.gnome.org/devel/gtk/stable/GtkSocket.html#gtk-socket-steal)`一个听起来不错的功能，但它已被弃用。正如 dmitry-vk 所提到的，查看 Socket/Plug 对 API 的其余部分，以了解它现在是如何完成的。

# algorithm - 越差越好。有例子吗？

> ID：471544
> 
> 赞同：49
> 
> 时间：2009-01-23T01:35:32.013
> 
> 标签：algorithm, time-complexity

是否存在一种广泛使用的算法，其时间复杂度*比*另一种已知算法差，但在*所有*实际情况下它都是*更好*的选择（*复杂度更****差****，但其他情况****更好***）？

 ****可接受的答案可能是以下形式：

> 有一些算法具有相应的时间复杂度，但是`A`具有如此大的常数，以至于对于少于宇宙中原子数量的输入 ，它没有任何优势。`B``O(N**2)``O(N)``B``A`

**答案中的示例突出显示：**

*   单纯形算法——最坏的情况是指数时间——*与*用于凸优化问题的已知多项式时间算法相比。

*   中位数算法的天真中位数 - 最坏情况 O(N**2)*与*已知 O(N) 算法。

*   回溯正则表达式引擎——最坏情况指数*与*O(N) 基于 Thompson NFA 的引擎。

所有这些示例都利用了最坏情况与平均情况。

## 是否有不依赖于最坏情况与平均情况之间差异的示例？

* * *

有关的：

*   [“越差越好”的兴起](http://www.jwz.org/doc/worse-is-better.html)。（为了这个问题的目的，“Worse is Better”短语的使用范围比文章中的*更窄*（即算法时间复杂度））

*   [Python的设计理念](http://python-history.blogspot.com/2009/01/pythons-design-philosophy.html)：

    > ABC集团力求完美。例如，他们使用了基于树的数据结构算法，这些算法已被证明对于渐近大型集合是最佳的（但对于小型集合来说并不是那么好）。

    如果没有计算机能够存储这些大型集合（换句话说，在这种情况下大不够大），这个例子就是答案。

*   用于方阵乘法的[Coppersmith–Winograd 算法是一个很好的例子（它是最快的（2008 年），但不如更差的算法）。](http://en.wikipedia.org/wiki/Coppersmith-Winograd_algorithm)**还有其他人吗？** 来自维基百科的文章：“它没有在实践中使用，因为它只为大到现代硬件无法处理的矩阵提供优势（Robinson 2005）。”

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-01-23T01:45:21.883

[快速排序](http://en.wikipedia.org/wiki/Quick_sort)的最坏情况时间复杂度为 O(N^2)，但通常被认为优于其他最坏情况下时间复杂度为 O(N log n) 的排序算法。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-01-23T01:49:20.083

[单纯形](http://en.wikipedia.org/wiki/Simplex_algorithm)是一种在最坏情况下具有指数时间复杂度的算法，但对于任何实际情况，它都是多项式的。[可能存在](http://en.wikipedia.org/wiki/Ellipsoid_method)用于线性规划的多项式算法，但它们非常复杂并且通常具有很大的常数。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-01-23T18:14:35.787

[蒙特卡洛积分](http://en.wikipedia.org/wiki/Monte_Carlo_integration)是一种计算定积分的概率方法，不能保证返回正确答案。然而，在现实世界的情况下，它返回准确答案的速度远远快于可证明正确的方法。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-01-23T02:09:36.237

“越差越好”也可以在语言中看到，例如 Perl、Python、Ruby、Php 甚至 C# 或 Java 背后的想法，或者任何不是汇编程序或 C 的语言（C++ 可能适合这里或不适合这里）。

基本上总有一个“完美”的解决方案，但很多时候最好使用“更差”的工具/算法/语言来更快地获得结果，并且减少痛苦。这就是人们使用这些高级语言的原因，尽管从理想的计算机语言的角度来看它们“更糟糕”，而是更面向人。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2009-02-02T12:03:09.950

[Coppersmith–Winograd 算法](http://en.wikipedia.org/wiki/Coppersmith-Winograd_algorithm)用于方阵乘法。它的时间复杂度是 O(n ^(2.376) ) *vs.* O(n ³ ) 的朴素乘法算法或*vs.* O(n ^(2.807) ) 的[Strassen 算法](http://en.wikipedia.org/wiki/Strassen_algorithm)。

来自维基百科文章：

> 然而，与 Strassen 算法不同的是，它并没有在实践中使用，因为它只为大到现代硬件无法处理的矩阵提供了优势（Robinson 2005）。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-01-23T02:08:55.130

这种说法几乎可以应用于*任何并行算法*。在计算的早期没有对它们进行深入研究的原因是，对于单个执行线程（想想单处理器），它们在渐近复杂度、小*n*的常数因子方面确实比众所周知的顺序对应物慢，或两者。然而，在当前和未来计算平台的背景下，一种可以利用几个（想想多核）、几百个（想想 GPU）或几千个（想想超级计算机）处理元素的算法将击败顺序版本的裤子在挂钟时间内，即使并行版本的所有处理器花费的总时间/能量要大得多。

排序、图算法和线性代数技术等可以通过承担一些额外的簿记、通信和运行时开销来实现并行化，从而在挂钟时间方面加速。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2009-01-23T01:50:03.013

通常会选择易于[并行](http://en.wikipedia.org/wiki/Parallel_algorithm)化或[随机化的算法（如](http://en.wikipedia.org/wiki/Randomized_algorithm)[quicksort](http://en.wikipedia.org/wiki/Quicksort) ）而不是缺乏这些品质的竞争算法。此外，通常情况下，当精确算法会产生指数运行时间时，问题的[近似解](http://en.wikipedia.org/wiki/Approximation_algorithm)是可以接受的，例如[旅行商问题](http://en.wikipedia.org/wiki/Travelling_salesman_problem)。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2009-01-23T13:38:49.340

> 如果没有能够存储这些大型集合的计算机，这个例子就是答案。

据推测，该集合的大小为 641K。

* * *

在 BAE SYSTEMS 的技术计算组工作时，该组负责处理各种飞机的结构和空气动力学代码，我们的代码库至少可以追溯到 25 年前（三分之一的员工在那里工作了那么长时间）。

许多算法针对 16 位大型机的性能进行了优化，而不是针对可扩展性进行了优化。这些优化完全适用于 1970 年代的硬件，但在取代它的 32 位和 64 位系统上的较大数据集上表现不佳。如果您选择的可扩展性较差，但在您当前正在使用的硬件上效果更好，请注意这是一种优化，将来可能不会适用。在编写 1970 年代的例程时，我们在 2000 年代放入其中的数据大小是不切实际的。不幸的是，试图从那些代码中提取一个清晰的算法，然后可以实现以适应现代硬件并不是一件容易的事。

除了使海洋沸腾之外，所谓的“所有实际情况”通常是一个时间相关变量。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-01-29T04:37:27.640

不太符合标准，但是基于回溯的正则表达式与基于 DFA 的正则表达式的 O(N) 相比，具有指数最坏的情况，但几乎总是使用基于回溯的正则表达式而不是基于 DFA 的正则表达式。

编辑：（JFS）

[正则表达式匹配可以简单快速（但在 Java、Perl、PHP、Python、Ruby 等中很慢）](http://swtch.com/~rsc/regexp/regexp1.html)：

> 反向引用增加的力量需要付出巨大的代价：在最坏的情况下，最知名的实现需要指数搜索算法。

[正则表达式引擎](http://www.softec.st/en/OpenSource/DevelopersCorner/RegularExpressions/RegularExpressionEngines.html)：

这种方法（DFA）确实更高效，[甚至可以适应允许捕获和非贪婪匹配](http://laurikari.net/ville/spire2000-tnfa.ps)，但它也有重要的缺点：

*   环顾四周是不可能的
*   反向引用也是不可能的
*   正则表达式预编译时间更长，占用更多内存

从好的方面来说，除了避免最坏情况下的指数运行时间外，DFA 方法还避免了与输入数据大小呈线性关系的最坏情况下的堆栈使用。

[3]：

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2010-11-21T20:59:05.500

一个例子来自计算几何。由于[Chazelle ，](http://en.wikipedia.org/wiki/Bernard_Chazelle)[多边形三角剖分](http://en.wikipedia.org/wiki/Polygon_triangulation)具有最坏情况 O(N) 算法，但由于实现的难度和巨大的常数，它几乎从未在实践中实现。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2011-02-23T16:28:52.897

存在用于确定素数的多项式时间算法，但在实践中，使用指数时间算法或执行足够的概率计算以获得足够的确定性总是更快。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2009-01-23T19:25:08.033

对于固定长度的输入，基数排序的时间复杂度为 O(n)，但尽管渐近运行时间更差，但更常使用快速排序，因为基数排序的每个元素开销通常要高得多。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2009-01-28T03:07:01.910

好的，考虑解决旅行商问题。**唯一**完美的解决方案是测试所有可能的路线。然而，随着 N 的增加，我们的硬件和时间限制变得不可能。所以我们想到了很多启发式方法。

这使我们回答了您的问题。对于 NP 完全问题，启发式（更糟）比蛮力更好。这描述了“越差越好”总是正确的情况。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2009-01-29T02:40:51.777

在计算一组数字的中位数时，可以使用与快速排序非常相似的算法。您围绕一个数字进行分区，所有较大的都到一侧，所有较小的都到另一侧。然后你扔掉一侧并递归计算较大一侧的中位数。这在最坏的情况下需要 O(n^2)，但在平均情况下非常快（O(n)，常数较低）。

您可以获得保证的最坏情况 O(n) 性能，常数约为 40。这称为[中位数算法](http://en.wikipedia.org/wiki/Selection_algorithm#Linear_general_selection_algorithm_-_.22Median_of_Medians_algorithm.22)的中位数。在实践中，你永远不会使用它。

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2009-01-29T19:47:09.687

如果我理解这个问题，那么您要求的算法在理论上更好，但在所有情况下实际上都更差。因此，除非出现错误，否则人们不会期望它们实际被使用。

一个可能的例子是通用[记忆](http://en.wikipedia.org/wiki/Memoization)。从理论上讲，所有可能的输入都应该记住所有确定性函数调用。这样复杂的计算就可以用简单的表格查找代替。对于范围广泛的问题，这种技术有效地用时间换取存储空间。但是假设有一个中央存储库，其中包含所有人类计算机使用的所有可能功能的所有可能输入的结果。第一次有人在任何地方进行计算，那将是最后一次。所有后续尝试都将导致表查找。

但是我可以想到不这样做的几个原因：

1.  存储所有结果所需的内存空间可能大到不可思议。看起来所需的比特数可能会超过宇宙中的粒子数。（但即使是估计这个数字的任务也很艰巨。）

2.  很难构建一个有效的算法来记忆那个巨大的问题空间。

3.  随着客户端数量的增加，与中央存储库通信的成本可能会超过收益。

我相信你可以想到其他问题。

事实上，这种时间/空间权衡在实践中非常普遍。理想情况下，所有数据都将存储在 L1 缓存中，但由于大小限制，您总是需要将一些数据放在磁盘或（可怕的！）磁带上。先进的技术减少了这些权衡的一些痛苦，但正如我上面所说的那样，存在限制。

* * *

回应 JF 塞巴斯蒂安的评论：

假设我们考虑使用阶乘存储库而不是通用记忆存储库。它不会保存所有可能输入的结果。相反，它将仅限于从`1`到的结果`N!` 现在很容易看出，任何进行阶乘的计算机都将从查找结果而不是进行计算中受益。即使计算`(N+1)!`查找也将是一个巨大的胜利，因为该计算将减少到`N!(N+1)`.

现在为了让这个“更好”的算法变得更糟，我们可以增加 N 或增加使用存储库的计算机数量。

但我可能不理解这个问题的一些微妙之处。他们按照我的想法，我不断提出可以很好扩展的示例，直到他们没有。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2009-01-28T12:33:26.433

**合并排序与快速排序**

快速排序的平均时间复杂度为 O( *n* log *n* )。它可以就地对数组进行排序，即 O(1) 的空间复杂度。

归并排序的平均时间复杂度也为 O( *n* log *n* )，但它的空间复杂度要*差得多*：Θ( *n* )。（链表有一种特殊情况）

由于快速排序的最坏情况时间复杂度是 Θ(n^2)（即所有元素都落在每个枢轴的同一侧），而归并排序的最坏情况是 O( *n* log *n* )，归并排序是库的默认选择实施者。

在这种情况下，我认为合并排序的最坏情况时间复杂度的可预测性胜过快速排序低得多的内存需求。

鉴于可以大大降低快速排序时间复杂度最坏情况的可能性（例如通过随机选择枢轴），我认为除了快速排序的病态情况外，合并排序在所有情况下都更糟。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2009-01-23T02:19:58.430

我一直将“越差越好”这个术语理解为与正确解决方案相关的问题，这些问题非常复杂，其中存在相对更容易理解的近似（或足够好的）解决方案。

这使得设计、生产和维护更容易。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2009-01-23T08:59:13.430

有一个 O(n) 算法用于从未排序的集合中选择第 k 个最大元素，但很少使用它来代替排序，这当然是 O(n logn)。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2009-01-29T02:31:01.000

尽管具有 O(n ² ) 复杂度的插入排序对于小型集合 (n < 10) 来说比任何其他排序算法都更快。那是因为嵌套循环很小并且执行速度很快。许多实现了 sort 方法的库（包括 STL）实际上将它用于小数据子集以加快处理速度。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-01-29T05:02:39.557

蒙特卡洛整合已经被提出，但更具体的例子是金融中的蒙特卡洛定价也是一个建议。这里的方法比其他方法更容易编码，可以做更多的事情，但它比有限差分慢得多。

做 20 维有限差分算法并不实用，但 20 维定价执行很容易设置。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2010-05-31T05:03:37.397

[意大利面条排序](http://en.wikipedia.org/wiki/Spaghetti_sort)比任何其他排序算法都要好，因为它的设置时间为 O(n)，执行时间为 O(1)，提取排序数据的时间为 O(n)。它以 O(n) 的空间复杂度完成了所有这些工作。（总体性能：在时间和空间上都是 O(n)。）然而，由于一些奇怪的（显而易见的）原因，没有人将它用于任何事情，更喜欢远低于 O(nlogn) 算法及其同类。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2019-09-13T20:20:23.083

1.  Y-fast-trie 对于后继/前任有复杂的 loglogu 时间，但它具有相对较大的常数，因此 BST（即 logn）可能更好，这是因为 log(n) 在任何实际使用中都非常小，所以常数很重要最多。

2.  融合树的查询复杂度为 O(logn/loglogu)，但常量非常大，BST 可以在 logn 中实现相同的结果，这再次更好（loglogu 也非常小，因此 O(logn/loglogu)=O(logn) 对于任何实际原因）。

3.  确定性中值算法非常慢，即使它是 O(n)，所以使用排序 (nlogn) 或概率版本（理论上可能需要 O(n!) 但很有可能需要 O(n) 和概率它需要 T*O(n) 随 T 呈指数下降，并且 n) 要好得多。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2010-05-31T04:16:13.313

**迭代深化**

[与使用alpha-beta 修剪](http://en.wikipedia.org/wiki/Alpha-beta_pruning)增强的普通深度优先搜索相比，与较差（或不存在）的分支排序启发式结合使用的[迭代加深](http://en.wikipedia.org/wiki/Iterative_deepening_depth-first_search)搜索将导致扫描更多节点。然而，当使用良好的分支排序启发式时，由于 alpha-beta 修剪的增强效果，树的很大一部分被消除了。与时间或空间复杂性无关的第二个优势是，对问题域的解决方案的猜测是早期建立的，并且随着搜索的进行，猜测会得到细化。正是这第二个优势使它在许多问题领域如此具有吸引力。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2013-07-12T17:17:28.460

```
Quick-sort has worst case time complexity of O(N^2)! 
It is considered better than other sorting algorithms 
like mergesort heapsort etc. which have O(N log n) time complexity 
in the worst case.
The reason may be the 
1.in place sorting 
2.stability, 
3.very less amount of code involved. 
```

# python - 有什么方法可以覆盖 Python 中的 and 运算符？

> ID：471546
> 
> 赞同：39
> 
> 时间：2009-01-23T01:36:42.417
> 
> 标签：python

我尝试了覆盖`__and__`，但那是 & 运算符，而不是*和*- 我想要的那个。我可以覆盖*and*吗？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-01-23T01:44:25.740

不，您不能覆盖`and`and `or`。由于这些在 Python 中的行为（即短路），它们更像是控制流工具而不是运算符，并且覆盖它们更像是覆盖`if`而不是 + 或 -。

您*可以*`__nonzero__`通过覆盖（或`__bool__`在 Python 3 中）来影响对象的真值（即它们评估为真还是假）。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-01-23T01:42:34.730

您不能覆盖`and`、`or`和`not`布尔运算符。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-23T01:41:49.897

并不真地。短路逻辑运算符没有特殊的方法名称。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-02-28T01:31:59.430

虽然你不能重载`__and__`你可以使用中[缀](http://tomerfiliba.com/blog/Infix-Operators/)来重载和。在这种情况下，您将使用 &and& 来表示 and 运算符。

# c# - 在 Visual C# 中移动菜单

> ID：471548
> 
> 赞同：4
> 
> 时间：2009-01-23T01:38:11.727
> 
> 标签：c#, visual-studio, visual-studio-2008

我有一个具有以下结构的菜单（为便于说明而简化）：

```
Menu Bar
 |--File
 |   |--Save
 |   |--Exit
 |--Tools
 |   |--Tool Category 1
 |   |--Tool Category 2
 |   |--Tool Category 3
 |--Help
     |--About 
```

我想重建如下：

```
Menu Bar
 |--File
 |   |--Save
 |   |--Exit
 |--Tool Category 1
 |--Tool Category 2
 |--Tool Category 3
 |--Help
     |--About 
```

但是，在 Visual Studio 2008 Pro 中，除了在它们已经在的特定菜单组中重新组织它们之外，它不会让我拖动这些菜单项。有没有办法让我在不完全重建菜单栏的情况下移动它们？请注意，实际上菜单项比我展示的要多得多。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-12-16T19:53:45.210

您还可以转到菜单项的设计器代码。您会发现类似以下的代码：

```
 this.mnuInfo.Items.AddRange(
          new System.Windows.Forms.ToolStripItem[] {
             this.mniAddNewProject,
             this.mniAddNewWorkFlow,      
             this.mniDeleteProject
          }
       ); 
```

添加要将现有菜单项移动到其中的菜单项，然后修改然后移动这些项。

```
 this.mnuInfo.Items.AddRange(
          new System.Windows.Forms.ToolStripItem[] {
             this.mniAddNewProject
          }
       );
       this.newMenuItem.Items.AddRange(
          new System.Windows.Forms.ToolStripItem[] {
             this.mniAddNewWorkFlow,      
             this.mniDeleteProject
          }
       ); 
```

就是这样。我希望这有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-23T01:47:38.153

我试过了，它奏效了：

1.  右键单击要移动的菜单项
2.  在上下文菜单中选择“剪切”
3.  右键单击要移动的菜单条
4.  在上下文菜单中选择“粘贴”

希望能帮助到你。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T01:42:43.730

只需从头开始重做菜单，有时最好重新开始！:-)

# python - 在 Django 中自定义管理表单，同时使用自动发现

> ID：471550
> 
> 赞同：26
> 
> 时间：2009-01-23T01:38:17.500
> 
> 标签：python, django, forms, django-admin, customization

我想修改 Django 内置`django.contrib.auth`模块的一些小细节。具体来说，我想要一个不同的表单，使用户名成为电子邮件字段（并通过电子邮件发送备用电子邮件地址。（我宁愿不进行`auth`任何必要的修改——*似乎*只需要一个简单的表单更改。）

当我使用`autodiscover`自定义`ModelAdmin`的 for时，`auth`我最终会与`auth`自己的管理界面发生冲突并出现“已注册”错误。

看起来我必须创建自己的管理站点，枚举我所有的模型。它只有 18 个类，但似乎是一个 DRY 问题——每次更改都需要添加到模型**和**自定义管理站点。

或者，我是否应该编写自己的“`autodiscover`带排除”版本来基本上导入**除 之外**`admin`的所有模块？ **`auth`**

 *** * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-01-23T02:22:18.473

以上都不是。只需使用 admin.site.unregister()。这是我最近在管理员的 is_active 上添加过滤用户的方式（**nb** is_active 过滤现在默认在 Django 核心中的用户模型上；仍然作为示例在这里工作），所有 DRY 都可以：

```
from django.contrib import admin
from django.contrib.auth.admin import UserAdmin
from django.contrib.auth.models import User

class MyUserAdmin(UserAdmin):
    list_filter = UserAdmin.list_filter + ('is_active',)

admin.site.unregister(User)
admin.site.register(User, MyUserAdmin) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-23T11:30:25.947

我认为使用自定义身份验证后端执行此操作可能更容易，因此无需自定义 ModelAdmin。

我用这个片段做了类似的事情：http: [//www.djangosnippets.org/snippets/74/](http://www.djangosnippets.org/snippets/74/)

# sql-server - Ruby on Rails 和 MSSQL Server：尝试使用 newid() 默认值插入行

> ID：471569
> 
> 赞同：2
> 
> 时间：2009-01-23T01:44:32.900
> 
> 标签：sql-server, ruby-on-rails, uniqueidentifier

（这个问题最初是几个月前在另一个论坛上发布的，没有得到任何答案......这些时候没有SO！）

我在 RoR 的第一步。我买了一本关于 Ruby 和 Ruby On Rails 的书。示例在 MySQL 上运行正确，所以我决定为 MS-SQL 重写它们作为一个很好的练习（因为 MS-SQL 是我们的标准数据库）......它变成了一个噩梦：

我有这个有 2 个字段的表

```
Tbl_People
----------
id_People        primary key, newid() default value,
namePeople       string 
```

我有一个到数据库的 ODBC 连接。我可以列出记录，但是……我不能在表中插入任何内容。Ruby 生成的 INSERT 字符串如下：

```
INSERT INTO Tbl_People (id_People, namePeople) VALUES('newid','GRONDIER, Philippe') 
```

并且将被拒绝，因为字符串 'newid' 不能插入到 uniqueindentifier/primary key field 中`id_People`。从逻辑上讲，返回的错误是：

```
DBI::DatabaseError: 37000 (8169) [Microsoft] [ODBC SQL Server Driver][SQL Server]Conversion failed when converting from a character string to uniqueidentifier 
```

这似乎是一个大而基本的问题，我觉得我错过了通常在每个 RoR 培训文档上用粗体写的东西，例如“不要尝试通过 RoR 插入”、“uniqueIdentifier is Chinese to RoR”或“RoR does '不适用于 MS SQL Server'...

任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T01:51:42.997

我不是 Ruby 人，所以请记住这一点。其中大部分只是在 MySQL->MSSQL 翻译 IMO 中丢失了。

因此，您的 id 属于“uniqueidentifier”类型。应该发生以下两件事之一：

a) 你应该传入 NEWID() 作为第一个参数。不是字符串“newid”，而是函数 NEWID()

b) 不要传入第一个参数。由于有默认值，只需插入 NamePeople 列。

根据使用情况，如果您正在处理分布式数据，我只会使用 uniqueidentifier 主键，并且对于大多数键引用坚持使用良好的旧 INT IDENTITY 列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T01:59:27.050

查看这篇文章，不同的数据库类型，但本质上是相同的问题，如何从 RoR 隐藏默认字段，因此不会生成无效插入。

**编辑**@wayne-conrad 指出旧链接已失效。我相信内容是在这里找到的， http: [//inodes.org/2008/01/11/rails-activerecord-mysql-guids-and-the-rename_column-bug/](http://inodes.org/2008/01/11/rails-activerecord-mysql-guids-and-the-rename_column-bug/)

关键摘录如下。

该页面的评论部分还引用了一个旨在解决问题的项目 [https://github.com/cch1/uuid_primary_key/tree/master](https://github.com/cch1/uuid_primary_key/tree/master)（链接现在不会让我失望！）

```
 # HACK (JF) - This is too evil to even blog about
  # When we use guid as a primary key we usually rename the original 'id'
  # field to 'integer_id'. We need to hide this from rails so it doesn't
  # mess with it. WARNING: This means once you use usesguid anywhere you can
  # never access a column in any table anywhere called 'integer_id'

class ActiveRecord::Base
  private
    alias :original_attributes_with_quotes :attributes_with_quotes

    def attributes_with_quotes(include_primary_key = true, include_readonly_attributes = true)
      quoted = original_attributes_with_quotes(include_primary_key = true, include_readonly_attributes = true)
      quoted.delete('integer_id')
      quoted
    end
end 
```

# macos - 如何将自定义协议映射到 Mac 上的应用程序？

> ID：471581
> 
> 赞同：38
> 
> 时间：2009-01-23T01:49:55.260
> 
> 标签：macos, protocols, protocol-handler, custom-url-protocol

我正在尝试将自定义协议注册到 Mac 上的应用程序，即：

1.  用户点击带有“abcdef://some/url/here”的链接
2.  使用上述字符串作为第一个参数传递的已安装应用程序启动

我已经使用此问题的信息在 Windows 上成功完成了此操作：

[如何创建自己的 URL 协议？（例如所以：//...）](https://stackoverflow.com/questions/389204/how-do-i-create-my-own-url-protocol-e-g-so)

我更愿意找到与浏览器无关的东西，换句话说，在操作系统级别。我还想通过一个 shell 脚本来自动化这个注册，所以希望有一种不涉及 GUI 的方法来做到这一点。

谢谢！

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-23T02:13:01.063

我没有机会使用它，但前段时间我[**为 OS X URL 处理程序添加了书签，以打开指向本地文件的链接，**](http://hublog.hubmed.org/archives/001154.html)这正是您正在寻找的。

链接过程的重要部分是向[`CFBundleURLTypes`](http://developer.apple.com/library/ios/documentation/general/Reference/InfoPlistKeyReference/Articles/CoreFoundationKeys.html#//apple_ref/doc/uid/TP40009249-102207-TPXREF115)应用程序的 Info.plist 添加一个合适的描述方案。那里给出的示例如下所示：

```
<key>CFBundleURLTypes</key>
<array>
    <dict>
        <key>CFBundleURLName</key>
        <string>Local File</string>
        <key>CFBundleURLSchemes</key>
        <array>
            <string>local</string>
        </array>
    </dict>
</array> 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2010-09-13T21:02:14.100

在 Mac 上，使用 AppleScript 很容易做到这一点。最详细的描述在这篇文章中，[从 Mac 上的网页链接启动脚本](http://www.macosxautomation.com/applescript/linktrigger/)。我会阅读该页面，因为它包含完整的演练和完整的工作示例以供下载。

基本上，您在脚本中创建一个事件处理程序：

```
on open location this_URL
    display dialog "I'm doing something with this URL: " & return & this_URL
end open location 
```

然后将其保存为应用程序。然后在 Finder 中使用 Show Package Contents 编辑 Info.plist。您向应用程序添加一些属性以将其注册为您的协议的处理程序。

```
<key>CFBundleURLTypes</key>
<array>
    <dict>
        <key>CFBundleURLName</key>
        <string>Cliff's handler</string>
        <key>CFBundleURLSchemes</key>
        <array>
            <string>abcdef</string>
        </array>
    </dict>
</array> 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2019-01-22T03:08:20.490

这个问题已经有十年历史了（！）但是谷歌搜索把我带到了这里，所以我想提一下我刚刚发现的一些东西。

[Platypus](https://github.com/sveinbjornt/Platypus)是一个开源工具，允许您从 shell 脚本或其他脚本语言创建独立的“应用程序”。尽管它实际上只是一个脚本包装器，但它确实启用了一些很酷的东西，例如对话框和菜单栏项。

至关重要的是，它甚至可以让您将“应用程序”注册为您自己的自定义 URL 方案的处理程序。从文档：

> 注册为 URI 方案处理程序使应用程序注册为 URI 方案的处理程序。这些可以是标准的 URI 方案，例如 http，也可以是您选择的自定义 URI 方案（例如 myscheme://）。如果您的应用是 URI 方案的默认处理程序，则每次打开与该方案匹配的 URL 时，它都会打开。然后将该 URL 作为参数传递给脚本。

设置非常简单。只需提供您的脚本，在高级设置页面上输入您想要的方案名称，然后单击以构建应用程序（这一切都是自动化的）。方案和正斜杠之后的所有内容都将作为参数传递给您的脚本。

例如，您可以使用以下 bash 脚本作为“speak://”协议的处理程序。

```
#!/usr/bin/env bash
# The 'say' command on macOS will speak the provided text through the speaker
say $1 
```

`speak://say-something-funny`您可以通过进入浏览器或使用`open`命令行上的命令来调用它：

```
$ open "speak://hello-from-the-command-line" 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2014-09-02T11:40:43.563

截至今天，我发现在 Mac 上以最少的开销解决这个问题的最佳方法是使用命令行[duti](https://github.com/moretension/duti)，它允许我在一个非常简单的文本文件中定义我的所有关联：

> 冲泡安装杜蒂

你将需要两件事。您要关联的应用程序的第一个捆绑包 ID：

> mdls -name kMDItemCFBundleIdentifier /Applications/MacVim.app

其次是文件类型的 UTI，[Apple 提供了一个 list](https://developer.apple.com/library/ios/documentation/Miscellaneous/Reference/UTIRef/Articles/System-DeclaredUniformTypeIdentifiers.html#//apple_ref/doc/uid/TP40009259-SW1)，但您也可以像这样探索您的应用程序支持的 UTI：

> mdls -name kMDItemContentTypeTree /Applications/MacVim.app

现在在系统中的某处创建一个文本文件，将捆绑包 ID 与 UTI 相关联：

```
# ~/.default-apps.duti
#
# bundle id       UTI                  role
com.apple.Safari  public.html          all
org.vim.MacVim    txmt
org.vim.MacVim    public.ruby-script 
```

请注意，我可以关联像 txmt 这样的 URL 处理程序以及像 Ruby 脚本这样的文件类型。

在该文件中，我会跟踪我所有的应用程序首选项，并在全新安装后或在其他 Mac 上获得帐户时立即重现它们：

```
duti ~/.default-apps.duti 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-23T02:33:41.007

Jay 的答案中链接页面的重要部分是 Info.plist 中的条目。

我认为使用 Launch Services 如果它是唯一可以处理特定 URL 方案的应用程序，它将自动打开此应用程序，否则您需要使用 Charlie Martin 描述的技巧。

我不确定需要执行的默认命令是什么，或者它是否是 launchctl 命令。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-23T02:04:19.257

挖掘细节很困难，但是有一个名为[RCDefaultApp](http://www.rubicode.com/Software/RCDefaultApp/)的首选项窗格会为您处理它。我仍然很想知道它是如何工作的，将继续挖掘。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-12-26T08:54:50.730

我对 Mac 没有太多经验，因此将不胜感激。

尝试在**包**安装程序的安装后脚本中运行**duti**添加我的自定义协议：

 **```
#!/bin/sh
## 
##  add_handlers.sh -- register UTI handlers for the MyApp
##
##  Requires the duti tool
##

./duti -s MyApp myapp 
```

该处理程序出现在 RCDefaultApp 首选项窗格中，但是当从我的其他应用程序调用时，它会在地址栏中使用该协议打开 Safari，询问“您是否要允许此页面打开“MyApp”？单击“允许”时会显示错误：

**Safari 无法打开指定地址。** *Safari 无法打开“myapp://”，因为 macOS 无法识别以“myapp:”开头的 Internet 地址。*

同样在尝试从终端打开时：

deploy@mini-mac-mini ~ % **open myapp://**

*对于 URL myapp://，LSOpenURLsWithRole() 失败，出现错误 -10810。*

# sql - SQL 2005 中带有 XML 列的 ORDER BY 语法

> ID：471586
> 
> 赞同：2
> 
> 时间：2009-01-23T01:51:03.310
> 
> 标签：sql, xml, xpath

我有一个用户配置文件（基于用户类型的多个配置文件），我将其存储在数据库列（xml）中。

我可以在我的存储过程中使用 XPATH 对此进行查询，但是我不确定如何执行 ORDER BY。

```
SELECT U.UserId, UP.Profile, UP.UserParentID
FROM aspnet_Users U
LEFT OUTER JOIN UserProperties UP ON U.UserId = UP.UserId
WHERE
UP.Profile.exist('/Properties/property[contains(.,sql:variable("@cLookup"))]') = 1 
```

示例 XML：

```
<Properties>
            <property id="BusinessName" name="Business Name"></property>
            <property id="AccountNumber" name="Account Number"></property>
            <property id="Address" name="Address"></property>
            <property id="Phone" name="Phone"></property>
            <property id="Fax" name="Fax"></property>
            <property id="Web" name="Web"></property>
            <property id="ABN" name="ABN"></property>
            <property id="Logo" name="Logo"></property>
            <property id="Photos" name="Photos"></property>
            <property id="Map" name="Location Map"></property>
        </Properties> 
```

和

```
<Properties>
            <property id="FirstName" name="First Name"></property>
            <property id="LastName" name="Last Name"></property>
        </Properties> 
```

想要按商家名称订购

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-23T04:06:08.153

考虑这个答案正在进行中，因为我不确定这是正确的查询。

答案在于将 .nodes() 函数与 .value() 结合使用，因此您可以将“name”属性的值从元素中提取出来，并将“BusinessName”作为“id”属性的值。

这里有一些使用 .nodes() 替换旧的 OPENXML 语法的[指南](http://www.mssqltips.com/tip.asp?tip=1609)。

无论如何，这是目前的查询。在您的数据上尝试一下，看看我们是否可以调整它直到它起作用。

```
SELECT U.UserId, UP.Profile, UP.UserParentID
FROM aspnet_Users U
    LEFT OUTER JOIN UserProperties UP ON U.UserId = UP.UserId
    OUTER APPLY UP.Profile.nodes('/Properties/property') p(prof)

WHERE UP.Profile.exist('/Properties/property[contains(.,sql:variable("@cLookup"))]') = 1
    AND p.prof.value('@id', 'nvarchar(20)') = 'BusinessName'

ORDER BY p.prof.value('@name', 'nvarchar(100)') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T06:17:49.607

您可能想要查看的另一个选项是计算列，特别是如果您有一个或几个经常需要的列。

一般来说，计算列就是这样 - 一个具有从其他东西计算的值的列，并且随时都是最新的，而无需您一直刷新它。

结合 XML，您可以编写一个小型存储函数，并使用它在“基本”表上创建一个计算列，这样您就可以按该列查询和排序，而不必一直“进入”XML。

在您的情况下，您可以编写一个存储函数来检索“BusinessName”并使其在您的 UserProfile 表中可用，如下所示：

```
CREATE FUNCTION dbo.GetBusinessName(@input XML)
RETURNS VARCHAR(50)
WITH SCHEMABINDING
AS BEGIN
  DECLARE @Result VARCHAR(50)

  SELECT 
    @Result = @input.value('(Properties/property[@id="BusinessName"]/@name)[1]', 'VARCHAR(50)')

  RETURN @Result
END 
```

This defines a stored function that will take your profile XML and go look for the "property" with the "id" of "Business Name" and returns its "name" attribute back.

To add this to your UserProfile table, use this SQL code:

```
ALTER TABLE UserProfile
    ADD BusinessName AS dbo.GetBusinessName(Profile) PERSISTED 
```

With this, you add a new computed field called "BusinessName" to your table, and from now on, you can select and order by using this new field, e.g.

```
SELECT ID, BusinessName FROM UserProfiles ORDER BY BusinessName 
```

Enjoy!

PS: A word about performance: I have found in many cases, this is *much* faster than constantly keeping to query your XML in an XML field. So if you have certain elements in your XML that you need access to frequently, or that might show up in an ORDER BY statement, using a computed column can actually speed things up considerably.

# jquery - ajax 调用 我在我的网站上使用 jQuery，我的项目有一个更新部分，我有三个下拉列表： 完成了吗？工作时间 谁参与了这个项目？我正在尝试使用 jQuery 创建一个 ajax 调用，当我选择它时，调用 $.ajax() 并将数据发送到我的 php 页面以更新我的 mysql 数据库。我猜我可以这样做：在选择中获取数据并存储在变量中，然后使用 $.ajax 将其作为数据发送，但我不确定在选择然后运行 ajax 后如何捕获值？有什么建议么？我会使用 jQuery post 方法..

> ID：471589
> 
> 赞同：1
> 
> 时间：2009-01-23T01:52:26.770
> 
> 标签：jquery, ajax, html-select

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T11:38:43.840

正如 FryGuy 所说，$.post 方法可能是你最好的选择，尽管我会这样安排：

```
$("#project select").change(function(){ // use one selector for all 3 selects
    $.post("someurl.php",{
        // data to send
        completed: $("select#completed").val(),
        hours:     $("select#hours").val(),
        who:       $("select#who").val()
    }, function(data) {
        // do callback stuff with the server response 'data' here
    });
}); 
```

如果三个选择在页面上多次出现，这可能不是您想要的。我建议通读 jquery 文档以处理事件。至于提取数据，您只需要在需要它们的时候使用选择器和方法，如, `.text()`,`.val()`等。你想要的信息总是在 DOM 的某个地方。`.html()``.attr()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T02:23:38.283

我会使用[jQuery post 方法](http://docs.jquery.com/Ajax/jQuery.post).. 类似：

```
$.post("updater.php", { completed: variableWithCompletedFromSelect } ); 
```

只需在 select 的 on change 事件中调用它，然后传入 select 的值。然后您的 php 脚本将具有新值的 $_POST['completed'] 。

# c# - 将项目集合从列表框转换为通用列表

> ID：471595
> 
> 赞同：45
> 
> 时间：2009-01-23T01:54:27.687
> 
> 标签：c#, list, casting, listbox

我想找到一种更好的方法来从 C# 中的选中列表框中填充通用列表。

我可以很容易地做到以下几点：

```
List<string> selectedFields = new List<string>();

foreach (object a in chkDFMFieldList.CheckedItems) {
         selectedFields.Add(a.ToString());
         } 
```

必须有一个更 elagent 的方法来将 CheckedItems 集合投射到我的列表中。

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-01-23T02:00:13.103

**试试这个（使用 System.Linq）：**

`OfType()`是一种扩展方法，所以你需要使用`System.Linq`

```
List<string> selectedFields = new List<string>();
selectedFields.AddRange(chkDFMFieldList.CheckedItems.OfType<string>()); 
```

或者只是在一行中完成：

```
List<string> selectedFields = chkDFMFieldList.CheckedItems.OfType<string>().ToList(); 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-07-09T18:18:25.930

这不完全是您要求的答案，而是发布了一个更一般的答案。你可以通过多种方式做到这一点：

1)

```
T[] items = new T[lb.Items.Count];
lb.Items.CopyTo(items, 0);
var lst = new List<T>(items); 
```

2）循环和添加使用`foreach`你提到的。

3）使用Linq

```
var lst = lb.Items.Cast<T>().ToList(); 
```

4) 或

```
var lst = lb.Items.OfType<T>().ToList(); 
```

当我进行如下的一些性能测试时，我发现复制到数组方法最快，而 Linq 方法较慢。当然，在现实世界的场景中，这些都无关紧要。为了可读性，我更喜欢第三种方法（Linq）。

```
DateTime d = DateTime.Now;
for (int i = 0; i < 10000; i++)
{
    Action();
}
MessageBox.Show((DateTime.Now - d).TotalMilliseconds.ToString()); 
```

对于 10000 次的迭代，在列表框中使用大约 300 个项目多次运行，

1) ~100ms

2) ~150ms

3) ~250ms

4) ~260ms

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T02:00:58.110

如果您无权访问 LINQ，那么没有更优雅的方法，因为`ToString()`除了填充 selectedFields 集合之外，您还要对列表项（调用）执行第二次操作。

# jquery - 在jQuery中将所有hrefs作为数组获取

> ID：471606
> 
> 赞同：10
> 
> 时间：2009-01-23T01:58:34.883
> 
> 标签：jquery, html

我的代码如下所示：

```
<ul id="ulList">
  <li class="listClass" id="id1"><a href="http://link1">Link 1</a></li>
  <li class="listClass" id="id2"><a href="http://link2">Link 2</a></li>
  <li class="listClass" id="id3"><a href="http://link3">Link 3</a></li>
</ul> 
```

现在我想得到以下内容：

所有链接作为一个数组

li 的所有 id 作为一个数组

有人能帮助我吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-23T02:16:28.297

```
var ids = 新数组（）；
var hrefs = new Array();
$('#ulList li').each(function(){
  ids.push($(this).attr('id'));
  hrefs.push($(this).find('a').attr('href'));
})

```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-01-16T12:55:14.187

我知道这是旧的，但是因为我喜欢 jQuery 允许您编写的单行器，所以我想我会添加它：

```
var allLinks = $('#ulList a').map(function(i,el) { return $(el).attr('href'); }).get();
var allIds = $('#ulList li').map(function(i,el) { return $(el).attr('id'); }).get(); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-03-06T02:11:34.430

偶然发现了这个问题并想出了一个更可重用的答案：

```
$.fn.collect = function(fn) {
    var values = [];

    if (typeof fn == 'string') {
        var prop = fn;
        fn = function() { return this.attr(prop); };
    }

    $(this).each(function() {
        var val = fn.call($(this));
        values.push(val);
    });
    return values;
};

var ids = $('#ulList li').collect('id');
var links = $('#ulList a').collect('href'); 
```

您还可以将函数传递给 collect ，如下所示：

```
var widths = $('#ulList li').collect(function() {
    return this.width();
}); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-23T02:14:42.857

这应该有效。

```
var ids = [],
    hrefs = []
;   
$('#ulList')
    .find('a[href]')  // only target <a>s which have a href attribute
        .each(function() {
            hrefs.push(this.href);
        })
    .end()
    .find('li[id]')   // only target <li>s which have an id attribute
        .each(function() {
            ids.push(this.id);
        })
;

// ids = ['id1', 'id2', 'id3']
// hrefs = ['http://link1', 'http://link2', 'http://link3'] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-02-01T15:15:58.227

```
var links = [], ids = [];
var $ul = $('#ulList');
var $lis = $ul.children('li');
var $as = $lis.children('a');

for(var count = $lis.length-1, i = count; i >= 0; i--){
    ids.push($lis[i].id);
    links.push($as[i].href);
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-06-14T18:28:57.563

如果您喜欢一个衬里并且讨厌必须实例化一个空数组。

```
[]
  .slice
  .call($('#ulList a'))
  .map(el => el.getAttribute('href')) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-07-16T05:43:19.930

与 Grimace 提供的代码相同，但在 ES6 中

```
const allLinks = $('#ulList a').map((i,el) => $(el).attr('href')).get();
const allIds = $('#ulList li').map((i,el) => $(el).attr('id')).get(); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-07-26T21:40:34.223

我是来找单线的。这是我想出的：

`var hs=[]; $('a').each(function(i,a){hs.push(a.href);}); hs;`

# hardware - Microsoft.PointOfService 库

> ID：471611
> 
> 赞同：1
> 
> 时间：2009-01-23T01:59:38.127
> 
> 标签：hardware, point-of-sale, pos-for-.net

我将使用 Microsoft.pointofservice 库与销售点硬件进行通信。微软没有太多关于这个库的文档。因此，在我和其他 5 位开发人员花时间在此之前，如果有人曾经使用过它，我想先看看这个库。

请建议有任何其他方式与硬件统一通信。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T05:02:11.070

我简要地使用了其中的一部分直接与收据打印机 Epson TM-88III 对话。如果我没记错的话，一个奇怪的地方是该框架附带了一个设置实用程序，您可以使用该实用程序在该框架中全局注册设备。

我不能说图书馆的大部分内容。但是 POSPrinter 类有效！

# svn - Subversion 合并来自不同存储库的更改

> ID：471618
> 
> 赞同：45
> 
> 时间：2009-01-23T02:01:52.367
> 
> 标签：svn

我真的很困惑。我想做一些 a) 看起来*应该*很简单的事情，并且 b) 其他人必须一直这样做，但我无法在任何地方找到最好的方法。

有一个包含一些第 3 方代码的外部存储库。我想复制版本 1 的代码并将其放在我自己的存储库中，然后根据自己的需要对其进行自定义。当该代码的第 2 版发布时，我希望能够使用第 2 版的所有更改来升级我的定制版本，同时保留我的定制。

我已经阅读了供应商分支（[http://svnbook.red-bean.com/en/1.5/svn.advanced.vendorbr.html](http://svnbook.red-bean.com/en/1.5/svn.advanced.vendorbr.html)），但我不明白为什么要合并供应商代码的前一个副本和新的供应商代码的副本需要如此复杂（即 svn_load_dirs.pl）。当然，如果第 3 方代码存储在 SVN 存储库中，则所有关于哪些文件已移动/被删除的历史都是已知的，那么为什么需要手动告诉它发生了什么更改？

引用：

> 例如，您将有机会告诉脚本您知道 libcomplex 1.0 版中的文件 math.c 在 libcomplex 1.1 中被重命名为算术.c。

我也读过（[http://svn.haxx.se/users/archive-2006-04/0285.shtml](http://svn.haxx.se/users/archive-2006-04/0285.shtml)）可以简单地在不同的存储库之间运行合并，但我不认为这是可能的，并且无论何时我尝试过它都失败了（尽管我可能做错了什么）。

任何人都可以为我澄清这一点，并提出最佳解决方案吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-23T02:48:28.450

我刚刚用 TortoiseSVN 做了一个简短的实验：

**创建测试存储库**

1.  在 rep1 和 rep2 中创建两个新的存储库
2.  将 rep1 签出到 co1
3.  将文本文件添加到 co1 并签入
4.  将 rep1 导出到 ex1
5.  将 ex1 导入 rep2

在这个阶段，您将处于在新存储库中创建本地“分支”的状态。现有项目只需要最后两个步骤。

要模拟对原始 repo 的一些更改，请修改 co1 中的文本文件并提交更改。

**合并更改**

现在，要创建自己的工作副本，请将 rep2 签入 co2。

我们应该准备好尝试从 rep1 合并到 co2。

打开 co2 的合并对话框并将其指向 rep1。

对于“来自”修订版，请选择您导出副本的修订版（在本例中为修订版 1），或者您上次将本地副本更新到的修订版。

对于“to”版本，选择您要应用的 HEAD 或最新更新。

**结果**

这似乎按预期工作，rep1 的修改被应用于 co2 中 rep2 的工作副本。然后需要将这些提交回您的本地存储库。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-23T03:02:13.447

您提供的供应商分支链接确实有效地描述了您想要做什么的过程。相对于允许您直接更新（导入）供应商分支，这是一个完美的解决方案，然后正如您所暗示的那样，它将允许您将供应商的更新与您在主开发分支中的更改合并。

问题是 Subversion 确实不提供对文件重命名和目录之间文件移动的直接支持，以便从供应商代码进行连续更新，因为您只是获取源文件内容的快照......需要运行命令进入版本系统以指示正在对构成新版本的文件名树进行哪些更改。这是 svn_load_dirs.pl 脚本进程的目的。它可以帮助您操纵您的版本历史以匹配分支，以便您可以继续进行合并。如果供应商没有在您导入的版本之间重命名和/或移动文件，您就不会有这个问题。

无论如何，描述的过程是您/需要做的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-23T02:56:09.323

我自己没有尝试过多次回购，但我不明白为什么你不能使用你的第二个链接的建议。

svn merge ORIGINAL@REV UPGRADE@REV LOCAL_PATH

这有效地告诉 SVN 在原始结帐和您想要的版本之间进行所有更改，并将它们应用到您的本地副本。

Protip：我总是使用显式修订并将合并命令包含在提交消息中，以便我可以轻松查看历史记录并了解如何重现或撤消更改。

# ruby-on-rails - 简单的 Rails 路由情况

> ID：471629
> 
> 赞同：4
> 
> 时间：2009-01-23T02:05:37.367
> 
> 标签：ruby-on-rails

我正在创建一个由故事组成的 Ruby on Rails 应用程序。每个故事都有多个页面。

如何设置 routes.rb 以便我可以拥有这样的 URL：

```
http://mysite.com/[story id]/[page id] 
```

像：

```
http://mysite.com/29/46 
```

目前我正在使用这种设置：

```
http://mysite.com/stories/29/pages/46 
```

使用：

```
ActionController::Routing::Routes.draw do |map|

  map.resources :stories, :has_many => :pages
  map.resources :pages

  map.root :controller => "stories", :action => "index"

  map.connect ':controller/:action/:id'
  map.connect ':controller/:action/:id.:format'

end 
```

提前致谢。我是 Rails 的新手，现在路由对我来说似乎有点复杂。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-23T02:15:08.267

[这是](http://keironwaites.com/2008/10/ruby-on-rails-routing-simple-examples.html)一个很好的资源。

```
map.connect 'stories/:story_id/:page_num', :controller => "stories", :action => "index", :page_id => nil 
```

在您的控制器中：

```
def index
  story = Story.find(params[:story_id])
  @page = story.pages[params[:page_num]]
end 
```

更新：刚刚注意到你不想出现“故事”。不确定是否从 map.connect 中删除它会起作用......试试看。

```
map.connect '/:story_id/:page_num', ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T03:01:50.437

鉴于路线

```
map.connect '/:story_id/:id', :controller => 'pages', :action => 'show' 
```

您可以在控制器中执行此操作

```
def show
  @story = Story.find(:story_id)
  @page = @story.pages.find(:id)
end 
```

现在您可以使用故事 ID 获取页面。

PS：`map.connect ':story_id/:id'` *应该*工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T03:17:24.943

我不确定为什么没有人建议只使用命名路线。就像是

```
map.story '/:story_id/:page_id', :controller => 'stories', :action => 'show' 
```

那么你可以用它来调用它

```
story_path(story.id,params[:page}) 
```

或类似的东西。

# configuration-management - 管理可重用组件

> ID：471630
> 
> 赞同：1
> 
> 时间：2009-01-23T02:06:53.433
> 
> 标签：configuration-management

我有项目 A 和 B。两个项目都使用组件 C（例如图形库）。我收到一份报告 A 有错误的问题单。我确定这个错误确实在 C 组件中。我为 C 创建了一个分支，修复它，重新签入，重新标记它，更改对 A 的依赖关系并创建一个新的 A 安装。

问题：如何让 B 知道其 C 组件的更改，以便它可以从 A 中检测到的错误修复中受益？什么是控制这种配置管理场景的好工具/脚本？我尝试使用 Jira，但找不到让两个项目依赖于一个或多个组件的好方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T02:17:05.020

配置管理似乎总是比应有的更“随意”。简而言之，这真的取决于你当地的政策。

我的建议是使用像 Hudson 或 Bamboo 这样的持续集成服务器。我知道 Hudson 允许您创建项目依赖项，以便组件 C 的最新构建将自动导入 A 和 B。

但是，从配置管理的角度来看，您确实希望控制在 A 和/或 B 的哪个版本中使用哪个版本的 C，因此您可能需要更深入地挖掘。

# html - 居中的 UL 不会在 Firefox/Opera 中水平扩展（适用于 Safari、IE6/7/8）

> ID：471636
> 
> 赞同：0
> 
> 时间：2009-01-23T02:09:51.337
> 
> 标签：html, css, firefox, opera

我有一个居中的 ul（样式像一个 table ala cssplay），它在页面渲染后添加了 li 元素，它似乎在除 Firefox 和 Opera 之外的所有东西中都能很好地工作。

想要的效果是使 li 元素的行居中，即使只有一个或两个元素。这个例子模拟了 jQuery 在页面准备好两秒后添加 li 的问题。

无论出于何种原因，在添加第三个 li 后，Firefox 3.05 和 Opera 9.63 似乎将 ul 保持在初始绘制宽度，即使 CSS 中的任何位置都没有指定宽度。

当然，这绝对是在谋杀我，任何帮助将不胜感激。

[http://deadguy.reliccommunity.com/stuffbox/testinggrounds/display-table.html](http://deadguy.reliccommunity.com/stuffbox/testinggrounds/display-table.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T16:44:52.957

显示`table-*`类型仍然很不明确，因此您在这里得到不同的行为也就不足为奇了。根据我的经验，FF 在将某些规则应用于插入的内容方面也存在一些问题。不过，幸运的是，有一种更直观的方法可以对该页面进行编码，该方法也可以*正常工作*。

`<ul/>`与其设置to ，不如将其`display:table`保留为`display:block`（默认值）并给出`text-align:center`. 在这种情况下，您实际上并不关心`<ul/>`收缩包装内联表（这是您的代码实现的最终结果），您只希望表本身居中。

作为奖励，这允许您删除 wrapping `<div/>`，因为它只是为`<ul/>`的边距提供一个边界来推开。由于您不再使用这些边距，您可以简单地使用`<ul/>`作为包含块，并给它边框。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T06:05:27.647

我不能给你一个真正的答案，但因为没有其他人回应......我在 Firebug 中运行了它（在 Firefox 3.01 中），当我将 CSS 样式更改`#rounds li`为其他东西时，说 inline，然后回到 inline -table，布局自行更正。所以看起来你的 CSS 规则很好，问题与额外的列表项是通过 Javascript 插入的事实有关。我还通过摆脱 JQuery 并插入 W3C DOM 脚本来做同样的事情来检查这一点，果然，同样的问题。

我想知道您是否在 Firefox（我猜是 Opera）中发现了一个错误，当通过 Javascript 插入内容时，页面没有正确重排。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-23T17:07:00.340

您似乎在`inline-table`里面放了 a `table`，而`table-cell`s 在里面`table`没有任何`table-row`。由于这无效，因此可能会导致任何随机浏览器行为。

无论如何，`display: table*`支持很差（尤其是在 IE 中）。如果您今天想要表格布局，最好坚持使用实际表格。不太确定您要达到的目标；正如 Xanthir 所建议的，有更简单的方法可以实现简单的居中。

# java - 如何确定给定的 URL 链接是视频还是图像？

> ID：471638
> 
> 赞同：5
> 
> 时间：2009-01-23T02:10:55.563
> 
> 标签：java, url, grails, http-headers

我正在尝试获取用户输入的给定 URL，并确定该 URL 是指向图像还是视频。

示例用例：

当用户粘贴 YouTube 视频的 URL 时，保存页面将自动显示嵌入的 YouTube 播放器。

当用户在 Flickr 中发布图片的 URL 时，保存时，页面将自动显示 Flickr 图像的较小版本。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-23T02:36:55.120

您可以获取 URL 并从响应中查看 Content-type。

您可以使用 apache 的[HTTP 客户端](http://hc.apache.org/httpclient-3.x/)，它可以帮助您获取 URL 的内容，并且可以使用它来导航重定向。例如尝试获取以下内容：

[http://www.youtube.com/watch?v=d4LkTstvUL4](http://www.youtube.com/watch?v=d4LkTstvUL4)

将返回包含视频的 HTML。过了一会儿你会发现视频在这里：

[http://www.youtube.com/v/d4LkTstvUL4](http://www.youtube.com/v/d4LkTstvUL4)

但是，如果您获取该页面，您将获得重定向：

```
HTTP/1.0 302 Redirect
Date: Fri, 23 Jan 2009 02:25:37 GMT
Content-Type: text/plain
Expires: Fri, 23 Jan 2009 02:25:37 GMT
Cache-Control: no-cache
Server: Apache
X-Content-Type-Options: nosniff
Set-Cookie: VISITOR_INFO1_LIVE=sQc75zc-QSU; path=/; domain=.youtube.com; expires=
Set-Cookie: VISITOR_INFO1_LIVE=sQc75zc-QSU; path=/; domain=.youtube.com; expires=
Location: http://www.youtube.com/swf/l.swf?swf=http%3A//s.ytimg.com/yt/swf/cps-vf
L4&rel=1&eurl=&iurl=http%3A//i1.ytimg.com/vi/d4LkTstvUL4/hqdefault.jpg&sk=Z_TM3JF
e_get_video_info=1&load_modules=1 
```

所以，你要做的是获取 URL 并检查它，直到你得到最终的内容

[本节](http://hc.apache.org/httpclient-3.x/redirects.html)说明如何处理重定向。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-23T03:58:52.850

发出 HTTP HEAD 请求，这样您就可以检查返回的 HTTP 标头，而无需先下载整个文档。在 Linux 下使用“curl”显示一个非编程案例：

```
$ curl --head http://stackoverflow.com/Content/Img/stackoverflow-logo-250.png
HTTP/1.1 200 正常
缓存控制：max-age=28800
内容长度：3428
内容类型：图片/png
最后修改时间：格林威治标准时间 2009 年 1 月 16 日星期五 09:35:30
接受范围：字节
ETag：“98f590c5bd77c91:0”
服务器：Microsoft-IIS/7.0
日期：格林威治标准时间 2009 年 1 月 23 日星期五 03:55:39

```

从 Content-Type 可以看出这是一张图片。您可以使用来自 Java[的 Apache 的 HTTPClient](http://hc.apache.org/httpclient-3.x/)来执行 HTTP Head 请求。

如果您想确定下载内容，则只需发出 HTTP GET（使用 Httpclient）并使用相同的 HTTP Header 来确定内容类型。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-23T02:20:20.050

点击链接并检查内容类型标题？如果结果是 HTML 页面，您可以在页面上查找最大的图像或嵌入的 flash 文件并选择显示它吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-02-17T07:01:22.030

这是一个没有 apache 的解决方案。

```
HttpURLConnection urlConnection;
String urlString = "http://www.youtube.com/v/oHg5SJYRHA0";
try {
    urlConnection = (HttpURLConnection) new URL(urlString).openConnection();
    urlConnection.setInstanceFollowRedirects(true);
    HttpURLConnection.setFollowRedirects(true);

    int status = urlConnection.getResponseCode();
    if (status >= 300 && status <= 307) {
        urlString = urlConnection.getHeaderField("Location");
        urlConnection = (HttpURLConnection) new URL(urlString).openConnection();
        System.out.println("Redirect to URL : " + urlString);
    }
    String contentType = urlConnection.getHeaderField("Content-Type");
    if (contentType.startsWith("image/")) {
        //do something with an image
    } else if (contentType.equals("application/x-shockwave-flash")) {
        //do something with a video
        //} else ...
    }
    System.out.println(contentType);
} catch (IOException e) {
    e.printStackTrace();
} 
```

[遵循 mkyong.com 的重定向示例](http://www.mkyong.com/java/java-httpurlconnection-follow-redirect-example/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T19:46:01.787

我建议使用带有范围标头的 curl 来检查文件类型本身。

```
curl -s -v -r0-499 -o test  http://stackoverflow.com/content/img/so/logo.png
* About to connect() to stackoverflow.com port 80 (#0)
*   Trying 69.59.196.211... connected
* Connected to stackoverflow.com (69.59.196.211) port 80 (#0)
> GET /content/img/so/logo.png HTTP/1.1
> Range: bytes=0-499
> User-Agent: curl/7.19.4 (i386-apple-darwin9.6.0) libcurl/7.19.4 zlib/1.2.3
> Host: stackoverflow.com
> Accept: */*
> 
< HTTP/1.1 206 Partial Content
< Cache-Control: max-age=604800
< Content-Type: image/png
< Content-Range: bytes 0-499/3438
< Last-Modified: Fri, 05 Jun 2009 06:52:35 GMT
< Accept-Ranges: bytes
< ETag: "25dd4b35aae5c91:0"
< Server: Microsoft-IIS/7.0
< Date: Fri, 19 Jun 2009 19:39:43 GMT
< Content-Length: 500
< 
{ [data not shown]
* Connection #0 to host stackoverflow.com left intact
* Closing connection #0 
```

然后执行：

```
$ file test
test: PNG image data, 250 x 61, 8-bit colormap, non-interlaced 
```

现在您知道了 mime 类型：**image/png**，文件大小**3438 字节**，文件是**250 x 61 彩色 PNG**图像。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-03T07:26:47.110

快速视频索引器是一款视频捕捉软件，可以自动从视频列表中捕捉视频帧，并创建索引网页、索引图片或图像列表。

# asp.net - 集成两个 ASP.NET 站点的最佳方式

> ID：471640
> 
> 赞同：1
> 
> 时间：2009-01-23T02:11:53.157
> 
> 标签：asp.net, ssl

我有两个用于管理患者信息的 ASP.NET 站点。一个应用程序允许输入/编辑患者人口统计数据，而另一个应用程序允许为每个患者完成不同类型的评估。这两个站点各有不同的外观和感觉，并且都使用 SSL。

我们的一位分析师希望有一个“启动页面”（基本上是第三个应用程序），它允许用户在启动页面上查找患者记录，然后在选择患者后，单击一个按钮将它们启动到数据输入应用程序或评估应用程序。

出于多种原因，我对此犹豫不决... 1）这是两个独立的应用程序，被设计为独立的应用程序，并且将始终被大多数用户用作独立的应用程序。2）因为应用程序具有不同的外观/感觉，用户会知道他们正在围绕两个应用程序进行洗牌。3) 作为独立的应用程序，将我的登录凭据从启动页面传递到其他两个应用程序有多困难？4) 在具有不同 URL 的单独应用程序之间跳转时是否存在任何 SSL 影响？

理想情况下，我们会将这两个应用程序合二为一，并根据用户的需求打开和关闭功能，但目前这不是一个选项。

任何建议和/或见解将不胜感激！

非常感谢...DL

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T02:23:51.637

您是否考虑过将您需要的元素公开为 Web 服务？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T02:55:11.930

正如 Mike 提到的，最简单的方法是在您当前拥有的两个网站上创建一个 WebService。让它需要通过 WebService 标头进行身份验证（或使用客户端证书进行身份验证）并使用 SSL，然后使用患者姓名从您的启动页面调用这两个 WebService，并返回指向他/她两个站点的个人资料的链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-23T02:32:46.877

您可以使用 cookie 在应用程序之间传递身份验证会话。

如果您希望将来合并这两个应用程序，我会考虑从现在开始让它们看起来相同，以免在轨道上出现混乱。

# c# - 新的 ActionResult 可以渲染生成的视图并通过电子邮件发送内容

> ID：471643
> 
> 赞同：0
> 
> 时间：2009-01-23T02:14:11.220
> 
> 标签：c#, asp.net-mvc

我想知道是否可以编写一个像这样工作的文件 FileResult。

```
public ActionResult Generate(int id)
{
    //Fill Model
    string ViewName = "template1";    

    return new FileResult(ViewName, @"c:\save"+ id +".txt");
} 
```

它将采用模型，并将其与视图结合起来，为您提供通常会显示在屏幕上的输出，但只需将其保存为指定的文件名。

**注意：此文件将保存在网络服务器上**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-23T12:30:50.070

是的，这是可能的，但您不使用 FileResult。[如果您将内容类型和处置标头设置为 unknown](http://www.onjava.com/pub/a/onjava/excerpt/jebp_3/index3.html "Servlet 最佳实践，第 3 部分")，浏览器将提示用户保存结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T02:17:28.670

我不认为这是可能的。您可以指定文件名和 mime 类型，仅此而已。想象一下由您的提议引起的安全漏洞。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-23T14:04:53.407

如前所述，出于安全原因，您不能这样做，但如果提示用户保存文件，您可以保存文件。我已经为我的简历这样做了。我有一个从 xml 生成的简历的 word 版本。所以我有一个这样的 WordResult：

```
public class WordResult : ActionResult
{
public string FileName { get { return "Resume.doc"; } }

public override void ExecuteResult(ControllerContext context)
{
  GenerateMsWordDoc(context);
}

public void GenerateMsWordDoc(ControllerContext context)
{
  // You can add whatever you want to add as the HTML and it will be generated as Ms Word docs
  context.HttpContext.Response.AppendHeader("Content-Type", "application/msword");
  context.HttpContext.Response.AppendHeader("Content-disposition", "attachment; filename=" + FileName);

} 
```

}

要查看此操作：[http://www.aspevia.com/resume/show](http://www.aspevia.com/resume/show)是标准网络版本 [http://www.aspevia.com/resume/show?format=word](http://www.aspevia.com/resume/show?format=word)是单词版本

# python - Python/Twisted 多用户服务器 - 什么更有效？

> ID：471660
> 
> 赞同：2
> 
> 时间：2009-01-23T02:21:45.120
> 
> 标签：python, twisted, multi-user

在 Python 中，如果我希望我的服务器在 CPU 方面能够很好地扩展，我显然需要生成多个进程。我想知道哪个更好（使用 Twisted）：

A）管理进程（持有实际套接字连接的那个）将接收到的数据包放入一个共享队列（来自多处理模块的那个），工作进程将数据包拉出队列，处理它们并将结果发送回客户端。

B) 管理器进程（持有实际套接字连接的那个）启动一个延迟线程，然后调用进程池上的 apply() 函数。一旦结果从工作进程返回，管理器将结果发送回客户端。

在这两种实现中，工作进程都使用线程池，因此它们可以同时处理多个数据包（因为会有很多数据库查询）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T20:17:42.060

我认为B是有问题的。该线程只能在一个 CPU 上运行，即使它运行一个进程，该线程仍在运行。A可能会更好。

最好在时间方面尝试和测量两者，看看哪个更快，哪个扩展性好。但是，我要重申，我非常怀疑 B 能否很好地扩展。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-01T11:20:45.683

我认为“A”是你想要的答案，但你不必自己做。

你考虑过[安瓿](https://launchpad.net/ampoule)吗？

# c# - 处理静电刷

> ID：471662
> 
> 赞同：3
> 
> 时间：2009-01-23T02:22:54.213
> 
> 标签：c#, asp.net, dispose, system.drawing, brush

我正在编写一个生物节律应用程序。为了测试它，我有一个带有按钮和图片框的表单。当我点击按钮时

```
myPictureBox.Image = GetBiorhythm2(); 
```

第一次运行正常，**但在第二次单击**时会导致以下异常：

```
System.ArgumentException: Parameter is not valid.
   at System.Drawing.Graphics.CheckErrorStatus
   at System.Drawing.Graphics.FillEllipse
   at Larifari.Biorhythm.Biorhythm.GetBiorhythm2 in c:\delo\Horoskop\Biorhythm.cs:line 157
   at Larifari.test.Button1Click in c:\delo\Horoskop\test.Designer.cs:line 169
   at System.Windows.Forms.Control.OnClick
   at System.Windows.Forms.Button.OnClick
   at System.Windows.Forms.Button.OnMouseUp
   at System.Windows.Forms.Control.WmMouseUp
   at System.Windows.Forms.Control.WndProc
   at System.Windows.Forms.ButtonBase.WndProc
   at System.Windows.Forms.Button.WndProc
   at ControlNativeWindow.OnMessage
   at ControlNativeWindow.WndProc
   at System.Windows.Forms.NativeWindow.DebuggableCallback
   at ComponentManager.System.Windows.Forms.UnsafeNativeMethods.IMsoComponentManager.FPushMessageLoop
   at ThreadContext.RunMessageLoopInner
   at ThreadContext.RunMessageLoop
   at System.Windows.Forms.Application.Run
   at Larifari.test.Main in c:\delo\Horoskop\test.cs:line 20 
```

导致错误的缩减函数是：

```
public static Image GetBiorhythm2() {
        Bitmap bmp = new Bitmap(600, 300);
        Image img = bmp;
        Graphics g = Graphics.FromImage(img);

        Brush brush = Brushes.Black;
        g.FillEllipse(brush, 3, 3, 2, 2); //Here the exception is thrown on the second call to the function

        brush.Dispose(); //If i comment this out, it works ok.

        return img;
 } 
```

如果我注释掉刷子处理它可以正常工作，但我对此不满意并希望找到替代解决方案。你能帮我吗 ？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-23T02:45:17.303

Bruhes.Black 是一种系统资源，不适合您处置。运行时管理 Brushes 类中的画笔、Pens 和其他此类对象。它根据需要创建和处置这些对象，使经常使用的项目保持活动状态，这样它就不必不断地创建和销毁它们。

Brushes 类的文档说：

> Brushes 类包含静态只读属性，这些属性返回属性名称所指示颜色的 Brush 对象。您通常不必显式处理由此类中的属性返回的画笔，除非它用于构造新画笔。

简而言之，不要对系统提供的对象调用 Dispose。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-23T02:46:04.273

看起来您正在尝试处理静态，这会在下次使用时导致一些问题：

```
 Brush brush = Brushes.Black;
    g.FillEllipse(brush, 3, 3, 2, 2); //Here the exception is thrown on the second call to the function

    brush.Dispose(); //If i comment this out, it works ok. 
```

当您设置画笔 = Brushes.Black 时，实际上是在将画笔设置为静态 Brushes.Black 的引用（或指针）。通过处理它，您可以有效地编写：

```
 Brushes.Black.dispose(); 
```

当您再次使用黑色画笔时，运行时说您不能，因为它已经被处理掉了，并且不是 g.FillEllipse() 的有效参数

编写此代码的更好方法可能只是简单地：

```
 g.FillEllipse(Brushes.Black, 3, 3, 2, 2); 
```

或者，如果您想对此非常复杂：

```
 Brush brush = Brushes.Black.Clone();
    g.FillEllipse( brush, 3, 3, 2, 2 );
    brush.Dispose(); 
```

或者，如果您不关心看起来有问题的东西，只需将 Brush.Dispose(); 注释掉即可。行在您的原始代码中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-23T02:25:46.280

我认为您不需要在静态画笔上调用 .Dispose ，除非您创建新画笔。虽然，就个人而言，我会使用 using 语法.. 即：

```
using (Brush brush = new SolidBrush(...))
{
    g.FillEllipse(brush, 3, 3, 2, 2);
} 
```

你可能应该对你创建的图形对象做同样的事情。

# c# - 在 C# 中检查 null 和 string.Empty

> ID：471663
> 
> 赞同：4
> 
> 时间：2009-01-23T02:23:24.273
> 
> 标签：c#, .net

这听起来像是一个菜鸟问题，但是：

```
string var;
if (var == null) 
```

和

```
string var;
if (var == string.Empty) 
```

相同？

> ### **复制**
> 
> [String.Empty 和 Null 有什么区别？](https://stackoverflow.com/questions/151472/what-is-the-difference-between-string-empty-and)在 C# 中，[我应该使用 String.Empty 还是 Null？](https://stackoverflow.com/questions/263191/in-c-should-i-use-string-empty-or-string-empty-or)

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-01-23T02:28:26.213

@Jay 是正确的，它们不一样。 `String.IsNullOrEmpty()`是检查 null 和 "" 的便捷方法。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-01-23T02:24:55.143

不，它们不一样。

`string.Empty`与 相同`""`，是一个实际的对象：一个长度为 0 的字符串。 `null`表示没有对象。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-03-24T14:36:27.240

它们不一样，在 mscorlib 中 String.IsNullOrEmpty(string) 的实现证明了这一点：

```
public static bool IsNullOrEmpty(string value)
{
    if (value != null)
    {
        return (value.Length == 0);
    }
    return true;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-23T02:30:50.513

不，他们不是。第一个检查变量是否已初始化或稍后是否设置为“null”。第二个检查变量的值是否为“”（空）。但是，您也不应该使用任何一种。您应该改用 string.IsNullOrEmpty(var) 。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-06-17T13:24:45.087

但有时您想知道字符串是否为`NULL`空（在 OO 设计中）并不重要。例如，您有一个方法，它将返回`NULL`，或者`string.`您这样做，因为 null 表示操作失败，空字符串表示没有结果。

在某些情况下，在对其他对象采取任何进一步操作之前，您想知道它是失败还是没有结果。

# jquery - mouseenter 上的 jQuery UI 滑动效果

> ID：471668
> 
> 赞同：1
> 
> 时间：2009-01-23T02:24:35.440
> 
> 标签：jquery, user-interface, effect, slide, mouseenter

我已经在这几天了，所以任何帮助将不胜感激。我有一个链接，其中包含两个相互重叠的 div。顶部 div 被隐藏，但在 上滑入以部分覆盖底部 div `mouseenter`，然后在 上再次滑出`mouseleave`。它在一定程度上工作，但有点错误。这就是我为 jQuery 所拥有的（我从演示和文档中拼凑而成）：

```
$(document).ready(function(){
    $(".toggle").bind("mouseenter",function(){
        $("> :eq(0)", this).show("slide", { direction: "down" });
    }).bind("mouseleave",function(){
        $("> :eq(0)", this).hide("slide", { direction: "down" });
    });
}); 
```

这是页面结构（这是一个wordpress页面）

```
<div <?php post_class() ?> id="post-<?php the_ID(); ?>">
  <a href="<?php the_permalink(); ?>" class="toggle">
    <div id="slide" class="post-info" style="display: none;">
      <h1><?php the_title(); ?></h1>
      <ul>
        <li>more info here</li>
        <li>more info here</li>
      </ul>
    </div>
    <div class="post-image">
      <img src="<?php post_image('', false, false); ?>" width="275" height="155" />
    </div>  
  </a>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T02:42:47.667

尝试这样的事情。

```
$(document).ready(function(){
    $(".toggle").bind("mouseenter",function(){
        $("#slide").slideDown("slow");
        $("#post-image").slideUP("slow");
    }).bind("mouseleave",function(){
        $("#slide").slideUP("slow");
        $("#post-image").slideDown("slow");});
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T02:51:37.540

谢谢伯克，但顶部 div 滑入以部分覆盖底部 div，所以我不需要它滑出。不过，我会尝试您的语法，看看是否有任何改进。

- 编辑 -

发挥了魅力。再次感谢。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T18:43:16.250

您可能还想看看 jquery 的手风琴插件

# perl - 如何使用 mod_perl2 正确分叉？

> ID：471681
> 
> 赞同：7
> 
> 时间：2009-01-23T02:31:58.017
> 
> 标签：perl, mod-perl2

我无法从在 mod_perl2 下运行的一些代码分叉一个长时间运行的进程。

大部分情况下一切正常，但似乎分叉的进程正在持有 Apache 日志文件的打开句柄 - 这意味着 Apache 在进程运行时不会重新启动（我收到“无法打开日志文件”消息）。

这是我正在使用的代码：

```
use POSIX; # required for setsid

# Do not wait for child processes to complete
$SIG{CHLD} = 'IGNORE';

# fork (and make sure we did!)
defined (my $kid = fork) or die "Cannot fork: $!\n";

if ($kid) {
    return (1, $kid);
}else {
    # chdir to /, stops the process from preventing an unmount
    chdir '/' or die "Can't chdir to /: $!";

    # dump our STDIN and STDOUT handles
    open STDIN, '/dev/null' or die "Can't read /dev/null: $!";
    open STDOUT, '>/dev/null' or die "Can't write to /dev/null: $!";

    # redirect for logging
    open STDERR, '>', $log_filename or die "Can't write to log: $!";

    # Prevent locking to apache process
    setsid or die "Can't start a new session: $!";

    # execute the command
    exec( $cmd, @args );

    die "Failed to exec";
} 
```

早在 mod_perl1 的日子里，我记得使用`$r->cleanup_for_exec`来解决这个问题，但在 mod_perl2 下似乎不支持它。（编辑：[显然](http://perl.apache.org/docs/2.0/user/porting/compat.html#C__r_E_gt_cleanup_for_exec_)它不再需要了..）

任何关于如何从 mod_perl2 正确启动长时间运行的进程而没有这些问题的建议将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T03:16:53.730

您可能想阅读[此](http://mail-archives.apache.org/mod_mbox/httpd-dev/200410.mbox/%3C4171BACA.3020405@gmx.de%3E)讨论。除非您知道如何准备东西，否则似乎您不应该使用 mod_perl。您必须使用诸如[Apache2::SubProcess之类的模块](http://search.cpan.org/perldoc?Apache2::SubProcess)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T02:38:35.007

尝试在分叉之前关闭您的 STDIN/STDOUT 句柄。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-23T03:12:04.237

在我的（以前的 mod_perl，现在的 FCGI）代码中，我在“if ($kpid)”的“else”子句中，

```
 close STDIN;
    close STDOUT;
    close STDERR;
    setsid(); 
```

另外，由于我忘记的原因，我立即再次分叉，然后在*那个*孩子中重新打开 STDIN、STDOUT 和 STDERR。

所以它看起来像：

```
$SIG{CHLD} = 'IGNORE';

# This should flush stdout.
my $ofh = select(STDOUT);$| = 1;select $ofh;

my $kpid = fork;
if ($kpid)
{
    # Parent process
    waitpid($kpid, 0);
}
else
{
    close STDIN;
    close STDOUT;
    close STDERR;
    setsid();
    my $gpid = fork;
    if (!$gpid)
    {
        open(STDIN, "</dev/null") ;#or print DEBUG2 "can't redirect stdin\n";
        open(STDOUT, ">/dev/null") ;#or print DEBUG2 "can't redirect stdout\n";
        open(STDERR, ">/dev/null") ;#or print DEBUG2 "can't redirect stderr\n";
        # Child process
        exec($pgm, @execargs) ;# or print DEBUG2 "exec failed\n";
    }
    exit 0;
} 
```

# c# - 我需要改变asp:Login控制按钮的样式和控制使用

> ID：471682
> 
> 赞同：5
> 
> 时间：2009-01-23T02:32:16.330
> 
> 标签：c#, asp.net, .net-3.5, asp.net-membership

是否可以获取控件背后的源代码和代码，以便我自己操作它？

这样我就可以继续使用会员资格并拥有易于使用的功能，但可以使用我自己的控件。

我确信有一个简单的解决方案。

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-23T02:45:48.080

您可以使用以下模板作为登录控件。请注意，如果您这样做，您将需要提供自己的验证器等，但您可以有更多的自由:)

如果你在 VS 中放置一个登录控件，然后打开它的上下文框，然后单击“转换为模板”，你可以看到标准实现是什么样的。

```
<asp:Login ... >
    <LayoutTemplate>
        <asp:TextBox ID="UserName" ... /> ...
        <asp:TextBox ID="Password" ... /> ...
        <asp:Button ID="LoginButton" ... />
    </LayoutTemplate>
</asp:Login> 
```

# c# - 使用反射获取方法名和参数

> ID：471693
> 
> 赞同：10
> 
> 时间：2009-01-23T02:41:49.353
> 
> 标签：c#, .net, memcached, system.reflection

我正在尝试一种基于方法名称和参数以编程方式为[Memcached创建密钥的方法。](http://en.wikipedia.org/wiki/Memcached)所以如果我有一个方法，

```
string GetName(int param1, int param2); 
```

它会返回：

```
string key = "GetName(1,2)"; 
```

我知道您可以使用反射获取 MethodBase，但是如何获取字符串中的参数值，而不是参数类型？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-23T07:31:18.300

您无法从反射中获取方法参数值。您必须使用调试/分析 API。您可以获取参数名称和类型，但不能获取参数本身。对不起...

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-23T07:35:23.800

你正在寻找的是一个拦截器。顾名思义，拦截器拦截方法调用，并允许您在调用方法之前和之后执行操作。这在许多缓存和日志框架中非常流行。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2009-01-23T03:04:36.390

这是我想出的（但是，它可能不是特别有效）：

```
MethodBase method = MethodBase.GetCurrentMethod();
string key = method.Name + "(";
for (int i = 0; i < method.GetParameters().Length; i++) {
  key += method.GetParameters().GetValue(i);
  if (i < method.GetParameters().Length - 1)
    key += ",";
}
key += ")"; 
```

# c - C字符串初始化程序不包括终止符？

> ID：471703
> 
> 赞同：5
> 
> 时间：2009-01-23T02:45:29.300
> 
> 标签：c, variables, string

我对以下 C 代码片段感到有些困惑：

```
printf("Peter string is %d bytes\n", sizeof("Peter")); // Peter string is 6 bytes 
```

这告诉我，当 C 编译双引号中的字符串时，它会自动为空终止符添加一个额外的字节。

```
printf("Hello '%s'\n", "Peter"); 
```

该`printf`函数知道何时停止读取字符串“Peter”，因为它到达了空终止符，所以......

```
char myString[2][9] = {"123456789", "123456789" };
printf("myString: %s\n", myString[0]); 
```

在这里，`printf`打印所有 18 个字符，因为没有空终止符（如果不取出 9，它们将不适合）。**C不会在变量定义中添加空终止符吗？**

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-01-23T02:48:29.700

你的字符串是 [2][9]。那些 [9] 是 ['1', '2', etc...'8', '9']。因为您在第一个数组维度中只给了 9 个字符的空间，并且因为您使用了全部 9 个字符，所以它没有空间放置 '\0' 字符。重新定义您的 char 数组：

```
char string[2][10] = {"123456789", "123456789"}; 
```

它应该工作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-23T02:48:41.413

当然可以，只是没有为 '\0' 字节留出足够的空间。进行中：

```
char string[2][10] = { "123456789", "123456789" }; 
```

将按预期工作（仅打印 9 个字符）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-23T04:55:56.227

如果你告诉 C 一个数组是给定的大小，C*不能*让这个数组变得更大。如果它这样做，那就是不服从你！请记住，并非每个 char 数组都包含一个以空字符结尾的字符串。有时数组（如所使用的）确实是（单个）字符的数组。编译器不知道你在做什么，也无法读懂你的想法。

这就是为什么 C 允许您初始化一个 char 数组，其中 null 终止符不适合，但其他一切都适合。用一个长一字节的字符串尝试您的示例，编译器会抱怨。

请注意，您的示例将编译但*不会*按照您的预期执行，因为内容不是（以空结尾的）字符串。使用 GCC，运行您的示例，我看到了我应该看到的字符串，然后是垃圾。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-23T13:11:48.083

或者，您可以使用：

```
char* myString[2] = {"123456789", "123456789" }; 
```

像这样，初始化程序为您的空终止字符串计算正确的大小。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-23T13:19:02.903

[C 允许未终止的字符串，C++ 不允许。](http://david.tribble.com/text/cdiffs.htm#C99-string-init)

> C 允许使用字符串常量初始化字符数组。它还允许字符串常量初始值设定项恰好包含比它初始化的数组多一个字符，即可以忽略字符串的隐式终止空字符。例如：
> 
> ```
> char  name1[] =  "Harry";   // Array of 6 char
> 
> char  name2[6] = "Harry";   // Array of 6 char
> 
> char  name3[] =  { 'H', 'a', 'r', 'r', 'y', '\0' };
>                             // Same as 'name1' initialization
> 
> char  name4[5] = "Harry";   // Array of 5 char, no null char 
> ```
> 
> C++ 还允许使用字符串常量初始化字符数组，但始终在初始化中包含终止空字符。因此，上例中的最后一个初始化程序（name4）在 C++ 中是无效的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-23T02:52:07.787

编译器没有警告没有足够的空间容纳 0 字节是否有原因？如果我尝试添加另一个不适合的“9”，我会收到警告，但它似乎并不关心删除 0 字节？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-23T02:57:20.180

'\0' 字节不是问题。大多数时候，如果你有这个：

```
char code[9] = "123456789"; 
```

下一个字节将不在变量的边缘，但将是未使用的内存，并且很可能为 0（除非您`malloc()`在使用它们之前没有设置这些值）。所以大多数时候它都有效，即使它对你不利。

如果您使用 gcc，您可能还想使用 -Wall 标志或其他（百万）警告标志之一。这可能会有所帮助（不确定）。

# python - IronPython 和 IronPython Studio 的优缺点

> ID：471712
> 
> 赞同：16
> 
> 时间：2009-01-23T02:49:32.380
> 
> 标签：python, ironpython, ironpython-studio

我们公司已经准备好将一切都转移到 Python 而不是 C#，我们是一家咨询公司，我们通常用 C# 编写小项目，我们不做大项目，我们的工作更多地基于复杂的数学模型而不是复杂的软件结构。所以我们相信 IronPython 对我们来说是一个很好的平台，因为它在 Windows 上提供了标准的 GUI 功能并可以访问所有 .Net 库。

我知道 Ironpython 工作室并不完整，事实上我很难添加我的参考资料，但我想知道是否有人可以为我们列出这次迁移的一些优缺点，考虑到 Python 代码更容易被我们的客户阅读，并且我们通常提供概念验证原型而不是功能齐全的代码，我们的客户通常会自行实施应用程序

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-23T09:29:31.183

我的公司 Resolver Systems 开发了可能是迄今为止用 IronPython 编写的最大的应用程序。（它叫做 Resolver One，它是一个 Pythonic 电子表格）。我们还托管 Ironclad 项目（在 IronPython 下运行 CPython 扩展）并且进展顺利（我们计划很快发布 Resolver One 和 numpy 的测试版）。

我们选择 IronPython 的原因是 .NET 集成——我们的客户希望在 Windows 上 100% 集成，而目前最简单的方法是 .NET。

我们在 Visual Studio 中设计 GUI（无行为），将其编译为 DLL 并从 IronPython 子类化它以添加行为。

我们发现 IronPython 在某些情况下更快，而在其他情况下更慢。然而，IronPython 团队反应迅速，每当我们报告回归时，他们都会修复它，并且通常会将其反向移植到错误修复版本。如果您担心性能，您总是可以在 C# 中实现一个关键部分（我们还没有这样做）。

如果您有使用 C# 的经验，那么 IronPython 对您来说很自然，并且比 C# 更容易，尤其是对于原型。

关于 IronPython studio，我们不使用它。我们每个人都有自己选择的编辑器（TextPad、Emacs、Vim 和 Wing），一切正常。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-23T09:06:35.253

你想从 C# 切换到 python 的原因有很多，我最近自己做了这个。经过大量调查，以下是我坚持使用 CPython 的原因：

*   性能：那里有一些文章指出，ironpython 总是有较慢的情况，所以如果性能是一个问题
*   以原文为例：许多人认为新功能等总是首先集成在 CPython 中，您必须等到它们在 Ironpython 中实现。
*   许可：有人认为这是一颗定时炸弹：没有人知道 Ironpython/mono 的许可在不久的将来会发生怎样的变化
*   扩展：python 的优势之一是 CPython 可以使用的数千个扩展，正如您提到的数学问题：numpy 可能是适合您的快速包，它可能无法在 IronPython 下按预期运行（尽管[Ironclad](http://www.resolversystems.com/documentation/index.php/Ironclad)）
*   尤其是在 Windows 下，你有一个带有 wxPython 的原生 GUI 工具包，它在其他几个平台下看起来也很棒，还有 pyQT 和许多其他工具包。他们有像 wxGlade 这样的优秀设计师，但这里的 VisualStudio C# Designer 更易于使用。
*   平台独立性（如果这是一个问题）：CPython 被移植到很多平台，而 Ironpython 只能在主要平台上使用（最近读到一个开发人员很伤心，他无法让 mono 在他的 AIX 下运行）

Ironpython 是一个伟大的工作，如果我有一个特殊的 .NET 库我必须使用，IronPython 可能是选择，但对于通用问题，人们似乎建议使用原始 CPython，除非 Guido 改变主意。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-23T02:59:23.593

你描述事物的方式，听起来你的公司正在为了 Python 而简单地切换到 Python。您想使用 Python 有什么特定的原因吗？是否需要更动态的语言？函数式编程对你有帮助吗？如果您在 C# 中有一套非常好的工作工具，为什么还要费心切换呢？

如果您准备切换，您可能需要考虑从标准 Python 开始，除非您特别依赖于 .NET 库。您可以使用许多不同的框架（如 wxPython、pyQt 等）编写跨平台 GUI。也就是说，Visual Studio 拥有比几乎任何用于创建 Python 窗口布局的工具都要出色的 GUI 设计器。

# c# - 在 C# 中通过网络发送大文件的好方法？

> ID：471726
> 
> 赞同：6
> 
> 时间：2009-01-23T02:59:36.260
> 
> 标签：c#, networking, file-transfer

我正在尝试构建一个可以从网络中另一台机器上运行的服务请求文件的应用程序。这些文件可能相当大（有时 500mb +）。我正在考虑通过 TCP 发送它，但我担心它可能需要将整个文件存储在内存中。

可能只有一个客户。复制到共享目录也是不可接受的。唯一需要的通信是客户端说“gimme xyz”和服务器发送它（以及确保正确发生的一切）。

有什么建议么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-23T04:15:05.203

这是一个更简单的方法。使用 BITS（后台智能传输服务）。它已经内置在 WinXP 和 Vista 中。它基本上是驱动 Windows 更新的原因。

[http://blogs.msdn.com/powershell/archive/2009/01/11/transferring-large-files-using-bits.aspx](http://blogs.msdn.com/powershell/archive/2009/01/11/transferring-large-files-using-bits.aspx)

[http://blogs.msdn.com/jamesfi/archive/2006/12/23/how-to-use-bits-to-transfer-files.aspx](http://blogs.msdn.com/jamesfi/archive/2006/12/23/how-to-use-bits-to-transfer-files.aspx)

这是某人编写的一个很好的托管 BITS 包装器以及如何使用它。

[http://www.codeproject.com/KB/cs/Managed_BITS.aspx](http://www.codeproject.com/KB/cs/Managed_BITS.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-20T20:05:27.730

This article may help you. It is about sending large files in .NET. Check the link:

[http://codetechnic.blogspot.com/2009/02/sending-large-files-over-tcpip.html](http://codetechnic.blogspot.com/2009/02/sending-large-files-over-tcpip.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-09-20T20:11:03.487

Be careful with BITS. It is a very good protocol but not a critical part of the windows update program. We found that hardly any of our corporate clients allowed the BITS update onto their machines; therefore we couldn't build an app that relied on it.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-23T03:08:05.867

您可以在 .NET 中使用套接字来传输文件和数据。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-23T03:14:16.293

您可能需要考虑[WCF 流](http://msdn.microsoft.com/en-us/library/ms733742.aspx)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-23T03:10:03.103

如果 FTP 是一个选项，那么为了简单起见，我会选择它。否则，您将进入 TCP/IP 套接字编程的世界。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-07-01T13:28:43.527

通过开源[edtFTPnet](http://www.enterprisedt.com/products/edtftpnet/overview.html)库使用 FTP。快速简单。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-23T03:02:09.593

使用`TransmitFile`（这是一个 Win32 函数；也许它也是 .NET 库的一种方法）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-14T19:55:22.753

如果文件物理地存在于机器上，为什么不把它们放在一个文件夹中，使该文件夹成为 IIS 中的虚拟目录，并使用基于内容的路由和/或 URL 重写将请求路由到它们。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-09-09T10:05:35.433

就我个人而言，我会选择平衡速度、可靠性和经济代码的东西，所以我会基于 TCP 网络流。代码的客户端如下所示：

```
internal class Client
{
    private FileStream _fs;     
    private long _expectedLength;

    public void GetFileFromServer(string localFilename)
    {            
        if (File.Exists(localFilename))
            File.Delete(localFilename);

        _fs = new FileStream(localFilename, FileMode.Append);

        var ipEndpointServer = new IPEndPoint(IPAddress.Parse({serverIp}), {serverPort});

        // an object that wraps tcp client
        var client = new TcpClientWrapper(ipEndpointServer, "");
        client.DataReceived += DataReceived;
    }

    private void DataReceived(object sender, DataReceivedEventArgs e)
    {
        var data = e.Data;

        // first packet starts with 4 bytes dedicated to the length of the file
        if (_expectedLength == 0)
        {
            var headerBytes = new byte[4];
            Array.Copy(e.Data, 0, headerBytes, 0, 4);
            _expectedLength = BitConverter.ToInt32(headerBytes, 0);
            data = new byte[e.Data.Length - 4];
            Array.Copy(e.Data, 4, data, 0, data.Length);
        }

        _fs.WriteAsync(e.Data, 0, e.Data.Length);

        if (_fs.Length >= _expectedLength)
        {                                
            // transfer has finished
        }
    }
} 
```

然后有一个服务器类来提供文件。请注意整个文件是如何不加载到内存中的，而是从`FileStream`.

```
internal class Server
{
    private TcpServer _tcpServer;
    private NetworkStream _stream;        

    public void StartServer()
    {
        // fire up a simple Tcp server
        _tcpServer = new TcpServer({serverPort}, "test");
        _tcpServer.ClientConnected += ClientConnected;
    }

    private void ClientConnected(object sender, TcpClientConnectedEventArgs e)
    {            
        // an incoming client has been detected ... send the file to that client!
        _stream = e.Client.GetStream();
        SendFileToClient({pathToFile});
    }

    private void SendFileToClient(string pathToFile)
    {
        // open the file as a stream and send in chunks
        using (var fs = new FileStream(pathToFile, FileMode.Open))
        {
            // send header which is file length
            var headerBytes = new byte[4];
            Buffer.BlockCopy(BitConverter.GetBytes(fs.Length + 4), 0, headerBytes, 0, 4);
            _stream.Write(headerBytes, 0, 4);

            // send file in block sizes of your choosing
            var buffer = new byte[100000];
            int bytesRead = 0;
            while ((bytesRead = fs.Read(buffer, 0, buffer.Length)) > 0)
            {
                _stream.Write(buffer, 0, bytesRead);
            }
            _stream.Flush();
        }
    }
} 
```

`System.Net.Sockets.TcpClient`TcpClientWrapper 几乎是带有对象和底层对象的样板代码`NetworkStream`。我也不需要发布此内容，但只是为了提供一些指示，构造将包含以下内容：

```
_tcp = new Net.TcpClient();
_tcp.Connect(remoteEp);
_stream = _tcp.GetStream();
_stream.BeginRead(_receivedData, 0, _receivedData.Length, DataReceivedAsync, null); 
```

并且该`DataReceivedAsync`方法是样板套接字数据处理，并且会引发一个事件o将接收到的数据共享回消费者（在这种情况下是客户端）：

```
private void DataReceivedAsync(IAsyncResult ar)
{
    var receivedBytes = _stream.EndRead(ar);

    if (receivedBytes > 0)
    {
        var data = new byte[receivedBytes];
        Array.Copy(_receivedData, 0, data, 0, receivedBytes);
        DataReceived?.Invoke(this, new DataReceivedEventArgs(data));

        _receivedData = new byte[ReceiveBufferSize];
        _stream.BeginRead(_receivedData, 0, _receivedData.Length, DataReceivedAsync, null);
    }       
} 
```

将数据从包装器发送回客户端的事件：

```
public EventHandler<DataReceivedEventArgs> DataReceived;
public class DataReceivedEventArgs : EventArgs
{
    public DataReceivedEventArgs(byte[] data) { Data = data; }
    public byte[] Data { get; }
} 
```

# xml - Eclipse XML 格式化程序

> ID：471727
> 
> 赞同：8
> 
> 时间：2009-01-23T03:00:37.537
> 
> 标签：xml, eclipse, plugins

内置 Eclipse XML 编辑器的免费替代品是什么？

与 IDE 一起打包的那个有两个主要的格式化问题：

1.  格式化程序尝试解析转义字符，就好像它们未转义一样。例如'<' 被视为 '<' 导致格式化程序“停止”。
2.  不支持元素之间的空白：

    ```
    <foo>   text </foo> 
    ```

    将被格式化为：

    ```
    <foo>text</foo> 
    ```

我们正在使用 Eclipse 3.4。

### 更新

问题 #1 是一个已知错误：[XML 文件中实体的格式化问题](https://bugs.eclipse.org/bugs/show_bug.cgi?id=238026)。

[显然](https://bugs.eclipse.org/bugs/show_bug.cgi?id=262206#c7)，空白格式是预期的功能。我已要求将此作为选项提供或建议在我自己的插件中修复此问题，但到目前为止，还没有答案。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-23T19:03:01.727

这不太理想，我希望有人有更好的解决方案，但它有效：

使用 dom4j 构建一个简单的应用程序：

```
public static void main( final String[] args ) throws Exception {
    String text = FileUtils.readFileToString( new File( args[ 0 ] ) );
    OutputFormat format = OutputFormat.createPrettyPrint();
    format.setTrimText( false );

    XMLWriter writer = new XMLWriter( System.out, format );
    writer.write( DocumentHelper.parseText( text ) );
} 
```

创建一个可运行的 jar，（可选）批处理脚本，并作为外部工具添加。当然，您可以尝试 XMLTidy 或其他一些命令行 XML 格式化程序，但我使用 dom4j 获得了更好的结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-23T15:25:42.697

我喜欢带有 XML Tools 插件的 Notepad++。它执行 XSLT，具有 XPATH 表达式评估器，并执行 DTD 和模式验证。工具链下载链接：

*   记事本++： http: [//sourceforge.net/project/downloading.php ?group_id=95717&use_mirror=internap&filename=npp.5.0.Installer.exe&24657954](http://sourceforge.net/project/downloading.php?group_id=95717&use_mirror=internap&filename=npp.5.0.Installer.exe&24657954)
*   XML 插件： http: [//sourceforge.net/project/downloading.php ?group_id=189927&use_mirror=voxel&filename=xmltools_2.3.1_r639.zip&44936797](http://sourceforge.net/project/downloading.php?group_id=189927&use_mirror=voxel&filename=xmltools_2.3.1_r639.zip&44936797)
*   外部库： http: [//sourceforge.net/project/downloading.php ?group_id=189927&use_mirror=internap&filename=ext_libs.zip&52274848](http://sourceforge.net/project/downloading.php?group_id=189927&use_mirror=internap&filename=ext_libs.zip&52274848)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-09-09T14:53:21.720

喜欢的话可以试试[这个](http://editorxml.sourceforge.net)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-23T07:43:11.553

[**当我在带有WTP**](http://help.eclipse.org/ganymede/index.jsp?topic=/org.eclipse.wst.xmleditor.doc.user/topics/cwxmledt.html)[的xml 编辑器](http://help.eclipse.org/ganymede/index.jsp?topic=/org.eclipse.wst.xmleditor.doc.user/topics/cwxmledt.html)`CTRL+SHIFT+F`中格式化 ( )时，我没有看到任何这些问题[](http://help.eclipse.org/ganymede/index.jsp?topic=/org.eclipse.wst.xmleditor.doc.user/topics/cwxmledt.html)

 **所以 WTP 应该可以解决你的问题。

[![](https://i.stack.imgur.com/teuUF.png)](https://i.stack.imgur.com/teuUF.png)
[（来源：[springframework.org](http://static.springframework.org/spring/docs/2.5.x/reference/images/eclipse-setup-2.png)）]

* * *

我的立场是正确的：空格和转义字符确实是 WTP 的“XML 编辑器和工具”插件（3.0.2 或 3.0.3）的问题。

但是，`<foo> text </foo>`不会像`<foo>text</foo>`.

但

```
<foo>    text   text2      text3        </foo> 
```

将被格式化为

```
<foo> text text2 text3       </foo> 
```

（奇怪的是，最后的空格被保留了）

并且任何转义字符序列都会停止格式化（每一行，直到包含转义字符的行都被格式化）

我将深入研究这个问题，并将这个答案作为一个社区答案。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-23T15:29:00.710

我过去使用过 XMLBuddy [http://www.xmlbuddy.com/](http://www.xmlbuddy.com/)

在我恢复到 OxygenXML 之前，但你必须为 Oxygen 付费。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-08-20T12:21:39.747

Eclipse XML 编辑器将尊重`CDATA`部分，并且不会在这些部分中进行任何格式化。我用开普勒测试了这个。这需要输入更多内容，但可以使用模板 from`preferences -> XML -> XML Files -> Editor -> Templates`来简化此操作。

# xss - 验证用户输入字段时不允许使用 HTML 表格的原因是什么？

> ID：471732
> 
> 赞同：5
> 
> 时间：2009-01-23T03:02:17.173
> 
> 标签：xss, markdown

我正在写一点 wiki 并浏览我所有的语法高亮选项。在 wiki 语法 (mediawiki) 和 markdown + 白名单标签之间进行辩论。我想我更喜欢后者，但我认为我的用户需要表格。为什么 Stackoverflow 上不允许使用表格？

```
<table> <tr> <td> </td> </tr> </table> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-23T03:16:28.783

它们在问答形式中毫无用处。至少我想不出我需要使用表格来回答某人的问题或自己问一个人的原因。

另外，无论如何你都可以这样做：

```
cell 1-1      cell 1-2
cell 2-1      cell 2-2 
```

编辑：所以在阅读了我的回复的评论后，我发现在某些情况下，表格可以提供更好的视觉帮助。所以我要推荐一个类似于CSV的markdown；我认为这很容易输入和实现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-28T14:26:46.983

如果您的网站建立在表格之上，并且您无法编写足以验证用户 html 语法正确的正则表达式，那么禁用表格将是一个好主意，否则您的布局可能会受到影响。

即使您的网站不是表格布局，在评论帖子等中有两组格式错误的表格 html 也可能导致您的网站被污损。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-28T14:45:52.547

三个原因：

*   与任意 Markdown 实现的兼容性，
*   安全的用户输入，
*   独立于布局的内容

标准 Markdown*不*支持表格。它旨在就像电子邮件一样。SO 使用标准 Markdown，所以没有表格。

[一些](http://michelf.com/projects/php-markdown/extra/#table)Markdown 扩展支持表格，但它们之间不兼容，这使 Markdown 的想法无效，因为内容变得依赖于特定的 Markdown 实现。

因此，只能使用 HTML-inside-Markdown 制作表格。这也不好。我确信 Markdown2PDF、Markdown2TeX 和 Markdown2TheNextBigML 转换器很容易编写。将带有嵌入 HTML 的 Markdown 转换为 HTML 以外的任何东西都不是一件容易的事。因此，如果允许（某些）嵌入 HTML，则将所有内容存储在 Markdown（纯文本）中是没有意义的。

清理所有用户提交的 HTML 的另一个原因是显而易见的，正确解析太困难和昂贵，并且*会*破坏布局（例如`<table width="10000" height="10000">`）。

最后，轻量级（纯 Markdown）标记有一个巨大的好处：它不依赖于特定的站点布局（屏幕宽度、填充、边距、对齐方式、列宽等）。因此，如果一年后进行 SO 重新设计，则不需要编辑内容（HTML 片段隐含地依赖于特定的 CSS）。额外好处：更易于在第三方应用程序（如手机客户端）中使用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-23T03:50:47.590

我认为这是任意的。它们可能有很多用途，但这里似乎首选手动对齐固定宽度的文本（我认为这是一种黑客行为）。

就个人而言，我更喜欢 BBCode 风格的语法。

*   这是明确的
*   它几乎就像 HTML
*   由于使用括号而不是角度，它不能与 HTML 混淆

“显式”意味着任何预期的效果几乎可以用任何组合来表达，并且没有意外的效果（如在降价中，当使用许多特殊字符之一时）。例如，我不知道如何让这个站点以非固定字体 (*word*) 显示星号中的单词。摩尔斯电码不能使用下划线，因为它也是一个特殊字符。在 BBCode 中，只有一个特殊字符：`[`

此外，输入清理变得更加简单。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-28T08:11:08.803

考虑到 Wisiwyg javascript 编辑器 (WMD) 必须实时呈现您正在输入的内容
（Jeff 从 SO 开始就想要的一个重要功能）

因此，我认为**表格的动态更新对于 parse/display 来说太复杂了**，因为 HTML 翻译器在您键入它们时必须解释不完整的表格结构。
这意味着要应对 colspan、rowspan、不正确的标题结构等功能。

因此，为了获得更好的动态预览体验，表格完全是从零开始的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-28T08:30:19.543

在许多情况下表格会很有用：数据表格、显示矩阵、显示算法的可能结果等。

我认为您不需要像 HTML 表（包含行跨度和所有）那样复杂的东西，我认为纯 CSV 足以满足 99% 的用例。它还将允许 javascript 动态渲染器轻松完成其工作。

CSV 是众所周知的、轻量级的、易于键入和理解的。除此之外，唯一需要的是 CSV 数据的开始和结束标记。例如 [csv]...[/csv] 或 ||...||。下面是它的样子：

```
[csv]
**XOR**,**true**,**false**
**true**, false, true
**false**, true, false
[/csv] 
```

这将产生一个像这样的表：

```
XOR     true    false
true    false   true
false   true    false 
```

（第一行第一列用粗体字）

# debugging - WinDbg 符号解析

> ID：471733
> 
> 赞同：35
> 
> 时间：2009-01-23T03:03:10.073
> 
> 标签：debugging, dll, windbg, symbols

使用 WinDbg 时，私有符号文件 (pdb?) 应该放在哪里？

我的情况是：我有一个要调试的 DLL。我有这个 DLL 的源代码和符号文件。此 DLL 由另一个 DLL（我没有符号或源代码）调用，而另一个 DLL 又由 EXE 调用（我也没有符号或源代码）。

我的问题是我收到一条警告，上面写着

> *** 警告：无法验证*C:\TheProgram\SomeSubfolder\AnotherSubfolder\MyDll.dll的校验和*

我认为这个警告是我在调用堆栈中收到以下类型消息的原因：

> MyDll!AClass::AFunction+SomeHexAddress

我的文件结构如下所示：

exe：C:\TheProgram\program.exe

调用 dll：C\TheProgram\SomeSubfolder\caller.???

我要调试的 DLL：C:\TheProgram\SomeSubfolder\AnotherSubfolder\MyDll.dll

注意：我在与 exe 不同的驱动器上的工作区中将符号文件路径和源文件路径设置为生成调试 DLL 的位置。但我确实复制了 pdb + 映射文件并将其放在我想要的 dll 上调试..

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-02-21T21:46:29.657

这么晚才回复很抱歉。
在您的帖子中，您提到您看到以下错误消息。

```
*** WARNING: Unable to verify checksum for C:\TheProgram\SomeSubfolder\AnotherSubfolder\MyDll.dll 
```

您还问了一个问题，“我应该将我的 DLL 的符号放在符号路径中的什么位置？”

**这是对第一个问题的回应：**

识别不匹配符号的步骤。

1.  !sym 嘈杂
2.  .reload
3.  x MyDll!*class*
    *这会重新加载您的 dll，或者您可以键入 kb 以显示应该加载它的 DLL 的调用堆栈。
4.  !sym quiet
    *重置为原始安静符号加载

你也可以运行

```
0:001> lmv m myDll  *(and examine the Checksum) 
```

注意：如果您有校验和，则 Windbg 可以将 DLL 的校验和与 PDB 的校验和进行匹配。每个开发环境都有不同的方式来生成校验和。

**以下是关于将 PDB 放在何处的问题的回复**

如果您已将 MyDll.pdb 添加到符号存储中，则可以使用以下语法

```
.sympath SRV*c:\symcache*http://msdl.microsoft.com/download/symbols 
```

正如罗杰在上面所建议的......

但是，如果您只有本地 PDB，您可能希望先放置 PDB 的路径，然后再像这样进入符号服务器

```
.sympath C:\TheProgram\SomeSubfolder\AnotherSubfolder\;SRV*c:\symcache*http://msdl.microsoft.com/download/symbols 
```

这样，在尝试使用 Symbols Server 缓存之前，Windbg 应该在您的 SomSubFolder 目录中看起来是本地的。

谢谢，亚伦

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-23T09:55:06.873

只要您能够告诉调试器它们在哪里，您将私有符号文件放在哪里并不重要。

您看到的警告对堆栈跟踪**没有**任何影响，但事实上您缺少 caller.DLL 和 app.EXE 的**符号**。

在windbg（本地）中配置符号就像使用一样简单：

> .sympath[+] path_to_pdbs
> *和
> .symfix+ path_to_system_pdb_store

你看到：

> MyDll!AClass::AFunction+SomeHexAddress

实际上，只要 SomeHexAddress 是合理的（并且假设 MyDll.pdb 已找到并加载！）就没有任何意义 - 它看起来像一个正确的调用堆栈条目。

现在，我的问题是，您遇到的问题是什么？

PS你不需要带有windbg的.map文件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-23T10:25:36.483

作为我们构建过程的一部分，我们将私有 PDB 文件和已发布的 EXE/DLL 文件复制到符号服务器。在最简单的情况下，这只是一个 UNC 路径，但您可以将其配置为使用 HTTP 进行访问。

要复制您的输出文件，请使用 SYMSTORE.EXE 程序。

然后，配置您的调试器（我们使用 Visual Studio 和 WinDbg）以查看该路径。对于 WinDbg，最简单的方法是设置一个环境变量：

```
_NT_SYMBOL_PATH=
    SRV*C:\WebSymbols*http://msdl.microsoft.com/download/symbols;
    \\symsvr\Symbols 
```

（应该都在一条线上）

这将 WinDbg 配置为查看 Microsoft 符号服务器（将文件缓存在 C:\WebSymbols 中）并查看本地符号存储 ( `\\symsvr\Symbols`)。

我们还使用源服务器工具将 SVN 详细信息存储在 PDB 文件中，这意味着我们可以返回用于构建特定版本的确切源文件。进去看看`...\Debugging Tools for Windows (x86)\srcsrv`。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-23T04:15:13.143

一种选择是将符号文件保留在它们所在的位置（*即在构建输出文件夹中*），然后使用**-y** WinDbg 命令行选项来定位这些文件。使用这种方法应该保证符号文件始终是最新的。

从微软帮助：

```
-y SymbolPath 
Specifies the symbol search path. Separate multiple paths with a 
semicolon (;). If the path contains spaces, it should be enclosed 
in quotation marks. For details, and for other ways to change this 
path, see Symbol Path. 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-10-30T00:31:28.853

事实证明，我的目标机器 - 在 Visual Studio 中配置 - 在部署到它时没有获得最新版本，因此出现“driver.sys 符号不匹配”错误。

对我来说，基本上部署并没有用它的修改版本替换驱动程序。使用`devcon`工具正确安装它，Windbg 将再次快乐。

# language-agnostic - 您如何让初级开发人员参与一个期限紧迫的大型项目？

> ID：471740
> 
> 赞同：7
> 
> 时间：2009-01-23T03:07:21.283
> 
> 标签：language-agnostic

我正在寻找有关如何让初级开发人员有机会在期限紧迫的大型项目中获得经验而又不影响时间表的建议。如果我们都知道由于经验较少，开发人员会花费更长的时间，那么给他们一部分项目并分散风险的最佳方式是什么？让这些开发人员能够在实际项目中学习工作，而不是一直进行维护工作，这对我来说很重要，我想找到一种方法让它发挥作用。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-23T03:20:06.607

您需要知道他们是否掌握了您正在处理的问题。当我必须这样做时，这是我的方法：

*   给他们一块我认为对他们来说是一个延伸但可行的。
*   解释这件作品的重要性，它如何融入大局，以及它们将如何为项目的成功做出贡献。
*   让他们走开，花点时间考虑一下，然后写出几种可能的解决方案，并列出各自的优缺点。这向我展示了他们是否掌握了问题以及他们是否可以设计解决方案。
*   如果他们想出一些看起来合理的东西，那就让他们去做吧。如果没有，我们会再见面并讨论这个问题，然后我再给他们一次机会。

给他们一个设计解决方案的机会，让他们拥有所有权并让他们证明自己。让他们先向您传达设计的优缺点，让您有信心他们可以按时完成解决方案。

如果他们想不出任何可能的解决方案和每个解决方案的可能结果，那么他们就没有准备好解决这个问题。他们将需要更密切的指导和更小的问题，这些问题首先由另一个更熟练的开发人员设计。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-23T03:09:42.527

**非常简短、清晰的目标，经常被衡量和检查。**

一口大小的方法将帮助初级意识到大事是通过做非常小的事情来完成的，非常好，一遍又一遍……

此外，考虑进行概念设计，或功能规范，甚至技术规范，让他们的脚湿透，让他们有越来越多的发言权，如果他们像鱼到水一样接受它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-23T03:31:39.893

虽然这不适用于所有商店，但结对编程是让青少年快速上手的好方法。但是，将他们与一些更善于交际的开发人员配对以获得最佳效果。通过这种方式，他们得到指导，正在做重要的工作，并学习与你的工作风格相关的重要知识，而且你店里更善于交际的开发人员可能会喜欢指导初级人员。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-23T03:19:09.667

你对小学生有多了解？当然，他/她必须对某些事情表现出兴趣或特殊才能。尝试找到易于消化且符合个人资料的项目部分。

分配一名导师并确保设计和代码审查是流程的一部分很重要，尤其是在初级人员不为人知的情况下。

如果初级人员对主题、技术或团队不熟悉，那么确保他/她所从事的工作是记录较好的工作之一可能是有利的（体面的需求定义，甚至可能是技术设计）前辈已经准备好了）。我过去已经能够做到这一点。我对一个中型任务进行了相当充实的技术设计，将其中的一部分分配给了一个新的团队成员，然后还进行了代码审查并纠正了工作。即使花费了时间进行审查和更正，这也是让新开发人员参与并利用他们的能力帮助完成任务的好方法。新开发者在此过程中也学到了很多东西。

# mysql - 如何从 2 个日期范围查询（mysql）

> ID：471741
> 
> 赞同：0
> 
> 时间：2009-01-23T03:07:44.607
> 
> 标签：mysql

我想提取 40 天前和 20 天前的电子邮件，每个范围为 1 天。这就是我所拥有的，但它不返回任何行。

```
SELECT s.*, r.email FROM sellyourcar s 
     INNER JOIN register r ON s.rid = r.slno 
     WHERE s.dt BETWEEN DATE_SUB(curdate(),INTERVAL 20 DAY) AND DATE_SUB(curdate(), INTERVAL 19 DAY) AND 
     s.t BETWEEN DATE_SUB(curdate(),INTERVAL 40 DAY) AND DATE_SUB(curdate(), INTERVAL 39 DAY) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T03:14:31.270

您应该使用 OR 而不是 and 为您的两个间隔：

```
SELECT s.*, r.email 
FROM sellyourcar s INNER JOIN register r ON s.rid = r.slno 
WHERE s.dt BETWEEN DATE_SUB(curdate(),INTERVAL 20 DAY) AND DATE_SUB(curdate(), INTERVAL 19 DAY) 
OR s.dt BETWEEN DATE_SUB(curdate(),INTERVAL 40 DAY) AND DATE_SUB(curdate(), INTERVAL 39 DAY) 
```

另请注意，至少在 Oracle 中，我不确定在 MYSQL 中 BETWEEN 函数是否也会返回与最终项目匹配的项目。例如，在 3 和 5 之间还会返回 3 和 5 而不仅仅是 4 的项目。因此，您可能只想检查电子邮件的日期是否比当前日期少 20 天或 40 天。

# java - JVM 如何使用给定的 jaas.conf 文件？

> ID：471743
> 
> 赞同：0
> 
> 时间：2009-01-23T03:08:15.463
> 
> 标签：java, jvm, jaas

如何设置 JVM 以使用我作为 JAAS 设置创建的给定 jaas.conf？也许有一个 JAAS 选择了我可以在启动时设置的配置属性`-D`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T13:48:10.863

> -Djava.security.auth.login.config=/yourpathtojaas.conf

希望对你有帮助

# java - Java中有多少个JDBC连接？

> ID：471745
> 
> 赞同：19
> 
> 时间：2009-01-23T03:09:15.350
> 
> 标签：java, performance, jdbc, database-connection

我有一个由大约 15 个方法组成的 Java 程序。而且，这些方法在程序执行过程中被非常频繁地调用。目前，我正在每个方法中创建一个新连接并在它们上调用语句（数据库设置在网络上的另一台机器上）。

我想知道的是：我是否应该在主方法中只创建一个连接并将其作为参数传递给所有需要连接对象的方法，因为它会显着减少程序中连接对象的数量，而不是创建并在每种方法中非常频繁地关闭连接。

我怀疑我在当前设计中没有非常有效地使用资源，并且考虑到该程序将来可能会增长很多，还有很大的改进空间。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-23T05:10:28.273

是的，您应该考虑重新使用连接，而不是每次都创建一个新连接。通常的程序是：

*   猜测一下您的数据库可以合理地处理多少个同时连接（例如，从数据库机器上的每个 CPU 2 或 3 个开始，直到您发现这太少或太多——这往往取决于磁盘的方式-绑定您的查询）
*   创建这么多连接的**池**：本质上是一个类，您可以在每个方法开始时请求“下一个空闲连接”，然后在每个方法结束时“传回”到池
*   如果有可用连接，您的 getFreeConnection() 方法需要返回一个免费连接，否则（1）创建一个新连接，直到您决定允许的最大连接数，或者（2）如果已经创建了最大值, 等待一个变得自由
*   我建议使用 Semaphore 类来管理连接；实际上，我的网站上有一篇关于[使用信号量管理资源池](http://www.javamex.com/tutorials/synchronization_concurrency_semaphore2.shtml)的简短文章，并附有一个示例，我认为您可以适应您的目的

几个实际的考虑：

*   为获得最佳性能，您需要注意**不要在实际未使用连接运行查询时“占用”连接**。如果您从池中获取一次连接，然后将其传递给各种方法，则需要确保您不会意外地这样做。
*   不要忘记将您的连接返回到池中！（尝试/终于是你的朋友在这里......）
*   在许多系统上，您**不能“永远”保持连接打开**：操作系统将在最长一段时间后关闭它们。因此，在您的“将连接返回到池”方法中，您需要考虑**“退出”已经存在很长时间的连接**（建立一些记忆机制，例如通过在实际 JDBC 周围有一个**包装器对象**可用于存储此类指标的连接对象）
*   您可能需要考虑使用准备好的语句。
*   随着时间的推移，您可能需要**调整连接池大小**

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-23T03:15:52.700

您可以传递连接，也可以更好地使用 Jakarta Database Connection Pooling 之类的东西。 [http://commons.apache.org/dbcp/](http://commons.apache.org/dbcp/)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-23T03:14:36.573

您应该为此使用连接池。

这样你就可以请求连接并在完成后释放它并将其返回到池中

如果另一个线程想要一个新连接并且该连接正在使用中，则可以创建一个新连接。如果没有其他线程正在使用连接，则可以重复使用该连接。

这样，您可以以某种方式离开您的应用程序（而不是到处传递连接），并且仍然可以正确使用资源。

不幸的是，一流的 ConnectionPools 在独立应用程序中不是很容易使用（它们是应用程序服务器中的默认设置），可能一个微容器（例如 Sping）或一个好的框架（例如 Hibernate）可以让您使用一个。

不过，从头开始编写代码并不难。

:)

[这个谷歌搜索](http://www.google.com/search?&q=jdbc+connection+pool+for+standalone+applications)将帮助您找到更多关于如何使用的信息。

快速浏览

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-24T13:14:08.453

许多 JDBC 驱动程序会为您执行连接池，因此在这种情况下进行额外的池化几乎没有优势。我建议您查看 JDBC 驱动程序的文档。

连接池的另一种方法是

*   为所有具有同步访问的数据库访问建立一个连接。这不允许并发，但非常简单。
*   将连接存储在 ThreadLocal 变量中（覆盖 initialValue()） 如果有少量固定数量的线程，这很有效。

否则，我建议使用连接池。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-24T12:18:43.853

如果您的应用程序是单线程的，或者从单个线程执行所有数据库操作，则可以使用单个连接。假设您出于任何其他原因不需要多个连接，这将是迄今为止最简单的实现。

根据您的驱动程序，在线程之间共享连接也可能是可行的 - 如果您相信您的驱动程序不会对其线程安全性撒谎，这也可以。有关详细信息，请参阅您的驱动程序文档。

通常，“Connection”下面的对象不能安全地从多个线程中使用，因此通常不建议在线程之间共享 ResultSet、Statement 对象等 - 到目前为止，最好的策略是在创建它们的同一线程中使用它们；这通常很容易，因为这些对象通常不会保存太久。

# java - 我可以使用反射发现 Java 类的声明内部类吗？

> ID：471749
> 
> 赞同：44
> 
> 时间：2009-01-23T03:10:13.413
> 
> 标签：java, reflection

在 Java 中，有没有办法使用 JDK 库来发现在另一个类中实现的私有类？还是我需要使用 asm 之类的东西？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-01-23T03:18:51.540

[`Class.getDeclaredClasses()`](http://java.sun.com/javase/6/docs/api/java/lang/Class.html#getDeclaredClasses())是答案。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-01-20T08:56:45.163

```
package com.test;

public class A {

    public String str;

    public class B {
        private int i;
    }
}
package com.test;

import junit.framework.TestCase;

public class ReflectAB extends TestCase {
    public void testAccessToOuterClass() throws Exception {
           final A a = new A();
           final A.B b = a.new B();
           final Class[] parent = A.class.getClasses();
           assertEquals("com.test.A$B", parent[0].getName());
           assertEquals("i" , parent[0].getDeclaredFields()[0].getName());
           assertEquals("int",parent[0].getDeclaredFields()[0].getType().getName());
           //assertSame(a, a2);
        }

} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-23T03:13:54.733

我想这就是你所追求的：类。[获取类（）](http://java.sun.com/javase/6/docs/api/java/lang/Class.html#getClasses())。

# .net - NHibernate 和 REST 服务层

> ID：471753
> 
> 赞同：4
> 
> 时间：2009-01-23T03:11:56.717
> 
> 标签：.net, web-services, nhibernate, rest

如果 ADO.NET Data Services (Astoria) 在 Microsoft 的 ADO.NET Entity Framework 之上添加了一个 REST 层，是否有一个等效的项目在 NHibernate 之上添加一个 REST 层？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T03:21:56.650

编辑 (2012-02-08) 更新链接：[MeanFiddler](http://meanfiddler.sourceforge.net/index.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-07-20T22:24:42.807

我正在寻找类似的东西。我看到 Jonathan Parker 提到的项目可以在 sourceforge 上找到：

[http://meanfiddler.sourceforge.net](http://meanfiddler.sourceforge.net)

但它看起来自 2007 年以来就没有被触及过，所以它可能不会那么有用。

# c# - 将行插入数据集后的数据库更新

> ID：471770
> 
> 赞同：1
> 
> 时间：2009-01-23T03:17:11.280
> 
> 标签：c#, data-binding, insert, dataset

我是数据库编程的新手。在将几行插入 DataSet 对象后，我试图将更新后的 DataSet 写回数据库，但不知道该怎么做。

你能举个例子吗？

*   如果 DataSet 已使用新行更新，则使用什么 SQL 插入命令
*   数据绑定示例 - 特别是考虑到数据库中最初为空的表

我正在使用 SQLExpress 2008 及其 C# WinForms 应用程序。

谢谢

ps：这里的相关问题我已经看过了。这个不同之处在于我首先将我的新数据添加到数据集中，然后想要更新数据库。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-23T03:21:17.183

您需要做的是配置一个包含正确更新命令的 DataAdapter 或 TableAdapter 对象。然后，当您完成更新 DataSet 中的行时，您可以调用 DataAdapter.Update(DataSet) 它会为您完成所有艰苦的工作。

由于您刚开始，我建议您查看使用 XSD 架构工具构建的 TableAdapter 对象。它们允许您简单地将表放入 XSD 以创建模式，然后让向导生成适当的 SQL 命令（它甚至会为您执行存储过程）来处理所有 CRUD 工作。我已经使用了一段时间并且喜欢它们。

编辑：为了响应 Sesh 的请求，Scott Gu 有一个关于使用表适配器的精彩教程[系列](http://weblogs.asp.net/scottgu/archive/2006/06/22/454436.aspx)。我想将其发布在答案中，以便其他人可以轻松找到它。

# asp.net-mvc - 编写返回 PartialViewResult 的 ASP.NET MVC 操作的正确方法

> ID：471777
> 
> 赞同：4
> 
> 时间：2009-01-23T03:19:20.243
> 
> 标签：asp.net-mvc

我为 ASP.NET MVC 控制器编写了一个 Action 方法，用于为用户控件提供模型。

公共类产品控制器：控制器{

```
 public PartialViewResult ProductSummary()
    {
        ViewData.Model = new ProductSummaryModel("42"); // dummy data for now

        return new PartialViewResult()
        {
            ViewData = ViewData
        };
    }
} 
```

我正在使用'futures' `Microsoft.Web.Mvc`dll 并在我的主视图中呈现控件，如下所示：

```
<% Html.RenderAction<ProductsController>(x => x.ProductSummary()); %> 
```

我在这里似乎工作得很好，但我试图谷歌[`new PartialResult()`](http://www.google.com/search?hl=en&q=%22new+PartialViewResult%22)看看我正在做的事情是否遵循正确的模式。

目前，此搜索仅提供 4 个结果！

所以我认为我在控制器中做错了什么。创建返回部分视图的操作方法的正确方法是什么？以及我正在做的事情（如果有的话）是错的还是坏的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-23T14:27:30.893

我通常只使用：

```
return PartialView("MyView", myModel); 
```

但这只是返回一个新的 PartialViewResult("MyView", myModel) 所以它是土豆/土豆。

# asp.net - asp.net http服务器推送到客户端

> ID：471780
> 
> 赞同：18
> 
> 时间：2009-01-23T03:20:38.823
> 
> 标签：asp.net, server-push

将信息从服务器推送到 Web 客户端的最佳方式是什么？我知道可以使用 Silverlight 和 Flash 设置套接字，但我想远离这两种技术。

Gmail 似乎在轮询服务器以获取更新的电子邮件方面做得很好，甚至他们的聊天程序也运行良好（全部在我的网络浏览器中运行）。关于使用 asp.net 做这样的事情的最佳方法的任何想法？

编辑：如果我必须轮询，我想每 2 或 3 秒轮询一次服务器。因此，我不确定如何在不使 Web 服务器在大量使用的情况下瘫痪的情况下做到这一点。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-10T11:08:08.107

既然你提到`ASP.NET`你应该使用`SignalR`. 在此处查看我的其他答案：[Facebook 等即时通知](https://stackoverflow.com/questions/11409563/instant-notifications-like-facebook/11410184#11410184)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-23T03:37:22.377

您正在寻找的推送技术称为 Comet。有关一些提示，请参阅[本文](http://ajaxian.com/archives/comet-not-as-painful-as-you-think)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-23T03:30:45.103

我会创建一个脚本可调用的 Web 服务并使用[JQuery](http://www.jquery.org)。

这是使用 JQuery 调用 ASP.NET (ASMX) Web 服务的一个很好的指南：

[http://encosia.com/2008/03/27/using-jquery-to-consume-aspnet-json-web-services/](http://encosia.com/2008/03/27/using-jquery-to-consume-aspnet-json-web-services/)

现在，您只需在对您的应用程序有意义的任何时间间隔轮询此 Web 服务。

此外，ASP.NET AJAX 的问题是它有点头重脚轻。通过使用 JQuery，您可以从常规的 ASP.NET Web 表单、MVC 中的视图或实际使用任何其他 Web 技术（经典 ASP、PHP 等）从客户端调用您的 Web 服务。查看，最好的 javascript 框架。:)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-01-10T16:36:28.117

试用[WebSync](http://www.frozenmountain.com/websync)，一个为 .NET/IIS 构建的可扩展彗星服务器。它可以让你很好地从服务器推送数据，并超级容易地与 ASP.NET 项目集成（只需几个 web.config 条目）。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-09-21T00:32:45.743

**[PokeIn](http://www.pokein.com/Help/Documentation.aspx)**是一个用于 ASP.NET 和 Mono 的反向 ajax 库。它具有各种功能，例如 .NET 到 JSON，反之亦然。[您可以从这里](http://www.pokein.com/Help/Samples.aspx)下载示例项目

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-23T03:23:16.353

为此，请使用 ASP.NET 3.0/3.5，或者如果您使用的是早期版本，请使用[ASP.NET Ajax](http://www.asp.net/ajax/)。但是，您列出的两个示例都使用 Ajax 来提取信息，而不是推送信息。

# gcc - gcc 编译时注释/msg

> ID：471791
> 
> 赞同：2
> 
> 时间：2009-01-23T03:23:02.513
> 
> 标签：gcc, compiler-warnings

我知道 MSVC 可以通过编译指示消息执行此操作 -> [http://support.microsoft.com/kb/155196](http://support.microsoft.com/kb/155196)
gcc 是否有办法打印用户创建的警告或消息？（我找不到谷歌的解决方案：（）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-23T03:26:17.533

```
#warning "This will only hurt a little bit."
#error "Or maybe a lot!" 
```

# hibernate - 休眠刷新不更新数据库

> ID：471797
> 
> 赞同：0
> 
> 时间：2009-01-23T03:27:13.847
> 
> 标签：hibernate, flush

我正在使用休眠来存储来自 Web 服务的一组对象。

当每个对象都收到时，我正在使用休眠保存它们。

接收对象被包装在事务中，并且在接收到最终对象后，所有对象都出现在数据库中。

我现在正在尝试让每个对象在保存时出现在数据库中。我试图用

```
getHibernateTemplate().saveOrUpdate( foo );

getHibernateTemplate().flush();
getHibernateTemplate().clear(); 
```

我的理解是这应该删除值休眠的缓存并将值写入数据库。

有什么学习或方向吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-01T20:49:39.327

感谢布赖恩的帮助。问题原来是`for`包装保存调用的另一个类中的循环。

解决方案是删除`for`循环并将其替换为`iterator`.

Hibernate 在整个`for`循环中保持相同的事务。使用`iterator`，Hibernate 似乎开始了一个新事务，因此在开始下一个事务之前执行对数据库的提交，然后刷新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T04:57:35.523

如果您仍在事务中，则只有打开事务的会话或连接才能看到记录。在某些数据库中，如果您进行脏/未提交的读取，您应该从另一个会话中看到它们。我会尝试在刷新后使用相同的 Hibernate 会话运行选择，以验证它是否确实在数据库中。只是不要通过主键查询，否则您可能会从缓存中获取它。

# java - Spring 和 hibernate.cfg.xml

> ID：471799
> 
> 赞同：25
> 
> 时间：2009-01-23T03:27:30.307
> 
> 标签：java, hibernate, spring, jpa

如何让 Spring 加载 Hibernate 的属性`hibernate.cfg.xml`？

我们使用 Spring 和 JPA（使用 Hibernate 作为实现）。Spring`applicationContext.xml`指定了 JPA dialect 和 Hibernate 属性：

```
<bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalEntityManagerFactoryBean">
    <property name="jpaDialect">
        <bean class="org.springframework.orm.jpa.vendor.HibernateJpaDialect" />
    </property>
    <property name="jpaProperties">
        <props>
            <prop key="hibernate.dialect">org.hibernate.dialect.MySQLInnoDBDialect</prop>
        </props>
    </property>
</bean> 
```

在这个配置中，Spring 通过 applicationContext.xml 读取所有的 Hibernate 属性。当我创建一个`hibernate.cfg.xml`（位于我的类路径的根目录，与 META-INF 相同的级别）时，Hibernate 根本不会读取它（它被完全忽略）。

我要做的是通过在以下位置插入缓存属性来配置 Hibernate 二级缓存`hibernate.cfg.xml`：

```
<cache 
    usage="transactional|read-write|nonstrict-read-write|read-only"
    region="RegionName"
    include="all|non-lazy"
/> 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-01-26T16:02:05.403

尝试这样的事情......

```
<bean
    id="mySessionFactory"
    class="org.springframework.orm.hibernate3.LocalSessionFactoryBean">

    <property name="configLocation">    
        <value>
            classpath:location_of_config_file/hibernate.cfg.xml
        </value>
    </property>

    <property name="hibernateProperties">
        <props>

            ...    

        </props>    
    </property>

</bean> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-23T05:51:42.200

我之前这样做的方法是实例化[LocalSessionFactoryBean](http://static.springframework.org/spring/docs/2.0.x/api/org/springframework/orm/hibernate3/LocalSessionFactoryBean.html)并设置 configLocation 属性。

# asp.net - 如何强制浏览器不存储 HTML 表单字段数据？

> ID：471800
> 
> 赞同：9
> 
> 时间：2009-01-23T03:28:54.063
> 
> 标签：asp.net, security, xss, forms

在 HTML 表单中键入时，Firefox 或 Internet Explorer 等浏览器会存储这些值，有时会悄悄地存储这些值。因此，当输入另一个网络表单时，浏览器会巧妙地建议相同的信息。显示下拉列表的另一种方法是双击空文本框。

在电子商务网站上，客户键入信用卡号和其他敏感信息。如何避免或阻止浏览器存储敏感信息？

另一个担心是存储的表单数据被篡改（例如恶意软件）。然后客户可以选择这些受污染的数据并破坏该站点。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-23T03:31:45.197

尝试使用属性`autocomplete="off"`

它应该适用于单个输入元素：

```
<input type="text" autocomplete="off" name="text1" /> 
```

或整个表格：

```
<form name="form1" id="form1" method="post" autocomplete="off"
  action="http://www.example.com/action">
[...]
</form> 
```

特别是对于**ASP .NET**，您可以像这样设置它：

WebForms 表单：

```
<form id="Form1" method="post" runat="server" autocomplete="off"> 
```

文本框：

```
<asp:TextBox Runat="server" ID="Textbox1" autocomplete="off"></asp:TextBox> 
```

或在运行时：

```
Textbox1.Attributes.Add("autocomplete", "off"); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-23T03:36:37.307

在此处查看更长的讨论：

[您如何在 Web 表单字段/输入标签上禁用浏览器自动完成功能？](https://stackoverflow.com/questions/2530/how-do-you-disable-browser-autocomplete-on-web-form-field)

看起来 autocomplete="off" 在某些情况下会起作用，但它不符合 XHTML。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-02T17:49:03.107

当您存储用户名、信用卡号等数据时，最好对公共计算机使用 autocomplete="off"。

因此，如果您构建一个 Intranet 系统，则可以这样做。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-23T21:22:19.340

正如其他人所说，答案是`autocomple="off"`

但是我认为值得说明**为什么**在某些情况下使用它是一个好主意，因为对此的一些答案和[重复](https://stackoverflow.com/questions/2530/how-do-you-disable-browser-autocomplete-on-web-form-field)的问题表明最好不要关闭。

停止浏览器存储信用卡号码不应该留给用户。太多的用户甚至不会意识到这是一个问题。

在信用卡安全码字段上将其关闭尤为重要。正如[本页](http://www.mollerus.net/tom/blog/2007/05/my_best_practices_for_online_credit_card_security.html)所述

> “永远不要存储安全码......它的价值取决于提供它的唯一方法是从实体信用卡中读取它的假设，证明提供它的人实际上持有卡。”

问题是，如果它是公共计算机（网吧、图书馆等），那么其他用户很容易窃取您的卡详细信息，甚至在您自己的计算机上，恶意网站也可能[窃取自动完成数据](http://webreflection.blogspot.com/2008/09/security-basis-and-internet-explorer.html)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-23T03:37:15.217

您可以输入输入字段：

```
autocomplete="off" 
```

作为属性。

话虽这么说：**不要这样做。**

从可用性的角度来看，这是一个**糟糕**的主意。特别是如果有字段验证。没有什么比重新输入表格的某些部分更烦人的了，因为您必须更正一个完全不相关的表格。大多数用户喜欢他们不必重新输入信用卡号、姓名、电子邮件地址等这一事实。

通过关闭这些功能，你会惹恼更多的用户而不是你帮助的。

归根结底，安全是用户的问题和他们的特权。绝大多数人使用个人或工作 PC，因此可以缓存此类信息。正确配置的公共终端将在用户注销时清除表单数据。

那么你到底在帮助谁？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-07-12T02:21:33.477

```
<input autocomplete="new-password"> 
```

这适用于“关闭”不适用的地方。

# java - 如何设置 JAAS（在 jaas.conf 中）以使用 NTLoginModule？

> ID：471811
> 
> 赞同：3
> 
> 时间：2009-01-23T03:33:06.457
> 
> 标签：java, jaas

我想一个使用 NTLoginModule 进行身份验证的 jaas.conf 文件示例会有所帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-14T23:08:01.327

我不确定这是否是你的意思，但我想你可能有：

```
 SomeName
{
   com.sun.security.auth.module.NTLoginModule required;
}; 

```

然后你可以使用它：

```
 LoginContext lc = new LoginContext("SomeName", new SomeCallbackHandler());
lc.login(); 

```

该`java.security.auth.login.config`属性应指向配置文件所在的位置。

# c# - 在 C# Web 应用程序中嵌入 IronPython 2 的问题

> ID：471814
> 
> 赞同：4
> 
> 时间：2009-01-23T03:35:31.960
> 
> 标签：c#, ironpython, embedding

**首先是一些背景（以防有帮助）：**

我的应用程序是最近升级到 .Net Framework v3.5 的基于 Web 的框架，但不使用母版页/用户控制系统。它更类似于 MVC 模式（虽然更老），并从模板的响应流中输出纯 HTML。Python 表达式允许实现一些规则和模板变体。

**老办法**

在 C# 中嵌入 IronPython 1.x 引擎时，我们能够执行以下代码：

```
PythonEngine pe = new PythonEngine();
Assembly a = Assembly.LoadFile("path to assembly");
pe.LoadAssembly(a);
pe.Import("Script"); 
```

ipy 2.0 中没有 Import() 方法，并且 ImportModule() 方法的工作方式似乎不同。Import() 减少了在我们编写的每个 python 脚本中添加一行的需要，例如：

```
from MyAssembly import MyClass 
```

MyClass 充满了静态方法，这意味着对 MyClass.MyMethod() 的调用非常有效。我不能只实例化一个对象并将其分配给范围内的变量，因为 MyClass 包含在其中的程序集是在运行时动态加载的。

**现在的问题**

我已经整理了 IronPython 2.0 集成的所有其他部分，但不希望我的实现者在他们编写的每个脚本的顶部键入“from MyAssembly import MyClass”（当 ipy 1 中没有必要时，这似乎很愚蠢.x) 并且可能在一段时间内也是一个支持问题。

**最后是问题**

*有没有人遇到过这个问题并解决了？我是否以错误的方式为 DLR 做事？还是我错过了一些明显的东西？*

我不确定某人需要帮助的细节，但我希望这已经足够了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-23T14:57:27.370

`Scope`加载程序集后，您可以在用于运行脚本的文件中执行导入：

```
ScriptEngine engine = Python.CreateEngine();
engine.Runtime.LoadAssembly(a);
string code = "from MyAssembly import MyClass";
ScriptSource source = engine.CreateScriptSourceFromString(code, "<import>", SourceCodeKind.Statements);
CompiledCode c = source.Compile();

Scope scope = engine.CreateScope();
c.Execute(scope);

// then run your script in the same scope 
```

我们在产品中做了类似的事情。

（希望这是有效的 C# - 我实际上是在 IronPython 本身中尝试过的，因为它更方便。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T21:01:21.103

谢谢威尔伯福斯，

最后我做了以下事情：

```
Assembly a = Assembly.LoadFile("path to assembly");
object var = a.CreateInstance("MyNamespace.MyClass");

Scope.SetVariable("MyClass", var); 
```

这在 C# 中创建了我的类的一个对象，然后将其作为变量传递给 IronPython 范围。

请注意，这是在 C# 范围 (AppDomain) 中创建对象并将其传递给 IronPython。这似乎（到目前为止）适用于我的问题，因为我传递的对象仅包含静态方法，但可能不适用于具有状态的类。

# asp.net - 最佳实践 - 从 Code-Behind 设置 jQuery 属性

> ID：471820
> 
> 赞同：4
> 
> 时间：2009-01-23T03:38:17.227
> 
> 标签：asp.net, jquery

我需要使用在代码隐藏中计算的值在 jQuery 命令中设置单个属性。我最初的想法是`<%= %>`像这样使用它来访问它：

.aspx

```
<script type="text/javascript" language="javascript">
$('.sparklines').sparkline('html', {
    fillColor: 'transparent',
    normalRangeMin: '0',
    normalRangeMax: <%= NormalRangeMax() %>
});
</script> 
```

.aspx.cs

```
protected string NormalRangeMax() {
    // Calculate the value.
} 
```

不过，必须从 ASPX 页面调用才能获得一个值，这听起来很奇怪。更不用说我有一个完整的方法来做一个小的计算来填充一个属性。

一种替代方法是`<script>`在代码隐藏中使用`clientScriptManager.RegisterClientScriptBlock`. 但我真的不喜欢将整个 JavaScript 块放在代码隐藏中，因为它是 JavaScript。

也许如果我最终拥有许多这些方法，我可以将它们放在一个部分类中，这样至少它们在物理上与其余代码是分开的。

您会推荐哪种方法易于理解且易于维护？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-23T07:18:01.900

<% %> 工作正常。我要做的一件事是在页面上的隐藏字段中设置一个值（然后编写必要的 javascript 来提取该值），这很好，因为我可以通过 javascript 更改该隐藏字段以及何时/如果页面回发我可以也可以从后面的代码中获得新的价值。

如果您需要按需调用该方法，您可以对 ASP.NET WebMethod 执行 jQuery AJAX 调用以获取数据并重新填充各种选项。你可以在这里找到一个很好的教程：http: [//encosia.com/2008/05/29/using-jquery-to-directly-call-aspnet-ajax-page-methods/](http://encosia.com/2008/05/29/using-jquery-to-directly-call-aspnet-ajax-page-methods/)

下面是一些使用隐藏字段方法的示例代码（使用 datepicker 控件，但您会明白的）：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="Default.aspx.cs" Inherits="WebApplication1._Default" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
        <div>
            <asp:TextBox ID="txtCalendar" runat="server" />
            <asp:HiddenField ID="hfTest" runat="server" />
        </div>
    </form>

    <script type="text/javascript" src="http://code.jquery.com/jquery-latest.js"></script>

    <script type="text/javascript" src="http://ui.jquery.com/latest/ui/ui.datepicker.js"></script>

    <script type="text/javascript">
    var dateMinimum = new Date($("#<%= hfTest.ClientID %>").val());

    $(function() {
        $("#<%= txtCalendar.ClientID %>")
            .datepicker({
                minDate: dateMinimum
            });
    });
    </script>
</body> 
```

Page_Load 方法背后的代码：

```
protected void Page_Load(object sender, EventArgs e)
{
    // Set Value of Hidden Field to the first day of the current month.
    this.hfTest.Value = new DateTime(DateTime.Today.Year, DateTime.Today.Month, 1).ToString("MM/dd/yyyy");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T03:42:03.833

就个人而言，我会使用 <% %> 方法。这就是视图的用途。我根本不喜欢 RegisterClientScriptBlock。如果你曾经迁移到 MVC，你会习惯 <% %> ... :)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T03:45:48.647

我不久前遇到了这个问题。我推荐 <% %> 用于单变量的东西。我发现 RegisterClientScriptBlock 函数只有在我需要代码隐藏来确定要运行哪些脚本时才有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-23T09:25:40.257

Rick 有一篇关于将服务器变量传递给客户端脚本的好[文章](http://www.west-wind.com/weblog/posts/259442.aspx)

# ruby-on-rails - 向脚手架 RoR 添加字段

> ID：471823
> 
> 赞同：2
> 
> 时间：2009-01-23T03:42:31.820
> 
> 标签：ruby-on-rails

我已经使用此处描述的方法搭建了脚手架[http://wiki.rubyonrails.org/rails/pages/ScaffoldGenerator](http://wiki.rubyonrails.org/rails/pages/ScaffoldGenerator)

但是，我想知道如果我想在运行 ./script/generate 脚手架模型> propertyname:string 之后添加更多字段该怎么办

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T03:45:15.030

```
ruby script/generate migration AddFieldToModel field:string
# edit migration if desired
rake db:migrate 
```

您必须手动更新您的视图。

编辑：有关迁移的更多信息可以在[API 文档中找到](http://api.rubyonrails.org/classes/ActiveRecord/Migration.html)

# sql - 升级到四核 CPU 后需要重新编译 PostgreSQL 吗？

> ID：471829
> 
> 赞同：1
> 
> 时间：2009-01-23T03:46:36.897
> 
> 标签：sql, linux, database, postgresql, 64-bit

我最近将运行 CentOS 5.0 的服务器从双核 CPU 升级到了四核 CPU。我是否需要重新编译才能使用添加的内核？PostgreSQL 是通过从源代码编译安装的。

编辑：升级是从 Intel Xeon 5130 到 Intel Xeon 5345。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-13T08:42:22.333

不，您不需要为 PostgreSQL 重新编译以利用额外的内核。

将会发生的事情是，Linux 调度程序现在将能够选择两个或更多（最多四个）postgresql 线程/进程同时运行，基本上它们是并行工作而不是必须相互等待才能获得一段 CPU 时间。这意味着您能够更快地处理数据，因为现在可以同时处理四个不同的查询，而不仅仅是之前的两个。

PostGreSQL 无需进一步调整即可利用多核/物理 CPU，这完全取决于操作系统。您基本上以新 CPU 的成本提高了性能。

如果您正在寻找有关调整 PostgreSQL 的信息，请查看[这篇关于在专用服务器上调整 PostgreSQL 的帖子](http://www.anchor.com.au/hosting/dedicated/Tuning_PostgreSQL_on_your_Dedicated_Server)。

由于您现在可以同时运行更多进程，您可能还需要考虑根据您当前安装的内容升级您拥有的 RAM 量，数据库能够存储在内存中的越多，所有交易和查询将是！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T04:05:02.260

如果它是相同的架构，我认为不需要重新编译。

如果它是不同的架构（x86 vs x86_64 vs amd64 等），那么您将不得不重新编译。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T04:56:50.080

不，多处理是动态处理的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-23T13:32:03.393

大概新旧芯片都运行 x86_64 架构。不需要重新编译，但是对数据库和/或应用程序进行一些调整可能是为了充分利用这些额外的内核。

# ios - 为什么 NSUserDefaults 无法在 iOS 中保存 NSMutableDictionary？

> ID：471830
> 
> 赞同：145
> 
> 时间：2009-01-23T03:47:08.317
> 
> 标签：ios, objective-c, cocoa-touch, nsuserdefaults, nscoding

我想将一个`NSMutableDictionary`对象保存在`NSUserDefaults`. 中的键类型`NSMutableDictionary`是`NSString`，值类型是`NSArray`，其中包含实现的对象列表`NSCoding`。每个文档，`NSString`并且`NSArray`两者都符合`NSCoding`.

我收到此错误：

> [NSUserDefaults setObject: forKey:]: 尝试插入 NSCFDictionary 类的非属性值....

* * *

## 回答 #1

> 赞同：230
> 
> 时间：2009-01-23T04:56:44.447

我发现了一种替代方法，在保存之前，我使用以 .结尾的根对象（`NSArray`对象）进行编码。然后使用 UserDefaults 保存.`NSKeyedArchiver``NSData``NSData`

当我需要数据时，我读出`NSData`, 并用它`NSKeyedUnarchiver`来转换`NSData`回对象。

这有点麻烦，因为我`NSData`每次都需要转换为/从，但它确实有效。

以下是每个请求的一个示例：

节省：

```
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
NSMutableArray *arr = ... ; // set value
NSData *data = [NSKeyedArchiver archivedDataWithRootObject:arr];
[defaults setObject:data forKey:@"theKey"];
[defaults synchronize]; 
```

加载：

```
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
NSData *data = [defaults objectForKey:@"theKey"];
NSArray *arr = [NSKeyedUnarchiver unarchiveObjectWithData:data]; 
```

数组中的元素实现

```
@interface CommentItem : NSObject<NSCoding> {
    NSString *value;
} 
```

然后在实现中`CommentItem`，提供了两种方法：

```
-(void)encodeWithCoder:(NSCoder *)encoder
{
    [encoder encodeObject:value forKey:@"Value"];
}

-(id)initWithCoder:(NSCoder *)decoder
{
    self.value = [decoder decodeObjectForKey:@"Value"];
    return self;
} 
```

有人有更好的解决方案吗？

谢谢大家。

* * *

## 回答 #2

> 赞同：105
> 
> 时间：2009-01-23T04:44:19.607

如果您将对象保存在用户默认值中，则所有对象，递归地，一直向下，必须是属性列表对象。符合 NSCoding 在这里没有任何意义——`NSUserDefaults`不会自动将它们编码为`NSData`，你必须自己做。如果您的“实现的对象列表`NSCoding`”表示不是属性列表对象的对象，那么您必须在保存为用户默认值之前对它们进行处理。

仅供参考，属性列表类是`NSDictionary`、`NSArray`、`NSString`、`NSDate`、`NSData`和`NSNumber`。您可以将可变子类（如`NSMutableDictionary`）写入用户首选项，但您读出的对象将始终是不可变的。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-01-23T04:38:59.070

您的所有键都在字典中`NSString`吗？我认为他们必须是为了将字典保存到属性列表中。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-02-04T09:11:17.937

**最简单的答案：**

`NSDictionary`只是一个**plist 对象**，如果**键是 NSStrings**。因此，将**“密钥”**与`NSString`.`stringWithFormat`

* * *

**解决方案 ：**

```
NSString *key = [NSString stringWithFormat:@"%@",[dictionary valueForKey:@"Key"]]; 
```

* * *

**好处 ：**

1.  它将添加*String-Value*。
2.  当您的变量值为 时，它将添加*空值*`NULL`。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-25T17:34:20.680

您是否考虑过实施该`NSCoding`协议？这将允许您在 iPhone 上使用两种简单的方法进行编码和解码，这些方法使用`NSCoding`. 首先，您需要将 添加`NSCoding`到您的类中。

这是一个例子：

这是在 .h 文件中

```
@interface GameContent : NSObject <NSCoding> 
```

然后你需要实现 NSCoding 协议的两种方法。

```
 - (id) initWithCoder: (NSCoder *)coder
    {
        if (self = [super init])
        {
               [self setFoundHotSpots:[coder decodeObjectForKey:@"foundHotSpots"]];
        }
        return self;
    }

    - (void) encodeWithCoder: (NSCoder *)coder
    {
           [coder encodeObject:foundHotSpots forKey:@"foundHotSpots"];
    } 
```

查看 NSCoder 上的文档以获取更多信息。这对于我的项目来说非常方便，如果应用程序关闭，我需要在 iPhone 上保存应用程序的状态，并在重新打开时将其恢复到它的状态。

关键是将协议添加到接口中，然后实现属于`NSCoding`.

我希望这有帮助！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-24T00:47:49.347

没有更好的解决方案。另一种选择是将编码对象保存到磁盘 - 但这是做同样的事情。他们都以 NSData 结束，当你想要它回来时，它会被解码。

# vb6 - 在vb6中使用ini文件，文件路径有问题

> ID：471832
> 
> 赞同：1
> 
> 时间：2009-01-23T03:48:54.053
> 
> 标签：vb6, path, ini

我已经阅读了很多关于如何在我的 VB6 项目中使用 INI 文件的文章。我的方法没有问题，我的问题是如何让EXE文件找到INI文件。我不想在程序中硬编码路径。我只是希望 EXE 期望 INI 文件存在于执行 EXE 的同一文件夹中。

当我从 VB6 IDE 内部运行程序时，会找到并处理 INI。当我编译程序并运行 EXE 时，什么也没找到。

我的代码如下所示：

```
gServer = sGetINI(sINIFile, "TOOLBOM", "ServerName", "?") 
```

`TOOLBOM`[Section]在哪里，“ `ServerName`”是值的键。

我获得了 API 的以下代码：

```
Rem API DECLARATIONS
Declare Function GetPrivateProfileString Lib "kernel32" Alias _
                 "GetPrivateProfileStringA" (ByVal lpApplicationName _
                 As String, ByVal lpKeyName As Any, ByVal lpDefault _
                 As String, ByVal lpReturnedString As String, ByVal _
                 nSize As Long, ByVal lpFileName As String) As Long
Declare Function WritePrivateProfileString Lib "kernel32" Alias _
                 "WritePrivateProfileStringA" (ByVal lpApplicationName _
                 As String, ByVal lpKeyName As Any, ByVal lpString As Any, _
                 ByVal lpFileName As String) As Long
Public Function sGetINI(sINIFile As String, sSection As String, sKey _
                As String, sDefault As String) As String
    Dim sTemp As String * 256
    Dim nLength As Integer
    sTemp = Space$(256)
    nLength = GetPrivateProfileString(sSection, sKey, sDefault, sTemp, _
              255, sINIFile)
    sGetINI = Left$(sTemp, nLength)
End Function
Public Sub writeINI(sINIFile As String, sSection As String, sKey _
           As String, sValue As String)
    Dim n As Integer
    Dim sTemp As String
    sTemp = sValue
    Rem Replace any CR/LF characters with spaces
    For n = 1 To Len(sValue)
        If Mid$(sValue, n, 1) = vbCr Or Mid$(sValue, n, 1) = vbLf _
        Then Mid$(sValue, n) = " "
    Next n
    n = WritePrivateProfileString(sSection, sKey, sTemp, sINIFile)
End Sub 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-26T17:39:04.290

Bob 是对的，只要有人尝试在 Vista 或更高版本上运行它，它就会失败。可写数据文件不应该放在 Program Files 中。Windows 现在强制执行这些规则。所有用户的全局设置属于一个文件夹，每个用户的设置属于另一个文件夹，每个用户的漫游设置属于另一个文件夹，等等。

Karl Peterson 的这篇[Visual Studio Magazine 文章](http://visualstudiomagazine.com/columns/article.aspx?editorialsid=2962)提供了一些 VB6 代码，您可以将其放入项目中，以便在运行时查找这些文件夹的位置。然后同一作者的[上一篇文章](http://visualstudiomagazine.com/columns/article.aspx?editorialsid=2922)为您提供了一个很好的使用 INI 文件的类，以隐藏那些 API 声明。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-23T04:00:51.270

在 VB6 中，您可以使用 App.Path 来指定应该在您正在执行的目录中的文件的路径。例如

```
sIniFile = App.Path & "\myIniFile.ini" 
```

你得到的错误是什么？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T22:57:10.663

一旦有人尝试在 Vista 或更高版本上运行它，这将失败。

可写数据文件不应该进入程序文件。由于人们无论如何都这样做了，Windows 开始执行从 Vista 开始的规则。

全局设置属于 CommonAppData 下的应用程序文件夹，每个用户的设置位于 LocalAppData 下，每个使用的漫游设置位于 AppData 下，依此类推。这些位置是在运行时通过 Shell 对象或 API 调用检索的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-24T04:43:56.143

您将需要使用脚本运行时中的 FileSystemObject 来正确组合路径和文件名。尽管在现实中这似乎是一个微不足道的问题，但 FileSystemObject 可以处理一些极端情况。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-16T10:07:24.733

app.path 将返回当前执行的 exe 的路径，使用它

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-06-10T09:00:09.383

将EXE保存在同一文件夹中

# forms - 谷歌风格的自动完成教程/示例

> ID：471833
> 
> 赞同：3
> 
> 时间：2009-01-23T03:50:36.530
> 
> 标签：forms, autocomplete

我有一个应用程序可以在填写输入字段时受益于谷歌风格的自动完成功能。

关于如何实现的任何指示，或者我可以提供帮助的包？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-23T03:59:53.377

为此，我使用[jQuery](http://jquery.com/)和[Autocomplete 插件](http://www.pengoworks.com/workshop/jquery/autocomplete.htm)。如果编写了合适的数据提供程序，它允许在本地 JavaScript 数组中指定数据，或通过网络接收数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-23T03:57:11.713

这是一个使用 jQuery 进行 ajax 的不错的教程[http://nodstrum.com/2007/09/19/autocompleter/](http://nodstrum.com/2007/09/19/autocompleter/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T04:24:49.800

我使用[script.aculo.us 自动补全](http://demo.script.aculo.us/ajax/autocompleter_customized)。该演示在 Rails 中，但我将它与 PHP 一起使用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-02-12T10:49:26.430

现在 jQueryUI 是一个不错的选择：

[http://jqueryui.com/demos/autocomplete/](http://jqueryui.com/demos/autocomplete/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-03-22T13:36:18.400

如果你想在没有 jQuery 的情况下自己做，只需更改 .pac-container，如下所示：

```
 { width:280px !important; font-family:Tahoma;} 
```

或访问此网站：[http ://benkammerling.wordpress.com/2012/02/17/google-maps-places-autocomplete-styling-in-css/](http://benkammerling.wordpress.com/2012/02/17/google-maps-places-autocomplete-styling-in-css/)

想想帮助U。

# apache - mod_rewrite 在日志中生成错误

> ID：471840
> 
> 赞同：1
> 
> 时间：2009-01-23T03:59:27.277
> 
> 标签：apache, .htaccess, mod-rewrite, logging

在我的网站上，我有 mod_rewrite 规则以使 URL 对搜索引擎更加友好，并且在前端一切正常，但是我在错误日志中遇到了这样的错误

```
[Thu Jan 22 22:51:36 2009] [error] [client {IP ADDRESS HERE}] File does not exist: /{some rewritten directory} 
```

我使用的规则非常简单，大致如下

```
RewriteRule ^pages/(.*)_(.*).html$ page.php?id=$2 
```

有没有办法避免这些错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T10:42:24.843

[`MultiViews`](http://httpd.apache.org/docs/2.2/mod/core.html#options)可能导致这种情况。如果启用，Apache 会在将请求传递给 mod_rewrite 之前尝试查找类似于请求的 URI 的文件。所以尝试禁用它：

```
Options -MultiViews 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T04:34:45.817

我不认为这些错误与 mod_rewrite 有任何关系，他们只是说文件不存在。普通的旧 404 错误。

顺便说一句，重写模式通常不应该以斜杠开头吗？像这样：

```
RewriteRule ^/pages/(.*)_(.*).html$ /page.php?id=$2 
```

# user-interface - 好的和坏的应用程序用户界面设计的例子？

> ID：471850
> 
> 赞同：3
> 
> 时间：2009-01-23T04:02:57.160
> 
> 标签：user-interface

我是一名盲人学生，正在参加必修的 UI 课程。其中一项任务是截取一个好的和坏的应用程序用户界面的屏幕截图，并评论它的优缺点。我将有一位读者帮助向我描述界面，但希望可以查看应用程序的指针。它们必须是 Windows 应用程序。在答案中，我想要一个指向应用程序的链接以及关于在 UI 中关注的内容的简短评论，例如配色方案很糟糕、控件标签错误、布局混乱等。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-23T04:23:29.960

盲人的界面体验是 UI 设计的一个相关方面。如果我处于你的位置，我就不会过多关注用户界面的视觉方面。从你的个人经历出发。作为一个盲人，你有什么应用程序很难使用？哪些应用程序使用起来很愉快？

如果我处于你老师的位置，我会发现这样的描述远比试图假装你可以看到，并且颜色或字体之类的东西与你相关的尝试更有价值。（除非你只是部分失明，在这种情况下字体大小可能确实是一个相关因素）

在我的领域中有很多人对盲人的评价和评价非常感兴趣。不仅仅是在学术背景下。我为一个政府组织工作，该组织需要让残疾人可以使用其资源。不要仅仅因为一个措辞不当的任务而卖断你自己的观点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-23T04:14:12.317

有点旧，但写得很好，有很多例子：[http ://homepage.mac.com/bradster/iarchitect/shame.htm](http://homepage.mac.com/bradster/iarchitect/shame.htm)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T04:21:25.737

*   好：Microsoft Office 2007
*   坏：Microsoft Office 2003

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-23T19:57:30.057

就 Windows 应用程序而言，我喜欢 Microsoft Outlook 作为 UI 的正面示例。Microsoft Outlook 的布局已被许多其他软件模仿。它允许/促进快速轻松地导航和搜索各种信息，而用户只需很少的努力。它允许用户以不同的格式（消息预览、列表、est.）查看他们的信息，并调整 UI 以满足他们的需求，并使对他们最有价值的信息最普遍/易于接受。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-21T00:33:11.690

我不得不假设你已经完成了这项任务，但我想对 Breton 的建议表示赞赏。如果有一件事最常被忽视，那就是视障用户的考虑。我经常引导有抱负的 Web 开发人员访问[http://colorfilter.wickline.org/](http://colorfilter.wickline.org/)，以便他们可以通过各种过滤器运行他们的页面。如果有人对他们的应用程序进行屏幕截图，他们可以将其嵌入到网页中并通过测试仪运行它。

# php - 使用 Zend Layout 时添加 RSS 自动检测

> ID：471856
> 
> 赞同：3
> 
> 时间：2009-01-23T04:07:43.393
> 
> 标签：php, zend-framework, rss

我有一个使用 Zend Layouts 的网站，在某些页面上我想添加 RSS 自动检测（在 head 部分添加一个 <link> ）。如何将其添加到某些页面上的布局中？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-23T17:34:28.850

添加到您的视图中：

```
<? $this->headLink()->appendAlternate('/feed/', 'application/rss+xml', 'RSS Feed'); ?> 
```

添加到您的布局中`<head>`

```
<?= $this->headLink() ?> 
```

# c# - C#：如何在列表视图中编辑项目和子项目？

> ID：471859
> 
> 赞同：30
> 
> 时间：2009-01-23T04:10:52.420
> 
> 标签：c#, listview

如何在列表视图中编辑项目和子项目？假设我有一个包含 3 列和子项的列表视图，

```
汽车品牌 | 车名 | 车年
福特 | 野马 | 2000
道奇 | 充电器 | 2007年

```

如果我需要在运行时在触发事件时进行编辑，我将如何将这样的项目添加到 listview 以及如何编辑让我们说索引 [] 所在行的汽车名称？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-11-18T12:16:24.847

如果您正在寻找“就地”编辑 a`ListView`的内容（特别是详细视图模式下 ListView 的子项），您需要自己实现，或使用第三方控件。

默认情况下，您可以使用“标准”实现的最佳效果`ListView`是将其`LabelEdit`属性设置为 true 以允许用户编辑第一列的文本`ListView`（假设您希望允许自由格式的文本编辑）。

`ListView`允许“就地”编辑子项的自定义的一些示例（包括完整的源代码）是：

[C# Editable ListView](http://www.csharphelp.com/2006/10/c-editable-listview/)
[就地编辑 ListView 子项](http://www.codeproject.com/KB/list/ListViewCellEditors.aspx)

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-02-28T18:38:08.820

我使用隐藏的文本框来编辑所有列表视图项/子项。唯一的问题是文本框需要在文本框外发生任何事件时立即消失，并且列表视图不会触发滚动事件，因此如果滚动列表视图，文本框仍然可见。[为了绕过这个问题，我用这个覆盖的列表视图](https://stackoverflow.com/questions/372034/how-do-i-listen-for-scrolling-in-a-listview)创建了 Scroll 事件。

这是我的代码，我经常重复使用它，所以它可能对某人有所帮助：

```
ListViewItem.ListViewSubItem SelectedLSI;
private void listView2_MouseUp(object sender, MouseEventArgs e)
{
    ListViewHitTestInfo i = listView2.HitTest(e.X, e.Y);
    SelectedLSI = i.SubItem;
    if (SelectedLSI == null)
        return;

    int border = 0;
    switch (listView2.BorderStyle)
    {
        case BorderStyle.FixedSingle:
            border = 1;
            break;
        case BorderStyle.Fixed3D:
            border = 2;
            break;
    }

    int CellWidth = SelectedLSI.Bounds.Width;
    int CellHeight = SelectedLSI.Bounds.Height;
    int CellLeft = border + listView2.Left + i.SubItem.Bounds.Left;
    int CellTop =listView2.Top + i.SubItem.Bounds.Top;
    // First Column
    if (i.SubItem == i.Item.SubItems[0])
        CellWidth = listView2.Columns[0].Width;

    TxtEdit.Location = new Point(CellLeft, CellTop);
    TxtEdit.Size = new Size(CellWidth, CellHeight);
    TxtEdit.Visible = true;
    TxtEdit.BringToFront();
    TxtEdit.Text = i.SubItem.Text;
    TxtEdit.Select();
    TxtEdit.SelectAll();
}
private void listView2_MouseDown(object sender, MouseEventArgs e)
{
    HideTextEditor();
}
private void listView2_Scroll(object sender, EventArgs e)
{
    HideTextEditor();
}
private void TxtEdit_Leave(object sender, EventArgs e)
{
    HideTextEditor();
}
private void TxtEdit_KeyUp(object sender, KeyEventArgs e)
{
    if (e.KeyCode == Keys.Enter || e.KeyCode == Keys.Return)
        HideTextEditor();
}
private void HideTextEditor()
{
    TxtEdit.Visible = false;
    if (SelectedLSI != null)
        SelectedLSI.Text = TxtEdit.Text;
    SelectedLSI = null;
    TxtEdit.Text = "";
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2011-02-09T03:43:12.900

单击列表视图中的项目。添加一个将编辑所选项目的按钮。添加代码

```
try
{              
    LSTDEDUCTION.SelectedItems[0].SubItems[1].Text = txtcarName.Text;
    LSTDEDUCTION.SelectedItems[0].SubItems[0].Text = txtcarBrand.Text;
    LSTDEDUCTION.SelectedItems[0].SubItems[2].Text = txtCarName.Text;
}
catch{} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2010-06-30T05:52:02.913

抱歉，没有足够的代表，或者会对[CraigTP 的回答](https://stackoverflow.com/questions/471859/c-how-do-you-edit-items-and-subitems-in-a-listview/1755588#1755588)发表评论。

我从第一个链接中找到了解决方案 - [C# Editable ListView](https://web.archive.org/web/20060317101236/http://www.csharphelp.com/archives2/archive341.html)，非常易于使用。总体思路是：

*   识别`SubItem`被选中的 并在 a 上覆盖`TextBox`'`SubItem`的文本`SubItem`
*   把`TextBox`重点放在
*   将`SubItem`的 文本 更改 为失去 焦点`TextBox`时的 文本`TextBox`

*一个看似简单的操作的解决方法是*什么：-|**

 ** * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-01-30T06:57:18.990

```
private void listView1_MouseDown(object sender, MouseEventArgs e)
{
    li = listView1.GetItemAt(e.X, e.Y);
    X = e.X;
    Y = e.Y;
}

private void listView1_MouseUp(object sender, MouseEventArgs e)
{
    int nStart = X;
    int spos = 0;
    int epos = listView1.Columns[1].Width;
    for (int i = 0; i < listView1.Columns.Count; i++)
    {
        if (nStart > spos && nStart < epos)
        {
            subItemSelected = i;
            break;
        }

        spos = epos;
        epos += listView1.Columns[i].Width;
    }
    li.SubItems[subItemSelected].Text = "9";
} 
```

# asp.net-mvc - ASP.NET MVC 和自动 RESTful 功能

> ID：471860
> 
> 赞同：1
> 
> 时间：2009-01-23T04:11:53.663
> 
> 标签：asp.net-mvc, rest

ASP.NET MVC 是否具有像 Ruby on Rails 2.0 这样的 RESTful 开箱即用的特性？
例如：[cURL 和您的 Rails 2 应用程序](http://www.viget.com/extend/curl-and-your-rails-2-app/)

我认为这是对模型的内置 REST 访问。由于模型可以在 ASP.NET MVC 中以不同的方式实现，是否有这样的功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T04:33:14.527

我认为我现在所知道的最接近这一点的是 Rob Conery 正在做的一些工作：

[http://blog.wekeroad.com/blog/subsonic-mvc-scaffold-addin/](http://blog.wekeroad.com/blog/subsonic-mvc-scaffold-addin/)

这并不完全是您所要求的，但它通过脚手架而不是 cURL 类型实现提供了您想要的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T06:52:58.723

在[MvcContrib](http://www.codeplex.com/MVCContrib)开源项目中有一个名为[SimplyRestfulRouteHandler](http://www.codeplex.com/MVCContrib/Wiki/View.aspx?title=SimplyRestfulRouting&referringTitle=Documentation)的类。使用此类，您可以将遵循 REST 方法的路由添加到您的站点。

这是一篇关于如何使用它的好[帖子。](http://kevinortman.blogspot.com/2008/04/simplyrestfulroutehandler-sample.html)

# java - 如何从java调用unix脚本？

> ID：471870
> 
> 赞同：1
> 
> 时间：2009-01-23T04:18:12.450
> 
> 标签：java, unix, exec

我想删除日志目录中的旧日志文件。要删除超过 6 个月的日志文件，我编写了如下脚本

查找 /dnbusr1/ghmil/BDELogs/import -type f -mtime +120 -exec rm -f {} \;

通过使用此脚本，我可以删除旧文件，但是如何使用 java 调用此脚本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-23T04:21:20.870

使用[java.lang.Runtime.exec()](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Runtime.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-23T06:41:12.070

如果可移植性是一个问题，阻止您使用 Runtime.exec() 运行，那么使用 File 和 FilenameFilter 在 Java 中编写此代码非常简单。

编辑：这是删除目录树的静态方法...您可以很容易地添加过滤逻辑：

```
static public int deleteDirectory(File dir, boolean slf) {
    File[]                              dc;                                     // directory contents
    String                              dp;                                     // directory path
    int                                 oc=0;                                   // object count

    if(dir.exists()) {
        dir=dir.getAbsoluteFile();

        if(!dir.canWrite()) {
            throw new IoEscape(IoEscape.NOTAUT,"Not authorized to delete directory '"+dir+"'.");
            }

        dp=dir.getPath();
        if(dp.equals("/") || dp.equals("\\") || (dp.length()==3 && dp.charAt(1)==':' && (dp.charAt(2)=='/' || dp.charAt(2)=='\\'))) {
            // Prevent deletion of the root directory just as a basic restriction
            throw new IoEscape(IoEscape.GENERAL,"Cannot delete root directory '"+dp+"' using IoUtil.deleteDirectory().");
            }

        if((dc=dir.listFiles())!=null) {
            for(int xa=0; xa<dc.length; xa++) {
                if(dc[xa].isDirectory()) {
                    oc+=deleteDirectory(dc[xa]);
                    if(!dc[xa].delete()) { throw new IoEscape(IoEscape.GENERAL,"Unable to delete directory '"+dc[xa]+"' - it may not be empty, may be in use as a current directory, or may have restricted access."); }
                    }
                else {
                    if(!dc[xa].delete()) { throw new IoEscape(IoEscape.GENERAL,"Unable to delete file '"+dc[xa]+"' - it may be currently in use by a program, or have restricted access."); }
                    }
                oc++;
                }
            }

        if(slf) {
            if(!dir.delete()) { throw new IoEscape(IoEscape.GENERAL,"Unable to delete directory '"+dir+"' - it may not be empty, may be in use as a current directory, or may have restricted access."); }
            oc++;
            }
        }
    return oc;
    } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-23T07:08:48.393

当您只想调用您描述的命令时：

```
Runtime r = Runtime.getRuntime();
Process process = r.exec("find /dnbusr1/ghmil/BDELogs/import -type f -mtime +120 -exec rm -f {} \\;"); //$NON-NLS-1$
process.waitFor(); 
```

如果您想调用多个命令，请使用 Chris Jester-Young 回答。exec 方法还可以定义您要使用的文件。其他答案链接方法描述。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-23T04:23:28.960

在 Java 中使用系统调用是可能的，但通常不是一个好主意，因为您将失去代码的可移植性。您可以查看[Ant](http://ant.apache.org/)并使用类似[purge task](http://www.dallaway.com/ant/)的东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-23T04:32:14.967

添加到 Crashworks 的答案中，您在以下参数中调用`cmdarray`：

```
new String[] {"find", "/dnbusr1/ghmil/BDELogs/import", "-type", "f",
    "-mtime", "+120", "-exec", "rm", "-f", "{}", ";"} 
```

如果您`find`支持该`-exec ... {} +`语法，`";"`请将末尾的 更改为`"+"`. 它将使您的命令运行得更快（它将`rm`一次调用一批文件，而不是每个文件一次）。

# http - 还有哪些其他可用的通用 http 客户端？

> ID：471871
> 
> 赞同：0
> 
> 时间：2009-01-23T04:19:32.167
> 
> 标签：http

除了[jakarta commons http 客户端](http://hc.apache.org/httpclient-3.x/)，还有哪些通用的 http 客户端？你能指出你的学习经历吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T04:27:59.623

[LWP](http://gitorious.org/projects/libwww-perl)是 Perl 的标准 HTTP 库。我并没有经常使用它，但我确实使用了它的配套命令行实用程序（`GET`、`POST`等），它们具有一组有用的功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-23T04:33:26.477

[cURL](http://curl.haxx.se/)（又名 libcurl）。libcurl 绑定了大约 40 种不同的编程语言。

# c++ - 继承的成员函数的重载

> ID：471882
> 
> 赞同：15
> 
> 时间：2009-01-23T04:28:14.007
> 
> 标签：c++, inheritance, overloading

一个类可以重载公共继承接口中也存在的方法吗？看起来这是明确且有用的，但编译器（VC、Intel、GCC）都抱怨，至少在我的构造中是这样。下面是一个玩具示例。继承的反弹() 函数有两个明确的重载，但这不会编译。如果你在任一类中**重命名**rebound() 方法，它可以正常工作，但如果它们共享相同的成员函数名（即使它们被不同的参数类型重载！）你会得到一个致命错误“函数的参数太少称呼。”

解决方法很简单（我将重命名方法），但我只是想了解这是否是 C++ 限制（以及为什么会这样）。

```
 #include 
class Bound {
public:
  Bound() : x0(0.0), x1(0.0) {};
  Bound(double x) : x0(x), x1(x) {};
  double width() const {return x1-x0;}
  void rebound(const Bound *a, const Bound *b);
private:
  double x0, x1;
};

void Bound::rebound(const Bound *a, const Bound *b)
{
  if (a && b) {
    x0=std::min(a->x0, b->x0);
    x1=std::max(a->x1, b->x1);
  }
}

class Node : public Bound {
public:
  Node(double x) : Bound(x), left(0), right(0) {};
  Node(Node *a, Node *b) : left(a), right(b) {rebound();}
  void rebound() { rebound(left, right); }
private:
  Node *left;
  Node *right;
};

int main() {
  Node A(1.0);
  Node B(2.0);
  Node C(&A, &B);
} 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-23T04:35:13.507

你可以做三件事：

### 1.取消隐藏基类方法

`using`在`Node`声明中添加：

```
using Bound::rebound;
void rebound() { rebound(left, right); } 
```

### 2.显式引用基类方法

使用绑定命名空间：

```
void rebound() { Bound::rebound(left, right); } 
```

### 3.定义/重新定义派生类中的所有重载

将实现委托给基类（如果这是在标头中完成的，由于内联，不应该有任何惩罚）：

```
void rebound(const Bound *a, const Bound *b) { Bound::rebound(a, b); };
void rebound() { rebound(left, right); } 
```

更多信息： [https ://isocpp.org/wiki/faq/strange-inheritance#overload-derived](https://isocpp.org/wiki/faq/strange-inheritance#overload-derived)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-23T04:41:40.000

当您在子类中声明具有相同名称但签名不同的方法时，它实际上对父类隐藏了版本。

您可以将其专门称为 Bound::rebound(...) 或使用 using 关键字。

看[这里](http://www.parashift.com/c++-faq-lite/strange-inheritance.html#faq-23.9)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T04:41:06.930

这称为*隐藏*父成员函数。您可以显式调用它（`Bound::rebound(left, right)`正如@Ates Goral 所说），也可以`using Bound::rebound`在`Node`类定义中添加 a 。

有关更多信息，请参阅[http://www.parashift.com/c++-faq-lite/strange-inheritance.html#faq-23.9](http://www.parashift.com/c++-faq-lite/strange-inheritance.html#faq-23.9)。

# database - 动态选择要写入 Appengine 数据存储区的属性

> ID：471895
> 
> 赞同：1
> 
> 时间：2009-01-23T04:36:11.993
> 
> 标签：database, google-app-engine, module, google-cloud-datastore, gae-module

有没有人尝试动态选择他们想要写入 appengine 上的实体的属性？例如：

我有一个包含 5 个字段的网络表单，任何给定的用户都会填写这些字段的一部分。我只将带有数据的字段发布到服务器（例如字段 1、2、4）。在服务器端，我如何优雅地只写属性 1,2 和 4？Model 类有一个函数，它返回一个属性名称字典 (Model.properties())，但我将如何使用它来选择属性名称？

在 SQL 中，我将通过将 POST 字段与 Model.properties() 字典相匹配来构建一个 INSERT 或 UPDATE 语句。我会查看 Appengine SDK 中的 db 模块代码，看看 Model 类是否有一些 Property 对象的集合，但我在磁盘上找不到该模块（我对 python 和 appengine 有点陌生）。

更新：我阅读了 trunk/google/appengine/ext/db/ **init** .py ，它确认无法将属性作为一个组来引用。有人知道解决方法吗？

有什么想法吗？

更新 2：Google Group for AppEngine 回答了这个问题：[http ://groups.google.com/group/google-appengine/browse_thread/thread/b50be862f6d94b6e#](http://groups.google.com/group/google-appengine/browse_thread/thread/b50be862f6d94b6e#)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-26T05:17:06.610

python 模块看起来像这样：

```
from google.appengine.ext.db import Key
from google.appengine.api.datastore import Get, Put

def edit_item(request, db_id):

    objKey = Key(str(db_id))

    if request.method == 'POST':
        objEntity = Get(objKey)
        for k, v in request.POST.iteritems():
             objEntity[k]=v
        Put(objEntity)
        return HttpResponseRedirect('/')

    query = TestModel.get(objKey)
    return render_to_response('edit.html', ({'modify_data': query,})) 
```

您的 HTML 应如下所示：

```
<form method="POST" action="." enctype="multipart/form-data">
  Title: <input type="text" name="title" value="{{modify_data.field1}}"/>
  Text: <input type="text" name="txt" value="{{modify_data.field2}}"/>

  <input type="submit"/>
</form> 
```

# git - 使用 git 时，如何将确切的工作目录推送到远程？

> ID：471896
> 
> 赞同：5
> 
> 时间：2009-01-23T04:37:38.013
> 
> 标签：git

我有一个远程 git repo 和一个本地克隆。假设我丢失了本地 .git 目录，随后在本地工作目录中添加和删除了一些文件。

在某些时候，我想重新初始化本地 repo，将其连接到远程，并最终将我的本地工作目录完全按原样推送到远程（也就是说，我希望拥有所有添加/删除的文件在遥控器中是一样的）

我将如何做到这一点？

这是我当前的解决方案，我不喜欢（并且可能不适用于所有情况）。

混帐初始化

git 远程添加来源 [some_url]

混帐添加。# 添加工作目录中的所有文件

git commit -m "添加文件"

（此时，我目前的想法是：

*   做一个分支，

*   把遥控器拿进去，

*   'git diff 主分支> my_patch'

*   将该补丁应用于分支，

*   从分支推送到远程，

*   拉进主人，

*   并杀死分支。）

显然我的想法是相当复杂和丑陋的。有任何想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-23T19:04:06.593

像这样的东西（假设你是从丢失的 .git 时刻开始的）？

```
# Make the current directory a git repository.
# This puts you on a master branch with no commits.
git init

# Add a reference to the remote repository.
git remote add origin urlurlurl

# Fetch the remote refs.
git fetch

# Without touching the working tree, move master branch
# from nowhere onto the remote master.
git reset origin/master

# Stage all changes between the new index and the current tree.
git add -A

# Make a commit of these changes.
git commit -m "New working tree as a patch on remote master" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-23T07:18:07.300

我认为没有必要在您的情况下创建一个新分支。这是我的答案：在您当前的本地损坏回购中执行以下操作：

```
git init
git add .
git commit -m 'add files'  #create the local master branch
git remote add myproj [some_url]
git fetch myproj  
git branch -r  #check the remote branches
git diff master..myproj/master  #view the diffs between your local and remote repos
#now you are sure there is no conflict,
#so you merge the remote to your local master branch
git pull myproj master  
git push myproj  #push your local master branch to remote
#now your upstream and downstream is sync'ed 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T15:58:00.307

这是我当前的解决方案（假设我已经在包含当前文件的目录中，但没有获得 git repo）

```
git clone -n [git_url] tmp_git_dir
mv tmp_git_dir/.git .
rm -rf tmp_git_dir
git add .
git commit -a -m "commit message" 
```

这看起来更简单，并且会根据需要自动添加和删除文件。我也觉得效率更高。

我想知道 - 有没有办法将 git repo 克隆到当前目录中（基本上我只想在当前目录中放置 .git 目录，所以我不必执行 mv 和 rm）？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-23T04:53:52.067

对不起，如果我误解了你，但我认为你只是想做标准的拉和推？[读一读](http://gitready.com/2009/01/21/pushing-and-pulling.html)。Git 将为您处理任何合并，如果存在冲突，您可以轻松解决它们。

# objective-c - 带有用于 Objective-C 的 ClientLogin 接口的 Google App Engine

> ID：471898
> 
> 赞同：10
> 
> 时间：2009-01-23T04:37:46.687
> 
> 标签：objective-c, cocoa, cocoa-touch, google-app-engine

我在[之前的 stackoverflow.com 帖子](https://stackoverflow.com/questions/101742/how-do-you-access-an-authenticated-google-app-engine-service-from-a-non-web-pyt)中遇到了同样的问题。

具体来说，我似乎能够正确获取“Auth”令牌，但是当我访问后面的页面时尝试在标题中使用它仍然只是返回给我登录页面的 HTML。

[通过与这篇文章相关的链接，我确定您需要对该 URL](http://yourapp.appspot.com/_ah/login)进行后续调用。

然后，对 URL 的调用将为您提供一个 ACSID cookie，然后需要在后续调用中传递该 cookie 以保持经过身份验证的状态。

在请求此 cookie 时，我已阅读各种帖子，说您需要通过将原始身份验证令牌附加到查询字符串来指定原始身份验证令牌，以便：

```
?auth=this_is_my_token 
```

我还读到您应该按照[google 文档中的说明](http://code.google.com/apis/gdata/auth.html#ClientLogin)在 http 标头中设置它，以便 http 标头名称/值是：

```
Authorization: GoogleLogin auth=yourAuthToken 
```

我已经尝试了这两种方法，但没有看到任何返回的 cookie。我使用了 Wireshark、Firefox 的 LiveHttpHeaders 和简单的 NSLog 语句，试图查看是否返回了类似的内容。

下面是我一直在使用的代码片段。

```
NSURL* url = [NSURL URLWithString:[NSString stringWithFormat:@"http://yourapp.appspot.com/_ah/login?auth=%@", [token objectForKey:@"Auth"]]];
NSHTTPURLResponse* response;
NSError* error;
NSMutableURLRequest *request = [[NSMutableURLRequest alloc] initWithURL:url];
[request setValue:[NSString stringWithFormat:@"GoogleLogin auth=%@", [token objectForKey:@"Auth"]] forHTTPHeaderField:@"Authorization"];
NSData * data = [NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&error];  

//show me all header fields
NSLog([[response allHeaderFields] description]);

//show me the response
NSLog(@"%@", [[[NSString alloc] initWithData:data encoding:NSASCIIStringEncoding] autorelease]);
NSArray * all = [NSHTTPCookie cookiesWithResponseHeaderFields:[response allHeaderFields] forURL:[NSURL URLWithString:@"http://yourapp.appspot.com/_ah/login"]];

//show me all cookies
for (NSHTTPCookie *cookie in all) 
{
    NSLog(@"Name: %@ : Value: %@", cookie.name, cookie.value); 
} 
```

我希望您可以使用`ClientLogin`Google App Engine 代码。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-26T01:08:05.990

向此问题添加示例代码，因为有人直接就我的解决方案与我联系。请注意，您必须在初始令牌请求中将“服务”参数设置为等于“啊”。

Token 的初始请求 [同步完成] 注意：“service”参数设置为“ah”，“source”设置为“myapp”，您应该使用您的应用名称。

```
//create request
NSString* content = [NSString stringWithFormat:@"accountType=HOSTED_OR_GOOGLE&Email=%@&Passwd=%@&service=ah&source=myapp", [loginView username].text, [loginView password].text];
NSURL* authUrl = [NSURL URLWithString:@"https://www.google.com/accounts/ClientLogin"];
NSMutableURLRequest* authRequest = [[NSMutableURLRequest alloc] initWithURL:authUrl];
[authRequest setHTTPMethod:@"POST"];
[authRequest setValue:@"application/x-www-form-urlencoded" forHTTPHeaderField:@"Content-type"];
[authRequest setHTTPBody:[content dataUsingEncoding:NSASCIIStringEncoding]];

NSHTTPURLResponse* authResponse;
NSError* authError;
NSData * authData = [NSURLConnection sendSynchronousRequest:authRequest returningResponse:&authResponse error:&authError];  

NSString *authResponseBody = [[NSString alloc] initWithData:authData encoding:NSASCIIStringEncoding];

//loop through response body which is key=value pairs, seperated by \n. The code below is not optimal and certainly error prone. 
NSArray *lines = [authResponseBody componentsSeparatedByString:@"\n"];
NSMutableDictionary* token = [NSMutableDictionary dictionary];
for (NSString* s in lines) {
    NSArray* kvpair = [s componentsSeparatedByString:@"="];
    if ([kvpair count]>1)
        [token setObject:[kvpair objectAtIndex:1] forKey:[kvpair objectAtIndex:0]];
}

//if google returned an error in the body [google returns Error=Bad Authentication in the body. which is weird, not sure if they use status codes]
if ([token objectForKey:@"Error"]) {
    //handle error
}; 
```

下一步是让你的应用在谷歌应用引擎上运行，为你提供 ASCII cookie。我不确定为什么会有这个额外的步骤，这似乎是 google 的一个问题，可能是为什么 GAE 目前不在他们列出的 obj-c google data api 库中。我的测试表明我*必须*请求 cookie 才能与 GAE 同步。另外，请注意我没有对 cookie 做任何事情。似乎只是通过请求它并获得 cookie，未来的请求将自动包含 cookie。我不确定这是否是 iphone 的事情，因为我的应用程序是 iphone 应用程序，但我不完全理解这个 cookie 发生了什么。注意：使用“myapp.appspot.com”。

```
NSURL* cookieUrl = [NSURL URLWithString:[NSString stringWithFormat:@"http://myapp.appspot.com/_ah/login?continue=http://myapp.appspot.com/&auth=%@", [token objectForKey:@"Auth"]]];
    NSLog([cookieUrl description]);
    NSHTTPURLResponse* cookieResponse;
    NSError* cookieError;
    NSMutableURLRequest *cookieRequest = [[NSMutableURLRequest alloc] initWithURL:cookieUrl];

    [cookieRequest setHTTPMethod:@"GET"];

    NSData* cookieData = [NSURLConnection sendSynchronousRequest:cookieRequest returningResponse:&cookieResponse error:&cookieError]; 
```

最后，我可以将 json 发布到我的 gae 应用程序中。注意：下面的代码片段是一个异步请求。我们可以通过实现 didReceiveResponse、didReceiveData、didFailWIthError 来处理响应。

```
NSURL* url = [NSURL URLWithString:[NSString stringWithFormat:@"http://myapp.appspot.com/addRun?auth=%@", mytoken]];
    NSMutableURLRequest* request = [[NSMutableURLRequest alloc] initWithURL:url];
    [request setHTTPMethod:@"POST"];
    [request setHTTPBody:@"my http body";

    NSURLConnection *connectionResponse = [[NSURLConnection alloc] initWithRequest:request delegate:self];
    if (!connectionResponse) {
        NSLog(@"Failed to submit request");
    } else {
        NSLog(@"Request submitted");
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T19:22:15.323

查看官方 SDK 中执行此操作的代码。最新的 SDK 版本甚至将其拆分为[自己的文件](http://code.google.com/p/googleappengine/source/browse/trunk/google/appengine/tools/appengine_rpc.py#215)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-28T02:48:01.537

1st - 感谢这篇很棒的帖子，它真的让我开始了。

第二 - 我一直在用我的应用程序解决它，试图在经过身份验证的情况下发布到 GAE。

这是在 POST 时构建的请求，一旦您获得了 authtoken：

```
 NSMutableURLRequest *request = [[[NSMutableURLRequest alloc] init] autorelease];

[request setURL:[NSURL URLWithString:url]];
[request setHTTPMethod:@"POST"];
[request setValue:postLength forHTTPHeaderField:@"Content-Length"];
[request setValue:@"image/png" forHTTPHeaderField:@"Content-Type"];
[request setHTTPBody:postData];

[request setValue:authtoken forHTTPHeaderField:@"auth"];  // <-- the magic 
```

*   马特布

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-03-08T22:58:48.483

我创建了一些 obj-c 类来实现 ClientLogin，包括对 Google App Engine 的支持：

[http://github.com/cameronr/GoogleAppEngineAuth](http://github.com/cameronr/GoogleAppEngineAuth)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-12-03T15:11:13.453

请注意，Google 最近更改了指示授权失败的方式。他们过去常常在响应中放置一个错误标记。现在他们只返回 403（禁止）状态。这破坏了我的代码！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-02-19T22:13:41.050

感谢这篇文章，尤其是 Keith 的回答，但它对我不起作用。即使对我来说似乎还可以……很奇怪。

我查看了这篇文章（[How do you access an authenticated Google App Engine service from a (non-web) python client?](https://stackoverflow.com/questions/101742/how-do-you-access-an-authenticated-google-app-engine-service-from-a-non-web-pyt)），它谈到了在 python 中做同样的事情。我测试它并且它有效。

并且 Keith 提出的客观 C 代码与 python 代码非常相似。

但是当我尝试获取“Auth”令牌时，authData 包含 Error=BadAuthentication。

有人对可能的问题有所了解？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-03-06T12:56:13.140

使用 HOSTED_OR_GOOGLE 是错误的，我会解释原因。

Google 世界中有两种帐户。您为 GMail 等创建的那些是“Google”帐户。您为域应用程序创建的那些是“托管”帐户。您可以使用托管帐户电子邮件来创建 Google 帐户，从而创建与这两种帐户相关联的电子邮件地址。

您的 Google App Engine 应用可以配置为使用 (1) Google 帐户或 (2) 特定域的托管帐户。

假设我们正在为 Google 帐户开发一个应用程序。用户输入与 Google 帐户和托管帐户关联的电子邮件地址。Google 将使用他们的 Google 帐户进行登录。这一切都很好。

现在，如果我们使用具有相同电子邮件地址的 ClientLogin 并使用 HOSTED_OR_GOOGLE 作为帐户类型，登录将成功，但它将使用托管帐户，因为托管帐户优先。正如我上面提到的，您不能将托管帐户用于需要 Google 帐户的应用程序。所以认证将不起作用。

因此，当使用 ClientLogin 对 Google App Engine 应用程序进行身份验证时，如果应用程序用于 Google 帐户，则需要使用 GOOGLE 作为帐户类型，如果应用程序用于域，则需要使用 HOSTED 作为帐户类型。

# mysql - 您可以拆分/分解 MySQL 查询中的字段吗？

> ID：471914
> 
> 赞同：48
> 
> 时间：2009-01-23T04:53:26.187
> 
> 标签：mysql

我必须创建一份关于一些学生完成情况的报告。每个学生都属于一个客户。这是表格（针对此问题进行了简化）。

```
CREATE TABLE  `clients` (
  `clientId` int(10) unsigned NOT NULL auto_increment,
  `clientName` varchar(100) NOT NULL default '',
  `courseNames` varchar(255) NOT NULL default ''
) 
```

该`courseNames`字段包含以逗号分隔的课程名称字符串，例如“AB01,AB02,AB03”

```
CREATE TABLE  `clientenrols` (
  `clientEnrolId` int(10) unsigned NOT NULL auto_increment,
  `studentId` int(10) unsigned NOT NULL default '0',
  `courseId` tinyint(3) unsigned NOT NULL default '0'
) 
```

这里的`courseId`字段是**clients.courseNames 字段中课程名称的索引**。因此，如果客户`courseNames`是“AB01,AB02,AB03”，而`courseId`注册的人是`2`，那么学生在 AB03。

有没有一种方法可以在这些包含课程名称的表上进行单选？请记住，会有来自不同客户的学生（因此有不同的课程名称，并非所有课程名称都是连续的，例如：“NW01，NW03”）

基本上，如果我可以拆分该字段并从结果数组中返回一个元素，那将是我正在寻找的。这就是我在神奇的伪代码中的意思：

```
SELECT e.`studentId`, SPLIT(",", c.`courseNames`)[e.`courseId`]
FROM ... 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2011-12-21T04:28:50.233

到目前为止，我想将这些逗号分隔的列表保留在我的 SQL 数据库中 - 非常了解所有警告！

我一直认为它们比查找表有好处（它提供了一种标准化数据库的方法）。经过几天的拒绝，**我看到了曙光**：

*   在一个字段中使用逗号分隔值时，使用查找表不会导致比那些丑陋的字符串操作更多的代码。
*   查找表允许本地数字格式，因此不大于那些 csv 字段。虽然它更小。
*   所涉及的字符串操作在高级语言代码（SQL 和 PHP）中很少，但与使用整数数组相比代价高昂。
*   数据库并不意味着人类可读，并且由于它们的可读性/直接可编辑性而试图坚持结构几乎是愚蠢的，就像我所做的那样。

简而言之，MySQL 中没有原生的 SPLIT() 函数是有原因的。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2013-06-11T11:33:50.973

看到这是一个相当受欢迎的问题 - 答案是肯定的。

对于`column`表`table`中包含所有逗号分隔值的列：

```
CREATE TEMPORARY TABLE temp (val CHAR(255));
SET @S1 = CONCAT("INSERT INTO temp (val) VALUES ('",REPLACE((SELECT GROUP_CONCAT( DISTINCT  `column`) AS data FROM `table`), ",", "'),('"),"');");
PREPARE stmt1 FROM @s1;
EXECUTE stmt1;
SELECT DISTINCT(val) FROM temp; 
```

* * *

但是请记住**不要**将 CSV 存储在您的数据库中

* * *

每@Mark Amery - 因为这会将逗号分隔的值转换为`INSERT`语句，所以在未经处理的数据上运行它时要小心

* * *

重申一下，请**不要**将 CSV 存储在您的数据库中；此函数旨在将 CSV 转换为合理的数据库结构，而不是在代码中的任何地方使用。如果您必须在生产中使用它，请重新考虑您的数据库结构

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2017-04-01T11:54:02.003

MySQL 唯一的字符串拆分函数是[`SUBSTRING_INDEX(str, delim, count)`](https://dev.mysql.com/doc/refman/en/string-functions.html#function_substring-index). 您可以使用它，例如：

*   返回字符串中第一个分隔符之前的项目：

    ```
    mysql> SELECT SUBSTRING_INDEX('foo#bar#baz#qux', '#', 1);
    +--------------------------------------------+
    | SUBSTRING_INDEX('foo#bar#baz#qux', '#', 1) |
    +--------------------------------------------+
    | foo                                        |
    +--------------------------------------------+
    1 row in set (0.00 sec) 
    ```

*   返回字符串中最后一个分隔符之后的项目：

    ```
    mysql> SELECT SUBSTRING_INDEX('foo#bar#baz#qux', '#', -1);
    +---------------------------------------------+
    | SUBSTRING_INDEX('foo#bar#baz#qux', '#', -1) |
    +---------------------------------------------+
    | qux                                         |
    +---------------------------------------------+
    1 row in set (0.00 sec) 
    ```

*   返回字符串中第三个分隔符之前的所有内容：

    ```
    mysql> SELECT SUBSTRING_INDEX('foo#bar#baz#qux', '#', 3);
    +--------------------------------------------+
    | SUBSTRING_INDEX('foo#bar#baz#qux', '#', 3) |
    +--------------------------------------------+
    | foo#bar#baz                                |
    +--------------------------------------------+
    1 row in set (0.00 sec) 
    ```

*   通过链接两个调用返回字符串中的第二项：

    ```
    mysql> SELECT SUBSTRING_INDEX(SUBSTRING_INDEX('foo#bar#baz#qux', '#', 2), '#', -1);
    +----------------------------------------------------------------------+
    | SUBSTRING_INDEX(SUBSTRING_INDEX('foo#bar#baz#qux', '#', 2), '#', -1) |
    +----------------------------------------------------------------------+
    | bar                                                                  |
    +----------------------------------------------------------------------+
    1 row in set (0.00 sec) 
    ```

一般来说，获取`#`-separated 字符串的第 n 个元素（假设您知道它肯定至少有 n 个元素）的简单方法是：

```
SUBSTRING_INDEX(SUBSTRING_INDEX(your_string, '#', n), '#', -1); 
```

内部`SUBSTRING_INDEX`调用丢弃第 n 个分隔符及其之后的所有内容，然后外部`SUBSTRING_INDEX`调用丢弃除最后一个元素之外的所有内容。

如果您想要一个更强大的解决方案，`NULL`如果您请求一个不存在的元素（例如，请求 的第 5 个元素`'a#b#c#d'`），那么您可以[使用 计算分隔符`REPLACE`](https://stackoverflow.com/a/12344881/1709587)，然后有条件地返回`NULL`using [`IF()`](https://dev.mysql.com/doc/refman/en/control-flow-functions.html#function_if)：

```
IF(
    LENGTH(your_string) - LENGTH(REPLACE(your_string, '#', '')) / LENGTH('#') < n - 1,
    NULL,
    SUBSTRING_INDEX(SUBSTRING_INDEX(your_string, '#', n), '#', -1)
) 
```

当然，这很丑陋，很难理解！所以你可能想把它包装在一个函数中：

```
CREATE FUNCTION split(string TEXT, delimiter TEXT, n INT)
RETURNS TEXT DETERMINISTIC
RETURN IF(
    (LENGTH(string) - LENGTH(REPLACE(string, delimiter, ''))) / LENGTH(delimiter) < n - 1,
    NULL,
    SUBSTRING_INDEX(SUBSTRING_INDEX(string, delimiter, n), delimiter, -1)
); 
```

然后，您可以像这样使用该函数：

```
mysql> SELECT SPLIT('foo,bar,baz,qux', ',', 3);
+----------------------------------+
| SPLIT('foo,bar,baz,qux', ',', 3) |
+----------------------------------+
| baz                              |
+----------------------------------+
1 row in set (0.00 sec)

mysql> SELECT SPLIT('foo,bar,baz,qux', ',', 5);
+----------------------------------+
| SPLIT('foo,bar,baz,qux', ',', 5) |
+----------------------------------+
| NULL                             |
+----------------------------------+
1 row in set (0.00 sec)

mysql> SELECT SPLIT('foo###bar###baz###qux', '###', 2);
+------------------------------------------+
| SPLIT('foo###bar###baz###qux', '###', 2) |
+------------------------------------------+
| bar                                      |
+------------------------------------------+
1 row in set (0.00 sec) 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2012-12-31T00:04:54.403

您可以为此创建一个函数：

```
/**
* Split a string by string (Similar to the php function explode())
*
* @param VARCHAR(12) delim The boundary string (delimiter).
* @param VARCHAR(255) str The input string.
* @param INT pos The index of the string to return
* @return VARCHAR(255) The (pos)th substring
* @return VARCHAR(255) Returns the [pos]th string created by splitting the str parameter on boundaries formed by the delimiter.
* @{@example
*     SELECT SPLIT_STRING('|', 'one|two|three|four', 1);
*     This query
* }
*/
DROP FUNCTION IF EXISTS SPLIT_STRING;
CREATE FUNCTION SPLIT_STRING(delim VARCHAR(12), str VARCHAR(255), pos INT)
RETURNS VARCHAR(255) DETERMINISTIC
RETURN
    REPLACE(
        SUBSTRING(
            SUBSTRING_INDEX(str, delim, pos),
            LENGTH(SUBSTRING_INDEX(str, delim, pos-1)) + 1
        ),
        delim, ''
    ); 
```

将神奇的伪代码转换为使用它，您将拥有：

```
SELECT e.`studentId`, SPLIT_STRING(',', c.`courseNames`, e.`courseId`)
FROM... 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2014-03-26T17:57:58.607

基于上面 Alex 的回答（[https://stackoverflow.com/a/11022431/1466341](https://stackoverflow.com/a/11022431/1466341)），我想出了更好的解决方案。不包含确切的一个记录 ID 的解决方案。

假设逗号分隔的列表在 table 中`data.list`，并且它包含来自其他 table 的代码列表`classification.code`，您可以执行以下操作：

```
SELECT 
    d.id, d.list, c.code
FROM 
    classification c
    JOIN data d
        ON d.list REGEXP CONCAT('[[:<:]]', c.code, '[[:>:]]'); 
```

因此，如果您有这样的表和数据：

```
CLASSIFICATION (code varchar(4) unique): ('A'), ('B'), ('C'), ('D')
MY_DATA (id int, list varchar(255)): (100, 'C,A,B'), (150, 'B,A,D'), (200,'B') 
```

以上 SELECT 将返回

```
(100, 'C,A,B', 'A'),
(100, 'C,A,B', 'B'),
(100, 'C,A,B', 'C'),
(150, 'B,A,D', 'A'),
(150, 'B,A,D', 'B'),
(150, 'B,A,D', 'D'),
(200, 'B', 'B'), 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2012-06-13T19:59:46.970

基于 Alwin Kesler 的解决方案，这里有一个更实用的现实示例。

假设逗号分隔的列表位于 my_table.list 中，并且它是 my_other_table.id 的 ID 列表，您可以执行以下操作：

```
SELECT 
    * 
FROM 
    my_other_table 
WHERE 
    (SELECT list FROM my_table WHERE id = '1234') REGEXP CONCAT(',?', my_other_table.id, ',?'); 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-06-08T16:59:21.030

我已经用正则表达式模式解决了这种问题。它们往往比常规查询慢，但这是一种在逗号分隔的查询列中检索数据的简单方法

```
SELECT * 
FROM `TABLE`
WHERE `field` REGEXP ',?[SEARCHED-VALUE],?'; 
```

贪婪的问号有助于在字符串的开头或结尾进行搜索。

希望对以后的任何人都有帮助

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2015-09-15T12:34:46.810

可以在 MySQL SELECT 语句中分解字符串。

首先生成一系列数字，直到您希望分解的最大分隔值数量。要么来自整数表，要么将数字联合在一起。下面生成 100 行，给出 1 到 100 的值。它可以很容易地扩展以给出更大的范围（添加另一个子查询，为数百个给出值 0 到 9 - 因此给出 0 到 999 等）。

```
SELECT 1 + units.i + tens.i * 10 AS aNum
FROM (SELECT 0 AS i UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) units
CROSS JOIN (SELECT 0 AS i UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) tens 
```

这可以与您的表交叉连接以提供值。请注意，您使用 SUBSTRING_INDEX 将分隔值获取到某个值，然后使用 SUBSTRING_INDEX 获取该值，不包括以前的值。

```
SELECT SUBSTRING_INDEX(SUBSTRING_INDEX(clients.courseNames, ',', sub0.aNum), ',', -1) AS a_course_name
FROM clients
CROSS JOIN
(
    SELECT 1 + units.i + tens.i * 10 AS aNum, units.i + tens.i * 10 AS aSubscript
    FROM (SELECT 0 AS i UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) units
    CROSS JOIN (SELECT 0 AS i UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) tens
) sub0 
```

如您所见，这里有一个小问题，即最后一个分隔值重复了很多次。要摆脱这种情况，您需要根据有多少定界符来限制数字范围。这可以通过获取定界字段的长度并将其与定界字段的长度进行比较来完成，其中定界符更改为“”（以删除它们）。从中您可以获得分隔符的数量：-

```
SELECT SUBSTRING_INDEX(SUBSTRING_INDEX(clients.courseNames, ',', sub0.aNum), ',', -1) AS a_course_name
FROM clients
INNER JOIN
(
    SELECT 1 + units.i + tens.i * 10 AS aNum
    FROM (SELECT 0 AS i UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) units
    CROSS JOIN (SELECT 0 AS i UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) tens
) sub0
ON (1 + LENGTH(clients.courseNames) - LENGTH(REPLACE(clients.courseNames, ',', ''))) >= sub0.aNum 
```

在原始示例字段中，您可以（例如）基于此计算每门课程的学生人数。请注意，我已更改获取数字范围的子查询以带回 2 个数字，1 用于确定课程名称（因为这些基于从 1 开始），另一个获取下标（因为它们基于开始在 0）。

```
SELECT SUBSTRING_INDEX(SUBSTRING_INDEX(clients.courseNames, ',', sub0.aNum), ',', -1) AS a_course_name, COUNT(clientenrols.studentId)
FROM clients
INNER JOIN
(
    SELECT 1 + units.i + tens.i * 10 AS aNum, units.i + tens.i * 10 AS aSubscript
    FROM (SELECT 0 AS i UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) units
    CROSS JOIN (SELECT 0 AS i UNION SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6 UNION SELECT 7 UNION SELECT 8 UNION SELECT 9) tens
) sub0
ON (1 + LENGTH(clients.courseNames) - LENGTH(REPLACE(clients.courseNames, ',', ''))) >= sub0.aNum
LEFT OUTER JOIN clientenrols
ON clientenrols.courseId = sub0.aSubscript
GROUP BY a_course_name 
```

如您所见，这是可能的，但非常混乱。而且几乎没有机会使用索引，它不会是有效的。此外，范围必须处理最大数量的分隔值，并通过排除大量重复来工作；如果分隔值的最大数量非常大，那么这将大大减慢速度。总的来说，适当地规范化数据库通常要好得多。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-04-14T16:53:53.433

如果您需要从带有分隔符的字符串中获取表格：

```
SET @str = 'function1;function2;function3;function4;aaa;bbbb;nnnnn';
SET @delimeter = ';';
SET @sql_statement = CONCAT('SELECT '''
                ,REPLACE(@str, @delimeter, ''' UNION ALL SELECT ''')
                ,'''');
SELECT @sql_statement;
SELECT 'function1' UNION ALL SELECT 'function2' UNION ALL SELECT 'function3' UNION ALL SELECT 'function4' UNION ALL SELECT 'aaa' UNION ALL SELECT 'bbbb' UNION ALL SELECT 'nnnnn' 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-01-23T04:57:59.360

有一个更简单的方法，有一个链接表，即：

表 1：客户，客户信息，等等等等

表 2：课程、课程信息、等等

表3：clientid、courseid

然后做一个 JOIN，你就可以参加比赛了。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2012-03-07T06:42:05.560

```
SELECT
  tab1.std_name, tab1.stdCode, tab1.payment,
  SUBSTRING_INDEX(tab1.payment, '|', 1) as rupees,
  SUBSTRING(tab1.payment, LENGTH(SUBSTRING_INDEX(tab1.payment, '|', 1)) + 2,LENGTH(SUBSTRING_INDEX(tab1.payment, '|', 2))) as date
FROM (
  SELECT DISTINCT
    si.std_name, hfc.stdCode,
    if(isnull(hfc.payDate), concat(hfc.coutionMoneyIn,'|', year(hfc.startDtae), '-',  monthname(hfc.startDtae)), concat(hfc.payMoney, '|', monthname(hfc.payDate), '-', year(hfc.payDate))) AS payment
  FROM hostelfeescollection hfc
  INNER JOIN hostelfeecollectmode hfm ON hfc.tranId = hfm.tranId
  INNER JOIN student_info_1 si ON si.std_code = hfc.stdCode
  WHERE hfc.tranId = 'TRAN-AZZZY69454'
) AS tab1 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-04-22T17:30:19.840

我只是在一个类似的领域遇到了类似的问题，我以不同的方式解决了这个问题。我的用例需要将这些 id 放在逗号分隔的列表中以用于连接。

我能够使用like来解决它，但它变得更容易了，因为除了逗号分隔符之外，ID也被引用如下：

`keys "1","2","6","12"`

正因为如此，我能够做一个 LIKE

`SELECT twwf.id, jtwi.id joined_id FROM table_with_weird_field twwf INNER JOIN join_table_with_ids jtwi ON twwf.delimited_field LIKE CONCAT("%\"", jtwi.id, "\"%")`

这基本上只是查看您尝试加入的表中的 id 是否出现在集合中，此时您可以很容易地加入它并返回您的记录。你也可以从这样的东西创建一个视图。

它适用于我正在处理以所述方式管理关系的 Wordpress 插件的用例。引号确实有帮助，因为否则您将面临部分匹配的风险（又名 - 18 内的 id 1 等）。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2012-04-29T19:33:00.430

我使用了上述逻辑，但稍作修改。我的输入格式为：“apple:100|pinapple:200|orange:300”存储在变量@updtAdvanceKeyVal 中

这是功能块：

```
set @res = "";

set @i = 1;
set @updtAdvanceKeyVal = updtAdvanceKeyVal;

REPEAT

 -- set r =  replace(SUBSTRING(SUBSTRING_INDEX(@updtAdvanceKeyVal, "|", @i),
 --  LENGTH(SUBSTRING_INDEX(@updtAdvanceKeyVal, "|", @i -1)) + 1),"|","");

-- wrapping the function in "replace" function as above causes to cut off a character from
 -- the 2nd splitted value if the value is more than 3 characters. Writing it in 2 lines causes no such problem and the output is as expected
-- sample output by executing the above function :
-- orange:100
-- pi apple:200    !!!!!!!!strange output!!!!!!!!
-- tomato:500

      set @r =  SUBSTRING(SUBSTRING_INDEX(@updtAdvanceKeyVal, "|", @i),
                  LENGTH(SUBSTRING_INDEX(@updtAdvanceKeyVal, "|", @i -1)) + 1);

      set @r = replace(@r,"|","");

      if @r <> "" then

              set @key = SUBSTRING_INDEX(@r, ":",1);
              set @val = SUBSTRING_INDEX(@r, ":",-1);

              select @key, @val;
      end if;

      set @i = @i + 1;

     until @r = ""
END REPEAT; 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2020-12-29T17:11:41.603

## 在包含逗号分隔值的列中搜索

MySQL 有一个专用函数[FIND_IN_SET()](https://dev.mysql.com/doc/refman/5.7/en/string-functions.html#function_find-in-set)如果在包含逗号分隔值的字符串中找到该值，则返回字段索引。

例如，以下语句返回`C`string中从 1 开始的 value 索引`A,B,C,D`。

```
SELECT FIND_IN_SET('C', 'A,B,C,D') AS result;
+--------+
| result |
+--------+
|      3 |
+--------+ 
```

如果未找到给定值，则`FIND_IN_SET()`函数返回`0`。

```
SELECT FIND_IN_SET('Z', 'A,B,C,D') AS result;
+--------+
| result |
+--------+
|      0 |
+--------+ 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-08-26T05:18:26.637

您可以在更新的 MySQL 版本中使用 JSON 来执行此操作。这是一个爆炸。我们将快速准备创建一个数字表。然后，首先我们创建一个中间表，将逗号分隔的字符串转换为 json 数组，然后我们将使用它们将`json_extract`它们分开。我将字符串封装在引号中，小心地转义现有引号，因为我有分号分隔的包含逗号的字符串。

因此，要创建数字表，希望您的客户多于课程，如果没有，请选择一个足够大的表。

```
CREATE TABLE numbers (n int PRIMARY KEY);
INSERT INTO numbers 
SELECT @row := @row + 1
FROM clients JOIN (select @row:=0) t2; 
```

如果您知道自己只有 50 门课程，请添加 LIMIT 50。现在，这很容易，不是吗？现在开始真正的工作，老实说，是引号使它更丑陋，但至少它更通用：

```
CREATE TABLE json_coursenames 
SELECT clientId,clientName,CONCAT('["', REPLACE(REPLACE(courseName,'"','\\"'), ',', '","'), '"]') AS a
FROM clients;

CREATE TABLE extracted
SELECT clientId,clientName,REPLACE(TRIM(TRIM('"' FROM JSON_EXTRACT(a, concat('$[', n, ']')))), '\\"', '"')
FROM json_coursenames
INNER JOIN numbers ON n < JSON_LENGTH(a); 
```

哇！

这里的肉是这两个：（`CONCAT('["', REPLACE(coursename, ',', '","'), '"]')`我放弃了第二个`REPLACE`以使其更明显）将转换`foo,bar,bar`为`"foo","bar","baz"`. 另一个技巧`JSON_EXTRACT(a, concat('$[', n, ']')`将成为`JSON_EXTRACT(a, $[12])`数组中的第 13 个元素，请参阅[JSON 路径语法](https://dev.mysql.com/doc/refman/8.0/en/json.html#json-path-syntax)。

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2009-01-23T05:03:29.787

下面介绍如何为 SQL Server 执行此操作。其他人可以将其翻译成 MySQL。[将 CSV 值解析为多行](http://www.sqlteam.com/article/parsing-csv-values-into-multiple-rows)。

```
SELECT Author, 
NullIf(SubString(',' + Phrase + ',' , ID , CharIndex(',' , ',' + Phrase + ',' , ID) - ID) , '') AS Word 
FROM Tally, Quotes 
WHERE ID <= Len(',' + Phrase + ',') AND SubString(',' + Phrase + ',' , ID - 1, 1) = ',' 
AND CharIndex(',' , ',' + Phrase + ',' , ID) - ID > 0 
```

这个想法是交叉连接到包含整数 1 到 8000（或任何足够大的数字）的预定义表 Tally 并运行`SubString`以找到正确的单词位置。

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2009-01-23T05:17:32.580

这是我到目前为止所得到的（在[Ben Alpert](https://stackoverflow.com/users/49485)提到的页面上找到）：

```
SELECT REPLACE(
    SUBSTRING(
        SUBSTRING_INDEX(c.`courseNames`, ',', e.`courseId` + 1)
        , LENGTH(SUBSTRING_INDEX(c.`courseNames`, ',', e.`courseId`)
    ) + 1)
    , ','
    , ''
)
FROM `clients` c INNER JOIN `clientenrols` e USING (`clientId`) 
```

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2013-08-13T20:02:49.157

好吧，我没有使用任何东西，所以我决定创建一个真正简单的拆分函数，希望它有所帮助：

```
 DECLARE inipos INTEGER;
    DECLARE endpos INTEGER;
    DECLARE maxlen INTEGER;
    DECLARE item VARCHAR(100);
    DECLARE delim VARCHAR(1);

    SET delim = '|';
    SET inipos = 1;
    SET fullstr = CONCAT(fullstr, delim);
    SET maxlen = LENGTH(fullstr);

    REPEAT
        SET endpos = LOCATE(delim, fullstr, inipos);
        SET item =  SUBSTR(fullstr, inipos, endpos - inipos);

        IF item <> '' AND item IS NOT NULL THEN           
            USE_THE_ITEM_STRING;
        END IF;
        SET inipos = endpos + 1;
    UNTIL inipos >= maxlen END REPEAT; 
```

# version-control - AnkhSVN - 保留本地副本并获取最新版本

> ID：471926
> 
> 赞同：1
> 
> 时间：2009-01-23T04:58:22.010
> 
> 标签：version-control, ankhsvn

我是新来使用 ankhSVN 并遇到问题。我创建了一些未提交的新文件。我需要获得最新版本。我右键单击该文件夹并选择更新。我没有得到最新版本，而且我的文件也不存在。它的左侧有一个问号图标。理想情况下，我想知道使用 ankhSVN 的程序是什么。

谢谢和问候， Ashish Agarwal Ashish.Agarwal@Renishaw.com

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-23T08:32:26.277

[无关：如果您不想收到垃圾邮件，请从您的问题中删除您的电子邮件地址。您可以通过 RSS 和邮件通过您的个人资料设置收到更新通知]。

您在 Visual Studio 中看到的“文件夹”不是普通的文件夹/目录。它们只是您项目的过滤器。对于某些项目类型，它们映射到实际文件夹（例如 C#、VB 和网站），但对于其他项目，它们不映射（例如 C、C++、Setup、Database...）。

所以实际上你只是在更新过滤器/文件夹的选择以及下面的所有内容。

对于大多数任务，您应该始终在解决方案、项目级别或单个文件上进行更新，因为在项目不引用内部文件的情况下更新子目录是一项可能会使您的项目损坏的操作。（新文件不会包含在您的项目中，旧文件也不会被删除）。

AnkhSVN 允许您通过选中对话框底部的 [X] Recursive 复选框来一次更新整个目录，但这目前不是默认设置。

# python - 如何在单独的文件夹中编译 python 文件？

> ID：471928
> 
> 赞同：32
> 
> 时间：2009-01-23T05:02:12.923
> 
> 标签：python, file, compiled

是否可以让 Python 将`.pyc`文件保存到一个单独的文件夹位置`sys.path`？

```
/code
    foo.py
    foo.pyc
    bar.py
    bar.pyc 
```

到：

```
/code
   foo.py
   bar.py
/code_compiled
   foo.pyc
   bar.pyc 
```

我想要这个，因为我觉得它会更有条理。感谢你给与我的帮助。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-23T05:26:17.913

**更新：**

在 Python 3.8`-X pycache_prefix=PATH`中，命令行选项允许将`.pyc`文件写入以给定目录为根的并行树，而不是代码树。请参阅[`$PYTHONPYCACHEPREFIX`envvar](https://docs.python.org/3/using/cmdline.html#envvar-PYTHONPYCACHEPREFIX)^(学分：[@RobertT' 答案](https://stackoverflow.com/a/53367609/4279))

缓存的位置在[`sys.pycache_prefix`](https://docs.python.org/3/library/sys.html#sys.pycache_prefix)(表示[自 Python 3.2] 子目录`None`中的默认位置) 中报告。`__pycache__`

可以设置关闭缓存编译后的 Python 字节码，`-B`然后 Python 不会尝试`.pyc`在导入源模块时写入文件。请参阅[`$PYTHONDONTWRITEBYTECODE`envvar](https://docs.python.org/3/using/cmdline.html#envvar-PYTHONDONTWRITEBYTECODE)^(学分：[@Maleev 的回答](https://stackoverflow.com/a/2985939/4279))

* * *

^(旧 [Python 2] 答案：)

有[PEP 304：控制字节码文件的生成](http://www.python.org/dev/peps/pep-0304/)。它的状态是`Withdrawn`和相应的[补丁](http://bugs.python.org/issue677103)被拒绝。因此，可能没有直接的方法来做到这一点。

如果您不需要源代码，则可以只删除`*.py`文件。`*.pyc`文件可以按原样使用，也可以装在鸡蛋里。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-05-10T06:30:04.247

*在 2003 年黑暗而古老的日子里，PEP 304 出现了来挑战这个问题。它的补丁被发现缺乏。环境变量平台依赖性和版本偏差将其撕成碎片，并将其碎片分散在荒地上。*

*经过多年的磨难，2009年的最后几天，新的挑战者崛起。巴里华沙召唤了PEP 3147并派它进行战斗，挥舞着简单的武器，技巧娴熟。PEP 粉碎了杂乱无章的 PYC 文件，让警惕的 Unladen Swallow 和 CPython 解释器保持沉默，每个人都试图争辩说它的 PYC 文件应该是胜利的，并让 Python 可以轻松地休息，它的死鬼偶尔会在深夜运行。PEP 3147 被独裁者认为值得，并在 3.2 的日子里被封为官方角色。*

从 3.2 开始，Python 将模块的 PYC 文件存储在`__pycache__`模块的目录下。每个 PYC 文件都包含解释器的名称和版本，例如`__pycache__/foo.cpython-33.pyc`. 你可能也有一个`__pycache__/foo.cpython-32.pyc`由早期版本的 Python 编译的。正确的魔法发生了：如果与源代码不同步，则使用正确的并重新编译。在运行时，查看模块的`mymodule.__cached__`pyc 文件名并使用`imp.get_tag()`. 有关更多信息，请参阅[新增功能部分](http://docs.python.org/3/whatsnew/3.2.html#pep-3147-pyc-repository-directories)。

TL;DR - 仅适用于 Python 3.2 及更高版本。糟糕的黑客替代了之前的版本。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2018-11-19T02:40:41.893

仅仅十年后，Python 3.8 终于通过设置环境变量`PYTHONPYCACHEPREFIX`或使用参数（[此处](https://docs.python.org/dev/using/cmdline.html#envvar-PYTHONPYCACHEPREFIX)`-X pycache_prefix=PATH`为官方文档）支持将字节码保存在单独的并行文件系统树中。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-06-06T21:19:39.167

如果您愿意为此完全牺牲字节码生成，那么有一个命令行标志：

```
python -B file_that_imports_others.py 
```

可以放入 IDE 的构建/运行首选项中

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-23T13:23:25.050

我同意，将您的代码作为鸡蛋分发是保持其井井有条的好方法。有什么比包含您需要的所有代码和元数据的单个文件更有条理的了。改变字节码编译器的工作方式只会造成混乱。

如果您真的不喜欢这些 pyc 文件的位置，另一种方法是从只读文件夹运行。由于 python 将无法写入，因此不会生成任何 pyc 文件。您受到的打击是，每个 python 文件在加载后都必须重新编译，无论您是否更改了它。这意味着您的启动时间会更糟。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-01-10T04:49:45.223

我不同意。原因是错误的，或者至少没有很好地阐述；但方向是有效的。能够将源代码与编译对象分离是有充分理由的。以下是其中的一些（我曾在某个时候遇到过所有这些）：

*   嵌入式设备读取 ROM，但能够使用 RAM 上的内存文件系统。
*   多操作系统开发环境意味着共享（使用 samba/nfs/whatever）我的工作目录并在多个平台上构建。
*   商业公司希望仅分发 pyc 以保护 IP
*   使用相同的工作目录轻松地为多个版本的 python 运行测试套件
*   更容易清理过渡文件（rm -rf $OBJECT_DIR 而不是 find . -name '*.pyc' -exec rm -f {} \;）

所有这些问题都有解决方法，但它们大多是解决方法而不是解决方案。在大多数情况下，正确的解决方案是让软件接受用于存储和查找这些过渡文件的替代位置。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-04-02T23:54:50.850

由于 Python 3.2 已经实现[PEP 3147](http://www.python.org/dev/peps/pep-3147/)：这意味着所有 .pyc 文件都在**__ *pycache* __**目录中生成（每个目录都有一个**__ *pycache* __**目录，每个目录都有 Python 文件，它将保存 .pyc 文件源代码中使用的每个 Python 版本）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-08-07T15:40:23.427

正在进行 pep 可以将[字节码构建到魔法目录](http://www.python.org/dev/peps/pep-3147/)。

基本上所有的python文件都会被编译到目录`__pythoncache__`中。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-04-30T16:58:12.320

# 对于 Python 3.8 或更高版本：

该`PYTHONPYCACHEPREFIX`设置（也可用作[-X](https://docs.python.org/3.8/using/cmdline.html#id5) `pycache_prefix`）将隐式字节码缓存配置为使用单独的文件系统树，而不是`__pycache__`每个源目录中的默认子目录。

缓存的位置在`sys.pycache_prefix`（表示子目录`None`中的默认位置）中报告。`__pycache__`

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2009-01-23T11:20:21.163

“我觉得它会更有条理” 为什么？如何？你想达到什么目的？

保存编译器输出的目的是在导入模块时节省一点加载时间。为什么要让这更复杂？如果您不喜欢 .pyc，请定期运行“删除所有 .pyc”脚本。

它们不是必需的；他们很有帮助。为什么要关闭该帮助？

这不是 C、C++ 或 Java，其中生成的对象是必不可少的。这只是 Python 碰巧使用的缓存。我们在 Subversion 中将它们标记为“忽略”，这样它们就不会意外地被签入。

# java - 通过命令行调用与 JNI

> ID：471932
> 
> 赞同：3
> 
> 时间：2009-01-23T05:06:15.613
> 
> 标签：java, java-native-interface, ocr, tesseract

我需要从 Java 应用程序服务器调用 tesseract OCR（它是 C++ 中的一个开源库，用于进行光学字符识别）。现在很容易使用 Runtime.exec() 运行可执行文件。基本逻辑是

1.  将当前保存在内存中的图像保存到文件（.tif）
2.  将图像文件名传递给 tesseract 命令行程序。
3.  使用 FileReader 从 Java 读取输出文本文件。

通过为 Tesseract 编写 JNI 包装器，我可能会在性能方面获得多少改进？不幸的是，没有在 Linux 中工作的开源 JNI 包装器。我必须自己做，并且想知道收益是否值得开发成本。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-23T05:29:56.487

很难说这是否值得。如果您假设如果通过 JNI 在进程内完成，OCR 代码可以直接访问图像数据而无需将其写入文件，那么它肯定会消除那里的任何磁盘 I/O 限制。

我建议使用更简单的方法，并且仅在性能不可接受时才采用 JNI 选项。至少那时您将能够进行一些基准测试并估计您可能能够实现的性能提升。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-23T07:07:00.427

如果您确实追求自己的包装器，我建议您查看[JNA](https://github.com/twall/jna/)。它将允许您调用大多数仅编写 Java 代码的“本机”库，并且比原始 JNI 为您提供更多帮助以安全地执行此操作。JNA 适用于大多数平台。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T06:28:58.287

我同意tweakt。如果没有性能原因，请不要使用 JNI。如果您使用 JNI 调用，如果您的 JNI 层或 OCR 本身存在一些内存泄漏甚至崩溃的可能性，您的应用程序稳定性也可能处于危险之中。如果您通过命令行界面使用它，则永远不会发生这种情况（所有内存将在程序退出时释放，并且可以在调用者代码中检查所有异常程序终止）。

# gcc - msvc 和 gcc 上的用户警告？

> ID：471935
> 
> 赞同：16
> 
> 时间：2009-01-23T05:07:34.707
> 
> 标签：gcc, visual-c++, user-warning

在 MSVC 中，我在标题中有这个：

```
#define STR(x)          #x
#define STR2(x)         STR(x)
#define NOTE(text)      message (__FILE__ "(" STR2(__LINE__) ") : -NOTE- " #text)
#define noteMacro(text) message (__FILE__ "(" STR2(__LINE__) ") : " STR2(text)) 
```

我愿意

```
#pragma NOTE(my warning here) 
```

海合会有：

```
#warning(my warning here) 
```

然而，MSVC（2003）在看到`#warning`并给出“致命错误 C1021：无效的预处理器命令'警告'”时会抛出一个合适的结果

我能做些什么呢？有没有办法让 GCC 识别 MSVC 警告或 MSVC 不会在 GCC 警告上引发错误？有什么我可以做的对两者都有效的吗？我可以让 GCC 警告我有关未知的编译指示，但这不是最理想的解决方案。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-12-16T01:11:03.593

我为这个问题找到的最佳解决方案是在一个公共标题中包含以下内容：

```
// compiler_warning.h
#define STRINGISE_IMPL(x) #x
#define STRINGISE(x) STRINGISE_IMPL(x)

// Use: #pragma message WARN("My message")
#if _MSC_VER
#   define FILE_LINE_LINK __FILE__ "(" STRINGISE(__LINE__) ") : "
#   define WARN(exp) (FILE_LINE_LINK "WARNING: " exp)
#else//__GNUC__ - may need other defines for different compilers
#   define WARN(exp) ("WARNING: " exp)
#endif 
```

然后使用

```
#pragma message WARN("your warning message here") 
```

贯穿整个代码而不是#warning

在 MSVC 下，您将收到如下消息：

```
c:\programming\some_file.cpp(3) : WARNING: your warning message here 
```

在 gcc 下你会得到：

```
c:\programming\some_file.cpp:25: note: #pragma message: WARNING: your warning message here 
```

不是完美的，而是合理的妥协。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-23T06:36:30.300

正如您现在发现的那样，`#warning`它不是标准功能，因此您不能将它与不支持它的编译器一起使用。如果您希望您的代码跨平台工作，那么您根本不会使用`#warning`- 或者至少不会在 MSVC 打算处理的代码中使用（它可以被预处理`#ifdef`或等效）。因此：

```
#ifdef __GNUC__
#warning(warning message)
#else
#pragma NOTE(warning message)
#endif 
```

但这重复了这个信息，我敢肯定你有想过不要那样做——而且它很笨重；你只会很少使用它。您可能还需要处理除 GCC 之外的其他编译器（而且我对 MSVC 不够熟悉，不知道如何可靠地识别它）。

如果`#warning`标准化就好了；它在 C99 中没有标准化。

（很久以前，有一个关于可以添加到 C 并`#warning`出现在那里的功能的 SO 问题。）

另请参阅：[#warning 预处理器指令的可移植性](https://stackoverflow.com/questions/171435/portability-of-warning-preprocessor-directive)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-23T07:42:40.667

用#if 语句保护它们。查找由一个编译器定义但不是另一个编译器定义的符号。

```
#ifdef _MSC_VER
#pragma NOTE(my warning here)
#else
#warning(my warning here)
#endif 
```

有点丑，但我没有看到其他方式。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-03-24T19:46:27.643

可能有代码可以在任何地方工作，并在许多编译器上发出自定义警告，包括人们可能使用的大多数编译器（GCC、clang、MSVC、Intel ......）。

首先，我们应该区分警告和信息性消息。我认为唯一有意义的是，如果您使用致命警告进行编译（*例如*，`-Werror`在 GCC 上），警告应该会导致编译失败，而信息性消息不应该。

正如原始问题所提到的，MSVC 9.0+ 支持

```
#pragma message("Hello") 
```

尽管（恕我直言，不幸的）名称，MSVC 会在此处发出警告，而不是信息性消息。AFAICT 没有办法发出信息性消息。

GCC 4.8+ 和 Intel 支持警告消息 pragma，这意味着我们可以使用预处理器来生成它们：

```
#pragma GCC warning "Hello" 
```

请注意，从版本 18 开始，PGI 不支持此类警告，即使 pgc++ 伪装成应该的 GCC 版本（即，它将 、 和 设置`__GNUC__`为`__GNUC_MINOR__`指示`__GNUC_PATCHLEVEL__`GCC >= 4.8 的值）。他们 [意识到](http://www.pgroup.com/userforum/viewtopic.php?t=5959&sid=7e2fd78d3c74a4a67c637d578e27de1a) 了这个问题。为了解决这个问题，同时仍然允许某些支持这些功能的 PGI 未来版本正常工作，您可以执行以下操作：

```
#if defined(__PGI)
#  pragma diag_suppress 1675
#endif 
```

不幸的是，我认为没有办法推送/弹出 PGI 的警告堆栈，所以如果你这样做，所有后续的未知 pragma 都将被默默地忽略。另外，请记住`#pragma message`PGI 会默默地忽略它（它甚至不会生成关于 pragma 未知的警告）。

Clang 也支持`#pragma GCC warning`（以及`#pragma clang ...`），但从 6.0 开始，此类警告实际上是信息性的（我已经提交了一个错误）。我不确定何时添加了支持，但无论如何，clang 的版本号几乎没有用（感谢 Apple 在其 clang 发行版中将它们设置为完全不同的东西）。不幸的是，没有`__has_pragma`功能测试宏，但我们可以暂时禁用未知的编译指示警告，这样如果编译器不支持编译指示，它将被静默忽略，而不是发出不需要的警告：

```
#if defined(__has_warning)
#  if __has_warning("-Wunknown-pragmas")
#    pragma clang diagnostic push
#    pragma clang diagnostic ignored "-Wunknown-pragmas"
#    pragma message "Hello"
#    pragma clang warning "Hello"
#    pragma clang diagnostic pop
#  endif
#endif 
```

当然，它很丑，但至少我们可以将它隐藏在宏后面。

Cray 5.0+ 还有一个用于消息的编译指示：

```
#pragma _CRI message "Hello" 
```

我实际上无法访问 Cray 的编译器，所以我不能确定它是信息性的还是警告性的。如果有人知道答案，请发表评论！

综上所述，我最近在 [Hedley](https://nemequ.github.io/hedley/)中添加了一些宏来处理这个问题，当前版本如下所示：

```
#if HEDLEY_HAS_WARNING("-Wunknown-pragmas")
#  define HEDLEY_MESSAGE(msg) \
  HEDLEY_DIAGNOSTIC_PUSH \
  _Pragma("clang diagnostic ignored \"-Wunknown-pragmas\"") \
  HEDLEY_PRAGMA(message msg) \
  HEDLEY_DIAGNOSTIC_POP
#elif \
  HEDLEY_GNUC_VERSION_CHECK(4,4,0) || \
  HEDLEY_INTEL_VERSION_CHECK(16,0,0)
#  define HEDLEY_MESSAGE(msg) HEDLEY_PRAGMA(message msg)
#elif HEDLEY_CRAY_VERSION_CHECK(5,0,0)
#  DEFINE HEDLEY_MESSAGE(msg) HEDLEY_PRAGMA(_CRI message msg)
#else
#  define HEDLEY_MESSAGE(msg)
#endif

#if HEDLEY_HAS_WARNING("-Wunknown-pragmas")
#  define HEDLEY_WARNING(msg) \
  HEDLEY_DIAGNOSTIC_PUSH \
  _Pragma("clang diagnostic ignored \"-Wunknown-pragmas\"") \
  HEDLEY_PRAGMA(clang warning msg) \
  HEDLEY_DIAGNOSTIC_POP
#elif \
  (HEDLEY_GNUC_VERSION_CHECK(4,8,0) && !defined(__PGI)) || \
  HEDLEY_INTEL_VERSION_CHECK(16,0,0)
#  define HEDLEY_WARNING(msg) HEDLEY_PRAGMA(GCC warning msg)
#elif HEDLEY_MSVC_VERSION_CHECK(15,0,0)
#  define HEDLEY_WARNING(msg) HEDLEY_PRAGMA(message(msg))
#else
#  define HEDLEY_WARNING(msg) HEDLEY_MESSAGE(msg)
#endif 
```

如果您不想使用 Hedley（它是一个公共域/CC0 标头，仅用于此类事情），您可以轻松替换内部宏。如果你这样做，我建议将你的端口基于 Hedley 回购而不是这个答案，因为我更有可能保持最新。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-03-11T18:56:06.570

如果您愿意，您可以在上述解决方案中添加一点东西 ( `#pragma warning`) 在您的`#pragma message`:

```
#pragma warning()
#pragma message(" SOME USER WARNING - FILE LINE etc... ") 
```

这个小插件会产生真正的警告，并且在 VC 的窗口中看起来不错。例如：

```
1>e:\proj\file.h(19) : warning C4615: #pragma warning : unknown user warning type
1> SOME USER WARNING - FILE LINE etc...
1>proj - 0 error(s), 1 warning(s) 
```

通常我使用这种方法来警告不是太安静，就像在没有`#pragma warning()`.

例如，警告的形式太安静了（当然对我来说）。

```
1> SOME USER WARNING - FILE LINE etc..
1>proj - 0 error(s), 0 warning(s) 
```

不过，只是小化妆品。

# ruby-on-rails - Rails 和 ActiveMerchant 的定期计费：最佳实践、陷阱、陷阱？

> ID：471936
> 
> 赞同：32
> 
> 时间：2009-01-23T05:08:06.873
> 
> 标签：ruby-on-rails, ruby, web-applications, payment, recurring-billing

我们正在为发布过去一年一直在开发的大型 Web 应用程序做准备。我们即将开始整合 ActiveMerchant 以处理该服务的经常性订阅费用。

考虑到我们的要求（如下所列），我正在寻找有关最佳实践的任何建议，以及我应该特别考虑的常见陷阱或特定问题的任何其他提示。我们将使用的支付网关是[PaymentExpress](http://www.paymentExpress.com.au)，因为它是少数支持的具有定期计费的网关之一，并且对在美国以外运营的公司没有任何特殊条件。此应用程序背后的业务位于英国以外。

应用程序的用户创建一个带有子域的帐户，他们可以在其中访问和自定义应用程序及其数据。以下是可能会影响计费方式的一些要求/功能：

*   所有用户均可获得 30 天试用
*   有不同的计划，包括免费的
*   价格较高的计划对其帐户中可以拥有的数据量（例如用户、项目等）有更大的限制
*   计费周期为每月，​​从试用后开始
*   将有折扣/优惠券代码以从一年的正常价格中获得一定百分比的计划等。
*   计划定价将随着功能的添加而变化

我可以预见的具体障碍包括以下内容：

*   当他们违反较低级别计划的计划限制时如何处理降级。
*   信用卡过期或付款未通过时的行为（可能是强制执行的只读模式）
*   当计划定价发生变化时，我们希望在一段时间（例如 6 个月）内为现有用户保留以前的价格，然后开始收取更高的费率。如果计划价格下降，它将立即生效。

其他有用的建议是有关应用程序流程的任何内容。应如何向用户呈现计费表单？什么时候需要信用卡信息？应如何发送、存储和访问发票？

我应该透露，我们计划将大量代码库基于[SaaSy](http://github.com/maccman/saasy/tree/master)。SaaSy 旨在用作一个单独的 Rails 应用程序，处理所有注册和帐户管理方面的事情。但是，这对我们不起作用，因为我们从一开始就没有计划过，而且要让我们的应用程序像这样工作将是一个乏味的过程。因此，我们将从 SaaSy 中提取代码和想法并将它们合并到我们的应用程序中，这是一项相当不乏味的任务。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-27T18:52:12.153

我想补充一件事：请记住，您不需要使用网关内置的定期计费功能。一般来说，这些系统都是遗留系统，很难处理，我们在铁路世界中被宠坏了。

仅将它们用于一个目的（为信用卡计费，也许还存储信用卡以符合 PCI 标准）时，您将获得更大的灵活性。然后在您的 Rails 应用程序中滚动您自己的定期计费，其中包含 cron 作业、付款时间的日期字段以及每个人支付的金额（如果他们使用优惠券）等。

一个小例子：有时人们会在月中取消每月订阅。他们希望确保不会忘记在下次付款前取消。我见过的大多数网关定期计费都会立即终止该帐户（或向您发送一条表明这一点的消息）。实际上，用户已在月底付款，并且应该再获得 2 周的访问权限。如果您在 Rails 中滚动了自己的定期计费，则可以执行此操作，但如果您使用的是网关定期计费，则不能这样做。只是一个小例子。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-23T16:51:53.100

[RailsKits](http://railskits.com/)有一个[软件即服务工具包](http://railskits.com/saas/)，可以满足您的需求。它内置了对免费试用、升级、降级、计划限制等的支持，并且支持 PaymentExpress（和其他一些）。

我已经为我正在做的一个项目进行了一些研究，但我还没有购买它，所以我不能保证它。但是，我看到一些博客文章赞扬了这个工具包。

与您自己实现所有功能的成本相比，RailsKit 相对便宜，但有几个开源版本旨在完成同样的事情。我记得的那个叫[免费增值](http://code.google.com/p/freemium/)。

编辑：我忘了提到瑞恩贝茨在他[最近的 Railscast](http://railscasts.com/episodes/145-integrating-active-merchant)中说他的下一集或两集将处理经常性计费，所以请留意这一点。他通常每周做一集，自 12 月 22 日以来他完成的五集都涵盖了处理不同类型的付款。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-06T04:04:30.567

Peepcode 有一个 PDF 待售（70 页），其中详细介绍了支付处理的各个方面和行业实践。可能值得一试：

[http://peepcode.com/products/activemerchant-pdf](http://peepcode.com/products/activemerchant-pdf)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-11-16T16:46:45.870

我也在建立一个基于订阅的网站，这些是我们目前的要求。他们可能会帮助您了解最佳实践：

*   用户将能够选择其中一种订阅计划。
*   用户将需要输入他们的信用卡详细信息才能注册他们选择的计划。
*   必须接受所有主要的信用卡和借记卡，包括 Maestro 和 American Express。
*   每个计划都有 30 天的免费试用期，因此用户的信用卡只能在 30 天的期限到期后收费。但是，应在注册时检查信用卡的有效性。
*   用户将在信用卡被扣款前几天收到电子邮件，通知他们很快就会被扣款，除非他们取消账户。如果他们在 30 天免费试用期内取消帐户，则不应从他们的信用卡中扣款。
*   在任何免费试用期结束后，用户将被提前支付使用系统的费用——即他们将预付费用。
*   用户将每月为其选择的计划自动收费。每个月，用户都会提前几天收到一封电子邮件，通知他们将被收费。付款后，将通过电子邮件向用户发送显示其付款已收到的发票。
*   用户将能够随时升级或降级他们的帐户。当用户升级/降级时，他们的下一次订阅费用将按新费率计算。用户只能将其帐户降级为可以处理其数据的计划。例如，如果他们当前有 10 个活动项目，他们不能降级到基本计划，因为基本计划只允许 5 个项目。他们必须先删除或存档 5 ​​个项目，然后您才能降级到 Basic。
*   用户将能够登录到他们的帐户并更改或更新他们的信用卡详细信息。
*   用户可以随时取消他们的帐户。用户取消帐户后将不再收取订阅费用。但是，用户已支付的当月部分费用将不会获得退款。
*   支付系统的所有部分必须 100% 符合 PCI DSS；包括任何第三方系统。
*   支付系统必须支持自动通知和重试失败的订阅续订。
*   支付系统必须支持有有效期的折扣券。
*   信用卡详细信息不得由我们的服务器处理或存储在我们的服务器上
*   它们应始终由我们的第 3 方付款处理合作伙伴处理/存储。我们不希望承担保护这些细节和遵守法律法规的责任。
*   用户将能够登录他们的帐户并查看完整的账单历史记录，包括支付日期和金额。我们还需要能够登录系统以查看客户付款计划和付款历史记录。这对于客户服务至关重要。

我们也一直在查看[http://chargify.com/](http://chargify.com/)，它看起来可以节省大量编码时间。

# cocoa-touch - 在 TabBarController + NavigationController 混合环境中，如何在选项卡更改时重置导航？

> ID：471937
> 
> 赞同：2
> 
> 时间：2009-01-23T05:08:08.310
> 
> 标签：cocoa-touch

我正在构建一个具有 TabBarController 的应用程序，并且每个选项卡视图都有导航视图控制器。当用户单击选项卡时，我希望相关导航视图控制器“重置”到根面板。

在我的代码中，我使用以下方式来初始化选项卡和导航控制器。

```
viewController1 = [[MyFirstController alloc] init];               
UINavigationController *tableNavController = [[[UINavigationController alloc] initWithRootViewController:viewController1] autorelease];

viewController2 = [[MySecondController alloc] init];   
UINavigationController *table2NavController = [[[UINavigationController alloc] initWithRootViewController:viewController2] autorelease];

tabBarController.viewControllers = [NSArray arrayWithObjects:tableNavController, table2NavController, nil]; 

    Then appears that all the tab and navigation controller is working automatically. I am not sure where to cut in to let navigation controller view to reset when it is selected. 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T15:59:28.697

导航控制器由系统发送 viewWillAppear 消息，因此您可以实现重置的方法。另一个选择是使用标签栏控制器的 selectedViewController 方法来检索选定的导航控制器。希望有所帮助。

# linq-to-sql - Linq To SQL：错误“找不到数据库节点”

> ID：471939
> 
> 赞同：0
> 
> 时间：2009-01-23T05:08:31.990
> 
> 标签：linq-to-sql

我正在尝试使用[此站点](http://www.sidarok.com/web/blog/content/2008/10/14/achieving-poco-s-in-linq-to-sql.html)作为指南来试验 linq to sql。

运行测试时，我不断收到解析我创建的映射文件的错误。错误：

System.Xml.Schema.XmlSchemaException：找不到数据库节点。是否正确指定了映射命名空间 ( [http://schemas.microsoft.com/linqtosql/mapping/2007 )？](http://schemas.microsoft.com/linqtosql/mapping/2007)

这是映射文件：

```
<?xml version="1.0" encoding="utf-8"?>
    <Database Name="Test" xmlns="http://schemas.microsoft.com/linqtosql/mapping/2007">
      <Table Name="dbo.Categories" Member="Category">
        <Type Name="Category">
          <Column Name="ID" Member="ID" Storage="id" DbType="Char(32) NOT NULL" CanBeNull="false" IsPrimaryKey="true" />
          <Column Name="ParentID" Member="ParentID" Storage="parentID" DbType="Char(32)" />
          <Column Name="Name" Member="Name" Storage="name" DbType="VarChar(50) NOT NULL" CanBeNull="false" />
        </Type>
      </Table>
    </Database> 
```

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-23T05:46:39.450

弄清楚了！

该行：

```
<Table Name="dbo.Categories" Member="Category"> 
```

需要更改为：

```
<Table Name="dbo.Categories" Member="Categories"> 
```

现在它的工作。

# python - 如何在 Python 中将 XML 转换为 JSON？

> ID：471946
> 
> 赞同：65
> 
> 时间：2009-01-23T05:12:30.173
> 
> 标签：python, xml, json

> **可能重复：**
> [使用 Python 将 XML 转换为 JSON？](https://stackoverflow.com/questions/191536/converting-xml-to-json-using-python)

我正在 App Engine 上做一些工作，我需要将从远程服务器检索到的 XML 文档转换为等效的 JSON 对象。

我`xml.dom.minidom`用来解析由`urlfetch`. 我还尝试使用`django.utils.simplejson`将解析的 XML 文档转换为 JSON。我完全不知道如何将两者结合在一起。下面是我正在修改的代码：

```
from xml.dom import minidom
from django.utils import simplejson as json

#pseudo code that returns actual xml data as a string from remote server. 
result = urlfetch.fetch(url,'','get');

dom = minidom.parseString(result.content)
json = simplejson.load(dom)

self.response.out.write(json) 
```

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2012-04-18T01:03:23.027

[xmltodict](https://github.com/martinblech/xmltodict)（完全公开：我写的）可以帮助您将 XML 转换为 dict+list+string 结构，遵循这个[“标准”](http://www.xml.com/pub/a/2006/05/31/converting-between-xml-and-json.html)。它是基于[Expat](http://docs.python.org/library/pyexpat.html)的，因此速度非常快，并且不需要将整个 XML 树加载到内存中。

拥有该数据结构后，您可以将其序列化为 JSON：

```
import xmltodict, json

o = xmltodict.parse('<e> <a>text</a> <a>text</a> </e>')
json.dumps(o) # '{"e": {"a": ["text", "text"]}}' 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2010-03-27T00:16:58.393

Soviut 对 lxml objectify 的建议很好。使用专门的子类 simplejson，您可以将 lxml 对象化结果转换为 json。

```
import simplejson as json
import lxml

class objectJSONEncoder(json.JSONEncoder):
  """A specialized JSON encoder that can handle simple lxml objectify types
      >>> from lxml import objectify
      >>> obj = objectify.fromstring("<Book><price>1.50</price><author>W. Shakespeare</author></Book>")       
      >>> objectJSONEncoder().encode(obj)
      '{"price": 1.5, "author": "W. Shakespeare"}'       
 """

    def default(self,o):
        if isinstance(o, lxml.objectify.IntElement):
            return int(o)
        if isinstance(o, lxml.objectify.NumberElement) or isinstance(o, lxml.objectify.FloatElement):
            return float(o)
        if isinstance(o, lxml.objectify.ObjectifiedDataElement):
            return str(o)
        if hasattr(o, '__dict__'):
            #For objects with a __dict__, return the encoding of the __dict__
            return o.__dict__
        return json.JSONEncoder.default(self, o) 
```

有关用法示例，请参见文档字符串，本质上您将 lxml 的结果传递`objectify`给实例的 encode 方法`objectJSONEncoder`

请注意，Koen 的观点在这里非常有效，上面的解决方案仅适用于简单的嵌套 xml，不包括根元素的名称。这可以修复。

我在这里的要点中包含了这个类：http: [//gist.github.com/345559](http://gist.github.com/345559)

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-01-23T12:51:49.433

我认为 XML 格式可以如此多样化，以至于如果没有非常严格定义的 XML 格式，就不可能编写出能够做到这一点的代码。这就是我的意思：

```
<persons>
    <person>
        <name>Koen Bok</name>
        <age>26</age>
    </person>
    <person>
        <name>Plutor Heidepeen</name>
        <age>33</age>
    </person>
</persons> 
```

会成为

```
{'persons': [
    {'name': 'Koen Bok', 'age': 26},
    {'name': 'Plutor Heidepeen', 'age': 33}]
} 
```

但这会是什么：

```
<persons>
    <person name="Koen Bok">
        <locations name="defaults">
            <location long=123 lat=384 />
        </locations>
    </person>
</persons> 
```

明白了吗？

编辑：刚刚发现这篇文章：[http ://www.xml.com/pub/a/2006/05/31/converting-between-xml-and-json.html](http://www.xml.com/pub/a/2006/05/31/converting-between-xml-and-json.html)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-01-23T06:23:44.723

Jacob Smullyan 编写了一个名为[pesterfish](https://bitbucket.org/smulloni/pesterfish)的实用程序，它使用 effbot 的[ElementTree](http://effbot.org/zone/element-index.htm)将 XML 转换为 JSON。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-24T02:03:01.910

一种可能性是使用[lxml 模块](http://codespeak.net/lxml/objectify.html)中的 Objectify 或 ElementTree 。python xml.etree 模块中也提供了旧版本的 ElementTree。其中任何一个都会将您的 xml 转换为 Python 对象，然后您可以使用[simplejson](http://pypi.python.org/pypi/simplejson/)将对象序列化为 JSON。

虽然这似乎是一个痛苦的中间步骤，但当您同时处理 XML*和*普通 Python 对象时，它开始变得更有意义。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-02T03:31:50.547

通常，您希望从 XML 转换为您的语言的常规对象（因为通常有合理的工具可以做到这一点，而且转换难度更大）。然后从 Plain Old Object 生成 JSON —— 也有用于此的工具，而且它是一个非常简单的序列化（因为 JSON 是“对象表示法”，自然适合序列化对象）。我假设 Python 有它的一套工具。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-07-13T19:44:43.540

我基于 pesterfesh 编写了一个基于命令行的小型 Python 脚本，它正是这样做的：

[https://github.com/hay/xml2json](https://github.com/hay/xml2json)

# ruby - Ruby 块的“_”参数

> ID：471952
> 
> 赞同：2
> 
> 时间：2009-01-23T05:14:58.747
> 
> 标签：ruby, zentest

我在阅读 ZenTest 源代码时遇到了这个问题：

下面是 add_mapping 方法的定义：

```
def add_mapping(regexp, &proc)
  @test_mappings << [regexp, proc]
end 
```

在 中`Autottest.initailize()`，`add_method`被调用为实现添加映射。

```
self.add_mapping(/^lib\/.*\.rb$/) do |filename, _|
  possible = File.basename(filename).gsub '_', '_?'
  files_matching %r%^test/.*#{possible}$%
end 
```

我的问题是块的第二个参数“_”是什么意思？似乎它没有在块中使用。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-23T13:32:38.633

这是一个习惯用法，用于指示未使用绑定到 '_' 的参数，即使它需要传递给块/方法。

例子：

```
def blah
   yield 1,2
end

blah {|a,b|
  puts a
  # b is never used
} 
```

比较相同的：

```
blah {|a,_|
   puts a
} 
```

请注意，'_' 是 ruby​​ 中完全合法的变量名，因此两个版本是相同的，以下也适用：

```
blah {|a,_|
   puts _
} 
```

使用 '_' 只不过是一种约定，就像使用`i`计数器、'x' 和 'y' 或 'foo' 和 'bar' 一样。

这意味着你很酷，因为你一直在涉足函数式编程，我相信这就是这个成语的起源......

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-23T05:21:23.103

```
def animals
  yield "Tiger"
  yield "Giraffe"
end
animals { |_| puts "Hello, #{_}" } 
```

[从http://en.wikibooks.org/wiki/Ruby_Programming/Ruby_Basics](http://en.wikibooks.org/wiki/Ruby_Programming/Ruby_Basics)窃取的示例

据我所知，它将 _ 定义为稍后可以引用的变量。这只是强迫 ruby​​ 的手，并将 _ 定义为所产生的任何值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-23T05:17:40.520

也许作者将它用作短变量名，以便可以忽略第二个参数。

# algorithm - 如何有效地确定多边形是凸面、非凸面还是复面？

> ID：471962
> 
> 赞同：52
> 
> 时间：2009-01-23T05:16:48.790
> 
> 标签：algorithm, geometry, polygon, computational-geometry, xlib

从手册页[`XFillPolygon`](https://tronche.com/gui/x/xlib/graphics/filling-areas/XFillPolygon.html)：

> *   如果`shape`是**Complex**，路径可能会自相交。请注意，路径中的连续重合点不会被视为自相交。
>     
>     
> *   如果`shape`是**Convex**，则对于多边形内的每一对点，连接它们的线段不会与路径相交。如果客户端知道，指定**Convex**可以提高性能。如果为非凸路径指定**凸**路径，则图形结果未定义。
>     
>     
> *   如果`shape`是**Nonconvex**，则路径不会自相交，但形状不是完全凸的。如果客户知道，指定**Nonconvex**而不是**Complex**可能会提高性能。如果为自相交路径指定**Nonconvex**，则图形结果未定义。

我在填充方面遇到了性能问题`XFillPolygon`，正如手册页所建议的，我要采取的第一步是指定多边形的正确形状。为了安全起见，我目前正在使用**Complex 。**

是否有一种有效的算法来确定多边形（由一系列坐标定义）是凸的、非凸的还是复杂的？

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2009-12-10T14:06:43.463

你可以让事情变得比礼物包装算法容易得多......当你有一组没有任何特定边界的点并且需要找到凸包时，这是一个很好的答案。

相反，考虑多边形不是自相交的情况，它由列表中的一组点组成，其中连续点形成边界。在这种情况下，确定多边形是否凸面要容易得多（而且您也不必计算任何角度）：

对于多边形的每对连续边（每个三元组点），计算由指向这些点的边以递增顺序定义的向量叉积的 z 分量。取这些向量的叉积：

```
 given p[k], p[k+1], p[k+2] each with coordinates x, y:
 dx1 = x[k+1]-x[k]
 dy1 = y[k+1]-y[k]
 dx2 = x[k+2]-x[k+1]
 dy2 = y[k+2]-y[k+1]
 zcrossproduct = dx1*dy2 - dy1*dx2 
```

如果叉积的 z 分量全部为正或全部为负，则多边形是凸的。否则多边形是非凸的。

如果有 N 个点，请确保计算 N 个叉积，例如确保使用三元组 (p[N-2],p[N-1],p[0]) 和 (p[N-1], p[0]，p[1]）。

* * *

如果多边形是自相交的，那么即使它的有向角都在同一个方向上，它也不[符合凸性的技术定义](http://mathworld.wolfram.com/ConvexPolygon.html)，在这种情况下，上述方法不会产生正确的结果。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2017-07-28T11:12:38.003

当您搜索“确定凸多边形”时，此问题现在是 Bing 或 Google 中的第一项。然而，没有一个答案是足够好的。

**[@EugeneYokota](https://stackoverflow.com/questions/471962/how-do-determine-if-a-polygon-is-complex-convex-nonconvex/471981#471981)****的（现在已删除）**答案通过检查是否可以将一组无序的点制成凸多边形来工作，但这不是 OP 所要求的。他要求一种方法来检查给定的多边形是否是凸的。（计算机科学中的“多边形”通常被定义为[在[XFillPolygon 文档](https://tronche.com/gui/x/xlib/graphics/filling-areas/XFillPolygon.html)中] 为 2D 点的有序数组，连续点与边相连，最后一个点与第一个点相连。）此外，礼品包装算法在这种情况下，将具有`O(n^2)`for`n`点的时间复杂度 - 这比解决此问题的实际需要大得多，而问题要求一种有效的算法。

**[@JasonS 的答案](https://stackoverflow.com/questions/471962/how-do-determine-if-a-polygon-is-complex-convex-nonconvex/1881201#1881201)**以及遵循他的想法的其他答案，接受[五角星](https://en.wikipedia.org/wiki/Pentagram)[形](https://en.wikipedia.org/wiki/Star_polygon)或@zenna 评论中的星形多边形，但星形多边形不被认为是凸的。正如@plasmacel 在评论中指出的那样，如果您事先知道多边形不是自相交的，这是一种很好的方法，但如果您没有该知识，它可能会失败。

**[@Sekhat 的答案](https://stackoverflow.com/questions/471962/how-do-determine-if-a-polygon-is-complex-convex-nonconvex/7930173#7930173)**是正确的，但它也具有时间复杂性`O(n^2)`，因此效率低下。

**[@LorenPechtel](https://stackoverflow.com/questions/471962/how-do-determine-if-a-polygon-is-complex-convex-nonconvex/472001#472001)**在编辑后添加的答案是这里最好的答案，但它含糊不清。

**具有最佳复杂度的正确算法**

我在这里介绍的算法的时间复杂度为`O(n)`，正确地测试了一个多边形是否是凸的，并且通过了我对其进行的所有测试。这个想法是遍历多边形的边，注意每边的方向和连续边之间方向的有符号变化。这里的“有符号”表示向左为正，向右为负（或相反），正前方为零。这些角度被归一化为负 pi（不包括）和 pi（包括）之间。*将*所有这些方向变化角（也称为*偏转*角）加*在一起*将导致正负一圈（即*360*度）对于凸多边形，而星状多边形（或自相交环）将具有不同的总和（*n * 360*度，对于*n*整体转，对于所有偏转角具有相同符号的多边形） . 所以我们必须检查方向改变角度的总和是正负一圈。我们还检查方向变化角度是否全部为正或全部为负且不反转（pi 弧度），所有点都是实际的 2D 点，并且没有连续的顶点是相同的。（最后一点值得商榷——您可能希望允许重复顶点，但我更喜欢禁止它们。）这些检查的组合捕获所有凸多边形和非凸多边形。

这是 Python 3 的代码，它实现了该算法并包括一些次要的效率。由于注释行和避免重复点访问所涉及的簿记，代码看起来比实际更长。

```
TWO_PI = 2 * pi

def is_convex_polygon(polygon):
    """Return True if the polynomial defined by the sequence of 2D
    points is 'strictly convex': points are valid, side lengths non-
    zero, interior angles are strictly between zero and a straight
    angle, and the polygon does not intersect itself.

    NOTES:  1\.  Algorithm: the signed changes of the direction angles
                from one side to the next side must be all positive or
                all negative, and their sum must equal plus-or-minus
                one full turn (2 pi radians). Also check for too few,
                invalid, or repeated points.
            2\.  No check is explicitly done for zero internal angles
                (180 degree direction-change angle) as this is covered
                in other ways, including the `n < 3` check.
    """
    try:  # needed for any bad points or direction changes
        # Check for too few points
        if len(polygon) < 3:
            return False
        # Get starting information
        old_x, old_y = polygon[-2]
        new_x, new_y = polygon[-1]
        new_direction = atan2(new_y - old_y, new_x - old_x)
        angle_sum = 0.0
        # Check each point (the side ending there, its angle) and accum. angles
        for ndx, newpoint in enumerate(polygon):
            # Update point coordinates and side directions, check side length
            old_x, old_y, old_direction = new_x, new_y, new_direction
            new_x, new_y = newpoint
            new_direction = atan2(new_y - old_y, new_x - old_x)
            if old_x == new_x and old_y == new_y:
                return False  # repeated consecutive points
            # Calculate & check the normalized direction-change angle
            angle = new_direction - old_direction
            if angle <= -pi:
                angle += TWO_PI  # make it in half-open interval (-Pi, Pi]
            elif angle > pi:
                angle -= TWO_PI
            if ndx == 0:  # if first time through loop, initialize orientation
                if angle == 0.0:
                    return False
                orientation = 1.0 if angle > 0.0 else -1.0
            else:  # if other time through loop, check orientation is stable
                if orientation * angle <= 0.0:  # not both pos. or both neg.
                    return False
            # Accumulate the direction-change angle
            angle_sum += angle
        # Check that the total number of full turns is plus-or-minus 1
        return abs(round(angle_sum / TWO_PI)) == 1
    except (ArithmeticError, TypeError, ValueError):
        return False  # any exception means not a proper convex polygon 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2014-08-14T09:04:24.403

以下 Java 函数/方法是[此答案](https://stackoverflow.com/a/1881201/3924118)中描述的算法的实现。

```
public boolean isConvex()
{
    if (_vertices.size() < 4)
        return true;

    boolean sign = false;
    int n = _vertices.size();

    for(int i = 0; i < n; i++)
    {
        double dx1 = _vertices.get((i + 2) % n).X - _vertices.get((i + 1) % n).X;
        double dy1 = _vertices.get((i + 2) % n).Y - _vertices.get((i + 1) % n).Y;
        double dx2 = _vertices.get(i).X - _vertices.get((i + 1) % n).X;
        double dy2 = _vertices.get(i).Y - _vertices.get((i + 1) % n).Y;
        double zcrossproduct = dx1 * dy2 - dy1 * dx2;

        if (i == 0)
            sign = zcrossproduct > 0;
        else if (sign != (zcrossproduct > 0))
            return false;
    }

    return true;
} 
```

只要顶点是有序的（顺时针或逆时针），并且您没有自相交的边（即它仅适用于[简单的多边形](https://en.wikipedia.org/wiki/Simple_polygon)），该算法就可以保证工作。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-01-23T05:37:30.060

这是一个检查多边形是否为**凸**的测试。

考虑沿多边形的每组三个点——一个顶点、之前的顶点、之后的顶点。如果每个角度都是 180 度或更小，则您有一个凸多边形。当你计算出每个角度时，还要保持（180 - 角度）的运行总数。对于凸多边形，总计 360。

该测试在 O(n) 时间内运行。

另请注意，在大多数情况下，您可以执行一次并保存此计算 - 大多数情况下，您有一组多边形可供使用，这些多边形不会一直变化。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-10-28T13:54:13.127

要测试多边形是否凸面，多边形的每个点都应该与每条线齐平或位于每条线后面。

这是一个示例图片：

![在此处输入图像描述](https://i.stack.imgur.com/lv8sR.png)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-04-21T20:37:03.557

假设顶点是有序的（顺时针或逆时针），此方法适用于简单的多边形（没有自相交的边）

对于顶点数组：

```
vertices = [(0,0),(1,0),(1,1),(0,1)] 
```

以下`python`实现检查`z`所有叉积的组件是否具有相同的符号

```
def zCrossProduct(a,b,c):
   return (a[0]-b[0])*(b[1]-c[1])-(a[1]-b[1])*(b[0]-c[0])

def isConvex(vertices):
    if len(vertices)<4:
        return True
    signs= [zCrossProduct(a,b,c)>0 for a,b,c in zip(vertices[2:],vertices[1:],vertices)]
    return all(signs) or not any(signs) 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2017-12-31T21:53:17.620

[@RoryDaulton](https://stackoverflow.com/questions/471962/how-do-determine-if-a-polygon-is-complex-convex-nonconvex/45372025#45372025)的答案 对我来说似乎是最好的，但如果其中一个角度正好是 0 怎么办？有些人可能希望这样的边缘情况返回 True，在这种情况下，将行中的“<=”更改为“<”：

```
if orientation * angle < 0.0:  # not both pos. or both neg. 
```

这是我突出显示问题的测试用例：

```
# A square    
assert is_convex_polygon( ((0,0), (1,0), (1,1), (0,1)) )

# This LOOKS like a square, but it has an extra point on one of the edges.
assert is_convex_polygon( ((0,0), (0.5,0), (1,0), (1,1), (0,1)) ) 
```

第二个断言在原始答案中失败。应该是？对于我的用例，我希望它没有。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-02-01T18:59:56.797

我实现了这两种算法：@UriGoren 发布的一种算法（有一点改进 - 仅整数数学）和@RoryDaulton 用Java 发布的一种算法。我遇到了一些问题，因为我的多边形是封闭的，所以两种算法都认为第二个是凹的，而它是凸的。所以我改变了它以防止这种情况。我的方法还使用基本索引（可以是或不是 0）。

这些是我的测试顶点：

```
// concave
int []x = {0,100,200,200,100,0,0};
int []y = {50,0,50,200,50,200,50};

// convex
int []x = {0,100,200,100,0,0};
int []y = {50,0,50,200,200,50}; 
```

现在算法：

```
private boolean isConvex1(int[] x, int[] y, int base, int n) // Rory Daulton
{
  final double TWO_PI = 2 * Math.PI;

  // points is 'strictly convex': points are valid, side lengths non-zero, interior angles are strictly between zero and a straight
  // angle, and the polygon does not intersect itself.
  // NOTES:  1\.  Algorithm: the signed changes of the direction angles from one side to the next side must be all positive or
  // all negative, and their sum must equal plus-or-minus one full turn (2 pi radians). Also check for too few,
  // invalid, or repeated points.
  //      2\.  No check is explicitly done for zero internal angles(180 degree direction-change angle) as this is covered
  // in other ways, including the `n < 3` check.

  // needed for any bad points or direction changes
  // Check for too few points
  if (n <= 3) return true;
  if (x[base] == x[n-1] && y[base] == y[n-1]) // if its a closed polygon, ignore last vertex
     n--;
  // Get starting information
  int old_x = x[n-2], old_y = y[n-2];
  int new_x = x[n-1], new_y = y[n-1];
  double new_direction = Math.atan2(new_y - old_y, new_x - old_x), old_direction;
  double angle_sum = 0.0, orientation=0;
  // Check each point (the side ending there, its angle) and accum. angles for ndx, newpoint in enumerate(polygon):
  for (int i = 0; i < n; i++)
  {
     // Update point coordinates and side directions, check side length
     old_x = new_x; old_y = new_y; old_direction = new_direction;
     int p = base++;
     new_x = x[p]; new_y = y[p];
     new_direction = Math.atan2(new_y - old_y, new_x - old_x);
     if (old_x == new_x && old_y == new_y)
        return false; // repeated consecutive points
     // Calculate & check the normalized direction-change angle
     double angle = new_direction - old_direction;
     if (angle <= -Math.PI)
        angle += TWO_PI;  // make it in half-open interval (-Pi, Pi]
     else if (angle > Math.PI)
        angle -= TWO_PI;
     if (i == 0)  // if first time through loop, initialize orientation
     {
        if (angle == 0.0) return false;
        orientation = angle > 0 ? 1 : -1;
     }
     else  // if other time through loop, check orientation is stable
     if (orientation * angle <= 0)  // not both pos. or both neg.
        return false;
     // Accumulate the direction-change angle
     angle_sum += angle;
     // Check that the total number of full turns is plus-or-minus 1
  }
  return Math.abs(Math.round(angle_sum / TWO_PI)) == 1;
} 
```

现在来自 Uri Goren

```
private boolean isConvex2(int[] x, int[] y, int base, int n)
{
  if (n < 4)
     return true;
  boolean sign = false;
  if (x[base] == x[n-1] && y[base] == y[n-1]) // if its a closed polygon, ignore last vertex
     n--;
  for(int p=0; p < n; p++)
  {
     int i = base++;
     int i1 = i+1; if (i1 >= n) i1 = base + i1-n;
     int i2 = i+2; if (i2 >= n) i2 = base + i2-n;
     int dx1 = x[i1] - x[i];
     int dy1 = y[i1] - y[i];
     int dx2 = x[i2] - x[i1];
     int dy2 = y[i2] - y[i1];
     int crossproduct = dx1*dy2 - dy1*dx2;
     if (i == base)
        sign = crossproduct > 0;
     else
     if (sign != (crossproduct > 0))
        return false;
  }
  return true;
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-11-15T02:31:30.427

将 Uri 的代码改编成 matlab。希望这可能会有所帮助。

*请注意，Uri 的算法仅适用于* **简单的多边形**！所以，一定要先测试多边形是否简单！

```
% M [ x1 x2 x3 ...
%     y1 y2 y3 ...]
% test if a polygon is convex

function ret = isConvex(M)
    N = size(M,2);
    if (N<4)
        ret = 1;
        return;
    end

    x0 = M(1, 1:end);
    x1 = [x0(2:end), x0(1)];
    x2 = [x0(3:end), x0(1:2)];
    y0 = M(2, 1:end);
    y1 = [y0(2:end), y0(1)];
    y2 = [y0(3:end), y0(1:2)];
    dx1 = x2 - x1;
    dy1 = y2 - y1;
    dx2 = x0 - x1;
    dy2 = y0 - y1;
    zcrossproduct = dx1 .* dy2 - dy1 .* dx2;

    % equality allows two consecutive edges to be parallel
    t1 = sum(zcrossproduct >= 0);  
    t2 = sum(zcrossproduct <= 0);  
    ret = t1 == N || t2 == N;

end 
```

# java - 狂野的JavaFX？

> ID：471966
> 
> 赞同：18
> 
> 时间：2009-01-23T05:18:27.867
> 
> 标签：java, javafx, ria

有人知道任何基于 JavaFX 的真实 Web 应用程序吗？我是一位经验丰富的 Java 程序员，正在考虑在我不从事日常工作的时候创建一个网站。我在 UI 方面没有很多专业知识，所以我正在寻找利用我现有技能的最佳方式来创建可以提供出色 RIA 体验的东西。唯一的麻烦是，我不知道任何使用 JavaFX 实现的站点，因为它太新了。我想看看它有什么能力。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-23T08:13:28.357

在这里发现了一个相当[有趣的故事](http://learnjavafx.typepad.com/weblog/)。下面列出前两个。

*   [推文框](http://code.google.com/p/tweetbox/)
*   [TweetFX](http://projectkenai.com/projects/twitterfx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-28T01:40:22.070

我认为 JavaFX 可以做的最好的例子是 JavaFX.com 上的例子。

但是，它仍处于 JavaFX 时代的早期，因此您将处于先驱时代。这意味着有潜在的丰厚回报，但也 - 许多未知数。

我认为 JavaFX 的“最佳点”是：

1 - 如果您具有 Photoshop 技能或正在与具有 Photoshop 技能的人合作 - JavaFX 提供了唯一真正的平台，可让您使用 Photoshop 并生成 UI。通常你在 Photoshop 中制作模型并尽力复制，JavaFX 可以在本地利用它。

2 - 您可以“免费”获得 Java 库中的所有好东西。

3 - 可以利用 UI 技能来移动（JavaFX 无论如何都会运行的那些）。

但是，如果您只是想要一个 Java GUI，但宁愿等待 JavaFX 的更多改进——我建议您在 Java 6u10 或更高版本上使用 MigLayout 并使用 Swing。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-17T00:58:57.423

[JavaFX Coding Challenge](http://javafx.com/challenge/index.jsp#winners)中有一些 JavaFX 应用程序；我个人最喜欢的是[Music Explorer FX](http://musicexplorerfx.citytechinc.com/)。

新版[Indaba Music](http://www.indabamusic.com/)的软件是用 JavaFX 编写的；旧版本是在 Flash 中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-12T20:14:35.300

在我个人看来，我不会将 JavaFX 用于 Web。仅仅是因为 HTML5 正在粉碎所有人的视线。现在，我完全推荐在桌面应用程序中使用 JavaFX。

# emulation - 是什么让构建游戏机模拟器如此困难

> ID：471973
> 
> 赞同：14
> 
> 时间：2009-01-23T05:20:21.513
> 
> 标签：emulation, video-game-consoles

我一直在阅读有关为 Wii 构建模拟器的人的一些信息，似乎鉴于它只不过是增强型 GameCube 或 Nintendo64，那么是什么让为这些系统构建模拟器如此困难？

顺便说一句，这些系统的硬件非常低：
Wii：
   729MHz PPC CPU
   88MB 内存
   243MHz GPU
N64：
   93.75MHz CPU（64 位）
   4MB 内存

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-01-23T05:29:54.943

与普通台式机相比，游戏机的 CPU 架构通常有些奇特。 *仿真*意味着在软件中执行原始硬件所做的一切。也就是说，虽然最初的控制台可能有专用的图形、音频等芯片以及具有不同指令集的 CPU，但模拟器必须快速执行这些并行资源的所有功能。

除非控制台的 GPU 很旧，否则几乎可以肯定它必须在主机的 GPU 上进行仿真，因为现代显卡，即使是便宜的显卡，其吞吐量（图形工作负载）也是最昂贵的多核 CPU 的许多倍。使这一困难更加复杂的是，CPU、GPU、任何其他板载 DSP 和内存之间的通信可能在控制台上进行了高度优化，以利用硬件配置的细节，因此这些资源也必须进行速率匹配。

加上所有这些困难，通常对控制台硬件的细节知之甚少，因为这是在设计上非常保密的。对于业余爱好者来说，逆向工程越来越不可行。

从长远来看，架构模拟器（一个可以在 x86 机器上运行的程序，例如，一个 PowerPC 程序并收集有关它的各种统计信息）可能比实时运行慢 1000 倍到 100000 倍。现代 CPU 的 RTL 模拟（对构成芯片的所有门和触发器的模拟）通常只能在 10Hz 到几百赫兹之间运行。即使是非常优化的仿真也可能比本地代码慢 10 到 100 倍，因此限制了今天可以令人信服地仿真的内容（特别是考虑到游戏控制台仿真器所暗示的实时交互性）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-08-12T06:33:33.300

仿真困难的原因有很多。

1.  模拟系统需要比目标系统更多的功率

有时主机系统需要比目标系统高一个数量级的功率（速度）。如果您认为主机需要完成原始系统的所有工作，*然后需要更多*工作来管理组件之间的所有通信，同时还与其他应用程序共享系统资源，这很容易理解。这就是为什么需要 2GHz 处理器才能忠实地模拟运行在区区 21MHz 的 SNES。

2.  有时人们不知道指令集和/或子系统的工作原理

大多数硬件本质上是一个黑匣子，通过逆向工程来了解它的工作原理，这需要大量的时间和耐心。更不用说，公司尽最大努力使逆向工程变得困难，并且公司在这个后 Playstation 1 时代变得更好。

3.  缺乏构建模拟器的人

仿真是一个非常小众的领域，需要许多领域的大量工作知识。坦率地说，能够模仿许多现代系统的人并不多。模拟这些系统需要花费大量时间和精力，而且只有最敬业的人才会真正做到这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-05-16T12:25:08.670

编写模拟器很困难，因为您必须准确/完全/绝对复制所述硬件行为，包括它在软件中的操作系统行为。

在某些情况下，为旧游戏机编写模拟器比为现代游戏机编写模拟器更难。因为，许多现代控制台使用某种形式的 Linux 或 *nix，所以一旦硬件被模拟，软件就是转储机器的 bios 和处理控制权的问题。

较旧的控制台在硬件中完成了所有工作，这意味着逆向工程发挥了更大的作用。您需要非常优秀的低级黑客来帮助您记录旧控制台的工作原理以及每个幻数的含义。

今天，魔幻数字变少了，取而代之的是标准的 GFX 卡和 CPU。尽管现代硬件有更多的指令和闪亮的小玩意可以模仿。与旧游戏机不同，现代游戏机所做的许多事情都有据可查。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-24T01:45:58.677

这只是因为游戏程序是为特定硬件编写的，因此它可以利用其所有硬件优势。即使您拥有一台超级计算机，它也无法正常运行无法与超级计算机本身的硬件通信的特定程序。如果您在 PS3/4 或 Xbox One 等游戏机上运行 PC 游戏，情况也是如此。唯一能运行 99% 的模拟器是 Snes 模拟器和 PS1。

# usability - 响应时间慢的备忘单

> ID：471979
> 
> 赞同：6
> 
> 时间：2009-01-23T05:23:07.903
> 
> 标签：usability, response-time

有没有人有关于用户界面响应时间的当前和历史论文以及权威链接（统计数据和博客文章）的链接？

权威的环节自然是[人机交互中的人因设计准则](http://portal.acm.org/citation.cfm?id=810380)

一些关键报价包括：

> [关于] 对下一页请求的响应。[…] 超过 1 秒的延迟似乎会干扰思想的连续性。

和

> 假设已经进行了任何类型的查询。用户——以及他的注意力——被终端所俘虏，直到他收到响应。如果他是一个忙碌的人，15 秒以上的囚禁，即使是对他至关重要的信息，也可能不仅仅是烦恼和干扰。它很容易成为士气低落者——即降低工作节奏和工作动力。

这些引语已有 40 年历史，但在今天却如此重要。

还有雅各布尼尔森的[权威摘录](http://www.useit.com/papers/responsetime.html)。

我想在此社区 wiki 下收集此类研究的所有链接。

下次当您的经理告诉您忽略响应时间或构建会减慢您的应用程序的功能时，您只需向他们发送指向此页面的链接即可。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T21:37:47.223

[我认为最简单的答案是在 Jakob Nielsen 的一篇文章中，他在响应时间：三个重要限制](http://www.useit.com/papers/responsetime.html)中定义了 10/1/.1 秒规则。那篇文章是基于他的《[可用性工程](http://www.useit.com/jakob/useengbook.html)》一书中的一节。他在 2009 年的几个会议上展示了对网络的进一步研究和适用性，所有会议都与[1](http://www.useit.com/papers/responsetime.html) .

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T23:34:35.500

我刚刚遇到：

*[系统响应时间和用户满意度：基于浏览器的应用程序的实验研究](http://www.collecter.org/archives/2000_April/03.pdf)*（注意它的 PDF）作者：John A. Hoxmeier，Ph.D。

调查结果摘要如下：

*   H1 满意度随着响应时间的增加而降低 [**支持**]
*   H2不满意导致停止使用[**支持**]
*   H3 易用性随着满意度的降低而降低 [**支持**]
*   H4 经验丰富的用户更能容忍较慢的响应时间 [**不支持**]

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-08T23:40:57.103

与 lavinio 发布的链接类似，Jakob Nielsen 最近的文章概述了下拉菜单悬停时间的 0.5/0.1/0.5 秒规则。

[http://www.useit.com/alertbox/mega-dropdown-menus.html](http://www.useit.com/alertbox/mega-dropdown-menus.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-08T23:48:33.903

我最近遇到了与网站速度有关的这些：

男人需要速度 [http://www.websiteoptimization.com/speed/tweak/usability-criteria/](http://www.websiteoptimization.com/speed/tweak/usability-criteria/)

研究：网络用户更喜欢速度而不是定制 [http://www.websiteoptimization.com/speed/tweak/design-factors/](http://www.websiteoptimization.com/speed/tweak/design-factors/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-26T21:44:51.907

**拯救生命**

我读了这篇[小文章](http://www.folklore.org/StoryView.py?project=Macintosh&story=Saving_Lives.txt)

引用史蒂夫乔布斯的话：

> “好吧，假设你可以将启动时间缩短 10 秒。将其乘以 500 万用户，那就是每天 5000 万秒。一年多，这可能是几十个生命周期。所以如果你让它启动 10 秒快点，你救了十几条人命，真的很值得，你不觉得吗？”

我认为对于大容量站点的响应时间也可以提出同样的论点。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-23T06:47:25.317

Jared Spool 分享了在 UIE 进行的一些关于[执行目标而不是下载时间的重要性的](http://www.uie.com/brainsparks/2006/02/14/uietips-06-02-14/)研究结果。

> 自从五年前我们进行了最初的研究以来，我们反复发现用户对实现他们的目标比快速加载页面更感兴趣。由于目标通常很复杂，并且需要用户深思熟虑，因此设计最好的网站似乎可以摆脱比平均速度慢的页面。

他引用的 2001 年的原始研究是Christine Perfetti 和 Lori Landesman[的 The Truth About Download Time](http://www.uie.com/events/roadshow/articles/download_time/)。

# c - 如何读取或捕获 C 中的 Ctrl+某个键或 Alt+某个键？

> ID：471980
> 
> 赞同：3
> 
> 时间：2009-01-23T05:23:22.973
> 
> 标签：c, windows, keyboard-shortcuts

`Ctrl`例如，当按下某个键与任何其他键的组合（或者它可能是键）时，我想做一些事情`Alt`。然后从标准输入如何在 C 程序中读取该组合键作为输入。

我尝试简单`getchar()`地了解这些组合的 ASCII 值。但它是一些 1 到 25 以及一些组合键的其他值。是否有任何标准库函数可以读取它们。不要问我为什么要这么做。

**编辑**：我的平台是 Windows 上的 Turbo C。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-23T05:29:18.390

简短的回答：以特定于平台的方式。

长答案：C 的输入/输出概念是流标准输出和标准输入的概念。您上面提到的 getchar() 函数只是从标准输入流中读取。尽管键盘是一种常见的输入法，但 C 没有任何键盘的概念。在你的键盘和你的 C 程序的标准输入之间通常有几个抽象层。执行此操作的机制是实现定义的，根本不是 C 的一部分。您提到了 ASCII，但 C 不需要 ASCII，尽管它非常常见。

一些库尝试提供便携式键盘输入工具，例如[SDL](http://www.libsdl.org/)和[curses](http://en.wikipedia.org/wiki/Curses_(programming_library))。

另请参阅有关系统依赖项的[comp.lang.c 常见问题解答，尤其是 19.5。](http://c-faq.com/osdep/index.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-23T05:53:49.683

这是 Windows[虚拟键代码](http://msdn.microsoft.com/en-us/library/ms645540.aspx)- 您的程序使用[GetMessage](http://msdn.microsoft.com/en-us/library/ms644936(VS.85).aspx)获取它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T02:16:35.803

```
//Here is a program to save a graphical o/p to bmp
#include<graphics.h>
#include<conio.h>
#include<stdio.h>
#include<stdlib.h>

int SaveBMP16(char []);
typedef unsigned char byte;
typedef unsigned int word;
typedef unsigned long dword;
void main()
{
    /* request auto detection */
    int gdriver;
    int gmode, errorcode;
    detectgraph(&gdriver,&gmode);
    /* initialize graphics and local variables */
    initgraph(&gdriver, &gmode, "c:\\tc\\bgi");

    errorcode = graphresult();
    if (errorcode != grOk)  /* an error occurred */
       exit(1);

    int midx, midy,radius = 100;

    midx = getmaxx() / 2;
    midy = getmaxy() / 2;

    setcolor(getmaxcolor());

    /* draw the circle */
    circle(midx, midy, radius);

    /* clean up */
    SaveBMP16("Circle.Bmp");
}

struct BMP
{

// BitMap File Header
    byte bfType[2]; /* 1 2 must always be set to 'BM' to declare that this is a .bmp file.*/
    dword bfSize;  /* 3 4   specifies the size of the file in bytes.*/
    word bfReserved1;// 7 2 must always set to zero.                  */
    word bfReserved2;// 9 2 must always be set to zero.
    dword bfOffset; // 11 4 specifies the offset from the beginning of the file to bitmap data.

// BitMap Image Header
    dword biSize;   // 15 4 specifies the size of the BitMap Header structure, in bytes.
    dword biWidth;  // 19 4 specifies the width of image, in pixels.
    dword biHeight; // 23 4 specifies the height of image, in pixels.
    word biPlanes;  // 27 2 specifies the number of planes of the target device,must be set to 0
    word biBitCount; // 29 2  specifies the number of bits per pixel.
    dword biCompression; //31 4 Specifies the type of compression, usually set to 0 - No Compres
    dword biSizeImage;  // 35 4 specifies the size of the image data, in bytes. If                  there is no compression, it is valid to set this member to zero.
    dword biXPelsPerMeter; //39 4 specifies the the horizontal pixels per meter on the                  designated targer device, usually set to zero.
    dword biYPelsPerMeter;  // 43 4 specifies the the vertical pixels per meter on the                  designated targer device, usually set to zero
    dword biClrUsed;    // 47 4 specifies the number of colors used in bitmap, if set to 0                  number of colors is calculated using the biBitCount member.
    dword biClrImportant;   // 51 4 specifies the number of color that are 'important' for                  the bitmap, if set to zero, all colors are important.
};

int SaveBMP16(char file[])
{
    int i=0, j=0, r, g, b;

    FILE *fp;
    BMP *bmp;

    bmp=(BMP *)malloc(54);

    bmp->bfType[0]='B';
    bmp->bfType[1]='M';
    bmp->bfSize=153718;
    bmp->bfReserved1=0;
    bmp->bfReserved2=0;
    bmp->bfOffset=118;
    bmp->biSize=40;
    bmp->biWidth=640;
    bmp->biHeight=480;
    bmp->biPlanes=1;
    bmp->biBitCount=4;
    bmp->biCompression=0;
    bmp->biSizeImage=153600;   //Fixed Size ?
    bmp->biXPelsPerMeter=0;
    bmp->biYPelsPerMeter=0;
    bmp->biClrUsed=0;
    bmp->biClrImportant=0;

    fp=fopen(file, "wb");
    if(fp == NULL)
    {
        printf("File can't be open");
        getch();
        return 1;
    }

    fwrite(bmp, 54, 1, fp);
    fseek(fp, 54L, SEEK_SET);

    // Upto Here its OK.

    // Question 1\. What do next 16x4 Lines do ?

    fputc(0x0, fp);
    fputc(0x0, fp);
    fputc(0x0, fp);
    fputc(0x0, fp);

    fputc(127, fp);
    fputc(0x0, fp);
    fputc(0x0, fp);
    fputc(0x0, fp);

    fputc(0x0, fp);
    fputc(127, fp);
    fputc(0x0, fp);
    fputc(0x0, fp);

    fputc(127, fp);
    fputc(127, fp);
    fputc(0x0, fp);
    fputc(0x0, fp);

    fputc(0x0, fp);
    fputc(0x0, fp);
    fputc(127, fp);
    fputc(0x0, fp);

    fputc(127, fp);
    fputc(0x0, fp);
    fputc(127, fp);
    fputc(0x0, fp);

    fputc(0x0, fp);
    fputc(192, fp);
    fputc(192, fp);
    fputc(0x0, fp);

    fputc(192, fp);
    fputc(192, fp);
    fputc(192, fp);
    fputc(0x0, fp);

    fputc(128, fp);
    fputc(128, fp);
    fputc(128, fp);
    fputc(0x0, fp);

    fputc(255, fp);
    fputc(0x0, fp);
    fputc(0x0, fp);
    fputc(0x0, fp);

    fputc(0x0, fp);
    fputc(255, fp);
    fputc(0x0, fp);
    fputc(0x0, fp);

    fputc(255, fp);
    fputc(255, fp);
    fputc(0x0, fp);
    fputc(0x0, fp);

    fputc(0x0, fp);
    fputc(0x0, fp);
    fputc(255, fp);
    fputc(0x0, fp);

    fputc(255, fp);
    fputc(0x0, fp);
    fputc(255, fp);
    fputc(0x0, fp);

    fputc(0x0, fp);
    fputc(255, fp);
    fputc(255, fp);
    fputc(0x0, fp);

    fputc(255, fp);
    fputc(255, fp);
    fputc(255, fp);
    fputc(0x0, fp);

    i=0;
    j=479;

    fseek(fp, 118, SEEK_SET);

    while(j>=0)
    {
        i=0;
        while(i<640)
        {
            fputc((getpixel(i, j)<<4) | getpixel(i+1, j), fp); //Que 2\. What does this do ? Why Left Shift 4 times and why Bit wise ORing of two pixles.  
            i+=2;
        }
        j--;
    }
    free(bmp);
    fclose(fp);
    return 0;
} 
```

# c# - 任何人都可以提供 XMLTextReader 自定义逻辑来快速读取大型 XML...吗？

> ID：471990
> 
> 赞同：1
> 
> 时间：2009-01-23T05:29:14.570
> 
> 标签：c#, xml

我需要一个帮助，我需要一个自定义逻辑来读取大小为 1GB 的大型 XML。

谢谢西瓦拉姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T05:46:23.193

以下代码片段可能会对您有所帮助：

```
private void readXML() {
    XmlReaderSettings settings = new XmlReaderSettings();
    //configure xml reader settings...
    using(XmlReader reader = XmlReader.Create("file.xml", settings)){
        while (reader.Read()){
            //read xml content..
        }
        reader.Close();
    }
} 
```

# wcf - 使用 ASP.NET Ajax 通过 SSL 调用 WCF

> ID：471999
> 
> 赞同：0
> 
> 时间：2009-01-23T05:35:56.723
> 
> 标签：wcf, asp.net-ajax, web-config, forms-authentication

我正在使用 ASP.NET Ajax 从 ASP.NET 页面调用 WCF。我正在使用表单身份验证来保护网站。

在开发过程中一切都按预期工作，直到它被部署到生产服务器上，然后我开始收到 JavaScript 错误，因为找不到该服务。生产服务器使用 SSL，所以我在*web.config*中添加了以下内容：

```
<webHttpBinding>
    <binding name="webBinding">
    <security mode="Transport" />
    </binding>
</webHttpBinding> 
```

这阻止了 JavaScript 错误的发生，但现在 WCF 服务的行为不像以前那样。

在将安全设置为传输之前，从 ASP.NET Ajax 调用 WCF 服务将`Application_AuthenticateRequest`在我的 Global.asax 中执行。这将基于表单身份验证票设置自`IPrinciple`定义`HttpContext.Current.User`。我的 WCF 服务的构造函数集`Thread.CurrentPrinciple = HttpContext.Current.User`，因此我的服务可以`IPrinciple`在`Application_AuthenticateRequest`.

将安全性更改为 Transport 后，它似乎没有运行，`Application_AuthenticateRequest`因为 my `Thread.CurrentPrinciple`is not my custom `IPrinciple`。

有谁知道我如何获得与使用 Transport 之前和使用 Transport 之后相同的行为？

我的网页使用以下内容来引用 WCF 服务：

```
<asp:ScriptManagerProxy ID="ScriptManagerProxy1" runat="
    <Services>
        <asp:ServiceReference Path="~/Services/MyService.svc" />
    </Services>
</asp:ScriptManagerProxy> 
```

我的代码中使用的`Application_AuthenticateRequest`：

```
protected void Application_AuthenticateRequest(object sender, EventArgs e)
{
    String cookieName = FormsAuthentication.FormsCookieName;
    HttpCookie authCookie = Context.Request.Cookies[cookieName];

    if (authCookie == null)
    {
        return;
    }

    FormsAuthenticationTicket authTicket = null;
    try
    {
        authTicket = FormsAuthentication.Decrypt(authCookie.Value);
    }
    catch
    {
        return;
    }

    if (authTicket == null)
    {
        return;
    }

    HttpContext.Current.User = new CustomPrinciple(authTicket.Name);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-02-09T23:56:46.920

简单地将安全性从 None 更改为 Transport 不会影响通过 Authenticate_Request 运行的应用程序。您可能应该将调试器附加到服务实现并查看 HttpContext.Current.User 是什么。是您的自定义主体还是未设置？您可能还想在其中添加一些 Debug.Write 消息，看看操作的顺序是什么。Authenticate_Request 事件是否在您预期之后发生？

如果您在配置中使用 ，您可能会在[MS Connect 中遇到此问题](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=369445&wa=wsignin1.0)`<serviceAuthorization principalPermissionMode="UseAspNetRoles" />`- 此设置似乎与安全传输不兼容，并且 WCF 会覆盖主体。如果您正在设置主体，那么您似乎需要使用`principalPermissionMode="None"`它。

确保您仍然通过配置 ( ) 或通过服务上的属性( )在服务上启用[ASP.NET 兼容模式](http://blogs.msdn.com/wenlong/archive/2006/01/23/516041.aspx "ASP.NET 兼容模式")。否则，该服务将无法访问 HttpContext.Current。`<serviceHostingEnvironment aspNetCompatibilityEnabled="true" />``[AspNetCompatibilityRequirements(RequirementsMode = AspNetCompatibilityRequirementsMode.Required)]`

此外，不要在服务实现构造函数中获取 HttpContext.Current.User，而是尝试将其移动到您附加到服务的行为中。实现一个`IDispatchMessageInspector`处理`AfterReceiveRequest`事件并将主体从 Web 上下文传输到线程的方法。它看起来像这样：

```
public class HttpContextPrincipalInspector : IDispatchMessageInspector
{
  public object AfterReceiveRequest(ref Message request, IClientChannel channel, InstanceContext instanceContext)
  {
    if (HttpContext.Current != null)
    {
      IPrincipal principal = HttpContext.Current.User;
      Thread.CurrentPrincipal = principal;
    }
    return null;
  }

  public void BeforeSendReply(ref Message reply, object correlationState) { }
} 
```

而且，当然，实现一个`IEndpointBehavior`附加调度程序......

```
public class HttpContextPrincipalBehavior : IEndpointBehavior
{
  public void ApplyDispatchBehavior(ServiceEndpoint endpoint, EndpointDispatcher endpointDispatcher)
  {
    ChannelDispatcher channelDispatcher = endpointDispatcher.ChannelDispatcher;
    foreach (EndpointDispatcher endpointDispatch in channelDispatcher.Endpoints)
    {
      endpointDispatch.DispatchRuntime.MessageInspectors.Add(new HttpContextPrincipalInspector());
    }
  }

  // AddBindingParameters, ApplyClientBehavior, and Validate implementations
  // can be empty - they don't do anything.
} 
```

...和一个自定义`BehaviorExtensionElement`，以便您可以在 WCF 配置中使用它：

```
public class HttpContextPrincipalElement : BehaviorExtensionElement
{
  public override Type BehaviorType
  {
    get { return typeof(HttpContextPrincipalBehavior); }
  }

  protected override object CreateBehavior()
  {
    return new HttpContextPrincipalBehavior();
  }
} 
```

然后，您可以将任何服务配置为将其用作端点行为，这样服务实现就不会直接与 Web 上下文对话。使测试更容易一些，并且可以完全解决问题 - 任何时候收到服务的消息，它都会自动转移主体，而不是依赖于服务的构建。*************