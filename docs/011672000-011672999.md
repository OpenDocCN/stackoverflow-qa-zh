# StackOverflow 问答 11672000-11672999

# .htaccess - How does rewrite URL and 301 redirection work together

> ID：11672000
> 
> 赞同：1
> 
> 时间：2012-07-26T14:51:00.963
> 
> 标签：.htaccess, mod-rewrite, redirect, http-status-code-301

I've got:

```
RewriteRule ^page/([^/\.]+)/?$ index.php?page=$1 [L] 
```

Which points `page/([^/\.]+)/?` to `index.php?page=$1`.

When I go to `page/([^/\.]+)/`, I don't want to see index.php (which is achieved from the above)

For the reverse, when I go to index.php, I **want to** see a visible 301 redirection to `page/([^/\.]+)/`.

How do I do this without causing an infinite loop... or do I only rely on canonical tags?

**Update:**

I got it happening in one direction (new to old), but not the other (Old to new)

```
RewriteRule ^([^/\.]+)-yum/?$ yum/?x=$1 [L]
RewriteRule ^([^/\.]+)/([^/\.]+)-yum/?$ yum/?x=$2&y=$1 [L] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T17:34:23.903

You need to do a check against the `%{THE_REQUEST}` variable so that you are rewriting *only* when the actual request is for the index.php file:

```
RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /index\.php\?page=([^&]+)([^\ ]*)
RewriteRule ^/?index\.php$ /page/%1/?%2 [L,R=301] 
```

So if a browser requests `http://yourdomain.com/index.php?page=qwe&someother=var`

It should get redirected to: `http://yourdomain.com/page/qwe/?someother=var`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T15:55:07.120

**Full solution here:**

```
RewriteCond %{QUERY_STRING} Variable=([A-Za-z]+)$
RewriteRule OldURL/$ /NewURL/%1? [L,R=301]
RewriteRule ^NewUrl/([^/\.]+)$ MappedNewLocationFolder/?Variable=$1 [L] 
```

**1st Line:** Check (the name and number of) parameters are as expected

**2nd Line:** Check base path of parameter(s), which is OldURL is correct and 301 to NewUrl

**3rd Line:** Map NewUrl to actual location where file sits (not shown in browser)

(The question mark right at the end of 2nd line strips out the variables from appending to the NewUrl)

# jquery - 防止 div 内容超过其他 div

> ID：11672001
> 
> 赞同：1
> 
> 时间：2012-07-26T14:51:05.973
> 
> 标签：jquery, html, css

我已经用 css 和 div 构建了一个 html 布局。我有名为 top（这是标题）、left（链接用于页面）和 center（用于显示图像）的 div。

当我单击链接以在左侧显示图像时，我可能会得到比浏览器窗口大的图像，我需要在其中滚动。我可以滚动，但图像会越过顶部看不到我的标题的部分。我想做的是，顶部总是在浏览器窗口上。当我在中心滚动图像时，如果它们超出我的顶部 div，我喜欢隐藏穿过顶部 div 的部分。有没有办法在css中做到这一点？

```
#top {
height: 300px;
width: 100%;
position: fixed;
}

#left {

    padding:0;
    border: 0;
    width: 350px;
    overflow: scroll;
    float: left;
    position: fixed;
    top: 5px; 
    bottom:0px;
    min-height:950px;

}

#center1 {
margin-left:352px;
padding:0;
border: 0;
float: left;
position:static;
overflow: hidden;
display: block;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T14:52:42.133

使用`z-index`标题上的属性并将其设置为 100 或 1000。Z-index 仅在您使用`position:relative`,`position:absolute`或`position:fixed`.

```
#top {
    height: 300px;
    width: 100%;
    position: fixed;
    z-index: 1000;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T19:57:27.943

这是一个持久的标头。我希望这对你有用，尽管你必须修改它以满足你的需要......

```
<DOCTYPE html>
<html>
<head>
<title>Constant Header</title>
<style type="text/css">

body 
{ 
margin:0; 
padding:0; 
}

#header_container 
{ 
background:#eee; 
border:1px solid #666; 
height:60px; 
left:0; 
position:fixed; 
width:100%; 
top:0; 
}
#header
{ 
line-height:60px; 
margin:0 auto; 
width:940px; 
text-align:center; 
}

/* CSS for the content of page. Top padding of 80px to make sure the header do not         overlap the content.*/

#container 
{ 
margin:0 auto;
overflow:auto;
padding:80px 0;
width:100%;
}
#content{}

#left {
padding:0;
border: 0;
width: 150px;
float: left;
position: fixed;
top: 85px; 
bottom:0px;
min-height:950px;
}

#center1 {
margin-left:152px;
padding:0;
border: 0;
float: left;
position:static;
overflow: hidden;
display: block;
}
</style>
</head>
<body>
<div id="header_container">
  <div id="header">
      Header Content
  </div>
</div>
<!-- BEGIN: Page Content -->
<div id="container">
  <div id="left">
     <a href="large_img.jpg" alt="large image">nav to img </a>
  </div>
  <div id="center1">
    <img id="imgLogo" src="" alt="large image"/>
      ...
  </div>
</div>
<!-- END: Page Content -->
</body>
</html> 
```

# android - 仅使用 android 中的电子邮件客户端应用程序发送电子邮件

> ID：11672002
> 
> 赞同：2
> 
> 时间：2012-07-26T14:51:08.047
> 
> 标签：android, email, android-intent

我想实现一个发送电子邮件的选项。现在我可以发送电子邮件，但问题是，Android 显示了许多应用程序要发送，例如蓝牙、Facebook、消息等，这不是必需的。我需要避免这种情况，只显示电子邮件客户端应用程序。

```
Intent intent = new Intent(Intent.ACTION_SEND); 
String[] emails = {"suresh.chandani@gmail.com"}; 
intent.putExtra(Intent.EXTRA_EMAIL, emails); 
intent.putExtra(Intent.EXTRA_STREAM, uri); 
intent.putExtra(Intent.EXTRA_SUBJECT, "Test App"); 
intent.putExtra(Intent.EXTRA_TEXT, "Email Body"); 
intent.setType("message/rfc822"); 
startActivity(intent); 
```

如果有人知道如何实现这一点，请告诉我

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T17:44:46.560

```
Intent intent = new Intent(Intent.ACTION_SENDTO, Uri.parse("mailto:suresh.chandani@gmail.com);    
intent.putExtra(Intent.EXTRA_SUBJECT, "Test App");  
intent.putExtra(Intent.EXTRA_TEXT, "Email Body");
startActivity(intent); 
```

归功于[Adams Bros 博客](http://blog.adamsbros.org/2011/12/31/send-email-in-your-android-application/)，但他在帖子中确实提到这仅适用于他的 gmail。看看你有没有成功。他确实展示了另一种对他有用的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T14:58:17.960

要将电子邮件发送到特定地址，`ACTION_SENDTO`请`mailto:` `Uri`在您`Intent`提供给`startActivity()`. 或者，使用适用于 Android 的 JavaMail 端口实现您自己的电子邮件客户端。

# c++ - 将 python 解释器嵌入到 C++

> ID：11672008
> 
> 赞同：5
> 
> 时间：2012-07-26T14:51:12.960
> 
> 标签：c++, python, user-interface, integration, interpreter

如果这个问题已经得到回答，你将不得不原谅我，但我还没有找到任何专门谈论我需要的东西。

我正在尝试将 python 解释器嵌入到用 C++ 编写的 GUI 中。为了更全面地描述它，我有一系列将显示在窗口中的图像。这些图像将从服务器流式传输，以及有关图像的各种信息以及它们如何相互比较。GUI 底部还会有一个大的文本区域，带有提示（如 python CLI 中的“>>>”提示），用户可以在其中键入有效的 python 代码，然后应用程序根据它的信息执行该代码在当前显示的图像上有。

例如，如果图像存储在一个包含高度和宽度信息（`image->height`和`image->width`）的结构中，并且我在 Python 中编写了一个与当前显示的数据接口的类（一切都会做它看起来应该做的事情），我需要能够执行以下操作并获得输出：

```
>>> from image import image #custom module and class for interfacing with my GUI
>>> img = image.get_current_image() #returns a Python object relating to the image currently displayed
>>> img.width
800
>>>img.height
600
>>> img.aspect_ratio()
4:3 
```

我知道一些从 python 代码访问 c++ 类的方法，例如[Boost Python](http://www.boost.org/doc/libs/1_50_0/libs/python/doc/)。我不确定如何在 C++ GUI 中创建解释器。问题是 python 和 C++ 必须实时相互通信，并且必须共享内存。例如，python 模块可能包含一个`to_grayscale()`将图像转换为灰度的函数，这将要求 python 模块从 C++ 中检索图像，对其进行转换，然后将其发送回以重新渲染。

为了清楚起见，我不需要帮助进行转换或类似的事情。我如何将解释器与 C++ 集成？

谢谢！

# excel - 如何在单元格中为新创建的行自动强制执行公式？

> ID：11672010
> 
> 赞同：1
> 
> 时间：2012-07-26T14:51:15.853
> 
> 标签：excel, excel-2010, vba

我有一个用于估计的工作表，其中某些列有一个公式，最重要的是 Column(A) 有一个公式 =ROW() 我用作该估计（行项目）的 ID，而 Column(I) 是一个总数（=该行中所有估计值的 SUM(E2:H2))。

当用户插入新行（新估计）时，我需要确保新行中已经包含所需的公式，我不希望用户需要从其上方的单元格中拖动公式（这不是精通 Excel 的人使用）。

此外，这应该只对特定范围的行进行（如果不使用，我不想看到 Row750 的 ID/Total），需要有一种方法来告诉它在特定点停止（对于例如，我有一行（13），其中 B13="TOTAL" 和 C13=SUM 的总数（总总数），这应该是最后一行，所以如果用户对新行感兴趣，它将在这一行之上，等等。 .

任何帮助/提示/想法将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T19:43:07.907

您可以使用“表格”功能。在 Excel 2003 中，它被称为“列表”。我不确定在 2010 年在哪里可以找到此功能。

前任：

将范围定义为~~列表~~桌子。我使用该`ROW()`函数对行进行自动编号。这是它的外观：

![数据列表](../Images/cb959b2e4edc9cf7ba615c965e869180.png)

它没有解决[蒂姆](https://stackoverflow.com/questions/11672010/how-to-automatically-enforce-a-formula-in-cells-for-a-newly-created-row#comment15473471_11672010)提到的问题，但我将其归档在“不是问题”下。我实际上更喜欢动态自动编号。当您插入一行时，自动编号会自动更改：

![在列表中插入行](../Images/abb5beb9dfcc635ae39891e038f78e48.png)

当您删除一行时，自动编号会调整：

![删除列表中的行](../Images/8df0e11ab0bfd93acc0cc760d7194f37.png)

最好的部分是~~列表~~表格将自动填充。除了`ROW`公式之外，我`SUM`在 C 列中添加了一个公式，然后添加了一条新记录：

![列出填写公式](../Images/94c587b44b68d4ea3578322b7e242a47.png)

至于在某个时候停止，您需要将公式移动到另一列。该列表将继续向下并且不会仅仅因为您在那里有一个公式而停止。您需要右键单击~~列表~~表，选择“插入»行”以使您的公式与~~列表~~桌子。

# php - PHP/MySQL 在提交时插入多个数据表

> ID：11672011
> 
> 赞同：0
> 
> 时间：2012-07-26T14:50:11.450
> 
> 标签：php, postgresql

我正在工作中构建一个 Web 应用程序，并且我有一个表单，用户可以在其中注册某些类型的信息。

```
Username   |   Password   |   Company 
```

现在我不确定如何处理这个问题。我想要的是当用户提交该注册表单时用户名、密码和公司被写入一个数据表（用户）但是因为公司在用户数据表中是一个外键引用我需要将公司写入一个单独的数据表（公司）作为主键（当然用户名要写为 FK 引用，因为它是 1 - 1 关系）。

我不是在寻找你们的编码解决方案，因为我知道我的 PHP 和 MYSQL，我只是在寻找一些伪代码算法来让创意源源不断！

编辑：我使用的是 POSTGRESQL 而不是 MYSQL，但我很确定除了端口号和小的语法更改之外几乎没有什么区别

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T14:57:46.573

假设第一列是`id`：

1.  保存公司`$mysqli->query("INSERT INTO company VALUES (NULL, '$company_name')";`
2.  获取此项目的 id。`$company_id = $mysqli->insert_id;`
3.  使用此 ID 保存用户`$mysqli->query("INSERT INTO user VALUES (NULL, '$username', '$password', '$company_id')";`
4.  获取用户id`$user_id = $mysqli->insert_id;`
5.  用它更新公司：`$mysqli->query("UPDATE company SET user_id = $user_id WHERE company_id = $company_id)";`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T14:56:23.843

开始在您的表公司中插入您的公司。找回身份证。（有一个类似的 sql 请求`LastInsertId`）在您的表用户中插入用户/密码/IdCompagny。

编辑：一些帮助：[http ://dev.mysql.com/doc/refman/5.0/en/getting-unique-id.html](http://dev.mysql.com/doc/refman/5.0/en/getting-unique-id.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T15:27:27.717

一些问题：

*   为什么用户：公司 == 1:1？如果我和同事加入您的网站，我们是否需要假装在不同的地方工作？
*   如果公司可以拥有一名以上的员工，您将采用哪种验证来组合公司名称的变体（例如 IBM 与 International Business Machines）？
*   如果用户失业怎么办？

如果公司是一个*很好知道的*数据而不是一个*必需的或事情中断的*数据，我可能会先注册我的用户。然后，当用户登录时，您可以唠叨他们以获取更多信息。这具有使用户注册对用户来说不那么繁重的额外优势。

一个用例：

*   用户提交`username`并`password`
*   过滤坏东西的输入并验证重复、适用性
*   保存到数据库并检索用户 PK
*   加载“附加信息”页面并将会话变量设置为“唠叨”标志 - 如果用户选择不填写附加信息，唠叨标志可以触发提醒行为
*   将自动完成添加到公司字段，以便用户可以使用现有的公司表条目
*   处理表格并保存到数据库
    *   添加公司和关联用户
    *   或者只是关联用户
*   取消设置会话唠叨标志，这样您的网站就不会继续唠叨

# javascript - 使用 JavaScript 重定向到另一个页面

> ID：11672014
> 
> 赞同：1
> 
> 时间：2012-07-26T14:51:36.640
> 
> 标签：javascript, facebook, grails

我正在为 Android 和 iPhone 开发一个 webapp。我需要“在 facebook 中分享”功能，并且我知道我可以使用 url “http://www.facebook.com/sharer/sharer.php?u=”，将 url 附加到它以在 Facebook 中打开共享我们都知道和喜爱的窗口。我试图用 JavaScript 来做，但是要共享的 url 必须动态附加......

到目前为止我已经尝试过：

```
function goP(){
    var fname=${promo.urlPromocion};
    window.location = "http://www.facebook.com/sharer/sharer.php?u="+${object.url};
} 
```

有引号，没有引号，在 facebook url 和要共享的 url 之间有和没有 + 符号，甚至试图硬编码一个 url。我不知道是否调用了 JS 函数。但是，它不起作用。这是调用函数的 gsp 文件部分：

```
<div class="rrss" style= "width:60px; height:60px; float:left; margin-right:10px; margin-left:68px;" id="facebook"><a href="JavaScript:goP()"><img src="../images/img_mobile/1340130521_facebook.png"/></a></div> 
```

有什么帮助吗？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T14:55:29.927

将其更改为

```
window.location.href = .... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T14:57:27.053

尝试：

`window.location.href = 'http://example.com';`

window.location 实际上是一个具有名为“href”的属性的对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-10T08:43:51.383

```
The following script can help you.

<script type="text/javascript">
        function SubmitFrm() {
            var Searchtxt = $("#<%= txtSearchBooks.ClientID%>").val();
            window.location = "http://www.website.com/search?sUrl=" + Searchtxt;
        }
</script>

For More Details 
```

[点击这里](http://aspdotnet41.blogspot.in/2013/09/redirect-to-another-page-using.html)

# android - 循环图像 - 位图大小超过 VM 预算

> ID：11672015
> 
> 赞同：0
> 
> 时间：2012-07-26T14:51:39.433
> 
> 标签：android, android-imageview, android-memory

我有一个 Activity，上面有一个 ImageView，但它会多次交换资源，循环浏览几个不同的高分辨率图像。

我遇到了“位图大小超过 VM 预算”错误。我[在这里看到过关于在 onDestroy 方法中手动清理东西的帖子](https://stackoverflow.com/questions/1949066)，但活动并不总是那么远。

我该怎么做才能在不耗尽内存的情况下循环浏览大量大图像？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T15:11:51.763

我建议在 onPause() 方法中回收 imageView 的位图，并在 onResume() 中再次加载图像。

# python - 使用python格式化Json字符串

> ID：11672018
> 
> 赞同：7
> 
> 时间：2012-07-26T14:51:55.997
> 
> 标签：python, json, string, format

我想知道是否有任何方法可以在python中用json格式化某个对象的编码结果字符串。例如，假设我有以下字典：

```
{'a': 12.73874, 'b': 1.74872, 'c': 8.27495} 
```

json编码的结果是：

```
{
    "c": 8.27495,
    "b": 1.74872,
    "a": 12.73874
} 
```

而我想要的结果是：

```
{
    "a": 12.74,
    "c": 8.28,
    "b": 1.75
} 
```

注意元素的顺序和每个数字的小数位。有没有办法做到这一点？

提前致谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-07T19:59:21.153

如果您使用的是 2.6+，则可以这样做：

`print json.dumps(jsonStr, sort_keys=True, indent=2, separators=(',', ': '))`

[http://docs.python.org/2/library/json.html](http://docs.python.org/2/library/json.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-26T16:01:48.097

您正在尝试将 JSON 用于它不打算用于的东西，所以它不能很好地工作也就不足为奇了。您可以考虑使用[Python`json`模块](http://hg.python.org/cpython/file/c947f493ccec/Lib/json)的源代码作为您自己的输出代码的起点，尽管从头开始可能最容易——编写这样的输出函数并不是那么复杂的任务。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-26T14:58:04.357

对于 Python 和 JSON，dict 中的顺序没有任何意义。如果您介意，请使用列表而不是 dicts。

如果您只想订购 JSON 输出（即，更喜欢`{1:0, 2:0}`，`{2:0, 1:0}`即使它们是等效的），您可以使用[`collections.OrderedDict`](http://docs.python.org/release/3.1/library/collections.html#collections.OrderedDict)which 将记住插入项目的顺序。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-26T16:24:35.300

您可以通过将浮点数放入自定义类并覆盖该方法来更改浮点数的序列化`__repr__`方式，如下所示：

```
import json

class CustomFloat(float):
    def __repr__(self):
        return "%.3g" % self

D = {'a': CustomFloat(12.73874),
     'b': CustomFloat(1.74872),
     'c': CustomFloat(8.27495)}

print json.dumps(D, indent=2) 
```

这打印：

```
{
  "a": 12.7, 
  "c": 8.27, 
  "b": 1.75
} 
```

这至少解决了你一半的问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-26T15:39:29.763

尝试`sort_keys=True`使用`json.dumps`or `json.JSONEncoder.__init__`。例如，

```
>>> import json
>>> d = {'a': 'Apple', 'b': Banana, 'c': 'Pepsi'}
>>> print json.dumps(d)
{"a": "Apple", "c": "Pepsi", "b": "Banana}
>>> print json.dumps(d, sort_keys=True)
{"a": "Apple", "b": "Banana, "c": "Pepsi"} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-26T17:02:48.473

```
import json
from collections import OrderedDict

d = {'a': 12.73874, 'b': 1.74872, 'c': 8.27495}
L = sorted(d.items(), key=lambda x: x[1], reverse=True) # sort by float value
print(json.dumps(OrderedDict((k, round(v, 2)) for k, v in L), indent=4)) 
```

### 输出

```
{
    "a": 12.74, 
    "c": 8.27, 
    "b": 1.75
} 
```

作为替代方案，您可以`yaml`使用[example](https://stackoverflow.com/questions/8640959/how-can-i-control-what-scalar-form-pyyaml-uses-for-my-data)。

# ruby - Maruku告诉你：我怎么了？

> ID：11672025
> 
> 赞同：12
> 
> 时间：2012-07-26T14:52:18.730
> 
> 标签：ruby, jekyll, maruku

我曾经`jekyll --server`在 localhost 测试我的网站。但是有几行输入，像这样：

```
 ___________________________________________________________________________
 | Maruku tells you:
 +---------------------------------------------------------------------------
 | String finished while reading (break on []) already read: "$ git init"
 | ---------------------------------------------------------------------------
 +---------------------------------------------------------------------------
 !/usr/lib/ruby/gems/1.8/gems/maruku-0.6.0/lib/maru/errors_management.rb:49:in `maruku_error'
 !/usr/lib/ruby/gems/1.8/gems/maruku-0.6.0/lib/maruku/input/parse_span_better.rb:402:in `read_simple'
 !/usr/lib/ruby/gems/1.8/gems/maruku-0.6.0/lib/maruku/input/parse_span_better.rb:521:in `read_inline_code'
 !/usr/lib/ruby/gems/1.8/gems/maruku-0.6.0/lib/maruku/input/parse_span_better.rb:89:in `read_span'
 !/usr/lib/ruby/gems/1.8/gems/maruku-0.6.0/lib/maruku/input/    parse_span_better.rb:46:in    `parse_span_better'
 \___________________________________________________________________________
 ___________________________________________________________________________
 | Maruku tells you:
 +---------------------------------------------------------------------------
 | Could not find ref_id = "url" for md_link(["url"],"url")
 | Available refs are []
 +---------------------------------------------------------------------------
 Not creating a link for ref_id = "url". 
```

我不知道哪里错了，我应该修复哪个文件？该网站仍然可以工作。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-27T08:33:51.527

问题很可能是您的代码中有此问题：

```
Blah blah [url] blah blah. 
```

如果要保留方括号，请将它们编码如下：

```
Blah blah \[url\] blah blah. 
```

更多信息：http: [//daringfireball.net/projects/markdown/syntax#backslash](http://daringfireball.net/projects/markdown/syntax#backslash)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-01T04:48:19.887

我遇到了这个问题，原因是 Markdown 文件是从 GitHub README.md 复制的，其中包含一些[GitHub 风格的 Markdown](http://github.github.com/github-flavored-markdown/)：

```
```JavaScript
var foo = 'bar';
``` 
```

[这在 GitHub README.md 文件中运行良好，但不适用于 Jekyll 中的 Maruku，这意味着在使用GitHub Pages](https://help.github.com/categories/20/articles)托管站点时它不起作用。

# linq - 需要返回第一条记录 linq

> ID：11672026
> 
> 赞同：0
> 
> 时间：2012-07-26T14:52:21.580
> 
> 标签：linq, linq-to-sql, linq-to-entities

我只需要返回第一条记录。虽然我不得不把 z.FirstOrDefault(); 仍然显示了不止一个

```
 public DataTable GetDependents(string EmployeeID)
    {
        HealthCareSystem.DataClassesDataContext db = new HealthCareSystem.DataClassesDataContext();

        var z = (from s in db.SelectingDependentsGroupBies
                 where s.EmployeeID.Equals(EmployeeID)
                 join d in db.Dependents on s.DependentID equals d.DependentID
                 orderby s.DependentID descending

                 //Selecting wanted tables dependents fields by datatable
                 select new DependentsX { DependentID = Convert.ToInt32(s.DependentID), EmployeeID = s.EmployeeID, Name = s.Name, Surname = s.Surname, IDCardNo = s.IDCardNo, ContactNo = s.ContactNo, BirthDate = s.BirthDate, StartSchemeDate = s.StartDate, EndSchemeDate = s.EndDate, RelationType = s.Type, Payment = Convert.ToDouble(d.Payment), });

        var firstRecord = z.FirstOrDefault(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T14:54:09.590

在现有代码之后添加这一行：

```
var firstRecord = x.First(); 
```

如果结果可能为零并且您不希望出现异常，则可以`FirstOrDefault`改用。

```
var firstRecord = x.FirstOrDefault(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T15:16:43.130

另一种常见的方法是将查询括在括号中，然后在括号外包含扩展方法：

```
var x = (from d in db.DependentsRelationsViews 
        where d.IDCardNo.Equals(DepID) 
        orderby d.DependentID descending 
        select new DependentsX  
        {  
            DependentID = Convert.ToInt32(d.DependentID),  
            EmployeeID = d.EmployeeID,  
            Name = d.Name,  
            Surname = d.Surname,  
            IDCardNo = d.IDCardNo,  
            ContactNo = d.ContactNo,  
            BirthDate = d.BirthDate,  
            StartSchemeDate = Convert.ToDateTime(d.StartSchemeDate),  
            EndSchemeDate = d.EndSchemeDate,  
            Payment = d.Payment,  
            RelationType = Convert.ToString(d.Type) 
        }).FirstOrDefault(); 
```

如果您不将其括在括号中并尝试调用，`FirstOrDefault()`那么您将在最后一个`Select`子句中将该扩展应用于匿名类型。通过将整个查询括在括号中然后调用`FirstOrDefault()`扩展，您向编译器指示您希望将其应用于整个查询的返回值，即`IEnumerable<>`or`IQueryable<>`集合。

# svn - 使用新用户名将 SVN 存储库移至 AWS

> ID：11672027
> 
> 赞同：0
> 
> 时间：2012-07-26T14:52:23.303
> 
> 标签：svn, amazon-web-services, migration, repository

我已经成功地将我们的 SVN 存储库从一台内部服务器迁移到另一台，但现在正试图将其移至 AWS，并且遇到了困难。

我转储了 repo，复制到我们的 EC2 实例并导入它。但是...存储库的用户名是“subversion”，EC2 实例使用 ec2-user 登录等。

我使用 ec2-user 和密码在 SVN 的 passwd 文件中添加了一行，但是当我尝试连接到存储库时，我收到一条错误消息，指出存储库中不存在这样的用户。

我还在 EC2 上创建了一个名为 subversion 的用户，将其添加到我们的 svn 组，并尝试使用 subversion 用户名连接，但连接到 EC2 实例时出现错误。

这似乎是一个非常微不足道的问题，但它让我难住了。有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T16:42:04.263

解决了这个问题。svnserve 不知何故停止了。重新启动它并将它指向正确的根解决了所有的奇怪问题。

感谢您的帮助，克里斯托弗！

# vim - 强制 GVim 在关闭前提示

> ID：11672028
> 
> 赞同：6
> 
> 时间：2012-07-26T14:52:27.820
> 
> 标签：vim

我最近一直在过渡到 GVim，因为我发现它比终端中的 vim 更美观，而且速度更快。我有一个非常糟糕的习惯，我正在努力改掉。当我从命令行使用 vim 时，我的工作流程是这样的：

```
vim filename.txt
# make some edits
ZZ
# do other stuff
vim otherfile.txt
# make some edits
ZZ 
```

现在使用 GVim，我最终过于频繁地关闭编辑器。我想知道是否有一种方法可以强制 GVim 在我执行 a `:wq`or时提示我或打开一个空缓冲区`ZZ`。有任何想法吗？

编辑：我知道如何重新映射键，但我想知道是否有办法强制 GVim 具有与从命令行调用 vim 时不同的行为。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-26T14:55:29.997

将以下内容放入您的 vimrc 可用于完全禁用 ZZ 快捷方式：

```
nnoremap ZZ   <Nop> 
```

或者您可以将它们重新映射到以下标准行为`:q`：

```
if has("gui_running")
    nnoremap ZZ :q
    nnoremap :wq :q
endif 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-26T15:07:47.460

调用一个函数`ZZ`，如果只剩下一个标签和窗口，提示是否关闭（默认为关闭）。见`:help confirm()`。

```
nnoremap ZZ :call QuitPrompt()<cr>

fun! QuitPrompt()
   if has("gui_running") && tabpagenr("$") == 1 && winnr("$") == 1
      let choice = confirm("Close?", "&yes\n&no", 1)
      if choice == 1 | wq | endif
   else | wq | endif
endfun 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-03-27T22:09:02.750

在你的 .vimrc 中添加这个：

```
set confirm 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-04-08T15:55:31.213

Gvim 和 vim 处理退出有点不同。选项 1 在两者中都可以正常工作。选项 2 在 vi​​m 中运行良好，但在 gvim 中，您可以通过按“X”在 X Windows 中关闭（部分）绕过它。它仍然会确认文件是否未经编辑，但在保存所有内容后它将退出所有内容。也许其他人知道如何处理这个问题。

**选项 1：仅在文件未保存时确认退出**

在你的 .vimrc 中添加这个：

```
set confirm 
```

**选项 2：始终确认退出（当您执行 ZZ 或 q 时）**

使用这个插件

```
 Plugin 'vim-scripts/confirm-quit' 
```

或者手动编码，然后[看看你需要做什么](https://github.com/vim-scripts/confirm-quit/blob/master/plugin/confirm_quit.vim)（顺便说一句——这个插件是从[这个 SE Question](https://vi.stackexchange.com/questions/3711/how-do-i-avoid-exiting-vim-to-open-a-new-file/3712#3712)诞生的）

# android - 两种布局，一种在背景中

> ID：11672029
> 
> 赞同：0
> 
> 时间：2012-07-26T14:52:28.670
> 
> 标签：android, android-layout

如何创建两个布局：第一个被点亮，第二个，在背景中，不太开明？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T14:57:02.097

将两个布局都放在一个 中`RelativeLayout`，并设置具有所需透明度的适当背景颜色。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T15:08:20.220

您可以使用相对布局，您可以在其中添加另一个布局。将first的背景设置为lighted和enlighted。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T15:01:27.973

使用 FrameLayout 来包含它们。

关于“点亮”部分 - 为每个布局使用 View.setAlpha [http://developer.android.com/reference/android/view/View.html#setAlpha(float](http://developer.android.com/reference/android/view/View.html#setAlpha(float) )

# iphone - 为什么当字符串值包含空格时我的应用程序崩溃？

> ID：11672031
> 
> 赞同：0
> 
> 时间：2012-07-26T14:52:32.260
> 
> 标签：iphone, ios, ipad

我有一个应用程序，我试图将字符串从一个视图控制器发送到另一个视图控制器。当字符串没有空格时，一切正常。如果他们确实有空间，那么应用程序就会因内存泄漏而崩溃。这就是我的做法：

```
RegisterViewController2 *register2viewcontroller = [[RegisterViewController2 alloc] initWithNibName:@"RegisterViewController2" bundle:nil];

     register2viewcontroller.username2=[usernamestring retain];
     register2viewcontroller.email2=[emailstring retain];
     register2viewcontroller.password2=[passwordstring retain];
     register2viewcontroller.date=[agestring retain];
     register2viewcontroller.gender2=[gendustring retain];
     register2viewcontroller.occupation2=[occustring retain];
     [self.navigationController pushViewController:register2viewcontroller animated:YES]; 
```

username2 和 usernamestrings 是具有非原子性和强属性的类变量。有谁能够帮我？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T15:10:50.283

你几乎不应该保留这样的字符串。如果您可以展示如何声明属性，那将很有帮助。

这也可能是有用的阅读：[NSString 属性：复制还是保留？](https://stackoverflow.com/questions/387959/nsstring-property-copy-or-retain)

# c# - 如何设置 Web 服务来下载文件？

> ID：11672040
> 
> 赞同：2
> 
> 时间：2012-07-26T14:52:54.887
> 
> 标签：c#, asp.net, web-services, web

我有几个第三方网站需要允许客户端下载位于我的服务器上的文件。我的想法是建立一个网络服务来允许第三方网站访问这些文件。Web 服务将使用 C# 在 .Net 中构建。

我只是想知道是否有更好的方法来做到这一点？我想我可以构建一个静态网页来完成此任务，但文件需要有点安全，而且我认为 Web 服务比静态页面更容易为第三方开发人员使用。

任何帮助都会很棒。

编辑：我需要补充一点，要下载的文件是 pdf 文件。

# facebook - 如何将“client_id”、“redirect_uri”等参数添加到 url？

> ID：11672041
> 
> 赞同：-2
> 
> 时间：2012-07-26T14:52:56.627
> 
> 标签：facebook, facebook-graph-api, user-interface

在我访问 Facebook 上的应用程序之前，我必须允许它（给予许可）。我使用直接网址[https://www.facebook.com/dialog/oauth?client_id=XXX&redirect_uri=https://apps.facebook.com/myapp/&scope=publish_actions,user_likes&response_type=code做到了这一点](https://www.facebook.com/dialog/oauth?client_id=XXX&redirect_uri=https://apps.facebook.com/myapp/&scope=publish_actions,user_likes&response_type=code)

我可以使用这样的 url 访问应用程序，但默认情况下，如果我向某个朋友发送邀请并且他点击邀请，他会打开这样的 url：https://apps.facebook.com/myapp/?fb_source=notification&request_ids=479061678772593&app_request_type=user_to_user¬if_t =app_request

但为了工作，我的应用需要“client_id”、“redirect_uri”、“scope”和“response_type”获取参数。我如何将它们传递给这个 url？是否可以从应用程序设置中配置某些内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:06:13.133

> 但为了工作，我的应用需要“client_id”、“redirect_uri”、“scope”和“response_type”获取参数。我如何将它们传递给这个 url？

一点也不，因为该 URL 是由 Facebook 生成的。

也许您想启用*Authenticated Referrals*，以便到达您的应用程序的用户会收到自动连接到它的提示？

否则，您必须自己调用登录 URL，通过 JavaScript 重定向用户客户端；或者只是使用 FB.login。

# css - 为什么自定义 CSS 样式不应用于其他用户？

> ID：11672045
> 
> 赞同：0
> 
> 时间：2012-07-26T14:53:08.467
> 
> 标签：css, sharepoint-2010, master-pages

一直在使用[博客文章](https://chrisstahl.wordpress.com/2011/01/26/customizing-sharepoint-2010-global-navigation-with-css-and-jquery-%e2%80%93-part-iii/)使用 SharePoint 设计器和我的凭据在 SharePoint 2010 中自定义我的网站集的顶部导航。当我使用我的凭据查看站点时，我得到了预期的结果。

但是当另一个用户登录到站点集合并浏览站点和页面时，不会应用 CSS 样式。我修改了母版页以将搜索框移出顶部导航栏，所有这些更改仅反映了正在应用的 CSS 样式。

非常感谢任何解决此问题的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T15:47:35.037

糟糕，我必须使用 SharePoint 站点签入样式库中上传的 CSS 文件。由于某种原因，SharePoint Designer 中的检查不起作用。

# java - 在运行时访问注解

> ID：11672047
> 
> 赞同：3
> 
> 时间：2012-07-26T14:53:14.237
> 
> 标签：java, annotations

我如何才能访问类中的`main`真假？ 我应该在主课上写什么？ `check``Sample`

```
 package annotation;

    import java.lang.annotation.Retention;
    import java.lang.annotation.RetentionPolicy;

    @Retention(RetentionPolicy.RUNTIME)

    public @interface annotation {
        public String name() default "Jimmy";
        public boolean check() default false;
    } 
```

* * *

```
 package annotation;

    @annotation(name = "Jack", check = false)

    public class Sample {

        public String str = "Hi";

        public void printHi(String str) {
            System.out.println(str);
        }
    } 
```

* * *

```
 package annotation;

    public class Main {
        public static void main(String[] args) {

        }
    } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-26T15:02:39.640

用于[`Sample.class.getAnnotation(annotation.class)`](http://docs.oracle.com/javase/6/docs/api/java/lang/Class.html#getAnnotation%28java.lang.Class%29)获取您的注释实例，并调用`check()`以获取检查值：

```
System.out.println(Sample.class.getAnnotation(annotation.class).check()); 
```

请注意，类应该以大写字母开头，并且将注释命名为“annotation”非常令人困惑。

# java - java - 在读取 hs_err_pid 文件时需要帮助

> ID：11672048
> 
> 赞同：1
> 
> 时间：2012-07-26T14:53:16.563
> 
> 标签：java

我的应用程序不时崩溃，我在文件夹中获得 hs_err_pid 文件，而我的 apache 日志中没有其他行。

这是文件的开头

```
An unexpected error has been detected by Java Runtime Environment:

java.lang.OutOfMemoryError: requested 512000 bytes for GrET in C:\BUILD_AREA\jdk6_13\hotspot\src\share\vm\utilities\growableArray.cpp. Out of swap space?

Internal Error (allocation.inline.hpp:42), pid=3252, tid=4000
Error: GrET in C:\BUILD_AREA\jdk6_13\hotspot\src\share\vm\utilities\growableArray.cpp

Java VM: Java HotSpot(TM) Client VM (11.3-b02 mixed mode windows-x86)
If you would like to submit a bug report, please visit:
 http://java.sun.com/webapps/bugreport/crash.jsp

---------------  T H R E A D  ---------------

Current thread (0x44be5000):  VMThread [stack: 0x44c70000,0x44cc0000] [id=4000]

Stack: [0x44c70000,0x44cc0000]
[error occurred during error reporting (printing stack bounds), id 0x80000001]

VM_Operation (0x520bf2f0): GenCollectForAllocation, mode: safepoint, requested by thread 0x45d67c00

---------------  P R O C E S S  ---------------
..... 
```

最后有

```
 Other Threads:
 =>0x44be5000 VMThread [stack: 0x44c70000,0x44cc0000] [id=4000]
 0x44c19000 WatcherThread [stack: 0x44ea0000,0x44ef0000] [id=4028]

 VM state:at safepoint (normal execution)

 VM Mutex/Monitor currently owned by a thread:  ([mutex/lock_event])
 [0x003c8020] UNKNOWN - owner thread: 0x44be5000
 [0x003c8480] UNKNOWN - owner thread: 0x45d67c00

 Heap
def new generation   total 24256K, used 1365K [0x02b60000, 0x045b0000, 0x06670000)
eden space 21568K,   0% used [0x02b60000, 0x02b60000, 0x04070000)
from space 2688K,  50% used [0x04070000, 0x041c54d0, 0x04310000)
to   space 2688K,   0% used [0x04310000, 0x04310000, 0x045b0000)
tenured generation   total 242368K, used 242261K [0x06670000, 0x15320000, 0x32b60000)
the space 242368K,  99% used [0x06670000, 0x153056f8, 0x15305800, 0x15320000)
compacting perm gen  total 39936K, used 39723K [0x32b60000, 0x35260000, 0x42b60000)
the space 39936K,  99% used [0x32b60000, 0x3522add8, 0x3522ae00, 0x35260000)
No shared spaces configured.

Dynamic libraries:
0x00400000 - 0x00434000     C:\myFolder\myApp_20120723_03_Dollar2InterestFixV18.exe
0x7c900000 - 0x7c9b0000     C:\WINDOWS\system32\ntdll.dll
0x7c800000 - 0x7c8f4000     C:\WINDOWS\system32\kernel32.dll
0x77dd0000 - 0x77e6b000     C:\WINDOWS\system32\ADVAPI32.DLL
0x77e70000 - 0x77f01000     C:\WINDOWS\system32\RPCRT4.dll
0x773d0000 - 0x774d2000     C:\WINDOWS\WinSxS\X86_Microsoft.Windows.Common-    
Controls_6595b64144ccf1df_6.0.2600.2180_x-ww_a84f1ff9\COMCTL32.DLL
0x77c10000 - 0x77c68000     C:\WINDOWS\system32\msvcrt.dll 
```

我注意到“交换空间不足？” 线。还有其他线索吗？感谢您提供有关如何阅读此文件的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:26:06.907

GrowableArray 用于垃圾收集器。您可能试图在 32 位进程中分配太多内存？在这种情况下，您可以减少内存使用量（减少 heapSize vm 参数）并且 VM 不应再崩溃 - 但如果堆空间用完，您可能会收到正确的 OutOfMemory 错误。

此错误报告提供了一个很好的概述：[http ://bugs.sun.com/view_bug.do;jsessionid=2e9a93e1a4426a7101624de9e89f5?bug_id=6711183](http://bugs.sun.com/view_bug.do;jsessionid=2e9a93e1a4426a7101624de9e89f5?bug_id=6711183)

# excel - 我可以将查询表（和连接？）复制到其他工作簿吗？

> ID：11672049
> 
> 赞同：2
> 
> 时间：2012-07-26T14:53:17.200
> 
> 标签：excel, vba

我有一个工作簿（wkbk1），上面有一张包含八个不同查询表（又名数据表）的工作表——不是数据透视表。它们都指向同一个外部 Excel 工作簿 (wkbk2) 的数据，该工作簿是具有一组命名范围的单个工作表。

wkbk1 中每个表的数据来自 wkbk2 中的命名范围。如何将八个不同表（从 wkbk1）的工作表复制到其他工作簿（wkbk3、wkbk4 等）？

查询表及其数据连接是否可以与工作表一起传输？到目前为止，我无法手动完成（没有编码）。如果需要编码，我很好，只需要帮助。我有中级 VBA 编码经验。

我正在使用 Excel 2007/2010。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-26T15:05:26.257

在 Excel 2010 中，我右键单击工作表选项卡并选择移动或复制。选择目标工作簿并选中“创建副本”。新工作表上有 QueryTable 并按预期刷新。

所以我认为复制工作表将复制 QueryTable 及其所有属性。

我的 QueryTable 使用 MSQuery 并指向另一个 Excel 工作簿。

# r - 如何在 R 中将 not.camel.case 转换为 CamelCase

> ID：11672050
> 
> 赞同：25
> 
> 时间：2012-07-26T14:53:18.273
> 
> 标签：r, camelcasing

在 R 中，我想转换

```
t1 <- c('this.text', 'next.text')
"this.text" "next.text" 
```

到

```
'ThisText' 'NextText' 
```

我试过了

```
gsub('\\..', '', t1) 
```

但这给了我

```
"thisext" "nextext" 
```

因为它不会替换句号之后的字母。

可能真的很容易，但我无法解决。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-07-26T15:39:42.027

或者，基于正则表达式的解决方案：

```
t1 <- c('this.text', 'next.text')

# capitalize first letter
t2 <- sub('^(\\w?)', '\\U\\1', t1, perl=T)

# remove points and capitalize following letter
gsub('\\.(\\w?)', '\\U\\1', t2, perl=T)
[1] "ThisText" "NextText" 
```

# 编辑：一些解释

`sub('^(\\w?)', '\\U\\1', t1, perl=T)`,`sub`在这里就足够了，因为我们只对第一场比赛感兴趣。然后第一个字母数字字符在每个字符串的开头与`^(\\w?)`. 函数替换部分中的反向引用需要括号。因为替换`\\U`用于大写后面的所有内容（这是第一个字符）。

应用相同的原则`gsub('\\.(\\w?)', '\\U\\1', t2, perl=T)`，唯一的区别是匹配的不是第一个字符，而是每个`.`.

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-07-26T15:07:12.793

这是一种方法，但使用正则表达式可能会有更好的方法：

```
t1 <- c('this.text', 'next.text')

camel <- function(x){ #function for camel case
    capit <- function(x) paste0(toupper(substring(x, 1, 1)), substring(x, 2, nchar(x)))
    sapply(strsplit(x, "\\."), function(x) paste(capit(x), collapse=""))
}

camel(t1) 
```

这产生：

```
> camel(t1)
[1] "ThisText" "NextText" 
```

**编辑：** *出于好奇，我对 4 个答案进行了微基准测试（TOM=original poster，TR=myself，JMS=jmsigner & SB=sebastion；评论了 jmsigner 的帖子），发现非正则表达式的答案更快。我会假设他们更慢。*

```
 expr     min      lq  median      uq      max
1 JMS() 183.801 188.000 197.796 201.762  349.409
2  SB()  93.767  97.965 101.697 104.963  147.881
3 TOM()  75.107  82.105  85.370  89.102 1539.917
4  TR()  70.442  76.507  79.772  83.037  139.484 
```

![在此处输入图像描述](../Images/edd71ec6a157bcda875fc837cfbdab3b.png)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-07-26T15:07:02.937

实际上我想我只是从 toupper 的帮助文件中解决了这个问题：

```
camel <- function(x) {     
     s <- strsplit(x, "\\.")[[1]]     
     paste(toupper(substring(s, 1,1)), substring(s, 2),           
     sep="", collapse="") 
 }    

camel(t1) 
sapply(t1,camel)  
this.text  next.text  
"ThisText" "NextText" 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2014-11-29T19:53:13.060

`tocamel`from `rapportools`package 做你想做的事：

```
> library(rapportools)
> example(tocamel)

tocaml> tocamel("foo.bar")
tocaml>     ## [1] "fooBar"
tocaml> 
tocaml>     tocamel("foo.bar", upper = TRUE)
tocaml>     ## [1] "FooBar"
tocaml> 
tocaml>     tocamel(c("foobar", "foo.bar", "camel_case", "a.b.c.d"))
tocaml>     ## [1] "foobar"    "fooBar"    "camelCase" "aBCD"
tocaml> 
```

## 更新：

另一个简单快速的解决方案（如@rengis）：

```
camel2 <- function(x) {
    gsub("(^|[^[:alnum:]])([[:alnum:]])", "\\U\\2", x, perl = TRUE)
}
camel2(t1)
#> [1] "ThisText" "NextText" 
```

与@TylerRinker 解决方案的比较：

```
identical(camel(t1), camel2(t1))
#> [1] TRUE
microbenchmark::microbenchmark(camel(t1), camel2(t1))
#> Unit: microseconds
#>        expr    min      lq     mean  median      uq     max neval cld
#>   camel(t1) 76.378 79.6520 82.21509 81.5065 82.7095 151.867   100   b
#>  camel2(t1) 15.864 16.9425 19.76000 20.9690 21.9735  38.246   100  a 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2017-03-25T22:01:03.133

这里通过蛇盒包的另一个解决方案：

```
install.packages("snakecase")
library(snakecase)

to_upper_camel_case(t1)
#> [1] "ThisText" "NextText" 
```

Githublink：[https ://github.com/Tazinho/snakecase](https://github.com/Tazinho/snakecase)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2021-10-13T10:19:59.937

[janitor](https://cran.r-project.org/web/packages/janitor/vignettes/janitor.html)包中的`make_clean_names()`函数 有一个可以用于此的函数。

在你的情况下：

```
t1 <- c('this.text', 'next.text')
janitor::make_clean_names(t1, case = "big_camel")
#> [1] "ThisText" "NextText" 
```

该参数`case`可以是许多之一：

```
“snake”, “small_camel”, “big_camel”, “screaming_snake”, “parsed”, “mixed”, “lower_upper”, “upper_lower”, “swap”, “all_caps”, “lower_camel”, “upper_camel”, “internal_parsing”, “none”, “flip”, “sentence”, “random”, “title” 
```

^(由[reprex 包](https://reprex.tidyverse.org)（v2.0.1）于 2021 年 10 月 13 日创建)

# d3.js - d3.js 轴 - 使其有 0 个刻度并且没有标记

> ID：11672051
> 
> 赞同：2
> 
> 时间：2012-07-26T14:53:19.367
> 
> 标签：d3.js

是否可以创建 d3.js 轴并且没有刻度线和编号方案？基本上，我可以让轴不可见吗？我正在使用下面的代码来创建我的轴：

```
svg.selectAll("axis")
      .data(d3.range(angle.domain()[1]))
    .enter().append("g")
      .attr("class", "axis")
      .attr("transform", function(d) { return "rotate(" + angle(d) * 180 / Math.PI + ")"; })
    .call(d3.svg.axis()
      .scale(radius.copy().range([0,0]))
      .ticks(1)
      .orient("left"))
    .append("text")
    .style("color", "white") 
      .attr("y", 
        function (d) {
          if (window.innerWidth < 455){
            console.log("innerWidth less than 455: ",window.innerWidth);
            return -(0);
          }
          else{
            console.log("innerWidth greater than 455: ",window.innerWidth);
            return -(0);
          }
        })
      .attr("dy", "0em"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T21:40:57.437

如果您不希望您的轴可见，请不要绘制它们（基本上注释掉此代码）。

如果你真的只是想把它们变成白色，你可以使用以下类：

```
.axis line, .axis text, .axis path {
   color: white;
} 
```

这将是操纵它们以“打开”和“关闭”它们的最简单方法。此外，如果您需要弄清楚如何为`d3`图表设置样式，您可以在 SVG 中导航，就像使用 html 和 CSS 样式一样。

例如，这里是`axis`.

```
<line class="tick" y2="6" x2="0"></line> 
```

您可以看到我以元素 ( `line`) 为目标，但您也可以以 ( `.tick`) 为目标。

# c# - 未启用 IIS WebSocket 模块

> ID：11672057
> 
> 赞同：4
> 
> 时间：2012-07-26T14:53:35.293
> 
> 标签：c#, javascript, iis, websocket

我正在尝试设置一个使用 WebSockets 的 Web 应用程序。我在 Windows 7 上运行 VS12_RC，每当我尝试运行我的 websocket 时，我都会收到“未启用 IIS WebSocket 模块”。错误。我在哪里可以打开这个？我在我的添加或删除程序中看到 IIS 8 Express，但似乎在我的系统中找不到它。我假设它是用 VS12_RC 安装的？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T16:07:43.803

WebSocket 支持仅在 Windows 8 和 Windows Server 2012 上可用。自述文件中有对此效果的评论：[http ://learn.iis.net/page.aspx/1286/iis-80-express-readme/](http://learn.iis.net/page.aspx/1286/iis-80-express-readme/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-03T05:11:56.407

该网站说

IIS 8.0 Express 支持编写 WebSocket 应用程序

检查 IIS 8.0 Express 的更改 -> 新功能 -> X64 支持 -> WebSocket 支持

请让我知道我没有正确理解它。

# image - 使用 RDFa 注释网页

> ID：11672058
> 
> 赞同：0
> 
> 时间：2012-07-26T14:53:35.500
> 
> 标签：image, attributes, xhtml, annotations, rdfa

在网页中选择文本或图像时基于RDFa的网页注释。有没有人知道如何实现它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T13:04:12.290

使用正确的词汇。通过 RDFa 初始上下文[http://www.w3.org/2011/rdfa-context/rdfa-1.1](http://www.w3.org/2011/rdfa-context/rdfa-1.1)列表来发现现有的。如果不满意，并且无法找到其他人弥补这些**方面**，那么您自己开始**特定领域的**一个，小心地跳过**横切关注点**并分享。

# javascript - 带有 JQuery 音频的 HTML5 音频标签

> ID：11672059
> 
> 赞同：0
> 
> 时间：2012-07-26T14:53:38.637
> 
> 标签：javascript, jquery, html, audio

```
<html>
    <head>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js"></script>
        <script>
            $(document).ready(function(){
                $("#play-bt").click(function(){
                    $(".audio-player")[0].play();
                    $(".message").text("Music started");
                })

                $("#pause-bt").click(function(){
                    $("#audio-player")[0].pause();
                    $(".message").text("Music paused");
                })

                $("#stop-bt").click(function(){
                    $(".audio-player")[0].pause();
                    $(".audio-player")[0].currentTime = 0;
                    $(".message").text("Music Stopped");
                })
            })
        </script>
    </head>
    <body>

        <audio class ="audio-player" name="" src="01-Breakin-A-Sweat-Zedd-Remix.mp3" ></audio>
        <audio class ="audio-player" name="" src="04-zedd-stars_come_out_(terravita_remix)" ></audio>

                <div class ="message"></div>
            <a id = "play-bt" href="#">Play music</a> | <a id ="pause-bt" href="#">Pause music</a> | <a id ="stop-bt" href="#">Stop music</a> 

    </body>
</html> 
```

此代码仅播放第一个音频标签，我将如何播放下一首歌曲/曲目/音频标签？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T15:19:35.277

加载的所有音频元素都在一个数组中，您可以使用您拥有的方法访问该数组。如果您添加下一个跟踪功能，您可以浏览所有元素，如下所示：

```
$(document).ready(function(){

    var x = $(".audio-player").length; // Count total audio players
    var z = 0; // Start at first audio player

    $("#play-bt").click(function(){
        $(".audio-player")[z].play();
        $(".message").text("Music started");
    })
    $("#pause-bt").click(function(){
        $("#audio-player")[z].pause();
        $(".message").text("Music paused");
    })
    $("#stop-bt").click(function(){
        $(".audio-player")[z].pause();
        $(".audio-player")[z].currentTime = 0;
        $(".message").text("Music Stopped");
    })
    $("#next-bt").click(function(){
        $(".audio-player")[z].pause();
        z++;
        if (z >= x) z = 0;
        $(".audio-player")[z].play();
        $(".message").text("Track: "+z);
    })
})​ 
```

它使用 jquery .length 查找音频元素的数量，并且当您到达最后一个轨道时，它会从第一个轨道开始。这是一个示例-> [http://jsfiddle.net/8GycB/46/](http://jsfiddle.net/8GycB/46/)

# ravendb - RavenDB 中每种密钥生成策略的优缺点

> ID：11672060
> 
> 赞同：1
> 
> 时间：2012-07-26T14:53:40.113
> 
> 标签：ravendb

我正在将 Web 应用程序的 SQL 数据库迁移到 RavenDB，我的团队正在尝试定义最适合我们的密钥生成策略。主要讨论点是我们是使用自然键还是代理键。所以我想知道 RavenDB 中每种策略的优缺点。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T20:27:49.950

推荐的解决方案是让 RavenDB 为您处理它们。它将生成诸如“items/2”之类的东西。首先，这些东西已经足够好，人类可读并且易于高效生成。

您也可以执行“users/ayende”之类的操作，但我会等到您对 RavenDB 有更多经验后再进行操作。

最后，对于高级的东西，你有诸如“customers/1234/orders/8234”之类的键，它为高级场景打开了一些非常好的选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T23:43:40.300

如果您在密钥中构建了太多逻辑，除非您非常了解您的问题域，否则您以后可能会后悔。我们在 PHP 中做了相当多的 RavenDB 工作，因为没有客户端。我们在 C# 中进行原型制作，然后通常遵循客户创建的内容。有时，自动复数的出现很有趣，就像人们可能是人民一样。除非您直接从 Javascript 访问 RavenDB，否则这通常无关紧要。那么唯一的缺点是朋友可能会质疑你的英语水平。

# python - 在python中列出windows互斥锁

> ID：11672062
> 
> 赞同：2
> 
> 时间：2012-07-26T14:53:52.257
> 
> 标签：python, windows, mutex

如何在 python 脚本中获取**Windows （操作系统级别）互斥锁列表？**

win32event 库有 CreateMutex 和 OpenMutex，但遗憾的是没有 ListMutex...。

# php - 如何从函数访问“$this”

> ID：11672064
> 
> 赞同：1
> 
> 时间：2012-07-26T14:54:00.783
> 
> 标签：php, model-view-controller, aop

我使用自制的 MVC 系统，其中视图通过在方法的上下文中访问模型，因此能够访问`$this`.

动态包含的视图示例：

```
...
<div>
   Hello <?= $this->user->name ?>
</div>
... 
```

现在，我有一些代码要分解为函数，并带有一些额外的参数。例如 ：

```
function colored_hello($color) {
?>
<div style="background-color:<?= $color ?>">
   Hello <?= $this->user->name ?>
</div>
<?
} 
```

问题是我无权访问`$this`，因为该函数不是方法。但我不想用演示文稿破坏我的模型或控制器。

Hance，我希望能够动态调用这个函数，作为一种方法。像面向方面的编程：

```
# In the top view
magic_method_caller("colored_hello", $this, "blue") 
```

可能吗 ？或者你有没有更好的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T15:08:00.283

Take a look at [`Closure::bindTo`](http://www.php.net/manual/en/closure.bindto.php)

You'll have to define/call your functions slightly differently, but you will be able to access `$this` from inside your object.

```
class test {
    private $property = 'hello!';
}

$obj = new test;

$closure = function() {
    print $this->property;
};

$closure = $closure->bindTo($obj, 'test');

$closure(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T15:18:40.987

作为属性传递`$this`，但要严肃地说：您的视图文件中不应该有函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T15:06:30.123

这有点骇人听闻，但您可以使用 debug_backtrace() 来获取调用者对象。但我认为你只能公开价值观：

```
function colored_hello($color) {
  $tmp=debug_backtrace(DEBUG_BACKTRACE_PROVIDE_OBJECT);
  $last=array_pop($tmp);

  $caller = $last['object'];

  print_r($tmp);
  print_r($last);
  print_r($caller);

  ?>
  <div style="background-color:<?= $color ?>">
     Hello <?= $caller->user->name ?>
  </div>
  <?
} 
```

（代码不是 testet，但它给了你一个提示:-)）

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-26T15:19:58.367

您也可以将其传递给函数：

```
function coloured_hello($object, $color) {
     //Code
     $object->user->name;
} 
```

# git - 将 github 存储库克隆到实时站点，但得到：权限被拒绝（公钥）。致命：远端意外挂断

> ID：11672065
> 
> 赞同：1
> 
> 时间：2012-07-26T14:54:06.483
> 
> 标签：git, ssh, github, dreamhost, ssh-keys

我正在尝试第一次将我的 github 存储库克隆到我的实时站点上。

我将我的公钥从本地终端推送到我的 Dreamhost 服务器的主目录，如下所示：

```
cat ~/.ssh/id_rsa.pub | ssh user@myserver.com 'cat >> .ssh/authorized_keys' 
```

这没有导致任何错误，我可以在远程服务器上看到我的密钥，但是当我尝试在 ssh 到我的远程服务器后克隆一个 github 存储库时：

```
git clone git@github.com:gituser/myrepo.git myserver.com/mysite 
```

我得到：

```
Cloning into mysite...
Permission denied (publickey).
fatal: The remote end hung up unexpectedly 
```

我可以很好地将文件从本地推送到 github（经过一天的调整；））。

如何从 github 克隆到我的远程服务器（实时站点）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:04:22.437

您需要将远程服务器的公钥推送到 github。如果您尚未生成密钥，请从第一步开始，[https://help.github.com/articles/generating-ssh-keys](https://help.github.com/articles/generating-ssh-keys)。否则，从第 4 步开始，它将向您展示如何将密钥添加到您的 github 帐户。

# c# - 如何评估任何密码算法（比如椭圆曲线）的性能？

> ID：11672070
> 
> 赞同：1
> 
> 时间：2012-07-26T14:54:11.677
> 
> 标签：c#, security, cryptography

我正在研究题为“无线传感器网络的安全本地化”的 PHD。我构建了自己的 .net 模拟器并在其上构建了一个本地化算法，并通过实现椭圆曲线加密算法使该算法安全。最后一步，我需要评估这个安全算法的性能。谁能帮我？提前致谢。这是我的代码：

```
using System;
using System.IO;
using System.Text;
using System.Drawing;
using System.Collections;
using System.Windows.Forms;
using networkdll;
using Mapack;
using System.Security.Cryptography;

 namespace Kalman_Filter_Secure
 {
 public class Kalman_Filter_Secure
  {

    public Label enc_label;
    public Label dec_label;
    public TimeSpan counter1;
    public int counter, slot_duration, delimiter = 0, collision_percent;
    public DateTime timeStart;
    public String path;
    public float locatorRadius = 0, sensorRadius = 0, BSSRadius = 0;
    public object sender = null;
    public PaintEventArgs e = null;
    public ArrayList asensor = new ArrayList();
    public ArrayList alocator = new ArrayList();
    public ArrayList amlocator = new ArrayList();
    public ArrayList aBase_Stations = new ArrayList();
    public bool mobanchor = false;
    //public Random rand = new Random((int)System.DateTime.Now.Ticks);
    public Kalman_Filter_Secure(object sender, PaintEventArgs e, ArrayList asensor, ArrayList alocator, ArrayList amlocator, TimeSpan counter1, int slot_duration, String path, float locatorRadius, float sensorRadius, bool mobanchor, int delimiter, int collision_percent, float BSSRadius, ArrayList aBase_Stations, double q,/*double pd,*/ double r_x, double r_y, double r_vx, double r_vy, double ax_noise, double ay_noise, Label encrypt_label, Label decrypt_label)
    {
        set_parameters(locatorRadius, sensorRadius, counter1, slot_duration, mobanchor, collision_percent, BSSRadius, encrypt_label, decrypt_label);
        connectm(asensor, amlocator, aBase_Stations);

        Encrypt_Send(asensor);
        Receive_Decrypt(asensor);

        localize(sender, e, asensor, locatorRadius, path, delimiter, q, r_x, r_y, r_vx, r_vy, ax_noise, ay_noise);
    }

    public void set_parameters(float locatorRadius, float sensorRadius, TimeSpan counter1, int slot_duration, bool mobanchor, int collision_percent, float BSSRadius, Label encrypt_label, Label decrypt_label)
    {
        this.enc_label = encrypt_label;
        this.dec_label = decrypt_label;
        this.locatorRadius = locatorRadius;
        this.sensorRadius = sensorRadius;
        this.BSSRadius = BSSRadius;
        this.counter1 = counter1;
        this.slot_duration = slot_duration;
        this.mobanchor = mobanchor;
        this.collision_percent = collision_percent;
    }

    public void connectm(ArrayList asensor, ArrayList amlocator, ArrayList aBase_Stations)
    {
        int sensor_slot = 0, anchor_slot = 0;
        //TDMA protocol for collision free

        for (int j = amlocator.Count - 1; j >= 0; j--)//anchors slots
        {

            networkdll.Class1.Locator jLocator = (networkdll.Class1.Locator)amlocator[j];

            jLocator.Slot = new ArrayList();
            //Base Station Connection
            for (int i = 0; i < aBase_Stations.Count; i++)
            {
                networkdll.Class1.Base_Station BSS = (networkdll.Class1.Base_Station)aBase_Stations[i];
                float BSS_lRadius = (float)(Math.Sqrt(Math.Pow(BSS.x - jLocator.x, 2) + Math.Pow(BSS.y - jLocator.y, 2)));//BSS-locator distance
                if (BSS_lRadius <= BSSRadius)
                {
                    jLocator.Slot.Add((new networkdll.Class1.Slot(counter1.Milliseconds)));       //BSS sensor connection
                }
            }
            System.Threading.Thread.Sleep(0);
        }

        for (int j = asensor.Count - 1; j >= 0; j--)//sensors slots
        {

            networkdll.Class1.WirelessSensor jSensor = (networkdll.Class1.WirelessSensor)asensor[j];

            jSensor.Slot = new ArrayList();

            //Base Station Connection
            for (int i = 0; i < aBase_Stations.Count; i++)
            {
                networkdll.Class1.Base_Station BSS = (networkdll.Class1.Base_Station)aBase_Stations[i];
                float BSS_sRadius = (float)(Math.Sqrt(Math.Pow(BSS.x - jSensor.x, 2) + Math.Pow(BSS.y - jSensor.y, 2)));//BSS-sensor distance
                if (BSS_sRadius <= BSSRadius)
                {
                    jSensor.Slot.Add((new networkdll.Class1.Slot(counter1.Milliseconds)));       //BSS sensor connection
                }
            }
            System.Threading.Thread.Sleep(0);
        }

        for (int j = 0; j < asensor.Count; j++)
        {

            networkdll.Class1.WirelessSensor jSensor = (networkdll.Class1.WirelessSensor)asensor[j];
            jSensor.apkts = new ArrayList();//anchors packets
            jSensor.enc_apkts = new ArrayList();//encrypted anchors packets
            jSensor.Connections = new ArrayList();//anchors connection

            jSensor.spkts = new ArrayList();//neighbors packets
            jSensor.enc_spkts = new ArrayList();//encrypted neighbors packets
            jSensor.sConnection = new ArrayList();//neighbors connection

            jSensor.two_hop_apkts = new ArrayList();//two hop anchors packets
            jSensor.enc_two_hop_apkts = new ArrayList();//encrypted two hop anchors packets
            jSensor.two_hop_Connections = new ArrayList();//two hop anchors connection

            for (int i = 0; i < amlocator.Count; i++)
            {

                networkdll.Class1.Locator iLocator = (networkdll.Class1.Locator)amlocator[i];
                float lsRadius = (float)(Math.Sqrt(Math.Pow(iLocator.x - jSensor.x, 2) + Math.Pow(iLocator.y - jSensor.y, 2)));

                //get the associated slot for this anchor
                foreach (networkdll.Class1.Slot Slot in iLocator.Slot)
                    anchor_slot = Slot.slot;

                if (lsRadius <= locatorRadius && counter1.Milliseconds == anchor_slot)
                {
                    jSensor.Connections.Add(new networkdll.Class1.WirelessSensorConnection(iLocator, jSensor));       //MCL-MP

                    for (int k = i + 1; k < amlocator.Count; k++)//2-hop anchor connections
                    {
                        networkdll.Class1.Locator kLocator = (networkdll.Class1.Locator)amlocator[k];
                        float llRadius = (float)(Math.Sqrt(Math.Pow(iLocator.x - kLocator.x, 2) + Math.Pow(iLocator.y - kLocator.y, 2)));//anchor-anchor distance
                        float slRadius = (float)(Math.Sqrt(Math.Pow(kLocator.x - jSensor.x, 2) + Math.Pow(kLocator.y - jSensor.y, 2)));//2-hop anchor-sensor distance

                        //get the associated slot for this anchor
                        foreach (networkdll.Class1.Slot Slot in kLocator.Slot)
                            anchor_slot = Slot.slot;

                        if (llRadius <= locatorRadius && llRadius != 0 && slRadius > locatorRadius && counter1.Milliseconds == anchor_slot)
                        {
                            jSensor.two_hop_Connections.Add(new networkdll.Class1.WirelessSensorConnection(kLocator, jSensor));       //2-hop anchors connection
                        }
                    }
                }

            }
            for (int k = j + 1; k < asensor.Count; k++)
            {

                networkdll.Class1.WirelessSensor kSensor = (networkdll.Class1.WirelessSensor)asensor[k];
                float ssRadius = (float)(Math.Sqrt(Math.Pow(kSensor.x - jSensor.x, 2) + Math.Pow(kSensor.y - jSensor.y, 2)));

                //get the associated slot for this anchor
                foreach (networkdll.Class1.Slot Slot in kSensor.Slot)
                    sensor_slot = Slot.slot;

                if (ssRadius <= sensorRadius && counter1.Milliseconds == sensor_slot)
                {
                    jSensor.sConnection.Add(new networkdll.Class1.WirelessSensorConnection(kSensor, jSensor));       //sensor-sensor connection 

                    //2-hop anchor connection via 1-hop sensor
                    for (int a = 0; a < alocator.Count; a++)
                    {
                        networkdll.Class1.Locator kLocator = (networkdll.Class1.Locator)amlocator[a];
                        float lsRadius = (float)(Math.Sqrt(Math.Pow(kSensor.x - kLocator.x, 2) + Math.Pow(kSensor.y - kLocator.y, 2)));//2-hop anchor-sensor"neighbor" distance
                        float slRadius = (float)(Math.Sqrt(Math.Pow(kLocator.x - jSensor.x, 2) + Math.Pow(kLocator.y - jSensor.y, 2)));//2-hop anchor-sensor distance

                        //get the associated slot for this anchor
                        foreach (networkdll.Class1.Slot Slot in kLocator.Slot)
                            anchor_slot = Slot.slot;

                        if (lsRadius <= locatorRadius && lsRadius != 0 && slRadius > locatorRadius && counter1.Milliseconds == anchor_slot)
                        {
                            jSensor.two_hop_Connections.Add(new networkdll.Class1.WirelessSensorConnection(kLocator, jSensor));       //2-hop anchors connection
                        }
                    }
                }
            }
        }

    }
   public static class Elliptic_Curve_Cryptography
    {
        private static Aes DeriveKeyAndIv(ECDiffieHellmanCng privateKey, ECDiffieHellmanPublicKey publicKey)
        {
            privateKey.KeyDerivationFunction = ECDiffieHellmanKeyDerivationFunction.Hash;
            privateKey.HashAlgorithm = CngAlgorithm.Sha256;
            byte[] keyAndIv = privateKey.DeriveKeyMaterial(publicKey);//derive secret key and initialization vector
            byte[] key = new byte[16];
            Array.Copy(keyAndIv, 0, key, 0, 16);
            byte[] iv = new byte[16];
            Array.Copy(keyAndIv, 16, iv, 0, 16);

            Aes aes = new AesManaged();
            aes.Key = key;  //secret (session) key
            aes.IV = iv;    //initialization vector
            aes.Mode = CipherMode.CBC;
            aes.Padding = PaddingMode.PKCS7;

            return aes;
        }

        public static byte[] Encrypt(ECDiffieHellmanCng privateKey, ECDiffieHellmanPublicKey publicKey, byte[] data)
        {
            Aes aes = DeriveKeyAndIv(privateKey, publicKey);
            return aes.CreateEncryptor().TransformFinalBlock(data, 0, data.Length);
        }

        public static byte[] Decrypt(ECDiffieHellmanCng privateKey, ECDiffieHellmanPublicKey publicKey, byte[] encryptedData)
        {
            Aes aes = DeriveKeyAndIv(privateKey, publicKey);
            return aes.CreateDecryptor().TransformFinalBlock(encryptedData, 0, encryptedData.Length);
        }
    }

    public void Encrypt_Send(ArrayList asensor)
    {
        ECDiffieHellmanCng Anchor_key = new ECDiffieHellmanCng();//Anchor private key
        String plain = "";
        String enc = "Encrypted\n";
        foreach (networkdll.Class1.WirelessSensor sensor in asensor)
        {
            ECDiffieHellmanCng Sensor_key = new ECDiffieHellmanCng();//Sensor private key

            foreach (networkdll.Class1.WirelessSensorConnection connection in sensor.Connections)//sensor - 1_hop anchor
            {
                plain = connection.sLocator.id + "," + connection.sLocator.x + ";" + connection.sLocator.y + ".";
                byte[] data = Encoding.UTF8.GetBytes(plain);//plain text
                byte[] encryptedData = Elliptic_Curve_Cryptography.Encrypt(Anchor_key, Sensor_key.PublicKey, data);//ECC cipher text
                String encrypted = Encoding.UTF8.GetString(encryptedData);//encrypted string
                sensor.enc_apkts.Add(new networkdll.Class1.enc_pkt(encryptedData, Anchor_key.PublicKey, Sensor_key));
                enc += encrypted + "\n";
            }
        }
            enc_label.Text = enc;

    }

    public void Receive_Decrypt(ArrayList asensor)
    {
        String dec = "Decrypted\n";
        foreach (networkdll.Class1.WirelessSensor sensor in asensor)
        {

            foreach (networkdll.Class1.enc_pkt packet in sensor.enc_apkts)//sensor - 1-hop anchor
            {
                byte[] decryptedData = Elliptic_Curve_Cryptography.Decrypt(packet.sensor_private_key, packet.anchor_public_key, packet.Encrypted);
                String decrypted = Encoding.UTF8.GetString(decryptedData);
                sensor.apkts.Add(new networkdll.Class1.pkt(int.Parse(decrypted.Substring(0, decrypted.IndexOf(","))), int.Parse(decrypted.Substring(decrypted.IndexOf(",") + 1, decrypted.IndexOf(";") - decrypted.IndexOf(",") - 1)), int.Parse(decrypted.Substring(decrypted.IndexOf(";") + 1, decrypted.IndexOf(".") - decrypted.IndexOf(";") - 1))));
                dec += decrypted.Substring(0, decrypted.IndexOf(",")) + " (" + decrypted.Substring(decrypted.IndexOf(",") + 1, decrypted.IndexOf(";") - decrypted.IndexOf(",") - 1) + "," + decrypted.Substring(decrypted.IndexOf(";") + 1, decrypted.IndexOf(".") - decrypted.IndexOf(";") - 1) + ")\n";
            }
        }

       dec_label.Text = dec;

    }

    public void localize(object sender, PaintEventArgs e, ArrayList asensor, float locatorRadius, String path, int delimiter, double q, double r_x, double r_y, double r_vx, double r_vy, double ax_noise, double ay_noise)
    {

        Font font = new Font("Times New Roman", 7.0f);
        StringFormat format = new StringFormat();
        format.Alignment = StringAlignment.Center;
        Graphics g = e.Graphics;
        g.SmoothingMode = System.Drawing.Drawing2D.SmoothingMode.HighQuality;

        Brush abrush = Brushes.PowderBlue;  //Actual anchor position
        Brush cbrush = Brushes.Purple;  //corrected position
        //Pen p = Pens.Violet;
        // Pen p1 = Pens.Black;
        String time = "";
        long start, end, executiontime;
        start = System.DateTime.Now.Ticks;

        int s = 0, count = 0; //sensor index,count for average error
        int ersum, avger = 0;//error summation
        int comm_cost = 0;//communication cost = no. of packets generated
        float coverage = 0; //no. of localized sensor nodes

        String ext = "", del = "";//file extension and column delimiter type "comma or tab" 
        String result = "";
        String result1 = "";//cumulate all results for all slot 

        if (delimiter == 0)
        {
            del = ","; ext = "xls";
            result = "Node" + del + "EstX" + del + "EstY" + del + "ActualX" + del + "ActualY" + del + "Error" + del + "1hAnchor\n";
        }
        else if (delimiter == 1)
        {
            del = "\t"; ext = "doc";
            result = "Node" + del + "EstX" + del + "EstY" + del + "ActualX" + del + "ActualY" + del + "Error" + del + "1hAnchor\n";
            result += "========================================================================\n";
        }
        float estx = 0, esty = 0;

        if (counter1.Minutes == 0)
            counter = counter1.Seconds;
        else counter = counter1.Seconds + counter1.Minutes * 60;

        if (counter % slot_duration == 0)
        {
            ersum = 0; avger = 0;

            s = 0;
            foreach (networkdll.Class1.WirelessSensor sensor in asensor)
            {
                int ax = 0, ay = 0;
                /* System.Random rs = new System.Random();//so as to change the random value with every slot
                long seed = rs.Next();
                Random r = new Random(seed, true);*/

                Kalman k = new Kalman();
                Random r = new Random();

                //measured velocity
                double mvx = 0;         //sensor.speed * Math.Cos((360 - sensor.direction) * Math.PI / 180.0);
                double mvy = 0;         //sensor.speed * Math.Sin((360 - sensor.direction) * Math.PI / 180.0);
                double velocity = 0, theta = 0;

                if ((counter / slot_duration) >= 2)
                {
                    String loca1 = path + "\\state(" + ((counter / slot_duration) - 2) + ")_Sensor(" + s + ")" + ".xls";
                    String loca2 = path + "\\state(" + ((counter / slot_duration) - 1) + ")_Sensor(" + s + ")" + ".xls";

                    Matrix predc1 = new Matrix(4, 1);
                    Matrix predc2 = new Matrix(4, 1);

                    try
                    {
                        //read previous state m_x
                        using (StreamReader re = new StreamReader(loca1))
                        {

                            for (int row = 0; row < 4; row++)
                            {
                                string line = re.ReadLine();
                                string[] values = line.Split(',');

                                for (int col = 0; col < 1; col++)
                                {
                                    predc1[row, col] = double.Parse(values[col]);
                                }

                            }
                        }
                        using (StreamReader re = new StreamReader(loca2))
                        {

                            for (int row = 0; row < 4; row++)
                            {
                                string line = re.ReadLine();
                                string[] values = line.Split(',');

                                for (int col = 0; col < 1; col++)
                                {
                                    predc2[row, col] = double.Parse(values[col]);
                                }

                            }
                        }
                        double predc1x = predc1[0, 0];
                        double predc1y = predc1[1, 0];
                        double predc2x = predc2[0, 0];
                        double predc2y = predc2[1, 0];

                        //measured direction
                        if (predc1x == predc2x && predc2y > predc1y)
                            theta = 270;
                        else if (predc1x == predc2x && predc2y < predc1y)
                            theta = 90;
                        else if (predc1y == predc2y && predc2x < predc1x)
                            theta = 180;
                        else if (predc1y == predc2y && predc2x > predc1x)
                            theta = 0;
                        else
                            theta = Math.Atan((predc2y - predc1y) / (predc1x - predc2x)) * (180 * 7 / 22);
                        if (theta < 0)
                            theta = -theta;

                        //measured velocity
                        velocity = (double)(Math.Sqrt(((predc2y - predc1y) * (predc2y - predc1y) + (predc1x - predc2x) * (predc1x - predc2x)))) / (double)slot_duration;

                    }
                    catch { velocity = 0; }

                }
                //measured speed in x and y directions (x',y')
                mvx = velocity * Math.Cos((360 - theta) * Math.PI / 180.0);
                mvy = velocity * Math.Sin((360 - theta) * Math.PI / 180.0);

                ////////////////1-hop anchor measurement/////////////////
                foreach (networkdll.Class1.pkt packet1 in sensor.apkts)    //1-hop anchor packet
                {
                    ax += packet1.x;
                    ay += packet1.y;
                }

                /////////////////Slot 0: Reset Kalman Filter////////////////////////////
                if (counter / slot_duration == 0)
                {
                    k.Reset(s, path, q, slot_duration, r_x, r_y, r_vx, r_vy, 0, 0, 0, 0);
                }

                /////////Prediction and Correction Phases/////////////////

                if (sensor.apkts.Count >= 1)
                {

                    Matrix state = k.Update(s, path, (counter / slot_duration), (ax / sensor.apkts.Count) + r.NextGuass_Double(0, ax_noise), (ay / sensor.apkts.Count) + r.NextGuass_Double(0, ay_noise), mvx, mvy, slot_duration);         //*, px_noise, py_noise*/

                    float erx, ery;//error (x,y)
                    estx = (float)state[0, 0];
                    esty = (float)state[1, 0];
                    erx = Math.Abs(estx - sensor.x);
                    ery = Math.Abs(esty - sensor.y);

                    result += s + del + estx + del + esty + del + sensor.x + del + sensor.y + del + (int)Math.Sqrt(erx * erx + ery * ery) + del + sensor.apkts.Count + "\n";
                    ersum += (int)Math.Sqrt(erx * erx + ery * ery);//sum error
                    comm_cost += sensor.apkts.Count;//communication cost
                    count++;

                    g.FillEllipse(abrush, ((float)ax / (float)sensor.apkts.Count) - 5, ((float)ay / (float)sensor.apkts.Count) - 5, 10, 10);
                    g.FillEllipse(cbrush, estx - 5, esty - 5, 10, 10);
                    g.DrawString("(" + ((int)Math.Sqrt(erx * erx + ery * ery) / sensorRadius).ToString() + ")", font, Brushes.Black, estx + 6, esty + 6);

                    //writing actual measurements without noise
                    if (counter / slot_duration == 0)
                        //Creat file to store actual measurements all slots in one file
                        using (FileStream fs = new FileStream(path + "\\Actual_Measurement_Sensor(" + s + ")" + ".xls", FileMode.Create))
                        {
                            using (StreamWriter w = new StreamWriter(fs, Encoding.UTF8))
                            {
                                w.WriteLine("slot_No,AM_X,AM_Y");
                                w.WriteLine(counter / slot_duration + "," + (ax / sensor.apkts.Count) + "," + (ay / sensor.apkts.Count));
                            }
                        }
                    else
                        //Append to file that contains actual measurements
                        using (FileStream fs = new FileStream(path + "\\Actual_Measurement_Sensor(" + s + ")" + ".xls", FileMode.Append))
                        {
                            using (StreamWriter w = new StreamWriter(fs, Encoding.UTF8))
                            {
                                w.WriteLine(counter / slot_duration + "," + (ax / sensor.apkts.Count) + "," + (ay / sensor.apkts.Count));
                            }
                        }

                }

                /////storing actual sensor data
                double avx = sensor.speed * Math.Cos((360 - sensor.direction) * Math.PI / 180.0);
                double avy = sensor.speed * Math.Sin((360 - sensor.direction) * Math.PI / 180.0);

                //storing Actual position and velocity of sensor node
                if ((counter / slot_duration) == 0)
                    //Create file to store actual state of sensor
                    using (FileStream fs = new FileStream(path + "\\Actual_Sensor(" + s + ")" + ".xls", FileMode.Create))
                    {
                        using (StreamWriter w = new StreamWriter(fs, Encoding.UTF8))
                        {
                            w.WriteLine("slot_No,Actual_X,Actual_Y,Actual_X',Actual_Y'");
                            w.WriteLine((counter / slot_duration) + "," + sensor.x + "," + sensor.y + "," + avx + "," + avy);
                        }
                    }
                else
                    //Append to file that contains  actual state of sensor
                    using (FileStream fs = new FileStream(path + "\\Actual_Sensor(" + s + ")" + ".xls", FileMode.Append))
                    {
                        using (StreamWriter w = new StreamWriter(fs, Encoding.UTF8))
                        {
                            w.WriteLine((counter / slot_duration) + "," + sensor.x + "," + sensor.y + "," + avx + "," + avy);
                        }
                    }
                s++;
            }

            end = System.DateTime.Now.Ticks;
            executiontime = end - start;
            time = " " + (double)(executiontime / 10000);

            if (count != 0) { avger = ersum / count; }
            if (s != 0 && count != 0) coverage = (float)((float)count / (float)s) * 100;

            using (FileStream fs = new FileStream(path + "\\Kalman_of_slot" + (counter / slot_duration) + "." + ext, FileMode.Create))
            {
                using (StreamWriter w = new StreamWriter(fs, Encoding.UTF8))
                {
                    w.WriteLine(result + "\n\n" + "\nAverage" + del + "error = " + del + avger + del + "m" + "\nPercent" + del + " error = " + del + (avger / sensorRadius) + del + "R" + "\nCommunication" + del + "cost = " + del + comm_cost + del + "packet\n" + /*"Computation" + del + "cost =" + del + time + del + "ms\n"*/ "Localized" + del + "sensors =" + del + coverage + del + "%");

                    w.Dispose();    //allows reading file while simulator opened
                }
            }
            //write all results for all slots
            if (delimiter == 1)
                result1 += (((counter)) / slot_duration) + del + (avger / sensorRadius) + del + del + del + comm_cost + del + del + /*time*/  del + coverage;
            else
                result1 += (((counter)) / slot_duration) + del + (avger / sensorRadius) + del + comm_cost + del + /*time*/ coverage;

            if (counter == 0)
                using (FileStream fs = new FileStream(path + "\\Kalman_total_results." + ext, FileMode.Create))
                {
                    using (StreamWriter w = new StreamWriter(fs, Encoding.UTF8))
                    {
                        if (delimiter == 1)
                            w.WriteLine("Slot" + del + "Localization" + del + "Communication" + del + /*"Computation"*/  "Localized\nNo." + del + "Error \"R\"" + del + del + "Cost \"packet\"" + del + /*"Cost \"ms\""*/ "Sensors \"%\"\n===================================================================\n" + result1);

                        else
                            w.WriteLine("Slot" + del + "Localization" + del + "Communication" + del + /*"Computation"*/"Localized\nNo." + del + "Error \"R\"" + del + "Cost \"packet\"" + del + /*"Cost \"ms\""*/ "Sensors \"%\"\n" + result1);

                        w.Dispose();    //allows reading file while simulator opened
                    }
                }
            else
                using (FileStream fs = new FileStream(path + "\\Kalman_total_results." + ext, FileMode.Append))
                {
                    using (StreamWriter w = new StreamWriter(fs, Encoding.UTF8))
                    {
                        w.WriteLine(result1);

                        w.Dispose();    //allows reading file while simulator opened
                    }
                }

        }

        // label.Text = output;
        //  label.Refresh();
    }
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T11:53:56.733

您可以只使用*eBATS：* Dan Bernstein 和 Tanja Lange 的非对称系统的 ECRYPT 基准测试（[http://bench.cr.yp.to/ebats.html](http://bench.cr.yp.to/ebats.html) )。它是*eBACS 的一部分：加密系统的 ECRYPT 基准测试*。

“如果您在论文中使用 eBACS 信息，那么您应该引用以下网页：Daniel J. Bernstein 和 Tanja Lange（编辑）。eBACS：加密系统的 ECRYPT 基准测试。 [//bench.cr.yp.to](http://bench.cr.yp.to)， 2013 年 3 月 7 日访问。

将 2013 年 3 月 7 日替换为您的下载日期。”

# ruby-on-rails - ElasticSearch & Tire：使用映射和 to_indexed_json

> ID：11672072
> 
> 赞同：20
> 
> 时间：2012-07-26T14:54:20.213
> 
> 标签：ruby-on-rails, ruby, elasticsearch, tire

在阅读[*轮胎*](http://github.com/karmi/tire)文档时，我的印象是您应该使用`mapping`or`to_indexed_json`方法，因为（我的理解是......）`mapping`用于提供`to_indexed_json`.

问题是，我发现了一些同时使用两者的教程。为什么？

基本上，我的应用程序现在可以使用，`to_indexed_json`但我不知道如何设置某些属性的提升值（因此我开始研究映射的原因），我想知道使用两者是否会产生一些冲突。

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-07-28T10:36:07.437

虽然`mapping`和`to_indexed_json`方法是相关的，但实际上它们服务于两个不同的目的。

该**`mapping`**方法的目的是为索引中的文档属性定义*映射*。您可能希望将某些属性定义为“not_analyzed”，因此它不会分解为*tokens*，或者为属性设置特定的分析器，或者（如您所提到的）索引时间*提升*因子。您还可以定义*多字段*属性、*日期*类型的自定义格式等。

然后使用此*映射*，例如。当*轮胎*自动[为您的模型创建索引](https://github.com/karmi/tire/blob/master/lib/tire/model/indexing.rb#L108)时。

该方法的目的是为您的文档/模型**`to_indexed_json`**定义*JSON 序列化。*

[默认`to_indexed_json`方法](https://github.com/karmi/tire/blob/master/lib/tire/model/search.rb#L159-180)确实使用您的映射定义，仅使用映射中定义的属性——基于如果您足够关心定义*映射*，默认情况下，*Tire*仅索引具有定义映射的属性。

现在，当您想牢牢掌握模型实际上是如何序列化为 JSON 以用于*elasticsearch*时，您只需定义自己的`to_indexed_json`方法（如 README 所示）。

这种自定义`MyModel#to_indexed_method`通常不关心*映射*定义，而是从头开始构建 JSON 序列化（通过利用 ActiveRecord `to_json`，使用 JSON 构建器，例如[jbuilder](https://github.com/rails/jbuilder/)，或者只是构建一个普通的旧*Hash*并调用`Hash#to_json`）。

因此，要回答您问题的最后一部分，同时使用两者`mapping`绝对`to_indexed_json`不会*产生*任何冲突，实际上是在弹性搜索中使用高级功能所必需的。

总结一下：

1.  您使用该`mapping`方法为搜索引擎定义模型的映射
2.  您使用自定义`to_indexed_json`方法来定义搜索引擎如何查看您的文档/模型。

# box2d - 检测“卡住”的身体

> ID：11672076
> 
> 赞同：3
> 
> 时间：2012-07-26T14:54:27.110
> 
> 标签：box2d

我在一个相互碰撞的世界中有几个球。世界各地都有静墙。

有时，它们最终会处于沿同一路径向上/向下或向左/向右移动的位置（垂直于墙壁的运动？）

有什么简单的方法可以检测到这一点，然后在任一方向上对其进行一点旋转？

任何具有 box2d 语言的伪代码或代码将不胜感激。

编辑：图片，应@Andrew 的要求

![在此处输入图像描述](../Images/d69bb5f8753c655b43177b7218930251.png)

如果球继续像这样移动（左/右/左/右......），我想给它一点推力，让它从当前路径移动。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T07:14:27.007

我认为您可以创建您的`b2ContactListener`子类来检测`ball-wall`碰撞（这很简单，并在 中进行了解释`Box2D manual`）。在你让它为每个球存储 3 个速度值之后。

1.  在第一次 `ball-wall`碰撞之前。
2.  第一次 `ball-wall`碰撞后。
3.  第二次`ball-wall`碰撞后。

当您获得这三个速度时（使用`GetLinearVelocity`的函数`b2Body`） - 检查它们是否以一定的精度位于同一条线上（除符号外具有相同的方向）。如果满足此条件 - 应用一点旋转

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-29T07:24:19.693

我以为你可以测量每次碰撞的角度？我现在没有时间发布正确的代码（也许今晚，如果你需要一个例子）但是你可以有某种机制来检查球和墙壁之间任何碰撞的角度。

如果它恰好是 90 度，则标记球（使用用户数据或在某些外部数组中），并开始跟踪墙壁与该球之间连续 90 度碰撞的次数。如果一个接一个地发生两​​次 90 度碰撞，您可以放心地假设球被卡住并轻推它。

# java - GAE/J 注销但没有破坏会话

> ID：11672077
> 
> 赞同：1
> 
> 时间：2012-07-26T14:54:28.730
> 
> 标签：java, google-app-engine

我用的是GAE1.6.3/Java，联合登录，我用的是知名的

```
com.google.appengine.api.users.UserService.createLogoutURL(String destinationURL, String authDomain) 
```

创建创建注销 url。

使用开发服务器，登录后退出，当你再次尝试登录时，它会提示登录面板。现在输入另一个用户的电子邮件，登录后，我将看到与以前的用户相同的数据。调试后我发现这是因为用户注销后会话没有被破坏，所以另一个用户登录系统会将他识别为以前的用户。

将我的应用程序交付给appspot后，当我注销然后尝试登录时，它并没有将我带到登录页面，而是直接进入我的应用程序。我认为正确的行为应该就像 GMail 一样。我认为根本原因与开发服务器相同。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T18:05:31.603

当用户单击注销时，他们将注销 App Engine 应用程序，但不会注销联合提供程序。它在以下文档中明确提到： [https ://developers.google.com/appengine/articles/openid](https://developers.google.com/appengine/articles/openid)

要清除应用程序中的会话，请提供应用程序的注销 url 并使用 session.invalidate() 使会话无效，然后使用 com.google.appengine.api.users.UserService.createLogoutURL(String destinationURL, String authDomain) 重定向

# .net - 如何避免在我们的构建服务器上的 GAC 中安装 .NET 程序集？

> ID：11672085
> 
> 赞同：1
> 
> 时间：2012-07-26T14:54:49.167
> 
> 标签：.net

我们在一些应用程序中使用 Windows Identity Foundation。在开发人员机器上，这会将各种位安装到 GAC 中。

我宁愿不在我们的构建代理上这样做。

一般来说，我如何从 GAC 中提取 .NET 程序集，以便在我们的构建中引用它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T14:56:55.353

确保放置“复制本地”，以避免部署问题。（右键单击引用，属性，复制本地，true）。

希望能帮助到你

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T14:57:29.443

在您的参考文献中，单击每个有问题的 Dll，并将其“复制本地”属性设置为 True。这应该意味着当您构建它们时，它们会被复制到应用程序的 bin 文件夹中。

# javascript - 通过 JavaScript 检索设置

> ID：11672086
> 
> 赞同：0
> 
> 时间：2012-07-26T14:54:50.807
> 
> 标签：javascript, asp.net, c#-4.0, google-analytics

我有一个简单的问题。我的网站使用 Google Analytic，Analytic ID 需要存储在我的 .NET 项目的设置中。如果设置为空，则需要禁用分析。在部署期间，安装程序会要求提供此 ID 并将其放入设置中。
Google Analytic 使用了一些 JavaScript，基本上，这个脚本需要从设置中读取值。不幸的是，JavaScript 在客户端执行，而设置驻留在服务器上。
所以我需要一个简单的技巧来读取服务器上的这个 ID 并将它以某种方式包含在生成的网页中。

如果没有提供 ID，则禁用 Google Analytics 的提示很有用，但我认为这不会太复杂。（只是不要从 Google 加载 ga.js 文件。`<script runat="server" ID="Analytic"`）如果有 ID，我可能会使用类似的东西并设置 URL（src 标记）。但是，如果有人有更好的建议，请继续。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T18:26:33.123

您可以使用以下解决方案：

*   服务器端（例如：从 Settings 静态类获取 AnalyticID）：

    ```
    <script type="text/javascript">
            window.AnalyticID = '<%= Settings.AnalyticID %>';
    </script> 
    ```

*   客户端（例如：在客户端使用 AnalyticID）

    ```
    <script type="text/javascript">
           alert(AnalyticID);
    </script> 
    ```

# solr - hl.fragsize 在我的查询中不受尊重

> ID：11672087
> 
> 赞同：4
> 
> 时间：2012-07-26T14:54:51.887
> 
> 标签：solr, fragment, highlighting

我正在使用 solr 3.5，并在我的搜索查询中设置`hl.fragsize = 100`，但我的片段不包含 100 个字符，实际上，平均片段大小为 120。

任何人都可以对这个问题有所了解吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-13T12:41:00.473

查看 hl.regex.slop 参数。

[http://wiki.apache.org/solr/HighlightingParameters#hl.regex.slop](http://wiki.apache.org/solr/HighlightingParameters#hl.regex.slop)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-13T15:14:37.973

也许只是做一些后处理，比如

```
if (highlight.length() > HIGHLIGHT_MAX_LENGTH) {
    int idx = highlight.toString().indexOf(" ", HIGHLIGHT_MAX_LENGTH);
    String excerpt = StringUtils.left(highlight.toString(), idx);
    if (!excerpt.endsWith(".")) {
            return excerpt + HIGHLIGHT_MORE;
    }
    return excerpt;
} 
```

高亮 var 是一个 StringBuilder。希望这可以帮助。

# jquery - 将数据从视图传递到控制器问题

> ID：11672090
> 
> 赞同：0
> 
> 时间：2012-07-26T14:55:01.257
> 
> 标签：jquery, asp.net-mvc

我有一个定义如下的表格。

```
<% using (Html.BeginForm("PRoll", "Payroll", FormMethod.Post, new { @id = "frmPRoll" })){%>

    <%= Html.TextBoxFor(model => model.keyid, new { @class = "required", Style = "width:190px", @maxlength = "15" })%>
    ....
<% } %> 
```

控制器为

```
public ActionResult Index(int? id)
{
    var bo = new PayrollInfo();
    return View(bo);
}

[HttpPost]
public ActionResult DetailPage(string keyid)
{
    //TempData["prid"] = p_payrollid;
    return RedirectToAction("PayDtl/" + keyid, "Payroll", keyid);
} 
```

我通过jquery提交表单如下

```
function DetailPage() {
    var rol = $('#keyid').val();
    $('#frmPRoll').attr('action', '/Proll/DetailPage/'+rol).submit();
} 
```

控制器 DetailPage 操作方法中的 keyid 值始终为空。它永远不会被视图中的实际数据填充。

如何从控制器的视图中获取 keyid 值？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T15:08:00.750

```
function DetailPage() {
    // TODO: don't hardcode /Proll/DetailPage here: use url helpers
    $('#frmPRoll').attr('action', '/Proll/DetailPage').submit();
} 
```

Since there's already a textbox within this form containing the keyid value, when you submit the form to the `DetailPage` action, this value will be POSTed as the `keyid` action parameter.

Also you are using a wrong overload of the `RedirectToAction` method. It should be like this, assuming of course that your PayDtl expects an argument called `keyid`:

```
[HttpPost]
public ActionResult DetailPage(string keyid)
{
    return RedirectToAction("PayDtl", "Payroll", new { keyid = keyid });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T15:02:04.093

尝试这个

```
function DetailPage() {
    var rol = $('#keyid').val();
    $.ajax({
            type: "POST",
            url: '@Url.Action("DetailPage", "Proll")',
            data: "keyid=" + rol
            success: function (result) {
            ...
    });
}); 
```

# css - css：多个半透明背景？

> ID：11672092
> 
> 赞同：1
> 
> 时间：2012-07-26T14:55:14.573
> 
> 标签：css, background, background-color

我可以制作[半透明背景](https://stackoverflow.com/questions/806000/css-semi-transparent-background-but-not-text)，但有没有办法为一个元素添加多个半透明背景？还是我需要自己乘以这些值（如果我需要自己乘以这些值，您会建议什么公式？）并设置一种背景颜色？

您可以[设置多个背景图像](http://www.css3.info/preview/multiple-backgrounds/)...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T14:58:59.773

您只能为元素设置一种背景颜色。

我建议您组合所需的值并将计算的值放入 css 文件中，但如果这不起作用，另一种选择是创建一组嵌套元素并为每个元素设置背景颜色。例如

```
<div class="background1">
    <div class="background2">
        stuff
    </div>
</div> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T15:59:45.263

## 是的，使用 CSS3

使用 CSS3`gradient`调用来制作“非渐变”纯色将为您提供具有透明度功能的多种背景颜色。这是覆盖 50% 透明度的两种纯色（[**参见小提琴**](http://jsfiddle.net/PgR9K/)）：

```
.layeredBkg {
    background-image: -o-linear-gradient(left , rgba(46,227,255.5) 0%, rgba(46,227,255,.5) 100%), -o-linear-gradient(left , rgba(196,48,255.5) 0%, rgba(196,48,255,.5) 100%);
    background-image: -moz-linear-gradient(left , rgba(46,227,255,.5) 0%, rgba(46,227,255,.5) 100%), -moz-linear-gradient(left , rgba(196,48,255,.5) 0%, rgba(196,48,255,.5) 100%);
    background-image: -webkit-linear-gradient(left , rgba(46,227,255,.5) 0%, rgba(46,227,255,.5) 100%), -webkit-linear-gradient(left , rgba(196,48,255,.5) 0%, rgba(196,48,255,.5) 100%);
    background-image: -webkit-gradient(linear,left top, right top, color-stop(0, rgba(46,227,255,.5)), color-stop(1, rgba(46,227,255,.5))), -webkit-gradient(linear,left top, right top, color-stop(0, rgba(196,48,255,.5)), color-stop(1, rgba(196,48,255,.5)));
    background-image: -ms-linear-gradient(left , rgba(46,227,255,.5) 0%, rgba(46,227,255,.5) 100%), -ms-linear-gradient(left , rgba(196,48,255,.5) 0%, rgba(196,48,255,.5) 100%);
    background-image: linear-gradient(left , rgba(46,227,255,.5) 0%, rgba(46,227,255,.5) 100%), linear-gradient(left , rgba(196,48,255,.5) 0%, rgba(196,48,255,.5) 100%);
    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#882ee3ff', endColorstr='#882ee3ff'), progid:DXImageTransform.Microsoft.gradient(startColorstr='#88c430ff', endColorstr='#88c430ff');
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T15:31:36.117

由于您可以拥有多个背景图像，因此考虑使用纯色图像作为背景并将[alpha 应用于它们](https://stackoverflow.com/questions/4997493/set-opacity-of-background-image-without-affecting-child-elements)。

# java - JProgressBar 上的自定义 Painter

> ID：11672093
> 
> 赞同：4
> 
> 时间：2012-07-26T14:55:17.647
> 
> 标签：java, swing, progress-bar, jprogressbar

我正在尝试通过使用自定义 Painter 对象来更改当前 Swing L&F 中进度条的颜色（我目前正在使用 Nimbus），但是在创建这些进度条时有时会坚持其原始颜色（这种变化似乎随机发生）。

我可能遗漏了一些简单的东西，但我很难过，Painter 对象（它是下面的调用）......

```
import javax.swing.Painter;
import java.awt.*;

public class ProgressPainter implements Painter {

private Color light, dark;
private GradientPaint gradPaint;

public ProgressPainter(Color light, Color dark) {
    this.light = light;
    this.dark = dark;
}

@Override
public void paint(Graphics2D g, Object c, int w, int h) {
    g.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
    gradPaint = new GradientPaint((w / 2.0f), 0, light, (w / 2.0f), (h /2.0f), dark, true);
    g.setPaint(gradPaint);
    g.fillRect(2, 2, (w - 5), (h - 5));

    Color outline = new Color(0, 85, 0);
    g.setColor(outline);
    g.drawRect(2, 2, (w - 5), (h - 5));
    Color trans = new Color(outline.getRed(), outline.getGreen(), outline.getBlue(), 100);
    g.setColor(trans);
    g.drawRect(1, 1, (w - 3), (h - 3)); 
}
} 
```

在应用程序启动时调用...

```
UIManager.put("ProgressBar[Enabled].foregroundPainter", new ProgressPainter(new Color(125, 255, 125), new Color(25, 175, 25)));
UIManager.put("ProgressBar[Enabled+Indeterminate].foregroundPainter", new ProgressPainter(new Color(125, 255, 125), new Color(25, 175, 25))); 
```

然后稍后使用...创建一个简单的 JProgressBar

```
 JProgressBar progBar = new JProgressBar(0, 100);
    progBar.setStringPainted(true);
    progBar.setBounds(20, 10, 260, 30);

    frame.add(progBar);
    frame.setVisible(true); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T19:51:25.467

我自己也有一个类似的程序。

虽然不记得实际的代码。

但我必须获取 UI 属性，覆盖颜色并重新应用它们。

我当时正在使用 netbeans，并且由于设置了 Nimbus UI，因此从属性更改颜色字段并没有影响它。

尝试将ui更改为其他，看看是否允许更改颜色。我将搜索我当时使用的代码。

找到了

```
UIDefaults defaults = UIManager.getLookAndFeelDefaults();
defaults.put("nimbusOrange", new Color(0, 0, 255));
progressBar.putClientProperty("Nimbus.Overrides.InheritDefaults", Boolean.TRUE);
progressBar.putClientProperty("Nimbus.Overrides", defaults); 
```

其中progressBar 是JProgressBar

# python - Xcode：sqlite 数据库中的 UTF-8 字符未显示

> ID：11672097
> 
> 赞同：0
> 
> 时间：2012-07-26T14:55:27.370
> 
> 标签：python, xcode, utf-8, sqlite

我需要在具有 unicode 字符的 UITableViewCell 中显示文本；但是，它似乎只显示包含嵌入其中的 unicode 字符串的实际字符串。（例如：我的 UITableViewCell textLabel 显示 'Cari\u00F1na' 而不是 'Cariña'

我通过使用以下 python 脚本解析 utf-8 文本文件来创建 sqlite3 数据库：

```
import sqlite3;
import csv;

conn = sqlite3.connect('varietals.sqlite3')
#conn.text_factory = str
c = conn.cursor()
c.execute('drop table if exists varietals')
c.execute('create table varietals(id integer primary key autoincrement, name VARCHAR, type VARCHAR)')

data = open("varietals.txt", "rU").readlines()
for row in data:
    vals = row.split(',')
    name = unicode(vals[0])
    t = unicode(vals[1])
    sql = "insert into varietals values(NULL,?,?)"
    c.execute(sql, [name, t])

conn.commit() 
```

在 XCode 中，我使用标准 sqlite3 脚本解析数据库

```
 NSString *query = @"SELECT * FROM varietals ORDER BY type DESC";
sqlite3_stmt *statement;

if(sqlite3_prepare_v2(_database, [query UTF8String], -1, &statement, nil) == SQLITE_OK){

    while(sqlite3_step(statement) == SQLITE_ROW){

      //  int uniqueId = sqlite3_column_int(statement, 0);
        char *nameChars = (char *)sqlite3_column_text(statement, 1);
        char *typeChars = (char *)sqlite3_column_text(statement, 2);

        NSString *name = [NSString stringWithUTF8String:nameChars];
        NSString *type = [NSString stringWithUTF8String:typeChars];

        NSDictionary *varietal = [NSDictionary dictionaryWithObjectsAndKeys:name, @"name", type, @"type", nil];
        [retval addObject:varietal];

    }

    sqlite3_finalize(statement);
} 
```

无论我做什么，我都无法让 textLabel 正确显示 'name' (Cariña)，它只是一直显示 'Cari\u00F1na'; 但是，如果我在 'cellForRowAtIndexPath' 方法中进行硬编码： cell.textLabel.text = @"Cari\u00F1na"; 它确实显示正确。我只是无法让它从数据库文件中工作。

我的 python 脚本中是否缺少某些内容？Sqlite 解析器？

提前致谢！！

# charts - 用 highcharts 搞砸 LineChart

> ID：11672101
> 
> 赞同：0
> 
> 时间：2012-07-26T14:55:36.047
> 
> 标签：charts, highcharts, dotnethighcharts

我正在使用 HighCharts 在我的网站上显示图表。
我想要实现的只是一个带有（可缩放）日期时间 X 轴和 Y 轴数字的折线图。
但结果一团糟：

![在此处输入图像描述](../Images/e756bd6a5c525eb5c83f0075cfdebd0e.png)

我通过 ajax 调用加载数据，创建一个数组并用于`chart.series[0].setData(chartData);`设置图表的数据。下面是一个示例`chartData`：

```
[[1343071800000, 17], [1343158200000, 171], [1343244600000, 291], [1343075400000, 18],
 [1343161800000, 74], [1343248200000, 293], [1343165400000, 183], [1343251800000, 296]] 
```

此外，由于我使用的是 ASP.NET MVC 3，因此我使用 DotNetHighCharts，但生成的用于创建图表的 javascript 如下：

```
chart = new Highcharts.Chart({
chart: { renderTo:'chart_container' },
legend: { align: 'left', borderWidth: 0, floating: true, layout: 'horizontal', verticalAlign: 'top', y: 20 },
plotOptions: { series: { cursor: 'pointer', marker: { lineWidth: 1 }, point: { events: { click: function() { alert(Highcharts.dateFormat('%A, %b %e, %Y', this.x) +': '+ this.y +' visits'); } } } } },
subtitle: { text: 'Source: Google Analytics' },
title: { text: 'Daily visits at www.highcharts.com' },
tooltip: { crosshairs: true, shared: true },
xAxis: { gridLineWidth: 1, labels: { align: 'left', x: 3, y: -3 }, tickInterval: 604800000, tickWidth: 0, type: 'datetime' },
yAxis: [{ labels: { align: 'left', x: 3, y: 16, formatter: function() { return Highcharts.numberFormat(this.value, 0); } }, showFirstLabel: false, title: { text: '' } }, { gridLineWidth: 0, labels: { align: 'right', x: -3, y: 16, formatter: function() { return Highcharts.numberFormat(this.value, 0); } }, linkedTo: 0, opposite: true, showFirstLabel: false, title: { text: '' } }],
series: [{ name: 'All visits' }] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T17:08:40.493

您的数据集不是按时间顺序排列的。因此，图表系统正在尽可能地连接所有点。对于基于时间的系列，最好将您的时间从最早到最晚排序。

# python - Python，读取许多文件并合并结果

> ID：11672108
> 
> 赞同：4
> 
> 时间：2012-07-26T14:56:04.380
> 
> 标签：python, parallel-processing, multiprocessing

我可能会问一个非常基本的问题，但我真的不知道如何在 python 中制作一个简单的并行应用程序。我在一台有 16 个内核的机器上运行我的脚本，我想有效地使用它们。我有 16 个大文件要读取，我希望每个 cpu 读取一个文件，然后合并结果。在这里，我举一个简单的例子来说明我想做的事情：

```
 parameter1_glob=[]
  parameter2_glob[]

  do cpu in arange(0,16):
      parameter1,parameter2=loadtxt('file'+str(cpu)+'.dat',unpack=True)

      parameter1_glob.append(parameter1)
      parameter2_glob.append(parameter2) 
```

我认为该`multiprocessing`模块可能会有所帮助，但我无法理解如何将其应用于我想做的事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T15:30:50.063

我同意 Colin Dunklau 在他的评论中所说的，这个过程会成为读写这些文件的瓶颈，对 CPU 的需求是最小的。即使您有 17 个专用驱动器，您也不会最大限度地使用一个内核。此外，虽然我意识到这与您的实际问题无关，但您可能会遇到这些“巨大”文件的内存限制 - 将 16 个文件作为数组加载到内存中，然后将它们组合到另一个文件中几乎肯定会占用比你有。

查看 shell 脚本这个问题，您可能会发现更好的结果。特别是，[GNU`sort`](https://www.gnu.org/software/coreutils/manual/html_node/sort-invocation.html)使用内存高效的合并排序来非常快速地对一个或多个文件进行排序 - 比除了最精心编写的 Python 或大多数其他语言的应用程序之外的所有应用程序都要快得多。

我建议避免任何形式的多线程工作，这将大大增加复杂性，而收益却很小。确保一次只在内存中保留尽可能少的文件，否则很快就会用完。无论如何，您绝对希望在两个单独的磁盘上运行读取和写入。与同时读取和写入同一个磁盘相关的减速是非常痛苦的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T15:55:21.870

你想逐行合并吗？有时协程对于 I/O 绑定的应用程序比经典的多任务处理更有趣。您可以为各种路由、合并和广播链接生成器和协程。[David Beazley 的精彩演讲](http://www.dabeaz.com/coroutines/Coroutines.pdf)让您大开眼界。

您可以使用协程作为接收器（未经测试，请参阅 dabeaz 示例）：

```
# A sink that just prints the lines
@coroutine
def printer():
    while True:
        line = (yield)
        print line,

sources = [
    open('file1'),
    open('file2'),
    open('file3'),
    open('file4'),
    open('file5'),
    open('file6'),
    open('file7'),
]

output = printer()
while sources:
    for source in sources:
        line = source.next()
        if not line: # EOF
            sources.remove(source)
            source.close()
            continue
        output.send(line) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T15:11:55.300

假设每个文件的结果都很小，你可以用我的包[jug](http://luispedro.org/software/jug "水壶主页")做到这一点：

```
from jug import TaskGenerator
loadtxt = TaskGenerator(loadtxt)

parameter1_glob=[]
parameter2_glob[]

@TaskGenerator
def write_parameter(oname, ps):
    with open(oname, 'w') as output:
        for p in ps:
            print >>output, p

parameter1_glob = []
parameter2_glob = []

for cpu in arange(0,16):
    ps = loadtxt('file'+str(cpu)+'.dat',unpack=True)
    parameter1_glob.append(ps[0])
    parameter2_glob.append(ps[1])

write_parameter('output1.txt', parameter1_glob)
write_parameter('output2.txt', parameter2_glob) 
```

现在，您可以执行多个`jug execute`作业。

# javascript - 更新剔除视图模型属性时触发更改事件

> ID：11672111
> 
> 赞同：11
> 
> 时间：2012-07-26T14:56:09.663
> 
> 标签：javascript, knockout.js

这是一个 jsfiddle 来显示问题所在：

[http://jsfiddle.net/boblauer/BgvV4/](http://jsfiddle.net/boblauer/BgvV4/)

我试图在更新文本字段后触发更改事件。不幸的是，在 subscribe 方法中，文本框的值还没有更新，所以当我计算出 change 事件时，它被触发得太快了。

我需要触发更改事件，因为我有不受我控制的依赖于更改事件的第 3 方代码。

有什么建议么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-26T18:21:24.097

一个简单的解决方案是将您对 $("#text1").change() 的调用包装在一个超时为 0 的 setTimeout 中。这足以让敲除在 jquery 更改处理程序获取之前对文本框值进行（同步）更新调用。

我叉了你的小提琴来演示：http: [//jsfiddle.net/SuRYa/1//](http://jsfiddle.net/SuRYa/1/)

如果这是您需要做的很多事情，更好的解决方案可能是将此行为包装在自定义绑定中，其中绑定的“更新”回调将触发更新元素上的 jquery 更改事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-21T16:56:24.710

bmode 是对的，自定义绑定就可以了。虽然这个答案有点晚了，但这里是绑定，以防它帮助任何人随后阅读这篇文章。它使用 jQuery 更新文本框的值——现在更新了 DOM 以使 Bob 的第 3 方代码能够工作——因此它触发了 change 事件。

```
ko.bindingHandlers.valueAndFireChange = {
    update: function(element, valueAccessor) {
        var val = ko.unwrap(valueAccessor());
        if (val == undefined) return;
        $(element).val(val);
        $(element).change();
    }
}; 
```

这是鲍勃小提琴的更新版本，显示了这一点：

[http://jsfiddle.net/BgvV4/17/](http://jsfiddle.net/BgvV4/17/)

我将警报更改为 console.log，因此您需要打开控制台才能看到有用的信息。

# gmail - 使用 Google Apps 脚本在 GMail 中打开电子邮件

> ID：11672113
> 
> 赞同：3
> 
> 时间：2012-07-26T14:56:10.337
> 
> 标签：gmail, google-apps-script

有没有办法从脚本中打开填充了一些数据（主题、正文的一部分、收件人）的 GMail 邮件编辑器？由 GMail UI 中的按钮或菜单项激活的脚本。

我需要这个：

*   自动化一些手动任务
*   并模仿电子邮件模板

我不想从脚本发送电子邮件，我希望用户在发送前完成并查看电子邮件。

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T14:13:43.710

如果用户必须单击链接，会好吗？

[http://www.askdavetaylor.com/can_i_have_a_mailto_link_specify_a_subject_and_body.html](http://www.askdavetaylor.com/can_i_have_a_mailto_link_specify_a_subject_and_body.html)

这对我有用，但我有 Gmail 处理 mailto: 链接。

另一种实现是向用户显示一个显示电子邮件预览的 UI，请求确认，然后在确认后代表用户发送电子邮件。这种方法的缺点是，如果用户需要在发送之前编辑电子邮件，您将需要提供具有编辑功能的 UI。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T18:32:43.147

另一种方法是使用用户可以在 UI 中找到、编辑和发送的 Apps 脚本创建电子邮件草稿。

# java - 运行sitemesh 是否需要.tld？

> ID：11672116
> 
> 赞同：1
> 
> 时间：2012-07-26T14:56:23.150
> 
> 标签：java, spring, taglib, sitemesh

我正在运行用 sitemesh 装饰的简单 JSP 页面（在 Spring 3.1 Web 应用程序中），但在我的项目中没有明确地包括`sitemesh-decorator.tld`和明确地包含在内。`sitemesh-page.tld`有用。

然而，我看到示例项目明确地将这些文件包含在一个`\WEB-INF\tld`文件夹中。这是必要的吗？如果是的话是为了什么？

例如，一个项目`taglibs.jsp`在所有页面中都导入了一个通用页面。这包括：

```
...
<%@ taglib uri="http://www.opensymphony.com/sitemesh/decorator" prefix="decorator" %>
... 
```

**对于记录**

插入没有意义：

```
<%@ taglib uri="http://www.opensymphony.com/sitemesh/decorator" prefix="decorator" %> 
```

在要由 sitemesh 处理的 JSP 页面中。此包含应仅出现在装饰器页面中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T15:09:57.453

无需将这些 .tld(s) 包含在您的应用程序 \WEB-INF\tld 中。它们可以直接从 sitemesh.jar/META-INF 目录加载。

# sql - 打印出光标值

> ID：11672123
> 
> 赞同：1
> 
> 时间：2012-07-26T14:56:35.693
> 
> 标签：sql, sql-server, sql-server-2008

我正在修改一个使用游标的存储过程，我希望能够打印或输出插入到表中的游标中的值，但很难弄清楚如何做到这一点。例如，我需要检查通过此存储过程插入到订单表中的所有值。

我做不到

```
Print @prodId, @orderQuantity, @orderDate, @orderLocationId, @shipmentId,  @shipmentDate 
```

我如何输出/打印游标在这些列中为它经过的每条记录的所有值？一个如何在代码中执行此操作的示例将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:03:37.553

如果使用 MS SQL Server，那么您可以使用 RAISERROR。[在此链接](http://www.jimmcleod.net/blog/index.php/2010/07/19/print-vs-raiserror/)上，ypu 对如何使用它们以及它们之间的差异进行了很好的解释。在这里查看 RAISERROR [sintaxis](http://msdn.microsoft.com/es-es/library/ms178592%28v=sql.105%29.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T15:35:19.110

尝试

```
 PRINT STR(@prodId) + STR(@orderQuantity) + STR(@orderDate) + STR(@orderLocationId) + STR(@shipmentId) + STR(@shipmentDate) 
```

如果那不起作用，那么（对于非 int 变量）尝试

```
 CAST(@orderDate as NVARCHAR(MAX)) 
```

也看看这篇文章。 [http://msdn.microsoft.com/en-us/library/ms187928.aspx](http://msdn.microsoft.com/en-us/library/ms187928.aspx)

祝你好运

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T15:24:21.570

您可以通过将插入的行输出到具有标识的临时表中来以正确的顺序捕获和存储插入的行；

```
create table #inserted(insertorder int identity(0,1), prodId int, orderQuantity int ... <matches inserted row>)

--cursor loop
    insert destination_table(prodId, orderQuantity, ...)
       output inserted.* into #inserted   /*output inserted.* will just select it */
    values @prodId, @orderQuantity ...
--end loop

--inserted rows;
select * from #inserted order by insertorder 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-01-01T08:48:31.163

使用 PRINT 时，一个简单的技巧，而不是 STR() 不存在，或者`CONVERT(varchar(50), @orderQuantity)` 很麻烦，只`RTRIM(@orderQuantlty)`用于从数字到字符串的快速隐式转换。

# java - JAXB 从 XML 字符串到 Java 对象，出了什么问题？

> ID：11672126
> 
> 赞同：1
> 
> 时间：2012-07-26T14:56:43.737
> 
> 标签：java, xml, jaxb

我想从 XML 创建一些对象，但是当我尝试时出现此错误：

```
[26/07/12 16:20:03:763 CEST] ERROR sitemap.SitemapXMLServlet:
javax.xml.bind.UnmarshalException: unexpected element (uri:"http://www.sitemaps.org/schemas/sitemap/0.9", local:"urlset"). Expected elements are <{}url>
javax.xml.bind.UnmarshalException: unexpected element (uri:"http://www.sitemaps.org/schemas/sitemap/0.9", local:"urlset"). Expected elements are <{}url> 
```

我找不到问题，也不明白为什么会出错。这是我尝试过的：

XML 文件

```
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
    <url>
        <loc>http://LINK/shop/hoofdcategorie</loc>
        <lastmod>2012-07-26</lastmod>
        <changefreq>daily</changefreq>
        <priority>0.5</priority>
    </url>
    <url>
        <loc>
            http://LINK/shop/hoofdcategorie/subcategorie
        </loc>
        <lastmod>2012-07-26</lastmod>
        <changefreq>daily</changefreq>
        <priority>0.5</priority>
    </url>
</urlset> 
```

将 XML 解组为对象的方法

```
public void getXML() {
    final JAXBContext context = JAXBContext.newInstance(SitemapXML.class);
    final Unmarshaller unmarshaller = context.createUnmarshaller();
    String xml = URLReader.readUrlHttpClient("http://LINK/shop/sitemap.xml");
    final UrlSet urlSet = (UrlSet) unmarshaller.unmarshal(new StreamSource(new StringReader(xml)));
} 
```

UrlSet 类

```
@XmlRootElement(name = "urlset")
public class UrlSet {

    @XmlAttribute
    String xmlns;
    @XmlElement(name = "url")
    ArrayList<SitemapXML> sitemaps;

    public ArrayList<SitemapXML> getSitemaps() {
        return sitemaps;
    }

    public void setSitemaps(ArrayList<SitemapXML> sitemaps) {
        this.sitemaps = sitemaps;
    }

    @XmlAttribute
    public String getXmlns() {
        return xmlns;
    }

    public void setXmlns(String xmlns) {
        this.xmlns = xmlns;
    }
} 
```

我映射到 url 的 SitemapXML 类

```
@XmlRootElement(name = "url")
public class SitemapXML {

    String loc;
    Date lastmod;
    String changefreq;
    Double priority;

    public String getLoc() {
        return loc;
    }
    public void setLoc(String loc) {
        this.loc = loc;
    }
    public Date getLastmod() {
        return lastmod;
    }
    public void setLastmod(Date lastmod) {
        this.lastmod = lastmod;
    }
    public String getChangefreq() {
        return changefreq;
    }
    public void setChangefreq(String changefreq) {
        this.changefreq = changefreq;
    }
    public Double getPriority() {
        return priority;
    }
    public void setPriority(Double priority) {
        this.priority = priority;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:04:17.677

您的 xml 使用名称空间，但您的注释未提及名称空间。您可以在 XmlRootElement 注释中指定命名空间或在包级别添加 XmlSchema 注释。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T15:07:46.537

您应该添加一个`package-info`带有`@XmlSchema`注释的类来指定命名空间限定。

**包信息**

下面是一个`package-info`带有必要`@XmlSchema`注释的示例类。您将需要更改包以匹配您的域对象。

```
@XmlSchema(
    namespace = "http://www.sitemaps.org/schemas/sitemap/0.9",
    elementFormDefault = XmlNsForm.QUALIFIED)
package com.example.foo;

import javax.xml.bind.annotation.XmlNsForm;
import javax.xml.bind.annotation.XmlSchema; 
```

**了解更多信息**

*   [http://blog.bdoughan.com/2010/08/jaxb-namespaces.html](http://blog.bdoughan.com/2010/08/jaxb-namespaces.html)

# java - 如何使用正则表达式操作字符串？

> ID：11672127
> 
> 赞同：0
> 
> 时间：2012-07-26T14:56:45.027
> 
> 标签：java, regex, string

我对java相当陌生，我正在尝试获取字符串的一部分：

假设我有一个 URL，我想要它的特定部分，例如文件名：

```
String url = "http://example.com/filename02563.zip"; 
```

02563 每次都会随机生成，现在总是 5 个字符长。我想让java找到“m/”（来自.com/）到行尾之间的内容以单独获取文件名。

现在考虑这个例子：

假设我有一个 html 文件，我想从中提取一个片段。下面将是提取的示例：

```
<applet name=someApplet id=game width="100%" height="100%" archive=someJarFile0456799.jar  code=classInsideAJarFile.class mayscript> 
```

我想提取 jar 文件名，所以我想获取“ve=”和“.jar”之间的文本。扩展名将始终为“.jar”，因此包含它并不重要。

我该怎么做？如果可能的话，您能否评论代码以便我了解发生了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T14:58:19.587

使用可以访问各个元素的 Java[`URI`类。](http://docs.oracle.com/javase/7/docs/api/java/net/URI.html)

```
URI uri = new URI("http://example.com/filename02563.zip");
String filename = uri.getPath(); 
```

当然，如果资源不再位于根路径中，这将需要更多的工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T14:58:57.100

您可以使用 String 类中的`lastIndexOf()`和`substring()`方法来提取字符串的特定部分：

```
String url      = "http://example.com/filename02563.zip";
String filename = url.substring(url.lastIndexOf("/") + 1); //+1 skips ahead of the '/' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T15:08:09.497

You have answers for your first question so this is for second one. Normally I would use some XML parser but your example is not valid XML file so this will be solved with regex (as you wanted).

```
String url = "<applet name=someApplet id=game width=\"100%\" height=\"100%\" archive=someJarFile0456799.jar  code=classInsideAJarFile.class mayscript>";

Pattern pattern= Pattern.compile("(?<=archive=).*?(?= )");
Matcher m=pattern.matcher(url);
if(m.find())
    System.out.println(m.group()); 
```

output:

```
someJarFile0456799.jar 
```

# c# - 使用反射在 C# 中查找字段的指针

> ID：11672131
> 
> 赞同：7
> 
> 时间：2012-07-26T14:56:56.623
> 
> 标签：c#, memory, reflection, jit

此问题仅用于教育目的。
我知道本机程序是如何工作的。编译器获取每个原语并给它一个地址，然后在程序中使用该地址。对于结构，它只是将地址堆叠在一起（带有一些填充） - 但基本上，结构并不真正“存在”。

本机程序不会告诉我它有哪些字段和变量。它只访问不同的地址——如果我查看程序集，我可以根据需要命名每个地址，但程序不会给我这些信息。所以假设我正在寻找一个特定的变量，如果不检查程序的执行，或者它的程序集，我就无法做到这一点。

.NET 环境确实告诉我它有哪些变量以及它有哪些字段。`Assembly``Reflection`命名空间，我可以加载一个文件并查看它有哪些字段和类。
然后，使用搜索内存的程序（无论是否是本机），我可以找到该字段的物理位置（通过使用它的值，过滤掉等） - 就像这样`Cheat Engine`做。它将为我提供内存中字段的实际地址，该地址由`JIT`.
我知道 MSIL 不包含有关特定字段所需位置的信息。我也几乎可以肯定，`JIT`永远不会通过删除任何类来优化代码。

我知道 .NET 调试器是程序中的一个实际类，它允许`Visual Studio`与应用程序的内部信息进行交互。当调试器丢失时，`Visual Studio`无法读取或写入字段，也无法以任何方式检查应用程序。

有没有什么方法可以在不使用`Cheat Engine`或类似工具的情况下找到**正在运行的.NET 进程**中静态（或特定实例）类中**字段的物理位置**？**每次执行后地址是否相同**（例如在本机程序中）？它可能仅在不同的平台或机器上有所不同吗？如何决定放置字段的位置？****`JIT`**** 

 ****如果我不清楚，我希望在不访问程序代码的情况下执行此操作，即在外部由另一个进程（如调试器，但对于在发行版下编译的程序）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T22:09:39.743

接下来代码在 Paint.net 中注入 Injector 方法并获取 MainForm 字段。

## NInject.exe

```
public static int Injector(string parameter)
{
  try
  {
    var mainForm = Application.OpenForms.OfType<Form>().FirstOrDefault(form => form.GetType().FullName.EndsWith("MainForm"));

    var builder = new StringBuilder();
    builder.AppendFormat("process: {0}\r\n\r\n", Application.ExecutablePath);
    builder.AppendFormat("type: {0}\r\n", mainForm.GetType().FullName);
    foreach (var field in mainForm.GetType().GetFields(BindingFlags.Instance | BindingFlags.Public | BindingFlags.NonPublic))
    {
      builder.AppendFormat("field {0}: {1}\r\n", field.Name, field.GetValue(mainForm));
    }

    new Form()
    {
      Controls = 
      {
        new TextBox
        {
          Text = builder.ToString(),
          Multiline = true,
          Dock = DockStyle.Fill
        }
      }
    }
    .ShowDialog();
  }
  catch (Exception exc)
  {
    MessageBox.Show(exc.ToString());
  }
  return 0;      
}

static void Main(string[] args)
{
  var process = System.Diagnostics.Process.GetProcessesByName("PaintDotNet").FirstOrDefault();

  var processHandle = OpenProcess(ProcessAccessFlags.All, false, process.Id);

  var proxyPath = System.IO.Path.Combine(System.Windows.Forms.Application.StartupPath, "NInjector.dll");

  var pathBytes = System.Text.Encoding.ASCII.GetBytes(proxyPath);

  var remoteBuffer = VirtualAllocEx(processHandle, IntPtr.Zero, (uint)pathBytes.Length, AllocationType.Commit, MemoryProtection.ReadWrite);
  WriteProcessMemory(process.Handle, remoteBuffer, pathBytes, (uint)pathBytes.Length, IntPtr.Zero);

  var remoteThread = CreateRemoteThread(processHandle, IntPtr.Zero, 0, GetProcAddress(GetModuleHandle("kernel32"), "LoadLibraryA") , remoteBuffer, 0, IntPtr.Zero);

  WaitForSingleObject(remoteThread, unchecked((uint)-1)); 

  CloseHandle(remoteThread);

} 
```

## NInjector.dll（本机）

```
#include "MSCorEE.h"
#pragma comment  (lib, "MSCorEE")

void StartTheDotNetRuntime()
{
    MessageBox(0, L"Started", L"proxy", 0);

    ICLRRuntimeHost *pClrHost = NULL;
    HRESULT hr = CorBindToRuntimeEx(
        NULL, L"wks", 0, CLSID_CLRRuntimeHost,
        IID_ICLRRuntimeHost, (PVOID*)&pClrHost);

    hr = pClrHost->Start();

    DWORD dwRet = 0;
    hr = pClrHost->ExecuteInDefaultAppDomain(
        L"bla-bla\\NInject.exe",
        L"NInject.NInject_Program", L"Injector", L"MyParameter", &dwRet);

    hr = pClrHost->Stop();

    pClrHost->Release();
}

BOOL APIENTRY DllMain( HMODULE hModule,
                       DWORD  ul_reason_for_call,
                       LPVOID lpReserved
                     )
{
    switch (ul_reason_for_call)
    {
    case DLL_PROCESS_ATTACH:
    StartTheDotNetRuntime();
    break;
    case DLL_THREAD_ATTACH:
    break;
    case DLL_THREAD_DETACH:
    case DLL_PROCESS_DETACH:

        break;
    }
    return TRUE;
} 
```

## 输出：

```
process: C:\Program Files\Paint.NET\PaintDotNet.exe

type: PaintDotNet.Dialogs.MainForm
field appWorkspace: PaintDotNet.Controls.AppWorkspace
field defaultButton: System.Windows.Forms.Button, Text: 
field floaters: PaintDotNet.Dialogs.FloatingToolForm[]
field floaterOpacityTimer:  [System.Windows.Forms.Timer], Interval: 25
field deferredInitializationTimer: 
field components: System.ComponentModel.Container
field killAfterInit: False
field singleInstanceManager: PaintDotNet.SystemLayer.SingleInstanceManager
field queuedInstanceMessages: System.Collections.Generic.List`1[System.String]
field processingOpen: False
field scrollPosition: {X=0,Y=0} 
```****

# jquery - Jquery动态获取和设置滑动元素文本

> ID：11672139
> 
> 赞同：0
> 
> 时间：2012-07-26T14:57:16.840
> 
> 标签：jquery

我有一个带有列表项的 ul 列表。现在，第一个列表项滑过由 jquery 滑动图像函数定义的其他列表项。查看我的标记

**HTML**：

```
<ul class="ei-slider-thumbs">
    <li class="ei-slider-element"></li>
    <li><a href="#">Vertical Sunbed</a><img src="images/thumbs/sunbedSmall.jpg" alt="Vertical Sunbed Tan Can" /></li>
    <li><a href="#">Koebana Spray Tan</a><img src="images/thumbs/koebanaSmall.jpg" alt="Koebana Spray Tan" /></li>
    <li><a href="#">Ozone Sauna</a><img src="images/thumbs/ozoneSmall.jpg" alt="Ozone Sauna" /></li>
    <li><a href="#">Glycopeels</a><img src="images/thumbs/3.jpg" alt="thumb03" /></li>
    <li><a href="#">Specialized Facials</a><img src="images/thumbs/4.jpg" alt="thumb04" /></li>
    <li><a href="#">Make Up</a><img src="images/thumbs/5.jpg" alt="thumb05" /></li>
    <li><a href="#">Slide 7</a><img src="images/thumbs/7.jpg" alt="thumb07" /></li>
</ul> 
```

现在带有 class="ei-slider-element" 的列表项滑过其他列表元素。我基本上想将移动元素中的文本设置为移动元素所在的静态列表项中的文本......我该怎么做？[示例](http://lamininbeauty.co.za/index2.html)下面 是控制移动动画的部分：

**JS**：

```
// thumbs wrapper
this.$sliderthumbs = this.$el.find('ul.ei-slider-thumbs').hide();
// slider elements
this.$sliderElems = this.$sliderthumbs.children('li');
// sliding div
this.$sliderElem = this.$sliderthumbs.children('li.ei-slider-element');
// thumbs
this.$thumbs = this.$sliderElems.not('.ei-slider-element');
// initialize slideshow
this._init(options);​ 
```

谢谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T21:54:07.667

尝试这样的事情：在[http://lamininbeauty.co.za/js/jquery.eislideshow.js](http://lamininbeauty.co.za/js/jquery.eislideshow.js)的第 326 行我认为你应该添加一个看起来像这样的 [完整] 处理程序

```
// "sliding div" moves to new position
this.$sliderElem.stop().animate({
    left : this.$thumbs.eq( pos ).position().left
}, this.options.speed, this.$sliderElem.html($currentSlide.text() )) 
```

然后，一旦您的滑块完成动画，它就会抓取`currentSlide`文本并将其设置为`sliderElem`innerHTML。我无法测试它，但你明白我的意图吗？

# php - PHP排序多维数组

> ID：11672140
> 
> 赞同：0
> 
> 时间：2012-07-26T14:57:21.807
> 
> 标签：php, arrays, sorting, multidimensional-array

我如何先按会员 ID 排序，然后按付款日期？

```
Array
(
    [240] => Array
        (
            [Member] => Array
                (
                    [id] => 112
                )

            [Payment] => Array
                (
                    [date] => 0712

)
    ) 
```

我尝试了多重排序，但我从来没有找到一种可行的方法，而且我发现的所有示例都没有我的额外级别。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T15:02:14.373

日期值是字符串还是整数？

无论如何，假设该日期是一个整数，你可以试试这个：

```
function my_sort($val1, $val2) {
    $compare_id = $val1['Member']['id'] - $val2['Member']['id'];
    if($compare_id == 0) {
        return $val1['Payment']['date'] - $val2['Payment']['date'];
    }
    else return $compare_id;
} 
```

然后调用：

```
usort($array, 'my_sort'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T15:01:10.747

如果数据是从数据库接收的，您可以使用`... ORDER BY member,date`

# javascript - 无法让我的“hello world”YUI asyncRequest javascript 运行，并且由于某种原因我无法使用调试器（chrome 或 fb）跟踪执行

> ID：11672143
> 
> 赞同：1
> 
> 时间：2012-07-26T14:57:26.667
> 
> 标签：javascript, yui

```
(function() {
function alertJSON(json) {
    alert("json:" + json);
}
function treeInit() {
    buildJSONTree(alertJSON);
}
function buildJSONTree(callback) {
    var handleSuccess = function(o) {
        var json = YAHOO.lang.JSON.parse(o.responseText);
        callback(json);
    };
    var handleFailure = function(o) {
        alert("FAILURE");
    };
    var asyncCallback = {
        success : handleSuccess,
        failure : handleFailure,
        timeout : 5000
    };
    var send = function(o) {
        var sUrl = "http://127.0.0.1:8080/TestMVC/resources/json/category-subject.json";
        YAHOO.util.Connect.asyncRequest('GET', sUrl, asyncCallback);
    }();
}
YAHOO.util.Event.onDOMReady(treeInit);
})(); 
```

然后在我的 html 文件中包含该脚本并执行。我可以在调试器中跟踪它，直到它执行`asyncRequest`，它只是返回并且我的处理程序都不执行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T14:52:53.903

我做了一个小提琴，对我来说它正在工作。如果资源可用，则调用成功回调。

[http://jsfiddle.net/uZfX5/](http://jsfiddle.net/uZfX5/)

在小提琴中，服务器不返回 json，因此 json 解析器崩溃，但我认为这不是重点。

# sencha-touch - Sencha Formfields 传递空字段

> ID：11672146
> 
> 赞同：0
> 
> 时间：2012-07-26T14:57:33.217
> 
> 标签：sencha-touch, extjs, sencha-touch-2

我正在学习煎茶触摸。我之前用表单创建了这个应用程序，它运行良好。

现在我正在开发一个新的小测试应用程序，我从另一个应用程序复制代码，它只将空变量传递给 web 服务。

风景：

```
<!-- language: lang-js -->
    Ext.define('Gasoline.view.InsertTankTrip', {
requires: [
    'Ext.form.FieldSet'
],

extend: 'Ext.form.Panel',
xtype: 'inserttankpanel',
id: 'insertTankForm',

config: {
    title: 'Insert Tank Trip',
    iconCls: 'add',
    url: 'contact.php',
    items:[
        {
            xtype: 'fieldset',
            title: 'Insert Tank Trip',
            instructions: '(Make sure the info is correct!)',

            items:[
                {
                    xtype: 'datepickerfield',
                    label: 'Date',
                    name: 'date',
                    value: new Date()
                },
                {
                    xtype: 'textfield',
                    label: 'Amount',
                    name: 'amount',
                    minValue:-9007199254740992,
                    maxValue: 9007199254740992
                }
            ]
        },{
            xtype: 'button',
            text: 'Send',
            ui: 'confirm',
            action: 'insertTankSubmit'

        }
    ]
}
}); 
```

在控制器中：

```
launch: function() {
    // Destroy the #appLoadingIndicator element
    Ext.fly('appLoadingIndicator').destroy();

    // Initialize the main view
    Ext.Viewport.add(Ext.create('Gasoline.view.Main'));

    this.control({
        'button[action=insertTankSubmit]' : {
            tap: 'insertTankForm'
        }/*,
        'list[itemId=kingsLeagueList]' : {
            itemtap: 'onListTap'
        },
        'list[itemId=tournamentsList]' : {
            disclose: 'showDetail'
        }*/

    });
},

insertTankForm : function(){
console.log('test');
    var form = this.getInsertTankForm();

    form.submit({
        url:'contact.php'
    });
}, 
```

这会将以下内容发送到网络服务（目前不存在，我只是用开发人员工具检查）

日期：2012-07-26T17:02:16 金额：

所以日期确实被发送了，数字没有

如果我为发送的数字填写标准值......但如果你输入一些东西，它仍然不会发送那个

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T17:04:57.433

利用

```
xtype: 'numberfield' 
```

代替

```
xtype: 'textfield' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T12:15:16.200

我尝试了许多解决方案......它们都没有奏效。

最后，我删除了所有内容...以完全相同的方式对所有内容进行编码，然后它开始工作...

# c# - 用相同的值填充多维数组 C#

> ID：11672149
> 
> 赞同：7
> 
> 时间：2012-07-26T14:57:41.190
> 
> 标签：c#, multidimensional-array, fill

有没有更快的方法使用 C# 来做到这一点？

```
double[,] myArray = new double[length1, length2];

for(int i=0;i<length1;i++)
    for(int j=0;j<length2;j++)
        myArray[i,j] = double.PositiveInfinity; 
```

我记得使用 C++，有一些事情`memset()`需要做这些事情......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2019-11-29T17:31:25.220

多维数组只是一大块内存，所以我们可以把它当做一个，类似于它的`memset()`工作原理。这需要不安全的代码。*除非它真的*对性能至关重要，否则我不会说它值得做。不过，这是一个有趣的练习，所以这里有一些使用 BenchmarkDotNet 的基准：

```
 public class ArrayFillBenchmark
    {
        const int length1 = 1000;
        const int length2 = 1000;
        readonly double[,] _myArray = new double[length1, length2];

        [Benchmark]
        public void MultidimensionalArrayLoop()
        {
            for (int i = 0; i < length1; i++)
            for (int j = 0; j < length2; j++)
                _myArray[i, j] = double.PositiveInfinity;
        }

        [Benchmark]
        public unsafe void MultidimensionalArrayNaiveUnsafeLoop()
        {
            fixed (double* a = &_myArray[0, 0])
            {
                double* b = a;

                for (int i = 0; i < length1; i++)
                for (int j = 0; j < length2; j++)
                    *b++ = double.PositiveInfinity;
            }
        }

        [Benchmark]
        public unsafe void MultidimensionalSpanFill()
        {
            fixed (double* a = &_myArray[0, 0])
            {
                double* b = a;
                var span = new Span<double>(b, length1 * length2);
                span.Fill(double.PositiveInfinity);
            }
        }

        [Benchmark]
        public unsafe void MultidimensionalSseFill()
        {
            var vectorPositiveInfinity = Vector128.Create(double.PositiveInfinity);

            fixed (double* a = &_myArray[0, 0])
            {
                double* b = a;

                ulong i = 0;
                int size = Vector128<double>.Count;

                ulong length = length1 * length2;
                for (; i < (length & ~(ulong)15); i += 16)
                {
                    Sse2.Store(b+size*0, vectorPositiveInfinity);
                    Sse2.Store(b+size*1, vectorPositiveInfinity);
                    Sse2.Store(b+size*2, vectorPositiveInfinity);
                    Sse2.Store(b+size*3, vectorPositiveInfinity);
                    Sse2.Store(b+size*4, vectorPositiveInfinity);
                    Sse2.Store(b+size*5, vectorPositiveInfinity);
                    Sse2.Store(b+size*6, vectorPositiveInfinity);
                    Sse2.Store(b+size*7, vectorPositiveInfinity);
                    b += size*8;
                }
                for (; i < (length & ~(ulong)7); i += 8)
                {
                    Sse2.Store(b+size*0, vectorPositiveInfinity);
                    Sse2.Store(b+size*1, vectorPositiveInfinity);
                    Sse2.Store(b+size*2, vectorPositiveInfinity);
                    Sse2.Store(b+size*3, vectorPositiveInfinity);
                    b += size*4;
                }
                for (; i < (length & ~(ulong)3); i += 4)
                {
                    Sse2.Store(b+size*0, vectorPositiveInfinity);
                    Sse2.Store(b+size*1, vectorPositiveInfinity);
                    b += size*2;
                }
                for (; i < length; i++)
                {
                    *b++ = double.PositiveInfinity;
                }
            }
        }
    } 
```

结果：

```
|                               Method |       Mean |     Error |    StdDev | Ratio |
|------------------------------------- |-----------:|----------:|----------:|------:|
|            MultidimensionalArrayLoop | 1,083.1 us | 11.797 us | 11.035 us |  1.00 |
| MultidimensionalArrayNaiveUnsafeLoop |   436.2 us |  8.567 us |  8.414 us |  0.40 |
|             MultidimensionalSpanFill |   321.2 us |  6.404 us | 10.875 us |  0.30 |
|              MultidimensionalSseFill |   231.9 us |  4.616 us | 11.323 us |  0.22 | 
```

`MultidimensionalArrayLoop`由于边界检查，速度很慢。JIT 在每个循环中发出代码，以确保它`[i, j]`在数组的范围内。JIT 有时可以省略边界检查，我知道它适用于一维数组。我不确定它是否适用于多维。

`MultidimensionalArrayNaiveUnsafeLoop`本质上与代码相同，`MultidimensionalArrayLoop`但没有边界检查。它要快得多，需要 40% 的时间。但是，它被认为是“天真的”，因为循环仍然可以通过展开循环来改进。

`MultidimensionalSpanFill`也没有边界检查，并且或多或少与 相同`MultidimensionalArrayNaiveUnsafeLoop`，但是，`Span.Fill`在内部进行循环展开，这就是为什么它比我们天真的不安全循环快一点的原因。它只需要 30% 的时间作为我们原来的。

`MultidimensionalSseFill`通过做两件事来改进我们的第一个不安全循环：循环展开和矢量化。这需要一个支持 Sse2 的 CPU，但它允许我们在一条指令中写入 128 位（16 字节）。这为我们提供了额外的速度提升，将速度降低到原来的 22%。有趣的是，使用 Avx（256 位）的相同循环始终比 Sse2 版本慢，因此此处不包括基准测试。

但这些数字仅适用于 1000x1000 的数组。当您更改数组的大小时，结果会有所不同。例如，当我们将数组大小更改为 10000x10000 时，所有不安全基准的结果都非常接近。可能是因为对于较大的数组有更多的内存获取，它倾向于平衡最近三个基准测试中看到的较小的迭代改进。

那里有一个教训，但我主要只是想分享这些结果，因为这是一个非常有趣的实验。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-11-29T13:41:54.063

我写的方法不是更快，但它适用于实际的多维数组，而不仅仅是 2D。

```
public static class ArrayExtensions
{
    public static void Fill(this Array array, object value)
    {
        var indicies = new int[array.Rank];

        Fill(array, 0, indicies, value);
    }

    public static void Fill(Array array, int dimension, int[] indicies, object value)
    {
        if (dimension < array.Rank)
        {
            for (int i = array.GetLowerBound(dimension); i <= array.GetUpperBound(dimension); i++)
            {
                indicies[dimension] = i;
                Fill(array, dimension + 1, indicies, value);
            }
        }
        else
            array.SetValue(value, indicies);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-11-29T14:31:18.317

```
double[,] myArray = new double[x, y];

if( parallel == true )
{
    stopWatch.Start();
    System.Threading.Tasks.Parallel.For( 0, x, i =>
    {
        for( int j = 0; j < y; ++j )
            myArray[i, j] = double.PositiveInfinity;  
    });
    stopWatch.Stop();
    Print( "Elapsed milliseconds: {0}", stopWatch.ElapsedMilliseconds );
}
else
{
    stopWatch.Start();
    for( int i = 0; i < x; ++i )
        for( int j = 0; j < y; ++j )
          myArray[i, j] = double.PositiveInfinity;  
    stopWatch.Stop();
    Print("Elapsed milliseconds: {0}", stopWatch.ElapsedMilliseconds);
} 
```

设置时，`x`我得到了单线程方法和多线程方法。`y``10000``553 milliseconds``170`

# android - 如何启用登录 android chromium？

> ID：11672151
> 
> 赞同：7
> 
> 时间：2012-07-26T14:57:43.217
> 
> 标签：android, debugging, chromium

我最近一直在研究 ICS 上与 webkit 相关的东西。如何启用 chrome 堆栈中的原始日志记录（外部/铬中的代码）？

* * *

我知道如何将我自己的日志打印到`Logcat`. 但是我需要查看调试级别的日志来解决一些问题。任何建议都会有所帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-09-15T05:47:38.880

我猜这个关于[chromium.org](http://www.chromium.org/developers/how-tos/debugging-on-android)或更好的[chromium.org 的教程 #LogOutput](http://www.chromium.org/developers/how-tos/debugging-on-android#TOC-Log-output)应该回答你的问题......

# c# - 如何使用 c# 从字符串调用方法？

> ID：11672155
> 
> 赞同：0
> 
> 时间：2012-07-26T14:57:56.103
> 
> 标签：c#

我创建了一个类库，其中有 4 个类，每个类有 1 个方法。头等舱是我的主要课程，在我的头等舱中，我有一个名为 calltoaction 的字符串，在这个字符串中，我将动态获取以下列表中的一个

1.  class2.Method2()
2.  class3.Method3()
3.  class4.Method4()

现在我想从字符串“calltoaction”执行“class2.method2”。

比如说：

```
class Class1
{
    public void method1()
    {
        string calltoaction = "Class2.Method2()";
    }
} 
```

如何从字符串中执行“Class2.Method”？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T15:06:13.057

我不完全确定你想要完成什么，但我相信它可以以更好的方式完成。基本上，如果我正确理解您的问题，调用此函数会返回您希望执行的类和方法的名称。

如果是这样的话，我会无限期地放弃整个“字符串”并开始查看代表。

考虑一下：

```
public class Class2
{
    public static void Method2() { } 
} // eo class 2

public class Class3
{
    public static void Method3() { } 
} // eo class 3

public class Class4
{
    public static void Method4() { } 
} // eo class 4 
```

现在我们来到我们的主要课程

```
public class MainClass
{
    private delegate void MethodDelegate();
    private List<MethodDelegate> delegates_ = new List<MethodDelegate>();

    // ctor
    public MainClass()
    {
        delegates_.Add(Class2.Method2);
        delegates_.Add(Class3.Method3);
        delegates_.Add(Class4.Method4);
    }

    // Call a method
    public void Method1()
    {
        // decide what you want to call:
        delegates_[0].Invoke(); // "Class2.Method2"
    } // eo Method1
}  // eo class Main 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T15:04:01.080

我想一种低技术的方法是使用这样的 switch 语句：

```
using System;

namespace ConsoleApplication24
{
    class Program
    {
        static void Main(string[] args)
        {
            Console.WriteLine("Which method would you like to run?");
            RunMyMethod(Console.ReadLine());
        }

        private static void RunMyMethod(string p)
        {
            switch (p)
            {
                case "MethodOne();":
                    MethodOne();
                    break;
                case "MethodTwo();":
                    MethodTwo();
                    break;
                case "MethodThree();":
                    MethodThree();
                    break;
            }
        }

        private static void MethodThree()
        {
            //Do Stuff
        }

        private static void MethodTwo()
        {
            //Do Stuff
        }

        private static void MethodOne()
        {
            //Do Stuff
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T15:41:37.050

使用 an`Action`而不是字符串（假设您不需要返回值。如果需要 - 使用`Func`）：

这是为了了解如何使用它：

```
public Form1()
{
    InitializeComponent();

    Action<string> calltoaction;
    calltoaction = Doit;
    calltoaction("MyText1");
    calltoaction = Doit2;
    calltoaction("MyText2");
}

void Doit(string s)
{ Text = s; }

void Doit2(string s)
{ textBox1.Text = s; } 
```

# c# - 将属性添加到列表中？

> ID：11672161
> 
> 赞同：5
> 
> 时间：2012-07-26T14:58:05.997
> 
> 标签：c#, .net, list

我有一个包含很多对象的列表`List<MyObjects>`- 我遍历这个列表并读取对象。没关系。我现在才意识到，如果我可以在这个列表中再添加 1 个特殊值——不是对象，只是某物的 1 个值（一个字符串），那将是多么棒。

我现在可以创建一个类

```
class Needless
{
  public List<MyObjects> MyList { get; set; }
  public string MyValue { get; set; }
} 
```

但我试图避免这种情况。我真的只需要一个带有输入的字符串，每个有`List<MyObjects>`什么想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-26T15:00:35.233

`Tuple<string, List<MyObject>>`是一种选择。但是，如果您要经常使用这种配对，我建议您创建一个自定义类以使其更加明确 - 就像您所做的那样，或者通过派生*字符串*`List<MyObject>`并将其添加为属性。

如果您在“范围内”工作，您总是可以创建匿名类型：

```
var t = new { TheString = "", TheList = new List<MyObject>() };
var list = t.TheList;
var s = t.TheString; 
```

但这仅在方法的范围内真正有好处。编译器可以为此提供 IntelliSense，并且它在编译时是强类型的。

或者，如果您真的想全力以赴，请使用`ExpandoObject`from `System.Dynamic`：

```
var expando = new ExpandoObject();
expando.List = new List<MyObject>();
expando.TheString = ""; 
```

这是在没有任何 IntelliSense 支持的情况下直接输入的，并且将调用 DLR。`ExpandoObject`只需`IDictionary<string, object>`在引擎盖下使用一个，所以...

```
var dict = (IDictionary<string, object>)expando; 
```

...已验证。

最后一个选项*有点*半开玩笑。它会起作用，但与其他选项相比，它的开发经验并不理想。也就是说，我们`ExpandoObject`在我们的测试代码中使用，但我不记得为什么。人们只能希望推理是合理的，但很可能是开发人员对新玩具感到头晕目眩……

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-26T15:01:20.050

您可以继承 List 并简单地添加您的属性，这比在另一个类中组合 List 要干净一些

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T15:01:46.180

您可以使用 Needless 类扩展 List 实现。这样，您仍然可以将您的列表视为列表。

# clojurescript - clojurescript / twitter 引导工具提示 jayq

> ID：11672162
> 
> 赞同：0
> 
> 时间：2012-07-26T14:58:07.600
> 
> 标签：clojurescript

当我尝试在 dom 元素上设置 twitter 引导工具提示时

```
(.tooltip $( :#someid) (clj->js {:placement :left})) 
```

我明白了

```
> Uncaught TypeError: Object function (sel, var_args) {
>     var p__9921 = null;
>     if(goog.isDef(var_args)) {
>       p__9921 = cljs.core.array_seq(Array.prototype.slice.call(arguments, 1), 0)
>     }
>     return $__delegate.call(this, sel, p__9921)   } has no method 'tooltip' clusty.js:23013 (anonymous function) 
```

我没有使用任何高级优化，并且将 jayq 与其他库（如数据表）一起使用也没有问题......

我错过了什么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-07-25T12:19:53.363

看起来您已经转置了美元符号并打开了括号。

```
(.tooltip ($ :#someid) (clj->js {:placement :left})) 
```

（在这里重新发布凯文的评论，以便可以关闭问题）

# iphone - 为 i386 和 arm6/7 捆绑可执行文件

> ID：11672163
> 
> 赞同：0
> 
> 时间：2012-07-26T14:58:10.113
> 
> 标签：iphone, objective-c, ios, xcode, cocoa

我正在尝试编译 libFLAC 可执行文件以在我的项目中继承以将 wav 文件转换为 flac，但是目前我已经成功地使用了 OR。不是都。我试图找出是否有一种方法可以同时捆绑 i386 和 arm6/7 架构。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T15:03:38.503

您可以在输出可执行文件上使用*lipo*将它们捆绑在一起：

```
lipo -create -output <output> <input0> <input1> 
```

所以在你的情况下，你可能有：

```
lipo -create -output libflac_bundled.a libflac_i386.a libflac_arm.a 
```

这将生成包含两个库的**libflac_bundled.a 。**

# box-api - 有什么方法可以从 Box API 获取有关合作者身份的详细信息？

> ID：11672164
> 
> 赞同：0
> 
> 时间：2012-07-26T14:58:12.327
> 
> 标签：box-api

我能得到的最接近的是显示“COLLAB_ADD_COLLABORATOR”类型事件的事件 - 但是，这不包括协作者的身份。

请注意，在此用户对文件或文件夹执行任何操作之前，我可能需要此信息：我只想获取所有协作者的列表，无论他们是否执行了任何操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T09:05:25.403

您可以使用 API 的 V1 单独获取每个文件夹的协作。这可能无法满足您在合作伙伴对其进行任何操作之前了解的要求。但这是你现在最好的选择。V2还没有

[http://developers.box.net/w/page/12923933/ApiFunction_get_collaborations](http://developers.box.net/w/page/12923933/ApiFunction_get_collaborations)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T19:45:02.940

该信息将包含在 v2 'collaborations' 对象中。当前没有为 v2 API 实现 /collaborations 端点。但是，它将在 v2 GA 之前实施。

# kernel - 如何编译 Xperia S 内核 wifi 模块

> ID：11672169
> 
> 赞同：0
> 
> 时间：2012-07-26T14:58:18.447
> 
> 标签：kernel, android-4.0-ice-cream-sandwich

我有一个为 Xperia S ICS frimware 从源代码编译的内核，它运行非常流畅，唯一的问题是当我添加某些功能时没有 wifi 模块。

我尝试了不同的东西，但我从来没有得到模块。

所以我的内核不能使用wifi。

请解释我如何编译它们或者我需要在内核源代码的文件中添加什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-11T17:22:42.100

有两种方法：
1\. 简单的方法：打开你的 .config 文件并更改 CONFIG_LOCALVERSION 使其与以前的内核相同。通过这种方式，您的内核可以使用现有的 wifi 模块。
2\. 自己编译你的模块：
2.1 编译内核后，进入wifi驱动文件夹并输入

```
KERNEL_DIR=<your kernel dir> CROSS_COMPILE=arm-eabi- ARCH=arm make 
```

如果使用官方wifi源码，需要通过diff命令编译

```
KLIB_BUILD=<your kernel dir> KLIB=. CROSS_COMPILE=arm-eabi- ARCH=arm make 
```

2.2 将你的 .ko 文件复制到 /system/lib/modules/
注意：如果你的新模块不起作用，简单的修复方法是在你的 .config 文件中启用 80211 和 WL12XX（以提供所需的对象和功能）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T15:20:57.767

看看[Xperia S DoomKernel](http://forum.xda-developers.com/showthread.php?t=1557452)，[这里](https://github.com/DooMLoRD/android_kernel_semc_msm8660)有资源。作者也提供 WiFi 模块。

OEM 不提供所有源代码（例如，某些供应商驱动程序）的原因是它们受专有许可证的保护，不应该与社区共享。

# html - Twitter 引导程序和表单

> ID：11672170
> 
> 赞同：1
> 
> 时间：2012-07-26T14:58:22.827
> 
> 标签：html, css, twitter-bootstrap

我正在使用[Twitter Bootstrap](http://twitter.github.com/bootstrap/base-css.html#forms)。在表单中，我可以进行水平布局和垂直布局，但类在`<form>`标签上。那么，如何在我想节省空间的地方做一点点，然后水平放置几个输入框，其余的垂直放置？

我有一个看起来像这样的表格：

```
Address [__________________]
City [___________]
State [__]
Zip [_____]
Country [____] 
```

但我希望它看起来像这样：

```
Address [__________________]
City [___________]
State [__] Zip [_____] Country [____] 
```

请帮助CSS。

这是我的代码：

```
<form class="form-horizontal">
    <fieldset>
        <div class="row-fluid"> 
            <div class="span6">
                <div class="control-group">
                    <label class="control-label" for="Address">Mailing Address</label>
                    <div class="controls">
                        <input data-val="true" data-val-required="Required" id="mailing" name="Address" type="text" value="1313 Mockingbird Lane" class="valid">
                    </div>
                </div>
                <div class="control-group">
                    <label class="control-label" for="City">City</label>
                    <div class="controls">
                        <input class="span3 valid" id="city" name="City" type="text" value="Kaysville">
                    </div>
                </div>
                <div class="control-group">
                    <label class="control-label" for="State">State</label>
                    <div class="controls">
                        <input class="span2" id="state" name="State" type="text" value="UT">
                    </div>
                </div>
                <div class="control-group">
                    <label class="control-label" for="PostalCode">Zip</label>
                    <div class="controls">
                        <input class="span2" id="postalCode" name="PostalCode" type="text" value="12345">
                    </div>
                </div>
                <div class="control-group">
                    <label class="control-label" for="Country">Country</label>
                    <div class="controls">
                        <input class="span3" id="country" name="Country" type="text" value="US">
                    </div>
                </div>
            </div>
        </div>
    </fieldset>
</form> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-30T18:50:14.410

这对我有用

```
<div class="control-group">
    <label class="control-label" for="inputPLZ">PLZ*</label>
    <div class="controls">
        <input type="text" class="input-mini" id="inputPLZ">                                        
        Ort*
        <input type="text" class="input-medium" id="inputOrt">
    </div>
</div> 
```

它是这样渲染的

![在此处输入图像描述](../Images/9d59389deaebd1e5ea960236ece826b5.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T15:10:10.417

Helps to understand how bootstrap is set up.

The `.control-label` class is the left side indicator of a form. This takes the left 140px of the form and floats left. The `.controls` class is the right side of container of a form, and simply applies a margin left of 160px to itself without floating.

Knowing this, you can treat Bootstrap like normal HTML. You can simply include all the inputs in the same control, like so:

```
<div class="control-group">
    <div class="controls">
        State: <input class="span2" id="state" name="State" type="text" value="UT">
        Zip: <input class="span2" id="postalCode" name="PostalCode" type="text" value="12345">
        Country: <input class="span3" id="country" name="Country" type="text" value="US">
    </div>
</div> 
```

If you want the alignment to match up, use a little bit of trickery by making the first label in your horizontal set the `.control-label` like so:

```
<div class="control-group">
    <label class="control-label">State:</label>
    <div class="controls">
        <input class="span2" id="state" name="State" type="text" value="UT"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T15:01:15.123

将 state、zip 和 country 包装在一个 div 中，然后将子元素向左浮动，它们应该对齐。虽然我没有使用 Bootstrap 的经验，所以不知道这是否会影响任何事情

# itextsharp - 将页面内容从大的 pdf 页面复制到较小的 pdf 页面

> ID：11672172
> 
> 赞同：1
> 
> 时间：2012-07-26T14:58:26.333
> 
> 标签：itextsharp

我有一个 22*17 的 PDF 文件，我需要它来适应 11*8.5 页面中的页面内容。

基本上减少现有的页面大小。我正在使用 iTextSharp。

我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T15:38:14.643

您*可以*为此使用 Ghostscript 和 pdfwrite 设备，而不是 itextsharp。就像是：

```
gs \
 -sDEVICEHIGHTPOINTS=612 -sDEVICEWIDTHPOINTS=792 \
 -dFIXEDMEDIA \
 -dPDFFitPage \
 -sDEVICE=pdfwrite \
 -sOutputFile=output.pdf \
  input.pdf 
```

警告：这将完全解释 PDF 文件以进行标记操作并发出全新的 PDF（重新调整以适应新的媒体大小），具体取决于您可能喜欢或不喜欢结果的文件内容。

# android - 加载ListView更快，比Viewholder方法更快

> ID：11672174
> 
> 赞同：12
> 
> 时间：2012-07-26T14:58:41.487
> 
> 标签：android, android-listview

在为 listView 膨胀视图时，最好在 .xml 文件中包含所有没有 android:text 的 textView，这对速度有多大影响？ViewStubs 怎么样，会更快吗？

当使用 8 个没有 android:text 和 android:text="@string/abc" 的 textView 为 LinearLayout 充气时，这会改变什么吗？请注意，我正在重用视图，所以也许只有 10 个被夸大然后重用我不知道。

我正在 ZTE Blade 上开发，所以这是一个 600Mhz CPU 而不是四核......

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-02T14:43:55.043

你可以试试这个，不确定它是否会加速，但试一试。

在后台线程中扩展布局。

```
View getView(int position, View convertView, ...) {
    View v;
    if (convertView == null) {
        Start a background thread to inflate your linearLayout. 
        Pass item data and view 'v' to it.

        v = inflate a simple dummy textview;
        return v;
    }
    set normal stuff to convertview here.
    return convertView ;
 } 
```

在后台线程中，

*   将您的 Linearlayout 膨胀为`'v'`
*   设置所有数据。
*   然后使视图无效`v`。

    ```
    v.postInvalidate(); 
    ```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-26T15:13:51.157

这在加速列表视图时非常有用，尤其是 View Holder 位：http: [//developer.android.com/training/improving-layouts/smooth-scrolling.html](http://developer.android.com/training/improving-layouts/smooth-scrolling.html)

我也有一个 ZTE Blade，它们很慢，但是在它上面运行良好的应用程序在“普通”手机上运行惊人:)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-06T05:42:19.747

如果您要替换 textviews 中的文本，那么您不应该费心在 XML 中填充它们。

在简单的列表视图中，一个真正的性能杀手是嵌套的线性布局。通过一些工作，任何线性布局树都可以用相对布局替换。

通过使用 ViewHolder 样式或简单地在 view.setTag(R.id.resId, findViewById(R.id.resID)) 中设置，确保您没有在 if (convertView == null) { 块之外使用 findViewById

您在评论中提到从 asynctask 返回时遇到延迟。确保您没有在每次输入后重新加载表格。对数据源进行批量更新，然后重新加载表。

# spring - 使用新模型值重新启动 Spring Web Flow

> ID：11672176
> 
> 赞同：0
> 
> 时间：2012-07-26T14:58:54.180
> 
> 标签：spring, spring-webflow

我试图找到一种方法，如果用户重新启动流程，则值不在其中。如果您查看下面的流程，您可以看到用户输入数据，预览并保存它。保存后，用户可以返回以将新数据输入到输入屏幕，但使用我当前的设置，屏幕显示预-数据。如何在重启时清除它？

```
<flow xmlns="http://www.springframework.org/schema/webflow"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.springframework.org/schema/webflow
                      http://www.springframework.org/schema/webflow/spring-webflow-2.0.xsd">

  <var name="customer" class="org.uftwf.domain.Customer"/>

  <view-state id="helloworld" view="input.jsp" model="customer" popup="true">
    <transition on="submit" to="preview" />
    <transition on="cancel" to="thanks" validate="false"/>
  </view-state>

  <view-state id="preview"  model="customer">
    <transition on="cancel" to="helloworld"/>
    <transition on="accept" to="save">
      <evaluate expression="hellowWorldFlowActions.addCustomer(customer)"/>
    </transition>
  </view-state>

  <view-state id="save"  model="customer">
    <transition on="accept" to="thanks"/>
  </view-state>

  <view-state id="thanks">
    <transition on="restart" to="helloworld"/>
  </view-state>
</flow> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T16:21:25.910

一种简单的方法是`reset()`在您的类上定义一个方法，并以任何有意义的方式`Customer`调用该方法`<view-state>` `<on-entry>`（如“thanks”）或（“restart”）。`<transition>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-12T14:30:56.320

您可以执行外部重定向以执行相同的流程。这是一个例子。

```
<var name="customer" class="org.uftwf.domain.Customer"/>

<view-state id="thanks">
   <transition on="restart" to="doRestart"/>
</view-state>

<end-state id="doRestart" view="externalRedirect:nameOfThisFlow"></end-state> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T07:39:47.450

你有没有尝试过：

```
<view-state id="helloworld" view="input.jsp" model="customer" popup="true">
        <on-entry>
                <set name="flowScope.costumer" value="new org.uftwf.domain.Customer()" />
        </on-entry>
        <transition on="submit" to="preview" />
        <transition on="cancel" to="thanks" validate="false"/>
</view-state> 
```

# celery - 用芹菜对特定任务设置时间限制

> ID：11672179
> 
> 赞同：60
> 
> 时间：2012-07-26T14:59:04.860
> 
> 标签：celery, celeryd

我在 Celery 中有一个任务，在正常运行时可能会运行 10,000 秒。但是，我的所有其他任务都应该在不到一秒钟的时间内完成。如何在不更改短期运行任务的时间限制的情况下为故意长时间运行的任务设置时间限制？

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2012-07-26T21:10:08.027

您可以在定义任务或调用时设置任务时间限制（[硬](http://docs.celeryproject.org/en/latest/userguide/tasks.html#Task.time_limit)和/或[软）。](http://docs.celeryproject.org/en/latest/userguide/tasks.html#Task.soft_time_limit)

```
from celery.exceptions import SoftTimeLimitExceeded

@celery.task(time_limit=20)
def mytask():
    try:
        return do_work()
    except SoftTimeLimitExceeded:
        cleanup_in_a_hurry() 
```

或者

```
mytask.apply_async(args=[], kwargs={}, time_limit=30, soft_time_limit=10) 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2016-08-12T06:50:08.773

这是一个使用**soft_time_limit** =10000的特定任务和 Celery 3.1.23 的装饰器示例

```
@task(bind=True, default_retry_delay=30, max_retries=3, soft_time_limit=10000)
def process_task(self, task_instance):
   """Task processing."""
        pass 
```

# cross-browser - 使用 Selenium RC 自动化跨浏览器测试

> ID：11672183
> 
> 赞同：1
> 
> 时间：2012-07-26T14:59:27.227
> 
> 标签：cross-browser, automation, selenium-rc

我正在尝试使用 Selenium RC 来自动化`cross-browser`测试。我需要自动化测试`IE7, 8 and 9`。我的机器上没有安装这些浏览器。我在我的机器上安装了一个名为的跨浏览器测试工具`Multi-Browser Viewer`，它使上述浏览器作为虚拟浏览器可供我使用，位于文件夹中`C:\ProgramData\Multi-Browser Viewer`。我想知道如何使用 Selenium RC 来访问这些浏览器。我提到了弃用的 RC，而不是 WebDriver，因为 Multi-Browser Viewer 的供应商建议在他们的软件中使用 RC。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T05:07:51.557

使用自定义浏览器如下

```
*custom "Path to executable of browser" 
```

# android - java.lang.RuntimeException: Canvas: 试图使用回收的位图 android.graphics.Bitmap

> ID：11672187
> 
> 赞同：0
> 
> 时间：2012-07-26T14:59:41.017
> 
> 标签：android, bitmap, garbage-collection, recycle

我向这个处理程序发送消息（这里我省略了一些情况）对位图进行一些操作，然后在 UI 上设置位图。因为对位图的操作比较耗时，所以我把它放在了一个线程中。完成此操作后，我使用***runOnUiThread***方法在 UI 线程中设置 UI 。
通常，这一切都运行良好，但在某些情况下，我得到了以下异常：***java.lang.RuntimeException: Canvas: 试图使用回收的位图 android.graphics.Bitmap***。
这种情况非常罕见，但确实发生了好几次。

```
private Handler mHandler = new Handler()
{
    @Override
    public void handleMessage(Message msg)
    {
        int what = msg.what;
        switch (what)
        {

            case VideoProtocal.COMPRESS_SUCCESS:
                state = State.COMPRESSED;
                recordBack.setVisibility(View.VISIBLE);
                recordSend.setVisibility(View.VISIBLE);
                playButton.setVisibility(View.VISIBLE);
                new Thread(){
                    @Override
                    public void run()
                    {
                        rotationBitmap();
                        runOnUiThread(new Runnable() {
                            public void run() {
                                if( null != bitmap && !bitmap.isRecycled() )
                                {
                                    Drawable drawable = new BitmapDrawable(bitmap);
                                    fristFrame.setBackgroundDrawable(drawable);
                                }
                            }
                        });
                    }
                }.start();
                mFrameCount = 0;
                getVideoSize();
                videoTime = getVideoFileTime(mp4_path) / 1000;
                timeView.setText(getString(R.string.video_count, videoTime));
                deleteTempFile();
                LogX.trace(TAG, "COMPRESS_SUCCESS");
                dismissProgress();
                break;
            default:
                break;
        }
    }

}; 
```

方法rotationBitmap() 和它调用的一些方法如下所示：

```
private void rotationBitmap()
{
    int width = (int) (PIC_WIDTH * FusionField.currentDensity);
    int height = (int) (PIC_HIGHT * FusionField.currentDensity);
    Bitmap bmTemp = bitmap;
    bitmap = CommonUtil.resizeImage(bitmap, width, height);

    if (bmTemp != null && !bmTemp.isRecycled() && bmTemp != bitmap)
    {
        bmTemp.recycle();
        bmTemp = null;
    }

    rotate(bitmap, rotationAngle());

    CommonUtil.checkMysoftStage(FusionCode.videoThumbnail);
    String videoName = CommonUtil.getUniqueName(".jpg", FusionCode.videoName);
    jpg_path = FusionCode.videoThumbnail + "/" + videoName;
    try
    {
        FileOutputStream fos = new FileOutputStream(jpg_path);
        if (bitmap != null)
        {
            bitmap.compress(CompressFormat.JPEG, 50, fos);
        }
        fos.close();
    }
    catch (FileNotFoundException e)
    {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    catch (IOException e)
    {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
}

private Bitmap rotate(Bitmap b, int degrees)
{
    if (degrees != 0 && b != null)
    {
        Matrix m = new Matrix();
        m.setRotate(degrees, (float) b.getWidth() / 2, (float) b.getHeight() / 2);
        try
        {
            bitmap = Bitmap.createBitmap(b, 0, 0, b.getWidth(), b.getHeight(), m, true);
        }
        catch (OutOfMemoryError ex)
        {
            // TODO Auto-generated catch block
            ex.printStackTrace();
        }
    }
    return b;
} 
```

从代码中，问题必须出现在此语句中：

```
Drawable drawable = new BitmapDrawable(bitmap); 
```

但是根据代码上下文，位图不应该为空或回收，这真的很奇怪。

我一直在这个问题上徘徊近两天，无法弄清楚问题是什么，但问题确实存在。有人可以给我一些建议吗？任何回应表示赞赏！谢谢！<br />

顺便说一句，当我尝试这样的 RuntimeException 时，无法捕获这种异常，为什么？

```
try
{
    bitmap.recycle();
    Drawable drawable = new BitmapDrawable(bitmap);
    fristFrame.setBackgroundDrawable(drawable);
}
catch (RuntimeException e)
{
    e.printStackTrace();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T01:40:09.470

好的，让我回答我的问题。出现此问题的原因是 VideoProtocal.COMPRESS_SUCCESS 被 mHandler 接收了两次。它在那里有多线程，所以在某些时候，会出现“使用回收位图”的问题。至于为什么收到两次消息，呃......这是我使用定时器任务的错误。

# php - PHP特定的合并数组

> ID：11672189
> 
> 赞同：0
> 
> 时间：2012-07-26T14:59:42.967
> 
> 标签：php, arrays

我有 2 个数组

```
$arr1 = array(1,3);  
$arr2 = array(2,4); 
```

我想将它们合并到一个具有结构的数组中：

```
$arr = array(1,2,3,4); 
```

是否有 php 功能或存在好的解决方案？
UPD：我不需要排序值，我想将第一个数组中的元素放置到奇数位置，将元素从第二个放置到偶数位置

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-26T15:00:46.817

你必须先给[`merge`](http://www.php.net/array_merge)他们，然后[`sort`](http://www.php.net/sort)他们：

```
$arr = array_merge($arr1, $arr2);
sort($arr); 
```

假设它们的长度相同，则没有内置函数可以执行您所描述的操作：

```
$len = count($arr1);
for($x=0; $x < $len; $x++) {
    array_push($arr, $arr1[$x], $arr2[$x]);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T15:00:21.183

```
$new_arr = array_merge($arr1, $arr2) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T15:06:46.723

不，据我所知，Php 没有这方面的功能。你必须自己写，但这很简单。

伪代码：

```
cmb = []

for (i=0, i<arr1.length, i++) {
   array_push(cmb, arr1[i]);
   array_push(cmb, arr2[i]);
} 
```

# restkit - RKClient：如何做一个简单的 PUT 的 xml 正文

> ID：11672194
> 
> 赞同：1
> 
> 时间：2012-07-26T14:59:59.690
> 
> 标签：restkit

我正在使用 RestKit，但还没有遇到过如何对这样的主体进行简单的 PUT：

```
 <parameters></parameters> 
```

有人可以给出一个代码示例吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T00:21:57.030

这是一种令人困惑的 PUT，因为您的查询参数实际上名为“参数”。你确定这是故意的吗？尝试这样的事情。

```
NSDictionary* params = [NSDictionary dictionaryWithObject:@"" forKey:@"parameters"];
[[RKClient sharedClient] put:yourURL params:params delegate:self]; 
```

当然，您需要导入 RestKit，并且您的 .h 文件必须接受 .h 文件`< RKRequestDelegate >`。我希望这能让你走上正轨。

您可能还想看看[这个 SO question](https://stackoverflow.com/questions/10078570/ios-restkit-http-put-example)，但是我没有实施建议的解决方案，所以我无法确定它的功效。

# ruby-on-rails - 无法使用 Ruby 1.9.3 在 RubyMine 4.5 中调试

> ID：11672201
> 
> 赞同：17
> 
> 时间：2012-07-26T15:00:14.587
> 
> 标签：ruby-on-rails, ruby, rubymine

对于问题的长度，我深表歉意，但我想明确表示我没有犯任何愚蠢的错误！

因此，我正在努力使用 Ruby 1.9.3 在 RubyMine 4.5 中进行调试，我的步骤如下：

Ruby 1.9.3、Ruby Gems、DevKit 和 Rails（遵循[本指南](http://thirdeye.ibtgames.com/2011/11/installing-ruby-on-rails-on-win7/)）的全新（即删除了所有以前的 ruby​​ 和 gem 目录）安装 - 效果很好。

然后我尝试开始使用我团队的 ruby​​ 代码。我在 RubyMine 中打开目录（记住首先要删除`.idea`目录）并提示`bundle install`我运行（从控制台）按要求运行。这成功完成。重新启动 RubyMine。

然后我确保 Ruby 正在工作：工具 > IRB 控制台 > `puts "test"` `#test => nil`- 工作我现在尝试调试器 ( `SHIFT`+ `F9`) 并查看消息：

`The gem ruby-debug-base19x required by the debugger is currently not installed. Would you like to install it?"`

我单击取消并检查我的 Gemfile，目前与调试相关的唯一文件是：

```
# Debugging
gem 'debugger'
#gem 'ruby-debug-base19', :require => false
#gem 'ruby-debug19', :require => false
gem 'ruby-prof', :require => false #, :git => 'git://github.com/wycats/ruby-prof.git' 
```

看起来我们有调试器支持`ruby-debug`. 但是，[在这里](http://devnet.jetbrains.net/message/5459214?tstart=0)阅读似乎`debugger`还不够。我需要安装`ruby-debug-base19x`. 所以，在[SO](https://stackoverflow.com/questions/10323119/cannot-load-such-file-script-rails-getting-this-error-while-remote-debuggin)之后，我从 Gemfile 中注释掉调试器并运行

```
gem install ruby-debug-base19x --pre
gem install ruby-debug-ide --pre 
```

哪个运行良好，所以我添加

```
gem 'ruby-debug-base19x', '0.11.30.pre10'
gem 'ruby-debug-ide', '0.4.17.beta14' 
```

到我的 Gemfile，然后`bundle install`从控制台运行。

最后，我在 RubyMine (SHIFT + F9) 中打开调试器。并`puts "test" #test => nil`再次工作。所以我尝试双击我的脚本的排水沟来创建一个断点，RubyMine 暂停了一秒钟，然后我得到：

```
D:\Ruby\Ruby193\bin\ruby.exe -e $stdout.sync=true;$stderr.sync=true;load($0=ARGV.shift) D:/Ruby/Ruby193/lib/ruby/gems/1.9.1/gems/ruby-debug-ide-0.4.17.beta14/bin/rdebug-ide --dispatcher-port 55451 --port 55452 -- S:/code/account_groups/script/rails console
Fast Debugger (ruby-debug-ide 0.4.17.beta14, ruby-debug-base 0.11.30.pre10) listens on 127.0.0.1:55452
D:/Ruby/Ruby193/lib/ruby/gems/1.9.1/gems/debugger-1.1.4/lib/ruby_debug.so: warning: already initialized constant VERSION
5992: Exception in DebugThread loop: undefined method `errmsg' for #<Debugger::ControlState:0x2a2f3e8>
Backtrace:
D:/Ruby/Ruby193/lib/ruby/gems/1.9.1/gems/debugger-1.1.4/lib/ruby-debug/command.rb:160:in `errmsg'
  from: D:/Ruby/Ruby193/lib/ruby/gems/1.9.1/gems/debugger-1.1.4/lib/ruby-debug/commands/breakpoints.rb:81:in `execute'
  from: D:/Ruby/Ruby193/lib/ruby/gems/1.9.1/gems/ruby-debug-ide-0.4.17.beta14/lib/ruby-debug-ide/ide_processor.rb:89:in `block in process_commands'
  from: D:/Ruby/Ruby193/lib/ruby/gems/1.9.1/gems/ruby-debug-ide-0.4.17.beta14/lib/ruby-debug-ide/ide_processor.rb:86:in `catch'
  from: D:/Ruby/Ruby193/lib/ruby/gems/1.9.1/gems/ruby-debug-ide-0.4.17.beta14/lib/ruby-debug-ide/ide_processor.rb:86:in `process_commands'
  from: D:/Ruby/Ruby193/lib/ruby/gems/1.9.1/gems/ruby-debug-ide-0.4.17.beta14/lib/ruby-debug-ide.rb:160:in `block in start_control'

Process finished with exit code 0 
```

我还尝试使用代码的备份副本并遵循相同的步骤，尝试加载调试器时也出现以下错误：

```
Uncaught exception: cannot load such file -- ruby-debug
    D:/Ruby/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.6/lib/active_support/dependencies.rb:251:in `require'
    D:/Ruby/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.6/lib/active_support/dependencies.rb:251:in `block in require'
    D:/Ruby/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.6/lib/active_support/dependencies.rb:236:in `load_dependency'
    D:/Ruby/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.6/lib/active_support/dependencies.rb:251:in `require'
    S:/code/account_groups_so/lib/systematic-online/r_spec_runner.rb:5:in `<top (required)>'
    D:/Ruby/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.6/lib/active_support/dependencies.rb:251:in `require'
    D:/Ruby/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.6/lib/active_support/dependencies.rb:251:in `block in require'
    D:/Ruby/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.6/lib/active_support/dependencies.rb:236:in `load_dependency'
    D:/Ruby/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.6/lib/active_support/dependencies.rb:251:in `require'
    S:/code/account_groups_so/config/environment.rb:12:in `block in <top (required)>'
    S:/code/account_groups_so/config/environment.rb:12:in `each'
    S:/code/account_groups_so/config/environment.rb:12:in `<top (required)>'
    D:/Ruby/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.6/lib/active_support/dependencies.rb:251:in `require'
    D:/Ruby/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.6/lib/active_support/dependencies.rb:251:in `block in require'
    D:/Ruby/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.6/lib/active_support/dependencies.rb:236:in `load_dependency'
    D:/Ruby/Ruby193/lib/ruby/gems/1.9.1/gems/activesupport-3.2.6/lib/active_support/dependencies.rb:251:in `require'
    D:/Ruby/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.6/lib/rails/application.rb:103:in `require_environment!'
    D:/Ruby/Ruby193/lib/ruby/gems/1.9.1/gems/railties-3.2.6/lib/rails/commands.rb:40:in `<top (required)>'
    S:/code/account_groups_so/script/rails:6:in `require'
    S:/code/account_groups_so/script/rails:6:in `<top (required)>' 
```

脚本没有任何问题（我以前用过很好），并且跟踪似乎与`ruby-debug-ide`- 发生了什么事？

感谢您的帮助 - 这让我发疯！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-26T17:45:24.950

**更新**：RubyMine 6+ 支持调试器 gem。

确保`gem 'debugger'`从您的 中删除`Gemfile`，这是一个已知的冲突，会破坏 RubyMine 的调试。您只需要 2 个与调试器相关的宝石，正如我在您的问题中链接的[另一个答案中所述。](https://stackoverflow.com/a/10325110/104891)

删除 gem 后，您需要确保在项目的任何地方都没有引用它。在这种特殊情况下，尝试运行时`r_spec_runner.rb`有`require 'ruby-debug'`语句导致错误。`cannot load such file -- ruby-debug``rails console`

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-10-11T12:57:45.323

为了避免这个问题，我在我的`Gemfile`：
`gem 'debugger' unless ENV["RM_INFO"]`

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-03-18T14:33:45.487

只是为了记录jetbrains的解决方案：使用以下任一：

```
gem 'debugger', {group: [:test, :development]}.merge(ENV['RM_INFO'] ? {require: false} : {}) 
```

或者：

```
gem 'pry-debug', {group: [:test, :development]}.merge(ENV['RM_INFO'] ? {require: false} : {}) 
```

这确保了 Gemfile.lock 保持不变，因此混合了 RubyMine 和 vi/sublime/whatever 的组可以愉快地工作，因为在 RubyMine 环境中不需要 gem。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-02T17:14:43.957

我遇到了同样的问题，我花了好几个小时才让它工作。这是最终让调试器运行的原因（这是使用 RVM）：

*   退出 RubyMine
*   如果安装了 Ruby 1.9.3，请将其卸载：`rvm remove 1.9.3`
*   在 RVM 下安装 Ruby 1.9.3：`rvm install 1.9.3 --with-gcc=clang`- 这会产生错误“不支持的选项 '--with-libyaml'”，但我还没有看到任何不良影响
*   切换到新的红宝石：`rvm use 1.9.3`
*   列出并删除所有 ruby​​-debug* gem： `gem list | grep debug`-`gem uninstall <found gems>`
*   [从http://rubyforge.org/frs/?group_id=8883](http://rubyforge.org/frs/?group_id=8883)下载 linecache19并安装 gem，即：`gem install linecache19-0.5.13.gem`
*   启动 RubyMine，并运行调试器；它将通知缺少调试 gem（即 ruby​​-debug-ide）；让 RubyMine 安装这些。

那是调试器开始工作的时候。另请参阅此 RubyMine 支持讨论：[http ://devnet.jetbrains.com/message/5443846#5443846](http://devnet.jetbrains.com/message/5443846#5443846)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-03T21:50:31.200

今天终于用一个巨大的 kludge hack 完成了这个工作。我认为做到这一点的步骤是

1.  `sudo chmod -R 777 ~/.rvm`

2.  让 RubyMine 做它的事

我还确保卸载我拥有的所有 gem `rake`。我认为`reby-debug-ide`, `ruby-debug-base19x`, `linecache19`, `ruby_core_source`, `archive-tar-minitar`, 和`columnize`是重要的。`rvm`我还用clang卸载并重新安装。但我会尝试先做 chmod 的事情。我尝试更改为 766，但 RubyMine 不喜欢它。它是如此巨大的kludge hack。我现在收到很多警告，`Insecure world`但至少调试器正在工作。很确定 RubyMine 的下一个版本不会使用旧的[ruby​​-debug-base19x](https://rubygems.org/gems/ruby-debug-base19x%2019x)，而是使用最近在[https://github.com/ruby-debug](https://github.com/ruby-debug)编辑的 gem 。所以希望很棒的 JetBrains 的某个人会修复它。顺便说一句，也尝试使用 RubyMine 运行，`sudo mine`但这也没有成功。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-03-06T22:05:18.437

我的调试器有一些问题。我安装了 Rails 并将配置选项中的路径设置为 rails 安装中的 ruby​​.exe，一切正常。

# c# - C# Entity Framework 连接 - 访问数据所需的 dbcreator 角色

> ID：11672206
> 
> 赞同：2
> 
> 时间：2012-07-26T15:00:22.790
> 
> 标签：c#, sql-server, entity-framework

我正在尝试编写一个 Web 服务来更新在线数据库，随后将编写一个网站来访问数据，但是我的 SQL Server 登录权限存在问题。

我想使用实体框架访问数据库，连接将使用 SQL Server 身份验证。我希望登录名仅对存储过程具有执行权限，以减少任何安全威胁-但是，每当我尝试向数据库添加新连接时，它都不允许我这样做，这是我可以添加的唯一方法连接是登录是否具有 dbcreator 角色。

我收到以下错误 -

> 数据库“master”中的 CREATE DATABASE 权限被拒绝尝试附加自动命名的数据库......存在同名的数据库，或无法打开指定的文件，或者它位于 UNC 共享上。

如果连接被强制使用具有 dbcreator 角色的登录名，这似乎是一个很大的安全风险，对于 Web 服务而言，登录名将受到密码保护，但网站会将密码存储在代码中，因此可能会受到损害和用于进行更改。

我确信有一个很好的解决方案 - 我只是在追踪它时遇到了麻烦。大多数解决方案似乎是赋予连接 dbcreator 角色。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T15:34:05.703

实体框架默认要创建数据库。您可以更改：[https ://stackoverflow.com/a/5018062/384701](https://stackoverflow.com/a/5018062/384701)

# javascript - 每个应用程序应该只有一个 EventSource 对象吗？

> ID：11672209
> 
> 赞同：14
> 
> 时间：2012-07-26T15:00:39.833
> 
> 标签：javascript, html, http, push, server-sent-events

当使用[服务器发送事件](http://www.w3.org/TR/eventsource/)时，客户端应该建立多个连接来接收它感兴趣的不同事件，还是应该只有一个连接并且客户端通过单独的通道指示它感兴趣的内容？IMO 后者似乎更可取，尽管对某些人来说它可能会使客户端代码更复杂。该规范支持命名事件（与特定主题相关的事件），这对我来说建议服务器发送事件连接应该用作所有事件的单一通道。

以下代码说明了启动多个 Server-Sent Event 连接的第一种情况：

```
var EventSource eventSource1 = new EventSource("events/topic1");
eventSource1.addEventListener('topic1', topic1Listener, false);

var EventSource eventSource2 = new EventSource("events/topic2");
eventSource2.addEventListener('topic2', topic2Listener, false); 
```

eventSource1 将接收“topic1”事件，而 eventSource2 将接收“topic2”事件。虽然这非常简单，但对于您感兴趣的每个主题都会发生挂起的 GET 也非常低效。

替代方法如下：

```
var EventSource eventSource3 = new EventSource("/events?id=1234")
eventSource3.addEventListener('topic3', topic3Listener, false);
eventSource3.addEventListener('topic4', topic4Listener, false);

var subscription = new XMLHttpRequest();
subscription.open("PUT", "/events/topic3?id=1234", true);
subscription.send(); 
```

在此示例中，将存在单个 EventSource，并且对特定事件的兴趣将由具有 Server-Sent Event 连接的单独请求指定，并且注册由 id 参数关联。topic3Listener 会收到“topic3”事件，而 topic4Listener 不会。虽然需要更多的代码，但好处是只建立了一个连接，但仍然可以以不同的方式识别和处理事件。

网络上有许多示例显示了命名事件的使用，但似乎事件名称（或主题）是预先知道的，因此客户端无需向服务器注册兴趣（[示例](http://hacks.mozilla.org/2011/06/a-wall-powered-by-eventsource-and-server-sent-events/)）。虽然我还没有看到显示多个 EventSource 对象的示例，但我也没有看到显示客户端使用单独的请求来注册对特定主题的兴趣的示例，就像我在上面所做的那样。我对规范的解释使我相信，表明对某个主题（或事件名称）的兴趣完全取决于开发人员，并且可以在客户知道它将要接收的事件名称的情况下静态完成或客户端动态地提醒服务器它有兴趣接收特定事件。

我很想听听其他人对这个话题的看法。注意：我通常是 Java 开发人员，所以请原谅我平庸的 JS 代码.. :)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-08T20:28:54.313

恕我直言，我强烈建议您`EventSource`为每个提供 SSE 的服务拥有一个对象，然后使用不同类型发出消息。

但最终，这取决于消息类型的相似程度。例如，如果您有 5 种不同类型的与用户相关的消息，请拥有一个用户`EventSource`并区分事件类型。

如果您有一种关于用户的事件类型，而另一种关于三明治的事件类型，我会说将它们放在不同的服务中，因此`EventSource`s。

将 EventSources 分解为与宁静服务相同的方式是一个好主意。如果您不会使用 AJAX 从同一个服务中获得两个东西，那么您可能不应该从同一个 EventSource 中获得它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-29T23:08:45.723

为了应对模糊和宽松的浏览器标准解释*，浏览器供应商对允许到单个域/端口的持久连接数实施不一致的限制。由于异步上下文的每个事件接收器都假定只要该接收器处于打开状态，就会分配一个持久连接，因此严格限制 EventSource 侦听器的数量以避免超出不同的供应商特定限制是至关重要的。实际上，这将您限制为每个应用程序大约 6 个 EventSource/async 上下文对。降级是正常的（例如，额外的 EventSource 连接请求只会等到插槽可用），但请记住，必须有可用于检索页面资源、响应 XHR 等的连接。

*W3C 已经发布了关于持久连接的标准，其中包含“……应该限制同时连接的数量……”这种语言意味着该标准不是强制性的，因此供应商的合规性是可变的。 [http://www.w3.org/Protocols/rfc2616/rfc2616-sec8.html#sec8.1.4](http://www.w3.org/Protocols/rfc2616/rfc2616-sec8.html#sec8.1.4)

# android - Android - 结合滑动和捏合缩放

> ID：11672210
> 
> 赞同：5
> 
> 时间：2012-07-26T15:00:39.990
> 
> 标签：android, imageview, gallery, swipe, pinchzoom

*   我们有支持刷卡的[图库](http://developer.android.com/reference/android/widget/Gallery.html)。
*   我们还有 3rd-party 组件支持 ImageView 上的捏合缩放，例如[ImageViewZoom](https://github.com/sephiroth74/ImageViewZoom/blob/master/ImageViewTouch/src/it/sephiroth/android/library/imagezoom/ImageViewTouch.java)中的[ImageViewTouch](https://github.com/sephiroth74/ImageViewZoom)。

**现在我想将它们结合起来。**

问题是滑动事件被[ImageViewTouch](https://github.com/sephiroth74/ImageViewZoom/blob/master/ImageViewTouch/src/it/sephiroth/android/library/imagezoom/ImageViewTouch.java)消耗，而被 Gallery 错过。

**两个组件如何消费事件？**

这将解决我的问题，因为最终，在一些事件之后，每个组件都会知道如何做出相应的反应。例如，如果第一个事件是[ACTION_DOWN](http://developer.android.com/reference/android/view/MotionEvent.html#ACTION_DOWN)，它可以是捏拉缩放的一部分或滑动的一部分。两个组件（Gallery 和 ImageViewTouch）都应该使用它，以便知道在后续事件中要做什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-18T19:32:31.923

我通过更改 ImageViewZoom 中的一些代码来组合这两个组件。如果事件被 ImageViewTouch 使用，更改是为了返回一个值。如果是这样，则不应将事件传递给画廊。如果 ImageView 没有使用该事件，则画廊应该使用它（如果可以的话）。

还有一些小问题，但它的功能。希望社区中的其他人可以提供帮助。

这是 github 上的分支：[https ://github.com/kilaka/ImageViewZoom](https://github.com/kilaka/ImageViewZoom)

谢谢。

# sql-server - 如何找出与某个表连接的表？

> ID：11672211
> 
> 赞同：0
> 
> 时间：2012-07-26T15:00:39.647
> 
> 标签：sql-server

我正在重构我的应用程序，我不再需要我的数据库表之一。我尝试删除它，但它给了我一个错误：

> 删除失败：“XYZ”。无法删除，因为它被外键约束引用

我怎样才能找出哪个表有这个表的外键列？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T15:06:56.603

右键单击对象探索中的表并查看依赖关系？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T15:12:28.333

您可以在此处获取列表（如果您想要数据库中所有 FK 约束的列表，请不要使用 where 子句）：

```
SELECT name, 
  QUOTENAME(OBJECT_SCHEMA_NAME(parent_object_id)) 
  + '.' + QUOTENAME(OBJECT_NAME(parent_object_id))
  + ' references ' 
  + QUOTENAME(OBJECT_SCHEMA_NAME(referenced_object_id)) 
  + '.' + QUOTENAME(OBJECT_NAME(referenced_object_id))
FROM sys.foreign_keys
WHERE OBJECT_NAME(referenced_object_id) = N'XYZ'; 
```

要生成一个drop，你可以说：

```
DECLARE @sql NVARCHAR(MAX);
SET @sql = N'';

SELECT @sql = @sql + '
  ALTER TABLE ' + 
  QUOTENAME(OBJECT_SCHEMA_NAME(parent_object_id)) 
  + '.' + QUOTENAME(OBJECT_NAME(parent_object_id))
  + ' DROP CONSTRAINT ' + QUOTENAME(name) + ';'
FROM sys.foreign_keys
WHERE OBJECT_NAME(referenced_object_id) = N'XYZ';

EXEC sp_executesql @sql; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T15:13:53.073

试试这个

```
 select * from sys.foreign_keys fk  where referenced_object_id = object_id(<tablename>) 
```

# sql - 使用多个 case When 语句

> ID：11672213
> 
> 赞同：1
> 
> 时间：2012-07-26T15:00:44.077
> 
> 标签：sql

我有一个`Case When`工作正常的声明：

```
sum(CASE WHEN datepart(dw,applydtm) = '1'
         then (cast(durationsecsqty as float)/3600)
         else 0
     End
   ) as Sunday 
```

`WHEN`但是当它到达时我需要添加另一个`(cast(durationsecsqty as float)/3600)`。此时如果返回结果是`0`我想从另一列中提取值，`moneyamt`.

我正在尝试将此声明与我的第一个声明结合起来：

```
Case (CAST(durationsecsqty as float)/3600)
     when 0
     then moneyamt
     else (CAST(durationsecsqty as float)/3600)
 end as Sunday 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T15:06:08.890

听起来你需要这个：

```
sum(
    CASE 
        WHEN datepart(dw,applydtm) = '1' 
        then 
            CASE
                WHEN Case (CAST(durationsecsqty as float)/3600) = 0
                THEN moneyamt
                ELSE (CAST(durationsecsqty as float)/3600)
            END (cast(durationsecsqty as float)/3600) 
        else 0 
   End) as Sunday 
```

# c# - 通过文本框更改过滤datagridview

> ID：11672218
> 
> 赞同：1
> 
> 时间：2012-07-26T15:00:50.450
> 
> 标签：c#, winforms, linq-to-sql, filtering

通过 WinForms 中的 bindingsource 控制使用 Linq to sql，我无法让它工作：

```
private void textBox1_TextChanged(object sender, EventArgs e)
{
            productBindingSource.Filter = string.Format("ProductName LIKE '*{0}*'", textBox1.Text);
            MessageBox.Show("Changed");
}
        NorthwindDataContext dc;
        private void FrmFilter_Load(object sender, EventArgs e)
    {
        // create new data context
        dc = new NorthwindDataContext();

        // set the binding source data source to the full order table
        var qry = (from p in dc.Products select p).ToList();
        this.productBindingSource.DataSource = dc.GetTable<Product>();
    } 
```

当我在文本框中键入一些字母时，datagridview 中没有任何反应。感谢您的建议...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T15:17:13.807

尝试将您的代码更改为如下所示：

```
NorthwindDataContext dc;

private void FrmFilter_Load(object sender, EventArgs e)
{
  dc = new NorthwindDataContext();
  this.productBindingSource.DataSource = dc.GetTable<Product>();
  productDataGridView.DataSource = productBindingSource;
}

private void textBox1_TextChanged(object sender, EventArgs e)
{
  this.productBindingSource.Filter = string.Format("ProductName LIKE '*{0}*'",
                                     textBox1.Text);
} 
```

确保您的 TextChanged 事件已连接并实际运行。另外，我从示例中删除了 qry ，因为您没有在发布的代码中的任何地方使用它。

* * *

**较早的编辑：**

您不必在网格上重置 DataSource。

尝试将其更改为：

```
private void textBox1_TextChanged(object sender, EventArgs e) {
  if (textBox1.Text == string.Empty) {
    productBindingSource.RemoveFilter();
  } else {
    productBindingSource.Filter = string.Format("ProductName LIKE '*{0}*'", _
                                  textBox1.Text);
  }
} 
```

我现在会避免担心替换那些特殊字符。先让过滤器工作。

* * *

这是一个在表单上只有一个 DataGridView 和一个 TextBox 的工作示例：

```
private DataTable dt = new DataTable("Test");
private BindingSource bs;

public Form1() {
  InitializeComponent();

  dt.Columns.Add("ProductName", typeof(string));

  DataRow dr1 = dt.NewRow();
  dr1["ProductName"] = "One A";
  dt.Rows.Add(dr1);

  DataRow dr2 = dt.NewRow();
  dr2["ProductName"] = "One B";
  dt.Rows.Add(dr2);

  DataRow dr3 = dt.NewRow();
  dr3["ProductName"] = "Two A";
  dt.Rows.Add(dr3);

  DataRow dr4 = dt.NewRow();
  dr4["ProductName"] = "Two B";
  dt.Rows.Add(dr4);

  bs = new BindingSource(dt, null);
  dataGridView1.DataSource = bs;
}

private void textBox1_TextChanged(object sender, EventArgs e) {
  if (textBox1.Text == string.Empty) {
    bs.RemoveFilter();
  } else {
    bs.Filter = string.Format("ProductName LIKE '*{0}*'", textBox1.Text);
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-11-26T11:17:00.560

这项工作对我来说很好！

```
this.productBindingSource.Filter = null; 
```

# javascript - 通过 Google Chrome 使用 javascript 传递参数

> ID：11672221
> 
> 赞同：0
> 
> 时间：2012-07-26T15:01:00.957
> 
> 标签：javascript, google-chrome, parameter-passing, url-parameters

所以我一直在根据这里列出的一个小部件工作：http: [//php-drops.blogspot.com/2011/04/creating-widget-with-javascript-and-php.html](http://php-drops.blogspot.com/2011/04/creating-widget-with-javascript-and-php.html)

用户我正在尝试创建小部件的预览功能，以便用户可以检查它的外观。我这样做的方式是将“复制和粘贴”代码部分传递给“预览”页面可以抓取和回显的参数。这在 Firefox 和 ie 中运行良好，但在 Chrome 中显示空白页。

当我在 Chrome 中的空白页面上查看源代码时，源代码与 firefox 和 ie 中的相同。当我将“查看页面源”中的代码复制并粘贴到新页面上时，它在 Chrome 中完美显示。

谁能指出我应该寻找的正确方向？我是否通过在参数中传递 javascript 来打破某种规则——firefox 和 ie 不关心但 Chrome 关心的规则？

这是我正在尝试做的简化版本：

[http://imaginarydomain.com/widget/example.php?widget_script=%3Cscript+type%3D%22text%2Fjavascript%22%3Edocument.write](http://imaginarydomain.com/widget/example.php?widget_script=%3Cscript+type%3D%22text%2Fjavascript%22%3Edocument.write) ('hello%20world')%3C%2Fscript%3E

在 chrome 上查看页面源代码将显示：

```
 <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"> 
         <html><head></head><body><script type="text/javascript">document.write('hello world')</script>
        </body></html> 
```

但是页面会是空白的。

太感谢了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T17:13:40.457

这可能是由于 Chrome 的 XSS 攻击过滤器阻止了 javascript 的通过。

当我检查了 chrome 上的 javascript 控制台时，我得到了

“拒绝执行 JavaScript 脚本。在请求中找到脚本的源代码。”

在快速浏览了如何处理之后，我发现没有一个选项非常有吸引力。

# r - 删除向量中的特定元素组？

> ID：11672227
> 
> 赞同：20
> 
> 时间：2012-07-26T15:01:13.133
> 
> 标签：r

> **可能重复：**
> [如何从向量中删除多个值？](https://stackoverflow.com/questions/9665984/how-to-delete-multiple-values-from-a-vector)

是否有任何内置函数允许我们删除向量中的特定元素组？

例子：

```
x<-c(2, 4, 6, 9, 10) 
```

`c(4,9,10)`从中删除向量`x`

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-07-26T15:05:17.207

您可以通过多种方式做到这一点，这是一种：

```
x[!x %in% c(4, 9, 10)] 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-07-26T15:18:48.713

或者你可以使用`?is.element`

```
x[!is.element(x, c(4,9,10))] 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-07-26T15:53:24.943

这可能很有用

```
 x<-c(2, 4, 6, 9, 10)
 y <- c(4,9,10)
 setdiff(x, y)
 2 6 
```

# c# - 在子字符串后连接模型末尾的省略号

> ID：11672229
> 
> 赞同：0
> 
> 时间：2012-07-26T15:01:15.073
> 
> 标签：c#, asp.net-mvc

这可能很容易，但我很难找到正确的语法。基本上我正在使用子字符串来缩短一条线，然后我只想在最后添加一个“...”。我似乎无法找到正确的方法来做到这一点。

```
@if (@Model.Name.Length > 20)
{
    @Model.Name.Substring(0, 20) //"..." goes here
}
else
{
    @Model.Name
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:11:08.230

```
@string.Concat(Model.Name.Substring(0,20), "...") 
```

甚至：

```
@(Model.Name.Substring(0, 20) + "...") 
```

# facebook - Chrome 扩展：facebook 上的内容脚本

> ID：11672230
> 
> 赞同：3
> 
> 时间：2012-07-26T15:01:16.880
> 
> 标签：facebook, google-chrome-extension

我正在为 facebook 创建一个 chrome 扩展。我需要在每个页面上执行相同的内容脚本。它在第一次加载时运行良好，但是当我通过链接（作为个人资料名称）进入 Facebook 页面时它不起作用。我读到这是因为除了第一次之外没有加载整个页面。所以脚本不会再次执行。但是我不知道如何解决这个问题。

这是我的 manifest.json ：

```
{
    "name" : "name",
    "version" : "1.0",
    "manifest_version":1,
    "description" : " description ",
    "content_scripts" : [
            {
              "matches" : ["http://www.facebook.com/*"],
              "js" : ["test.js"]
            }   
    ] ,
    "all_frames":"true"  
} 
```

我希望有人能给出答案，因为我真的需要每次都在每个页面上执行脚本（test.js，它不会更改 html 或 css）！

感谢您未来的回答。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-20T21:26:15.483

我个人通过使用 Chrome 的 webRequest API 解决了这个问题。您需要添加一个监听器来跟踪 AJAX 生成的 HTTP 调用。这基本上是我使用的代码：

```
chrome.webRequest.onCompleted.addListener(function(details) {
    var url = document.createElement('a');
    url.href = details.url;
    if (url.search && url.search.indexOf('ajaxpipe=1') !== -1) {
        console.log('New page via AJAX.');
        chrome.tabs.executeScript({'file' : 'test.js'});
    }
}, {urls : ["*://*.facebook.com/*"]}); 
```

# postgresql - 如何创建 Postgres 到 Postgres 外部数据表

> ID：11672232
> 
> 赞同：2
> 
> 时间：2012-07-26T15:01:24.670
> 
> 标签：postgresql

我需要访问远程 Postgres 数据库中的表。昨晚我花了几个小时阅读文档，这就是我想出的。

```
-- surely this thing is already written somewhere?
CREATE FUNCTION pgsql_fdw_handler()
    RETURNS fdw_handler
    AS '?????' LANGUAGE C STRICT;

-- surely this thing is already written somewhere?
CREATE FUNCTION pgsql_fdw_validator(text[], oid)
    RETURNS void
    AS '????' LANGUAGE C STRICT;

CREATE FOREIGN DATA WRAPPER pgsql
    HANDLER pgsql_fdw_handler
    VALIDATOR pgsql_fdw_validator;

CREATE SERVER products_remote FOREIGN DATA WRAPPER pgsql OPTIONS
    (host 'localhost', dbname 'product_db', port '1234');

CREATE USER MAPPING FOR CURRENT_USER
    SERVER products_remote;

CREATE FOREIGN TABLE products (
  name text,
  id integer
) SERVER products_remote;

select * from products; 
```

我不知道要为处理程序和验证器函数做什么，它们是否存在于某个地方？我需要自己写吗？（那会是什么样子？）并且希望对整体方法进行验证。

我确实找到[了这个](https://commitfest.postgresql.org/action/patch_view?id=667)contrib 模块，但它显然不完整。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T10:25:41.110

首先，您需要获取[pgsql_fdw 代码](http://sourceforge.net/scm/?type=git&group_id=565635)。我找不到 tarball，所以你被 git clone 卡住了。为拿到它，为实现它：

```
git clone git://interdbconnect.git.sourceforge.net/gitroot/interdbconnect/interdbconnect
cd interdbconnect/pgsql_fdw
make USE_PGXS=1
make USE_PGXS=1 install; 
```

然后登录到pgsql

```
CREATE EXTENSION pgsql_fdw;

create foreign data wrapper postgresql  handler pgsql_fdw_handler;
create server lsmb foreign data wrapper postgresql options (host 'localhost', dbname  'mtech_test', port '5432');
create user mapping for current_user server lsmb;
create foreign table defaults (setting_key text, value text) server lsmb;
select * from defaults; 
```

然后这对我有用。

我不知道 pgsql_fdw 是否包含在 9.2 的 contrib 中。

# c# - XCeed Datagrid 绑定双向

> ID：11672236
> 
> 赞同：1
> 
> 时间：2012-07-26T15:01:31.143
> 
> 标签：c#, wpf, datagrid, xceed-datagrid, xceed

我对带有 WPF 的高级 Datagrid 的 XCeed 工具有疑问。我在对象的 observableCollection 上创建了一个数据网格绑定，它可以工作（对象成为数据网格的线）。但是绑定仅在 OneWay 中，我不知道为什么。你有什么主意吗 ？

PS：我在任何地方都选择双向模式，并且数据网格的所有组件（以及数据网格本身）的只读属性为假

# c# - 在微软报表查看器中使用数据表作为数据源

> ID：11672237
> 
> 赞同：0
> 
> 时间：2012-07-26T15:01:31.480
> 
> 标签：c#, asp.net, datatable, reportviewer

是否可以将数据表用作 reportviewer 组件的数据源？您能否提供参考或简单的步骤如何做到这一点？

还有一件重要的事情：我正在使用reportviewer for webforms (ASP.net)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T15:10:30.907

尝试这样的事情。

```
this.reportViewer.LocalReport.DataSources.Clear(); 
DataTable dt = new DataTable(); 
dt = this.inputValuesTableAdapter.GetData();     

Microsoft.Reporting.WinForms.ReportDataSource rprtDTSource = new Microsoft.Reporting.WinForms.ReportDataSource(dt.TableName, dt); 

this.reportViewer.LocalReport.DataSources.Add(rprtDTSource); 
this.reportViewer.RefreshReport(); 
```

希望能帮助到你

# verilog - 为什么我的 D 触发器不等待时钟的上升沿？

> ID：11672239
> 
> 赞同：5
> 
> 时间：2012-07-26T15:01:35.523
> 
> 标签：verilog

正如我所知，D 触发器在时钟的每个上升沿对其输入值进行采样。

因此，它将产生 1 个周期的延迟。对？

但是为什么我的 D 触发器不产生 1 个周期的延迟呢？

```
 module flipflop(
             input clk,
             input rstn,
             input [7:0] i_data,
             output reg [7:0] o_data
         );

             always @(posedge clk) begin
                     if (~rstn) begin
                             o_data <= 0;
                     end
                     else begin
                             o_data <= i_data;
                     end
             end
         endmodule

       module test;
           reg clk;
           reg [7:0] i_data;
           reg rstn;
           wire [7:0] o_data;

           initial begin
                   clk = 0;
                   rstn = 1;
                   i_data = 0;
                   #20;
                   rstn = 0;

                   #30;
                   rstn = 1;
                   #20;
                   i_data = 8'hFA;
                   #20;
                   i_data = 8'hF0;
                   #20
                   i_data = 8'hF1;
                   #20
                   #10 $finish;
           end

           always #10 clk = !clk;

           flipflop flipflop(
                   .clk (clk),
                   .rstn(rstn),
                   .i_data(i_data),
                   .o_data(o_data)
           );

           initial begin
                   $dumpfile("flipflop.vcd");
                   $dumpvars();
           end
       endmodule 
```

![dff 没有延迟](../Images/4e45da71197b034c6baa095525f83ff3.png)

我的 D 触发器在这里就像一个组合电路。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-26T15:47:23.613

您遇到了 Verilog 模拟器事件调度的微妙之处！更改数据分配以使用非阻塞分配可能是最简单的解决方法。

```
#20;
i_data <= 8'hFA;
#20;
i_data <= 8'hF0;
#20
i_data <= 8'hF1;
#20 
```

在您的原始版本中发生的事情是时钟和输入数据被安排在同一时间发生。由于模拟器一次只能做一件事，它必须决定是先改变时钟还是改变数据。它首先更改了数据，因此当时钟沿到来时，输入数据已经更改为下一个值，因此看起来数据正在滑过 FF。

非阻塞分配 ( `<=`) 计划在所有阻塞分配 ( `=`) 完成后发生。因此，使数据分配无阻塞可确保它们发生在分配阻塞的时钟沿之后。

另一种重写工作的方法是：

```
initial begin
   @(posedge clk) i_data = 8'hFA;
   @(posedge clk) i_data = 8'hF0;
   @(posedge clk) i_data = 8'hF1;
end 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-26T20:51:27.020

模拟器可能正在做这样的事情：

```
 initial begin
               clk = 0;
               rstn = 1;
               i_data = 0;
               #10;
               clk = !clk;
               #10;
               rstn = 0;
               clk = !clk;

               #10;
               clk = !clk;
               #10;
               clk = !clk;
               #10;
               rstn = 1;
               clk = !clk;
               #10;
               clk = !clk;
               #10
               i_data = 8'hFA; //Input updated
               clk = !clk;     //Clock event
                               //o_data assigned here
               #10;
               clk = !clk;
               #10;
               i_data = 8'hF0;
               clk = !clk;
               #20
               i_data = 8'hF1;
               #20
               #10 $finish;
       end 
```

由于时钟事件在您的测试平台的每个时间步中最后发生，因此看起来翻牌是立即分配的。您可能希望您的测试台完全不受时钟限制，因此 Marty 使用 @(posedge...) 的建议将实现这一点。你也可以在一开始就简单地推迟一次你的作业：

```
 initial begin
               clk = 0;
               #1;
               rstn = 1;
               i_data = 0;
               #20;
               rstn = 0;

               #30;
               rstn = 1;
               #20;
               i_data = 8'hFA;
               #20;
               i_data = 8'hF0;
               #20
               i_data = 8'hF1;
               #20
               #10 $finish;
       end 
```

# php - PHP , Mysql , 在数据库中搜索

> ID：11672242
> 
> 赞同：-3
> 
> 时间：2012-07-26T15:01:42.907
> 
> 标签：php, mysql

当 PHP 变量中包含特定列值时，我想返回特定表中的所有行，例如：第 34 行：列 'xyz' 值等于 = "rabbit" 并且我的 php 变量是`$var = "rabbit,robert,teen"`，并且因为“ xyz”列值包含在`$var`我希望它被选中。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T15:16:57.627

将逗号分隔的列表转换为 sql 格式并放在查询中

```
$query = "select blah blah WHERE xyz IN ('".str_replace("," ,"','", $var)."');" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T15:13:42.123

如果我正确理解了您的问题，那么您正在寻找这样的东西：

```
$arr = explode(',', $var);
$where_in_val = '';
foreach($arr as $value){
  $where_in_val.= "'$value',";
}
$where_in_val = substr($where_in_val,0,-1); 
```

那么您的查询可能是这样的

```
SELECT * FROM my_table WHERE xyz IN ($where_in_val) 
```

注意：不要忘记清理/转义/清理用户的输入。

# java - “即时”编辑大型 xml 文件

> ID：11672244
> 
> 赞同：3
> 
> 时间：2012-07-26T15:01:45.417
> 
> 标签：java, xml

我有一个 xml 文件存储在数据库 blob 中，用户将通过 spring/hibernate Web 应用程序下载该文件。在通过 Hibernate 将其作为 byte[] 检索后，但在将其发送到输出流之前，我需要编辑 XML 的某些部分（具有两个子节点和一个属性的单个节点）。

我担心的是如果文件更大（有些是 40mb+），那么我真的不想通过将整个文件放在内存中，编辑它然后通过输出流将它传递给用户来做到这一点。有没有办法“即时”编辑它？

```
byte[] b = blobRepository.get(blobID).getFile();
// What can I do here?
ServletOutputStream out = response.getOutputStream();
out.write(b); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T15:24:12.577

您可以使用 SAX 流。

使用 SAX 框架解析文件，当您的处理程序接收到 SAX 事件时，将未更改的项目传回给构造 XML 输出的 SAX 处理程序。

当您到达“要更改的部分”时，您的中间类将读入不需要的事件，并写出想要的事件。

这样做的好处是不会将整个文件作为中间表示（比如 DOM）保存在内存中；但是，如果转换很复杂，您可能必须缓存许多项目（文档的部分），以使它们可用于重新排列的输出。一个足够复杂的转换（一个可以做任何事情的转换）最终会变成 DOM 的开销，但是如果您知道您忽略了文档的大部分，则可以节省大量内存。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T15:44:10.950

您可以尝试以下方法：

1.  在 Hibernate 中启用二进制数据流（将**hibernate.jdbc.use_streams_for_binary**设置为 true）
2.  **使用ent.getBlob().getBinaryStream()**将 xml 文件作为二进制流接收
***   使用支持流式处理（例如 saxon）的 XSTL 处理器处理输入流，将输出直接重定向到 servlet OutputStream：**javax.xml.transform.Transformer.transform( *SAXSource* , new StreamResult(response.getOutputStream()))****

# windows - 通过 Windows 桌面快捷方式运行 Eclipse JVM 参数

> ID：11672249
> 
> 赞同：1
> 
> 时间：2012-07-26T15:01:53.357
> 
> 标签：windows, eclipse, jvm

我想通过 Windows 上的桌面快捷方式运行 Eclipse，您可以在命令行上使用 -Duser.timezone 参数。

我的快捷方式目标如下所示：

```
C:\Alan\SDK\3.7.1\eclipse.exe -vm "c:\Program Files\Java\jdk1.6.0_22\bin\javaw.exe" -vmargs -Xmx512m -Xmx1024M -XX:PermSize=128M -XX:MaxPermSize=256M 
```

如您所见，我使用 -X.. 参数增加了内存空间。无论出于何种原因，尽管我无法在 -vmargs 条目之后键入 -Duser.timezone=Europe/Dublin。难道不能通过捷径做到这一点吗？我可以从命令行使用这个 -D 参数没问题。

编辑：我会将其添加到 .ini 文件中，但不允许这样做！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T18:40:45.690

您必须**在 VM 参数切换之前**添加程序参数。从[vmargs 文档](http://help.eclipse.org/helios/index.jsp?topic=/org.eclipse.platform.doc.user/tasks/running_eclipse.htm)：

> -vmargs 条目之后的所有参数（但不包括）作为虚拟机参数直接传递给指定的 Java VM。

# java - 使用案例陈述

> ID：11672250
> 
> 赞同：4
> 
> 时间：2012-07-26T15:01:54.383
> 
> 标签：java, switch-statement

我使用 int[] 数组作为参考。我想知道我对 case 语句的使用是否合理，或者它是否会导致错误。

这是我的代码：

```
 int switcheroo = intarray[0];
    int foo = intarray[1];
    boolean size = false; 
    boolean biggersize = false;

    switch (switcheroo) {

    case 0:
        switch (foo) {
        case 1:
            doSomething(switcheroo); //change switcheroo somehow.
            break;
        case 2: 
            doSomethingElse(switcheroo); //change switcheroo differently.
            break;
        }
    case 1:
        size = true;
        break;
    case 2: 
        biggersize = true;
        break;
    default:
        break;
    } 
```

除非是巧合，否则这将按照我的意愿将嵌套 case 语句的更改影响到其他情况。

我的问题是：

这种嵌套会导致麻烦吗？

是缺少休息；在一个案例不好的做法之后？

谢谢。

编辑：在 switch 语句中间更改 switcheroo 的方法被放在那里以响应该问题。我不会这样做这是我的程序。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-26T15:05:53.167

嵌套不会完全造成麻烦，但它可能会令人困惑。添加评论和/或其他文档将真正帮助未来的编码人员（以及一周内的您自己！）通过查看它来理解这一点。

没有休息本身并不是一个坏习惯，但它是大多数情况下的陈述，所以我会在最后添加一个评论，比如`// no break, allow fall-through`.

因此，这两种情况都归结为良好的文档。

这些点与我不认为这段代码做你认为它会做的事情是垂直的。

`case`每次遇到一个子句时都不会重新评估该子句 - 它们只是跳转到切换的点。因此，在您的示例中，如果您从 开始，您将**始终**以- 您永远不会以from结束。`case 1``case 0``case 2``case 0`

如果我要对其进行重组，这就是我要做的。而不是使用`int`，我会使用`enum`：

```
enum Foo { GOOD_FOO, BAD_FOO }
enum Switcharoo { BAR, BAZ, BAQ, ESCAPE }
enum Size { NONE, REGULAR, BIGGER }

Foo foo = ... // assigned somewhere
Switcharoo roo = ... // assigned somewhere
Size size = NONE;

// use a while loop to reevalulate roo with each pass
while(roo != Switcharoo.ESCAPE) {
    switch(roo){
        case BAR:
                switch(foo) {
                    case GOOD_FOO: foo = doSomething(foo); break;
                    case BAD_FOO: foo = doSomethingElse(foo); break;
                }
            break;
        case BAZ:
            roo = Switcharoo.ESCAPE;
            size = Size.REGULAR;
            break;
        case BAQ:
            roo = Switcharoo.ESCAPE;
            size = Size.BIGGER;
            break;

    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T15:05:33.993

RE：*是缺少休息吗？在一个案例不好的做法之后？*

如果您在每个 case 语句后不包含中断，则流程将继续通过下一个语句，因此将执行多个选项的代码。

来自 Java 教程：

> 另一个有趣的地方是 break 语句。每个 break 语句都会终止封闭的 switch 语句。控制流继续 switch 块之后的第一条语句。break 语句是必要的，因为没有它们，switch 块中的语句就会失败：匹配 case 标签之后的所有语句都按顺序执行，无论后续 case 标签的表达式如何，直到遇到 break 语句。

检查[http://docs.oracle.com/javase/tutorial/java/nutsandbolts/switch.html](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/switch.html)以了解有关 switch 语句的更多详细信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T15:06:04.183

如果`foo`不是 1 也不是 2，switcheroo 应该继续`case 1`吗？如果是，那么您的代码是正确的。如果没有，你需要在之前添加一个break`case 1`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T15:08:28.313

`switch`运算符是一种条件`if`运算符。并且一堆 if 运算符可能会报告您需要在代码中涉及对象多态性，而不是制作连续的 if-switch 运算符。

考虑将数据重新排列到类/对象并使用多态方法处理它们。它将使您的代码更可靠、更易于管理且更美观。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-26T15:08:49.847

我不确定我是否理解您的第一个问题，您能否给我更多信息（可能是具体的）？

关于第二个问题，case后面没有break语句没有错，只要你知道代码会继续执行直到找到break语句。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-26T15:09:17.920

如果只有 2 个备选方案，请选择 if/else。更少的代码行，没有`break`问题。

> 这种嵌套会导致麻烦吗？

一个问题是这样的开关嵌套很难阅读：在我注意到您使用的是嵌套开关之前，我不得不查看代码两次。这可能是一个维护问题，但这不是不使用嵌套开关的理由，只需*谨慎*使用它，调整缩进以阐明发生了什么，并评论使用情况。

> 是缺少休息；在一个案例不好的做法之后？

通过省略 `break`失败也会导致维护/调试问题，但我不认为这是不好的做法。毕竟，它是`switch`声明设计中固有的。*失败的*评论总是受欢迎的，这样下一个人 - 或者你，几个月后重新访问你的代码 - 知道失败是故意的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-26T15:10:36.540

好吧..看来您在这里唯一缺少的是可读性。仅当您被迫这样做时才进行这种类型的嵌套。

```
Is the lack of a break; after a case bad practice? 
```

不错，而是避免异常行为是一种好习惯。如果没有此中断，您的代码将继续执行到您的最后一个案例。

在你的第一个外壳中添加 break 。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-07-26T15:23:21.357

我建议避免结合使用嵌套和跌落。至少就个人而言，我倾向于期望每个都`case`以 a 结尾`break`，所以我只会在它很容易发现并且导致比 a 更清晰的代码的情况下使用 fallthrough `if..else`，例如：

```
switch (foo) {
    case 0:
    case 1:
        doSomething();
        break;

    case 2:
        doSomethingElse();
        break;

    default:
        break;
} 
```

也就是说，使用空的或非常简单（一个语句）`case`的主体。在您的情况下，将第`case`一个主体重构为方法可能会起作用：

```
void changeSwitcheroo(int foo, int switcheroo) {
    switch (foo) {
        case 1:
            doSomething(switcheroo); //change switcheroo somehow.
            break;
        case 2: 
            doSomethingElse(switcheroo); //change switcheroo differently.
            break;
    }
}

// ...

int switcheroo = intarray[0];
int foo = intarray[1];

switch (switcheroo) {
    case 0:
        changeSwitcheroo(foo, switcheroo);
    case 1:
        size = true;
        break;
    case 2: 
        biggersize = true;
        break;
    default:
        break;
} 
```

（这主要是在争论可读性和风格。switch的含义仍然是“如果switcheroo是`1`，跳转到case中间`0`。）

# php - 导出到excel时删除HTML标签

> ID：11672251
> 
> 赞同：0
> 
> 时间：2012-07-26T15:01:54.900
> 
> 标签：php, javascript, excel

我正在使用此脚本将 html 表导出到 excel 文件，但我在表中有图像标签，所以我想在脚本导出到 excel 时删除该标签。这是我正在使用的脚本

```
<script type="text/javascript">
       var tableToExcel = (function() {
         var uri = 'data:application/vnd.ms-excel;base64,'
        , template = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>'
        , base64 = function(s) { return window.btoa(unescape(encodeURIComponent(s))) }
        , format = function(s, c) { return s.replace(/{(\w+)}/g, function(m, p) { return c[p]; }) }
         return function(table, name) {
        if (!table.nodeType) table = document.getElementById(table)
        var ctx = {worksheet: name || 'Worksheet', table: table.innerHTML}
        window.location.href = uri + base64(format(template, ctx))
         }
       })()
       </script>

       <input type="button" onclick="tableToExcel('datatable', 'W3C Example Table')" value="Export to Excel"> 
```

![这是导出的 excel 工作表的快照。 由于所有图像标签，它显示十字符号。 我想删除那些图像。](../Images/71ca288dedb0d2b0fd55ee0a438574c4.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:19:45.103

您可以删除`<img>`这样的标签：

```
table: table.innerHTML.replace(/<\s*img[^>]*>/gi,''); 
```

[**演示**](http://jsfiddle.net/5cVrX/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-10T07:23:59.230

```
$("#btnExport").click(function(e) {
   window.open('data:application/vnd.ms-excel,' + encodeURIComponent($('#export').html()));
}); 
```

# google-closure - 如何使用单个事件节点将事件分配给多个子 DOM 元素？

> ID：11672257
> 
> 赞同：3
> 
> 时间：2012-07-26T15:02:11.360
> 
> 标签：google-closure, google-closure-library

在我的 Google Closure 代码中，我想为 div 中的每个跨度分配一个事件。

HTML：

```
 <div id="container">
    <span>foo</span>
    <span>bar</span>
    <span>bacon is delicious</span>
  </div> 
```

关闭Javascript：

```
 var container = goog.dom.getElement('container');
  var spans = goog.dom.getChildren(container);
  for (var i = 0; i < spans.length; i++) {
    eventHandler.listen(
        spans[i],
        goog.events.EventType.CLICK,
        function (e) {
          doSomeStuff(e.target);
        }
  } 
```

这个循环似乎效率低下，因为它似乎为每个跨度元素分配了一个事件节点。我可以以某种方式将单个事件节点分配给包含 div，并在跨度上的单击事件冒泡到包含 div 时运行回调函数吗？

`live()`在 jQuery 中，我相信和函数之间的区别与`delegate()`我在这里处理的问题相似。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T15:11:06.250

我从未使用过 Google Closure，但您已经在使用`e.target`. 只需向容器中添加一个侦听器，您就可以使用`e.target`.

```
var container = goog.dom.getElement('container');

eventHandler.listen(
    container,
    goog.events.EventType.CLICK,
    function (e) {
        doSomeStuff(e.target);
    }); 
```

# javascript - d3.js 中的多个重力点

> ID：11672266
> 
> 赞同：2
> 
> 时间：2012-07-26T15:02:36.633
> 
> 标签：javascript, graphics, graph, physics, d3.js

不确定我是否使用了正确的术语，所以这个问题可能已经在 stackoverflow 的某个地方得到了回答（如果是，请告诉我）。有没有办法在 d3.js 图中指定多个“重力点”，其中重力点是每个集群中具有固定 (x,y) 值的一个节点？例如，我正在使用[此示例](http://bl.ocks.org/2920551)中的代码来显示集群。我的图表看起来的唯一区别是节点之间会有链接（也可能链接到其他集群中的节点）。我想确保其他集群尽可能少地重叠，并且仍然显示每个集群之间的任何链接。

我试过 force.gravity(0.1) 和 force.charge(-10)。这似乎使集群保持分开，但随着重力的增加，集群间的距离继续减小，因为默认情况下只有一个“重力点”位于图表的中间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T04:55:21.810

我能想到的唯一方法是添加一个要保持重力的节点，并将其电荷指定为较大的正值，其余节点应具有负值电荷。希望他们会互相吸引。如果您找到了更好的解决方案，请告诉我。

# android - 在蓝牙聊天中单击按钮后，用户输入警报对话框未打开

> ID：11672269
> 
> 赞同：0
> 
> 时间：2012-07-26T15:02:46.427
> 
> 标签：android, bluetooth, android-alertdialog

嗨，我是一个 android 新手，我已经被困了一个星期。任何帮助，将不胜感激！我做了很多研究，无法弄清楚什么是错的。我已经在两部手机上成功运行了蓝牙聊天示例代码，并通过蓝牙成功通信。我还成功编写并运行了一个独立应用程序，在单击主活动按钮后，会打开一个接受用户输入的自定义警报对话框，并将输入传递回主活动。但是当我将 alertdialog 代码写入 BluetoothChat 代码时，单击按钮时没有任何反应。我试图用手机单步调试调试器，但没有成功。它似乎没有进入包含按钮单击的代码。没有错误显示。为什么单击按钮时不会弹出警报对话框？这里'

```
public class BluetoothChat extends Activity implements OnClickListener{

  final Context context = this;
  private Button rButton;
  View rScreen;
  private EditText mAlertDialog;

  @Override
  public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    if(D) Log.e(TAG, "+++ ON CREATE +++");

    // Set up the window layout
    setContentView(R.layout.main);

    // Get local Bluetooth adapter
    mBluetoothAdapter = BluetoothAdapter.getDefaultAdapter();

    // If the adapter is null, then Bluetooth is not supported
    if (mBluetoothAdapter == null) {
      Toast.makeText(this, "Bluetooth is not available", Toast.LENGTH_LONG).show();
      finish();
      return;
    }

    //components from main.xml
    //When button is clicked, the alert dialog is pulled up
    rButton = (Button)findViewById(R.id.buttonr);
    mAlertDialog = (EditText)findViewById(R.id.edittextresultm);

    //add button listener
    rButton.setOnClickListener(new OnClickListener() {

      //@Override
      public void onClick_register(View view) {   

        String title = "title";
        String buttonOk = "OK";
        String buttonCancel = "Cancel";
        String madd, name;

        //get review.xml view
        LayoutInflater li = LayoutInflater.from(context);
        View rView = li.inflate(R.layout.review, null);

        //AlertDialog dialog;   
        AlertDialog.Builder adRegister = new AlertDialog.Builder(context);

        //set review.xml to adRegister builder
        adRegister.setView(rView);

        //set title
        adRegister.setTitle(title);

        //Set EditText views to get user input

        final EditText mField = (EditText)rView.findViewById(R.id.editTextm);
        final EditText nField = (EditText)rView.findViewById(R.id.editTextn);

        //set dialog message
        adRegister.setMessage("Message")
          .setCancelable(false)
          .setPositiveButton(buttonOk, new DialogInterface.OnClickListener() {

          public void onClick(DialogInterface dialog, int which) {

            String madd = mField.getText().toString();
            String name = nField.getText().toString();

            //get user input and set it to result on main activity
            mAlertDialog.setText(mField.getText());
          }
        })
        .setNegativeButton(buttonCancel, new DialogInterface.OnClickListener() {

          public void onClick(DialogInterface dialog, int which) {
            // TODO Auto-generated method stub
            //if this button is clicked, close current activity
            dialog.cancel();

          }
        });

        //Create alert dialog
        AlertDialog alertDialog = adRegister.create();
        //dialog= adRegister.create();
        //show it
        adRegister.show();
        //dialog.show();
      }

      public void onClick(View arg0) {
        // TODO Auto-generated method stub
      }
    });
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:46:36.110

在 OnClick 方法中编写您的 inputDialog 代码。

享受！！

# sql - 用于排名的 SQL 选择查询

> ID：11672273
> 
> 赞同：-1
> 
> 时间：2012-07-26T15:02:57.223
> 
> 标签：sql, select

我有`logs`一个名为记录谁输入或输出数据的表。现在我不想得到谁贡献最多的统计数据并对其进行排名。

列是

```
 Occur_Time | iUser_id | iUsername | oUser_id | oUsername
 --iUser_id is the input persons index from another table that lists the username.
 --iUsername is the input persons name.
 --oUser_id is the index of the person who took the input away.
 --oUsername is the name of the person who took the input away. 
```

现在我想知道谁的投入最多。

我的逻辑：

```
 Example:
     User_id is 1, name is One.
     Check how many times 1 is repeated on iUser_id = 100 times.
     Check how many times 1 is repeated on oUser_id = 10 times.
     User_id=1 has contributed 90 times.
     Then sort by who has most contribution. 
```

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T15:05:57.147

该`Rank`功能可能是您正在寻找的。

[http://msdn.microsoft.com/en-us/library/ms176102.aspx](http://msdn.microsoft.com/en-us/library/ms176102.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T15:10:22.623

（未经测试）：

```
SELECT L.iUsername, 
((SELECT COUNT(1) FROM logs WHERE iUsername=L.iUsername) - 
(SELECT COUNT(1) FROM logs WHERE oUsername=L.iUsername)) as rank  
FROM logs L 
GROUP BY L.iUsername 
ORDER BY rank ASC 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-26T15:10:31.790

试试那个查询。

```
Select user_id, count(user_id) from tablename group by user_id; 
```

# directoryservices - 带有 .NET DirectoryServices 的 Novell eDirectory

> ID：11672277
> 
> 赞同：2
> 
> 时间：2012-07-26T15:03:07.317
> 
> 标签：directoryservices, novell

在我们公司，我们有一个项目应该将 Novell eDirectory 与 .net 应用程序一起使用。我已尝试使用 Novell Api (http://www.novell.com/coolsolutions/feature/11204.html) 在 .NET 应用程序之间进行连接。它工作正常。

但是，根据要求，我们特别需要 .net API 以不与 Novell Api 连接，这不起作用。与 .NET Api 的连接和绑定`DirectoryServices`不起作用。

我们的 Novell eDirectory 使用以下凭据安装：

1.  IP地址：10.0.x.xx(witsxxx.companyname.com)

2.  树 : SXXXX

3.  新树上下文：WIxxxK01-NDS.OU=STATE.O=ORG

4.  管理员上下文是：ou=STATE,o=ORG

5.  管理员：管理员

6.  密码：管理员

我使用了 Novell Api 并使用了以下代码

```
String ldapHost ="10.0.x.xx";
String loginDN = "cn=admin,cn=WIxxxK01-NDS,OU=STATE,o=ORG";
String password = string.Empty;
String searchBase = "o=ORG";
String searchFilter = "(objectclass=*)";
Novell.Directory.Ldap.LdapConnection lc = new Novell.Directory.Ldap.LdapConnection();

try
{
    // connect to the server
    lc.Connect(ldapHost, LdapPort);
    // bind to the server
    lc.Bind(LdapVersion, loginDN, password);
} 
```

这是正确绑定并且可以进行搜索。

现在我的问题是当我尝试使用 .NET APi 并使用`System.DirectoryServices` or`System.DirectoryServices.Protocols`时，它没有连接或绑定。

我什至无法测试以下`DirectoryEntry.Exists`方法。它会例外。

```
string myADSPath = "LDAP://10.0.x.xx:636/OU=STATE,O=ORG";

// Determine whether the given path is correct for the DirectoryEntry.
if (DirectoryEntry.Exists(myADSPath))
{
    Console.WriteLine("The path {0} is valid",myADSPath);
}
else
{
    Console.WriteLine("The path {0} is invalid",myADSPath);
} 
```

它在说`Server is not operational`等等`Local error occurred`。我不知道目录路径发生了什么。

我试过了

```
DirectoryEntry de = new DirectoryEntry("LDAP://10.0.x.xx:636/O=ORG,DC=witsxxx,DC=companyname,DC=com", "cn=admin,cn=WIxxxK01-NDS,o=ORG", "admin");
DirectorySearcher ds = new DirectorySearcher(de, "&(objectClass=user)");
var test = ds.FindAll(); 
```

所有人都会例外。

你能帮我解决这个问题吗？应该怎么`userDN`做`DirectoryEntry`？

我也用过，`System.DirectoryServices.Protocols.LdapConnection`但没有结果。只有相同的例外。`LdapDirectoryIdentifier``System.Net.NetworkCredential`

感谢您宝贵的时间和帮助。

谢谢，比努

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T14:33:39.627

要诊断您的 LDAP 连接错误，请从管理员那里访问 eDirectory 服务器，并使用 iMonitor（serverIP:8028/nds 并选择 Dstrace），在 Dstrace 中清除所有选项卡并启用 LDAP 跟踪，然后进行绑定，看看会发生什么LDAP 端看看那里是否有更具描述性的错误。或者，如果您甚至可以绑定并建立连接。

# wcf - 在 REST 模式下使用 WCF 时得到 404

> ID：11672278
> 
> 赞同：0
> 
> 时间：2012-07-26T15:03:08.057
> 
> 标签：wcf, wcf-rest

我在浏览器中使用了这个 url，我希望看到一个 XML，我只得到 404 not found 错误。你能帮忙吗？

--http://SomeIP:65001/WCFPilot/Service1/REST/GetData

网络配置

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration>

  <system.web>
    <compilation debug="true" targetFramework="4.0" />
        <authentication mode="Windows" />
  </system.web>
  <system.serviceModel>
    <services>
      <service name="WCFPilot.Service1">
        <endpoint address="REST" binding="webHttpBinding" contract="WCFPilot.IService1" behaviorConfiguration="REST">          
        </endpoint>

      </service>

    </services>
    <behaviors>
      <endpointBehaviors>
        <behavior name="REST">
          <webHttp faultExceptionEnabled="true" helpEnabled="true" />          
        </behavior>

      </endpointBehaviors>
      <serviceBehaviors>
        <behavior>
          <!-- To avoid disclosing metadata information, set the value below to false and remove the metadata endpoint above before deployment -->
          <serviceMetadata httpGetEnabled="true" />
          <!-- To receive exception details in faults for debugging purposes, set the value below to true.  Set to false before deployment to avoid disclosing exception information -->
          <serviceDebug includeExceptionDetailInFaults="true" />

        </behavior>
      </serviceBehaviors>
    </behaviors>
    <serviceHostingEnvironment multipleSiteBindingsEnabled="true" />
  </system.serviceModel>
 <system.webServer>
    <modules runAllManagedModulesForAllRequests="true" />
  </system.webServer>

</configuration> 
```

服务合约

```
 [ServiceContract]
    public interface IService1
    {

        [OperationContract]
        [WebGet(ResponseFormat = WebMessageFormat.Xml, BodyStyle = WebMessageBodyStyle.Wrapped, UriTemplate = "GetData")]
        string GetData();

    } 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-28T11:47:03.183

服务的 URL 应该是

`http://SomeIP:65001/Service1.svc/REST/GetData`

# performance - 初始化成本

> ID：11672287
> 
> 赞同：0
> 
> 时间：2012-07-26T15:03:53.340
> 
> 标签：performance, scala, initialization

给定一个特征，该特征包含一个具有大量实例（100 个文件，每 100 行）存储在非惰性 val 中的对象

```
trait Repository {
  object dao {
    val a = new A
    val b = new B
    val c = new C
    ...
  }
} 
```

初始化成本是多少？假设有 100 个存储库消费者，每个 DAO 实例一个（即“对象 X 扩展存储库”*100）。对象 X、Y、Z 消费者会各自产生 100 个 DAO 实例的开销吗？

鉴于存储库消费者只需要引用 DAO 实例的子集，我正在考虑采用惰性初始化方法，但试图了解惰性初始化成本与非惰性初始化成本之间的权衡。

如果在 JVM 容器启动时，所有 100 个 DAO 实例都被初始化，那么非延迟方法将避免延迟初始化的不必要开销。但是，如果为每个 Repository 消费者创建 100 个 DAO 实例，最好是偷懒并减少内存使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:07:35.947

据我所知，`objects`都是懒惰初始化的。例如与

```
trait Repository {
  object dao {
    val a = { println( "aqui" ); 33 }
  }
} 
```

观察：

```
val x = new Repository {}  // pasa nada 
```

只有现在：

```
x.dao // pasa algo 
```

# flash - 带有 ActionScript 的 RTMP Flash 客户端 -> 缓冲区长度为零

> ID：11672288
> 
> 赞同：0
> 
> 时间：2012-07-26T15:03:55.527
> 
> 标签：flash, rtmp

我只是想制作一个简单的 Flash Player，它可以使用 Flash ActionScript 播放 rtmp 流......

这是我的代码：

```
import flash.display.Sprite;
import flash.net.NetConnection;
import flash.net.NetStream;
import flash.media.Video;
import flash.events.*;

var nc : NetConnection;
var ns : NetStream;
var vid : Video;
var monitorBufferLengthEverySecond:uint;
var counter:uint;

vid=new Video();
vid.width=640;
vid.height=480; 

trace("Create ... NetConnection");
nc = new NetConnection();

nc.addEventListener(NetStatusEvent.NET_STATUS, netStatus);
nc.addEventListener(SecurityErrorEvent.SECURITY_ERROR, netSecurityError);
nc.connect("rtmp://x.x.x.x/live");

function netStatus(event:NetStatusEvent):void 
{
    trace("Net Satus: "+ event.info.code);

    if(event.info.code == "NetConnection.Connect.Success")
    {
        trace("Net Satus is OK");

        trace("Creating NetStream");
        ns = new NetStream(nc);

        var infoClient:Object = new Object();
        infoClient.onMetaData = function oMD():void {};
        infoClient.onCuePoint = function oCP():void {};
        ns.client = infoClient; 

        ns.play("IPCamera.stream");

        vid.attachNetStream(ns);

        monitorBufferLengthEverySecond = setInterval(monPlayback, 1000);

    }

}

function netSecurityError(event:SecurityErrorEvent):void 
{
    trace("Security error: " + event);          
}

function monPlayback():void 
{
      // Print current buffer length
      trace((++counter)+ " Buffer length: " + ns.bufferLength);
 } 
```

连接**成功****但是****当我尝试检查缓冲区时，我总是得到“0”长度......而且我看不到 RTMP 流......**

为什么会这样？我做错了什么？有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T18:21:31.750

`ns.addEventListener(NetStatusEvent.NET_STATUS, netStatus);` 您可以将此侦听器添加到 NetConnection 和 NetStream 对象，这样您将看到您的流状态是什么，我猜您没有正确访问流的名称，但无法确定。

使用它来检查您的流是否可用：[http ://www.osmf.org/configurator/fmp/](http://www.osmf.org/configurator/fmp/)

# c# - 如何让 ComboBox 保留最近输入的值？

> ID：11672289
> 
> 赞同：2
> 
> 时间：2012-07-26T15:03:55.073
> 
> 标签：c#, winforms, combobox

我在 c# 中有一个 WinForms 程序，它具有一个文本字段，我想用可编辑的 ComboBox 替换它。

我想要实现的效果类似于 OpenFileDialog，或者某种程度上类似于 Windows Explorer 中的地址栏。也就是说，当您输入有效项目时，该项目将添加到下拉菜单显示的可能值列表中。我也希望这在程序的后续运行中持续存在。

所以，基本上

1.  程序第一次运行，ComboBox为空，列表中没有任何内容
2.  用户在 ComboBox 中输入一个值并按 Enter（或按钮），使用该值，然后将其添加到 ComboBox 的列表中
3.  用户退出程序
4.  用户重新进入程序，ComboBox 为空，但上一个会话中使用的值在列表中。

我可以想象几种方法来实现这一点，但这似乎是一种我不知道的简单方法来完成的事情。就像某人如何实现自动完成只是发现控件已经支持它一样。

如果没有，那么我可以继续使用其他方式来添加和保存信息，我只是好奇是否已经有现成的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T17:48:09.560

从组合框的属性列表中，您可以选择 DropDownStyle 作为 DropDown，并从 Misc 中选择自动完成模式为（建议）或（附加）。

当用户输入一些东西时，它会被保存，当他下次运行应用程序时，你应该用选项填充组合框或从杂项中提供一个自定义源。

# android - API / 列表对象

> ID：11672292
> 
> 赞同：0
> 
> 时间：2012-07-26T15:04:01.127
> 
> 标签：android

我一直在寻找一个 API 或一个对象，它显示如下所示的列表 -
![列表](../Images/8fa44a43c7307736d1fa10da17809581.png)

重要的是每个项目都有一个标题+较小的文本，左侧/右侧的复选框，以及在右上角/左侧添加文本的选项（如图片中的日期）

我一直在寻找它，但还没有找到它，除了不同的列表......

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T15:05:03.853

您必须创建一个自定义列表视图。这是给你的教程：[http ://www.androidhive.info/2012/02/android-custom-listview-with-image-and-text/](http://www.androidhive.info/2012/02/android-custom-listview-with-image-and-text/)

* * *

**编辑** 回答您在评论中的问题：

**如何添加复选框而不是图片？**

您需要编辑 list_row.xml 文件以将 ImageView 更改为 CheckBox。这是 ImageView xml 代码：

```
<ImageView
   android:id="@+id/list_image"
   android:layout_width="50dip"
   android:layout_height="50dip"
   android:src="@drawable/rihanna"/> 
```

但是我们想要一个复选框，不是吗。让我们更改该块，使其成为 CheckBox：

```
<CheckBox
   android:id="@+id/cb_list"
   android:layout_width="50dip"
   android:layout_height="50dip"
   android:text="This is a checkbox"/> 
```

然后在 LazyAdapter.java 文件中，我们需要删除其中包含“ImageView”的位，否则 LazyAdapter 将尝试对不存在的 ImageView 进行处理。这是更新后的类（已删除的位已注释掉）：

```
public class LazyAdapter extends BaseAdapter {

    private Activity activity;
    private ArrayList&lt;HashMap&lt;String, String&gt;&gt; data;
    private static LayoutInflater inflater=null;
    //public ImageLoader imageLoader; 

    public LazyAdapter(Activity a, ArrayList&lt;HashMap&lt;String, String&gt;&gt; d) {
        activity = a;
        data=d;
        inflater = (LayoutInflater)activity.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        //imageLoader=new ImageLoader(activity.getApplicationContext());
    }

    public int getCount() {
        return data.size();
    }

    public Object getItem(int position) {
        return position;
    }

    public long getItemId(int position) {
        return position;
    }

    public View getView(int position, View convertView, ViewGroup parent) {
        View vi=convertView;
        if(convertView==null)
            vi = inflater.inflate(R.layout.list_row, null);

        TextView title = (TextView)vi.findViewById(R.id.title); // title
        TextView artist = (TextView)vi.findViewById(R.id.artist); // artist name
        TextView duration = (TextView)vi.findViewById(R.id.duration); // duration
        //ImageView thumb_image=(ImageView)vi.findViewById(R.id.list_image); // thumb image

        HashMap&lt;String, String&gt; song = new HashMap&lt;String, String&gt;();
        song = data.get(position);

        // Setting all values in listview
        title.setText(song.get(CustomizedListView.KEY_TITLE));
        artist.setText(song.get(CustomizedListView.KEY_ARTIST));
        duration.setText(song.get(CustomizedListView.KEY_DURATION));
        //imageLoader.DisplayImage(song.get(CustomizedListView.KEY_THUMB_URL), thumb_image);
        return vi;
    }
} 
```

**当一个被点击时，我怎样才能得到他在列表中的位置，以便我能够影响该项目？**

单击列表项时，`OnItemClickListener`会触发 a。你`OnItemClickListener`在你的`CustomizedListView`活动中定义了你的。看看底部附近，它看起来像这样：

```
// Click event for single list row
list.setOnItemClickListener(new OnItemClickListener() {
    @Override
    public void onItemClick(AdapterView&lt;?&gt; parent, View view, int position, long id) {

    }
}); 
```

假设我们想在单击列表时显示一个弹出窗口（在 Android 上称为 Toast），我们会这样做：

```
// Click event for single list row
list.setOnItemClickListener(new OnItemClickListener() {
    @Override
    public void onItemClick(AdapterView&lt;?&gt; parent, View view, int position, long id) {
        Toast.makeText(CustomizedListView.this, "List item " + position + "clicked", Toast.LENGTH_SHORT).show();
    }
}); 
```

**如何使列表动态化？我的意思是如何根据用户的选择添加新项目/删除项目。**

要添加或删除项目，您必须修改歌曲列表，然后更新列表。假设我们想在歌曲列表中添加一个新项目，我们所要做的就是：

```
 HashMap<String, String> map = new HashMap<String, String>();

    map.put(KEY_ID, "0");
    map.put(KEY_TITLE, "Title here");
    map.put(KEY_ARTIST, "Artist here");
    map.put(KEY_DURATION, "4:08");
    map.put(KEY_THUMB_URL, "http://www.moveoneinc.com/blog/wp-content/uploads/2011/12/Dog-2.jpg");

    // adding HashList to ArrayList
    songsList.add(map); 
```

要删除一首歌曲，只需执行以下操作：

```
songsList.remove(3); //Where 3 means the second element in the list 
```

编辑`songsList`完后，您需要更新列表以再次加载歌曲列表。你这样做：

```
list.notifyDataSetChanged(); 
```

我希望清除它，我没有测试过这段代码，但*应该*都可以工作。

# node.js - 在 node-http-proxy 的中间件中调用异步方法

> ID：11672294
> 
> 赞同：7
> 
> 时间：2012-07-26T15:04:02.713
> 
> 标签：node.js, asynccallback, node-http-proxy

我正在尝试在 Node.js 中使用 node-http-proxy 创建一个代理，以检查请求是否在 mongodb 中获得授权。

基本上，我为我使用的 node-http-proxy 创建了一个中间件模块，如下所示：

```
httpProxy.createServer(
require('./example-middleware')(),
9005, 'localhost'
).listen(8005) 
```

中间件模块所做的是使用 mongojs 连接到 mongodb 并运行查询以查看用户是否有权访问资源：

```
module.exports = function(){
// Do something when first loaded!
console.log("Middleware loaded!");

return function (req, res, next) {
var record = extractCredentials(req);
var query = -- Db query --

//Debug:
log("Query result", query);

db.authList.find(query).sort({
    "url.len": -1
}, function(err, docs){
    console.log(docs);

    // Return the creator for the longest matching path:
    if(docs.length > 0) {
        console.log("User confirmed!");
        next();
    } else {
        console.log("User not confirmed!");
        res.writeHead(403, {
            'Content-Type': 'text/plain'
        });
        res.write('You are not allowed to access this resource...');
        res.end();
    }

});

}
} 
```

现在的问题是，一旦我使用 mongojs 添加对 mongodb 的异步调用，代理就会挂起并且永远不会发回响应。

澄清一下：在“用户未确认”上，一切正常，并返回 403。但是，在“用户确认”上，我看到了日志，但浏览器然后永远挂起并且请求没有被代理。

现在，如果我在回调之外删除“用户确认”和 next() 部分，它确实有效：

```
module.exports = function(){
// Do something when first loaded!
console.log("Middleware loaded!");

return function (req, res, next) {
    var record = extractCredentials(req);
    var query = --- query ---

    console.log("User confirmed!");
    next();
} 
```

但我不能这样做，因为 mongojs 查询意味着（我猜是正确的）异步执行，只有当数据库回复时才会触发回调......

我也尝试了不使用中间件的版本：

```
http.createServer(function (req, res) {
  // run the async query here!
  proxy.proxyRequest(req, res, {
  host: 'localhost',
  port: 9000
});
}).listen(8001); 
```

但这也无济于事......

有什么线索吗？请注意，我是 node.js 的新手，所以我怀疑我这边有误解......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-30T10:48:32.507

找到了答案，实际上问题是请求需要被缓冲：

```
httpProxy.createServer(function (req, res, proxy) {
// ignore favicon
if (req.url === '/favicon.ico') {
    res.writeHead(200, {
        'Content-Type': 'image/x-icon'
    } );
    res.end();
    console.log('favicon requested');
    return;
}

var credentials = extractCredentials(req);
console.log(credentials);

var buffer = httpProxy.buffer(req);

checkRequest(credentials, function(user){
    if(user == ...) {
        console.log("Access granted!");
        proxy.proxyRequest(req, res, {
            host: 'localhost',
            port: 9005, 
            buffer: buffer
        });
    } else {
        console.log("Access denied!");
        res.writeHead(403, {
            "Content-Type": "text/plain"
        });
        res.write("You are not allowed to access this resource...");
        res.end();
    }

});

}).listen(8005); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T15:48:30.087

两个问题：

1.  在你的回调`next();`的`else`情况下你没有打电话。`sort`
2.  `sort`回调的第二个参数是一个[`Cursor`](http://mongodb.github.com/node-mongodb-native/api-generated/cursor.html)，而不是文档数组。因此，`docs.length > 0`永远不会正确，代码始终遵循`else`路径。

# matlab - 使用部分文件名和日期保存文件

> ID：11672297
> 
> 赞同：0
> 
> 时间：2012-07-26T15:04:13.340
> 
> 标签：matlab, date, file-io, save, filenames

您好我目前正在尝试找到一种方法将 2 个变量从我的工作区保存到一个文件中。我希望使用原始日期和当前日期将文件名放在一起。

我只想要变量的最大值，所以：

```
max(streaking) 
```

和

```
max(tap_total) 
```

原始文件名是：

3_FM001_02_05460$BandP$64_24000_FWD_1x1_PRI_PRI_PRI_PRI_15_17_ActivePixelMeans.csv

我想使用的原始文件名的唯一部分是：

```
3_FM001_02_05460$BandP$64_24000_FWD_1x1 
```

这些可以保存在文本文件或电子表格中，没关系。

新文件名的示例如下所示：

```
3_FM001_02_05460$BandP$64_24000_FWD_1x1_7-26-2012 
```

还，

如果可以在文件中执行某些操作以显示哪个变量是哪个，例如：

```
Streaking: 1.272  % this would come from the variable max(streaking)

Tap_Total: 2.252  % this would come from the varaible max(tap_total) 
```

编辑：

```
% Construct a questdlg with three options

choice = questdlg('Would you like to save?', ...

'Save Options', ...

'Yes','No','Cancel','Cancel');

% Handle response

switch choice

case 'Yes'

    disp([choice ' processing.'])

    save_option = 1;
case 'No'
    disp([choice ' processing.'])
    save_option = 0;
case 'Cancel'
    disp('Canceled.')
    save_option = 2;
end

file_to_get = evalin( 'base', 'file_to_get' );
streaking = evalin( 'base', 'streaking' );
tap_total = evalin( 'base', 'tap_total' );

if save_option == 0
elseif save_option == 1

    max_streak = max(streaking);
    max_tap = max(tap_total);
    str_streak = mat2str(max_streak);
    str_tap = mat2str(max_tap);
    fname = file_to_get;
    pruned_fname = regexprep(fname,'_PRI(\w*).(\w*)','');
    new_fname = [pruned_fname '_' date '.csv'];
    path1 = '\\pfile01thn\bbruffey$\My Documents\analysis data\Banding and Streaking Results';
    fid = fopen([path1 new_fname], 'w');
    fprintf(fid,['Max Banding: %s\nMax Streaking: %s'],str_tap,str_streak)
    fclose(fid);
elseif save_option == 2
end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-26T15:29:07.310

这将是使用该`regexprep`命令修剪原始文件名的好地方。

例子：

```
fname = '3_FM001_02_05460$BandP$64_24000_FWD_1x1_PRI_PRI_PRI_PRI_15_17_ActivePixelMeans.csv';
pruned_fname = regexprep(fname,'_PRI(\w*).(\w*)','');

pruned_fname =

3_FM001_02_05460$BandP$64_24000_FWD_1x1 
```

`regexprep`现在，关于我在这里使用的命令的注释。这特定于您在此处提供的文件名。因为看起来你想在第一次之后修剪掉所有东西，所以`_PRI`我使用了一个标签 `(\w*)`，这意味着`[a-z A-Z _ 0-9]`可以遵循任何组合。请注意，由于这是一个文件名，`.`因此我在其中添加了一个句点，然后再添加一个句点`(\w*)`来完成 csv。[您可以在此处](http://www.mathworks.com/help/techdoc/matlab_prog/f0-42649.html)找到有关此类运算符的更多信息。

现在你有了，`pruned_fname`你可以简单地添加任何你想要的东西。因此，如果您想用下划线将日期添加到空格中，只需执行以下操作：

```
new_fname = [pruned_fname '_' date '.csv'];
new_fname =

3_FM001_02_05460$BandP$64_24000_FWD_1x1csv_26-Jul-2012.csv 
```

现在您只需打开文件即可对其进行写入。您可能需要将路径附加到要保存它的位置，我现在只调用它`path`。会是这样的`C:\Documents\`

```
fid = fopen([path new_fname], 'w') 
```

现在有了`fid`你要写入的文件的 id。这应该是一个新文件，如果不是这样，您将覆盖文件内容。请注意=）

接下来，您可以使用 简单地将前两行写入文件`fwrite` `fprintf`，仅举几个可能的函数。

希望这会让你在那里设置！

# c++ - 调用 Singleton getInstance() 时出现未定义符号错误

> ID：11672303
> 
> 赞同：1
> 
> 时间：2012-07-26T15:04:32.390
> 
> 标签：c++, xcode, static, singleton

我不知道为什么会这样，我按照[此处发布的示例进行操作。](https://stackoverflow.com/questions/1008019/c-singleton-design-pattern/1008289#1008289)

```
class Song {

private:
    // singletong
    Song();
    Song(Song const&); // don't implement
    void operator = (Song const&); //don't implement

public:
    // Singleton method
    static Song &getInstance(){
        static Song song;
        return song;
    }

}; 
```

如果我不给班级打电话，就没有问题。一旦我像这样调用 Song 类：

```
Song::getInstance();
// also tried: Song &song = Song::getInstance(); 
```

Xcode 不想再构建项目了。我收到此错误： ![在此处输入图像描述](../Images/ae29763d5aca13adb127cdc75c1be3b4.png)

任何想法为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-26T15:05:57.803

您没有实现自从您在函数中实例化对象以来必须存在的构造`getInstance()`函数：

```
static Song song; 
```

内联实现它（不推荐）：

```
private:
    // singletong
    Song() {
        // Your implementation goes here
    } 
```

或者在编译单元（例如 Sound.cpp）中实现它（首选）：

```
Song::Song(){
    // Your implementation goes here
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T15:06:38.127

任何一个

*   您没有实现默认构造函数 - 只需替换`Song();`为`Song() {}`查看这是否是原因。
*   `Song s = Song::getInstance()`您正在通过调用而不是创建副本`Song& s = Song::getInstance()`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T15:06:40.373

您还没有提供默认构造函数的实现。这就是为什么你得到一个未定义的引用。

这是链接错误，而不是编译器错误。这意味着您的代码实际上已经正确编译。编译后，链接器获取已编译的目标代码并将其“链接”在一起以形成可执行文件。如果您的所有函数都不像您声明的那样存在，则链接器会发疯（在动态链接的情况下这并不严格，但这是另一个问题）。

但是，许多编译器不会浪费时间尝试链接从未在代码中调用的函数。

在您的情况下，当您不调用该函数时，您不会收到此错误，因为您的 getInstance() 永远不会尝试构造一个对象，因为它没有被调用。

# maven - Tycho 无法从我自己的纯 Maven 依赖项包装器中解析包

> ID：11672304
> 
> 赞同：4
> 
> 时间：2012-07-26T15:04:34.060
> 
> 标签：maven, eclipse-plugin, tycho

我正在尝试创建一个 Eclipse 插件，它依赖于普通的 Maven 工件。我创建了以下项目结构：

```
Parent POM
 |- Dependencies (Third Party)
 \- My Code
     |- Bundle
     \- Bundle Tests 
```

我遵循了 Tycho 示例 itp02，但仅使用了第三方依赖项。据我了解，这个想法是将所有依赖项包装在一个包中，并将其用作我的包的输入。我设法正确构建和安装依赖包：创建了一个 jar，它包含从 Maven 存储库获得的所有 JAR 文件。但是当我尝试编译我的包时，我收到一条错误消息，说我的包清单中的包无法导入。

```
[ERROR]   Missing requirement: MyPlugin 0.0.1.qualifier requires 'package org.apache.commons.lang.StringEscapeUtils 0.0.0' but it could not be found
[ERROR] 
[ERROR] Internal error: java.lang.RuntimeException: "No solution found because the problem is unsatisfiable.": ["Unable to satisfy dependency from MyPlugin 0.0.1.qualifier to package org.apache.commons.lang.StringEscapeUtils 0.0.0.", "No solution found because the problem is unsatisfiable."] -> [Help 1]
org.apache.maven.InternalErrorException: Internal error: java.lang.RuntimeException: "No solution found because the problem is unsatisfiable.": ["Unable to satisfy dependency from MyPlugin 0.0.1.qualifier to package org.apache.commons.lang.StringEscapeUtils 0.0.0.", "No solution found because the problem is unsatisfiable."] 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-30T13:14:43.513

从您的描述中，您的项目是如何设置的或您用于构建它的命令不是很清楚。但是，您的“POM 父母”似乎建议您尝试一次性构建它。如果是这种情况，您不能在同一构建中混合使用 pom-first (maven-bundle-plugin) 项目和 manifest-first (eclipe-plugin) 项目，请参阅 [1]。您需要先构建 pom-first 项目并将其安装到本地 maven 存储库中，然后才能构建 manifest-first 项目。

要检查的第二件事是您配置了正确的依赖项，并且您已设置 pomDependencies=consider，如 [2] 中所示。

最后，如果这没有帮助，请检查本地 maven 存储库中的 jar 文件是否具有 META-INF/MANIFEST.MF 和正确的“Export-Package”语句 - 特别是应该有一行 org.apache.commons。 lang.StringEscapeUtils。

[1] [http://wiki.eclipse.org/Tycho/How_Tos/Dependency_on_pom-first_artifacts#It_is_not_possible_to_mix_pom-first_and_manifest-first_projects_in_the_same_reactor_build](http://wiki.eclipse.org/Tycho/How_Tos/Dependency_on_pom-first_artifacts#It_is_not_possible_to_mix_pom-first_and_manifest-first_projects_in_the_same_reactor_build)。

[2] [http://git.eclipse.org/c/tycho/org.eclipse.tycho-demo.git/tree/itp02/build02/pom.xml](http://git.eclipse.org/c/tycho/org.eclipse.tycho-demo.git/tree/itp02/build02/pom.xml)

# objective-c - 子视图的方向错误

> ID：11672306
> 
> 赞同：0
> 
> 时间：2012-07-26T15:04:39.630
> 
> 标签：objective-c, ios, uistoryboardsegue

我有一个自定义的转场，我正在尝试与标准的“Cover Vertical”转场进行相反的操作。我认为这应该有效：

> ```
> UIView *srcView = ((UIViewController *)self.sourceViewController).view;
> UIView *dstView = ((UIViewController *)self.destinationViewController).view;
> 
> [dstView setFrame:CGRectMake(0, 0, srcView.window.bounds.size.width, srcView.window.bounds.size.height)];
> 
> [srcView.window insertSubview:dstView belowSubview:srcView];
> 
> [UIView animateWithDuration:0.3
>      animations:^{
>          srcView.center = CGPointMake(srcView.center.x - srcView.frame.size.width, srcView.center.y);
>      }
>      completion:^(BOOL finished){
>          [srcView removeFromSuperview];
>      }
>  ]; 
> ```

问题是目标视图以纵向显示，即使应用程序中的所有其他视图都是横向的。此外，x 和 y 坐标是相反的。为什么会这样？

我已经`shouldAutorotateToInterfaceOrientation`在每个视图控制器中进行了设置，但这并没有帮助。我可以用 旋转视图`CGAffineTransformMakeRotation`，但这似乎不是正确的做法；一方面，坐标仍然会颠倒。

**更新：**

我尝试使用`CGAffineTransformRotate`旋转视图，但它看起来很荒谬。大多数背景显示为黑色。我不认为这是它应该工作的方式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T11:43:54.000

由于在控制器交换之前我无法获得目标视图的正确方向和框架，因此我确实颠倒了这个过程：

1.  将源视图保存为图像（请参阅[使用自定义动画删除自定义 UIStoryboardSegue](https://stackoverflow.com/questions/13083184/remove-custom-uistoryboardsegue-with-custom-animation)）；
2.  切换当前控制器 [presentViewController: ...];
3.  然后，使用嵌入保存的源图像的（现在正确的）目标视图制作动画。

这是完整的代码：

```
#include <QuartzCore/QuartzCore.h>

@implementation HorizontalSwipingSegue

- (void) perform {
    UIViewController *source = self.sourceViewController;
    UIViewController *destination = self.destinationViewController;    
    UIView *sourceView = source.view;
    UIView *destinationView = destination.view;

    // Create a UIImageView with the contents of the source
    UIGraphicsBeginImageContext(sourceView.bounds.size);
    [sourceView.layer renderInContext:UIGraphicsGetCurrentContext()];
    UIImage *sourceImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();
    UIImageView *sourceImageView = [[UIImageView alloc] initWithImage:sourceImage];

    [[self sourceViewController] presentViewController:[self destinationViewController] animated:NO completion:NULL];

    CGPoint destinationViewFinalCenter = CGPointMake(destinationView.center.x, destinationView.center.y);
    CGFloat deltaX = destinationView.frame.size.width;
    CGFloat deltaY = destinationView.frame.size.height;

    switch (((UIViewController *)self.sourceViewController).interfaceOrientation) {
       case UIDeviceOrientationPortrait:
            destinationView.center = CGPointMake(destinationView.center.x - deltaX, destinationView.center.y);                
            sourceImageView.center = CGPointMake(sourceImageView.center.x + deltaX, sourceImageView.center.y);
            break;
        case UIDeviceOrientationPortraitUpsideDown:
            destinationView.center = CGPointMake(destinationView.center.x + deltaX, destinationView.center.y);
            sourceImageView.center = CGPointMake(sourceImageView.center.x + deltaX, sourceImageView.center.y);
            break;
        case UIDeviceOrientationLandscapeLeft:
            destinationView.center = CGPointMake(destinationView.center.x, destinationView.center.y - deltaY);                
            sourceImageView.center = CGPointMake(sourceImageView.center.x + deltaY, sourceImageView.center.y);
            break;
        case UIDeviceOrientationLandscapeRight:
            destinationView.center = CGPointMake(destinationView.center.x, destinationView.center.y + deltaY);
            sourceImageView.center = CGPointMake(sourceImageView.center.x + deltaY, sourceImageView.center.y);
            break;
    }

    [destinationView addSubview:sourceImageView];

    [UIView animateWithDuration:0.6f
                     animations:^{
                         destinationView.center = destinationViewFinalCenter; 
                     }
                     completion:^(BOOL finished){
                         [sourceImageView removeFromSuperview];
                     }];
}

@end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T18:01:30.420

Apparently, it was much easier than I thought to do the segue I wanted. Here's is what worked:

```
- (void)perform {
    UIViewController *src = (UIViewController *)self.sourceViewController;
    [src dismissViewControllerAnimated:YES completion:^(void){ [src.view removeFromSuperview]; }];
} 
```

Hopefully this helps someone else.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T16:30:34.410

**更新答案：**

确保您正确设置了 dstView 的框架。我认为你会更好地使用：

```
dstView.frame = srcView.frame; 
```

代替：

```
[dstView setFrame:CGRectMake(0, 0, srcView.window.bounds.size.width, srcView.window.bounds.size.height)]; 
```

该`bounds`属性不会以相同的方式`frame`对方向变化做出反应。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T16:35:41.313

代替

```
[srcView insertSubview:dstView belowSubview:srcView]; 
```

和

```
[srcView insertSubview:dstView atIndex:0]; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-26T16:46:16.473

如果您只是将另一个视图控制器的视图添加到您的视图层次结构中，则该视图控制器不会获取有关设备方向的任何信息，因此它将以其默认配置显示视图。[您还需要使用此处](http://developer.apple.com/library/ios/documentation/uikit/reference/UIViewController_Class/Reference/Reference.html#//apple_ref/occ/instm/UIViewController/addChildViewController%3a)描述的包含方法将视图控制器添加到视图控制器层次结构中。完成后，您还需要将其从层次结构中删除。

关于这个主题也有几个很好的 WWDC 演讲，一个来自 2011 年，名为“实现视图控制器遏制”，另一个来自今年，视图控制器的演变。

# postgresql - Slonik - slony-I 版 msimatch

> ID：11672318
> 
> 赞同：0
> 
> 时间：2012-07-26T15:05:17.490
> 
> 标签：postgresql, version, slony

我有一个 DebianEtch/Postgres 8.1 设置，它使用来自 master > slave 的 slony 进行复制。

这些服务器正在被 Debian Squeeze/Postgres 8.4 服务器取代。

我的 Squeeze 服务器之间的 Slony 运行良好，需要从 Etch.Master 复制到 Squeeze.Master，然后再拔下 Etch 盒上的插头。

然而：

```
./install_ms1_sqz.slonik:6: Possible unsupported PostgreSQL version (80412) 8.4, defaulting to 8.0 support
./install_ms1_sqz.slonik:6: loading of file /usr/share/slony1/slony1_funcs.sql: PGRES_FATAL_ERROR ERROR:  Slonik version: 1.2.6 != Slony-I version in PG build 1.2.21
ERROR:  Slonik version: 1.2.6 != Slony-I version in PG build 1.2.21 
```

我猜它在抱怨 Etch 和 Squeeze 服务器之间的“某些东西”的不同版本，但不确定是什么。

Etch box 是一个实时服务器，不会受到干扰，尽管如果需要（并且可用）我可以安装一个新版本的 slony，并且仍然必须复制到 Etch.Slave，尽管为此需要一些“停机时间”。

那么，我是否有希望，或者我必须在切换时转储/恢复相关的表、序列等？

干杯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T18:31:49.743

错误消息似乎很清楚 - 您在两台服务器上有不同版本的 Slony，它们不兼容。

我会在挤压服务器上从源代码安装 PostgreSQL 和 Slony - 这样你就可以在两台机器上拥有相同的版本。一旦您安装了相关的开发库，这并不是一个困难的过程。

# matlab - MATLAB 的 lsqnonlin 中用户定义的雅可比模式被忽略

> ID：11672319
> 
> 赞同：4
> 
> 时间：2012-07-26T15:05:18.423
> 
> 标签：matlab, mathematical-optimization, least-squares

我正在使用 MATLAB 的[`lsqnonlin`](http://www.mathworks.co.uk/help/toolbox/optim/ug/lsqnonlin.html)函数，并且试图通过选项设置用户定义的 Jacboian*模式*`JacobPattern`。我为`trust-region-reflective`要使用的算法设置了一个首选项，并且`output`from`lsqnonlin`表明这确实是求解器使用的算法（使用该`JacobPattern`选项所必需的）。

我发现的问题是，如果我`JacobPattern`的太稀疏（例如，在 500x500 雅可比行列式中只有几行），求解器将忽略它，而是计算完整的雅可比行列式。

此行为未记录在案；任何人都可以进一步阐明它吗？我希望能够强制求解器使用 my`JacobPattern`无论它多么荒谬，或者它的梯度有多浅。

* * *

**更新：**

我做了更多的实验，似乎只有在雅可比模式中有任何全零*行时*才会重新计算雅可比。任何数量的全零列都可以，只要每行至少有一个“1”。虽然这有助于避免问题，但问题仍然存在 --- 为什么求解器要求每个因变量具有关联的梯度？无论如何，我希望忽略用户定义的选项至少值得警告......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T18:46:44.943

我的猜测如下：

如果您看一下 jacobian 的实际含义，您会发现全零行意味着相应的函数（定义的向量函数的一部分）独立于任何变量。因此，将其添加到优化中是完全没有意义的。

至于故意将错误的雅可比行列式交给算法，您为什么要这样做？

# jquery - Knockoutjs 和模板：如何在不涉及 DOM 的情况下注入字符串模板？

> ID：11672321
> 
> 赞同：2
> 
> 时间：2012-07-26T15:05:27.273
> 
> 标签：jquery, knockout.js, jquery-templates, knockout-2.0

在 Microsoft Tmpl 中，您可以注入这样的字符串模板（来自 jQuery[手册页](http://api.jquery.com/jquery.tmpl/)）：

```
jQuery.tmpl( template [, data][, options]);
$.tmpl( "<li>${Name}</li>", { "Name" : "John Doe" }).appendTo( "#target" ); 
```

您可以使用简单的 jQuery.get() 从服务器获取模板，而无需涉及 DOM。

现在我知道有像[Knockout.js-External-Template-Engine](https://github.com/ifandelse/Knockout.js-External-Template-Engine)这样的项目，但是有没有办法将 Knockout 传递给代表模板的 Javascript 方法（或字符串）而不将模板放在 DOM 中（特别是如果你是使用外部模板引擎？）类似`data-bind="template: {name:mymethod}"`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T16:20:22.150

RP Niemeyer 在[他的一篇博文中介绍了这一点](http://www.knockmeout.net/2011/10/ko-13-preview-part-3-template-sources.html)

这是[他的小提琴示例](http://jsfiddle.net/rniemeyer/3598P/)。

# dependency-injection - 如何为继承标记接口的接口注册拦截注入？

> ID：11672325
> 
> 赞同：0
> 
> 时间：2012-07-26T15:05:54.777
> 
> 标签：dependency-injection, unity-container, aop, interception

例如，我想调用以下代码来注册一整套我想为其注入策略的服务：

```
container
            .AddNewExtensionIfNotPresent<Interception>().Configure<Interception>().SetDefaultInterceptorFor<IBusinessService>(new InterfaceInterceptor()); 
```

在哪里：

```
ISomeServiceA  : IBusinessService
ISomeServiceB : IBusinessService etc 
```

我想我读到你**不能**从某个地方从 ISomeServceX 到 IMarkerInterface ......这可以得到证实。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T13:21:47.007

简而言之，查看加载的程序集（如果需要，添加额外的过滤 - 如果在引导程序上完成，则不进行缓存）为实现指定标记接口的类型添加默认拦截器。

```
 container.AddNewExtensionIfNotPresent<Interception>();
        Assembly[] assemblies = AppDomain.CurrentDomain.GetAssemblies();
        foreach (Assembly assembly in assemblies)
        {
            Type[] types = assembly.GetTypes().Where(x => x.IsClass && typeof(T).IsAssignableFrom(x) && x.GetType() != typeof(T)).ToArray();
            foreach (Type t in types)
            {
                container.Configure<Interception>().SetDefaultInterceptorFor(t, new VirtualMethodInterceptor());
            }
        } 
```

编辑：

以上可以使用 fluent API 完成，这意味着我们没有对 AppDomain.CurrentDomain.GetAssemblies() 的天真依赖（它不包含在 fluent api 配置中应用的过滤

```
.Include(If.Implements<IBusinessService>, (x, y) =>
                                                          {
                                                              if (x.IsClass)
                                                                  y.Configure<Interception>().
                                                                      SetDefaultInterceptorFor(x,
                                                                                               new VirtualMethodInterceptor
                                                                                                   ());
                                                          }) 
```

# grails - 使用 Grails 在数据库中保存特殊字符

> ID：11672334
> 
> 赞同：1
> 
> 时间：2012-07-26T15:06:17.080
> 
> 标签：grails, datasource, special-characters, hsqldb

```
new Trainingcamp(name:"Höhentraining", region:"Alpen").save()
tr1 = Trainingcamp.findByName("Höhentraining")
tr2 = Trainingcamp.findByRegion("Alpen")
println("Tr1: " + tr1?.name)
println("Tr2: " + tr2?.name) 
```

控制台上的输出是：

```
Tr1: 
Tr2: H?hentraining 
```

所以在我看来，通过保存域对象会发生一些事情，用问号“？”替换特殊字符“ö”。我该如何摆脱这个问题？先谢谢了！

使用 Grails 1.3.7

__edit1：我使用 prod run-app 启动了应用程序，然后检查了 pordDb.log。我找到了以下插入：

```
INSERT INTO TRAININGCAMP VALUES('H\ufffdhentraining','Alpen') 
```

无论我写一个“ö”或“ü”或“ä”它总是用“\ufffd”替换它所以，有什么建议可以解决这个问题吗？

__edit2：新见解：仅当我将域保存在 BootStrap.groovy 中时才会出现问题。通过将域保存在控制器中，控制台上的输出与预期的一样：

```
Tr2: Höhentraining 
```

# c# - Visual Studio 的代码片段：如何在其中添加逻辑？

> ID：11672335
> 
> 赞同：6
> 
> 时间：2012-07-26T15:06:17.163
> 
> 标签：c#, visual-studio-2010

我制作了一个小代码片段来为 WPF 数据绑定创建一个属性：

```
private string property;
public string Property
{
    get { return this.property; }
    set
    {
        this.property = value;
        this.OnPropertyChanged(() => Property);
    }
} 
```

在 Camel Case 中创建字段名称并在 Pascal Case 中重写属性非常麻烦。有没有办法只编写字段并让代码段使用字段名称和第一个字符大写来编写属性？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-23T03:02:16.570

不幸的是，这种类型的逻辑在 Visual Studio 片段功能中不可用。必须输入两个名称是您能做的最好的事情。

以下是您在创建代码片段时唯一可用的“功能”。 [MSDN 代码片段函数](http://msdn.microsoft.com/en-us/library/ms242312%28VS.80%29.aspx)

Resharper 等产品提供了出色的代码片段（在 Resharper 中称为模板）功能，能够更改片段中其他替换的大小写，以及许多其他有用的功能。 [Resharper 模板信息](http://www.jetbrains.com/resharper/documentation/help20/Templates/LiveTemplates/editLive.html)

例如，您会对这个宏感兴趣：

“第一个字符小写的另一个变量的值”

# javascript - 避免 capybaras webkit console.log 输出

> ID：11672337
> 
> 赞同：-2
> 
> 时间：2012-07-26T15:06:28.767
> 
> 标签：javascript, rspec, capybara, capybara-webkit

我正在将 rspec 与 capybara-webkit 驱动程序一起用于 javascript 测试。

虽然拥有 javascripts console.log 输出是一个很棒的功能，但对于自动和并行测试，我不希望 console.log 弄乱输出。我尝试使用创建驱动程序

```
Capybara.register_driver :webkit_silent do |app|
  Capybara::Driver::Webkit.new(app, :stdout => nil)
end 
```

并将其与

```
Capybara.javascript_driver = :webkit_silent 
```

对于所有在 spec_helper 或

Capybara.current_driver = :webkit_silent

对于一项测试，输出仍然存在。我稍微查看了代码，并验证了连接类中的标准输出设置为空。

有没有其他方法可以停止输出？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-30T09:39:21.360

我真丢脸。有一些 puts 输出让我感到困惑，一切都很好并且按预期工作。

# c#-3.0 - 派生类不能引用父类

> ID：11672341
> 
> 赞同：0
> 
> 时间：2012-07-26T15:06:44.057
> 
> 标签：c#-3.0

```
class Program
{
    static void Main(string[] args)
    {

        Father objFather = new Son(); //Ok compiles

        Son objSon1 =  new Father(); //Comile time error : Cannot implicitly convert type

        Son objSon = (Son)new Father();  //Run time error
        Console.ReadLine();
    }
}

class Father
{
    public void Read()
    {

    }

}

class Daughter:Father
{

}

class Son:Father
{

} 
```

任何人都可以解释为什么会这样吗？内存中发生了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:18:33.030

您似乎误解了继承。

每`Daughter`一个`Son`都是一个`Father`。这就是为什么您可以安全地将两者都分配给`Father`变量的原因。子类不能删除属性/方法，只能添加它们，这就是为什么它确定它总是有效的原因。

但是，当您有一个实例`Father`并希望将其分配给一个`Son`变量时，您无法确定该实例是 a`Son`并且实际上具有所需的所有属性。该`Father`实例还可以包含与`Daughter`不兼容的`Son`。这就是为什么编译器不能隐式转换它们，但你作为程序员可以显式地做到这一点。

# javascript - 截取一组 HTML5 视频截图

> ID：11672343
> 
> 赞同：0
> 
> 时间：2012-07-26T15:06:50.623
> 
> 标签：javascript, canvas, html5-video

我正在尝试使用带有此代码的画布在浏览器中从 HTML5 视频中生成一组缩略图：

```
 var fps = video_model.getFps(); //frames per second, comes from another script
        var start = shot.getStart(); //start time of capture, comes from another script
        var end = shot.getEnd(); //end time of capture, comes from another script

        for(var i = start; i <= end; i += 50){  //capture every 50 frames
            video.get(0).currentTime = i / fps;

            var capture = $(document.createElement("canvas"))
                .attr({
                    id: video.get(0).currentTime + "sec",
                    width: video.get(0).videoWidth,
                    height: video.get(0).videoHeight
                })

            var ctx = capture.get(0).getContext("2d");
            ctx.drawImage(video.get(0), 0, 0, video.get(0).videoWidth, video.get(0).videoHeight);

            $("body").append(capture, " ");

        } 
```

捕获的数量是正确的，但问题是在 Chrome 中所有画布都显示为黑色，而在 Firefox 中它们总是显示相同的图像。

也许问题是循环太快而无法绘制画布，但我读到 .drawImage() 是异步的，因此，理论上，它应该让画布在跳转到下一行之前被绘制。

关于如何解决这个问题的任何想法？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T12:05:56.913

经过几个小时的斗争，我终于想出了一个基于“寻找”事件的解决方案。为此，必须完全加载视频：

代码如下：

```
 var fps = video_model.getFps(); //screenshot data, comes from another script
        var start = shot.getStart();
        var end = shot.getEnd();

        video.get(0).currentTime = start/fps; //make the video jump to the start

        video.on("seeked", function(){ //when the time is seeked, capture screenshot
            setTimeout( //the trick is in giving the canvas a little time to be created and painted, 500ms should be enough
                function(){
                    if( video.get(0).currentTime <= end/fps ){

                        var capture = $(document.createElement("canvas")) //create canvas element on the fly
                        .attr({
                            id: video.get(0).currentTime + "sec",
                            width: video.get(0).videoWidth,
                            height: video.get(0).videoHeight
                        })
                        .appendTo("body");

                        var ctx = capture.get(0).getContext("2d"); //paint canvas
                        ctx.drawImage(video.get(0), 0, 0, video.get(0).videoWidth, video.get(0).videoHeight);

                        if(video.get(0).currentTime + 50/fps > end/fps){
                            video.off("seeked"); //if last screenshot was captured, unbind
                        }else{
                              video.get(0).currentTime += 50/fps; //capture every 50 frames
                        }

                    }
                }
                , 500); //timeout of 500ms

        }); 
```

这在 Chrome 和 Firefox 中对我有用，我读到 seeked 事件在某些版本的特定浏览器中可能有问题。

希望这对任何人都有用。如果有人提出更清洁、更好的解决方案，很高兴看到它。

# javascript - 使用 jquery animate() 在文本上实现反弹效果？

> ID：11672345
> 
> 赞同：2
> 
> 时间：2012-07-26T15:06:53.530
> 
> 标签：javascript, jquery

我正在尝试使用 Jquery 来创建反弹效果，这就是我目前所拥有的：

html:

```
<div id ="animation">bounce</div> 
```

查询：

```
$("#animation").animate({ marginTop: "80px" }, 1500 )
               .animate({ marginBottom: "40px" }, 800 ); 
```

它向下但不向上，我尝试搜索文档，但没有

这里的工作示例：http: [//jsfiddle.net/zLw8F/](http://jsfiddle.net/zLw8F/)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-26T15:10:51.603

要再次向上，您需要减少`margin-top`而不是动画`margin-bottom`：

```
$("#animation").animate({ marginTop: "80px" }, 1500 )
               .animate({ marginTop: "40px" }, 800 ); 
```

[jsfiddle.net 上的演示](http://jsfiddle.net/zLw8F/)

然而，为了使元素与页面的其余部分分离，我建议使用相对定位而不是使用边距。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-26T15:09:45.397

Why not just use the [jQuery UI effects](http://jqueryui.com/demos/effect/)? Ex:

```
$("#animation").effect("bounce", { times:3 }, 300);​ 
```

**[jsFiddle example](http://jsfiddle.net/j08691/zLw8F/3/)**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T15:08:53.873

Try that:

```
$("#animation").animate({ marginTop: "80px" }, 1500, function() {
  $(this).animate({ marginTop: "40px" }, 800 );
}); 
```

# google-maps - 我可以根据搜索查询从 Google Maps API 返回默认搜索半径吗？

> ID：11672349
> 
> 赞同：0
> 
> 时间：2012-07-26T15:06:57.660
> 
> 标签：google-maps, maps

这是我需要做的：

假设我在谷歌地图上搜索法国，然后搜索罗德岛。罗德岛地图搜索结果的半径远小于法国。

有没有办法可以根据来自 Google Maps API 的给定搜索查询获取此半径信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:20:40.090

您需要使用`viewport`在 Geocoder 结果中返回的。

[https://developers.google.com/maps/documentation/javascript/reference#GeocoderGeometry](https://developers.google.com/maps/documentation/javascript/reference#GeocoderGeometry)

# xml - 将值分配给元素节点时，使用 XQuery 删除 xsi:nil = true

> ID：11672352
> 
> 赞同：0
> 
> 时间：2012-07-26T15:07:06.270
> 
> 标签：xml, xpath, xquery, xml-nil

有人可以帮助我实现以下目标：

*   当元素具有赋值时，如何在 XQuery 中删除属性 xsi:nil="true"？

如果元素具有空值，则保留 xsi:nil= "true"。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T07:55:45.417

您可以使用 XQuery Update 来实现这一点，例如：

```
declare variable $e := <entry nil="true" />;

if ($e/@nil != "null") then (
copy $c := $e
modify (
  delete node $c/@nil
)
return $c
)
else $e 
```

请注意，xquery 中没有实际的 null 值，因为您可能熟悉 Java 等语言。因此我在这里使用了一个简单的字符串来表示一个空值，您可能想要更改它。

另外，请注意，这个函数不会返回没有属性的相同节点，而是复制节点并返回这个没有 nil 属性的新修改节点。

# c++ - 递归函数有 out_of_range 异常

> ID：11672353
> 
> 赞同：1
> 
> 时间：2012-07-26T15:07:10.233
> 
> 标签：c++, visual-studio-2008, recursion, backtracking, outofrangeexception

给定一个由 ASCII 码和相应的数字值组成的全局向量`list`以及一个字符串，例如`000.00-000.0.0.0`，这个函数接受一个`input`2-char 或 3-char 长的标记字符串，并将其替换为一个表示 0 到 184 之间的数字值的 ASCII 符号，然后将不带分隔符的缩短字符串返回为`out`. 此外，在给定 ASCII 符号的反向（方向 1）中，它会转换回数字字符串并返回。

```
//looks for input string in vector and returns output, 'c' is check row, 'r' is return row
string vectorSearch(string &check, int n, int c, int r) 
{
    if (check.length() <= 1) 
        return check;
    if (list[n][c] == check || list[n][c] == ('0'+check)) //adds leading zero if 2char long
        return list[n][r];
    else 
        return vectorSearch (check, ++n, c, r);
}

//this function takes an ontology and either changes from single char 
//to string or takes strings and converts to char representation
string Lexicon::convertOntology(string input, int direction, string out, string temp) 
{
    if (input == "" && temp == "") 
        return out; //check for completed conversion
    else {
        if (input[0] == '.' || input[0] == '-' || input == "") { //found deliniator or endk
            if (input != "") return convertOntology(input.substr(1),direction, 
                 out+=vectorSearch(temp, 0, direction, 1-direction), "");
            else return convertOntology("", direction, 
                 out+=vectorSearch(temp, 0, direction, 1-direction), "");
        } else 
            return convertOntology(input.substr(1), direction, out, temp+=input[0]); //increment and check
    }
} 
```

这些函数工作正常，除了在最后一个字符被解析后的输出。`return convertOntology(input.substr(1), direction, out+=add, temp);`当`input == ""`和`temp == "0"`- 最后一次通过`vectorSearch()`应该清除 temp 并将 temp char 添加到 out 字符串时出现错误，因为 temp 是 == 1char，所以它应该按原样返回`vectorSearch()`。然后清除 和 的返回`convertOntology()`检查。但是，它永远不会在第一行中断，并且有一个`input``temp == ""``vectorSearch()`

```
Unhandled exception at 0x77bc15de exception: std::out_of_range at memory location 0x0035cf1c 
```

到底是怎么回事？这是通过返回进行递归回溯的问题吗？我在某处缺少返回以打破递归循环？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T15:16:28.923

对于你打电话的情况`temp == ""`，嗯，超出范围。`input != ""``input.substr(1)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T15:18:21.723

~~即使你没有进入其他部分，~~

 ~~```
input.substr(1) 
```~~ 

~~`input`当字符串正好是一个字符长时会抛出异常。~~

似乎它不允许 -`input.substr(input.size())`并返回一个空字符串。

* * *

您稍后可能会在 VectorSearch 中遇到类似的问题。如果没有匹配，您将递增`n`直到超出范围。

# visual-studio-2010 - 如何安装 Crystal Reports for VS2010？

> ID：11672361
> 
> 赞同：2
> 
> 时间：2012-07-26T15:07:22.477
> 
> 标签：visual-studio-2010, crystal-reports

每次我尝试安装（5 次尝试）时，我都会得到：

> 错误 2753。文件“agent.exe.6ED28686_7b19_420c_b255_5b6c1bd2c705”未标记为安装

我试过卸载，安装后删除安装文件夹，清除临时文件，重新启动机器并确保我以管理员身份运行安装程序，但我每次都得到这个。我什至遵循了一些关于将安装程序文件放入的建议，`c:\cr4vs2010`但无济于事。

我正在为其开发的客户具有 Crystal 技能，因此没有其他报告引擎可以做到。

编辑

了解修复上述错误的 FLEXnet 变压器。但是，安装完成后，我在标题为“Visual Studio”的对话框中收到错误“无法完成操作”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T17:06:24.060

我想我已经修好了。我现在有水晶模板。

修理。

1.  获取 Flexera 工具：

[http://kb.flexerasoftware.com/selfservice/microsites/search.do?cmd=displayKC&docType=kc&externalId=Q207355&sliceId=](http://kb.flexerasoftware.com/selfservice/microsites/search.do?cmd=displayKC&docType=kc&externalId=Q207355&sliceId=)

1.  按照说明运行该工具并使用它安装两个msi。我先安装了 VS，然后安装了 64 位运行时。

2.  在收到“无法完成操作”错误并安装两个 msi 后，打开 Visual Studio 命令提示符，确保选择以管理员身份运行。

3.  执行命令行`devenv /installvstemplates`。这需要几分钟。

那为我修好了。

# oracle11g - Oracle 9.2 迁移到 11g - 默认值

> ID：11672363
> 
> 赞同：1
> 
> 时间：2012-07-26T15:07:29.827
> 
> 标签：oracle11g, default-value, oracle9i

我们最近从 Oracle 9.2 版迁移到 11g。但是使用数据库的应用程序出现了一些错误。我们得到以下异常：

```
ORA-01400: cannot insert null into... 
```

我查找了有关该错误的信息，尤其是有关可能是原因的 11g 版本中的一些新功能的信息。

我在这里。我知道用默认值定义表列的旧方法行不通，但我不知道为什么，更重要的是如何解决这个问题。

这是我可以使用 SQL Developer 看到的表的定义：

```
COLUMN_NAME         DATA_TYPE       NULLABLE      DATA_DEFAULT   COLUMN_ID
--------------------------------------------------------------------------
...
REP_DOC_RECEIVED    CHAR(1 BYTE)    No            'n'            12 
... 
```

当我尝试为该列插入具有空值的行时，会引发异常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T05:21:22.220

仅当插入语句中未提供*任何*值时，才应用默认值。所以我猜你的插入会做一些`insert into ... values ( ... , NULL, ...)`。

请参阅例如[http://sqlfiddle.com/#!4/cd58c/7](http://sqlfiddle.com/#!4/cd58c/7)以显示差异：

```
-- ok
insert into a (n,REP_DOC_RECEIVED) values (1,'A');

-- ok, default is applied    
insert into a (n) values (1);

-- not ok, NOT NULL constraint violated    
insert into a (n,REP_DOC_RECEIVED) values (1,''); 
```

您必须`NVL(...,'n')`在插入语句中执行或忽略该列。不，这在 11g 中没有改变。

# spring - Mule ESB - 库是否覆盖任何应用程序库

> ID：11672371
> 
> 赞同：0
> 
> 时间：2012-07-26T15:07:59.543
> 
> 标签：spring, spring-security, mule, wss4j

我使用 Mule Studio 3.2.1 开发了一个 Mule 应用程序。在该应用程序中，我使用 org.springframework.ws.client.core.WebServiceTemplate 将 Web 服务请求发送到另一个应用程序。我使用了以下配置

```
 <bean id="myWsTemplate"  clsass="org.springframework.ws.client.core.WebServiceTemplate">
    <constructor-arg ref="messageFactory" />
    <property name="defaultUri" value="${my.soap.endpoint}" />
    <property name="interceptors">
        <list>
            <ref bean="acqSecurityInterceptor" />
        </list>
    </property> 
```

```
 <bean id="acqSecurityInterceptor" class="org.springframework.ws.soap.security.wss4j.Wss4jSecurityInterceptor">
    <property name="validationActions" value="NoSecurity"/>
    <property name="securementActions" value="NoSecurity" />
</bean> 
```

我使用了 Maven 依赖项

```
 <dependency>
        <groupId>org.springframework.ws</groupId>
        <artifactId>spring-ws-security</artifactId>
        <version>2.1.0.RELEASE</version>
    </dependency> 
```

这使用 wss4j-1.6.5.jar 作为依赖项。现在，当我在 Mule 3.2.0 中部署应用程序时，它会引发以下错误

```
 PropertyAccessException 1: org.springframework.beans.MethodInvocationException: Property 'validationActions' threw exception; nested exception is java.lang.NoSuchMethodError: org.apache.ws.security.util.WSSecurityUtil.decodeAction(Ljava/lang/String;Ljava/util/List;)I
  PropertyAccessException 2: org.springframework.beans.MethodInvocationException: Property 'securementActions' threw exception; nested exception is java.lang.NoSuchMethodError: org.apache.ws.security.util.WSSecurityUtil.decodeAction(Ljava/lang/String;Ljava/util/List;)I 
```

现在 Mule 3.2.0 的 lib/opt 目录附带了 wss4j-1.5.8-osgi.jar，其中 WSSecurityutil 上的方法签名是 public static int decodeAction(String action, Vector actions) 而尝试过的方法是wss4j.1.6.5 中存在的 decodeAction(Ljava/lang/String;Ljava/util/List;)

我的问题是，即使我的应用程序中有 wss4j-1.6.5.jar，为什么类加载器仍在尝试使用 mule/lib/opt.jar 中的那个。应用程序中的那个不应该优先吗？如果没有，有没有办法让它以这种方式工作

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T10:58:08.347

好的，在 mule-deploy.properties 中使用以下配置有助于 loader.override=-org.apache.ws.security.util.WSSecurityUtil ref [http://www.mulesoft.org/documentation/display/MULE3USER/Classloader+Control+in +骡子](http://www.mulesoft.org/documentation/display/MULE3USER/Classloader+Control+in+Mule)

但是在 Mule Studio 中作为插件构建的 jars 仍然存在很多问题，然后尝试在独立的 Mule 中进行部署。将在另一个线程中创建此类问题的分类列表。

# java - 如何使用 chunk.setUnderline 实现虚线下划线？

> ID：11672384
> 
> 赞同：0
> 
> 时间：2012-07-26T15:08:43.510
> 
> 标签：java, pdf-generation, itext, underline

我使用`SAXItexthandler`以下代码来实现指定厚度、颜色和指定 Y 位置的自定义下划线。所以基本上我在一个 itext 行的多个 itext 单元格中有不同的字符串，下面的代码帮助我为每个块嵌入一个单元格的每个块做下划线，它工作得很好。

```
Color c = Color.decode(custom_color);
currentChunk.setUnderline(c, thickness, 0.01f, ypos, 0.01f, PdfContentByte.LINE_CAP_BUTT); 
```

现在有没有办法让下划线变成虚线？我大量使用上面的代码，我们只在几个地方对虚线下划线有新的要求。所以我想知道我是否可以使用`setUnderline`自己来实现它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T09:33:10.583

您可以在块上使用通用标签：

1.  在相关块上设置标签
2.  创建一个扩展类`PdfPageEventHelper`并将其添加到编写器
3.  编写在`onGenericTag`方法上进行下划线作业的代码
4.  在该`onGenericTag`方法中，您拥有块的周围矩形：您可以使用虚线样式或您想要的任何样式直接在 PdfContentByte 上画一条线。

# algorithm - Excel多项式曲线拟合算法

> ID：11672385
> 
> 赞同：4
> 
> 时间：2012-07-26T15:08:45.257
> 
> 标签：algorithm, excel, interpolation, curve-fitting

Excel 用于计算二阶多项式回归（曲线拟合）的算法是什么？是否有示例代码或伪代码可用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-26T20:57:51.673

我找到了一个解决方案，它返回 Excel 给出的相同公式：

1.  将最小二乘抛物线中使用的值的增强矩阵放在一起。[请参阅http://www.efunda.com/math/leastsquares/lstsqr2dcurve.cfm](http://www.efunda.com/math/leastsquares/lstsqr2dcurve.cfm)中的求和方程

2.  使用高斯消元法求解矩阵。这是可以执行此操作的 C# 代码[http://www.codeproject.com/Tips/388179/Linear-Equation-Solver-Gaussian-Elimination-Csharp](http://www.codeproject.com/Tips/388179/Linear-Equation-Solver-Gaussian-Elimination-Csharp)

3.  运行之后，矩阵 (M) 中的剩余值将等于 Excel 中给出的系数。

也许我能以某种方式找到 R^2，但我不需要它来达到我的目的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-26T15:53:43.457

图表中的多项式趋势线使用基于 QR 分解方法的最小二乘法，例如 LINEST 工作表函数 ( [http://support.microsoft.com/kb/828533](http://support.microsoft.com/kb/828533) )。可以使用 计算给定 (x,y) 数据的二阶或二次趋势`=LINEST(y,x^{1,2})`。

`Worksheet.Evaluate`您可以使用该方法从 C# 调用工作表公式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T15:13:08.940

这取决于，因为有很多方法可以做到这一点，具体取决于您提供的数据以及曲线通过这些点的重要性。

我猜你的点比多项式中的系数多得多（例如，二阶曲线超过三个点）。

如果这是真的，那么你能做的最好的就是最小二乘拟合，它计算最小化所有点和结果曲线之间的均方误差的系数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T16:31:27.053

由于这是二阶，我的建议是创建该死的二阶项并进行线性回归。

前任。如果做z~second_order(x,y)，就相当于做z~first_order(x,y,x^2,y^2,xy)。

# javascript - 如何在客户端禁用 asp.net 验证器？

> ID：11672388
> 
> 赞同：3
> 
> 时间：2012-07-26T15:08:51.360
> 
> 标签：javascript, asp.net, validation

我有非常简单的 aspx 页面：

```
<%@ Page Language="C#" AutoEventWireup="true"  CodeFile="Default.aspx.cs" Inherits="_Default" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
</head>

<body>
    <form id="form1" runat="server">
    <div>
        <asp:textbox runat="server" ID="tbText" ValidationGroup="Address"></asp:textbox>
        <br />
        <asp:RequiredFieldValidator ID="rfvText" runat="server" ControlToValidate="tbText" 
            ValidationGroup="Address" ErrorMessage="RequiredFieldValidator">Enter text</asp:RequiredFieldValidator>
        <br />
        <asp:Button runat="server" Text="Submit" ID="btnSubmit" OnClick="Submit_Click" 
            ValidationGroup="Address" OnClientClick="DisableValidator();" />
        <script type="text/javascript">
            function DisableValidator() {
                alert('Called and disable validators before submit');

                var validator = document.getElementById("<%=rfvText.ClientID%>");
                validator.validationGroup = "someGroup";
                ValidatorEnable(validator, false);
            }
        </script>
    </div>
    </form>
</body>
</html>

using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

public partial class _Default : System.Web.UI.Page 
{
    protected void Page_Load(object sender, EventArgs e)
    {

    }

    protected void Submit_Click(object sender, EventArgs e)
    {
        Validate("Address");
        if (!IsValid)
        {
            throw new Exception("Page is no valid");
        }
    }
} 
```

页面上的所有元素都有 ValidationGroup="Address"，但我需要在单击按钮之前禁用我的验证器。因此，在客户端站点上它被禁用，但是当我尝试在服务器上验证它时，我的页面在服务器上无效但在客户端上有效。

如何禁用客户端上的验证器以在服务器上也禁用？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-06-19T21:13:00.877

您应该`EnableClientScript="False"`在**验证控件**上使用，即：

```
<asp:RequiredFieldValidator ID="rfvText" 
      runat="server" ControlToValidate="tbText"
      ValidationGroup="Address" 
      EnableClientScript="False"
      ErrorMessage="RequiredFieldValidator">Enter Text
 </asp:RequiredFieldValidator> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T15:11:09.823

当页面回发时，您必须以可编程方式禁用它，但是您解释应该在客户端上禁用验证器，然后需要在服务器上复制，并设置`Enabled="false"`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T15:16:34.983

如果您使用的是 .NET 4，请尝试使用该`EnableClientScript`属性。我自己从未使用过它，但根据[文档](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.basevalidator.enableclientscript.aspx)，它应该可以满足您的需求。

> 获取或设置一个值，该值指示是否启用客户端验证。

```
<asp:Button runat="server" Text="Click Me" EnableClientScript="False" /> 
```

# oracle - Getting an Error “ORA-06502: PL/SQL: numeric or value error: character string buffer too small”

> ID：11672395
> 
> 赞同：0
> 
> 时间：2012-07-26T15:09:13.743
> 
> 标签：oracle, plsql

This is my query

```
 begin
              select ceq_specimens.numero as NUMERO,
                       analyseEffectuee.DESCRIPTION as analyseEffectuee
              into out_rec.NUMERO_SPECIMEN3, out_rec.SPEC3_ANALYSE_EFFECTUE          
              from CEQ_FORMULAIRES_ANALYSES
              inner join ceq_liste_choix analyseEffectuee on analyseEffectuee.ID_LISTE_CHOIX=CEQ_FORMULAIRES_ANALYSES.ID_ANALYSE_EFFECTUE  
              inner join ceq_specimens on ceq_specimens.ID_SPECIMEN=CEQ_FORMULAIRES_ANALYSES.ID_SPECIMEN and ceq_specimens.ID_SPECIMEN=vintIdSpecimen3
              where CEQ_FORMULAIRES_ANALYSES.ID_FORMULAIRE=out_rec.ID_FORMULAIRE;
          EXCEPTION
            WHEN NO_DATA_FOUND THEN
            out_rec.NUMERO_SPECIMEN3 := ' ';
            out_rec.SPEC3_ANALYSE_EFFECTUE := ' ';  
          END;              

... 
```

IF analyseEffectuee.DESCRIPTION as analyseEffectuee = Spécimen impossible à analyser: Préciser en commentaire(s)

I get error ''string buffer too small”</p>

IF analyseEffectuee.DESCRIPTION as analyseEffectuee= Non

No problem in this case

Thanks for helping me!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T15:20:43.263

> 我得到错误“字符串缓冲区太小”“

这意味着您的变量`out_rec.SPEC3_ANALYSE_EFFECTUE`不足以容纳价值 `Spécimen impossible à analyser: Préciser en commentaire(s)`。

定义 PL/SQL 变量的最佳方式是使用 %TYPE 关键字。这将创建一个与列定义匹配的变量。

您的代码使用了一种叫做 OUTREC 的东西。你没有给我们这个的定义，这使得纠正你的具体问题变得更加困难，但也许你应该做这样的事情。声明一个匹配你想要的输出的 PL/SQL 记录类型，然后声明一个该类型的变量：

```
type my_rec_t is record (
    NUMERO_SPECIMEN1 ceq_specimens.numer%type,
   SPEC1_ANALYSE_EFFECTUE    analyseEffectuee.DESCRIPTION%type,        
    NUMERO_SPECIMEN2 ceq_specimens.numer%type,
   SPEC2_ANALYSE_EFFECTUE    analyseEffectuee.DESCRIPTION%type,        
    NUMERO_SPECIMEN3 ceq_specimens.numer%type,
   SPEC3_ANALYSE_EFFECTUE    analyseEffectuee.DESCRIPTION%type        
); 
out_rec my_rec_t; 
```

* * *

> ORA-02303: 不能用类型或表依赖项删除或替换类型

所以这意味着您正在使用带有继承的 SQL 类型。解决这个问题有点问题。我们可以将一些语法与 ALTER TYPE 命令一起使用，它允许我们处理依赖类型。 [了解更多。](http://docs.oracle.com/cd/B19306_01/server.102/b14200/statements_4002.htm#i2079300)

# html - importing wordpress header into vbulletin

> ID：11672400
> 
> 赞同：0
> 
> 时间：2012-07-26T15:09:22.900
> 
> 标签：html, wordpress, vbulletin

Ive made a plugin to import the header from my wp site to the vb forums header so that the user has one common header to the site. The error on calling the plugin in my header template in vb forums is

```
Fatal error: Call to undefined function language_attributes() in /home/alhussai/public_html/wp-content/themes/Karma/header.php on line 2 
```

Any idea how I can fix this?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T15:52:55.047

我不是 100% 确定，但一些 WordPress 标头模板具有动态语言属性。它在 header.php 文件中应该看起来像这样，非常接近页面顶部：

```
<html <?php language_attributes(); ?>> 
```

你可以把它改成这样：

```
<html lang="en"> 
```

# extjs4 - Center a Form Panel in the screen

> ID：11672401
> 
> 赞同：1
> 
> 时间：2012-07-26T15:09:34.647
> 
> 标签：extjs4, extjs4.1

There is a form panel, and it acts like a container. Then i have another form panel, where i am adding a textfield and a button. I need this form panel to be in the center of the screen. And the button bottom of the textbox (I should be able to position it where ever in the form. Like `Absolute` layout).

My code is as follows; and it doesn't work the way i want it to. can some one look into this

```
Ext.define('MyApp.view.MyView', {
    extend: 'Ext.form.Panel',
    alias: 'widget.myview',
    frame: true,
    height: 800,
    hidden: false,
    hideMode: 'visibility',
    id: 'myviewid',
    autoScroll: false,
    bodyPadding: 5,

    initComponent: function () {
        var me = this;

        Ext.applyIf(me, {
            items: [{
                xtype: 'form',
                height: 330,
                width: 400,
                layout: {
                    type: 'absolute'
                },
                bodyPadding: 10,
                title: 'Care Fusion User Login',
                anchor: '250 250',
                items: [{
                    xtype: 'textfield',
                    id: 'name',
                    width: 233,
                    name: 'name',
                    fieldLabel: 'Nmae',
                    growMax: 200,
                    x: 10,
                    y: 30
                } {
                    xtype: 'button',
                    height: 30,
                    width: 256,
                    text: 'Click',
                    x: 240,
                    y: 110
                }]
            }]
        });

        me.callParent(arguments);
    }

}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T18:32:45.740

尝试在外部容器中使用以下布局：

```
layout: {
  align: 'middle',
  pack: 'center',
  type: 'hbox'
}, 
```

那么你的内在形式将被放置在这个外在形式的中心。

# php - Php foreach group items into a container

> ID：11672402
> 
> 赞同：1
> 
> 时间：2012-07-26T15:09:40.890
> 
> 标签：php, foreach

I can't figure out how to group my subcategories into a container after every fifth record.

for example I would like to output my subcats like this

```
<ul>
<li>
 Main category
 <div>
  <div class="subcontainer">
   sub1
   sub2
   sub3
   sub4
   sub5
  </div>
  <div class="subcontainer">
   sub6
   sub7
   sub8
   sub9
   sub10
  </div>
 </div>
</li>
</ul> 
```

I tried this:

```
<?php
$i=0;
foreach ($cat->sub as $child) {
  if($i % 5 == 0){
   echo '<div class="subcontainer"><div>'.$child->name.'</div></div>';
  } $i++;
}
?> 
```

But this will output only the 5th elements in the array.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-26T15:11:47.303

您需要始终打印您的`$child->name`变量，并且每隔 5 项也打印该`</div><div>`部分。你几乎拥有它。

```
$i=0;
echo '<div class="subcontainer">';
foreach($cat->sub as $child) {
    $i++;
    echo $child->name; // I'm assuming this is what contains your "sub1"-"sub10"
    if ($i % 5 == 0) {
        echo '</div><div class="subcontainer">';
    }
}
echo '</div>'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T15:15:48.460

你也可以`$i`得到`foreach ($cat->sub as $i=>$child)`

# python - Adding my own description attribute to a Pandas DataFrame

> ID：11672403
> 
> 赞同：8
> 
> 时间：2012-07-26T15:09:43.590
> 
> 标签：python, metadata, dataframe, pandas

I am retrieving some web data, parsing it, and storing the output as a Pandas DataFrame into an HDF5 file. Right before I write the `DataFrame` into the H5 file, I add my own description string to annotate some metadata about where the data came from and whether anything went wrong while parsing it.

```
In [1]: my_data_frame.desc = "Some string about the data"

In [2]: my_data_frame.desc

Out[1]: "Some string about the data"

In [3]: print type(my_data_frame)
<class 'pandas.core.frame.DataFrame'> 
```

However, after loading the same data with `pandas.io.pytables.HDFStore()`, my added `desc` attribute is missing and I get the error: `AttributeError: 'DataFrame' object has no attribute 'desc'` as if I had never added this new attribute.

How can I get my metadata descriptions to persist as an extra attribute of the DataFrame object? (Or is there some existing, recognized attribute of a DataFrame that I can hijack for my metadata purposes?)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-26T15:28:46.987

添加 DataFrame 元数据或每列元数据已在路线图中，但尚未实施。不过，我对 API 应该是什么样子的想法持开放态度。

# ruby-on-rails - Rails 不正确地缓存页面 - 如何停止？

> ID：11672406
> 
> 赞同：2
> 
> 时间：2012-07-26T15:09:44.403
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有一个非常简单的测试用例来解释问题。

这是我在 Rails 中的 ERB 文件中显示的页面。

```
<div><%=rand%></div>

<p><a href="http://google.com">Go</a></p> 
```

为了显示错误，我加载了页面。我注意到随机数显示为`rand1`。我点击谷歌链接。我单击浏览器的“返回”按钮。我注意到随机数显示为`rand2`。

这就是问题所在：在 Firefox 和 Chrome 中，rand1 != rand2 （总是）。在 Safari 和 IE 中，rand1 == rand2（总是）。

为什么浏览器中的差异？为什么 Safari 和 IE 缓存 Rails 的输出，而其他两个浏览器没有？如何让 Safari 和 IE 刷新页面？

（这是一个显示问题的简单测试用例 - 这对我的 Backbone 应用程序有影响）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T15:37:44.940

显然，IE 和 Safari 似乎正在缓存来自服务器的响应；只要您的浏览器配置正确，您就可以通过更改响应中的 Cache-Control 标头来更改此设置。

[另一个 Stack Overflow 帖子](https://stackoverflow.com/questions/711418/how-to-prevent-browser-page-caching-in-rails)显示了执行此操作的适当方法，尽管在 Rails 3 中有一个快捷方法可以完成此操作：您可以[`expires_now`](http://api.rubyonrails.org/classes/ActionController/ConditionalGet.html#method-i-expires_now)在控制器操作中调用以避免手动设置所有这些标头。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T13:02:53.737

WebKit 尤其具有积极的页面缓存策略，可以准确地处理您所描述的情况（单击链接，然后立即单击后退按钮）。这个想法是通过不仅缓存资源而且缓存 DOM 和页面的其他状态，使后退动作几乎立即发生。您可以在这两篇文章中了解它：

*   [WebKit 页面缓存 I — 基础](http://www.webkit.org/blog/427/webkit-page-cache-i-the-basics/)
*   [WebKit 页面缓存 II —`unload`事件](http://www.webkit.org/blog/516/webkit-page-cache-ii-the-unload-event/)

您也许可以使用`load`/`unload`和`pageshow`/`pagehide`事件的组合来完成您需要的事情。

我不确定 IE 是否实现了类似于 WebKit 的东西，但也许这也能解决它。

# java - Concatenating mp3 files in android

> ID：11672408
> 
> 赞同：0
> 
> 时间：2012-07-26T15:09:58.903
> 
> 标签：java, android, mp3

> **Possible Duplicate:**
> [What is the best way to merge mp3 files?](https://stackoverflow.com/questions/62618/what-is-the-best-way-to-merge-mp3-files)

I need to Concatenate mp3 files in my app. Like a.pm3 + b.mp3= ab.mp3 . Any idea how to achieve this in android.

# javascript - jQuery binding AJAX events without DOM element

> ID：11672410
> 
> 赞同：3
> 
> 时间：2012-07-26T15:10:07.563
> 
> 标签：javascript, jquery

In the [documentation of jQuery AJAX Events](http://api.jquery.com/category/ajax/global-ajax-event-handlers/) all the examples use a *jQuery DOM Element* for declare a binding like this:

```
$('.log').ajaxSend( hander ); 
```

I want to catch *jQuery AJAX Events* without the need of having a DOM Element to attach them, like this:

```
$.ajaxSend( function( event, jqXHR, ajaxOptions ){
  console.log( "ajaxSend" );
  console.log( "ajaxSend.event", event );
  console.log( "ajaxSend.jqXHR", jqXHR );
  console.log( "ajaxSend.ajaxOptions", ajaxOptions );
}); 
```

But It looks like it doesn't work:

```
Uncaught TypeError: Object function (a,b){return new e.fn.init(a,b,h)} has no method 'ajaxSend' 
```

Any suggestion?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T15:11:09.923

你可以使用`document`：

```
$(document).ajaxSend( hander ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T15:40:30.337

听起来您想自定义 ajax 调用，其中使用 $.fn.ajax 调用效果很好：

```
$.ajax('{your_url}', options); 
```

# playframework-2.0 - How to add boolean attributes / data-attributes in Play 2.0 templates?

> ID：11672411
> 
> 赞同：2
> 
> 时间：2012-07-26T15:10:08.347
> 
> 标签：playframework-2.0

does anybody know how to add `boolean attributes` like `autofocus` to scala templates?

Example: `autofocus`:

```
<input autofocus /> 
```

For now I use:

```
'autofocus -> "autofocus" 
```

This prints:

```
<input type="text" autofocus="autofocus" /> 
```

And how to add custom data-attributes? Thanks!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-20T21:32:14.470

使用`None`，像这样：

```
@inputText(
  loginForm("username"),
  '_label -> Messages("usernameLabel"),
  'required -> None,
  'autofocus -> None
) 
```

它将输出如下元素：

```
<input type="text" id="username" name="username" value="" required autofocus> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T15:12:29.047

这行得通，但我（希望）仍然认为在 scala 中应该有更简单的方法！

```
'autofocus -> "autofocus" 
```

# ruby-on-rails - list all user's objects

> ID：11672413
> 
> 赞同：0
> 
> 时间：2012-07-26T15:10:12.243
> 
> 标签：ruby-on-rails, list, show

as the title says I'm trying to list all cars of one specific user, also each car has two options show and update ![enter image description here](../Images/46a6a4f9166359f282decf44f2d13e1f.png)

as you see in the picture, my problem is when I want to show or edit the selected car, it routes (look the bottom left of the image) it takes all the ids of all the cars for example users/"id"/cars/"id1"/"id2" instead to take the id of the specific car: users/"id"/cars/"id1"/ here is te index.html.erb file:

```
<div class="container">
<h1>Listing Cars</h1>

<table class="table table-condensed">
  <tr>
    <th>Brand</th>
    <th>Color</th>
    <th>Model</th>
    <th>Year</th>
    <th></th>
    <th></th>
  </tr>

  <% @car.each do |car| %>
    <tr>
      <td><%= car.brand %></td>
      <td><%= car.color %></td>
      <td><%= car.model %></td>
      <td><%= car.year %></td>
      <td><%= link_to 'Show', user_car_path(@user,@car) %></td>
      <td><%= link_to 'Edit', edit_user_car_path(@user, @car) %></td>
    </tr>
    <% end %>
</table>
<br />
<%= link_to 'New car', new_user_car_path, :class => "btn btn-primary" %>
</div> 
```

and whether you need the car controller:

```
class CarsController < ApplicationController
def new
    @user = User.find(params[:user_id])
    @car = @user.cars.build
end

def create
    @user = User.find(params[:user_id])
    @car = @user.cars.build(params[:car])
      if @car.save
        redirect_to user_car_path(@user, @car), :flash => { :notice => "  car created!" }
      else
        redirect_to new_user_car_path ,:flash => { :notice => " sorry try again :(" }
      end
end

def show
  @user = User.find(params[:user_id])     
  @car = @user.cars.find(params[:id]) 
  #redirect_to user_car_path(@user, @car)  
end
def index
  @user = User.find(params[:user_id])     
  @car = @user.cars.all
end
def edit
  @user = User.find(params[:user_id])     
  @car = @user.cars.find(params[:id]) 
  #redirect_to user_car_path(@user, @car)  
end
def update
@user = User.find(params[:user_id])  
@car = @user.cars.find(params[:id])
if @car.update_attributes(params[:car])
  redirect_to user_cars_path, :flash => { :notice => "  Car Updated!" }
else
  render 'edit'
end
end
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T15:13:54.277

在 Ruby 枚举器中，块变量是枚举器的每个成员，一个接一个。因此，如果在您的示例代码中`@cars`is `["Toyota", "Mazda", "Honda"]`， then`car`将是 first `"Toyota"`， then `"Mazda"`， then `"Honda"`。

当您应该使用块变量时，这是说您使用实例变量的方式很长。;) 更正您的代码，使其如下所示：

```
 <% @car.each do |car| %>
    <tr>
      <td><%= car.brand %></td>
      <td><%= car.color %></td>
      <td><%= car.model %></td>
      <td><%= car.year %></td>
      <td><%= link_to 'Show', user_car_path(@user, car) %></td>
      <td><%= link_to 'Edit', edit_user_car_path(@user, car) %></td>
    </tr>
    <% end %> 
```

它应该`car`，而不是`@car`，在您的路线中。

# javascript - 在 jQuery mobile 中更改按钮文本的字体大小

> ID：11672421
> 
> 赞同：4
> 
> 时间：2012-07-26T15:10:35.520
> 
> 标签：javascript, jquery, css, mobile, jquery-mobile

我在 a 中有 2 个 jQuery 移动按钮，`fieldset`并且想更改`font-size`其中一个按钮的。我尝试添加内联样式，但没有奏效。

我也试过这个，但也没有用：

```
.myButton
{
   word-wrap: break-word !important;
   white-space: normal !important;
} 
```

这就是正在发生的事情：（仅在 iPhone 上）

![在此处输入图像描述](../Images/a95151375255045924ce4e6fe9c043f5.png)

因为 iPhone 的屏幕尺寸，“请求更改”按钮正在被切断。

**有没有办法让我更改`font-size`按钮文本的，以便它显示完整的文本而不会被截断？**

**HTML：**

```
<fieldset class="ui-grid-a">
    <div class="ui-block-a">
        <input data-mini="true" type="submit" value="Cancel"  name="Submitbutton" class="button button-link"/>
    </div>
    <div class="ui-block-b">
        <input data-mini="true" data-theme="b" type="submit" value="Request Change" name="Submitbutton" class="button button-link" /> 
    </div>
</fieldset> 
```

**我努力了：**

*   [jquery移动按钮文本自动换行符](https://stackoverflow.com/questions/10351891/jquery-mobile-button-text-auto-line-break)
*   [在运行时更改 jQuery Mobile 按钮的字体大小](https://stackoverflow.com/questions/11657687/change-font-size-of-a-jquery-mobile-button-at-runtime)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-26T16:17:36.570

使用以下内容查找 iPhone 屏幕上的最佳内容

​</p>

```
.ui-btn-inner{
    text-overflow: initial; /* Get rid of the ellipsis */
    padding-left: 5px; /* Play with padding to make max use of available button width */
}
.ui-btn-text {
    font-size: 15px; /* Play with font size of the text */
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T15:57:39.703

现场示例：

*   [http://jsfiddle.net/Pjvvx/](http://jsfiddle.net/Pjvvx/)（宽度）
*   [http://jsfiddle.net/3DSGT/](http://jsfiddle.net/3DSGT/)（高度）

JS：

```
// For all buttons use something like this
$('.ui-btn').css('width','50%');

// For individual buttons use something like this
$('#theButton1').parent().css('width', '75%');

// Or this for HREF data-role buttons
$('#hrefButton4').css('width', '45%');

// this changes the height for all buttons
$('.ui-btn-text').css('font-size','50px');

// This changes the height for a single element 
$('#hrefButton3').children().children().css('font-size','30px'); 
```

我认为你正在寻找做这样的事情：

```
$('#hrefButton3').children().children().css('font-size','10px'); 
```

HTML：

```
<div data-role="page" id="home"> 
    <div data-role="content">
        <input type="button" id="theButton1" value="Press Me 1" />
        <input type="button" id="theButton2" value="Press Me 2" />
        <input type="button" id="theButton3" value="Press Me 3" />
        <input type="button" id="theButton4" value="Press Me 4" />
        <br />
        <a href="#" data-role="button" id="hrefButton1">HREF Me 1</a>
        <a href="#" data-role="button" id="hrefButton2">HREF Me 2</a>
        <a href="#" data-role="button" id="hrefButton3">HREF Me 3</a>
        <a href="#" data-role="button" id="hrefButton4">HREF Me 4</a>
    </div>
</div> 
```

有关的：

*   [通过 CSS 调整按钮的大小](https://stackoverflow.com/questions/7303035/resizing-a-button-through-css)

# sql-server - 合并交叉引用表中的行

> ID：11672428
> 
> 赞同：0
> 
> 时间：2012-07-26T15:10:54.363
> 
> 标签：sql-server, merge, rows, junction-table

我想创建一个 SQL Server`select`语句，其中交叉引用的数据位于不同行的一列中。我想使用`stuff`（如果可能的话）并且没有`;with`命令。

**合约**表

```
ID  Subject
1   a
2   b
3   c 
```

**公司**表

```
ID  Name
1   a_ltd
2   b_ltd
3   c_ltd
4   d_ltd
5   e_ltd 
```

**ContractContractorCrossRef**表（联结表）

```
ID  ContractID_ CompanyID_
1   1               1
2   1               2
3   2               3
4   3               1
5   3               4
6   3               5 
```

我想要这个结果：

```
Contract.ID company.Name
1           a_ltd, b_ltd
2           c_ltd
3           a_ltd, d_ltd, e_ltd 
```

**填充数据：**

```
create table #Contract (ID INT, Subject VARCHAR(1))
INSERT  #Contract
SELECT  1, 'a' UNION ALL
SELECT  2, 'b' UNION ALL
SELECT  3, 'c'

create table #Company (ID INT, Name VARCHAR(5))
INSERT  #Company
SELECT  1, 'a_ltd' UNION ALL
SELECT  2, 'b_ltd' UNION ALL
SELECT  3, 'c_ltd' UNION ALL
SELECT  4, 'd_ltd' UNION ALL
SELECT  5, 'e_ltd'

create table #ccRef (ID INT, ContractID_ INT, CompanyID_ INT)
INSERT  #ccRef
SELECT  1, 1, 1 UNION ALL
SELECT  2, 1, 2 UNION ALL
SELECT  3, 2, 3 UNION ALL
SELECT  4, 3, 1 UNION ALL
SELECT  5, 3, 4 UNION ALL
SELECT  6, 3, 5 
```

**选择：**

```
select #Contract.ID, #Company.Name from #Contract
inner join #ccRef on #Contract.ID = #ccRef.ContractID_ inner join #Company
on #ccRef.CompanyID_ = #Company.ID 
```

**选择结果：（不想要）**

```
ID  Name
1   a_ltd
1   b_ltd
2   c_ltd
3   a_ltd
3   d_ltd
3   e_ltd 
```

**要求的结果：**

```
Contract.ID company.Name
1           a_ltd, b_ltd
2           c_ltd
3           a_ltd, d_ltd, e_ltd 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T15:34:19.210

您可以执行以下操作：

```
SELECT x.id
  , left(CompanyName, len(CompanyName)-1) as CompanyName
FROM
(
  SELECT DISTINCT ct.id
    , (SELECT CAST(co.Name + ', ' AS VARCHAR(MAX)) 
           FROM contractcompanycrossref cc
           LEFT JOIN company co
            on cc.companyid = co.id
           WHERE (cc.contractid = ct.id) 
           FOR XML PATH ('')
        ) AS CompanyName
  from contract ct
  left join contractcompanycrossref cc
    on ct.id = cc.contractid
) x 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/f3004/14)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T15:49:58.737

试试这个。我没有测试代码，因为我没有这些表的 ddl。但它应该可以工作..

```
 SELECT ct.id ,
 left(companyname.value('.','varchar(max)'), len(companyname.value('.','varchar(max)'))-1) as companyname 
from 
    contract ct 
    cross apply 
    ( 
    select cm.name + ',' [text()]
    from 
    contractcompanycrossref cc 

    inner join company cm
    on cc.companyid = cm.ID
      where ct.id = cc.contractid 
    for xml path (''),type
    ) cmnames(companyname) 
```

# asp.net - 清除数据绑定的 asp.net Listview 时引发 System.IndexOutOfRangeException

> ID：11672435
> 
> 赞同：0
> 
> 时间：2012-07-26T15:11:31.530
> 
> 标签：asp.net, c#-4.0, listview, objectdatasource

我有一个当前绑定到 ObjectDataSource 的 asp ListView。ObjectDataSource 的 select 方法有一个与隐藏标签绑定的参数。因此，要清除我的 ListView，我只需将隐藏标签的文本属性设置为 string.Empty 并绑定 ListView 的数据。这很好用，但是如果用户单击我的 ListView`<th>`标签之一，它对 ListView 进行排序，然后单击“清除”按钮，它会抛出一个`System.IndexOutOfRangeException: Cannot find column name`.

这是唯一一次抛出这个异常，如果 ListView 在没有被排序的情况下被清除，那么一切都是笨拙的。

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T16:19:56.800

在您的 Clear() 方法中，您是迭代还是使用特定的列名来删除项目？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T16:28:11.397

我认为当标签为空白时，您的数据源什么也没有返回，甚至没有表模式。这将意味着您的 ListView 将没有数据，包括不知道列可能是什么。因此，当您告诉它对某个列进行排序时，它会抱怨它找不到该列。

我想两个最简单的修复方法是在清除排序列时删除它，或者确保 ListView 始终知道它至少有哪些列。

# javascript - d3.js 可以使用来自同一来源的数据在同一图表上绘制两个散点图吗？

> ID：11672438
> 
> 赞同：13
> 
> 时间：2012-07-26T15:11:44.287
> 
> 标签：javascript, d3.js

我发现的所有 d3 教程都使用排列在对象数组中的数据，他们从中为数组中的每个对象绘制一个点。给定以下结构的数据：

```
data = [
     {id: 1, x: 4, y: 10, type: 1},
     {id: 2, x: 5, y: 20, type: 2}
     ...
] 
```

x 和 y 值用于制作散点图。type 参数用于改变每个点的颜色。有关示例，请参见此 jsfiddle：http: [//jsfiddle.net/uxbHv/](http://jsfiddle.net/uxbHv/)

不幸的是，我有不同的数据结构，我无法弄清楚如何通过为每个对象绘制两个数据点来创建相同的图形。以下是一些示例数据：

```
dataSet = [
     {xVar: 5, yVar1: 90, yVar2: 22},
     {xVar: 25, yVar1: 30, yVar2: 25},
     {xVar: 45, yVar1: 50, yVar2: 80},
     {xVar: 65, yVar1: 55, yVar2: 9},
     {xVar: 85, yVar1: 25, yVar2: 95}
] 
```

我可以针对 yVar1 或 yVar2 分别绘制 xVar，但我无法弄清楚如何在同一个图表上同时获得两者：http: [//jsfiddle.net/634QG/](http://jsfiddle.net/634QG/)

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-07-26T17:48:25.060

使用[数据连接](http://bost.ocks.org/mike/join/)时的一般规则是您需要**从数据到元素的一对一映射**。因此，如果您的散点图中有两个系列，您将需要两个容器元素（例如[G 元素](http://www.w3.org/TR/SVG/struct.html#Groups)）来表示该系列。由于您目前只有一个`data`数组，因此您还需要使用[array.map](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/map)将数据表示转换为具有相同表示的两个并行数组。这样，您不必为每个系列重复代码。

假设您的数据以 CSV 文件的形式表示，其中一列用于*x*值，而其他多列用于每个系列的*y值：*

```
x,y1,y2
5,90,22
25,30,25
45,50,80
65,55,9
85,25,95 
```

如果您希望代码完全通用，您首先需要计算系列的名称，例如`["y1", "y2"]`. （如果您在 CSV 文件中添加了第三列，它可能是`["y1", "y2", "y3"]`.）您可以使用[d3.keys](https://github.com/mbostock/d3/wiki/Arrays#wiki-d3_keys)计算名称，它从对象中提取命名属性。例如，`d3.keys({foo: 1, bar: 2})`返回`["foo", "bar"]`.

```
// Compute the series names ("y1", "y2", etc.) from the loaded CSV.
var seriesNames = d3.keys(data[0])
    .filter(function(d) { return d !== "x"; })
    .sort(); 
```

现在您有了系列名称，您可以创建一个点数组数组。外部数组表示系列（其中有两个），内部数组存储数据点。您可以同时将点转换为一致的表示（具有`x`和`y`属性的对象），从而允许您跨系列重用代码。

```
// Map the data to an array of arrays of {x, y} tuples.
var series = seriesNames.map(function(series) {
  return data.map(function(d) {
    return {x: +d.x, y: +d[series]};
  });
}); 
```

请注意，此代码使用`+`运算符将​​ CSV 值强制转换为数字。（CSV 文件是无类型的，所以它们最初是字符串。）

现在您已将数据映射为常规格式，您可以为每个系列创建 G 元素，然后为每个点圈出其中的元素。生成的 SVG 结构将如下所示：

```
<g class="series">
  <circle class="point" r="4.5" cx="1" cy="2"/>
  <circle class="point" r="4.5" cx="3" cy="2"/>
  …
</g>
<g class="series">
  <circle class="point" r="4.5" cx="5" cy="4"/>
  <circle class="point" r="4.5" cx="7" cy="6"/>
  …
</g> 
```

以及对应的D3代码：

```
// Add the points!
svg.selectAll(".series")
    .data(series)
  .enter().append("g")
    .attr("class", "series")
    .style("fill", function(d, i) { return z(i); })
  .selectAll(".point")
    .data(function(d) { return d; })
  .enter().append("circle")
    .attr("class", "point")
    .attr("r", 4.5)
    .attr("cx", function(d) { return x(d.x); })
    .attr("cy", function(d) { return y(d.y); }); 
```

我还添加了一些代码，通过向包含的 G 元素添加填充样式来为每个系列分配唯一的颜色。当然，有很多不同的方法可以做到这一点。（例如，您可能希望更具体地了解每个系列的颜色。）我还省略了计算*x*和*y*比例域（以及渲染轴）的代码，但如果您愿意查看整个工作示例：

*   [http://bl.ocks.org/3183403](http://bl.ocks.org/3183403)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-26T15:23:14.160

将每个数据点的两个圆圈放入一个`svg:g`元素中。这会生成数据到元素的一对一映射，但仍允许您显示两个不同的点。

```
var nodeEnter = vis1.selectAll("circle")
      .data(dataSet)
      .enter()
      .insert("svg:g");

nodeEnter.insert("svg:circle")
           .attr("cx", function (d) { return 100 - d.xVar})
           .attr("cy", function (d) { return 100 - d.yVar1})
           .attr("r", 2)
           .style("fill", "green");

nodeEnter.insert("svg:circle")
           .attr("cx", function (d) { return 100 - d.xVar})
           .attr("cy", function (d) { return 100 - d.yVar2})
           .attr("r", 2)
           .style("fill", "blue"); 
```

工作**[JSFiddle](http://jsfiddle.net/brantolsen/634QG/5/)**。

# plone - 使用带有 notheme 的 diazo 将类添加到 body 标签

> ID：11672440
> 
> 赞同：3
> 
> 时间：2012-07-26T15:11:48.143
> 
> 标签：plone, diazo

我正在使用 `plone/document?ajax_load=True&ajax_include_head=True`iframe 的 src 在叠加层中显示文档的内容。

在开发模式下附加`&diazo.off=1`就可以了。在生产服务器上，这很遗憾不起作用，所以我按照[plone.app.theming 文档中的建议添加了 ajax_load 参数](http://pypi.python.org/pypi/plone.app.theming#theme-parameters)

我将所有指令包装在一个 `<rules if-not="$ajax_load">`元素中以确保它们不被应用（见下面的代码）

现在我需要用某个类标记 iframed 页面的主体以应用不同的样式（例如，覆盖中的主体没有背景颜色）

为[几乎类似的问题](https://stackoverflow.com/questions/6599993)提出的解决方案 仅在您使用的主题具有 body 元素时才有效，该 body 元素具有要操作的类属性。

有没有办法在没有主题的情况下向内容添加类（使用）？还是我必须提供一个空的 html 文档 (index2.html) 作为主题并应用大量规则来复制 css/js 等两次？

```
<rules if="$ajax_load">

    <!-- theme href="index.html" /-->

    <notheme />

    <!-- only works when using a theme -->
    <before theme-children="/html/body"><xsl:attribute name="class"><xsl:value-of select="/html/body/@class"/> my class</xsl:attribute></before>

    <!-- thought this could to the trick but does not work at all -->
    <xsl:template match="html/body">
    <xsl:attribute name="class"> foo</xsl:attribute>
    </xsl:template>

</rules>

<rules if-not="$ajax_load">

    <theme href="index.html" />

    <replace content="/html/head/title" theme="/html/head/title" />
    ... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-29T22:10:21.917

显然，如果没有要操作的主题，任何引用主题的规则都不能与`<notheme/>`. 但是你可以满足（我有如何实现和满足的想法`<drop>`，但它很难实现。也许在 Diazo 的未来版本中。）但是你可以用少量的 xslt 来实现同样的事情：`<replace>``<before>``<after>`

```
<replace content="/html/body/@class">
    <xsl:attribute name="class"><xsl:value-of select="."/> newclass</xsl:attribute>
</replace> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T15:36:20.807

如果您将 plone.app.jquerytools 用于叠加层，则可以传递一个类参数：

```
$('a.myPopover').prepOverlay({
    subtype: 'iframe',
    cssclass: 'my-popover'
}); 
```

在我们的一些使用 plone.app.tiles 的项目中，我们使用了一个特定的主题模板来覆盖，它被剥离了所有不必要的部分并简化为单个包装 div，并将其用于平铺编辑视图，如下所示：

```
<theme href="minimal.html" if-path="@@edit-tile" /> 
```

# c# - 如何从 Microsoft Excel 中的加载项代码进入/启动单元格编辑模式？

> ID：11672445
> 
> 赞同：0
> 
> 时间：2012-07-26T15:12:15.273
> 
> 标签：c#, interop, vsto, excel-2010, excel-interop

有没有办法让 Excel 2010 进入单元格编辑模式，从用 C# 编写的 Visual Studio 2010、.NET 4.0 和 VSTO 4.0（或其他版本的 Excel 和加载项开发）的加载项代码中选择单元格工具 - 除了发送*按键*事件）？

您能否提供对允许将 Excel 2010 从加载项代码切换到单元格编辑模式的类和方法的文档的参考，或对明确说明 VSTO 中没有用于将 Excel 切换到*编辑模式*的 API 的文档的参考。

# objective-c - IOS - 按顺序加载本地文件

> ID：11672449
> 
> 赞同：3
> 
> 时间：2012-07-26T15:12:20.890
> 
> 标签：objective-c, ios, nsfilemanager

我在应用程序的 Document 文件夹中有一个图像列表。我想按创建日期的顺序加载图像。我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-26T15:38:48.690

此代码将按照创建顺序枚举您的文档目录中的所有文件：

查看代码中的注释以了解发生了什么。

```
NSFileManager *fm = [NSFileManager defaultManager];
NSString *doc = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];
NSError *err;
// Get all files with their creation date
NSArray *files = [fm contentsOfDirectoryAtURL:[[NSURL alloc] initFileURLWithPath:doc isDirectory:YES]
    includingPropertiesForKeys:[NSArray arrayWithObject:NSURLCreationDateKey]
    options:0
    error:&err];
// Using file's URL as the key, store creation date as the value
NSMutableDictionary *urlWithDate = [NSMutableDictionary dictionaryWithCapacity:files.count];
for (NSURL *f in files) {
    NSDate *creationDate;
    if ([f getResourceValue:&creationDate forKey:NSURLCreationDateKey error:&err]) {
        [urlWithDate setObject:creationDate forKey:f];
    }
}
// Sort the dictionary on the value, which is the creation key
for (NSURL *f in [urlWithDate keysSortedByValueUsingComparator:^NSComparisonResult(id obj1, id obj2) {
    return [obj1 compare:obj2];
}]) {
    // Check if the file is an image. Load if it is an image, otherwise skip.
    NSLog(@"%@", f);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T15:24:59.657

我会看一下：[Getting a list of files in a directory with a glob](https://stackoverflow.com/questions/499673/getting-a-list-of-files-in-a-directory-with-a-glob)

特别是 NSFileManager。您可以查看文件的属性。从那里您很可能可以使用 NSPredicate 进行排序。

# php - 如何连续捕获 telnet 会话/scoket 输出（fread）？

> ID：11672451
> 
> 赞同：1
> 
> 时间：2012-07-26T15:12:26.710
> 
> 标签：php, sockets

我`fputs`在 socket/telnet 控制台上执行命令（）并`fread`通过下面的代码获取输出/结果（），它工作得很好。

```
//open socket let's say ip = 192.168.10.5 and port = 21
$this->socketResource = fsockopen($this->nodeIp,$this->portNumber);
//execute some commands, for example "ipconfig"
fputs($this->socketResource,$command);
//get output string
$output = fread($this->socketResource,30000); 
```

现在我的要求是在不通过 fputs 执行任何命令的情况下获取所有控制台/套接字输出。例如，Cisco 路由器在 telnet 控制台/套接字上提供连续的调试消息/打印，而无需通过 fputs 执行任何命令。

如何`fread`在不执行任何命令（）的情况下连续捕获（）任何 telnet 会话输出`fputs`？

如果我像每 x 秒那样以离散方式捕获，我肯定会错过一些控制台输出。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T15:27:54.753

为此，我会切换到[`stream_*`](http://www.php.net/manual/en/function.socket-connect.php)家庭。当试图通过性能和扩展来完成上述任务时，会有很大的改进。

```
$stream = stream_socket_client("tcp://10.1.1.1:23", $errno, $errstr, 30);
if (!$stream ) {
    echo "$errstr ($errno)<br />\n";
} else {
    fwrite($stream , "sh run" . PHP_EOL);

    // Set Blocking Mode - Wait For A Response On The Stream
    stream_set_blocking( $stream , true );
    while( true ){

        // This is your response
        echo stream_get_contents( $stream );
    }

} 
```

你需要在上面添加一些东西来打破`while(true)`循环，否则脚本将永远运行，但这是我用来做类似事情的一种方法。

# python - 在 Python 中打开一个文件进行输入和输出

> ID：11672453
> 
> 赞同：2
> 
> 时间：2012-07-26T15:12:29.387
> 
> 标签：python, file, python-3.x

我有以下代码，旨在删除文件的特​​定行。当我运行它时，它会打印目录中的两个文件名，然后删除其中的所有信息。我究竟做错了什么？我在 Windows 下使用 Python 3.2。

```
import os

files = [file for file in os.listdir() if file.split(".")[-1] == "txt"]

for file in files:
    print(file)
    input = open(file,"r")
    output = open(file,"w")

    for line in input:
        print(line)
        # if line is good, write it to output

    input.close()
    output.close() 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-26T15:14:20.523

`open(file, 'w')`擦除文件。为防止这种情况发生，请以`r+`模式（读+写/不擦除）打开它，然后一次读取所有内容，过滤行，然后再次将它们写回。就像是

```
with open(file, "r+") as f:
    lines = f.readlines()              # read entire file into memory
    f.seek(0)                          # go back to the beginning of the file
    f.writelines(filter(good, lines))  # dump the filtered lines back
    f.truncate()                       # wipe the remains of the old file 
```

我假设这`good`是一个告诉是否应该保留一行的函数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-26T15:20:02.920

如果您的文件适合内存，最简单的解决方案是打开文件进行读取，将其内容读取到内存，关闭文件，打开文件进行写入并将过滤后的输出写回：

```
with open(file_name) as f:
    lines = list(f)
# filter lines
with open(file_name, "w") as f:      # This removes the file contents
    f.writelines(lines) 
```

由于您没有混合读取和写入操作，因此`"r+"`这里不需要像这样的高级文件模式，只会使事情复杂化。

如果文件不适合内存，通常的方法是将输出写入一个新的临时文件，并在处理完成后将其移回原始文件名。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T15:58:53.203

一种方法是使用`fileinput`stdlib 模块。然后你不必担心打开/关闭和文件模式等......

```
import fileinput
from contextlib import closing
import os

fnames = [fname for fname in os.listdir() if fname.split(".")[-1] == "txt"] # use splitext
with closing(fileinput.input(fnames, inplace=True)) as fin:
    for line in fin:
        # some condition
        if 'z' not in line: # your condition here
            print line, # suppress new line but adjust for py3 - print(line, eol='') ? 
```

使用时`inplace=True`- 文件输入重定向`stdout`到当前打开的文件。创建具有默认“.bak”扩展名的文件的备份，如果需要，它可能会派上用场。

```
jon@minerva:~$ cat testtext.txt
one
two
three
four
five
six
seven
eight
nine
ten 
```

在以下条件下运行上述内容后`not line.startswith('t')`：

```
jon@minerva:~$ cat testtext.txt
one
four
five
six
seven
eight
nine 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T15:18:04.927

当您打开文件写入文件时，您正在删除所有内容。您不能同时对文件进行打开读取和写入。改为使用`open(file,"r+")`，然后在写入任何内容之前将所有行保存到另一个变量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-26T15:18:22.323

您不应该同时打开同一个文件进行读取和写入。

“w”表示创建一个空的写作。如果该文件已存在，则其数据将被删除。

因此，您可以使用不同的文件名进行写入。

# excel - 如何在单元格范围内设置 0 默认值？

> ID：11672456
> 
> 赞同：1
> 
> 时间：2012-07-26T15:12:44.760
> 
> 标签：excel, excel-2010, vba

我使用一系列单元格（列 FGH）进行估计，并且估计为 0 小时是可以接受的，但空白/空则不是。看到用户可以添加他们认为合适的行，我想确保除标题 (row1) 之外的列 (FGH) 中的所有单元格默认为 0（如果需要，用户可以更改/覆盖它）。

有没有办法可以为这个特定范围的新创建的行强制执行此操作？我知道我可以在现有单元格中使用公式，但这对事后用户创建的行没有帮助。

（顺便说一句 - 同样，对于 CI 列，希望将单元格默认为“WI-”，对于 DI 列，希望将单元格默认为“REQ-”，等等......）。

任何帮助/提示/想法将不胜感激。
谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:22:48.773

做这个。

1.  在未使用的单元格中输入数字 1
2.  复制该单元格。
3.  突出显示您希望用零替换空白的单元格。
4.  从菜单中选择“编辑”>“选择性粘贴”。
5.  在对话框的“操作”部分中，选择“乘”并单击“确定”。
6.  数字单元格不会更改，包含任何文本数据的单元格将被忽略。
7.  所有空白单元格现在都将包含一个零。

要将此应用于新添加的行，请使用`Worksheet_Change`您将在其中预定义适用范围的事件。只需为上述步骤录制一个宏并在`Worksheet_Change`事件中使用该代码。

还要记住使用正确的错误处理并`Application.EnableEvents = False`在错误处理程序中再次设置和重置它。

> （顺便说一句 - 同样，对于 CI 列，希望将单元格默认为“WI-”，对于 DI 列，希望将单元格默认为“REQ-”，等等......）。

为此，上述方法将不起作用。您将不得不在 VBA 中处理它

# mysql - YII CDBCriteria 过滤列

> ID：11672458
> 
> 赞同：1
> 
> 时间：2012-07-26T15:12:48.973
> 
> 标签：mysql, yii

我对 YII 相当陌生，但仍在努力理解这一切。但是，据我所知，当您执行类似的操作时

```
 yourModel->findAll(criteria) 
```

就像“选择*来自”？还是更像“选择您的模型-> 属性”？无论哪种情况，我都想知道 CDbCriteria 是否有办法从选择中删除列。我的情况是，我有一个包含密码的用户表，我想防止将其添加到查询中。

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T15:27:28.703

当然你可以选择特定的列，只需使用[`select`CDbCriteria 的属性](http://www.yiiframework.com/doc/api/1.1/CDbCriteria#select-detail "http://www.yiiframework.com/doc/api/1.1/CDbCriteria#select-detail")：

```
$criteria=new CDbCriteria();
$criteria->select='column1, column2';// or you can use array array('column1','column2')
$manymodels=$yourmodel->findAll($criteria); 
```

所以它更像是：“选择标准->从你的模型类的 dbtable 中选择”。

请注意，这[`findAll()`](http://www.yiiframework.com/doc/api/1.1/CActiveRecord#findAll-detail "http://www.yiiframework.com/doc/api/1.1/CActiveRecord#findAll-detail")将返回一个模型数组。

# ruby - 如何在 Sinatra 中访问表单选定文件的文件内容？

> ID：11672461
> 
> 赞同：0
> 
> 时间：2012-07-26T15:13:03.747
> 
> 标签：ruby, sinatra, forms

我需要从 HTML 表单中获取一个 .csv 文件并解析所有数据。

现在，我在 ruby​​ 脚本中使用 CSV gem 来解析本地文件并使用以下代码将其发布到 Pardot 表单处理程序：

```
require 'net/http'
require 'uri'
require 'csv'

uri = URI('<form handler url>')

CSV.foreach("<csv file location>", :headers => :first_row) do |row|
  res = Net::HTTP.post_form(uri,    'city' => row['city'],
                                'state' => row['state'],
                                'zip' => row['zip'],
                                'country' => row['country'],
                                'phone' => row['phone'],
                                'fax' => row['fax'],
                                'website' => row['website'],
                                'first_name' => row['first_name'],
                                'last_name' => row['last_name'],
                                'job_title' => row['job_title'],
                                'Company' => row['Company'],
                                'leadtype' => row['leadtype'],
                                'tradeshow_attended' => row['tradeshow_attended'],
                                'industry' => row['industry'],
                                'email' => row['email'],
                                'boothsize' => row['boothsize'],
                                'company' => row['company'],
                                'source' => row['source'],
                                'address_one' => row['address_one'],
                                'address_two' => row['address_two']
                                )
end 
```

现在我创建了一个带有简单表单的 Sinatra 站点，该表单具有 url 的文本输入和 csv 文件的文件上传。

我想要做的是将 CSV 文件的数据拉到上面的脚本中。

这是我的表格：

```
<form action="" enctype="multipart/form-data" method="post">
                <p>
                    <label>Form Handler URL</label><input name="url" type="text"/>
                </p>
                <p>
                    <label>Please specify a file</label>
                    <input type="file" name="datafile">
                </p>
                <div>
                    <input type="submit" value="Submit">
                </div>
            </form> 
```

我可以使用获取文件信息

```
params[:datafile] 
```

**如何获取通过此表单上传的文件的文本？** 该文件不会保存在服务器上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T15:36:38.117

碰巧该文件已经保存在服务器上（尽管作为临时文件对象保存在临时文件中）。您可以通过`:tempfile`params-hash 访问它：

```
content = params[:datafile][:tempfile].read 
```

# .net - ASP.NET Web API：它的目标是什么？

> ID：11672462
> 
> 赞同：1
> 
> 时间：2012-07-26T15:13:04.517
> 
> 标签：.net, rest, soa, asp.net-web-api, saas

我一直在玩 ASP.NET Web API 示例 (http://www.asp.net/web-api/samples)。

经过几个小时的阅读文章，检查源代码等，我得到了一个问题。

ASP.NET Web API 的目标是什么？

*   用于将系统的某些子集暴露给第三方的网站的 RESTful API。

...或/和？？？...

*   纯 RESTful API 不一定适用于网站，但适用于创建 SOA 或 SaaS 解决方案 <---**这就是我评估不同 API 的原因**。

此外，*它将如何执行与高需求服务一起使用的 ASP.NET Web API？*

预先感谢您提供的信息。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-26T15:34:34.720

这是简短的描述，现在应该已经很清楚了：

> ASP.NET Web API 是一个框架，可让您轻松构建覆盖广泛客户端（包括浏览器和移动设备）的 HTTP 服务。ASP.NET Web API 是在 .NET Framework 上构建 RESTful 应用程序的理想平台。

这都是关于 HTTP 的。REST 不在你的面前。但是如果你想让你的应用程序 100% 纯 REST，ASP.NET Web API 是你在 .NET 中的选择。

至于横向扩展的场景，ASP.NET Web API 从上到下是异步的（包括扩展点），框架基础架构允许你疯狂地横向扩展。当然，这并不妨碍你在脚下开枪。如果您不够小心，您仍然可以使用 ASP.NET Web API 编写垃圾。

# php - 首字母缩写词 + 输入文本的最后一个字。PHP

> ID：11672464
> 
> 赞同：-3
> 
> 时间：2012-07-26T15:13:05.290
> 
> 标签：php

nickb 最初提供了这些代码。它最初的作用是，当用户输入文本时，它会通过获取输入的每个单词的首字母将其转换为首字母缩略词。我现在要做的是将输入的文本的最后一个单词作为输出的一部分。示例：如果用户输入自动柜员机，则输出将是：ATM 机。到目前为止，这就是我想出的，不幸的是，我现在不知所措，迫切希望让它发挥作用。请帮忙。

```
function convert($text) 
{
    $acronym = array();
    $text2 = explode(' ', $text);
    foreach(explode( ' ', $text) as $word)
    {                   
        $acronym[] = strtoupper( $word[0]);
    }
    $count = str_word_count($acronym); 
    array_push($acronym, $text2[$count]);
    echo $text2[$count];
    return implode('', $acronym);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T15:16:30.030

看起来你是一对一的 -`$count-1`在数组中使用。

但是，您的代码可以改进为：

```
function convert($text) {
    return preg_replace('/\b(.).*?\b\s*/',"$1",$text).strrchr($text," ");
}
// input: convert("Department of Redundancy Department");
// output: DoRD Department 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T15:25:55.390

看起来您不清楚代码的作用。因此，让我们从头开始编写新代码，但不要复制它，而是应该键入它。我在这里使用的所有函数都记录在 PHP 手册中。如果某个函数对您来说是新的，或者您不知道其中一个或其他参数，只需阅读并学习：

```
$words = str_word_count($text, 2); 
```

这行代码将所有单词从`$text`一个数组中提取出来`$words`。

要获取最后一个单词，您只需要获取最后一个数组条目：

```
$last_word = end($words); 
```

所以这已经完成了一半的工作。现在您要提取所有首字母：

```
$first_letters = array();
foreach ($words as $word) {
    $first_letters[] = substr($word, 0, 1);
} 
```

完成后，所有第一个字母都在数组`$first_letters`中，最后一个单词在字符串变量`$last_word`中。有一个警告。如果 中没有单词`$text`，那么这将不起作用。只是说，自己检查。

所以现在让我们编译最终的字符串：

```
$buffer = implode('', $first_letters); 
```

是一种将数组转换为字符串的简单方法。然后你只需要添加一个空格和最后一个单词：

```
$buffer .= ' '; 
```

那是添加一个空格字符（很明显，对吗？），而不是最后：

```
$buffer .= $last_word; 
```

把所有东西放在一起。

快乐编码。

# php - Zend Soap 客户端返回 null 并带有有效的 XML 最后响应

> ID：11672467
> 
> 赞同：1
> 
> 时间：2012-07-26T15:13:08.620
> 
> 标签：php, zend-framework, soap-client

尝试使用 PHP 访问我自己的 PHP Soap 服务时遇到问题。我将 Zend_Soap 用于客户端和服务器。

基本上，我从客户端得到的结果是空的。但是，如果我查看最后一个响应，它包含预期的正确 XML。因此客户端无法将 xml 转换为 php 对象（在我的测试用例中，是一个简单的 int）以供使用。

我的 wsdl 看起来像这样

```
<definitions name="SOAP_Model_soaphandler" targetNamespace="http://website.com/appldev/applications/public/SOAP/index/soap">
    <types>
        <xsd:schema targetNamespace="http://website.com/appldev/applications/public/SOAP/index/soap"/>
    </types>
    <portType name="SOAP_Model_soaphandlerPort">
        <operation name="test">
            <documentation>Returns list of all products in database</documentation>
            <input message="tns:testIn"/>
            <output message="tns:testOut"/>
        </operation>
        <operation name="test2">
            <documentation>Adds new product to database</documentation>
            <input message="tns:test2In"/>
            <output message="tns:test2Out"/>
        </operation>
    </portType>
    <binding name="SOAP_Model_soaphandlerBinding" type="tns:SOAP_Model_soaphandlerPort">
        <soap:binding style="rpc" transport="http://schemas.xmlsoap.org/soap/http"/>
        <operation name="test">
            <soap:operation soapAction="http://website.com/appldev/applications/public/SOAP/index/soap#test"/>
            <input>
                <soap:body use="encoded" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" namespace="http://website.com/appldev/applications/public/SOAP/index/soap"/>
            </input>
            <output>
                <soap:body use="encoded" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" namespace="http://website.com/appldev/applications/public/SOAP/index/soap"/>
            </output>
        </operation>
        <operation name="test2">
            <soap:operation soapAction="http://website.com/appldev/applications/public/SOAP/index/soap#test2"/>
            <input>
                <soap:body use="encoded" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" namespace="http://website.com/appldev/applications/public/SOAP/index/soap"/>
            </input>
            <output>
                <soap:body use="encoded" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" namespace="http://website.com/appldev/applications/public/SOAP/index/soap"/>
            </output>
        </operation>
    </binding>
    <service name="SOAP_Model_soaphandlerService">
        <port name="SOAP_Model_soaphandlerPort" binding="tns:SOAP_Model_soaphandlerBinding">
            <soap:address location="http://website.com/appldev/applications/public/SOAP/index/soap"/>
        </port>
    </service>
    <message name="testIn"/>
    <message name="testOut">
        <part name="return" type="xsd:int"/>
    </message>
    <message name="test2In">
        <part name="id" type="xsd:int"/>
    </message>
    <message name="test2Out">
        <part name="return" type="soap-enc:Array"/>
    </message>
</definitions> 
```

我的回复看起来像这样

```
<env:envelope xmlns:enc="http://www.w3.org/2003/05/soap-encoding" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:ns1="http://website.com/appldev/applications/public/SOAP/index/soap" xmlns:env="http://www.w3.org/2003/05/soap-envelope">
    <env:body xmlns:rpc="http://www.w3.org/2003/05/soap-rpc">
        <ns1:testresponse env:encodingstyle="http://www.w3.org/2003/05/soap-encoding">
            <rpc:result>return</rpc:result>
            <return xsi:type="xsd:int">7</return>
        </ns1:testresponse>
    </env:body>
</env:envelope> 
```

但

```
$result=$client->test(); 
var_dump($result); 
```

输出 NULL。

有任何想法吗？看起来它应该对我有用，但我不是肥皂客户端如何工作的专家。也许命名空间有问题或其他什么？我真的不知道。似乎它应该可以正常工作。作为参考，我按照本指南启动并运行：

[http://www.ibm.com/developerworks/webservices/library/x-zsoap/index.html](http://www.ibm.com/developerworks/webservices/library/x-zsoap/index.html)

我想我总是可以手动从 xml 获取响应，但我希望弄清楚为什么客户端不为我这样做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-02T17:00:13.150

您应该尝试删除soap temp file: `/tmp/wsdl*`，然后重新启动网络服务器。希望这有帮助。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-09-23T00:08:41.757

有点晚了，只是为了记录验证服务类中方法的声明，注释应该是这样的

/** * 服务 * * @param type $varname * @return type */

必须有 /** 和 and 一个空格，然后是其余的。否则将返回 null。

祝你好运！

# javascript - 如果当前图像加载缓慢，如何加载其他图像？

> ID：11672469
> 
> 赞同：2
> 
> 时间：2012-07-26T15:13:09.400
> 
> 标签：javascript

我正在开发一个 HTML5 画布游戏，我想加载一个高分辨率图像作为背景。这个图像是 10MB，所以如果图像加载缓慢，那么我想加载一个较小的图像。

```
var myimg = new Image();
myimg.onload = function() {
  clearTimeout(t);
  alert('high resolution image loaded');
};
mximg.src = 'path/to/highres.png';

var t = setTimeout(function(){
  //cancel loading somehow ?
  myimg.onload = function() {
    alert('low resolution image loaded');
  };
  myimg.src = 'path/to/low_res.png';
},5000); 
```

我应该以某种方式取消加载，还是在我编辑 src 属性时取消加载？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T09:50:35.440

另一种“解决方案”是首先加载低分辨率图像。只有当它加载得足够快时，您才开始加载高分辨率版本来替换它。

我认为有三个可能的好处：

1.  您不必担心取消加载:-)
2.  您避免在用户使用低带宽时加载不必要的数据（部分下载的高分辨率图像），而是在用户使用高带宽时加载不必要的数据（完整的低分辨率图像）（在这种情况下它不会反正那么重要）。
3.  加载高分辨率图像时，您可以选择将低分辨率图像显示为占位符（要求您将低分辨率和高分辨率图像加载到两个单独的 DOM Image 对象中并换出低分辨率高分辨率）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T22:52:25.203

您无法停止加载图像，但是可以取消普通的 AJAX 请求（[请参阅 SO 上的此解决方案](https://stackoverflow.com/questions/446594/abort-ajax-requests-using-jquery)）。通常图像不会通过 AJAX 加载，但您可以通过将图像作为 base64 编码字符串发送来解决此问题。因此，您让 PHP 读取图像并将其转换为 base64。该字符串可以通过 AJAX 发送到 JS 并“直接”绘制到您的画布[上（SO 上的解决方案](https://stackoverflow.com/questions/4773966/drawing-an-image-from-a-data-url-to-a-canvas)）。

我真的不知道这是否是最好的方法......无论如何，看看这是否适合你：

**HTML：**

```
<canvas id="background" width="800" height="600"></canvas> 
```

**JavaScript：（**使用 jQuery）

```
function drawBackgroundImage(src) {
    var image = $("<img/>").load(function(){
        $("canvas#background")[0].getContext("2d").drawImage(image[0], 0, 0);
    }).attr("src", src);
}
function loadImage(highres, lowres) {
    var t;
    var xhr = $.ajax({
        type: "POST",
        url: "load_image.php",
        data: "image=" + highres,
        success: function(imgbinary){
            if (imgbinary != "") {
                clearTimeout(t);
                drawBackgroundImage(imgbinary);
            }
        }
    });
    t = setTimeout(function(){
        xhr.abort();
        drawBackgroundImage(lowres);
    }, 5000);
}

loadImage("path/to/highres.png", "path/to/low_res.png"); 
```

**PHP:** (load_image.php)

（这使用[了 PHP 手册中的部分函数](http://www.php.net/manual/de/function.base64-encode.php#107705)。）

```
<?php
    $result = "";
    @ob_start();
    if (isset($_POST["image"])) {
        $filename = $_POST["image"];
        if (file_exists($filename)) {
            $filetype = pathinfo($filename, PATHINFO_EXTENSION);
            $imgbinary = fread(fopen($filename, "r"), filesize($filename));
            $result = "data:image/".$filetype.";base64,".base64_encode($imgbinary);
        }
    }
    @ob_end_clean();
    echo $result;
?> 
```

# sql - 结构相同的表之间的区别

> ID：11672481
> 
> 赞同：1
> 
> 时间：2012-07-26T15:14:38.940
> 
> 标签：sql, teradata

我有两个结构相同但行略有不同的表 - 表 A 和表 B。我想提取表 A 中包含但表 B 中不包含的所有行。你能帮我做吗？

顺便说一句 - 表 A 是定义形式，它以前没有创建。

另外——我有 15 个 sql 脚本要分析。我想找到一些可以帮助我可视化整个过程（由 15 个 sql 脚本组成）的软件。你能推荐一些好的吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-26T15:21:06.893

尝试

```
SELECT * FROM Table_A
EXCEPT
SELECT * FROM Table_B 
```

请参阅[http://en.wikipedia.org/wiki/Set_operations_%28SQL%29#EXCEPT_operator](http://en.wikipedia.org/wiki/Set_operations_%28SQL%29#EXCEPT_operator)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T15:21:51.017

一种方法是使用左外连接，这会选择第一个表中的所有内容，然后在第二个表中匹配这些内容。如果来自第二个表的额外列为 NULL，则第二个表中没有匹配的记录。

假设列 a 到 c 在两个表中都是唯一的

```
select a.*
  from tableA a
  left outer join tableB on a.a = b.a and ... a.c = b.c
  where b.a is null and ... and b.c is null 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-04T23:02:17.137

我经常遇到同样的问题，所以我编写了自己的软件，可以有效地处理大型数据库（数十列，数万行）。我想你解决了你的问题，但如果其他人面临同样的问题，我会在这里发布。

该软件在 R 中，可以查询并保存到 MySQL 服务器。为了测试它，虽然将你的基础导出到两个 csv 文件可能更容易，因为配置 MySQL 链接（通过 RMySQL）可能需要一些时间。在[gitHub](https://github.com/cbarbu/automatch)上查看。

我们在我的团队中经常使用它并且对它很满意。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T15:20:07.693

手动编写查询很麻烦，因此有一些工具（如[RedGate 的 SQL 比较](http://www.red-gate.com/products/sql-development/sql-compare/)）可以为您完成。但...

```
SELECT
    A.*
   ,B.*
FROM
   A LEFT OUTER JOIN B
       ON A.Field1 = B.Field1
       AND A.Field2 = B.Field2
       ...   -- join on each field
WHERE
   B.Field1 IS NULL OR
   B.Field2 IS NULL OR 
   ...  -- check for any NULL fields in B 
```

如果您对所有数据差异不感兴趣，而只对关键差异感兴趣，那么只需更改您加入的字段列表并过滤到关键字段。

# url - 如何在 webapp 中获取 google script webapp 的 URL

> ID：11672484
> 
> 赞同：7
> 
> 时间：2012-07-26T15:14:54.560
> 
> 标签：url, google-apps-script, web-applications

我有一个部署为 web 应用程序的谷歌脚本。此 webapp 需要使用 webapp 的 URL 发送电子邮件，以便收件人可以使用该 URL 访问 webapp。如何在 webapp 中获取 URL？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-27T19:59:54.187

您可以使用`ScriptApp.getService().getUrl();`在代码中获取已发布应用的 URL。

# html - 自己不设置属性的绝对元素的css属性top是如何计算的？

> ID：11672490
> 
> 赞同：3
> 
> 时间：2012-07-26T15:15:11.673
> 
> 标签：html, css

> **可能重复：**
> [位置：绝对没有设置上/左/下/右？](https://stackoverflow.com/questions/10243991/position-absolute-without-setting-top-left-bottom-right)

查看下面的代码，我有 div#box2 有 position: absolute 设置。它位于两个具有 position: static 设置的 div 之间。根据以下代码，我希望 div#box2 位于 body 元素的左上角。但是，当它被渲染时，它会收到一个将其置于 box1 下方的最高值。为什么会这样？

我知道当我明确地将 div#box2 的顶部值设置为 0px 时，它会出现在顶部。我只是不知道为什么浏览器一开始就没有计算到 0px 。

这是一些示例代码：

```
<!DOCTYPE html>
<html>
  <head>
    <title>Position Test</title>
    <style type="text/css">
      body { background-color: #DEDEDE; }
      #content { border: solid; }
      #content div { height: 150px; opacity: .7;}
      #box1 { background-color: red; }
      #box2 { background-color: yellow; }
      #box3 { background-color: lightblue; }

    #content div { width: 150px; }
        #box2 { position: absolute; text-align: right;}
    </style>
  </head>
  <body>
    <div id="content">
      <div id="box1"><span>1</span></div>
      <div id="box2"><span>2</span></div>
      <div id="box3"><span>3</span></div>
    </div>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-26T15:22:59.570

的*默认*值为`top`“ [auto](https://developer.mozilla.org/en/CSS/auto) ”，而不是“0”（[source](https://developer.mozilla.org/en/CSS/top)），因此它*不应*位于`<body>`元素的顶部。

至于*为什么*“auto”翻译成“same position as if `position`was `static`”，请参阅[关于定位的 CSS 规范](http://dev.w3.org/csswg/css3-positioning/#abs-non-replaced-height)（强调我的）：

> 对于绝对定位的元素，垂直尺寸的使用值必须满足这个约束：
> 
> 'top' + 'margin-top' + 'border-top-width' + 'padding-top' + 'height' + 'padding-bottom' + 'border-bottom-width' + 'margin-bottom' + 'bottom ' = 包含块的高度
> 
> *如果'top'、'height'和'bottom'这三个都是'auto'：首先将'margin-top'和'margin-bottom'的任何'auto'值设置为'0'，然后**设置'top'到静态位置**，最后应用下面的规则三。*
> 
> ...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T15:25:12.553

当一个元素被赋予绝对位置时，它将被从流中取出，从而允许将其他元素放置在它的上方或下方。如果没有显式设置顶部值，顶部值将保留元素位置，如果它没有从流中删除。

如果我们改变盒子的顺序，你可以看到这发生了，因为`#box2`它完全从流程中移除并位于外部，`#content`但仍然堆叠在它本来应该有的地方`position:static`

```
<!DOCTYPE html>
<html>
  <head>
    <title>Position Test</title>
    <style type="text/css">
      body { background-color: #DEDEDE; }
      #content { border: solid; }
      #content div { height: 150px; opacity: .7;}
      #box1 { background-color: red; }
      #box2 { background-color: yellow; }
      #box3 { background-color: lightblue; }

    #content div { width: 150px; }
        #box2 { position: absolute; text-align: right;}
    </style>
  </head>
  <body>
    <div id="content">
      <div id="box1"><span>1</span></div>
      <div id="box3"><span>3</span></div>
      <div id="box2"><span>2</span></div>

    </div>
  </body>
</html> 
```

# java - 为什么我不能从我的 servlet 发送电子邮件并获得 java.security.AccessControlException？

> ID：11672491
> 
> 赞同：0
> 
> 时间：2012-07-26T15:15:12.690
> 
> 标签：java, google-app-engine, servlets, jakarta-mail

> **可能重复：**
> [为什么我不能从我的 servlet 发送电子邮件？](https://stackoverflow.com/questions/11670104/why-cant-i-send-email-from-my-servlet)

我正在使用谷歌应用引擎。我想从我的 servlet 发送电子邮件。我正在使用以下代码：

```
 String to[] = {"mygmail@gmail.com"};
            String host = "smtp.gmail.com";
            String username = "mygmail@gmail.com";
            String password = "password";
            Properties props = new Properties();
            props.put("mail.smtps.auth", "true");
            props.put("mail.smtp.starttls.enable", "true");
            props.put("mail.smtp.host", host);
            props.put("mail.smtp.user", username);
            props.put("mail.smtp.password", password);
            props.put("mail.smtp.port", "587");
            props.put("mail.smtp.auth", "true");
            // ...
            Session session = Session.getInstance(props);
            MimeMessage msg = new MimeMessage(session);
            // set the message content here
            msg.setFrom(new InternetAddress(username,"Me"));
            msg.setSubject("Testing");
            msg.setText("Testing...");
            Address[] addresses = new Address[to.length];
            for (int i = 0; i < to.length; i++) {
                Address address = new InternetAddress(to[i]);               
                addresses[i] = address;
                // Add the given addresses to the specified recipient type.
                msg.addRecipient(Message.RecipientType.TO, new InternetAddress(to[i]));
            } 

            Transport t = session.getTransport("smtps");

            t.connect(host, username, password);
            t.sendMessage(msg, msg.getAllRecipients());
            t.close(); 
```

但我得到以下异常：

```
 Exception error: java.security.AccessControlException: access denied (java.net.SocketPermission smtp.gmail.com resolve) 
```

以下是我的 servlet 的所有导入：

```
 import java.io.IOException;
  import java.io.PrintWriter;
  import java.util.List;
  import java.util.Properties;

  import javax.mail.Address;
  import javax.mail.BodyPart;
  import javax.mail.Message;
  import javax.mail.Multipart;
  import javax.mail.Session;
  import javax.mail.Transport;
  import javax.mail.internet.InternetAddress;
  import javax.mail.internet.MimeBodyPart;
  import javax.mail.internet.MimeMessage;
  import javax.mail.internet.MimeMultipart;
  import javax.servlet.http.HttpServlet;
  import javax.servlet.http.HttpServletRequest;
  import javax.servlet.http.HttpServletResponse; 
```

谁能告诉我有什么问题？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:34:07.607

设置以下属性

```
 props.put("mail.smtp.starttls.enable", "true");
        props.put("mail.smtp.host", host);
        props.put("mail.smtp.user", username);
        props.put("mail.smtp.password", password);
        props.put("mail.smtp.port", "587");
        props.put("mail.smtp.auth", "true"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T16:30:21.207

我们走吧。

在您的 servlet 代码中，您可以添加一个线程启动。电子邮件将在另一个类中发送，而不是在 servlet 中。像这样：

```
MailObj mo = new MailObj();
mo.setMsgText("text blah blah blah");
mo.setEmailSource("to@mail.com");
mo.setSubject("subject");
Runnable t1 = new MailClass(request, response, mo);
new Thread(t1).start(); 
```

MailObj 存储电子邮件所需的数据，例如接收电子邮件的地址、电子邮件文本和主题。（非常非常简单的方法）

```
public class MailObj {

    private String emailSource;
    private String msgText;
    private String subject;
    // getters and setters...

} 
```

MailClass 必须实现 Runnable 接口，它告诉您重写 run() 方法。

```
public class MailClass implements Runnable {

    private MailObj mo;
    HttpServletRequest req;
    HttpServletResponse res;

    public MailClass (HttpServletRequest request, HttpServletResponse response,
              MailObj mo){  //constructor
        this.req = request;
        this.res = response;
        this.mo = mo;

    }

    public void run() { // method of the Runnable interface
        try {
            sendEmail(req, res, mo);
        } catch (ServletException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }

    }

    public void sendEmail(HttpServletRequest request, HttpServletResponse response,                         MailObj mo) throws ServletException, IOException {

        Properties props = new Properties();
// here you set the host information (information about who is sending the email)
// in this case, who is sending the email is a gmail client...
        props.put("mail.smtp.host", "smtp.gmail.com");
        props.put("mail.smtp.socketFactory.port", "465");
        props.put("mail.smtp.socketFactory.class","javax.net.ssl.SSLSocketFactory");
        props.put("mail.smtp.auth", "true");
        props.put("mail.smtp.port", "465");

        Session ses2 = Session.getDefaultInstance(props,
                new javax.mail.Authenticator() {
                    protected PasswordAuthentication        getPasswordAuthentication() {
                        return new PasswordAuthentication(your_account,your_password);
                    }
                });

        try {

            Message msg = new MimeMessage(ses2); 

            msg.setFrom(new InternetAddress(email_to));
            msg.setRecipient(Message.RecipientType.TO, new InternetAddress(mo.getEmailSource()));
            msg.setSentDate(new Date());  
            msg.setSubject(mo.getSubject());  
            msg.setText(mo.getMsgText());

         // sending message (trying)  
            Transport.send(msg);  

        } catch (AddressException e) {
            e.printStackTrace();
        } catch (MessagingException e) {
            e.printStackTrace();
        } 
```

使用线程发送电子邮件是一种好方法，因为您的电子邮件是在“运行时代码之后”发送的，这意味着用户不会等待电子邮件发送。**发送电子邮件需要很长时间**。做一些测试，你会注意到这一点。所以使用线程是避免长时间等待的好方法......

希望能帮助到你！=]

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T17:03:50.647

[在这里](https://github.com/WolfrathDevelopment/WLC_Warrior_Mail.git)，看看我的 Outlook 客户端；它位于 src 文件夹下。我与 Javamail api 斗争了很长时间，这似乎运作良好。此外，您应该静态使用 Transport 类来发送消息，我不确定这是否是您的问题所在。

您还应该将您的properites 对象传递给扩展STMPAuthenticator 的类。

# sql - 基于 SQL 的 FIFO 逻辑

> ID：11672493
> 
> 赞同：1
> 
> 时间：2012-07-26T15:15:21.957
> 
> 标签：sql, oracle, oracle10g

我需要构建一个查询，该查询将汇总已输血的单位血液数量，以便可以将其与已交叉匹配的血液单位数量进行比较。交叉配血但不输血的血液（宝贵的资源）被浪费了。

供应商应该在创建新订单之前检查记录系统 (Epic) 中的“活动”交叉匹配订单。不这样做的提供者将受到“惩罚”（提供者 20）。对于不输血他们交叉匹配的所有血液的提供者（提供者 10），没有处罚适用（似乎）。

交叉匹配订单：

```
|ENC_ID|PROV_ID|ORDER_ID|ORDER_TIME     |UNITS|
|     1|     10|     100|26-JUL-12 13:00|    4|
|     1|     20|     231|26-JUL-12 15:00|    2| 
```

输血命令：

```
|ENC_ID|PROV_ID|ORDER_ID|ORDER_TIME     |UNITS|
|     1|     10|     500|26-JUL-12 13:05|    1|
|     1|     10|     501|26-JUL-12 13:25|    1|
|     1|     20|     501|26-JUL-12 15:00|    1|
|     1|     20|     501|26-JUL-12 15:21|    2| 
```

规则：

*   将输血与相同遭遇的交叉匹配进行比较 ( `transfusion.END_ID=cross-match.ENC_ID`)
*   输血指令以先进先出的方式应用于交叉匹配指令
*   `transfusion.ORDER_TIME >= cross-match.ORDER_TIME`
*   提供者可以输血超过他们的交叉匹配订单，只要所有“有效”交叉匹配订单仍有可用单位（提供者 20 的第二个输血订单）

期望的结果：

```
|ENC_ID|PROV_ID|ORDER_ID|ORDER_TIME     |CROSS-MATCHED|TRANSFUSED|
|     1|     10|     100|26-JUL-12 13:00|            4|         4|
|     1|     20|     231|26-JUL-12 15:00|            2|         1| 
```

提供者 10 的输血“记入”了提供者 20 的输血。

这个逻辑可以在不诉诸程序的情况下实现吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T16:07:58.007

您可以在单个 SQL 查询中执行此操作。这是一个示例（在 11gR2 上测试，应该在 10g 上工作）：

设置：

```
CREATE TABLE cross_match as (
   SELECT 1 ENC_ID, 10 PROV_ID, 100 ORDER_ID, 
          to_date('2012-07-26 13', 'yyyy-mm-dd hh24') ORDER_TIME, 4 UNITS 
     FROM DUAL
   UNION ALL SELECT 1, 20, 231, to_date('2012-07-26 15', 'yyyy-mm-dd hh24'), 2 FROM DUAL
);
CREATE TABLE transfusion as (
   SELECT 1 ENC_ID, 10 PROV_ID, 500 ORDER_ID, 
          to_date('2012-07-26 13:05', 'yyyy-mm-dd hh24:mi') ORDER_TIME, 1 UNITS 
          FROM DUAL
   UNION ALL SELECT 1, 10, 501, to_date('2012-07-26 13:25', 'yyyy-mm-dd hh24:mi'), 1 FROM DUAL
   UNION ALL SELECT 1, 20, 501, to_date('2012-07-26 15:00', 'yyyy-mm-dd hh24:mi'), 1 FROM DUAL
   UNION ALL SELECT 1, 20, 501, to_date('2012-07-26 15:21', 'yyyy-mm-dd hh24:mi'), 2 FROM DUAL
); 
```

以下查询将以数字方式构建血液单位列表，并将表中的每个单位连接到`cross_match`表中对应的单位（如果存在）`transfusion`：

```
WITH cross_order as (
   SELECT rownum rn FROM DUAL
   CONNECT BY level <= (SELECT MAX(units) FROM cross_match)
),
transfusion_order as (
   SELECT rownum rn FROM DUAL
   CONNECT BY level <= (SELECT MAX(units) FROM transfusion)
)
SELECT c.enc_id, c.prov_id, c.order_id, c.order_time, 
       count(*) cross_matched,
       count(t.enc_id) transfused
  FROM (SELECT cm.*, 
               row_number() over (partition by cm.enc_id 
                                  order by cm.order_time) cross_no
          FROM cross_match cm
          JOIN cross_order co ON cm.units >= co.rn) c
  LEFT JOIN (SELECT t.*, 
                    row_number() over (partition by t.enc_id 
                                       order by t.order_time) trans_no
               FROM transfusion t
               JOIN transfusion_order tor ON t.units >= tor.rn) t
         ON c.enc_id = t.enc_id
            AND c.cross_no = t.trans_no
 GROUP BY c.enc_id, c.prov_id, c.order_id, c.order_time;

ENC_ID PROV_ID ORDER_ID ORDER_TIME CROSS_MATCHED TRANSFUSED
-----------------------------------------------------------
1      20      231      07/26/2012             2          1
1      10      100      07/26/2012             4          4 
```

如果最大单元数仍然很小，这可能是有效的，否则这种一对一的关系可能会变得很麻烦。

这可以通过使用两侧的总单位而不是基本的 1-1 来改善。连接条件就像开始单元和结束单元之间的间隔交集：

```
SELECT c.enc_id, c.prov_id, c.order_id, c.order_time, 
       sum(c.unit_end - nvl(c.unit_start,0))/count(*) cross_matched,
       sum(least(c.unit_end, t.unit_end)
           -greatest(nvl(c.unit_start, 0), nvl(t.unit_start, 0))) transfused
  FROM (SELECT cm.*, 
               sum(cm.units) over (partition by cm.enc_id 
                                  order by cm.order_time
                                  rows between unbounded preceding
                                           and 1 preceding) unit_start,
               sum(cm.units) over (partition by cm.enc_id 
                                  order by cm.order_time) unit_end
          FROM cross_match cm) c
  LEFT JOIN (SELECT t.*,
               sum(t.units) over (partition by t.enc_id 
                                  order by t.order_time
                                  rows between unbounded preceding
                                           and 1 preceding) unit_start, 
                    sum(t.units) over (partition by t.enc_id 
                                       order by t.order_time) unit_end
               FROM transfusion t) t
         ON c.enc_id = t.enc_id
            AND c.unit_end > nvl(t.unit_start, 0)
            AND t.unit_end > nvl(c.unit_start, 0)
 GROUP BY c.enc_id, c.prov_id, c.order_id, c.order_time;

ENC_ID PROV_ID ORDER_ID ORDER_TIME CROSS_MATCHED TRANSFUSED
-----------------------------------------------------------
1      20      231      07/26/2012             2          1
1      10      100      07/26/2012             4          4 
```

# sql - 将 NOT_NULL 约束添加到 SQL 列

> ID：11672498
> 
> 赞同：9
> 
> 时间：2012-07-26T15:15:49.647
> 
> 标签：sql, h2

我正在尝试将 NOT_NULL 约束添加到 SQL h2 数据库中的列，使用

```
ALTER TABLE CHARACTERS ADD CONSTRAINT nn_PID NOT_NULL (PLAYER_ID); 
```

这遵循我在[这里](http://www.w3schools.com/sql/sql_primarykey.asp)找到的模式：

```
ALTER TABLE Persons ADD CONSTRAINT pk_PersonID PRIMARY KEY (P_Id,LastName) 
```

除了我更改约束、表和列名。但我得到这个错误：

> SQL 语句中的语法错误“ALTER TABLE CHARACTERS ADD CONSTRAINT NN_PID NOT_NULL[*] (PLAYER_ID)”；预期“., COMMENT, PRIMARY, INDEX, KEY, CHECK, UNIQUE, FOREIGN”；SQL 语句：ALTER TABLE CHARACTERS ADD CONSTRAINT nn_PID NOT_NULL (PLAYER_ID) [42001-168] 42001/42001（帮助）

如何添加 NOT_NULL 约束？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-26T15:20:00.923

来自[H2 SQL 语法](http://www.h2database.com/html/grammar.html)：

```
ALTER TABLE TEST ALTER COLUMN NAME SET NOT NULL; 
```

所以我们可以使用：

```
ALTER TABLE CHARACTERS ALTER PLAYER_ID SET NOT NULL; 
```

# c# - 在 propertygrid 中查看嵌套类

> ID：11672499
> 
> 赞同：2
> 
> 时间：2012-07-26T15:15:54.623
> 
> 标签：c#, winforms, propertygrid

我正在使用无法修改的第三方类，我想在 winforms propertygrid 中查看它们。问题是网格不允许我扩展嵌套类。它看起来像这样。

![属性网格](../Images/3f2205c0868f12d0cfe2873b3f68058c.png)

第三方代码看起来像这样

```
[System.Xml.Serialization.XmlRoot("BBB")]
[DataContract]
public class B : INotifyPropertyChanged
{
    [DataMember]
    private Int32 x;
    [DataMember]
    private Int32 y;
    public Int32 X
    {
        get{return x; }
        set{ x = value;}
    }

    public Int32 Y
    {
        get { return y; }
        set { y = value;![enter image description here][1]}
    }

    public event PropertyChangedEventHandler PropertyChanged;

    private void RaisePropertyChanged(string propertyName)
    {
        RaisePropertyChanged(this, new PropertyChangedEventArgs(propertyName));
    }
    private void RaisePropertyChanged(object sender, PropertyChangedEventArgs arg)
    {
        if (PropertyChanged != null)
            PropertyChanged(sender, arg);
    }

    public override string ToString()
    {
        return string.Format("X {0} , Y {1}", x,y);
    }
}

[System.Xml.Serialization.XmlRoot("AAA")]
[DataContract]
public class A : INotifyPropertyChanged
{
    [DataMember]
    private Int32 i = 18;

    [DataMember]
    private Int32 j = 6;

    [DataMember]
    private B b;

    public Int32 I
    {
        get { return i; }
        set { i = value; }
    }

    public Int32 J
    {
        get { return j; }
        set { j = value; }
    }

    public B BB
    {
        get { return b; }
        set { b = value; }
    }

    public override string ToString()
    {
        return string.Format("I {0} , J {1} B {2}", i, j, b.ToString());
    }

    public event PropertyChangedEventHandler PropertyChanged;

    private void RaisePropertyChanged(string propertyName)
    {
        RaisePropertyChanged(this, new PropertyChangedEventArgs(propertyName));
    }
    private void RaisePropertyChanged(object sender, PropertyChangedEventArgs arg)
    {
        if (PropertyChanged != null)
            PropertyChanged(sender, arg);
    }
} 
```

我正在像这样初始化propertygrid

```
A aa = new A();
propertyGrid2.SelectedObject = aa; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-06-14T13:55:00.350

首先，当您创建基础`A`项目时，您还必须设置 的值`BB`，否则它只是 null。

```
A aa = new A();
aa.BB = new B();
propertyGrid2.SelectedObject = aa; 
```

为了浏览子项目，`ExpandableObjectConverter`为这些项目添加一个。在您的示例中，`B`它看起来像这样：

```
TypeConverterAttribute BAttribute = new TypeConverterAttribute(typeof(ExpandableObjectConverter));
TypeDescriptor.AddAttributes(typeof(B), BAttribute); 
```

# java - 我可以使用 ScriptableObject 在 Java 中构建 Rhino JavaAdapter 吗？

> ID：11672500
> 
> 赞同：1
> 
> 时间：2012-07-26T15:16:01.117
> 
> 标签：java, javascript, rhino

我发现了一些关于使用 Mozilla 的 Rhino 在 Javascript 和 Java 之间改组类定义的问题。我已经走得够远了：

Javascript：

```
new JavaAdapter(MyClass, {foo: function(){return 'Hello!';}}); 
```

爪哇

```
String script = // the above stuff
Object o = context.evaluateString(scope, script, "UserScript", 1, null);
MyClass mc = (MyClass) Context.jsToJava(o, MyClass.class);
mc.foo(); // returns "Hello!" 
```

这让我大吃一惊，但我想将 JavaAdapter 结构从 Javascript 转移到 Java 端。我正在编写一个框架，用户将在其中定义 Javascript 中的逻辑，并且他们必须粘贴的样板越少，他们就会越快乐。

理想情况下，我可以这样做：

Javascript：

```
{foo: function(){return 'Hello!';}}; 
```

爪哇

```
String script = // the above stuff
Object o = context.evaluateString(scope, script, "UserScript", 1, null);
MyClass mc = new JavaAdapter(MyClass.class, o);
mc.foo(); // returns "Hello!" 
```

但据我所知，JavaAdapter 构造函数不接受任何参数，在任何地方都没有该类的文档（例如，它不在[此处](http://www-archive.mozilla.org/rhino/apidocs/)），而且我还没有找到任何创建此类的静态方法（例如 on`Context`或）`ScriptableObject`一类。我也试过`Context.jsToJava(o, MyClass.class)`了，但这引发了异常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T00:23:23.360

我也一直在打我的头。我终于让它工作了：

将您的 JavaScript 更改为：

```
var xyz = {foo: function() {return 'Hello!';}}; 
```

现在将创建 JavaAdapter 的单行代码替换为：

```
String stub = "new JavaAdapter(Packages.MyClass, xyz);";
Object o = context.evaluateString(scope, stub, "stub", 1, null);
MyClass mc = (MyClass) Context.jsToJava(o, MyClass.class); 
```

我不是这方面的专家，但您似乎不能直接从 Java 代码中使用 JavaAdapter（不幸的是），但我们可以运行一段存根代码来从 JavaScript 调用它。

请注意我的示例中的拼写错误，我正在从我的工作代码中翻译它。

调用 MyClass mc 实例似乎工作正常。从 JavaScript 调用（即从 foo 调用 Java）来访问 MyClass 的超级方法和字段似乎总是需要 'this' 关键字。我仍在试图弄清楚这一点。MyClass 中的方法和字段也必须是公共的而不是受保护的（也很不幸）。

# google-chrome-devtools - 如何过滤 chrome 的 devtool 控制台历史记录

> ID：11672502
> 
> 赞同：22
> 
> 时间：2012-07-26T15:16:28.430
> 
> 标签：google-chrome-devtools

在 bash 中，我使用 history-search-forward 和 history-search-backward 功能允许我输入我想要运行的命令的几个字符，然后按向上箭头循环浏览我的历史记录中与这些字符匹配的项目.

我想为 chrome devtool 控制台做同样的事情。我经常使用向上箭头来循环浏览我的历史记录，但似乎没有办法过滤它。有人有聪明的解决方案吗？

[请注意，在最近的 Chrome 版本中，命令历史匹配已经有了很大的改进。这不是我想要的样子，但它非常好。]

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-22T12:11:06.660

Chrome 开发者工具中没有反向搜索功能。我已经记录了反向搜索功能的请求。请给同样的星号。

[http://code.google.com/p/chromium/issues/detail?id=171386](http://code.google.com/p/chromium/issues/detail?id=171386)

我使用片段（[Chrome 开发者工具：什么是片段支持？](https://stackoverflow.com/questions/10470711/chrome-developer-tools-what-is-snippets-support)）来跟踪我的所有命令。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2017-11-15T15:24:39.213

试试这个：（基于[如何删除所有最近的控制台命令](https://stackoverflow.com/questions/21149156/how-to-remove-all-recent-console-command/21149275#21149275)）

1.  按照第一个答案中的步骤 1-3（由 Rob W）在 Chrome 开发工具窗口上打开 Chrome 开发工具（根据上面的[帖子）。](https://stackoverflow.com/questions/21149156/how-to-remove-all-recent-console-command/21149275#21149275)不要执行第 4 步，否则您将抹去您的历史记录！
2.  在新的开发工具控制台中运行此命令：`JSON.parse(localStorage.getItem('consoleHistory')).filter(function(item){ return ~item.indexOf('indexedDB');})`
    *   将“indexedDB”替换为您要过滤的任何内容。

TL;博士

*   Chrome 开发工具在技术上只是另一个浏览器窗口。
*   原始`LocalStorage`开发工具的 用于您正在浏览的站点。
*   通过在开发工具上打开开发工具，为您`LocalStorage`提供开发工具窗口，从而使您可以访问`consoleHistory`.
*   `localStorage.getItem('consoleHistory')`给你一个数组的字符串，所以你需要将它（即`JSON.parse()`）解析回一个`Array`这样你就可以`filter`了。
*   前面`~`是`~item.indexOf('indexedDB')`按位快捷方式`item.indexOf('indexedDB') > 0`

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-08T10:47:40.310

当您打开 devTools 的控制台并单击向上箭头（或向下箭头）时，您将开始循环浏览命令的“历史记录”。

# android - Android：自定义幻灯片布局

> ID：11672510
> 
> 赞同：1
> 
> 时间：2012-07-26T15:16:58.787
> 
> 标签：android, layout, slide

我正在制作一个布局如下的新应用程序：

**线性布局1 线性布局2**

**面包屑**

**主要内容**

当用户点击“linear layout2”时，屏幕会向左滑动，直到“linear layout1”被隐藏。然后将显示一个标题为“linear layout2”的新活动。

当用户点击“linear layout1”时，屏幕会向右滑动，直到“linear layout2”被隐藏。然后将显示一个标题为“linear layout2”的新活动。

我做了一些研究，但找不到解决方案。您能否给我一些提示和示例，以便我继续进行？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:27:57.853

你的问题有点令人困惑，所以我要做一个假设。

[LinearLayout1 LinearLayout2 Breadcrumb] 是否应该是导航或选项卡，在选择时将其相应内容插入主内容？

如果是这样，我建议为每条内容使用片段。然后，当您单击导航/选项卡时，执行片段的动画，将内容滑入和滑出。

请参阅谷歌文档了解如何使用片段：http: [//developer.android.com/guide/components/fragments.html](http://developer.android.com/guide/components/fragments.html)

有关如何制作幻灯片动画，请参阅另一个 stackoverflow 答案： [Android 片段和动画](https://stackoverflow.com/questions/4817900/android-fragments-and-animation)

# python - 强制scrapy抓取链接以使其出现

> ID：11672513
> 
> 赞同：3
> 
> 时间：2012-07-26T15:17:12.377
> 
> 标签：python, scrapy

我正在用scrapy编写一个蜘蛛来抓取一个网站，索引页面是一个链接列表，如www.link1.com、www.link2.com、www.link3.com，并且该网站经常更新，所以我的爬虫是每个小时运行的过程的一部分，但我只想抓取我尚未抓取的新链接。我的问题是，scrapy 在深入时随机化了它处理每个链接的方式。是否可以强制 sracpy 按顺序爬行？像 1 然后 2 然后 3，这样我就可以保存我抓取的最后一个链接，并且在再次启动该过程时只需将链接 1 与以前的链接 1 进行比较？

希望这是可以理解的，对不起我糟糕的英语，

善意的回应，

谢谢

编辑 ：

```
class SymantecSpider(CrawlSpider):

    name = 'symantecSpider'
    allowed_domains = ['symantec.com']
    start_urls = [
        'http://www.symantec.com/security_response/landing/vulnerabilities.jsp'
        ]
    rules = [Rule(SgmlLinkExtractor(restrict_xpaths=('//div[@class="mrgnMD"]/following-sibling::table')), callback='parse_item')]

    def parse_item(self, response):
        open("test.t", "ab").write(response.url + "\n") 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T21:43:27.430

试试这个例子。
构造一个列表并将所有链接附加到它。
然后将它们一一弹出以按顺序获取您的请求。

我建议做类似@Hassan 提及并将您的内容传输到数据库的操作。

```
from scrapy.spider import BaseSpider
from scrapy.selector import HtmlXPathSelector
from scrapy.http import Request
from scrapy import log

class SymantecSpider(BaseSpider):
    name = 'symantecSpider'
    allowed_domains = ['symantec.com']
    allLinks = []
    base_url = "http://www.symantec.com"

    def start_requests(self):
        return [Request('http://www.symantec.com/security_response/landing/vulnerabilities.jsp', callback=self.parseMgr)]

    def parseMgr(self, response):
        # This grabs all the links and append them to allLinks=[]
        self.allLinks.append(HtmlXPathSelector(response).select("//table[@class='defaultTableStyle tableFontMD tableNoBorder']/tbody/tr/td[2]/a/@href").extract())
        return Request(self.base_url + self.allLinks[0].pop(0), callback=self.pageParser)

    # Cycle through the allLinks[] in order
    def pageParser(self, response):
        log.msg('response: %s' % response.url, level=log.INFO)
        return Request(self.base_url + self.allLinks[0].pop(0), callback=self.pageParser) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T19:04:32.497

SgmlLinkExtractor 将按照它们出现在页面上的相同顺序提取链接。

```
from scrapy.contrib.linkextractors.sgml import SgmlLinkExtractor
links = SgmlLinkExtractor(
    restrict_xpaths='//div[@class="mrgnMD"]/following-sibling::table',
        ).extract_links(response) 
```

您可以`rules`在 CrawlSpider 中使用它们：

```
class ThreatSpider(CrawlSpider):
    name = 'threats'
    start_urls = [
        'http://www.symantec.com/security_response/landing/vulnerabilities.jsp',
    ]
    rules = (Rule(SgmlLinkExtractor(
                restrict_xpaths='//div[@class="mrgnMD"]/following-sibling::table')
            callback='parse_threats')) 
```

# eclipse - Nsight Eclipse 版找不到 nvcc

> ID：11672515
> 
> 赞同：1
> 
> 时间：2012-07-26T15:17:15.817
> 
> 标签：eclipse, cuda, nvcc, nsight

我刚刚安装了 CUDA 5.0 Preview (Mac OS X Lion)，但在使用 Nsight 时遇到了问题。

该工具包似乎已正确安装。（驱动程序加载，nvcc -V 在 bash 中工作，示例工作正常）。

当我创建一个新项目时，我收到警告：

*   启动外部扫描仪信息生成器时出错 (nvcc -dryrun ...)
*   在 $PATH 中找不到程序“nvcc”

在 Preferences -> CUDA Toolkit 中，我没有检测到与 CUDA 兼容的设备。这很奇怪，因为我的机器上有 nVidia GT 650M。那么为什么 Nsight 不识别它呢？

如果我尝试构建一个项目，我会收到 2 个错误：

*   /bin/sh: nvcc: 找不到命令
*   制作：*** [src/test.o] 错误 127

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T20:20:13.170

您如何启动 Nsight？你使用 /usr/local/cuda/bin/nsight 吗？不幸的是，目前无法通过在 Mac OS X 上双击应用程序来启动 Nsight。

在 CUDA 5.0 预览版中，当 shell 脚本没有正确设置路径时，我们遇到了一个错误。这是该脚本在最新的内部工具包构建中的样子（您可能需要根据工具包安装位置调整路径 - 在最终版本中安装程序将处理它）：

```
#!/bin/sh
PATH="$PATH:/Developer/NVIDIA/CUDA-5.0/bin" DYLD_LIBRARY_PATH="$DYLD_LIBRARY_PATH:/Developer/NVIDIA/CUDA-5.0/lib" "/Developer/NVIDIA/CUDA-5.0/libnsight/nsight.app/Contents/MacOS/nsight" $@ 
```

# html - YouTube/Vimeos 可以调整它们的高度到宽度 (CSS) 吗？

> ID：11672518
> 
> 赞同：4
> 
> 时间：2012-07-26T15:17:18.180
> 
> 标签：html, css, video, iframe, youtube

我使用了标准的 Youtube 嵌入代码，例如：

```
<div style="width:100%; max-width:800px;">
    <iframe width="960" height="720" src="http://www.youtube.com/embed/VIDEO_ID"
       frameborder="0" allowfullscreen></iframe>
</div> 
```

我`iframe { width: 100%; }`在 style.css 中添加了它，它可以工作（它的新宽度最大为 800 像素），但它不适应高度......`height: auto;`并`height: 100%;`使其像 100 像素高或 720 像素高（太高了）。

**有什么方法可以让 YouTube 视频在响应式容器中始终保持 16:9 的纵横比（宽度可以从 1px 到 800px）？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-26T15:45:29.860

那么您的宽度和高度可能会被 iFrame 的宽度和高度属性覆盖。如果您取出静态宽度和高度，那么它应该正确响应。

```
<div style="width:100%; max-width: 800px;">
  <iframe src="http://www.youtube.com/embed/VIDEO_ID" frameborder="0" allowfullscreen></iframe>
</div> 
```

注意 iframe 中不再有 width="XXX" 或 height="XXX" 了。

查看[这篇文章](http://www.webmonkey.com/2011/12/how-to-scale-embedded-media-in-responsive-designs/)了解更多信息。

# c# - 如何在隐藏的文本框上设置焦点

> ID：11672520
> 
> 赞同：1
> 
> 时间：2012-07-26T15:17:30.103
> 
> 标签：c#, javascript, asp.net

在我的`page_load`事件中，我有这个代码：

```
myTextbox.focus(). 
```

因此，当我将文本框设置为`visible=false`我的代码时不起作用。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-26T15:18:49.053

隐藏控件不可聚焦。将不透明度设置为 0。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T15:18:43.877

你不能。如果某些东西没有被渲染，它就不能被交互，所以你不能将焦点设置在它上面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-08-19T08:58:37.863

焦点意味着用户输入聚焦到控件，这意味着如果控件是文本框，文本输入光标将被放置在控件中，或者如果是复选框，复选框将被聚焦并且可以通过按下来选择空格，您不能将文本输入光标放在隐藏控件中，也不能用于任何用户输入。

如果您出于某种原因仍想设置焦点，请尝试将其高度和宽度设置为零。喜欢`style="height:0px; width:0px"` 并用于`Page.SetFocus(yourControl);`设置焦点

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T15:22:38.030

当您将该`Control.Visible`属性设置为 false 时，它​​不仅会隐藏页面上的控件。它完全忽略了该控件在客户端浏览器上的呈现，但“记住”服务器上有关该控件的所有内容以供将来回发。

如果你真的做了一个客户端隐藏（即设置 CSS 样式`display: none;`，那么它仍然会存在于页面上，但只是被隐藏。此时你可以集中它。

# java - 通用扩展类和实现接口

> ID：11672521
> 
> 赞同：12
> 
> 时间：2012-07-26T15:17:40.030
> 
> 标签：java, generics, interface, enums

这听起来像是一个奇怪的问题，但是如何定义一个必须扩展类并实现接口的泛型呢？我目前有一个具有以下原型的通用函数：

```
public static <E extends Enum<E>> List<E> buildEnumList(Class<E> enumClass) 
```

这正如预期的那样工作。我现在的问题是我想进一步将可传递的类限制为枚举并实现特定接口`Readable`（不是 java.lang 中的接口）。由于泛型使用相同的关键字`extends`来指示它应该实现一个接口，我看不到任何方法来获得以下伪行为：

```
public static <E extends Enum<E> implements Readable> List<E> buildLexicographicalEnumList(Class<E> enumClass) 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-07-26T15:21:01.063

您可以使用`&`来指示`E`还必须实现一个接口：

```
public static <E extends Enum<E> & Readable> List<E> buildLexicographicalEnumList(Class<E> enumClass) { 
```

# java - 使用缓冲读取器读取随机访问文件

> ID：11672523
> 
> 赞同：0
> 
> 时间：2012-07-26T15:17:49.733
> 
> 标签：java, file, io, java-io

我正在尝试读取一个大文件（> 1GB），我认为使用缓冲读取器将其作为随机访问文件读取会很有效。

我需要逐行读取文件并解析它

然而，作为 JAVA IO Api 的新手，我不确定我该怎么做。

我感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T15:35:14.123

您可以为此使用 Java 的 BufferedReader：

```
BufferedReader reader = new BufferedReader(new FileReader(fileName));
String line;
while ((line = reader.readLine()) != null) {
  // Do some stuff with the line
} 
```

`fileName`是您要读取的文件的路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T16:02:47.553

您需要从头开始阅读所有内容吗？如果您知道可以从哪个字节开始，您可以使用 RandomAccessFile 跳转到文件的不同部分。我认为这是执行此操作的搜索功能。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-26T11:13:01.220

虽然它在 java 中是完全可行的，但我想根据我的经验提出建议：

如果您在 Unix 平台上，您可以使用外部 shell 脚本来搜索 GB 的日志。`sed`非常适合此目的。具体用法在这里：[http ://www.grymoire.com/Unix/Sed.html](http://www.grymoire.com/Unix/Sed.html)

每当您需要通过日志文件读取/grep 时，通过 java 文件调用 shell 脚本。

**如何？**

1）在你的java代码中，使用`ProcessBuilder`class。它可以将 shell 脚本作为参数传递给构造函数

`ProcessBuilder obj = new ProcessBuilder("FastLogRead.sh");`

2) 为 Process 创建对象

`Process process = obj.start();`

3) 你可以通过这个直接在你的 BufferedRead 中读取这个 shell 的输出

`BufferedReader br=new BufferedReader(new InputStreamReader(process.getInputStream()));`

**优点：**

通过 avg 加快执行速度。10 次（我搜索了大约 4GB 的日志文件）

**缺点：**

一些开发人员不喜欢在 java 领域引入轻量级的 shell 脚本，因此想要使用 java 的`RandomAccessFile`. 这是有道理的。

对于您的情况，您可以在标准化和性能之间进行选择。

# ssh - CentOS 6.3。SSH。绑定到 0.0.0.0 上的端口 xxx 失败：权限被拒绝

> ID：11672525
> 
> 赞同：6
> 
> 时间：2012-07-26T15:17:56.810
> 
> 标签：ssh, centos

CentOS 6.3 最低配置。已安装 SSH 服务器，端口 22。一切正常。我更改了 777 上的 22 端口并重新启动 sshd 并在日志中查看：

```
Jul 26 01:01:07 myserver sshd[1590]: error: Bind to port 777 on 0.0.0.0 failed: Permission denied.
Jul 26 01:01:07 myserver sshd[1590]: error: Bind to port 777 on :: failed: Permission denied.
Jul 26 01:01:07 myserver sshd[1590]: fatal: Cannot bind any address. 
```

/etc/sysconfig/iptables 包含：

```
-A INPUT -m state --state NEW -m tcp -p tcp --dport 777 -j ACCEPT 
```

*网络统计-tulpn | grep :22*和*netstat -tulpn | grep :777*什么也不返回

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-30T00:37:04.000

Centos 默认使用 SELinux，我不认为 Ubuntu 会这样做（或者至少我没见过）。在您的日志中查看 SElinux 权限错误。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2018-04-24T21:13:34.703

SELinux 不允许 sshd 在默认安装的 CentOS 6.3 上运行在另一个端口上。关注 -> [https://blog.tinned-software.net/change-ssh-port-in-centos-with-selinux/](https://blog.tinned-software.net/change-ssh-port-in-centos-with-selinux/)：

*   在你的防火墙上挖一个洞（你已经这样做了）
*   为 SELinux 添加规则以允许 sshd 在端口 777 上运行：`sudo semanage port -a -t ssh_port_t -p tcp 777`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2021-08-01T07:38:39.910

您可以使用命令 sudo setenforce 0 禁用 selinux。

须藤 setenforce 0

防火墙-cmd --add-port=777/tcp --permanent

防火墙-cmd --reload

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T15:45:18.267

端口 777 专用于 Multiling HTTP，即使未使用，您也无法绑定到它。例如，如果您尝试绑定到端口 8777，它将正常工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-11-04T16:05:50.577

问题是通知SELinux，但我认为有两种情况：

1.  该端口尚未分配给内置服务，在这种情况下，这可能有效：

    ```
    sudo semanage port -a -t ssh_port_t -p tcp 22777 
    ```

2.  端口正在覆盖一些现有服务（不要问我为什么）；在这种情况下，这种稍微不同的语法是必要的：

    ```
    sudo semanage port --modify -t ssh_port_t -p tcp 777 
    ```

当然，这些端口应该通过更新防火墙来提供：

```
sudo firewall-cmd --add-port=22777/tcp --permanent 
```

或者

```
sudo firewall-cmd --add-port=777/tcp --permanent 
```

进而：

```
sudo firewal-cmd --reload 
```

# c++ - C ++：用于大型矢量/双端队列的容器替换

> ID：11672526
> 
> 赞同：5
> 
> 时间：2012-07-26T15:18:03.533
> 
> 标签：c++, boost, stl, containers, large-data

所以我的应用程序有包含 1 亿个甚至更多元素的容器。

我正在寻找一个容器，它在整个容器中的频繁插入和删除......包括靠近中间的地方，其行为 - 在时间上 - 比 std::deque （更不用说 std::vector）更好。对第 n 个元素的访问时间不需要像向量一样快，但应该比 std::list 中的完全遍历更好（无论如何每个元素都有巨大的内存开销）。

元素应按索引排序（如向量、双端队列、列表），因此 std::set 或 std::unordered_set 也不能​​正常工作。

在我坐下来自己编写这样一个容器之前：有人见过这样的野兽吗？我很确定 STL 没有这样的东西，期待 BOOST 我没有找到可以使用的东西，但我可能错了。

有什么提示吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T15:19:54.673

如果您的应用程序以此类数据为中心，则可以使用整个 STL 替代大数据：

*   STXXL - [http://stxxl.sourceforge.net/](http://stxxl.sourceforge.net/)

* * *

编辑：我实际上回答得有点快。1亿并不是一个很大的数字。例如，如果每个元素都是一个字节，您可以将其保存在 96MiB 数组中。因此，无论 STXXL 是否有用，元素的大小都应该大得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T17:06:36.573

我认为您可以通过跳过列表获得所需的性能特征：

[https://en.wikipedia.org/wiki/Skip_list#Indexable_skiplist](https://en.wikipedia.org/wiki/Skip_list#Indexable_skiplist)

当然，这是您感兴趣的“可索引”部分——您实际上并不希望对项目进行排序。所以我需要做一些修改，作为练习。

您可能会发现 1 亿个列表节点开始占用 32 位地址空间，但在 64 位中可能不是问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T16:22:07.500

尝试哈希映射。STL 有几个，都带有无序的命名前缀，例如 unorderd_map 等。它具有恒定的时间插入和查找给定一个好的散列算法。使用您的“庞大”数据集，哈希图很可能会满足您的需求。对应用程序进行轻微更改以覆盖接口的差异是微不足道的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T15:52:54.257

1）如果数据非常稀疏，即有很多零或可以这样表达，我强烈推荐一种利用这一点的数据结构：

*   [sparselib++](http://math.nist.gov/sparselib++/)用于矩阵
*   散列映射的[稀疏散列](http://code.google.com/p/sparsehash/)

2) 哈希映射应该对您描述的所有操作执行 O(1)，并且我之前提到的 sparsehash 实现特别节省空间；它还包括一种`sparsetable`更底层的类型，可以用来代替数组。

3）如果严格的排序不是那么重要（可能是，因为你提到的元素应该按索引排序），你可以`swap`将要擦除的元素删除到向量的末尾，然后`resize`在 O(1 ）。插入只是`push_back`.

# php - 验证电子邮件地址的正则表达式帮助

> ID：11672528
> 
> 赞同：1
> 
> 时间：2012-07-26T15:18:06.957
> 
> 标签：php, regex

我正在尝试验证电子邮件字段。我从这里的某个地方获取了这个正则表达式，并在我制作的另一种形式上使用了它，它工作正常。然而，当我现在使用它时，它不匹配。

我要做的就是检查电子邮件，如果它很好，则将其记录在数据库中的正确字段中。

为了不粘贴一堆东西......我已经删除了问题行并在接下来的几行中使用伪代码。

本质上，vars 是这些：

```
$theEmail = $_post email from first page here
$regEx ='#^[a-z0-9.!\#$%&\'*+-/=?^_`{|}~]+@([0-9.]+|([^\s]+\.+[a-z]{2,6}))$#si'; 
```

我的php是这个

```
//essentially other field validation will go here...for now testing only empty.
    if(!empty($theEmail)){
        if (preg_match($regEx, $formEmail)) {
            //send it through to db.

        } else { //error stuff here }
    } 
```

本质上，这永远不会实现。无论我做什么，电子邮件都不会验证，正如我所说，我写了另一个更复杂的表单来验证数据就好了

不知道发生了什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T15:31:32.870

我建议你`filter_var`改用。

```
if (filter_var($theEmail, FILTER_VALIDATE_EMAIL)) {
  //send it through to db.
} else {
  //error stuff here
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T15:30:58.990

试试这个！希望它能解决您的查询，尽管电子邮件有无限的正则表达式

```
^[a-z0-9,!#\$%&'\*\+/=\?\^_`\{\|}~-]+(\.[a-z0-9,!#\$%&'\*\+/=\?\^_`\{\|}~-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*\.([a-z]{2,})$ 
```

要进行测试，请访问 [正则表达式测试器](http://www.regexpal.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T15:23:57.687

通过电子邮件验证，有一些简单的解决方案可以捕捉 99% 的所有错误，而复杂的解决方案可能会捕捉到 0.1% 的错误，但难以阅读。

走简单的路线，只需检查类似的东西

```
.+@.+\..+ 
```

是的，它允许使用类似的电子邮件地址，`a@b.c`但这可能比无法注册的用户支付的价格更低，因为您的 500 个字符的正则表达式在某处有错误，拒绝有效地址。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T15:25:41.993

`/^[a-z0-9.!\#$%&\'*+-=?^_{|}~]+@([0-9.]+|([^\s]+\.+[a-z]{2,6}))$/`

我删除了 first`#`和 ending `#si`，并`/`从 the 中取出了，`=`因为它给我带来了问题。这会在我的电子邮件地址上生成一个匹配项：

```
<?
$theEmail = 'me@davebel.com';
$regEx ='/^[a-z0-9.!\#$%&\'*+-=?^_`{|}~]+@([0-9.]+|([^\s]+\.+[a-z]{2,6}))$/';
print_r(preg_match($regEx, $theEmail));
?> 
```

虽然这个正则表达式对于电子邮件验证之类的东西非常复杂 - 我建议在将其投入生产之前尝试对其进行改进和微调。

# html - 提示/警告/错误退出的 HTML5 语义元素？

> ID：11672540
> 
> 赞同：0
> 
> 时间：2012-07-26T15:18:43.940
> 
> 标签：html, semantics, semantic-markup, wai-aria

我正在使用 XML 安全的 HTML5，并且想知道记录额外提示/警告/错误框的语义方式（就像技术手册中常见的那些）：

```
<div class="info-tip" role="contentinfo">
    <p><strong>Tip:</strong> Holding the control key when doing this will make life easier.</p>
</div> 
```

除非可能，否则我想使用更合适的元素。我什至不确定`contentinfo`这里是否是一个合适的选择。

**补充：**我`<note>`在寻找 DITA 中元素的 HTML5 替代品。

**一点上下文：**我将使用样式表（XSLT2 和 CSS）来重新格式化一些输出的内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T16:03:13.477

语义上最接近的似乎是`<details>`元素 -[用法](http://html5doctor.com/the-details-and-summary-elements/)

# iphone - 如何处理不受信任的服务 URL？

> ID：11672541
> 
> 赞同：1
> 
> 时间：2012-07-26T15:18:45.613
> 
> 标签：iphone, objective-c, ios, json, nsurlconnection

我正在使用具有无效证书的服务器上的 Web 服务，但无论如何我都想获得响应。有办法吗？？这是示例代码：

```
-(void)createHttpHeaderRequest:(serviceType)type {
    NSMutableURLRequest * theRequest;
    if (type==kServiceTypeTopAccessory) {

        NSString * test = @"{\"GetVehicleInventory\": {\"ApplicationArea\": some Json object here}}}}}";

        NSString * final = (__bridge NSString *) CFURLCreateStringByAddingPercentEscapes(kCFAllocatorDefault, (__bridge CFStringRef)test, NULL, CFSTR(":/?#[]@!$&'()*+,;=\""), kCFStringEncodingUTF8);
        NSString * sampleReq = [NSString stringWithFormat:@"https://myuntrutsedServer?XML_INPUT=%@",final];
       // NSString * final = [sampleReq stringByAddingPercentEscapesUsingEncoding:NSASCIIStringEncoding];

        NSLog(@"JSON:%@",sampleReq);

        theRequest = [NSMutableURLRequest requestWithURL:[NSURL URLWithString:sampleReq]];
    }
    NSLog(@"Request:%@",theRequest);
    self.theConnection = [[NSURLConnection alloc]initWithRequest:theRequest delegate:self];
    if (self.theConnection) {
        NSLog(@"Service hit");
    }
}

-(BOOL)connection:(NSURLConnection *)connection canAuthenticateAgainstProtectionSpace:(NSURLProtectionSpace *)protectionSpace {
    return [protectionSpace.authenticationMethod isEqualToString:NSURLAuthenticationMethodServerTrust];
}

- (void)connection:(NSURLConnection *)connection didReceiveAuthenticationChallenge:(NSURLAuthenticationChallenge *)challenge {

    [challenge.sender continueWithoutCredentialForAuthenticationChallenge:challenge];
}

-(void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error {
    NSLog(@"Error%@",error);
}

- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response{

    NSLog(@"Reached here");

} 
```

我在 didFailWithError 方法中收到此错误： NSLocalizedDescription=此服务器的证书无效。您可能正在连接到伪装成“209.112.58.126”的服务器，这可能会使您的机密信息面临风险。，NSUnderlyingError=0x6877b40“此服务器的证书无效。您可能正在连接到伪装成的服务器是“209.112.58.126”，这可能会使您的机密信息面临风险。", NSURLErrorFailingURLPeerTrustErrorKey=}

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T17:46:12.783

我通过这样做来修复它：

```
- (void)connection:(NSURLConnection *)connection didReceiveAuthenticationChallenge:(NSURLAuthenticationChallenge *)challenge {
    [challenge.sender useCredential:[NSURLCredential credentialForTrust:challenge.protectionSpace.serverTrust] forAuthenticationChallenge:challenge];
} 
```

享受！！！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-26T16:26:12.930

这是我从 Apple 的*AdvancedURLConnections*示例代码中提取的内容：

```
if ([challenge.protectionSpace.authenticationMethod isEqualToString:NSURLAuthenticationMethodServerTrust]) {

    // Verify certificate:
    SecTrustResultType trustResult;
    OSStatus status = SecTrustEvaluate(challenge.protectionSpace.serverTrust, &trustResult);
    BOOL trusted = (status == errSecSuccess) && ((trustResult == kSecTrustResultProceed) || (trustResult == kSecTrustResultUnspecified));

    if (trusted) {
        [challenge.sender useCredential:[NSURLCredential credentialForTrust:challenge.protectionSpace.serverTrust]
             forAuthenticationChallenge:challenge];
    } else {
        if (user_wants_to_trust_invalid_certificates) {
            [challenge.sender useCredential:[NSURLCredential credentialForTrust:challenge.protectionSpace.serverTrust]
                 forAuthenticationChallenge:challenge];
        } else {
            [challenge.sender cancelAuthenticationChallenge:challenge];
        }
    }
} else {
    [challenge.sender performDefaultHandlingForAuthenticationChallenge:challenge];
} 
```

*注意：*正如 mbm30075 正确指出的那样，此代码进入

```
connection:didReceiveAuthenticationChallenge: 
```

从 iOS 5 开始，您可以使用委托功能

```
connection:willSendRequestForAuthenticationChallenge: 
```

反而。您必须将安全框架添加到您的项目中才能编译。

# c# - ASP.NET MVC4 重定向到登录页面

> ID：11672542
> 
> 赞同：24
> 
> 时间：2012-07-26T15:18:47.820
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-4

我正在使用 ASP.NET MVC 4 和 C# 创建一个 Web 应用程序。

我希望所有用户在使用应用程序之前都已登录。

我正在使用带有自定义数据库的 ASP.NET 成员资格。

一种方法是检查`Membership.GetUser()`每个函数是否为空。

**但是没有比在每个函数中检查用户登录状态更简单的方法了吗？**（也许检查 web.config、global.asax 等...？？）

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-07-26T15:21:59.530

当然，用它来装饰你的动作或整个班级，[`[Authorize]`](http://msdn.microsoft.com/en-us/library/system.web.mvc.authorizeattribute.aspx)这将要求用户首先登录。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-07-26T15:31:31.957

覆盖`[Authorize]`您只希望登录用户访问的每个操作。您也可以在控制器级别执行此操作，从而确保控制器内的所有操作都是安全的。后者可能最适合您，因为您可能只想为访客禁用所有页面。

这是类级别的样子：

```
[Authorize]
public class SomethingController
{
    //...
} 
```

这是一个动作级别的：

```
public class SomethingController
{
    [Authorize]
    public ActionResult SomeAction(Parameter someParameter)
    {
        //...   
    }
} 
```

如果您的所有或大部分页面使用相同的母版页，另一种方法是放置：

```
<script type="text/javascript>
    @if(!Request.IsAuthenticated) {
        window.location.href = redirectURL;
    }
</script> 
```

或者如果你不使用剃刀语法，

```
<script type="text/javascript>  
    <% if(!Request.IsAuthenticated) { %>
        window.location.href = redirectURL;
    <% } %>
</script> 
```

在母版页中。这样，如果用户未登录，所有使用该母版页的页面都将重定向到其他地方。但这仅适用于您使用内置身份验证的情况。 ***注意：此选项远不如第一个选项安全。仅当站点安全不是大问题时才使用此选项***

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2017-09-13T10:04:43.663

我知道这个问题已经有了答案，但如果打算锁定整个应用程序，除了少数几个控制器操作，那么我觉得这是一个更好的解决方案......

在您的应用程序的启动/初始化中添加...

```
httpConfig.filters.Add(new AuthorizeAttribute()); 
```

...然后在您不想保护的操作**上**...

```
[AllowAnonymous]
public ActionResult Hello() { return View(); } 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-12-03T21:46:23.907

您可以将`[Authorize]`属性放在控制器中或控制器中的单个方法中，以便您选择谁可以打开操作以及具有哪些权限。您还可以使用以下角色进行授权：`[Authorize(Roles="Admin")]`您将仅授权具有管理员角色的用户访问您的操作/控制器。例如：

```
[Authorize(Roles="SimpleUser")] or with no roles [Authorize]
public ActionResult Index()
{
    return View();
}

[Authorize]
[HttpPost]
public ActionResult Index(FormCollection form)
{
    ... whatever logic
    return View();
} 
```

希望这可以帮助 ;]

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-07-26T15:22:06.867

您可以编写自定义`[Authorize]`属性。然后简单地用它装饰控制器/动作，或者如果所有动作都需要授权，您可以将其注册为全局动作过滤器。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-06-24T06:26:46.887

在类级别使用 [Authorize]

如果您想允许匿名访问某些操作，请使用 [AllowAnonymous]

# php - 如何在 PHP 中继承类名？

> ID：11672546
> 
> 赞同：0
> 
> 时间：2012-07-26T15:19:03.420
> 
> 标签：php

如何获取子类的类名而不是父类？两者都打印`a`，但它应该`b`在第二个打印`var_dump()`。

```
 <?php
    class a
    {
        public $name;

        public function __construct()
        {
            $this->name=get_class();
        }
    }

    class b extends a
    {
        public function b()
        {
            parent::__construct();
        }
    }

    $a= new a();
    $b=new b();

    var_dump($a); //prints a
    var_dump($b); //prints a, i want to be printed b here
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T15:21:41.563

传递`$this`给[`get_class()`](http://php.net/get_class)：

```
$this->name = get_class($this); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-22T17:13:32.260

在静态方法中，**并**`get_class()`不会`__ CLASS __`起作用。

 **只会`get_called_class()`工作。

见： http: [//php.net/manual/en/function.get-called-class.php](http://php.net/manual/en/function.get-called-class.php)**

# php - 提取图像的 WP / PHP 函数不起作用

> ID：11672548
> 
> 赞同：0
> 
> 时间：2012-07-26T15:19:14.043
> 
> 标签：php, wordpress

我经常使用这个函数来提取帖子的图像：

```
function first_post_image($content) {
$first_img = '';
$output = preg_match_all('/<img.+src=[\'"]([^\'"]+)[\'"].*>/i', $content, $matches);
$first_img = $matches [1] [0];
return $first_img;
} 
```

然后我用以下代码显示图像

```
<?php $postimage = first_post_image(get_the_content()); ?> // catch the image
<img src="<?php echo $postimage; ?>" /> //view the image 
```

现在我尝试在我的上一个模板（wp）中使用此功能，但图像没有出现。我可以看到标签 img 和 src 属性，但它是空的。

有人可以帮助我吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T13:34:19.787

我做了一些测试，最后我解决了这个问题。我不知道我是否犯了错误，但代码是相同的，现在可以正常工作。谢谢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T19:48:08.593

你有没有做过`var_dump( $postimage );`看看函数返回了什么？

这是一个有效的方法，如果没有图像，它不会返回一个空数组，而是返回 false，因此您可以指定备份或默认图像。

```
 /**
     * Extracts the first image in the post content
     *
     * @param object $post the post object
     * @return bool|string false if no images or img src
     */
    function extract_image( $post ) {
        $html = $post->post_content;
        if ( stripos( $html, '<img' ) !== false ) {
            $regex = '#<\s*img [^\>]*src\s*=\s*(["\'])(.*?)\1#im';
            preg_match( $regex, $html, $matches );
            unset( $regex );
            unset( $html );
            if ( is_array( $matches ) && ! empty( $matches ) ) {
                return  $matches[2];

            } else {
                return false;
            }
        } else {
            return false;
        }
    } 
```

# javascript - 如何在Javascript中获取输入字段的值

> ID：11672549
> 
> 赞同：0
> 
> 时间：2012-07-26T15:19:17.347
> 
> 标签：javascript, html, jquery

我正在使用 valums-file-uploader 插件。它允许我使用 ajax 上传文件。我有一个问题。我有以下脚本-

```
<input type="text" id="Gaurav" name="Gaurav" />
<script src="fileuploader.js" type="text/javascript"></script>
<script>
    function createUploader(){
        var uploader = new qq.FileUploader({
            element: document.getElementById('file'),
            action: 'do-nothing.php',
            params:{param: document.getElementById('Gaurav').value},
            allowedExtensions: ['jpg', 'jpeg', 'png', 'gif'],
            minSizeLimit: 1,
            debug: false
        });
    }

    // in your app create uploader as soon as the DOM is ready
    // dont wait for the window to load  
    window.onload = createUploader;     
</script> 
```

在其中，我想设置用户输入的参数值。该代码适用于 Gaurav 的默认值，但不适用于用户输入的值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T15:23:23.673

您需要在用户输入值`createUploader` *后调用。*此代码在窗口加载后立即“修复”参数值。

您可能有一个按钮单击事件或其他东西 - 从中​​调用它，它会*在那个时候*取值......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T15:24:24.233

您为您的函数设置一个参数（您要推送的值）并在用户在输入中写入内容时调用该函数。*该参数实际上是可选的，因为您的函数从输入本身获取值，但是在您跳过 DOM 搜索时传递参数更有效。

```
<input type="text" id="Gaurav" name="Gaurav" onchange="createUploader($(this).val())" />
<script src="fileuploader.js" type="text/javascript"></script>
<script>
    function createUploader(value){
        var uploader = new qq.FileUploader({
            element: document.getElementById('file'),
            action: 'do-nothing.php',
            params:{param: value,
            allowedExtensions: ['jpg', 'jpeg', 'png', 'gif'],
            minSizeLimit: 1,
            debug: false
        });
    }

    // in your app create uploader as soon as the DOM is ready
    // dont wait for the window to load  
    window.onload = createUploader($("#Gaurav").val());     
</script> 
```

# jquery - 如何将ajax返回数据存储到浏览器缓存中

> ID：11672551
> 
> 赞同：0
> 
> 时间：2012-07-26T15:19:28.837
> 
> 标签：jquery, json, caching, browser

我通过 ajax 请求向浏览器返回了很多配置。我想将对象存储到浏览器缓存中。 **不是 html5 本地存储**。我有超过 5mb 的需要存储的对象。有没有办法通过java脚本设置这些数据，然后以后可以访问它？我找不到太多关于这个主题的好材料。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:27:52.940

一个鲜为人知的事实是它`window.name`可以容纳大约 4MB 的数据。如果您对 JSON 进行字符串化，则可以将其存储在其中。请注意，这不是域安全的，因此任何其他页面也可以访问该数据。您可以通过在自己的页面中使用 Iframe 来解决此问题，然后设置 Iframe 的 window.name 值。因此，理论上您可以使用多个 iframe 来保存不同的数据段。

看：

[http://skysanders.net/subtext/archive/2010/10/11/leveraging-window.name-transport-for-secure-and-efficient-cross-domain-communications.aspx](http://skysanders.net/subtext/archive/2010/10/11/leveraging-window.name-transport-for-secure-and-efficient-cross-domain-communications.aspx)

[使用 window.name 跨域访问 iframe](https://stackoverflow.com/questions/5092973/cross-domain-access-to-iframe-using-window-name)

[http://blog.piotrj.org/2009/04/wndowname-hack-taken-step-further-full.html](http://blog.piotrj.org/2009/04/wndowname-hack-taken-step-further-full.html)

# javascript - 如何让这种转换在 webkit 中工作？

> ID：11672553
> 
> 赞同：0
> 
> 时间：2012-07-26T15:19:41.750
> 
> 标签：javascript, webkit, css-transitions

我在使用样式表时取得了成功，但在 JavaScript 中这样做并不适合我。我需要以编程方式执行此操作。希望您会意识到我正在尝试使 div '增长'。

```
var myElement = document.createElement('div');
myElement.style.height = '0px';
myElement.style.padding = '0px';
myElement.style.webkitTransition = '2s'; /* problem with this line ? */
myElement.style.height = '200px'; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:40:46.990

我不熟悉css3，但根据[我尝试过的](http://jsfiddle.net/ec9VE/4/)这项工作：

```
var myElement = document.createElement('div');
myElement.style.height = '0px';
myElement.style.padding = '0px';
myElement.style.height = '0';
myElement.style.webkitTransition = '2s';
// Append the element to DOM
document.getElementById("a").appendChild(myElement);
// Alter the height after forcing a reflow
myElement.offsetWidth=myElement.offsetWidth;
myElement.style.height = '200px';​
/*// Alter the height later
setTimeout(function() {
    myElement.style.height = '200px';
}, 1);​*/ 
```

多亏了 Esailija，您需要强制进行回流，如[问题的回答中所述](https://stackoverflow.com/a/1278213/1386111)。访问诸如`offsetWidth`将强制回流的属性，因此这是比计时器更好的方法。

# jquery - jQuery自动完成 - 不在新输入上向服务器端发送请求

> ID：11672556
> 
> 赞同：0
> 
> 时间：2012-07-26T15:19:51.153
> 
> 标签：jquery, autocomplete

我有一个主要基于本教程的自动完成实现：http: [//viralpatel.net/blogs/tutorial-create-autocomplete-feature-with-java-jsp-jquery](http://viralpatel.net/blogs/tutorial-create-autocomplete-feature-with-java-jsp-jquery)

然而，与文章相反，我从数据库中获取记录并在 jsp 中使用 out.println(recordValue); 打印出来。这个jsp被称为：

```
 <input type="text" id="country" name="country"/>
    <script>
        $("#country").autocomplete("getdata.jsp");
    </script> 
```

这些记录来自包含数百万条记录的表，因此我只放置我用“rowNum < 10;”过滤的前 10 条记录。

这对普通数据非常有用。当查询返回的记录超过 10 条时，问题就出现了，并且可能还有更多记录……例如，假设我有如下数据：Test10，Test11，Test12，Test13，Test14，Test15，Test16，Test17，Test18，Test19，Test20假设我们在键入 Test 后最初进行查询以获取记录，并返回从 Test10 到 Test19 的第 10 条记录 - 这是正确的。但是现在当用户键入 Test2 时，我们应该再次查询后端，但这对我来说没有发生......</p>

如前所述，返回所有记录根本不是一种选择，因为可能有数百万条记录。但是当输入一个新字符时（比如在输入 Test 后输入 2），我们需要回到上面脚本中调用的 jsp 内的服务器，以便调用 getData。

有没有办法解决这个问题？

我已经尝试过改成这个，但是没有用

```
 <input type="text" id="country" name="country"/>
    <script>
            $("#country").autocomplete({
                    change: "getdata.jsp"
            });
    </script> 
```

谢谢！

* * *

由于我无法在没有 50 个代表的情况下添加评论，因此编辑问题以回复 @Barmar ...

感谢您的回复@Barmar。我确实尝试过在 Firefox 和私有模式下禁用缓存，所以希望它不会记住任何东西。但我仍然看到相同的行为

为了进一步调试，我在 jquery.autocomplete.js 中添加了一个警报，似乎该函数确实在按键时被调用，但它仍然不会将请求传播到后端的服务器端。似乎javascript正在吞噬请求，或者可能有一些逻辑决定是否将请求发送到服务器。我正在进一步研究这个问题。

但是，看起来很奇怪的是像 jquery 这样的标准产品可能有问题，所以也许我缺少一些设置/配置。但我还没有弄清楚，那可能是什么。

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T19:32:23.620

找到了解决这个问题的方法。

jQuery 自动完成 javascript（我们拥有的版本）正在缓存第一个查询返回的值，如果缓存中的任何值与输入的字符串匹配，则不会返回后端。

刚开始在keydown上刷新缓存，就解决了问题。

# java - 是否可以从 AWT 组件中获取像素？

> ID：11672557
> 
> 赞同：2
> 
> 时间：2012-07-26T15:19:53.163
> 
> 标签：java, image, awt, screenshot, awtrobot

我知道可以通过在实例上调用`paint(Graphics g)`方法来捕获轻量级 Swing 组件图片。`BufferedImage.getGraphics()`喜欢这里：[Swing：获取 JFrame 的图像](https://stackoverflow.com/questions/5853879/java-swing-obtain-image-of-jframe)

是否可以将 AWT 组件的内容作为 抓取`Image`？

到目前为止，我`java.awt.Robot`只考虑解决方案：

1.  获取 AWT 组件边界
2.  制作具有特定范围的屏幕截图。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T09:31:11.300

似乎唯一可行的解​​决方案是：

1.  在屏幕坐标系中查找组件边界。
2.  使用`java.awt.Robot`类创建与组件对应的区域的屏幕截图。

# google-app-engine - GAE 上的 Java.awt.geom.RectangularShape 支持

> ID：11672559
> 
> 赞同：0
> 
> 时间：2012-07-26T15:19:56.507
> 
> 标签：google-app-engine

我正在使用 Apache POI 库来操作 PowerPoint 文件。它在 GAE 上非常适用于检查 PPTX 文件的内容。但是，如果我尝试更改 PowerPoint 文件的内容，则会收到以下 GAE 错误：

java.lang.NoClassDefFoundError: java.awt.geom.RectangularShape 是一个受限类。有关详细信息，请参阅 Google App Engine 开发人员指南。在 com.google.apphosting.runtime.security.shared.stub.java.awt.geom.RectangularShape.(RectangularShape.java) 在 org.apache.poi.xslf.usermodel.XSLFSimpleShape.getAnchor(XSLFSimpleShape.java:176)

有没有人在 GAE 上解决过这个问题或类似的 java.awt 问题？我正在考虑破解 Apache POI 源，但宁愿在 GAE 中对 java.awt 提供某种本机支持。我做了一些研究，并且：

1) 在 GAE 上针对 java.awt 支持提出了很多问题，并且已被接受为问题。想知道这是否在内部取得了进展？它于 2011 年 8 月被接受。

2）有一个项目：[http](http://code.google.com/p/appengine-awt/) ://code.google.com/p/appengine-awt/是java.awt的纯java实现。我想知道这是否支持 java.awt.geom.RectangularShape？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T09:43:37.477

因此，我设法为使用 GAE 的其他感兴趣的 Apache POI 用户解决了这个问题。您可以对预定义的 PowerPoint 模板进行一些操作，只是避免使用任何需要使用底层 java.awt 库（在 GAE 上受限）的方法。我的问题是使用 createSlide() 和 importContent() 方法。我只需要修改文本，以便在内存版本的 PPT 文件上使用：

```
XSLFShape[] shapes = slide.getShapes();
    for (XSLFShape shape : shapes) {
        if (shape instanceof XSLFTextShape) {
            XSLFTextShape textShape = (XSLFTextShape)shape;

            switch (shape.getShapeId()) 
            case 1:
                textShape.setText("1st text box"); 
```

解决了我的问题。

Plea to Google - 请提供一个 API 用于直接操作 Google Docs/Presentations。目前唯一的解决方案是将 Google 演示文稿下载到 GAE（内存中），使用 Apache POI 进行操作，然后作为不同的 Google 演示文稿上传。

# el - 在中使用 EL 标签

> ID：11672561
> 
> 赞同：1
> 
> 时间：2012-07-26T15:19:57.693
> 
> 标签：el, jsf-1.2, jspinclude

我有一个 jsf 1.2 / rich faces 3.2.2 项目（使用 java 6）。我想根据登录用户的类型有条件地显示菜单栏。来自问题[如何使用 JSF 和 Facelets 有条件地在我的模板中包含文件？](https://stackoverflow.com/questions/8947425/how-to-conditionally-include-a-file-in-my-template-using-jsf-and-facelets)我尝试了以下方法：-

```
...
<td valign="top" align="left" height="100%">
</f:verbatim> 
 <jsp:include page="../Menu${authenticateBean.menuSuffix}.jsp" /> <f:verbatim></td>
...
i also tried 
  <jsp:include page="../Menu#{authenticateBean.menuSuffix}.jsp" />
... 
```

其中 authenticateBean.menuSuffix 是一个字符串，它将返回“A”或“B”，最终，理论上“MenuA.jsp”或“MenuB.jsp”页面应该包含在我的页面中。但我收到以下错误

```
javax.servlet.ServletException: File &quot;/pages/includes/LeftPan.jsp&quot; not found 
```

帮助。请。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T18:07:59.523

下面是我如何管理它。如果没有人需要，可以将其作为答案……</p>

```
<%
AuthenticateBean authBean=
((AuthenticateBean)FacesUtils.getManagedBean(AuthenticateBean.MANAGED_NAME));
    String panSuffix = authBean.getPanSuffix();
String impPage = "../includes/Menu"+ panSuffix +".jsp";
 %>
 .
 .
 .  
<jsp:include page="<%= impPage %>" /> 
```

在 getPanSuffix() 中，我放置了检查登录用户类型并相应返回字符串的业务逻辑。对于类型“A”的用户。MenuA.jsp 将显示，对于类型“B”的用户 MenuB.jsp 将显示。可能是一种原始的做事方式，但对我有用。谢谢大家。

# asp.net-mvc - VB ASP.net MVC Razor：以编程方式更改视图（模板）

> ID：11672562
> 
> 赞同：1
> 
> 时间：2012-07-26T15:19:58.890
> 
> 标签：asp.net-mvc, vb.net, asp.net-mvc-3

我想创建一个带有子博客的博客。每个子博客在模型中都有它自己的“主题”变量，它会改变主题。我尝试将主题变量传递给 _ViewStart.vbhtml 页面，如下所示：

> @代码
> 
> ```
> @((@ViewBag.Theme.length > 0) ? Layout = @ViewBag.Theme : Layout = "~/Views/Shared/_Layout.vbhtml")
>      End Code 
> ```

但是，我收到一个错误：

说明：在编译服务此请求所需的资源期间发生错误。请查看以下特定错误详细信息并适当修改您的源代码。

> 编译器错误消息：BC30201：预期表达式。
> 
> 源错误：
> 
> 第 5 行：*@ 第 6 行：第 7 行：@((@ViewBag.Theme.length > 0) ? Layout = @ViewBag.Theme : Layout = "~/Views/Shared/_Layout.vbhtml") 第 8 行：第 9 行: 结束代码
> 
> 源文件：C:\Users\darchual\documents\visual studio 2010\Projects\GemcoBlog\GemcoBlog\Views_ViewStart.vbhtml 行：7

如何更改模板，有更好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T15:22:38.020

试试看

```
@{
    Layout = (ViewBag.Theme.length > 0) ? ViewBag.Theme : "~/Views/Shared/_Layout.vbhtml"
} 
```

就像一个警告一样，如果主题为空，那么长度将失败。可以做得更好

```
@{
    Layout = !String.IsNullOrWhiteSpace(ViewBag.Theme) ? ViewBag.Theme : "~/Views/Shared/_Layout.vbhtml"
} 
```

**编辑：**仅作记录，是的，在您链接的答案（[stackoverflow.com/questions/5059323](https://stackoverflow.com/questions/5059323)）中设置不同的视图是更好和正确的方法，但请注意，如果您想坚持您的方法，这适用于我：

```
@{
    Layout = !String.IsNullOrWhiteSpace((String)ViewContext.ViewData["Theme"]) ? (String)ViewContext.ViewData["Theme"] : "~/Views/Shared/_Layout.cshtml";
} 
```

# html - Ajax 表单需要在淡出之前点击两次提交

> ID：11672568
> 
> 赞同：0
> 
> 时间：2012-07-26T15:20:21.153
> 
> 标签：html, ajax, forms

所以我的语法显然有问题。验证没问题。当我单击提交时，表单会向我发送电子邮件，然后它会删除我输入的值。到目前为止一切都很好。但它并没有像它应该的那样淡出。如果我再次单击提交，则它会淡出。谢谢！

```
<script type="text/javascript">
$(document).ready(function () {
    $('#form1').ajaxForm({
        beforeSubmit: validate
    });

    function validate(formData, jqForm, options) {
        var name = $('input[name=name]').fieldValue();
        var email = $('input[name=email]').fieldValue();
        var message = $('textarea[name=message]').fieldValue();

        if (!name[0]) {
            alert('Please enter a value for name');
            return false;
        }
        if (!email[0]) {
            alert('Please enter a value for email');
            return false;
        }
        if (!message[0]) {
            alert('Please enter a value for message');
            return false;
        }

        else {
            $("#form1").ajaxForm(function () {
        $("#formplic").fadeOut(1000, function () {
            $(this).html("<img src='images/postauto3.png'/>").fadeIn(2000);
        });
    });
        var message = $('textarea[name=message]').val('');
        var name = $('input[name=name]').val('');
        var email = $('input[name=email]').val('');

            } 
    }

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T18:47:57.757

好的。我想到了。问题是，我再次声明了ajax.Form。我删除了那条线，它工作得很好。所以，如果有人犯了和我一样的错误，删除 $("#form1").ajaxForm(function ().

# php - PHP MVC - 确定要加载什么视图的方法

> ID：11672574
> 
> 赞同：0
> 
> 时间：2012-07-26T15:20:50.880
> 
> 标签：php, model-view-controller

我对 MVC 有一些了解，尽管我仍在弄清楚很多细节。我写了一些小的个人项目来学习，虽然我仍然不太确定如何做的一件事是优雅地处理三个之间的逻辑以确定我应该加载什么视图。

例如，想象一个基本的用户注册系统。每个用户都需要有一个用户名、密码和一些其他详细信息来识别他们。我会像这样对模型进行编码：

```
namespace Model;

class NewUser extends Model
{
    public $username;
    public $password;
    public $other_details;

    public function __construct(array $data)
    {
        if ($this -> CheckData($data))
        {
            // Add data to some database table.
            $this -> InsertData($data);
        }
    }

    private function CheckData(array $data)
    {
        if (!isset($data['username']) || empty($data['username']))
        {
            return FALSE;
        }

        // !isset() and empty() checks on other required information.

        if (strlen($data['password']) < 8)
        {
            return FALSE;
        }

        // Make sure data meets other requirements, return FALSE if not.

        return TRUE;
    }
} 
```

所以这很简单。NewUser::CheckData() 确保传入的数据符合新用户的要求。所有信息必须非空，密码至少八个字符等。如果不满足要求，则失败并且不添加数据。如果满足，则将新用户添加到系统中。

控制器处理客户端发出的 HTTP 请求，请求适当的数据，然后“给”客户端 HTTP 响应，因此我将编写控制器代码如下：

```
namespace Controller;

class NewUser extends Controller
{
    public $new_user;

    public function __construct()
    {
        if (isset($_POST) && !empty($_POST['username']))
        {
            $this -> new_user = new \Model\NewUser($_POST);

            // How should I handle what View to load in this case?
        }

        else
        {
            $this -> DefaultView();
        }
    }

    private function DefaultView()
    {
        $this -> LoadView('header.php');
        $this -> LoadView('signup.php');
        $this -> LoadView('footer.php');
    }

    private function MissingDataView()
    {
        $this -> LoadView('header.php');
        $this -> LoadView('missing-data.php');
        $this -> LoadView('footer.php');
    }

    private function PasswordTooShortView()
    {
        $this -> LoadView('header.php');
        $this -> LoadView('password-too-short.php');
        $this -> LoadView('footer.php');
    }
} 
```

再次，非常简单。如果 $_POST 未设置，则调用 DefaultView()。正如评论所指出的，在设置 $_POST 的情况下，我对如何确定要加载的视图感到困惑。过去`$error`，我的模型中有一个额外的变量，然后我会检查控制器中设置的内容，并根据其值调用适当的方法。这似乎是一种糟糕的处理方式，所以如果有人能指出我正确的方向，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T15:26:17.563

对于显示表单和任何错误的注册操作，您通常会有一个视图。提交后，如果所有必需的数据都有效，您的控制器会将用户插入数据库并执行您需要的任何逻辑，无论是重定向到确认页面。

# java - java: hashmap.put(key, function()) 中的函数是线程安全的吗？

> ID：11672575
> 
> 赞同：0
> 
> 时间：2012-07-26T15:20:52.057
> 
> 标签：java

我想像这样将从函数返回的值放入 ConcurrentHashmap

```
private static ConcurrentHashMap<String, Object> map = new ConcurrentHashMap<String, Object>();

public void process() {
    map.put(key, function());
}

public Object function() {
    return anyObject;
} 
```

我可以知道函数（例如函数（））是否是线程安全的吗？有教程请指教谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:23:15.683

调用自身不是线程安全的，只将操作原子化。

相反，您可以使用番石榴

```
ConcurrentMap<Key, Graph> graphs = new MapMaker()
   .concurrencyLevel(4)
   .weakKeys()
   .maximumSize(10000)
   .expireAfterWrite(10, TimeUnit.MINUTES)
   .makeComputingMap(
       new Function<Key, Graph>() {
         public Graph apply(Key key) {
           return createExpensiveGraph(key);
         }
       }); 
```

请注意**makeComputingMap()**调用

[http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/MapMaker.html](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/MapMaker.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T16:01:31.157

您可以使用 Java 中的读/写锁。

例子：

```
class X {
  ReadWriteLock rw;

  public void read() throws InterruptedException { 
    rw.readLock().acquire();
    try {
      // ... do the read
    } finally {
      rw.readlock().release()
    }
 }

 public void write() throws InterruptedException { 
     rw.writeLock().acquire();
     try {
       // ... do the write
     } finally {
       rw.writelock().release()
     }
   }
 } 
```

参考：

[http://www.coderanch.com/t/232685/threads/java/Concurrent-access-HashMap](http://www.coderanch.com/t/232685/threads/java/Concurrent-access-HashMap) http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/locks /ReadWriteLock.html [http://tutorials.jenkov.com/java-concurrency/read-write-locks.html](http://tutorials.jenkov.com/java-concurrency/read-write-locks.html)

# ios - iOS 客户端/服务器应用程序

> ID：11672576
> 
> 赞同：0
> 
> 时间：2012-07-26T15:20:56.127
> 
> 标签：ios, json, rest, https, client-server

我有过 iOS 开发经验，但没有客户端服务器类型的应用程序。

我听说过 HTTPS、REST、JSON 等。我对这些差异感到困惑。

我要构建的应用程序正在获取要输出给用户的数据列表，并将表单发送到服务器以进行处理。例如，向服务器提交会员申请，其中包含要存储在服务器中的个人信息和其他相关信息。我还需要安全连接，用户必须使用用户名和密码登录服务器。

我的应用程序如何与服务器通信？是使用 NSURLRequest 吗？

完成此任务的最佳方法或协议是什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:30:58.620

HTTPS、REST 和 JSON 是您在执行网络操作时可以使用的不同工具（更具体地说，分别是安全协议、Web 服务架构和对象序列化方法）。如果你不知道这些是什么意思，在尝试构建一个作为客户端运行的 iOS 应用程序之前，我会做一些阅读。评论中发布的链接 johnathon 对于您想要做的事情来说有点低级，但搜索“使用 iOS 使用 Web 服务”可能会很好。

此外，该服务是否已经存在？如果是这样，您的任务本质上是了解如何与服务器通信。

但是，一旦您对基础知识有了更多了解，[AFNetworking](https://github.com/AFNetworking/AFNetworking/)库就非常出色。

# java - 如何使用重定向处理模板

> ID：11672578
> 
> 赞同：1
> 
> 时间：2012-07-26T15:20:56.877
> 
> 标签：java, templates, servlets

我想解决以下问题，它是关于从数据库中删除实体：

1.  用户为某个实体选择*删除*
2.  已从数据库中删除并从列表中消失
3.  页面内会出现一个撤消框架（如[Twitter Bootstrap 警报消息](http://twitter.github.com/bootstrap/components.html#alerts)），用户可以在其中选择撤消删除操作。

我不知道如何实现这一点，因为目前我以这种方式解决了这个问题：

*   *删除*按钮链接到 URL：delete/entity_id
*   我在删除实体的请求处理程序中为此 URL 编写了一个 if-case
*   删除完成后，我发送一个`response.sendRedirect(/list)`以便显示更新的列表

这样我就不能通过重定向来发送额外的数据。通常我会通过模板处理它们来发送额外的数据，但这`redirect`是不可能的。

这种情况如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T17:25:43.220

我的 Web 应用程序中很少有这样的场景，这就是我解决它的方法

我有一个名为消息队列的类，如下所示

```
public class MessageQueue {

  public static Hashtable<String, Object> messages = new Hashtable<String, Object>();

  public static void putMessage(String key, Object obj)
  {
    messages.put(key, obj);
  }

  public static Object getMessage(String key)
  {
    if(key == null)
      return null;

    Object obj = messages.get(key);

    if(obj == null)
      return null;

    messages.remove(key);

    return obj;
  }

} 
```

现在这个类留在记忆中。在重定向之前，我创建了一些重定向后需要的对象。创建一个随机 Guid 作为字符串，然后将此对象存储在消息队列中

然后我将此 Guid 添加为 URL 的参数

String justDeletedId = "someId"; 字符串 guid = (new Guid()).toString(); MessageQueue.put(guid,justDeletedId); sendRedirect("\list\?msgid=" + guid);

现在重定向后，您可以检查 messageID 并从消息队列中删除对象并做任何您想做的事情

我选择允许使用此对象一次...以避免内存泄漏

在当前版本中......我还实施了 Last Access Eviction 策略，该策略使用石英作业定期清理此消息队列

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-28T16:22:33.507

您可以使用[HttpSession](http://docs.oracle.com/javaee/1.3/api/javax/servlet/http/HttpSession.html)`setAttribute()`的和`getAttribute()`方法。毕竟这是一种通过不同 HTTP 请求传递 Java 对象的方式。

在您的情况下，您可以创建这样的 Undo 对象并将其存储在会话中。在您描述的重定向之后，检索会话对象并将其内容传递给模板。

# python - 使用 QT Html-aware-widget 中的 HTML 在同一行上左右对齐文本

> ID：11672581
> 
> 赞同：0
> 
> 时间：2012-07-26T15:21:10.533
> 
> 标签：python, html, qt, pyside

我正在尝试编写一个小部件来查看数据库中的论坛数据。我想将主题中的帖子偏移量与用户名元数据在同一行的右上角对齐。我正在使用 QTextEdit，我的 HTML 代码构建函数如下所示：

```
def draw(self,item):
        post_text = item.post_text.replace("\n","<br /> <br />")
        user_text  = "<b>User:</b> %s. #1<br/>" % item.name
        posted_at = "<b>Posted At</b>: %s." % item.posted_at
        text = user_text + posted_at + "<hr />" + post_text       
        self._text_edit.setText(text) 
```

我想要右边的 #1 和左边的用户。我已经尝试了一些`spans`,`divs`和带有`align`属性的表来尝试让事情按我的意愿工作，但它不起作用。建议 ？:D

ps，如果有多种方法，请列举它们，因为这将有助于提高我对在QT中操作文本的理解。

![在此处输入图像描述](../Images/5cbf9dfad6e17c83cf0253474d451fa7.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T15:37:28.237

你可以试试这个...

```
user_text  = "<b>User:</b> %s. <span style="float:right;">#1</span><br/>" % item.name 
```

希望有帮助！

# c - 为什么编译器将字符视为整数？

> ID：11672582
> 
> 赞同：4
> 
> 时间：2012-07-26T15:21:10.937
> 
> 标签：c, integer

我有一小段代码。当我在 DevC++ gnu 编译器上运行它时，它会显示以下输出：

```
 main ()
 {      char b = 'a';
        printf ("%d,", sizeof ('a'));
        printf ("%d", sizeof (b));
        getch ();
 } 
```

> 输出：4,1

为什么将其`'a'`视为整数，而 as`b`仅视为字符常量？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-26T15:21:58.087

因为字符文字是类型的`int`，而不是`char`C 中的。

所以`sizeof 'a' == sizeof (int)`。

请注意，在 C++ 中，字符文字的类型是`char`等`sizeof 'a' == sizeof (char)`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T15:27:04.687

这就是它在 C 中的方式。这就是该语言最初的定义方式。至于为什么...当时 C 中的几乎所有东西都是`int`，除非有很好的理由把它变成别的东西。因此，历史上 C 中的字符常量具有 type `int`。

注意顺便说一句，在 C 命名法`'a'`中称为*constant*，而不是*literal*。C 有字符串文字，没有其他文字。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T15:29:17.500

在 C 中，字符文字的类型为 int。

在 C++ 中，仅包含一个字符的字符文字具有 char 类型，它是一种整数类型。

在 C 和 C++ 中，宽字符文字的类型为 wchar_t，多字符文字的类型为 int。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T15:38:40.277

来自 IBM XL C/C++ 文档

> 字符文字包含用单引号符号括起来的字符序列或转义序列，例如“c”。字符文字可以以字母 L 为前缀，例如 L'c'。没有 L 前缀的字符文字是普通字符文字或窄字符文字。带有 L 前缀的字符文字是宽字符文字。包含多个字符或转义序列（不包括单引号 (')、反斜杠 () 或换行符）的普通字符文字是多字符文字。
> 
> 字符文字具有以下形式：

```
 .---------------------.
             V                     |
>>-+---+--'----+-character-------+-+--'------------------------><
   '-L-'       '-escape_sequence-' 
```

> 字符文字中必须至少出现一个字符或转义序列。字符可以来自源程序字符集，不包括单引号、反斜杠和换行符。字符文字必须出现在单个逻辑源行上。
> 
> CA 字符文字的类型为 int

# excel - 为什么我的交叉表在 Excel 中被截断？

> ID：11672583
> 
> 赞同：25
> 
> 时间：2012-07-26T15:21:23.137
> 
> 标签：excel, overflow, birt, crosstab

我正在尝试使用 BIRT 创建一个 excel 电子表格。电子表格是将两个对象映射在一起的交叉表。根据 MySQL 数据库中的值，行数和列数是动态的。目前我有一个 PDF 输出报告的工作实现。现在，我正在尝试为 Excel 创建第二个版本的报告。

我已经复制了报表设计并开始对其进行调整以使用 Excel。一切看起来都不错，但只有前 3 列显示在标题之后。所有行都正确显示。

我尝试了以下方法：

*   我尝试在页面上的每个元素上将溢出设置为可见。这没有效果。
*   我尝试将母版页的高度和宽度设置为非常大的值。所有信息都正确显示，但我希望有一个没有硬编码值的解决方案。将来数据宽度可能会再次超过我的任意值并被切断。

我受到以下方面的限制：

*   我无法切换报告引擎（我必须使用 BIRT）。
*   我无法切换 Excel 发射器。

此博客条目提到了我的问题： [http](http://www.spudsoft.co.uk/2011/10/the-spudsoft-birt-excel-emitters/) ://www.spudsoft.co.uk/2011/10/the-spudsoft-birt-excel-emitters/ 但它不提供发射器开关以外的解决方案。具体引用是“这些文件也存在我无法解决的页面布局问题（特别是广泛的报告将被切断）。”

除了一个博客条目之外，我的 googlefu 让我失望了。任何帮助表示赞赏！谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T15:09:50.290

这里有两个问题。第一个比较容易，第二个比较复杂。

1.为什么我的交叉表在Excel中被截断了？

2.如何在运行时根据报表中的列数动态调整母版页宽度？

A1：交叉选项卡被切断，因为手动设置了列宽，其中列数将扩展超过母版页的设置宽度。每当您抓取报表设计元素并进行调整时，BIRT 都会假定您知道自己在做什么，并且不会覆盖您的设置。

解决方案是重新创建报表元素（表格或交叉表），而不是手动调整任何大小。在 HTML 或 Excel 中运行时，所有列将自动设置为以可用的母版页宽度显示。

BIRT 4.2 交叉表的屏幕截图，具有 2 英寸母版页宽度和 30 列的报表项

![2 英寸 x 30 列](../Images/a384775e977c05ac85711f647cc661c6.png)

A2：这并不容易，我暂时不会提供答案。我将指出解决方案并确定几个障碍。此问题的有效解决方案必须包括使用示例数据库的有效解决方案。

（*从 BIRT 4.2.1 开始*）

Challenge1 -在完成报告表或交叉表项之前，在事件中设置母版页宽度[BIRT 报告脚本。](http://www.eclipse.org/birt/phoenix/deploy/reportScripting.php)您不能简单地计算报告中有多少列；

如果你想数数，列——

报表设计初始化

```
 columnCount = 0; 
```

交叉选项卡，onCreate

```
 columnCount ++; 
```

在我的研究中，建议在创建交叉表项之前计算列的两种路径。任何一个

1.  运行 beforeFactory 中的数据集（*这意味着对数据库进行两次查询，一次用于计数，一次用于报告*），然后获取计数并使用它。

2.  计算初始查询中的值并在数据集 onFetch 中收集它。

我使用计算列遵循了数据集 onFetch 选项，但没有让它工作。

Challenge2 - 母版页的宽度属性必须在报表设计之前或之前设置，beforeRender。最常推荐使用 beforeFactory。此外，母版页的宽度属性仅在母版页“类型”设置为“自定义”时可用，在我的尝试中，我在 Property Editor **General**中手动设置。

将值从 onFetch 传递到 beforeFactory 必须使用 PersistentGlobalVariable 完成，它只能传递字符串，而不是整数。我找到了各种各样的方法来解决这个问题。即使在 PersistentGlobalVariable 中传递“12in”也无法调整母版页宽度

beforeFactory 中的这些代码中的任何一个都将调整母版页宽度（当 Type = Custom 时）

传递价值

```
reportContext.getReportRunnable().designHandle.getDesignHandle().findMasterPage("Simple MasterPage").setProperty("width","12in"); 
```

计算一个值并传递它

```
increaseWidth = 20;
reportContext.getReportRunnable().designHandle.getDesignHandle().findMasterPage( "Simple MasterPage").setProperty("width",((2+increaseWidth)+"in")); 
```

最后，我无法找到或创建一个功能报表来调整在报表运行时生成的数字列上传递的母版页宽度。我认为这是可能的，但这样做超出了我目前的技能。

# javascript - DataTables.net 中损坏的分页按钮

> ID：11672587
> 
> 赞同：0
> 
> 时间：2012-07-26T15:21:32.923
> 
> 标签：javascript, jquery, datatables

我正在尝试[使用 js 数组的 DataTables 的基本示例](http://datatables.net/release-datatables/examples/data_sources/js_array.html)。

[http://dl.dropbox.com/u/464119/Misc/Stack%20Exchange/html/table.html](http://datatables.net/release-datatables/examples/data_sources/js_array.html)

一切都渲染得很好，除了右下角的分页按钮。我尝试手动修复他们的 css，但是当重新绘制表格（分页/# 行更改）时，它又被搞砸了。

知道如何让上一个/下一个按钮呈现正常吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T15:51:07.823

修复它的一种方法是在每次表格更改时重新应用固定的 CSS：

```
$('#example').on("draw", function() {
    //Change the CSS here
}); 
```

这样，每次“绘制”表格（排序，页面更改，过滤器等）时都会修复它

但这并不能解决它首先被破坏的问题。如果我发现了什么，我会更新我的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T10:59:06.517

如果您不想要上一个/下一个文本，您可以使用下面的 oLanguage 属性将其删除

```
$('#example').dataTable( {
    "oLanguage": { "oPaginate": {"sNext": "","sPrevious": ""}},
    "aaData": //rest fo your code..... 
```

否则，下载并添加这个 css

```
<link rel="stylesheet" type="text/css" href="http://datatables.net/release-datatables/media/css/demo_table.css"> 
```

添加与上面相同的olanguage属性，文本更短

```
"oLanguage": { "oPaginate": {"sNext": "Next","sPrevious": "Prev"}}, 
```

并修改第 71 行 demo_table.css 上方 css 中的 dataTables_paginate 类以减小文本的字体大小

```
.dataTables_paginate {
    float: right;    
    text-align: right;
    font-size: 12px;
} 
```

希望这可以帮助..

# box-api - Box API 登录问题

> ID：11672589
> 
> 赞同：1
> 
> 时间：2012-07-26T15:21:48.083
> 
> 标签：box-api

如何在我的网络服务中使用 Box API 方法进行登录调用？
我只能看到一个 URL，它重定向到 Box 登录页面，用户需要在其中输入用户名和密码，但我需要这个作为 web 服务调用。
有人用 API 做过吗？

问候萨蒂什

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T19:54:56.600

您可以在[此处找到完整的详细信息，但简而言之，您可以在](http://developers.box.com/get-started/#authenticating)[http://www.box.com/developers/services](http://www.box.com/developers/services)为您的应用设置一个回调 URL ，Box 会将身份验证令牌发送到该 URL。您可以设置您的 Web 服务以在那里接收令牌。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T16:43:47.360

Box 的身份验证流程的设计方式是防止用户需要向第三方（在本例中为您）提供他们的凭据。事实上，没有通过 Web 服务调用传递凭据来对用户进行身份验证的机制是经过深思熟虑的，而且我知道没有直接的解决方法（特别是没有与使用条款一致的解决方法）他们的 API）。

[http://developers.box.com/get-started/#authenticating](http://developers.box.com/get-started/#authenticating)

他们在管道中有一个新的身份验证机制，它允许您使用更简单的过程对您的应用程序的沙盒文件夹进行身份验证。这目前处于私人测试阶段。一旦可用，这可能会满足您正在寻找的需求。

[http://developers.box.com/docs/#tokens](http://developers.box.com/docs/#tokens)

# php - PHP5 Mysqli 类不输出数据

> ID：11672592
> 
> 赞同：0
> 
> 时间：2012-07-26T15:21:56.367
> 
> 标签：php, oop, mysqli

所以我正在尝试做一个备用课程，这就是我到目前为止所拥有的。问题是 $tbl_data 为空。我究竟做错了什么。

与数据库的连接成功。

如果没有'echo $tbl_data'，'$current_table - current table' 输出是正确的，但如果使用'echo $tbl_data'，则只显示第一个表（尝试备份两个表开始）。

```
class mBackup{

private $_connection = ""; //db connection var
private $output = ""; //sql output
private $tbl_data = "";
private $tbl_row = "";
private $nfields = "";
private $create_table_query = "";
private $create_table_output = "";

public function __construct($dbhost,$dbname,$dbuser,$dbpassword){

    $this->_connection = new mysqli($dbhost,$dbuser,$dbpassword,$dbname);

    //possible connection error
    if($this->_connection->connect_errno){
        echo "Failed to connect to the DB";
    }
    else{
        echo "Connected<br />"; 
    }
}

public function backup_db(){

    //get the table names from the DB and store in an array
    $result = $this->_connection->query("SHOW TABLES");

    //get the TABLE names
    while($row = $result->fetch_row())
    {
        $table_names[] = $row[0];
    }

    //For each table
    foreach($table_names as $current_table)
    {
        echo $current_table." - current table<br />"; //debug

        $tbl_data = "";
        $tbl_row = "";
        $nfields = "";
        $create_table_query = "";
        $create_table_output = "";

        //SELECT Everything from the table in use       
        $query = $this->_connection->prepare("SELECT * FROM ?");
        $query->bind_param('s', $current_table);
        $query->execute();
        $query->bind_result($tbl_data);
        $query->fetch();

        echo $tbl_data."<br/>";

        }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T15:34:53.793

尝试类似：

```
while ($query->fetch()) {
     echo $tbl_data;
} 
```

看看能不能帮到你。据我所知，bind_result 将结果集中的列绑定到变量。如果你的表有 5 列，你应该有 bind_result($var1, $var2, $var3, $var4, $var5) 但由于你的列数会根据表而改变，我不知道 bind_result 是否会给你你需要的。

尝试在每个循环后关闭准备好的语句

```
$query->close(); 
```

或重置。

```
$query->reset() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T16:01:28.827

你不能用吗？为表名。有关标记的允许位置，请参见[http://www.php.net/manual/en/mysqli.prepare.php中的第二个注释。](http://www.php.net/manual/en/mysqli.prepare.php)因此，您必须通过普通变量插值构造查询：

```
$select = sprintf("SELECT * FROM `%s`", $current_table);
$result = $this->_connection->query($select); 
```

# vb.net - ASP.NET MVC 结构/逻辑

> ID：11672594
> 
> 赞同：0
> 
> 时间：2012-07-26T15:21:57.667
> 
> 标签：vb.net, asp.net-mvc-3

我有几个关于 MVC 应用程序中的逻辑位置的问题。

这是控制器中的一个示例操作，想知道这是否逻辑过多，如果是，您还会把它放在哪里：

仅供参考 -`Manager`是一种服务类型层，我们将 BO 转换为 DTO/ViewModels 来回转换到另一个执行我们 BL 的层

```
Public Function ChangeClaim(model As ChangeClaimViewModel) As ActionResult
        Manager.SetClaimNumber(model.ClaimNumber)

        Dim securityToken = Manager.ClaimSecurityToken

        If (securityToken.ValidClaim) Then
            Session("ClaimNumber") = model.ClaimNumber
            If (Not securityToken.ConflictAccess) Then
                ModelState.AddModelError("ClaimNumber", "You do not have access to this claim.")
            End If
        Else
            ModelState.AddModelError("ClaimNumber", "Invalid claim number.")
        End If

        If (Not ModelState.IsValid) Then
            Return View(Manager.GetViewModel())
        End If

        If (model.URL.Contains("ChangeClaim") OrElse model.URL.Contains("EnterClaim")) Then
            model.URL = Url.Action("Index", "Home")
        End If

        Return Redirect(model.URL)

    End Function 
```

另外，我会假设挂起`bool`ViewModel 以在视图中执行类似这样的逻辑可以吗？

```
@if (Model.HasExposureAccess)
    {
        <li><a href="#tab-pane-2">@Model.Labels.Reimbursements</a></li>
    } 
```

还有其他改进建议吗？

哦，对不起 VB 和 C# 的混合，我工作的商店除了 VB 中的视图之外什么都做，我不得不努力争取在 C# 中做视图！！？？

**编辑#1**

因此，`If (securityToken.ValidClaim) Then`让我尽我所能为您介绍整个过程，看看您是否有任何建议。

当用户尝试更改索赔编号时，它进入模型，传递给`Manager.SetClaim`方法（管理器是我们创建的一种服务层，能够使用我们现有的 BO 框架，别笑, 是 CSLA.NET V1 的一个经过大量修改的版本，它们是非常紧密耦合的对象，因为 BL 和 DAL 都存在于对象内部。根本不是我的选择，但是你做什么:)) 验证它是一个有效的声明，并且用户可以访问它。我正在尽我最大的努力使图层尽可能地分开：

1) MVC 应用程序
2) 应用程序管理器
3)​​ 现有 BOF

我说的有道理吗？

**编辑#2**

因此，我将控制器操作中的逻辑放入了一个操作过滤器中，如下所示：

```
Public Class ValidateClaimAttribute
Inherits ActionFilterAttribute

Public Overrides Sub OnActionExecuting(filterContext As System.Web.Mvc.ActionExecutingContext)
    MyBase.OnActionExecuting(filterContext)

    Dim model As ChangeClaimViewModel = CType(filterContext.ActionParameters("model"), ChangeClaimViewModel)
    Dim manager As IInjuredWorkerManager = DependencyResolver.Current.GetService(Of IInjuredWorkerManager)()
    Dim securityToken = manager.ClaimSecurityToken

    manager.SetClaimNumber(model.ClaimNumber)

    If (securityToken.ValidClaim) Then
        filterContext.HttpContext.Session("ClaimNumber") = model.ClaimNumber
        If (Not securityToken.ConflictAccess) Then
            filterContext.Controller.ViewData.ModelState.AddModelError("ClaimNumber", "You do not have access to this claim.")
        End If
    Else
        filterContext.Controller.ViewData.ModelState.AddModelError("ClaimNumber", "Invalid claim number.")
    End If

End Sub
End Class

<ValidateClaim()>
    Public Function ChangeClaim(model As ChangeClaimViewModel) As ActionResult
        If (Not ModelState.IsValid) Then
            Return View(Manager.GetViewModel())
        End If

        If (model.URL.Contains("ChangeClaim") OrElse model.URL.Contains("EnterClaim")) Then
            model.URL = Url.Action("Index", "Home")
        End If

        Return Redirect(model.URL)

    End Function 
```

这看起来更像是正确的做法吗？

**编辑#3** 因此，我对此进行了进一步优化：

```
<ValidateClaim()>
    Public Function ChangeClaim(model As ChangeClaimViewModel) As ActionResult
        If (Not ModelState.IsValid) Then
            Return View(Manager.GetViewModel())
        End If

        Return New MyRedirect(model.URL)

    End Function
    Public Class ValidateClaimAttribute
Inherits ActionFilterAttribute

Public Overrides Sub OnActionExecuting(filterContext As System.Web.Mvc.ActionExecutingContext)
    MyBase.OnActionExecuting(filterContext)

    Dim model As ChangeClaimViewModel = CType(filterContext.ActionParameters("model"), ChangeClaimViewModel)
    Dim manager As IInjuredWorkerManager = DependencyResolver.Current.GetService(Of IInjuredWorkerManager)()
    Dim securityToken = manager.ClaimSecurityToken

    manager.SetClaimNumber(model.ClaimNumber)

    If (securityToken.ValidClaim) Then
        filterContext.HttpContext.Session("ClaimNumber") = model.ClaimNumber
        If (Not securityToken.ConflictAccess) Then
            filterContext.Controller.ViewData.ModelState.AddModelError("ClaimNumber", "You do not have access to this claim.")
        End If
    Else
        filterContext.Controller.ViewData.ModelState.AddModelError("ClaimNumber", "Invalid claim number.")
    End If

End Sub

End Class

Public Class MyRedirect
Inherits ActionResult

Private _url As String

Public Sub New(url As String)
    _url = url
End Sub

Public Overrides Sub ExecuteResult(context As System.Web.Mvc.ControllerContext)
    Dim urlHelper As New UrlHelper(context.RequestContext)

    If (_url.Contains("ChangeClaim") OrElse _url.Contains("EnterClaim")) Then
        _url = urlHelper.Action("Index", "Home")
    End If

    context.HttpContext.Response.Redirect(_url)
End Sub
End Class 
```

完整的控制器代码：

```
Imports System.Web.Mvc
Imports System.Security.Principal
Imports Telerik.Web.Mvc
Imports System.Globalization

Namespace Controllers
<HandleException(View:="Error")>
<OutputCache(Duration:=0)>
Public MustInherit Class InjuredWorkerController
    Inherits SAIF.Web.Mvc.Framework.Controllers.ContextController

    Public Property Manager As IInjuredWorkerManager

    Public Sub New(manager As IInjuredWorkerManager)
        _Manager = manager
        _Manager.ValidationDictonary = New ModelStateWrapper(ModelState)

    End Sub

    <ValidateClaim()>
    Public Function ChangeClaim(model As ChangeClaimViewModel) As ActionResult
        If (Not ModelState.IsValid) Then
            Return View(Manager.GetViewModel())
        End If

        Return New MyRedirect(model.URL)

    End Function

    Public Function SetCulture(culture As String, returnUrl As String) As ActionResult
        Response.Cookies.Add(New HttpCookie("culture") With {
                             .Value = culture,
                             .Expires = DateTime.Now.AddYears(1)
                         })

        Return Redirect(returnUrl)

    End Function

    Protected Overrides Sub ExecuteCore()
        Dim cultureName = "en-US"
        Dim cultureCookie = Request.Cookies("culture")

        If (cultureCookie IsNot Nothing) Then
            cultureName = Request.Cookies("culture").Value
        End If

        Threading.Thread.CurrentThread.CurrentCulture = CultureInfo.CreateSpecificCulture(cultureName)
        Threading.Thread.CurrentThread.CurrentUICulture = CultureInfo.CreateSpecificCulture(cultureName)

        MyBase.ExecuteCore()
    End Sub

    Protected Overrides Sub OnActionExecuting(filterContext As System.Web.Mvc.ActionExecutingContext)
        MyBase.OnActionExecuting(filterContext)

        Dim controller = filterContext.RouteData.Values("controller").ToString
        Dim action = filterContext.RouteData.Values("action").ToString

        If (action.ToLower = "enterclaim" OrElse action.ToLower = "changeclaim") Then
            Return
        Else
            Dim claimNumber As String = String.Empty
            Dim workerID As Decimal

            If (Session("ClaimNumber") IsNot Nothing) Then
                claimNumber = Session("ClaimNumber").ToString
            End If

            If (Session("WorkerID") IsNot Nothing) Then
                workerID = CDec(Session("WorkerID"))
            End If

            If (String.IsNullOrEmpty(claimNumber)) Then
                If (workerID = 0) Then
                    If (Manager.IsExternalUser) Then
                        workerID = Manager.GetWorkerIdByDomainUser
                        claimNumber = Manager.GetMostRecentClaimNumber(workerID)
                    Else
                        filterContext.Result = New RedirectResult("/MyClaim/Home/EnterClaim")
                    End If
                End If
            End If

            Manager.SetClaimNumber(claimNumber)

        End If

    End Sub

    Public Function SendMessage(<Bind(prefix:="SendMessage")> model As IWSendMessageViewModel) As ActionResult
        Manager.SendAdjusterEmail(model.AdjusterEmail, model.PersonEmail, "IW Contact Message", model.Message, model.SendCopyToSender)
        Return Json(New With {.message = "Success"}, "application/json")
    End Function

End Class

End Namespace 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T15:30:27.130

对于控制器动作来说，这绝对是太多了。诸如此类的东西`If (Not securityToken.ConflictAccess)`应该进入一个自定义`Authorize`属性，你的控制器操作应该用它来装饰。`ModelState.AddModelError("ClaimNumber", "Invalid claim number.")`诸如进入自定义验证属性之类的事情，或者如果您在模型的 FV 验证器中使用[FluentValidation.NET](http://fluentvalidation.codeplex.com/)（我强烈建议您这样做）。

像这样的事情：

```
If (model.URL.Contains("ChangeClaim") OrElse model.URL.Contains("EnterClaim")) Then
    model.URL = Url.Action("Index", "Home")
End If 
```

可以进入您将返回的自定义操作结果。

就视图中的条件逻辑而言，没问题。您可以使用视图模型属性来显示/隐藏某些 UI 元素。显然，适当的授权（通过自定义 Authorize 属性）应该在相应的控制器操作中完成，因为您隐藏了用户的链接这一事实并不意味着恶意用户无法伪造请求并且仍然能够调用您的控制器行动。

# java - 使用 Apache POI 可以阻止用户复制格式吗？

> ID：11672596
> 
> 赞同：3
> 
> 时间：2012-07-26T15:21:59.720
> 
> 标签：java, excel, validation, apache-poi

我制作了一个由 Java 生成的 excel 表。单元格只能接受某些值，具体取决于针对单独工作表上的列表进行的数据验证。

这一切都很好，但是如果用户从另一个单元格复制一些值并将其粘贴到单元格中，它会避免验证......有什么办法可以防止这种情况发生吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T05:16:48.480

您可以通过为该单元格设置数据格式来做到这一点。

```
style = wb.createCellStyle();
style.setDataFormat(wb.createDataFormat().getFormat("0.000%")); 
```

这将是百分比值。文档转到： [Apache HSSF Doc](http://poi.apache.org/apidocs/org/apache/poi/hssf/usermodel/HSSFCellStyle.html#setDataFormat%28short%29)

# jquery - 如何淡化整个 html 页面而不是一个 div？

> ID：11672597
> 
> 赞同：0
> 
> 时间：2012-07-26T15:22:04.880
> 
> 标签：jquery, html

当我使用代码单击按钮时，我试图使页面淡出：

```
$("#post_btn").click(function(){
  $("#address-popup").css({display: "block"});
  $("html,body").fadeTo("slow",0.4);
}); 
```

问题是我不希望 div`#address-popup`也消失。有没有办法可以将其排除在`html,body`褪色之外？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-26T15:24:43.267

不，你不能。您不能淡化整个文档，但不能淡化文档中的某些元素。

你以错误的方式解决这个问题。看起来使背景变暗的弹出窗口通常会附加一个半透明的覆盖 div，对话框位于其顶部。是覆盖 div 部分遮住了页面；页面本身实际上并没有淡出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T15:42:16.923

我在这里测试了一个解决方案并且它有效......

```
$("#post_btn").click(function(){
  $("body :not(#address-popup)").fadeTo("slow",0.4);
}); 
```

它工作得很好......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T15:28:58.713

您不能有隐藏父级的可见子级。您需要将弹出窗口附加到您的 body 元素，然后淡出 body 内的所有其他元素。

**HTML：**

```
<body>
   <div class="header">
   </div>
   <div class="content">
   </div>
   <div class="footer">
   </div>
   <div class="popup">
   </div>
</body 
```

**JS：**

```
$("#post_btn").click(function(){
   $("body > div:not(.popup)").fadeTo("slow",0.4);
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-19T17:00:14.053

HTML

```
<div class="blind"></div>
<div class="topDiv">
<h1>Popup Effect DIV</h1>
<p>This DIV will still display when the rest of the page has been faded out</p>
</div>
<a class="fadeOut">Load Popup.</a> 
```

CSS

```
.blind {
    position: absolute;
    top: 0px;
    left: 0px;
    background-color: #FFF;
    width: 100%;
    height: 100%;
    z-index: 2000;
    opacity: 0.9;
    filter: alpha( opacity = 90 );
    display: none;
}
.topDiv {
    display: none;
    width: 250px; 
    height: 250px;
    border: solid 1px red;
    background-color: #FFF;
    z-index: 2000;
    position: absolute;
    top: 50px;
    left: 250px;
} 
```

JS

```
/* Load Popup and fade background */
$('.fadeOut').click(function(e){
    $('.blind').toggle();
    $('.topDiv').toggle();
});
/* Close popup and loose fade when you click outside the popup */
$(document).mouseup(function (e){
    var container = $('.topDiv');
    if (!container.is(e.target) && container.has(e.target).length === 0){
        container.hide();
        $('.blind').hide();
    }
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-26T15:28:14.187

我认为你最好通过覆盖 a`<div>`并赋予它透明度来创造褪色背景的“幻觉”。给这个`<div>`比`z-index`页面内容的其余部分更高的值。

然后，为了增强您的其他 div 坐在褪色页面上方的错觉`#address-popup`，只需确保它的 div 甚至高于`z-indez`transparent `<div>`。

# android - 在 Android 2.x 中获取 ActionBarSherlock actionBarSize

> ID：11672599
> 
> 赞同：9
> 
> 时间：2012-07-26T15:22:09.757
> 
> 标签：android, size, actionbarsherlock

我正在使用 ActionBarSherlock，这个 XML 行在 Android 2.x 中崩溃：

```
android:layout_height="?android:attr/actionBarSize" 
```

有没有办法获得 ABS 的 ActionBarSize？可能是这样的：

```
?android:attr/actionBarSherlockSize 
```

谢谢

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-07-26T16:24:23.487

使用`?attr/actionBarSize`which 将适用于所有 API 级别。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-26T16:24:23.190

这成功了：

```
android:layout_height="@dimen/abs__action_bar_default_height" 
```

# javascript - FullCalendar - 在 cookie 中保存事件

> ID：11672601
> 
> 赞同：2
> 
> 时间：2012-07-26T15:22:13.933
> 
> 标签：javascript, fullcalendar, jquery-cookie

我正在尝试使用外部拖动功能创建一个 FullCalendar，您可以在其中将添加到日历中的事件保存在 cookie 中（我更愿意将其保存在服务器上，但这不是一个选项）。我正在使用 jquery cookie 插件来使其更容易。

到目前为止，我所拥有的是保存功能（我相信它正在工作）：

> ```
> function save() {
>     var eventsFromCalendar = $('#calendar').fullCalendar( 'clientEvents');
>     $.cookie("DSCalendar", eventsFromCalendar, {expires: 1});
> } 
> ```

...但是当我下次打开它时，我无法让日历包含它。我试过这样做，但它似乎根本不起作用：

```
$(document).ready(function() {
     ....

        var savedEvents = $.cookie("DSCalendar");
        $('#calendar').fullCalendar({

            header: {
                left: 'prev,next today',
                center: 'title',
                right: 'month,agendaWeek,agendaDay'
            },
            events: savedEvents,
             ........... 
```

有没有人以前做过这个，或者知道如何在不使用服务器的情况下保存事件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T16:33:38.677

我认为 cookie 插件不能存储复杂的对象数组。这就是为什么我建议使用`JSON.stringify`. 但是，返回的 Object 数组`.fullCalendar('clientEvents')`包含递归 Object 引用 - 因此甚至`JSON.stringify`无法成功转换它。

看看这个小提琴：http: [//jsfiddle.net/100thGear/v6tSd/](http://jsfiddle.net/100thGear/v6tSd/)

我创建了一个临时对象数组，然后将其存储在 cookie 中，然后`JSON.stringify`完美`JSON.parse`运行。

让我知道这是否有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-09T04:26:16.543

在 FullCalendar v1 中，如果您要远程加载数据，clientEvents 的内容包括每个事件的称为“源”的键-对象对。该对包含远程数据的 URL，如果您尝试将 clientEvents 字符串化以将其保存或发送到需要字符串而不是对象数组的位置，则会返回错误“将循环结构转换为 JSON”。我使用的解决方法是使用以下脚本删除“源”键和对象：

```
var eventsFromCalendar = $('#calendar').fullCalendar('clientEvents');
for (var i = 0; i < eventsFromCalendar.length; i++) {
    delete eventsFromCalendar[i].source
    }
var jstrng = JSON.stringify(eventsFromCalendar); 
```

# c# - 使用线程池进行多线程

> ID：11672605
> 
> 赞同：-1
> 
> 时间：2012-07-26T15:22:18.473
> 
> 标签：c#, multithreading, c#-4.0, taskfactory

我有以下代码：

```
 private static void SplitTilesRecursive(Image original, int level)
    {
        int mapWidth = GetMapWidth(level);
        int tilesOnSide = mapWidth/TileSize;

        using (Image resized = ResizeImage(original, new Size(mapWidth, mapWidth)))
        {
            for (int x = 0; x < tilesOnSide; x++)
                for (int y = 0; y < tilesOnSide; y++)
                {
                    CropAndSaveTile(resized, x, y, level);
                }
        }

        if (level > 0)
            SplitTilesRecursive(original, level - 1);
    }

    private static void CropAndSaveTile(Image image, int x, int y, int level)
    {
        var info = (CropInfo) o;
        var cropArea = new Rectangle(x * TileSize, y * TileSize, TileSize, TileSize);

        using (var bmpImage = new Bitmap(image))
        using (Bitmap bmpCrop = bmpImage.Clone(cropArea, bmpImage.PixelFormat))
        {
            string filename = String.Format(TileFilename, level, x, y);

            // the Portable Network Graphics (PNG) encoder is used implicitly
            bmpCrop.Save(Path.Combine(OutputDir, filename));
            Console.WriteLine("Processed " + filename);
        }
    } 
```

该方法`CropAndSaveTile`需要一段时间，所以我想使用线程池将该任务拆分到一个新线程。我尝试使用[`Task.Factory.StartNew`](http://msdn.microsoft.com/en-us/library/dd321456). 问题是我需要将这 4 个参数传递给线程，所以我必须创建一个可以强制转换为对象的类。

```
 private class CropInfo
    {
        public CropInfo(Image image, int x, int y, int level)
        {
            Image = image;
            X = x;
            Y = y;
            Level = level;
        }

        public Image Image { get; set; }
        public int X { get; set; }
        public int Y { get; set; }
        public int Level { get; set; }
    }

    private static void SplitTilesRecursive(Image original, int level)
    {
        // ...
        using (Image resized = ResizeImage(original, new Size(mapWidth, mapWidth)))
        {
            for (int x = 0; x < tilesOnSide; x++)
                for (int y = 0; y < tilesOnSide; y++)
                {
                    Task.Factory.StartNew(CropAndSaveTile, new CropInfo(resized, x, y, level));
                }
        }
        // ...
    }

    private static void CropAndSaveTile(object o)
    {
        var info = (CropInfo) o;
        // ...
    } 
```

这几乎可以工作。问题是`new Bitmap(info.Image)`抛出一个`ArgumentException`（参数无效）。我已经对此进行了测试，但没有使用`Task.Factory.StartNew`，而是直接使用调用该方法`CropAndSaveTile(new CropInfo(resized, x, y, level));`，它工作正常。和之间发生了一些事情 `StartNew`，线程运行。这可能是由何时`SplitTilesRecursive`结束循环并被`resized`处理掉的同步问题吗？如果没有，我怎样才能正确地将多个参数传递给一个线程以用作线程池的一部分？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T15:24:49.070

为什么你必须创建一个类？你可以这样做：

```
Task.Factory.StartNew(()=>CropandSaveTile(resized, y, y,  level)); 
```

该语言将在幕后为您创建一个类作为“闭包”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T15:54:13.227

尝试在循环内部`x`使用本地副本：`y`

```
for (int x = 0; x < tilesOnSide; x++)
    for (int y = 0; y < tilesOnSide; y++)
    {
        int x1 = x;
        int y1 = y;
        Task.Factory.StartNew(() => CropAndSaveTile(resized, x1, y1, level));
    } 
```

这保证了每个 lambda 看到一对单独的`x`和`y`值。

# windows - MFC：是否可以在运行时修改对话框样式？别针

> ID：11672606
> 
> 赞同：1
> 
> 时间：2012-07-26T15:22:23.913
> 
> 标签：windows, winapi, mfc

我创建了一个对话框模板资源，在对话框编辑器中设置了 WS_POPUP 属性。

可以使用模板资源生成模态对话框。

这是我的问题：我想将其样式从 WS_POPUP 更改为 WS_CHILD，因为我想在属性页（CPropertySheet）中生成对话框。

我尝试了很多方法。使用 ModifyStyle 或 SetWindowLong 更改 OnInitDialog、OnCreate、PreCreateWindow、PreSubclassWindow 中的对话框不起作用。

现在我想知道是否可以使用相同的资源生成对话框并修改样式。

此外，[http://www.codeproject.com/Articles/13133/Modifying-a-modal-dialog-s-style-and-position-at-r](http://www.codeproject.com/Articles/13133/Modifying-a-modal-dialog-s-style-and-position-at-r)中的方法列表也不起作用。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-24T11:44:40.347

我认为如果将对话框模板设置为 WS_CHILD，它既可以用作子对话框，也可以用作弹出对话框。

# .net - 防止 .msi 文件被 chrome 阻塞

> ID：11672607
> 
> 赞同：3
> 
> 时间：2012-07-26T15:22:26.153
> 
> 标签：.net, google-chrome, windows-installer, installation

我的网络服务器 (www.example.com/example.msi) 中有一个 .msi 文件（在 .Net 中开发的应用程序设置），我希望我的客户从他们的浏览器下载它。如果他们使用 chrome，下载后的 .msi 会被阻止。

防止这种阻塞的解决方案是什么？如果我使用 https 并通过安全连接分发文件，我会通过这个问题吗？

谢谢

# android - 在 C 中创建指向 Java 函数的函数指针

> ID：11672614
> 
> 赞同：0
> 
> 时间：2012-07-26T15:22:56.117
> 
> 标签：android, android-ndk, function-pointers, function-parameter

我正在为 Android 重新编写一个 Palm Pilot 程序，并且遇到了麻烦。我缺乏 C 经验让我完全无所适从。这是原始的 C 代码：

`.h`文件：

```
typedef void (__stdcall *fp_setbaud)(WORD);
typedef short (__stdcall *fp_get)(WORD);
typedef void (__stdcall *fp_put)(BYTE);
typedef void (__stdcall *fp_flush)(void);
typedef void (__stdcall *fp_delay)(WORD);
//typedef void (__stdcall *fp_err)(WORD);
typedef short (__stdcall *fp_ProgressUpdate)(WORD); 
```

`.c`文件：

```
fp_setbaud RelayAPI_SetBaud;
fp_get RelayAPI_get;
fp_put RelayAPI_put;
fp_flush RelayAPI_flush;
fp_delay RelayAPI_delay;
fp_ProgressUpdate RelayAPI_ProgressUpdateTX;
fp_ProgressUpdate RelayAPI_ProgressUpdateRX;

BYTE __stdcall InitRelay(fp_setbaud _setbaud, fp_get _get, fp_put _put, fp_flush _flush, fp_delay _delay){

    RelayAPI_SetBaud=_setbaud;
    RelayAPI_get=_get;
    RelayAPI_put=_put;
    RelayAPI_flush=_flush;
    RelayAPI_delay=_delay;
    RelayAPI_ProgressUpdateTX=0;
    RelayAPI_ProgressUpdateRX=0;
    ...
} 
```

然后在代码的后面，这些函数调用如下：

```
if(baud9600) RelayAPI_SetBaud(9600);
else RelayAPI_SetBaud(1200); 
```

在`old C`文件的主要方法中`InitRelay`是这样调用的......

```
InitRelay(Changeit,getit,putit,flushit,delayit); 
```

这五个参数都是在该主文件中声明的函数。

我想`InitRelay`从我的 Java 代码中调用，但它传递的所有这些函数都处理 Palm Pilot 功能。我已经为 Android 应用程序用 Java 重写了它们，并希望使用它们。所以，这就是我所做的......

```
jmethodID changeID;
jmethodID getID;
jmethodID putID;
jmethodID flushID;
jmethodID delayID;
// These two below are COMPLETELY wrong.
jmethodID RelayAPI_ProgressUpdateTX;
jmethodID RelayAPI_ProgressUpdateRX;
jclass    bluetoothClass;

BYTE __stdcall InitRelayJava( JNIEnv *env, jobject obj  ) {

bluetoothClass = (*env)->GetObjectClass( env, obj );

    changeID = (*env)->GetMethodID( env, bluetoothClass, "changeitJava", "(I)Z"  );
    getID    = (*env)->GetMethodID( env, bluetoothClass, "getitJava"   , "()V"   );
    putID    = (*env)->GetMethodID( env, bluetoothClass, "putitJava"   , "([B)V" );
    flushID  = (*env)->GetMethodID( env, bluetoothClass, "flushitJava" , "()V"   );
    delayID  = (*env)->GetMethodID( env, bluetoothClass, "delayitJava" , "(I)V"  );

    RelayAPI_SetBaud= env->CallBooleanMethod( bluetoothClass, changeID , int rate    );
    RelayAPI_get    = env->CallVoidMethod   ( bluetoothClass, getID                  );
    RelayAPI_put    = env->CallVoidMethod   ( bluetoothClass, putID    , byte[] buff );
    RelayAPI_flush  = env->CallVoidMethod   ( bluetoothClass, flushID                );
    RelayAPI_delay  = env->CallVoidMethod   ( bluetoothClass, delayID                );
    RelayAPI_ProgressUpdateTX=0;
    RelayAPI_ProgressUpdateRX=0;
    ....
} 
```

我所做的有两个问题：1）在程序的 Android 版本中没有声明 RelayAPI_* 成员，因为我不知道命名它们的正确类型。2) 当我在 Android 版本中实际定义 RelayAPI_* 成员时，这根本不是我想要做的。这些`env->CallXXXMethod`调用实际上是在调用这些方法（我知道以一种不正确的方式，它写出来供您可视化）。我需要将这些成员设置为等于这些函数调用的 POINTERS。

如果有人知道我可以为这两个问题做些什么，请告诉我。如果我做错了，我也会很感激这些信息。这是我一直在使用的一些教程，但没有看到与我遇到的问题有关的任何内容。

[教程 1](http://docs.oracle.com/javase/1.4.2/docs/guide/jni/spec/design.html#wp16696)

[教程 2](http://www.codeproject.com/Articles/22881/How-to-Call-Java-Functions-from-C-Using-JNI)

[教程 3](http://journals.ecs.soton.ac.uk/java/tutorial/native1.1/implementing/method.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:35:37.807

像这样的东西怎么样：

```
typedef void (*fp_setbaud)(WORD);

void WrapSetBaud(WORD w) {
    env->CallBooleanMethod( bluetoothClass ...
}

fp_setbaud RelayAPI_SetBaud = WrapSetBaud; 
```

等等。你得到我希望的照片。您必须将 env 全局保存在某个地方，以便包装器访问它。

# java - 变量在被视为“一次性”之前必须有多“临时”？

> ID：11672618
> 
> 赞同：1
> 
> 时间：2012-07-26T15:23:00.873
> 
> 标签：java, coding-style

[Wikipedia 上](http://en.wikipedia.org/wiki/Naming_convention_%28programming%29#Java)的“命名约定”页面包含 Java 约定下的以下声明：

> 应避免使用单字符变量名称，临时“一次性”变量除外。

在成为单字符名称的可接受候选者之前，变量需要有多“临时”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:24:20.637

显然，这将基于意见，但这里有一些注意事项。

for 循环中的索引或其他需要索引的东西。小范围很重要。除了 for 循环，我还编写了代码来完成 SQL 语句，例如

```
int idx = 0;
ps.addInt(idx++, userId);
ps.addString(idx++, userName);
ps.addString(idx++, userEmail); 
```

但即使在那种情况下，我也觉得`idx`比`i`. 作为维护者，`idx`告诉我作者的真正意思是索引。 `i`告诉我作者可能指的是索引，或者可能不擅长命名变量，我必须多阅读代码才能消除歧义。

当然，像这样的特性`foreach`已经解决了这样一个事实，即这是相当样板，并且该语言不应该需要一次性变量，我相信 C++11 现在支持。

请注意，单字母变量有一些愚蠢但相当相关的考虑，即`grep`难以查找、难以搜索和替换等。如果您从 IDE 开发，这不太重要，但如果您甚至有机会不会，那么这更重要。如果`grep`您使用`i`而不是`ii`.

所以这些考虑说，我坚定的意见是：

永远不要使用一个字母的名字。至少做两个。仅在所有使用该语言编写代码的开发人员都知道需要一次性使用的地方使用它们。我能想到的仅有的两个例子是`for`循环和`rc`用于 C 中的返回代码。在 Java 或 C++11 中，如果您发现自己使用了一个字母一次性，那么请更好地设计您的代码，因为有一些语言特性可以避免这种情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T16:05:37.490

我只在少数情况下使用单字母名称：

*   `x`和 等坐标`y`。
*   循环迭代使用`for`变量是块作用域并命名为`i`, `j`, `k`, ...
*   通用类型名称，例如`E`元素、`K`键、`V`值等。

在所有其他情况下，我使用更长的名称。随着时间的推移，我发现自己放弃了以前使用的较短的表格。我什至很少缩写了。我可以快速打字，而且真正的单词比缩写更容易输入。

*   `childCount`
*   `titleNormalizer`
*   `colorLoader`

这使得一年后我需要搜索用途和修改代码时变得容易得多。

# android - 在android中使用Wiengine将Sprite转换为Bitmap

> ID：11672619
> 
> 赞同：0
> 
> 时间：2012-07-26T15:23:06.637
> 
> 标签：android, game-engine

我正在使用适用于 Android 手机的 Wiengine 进行游戏开发。我想将精灵转换为位图。谁能让我知道如何实现此功能。我从 Zwoptex 表中获取精灵，我想使用该精灵设置纹理。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T06:23:44.940

没有直接的 api 可以做到这一点，但您可以制作屏幕截图来捕捉精灵矩形。但是，为什么需要此功能？

# lithium - 锂：Document->save() 或 Record->save() 如何工作

> ID：11672621
> 
> 赞同：0
> 
> 时间：2012-07-26T15:23:10.927
> 
> 标签：lithium

在锂中，文档和记录类，或者它们的超类/接口，没有 save() 方法。然而锂的保存记录方法如下：

```
$record = Model::create()
$record->save() 
```

我不确定这是如何工作的，因为记录没有保存方法（只有模型有）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T18:01:51.180

`Document`并`Record`从基`Entity`类扩展。该类`Entity`有一个`__call()` [神奇的方法](http://www.php.net/manual/en/language.oop5.overloading.php#object.call)。请参阅`Entity::__call`此处的 api 文档：http: [//li3.me/docs/lithium/data/Entity::__call()](http://li3.me/docs/lithium/data/Entity%3a%3a__call%28%29) 该方法获取与`Model`关联的类的实例，`Entity`然后调用传递实体对象的方法第一个论点。锂手册的[向模型添加功能](http://li3.me/docs/manual/working-with-data/adding-functions-to-models.wiki)部分也包含与此相关的附加信息。

# css - Css - 导航菜单 - 子菜单

> ID：11672622
> 
> 赞同：0
> 
> 时间：2012-07-26T15:23:11.607
> 
> 标签：css, menu, navigation, html-lists, nav

我目前正在开发一个网站，并且我正在尝试进行更多的 CSS 编码，我已经完成了导航的基本 CSS。虽然我现在要做的是制作子菜单，但是当您滚动其中一个按钮时，菜单就会出现。

这是我当前的 Css：HTML 代码：

```
/*Naviagtion Bar Css */
ul {
    margin: 0;
    padding: 0;
    list-style:none;
}
li {
padding-top:5px;
color: #FFF;
width:120px;
float: left;
margin: 0;
padding: 0;
}
li a {
    display: block;
    width: 120px;
    height: 30px;
    padding-top:20px;
}
#homepage a {
    background-image: url(../images/Button_NavBar_Unselected.png);
    background-repeat: no-repeat;
}
#homepage_current a {
    background-image: url(../images/Button_NavBar_CurrentPage.png);
    background-repeat: no-repeat;
}
#homepage a:hover {
    background-image: url(../images/Button_NavBar_Hover.png);
    background-repeat: no-repeat;
}

#guide a {
    background-image: url(../images/Button_NavBar_Unselected.png);
    background-repeat: no-repeat;
}
#guide_current a {
    background-image: url(../images/Button_NavBar_CurrentPage.png);
    background-repeat: no-repeat;
}
#guide a:hover {
    background-image: url(../images/Button_NavBar_Hover.png);
    background-repeat: no-repeat;
}

#blog a {
    background-image: url(../images/Button_NavBar_Unselected.png);
    background-repeat: no-repeat;
}
#blog_current a {
    background-image: url(../images/Button_NavBar_CurrentPage.png);
    background-repeat: no-repeat;
}
#blog a:hover {
    background-image: url(../images/Button_NavBar_Hover.png);
    background-repeat: no-repeat;
}

#media a {
    background-image: url(../images/Button_NavBar_Unselected.png);
    background-repeat: no-repeat;
}
#media_current a {
    background-image: url(../images/Button_NavBar_CurrentPage.png);
    background-repeat: no-repeat;
}
#media a:hover {
    background-image: url(../images/Button_NavBar_Hover.png);
    background-repeat: no-repeat;
}

#forum a {
    background-image: url(../images/Button_NavBar_Unselected.png);
    background-repeat: no-repeat;
}
#forum_current a {
    background-image: url(../images/Button_NavBar_CurrentPage.png);
    background-repeat: no-repeat;
}
#forum a:hover {
    background-image: url(../images/Button_NavBar_Hover.png);
    background-repeat: no-repeat;
}
#navbar {
    position:relative;
    top:5px;
    float:left;
    margin-top:30px;
    margin-left:45px;
    width:600px;
    height: 50px;
    z-index:-1;
} 
```

html代码：

```
<div id="navbar" style="display: inline-block;">
<ul>
   <li id="homepage_current"><a><strong>Home</strong></a></li>
   <li id="guide"><a><strong>Guide</strong></a>
      <ul>
         <li> Sub Menu 1 </li>
         <li> Sub Menu 2 </li>
         <li> Sub Menu 3 </li>
      </ul>
   </li>
   <li id="blog"><a><strong>Blog</strong></a></li>
   <li id="media"><a><strong>Media</strong></a></li>
   <li id="forum"><a><strong>Forums</strong></a></li>
</ul>
</div> 
```

任何帮助，将不胜感激。[这是](https://dl.dropbox.com/u/49665279/Arakion/index.html)该页面的链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:34:40.897

只要您没有任何具体问题，我建议您使用可能的教程之一。比如最有名的一个：**[Suckerfish](http://www.htmldog.com/articles/suckerfish/dropdowns/)**！这是一个完美的开始。
或者也许[这](http://cssmenumaker.com/drop-down-css-menus)也可以帮助你。

最后，这是一个关于如何创建漂亮的[CSS3-Dropdown](http://webdesignerwall.com/tutorials/css3-dropdown-menu)的教程。

在 Stackoverflow 上也多次讨论了 CSS-Dropdown 菜单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T15:32:49.457

这样做的方法，首先，你必须像这样设置父元素相对

```
#navbar>ul>li{position:relative;} 
```

然后将子元素设置在父元素之下（并使其隐藏）（20 px 是任意的）

```
#navbar>ul>li>ul{position:absolute;top:20px;left:0px; display:none;} 
```

然后使子菜单在悬停时可见

```
#navbar>ul>li:hover>ul{display:block;} 
```

另外，我建议将 li 的当前样式更改为#navbar>ul>li，因为 li css 也会影响所有子菜单

~~并且要注意 > 操作符，很多旧的导航~~器 IE6 和 IE5都不支持它，如果这很重要，请使用：

```
<li id="guide" class="lvl1"><a><strong>Guide</strong></a> 
```

和风格：

```
li.lvl1{... 
```

# flash - ActionScript 3：编译器或 sdk 版本的条件编译？

> ID：11672625
> 
> 赞同：0
> 
> 时间：2012-07-26T15:23:16.663
> 
> 标签：flash, apache-flex, actionscript

Flex 编译器是否传递了条件编译可以访问的版本号？我面临的问题是我有一些可用于 SDK 10 或 11 的通用代码，它使用 JSON。我希望能够不强制 11 个用户使用外部 JSON 库，因为 JSON 功能在 11 SDK 中。

我意识到我可以设置自己的编译器参数，但我想尽可能避免这种情况，因此共享代码的用户不需要记住设置此参数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T09:54:25.617

不，没有这样的事情，不幸的是。但是，您可能会认为 version 是在所有框架组件上声明的静态变量（它会改为运行时检查）。

# regex - Apex中带有逗号分隔数字的正则表达式

> ID：11672627
> 
> 赞同：2
> 
> 时间：2012-07-26T15:23:21.673
> 
> 标签：regex, oracle-apex

作为前言，我意识到还有其他关于用逗号分隔数字的正则表达式的主题，但是当我尝试使用这些解决方案时，它们不起作用。

基本上，我正在尝试创建一个正则表达式来识别逗号分隔的数字（在这种情况下没有空格）。在尝试将其转换为实际的正则表达式语法之前，我意识到它可能应该像这样工作，其中 'd' 是一个数字，',' 是一个逗号，而 '+' 是一个 kleene plus：

```
((d+),)*(d+) 
```

或者

```
(d+)(,(d+))* 
```

这是我在 Apex 验证中使用的代码，以确保某个字段是由逗号分隔的数字列表，不带空格（注意：我尝试了几种变体但无济于事，但只会发布一个）：

```
(\d+,)*(\d+) 
```

出于某种原因，这不起作用，但它似乎是任何数字 1 次或更多次后跟单个逗号的正确语法，并且整个表达式可以重复 0 次或更多次，并且整个重复表达式应该始终是后跟至少 1 位数字。

这个表达式在实践中确实可以识别所有接受的形式（例如：100 或 100,200 等），但由于某种原因，它也接受类似的答案

```
'100,200,' 
```

或者

```
'100,200,,' 
```

或者

```
'100,,200' 
```

我很困惑为什么这不会像以前给出的解决方案那样有效，这些解决方案似乎和我做的一样。提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T15:52:55.857

就是这样：

```
^(\d+,)*\d+$ 
```

锚点`^$`会有所不同，因为它们会强制整个字符串（不仅仅是一部分）与模式匹配

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T15:28:07.047

你应该尝试这样的模式：

```
^(?:(\d+),)+(\d)+$ 
```

# xcode - Xcode 4.3 与 Eclipse、CUDA、问题？

> ID：11672628
> 
> 赞同：0
> 
> 时间：2012-07-26T15:23:22.347
> 
> 标签：xcode, eclipse, macos, cuda

我了解安装 XCode4.3 后 /Developer 文件夹不再存在。对我来说，这似乎会产生不好的后果。首先，CUDA 安装到 /Developer/GPU_Computing。其次，GCC 钥匙串会发生什么？Eclipse 依赖于 GCC 钥匙串命令行工具，有人告诉我这些工具在 Xcode 4.3 中消失了。

有人可以阐明他们是否处理过这些问题中的任何一个吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T19:31:22.853

Xcode 4.3 改变了很多。从 4.3 版本开始，XCode 成为标准的 Mac OS X 应用程序（它驻留在应用程序文件夹中），因此您可以尝试将 GPU_Computing 移动到 XCode 的新根文件夹下。但是我认为更新版本的 CUDA SDK 添加了对新 Xcode 文件夹结构的支持。

XCode 和 Apple 正在转向新的[LLVM](http://llvm.org/)编译器，所以 GCC 目前仍然支持，但它将在下一个版本中消失，所以你应该尽快迁移到 LLVM...

您仍然可以使用 GCC 和 eclipse 安装[命令行开发工具包](http://rys.sommefeldt.com/2012/02/22/OS-X-command-line-tools.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T17:46:53.363

您必须安装命令行工具包。

运行 Xcode，打开 Wcode->Preferences...，然后在“下载”屏幕上的“组件”选项卡上选择“命令行工具”。

我可以在安装了该软件包的情况下构建和运行 CUDA Toolkit 示例。

# java - 在Java中绘制类层次结构的过程？

> ID：11672633
> 
> 赞同：0
> 
> 时间：2012-07-26T15:23:39.413
> 
> 标签：java, uml

实际上，我对 Java 中的类和接口的数量完全感到困惑，为了便于理解，我们有什么方法可以用图表格式表示类吗？正如我所提到的java API。它只显示具有接口的类，而没有清楚地呈现不同类和接口之间的关系。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T17:16:00.093

推荐的 Eclipse 插件的链接讨论很好，但我还要添加一个我没有看到的内容。为此，我使用了[UML Graph 。](http://www.umlgraph.org/)它根据您的代码生成 UML 图，并将它们插入到 JavaDoc 中。

# tridion - 如果未单击页面上的“保存并关闭”，如何恢复文本文件中的更改？

> ID：11672644
> 
> 赞同：1
> 
> 时间：2012-07-26T15:24:21.087
> 
> 标签：tridion, tridion-2011

我使用这个java脚本将页面id组件id和模板id作为查询字符串传递给aspx页面：

```
var masterTabControl = $controls.getControl($("#MasterTabControl"),
                                            "Tridion.Controls.TabControl");
p.compPresTab = masterTabControl.getPage("ComponentPresentationsTab");
p.selectedComponentPresentation = p.compPresTab.getSelectedComponentPresentation();

p.selectedComp = p.selectedComponentPresentation.getComponentId();

window.open("http://" + location.hostname + ":path/test.aspx?pgId=" + pageId + 
            "&comId=" + p.selectedComponentPresentation.getComponentId() + 
            "&comTmpId=" + 
            p.selectedComponentPresentation.getComponentTemplateId(), 
            "myWindow", "status = 1, 
            toolbar=no,width=300,height=200,resizable=no,scrollbars=yes"); 
```

现在在 test.aspx 页面上，我正在读取 id 并使用来自用户的一些附加信息将其保存到文本文件中。

在按钮上单击弹出 test.aspx 页面，我将其保存在文本文件中：

```
sLogDetails = PageId + "| " + ComponentId + "|" + ComponentTemplateId + 
              "|" + text ;

//Move the contents to the temp file other than the existing one.
using (var sr = new StreamReader(permanentFile))
{
    using (var sw = new StreamWriter(@"" + tempFile , true))
    {
        string line;

        while ((line = sr.ReadLine()) != null)
        {
            string[] parts = line.Split('|');
            PageId = parts[0].Trim();
            ComponentId = parts[1].Trim();
            ComponentTemplateId = parts[2].Trim();

            //Check there exist same record already 
            if (SPageId != PageId.Trim() || SComponentId != ComponentId.Trim() 
                || SComponentTemplateId != ComponentTemplateId.Trim())
                sw.WriteLine(line);
        }

        //Delete the Permanent file & create permanent file from temporary file
        File.Delete(permanentFile);
        File.Move(tempFile, permanentFile);

        // Insert changes to the Permanent file
        using (StreamWriter w = File.AppendText(permanentFile))
        {
            // Close the writer and underlying file.
            w.WriteLine(sLogDetails);
            w.Flush();
            w.Close();
        } 
```

如果 id 已经存在于文本文件中，那么我将其填充到 popup test.aspx 页面上的文本字段中，例如：

```
using (StreamReader r = File.OpenText(strPath + "Log.txt"))
{
    string line;

    while ((line = r.ReadLine()) != null)
    {
        // Console.WriteLine(line);
        string[] parts = line.Split('|');
        PageId=parts[0].Trim();
        ComponentId = parts[1].Trim();
        ComponentTemplateId = parts[2].Trim();

        //If there exist a record populate the data fields
       if (SPageId == PageId.Trim() && SComponentId == ComponentId.Trim() 
           && SComponentTemplateId == ComponentTemplateId.Trim())
        {
            txtRuleName.Text = (string)parts[3];
        }

    }
    r.Close();
} 
```

现在我被困在这里。当它填充在文本字段中时，用户可以在弹出的 test.aspx 页面中编辑文本区域，单击“确定”将保存在文本文件中。如果用户在没有“保存并关闭”的情况下关闭页面窗口，那么他在文本字段中所做的更改不应保存在文本文件中。它应该恢复到旧的。

知道我该怎么做吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T16:43:53.577

对“没有发生的事情”做出回应是相当困难的。

那么有什么方法可以创建用户可以退出该窗口的其他方式的列表？使用该列表，您可以注册相关的事件处理程序（或覆盖相关命令）并在那里实现您的回滚。

或者，您可以考虑从弹出窗口中对临时位置的文件进行更改。然后仅在用户单击保存并关闭时将其提交到您的文本文件。

* * *

请注意，当您横向扩展 Tridion GUI 和 Content Manager 以在多台机器上运行时，他的基于文件的方法将开始失败。一般来说，当您在使用企业级软件时，您应该警惕将内容存储在服务器上的文件中。现在什么是单服务器（并且在您的开发环境中将始终是单服务器）将在将来的某个时候变成多个服务器，届时您的解决方案将导致问题。

# iphone - CoreData 会自动实现内存警告吗？

> ID：11672646
> 
> 赞同：0
> 
> 时间：2012-07-26T15:24:27.987
> 
> 标签：iphone, objective-c, ios, cocoa, core-data

[除其他外， CoreData](http://developer.apple.com/library/mac/#documentation/cocoa/Conceptual/CoreData/cdProgrammingGuide.html#//apple_ref/doc/uid/TP30001200-SW1)旨在保持应用程序内存占用较低。

但是我找不到任何有关天气的信息，或者它没有执行`didReceiveMemoryWarning`通知。

我认为它会丢弃它的缓存，因为这将是明智的做法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:28:16.827

Core Data 做了一些概念上类似的事情，称为故障，它限制了图中在任何给定时间有多少对象在内存中。我会在这里阅读它[https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreData/Articles/cdFaultingUniquing.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreData/Articles/cdFaultingUniquing.html)

# android - 我想把一个活动分成几个类。是否可以？

> ID：11672648
> 
> 赞同：1
> 
> 时间：2012-07-26T15:24:35.257
> 
> 标签：android

我正在完成一个应用程序，问题是我有几个布局，所有代码都集中在一个 Activity 中。我有 5000 行代码，当我必须修复某些东西时，我很难找到我要找的东西。

由于我在 Android 开发中真的很新，我找不到将代码分成几个类的方法。有没有一种简单的方法将一个布局与一个活动分开？在清单中用相应的活动声明每个布局真的很烦人。

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T15:38:33.010

其实不是安卓。但是OOP（面向对象编程）的概念。

当然，您可以将一个 Activity 中的功能拆分为多个类。例如，如果你有 AsyncTask，你可以让它在 Activity 之外，如果你有从 DB 读取的 Adapter，你也可以让它在 Activity 之外。只需在需要时调用这些课程。以及任何其他通用功能，您也可以在 Activity 之外创建它，也许是在 Utility 类或其他东西中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T15:37:56.323

据我了解，您对单个 Activity 有多个布局？您可以查看[Fragments API](http://developer.android.com/guide/components/fragments.html)并将 Activity 划分为易于管理的 Fragment。至于 5,000 行代码，请尝试将其划分为具有静态访问权限的单独类，或者有什么方法可以使用数据对象？你真的不应该在一个类中有 5,000 行代码，把它分成不同的类。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T15:36:20.680

好吧，Android 的方式是使用活动来保存你的布局；这就是它们的用途。让您的程序尽可能面向对象是个好主意……这就是为什么……

1.  Java 是一种面向对象的编程语言。
2.  帮助您更轻松地理解、遵循和更改您的代码。
3.  使您的代码易于其他人遵循。
4.  确保应用程序的内聚性。

因此，让您的应用程序在功能上尽可能具有凝聚力是一个好主意。以后可以省去很多麻烦。

# java - WebDriver 启动几个驱动实例

> ID：11672649
> 
> 赞同：0
> 
> 时间：2012-07-26T15:24:36.377
> 
> 标签：java, webdriver, testng

我有 4 个 selenium 项目，它们同时使用 TestNG 从命令行开始。

4 个中的 3 个已成功启动，但其中 1 个出现“配置失败”错误并以**“org.openqa.selenium.WebDriverException：无法在 45000 毫秒内绑定到锁定端口 7054”**结束 - 在 driver.get(url)

有人可以建议我这次失败的原因是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T18:57:08.033

我以前遇到过这个问题。我将它隔离到 Firefox 并并行运行测试。我不记得我为消除问题所做的工作，但我相信我通过执行以下操作之一解决了它（从顶部开始，如果没有帮助，请移至下一项）。

(1) 尝试仅将 Firefox 的最大实例数限制为 1 或 2，如果这样可以解决您的问题，那么您不仅限于 Firefox。(2) 尝试回到一个或两代旧的 Firefox 版本。(3) 在您的集线器上（或在您的节点上）尝试将超时设置为 45，将 browserTimeout 设置为 60。

如果有机会，我会尝试查看我的设置，看看我是如何解决问题的。

# iphone - 自动释放池困境

> ID：11672653
> 
> 赞同：0
> 
> 时间：2012-07-26T15:24:50.810
> 
> 标签：iphone, objective-c, ios, ipad

所以我有一个关于自动释放池的问题。我创建了一个使用它如下：

```
dispatch_async(dispatch_get_main_queue(), ^{
            NSAutoreleasePool * pool = [[NSAutoreleasePool alloc] init];
            NSMutableAttributedString * attributedString = [NSMutableAttributedString attributedStringWithString:object.text];
            [attributedString setFont:[UIFont fontWithName:@"HelveticaNeue" size:15]];
            [self.titleLabel_ setAttributedString:attributedString];
            [self.titleLabel_ setLinkColor:self.textColor_];
            [self parseTagsInComment];
            [pool release];
        }); 
```

这是对自动释放池的错误使用，因为我已经有一个自动释放的对象吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T15:47:24.800

是的，这是正确的。如果它们的保留计数与您的情况一样，并且将被释放，那么其中的所有`autoreleased`对象都将在 因此从内存中刷新后`pool`收到`release`消息。`[pool release];`
`0``NSMutableAttributedString``UIFont`

# vim - 如果 NERDTree 和 TagList 是最后也是唯一的缓冲区，则自动退出 Vim

> ID：11672657
> 
> 赞同：2
> 
> 时间：2012-07-26T15:25:00.497
> 
> 标签：vim, nerdtree, taglist

基本上，我在启动 Vim 时`.vimrc`启动[TagList](http://vim-taglist.sourceforge.net)和 NERDTree，作为正常文件缓冲区的左侧和右侧的拆分。

我想在关闭最后一个缓冲区/选项卡时关闭 Vim，只剩下 TagList 和 NERDTree 拆分。我已经在使用[vim-nerdtree-tabs](https://github.com/jistr/vim-nerdtree-tabs)，当 NERDTree 是唯一也是最后一个打开的缓冲区时，它的效果很好。

我知道 StackOverflow 上已讨论过此类主题，但我找不到与 NERDTree 和 TagList 相关的任何内容。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2017-02-21T03:31:28.997

let Tlist_Exit_OnlyWindow = 1 将关闭 Tag_list 窗口，如果它是最后一个窗口，请查看[http://vim-taglist.sourceforge.net/manual.html](http://vim-taglist.sourceforge.net/manual.html)以获取有关 Tlist_Exit_OnlyWindow 的更多信息，我不确定您是否正在寻找这个，如果不，请删除我的答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T19:16:45.090

像......（未经测试）

```
fun! NoExcitingBuffersLeft()
   if tabpagenr("$") == 1 && winnr("$") == 2
      let window1 = bufname(winbufnr(1))
      let window2 = bufname(winbufnr(2))
      if (window1 == t:NERDTreeBufName || window1 == "__Tag_List__") &&
         (window2 == t:NERDTreeBufName || window2 == "__Tag_List__")
         quit
      endif
   endif
endfun 
```

然后将该功能绑定到自动命令...

```
au WinEnter * call NoExcitingBuffersLeft()<cr> 
```

我不使用这些插件中的任何一个，因此您可能需要调整`t:NERDTreeBufName`and `__Tag_List__`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-12T02:07:34.557

改进康纳的想法，我在这里做了一个功能性的解决方案。

```
" If only 2 windows left, NERDTree and Tag_List, close vim or current tab
fun! NoExcitingBuffersLeft()
  if winnr("$") == 3
    let w1 = bufname(winbufnr(1))
    let w2 = bufname(winbufnr(2))
    let w3 = bufname(winbufnr(3))
    if (exists(":NERDTree")) && (w1 == "__Tag_List__" || w2 == "__Tag_List__" || w3 == "__Tag_List__")
      if tabpagenr("$") == 1
        exec 'qa'
      else
        exec 'tabclose'
      endif
    endif
  endif
endfun
autocmd BufWinLeave * call NoExcitingBuffersLeft() 
```

BufWinLeave 事件需要 vim 7.0+。如果打开了多个选项卡，则关闭选项卡，否则退出 vim。这样，当您关闭不是 NERDTree 或 Tag_List 的最后一个窗口时，自动命令将绑定到，而不是在进入两个窗口之一时绑定。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-04-18T10:03:50.580

这是一个很好的可扩展解决方案。要针对其他插件/窗口类型进行验证，只需将它们添加到正则表达式检查。

```
function! s:CloseAddons()
    for w in range(1, winnr('$'))
        if bufname(winbufnr(w)) !~# '__Tagbar\|NERD_tree_\|coc-explorer'
                \ && getbufvar(winbufnr(w), "&buftype") !=? "quickfix"
            return
        endif
    endfor

    if tabpagenr('$') ==? 1
        execute 'quitall'
    else
        execute 'tabclose'
    endif
endfunction 
```

# asp.net-mvc-3 - 在 Razor 视图引擎中使用三元运算符进行 HTML 渲染

> ID：11672659
> 
> 赞同：3
> 
> 时间：2012-07-26T15:25:06.840
> 
> 标签：asp.net-mvc-3, razor

剃须刀指令如下图所示：

```
<td@(IsAdmin ? " class=editable name" : "") data-attr="name">it's true</td> 
```

结果是：

```
<td class="editable" data-attr="name" name="">it's true</td> 
```

虽然我需要这个：

```
<td class="editable name" data-attr="name">it's true</td> 
```

怎么做 ？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-26T15:40:21.353

这个怎么样：

```
<td @Html.Raw(IsAdmin ? " class=\"editable name\"" : "") data-attr="name">it's true</td> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T15:26:19.807

像这样：`@(IsAdmin ? " class=\"editable name\"" : "")`

# sql-server-2008 - SQL Server sp_help：如何限制输出窗口的数量

> ID：11672663
> 
> 赞同：0
> 
> 时间：2012-07-26T15:25:14.040
> 
> 标签：sql-server-2008, sp-help-operator

正常执行成功

sp_help [*对象名称*]

在 SQL Server 中，总共返回 7 个输出窗口，其中包含各种结果，通常我只对 2 个窗口感兴趣，即一个包含所有列信息的窗口和一个包含约束的窗口。

有没有办法告诉 SQLserver 在制定命令时只显示这些？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T19:28:33.990

简短回答：不，您不能直接执行此操作，因为编写过程是为了返回该数据，而 TSQL[没有](https://stackoverflow.com/questions/58940/access-to-result-sets-from-within-stored-procedures-transact-sql-sql-server)访问特定结果集的机制。

长答案：但您可以轻松地从其他程序或直接从[系统目录](http://msdn.microsoft.com/en-us/library/ms189783(v=sql.100).aspx)中获取相同的信息：

*   `sp_columns`, `sp_helpconstraint`（这实际上是由`sp_help`）等调用的。
*   `sys.columns`等`sys.objects`。

还可以选择复制源代码`sp_help`并将其用作您自己创建的新程序的基础，尽管我个人只是自己从头开始编写。如果您决定编写自己的存储过程，您可能会发现[这个问题](https://stackoverflow.com/questions/11155378/reference-stored-procedures-for-all-databases-in-server)也很相关。

# jquery - 将日期选择器绑定到动态生成的文本框

> ID：11672664
> 
> 赞同：0
> 
> 时间：2012-07-26T15:25:16.053
> 
> 标签：jquery, asp.net-mvc, jquery-ui, datepicker, asp.net-mvc-4

我在 foreach 中生成了几个文本框元素，如下所示：

```
@foreach(var thing in Model.Things)
{
    <tr>
        <td>@Html.TextBoxFor(m => thing.StartDate, new { id = "thingStartDate", @class = "thingDatePicker" })</td>
    </tr>
} 
```

我将 jQuery 日期选择器附加到每个文本框，如下所示：

```
$(document).ready(function(){
    $(".thingDatePicker").datepicker({ dateFormat: "mm/dd/yy" });
}); 
```

日期选择器在每个文本框的正确位置都正确触发。但是当我从其中任何一个中选择一个日期时，它只会填充第一个文本框。如何确保每个日期选择器都与其文本框牢固关联？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T16:24:28.780

您似乎对所有文本框 ( `id="thingStartDate"`) 使用相同的 id，这显然会导致 HTML 无效。所以要么删除 id 属性，要么确保你没有被骗。当您使用类选择器时，我可能会删除它，而这个 id 根本没有任何作用：

```
@foreach(var thing in Model.Things)
{
    <tr>
        <td>
            @Html.TextBoxFor(
                m => thing.StartDate, 
                new { @class = "thingDatePicker" }
            )
        </td>
    </tr>
} 
```

另外，我希望您意识到这`m => thing.StartDate`将为这些文本框生成不正确的名称。当您尝试绑定回您的视图模型时，它将使用`name="StartDate"`而不是可能会给您带来麻烦。`name="Things[xxx].StartDate"`为此，我建议删除`foreach`循环以支持编辑器/显示模板：

```
@Html.editorFor(x => x.Things) 
```

并在相应的编辑器模板 ( `~/Views/Shared/EditorTemplates/Thing.cshtml`)中

```
@model Thing
<tr>
    <td>
        @Html.TextBoxFor(
            x => x.StartDate, 
            new { @class = "thingDatePicker" }
        )
    </td>
</tr> 
```

# assembly - EQU 与 DC.B. 有什么区别？

> ID：11672666
> 
> 赞同：7
> 
> 时间：2012-07-26T15:25:16.847
> 
> 标签：assembly

我刚开始学习汇编语言。我遇到了 EQU 的概念。起初它很有意义，直到我到达 DC.B. DC.B 和 EQU 有什么区别？你不能只对每个常数使用 EQU 吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-26T15:45:31.773

我不熟悉您的特定汇编程序语法，所以这个答案是有根据的猜测。

EQU 指令用于告诉汇编器您希望有一个命名符号常量（通常从其他汇编器值计算，包括其他 EQU 定义），您可以在*汇编源文本*的其他位置引用该常量。你必须总是写

```
 symbolname EQU constantexpression 
```

这允许您在源文本的其他位置编写*符号名*而不是*常量表达式。*但是这个名称本身对最终组装的程序二进制数据没有直接影响。

“DC.B”（我假设“定义常量（字节）”用于告诉汇编器，您使用最终组装的程序在源文件中的相对位置嵌入一个字节的数据”。你写

```
optionalname DC.B  constantexpression 
```

将常量表达式的计算值放入汇编程序二进制数据中的数据字节中。

所以，你可以写

```
 AnEvenNumber  EQU    2
 MyEvenNumber  DC.B   AnEvenNumber 
```

第一行只产生一个命名常量，没有第二行，对你的二进制文件没有影响。第二行在您的二进制文件中生成一个字节，其中包含由命名符号常量指定的值。

请注意，DC.B 指令还允许使用可选名称；这个符号也可以用在你代码的其他地方。根据您的汇编程序的复杂程度，您可以定义

```
 LocationOfEvenNumber EQU  MyEvenNumber 
```

和

```
 DC.W    LocationOfEvenNumber 
```

现在在您的二进制文件中生成一个“指向”二进制数据字节的单词。

# html - Parse 和 Dreamweaver？

> ID：11672670
> 
> 赞同：0
> 
> 时间：2012-07-26T15:25:39.807
> 
> 标签：html, parsing

我正在考虑创建一个 HTML5 应用程序，我也想在 iOS 上运行良好。我正在考虑使用 parse.com 作为后端，但除此之外我有点不确定从哪里开始，我可以将 Adob​​e Dreamweaver 与 Parse 一起使用吗？创建 HTML5 应用程序有更好的选择吗？

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T19:35:58.543

通过查看 Parse 文档，没有任何特定工具可以帮助您在 DreamWeaver 中使用 Parse。

如果您正在寻找用于开发 HTML5 和 CSS3 的高质量 IDE，请参阅[这个关于开源 HTML5/CSS3 IDEs](https://stackoverflow.com/questions/4298439/opensource-free-html5-css3-javascript-ide)的问题。

Parse 有空白的 XCode（适用于 iOS）、空白的 Android 项目（应该在 Eclipse 中工作）和基本的 HTML5 项目，在他们的[快速入门指南](https://parse.com/apps/quickstart)中列出。使用空白 HTML5 项目，您可以使用任何想要进行编辑的 IDE，然后在浏览器中打开它进行测试。

# java - 启动 Hadoop 集群时出错

> ID：11672672
> 
> 赞同：2
> 
> 时间：2012-07-26T15:25:46.473
> 
> 标签：java, hadoop

```
chown: changing ownership of `/usr/local/hadoop/libexec/../logs': Operation not permitted
 starting namenode, logging to /usr/local/hadoop/libexec/../logs/hadoop-hadoop-namenode-ayush-PC.out
/usr/local/hadoop/bin/hadoop-daemon.sh: line 135:     /usr/local/hadoop/libexec/../logs/hadoop-hadoop-namenode-ayush-PC.out: Permission denied
head: cannot open `/usr/local/hadoop/libexec/../logs/hadoop-hadoop-namenode-ayush-    PC.out' for reading: No such file or directory
localhost: chown: changing ownership of `/usr/local/hadoop/libexec/../logs': Operation not permitted
localhost: starting datanode, logging to /usr/local/hadoop/libexec/../logs/hadoop-hadoop-datanode-ayush-PC.out
localhost: /usr/local/hadoop/bin/hadoop-daemon.sh: line 135:     /usr/local/hadoop/libexec/../logs/hadoop-hadoop-datanode-ayush-PC.out: Permission denied
localhost: head: cannot open `/usr/local/hadoop/libexec/../logs/hadoop-hadoop-datanode-  ayush-PC.out' for reading: No such file or directory
localhost: chown: changing ownership of `/usr/local/hadoop/libexec/../logs': Operation not permitted
 localhost: starting secondarynamenode, logging to /usr/local/hadoop/libexec/../logs/hadoop-hadoop-secondarynamenode-ayush-PC.out
 localhost: /usr/local/hadoop/bin/hadoop-daemon.sh: line 135: /usr/local/hadoop/libexec/../logs/hadoop-hadoop-secondarynamenode-ayush-PC.out: Permission denied
 localhost: head: cannot open `/usr/local/hadoop/libexec/../logs/hadoop-hadoop-secondarynamenode-ayush-PC.out' for reading: No such file or directory
chown: changing ownership of `/usr/local/hadoop/libexec/../logs': Operation not permitted
 starting jobtracker, logging to /usr/local/hadoop/libexec/../logs/hadoop-hadoop-jobtracker-ayush-PC.out
/usr/local/hadoop/bin/hadoop-daemon.sh: line 135: /usr/local/hadoop/libexec/../logs/hadoop-hadoop-jobtracker-ayush-PC.out: Permission denied
head: cannot open `/usr/local/hadoop/libexec/../logs/hadoop-hadoop-jobtracker-ayush-PC.out' for reading: No such file or directory
 localhost: chown: changing ownership of `/usr/local/hadoop/libexec/../logs': Operation not permitted
localhost: starting tasktracker, logging to /usr/local/hadoop/libexec/../logs/hadoop-hadoop-tasktracker-ayush-PC.out
localhost: /usr/local/hadoop/bin/hadoop-daemon.sh: line 135: /usr/local/hadoop/libexec/../logs/hadoop-hadoop-tasktracker-ayush-PC.out: Permission denied
localhost: head: cannot open `/usr/local/hadoop/libexec/../logs/hadoop-hadoop-tasktracker-ayush-PC.out' for reading: No such file or directory 
```

我收到此错误。我读过很多人收到此错误，但我无法找到解决方案。有人可以帮忙吗？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T22:57:12.060

做一个单独的用户 - `hduser`，总是推荐

```
- do chown -R 755 /usr/local/hadoop
- when creating tmp paths like /app/hadoop/tmp, apply the same settings as above 
```

希望这将解决问题。

问题与权限有关，与 hadoop 无关

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-08T12:59:33.503

以下是 2 条非常有用的建议：

1.  最好检查一下 .bashrc 文件中是否设置了 HADOOP_HOME 和 JAVA_HOME。有时，不设置这些环境变量也可能在启动 hadoop 集群时导致错误。

2.  通过查看 /usr/local/hadoop/logs 目录中生成的日志文件来调试错误也很有用。

# components - MULE 3.2 - 如何从 java 组件访问流会话属性值

> ID：11672673
> 
> 赞同：1
> 
> 时间：2012-07-26T15:25:50.077
> 
> 标签：components, message, esb, mule, transformer

这个问题与 Mule ESB 3.2 有关。

如果我从 JMS 读取值，转换为 JSON 并将值存储在我的会话中，如下所示：

```
<message-properties-transformer scope="session" doc:name="save values to session">            
        <add-message-property key="id" value="#[json-node://id]"/>
        <add-message-property key="name" value="#[json-node://name]"/>
</message-properties-transformer>   

<component class="org.mule.example.echo.Echo"/> 
```

如何从 Java 组件访问这些属性值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-18T15:49:40.047

如果属性是用 OutboundScope 添加的，那么简单

```
public void process(@Payload String payload, @OutboundHeaders Map headers ){
   String id =   headers.get("name") 
} 
```

将返回您的流量属性

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T19:30:47.757

首先，你的类必须实现`org.mule.api.lifecycle.Callable`接口。`onCall`然后你可以像这样在方法中获取属性值

```
@Override
public Object onCall(MuleEventContext eventContext) throws Exception {
   String id = eventContext.getMessage().getProperty("id", PropertyScope.SESSION);
   String name = eventContext.getMessage().getProperty("name", PropertyScope.SESSION);
   //Do the rest of your stuff
} 
```

# c# - 如何在 wp7 的 shell 磁贴上创建网页

> ID：11672674
> 
> 赞同：0
> 
> 时间：2012-07-26T15:25:50.237
> 
> 标签：c#, windows-phone-7

我为 wp7 创建了一个网络浏览器。以下是我在我的应用程序中使用的代码。但是会发生什么是图像是空白的（白色图像）**见下图**。有人可以帮我吗？谢谢你的帮助。

```
private void PinToStart_Click(object sender, EventArgs e)
    {
        string _url = UrlTextBox.Text;

        ShellTile TileToFind = ShellTile.ActiveTiles.FirstOrDefault(x => x.NavigationUri.ToString().Contains("url=" + _url));

        using (var store = IsolatedStorageFile.GetUserStoreForApplication())
        {
            var bmp = new WriteableBitmap(173, 173);
            var tt = new TranslateTransform();
            tt.X = 0;
            tt.Y = 0;
            bmp.Render(browsers[this.currentIndex], tt);
            bmp.Invalidate();
            var filename = "/Shared/ShellContent/01d.jpg";
            using (var st = new IsolatedStorageFileStream(filename, FileMode.OpenOrCreate, FileAccess.Write, store))
            {
                bmp.SaveJpeg(st, 173, 173, 0, 100);
            }
        }

        // Create the Tile if we didn't find that it already exists.
        if (TileToFind == null)
        {
            StandardTileData NewTileData = new StandardTileData
            {
                BackgroundImage = new System.Uri("isostore:/Shared/ShellContent/01d.jpg", System.UriKind.Absolute),
                Title = string.Format(_url.Substring(7)),
                BackTitle = "Browser",
                BackContent = (string)_url.Substring(7),
                BackBackgroundImage = new Uri("", UriKind.Relative)
            };

            // Create the Tile and pin it to Start. This will cause a navigation to Start and a deactivation of our application.
            ShellTile.Create(new Uri("/Web.xaml?passedUrl=" + _url, UriKind.Relative), NewTileData);
        }
        else
        {
            MessageBox.Show("A live tile already created for this service. Please check it out!!!");
        }
    } 
```

![在此处输入图像描述](../Images/da90aa51bfe88cfa7c14d5b1e3e16379.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:35:56.413

您需要做的是，将 html 内幕渲染为可写位图并将结果保存为 173x173 文件。

我不确定您是否可以像 IE 一样呈现 webbrowser 控件。

你不走运..阅读此[https://stackoverflow.com/a/6479233/1306871](https://stackoverflow.com/a/6479233/1306871)

由于某些错误，webbrowser 不会在 writeablebitmap 中呈现

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-12T14:07:08.077

```
Canvas canvas = new Canvas();
canvas .Width = 173;
canvas.Height = 173;
WriteableBitmap wpm= new WriteableBitmap(173, 173);
using (MemoryStream mem = new MemoryStream()){Image image = new Image();
image.Source = browsers[this.currentIndex];
can.Children.Add(image);                   
TranslateTransform translateTransform = new TranslateTransform();
translateTransform.X = 0;
translateTransform.Y = 0;
wpm.Render(canvas, translate Transform);
}    
wpm.Invalidate();                
wpm.SaveJpeg(mem, 768, 200, 0, 100);
var filename = "/Shared/ShellContent/01d.jpg";
using (var st = new IsolatedStorageFileStream(filename, FileMode.OpenOrCreate, FileAccess.Write, store)){bmp.SaveJpeg(st, 173, 173, 0, 100);} 
```

编写代码创建图块希望对您有所帮助...

# android - 基本数据存储，用于相对少量的信息，使用一组方法

> ID：11672675
> 
> 赞同：0
> 
> 时间：2012-07-26T15:25:51.843
> 
> 标签：android, class

例如，我有一个班级叫动物。我认为我不需要将其子类化为鸟类、哺乳动物等，因为我只想拥有一个包含所有动物的方法和 ui 的类，例如展示动物出生、展示动物成长、展示动物被屠杀、展示动物被吃掉（旁白：是的，这只是一个例子，但你明白了）。但是，我只想加载所有鸟类并对其进行操作，然后返回主菜单，然后导航到哺乳动物并展示它们，等等。在我的真实应用程序中，每个“动物”只有 3 倍的 int 信息。没有视频，但会有连续的音频和动画。

由于我每次只使用 1/6 的动物数据，即 10-15 只动物，整个应用程序可能使用 60-100 只动物，我最好做什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T02:38:00.080

如果您喜欢使用动物类的一些基本字段，即名称、颜色等，您应该创建一个抽象类动物而不是接口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T17:05:54.967

*评论变成答案*

我将创建一个名为的接口`Animal`，其中包含所有功能。

```
public interface Animal {
   public void drawEating();
   public void drawDeath();
} 
```

然后创建实现这个接口的类：

```
public class Bird implements Animal {
   public void drawEating() {
       // TODO: fill in
   }
   public void drawDeath() {
      // TODO: fill in
   }
} 
```

要将`Animal`您想要绘制的 Activity 传递给一个新的 Activity，您可以像[这里](https://stackoverflow.com/a/3913720/314784)描述的那样将它传递到一个包中，或者在您的新 Activity 中创建一个函数，`registerAnimal`然后从您的第一个 Activity 中调用它。

```
public class AnimalActivity extends Activity {
   Animal animal = null;

 protected void onCreate(Bundle savedInstanceState) {
     super.onCreate(savedInstanceState);
 }

 public void registerAnimal(Animal a) {
      animal = a;
 }

 public void someDrawFunction() {
      if (animal != null)
          animal.drawEating();
  } 
```

}

使用此方案，您只需为*所有*动物进行一项活动，从而节省大量重复代码。

# hadoop - Hadoop中reduce任务什么时候开始？

> ID：11672676
> 
> 赞同：83
> 
> 时间：2012-07-26T15:25:53.057
> 
> 标签：hadoop, mapreduce, reduce

在 Hadoop 中，reduce 任务什么时候开始？它们是否在映射器完成一定百分比（阈值）后开始？如果是这样，这个阈值是固定的吗？通常使用什么样的阈值？

* * *

## 回答 #1

> 赞同：209
> 
> 时间：2012-07-26T16:27:58.213

reduce阶段有3个步骤：shuffle、sort、reduce。Shuffle 是 reducer 从每个 mapper 收集数据的地方。这可能在映射器生成数据时发生，因为它只是数据传输。另一方面，排序和归约只能在所有映射器完成后开始。你可以通过查看 reducer 完成百分比来判断 MapReduce 在做什么：0-33% 表示它在做 shuffle，34-66% 是 sort，67%-100% 是 reduce。这就是为什么你的 reducer 有时会“卡”在 33% 的原因——它正在等待映射器完成。

减速器根据已完成映射器的百分比阈值开始洗牌。您可以更改参数以使减速器迟早启动。

为什么提早启动减速器是件好事？因为它随着时间的推移分散了从映射器到减速器的数据传输，如果您的网络是瓶颈，这是一件好事。

为什么提早启动减速器是一件坏事？因为他们“占用”减少了插槽，而只复制数据并等待映射器完成。稍后开始的另一项实际使用 reduce 插槽的作业现在无法使用它们。

`mapred.reduce.slowstart.completed.maps`您可以通过更改in的默认值来自定义减速器何时启动`mapred-site.xml`。值`1.00`将等待所有映射器完成，然后再启动减速器。的值`0.0`将立即启动减速器。当一半的映射器完成时，一个值`0.5`将启动减速器。您也可以`mapred.reduce.slowstart.completed.maps`根据工作进行更改。**在新版本的 Hadoop（至少 2.4.1）中，该参数称为 is`mapreduce.job.reduce.slowstart.completedmaps`**（感谢用户 yegor256）。

通常，如果系统同时运行多个作业，我喜欢保持`mapred.reduce.slowstart.completed.maps`在上面。`0.9`这样，当他们除了复制数据什么都不做时，这项工作就不会占用减速器。如果您一次只运行一项工作，那么做`0.1`可能是合适的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-12-18T00:56:40.310

reduce 阶段可以在调用 reducer 之前很久开始。一旦“a”映射器完成工作，生成的数据就会经历一些排序和改组（包括对组合器和分区器的调用）。减速器“阶段”在映射器数据处理开始的那一刻开始。完成这些处理后，您将看到减速器百分比的进展。但是，还没有调用任何减速器。根据可用/使用的处理器数量、数据性质和预期减速器的数量，您可能希望按照上面@Donald-miner 的描述更改参数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T16:06:15.063

据我了解，Reduce 阶段从地图阶段开始，并继续使用地图中的记录。然而，由于在 map 阶段之后有排序和洗牌阶段，所有的输出都必须被排序并发送到 reducer。因此，从逻辑上讲，您可以想象 reduce 阶段仅在 map 阶段之后开始，但实际上出于性能原因，reducer 也使用映射器进行初始化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-25T06:45:33.617

Reduce 仅在所有映射器完成任务后才开始，Reducer 必须与所有映射器通信，因此它必须等到最后一个映射器完成其任务。然而，映射器在完成任务时开始传输数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-30T16:46:53.177

reduce 阶段显示的百分比实际上是从 maps 输出复制到 reducers 输入目录的数据量。要知道这个复制什么时候开始？这是您可以设置的配置，如 Donald 上面所示。一旦所有数据都被复制到减速器（即 100% 减少），这就是减速器开始工作的时候，因此如果您的减速器代码是 I/O 或 CPU 密集型的，则可能会冻结在“100% 减少”中。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2014-04-14T09:25:08.023

考虑一个 WordCount 示例，以便更好地理解 map reduce 任务的工作原理。假设我们有一个大文件，比如一本小说，我们的任务是找出每个单词在文件中出现的次数。由于文件很大，它可能被分成不同的块并在不同的工作节点中复制。字数统计作业由 map 和 reduce 任务组成。map 任务将每个块作为输入，并生成一个中间键值对。在这个例子中，由于我们正在计算单词的出现次数，因此映射器在处理块时会产生形式为 (word1,count1)、(word2,count2) 等形式的中间结果。所有映射器的中间结果是通过了一个洗牌阶段，该阶段将重新排序中间结果。

假设我们来自不同映射器的地图输出具有以下形式：

地图 1:- (is,24) (was,32) (and,12)

Map2 :- (my,12) (is,23) (was,30)

map 输出以这样的方式排序，即相同的键值被赋予相同的 reducer。这意味着对应于 is,was 等的键使用相同的减速器。它是产生最终输出的减速器，在这种情况下为：- (and,12)(is,47)(my,12 )(是,62)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2014-04-20T08:30:56.340

Reducer 任务仅在`completion`所有映射器结束后才开始。

但是数据传输发生在`each`Map 之后。实际上这是一个拉动操作。

这意味着，每次 reducer 都会询问每个 maptask 是否有一些数据要从 Map 中检索。如果他们发现任何 mapper 完成了他们的任务，Reducer 会拉取中间数据。

来自 Mapper 的中间数据存储在`disk`. 并且从 Mapper 到 Reduce 的数据传输是通过网络发生的（`Data Locality`在 Reduce 阶段不保留）

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2016-10-30T09:02:08.990

当 Mapper 完成其任务时，Reducer 开始其作业以减少数据，这是 Mapreduce 作业。

# c# - 如何获取字符串值的最后一个索引

> ID：11672679
> 
> 赞同：2
> 
> 时间：2012-07-26T15:25:57.503
> 
> 标签：c#

我知道这是一个愚蠢的问题，但我真的坚持下去。下面是代码：

```
PropertyInfo[] requestPropertyInfo;
requestPropertyInfo = typeof(CBNotesInqAndMaintRequest).GetProperties(); 
```

CBNotesInqAndMaintRequest 包含请求数据成员noteline1---noteline18。一旦我读取了其中一个数据成员的名称，我想获得它的最后一个索引。例如。如果请求对象的名称是“noteline8”，我想获取索引为 8。

为此，我编写了以下代码：

```
foreach (PropertyInfo reqPropertyInfo in requestPropertyInfo)
{
  index = reqPropertyInfo.Name.LastIndexOf("noteline");
} 
```

但是上面的代码将索引返回为0。请帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T15:29:21.370

这就是你想要的吗？

```
foreach (PropertyInfo reqPropertyInfo in requestPropertyInfo)
{
  index = int.Parse(reqPropertyInfo.Name.Replace("noteline",""));
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T15:38:50.297

```
index = reqPropertyInfo.Name.Length -1; 
```

在“noteline18”的情况下，你想找到 1 而不是 8 的索引，然后

```
index = reqPropertyInfo.Name.LastIndexOf('e') + 1 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-26T15:29:34.517

看起来您想在“noteline”之后获取数字。如果是这样的话：

```
index = int.Parse(reqPropertyInfo.Name.SubString(8)); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-26T16:01:09.527

我创建了一个 RegEx 解决方案，它与属性名称无关，但会抓取最后一位数字并返回一个整数

```
static int GetLastInteger( string name ) {

    int value;
    if( int.TryParse( name, out value ) ) {
        return value;
    }
    System.Text.RegularExpressions.Regex r = 
        new System.Text.RegularExpressions.Regex( @"[^0-9](\d+\b)" );

    System.Text.RegularExpressions.Match m = 
        r.Match( name );

    string strValue = m.Groups[1].Value;
    value = ( int.Parse( strValue ) );
    return value;
} 
```

在您的示例中可用，如下所示：

```
foreach (PropertyInfo reqPropertyInfo in requestPropertyInfo)
{
  index = GetLastInteger(reqPropertyInfo.Name);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-26T15:28:29.043

你回来的原因`0`是它返回整个字符串“noteline”的最后一个索引，当然，它总是在位置 0。如果你有“notelinenoteline”，它将返回“8”。

现在，关于您*想要*返回的内容：

```
index = reqPropertyInfo.Name.Substring(8); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-26T15:31:26.717

**编辑**

考虑到您的评论，您应该这样做：

```
Int32 index = Convert.ToInt32(reqPropertyInfo.Name.Replace("noteline","")); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-26T15:28:14.870

`LastIndexOf`返回您要查找的字符串的起始索引，这就是它返回 0 的原因。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-09-06T07:24:03.867

我认为最简单的答案是获取字符串的计数，然后将其减去 1，将为您提供该字符串的最后一个索引，如下所示：-

```
int lastIndex= sampleString.Count-1; //sampleString is the string here. 
```

# android - 管理大量应用程序

> ID：11672680
> 
> 赞同：2
> 
> 时间：2012-07-26T15:26:00.210
> 
> 标签：android, eclipse, maven, ant

所以我正在做一个项目，我们有很多基本相同（相同的代码）但在图标等方面也不同的应用程序。

我正在使用带有 Mercurial 插件（我非常喜欢）的 Eclipse，它创建了一个本地源代码控制文件夹。

现在我想问一下管理所有这些项目的最佳方式是什么。例如，我在主项目中创建了一个新功能，并且我希望使用新代码自动更新和编译所有其他项目（并上传到 Play 商店 -> 我认为这是不可能的）。

我听说过 Maven 和 ANT，但我不知道这些工具能为我做什么，或者我是否走在正确的轨道上？

还是我必须自己开发这样的东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T15:33:44.547

这就是图书馆项目的用途。您创建一个基础项目并将其转换为库项目（Eclipse：Project Properties / Android / is Library [x]）其他依赖于基础项目的项目必须将其包含为库项目（Eclipse：Project Properties / 安卓）

如果你想改变像drawables这样的res文件，你必须将文件命名为相同的，android builder会用你项目中的图标覆盖库项目图标。而已。

# php - 为变量 PHP 添加值

> ID：11672681
> 
> 赞同：0
> 
> 时间：2012-07-26T15:26:00.160
> 
> 标签：php, html, sql, variables, categories

我正在创建一个类别列表.. 20 个不同的类别，当他们单击并发送一个类别时，它会将代表该类别的数值传递给数据库..

例如：

`<option value="1">Apple</option>`
`<option value="2">Microsoft</option>`

我在数据库中传递数值的原因是因为我在网页上有超过 1 种语言，并且我有不同的标签文件。我想根据类别编号回显一个 php 变量。

`<? echo $ct_1; ?>`

但为了避免大量 if/else 语句，我想知道是否可以将数字添加到变量中。因此，如果我将类别循环为：`$row['category']`我想将该变量添加到另一个变量中。像这样：

`<? $category = $.'ct_'.$row['category']; echo $category; ?>`

我知道这是不可能的。但我希望你能明白我的想法，也许有一个解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T15:30:28.670

这称为[变量变量](http://php.net/manual/en/language.variables.variable.php)。

```
$category = ${'ct_'.$row['category']};
echo $category; 
```

要不就：

```
echo ${'ct_'.$row['category']}; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-26T15:30:40.803

量身定制的[变量^(*Docs*)](http://php.net/manual/en/language.variables.variable.php)示例：

```
<?php $category = 'ct_'.$row['category']; echo $$category; ?> 
```

如果您仔细观察，它几乎与您的相同：

```
<?php $category = $.'ct_'.$row['category']; echo $category; ?>
                  ^                              ^ 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-26T15:29:26.577

您可以使用 eval() 但这会导致一些非常大的安全漏洞。

我建议改用数组：

```
$ct = array(1 => "Apple", 2 => "Microsoft");
echo $ct[$row['category']]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T15:28:46.607

快速而肮脏的方法是使用[eval](http://php.net/manual/en/function.eval.php)

```
eval('$category = $ct_'. $row['category'] . ';');
echo $category; 
```

确保首先对输入进行消毒！

# linux - Bash 脚本，通过从 PID 文件中提取来终止进程

> ID：11672682
> 
> 赞同：13
> 
> 时间：2012-07-26T15:26:01.480
> 
> 标签：linux, bash, shell, glassfish, pid

这就是我现在在 bash 脚本中的内容：

```
ps aux | grep glassfish | grep domain1 | gawk '{print $2}' | xargs kill -9 
```

这样做的问题是，如果其他人登录并拉取与 glassfish 相关的东西，它也会拉取该 PID。从而导致杀死错误的PID。

所以我的问题是如何修复我必须只提取正确的 PID，以及如何重写它以从 glassfish 生成的 PID 文件中提取 PID。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-26T15:30:37.013

编辑启动 glassfish 的脚本，并在启动进程的行之后的行上放置类似的`echo $$ > /path/to/PID-file`内容（这可以包含`~`主目录或其他一些机制，例如`$USER`使用户特定）。然后，您可以使用`kill $(cat /path/to/PID-file)`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T20:12:18.780

```
ps aux | grep ^$USER | grep glassfish | grep domain1 | gawk '{print $2}' | xargs kill -9 
```

下面我用`ps`开关弄错了，所以上面的 grep 应该没问题。

* * *

~~啊它不起作用，`ps`可以这样使用`ps -ao pid,tty,comm -u $USER`，上面的这个grep应该没问题......~~

> 其他人登录...

~~如果是这样，请添加开关 -u~~

```
ps aux -u $USER | grep glassfish | grep domain1 | gawk '{print $2}' | xargs kill -9 
```

~~$USER 是将被选择和列出的用户名，默认情况下应该已经在操作系统环境中设置。可以用逗号选择多个用户`ps aux -u root,$USER`~~

~~**注意：**如果系统中没有特定的用户名，ps会抛出*ERROR: User name does not exist。*~~

~~阅读`man ps`更多。~~

> ~~**-u userlist** 按有效用户 ID (EUID) 或名称选择。这将选择其有效用户名或 ID 在用户列表中的进程。有效用户 ID 描述了进程使用其文件访问权限的用户（请参阅 geteuid(2)）。与 U 和 --user 相同。~~

# backbone.js - 链接中的锚点

> ID：11672687
> 
> 赞同：4
> 
> 时间：2012-07-26T15:26:18.077
> 
> 标签：backbone.js, backbone-routing

鉴于：

*   Tom — 拥有支持 pushState 的现代浏览器
*   Fred——他的浏览器不支持 pushState
*   `super.app`由 Backbone 提供支持的Web 应用程序

Tom 浏览到存在部分的`products/1`页面`#special-offer`。

Backbone 是否允许 Tom 与 Fred 共享链接，包括特价部分的锚点： http: [//super.app/products/1#special-offer](http://super.app/products/1#special-offer)

Fred 会被重定向到[http://super.app/#products/1](http://super.app/#products/1)（例如：没有`#special-offer`）吗？

换句话说，Backbone 是否允许使用锚点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T18:36:36.073

我在这里进行了测试[http://bl.ocks.org/abernier/raw/3183257/](http://bl.ocks.org/abernier/raw/3183257/)

看来是：

*   锚点可以与支持 pushState 的浏览器一起使用：`http://bl.ocks.org/abernier/raw/3183257/product1.html#special-offer`
*   而对于 IE<10，它被转换为`http://bl.ocks.org/abernier/raw/3183257/#product1.html`eg: without`#special-offer`

我唯一需要注意的是禁用基于哈希的历史浏览器的锚点，方法是：

```
if (!Backbone.history._hasPushState) {
  $('body').delegate('a[href^=#]', 'click', function (e) {
    e.preventDefault();
  });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T15:42:00.360

[Backbone 在其Router](http://backbonejs.org/#Router)和[History](http://backbonejs.org/#History)模块中对*哈希 URL 片段*的使用非常可定制。

# html - IE8 Side By Side DIVS 正在堆叠

> ID：11672691
> 
> 赞同：2
> 
> 时间：2012-07-26T15:26:24.540
> 
> 标签：html, css, internet-explorer-8

我已经阅读了我能找到的所有 SO 问题，并且已经在这个问题上待了 4 天（很遗憾）。请不要认为我试图通过在此处发布某些工作来缩短工作时间。我很乐意阅读解决方案并自己应用它，但很可能我已经尝试过了......

请在**IE8**中查看[此页面](http://www.aesyliften.nl/test-page)

 **如您所见，左侧菜单位于页面内容下方。这是网站上唯一这样做的页面。我认为这是我添加特定于该页面的 CSS 中的某些内容，但是在完全删除自定义 CSS 时，不仅页面看起来像垃圾，而且它并没有修复左侧菜单。

如果有人可以建议我如何将左侧菜单实际放在左侧，我将不胜感激。

**更新（非常尴尬）** 我在页面右侧有一个没有结束标记的 div。它导致左侧菜单成为解释显示行为的右侧内容的子菜单。

对于浪费阅读此问题的人的时间，尤其是那些花时间查看该页面并提供建议的人，我真诚地道歉。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:49:16.857

似乎`float: right`没有在您的右侧 div 上设置

右 div 也有左边距，这会阻止左 div 位于它应该在的位置

```
#content {
    float: right !important;
    margin-left: 0 !important;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T15:34:19.330

我没有 IE8 但你有没有尝试添加

```
display: inline; 
```

或者

```
display: inline-block; 
```

到`#primary`和`#secondary`？

如果这不起作用，请告诉我，我将在今天晚些时候使用 IE8 访问计算机。**

# javascript - 计数元素之间的语法混淆

> ID：11672696
> 
> 赞同：0
> 
> 时间：2012-07-26T15:26:58.790
> 
> 标签：javascript, jquery, syntax, counting

`$(this).siblings()`返回：

```
[<section style class=​"white">​…​&lt;/section>​
, <section style class=​"white">​…​&lt;/section>​
, <section style=​"display:​ none">​…​&lt;/section>​
, <section style=​"display:​ none">​…​&lt;/section>​
, <section style=​"display:​ none">​…​&lt;/section>​
, <section style=​"display:​ none">​…​&lt;/section>​
, <section style=​"display:​ none">​…​&lt;/section>​] 
```

所以有 7 个部分，其中两个（当前）有 class `white`。隐藏该`parent()`部分后，我将无法再使用代码：

```
var hidden = ($(this).siblings().filter(':visible').length); 
```

要查看有多少可见，我需要计算白色的类。过了很长一段时间，我能够让它工作：

```
var hidden=0;
$(this).siblings().each(function(){
    if ($(this).hasClass('white')) {hidden++;};
}); 
```

为什么我必须遍历每个兄弟姐妹并且不能使用以下之一或另一行来计算具有 class 的那些`'white'`：

```
var hidden = ($(this).siblings().filter(':white').length); or
var hidden = ($(this).siblings().filter('white').length); 
```

或者

```
var hidden = ($(this).siblings().hasClass('white').length); 
```

或者

```
var hidden = ($(this).siblings().is(':white').length); or
var hidden = ($(this).siblings().is('white').length); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T15:31:45.233

为什么要经历`.filter()`, `.hasClass()`, `.is()`, 和循环的麻烦？[您不能使用`.sibling()`' 参数来过滤兄弟姐妹](http://jsfiddle.net/RZzZV/)并获得“白色”的兄弟姐妹吗？

```
$(this).siblings('.white').length 
```

# sql - 如何在整个 Oracle 数据库中搜索特定的字符串值？

> ID：11672697
> 
> 赞同：0
> 
> 时间：2012-07-26T15:26:59.040
> 
> 标签：sql, oracle11g

> **可能重复：**
> [在所有表中的所有字段中搜索特定值 (Oracle)](https://stackoverflow.com/questions/208493/search-all-fields-in-all-tables-for-a-specific-value-oracle)
> [在整个架构的所有字段中搜索给定字符串以获取 Oracle](https://stackoverflow.com/questions/5562131/search-for-a-given-string-in-all-fields-of-an-entire-schema-for-oracle)

我有这个：

```
select * from 
{select table_name
from user_tab_columns
where data_type = 'VARCHAR2') 
```

但是，当然，它不起作用。我只使用 SQL Developer，不知道如何继续。

我以为我在上面的查询中要求从每个表中全选，但这是不正确的。我在 SO 上看到了一些答案，但它们没有帮助。我不只需要`column_name`in `user_tab_columns`，我需要列的值

我真的只想找到名字“JONES”在数据库中的位置。我不知道表格或列，只是价值在那里......某处。

谢谢。

当我从以下位置运行代码时：

[在所有表中的所有字段中搜索特定值 (Oracle)](https://stackoverflow.com/questions/208493/search-all-fields-in-all-tables-for-a-specific-value-oracle)

```
 SET SERVEROUTPUT ON SIZE 100000

        DECLARE
          match_count INTEGER;
        BEGIN
          FOR t IN (SELECT owner, table_name, column_name
                      FROM all_tab_columns
                      WHERE owner <> 'SYS' and data_type LIKE '%CHAR%') LOOP

            EXECUTE IMMEDIATE
              'SELECT COUNT(*) FROM ' || t.owner || '.' || t.table_name ||
              ' WHERE '||t.column_name||' = :1'
              INTO match_count
              USING 'JONES%';

            IF match_count > 0 THEN
              dbms_output.put_line( t.table_name ||' '||t.column_name||' '||match_count );
            END IF;

          END LOOP;

        END;
        / 
```

我收到了：

```
Error report:
ORA-00920: invalid relational operator
ORA-06512: at line 8
00920\. 00000 -  "invalid relational operator"
*Cause:    
*Action: 
```

编辑：由于某种原因，oracle 也不喜欢不相等的`<>`尝试`!=`。

编辑：如果我只运行：

```
SELECT owner, table_name, column_name
                      FROM all_tab_columns
                      WHERE owner != 'SYS' and data_type LIKE '%CHAR%' 
```

我没有错误。

如果我在没有 的情况下运行，则`owner != 'SYS'`权限不足（尽管我拥有数据库）

删除运行，用or`owner != 'SYS'`放回去，失败`!=``<>`

编辑：`CONNECT BY`目前正在尝试

# c# - ASP.Net MVC 3 Unity IoC 处理

> ID：11672699
> 
> 赞同：2
> 
> 时间：2012-07-26T15:27:04.843
> 
> 标签：c#, asp.net-mvc-3, dependency-injection, inversion-of-control, unity-container

我正在开发一个使用 Unity 2.0 作为 IoC 容器的 ASP.Net MVC 3 Web 应用程序。

下面显示了我的**Global.asax**文件中的**Application_Start()**方法的示例

 **```
protected void Application_Start()
{
    AreaRegistration.RegisterAllAreas();

    RegisterGlobalFilters(GlobalFilters.Filters);
    RegisterRoutes(RouteTable.Routes);
    IUnityContainer container = new UnityContainer();

    container.RegisterType<IControllerActivator, CustomControllerActivator>(
        new HttpContextLifetimeManager<IControllerActivator>());

    //container.RegisterType<IUnitOfWork, UnitOfWork>(
    //  new ContainerControlledLifetimeManager());
    container.RegisterType<IUnitOfWork, UnitOfWork>(
        new HttpContextLifetimeManager<IUnitOfWork>());

    container.RegisterType<IListService, ListService>(
        new HttpContextLifetimeManager<IListService>());
    container.RegisterType<IShiftService, ShiftService>(
        new HttpContextLifetimeManager<IShiftService>());

    DependencyResolver.SetResolver(new UnityDependencyResolver(container));
} 
```

我的**HttpContextLifetimeManager**看起来像这样

```
public class HttpContextLifetimeManager<T> : LifetimeManager, IDisposable
{
    public override object GetValue()
    {
        return HttpContext.Current.Items[typeof(T).AssemblyQualifiedName];
    }

    public override void RemoveValue()
    {
        HttpContext.Current.Items.Remove(typeof(T).AssemblyQualifiedName);
    }

    public override void SetValue(object newValue)
    {
        HttpContext.Current.Items[typeof(T).AssemblyQualifiedName] =
            newValue;
    }

    public void Dispose()
    {
        RemoveValue();
    }
} 
```

我的问题是，当我在上面设置断点时，永远不会调用上述类中的方法**Dispose() 。**我担心我的 IoC 容器实例永远不会被处理掉。这会导致问题吗？

我找到了我放在**Global.asax**文件中的这段代码，但仍然没有调用**Dispose()方法**

```
protected void Application_EndRequest(object sender, EventArgs e)
{
    using (DependencyResolver.Current as IDisposable);
} 
```

谁能帮助我处理我的 Unity 容器的每个实例？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T16:40:25.410

使用 Unity.MVC3 nuget 包。然后在初始化时指定 HierarchicalLifetimeManager 并且您的对象将在每次请求后被处理。

```
container.RegisterType(new HierarchicalLifetimeManager());

```

就这么简单 ： ）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T16:06:32.320

Unity 不会跟踪它创建的实例，也不会处理它们。Rory Primrose 有一个[扩展，可以进行跟踪](http://www.neovolve.com/post/2010/06/18/Unity-Extension-For-Disposing-Build-Trees-On-TearDown.aspx)并允许通过调用来处理对象`container.TearDown()`。

`LifetimeManagers`自己清理后的内容在[Unity vNext 的愿望清单上](http://entlib.uservoice.com/forums/89245-general/suggestions/1672391-unity-lifetimes-teardown-should-dispose-objects-c)。

如果您对每个请求都进行引导，那么引导新容器实例的成本会很高。因此，在完成所有注册后，我会考虑缓存容器实例。**

# java - 我发现阅读别人写的 Java 非常困难

> ID：11672701
> 
> 赞同：-1
> 
> 时间：2012-07-26T15:27:12.367
> 
> 标签：java, jakarta-ee, junit

在过去的 3 年里，我一直在使用 Java。我认为我擅长开发和编写代码。但是最近我换了一份新工作，发现了两个主要问题：

1.  阅读试图理解其他人的代码，这是一个不同的领域，这可能是我苦苦挣扎的原因。但我真的很难理解代码。

2.  编写生产质量代码，我一直被告知要改进我的代码。我以前从来没有遇到过任何问题。

请提供有关我能做什么的任何有用的提示和技巧。

ps 我一直在阅读和练习，标准书籍：Effective Java、Beginning Java、ooad、Design Patterns 等。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-26T15:31:37.370

> 1）阅读试图理解其他人的代码，它是一个不同的领域，这可能是我挣扎的原因..但我真的很难理解代码。

即使经过 20 年的发展，它也绝非易事。您能做的最好的事情就是学习使您的代码尽可能简单易懂。;)

> 2）编写生产质量代码，我一直被告知要改进我的代码..以前从未遇到过任何问题。

这可能意味着很多事情。我建议你尝试学习他们的做法。例如，他们是否意味着他们期望更多的单元测试、代码审查、不同的代码结构。可能是他们无法阅读您的代码。;)

# python - 需要了解 Python 生成器对象

> ID：11672706
> 
> 赞同：6
> 
> 时间：2012-07-26T15:27:37.760
> 
> 标签：python, generator, generator-expression

在下面的：

```
name = 'TODD'
chars = set('AEIOU')
for ii in range(-1, int(math.copysign(len(name) + 1, -1)), -1):
    if any((cc in chars) for cc in name[ii]):
        print 'Found'
    else:
        print 'Not Found' 
```

我知道 any(...) 里面是一个生成器对象。我不明白的是缺少括号 - 如果括号属于 any() 函数，那么生成器表达式周围不应该有另一组括号吗？

谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-26T15:30:02.263

在只有一个参数的函数调用中使用括号可以省略，[生成器表达式语法](http://docs.python.org/reference/expressions.html#generator-expressions)特别允许。

> 只有一个参数的调用可以省略括号。有关详细信息，请参阅[呼叫](http://docs.python.org/reference/expressions.html#calls)部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T15:30:24.517

如果表达式已经是括号中的唯一内容，则可以省略生成器表达式的括号。

从[文档](http://docs.python.org/reference/expressions.html#generator-expressions)中：

> 只有一个参数的调用可以省略括号。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-26T15:30:44.853

不，不需要额外的括号，实际上您正在测试的“布尔表达式”也不需要括号，请参阅以下两个简单示例：

```
In [37]: any(i > 10 for i in range(19))
Out[37]: True

In [38]: all(i > 10 for i in range(19))
Out[38]: False 
```

您所拥有的是带有单个参数（您的生成器表达式）的函数调用，因此不需要括号。有关更多信息，请参阅[生成器表达式文档](http://docs.python.org/reference/expressions.html#generator-expressions)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-26T15:30:45.127

[对于只有一个参数（该生成器表达式）的函数调用，根据文档](http://docs.python.org/reference/expressions.html#generator-expressions)，它们不是必需的

> 只有一个参数的调用可以省略括号。有关详细信息，请参阅呼叫部分。

# visual-studio-2010 - 如何在 Visual Studio 2010 中从 Ankhsvn 插件切换到 VisualHG

> ID：11672707
> 
> 赞同：16
> 
> 时间：2012-07-26T15:27:40.447
> 
> 标签：visual-studio-2010, version-control, visualhg

当尝试将我的解决方案从使用 Ankhsvn 切换到 VisualHG（我们刚刚从 SVN 迁移到 Mercurial）时，我不断收到以下消息：

> “活动的解决方案或项目由与您选择的不同的源代码管理插件控制。如果您更改源代码管理插件，活动的解决方案或项目将关闭。您要继续吗？”

然后该解决方案将关闭，当我重新打开它时，它仍然会链接到 Ankhsvn。

我尝试删除源文件夹并从 Mercurial 中获取新的克隆，但问题不断出现。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-07-26T15:27:40.447

该解决方案需要在文本编辑器中打开 .sln 文件并手动删除以下块：

```
-   GlobalSection(SubversionScc) = preSolution
-       Svn-Managed = True
-       Manager = AnkhSVN - Subversion Support for Visual Studio
-   EndGlobalSection 
```

之后我就可以走了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-12T22:07:25.217

上述解决方案有效，但另一种无需编辑 sln 的方法是打开项目而不是解决方案。然后在 Tools->Options->Source Control->Plug-in Selection 中更改设置并更改插件。确保全部保存 - 这应该将新的源代码控制保存到解决方案中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-04-05T09:12:48.903

我的解决方案是：

1.  通常使用 vs 打开解决方案
2.  断开所有 AnkhSvn 项目绑定
3.  将源代码控制插件更改为 VisualHG 并保存所有

# c# - 访问/迭代 jQuery 中的 C# 列表

> ID：11672710
> 
> 赞同：-1
> 
> 时间：2012-07-26T15:27:46.083
> 
> 标签：c#, jquery, asp.net

我正在尝试制作一个图片淡入淡出的图片库。我已经涵盖了该部分，但到目前为止，我在我的 .aspx 页面中对图像 url 进行了硬编码。我不想要这个，我需要它是动态的。

```
 <script type="text/javascript">
    $(function() 
    {   var img = $("img.x");
        $(img).hide().eq(0).show();
        var cnt = img.length
        setInterval(imgRotate, 5000);
        function imgRotate() {
            $(img).eq((img.length++) % cnt).fadeOut("slow",
        function() {
            $(img).eq((img.length) % cnt).fadeIn("slow");
        });
        }
    });        
</script>
<body>
<form id="form1" runat="server">
<div>
         <img class="x" alt="Image1" src="Desert.jpg"/>
         <img class="x" alt="Image1" src="Lighthouse.jpg"/>            
</div>
</form> 
```

这使图像淡入淡出，这很好，但正如您所见，我在本例中对图像进行了硬编码。我不能将它用于我的应用程序。

我想做的是以下内容：我想将一个`List<string>` （代码隐藏）传递给 jQuery 脚本，该脚本将遍历列表并替换图像的源 URL。

我只想在 jQuery 脚本（伪代码）中做这样的事情：

```
int counter = 0;
var img = ListFromCodeBehind[counter];
//do some fading stuff
count++; 
```

我试过使用`<%=%>`服务器标签等等，但无济于事。我读过很多东西，但对于我想要实现的目标来说，它们似乎都过于复杂了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T15:47:40.483

为什么每个人都强迫你使用 AJAX？无需在单独的 HTTP 请求中加载图像列表。我假设您的代码来自某个 aspx 页面。因此，您可以在此 Pages 的类中提供一个公共方法（让我们调用它`GetImages()`），该方法返回一个看起来像 JavaScript 数组的字符串。IE

```
public string GetImages()
{
    return "['Desert.jpg', 'Lighthouse.jpg']";
} 
```

然后在您的 JavaScript 代码（也放置在此页面的 aspx 文件中）中，您可以使用经典的 ASP 语法调用页面类的公共方法：

```
int counter = 0;
var ListFromCodeBehind = <%= this.GetImages() %>;
var img = ListFromCodeBehind[counter];
//do some fading stuff
count++; 
```

最终将打印：

```
var ListFromCodeBehind = ['Desert.jpg', 'Lighthouse.jpg']; 
```

这就是我相信你所期望的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T15:34:49.453

您可以将**Web 方法**添加到可由 AJAX 调用的 aspx 页面（代码隐藏）中。您的代码背后的方法将返回一个字符串，其中包含图像的 URL，采用 JSON 格式（以便 JQuery 知道如何在开箱即用的情况下进行迭代）。

查看此线程以了解如何在 aspx 代码隐藏文件中创建 Web 方法。我会通过 asp.net MVC 来做这件事……更直接

[通过 jQuery 调用 ASP.NET 服务器端方法](https://stackoverflow.com/questions/886903/calling-asp-net-server-side-method-via-jquery)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T15:39:34.320

```
//Controller
[HttpGet]
public JsonResult GetImageURLS() 
{
    var urls = GetUrls();
    return Json(new { urls = urls }, JsonRequest.AllowGet); 
}

//js file
$.ajax({ url : '/GetImageURLS/', success : function(e) { if (e && e.urls) {  
    var $images = $(".images");
    for (var i in e.urls) {
     $images.append('<img src="' + i.url + '" class="x" ' + ' alt="' + i.alt + '" /> ';
    }
  });

//html
<div class="images">

</div> 
```

试试这个来初始加载图像。然后在填充图像后在它们上调用您的函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T15:41:33.660

您可以使用 AJAX 并在 Javascript 中调用 Web 服务来返回您的图像列表，如下所示：

```
function LoadImages() {

var url;
url = "WebServices/wsImages.asmx/GetImageList"

$.ajax({
    type: "POST",
    url: url,
    contentType: "application/json; charset=utf-8",
    error: function (XMLHttpRequest, textStatus, errorThrown) {
        alert(textStatus);
    },
    success: function (response) {
        var imgList = response.d;
        //Loop through image list etc.
    }
});
} 
```

# c# - GridView 中的日历预渲染

> ID：11672716
> 
> 赞同：1
> 
> 时间：2012-07-26T15:27:59.060
> 
> 标签：c#, asp.net, ajax, calendar

```
 <asp:GridView ID="GridView1" runat="server" AllowPaging="True" 
    AutoGenerateColumns="False" BackColor="White" BorderColor="#CCCCCC" 
    BorderStyle="None" BorderWidth="1px" CellPadding="4" 
    DataSourceID="SqlDataSource1" ForeColor="Black" GridLines="Horizontal" 
    Width="900px">
    <Columns>
        <asp:TemplateField HeaderText="Date" SortExpression="Date">
            <EditItemTemplate>
                <asp:TextBox ID="txtStartDate" runat="server" Text='<%# Bind("Date") %>'></asp:TextBox>
                <asp:CalendarExtender
                                ID="CalendarExtender1"
                                onprerender="AjaxCalendar_PreRender" 
                                runat="server"
                                TargetControlID="txtStartDate"
                                Format="dd/MM/yyyy"  />

            <asp:RequiredFieldValidator ID="RequiredFieldValidator1" runat="server" 
                ErrorMessage="Date is required" Font-Italic="True" Font-Size="Small" 
                ForeColor="Red" ControlToValidate="txtStartDate"></asp:RequiredFieldValidator>

            </EditItemTemplate>
            <ItemTemplate>
                <asp:Label ID="Label1" runat="server" Text='<%# Bind("Date") %>'></asp:Label>
            </ItemTemplate>
            <HeaderStyle HorizontalAlign="Left" />
        </asp:TemplateField>
        <asp:TemplateField HeaderText="Time" SortExpression="Start_Time">
            <EditItemTemplate>
                <asp:TextBox ID="TextBox2" runat="server" Text='<%# Bind("Start_Time") %>'></asp:TextBox>
            </EditItemTemplate>
            <ItemTemplate>
                <asp:Label ID="Label2" runat="server" Text='<%# Bind("Start_Time") %>'></asp:Label>
            </ItemTemplate>
            <HeaderStyle HorizontalAlign="Left" />
        </asp:TemplateField>

        <asp:CommandField ShowEditButton="True">
        <ItemStyle ForeColor="#003366" />
        </asp:CommandField>
    </Columns>
</asp:GridView> 
```

我想设置具有特定日期范围的日历。

```
protected void AjaxCalendar_PreRender(object sender, EventArgs e)
{
    DateTime startDate = DateTime.Now.AddDays(1);
    DateTime endDate = DateTime.Now.AddDays(60);
    CalendarExtender ce = (CalendarExtender)GridView1.FindControl("CalendarExtender1");
    ce.StartDate = startDate;
    ce.EndDate = endDate;
} 
```

这就是我所做的，但是我没有将对象引用设置为对象的实例。是不是 GridView FindControl 导致了错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T20:30:31.173

您需要将该逻辑移至 rowcreated 事件：http: [//msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.rowcreated](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.rowcreated)

请记住，您在 gridview 上得到的是一堆项目，而不是单个控件。这些项目按模板分组，其中一些是：

*   项目模板
*   编辑项目模板
*   插入项模板

而且您没有所有模板的扩展器，因为它不是必需的。这就是为什么这不起作用：

```
CalendarExtender ce = (CalendarExtender)GridView1.FindControl("CalendarExtender1"); 
```

由于实际的 CalendarExtender1 不存在于 gridview 内部，而是存在于每个项目内部，因此可以有多个模板。

希望我在解释自己，你可以完成。

# actionscript-3 - 指示 AS3 gotoAndPlay

> ID：11672723
> 
> 赞同：0
> 
> 时间：2012-07-26T15:28:21.197
> 
> 标签：actionscript-3, flash

我有一个 AS3 影片剪辑，当它到达最后一帧时，我想返回到第一帧。

影片剪辑实例名称是**sym2**。

我试过 -

**_root.sym2.gotoAndPlay(1);** 和 **sym2.gotoAndPlay(1);**

但它不起作用。

如何指示影片剪辑从第一帧重新开始播放？

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T22:58:55.843

这是一种无需在框架内写入的好方法：

```
var backToStart:Function = new Function(){
    gotoAndPlay(1);
}
yourMovieClip.addFrameScript(yourMovieClip.totalFrames, backToStart);
//place this in the constructor 
```

# php - 样式 cakephp 表单选择框中的错误

> ID：11672724
> 
> 赞同：0
> 
> 时间：2012-07-26T15:28:22.557
> 
> 标签：php, css, cakephp, css-selectors

我有这个代码。我的问题是选择菜单上没有应用任何样式。但它被应用于输入框。我在这里做错什么了吗？

## HTML

```
<div class="signup">
<div class="personal">
<?php
echo $this->Form->create('User',array('/users/signup'));
echo $this->Form->input('name');
$options = array('m'=>'Male','f'=>'Female');
echo $this->Form->input('gender', array( 'options'=>$options,'type'=>'select', 'label'=>'Gender'));
echo $this->Form->submit('Sign up');
echo $this->Form->end();
?>
</div>
</div> 
```

## CSS

```
.signup{
 /* class style */
}

.signup .personal form input[type=text],[type=select]{
border: 1px solid #cacaca;
border-radius: 2px;
font: 12px arial;
height: 20px;
width: 150px;
} 
```

## HTML 输出

```
<div class="signup">
    <div class="personal">
        <form action="/appraisal/users/signup" /users/signup="/users/signup" id="UserSignupForm" method="post" accept-charset="utf-8">
            <div style="display:none;">
                <input type="hidden" name="_method" value="POST"/>
            </div>
            <div class="input text">
                <label for="UserName">Name</label>
                <input name="data[User][name]" type="text" id="UserName"/>
            </div>
            <div class="input select">
                <label for="UserGender">Gender</label>
                <select name="data[User][gender]" id="UserGender">
                    <option value="m">Male</option>
                    <option value="f">Female</option>
                </select>
            </div>
            <div class="submit">
                <input  type="submit" value="Sign up"/>
            </div>
        </form>
    </div>
</div> 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:34:10.993

正确的选择器是`select`，不是`[type=select]`。

为元素保留的那种选择器样式`input`（例如`input[type=email], input[type=text]`）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T17:08:35.203

[这篇文章](http://bavotasan.com/2011/style-select-box-using-only-css/)可能会帮助您获得下拉列表的 CSS。正如罗斯所说，`select`它被用作选择器来为选择框提供一些 UI 增强功能。

[本教程](http://dev.opera.com/articles/view/styling-forms-with-attribute-selectors/)必须帮助您了解可用于表单元素的 css 选择器。

# mysql - MySQL 查询优化 - 长时间运行的查询

> ID：11672725
> 
> 赞同：0
> 
> 时间：2012-07-26T15:28:24.267
> 
> 标签：mysql, optimization

我在 mysql 中有一个查询需要很长时间才能执行。trans表约350k条记录，trans_detail表约1m条记录

我很感激在优化查询或数据库结构方面的一些帮助。

查询：

```
SELECT
    DATE_FORMAT(t.utc_date_due, '%b %Y') AS date_trans,
    LAST_DAY(t.utc_date_due) AS date_end,
    SUM(td.amount * lode) AS 'amount',
    SUM(t.amount_paid * lode) AS 'paid'
FROM trans t
LEFT JOIN trans_detail td ON t.id = td.trans_id AND td.ident = 'c'
WHERE t.company_id = 1
    AND  (trans_type_id = 'inv' or trans_type_id = 'crn')
    AND t.is_deleted = 0
    AND t.is_draft = 0
GROUP BY DATE_FORMAT(t.utc_date_due, '%b %Y')
ORDER BY utc_date_due 
```

`explain`：_

```
+----+-------------+-------+-------------+----------------------------------------------------------+--------------------------------------+---------+----------------+------+-----------------------------------------------------------------------------------------------------+
| id | select_type | table | type        | possible_keys                                            | key                                  | key_len | ref            | rows | Extra                                                                                               |
+----+-------------+-------+-------------+----------------------------------------------------------+--------------------------------------+---------+----------------+------+-----------------------------------------------------------------------------------------------------+
|  1 | SIMPLE      | t     | index_merge | fk_trans_company,fk_trans_trans_type,is_deleted,is_draft | fk_trans_company,is_draft,is_deleted | 4,1,2   | NULL           |  995 | Using intersect(fk_trans_company,is_draft,is_deleted); Using where; Using temporary; Using filesort |
|  1 | SIMPLE      | td    | ref         | fk_trans_detail_trans,ident                              | fk_trans_detail_trans                | 4       | actester2.t.id |    1 |                                                                                                     |
+----+-------------+-------+-------------+----------------------------------------------------------+--------------------------------------+---------+----------------+------+-----------------------------------------------------------------------------------------------------+ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:30:39.533

我将从更改行开始：

```
AND  (trans_type_id = 'inv' or trans_type_id = 'crn') 
```

使用 IN 子句：

```
AND  (trans_type_id in ('inv', 'crn')) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-18T15:55:23.620

试着放

```
td.ident = 'c' 
```

在您的 WHERE 子句中。您可以在 utc_date_due 上创建索引。

我个人建议，如果速度很重要，使用两步方法，你应该使用一个临时表并插入你的元素，然后只在临时表上求和。

# ruby-on-rails - 如何修复糟糕的 Capistrano 部署？

> ID：11672726
> 
> 赞同：0
> 
> 时间：2012-07-26T15:28:24.587
> 
> 标签：ruby-on-rails, deployment, capistrano

昨晚做了一个大更新，我的网站目前已关闭。我`cap deploy:rollback`没有运气使用。错误日志并没有告诉我太多。我在尝试部署时看到的最后一个错误是：

```
 ** [out :: website.com] You are trying to install in deployment mode after changing
 ** [out :: website.com] your Gemfile. Run `bundle install` elsewhere and add the
 ** [out :: website.com] updated Gemfile.lock to version control.
 ** [out :: website.com] 
 ** [out :: website.com] You have deleted from the Gemfile:
 ** [out :: website.com] * asset_sync
    command finished in 934ms 
```

我`cap tail`只是说以下没有错误：

```
Migrating to AddSessionsTable (20120722094547)
Migrating to AddSlugToUserProjects (20120723204816)
Migrating to AddSlugIndexToUserProjects (20120723205558)
Migrating to CreateFriendlyIdSlugs (20120723210904)
Migrating to AddNameToUsers (20120723221700)
Migrating to AddSlugToUsers (20120723222456)
Migrating to CreateComments (20120724203252) 
```

有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T15:39:04.810

`bundle install`在您的开发服务器上运行，然后`cap deploy`. 另一种可能的解决方案：添加`asset_sync`回您的 Gemfile。

作为最后的手段，您可以运行`cap -d deploy`. 它将逐步运行部署，要求您继续执行每一步。在单独的 shell 中登录到生产服务器，并在步骤之间手动进行一些调整。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T18:24:36.647

看起来 Gemfile 的更改并不顺利。它是如何修复的：

1.  登录到服务器，有 6 个 ruby​​ 进程正在占用所有可用的东西。这几乎可以肯定是独角兽进程试图启动但无法……`killall -9 ruby`
2.  cd 进入应用程序的当前目录
3.  RAILS_ENV=production bundle exec rake assets:precompile
4.  服务 unicorn_whimseybox 开始

看起来（在 unicorn.log 中），错误是：E，[2012-07-26T17:27:10.552912 #24818] ERROR -- : uninitialized constant AssetSync (NameError)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-03T11:31:23.513

将一些 Gemfile`source`行转换为块后，我遇到了同样的错误。

该错误是由于生产中的旧 Bundler 版本（1.7.3）与开发中的 1.8.3 造成的。

# asp.net - Jquery Ajax，不在 Internet Explorer 中工作

> ID：11672727
> 
> 赞同：2
> 
> 时间：2012-07-26T15:28:28.403
> 
> 标签：asp.net, ajax, wcf, jquery

我正在尝试做一些 jQuery ajax，它适用于 Firfox 和 Chrome，但不适用于 Internet Explorer 9。

最终代码必须跨越子域，这在默认传输中不起作用。

所以我正在尝试创建一个自定义传输以在 Internet Explorer 中使用

**方法一**

```
$.ajaxTransport("+*", function (options, originalOptions, jqXHR) {
    if (jQuery.browser.msie && window.XDomainRequest) {
        var xdr;
        return {
            send: function (headers, completeCallback) {
                // Use Microsoft XDR
                xdr = new XDomainRequest();
                xdr.open("get", options.url);
                xdr.onload = function () {
                    if (this.contentType.match(/\/xml/)) {
                        var dom = new ActiveXObject("Microsoft.XMLDOM");
                        dom.async = false;
                        dom.loadXML(this.responseText);
                        completeCallback(200, "success", [dom]);
                    } else {
                        completeCallback(200, "success", [this.responseText]);
                    }
                };
                xdr.ontimeout = function () {
                    completeCallback(408, "error", ["The request timed out."]);
                };
                xdr.onerror = function () {
                    completeCallback(404, "error", ["The requested resource could not be found."]);
                };
                xdr.send();
            },
            abort: function () {
                if (xdr) xdr.abort();
            }
        };
    }
}); 
```

我在这里创建了一个简单的示例页面来演示第一种技术： [http ://services.whygo.net/sendAjax.htm](http://services.whygo.net/sendAjax.htm)

**请注意，如果您使用自定义传输，则正常传输将失败，除非您刷新**

这个想法来自这里：http: [//forum.jquery.com/topic/cross-domain-ajax-and-ie#14737000002203097](http://forum.jquery.com/topic/cross-domain-ajax-and-ie#14737000002203097)

这在 $ajax 上调用的 'error' 方法中除了 'error' 之外没有任何错误消息，当它失败时。我确实在 if 开发工具的“网络”选项卡上得到了一个 405 Method not allowed，但服务器端的东西确实执行了。

**方法 2** 我也尝试过这里描述的另一种方法： [Cross-subdomain AJAX works in Chrome, not IE](https://stackoverflow.com/questions/11143226/cross-subdomain-ajax-works-in-chrome-not-ie)

```
if ('XDomainRequest' in window && window.XDomainRequest !== null) {

    // override default jQuery transport
    jQuery.ajaxSettings.xhr = function() {
        try { return new XDomainRequest(); }
        catch(e) { }
     };
} 
```

这可以在这里找到：http: [//www.whygo.net/sendAjax2.html](http://www.whygo.net/sendAjax2.html)

在这一点上，我实际上在 ie 开发工具的“网络”选项卡上获得了 200 个代码，但没有调用 $ajax 的“错误”或“成功”参数。

如果我在第二个超时，那么它会返回到“错误”函数并显示“超时”消息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T23:01:36.547

这是我在与这种不一致问题苦苦挣扎一天后所采用的解决方案......

```
// new method as to not overwrite jQuery's defaults
var cors = (window.XDomainRequest) ? function(url, callback) {

    var xdr = new XDomainRequest();
    xdr.open('get', url);
    xdr.onload = function() { callback(xdr.responseText); }
    xdr.send();

} : $.get; // else, use jQuery's method 
```

利用...

```
cors(url, function(msg) { alert(msg); }); // pretty well same as $.get 
```

复制和粘贴，这当然不能满足所有目的，但它是一个开始并且它有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T16:23:16.700

在[http://services.whygo.net/sendAjax2.html](http://services.whygo.net/sendAjax2.html)页面上，我看到您期望`dataType`AJAX 响应以 JSON 形式从服务器返回，但响应实际上以纯文本字符串（ “电子邮件已成功发送。”）。

也许您可以尝试注释掉`dataType`并让 jQuery 找出返回的响应类型。

# javascript - 如何在 javascript 和/或 jquery 中对具有多列的 HTML 表进行排序

> ID：11672730
> 
> 赞同：0
> 
> 时间：2012-07-26T15:28:28.940
> 
> 标签：javascript, jquery, html, arrays, jquery-ui-sortable

所以我喜欢自学并寻求帮助。我不想使用 javascript/jquery 插件，因为我想开发自己的代码。那么如何通过单击按钮按字母顺序对表格进行排序呢？当他们单击按钮时，该行将按字母顺序排列，该行的其余部分将按照正在排序的列进行排序。谢谢！

```
<table id=sortableTable">
    <thead id="myTHead">
      <tr>
         <th> Month </th>
         <th> Population </th>
      </tr>
   </thead>
   <tbody id="myBody">
<tr>
<td>March</td>
<td>100</td>
</tr>
<tr>
<td>April</td>
<td>300</td>
</tr>
 <tr>
<td>Febuary</td>
<td>200</td>
</tr> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T15:38:24.613

我不会给你一个代码示例，因为你要问的是一段相当长的代码。但是您需要明智地做的是确保您拥有使用特定 ID 生成的所有表格元素。可能是 id="colnum_rownum" 格式的东西。

如果每列都有一个排序按钮，他们可能需要自己的 ID；s 以及 id="sort_colnum"。

当您单击该按钮时，您会想要调用一个函数，该函数将获取包含您单击的列的 ID 的所有元素。然后，您将对它们进行排序以了解需要将哪些行号移动到哪里。然后，您会将 DOM 中的这些行移动到它们的新位置，并可能修改 id 以反映它们的新位置，以便稍后在单击另一个按钮时再次排序。

虽然从学术理解的角度来处理这样的事情是一件有趣的事情。从实际的角度来看，当已经有许多好的解决方案时，花时间实现这样的事情是很疯狂的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-13T21:33:31.913

我刚刚在另一篇具有类似主题的帖子中发现了这一点：

[http://www.allmyscripts.com/Table_Sort/](http://www.allmyscripts.com/Table_Sort/)

通过阅读它是 javasript 中用于 html 表的开源排序功能。看起来很有趣，简单而有用。

# javascript - 基于第一个淘汰教程，为什么我的代码没有运行？

> ID：11672732
> 
> 赞同：4
> 
> 时间：2012-07-26T15:28:29.900
> 
> 标签：javascript, data-binding, knockout.js

我了解该教程在页面上的工作原理，但我试图在本地设置一个以创建计算器，但无法让 knockout.js 工作。它不像 knockout.js 在线教程那样初始化或填充。

HTML

```
<html>
<head>
    <script type="text/javascript" language="javascript" src="../knockout-2.1.0.js"></script>
    <script type="text/JavaScript" language="javascript">
        function AppViewModel() {
            this.firstName = ko.observable("Bert");
            this.lastName = ko.observable("Bertington");
        }
        // Activates knockout.js
        ko.applyBindings(new AppViewModel());
    </script> 
</head>
<body class="calc" onLoad="createnav()">

<div id="all">

    <div id="calc">

        <p>First name: <strong data-bind="text: firstName"></strong></p>
            <p>Last name: <strong data-bind="text: lastName"></strong></p>

            <p>First name: <input data-bind="value: firstName" /></p>
            <p>Last name: <input data-bind="value: lastName" /></p>
    </div>
    <div id="info">
       <!-- outputs will be here -->
    </div>
</div>
</body>
</html> 
```

我正在使用 knockout.js 版本 2.1.0。至于`src`它的位置是正确的。

文件夹结构

```
 ----------
  | Root   |
  ----------_____________________
     |                             |
   -------------------        ------------       ---------------
  | knockout-2.1.0.js |      |  pphcalc   | ___ | HeroPilot.asp |
   -------------------        ------------       --------------- 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-05T10:47:52.137

如果您不使用 jquery，请不要为此专门加载它。相反，您可以在 window.onload 上激活淘汰赛。例子：

将您的 ko.applyBindings 调用包装在一个函数中：

```
function startKnockout() {
    ko.applyBindings(new AppViewModel());
}; 
```

将“开始”函数的名称传递给 window.onload。注意，不要将 () 添加到函数名称中。这可以防止函数立即执行，而是确保在加载窗口时将其作为回调函数调用。

```
window.onload = startKnockout; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T15:53:20.643

您正在头脚本标记中应用绑定，因此在您的 ko.applyBindings(new AppViewModel()) 行运行时还没有任何要绑定的元素。

您可以为 JQuery Window.load 函数提供回调，以确保在应用绑定之前正确加载所有内容。例子：

```
<script type="text/JavaScript" language="javascript">
    function AppViewModel() {
        this.firstName = ko.observable("Bert");
        this.lastName = ko.observable("Bertington");
    }

    // Activates knockout.js
    $(window).load(function() {
        ko.applyBindings(new AppViewModel());
    });
</script> 
```

# java - 为超类分配参考java

> ID：11672737
> 
> 赞同：4
> 
> 时间：2012-07-26T15:28:47.113
> 
> 标签：java, inheritance, reference, superclass

我有一个带有构造函数的类 Vector

```
Vector(int dimension) // creates a vector of size dimension 
```

我有一个扩展 Vector 类的类 Neuron

```
public class Neuron extends Vector {

    public Neuron(int dimension, ... other parameters in here ...) { 
         super(dimension);
         // other assignments below here ...
     }    
} 
```

我想要做的是为 Neuron 类中的 Vector 分配对另一个 Vector 的引用。类似的东西

```
 public Neuron(Vector v, ... other parameters in here ...) { 
         super = v;
         // other assignments below here ...
     } 
```

当然，我不能这样做。有什么解决办法吗？即使我无法在 Neuron 类的构造函数中执行此操作，也可能没问题。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-26T15:29:51.203

您需要在类中创建一个[复制构造函数](http://en.wikipedia.org/wiki/Copy_constructor)`Vector`：

```
public Vector(Vector toCopy) {
    this.dimension = toCopy.dimension;

    // ... copy other attributes
} 
```

然后在`Neuron`你做

```
public Neuron(Vector v, ... other parameters in here ...) { 
     super(v);
     // other assignments below here ...
} 
```

* * *

您也可以考虑使用*组合*而不是*继承*。事实上，这是 Effective Java 中的建议之一。在这种情况下，你会做

```
class Neuron {
    Vector data;

    public Neuron(Vector v, ... other parameters in here ...) {
        data = v;
        // other assignments below here ...
    }
} 
```

**相关问题：**

*   [继承与组合的区别](https://stackoverflow.com/questions/2399544/difference-between-inheritance-and-composition)
*   [优先组合而不是继承](https://stackoverflow.com/questions/11343840/favor-composition-over-inheritence)

# java - Java多线程的编译器逻辑？

> ID：11672739
> 
> 赞同：1
> 
> 时间：2012-07-26T15:28:51.457
> 
> 标签：java, multithreading

所以我对多线程的工作原理有点困惑。例如，如果我创建了一个`Thread`被调用的子类`MySub`，这就是它的样子：

```
public class MySub extends Thread {
   public void run {
      for(int i = 0; i < 5; i++){
         System.out.println(i); 
      }
   }
} 
```

在主要课程中，我这样做：

```
public static void main(String[] args) {
    Thread m = new MySub();
    Thread m2 = new MySub();
    m.start();
    m2.start();
} 
```

是不是应该调用`start()`for的方法`m`，然后直接调用`start()`for的方法`m2`，不等`m`线程结束？这不是多线程的重点吗？

但实际上，它从`start()`调用中打印 0 到 4 `m`，然后为`start()`调用打印 0 到 4 `m2`。他们没有同时进行，而是按顺序进行，这不是我所期望的。我有点期待 0 到 4 个数字的混乱。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-26T15:30:58.277

这是一个竞争条件@Jake。*在*开始第二个线程之前，您`main`没有等待第一个线程完成。它正在启动第一个线程，该线程在有机会启动第二个线程*之前*完成其工作。 **`main`**

 **如果您尝试打印（比方说）1000 个数字或需要更多时间的东西，您会开始看到它们交错。或者您可以`Thread.sleep(10)`在您的`println`陈述之间放置一个更具体的说明。

仅供参考：建议让您的课程`implement Runnable`而不是`extends Thread`. 然后你会这样做：

```
Thread m1 = new Thread(new MySub());
m1.start(); 
```

此外，`ExecutorService`建议使用代码而不是直接使用线程。**

# excel - 如何在excel中突出显示选定的文本

> ID：11672740
> 
> 赞同：5
> 
> 时间：2012-07-26T15:28:53.267
> 
> 标签：excel, vba, text, highlight

我想编写一个 VBA 函数来突出显示 excel 单元格中的特定文本。这可能吗？我一直在谷歌搜索，但目前还不清楚。

为了澄清，我想在特定列中搜索文本值（实际上是值列表），并以黄色突出显示匹配的文本。

注意：这是我最终做的：

```
 Sub Colors()

    Dim searchString As String
    Dim targetString As String
    Dim startPos As Integer

    searchString = "abc"
    targetString = Cells(2, 1).Value
    startPos = InStr(targetString, searchString)

    If startPos > 0 Then

        Cells(2, 1).Characters(startPos, Len(searchString)).Font.Color = vbRed

    End If

 End Sub 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-26T15:32:23.267

这是基本原则，我假设自定义此代码不是您所要求的（因为没有提供有关此的详细信息）：

```
 Sub Colors()

 With Range("A1")
    .Value = "Test"
    .Characters(2, 2).Font.Color = vbGreen
 End With

 End Sub 
```

简短的描述虽然不言自明：第一个“2”是指需要着色的第一个字符，第二个“2”是指长度。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-26T18:47:44.877

这仅适用于试图突出显示单元格内的特定字符串模式的未来读者，

（这就是我解释问题的方式）您可以在此示例中设置在 F1 中搜索的字符串

```
Sub test4String2color()
Dim strTest As String
Dim strLen As Integer
 strTest = Range("F1")
 strLen = Len(strTest)
For Each cell In Range("A1:D100")
 If InStr(cell, strTest) > 0 Then
  cell.Characters(InStr(cell, strTest), strLen).Font.Color = vbRed
 End If
Next
End Sub 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-12-07T16:56:27.397

这是专门针对@t.ztrk 的答案，他在 Col1 中有城市，并在第 2 列中搜索这些城市。他在这里发布了他的问题： [是否可以在 excel 中查找和更改文本的颜色](https://stackoverflow.com/q/47643229/8716187)

我从另一个解决方案中借用了这段代码（对不起，如果它不是原来的）：[https ://stackoverflow.com/a/11676031/8716187](https://stackoverflow.com/a/11676031/8716187)

```
Sub test4String2color()
Dim strTest As String
Dim strLen As Integer
 strTest = Range("F1")
 strLen = Len(strTest)
For Each cell In Range("A1:D100")
 If InStr(cell, strTest) > 0 Then
  cell.Characters(InStr(cell, strTest), strLen).Font.Color = vbRed
 End If
Next
End Sub 
```

我知道这可能并不优雅，但我在几分钟内就完成了它以满足用户的需求。如果上面提供的解决方案 (1) 更灵活或 (2) 更高效，请提前道歉。也对我的 C++ 嵌套循环习惯感到抱歉。

@t.ztrk 您可以录制一个宏并停止它（删除那里的任何内容）或插入一个按钮控件并将代码粘贴到那里。不确定您对 VB 的熟悉程度。只需确保在运行宏之前在要处理的工作表上选择一个单元格（它应该在任何工作表上运行，并且可以在任何工作簿上运行）。

```
Sub Macro1()
'Searches all text in Column 2 on a Sheet for the string located in Column 1
'If found it highlights that text
Dim ThisWB As Workbook
Dim ThisWS As Worksheet
Dim i As Integer
Dim y As Integer

Dim Col1 As Double
Dim Col2 As Double

Dim Col1_rowSTART As Double
Dim Col1_rowEND As Double

Dim Col2_rowSTART As Double
Dim Col2_rowEND As Double

Dim strTest As String
Dim strLen As Integer

'Set up parameter that we know
Set ThisWB = ActiveWorkbook
Set ThisWS = ActiveSheet
Col1 = 1 'city column
Col2 = 2 'text search column
'Define Starting Row for each column
Col1_rowSTART = 1
Col2_rowSTART = 1
'Define ending row for each column
Col1_rowEND = ThisWS.Cells(ThisWS.Rows.Count, Col1).End(xlUp).Row
Col2_rowEND = ThisWS.Cells(ThisWS.Rows.Count, Col2).End(xlUp).Row

'Could be fancy and see which column is shorter ....
'Won't do that here

For i = Col1_rowSTART To Col1_rowEND
    'make a string out of each cell value in Col1
    strTest = CStr(ThisWS.Cells(i, Col1))
    strLen = Len(strTest)
    'Roll thorugh all of Column 2 in search of the target string
    For y = Col2_rowSTART To Col2_rowEND
        'Check if Col1 string is in Col2 String
        If InStr(CStr(ThisWS.Cells(y, Col2)), strTest) > 0 Then
            ThisWS.Cells(y, Col2).Characters(InStr(ThisWS.Cells(y, Col2), strTest), strLen).Font.Color = vbRed
        End If
    Next y
Next i

MsgBox ("City Search Complete!")

End Sub 
```

这是您的测试屏幕截图。 [![在此处输入图像描述](../Images/a47cb9972c54f04cdc228ed550e57410.png)](https://i.stack.imgur.com/JxO21.jpg)

干杯 - 继续学习和应用。-WWC

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-27T16:30:41.207

突出显示单元格中的文本的一个问题是字符串可能不止一次出现，因此代码应该真正检查是否还有更多。这是我对这个问题的解决方案：

```
Sub Colors()

    Dim searchTerms As Variant

    searchTerms = Array("searchterm1", "searchterm2",  "lastsearchterm")

    Dim searchString As String
    Dim targetString As String
    Dim offSet As Integer
    Dim colToSearch As Integer
    Dim arrayPos, rowNum As Integer

    colToSearch = 3

    For arrayPos = LBound(searchTerms) To UBound(searchTerms)
        For rowNum = 2 To 31124

            searchString = Trim(searchTerms(arrayPos))

            offSet = 1

            Dim x As Integer

            targetString = Cells(rowNum, colToSearch).Value

            x = HilightString(offSet, searchString, rowNum, colToSearc)

        Next rowNum
    Next arrayPos

 End Sub

Function HilightString(offSet As Integer, searchString As String, rowNum As Integer, ingredCol As Integer) As Integer

            Dim x As Integer
            Dim newOffset As Integer
            Dim targetString As String

            ' offet starts at 1

            targetString = Mid(Cells(rowNum, ingredCol), offSet)

            foundPos = InStr(LCase(targetString), searchString)

            If foundPos > 0 Then

                ' the found position will cause a highlight where it was found in the cell starting at the offset - 1
                Cells(rowNum, ingredCol).Characters(offSet + foundPos - 1, Len(searchString)).Font.Color = vbRed

                ' increment the offset to found position + 1 + the length of the search string
                newOffset = offSet + foundPos + Len(searchString)

                x = HilightString(newOffset, searchString, rowNum, ingredCol)
            Else
                ' if it's not found, come back out of the recursive call stack
                Exit Function
            End If
End Function 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-09-22T16:59:04.090

@Jack BeNimble 感谢代码，在 10 分钟内成功使用它来突出显示单元格中的所有数字。我对其进行了一点重组，首先搜索一行和单元格中的所有搜索词，并允许多列。我发现了一个错误，您的突出显示文本不喜欢重复 55、444，只突出显示序列中的奇数重复。修改高亮功能中的一行

```
newOffset = offSet + foundPos + Len(searchString) - 1 //added the - 1. 
```

这是我修改后的代码。

子编号颜色（）

```
Dim searchTerms As Variant

searchTerms = Array("0", "1", "2", "3", "4", "5", "6", "7", "8", "9", ".")

Dim searchString As String
Dim targetString As String
Dim offSet As Integer
Dim colsToSearch As Variant
Dim arrayPos, colIndex, colNum As Integer
Dim rowNum As Integer

colsToSearch = Array(4, 44, 45)

For colIndex = LBound(colsToSearch) To UBound(colsToSearch)
    colNum = colsToSearch(colIndex)
    For rowNum = 5 To 3000
        For arrayPos = LBound(searchTerms) To UBound(searchTerms)
            searchString = Trim(searchTerms(arrayPos))

            offSet = 1

            Dim x As Integer

            targetString = Cells(rowNum, colNum).Value

            x = HilightString(offSet, searchString, rowNum, colNum)
        Next arrayPos
    Next rowNum
Next colIndex 
```

结束子

函数 HilightString(offSet As Integer, searchString As String, rowNum As Integer, ingredCol As Integer) As Integer

```
 Dim x As Integer
        Dim newOffset As Integer
        Dim targetString As String

        ' offet starts at 1

        targetString = Mid(Cells(rowNum, ingredCol), offSet)

        foundPos = InStr(LCase(targetString), searchString)

        If foundPos > 0 Then

            ' the found position will cause a highlight where it was found in the cell starting at the offset - 1
            Cells(rowNum, ingredCol).Characters(offSet + foundPos - 1, Len(searchString)).Font.Color = vbBlue

            ' increment the offset to found position + 1 + the length of the search string
            newOffset = offSet + foundPos + Len(searchString) - 1

            x = HilightString(newOffset, searchString, rowNum, ingredCol)
        Else
            ' if it's not found, come back out of the recursive call stack
            Exit Function
        End If 
```

结束功能

谢谢 Jack BeNimble 和数据

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-07-26T15:53:59.733

您不需要 VBA 来执行此操作。您可以使用条件格式。

假设您在 E 列中有一组值。您想在单元格 B1 中输入一个值并突出显示 E 列中与该值匹配的单元格。

突出显示 E 列中的单元格并应用以下条件格式：

![突出显示匹配的单元格](../Images/fade7474a5e047e6005217f596851f12.png)

更改颜色以适合。这会将相对条件格式应用于 E 列中的单元格。例如：选择 E3 并查看条件格式，它应该如下所示：

![相对参考](../Images/4c420f700c26262c04606b4edb19f709.png)

您可以看到公式如何自行调整。

（**编辑：**如果要将 B1 中的值与 E 列中的值的子字符串匹配，请改用此条件格式公式`=FIND($B$1,E1)>0`：）

现在在单元格 B1 中键入不同的值。如果您键入的值与 E 列中的某个值匹配，则这些单元格（在 E 列中）将改变颜色。将单元格 B1 更改为 E 列中不存在的值，格式将消失。

# php - 获取 Doctrine 1.2 - Symfony 1.4 中的表/模型列表并描述？

> ID：11672748
> 
> 赞同：2
> 
> 时间：2012-07-26T15:29:19.590
> 
> 标签：php, mysql, sql, symfony1, doctrine

我如何使用 Symfony 1.4 中的 Doctrine 1.2 获取数据库中所有模型或表的所有信息。

我需要做一个关于 capifony/git/migrations 的演示。所以我希望用户执行以下操作：

*   克隆存储库
*   对模板进行更改（任何文本）
*   更改 schema.yml 并生成迁移差异
*   部署

所以我需要列出所有模型或表，并列出每个模型或表的列。为了证明该过程有效

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T15:57:38.113

[`Doctrine_Connection`](https://github.com/doctrine/doctrine1/blob/master/lib/Doctrine/Connection.php)有一个名为 的函数[`getTables()`](https://github.com/doctrine/doctrine1/blob/master/lib/Doctrine/Connection.php#L1132)，我假设您可以获得该连接上调用它的表的列表。据此，[它](https://github.com/doctrine/doctrine1/blob/master/lib/Doctrine/Connection.php#L63)[`Doctrine_Table`](https://github.com/doctrine/doctrine1/blob/master/lib/Doctrine/Table.php)返回一个实例数组。

该类包含[其列定义的数组](https://github.com/doctrine/doctrine1/blob/master/lib/Doctrine/Table.php#L70)，您可以通过调用来检索它[`getColumns()`](https://github.com/doctrine/doctrine1/blob/master/lib/Doctrine/Table.php#L2152)。

我希望这足以让你开始。

# actionscript-3 - actionscript 3 从另一个 MovieClip 中获取文本

> ID：11672751
> 
> 赞同：0
> 
> 时间：2012-07-26T15:29:23.987
> 
> 标签：actionscript-3

我有一个名为“auto”的movieclip，里面有一个名为“title”的文本和一个movieclip“info”。进入信息我在 as3 中有一个脚本，我想从名为 auto 的高级电影剪辑中获取标题。影片剪辑信息在影片剪辑内。这是我的代码内部信息，但不起作用

```
trace(auto.title.text) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T16:05:11.337

您说您将脚本添加到信息中，因此您的代码正在寻找名为“auto”的信息中的属性或剪辑。但汽车不是内部信息。

相反，尝试`trace(info.parent.title.text);`

# php - 可打印分页 MySQL 数据库

> ID：11672756
> 
> 赞同：0
> 
> 时间：2012-07-26T15:29:36.997
> 
> 标签：php, mysql, database, asp-classic

我有一个问题，也许有人可以帮助我。我有一个使用 MySQL 数据库创建的票务跟踪系统。我需要为客户打印出记录的票流，但问题是他想要的票线程有 150 条记录及其分页设置，因此打印一页只会给我 25 条记录。

我需要一种方法来使它成为打印机友好的布局，这样我的客户就可以打印出所有线程，即使以一种很好的格式和布局进行分页以交给他的客户。有谁知道可以做到这一点的任何物体、产品或地方？请记住该解决方案需要基于 Web，并且如果可能的话，更喜欢 Classic ASP 中的某些内容，但对所有建议开放。该站点是多年前开发的，使用的是 Classic ASP。

谢谢你的帮助！！！

弗兰克·G。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:38:38.280

您只需要考虑为 ASP 寻找分页工具，同时限制从 MYSQL 数据库中提取的记录数。下面是一个MYSQL代码示例：

```
SELECT * FROM `tickets` LIMIT 50, 30 
```

其中第一个数字是偏移量（跳过前 50 行），第二个数字是限制（30 行）

我不知道 ASP 所以这就是我所能提供的。祝你好运 ：）

# javascript - jQuery分割文本

> ID：11672758
> 
> 赞同：0
> 
> 时间：2012-07-26T15:29:45.963
> 
> 标签：javascript, jquery

`<span>`我有一个填充标签的信用卡字段，例如

```
<span>****-****-****-1111 (Expires 12/2012)</span> 
```

我需要提取日期并确定它是否在过去。

目前我有下面的 jQuery，但我被困在 split() 点以仅提取日期。

```
var $selectedDate = $('.prev-card .chzn-container .chzn-single span').text().split();
var $now = new Date();
if ($selectedDate < $now) {
    alert('past')
}
else{
    alert('future')
} 
```

我认为这涵盖了所有内容，但请随时询问更多信息

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T15:32:49.103

尝试这个：

```
var selectedDate = $("...").text().match(/Expires (\d+)\/(\d+)/),
    expires = new Date(selectedDate[2],selectedDate[1]-1,1,0,0,0),
    now = new Date();
if( expires.getTime() < now.getTime()) alert("past");
else alert("future"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T15:42:23.293

对 Kolink 的回答的小修复：

```
var selectedDate = $("...").text().match(/Expires (\d+)\/(\d+)/),
    expires = new Date(selectedDate[2],selectedDate[1]-1,1,0,0,0),
    now = new Date();
if( expires.getTime() < now.getTime()) alert("past");
else alert("future"); 
```

（正则表达式不需要引号）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T15:33:23.173

我不会拆分它。我会使用正则表达式：

```
var value = $('.prev-card .chzn-container .chzn-single span').text();
/\d+\/\d+/.exec(value)   //["12/2012"] 
```

# php - PHP – 从多维数组中检索值

> ID：11672760
> 
> 赞同：0
> 
> 时间：2012-07-26T15:29:45.577
> 
> 标签：php, arrays

我有一个工作脚本，但我确信我管理数组的方法可能会更好。我一直在寻找解决方案，但没有找到，但我确信我应该使用关联数组的功能来更有效地做事。

我有两个数组，一个来自 CSV 文件，一个来自数据库。我已经将 CSV 数组创建为数字数组，将 DB 数组创建为关联数组（尽管我知道 PHP 中的区别很模糊）。

我试图在 DB 数组中找到一个记录，其中一个字段中的值与 CSV 数组中的值匹配。两个数组都是多维的。

在每个数组的每个记录中都有一个参考编号。它在 CSV 数组中出现一次，并且可能出现在 DB 数组中。如果是这样，我需要采取行动。

我目前正在这样做（简化）：

```
$CSVarray:
('reference01', 'blue', 'small' ),
('reference02', 'red', 'large' ),
('reference03', 'pink', 'medium' )

$Dbarray:
(0 => array(ref=>'reference01',name=>"tom",type=>"mouse"),
(1 => array(ref=>'reference02',name=>"jerry",type=>"cat"),
(2 => array(ref=>'reference03',name=>"butch",type=>"dog"),

foreach ($CSVarray as $CSVrecord) {
    foreach ($Dbarray as $DBrecord) {
        if ($CSVarray[$numerickey] == $DBrecord['key'] {
            do something with the various values in the $DBrecord 
        }
    }
} 
```

这太可怕了，因为每个数组都有数千行。

我不只是想知道是否存在匹配值，我想从匹配记录中检索数据，所以像 'array_search' 这样的函数不会做我想要的，并且 array_walk 似乎并不比我目前的方法好。

我真正需要的是这样的（乱码）：

```
foreach ($CSVarray as $CSVrecord) {
    WHERE $Dbarray['key']['key'] == $CSVrecord[$numerickey] {
        do something with the other values in $Dbarray['key']
    }
} 
```

我正在寻找一种使用键（数字或关联）而不是遍历数组来匹配值的方法。任何人都可以提供任何帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T15:41:39.890

使用哈希映射 - 获取一个数组并将其所属记录的每个键映射到该记录。然后获取第二个数组并简单地对其进行迭代，检查每个记录键是否已为哈希图设置了任何内容。关于你的例子：

```
foreach ($DBarray as $DBrecord){
   $Hash[$record[$key]] = $DBrecord;
}

foreach ($CSVarray as $record){
   if (isset($Hash[$record[$CSVkey]])){
       $DBrecord = $Hash[$record[$CSVkey]];
        //do stuff with $DBrecord and $CSVrecord
   }
} 
```

此解决方案适用于 O(n)，而您的解决方案适用于 O(n^2)...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T15:34:09.743

你也可以像这样使用 foreach 循环：

```
foreach ($record as $key => $value) {
  switch($key)
  {
    case 'asd':
      // do something
      break;
    default:
      // Default
      break;
  }
} 
```

开关也可能是您正在寻找的东西:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T15:38:02.917

将 CSV 加载到数据库中，并尽可能使用 db（不是 db 数组）进行检索。索引 referenceid 字段。

# django - 多对多表应该如何定义

> ID：11672762
> 
> 赞同：1
> 
> 时间：2012-07-26T15:29:51.923
> 
> 标签：django, many-to-many

我在理解 Django 中的多对多字段时遇到了一些麻烦。

当我创建一个多对多字段时，例如：

```
class GlobalPart (Models.model):
    ...
    category_id=models.ManyToManyField(Category, related_name = 'globalpart')
    ... 
```

和

```
class Category (Model.model):
    ...
    category = models.CharField(max_length=250)
    ... 
```

我注意到`appname_globalpart_category_id`除了模型的`appname_globalpart`表之外，它还创建了一个名为的新表`GlobalPart`。

我想知道的是，该表中的字段类型应该如何定义。我认为应该至少有一个外键来关联这些字段。但取而代之的是表的主键，其他字段是整数（`globalpart_id`和`category_id`）。

所以我的问题是——这正常吗？还是我以某种方式错误地定义了多对多字段？我的下一个问题是如何将所有`category_ids`关联到一个特定的`GlobalPart`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:43:23.807

你认为外键是什么？它是一个字段，包含等同于“外部”表中的 ID（通常是主键）的值。如果另一个表有整数键，就像大多数 Django 表一样，那么外键字段也将是整数类型。

此外，Django 创建约束，以便数据库将强制 ID 确实引用外部表中的有效值。根据您的数据库，这些可能会或可能不会显示为字段定义的一部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T16:18:03.507

(1) 简短回答：是的，这是正常的。

长答案：ManyToMany 表需要 Category 和 GlobalPart 表的外键。严格来说，这两个外键应该足够了。您在那里看到的额外 pk 仅用于 django 魔术。如果您自己手动定义多对多表，您真的可以只使用该表中的这两个外键。但是，如果你让 django 为你做这件事（通过使用 ManyToManyField），你会得到这个额外的 pk

(2) 我建议将您的模型字段 category_id 更改为类别：

```
 class GlobalPart (Models.model):
        categories=models.ManyToManyField(Category, related_name = 'globalpart') 
```

这是因为，ManyToManyFields 很好地引用了“许多”项目。该字段不引用“一个”category_id，它引用*所有*相关类别。因此，在命名时，相应地命名它是很自然的。

至于访问所有类别，您可以通过访问“类别”属性来完成。假设您的对象实例名为 global_part，您可以访问如下类别：

```
categories = global_part.categories.all() 
```

代替 all()，您可以使用 filter() 或 exclude()，就像在查询模型时使用它一样。

这是相关[django 文档的链接](https://docs.djangoproject.com/en/1.4/topics/db/models/#many-to-many-relations)

# ruby - Ruby RTF gem中文本的RTF颜色

> ID：11672763
> 
> 赞同：0
> 
> 时间：2012-07-26T15:29:52.927
> 
> 标签：ruby, rtf

我有这个代码来创建一个 RTF 文档，但我找不到如何为文本着色，有人可以帮我吗？

```
# encoding: utf-8
#!/usr/bin/env ruby

$LOAD_PATH.unshift(File.dirname(__FILE__)+"/../lib/")

require 'rtf'
include RTF
colour = Colour.new(150, 150, 150)

style = CharacterStyle.new
style.bold      = true
style.font_size = 28
style.foreground = colour

document = RTF::Document.new(RTF::Font.new(RTF::Font::ROMAN, 'Times New Roman'))

document.paragraph(style) do |p|
   p << "And there you have it."
end

File.open('my_document.rtf', 'w') {|file| file.write(document.to_rtf)} 
```

给

```
C:/Ruby193/lib/ruby/gems/1.9.1/gems/rtf-0.3.3/lib/rtf/style.rb:124:in `prefix': undefined method `index' for nil:NilClass (NoMethodError) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T17:17:56.643

查看 RDoc 中的最后一个示例 - [http://ruby-rtf.rubyforge.org/docs/index.html](http://ruby-rtf.rubyforge.org/docs/index.html)。

您创建了 CharacterStyle 并将其应用于段落，这是不允许的。您需要将 CharacterStyle 应用于文本。

将您的输出更改为：

```
document.paragraph() do |p|
    p.apply(style) do |t|
        t << "And there you have it."
    end
end 
```

# asp.net - 无法加载类型“NavigateWebApp.Global”

> ID：11672765
> 
> 赞同：0
> 
> 时间：2012-07-26T15:30:00.190
> 
> 标签：asp.net, .net

最近我们已经将我们的项目移动到网络应用程序，一切都很好，但突然间我不知道我什么时候尝试调试我的应用程序，它向我显示以下错误：

```
Server Error in '/' Application.
--------------------------------------------------------------------------------

Parser Error 
Description: An error occurred during the parsing of a resource required to service this request. Please review the following specific parse error details and modify your source file appropriately. 

Parser Error Message: Could not load type 'NavigateWebApp.Global'.

Source Error: 

Line 1:  <%@ Application Codebehind="Global.asax.cs" Inherits="NavigateWebApp.Global" Language="C#" %>

Source File: /global.asax    Line: 1 
--------------------------------------------------------------------------------
Version Information: Microsoft .NET Framework Version:2.0.50727.4971; ASP.NET Version:2.0.50727.4971 
```

我确信没有构建错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T15:33:42.060

这可能是由于您的`'NavigateWebApp.Global'`类/命名空间在您指定的位置不可用引起的。

检查你在哪里定义它并确保它可以被`Global.asax`页面访问。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T15:40:37.513

问题的根源是您的`Global.asax`文件引用了一个不再存在的类（或至少在您指定的位置）。简单的解决方法是使用类名`Inherits`的完全限定路径`Global.asax`（您将在`Global.asax.cs`文件中找到）更新属性。

# java - LibGDX - Camera.update() 调用什么也不做

> ID：11672771
> 
> 赞同：4
> 
> 时间：2012-07-26T15:30:26.453
> 
> 标签：java, android, camera, 2d, libgdx

我刚开始玩 LibGDX，并且已经面临相机问题。

我在互联网上看到了一些 tutos，如果我理解得很好，在使用 LibGDX 的 2D 游戏中，您必须重新计算所有实体的位置（我的意思是屏幕上的每个实体）的位置，并考虑速度等参数......

对我来说，这意味着相机不会移动，而是它所展示的世界。我想做相反的事情，移动相机而不是世界，因为这对我来说更有意义，而且看起来更容易，因为我只需要移动相机，而不是所有实体。所以我不希望世界移动，我的相机显示变化，但我的相机移动并显示变化。因此，即使某些实体没有移动（它们的坐标 x 和 y 没有改变），它看起来就像相机移动一样。

所以我有一个`Camera`继承自的类`OrthographicalCamera`和一个`Entity`类。我还有 2 个接口`PositionListener`& `PositionListenable`=> Pattern Observer。

所以我试图做的是：
- 我的相机只“听”我的一个实体（例如玩家）
- 当我的实体移动时，它用它的坐标（x，y）更新相机，我的相机改变它的位置x 和 y 跟随我的实体。

这是 Camera.java 中的代码：

```
public class Camera extends OrthographicCamera implements PositionListener {

    public Camera(float width, float height) {
        super(width, height);
    }

    @Override
    public void entityMoved(float newX, float newY) {
        translate(newX - position.x, newY - position.y);
        update();
        Gdx.app.log("entityMoved()", "newX=" + newX + " - newY=" + newY);
        Gdx.app.log("entityMoved()", "position.x=" + position.x + " - position.y=" + position.y);
} 
```

}

当我阅读日志时，我看到了这一点`position.x`并`position.y`按照我的预期进行了更改以跟随我的实体，但视觉上相机没有移动？？一切看起来都像我的相机没有翻译一样！

我的相机根本不动，只有我的实体！
我错过了什么？我读了一些关于“viewPort”的东西，但真的没有明白，因为我是 LibGDX 的初学者。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T21:16:22.153

好的，我是如何让它工作的。
这是`entityMoved()`方法：

```
@Override
public void entityMoved(float newX, float newY) {
    translate(newX - position.x, newY - position.y);
    Gdx.app.log("entityMoved()", "newX=" + newX + " - newY=" + newY);
    Gdx.app.log("entityMoved()", "position.x=" + position.x + " - position.y=" + position.y); 
```

在主循环中，`render()`方法`ApplicationListener`：

```
sprite.begin();
world.draw(sprite);
sprite.end();

camera.update();
sprite.setProjectionMatrix(camera.combined); 
```

draw 方法（）也使我的实体移动，并通知它的观察者是相机。然后我更新相机（而不是像以前那样从它自己的方法）并更新投影矩阵。

有点滞后，但就像我想要的那样工作！

# linux - Linux 文件夹/包管理

> ID：11672778
> 
> 赞同：0
> 
> 时间：2012-07-26T15:30:38.650
> 
> 标签：linux, package, package-managers

我正在寻找一种将所有应用程序文件存储在单个文件夹中的方法。但是，当有人单击文件夹时，我希望打开文件夹内的应用程序，而不是打开文件夹本身。我想始终将所有依赖项和文件保留在此文件夹中。

我这样做是因为我将在一个通用框架上部署几个应用程序，并希望确保它们在一起并且独立于发行版具有所有要求。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T15:39:26.867

文件夹是目录，目录不同于文件。无法将目录重定向到可执行文件。但是，您可以创建一个隐藏目录（名称以“.”开头）并使用可执行文件来提供对该目录的访问。该目录将不会出现在窗口管理器文件夹中，只会出现在应用程序中。但是，窗口管理器不会将可执行文件错误地表示为目录。

# haskell - Cabal 预处理符号

> ID：11672786
> 
> 赞同：1
> 
> 时间：2012-07-26T15:30:52.473
> 
> 标签：haskell, build, cabal

> **可能重复：**
> [Haskell：在源代码中指定版本的正确做法？](https://stackoverflow.com/questions/9857710/haskell-correct-practice-to-specify-version-in-source)

有没有办法将阴谋集团元数据导出到我的代码中？例如，使用自动工具，我定义了程序版本`configure.ac`并将其作为我的代码的定义。目前，在 cabal 中，我必须在两个地方维护程序版本 - 在 .cabal 和`--version`. 任何优雅的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T18:29:43.060

让我用一个 shell 会话来回答这个问题：

```
~ $ cd /tmp/
/tmp $ mkdir test
/tmp $ cd test/
/tmp/test $ cabal init
Package name? [default: test] 
Package version? [default: 0.1.0.0] 
Please choose a license:
 * 1) (none)
   2) GPL-2
   3) GPL-3
   4) LGPL-2.1
   5) LGPL-3
   6) BSD3
   7) MIT
   8) PublicDomain
   9) AllRightsReserved
  10) Other (specify)
Your choice? [default: (none)] 
Author name? [default: Joachim Breitner] 
Maintainer email? [default: mail@joachim-breitner.de] 
Project homepage URL? 
Project synopsis? 
Project category:
 * 1) (none)
   2) Codec
   3) Concurrency
   4) Control
   5) Data
   6) Database
   7) Development
   8) Distribution
   9) Game
  10) Graphics
  11) Language
  12) Math
  13) Network
  14) Sound
  15) System
  16) Testing
  17) Text
  18) Web
  19) Other (specify)
Your choice? [default: (none)] 
What does the package build:
   1) Library
   2) Executable
Your choice? 2
Include documentation on what each field means (y/n)? [default: n] 

Guessing dependencies...

Generating LICENSE...
Warning: unknown license type, you must put a copy in LICENSE yourself.
Generating Setup.hs...
Generating test.cabal...

Warning: no synopsis given. You should edit the .cabal file and add one.
You may want to edit the .cabal file and add a Description field.
/tmp/test $ vim *.cabal
/tmp/test $ cat *.cabal
name:                test
version:             0.1.0.0
license-file:        LICENSE
author:              Joachim Breitner
maintainer:          mail@joachim-breitner.de
build-type:          Simple
cabal-version:       >=1.8

executable test
  main-is: Main.hs
  build-depends:       base ==4.5.*

/tmp/test $ echo 'main = return ()' > Main.hs
/tmp/test $ cabal configure && cabal build
Resolving dependencies...
Configuring test-0.1.0.0...
Warning: The 'license-file' field refers to the file 'LICENSE' which does not
exist.
Building test-0.1.0.0...
Preprocessing executable 'test' for test-0.1.0.0...
[1 of 1] Compiling Main             ( Main.hs, dist/build/test/test-tmp/Main.o )
Linking dist/build/test/test ...
/tmp/test $ find dist/
dist/
dist/package.conf.inplace
dist/setup-config
dist/build
dist/build/autogen
dist/build/autogen/Paths_test.hs
dist/build/autogen/cabal_macros.h
dist/build/test
dist/build/test/test-tmp
dist/build/test/test-tmp/Main.o
dist/build/test/test-tmp/Main.hi
dist/build/test/test
/tmp/test $ grep -i version dist/build/autogen/Paths_test.hs
    version,
import Data.Version (Version(..))
version :: Version
version = Version {versionBranch = [0,1,0,0], versionTags = []}
/tmp/test $ echo 'import Paths_test' > Main.hs
/tmp/test $ echo 'main = print version' >> Main.hs
/tmp/test $ cabal build
Building test-0.1.0.0...
Preprocessing executable 'test' for test-0.1.0.0...
[1 of 2] Compiling Paths_test       ( dist/build/autogen/Paths_test.hs, dist/build/test/test-tmp/Paths_test.o )
[2 of 2] Compiling Main             ( Main.hs, dist/build/test/test-tmp/Main.o )
Linking dist/build/test/test ...
/tmp/test $ ./dist/build/test/test
Version {versionBranch = [0,1,0,0], versionTags = []} 
```

（TL；DR：cabal 生成一个称为`Paths_<pkgname>`定义常量的模块`version :: Version`。）

# html - IE6 中的固定高度

> ID：11672787
> 
> 赞同：0
> 
> 时间：2012-07-26T15:30:52.847
> 
> 标签：html, css, internet-explorer-6, scrollbar

从[davidwalsh](http://davidwalsh.name/cross-browser-css-min-height)的链接，它说在 IE6 中，即使定义了硬设置高度，容器也会垂直扩展。那么如何在 IE6 中定义最大高度，以便在达到该高度之前，容器应该继续扩展其内容，但是一旦超过该高度，滚动条应该出现？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T15:39:15.163

必须启用 JavaScript，但这适用于支持 IE6。

```
* html div#division { 
   height: expression( this.scrollHeight > 332 ? "333px" : "auto" ); /* sets max-height for IE */
}
div#division {
   max-height: 333px; /* sets max-height value for all standards-compliant browsers */
} 
```

[http://perishablepress.com/maximum-and-minimum-height-and-width-in-internet-explorer/](http://perishablepress.com/maximum-and-minimum-height-and-width-in-internet-explorer/)

# sparql - Jena StmtIterator 和数据库

> ID：11672788
> 
> 赞同：1
> 
> 时间：2012-07-26T15:30:54.563
> 
> 标签：sparql, jena, arq

我将模型存储在三重存储（持久性）中。我想选择与某个文档名称相关的所有个人。

我可以通过两种方式做到这一点

1) SPARQL 请求：

```
 PREFIX base:<http://example#>
  select ?s2 ?p2 ?o2 
    where {
      {?doc base:fullName <file:/c:/1.txt>; ?p1 ?o1
  } UNION { 
    ?s2 ?p2 ?o2 ;
    base:documentID ?doc    } 
  } 
```

问题：如何从 ResultSet 创建 Jena 的模型？

2) StmtIterator stmtIterator = model.listStatements(...)

这种方法的问题是我需要多次使用 model.listStatements(...) 操作：

a) 通过文档名称获取文档 URI

b) 获取与此文档 URI 相关的个人 ID 列表

c) finally - 得到一个个体的集合

我关心性能 - 3 次运行 model.listStatements(...) - 许多数据库请求。

或者在模型创建期间从数据库中将所有数据读入内存（我对此表示怀疑）：

```
 Dataset ds = RdfStoreFactory.connectDataset(store, conn);
     GraphStore graphStore = GraphStoreFactory.create(ds) ; 
```

?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T07:46:22.043

您需要稍作备份，并更清楚地考虑您要做什么。您的 sparql 查询一旦被纠正（见下文），将非常好地在结果集上生成一个迭代器，这将为您提供您正在寻找的每个文档的属性。`s2`具体来说，您会为每个和结果集中`p2`的`o2`每个值获得一组绑定。这就是您在指定时所要求的`select ?s2 ?p2 ?o2`。这通常是您想要的：通常，我们从三重存储中选择一些值以便以某种方式处理它们（例如将它们呈现到 UI 上的列表中），为此我们确切地想要一个迭代结果。借助 SPARQL，您*可以让查询返回模型而不是结果集*[构造](http://www.w3.org/TR/rdf-sparql-query/#construct)查询或 SPARQL[描述](http://www.w3.org/TR/rdf-sparql-query/#describe)。但是，您随后需要迭代模型中的资源，因此您不会再向前推进（除了您的模型更小并且在内存中）。

顺便说一句，您的查询可以改进。变量`p1`并使`o1`查询引擎做无用的工作，因为您从不使用它们，并且不需要联合。更正后，您的查询应该是：

```
PREFIX base:<http://example#>

select ?s2 ?p2 ?o2 
where {
  ?doc base:fullName <file:/c:/1.txt> .
  ?s2 base:documentID ?doc ;
      ?p2 ?o2 .
} 
```

要从 Java 执行任何查询、选择、描述或构造，请参阅[Jena 文档](http://jena.apache.org/documentation/query/app_api.html)。

您可以使用模型 API 有效地获得与查询相同的结果。例如，（未经测试）：

```
Model m = ..... ; // your model here
String baseNS = "http://example#";
Resource fileName = m.createResource( "file:/c:/1.txt" );

// create RDF property objects for the properties we need. This can be done in
// a vocab class, or automated with schemagen
Property fullName = m.createProperty( baseNS + "fullName" );
Property documentID = m.createProperty( baseNS + "documentID" );

// find the ?doc with the given fullName
for (ResIterator i = m.listSubjectsWithProperty( fullName, fileName ); i.hasNext(); ) {
  Resource doc = i.next();

  // find all of the ?s2 whose documentID is ?doc
  for (StmtIterator j = m.listStatements( null, documentID, doc ); j.hasNext(); ) {
    Resource s2 = j.next().getSubject();

    // list the properties of ?s2
    for (StmtIterator k = s2.listProperties(); k.hasNext(); ) {
      Statement stmt = k.next();
      Property p2 = stmt.getPredicate();
      RDFNode o2 = stmt.getObject();

      // do something with s2 p2 o2 ...
    }
  }
} 
```

请注意，您的架构设计使这变得更加复杂。例如，如果文档全名资源有一个`base:isFullNameOf`属性，那么您可以简单地进行查找以获取`doc`. 同样，不清楚为什么需要区分`doc`和`s2`：为什么不简单地将文档属性附加到`doc`资源？

最后：不，打开数据库连接不会将整个数据库加载到内存中。但是，TDB 确实广泛使用了图形区域的缓存，以提高查询效率。

# c# - 使用 C# 解析日期时间

> ID：11672793
> 
> 赞同：3
> 
> 时间：2012-07-26T15:31:05.437
> 
> 标签：c#, .net, string, datetime

> **可能重复：**
> [解析日期时间字符串](https://stackoverflow.com/questions/9434336/parse-datetime-string)

我正在尝试在 C# 中解析以下 DateTime：

```
string date = "Wed Jul 25 19:41:36 2012 +0200"
DateTime result = DateTime.Parse(date); 
```

我收到以下错误：

```
System.FormatException : String was not recognized as a valid DateTime. 
```

有人知道这里有什么问题吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-26T15:33:40.647

你可以使用`DateTime.ParseExact()`它。例如

更新：

```
string dateString = "Your date";
string format = "ddd MMM dd HH:mm:ss yyyy %K";
DateTime dateTime = DateTime.ParseExact(dateString, format, 
              CultureInfo.InvariantCulture);
Console.WriteLine(dateTime); 
```

**[此处的文档和此处](http://msdn.microsoft.com/en-us/library/w2sa9yss.aspx)**的[字符串](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx)`DateTime`格式选项。

**[您也可以在这里查看 {Complr.com}](https://compilr.com/johntotetwoo/datetimeparseexact/main.cs)**

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-26T15:37:18.757

您需要指定解析格式，因为这是非标准的。`DateTime.ParseExact`允许您指定格式。

像这样的东西会起作用，~~但是我还没有验证那个时区部分是否工作正常，似乎给了我一个 1800 小时的日期/时间......~~啊，这是因为我所在的地方是 BST（格林威治标准时间 + 1）。

```
 static void Main(string[] args)
    {
        string date = "Wed Jul 25 19:41:36 2012 +0200";
        string format = "ddd MMM dd HH:mm:ss yyyy %K";
        //string format = "ddd MMM dd HH:mm:ss yyyy zzz"; // Also works.
        DateTime dateTime = DateTime.ParseExact(date, format, CultureInfo.InvariantCulture);
        Console.ReadLine();
    } 
```

`DateTime`[此处](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx)记录了字符串格式化选项，您可以使用这些的任意组合创建解析字符串以`DateTime`成功解析。

另一个例子可以在这里找到：[Parse DateTime From Odd Format](https://stackoverflow.com/questions/11473523/parse-datetime-from-odd-format/11473602#11473602)

# asp.net-mvc-3 - 带有 ninject 的插件架构——将类和控制器实例从插件程序集加载到主 MVC 项目

> ID：11672794
> 
> 赞同：2
> 
> 时间：2012-07-26T15:31:08.863
> 
> 标签：asp.net-mvc-3, plugins, ninject

我使用本教程在我的解决方案中创建插件架构，并且我也是第一次使用 ninject：

[http://www.codeproject.com/script/Articles/ArticleVersion.aspx?aid=358360&av=526320&msg=4308834#xx4308834xx](http://www.codeproject.com/script/Articles/ArticleVersion.aspx?aid=358360&av=526320&msg=4308834#xx4308834xx)

现在在 MVC 应用程序中，当用户正在结帐时，我得到了他选择的付款方式，并且需要检索所选付款方式的插件。我已经成功地以这种方式检索插件控制器，但我不知道这是否安全或可接受的做法：

```
Type type = Type.GetType(paymentMethod.PaymentMethodPluginType);  

 //get plugin controller

var paymentController = ServiceLocator.Current.GetInstance(type) as BasePaymentController;

//get validations from plugin

    var warnings = paymentController.ValidatePaymentForm(form);

        //get payment info from plugin

        var paymentInfo = paymentController.GetPaymentInfo(form);
        //… 
```

我还需要访问一个插件类来处理付款。我有一个接口 IPaymentMethod

```
 public partial interface IPaymentMethod 
  {
   void  PostProcessPayment (PostProcessPaymentRequest postprocessPaymentRequest);        

  } 
```

和插件 PaymentProcessor 像这样

```
public class PluginPaymentProcessor :IPaymentMethod
    {        
        public void PostProcessPayment (PostProcessPaymentRequest postprocessPaymentRequest)
        {
            ///
        }

Now in MVC project I try to access PostProcessPayment method this way 

IPaymentMethod pluginpaymentmethod = ServiceLocator.Current.GetInstance<IPaymentMethod>(paymentMethod.PaymentProcessor); 
```

这里 paymentMethod.PaymentProcessor 是“MyApp.Plugins.MyPlugin.PluginPaymentProcessor, MyApp.Plugins.MyPlugin,Version=1.0.0.0,Culture=neutral,PublicKeyToken=null”</p>

```
 And want to use pluginpaymentmethod like i do in controller example

pluginpaymentmethod.PostProcessPayment(postProcessPaymentRequest); 
```

但它会引发错误，即找不到资源并且未加载 pluginpaymentmethod。我该如何解决它，或者您可以建议任何具有类似实现的教程？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T15:50:16.250

假设您有一个名为`MyPlugin`的具有`IPaymentMethod`接口的具体类，那么您的 ninject 绑定应该看起来有点像：

```
private static void RegisterServices(IKernel kernel){
    kernel.Bind<IPaymentMethod>().To<MyPlugin>().InRequestScope();
} 
```

检查这在文件夹`NinjectWebCommon.cs`下的班级中是否存在。`App_Start`一个更棘手的场景可能是必须以与绑定`IPaymentMethod`Ninject 相同的方式注册：`IKernel`

```
kernel.Bind<Func<IKernel>>().ToMethod(ctx => () => new Bootstrapper().Kernel); 
```

这可能是一个更棘手的问题。

# c++ - C ++程序使不可见且不显示在桌面上

> ID：11672795
> 
> 赞同：-1
> 
> 时间：2012-07-26T15:31:19.727
> 
> 标签：c++

我可以做的英语说得不好，我希望能明白我想要什么。我仍在尝试制作一个隐形程序，但该程序没有任何结果可以使隐形。我需要一个使程序对桌面不可见的程序。该程序应包含在其流程中，并在您使用姓名付款的情况下进行。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T15:34:25.747

如果你在 Windows 上，我认为你需要看看编写[Services](http://msdn.microsoft.com/en-us/library/y817hyb6%28v=vs.80%29.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T15:34:26.793

您没有指定操作系统。在 UNIX/Linux 中，名称以“.”开头的文件。默认不列出或呈现。

# jquery - 以编程方式更改 highcharts 样条系列的颜色？

> ID：11672801
> 
> 赞同：0
> 
> 时间：2012-07-26T15:31:35.750
> 
> 标签：jquery, highcharts

我有一个样条系列。它的颜色是蓝色。根据某些情况，我想将其颜色更改为绿色或红色。怎么做。我尝试了以下方式，但没有奏效

```
var rawChart = Ext.ComponentQuery.query('kpiprojectrawvaluechart')[0];
var upperSeries = rawChart.series[0];
var lowerSeries = rawChart.series[2];

if(status == 'danger'){
  upperSeries.color = 'red';
}
else {
 upperSeries.color = 'green';
}

rawChart.refresh(); 
```

请帮我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T04:17:04.440

您可以使用：

```
chart.series[0].graph.attr('stroke', 'green'); 
```

这是小提琴链接：http: [//jsfiddle.net/mhardik/BCH9t/](http://jsfiddle.net/mhardik/BCH9t/)

# java - 使用纯 Java 代理 API 时无法连接到策略服务器

> ID：11672805
> 
> 赞同：1
> 
> 时间：2012-07-26T15:31:53.690
> 
> 标签：java, api, agent, siteminder

过去几周我一直在使用 JNI 代理，在添加对 dll 和 jar 的引用后，它对我来说工作正常。最近我尝试通过更改 JAR 将其更改为纯 Java 代理。我收到以下错误：

> 致命：尝试连接到策略服务器失败。确保 smjsdkexample.properties 中的代理名称和共享密钥与策略库中预先存在的代理相匹配。

# android - 相机意图返回 Null

> ID：11672806
> 
> 赞同：1
> 
> 时间：2012-07-26T15:31:53.683
> 
> 标签：android, android-intent, android-camera-intent

我正在尝试使用 Intent 使用默认相机从我的 android 应用程序中捕获图像和视频。

```
Intent intent = new Intent("android.media.action.IMAGE_CAPTURE");

            startActivityForResult(intent, IMAGE_FROM_CAMERA); 
```

使用上面的代码，我尝试捕获图像，并在`onActivityResult`数据中获取 Null`data.getData()`

我尝试有意传递 Uri，但 Uri 变空了。

相机意图无法在 uri 上写入图像。我需要 uri 用电子邮件发送图像视频。

**错误日志**

```
 07-26 21:16:54.125: E/AndroidRuntime(6142): java.lang.RuntimeException: Failure    delivering result ResultInfo{who=null, request=1, result=-1, data=Intent { act=inline-data (has extras) }} to activity {com.cam/com.cam.CameraDemoActivity}: java.lang.NullPointerException
  07-26 21:16:54.125: E/AndroidRuntime(6142):   at android.app.ActivityThread.deliverResults(ActivityThread.java:3712)
  07-26 21:16:54.125: E/AndroidRuntime(6142):   at android.app.ActivityThread.handleSendResult(ActivityThread.java:3754)
07-26 21:16:54.125: E/AndroidRuntime(6142):     at android.app.ActivityThread.access$2800(ActivityThread.java:135)
07-26 21:16:54.125: E/AndroidRuntime(6142):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2162)
07-26 21:16:54.125: E/AndroidRuntime(6142):     at android.os.Handler.dispatchMessage(Handler.java:99)
07-26 21:16:54.125: E/AndroidRuntime(6142):     at android.os.Looper.loop(Looper.java:143)
07-26 21:16:54.125: E/AndroidRuntime(6142):     at android.app.ActivityThread.main(ActivityThread.java:4914)
07-26 21:16:54.125: E/AndroidRuntime(6142):     at java.lang.reflect.Method.invokeNative(Native Method)
07-26 21:16:54.125: E/AndroidRuntime(6142):     at java.lang.reflect.Method.invoke(Method.java:521)
07-26 21:16:54.125: E/AndroidRuntime(6142):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
07-26 21:16:54.125: E/AndroidRuntime(6142):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
  07-26 21:16:54.125: E/AndroidRuntime(6142):   at dalvik.system.NativeStart.main(Native Method)
   07-26 21:16:54.125: E/AndroidRuntime(6142): Caused by: java.lang.NullPointerException
   07-26 21:16:54.125: E/AndroidRuntime(6142):  at com.cam.CameraDemoActivity.onActivityResult(CameraDemoActivity.java:48)
  07-26 21:16:54.125: E/AndroidRuntime(6142):   at android.app.Activity.dispatchActivityResult(Activity.java:3931)
   07-26 21:16:54.125: E/AndroidRuntime(6142):  at android.app.ActivityThread.deliverResults(ActivityThread.java:3708)
   07-26 21:16:54.125: E/AndroidRuntime(6142):  ... 11 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:34:45.667

```
Intent cameraIntent = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE);
 File dir = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DCIM);
 File output = new File(dir, "camerascript.png");
 cameraIntent.putExtra(MediaStore.EXTRA_OUTPUT,Uri.fromFile(output));
startActivityForResult(cameraIntent, 1); 
```

# mysql - MySQL：如何使用两个相同的子查询优化查询？

> ID：11672808
> 
> 赞同：0
> 
> 时间：2012-07-26T15:31:57.713
> 
> 标签：mysql

我的查询工作正常，但它有 2 个相同的子查询

```
SELECT *, 
    (SELECT count(O.id) FROM `offer` O WHERE O.product_id = P.id) AS poffers 
FROM `product` P 
JOIN product_section PS ON (PS.product_id = P.id AND PS.section_id IN (14)) 
WHERE P.deleted is NULL 
    AND (SELECT count(O.id) FROM `offer` O WHERE O.product_id = P.id) > 0 
```

我尝试使用 JOIN 进行优化，但新查询返回空结果

```
SELECT *, OJ.pcount AS poffers
FROM `product` P 
JOIN product_section PS ON PS.product_id = P.id AND PS.section_id IN (14)
JOIN (SELECT count(O.id) AS pcount, O.product_id FROM `offer` O ) 
    AS OJ ON OJ.product_id = P.id
WHERE P.deleted is NULL AND OJ.pcount > 0 
```

比我尝试变量，但我认为我用错了，查询返回空结果

```
SELECT *,  
    @o := (SELECT count(O.id) FROM `offer` O WHERE O.product_id = P.id) 
    AS poffers 
FROM `product` P 
JOIN product_section PS ON (PS.product_id = P.id AND PS.section_id IN (14)) 
WHERE P.deleted is NULL 
    AND @o > 0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:38:21.813

试一试（未测试）

```
SELECT P.*,PS.*,count(O.id) AS oCount
FROM `product` P
INNER JOIN `product_section` PS ON (PS.product_id = P.id)
INNER JOIN `offer` O ON (O.product_id = P.id) 
WHERE P.deleted is NULL AND PS.section_id =14
GROUP BY O.product_id
HAVING oCount> 0 
```

更优化

```
SELECT P.*,PS.*,count(O.id) AS oCount
FROM `product` P
INNER JOIN (`product_section` PS,`offer` O) ON 
(PS.product_id = P.id AND O.product_id = P.id) 
WHERE P.deleted is NULL AND PS.section_id =14
GROUP BY O.product_id
HAVING oCount> 0 
```

**尖端：**

*   不要使用`*`，而是只写那些你想检索的列名
*   `ON`对使用 with &`WHERE`条件的所有列进行索引

[`Reference`](http://dev.mysql.com/doc/refman/5.0/en/join.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T16:13:17.417

避免依赖子查询。相反，有一个查询将产品与报价计数相关联。您可以在多个地方使用此查询。它很可能会临时存储在内存中，避免重复计算，但数据库引擎也可能会做更聪明的事情。

```
SELECT *, O.cnt AS poffers
FROM product P
JOIN product_section PS ON (PS.product_id = P.id AND PS.section_id IN (14))
JOIN (SELECT product_id, count(id) AS cnt
      FROM offer
      GROUP BY product_id
     ) O ON (O.product_id = P.id)
WHERE P.deleted is NULL AND O.cnt > 0 
```

如果 P 和 PS 之间的关系是一对一的，那么您甚至可以在没有任何子查询的情况下工作：

```
SELECT *, COUNT(O.id) AS poffers
FROM product P
JOIN product_section PS ON (PS.product_id = P.id AND PS.section_id IN (14))
JOIN offer O ON (O.product_id = P.id)
WHERE P.deleted is NULL
GROUP BY P.id 
```

您还应该考虑是否有充分的理由计算特定列。在大多数情况下，`COUNT(*)`会比`COUNT(col)`. 使用后者的唯一原因是如果您明确想要`NULL`从计数中排除值。

# vba - VBA Word：从导航窗格中删除部分

> ID：11672809
> 
> 赞同：0
> 
> 时间：2012-07-26T15:32:10.580
> 
> 标签：vba, ms-word, word-2010

我正在尝试使用 VBA 代码从 Word 文档中删除标题中包含的部分。在我的情况下，一个部分是指屏幕左侧导航窗格中的列表。

例如，我会搜索“Introduction”的顶级标题并将其删除，然后下一个顶级标题将是“Body”，其下方有三个小节。我会选择“正文”部分并将其删除。在 Word 本身中很容易做到这一点，但我想通过 VBA 来做到这一点。我曾尝试在从导航窗格中删除时录制宏，但它没有录制任何内容。

编辑：或者，能够使用 VBA 突出显示标题，以及它下面的所有内容以及大小相等或更大的标题，也可以使用。

非常感谢任何想法或建议，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T12:11:20.400

“录制宏”功能不会录制任何内容，因为您只能使用鼠标选择部分。众所周知，“录制宏”工具不适用于鼠标。我在 Word 中尝试了不同的方法来解决问题。我认为，正如您在编辑中已经指出的那样，最简单和最简单的方法是删除下面的所有文本，直到到达另一个标题或文本结尾：

```
Selection.Find.ClearFormatting
With Selection.Find
    .Text = "Introduction"
    .Replacement.Text = ""
    .Forward = True
    .Wrap = wdFindContinue
    .Format = False
    .MatchCase = False
    .MatchWholeWord = False
    .MatchKashida = False
    .MatchDiacritics = False
    .MatchAlefHamza = False
    .MatchControl = False
    .MatchWildcards = False
    .MatchSoundsLike = False
    .MatchAllWordForms = False
End With
Selection.Find.Execute
unitsDeleted = Selection.Delete(wdCharacter, 2)
While (Selection.Style <> ActiveDocument.Styles("Heading 1")) And (unitsDeleted <> 0)
     unitsDeleted = Selection.Delete
Wend 
```

换句话说，是在您的文档中搜索“介绍”字符串。然后删除所有字符，直到当前字符的样式为“标题 1”（或您指定的另一种样式）。您也可以搜索具有特定样式的“介绍”字样，例如“标题 1”。录制一个宏，并检查它是如何执行的。

# jquery - 如何在 .html() 中调用 .html()？

> ID：11672810
> 
> 赞同：0
> 
> 时间：2012-07-26T15:32:11.717
> 
> 标签：jquery

我需要创建这样的东西。当我单击图像时，它将触发下面的脚本。

```
$("#txtHint").html("<form action='inline_spec.php' id = 'upLoadForm' method='post' enctype='multipart/form-data'><center><input type='text' id='file' name = 'file' style='visibility:show' ></center></form>"); 
```

该脚本将打开一个文本文件输入表单。提交表单后，我需要在 txtHint 中显示结果。可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T15:44:46.953

除非您使用 AJAX 提交表单，否则您将无法输入结果`upLoadForm`。`#textHint`请参阅[jQuery 表单插件](http://jquery.malsup.com/form/)了解如何执行此操作。将 jQuery Form Plugin 添加到页面中，然后用它替换您的 JS 行。

```
var $hint = $("#txtHint");
var $form = $("<form action='inline_spec.php' id = 'upLoadForm' method='post' enctype='multipart/form-data'></form>")
                .appendTo($hint)
                .html("<center><input type='text' id='file' name = 'file' style='visibility:show' ></center>")
                .ajaxForm(function(response)
                {
                    $hint.html('Response from form post:<br/>' + response)
                }); 
```

# xml - xslt 中的值增量

> ID：11672811
> 
> 赞同：1
> 
> 时间：2012-07-26T15:32:15.620
> 
> 标签：xml, xslt, xpath

我需要根据属性增加 xslt 中的值。假设我的xml是这样的，

```
 <comp>
   <fig xml:id="c1-fig-001"/>
   <fig xml:id="c1-fig-002"/>
   <fig xml:id="c1-fig-003"/>
   <fig xml:id="c1-fig-004" resumeatnum="7"/>
   <fig xml:id="c1-fig-005"/>
   <fig xml:id="c1-fig-006"/>
   <fig xml:id="c1-fig-007" resumeatnum="18"/>
   <fig xml:id="c1-fig-008"/>
   <fig xml:id="c1-fig-009"/>
   </comp> 
```

我需要这样的输出，

```
<comp>
<fig xml:id="c1-fig-001"/>
<fignum>1.1</fignum>
<fig xml:id="c1-fig-002"/>
<fignum>1.2</fignum>
<fig xml:id="c1-fig-003"/>
<fignum>1.3</fignum>
<fig xml:id="c1-fig-004" resumeatnum="7"/>
<fignum>1.7</fignum>
<fig xml:id="c1-fig-005"/>
<fignum>1.8</fignum>
<fig xml:id="c1-fig-006"/>
<fignum>1.9</fignum>
<fig xml:id="c1-fig-007" resumeatnum="18"/>
<fignum>1.18</fignum>
<fig xml:id="c1-fig-008"/>
<fignum>1.19</fignum>
<fig xml:id="c1-fig-009"/>
<fignum>1.20</fignum>
</comp> 
```

我需要从`xml:id`像`1`from这样的属性中获取值，`c1`然后从后面的数字中获取另一个数字`fig`。

如果有一个属性`resumeatnum`，那么我需要使用该值而不是正常值并增加下一个节点的值。请提供 xslt 来执行此操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T22:35:19.747

以下 XSLT 2.0 样式表：

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
  xmlns:xs="http://www.w3.org/2001/XMLSchema" 
  exclude-result-prefixes="xs" 
  version="2.0">

  <xsl:template match="comp">
    <xsl:for-each-group select="fig" group-starting-with="*[@resumeatnum]">
      <xsl:variable name="base" select="(@resumeatnum, 1)[1] - 1"/>
      <xsl:for-each select="current-group()">
        <xsl:copy-of select="."/>
        <fignum>1.<xsl:value-of select="position()+$base"/></fignum>
      </xsl:for-each>
    </xsl:for-each-group>
  </xsl:template>

</xsl:stylesheet> 
```

产生以下输出：

```
<?xml version="1.0" encoding="UTF-8"?>
<fig xml:id="c1-fig-001"/>
<fignum>1.1</fignum>
<fig xml:id="c1-fig-002"/>
<fignum>1.2</fignum>
<fig xml:id="c1-fig-003"/>
<fignum>1.3</fignum>
<fig xml:id="c1-fig-004" resumeatnum="7"/>
<fignum>1.7</fignum>
<fig xml:id="c1-fig-005"/>
<fignum>1.8</fignum>
<fig xml:id="c1-fig-006"/>
<fignum>1.9</fignum>
<fig xml:id="c1-fig-007" resumeatnum="18"/>
<fignum>1.18</fignum>
<fig xml:id="c1-fig-008"/>
<fignum>1.19</fignum>
<fig xml:id="c1-fig-009"/>
<fignum>1.20</fignum> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T04:42:33.400

**这是一个更短（33 个格式良好的短行）和更简单的 XSLT 1.0 解决方案（三个短模板， no `substring()`​​， no `substring-before()`​​，no complex and long ，多行表达式， no `concat()`​​， no `xsl:for-each`​​， no `xsl:if`​​， no `xsl:variable`​​， no `string-length()`​​， no`xsl:call-template`** ​​：

```
<xsl:stylesheet version="1.0"  xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:key name="kFollowing" match="fig[not(@resumeatnum)]"
      use="generate-id((preceding-sibling::*[@resumeatnum][1]
                      |
                        ..
                        )[last()]
                      )"/>

 <xsl:template match="/*">
  <comp>
   <xsl:apply-templates select="key('kFollowing', generate-id())"/>
   <xsl:apply-templates select="fig[@resumeatnum]"/>
  </comp>
 </xsl:template>

 <xsl:template match="fig">
  <xsl:param name="pStart" select="1"/>

  <fig xml:id="{@xml:id}"/>
   <fignum>1.<xsl:value-of select="position() + $pStart -1"/></fignum>
 </xsl:template>

 <xsl:template match="fig[@resumeatnum]">
   <fig xml:id="{@xml:id}" resumeatnum="{@resumeatnum}"/>
   <fignum>1.<xsl:value-of select="@resumeatnum"/></fignum>
  <xsl:apply-templates select="key('kFollowing', generate-id())">
   <xsl:with-param name="pStart" select="@resumeatnum+1"/>
  </xsl:apply-templates>
 </xsl:template>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时：**

```
<comp>
    <fig xml:id="c1-fig-001"/>
    <fig xml:id="c1-fig-002"/>
    <fig xml:id="c1-fig-003"/>
    <fig xml:id="c1-fig-004" resumeatnum="7"/>
    <fig xml:id="c1-fig-005"/>
    <fig xml:id="c1-fig-006"/>
    <fig xml:id="c1-fig-007" resumeatnum="18"/>
    <fig xml:id="c1-fig-008"/>
    <fig xml:id="c1-fig-009"/>
</comp> 
```

**产生了想要的正确结果**：

```
<comp>
   <fig xml:id="c1-fig-001"/>
   <fignum>1.1</fignum>
   <fig xml:id="c1-fig-002"/>
   <fignum>1.2</fignum>
   <fig xml:id="c1-fig-003"/>
   <fignum>1.3</fignum>
   <fig xml:id="c1-fig-004" resumeatnum="7"/>
   <fignum>1.7</fignum>
   <fig xml:id="c1-fig-005"/>
   <fignum>1.8</fignum>
   <fig xml:id="c1-fig-006"/>
   <fignum>1.9</fignum>
   <fig xml:id="c1-fig-007" resumeatnum="18"/>
   <fignum>1.18</fignum>
   <fig xml:id="c1-fig-008"/>
   <fignum>1.19</fignum>
   <fig xml:id="c1-fig-009"/>
   <fignum>1.20</fignum>
</comp> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T20:30:36.367

另一种方法是从匹配第一个**fig**元素开始

```
<xsl:apply-templates select="fig[1]"/> 
```

然后你有一个主模板来匹配**无花果**元素，但有一个参数将保存“递增”值。请注意，它还充当命名模板。

```
<xsl:template match="fig" name="fig">
   <xsl:param name="sequence" select="1"/> 
```

在此您可以输出您的**fignum**元素

```
<fignum>
   <xsl:value-of 
      select="concat(substring-before(substring(@xml:id, 2, string-length(@xml:id) - 1), '-'), '.', $sequence)"/>
</fignum> 
```

然后你会匹配下一个**无花果**元素，增加参数的值

```
 <xsl:apply-templates select="following-sibling::fig[1]">
     <xsl:with-param name="sequence" select="$sequence + 1"/>
  </xsl:apply-templates> 
```

要重置序列，您只需有一个与具有相关属性的**fig**元素匹配的模板，您只需调用具有属性值的命名模板即可覆盖它

```
<xsl:template match="fig[@resumeatnum != '']">
   <xsl:call-template name="fig">
      <xsl:with-param name="sequence" select="@resumeatnum"/>
   </xsl:call-template>
</xsl:template> 
```

这是完整的 XSLT

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
   <xsl:output method="xml" indent="yes"/>

   <xsl:template match="comp">
      <comp>
         <xsl:apply-templates select="fig[1]"/>
      </comp>
   </xsl:template>

   <xsl:template match="fig[@resumeatnum != '']">
      <xsl:call-template name="fig">
         <xsl:with-param name="sequence" select="@resumeatnum"/>
      </xsl:call-template>
   </xsl:template>

   <xsl:template match="fig" name="fig">
      <xsl:param name="sequence" select="1"/>
      <fig>
         <xsl:apply-templates select="@*"/>
         <fignum>
            <xsl:value-of select="concat(substring-before(substring(@xml:id, 2, string-length(@xml:id) - 1), '-'), '.', $sequence)"/>
         </fignum>
      </fig>
      <xsl:apply-templates select="following-sibling::fig[1]">
         <xsl:with-param name="sequence" select="$sequence + 1"/>
      </xsl:apply-templates>
   </xsl:template>

   <xsl:template match="@*|node()">
      <xsl:copy>
         <xsl:apply-templates select="@*|node()"/>
      </xsl:copy>
   </xsl:template>
</xsl:stylesheet> 
```

应用于您的示例 XML 时，将输出以下内容

```
<comp>
   <fig xml:id="c1-fig-001">
      <fignum>1.1</fignum>
   </fig>
   <fig xml:id="c1-fig-002">
      <fignum>1.2</fignum>
   </fig>
   <fig xml:id="c1-fig-003">
      <fignum>1.3</fignum>
   </fig>
   <fig xml:id="c1-fig-004" resumeatnum="7">
      <fignum>1.7</fignum>
   </fig>
   <fig xml:id="c1-fig-005">
      <fignum>1.8</fignum>
   </fig>
   <fig xml:id="c1-fig-006">
      <fignum>1.9</fignum>
   </fig>
   <fig xml:id="c1-fig-007" resumeatnum="18">
      <fignum>1.18</fignum>
   </fig>
   <fig xml:id="c1-fig-008">
      <fignum>1.19</fignum>
   </fig>
   <fig xml:id="c1-fig-009">
      <fignum>1.20</fignum>
   </fig>
</comp> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T16:56:22.817

像这样的东西可能会起作用

```
<xsl:for-each select="/comp/fig">
    <fignum>1.<xsl:value-of select="substring(@xml:id,string-length(@xml:id),1)"/>1</fignum>
</xsl:for-each> 
```

有一段时间没有使用 xslt/xpath，所以可能并不完美。基本上只是循环遍历 fig 节点并为最后一个字符添加子字符串。如果要循环的节点超过 9 个，则必须更改子字符串以获取所有数字

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-26T19:26:57.607

PigChicken，我认为他是在要求基于先前的 [如果存在] resumeatnum 属性具有修改自动增量功能的东西。通过为主要和次要版本组件创建变量，然后将简历中的“偏移量”添加到相应的次要版本，以下内容非常适用于给定的示例。例如，次要版本为 7 的 resumeatnum 为 18 给出的偏移量为 11，它也会添加到以下次要版本中。我使用了 number() 演员表，其中一些可能会被删除。这是变换：

```
<?xml version="1.0" encoding="UTF-8"?>

<xsl:stylesheet version="1.1" exclude-result-prefixes="" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="xml" indent="yes" omit-xml-declaration="no"/>
    <xsl:template match="/comp">
        <comp>
            <xsl:for-each select="./fig">
                <xsl:copy-of select="."/>
                <xsl:variable name="major">
                    <xsl:value-of select="substring-after(substring-before(./@xml:id,'-'),'c')"/>
                </xsl:variable>
                <xsl:variable name="minor">
                    <xsl:value-of select="number(substring-after(./@xml:id,'fig-'))"/>
                </xsl:variable>
                <xsl:variable name="resume_offset">
                    <xsl:if test="./@resumeatnum">
                        <xsl:value-of select="number(./@resumeatnum - $minor)"/>
                    </xsl:if>
                    <xsl:if test="not(./@resumeatnum)">
                        <xsl:if test="./preceding-sibling::*[@resumeatnum]">
                            <xsl:value-of select="number(./preceding-sibling::*[@resumeatnum][1]/@resumeatnum) - number(substring-after(./preceding-sibling::*[@resumeatnum][1]/@xml:id,'fig-'))"/>
                        </xsl:if>
                        <xsl:if test="not(./preceding-sibling::*[@resumeatnum])">
                            <xsl:value-of select="number(0)"/>
                        </xsl:if>
                    </xsl:if>
                </xsl:variable>
                <fignum>
                    <xsl:value-of select="$major"/>
                    <xsl:text>.</xsl:text>
                    <xsl:value-of select="$minor+$resume_offset"/>
                </fignum>
            </xsl:for-each>
        </comp>
    </xsl:template>
</xsl:stylesheet> 
```

# c# - Code First 迁移和初始化错误

> ID：11672812
> 
> 赞同：25
> 
> 时间：2012-07-26T15:32:15.453
> 
> 标签：c#, ef-code-first, sql-server-ce-4, entity-framework-migrations

我不确定如何使用代码优先迁移功能。据我了解，如果它不存在，它应该创建我的数据库，并根据迁移文件将其更新为最新模式。但我正在为此苦苦挣扎，因为我总是遇到很多错误，而且我不确定总体上如何正确使用它..

```
internal class Program
{
    private static void Main()
    {
        EntityFrameworkProfiler.Initialize();

        Database.DefaultConnectionFactory = new SqlCeConnectionFactory("System.Data.SqlServerCe.4.0");
        Database.SetInitializer(new MigrateDatabaseToLatestVersion<MyContext, Migrations.Configuration>());

        using (var context = new MyContext())
        {
            var exists = context.Database.Exists();
            if (!exists)
            {
                context.Database.Create();
            }

            var element = context.Dummies.FirstOrDefault();
        }
    }
}

public class MyContext : DbContext
{
    public MyContext()
        : base(string.Format(@"DataSource=""{0}""", @"C:\Users\user\Desktop\MyContext.sdf"))
    {
    }

    public DbSet<Dummy> Dummies { get; set; }
}

internal sealed class Configuration : DbMigrationsConfiguration<MyContext>
{
    public Configuration()
    {
        AutomaticMigrationsEnabled = true;
    }

    protected override void Seed(CodeFirstTest.MyContext context)
    {
    }
} 
```

使用 Entity Framework Profiler 我检查执行了哪些语句。当我在不存在数据库的情况下运行程序时，我得到以下输出：

> -- 语句#1 SELECT [GroupBy1].[A1] AS [C1] FROM (SELECT COUNT(1) AS [A1] FROM [__MigrationHistory] ​​AS [Extent1]) AS [GroupBy1]
> 
> -- 语句#2 WARN: System.Data.SqlServerCe.SqlCeException (0x80004005): 指定的表不存在。[ __MigrationHistory ] 在 System.Data.SqlServerCe.SqlCeCommand.CompileQueryPlan() 在 System.Data.SqlServerCe.SqlCeCommand.ProcessResults(Int32 hr) 在 System.Data.SqlServerCe.SqlCeCommand.ExecuteCommand(CommandBehavior 行为，字符串方法，ResultSetOptions 选项) 在System.Data.SqlServerCe.SqlCeCommand.ExecuteReader(CommandBehavior 行为) 在 System.Data.SqlServerCe.SqlCeMultiCommand.ExecuteReader(CommandBehavior 行为) 在 System.Data.SqlServerCe.SqlCeMultiCommand.ExecuteDbDataReader(CommandBehavior 行为) 在 HibernatingRhinos.Profiler.Appender.ProfiledDataAccess。 ProfiledCommand.ExecuteDbDataReader（CommandBehavior 行为）
> 
> -- 语句#3 SELECT [GroupBy1].[A1] AS [C1] FROM (SELECT COUNT(1) AS [A1] FROM [__MigrationHistory] ​​AS [Extent1]) AS [GroupBy1]
> 
> -- 语句#4 WARN: System.Data.SqlServerCe.SqlCeException (0x80004005): 指定的表不存在。[ __MigrationHistory ] 在 System.Data.SqlServerCe.SqlCeCommand.CompileQueryPlan() 在 System.Data.SqlServerCe.SqlCeCommand.ProcessResults(Int32 hr) 在 System.Data.SqlServerCe.SqlCeCommand.ExecuteCommand(CommandBehavior 行为，字符串方法，ResultSetOptions 选项) 在System.Data.SqlServerCe.SqlCeCommand.ExecuteReader(CommandBehavior 行为) 在 System.Data.SqlServerCe.SqlCeMultiCommand.ExecuteReader(CommandBehavior 行为) 在 System.Data.SqlServerCe.SqlCeMultiCommand.ExecuteDbDataReader(CommandBehavior 行为) 在 HibernatingRhinos.Profiler.Appender.ProfiledDataAccess。 ProfiledCommand.ExecuteDbDataReader（CommandBehavior 行为）
> 
> -- 语句#5 SELECT [GroupBy1].[A1] AS [C1] FROM (SELECT COUNT(1) AS [A1] FROM [__MigrationHistory] ​​AS [Extent1]) AS [GroupBy1]
> 
> -- 语句#6 WARN: System.Data.SqlServerCe.SqlCeException (0x80004005): 指定的表不存在。[ __MigrationHistory ] 在 System.Data.SqlServerCe.SqlCeCommand.CompileQueryPlan() 在 System.Data.SqlServerCe.SqlCeCommand.ProcessResults(Int32 hr) 在 System.Data.SqlServerCe.SqlCeCommand.ExecuteCommand(CommandBehavior 行为，字符串方法，ResultSetOptions 选项) 在System.Data.SqlServerCe.SqlCeCommand.ExecuteReader(CommandBehavior 行为) 在 System.Data.SqlServerCe.SqlCeMultiCommand.ExecuteReader(CommandBehavior 行为) 在 System.Data.SqlServerCe.SqlCeMultiCommand.ExecuteDbDataReader(CommandBehavior 行为) 在 HibernatingRhinos.Profiler.Appender.ProfiledDataAccess。 ProfiledCommand.ExecuteDbDataReader（CommandBehavior 行为）
> 
> -- 语句 #7 SELECT [GroupBy1].[A1] AS [C1] FROM (SELECT COUNT(1) AS [A1] FROM [__MigrationHistory] ​​AS [Extent1]) AS [GroupBy1]
> 
> -- 语句#8 WARN: System.Data.SqlServerCe.SqlCeException (0x80004005): 指定的表不存在。[ __MigrationHistory ] 在 System.Data.SqlServerCe.SqlCeCommand.CompileQueryPlan() 在 System.Data.SqlServerCe.SqlCeCommand.ProcessResults(Int32 hr) 在 System.Data.SqlServerCe.SqlCeCommand.ExecuteCommand(CommandBehavior 行为，字符串方法，ResultSetOptions 选项) 在System.Data.SqlServerCe.SqlCeCommand.ExecuteReader(CommandBehavior 行为) 在 System.Data.SqlServerCe.SqlCeMultiCommand.ExecuteReader(CommandBehavior 行为) 在 System.Data.SqlServerCe.SqlCeMultiCommand.ExecuteDbDataReader(CommandBehavior 行为) 在 HibernatingRhinos.Profiler.Appender.ProfiledDataAccess。 ProfiledCommand.ExecuteDbDataReader（CommandBehavior 行为）
> 
> -- 语句 #9 以隔离级别开始事务：可序列化
> 
> -- 语句 #10 CREATE TABLE [Dummies] ([Name] nvarchar NOT NULL, CONSTRAINT [PK_Dummies] PRIMARY KEY ([Name]) )
> 
> -- 语句 #11 CREATE TABLE [ **MigrationHistory] ​​( [MigrationId] nvarchar NOT NULL, [CreatedOn] [datetime] NOT NULL, [Model] [image] NOT NULL, [ProductVersion] nvarchar NOT NULL, CONSTRAINT [PK** _MigrationHistory] ​​PRIMARY KEY ([MigrationId]) )
> 
> -- 语句 #12 INSERT INTO [__MigrationHistory] ​​([MigrationId], [CreatedOn], [Model], [ProductVersion]) VALUES ('201207261524579_InitialCreate', '2012-07-26T15:24:58.523', 0x1F8B080 , '4.3\. 1')
> 
> -- 语句#13 提交事务
> 
> -- 语句 #14 SELECT TOP (1) [c].[Name] AS [Name] FROM [Dummies] AS [c]

如您所见，它在实际创建数据库之前尝试访问数据库**四次。**这似乎不对。当我使用现有数据库启动应用程序时，它会在执行任何实际查询之前查询数据库 7 次。请注意，这发生在`context.Database.Create()`，而不是`.Exists()`。

我的配置的种子方法也从未被调用，但构造函数是。

这一切似乎都非常错误和令人困惑。我希望有人能告诉我为什么错误在一开始经常发生，为什么我的种子方法根本没有被调用。

我正在使用 SqlServer compact 和 Entity Framework 的最新稳定版本。

> 包 id="EntityFramework" 版本="4.3.1" targetFramework="net40"
> 
> 包 id="Microsoft.SqlServer.Compact" 版本="4.0.8854.2" targetFramework="net40"

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-10T17:50:54.407

似乎有很多方法可以配置实体框架，每个人都有自己的看法。我所能提供的只是基于我们在工作中标准化的内容。其中很多是开发人员的偏好。我的偏好恰好是尽可能地控制，所以我总是能准确地了解发生了什么以及何时发生。

## 自动迁移

首先，虽然自动迁移可能很方便，但它们会带来很多麻烦，特别是随着项目的增长和/或数据变得更加复杂。在我看来，任何商业/生产系统都应该有比这更多的控制权。我们总是通过设置关闭所有主要项目的自动迁移`AutomaticMigrationsEnabled = false;`。我们在需要时显式运行迁移（在开发中，这是在 Visual Studio 的包管理器控制台中通过键入`Update-Database`和在生产中我们编写了自己的小迁移实用程序，它只是显式调用迁移到最新代码 - 但没有一个是自动的）。

@Terric 的回答让我感到害怕，因为允许自动迁移和数据丢失！我不想成为部署解决方案并清除一些重要数据的人，因为执行不当的列更改会导致数据丢失。附带说明一下，当我们在 dev 中显式地执行迁移时，我经常使用 -v 开关来进行详细输出 ( `Update-Database -v`)。这让您可以看到正在执行的 SQL 以及任何失败/警告（如果合适）。

根据我们的经验，在多次迁移到开发后更改这些设置并不顺利。我不确定这是在哪里被跟踪的，但是在禁用自动迁移的情况下重新开始一个项目可以确保不会发生任何意外。

就个人而言，我会删除您拥有的初始化程序，`MigrateDatabaseToLatestVersion`并在我想要的时候自己运行迁移器（通过包管理器控制台或通过我自己的显式代码某处）。

## 如果数据库不存在则创建数据库

这种行为是由 DatabaseInitializer 提供的（不是真正的 EntityFramework 本身）。`CreateDatabaseIfNotExists`初始化器内置在 EntityFramework 中，在某些版本中是默认值。但是，我又不是所有推断的应用程序行为的人。在我看来，我想要更多的控制。

[这家伙有一个自定义数据库初始化程序的示例，它继承自内置的 CreateDatabaseIfNotExists](http://peterkellner.net/2012/02/17/entityframework-codefirst-4-3-adding-data-migration-to-simple-example-part-2/)。但是你总是可以创建你自己的并实现你想看到的任何确切的逻辑（包括创建你的数据库）。同样，这只是避免了意外行为。作为开发人员，我个人的偏好是密切控制这些东西，除非我只是在玩模型或测试项目。

超级简单的自定义 DatabaseInitializer 没有意外行为：

```
namespace MyProject.Data.DatabaseInitializers
{
    public class MyCustomDbInit<TContext> : IDatabaseInitializer<TContext>
        where TContext : DbContext
    {
        public void InitializeDatabase(TContext context)
        {
            // Create our database if it doesn't already exist.
            context.Database.CreateIfNotExists()

            // Do you want to migrate to latest in your initializer? Add code here!

            // Do you want to seed data in your initializer? Add code here!
        }
    }
} 
```

## 结果

如果您使用代码优先的方法，禁用自动迁移并使用像上面这样的自定义 DatabaseInitializer，您将可以很好地控制发生的事情和时间。

我们在工作中使用这些策略并且零问题（尽管确定这些策略确实有些麻烦）。希望你能找到类似的成功！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-10T20:32:48.430

我能够使用 SQL CE 复制您的问题，以及首先使用上面的代码使用 EF 代码。

奇怪的是，当我第一次按原样使用您的代码时，它运行良好。为了出现您的问题，我必须实际删除`_MigrationHistory`.sdf 文件中的表。

通过删除 .sdf 文件（我意识到在您的情况下这可能不是一个选项，但我会在更远的地方解决这个问题）下一次运行时，它创建了迁移表 - 但它仍然不能正常工作。如果您注意到，在第 12 步，它最终会创建表。

> -- 语句 #1 SELECT [GroupBy1].[A1] AS [C1] FROM (SELECT COUNT(1) AS [A1] FROM [Dummies] AS [Extent1]) AS [GroupBy1]
> 
> -- 语句 #2 SELECT [GroupBy1].[A1] AS [C1] FROM (SELECT COUNT(1) AS [A1] FROM [__MigrationHistory] ​​AS [Extent1]) AS [GroupBy1]
> 
> -- 语句#3 WARN: System.Data.SqlServerCe.SqlCeException (0x80004005): 指定的表不存在。[ __MigrationHistory ]
> 
> -- 语句 #4 SELECT [GroupBy1].[A1] AS [C1] FROM (SELECT COUNT(1) AS [A1] FROM [__MigrationHistory] ​​AS [Extent1]) AS [GroupBy1]
> 
> -- 语句#5 WARN: System.Data.SqlServerCe.SqlCeException (0x80004005): 指定的表不存在。[ __MigrationHistory ]
> 
> -- 语句#6 SELECT [GroupBy1].[A1] AS [C1] FROM (SELECT COUNT(1) AS [A1] FROM [__MigrationHistory] ​​AS [Extent1]) AS [GroupBy1]
> 
> -- 语句#7 WARN: System.Data.SqlServerCe.SqlCeException (0x80004005): 指定的表不存在。[ __MigrationHistory ]
> 
> -- 语句#8 SELECT [GroupBy1].[A1] AS [C1] FROM (SELECT COUNT(1) AS [A1] FROM [__MigrationHistory] ​​AS [Extent1]) AS [GroupBy1]
> 
> -- 语句#9 WARN: System.Data.SqlServerCe.SqlCeException (0x80004005): 指定的表不存在。[ __MigrationHistory ]
> 
> -- 语句 #10 以隔离级别开始事务：可序列化
> 
> -- 语句 #11 CREATE TABLE [Dummies] ([DummyId] [int] NOT NULL IDENTITY, [test] nvarchar, [addThis] nvarchar, CONSTRAINT [PK_Dummies] PRIMARY KEY ([DummyId]) )
> 
> -- 语句 #12 CREATE TABLE [__MigrationHistory] ​​( [MigrationId] nvarchar NOT NULL, [CreatedOn] [datetime] NOT NULL, [Model] [image] NOT NULL, [ProductVersion] nvarchar NOT NULL, CONSTRAINT [PK__MigrationHistory] ​​PRIMARY KEY ( [迁移 ID]) )
> 
> -- 语句 #13 INSERT INTO [__MigrationHistory] ​​([MigrationId], [CreatedOn], [Model], [ProductVersion]) VALUES ('201208101940587_InitialCreate', '2012-08-10T19:40:59.055',0x1F8B0800000000000400CD57DD8ED33C10BDFF24DE21F23D75591082550A5ADA5D5441771159B89FC6D3D6C27642ECACDA67FB2E78245E8171FE9A26FDD95D40E2AE998CCF1C1F9FF1A43FFFFF11BE5D6B15DC6166656246ECD960C802347122A4598E58EE164F5FB1B76F9EFC175E0ABD0EBED679673E8F561A3B622BE7D273CE6DBC420D76A0659C253659B8419C680E22E167C3E12BFE6CC8912018610541F839374E6A2C1EE8719C98185397839A250295ADE2F4262A50836BD068538871C4DE8195F198D2AE64661D0B2E94046211A15A3C90D2F0B5A7C49A6254EE9268B9CDED26C5A2E4884D72AD37ED144AFA809B9D00853E65498A99DB7CC6457BE154B080EF2EE6DDD5CDDAEE42CF62C4A6C63D3F63C175AE14CC150516A02CB2207D791EB924C3F768300387E2133887199DCD5460B18B4A8DF3F4E5FD0479CD87675E100EC6240E1C1D748F7D87AB437F0225D1C865E419165CC9358A8F68966ED5909DC1BA8EBC180EC93A5F8C248F79842CC7F6EECAE7E3554188DB95B47FBB70C8B76EE87B842CEB4092F615A95911C1B5EB98A5CC8ED0B58E572291DF8297E61D9456DB4BA129B66D0C5E7646DD41FC400B8533485392A7D552552488CA7E1A3F8D1EDE37BAC4E0B1DDD33E0DDBA612191596D8794BA5EB2E9E808339F8031B0BDD4B3B296D5D6757E16E8F6E05AFF3FDEF72CDEEA532D8D3F56DE9AE68379A9AACD8183634F6DE16D5CA280605D9A1561F272AD7E6E8C5710CA76CC3364819B93F42D3526D9026D8C70979478AAED8BCA776E71AEC1EDE31D777539AEA8DFB3B2E0F2BC79D9E263D0B96292C2081EEA4F0F68B36D6A11EF88441F45D4598D1B81CE3E0859F8175DA0C8C5C90E8B7C937A43BB878F7D8C9D45CC4D60AF58F8F2769C8672707516F7ADD7FAC983BC8E215647BEEF2DF9A1A8FC47DD850E85F70A787C3E6F06828BD3962629ED0364A8ACD3C79E4DCE8774AC8DB5F67E104AD5C6E21FCB79AC1D87F1D6C41EB9CA95924B5ECB4AB36A33AA5732A337420489C8BCCC905C48E5EC7686D31D0BF82CA29E552CF514CCD4DEED2DC5D588B7AAE76E664C88FD72F86E32EE7F026F54FF64F6C81684ADA02DE9877B954A2E17DD5B7FA2108EF93AA7F88157DD010DC72D3205D27E69E40957C134CD1F8EEBB459D2A02B33726823B3CCCEDB486BB8A851309CB0C745BC132523189802AB74A5081F68A6D3DFFE782FB7F176F7E018E4F04B08F0C0000，“4.3.1”）
> 
> -- 语句#14 提交事务
> 
> -- 语句 #15 SELECT [GroupBy1].[A1] AS [C1] FROM (SELECT COUNT(1) AS [A1] FROM [Dummies] AS [Extent1]) AS [GroupBy1]

通过在正确的位置创建表来解决问题：

![在此处输入图像描述](../Images/75722799ea068c5b2685ca3a8cd95247.png)

一旦我这样做了，下次代码运行时，一切都会再次完美运行。

> -- 语句#1 SELECT [GroupBy1].[A1] AS [C1] FROM (SELECT COUNT(1) AS [A1] FROM [__MigrationHistory] ​​AS [Extent1]) AS [GroupBy1]
> 
> -- 语句 #2 SELECT TOP (1) [c].[ProductVersion] AS [ProductVersion] FROM [__MigrationHistory] ​​AS [c]
> 
> -- 语句#3 SELECT [GroupBy1].[A1] AS [C1] FROM (SELECT COUNT(1) AS [A1] FROM [__MigrationHistory] ​​AS [Extent1]) AS [GroupBy1]
> 
> -- 语句 #4 SELECT [Extent1].[MigrationId] AS [MigrationId] FROM [__MigrationHistory] ​​AS [Extent1]
> 
> -- 语句#5 SELECT [GroupBy1].[A1] AS [C1] FROM (SELECT COUNT(1) AS [A1] FROM [__MigrationHistory] ​​AS [Extent1]) AS [GroupBy1]
> 
> -- 语句#6 SELECT [GroupBy1].[A1] AS [C1] FROM (SELECT COUNT(1) AS [A1] FROM [__MigrationHistory] ​​AS [Extent1]) AS [GroupBy1]
> 
> -- 语句 #7 SELECT TOP (1) [Project1].[C1] AS [C1], [Project1].[MigrationId] AS [MigrationId], [Project1].[Model] AS [Model] FROM (SELECT [Extent1 ].[MigrationId] AS [MigrationId], [Extent1].[CreatedOn] AS [CreatedOn], [Extent1].[Model] AS [Model], 1 AS [C1] FROM [__MigrationHistory] ​​AS [Extent1]) AS [ Project1] ORDER BY [Project1].[CreatedOn] DESC
> 
> -- 语句#8 SELECT [GroupBy1].[A1] AS [C1] FROM (SELECT COUNT(1) AS [A1] FROM [__MigrationHistory] ​​AS [Extent1]) AS [GroupBy1]
> 
> -- 语句#9 SELECT TOP (1) [Project1].[C1] AS [C1], [Project1].[MigrationId] AS [MigrationId], [Project1].[Model] AS [Model] FROM (SELECT [Extent1 ].[MigrationId] AS [MigrationId], [Extent1].[CreatedOn] AS [CreatedOn], [Extent1].[Model] AS [Model], 1 AS [C1] FROM [__MigrationHistory] ​​AS [Extent1]) AS [ Project1] ORDER BY [Project1].[CreatedOn] DESC
> 
> -- 语句 #10 以隔离级别开始事务：未指定
> 
> -- 语句 #11 插入 [Dummies] ([test], [addThis]) 值 (null, null);
> 
> 从 [DummyId] 中选择 [DummyId]，其中 [DummyId] = @@IDENTITY
> 
> -- 语句 #12 插入 [Dummies] ([test], [addThis]) 值 (null, null);
> 
> 从 [DummyId] 中选择 [DummyId]，其中 [DummyId] = @@IDENTITY
> 
> -- 语句 #13 插入 [Dummies] ([test], [addThis]) 值 (null, null);
> 
> 从 [DummyId] 中选择 [DummyId]，其中 [DummyId] = @@IDENTITY
> 
> -- 语句 #14 插入 [Dummies] ([test], [addThis]) 值 (null, null);
> 
> 从 [DummyId] 中选择 [DummyId]，其中 [DummyId] = @@IDENTITY
> 
> -- 语句#15 提交事务
> 
> -- 语句 #16 SELECT [GroupBy1].[A1] AS [C1] FROM (SELECT COUNT(1) AS [A1] FROM [Dummies] AS [Extent1]) AS [GroupBy1]

如果放弃整个 SDF 并让它重新创建不是一种选择，那么我就是这样做的。

在您的 appconfig 中创建一个连接字符串（我意识到您可能想要动态连接字符串，这就是它在您的代码中的原因，但这*应该*是一次性的）。我的连接字符串如下所示：

```
 <connectionStrings>
        <add connectionString="Data Source=MyContext.sdf;Persist Security Info=False;" name="MyContext" providerName="System.Data.SqlServerCe.4.0"/>
    </connectionStrings> 
```

更改 Context 的构造函数，使其使用连接字符串：

```
public MyContext()
    //: base(string.Format(@"DataSource=""{0}""", "MyContext.sdf"))
    : base("MyContext") 
```

所有这些都是必要的，因此您可以在包管理器控制台中运行一些命令，以便它重新创建表。打开包管理器控制台，然后运行以下命令：

```
add-migration initial -ignorechanges 
```

接下来，运行程序——它会抛出一些警告，然后它会为你创建表并填充它。之后，您可以更改您的构造函数，我没有更多问题。

**注意：**一旦它开始工作，种子功能也开始工作

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-30T12:03:47.977

我玩弄了您提供的代码，在这种情况下（使用 SQL Server 而不是 CE）并得出以下结论。我已经删除了 Database.Create 代码并允许 EF 的自动迁移来做这件事。现在运行并正确调用 Seed 方法。

```
internal class Program
{
    private static void Main()
    {
        EntityFrameworkProfiler.Initialize();

        Database.DefaultConnectionFactory = new SqlConnectionFactory("System.Data.SqlServer");
        Database.SetInitializer(new MigrateDatabaseToLatestVersion<MyContext, MyContextConfiguration>());

        using (var context = new MyContext())
        {
            var element = context.Dummies.FirstOrDefault();
        }
    }
}

internal class Dummy
{
    public String Id { get; set; }
}

internal sealed class MyContext : DbContext
{
    public MyContext() : base(@"Data Source=localhost;Initial Catalog=Dummies;User Id=<USER_ID>;Password=<PASSWORD>;MultipleActiveResultSets=False;")
    {
    }

    public DbSet<Dummy> Dummies { get; set; }
}

internal sealed class MyContextConfiguration : DbMigrationsConfiguration<MyContext>
{
    public MyContextConfiguration()
    {
        AutomaticMigrationsEnabled = true;
        AutomaticMigrationDataLossAllowed = true;
    }

    protected override void Seed(MyContext context)
    {
        context.Dummies.AddOrUpdate(new Dummy() { Id = "First" });
    }
} 
```

如果您查看 EF 探查器，您会看到现在有更多针对 DB 运行的查询（甚至检查旧的 EdmMetaData 表......这很奇怪，因为如果现在遇到该表，它应该删除该表有利于__MigrationHistory 表）。我不知道为什么会这样，我想这要么是我们这边的配置问题（我还不知道如何解决），要么是迁移代码中的错误。

因此，我认为对于 EF 迁移，我们要么留给基于代码的迁移（[请参阅我的博客文章](http://www.terric.co.uk/code-first-entity-framework-and-sql-migrations/)）或自动迁移（如此代码片段所示）。我想随着时间的推移，我会更好地理解为什么 EF（或我迁移的方式）有这种奇怪的行为——或者 EF 本身会随着它的发展而变得更好。

# xcode - 构建 Mac OS 应用程序 - 隐藏“内容”文件夹中的文件

> ID：11672815
> 
> 赞同：0
> 
> 时间：2012-07-26T15:32:32.217
> 
> 标签：xcode, cocoa, build

可可新手，所以我可能会问一个愚蠢的问题。当我构建一个 MAC OS 应用程序时，我可以查看包内容，在资源下我可以看到我的 nib 文件。现在，当我去查看其他应用程序的内容时，我看不到它们的 nib——比如 Chrome——看不到它们！那么，有没有办法构建您的应用程序，以便某些文件（nib、.py 文件）在 Contents 下不可见？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T15:37:15.637

所有文件都将在 Contents 下可见 - 我认为 Chrome 不使用 nib，因为它是跨平台的，并且直接从代码构建其 GUI。

# hibernate - 每个子类的表与重复列

> ID：11672816
> 
> 赞同：0
> 
> 时间：2012-07-26T15:32:35.290
> 
> 标签：hibernate

在我的应用程序中，我有这个层次结构：

*   最后用户
*   LastUserUpdatedTimestamp

BaseObject 是一个@MappedSuperclass，它由Transaction 扩展，而后者又由SubTransaction 扩展。

Transaction 对象定义如下：

```
@Entity
@Table(name = "T_TRANSACTION")
@Inheritance(strategy = InheritanceType.JOINED)
public class Transaction extends BaseObject implements Serializable {
    //etc
} 
```

子事务看起来像这样：

```
// Primary key join columns
public class SubTransaction extends Transaction implements Serializable { 
```

Transaction 和 SubTransaction 映射到每个都有审计列的表（是的，相同的名称）

*   最后用户
*   上次更新时间戳

当我尝试持久化 SubTransaction 时，会引发有关 Transaction 的审计列为空的异常。

任何人都可以提供任何建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T06:39:51.270

据我了解，您有一个表格结构，例如

```
 BaseObjectTable
  /               \
 \/               \/
Transaction     Subtransaction 
```

但映射表明他

```
BaseObjectTable
  /
 \/
Transaction
  /
 \/
Subtransaction 
```

要实现第一个你可以尝试`@Extends(BaseObject)`在 Subtransaction 上设置

# c++ - 有问题的设计使用基对象修改/访问派生类的信息

> ID：11672819
> 
> 赞同：1
> 
> 时间：2012-07-26T15:32:52.747
> 
> 标签：c++, inheritance, polymorphism, derived

我的问题如下：

```
int main()
{
    Base* derivedobject = new Derived1();
    derivedobject->GetProperties()-> ???

return 0;
}

//********************
// BaseClass.h
//********************
struct PropertyStruct
{
    int x;
};

class Base
{
public:
    Base();
    ~Base();

    virtual PropertyStruct GetProperties() = 0;

private:
};

//********************
// DerivedClass1.h
//********************
struct PropertyStruct
{
    int y;
};

class Derived1 : public Base
{
public:
    Derived1();
    ~Derived1();

    PropertyStruct GetProperties() { return myOwnDifferentProperties; };

private:

};

//********************
// DerivedClass2.h
//********************
struct PropertyStruct
{
    float z;
};

class Derived2 : public Base
{
public:
    Derived2();
    ~Derived2();

    PropertyStruct GetProperties() { return myOwnDifferentProperties };

private:

}; 
```

如果我这样做，我会得到一个错误，说 PropertyStruct 是一个重新定义。如果我在派生类中使用命名空间或重命名结构，则会收到一个错误，告诉我返回类型与 Base 定义的不同。如果我将虚函数返回类型定义为它编译的指针，尽管从主方法（在本例中）访问函数“GetProperties”时的下一个问题是基对象不知道派生类的结构内有哪些变量.

有什么办法可以让我意识到这一点？我可以获得每个派生对象的不同属性但使用基类对象吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T16:14:30.660

正如其他人所提到的，有一些方法可以在这里实现您的目标，但最终您会发现自己编写如下代码：

```
 Base * object = ...;

    if object is Derived1 then
      get Property1 and do something with it
    else if object is Derived2 then
      get Property2 and do something with it 
```

这是面向对象编程中的反模式。您已经有一个类层次结构来表示各种派生类型之间的差异。与其从对象中提取数据并在外部进行处理，不如考虑向基类添加一个虚函数并让派生类进行处理。

```
class Base
{
public:

    virtual void DoSomething() = 0;
};

class Derived1 : Base
{
public:

    void DoSomething()
    {
        // use myOwnDifferentProperties as necessary
    }

private:

    PropertyStruct myOwnDifferentProperties;
}; 
```

如果将所需的处理放在派生类中是不合适的（即，如果它会引入不需要的责任），那么您可能需要考虑将[访问者模式](http://en.wikipedia.org/wiki/Visitor_pattern)作为扩展层次结构功能的一种方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T15:41:07.410

由于模板函数不能是虚拟的，因此您可以使用属性的层次结构。这只是一种方式，没有其他方式。对于派生属性的获取元素，您应该使用虚拟 getter 函数。

```
struct BaseProp
{
    virtual ~BaseProp() { }
    virtual boost::any getProperty() const = 0;
};

struct PropertyStruct : BaseProp
{
    boost::any getProperty() const { return x; }
private:
    int x;
};

struct PropertyStruct2 : BaseProp
{
    boost::any getProperty() const { return y; }
private:
    float y;
};

class Base
{
public:
    virtual std::shared_ptr<BaseProp> GetProperties() const = 0;
    virtual ~Base() { }
}

class Derived
{
public:
    std::shared_ptr<BaseProp> GetProperties() const { return new PropertyStruct(); }
};

class Derived2
{
public:
    std::shared_ptr<BaseProp> GetProperties() const { return new PropertyStruct2(); }
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T15:55:52.013

您可以使用模板类来做到这一点：

```
struct PropertyStruct1 {
    float f;
};

struct PropertyStruct2 {
    int i;
};

template<class T>
class A{
public:
    T GetProperties() {return mProps;}

private:
    T mProps;   
};

int main (int argc, const char * argv[]) {

    A<PropertyStruct1> a1;
    int f = a1.GetProperties().f;
    A<PropertyStruct2> a2;
    int i = a2.GetProperties().i;
    return 0;
} 
```

# c# - 列表内列表

> ID：11672821
> 
> 赞同：1
> 
> 时间：2012-07-26T15:33:07.833
> 
> 标签：c#, xmldocument, xmlnode

我知道它有很多代码......对不起......我的列表类是这样的......

```
public class XMLList
{
    public string Title { get; set; }
    [DataMember]
    public string Link { get; set; }
    [DataMember]
    public DateTime pubDate { get; set; }
    [DataMember]
    public string dcCreator { get; set; }
    [DataMember]
    public string GUID { get; set; }
    [DataMember]
    public Int32 wpPostId { get; set; }
    [DataMember]
    public string wpStatus { get; set; }
    [DataMember]
    public Int32 wpMenuOrd { get; set; }
    [DataMember]
    public string Category { get; set; }
    [DataMember]
    public List<Comment> Comments { get; set; }
}

public class Comment
{
    [DataMember]
    public Int32 wpCmtId { get; set; }
    [DataMember]
    public string wpCmtAuthor { get; set; }
    [DataMember]
    public string wpCmtAuthorEmail { get; set; }
    [DataMember]
    public string wpCmtAuthorURL { get; set; }
    [DataMember]
    public Int64 wpCmtAuthorIP { get; set; }
    [DataMember]
    public DateTime wpCmtAuthorDate { get; set; }
} 
```

我的 c# 代码是这样的

```
XmlDocument doc = new XmlDocument();
doc.Load(@"xml\willowcreekassociationblog.wordpress.xml");
//Get Channel Node
XmlNode channelNode = doc.SelectSingleNode("rss/channel");
if (channelNode != null)
{
    //Add NameSpace
    XmlNamespaceManager nameSpace = new XmlNamespaceManager(doc.NameTable);
    nameSpace.AddNamespace("excerpt", "http://wordpress.org/export/1.2/excerpt/");
    nameSpace.AddNamespace("content", "http://purl.org/rss/1.0/modules/content/");
    nameSpace.AddNamespace("dc", "http://purl.org/dc/elements/1.1/");
    nameSpace.AddNamespace("wfw", "http://wellformedweb.org/CommentAPI/");
    nameSpace.AddNamespace("wp", "http://wordpress.org/export/1.2/");

    //Parse each item
    foreach (XmlNode itemNode in channelNode.SelectNodes("item"))
    {
        objrssItem.Add(rssItem);
        rssItem.GUID = itemNode.SelectSingleNode("guid").InnerText;
        rssItem.Title = itemNode.SelectSingleNode("title").InnerText;
        rssItem.dcCreator = itemNode.SelectSingleNode("dc:creator", nameSpace).InnerText;
        rssItem.Link = itemNode.SelectSingleNode("link").InnerText;
        rssItem.pubDate = DateTime.Parse(itemNode.SelectSingleNode("pubDate").InnerText);
        rssItem.ContentEncoded = itemNode.SelectSingleNode("content:encoded", nameSpace).InnerText;

        XmlNode cNode = doc.SelectSingleNode("rss/channel/item");
        foreach (XmlNode commentNode in cNode.SelectNodes("wp:comment", nameSpace))
        {
           //rssItem.Comments = Comments
            rsscomment.wpCmtId = Convert.ToInt32(commentNode.SelectSingleNode("wp:comment_id", nameSpace).InnerText);
            rsscomment.wpCmtAuthor = commentNode.SelectSingleNode("wp:comment_author", nameSpace).InnerText;
            rsscomment.wpCmtContent = commentNode.SelectSingleNode("wp:comment_content", nameSpace).InnerText;  
        }
    }
    oXMLListResult.listOfXMLResult = objrssItem;
} 
```

我有像[在此处输入链接描述的 xml](http://i.imgur.com/I7tBF.png?1)

当我尝试使用 xmlnode 读取通道中的每个项目时，它工作正常。每个项目都有多个注释，试图通过在 foreach 中使用 foreach 来实现。但是 wp:comment foreach 项目它不起作用。我究竟做错了什么？我做了一些谷歌但没有运气。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:36:28.293

```
XmlNode cNode = doc.SelectSingleNode("rss/channel/item"); 
```

这会将您的枚举重置`item`为开头，这将导致每个项目具有相同的注释。

编辑：
我相信这是解决我提到的问题的最简单方法。通过在已选择的节点下方进行搜索，您可以避免重复。请注意，`cNode`不再需要。

```
foreach (XmlNode commentNode in itemNode.SelectNodes("wp:comment", nameSpace)) 
```

# php - 从 Jquery datepicker 中选择日期后，文本框值未发布

> ID：11672823
> 
> 赞同：0
> 
> 时间：2012-07-26T15:33:15.553
> 
> 标签：php, javascript, jquery

我创建了一个文本框并添加了一个 Jquery UI 日期选择器。但是当我选择并单击按钮时。文本框不会发布并显示错误消息，例如（注意：未定义的索引：C 中的 date_text：............ ......\file.php 第 57 行）。但是当我使用键盘输入日期而没有日期选择器时，它会很好地提交。请帮助我。我该如何使用 datepicker

这是我的jQuery代码

```
<script>
    $(function() {
        $( "#datepicker" ).datepicker();

            $( "#datepicker" ).datepicker( "option", "dateFormat", "yy-mm-dd" );

    });
    </script> 
```

这是我的文本字段

```
<div id="datetobe">Date to be dispose
               <label for="date_to_dispose"> <input name="datepicker" type="text" id="datepicker"   class="textfield" /></label>
              </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T15:36:26.557

您必须为日期选择器设置回调函数。

[http://jqueryui.com/demos/datepicker/](http://jqueryui.com/demos/datepicker/)

事件选项卡，onSelect 事件。即时通讯。

```
$('#datepicker').datepicker({
    format: 'whatever',
    onSelect: function(dateText, inst) { ... }
}); 
```

# objective-c - ABAddressBookRegisterExternalChangeCallback 耗时太长

> ID：11672824
> 
> 赞同：1
> 
> 时间：2012-07-26T15:33:20.727
> 
> 标签：objective-c, ios

我正在使用 ABAddressBookRegisterExternalChangeCallback 在我的通讯录数据库更改时接收通知。我的应用程序允许用户编辑一个人的联系信息。但是，调用回调需要很长时间。例如，在一种情况下为 30 秒。我需要它立即发生！我该怎么做呢？有没有其他人使用 ABAddressBookRegisterExternalChangeCallback 遇到过这个问题？

# c# - 使用 WebClient 启用压缩

> ID：11672826
> 
> 赞同：1
> 
> 时间：2012-07-26T15:33:25.827
> 
> 标签：c#, .net, http, http-headers

我正在使用 System.Net.WebClient.DownloadFile 从公共 Web 服务器下载大量 html 文件。我想启用压缩，因为这可能会大大减少数据传输。[在上一个问题](https://stackoverflow.com/a/11670708/154766)中有人告诉我，我应该设置“Accept-Encoding: gzip, deflate”标头。WebClient 有一个 Headers 属性允许这样做。

我对此有几个问题：

1.  假设 Web 服务器可以识别标头，这适用于 DownloadFile 方法还是仅适用于 DownloadData 方法？我在 MSDN 或其他网站上找不到有关此的任何信息。
2.  如果它不适用于 DownloadFile，实现将压缩数据下载到文件的最简单方法是什么？
3.  是否需要为服务器设置任何其他标头来压缩其数据？在一个旧的[codinghorror.com](http://www.codinghorror.com/blog/2004/08/netwebclient-and-gzip.html)条目中，Jeff Atwood 说“UserAgent”标头也需要设置，但我不知道该值应该是什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T15:40:31.573

1.  DownloadFile 只是一个原始 WebRequest 的包装器；它只是处理结果并将其打包为“文件”或字节数组。
2.  有用; 但是发送到本地文件的数据仍然是压缩的，您必须手动解压缩。

3.  您将获得一个默认的 UserAgent。不需要任何特定的 UserAgent 值，除非您访问的站点需要一个。但是，您必须找出答案。（杰夫的帖子建议谷歌需要一个；但我不知道这是否仍然正确）

# c# - 区域内的区域 Prism 未添加到区域管理器

> ID：11672828
> 
> 赞同：-1
> 
> 时间：2012-07-26T15:33:37.667
> 
> 标签：c#, wpf, mvvm, prism, regions

我有一个 Shell 包含 3 个区域。其中之一（A）是加载一个包含区域（B）的视图。问题是区域 B 未添加到区域管理器中。所以当我想在区域 B 内加载任何视图时，我会收到此错误：**区域管理器不包含 ListRegion 区域**。
这是一个常见问题还是我做错了什么？

编辑：添加了代码片段

```
<UserControl x:Class="StockOutput.Views.OutputInvoice"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:glob="clr-namespace:System.Globalization;assembly=mscorlib"
             xmlns:ext="clr-namespace:Microsoft.Windows.Controls;assembly=WPFToolkit.Extended"
             xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
             xmlns:gs="clr-namespace:GalaSoft.MvvmLight.Command;assembly=GalaSoft.MvvmLight.Extras.WPF4"
             xmlns:prism="http://www.codeplex.com/prism"
             xmlns:inf="clr-namespace:SmartStock.Infrastructure;assembly=SmartStock.Infrastructure"
             xmlns:View="clr-namespace:Tiers.Views;assembly=Tiers"
             >
    <Grid >
... 
 <ext:ChildWindow  WindowStartupLocation="Center" CloseButtonVisibility="Hidden" Height="350" Width="600" WindowState="{Binding SupplierSelectionWindow}" IsModal="True" Grid.RowSpan="3" Grid.ColumnSpan="2">
            <ext:ChildWindow.Resources>

            </ext:ChildWindow.Resources>
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="75*"></ColumnDefinition>
                </Grid.ColumnDefinitions>

                <Grid.RowDefinitions>
                    <RowDefinition Height="auto"></RowDefinition>
                    <RowDefinition Height="auto"></RowDefinition>
                    <RowDefinition Height="*"></RowDefinition>
                    <RowDefinition Height="35"></RowDefinition>
                </Grid.RowDefinitions>
                <Label Style="{StaticResource ViewTitle}">Choix Tièrs</Label>
                <StackPanel Orientation="Horizontal" Grid.Row="1">
                    <Label Margin="5">Recherche :</Label>
                    <TextBox TabIndex="0" Margin="5" Width="150"></TextBox>
                </StackPanel>

//HERE IS MY REGION
                <ContentControl Margin="5" Grid.Row="2"  prism:RegionManager.RegionName="{x:Static inf:RegionNames.ListRegion}">

                </ContentControl>
                <!-- <DataGrid Margin="5" TabIndex="1" Grid.Row="2" ItemsSource="{Binding TiersList}" SelectedItem="{Binding SelectedTiers}" CanUserAddRows="True" IsReadOnly="False">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Fournisseur" Binding="{Binding TiersName}"></DataGridTextColumn>
                        <DataGridTextColumn Header="Catégorie" Binding="{Binding OperartorCategories.OperatorCategoryName}"></DataGridTextColumn>
                    </DataGrid.Columns>
                </DataGrid>-->
                <Button Grid.Row="3" TabIndex="2" Width="120" Margin="5" HorizontalAlignment="Right" Command="{Binding ValidateTiersChoiceCommand}">Valider</Button>
                <Button Command="{Binding CancelChoiceCommand}" Margin="0,5,144,5" Content="Annuler" HorizontalAlignment="Right" TabIndex="3" Width="120" Grid.Row="3" />
            </Grid>
        </ext:ChildWindow>
        ...
    </Grid>
</UserControl> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T20:25:02.977

感谢您的帮助，我发现我要求 RegionManager 在 ViewModel 构造函数的 ListRegion 中加载视图（此时视图尚未加载）。这就是我收到此错误的原因。问题解决了

# javascript - 经典的 asp - 由 vbscript 下拉列表填充的 javascript 数组

> ID：11672855
> 
> 赞同：1
> 
> 时间：2012-07-26T15:34:59.133
> 
> 标签：javascript, arrays, drop-down-menu, asp-classic, vbscript

我需要创建一个基于下拉列表（多个）选定值填充的 javascript 数组，除了每个下拉列表具有相同的名称，因为它们是在 for 循环中创建的。现在我有：

```
<script language="JavaScript">
     var array = [];
     var e = document.getElementById("phItemStatusID").value; //returns first ddl value
</script> 
```

后来在 asp 代码中是我的下拉列表，它是使用 VBScript 从数据库中填充的：

```
<%for i = 0 to UBound(photoItemsArray,2)%> //for each item, generate DDL
<select name="phItemStatusID">
    itemStatusID = photoItemsArray(6,i) //get current selected value
    for j = 0 to UBound(photoStatusesArray,2)%> //for each possible status
    <option value="<%=photoStatusesArray(0,j)%>"
            <%if photoStatusesArray(0,j) = itemStatusID then%> 
                selected
            <%end if%>>
            <%=photoStatusesArray(1,j)%>
        </option>
    <%next%>
</select>
next%> 
```

这适用于仅生成一个下拉列表的情况。我遇到的问题涉及有多个下拉列表名称为`phItemStatusID`.

`var e = document.getElementById("phItemStatusID").value;`只返回第一个下拉列表的值，其他的被忽略。我如何获得它们？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T15:38:49.620

`document.getElementById("phItemStatusID").value`将获得 ID 为“phItemStatusID”的第一个元素的值，因为 HTML 中的 ID 应该是唯一的。

如果要获取第二个框的值，请使用不同的 ID。

# javascript - 使用 Javascript（不带 jquery）触发 Anchor 链接上的链接？

> ID：11672856
> 
> 赞同：2
> 
> 时间：2012-07-26T15:34:59.973
> 
> 标签：javascript

是否可以仅通过 javascript 触发对锚链接的点击（不是 Jquery - 长篇大论！）。

我们想将锚链接的 id 传递给将触发点击的函数，但不知道如何在没有 jquery 的情况下触发点击！

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T15:39:19.130

在某些浏览器中，您可以执行类似的操作`document.getElementById(myelement).click()`（我很确定这只是 IE 的情况，但它可能在更多浏览器中可用）。

由于它是`<a>`您要单击的标签，因此可以很容易地模拟其默认单击事件：

```
function clickLink(id) {
    var tag = document.getElementById(id);
    if( tag.onclick) {
        var def = tag.onclick();
        if( !def) return false; // event cancelled by handler
    }
    window.location.href = tag.getAttribute("href");
} 
```

请注意，这不考虑添加的事件或除属性和属性`addEventListener`之外的任何其他事件，并且如果用户 Ctrl+Clicks 或 MMB-clicks，它不会打开新窗口/选项卡。`.onclick``onClick`

# ios - Launch/Spash 图像不会随升级而改变

> ID：11672857
> 
> 赞同：3
> 
> 时间：2012-07-26T15:35:03.247
> 
> 标签：ios, upgrade, splash-screen, default.png

在我的 iOS 应用程序的下一个版本中，我修改了 Default.png 图像。新图像（现已本地化）在整个应用程序中占据显着位置。

要在我的设备上测试升级过程，请在具有先前版本应用程序的设备上从 Xcode 启动安装。我的问题是，在此模拟升级期间，初始图像显示为**旧**的Default.png。此外，当在应用程序的其他地方显示 Default.png 时，它也仍然是旧的。

但是，如果我首先从设备中删除应用程序，*然后*安装（而不是升级），**新**的启动图像确实会正确显示。

* * *

我该如何解决这个问题，或者在通过 Xcode 进行模拟升级时会出现这种情况吗？当通过应用商店发生升级过程时，我可以/应该依靠正确执行的升级过程吗？

最接近的问题似乎是： [更新的启动/启动不起作用](https://stackoverflow.com/questions/8758206/updated-splash-launch-not-working)
答案虽然听起来不错，但似乎是推测性的。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-30T10:55:21.817

我联系了 Apple，他们给我发了以下信息：

[https://developer.apple.com/library/ios/#technotes/tn2285/_index.html](https://developer.apple.com/library/ios/#technotes/tn2285/_index.html)

它解释说：

1.  如何正确测试更新
2.  在“Xcode 更新”期间，并非所有资产都会刷新
3.  在*正确*测试升级时，资产*确实*会被替换

长话短说，正确地测试升级，事情就会出现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T15:44:49.310

这里有一些事情可以尝试（不是保证，但值得一试）：

删除项目的派生数据。转到顶部的窗口菜单，单击管理器，单击顶部的项目选项卡，选择您的项目并单击“派生数据”旁边的“删除”按钮。

清理你的项目。产品菜单，然后是“清洁”选项。

确保旧的默认图像已从文件系统中的位置删除（有时 Xcode 说它删除了某些内容，但实际上该文件仍然存在于文件系统中）。

# c# - 这种方法、参数叫什么名字？

> ID：11672858
> 
> 赞同：3
> 
> 时间：2012-07-26T15:35:03.363
> 
> 标签：c#, methods

> **可能重复：**
> [如何在 C# 中使用可选参数？](https://stackoverflow.com/questions/199761/how-can-you-use-optional-parameters-in-c)

我在一个我正在工作的项目中找到了[语言：c#]。像这样的奇怪签名（至少对我来说）：

```
AccessModifier NameOfMethod(sometype param1, bool prmFlagOrSomething = false) 
```

在 msdn[库](http://msdn.microsoft.com/en-us/library/ms173114.aspx)中不存在对这种方法的任何引用。这允许避免传递参数 prmFlagOrSomething，在这种情况下 prmFlagOrSomething 的值为 false。

这就是发生的事情，但是存在文档吗？这种方法或参数的真实名称是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:37:05.323

这是一个默认参数。或者正如 MS 所说，一个“可选参数”：

[http://msdn.microsoft.com/en-us/library/dd264739.aspx](http://msdn.microsoft.com/en-us/library/dd264739.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T15:37:12.200

这只是一个[可选参数](http://msdn.microsoft.com/en-us/library/dd264739.aspx)

# c# - 在 mvc 中获取用户电子邮件

> ID：11672861
> 
> 赞同：0
> 
> 时间：2012-07-26T15:35:08.330
> 
> 标签：c#, .net, asp.net-mvc-3, linq, asp.net-membership

我编写了一些脏代码，用于在 MVC 中检索用户电子邮件。如您所见，我正在使用 linq 查询从我的用户数据库中检索信息。

```
 List<string> emails = new List<string> {ConstantHelper.AdminEmail, ConstantHelper.OwnerEmail};
 DataContext mDataContext = new DataContext();
 User user = 
      (from allUsers in mDataContext.Users.Where(u => u.UserName == User.Identity.Name) 
        select allUsers).FirstOrDefault();
 string userEmail =
      (from allMemberships in mDataContext.Memberships.Where(u => user != null && u.UserId == user.UserId)
        select allMemberships.Email).FirstOrDefault();
 if(userEmail == null)
 {
     return false;
 }
 emails.Add(userEmail);

 //TODO: senda email 
```

我想知道是否有任何其他“更短”或更简洁的方式来检索用户电子邮件（当前登录的用户）？

我用谷歌搜索了这个并找到了一些关于这个代码的建议，但我从来没有让它为我工作。

```
MembershipUser u = Membership.GetUser(username); 
```

我的代码有效，只是我宁愿有更干净的代码，任何建议都将不胜感激:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:43:33.540

`MembershipUser u = Membership.GetUser(username);`绝对是实现这一目标的更好、更短的方法。您只需要[编写一个自定义成员提供程序](https://stackoverflow.com/a/2780406/29407)来替换默认成员，以便能够自定义 GetUser 和其他方法的行为以满足您的需要。

# c# - 自定义 JsonMediaTypeFormatter 在 get_DeclaringMethod() 上抛出 InvalidOperationException

> ID：11672863
> 
> 赞同：1
> 
> 时间：2012-07-26T15:35:10.990
> 
> 标签：c#, serialization, asp.net-mvc-4, json.net, asp.net-web-api

**它在测试版中工作**

我有一个类型的对象，需要一些自定义反序列化才能使我的 web-api 的其余部分工作`ChangeSet<T>`。`ChangeSet`它在 asp.net mvc 4 beta 中工作，但在 rc 中它被破坏了，而且我发现很难调试。

**我的场景**

ChangeSet 可以表示由 ID 列表描述的多个 T 对象的变化。我想反序列化为某种对象数组或字典，以描述应该更改 T 对象的哪些属性，但后来我在反序列化为正确的数据类型时遇到了问题。所以我引入了 T 类型的 Change 属性。那么新的问题是，并不是 Change 的所有属性都应该被持久化。仅包含在 json 中的那些。所以我让有一个包含字符串列表的 Properties 属性。

**我的问题**

为了允许我填充属性，我需要访问原始 json，这就是我需要自定义 MediaTypeFormatter 的原因。（xml-serializer 有一个 SetSerializer(..) 但没有这样的 JsonSerializer 方法。在下面的 ReadFromStreamAsync 我这样做，问题是它崩溃了，我无法进入崩溃的地步得到一个内部异常。我得到的只是对我的请求的以下 json 响应：

```
{
    "ExceptionType": "System.InvalidOperationException",
    "Message":       "Method may only be called on a Type for which Type.IsGenericParameter is true.",
    "StackTrace":    "   at System.RuntimeType.get_DeclaringMethod()"
} 
```

如果我删除我的 ChangeSetJsonFormatter 代码不会中断，但我当然没有`Properties`.

**我的问题**

1.  这可能是什么原因？
2.  我怎样才能正确调试呢？我有 Log4Net，但我应该注意什么？我可以以某种方式解决问题吗？

**编码**

这是我的`FormatterConfig`：

```
public class FormatterConfig
{
    public static void RegisterGlobalFormatters(MediaTypeFormatterCollection formatters)
    {
        var jsonSerializerSettings = formatters.JsonFormatter.SerializerSettings;
        jsonSerializerSettings.Converters.Add(new IsoDateTimeConverter());
        jsonSerializerSettings.NullValueHandling = NullValueHandling.Ignore;

        // At index 0 so that it will try this before the default handler.
        formatters.Insert(0, new ChangeSetJsonFormatter(jsonSerializerSettings));

        formatters.Remove(formatters.XmlFormatter);
    }
} 
```

这是我的自定义媒体格式化程序（对不起长度）：

```
public class ChangeSetJsonFormatter : JsonMediaTypeFormatter
{
    private static readonly Type ChangeSetType = typeof (ChangeSet<Entity>);

    public ChangeSetJsonFormatter(JsonSerializerSettings jsonSerializerSettings)
    {
        SerializerSettings = jsonSerializerSettings;
    }

    public override bool CanReadType(Type type)
    {
        return type.IsGenericType && type.Namespace == ChangeSetType.Namespace && type.Name == ChangeSetType.Name;
    }

    public override bool CanWriteType(Type type)
    {
        return type.IsGenericType && type.Namespace == ChangeSetType.Namespace && type.Name == ChangeSetType.Name;
    }

    public override Task<object> ReadFromStreamAsync(Type type, Stream stream, HttpContentHeaders contentHeaders, IFormatterLogger formatterLogger)
    {
        var task = Task.Factory.StartNew(() =>
        {
            using (var streamReader = new StreamReader(stream))
            {
                var jsonSource = streamReader.ReadToEnd();
                var deserializedObject =
                    JsonConvert.DeserializeObject(jsonSource, type,
                                                SerializerSettings);
                var changeSet = deserializedObject as ChangeSet;
                if (changeSet != null &&
                    (changeSet.Properties == null ||
                    changeSet.Properties.Count == 0))
                {
                    var properties =
                        JObject.Parse(jsonSource)["Change"]
                               .Select(t => ((JProperty) t).Name)
                               .ToList();
                    changeSet.Properties = properties;
                }

                return deserializedObject;
            }
        });

        return task;
    }
} 
```

这些是 ChangeSet 类：

```
[DataContract]
public abstract class ChangeSet
{
    [DataMember]
    public IList<string> Properties { get; set; }

    [DataMember]
    public IList<int> IdList { get; set; }
}

[DataContract]
public class ChangeSet<T> : ChangeSet where T : Entity
{
    [DataMember]
    public T Change { get; set; }

    public Dictionary<PropertyInfo, object> Changes
    {
        get 
        {
            if (Properties == null || Properties.Count == 0)
                return new Dictionary<PropertyInfo, object>();

            return typeof (T)
                .GetProperties()
                .Where(pi => Properties.Contains(pi.Name))
                .ToDictionary(pi => pi, pi => pi.GetValue(Change, null));
        }
    }
} 
```

编辑：按照本文档，我能够为服务堆栈生成跟踪。现在，如果我能够为我的异常获得一个条目就好了。这是默认侦听器的输出：

```
System.Web.Http.Request: ;;http://localhost:50500/MyService/User?_dc=1343396746443
System.Web.Http.Controllers: DefaultHttpControllerSelector;SelectController;Route='controller:User'
System.Web.Http.Controllers: DefaultHttpControllerSelector;SelectController;User
System.Web.Http.Controllers: HttpControllerDescriptor;CreateController;
System.Web.Http.Controllers: DefaultHttpControllerActivator;Create;
System.Web.Http.Controllers: DefaultHttpControllerActivator;Create;MyCompany.Admin.Service.Controllers.UserController
System.Web.Http.Controllers: HttpControllerDescriptor;CreateController;MyCompany.Admin.Service.Controllers.UserController
System.Web.Http.Controllers: UserController;ExecuteAsync;
System.Web.Http.Action: ApiControllerActionSelector;SelectAction;
System.Web.Http.Action: ApiControllerActionSelector;SelectAction;Selected action 'Put(ChangeSet`1 changeSet)'
System.Web.Http.ModelBinding: HttpActionBinding;ExecuteBindingAsync;
System.Web.Http.ModelBinding: FormatterParameterBinding;ExecuteBindingAsync;Binding parameter 'changeSet'
System.Net.Http.Formatting: ChangeSetJsonFormatter;ReadFromStreamAsync;Type='ChangeSet`1', content-type='application/json'
System.Net.Http.Formatting: ChangeSetJsonFormatter;ReadFromStreamAsync;Value read='MyCompany.Admin.Service.Data.ChangeSet`1[MyCompany.Data.Model.User]'
System.Web.Http.ModelBinding: FormatterParameterBinding;ExecuteBindingAsync;
System.Web.Http.ModelBinding: HttpActionBinding;ExecuteBindingAsync;
System.Web.Http.Controllers: UserController;ExecuteAsync;
System.Net.Http.Formatting: DefaultContentNegotiator;Negotiate;Type='HttpError', formatters=[JsonMediaTypeFormatterTracer, JsonMediaTypeFormatterTracer, FormUrlEncodedMediaTypeFormatterTracer, FormUrlEncodedMediaTypeFormatterTracer]
System.Net.Http.Formatting: JsonMediaTypeFormatter;GetPerRequestFormatterInstance;Obtaining formatter of type 'JsonMediaTypeFormatter' for type='HttpError', mediaType='application/json; charset=utf-8'
System.Net.Http.Formatting: JsonMediaTypeFormatter;GetPerRequestFormatterInstance;Will use same 'JsonMediaTypeFormatter' formatter
System.Net.Http.Formatting: DefaultContentNegotiator;Negotiate;Selected formatter='JsonMediaTypeFormatter', content-type='application/json; charset=utf-8'
System.Web.Http.Request: ;;Content-type='application/json; charset=utf-8', content-length=unknown
System.Net.Http.Formatting: JsonMediaTypeFormatter;WriteToStreamAsync;Value='System.Web.Http.HttpError', type='HttpError', content-type='application/json; charset=utf-8'
System.Net.Http.Formatting: JsonMediaTypeFormatter;WriteToStreamAsync;
System.Web.Http.Controllers: UserController;Dispose;
System.Web.Http.Controllers: UserController;Dispose;
The thread '<No Name>' (0x1ea0) has exited with code 0 (0x0).
The thread '<No Name>' (0x1d6c) has exited with code 0 (0x0).
The thread '<No Name>' (0x19b4) has exited with code 0 (0x0). 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T12:06:12.743

我终于弄清楚是什么坏了。ModelBinder [验证使用反射在 getter 上中断](https://stackoverflow.com/questions/11738421/modelbinder-validation-breaks-on-getter-using-reflection)。在那个后续问题中，我问它为什么会坏。

在这个问题中，我追求的是什么，我刚刚回答了。因此，我要结束这个问题。

# asp.net-mvc - ASP.NET MVC 中的 Jquery Ajax 调用安全性

> ID：11672867
> 
> 赞同：0
> 
> 时间：2012-07-26T15:35:25.047
> 
> 标签：asp.net-mvc, json, jquery

我的应用程序使用 jQuery Ajax 帖子来保存和更新记录。

我所有的帖子都像这样使用 JSON.stringify：

```
jQuery.ajax({
                url: '@Url.Content("~/Vendor/SaveProvider")/',
                type: 'POST',
                contentType: 'application/json',
                dataType: 'json',
                data: JSON.stringify(
                 {

                     jsonProvider: ko.toJSON(appViewModel.provider),
                     jsonAddresses: ko.toJSON(appViewModel.addresses),
                     jsonContacts: ko.toJSON(appViewModel.contacts)
                 }), 
```

我正在阅读 ASP.NET MVC 带有用于控制器调用的**ValidateAntiForgeryToken**过滤器，但我找不到任何关于如何使用 Jquery Ajax 和 JSON.stringify 使其工作的资源......

所以，我产生了这个想法，想知道它是否可以......

我知道 jQuery.Ajax 允许您发送额外的标头信息，所以我会这样做：

1.  将创建一个自定义过滤器控制器
2.  此过滤器将检查我的当前会话是否不为 NULL，并将检索用户首次登录 Web 应用程序时创建的“sessionlogid”(GUID)。
3.  将获取与包含该“sessionlogid”的 Jquery Ajax 帖子一起发送的自定义标头值，并将查看其是否相同。
4.  如果它的值相同，则让控制器离开，否则将发送错误。

我的过滤器应该是这样的：

```
public class ValidateAjaxSessionAttribute : ActionFilterAttribute
{
    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        if (filterContext.HttpContext.Request.Headers["sessionlogid"] == null ||
            filterContext.HttpContext.Request.Headers["sessionlogid"] != Session["sessionlogid"])
        {
            throw new ArgumentNullException("Invalid Request", new Exception());
        }
    }
} 
```

这有意义还是有更好的方法来保护应用程序？

感谢你的帮助！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-08-24T15:04:42.273

如果它是一个帖子使用

```
[Authorize]
[ValidateAntiForgeryToken] 
```

如果它得到使用

```
[Authorize] 
```

您也可以使用此自定义属性

```
public class HttpAjaxRequestAttribute : ActionMethodSelectorAttribute
{
    public override bool IsValidForRequest(ControllerContext controllerContext, System.Reflection.MethodInfo methodInfo)
    {
        if (!controllerContext.HttpContext.Request.IsAjaxRequest())
        {
            throw new Exception("This action " + methodInfo.Name + " can only be called via an Ajax request");
        }
        return true;
    }
}

Then decorate your action as below
[Authorize]
[HttpAjaxRequest]
public ActionResult FillCity(int State)
{
    //code here
} 
```

# asp.net-mvc-3 - 文件上传 - 自定义浏览窗口

> ID：11672875
> 
> 赞同：0
> 
> 时间：2012-07-26T15:35:46.420
> 
> 标签：asp.net-mvc-3, file-upload

我遇到了一个棘手的问题……我有这个文件上传控件，它只用于上传个人资料图片。单击它时，它会打开一个 Windows 资源管理器浏览窗口。我希望此窗口在图像文件（.jpg、.png 等）上预先选择过滤器，而我的只有“所有文件”。这就是我所说的：

![全部文件](../Images/7e163cffa4560605a17031e20f213de3.png)

我还想为该文件夹设置一个默认位置。有没有办法设置这个浏览窗口？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:38:52.200

如果您的浏览器支持 HTML5，您可以通过将`accept`标签添加到文件输入来实现这一点：

```
<input type="file" name="file" accept="image/jpg, image/gif" /> 
```

如果您的浏览器不支持 HTML5，那您就完蛋了。不支持将旧版浏览器中的文件输入对话框预过滤为某种文件类型。您将不得不使用 Flash 或一些等效的客户端脚本技术。您可能会查看一些文件上传控件，例如[Plupload](http://www.plupload.com/)、[BlueImp](https://github.com/blueimp/jQuery-File-Upload)和[Uploadify](http://www.uploadify.com/)，它们为您消除了很多麻烦。

# c - Linux 中的彩色控制台输出

> ID：11672876
> 
> 赞同：3
> 
> 时间：2012-07-26T15:35:49.130
> 
> 标签：c, linux, console-application, ansi

我刚开始学习C编程。第一个问题是选择在哪个平台上学习，我选择了Ubuntu。我找到了一个 GCC 编译器来编译我的项目，它对我来说很好用。我正在通过终端运行我编译的项目。但是当我想编写一个必须在彩色背景上显示文本的程序时，我明白终端对我没有帮助。实际上我正在从为 Windows 编程编写的课程中学习，他们在那里使用 Borland C++ 5.2，但这些课程是在 2007 年编写的

所以我想知道，我应该在 Ubuntu 10.10 的哪里运行我的编译程序，才能正确查看结果？实际上我尝试转移到 Windows，但我计算机上的 Ubuntu 运行速度要快得多，而且我认为在 Ubuntu 中工作比在 Windows 中工作更容易。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-26T20:48:41.470

无需任何工具包即可打印颜色消息的最简单方法是使用 VT100 转义命令： [http ://www.termsys.demon.co.uk/vtansi.htm#colors](http://www.termsys.demon.co.uk/vtansi.htm#colors)

所以你可以这样写：

```
printf("\x1b[31mThis is red text\x1b[0m\n");
printf("\x1b[32mThis is green text\x1b[0m\n"); 
```

但此代码仅适用于 VT100 兼容终端（几乎所有 Unix 系统终端）。最好的方法是在为输出着色之前检查 TERM 环境变量。

免责声明：如果您想编写适用于所有终端类型的代码，那么您应该使用类似 ncurses 的库。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-26T15:53:46.777

[ncurses](http://www.gnu.org/software/ncurses/ncurses.html)库完全符合您的要求。使用此库，您可以选择在屏幕上的任何位置使用任何文本/背景颜色编写任何文本。

您可以在[Wikipedia](http://en.wikipedia.org/wiki/Ncurses)上阅读更多信息。您可以使用以下命令在 ubuntu 下安装它：

```
$ sudo apt-get install libncurses5-dev 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T15:43:37.487

如果您想开始在 Linux 中进行 GUI 编程，您可能需要研究一个[GUI 工具包](http://en.wikipedia.org/wiki/Widget_toolkit)，它是一个用于编写 GUI 元素、小部件等的库。

这些工具包之一是 Gtk，您可以通过[Gtk 教程](http://developer.gnome.org/gtk-tutorial/2.90/)开始学习。另一个选择是[Qt](http://qt.nokia.com/products/)，它可能更容易使用，但它基于 C++。

恐怕 Borland C++ Windows 课程对于 Linux GUI 编程几乎是不可用的。

或者，如果您只是想要一个彩色终端文本，请查看以下问题：[stdlib and coloured output in C](https://stackoverflow.com/questions/3219393/stdlib-and-colored-output-in-c)

# sql - 上述任务的 SQL 查询

> ID：11672879
> 
> 赞同：0
> 
> 时间：2012-07-26T15:35:57.733
> 
> 标签：sql, sql-server, sql-server-2008, tsql

我有一个表格，下面有数据

```
ID       Name     Designation    
25       Vikas      SE
26       Chetu      TL
27       Mahesh     TL
28       Raghu      Mgr
29       Darshan    Mgr
30       Santhosh   Mgr 
```

现在我需要在表中再添加一列来实现这样的结果。

```
ID       Name     Designation  Appearance  
25       Vikas     SE               1
26       Chetu     TL               1
27       Mahesh    TL               2
28       Raghu     Manager          1
29       Darshan   Manager          2
30       Santhosh  Manager          3 
```

谁能帮我写查询来完成上述任务

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T15:39:45.337

您可以使用[ROW_NUMBER()](http://msdn.microsoft.com/en-us/library/ms186734.aspx)，其中您`PARTITION BY`指定：

```
SELECT ID, Name, Designation,
    ROW_NUMBER() OVER (PARTITION BY Designation ORDER BY ID) AS Appearance
FROM theTable 
```

# asp.net-mvc-3 - 如何客户端验证razor mvc3中的下拉列表框？

> ID：11672880
> 
> 赞同：2
> 
> 时间：2012-07-26T15:36:02.350
> 
> 标签：asp.net-mvc-3

如何客户端验证下拉列表框.....

```
 @Html.DropDownListFor(per => per.Gender, new[] {
                        new SelectListItem(){Text = "Male" , Value="Male"},
                        new SelectListItem(){Text ="Female" , Value = "Female"},
                    }, "Select Your Gender")
            @Html.ValidationMessageFor(per => per.Gender) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:45:50.423

在您的视图中包含 jquery 验证插件脚本以及 jQuery（如果尚未在 Layout.cshtml 中引用）

```
@model SomeModel
<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>    
@using (Html.BeginForm())
{

   @Html.DropDownListFor(per => per.Gender, new[] {
                        new SelectListItem(){Text = "Male" , Value="Male"},
                        new SelectListItem(){Text ="Female" , Value = "Female"},
                    }, "Select Your Gender")
            @Html.ValidationMessageFor(per => per.Gender)

    <input type="submit" />
} 
```

并确保 SomeModel 的 Gender 属性是必需的

```
[Required]
public string Gender { set;get;} 
```

更新您`web.config`并将调用的 AppSetting 设置`ClientValidationEnabled`为 true

```
<appSettings>
  <add key="ClientValidationEnabled" value="true" />
  <add key="UnobtrusiveJavaScriptEnabled" value="true" />
</appSettings> 
```

现在，当您提交时，如果在浏览器中启用了 javascript，它将执行客户端验证。

# wcf - WCF 服务安全，只有我的 METRO APP 客户端可以调用它

> ID：11672881
> 
> 赞同：1
> 
> 时间：2012-07-26T15:36:05.123
> 
> 标签：wcf, microsoft-metro, wcf-security

我有一个托管在 AZURE 上的 WCF 服务。此外，我还有一个使用该 WCF 服务的 Metro 应用程序客户端。我想让我的 WCF 服务安全，以便只有我的 METRO APP 客户端可以使用该 WCF 服务，即没有其他 Metro 应用程序或除我的 ABC（地铁应用程序名称）METRO APP 之外的任何应用程序能够使用 WCF 服务。我是 Metro 应用程序和 WCF 的新手。如果有人可以分享一些帮助，将不胜感激。

# c# - 如何打破列表 .ForEach() 从 C# 中的 if 语句中循环

> ID：11672882
> 
> 赞同：1
> 
> 时间：2012-07-26T15:36:05.260
> 
> 标签：c#, for-loop, foreach

我想`List<T>.ForEach()`从`if`语句中跳过循环的迭代。

我有代码：

```
 instructions.ForEach(delegate(Instruction inst)
        {                
            if (!File.Exists(inst.file))
            {
                continue; // Jump to next iteration
            }

            Console.WriteLine(inst.file);
        }); 
```

但是编译器声明没有什么可以跳出来的（大概是因为它似乎将 if 块作为封闭块？）。

有没有办法做到以上几点？之类的东西`parentblock.continue;`。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-26T15:38:14.763

使用`return`语句而不是`continue`. 请记住，通过使用 ForEach 扩展方法，您正在为每个项目执行一个函数，其主体在 { 和 } 之间指定。通过退出该函数，它将继续使用列表中的下一个值。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-26T15:38:24.060

`ForEach`在这种情况下，只是一个为列表中的每个项目执行委托的方法。它不是一个循环控制结构，所以`continue`不能出现在那里。将其重写为正常`foreach`循环：

```
foreach (var inst in instructions) {
    if (!File.Exists(inst.file))
    {
        continue; // Jump to next iteration
    }

    Console.WriteLine(inst.file);
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-26T15:41:26.523

使用 LINQ 的 Where 子句从一开始就应用谓词

```
foreach(Instruction inst in instructions.Where(i => File.Exists(i.file))){
    Console.WriteLine(inst.file);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-26T15:39:31.210

发送到 ForEach 函数的委托将对指令列表中的每个项目运行一次。要跳过一项，只需从委托函数返回。

```
 instructions.ForEach(delegate(Instruction inst)
    {                
        if (!File.Exists(inst.file))
        {
            return; // Jump to next iteration
        }

        Console.WriteLine(inst.file);
    }); 
```

# perforce - 归档/导出 Perforce 流

> ID：11672887
> 
> 赞同：1
> 
> 时间：2012-07-26T15:36:27.597
> 
> 标签：perforce, perforce-stream

我有一个 perforce 流

我想将此流存档并在项目结束时将其提供给其他人（客户端），以便他们可以将流导入他们自己的 perforce 服务器。

这可以做到吗？流可以从一个 serverA/depot1 导出，然后导入 SomeOtherServer/SomeOtherDepot。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T07:07:03.600

我打赌你可以使用[远程仓库](http://kb.perforce.com/article/30)。

首先，在Server2中[设置](http://kb.perforce.com/article/694/creating-a-remote-depot)Server1的Depot1为RemoteDepot1，这样Server2就可以从Server1拉取文件。

然后，在 Server2 中，创建流 Depot2 和主线 Stream2。然后，仍在 Server2 中时，运行：

```
p4 populate //RemoteDepot1/Stream1/... //Depot2/Stream2/... 
```

这会使用来自 Server1 的 //Depot1/Stream1 的文件为 Server2 的 //Depot2/Stream2 播种。

# android - 如何在 Android 2.1 应用程序中包含 xhdpi 设备的资产？

> ID：11672894
> 
> 赞同：0
> 
> 时间：2012-07-26T15:36:53.833
> 
> 标签：android

我有一个使用 2.1 的 Android 应用程序。我已经创建了一个 drawable-xhdpi 文件夹并将资产放入其中。我设置了 targetSdk=15，但该文件夹中的可绘制对象没有被使用。难道不能支持较新的设备并保持最低 7 的 sdk 吗？

# python - 控制for循环（python）

> ID：11672895
> 
> 赞同：4
> 
> 时间：2012-07-26T15:36:54.690
> 
> 标签：python, for-loop

我有一个程序，它在另一个 for 循环中包含一个 for 循环，它产生一行，我有一个 if 语句来检查行中的键。

这是一个例子

```
list1=[var1,var2,var3]

list2 = [file1,file2,file3]

for v in list1:
     //do stuff that returns a string, string.splitlines()
    for f in list2:
        for line in string  
           if key in line and f in line:
               print "line"
              break
           else:
              continue 
```

我得到了我正在寻找的结果，但我想控制循环，我的意思是在第一次迭代中我们有 var1，它将循环遍历 file1、file2 和 file3，然后下一次迭代 var2，它将循环遍历文件 1、文件 2、文件 3 以此类推

我将如何更改它，以便当它找到该行时，它不会继续使用 var1 而是使用 var2 然后继续？我试过以下

```
i = iter(list1)
j = iter(list2) 
```

以及打印行之后的以下内容

```
if key in line and f in line:
     print "line"
     i.next()
     j.next()
     break 
```

但这似乎没有任何作用，关于如何实现这一点的任何提示？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-26T15:44:26.440

我建议将内部的两个循环放入一个适当命名的函数中。找到密钥后，从函数返回。

```
list1=[var1,var2,var3]

list2 = [file1,file2,file3]

for v in list1:
     //do stuff that returns a string, string.splitlines()
    find_line(string) 
```

进而：

```
def find_line(string):
    for f in list2:
        for line in string  
           if key in line and f in line:
               print "line"
               return
           else:
              continue 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T15:45:02.653

您可以使用变量来控制嵌套循环的中断：

```
for v in list1:
     //do stuff that returns a string, string.splitlines()
    done = False
    for f in list2:
        if done = True:
            break
        for line in string  
           if key in line and f in line:
              print "line"
              done = True
              break
           else:
              continue 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T15:42:54.527

您可以设置一个标志来表示您何时找到它。

```
for v in list1:
 //do stuff that returns a string, string.splitlines()
    flag = False
    for f in list2:
        for line in string:
           if key in line and f in line:
               print "line"
               flag = True
               break
        if flag:
            break 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T15:44:19.670

最愚蠢的解决方案是布尔值

作为

```
for v in list1:
    # do your code here
    foundCurrentVar = False
    for f in list2:
         if foundCurrentVar: break
         for line in string  
             if key in line and f in line:
                print "line"
                foundCurrentVar = True
                break
             else:
                continue 
```

# c++ - 如何解密没有明文大小的数据？- openssl 加密 c++ ubuntu 环境

> ID：11672896
> 
> 赞同：0
> 
> 时间：2012-07-26T15:37:00.417
> 
> 标签：c++, ubuntu, encryption, openssl, aes

我有以下解密密文的函数。

但是我有一个问题，我想在没有明文长度的情况下解密数据！我怎么做？就像我发送加密数据一样，发送具有纯文本长度的密文是不合适的。

```
int main()
{
/*some code*/
char input[] = "123456789abcdef";
int olen, len;
len = strlen(input)+1;

plaintext = (char *)aes_decrypt(&de, ciphertext, &len);
/*some code*/
} 
```

解密方法

```
unsigned char *aes_decrypt(EVP_CIPHER_CTX *e, unsigned char *ciphertext, int *len)
    {
      /* plaintext will always be equal to or lesser than length of ciphertext*/
      int p_len = *len, f_len = 0;
      unsigned char *plaintext = (unsigned char *)malloc(p_len);

      if(!EVP_DecryptInit_ex(e, NULL, NULL, NULL, NULL)){
        printf("ERROR in EVP_DecryptInit_ex \n");
        return NULL;
      }

      if(!EVP_DecryptUpdate(e, plaintext, &p_len, ciphertext, *len)){
        printf("ERROR in EVP_DecryptUpdate\n");
        return NULL;
      }

      if(!EVP_DecryptFinal_ex(e, plaintext+p_len, &f_len)){
        printf("ERROR in EVP_DecryptFinal_ex\n");
        return NULL;
      }

      *len = p_len + f_len;
      return plaintext;
    } 
```

提前致谢！！:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T15:54:26.217

您实际上并不需要明文长度 - 只需要密文的长度。

EVP 可以“自动”执行和处理 PKCS #7 填充，并且默认情况下会执行此操作。PKCS #7 填充的工作方式如下：它确定需要多少个填充字符来块对齐明文以进行加密，然后获取该数字并在明文末尾重复该数字多次（以字节形式）。

例如，如果我有一个 14 字节的十六进制形式的明文块

```
61 74 74 61 63 6b 20 61 74 20 64 61 77 6e 
```

我需要将它填充到 16 个字节以进行加密，我将`02`在末尾附加两次以获得

```
61 74 74 61 63 6b 20 61 74 20 64 61 77 6e 02 02 
```

如果我的明文已经与 16 字节边界对齐，那么我`10`在明文的末尾添加 16 个字节（即 16 个十六进制）。因此，我总是可以假设明文中存在填充，无需猜测。EVP 的例程将在解密后检测填充并将其修剪掉，返回具有正确长度的原始明文。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T16:07:33.880

通常，您会在加密之前为明文添加长度指示符。这可以小到单个字节“最后一个块中的有效字节”。

# full-text-search - CRM 2011 中的全文搜索

> ID：11672899
> 
> 赞同：5
> 
> 时间：2012-07-26T15:37:05.383
> 
> 标签：full-text-search, dynamics-crm-2011

我正在围绕 Dynamics CRM 2011 的不同领域进行一些研究，并且遇到了 Articles 实体。环顾四周，我注意到功能区中的搜索选项卡，您可以在其中配置文章的不同搜索负载，包括全文搜索。这让我有点困惑，因为我总是被告知我们不能在 CRM 2011 中使用它，但看到这让我感到奇怪。

那么是否有可能在 CRM 2011 中实际使用它，或者它只是这个实体的一个特殊功能？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T15:49:41.337

全文搜索仅适用于知识库实体。

[http://msdn.microsoft.com/en-us/library/gg309378.aspx](http://msdn.microsoft.com/en-us/library/gg309378.aspx)

# audio - LibAV - 采用什么方法进行实时音频和视频捕获？

> ID：11672907
> 
> 赞同：2
> 
> 时间：2012-07-26T15:37:28.477
> 
> 标签：audio, encoding, streaming, libav

我正在使用 libav 将原始 RGB24 帧编码为 h264 并将其复用到 flv。这一切正常，我已经流式传输超过 48 小时，没有任何问题！我的下一步是将音频添加到流中。我将捕捉现场音频，我想使用 speex、mp3 或 nelly moser 对其进行实时编码。

**背景资料**

我是数字音频的新手，因此我可能做错了。但基本上我的应用程序获得了一个带有交错音频的“浮动”缓冲区。这个“audioIn”函数被我正在使用的应用程序框架调用。缓冲区每个通道包含 256 个样本，我有 2 个通道。因为我可能混用了术语，所以我是这样使用数据的：

```
// input = array with audio samples
// bufferSize = 256
// nChannels = 2
void audioIn(float * input, int bufferSize, int nChannels) {
    // convert from float to S16
        short* buf = new signed short[bufferSize * 2];
    for(int i = 0; i < bufferSize; ++i) {  // loop over all samples
        int dx = i * 2;
        buf[dx + 0] = (float)input[dx + 0] * numeric_limits<short>::max();  // convert frame  of the first channel
        buf[dx + 1] = (float)input[dx + 1] * numeric_limits<short>::max();  // convert frame  of the second channel
    }

        // add this to the libav wrapper. 
    av.addAudioFrame((unsigned char*)buf, bufferSize, nChannels);

    delete[] buf;
} 
```

现在我有一个缓冲区，其中每个样本都是 16 位，我将 this 传递`short* buffer`给我的包装`av.addAudioFrame()` 函数。在这个函数中，我在对音频进行编码之前创建了一个缓冲区。从我读到的，`AVCodecContext`音频编码器的`frame_size`. 调用时，此 frame_size 必须与缓冲区中的样本数匹配`avcodec_encode_audio2()`。我为什么这么认为，是因为[这里记录](http://libav.org/doxygen/master/group__lavc__encoding.html#ga93a49fbd0973b216dcb8a8c5dffe1d82)的内容。

然后，尤其是以下行：如果未设置，则除最后一帧外的所有帧都`frame->nb_samples`必须等于`avctx->frame_size`。*（如果我对此有误，请在此处纠正我）。

编码后，我调用`av_interleaved_write_frame()`实际写入帧。当我使用 mp3 作为编解码器时，我的应用程序运行大约 1-2 分钟，然后接收视频/音频流（flv、tcp）的服务器断开连接并显示消息“ `Frame too large: 14485504`”。生成此消息是因为 rtmp-server 正在获取一个很大的帧。这可能是因为我没有正确地与 libav 交错。

**问题：**

*   即使在浏览libav的源代码时，我也不确定有很多位，因此我希望如果有人有一个编码音频的工作示例，该示例来自来自“外部”libav的缓冲区（即您自己的）应用）。即如何为编码器创建一个足够大的缓冲区？当您需要等待此缓冲区填满时，如何使“实时”流工作？

*   正如我在上面所写的，我需要在编码之前跟踪缓冲区。其他人是否有一些代码可以做到这一点？我现在正在使用 AVAudioFifo。编码音频和填充/读取缓冲区的功能也在这里：[https ://gist.github.com/62f717bbaa69ac7196be](https://gist.github.com/62f717bbaa69ac7196be)

*   我用 --enable-debug=3 编译并禁用优化，但我没有看到任何调试信息。如何使 libav 更详细？

谢谢！

# events - 事件还是互斥锁？

> ID：11672911
> 
> 赞同：0
> 
> 时间：2012-07-26T15:37:47.160
> 
> 标签：events, mutex, critical-section

我目前有一个程序一次运行大约 20 个线程。我对多线程相当陌生，所以我对正确的数据保护有点困惑。

目前，我的线程使用事件作为数据锁定和解锁。我选择在关键部分使用它，因为大多数数据仅在两个或三个线程之间共享，因此通过停止所有 20 个线程来防止单个线程读取而一个线程写入似乎很浪费。我使用 Event over Mutex 仅仅是因为我无法（轻松地）找到一个清楚地解释 Mutex 如何工作以及如何实现的源。

我正在为我的多线程使用 Win32 API。在我当前的设置中，我使用事件来锁定数据，因此我的事件将类似于“DataUnlock” 当未设置时，我知道正在处理数据。设置后，我知道可以处理数据。所以我的临时数据锁看起来像这样。

```
WaitForSingleObject( DataUnlock,INFINITE );    //Wait until the Data is free  
ResetEvent(DataUnlock);                     //Signal that the data is being worked on   
...work on Data...    
SetEvent(DataUnlock);                       //Signal that the data is free to use 
```

我的第一个问题是：当只有两个线程访问数据时，这是否与使用 Mutex 一样好（高效）？

第二：如果有两个以上的线程等待访问数据，是否有可能在数据被释放时都被触发（在一个到达 ResetEvent 之前两者都会通过等待）？如果是这样，互斥锁会不会有同样的问题？

最后：如果互斥锁更可取，我将如何实现一个（非常感谢链接或解释）？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T17:24:04.143

我不认为事件方法是保护数据的最佳方式。

查看[互斥对象](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684266%28v=vs.85%29.aspx)和[使用互斥对象](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686927%28v=vs.85%29.aspx)以了解互斥锁。

1.  您的一个线程必须创建一个互斥锁。[CreateMutex 函数](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682411%28v=vs.85%29.aspx)返回互斥对象的句柄。您可以将句柄作为参数传递给处理数据的线程。
2.  使用[WaitForSingleObject 函数](http://msdn.microsoft.com/en-us/library/windows/desktop/ms687032%28v=vs.85%29.aspx)等待互斥体，然后处理您的数据。通过调用[ReleaseMutex 函数](http://msdn.microsoft.com/en-us/library/windows/desktop/ms685066%28v=vs.85%29.aspx)来释放互斥锁。当互斥锁被释放时，下一个等待函数将获得互斥锁。
3.  如果要由多个进程的线程访问数据，则必须使用命名互斥锁。

查看[临界区对象](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682530%28v=vs.85%29.aspx)以了解临界区同步。

如果你想拥有

1.  [必须通过调用InitializeCriticalSection 函数](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683472%28v=vs.85%29.aspx)来创建临界区。
2.  在处理数据之前，请在所有位置使用[EnterCriticalSection 函数。](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682608%28v=vs.85%29.aspx)
3.  LeaveCriticalSection[函数](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684169%28v=vs.85%29.aspx)释放临界区释放对象。完成数据后使用此调用。

临界区只能由拥有线程进入。一旦一个线程获得了临界区对象，其他线程就无法访问您的数据。其他线程将在调用`EnterCriticalSection()`. 然而，拥有临界区的线程可以`EnterCriticalSection()`多次连续调用。**每次**调用应注意调用`LeaveCriticalSection()`一次。**`EnterCriticalSection()`**

 **您的示例将让所有等待事件的线程处理您的数据。如果发生了任何类型的处理，您只能通过数据本身知道。这取决于您，如何确定已完成的工作以及仍需完成的工作。如果您有许多线程在等待您的事件，则无法确定获取访问权限的顺序。

* * *

我建议使用临界区对象。它重量轻且相对易于使用。有关如何使用临界区对象的示例，请参阅使用临界区对象[。](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686908%28v=vs.85%29.aspx)**

# xcode - 初始化可可 IB 绑定

> ID：11672912
> 
> 赞同：2
> 
> 时间：2012-07-26T15:37:51.320
> 
> 标签：xcode, cocoa, cocoa-bindings

我有一个 NSTextField 和一个 NSStepper ，我试图将它们绑定在一起。步进器设置为从 0 到 100，我想要一个初始值 30。

对于步进绑定，我有：值：绑定到对象控制器，控制器键 = 选择，模型键路径 = edgeThreshold

对于步进器属性，我有 min=0，max=100，increment=1，current=30

我已经以类似的方式设置了文本字段绑定，值：绑定到对象控制器，控制器键 = 选择，模型键路径 = edgeThreshold

当我运行程序时，一切都按我的预期工作。如果我向上踩踏，文本字段会增加。如果我输入一个新值，然后点击步进器，该值会根据我输入的值进行调整。

问题是文本字段中的初始值是什么（空），并且状态的初始值似乎是0。如果我在启动后点击步进器，文本字段从无变为1。所以我可以'不知道把 30 放在哪里，以及这个绑定的状态真正存在的地方。我认为它可能在对象控制器中，所以我将其字典设置为具有“selection.edgeThreshold”和 30 的键路径和值......但这也没有做任何事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T00:04:42.363

你真的不需要对象控制器。您可以将文本字段和步进器的值绑定到属性 edgeThreshold。因此，如果在应用程序委托中声明了该属性，它们将被绑定到 App Delegate.edgethreshold。如果您随后在 applicationWillFinishLaunching 方法中将该属性设置为 30 (self.edgethreshold = 30;)，则应用程序启动时文本字段将显示 30，并且步进器也将设置为 30（无论您使用什么将起始值设置为 IB，这将覆盖它）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T00:05:40.950

我发现了一个 youtube 视频，它几乎完全符合我的要求：

[http://www.youtube.com/watch?v=ESk6YLDtGR8](http://www.youtube.com/watch?v=ESk6YLDtGR8)

我没有实例化一个对象控制器来处理绑定，而是给我的应用控制器一些属性，然后绑定到它。在应用程序控制器的 -init 方法中，我设置了我想要的启动值。

# mysql - 根据列值排序mysql数据

> ID：11672913
> 
> 赞同：0
> 
> 时间：2012-07-26T15:37:51.410
> 
> 标签：mysql

我正在尝试从 mysql datadase 创建一个搜索引擎，它根据行中列之一的值按顺序显示信息，因此如果行 x 有一个整数值为 10 的“数量”列，则任何行 y 都有'数量'值为 20，第 x 行应首先回显，因此最大值在顶部，最小值在底部（不偏好相等的值）。或者头韵找到一种mysql表自动按这种方式排序数据的方法。有什么我可以使用的功能吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T15:41:42.617

像这样使用 ORDER BY 子句：

```
SELECT * FROM table ORDER BY quantity DESC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T15:42:16.117

要以特定顺序从查询中返回行，请使用该`ORDER BY`子句。要让它们从最高值到最低值返回，请指定`DESC`（降序）关键字。例如：

```
SELECT f.quantity
  FROM foo f
 ORDER BY f.quantity DESC 
```

您是对的，无法保证行在存储时将如何物理排序。您唯一的保证是`ORDER BY`条款。

# c++ - 带有 C++ 插件的 Protobuf

> ID：11672917
> 
> 赞同：2
> 
> 时间：2012-07-26T15:38:06.667
> 
> 标签：c++, protocol-buffers

我们正在开发一个相对大型的 C++ 项目，我们一开始就选择使用 protobuf 作为我们的*通用语*来存储和传输数据。

我们遇到了第一个问题，因为 protobuf 生成的类元数据存储为静态指针，在第一次调用构造函数期间分配并且从未释放，导致程序结束内存泄漏。我们发现谷歌先生提供了一个很好的功能来做这个清理：

```
google::protobuf::ShutdownProtobufLibrary(); 
```

工作正常，除了没有对称调用，所以一旦完成，你就不能再使用任何东西了。您必须在可执行文件中准确地执行一次。我们做了任何懒惰的开发者都会做的事情：

```
struct LIBPROTOBUF_EXPORT Resource
{
    ~Resource()
    {
        google::protobuf::ShutdownProtobufLibrary();
    }
};

bool registerShutdownAtExit()
{
    static Resource cleaner;
    return true;
} 
```

并且我们在protobuf生成的`cc`文件中添加了一个：

```
static bool protobufResource = mlv::protobuf::registerShutdownAtExit(); 
```

它工作了几个月。

然后我们在我们的工具中添加了对动态可加载插件 (dll) 的支持。其中一些使用protobuf。插件的卸载工作正常，但是当其中多个插件使用 protobuf 时，我们在卸载最后一个插件时发生了一个不错的小崩溃。原因：最后一个卸载会破坏`cleaner`实例，它`google::protobuf::ShutdownProtobufLibrary()`自己试图破坏，它自己试图破坏卸载类型的元数据......崩溃。

长话短说：在关闭我们的工具时，我们是否注定要发生大量“正常”内存泄漏或崩溃。有没有人遇到过同样的问题并找到了更好的解决方案？我的诊断不好吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:18:54.680

就像 johnathon 在他的评论中建议的那样，使用引用计数方案，或者使用`atexit`. 这样的例程是独立的，但这可能适用于您的情况。

相关文件：

*   [MSDN](http://msdn.microsoft.com/en-us/library/tze57ck3.aspx)
*   [POSIX](http://pubs.opengroup.org/onlinepubs/9699919799/functions/atexit.html)

**编辑：**你是对的，它基本上是一样的。没想到这一点。

另一个建议：对所有使用 protobuf 的插件使用全局资源单例。这个有一个全局析构函数，仅在插件第一次使用 protobuf 库时才注册。或者只是在使用时设置一个标志，然后仅在设置标志时调用 ShutdownProtobufLibrary。

# jquery - jQuery验证 - 正确时删除错误标签

> ID：11672919
> 
> 赞同：0
> 
> 时间：2012-07-26T15:38:11.170
> 
> 标签：jquery, jquery-validate

我正在使用[jQuery 验证插件](http://docs.jquery.com/Plugins/Validation)，并且我已经设置了我的 errorPlacement，以便标签会很好地淡入淡出和动画，但我似乎无法找出我需要使用什么回调来执行反向操作，即当字段有效时如何删除类似的错误？

我曾尝试使用成功功能，但无济于事。一旦有效，错误就会消失......

代码片段

```
errorPlacement: function (error, element) {
    error.appendTo(element.parent().parent().find(".propertyFeedback"));
    error.css({ "margin-left": "-10px", opacity: 0 });
    error.animate({ "margin-left": "0px", opacity: 1 });
},
success: function (error, element) {
    error.show().animate({ "margin-left": "-10px", opacity: 0 });
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T11:41:54.070

你打电话给[http://docs.jquery.com/Plugins/Validation/valid](http://docs.jquery.com/Plugins/Validation/valid)了吗？

所以你需要类似的东西`if ( $("#myform").valid() ) {}`

# sql - SQL :: 如何查找搜索字符串中最常见的记录（标签字段）

> ID：11672923
> 
> 赞同：0
> 
> 时间：2012-07-26T15:38:15.007
> 
> 标签：sql, sql-server, sql-server-2008, tsql

我们有 tbl_Articles：

```
id    title       tags
=================================
1     article1    science;
2     article2    art;
3     article3    sports;art; 
```

我正在寻找一个查询以从 tbl_Articles 返回记录，这些记录具有带有特定标签字符串的**最常见单词（例如：political** **;art;**）：

*EX：*选择（来自 tbl_articles）标签在“ political **;art;** ”*中常见的地方*

 ***结果：*

tbl_Articles

```
id    title       tags
=================================
2     article2    art;
3     article3    sports;art; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T15:43:27.223

你在找这个吗？

```
select a.*
from articles a
where ';'+tags+';' like '%;politics;%' and
      ';'+tags+';' like '%;art;%' 
```

请注意，我在开头和结尾使用了分隔符，因此您可以将“art”和“smart”作为标签。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T15:57:10.143

`LIKE predicate` **您可以使用BUT**完成此任务，请注意它仅适用于`Character Patterns`.

我认为您正在寻找**[全文查询](https://amitpatriwala.wordpress.com/2008/08/11/fulltext-search-in-sqlserver-2005/)**。`Free Text`不仅返回准确的措辞，而且还返回最近的含义。

有关更多详细信息，**[请检查](https://amitpatriwala.wordpress.com/2008/08/11/fulltext-search-in-sqlserver-2005/)**以下类型..

1.  自由文本

2.  自由文本

3.  包含

4.  包含稳定的

`Full-Text`在查询大量非结构化文本数据时，可以最好地实现使用搜索的性能优势。针对数百万行文本数据的`LIKE`查询（例如，'%microsoft%'）可能需要几分钟才能返回；而`Full-Text`针对相同数据的查询（对于“microsoft”）可能只需要几秒钟或更短的时间，具体取决于返回的行数。**

# ms-access - 级联组合框

> ID：11672930
> 
> 赞同：0
> 
> 时间：2012-07-26T15:38:25.747
> 
> 标签：ms-access, vba, ms-access-2010, office-2010

复制自：[https ://softwareengineering.stackexchange.com/questions/158330/cascading-comboboxes](https://softwareengineering.stackexchange.com/questions/158330/cascading-comboboxes)

好的，所以我在 Access 2010 中有一个表单，其中包含 1 个文本框和 3 个组合框（1 个启用和 2 个禁用）。

第一个 ComboBox 不绑定到数据源，但对其他 2 个组合框是主观的。所以我处理了第一个 Combobox 的 Click 事件，然后启用其他 2 个，并使用基于第一个 ComboBox 值动态构建的自定义 RowSource SQL 脚本预加载第二个 ComboBox。

这一切都适用于新信息，但是当我通过表单查看信息时，它会回到控件上的新模式。

问题：我需要处理什么事件来检查当前表单数据是否包含控件的控件源的数据？

正如我将在 Logic 中表达的那样（它是 C 和 VB 的混合体，我知道但应该跨越 pt）：

```
DataSet ds = Form.RowSet
if (ds = Null) then 
  cbo2.enabled = false
  cbo3.enabled = false
else
  cbo2.rowsource = "select id, nm from table"
  cbo2.value = ds(3)
  cbo3.value = ds(4)
end if
... do some other logic ... 
```

更新的逻辑 - 仍然存在问题，由于某种原因无法捕获 RecordStatus（给出 3251 运行时错误）

```
Private Sub Form_Current()
    Dim boolnm As Boolean: boolnm = (IsNull(txtName.Value) Or IsEmpty(txtName.Value))
    Dim booltype As Boolean: booltype = IsNull(cboType.Value)
    Dim boolfamily As Boolean: boolfamily = IsNull(cboType.Value)
    Dim boolsize As Boolean: boolsize = IsNull(cboType.Value)

    Dim rs As DAO.Recordset: Set rs = Me.Recordset
    MsgBox rs.AbsolutePosition

'    If rs.RecordStatus = dbRecordNew Then
'        MsgBox "New Record being inserted, but not committed yet!", vbOKOnly
'    Else
'        MsgBox rs(0).Name & " - " & rs(0).Value & vbCrLf & _
'            rs(1).Name & " - " & rs(1).Value & vbCrLf & _
'            rs(2).Name & " - " & rs(2).Value & vbCrLf & _
'            rs(3).Name & " - " & rs(3).Value
'    End If
    'MsgBox "Name: " & CStr(boolnm) & vbCrLf & _
            "Type: " & CStr(booltype) & vbCrLf & _
            "Family: " & CStr(boolfamily) & vbCrLf & _
            "Size: " & CStr(boolsize), vbOKOnly

End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T16:10:14.873

这是最终结果，在 Remou 的帮助下，这只是最终结果的前奏（这超出了问题的范围）。

```
Private Sub Form_Current()

    If Me.NewRecord Then   <=======================
        cboType.Value = 0
        cboType.Enabled = True
        cboFamily.Enabled = False
        cboSize.Enabled = False
    Else
        Dim rs As DAO.Recordset: Set rs = Me.Recordset
        'get Family ID
        Dim fid As String: fid = rs(2).Value
        'Build SQL Query to obtain Type ID
        Dim sql As String
        sql = "select tid from tblFamily where id = " & fid
        'Create Recordset
        Dim frs As DAO.Recordset
        'Load SQL Script and Execute to obtain Type ID
        Set frs = CurrentDb.OpenRecordset(sql, dbOpenDynaset, dbReadOnly)
        'Set Type ComboBox Value to Type ID
        cboType.Value = frs(0)
        cboType_Click 'Simulate Click Event since the Value has changed

        'Make sure all 3 Comboboxes are enabled and useable
        cboType.Enabled = True
    End If

End Sub 
```

# javascript - 通过子数组处理数组

> ID：11672931
> 
> 赞同：1
> 
> 时间：2012-07-26T15:38:25.727
> 
> 标签：javascript, arrays

假设我们有一个可变长度的数组，我想通过最大长度为 100 的块来处理它，并以最小数量的块来处理它。因此，对于长度为 241 的数组，它将是 3 个大小为 41、100、100（或 100、100、41）的子数组。

```
curr_len = arr.length;
offset = curr_len%100;
doSomethingWithSubArray(arr.slice(offset))

for(j = offset; j <= curr_len; j = j+100){
    doSomethingWithSubArray(arr.slice(j,j+100))
} 
```

我确信有更优雅的方法可以做到这一点，可能没有 for 循环之前的特殊情况。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T15:49:33.737

我希望最后一块的尺寸更小。那么代码将是：

```
for (var i=0; i<arr.length; i+=100)
    doSomethingWithSubArray(arr.slice(i, 100)); 
```

这正是我的 splitBy 函数所做的：

```
Array.prototype.splitBy = function(n) {
/* get: number of items per array
return: array of n-sized arrays with the items (last array may contain less then n) */
    for (var r=[], i=0; i<this.length; i+=n)
        r.push(this.slice(i, i+n));
    return r;
} 
```

然后只写：

```
arr.splitBy(100).forEach(doSomethingWithSubArray); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T15:50:49.243

使用分块功能~

```
function chunk(a, s){
    for(var x, i = 0, c = -1, l = a.length, n = []; i < l; i++)
        (x = i % s) ? n[c][x] = a[i] : n[++c] = [a[i]];
    return n;
}

console.log(chunk([1,2,3,4,5,6,7,8,9,10], 3)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-30T14:04:25.567

它是函数式递归解决方案。没有 var，没有循环，没有计数，因为它更清晰

```
var chunk = function(arr, n){
    if (arr.length == 0) return [];
    var head = arr.slice(0, n), rest = arr.slice(n);

    return [head].concat( chunk(rest, n) );
};

console.log(chunk([1,2,3,4,5,6,7,8,9,10], 3));​ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T15:49:22.957

不是真的，使用[reduce](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/Reduce)看起来像这样：

```
var array = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11];

var splitArrays = array.reduce(function(arr, cur, i) {
    if (i % 3 === 0) arr.push([]);
    arr[i / 3 | 0].push(cur);
    return arr;
}, []);
//splitArrays looks like:
//[[1,2,3],[4,5,6],[7,8,9],[10,11]] 
```

更通用的功能

```
function splitArray(array, num) {
    return array.reduce(function(arr, cur, i) {
        if (i % num === 0) arr.push([]);
        arr[i / num | 0].push(cur);
        return arr;
    }, []);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-26T15:51:05.210

让您的`doSomethingWithSubArray`函数接受起始索引并返回下一个未处理`null`的索引，或者如果没有更多工作。把这个“迭代器”放在一个`while`循环中。在条件中调用此“迭代器”之后，立即在块之间执行其余工作（更新 UI？）`while`。

# php - 在 Magento 中克隆产品模型/对象

> ID：11672934
> 
> 赞同：2
> 
> 时间：2012-07-26T15:38:34.793
> 
> 标签：php, magento, clone, product

是否可以在 Magento 中克隆产品模型/对象实例？基本上，我正在关注产品的保存事件，并希望根据主产品自动创建子产品。除了 SKU 和属性外，这些信息基本相同。我试过这个：

```
$product = clone $parent_product;
$product->setName('I am testing');
$product->save(); 
```

但它不起作用。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:04:04.283

我觉得你需要看看`Mage_Catalog_Model_Product->duplicate()`

# c# - 扩展 C# List.Last

> ID：11672937
> 
> 赞同：1
> 
> 时间：2012-07-26T15:38:39.363
> 
> 标签：c#, arraylist, extension-methods

Lists 的 .Last() 方法只返回一个值。我希望能够做这样的事情。

```
 List<int> a = new List<int> { 1, 2, 3 };
  a.Last() = 4; 
```

这是我编写扩展方法的尝试（它不会编译）

```
public unsafe static T* mylast<T>(this List<T> a)
{
   return &a[a.Count - 1];
} 
```

我想做的事可能吗？

编辑：

这是我想使用它的一个例子。

```
 shapes.last.links.last.points.last = cursor;   //what I want the code to look like
 //how I had to write it.
 shapes[shapes.Count - 1].links[shapes[shapes.Count - 1].links.Count - 1].points[shapes[shapes.Count - 1].links[shapes[shapes.Count - 1].links.Count - 1].points.Count-1] = cursor; 
```

这就是为什么做

```
shapes[shapes.Count-1] 
```

并不是真正的解决方案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-26T15:43:10.700

只需使用

```
a[a.Count-1] = 4; 
```

或者写一个扩展方法

```
a.SetLast(4); 
```

即使您可以创建一个虚假扩展属性，这也不是一个好主意。如果解决方案涉及不安全的代码，这会加倍。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-26T15:44:55.337

C#中没有[扩展属性](https://stackoverflow.com/q/619033/706456)。但这是您可以使用的扩展方法：

```
public static class ListEx
{
    public static void SetLast<T>(this IList<T> list, T value)
    {
        if (list == null)
            throw new ArgumentNullException("list");
        if(list.Count == 0)
            throw new ArgumentException(
                "Cannot set last item because the list is empty");

        int lastIdx = list.Count - 1;
        list[lastIdx] = value;
    }

    //and by symmetry
    public static T GetLast<T>(this IList<T> list)
    {
        if (list == null)
            throw new ArgumentNullException("list");
        if (list.Count == 0)
            throw new ArgumentException(
                "Cannot get last item because the list is empty");

        int lastIdx = list.Count - 1;
        return list[lastIdx];
    }
} 
```

这是如何使用它

```
class Program
{
    static void Main(string[] args)
    {
        List<int> a = new List<int> { 1, 2, 3 };
        a.SetLast(4);
        int last = a.GetLast(); //int last is now 4
        Console.WriteLine(a[2]); //prints 4
    }
} 
```

如果你愿意，你可以调整验证行为。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-26T15:43:42.197

您可以创建设置最后一个元素的扩展方法。

为简单起见，这是没有错误检查的外观：

```
public static class ListExtensions
{
    public static void SetLast<T>(this IList<T> source, T value)
    {
        source[source.Count - 1] = value;
    }
} 
```

当然，如果您想正确执行此操作，还需要进行错误检查：

```
public static void SetLast<T>(this IList<T> source, T value)
{
    if (source == null)
    {
        throw new ArgumentNullException("source");
    }

    if (source.Count == 0)
    {
        throw new ArgumentException("cannot be empty", "source");
    }

    source[source.Count - 1] = value;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-26T15:45:58.597

我会推荐 Thom Smith 的解决方案，但如果您真的想拥有类似属性的访问权限，为什么不直接使用属性呢？

```
public class MyList<T> : List<T>
{
    public T Last
    {
        get
        {
            return this[this.Count - 1];
        }
        set
        {
            this[this.Count - 1] = value;
        }
    }
} 
```

像这样使用：

```
var m = new MyList<int> { 1, 2, 3 };
m.Last = 4;
Console.WriteLine(m.Last); 
```

没有不安全的代码，所以更好。此外，它并不排除使用 LINQ 的`Last`方法（编译器可以根据它们的使用方式将两者区分开来）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-26T15:45:45.117

```
public class AdvancedList : List<int>
{
    public int Last
    {
        get { return this[Count - 1]; }
        set
        {
            if(Count >= 1 )
                this[Count - 1] = value;
            else
                Add(value);
        }
    }
}

AdvancedList advancedList = new AdvancedList();
advancedList.Add(100);
advancedList.Add(200);

advancedList.Last = 10;

advancedList.Last = 11; 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-07-26T15:43:02.663

你可能会说：如果你想设置最后一个值：更酷的是传递一个新值：

```
 public static void SetLast(this List<int> ints, int newVal)
    {
         int lastIndex = ints.Count-1;
         ints[lastIndex] = newVal;
    } 
```

# facebook - 可变子域 facebook 连接

> ID：11672943
> 
> 赞同：0
> 
> 时间：2012-07-26T15:38:51.500
> 
> 标签：facebook, subdomain

新版本的网站还没有准备好。这就是我们使用子域的原因。为了使链接更加用户友好，我们将链接设置为类似`userName.site.com`或此时`userName.dev.site.com`而不是`dev.site.com/userName`

**主网址**

开发网站

**一些示例网址**

jack.dev.site.com

stefan.dev.site.com

如果我尝试在这个 url **dev.site.com**上使用 facebook 登录，一切正常。但是当我去**jack.dev.site.com**时，如果我尝试登录，我不再登录，facebook 返回一个错误。然后，如果我去**dev.site.com** ，我实际上已经登录。

我尝试

```
document.domain = "dev.site.com"; 
```

没有效果。有任何想法吗 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T15:35:29.820

如果我理解正确，您的应用程序有 2 个版本，一个是“live”，一个是“beta”。由于这两个版本位于不同的子域中，因此您必须在 facebook 上创建两个应用程序。也就是说，同一个应用程序不能托管在两个不同的子域上。

# xcode4 - 如何删除旧的不需要的设备？

> ID：11672945
> 
> 赞同：8
> 
> 时间：2012-07-26T15:38:51.837
> 
> 标签：xcode4, ios-simulator

所以这与我之前发布的一个问题有关 -[如何删除 4.3 模拟器](https://stackoverflow.com/q/10834817/96716)。我愚蠢地安装了 iOS 5.0 模拟器，现在我上一篇文章中提供的技术不起作用。当您删除 5.0sdk，然后重新启动 Xcode 时，它​​会强制您安装旧版模拟器或退出。

我什至删除了 Xcode 4.4 并重新安装它无济于事（它必须将我不幸的选择存储在首选项文件的深处）。

我想摆脱它的原因是，Scheme 弹出窗口现在有 5 个选项而不是 3 个，这使得测试通用应用程序变得非常痛苦。

**编辑：**

当我 cd to`~/Library/Caches/com.apple.dt.Xcode/Downloads`我看到：

```
$ ls

Xcode.SDK.iPhoneSimulator.5.0-5.0.0.1.dmg
Xcode.SDK.iPhoneSimulator.5.0-5.0.1.1.dmg
eded78df8bfabaf6560841d10cf8e53766f74f28.dvtdownloadableindex
f7133e82a08bdb4ebf724f16beed2bbac2a265cf.dvtdownloadableindex

$ 
```

我的机器上同时安装了 Xcode 4.4 和 4.5DP3，因此假设前两个文件是每个 Xcode 版本的一个文件——无论如何我都将两者都移到了 /tmp。

较早的建议是删除：

> /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator5.0.sdk

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-08-03T07:11:52.053

除了删除 iPhoneSimulator5.0.sdk 文件夹外，删除 .dmg 中对应的 .dmg 文件`~/Library/Caches/com.apple.dt.Xcode/Downloads`。这样 Xcode 就不会再强迫你重新安装它了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-23T22:18:25.203

在终端中执行以下操作：

```
cd ~/Library/Caches/com.apple.dt.Xcode/Downloads
ls 
```

您现在会看到文件；然后运行 ​​bash 命令删除它们。

# html - 使用 css 设置图像标题属性的样式？

> ID：11672946
> 
> 赞同：7
> 
> 时间：2012-07-26T15:38:56.133
> 
> 标签：html, css

我想为我们将鼠标悬停在图像上时看到的文本设置样式。我尝试了以下方法，但它不起作用：

```
<body>
    <img src="img.jpg" title = "<span class='title'> title </span>
</body> 
```

我的风格在`head`. 我想知道为什么它显示为纯文本以及为什么样式不起作用。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-07-26T16:36:07.520

没有什么是不可能的。[将 Andres Ilich 的解决方案](https://stackoverflow.com/a/2011199/2193439)编辑为问题：[如何更改锚标签内 Title 属性的样式？](https://stackoverflow.com/questions/2011142/how-to-change-the-style-of-title-attribute-inside-the-anchor-tag)

```
a {
  color: #900;
  text-decoration: none;
}

a:hover {
  color: red;
  position: relative;
}

a[data]:hover:after {
  content: attr(data);
  padding: 4px 8px;
  color: rgba(0,0,0,0.5);
  position: absolute;
  left: 0;
  top: 100%;
  white-space: nowrap;
  z-index: 2;
  border-radius: 5px ;
  background: rgba(0,0,0,0.5);
}
```

```
<a data="This is the CSS tooltip showing up when you mouse over the link"href="#" class="tip">Link</a>
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-26T15:40:23.070

IMG 标记中的标题属性不能包含 HTML，因此您不能这样做。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-26T15:45:06.080

直接在 html 中是不可能的，它将在未来使用 html5`figure`和`figcaption`元素，或者使用 jquery 是可能的！有关这些元素的更多信息，请参阅[HtmlDoctor](http://html5doctor.com/the-figure-figcaption-elements/)！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-01-17T19:38:56.027

另一个很棒的小提琴是[http://jsfiddle.net/tDQWN/129/](http://jsfiddle.net/tDQWN/129/) （我不能相信，但在同一个搜索中我找到了两个帖子）。这是一个类似的解决方案，但样式有点花哨。

```
a {
  color: #900;
  text-decoration: none;
}

a:hover {
  color: red;
  position: relative;
}

a[data-title]:hover:after {
  content: attr(data-title);
  padding: 4px 8px;
  color: #333;
  position: absolute;
  left: 0;
  top: 100%;
  white-space: nowrap;
  z-index: 20px;
  -moz-border-radius: 5px;
  -webkit-border-radius: 5px;
  border-radius: 5px;
  -moz-box-shadow: 0px 0px 4px #222;
  -webkit-box-shadow: 0px 0px 4px #222;
  box-shadow: 0px 0px 4px #222;
  background-image: -moz-linear-gradient(top, #eeeeee, #cccccc);
  background-image: -webkit-gradient(linear,left top,left bottom,color-stop(0, #eeeeee),color-stop(1, #cccccc));
  background-image: -webkit-linear-gradient(top, #eeeeee, #cccccc);
  background-image: -moz-linear-gradient(top, #eeeeee, #cccccc);
  background-image: -ms-linear-gradient(top, #eeeeee, #cccccc);
  background-image: -o-linear-gradient(top, #eeeeee, #cccccc);
} 
```

和 HTML：

```
<p>Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. <a href="#" data-title="Hello, i am a link">Vestibulum</a> tortor quam, feugiat vitae, ultricies eget, tempor sit amet, ante. Donec eu libero sit amet quam egestas semper. Aenean ultricies mi vitae est. <a href="#" data-title="This is another link">Mauris placerat</a> eleifend leo.</p> 
```

希望这对某人有帮助！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-12-01T09:28:33.807

你可以这样做——

```
a.tip {
    border-bottom: 1px dashed;
    text-decoration: none
}
a.tip:hover {
    cursor: help;
    position: relative
}
a.tip span {
    display: none
}
a.tip:hover span {
    border: #c0c0c0 1px dotted;
    padding: 5px 20px 5px 5px;
    display: block;
    z-index: 100;
    left: 0px;
    margin: 10px;
    width: 250px;
    position: relative;
    top: -150px;
    text-decoration: none
}
```

```
<a href="#" class="tip">
   <img src="http://www.w3schools.com/html/pic_mountain.jpg">
   <span>This is the CSS tooltip showing up when you mouse over the link</span>
</a>
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-26T15:43:14.380

从[HTML 规范](http://www.whatwg.org/specs/web-apps/current-work/multipage/elements.html#the-title-attribute)（强调我的）：

> title 属性表示元素的建议信息，例如适合工具提示的信息。在链接上，这可以是目标资源的标题或描述；在图像上，它可以是图像信用或图像描述；在一个段落上，它可以是一个脚注或对案文的评论；在引文中，可能是有关来源的更多信息；在交互式内容上，它可以是元素使用的标签或说明；等等。**值为文本。**

因此，属性中只允许使用*文本。*`title`对于自定义 HTML 工具提示，您必须使用自定义解决方案，例如默认隐藏内容并`:hover`使用 CSS 显示，或使用 JavaScript 从`data-...`属性中提取。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-26T15:47:54.303

如果您想要在鼠标悬停图像时显示文本，您可以使用 CSS`:hover`状态执行某些操作。

[此博客文章](https://kyleschaeffer.com/pure-css-image-hover)中描述了这样的解决方案。

# shell - 文件中的 awk 搜索模式。替换匹配的行并打印，因为它不匹配

> ID：11672970
> 
> 赞同：3
> 
> 时间：2012-07-26T15:39:52.387
> 
> 标签：shell, replace, sed, awk, match

我有一个像这样的 TAB 分隔文件：

示例.rpt：

```
54 67 common/bin/my/home {{bla bla bla}} {bla bla} ReplaceMe

89 75 bad/rainy/day/out {{ some bla} } {some bla} DontreplaceMe 
```

我希望对第 3 项进行正则表达式匹配，例如`common/bin/my/home` ，如果有匹配项，我想`Replace Me`用我自己的文本替换第 6 项，例如`happy Home`

另外我的正则表达式将是一个shell变量，所以我需要一个接受正则表达式作为变量的命令

这些项目可能有空格或反斜杠，并且文件是制表符分隔的。

为了实现这一点，我使用了以下 awk one-liner：

下面我正在检查字段 3 是否与 drv 指定的模式匹配，然后执行大括号 {} 中的任何内容

```
awk -F "\t" -v drv=$mod_pat '$3 ~ drv \
  { OFS= "\t"; $6 = " happy_home"; print;}' sample.rpt 
```

现在的问题是如果模式不匹配，我只想打印未触及的行。这可能在同一个命令中吗？

我试过了：

```
awk -F "\t" -v drv=$mod_pat \
  'if ($3 ~ drv) { OFS= "\t"; $6 = " happy_home"; print;} else {print;}' sample.rpt 
```

但它抛出解析错误。可能是 awk 语法有问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T15:50:30.827

`1`是具有默认操作的模式 `{print $0}`
[http://www.gnu.org/software/gawk/manual/html_node/Very-Simple.html](http://www.gnu.org/software/gawk/manual/html_node/Very-Simple.html)

```
awk -F\t -v OFS=\t -v drv="home" '$3~drv{$6=" happy_home"} 1' sample.rpt 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T15:45:38.063

如果要使用“ ”语句，则需要`{}`围绕程序。例如：`awk``if`

```
awk -F "\t" -v drv=$mod_pat '{ if ($3 ~ drv) { OFS= "\t"; $6 = " happy_home"; print;} else {print;} }' sample.rpt 
```

# bash - 将 grep & cut 的结果放入 bash 脚本中的变量中

> ID：11672971
> 
> 赞同：4
> 
> 时间：2012-07-26T15:39:53.197
> 
> 标签：bash, curl, grep, cut

我是 Stackoverflow 的新手，对 bash 脚本也很陌生，所以请原谅我提出这样一个愚蠢的问题。我真的在这里浏览了很多答案，但似乎没有什么对我有用。

我正在尝试制作这个小脚本来检查 wordpress.org 的最新版本，并检查我是否已经将该文件与脚本所在的目录放在同一目录中：

```
#!/bin/bash

function getVersion {
new=$(curl --head http://wordpress.org/latest.tar.gz | grep Content-Disposition | cut -d '=' -f 2)
echo "$new"
}

function checkIfAlreadyExists {
    if [ -e $new ]; then
        echo "File $new does already exist!"
    else
        echo "There is no file named $new in this folder!"
    fi
}

getVersion
checkIfAlreadyExists 
```

它有点像输出：

```
jkw@xubuntu32-vb:~/bin$ ./wordpress_check 
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
wordpress-3.4.1.tar.gz
 in this folder! named wordpress-3.4.1.tar.gz
jkw@xubuntu32-vb:~/bin$ 
```

所以我用 curl&grep&cut 得到了正确的文件名，但是变量有问题。当我在第 5 行打印时，它看起来还不错，但是当我在第 12 行打印时，它看起来很有趣。此外，if 语句不起作用，我确实在同一目录中有文件。

如果我输出 curl --head [http://wordpress.org/latest.tar.gz](http://wordpress.org/latest.tar.gz)的结果| grep 内容处置 | cut -d '=' -f 2 在文本文件中，最后我似乎得到了一个新行，这可能是问题吗？如果我将命令通过管道传输到 xdd，它看起来像这样：

```
 % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
0000000: 776f 7264 7072 6573 732d 332e 342e 312e  wordpress-3.4.1.
0000010: 7461 722e 677a 0d0a                      tar.gz.. 
```

..我无法理解。

我试图通过*tr '\n' '\0'*或*tr -d '\n'*按照这里很多类似问题中的建议通过管道传输命令，但它似乎什么也没做。有任何想法吗？

PS：我也想知道线条在哪里..

```
 % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0 
```

..来我的shell输出。当我在终端中只运行命令*curl --head [http://wordpress.org/latest.tar.gz](http://wordpress.org/latest.tar.gz)*时，输出没有任何这样的行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T08:10:49.310

这是您的代码的工作版本，其中注释了更改的原因。

```
#!/bin/bash

function latest_file_name {
    local url="http://wordpress.org/latest.tar.gz"

    curl -s --head $url | # Add -s to remove progress information
    # This is the proper place to remove the carridge return.
    # There is a program called dos2unix that can be used as well.
    tr -d '\r'          | #dos2unix
    # You can combine the grep and cut as follows
    awk -F '=' '/^Content-Disposition/ {print $2}'
}

function main {
    local file_name=$(latest_file_name)

    # [[ uses bash builtin test functionality and is faster.
    if [[ -e "$file_name" ]]; then
        echo "File $file_name does already exist!"
    else
        echo "There is no file named $file_name in this folder!"
    fi
}

main 
```

# django - post_syncdb 上不存在 ContentType 匹配查询

> ID：11672976
> 
> 赞同：4
> 
> 时间：2012-07-26T15:40:04.947
> 
> 标签：django, signals, syncdb, contenttype

`post_syncdb`我正在尝试使用信号在创建表后立即向数据库添加一些数据。

```
signals.post_syncdb.connect(init) 
```

然后在init函数中，我要设置权限，所以我用

```
ct = ContentType.objects.get(app_label='news', model='Article')
Permission(name='Approve articles', codename='can_approve_article', content_type=ct) 
```

但是，如果我放下所有桌子并运行`syncdb`，我会得到

```
...
File "...\base\functions\init.py", line 11, in init
  ct = ContentType.objects.get(app_label='news', model='Article')
...
django.contrib.contenttypes.models.DoesNotExist: ContentType matching query does not exist. 
```

我做过的一些测试：

*   如果我在外面尝试这段代码，它工作正常`syncdb`。
*   如果我让`syncdb`创建没有此代码的所有表，然后添加此代码并运行 syncdb 而无需进行任何更改，它也可以正常工作。
*   而且我很确定它曾经可以工作，但是从那以后我在其他地方改变了很多东西，所以我不知道从哪里开始。
*   对于不同应用程序中的其他模型，我得到相同的错误。
*   信号被触发大约 10 次，只有前几次抛出错误。

非常感谢任何提示！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-07-12T12:15:28.950

将此添加到 init 函数的开头：

```
 from django.contrib.contenttypes.management import update_all_contenttypes
 update_all_contenttypes() # make sure all content types exist 
```

# jquery - 结合 jquery .before() 和 .slideDown() 或持续时间

> ID：11672977
> 
> 赞同：2
> 
> 时间：2012-07-26T15:40:07.427
> 
> 标签：jquery

我有一个评论列表。用户提交新评论后，我希望新提交的评论显示在添加评论表单之前。到目前为止，我已经让它工作了，但我希望 .before 成为动画。

更具体地说，我试图让 .before() 动作动画/滑动而不是仅仅显示。我目前有以下用于显示的代码。

```
el.find(".add-comment").before(new_comment); 
```

我查看了 jquery .before() 并没有看到持续时间参数。我也试过这个，但它不起作用：

```
el.find(".add-comment").before(new_comment).slideDown(); 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T16:24:32.753

您是否尝试使用`insertBefore()`insted 或 using `before()`？他们执行相同的任务，但逻辑相反。这样，您可以`slideDown()`在插入代码之前调用该函数。但是，我建议在执行插入操作之前隐藏插入的代码。

在你的情况下：

```
new_comment.hide().insertBefore(el.find(".add-comment")).slideDown(); 
```

我假设它`new_comment`已经是 JQuery 对象（如果它是 HTML 字符串，则`$(new_comment)`改为使用）。

但是，有时您添加的那段代码会让您的代码无法正常工作。当我`li`同时添加多个元素时，它发生在我身上。在这种情况下，由于您正在添加应该自动向下滑动窗口的新代码，因此我建议使用基于`fadeIn()`.

```
new_comment.hide().insertBefore(el.find(".add-comment")).fadeIn('slow'); 
```

这样，当窗口通过插入新代码而向下滑动时，fadeIn 函数就会提供这样的“slideDown”效果。我知道，它有点褪色。

# javascript - 带类的事件处理程序

> ID：11672979
> 
> 赞同：1
> 
> 时间：2012-07-26T15:40:15.613
> 
> 标签：javascript, html, event-handling

我有一些具有相同课程的 div。当我单击其中一个 div 时，我想将显示从其他 div 更改为“阻止”。我目前正在使用内联 javascript，但我想在没有内联 javascript 的情况下使用它。我现在拥有的：

```
<div class="test_a" id="example_a" onclick="testfunction(this)"></div>
<div class="test_a" id="example_b" onclick="testfunction(this)"></div>
<div class="test_a" id="example_c" onclick="testfunction(this)"></div>
<div class="test_a" id="example_d" onclick="testfunction(this)"></div>
<div class="test_a" id="example_e" onclick="testfunction(this)"></div>

<div class="test_b" id="example_a_test"></div>
<div class="test_b" id="example_b_test"></div>
<div class="test_b" id="example_c_test"></div>
<div class="test_b" id="example_d_test"></div>
<div class="test_b" id="example_e_test"></div> 
```

我在javascript中的函数：

```
function testfunction(x){
var example = document.getElementById(x.id + "_test");
example.style.display = 'block';
} 
```

所以当你点击id为example_a的div时，我想改变example_a_test的显示。

工作示例： http: [//pastehtml.com/view/c63rmz6tw.html](http://pastehtml.com/view/c63rmz6tw.html)

现在，如何使用事件处理程序来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T15:46:50.183

jquery是一个选项吗？

```
$('.test_a').click(function(){
    $('#' + this.id + '_test').css('display','block'); (or even .show())
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T15:54:00.607

这`click`是您可以使用的事件处理程序：

```
window.addEventListener('load', init, false);

var init = (function() {
  var divs = document.getElementsByTagName('div'),
      i = 0;
  for (i = divs.length; i--;) {
    listener(i);
  }
  function listener(i) {
    divs[i].addEventListener('click', function(e) {
      var id = this.getAttribute('id'),
          idTest = id + '_test',
          testElem = document.getElementById(idTest),
          divClass = this.getAttribute('class');
      if (divClass === 'test_a') {
        testElem.style.display = 'block';
      }
      e.preventDefault();
    });
  }
}); 
```

确保您的`test_b`元素`display: none;`在 CSS 中设置为。

这是一个[jsFiddle](http://jsfiddle.net/Pb9d4/12/)。

# sql - 将数字添加到现有列中的现有数字

> ID：11672987
> 
> 赞同：-1
> 
> 时间：2012-07-26T15:40:51.790
> 
> 标签：sql, sql-server, database

旧表加入了 Key

Key Author
-------------
1 Author A
2 Author B
3 Author C
4 Author D
------ -------------------

关键书名
-------------------------
1 书名by A
1 Book Title by A
4 Book Title by D
4 Book Title by D
2 Book Title by B
-------------------------

新表加入on NewKey

NewKey 密钥作者
-------------
1001 1 作者 A
1002 2 作者 B
1003 3 作者 C
1004 4 作者 D
---- ---------------------

NewKey 关键书名
-------------------------
1001 1 书名由 A
1001 1 书名由 A
1004 4 书名由 D
1004 4 书名由 D
1002 2 Book Title by B
-------------

创建 NewKey 的目的是在将数百个数据库合并在一起时 Key 字段重叠，所以此脚本将在合并之前创建一个全局唯一的 NewKey 字段。每个数据库有 11 个表，其中 Key 字段重叠。所以我需要为 Key 字段上的每个表完成这一步。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T15:42:44.147

就这么简单吗？

```
UPDATE dbo.table SET col = [file#] * 100 + col; 
```

如果它来自不同的表：

```
UPDATE destination
  SET destination.col = source.[file#] * 100 + destination.col
  FROM dbo.table AS destination
  INNER JOIN dbo.other_table AS source
  ON [some join condition that is anyone's guess]; 
```

# installation - Installshield安装程序管理员要求

> ID：11672990
> 
> 赞同：1
> 
> 时间：2012-07-26T15:41:03.210
> 
> 标签：installation, windows-installer, installshield, installshield-2011

我正在使用 InstallShield 基本 MSI 安装程序，其中包含另一个 MSI 链接以及自定义操作。

以管理员身份安装我们的应用程序效果很好，MSI 运行，启动我们的自定义操作以及链接的 MSI。但是，如果您在 Windows 7 上以非管理用户身份运行它，您会收到两个 UAC 提升提示（一个用于原始执行，一个用于链接的 MSI），但自定义操作可能由于缺乏提升而失败。

如果用户不是管理员，我想停止安装程序的运行（我们可以控制软件环境，因此我可以假设管理员已关闭 UAC）或确保此自定义操作在运行前提示用户（再次）提升。

我使用 InstallShield 工具（如下）在一般信息部分添加了“AdminUser”条件，但 Windows 7 中的非管理员用户不会收到警告，可以安装应用程序。 ![安装条件](../Images/b9cb28a25af901c724294d5110c0e40f.png)

我在这里缺少什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T11:37:42.307

是的。对于您要执行的操作，您需要设置[`MSIUSEREALADMINDETECTION`property](http://msdn.microsoft.com/en-us/library/windows/desktop/aa816403.aspx)。但是，我建议您使用相同的证书对两个 .msi 文件进行签名，因为在这种情况下，Windows Installer 不会发出第二个 UAC 提示。

# c# - 使用 OpenXML SDK 2.0 将页眉和页脚添加到现有的空 word 文档

> ID：11672991
> 
> 赞同：16
> 
> 时间：2012-07-26T15:41:04.037
> 
> 标签：c#, header, ms-word, footer, openxml-sdk

我正在尝试将页眉和页脚添加到空的 Word 文档中。

将 docx 更改为 zip 时，我使用此代码在 word/document.xml 中添加标题部分。

```
 ApplyHeader(doc);

      public static void ApplyHeader(WordprocessingDocument doc)
      {
            // Get the main document part.
            MainDocumentPart mainDocPart = doc.MainDocumentPart;

            // Delete the existing header parts.
            mainDocPart.DeleteParts(mainDocPart.HeaderParts);

            // Create a new header part and get its relationship id.
            HeaderPart newHeaderPart = mainDocPart.AddNewPart<HeaderPart>();
            string rId = mainDocPart.GetIdOfPart(newHeaderPart);

            // Call the GeneratePageHeaderPart helper method, passing in
            // the header text, to create the header markup and then save
            // that markup to the header part.
            GeneratePageHeaderPart("Test1").Save(newHeaderPart);

            // Loop through all section properties in the document
            // which is where header references are defined.
            foreach (SectionProperties sectProperties in
              mainDocPart.Document.Descendants<SectionProperties>())
            {
                //  Delete any existing references to headers.
                foreach (HeaderReference headerReference in
                  sectProperties.Descendants<HeaderReference>())
                    sectProperties.RemoveChild(headerReference);

                //  Create a new header reference that points to the new
                // header part and add it to the section properties.
                HeaderReference newHeaderReference =
                  new HeaderReference() { Id = rId, Type = HeaderFooterValues.First };
                sectProperties.Append(newHeaderReference);
            }

            //  Save the changes to the main document part.
            mainDocPart.Document.Save();
        }

    private static Header GeneratePageHeaderPart(string HeaderText)
    {
        var element =
          new Header(
            new Paragraph(
              new ParagraphProperties(
                new ParagraphStyleId() { Val = "Header1" }),
              new Run(
                new Text(HeaderText))
            )
          );

        return element;
    } 
```

此代码有效，但在 word/_rels/document.xml.rels 中没有创建标题关系。

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">
    <Relationship Id="rId3" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/webSettings" Target="webSettings.xml"/>
    <Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings" Target="settings.xml"/>
    <Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/>
    <Relationship Id="rId5" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme" Target="theme/theme1.xml"/>
    <Relationship Id="rId4" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable" Target="fontTable.xml"/>
</Relationships> 
```

[Content_Types].xml 中不再有内容类型标头

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">
    <Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/>
    <Default Extension="xml" ContentType="application/xml"/>
    <Override PartName="/word/document.xml" ContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml"/>
    <Override PartName="/word/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml"/>
    <Override PartName="/docProps/app.xml" ContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml"/>
    <Override PartName="/word/settings.xml" ContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml"/>
    <Override PartName="/word/theme/theme1.xml" ContentType="application/vnd.openxmlformats-officedocument.theme+xml"/>
    <Override PartName="/word/fontTable.xml" ContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.fontTable+xml"/>
    <Override PartName="/word/webSettings.xml" ContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.webSettings+xml"/>
    <Override PartName="/docProps/core.xml" ContentType="application/vnd.openxmlformats-package.core-properties+xml"/>
</Types> 
```

尽管如此，header.xml 是在 word/ 中创建的

```
<?xml version="1.0" encoding="utf-8"?><w:hdr xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main"><w:p><w:pPr><w:pStyle w:val="Header1" /></w:pPr><w:r><w:t>Test1</w:t></w:r></w:p></w:hdr> 
```

我的 word/document.xml 表明我的标题已添加。

```
<w:sectPr w:rsidR="003310CE" w:rsidSect="00D928B6">
<w:pgSz w:w="11906" w:h="16838" />
<w:pgMar w:top="1417" w:right="1417" w:bottom="1417" w:left="1417" w:header="708" w:footer="708" w:gutter="0" />
<w:cols w:space="708" /><w:docGrid w:linePitch="360" />
<w:headerReference w:type="first" r:id="Recfa318e6a7c44ff" />
</w:sectPr> 
```

所以我的问题是如何正确添加页眉和页脚？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-08-06T20:46:05.817

我很确定您的代码有什么问题，我怀疑它是您更改引用的方式。

无论如何，我有一个工作示例，希望您可以指导您。

我在这里的例子中基于我的：http: [//msdn.microsoft.com/en-us/library/office/cc546917.aspx](http://msdn.microsoft.com/en-us/library/office/cc546917.aspx)

我使用 Open XML SDK 2.0 Productivity Tool 来生成页眉和页脚部分。我首先使用我想要的布局创建一个文档，然后使用该工具打开它，它会生成 XML 或代码。你可以在这里得到它：http: [//www.microsoft.com/en-us/download/details.aspx?id=5124](http://www.microsoft.com/en-us/download/details.aspx?id=5124)

唯一需要注意的是，它假定文档正文中已经有一些内容，一个字母就可以了。我不确定这是否可以避免，我尝试在生产力工具中打开一个空文档，但它遇到了同样的错误 - “无法打开文件：存档文件的大小不能为 0”。在我的示例中，它将失败`WordprocessingDocument.Open`。

也许在空文档的情况下，您必须先创建一个正文。无论如何，我怀疑这个问题的主要目的是添加页眉和页脚，所以我觉得这是一个有效的答案。

如果你愿意，我可以提供实际的 cs/project 文件。

希望这可以帮助。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using DocumentFormat.OpenXml.Packaging;
using DocumentFormat.OpenXml.Wordprocessing;
using DocumentFormat.OpenXml;

namespace HeaderFooterDocX
{
    class Program
    {
        static void Main(string[] args)
        {
            ChangeHeader(@"C:\Users\James\Desktop\Document.docx");
        }

        static void ChangeHeader(String documentPath)
        {
            // Replace header in target document with header of source document.
            using (WordprocessingDocument document = WordprocessingDocument.Open(documentPath, true))
            {
                // Get the main document part
                MainDocumentPart mainDocumentPart = document.MainDocumentPart;

                // Delete the existing header and footer parts
                mainDocumentPart.DeleteParts(mainDocumentPart.HeaderParts);
                mainDocumentPart.DeleteParts(mainDocumentPart.FooterParts);

                // Create a new header and footer part
                HeaderPart headerPart = mainDocumentPart.AddNewPart<HeaderPart>();
                FooterPart footerPart = mainDocumentPart.AddNewPart<FooterPart>();

                // Get Id of the headerPart and footer parts
                string headerPartId = mainDocumentPart.GetIdOfPart(headerPart);
                string footerPartId = mainDocumentPart.GetIdOfPart(footerPart);

                GenerateHeaderPartContent(headerPart);

                GenerateFooterPartContent(footerPart);

                // Get SectionProperties and Replace HeaderReference and FooterRefernce with new Id
                IEnumerable<SectionProperties> sections = mainDocumentPart.Document.Body.Elements<SectionProperties>();

                foreach (var section in sections)
                {
                    // Delete existing references to headers and footers
                    section.RemoveAllChildren<HeaderReference>();
                    section.RemoveAllChildren<FooterReference>();

                    // Create the new header and footer reference node
                    section.PrependChild<HeaderReference>(new HeaderReference() { Id = headerPartId });
                    section.PrependChild<FooterReference>(new FooterReference() { Id = footerPartId });
                }
            }
        }

        static void GenerateHeaderPartContent(HeaderPart part)
        {
            Header header1 = new Header() { MCAttributes = new MarkupCompatibilityAttributes() { Ignorable = "w14 wp14" } };
            header1.AddNamespaceDeclaration("wpc", "http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas");
            header1.AddNamespaceDeclaration("mc", "http://schemas.openxmlformats.org/markup-compatibility/2006");
            header1.AddNamespaceDeclaration("o", "urn:schemas-microsoft-com:office:office");
            header1.AddNamespaceDeclaration("r", "http://schemas.openxmlformats.org/officeDocument/2006/relationships");
            header1.AddNamespaceDeclaration("m", "http://schemas.openxmlformats.org/officeDocument/2006/math");
            header1.AddNamespaceDeclaration("v", "urn:schemas-microsoft-com:vml");
            header1.AddNamespaceDeclaration("wp14", "http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing");
            header1.AddNamespaceDeclaration("wp", "http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing");
            header1.AddNamespaceDeclaration("w10", "urn:schemas-microsoft-com:office:word");
            header1.AddNamespaceDeclaration("w", "http://schemas.openxmlformats.org/wordprocessingml/2006/main");
            header1.AddNamespaceDeclaration("w14", "http://schemas.microsoft.com/office/word/2010/wordml");
            header1.AddNamespaceDeclaration("wpg", "http://schemas.microsoft.com/office/word/2010/wordprocessingGroup");
            header1.AddNamespaceDeclaration("wpi", "http://schemas.microsoft.com/office/word/2010/wordprocessingInk");
            header1.AddNamespaceDeclaration("wne", "http://schemas.microsoft.com/office/word/2006/wordml");
            header1.AddNamespaceDeclaration("wps", "http://schemas.microsoft.com/office/word/2010/wordprocessingShape");

            Paragraph paragraph1 = new Paragraph() { RsidParagraphAddition = "00164C17", RsidRunAdditionDefault = "00164C17" };

            ParagraphProperties paragraphProperties1 = new ParagraphProperties();
            ParagraphStyleId paragraphStyleId1 = new ParagraphStyleId() { Val = "Header" };

            paragraphProperties1.Append(paragraphStyleId1);

            Run run1 = new Run();
            Text text1 = new Text();
            text1.Text = "Header";

            run1.Append(text1);

            paragraph1.Append(paragraphProperties1);
            paragraph1.Append(run1);

            header1.Append(paragraph1);

            part.Header = header1;
        }

        static void GenerateFooterPartContent(FooterPart part)
        {
            Footer footer1 = new Footer() { MCAttributes = new MarkupCompatibilityAttributes() { Ignorable = "w14 wp14" } };
            footer1.AddNamespaceDeclaration("wpc", "http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas");
            footer1.AddNamespaceDeclaration("mc", "http://schemas.openxmlformats.org/markup-compatibility/2006");
            footer1.AddNamespaceDeclaration("o", "urn:schemas-microsoft-com:office:office");
            footer1.AddNamespaceDeclaration("r", "http://schemas.openxmlformats.org/officeDocument/2006/relationships");
            footer1.AddNamespaceDeclaration("m", "http://schemas.openxmlformats.org/officeDocument/2006/math");
            footer1.AddNamespaceDeclaration("v", "urn:schemas-microsoft-com:vml");
            footer1.AddNamespaceDeclaration("wp14", "http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing");
            footer1.AddNamespaceDeclaration("wp", "http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing");
            footer1.AddNamespaceDeclaration("w10", "urn:schemas-microsoft-com:office:word");
            footer1.AddNamespaceDeclaration("w", "http://schemas.openxmlformats.org/wordprocessingml/2006/main");
            footer1.AddNamespaceDeclaration("w14", "http://schemas.microsoft.com/office/word/2010/wordml");
            footer1.AddNamespaceDeclaration("wpg", "http://schemas.microsoft.com/office/word/2010/wordprocessingGroup");
            footer1.AddNamespaceDeclaration("wpi", "http://schemas.microsoft.com/office/word/2010/wordprocessingInk");
            footer1.AddNamespaceDeclaration("wne", "http://schemas.microsoft.com/office/word/2006/wordml");
            footer1.AddNamespaceDeclaration("wps", "http://schemas.microsoft.com/office/word/2010/wordprocessingShape");

            Paragraph paragraph1 = new Paragraph() { RsidParagraphAddition = "00164C17", RsidRunAdditionDefault = "00164C17" };

            ParagraphProperties paragraphProperties1 = new ParagraphProperties();
            ParagraphStyleId paragraphStyleId1 = new ParagraphStyleId() { Val = "Footer" };

            paragraphProperties1.Append(paragraphStyleId1);

            Run run1 = new Run();
            Text text1 = new Text();
            text1.Text = "Footer";

            run1.Append(text1);

            paragraph1.Append(paragraphProperties1);
            paragraph1.Append(run1);

            footer1.Append(paragraph1);

            part.Footer = footer1;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-08-07T00:28:50.637

这段代码对我有用。考虑到：

1.  在我的示例中，标头的关系 ID 是“r97”。也许您想自己决定一个独特的 rId
2.  页脚的 relationshipId ("r98") 相同
3.  页眉和页脚都有一个带有一些文本的硬编码段落。
4.  我假设一个文件已经存在

    ```
     using (WordprocessingDocument doc = WordprocessingDocument.Open(destination, true))
                {
                    var mainDocPart = doc.MainDocumentPart;
                    if (doc == null) {
                        mainDocPart = doc.AddMainDocumentPart();
                    }

                    if (mainDocPart.Document == null)
                    {
                        mainDocPart.Document = new Document();
                    }

                    ApplyHeader(doc);

                    ApplyFooter(doc);
                } 
    ```

ApplyHeader 方法：

```
public static void ApplyHeader(WordprocessingDocument doc)
      {
          // Get the main document part.
          MainDocumentPart mainDocPart = doc.MainDocumentPart;

          HeaderPart headerPart1 = mainDocPart.AddNewPart<HeaderPart>("r97");

            Header header1 = new Header();

            Paragraph paragraph1 = new Paragraph(){  };

            Run run1 = new Run();
            Text text1 = new Text();
            text1.Text = "Header stuff";

            run1.Append(text1);

            paragraph1.Append(run1);

            header1.Append(paragraph1);

            headerPart1.Header = header1;

            SectionProperties sectionProperties1 = mainDocPart.Document.Body.Descendants<SectionProperties>().FirstOrDefault();
            if (sectionProperties1 == null)
            {
                sectionProperties1 = new SectionProperties() { };
                mainDocPart.Document.Body.Append(sectionProperties1);
            }
            HeaderReference headerReference1 = new HeaderReference() { Type = HeaderFooterValues.Default, Id = "r97" };

            sectionProperties1.InsertAt(headerReference1,0);

        } 
```

应用页脚方法：

```
public static void ApplyFooter(WordprocessingDocument doc)
      {
          // Get the main document part.
          MainDocumentPart mainDocPart = doc.MainDocumentPart;

          FooterPart footerPart1 = mainDocPart.AddNewPart<FooterPart>("r98");

          Footer footer1 = new Footer();

          Paragraph paragraph1 = new Paragraph() { };

          Run run1 = new Run();
          Text text1 = new Text();
          text1.Text = "Footer stuff";

          run1.Append(text1);

          paragraph1.Append(run1);

          footer1.Append(paragraph1);

          footerPart1.Footer = footer1;

          SectionProperties sectionProperties1 = mainDocPart.Document.Body.Descendants<SectionProperties>().FirstOrDefault();
          if (sectionProperties1 == null)
          {
              sectionProperties1 = new SectionProperties() { };
              mainDocPart.Document.Body.Append(sectionProperties1);
          }
          FooterReference footerReference1 = new FooterReference() { Type = DocumentFormat.OpenXml.Wordprocessing.HeaderFooterValues.Default,  Id = "r98" };

          sectionProperties1.InsertAt(footerReference1, 0);

      } 
```

享受，

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-29T13:59:32.787

我自己找到解决方案。

事实上，使用 OpenXml 在 docx 中添加页眉或页脚涉及：

文件必须存在。

在添加页眉或页脚之前保存和关闭文档不起作用。

```
WordprocessingDocument document = WordprocessingDocument.Open(path, true);
<operations on docx>
document.Save();
document.Close();
ChangeHeader(document); 
```

您必须第二次重新打开您的 docx 以创建文档的新实例。

正确的解决方案将是（使用 James Wood 解决方案）：

```
WordprocessingDocument document = WordprocessingDocument.Open(path, true);
<operations on docx>
document.Save();
document.Close();
ChangeHeader(path);

    public static void ChangeHeader(String documentPath)
    {
        // Replace header in target document with header of source document.
        using (WordprocessingDocument document = WordprocessingDocument.Open(documentPath, true))
        {
            // Get the main document part
            MainDocumentPart mainDocumentPart = document.MainDocumentPart;

            // Delete the existing header and footer parts
            mainDocumentPart.DeleteParts(mainDocumentPart.HeaderParts);
            mainDocumentPart.DeleteParts(mainDocumentPart.FooterParts);

            // Create a new header and footer part
            HeaderPart headerPart = mainDocumentPart.AddNewPart<HeaderPart>();
            FooterPart footerPart = mainDocumentPart.AddNewPart<FooterPart>();

            // Get Id of the headerPart and footer parts
            string headerPartId = mainDocumentPart.GetIdOfPart(headerPart);
            string footerPartId = mainDocumentPart.GetIdOfPart(footerPart);

            GenerateHeaderPartContent(headerPart);

            GenerateFooterPartContent(footerPart);

            // Get SectionProperties and Replace HeaderReference and FooterRefernce with new Id
            IEnumerable<SectionProperties> sections = mainDocumentPart.Document.Body.Elements<SectionProperties>();

            foreach (var section in sections)
            {
                // Delete existing references to headers and footers
                section.RemoveAllChildren<HeaderReference>();
                section.RemoveAllChildren<FooterReference>();

                // Create the new header and footer reference node
                section.PrependChild<HeaderReference>(new HeaderReference() { Id = headerPartId });
                section.PrependChild<FooterReference>(new FooterReference() { Id = footerPartId });
            }
        }
    }

public static void GenerateHeaderPartContent(HeaderPart part)
        {
            Header header1 = new Header() { MCAttributes = new MarkupCompatibilityAttributes() { Ignorable = "w14 wp14" } };
            header1.AddNamespaceDeclaration("wpc", "http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas");
            header1.AddNamespaceDeclaration("mc", "http://schemas.openxmlformats.org/markup-compatibility/2006");
            header1.AddNamespaceDeclaration("o", "urn:schemas-microsoft-com:office:office");
            header1.AddNamespaceDeclaration("r", "http://schemas.openxmlformats.org/officeDocument/2006/relationships");
            header1.AddNamespaceDeclaration("m", "http://schemas.openxmlformats.org/officeDocument/2006/math");
            header1.AddNamespaceDeclaration("v", "urn:schemas-microsoft-com:vml");
            header1.AddNamespaceDeclaration("wp14", "http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing");
            header1.AddNamespaceDeclaration("wp", "http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing");
            header1.AddNamespaceDeclaration("w10", "urn:schemas-microsoft-com:office:word");
            header1.AddNamespaceDeclaration("w", "http://schemas.openxmlformats.org/wordprocessingml/2006/main");
            header1.AddNamespaceDeclaration("w14", "http://schemas.microsoft.com/office/word/2010/wordml");
            header1.AddNamespaceDeclaration("wpg", "http://schemas.microsoft.com/office/word/2010/wordprocessingGroup");
            header1.AddNamespaceDeclaration("wpi", "http://schemas.microsoft.com/office/word/2010/wordprocessingInk");
            header1.AddNamespaceDeclaration("wne", "http://schemas.microsoft.com/office/word/2006/wordml");
            header1.AddNamespaceDeclaration("wps", "http://schemas.microsoft.com/office/word/2010/wordprocessingShape");

            Paragraph paragraph1 = new Paragraph() { RsidParagraphAddition = "00164C17", RsidRunAdditionDefault = "00164C17" };

            ParagraphProperties paragraphProperties1 = new ParagraphProperties();
            ParagraphStyleId paragraphStyleId1 = new ParagraphStyleId() { Val = "Header" };

            paragraphProperties1.Append(paragraphStyleId1);

            Run run1 = new Run();
            Text text1 = new Text();
            text1.Text = "Header";

            run1.Append(text1);

            paragraph1.Append(paragraphProperties1);
            paragraph1.Append(run1);

            header1.Append(paragraph1);

            part.Header = header1;
        }

        public static void GenerateFooterPartContent(FooterPart part)
        {
            Footer footer1 = new Footer() { MCAttributes = new MarkupCompatibilityAttributes() { Ignorable = "w14 wp14" } };
            footer1.AddNamespaceDeclaration("wpc", "http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas");
            footer1.AddNamespaceDeclaration("mc", "http://schemas.openxmlformats.org/markup-compatibility/2006");
            footer1.AddNamespaceDeclaration("o", "urn:schemas-microsoft-com:office:office");
            footer1.AddNamespaceDeclaration("r", "http://schemas.openxmlformats.org/officeDocument/2006/relationships");
            footer1.AddNamespaceDeclaration("m", "http://schemas.openxmlformats.org/officeDocument/2006/math");
            footer1.AddNamespaceDeclaration("v", "urn:schemas-microsoft-com:vml");
            footer1.AddNamespaceDeclaration("wp14", "http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing");
            footer1.AddNamespaceDeclaration("wp", "http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing");
            footer1.AddNamespaceDeclaration("w10", "urn:schemas-microsoft-com:office:word");
            footer1.AddNamespaceDeclaration("w", "http://schemas.openxmlformats.org/wordprocessingml/2006/main");
            footer1.AddNamespaceDeclaration("w14", "http://schemas.microsoft.com/office/word/2010/wordml");
            footer1.AddNamespaceDeclaration("wpg", "http://schemas.microsoft.com/office/word/2010/wordprocessingGroup");
            footer1.AddNamespaceDeclaration("wpi", "http://schemas.microsoft.com/office/word/2010/wordprocessingInk");
            footer1.AddNamespaceDeclaration("wne", "http://schemas.microsoft.com/office/word/2006/wordml");
            footer1.AddNamespaceDeclaration("wps", "http://schemas.microsoft.com/office/word/2010/wordprocessingShape");

            Paragraph paragraph1 = new Paragraph() { RsidParagraphAddition = "00164C17", RsidRunAdditionDefault = "00164C17" };

            ParagraphProperties paragraphProperties1 = new ParagraphProperties();
            ParagraphStyleId paragraphStyleId1 = new ParagraphStyleId() { Val = "Footer" };

            paragraphProperties1.Append(paragraphStyleId1);

            Run run1 = new Run();
            Text text1 = new Text();
            text1.Text = "Footer";

            run1.Append(text1);

            paragraph1.Append(paragraphProperties1);
            paragraph1.Append(run1);

            footer1.Append(paragraph1);

            part.Footer = footer1;
        } 
```

# if-statement - 批处理脚本 if 语句 - 意外 (

> ID：11672994
> 
> 赞同：2
> 
> 时间：2012-07-26T15:41:18.170
> 
> 标签：if-statement, batch-file

我在 Windows 7 上编写了一个脚本，它不断给我一个错误“（此时是意外的。”对于以下代码

```
if %vardns%=="NODNS" (
  netsh interface ipv4 set address name="%__ethAdapter.42%" source=static addr=%varip_old% mask=%varsubnet_old% gateway=%vargateway_old% gwmetric=1
) else (
  netsh interface ipv4 set address name="%__ethAdapter.42%" source=dhcp
) 
```

我不确定问题出在哪里，并且阅读了许多其他帖子。任何帮助将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T15:54:54.633

您收到此错误是因为`vardns`可能为空，并且解释器将此行展开为：

```
if =="NODNS" ( 
```

这是非法的语法。

建议您做的是正确的 - 在 周围添加引号`%vardns%`，如下所示：

```
if "%vardns%"=="NODNS" ( 
```

它应该可以工作。

# c# - 将流媒体视频从服务器路由到多个客户端视频元素

> ID：11672995
> 
> 赞同：1
> 
> 时间：2012-07-26T15:41:18.740
> 
> 标签：c#, php, network-programming, video-streaming

我正在构建这个应用程序，它使用闭路电视摄像机在浏览器上向最终用户流式传输源。我们希望将此流路由到我们的服务器，然后将其转发给用户。我们正在寻找一些开源解决方案以及付费解决方案。我们只遇到了我们认为还不够的 VLMa 服务器。任何人都可以建议一种程序化的路由方式或现成的解决方案来帮助我们实现这一目标。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T01:02:41.757

我们尝试了以下解决方案来解决这个问题。

1.  [http://www.wowza.com/](http://www.wowza.com/) 这是付费版本。但是，它的价格表现非常好。您支付的费用可以获得很多功能。

2.  [http://code.google.com/p/red5/](http://code.google.com/p/red5/) 这个是开源版本。它基于 Java Servlet。因此，如果您的解决方案只需要 .Net，那么这可能不适合您。我们是在 php 中，所以我们设法用这种方法找到了一个可行的解决方案。如果需要更多的管理技能，它也可以很好地工作。

3.  VLMa 服务器 这是我们最初的尝试。它不符合我们 100% 的要求。但是，如果添加的功能很少，那么它真的可以与上述 2 竞争。

希望它可以帮助你。谢谢。