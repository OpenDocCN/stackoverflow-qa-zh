# StackOverflow 问答 10922000-10922999

# perl - Perl While 语句

> ID：10922000
> 
> 赞同：0
> 
> 时间：2012-06-06T20:45:39.257
> 
> 标签：perl, while-loop

好的，这是我的最后一个问题（当天）：我正在尝试让我的程序搜索文档。如果文档的任何地方都包含“不成功”一词，则程序将搜索“错误”一词并记录所有错误实例。但是，我很难让两者相互依赖。请帮忙！我对 Perl 非常陌生（这只是我使用它的第二天）所以您可以提供的详细信息/评论越多越好！这是我当前的代码，我知道它现在不能运行：

```
#!/usr/local/bin/perl

my $argument1 = $ARGV[0];
my $argument2 = $ARGV[1];
open (LOGFILE, "<$argument1") or die "Can't find file";         
open FILE, ">>$argument2" or die $!;
while (<LOGFILE>){
    if {(/Unsuccessful/){
    while(<LOGFILE>){
     if (/Error/){ 
        print FILE "ERROR in line $.\n" ;
    }

}
}
}
} 
```

关闭文件；关闭日志文件；

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T22:06:06.320

在一个循环中检查“不成功”和“错误”，如果发现“不成功”，最后打印错误结果......

```
my $argument1 = $ARGV[0];
my $argument2 = $ARGV[1];

open (LOGFILE, "<$argument1") or die "Can't find file";         
open (FILE,   ">>$argument2") or die $!;

my $unsuccessful = 0;
my @errors = ();

while (<LOGFILE>) {
  if (/Unsuccessful/i) {
    $unsuccessful = 1;
  }
  if (/Error/i) {
    push(@errors, "ERROR in line $.\n");
  }
}

if ($unsuccessful) {
  print $_ for @errors;
} 
```

Switch`/i`适用于不区分大小写的搜索，因此如果不需要，请将其从上面的代码中删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T20:54:48.287

使用

```
<LOGFILE> 
```

多次可能不是你想要的。导致您遇到麻烦的更直接原因可能是放置不当的“{”。

看起来您希望“错误”总是晚于“不成功”出现，对吧？

尝试

```
my $argument1 = $ARGV[0];
my $argument2 = $ARGV[1];

open (LOGFILE, "<$argument1") or die "Can't find file";         
open FILE, ">>$argument2" or die $!;

my $unsuccessful = 0;

while (<LOGFILE>){
    if ($unsuccessful) {
        if (/Error/) { print FILE "ERROR in line $.\n"; }
    }
    else {
        if (/Unsuccessful/) { $unsuccessful = 1; }
    }
}

close FILE;
close LOGFILE; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T21:00:16.993

在第 1 步之前执行第 5 步，您犯了一个严重错误。您没有在代码中使用`strict`and`warning`编译指示。实际上，您发布的代码无法编译。

至于所讨论的问题，假设您只想解析每个文件一次（作为一个优秀的程序员应该努力做到的），您应该以两种模式进行解析：（1）`unsuccessful`已检测到的模式，以及它所在的模式尚未被发现。前者将负责输出行，而后者则不会。

现在我建议回到一些基础，不要提前采取措施。过去我自己在第 1 步之前已经多次执行第 5 步，但每次都是错误的。

# appcelerator - 是否可以在 Appcelerator 中旋转视图？

> ID：10922001
> 
> 赞同：1
> 
> 时间：2012-06-06T20:45:41.507
> 
> 标签：appcelerator

我有一个包含要旋转的元素（标签等）的视图。

这可以做到吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-06T20:55:19.673

您可以使用[transform](http://docs.appcelerator.com/titanium/2.0/index.html#!/api/Titanium.UI.View-property-transform)属性将[2DMatrix](http://docs.appcelerator.com/titanium/2.0/index.html#!/api/Titanium.UI.2DMatrix)应用于视图：

```
var v = Ti.UI.createView({
 transform: Ti.UI.create2DMatrix().rotate(90)
}); 
```

# iphone - 在 iphone 上添加自定义字体

> ID：10922002
> 
> 赞同：1
> 
> 时间：2012-06-06T20:45:42.427
> 
> 标签：iphone

嗨，有人能给我详细解释一下如何在 iphone 标签上添加自定义字体吗？

我已经在 info.plist 上创建了一个密钥

```
<key>UIAppFonts</key>
<array>
        <string>custom.ttf</string>
</array> 
```

但不知道下一步是什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T20:49:24.487

iphone（开发）上的所有自定义字体都应添加到应用程序 info.plist

添加行

```
<key>UIAppFonts</key>
<array>
        <string>custom.ttf</string>
</array> 
```

**然后将 custom.ttf 添加到项目中。**

创建 UILabel 的子类

```
@interface CustomLabel : UILabel {

}

@end

@implementation CustomLabel

- (id)initWithCoder:(NSCoder *)decoder {
    if (self = [super initWithCoder: decoder]) {
        UIColor *textColor = [UIColor colorWithRed:0.20f green:0.20f blue:0.20f alpha:1.0f];
        [self setTextColor:textColor];
        [self setShadowColor:textColor];
        [self setHighlightedTextColor:textColor];
        [self setFont:[UIFont fontWithName:@"custom" size:self.font.pointSize]];
    }
    return self;
}

@end 
```

就是这样，您已准备好使用标签上的自定义字体。

**笔记：**

对于您在应用程序上添加的每个想要自定义字体的标签，将类标识更改为 CustomLabel（子类 UILabel 的名称）。

# php - 如何捕捉这个 PHP/Magento 错误：当没有缩略图时，代码中断

> ID：10922011
> 
> 赞同：1
> 
> 时间：2012-06-06T20:46:16.997
> 
> 标签：php, magento

我有一个自定义的销售点管理员 Magento 扩展。我正在尝试向 POS 页面上的管理产品网格添加缩略图。当每个产品都有缩略图时，它可以 100% 正常工作。但是当有一个没有图像的产品时，代码就完全崩溃了。

如何修改此代码以检查是否有缩略图，如果没有，则显示占位符（任何替代 html 都可以）？

```
<?php

  class MDN_PointOfSales_Block_Widget_Grid_Column_Renderer_Thumbnail
    extends Mage_Adminhtml_Block_Widget_Grid_Column_Renderer_Abstract
  {
    public function render(Varien_Object $row)
    {      

    $cProduct = Mage::getModel("catalog/product");
    $cProductId = $row->getId();
    $cProduct->load($cProductId);  // works for product IDs w/ a thumbnail. Breaks if no thumbnail set.
    // For example, the following line works, loading the thumbnail for the 5533 product for all rows in the grid:  
    // $cProduct->load(5533);

    $cMyUrl = $cProduct->getThumbnailUrl();

    $html = '<img ';
    $html .= 'src="' . $cMyUrl . '"';
    $html .= 'class="grid-image ' . $cProductId . '"/>';

    return $html;      

    }
  }
?> 
```

如果没有缩略图，整个页面会导致错误： [http ://www.screencast.com/t/zk6jVChiAC](http://www.screencast.com/t/zk6jVChiAC)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-06T21:42:13.017

You could wrap the call that triggers the exception in a try catch block and put code in to do the placeholder:

```
try {
    $cMyUrl = $cProduct->getThumbnailUrl();
} catch (Exception $e) {
    //Do something here
} 
```

But don't. This is simply masking the underlying problem:

The placeholder image is missing from both /skin/frontend/your_package/your_theme/images/catalog/product/placeholder and the theme it inherits from

You can see the exception being thrown (and the reason: no image and no placeholder) in: `app/code/core/Mage/Catalog/Model/Product/Image.php` in the `setBaseFile()` method.

I would rather let Magento handle the placeholders properly, rather than let that exception be thrown unnecessarily and have to code around it.

So, add your placeholder images to the skin images directories mentioned above - you should have the following:

```
/skin/frontend/your_package/your_theme/images/catalog/product/placeholder/image.jpg
/skin/frontend/your_package/your_theme/images/catalog/product/placeholder/small_image.jpg
/skin/frontend/your_package/your_theme/images/catalog/product/placeholder/thumbnail.jpg 
```

or at least some in the base theme

```
/skin/frontend/base/default/images/catalog/product/placeholder/image.jpg
/skin/frontend/base/default/images/catalog/product/placeholder/small_image.jpg
/skin/frontend/base/default/images/catalog/product/placeholder/thumbnail.jpg 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-06T21:00:19.580

Mage_Catalog_Model_Product_Image::setBaseFile($file) 在目录/图像助手尝试初始化图库并加载缩略图时引发异常。当您尝试获取缩略图 url 时会发生这种情况，而不是在加载产品时。

避免这种情况的最简单方法是使用捕获异常

```
try {
    $cMyUrl = $cProduct->getThumbnailUrl();
} catch (Exception $e) {
    $cMyUrl = 'default_thumbnail.jpg'; // or something else ;-)
} 
```

# django - 一台服务器上的 django 生产和开发站点。经验？

> ID：10922016
> 
> 赞同：0
> 
> 时间：2012-06-06T20:46:47.790
> 
> 标签：django, .htaccess

我正在设置一个服务器来为运行时和开发版本提供服务。实际上，这只是游戏的一部分，让我解释一下。

我想要的是：

```
www.mysite.com/site/: The site
www.mysite.com/site-dev-dhert45/: The dev site 
```

它们都在同一个数据库上运行，但“开发”使用新的最终代码，或者只有 debug=True 或者只是激活了 ADMIN。

这就是问题所在。如何？

在这里提供更多细节是目前的情况。

目前，在我的服务器上，我有一个这种类型的 .htaccess：

```
AddHandler fcgid-script .fcgi
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^site/(.*)$ site_Random/django.fcgi/$1 [QSA,L]
RewriteRule ^site-dev-dhert45/(.*)$ site_dev_Random/django.fcgi/$1 [QSA,L] 
```

即我启动了两个完全分离的fcgi 实例。

通过写作，我意识到：

1.  如果我可以有子域，那会很容易[我没有子域]
2.  django 不提供基本域 [这也可能使事情变得更容易]

我将探索两种方法：

1.  试图利用 django.sites
2.  引入一个新的 settings.py 变量“URL_REWRITE_LOCATION”，它将解决实际位置

还有什么建议吗？

在写作时，我意识到子域解决方案实际上解决了我的问题，但在我拥有域之前，我遇到了这个问题。所以我会把这个问题留给我的下一个案例，并作为我自己的练习；）

转到下一个问题，我将在这里发布：如何正确处理应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T13:22:15.693

我建议在子域级别创建开发站点，例如“dev.mysite.com”或遵循“通过默默无闻的安全性”方法随机使用“hidden-dev-a0z9.mysite.com”。然后使用您的 http 服务器 (nginx/apache) 将身份验证直接添加到该服务器/虚拟主机。这将真正简化 url 命名过程并使其非常容易开发，只需在 http 服务器级别更改设置即可。

# c++ - 在什么情况下使用操作符转换比混淆更有用？

> ID：10922019
> 
> 赞同：1
> 
> 时间：2012-06-06T20:46:57.920
> 
> 标签：c++, operator-overloading, clarity

在 C++ 中，使用运算符强制转换可能会导致代码读者混淆，因为调用函数调用并不明显。话虽如此，我已经看到它的使用被劝阻。

但是，在什么情况下使用 operator cast 是合适的并且具有超过它可能导致的任何混淆的价值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T20:56:07.627

当转换是自然的并且没有副作用时，它会很有用。例如，没有人会争辩说从`int`to的自动转换`double`是不合适的，即使您可以想出一个使其混乱的极端案例（我不确定是否有人可以）。

我发现从 Microsoft 的转换`CString`非常`const char *`方便，即使我知道其他人不同意。我不介意在`std::string`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T00:17:21.723

运算符强制转换在包装对象的 C++ 习惯用法中非常有用。例如，假设您有一些字符串类的写时复制实现。您希望您的用户能够自然地对其进行索引，例如

```
const String s = "abc";
assert(s[0] == 'a');
// given
char String::operator[](int) const 
```

到目前为止，你会认为这会奏效。然而，当有人想要修改你的字符串时会发生什么？那么，也许这会起作用？

```
String s = "abc";
s[0] = 'z';
assert(s[0] == 'z');
// given
char & String::operator[](int) 
```

但是这个实现给出了一个非常量字符的引用。所以有人总是可以使用该引用来修改字符串。因此，在分发引用之前，它必须在内部执行字符串的副本，这样其他字符串就不会被修改。因此，如果不强制复制，就不可能`operator[]`在非常量字符串上使用。该怎么办？

您可以返回具有以下接口的包装对象，而不是返回字符引用：

类 CharRef { public: operator char() const; CharRef & operator=(char); };

`char()`转换运算符只返回存储在字符串中的字符的副本。但是，当您分配给包装器时，`operator=(char)`如果引用计数大于 1，它将强制字符串执行内部复制，并改为修改该副本。

例如，包装器的实现可以保存 char 和指向字符串的指针（可能是字符串实现的某个子部分）。

# python - 如何将 Python 应用程序移植到在 Windows 中运行良好的 Linux

> ID：10922020
> 
> 赞同：1
> 
> 时间：2012-06-06T20:47:13.940
> 
> 标签：python, windows, linux, ioerror

我在将工作的 Windows Python 应用程序移植到 Linux 时遇到问题。我遇到了一些问题，因为我没有编写代码，只是在学习 Python。我无法解决它不断抛出的问题。所以这是我现在遇到的一种错误

```
Traceback (most recent call last):
File "alpha_beta", line 237, in <module>
main()
File "alpha_beta", line 185, in main
ABCCmd()
File "alpha_beta.py", line 74, in ABCCmd

File "C:\softs\Python\Lib\shutil.py", line 80, in copy
File "C:\softs\Python\Lib\shutil.py", line 47, in copyfile
IOError: [Errno 13] Permission denied: '/myPath/XFiles.bin.addr_patched 
```

任何有关如何修复它的指示将不胜感激

编辑：

1）我被卡住的意思是，错误的回溯到 C:\softs\Python\Lib 但实际上我目前正在 Ubuntu 中执行此代码。为什么回溯引用到 windows 库

2）困扰我的另一件事是它说有一个IOError。但是当我尝试为被拒绝的那个添加权限时，它给了我一个chmod：更改/myPath/xFiles.bin.addr_patched的权限：不允许操作编辑2 ：

我注释掉了一个模块，因为我认为它不是很有用。由于现在我无论如何都在讨论移植问题，我想我也可以提出这个额外的问题，因为我认为问题是相同的并且修复应该是相似的。在 python 代码中包含#pdb 模块时，出现以下错误

```
traceback (most recent call last):
File "alpha_beta", line 6, in <module>
import pdb
File "C:\softs\Python\Lib\pdb.py", line 14, in <module>
File "C:\softs\Python\Lib\pprint.py", line 39, in <module>
ImportError: No module named cStringIO 
```

我查看了 importer_Cache ，看起来像这样

```
'': None, '/usr/lib/python2.6/plat-linux2': None, '/usr/lib/python2.6/': None
'/usr/lib/pymodules/python2.6/gtk-2.0': None, '/usr/lib/python2.6/lib-tk': None,
'/usr/lib/python2.6/lib-old': <imp.NullImporter object at 0x7f1269048070>, '/usr/
/python2.6/dist-packages/gtk-2.0': None, '/usr/lib/python2.6/dist-packages/PIL': None,
'/usr/local/lib/python2.6/dist-packages': None, '/usr/lib/python2.6/dist-packages':
None 
```

*已**解决**：*脚本中有一个奇怪的包装器，导致 python 脚本从不同的位置执行。还是不明白怎么弄的。在修改我的脚本以直接作为 python myScript.py 执行后，它运行良好。无论如何谢谢大家的帮助*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T21:02:26.933

错误消息中 Windows 和 Unix 样式路径的混合使我认为您可能有一些文件名是硬编码的或使用操作系统特定的路径分隔符（“\”或“/”）手动创建的。如果你能弄清楚`gOptions.inputTf`和`gWorkingTfFile`值的分配位置，你应该考虑使用[`os.path.join`](http://docs.python.org/library/os.path.html#os.path.join)它来帮助你使用正确的路径。

```
from os.path import join

file = join('A', 'B')
# 'A/B' on unix systems
# 'A\B' on windows systems 
```

# git - GitHub：错误：找不到存储库。致命：远端意外挂断（显然与类似帖子不同）

> ID：10922028
> 
> 赞同：32
> 
> 时间：2012-06-06T20:47:42.600
> 
> 标签：git, github

我创建了一个目录，`hello_git`. 在这个目录中，我创建了一个文件，`hello_git.py`它会打印出“Hello git！” 信息。

然后我`hello_git`在终端中创建了我的当前目录，并在该目录中依次输入了以下命令：

```
git init
git add hello_git.py
git commit -m 'first commit'
git remote add origin git@github.com:githubaccountname/hello_git.git 
```

当我输入命令时，`git push origin master`我被问到：

```
Enter passphrase for key '/home/myusername/.ssh/id_rsa': 
```

当我输入我的密码（使用成功验证`ssh -T git@github.com`）我得到这个：

```
ERROR: Repository not found.
fatal: The remote end hung up unexpectedly 
```

我不知道这是否有帮助，但是：

```
git remote -v 
```

返回：

```
origin    git@github.com:githubaccountname/hello_git.git (fetch)
origin    git@github.com:githubaccountname/hello_git.git (push) 
```

我已经查看了类似帖子的答案，但似乎没有任何效果：

*   *[致命：远程端在推送到 Git 存储库时意外挂断](https://stackoverflow.com/questions/6808653/fatal-the-remote-end-hung-up-unexpectedly-while-pushing-to-git-repository)*

*   *[GitHub 错误：未找到存储库。致命：远端意外挂断](https://stackoverflow.com/questions/10904978/github-error-repository-not-found-fatal-the-remote-end-hung-up-unexpectedly)*

*   *[如何解决这个阻止推送到原点的问题。GitHub？](https://stackoverflow.com/questions/6910752/github-how-to-resolve-this-issue-of-preventing-push-to-origin)*

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-04-04T19:01:23.150

在存储库不存在的情况下，Eric 已经给出了这个问题的最佳答案，但我想指出：

*当存储库确实*存在但用户无权推送到它时，GitHub***也会***给出“Repository not found./remote end意外挂起”的响应对。

 *如果您完全确定 GitHub 上已经存在存储库，请确保您使用的帐户有权推送到该存储库。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-06-06T20:53:35.567

错误信息说明了一切

> 错误：未找到存储库。

**是否有您正在寻找的 Git 存储库？**

您需要先在 GitHub 上创建存储库。它找不到存储库*，因为它还不存在*！

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-04-18T11:17:11.877

存储库不存在或您没有正确的权限。

更多信息是关于*[Error: Repository not found](https://help.github.com/articles/error-repository-not-found)*。

此外，如果您有多个 GitHub 帐户（实际上是不允许的），则需要多个 ssh 密钥与 GitHub 一起存储。

更多信息请*[参见快速提示：如何使用 GitHub 和多个帐户](http://net.tutsplus.com/tutorials/tools-and-tips/how-to-work-with-github-and-multiple-accounts/)*。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-08-27T18:06:59.253

您是否可能重命名了您的存储库？如果您在 GitHub 上重命名了存储库，则需要相应地更新源。这曾经发生在我身上，我重命名了我的存储库并忘记更新我笔记本电脑中的原始设置。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-04-06T12:46:08.760

就我而言，问题出在错误的 URL 中。

代替

> [https://gitlab.com/username/my_repository](https://gitlab.com/username/my_repository) **.git**

我写

> [https://gitlab.com/username/my_repository/](https://gitlab.com/username/my_repository/) *（从浏览器复制）*

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-04-18T19:15:33.747

如果您存储了不正确的凭据，也会发生这种情况。您可以使用以下命令清除 repo 的内存，以便在下次推送时重新提示： `git config --unset credential.helper`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-04-09T20:44:11.367

我刚刚遇到了同样的问题。如果其他解决方案都不起作用，可能是因为 GitHub 的 SSH 访问存在问题，正如其状态页面 ( [https://status.github.com/](https://status.github.com/) )上所说

> “我们正在调查存储库访问和一些 GitHub.com 功能的问题。一旦我们有更多信息要分享，我们会报告。”*

# java - Java Apache HttpPost，setEntity 替换或附加

> ID：10922032
> 
> 赞同：1
> 
> 时间：2012-06-06T20:47:47.177
> 
> 标签：java, apache, replace, append, http-post

在 HttpPost 中，这附加到标题

```
httppost.setHeader("User-Agent", "AFHttpClient/1.0");
        httppost.setHeader("X-Requested-With", "XMLHttpRequest");
        httppost.setHeader("Accept", "application/json"); 
```

其中每个`setHeader`只是添加到标题中，而不是用新标题替换标题

我想知道`setEntity`方法。

顺序调用 setEntity 方法是简单地将数据添加和附加到实体，还是替换它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T21:28:48.747

不，`HttpPost#setEntity(HttpEntity)`只是设置实体，如果你再次调用它，它会覆盖它。[参见 `HttpPost' 的源代码](http://grepcode.com/file/repo1.maven.org/maven2/org.apache.httpcomponents/httpcore/4.1.4/org/apache/http/HttpEntityEnclosingRequest.java#HttpEntityEnclosingRequest.setEntity%28org.apache.http.HttpEntity%29)。

我不认为，`HTTP/1.1`允许转移多个实体。

另请注意`HttpPost#setHeader(String, String)`，如果您使用相同的标题名称和不同的值再次调用它，这也会覆盖标题（请参阅[`HeaderGroup#updateHeader(Header)`](http://grepcode.com/file/repo1.maven.org/maven2/org.apache.httpcomponents/httpcore/4.1.4/org/apache/http/message/HeaderGroup.java#HeaderGroup.updateHeader%28org.apache.http.Header%29)）。

# php - 使用 PHP 连接到远程 mysql 服务器

> ID：10922035
> 
> 赞同：0
> 
> 时间：2012-06-06T20:47:50.583
> 
> 标签：php, mysql

我安装了 PHP 5.3.2 版。我正在尝试连接到远程 mysql 数据库版本 4.1.22

PHP 在 IIS7 上运行

问题出在我的 php.ini 中，仅包含 2 个文件作为扩展名：

```
extension=php_curl.dll
extension=php_sqlite3.dll 
```

我将这些添加到 php.ini

```
extension=php_mysql.dll
extension=php_mysqli.dll
extension=php_pdo_mysql.dll 
```

并将3个dll文件放在安装PHP的ext文件夹中。但我不断收到 500 服务器错误。PHP 错误日志中没有记录任何内容。

我从事件查看器应用程序错误中得到了这个：

```
Faulting application php-cgi.exe, version 5.3.2.0, time stamp 0x4b8ebb1d, faulting module php-cgi.exe, version 5.3.2.0, time stamp 0x4b8ebb1d, exception code 0xc0000005, fault offset 0x0000193a, process id 0x2540, application start time 0x01cd441011e2e3a0. 
```

基本上我在使用 mysql_connect() 时遇到错误，即：

```
Call to undefined function mysql_connect() 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T21:09:38.413

> 调用未定义函数 mysql_connect()

说得很清楚： php_mysql 扩展尚未加载。

首先确保您的 php 安装使用您已编辑的 php.ini 文件。创建一个包含

```
<?php
phpinfo();
?> 
```

在浏览器中打开它并在输出中检查 php_ini 路径。如果正确，请查看扩展目录，看看它是否与您放置 dll 的位置匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T21:03:42.047

确保您的应用程序池设置为正确的 32 位/64 位模式

# install4j - 修复与 JRE 包的外部引用相关的 Install4j 警告

> ID：10922038
> 
> 赞同：2
> 
> 时间：2012-06-06T20:48:06.530
> 
> 标签：install4j

我正在使用一个 Install4j v4.2.8 项目文件，该文件最初引用了 C:\Program Files\install4j\jre 中的内部 JRE。它现在引用 Install4j 安装目录之外的相同 JRE 包。由于进行了更改，每次将 JRE 捆绑包添加到安装程序时，我们都会看到如下消息：

`[WARNING] The version of the bundled JRE is too low. It should be at least 1.6!`

有什么方法可以让 Install4j 知道这些 JRE 包确实包含 1.6 JRE？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T14:13:31.413

版本是从文件名中推断出来的。格式是

```
[os]-[arch]-[version][suffix].tar.gz 
```

例如

```
windows-amd64-1.6.0_29.tar.gz 
```

# c# - 窗口 SizeToContent 和 ListBox 大小调整

> ID：10922042
> 
> 赞同：3
> 
> 时间：2012-06-06T20:48:25.050
> 
> 标签：c#, wpf, xaml

我试图弄清楚如何将 WPF 列表框与 SizeToContent 属性设置为 WidthAndHeight 的窗口结合使用。MainWindow 有一个两行两列的网格。在右下象限，我有一个列表框。我希望窗口中的其余控件来控制窗口的大小，并让列表框简单地**填充**可用空间。目前，列表框正在扩展以适应其内容，这会导致整个 MainWindow 扩展。

注意：我试图创建一个简单的示例，但想指出，在我的真实场景中，我使用的是 MVVM，并且我想要确定窗口宽度/高度的控件绑定到具有其值的视图模型中的属性加载窗口后设置。

编辑添加：列表框在我要确定大小的控件之前绑定到其内容，我无法控制它。

这是 MainWindow 当前在启动时的样子：

![在此处输入图像描述](../Images/ba0ad3cf474e530ab6cfbb71089dbced.png)

请注意红色和蓝色条，它们表示我不希望发生的事情。该区域中的内容只能通过滚动条可见。

这是我希望 MainWindow 在启动时的样子：

![在此处输入图像描述](../Images/149079cad96fde88e66edbbe2da8218f.png)

请注意，MainWindow 的大小由顶部和左侧的文本块确定，列表框填充可用空间并在必要时使用滚动条。

这是一些示例代码...

MainWindow.xaml：

```
<Window x:Class="WpfApplication1.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" SizeToContent="WidthAndHeight">

<Grid>   
    <Grid.RowDefinitions>
        <RowDefinition Height="auto"/>
        <RowDefinition Height="auto"/>
        <RowDefinition />
    </Grid.RowDefinitions>
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="auto"/>
        <ColumnDefinition />
    </Grid.ColumnDefinitions>

    <Grid Grid.Column="1">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="auto"/>
            <ColumnDefinition/>
        </Grid.ColumnDefinitions>

        <TextBlock Text="The window should fit to the width of this" FontSize="15"/>

        <Canvas Background="Red" Grid.Column="1"/>
    </Grid>

    <Grid Grid.Row="1" Grid.RowSpan="2">
        <Grid.RowDefinitions>
            <RowDefinition Height="auto"/>
            <RowDefinition/>
        </Grid.RowDefinitions>

        <TextBlock Text="The window should fit to the height of this" FontSize="15">
            <TextBlock.LayoutTransform>
                <RotateTransform Angle="-90"/>
            </TextBlock.LayoutTransform>
        </TextBlock>

        <Canvas Background="Blue" Grid.Row="1"/>
    </Grid>

    <Grid Grid.Row="2" Grid.Column="1">
        <ListBox Name="ListBox1">
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <TextBlock Text="{Binding}" />
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>
    </Grid>
</Grid> 
```

MainWindow.xaml.cs：

```
public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();

        var Messages = new ObservableCollection<string>() { "This is a long string to demonstrate that the list box content is determining window width" };

        for (int i = 0; i < 16; i++)
            Messages.Add("Test" + i);

        for (int i = 0; i < 4; i++)
            Messages.Add("this text should be visible by vertical scrollbars only");

        ListBox1.ItemsSource = Messages;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T21:37:15.820

设置列表框 ItemsSource，并在 Window 加载后设置 SizeToContent=Manual。

```
public MainWindow()
{
    InitializeComponent();

    Loaded += OnLoaded;
}

private void OnLoaded(object sender, RoutedEventArgs routedEventArgs)
{
    SizeToContent = SizeToContent.Manual;

    var messages = new ObservableCollection<string>
        {
            "This is a long string to demonstrate that the list" + 
            " box content is determining window width"
        };

    for (int i = 0; i < 16; i++)
    {
        messages.Add("Test" + i);
    }

    for (int i = 0; i < 4; i++)
    {
        messages.Add("this text should be visible by vertical scrollbars only");
    }

    ListBox1.ItemsSource = messages;
} 
```

以这种方式，主窗口最初的大小适合内容（列表框中没有数据），然后列表框使用滚动条显示其项目。

# ruby - 隐藏系统命令导致红宝石

> ID：10922044
> 
> 赞同：14
> 
> 时间：2012-06-06T20:48:39.060
> 
> 标签：ruby, command, system

在 ruby​​ 中隐藏系统命令的结果有多容易？例如，我的一些脚本运行

```
system "curl ..." 
```

而且我不想看到下载的结果。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-06T20:51:59.600

如果您愿意，可以使用更复杂的[popen3](http://apidock.com/ruby/Open3/popen3/class)分别控制 STDIN、STDOUT 和 STDERR：

```
Open3.popen3("curl...") do |stdin, stdout, stderr, thread|
  # ...
end 
```

如果您想使某些流静音，您可以忽略它们，或者如果重定向或解释该输出很重要，您仍然可以使用它。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2018-05-15T14:12:38.097

`system`要在不修改命令的情况下使其正常工作：

```
system('curl ...', :err => File::NULL) 
```

[资源](https://stackoverflow.com/questions/1960838/suppressing-the-output-of-a-command-run-using-system-method-while-running-it-i#answer-35142176)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-06T21:04:43.660

除了 popen 最简单的方法：

1.  使用 %x 代替系统。它会自动管道

    ```
    rval = %x{curl ...}       #rval will contain the output instead of function return value 
    ```

2.  手动管道到 /dev/null。在类似 UNIX 的系统中工作，而不是在 Windows 中工作

    ```
    system "curl ... > /dev/null" 
    ```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-06T20:56:57.877

最简单的一种是重定向标准输出 :)

```
system "curl ... 1>/dev/null"
# same as
`curl ... 1>/dev/null` 
```

# ruby - Ruby 在哪里跟踪其打开的文件描述符？

> ID：10922045
> 
> 赞同：25
> 
> 时间：2012-06-06T20:48:39.263
> 
> 标签：ruby, file-io, io, file-descriptor, filehandle

### 这个问题*不是*关于什么

这个问题*不是*关于如何使用 File#close 或 File#open 块语法自动关闭文件。这是一个关于 Ruby 在运行时将其打开文件描述符列表存储在何处的问题。

### 实际问题

如果您有一个带有打开描述符的程序，但您无权访问相关的 File 或 IO 对象，您如何找到对当前打开的文件描述符的引用？举个例子：

```
filename='/tmp/foo'
%x( touch "#{filename}" )
File.open(filename)
filehandle = File.open(filename) 
```

打开第一个 File 实例，但对对象的引用未存储在变量中。第二个实例存储在*filehandle*中，我可以在其中使用#inspect 或#close 轻松访问它。

但是，丢弃的 File 对象并没有消失；它只是无法以任何明显的方式访问。在对象最终确定之前，Ruby 必须在某个地方跟踪它……但是在哪里呢？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-06-06T20:48:39.747

### TL; 博士

所有 File 和 IO 对象都存储在 ObjectSpace 中。

### 回答

[ObjectSpace](http://www.ruby-doc.org/core-1.9.3/ObjectSpace.html)类说：

> ObjectSpace 模块包含许多与垃圾收集工具交互的例程，并允许您使用迭代器遍历所有活动对象。

### 我是如何测试的

我在 Ruby 1.9.3p194 的控制台上对此进行了测试。

测试夹具非常简单。这个想法是有两个具有不同对象标识的 File 对象，但只有一个可以通过变量直接访问。另一个是“在某处”。

```
# Don't save a reference to the first object.
filename='/tmp/foo'
File.open(filename)
filehandle = File.open(filename) 
```

然后，我探索了与 File 对象交互的不同方式，即使我没有使用显式对象引用。一旦我了解了 ObjectSpace，这非常容易。

```
# List all open File objects.
ObjectSpace.each_object(File) do |f|
  puts "%s: %d" % [f.path, f.fileno] unless f.closed?
end

# List the "dangling" File object which we didn't store in a variable.
ObjectSpace.each_object(File) do |f|
  unless f.closed?  
    printf "%s: %d\n", f.path, f.fileno unless f === filehandle
  end
end

# Close any dangling File objects. Ignore already-closed files, and leave
# the "accessible" object stored in *filehandle* alone.
ObjectSpace.each_object(File) {|f| f.close unless f === filehandle rescue nil} 
```

### 结论

可能还有其他方法可以做到这一点，但这是我想出的解决我自己痒的答案。如果您知道更好的方法，请发布另一个答案。世界将因它而变得更美好。

# encryption - 批量重命名/移动/散列文件

> ID：10922047
> 
> 赞同：1
> 
> 时间：2012-06-06T20:48:41.520
> 
> 标签：encryption, filenames, batch-processing, batch-rename

我有一个高度结构化的分层目录，其中包含多个需要移动到平面结构并同时重命名的文件。原始路径和名称必须与新路径和名称一起记录并最终加载到数据库中。最后，每个重命名的文件必须有一个唯一的、不可猜测的（IE：加密或散列）文件名。当重命名的文件被移动到新的目录结构中时，我还想限制每个目录中的文件数，所以每个目录都会创建一个序号作为其名称，然后文件将被加载到其中，直到最大在滚动到具有下一个序列号为其名称的新目录之前，已达到文件数（例如：255）。

有没有这样的工具/软件？我做了一些初步研究，但没有提出以下标准：

*   批量重命名并复制到替代（扁平）结构
*   散列/加密文件名并确保唯一性
*   按顺序命名文件夹并限制文件数
*   记录每个文件的原始名称和路径，以及新的（加密的）名称和路径

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-17T12:39:33.363

我过去曾使用几个 Bash 脚本将手工制作的文件存储库迁移到散列存储库，以便从 Web 应用程序（主要是 PHP 应用程序）访问和管理。在这些存储库中，文件名被散列（以避免与具有相同内容/名称的文件发生冲突）并且文件均匀分布（以确定性方式或随机方式）以保持每个目录的文件数较低，以提高性能。以下是一个完整的示例：

```
#!/bin/bash

MAXFILESPERDIR=500
TARGETROOTDIR="./newrepository"
RANDOMDISTRIBUTION=1

if [ -d "$1" ]; then
  LOGFILE=$(basename $0).$(date +"_%Y%m%d_%H%M").${$}.log
  SQLFILE=$(basename $0).$(date +"_%Y%m%d_%H%M").${$}.sql
  SOURCEDIR="$1"
  TOTALSOURCEFILES=$(find "$1" -type f | wc -l)
  let "TOTALTARGETDIRS=$TOTALSOURCEFILES / $MAXFILESPERDIR"
  PADLENTARGETDIRS=${#TOTALTARGETDIRS}
  PADLENTARGETFILE=${#TOTALSOURCEFILES}
  echo "We will create $TOTALTARGETDIRS directories to hold $MAXFILESPERDIR files per directory."
  if [ "$RANDOMDISTRIBUTION" == "1" ] ; then
    echo "We will rename and distribute each file randomly."
  else
    echo "We will rename and distribute each file uniformly."
  fi
  echo "Do you want to continue?"
  select choice in yes no ; do
    if [ "$choice" == "yes" ] ; then
      COUNTER=1
      find "$1" -type f | while read SOURCEFILE ; do { 
        CHECKSUMFILE=$(sha1sum "$SOURCEFILE" | cut -d " " -f 1)
        CHECKSUMNAME=$(echo "$SOURCEFILE" | sha1sum | cut -d " " -f 1)
        DETERMINISTICNONCE=$(printf "%0${PADLENTARGETFILE}d\n" $COUNTER)
        if [ "$RANDOMDISTRIBUTION" == "1" ] ; then
          PROBABILISTICNONCE=$(let "XX=$RANDOM % $TOTALTARGETDIRS + 1" ; printf "%0${PADLENTARGETDIRS}d\n" $XX;)
        else
          PROBABILISTICNONCE=$(let "XX=$COUNTER % $TOTALTARGETDIRS + 1" ; printf "%0${PADLENTARGETDIRS}d\n" $XX;)
        fi
        FILEDATE=$(stat -c %z "$SOURCEFILE" | cut -d "." -f 1)
        FILESIZE=$(stat -c %s "$SOURCEFILE")
        echo "Source file $SOURCEFILE" >> $LOGFILE
        echo "Target file $TARGETROOTDIR/$PROBABILISTICNONCE/$PROBABILISTICNONCE$CHECKSUMFILE$DETERMINISTICNONCE" >> $LOGFILE
        echo "INSERT INTO files (Filename, Location, Checksum, CDate, Size) VALUES ('$PROBABILISTICNONCE$CHECKSUMFILE$DETERMINISTICNONCE', '$PROBABILISTICNONCE', '$CHECKSUMFILE', '$FILEDATE', $FILESIZE);" >> $SQLFILE
        mkdir -p $TARGETROOTDIR/$PROBABILISTICNONCE
        cp -v "$SOURCEFILE" $TARGETROOTDIR/$PROBABILISTICNONCE/$PROBABILISTICNONCE$CHECKSUMFILE$DETERMINISTICNONCE
        let "COUNTER+=1"
      } ; done
      echo "Done."
      echo
      break
    fi
    if [ "$choice" == "no" ] ; then
      echo
      echo "Operation cancelled"
      echo
      break
    fi
  done
else 
  echo
  echo "Missing source directory"
  echo
fi 
```

只需从新存储库的根目录运行它。你可以通过修改第一个变量来配置它：MAXFILESPERDIR 定义每个目录存储多少个文件，TARGETROOTDIR 是创建一级目录的一级目录的名称（它只使用两级，第一级真的是单级的） root），而 RANDOMDISTRIBUTION 定义文件是随机分布（它可能看起来不均匀，特别是对于小运行）还是确定性分布（只是计数）。

它是如何工作的（仅供参考，以防这不是您想要的，但也许您可以获得一些想法）：

1.  计算源文件。
2.  计算将创建多少个目标目录。
3.  要求确认。
4.  对于每个文件：
    *   计算文件内容的 SHA1 哈希。
    *   创建一个确定性的随机数。
    *   创建一个概率随机数（如果 RANDOMDISTRIBUTION 为 1，否则只是一个计数器）。
    *   获取尺寸和修改日期。
    *   将随机值的值与散列和计数器组合以获得新的文件名（路径将是随机值）。
    *   记录源和目标完整路径。
    *   创建并记录 SQL 插入查询。
    *   创建目标目录（如果不存在）。
    *   复制文件。（如果你愿意，你可以移动它，但我很安全）。
5.  结束

如果您将 RANDOMDISTRIBUTION 设置为 1 并多次运行脚本，您将获得源文件的副本，因为每次运行每个文件都会获得不同的目标文件名/路径。如果 RANDOMDISTRIBUTION 设置为其他值，则每次运行脚本时，文件都将以相同的方式重命名（对于相同的文件集，如果添加或删除文件，它们将获得不同的名称/路径）。

使用随机值 + 哈希 + 计数器的目的是确保我们可以处理重复文件（由于计数器不会发生冲突），同时仍然随机分布文件（对于足够长的运行，这将均匀分布文件）。

另外，生成的文件名的前缀也是目录名，所以如果你有文件名和目录名长度，你可以计算目录名（以防万一你没有将它存储在数据库中桌子）。

最后，这是一个一次性迁移脚本，它并没有真正编写为在同一组文件上定期执行。

# ios - UIView 滑动过渡淡出

> ID：10922048
> 
> 赞同：0
> 
> 时间：2012-06-06T20:48:43.377
> 
> 标签：ios, uiview, core-animation, transitions, catransition

我的一个视图控制器中有一些代码可以从一个视图滑动过渡到另一个视图：

```
-(void)transitionToNewView:(UIView*)newView
{

    UIView *superView = [self.view superview]; 
    [superView addSubview:newView]; 
    newView.frame = superView.bounds;
    [self.view removeFromSuperview]; 

    CATransition *animation = [CATransition animation]; 
    [animation setDuration:0.5]; 
    [animation setType:kCATransitionPush];
    [animation setSubtype:kCATransitionFromLeft]; 
    [animation setTimingFunction:[CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut]];

    [[superView layer] addAnimation:animation forKey:@"keygoeshere"];
} 
```

滑动过渡似乎工作正常，但除了滑动之外，我还看到新视图从空白屏幕淡入。我怀疑这是因为我正在向以前不存在的超级视图添加一个新视图。我想做的是同样的事情，但没有淡入。我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T23:37:47.253

I think the kCATransitionPush transition does a fade at the same time by design. I could swear I remember reading that somewhere.

It would be pretty simple to construct a view-to-view push transition using the method transitionFromView:toView:duration:options:completion:.

Pass in UIViewAnimationOptionTransitionNone for the transition option, and then use an animation block that slides the current view off-screen while sliding the new view on-screen from the opposite direction.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T21:38:27.733

我对您的问题没有直接的答案，但我发现处理两个视图之间的转换的一种方法是像您一样将新视图添加到您的超级视图，截取每个视图的屏幕截图，实现动画并删除这两个视图转换完成时的屏幕截图视图。我更详细地解释了我在[这里](https://stackoverflow.com/questions/9466231/how-do-you-perform-a-customized-segue-modal-segue-from-a-uibutton-in-storyboar)所做的事情，并且效果很好。我认为值得尝试解决您面临的问题。有什么理由不使用 UIView 上的 animateWithDuration 方法吗？

# java - 如何在java中创建整数UUID

> ID：10922050
> 
> 赞同：3
> 
> 时间：2012-06-06T20:48:58.637
> 
> 标签：java, integer, uuid

> **可能重复：**
> [有没有办法生成仅由数字组成的随机 UUID？](https://stackoverflow.com/questions/8092970/is-there-a-way-to-generate-a-random-uuid-which-consists-only-of-numbers)

我不想在`UUID`唯一的整数中有字符..如何做到这一点`java`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-06T21:04:17.277

*   使用`getMostSigBits()`and`getLeastSigBits()`获取长值。
*   然后使用这些长值来填充`byte[]`.
*   然后使用那个 byte[] 来制作一个`BigInteger`对象。
*   那就是`BigInteger`toString() 将是一个可能为负数的 UUID。您可以通过将`-`符号替换为 1 或其他类似技术来解决该问题。

我还没有测试过这个，但是whatevs #gimmetehcodez

```
long hi = id.getMostSignificantBits();
long lo = id.getLeastSignificantBits();
byte[] bytes = ByteBuffer.allocate(16).putLong(hi).putLong(lo).array();
BigInteger big = new BigInteger(bytes);
String numericUuid = big.toString().replace('-','1'); // just in case 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-06T20:58:25.970

您需要 2`long`秒来存储`UUID`.

```
UUID myuuid = UUID.randomUUID();
long highbits = myuuid.getMostSignificantBits();
long lowbits = myuuid.getLeastSignificantBits();
System.out.println("My UUID is: " + highbits + " " + lowbits); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-06T21:25:48.243

这将生成一个没有字符的 v4 UUID，但是它变得不那么独特了。

```
final int[] pattern = { 8, 4, 4, 4, 12 };

final int[] versionBit = { 2, 0 }; /* 3rd group, first bit */
final int version = 4;

final int[] reservedBit = { 3, 0 }; /* 4rd group, first bit */
final int reserved = 8; /* 8, 9, A, or B */

Random rand = new Random();

String numericUuid = "";

for (int i = 0; i < pattern.length; i++) {
    for (int j = 0; j < pattern[i]; j++) {
        if (i == versionBit[0] && j == versionBit[1])
            numericUuid += version;
        else if (i == reservedBit[0] && j == reservedBit[1])
            numericUuid += reserved;
        else
            numericUuid += rand.nextInt(10);
    }

    numericUuid += "-";
}

UUID uuid = UUID.fromString(numericUuid.substring(0, numericUuid.length() - 1));
System.out.println(uuid); 
```

您还可以使用以下代码进行暴力破解：

```
UUID uuid = UUID.randomUUID();

while (StringUtils.containsAny(uuid.toString(), new char[] { 'a', 'b', 'c', 'd', 'e', 'f' })) {
    uuid = UUID.randomUUID();
}

System.out.println(uuid); 
```

# c++ - 如何检查 QNAN 的双精度

> ID：10922052
> 
> 赞同：0
> 
> 时间：2012-06-06T20:49:00.177
> 
> 标签：c++, comparison, double

是否有正确的方法来检查 QNAN 以外

```
double t = <QNAN>;
if(t != t)
{
    //t is QNAN
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T21:06:07.373

isnan() 是 C++11 的一部分。

```
std::isnan(float);
std::isnan(double);
std::isnan(long double); 
```

# perl - Perl WWW::Mechanize（或 LWP）获取重定向 url

> ID：10922054
> 
> 赞同：8
> 
> 时间：2012-06-06T20:49:10.953
> 
> 标签：perl, url, redirect, www-mechanize, lwp

所以我`WWW::Mechanize`用来抓取网站。它工作得很好，除非我请求一个网址，例如：

```
http://www.levi.com/ 
```

我被重定向到：

```
http://us.levi.com/home/index.jsp 
```

对于我的脚本，我需要知道这个重定向发生了，以及我被重定向到的 url 是什么。反正有没有用`WWW::Mechanize`or检测到这个，`LWP`然后得到重定向的 url？谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-06T21:47:45.660

```
use strict;
use warnings;
use URI;
use WWW::Mechanize;

my $url = 'http://...';
my $mech = WWW::Mechanize->new(autocheck => 0);
$mech->max_redirect(0);
$mech->get($url);

my $status = $mech->status();
if (($status >= 300) && ($status < 400)) {
  my $location = $mech->response()->header('Location');
  if (defined $location) {
    print "Redirected to $location\n";
    $mech->get(URI->new_abs($location, $mech->base()));
  }
} 
```

如果状态码是**3XX**，那么您应该检查重定向 url 的响应标头。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-05-17T22:26:07.150

您还可以通过检查`redirects()`响应对象上的方法来到达相同的位置。

```
use strict;
use warnings;
use feature qw( say );

use WWW::Mechanize;

my $ua = WWW::Mechanize->new;
my $res = $ua->get('http://metacpan.org');

my @redirects = $res->redirects;
say 'request uri: ' . $redirects[-1]->request->uri;
say 'location header: ' . $redirects[-1]->header('Location'); 
```

印刷：

```
request uri: http://metacpan.org
location header: https://metacpan.org/ 
```

请参阅[https://metacpan.org/pod/HTTP::Response#](https://metacpan.org/pod/HTTP::Response#) $r-%3Eredirects 请记住，不止一个重定向可能会将您带到您当前的位置。因此，您可能想要检查通过返回的每个响应`redirects()`。

# c# - 将偶校验 ASCII 转换为普通 ASCII

> ID：10922055
> 
> 赞同：0
> 
> 时间：2012-06-06T20:49:12.043
> 
> 标签：c#, ascii

我有一个字节数组：

```
evenParityASCII[0] = 0xB1; // 1
evenParityASCII[1] = 0xB2; // 2
evenParityASCII[2] = 0x33; // 3
evenParityASCII[3] = 0xB4; // 4
evenParityASCII[4] = 0x35; // 5 
```

我需要将这些转换为普通的 ASCII。有没有一种简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T20:56:58.127

你在找`System.Text.Encoding`吗？

```
for (int i = 0; i < evenParityASCII.Length; i++)
{
    evenParityASCII[i] = (byte)(evenParityASCII[i] & 0x7F);
}
string myAscii = System.Text.Encoding.ASCII.GetString(evenParityASCII); 
```

# mysql - 如何在 MySQL 中获取数字列表？

> ID：10922064
> 
> 赞同：4
> 
> 时间：2012-06-06T20:49:38.053
> 
> 标签：mysql, sql

我有一个电影数据库，我想列出那一年我没有电影的年份。所以我需要的只是一个列表（1900 .. 2012），然后我可以加入和加入，而不是加入我想要的所有内容。

我有：

```
CREATE PROCEDURE build_years(p1 SMALLINT) 
BEGIN 
    CREATE TEMPORARY TABLE year (year SMALLINT(5) UNSIGNED); 
    label1: LOOP 
        INSERT INTO year VALUES (p1); 
        SET p1 = p1 + 1; 
        IF p1 > 2012 THEN LEAVE label1; END IF; 
    END LOOP; 
END 
```

但这似乎太不符合 SQL 了，而且只比运行 Python 代码创建同一个表稍微少一些。我真的很喜欢不使用存储过程、不使用循环并且不使用实际表的东西，按照关注的顺序。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T22:10:46.460

这应该可以工作，直到您需要超过 195 年，此时您需要添加`UNION ALL`：

```
SELECT Year 
FROM   (   SELECT @i:= @i + 1 AS YEAR
           FROM   INFORMATION_SCHEMA.COLLATION_CHARACTER_SET_APPLICABILITY,
                  ( SELECT @i:= 1899) AS i
        ) As Y
WHERE   Year BETWEEN 1900 AND 2012
ORDER BY Year; 
```

尽管我假设`COLLATION_CHARACTER_SET_APPLICABILITY`System 表的默认大小为 195，但基于我可信赖的测试场[SQL Fiddle](http://sqlfiddle.com/#!2/3b815/1)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-06T21:22:11.153

几年前我也遇到过类似的问题。我的解决方案是：

**1.序列表**

我创建了一个表格，其中填充了从 0 到 < 所需数量 > 的整数序列：

```
CREATE TABLE numbers (n INT);
INSERT INTO numbers VALUES (0),(1),(2),(3),(4);
INSERT INTO numbers SELECT n+5 FROM numbers;
INSERT INTO numbers SELECT n+10 FROM numbers;
INSERT INTO numbers SELECT n+20 FROM numbers;
INSERT INTO numbers SELECT n+40 FROM numbers;
etc. 
```

它只执行一次，因此可以从您的应用程序外部创建，甚至可以手动创建。

**2.选择所需类型和范围的数据**

对于整数很明显 - 即范围 1..99：

```
SELECT n FROM numbers WHERE n BETWEEN 1 AND 99; 
```

日期 - 从现在到 +2 天的 2 小时间隔：

```
SELECT date_add(now(),INTERVAL 2*n HOUR) FROM numbers WHERE n BETWEEN 0 AND 23; 
```

所以在你的情况下，它可能是：

```
SELECT n+1900 AS n_year FROM numbers WHERE n BETWEEN 0 AND 112; 
```

然后`JOIN`就可以了`n_year`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-06T21:23:10.190

如果您真的想将其保留在查询中，这将返回 2012 到 1900 的列表。

```
SELECT 
    TO_CHAR (ADD_MONTHS (TRUNC (SYSDATE, 'YYYY'), ((rno - 1) * -12)), 'YYYY') AS "years"
FROM 
    (
    SELECT 
        LEVEL rno
    FROM DUAL
    CONNECT BY LEVEL <=
                   (SELECT TO_CHAR (TRUNC (SYSDATE, 'YYYY'), 'YYYY')
                           - 1899
                               yearstobuild
                      FROM DUAL)) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T21:21:12.297

根据您的意愿，我能想到的唯一解决方案也很糟糕...

```
SELECT years.year FROM
    (
        SELECT 1900 AS year
        UNION SELECT 1901
        ...
        UNION SELECT 2012
    ) AS years
    LEFT OUTER JOIN yourmovietable USING (year)
WHERE yourmovietable.year IS NULL; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-11-20T13:08:10.667

使用这个通用查询更快：

```
INSERT INTO numbers SELECT n+(SELECT COUNT(*) FROM numbers) FROM numbers; 
```

每个查询执行重复：

```
INSERT INTO numbers VALUES (0),(1),(2),(3),(4);

INSERT INTO numbers SELECT n+(SELECT COUNT(*) FROM numbers) FROM numbers;
INSERT INTO numbers SELECT n+(SELECT COUNT(*) FROM numbers) FROM numbers;
INSERT INTO numbers SELECT n+(SELECT COUNT(*) FROM numbers) FROM numbers; 
```

...

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-06-06T20:52:32.127

```
select year into temporary table blaa from (generate_series(1900,2000)) where year not in(select distinct(year) from films) 
```

不知道这是否可行，但你会得到漂移。

# android - 将文件从android发送到服务器时更改文件名

> ID：10922065
> 
> 赞同：0
> 
> 时间：2012-06-06T20:49:45.943
> 
> 标签：android, file, upload, filenames, multipartentity

我正在编写一个可以将文件上传到服务器的应用程序。在应用程序运行期间，信息被写入文件并被删除。每当文件上传到服务器时，我都想要一个新的文件名，这样旧文件就不会被替换。但是，该文件可能很大，因此我只想在 android 系统上维护一个文件。我希望服务器上的文件名具有上传日期和时间。有没有办法使服务器上的文件名与发送它的设备上的文件名不同？

我正在使用服务器上的标准多部分实体框架和 php 代码将文件上传到服务器。php代码如下所示：

```
<form enctype="multipart/form-data" action="upload.php" method="POST">
<input type="hidden" name="MAX_FILE_SIZE" value="100000" />
Choose a file to upload: <input name="uploadedfile" type="file" /><br /

<input type="submit" value="Upload File" />
</form>

<?php
  $to_file = "locationdata/" . basename($_FILES['uploadedfile']['name']);
  $from_file = $_FILES['uploadedfile']['tmp_name'];

  if (move_uploaded_file($from_file, $to_file)) {
    echo "Successful upload";
?>
  <a href="<?php echo $to_file;?>"><?php echo $to_file;?></a>
<?php
  } else {
    echo "Unsuccessful upload";
  }
?> 
```

以下是我的 android 应用程序代码片段。

```
public static File file = new File("/sdcard/upload.txt");
public static FileWriter writer; 
```

此代码位于我在应用程序运行期间（可能多次）调用的方法中。

```
writer = new FileWriter(file);
writer.write(".... what I want to print here.......");
writer.close(); 
```

然后我使用以下代码将文件发送到服务器。

```
HttpClient client = new DefaultHttpClient();
HttpUriRequest request = new HttpPost(webAddress);
MultipartEntity form = new MultipartEntity();
client.getParams().setBooleanParameter("http.protocol.expect-continue", false);
form.addPart(inputName, new FileBody(new File(filePath)));
((HttpEntityEnclosingRequestBase) request).setEntity(form);

try {
    client.execute(request);    
    System.out.println("Connection Success");
} catch (ClientProtocolException e) {
    throw e;
} catch (IOException ee) {
    throw ee;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T20:59:20.137

有没有办法使服务器上的文件名与发送它的设备上的文件名不同？

是的！您所要做的就是将 $to_file 更改为其他内容，例如：

```
$dates = date('YmdHis');
$to_file = "locationdata/" . $dates."." . basename($_FILES['uploadedfile']['name']); 
```

编辑：添加 ."."。以便将日期/时间与原始文件名分开。如果以后需要，您更容易爆炸。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T20:55:51.077

你能用`renameTo`in中的方法`File`吗？

```
file.renameTo(newFile); 
```

# java - 将包含另一个对象的对象转换为 json

> ID：10922066
> 
> 赞同：-2
> 
> 时间：2012-06-06T20:49:49.097
> 
> 标签：java, javascript, json

我需要将数据传递`HTML`给`Service`using `JSON`(in `JS/JQUERY`)

在服务中，我有一个服务调用，它接收一个包含另一个对象和另外 2 个字段的对象。

角色对象：

```
import java.io.Serializable;

public class Role implements Serializable {           
    private long id;
    private String name;    
} 
```

用户对象：

```
import java.io.Serializable;

public class User implements Serializable {           
    private String userName;
    private String password;    
    private ArrayList<Role> roles;
} 
```

到目前为止，我设法将数据传递`JSON`给其他服务：（仅包含 2 个参数的数据： id 和 userName ）

```
xmlHttp.open("POST", "http://www.foo.com/serviceFunction2", true);
xmlHttp.send('{"Id": "123", "userName": "test"}'); 
```

所以，我的问题是如何填充包含**Role对象的****User**对象使用 ？就像我设法用这条线发送它：**`JS/JQUERY`** 

 **```
xmlHttp.send('{"Id": "123", "userName": "test"}'); 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T21:17:35.207

有几种方法可以在 JS 中“嵌套”对象，但为了您的目的，最简单的方法可能是嵌套您的对象和/或数组字面量。如果“角色”应该是一个数组，那么像这样：

```
'{"userName":"test", "password":"secret", "roles":["role1","role2","role3"]}' 
```

如果数组中的每个角色本身都是具有属性的对象：

```
{
   "userName":"test",
   "password":"secret",
   "roles": [
       { "roleName":"role1", "prop2":"someValue", "prop3":"whatever" },
       { "roleName":"role2", "prop2":"someValue", "prop3":"whatever" },
       { "roleName":"role3", "prop2":"someValue", "prop3":"whatever" }
   ]
} 
```

（为了便于阅读，添加了换行符，但如果创建字符串，您会删除它们。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T21:54:06.087

我不知道您的目标是什么，但如果您使用 HTML 页面作为 GUI 和 Java 进行处理，您不妨使用[jsf](/questions/tagged/jsf "显示标记为“jsf”的问题")或类似的东西。有多个框架，例如[primefaces](/questions/tagged/primefaces "显示标记为“primefaces”的问题")、[myfaces](/questions/tagged/myfaces "显示标记为“myfaces”的问题")或[icefaces](/questions/tagged/icefaces "显示标记为“icefaces”的问题")可以为您处理很多事情。

如果您有兴趣，请查看[Primefaces 展示。](http://www.primefaces.org/showcase/ui/home.jsf)

正如 MattBall 建议的那样，您也可以使用[jaxb 之](/questions/tagged/jaxb "显示标记为“jaxb”的问题")类的东西，这可以减轻您的负担。

你可以使用很多强大而简单的东西。

您可以使用注释将对象映射到 JSON/XML：

```
@XmlRootElement
@XmlAccessorType(XmlAccessType.FIELD)
public class Role
{
    @XmlAttribute
    private long id;
    @XmlAttribute
    private String name;    
}

@XmlRootElement
@XmlAccessorType(XmlAccessType.FIELD)
public class User
{
    @XmlAttribute
    private String userName;
    @XmlAttribute
    private String password;
    @XmlElement    
    private ArrayList<Role> roles;
} 
```

然后，您可以在 Web 服务中使用它：

```
@GET
@Produces(MediaType.APPLICATION_JSON)
@Path("user/{username}")
public User getUser( @PathParam("username") String userName)
{
    User user;
    // Get your user
    return user;
} 
```**

# sql - regexp_matches postgreSQL 函数中的简单参数替换

> ID：10922069
> 
> 赞同：1
> 
> 时间：2012-06-06T20:49:59.053
> 
> 标签：sql, regex, postgresql, plpgsql

我有一张这样结构的桌子......

the_geom 数据

```
geom1    data1+3000||data2+1000||data3+222

geom2    data1+500||data2+900||data3+22232 
```

我想创建一个按用户请求返回记录的函数。

```
Example: for data2, retrieve geom1,1000 and geom2, 900 
```

直到现在我创建了这个函数（见下文），它工作得很好，但我面临一个参数替换问题......（你可以看到我无法用 'data2' 替换 $1 ......但是是的，我可以使用 $1之后

```
regexp_matches(t::text, E'(data2[\+])([0-9]+)'::text)::text)[2]::integer 
```

我的功能

```
create or replace function get_counts(taxa varchar(100))

returns setof record

as $$

SELECT t2.counter,t2.the_geom

FROM  (

   SELECT (regexp_matches(t.data::text, E'(data2[\+])([0-9]+)'::text)::text)[2]::integer as counter,the_geom

   from (select the_geom,data from simple_inpn2 where data ~ $1::text) as t

    ) t2

   $$
 language sql;

SELECT get_counts('data2') will work **but we should be able to make this substitution**:

regexp_matches(t::text, E'($1... instead of E'(data2.... 
```

我认为它更多的是语法问题，因为函数执行没有错误，只是将 $1 解释为字符串并且没有给出结果。

提前致谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:13:10.140

A`E'$1'`是一个字符串文字（使用[转义字符串](http://www.postgresql.org/docs/current/static/sql-syntax-lexical.html#SQL-SYNTAX-STRINGS-ESCAPE)语法），包含一个美元符号，后跟一个。未加引号`$1`是函数的第一个参数。所以这：

```
regexp_matches(t, E'($1[\+])([0-9]+)'))[2]::integer 
```

如您所见，不会`$1`用函数的第一个参数插入 。

正则表达式只是一个字符串，一个具有内部结构但仍然只是一个字符串的字符串。如果您知道这`$1`将是一个正常的词，那么您可以说：

```
regexp_matches(t, E'(' || $1 || E'[\+])([0-9]+)'))[2]::integer 
```

将您的字符串粘贴到合适的正则表达式中。然而，最好是有点偏执，迟早有人会用这样的字符串调用你的函数，`'ha ha ('`所以你应该为此做好准备。我能想到的将任意字符串添加到正则表达式的最简单方法是转义所有非单词字符：

```
-- Don't forget to escape the escaped escapes! Hence all the backslashes.
str := regexp_replace($1, E'(\\W)', E'\\\\\\1', 'g'); 
```

然后粘贴`str`到上面的正则表达式中：

```
regexp_matches(t, E'(' || str || E'[\+])([0-9]+)'))[2]::integer 
```

或者更好的是，在外部构建正则表达式`regexp_matches`以减少嵌套括号：

```
re := E'(' || str || E'[\+])([0-9]+)';
-- ...
select regexp_matches(t, re)[2]::integer ... 
```

PostgreSQL 没有[Perl`\Q...\E`](http://perldoc.perl.org/perlre.html#Escape-sequences)并且元[`(?q)`语法](http://www.postgresql.org/docs/current/static/functions-matching.html#POSIX-METASYNTAX)适用于正则表达式的结尾，所以我想不出比转义所有内容并让PostgreSQL 把它整理出来。

使用这种技术，我们可以执行以下操作：

```
=> do $$
    declare
        m text[];
        s text;
        r text;
    begin
        s = E'''{ha)?';
        r = regexp_replace(s, E'(\\W)', E'\\\\\\1', 'g');
        r = '(ha' || r || ')';
        raise notice '%', r;
        select regexp_matches(E'ha''{ha)?', r) into m;
        raise notice '%', m[1];
    end$$; 
```

并得到预期

```
NOTICE:  ha'{ha)? 
```

输出。但是如果你省略了`regexp_replace`转义步骤，你只会得到一个

```
invalid regular expression: parentheses () not balanced 
```

错误。

顺便说一句，我认为您不需要所有的演员表，所以我将其删除。正则表达式和转义足够嘈杂，没有必要在混合中加入一堆冒号。另外，我不知道您[`standard_conforming_strings`](http://www.postgresql.org/docs/current/static/runtime-config-compatible.html#GUC-STANDARD-CONFORMING-STRINGS)的设置是什么或您使用的是哪个版本的 PostgreSQL，所以我`E''`到处都使用字符串。您还需要将您的过程切换到 PL/pgSQL ( `language plpgsql`) 以使转义更容易。

# c# - try-catch-finally 后继续

> ID：10922070
> 
> 赞同：5
> 
> 时间：2012-06-06T20:50:06.853
> 
> 标签：c#, .net, exception-handling

这听起来像是一个奇怪的问题，但我不明白......

假设我有一个应用程序连接到服务器来做一些事情。此连接可能会失败并引发我可以捕获的异常。

```
try {
  Client.connect();
} catch (System.Exception ex) {
  // Do some exception handling...
} finally {
  // Do some cleanup...
} 
```

但是，如果连接成功，应用程序将继续...

```
try {
  Client.connect();
} catch (System.Exception ex) {
  // Do some exception handling...
} finally {
  // Do some cleanup...
}

// Talk to the server... 
```

然而，无论如何都会执行“服务器通话”。是否发生异常并不重要。

如何确保仅在连接成功时才执行“服务器通话”？我是否必须在`try`语句中移动以下所有代码？对这种行为进行编程的干净方法是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-06T20:52:37.993

“与服务器对话”应该发生在`try`区块中，紧随其后

```
Client.connect(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T20:54:18.440

最简单的方法是设置一个布尔值。但是有很多很多方法可以解决这个问题。

```
bool connectionError = false;

try {
    // connect
} catch (...) {
    connectionError = true;
} finally {
   // whatever
}

if (!connectionError) {
    // talk to server.
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-06T20:55:55.497

有另一个变量 like`clientConnected`并将其设置为 true 之后`Client.Connect()`。`clientConnected`然后在与服务器交谈之前在try-catch 之外进行检查。

避免在一次尝试中做所有事情。您应该对可能引发异常的不同操作使用单独的 try-catch 块，并尽可能多地捕获特定异常。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T20:57:15.367

通常，您对那些您希望抛出异常的语句使用 try...catch 语句。Try...Catch 定义了它自己的范围，因此您应该在 Try...Catch 块之外声明任何变量（至少，那些您想在它之外使用的变量）。

如果您想知道是否引发了异常，请在 Try...Catch 上方定义 Exception 变量。然后，您可以检查它以确定它是否为 Null。

```
System.Exception ex;
try {
  Client.connect();
} catch (ex) {
  // Do some exception handling...
} finally {
  // Do some cleanup...
}

if (ex != null){ ... }

// Talk to the server... 
```

您可以记录一个事件，然后调用一些代码重试或取消......或任何您需要做的事情。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-06T20:58:26.530

使用某种类型的标志变量来指示服务器是否已连接。如果您的方法返回一个布尔变量，那么也可以。

```
int flag=0;
while(flag==0){
   try {
       Client.connect();
       flag=1;
   } catch (System.Exception ex) {
   // Do some exception handling...
   } finally {
      // Do some cleanup...
   }
}

//If server connects code 
```

# java - 根据请求禁用 Jersey Provider

> ID：10922071
> 
> 赞同：0
> 
> 时间：2012-06-06T20:50:07.340
> 
> 标签：java, jersey, gson, jsr311

目前我已经注册了一个[Gson 提供者](http://grepcode.com/file/repo1.maven.org/maven2/net.derquinse/derquinse-common-jersey/1.0.13/net/derquinse/common/jersey/gson/GsonReader.java?av=f)，只要我的请求消耗或产生 json，它就会正确使用。

问题是我有一个需要将 Post 数据作为[byte[]、InputStream、Reader 或 String](http://jsr311.java.net/nonav/releases/1.1/spec/spec3.html#x3-460004.2.4)的请求。

我需要“原始”数据的原因是我有一些第三方代码，它希望在其中进行自己的反序列化。

无论我指定我的 Post 方法期望的这四种类型中的哪一种，GsonReader 都会抱怨，这是正确的。

> 应为字符串，但为 BEGIN_OBJECT

根据类型的不同，会出现不同的错误，但这一切都归结为我不希望这个 Provider/MessageBodyReader 运行。

此外，我无法控制已发布数据的 Accept 和 Content-type 标头。它们将是应用程序/json。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T12:03:39.713

您可以在过滤器中“修改”请求的接受/内容类型标头。因此，如果有任何方法可以识别出对于此请求，您不想使用 GSON，则可以编写一个修改标头的 ContanerRequestFilter。

如果使用 GSON 提供程序取决于请求匹配的方法，您可以实现 ResourceFilterFactory 应用（返回）ContainerRequestFilter（将内容类型标头修改为 json 以外的其他内容）仅适用于适用的方法（您甚至可以引入自定义注释，用它注释这样的方法，并且只有在传递给它的方法使用该注释注释时，resourcefilterfactory 才返回容器请求过滤器）。

以下是相关链接：

*   [ContainerRequestFilter javadoc](http://jersey.java.net/nonav/apidocs/latest/jersey/com/sun/jersey/spi/container/ContainerRequestFilter.html)
*   [资源过滤器工厂 javadoc](http://jersey.java.net/nonav/apidocs/latest/jersey/com/sun/jersey/spi/container/ResourceFilterFactory.html)
*   [RolesAllowedResourceFilterFactory](http://java.net/projects/jersey/sources/svn/content/trunk/jersey/jersey-server/src/main/java/com/sun/jersey/api/container/filter/RolesAllowedResourceFilterFactory.java?rev=5719) - 您可以将其用作资源过滤器工厂实现的示例

# android - 我有一个选项卡活动类，但我需要在一个选项卡下有谷歌地图而不将该类扩展为 MapActivity

> ID：10922077
> 
> 赞同：0
> 
> 时间：2012-06-06T20:50:34.173
> 
> 标签：android, tabactivity, mapactivity

我已经用扩展 tabactivty 的类编写了一个应用程序，但是在其中一个选项卡下我需要一个谷歌地图，但我不想用 MapActivity 扩展类，有什么办法可以使用地图而不是用 MapActivity 扩展主类？

因为如果我用 MapActivity 扩展它，我会收到很多错误。

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T20:53:12.370

据我所知，您必须使用 MapActivity 来获取 MapView。

如果您扩展 MapActivity，您会遇到什么错误？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T09:18:14.893

你可以试试 Actionbar Sherlock 库。也许这会有所帮助

# sharepoint-2010 - 如何计算 Infopath 中选中的复选框数量？

> ID：10922080
> 
> 赞同：0
> 
> 时间：2012-06-06T20:50:42.710
> 
> 标签：sharepoint-2010, infopath2010

我在“选择”类型的 SharePoint 列表中有一个列 - 它是复选框的集合。我需要在 Infopath 中添加一个操作，其中选中的复选框数量分配给另一个变量。如何获取选中的复选框数量？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T17:06:44.187

您是否尝试在 infopath 表单中创建一个字段，该字段设置为 open 为您的复选框值条件的总和？因此，例如，您将对值进行多次检查，并在满足条件的情况下使用字段操作的设置值将计数器加 1。

# android - Args Bundle 未传递给 Android TextView

> ID：10922091
> 
> 赞同：0
> 
> 时间：2012-06-06T20:51:35.700
> 
> 标签：android, textview, android-fragments, bundle, settext

我在一个片段中有一个 Bundle，它将一个字符串传递给另一个片段。此字符串需要在文本视图中设置文本，而我的方法不起作用。我不知道为什么，但我所有的其他字符串都通过了。

请看看我的代码，让我知道我有什么问题 - 我不明白......

从：

```
public void onClick(View v) {

        Bundle args = new Bundle();

        FragmentManager fm = getFragmentManager();
        final FragmentTransaction vcFT = fm.beginTransaction();
        vcFT.setCustomAnimations(R.anim.slide_in, R.anim.hyperspace_out, R.anim.hyperspace_in, R.anim.slide_out);

        switch (v.getId()) {

            case R.id.regulatoryBtn :

                String keyDiscriptionTitle = "Regulatory Guidance Library (RGL)";
                args.putString("KEY_DISCRIPTION_TITLE", keyDiscriptionTitle);

                RegulatoryDiscription rd = new RegulatoryDiscription();
                vcFT.replace(R.id.viewContainer, rd).addToBackStack(null).commit();
                rd.setArguments(args);
                break;
. . .
} 
```

到：

```
public class RegulatoryDiscription extends Fragment {

    Bundle args = new Bundle();

    String DNS = "http://192.168.1.17/";
    String KEY_DISCRIPTION_TITLE = "KEY_DISCRIPTION_TITLE";

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        View view = inflater.inflate(R.layout.discription_view, container, false);

        TextView title = (TextView) view.findViewById(R.id.discriptionTitle);
        String keyDiscriptionTitle = args.getString(KEY_DISCRIPTION_TITLE);
        title.setText(keyDiscriptionTitle);

        return view;
    }
 . . .
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T20:55:47.800

您在RegulatoryDe​​scription Fragment 中将args 声明为一个新的Bundle。这将初始化一个完全为空的新 Bundle 对象

您需要检索您传入的现有参数。

前任。

```
public class RegulatoryDiscription extends Fragment {
    Bundle args;

    String DNS = "http://192.168.1.17/";
    String KEY_DISCRIPTION_TITLE = "KEY_DISCRIPTION_TITLE";
  @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        View view = inflater.inflate(R.layout.discription_view, container, false);

        args = getArguments(); //gets the args from the call to rd.setArguments(args); in your other activity

        TextView title = (TextView) view.findViewById(R.id.discriptionTitle);
        String keyDiscriptionTitle = args.getString(KEY_DISCRIPTION_TITLE);
        title.setText(keyDiscriptionTitle);

        return view;
    }
} 
```

# foursquare - benHere 在 /venues/search 结果中始终为零

> ID：10922100
> 
> 赞同：0
> 
> 时间：2012-06-06T20:52:03.403
> 
> 标签：foursquare

在经过身份验证时，在我的应用程序或资源管理器中执行 /venues/search 查询时，场地返回时 benHere 计数为零。

```
/venues/search?ll=37.77215646,-122.40612745&query=meexo&intent=match

beenHere: {
  count: 0
} 
```

但是，如果我对相同的场所进行 /venues/ 查询，它们具有正确的 benHere 值。

```
/venues/4e76087d18506506ccad575b

beenHere: {
  count: 112
  marked: true
} 
```

这是已知问题还是错误？我可以通过遍历场所并执行单独的请求来解决此问题，但似乎在搜索结果中不返回值而不是不正确的值会更好。

另外，完整场地响应中的“标记”属性是什么？我没有在[文档](https://developer.foursquare.com/docs/responses/venue)中看到它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T15:38:57.210

将在今天或明天推出针对版本化请求 20120609 或更高版本的 herenow always 0 问题的修复。

# javascript - JQuery轮播简历问题

> ID：10922102
> 
> 赞同：1
> 
> 时间：2012-06-06T20:52:20.403
> 
> 标签：javascript, jquery, carousel

我正在使用 JQuery Simple Carousel，它做的一切都很好（自动播放，在每个列表项之间淡入淡出，上一个和下一个按钮）......但问题是当我点击一个按钮时它会停止自动播放。我想找到一个解决方案，一旦单击，轮播再次启动的时间是通常自动播放一次所需的时间的两倍。这是代码

```
<script type="text/javascript">
    jQuery(document).ready(function() {
        // Carousel 
        $("ul.writein").simplecarousel({
            width:692,
            height:148,
            auto: 5000,
            fade: 700,
            next: $('.next'),
            prev: $('.prev')
        });
    });

</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T21:27:00.473

问题出在以下代码部分：

```
if(typeof click != "undefined")
config.auto = false; 
```

在您使用任何导航后，它会有效地停止轮播。要解决这个问题，您需要：

**编辑添加动画超时重置**：

添加将存储超时以及超时是否处于活动状态的变量：

```
var myTimer, timerActive = false; 
```

紧接着`var li = ul.children('li');`

代替：

```
if(typeof click != "undefined")
            config.auto = false;

        if(config.auto!=false)
            setTimeout(function() {
                slide('next');
            }, config.auto); 
```

和：

```
if(typeof click != "undefined"){
    if(config.auto!=false){
        if (timerActive) clearTimeout(myTimer);
        myTimer = setTimeout(function() {
                slide('next');
            }, config.auto * 2);
        }
        timerActive = true;
    }
    else{
        if(config.auto!=false){
            if (timerActive) clearTimeout(myTimer);
            myTimer = setTimeout(function() {
                slide('next');
            }, config.auto);
            timerActive = true;
        }
    } 
```

并在轮播代码的最后替换：

```
if(config.auto!=false)
        setTimeout(function() {
            slide('next');
        }, config.auto); 
```

和：

```
if(config.auto!=false){
            if (timerActive) clearTimeout(myTimer);
            myTimer = setTimeout(function() {
                slide('next');
            }, config.auto);
            timerActive = true;
        } 
```

**----结束编辑----**

请注意，我实际上没有测试过任何这些 - 可能有错别字等。如果它不起作用，你可以随时尝试为 jQuery 旋转木马我写了[https://github.com/c2h5oh/jQuery-Cycle-Uber-精简版](https://github.com/c2h5oh/jQuery-Cycle-Uber-Lite)

# java - 在 Java servlet 中显式管理会话以保护 Web 应用程序

> ID：10922104
> 
> 赞同：0
> 
> 时间：2012-06-06T20:52:26.193
> 
> 标签：java, security, jsp, session, servlets

我正在开发一个安全的 Web 应用程序。我必须开发一个 servlet 来自定义控制它的访问。

例如，我打开了 home.jsp，一个依赖于 URL 模式的 content.jsp。

如果它是 GET content.jsp，它应该是敞开的以显示内容列表。如果是content.jsp?chapter=1&detail=true，它应该检查用户是否登录，只有当用户有正确的访问权限时，才会授予权限，否则，将其重定向到登录页面。

我对 Java 中的 JSESSIONID 管理感到困惑。默认情况下，如果没有会话，任何 JSP 都会自动创建会话。我知道我可以使用 @page session="false" 覆盖其默认行为。

所以，我猜逻辑会是这样的

1.  如果用户（尚未登录）GET home.jsp，我不应该在 servlet 中创建任何会话。但是 JSP 应该创建一个。我在 HTTP 请求标头中发现，它发送了 JSESSIONID 值。但是，为什么在服务器端，我不会通过 httpServletRequest.getSession(false) 获得任何会话？

2.  如果用户想要获取 content.jsp?chapter=1&detail=true，我会将其重定向到 logon.jsp。提交登录表单后，我是否应该使用 httpServletRequest.getSession(true) 在服务器端（返回之前）创建一个新会话？任何以下 JSP 页面访问都会创建一个新会话吗？

3.  当用户注销时，我必须调用 session.invalidate() 使其无效。但是，任何后续的 JSP 页面都会创建一个新的会话 ID 吗？

我只是困惑

```
 When should I call getSession(true) and getSession(false)? I assume per user session, I should call getSession(true) once.
 Which session id should I use (trust) to identify if the user is truly logged on? 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T21:00:56.250

会话和访问控制没有太多共同点。未经身份验证的用户可能有一个会话。例如，仅存储首选项可能很有用。

一旦通过身份验证，您可以保持相同的会话，但将用户的身份及其授权存储在会话中。您应该只将会话视为可以为给定用户存储属性的地方，该属性将在其与您的 web 应用程序的会话期间持续存在。

要恢复，会话的存在并不意味着用户已通过身份验证。您的身份验证机制存储在会话中的某些“已验证”标志或会话中的某些身份的存在是您必须检查以了解用户是否已通过身份验证的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T11:32:46.917

这工作正常

**主页.jsp**

```
session = request.getSession(false);  
//false: new session will not be created  

if(session == null){  
    //not in a session  
    //allow to view the home.jsp page and to login  
    //set an attribute into session  
    session.setAttribute("authorized","yes");  
}  
else{//in case a default session automatically establishes  
    if(session.getAttribute("authorized")==null){  
    //not in a valid session  
    //allow to login  
    }  
    else{//already in session, so cann't view the login page  
    //redirect to the home page by "RequestDispatcher"  
    } 
```

**联系人.jsp**

只需在此处执行相同的操作，例如
**1-**如果不在会话中，则重定向到 home.jsp
**2-**如果在会话中但`session.getAttribute("authorized")`给出`null`，然后也重定向到 home.jsp
**3-**如果在会话中并`session.getAttribute("authorized")`给出值`"yes"`，然后
允许联系.jsp

**注销时**

```
session.removeAttribute("authorized");  
session.invalidate(); 
```

但是你会面临一个问题。当您在contact.jsp 并单击浏览器的后退按钮时，您将
看到home.jsp 即登录页面，**或者**当您注销并进入logout.jsp 并单击
浏览器的后退按钮时，您将看到contact.jsp。为了避免这些，您必须将这**3 行**
放在 您想要访问控制的 每个页面中。在您的情况下， home.jsp 和 contact.jsp

```
<%  
    response.setHeader("Cache-Control","no-cache");  
    response.setHeader("Cache-Control","no-store");  
    response.setDateHeader("Expires", -1);  
%> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-11T06:46:24.450

CREATE A LOGIN Application USING SESSION USING SERVLET 看到这篇文章并简单实用——享受程序 [http://expertlogica.blogspot.in/2014/06/create-login-application-using-session.html](http://expertlogica.blogspot.in/2014/06/create-login-application-using-session.html)

# ruby-on-rails - 注册到 FakeWeb 的 URI 列表

> ID：10922108
> 
> 赞同：2
> 
> 时间：2012-06-06T20:52:35.210
> 
> 标签：ruby-on-rails, ruby, fakeweb

有没有办法在[FakeWeb](https://github.com/chrisk/fakeweb)中获取已注册的 URI 列表？当我注册一个像：

```
FakeWeb.register_uri(:get, url, body: expected_response) 
```

似乎它应该在某个地方可用，因为[它在内部跟踪它](https://github.com/chrisk/fakeweb/blob/master/lib/fake_web/registry.rb)，但我无法在外部跟踪它。类似的东西`FakeWeb.registered_uris`，但显然这不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T12:03:29.823

尝试

```
FakeWeb::Registry.instance.uri_map 
```

这将返回一个带有`FakeWeb::Responder`对象的嵌套散列。

当您使用 #register_uri 注册 uri 时，FakeWeb 会创建一个`FakeWeb::Responder`保存 uri 的 uri，然后将其存储在`FakeWeb::Registry`单例中。

您最终必须迭代结果映射并从中获取 uri：

```
FakeWeb::Registry.instance.uri_map.map { |_, v| v.map { |_, w| w } }.flatten.collect { |e| e.uri }.uniq 
```

希望这可以帮助。

# javascript - CSS 和 JS 的 Visual Studio 代码比较（用于合并）

> ID：10922109
> 
> 赞同：2
> 
> 时间：2012-06-06T20:52:36.237
> 
> 标签：javascript, css, visual-studio-2010, visual-studio, merge

在 Visual Studio 2010 中，合并更改时使用的代码比较工具在尝试合并 CSS 和 JS 文件时不是很好。

有什么好的第三方合并工具可以很好地处理 CSS 和 JS 文件并且我们可以与 VS2010 集成的建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T13:21:54.847

[WinMerge](http://winmerge.org/)是免费的、开源的、Just Works。

有关如何设置 VS2010 以使用 WinMerge 的说明，请参阅将[Visual Studio 比较工具更改为WinMerge。](http://blogs.microsoft.co.il/blogs/shair/archive/2011/06/01/change-visual-studio-compare-tool-to-winmerge.aspx)

这里是[让 VS (Team System) 2008 使用 WinMerge 的注意事项。](http://blog.paulbouwer.com/2010/01/31/replace-diffmerge-tool-in-visual-studio-team-system-with-winmerge/)

如果您使用 VisualSourceSafe (ugh)，您需要一些[额外的配置。](https://stackoverflow.com/a/4258496/41153)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T13:50:11.610

德瓦特代码比较：

[http://www.devart.com/codecompare/](http://www.devart.com/codecompare/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-07T13:42:17.917

BeyondCompare 非常好（虽然是付费的）：

[http://www.scootersoftware.com/index.php](http://www.scootersoftware.com/index.php)

并具有与 TFS 集成的说明： [http ://www.scootersoftware.com/support.php?zz=kb_vcs#tfs](http://www.scootersoftware.com/support.php?zz=kb_vcs#tfs)

注意我不为滑板车软件工作，我只是一个粉丝。我的作品有团体许可证，所以取决于您是否愿意为此付费。

虽然我过去也使用过 WinMerge，但我很喜欢它。

# wpf - 应用 ItemContainerStyle 时 ListView 失去 GridView 显示

> ID：10922112
> 
> 赞同：6
> 
> 时间：2012-06-06T20:52:41.770
> 
> 标签：wpf, listview, gridview, itemcontainerstyle

我有一个 WPF 应用程序，我在其中设置了几个组件的样式，使其看起来更像默认的 Windows 7 样式。现在我想对 ListView 做同样的事情，因为默认样式（即使在 Windows 7 上）看起来不太相似。

ListView 的 View 设置为带有一些 GridViewColumns 的 GridView。未应用任何样式的 ListView 的 XAML 如下所示：

```
 <ListView ItemsSource="{Binding Series.ServiceSeries.Weeks}">
                <ListView.View> 
                    <GridView>
                        <GridView.Columns>
                            <GridViewColumn Header="" DisplayMemberBinding="{Binding WeekNumber}" />
                            <GridViewColumn Header="Start date" DisplayMemberBinding="{Binding Path=., Converter={StaticResource WeekConverter}, ConverterParameter=start}" />
                            <GridViewColumn Header="Track" DisplayMemberBinding="{Binding Path=., Converter={StaticResource WeekConverter}, ConverterParameter=track}" />
                            <GridViewColumn Header="Race length" DisplayMemberBinding="{Binding Path=., Converter={StaticResource WeekConverter}, ConverterParameter=length}" />
                        </GridView.Columns>
                    </GridView>
                </ListView.View>
            </ListView> 
```

它在 Windows 7 上看起来像这样，您可以看到颜色略有错误： [1 http://www.nickthissen.nl/Images/Persistent/tmp3DCB.png](http://www.nickthissen.nl/Images/Persistent/tmp3DCB.png)

所以我决定对 ListView 的 ItemContainerStyle 应用自定义样式。除了用 ListViewItem 替换 ListBoxItem 之外，样式几乎与我用于 List *Box的样式完全相同：*

```
 <Style TargetType="{x:Type ListViewItem}" x:Key="ListViewItemStyle">
                    <Setter Property="OverridesDefaultStyle" Value="True" />
                    <Setter Property="SnapsToDevicePixels" Value="True" />
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="{x:Type ListViewItem}">

                                <Border x:Name="Border" CornerRadius="3" BorderThickness="1" SnapsToDevicePixels="True">
                                    <Border x:Name="InnerBorder" CornerRadius="2" BorderBrush="Transparent" Background="Transparent"
                            BorderThickness="1" Padding="3,1" SnapsToDevicePixels="True">

                                        <ContentPresenter />

                                    </Border>
                                </Border>

                                <ControlTemplate.Triggers>

                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="Border" Property="BorderBrush"
                                Value="{StaticResource ListboxItemHoverBorder}" />
                                        <Setter TargetName="InnerBorder" Property="BorderBrush"
                                Value="{StaticResource ListboxItemHoverInnerBorder}" />
                                        <Setter TargetName="InnerBorder" Property="Background"
                                Value="{StaticResource ListboxItemHoverBackground}" />
                                    </Trigger>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter TargetName="Border" Property="BorderBrush"
                                Value="{StaticResource ListboxItemSelectedBorder}" />
                                        <Setter TargetName="InnerBorder" Property="BorderBrush"
                                Value="{StaticResource ListboxItemSelectedInnerBorder}" />
                                        <Setter TargetName="InnerBorder" Property="Background"
                                Value="{StaticResource ListboxItemSelectedBackground}" />
                                    </Trigger>

                                    <MultiTrigger>
                                        <MultiTrigger.Conditions>
                                            <Condition Property="IsSelected" Value="true" />
                                            <Condition Property="Selector.IsSelectionActive" Value="false" />
                                        </MultiTrigger.Conditions>
                                        <Setter TargetName="Border" Property="BorderBrush"
                                Value="{StaticResource ListboxItemInactiveBorder}" />
                                        <Setter TargetName="InnerBorder" Property="BorderBrush"
                                Value="{StaticResource ListboxItemInactiveInnerBorder}" />
                                        <Setter TargetName="InnerBorder" Property="Background"
                                Value="{StaticResource ListboxItemInactiveBackground}" />
                                    </MultiTrigger>

                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style> 
```

将此样式应用于 ListView 的 ItemContainerStyle 属性后，ListView 如下所示： [2 http://www.nickthissen.nl/Images/Persistent/tmpCCB2.png](http://www.nickthissen.nl/Images/Persistent/tmpCCB2.png)

如您所见，颜色现在好多了，但它完全失去了它的 GridView 显示样式，而是完全忽略了列，只是插入了对象的 ToString 表示（我没有覆盖它，所以它返回了完整的类型名称）。

我不明白为什么会发生这种情况，除了删除 ItemContainerStyle 之外，我没有做任何事情来摆脱它。我的风格一定有问题，但我找不到问题...

谁能看到我做错了什么以及如何恢复我的 GridView 样式？谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-07T11:08:00.103

尝试将您样式中的 Content Presenter 更改为 GridViewRowPresenter

```
<Border x:Name="Border" CornerRadius="3" BorderThickness="1" SnapsToDevicePixels="True">
    <Border x:Name="InnerBorder" CornerRadius="2" BorderBrush="Transparent" Background="Transparent"
            BorderThickness="1" Padding="3,1" SnapsToDevicePixels="True">
        <GridViewRowPresenter />
    </Border>
</Border> 
```

# php - 回声$变量。“word”（只返回 $Variable，而不是“word”）-TERNARY 运算符

> ID：10922114
> 
> 赞同：1
> 
> 时间：2012-06-06T20:53:01.767
> 
> 标签：php, variables, ternary-operator

可能是我在这里遗漏了一些非常明显的东西吗？

它是如何`print ucwords(strtolower($keycode)) . " Preview Page"`只返回`$keycode`as 标题，而不是应该存在的尾随“**预览页面**”？

```
<?php
$title = ((isset($keycode)) ? print ucwords(strtolower($keycode)) . " Preview Page" : print "Home Page"); ?>

<title><?php echo $title; ?></title> 
```

我什至尝试过`print ucwords(strtolower($keycode . ' Preview Page'))`在那里工作，但这并没有改变任何东西。它似乎只看到变量......

有人知道如何让它工作吗？**:o)**请帮忙？感谢您的时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T21:08:32.937

问题是你正在回显调用的结果，我认为`print`这只是一个`int`......无论如何，`print`两者`echo`都有输出字符串的效果。您只需要丢失`print`s 即可：

```
$title = ((isset($keycode)) ? ucwords(strtolower($keycode)) . " Preview Page" : "Home Page"); ?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T20:54:00.987

您错误地使用了运算符。第一个表达式的结果决定了是表达式 1 还是表达式 2 返回给它传递给的变量或函数。

```
print (isset($keycode)) ? ucwords(strtolower($keycode)) . " Preview Page" : "Home Page"; 
```

# facebook - Facebook Open Graph 操作可选参数

> ID：10922118
> 
> 赞同：0
> 
> 时间：2012-06-06T20:53:16.690
> 
> 标签：facebook, facebook-opengraph

我有一个开放图形操作，它需要一个必需的参考参数和一个可选的参考参数。我的问题是关于当可选参数不存在时如何定义标题。
因此，例如，如果我的操作是关于获得可以与特定事件相关联或不相关联的徽章，例如：

```
[User:Raul] has just [Verb:earned] the [Badge:Gold] badge for the [Event:400 meter dash] 
```

但也可能是：

```
[User:Raul] has just [Verb:earned] the [Badge:Overall 1st Place] badge 
```

有没有办法完成将标题设置为此？那么我们应该如何处理可选参数呢？
我的经验是，如果我将任何标题行设置为包含可选参数并且它不存在，那么 Facebook 将为该事件使用通用标题。

# ruby-on-rails - Rails 3.2.1 `bundle install --path vendor` 等效

> ID：10922119
> 
> 赞同：0
> 
> 时间：2012-06-06T20:53:19.157
> 
> 标签：ruby-on-rails, ruby-on-rails-3, bundler

Rails 3.2.1 中的命令`bundle install --path lib`是否等同`bundle install --path vendor`于以前的 rails 版本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T01:04:20.843

有点老问题，但这不是`bundle install --deployment`为了什么吗？

# console - OrientDB GraphED - 可以自定义记录标识符吗？搜索 150 万条记录非常慢

> ID：10922120
> 
> 赞同：3
> 
> 时间：2012-06-06T20:53:19.990
> 
> 标签：console, bigdata, orientdb, gremlin

> Orient 版本：官方分发 OrientDB Graph Edition 1.0.1

我正在尝试使用 OrientDB SQL 插入构建蓝图兼容图（比 g.addVertex 快并且没有 OutOfMemory 错误）。

创建 150 万条记录时，通过控制台（批处理）插入的时间比预期的要长（四核 i7 上为 13 分钟），并且通过“名称”字段搜索非常慢（2 分钟）。

出于测试目的，我们有一个非常简单的导入 sql 文件，它尝试创建与两个设置参数 name:account_id 和 type:account_type 以及空输入/输出数组兼容的蓝图顶点。

进口.ornt：

```
connect local:/graph1/databases/dbdemo admin admin;
drop database;
create database local:/graph1/databases/dbdemo admin admin local graph;
insert into V (name,type,in,out) values ("1111111","player",[],[]);
...
disconnect; 
```

**注意**：最好能够将记录标识符设置为我们预先存在的 account_id。但我不确定如何尝试这个。

上面的 sql 最终约为 100MB，我通过控制台运行它（console.sh 包括优化`-Dmvrbtree.optimizeThreshold=-1`）：

```
:$ ./console.sh import.ornt 
OrientDB console v.1.0.1 (build @BUILD@) www.orientechnologies.com
Type 'help' to display all the commands supported.

Installing extensions for GREMLIN language v.2.0.0-SNAPSHOT
Connecting to database [local:/graph1/databases/dbdemo] with user 'admin'...OK

Database 'dbdemo' deleted successfully
Creating database [local:/graph1/databases/dbdemo] using the storage type [local]...
Database created successfully.

Current database is: local:/graph1/databases/dbdemo

Inserted record 'V#6:0{name:11111111,type:player,in:[0],out:[0]} v0' in 0.002000 sec(s).
...
Disconnecting from the database [dbdemo]...OK 
```

在这一点上，我们有了基本的 OrientDB 图形，其中 OGraphVertex 类大约有 150 万个顶点。

```
orientdb> classes 

CLASSES:
----------------------------------------------+---------------------+-----------+
 NAME                                         | CLUSTERS            | RECORDS   |
----------------------------------------------+---------------------+-----------+
 ORIDs                                        | 5                   |         0 |
 OGraphEdge                                   | 7                   |         0 |
 OUser                                        | 4                   |         3 |
 ORole                                        | 3                   |         3 |
 OGraphVertex                                 | 6                   |   1524528 |
----------------------------------------------+---------------------+-----------+
 TOTAL                                                                  1524534 |
--------------------------------------------------------------------------------+ 
```

使用控制台，通过 Orient SQL 或 Gremlin/Pipes 进行选择需要很长时间：

```
orientdb> gremlin g.V.has('name','1149400');                      

v[#6:617363]

Script executed in 129.809006 sec(s).
> select from OGraphVertex where name like '1149400';

---+---------+--------------------+--------------------+--------------------+--------------------
  #| RID     |name                |type                |in                  |out                 
---+---------+--------------------+--------------------+--------------------+--------------------
  0|#6:617363|1149400             |player              |[0]                 |[0]                 
---+---------+--------------------+--------------------+--------------------+--------------------

1 item(s) found. Query executed in 112.531 sec(s).

orientdb> 
```

使用 OrientDB SQL 或 Gremlin 大约需要 2 分钟！

作为一种潜在的解决方法，最好将记录标识符设置为来自 MySQL 数据库源的原始帐户 ID。是否可以有自定义记录 ID？

例如，由于我们会在开始遍历时知道 account_id（例如 1149400），所以理想的情况是：

```
orientdb> gremlin g.v('#6:1149400').map

{name=1149400, type=player}

Script executed in 0.054000 sec(s). 
```

**0.054000 比 112.531 快很多！！**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T22:12:02.067

OrientDB RecordId 无法更改，但您可以针对 V.name 属性创建索引。例子：

> 创建索引 OGraphVertex.name 非唯一

甚至：

> CREATE INDEX V_name ON OGraphVertex (name) notunique;

有关更多信息，请查看：[OrientDB 索引](http://code.google.com/p/orient/wiki/Indexes)

# javascript - 在匿名函数中更改 $(this) 上下文

> ID：10922121
> 
> 赞同：4
> 
> 时间：2012-06-06T20:53:20.783
> 
> 标签：javascript, jquery, proxy

这是我用来在移动设备上绑定“点击”事件的功能。基本上是一个正常的功能。

```
bindTapEvent: function(container, selector, run, bindClickAlso){
    var startX, startY, currentX, currentY = 0;
    var moved = false;
    var self;

    if(touchDevice){
        container.on({
            click: function(e){
                e.preventDefault();
            },
            touchstart: function(e){
                e.preventDefault();
                self = $(this);
                startX = e.originalEvent.touches[0].pageX;
                startY = e.originalEvent.touches[0].pageY;
            },
            touchmove: function(e){
                currentX = e.originalEvent.touches[0].pageX;
                currentY = e.originalEvent.touches[0].pageY;
                if(Math.abs(startX - currentX) > 10 || Math.abs(startY - currentY) > 10){
                    moved = true;
                }
            },
            touchend: function(e){
                e.preventDefault();
                run();
            }
        }, 
        selector
        )
    } else {
        if(bindClickAlso != false){
            container.on('click', selector, function(){
                run();
            });
        }
    }
} 
```

我这样使用它：

```
tt.bindTapEvent(container, '.showColumns', function(){
    container.find('.column').addClass('visible');
    $(this).doSomething();
}); 
```

唯一的问题是我不能（显然）在这样的事情中使用 $(this) 。我已经阅读了有关更改上下文的 jQuery $.proxy 的信息，但我无法理解它，因此我可以使用它。是否有可能（在我的情况下）将 tt.bindTapEvent 中使用的匿名函数的上下文更改为当我使用 $(this) 时它仅在 bindTapEvent 函数中“存储”和“使用”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T21:02:25.563

看一下 .call() 和 .apply() ，它们可以让您将所需的上下文作为第一个参数传递。

[http://odetocode.com/blogs/scott/archive/2007/07/05/function-apply-and-function-call-in-javascript.aspx](http://odetocode.com/blogs/scott/archive/2007/07/05/function-apply-and-function-call-in-javascript.aspx)

所以在你的例子中，`run()`你可以使用`run.call(this);`所以你将 this 作为回调函数的上下文传递。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T21:02:42.950

有一个由 ES5 标准定义的绑定函数，所有现代浏览器都支持（IE8 及更低版本的*shimmable ）*

你在你选择的函数上调用 bind ，一个新的函数将被返回。

传递给的第一个参数`bind`是您希望`this`在结果函数内部设置的对象，随后的参数将被柯里化。因此，对于您的情况，只需添加`.bind(this)`到匿名函数即可。

```
tt.bindTapEvent(container, '.showColumns', function(){
    container.find('.column').addClass('visible');
    $(this).doSomething(); //should work now
}.bind(this)); 
```

[有关 MDN 的更多信息](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/bind?action=edit)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T21:02:51.177

如果你知道这个[`this`问题](https://developer.mozilla.org/en/JavaScript/Reference/Operators/this)，我希望你也知道[.call](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/call)和[.apply](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/apply)方法:-)

您需要`run`在容器的上下文中调用 -function，分别`this`在侦听器函数中：

```
e.preventDefault();
run.call(this, e); 
```

顺便说一句：您似乎声明并初始化了`var self`，但无处使用它？

# html - openxml/worprocessingml 中固定高度的 div 或 table 的等价物是什么

> ID：10922122
> 
> 赞同：0
> 
> 时间：2012-06-06T20:53:25.320
> 
> 标签：html, openxml, tabular, wordprocessingml

我想在 div 元素中包含一个表格，这样无论我的表格有多少行，我的文档总是以相同的方式构造。

我怎样才能做到这一点？

第二种解决方案是直接在桌子上定义一个固定的高度，但我不知道怎么做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T22:14:19.140

您可以轻松设置行高。下面我将第一行设置为至少 0.25"，第二行设置为 0.25"

```
<w:tr w:rsidR="00F11384" w:rsidTr="00F11384">
    <w:trPr>
        <w:trHeight w:hRule="exact" w:val="360"/>
    </w:trPr>

...

<w:tr w:rsidR="00F11384" w:rsidTr="00F11384">
    <w:trPr>
        <w:trHeight w:val="360"/>
    </w:trPr> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T21:18:41.930

要设置表格的高度，您需要设置每个表格行的高度，否则，它将自动适应内容。

下面是 C# 示例代码：

```
Table newTable = new Table(
                           new TableRow(
                                new TableRowProperties(
                                     new TableRowHeight() { Val = (UInt32Value) x}), 
                                new TableCell())); 
```

x 对应于 dxa 点的高度。在 72DPI 的 1080p 显示器上，一英寸相当于大约 1440 dxa 点。

关于 OpenXML 大小调整的文章：http: [//startbigthinksmall.wordpress.com/2010/01/04/points-inches-and-emus-measuring-units-in-office-open-xml/](http://startbigthinksmall.wordpress.com/2010/01/04/points-inches-and-emus-measuring-units-in-office-open-xml/)

# perl - 使用 perl WWW::Mechanize 处理 404 和内部服务器错误

> ID：10922123
> 
> 赞同：4
> 
> 时间：2012-06-06T20:53:27.053
> 
> 标签：perl, http-status-code-404, www-mechanize

我正在使用 WWW::Mechanize 来抓取网站，它工作得很好，除了有时它会点击返回错误代码 404 或 500（未找到或内部服务器错误）的页面，然后我的脚本将退出并停止运行。这真的把我的数据收集弄乱了，所以无论如何 WWW::Mechanize 会让我捕捉这些错误并查看返回了什么样的错误代码（即 404,500 等）。谢谢您的帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-06T21:10:18.010

您需要禁用自动检查：

```
my $mech = WWW::Mechanize->new( autocheck => 0 );

$mech->get("http://somedomain.com");

if ( $mech->success() ) {
    ...
}
else {
    print "status is: " . $mech->status;
} 
```

另外，顺便说一下，看看[WWW::Mechanize::Cached::GZip](https://metacpan.org/module/WWW%3a%3aMechanize%3a%3aCached%3a%3aGZip)和[WWW::Mechanize::Cached](https://metacpan.org/module/WWW%3a%3aMechanize%3a%3aCached)以在测试你的机械脚本时加快你的开发速度。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-06T21:33:53.830

关闭`autocheck`并手动检查`status()`，它会返回响应的 HTTP 状态码。

这是一个 3 位数字，例如**200**表示**OK**，**404**表示**Not Found**，依此类推。

```
use strict;
use warnings;
use WWW::Mechanize;

my $url = 'http://...';
my $mech = WWW::Mechanize->new(autocheck => 0);
$mech->get($url);

print $mech->status(); 
```

有关*状态代码定义*，请参见[http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)。

 *如果状态码是**400 或以上**，那么你得到**错误**...*

# sql - 如何选择此时 4 天前的日期？

> ID：10922124
> 
> 赞同：5
> 
> 时间：2012-06-06T20:53:27.240
> 
> 标签：sql, oracle, date, timestamp

我需要查询以获取 a`timestamp`正好在 4 天前之后的行。

例如，如果我在 2012 年 6 月 6 日下午 1 点运行查询，它应该选择日期在 2012 年 6 月 2 日下午 1 点之后的行。我该怎么做？

```
SELECT * FROM mytable WHERE created_at < /* 4 days ago this time */; 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-06T20:56:39.917

信不信由你，这非常容易。

```
SELECT * FROM mytable WHERE created_at > sysdate - 4 
```

# php - 使用 cookie PHP 跟踪访问者

> ID：10922126
> 
> 赞同：-6
> 
> 时间：2012-06-06T20:53:29.320
> 
> 标签：php, cookies

场景如下：用户登陆我的网站并获取 cookie，并连同其他参数（推荐人、page_id、IP 地址、登陆时间等）一起保存到数据库中。如果同一访问者正在访问与登录页面不同的另一个页面，则应更新所有这些信息。哪些 PHP 函数可以让我以优雅的方式处理这项任务？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T20:58:58.253

1.  [设置cookie（）](http://us.php.net/manual/en/function.setcookie.php)
2.  [$_COOKIE[]](http://us.php.net/manual/en/reserved.variables.cookies.php)

除非您另行指定，否则所有 cookie 都可用于同一域中的每个页面。

**编辑**：看起来你想使用[$_SERVER](http://us.php.net/manual/en/reserved.variables.server.php)魔法变量。

# mysql - R中指向数据库的指针变量

> ID：10922128
> 
> 赞同：2
> 
> 时间：2012-06-06T20:53:35.463
> 
> 标签：mysql, sql, r

有什么方法可以在 R 中创建类似于 data.frame 对象的东西，它会指向 MySQL 数据库中的特定表并且行为类似于 data.frame？我找不到任何关于它的提及。

举个例子，让我们说，我有一个名为客户和列名称、高度、重量的表，我想要一些函数，它会创建变量客户，我可以以类似 data.frame 的方式访问相应的列，即客户$高度等

我的问题是我正在处理非常大的数据集并且对数据库的操作要快得多，并且实际上可能会破解 SQL 中的一些描述性统计信息以与此类指针变量一起使用，例如 sum、average 等...

感谢您的回答。T。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-06T21:10:14.387

是的，外部指针可以做到这一点，并且 RODBC 包使用它。有关外部指针的介绍，请参阅“编写 R 扩展”手册。

ff、bigmemory 和 mmap 包可能会为您提供有关如何使外部数据显示在 R 内部的想法。可以做到，但对于一个下雨的下午来说，这不是一个快速破解。

通常，最好在“数据附近”进行尽可能多的计算。如果你使用 PostgreSQL，你可以尝试它的嵌入式 Pl/R 扩展。据我所知，MySQL 不存在这样的扩展。

# python - M2Crypto https 通过具有 cac 卡身份验证的 Web 代理获取错误

> ID：10922133
> 
> 赞同：0
> 
> 时间：2012-06-06T20:53:44.397
> 
> 标签：python, https, proxy, m2crypto, cac

我正在尝试从具有 cac 卡身份验证的 squid 代理后面发出 https 获取请求。加载 opensc 引擎并获取证书和私钥似乎工作正常。下面是回溯和代码。

任何帮助是极大的赞赏。

追溯

```
Traceback (most recent call last):
File "testM2Crypto.py", line 64, in <module>
res = m2urllib2.urlopen(req)
File "c:\Python27\lib\urllib2.py", line 135, in urlopen
return _opener.open(url, data, timeout)
File "c:\Python27\lib\urllib2.py", line 415, in open
response = self._open(req, data)
File "c:\Python27\lib\urllib2.py", line 433, in _open
'_open', req)
File "c:\Python27\lib\urllib2.py", line 387, in _call_chain
result = func(*args)
File "c:\Python27\lib\site-packages\M2Crypto\m2urllib2.py", line 94, in https_open
h.request(req.get_method(), req.get_selector(), req.data, headers)
File "c:\Python27\lib\httplib.py", line 963, in request
self._send_request(method, url, body, headers)
File "c:\Python27\lib\httplib.py", line 994, in _send_request
self.putrequest(method, url, **skips)
File "c:\Python27\lib\site-packages\M2Crypto\httpslib.py", line 140, in putrequest
raise ValueError, "unknown URL type: %s" % url
ValueError: unknown URL type: /index.asp?site=SomeSite 
```

代码

```
from M2Crypto import httpslib, m2urllib2, m2, SSL, Engine
import urllib2

url = 'https://some.domain.com/index.asp?site=SomeSite'

e = Engine.load_dynamic_engine("pkcs11", "c:/windows/syswow64/engine_pkcs11.dll")
pk = Engine.Engine("pkcs11")
pk.ctrl_cmd_string("MODULE_PATH", "c:/windows/syswow64/opensc-pkcs11.dll")
m2.engine_init(m2.engine_by_id("pkcs11"))

cert = e.load_certificate("slot_01-id_01")
privatekey = e.load_private_key("slot_01-id_01")

ctx = SSL.Context("sslv23")
ctx.set_cipher_list("HIGH:!aNULL:!eNULL:@STRENGTH")
ctx.set_session_id_ctx("foobar")
m2.ssl_ctx_use_x509(ctx.ctx, cert.x509)
m2.ssl_ctx_use_pkey_privkey(ctx.ctx, privatekey.pkey)

proxy_support=urllib2.ProxyHandler({'https':'https://proxy:3128'})
opener = m2urllib2.build_opener(ctx, proxy_support)
m2urllib2.install_opener(opener)
req = m2urllib2.Request(url)
res = m2urllib2.urlopen(req) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T15:41:22.710

我终于能够解决昨天的问题。我不得不对代码进行一些修改。我还必须修补 M2Crypto 库中的一个错误，该错误阻止通过代理访问 https（感谢 redhat 的 Miloslav Trmač 提供补丁）。下面的解决方案适用于可能遇到类似问题的其他任何人。希望这可以帮助。

代码

```
from M2Crypto import httpslib, m2urllib2, m2, SSL, Engine
import urllib2

userPin = "123456"
rootCertPath = 'd:/path/to/rootCert.pem'
url = 'https://some.domain.com/index.asp?site=SomeSite'

e = Engine.load_dynamic_engine("pkcs11", "c:/windows/syswow64/engine_pkcs11.dll")
pk = Engine.Engine("pkcs11")
pk.ctrl_cmd_string("MODULE_PATH", "c:/windows/syswow64/opensc-pkcs11.dll")
if len(userPin) > 0: pk.ctrl_cmd_string("PIN", userPin)

m2.engine_init(m2.engine_by_id("pkcs11"))

rootcert = X509.load_cert(rootCertPath)
cert = e.load_certificate("slot_01-id_01")
privatekey = e.load_private_key("slot_01-id_01")

ctx = SSL.Context("sslv23")
ctx.set_cipher_list("HIGH:!aNULL:!eNULL:@STRENGTH")
ctx.set_session_id_ctx("foobar")
ctx.load_verify_locations(cafile=rootcert)
m2.ssl_ctx_use_x509(ctx.ctx, cert.x509)
m2.ssl_ctx_use_pkey_privkey(ctx.ctx, privatekey.pkey)

proxy_support=urllib2.ProxyHandler({'https':'https://proxy:3128'})
opener = m2urllib2.build_opener(ctx, proxy_support)
m2urllib2.install_opener(opener)
req = m2urllib2.Request(url)
try:
    res = m2urllib2.urlopen(req)
    print '\nsuccess'
except urllib2.HTTPError, err:
    print '\nerror'
    print 'err.code: '+str(err.code)
    print 'err.reason: '+str(err.reason)
    print 'err.read(): '+str(err.read()) 
```

感谢 redhat 的 Miloslav Trmač 提供补丁。我在以下网址找到了这个补丁，[http://arm.koji.fedoraproject.org/koji/buildinfo?buildID=61225](http://arm.koji.fedoraproject.org/koji/buildinfo?buildID=61225)。

M2Crypto 补丁

```
diff -urN M2Crypto/M2Crypto/httpslib.py M2Crypto-0.21.1/M2Crypto/httpslib.py
--- M2Crypto/M2Crypto/httpslib.py   2012-03-15 03:27:22.181524406 +0100
+++ M2Crypto-0.21.1/M2Crypto/httpslib.py    2012-03-15 03:27:40.467485033 +0100
@@ -182,14 +182,14 @@
         else:
             HTTPSConnection.putheader(self, header, value)

-    def endheaders(self):
+    def endheaders(self, *args, **kwargs):
         # We've recieved all of hte headers. Use the supplied username
         # and password for authorization, possibly overriding the authstring
         # supplied in the headers.
         if not self._proxy_auth:
             self._proxy_auth = self._encode_auth()

-        HTTPSConnection.endheaders(self)
+        HTTPSConnection.endheaders(self, *args, **kwargs)

     def connect(self):
         HTTPConnection.connect(self)
diff -urN M2Crypto/M2Crypto/m2urllib2.py M2Crypto-0.21.1/M2Crypto/m2urllib2.py
--- M2Crypto/M2Crypto/m2urllib2.py  2011-01-15 20:10:05.000000000 +0100
+++ M2Crypto-0.21.1/M2Crypto/m2urllib2.py   2012-03-15 03:27:40.467485033 +0100
@@ -64,8 +64,10 @@
         target_host = urlparse.urlparse(full_url)[1]

         if (target_host != host):
+            request_uri = urlparse.urldefrag(full_url)[0]
             h = httpslib.ProxyHTTPSConnection(host = host, ssl_context = self.ctx)
         else:
+            request_uri = req.get_selector()
             h = httpslib.HTTPSConnection(host = host, ssl_context = self.ctx)
         # End our change
         h.set_debuglevel(self._debuglevel)
@@ -80,7 +82,7 @@
         # request.
         headers["Connection"] = "close"
         try:
-            h.request(req.get_method(), req.get_selector(), req.data, headers)
+            h.request(req.get_method(), request_uri, req.data, headers)
             r = h.getresponse()
         except socket.error, err: # XXX what error?
             raise URLError(err) 
```

# python - 带有密钥和用户名/密码的 Paramiko SFTP -“糟糕，未处理的类型 3”

> ID：10922134
> 
> 赞同：9
> 
> 时间：2012-06-06T20:53:55.467
> 
> 标签：python, authentication, sftp, paramiko

我正在尝试通过 SFTP 从 Python 连接到远程服务器（使用 Paramiko）以自动检索文件。

系统版本： 操作系统：Mac OS X Lion Python：2.7.1 Paramiko：1.7.7.2

我最小的例子：

```
key_file = '/absolute/path/to/.ssh/id_rsa_key'  # NOT .pub
key_passphrase = 'id_rsa_key_passphrase'

host = 'ftp.test.com'
port = 22
username = 'my_ftp_username'
password = 'my_ftp_password'

# SSH Key
my_key = paramiko.RSAKey.from_private_key_file(key_file, password=key_passphrase)

# SFTP Connection
transport = paramiko.Transport((host, port))
transport.connect(username=username, password=password, pkey=my_key)
sftp = paramiko.SFTPClient.from_transport(transport)

# Print something
print sftp.listdir()

# Close connections
sftp.close()
transport.close() 
```

以上生成以下日志输出：

```
DEB [20120606-16:20:46.121] thr=1   paramiko.transport: starting thread (client mode): 0x8ae7dd0L
INF [20120606-16:20:46.241] thr=1   paramiko.transport: Connected (version 2.0, client All)
DEB [20120606-16:20:46.242] thr=1   paramiko.transport: kex algos:['diffie-hellman-group1-sha1', 'diffie-hellman-group-exchange-sha1'] server key:['ssh-rsa'] client encrypt:['aes256-cbc', 'aes192-cbc'] server encrypt:['aes256-cbc', 'aes192-cbc'] client mac:['hmac-sha1', 'hmac-sha1-96'] server mac:['hmac-sha1', 'hmac-sha1-96'] client compress:['none'] server compress:['none'] client lang:[''] server lang:[''] kex follows?False
DEB [20120606-16:20:46.242] thr=1   paramiko.transport: Ciphers agreed: local=aes256-cbc, remote=aes256-cbc
DEB [20120606-16:20:46.242] thr=1   paramiko.transport: using kex diffie-hellman-group1-sha1; server key type ssh-rsa; cipher: local aes256-cbc, remote aes256-cbc; mac: local hmac-sha1, remote hmac-sha1; compression: local none, remote none
DEB [20120606-16:20:46.673] thr=1   paramiko.transport: Switch to new keys ...
DEB [20120606-16:20:46.706] thr=2   paramiko.transport: Attempting password auth...
DEB [20120606-16:20:47.112] thr=1   paramiko.transport: userauth is OK
INF [20120606-16:20:50.288] thr=1   paramiko.transport: Authentication continues...
DEB [20120606-16:20:50.288] thr=1   paramiko.transport: Methods: ['password', 'publickey']
DEB [20120606-16:20:50.305] thr=2   paramiko.transport: [chan 1] Max packet in: 34816 bytes
WAR [20120606-16:20:50.405] thr=1   paramiko.transport: Oops, unhandled type 3
INF [20120606-16:23:53.582] thr=1   paramiko.transport: Disconnect (code 11): Idle connection 
```

有谁知道日志中的“糟糕，未处理的类型 3”是什么意思？那似乎是整个事情崩溃的时候。或者，如果有人看到我在代码中做的非常错误的事情，那也会有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2018-04-12T23:45:45.193

我意识到这个问题已经有将近 4 年的历史了，但是我遇到了同样的问题并找到了一个可行的解决方案！

参考文档：[http ://docs.paramiko.org/en/2.4/api/transport.html](http://docs.paramiko.org/en/2.4/api/transport.html)

在文档中，根据`connect()`它提到的方法：

> 这是 start_client、get_remote_server_key 和 Transport.auth_password 或 Transport.auth_publickey 的快捷方式。

因此，如果您需要进行多因素身份验证，您根本无法使用`connect()`，您必须使用上述方法手动协商并触发两个身份验证，在密码身份验证之前先使用密钥身份验证。

下面的代码片段对我有用！

```
host = "some-host"
port = 22
sftp_key = "/some-key"
username = "some-user"
password = "some-pass"

sftp_key = paramiko.RSAKey.from_private_key_file(sftp_key)
transport = paramiko.Transport((host, port))
transport.start_client(event=None, timeout=15)
transport.get_remote_server_key()
transport.auth_publickey(username, sftp_key, event=None)
transport.auth_password(username, password, event=None)
sftp = paramiko.SFTPClient.from_transport(transport) 
```

并将整个事情包装在一个函数中，以处理几乎任何你可以扔给它的 SFTP 服务器。我的错误处理被省略了，因为它在这里没有意义......

```
#Auth types: user_pass, key_only, key_and_pass
#You can pass a junk string in for password or sftp_key if not used
def connect_to_sftp(host, port, username, password, sftp_key, auth_type):
    try:
        transport = paramiko.Transport((host, port))
        if auth_type == "key_and_pass":
            sftp_key = paramiko.RSAKey.from_private_key_file(sftp_key)
            transport.start_client(event=None, timeout=15)
            transport.get_remote_server_key()
            transport.auth_publickey(username, sftp_key, event=None)
            transport.auth_password(username, password, event=None)
            #transport.connect(username = username, password = password, pkey = sftp_key)
        elif auth_type == "key_only":
            sftp_key = paramiko.RSAKey.from_private_key_file(sftp_key)
            transport.connect(username = username, pkey = sftp_key)
        elif auth_type == "user_pass":
            transport.connect(username = username, password = password)
        else:
            ## Do your own error handling :)
            print "uh-oh!"
        sftp = paramiko.SFTPClient.from_transport(transport)   
    except Exception, e:
        ## Do your own error handling :)
        print "uh-oh!"
    return sftp, transport 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T21:01:29.067

您正在对服务器使用密码和密钥身份验证，这看起来像是冲突。尝试使用[Transport.auth_publickey](http://www.lag.net/paramiko/docs/paramiko.Transport-class.html#auth_publickey)方法进行连接。如果失败，文档会说使用该`transport.get_exception`功能来收集更多详细信息。

**编辑：**

据此[，](http://docs.ipswitch.com/WS_FTP_Server751/Help/multifactor_authentication.htm)多因素身份验证意味着同时使用密码*和*密钥。所以，你应该可以使用该`auth_publickey`函数，然后通过[auth_password](http://www.lag.net/paramiko/docs/paramiko.Transport-class.html#auth_password)方法进入。

或者，如果您有足够的访问权限，您可以将 ftp 设置调整为只需要密钥身份验证。

您是否尝试过使用 ftp 客户端（例如[filezilla](http://filezilla-project.org/) ）登录？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-12-16T06:05:15.127

Big Sam 在一个 for 循环中打开了许多连接并且从未关闭连接后最终遇到了这个错误。

确切的错误信息是`Oops, unhandled type 3 ('unimplemented')`

如果您有以下情况，您应该始终确保：

```
client.connect(...) 
```

你还有：

```
client.close() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-07-27T16:52:14.690

问题来自您使用 rsa 密钥格式 (key_file = '/absolute/path/to/.ssh/id_rsa_key')。

确保使用 putty 密钥生成器将其转换为 SSH RSA。我做了并使用了相同的代码：它正在工作。

# fish - fish 在采购时在 .config/fish/config.fish 中运行一些功能

> ID：10922142
> 
> 赞同：0
> 
> 时间：2012-06-06T20:54:35.810
> 
> 标签：fish

我正在尝试鱼壳，当我打开一个新的鱼选项卡时，它似乎运行了我在它的配置文件中定义的*一些功能。*例如，如果我有这个功能：

```
function foo
cd ~/
end 
```

鱼将进入无限循环，因为它不断`cd`进入我的用户目录并获取文件。但如果我有这个：

```
function foo
ls
end 
```

鱼不会向我显示`ls`. 到底是怎么回事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T12:23:41.603

您可能已经定义`foo`为一个函数，它以某种方式创建了一个无限循环。尝试这个

```
function foo
    command ls
end 
```

# exception - FSharpTypeFunc.Specialize 导致 TypeLoadException

> ID：10922143
> 
> 赞同：4
> 
> 时间：2012-06-06T20:54:40.270
> 
> 标签：exception, f#

我收到以下运行时异常：

> System.TypeLoadException 未处理
> Message=Method 'Specialize' on type [...] 试图隐式覆盖具有较弱类型参数约束的方法。

这个内部函数似乎是问题所在：

```
let getKey (r: IDictionary<_,_>) = 
  match r.TryGetValue(keyCol.Name) with
  | true, k when not (isNull k) -> Some k
  | _ -> None 
```

签名是`IDictionary<string,'a> -> 'a option (requires 'a : null)`。约束从 传播`isNull`。

在 ILSpy 中查找，被编译为覆盖`getKey`的子类型。`FSharpTypeFunc``Specialize<T>()`

这是一个错误吗？`k`我可以通过在对 的调用中装箱来解决它`isNull`，这消除了约束。

### 编辑

这是一个完整的复制品：

```
open System.Collections.Generic

let isNull = function null -> true | _ -> false
type KeyCol = { Name : string }

let test() =
  seq {
    let keyCol = { Name = "" }
    let getKey (r: IDictionary<_,_>) = 
      match r.TryGetValue(keyCol.Name) with
      | true, k when not (isNull k) -> Some k
      | _ -> None
    getKey (dict ["", box 1])
  }

test() |> Seq.length |> printfn "%d" 
```

这是 Visual Studio 2008 中的控制台应用程序，面向 .NET 4.0。奇怪的是，该代码在 FSI 中有效。

这是程序集的 PEVerify 输出：

> [令牌 0x02000004] 类型加载失败。
> [IL]：错误：[D:\TEST\bin\Debug\TEST.exe : Test+test@10[a]::GenerateNext] [mdToken=0x6000012][offset 0x00000031] 无法解析令牌。
> 2 验证 D:\TEST\bin\Debug\TEST.exe 的错误

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T20:58:26.333

将其发送给 fsbugs 并收到已修复的回复。

# python - 正则表达式 python 优化或文本高亮的想法

> ID：10922149
> 
> 赞同：0
> 
> 时间：2012-06-06T20:55:09.017
> 
> 标签：python, regex, optimization

我有以下正则表达式，我需要一些关于它的建议。我需要建议如何在不更改单词形式的情况下突出显示文本（大写以保持大写）。我有一个我喜欢强调的单词列表，所以我得到了以下内容：

```
 def tagText(self,listSearch,docText):  
    docText=docText.decode('utf-8') 

    for value in listSearch: 
       replace = re.compile(ur""+value+"",  flags=re.IGNORECASE | re.UNICODE)  
       docText = replace.sub(u"""<b style="color:red">"""+value+"""</b>""", docText,  re.IGNORECASE | re.UNICODE)

    return docText 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T21:03:15.390

您需要在替换字符串中使用占位符，而不是文字值。

```
def tag_text(self, items, text):
    text = text.decode('utf-8') 
    for item in items: 
        text = re.sub(
            re.escape(item), 
            ur'<b style="color:red">\g<0></b>', 
            text,
            flags=re.IGNORECASE | re.UNICODE)
    return text

print tag_text(None, ["foo", "bar"], "text with Foo and BAR")
# text with <b style="color:red">Foo</b> and <b style="color:red">BAR</b> 
```

（我还稍微清理了你的函数，让它看起来更“pythonic”）。

# mysql - WHERE OR AND 多次使用 MYSQL

> ID：10922150
> 
> 赞同：0
> 
> 时间：2012-06-06T20:55:11.213
> 
> 标签：mysql, where

该死的对我的 MYSQL 查询的语法感到困惑。

这是正确的吗？在互联网上找不到类似的条目。

```
$query_game_string = '';

while($game = mysql_fetch_assoc($get_game_list)){
    $query_game_string .= ' OR target = "' . $game['id'] . '" AND ancestors = "0"';   
}

echo '' . $query_game_string . '';  

//prints: OR target = "11" AND ancestors = "0" OR target = "12" AND ancestors = "0" OR target = "27" AND ancestors = "0" OR target = "29" AND ancestors = "0" OR target = "32" AND ancestors = "0"

        $database->connect(); 

            $comments = mysql_query(
                'SELECT * 
                    FROM ' . $database->db_prefix . 'comments 
                        WHERE user_id = "' . $user->user_object["id"] . '"' .
                        $query_game_string . '                                    
                        ORDER BY created DESC'
            , $database->connection_handle);                     

        $database->close(); 
```

所以实际的查询总共是：

```
'SELECT * 
    FROM ' . $database->db_prefix . 'comments 
        WHERE user_id = "' . $user->user_object["id"] . '"' .
        'OR target = "11" AND ancestors = "0" OR target = "12" AND ancestors = "0" OR target = "27" AND ancestors = "0" OR target = "29" AND ancestors = "0" OR target = "32" AND ancestors = "0"' . '                                    
        ORDER BY created DESC' 
```

语法好吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T20:59:18.927

不知道你在找什么，但可能你需要括号：

```
OR (target = "11" AND ancestors = "0")
OR (target = "12" AND ancestors = "0")
OR (target = "27" AND ancestors = "0")
OR (target = "29" AND ancestors = "0")
OR (target = "32" AND ancestors = "0") 
```

php 来实现：

```
while($game = mysql_fetch_assoc($get_game_list))
{
    $query_game_string .= ' OR (target = "' . $game['id'] . '" AND ancestors = "0")';   
} 
```

一种简化查询的方法是使用`IN`操作数

```
 OR target IN("11","12","27","29","32") AND ancestors = "0" 
```

php:

```
$targets = array();
while($game = mysql_fetch_assoc($get_game_list))
{
    $targets[] = '"'.$game['id'].'"';   
}
$query_game_string = ' OR target IN (' . implode(",",$targets) . ') AND ancestors = "0"'; 
```

# ruby - irb 不加载我创建的 gem

> ID：10922155
> 
> 赞同：2
> 
> 时间：2012-06-06T20:55:37.057
> 
> 标签：ruby, gem, jruby, irb

我正在使用`jruby`模式`1.9`。

```
➜  nittresults git:(master) ✗ ruby -v
jruby 1.6.7.2 (ruby-1.9.2-p312) (2012-05-01 26e08ba) (Java HotSpot(TM) 64-Bit Server VM 1.6.0_24) [darwin-x86_64-java]
➜  nittresults git:(master) ✗ which gem
gem: aliased to jruby --1.9 -S gem
➜  nittresults git:(master) ✗ which irb
irb: aliased to jruby --1.9 -S irb 
```

我创建了一个 gem nittresults，安装后我无法在 irb 中加载它。错误信息如下所示

```
➜  nittresults git:(master) ✗ gem list | grep -i nitt
nittresults (0.0.1)
➜  nittresults git:(master) ✗ irb
irb(main):001:0> require 'nittresults'
LoadError: no such file to load -- nittresults
    from org/jruby/RubyKernel.java:1042:in `require'
    from /Library/Frameworks/JRuby.framework/Versions/Current/lib/ruby/site_ruby/1.8/rubygems/custom_require.rb:36:in `require'
    from (irb):1:in `evaluate'
    from org/jruby/RubyKernel.java:1088:in `eval'
    from org/jruby/RubyKernel.java:1410:in `loop'
    from org/jruby/RubyKernel.java:1197:in `catch'
    from org/jruby/RubyKernel.java:1197:in `catch'
    from /Library/Frameworks/JRuby.framework/Versions/Current/bin/jirb:13:in `(root)' 
```

我怎样才能让它加载到 irb 内部？我在osx雪豹10.6.8上。

这是输出 og`gem env`

```
RubyGems Environment:
  - RUBYGEMS VERSION: 1.8.24
  - RUBY VERSION: 1.9.2 (2012-05-01 patchlevel 312) [java]
  - INSTALLATION DIRECTORY: /Library/Frameworks/JRuby.framework/Gems/1.9
  - RUBY EXECUTABLE: /Library/Frameworks/JRuby.framework/Versions/Current/bin/jruby
  - EXECUTABLE DIRECTORY: /Library/Frameworks/JRuby.framework/Versions/Current/bin
  - RUBYGEMS PLATFORMS:
    - ruby
    - universal-java-1.6
  - GEM PATHS:
     - /Library/Frameworks/JRuby.framework/Gems/1.9
     - /Users/User/.gem/jruby/1.9
  - GEM CONFIGURATION:
     - :update_sources => true
     - :verbose => true
     - :benchmark => false
     - :backtrace => false
     - :bulk_threshold => 1000
     - "install" => "--no-rdoc --no-ri"
     - "update" => "--no-rdoc --no-ri"
  - REMOTE SOURCES:
     - http://rubygems.org/ 
```

这是输出`puts $:`

```
➜  nittresults git:(master) ✗ irb      
irb(main):001:0> puts $:
/Library/Frameworks/JRuby.framework/Versions/Current/lib/ruby/site_ruby/1.9
/Library/Frameworks/JRuby.framework/Versions/Current/lib/ruby/site_ruby/shared
/Library/Frameworks/JRuby.framework/Versions/Current/lib/ruby/site_ruby/1.8
/Library/Frameworks/JRuby.framework/Versions/Current/lib/ruby/1.9
=> nil 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T21:00:35.090

您需要先激活 ruby​​gems：

```
require 'rubygems'
gem 'nittresults'
require 'nittresults' 
```

# actionscript-3 - FLASH内容覆盖整个屏幕| 启用以下内容？

> ID：10922160
> 
> 赞同：0
> 
> 时间：2012-06-06T20:56:01.003
> 
> 标签：actionscript-3, flash, html

我想知道是否有可能包含一个`<div>`覆盖整个屏幕的闪存文件。我已经这样做了，但我的问题是......

**您是否仍然可以在其中保留 Flash 内容`<div>`并使其透明并使用下面的 html 按钮`<div>`？**

我想一直保持 Flash 层处于活动状态，但是如何使用下面的按钮？我什至无法复制或突出​​显示文本。

谢谢你的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T21:07:36.623

如果 div 覆盖整个屏幕，是屏幕下方的按钮不再可见，或者您是否将按钮放置在 div 下方但固定在屏幕底部？在这种情况下，您应该能够为它们提供比包含 flash 的 div 更高的 z-index。这样它们就位于 flash div 的顶部，并且应该是可点击的。

```
<div id="flash" style="z-index:1;">
<div id="buttons" style="position:fixed; bottom:0px; z-index:4;"> 
```

您还可以使 flash div 可单击以显示/隐藏您放置在固定位置的按钮，以防 flash 确实占据了整个屏幕。无需使闪光灯透明。

# c# - C#如何使同步方法等待事件触发？

> ID：10922163
> 
> 赞同：4
> 
> 时间：2012-06-06T20:56:11.057
> 
> 标签：c#, .net, multithreading, events, controls

我有自定义浏览器类，它能够根据浏览的页面状态触发很多事件。现在我需要使用我的浏览器在这个网页上执行一些操作，但它们必须按顺序运行，每个操作都需要前一个操作的数据。实现这一点的最简洁方法是创建一个同步方法等待浏览器完成其工作。我是这样设计的：

```
public incomplete class MyClass {
    // (...) lots of stuff comes here, it's a web browser :)
    public bool MySyncMethod(object data) {
        bool success = false;
        bool wait = true;
        MyEventHandler = new EventHandler((o, e) => {
            data = MyEventProvidedData; // belive me, it's threre when it fired
            success = true; // let's assume it always succeed
            wait = false; // now we can move on to the rest of our long chain
        });
        // (...) here I have some more event handlers which can end my method...
        MyAsyncMethod(data); // so it started and will fire MyEventHandler soon
        while (wait) System.Threading.Thread.Sleep(100);
        return success;
   }
} 
```

但这里似乎有些不对劲。如果我使用线程，我只需放置 myThread.Join() 而不是我的 while 循环，它会等待我的线程完成。是否类似于 Thread.Join() 可以与控件触发的事件一起使用？有什么东西可以代替while循环吗？这是实现我的目标的更清洁的方式吗？上面的代码在真实的应用程序中工作，但我认为它不是最优的。

我在这里不使用线程有一个很好的理由——线程和 ActiveX 控件之间的所有通信都必须是线程安全的，而这并非易事。是的，我试过了：）这段代码很难调试，所以我决定重写它。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-06T21:12:30.087

尝试使用 ManualResetEvent：

```
 var wait = new ManualResetEvent(false); 
    var handler = new EventHandler((o, e) => wait.Set()); 
    MyAsyncMethod(data, handler); // so it started and will fire handler soon 
    wait.WaitOne(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T21:06:04.300

如果可以使用任务，则可以使用[WaitAll 方法](http://msdn.microsoft.com/en-us/library/dd270695.aspx)

但是你说你不能使用线程。仍然 asyncmethod 必须启动某种线程，所以必须涉及一些线程？如果问题是 asyncmethod 必须回发到原始线程才能使活动 x 控件工作，您可以使用 ASyncOperationManager（无耻自己的博客文章链接： http: [//blog.subrosoftware.nl/](http://blog.subrosoftware.nl/?p=42) ?p=42 ），或[MSDN 链接](http://msdn.microsoft.com/en-us/library/system.componentmodel.asyncoperationmanager.aspx)这也许可以解决线程回调问题？

# r - 如果下限大于上限，则创建空序列的序列构造

> ID：10922169
> 
> 赞同：10
> 
> 时间：2012-06-06T20:56:40.910
> 
> 标签：r, sequence

R 函数的“聪明”不止一次在极端`seq`情况下严重打击了我`lower == upper - 1`：

```
> 1:0
[1] 1 0
> seq(1, 0)
[1] 1 0
> seq(1, 0, 1)
Error in seq.default(1, 0, 1) : wrong sign in 'by' argument 
```

我不是在问这种奇怪行为的原因——我认为它现在只是我们必须忍受的遗产。相反，我想知道是否有任何包实现了`seq`在这种情况下返回空序列的运算符，如下所示：

```
safe.seq.int <- function(from, to, by=1) {
  if (from > to) integer(0) else seq.int(from, to, by)
}

> safe.seq.int(1, 0)
integer(0) 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-06T21:20:19.447

出于这个原因，使用`seq_len(n)`而不是一个很好的做法 - 如果你得到一个空序列而不是.`1:n``n=0``c(1,0)`

希望这可以帮助

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-07-10T08:49:00.180

非常不幸的是 : operator 和 seq() 函数都无法处理这种情况。到目前为止，我找到的最佳答案如下：

```
seq(a,b,length = max(0,b-a+1)) 
```

# mysql - 撤消 mysql UPDATE 命令

> ID：10922171
> 
> 赞同：19
> 
> 时间：2012-06-06T20:56:46.667
> 
> 标签：mysql

我试图在 MySQL 服务器上进行更新，但不小心忘记添加一个额外的 WHERE 子句，该子句应该编辑一行。

由于我的错误，我现在编辑了 3500 多行。

我可能有备份，但自上次备份以来我做了很多工作，我只是不想因为 1 个错误查询而浪费这一切。

请告诉我有什么办法可以解决这个问题。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-06T20:58:52.163

只是一个想法-您可以将备份还原到新数据库，然后根据以前的数据进行跨数据库查询以更新该列吗？

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-06-06T20:59:16.557

如果你提交了你的事务，是时候清理备份了，抱歉。但这就是备份的用途。我自己曾经做过类似的事情……曾经。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-06-06T21:09:50.647

没有。

尽管如此，您仍会为自己获得了这种学习经验而感到高兴，并为您现在将如何改变习惯以大大减少再次发生这种情况的机会而感到自豪。现在，您将成为“主人”，可以教导幼崽并引用实际经过实战考验的经验。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2019-04-12T01:19:12.157

你现在能做的只有一件事就是**改正你的坏习惯**，它会在未来帮助你。我知道这是一个老问题，OP 一定已经吸取了教训。我只是为其他人发布它，因为我今天也吸取了教训。

因此，我应该运行一个查询，该查询应该更新大约 50 条记录，然后`MySQL`返回 THIS `48500 row(s) affected`，由于一个愚蠢的条件错误，这让我有点心脏病发作`WHERE`：D

## 所以这里是学习：

1.  在运行它之前总是检查你的`query`两次，但有时它不会有帮助，因为你仍然会犯那个愚蠢的错误。
2.  由于第 1 步并不总是有帮助，因此最好`DB`在运行任何会影响数据的查询之前备份您的数据。
3.  如果您因为数据库很大并且需要时间而懒惰创建备份（就像我在运行那个愚蠢的查询时一样），那么**至少使用** `TRANSACTION`，我认为这是一种**轻松**战胜灾难的好方法。从现在开始，这就是我对影响数据的每个查询所做的：

我启动`Transaction`，运行`Query`，然后检查结果是否正常。如果结果还可以，那么我只是简单地`COMMIT`改变，否则我只是为了克服灾难`ROLLBACK`

```
START TRANSACTION;
  UPDATE myTable
  SET name = 'Sam'
  WHERE recordingTime BETWEEN  '2018-04-01 00:00:59' AND '2019-04-12 23:59:59'; 
ROLLBACK;
-- COMMIT; -- I keep it commented so that I dont run it mistakenly and only uncomment when I really want to COMMIT the changes 
```

# php - selenium webdriver PHP 绑定

> ID：10922172
> 
> 赞同：1
> 
> 时间：2012-06-06T20:56:54.787
> 
> 标签：php, selenium, webdriver

我在寻找 selenium webdriver PHP 绑定。在他们的文档中，他们说 PHP 绑定是由第三方提供的。在[他们的文档页面上](http://seleniumhq.org/docs/03_webdriver.html#setting-up-a-selenium-webdriver-project)，他们列出了以下 3rd 方绑定：

*   [由奇比奇](https://github.com/chibimagic/WebDriver-PHP/)
*   [卢卡斯·科尔钦斯基](http://code.google.com/p/php-webdriver-bindings/)
*   [由脸书](https://github.com/facebook/php-webdriver)

虽然我是 Web UI 自动化的新手，但我不知道在使用这些驱动程序时可能会遇到什么问题。

我已经尝试过将 Selenium IDE 作为 Firefox 插件，并且将来我想将这些测试用例/记录与我的 webdriver 项目一起使用。

我应该选择哪一个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T09:43:44.460

在过去的几个月里还发布了更多

[亚当古彻的 PHP](https://github.com/Element-34/php-webdriver)

[Nearsoft 的 PHP](https://github.com/Nearsoft/PHP-SeleniumClient)

我使用了 Facebok 绑定，因为它拥有当时最好的文档/示例，这意味着我可以尽快启动并运行一些东西。

我现在正在尝试 Nearsoft 绑定，因为它们的库与 Java 和其他支持的语言中的官方绑定非常相似（方法名称）......所以希望一旦官方 PHP 库出现，它不应该花费太多时间移植我的测试。

所以（没有顺序，但很重要），选择...的绑定

*   有良好的文档/支持/社区活动
*   有你需要的方法
*   您可以使用

* * *

我在绑定中遇到的一些问题是......

1.  如果您正在努力让特定电话正常工作，则缺乏示例
2.  缺乏与使用绑定的所有者/社区的支持/讨论
3.  尝试使用 Selenium 测试 Facebook 应用程序是可行的，但很容易出错……有一些技巧，例如以测试用户身份登录并重新轮询一个元素，直到它准备好被检查……我认为其中一个 saucelabs 视频涵盖像这样的小怪癖
4.  您可以使用打开 Selenium IDE 测试并选择“选项”>“格式”来查看它们作为测试用例的样子，这有助于了解如何在 phpunit 中使用断言/验证。您可能必须[启用“格式”选项](http://blog.reallysimplethoughts.com/2011/06/10/does-selenium-ide-v1-0-11-support-changing-formats/)并安装[PHP 格式](https://addons.mozilla.org/en-US/firefox/addon/selenium-ide-php-formatters/)才能使其正常工作，并注意 IDE 在切换格式时提到的警告消息

* * *

2012 年 6 月更新 刚刚反馈说来自 Nearsoft 的绑定结果非常好，“waitForElementUntilIsPresent”方法和“WebDriverWait”类意味着我的测试更加可靠，即使在使用元素不存在的 AJAXy 功能时也是如此时刻准备着。

Norton Internet Security 2012 也干扰了我使用这些绑定进行的初始测试。

# python - 使用 Python over Apache 通过 HTTP 将文件推送给用户时文件名错误

> ID：10922176
> 
> 赞同：3
> 
> 时间：2012-06-06T20:57:00.170
> 
> 标签：python, http, cgi, mime

我正在向我们的网站添加功能，以便用户可以下载存储在数据库中的文件。问题是我无法为用户正确指定文件名 - 而是提示用户使用运行网站的主要 python 脚本的名称保存文件。我正在设置 Content-Disposition 信息，但它没有按预期工作。我已将代码编辑为以下内容，但仍然无法正常工作：

```
import sys, os
import mydatabasemodule
PDFReport = [...read file from database ...]
print('Content-Type: application/octet-stream\n')
print('Content-Disposition: attachment; filename=\"mytest.pdf\"\n')
print(report)
sys.stdout.close() 
```

运行此代码会提示用户将文件下载为 mysite.py。PDF 正确下载只是使用错误的文件名。

谁能告诉我在这里做错了什么？在完整版的代码中，我还设置了 Content-Description 和 Content-Length 但这也失败了。这些文件很小，我试图避免将它们保存到磁盘，但即使我这样做，也会发生同样的问题。

[编辑] 网络服务器运行 CentOS 5.5、Python 2.4.3、Apache 2.2.3 和 mod_python。我已经使用 Google Chrome 17.0.963.46 beta 和 Firefox 13 在 Ubuntu 11.04 客户端上对此进行了测试。如果我尝试显示 PDF 内联：

```
print('Content-type: application/pdf\n')
print('Content-Disposition: inline; filename=\"mytest.pdf\"\n')
print("Content-Length: %d" % len(report)) 
```

然后 Chrome 显示 PDF（带有插件）并且 Firefox 要求保存文件，将其识别为 PDF 但仍然具有错误的文件名，即文件名仍然是脚本名称。

[编辑] Mike 在下面给出了解决方案。我认为问题在于我在上面第一行中添加的换行符。由于 print 添加了换行符，因此第二个换行符表示标题的结束，因此从未读取过 Content-Disposition 行。感谢大家的快速帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T21:12:16.370

在 python 版本 < 3.0 中， print 不是一个函数，它会自动添加一个换行符。试试这个。

```
import sys, os
import mydatabasemodule
PDFReport = [...read file from database ...]
print 'Content-Type: application/octet-stream'
print 'Content-Disposition: attachment; filename="mytest.pdf"'
print
sys.stdout.write(PDFReport)
sys.stdout.flush() 
```

# javascript - Javascript 视口淡入淡出

> ID：10922178
> 
> 赞同：0
> 
> 时间：2012-06-06T20:57:07.347
> 
> 标签：javascript, jquery, fadein, fadeout, viewport

我正在尝试完成一些如此简单但很痛苦的事情，但在工作数小时后我还没有运气。

我有 4 个 div，每个都有“.slide”类。我想做的就是让它们不可见，但是当它们在视口中时淡入。如果它们离开视口，它们应该返回到不可见状态。有任何想法吗？

```
 $('.slide').waypoint(
    function() {
        if( $(this).is(":in-viewport") ) {
            $(this).animate({
                opacity: 1
            }, 100);
        }
        $('.slide').not(this).animate({
            opacity: 0
        }, 100);
    },
    {
        offset: function() {
            return $.waypoints('viewportHeight') - document.getElementById('navigation').clientHeight;
        }
    }
); 
```

[http://jsfiddle.net/Agdax/3/](http://jsfiddle.net/Agdax/3/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-07T14:00:13.130

所以我玩了一点，得到了[这个](http://jsfiddle.net/6n8KX/1/)：

```
/*jslint browser: true */
/*global $ */

(function () {
    'use strict';

    var invisibleClassName = 'invisible',
        scrollWait = 500;

    function isInvisible(el) {
        var wh = $(window).height(),
            wt = $(window).scrollTop(),
            eh = $(el).height(),
            et = $(el).offset().top;
        return ((wh + wt) <= et || wt >= (et + eh));
    }

    function checkVisibleAll(elements) {
        elements.each(function () {
            $(this)[(isInvisible(this) ? 'add' : 'remove') + 'Class'](invisibleClassName);
        });
    }

    $.fn.visible = function () {
        var elements = this,
            scrollTimer = null;

        // Don't check too often
        function scrolled() {
            clearTimeout(scrollTimer);
            scrollTimer = setTimeout(function () {
                checkVisibleAll(elements);
            }, scrollWait);
        }

        // Onload
        checkVisibleAll(elements);

        $(window).bind("scroll resize", scrolled);
        return this;
    };
}()); 
```

动画在现代浏览器中可见。

# php - FOSRestBundle 在获取 URL 中添加“S”

> ID：10922184
> 
> 赞同：5
> 
> 时间：2012-06-06T20:58:08.360
> 
> 标签：php, symfony, fosuserbundle

// MySomethingController.php

```
// look no s
public function getSomethingAction($args)
{
    ...
} 
```

// 路由.yml

```
my_something:
    type:     rest
    resource: Blah\Bundle\BlahBundle\Controller\MySomethingController 
```

跑步：

```
php app/console router:debug 
```

输出：

```
[router] Current routes
Name                Method     Pattern
get_something       GET        /somethings/{args}.{_format} 
```

为什么路线是“somethings”（复数加一个“s”）而不是“something”？

这是我在某个地方的设置吗？还是这是预期的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T17:07:24.830

挖掘代码后：

*   [https://github.com/FriendsOfSymfony/FOSRestBundle/blob/master/Routing/Loader/Reader/RestActionReader.php](https://github.com/FriendsOfSymfony/FOSRestBundle/blob/master/Routing/Loader/Reader/RestActionReader.php)

这里是：

```
private function generateUrlParts(array $resources, array $arguments)
{
    $urlParts = array();
    foreach ($resources as $i => $resource) {
        // if we already added all parent routes paths to URL & we have
        // prefix - add it
        if (!empty($this->routePrefix) && $i === count($this->parents)) {
            $urlParts[] = $this->routePrefix;
        }

        // if we have argument for current resource, then it's object.
        // otherwise - it's collection
        if (isset($arguments[$i])) {
            if (null !== $resource) {
                $urlParts[] =
                    strtolower(Pluralization::pluralize($resource))
                    .'/{'.$arguments[$i]->getName().'}';
            } else {
                $urlParts[] = '{'.$arguments[$i]->getName().'}';
            }
        } elseif (null !== $resource) {
            $urlParts[] = strtolower($resource);
        }
    }

    return $urlParts;
} 
```

我打开了一个问题：

*   [https://github.com/FriendsOfSymfony/FOSRestBundle/issues/247](https://github.com/FriendsOfSymfony/FOSRestBundle/issues/247)

希望这将成为可选的

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-30T16:19:31.757

这是基于@phillpafford 打开的票证的更新答案。

[Ismith77 评论](https://github.com/FriendsOfSymfony/FOSRestBundle/issues/247#issuecomment-6462376)了这张票，我想很好地解释了原因：

> 如果没有复数，我们将不知道方法之间的关系，这将是重要的，例如在实现#52 时。此外，REST 的一个关键思想是，我们将集合中单个元素的 GET 放在集合本身的“子目录”中。
> 
> 因此，如果您执行“正确”的 REST，那么 /member/{id}.{_format} 的名称会很奇怪，但如果您的集合本身不存在于 /member{.format} 下，那实际上是错误的。
> 
> 所有这一切的要点是.. 解决方案与其说是为了方便，不如说是关于强制人们实际遵循 REST 原则。

PS：但是我想指出，当你有一个像“数据”这样的词时，它本身就是复数，这有点烦人......

# android - 如何将jpg图像保存到sd卡中我自己的目录

> ID：10922186
> 
> 赞同：1
> 
> 时间：2012-06-06T20:58:14.040
> 
> 标签：android

我已将以下代码更新为以下行更改，但不起作用：

//设置`Image`位置

```
File file = new File(Environment.getExternalStorageDirectory() + "/Skynet/images/t1.jpg" );

Uri uriTarget = Uri.fromFile(file); 
```

我想保存`jpeg`到上面的目录，但不知道，因为它正在使用媒体存储。任何提示都可以做到这一点。

```
import android.app.Activity;
import android.content.ContentValues;
import android.content.Intent;
import android.net.Uri;
import android.os.Bundle;
import android.provider.MediaStore;
import android.util.Log;
import android.view.View;
import android.widget.Button;
import android.widget.ImageView;

public class AndroCamera extends Activity {
   private static final int IMAGE_CAPTURE = 0;
   private Button startBtn;
   private Uri imageUri;
   private ImageView imageView;

/** Called when the activity is first created.
 *  sets the content and gets the references to
 *  the basic widgets on the screen like
 *  {@code Button} or {@link ImageView}
 */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    imageView = (ImageView)findViewById(R.id.img);
    startBtn = (Button) findViewById(R.id.startBtn);
    startBtn.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
            startCamera();
        }
    });
}

public void startCamera() {
    Log.d("ANDRO_CAMERA", "Starting camera on the phone...");
    String fileName = "testphoto.jpg";
    ContentValues values = new ContentValues();
    values.put(MediaStore.Images.Media.TITLE, fileName);
    values.put(MediaStore.Images.Media.DESCRIPTION,
            "Image capture by camera");
    values.put(MediaStore.Images.Media.MIME_TYPE, "image/jpeg");
    imageUri = getContentResolver().insert(
            MediaStore.Images.Media.EXTERNAL_CONTENT_URI, values);
    Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);
    intent.putExtra(MediaStore.EXTRA_OUTPUT, imageUri);
    intent.putExtra(MediaStore.EXTRA_VIDEO_QUALITY, 1);
    startActivityForResult(intent, IMAGE_CAPTURE);
}

protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    if (requestCode == IMAGE_CAPTURE) {
        if (resultCode == RESULT_OK){
            Log.d("ANDRO_CAMERA","Picture taken!!!");
            imageView.setImageURI(imageUri);
        }
    }
} 
```

}

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T21:15:21.533

那是因为`Uri`您使用的是来自媒体管理器，也许如果您使用`Uri`您希望将其保存到的定义，它应该可以工作。这里有一个提示：

```
mImageUri= Uri.fromFile( new File( Environment.getExternalStorageDirectory(),
                        "pic_" + String.valueOf( System.currentTimeMillis() ) + ".jpg" ) ); 
```

在此它被保存到根目录，但是由于您正在创建文件，因此您可以将其放置在您想要的任何位置。只要确保目录存在，否则创建它。正如@Simon 所说，确保您有权在外部存储上写入。

**更新 1：** 目前你有类似的东西：

```
imageUri = getContentResolver().insert(
            MediaStore.Images.Media.EXTERNAL_CONTENT_URI, values); 
```

所以插入只是将图像插入到表`MediaStore`中......但如果那是你真正需要的，那么你需要覆盖. 添加你的东西是这样的：`Data``MediaStore``contentValues`

```
values.put( MediaStore.Images.ImageColumns.DATA, fullPath ); 
```

如果您不需要使用该`MediaStore`表，则无需进行插入，因此`ContentValues`不需要。

# java - 如何在Java中二维数组的循环内创建对象

> ID：10922187
> 
> 赞同：0
> 
> 时间：2012-06-06T20:58:21.507
> 
> 标签：java, arrays, multidimensional-array, 2d

我有一堂课

```
public class SimpleData() {
    String continent;
    String country;
    String city;

    public SimpleData(String continent, String country, String city) {
        this.continent = continent;
        this.country = country;
        this.city = city;
    }

} 
```

另一个从文件中获取数据并返回二维对象数组的类

```
private Object[][] getDataFromFile(String fileName) {
    return dataLoader.getTableArray(fileLocation, dataSheetName);
}

//will return something like
europe, uk, london
europe, france, paris 
```

如何在循环二维数组并将对象添加到列表时创建 SimpleData 对象，以便 SimpleData 的每个对象代表一行数据？

```
private List<SimpleData> getDataList() {
    Object[][] array = readDataFromFile("myfile");
    List<SimpleData> dataList = new ArrayList<SimpleData>();

    for (int i = 0; i < arr.length; i++) {
        for (int j = 0; j < arr[i].length; j++) {
            //what's the code to generate object with the correct row of data?
        }
    }
    return dataList;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T21:03:32.113

代替

```
 for (int j = 0; j < arr[i].length; j++) {
        //what's the code to generate object with the correct row of data?
    } 
```

您将需要这个（忽略异常处理）：

```
dataList.add(new SimpleData(array[i][0].toString(), array[i][1].toString(), 
   array[i][2].toString())); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T21:07:32.643

您的二维数组是否正好包含 3 列？如果是这样，这里是代码。

```
 private List<SimpleData> getDataList() {
    Object[][] array = readDataFromFile("myfile");
    List<SimpleData> dataList = new ArrayList<SimpleData>();

    for (int i = 0; i < arr.length; i++) {
        SimpleData sd = new SimpleData(array[i][0], array[i][1], array[i][2]);
        dataList.add(sd);
        }
    }
    return dataList;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T21:03:30.510

在您的循环中，调用您的构造函数`for`，而不是循环遍历。`j`

```
for (int i = 0; i < arr.length; i++) {
    SimpleData yourData = new SimpleData(arr[i][0].toString(), arr[i][1].toString(), arr[i][2].toString());
    // Whatever you want with yourData.
} 
```

您还可以创建一个 SimpleDatas 的 ArrayList，例如：

```
ArrayList<SimpleData> datas = new ArrayList<SimpleData>();
for (int i = 0; i < arr.length; i++) {
    datas.add(new SimpleData(arr[i][0].toString(), arr[i][1].toString(), arr[i][2].toString()));
}
// Whatever you want with datas. 
```

**编辑：**更新以添加`toString`到每个 SimpleData 构造函数。由于这是**vizier**的解决方案，请投票/接受他的回答。

# objective-c - QuartzCore：画一个有洞的形状？

> ID：10922190
> 
> 赞同：2
> 
> 时间：2012-06-06T20:58:30.997
> 
> 标签：objective-c, cgpath, quartz-core

如何使用 QuartzCore 绘制一个带有孔的形状？

这是一个例子： ![在此处输入图像描述](../Images/9f25b2a7b6b7230832d6d3714ffcfd51.png)

我已经了解如何绘制路径：

```
CGMutablePathRef maskPath = CGPathCreateMutable();
CGPathMoveToPoint(maskPath, NULL, x1, y1);
CGPathAddLineToPoint(maskPath, NULL, x2, y2);
CGPathAddLineToPoint(maskPath, NULL, x3, y3);
CGPathCloseSubpath(maskPath); 
```

并将其应用于 UIView：

```
CAShapeLayer *maskLayer = [CAShapeLayer layer];
maskLayer.frame = viewToMask.bounds;
maskLayer.path = maskPath;
viewToMask.layer.mask = maskLayer; 
```

但我不完全确定如何创建一条中心有洞的路径。我是否需要以某种方式从路径中减去，也许？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T21:07:51.113

由于您将 CGPath 设置为 CAShapeLayer 的路径属性作为掩码，因此您应该查看[Crop a CAShapeLayer retrieving the external path](https://stackoverflow.com/q/10856353/608157)及其**[答案](https://stackoverflow.com/a/10881680/608157)**。

# git - 使用 GIT 实现 Dropbox 类型功能

> ID：10922191
> 
> 赞同：2
> 
> 时间：2012-06-06T20:58:34.793
> 
> 标签：git, version-control, mercurial, dropbox

我想实现一种机制来跨多台机器同步文件。我并不特别关心超过 1 个月的文件，因此无需保留这些数据。

除了消除旧版本之外，Git 似乎几乎完成了所有这些工作。是否有一个破坏性命令可以让我说“杀死所有早于 X 的修订版”？或者，如果我可以使用另一个 VCS 工具来完成同样的事情，我会非常感兴趣。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T20:58:27.397

另见[“git-annex 助手”](http://www.kickstarter.com/projects/joeyh/git-annex-assistant-like-dropbox-but-with-your-own)和[“sharebox”](https://github.com/chmduquesne/sharebox-fs)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-07T00:06:03.277

你不需要自己实现。它已经完成了：[http ://sparkleshare.org/](http://sparkleshare.org/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-06T21:52:44.087

每当涉及同步时，[**`git bundle`**](https://stackoverflow.com/questions/2129214/backup-a-local-git-repository/2129286#2129286)这很有趣，因为：

*   它只创建*一个*文件（易于复制），就像一个 git repo（您可以从包中克隆/拉取）
*   它可以创建一个*增量*包（第一个是完整包，而不是您可以使用增量包，以便仅选择最后一次提交，而不是完整历史记录）

但是，另一端的 repo 仍然会通过从连续捆绑包中拉取*所有提交。*

关于增量包，[`git bundle`手册页](http://git-scm.com/docs/git-bundle)：

```
<git-rev-list-args> 
```

> 参数列表，可接受[`git rev-parse`](http://git-scm.com/docs/git-rev-parse)和[`git rev-list`](http://git-scm.com/docs/git-rev-list)（并包含命名的 ref，请[参阅](http://git-scm.com/docs/git-bundle#_specifying_references)下面的指定引用），指定特定对象和对传输的引用。
> 例如，`master~10..master`导致当前主引用与自其第 10 次祖先提交以来添加的所有对象一起打包。

虽然可以使用 rev-list `--since=30.days.ago master`，但最好确保在构建增量包时考虑到最后一个包使用的最后一次提交（特别是如果最后一次提交超过 30 天。如果它较新，则如果你接受“太多”的提交并不重要）。

# python - 如果 TCPServer 在另一个线程中运行，Python 2 不会处理信号

> ID：10922192
> 
> 赞同：5
> 
> 时间：2012-06-06T20:58:42.343
> 
> 标签：python, signals, socketserver

在使用标准库时，我发现 python2 和 python3 之间有一个奇怪的区别。如果我在 TCPServer 在不同的线程中运行时尝试在 python2 中捕获信号，则不会处理该信号，但在 python3 中却可以。

这是重现问题的脚本

```
import signal
import threading
import sys 
if sys.version_info > (3,0):
    from socketserver import TCPServer, BaseRequestHandler
else:
    from SocketServer import TCPServer, BaseRequestHandler

def shutdown(signum, frame):
    print("Shutting down server thread")
    server.shutdown()

server = TCPServer(
    ('127.0.0.1', 7654),
    BaseRequestHandler
)
signal.signal(signal.SIGTERM, shutdown)
signal.signal(signal.SIGINT, shutdown)
server_thread = threading.Thread(target=server.serve_forever)
print("Starting server thread")
server_thread.start()
print("Waiting for server thread to shut down")
server_thread.join()
print("Server thread terminated") 
```

这是 python3 的输出：

```
Starting server thread
Waiting for server thread to shut down
^CShutting down server thread
Server thread terminated 
```

这是来自python2：

```
Starting server thread
Waiting for server thread to shut down
^CKilled 
```

“^C”是键盘中断，“Killed”是我发送给进程的 sigkill。

为什么不调用关机？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T07:58:08.610

对我来说，似乎 thread.join() 做了一些锁定并阻止捕获信号。

我已经在 Python 2.7 中测试了以下代码，它似乎可以工作：

```
import time
import signal
import threading
import sys 
if sys.version_info > (3,0):
    from socketserver import TCPServer, BaseRequestHandler
else:
    from SocketServer import TCPServer, BaseRequestHandler

def shutdown(signum, frame):
    print("Shutting down server thread")
    server.running = False
    server.shutdown()

server = TCPServer(
    ('127.0.0.1', 7654),
    BaseRequestHandler
)
signal.signal(signal.SIGTERM, shutdown)
signal.signal(signal.SIGINT, shutdown)
server_thread = threading.Thread(target=server.serve_forever)
print("Starting server thread")
server_thread.start()
server.running = True
print("Waiting for server thread to shut down")

while server.running:
    time.sleep(1)

server_thread.join()
print("Server thread terminated") 
```

# ruby-on-rails - Resque 未获取 Redis 配置设置

> ID：10922197
> 
> 赞同：7
> 
> 时间：2012-06-06T20:59:10.640
> 
> 标签：ruby-on-rails, redis, resque, unicorn

我在尝试让一个在 Unicorn 下运行的 Rails 应用程序连接到受密码保护的 Redis 服务器时遇到了意想不到的重大问题。

在命令行上使用`bundle exec rails c production`，我可以通过 Resque.redis 发出命令。但是，似乎我的配置在 Unicorn 下分叉时丢失了。

使用不受密码保护的 Redis 服务器 Just Works。但是，我打算在 Redis 服务器所在的其他服务器上运行工作程序，因此我需要对其进行密码保护。

我也成功地使用了受密码保护的密码（使用相同的技术），但使用的是乘客而不是独角兽。

我有以下设置：

```
# config/resque.yml

development: localhost:6379
test: localhost:6379
production: redis://user:PASSWORD@oak.isc.org:6379 
```

.

```
# config/initializers/redis.rb

rails_root = ENV['RAILS_ROOT'] || File.dirname(__FILE__) + '/../..'
rails_env = ENV['RAILS_ENV'] || 'development'

$resque_config = YAML.load_file(rails_root + '/config/resque.yml')
uri = URI.parse($resque_config[rails_env])
Resque.redis = Redis.new(host: uri.host, port: uri.port, password: uri.password) 
```

.

```
# unicorn.rb bootup file

preload_app true

before_fork do |server, worker|
  Redis.current.quit
end

after_fork do |server, worker|
  Redis.current.quit
end 
```

.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-02T00:33:26.757

好的，为了其他可能在谷歌上搜索这个问题的人，我至少已经为自己解决了这个问题

基本问题是在代码中的其他地方调用 Redis.new，例如在您的地理编码器设置或独角兽配置文件​​中。

只需确保每次调用初始化 Redis 时都传入适当的值，例如

```
REDIS = Redis.connect(:url =>  ENV['REDISTOGO_URL']) 
```

无处不在，你不应该有

```
Redis.new 
```

因为它将默认为 localhost 和默认端口

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-06T22:19:25.623

**更新了基于@lmarlow 对 resque issue 的评论的完全不同**的**[想法](https://github.com/resque/resque/pull/588#issuecomment-5578816)。**

 **我敢打赌，只要你有 Redis ~>3，它就会中断（我的意思是 ruby​​ 客户端版本，而不是服务器版本）。

在撰写本文时，Resque 需要 Redis ~>2，但并未在其 gemspec 中指定。因此，您必须通过将其添加到您的 Gemfile 来帮助它：

```
gem 'redis', '~>2' # until a new version of resque comes out
gem 'resque' 
```

此外，请确保在任何地方都在使用捆绑程序。否则，如果您的系统有新版本的 Redis gem，它将被使用，Resque 将像以前一样失败。

最后，一个装饰说明......您可以将配置简化为：

```
# config/initializers/redis.rb
$resque_redis_url = uris_per_environment[rails_env] # note no URI.parse
Resque.redis = $resque_redis_url 
```

接着

```
# unicorn.rb bootup file
after_fork do |server, worker|
  Resque.redis = $resque_redis_url
end 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-07-19T17:39:42.017

对我有用的是这里的独角兽配置：[https ://stackoverflow.com/a/14636024/18706](https://stackoverflow.com/a/14636024/18706)

```
before_fork do |server, worker|
  if defined?(Resque)
    Resque.redis.quit
    Rails.logger.info("Disconnected from Redis")
  end
end

after_fork do |server, worker|
  if defined?(Resque)
    Resque.redis = REDIS_WORKER
    Rails.logger.info("Connected to Redis")
  end
end 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-05T21:26:18.390

这对我很有帮助：

来源：[https ://github.com/redis/redis-rb/blob/master/examples/unicorn/unicorn.rb](https://github.com/redis/redis-rb/blob/master/examples/unicorn/unicorn.rb)

```
require "redis"

worker_processes 3

# If you set the connection to Redis *before* forking,
# you will cause forks to share a file descriptor.
#
# This causes a concurrency problem by which one fork
# can read or write to the socket while others are
# performing other operations.
#
# Most likely you'll be getting ProtocolError exceptions
# mentioning a wrong initial byte in the reply.
#
# Thus we need to connect to Redis after forking the
# worker processes.

after_fork do |server, worker|
  Redis.current.quit
end 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-09-11T06:34:55.237

我认为问题出在 Resque-web 上。它的配置文件，他们现在修复它。在 0.0.11 版中，他们也在评论中提到它：[https ://github.com/resque/resque-web/blob/master/config/initializers/resque_config.rb#L3](https://github.com/resque/resque-web/blob/master/config/initializers/resque_config.rb#L3)

早些时候，他们的文件看起来像这样：[https ://github.com/resque/resque-web/blob/v0.0.9/config/initializers/resque_config.rb](https://github.com/resque/resque-web/blob/v0.0.9/config/initializers/resque_config.rb)

而且，如果由于任何原因，您无法升级，而是尝试设置 env 变量`RAILS_RESQUE_REDIS=<host>:<port>`，因为 Initializers 在尝试连接 redis（并且失败）之后正在加载。**

# mono - MonoDevelop：重新格式化代码 - 调低

> ID：10922198
> 
> 赞同：1
> 
> 时间：2012-06-06T20:59:13.427
> 
> 标签：mono, xamarin.ios, monodevelop, xamarin.android

MonoDevelop 3.0 很棒，但它对重新格式化有点过于热心了。

当我输入代码时：

```
var serializer = new XmlSerializer (typeof(TDestination),extraTypes); 
```

然后按 CTRL+SHIFT+F 格式化代码，它会更改这些行以在每一行放置一个参数，从而在函数调用或 lambda 表达式很长时难以阅读。

```
 var serializer = new XmlSerializer (
                    typeof(TDestination),
                    extraTypes
        ); 
```

如何让 MonoDevelop 保持原样的换行符？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T21:17:19.933

转到首选项 >> 源代码 >> 代码格式 >> C# 源代码。选择自定义策略，按“C# 格式”选项卡，然后按“编辑”按钮。我希望这会有所帮助！

# android - Activity onPause 奇怪的动作

> ID：10922206
> 
> 赞同：3
> 
> 时间：2012-06-06T20:59:43.457
> 
> 标签：android, onresume, onpause

我的活动中有一个 onPause。奇怪的是，在单个活动（videoPlayer）中，onPause 被调用了两次

场景：这发生在我的手机设备上的视频播放器中，而不是平板电脑上。

按电源按钮进入待机状态，调用 onpause 然后调用 onresume 然后再次调用 on pause。然后再次按下电源按钮，并按预期调用恢复。

有没有人遇到过这样的问题，如果有，你是如何解决的。即使只是让 onPause onResume onpause 然后开启 onResume。

提前致谢。这个出现两次

```
 protected void onPause()
{

    Log.i("VideoPlayer", "onPauseCalled");
    super.onPause();
    pauseMedia();
    Log.i("onPause", " save states to be called");
    if(saveAllowed)
        saveStates();
    Log.i("onPause", " save States called");
    view.setVisibility(View.GONE);
    //Log.i("onPause", "visibility GOne");
    removeListeners();
    doCleanUp();

}

    @Override
protected void onResume()
{
    super.onResume();
    PowerManager pm = (PowerManager) getSystemService(Context.POWER_SERVICE);
    Log.i("VideoPlayer", "onResumeCalled");

    if(pm.isScreenOn())
    {
        //Initialization
        initializeViewControls();
        handler = new Handler();

        initializeButtons();
        initRecordButtons();
        initVolumeControl();

        //RestoreState
        restoreMediaBoolean();
        restoreMediaState();
        Log.i("After", "restoreState");
        view = (SurfaceView) findViewById(R.id.surfaceView);
        //Log.i("After", "GettingView");
        holder = view.getHolder();
        view.setVisibility(View.VISIBLE);
        holder.addCallback(this);
        holder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);
        Log.i("onResume", "view is Visible");
        saveAllowed = true;
    }
    else
        saveAllowed = false;

}

private void saveStates()
{
    if(!isFinishing)
    {
        //Log.i("VideoPlayer", "Called at saveStates()");

        prefs = getSharedPreferences(PREF_SAVE, Context.MODE_PRIVATE);
        if(prefs != null)
        {
            prefEditor = prefs.edit();
        }

        if(prefEditor != null)
        {

            //Save overlay visibiltiy
            if((volumeLayout != null) && (volumeLayout.getVisibility() == View.VISIBLE))
            {
                prefEditor.putBoolean(IS_VOLUME_VISIBLE, true);
                prefEditor.commit();
            }
            else
            {
                prefEditor.putBoolean(IS_VOLUME_VISIBLE, false);
                prefEditor.commit();
            }

            //Save recorder Overlay state
            if((recordLayout != null) && (recordLayout.getVisibility() == View.VISIBLE) )
            {
                prefEditor.putBoolean(IS_RECORDER_VISIBLE, true);
                prefEditor.commit();
            }
            else
            {
                prefEditor.putBoolean(IS_RECORDER_VISIBLE, false);
                prefEditor.commit();
            }
            //Save controller OVerlay State
            if((backButton != null) && (backButton.getVisibility() == View.VISIBLE))
            {

                prefEditor.putBoolean(IS_CONTROLLER_VISIBLE, true);
                prefEditor.commit();
                Log.i("Save States", "Controller saved as visible");
            }
            else
            {
                Log.i("Save States", "Controller saved as Invisible");
                //Log.i("Saving", "Controller Invisible");
                prefEditor.putBoolean(IS_CONTROLLER_VISIBLE, false);
                prefEditor.commit();
            }

            //Save is private Audio Recorded
            prefEditor.putBoolean(IS_PRIVATE_AUDIO_RECORDED, isCustomVoiceRecorded);
            prefEditor.commit();

            //Save are we playing out custom audio
            prefEditor.putBoolean(PLAY_CUSTOM_AUDIO, playCustomAudio);
            prefEditor.commit();

            //Make boolean is restoring
            prefEditor.putBoolean(IS_RESTORING, true);
            prefEditor.commit();

            //Saves Position of Current Video
            if(vidplayer != null)
            {
                prefEditor.putInt(VIDEO_POSITION, videoPausedAt);
                prefEditor.commit();
            }

            //Save Position of Current Audio
            if(audplayer != null)
            {
                prefEditor.putInt(AUDIO_POSITION, audioPausedAt);
                prefEditor.commit();
            }

            prefEditor = null;
            prefs = null;

        }
    } 
```

发生的事情是我保存了一些布局的状态，比如记录器布局，当它有点像菜单时它会暂停。然后，如果按下电源，它会关闭，但是当它重新打开时，布局消失并且正在播放视频，这是不应该发生的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T21:26:34.297

是的，我遇到了类似的问题。您使用的是哪种设备（如果记忆正确，我认为这是 NFC 屏幕超时问题）？暂停对我来说不是问题，但我尝试在 onResume 中恢复视频（它被调用两次）所以我在 onResume 中使用了以下内容：

```
PowerManager pm = (PowerManager) getSystemService(Context.POWER_SERVICE);
if (pm.isScreenOn()) {
   //now do stuff
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-20T13:52:41.083

尽管这是非常晚的答案，但我只想分享我的经验。我遇到了类似的情况，但这里的主要问题是方向改变，这是由视频播放器（可能是横向播放视频）或您的活动当前处于横向状态引起的。因此，当您按下设备上的电源关闭按钮时，实际生命周期阶段是：onPause()、onStop()，然后更改方向（锁定屏幕默认为纵向），这导致调用 onCreate()、onStart()、onPause( )...

解决方案很简单：通过在清单中的活动定义中指定 android:configChanges="orientation|screenSize" 属性并覆盖 java 类中的 onConfigurationChanged() 来手动处理方向更改

# iphone - Objective c - UIView 横向自动调整大小

> ID：10922210
> 
> 赞同：0
> 
> 时间：2012-06-06T21:00:11.010
> 
> 标签：iphone, objective-c, ios, uiview, autoresizingmask

我有一个带有 3 个视图的 viewController：topView、tableView 和 textView。

我希望他们像这样布局：

在纵向模式下 -

```
|---------------|  
|    topView    |  
|---------------|
|               |
|               |
|   tableView   |
|               |
|               |
|---------------|               
|   textView    |
|---------------| 
```

在横向模式下：

```
|--------------------------|  
|         topView          |  
|--------------------------|
|                          |
|        tableView         |
|--------------------------|               
|        textView          |
|--------------------------| 
```

**当键盘启动时：**

```
|---------------|  
|               |
|   tableView   |
|               |
|---------------|               
|   textView    |
|---------------|  
|               |
|   keyboard    |
|               | 
|---------------|  

|--------------------------|  
|        tableView         |
|--------------------------|               
|        textView          |
|--------------------------| 
|                          |
|        keyboard          |
|--------------------------| 
```

（如您所见，当键盘启动时，顶视图消失了）

这样做的代码是：

```
- (void)loadView
{
    [super loadView];

    // load top view
    _topView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, self.view.bounds.size.width, TOP_VIEW_HEIGHT)];
    _topView.autoresizingMask =  UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleBottomMargin;
    _topView.backgroundColor = [UIColor redColor];
    [self.view addSubview:_topView];

    // load table view (at the middle)
    CGRect tableFrame = CGRectMake(0, TOP_VIEW_HEIGHT, self.view.bounds.size.width, self.view.bounds.size.height - TOP_VIEW_HEIGHT - TEXT_VIEW_HEIGHT);
    _tableView = [[UITableView alloc] initWithFrame:tableFrame style:UITableViewStylePlain];
    _tableView.autoresizingMask =  UIViewAutoresizingFlexibleHeight | UIViewAutoresizingFlexibleWidth;
    _tableView.delegate = self;
    _tableView.dataSource = self;
    [self.view addSubview:_tableView];

    // load text view (at the bottom)
    CGRect textViewFrame = CGRectMake(0, tableFrame.size.height + TOP_VIEW_HEIGHT, self.view.bounds.size.width, TEXT_VIEW_HEIGHT);
    _textView = [[UITextView alloc] initWithFrame:textViewFrame];
    _textView.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleTopMargin;
    _textView.backgroundColor = [UIColor yellowColor];
    [self.view addSubview:_textView];
}  

- (void)keyboardWillShow:(NSNotification *)notification 
{
    NSDictionary *userInfo = [notification userInfo];

    // Get animation info from userInfo
    NSTimeInterval animationDuration;
    UIViewAnimationCurve animationCurve;

    [[userInfo objectForKey:UIKeyboardAnimationCurveUserInfoKey] getValue:&animationCurve];
    [[userInfo objectForKey:UIKeyboardAnimationDurationUserInfoKey] getValue:&animationDuration];

    CGSize kbSize = [[userInfo objectForKey:UIKeyboardFrameBeginUserInfoKey] CGRectValue].size;

    CGRect textViewFrame = self.textView.frame;
    textViewFrame.origin.y -= kbSize.height;

    CGRect topViewFrame = self.topView.frame;
    topViewFrame.origin.y -= topViewFrame.size.height;

    CGRect tableFrame = self.tableView.frame;
    tableFrame.origin.y -= topViewFrame.size.height;
    tableFrame.size.height -= (kbSize.height - topViewFrame.size.height);

    [UIView animateWithDuration:animationDuration delay:0.0 options:animationCurve animations:^{
        self.textView.frame = textViewFrame;
        self.tableView.frame = tableFrame;
        self.topView.frame = topViewFrame;
    }completion:^(BOOL finished) {

    }];
}

- (void)keyboardWillHide:(NSNotification *)notification 
{
    NSDictionary *userInfo = [notification userInfo];

    // Get animation info from userInfo
    NSTimeInterval animationDuration;
    UIViewAnimationCurve animationCurve;

    [[userInfo objectForKey:UIKeyboardAnimationCurveUserInfoKey] getValue:&animationCurve];
    [[userInfo objectForKey:UIKeyboardAnimationDurationUserInfoKey] getValue:&animationDuration];

    CGSize kbSize = [[userInfo objectForKey:UIKeyboardFrameBeginUserInfoKey] CGRectValue].size;

    CGRect textViewFrame = self.textView.frame;
    textViewFrame.origin.y += kbSize.height;

    CGRect topViewFrame = self.topView.frame;
    topViewFrame.origin.y += topViewFrame.size.height;

    CGRect tableFrame = self.tableView.frame;
    tableFrame.origin.y += topViewFrame.size.height;
    tableFrame.size.height += kbSize.height - topViewFrame.size.height;

    [UIView animateWithDuration:animationDuration delay:0.0 options:animationCurve animations:^{
        self.textView.frame = textViewFrame;
        self.tableView.frame = tableFrame;
        self.topView.frame = topViewFrame;
    }completion:^(BOOL finished) {
        //
    }];
} 
```

我想要的大部分工作都很好，**问题是当键盘以横向模式显示时**，事情就会出错..

**请注意**views`autoresizingMask`属性，因为我不确定我当前是否设置了它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T21:37:34.473

我发现了问题，当我在keyboardWillShow/willHide 中执行视图的向上/向下动画时，我没有将键盘矩形从屏幕转换为视图坐标

```
CGRect kbRect = [[userInfo objectForKey:UIKeyboardFrameBeginUserInfoKey] CGRectValue];
kbRect = [self.view convertRect:kbRect fromView:nil];
CGSize kbSize = kbRect.size; 
```

现在它工作正常:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T21:14:45.337

对于自动旋转，尝试将顶视图的遮罩设置为灵活宽度，中间的遮罩设置为灵活宽度和灵活高度，以及文本视图、灵活宽度和上边距。我怀疑这会顺利进行，但值得一试。您可以覆盖`willAnimateRotationToInterfaceOrientation:duration:`视图控制器以进行自定义工作。我很确定基本的自动旋转蒙版无法处理这种布局，但我很想被证明是错误的。

还要像这样检查方向`loadView`：

```
if (UIInterfaceOrientationIsLandscape([[UIApplication sharedApplication] statusBarOrientation])) {
    // do one layout
} else {
    // do another layout
} 
```

我也在我的应用程序中做非常自定义的旋转工作（想想从头开始的自定义拆分视图控制器 - 恶心），我正在使用`willAutorotate`and `UIInterfaceOrientationIsLandscape`.

由于您提出问题的方式，这可能不适用于您：我不确定问题是否在于您打开键盘，然后旋转到横向（在这种情况下，此答案可能会有所帮助）；或者您在横向打开键盘时是否有问题（在这种情况下，这个答案可能与您不太相关）。

# jsf-2 - SFSB 被移除

> ID：10922213
> 
> 赞同：2
> 
> 时间：2012-06-06T21:00:24.193
> 
> 标签：jsf-2, cdi, ejb-3.1, jboss6.x, codi

我正在使用 JBoss6.1.Final、JSF 2.0 (Mojarra)、Weld CDI、MyFaces CODI 1.0.5（用于视图访问范围）

我正在使用类似于[Real World Java EE Patterns Rethinking Best Practices中的网关模式](https://rads.stackoverflow.com/amzn/click/com/0557078326)（不幸的是我没有它，所以我可能在这里搞砸了）。基本上，该应用程序允许用户进入“编辑模式”并编辑在具有扩展持久性上下文的 @ViewAccessScoped 支持 bean 中维护的人员列表（创建、编辑、删除），然后单击刷新的“保存”命令链接他们对数据库的所有更改。起初我遇到了 ViewExpiredExceptions 的问题（如果浏览器在会话超时期间空闲，然后执行了进一步的请求），但我添加了一些 jQuery 来向保持会话活动的 servlet 发出 get 请求（称为 10会话超时前的秒数）。这似乎工作但现在我有另一个问题，支持 bean 也是一个 SFSB，经过一段时间的空闲时间，

13:06:22,063 严重 [javax.enterprise.resource.webcontainer.jsf.context] javax.el.E​​LException：/index.xhtml @27,81 渲染 =“#{!conversationBean.editMode}”：javax.ejb.NoSuchEJBException ：找不到有状态的bean：43h1h2f-9c7qkb-h34t0f34-1-h34teo9p-de

关于如何防止 SFSB 删除或至少更优雅地处理它的任何想法？

这是我的支持bean：

```
package com.ray.named;

import java.io.Serializable;
import java.util.List;

import javax.annotation.PostConstruct;
import javax.ejb.EJBTransactionRolledbackException;
import javax.ejb.Stateful;
import javax.ejb.TransactionAttribute;
import javax.inject.Named;
import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;
import javax.persistence.PersistenceContextType;

import org.apache.myfaces.extensions.cdi.core.api.scope.conversation.ViewAccessScoped;

import com.ray.model.Person;

@Named
@Stateful
@ViewAccessScoped
@TransactionAttribute(javax.ejb.TransactionAttributeType.NEVER)
public class ConversationBean implements Serializable {
  private static final long serialVersionUID = 1L;
  //properties
  private List<Person> people;
  private String name;
  private Boolean editMode;

  @PersistenceContext(type=PersistenceContextType.EXTENDED)
  private EntityManager em;

  @PostConstruct
  public void init() {
    people = em.createNamedQuery("Person.findAll", Person.class).getResultList();
    setEditMode(false);
  }

  //event listeners
  public void beginEdits() {
    setEditMode(true);
  }

  public void addPerson() {
    Person p = new Person(name);
    em.persist(p);
    people.add(p);
    name = null;
  }

  public void removePerson(Person p) {
    people.remove(people.indexOf(p));
    em.remove(p);
  }

  //this method flushes the persistence context to the database
  @TransactionAttribute(javax.ejb.TransactionAttributeType.REQUIRES_NEW)
  public void saveEdits() {
    setEditMode(false);
  }

  //getters/setters
  public List<Person> getPeople() {
    return people;
  }

  public String getName() {
    return name;
  }

  public void setName(String name) {
    this.name = name;
  }

  public Boolean getEditMode() {
    return editMode;
  }

  public void setEditMode(Boolean editMode) {
    this.editMode = editMode;
  }
} 
```

这是 Person 实体 bean：

```
package com.ray.model;

import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.NamedQueries;
import javax.persistence.NamedQuery;
import javax.persistence.Version;

@Entity
@NamedQueries({
  @NamedQuery(name="Person.findAll",
              query="SELECT p FROM Person p")
})
public class Person {
  @Id @GeneratedValue(strategy=GenerationType.IDENTITY) 
  private Integer id;
  private String name;
  @Version
  private int version;

  public Person() { }

  public Person(String name) {
    setName(name);
  }

  public boolean equals(Object o) {
    if (!(o instanceof Person)) {
      return false;
    }
    return id == ((Person)o).id;
  }

  //getters/setters
  public String getName() {
    return name;
  }
  public void setName(String name) {
    this.name = name;
  }

  public Integer getId() {
    return id;
  }

  public int getVersion() {
    return version;
  }

  public void setVersion(int version) {
    this.version = version;
  }
} 
```

这是视图：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets">
<h:head>
  <script src="http://code.jquery.com/jquery-latest.min.js"></script>
  <script>
  $(document).ready(function() {
    setInterval(function() {
      $.get("#{request.contextPath}/poll");
    }, #{(session.maxInactiveInterval - 10) * 1000});
  });
  </script>
  <title>Conversation Test</title>
</h:head>
<h:body>
  <h:form>
    <h:commandLink value="Begin Edits" rendered="#{!conversationBean.editMode}">
      <f:ajax render="@form" listener="#{conversationBean.beginEdits}"/>
    </h:commandLink>
    <h:commandLink value="Save" rendered="#{conversationBean.editMode}">
      <f:ajax render="@form" listener="#{conversationBean.saveEdits}"/>
    </h:commandLink>
    <h:dataTable id="peopleTable" value="#{conversationBean.people}" var="person">
      <h:column>
        <f:facet name="header">Name</f:facet>
        <h:panelGroup>
          <h:inputText value="#{person.name}" disabled="#{!conversationBean.editMode}">
            <f:ajax/>
          </h:inputText>
          <h:commandLink value="X" disabled="#{!conversationBean.editMode}">
            <f:ajax render="@form" listener="#{conversationBean.removePerson(person)}"/>
          </h:commandLink>
        </h:panelGroup>
      </h:column>
    </h:dataTable>
    <h:panelGrid columns="2">
      <h:outputLabel for="name">Name:</h:outputLabel>
      <h:inputText id="name" value="#{conversationBean.name}" disabled="#{!conversationBean.editMode}"/>
    </h:panelGrid>
    <h:commandButton value="Add" disabled="#{!conversationBean.editMode}">
      <f:ajax execute="@form" render="@form" listener="#{conversationBean.addPerson}"/>
    </h:commandButton>
  </h:form>
</h:body>
</html> 
```

这是一个用于保持会话活动的 servlet（在会话过期前 10 秒由 jQuery ajax 获取请求调用）：

```
package com.ray.web;

import java.io.IOException;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class PollServlet extends HttpServlet {
  private static final long serialVersionUID = 1L;

  public void init() throws ServletException {
  }

  public String getServletInfo() {
    return null;
  }

  public void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException, ServletException {
    request.getSession(); //Keep session alive
  }

  public void doPost(HttpServletRequest request, HttpServletResponse response) throws IOException, ServletException {
  }

  public void destroy() {
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T06:53:56.443

> 关于如何防止 SFSB 删除或至少更优雅地处理它的任何想法？

为了进一步研究，我建议查看 EJB 生命周期挂钩以进行**钝化**并在那里添加一些调试输出。

如果那是问题的根源，您将能够配置/停用钝化 - 但可扩展性可能会成为一个问题。

老实说，这种情况对我来说似乎并不常见。一般来说，我希望请求/对话/会话或多或少在默认边界内工作 - 如果您发现自己编写的代码可以规避这种情况，您是否会更好地使用 RESTful / 无状态方法......？

如果可用，请使用更多信息更新问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T15:58:42.493

我想你已经解决了你的问题。否则，这个 JBoss wiki 页面应该会有所帮助（也对未来的读者......）。

[https://community.jboss.org/wiki/Ejb3DisableSfsbPassivation](https://community.jboss.org/wiki/Ejb3DisableSfsbPassivation)

干杯，路易吉

# android - 我收到异常，不知道为什么

> ID：10922214
> 
> 赞同：0
> 
> 时间：2012-06-06T21:00:27.250
> 
> 标签：android, eclipse

这就是我现在所做的：

```
public class AndroidTestToSpeechActivity extends Activity implements
        TextToSpeech.OnInitListener {
    /** Called when the activity is first created. */

    private TextToSpeech tts;
    private Button btnSpeak;
    private EditText txtText;
    private ArrayList<String> itemsList;
    private Spinner spinner;
    private String contry_name;
    private ArrayAdapter<String> dataAdapter;
    private TextView textview;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        Log.i("----------",Arrays.toString(Locale.getAvailableLocales()));
        itemsList = new ArrayList<String>();
        itemsList.add(Arrays.toString(Locale.getAvailableLocales()));
        spinner = (Spinner)findViewById(R.id.spinner1);
        spinner.setOnItemSelectedListener((OnItemSelectedListener) this);
        dataAdapter = new ArrayAdapter<String>(this, android.R.layout.simple_spinner_item,itemsList);
        dataAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
        spinner.setAdapter(dataAdapter);
        textview = (TextView)findViewById(R.id.textView1);

        tts = new TextToSpeech(this, this);
        btnSpeak = (Button) findViewById(R.id.btnSpeak);
        txtText = (EditText) findViewById(R.id.txtText);

        // button on click event
        btnSpeak.setOnClickListener(new View.OnClickListener() {

            public void onClick(View arg0) {
                speakOut();
            }

        });
    }

    @Override
    public void onDestroy() {
        // Don't forget to shutdown tts!
        if (tts != null) {
            tts.stop();
            tts.shutdown();
        }
        super.onDestroy();
    }

    public void onInit(int status) {

        if (status == TextToSpeech.SUCCESS) {

            int result = tts.setLanguage(Locale.ENGLISH);

            if (result == TextToSpeech.LANG_MISSING_DATA
                    || result == TextToSpeech.LANG_NOT_SUPPORTED) {
                Log.e("TTS", "This Language is not supported");
            } else {
                btnSpeak.setEnabled(true);
                speakOut();

            }

        } else {
            Log.e("TTS", "Initilization Failed!");
        }

    }

    private void speakOut() {

        String text = txtText.getText().toString();
        tts.speak(text, TextToSpeech.QUEUE_FLUSH, null);
    }

    public void onItemSelected(AdapterView<?> parent, View v, int position, long id) {

       textview.setText(itemsList.get(position));
    }

} 
```

我查看了 LogCat，但我不明白出了什么问题。`textView`仅在添加and后才开始引发异常`textView1`，但我无法弄清楚问题出在哪里。

这是来自 LogCat 的错误：

```
06-07 00:12:58.119: E/AndroidRuntime(12887): FATAL EXCEPTION: main
06-07 00:12:58.119: E/AndroidRuntime(12887): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.testotspeech/com.testotspeech.AndroidTestToSpeechActivity}: java.lang.ClassCastException: com.testotspeech.AndroidTestToSpeechActivity
06-07 00:12:58.119: E/AndroidRuntime(12887):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2787)
06-07 00:12:58.119: E/AndroidRuntime(12887):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2803)
06-07 00:12:58.119: E/AndroidRuntime(12887):    at android.app.ActivityThread.access$2300(ActivityThread.java:135)
06-07 00:12:58.119: E/AndroidRuntime(12887):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2136)
06-07 00:12:58.119: E/AndroidRuntime(12887):    at android.os.Handler.dispatchMessage(Handler.java:99)
06-07 00:12:58.119: E/AndroidRuntime(12887):    at android.os.Looper.loop(Looper.java:144)
06-07 00:12:58.119: E/AndroidRuntime(12887):    at android.app.ActivityThread.main(ActivityThread.java:4937)
06-07 00:12:58.119: E/AndroidRuntime(12887):    at java.lang.reflect.Method.invokeNative(Native Method)
06-07 00:12:58.119: E/AndroidRuntime(12887):    at java.lang.reflect.Method.invoke(Method.java:521)
06-07 00:12:58.119: E/AndroidRuntime(12887):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
06-07 00:12:58.119: E/AndroidRuntime(12887):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
06-07 00:12:58.119: E/AndroidRuntime(12887):    at dalvik.system.NativeStart.main(Native Method)
06-07 00:12:58.119: E/AndroidRuntime(12887): Caused by: java.lang.ClassCastException: com.testotspeech.AndroidTestToSpeechActivity
06-07 00:12:58.119: E/AndroidRuntime(12887):    at com.testotspeech.AndroidTestToSpeechActivity.onCreate(AndroidTestToSpeechActivity.java:41)
06-07 00:12:58.119: E/AndroidRuntime(12887):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1069)
06-07 00:12:58.119: E/AndroidRuntime(12887):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2751)
06-07 00:12:58.119: E/AndroidRuntime(12887):    ... 11 more 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T21:03:19.197

将此行更改`textview.setText(itemsList<position>);`
为：`textview.setText(itemsList.get(position));`
这是文档：[ArrayList.get(...)](http://developer.android.com/reference/java/util/ArrayList.html#get%28int%29)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T21:23:39.140

第 41 行：`spinner.setOnItemSelectedListener((OnItemSelectedListener) this);`
在这一行中，您将当前活动 ( `this`) 设置为`OnItemSelectedListener`微调器，但您的活动没有实现该接口。

# azure - 使用 Windows Azure 队列锁定队列中的消息

> ID：10922216
> 
> 赞同：3
> 
> 时间：2012-06-06T21:00:35.507
> 
> 标签：azure, message-queue, azure-storage, azure-queues

我正在使用 Windows Azure 消息队列。我想知道当我收到消息时是否有一种方法可以锁定队列中的消息？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-06T21:04:13.677

当您从队列中检索消息时，它会被标记为*不可见*，直到您将其删除（或达到超时期限）。当它被标记为不可见时，没有其他人看到该消息。我想这就像你将要得到的那样接近“锁定”。

如果在处理过程中您觉得需要更多时间，您可以修改消息并延长隐身超时。

您确实需要关注 Windows Azure 队列的*幂等操作*：假设任何给定消息可能会被处理多次：

*   处理超出了不可见超时，因此其他一些工作人员收到了消息
*   VM 实例在处理消息时崩溃，导致它重新出现在队列中并再次得到处理

# java - 通过 jdbc 通过准备好的语句传递 SQL 命令时出错

> ID：10922217
> 
> 赞同：2
> 
> 时间：2012-06-06T21:00:40.247
> 
> 标签：java, jdbc, prepared-statement, sqlexception

我正在尝试创建程序在运行时获取行数和列数的表。

这是代码：

```
String sql = 
  "CREATE TABLE if not exists itemset (?";
up1 = con.prepareStatement(sql);
for(int j=1; j < ccolumns; j++) {
  sql += ",?";
}
sql += ")";
System.out.println(sql);
for(int j=1; j < ccolumns+1; j++) {
  System.out.println(j);
  up1.setString(j, "item"+j+" TINYINT(10)");
}
up1.executeQuery(); 
```

错误是

`Parameter index out of range (2 > number of parameters, which is 1)`

它发生在第二次迭代期间的 setString 行中

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T21:05:42.097

尝试移动

```
up1 = con.prepareStatement(sql); 
```

后

```
System.out.println(sql); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T21:08:55.590

`String`您要修复的第一件事是，当您想更改它时，请不要使用实例。`String`实例是不可变的，当您修改已经创建的时`String`，会创建新的修改实例并且它不是免费的。您应该为此使用`StringBuilder`具有允许修改它而无需创建新实例的实例方法。我建议您`StringBuilder`在修改时始终使用`String`. 其次，你打电话`con.prepareStatement(sql)`，然后你修改它的 sql 字段。这不好不是吗？因此，仅在使用 String 之后添加它。

```
String sql = 
  "CREATE TABLE if not exists itemset (?";
for(int j=1; j < ccolumns; j++) {
  sql += ",?";
}
sql += ")";
System.out.println(sql);
up1 = con.prepareStatement(sql);
for(int j=1; j < ccolumns+1; j++) {
  System.out.println(j);
  up1.setString(j, "item"+j+" TINYINT(10)");
}
up1.executeQuery(); 
```

你不能`prepareStatement`用给定的调用`String`然后修改它。

* * *

但是更清洁和更快的尝试这样做

```
StringBuilder sqlStatement = new StringBuilder(
      "CREATE TABLE if not exists itemset (?");
    for(int j=1; j < ccolumns; j++) {
      sqlStatement.append(",?");
    }
    sqlStatement.append(")");
    up1 = con.prepareStatement(sqlStatement.toString());
    for(int j=1; j < ccolumns+1; j++) {
      System.out.println(j);
      up1.setString(j, "item"+j+" TINYINT(10)");
    }
    up1.executeQuery(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-06T21:16:26.043

虽然我没有验证，但我相信 Andriy 的回答是正确的。此外，您可能需要考虑使用[StringBuilder](http://docs.oracle.com/javase/6/docs/api/java/lang/StringBuilder.html)来累积字符串，因为它们的重量较轻。更新了下面的代码。

```
 StringBuilder sql = new StringBuilder("CREATE TABLE if not exists itemset (?");
    for (int j = 1; j < ccolumns; j++) {
        sql.append(",?");
    }
    sql.append(")");
    System.out.println(sql.toString());
    up1 = con.prepareStatement(sql.toString());
    for (int j = 1; j < ccolumns + 1; j++) {
        System.out.println(j);
        up1.setString(j, "item" + j + " TINYINT(10)");
    }
    up1.executeQuery(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T21:16:06.207

`PreparedStatement`不能用于问题中的 DDL 查询`CREATE TABLE`。

传递的值`setString()`在生成的 SQL 中被转义，导致发送到数据库的查询无效。

当仅给出列数时，只需创建 CREATE TABLE 语句（`StringBuilder`如其他人建议的那样使用 a ）并使用 plain 执行它`Statement`，不需要 a `PreparedStatement`：

```
String getCreateTableSql(int columns) {
  StringBuilder sql = new StringBuilder("CREATE TABLE IF NOT EXISTS itemset (");
  for (int i = 0; i < columns; i++) {
    if (i > 0) {
      sql.append(", ");
    }
    sql.append("item").append(i + 1).append(" TINYINT(10)");
  }
  sql.append(")");
  return sql.toString();
} 
```

对于 4 列，这将输出：

`CREATE TABLE IF NOT EXISTS itemset (item1 TINYINT(10), item2 TINYINT(10), item3 TINYINT(10), item4 TINYINT(10))`

# mysql - 使用 JOIN sql 查询

> ID：10922220
> 
> 赞同：1
> 
> 时间：2012-06-06T21:00:54.053
> 
> 标签：mysql

我想在下面的 SQL 查询中使用 JOIN 而不是 IN。我不知道该怎么做。

```
SELECT * FROM shop_orders WHERE 
id IN (SELECT orders_id FROM shop_orders_data WHERE closed='1' /*AND backorder='0'*/  AND   exhibition_id='389' AND 
exhibition_id IN (SELECT id FROM shop_exhibitions WHERE 
country_id IN (SELECT id FROM countries WHERE id='72')) AND in_country = '72' AND 
exhibition_id IN (SELECT id FROM shop_exhibitions WHERE start<=1336946400 AND end>1336600800)) AND 
id IN (SELECT orders_id FROM shop_orders_products WHERE 
products_id IN (SELECT id FROM shop_products WHERE artno='120000' OR name LIKE '%120000%')) AND   created>=1333231200 AND created<1333663200 ORDER BY created DESC 
```

我试过这个：

```
SELECT 
s.* 
FROM 
shop_orders s 
INNER JOIN shop_orders_data od ON s.id=od.orders_id
INNER JOIN shop_exhibitions se ON od.exhibition_id=se.id 
INNER JOIN countries co ON se.country_id=co.id 
INNER JOIN shop_orders_products sop ON s.id=sop.orders_id 
INNER JOIN shop_products sp 
 ON sop.products_id=sp.id 
WHERE od.closed=1
AND ( sp.artno='120000' or sp.name LIKE '%120000%' )
AND ( od.exhibition_id='389')
AND ( od.in_country = '72')
AND ( se.start <=1336946400)
AND ( se.end >1336600800)
AND ( se.created>=1333231200)
AND ( se.created<1333663200)
ORDER BY `s`.`created` DESC 
```

我这个对吗？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T21:22:49.623

看看这是否有效（并研究代码以了解它是如何工作的）：

```
SELECT * 
FROM shop_orders so
JOIN shop_orders_data sod ON (
    (so.id = sod.orders_id)
    AND (sod.closed = '1')
    /*AND (sod.backorder = '0') */
    AND (sod.exhibition_id = '389')
    AND (sod.in_country = '72')
)
JOIN shop_exhibitions se ON (
    (sod.exhibition_id = se.id)
    AND (se.start <= 1336946400)
    AND (se.end > 1336600800)
)
JOIN countries c ON (
    (se.country_id = c.id)
    AND (c.id = '72')
)
JOIN shop_orders_products sop ON (
    (so.id = sop.orders_id)
)
JOIN shop_products sp ON (
    (sop.products_id = sp.id)
    AND ((sp.artno='120000') OR (sp.name LIKE '%120000%'))
)
WHERE (so.created >= 1333231200) AND (so.created < 1333663200)
ORDER BY so.created DESC; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T21:15:34.790

[连接语法](http://www.tizag.com/sqlTutorial/sqljoin.php)的工作方式如下：

```
SELECT field1,field2,field3
FROM FirstTable 
    JOIN SecondTable ON (FirstTable.PrimaryKey = SecondTable.ForeignKey)
    JOIN ThirdTable ON (FirstTable.PrimaryKey = ThirdTable.ForeignKey) 
```

尝试将此方法应用于您的查询。

# bash - 如何创建和保存 bash 脚本

> ID：10922222
> 
> 赞同：3
> 
> 时间：2012-06-06T21:01:08.507
> 
> 标签：bash, unix

老师从来没有向我们解释过有关 unix 和 bash 的任何事情。他告诉我们一些关于历史的事情。然后他说如何在一个叫putty的程序中填写IP地址，也就是我们在服务器上工作时使用的shell。他基本上给了我们7个系列的练习。我们还有一本非常没用的书。我主要使用互联网和 SO 来帮助自己，以及我从 DOS 和 man/info 页面中知道的命令。

问题是，制作脚本的**首选**文本编辑器是什么？互联网说任何都可以，但我只知道`cat`。然后，我该如何开始呢？我需要的是速成课程或其他东西。对不起，我知道这不是在这里问的最好的问题，但这是我能想到的。不要怪我，但请不要抨击老师（双关语）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-06T21:07:28.573

尝试`vi`用作您的文本编辑器。切换到您希望保存脚本的目录，然后输入“vi myScript.sh”。这将启动 vi 文本编辑器。您可以在此处输入所有 shell 命令。

这是 vi 备忘单的链接 - [http://linuxfordummies.org/tag/vi/](http://linuxfordummies.org/tag/vi/)

一旦你进入 vi，你可以在每一行输入一个命令，你可以使用 enter 移动到下一行。输入脚本后，按键盘上的 : 打开 vi 提示。在屏幕底部出现 :（冒号）提示后，输入`wq`write/quit。这会将 myScript.sh 保存到您开始的目录中。然后您应该能够通过调用来执行脚本`myScript.sh`

我希望这会有所帮助，祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T21:11:29.193

您可以使用 vi 文本编辑器，但如果您刚开始，它可能会有点棘手。如果您使用 GNOME 环境，我会尝试 gedit

# php - PHP preg_match 功能失常

> ID：10922224
> 
> 赞同：0
> 
> 时间：2012-06-06T21:01:15.817
> 
> 标签：php, preg-match

我有这段代码

```
public function onlyLetters($string) {
    if(preg_match("/[a-zA-Z]/", $string)) {
        return true;
    } else {
        return false;
    }
} 
```

但它总是返回false，原因是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T21:04:06.843

您的字符串很可能不包含您期望的内容，并且没有一个大写或小写的 az 字母。

或 - 您没有正确处理返回值

如果您检查这些假设，您可能会自己解决它:)

# c# - 具有相同 POCO 类的多个表

> ID：10922225
> 
> 赞同：5
> 
> 时间：2012-06-06T21:01:25.087
> 
> 标签：c#, entity-framework, entity-framework-4.1, ef-code-first

我有一个现有的数据库，其中有四个相同且不相关的表。

我想使用相同的 POCO 类来描述所有四个，而不必创建同一类的重复项。

这是我的上下文到目前为止的样子：

```
class StatsContext : DbContext
{
    // [MagicTableAttribute( "map_ratings_vsh" )] -- does something like this exist?
    public DbSet<MapRatings> MapRatingsVSH { get; set; }

    public DbSet<MapRatings> MapRatingsJump { get; set; }

    // 2 more tables using same class
}

class MapRatings
{
    public string SteamID { get; set; }

    public string Map { get; set; }

    public int Rating { get; set; }

    [Column( "rated" )]
    public DateTime Time { get; set; }
} 
```

我的问题是现有表被命名为“map_ratings_vsh”和“map_ratings_jump”，我不能使用数据注释`TableAttribute`，因为它只能在类上使用。

有没有其他方法——也许是流利的 api——来描述我的模式？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-07T00:54:15.957

我发现解决这个问题的一种方法是使用继承。

```
[Table("map_ratings_vsh")]
public class MapRatingsVSH : MapRatingsBase {}

[Table("map_ratings_jump")]
public class MapRatingsJump : MapRatingsBase {}

public class MapRatingsBase
{
    public string SteamID { get; set; }

    public string Map { get; set; }

    public int Rating { get; set; }

    [Column( "rated" )]
    public DateTime Time { get; set; }
} 
```

然后你可以让你的 DbContext 看起来像：

```
public class StatsContext : DbContext
{

    public DbSet<MapRatingsVSH> MapRatingsVSH { get; set; }

    public DbSet<MapRatingsJump> MapRatingsJump { get; set; }

} 
```

EF 不应该有任何问题，即使实现将在同一个地方 ( `MapRatingsBase`) ，这是两个不同的表

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-06T21:15:32.763

您可以使用 fluent api 将一些属性映射到一个表，将其他属性映射到另一个表，如下所示：

```
modelBuilder.Entity<TestResult>()
    .Map(m =>
    {
        m.Properties(t => new { /* map_ratings_vsh columns */ });
        m.ToTable("map_ratings_vsh");
    })
    .Map(m =>
    {
        m.Properties(t => new { /* map_ratings_jump columns */ });
        m.ToTable("map_ratings_jump");
    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T21:11:44.507

我过去处理这个问题的（hacky）方法是使用存储过程或视图返回数据，然后在 DbContext 实现上提供一个“AddEntity”或“SaveEntity”方法，以保留相关实体

# jquery - Internet Explorer 中的 History.js 哈希回退和 pushState 问题

> ID：10922227
> 
> 赞同：7
> 
> 时间：2012-06-06T21:01:29.270
> 
> 标签：jquery, internet-explorer, url, pushstate, history.js

我正在实现一个网站，当新部分通过 ajax 加载到首页时，它使用 History.js 动态设置其 url。

这似乎运作良好，但 History.js 在 Internet Explorer 中作为后备创建的 url 中的哈希部分存在问题。

以下是页面上使用 jquery 创建的链接示例：

```
 function connect_browse_buttons(){
    $('.browselink').each(function(){
        $(this).click(function(){
            var action = $(this).attr('name');
            action = action.substring( ('action_browse').length );
            browsetype = action;
            if (isIE){
                // remove data object and title to avoid use of SUIDs by History.js in IE
                History.pushState(null, null, '/public/' + action);
            } else {
                History.pushState({oldurl: History.getState()['url']}, "Example " + action, config.wwwroot + "public/" + action);
            }
            return false;
        });
    });
} 
```

.htaccess 文件将诸如[http://example.com/public/category_a](http://example.com/public/category_a)之类的任何 url 重定向到[http://example.com](http://example.com)，其中 javascript 解析 url 并通过 changeState 处理程序中的 ajax 请求加载适当的部分。

javascript 检查网址，例如

```
http://example.com/public/category_a 
```

AND 对于在 Internet Explorer 中创建的等效后备 URL，即

```
http://example.com/#public/category_a 
```

一切正常 - 所以：

**在 Firefox中，如果我在站点的根目录**[http://example.com](http://example.com)打开站点，然后单击上面的链接，则会加载内容（在 changeState 处理程序中），并且 url 由 History 设置。 pushState 为：

```
http://example.com/public/category_a 
```

如果我然后单击另一个链接，则 URL 设置为，例如：

```
http://example.com/public/category_b 
```

**在 IE**中，如果我在站点的根目录打开站点，然后单击一个链接，如上所述，内容会加载，并且 url 使用哈希设置为：

```
http://example.com/#public/category_a 
```

如果我然后单击下一个链接，则 URL 设置为：

```
http://example.com/#public/category_b 
```

**当我在 IE 中打开一个在 Firefox 中添加书签的页面时，就会出现问题**，并且 URL 中没有哈希值。让我们以我们通常的例子为例：

```
http://example.com/public/category_a 
```

如果我直接在 IE 中打开此 url，通过书签或将 url 粘贴到浏览器地址栏中，.htaccess 重定向成功，js 文件解析 url 并加载内容。但是，现在如果我单击 category_b 链接，则该 URL 由 History.pushState 设置为：

```
http://example.com/public/category_a#./category_b 
```

我真正想要的是将网址设置为：

```
http://example.com/#public/category_b 
```

然而，History.js 似乎将整个前一个 url 作为后续 pushStates 的基本 url。我尝试在 History.pushState 中设置绝对网址，但没有成功。正如您在上面的代码块中看到的，我有一个特定于 IE 的 pushState 语句。我尝试过以各种方式配置它。如何让 History pushState 识别：

```
http://example.com 
```

作为 url 的基础部分，应该将哈希部分附加到哪个部分？还是有比我上面描述的方法更好的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-10-16T04:12:40.803

AFAIK，历史 API 将始终使用为初始页面加载请求的整个 URL（无哈希）。页面加载后，您可以使用 history api 更改该初始 URL 之后的内容，或者您​​可以使用哈希更改来更改该初始 URL 之后的内容，但是如果不重新加载整个页面就无法修改它。

我知道实现您正在寻找的唯一选择是让您的服务器将所有 URL 重定向/重写到您想要的基本 URL，然后将您的路径、文件名、参数、哈希等传递到您的客户端路由器/控制器。我必须建议不要这样做，因为（没有太多细节）来自您在 Facebook 上共享的网站的链接将始终存在，`http://example.com/`或者无论您的基本 URL 是什么。

在我看来，在我的实践中，我不使用历史 API，而是使用哈希更改，因为它适用于任何地方。这样做并不总是很漂亮，但我认为除了哈希之外，您还应该努力为 URL 提供适当的 Web 服务器响应。这是我的网站上的一个特别丑陋的 URL：[http](http://www.respectfulrevolution.org/road/videos/ian_barlow_finding_our_roots_forest#/road/videos/marcy_westerling_livingly_dying) ://www.respectfulrevolution.org/road/videos/ian_barlow_finding_our_roots_forest#/road/videos/marcy_westerling_livingly_dying ，但是当在浏览器中加载时，服务器会以您在此处看到的内容进行响应：[http](http://www.respectfulrevolution.org/road/videos/ian_barlow_finding_our_roots_forest) ://www.respectfulrevolution.org/road/videos/ian_barlow_finding_our_roots_forest然后客户端控制器加载您在此之后看到的内容：[http ://www.respectfulrevolution.org/#/road/videos/marcy_westering_livingly_dying](http://www.respectfulrevolution.org/#/road/videos/marcy_westering_livingly_dying) 这应该加载相同：[http ://www.respectfulrevolution.org/road/videos/marcy_westering_livingly_dying](http://www.respectfulrevolution.org/road/videos/marcy_westering_livingly_dying)

# sql-server-2000 - SQL Server：选择插入的列太多

> ID：10922229
> 
> 赞同：0
> 
> 时间：2012-06-06T21:01:30.017
> 
> 标签：sql-server-2000

我正在尝试运行此查询，但我不断收到此错误：

> INSERT 语句的选择列表包含比插入列表更多的项目。SELECT 值的数量必须与 INSERT 列的数量相匹配。

这个错误是在我尝试执行 INSERT INTO #tempTable SELECT.... 当我每个临时表只有 2 列时它工作得很好，但是现在我已经添加了第三个，它一直给我这个错误，即使它似乎正在选择 3 列插入到具有 3 列的表中。

整个查询试图在不同的表上获取一些列值（客户 ID、联系人和销售人员 ID），但问题来自需要根除重复的客户 ID 并确保只有 1 个销售人员和 1 个联系人出现在每个客户面前。如果不是销售员 ID，查询将完美运行。这是我到目前为止所拥有的：

```
if object_id('tempdb..#tempTable') IS NOT NULL DROP TABLE #tempTable
if object_id('tempdb..#tempTable2') IS NOT NULL DROP TABLE #tempTable2

CREATE TABLE #tempTable(
CustomerID int,
ContactName nvarchar(50),
SalesmenID nvarchar(4)
)

CREATE TABLE #tempTable2(
CustomerID int,
ContactName nvarchar(50),
SalesmenID nvarchar(4)
)

INSERT INTO #tempTable 
    (CustomerID, ContactName,SalesmenID)
    SELECT Customers.[Customer ID],Salesmen.[4 Letter ID],
    CASE([Customer Contact].defaultprintonorder) 
        WHEN 0 
        THEN 'zzzzzzz_NOCONTACT'
        ELSE
        [Customer Contact].[Contact Name]
        END as ContactName
    From Customers
    LEFT JOIN [Customer Contact] on Customers.[Customer ID]=[Customer Contact].[Customer ID]
    Left Join [Customer Salesmen] On Customers.[Customer ID]=[Customer Salesmen].[Customer ID]
    INNER JOIN Salesmen on [Customer Salesmen].[Salesman Name]=Salesmen.[Salesman Name]
WHERE Customers.[Customer ID] NOT IN(SELECT CustomerID FROM #tempTable)
GROUP BY Customers.[Customer ID], [Contact Name], DefaultPrintOnOrder

INSERT INTO #tempTable2  (CustomerID, ContactName,SalesmenID)
SELECT distinct CustomerID, '', SalesmenID FROM #tempTable 

UPDATE  #TempTable2 SET 
    #tempTable2.CustomerID=#tempTable.CustomerID, 
    #tempTable2.ContactName=#tempTable.ContactName
FROM 
    #TempTable2
    INNER JOIN #TempTable ON #TempTable2.CustomerID=#TempTable.CustomerID

SELECT Salesmen.[4 Letter ID],
       [Customers].[Customer ID], 
       [Customer Contact].[Contact Name]
FROM Customers
Right JOIN #TempTable2 ON
    Customers.[Customer ID]=#TempTable2.CustomerID
Right JOIN [Customer Salesmen] ON
    #TempTable2.CustomerID=[Customer Salesmen].[Customer ID]
INNER JOIN  
    [Salesmen] ON
    [Customer Salesmen].[Salesman Name]=Salesmen.[Salesman Name]
LEFT JOIN 
    [Customer Contact] ON
    #TempTable2.[CustomerID]=[Customer Contact].[Customer ID] 
```

**编辑：** 我将 SalesmenID 添加到插入中，但现在我收到此错误消息 3 次：

> 列名“SalesmenID”无效。

它为 temptable 插入出现一次，为 temptable2 插入出现两次

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T21:07:41.847

您正在尝试在 2 个字段（CustomerID、ContactName）中存储 3 个值（Customers.[Customer ID]、Salesmen.[4 Letter ID]、ContactName）

```
 INSERT INTO #tempTable 
    (CustomerID, ContactName)
    SELECT Customers.[Customer ID],Salesmen.[4 Letter ID],
    CASE([Customer Contact].defaultprintonorder) 
    WHEN 0 
    THEN 'zzzzzzz_NOCONTACT'
    ELSE
    [Customer Contact].[Contact Name]
    END as ContactName 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T21:05:09.430

你确定问题出在你指出的地方吗？

此插入有 2 个目标列和 3 个选择列：

```
INSERT INTO #tempTable 
    (CustomerID, ContactName)    -- 2 columns

    SELECT Customers.[Customer ID], --column 1
            Salesmen.[4 Letter ID], --column 2
    CASE([Customer Contact].defaultprintonorder) -- column 3!
        WHEN 0 
        THEN 'zzzzzzz_NOCONTACT'
        ELSE
        [Customer Contact].[Contact Name]
        END as ContactName
    From Customers... 
```

# python - Python 的 sum 与 NumPy 的 numpy.sum

> ID：10922231
> 
> 赞同：71
> 
> 时间：2012-06-06T21:01:38.893
> 
> 标签：python, performance, numpy, python-3.x

`sum`使用 Python 的本机函数和 NumPy 的性能和行为有什么区别`numpy.sum`？`sum`适用于 NumPy 的数组和`numpy.sum`Python 列表，它们都返回相同的有效结果（尚未测试溢出等边缘情况）但类型不同。

```
>>> import numpy as np
>>> np_a = np.array(range(5))
>>> np_a
array([0, 1, 2, 3, 4])
>>> type(np_a)
<class 'numpy.ndarray')

>>> py_a = list(range(5))
>>> py_a
[0, 1, 2, 3, 4]
>>> type(py_a)
<class 'list'>

# The numerical answer (10) is the same for the following sums:
>>> type(np.sum(np_a))
<class 'numpy.int32'>
>>> type(sum(np_a))
<class 'numpy.int32'>
>>> type(np.sum(py_a))
<class 'numpy.int32'>
>>> type(sum(py_a))
<class 'int'> 
```

**编辑：**我认为我在这里的实际问题是`numpy.sum`在 Python 整数列表上使用会比使用 Python 自己的更快`sum`吗？

此外，使用 Python integer 与 scalar 有什么影响（包括性能）`numpy.int32`？例如，对于，如果 的类型是 Python 整数或`a += 1`，是否存在行为或性能差异？我很好奇使用 NumPy 标量数据类型是否更快，例如在 Python 代码中添加或减去很多值。`a``numpy.int32``numpy.int32`

为了澄清起见，我正在研究生物信息学模拟，其中部分包括将多维`numpy.ndarray`s 折叠成单个标量和，然后对其进行额外处理。我正在使用 Python 3.2 和 NumPy 1.6。

提前致谢！

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2012-06-06T21:43:54.530

我很好奇并计时了。`numpy.sum`numpy 数组似乎要快得多，但列表要慢得多。

```
import numpy as np
import timeit

x = range(1000)
# or 
#x = np.random.standard_normal(1000)

def pure_sum():
    return sum(x)

def numpy_sum():
    return np.sum(x)

n = 10000

t1 = timeit.timeit(pure_sum, number = n)
print 'Pure Python Sum:', t1
t2 = timeit.timeit(numpy_sum, number = n)
print 'Numpy Sum:', t2 
```

结果何时`x = range(1000)`：

```
Pure Python Sum: 0.445913167735
Numpy Sum: 8.54926219673 
```

结果何时`x = np.random.standard_normal(1000)`：

```
Pure Python Sum: 12.1442425643
Numpy Sum: 0.303303771848 
```

我正在使用 Python 2.7.2 和 Numpy 1.6.1

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2018-04-18T20:29:50.853

> [...] 我的 [...] 问题是`numpy.sum`在 Python 整数列表上使用会比使用 Python 自己的更快`sum`吗？

这个问题的答案是：不。

Pythons sum 在列表上会更快，而 NumPys sum 在数组上会更快。我实际上做了一个基准测试来显示时间（Python 3.6，NumPy 1.14）：

```
import random
import numpy as np
import matplotlib.pyplot as plt

from simple_benchmark import benchmark

%matplotlib notebook

def numpy_sum(it):
    return np.sum(it)

def python_sum(it):
    return sum(it)

def numpy_sum_method(arr):
    return arr.sum()

b_array = benchmark(
    [numpy_sum, numpy_sum_method, python_sum],
    arguments={2**i: np.random.randint(0, 10, 2**i) for i in range(2, 21)},
    argument_name='array size',
    function_aliases={numpy_sum: 'numpy.sum(<array>)', numpy_sum_method: '<array>.sum()', python_sum: "sum(<array>)"}
)

b_list = benchmark(
    [numpy_sum, python_sum],
    arguments={2**i: [random.randint(0, 10) for _ in range(2**i)] for i in range(2, 21)},
    argument_name='list size',
    function_aliases={numpy_sum: 'numpy.sum(<list>)', python_sum: "sum(<list>)"}
) 
```

有了这些结果：

```
f, (ax1, ax2) = plt.subplots(1, 2, sharey=True)
b_array.plot(ax=ax1)
b_list.plot(ax=ax2) 
```

[![在此处输入图像描述](../Images/53eb27b330b334c454971aae60413440.png)](https://i.stack.imgur.com/RjPZ3.png)

左：在 NumPy 数组上；右：在 Python 列表中。请注意，这是一个对数图，因为基准测试涵盖了非常广泛的值。但是对于定性结果：较低意味着更好。

这表明对于列表，Python`sum`总是更快，而数组上`np.sum`的`sum`方法会更快（除了非常短的数组，其中 Python`sum`更快）。

以防万一您有兴趣将它们相互比较，我还制作了一个包含所有这些的情节：

```
f, ax = plt.subplots(1)
b_array.plot(ax=ax)
b_list.plot(ax=ax)
ax.grid(which='both') 
```

[![在此处输入图像描述](../Images/70262c625273bbde807d014b7d6ea244.png)](https://i.stack.imgur.com/PzcPW.png)

有趣的是，`numpy`可以在数组上与 Python 和列表竞争的点大约是 200 个元素！请注意，这个数字可能取决于很多因素，例如 Python/NumPy 版本，......不要太从字面上理解。

没有提到的是这种差异的原因（我的意思是大规模差异不是短列表/数组的差异，其中函数只是具有不同的常量开销）。假设 CPython，Python 列表是 C（语言 C）指向 Python 对象（在本例中为 Python 整数）的指针数组的包装器。这些整数可以看作是 C 整数的包装器（实际上并不正确，因为 Python 整数可以任意大，因此它不能简单地使用**一个**C 整数，但它足够接近）。

例如，像`[1, 2, 3]`这样的列表（示意性地，我省略了一些细节）存储如下：

[![在此处输入图像描述](../Images/3c687d3ff779611fdc5ba1a115e14c54.png)](https://i.stack.imgur.com/bMoB6.png)

然而，NumPy 数组是包含 C 值的 C 数组的包装器（在这种情况下`int`或`long`取决于 32 位或 64 位并取决于操作系统）。

所以一个像这样的 NumPy 数组`np.array([1, 2, 3])`看起来像这样：

[![在此处输入图像描述](../Images/6abaf754ace9d12717790a90e9cf80e5.png)](https://i.stack.imgur.com/ewiE6.png)

接下来要了解的是这些函数是如何工作的：

*   Pythons`sum`遍历可迭代对象（在本例中为列表或数组）并添加所有元素。
*   NumPys`sum` **方法**遍历存储的 C 数组并添加这些 C 值，最后将该值包装在 Python 类型中（在本例中为`numpy.int32`(or `numpy.int64`) 并返回它。
*   NumPys`sum` **函数**将输入转换为一个`array`（至少如果它不是一个数组），然后使用 NumPy`sum` **方法**。

显然，从 C 数组添加 C 值比添加 Python 对象快得多，这就是 NumPy 函数**可以**更快的原因（参见上面的第二张图，数组上的 NumPy 函数远远超过了大型数组的 Python 总和）。

但是将 Python 列表转换为 NumPy 数组相对较慢，然后您仍然必须添加 C 值。这就是为什么对于**列表**，Python`sum`会更快。

`sum`唯一剩下的悬而未决的问题是为什么 Python`array`如此缓慢（它是所有比较函数中最慢的）。这实际上与 Python 的 sum 简单地迭代您传入的任何内容这一事实有关。如果是列表，它会获取存储的**Python 对象**，但如果是一维 NumPy 数组，则没有存储的 Python 对象，只有 C 值，因此 Python&NumPy 必须为每个元素创建一个 Python 对象（an`numpy.int32`或`numpy.int64`），然后必须添加这些 Python 对象。为 C 值创建包装器使它变得非常慢。

> 此外，使用 Python 整数与标量 numpy.int32 有何影响（包括性能）？例如，对于 a += 1，如果 a 的类型是 Python 整数或 numpy.int32，是否存在行为或性能差异？

我做了一些测试，对于标量的加减法，你绝对应该坚持使用 Python 整数。即使可能有一些缓存正在进行，这意味着以下测试可能并不完全具有代表性：

```
from itertools import repeat

python_integer = 1000
numpy_integer_32 = np.int32(1000)
numpy_integer_64 = np.int64(1000)

def repeatedly_add_one(val):
    for _ in repeat(None, 100000):
        _ = val + 1

%timeit repeatedly_add_one(python_integer)
3.7 ms ± 71.2 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)

%timeit repeatedly_add_one(numpy_integer_32)
14.3 ms ± 162 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)

%timeit repeatedly_add_one(numpy_integer_64)
18.5 ms ± 494 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)

def repeatedly_sub_one(val):
    for _ in repeat(None, 100000):
        _ = val - 1

%timeit repeatedly_sub_one(python_integer)
3.75 ms ± 236 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
%timeit repeatedly_sub_one(numpy_integer_32)
15.7 ms ± 437 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
%timeit repeatedly_sub_one(numpy_integer_64)
19 ms ± 834 µs per loop (mean ± std. dev. of 7 runs, 100 loops each) 
```

使用 Python 整数进行标量运算比使用 NumPy 标量快 3-6 倍。我没有检查为什么会这样，但我的猜测是 NumPy 标量很少使用并且可能没有针对性能进行优化。

如果您实际执行两个操作数都是 numpy 标量的算术运算，则差异会变得更小：

```
def repeatedly_add_one(val):
    one = type(val)(1)  # create a 1 with the same type as the input
    for _ in repeat(None, 100000):
        _ = val + one

%timeit repeatedly_add_one(python_integer)
3.88 ms ± 273 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
%timeit repeatedly_add_one(numpy_integer_32)
6.12 ms ± 324 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
%timeit repeatedly_add_one(numpy_integer_64)
6.49 ms ± 265 µs per loop (mean ± std. dev. of 7 runs, 100 loops each) 
```

然后它只慢了2倍。

* * *

如果你想知道为什么我`itertools.repeat`在这里使用，而我本来可以简单地使用它`for _ in range(...)`。原因是`repeat`速度更快，因此每个循环的开销更少。因为我只对加/减时间感兴趣，所以实际上最好不要让循环开销与时间混淆（至少不是那么多）。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2016-06-06T20:42:28.253

请注意，多维 numpy 数组上的 Python sum 只会沿第一个轴执行求和：

```
sum(np.array([[[2,3,4],[4,5,6]],[[7,8,9],[10,11,12]]]))
Out[47]: 
array([[ 9, 11, 13],
       [14, 16, 18]])

np.sum(np.array([[[2,3,4],[4,5,6]],[[7,8,9],[10,11,12]]]), axis=0)
Out[48]: 
array([[ 9, 11, 13],
       [14, 16, 18]])

np.sum(np.array([[[2,3,4],[4,5,6]],[[7,8,9],[10,11,12]]]))
Out[49]: 81 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-06-06T21:19:19.367

Numpy 应该快得多，尤其是当您的数据已经是一个 numpy 数组时。

Numpy 数组是标准 C 数组之上的一个薄层。当 numpy sum 对此进行迭代时，它不会进行类型检查并且速度非常快。速度应该与使用标准 C 进行操作相当。

相比之下，使用 python 的 sum 它必须首先将 numpy 数组转换为 python 数组，然后遍历该数组。它必须进行一些类型检查，并且通常会比较慢。

python sum 比 numpy sum 慢的确切数量没有很好地定义，因为与在 python 中编写自己的 sum 函数相比，python sum 将是一个稍微优化的函数。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-04-07T15:35:09.880

这是[Akavall 对上述答案的](https://stackoverflow.com/a/10922744/1925257)扩展。从该答案中，您可以看到对象的执行速度`np.sum`更快`np.array`，而对象的`sum`执行速度更快`list`。对此进行扩展：

`np.sum`在为一个`np.array`对象而跑时**。** `sum`对于一个`list`对象，他们似乎并驾齐驱。

```
# I'm running IPython

In [1]: x = range(1000) # list object

In [2]: y = np.array(x) # np.array object

In [3]: %timeit sum(x)
100000 loops, best of 3: 14.1 µs per loop

In [4]: %timeit np.sum(y)
100000 loops, best of 3: 14.3 µs per loop 
```

上面，`sum`比*快*一点`np.array`，虽然有时我也看到 `np.sum`时间是`14.1 µs`。但大多数情况下，它是`14.3 µs`.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-08-29T15:20:23.137

如果你使用 sum()，那么它给出

```
a = np.arange(6).reshape(2, 3)
print(a)
print(sum(a))
print(sum(sum(a)))
print(np.sum(a))

>>>
[[0 1 2]
 [3 4 5]]
[3 5 7]
15
15 
```

# scala - 对于可能为空的 Seq，使用 Option[T] 的最小值/最大值？

> ID：10922237
> 
> 赞同：63
> 
> 时间：2012-06-06T21:02:20.573
> 
> 标签：scala, scala-collections

我正在做一些 Scala 体操，`Seq[T]`我试图在其中找到“最小”元素。这就是我现在所做的：

```
val leastOrNone = seq.reduceOption { (best, current) =>
    if (current.something < best.something) current
    else best
} 
```

它工作正常，但我不太满意 - 这么简单的事情有点长，[我不太关心 "if"](http://www.antiifcampaign.com/)。使用`minBy`会更优雅：

```
val least = seq.minBy(_.something) 
```

...但是当序列为空时抛出异常`min`。`minBy`是否有一种惯用的、更优雅的方式来查找可能为空的列表中的最小元素作为`Option`?

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2012-06-06T21:35:42.030

```
seq.reduceOption(_ min _) 
```

做你想做的事？

* * *

编辑：这是一个包含您的示例`_.something`：

```
case class Foo(a: Int, b: Int)
val seq = Seq(Foo(1,1),Foo(2,0),Foo(0,3))
val ord = Ordering.by((_: Foo).b)
seq.reduceOption(ord.min)  //Option[Foo] = Some(Foo(2,0)) 
```

或者，作为通用方法：

```
def minOptionBy[A, B: Ordering](seq: Seq[A])(f: A => B) = 
  seq reduceOption Ordering.by(f).min 
```

你可以调用它`minOptionBy(seq)(_.something)`

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2018-10-02T20:50:56.200

开始`Scala 2.13`, [`minByOption`](https://www.scala-lang.org/api/2.13.x/scala/collection/immutable/List.html#minByOption[B](f:A=%3EB)(implicitcmp:scala.math.Ordering[B]):Option[A])/`maxByOption`现在是标准库的一部分，`None`如果序列为空，则返回：

```
seq.minByOption(_.something) 
```

```
List((3, 'a'), (1, 'b'), (5, 'c')).minByOption(_._1) // Option[(Int, Char)] = Some((1,b))
List[(Int, Char)]().minByOption(_._1)                // Option[(Int, Char)] = None 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-02-24T08:01:03.007

一个安全、紧凑`O(n)`的 Scalaz 版本：

```
xs.nonEmpty option xs.minBy(_.foo) 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-06-06T21:27:28.213

由于`O(nlogn)`复杂性，几乎没有任何较大列表的选项：

```
seq.sortBy(_.something).headOption 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2019-11-26T19:22:39.697

此外，它可以这样做

```
Some(seq).filter(_.nonEmpty).map(_.minBy(_.something)) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-06T21:18:07.120

这个怎么样？

```
import util.control.Exception._
allCatch opt seq.minBy(_.something) 
```

或者，更冗长，如果您不想吞下其他异常：

```
catching(classOf[UnsupportedOperationException]) opt seq.minBy(_.something) 
```

或者，您可以使用以下内容对所有集合进行拉皮条：

```
import collection._

class TraversableOnceExt[CC, A](coll: CC, asTraversable: CC => TraversableOnce[A]) {

  def minOption(implicit cmp: Ordering[A]): Option[A] = {
    val trav = asTraversable(coll)
    if (trav.isEmpty) None
    else Some(trav.min)
  }

  def minOptionBy[B](f: A => B)(implicit cmp: Ordering[B]): Option[A] = {
    val trav = asTraversable(coll)
    if (trav.isEmpty) None
    else Some(trav.minBy(f))
  }
}

implicit def extendTraversable[A, C[A] <: TraversableOnce[A]](coll: C[A]): TraversableOnceExt[C[A], A] =
  new TraversableOnceExt[C[A], A](coll, identity)

implicit def extendStringTraversable(string: String): TraversableOnceExt[String, Char] =
  new TraversableOnceExt[String, Char](string, implicitly)

implicit def extendArrayTraversable[A](array: Array[A]): TraversableOnceExt[Array[A], A] =
  new TraversableOnceExt[Array[A], A](array, implicitly) 
```

然后就写了`seq.minOptionBy(_.something)`。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-08-27T13:22:08.590

我之前也有同样的问题，所以我扩展了 Ordered 并实现了比较功能。这是示例：

```
 case class Point(longitude0: String, latitude0: String)  extends Ordered [Point]{

  def this(point: Point) = this(point.original_longitude,point.original_latitude)
  val original_longitude = longitude0
  val original_latitude = latitude0

  val longitude = parseDouble(longitude0).get 
  val latitude = parseDouble(latitude0).get  

  override def toString: String = "longitude: " +original_longitude +", latitude: "+ original_latitude

  def parseDouble(s: String):  Option[Double] = try { Some(s.toDouble) } catch { case _ => None }

  def distance(other: Point): Double =
    sqrt(pow(longitude - other.longitude, 2) + pow(latitude - other.latitude, 2))

 override def compare(that: Point): Int = {
  if (longitude < that.longitude)
    return -1
  else if (longitude == that.longitude && latitude < that.latitude)
    return -1
  else
    return 1
 }
} 
```

所以如果我有一个点序列，我可以要求 max 或 min 方法

```
 var points =  Seq[Point]()

val maxPoint = points.max
val minPoint = points.min 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-11-28T03:45:13.567

你总是可以做类似的事情：

```
case class Foo(num: Int)

val foos: Seq[Foo] = Seq(Foo(1), Foo(2), Foo(3))
val noFoos: Seq[Foo] = Seq.empty

def minByOpt(foos: Seq[Foo]): Option[Foo] =
  foos.foldLeft(None: Option[Foo]) { (acc, elem) => 
    Option((elem +: acc.toSeq).minBy(_.num)) 
  } 
```

然后像这样使用：

```
scala> minByOpt(foos)
res0: Option[Foo] = Some(Foo(1))

scala> minByOpt(noFoos)
res1: Option[Foo] = None 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-10-31T09:21:14.647

对于 scala < 2.13

```
Try(seq.minBy(_.something)).toOption 
```

对于 Scala 2.13

```
seq.minByOption(_.something) 
```

* * *

## 回答 #10

> 赞同：-4
> 
> 时间：2012-06-06T21:07:00.203

在 Haskell 中，您将[`minimumBy`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Foldable.html#v%3aminimumBy)调用包装为

```
least f x | Seq.null x = Nothing
          | otherwise  = Just (Seq.minimumBy f x) 
```

# python - 如何使子模块中的类在父模块的命名空间中可用？

> ID：10922243
> 
> 赞同：1
> 
> 时间：2012-06-06T21:02:38.590
> 
> 标签：python, import, module, namespaces, package

这是一个python模块。`foo`在`sys.path`.

```
foo\
    __init__.py
    bar\
        __init__.py
        base.py
            class Base(object)
        derived.py
            import foo.bar.base as base
            class Derived(base.Base) 
```

我还没有什么特别的事情发生。如果我想从模块中实例化**Derived**类`derived`，我可以很容易地做到这一点：

```
import foo.bar.derived as derived
print(derived.Derived()) 
```

但是，我只想导入`bar`模块并调用`bar.Derived()`，因为我计划在许多不同的模块中包含许多类，并且我不想处理所有这些触手可及的导入路径。我的理解是，我可以简单地将**Derived**导入模块的命名空间，方法是`bar`像这样修改我的项目：

```
foo\
    __init__.py
    bar\
        __init__.py
            from foo.bar.derived import Derived
        base.py
            class Base(object)
        derived.py
            import foo.bar.base as base
            class Derived(base.Base) 
```

现在我应该能够做到以下几点：

```
import foo.bar as bar
print(bar.Derived()) 
```

但是我收到一个 AttributeError 抱怨该`foo`模块没有名为的子模块`bar`：

```
test.py             (1): import foo.bar
foo\bar\__init__.py (1): from foo.bar.derived import Derived
foo\bar\derived.py  (1): import foo.bar.base as base

AttributeError: 'module' object has no attribute 'bar' 
```

事实上，我的原始测试代码（在顶部）也不起作用！一旦我尝试导入`foo.bar`，我就会收到错误。

我可以从这个错误中看到的是，在`__init__.py`导致`derived.py`之前执行的 import 语句`bar`已完全加载，因此它无法导入`bar`包含其自己的基类的模块（也 from ）。我来自 C++ 世界，超嵌套的命名空间不是完整的，简单的前向声明可以解决这个问题，但我被引导相信我正在寻找的东西是可能的，至少是一个在某种程度上可以接受的 Pythonic 解决方案。我究竟做错了什么？使子模块中的类在父模块的命名空间中可用的正确方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-06T21:22:35.703

如果您使用的是 Python 2.5 或更高版本，请尝试使用显式相对导入 ( [http://www.python.org/dev/peps/pep-0328/#guido-s-decision](http://www.python.org/dev/peps/pep-0328/#guido-s-decision) )：

```
test.py             (1): import foo.bar
foo\bar\__init__.py (1): from .derived import Derived
foo\bar\derived.py  (1): from . import base 
```

（请注意，如果您确实在使用 Python 2.5 或 2.6，则需要将其包含`from __future__ import absolute_import`在您的模块中。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T21:42:00.833

在 derived.py 中，使用这个：

**编辑**：正如 JAB 指出的那样，隐式相对导入已被*弃用*，不推荐使用以下内容（尽管它在 Python 2.7 中仍然有效 - 没有弃用错误！）。

~~import base # 这就是你所需要的——它在当前目录中~~

相反，使用：

```
from . import base # 
```

**（或者）**

```
from foo.bar import base 
```

**代替：**

```
import foo.bar.base as base 
```

这将解决您的两个错误（因为它们来自同一个问题）。您的导入不起作用，因为`base`foo.bar.base 模块中没有函数或类。

# c# - NInject 中的 System.MissingMethodException

> ID：10922247
> 
> 赞同：1
> 
> 时间：2012-06-06T21:02:55.297
> 
> 标签：c#, unit-testing, tfs, ninject

在 TFS 构建服务器上运行单元测试时，我们收到此错误：

```
SetUp : System.MissingMethodException : Method not found: 'Void
Ninject.ModuleLoadExtensions.Load(Ninject.IKernel, System.Reflection.Assembly[])'.
at Ninject.Extensions.Conventions.AssemblyScanner.Process(
Assembly assembly, IKernel kernel) 
```

据我所知，这就是说 NInject 的一部分找不到 Ninject 的另一部分。

该问题出现在我们的所有三个构建服务器上。

在本地，它工作正常。

所有系统（本地和远程）似乎都在使用所有 Ninject 程序集的正确版本（以及应用程序中的所有其他系统）

有任何想法吗？

更新：哎呀，我以为我在原始消息中提到了这一点：

```
Ninject ver 2.2.0.0
Ninject.Extensions.Conventions  ver 2.2.0.5 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T22:18:31.503

您最有可能使用不同版本的 Ninject.dll 和 Nnject.Extensions.Conventions。例如 Ninject 3.0.0 和 Conventions 2.2.0

MissingMethod 异常是一个部署问题。使用 Fusion 日志检查实际加载的内容。例如，一个程序集可以在 GAC 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T17:02:08.227

好的，我们想通了。

TFS 构建服务器喜欢将所有 DLL 放在同一个文件夹中。如果您同时拥有同名的 .Net 和 Silverlight 程序集（例如 Ninject.dll 就是这种情况），这会导致问题

解决方案是将 Silverlight 项目的属性页面（在“构建”选项卡下）上的“输出路径”从标准的“ `bin\Release\`”更改为“ `bin\Release\Silverlight`”，以便 DLL 保持独立。

# xslt - 如何遍历节点列表并根据我正在循环的子节点创建新节点

> ID：10922250
> 
> 赞同：0
> 
> 时间：2012-06-06T21:03:06.320
> 
> 标签：xslt

这可能是一个基本问题，但这个新手一直在苦苦挣扎和谷歌搜索，却无法弄清楚。

我有一个与此类似的 xml 文档。

```
 <x99:events xmlns:x99="http://www.foo.com/x99" xmlns:xl="http://www.w3.org/1999/xlink" pubdate="2012-05-29T11:14:14-06:00">
    <x99:event xl:href="event.xml?event_id=255918" id="foo" status="new">
        <x99:event_id>255918</x99:event_id>

        <x99:custom_attribute xmlns:x99="http://www.foo.com/x99" status="new">
            <x99:attribute_id>22</x99:attribute_id>
            <x99:attribute_value>hi there</x99:attribute_value>
        </x99:custom_attribute>

        <x99:custom_attribute xmlns:x99="http://www.foo.com/x99" status="new">
            <x99:attribute_id>26</x99:attribute_id>
            <x99:attribute_value>this is a test</x99:attribute_value>
        </x99:custom_attribute>

        <x99:custom_attribute xmlns:x99="http://www.foo.com/x99" status="new">
            <x99:attribute_id>12</x99:attribute_id>
            <x99:attribute_value>Yes</x99:attribute_value>
        </x99:custom_attribute>
    </x99:event>
</x99:events> 
```

我有一些转换 xml 的 xsl。

在我的 xsl 中，我需要能够遍历 custom_attribute 节点，并且对于每个 attribute_id，我发现我需要基于 custom_attribute 节点的子节点创建一个具有一些值的节点。

这是我的伪代码。我需要这样的东西。

```
<xsl:for-each select="x99:custom_attribute">

    <xsl:when test="number(x99:attribute_id) = 22>
        <x99:text>You chose twenty two and your attribute value is <x99:attribute_value></x99:text>
    </xsl:when>

    <xsl:when test="number(x99:attribute_id) = 26>
        <x99:text>Twenty six is a great answer! and your attribute value is <x99:attribute_value></x99:text></x99:text>
    </xsl:when>

</xsl:for-each> 
```

这是我的xsl。

我的 xsl 技能处于最基本的水平，我的 xml 也好不了多少。有好心人能给点建议吗？我有点过头了。

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="2.0"
  xmlns:xl="http://www.w3.org/1999/xlink"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:xhtml="http://www.w3.org/1999/xhtml"
  xmlns:b="http://www.someurl.com/b"
  xmlns:s="http://www.someurl.com/s"
  xmlns:c="http://foo.com/c"
  xmlns:x99="http://foo.com/x99"
  exclude-result-prefixes="xl x99">

    <xsl:param name="base_url" select="''" />
    <xsl:param name="session_id" select="''" />
    <xsl:param name="TaskDir" select="''" />

    <xsl:template match="/">
        <xsl:call-template name="SendConfirmationEmail">
            <xsl:with-param name="EventID" select="/x99:events/x99:event/x99:event_id"/>
            <xsl:with-param name="SiteURL" select="'https://foobar.com/123Test/#details'" />
        </xsl:call-template>

        <xsl:apply-templates select="node()" />
    </xsl:template>

    <xsl:template match="@*|node()">
        <xsl:copy>
            <xsl:apply-templates select="@*|node()" />
        </xsl:copy>
    </xsl:template>

    <xsl:template name="SendConfirmationEmail">
        <xsl:param name="EventID" select="''"/>

        <xsl:result-document>
            <schedule>
                <job>
                    <name>Email Confirmation</name>
                    <active>T</active>
                    <http>
                        <body>
                            <x99:email xmlns:x99="http://foo.com/x99">
                                <x99:mail>
                                    <x99:body>

                                        <x99:text>Your event ID is <xsl:value-of select="$EventID"/></x99:text>

                                        // I want to be able to loop through my x99:attribute_id values here and create new x99:text nodes.

                                    </x99:body>
                                </x99:mail>
                            </x99:email>
                        </body>
                    </http>
                </job>
            </schedule>
        </xsl:result-document>
    </xsl:template>

</xsl:stylesheet> 
```

坦率地说，我需要知道如何...

*   遍历 custom_attribute 节点并为每个节点创建一个 x99:text 节点，其中包含
*   基于子属性 ID 值的字符串
*   attribute_value 节点的内容

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T02:01:11.847

首先，不要使用带参数的命名模板，就像在 FORTRAN 中使用 CALL 调用子例程一样编程，只需定义一个模板来处理`event_id`元素，例如`<xsl:template match="event_id">`. 我假设你的意思是`html`，不是`http`。您需要`href`在元素上指定一个属性，`<xsl:result-document>`以便它知道将文档放在哪里。您显然是在将元素从 x99 命名空间写入 HTML 中——这真的是您想要做的吗？

关于属性元素的“循环”，在 XSLT 思维方式中，最好说“处理”它们。在`<x99:text>`添加`<xsl:apply-templates/>`元素下，然后定义一个模板来处理自定义属性元素 ( `<xsl:template match="x99:custom-attribute">`。在该模板中，将您在`for-each`伪代码中的内容放置在类似的内容中，但不要说`number(x99:attribute_id)`您只是想要`number(.)`，因为我们已经在那个节点。但是，请注意，`<xsl:when>`元素只能在`<xsl:choose>`.

# git - 查找两个提交的第一个公共孩子

> ID：10922262
> 
> 赞同：10
> 
> 时间：2012-06-06T21:03:45.797
> 
> 标签：git, merge, branch, git-branch

```
 :
           A
T         / \
i        B   C
m        :   :
e        D   E
          \ /
|          F
V          : 
```

`git merge-base B E`允许找到`A`两个提交的共同祖先在哪里。有没有办法找到`F`两个分支再次合并的提交？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2019-04-27T23:45:19.673

这个问题不一定有唯一的答案，因此您必须决定一些约束和/或启发式方法，或者接受多个“下游”合并的可能性。问题的核心与多个合并基候选的问题相同——使用`git merge-base --all`将它们全部列出，否则 Git 只会选择算法中最先弹出的那个。我们可以这样做，或者找到所有最好的合并候选者。

您已经绘制了我通常喜欢横向渲染的内容，例如：

```
 B--...--D
 /         \
A           F--G--H   <-- branch1
 \         /
  C--...--E   <-- branch2 
```

但我们可能有这个：

```
 B--C---D--E--...   <-- branch1
 /    \ /
A      X
 \    / \
  F--G---H--I--...   <-- branch2 
```

在这种情况下，如果您同时允许并考虑两者，则两者都合并`D`并且`H`同样是“分支重新合并的地方”的良好候选者。即使您不这样做，如果稍后合并回：`branch1``branch2``branch2``branch1`

```
 B--C---D--E---J--...   <-- branch1
 /    \ /      /
A      X      /
 \    / \    /
  F--G---H--I--...   <-- branch2 
```

然后只是从（或结束于）开始，`branch1`两者都是同样好的候选人。`D``H`

无论如何，我们在这里需要的是枚举以您要考虑的一个或所有分支结尾的提交。为此，我们可以使用，例如：

```
git rev-list --ancestry-path ^B ^E branch1 branch2 
```

这会找到作为`branch1` *or* `branch2`的祖先的提交，并且也是 commit`B` *或*commit 的后代`E`。

要真正得到正确答案，我们要添加`--children`. 这样，我们将获得每个提交的哈希 ID，以及该提交的子节点。Git通过在`--children`遍历链接时反转从孩子到父母的反向连接来实现这一点，这已经足够了；但我们不会看到提交`B`或`E`. 这是一个问题。为了让它们显示出来，我们可以添加`--boundary`. 这并不理想：`--boundary`有时会包含一些我们不想要的提交。幸运的是，它们都被标记了，`-`因此我们可以通过剔除那些不是我们关心的提交来排除额外的边界提交。

我不打算展示这些，但如果你这样做了，你现在将有一个列表，每行一个条目，每个节点（顶点）及其连接到其子节点的边。你现在可以问*这些 (V,E) 集合形成的 DAG 的 LCA 是多少？*

如果我们可以只使用 Git 的 LCA 算法就好了，但是 Git 没有办法在任意图上调用它——我们只能在提交时调用它，而实际的提交有父节点，而不是子节点。所以你必须自己写。请参阅[在有向无环图中找到最低共同祖先的算法？](https://stackoverflow.com/q/14865081/1256452)（不幸的是，没有公认的答案）。 [这个算法乍一看是正确的](https://jgrapht.org/javadoc/org/jgrapht/alg/NaiveLcaFinder.html)；它在图中具有 LCA 的两个标准定义之一。

但是，如果我们愿意接受一个不太好的答案，我们可以通过添加`--topo-order`（以确保父母在所有孩子之后出来）和`--merges`（省略所有不是合并提交）。这将获得所有合并的列表。

我在这里制作了一个带有简单案例的测试存储库：

```
$ git log --all --decorate --oneline --graph
* 91fcef6 (HEAD -> master) J
* d1e5905 I
*   5bf18a0 merge
|\  
| * 49b2ba7 (sidebr) D
| * 725e5ea C
| * 36b830d (tag: B) B
* | 198a982 (tag: G) G
* | 216bc01 F
* | e905e59 E
|/  
* 5df9428 initial 
```

所以我现在可以使用`B`and命名提交 B 和 G `G`，而我想要的“朝这个方向移动”的分支就是`master`. 所以：

```
$ git rev-list --topo-order --merges --ancestry-path ^B ^G master
5bf18a0797dfd78107928a9a4095f357cfabe914 
```

这里的*最后*一行是与两个提交“最接近”的合并。在这种情况下，这也是唯一的行，这就是我们想要的合并。

一旦我们绘制它，这里的缺陷就足够清楚了。假设我有一个更复杂的图表，例如：

```
 I--J
     /    \
    H      M--N
   / \    /    \
  /   K--L      \
 /               \
A                 P--Q  <-- master
 \               /
  \   C--D      /
   \ /    \    /
    B      G--O
     \    /
      E--F 
```

如果我现在 run `git rev-list --topo-order --merges --ancestry-path ^B ^H master`，我将枚举 commit `P`，然后以某种顺序同时`G`枚举`M`。所以*最后*一行要么是 commit 要么是 commit `G`，`M`虽然这两个*都是*合并，但它们不符合正确的标准：它们不合并`B`and `H`。只有提交`P`才能做到这一点。

因此，要检查您是否有正确的答案（不处理多个 LCA 问题），您应该从该`git rev-list`命令获取每个输出行，可能以相反的顺序（考虑添加`--reverse`），并查看两个提交是否是每个提交的祖先。“内部”合并就像`G`并且`M`将只有一个提交作为祖先。要进行 is-ancestor 测试，请使用`git merge-base --is-ancestor`：

```
if git merge-base --is-ancestor $commit1 $mergecommit &&
       git merge-base --is-ancestor $commit2 $mergecommit; then
    ... we've found a correct candidate
else
    ... move on to another candidate
fi 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T22:14:35.793

哎呀。读得不够仔细。

提交中的唯一信息是其父（或父）的 id。您无法从父提交获取子提交（这是存储库的定向部分，即 DAG）。

再看看这个——看起来`--ancestry-path`git log 的选项可以做到这一点。例如给出：

```
* 85d26ab When compiling vim, also compile & install gvim
*   3146e5d Merge remote-tracking branch 'origin/devel' into deve
|\
| * 28d08e5 rebasing-merge: specify all commits explicitly
* | 006d11d Help 'file' find its magic file
|/
* e68531d (tag: Git-1.7.6-preview20110720) Update submodules 
```

我们可以使用这两个提交的所有孩子

```
git log --oneline --ancestry-path B..E 
```

如果您然后将其反转并选择第一个-那就是F。

```
git rev-list --reverse --ancestry-path 28d08e5..006d11d | head -1 
```

在我的情况下，返回 3146e5d。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T23:37:26.443

Adapt `all.awk` from [this answer](https://stackoverflow.com/questions/10890011/efficient-retrieval-of-releases-that-contain-a-commit/10903126#10903126) to also carry the line number for each ref, then when you've encountered both parents look at the refs they have in common.

# titanium-mobile - 有条件的首次运行处理程序

> ID：10922264
> 
> 赞同：0
> 
> 时间：2012-06-06T21:03:49.613
> 
> 标签：titanium-mobile, appcelerator-mobile

我想知道是否有人可以帮助我编写一个简单的脚本。我还不是一个好的 Titanium 程序员，但我希望有一天能成为。

我需要有关脚本的帮助来检查 applicationDataDirectory 中是否存在某个设置文件。

我需要一种在 app.js 中自动触发它的方法：

如果 applicationDataDirectory 中不存在（！）名称为“passWord.txt”的文件，则打开窗口：

```
var w = Ti.UI.createWindow 
```

我找不到检查此文件然后自动打开此窗口的事件。当应用程序第一次加载时，这将作为“首次运行”事件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T05:15:23.887

尝试这个

```
var file =Titanium.Filesystem.getFile(Titanium.Filesystem.applicationDataDirectory,"passWord.txt”);
    if ( file.exists() ) {
        // do your work here.
    } 
```

有关完整的详细信息[Titanium.Filesystem.File](http://developer.appcelerator.com/apidoc/desktop/latest/Titanium.Filesystem.File-object.html)。

# android - 如何返回数据库中的电子邮件列表，erray 信息

> ID：10922266
> 
> 赞同：0
> 
> 时间：2012-06-06T21:04:00.850
> 
> 标签：android, sqlite

如何在列中返回列表，例如列中的所有电子邮件......这里是我的代码

```
public String reTurn() throws SQLException 
{

    String emails=null;

    Cursor mCursor = db.rawQuery("SELECT EmailNO FROM  Details_Customer " ,null); 
    mCursor.moveToFirst(); 

    if(mCursor.getCount() > 0){ 
        emails= mCursor.getString(mCursor.getColumnIndex(DBAdapter.COLUMN_EMAIL)); 
        //password = mCursor.getString(11);
    }
return emails;
  } 
```

但它只返回一封电子邮件，我希望它返回数据库中的所有电子邮件

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T21:10:15.417

试试这个：

```
public List<String> reTurn() throws SQLException 
{
    List<String> emails = new ArrayList<String>();
    Cursor mCursor = db.rawQuery("SELECT EmailNO FROM  Details_Customer ", null);

    int index = mCursor.getColumnIndex(DBAdapter.COLUMN_EMAIL);
    while(mCursor.moveToNext()) {
        emails.add(mCursor.getString(index)); 
        //password = mCursor.getString(11);
    }
    return emails;
} 
```

**从评论中添加**

由此：

```
email.putExtra(Intent.EXTRA_EMAIL, new String[]{ dbUser.reTurned}); 
```

我猜您正试图将电子邮件地址数组放入名为`email`. 这是一个更好的方法：

```
public String[] reTurn() throws SQLException 
{
    Cursor mCursor = db.rawQuery("SELECT EmailNO FROM  Details_Customer ", null);
    String[] emails = new String[mCursor.getCount()];

    int i = 0;
    int index = mCursor.getColumnIndex(DBAdapter.COLUMN_EMAIL);
    while(mCursor.moveToNext()) {
        emails[i++] = mCursor.getString(index); 
        //password = mCursor.getString(11);
    }

    return emails;
} 
```

并将其放入 Intent 中：

```
email.putExtra(Intent.EXTRA_EMAIL, dbUser.reTurned()); 
```

最后，在您的新活动中读取电子邮件数组：

```
String[] emails = getIntent().getStringArrayExtra(Intent.EXTRA_EMAIL); 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T21:11:56.820

您的代码的问题在于 if 语句。

```
emails = mCursor.getString(...); 
```

该语句只执行一次，因此您只会收到一封电子邮件。

而是尝试类似：

```
String[] emails = new String[mCursor.getCount()];
for(int i=0; i<emails.length; i++){
    emails[i] = mCursor.getString(...);
    mCursor.moveToNext();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T21:13:39.693

您可以使用以下代码获取所有邮件地址：

```
mCursor.moveToFirst();
ArrayList<String> mails = new ArrayList<String>();

if(mCursor.getCount() > 0){ 
    while(!mCursor.isAfterLast()){
         mails.add(mCursor.getString(mCursor.getColumnIndex(DBAdapter.COLUMN_EMAIL))); 
         mCursor.moveToNext();
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T21:15:20.593

它们都可以通过 获得，`Cursor`因为它本质上是一个迭代器。请参阅[游标 API](http://developer.android.com/reference/android/database/Cursor.html)。因此，您可以像传递数组一样传递光标并根据需要对其进行迭代。

如果确实有必要，您可以将结果复制到数组中：

```
int n = mCursor.getCount();
String [] emails = new String[n];
int emailColIndex = mCursor.getColumnIndex(DBAdapter.COLUMN_EMAIL);
mCursor.moveToFirst();
for (int i = 0; i < n; i++) {
    emails[i] = mCursor.getString(emailColIndex);
    mCursor.moveToNext();
}
// A good place to close the cursor. 
```

# go - 解组动态 XML

> ID：10922269
> 
> 赞同：3
> 
> 时间：2012-06-06T21:04:11.557
> 
> 标签：go

在遇到 XML 标记名称是动态的情况之前，我一直在使用 unmarshal 没有任何问题。

XML 可能如下所示：

```
<unit_amount_in_cents>
 <USD type="integer">4000</USD>
</unit_amount_in_cents>
<setup_fee_in_cents>
 <USD type="integer">4000</USD>
</setup_fee_in_cents> 
```

或者

```
 <unit_amount_in_cents>
  <GBP type="integer">4000</GBP>
 </unit_amount_in_cents>
 <setup_fee_in_cents>
  <GBP type="integer">4000</GBP>
 </setup_fee_in_cents> 
```

或者可以同时拥有（或更多）

```
<unit_amount_in_cents>
 <USD type="integer">4000</USD>
 <GBP type="integer">4000</GBP>
</unit_amount_in_cents>
<setup_fee_in_cents>
 <USD type="integer">4000</USD>
 <GBP type="integer">4000</USD>
</setup_fee_in_cents> 
```

我可以通过将 XML.Name.Local 分配给我需要的但不能解组它来编组到没有问题的 xml。

这是结构的样子

```
type Plan struct {
    XMLName xml.Name `xml:"plan"`
    Name string `xml:"name,omitempty"`
    PlanCode string `xml:"plan_code,omitempty"`
    Description string `xml:"description,omitempty"`
    SuccessUrl string `xml:"success_url,omitempty"`
    CancelUrl string `xml:"cancel_url,omitempty"`
    DisplayDonationAmounts bool `xml:"display_donation_amounts,omitempty"`
    DisplayQuantity bool `xml:"display_quantity,omitempty"`
    DisplayPhoneNumber bool `xml:"display_phone_number,omitempty"`
    BypassHostedConfirmation bool `xml:"bypass_hosted_confirmation,omitempty"`
    UnitName string `xml:"unit_name,omitempty"`
    PaymentPageTOSLink string `xml:"payment_page_tos_link,omitempty"`
    PlanIntervalLength int `xml:"plan_interval_length,omitempty"`
    PlanIntervalUnit string `xml:"plan_interval_unit,omitempty"`
    AccountingCode string `xml:"accounting_code,omitempty"`
    CreatedAt *time.Time `xml:"created_at,omitempty"`
    SetupFeeInCents CurrencyArray `xml:"setup_fee_in_cents,omitempty"`
    UnitAmountInCents CurrencyArray `xml:"unit_amount_in_cents,omitempty"`
}

type CurrencyArray struct {
    CurrencyList []Currency
}

func (c *CurrencyArray) AddCurrency(currency string, amount int) {
    newc := Currency{Amount:fmt.Sprintf("%v",amount)}
    newc.XMLName.Local = currency
    c.CurrencyList = append(c.CurrencyList, newc)
}

func (c *CurrencyArray) GetCurrencyValue(currency string) (value int, e error) {
    for _, v := range c.CurrencyList {
            if v.XMLName.Local == currency {
                    value, e = strconv.Atoi(v.Amount)
                    return
            } 
    }
    e = errors.New(fmt.Sprintf("%s not found",currency))
    return
}       

type Currency struct {
    XMLName xml.Name `xml:""`
    Amount string `xml:",chardata"`
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-07T00:50:27.643

`xml:",any"`你需要在你的`CurrencyList`领域上的标签。

[http://play.golang.org/p/i23w03z6R4](http://play.golang.org/p/i23w03z6R4)

# c - Linux终端 - 打印大量数据

> ID：10922277
> 
> 赞同：2
> 
> 时间：2012-06-06T21:04:57.843
> 
> 标签：c, linux, terminal

我正在用 C 编程语言编写应用程序，可以监控远程计算机系统信息、登录用户数、可用内存等。

我会将收集到的信息写入标准输出。但通常会有比终端的一个窗口更多的信息，所以我需要在结果中实现某种“滚动”。

最简单的解决方案是我认为打印例如前 25 行，然后等待用户向上或向下推并相应地重写所有行。

是否有一些更简单/更优雅的方式来处理终端上的此类输出？

编辑：忘了提，如果一些新输入来自某个远程计算机，我想刷新数据，例如：进程数更改。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T21:09:12.283

使用外部分页器，例如`more`(或`less`) 对输出进行分页。Unix 的优势在于组合简单的命令，创建管道而不是重新发明已经存在的功能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-06T21:16:07.350

听起来你需要诅咒。

这是[图书馆](http://tldp.org/HOWTO/NCURSES-Programming-HOWTO/)[指南`ncurses`](http://tldp.org/HOWTO/NCURSES-Programming-HOWTO/)。

这是一个用于终端的老式 GUI 库。喜欢`top`并`make menuconfig`使用它，所以它在每个系统上。它允许您停止思考“打印 25 行并刷新”以及更多“将数据放入可滚动的文本区域”的想法。

# javascript - 为什么语句 5 * 1.015 不返回 5.075？

> ID：10922279
> 
> 赞同：0
> 
> 时间：2012-06-06T21:05:00.297
> 
> 标签：javascript

> **可能的重复：**
> [JavaScript 的数学被破坏了吗？](https://stackoverflow.com/questions/588004/is-javascripts-math-broken)

它返回

```
5.074999999999999 
```

这是为什么？

还有哪些其他数字会给出类似的证明？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-06T21:06:23.330

浮点运算基础读物。

[http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html](http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html)

简而言之：

> 将无限多个实数压缩为有限位数需要近似表示。尽管整数有无限多，但在大多数程序中，整数计算的结果可以存储在 32 位中。相反，给定任何固定位数，大多数实数计算将产生无法使用那么多位精确表示的量。因此，浮点计算的结果必须经常四舍五入以适应其有限表示。这种舍入误差是浮点计算的特征。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-06T21:07:10.383

嗯，经典的例子是：

```
0.1 + 0.2 = 0.30000000000000004 
```

[IEEE 754](http://en.wikipedia.org/wiki/IEEE_754-2008)双精度浮点数（这是[JavaScript 使用](http://ecma-international.org/ecma-262/5.1/#sec-8.5)的）*非常非常好*，但它们并不完美。它们提供了一种对浮点数进行大部分正确但不完美的计算的快速方法。所有的数字系统都有这样的妥协（例如，试图*准确地*表示`1 / 3` ——或 PI，就此而言——用有限的十进制数字表示）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-06T21:07:12.763

这很正常——在处理浮点数时有一种叫做精度的东西。它存在于大多数现代语言中。请参阅此处：[http](http://www.mredkj.com/javascript/nfbasic2.html) ://www.mredkj.com/javascript/nfbasic2.html了解更多信息。

在这个思路中——你不能在不使用 EPS（epsilon 值）的情况下比较浮点数。如果您需要更多信息，请随时再次与我联系。

# python - 有没有一种使用 Pygame 制作和保存动画的简单方法？

> ID：10922285
> 
> 赞同：2
> 
> 时间：2012-06-06T21:05:45.027
> 
> 标签：python, animation, pygame, save, animated-gif

我制作了一个非常简单的分形生成器，可以打印出每一步；我想把它放在我做的演示文稿中。我用来演示的工具显然不支持 pygame，有没有办法将其保存为视频？最好是动画 .gif 等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T21:24:58.503

[http://visvis.googlecode.com/hg/vvmovie/images2gif.py](http://visvis.googlecode.com/hg/vvmovie/images2gif.py) - 用于制作动画 gif 的 python 包。

我最近第一次使用它（与 pygame 一起使用），所以这不能保证是最佳实践，但它确实有效。[这是代码](http://sjbyrnes.com/astatine.py)，[这是结果](http://ataridogdaze.com/science/5fps.gif)

--

更新：随着时间的推移，我认为 images2gif.py 是平庸的（产生不必要的大文件）并且不可靠（有时随机无法加载和运行）。我的新偏好是使用子进程调用 imagemagick。[示例代码在这里。](https://commons.wikimedia.org/wiki/File:SquareWaveFourierArrows.gif#Source_code) [这是 Windows 中的一个较短的示例（来自评论）。](http://pastebin.com/JJ6ZuXdz)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T21:12:05.243

**不是直接的。但是您可以**使用执行此操作的许多可用实用程序之一保存程序的截屏视频。

我不了解 Windows 或 OSX，但如果您使用的是 Ubuntu 或其他基于 gnome 的桌面，您可以使用 gnome-shell 内置功能（标准键绑定是`Control+Shift+Alt+R`）或`istanbul`（更多信息[here](https://live.gnome.org/Istanbul)）。

`screencast <your-os-here>`如果您不在 Ubuntu 上，谷歌搜索应该会有所帮助。

**编辑：**如果您保存了视频，您可以使用其他实用程序轻松转换其格式 - 如果您愿意的话。[这](http://thezestyblogfarmer.blogspot.se/2010/06/turn-your-ogv-movie-section-into.html)是关于如何从`ogv`（linux 截屏的标准输出）转换为动画 gif 的操作指南。

# database - 集群环境中的数据库 ID 生成

> ID：10922291
> 
> 赞同：2
> 
> 时间：2012-06-06T21:06:09.523
> 
> 标签：database, hibernate, oracle11g

我正在集群环境中开发一个 Web 应用程序。问题是我们需要为每个创建的实体生成一个 ID。我们处于一个有许多数据库节点的环境中，这些节点都相互流式传输。我的想法是一个带有偏移的序列。因此，一个站点的 ID 以 1 结尾，下一个以 2 结尾，依此类推。这似乎是一个笨拙的解决方案，因为您受限于多种环境。当您处于受干扰的数据库环境中时，保证生成唯一主键的“最佳”方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T21:13:51.657

就个人而言，我更喜欢带有偏移的序列。是的，您受限于一定数量的环境，但实际上，您通常可以从一开始就进行设置，以便可用环境的数量远远大于您真正需要的数量。如果你做类似的事情

在站点 1

```
CREATE SEQUENCE sequence_name
  START WITH 1
  INCREMENT BY 1000; 
```

在站点 2

```
CREATE SEQUENCE sequence_name
  START WITH 2
  INCREMENT BY 1000; 
```

并且在您必须重新处理序列之前，您最多可以拥有 999 个站点。这通常绰绰有余。如果您认为您实际上可能有 1000 个站点，您可以简单地将增量设置为 10,000 或 100,000。给定一个序列可以生成的值的数量，即使您将增量设置为数百万，您仍然不会用完。实际上，在您遇到序列问题之前，您就会遇到处理过多站点的 Streams 问题。

如果您不想走这条路，另一种选择是使用`SYS_GUID`生成全局唯一 ID 并将其用作主键。这不如使用序列有效，并且需要更多空间，但它确实允许您拥有任意数量的机器。

# fingerprint - sshj 示例（'exec'）：无法使用指纹验证 `ssh-rsa` 主机密钥

> ID：10922292
> 
> 赞同：5
> 
> 时间：2012-06-06T21:06:15.087
> 
> 标签：fingerprint, sshj

我正在尝试编写一个 java 程序，它将通过 ssh 连接并在工作中的服务器（redhat linux）上做一些事情。我的盒子是窗户。我阅读了有关 sshj 的信息，并且正在尝试使示例正常工作。我已经处理了大多数依赖项，现在我在处理公钥/私钥时遇到了错误，不幸的是我也不太了解（是的，这是新手的完美风暴！）。这是错误：

线程“主”net.schmizz.sshj.transport.TransportException 中的异常：[HOST_KEY_NOT_VERIFIABLE] 无法使用端口 22 上的`ssh-rsa`指纹验证主机密钥`5f:d6:94:00:9e:ec:7e:34:6d:d0:d3:76:df:5e:dd:3d``myserver`

这是代码：

```
import net.schmizz.sshj.SSHClient;
import net.schmizz.sshj.common.IOUtils;
import net.schmizz.sshj.connection.channel.direct.Session;
import net.schmizz.sshj.connection.channel.direct.Session.Command;

import java.io.IOException;
import java.util.concurrent.TimeUnit;

/** This examples demonstrates how a remote command can be executed. */
public class sshBuddy {

    public static void main(String... args)
            throws IOException {
        final SSHClient ssh = new SSHClient();
        ssh.loadKnownHosts();
        //ssh.addHostKeyVerifier("5f:d6:94:00:9e:ec:7e:34:6d:d0:d3:76:df:5e:dd:3d");

        ssh.connect("myserver");
        try {
            ssh.authPublickey(System.getProperty("myusername"));
            final Session session = ssh.startSession();
            try {
                final Command cmd = session.exec("ping -c 1 google.com");
                System.out.println(IOUtils.readFully(cmd.getInputStream()).toString());
                cmd.join(5, TimeUnit.SECONDS);
                System.out.println("\n** exit status: " + cmd.getExitStatus());
            } finally {
                session.close();
            }
        } finally {
            ssh.disconnect();
        }
    }

} 
```

任何帮助将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-09-24T08:22:37.157

试试这个

```
ssh.addHostKeyVerifier(new PromiscuousVerifier()); 
```

这应该工作

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T11:10:28.070

尝试这个

```
 public class sshBuddy {

    public static void main(String... args)
            throws IOException {
        final SSHClient ssh = new SSHClient();
        //ssh.loadKnownHosts();
        ssh.addHostKeyVerifier("5f:d6:94:00:9e:ec:7e:34:6d:d0:d3:76:df:5e:dd:3d");

        ssh.connect("myserver");
        try {
            ssh.authPublickey(System.getProperty("myusername"));
            final Session session = ssh.startSession();
            try {
                final Command cmd = session.exec("ping -c 1 google.com");
                System.out.println(IOUtils.readFully(cmd.getInputStream()).toString());
                cmd.join(5, TimeUnit.SECONDS);
                System.out.println("\n** exit status: " + cmd.getExitStatus());
            } finally {
                session.close();
            }
        } finally {
            ssh.disconnect();
        }
    }
} 
```

取消注释 addHostKeyVerifier 并注释 loadKnownHosts。它应该工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-10-31T22:21:10.167

这应该有效：

```
ssh.addHostKeyVerifier("MD5:5f:d6:94:00:9e:ec:7e:34:6d:d0:d3:76:df:5e:dd:3d") 
```

*addHostKeyVerifier*方法可以接收作为参数的**最终字符串**，该字符串用于在类[FingerprintVerifier.java](https://github.com/hierynomus/sshj/blob/master/src/main/java/net/schmizz/sshj/transport/verification/FingerprintVerifier.java)中执行验证。

根据[repo](https://github.com/hierynomus/sshj/blob/master/src/main/java/net/schmizz/sshj/SSHClient.java)，可以使用其他输入，例如：

*   `"SHA1:2Fo8c/96zv32xc8GZWbOGYOlRak="`
*   `"SHA256:oQGbQTujGeNIgh0ONthcEpA/BHxtt3rcYY+NxXTxQjs="`
*   `"MD5:d3:5e:40:72:db:08:f1:6d:0c:d7:6d:35:0d:ba:7c:32"`
*   `"d3:5e:40:72:db:08:f1:6d:0c:d7:6d:35:0d:ba:7c:32"`

如果有多个密钥，请仔细检查ssh 服务器 的**默认公钥的指纹。**

# iphone - 将 NavigationBar 背景更改为图像

> ID：10922297
> 
> 赞同：2
> 
> 时间：2012-06-06T21:06:53.823
> 
> 标签：iphone

我在 IOS 4+ 上尝试了此代码，它运行良好，但直到我的队友在 IOS 5+ 上对其进行了测试。这是代码

```
@implementation UINavigationBar (CustomImage)

// Set the navigation bar background
- (void)drawRect:(CGRect)rect {
    UIImage *image = [UIImage imageNamed:@"background.png"];
    [image drawInRect:CGRectMake(0, 0, self.frame.size.width, self.frame.size.height)];
}

@end 
```

我需要一个适用于 IOS 4+ 和 IOS 5+ 的代码，请帮助我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T21:10:33.803

请试试这个：

```
@implementation UINavigationBar (CustomImage)

// Set bar background
- (UIImage *)customBackground {
    UIImage *image = [UIImage imageNamed:@"background.png"];
    return image;
}

- (void)didMoveToSuperview {
    // Applies to iOS5 only
    if ([self respondsToSelector:@selector(setBackgroundImage:forBarMetrics:)]) {
        [self setBackgroundImage:[self customBackground] forBarMetrics:UIBarMetricsDefault];
    }
}

// Set the navigation bar background
- (void)drawRect:(CGRect)rect {
    [[self customBackground] drawInRect:CGRectMake(0, 0, self.frame.size.width, self.frame.size.height)];
}

@end 
```

setBackgroundImage:forBarMetrics: 适用于 iOS5

# android - RingtonePreference defaultValue InflateException

> ID：10922304
> 
> 赞同：2
> 
> 时间：2012-06-06T21:07:20.113
> 
> 标签：android, default-value, ringtone

我使用 RingtonePreference 并希望使用默认通知声音作为默认首选项值。为此，我遵循了以下建议：[RingtonePreference 默认值](https://stackoverflow.com/questions/8313542/ringtonepreference-default-value)

可悲的是，实际上我得到了一个`InflateException`我无法以任何方式摆脱的东西。这是android，我的手机中的错误还是我做错了什么？

我`OnCreate`在`MyPreferenceActivity`课堂上的方法：

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    addPreferencesFromResource(R.xml.preferences);
} 
```

我的相关片段`preferences.xml`：

```
<RingtonePreference
      android:key="ringtone_preference"
      android:ringtoneType="notification"
      android:showDefault="true"
      android:showSilent="true"
      android:defaultValue="content://settings/system/notification_sound"
      android:title="Notification sound"
      android:summary=""
      /> 
```

LogCat 的异常：

```
06-06 22:44:07.697: E/ActivityThread(21031): Failed to inflate
06-06 22:44:07.697: E/ActivityThread(21031): android.view.InflateException: Binary XML file line #17: Error inflating class java.lang.reflect.Constructor
06-06 22:44:07.697: E/ActivityThread(21031):    at android.preference.GenericInflater.createItem(GenericInflater.java:397)
06-06 22:44:07.697: E/ActivityThread(21031):    at android.preference.GenericInflater.onCreateItem(GenericInflater.java:417)
06-06 22:44:07.697: E/ActivityThread(21031):    at android.preference.GenericInflater.createItemFromTag(GenericInflater.java:428)
06-06 22:44:07.697: E/ActivityThread(21031):    at android.preference.GenericInflater.rInflate(GenericInflater.java:481)
06-06 22:44:07.697: E/ActivityThread(21031):    at android.preference.GenericInflater.rInflate(GenericInflater.java:493)
06-06 22:44:07.697: E/ActivityThread(21031):    at android.preference.GenericInflater.inflate(GenericInflater.java:326)
06-06 22:44:07.697: E/ActivityThread(21031):    at android.preference.GenericInflater.inflate(GenericInflater.java:263)
06-06 22:44:07.697: E/ActivityThread(21031):    at android.preference.PreferenceManager.inflateFromResource(PreferenceManager.java:269)
06-06 22:44:07.697: E/ActivityThread(21031):    at android.preference.PreferenceActivity.addPreferencesFromResource(PreferenceActivity.java:1457)
06-06 22:44:07.697: E/ActivityThread(21031):    at com.stanwise.timespacereminder.TSRPreferenceActivity.onCreate(TSRPreferenceActivity.java:44)
06-06 22:44:07.697: E/ActivityThread(21031):    at android.app.Activity.performCreate(Activity.java:4465)
06-06 22:44:07.697: E/ActivityThread(21031):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
06-06 22:44:07.697: E/ActivityThread(21031):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2034)
06-06 22:44:07.697: E/ActivityThread(21031):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2105)
06-06 22:44:07.697: E/ActivityThread(21031):    at android.app.ActivityThread.access$600(ActivityThread.java:133)
06-06 22:44:07.697: E/ActivityThread(21031):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1158)
06-06 22:44:07.697: E/ActivityThread(21031):    at android.os.Handler.dispatchMessage(Handler.java:99)
06-06 22:44:07.697: E/ActivityThread(21031):    at android.os.Looper.loop(Looper.java:137)
06-06 22:44:07.697: E/ActivityThread(21031):    at android.app.ActivityThread.main(ActivityThread.java:4586)
06-06 22:44:07.697: E/ActivityThread(21031):    at java.lang.reflect.Method.invokeNative(Native Method)
06-06 22:44:07.697: E/ActivityThread(21031):    at java.lang.reflect.Method.invoke(Method.java:511)
06-06 22:44:07.697: E/ActivityThread(21031):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:789)
06-06 22:44:07.697: E/ActivityThread(21031):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:556)
06-06 22:44:07.697: E/ActivityThread(21031):    at dalvik.system.NativeStart.main(Native Method)
06-06 22:44:07.697: E/ActivityThread(21031): Caused by: java.lang.reflect.InvocationTargetException
06-06 22:44:07.697: E/ActivityThread(21031):    at java.lang.reflect.Constructor.constructNative(Native Method)
06-06 22:44:07.697: E/ActivityThread(21031):    at java.lang.reflect.Constructor.newInstance(Constructor.java:417)
06-06 22:44:07.697: E/ActivityThread(21031):    at android.preference.GenericInflater.createItem(GenericInflater.java:383)
06-06 22:44:07.697: E/ActivityThread(21031):    ... 23 more
06-06 22:44:07.697: E/ActivityThread(21031): Caused by: java.lang.NullPointerException
06-06 22:44:07.697: E/ActivityThread(21031):    at android.preference.MultiSelectListPreference.onGetDefaultValue(MultiSelectListPreference.java:211)
06-06 22:44:07.697: E/ActivityThread(21031):    at android.preference.Preference.<init>(Preference.java:260)
06-06 22:44:07.697: E/ActivityThread(21031):    at android.preference.DialogPreference.<init>(DialogPreference.java:69)
06-06 22:44:07.697: E/ActivityThread(21031):    at android.preference.DialogPreference.<init>(DialogPreference.java:90)
06-06 22:44:07.697: E/ActivityThread(21031):    at android.preference.MultiSelectListPreference.<init>(MultiSelectListPreference.java:49)
06-06 22:44:07.697: E/ActivityThread(21031):    ... 26 more 
```

我也尝试插入一个字符串`DEFAULT_NOTIFICATION_URI`而不是`content://settings/system/notification_sound`，但没有任何成功。完全删除该`android:defaultValue`字段后，一切正常，除了我偏好的默认值是静音铃声而不是默认通知声音，这对我来说是不可接受的。

我到处搜索，找不到解决这个问题的方法。如果没有其他方法，我将使用此处发布的 hack：[https](https://stackoverflow.com/a/4298638/1265432) ://stackoverflow.com/a/4298638/1265432 ，但我想妥善解决这个问题。

**编辑：**我的 CM9 Motorola Defy 和 4.0.4（API 15）和 2.1（API 7）的模拟器都存在问题，所以我认为手机不是问题。错误，还是我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-17T17:17:36.317

我在这里提交了 Android 的错误报告：[http ://code.google.com/p/android/issues/detail?id=33220](http://code.google.com/p/android/issues/detail?id=33220)

与此同时，我使用了以下解决方法，我发现它比问题中链接的更干净。我修改了这个`OnCreate`方法`MyPreferenceActivity`：

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

     Uri notificationSound = Uri.parse(PreferenceManager.getDefaultSharedPreferences(this)
    .getString("ringtone_preference", System.DEFAULT_NOTIFICATION_URI.toString()));
    if (notificationSound.equals(System.DEFAULT_NOTIFICATION_URI)) {
        PreferenceManager.getDefaultSharedPreferences(this).edit()
            .putString("ringtone_preference", System.DEFAULT_NOTIFICATION_URI.toString())
            .commit();
    }

    addPreferencesFromResource(R.xml.preferences);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T23:58:25.997

我评论了您的错误报告，并对问题的真正含义有所了解。

Anyway here's a simpler workaround that works for me:

Add a defaultValue for MultiSelectListPreference that comes after RingtonePreference in your preferences XML:

```
<MultiSelectListPreference
        ...
        android:defaultValue="@array/empty"
        ...
        /> 
```

And in your strings.xml:

```
<string-array name="empty"/> 
```

# c++ - 使用 boost::lambda 和 boost::thread

> ID：10922309
> 
> 赞同：0
> 
> 时间：2012-06-06T21:07:30.037
> 
> 标签：c++, multithreading, boost, lambda

我在 Boost 的线程中使用 lambda 时遇到问题。

该代码应该将函数（字符串）的结果放在向量的指定索引中。

```
std::vector< string > results(size);
std::vector< boost::thread > threads;
for(  int i = 0; i < size; i++ ) {
    threads.push_back( boost::thread( results.at( i ) = getAString( x,y,zed ) ) );
} 
```

我将如何在这里使用 Boost::lambda ？

请不要提及使用 c++11 语法。我被迫使用的系统不支持支持 c++11 的编译器。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T23:26:49.777

在您的情况下，我想知道 lambda 函数有什么好处。C++ 中的 Lambda 最适用于已填充的容器上的 STL 算法。在您的情况下，您希望`results`使用 lambda 填充向量，这不是库想要的那种东西。你可能会有一场艰苦的战斗。 [http://www.boost.org/doc/libs/1_49_0/doc/html/lambda.html#introduction](http://www.boost.org/doc/libs/1_49_0/doc/html/lambda.html#introduction)

话虽如此，可以创建直接馈入右值的 lambda：http: [//www.boost.org/doc/libs/1_49_0/doc/html/lambda/le_in_details.html#lambda.rvalues_as_actual_arguments](http://www.boost.org/doc/libs/1_49_0/doc/html/lambda/le_in_details.html#lambda.rvalues_as_actual_arguments) 虽然在你的情况下我'我不确定一个固定函数有什么好处，该函数可以接受用于组成字符串的参数。

此外，我相信线程函数不能返回值，因此您的线程函数将不得不将位置`results.at(i)`作为参数。

# django - 非常新手：如何正确处理 django 中的应用程序和链接？

> ID：10922315
> 
> 赞同：-1
> 
> 时间：2012-06-06T21:08:02.803
> 
> 标签：django, templates, url

例如：将模块注册与模板/注册中的模板和 url.py 一起使用，包括：

```
url(r'^accounts/', include('registration.backends.default.urls')) 
```

什么是解决注册链接的最佳方法：/accounts/register/ 无需硬编码？

但总的来说，我如何引用应用程序（以及最终的视图）而不使用硬编码的 URL？

我曾经见过一个专用功能，但我不确定。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T21:12:38.940

在您的视图和其他 Python 模块中，您可以使用该`reverse`函数。[https://docs.djangoproject.com/en/1.4/topics/http/urls/#reverse](https://docs.djangoproject.com/en/1.4/topics/http/urls/#reverse)

在模板中，您将使用`url`模板标签。[https://docs.djangoproject.com/en/1.4/ref/templates/builtins/#url](https://docs.djangoproject.com/en/1.4/ref/templates/builtins/#url)

它有助于为您的 url 模式命名，以使这种反转尽可能容易。[https://docs.djangoproject.com/en/1.4/topics/http/urls/#id2](https://docs.djangoproject.com/en/1.4/topics/http/urls/#id2) django-registration 中包含的 url 模式都有您可以参考的名称。

# android - Eclipse 中的 Joda 时间：NoClassDefFoundError

> ID：10922316
> 
> 赞同：3
> 
> 时间：2012-06-06T21:08:12.837
> 
> 标签：android, eclipse, jodatime, noclassdeffounderror

我正在尝试为我的 Android 应用程序使用 Joda Time 库来获得 ISO 8601 格式的日期。我按照[本指南](http://crafted-software.blogspot.com/2011/07/adding-libraries-to-eclipse.html)将其加载到我的项目中，并导入了我正在使用的类。Eclipse 似乎可以很好地识别所有内容，因为它会自动完成我的导入。但是当我运行时，它似乎无法找到任何东西。我看到的第一条消息是这样的：

```
06-06 13:53:38.831: W/dalvikvm(4172): VFY: unable to find class referenced in signature (Lorg/joda/time/DateTime;) 
```

然后是一些更多的 VFY 消息，然后是：

```
06-06 13:53:38.911: E/dalvikvm(4172): Could not find class 'org.joda.time.DateTime', referenced from method ... 
```

然后这个：

```
06-06 13:53:40.661: I/dalvikvm(4172): java.lang.NoClassDefFoundError: org.joda.time.DateTime 
```

并且虚拟机中止

我遵循的设置 Joda Time 的指南是否遗漏了什么？有什么想法可以让这个库正常工作吗？谢谢你。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-06T21:14:31.513

确保在项目目录中创建一个 libs 目录并在其中添加 jar。

然后像往常一样添加jar文件（在项目属性中）

# java - 在PC上初始化蓝牙连接android（客户端）到python（服务器）

> ID：10922319
> 
> 赞同：16
> 
> 时间：2012-06-06T21:08:23.123
> 
> 标签：java, android, python

我正在尝试将“helloWorld”（只是一个字符串）从我的 android 手机（三星 Galaxy s2）发送到我运行 linux 的 pc 上的 python 脚本。但我无法让它工作。以下是 android 应用程序（客户端）和 python 脚本（服务器）的代码。蓝牙在电脑和手机上工作正常（例如，我可以通过 BT 从手机发送照片）。当我调用 btSocket.connect(); 在下面的java代码中它只是不会连接。我是否必须指定要连接的端口，因为我已经为 serverSocket 指定了端口？任何帮助将不胜感激。

```
public class BlueTooth_testActivity extends Activity {
    TextView header;
    Button discoverDevicesBtn;
    Button sendMsgBtn;
    Button closeBtn;
    EditText sendTxt;
    BluetoothAdapter btAdapter;
    BluetoothSocket btSocket;
    private static String btAdress = "00:10:60:D1:95:CD";
    private static final UUID MY_UUID = UUID.fromString("00001101-0000-1000-8000-00805F9B34FB");
    private OutputStream out;
    public BluetoothDevice device;
    private Boolean CONNECTED = false;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        //init layout parameters        
        header = (TextView) findViewById(R.id.text1);
        discoverDevicesBtn = (Button) findViewById(R.id.discBtn);
        sendMsgBtn = (Button) findViewById(R.id.sendButton);
        closeBtn = (Button) findViewById(R.id.closeButton);
        sendTxt = (EditText) findViewById(R.id.editText1);
        discoverDevicesBtn.setOnClickListener(discoverDeviceListener);
        sendMsgBtn.setOnClickListener(sendMsgListener);
        closeBtn.setOnClickListener(closeBtnListener);
        //init bluetooth
        btAdapter = BluetoothAdapter.getDefaultAdapter();
        if (btAdapter.isEnabled()) {
            Toast.makeText(this, "Bluetooth state:" + btAdapter.getState() + " Ok!", Toast.LENGTH_LONG).show();
        } else {
            Toast.makeText(this, "Bluetooth state:" + btAdapter.getState() + " Not ok!", Toast.LENGTH_LONG).show();
        }

    }

    private Button.OnClickListener discoverDeviceListener = new Button.OnClickListener() {@Override
        public void onClick(View v) {
            if (!CONNECTED) {
                device = btAdapter.getRemoteDevice(btAdress);
                header.append("\nRemote device: " + device.getName());
                try {
                    btSocket = device.createRfcommSocketToServiceRecord(MY_UUID);
                } catch (Exception e) {
                                    }
                header.append("\n createRfcommsockettoservice! ");
                btAdapter.cancelDiscovery();
                try {
                    btSocket.connect();
                    CONNECTED = true;
                    header.append("\n btSocket Created!");
                } catch (IOException e) {
                    Toast.makeText(getApplicationContext(), "Could not connect to socket", Toast.LENGTH_LONG);
                    try {
                        btSocket.close();
                    } catch (Exception b) {}
                }
            }

        }
    };

    private Button.OnClickListener sendMsgListener = new Button.OnClickListener() {@Override
        public void onClick(View v) {
            if (CONNECTED) {
                try {
                    out = btSocket.getOutputStream();
                    String msg = sendTxt.getText().toString();
                    byte[] msgBffr = msg.getBytes();
                    out.write(msgBffr);
                    Toast.makeText(getApplicationContext(), "Message sent", Toast.LENGTH_LONG).show();
                } catch (Exception a) {
                    Toast.makeText(getApplicationContext(), "Could not send msg", Toast.LENGTH_LONG).show();
                }
            } else {
                Toast.makeText(getApplicationContext(), "cant send msg, not connected", Toast.LENGTH_LONG).show();
            }

        }
    };

} 
```

（因为问题出在连接设置的某个地方，所以我没有费心包含其余的 java 代码）

```
import bluetooth

name="bt_server"
target_name="siggen"
uuid="00001101-0000-1000-8000-00805F9B34FB"

def runServer():
serverSocket=bluetooth.BluetoothSocket(bluetooth.RFCOMM )
    port=bluetooth.PORT_ANY
    serverSocket.bind(("",port))
    print "Listening for connections on port: ", port   
    serverSocket.listen(1)
    port=serverSocket.getsockname()[1]
    inputSocket, address=serverSocket.accept()
    print "Got connection with" , address
    data=inputSocket.recv("1024")
    print "received [%s] \n " % data    
    inputSocket.close()
    serverSocket.close()  

runServer() 
```

.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T10:18:55.167

# 服务器部分

当谈到 python 时，我已经超出了我的深度，但看起来你的 python 片段在任何地方都没有使用 uuid。例如，pybluez repo 有一个 [示例服务器](http://code.google.com/p/pybluez/source/browse/trunk/examples/simple/rfcomm-server.py) ，他们在调用时使用 uuid `advertise_service`，您的代码段中似​​乎没有。如果您要做类似的事情，您的代码片段可能如下所示：

```
import bluetooth

name="bt_server"
target_name="siggen"
uuid="00001101-0000-1000-8000-00805F9B34FB"

def runServer():
serverSocket=bluetooth.BluetoothSocket(bluetooth.RFCOMM )
    port=bluetooth.PORT_ANY
    serverSocket.bind(("",port))
    print "Listening for connections on port: ", port   
    serverSocket.listen(1)
    port=serverSocket.getsockname()[1]

    #the missing piece
    advertise_service( server_sock, "SampleServer",
                       service_id = uuid,
                       service_classes = [ uuid, bluetooth.SERIAL_PORT_CLASS ],
                       profiles = [ bluetooth.SERIAL_PORT_PROFILE ] 
                        )

    inputSocket, address=serverSocket.accept()
    print "Got connection with" , address
    data=inputSocket.recv("1024")
    print "received [%s] \n " % data    
    inputSocket.close()
    serverSocket.close()  

runServer() 
```

# 客户端

BluetoothDevice.createRfcommSocketToServiceRecord() 用于创建“安全通信套接字”。这是你的服务器在做什么？如果不是，也许 BluetoothDevice.createInsecureRfcommSocketToServiceRecord() 是合适的调用？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T22:27:04.127

您不需要指定端口，它应该只是将您连接到第一个打开的 RFComm 通道。我为我制作的蓝牙应用程序发现的一件事是，为了让它在我的手机上工作，我必须在尝试连接应用程序之前手动连接到服务器正在运行的计算机。也就是说，我会`Settings -> Wireless/Networks -> Bluetooth Settings -> <Find/Pair to Computer>`完成所有这些工作，直到通知在我的系统托盘中弹出。然后，当我尝试通过我的应用程序建立套接字连接时，它可以工作。我觉得这很奇怪，因为我只需要在我的手机而不是平板电脑上跳过这些箍，所以这可能取决于设备。

此外，您将希望在单独的`Thread`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-03-13T22:03:28.437

按照已经发布的建议，以下是我如何让您的代码按照我期望的那样工作：

```
import bluetooth

    name="bt_server"
    target_name="test"
    # some random uuid, generated by https://www.famkruithof.net/uuid/uuidgen
    uuid="0fee0450-e95f-11e5-a837-0800200c9a66"

    def runServer():
        # you had indentation problems on this line:
        serverSocket=bluetooth.BluetoothSocket(bluetooth.RFCOMM )
        port=bluetooth.PORT_ANY
        serverSocket.bind(("",port))
        print "Listening for connections on port: ", port   

        # wait for a message to be sent to this socket only once
        serverSocket.listen(1)
        port=serverSocket.getsockname()[1]

        # you were 90% there, just needed to use the pyBluez command:
        bluetooth.advertise_service( serverSocket, "SampleServer",
                           service_id = uuid,
                           service_classes = [ uuid, bluetooth.SERIAL_PORT_CLASS ],
                           profiles = [ bluetooth.SERIAL_PORT_PROFILE ] 
                            )

        inputSocket, address=serverSocket.accept()
        print "Got connection with" , address
        data=inputSocket.recv(1024)
        print "received [%s] \n " % data    
        inputSocket.close()
        serverSocket.close()  

    runServer() 
```

从命令行运行，该代码将永远等待，直到通过蓝牙发送消息。因此，运行该代码后，您所要做的就是通过蓝牙连接您的 Android 设备，然后让设备通过您正在开发的 Android 应用程序方法或类似的方法发送数据（参考与上述相同的 uuid）要点（我使用的）：[https ://gist.github.com/tito/7432757](https://gist.github.com/tito/7432757)

# php - 使用 jquery 解析 php 脚本返回的 JSON 字符串

> ID：10922320
> 
> 赞同：0
> 
> 时间：2012-06-06T21:08:29.207
> 
> 标签：php, jquery, mysql

惠。我有一个 php 脚本返回的这个 json 字符串（2 个不同的表上的 2 个不同的 mysql 查询）：（对不起，这是一个法国应用程序）

```
[{
  "statut":"2",
  "0":"2",
  "lib_statut":"En cours de traitement",
  "1":"En cours de traitement",
  "appelant":"GUEDIDER Jacqueline",
  "2":"GUEDIDER Jacqueline",
  "nom":"Virginie SORREL",
  "3":"Virginie SORREL",
  "date_creation":"05\/04\/2012 \u00e0 14:14:55",
  "4":"05\/04\/2012 \u00e0 14:14:55",
  "titre":"FACEO - Plus de message d'attente",
  "5":"FACEO - Plus de message d'attente"
},
{
  "nom":"Jonathan MORET",
  "0":"Jonathan MORET",
  "date_inter":"06\/04\/2012 \u00e0 11:18:07",
  "1":"06\/04\/2012 \u00e0 11:18:07"
},
{
  "nom":"Jonathan MORET",
  "0":"Jonathan MORET",
  "date_inter":"20\/04\/2012 \u00e0 08:22:53",
  "1":"20\/04\/2012 \u00e0 08:22:53"
}] 
```

第一个问题：有谁知道为什么每行记录两次（第一次是索引，第二次是列名）？

第二：如何在我的 jquery 脚本中解析这两个对象？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T21:16:40.550

我自信地预测，一切出现两次的原因是因为创建 JSON 的人是通过使用`mysql_fetch_array()`不带`$result_type`参数的直接输出来实现的。如果使用`mysqli_fetch_array()`/也是如此`mysqli_result::fetch_array()`。

告诉他们（你？）[`mysql_fetch_assoc()`](http://php.net/manual/en/function.mysql-fetch-assoc.php)改用。

实际上，请改用[PDO](http://php.net/manual/en/book.pdo.php)。

如果你这样做，你不必担心处理“两个”对象，因为你只会有一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T21:19:11.260

第一个问题：有谁知道为什么每行记录两次（第一次是索引，第二次是列名）？

也许是一个错误的 SQL 查询 ... ;) 严重的是，没有表结构和查询，就不可能说出原因 ..;

第二：如何在我的 jquery 脚本中解析这两个对象？

我假设您已将 JSON 分配给 Javacript var 数据：这是访问数据的方法：

```
var datas = "yOURJSONSTRING"; // Replace here your json ...
// then
var firstEl = datas[0];
// Then you can use : 
console.log("Statut is : " +firstEl.statut); // consle is for debugging purpose on FF
// then for 2nd and 3rd elements: 
var sndEl = datas[1];
var trdtEl = datas[2]; 
```

希望这会有所帮助...

问候;

咪咪

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T21:16:26.480

对于第一点，可能是因为您使用 mysql_fetch_array ( [http://ca.php.net/manual/en/function.mysql-fetch-array.php](http://ca.php.net/manual/en/function.mysql-fetch-array.php) ) 没有第二个参数 (MYSQL_ASSOC, MYSQL_BOTH, MYSQL_NUM)

默认为 MYSQL_BOTH，并且该函数返回一个带有数字键和选择参数的关联数组。

对于第二点，您可以使用

```
$.ajax({
  url: url,
  dataType: 'json',
  data: data,
  success: callback
}); 
```

( [http://api.jquery.com/jQuery.getJSON/](http://api.jquery.com/jQuery.getJSON/) )

# excel - 如何将天数添加到日期，仅考虑工作日（即忽略周末）？

> ID：10922321
> 
> 赞同：21
> 
> 时间：2012-06-06T21:08:30.977
> 
> 标签：excel, date, openoffice-calc, dayofweek, weekday

我正在尝试创建一个公式来计算第*n 个* **营业日期**（只有星期一到星期五是营业日）。为简单起见，假期并不重要。只有周末应该被忽略。

例如：

```
 +------------------------------------------------------------------
   |   A                B                     C
   +------------------------------------------------------------------
1  |  Starting Date    Business-Day Number   Business Date
2  |  06-Jun-2012      0                     06-Jun-2012
3  |  06-Jun-2012      1                     07-Jun-2012
4  |  06-Jun-2012      2                     08-Jun-2012
5  |  06-Jun-2012      3                     11-Jun-2012    <-- June 9th (Sat) and 10th (Sun) are skipped
6  |  06-Jun-2012      4                     12-Jun-2012
... 
```

该公式将用于填充上面的**C 列**。我能想出的唯一解决方案是在工作日表上进行 vlookup，我发现这有点麻烦。

有什么想法可以在一个公式中实现吗？

（可以在 Excel 或 OpenOffice-Calc 上）

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-06-06T21:37:43.340

在 Excel WORKDAY 函数中执行此操作，例如 C2 中的这个公式

`=WORKDAY(A2,B2)`

您还可以添加假期范围，例如 H2:H10 中列出的假期

`=WORKDAY(A2,B2,H$2:H$10)`

WORKDAY 是 Excel 2007 及更高版本中的内置函数 - 在早期版本中您需要启用`Analysis ToolPak`插件

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-06T21:15:36.977

在 LibreOffice Calc 中：

```
C1=A1+INT(B1/5)*7+MOD(B1,5)+(IF(WEEKDAY(A1,2)+MOD(B1,5)>5,2,0)) 
```

# vb.net - OneClick 安装中的应用程序“停止工作”

> ID：10922327
> 
> 赞同：1
> 
> 时间：2012-06-06T21:09:03.433
> 
> 标签：vb.net, visual-studio-2008

新手，Win7 32 位机器上的 VB.NET 应用程序。.NET 4.0 加载到机器上，VB 应用程序使用 .NET 目标 3.5 发布。

VS2008 OneClick 部署为仅在线可用。

应用程序在机器上使用管理员的 UID 运行良好，但作为标准用户，OneClick 会发送“（程序名称）已停止工作”消息框，其中包含“在线检查...”和“关闭程序”选项。

似乎是一个权限问题，但会感谢有关如何捕获问题区域的任何想法？我怎样才能找出它试图加载到它没有权限的本地机器（以及在哪里）？

在此先感谢您的帮助。

# php - 在 Codeigniter 中构建评论系统

> ID：10922330
> 
> 赞同：1
> 
> 时间：2012-06-06T21:09:09.287
> 
> 标签：php, codeigniter

我正在为使用 Codeigniter 构建的自定义 CMS 开发评论系统。我认为这很简单，但我被困在几个地方。

现在，我使用隐藏字段来保存帖子 ID 和父评论 ID。如果它是独立评论，则父评论 ID 为 0，但如果它是对特定评论的回复（因此线程评论），则会更改为评论 ID。这是我能想出的让表单知道评论所引用的帖子 ID 的唯一方法。

对于隐藏字段，我使用了以下验证：`trim|required|numeric`

我还在我的配置中将 XSS 过滤和 CSRF（跨站点请求伪造）保护设置为 TRUE。这足以保护表格不被滥用吗？还有什么我应该做的吗？

我应该做其他事情而不是隐藏字段吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T21:43:16.580

这完全取决于您的偏执程度/您的安全要求是什么。

我能预见的唯一问题是，如果有人手动更改父 ID 以在另一个帖子上注入评论。如果您具有不同的权限级别/仅允许某些人对某些部分发表评论，这可能是一个问题。您可以通过对 ID 进行某种可逆加密来解决它，但我不会为大多数应用程序烦恼。

单独的`numeric`过滤器应该可以防止任何 xss 问题。如前所述`user1062354`，请确保检查服务器上的编辑和删除权限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T21:42:21.160

确保当您删除或更新评论（通过编辑）时，检查更新评论的 user_id 是否是实际的评论所有者。我假设您的评论表中有 user_id 是一对一的关系，即评论只能有一个所有者，即创建评论的人。

也许是这样的：

```
function is_comment_owner($comment_id, $user_id) {
    $this->db->where('comment_id', $comment_id);
    $this->db->where('user_id', $user_id);
    $this->db->from('comments_table');
    if ($this->db->count_all_results() > 0) {
        return TRUE;
    } else {
        return FALSE;
    }
} 
```

# objective-c - 返回没有 typedef 的块的块

> ID：10922332
> 
> 赞同：3
> 
> 时间：2012-06-06T21:09:16.480
> 
> 标签：objective-c, objective-c-blocks

如果不使用 typedef，我无法弄清楚如何做到这一点：

```
 typedef void(^HLBlock)(void);

- (void)whatever
{
    HLBlock (^genBlock)(int) = ^(int tryCount){
        HLBlock b1 = [[^{
            NSLog(@"tryCount=%i", tryCount);
        } copy] autorelease];
        return b1;
    };

    genBlock(10);
} 
```

我需要将 HLBlock 声明为 void (^)(void) 的 typedef 似乎很愚蠢，但是对于我的一生，我无法弄清楚如果没有 typedef 如何做到这一点。genBlock 的正确返回类型是什么？

谢谢！杰米

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-06T21:30:38.817

这是没有 typedef 的语法，但我认为它是如此难以阅读，因此强烈首选 typedef：

```
void(^(^genBlock)(int))() = ^(int tryCount){
  void (^b1)() = ^{
    NSLog(@"tryCount=%i", tryCount);
  };
  return b1;
};

void(^aBlock)() = genBlock(10);
aBlock(); 
```

# ruby-on-rails - ruby on rails 无法在本地连接到 postgresql

> ID：10922335
> 
> 赞同：4
> 
> 时间：2012-06-06T21:09:27.100
> 
> 标签：ruby-on-rails, ubuntu, postgresql-9.1

我一直在尝试为我刚开始从事的项目设置我的 ruby​​ on rails 开发环境。我在 Ubuntu 12 上安装了 Ruby 1.9.3、Rails 3.2 和 postgresql 9.1.4，当我尝试 rake db:create:all 时，我收到以下消息：

```
/var/lib/gems/1.9.1/gems/activerecord-3.2.3/lib/active_record/connection_adapters/postgresql_adapter.rb:1194:in `initialize': could not connect to server: No such file or directory (NameError)
Is the server running locally and accepting
connections on Unix domain socket "/var/run/postgresql/.s.PGSQL.5432"? 
```

然后我补充说：

主机：本地主机

端口：5432

到我的 database.yml 文件，它让我可以执行 db:create:all 和 db:migrate，但是当我在本地运行 rails 服务器时，它仍然有相同的错误。

我检查了 postgresql 服务器是否正在运行（我也知道它正在运行，因为 rake 之前工作过），并尝试了全新安装的 postgresql。我可能缺少什么来完成这项工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T21:32:30.610

您确定您的 postgres 服务器正在运行吗？如果你这样做`ps -aef|grep postgres`了，你应该会看到如下内容：

```
[root@haddock ~]# ps -aef|grep 'postgres'
postgres  5963  5475  0 21:28 ?        00:00:00 /usr/postgresql/bin/postmaster -D <your postgres directory>
postgres  5972  5963  0 21:28 ?        00:00:00 postgres: writer process                          
postgres  5973  5963  0 21:28 ?        00:00:00 postgres: wal writer process                      
postgres  5974  5963  0 21:28 ?        00:00:00 postgres: autovacuum launcher process             
postgres  5975  5963  0 21:28 ?        00:00:00 postgres: stats collector process                 
admin     6750  6607  0 21:30 ttyS0    00:00:00 grep postgres 
```

# jquery - 根据内容将类添加到容器 div

> ID：10922340
> 
> 赞同：2
> 
> 时间：2012-06-06T21:10:11.980
> 
> 标签：jquery

我有一些像这样的html标记：

```
<div class="container">
<p class="date">October 10th 2012</p>
</div> 
```

我想根据包含在日期中的月份向我的容器 div 添加一个额外的十月类

标签。

jQuery 可以做到这一点吗？

然后，我打算将所有具有十月包装类的容器放入一个 div 中，然后根据它们一年中的月份将该 div 放入手风琴中。

非常感谢您对这个初始部分的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T21:14:12.060

确实是。

`$(".date:contains('October')").closest(".container").addClass("october");`

注意：它区分大小写。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T21:13:37.553

```
var $divs = $("p.date:contains('October')").closest("div").addClass("October ");
$divs.wrap("<div></div>");
//Now place it into the accordion 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-06T21:16:02.227

多月：

```
var monthArr = ["January","Febuary","March","April","May","June","July","August","September","October","Novermber","December"];

for (var month in monthArr) {
    $("p.date:contains('" + month + "')").closest(".container").addClass(month);
} 
```

# c# - 为什么我在 dll 注入后没有收到消息框？

> ID：10922342
> 
> 赞同：0
> 
> 时间：2012-06-06T21:10:14.693
> 
> 标签：c#, python, windows, winapi, dll-injection

我有简单的 dll 代码：

```
BOOL APIENTRY DllMain( HMODULE hModule,
                       DWORD  ul_reason_for_call,
                       LPVOID lpReserved
                     )
{
      if(ul_reason_for_call == DLL_PROCESS_ATTACH) 
      {
            MessageBox(0, L"Hello!", L"Hello!", 0);          

      }

return TRUE;
} 
```

以及用于将 dll 注入另一个进程的 python 代码：

```
import ctypes

PAGE_READWRITE = 0x04
PROCESS_ALL_ACCESS = (0x000F0000 | 0x00100000 | 0xFFF)
VIRTUAL_MEM = (0x1000 | 0x2000)

def InjectDLL(DLLPath, PID):

    kernel = ctypes.windll.kernel32
    dllLen = len(DLLPath)

    hProcs  = ctypes.windll.kernel32.OpenProcess(PROCESS_ALL_ACCESS, False, PID)
    if not hProcs:
        print 'OpenProcess failed.'
        return None

    argAddy = ctypes.windll.kernel32.VirtualAllocEx(hProcs, 0, dllLen, VIRTUAL_MEM, PAGE_READWRITE)
    if not argAddy:
        print 'VirtualAllocEx failed.'
        return None

    wrote = ctypes.c_int(0)
    kernel.WriteProcessMemory(hProcs, argAddy, DLLPath, dllLen, ctypes.byref(wrote))

    hKernel = kernel.GetModuleHandleA("kernel32.dll")
    hLib = kernel.GetProcAddress(hKernel, "LoadLibraryA")
    t_Id = ctypes.c_ulong(0)
    kernel.CreateRemoteThread(hProcs, None, 0, hLib, argAddy, 0, ctypes.byref(t_Id))
    return t_Id

result = InjectDLL("injdll.dll", 564)
print result 
```

注入适用于某些进程。例如它适用于 gvim。我可以看到消息框。但是我在 C# 中创建了简单的应用程序。在尝试将我的 dll 注入此应用程序之后，什么也没有发生。

Python 注入器不会使用`OpenProcess`or`CirtualAllocEx`和 return报告任何错误`c_ulong(3968L)`。那为什么我看不到消息框？

**编辑：**

我的操作系统：Windows XP Professional SP3 32 位。

**编辑2：**

我用 C 代码做了同样的事情，得到了同样的结果。注入例如适用于 gvim。但不适用于我在 c# 中的过程。我确实用调试器检查过，看起来 DllMain 函数没有执行。

```
DWORD pid;
cout << "PID: ";
cin >> pid;

HANDLE hproc = OpenProcess(PROCESS_ALL_ACCESS,0,pid);

LPVOID adr = 
VirtualAllocEx (
                hproc,
               (LPVOID)0,
               (SIZE_T)0x1000,
               MEM_COMMIT | MEM_RESERVE,
               PAGE_EXECUTE_READWRITE
               );

WriteProcessMemory (hproc, adr, "injdll.dll", 256, NULL);

HANDLE hthread = CreateRemoteThread 
(hproc,
 NULL,
 0,
 (LPTHREAD_START_ROUTINE)
 GetProcAddress(GetModuleHandle(L"kernel32"),"LoadLibraryA"),
 adr,
 0,
 NULL);

CloseHandle(hthread);
CloseHandle(hproc);

return 0; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T22:16:26.823

还不能发表评论，那么，您使用的是什么操作系统版本？

在大多数情况下，对于 64 位操作系统中的 .net 应用程序，您的 Dll 必须是 64 位的。

我不确定 pyton，但 LoadLibrary 需要 AsciiZ 字符串。那么，为了安全起见，您可以使用“dllLen = len(DLLPath)+1”吗？

另外，尝试更改默认堆栈大小

```
kernel.CreateRemoteThread(hProcs, None, 4096*16, hLib, argAddy, 0, ctypes.byref(t_Id)) 
```

或者，也许，您的 DllMain 中发生了异常（出于某种原因？）。在执行 CreateRemoteThread 之前将调试器附加到目标进程

# parsing - 如何在 BNF 中表示否定？

> ID：10922352
> 
> 赞同：14
> 
> 时间：2012-06-06T21:11:02.717
> 
> 标签：parsing, grammar, bnf, ebnf, ebnf-syntactic-exception

BNF 或 ABNF 是否支持否定。那就是排除集合的某些成员？我在它的语法中没有看到任何这样的否定运算符。

例如，假设所有字母数字字符串的`S`集合*不等于*`"foo"` What is the BNF for `S`?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-06T21:15:20.700

上下文无关语法在“差异”或“互补”下不封闭。因此，尽管您可能决定在 BNF 中添加一个运算符“减法”，但即使它有一种简单的表达方式，结果也不会是上下文无关语法。结果：人们不允许在用于表达上下文无关文法的 BNF 文法中使用此类运算符。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-02-01T19:43:31.407

虽然不在 BNF 中，但 EBNF 确实有*例外符号*（通常定义为“-”）。在您的情况下，语法为：

```
alphaNum="a"|"b"|...|"z"|"0"|"1"|...|"9"|"A"|...|"Z";
S= (alphaNum,{alphaNum}) - "foo"; 
```

或者，如果您希望它不区分大小写：

```
foo="f"|"F","o"|"O","o"|"O";
alphaNum="a"|"b"|...|"z"|"0"|"1"|...|"9"|"A"|...|"Z";
S= (alphaNum,{alphaNum}) - foo; 
```

这导致接受标准与评论中所做的略有不同，相当于：

```
alphaNum="a"|"b"|...|"z"|"0"|"1"|...|"9";
S= alphaNum - "f", {alphaNum} 
  |"f", alphaNum - "o", {alphaNum}
  |"f", "o", alphaNum - "o", {alphaNum}; 
```

这省略了字符串“f”和“fo”。

但是，重要的是要注意，正如 Ira Baxter 在他们的回答中所说，允许任何例外（否定）因素都会导致问题。[ISO标准](http://www.iso.org/iso/catalogue_detail?csnumber=26153)中也指出了这一点：

# 4.7 语法异常

句法异常由句法因子组成，该句法因子受到以下限制：由句法异常表示的符号序列可以同样由不包含元标识符的句法因子表示。

**注意**- 如果句法异常被允许作为任意句法因素，*扩展 BNF*可以定义比上下文无关文法更广泛的语言类别，包括导致类似罗素悖论的尝试，例如

```
xx = "A" - xx; 
```

“A”是 xx 的一个例子吗？这种许可是不可取的，因此句法异常的形式仅限于可以证明是安全的情况。因此，虽然句法因素通常等价于一些上下文无关文法，但句法异常总是等价于一些常规文法。可以证明，上下文无关文法和常规文法之间的区别总是另一种上下文无关文法。因此，句法术语（以及因此根据该标准定义的任何文法）等价于某些上下文无关文法。

# mysql - 有效地重新索引庞大的数据库（英文维基百科）

> ID：10922355
> 
> 赞同：11
> 
> 时间：2012-06-06T21:11:14.080
> 
> 标签：mysql, sql, database, xampp, mediawiki

**要旨**

在对英语 Wikipedia 执行 40+ GB 的大规模导入之前，我不得不暂时从三个表（“page”、“revision”和“text”）中删除索引和自动增量字段以处理负载。现在我终于成功地将英文维基百科导入到我的本地机器并创建了一个本地镜像（MediaWiki API）。耶！

但是，我现在需要在不到十年的时间内重新创建索引和自增字段。幸运的是，（1）在删除索引和字段之前，我在 phpmyadmin 中截取了大量相关表的屏幕截图；（2）我可以非常精确地解释我在导入之前采取的步骤；(3) 这对于任何精通 MySQL 的人来说应该不会太难。不幸的是，我对 MySQL 没有任何专业知识，因此“婴儿步骤”解释将非常有帮助。

**正是我所做的（准备导入）：**

步骤 1、2、3：这张图片描绘了在我修改字段**page_id之前的表格****页面**，方法是单击“更改”并取消选中“自动增量”（为导入做准备）。我对表**修订中的字段****rev_id**和表**文本中的****old_id**执行了完全相同的修改，但省略了屏幕截图以避免冗余。

 ******![修改“page_id”之前的表“page”](../Images/d7db5a8971027847d3dbe1ef3ba3d76b.png)

第 4 步：此图描绘了在我删除所有索引之前表**页的索引。**

![在我删除它们之前表“页面”的索引](../Images/b1f26cfba086f4d600cc0a6ca6b4dbf5.png)

第 5 步：此图描述了在我删除所有索引之前表**修订的索引。**

![在我删除它们之前表“修订”的索引](../Images/28c888e7d38021d05f63196992e2160d.png)

第 6 步：这张图片描述了我删除所有表格**文本**之前的索引。

![删除表“文本”之前的索引](../Images/491f29b074fe66f8de0db4cfcd84a25b.png)

**我现在需要什么（导入后恢复）：**

我只需要恢复原始索引和自增字段，无需等待一百年。

设置细节：PHP 5.3.8 (apache2handler), MySQL 5.5.16 (InnoDB), Apache 2.2.21, Ubuntu 12.04 LTS, MediaWiki 1.19.0 (private wiki)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T22:13:36.953

我真的很喜欢维基百科，所以我会尽力提供帮助。

你需要使用很多

```
ALTER TABLE 
```

添加主键

```
ALTER TABLE page ADD PRIMARY KEY (page_id);
ALTER TABLE revision ADD PRIMARY KEY (rev_id);
ALTER TABLE text ADD PRIMARY KEY (old_id); 
```

重新添加自动增量

```
ALTER TABLE page MODIFY COLUMN page_id INT(10) UNSIGNED NOT NULL AUTO_INCREMENT; 
```

在继续之前，我需要所有表的表描述。如果 rev_id 和 old_id 与 page_id 定义相同，则：

```
ALTER TABLE revision MODIFY COLUMN rev_id INT(10) UNSIGNED NOT NULL AUTO_INCREMENT;
ALTER TABLE text MODIFY COLUMN old_id INT(10) UNSIGNED NOT NULL AUTO_INCREMENT; 
```

添加唯一键

```
ALTER TABLE page ADD UNIQUE name_title(page_namespace, page_title);
ALTER TABLE revision ADD UNIQUE rev_page_id(rev_page, rev_id); 
```

其他指标

```
ALTER TABLE page ADD INDEX page_random(page_random);
ALTER TABLE page ADD INDEX page_len(page_len);
ALTER TABLE page ADD INDEX page_redirect_namespace(page_is_redirect, page_namespace, page_len);
ALTER TABLE revision ADD INDEX rev_timestamp(rev_timestamp);
ALTER TABLE revision ADD INDEX page_timestamp(rev_page, rev_timestamp);
ALTER TABLE revision ADD INDEX user_timestamp(rev_user, rev_timestamp);
ALTER TABLE revision ADD INDEX user_text_timestamp(rev_user_text, rev_timestamp); 
```

同样，可能有列定义会改变这些东西。您需要提供 CREATE TABLE 信息。******

# java - JSON对象的REST Post未处理Java中日期值中的空格

> ID：10922359
> 
> 赞同：0
> 
> 时间：2012-06-06T21:11:26.040
> 
> 标签：java, json, rest, date, post

我正在使用以下 unix 命令测试 REST 发布服务：

```
 curl -d "{"begTime":"2012-06-06 01:06:01.744","id":"1"}" http://localhost:8080/Restlet 
```

我使用以下 RESLET 打印语句打印该值：

```
 System.out.println("entity ---------" + jString + "--"); 
```

当我打印在我的 java 应用程序中收到的值时，我看到了这个值：

实体--------{begTime:2012-06-06--

我怎样才能得到整个日期，这样它就不会切断其余的对象值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T21:19:30.740

对我来说，这似乎是一个引用问题；JSON 文字中包含`"`字符。试试这个：

```
curl -d '{"begTime":"2012-06-06 01:06:01.744","id":"1"}' http://localhost:8080/Restlet 
```

如果您对此很认真，请考虑使用 shell 脚本以外的其他方法来执行此操作。那是因为相对于许多其他脚本语言（Python、Ruby、Perl、Tcl，……，一个很长的列表）直接做的事情，用 shell 脚本正确引用会变得非常尴尬。

# iphone - 使用本地时区将 unix 时间戳转换为 NSdate

> ID：10922363
> 
> 赞同：8
> 
> 时间：2012-06-06T21:11:35.930
> 
> 标签：iphone, ios, objective-c, nsdate

我从 API 请求中以 s 的形式返回了`start_times`一些`end_times`内容。`NSDecimalNumber`

我已经成功地将这些`NSDecimalNumber`s 转换为`NSDate`s，但是代码没有考虑时区。

我需要它使用设备上默认的时区。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-06-06T21:15:21.777

这应该可以满足您当前语言环境的需要

```
double unixTimeStamp =1304245000;
NSTimeInterval _interval=unixTimeStamp;
NSDate *date = [NSDate dateWithTimeIntervalSince1970:_interval];
NSDateFormatter *formatter= [[NSDateFormatter alloc] init];
[formatter setLocale:[NSLocale currentLocale]];
[formatter setDateFormat:@"dd.MM.yyyy"];
NSString *dateString = [formatter stringFromDate:date]; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-06-06T21:15:45.677

Unix 时间[没有时区](http://en.wikipedia.org/wiki/Unix_time)。它在 UTC 中定义为自 1970 年 1 月 1 日午夜以来的秒数。

您应该使用正确的时区获取 NSDates

```
[NSDate dateWithTimeIntervalSince1970:myEpochTimestamp]; 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-06-06T21:16:35.323

试试这样的..

```
NSDate* sourceDate = ... // your NSDate

NSTimeZone* sourceTimeZone = [NSTimeZone timeZoneWithAbbreviation:@"GMT"];
NSTimeZone* destinationTimeZone = [NSTimeZone systemTimeZone];

NSInteger sourceGMTOffset = [sourceTimeZone secondsFromGMTForDate:sourceDate];
NSInteger destinationGMTOffset = [destinationTimeZone secondsFromGMTForDate:sourceDate];
NSTimeInterval interval = destinationGMTOffset - sourceGMTOffset;

NSDate* destinationDate = [[[NSDate alloc] initWithTimeInterval:interval sinceDate:sourceDate] autorelease]; 
```

# c++ - c++ 中的 setprecision 是否舍入？如果是这样，为什么我会看到这个？

> ID：10922366
> 
> 赞同：12
> 
> 时间：2012-06-06T21:11:51.327
> 
> 标签：c++, floating-point

以下代码段输出 0.29847，而我原本预期为 0.29848：

```
double f = 0.298475;
cout << setprecision(5) << f << endl; 
```

但是，对于其他示例，我观察到四舍五入：

```
double f = 0.123459;
cout << setprecision(5) << f << endl; 
```

输出：0.12346

和

```
double f = 0.123454;
cout << setprecision(5) << f << endl; 
```

输出：0.12345

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-06T21:24:01.483

该数字`0.298475`不能精确地表示为 a `double`（因为它不是分母是 2 的幂的分数，即 11939/40000），并且存储的*实际*数字实际上更接近 0.29847 而不是 0.29848。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T21:28:28.117

据我从文档中看到的 setprecision() 不执行任何舍入，而只是设置小数点后显示的最大位数。双精度数和浮点数的可能表示形式可能与您使用的常量初始值设定项不同。

# ruby-on-rails - 内联 HAML 链接，但包含内容

> ID：10922372
> 
> 赞同：11
> 
> 时间：2012-06-06T21:12:08.397
> 
> 标签：ruby-on-rails, views, haml

我正在尝试输出一些类似的东西

```
<p>Hello, this is my text. <a href="#">Link here</a> This is more text</p> 
```

但使用 HAML

这将如何完成？我一直在寻找示例，但没有一个示例显示如何做到这一点，而是在链接的任一侧使用纯文本？

尼尔

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-06-06T23:35:47.027

如果你想做一个 1 班轮：

```
%p= "Hello, this is my text. #{link_to 'Link here', '#'} This is more text".html_safe 
```

多行

```
%p 
  Hello, this is my text. 
  = link_to 'Link here', '#'
  This is more text 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T23:07:27.170

你应该能够做到这一点：

```
%p Hello, this is my text. <a href="#">Link here</a> This is more text 
```

这也可以：

```
%p
  Hello, this is my test.
  %a{:href => '#'} Link here
  This is more text 
```

# c++ - 如何动态使用 GetProcAddress

> ID：10922375
> 
> 赞同：1
> 
> 时间：2012-06-06T21:12:15.730
> 
> 标签：c++, c, winapi, visual-c++, dll

众所周知，我们可以使用 GetProcAddress 从 DLL 句柄中获取函数指针，例如在 DLL 中定义的方法 foo：

```
int foo(long) 
```

我们可以像这样为 foo 函数获取函数指针：

```
typedef int(* FOO_FUNC)(long)
FOO_FUNC pFooFunc = (FOO_FUNC) GetProcAddress(dllHandle, "foo") 
```

但是我们正在考虑是否可以进一步使其动态化，比如说，我知道我有一个输入参数列表及其类型，这对于当前方法是正确的，我想在 dll 上调用此方法，然后获取一个列表输出参数（以及它们的类型）

```
//VARIANT would be able to hold different type of data with different type
std::vector<VARIANT> inputArguments;
std::string methodName = "foo"
void * pFunc = GetProcAddress(dllHandle, methodName.c_str())
std::vector<VARIANT> outputArguments;
callMethodDynamically(pFunc, inputArgument, &outputArguments) 
```

是否可以在 C/C++ 中动态实现上述 callMethod？我能想到的唯一方法是我们必须将参数推送到堆栈，然后调用 pFunc。我想那将是汇编语言。这里还有其他方法吗？我们还必须在这里处理不同的调用约定（stdcall、cdecl）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T16:09:21.950

为每个实际函数编写一个包装函数。

例如

```
int addNumbers( int x, int y ) { return x + y; }

void addNumbersW( std::vector<VARIANT>& inArgs, std::vector<VARIANT>& outArgs )
{
    // decode in args somehow
    int x = getArg( inArgs, 0 );
    int y = getArg( inArgs, 1 );
    int r = addNumbers( x, y );
    addArg( outArgs, r );
} 
```

您可能可以为每个函数原型编写一系列包装函数，并使用一些宏来简化使用。

# android - Phonegap在Android模拟器中不起作用

> ID：10922381
> 
> 赞同：6
> 
> 时间：2012-06-06T21:12:37.510
> 
> 标签：android, cordova

我按照基本 Phonegap 教程（Eclipse、Android SDK、ADT Phonegap）中的所有步骤操作，在 assets/www 文件夹中创建了一个 HMTL 页面，运行它，它显示了我的`hello world html`.

第 2 步：我在我的 HTML 页面的 CDN 上添加了对 jQuery Mobile 的引用：它起作用了。

第 3 步：我创建了一个新的 html 页面，复制粘贴了下面的代码，这是来自 Phonegap 网站的示例，但它确实……什么都没有。甚至没有警报（我添加了一些警报以查看是否发生了某些事情，但即使 onDeviceReady 事件也不会触发。

我有Phonegap JAR，`cordova-1.7.0.js`在我的`assest/www`目录中，但可能缺少一些东西。

有人可以帮我吗？

我还尝试了 Phonegap 站点的另一个示例（“设备属性”示例），但它仍然无法正常工作。

这是一个全新的 Eclipse 安装，我将 Android 版本设置为 2.3.3，我使用的是 Phonegap 1.7.0。

=================

# 编辑

我尝试了更多，现在可以重现错误，但不知道为什么会发生。

所以我用 Phonegap 示例项目创建了一个新项目，它可以工作。

因此，我将该项目中的所有资产（1 个 html、2 个 js 和 1 个 css）复制到我的项目中，让应用程序从该 html（来自我的活动类）开始，它就可以工作了。

现在是有趣的部分（不是）：我将起始页重置为我的“旧”index.html（这是 jQuery 移动版），然后单击指向示例 html 的链接，它不起作用。

因此，作为启动的示例 html：它可以工作，通过链接打开的示例 html：不起作用。

当我加载我的其他 html 页面时，这些页面不能作为起始页面，而不是通过起始页面打开它们，它们也可以工作。

那么，我的 jQuery Mobile 驱动的索引页面会不会造成问题？（我将复制粘贴下面的代码）。

EDIT2：当我使用非 jQuery Mobile 索引页面并通过普通`<A href>`链接链接到示例 html 时，它也可以工作。所以这越来越多地暗示我认为 jQuery mobile 挡住了我的路……

链接代码是这样的：

```
<li><a href="index4.html" data-transition="none">phonegap example</a></li> 
```

jQuery Mobile 主页：

```
<html>
<head>
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1"> 
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.0.1/jquery.mobile-1.0.1.min.css" />
    <link rel="stylesheet" href="http://www.verfrisser.net/kalender/mobile/verfrisser.css" />
    <script src="http://code.jquery.com/jquery-1.6.4.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.0.1/jquery.mobile-1.0.1.min.js"></script>
    <script type="text/javascript" charset="utf-8" src="cordova-1.7.0.js"></script>
</head>
<body>
  <div data-role="page">

    <div data-role="header">
        <h1>De NerdNight kalender</h1>
        <a href="about.html" data-rel="dialog">About</a><a href="genereren.html" data-transition="pop">Genereren</a>
    </div><!-- /header -->

    <div data-role="content">
        <img id="verfrisserlogo" src="verfrisserlogo.png" />
        <ul data-role="listview" data-inset="true" data-filter="false">
            <li><a href="2011.html" data-transition="none">2011</a></li>
            <li><a href="2012.html" data-transition="none">2012</a></li>
            <li><a href="2013.html" data-transition="none">2013</a></li>
            <li><a href="testing.html" data-transition="none">testing</a></li>
            <li><a href="testing2.html" data-transition="none">testing2</a></li>
            <li><a href="testing3.html" data-transition="none">testing3</a></li>
            <li><a href="index4.html" data-transition="none">phonegap example</a></li>
        </ul>
    </div><!-- /content -->

    <div data-role="footer">
        <h6>(C) Verfrisser 1998 till now</h6>
    </div><!-- /footer -->
</div><!-- /page -->
</body>
</html> 
```

=================

示例 HTML（仅在页面中显示文本“对话框将报告网络状态”）

```
<!DOCTYPE html>
<html>  
<head>    
    <title>navigator.network.connection.type Example</title>    
    <script type="text/javascript" charset="utf-8" src="cordova-1.7.0.js"></script> 
 <script type="text/javascript" charset="utf-8">    
   // Wait for Cordova to load    //    
   document.addEventListener("deviceready", onDeviceReady, false);  
   // Cordova is loaded and it is now safe to make calls Cordova methods   
    alert ('stand alone');
   //    
   function onDeviceReady() {
    alert ('onDeviceReady'); 
   checkConnection();   
   }    
   function checkConnection() {        
   var networkState = navigator.network.connection.type;        
   var states = {};       
   states[Connection.UNKNOWN]  = 'Unknown connection';        
   states[Connection.ETHERNET] = 'Ethernet connection';        
   states[Connection.WIFI]     = 'WiFi connection';       
   states[Connection.CELL_2G]  = 'Cell 2G connection';   
   states[Connection.CELL_3G]  = 'Cell 3G connection';   
   states[Connection.CELL_4G]  = 'Cell 4G connection';   
   states[Connection.NONE]     = 'No network connection';
   alert('Connection type: ' + states[networkState]); 
   }  

</script> 
</head>  
<body>
    <p>A dialog box will report the network state.</p>  
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-15T20:08:31.297

使用默认行为，下一页将作为 DOM 元素加载，因此`deviceready`不会再次调用 javascript。

尝试使用以下方法之一以正常方式运行它：

```
<li><a href="testing2.html" data-transition="none" rel="external">testing2</a></li> 
```

或者

```
<li><a href="testing2.html" data-transition="none" data-ajax="false">testing2</a></li> 
```

解释：

> 单击链接时，jQuery mobile 将确保链接引用本地 URL，如果是，它将阻止链接的默认单击行为发生，并改为通过 Ajax 请求引用的 URL。当页面返回成功时，它会将 location.hash 设置为新页面的相对 url。
> 
> 如果 Ajax 请求成功，则将新页面内容添加到 DOM，自动初始化所​​有移动小部件，然后通过页面转换将新页面动画化到视图中。

有关更多详细信息，请查看[文档](http://jquerymobile.com/demos/1.1.0/docs/pages/page-links.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T09:28:54.013

只要您的代码中没有错误。上面的代码结构不是很好构造的。您在第一页而不是在第二页中提到了 phonegap 和 jquery mobile javascript。它的头部没有任何 jquery mobile javascript 文件。

据我所知的事实：

*   您可以从一个 jquery 移动页面到另一个 jquery 移动包含页面进行 Jquery 转换。
*   在两个头文件中包含标准库文件。

这将完成你的工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T16:27:23.970

添加@Coder_sLaY 提到的xml 文件后，您需要将加载jQuery Mobile JS 文件（CDN URL）的服务器添加到cordova.xml 中允许的服务器的白名单中

# c# - Visual Web Developer 用新的 HTML 替换内部 HTML

> ID：10922385
> 
> 赞同：2
> 
> 时间：2012-06-06T21:13:10.610
> 
> 标签：c#, innerhtml, visual-web-developer

我制作了一个网页来显示一个图形，然后允许用户在它下面输入一些评论。提示用户输入，我试图将每个评论存储在一个列表中，然后将该列表显示为一个有序的 HTML 列表。以下是相关代码：

```
<script runat="server">

private List<string> messages = new List<string>();

protected void Button2_Click(object sender, EventArgs e)
{
    messages.Add(TextBox2.Text);
    TextBox2.Text = "";
}

protected void Button3_Click(object sender, EventArgs e)
{
    messages.Clear();
}

protected void Button4_Click(object sender, EventArgs e)
{
    string output = "<ol>";
    foreach (string message in messages)
    {
        output += "<li>";
        output += message;
        output += "</li>";
    }
    output += "</ol>";
    Message.InnerHtml = Server.HtmlEncode(output);
}

protected void Chart1_Load(object sender, EventArgs e)
{

}

</script>

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        Key Messages:<br />
        <span id="Message" runat="server">
            <asp:TextBox runat="server" ID="TextBox2" Width="500px"></asp:TextBox>
            <asp:Button runat="server" ID="Button2" Text="Enter Message" Onclick="Button2_Click" />
            <asp:Button runat="server" ID="Button3" Text="Clear Messages" onclick="Button3_Click" />
            <asp:Button runat="server" ID="Button4" Text="Done" onclick="Button4_Click" />
        </span>
    </div>
    </form>
</body>
</html> 
```

输出是：

```
Key Messages:
<ol></ol> 
```

所以我有两个谜团：

1）为什么输入到文本框中的文本没有添加到列表中

2) 为什么新的 HTML 显示为纯文本。

任何建议表示赞赏。

问候。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T21:43:38.243

**1）为什么输入到文本框中的文本没有添加到列表中**

正如其他人所说，您没有在请求之间保留数据。
每当您单击一个按钮时，整个页面都会重新实例化，从而导致您的`message`变量自行重新设置。

`Session`可以使用。例如，将您的`message`字段替换为如下属性：

```
private List<string> Messages
{
    get
    {
        var messages = Session["Messages"] as List<string>;

        if (messages == null)
        {
            messages = new List<string>();
            Session["Messages"] = messages;
        }

        return messages;
    }
} 
```

**2) 为什么新的 HTML 显示为纯文本。**

*（在旁注中，a 中的`<ol>`标签`<span>`是无效的 Html，即使它可能会呈现）*

您正在编码您的`output`.
要获得所需的结果，您只需不要像这样对其进行编码：

*（我对此不是 100% 确定，但我认为在实时系统上通过 IIS 运行时，IIS 可能会自动编码字符串并且您再次遇到同样的问题，`BulletList`如果是这种情况，请查看建议的替代方案。）*

```
protected void Button4_Click(object sender, EventArgs e)
{
    string output = "<ol>";
    foreach (string message in Messages)
    {
        output += "<li>";
        output += message;
        output += "</li>";
    }
    output += "</ol>";
    Message.InnerHtml = output;
} 
```

另一种方法是使用 a`BulletList`来获得相同`BulletStyle`的`Numbered`结果。
像这样更新你的`Html`：

```
<div>
    Key Messages:<br />
    <span id="Message" runat="server">
        <asp:TextBox runat="server" ID="TextBox2" Width="500px"></asp:TextBox>
        <asp:Button runat="server" ID="Button2" Text="Enter Message" OnClick="Button2_Click" />
        <asp:Button runat="server" ID="Button3" Text="Clear Messages" OnClick="Button3_Click" />
        <asp:Button runat="server" ID="Button4" Text="Done" OnClick="Button4_Click" />
    </span>

    <asp:BulletedList BulletStyle="Numbered" ID="OutputMessages" runat="server">
    </asp:BulletedList>
</div> 
```

将代码中的代码更改为`Button4_Click`：

```
protected void Button4_Click(object sender, EventArgs e)
{
    // If you want to hide the message controls.
    Message.Visible = false;

    foreach (var message in Messages)
    {
        OutputMessages.Items.Add(new ListItem(Server.HtmlEncode(message)));
    }
} 
```

**概括**

*   持久化您的数据，例如使用`Session`
*   如果您想要传递的 html 来呈现，请不要对数据进行编码（阅读下面的警告）
*   考虑使用 a`BulletList`而不是发回不安全的 html 字符串
*   a中的`<ol>`标签`<span>`是无效的 html

**编码警告**

如果不对来自服务器的数据进行编码，则可能会发送恶意脚本。例如，假设我们执行以下操作：

```
Message.InnerHtml = "<script>alert('Hello');</script>"; 
```

以上将执行显示警报的脚本。想象这是一个恶意脚本！

*但是，如上所述，IIS 可能会自动编码字符串，在这种情况下，此脚本将不会执行，而是应呈现为纯文本。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T21:19:34.293

您必须了解网页的工作原理。每次单击按钮/超链接都会创建一个新的 http 请求，并在此过程中检索一个新页面（除非您使用 ajax，但这是另一回事）。

您可以设置 List 类型的私有变量，但这仅适用于页面的当前实例。当用户发出请求（例如单击按钮）时，会创建一个新的页面实例并将其返回给用户 => 列表将始终为空。Http 是无状态的，您需要一种方法来在请求之间执行数据的持久性。

如果列表是特定于用户的，您可以根据需要使用 ViewState 或 SessionState 来存储/检索数据。如果它是一个更全球化的东西，请使用数据库/文件作为持久性介质。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T21:25:10.397

List 不是静态的，因此每次请求页面时都会重新定义它。

您将其视为播放文本的原因是您对输出进行了 HtmlEncode。所以 < 和 > 成为字符的 HTML 表示（< 和 >）。

```
Message.InnerHtml = output; 
```

应该纠正

# signals - 如何在 FDT 5.5 中为 Haxe 使用 HSL？

> ID：10922386
> 
> 赞同：1
> 
> 时间：2012-06-06T21:13:15.073
> 
> 标签：signals, haxe, fdt

我已经成为 AS3Signals ( [https://github.com/robertpenner/as3-signals](https://github.com/robertpenner/as3-signals) ) 的忠实粉丝，所以我想在 Haxe 中找到类似的东西。HSL ( [http://code.google.com/p/hxhsl/](http://code.google.com/p/hxhsl/) ) 似乎是一个很好的答案。

在简介（[http://code.google.com/p/hxhsl/wiki/PrefaceAndIntroduction](http://code.google.com/p/hxhsl/wiki/PrefaceAndIntroduction)）中，作者解释了添加 HXML 以进行编译的内容。

> 使用 您必须告诉编译器您正在使用该库。有几种方法可以做到这一点。
> 
> 如果您使用 HXML 文件来编译您的项目，只需将以下行添加到该文件中：-lib hsl-1

由于 FDT 也使用 HXML 文件，所以我就这样做了，但是在问题视图中出现错误，但没有描述。

有什么我应该做的不同的事情吗？

* * *

我之前尝试过一些这样的东西，然后我尝试了你的建议，这就是我发现的。

我已经通过 haxelib 安装了 HSL（因为这是作者的建议）。我检查了我安装的内容，这里是：

![终端中的haxelib](../Images/341f6b73313e1974ebf0780b23764bb3.png)

FDT 中发生了一些奇怪的事情：如果我使用在终端 ( `/usr/bin/haxe`) 中找到的路径，FDT 会引发错误。

![FDT 首选项错误](../Images/199546c868c727f99e6200ae0d8d73f7.png)

所以我必须使用`/usr/lib/haxe`某种原因。

![FDT 首选项](../Images/7a068a0cd350d91341088766777771e9.png)

如果我尝试在 Haxe 类中简单地编写导入代码，我会得到一个正确的错误：

![正常错误](../Images/9cc019eb1e16d3477c2fc7eb489dd0ea.png)

但是，如果我尝试在 hxml 参数中添加库，我会得到一个没有解释的错误：

![错误无文字](../Images/40fcd6bf59704d2fc225debf98fe82a6.png)

然后我尝试了在项目中添加库源文件的选项，但仍然出现错误：

![库错误](../Images/78ea6193ef1710e6dc50562f2f3a3571.png)

所以我想我的问题是：我在哪里没有正确遵循您的指示？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T02:47:46.780

## Haxe 编译器无法访问 HSL。

当引用缺少源代码时，通常错误如下所示： ![在此处输入图像描述](../Images/69cd78d96ff979c9f85a52f39c552328.png)

## 有两种方法可以让它可见

1.  使用 haxelib ([链接](http://haxe.org/doc/haxelib/using_haxelib))
2.  将源代码直接添加到项目中。

## 使用 Haxelib

要使用 Haxelib 和 FDT，请确保 FDT 和您的 $PATH 指向同一个 Haxe 编译器。还要确保已安装 HSL（默认情况下不是）。在上面的 Haxelib 链接上了解如何执行此操作。

如果您使用的是 OSX，则无法导航到 FDT 包内的 SDK。您可以复制并粘贴它。它将是这样的：/Applications/FDT 5.app/Contents/FDT5/haxe/haxe-2.09-osx

[也见这里。](https://stackoverflow.com/questions/10939596/how-do-i-navigate-update-the-haxe-sdk-inside-of-fdt/)

![在此处输入图像描述](../Images/9955fafbaabb708672b834a4a676cfec.png) ![在此处输入图像描述](../Images/9fa2056ccbcde71a8da3f7ae31a1f6ae.png) ![在此处输入图像描述](../Images/07a3f40a428eb3345c8dedaeba100e64.png)

## 将源直接添加到 FDT

这很简单。只需查看 HSL 存储库中的源代码即可。将“hsl-pico source”的内容添加到您的项目中。然后将其添加为源文件夹。

![在此处输入图像描述](../Images/39861e7ea527603098eec067b774d4f1.png)

# html - 使用 HTML 和 CSS 创建 L 形边框，可以吗？

> ID：10922387
> 
> 赞同：6
> 
> 时间：2012-06-06T21:13:24.623
> 
> 标签：html, css, border

是否可以仅使用 HTML 和 CSS 创建像这样的 L 形边框？

![L 形边框](../Images/a3357f8d58f29c3207fc19911435a786.png)

编辑：这就是我目前所拥有的：http: [//jsfiddle.net/cBwh8/](http://jsfiddle.net/cBwh8/)

Edit2：我希望复制上面的图片——适当弯曲的圆角。这是我在这里遇到困难的主要原因：http: [//jsfiddle.net/cBwh8/1/](http://jsfiddle.net/cBwh8/1/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-06T21:25:25.327

是的。

[http://jsfiddle.net/HwKGx/1/](http://jsfiddle.net/HwKGx/1/)

```
<div id="one">
    <div id="two">&nbsp;</div>
</div> 
```

```
#one {
    margin:10px;
    width:45px;
    height:75px;
    border:2px solid #333; }
#two{
    float:left;
    width:35px;
    height:65px;
    border-width:2px;
    border-style:solid;
    margin:-2px 0 0 -2px;
    border-color:#FFF #333 #333 #FFF;
}​ 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-06T21:32:29.983

试试这个：为我工作

```
div.outer {
    margin: 10px;
    width: 200px;
    height: 200px;
    border: 1px solid blue;
    border-radius: 10px;
}

div.inner {
    width: 160px;
    height: 160px;
    border-right: 1px solid blue;
    border-bottom: 1px solid blue;
    margin-top:-1px;
    margin-left:-1px;
    background:#FFF;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-06T21:28:51.093

有点棘手，但玩得很开心

```
.left{float:left}
.right{float:right}
#container{border-right:1px solid #000;border-bottom:1px solid #000;width:300px;height:300px;margin:100px auto;}
#leftBox{width:70%;height:69%;border-right:1px solid #000;border-bottom:1px solid #000;}
#leftBox2{border-left:1px solid #000;width:100%;height:29%;}
#rightBox{width:29%;height:70%;border-top:1px solid #000;} 
```

和标记

```
<div id="container">
<div id="leftBox" class="left"></div>
<div id="rightBox" class="right"></div>
<div id="leftBox2" class="left"></div> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-06T21:29:32.673

一个稍微复杂但有用的选项：

[http://dabblet.com/gist/2884899](http://dabblet.com/gist/2884899)

这是两个兄弟元素，绝对且相对定位，z-indexed 以相互溢出。顶部 div 隐藏底部 div 的顶部边框。

这对于下拉菜单特别有用。（要有一个带边框的框，用上下文菜单展开）

**编辑**（从链接粘贴的代码）：

**HTML**：

```
<div class="holder">
  <div class="top"></div>
  <div class="bottom"></div>
</div> 
```

**CSS**：

```
.holder{    
  position:relative; 
}

.top{   
  width: 50px;  
  height:50px;
  background:red;
  border:blue solid 2px;
  border-bottom:none;
  position:relative;
  z-index:4;
} 

.bottom{
  z-index:2;
  width: 100px;
  height: 100px;
  position:absolute;
  top:50px;
  left:0;
  border: blue solid 2px;
  background:red; 
```

}

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-01-20T21:23:57.140

对于任何感兴趣的人，这里有一组 L 形的字段集：

[JSFiddler 代码](http://jsfiddle.net/EC5ym/5/)

**HTML：**

```
 <div>
        <fieldset class="topPortion">
            <legend>Some legend</legend>
            <input type="text" value="Foo" />
            <input type="submit" value="Submit" />
        </fieldset>
        <fieldset class="bottomPortion">        
            <input type="text" value="Foo" />
            <input type="submit" value="Submit" />
        </fieldset>
     </div> 
```

**CSS：**

```
fieldset.topPortion 
{
border: 1px solid red;
border-bottom: 0;
/*top: 20px;*/
padding: 5px 5px;
position: relative;
width: 250px;
z-index: 100;
background-color: yellow;
top: 1px;
border-radius: 5px 5px 0 0;
}

fieldset.bottomPortion
{
border: 1px solid red;
width: 500px;
height: 100px;
position: absolute;
z-index: 1;
margin-top: -10;
padding: 5px 10px;
background-color: yellow;
border-radius: 0 5px 5px 5px;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-05-20T04:50:41.843

NECRO，实际上我刚刚遇到了这个问题，这是我发现的第一个帖子，所以我想补充一点，以防其他人遇到问题或问题仍然存在。使用您链接的edit2，将“border-radius”更改为“border-bottom-right-radius”，这使得它只有右下角最终被圆形，从而修复了奇怪的圆形/褪色边缘。

您还可以添加诸如 -moz-border-radius-bottomleft: 10px; 之类的内容。-webkit-border-bottom-left-radius: 10px; 如果您想为旧版浏览器提供更多支持。

# jquery - 检查可拖动的类型

> ID：10922388
> 
> 赞同：1
> 
> 时间：2012-06-06T21:13:28.753
> 
> 标签：jquery

下面的可拖动元素可以是一个`<li>`元素。我可以检查拖动的元素是`<li>`使用`.attr`方法还是其他方法？

```
$(".myCss" ).droppable({
    drop: function( event, ui ) {
        ui.draggable.attr('class'));
    } 
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T21:17:09.323

您可以使用[`is`](http://api.jquery.com/is/)方法：

```
$(".myCss" ).droppable({
    drop: function( event, ui ) {
        if (ui.draggable.is("li")) {
            // ...
        }
    } 
}); 
```

**演示：http:** [//jsfiddle.net/ZsT2Y/](http://jsfiddle.net/ZsT2Y/)

# php - PHP Google Calendar API - 更新事件

> ID：10922392
> 
> 赞同：2
> 
> 时间：2012-06-06T21:13:48.440
> 
> 标签：php, google-calendar-api

这是一个新手问题，我还不习惯 Google API

* * *

你好，

我正在使用谷歌提供的代码（[https://developers.google.com/google-apps/calendar/downloads](https://developers.google.com/google-apps/calendar/downloads)），这些代码附带了一些示例（最初是因为它看起来更最新）。

如示例“calendar/simple.php”所示，我成功检索了日历（OAuth2 设置正确）。

**之后，我正在这样做并且它可以工作（这是一个不必要的代码，只是用于检查是否可以正确检索事件而没有任何错误）：**

```
$test = $cal->events->get("calendar@gmail.com","longeventcodegivenbygoogle"); 
```

**现在，我希望能够设置特定事件的一些值。**

```
$event = new Event();
$event->setLocation('Somewhere');
$test = $cal->events->update("calendar@gmail.com","longeventcodegivenbygoogle",$event); 
```

**但它给了我：**

```
( ! ) Fatal error: Uncaught exception 'apiServiceException' with message 'Error calling PUT https://www.googleapis.com/calendar/v3/calendars/calendar@gmail.com/events/longeventcodegivenbygoogle?key=myapikey: (400) Required' in C:\wamp\www\test\Gapi3\src\io\apiREST.php on line 86
( ! ) apiServiceException: Error calling PUT https://www.googleapis.com/calendar/v3/calendars/calendar@gmail.com/events/longeventcodegivenbygoogle?key=myapikey: (400) Required in C:\wamp\www\test\Gapi3\src\io\apiREST.php on line 86 
```

我做错了什么？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T22:25:27.747

为了更新事件，您首先检索它，然后更改其属性的值，而不是实例化一个新的。

试试下面的代码：

```
$event = $cal->events->get("calendar@gmail.com","longeventcodegivenbygoogle");
$event->setLocation('Somewhere');
$updated = $cal->events->update("calendar@gmail.com", $event->getId(), $event); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-07T12:40:21.810

真正的解决方案是由 Claudio Cherubino 通过调用事件类来创建事件对象给出的。

**默认情况下，似乎 get() 不返回事件对象，而是返回一个数组。**

```
$event = new Event($cal->events->get("calendar@gmail.com","longeventcodegivenbygoogle"));
$event->setLocation('Somewhere');
$updated = new Event($cal->events->update("calendar@gmail.com", $event->getId(), $event)); 
```

如果您不使用 update() 或 get() 提供的数组创建事件，它将不起作用，因为它是这些调用返回的简单数组。

# python - 如何安全地移动 SQLite3 数据库？

> ID：10922394
> 
> 赞同：0
> 
> 时间：2012-06-06T21:13:56.257
> 
> 标签：python, sqlite, copy

我有一个在本地机器上用 Python (2.7) 创建的 sqlite3 数据库，并试图将其复制到远程位置。我运行“sqlite3 posts.db .backup posts.db.bak”来创建一个副本（我可以使用原始副本和这个新副本就好了）。但是当我将复制的文件移动到远程位置时，突然每个命令都给我：`sqlite3.OperationalError: database is locked.`如何安全地移动 sqlite3 数据库，以便在移动后可以使用它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T21:59:58.633

你`.backup`在源系统上做了 a ，但你没有提到`.restore`在目标系统上做 a 。请说清楚。

您没有提及`sqlite3`源系统和目标系统上的可执行文件版本。

您没有提及如何将`.bak`文件从源传输到目标。

当您执行此操作时，源数据库是否被另一个进程访问`.backup`？

文件有多大？您是否考虑过压缩/复制/解压缩而不是备份/复制/恢复？

# java - 带盐的 Spring Security 3 SHA-1

> ID：10922396
> 
> 赞同：3
> 
> 时间：2012-06-06T21:14:04.753
> 
> 标签：java, xml, spring, security

我有一个我们正在重写的遗留应用程序，我正在转换现有的用户表。密码是使用带有盐的 sha-1 加密的。特别是盐+密码。例如，如果盐是 ABC123，密码是 XYZ789，那么要加密的字符串是 ABC123XYZ789。Spring Security 默认加密字符串 XYZ789{ABC123}。如何实现我自己的密码加密/验证以绕过 Spring Security 的默认加密。

我可以发布我的安全 xml，但如果我使用加密的密码 {salt} 更新散列密码，一切正常。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-06T21:40:02.923

子类[`ShaPasswordEncoder`](http://static.springsource.org/spring-security/site/docs/3.1.x/apidocs/org/springframework/security/authentication/encoding/ShaPasswordEncoder.html)化并覆盖该`mergePasswordAndSalt(String, Object, boolean)`方法。你可以[在这里看到它最初是如何实现的](http://grepcode.com/file/repo1.maven.org/maven2/org.springframework.security/spring-security-core/3.1.0.RELEASE/org/springframework/security/authentication/encoding/BasePasswordEncoder.java#BasePasswordEncoder.mergePasswordAndSalt%28java.lang.String%2Cjava.lang.Object%2Cboolean%29)。只需修改字符串连接部分，就完成了。

然后，像这样提供你自己的`passwordEncoder`：

```
<beans:bean 
    id="passwordEncoder" 
    class="my.awesome.package.MyAwesomeShaPasswordEncoder"/> 
```

# iphone - iphone：在 Xcode 4.3.2 中使用 addObject 时，NSMutable 数组为空

> ID：10922399
> 
> 赞同：0
> 
> 时间：2012-06-06T21:14:12.560
> 
> 标签：iphone, nsmutablearray

我正在使用 NSXMLParser 解析数据。我能够得到解析的数据。但是当我使用 addObject 将它添加到 NSMutableArray 时，该数组为空。我正在使用最新的 Xcode 版本。有人可以帮帮我吗。

我正在处理的数组是 IdentificationTypes1

```
-(void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName attributes:(NSDictionary *)attributeDict{

    if ([elementName isEqualToString:@"Books"]) {
        }

    if ([elementName isEqualToString:@"Book"]) {

        if ([elementName isEqualToString:@"title"]) {

        self.identificationTypes1 =[[NSMutableArray alloc]init];

        }

    }

}

-(void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string{

    if (!currentElementValue) {
        currentElementValue =[[NSMutableString alloc]initWithString:string];

    }
    else {
        [currentElementValue appendString:string];

    }

}

-(void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName{

    if ([elementName isEqualToString:@"Books"]) {
        NSLog(@"Count is %@",[identificationTypes1 count]);

        return;
    }
    if ([elementName isEqualToString:@"Book"]) {

    }
    if ([elementName isEqualToString:@"title"]) {
        NSLog(@"Curre value is %@",currentElementValue);
        [self.identificationTypes1 addObject:currentElementValue];

    }

   currentElementValue = nil;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T21:24:37.400

```
NSMutabeArray *myArray = [[NSMUtableArray alloc]init];

[myArray addObject:<XML Data>]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-07T01:25:47.880

您不能像在 didStartElement 中那样嵌套元素。解析器不允许这样做。自行取出标题并重新测试。您需要创建有条件访问的新变量。

# jquery - 在单文档 jQuery Mobile 环境中重绘 Elycharts

> ID：10922408
> 
> 赞同：0
> 
> 时间：2012-06-06T21:14:32.077
> 
> 标签：jquery, jquery-mobile, svg, graphael

我创建了一个统计网络应用程序，它全部存储在一个 HTML 文档中，使用 jQuery mobile 在不同页面之间切换。我使用 Elycharts ( [elycharts.com](http://elycharts.com) ) 创建了一个图表，该图表从本地数据库中检索信息。每次，当我切换到带有图表的页面时，我都会触发一个函数，从数据库中加载条目并绘制图表。

我遇到了问题，第一次加载页面时，部分图形丢失了。当我在浏览器中运行它时，它会在刷新后出现。

当我添加一个新条目时，新点将绘制在最后一个条目的顶部。看来，该图表是在以前的版本之上绘制的。

有谁知道，我如何触发真正干净的重绘或动态地向输出注入更多条目？

从那以后，我一直在兜圈子。手册不完整，代码中的注释是英文和意大利文的混合......我想过切换到另一个库，但到目前为止我创建的图表看起来非常漂亮并且可以在 iPad 上使用。只需要把这些虫子弄出来。

抱歉，我无法在此处提供代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-22T18:03:27.587

这可能有点晚了，但我今天遇到了同样的问题，发现这个解决方案可以正常工作：

```
$("#mychart").chart('clear'); 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T22:59:16.640

您可以使用以下代码：

在 AJAX 成功调用后，添加以下代码：

```
$('#chart').remove(); // this will remove the existing old chart and all its values
$("#chartdiv").append('<div id="chart" style="width: auto;height: 450px" \/>');
generatechart(); // this will generate the chart 
```

这是 HTML：

```
<div id="chartdiv" style="width: auto;height: 450px"></div> 
```

# python - 在一个字符串中寻找多个东西

> ID：10922409
> 
> 赞同：0
> 
> 时间：2012-06-06T21:14:40.707
> 
> 标签：python, irc, bots

我正在尝试制作一个在输入 OPEN 命令时打开 url 的脚本。这是针对我正在创建的 IRC 机器人。我试图让它像这样

打开[http://url.com](http://url.com)并打开网址。这就是我到目前为止所拥有的。

```
import webbrowser
test = s.recv(1024)

if test.find("http://") != 1:
        webbrowser.open(test)

else:
    print "it didnt work" 
```

老实说，我不知道这是怎么做到的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T00:20:11.810

我想到了

```
import webbrowser
#command is OPEN http://url.com
a = raw_input("Command: ")

if "OPEN" in a:
    url = a.strip("OPEN ")
    webbrowser.open(url) 
```

# dns - blogspot.com 在另一个域上

> ID：10922412
> 
> 赞同：-2
> 
> 时间：2012-06-06T21:14:50.480
> 
> 标签：dns, blogspot

我有 blogspot 博客，我想将域名更改`www.xyz.blogspot.com`为我的域`www.xyz.com` 我[注册](http://support.google.com/blogger/bin/static.py?hl=en&ts=1233381&page=ts.cs)了我的域，但现在当我访问我的博客时出现此错误

> 目录没有索引文件。
> 
> 禁止在没有索引文件的情况下浏览本网站或目录。如果您是该网站的网站管理员，则可以通过使用以下名称之一创建默认 HTML 页面来解决此问题：
> 
> index.html index.htm default.htm Default.htm home.html Home.chtml

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T21:20:33.873

当您注册您的域时，您应该能够修改它所指向的内容。您应该能够选择 CNAME，然后写入`www.xyz.blogspot.com`. 这基本上会将您的域链接到您的`www.xyz.blogspot.com`站点，用户只会看到`www.xyz.com`.

另一种解决方案是添加如下所示的 index.php：

```
<?php
  header("Location: http://www.xyz.blogspot.com");
?> 
```

但这只会将用户重定向到旧页面，因此它将显示`http://www.xyz.blogspot.com`在地址栏中。

# objective-c - 让 mergeChangesFromContextDidSaveNotification: 在听 NSFetchResultsControllers 突袭和更新之前完成

> ID：10922414
> 
> 赞同：0
> 
> 时间：2012-06-06T21:14:51.140
> 
> 标签：objective-c, core-data, ios5, merge, nsfetchedresultscontroller

我有一个`NSFetchedResultsController`（FRC）支持表视图。根据定义，它正在侦听与其定义的获取请求相关的托管对象上下文 (MOC) 中的更改。

虽然这个表视图是可见的，但我可能运行了一个小的导入（比如大约十几个记录），其中包含与观看 FRC 相关的托管对象。

我在对等 MOC 上运行导入到支持表视图的 MOC。两个 MOC 都是`NSMainQueueConcurrencyType`，有一个共同的父 MOC `NSPrivateQueueConcurrencyType`。

一旦导入完成并保存，我之前的设置通知就会触发一个处理程序，它只是执行一个`mergeChangesFromContextDidSaveNotification:`

```
- (void)scratchpadContextDidSave:(NSNotification *)saveNotification {
    log4Info(@"Default Context now merging changes from Scratchpad Context save notification.");
    [self.defaultContext mergeChangesFromContextDidSaveNotification:saveNotification];
} 
```

**问题：** 如何`mergeChangesFromContextDidSaveNotification:`在任何收听的 FRC 收到通知之前完成？

**动机** FRC 的新数据在我的应用程序中充当某种触发器，这很好，只要*所有*合并的更改都可用。我的 FRC 立即行动，没有完整的信息。

我将删除需要 FRC 以这种方式保持耐心的逻辑，但它让我担心我不知道有一种方法可以在整个合并操作完成之前“锁定”更改通知发出。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T13:08:38.207

id星，

强制同步到所有`-save:`s 的一种方法是让它们通过私有串行队列序列化它们的合并，其中最后一项实际执行与主 MOC 的合并。仅仅因为一个项目被保存到持久存储中，并不意味着它必须立即合并。`userInfo`在将字典提交到主 MOC 之前，您必须自己合并字典。

安德鲁

# java - 在 Oracle 中运行的 Java - 导入的 jar

> ID：10922415
> 
> 赞同：4
> 
> 时间：2012-06-06T21:14:53.123
> 
> 标签：java, oracle11g

我正在尝试将一个小型 Java 类加载到 Oracle 11g 中，以便我可以运行它并从 PL/SQL 调用它。我在 eclipse 中的本地机器上编码和编译了这个类，它编译得很好。我将它打包到一个 jar 中（以及它依赖于 jar 中的其他 jar 文件）。他们我尝试将我的 jar 加载到 Oracle 11g 中。一切都加载了，不幸的是，当它加载我的自定义 java 类时，它仍然无效，当我尝试在 Oracle 中编译它时，它说它找不到对类的引用（我和我的类一起打包在我的 jar 中的那些）。

我需要配置其他类型的设置吗？

这是我的自定义类代码的样子：

```
import com.flashline.registry.openapi.base.OpenAPIException;
import com.flashline.registry.openapi.entity.*;
import com.flashline.registry.openapi.service.v300.FlashlineRegistry;
import com.flashline.registry.openapi.service.v300.FlashlineRegistryServiceLocator;
import javax.xml.rpc.ServiceException;
import java.net.URL;
import java.rmi.RemoteException;
import org.apache.log4j.Logger;
import java.net.MalformedURLException;

public class AssetExtractor {

/**
 * @param args
 */
public static void main(String[] args) {
    // TODO Auto-generated method stub

}

   static Logger LOG;
   static AuthToken authToken = null;

   static FlashlineRegistry repository = null;
   static URL repoURL;

    public static FlashlineRegistry getRepository()
    {
        if(repository == null)
            try
            {
                try{
                    repoURL = new URL("https://myserver/oer/services/FlashlineRegistry");
                }catch(MalformedURLException mue)
                {
                    LOG.error(mue);
                }

                repository = (new FlashlineRegistryServiceLocator()).getFlashlineRegistry(repoURL);
                LOG.debug((new StringBuilder()).append("Created repository at URL=").append(repoURL.toString()).toString());
            }
            catch(ServiceException e)
            {
                LOG.error(e, e);
            }
        return repository;
    }

    public static AuthToken getAuthToken()
    {
        if(authToken == null)
            try
            {
                authToken = getRepository().authTokenCreate("user", "password");
                LOG.debug("Created auth token.");
            }
            catch(OpenAPIException e)
            {
                LOG.error(e, e);
            }
            catch(RemoteException e)
            {
                LOG.error(e, e);
            }
        else
            try
            {
                getRepository().authTokenValidate(authToken);
            }
            catch(OpenAPIException e)
            {
                LOG.info("Auth token was invalid.  Recreating auth token");
                authToken = null;
                return getAuthToken();
            }
            catch(RemoteException re)
            {
                LOG.error("Remote exception occured during creation of suth token after determined to be invalid", re);
                re.printStackTrace();
                authToken = null;
            }
        return authToken;
    }

    public static String getAssetXML(String strAssetID)
    {
        String strAsset = null;
        try
        {
            strAsset = getRepository().assetReadXml(getAuthToken(), Long.parseLong(strAssetID));
        }
        catch(OpenAPIException e)
        {
            e.printStackTrace();
        }
        catch(RemoteException e)
        {
            e.printStackTrace();
        }
        return strAsset;
    }

} 
```

导入的所有 *.jar 文件都在我的 AssetExtractor.jar 中

我用来将 jar 加载到 oracle 中的命令是：

```
loadjava -v -f -resolve -resolver "((* OER) (* PUBLIC))" -user oer/***** AssetExtractor.jar 
```

任何想法都会有所帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T14:19:35.043

所以看来，如果我执行以下操作，它几乎可以解决我所有的问题：

编辑 Oracle 用户的 .profile 以使用正确的路径设置和导出 CLASSPATH、PATH、LD_LIBRARY_PATH、ORACLE_HOME、JAVA_HOME

SQLPlus as sys as sysdba

```
EXEC dbms_java.grant_permission( 'OER', 'SYS:java.util.PropertyPermission', 'java.class.path', 'write' ); 
```

作为 oracle 用户的操作系统命令行：

```
loadjava –v –grant PUBLIC <jar> -user oer/****** for all jars 
```

SQLPlus 作为 OER 用户

```
DECLARE
   v_classpath VARCHAR2(4000);
   v_path VARCHAR2(4000);
BEGIN
   v_classpath := DBMS_JAVA.set_property('java.class.path',    '/opt/oracle/102/jdk/lib:/mnt/hgfs/vmshare/rex_lib/aler-axis-   1.2.1.jar:/mnt/hgfs/vmshare/rex_lib/aler-axis-jaxrpc-1.2.1.jar:/mnt/hgfs/vmshare/rex_lib/client.rex-   11.1.1.5.0.jar:/mnt/hgfs/vmshare/rex_lib/commons-httpclient-3.0rc2-   flashline.jar:/mnt/hgfs/vmshare/rex_lib/log4j-1.2.8.jar');
   v_path := DBMS_JAVA.set_property('java.path', '/opt/oracle/102/jdk/bin');
END;
/

alter java source "AssetExtractor" compile;
show errors 
```

唯一突出的问题是，由于某种原因，它仍然无法定位/解析某些 Oracle OER 类（它们应该都在 client.rex*.jar 中，我在那里打开并看到它们。如果我能解决这部分那我可以走了。

# ocean - 取消订阅 IObservableElementEnumerable.EnumerableChanged 不起作用？

> ID：10922416
> 
> 赞同：3
> 
> 时间：2012-06-06T21:14:59.580
> 
> 标签：ocean

我们的部分 UI 使用 IObservableElementEnumerable.EnumerableChanged 来更新用户，例如从文件夹中删除域对象。

当 UI 被释放时，我们取消订阅事件......或者我们认为。事实证明，取消订阅没有任何效果，我们的事件处理程序仍然被调用。这导致了许多奇怪的错误，但也导致了内存泄漏。

唯一一次取消订阅是，如果我们存储 IObservableElementEnumerable 引用而不是再次调用 IObservableElementEnumerableFactory.GetEnumerable(obj)。但是，这反过来很可能会保留对文件夹对象的实时引用，如果文件夹本身被用户删除，这将中断。

这尤其令人费解，因为 GetEnumerable() 文档清楚地指出：“预计使用相同域对象的后续调用将产生相同的 IObservableElementEnumerable 实例。” 这不应该被解释为保证吗？

是否应该有任何理由取消订阅不起作用？

以下代码复制了 Petrel 2011 上的问题（添加到带有菜单扩展的简单插件，或在[此处](http://dl.dropbox.com/u/29519/ObservableElementEnumerable.zip)获取完整解决方案（DropBox））：

```
using System;
using System.Linq;
using System.Windows.Forms;
using Slb.Ocean.Core;
using Slb.Ocean.Petrel;
using Slb.Ocean.Petrel.Basics;
using Slb.Ocean.Petrel.UI;

namespace ObservableElementEnumerable
{
  public class OEEForm : Form
  {
    private Droid _droid;
    private bool _disposed;

    public OEEForm()
    {
      IInput input = PetrelProject.Inputs;
      IIdentifiable selected = input.GetSelected<object>().FirstOrDefault() as IIdentifiable;
      if (selected == null)
      {
        PetrelLogger.InfoOutputWindow("Select a folder first");
        return;
      }
      _droid = selected.Droid;

      GetEnumerable().EnumerableChanged += enumerable_EnumerableChanged;
      PetrelLogger.InfoOutputWindow("Enumerable subscribed");
    }

    protected override void Dispose(bool disposing)
    {
      base.Dispose(disposing);
      if (disposing && !_disposed)
      {
        GetEnumerable().EnumerableChanged -= enumerable_EnumerableChanged;
        PetrelLogger.InfoOutputWindow("Enumerable unsubscribed (?)");
        _droid = null;
        _disposed = true;
      }
    }

    IObservableElementEnumerable GetEnumerable()
    {
      if (_disposed)
        throw new ObjectDisposedException("OEEForm");
      object obj = DataManager.Resolve(_droid);
      IObservableElementEnumerableFactory factory = CoreSystem.GetService<IObservableElementEnumerableFactory>(obj);
      IObservableElementEnumerable enumerable = factory.GetEnumerable(obj);
      return enumerable;
    }

    void enumerable_EnumerableChanged(object sender, ElementEnumerableChangeEventArgs e)
    {
      PetrelLogger.InfoOutputWindow("Enumerable changed");
      if (_disposed)
        PetrelLogger.InfoOutputWindow("... but I am disposed and unsubscribed!");
    }
  }

  public static class Menu1
  {
    public static void OEEBegin1_ToolClick(object sender, System.EventArgs e)
    {
      OEEForm f = new OEEForm();
      f.Show();
    }
  }
} 
```

要复制：

1.  使用插件运行 Petrel
2.  加载带有包含对象的文件夹的项目
3.  选择文件夹
4.  激活插件菜单项
5.  打开弹出窗口，删除文件夹中的对象
6.  关闭弹出的表单
7.  删除文件夹中的对象

消息日志应该清楚地显示在处理表单后仍然调用事件处理程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T19:02:31.043

您已经通过连接事件保留了对底层可枚举的引用。事件也是参考。只需保留对可枚举的引用并从与您订阅的实例相同的实例中取消订阅。

要处理用户删除对象的问题，您需要监听删除事件。

# android - 用我在背景上获得的图像刷新 android 中的图像视图

> ID：10922417
> 
> 赞同：1
> 
> 时间：2012-06-06T21:15:04.497
> 
> 标签：android, multithreading, sockets, background, imageview

我的问题与此线程有关 [-如何在 android 中刷新 imageview](https://stackoverflow.com/questions/8703407/how-to-refresh-imageview-in-android)

我也试图通过套接字获取图像，对其进行解码，并将其设置在图像视图上。套接字需要保持打开状态，以防发送另一个图像，然后再次更新图像视图。

当在另一个线程中他们响应不在主线程中执行此操作时，我没有得到该部分。

从主要活动中，我应该打开一个新线程，该线程将“卡住”在“while（true）”上，以便它可以继续收听即将到来的图像，并且当发送完整图像时，它需要更新图像视图。但是imageview在主线程中（主线程等于UI线程？）所以它开始对我来说有点问题......

任何人？

// ADDED - 这是我的 asyncTask -

```
public class AsyncTask extends AsyncTask<Void, Void, Void> {
 private DataInputStream dataInputStream = null;
 private ImageView iv = null;

 public RobotMapAsyncTask(DataInputStream dataStream, ImageView imageView) {
     dataInputStream = dataStream;
     iv = imageView;
 }

@Override
protected Void doInBackground(Void... params) {
    ByteArrayOutputStream buffer = new ByteArrayOutputStream();
    byte[] byteChunk = new byte[1024];
    Bitmap bitmap = null;
    int c;

    if (dataInputStream != null) {
        while (true) {
            try {
                byteChunk = new byte[1024];
                while ((c = dataInputStream.read(byteChunk)) != -1){
                    buffer.write(byteChunk, 0, c);
                }
            } catch (IOException e) {
                e.printStackTrace();
            }

            bitmap = BitmapFactory.decodeByteArray(byteChunk, 0, byteChunk.length);

            if (bitmap != null) {
                //runOnUiThread(new Runnable() {
                    //public void run() {
                        //iv.setImageBitmap(bitmap);
                    //}
               // }); 
            }
        }
    }

    return null;
} 
```

但后来我显然不能调用 runOnUiThread 因为这不是一个活动......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T21:23:08.760

获得新图像后，调用：

```
runOnUiThread(new Runnable() {
        public void run() {
            imView.setBackgroundResource(yourResource);
        }
    }); 
```

只需进行明显的更改以适合您的代码

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T21:18:14.513

`Activity.runOnUIThread(Runnable)` 在由或启动的 Runnable 中更改 ImageView 的图像`Handler.post(Runnable)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T21:24:31.933

您可以通过两种方式做到这一点：

a) 一种方法是使用处理程序调用工作线程，并且可以从主线程运行，该线程执行图像的获取和解码。获得解码图像后，只需从工作线程设置图像视图

b) 或者，您可以使用 android 的异步任务功能来获取图像并更新主线程上的图像视图

# google-maps - Google Maps API KML 气球不可见

> ID：10922418
> 
> 赞同：0
> 
> 时间：2012-06-06T21:15:08.240
> 
> 标签：google-maps, kml, balloon

我正在使用带有 KML 图层的 Google Maps JavaScript API v3 来显示带有自定义标记的地图。

我的地图链接到我作为 Google 站点附件发布的 KML 文件。加载后，地图会正确显示 KML 文件中的每个 PlaceMark，但不会显示弹出气球。

很少当我单击一个图钉时，它会显示气球（5% 的时间），然后其他图钉都不起作用。当我放大和缩小我的自定义 pin 图像时，偶尔会恢复为默认 pin 图像。

我添加了 layerOptions 来明确地将 clickable 设置为 true 并将 suppressInfoWindows 设置为 false。它没有改变气球的行为。

我已经用 Chrome v19、Firefox v12 和 IE8 进行了测试。

**更新1：**

我在我的 KML 中发现了一个错字 (bal*l*oon)。仍然无法正常工作。有什么东西让别针有问题。

**更新 2：**

v3 现在正在运行。谷歌的缓存使得这很难测试。向 KML URL 添加了“?nocache=0”以防止缓存。BaloonStyle 是问题所在，但缓存导致错字仍然存在。将 KML 迁移到个人服务器。

[实时 HTML 地图页面](http://arapaho.nsuok.edu/~deckar01/CherokeeCompass/maps.html)（固定）

[实时 KML 下载](http://arapaho.nsuok.edu/~deckar01/CherokeeCompass/overlay.xml)（固定）

**我的参考资料：**

*   [http://developers.google.com/maps/documentation/javascript/reference](http://developers.google.com/maps/documentation/javascript/reference)
*   [http://ge.images.alaska.edu/workshop/advanced.htm](http://ge.images.alaska.edu/workshop/advanced.htm)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T21:48:25.447

Google is caching your KML on purpose. The workaround is to append something like the current time to the end of your URL so that it is different every time:

```
var kmlFile = 'http://www.myserver.com/my.kml?'+(new Date()).getTime();
var kmlLayer = new google.maps.KmlLayer(kmlFile);
kmlLayer.setMap(myMap); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T14:49:28.037

**我的问题：**

*   我的 BalloonStyle 标签中有错字
*   我的 KML 文件的过时缓存

**如果：**

*   Google Maps JS 在解析 KML 时抛出错误
*   谷歌缓存相当快
*   我开始在服务器上测试

**更新：**

我将 KML 文件移动到我的服务器，但在第一次更改后缓存仍然过时。当我的 Google Map 对象加载 KML 覆盖时，似乎会发生缓存。我确保它不是我的系统或我的服务器缓存。

如果我对我的 KML 进行更改并且缓存没有更新，则这些引脚开始出现故障。我所有的图钉都显示在正确的位置，但其中一个图钉没有气球。改了文件名，正常！

**更新 2：**

我将此缓存行为报告为 Google Maps JS API 上的一个错误。

[http://code.google.com/p/gmaps-api-issues/issues/detail?id=4196](http://code.google.com/p/gmaps-api-issues/issues/detail?id=4196)

**结论：**

我编写了 ASP.NET/C# 类来对地址进行地理编码，并在比发现此错误所需的时间更短的时间内构建 KML 文档。

停止缓存如此艰难的谷歌！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T22:33:46.313

您的 KML 无效。 `<Name>`不是规范的一部分。将其更改为`<name>`，您应该一切顺利。

# regex - API 文档注释的正则表达式

> ID：10922421
> 
> 赞同：1
> 
> 时间：2012-06-06T21:15:19.940
> 
> 标签：regex

是否有如下评论的正则表达式：

```
/**
 * -string- (possible line) 
-possibly more lines like the above one-
 */ 
```

例如：

```
/**
 * The Boring class implements this and that
 * and also...
 * does this and that
 */ 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-06T21:17:42.283

`/\*\*.*?\*/`带有 dotall （点匹配所有）标志的简单应该可以解决问题。虽然它可能需要不同的转义或可能的分隔符，具体取决于您使用的正则表达式引擎的风格。

如果您的引擎中没有 dotall，请尝试以下操作：

```
/\*\*[\s\S]*?\*/ 
```

# ruby-on-rails - 将我的存储库推送到 Github 的另一个错误

> ID：10922427
> 
> 赞同：0
> 
> 时间：2012-06-06T21:15:30.590
> 
> 标签：ruby-on-rails, git, github, terminal

当我进入终端时：

```
Parkers-MacBook-Pro:first_app ppreyer$ git remote add origin git@github.com:ppreyer/first_app.git
Parkers-MacBook-Pro:first_app ppreyer$ git push origin master 
```

我收到以下错误：

```
error: src refspec master does not match any.
error: failed to push some refs to 'git@github.com:ppreyer/first_app.git' 
```

任何帮助将不胜感激。

所以我回去并在终端中输入以下内容并得到另一个错误：

```
Parkers-MacBook-Pro:first_app ppreyer$ git init
Reinitialized existing Git repository in /Users/ppreyer/.ssh/first_app/first_app/.git/
Parkers-MacBook-Pro:first_app ppreyer$ git add .
Parkers-MacBook-Pro:first_app ppreyer$ git commit -m
error: switch `m' requires a value
usage: git commit [options] [--] <filepattern>...

    -q, --quiet           suppress summary after successful commit
    -v, --verbose         show diff in commit message template

Commit message options
    -F, --file <file>     read message from file
    --author <author>     override author for commit
    --date <date>         override date for commit
    -m, --message <message>
                          commit message
    -c, --reedit-message <commit>
                          reuse and edit message from specified commit
    -C, --reuse-message <commit>
                          reuse message from specified commit
    --fixup <commit>      use autosquash formatted message to fixup specified commit
    --squash <commit>     use autosquash formatted message to squash specified commit
    --reset-author        the commit is authored by me now (used with -C-c/--amend)
    -s, --signoff         add Signed-off-by:
    -t, --template <file>
                          use specified template file
    -e, --edit            force edit of commit
    --cleanup <default>   how to strip spaces and #comments from message
    --status              include status in commit message template

Commit contents options
    -a, --all             commit all changed files
    -i, --include         add specified files to index for commit
    --interactive         interactively add files
    -o, --only            commit only specified files
    -n, --no-verify       bypass pre-commit hook
    --dry-run             show what would be committed
    --short               show status concisely
    --branch              show branch information
    --porcelain           machine-readable output
    -z, --null            terminate entries with NUL
    --amend               amend previous commit
    --no-post-rewrite     bypass post-rewrite hook
    -u, --untracked-files[=<mode>]
                          show untracked files, optional modes: all, normal, no. (Default: all) 
```

error: switch `m' requires a value 是什么意思？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T11:15:49.933

该错误意味着您忘记在“提交”命令之后添加提交消息。

正确用法是：

```
$ git commit -m "Initial Commit" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T11:09:27.907

看起来您的遥控器没有主分支（您可能刚刚创建它并且它是空的？）

使用以下方法之一创建主分支：

```
git push -u origin master 
```

或者

```
git push origin master:master 
```

# desire2learn - 为什么管理工具中缺少“管理可扩展性”工具

> ID：10922433
> 
> 赞同：-3
> 
> 时间：2012-06-06T21:15:44.990
> 
> 标签：desire2learn

我正在尝试开始使用 Valence 2.0。

按照说明，我应该点击管理工具下的“管理可扩展性”工具。这似乎在任何地方都不存在。我们正在运行 D2L v9.4.1。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T22:19:02.227

**更新：**

有一个名为“管理可扩展性”的权限控制“管理可扩展性”工具的可见性。你也许可以调整它。

如果没有，我会向 Desire2Learn 开一张支持票，因为您遇到了服务器/配置问题。

# cmd - 什么是打开 cmd 窗口的批处理文件命令？

> ID：10922435
> 
> 赞同：0
> 
> 时间：2012-06-06T21:15:46.337
> 
> 标签：cmd, dos

是的，顺便说一句，我试着用谷歌搜索这个。

基本上，将打开dos命令窗口的dos命令是什么？

换句话说，如果您有一个充满脚本命令的 .bat 文件，您可以执行什么命令来打开命令窗口？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T21:19:01.767

你可以试试这个。在命令行中它会启动它，所以我假设在一个 bat 文件中它会做同样的事情。

```
start cmd 
```

如果你想让它运行另一个蝙蝠或你可以做的事情：

```
start script.bat 
```

如果你想让它关闭，那么：

```
start cmd /c script.bat 
```

# algorithm - 地址簿和trie结构

> ID：10922442
> 
> 赞同：3
> 
> 时间：2012-06-06T21:16:28.880
> 
> 标签：algorithm, search, addressbook, prefix-tree, patricia-trie

我有一个问题问你。我必须实现一个包含 30000 个名称的业务通讯簿。所有名称都包含名字和姓氏。我必须实现一个自动完成文本框，它不仅可以搜索输入名字，还可以搜索姓氏。在 google 上搜索我发现这个问题是使用 patricia trie 解决的，但它只做前缀搜索，所以如果我用 firstname+lastname 创建一个 trie，我如何不仅可以按名字搜索，而且可以按姓氏搜索？

我是否必须复制插入两个这样的字符串的条目？名字+姓氏和姓氏+名字

请帮我！！！

搜索必须非常有效。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T21:22:17.240

另一种可能性是创建两次尝试。

第一个（让它成为`T1`）用于名字，第二个（让它成为`T2`）用于姓氏。

当您构造 trie 时，从 in 中的每个单词终止符`T1`（通常表示为`$`符号）添加指向 in 中相关条目的指针列表，`T2`反之亦然。

IE 如果 John Doe 是主菜：

```
T1:
     J
     |
     O
     |
     H
     |
     N
     |
     $1
T2:
     D
     |
     O
     |
     E
     |
     $2 
```

$1 将保存一个包含指向 $2 的指针的列表，$2 将保存一个包含 $1 的列表。

每个前缀搜索都将搜索两次尝试，让您自动完成，然后使用指针获取全名（部分搜索只给您名字/姓氏，您使用指针获得第二个名字）。

搜索全名是通过在两次尝试中搜索完成的（在 中查找名字`T1`和在 中查找姓氏，并分别`T2`获取相关的和），然后您需要检查指针是否匹配（包含中的列表和列表在包含）。如果他们这样做 - 名字在字典里。`$1``$2``l1``$1``$2``l2``$2``$1`

请注意，一旦您有了指向该`$`节点的指针，就可以简单地返回 trie，直到您到达根以获取该`$`符号所代表的单词。（需要每个节点指向父节点的指针）

另请注意：我解释了简单的尝试，但实际上没有理由不使用帕特里夏尝试，使用相同的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T21:20:57.467

是的，最简单的解决方案是插入两个变体。但是，这应该只复制搜索字符串，而不是条目。您可能希望以某种方式规范名字和姓氏之间的分隔（=删除地址簿和用户输入的标点符号），因此您将在所有情况下找到输入条目，例如“John Doe”、“Doe ，约翰”，“约翰”等。

我不会使用部分 trie，而只是使用平衡树。在许多语言中，您会发现平衡树作为库中的排序映射实现（至少 Java 和 C++）。

# gis - 将 X,Y 转换为纬度经度到 ESRI shapefile

> ID：10922444
> 
> 赞同：2
> 
> 时间：2012-06-06T21:16:39.317
> 
> 标签：gis, latitude-longitude

警告：我对 GIS 一无所知。当然，这一点很快就会变得非常明显。我的词汇量也不会准确，抱歉。

我需要重新创建看起来像“真实地理空间”地图的“战略地图”的一部分：

![在此处输入图像描述](../Images/3c6e9b61c72278d9fc0f0e2d62ddba32.png)

为什么？因为如果我能设法在地图上以正确的关系绘制方框（“最大化股东价值”、“超出客户期望”等），我可以在数据可视化工具中做一些非常有趣的事情。一起工作。

我可以在 Visio 中构建上面的策略图，然后使用脚本将我关心的形状导出为 X、Y 点或多边形。上面的其中一个框在导出后可能看起来像这样：

```
ShapeNo ShapeName PointNo   X    Y
1       Exceed Cust 2       37  155
1       Exceed Cust 4       116 155
1       Exceed Cust 6       116 234
1       Exceed Cust 8       37  234
1       Exceed Cust 10      37  155 
```

...或者它可能看起来像这样：

```
 POLYGON ((37 155, 116 155, 116 134, 37 234, 37,155)) 
```

无论如何，我有一堆点，我需要将它们转换为纬度/经度坐标，使用纬度/经度 (0,0) 作为我的参考点。在上面的地图中，0,0 可能位于“超出客户期望”框下方 - 或多或少是死点。

然后，我怀疑我可以找到一个工具，将这些杂乱无章的东西转换成 ESRI shapefile，我可以直接导入到我的 dataviz 工具中。

是否有任何已知的（免费）工具、脚本、库等可以为我做这些？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T21:11:47.570

你的问题不应该用 GIS 来解决，但我很感激你发现了一些需要 shapefile 的很酷的 dataviz 功能。

问题是您想要获取一些 x,y 点并将它们转换为纬度/经度。经纬度专门指地球表面上的点，您的问题中的点与地球表面无关。

另一种思考方式是，你试图随机取一个点，说一个代表俄罗斯的首都，另一个代表德国的一个大城市等。

另一个问题是您希望有一个 0,0 参考点，但纬度和经度有一个基准点作为参考点，它是一个特定的地理位置。

如果没有更多关于您对图形设计工具的熟悉程度的信息，很难建议一种替代方法来解决您的问题，但是使用 GIS 的纬度/经度并不是要寻找的方向。

许多人确实将 x,y 点转换为纬度/经度，但这不是直接转换。笛卡尔坐标需要已知的投影和基准，才能使该转换准确。

查看此[链接](http://www.connect.net/jbanta/FAQ.html)以深入解释为什么不能将任意 x,y 转换为纬度/经度。

另一方面，为战略地图设计提供开箱即用的原创创意 +1！

# android - 如何将外部 settings.xml 中的 maven 设置用于 maven-android-plugin 项目？

> ID：10922447
> 
> 赞同：1
> 
> 时间：2012-06-06T21:16:59.193
> 
> 标签：android, maven-3

我创建了一个 Android Maven 项目，正如本文所述（[链接到文章](http://stand.spree.de/wiki_details_maven_archetypes)）。我使用最后一个原型：android-release。

所以一切正常，除了我想发布一个版本时，我不知道如何传递证书属性。我创建了一个包含以下内容的 settings.xml：

```
<?xml version="1.0" encoding="UTF-8"?>

<settings xmlns="http://maven.apache.org/SETTINGS/1.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/SETTINGS/1.0.0 http://maven.apache.org/xsd/settings-1.0.0.xsd">
<profiles>
    <profile>
        <id>android-debug</id>
        <properties>
            <sign.keystore>/Users/me/.android/debug.keystore</sign.keystore>
            <sign.alias>androiddebugkey</sign.alias>
            <sign.storepass>android</sign.storepass>
            <sign.keypass>android</sign.keypass>
        </properties>
    </profile>

    <profile>
        <id>android-release</id>
        <properties>
            <sign.keystore>/Users/me/myKeystore.keystore</sign.keystore>
            <sign.alias>myAlias</sign.alias>
            <sign.storepass><![CDATA[myPassword]]></sign.storepass>
            <sign.keypass><![CDATA[myPassword]]></sign.keypass>
        </properties>
    </profile>

</profiles> 
```

然后我运行：

```
mvn -s setttings.xml clean release:prepare release:perform -Pandroid-release 
```

但我一直忽略 android-release 配置文件中定义的值。

任何想法如何让这个工作？当我刚刚运行时：

```
mvn -s setttings.xml clean install -Pandroid-release,release 
```

它构建一个 apk 并使用正确的证书对其进行签名。所以也许它只是 maven-enforcer-plugin，它无法从 settings.xml 中读取属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T21:56:00.000

> mvn -s setttings.xml 清理发布：准备发布：执行 -Pandroid-release

我不知道为什么它一直忽略 android-release 配置文件中定义的值。

但是，如果您使用 maven-release-plugin，我们用来实现您想要的正常方法是将以下设置添加到您要在发布阶段触发的配置文件中：

```
<profile>
    <id>android-release</id>
    <properties>
        <sign.keystore>/Users/me/myKeystore.keystore</sign.keystore>
        <sign.alias>myAlias</sign.alias>
        <sign.storepass><![CDATA[myPassword]]></sign.storepass>
        <sign.keypass><![CDATA[myPassword]]></sign.keypass>
    </properties>
    <!-- via this activation the profile is automatically used when the release 
        is done with the maven release plugin -->
    <activation>
        <property>
            <name>performRelease</name>
            <value>true</value>
        </property>
    </activation>
</profile> 
```

所以现在如果你这样做了`mvn -s setttings.xml clean release:prepare release:perform`，maven-release-plugin 会自动选择`profile android-release`.

请注意，配置文件在发布阶段会自动激活，如果不涉及 maven-release-plugin，您仍然可以使用经典方式`mvn -s setttings.xml clean install -Pandroid-release`使构建过程使用特定的`profile android-release`.

查看[maven-release-plugin 文档](http://maven.apache.org/plugins/maven-release-plugin/perform-mojo.html#useReleaseProfile)了解更多详细信息。

# node.js - 使用 init.d 重新启动 Node.js 应用程序

> ID：10922450
> 
> 赞同：6
> 
> 时间：2012-06-06T21:17:03.677
> 
> 标签：node.js, init.d

如果我的 node.js 应用程序崩溃，我想要一个 init.d 守护程序重新启动它。此脚本启动/停止我的节点应用程序。如果它崩溃，我没有运气让它重新启动应用程序。

我在 CentOS 下运行。我错过了什么？

```
#!/bin/sh
. /etc/rc.d/init.d/functions

USER="rmlxadmin"
DAEMON="/usr/bin/nodejs"
ROOT_DIR="/home/rmlxadmin"

SERVER="$ROOT_DIR/my_node_app.js"
LOG_FILE="$ROOT_DIR/app.js.log"

LOCK_FILE="/var/lock/subsys/node-server"

do_start()
{
        if [ ! -f "$LOCK_FILE" ] ; then
                echo -n $"Starting $SERVER: "
                runuser -l "$USER" -c "$DAEMON $SERVER >> $LOG_FILE &" && echo_success || echo_failure
                RETVAL=$?
                echo
                [ $RETVAL -eq 0 ] && touch $LOCK_FILE
        else
                echo "$SERVER is locked."
                RETVAL=1
        fi
}
do_stop()
{
        echo -n $"Stopping $SERVER: "
        pid=`ps -aefw | grep "$DAEMON $SERVER" | grep -v " grep " | awk '{print $2}'`
        kill -9 $pid > /dev/null 2>&1 && echo_success || echo_failure
        RETVAL=$?
        echo
        [ $RETVAL -eq 0 ] && rm -f $LOCK_FILE
}

case "$1" in
        start)
                do_start
                ;;
        stop)
                do_stop
                ;;
        restart)
                do_stop
                do_start
                ;;
        *)
                echo "Usage: $0 {start|stop|restart}"
                RETVAL=1
esac
exit $RETVAL 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-06T23:21:17.290

对于这种情况，您需要使用其他工具，例如[node-supervisor 。](https://github.com/isaacs/node-supervisor)

1.  使用 npm 安装 node-supervisor：

    sudo npm install -g 主管

2.  将 init.d 脚本中的 DAEMON 变量更改为 node-supervisor 可执行文件：/usr/bin/supervisor。您可以在系统中使用命令“whereis supervisor”检查此路径（当然是在安装之后）。

现在，如果应用程序崩溃，主管将重新启动您的应用程序。

# php - 正则表达式 (? 我试图理解一段代码，并遇到了 PHP 的 preg_replace 函数中使用的这个正则表达式。 '/(?

> ID：10922458
> 
> 赞同：9
> 
> 时间：
> 
> 标签：php, regex, pcre

我试图理解一段代码，并遇到了 PHP 的 preg_replace 函数中使用的这个正则表达式。

```
'/(?<!-)color[^{:]*:[^{#]*$/i' 
```

这一点……`(?<!-)` 没有出现在我的任何正则表达式手册中。请问有人知道这是什么意思吗？（谷歌不返回任何东西——我认为符号在谷歌中不起作用。）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-06T21:23:25.170

`?<!`括号组开头的 是否定的[lookbehind](http://www.regular-expressions.info/lookaround.html)。它断言这个词`color`（严格来说，`c`在引擎中）前面没有`-`字符。

因此，对于更具体的示例，它将`color`在字符串中匹配：

```
color
+color
someTextColor 
```

但它会在类似的东西上失败`-color`or `background-color`。另请注意，引擎在技术上不会“匹配” 之前的任何内容`c`，它只是断言它不是连字符。这可能是一个重要的区别，具体取决于上下文（[在 Rubular 上用一个简单的示例进行了说明](http://rubular.com/r/vfjHHLxpyc)；请注意，*只有*`b`最后一个字符串中的匹配，而不是前面的字母）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-06T21:25:03.850

PHP 对 preg_* 函数使用 perl 兼容的正则表达式 (PCRE)。来自`perldoc perlre`：

> `"(?<!pattern)"`
> 一个零宽度的否定后向断言。例如
> `"/(?<!bar)foo/"`匹配任何
> 不跟随的“foo” `"bar"`。仅适用于固定宽度的
> 后视。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-06T21:27:59.010

我正在使用 Python 的 re 模块学习正则表达式！

[http://docs.python.org/library/re.html](http://docs.python.org/library/re.html)

> 如果字符串中的当前位置之前没有匹配 ...，则匹配。这称为否定后向断言。与肯定的后向断言类似，包含的模式必须只匹配一些固定长度的字符串。以否定后向断言开头的模式可能在被搜索的字符串的开头匹配。

# flash - 我已经编辑了我的 Flash 但它仍然使用旧设置？

> ID：10922459
> 
> 赞同：0
> 
> 时间：2012-06-06T21:17:53.450
> 
> 标签：flash, adobe, browser-cache

当点击英国的县时，我编辑了一个交互式 Flash 地图以链接到 url。

现在我在苏格兰 - Abderdeenshire 使用 google.com 作为测试。

然后我将其更改为链接到正确的 url 并链接另一个 4/5 但除了链接到 google.com 的初始 aberdeenshire 之外，它们都没有工作

我不明白，因为我现在已经删除并替换了所有文件，清除了浏览器缓存甚至闪存缓存。

为什么我在 Flash 地图上看不到更新？

它位于我的网站上 手动处理培训 Hq dot co dot uk

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T21:40:20.733

您会展示一些您用来完成此类任务的代码吗？另一方面，请仔细检查您是否将 SWF 上传到正确的位置。它发生在我身上，花了 30 分钟查看屏幕为什么它不起作用，直到我意识到我将新文件上传到错误的目录。

# c# - C# 中的 .CMD 执行莫名其妙地失败

> ID：10922463
> 
> 赞同：0
> 
> 时间：2012-06-06T21:18:13.670
> 
> 标签：c#, command-line, process

我正在尝试从 C# 程序执行 .cmd 进程。当我在命令行中运行该进程时，即

```
C:\Directory\Process.cmd  -x 1000 -y 1000 C:\Input\input.txt 
```

我得到了适当的结果（在这种情况下，这意味着该进程将文件写入：

```
C:\Output\output.txt 
```

但是，当我尝试从一个简单的 C# 程序运行此过程时，不会创建输出文件。以下是我的一些尝试：

尝试 1)

```
try
{
    string processName = @"C:\Directory\Process.cmd";
    string argString = @" -x 1000 -y 1000 C:\Input\input.txt"; //The extra space in front of the '-x' is here on purpose
    Process prs = new Process();
    prs.StartInfo.UseShellExecute = false;
    prs.StartInfo.RedirectStandardOutput = false;
    prs.StartInfo.FileName = processName;
    prs.StartInfo.Arguments = argString;
    prs.StartInfo.WindowStyle = ProcessWindowStyle.Normal;

    prs.Start()
}
catch (Exception e)
{
    Console.Writeline(e.Message);
} 
```

尝试 2)

```
try
{
    System.Diagnostics.Process.Start(@"C:\\Directory\\Process.cmd", " -x 1000 -y 1000 C:\\Input\\input.txt";
}
catch (Exception e)
{
    Console.Writeline(e.message);
} 
```

现在，在这两种情况下，都没有抛出异常，并且 Process.cmd 被访问（它在 shell 中打印状态更新），但该进程不会创建任何输出文件。我尝试调用 Process.cmd 的方式是否有问题，当我直接从命令行运行时它可以正常工作，但当我尝试从我的 C# 程序调用它时它不能正常工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T21:58:03.340

你这个？

```
System.Diagnostics.Process.Start("cmd.exe", @"/c C:\Directory\Process.cmd -x 1000 -y 1000 C:\Input\input.txt"); 
```

AFAIK，'@' 前置逐字字符串，不需要反斜杠掩码）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T21:42:04.080

该文件可能正在创建，但不是您认为的。采用

```
prs.StartInfo.WorkingDirectory = "yourpath" 
```

[http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.workingdirectory.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.workingdirectory.aspx)

> 如果提供了 UserName 和 Password，则必须设置 WorkingDirectory 属性。如果未设置该属性，则默认工作目录为 %SYSTEMROOT%\system32。
> 
> 如果目录已经是系统路径变量的一部分，则不必在此属性中重复目录的位置。
> 
> 当 UseShellExecute 为 true 时，WorkingDirectory 属性的行为与 UseShellExecute 为 false 时不同。当 UseShellExecute 为 true 时，WorkingDirectory 属性指定可执行文件的位置。如果 WorkingDirectory 是一个空字符串，则当前目录被理解为包含可执行文件。
> 
> 当 UseShellExecute 为 false 时，WorkingDirectory 属性不用于查找可执行文件。相反，它由已启动的进程使用，并且仅在新进程的上下文中才有意义。

在意识到路径作为参数传入并且可能对它写入的文件使用硬编码的路径逻辑后，我删除了它，但由于评论引用了它，我将取消删除以防它仍然有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T12:47:31.597

所以我终于能够拿到源代码，并意识到问题出在java代码中......它将项目目录解释为输出目录。谢谢大家的帮助，你们提供了一些非常有用的信息！

# mysql - 如何在不使用 group by 语句的情况下选择不同的行

> ID：10922464
> 
> 赞同：15
> 
> 时间：2012-06-06T21:18:14.233
> 
> 标签：mysql, sql

```
A B C
1 1 1 
1 1 1 
2 2 2 
2 2 2 
3 3 3 
3 3 3 
4 4 4 
4 4 4 
5 5 5 
5 5 5 
5 5 5 
6 6 6
6 6 6 
```

我只输出不同的行而不使用 group by 语句。我不能使用 group by，因为它会使 mysql 挂起。所以它应该返回

```
1 1 1
2 2 2 
3 3 3 
4 4 4 
5 5 5 
6 6 6 
```

我正在使用 DISTINCT 进行内部连接。这也不起作用：

```
SELECT DISTINCT * FROM TABLEA inner join TABLEB on TABLEA.A = TABLEB.A 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-06T21:19:35.353

```
SELECT DISTINCT A,B,C FROM TABLE; 
```

根据 mysql 文档，DISTINCT 指定从结果集中删除重复行（[http://dev.mysql.com/doc/refman/5.0/en/select.html](http://dev.mysql.com/doc/refman/5.0/en/select.html)）

我在 jsfiddle 上创建了一个示例，恕我直言

```
create table tablea (A int,B int,C int);
create table tableb (A int);

INSERT INTO tablea VALUES (1,1,1),(1,1,1),(2,2,2),(2,2,2),(3,3,3),(3,3,3),(4,4,4),(4,4,4),(5,5,5),(5,5,5),(5,5,5),(6,6,6),(6,6,6);
INSERT INTO tableb VALUES (1),(1),(1),(1),(1);

SELECT DISTINCT tablea.A,tablea.B,tablea.C FROM tablea INNER JOIN tableb ON tablea.A=tableb.A; 
```

随意尝试这个[SQLFiddle](http://sqlfiddle.com/#!2/6f767/3/2)。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-06-06T21:34:40.970

[**这可能会让你大吃一惊，但 MySQL 在后台使用 GROUP BY 来执行 DISTINCT ！！！**](http://dev.mysql.com/doc/refman/5.5/en/distinct-optimization.html)

这是您可能想尝试的东西

如果表被调用`mytable`，请执行以下两件事：

首先运行这个

```
ALTER TABLE mytable ADD INDEX ABC (A,B,C);` 
```

二、运行这个查询

```
SELECT A,B,C FROM mytable GROUP BY A,B,C; 
```

## GROUP BY 实际上在存在索引的情况下效果更好！

这是证明它有效的示例代码

```
mysql> drop database if exists cool_cs;
Query OK, 1 row affected (0.04 sec)

mysql> create database cool_cs;
Query OK, 1 row affected (0.00 sec)

mysql> use cool_cs
Database changed
mysql> create table mytable
    -> (A int,B int,C int, key ABC (A,B,C));
Query OK, 0 rows affected (0.08 sec)

mysql> INSERt INTO mytable VALUES
    -> (1,1,1),(1,1,1),(2,2,2),(2,2,2),(3,3,3),
    -> (3,3,3),(4,4,4),(4,4,4),(5,5,5),(5,5,5),
    -> (5,5,5),(6,6,6),(6,6,6);
Query OK, 13 rows affected (0.06 sec)
Records: 13  Duplicates: 0  Warnings: 0

mysql> select a,b,c FROM mytable group by a,b,c;
+------+------+------+
| a    | b    | c    |
+------+------+------+
|    1 |    1 |    1 |
|    2 |    2 |    2 |
|    3 |    3 |    3 |
|    4 |    4 |    4 |
|    5 |    5 |    5 |
|    6 |    6 |    6 |
+------+------+------+
6 rows in set (0.02 sec)

mysql> 
```

试试看 ！！！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-11-20T16:15:45.553

如果您（或其他任何人）真的想在不使用 DISTINCT 或 GROUP BY 语句的情况下获得不同的结果，则可能是这样：

```
SELECT
    a.name
FROM person a
LEFT JOIN person b
    ON (a.name = b.name OR (a.name IS NULL AND b.name IS NULL))
    AND a.id < b.id
WHERE b.id IS NULL 
```

不过，这是一件相当古怪的事情。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-06T21:20:53.293

DISTINCT 关键字可以满足您的需求。即，如果您的表的名称是 A，`select distinct * from A`则可以解决问题。

参照。mysql手册：[http ://dev.mysql.com/doc/refman/5.0/en/select.html](http://dev.mysql.com/doc/refman/5.0/en/select.html)

# sql - 将外部选择行变量传递给oracle中的内部选择

> ID：10922466
> 
> 赞同：2
> 
> 时间：2012-06-06T21:18:19.223
> 
> 标签：sql, oracle

如何在 oracle 中将外部选择行变量传递给内部选择，这是一个示例查询（其他外部连接已被删除。此查询将在应用程序的生命周期内加载 1 次）。此查询有效

```
select  l5.HIERARCHY_ID,
    (select wm_concat(isbn) isbns from (
        select  op.isbn from oproduct op
        LEFT JOIN  assignment ha on  op.r.reference = ha.reference
        where ha.hierarchy_id =  '100589'))isbns 
from level l5 where l5.gid = '1007500000078694' 
```

但是当我更改内部选择的 where 子句时

```
where ha.hierarchy_id =  '100589'))isbns 
to
where ha.hierarchy_id =  l5.HIERARCHY_ID))isbns 
```

我收到以下错误 ORA-00904: "L5"."HIERARCHY_ID": invalid identifier

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-06T21:24:07.353

您不能传递 2nd level 的值`SELECT`。

例如 -

```
SELECT value1  -- 1st level select
FROM (
      SELECT value2  -- 2nd level select
      FROM ( 
            SELECT value3  -- 3rd level select. 
```

您可以将第一级的值`SELECT`仅用于第二级`SELECT`。同样，第二级`SELECT`中的值仅适用于第一级`SELECT`，第三级`SELECT`不可用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T19:04:17.427

我做了这样的事情来解决这个问题。有一个不必要的选择

```
select  
  l5.HIERARCHY_ID,
  (
    select  
      wm_concat(op.isbn) 
    from 
      oproduct op
      LEFT JOIN assignment ha on op.r.reference = ha.reference
    where ha.hierarchy_id =  l5.HIERARCHY_ID
  ) ISBNS
from 
  level l5 
where 
  l5.gid = '1007500000078694' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T21:34:47.473

我想我正确地阅读了你的 SQL - 当层次结构 id 匹配时你想要一个外连接？

```
SELECT
    l5.hierarchy_id,
    op.isbns
FROM
    LEVEL l5
    LEFT OUTER JOIN
        (SELECT 
            wm_concat (op.isbn) isbns,
            ha.hierarch_id
        FROM
            oproduct op
            LEFT JOIN
                assignment ha
            ON op.reference = ha.reference) op
    ON l5.gid = op.hierarchy_id 
```

# c++ - 光照不变图像

> ID：10922467
> 
> 赞同：11
> 
> 时间：2012-06-06T21:18:31.907
> 
> 标签：c++, opencv

我尝试用openCV创建一个光照不变图像，就像本文中的一样：[http ://www.cvc.uab.es/adas/publications/alvarez_2008.pdf](http://www.cvc.uab.es/adas/publications/alvarez_2008.pdf)

有人知道如何从 OpenCV 中的对数图图像创建该图像吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T15:52:49.453

+1 链接到一篇有趣的论文。

我想我会构建一个函数来转换为日志、划分通道、旋转 theta 并投影到一个轴上。然后我会构建一个函数来测量生成的不变图像的质量。然后我会在 theta 上进行搜索以优化质量。这看起来就像阿尔瓦雷斯正在做的事情。

但首先，我会研究 Luv 颜色空间，它可能是最接近此方案的近似值，无需特殊窄带相机即可。将 uv 空间投影到角度为 theta 的向量上，看看会发生什么。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-12T04:29:15.673

据我所知，这两篇论文是从一个错误的前提出发，得出了一种有趣的方法，用于从 2D（例如来自 Luv 的 uv、来自 HSV 的 HS 等）颜色空间获取 1D 光照不变信息。

他们说照明不变，但他们展示了一种从颜色对的对数比率获取色温不变信息的方法，例如 {log(R/G),log(B/G)}。您可以想象设置，在调光器上有一盏灯，他们绘制颜色比：调暗灯光，是的，照明会发生变化，但色温 T 也会发生变化。

更不用说光不是所有的黑体色温朗伯。这种方法到底怎么行？但他们的结果看起来不错。

因此，使用有趣的方法：最大熵
如上面的回答，将（对数）uv 空间投影到角度为 theta 的向量上。θ应该是什么？搜索 theta 以最大化结果的熵。也就是说，要在一维结果中获得最尖锐的峰。有点像自动对焦。

不过，要回答您的问题，请在 opencv 中使用 calcHist。当然，在计算日志之后。

# javascript - 在 knockout.js 中嵌套 foreach

> ID：10922468
> 
> 赞同：13
> 
> 时间：2012-06-06T21:18:33.897
> 
> 标签：javascript, foreach, knockout.js

我似乎无法让嵌套的 foreach 工作。

JS代码是：

```
$(document).ready(function() {

    function chartValueViewModel(date, price) {
        this.date = date;
        this.price = price;
    }

    function chartViewModel(id, name, lineType, values) {
        this.id = id;
        this.name = name;
        this.lineType = lineType;
        this.values = ko.observableArray(values);
    }

    function liveCurveViewModel() {

        this.chartsData = ko.observableArray([]);
        var chartsData = this.chartsData;

        this.init = function() {

            var mappedCharts = $.map(chartValues,
            function(chart) {
                var mappedValues = $.map(chart.chartValues, function(value) {
                    return new chartValueViewModel(value.dateTime, value.price);
                })
                return new chartViewModel(chart.id, chart.name, chart.liveCurveTypeId, mappedValues);
            });

            chartsData(mappedCharts);
        };
    }

    var vm = new liveCurveViewModel();
    vm.init();
    ko.applyBindings(vm);

}); 
```

html是：

```
<ul data-bind="foreach: chartsData ">
    <li data-bind="text: name">
        <ul data-bind="foreach: values">
           <li data-bind="text: price">
           </li>
        </ul>
    </li>
</ul> 
```

外部循环正确呈现，但我从内部循环中什么也没得到，甚至没有错误消息。我已经检查并填充了 chartViewModel 上的值字段。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-06-06T21:32:08.610

`text`你在外面的绑定`li`正在覆盖它里面的内容，所以它正在吹走你的内在`foreach`。绑定设置了元素的`text`innerText/textContent，它会覆盖当前的子元素。

你会想做这样的事情：

```
<ul data-bind="foreach: chartsData ">
    <li>
        <span data-bind="text: name"></span>
        <ul data-bind="foreach: values">
           <li data-bind="text: price">
           </li>
        </ul>
    </li>
</ul> 
```

# javascript - 数据访问 JS 函数

> ID：10922471
> 
> 赞同：1
> 
> 时间：2012-06-06T21:18:43.713
> 
> 标签：javascript, html, dom-events, javascript-framework

我有几个 Js 函数说`fn1()`，`fn2()`。 `fn1()`页面加载时会自动调用

```
<script >

window.onload=fn1();

 function fn1()
 {
  var list_temp=new Array();
  list_temp.push("testing");
  //etc
 }

 function fn2()
 {
   // Do something after getting the data from fn1()
 }
 </script>` 
```

现在我需要访问`fn1()`from中定义的列表`fn2()`。有什么办法可以做到吗？我记得在某处读到 Javascript 中的函数在某种程度上等同于对象？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T21:23:04.080

简单地声明

```
var list_temp=new Array(); 
```

前

```
function fn1 () 
```

在同一水平

```
window.onload 
```

在顶级脚本声明的变量是全局变量...在 JS var 范围内是函数...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-06T21:23:54.823

您可以在全局范围内定义一个变量，但您也可以将两个函数包装在一个[闭包](https://developer.mozilla.org/en/JavaScript/Guide/Closures#Emulating_private_methods_with_closures)中，并将该变量设为该闭包的私有（本地）：

```
(function() {
   var list_temp = [];
   window.onload = fn1;

   function fn1()
   {
       list_temp.push("testing");
       // etc...
   }

   function fn2()
   {
       console && console.log(list_temp);
       // Do something after getting the data from fn1()...
   }
})(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-06T21:25:17.910

> `window.onload=fn1();`

`fn1`页面加载时不会运行。`fn1` ***立即***运行并将其返回值分配给`window.onload`. 完全一样`x = foo();`。

> 现在我需要从 fn2() 访问 fn1() 中定义的列表。有什么办法可以做到吗？

不，不是定义的。`list_temp`是本地的`fn1`。除非你把它放在`fn2`可以访问它的地方（一些共享范围），`fn2`否则不能访问它。

`window.onload`这是共享范围（并修复事物）的示例：

```
(function() {
    var list_temp=new Array(); // Or better, var list_temp = [];

    window.onload=fn1; // No () at end

    function fn1()
    {
        list_temp.push("testing");
        //etc
    }

    function fn2()
    {
        // Do something after getting the data from fn1()
    }
})(); 
```

或者，当然，你可以使`list_temp`全局。但这通常不是一个好主意。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-06T21:26:50.797

您可以将这些功能链接在一起：

```
function fn1()
{
 var list_temp=new Array();
 list_temp.push("testing");
 //etc
 fn2(list_temp);
}

function fn2(data)
{
  // Do something after getting the data from fn1()
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-06T21:27:55.253

> 我记得在某处读到 javascript 中的函数在某种程度上等同于对象？

是的，所有函数都是对象，继承自一个通用的 Function 原型。您可以在它们上设置自己的属性，就像在所有对象上一样，但这对我们没有帮助。

> 现在我需要从 fn2() 访问在 fn1() 中定义的列表

你不能。的变量声明的`list_temp`范围是函数，它不能从外部获得。所以你可以

*   将变量声明移动到对 fn2 可见的范围内
*   将列表对象导出到 fn2 可见的其他变量。例如，最简单的方法是使用`return`语句。

# shopify - 尝试在 SHOPIFY 中更改订单的履行状态时出现“无法处理的实体”

> ID：10922473
> 
> 赞同：1
> 
> 时间：2012-06-06T21:18:51.360
> 
> 标签：shopify

我正在尝试更改订单的履行状态，这是发送的 json 数据：

{"fulfillment":{"tracking_number":null,"line_items":[{"id":"XXXXXXX"}]}} 这是网址 "/admin/orders/XXXXXXXXX/fulfillments.json" 但我明白了错误“无法处理的实体”。

寻求您的帮助。

谢谢阿拉丁

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T21:40:43.443

响应的主体是什么？

“无法处理的实体”是一个 422 HTTP 响应，一般用于验证错误。验证错误通常会在响应正文中描述错误，这可能有助于调试问题。

编辑：正如大卫安德伍德所说：

> 您需要提供的 ID 用于订单项，而不是多属性。当您获取订单时，您会在响应中看到订单项的 ID。这些是您在创建履行时需要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T01:57:49.603

如果订单和/或订单项已被履行，这通常会发生。另一个常见问题是没有为您的请求设置接受和内容类型标头。

如果情况并非如此，并且其他建议对您有所帮助，您能否发布我要的订单，以便我们调查您的具体情况？

# linux - qemu-kvm 如何在内部创建 VM 线程？

> ID：10922475
> 
> 赞同：3
> 
> 时间：2012-06-06T21:19:08.397
> 
> 标签：linux, qemu, kvm

现在我正在做一个关于 qemu-kvm 和 linux 任务调度程序的项目。我知道每个 VCPU 都是 qemu 创建到 linux 操作系统的正常任务。然后我尝试执行 qemu 命令，看看任务是如何创建的。我使用 strace 来跟踪所有的系统调用。没有像“fork”或“pthreadcreate”这样的东西。但我已经看到了：

```
open("/dev/kvm", O_RDWR|O_LARGEFILE)    = 3
ioctl(3, KVM_GET_API_VERSION, 0)        = 12
ioctl(3, KVM_CHECK_EXTENSION, 0x19)     = 0
ioctl(3, KVM_CREATE_VM, 0)              = 4
ioctl(3, KVM_CHECK_EXTENSION, 0x4)      = 1
ioctl(3, KVM_CHECK_EXTENSION, 0x4)      = 1
ioctl(4, KVM_SET_TSS_ADDR, 0xfffbd000)  = 0
ioctl(3, KVM_CHECK_EXTENSION, 0x25)     = 0
ioctl(3, KVM_CHECK_EXTENSION, 0xb)      = 1
ioctl(4, KVM_CREATE_PIT, 0xb)           = 0
ioctl(3, KVM_CHECK_EXTENSION, 0xf)      = 2
ioctl(3, KVM_CHECK_EXTENSION, 0x3)      = 1
ioctl(3, KVM_CHECK_EXTENSION, 0)        = 1
ioctl(4, KVM_CREATE_IRQCHIP, 0)         = 0
ioctl(3, KVM_CHECK_EXTENSION, 0x1a)     = 0 
```

所以看起来它打开了设备 /dev/kvm 并做了一些 ioctl 系统调用。我相信这是实际创建 VM 线程的地方。对？我是操作系统的新手，如果有人能给我一些线索，我将不胜感激：>谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-09-03T15:05:29.123

VCPU 既不是操作系统线程也不是进程。要了解 VCPU 是如何工作的，首先我们应该弄清楚客户操作系统是如何在`Intel VT-x`架构上运行的。

`Intel VT-x`提出了一种具有两种模式的新模式方法：`VMX root mode`和`VMX non-root mode`，分别用于运行主机 VMM 和来宾。`Intel VT-x`还包含一个新结构：`VMCS`，它保存了主机和客人需要的所有信息。`VMCS`每位客人一份。

KVM 是一个硬件辅助的虚拟机管理程序，并利用`Intel VT-x`. 主机 Linux KVM 在`VMX root mode`. 当 KVM 决定切换 CPU 模式来运行客户机时，KVM 会将所有当前上下文转储到`VMCS`并执行“VMLAUNCH”指令。"VMLAUNCH" 将 CPU 从 转移`VMX root mode`到`VMX non-root mode`，并从 VMCS 加载来宾上下文，然后启动或继续执行来宾代码。

总之，来宾代码直接在`VMX non-root mode`. 不需要 VCPU 的软件仿真层。这就是为什么 KVM 具有更好的性能，并且没有针对 guest 的特定线程。

`/dev/kvm`由 创建`kvm.ko`，它只是 QEMU 的 KVM 接口。您的`strace`输出显示了 QEMU 如何与 KVM 交互并控制底层客户机。您永远无法在 KVM 中找到系统调用`fork`或系统调用。`clone`

有关更多 KVM 详细信息，尤其是 VCPU，您可以阅读 KVM 代码以`arch/x86/kvm/vmx.c`获取更多基于`Intel VT-x`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-01-28T17:04:54.817

尽管 VCPU 是不同于线程或进程的 OS 对象，并且 VCPU 对象是使用 KVM_CREATE_VCPU ioctl 创建的，但 QEMU 确实是为每个 VCPU 创建一个线程。当 QEMU 从该线程执行 KVM_RUN 时，来宾运行（物理 CPU 进入 VMX 非 root 模式）。KVM_CREATE_VCPU 返回一个新的文件描述符，这就是您将在 KVM_RUN ioctl 中看到的 fd。

您的 strace 中可能缺少 VCPU 线程，因为您没有使用该`-ff`选项。`-ff`要求 strace 还跟踪除初始线程之外的其他线程。

# java - Maven/Netbeans 有不同的测试配置文件和环境变量

> ID：10922477
> 
> 赞同：0
> 
> 时间：2012-06-06T21:19:11.893
> 
> 标签：java, testing, maven, netbeans, selenium

我们正在尝试为我们的 Java Web 应用程序进行 Selenium 测试。我们希望能够结合 java 函数“System.getProperty”和修改可用于测试的配置文件来快速配置我们的测试。

这样做的原因是我们可以通过简单更改 netbeans 中的下拉框（从 <默认配置> 到“服务器名称/详细信息”）来测试不同的服务器。我们的服务器运行诸如快照、RC 和修补程序分支之类的东西，因此这对于跟踪何时引入错误非常有帮助。

我们当前执行此操作的方法是在每次运行之前修改测试变量以针对我们想要的服务器（糟糕！）。

任何想法都会有所帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T21:35:03.863

# windows - Cygwin 的 rsync 是否支持 Unicode 文件名？

> ID：10922488
> 
> 赞同：0
> 
> 时间：2012-06-06T21:19:53.590
> 
> 标签：windows, unicode, rsync

似乎没有，但我可能会遗漏一些东西。Windows 7 上的 Cygwin RSYNC 的默认安装是否支持 Unicode 文件名？我正在尝试将文件从 Mac 同步到 Windows。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T21:29:10.007

Cygwin 本身很可能支持它们，但它运行的 Windows 控制台窗口不支持。您可以更改控制台以使用 UTF-8 代码页：

```
/cygdrive/c/Windows/System32/chcp.com 65001 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-09-04T15:54:23.543

上面的答案对我有帮助，但只有在我也为 Cygwin 设置了 UTF-8 编码之后：

```
/cygdrive/c/Windows/System32/chcp.com 65001
export LANG=ru_RU.UTF-8 
```

# java - Java：如何在 switch 案例中初始化 int 数组？

> ID：10922489
> 
> 赞同：5
> 
> 时间：2012-06-06T21:20:02.053
> 
> 标签：java, arrays, oop, initialization, int

如何像这样在 Java 中初始化整数数组：`int[] array = {1,2,3};`在 switch 语句中？

目前，我可以写：

```
switch(something) {
    case 0: int[] array = {1,2,3}; break;
    default: int[] array = {3,2,1};
} 
```

但是当我尝试访问该`array`变量时，eclipse 会抱怨它可能没有被初始化。

如果我尝试将它声明为`int[] array;`or`int[] array = new int[3];`然后使用 switch 语句，它会说我正在尝试重新声明它。

我该如何解决这个问题？最后的想法是能够根据一些逻辑（switch 语句）在一行代码中初始化一个包含 10 个值的数组。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-06T21:22:56.123

将声明放在 switch 语句之前。您还需要显式实例化正确类型的数组。

```
int[] array;
switch (something) {
    case 0: array = new int[] {1, 2, 3}; break;
    default: array = new int[] {3, 2, 1};
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T21:21:26.063

我会告诉你将数组声明放在 switch 块之外，但是，你不能`= { 1, 2, 3}`在声明之后使用语法。您需要以常规方式对其进行初始化，如`array = new int[] {1, 2, 3};`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-06T21:23:37.963

```
int[] array;
switch (something) {
    case 0: array = new int[]{1, 2, 3}; break;
    default: array = new int[]{3, 2, 1};
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-30T15:33:36.480

我以前也有同样的问题。希望这对您有所帮助。

第一马克拜尔斯是绝对正确的。Java 以最小的可能范围工作。所以如果你尝试做

`case 1: int arr = whatever and case 2 : int arr = ...`它会给你一个重新声明的错误，因为整个开关被视为一个单一的范围，并且没有基于大小写/基于范围的范围。

第2点：如果你说：

`case 1: int arr = whatever and case 2 : arr = ...`假设 int arr 将被编译并从案例 1 中获取，那么你仍然错了，java 会再次给你错误，基于以下原则`each and every local var has to be declared and initialized before its use.`

所以最好的方法是在你的开关之外声明它，并在你喜欢的任何情况下定义或初始化它。

# php - PHP/MYSQL 更新查询不起作用

> ID：10922490
> 
> 赞同：3
> 
> 时间：2012-06-06T21:20:08.897
> 
> 标签：php, mysql, sql, get, sql-update

谁能告诉我为什么这个更新查询不起作用？

```
if ($_GET['update']) {
include 'config.php';
//Connect to MYSQL Database server
$connect = mysql_connect(DB_HOST, DB_USER, DB_PASS) or die("Could not connect to MYSQL Database.");
$result = mysql_select_db(DB_NAME, $connect) or die("Could not connect to MYSQL table.");

mysql_query("UPDATE contact SET read = 1 WHERE id = '$_GET[update]'")or die("Query failed.");
echo "Update works!";
} else {
echo "Update does not work...ughh.";
} 
```

先感谢您。

编辑：我让查询工作。对于任何担心安全性的人，我使用这个脚本作为测试，看看我是否想使用它。现在脚本可以正常工作，我刚刚添加了安全性。谢谢大家的帮助和提示。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-06T21:25:12.690

试试这个为您的查询行：

```
mysql_query("UPDATE contact SET read = 1 WHERE id = '".$_GET[update]."'")or die("Query failed: " . mysql_error()); 
```

`die()`请注意语句的更改以更好地处理错误：

```
die("Query failed: " . mysql_error()); 
```

*此外，仅供参考，您应该真正转义用户变量（例如 GET 变量），以防止 SQL 注入：

```
mysql_query("UPDATE contact SET read = 1 WHERE id = '".mysql_real_escape_string($_GET[update])."'")or die("Query failed: " . mysql_error()); 
```

请报告结果。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-06T21:31:12.917

什么是列读？

```
mysql_query("UPDATE contact SET read = 1 WHERE id = '$_GET[update]'") 
```

从 read 的非大写来看，我怀疑您在 MySQL 中为该列使用了保留字。

看：

[MySQL 中的保留字](http://dev.mysql.com/doc/refman/5.1/en/reserved-words.html)

要解决这个问题，只需在 read 周围加上一个引号。IE

```
mysql_query("UPDATE contact SET 'read' = 1 WHERE id = '$_GET[update]'") 
```

或者每个 j.bruni 更好：

```
mysql_query("UPDATE contact SET `read` = 1 WHERE id = '$_GET[update]'") 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-06T21:23:55.060

我相信您需要转义字符串以使 $_GET['update'] 将其值添加到字符串中。但是您确实应该使用准备好的语句，以免受到恶意用户的攻击。

准备好的声明： http: [//php.net/manual/en/pdo.prepared-statements.php](http://php.net/manual/en/pdo.prepared-statements.php)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-06T21:26:48.950

`READ`是保留字。您需要将其放在反引号内或重命名您的字段。

看看这个链接：

[http://dev.mysql.com/doc/refman/5.5/en/reserved-words.html](http://dev.mysql.com/doc/refman/5.5/en/reserved-words.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-06T21:23:30.133

你可以这样测试

```
mysql_query("UPDATE contact SET read = 1 WHERE id = '".(int)$_GET['update']."'")or die("Query failed."); 
```

如果这不是特定的问题

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-06T21:28:20.057

```
mysql_query("UPDATE contact SET read = 1 WHERE id = '.$_GET[update].'")or die("Query failed.");
echo "Update works! 
```

请尽量不要使用 mysql_query。它很旧，而且效率不高。为什么不尝试了解 PDO 并准备语句..？

# asp.net-mvc-3 - asp.net MVC 用户好友 LazyLoad

> ID：10922492
> 
> 赞同：0
> 
> 时间：2012-06-06T21:20:13.723
> 
> 标签：asp.net-mvc-3, lazy-loading

如果我尝试先使用代码，用户类：

```
public class User
{
    [Key]
    public Guid ID { get; set; }

    [Required(ErrorMessage = "You must pick a user name")]
    [DisplayName("User Name")]
    public string Username { get; set; }

    [Required]
    public string FullName { get; set; }

    [Required(ErrorMessage = "You give a valid email address")]
    [DataType(DataType.EmailAddress)]
    public string Email { get; set; }
    [Required]
    [DataType(DataType.Password)]
    public string Password { get; set; }        
    [Required]
    public DateTime CreateAt { get; set; }

    public string Image { get; set; }

    public bool RemeberMe { get; set; }

    public bool Dummy { get; set; }

    public virtual ICollection<UserFriend> Friends { get; set; }
 } 
```

UserFriend 类： - 持有用户之间的关系

```
public class UserFriend
{
    [Key, Column(Order = 0), ForeignKey("User")]
    public Guid UserId { get; set; }
    public User User { get; set; }

    [Key, Column(Order = 1), ForeignKey("Friend")]
    public Guid FriendId { get; set; }
    public User Friend { get; set; }

    public DateTime DateCreated { get; set; }

} 
```

用户存储库：

```
public class UserRepository : IUserRepository
{
    public User GetUserByName(string userName)
    {
        return context.Users.FirstOrDefault(u => u.Username == userName);
    }
} 
```

如果我尝试使用这种方法：

```
var userRepo = new UserRepository(new DataContext());
User user = userRepo.GetUserByName(User.Identity.Name); 
```

问题：如果我做对了，user.Friends.first().Friend 返回 null 我的延迟加载不起作用。

请帮忙...

项目链接 - [https://github.com/RanDahan/barker](https://github.com/RanDahan/barker)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T08:23:53.763

在*User*类的构造函数中，您应该创建*Friends*集合的新实例

```
Friends = new HashSet<UserFriend>() 
```

另外，我认为*UserFirends*中的导航属性也应该被声明为虚拟的。

# java - 如何隐藏标签并使它们重新出现在 < 3 的 Android 版本中？

> ID：10922495
> 
> 赞同：0
> 
> 时间：2012-06-06T21:20:45.850
> 
> 标签：java, android, android-view

我想隐藏屏幕点击上的标签并让它们重新出现在另一个屏幕点击上。我已经在很多应用程序中看到了这一点，所以这应该是可能的。我可以使用`setvisibility = VIEW.GONE`. 我试过这个：

```
private OnClickListener tabClickListener = new OnClickListener() {
    public void onClick(View v) {
        if(v.getVisibility() == View.VISIBLE) {
            v.setVisibility( View.GONE );
        }
        else if(v.getVisibility() == View.GONE){
            v.setVisibility( View.VISIBLE );
        }
    }
}; 
```

这是xml代码：

`enter code here`

```
<LinearLayout
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:padding="5dp">

    <FrameLayout
        android:id="@android:id/tabcontent"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:padding="5dp"
        android:layout_weight="1">
        <TextView 
            android:id="@+id/textview1"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent" 
            android:text="this is a tab" />
        <TextView 
            android:id="@+id/textview2"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent" 
            android:text="this is another tab" />
        <TextView 
            android:id="@+id/textview3"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent" 
            android:text="this is a third tab" />
        <TextView 
            android:id="@+id/textview4"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent" 
            android:text="this is a fourth tab" />
    </FrameLayout>
    <TabWidget
        android:id="@android:id/tabs"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_weight="0"
        android:layout_marginBottom="-5dp"/>

    </LinearLayout>

</TabHost> 
```

这是java代码：

```
public class TabWorkEntryActivity extends TabActivity {

//hide tabs
private OnClickListener tabClickListener = new OnClickListener() {
    public void onClick(View v) {
        if (v.getVisibility() == View.VISIBLE) {
            v.setVisibility( View.INVISIBLE );
        } else {
            v.setVisibility( View.VISIBLE );
        }
    }
};

@Override
public void onCreate(Bundle savedInstanceState) {
  super.onCreate(savedInstanceState);

  setContentView(R.layout.tabworkentry);

TabHost  mTabHost = getTabHost();
//get width of the display
  Display display = getWindowManager().getDefaultDisplay();
  int width = display.getWidth();

   mTabHost.addTab(mTabHost.newTabSpec("top10").setIndicator("Top        10").setContent(R.id.textview1));
                 mTabHost.addTab(mTabHost.newTabSpec("billable").setIndicator("Billable").setContent(R.id.textview2));
   mTabHost.addTab(mTabHost.newTabSpec("product").setIndicator("Product").setContent(R.id.textview3));
  mTabHost.addTab(mTabHost.newTabSpec("regular").setIndicator("Regular").setContent(R.id.textview4));

  mTabHost.setCurrentTab(3);

  mTabHost.getTabWidget().getChildAt(0).setLayoutParams(new
          LinearLayout.LayoutParams(((width/9)*2),50));
  mTabHost.getTabWidget().getChildAt(1).setLayoutParams(new
          LinearLayout.LayoutParams(((width/9)*2),50));
  mTabHost.getTabWidget().getChildAt(2).setLayoutParams(new
          LinearLayout.LayoutParams(((width/9)*2),50));
  mTabHost.getTabWidget().getChildAt(3).setLayoutParams(new
          LinearLayout.LayoutParams(((width/9)*2),50)); 
```

// 代码中的其他位置... mTab​​Host.setOnClickListener( tabClickListener ); } }

由于某种原因，此代码不起作用。有人可以帮忙吗。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T19:56:34.170

如果您打算使用 Actionbar Sherlock（来自您发布的上一个问题），那么您不想使用 TabHost、TabManager。你会想要像 3.0+ 使用 Fragments 那样做 Tabs。

[https://github.com/JakeWharton/ActionBarSherlock/blob/master/samples/fragments/src/com/actionbarsherlock/sample/fragments/FragmentTabsPager.java](https://github.com/JakeWharton/ActionBarSherlock/blob/master/samples/fragments/src/com/actionbarsherlock/sample/fragments/FragmentTabsPager.java)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T02:46:11.447

您需要`OnClickListener`在活动的`onCreate`方法中设置。

```
v.setOnClickListener(tabClickListener); 
```

您也可以尝试使用`View.INVISIBLE`而不是`View.GONE`隐藏视图。

* * *

## 编辑：

这是我将使用的代码：

```
private OnClickListener tabClickListener = new OnClickListener() {
    public void onClick(View v) {
        if (v.getVisibility() == View.VISIBLE) {
            v.setVisibility( View.INVISIBLE );
        } else {
            v.setVisibility( View.VISIBLE );
        }
    }
}; 
```

# objective-c - NSTextField 设置光标

> ID：10922496
> 
> 赞同：1
> 
> 时间：2012-06-06T21:20:48.550
> 
> 标签：objective-c, nstextfield, first-responder

好的，所以我觉得在这个问题中我明显遗漏了一些东西。我在整个代码中使用 makeFirstResponder 从 textField 1 移动到 2、2 到 3 等。这似乎可以按我的意愿工作，但是当加载新视图时，我希望光标位于 textField1 中，并且但是以下代码在加载时并未将光标置于 textField1 中。

```
- (void) awakeFromNib{
    [[[self view] window] makeFirstResponder:textField1];
} 
```

我还尝试了 setInitialFirstResponder，但这也没有任何效果（我什至认为这不对。）那么，是因为它在 awakeFromNib 方法中吗？谁能告诉我我错过了什么？提前致谢。

编辑 - 我的解决方案与接受的答案略有不同，所以我想我会发布我的实现。因为我想为其设置第一响应者的视图是稍后添加的子视图（想想应用程序向导的第二个屏幕），我只是添加了一个 setCursorToFirstTextField 方法：

```
- (void) setCursorToFirstTextField {
[[[self view] window] makeFirstResponder:textField1];
} 
```

并确保在我将子视图添加到原始窗口的自定义视图后调用它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T03:40:08.447

是的，你说得对，问题是 awakeFromNib 中方法的位置。如果您在 awakeFromNib 中记录 [self.view window]，您会看到它为 NULL。我不知道您到底是如何设置的，但我猜（如果这与您的 WizardController 问题有关）您正在另一个类中执行 alloc initWithNibName:bundle: 来创建您的视图控制器，然后添加它控制器的视图到视图层次结构。如果你在那里扔一些日志，它会告诉你控制器类中的 awakeFromNib 在 alloc init 之后被调用，但在视图被添加为子视图之前，所以当时没有窗口。我解决这个问题的方法是在视图控制器类中创建一个设置方法（其中包含 makeFirstResponder 代码），

```
- (void)applicationDidFinishLaunching:(NSNotification *)aNotification {
    self.wizard = [[WizardController alloc] initWithNibName:@"WizardController" bundle:nil];
    [self.window.contentView addSubview:wizard.view];
    [self.wizard doSetup];
} 
```

# nginx - nginx：如何在 nginx.conf 文件中为图像设置过期标头

> ID：10922501
> 
> 赞同：0
> 
> 时间：2012-06-06T21:21:20.663
> 
> 标签：nginx

我的图片位于**domain.com/assets/img**和**domain.com/images/**

我将此添加到我的 nginx.conf 文件中，它禁用了我的图像。

```
location ~* \.(png|jpg|jpeg|gif|ico)$ {
expires 1y;
log_not_found off;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T10:51:46.880

安德鲁，我已将您的配置添加到我的一个配置文件中并且它有效。现在，在我的响应标题上，我有

> 日期：星期日**，2013 年 2 月 3 日**10:47:33 GMT
> **到期：星期一，2014 年 2 月 3 日**10:47:33 GMT
> 最后修改时间：星期二，2013 年 1 月 29 日 06:40:59 GMT
> 服务器：nginx/0.8.53

看起来您的解决方案有效。

# visual-studio-2010 - VS安装项目在安装文件被删除时破坏自我

> ID：10922502
> 
> 赞同：0
> 
> 时间：2012-06-06T21:21:21.627
> 
> 标签：visual-studio-2010, c#-4.0, installation, vdproj

这应该很简单，但我似乎无法理解。我有一个安装项目（VS2010），它打包了几十个图像文件（连同我的 SQLite 文件），并在安装程序时将它们复制到用户的计算机上。由于这些本质上是“库存”图像，因此用户可以删除它们（程序中有这样做的功能。）但是，在删除这些图像中的一个或多个之后，程序下次启动时会给出一个“Windows 安装程序”对话框，并删除所有剩余的数据文件！

我认为正在发生的是程序看到丢失的文件，假设安装已损坏，并尝试进入某种恢复/卸载模式。我想知道如何在安装项目中指出需要安装文件，但用户可以随时将其删除。

我尝试了几种 File 属性的组合，但似乎没有什么能完全满足我的要求，我的安装程序将它们放在我说的地方，不再考虑它们。我是否必须重新发明轮子并通过自定义操作来做到这一点？

编辑： Transitive 和 Vital 都设置为 True。将它们设置为 False 会导致程序在重新启动后重新添加已删除的图像！如果我没有得到答案，我可能会使用自定义操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T07:09:46.533

当使用文件关联或公布的快捷方式时，Windows Installer 会自动检查是否缺少[组件键路径。](http://msdn.microsoft.com/en-us/library/windows/desktop/aa368007%28v=vs.85%29.aspx)如果未找到密钥路径，则触发修复以重新安装组件。

您的安装程序修复过程很可能会删除其他文件。

一个解决方案是不向 Windows Installer 注册您的组件。这是通过使用空组件 GUID 完成的，Visual Studio 安装项目不支持它（但大多数其他安装工具都支持它）。

另一种解决方案是确保您的图像文件不是其组件中的关键路径。Visual Studio 也不支持这一点。

如果您想使用提供更多控制的设置创作工具，您可以查看此列表：[http ://en.wikipedia.org/wiki/List_of_installation_software](http://en.wikipedia.org/wiki/List_of_installation_software)

# centos - 试图在 Centos 上安装 LAMP？

> ID：10922503
> 
> 赞同：1
> 
> 时间：2012-06-06T21:21:22.467
> 
> 标签：centos, lamp, centos6

嘿伙计们，我正在运行 Centos 6.2 minimum，我正在尝试为我的服务器安装 LAMP 并遵循[本教程](http://www.scribd.com/doc/67745526/Step-By-Step-Install-Guide-CentOS-6-Server-Administration-and-Maintenance)。

它安装完美，但是当我尝试将服务配置为自动启动时，它很酷

```
/sbin/chkconfig httpd on 
```

但是当我尝试

```
/sbin/chkconfig --add mysqld 
```

它说：

> 读取服务 mysqld 上的信息时出错：没有这样的文件或目录

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-18T22:52:22.457

系统在 /etc/init.d 中找不到 mysqld

尝试：找到 mysqld

通常它将是 /u/sbin 或 /u/bin 文件夹（取决于操作系统和默认设置）。

将 mysqld（如果找到）复制到 /etc/init.d 文件夹，检查文件权限。

然后再次尝试 chkconfig --add mysqld 。

如果您仍然无法运行，请发布上面命令的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T21:29:27.960

mysqld 安装了吗？尝试 yum install mysql-server 或类似的。它也可能不命名为 mysqld，但 mysql 请参阅 /etc/init.d/ 目录以获取脚本。

# ios - IOS5 __block 变量在范围外抛出 EXC_BAD_ACCESS

> ID：10922505
> 
> 赞同：2
> 
> 时间：2012-06-06T21:21:34.620
> 
> 标签：ios, ios5, mapkit

我很困惑为什么在通过一个块后我不能再次访问我的全局变量。这是我的代码：

```
__block NSString *latitude;
__block NSString *longitude;

CLGeocoder *geoCoder = [[CLGeocoder alloc] init];
[geoCoder geocodeAddressString:location completionHandler:^(NSArray* placemarks, NSError* error) 
{
    for (CLPlacemark* aPlacemark in placemarks)
    {
        CLLocation *latLong = aPlacemark.location;
        latitude = [NSString stringWithFormat:@"%f", latLong.coordinate.latitude];
        longitude = [NSString stringWithFormat:@"%f", latLong.coordinate.longitude];
        //works fine
        NSLog(@"CLLOCATION SSSSSSSSSSSSSSSSSSSSSS LAT: %@, LONG: %@", latitude, longitude);           
    }
}];

//no bueno
NSLog(@"CLLOCATION SSSSSSSSSSSSSSSSSSSSSS LAT: %@, LONG: %@", latitude, longitude); 
```

现在我尝试`NSString`以不同的方式初始化我的 s ：

```
__block NSString *latitude = @"";
__block NSString *longitude = @""; 
```

和：

```
__block NSMutableString *latitude = [NSMutableString string];
__block NSMutableString *longitude = [NSMutableString string]; 
```

但是当我访问块外的变量时，我只会得到空字符串。

这尤其令人困惑，因为在 Apple 的文档中[http://developer.apple.com/library/ios/#documentation/cocoa/Conceptual/Blocks/Articles/bxGettingStarted.html#//apple_ref/doc/uid/TP40007502-CH7-SW1](http://developer.apple.com/library/ios/#documentation/cocoa/Conceptual/Blocks/Articles/bxGettingStarted.html#//apple_ref/doc/uid/TP40007502-CH7-SW1)

，他们能够在块之外设置变量，使用它们并很好地检索它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T19:06:50.087

Okie doke，听起来像几个问题（一个，没有或全部可能适用，在您提供的上下文中很难说）：

1 - *“但是当我访问块外的变量时，我只会得到空字符串。”*

取决于您何时在块外访问它们。这是因为无法保证在查询时已填充纬度和经度。提供的块是 CLGeocoder 的完成处理程序；当地理编码器找到感兴趣的位置时，它将被调用。能够检索位置数据并基于该位置进行搜索需要时间，并且在找到任何“地标”之前直接调用 NSLog 语句的可能性很高。

2 - *“IOS5 __block 变量在范围外抛出 EXC_BAD_ACCESS”*

您在块中分配以下内容：

```
latitude = [NSString stringWithFormat:@"%f", latLong.coordinate.latitude];
longitude = [NSString stringWithFormat:@"%f", latLong.coordinate.longitude]; 
```

`stringWithFormat`是一种返回自动释放值的方法，但您不会将它们保留在任何地方。如果您没有使用 ARC（请参阅[https://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/MemoryMgmt/Articles/MemoryMgmt.html](https://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/MemoryMgmt/Articles/MemoryMgmt.html)以了解 ARC 的内存管理术语，以及[http://developer .apple.com/library/mac/#releasenotes/ObjectiveC/RN-TransitioningToARC/Introduction/Introduction.html](http://developer.apple.com/library/mac/#releasenotes/ObjectiveC/RN-TransitioningToARC/Introduction/Introduction.html)通常），那么这将导致在访问其他地方的值时出现问题，因为您正在访问不再存在的对象。如果您使用的是 ARC，那么这应该不是问题，因为默认情况下变量会很强大，并为您保留值。

# android - android进度对话框中setProgress时的空指针异常

> ID：10922509
> 
> 赞同：0
> 
> 时间：2012-06-06T21:22:09.587
> 
> 标签：android, progressdialog

为什么我得到这个空指针异常。这是我的代码，在我第一次从 doInBackground 方法执行 publishProgress 后，我在 OnProgressUpdate 方法处遇到异常

```
private class ScanVideoTask extends AsyncTask<String, Integer, String> {
        private AsyncTaskCompleteListener<String> callback;
        private Context context;
        private String resultOutput;
        private ProgressDialog mProgressDialog;

        public ScanVideoTask(AsyncTaskCompleteListener<String> cb) {
            this.callback = cb;
        }

        protected String doInBackground(String... args) {
            // Get the URI of the video path & display it for a short period.
            String filename = args[0];

            int i= 0;
            while(i < 1000000)
            {
                i++;
                int progressPercentage = (int)(((float)i/(float)1000000) * (float)100);
                publishProgress(progressPercentage);
            }
            return "ok";

         }

         protected void onProgressUpdate(Integer... progress) {
             mProgressDialog.setProgress(progress[0]);
         }

         protected void onPreExecute() {
             super.onPreExecute();
             showDialog(DIALOG_DOWNLOAD_PROGRESS);
            }

         protected void onPostExecute(String result) {
            System.out.println("on Post execute called" + result);
            dismissDialog(DIALOG_DOWNLOAD_PROGRESS);
            callback.onTaskComplete(result);
         }
     } 
```

这是我的 onCreateDialog 中的内容

```
 @Override
        protected Dialog onCreateDialog(int id) {
            switch (id) {
            case DIALOG_DOWNLOAD_PROGRESS:
                mProgressDialog = new ProgressDialog(this);
                mProgressDialog.setMessage("Scanning video..");
                mProgressDialog.setProgressStyle(ProgressDialog.STYLE_HORIZONTAL);
                mProgressDialog.setCancelable(true);
                mProgressDialog.show();
                return mProgressDialog;
            default:
                return null;
            }
        } 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-26T07:08:09.000

如下所述修改您的 onPreExcecute 方法：

```
protected void onPreExecute() 
{
super.onPreExecute();
mProgressDialog = new ProgressDialog(this);
showDialog(DIALOG_DOWNLOAD_PROGRESS);
}
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T21:33:07.967

`mProgressDialog`你的似乎`ScanVideoTask`从未初始化过。你在哪里启动你的`ScanVideoTask`？

# android - 在 Activity 的每次迭代中添加新的 LinearLayout

> ID：10922511
> 
> 赞同：0
> 
> 时间：2012-06-06T21:22:13.730
> 
> 标签：android, android-intent, android-linearlayout

在我的一项活动中，当从 Intent 接收到包时，我创建了一个线性布局和一些其他小部件。目前，每次我回到那个 Activity 时，那个 Layout 都会被覆盖。如何在不重写代码的情况下每次都创建一个新的布局？

代码：

```
public class FrontPageActivity extends Activity {

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.frontpage);

        Bundle bundle = this.getIntent().getExtras();
        try{

            String size = bundle.getString("size");
            int toppcount = bundle.getStringArrayList("toppings").toArray().length;

            LinearLayout container = (LinearLayout)findViewById(R.id.container);
            TextView t = new TextView(this);

            TextView tprice = new TextView(this);
            tprice.setGravity(Gravity.RIGHT);

            LinearLayout inner = new LinearLayout(this);
            LinearLayout.LayoutParams innerparams = new LinearLayout.LayoutParams(LinearLayout.LayoutParams.FILL_PARENT,
                    LinearLayout.LayoutParams.WRAP_CONTENT);
            inner.setLayoutParams(innerparams);
            inner.setBackgroundDrawable(getResources().getDrawable(R.drawable.background));
            inner.setPadding(10,10,10,10);

            if(toppcount == 0){
                t.setText(size+" Cheese Pizza");
            }
            else{
                t.setText(size+" "+toppcount+" Topping Pizza");
            }

            tprice.setText(getPrice(size, toppcount)+"");

            tprice.setLayoutParams(new LinearLayout.LayoutParams(LinearLayout.LayoutParams.FILL_PARENT,
                    LinearLayout.LayoutParams.FILL_PARENT));

            container.addView(inner);
            inner.addView(t);
            inner.addView(tprice);
        }
        catch(NullPointerException e){

        }
        final Intent sender = new Intent(this.getApplicationContext(), OrderPizzaActivity.class);

        Button badd = (Button)findViewById(R.id.buttonaddpizza);

        badd.setOnClickListener(new View.OnClickListener() {

            public void onClick(View arg0) {

                startActivityForResult(sender, 0);

            }
        });

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T21:38:40.043

听起来您需要创建一个数据结构来保存 LinearLayout，或者为每次添加它们提供一个 ViewGroup 容器。

当前，您正在创建、修改和覆盖块`LinearLayout`中的相同内容`try{} catch(){}`。我猜这就是它不断覆盖的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T21:55:25.290

据我了解，您在“最终订单”中添加了新的“选项”。每次添加额外的浇头时，您都会创建一个布局并用特定数据填充它。你希望它是又名 OrderList。如果这个应用程序是关于什么的，你可以有一个应用程序级别的变量 myOrder:List。在 FrontPageActivity 中添加浇头 (topping = new Order()) 并阅读列表。建议您为订单设置单独的布局。循环遍历订单，用数据填充布局并在 Activity 容器中膨胀。

伪思想：

```
MyApplication extends Application {
    private static List<Order> mOrderList = null;

    public MyApplication(){
        mOrderList = new ArrayList<Order>();
    }

    public static List<Order> getOrderList(){
        return mOrderList();
    }

    public static void addOrder(Order order) {
        mOrderList.add(order);
    }
} 
```

选项活动：

```
MyApplication.add(order);
MyApplication.add(order); 
```

FrontPageActivity

```
foreach(Order order : MyApplication.getOrderList()) {
   // fill layout with order data
   // inflate orderLayout into container
} 
```

# security - Symfony2 登录和安全

> ID：10922516
> 
> 赞同：5
> 
> 时间：2012-06-06T21:22:42.870
> 
> 标签：security, login, symfony

有没有一种方法可以存储用户上次登录的时间？

我正在使用 symfony2，安全配置一切正常。

我已经看到这个[Security and login on a Symfony 2 based project](https://stackoverflow.com/questions/8144446/security-and-login-on-a-symfony-2-based-project)，这是一个类似的问题，但它不符合我的需要。

还有其他解决方案吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-06T22:17:15.583

您可以创建一个`AuthenticationHandler`Symfony 将在用户成功登录时调用，您可以将登录时间保存到`User`实体属性中（假设您有这种情况）。

首先，创建成功认证处理程序：

```
namespace Acme\TestBundle\Handler;

use Symfony\Component\Security\Http\Authentication\AuthenticationSuccessHandlerInterface;
use Symfony\Component\Security\Core\Authentication\Token\TokenInterface;
use Symfony\Component\HttpFoundation\Request;
use Symfony\Component\HttpFoundation\RedirectResponse;
use Symfony\Component\DependencyInjection\ContainerAware;

class AuthenticationHandler extends ContainerAware implements AuthenticationSuccessHandlerInterface
{
    function onAuthenticationSuccess(Request $request, TokenInterface $token)
    {
        $token->getUser()->setLoginTime(new \DateTime());
        $this->container->get('doctrine')->getEntityManager()->flush();

        return new RedirectResponse($this->container->get('router')->generate('login_success'));
    }
} 
```

然后你需要将身份验证处理程序注册为配置文件中的服务，例如，`src/Acme/TestBundle/resources/Config/services.yml`

```
services:
    authentication_handler:
        class: Acme\TestBundle\Handler\AuthenticationHandler
        calls:
            - [ setContainer, [ @service_container ] ] 
```

并配置登录表单以使用创建的处理程序，查看您的`security.yml`

```
form_login:
    success_handler: authentication_handler 
```

显然，要使其工作，您需要有一个`User`具有属性的实体`loginTime`和相应的设置器。并且您需要配置登录以使用`User`实体存储库作为用户提供程序和`DaoAuthenticationProvider`，如下所述：http: [//symfony.com/doc/current/book/security.html#loading-users-from-the-database](http://symfony.com/doc/current/book/security.html#loading-users-from-the-database)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-07T10:11:51.643

一个非常简单的解决方案是在您的应用程序中实现[FOSUserBundle](https://github.com/FriendsOfSymfony/FOSUserBundle)，因为数据库中的每个用户条目（除其他外）都有一个“last_login”字段。

# php - Symfony 2 和 gits：我如何安装供应商库？我有错误

> ID：10922518
> 
> 赞同：1
> 
> 时间：2012-06-06T21:22:52.213
> 
> 标签：php, symfony, git-svn

我正在尝试在 webfactionnal 上建立一个 Symfony 开发平台。我正在使用 Git，所以当我下载 S2 时，我使用了“无供应商”版本并按照这些[说明进行操作。](http://symfony.com/doc/current/cookbook/workflow/new_project_git.html#cookbook-managing-vendor-libraries)

所以一切都很顺利，直到第 8 步：`$ php bin/vendors install`

尝试在我的服务器上执行此行时收到几条错误消息：

> 警告：第 74 行 /home/quantum/webapps/quantumnetworks/bin/vendors 中 parse_ini_file() 的参数计数错误
> 
> 警告：在第 79 行的 /home/quantum/webapps/quantumnetworks/bin/vendors 中为 foreach() 提供的参数无效 sh: ./vendor/bundles/Sensio/Bundle/DistributionBundle/Resources/bin/build_bootstrap.php：没有这样的文件或目录
> 
> 解析错误：语法错误，意外的 T_STRING，在第 13 行的 /home/quantum/webapps/quantumnetworks/app/console 中需要 T_CONSTANT_ENCAPSED_STRING 或 '('
> 
> 解析错误：语法错误，意外的 T_STRING，期待

所有文件均为原件。

顺便说一句，在 /config.php 我有那个错误：无法读取日志文件，我把它放在我的服务器上的 777 上，并意识到它被命名为日志而不是日志......为什么？

谢谢 ！

> 第 13 行 /home/quantum/webapps/quantumnetworks/app/console 中的 T_CONSTANT_ENCAPSED_STRING 或 '('

编辑：我运行 php54 命令以使用 php 5.4，因为我的托管公司建议我。但是我仍然有一些错误，它下载了所有东西，然后我有

> 安装/更新 AsseticBundle

然后出现错误：

> 接收对象：100% (1918/1918), 251.85 KiB | 447 KiB/s，完成。解决增量：100% (1164/1164)，完成。61c9f363e73b4ecbb72f81eb62675260a1132048 HEAD 现在位于 41b5913 来自 stof/disable_profiler 的合并拉取请求 #27
> 
> 解析错误：语法错误，意外的 T_STRING，在第 35 行的 /home/quantum/webapps/quantumnetworks/vendor/bundles/Sensio/Bundle/DistributionBundle/Resources/bin/build_bootstrap.php 中需要 T_CONSTANT_ENCAPSED_STRING 或 '('
> 
> 解析错误：语法错误，意外的 T_STRING，在第 13 行的 /home/quantum/webapps/quantumnetworks/app/console 中需要 T_CONSTANT_ENCAPSED_STRING 或 '('
> 
> 解析错误：语法错误，意外的 T_STRING，在第 13 行的 /home/quantum/webapps/quantumnetworks/app/console 中需要 T_CONSTANT_ENCAPSED_STRING 或 '('

所以是的，正在取得进展，几乎完成了:)

编辑2：

我打电话给我的托管公司，他们说，当你在php中执行一个脚本时，即使你输入php54，脚本本身，如果它启动另一个脚本，5.4版本也不会调用它。要解决此问题，请执行以下 4 个步骤：

```
cd ~/webapps<your application>
ln -s /usr/local/bin/php54 ./php
export PATH=./:$PATH
php54 bin/vendors install 
```

需要做所有这些

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T21:42:46.623

您没有使用运行 Symfony2 所需的 php 5.3。

您可以通过以下方式在控制台上查看

```
php -v 
```

您当前使用的版本。

这`T_CONSTANT_ENCAPSED_STRING or '(' in [...]`通常是一个提示，因为 5.3 之前的 php 不支持命名空间，这会导致旧版本中的语法错误。

# asp.net - Google Maps API V3 地图容器元素在 IE9 中重复

> ID：10922526
> 
> 赞同：0
> 
> 时间：2012-06-06T21:23:31.167
> 
> 标签：asp.net, google-maps-api-3, internet-explorer-9

这可能是某处问题的重复，但我无法想出关键字来生成它。

我正在使用 Google Maps API V3 并遵循[https://developers.google.com/maps/documentation/javascript/tutorial](https://developers.google.com/maps/documentation/javascript/tutorial)提供的简单教程。一切都很好，除了 IE9，它在 IE9 标准模式下呈现。问题是，当地图加载到一个非常简单的 ASP.NET 表单页面上时，生成的 HTML 有*两次*`div`地图的容器！这会导致布局问题，因为如教程中所述：

 *> 请注意，地图将始终从其包含元素的大小中获取大小，因此您必须始终明确设置大小。

因此，`div`包含我的地图必须设置为一定数量的像素或 100%，与其 DOM 父级的值相同。这在 FireFox 和 Chrome 中很好，HTML 源代码大致如下：

```
<!DOCTYPE html>
<html>
<head>
 ...
</head>
<body class="no-layout"><form name="aspnetForm" method="post" action="TestPopup.aspx" id="aspnetForm">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDw... />
</div>
<div class="map" />
</form></body>
</html> 
```

但在 IE9 中，我们最终得到：

```
<!DOCTYPE html>
<html>
<head>
 ...
</head>
<body class="no-layout"><form name="aspnetForm" method="post" action="TestPopup.aspx" id="aspnetForm">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDw..." />
</div>
<div class="map" />
</form>
<div class="map" />
</body>
</html> 
```

此页面是问题的（工作）简化，但这是页面中的实际问题，因为地图类设置了宽度和高度。`div`该类的第二个具有相同的样式，将内容下推。*

# linux - 使用示例代码测试 Linsched

> ID：10922533
> 
> 赞同：1
> 
> 时间：2012-06-06T21:23:48.800
> 
> 标签：linux, linux-kernel, scheduler

我最近遇到了 Linsched，可以在用户空间中模拟一些内核调度程序（我相信是 CFS）功能。现在随着调度程序的进展，宣布了一个到 3.3.4 的端口 [1]，他们声称在大约 20 行中包含所有模拟代码。因此，在克隆存储库并按照 [1] 中的说明进行操作后，我尝试：

```
~/linsched/tools$ ls
firewire  hv  lguest  nfsd  perf  power  slub  testing  usb  virtio 
```

这是预期的，因为我克隆的存储库包含所有内核代码，但应该存在于 tools/ 中的 linsched 文件夹不存在。有没有其他人幸运地使用 3.3.4 运行 linsched？如果是这样，我在哪里可以找到有关它的更多信息？谢谢！

[1] [http://lists.linaro.org/pipermail/linaro-sched-sig/2012-March/000013.html](http://lists.linaro.org/pipermail/linaro-sched-sig/2012-March/000013.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T22:45:12.173

所以我在给几个人发电子邮件后终于弄清楚了代码是什么，我在这里为其他人发布了答案，在检查了代码之后，你必须切换到 linsched-alpha 分支。

# drupal - 如何创建在 Drupal 7 网站之间传输节点的提要？

> ID：10922540
> 
> 赞同：3
> 
> 时间：2012-06-06T21:24:23.217
> 
> 标签：drupal, rss, drupal-7, export, feed

我有一个 Drupal 7 网站，其中包含“事件”和“新闻”等内容类型。

我希望将这些内容类型的节点自动导入其他网站。

我在“客户端”网站上使用 Feed、XPath 并在“服务器”端使用 Views RSS 字段，但我意识到内容类型字段（如文件）会有问题......有什么建议吗？我希望能够在其他网站上为此内容创建新视图。

PS 网站之间的内容类型将相同（但如果您的解决方案包含其他内容，则不必如此）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T03:56:29.530

也许您可以通过创建将由客户端使用的 xmls/json（服务器端）来共享数据。

服务是个好方法。但我发现简单的东西很复杂。

您可以做的是创建将输出为 xml/json 的视图...您可以通过在模块/模板文件中执行预处理功能来做到这一点。

之后，客户端（可能运行 cron）将采用 xml/json 并以编程方式创建节点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T13:40:43.260

您可能在[服务](https://drupal.org/project/services)和[内容分发](https://drupal.org/project/content_distribution)方面取得了更大的成功。RSS 提要不太适合语义数据的传输。他们高度关注文章列表，通常缺乏诸如“事件开始日期”之类的信息。

服务允许您在 server-drupal-site 上公开服务，将节点公开为例如 RESTfull json。然后客户端drupalsite 可以使用服务和内容分发从所述服务器导入节点。

也就是说，服务套装插入视图，并且非常沉重、庞大和复杂。如果你对大型和复杂的项目（比如我）过敏，你可能会更好地编写简单的模块：

*   events-service：一个 20 多行的模块，它从数据库中获取事件，并将它们呈现为 json。
*   新闻服务：一个 10 多行的模块，用于获取新闻节点列表并将它们呈现为 json。
*   events-client：一个小模块（~400-800 行？），它在给定的 url 处吃掉所说的 json 并将它们变成节点。它将在节点表旁边保留一些 UUID 的寄存器，以避免在上游更改时重新创建节点（而是找到关联的节点并更新它）。
*   news-client：一个小模块。和上面一样。

编写这样的模块是非常有益的，因为您不必与文档记录不佳的视图插件、围绕服务的复杂层等作斗争，您可以完全控制和完全理解。它还允许更好的调优和性能。

一个很大的缺点是 Drupal，更具体地说：CCK 或 Fields，决定了数据库及其结构。当您站点上的一些微小配置更改破坏您的模块 SQL 查询时，将会有一个点：突然之间，由于 Drupal 决定重命名或移出某些表、列或引用，您会爆出 SQL 错误。

# php - 为什么我看到两个不同的 session_id() 值？

> ID：10922545
> 
> 赞同：2
> 
> 时间：2012-06-06T21:24:38.477
> 
> 标签：php, session, sessionid

我有一个与会话 id 值一起使用的小脚本。当我想将数据插入到我的数据库时，我会在表中`session_id()`看到类似的值。`567`但是，当我想使用`session_id()`函数回显相同的数据时，我看到一个由 32 个字符组成的散列值，例如`d6fc8fe0c82307cc97dd2a0e94c9bb56`.

这是什么原因？这是 PHP 的某种安全问题吗？我怎样才能获得相同的价值？

这是代码：

```
$mysessid = session_id();

$sql = "INSERT into `mytable` (session_id) values('$mysessid')";
// when i use this sql to add the value into the db, i see a value like "7" or "251" etc in the table.

echo $mysessid;
// it outputs a hashed value like "d6fc8fe0c82307cc97dd2a0e94c9bb56"

// two different outputs... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T15:03:39.433

听起来您的数据库结构没有格式化为十六进制字符串。您对字段 session_id 使用什么类型的字段？

# python - pyenchant 在 Mac OS X 上找不到字典文件

> ID：10922546
> 
> 赞同：5
> 
> 时间：2012-06-06T21:24:44.500
> 
> 标签：python, installation, pyenchant

我在运行 Lion 的 MacbookPro 上安装 pyenchant 时遇到问题。我使用 homebrew 和 pip 来安装 enchant 和 pyenchant

> 自制安装附魔
> 
> 点安装 pyenchant

我还下载了一本英语词典到以下文件夹：

> /usr/local/Cellar/python/2.7.3/lib/python2.7/site-packages/enchant/share/enchant/myspell

```
-rw-r--r--  1 mycomputer  admin      75 Jun  6 13:34 README.txt
-rw-rw-rw-@ 1 mycomputer  staff    1017 May  4  2007 README_en_US.txt
drwx------@ 2 mycomputer  staff      68 Jun  6 13:38 en_US
-rw-rw-rw-@ 1 mycomputer  staff    3045 May  4  2007 en_US.aff
-rw-rw-rw-@ 1 mycomputer  staff  696131 May  4  2007 en_US.dic 
```

但是，当我尝试使用附魔时，我收到以下错误。

```
>>> import enchant
>>> d = enchant.Dict('en_US')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/local/Cellar/python/2.7.3/lib/python2.7/site-packages/enchant/__init__.py", line 502, in __init__
    self._switch_this(broker._request_dict_data(tag),broker)
  File "/usr/local/Cellar/python/2.7.3/lib/python2.7/site-packages/enchant/__init__.py", line 264, in _request_dict_data
    self._raise_error(eStr % (tag,),DictNotFoundError)
  File "/usr/local/Cellar/python/2.7.3/lib/python2.7/site-packages/enchant/__init__.py", line 218, in _raise_error
    raise eclass(default)
enchant.errors.DictNotFoundError: Dictionary for language 'en_US' could not be found 
```

我猜我没有在正确的文件夹中安装字典文件，但我不知道在哪里安装它们。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-04T10:19:54.317

Enchant 很“懒惰”，需要 aspell 的后端支持。

所以，你需要做的是：

```
brew remove aspell
brew install aspell --lang=en 
```

然后将安装 en dicts，因此无需下载其他 dicts。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T04:27:17.967

我还能够通过显式设置字典路径的参数来解决。没有安装 brew - 我正在使用 mac 端口。必须从 apache open office 手动下载 oxt 文件并从中提取文件（重命名`.oxt`为`.zip`. 这些默认路径值存储在哪里？

```
Python 2.7.1 (r271:86832, Jul 31 2011, 19:30:53)   
[GCC 4.2.1 (Based on Apple Inc. build 5658) (LLVM build 2335.15.00)] on darwin  
Type "help", "copyright", "credits" or "license" for more information.  
>>>  
>>> import enchant  
>>> d = enchant.Dict("en_US")  
Traceback (most recent call last):  
  File "<stdin>", line 1, in <module>  
  File "/Library/Python/2.7/site-packages/pyenchant-1.6.5-py2.7.egg/enchant/__init__.py", line 502,   in __init__  
    self._switch_this(broker._request_dict_data(tag),broker)   
  File "/Library/Python/2.7/site-packages/pyenchant-1.6.5-py2.7.egg/enchant/__init__.py", line 264, 
  in _request_dict_data  
    self._raise_error(eStr % (tag,),DictNotFoundError)  
  File "/Library/Python/2.7/site-packages/pyenchant-1.6.5-py2.7.egg/enchant/__init__.py", line 218,   in _raise_error  
    raise eclass(default)  
enchant.errors.DictNotFoundError: Dictionary for language 'en_US' could not be found 
```

现在我使用我的文件系统细节应用修复：

```
>>> enchant.set_param("enchant.myspell.dictionary.path","/Library/Python/2.7/site-packages/pyenchant-1.6.5-py2.7.egg/enchant/share/enchant/myspell")  
>>> d=enchant.Dict("en_US")
>>> d.check("enchant")  
True  
>>> 
```

眼见为实 - 再次 - 该路径的默认版本存储在哪里（我是 Python 和 Eggs 的新手 - 来自 Java 和 Jars）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T15:06:05.397

我能够使用以下命令解决此问题：

> 附魔.set_param("附魔.myspell.dictionary.path", "/usr/local/Cellar/python/2.7.3/lib/python2.7/site-packages/附魔/share/附魔/myspell")

其他使用端口安装附魔的人没有这个问题。

# asp.net - 静态文件上的间歇性 401 和 302 错误

> ID：10922547
> 
> 赞同：4
> 
> 时间：2012-06-06T21:24:56.357
> 
> 标签：asp.net, web-config, forms-authentication, http-status-code-401, http-status-code-302

我正在为我们的一个客户开发一个网站，几周来一直有一个烦人的问题。该问题是间歇性的，可能一天发生两次或两周内发生一次。

发生这种情况时，客户端在尝试在页面上加载静态脚本或样式标签时将开始收到 401.3“未授权”错误。它总是被拒绝的 .css 或 .js 文件，并且设置`<modules runAllManagedModulesForAllRequests="false" />`并没有解决问题。当问题发生时，它会有效地阻止文件，直到重新启动应用程序池。

该站点正在使用带有库存“AspNetSqlMembershipProvider”的表单身份验证。该站点在 /Accounts 文件夹中具有受保护的文件，在 /Styles 中具有样式，在 /Scripts 中具有脚本。该站点启用了匿名访问，并且在 /Accounts 文件夹中有一个单独的 web.config，它拒绝匿名用户的访问（尽管这甚至与 runAllManagedModulesForAllRequests=false 无关）。

我查看了事件日志，发现：
2012-06-06 14:23:32 [ipaddress] GET /subfolder/Styles/Site.css ver=11 44​​3 - [ipaddress] Mozilla/5.0+(Windows+ NT+6.1;+WOW64;+rv:12.0)+Gecko/20100101+Firefox/12.0 [https://thesitename.net/subfolder/Account/Login.aspx](https://thesitename.net/subfolder/Account/Login.aspx) 401 3 5 1493 429 62

有时在短时间内它会自行修复，或者如果我重新启动应用程序池，我会得到这个：
2012-06-06 14:30:30 [ipaddress] GET /subfolder/Styles/Site.css ver=11 44​​3 - [ipaddress ] Mozilla/5.0+(Windows+NT+6.1;+WOW64;+rv:12.0)+Gecko/20100101+Firefox/12.0 [https://thesitename.net/subfolder/Account/Login.aspx](https://thesitename.net/subfolder/Account/Login.aspx) 200 0 0 2533 455 78

我终于让托管服务提供商启用了失败的请求跟踪，并最终得到了错误的跟踪： ![前锋](../Images/83a1c27c29ea39bd61f106adc699be4a.png)

这次我得到的每个失败的请求跟踪文件都说失败发生在“FILE_CACHE_ACCESS_END”事件之后。此事件在做什么，为什么会拒绝访问？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T21:06:31.867

编辑：

您可能应该尝试按照[此处](http://learn.iis.net/page.aspx/266/troubleshooting-failed-requests-using-tracing-in-iis/)的“失败的请求跟踪”说明进行操作。该错误几乎可以肯定与 NTFS 权限有关。

看起来您在问题行中遇到了 Win32“找不到路径”错误（在`3`HTTP 状态代码之后，字段`sc-win32-status`）。

这些文件是否在网络共享上？看起来 Web 服务器和托管这些文件的驱动器之间可能存在一些连接问题。这可能是 IIS 用户在尝试读取这些文件时出现的授权错误，这可以解释 401 错误。

W3C 扩展日志文件格式 (IIS 6.0)：http: [//www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/676400bc-8969-4aa7-851a-9319490a9bbb.mspx?mfr=true](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/676400bc-8969-4aa7-851a-9319490a9bbb.mspx?mfr=true)

Win32 状态码在这里：http: [//msdn.microsoft.com/en-us/library/ms681382.aspx](http://msdn.microsoft.com/en-us/library/ms681382.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T15:35:34.003

我会先在运行状况监控日志中查看该错误的原因（事件代码 3005：System.Data.Linq.ChangeConflictException）。如果您的问题在此错误之后开始出现，那么消除此错误很有可能会解决您的问题。

以下是一些讨论此错误的页面，可能有助于理解错误以及如何修复它：

[http://blogs.microsoft.co.il/blogs/bursteg/archive/2007/11/25/linq-to-sql-concurrency-changeconflictexception-row-not-found-or-changed.aspx](http://blogs.microsoft.co.il/blogs/bursteg/archive/2007/11/25/linq-to-sql-concurrency-changeconflictexception-row-not-found-or-changed.aspx)

[http://sebastienlachance.com/post/SystemDataLinqChangeConflictException-Row-not-found-or-changed.aspx](http://sebastienlachance.com/post/SystemDataLinqChangeConflictException-Row-not-found-or-changed.aspx)

[http://weblogs.asp.net/okloeten/archive/2008/04/28/6139181.aspx](http://weblogs.asp.net/okloeten/archive/2008/04/28/6139181.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-07T14:32:09.483

我长期以来一直在努力解决这个错误。

此错误的一个奇怪原因是资源（文件或文件夹）位于共享（SMB 共享）中，对“每个人”的访问权限有限或没有访问权限。这会覆盖您可能专门添加到文件夹或文件的权限，并导致匿名访问出现 401.3 错误。

# flash - Coldfusion 9 Flash 表单在 Safari 5 中没有响应

> ID：10922553
> 
> 赞同：0
> 
> 时间：2012-06-06T21:25:21.687
> 
> 标签：flash, coldfusion, safari, cfform

我有一些带有两个输入和一个提交按钮的简单代码，可在 Chrome 和 Firefox 中使用，但在 Safari 中完全没有响应。它不允许我输入文本，并且“提交”按钮似乎处于非活动状态。这是我的代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Untitled Document</title>

<style type="text/css">
    @charset "utf-8";

    body {
        background-color: #ccc;
        font-family: Verdana, Geneva, sans-serif;
        font-size: 80%;
        margin: 0;
        padding: 0;
    }

    #main {
        width: 798px; /* same as your cfform's width value */
        text-align: center;
        margin: 0 auto;
    }

</style>

</head>

<body>

<CFIF NOT ISDEFINED("FORM.SUBMIT")>
    <div id="main">
        <cfform format="flash" action="" skin="haloorange" width="798" height="540" style="background-color: ##999999; margin-top: 8px; margin-left: 38px;">
            <cfformgroup type="panel" label="APPLICATION" width="790" style="background-color:##DDDDDD;">
                <CFINPUT label="First Name" TYPE="Text" NAME="fname" MESSAGE="First Name required." value="Ahmed" REQUIRED="Yes" tooltip="Enter your first name." width="298">
                <CFINPUT label="Last Name" TYPE="Text" NAME="lname" MESSAGE="Last Name required." value="Osman" REQUIRED="Yes" tooltip="Enter your last name." width="298">
                <CFINPUT TYPE="submit" size="49" NAME="submit" value="Submit" tooltip="Save your name.">
             </cfformgroup>
        </cfform>
    </div>
<CFELSE>
    <cfdump var="#FORM#">
</CFIF>

</body>
</html> 
```

我觉得我的代码没有任何问题，尽管它很简单，但我尝试过更简单的方法——看起来 Coldfusion 无法在 Safari 中生成有效的 flash 表单，但这似乎是一个太大的错误，无法被忽视互联网。

谢谢，艾哈迈德

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T01:14:29.043

我在 Mac 上的 Safari 中尝试了你的代码，我看到的和你一样。表单无法正确呈现，您无法输入文本并出现加载光标。

这很可能是 ColdFusion 的 Flash 表单中的一个错误。如果愿意，您可以使用 Adob​​e (http://bugbase.adobe.com/) 记录错误，但我不指望它会很快得到修复。

综上所述，我强烈建议您使用 Flash Forms 以外的其他工具。如果您想要基于 Flash 的应用程序，请考虑使用 Flex，但实际上，您应该使用带有 Javascript 验证的 HTML 表单并使用 CSS 设置样式。实现跨浏览器兼容性会容易得多。Flash Forms 没有保持最新，虽然它们还没有被弃用，但如果它们在 ColdFusion 的未来版本中被删除，我不会感到惊讶。大多数开发人员不使用它们。即使它们确实满足您的需求，您也可能很快遇到它们的局限性。

# sdk - Lua - 在 Corona SDK 中不显示文本

> ID：10922555
> 
> 赞同：0
> 
> 时间：2012-06-06T21:25:33.080
> 
> 标签：sdk, lua, coronasdk

在我使用 Corona SDK 创建的这个应用程序中，当您获胜时，文本“You win”会出现，但不会出现。我可以发布所有代码，但我不认为其余的会很麻烦，所以这里只是精华：

```
_H = display.contentHeight;
_W = display.contentWidth;
mRand = math.random;
o = 0;
time_remain = 20;
time_up = false;
total_orbs = 45;
total_secs = 20;
ready = false;

local backGround = display.newImage("media/bg.png");

backGround.xScale = 2;
backGround.yScale = 2;

loseMSG = display.newText("You Lose!", _W/2, _H/2, nil, 50)
loseMSG.isVisible = false

winMSG = display.newText("You Win!", _W/2, _H/2, nil, 50)
winMSG.isVisible = false

local countdowntxt = display.newText(time_remain, 0, 0, native.systemFont, 60);
countdowntxt.xScale = .5; countdowntxt.yScale = .5;
countdowntxt:setReferencePoint(display.BottomRightReferencePoint);
countdowntxt.x = _W-20; display.y = _H-20;
countdowntxt:setTextColor(0, 0, 0)

function winLose(condition)
if (condition == "Win") then
    bgAlpha = display.newImage("media/bgAlpha.png");
    bgAlpha.xScale = 2;
    bgAlpha.yScale = 2; 
    winMSG.isVisible = true -- Here the win text should become visible, but doesn't
elseif (condition == "Fail") then
    bgAlpha = display.newImage("media/bgAlpha.png");
    bgAlpha.xScale = 2;
    bgAlpha.yScale = 2; 
    loseMSG.isVisible = true        
end 
```

结尾

任何想法为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T21:42:11.743

您需要采取分而治之的方法。

这行得通吗？

```
winMSG = display.newText("You Win!", _W/2, _H/2, nil, 50)
winMSG.isVisible = true <-- note this is set to true 
```

有吗？

`winLose`每个都被调用吗？将打印语句或断点或您在平台上用于调试的任何内容放入其中。

有吗？

变量`condition`包含什么？检查/打印它并验证它确实是“Win”、相同的大小写、没有空格等，或者您可以在该函数的适当分支中放置一个打印语句以确保它被命中。

那样可以么？

`bgAlpha`如果您删除代码，它会显示吗？

等等等等。

* * *

我不知道 Corona，但谷歌搜索[文档`newText`](http://developer.anscamobile.com/content/displaynewtext#Parameters)可能是你的参数错误（你没有传递字体）。

> 我可以发布所有代码

您发布的越少越好，因为这意味着您已经完成了上面显示的步骤以尝试隔离问题。十分之九，这样做会自行揭示问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T21:37:04.427

为什么你给 nil 的字体值？至少通过默认系统字体

```
loseMSG = display.newText("You Lose!", _W/2, _H/2, native.systemFont, 50)
winMSG = display.newText("You Win!", _W/2, _H/2, native.systemFont, 50) 
```

# c# - linq 作为列名的数据集问题

> ID：10922556
> 
> 赞同：2
> 
> 时间：2012-06-06T21:25:36.963
> 
> 标签：c#, linq, linq-to-dataset

如何避免在针对数据表的 LINQ 查询中使用魔术字符串？

这有效：

```
公共 IEnumerable getDisplayNames()
{
    IEnumerable nameQry =
        从 displayTable.AsEnumerable() 中的行
        选择行。字段（“显示”）；

    返回名称Qry；
}

```

但这失败了“指定的演员表无效。”：

```
公共 IEnumerable getDisplayNames()
{
    string disp = myDictionary["D"];

    IEnumerable nameQry =
        从 displayTable.AsEnumerable() 中的行
        选择行。字段（显示）；

    返回名称Qry；
}

```

我的偏好是使用本地字符串（或 myDictionary 的直接引用），而不是对字符串进行硬编码。所以我想在查询中使用字符串 disp 而不是短语“display”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T21:32:53.613

尝试使用

```
static IEnumerable<DataRow> GetTheRows(DataTable dt, string name)
{
    return dt.AsEnumerable().Where(r => r.Field<string>("yourColumn") == name);
} 
```

或者您给定场景中的任何正确数据类型。`Field<T>`使用方法时需要指定类型。

# c++ - OpenMP 如何实现对临界区的访问？

> ID：10922558
> 
> 赞同：1
> 
> 时间：2012-06-06T21:25:46.917
> 
> 标签：c++, c, openmp, critical-section

我想读取一个输入文件（在 C/C++ 中）并尽可能快地独立处理每一行。处理本身需要一些滴答声，所以我决定使用 OpenMP 线程。我有这个代码：

```
#pragma omp parallel num_threads(num_threads)
{
  string line;
  while (true) {
#pragma omp critical(input)
    {
      getline(f, line);
    }
    if (f.eof())
      break;
    process_line(line);
  }
} 
```

我的问题是，如何确定要使用的最佳线程数？理想情况下，我希望在运行时动态检测到这一点。我不了解 DYNAMIC 计划选项`parallel`，所以我不能说这是否有帮助。有什么见解吗？

另外，我不确定如何“手动”确定最佳数量。我为我的特定应用尝试了各种数字。我原以为报告的 CPU 使用率`top`会有所帮助，但它没有（！）在我的情况下，CPU 使用率始终保持在 num_threads*(85-95) 左右。但是，`pv`为了观察我读取输入的速度，我注意到最佳数字在 2-5 左右；高于此，输入速度变小。所以我的问题是 - 为什么在使用 10 个线程时我会看到 850 的 CPU 使用率？这可能是由于 OpenMP 如何处理等待进入临界区的线程效率低下吗？

编辑：这里有一些时间。我通过以下方式获得了它们：

```
for NCPU in $(seq 1 20) ; do echo "NCPU=$NCPU" ; { pv -f -a my_input.gz | pigz -d -p 20 | { { sleep 60 ; PID=$(ps gx -o pid,comm | grep my_prog | sed "s/^ *//" | cut -d " " -f 1) ; USAGE=$(ps h -o "%cpu" $PID) ; kill -9 $PID ; sleep 1 ; echo "usage: $USAGE" >&2 ; } & cat ; } | ./my_prog -N $NCPU >/dev/null 2>/dev/null ; sleep 2 ; } 2>&1 | grep -v Killed ; done 
```

NCPU=1 [8.27MB/s] 使用率：98.4

NCPU=2 [12.5MB/s] 使用率：196

NCPU=3 [18.4MB/s] 使用：294

NCPU=4 [23.6MB/s] 使用率：393

NCPU=5 [28.9MB/s] 使用：491

NCPU=6 [33.7MB/s] 使用：589

NCPU=7 [37.4MB/s] 使用率：688

NCPU=8 [40.3MB/s] 使用率：785

NCPU=9 [41.9MB/s] 使用：884

NCPU=10 [41.3MB/s] 使用率：979

NCPU=11 [41.5MB/s] 使用率：1077

NCPU=12 [42.5MB/s] 使用率：1176

NCPU=13 [41.6MB/s] 使用率：1272

NCPU=14 [42.6MB/s] 使用率：1370

NCPU=15 [41.8MB/s] 使用：1493

NCPU=16 [40.7MB/s] 使用：1593

NCPU=17 [40.8MB/s] 使用率：1662

NCPU=18 [39.3MB/s] 使用率：1763

NCPU=19 [38.9MB/s] 使用率：1857

NCPU=20 [37.7MB/s] 使用：1957

我的问题是我可以在 785 CPU 使用率下实现 40MB/s，但也可以在 1662 CPU 使用率下实现。那些额外的周期去哪里了？

EDIT2：感谢 Lirik 和 John Dibling，我现在明白了，我发现上面的时序令人费解的原因与 I/O 无关，而是与 OpenMP 实现关键部分的方式有关。我的直觉是，如果您在 CS 中有 1 个线程和 10 个线程等待进入，那么在第一个线程退出 CS 的那一刻，内核应该唤醒*另一个线程*并让它进入。时序表明并非如此：它可以线程会自行唤醒多次并发现 CS 被占用？这是线程库还是内核的问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T21:54:20.687

> “我想读取一个输入文件（在 C/C++ 中）并尽可能快地独立处理每一行。”

从文件读取会使您的应用程序 I/O 受限，因此仅读取部分所能达到的最大性能就是以最大磁盘速度读取（在我的机器上，CPU 时间不到 10%）。这意味着，如果您能够从任何处理中完全释放读取线程，则处理所需的处理时间将少于剩余的 CPU 时间（我的计算机为 90%）。如果行处理线程占用的 CPU 时间超过剩余 CPU 时间，那么您将无法跟上硬盘驱动器的速度。

在这种情况下有几种选择：

1.  将输入排队并让处理线程出队“工作”，直到它们赶上所呈现的输入（假设您有足够的 RAM 来执行此操作）。
2.  打开足够多的线程并最大化您的处理器，直到读取所有数据，这是您最好的方案。
3.  限制读取/处理，以免占用所有系统资源（以防您担心 UI 响应和/或用户体验）。

> “......处理本身需要一些滴答声，所以我决定使用 OpenMP 线程”

这是一个好兆头，但这也意味着你的 CPU 利用率不会很高。这是您可以优化性能的部分，正如 John Dibling 所提到的，最好手动完成。一般来说，最好将每一行都排队，让处理线程从队列中拉取处理请求，直到你没有更多要处理的内容。后者也被称为生产者/消费者设计模式——并发计算中非常常见的模式。

## 更新

> 为什么会有区别
> 
> *   (i) 每个进程获取锁、拉取数据、释放锁、处理数据；和
> *   (ii) 一个过程：拉数据，获取锁，入队块，释放锁，
> *   其他：获取锁、出队块、释放锁、处理数据？

几乎没有区别：在某种程度上，两者都代表消费者/生产者模式。在第一种情况（i）中，您没有实际的队列，但您可以将文件流视为您的生产者（队列），而消费者是从流中读取的线程。在第二种情况 (ii) 中，您显式地实现了消费者/生产者模式，这种模式更加健壮、可重用并且为生产者提供了更好的抽象。如果您决定使用多个“输入通道”，那么后一种情况会更好。

最后（可能也是最重要的），您可以使用具有单个生产者和单个消费者[的无锁队列](https://stackoverflow.com/questions/1164023/is-there-a-production-ready-lock-free-queue-or-hash-implementation-in-c)，这将使 (ii) 比 (i) 更快地让您成为 i/o 绑定。使用无锁队列，您可以在**没有锁定的情况下***提取数据*、*将块**入* 队和出队列。

 *** * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T21:34:05.890

您希望做的最好的事情就是通过重复的测量-调整-比较循环手动调整它。

用于处理数据集的最佳线程数在很大程度上取决于许多因素，其中最重要的是：

1.  数据本身
2.  你用来处理它的算法
3.  线程正在运行的 CPU
4.  操作系统

您可以尝试设计某种启发式方法来测量处理器的吞吐量并即时调整它，但这种事情往往比它的价值更麻烦。

通常，对于 I/O 绑定的任务，我通常从每个核心大约 12 个线程开始，然后从那里进行调整。对于受 CPU 限制的任务，我会从每个内核大约 4 个线程开始，然后从那里开始。如果您真的想优化处理器的使用，关键是“从那里开始”部分。

另外请记住，如果您真的想优化，您应该使此设置可配置，因为部署此设置的每个系统都具有不同的特征。**

# javascript - 将模型添加到 Backbone.js 集合静默失败

> ID：10922561
> 
> 赞同：0
> 
> 时间：2012-06-06T21:25:52.607
> 
> 标签：javascript, backbone.js, backbone.js-collections

我正在实施博客引擎作为新工作的学习练习。我有一个名为 BlogList 的 Backbone.js Collection 类，它由 BlogModel 对象组成（BlogModel 是博客的单个帖子）。我有一个 masterBlogList，它在应用程序的整个生命周期内将所有博客文章保存在内存中（我意识到这不是一个现实的设计，但它是规范的一部分）。

我选择使用 masterBlogList 来保存应用程序的规范状态。所有新帖子、编辑等都保存在数据库 (MongoDB) 以及 masterBlogList 中。当我想在 masterBlogList 中显示帖子的子集时，我将它们复制到一个新的 BlogList 实例中，然后根据搜索条件缩小这个新实例的范围。再一次，我意识到这可能不是最好的设计（克隆 BlogModels 和 BlogLists），但这是我所拥有的，我不想重新设计它。

问题是将一个 BlogList 复制到另一个是行不通的。即使源列表不为空，目标列表也始终为空。我试图以各种方式调试它，但没有运气。这是 BlogList 源代码的相关部分：

```
// BlogList

$ (function () {
App.BlogList = Backbone.Collection.extend ({
    model : App.BlogModel,
    url : '/blog-entries',

    comparator : function (a) {
        return -(new Date (a.get ('date')));
    },

    populateFromMemory : function (sourceList) {
        // this.reset ();

        var self = this;
        sourceList.each (function (postModel) {
            self.add(postModel);
        });

        var foo = new App.BlogModel();
        this.add(foo);
    }, 
```

（继续...）

即使是关于 foo 的最后一点也不起作用。我还尝试添加 postModel 的 clone() 以及新的 App.BlogModel(postModel.toJSON())。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T22:43:33.380

很抱歉打扰了任何人:<，但我得到了它的工作。代码实际上确实像上面写的那样工作。问题是我的搜索条件过滤掉了所有帖子，所以我什么也没看到。结束漫长的一天！感谢那些试图帮助我的人...

# php - php 5.3 转换 array_walk_recursive

> ID：10922563
> 
> 赞同：4
> 
> 时间：2012-06-06T21:25:56.717
> 
> 标签：php, multidimensional-array, php-5.3

我有以下代码，我想摆脱调用时传递引用，（从 5.2 转换为 5.3）但我不确定正确的方法是什么（类，全局变量，？）

这是一个应该包含所有内容的键盘 [http://codepad.org/ombgFPMR](http://codepad.org/ombgFPMR)

```
<?php

function count_things($item, $key, $total) {
    $total++;
}

$counts = array(100 => 1,
            101 => 1,
            102 => array(
                106 => 1,
                107 => 1
            ),
            103 => 1,
            104 => 1,
            105 => array(
                108 => 1,
                109 => array(
                    110 => 1,
                    111 => 1,
                    112 => 1
                )
            )
        );

foreach($counts as $key => $count) {
    $total = 0;

    if(is_array($count)) {
            $total++;
            /* The below is a logic error. Array elements that contain arrays do not get
               the callback function called on them. Therefore, any children with children
               of their own will not be counted. In the output of this paste,
               the final key, $final_counts[105]['total'], should have a value of 6, but it
               actually has a value of 5\. */
    array_walk_recursive($count, 'count_things', &$total);
} else {
            $total = $count;
    }

    $final_counts[$key]['total'] = $total;
}   

print_r($final_counts);

?> 
```

输出如下所示：

```
Array
(
[100] => Array
    (
        [total] => 1
    )

[101] => Array
    (
        [total] => 1
    )

[102] => Array
    (
        [total] => 3
    )

[103] => Array
    (
        [total] => 1
    )

[104] => Array
    (
        [total] => 1
    )

[105] => Array
    (
        [total] => 5
    )

) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T21:46:09.800

~~您可以`count`与`COUNT_RECURSIVE`标志一起使用。~~

您应该为此使用闭包，这些是在 5.3.0 中引入的，因此它们应该可以工作。

```
<?php

$counts = array(
    100 => 1,
    101 => 1,
    102 => array(
        106 => 1,
        107 => 1
    ),
    103 => 1,
    104 => 1,
    105 => array(
        108 => 1,
        109 => array(
            110 => 1,
            111 => 1,
            112 => 1
        )
    )
);

$final_counts = array();

foreach($counts as $key => $count) {

    if(is_array($count)) {
        $total = 1;
        array_walk_recursive($count, function() use (&$total) {
            $total++;
        });
    } else {
        $total = $count;
    }

    $final_counts[$key]['total'] = $total;
}

print_r($final_counts); 
```

如果您将问题放在上下文中，我可能会提供更好的解决方案。

# java - 你能明白为什么这个 if 语句不能正常工作吗？

> ID：10922577
> 
> 赞同：0
> 
> 时间：2012-06-06T21:27:26.277
> 
> 标签：java

当我运行它时，if 语句总是返回 false，因此不会运行我在那里的两行。您可以在上面的行中看到我检查了单词是否实际上相同并且它们是相同的。那么这里有什么我完全没有注意到的，还是我只是搞砸了？如果重要的话，我正在使用 Eclipse。

```
boolean wordHasElement = false;
for (int firstdimension = 0; firstdimension <= wordnumber-1; firstdimension++){
    System.out.println("-"+ words[firstdimension][0] + "-" + linewords[linewordnumber]  + "-");
    if (words[firstdimension][0] == linewords[linewordnumber] ){
        System.out.println("Worked");
        wordHasElement = true;
    }
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-06T21:29:09.633

> if (words[firstdimension][0] == linewords[linewordnumber] ){

应该替换为

```
if (words[firstdimension][0].equals(linewords[linewordnumber] ){ 
```

*   == 检查一个对象是否与另一个对象相同，而您对此并不感兴趣。
*   `equals(...)`检查两个字符串是否包含相同的字符串——相同顺序的相同字母——这很重要。`equalsIgnoreCase(...)`或者，如果大小写无关紧要，您可以使用。

# oracle - 使用 OpenID 身份验证对 Oracle RDBMS 进行身份验证的 JDBC 驱动程序？

> ID：10922585
> 
> 赞同：0
> 
> 时间：2012-06-06T21:27:59.717
> 
> 标签：oracle, jdbc

我想知道以下几点：

JDBC 驱动程序使用 OpenID 身份验证向远程 Oracle RDBMS 验证用户。在这种情况下，Oracle RDBMS 将看不到用户的密码。

1.  是否可以将 Oracle RDBMS 设置为 OpenID 依赖方？如果是这样，可以通过这种方式设置哪些版本？

2.  是否有 JDBC 驱动程序可以充当用户代理来处理 HTTP(S) 重定向以及 OpenID 身份验证中固有的此类？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T02:30:17.990

看看 Oracle Identity Federation。

# java - 每当我尝试在 Eclipse 中打开 jsp 页面时都会发生错误。

> ID：10922589
> 
> 赞同：1
> 
> 时间：2012-06-06T21:28:15.743
> 
> 标签：java, eclipse, editor, swt, jface

每当我在 Eclipse IDE 中打开`jsp`页面时，都会出现以下错误：

```
eclipse.buildId=unknown
java.version=1.5.0_14
java.vendor=Sun Microsystems Inc.
BootLoader constants: OS=win32, ARCH=x86, WS=win32, NL=fr_FR
Framework arguments:  -product org.eclipse.epp.package.jee.product
Command-line arguments:  -os win32 -ws win32 -arch x86 -product    org.eclipse.epp.package.jee.product

Error
Wed Jun 06 18:00:25 CEST 2012
Problems occurred when invoking code from plug-in: "org.eclipse.jface".

java.lang.IllegalArgumentException: Argument cannot be null
    at org.eclipse.swt.SWT.error(SWT.java:3865)
    at org.eclipse.swt.SWT.error(SWT.java:3799)
    at org.eclipse.swt.SWT.error(SWT.java:3770)
    at org.eclipse.swt.graphics.ImageLoader.load(ImageLoader.java:128)
    at org.eclipse.swt.graphics.ImageDataLoader.load(ImageDataLoader.java:22)
    at org.eclipse.swt.graphics.ImageData.<init>(ImageData.java:331)
    at org.eclipse.wst.xml.ui.internal.editor.CMImageUtil.getImageDescriptor(CMImageUtil.java:83)
    at org.eclipse.wst.xml.ui.internal.editor.CMImageUtil.getImage(CMImageUtil.java:62)
    at org.eclipse.wst.xml.ui.internal.contentoutline.JFaceNodeAdapter.getLabelImage(JFaceNodeAdapter.java:144)
    at org.eclipse.wst.xml.ui.internal.contentoutline.JFaceNodeLabelProvider.getImage(JFaceNodeLabelProvider.java:56)
    at org.eclipse.jface.viewers.ColumnLabelProvider.update(ColumnLabelProvider.java:37)
    at org.eclipse.jface.viewers.ViewerColumn.refresh(ViewerColumn.java:145)
    at org.eclipse.jface.viewers.AbstractTreeViewer.doUpdateItem(AbstractTreeViewer.java:932)
    at org.eclipse.jface.viewers.AbstractTreeViewer$UpdateItemSafeRunnable.run(AbstractTreeViewer.java:102)
    at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42)
    at org.eclipse.core.runtime.Platform.run(Platform.java:888)
    at org.eclipse.ui.internal.JFaceUtil$1.run(JFaceUtil.java:48)
    at org.eclipse.jface.util.SafeRunnable.run(SafeRunnable.java:175)
    at org.eclipse.jface.viewers.AbstractTreeViewer.doUpdateItem(AbstractTreeViewer.java:1012)
    at org.eclipse.jface.viewers.StructuredViewer$UpdateItemSafeRunnable.run(StructuredViewer.java:481)
    at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42)
    at org.eclipse.core.runtime.Platform.run(Platform.java:888)
    at org.eclipse.ui.internal.JFaceUtil$1.run(JFaceUtil.java:48)
    at org.eclipse.jface.util.SafeRunnable.run(SafeRunnable.java:175)
    at org.eclipse.jface.viewers.StructuredViewer.updateItem(StructuredViewer.java:2111)
    at org.eclipse.jface.viewers.AbstractTreeViewer.createTreeItem(AbstractTreeViewer.java:827)
    at org.eclipse.jface.viewers.AbstractTreeViewer$1.run(AbstractTreeViewer.java:802)
    at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:70)
    at org.eclipse.jface.viewers.AbstractTreeViewer.createChildren(AbstractTreeViewer.java:776)
    at org.eclipse.jface.viewers.TreeViewer.createChildren(TreeViewer.java:639)
    at org.eclipse.jface.viewers.AbstractTreeViewer.internalInitializeTree(AbstractTreeViewer.java:1490)
    at org.eclipse.jface.viewers.TreeViewer.internalInitializeTree(TreeViewer.java:828)
    at org.eclipse.jface.viewers.AbstractTreeViewer$5.run(AbstractTreeViewer.java:1474)
    at org.eclipse.jface.viewers.StructuredViewer.preservingSelection(StructuredViewer.java:1392)
    at org.eclipse.jface.viewers.TreeViewer.preservingSelection(TreeViewer.java:402)
    at org.eclipse.jface.viewers.StructuredViewer.preservingSelection(StructuredViewer.java:1353)
    at org.eclipse.jface.viewers.AbstractTreeViewer.inputChanged(AbstractTreeViewer.java:1467)
    at org.eclipse.jface.viewers.ContentViewer.setInput(ContentViewer.java:274)
    at org.eclipse.jface.viewers.StructuredViewer.setInput(StructuredViewer.java:1634)
    at org.eclipse.wst.sse.ui.internal.contentoutline.ConfigurableContentOutlinePage.setInput(ConfigurableContentOutlinePage.java:664)
    at org.eclipse.wst.sse.ui.internal.contentoutline.ConfigurableContentOutlinePage.setConfiguration(ConfigurableContentOutlinePage.java:639)
    at org.eclipse.wst.sse.ui.internal.contentoutline.ConfigurableContentOutlinePage.createControl(ConfigurableContentOutlinePage.java:380)
    at org.eclipse.ui.views.contentoutline.ContentOutline.doCreatePage(ContentOutline.java:137)
    at org.eclipse.ui.part.PageBookView.createPage(PageBookView.java:409)
    at org.eclipse.ui.part.PageBookView.partActivated(PageBookView.java:752)
    at org.eclipse.ui.views.contentoutline.ContentOutline.partBroughtToTop(ContentOutline.java:212)
    at org.eclipse.ui.part.PageBookView$4.partBroughtToTop(PageBookView.java:1015)
    at org.eclipse.ui.internal.PartListenerList2$2.run(PartListenerList2.java:85)
    at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42)
    at org.eclipse.core.runtime.Platform.run(Platform.java:888)
    at org.eclipse.ui.internal.PartListenerList2.fireEvent(PartListenerList2.java:55)
    at org.eclipse.ui.internal.PartListenerList2.firePartBroughtToTop(PartListenerList2.java:83)
    at org.eclipse.ui.internal.PartService.firePartBroughtToTop(PartService.java:212)
    at org.eclipse.ui.internal.WorkbenchPagePartList.firePartBroughtToTop(WorkbenchPagePartList.java:76)
    at org.eclipse.ui.internal.WorkbenchPagePartList.fireActiveEditorChanged(WorkbenchPagePartList.java:52)
    at org.eclipse.ui.internal.PartList.setActiveEditor(PartList.java:162)
    at org.eclipse.ui.internal.WorkbenchPage.makeActiveEditor(WorkbenchPage.java:1277)
    at org.eclipse.ui.internal.WorkbenchPage.updateActivePart(WorkbenchPage.java:1222)
    at org.eclipse.ui.internal.WorkbenchPage.partAdded(WorkbenchPage.java:1698)
    at org.eclipse.ui.internal.EditorAreaHelper.addEditor(EditorAreaHelper.java:217)
    at org.eclipse.ui.internal.EditorManager.createEditorTab(EditorManager.java:778)
    at org.eclipse.ui.internal.EditorManager.openEditorFromDescriptor(EditorManager.java:677)
    at org.eclipse.ui.internal.EditorManager.openEditor(EditorManager.java:638)
    at org.eclipse.ui.internal.WorkbenchPage.busyOpenEditorBatched(WorkbenchPage.java:2854)
    at org.eclipse.ui.internal.WorkbenchPage.busyOpenEditor(WorkbenchPage.java:2762)
    at org.eclipse.ui.internal.WorkbenchPage.access$11(WorkbenchPage.java:2754)
    at org.eclipse.ui.internal.WorkbenchPage$10.run(WorkbenchPage.java:2705)
    at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:70)
    at org.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:2701)
    at org.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:2685)
    at org.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:2676)
    at org.eclipse.ui.ide.IDE.openEditor(IDE.java:651)
    at org.eclipse.ui.ide.IDE.openEditor(IDE.java:610)
    at org.eclipse.jdt.internal.ui.javaeditor.EditorUtility.openInEditor(EditorUtility.java:361)
    at org.eclipse.jdt.internal.ui.javaeditor.EditorUtility.openInEditor(EditorUtility.java:168)
    at org.eclipse.jdt.ui.actions.OpenAction.run(OpenAction.java:229)
    at org.eclipse.jdt.ui.actions.OpenAction.run(OpenAction.java:208)
    at org.eclipse.jdt.ui.actions.SelectionDispatchAction.dispatchRun(SelectionDispatchAction.java:274)
    at org.eclipse.jdt.ui.actions.SelectionDispatchAction.run(SelectionDispatchAction.java:250)
    at org.eclipse.jdt.internal.ui.navigator.OpenAndExpand.run(OpenAndExpand.java:49)
    at org.eclipse.ui.actions.RetargetAction.run(RetargetAction.java:221)
    at org.eclipse.ui.navigator.CommonNavigatorManager$3.open(CommonNavigatorManager.java:202)
    at org.eclipse.ui.OpenAndLinkWithEditorHelper$InternalListener.open(OpenAndLinkWithEditorHelper.java:48)
    at org.eclipse.jface.viewers.StructuredViewer$2.run(StructuredViewer.java:842)
    at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:42)
    at org.eclipse.core.runtime.Platform.run(Platform.java:888)
    at org.eclipse.ui.internal.JFaceUtil$1.run(JFaceUtil.java:48)
    at org.eclipse.jface.util.SafeRunnable.run(SafeRunnable.java:175)
    at org.eclipse.jface.viewers.StructuredViewer.fireOpen(StructuredViewer.java:840)
    at org.eclipse.jface.viewers.StructuredViewer.handleOpen(StructuredViewer.java:1101)
    at org.eclipse.ui.navigator.CommonViewer.handleOpen(CommonViewer.java:467)
    at org.eclipse.jface.viewers.StructuredViewer$6.handleOpen(StructuredViewer.java:1205)
    at org.eclipse.jface.util.OpenStrategy.fireOpenEvent(OpenStrategy.java:264)
    at org.eclipse.jface.util.OpenStrategy.access$2(OpenStrategy.java:258)
    at org.eclipse.jface.util.OpenStrategy$1.handleEvent(OpenStrategy.java:298)
    at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84)
    at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1003)
    at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3910)
    at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3503)
    at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2405)
    at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2369)
    at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2221)
    at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:500)
    at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)
    at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:493)
    at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)
    at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:113)
    at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:194)
    at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)
    at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)
    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:368)
    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:585)
    at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:559)
    at org.eclipse.equinox.launcher.Main.basicRun(Main.java:514)
    at org.eclipse.equinox.launcher.Main.run(Main.java:1311) 
```

每次我在编辑器中单击时都会弹出一个窗口，这很烦人。

我尝试了 eclipse clean 但这不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T14:58:55.863

使用较新的版本。 [http://bugs.eclipse.org/328364](http://bugs.eclipse.org/328364)已在 Helios SR2 和更新版本中修复。

# alfresco - 我在哪里可以找到 Alfresco 4 表单定义？

> ID：10922595
> 
> 赞同：0
> 
> 时间：2012-06-06T21:28:29.503
> 
> 标签：alfresco, activiti

我开始使用 activiti 工作流程，我正在使用 Alfresco Enterprise 4 附带的 bitnami 堆栈 (http://bitnami.org/stack/alfresco)。我想知道在哪里可以找到所有表单和模型定义以及如何我创造新的？我找不到它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T11:44:10.087

请阅读有关内容建模和表单配置的[本教程。](http://ecmarchitect.com/archives/2012/01/09/1509)

# javascript - 淘汰赛绑定不初始化，从更新开始

> ID：10922599
> 
> 赞同：3
> 
> 时间：2012-06-06T21:28:49.080
> 
> 标签：javascript, data-binding, initialization, knockout.js

我有这两个使用相同初始化代码的绑定，并且绑定到相同的值，但它们的初始化不同。第一个运行正常，第二个运行更新而不是 init。以下是绑定：

```
 function initToggle(element, valueAccessor) {
    // Initially set the element to be instantly visible/hidden depending on the value
    var value = valueAccessor();
    $(element).toggle(ko.utils.unwrapObservable(value)); // Use "unwrapObservable" so we can handle values that may or may not be observable
};

//Binding Handlers
ko.bindingHandlers.fadeVisible = {
    init: initToggle,
    update: function (element, valueAccessor) {
        // Whenever the value subsequently changes, slowly fade the element in or out
        var value = valueAccessor();
        ko.utils.unwrapObservable(value) ? $(element).fadeIn() : $(element).fadeOut();
    }
};

ko.bindingHandlers.slideVisibleVertical = {
    init: initToggle,
    update: function(element, valueAccessor, allBindingsAccessor) {        
        var value = valueAccessor(); //Lastest binding value
        var allBindings = allBindingsAccessor(); //other bindings, allows options

        var valueUnwrapped = ko.utils.unwrapObservable(value); 
        var duration = allBindings.slideDuration || 400; // 400ms is default duration unless otherwise specified

        if (valueUnwrapped == true)
             $(element).show('slide', {direction: 'up'}, duration);
        else
            $(element).hide('slide', {direction: 'up'}, duration);
    }
}; 
```

从字面上看，相同的初始化函数。这是[一个显示两个按钮的小提琴](http://jsfiddle.net/tyrsius/EHgpM/4/)，它们都绑定到相同的值。`fadeVisible`如图所示开始，但`slidevisibleVertical`滑入。更新时两者都动画。有人知道这里发生了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T21:39:32.177

该`update`函数也总是第一次运行。

因为你`fadeVisible`的元素已经可见，所以淡入它不会做任何事情。

对于调用`slide`它的其他绑定仍然会为其设置动画，即使它已显示。

您可以通过一些不同的方式来处理它：

*   在元素 ($data) 上存储一些内容以表明您处于第一次通过并在更新结束时将其清除（反之亦然）
*   在滑动前检查可见性（正如您在评论中提到的）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-11-20T17:53:02.177

为了澄清接受的答案关于在元素（$data）上存储一些东西的评论，这里是示例代码：

```
ko.bindingHandlers.myHandler = {
    init: function (element, valueAccessor) {
        $(element).data("isFirstPass", true);
    },
    update: function (element, valueAccessor) {
        // Always unwrap so that ko tracks the dependency
        ko.unwrap(valueAccessor());

        if ($(element).data("isFirstPass")) {
            $(element).removeData("isFirstPass")
        }
        else {
            // Do something cool
        }
    }
}; 
```

# java - 尝试在 Ubuntu 上编译/运行 Java 代码，错误：java.lang.NoClassDefFoundError: org/apache/pdfbox/pdmodel/PDDocument

> ID：10922601
> 
> 赞同：1
> 
> 时间：2012-06-06T21:28:54.200
> 
> 标签：java, ubuntu, pdfbox

我正在尝试在 Ubuntu 系统上运行以下 Java 代码。代码应使用 pdfbox 类创建一个空白 PDF 文件：

```
import org.apache.pdfbox.pdmodel.*;
import java.io.*;

public class BlankPDF {
    public static void main(String[] args) {
        PDDocument doc = null;
        try{
            doc = new PDDocument();
        } catch (IOException ie){
            System.out.println(ie);
        }
        doc.addPage(new PDPage());
        try{
            doc.save("Empty PDF.pdf");
            doc.close();
        } catch (Exception io){
            System.out.println(io);
        }
    }
} 
```

我在与脚本相同的目录中有以下类依赖项：

*   pdfbox-1.7.0.jar
*   jempbox-1.7.0.jar
*   fontbox-1.7.0.jar
*   commons-logging-1.1.1.jar

我使用以下命令编译脚本：

```
sudo javac BlankPDF.java -classpath pdfbox-1.7.0.jar:fontbox-1.7.0.jar:jempbox-1.7.0.jar:commons-logging-1.1.1.jar 
```

哪个没有返回输出并创建了一个 .class 文件（表明编译工作正常？）

但是当我尝试使用以下命令运行代码时：

```
sudo java BlankPDF -classpath pdfbox-1.7.0.jar:fontbox-1.7.0.jar:jempbox-1.7.0.jar:commons-logging-1.1.1.jar 
```

我收到此错误：

```
Exception in thread "main" java.lang.NoClassDefFoundError: org/apache/pdfbox/pdmodel/PDDocument
    at BlankPDF.main(BlankPDF.java:15)
Caused by: java.lang.ClassNotFoundException: org.apache.pdfbox.pdmodel.PDDocument
    at java.net.URLClassLoader$1.run(URLClassLoader.java:217)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:205)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:321)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:294)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:266)
    ... 1 more 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T21:32:37.907

类的名称必须是 的最后一个参数`java`。标志必须在它之前。如果您将标志放在命令行的末尾，就像这里一样，它们将被忽略。所以：

```
java -classpath .:pdfbox-1.7.0.jar:fontbox-1.7.0.jar:jempbox-1.7.0.jar:commons-logging-1.1.1.jar BlankPDF 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T22:29:28.683

参考上面的答案，不要忘记在类路径中使用 jars 命令添加当前目录（带点号）

```
java -classpath hello.jar:. SampleProgram 
```

# performance - gcc 可能不太可能使用宏

> ID：10922607
> 
> 赞同：12
> 
> 时间：2012-06-06T21:29:23.557
> 
> 标签：performance, gcc, memory, likely-unlikely

我正在用大致以下逻辑编写一段关键代码

```
if(expression is true){
   //do something with extremely low latency before the nuke blows up. This branch is entered rarely, but it is the most important case
}else{
   //do unimportant thing that doesnt really matter
} 
```

我正在考虑`likely()`在表达式周围使用宏，所以当它到达重要分支时，我得到最小的延迟。

我的问题是，用法与宏名称建议相反，因为我选择了*不太可能*的分支进行预取，即重要的分支不太可能发生，但它发生时是最*关键*的事情。

在性能方面这样做有明显的缺点吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-06T21:44:24.710

是的。您通过将不太可能但必须快速的分支标记为可能的分支来欺骗编译器，希望编译器能够使其更快。

这样做有一个明显的缺点——如果你没有写一个好的评论来解释你在做什么以及为什么，一些维护者（可能是你自己）在六个月内几乎肯定会说，“嘿，看起来他将可能的分支放在错误的分支上”并“修复”它。

还有一个不太可能但仍然可能的缺点，即您现在或将来使用的某些编译器版本将执行与您对可能宏的预期不同的事情，并且这些不同的事情不会是您想要的欺骗编译器，你最终会得到这样的代码，每次通过循环，在撤消它之前推测性地花费 100K 美元通过反应器关闭的 90%。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-05T15:45:57.440

它与 __builtin_expect(x, 1) 的传统用法完全相反，后者在宏的意义上使用：

```
#define likely(x) __builtin_expect(x, 1) 
```

我个人认为这是不好的形式（因为您隐晦地将不太可能的路径标记为可能获得性能提升）。但是，您仍然可以标记此优化，因为 __builtin_expect(x) 不会通过声明“likey”路径来假设您的需求 - 这只是标准用途。要执行您想要的操作，我建议：

```
#define optimize_path(x) __builtin_expect(x, 1) 
```

这将做同样的事情，但不是让代码指责不太可能的路径，而是让代码描述你真正尝试的内容——优化关键路径。

但是，我应该说，如果您计划对 nuke 进行计时 - 您不仅应该手动检查（和计时）已编译的程序集以确保计时正确，而且您还应该使用 RTOS。分支错误预测将产生非常微不足道的影响，以至于在这里几乎没有必要，因为您可以通过简单地拥有更快的处理器或正确地为错误预测的延迟计时来补偿“百万分之一”事件。影响现代计算机时序的是操作系统抢占和调度。如果您需要在非常离散的时间尺度上发生某些事情，您应该将它们安排为实时，而不是大多数通用操作系统所具有的伪实时。分支错误预测通常比在 RT 情况下不使用 RTOS 可能发生的延迟小数百倍。通常，如果您认为分支错误预测可能是一个问题，您可以从时间敏感问题中删除分支，因为分支预测器通常具有复杂且不受您控制的状态。宏之类的“可能”和“不太可能”用于可以从各个区域命中的代码块，具有各种分支预测状态，最重要的是非常频繁地使用。命中这些分支的高频率导致使用它的应用程序（如 Linux 内核）的性能显着提高。如果你只打树枝一次，你 因为分支预测器通常具有复杂且无法控制的状态。宏之类的“可能”和“不太可能”用于可以从各个区域命中的代码块，具有各种分支预测状态，最重要的是非常频繁地使用。命中这些分支的高频率导致使用它的应用程序（如 Linux 内核）的性能显着提高。如果你只打树枝一次，你 因为分支预测器通常具有复杂且无法控制的状态。宏之类的“可能”和“不太可能”用于可以从各个区域命中的代码块，具有各种分支预测状态，最重要的是非常频繁地使用。命中这些分支的高频率导致使用它的应用程序（如 Linux 内核）的性能显着提高。如果你只打树枝一次，你 命中这些分支的高频率导致使用它的应用程序（如 Linux 内核）的性能显着提高。如果你只打树枝一次，你 命中这些分支的高频率导致使用它的应用程序（如 Linux 内核）的性能显着提高。如果你只打树枝一次，你*在某些情况下可能会*获得 1 纳秒的性能提升，但如果应用程序对时间至关重要，那么您可以采取其他措施来帮助自己获得更大的性能提升。

# canvas - 捏放大画布

> ID：10922611
> 
> 赞同：6
> 
> 时间：2012-06-06T21:30:01.763
> 
> 标签：canvas, kineticjs, pinchzoom

我正在尝试在画布上设置简单的放大/缩小功能。我正在使用 KineticJS 处理触摸事件并在画布中绘图，但无法实现缩放。KinteicJS 有一个类似的例子，但它们总是在中心放大，而我很想放大手指之间的点。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-12-10T00:43:01.297

我为一个项目编写的综合示例显示：
- 使用滚轮围绕鼠标点进行桌面缩放
- 使用跨浏览器滚轮，包括 firefox（使用 jquery.mousewheel.js）
- 使用手指之间的捏合点进行 iPAD 缩放
- 支持 iPAD 方向更改和禁用safari 自动缩放
- 缩放一层，同时保持其他层不缩放
- OOP javascript“类”并将事件代理到本地方法

```
<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <script src="http://d3lp1msu2r81bx.cloudfront.net/kjs/js/lib/kinetic-v4.7.4.min.js"></script>
  <script src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
  <script src="https://rawgithub.com/brandonaaron/jquery-mousewheel/master/jquery.mousewheel.js"></script>
</head>
<body>
  <div id="container"></div>

<script type='text/javascript'>
function makePos(x, y) {
    return {
        'x': x,
        'y': y
    };
}

function View() {
    this.init = init;

    var self = this;

    var kineticStage,
        kineticLayer,
        kineticTextLayer,

        zoomOrigin = makePos(0, 0),
        zoomFactor = 1.1,
        pinchLastDist, pinchStartCenter;

    init();

    function init() {

        // disable ipad zoom to prevent safari from zooming on orientation change
        $('head meta[name=viewport]').remove();
        $('head').prepend('<meta name="viewport" content="user-scalable=no, width=device-width, minimum-scale=1.0 , initial-scale=1.0, maximum-scale=1.0" />');

        // create stage layer and circle
        kineticStage = new Kinetic.Stage({
            container: 'container',
            width: $(document).width() - 10,
            height: $(document).height() - 10,
        });

        kineticLayer = new Kinetic.Layer({
            draggable: true
        });
        var circle = new Kinetic.Circle({
            x: 200,
            y: 200,
            radius: 50,
            fill: '#00D200',
            stroke: 'black',
            strokeWidth: 2,
        });
        kineticLayer.add(circle);
        kineticStage.add(kineticLayer);

        kineticTextLayer = new Kinetic.Layer({});
        kineticStage.add(kineticTextLayer);

        // register events and proxy to methods
        $(kineticStage.content).on('mousewheel', function(e) {
            e.preventDefault();
            var evt = e.originalEvent;
            stageMouseWheel.call(self, evt.deltaY, makePos(evt.clientX, evt.clientY));
        });
        kineticStage.getContent().addEventListener('touchmove', function(e) {
            e.preventDefault(); // prevent iPAD panning
            var touch1 = e.touches[0];
            var touch2 = e.touches[1];
            if (touch1 && touch2) {
            touch1.offsetX = touch1.pageX - $(touch1.target).offset().left;
            touch1.offsetY = touch1.pageY - $(touch1.target).offset().top;
            touch2.offsetX = touch2.pageX - $(touch2.target).offset().left;
            touch2.offsetY = touch2.pageY - $(touch2.target).offset().top;
            stagePinch.call(self, makePos(touch1.offsetX, touch1.offsetY), makePos(touch2.offsetX, touch2.offsetY));
            }
        }, false);
        kineticStage.getContent().addEventListener('touchend', function(e) {
            stageTouchEnd.call(self);
        }, false);

        $(window).on("orientationchange", function(event) {
            window.scrollTo(0, 0); // scroll to top left on orientation change
        });

        editTextLayer('scrollwheel/pinch to zoom');
        window.scrollTo(0, 0);
    }

    function zoom(newscale, center) { // zoom around center
        var mx = center.x - kineticLayer.getX(),
            my = center.y - kineticLayer.getY(),
            oldscale = kineticLayer.getScaleX();
        editTextLayer('zoom ' + newscale.toFixed(2) + ' around ' + mx.toFixed(2) + ',' + my.toFixed(2));

        zoomOrigin = makePos(mx / oldscale + zoomOrigin.x - mx / newscale, my / oldscale + zoomOrigin.y - my / newscale);

        kineticLayer.setOffset(zoomOrigin.x, zoomOrigin.y);
        kineticLayer.setScale(newscale);
        kineticLayer.draw();
    }

    function stageMouseWheel(factor, p) {
        var oldscale = kineticLayer.getScaleX(),
            newscale = oldscale * (zoomFactor - (factor < 0 ? 0.2 : 0));
        zoom(newscale, p);
    }

    function stagePinch(p1, p2) {
        var dist = Math.sqrt(Math.pow((p2.x - p1.x), 2) + Math.pow((p2.y - p1.y), 2));
        if (!pinchLastDist) pinchLastDist = dist;
        var newscale = kineticLayer.getScale().x * dist / pinchLastDist;

        var center = makePos(Math.abs((p1.x + p2.x) / 2), Math.abs((p1.y + p2.y) / 2));
        if (!pinchStartCenter) pinchStartCenter = center;

        zoom(newscale, pinchStartCenter);
        pinchLastDist = dist;
    }

    function stageTouchEnd() {
        pinchLastDist = pinchStartCenter = 0;
    }

    function editTextLayer(text) {
        var label = new Kinetic.Text({
            x: 0,
            y: 0,
            text: text,
            fontSize: 12,
            fontFamily: 'Calibri',
            fill: 'black'
        });

        kineticTextLayer.destroyChildren();
        kineticTextLayer.add(label);
        kineticTextLayer.drawScene();
    }
}

$(window).load(function() {
    var view = new View();
}); 
</script>

</body>
</html> 
```

[http://jsfiddle.net/45YJH/1/](http://jsfiddle.net/45YJH/1/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-02T02:38:18.103

对于那些仍然对我们如何在画布中使用 kineticJS 进行缩放和平移感兴趣的人。

[http://jsfiddle.net/v1r00z/ZJE7w/](http://jsfiddle.net/v1r00z/ZJE7w/)

# html - 标题元素中文本周围的空格

> ID：10922613
> 
> 赞同：0
> 
> 时间：2012-06-06T21:30:32.223
> 
> 标签：html, css, padding

我一直在使用 firebug 检查标题元素，并注意到标题容器不会拥抱其包含的文本，即使我没有设置填充。

```
<h2>test</h2> 
```

[http://jsfiddle.net/BTwk6/](http://jsfiddle.net/BTwk6/)

上下间距大于左右间距，结果是我的h2没有正对着它的容纳框。

这是正常的吗？反正有没有让 h2 框拥抱它的文本？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T23:11:15.170

尝试调整 line-height 属性，默认情况下，不同的字体在它们上方和下方有不同的空间。您可能无法完全解决此问题。例如，这个词

```
Tempura 
```

比这个词高很多

```
mum 
```

但是“妈妈”这个词的上下线高度仍必须与“天妇罗”相同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T05:18:17.470

是的，这很正常，事情应该是这样的。例如，如果您在标题元素上设置边框，您将看到标题文本中的字符通常不会触及边框。

这有两个原因。首先，字体的高度是一个设计概念，并不（通常）对应于任何字母的高度；甚至大写字母上方以及文本基线下方都有空白空间。在某些设计中，像“j”或“g”这样的降序可能会到达字体的底部，而像“Ê”这样的变音符号可能会到达顶部，甚至超出它。

其次，通常在一条线的上方和下方都有一些前导，通常总共是字体高度的 15-20%。默认值取决于字体（和浏览器）。实际上，这意味着提高可读性并防止字符接触上一行或下一行的字符。

前导是通过设置间接设置的`line-height`，因为`line-height`设置的总高度是字体高度（字体大小）和前导的总和。通过设置`line-height: 1`，您将前导设置为零；这在排版中称为“设置实体”，它可以适用于孤立的线条，如单行标题。但是仍然存在由提到的第一个原因引起的间距，即“内置”到字体中的间距。您甚至可以设置`line-height`为较小的值，例如 0.85，使前导负数。请注意，如果使用的字体与您在页面上建议的字体不同，这可能会导致字符垂直截断。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T21:32:16.350

默认情况下，h2 元素的顶部和底部边距为 19px。尝试重置它

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T21:34:27.657

尝试重置边距和填充：

```
h2{margin:0;padding:0} 
```

用您自己的值替换 0 ...

咪咪

# layout - 2 列 css 布局，没有假列

> ID：10922619
> 
> 赞同：1
> 
> 时间：2012-06-06T21:31:08.510
> 
> 标签：layout, css

我知道这个问题的常见解决方案是人造布局，但这对我不起作用，因为我有一个带有阴影的部分需要延伸到侧边栏上。这个问题有什么新的解决方法吗？我希望此内容部分始终是#main 的 100%，因此侧边栏不会延伸到其下方。

我已经包含了整个 HTML / CSS。

```
<html>

<head>
    <title>Test</title>

    <style type="text/css" media="screen">
        * {
            margin:0;
            padding: 0;
        }
        body {
            background: #ccc;
        }
        #content {
           width: 900px;
            margin: 50px auto;
            background: #fff;
        }
        #main {
            overflow: hidden;
        }
        #sidebar {
            width: 180px;
            float: left;
        }
        #sidebar li {
           padding: 10px;
           border-bottom: 1px #ccc solid;
        }
        #main-content {
            -moz-box-shadow: 0 0 25px rgba(0, 0, 0, .5);
            -webkit-box-shadow: 0 0 25px rgba(0, 0, 0, 0.5);
            box-shadow: 0 0 25px rgba(0, 0, 0, 0.5);
            float: left;
            width: 700px;
            padding: 10px
        }

    </style>

</head>

<body>

    <div id="content">
        <div id="main">
            <div id="sidebar">
                <ul>
                  <li>Item</li>
                  <li>Item</li>
                  <li>Item</li>
                  <li>Item</li>
                  <li>Item</li>
                  <li>Item</li>
                  <li>Item</li>
                  <li>Item</li>
                  <li>Item</li>
                  <li>Item</li>
                </ul>
            </div>
            <div id="main-content">I'd like this content section to always be 100% of the #main, so the sidebar doesn't extend below it.</div>
        </div>
    </div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T21:41:37.363

您可以为此使用 Jquery：

`$("#main-content").height($("#sidebar").height() - 20);`

`-20`是您应用的填充。

这是一个工作演示：http: [//jsfiddle.net/rniestroj/DEVha/](http://jsfiddle.net/rniestroj/DEVha/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T21:38:48.167

您可以使用背景图像设置 div 包装器。在这个包装器内部，您将两个浮动 div 放在两个浮动 div 下方 - 但仍然在包装器内部 - 您可以使用以下行终止浮动：

```
<div style="clear: both; height: 0; overflow: hidden;">&nbsp;</div> 
```

# wordpress - 使用插件域时无法在 Firefox 中加载字体

> ID：10922620
> 
> 赞同：0
> 
> 时间：2012-06-06T21:31:10.950
> 
> 标签：wordpress, firefox, dns, cross-domain, font-face

我在一个域上安装了 WordPress，称之为 not-very-apealing-name-domain1.com。我还有一个插件域名 domain2.com，它加载位于第一个域中的任何内容。我注意到在使用 domain2.com 访问网站时，Firefox 中没有加载字体，并且控制台中显示以下错误：

`downloadable font: download failed (font-family: "CoolFont1" style:normal weight:normal stretch:normal src index:1): bad URI or cross-site access not allowed`

字体是网站，两个域都位于网络托管服务中。如何让字体加载？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T22:52:40.930

这可能与`Access-Control-Allow-Origin` 您可能想知道的更多细节有关：[https](https://developer.mozilla.org/en/http_access_control) ://developer.mozilla.org/en/http_access_control 可能的解决方案：[Access-Control-Allow-Origin Multiple Origin Domains？](https://stackoverflow.com/questions/1653308/access-control-allow-origin-multiple-origin-domains)

# c# - 打开 XML 2.0 c# 解析 excel 文件，但未检索到某些行

> ID：10922622
> 
> 赞同：0
> 
> 时间：2012-06-06T21:31:17.217
> 
> 标签：c#, excel, openxml-sdk

我已经阅读了很多人们由于空值而丢失单元格数据的地方，但我的问题是我正在解析的电子表格中有 272 行数据需要解析。当我获得行数时，我只能检索 269。下面是我如何获得行数。

```
// code above gets worksheet...
var rows = from row in worksheet.Descendants<Row>()
                             where row.RowIndex >= rowIndex
                             select row;

for (int i = 0; i <= rows.Count(); i++)
{
  // processing...
} 
```

使用上面的 rowIndex 是因为我只在几个标题行之后拉出 272 行，并且它需要是动态的，因为某些工作表有多个标题行。基本上，我搜索字符串的特定单元格值，然后从那里获取 rowIndex 并使用它来获取行数。

我已经追踪到两行没有被拾取并且其中没有值，但是还有其他行完全相同但没有值并且这些行被包括在内。这很重要，因为我需要解析的所有工作表都有 272 行特定数据，在同一位置有空白行。一张纸可以正常工作并包含行，而另一张则不会。

因此，我试图确定为什么包含一些空白行，而其他空白行却被完全忽略，就像它们不存在一样。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T15:47:26.330

不包含具有值的单元格的行不应作为行包含在总计数中。这是有道理的，因为 excel 不存储单元格值为空的行或单元格信息。

其他没有任何值但确实显示的行很可能在某个单元格中的某个地方有一个空格。空格是单元格的有效值，虽然它看起来是空的，但它将存储为单元格值并计入总行数。

# android - 来自 Thread 的 Android 更新 UI（处理程序可能不是一个选项？）

> ID：10922623
> 
> 赞同：0
> 
> 时间：2012-06-06T21:31:18.130
> 
> 标签：android, multithreading, events, user-interface, updating

这是一个常见的问题，我已经阅读了处理它的各种方法，但似乎每种方法都达不到我想要做的事情，这本质上是一个好的 OO-Citizen。

我有一个调用 CommunicationManager 的 Activity，它基本上轮询 TCP 套接字以获取数据。当 CommunicationManager 接收到数据时，它会抛出一个自定义事件（包含它刚刚获取的字符串），该事件由 Activity 处理。我这样做，A）因为其他类将依赖于该数据，而不仅仅是 Activity，并且 B）因为轮询是异步的，并且应该在收到结果时触发一个事件。

我的问题在于我需要将这些结果显示在 UI 上的 TextView 中。我已经设置了轮询机制，它每 1000 毫秒触发一次，并调用 Activity 上的事件处理程序。但是，UI 永远不会更新。

假设这是一个线程问题，并且 UI 线程不是对 TextView 进行更改的线程，但是我该怎么做呢？我曾尝试使用处理程序，但不确定将它放在哪里，当我得到它编译时，它从未更新过 UI。

如果一切都在 Activity 中完成，这似乎相对微不足道，但是添加另一个类 (CommunicationManager) 和事件让我非常困惑。

这是我到目前为止所拥有的：

活动（通过单击 UI 上的按钮调用轮询）：

```
public void onClick(View v) {
    if (v.getId() == R.id.testUDPBtn) {
        statusText.setText("");

        commMgr = new CommunicationManager();
        commMgr.addEventListener(this);

        MediaPositionPollThread poller = new MediaPositionPollThread(commMgr);
        poller.startPolling();
    }
}

@Override
public void handleMediaPositionFoundEvent(MediaPositionFoundEvent e) {
    statusText.append(e.userData);
} 
```

线：

```
class MediaPositionPollThread extends Thread {
    private CommunicationManager commManager;
    private static final String TAG = "MediaPositionPollThread";
    private boolean isPolling = false;

    public MediaPositionPollThread(CommunicationManager cm) {
        commManager = cm;
    }

    public void startPolling() {
        isPolling = true;
        this.run();
    }

    public void stopPolling() {
        isPolling = false;
    }

    @Override
    public void run() {
        while (isPolling) {
            try {
                commManager.getCurrentMediaPosition();
                Thread.sleep(1000);
            }
            catch (InterruptedException e) {
                Log.d(TAG, "EXCEPTION: " + e.getMessage());
            }
        }
    }
} 
```

通讯经理：

```
public void getCurrentMediaPosition() {
    PrintWriter outStream;
    BufferedReader inStream;
    String resultString = "";

    try {
        outStream = new PrintWriter(tcpSocket.getOutputStream(), true);
        outStream.println("GET?current_pts");

        inStream = new BufferedReader(new InputStreamReader(tcpSocket.getInputStream()));
        resultString = inStream.readLine();

        fireEventWithData(resultString);
    } catch (Exception e) {
        e.printStackTrace();
    }
}

public synchronized void addEventListener(MediaPositionFoundEventListener listener)  {
    _listeners.add(listener);
}

public synchronized void removeEventListener(MediaPositionFoundEventListener listener)   {
    _listeners.remove(listener);
}

private synchronized void fireEventWithData(String outputString) {
    MediaPositionFoundEvent evt = new MediaPositionFoundEvent(this);
    evt.userData = outputString;

    Iterator<MediaPositionFoundEventListener> i = _listeners.iterator();
    while(i.hasNext()) {
        ((MediaPositionFoundEventListener) i.next()).handleMediaPositionFoundEvent(evt);
    }
} 
```

因此，我让 Activity 创建一个每秒执行一次的线程，调用 CommunicationManager >> getCurrentMediaPosition，然后触发 MediaPositionFoundEvent，该事件由 Activity 处理并更新屏幕上的 TextView (statusText)。

一切正常，除了屏幕不更新。我已经尝试过 runOnUiThread 和 Handler，但显然没有做对。

提前感谢您提供任何见解或解决方案！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T21:41:58.063

In your `Activity` class, add a private `Handler _handler`, Initialize it in your `onCreate` Activity method,

and change your `handleMediaPositionFoundEvent` method to

```
@Override    public void handleMediaPositionFoundEvent(MediaPositionFoundEvent e) {  
          _handler.post(new Runnable(){  
             public void run(){  
               statusText.append(e.userData);  
           });  
          }  
        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T21:52:47.003

看起来你用你的 custom 阻塞了 UI 线程`Thread`。请更新此方法以调用`start()`vs `run()`。

```
public void startPolling() {
    isPolling = true;
    this.start();
} 
```

# windows-8 - Windows 8 开发者 ID

> ID：10922625
> 
> 赞同：0
> 
> 时间：2012-06-06T21:31:34.190
> 
> 标签：windows-8, microsoft-metro

虽然我知道如何通过 windows 8 powershell 创建开发人员 ID，但我无法确定当我发布到 windows 商店时事情会如何运作，因为目前它只对少数选定的开发人员开放。 [https://appdev.microsoft.com/StorePortals/en-us/Account/Signup/SelectAccountType?wa=wsignin1.0](https://appdev.microsoft.com/StorePortals/en-us/Account/Signup/SelectAccountType?wa=wsignin1.0)

我的问题是，windows 8 开发者帐户如何与 windows 8 开发者 ID（windows live 帐户）相关联。他们是同一个吗？我开始在上面的链接中完成创建过程，似乎我要创建一个单独的帐户......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T08:42:58.733

你的live id和windows store id是关联的。只有通过live id你才能访问windows store。

开发者 id 和 live id 是相关联的。

# ios - 有没有办法限制 NSNotification？

> ID：10922628
> 
> 赞同：0
> 
> 时间：2012-06-06T21:31:45.830
> 
> 标签：ios, xcode, notifications, limit, nsnotification

当开关改变位置以开始更新地图上的注释时，我`NSNotification`会发送通知。我的问题是我有 8 个开关，当用户更改几个开关的位置时，地图会更新很多次。如何将其限制为只有一个通知？

```
- (IBAction)saveSwitch:(id)sender
{

    [[NSNotificationCenter defaultCenter] postNotificationName:@"MyAppSettingsChanged" object:self userInfo:nil];

    NSUserDefaults *defs1 = [NSUserDefaults standardUserDefaults];
    [defs1 setBool: blackSwitch.on forKey: @"blackKey"];

    NSUserDefaults *defs2 = [NSUserDefaults standardUserDefaults];
    [defs2 setBool: greenSwitch.on forKey: @"greenKey"];

    NSUserDefaults *defs3 = [NSUserDefaults standardUserDefaults];
    [defs3 setBool: purpleSwitch.on forKey: @"purpleKey"];

    NSUserDefaults *defs4 = [NSUserDefaults standardUserDefaults];
    [defs4 setBool: orangeSwitch.on forKey: @"orangeKey"];

    NSUserDefaults *defs5 = [NSUserDefaults standardUserDefaults];
    [defs5 setBool: blueSwitch.on forKey: @"blueKey"];

    NSUserDefaults *defs6 = [NSUserDefaults standardUserDefaults];
    [defs6 setBool: redSwitch.on forKey: @"redKey"];

    NSUserDefaults *defs7 = [NSUserDefaults standardUserDefaults];
    [defs7 setBool: darkblueSwitch.on forKey: @"darkblueKey"];

    NSUserDefaults *defs8 = [NSUserDefaults standardUserDefaults];
    [defs8 setBool: yellowSwitch.on forKey: @"yellowKey"];

    [[NSUserDefaults standardUserDefaults] synchronize]; 

} 
```

在另一个视图中

```
- (void)viewWillAppear:(BOOL)animated
{
     [super viewWillAppear:animated];

     [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(onAppSettingsChanged:) name:@"MyAppSettingsChanged" object:nil];

} 
```

更新注释

```
- (void) onAppSettingsChanged:(NSNotification *)notification {

    NSLog(@"Settings was changed");

    //Create the thread 
    [NSThread detachNewThreadSelector:@selector(loadPList) toTarget:self withObject:nil];

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T21:39:08.030

您必须更新一些`BOOL`ean 值以表明您当前没有处理更新，并相应地继续。IE

```
- (void) onAppSettingsChanged:(NSNotification *)notification {
    NSLog(@"Settings was changed");
    if (!myBoolToIndicateProcessing) {
      //Create the thread
      myBoolToIndicateProcessing = YES;
      [NSThread detachNewThreadSelector:@selector(loadPList) toTarget:self withObject:nil];
    }
} 
```

然后，当重新加载完成后，将 BOOL 设置回 NO。

# c# - 将 Moq 用于索引器属性会导致 Castle 出现 InvalidCastException

> ID：10922637
> 
> 赞同：2
> 
> 时间：2012-06-06T21:32:56.890
> 
> 标签：c#, moq

尝试使用 Moq 设置索引器属性时，底层 Castle 库会引发 InvalidCastException。我使用的是最小起订量 4.0.10827，详情如下。如果有人可以帮助我运行简单的测试（如下），请提前致谢。我正在用 Moq 重写单元测试，我正在尝试为以下方法重新进行测试：

```
public INetwork GetInputNetwork(IInputPortMgr inPortMgr)
{
    var port = inPortMgr[0];
    return port.InputNetwork;
} 
```

IInputPortMgr 接口如下：

```
public interface IInputPortMgr
{        
    IInputPort this[int index] { get; }
} 
```

我编写的测试（并尝试了许多变体）可以总结为：

```
[Test]
public void GetInputNetwork_Returns_InputNetwork_From_InputPort()
{
    var mockInPortMgr = new Mock<IInputPortMgr>();
    var mockInPort = new Mock<IInputPort>();
    var mockNet = new Mock<INetwork>();

    mockInPortMgr.Setup(m => m[0]).Returns(mockInPort.Object);  // exception here
    mockInPort.Setup(m => m.InputNetwork).Returns(mockNet.Object);

    // Assertions Here
} 
```

但是当运行单元测试失败时，因为该行抛出异常

`mockInPortMgr.Setup(m => m[0]).Returns(mockInPort.Object);`

异常详情如下：

```
System.InvalidCastException : Unable to cast object of type 'System.Collections.ObjectModel.ReadOnlyCollection`1[System.Reflection.CustomAttributeTypedArgument]' to type 'System.Array'.
at System.Reflection.Emit.CustomAttributeBuilder.EmitValue(BinaryWriter writer, Type type, Object value)
at System.Reflection.Emit.CustomAttributeBuilder.InitCustomAttributeBuilder(ConstructorInfo con, Object[] constructorArgs, PropertyInfo[] namedProperties, Object[] propertyValues, FieldInfo[] namedFields, Object[] fieldValues)
at Castle.DynamicProxy.AttributeUtil.CreateBuilder(CustomAttributeData attribute)
at Castle.DynamicProxy.AttributeUtil.<GetNonInheritableAttributes>d__0.MoveNext()
at Castle.DynamicProxy.Generators.MetaProperty.BuildPropertyEmitter(ClassEmitter classEmitter)
at Castle.DynamicProxy.Contributors.CompositeTypeContributor.ImplementProperty(ClassEmitter emitter, MetaProperty property, ProxyGenerationOptions options)
at Castle.DynamicProxy.Contributors.CompositeTypeContributor.Generate(ClassEmitter class, ProxyGenerationOptions options)
at Castle.DynamicProxy.Generators.InterfaceProxyWithoutTargetGenerator.GenerateType(String typeName, Type proxyTargetType, Type[] interfaces, INamingScope namingScope)
at Castle.DynamicProxy.Generators.InterfaceProxyWithTargetGenerator.GenerateCode(Type proxyTargetType, Type[] interfaces, ProxyGenerationOptions options)
at Castle.DynamicProxy.ProxyGenerator.CreateInterfaceProxyWithoutTarget(Type interfaceToProxy, Type[] additionalInterfacesToProxy, ProxyGenerationOptions options, IInterceptor[] interceptors)
at Moq.Proxy.CastleProxyFactory.CreateProxy(ICallInterceptor interceptor, Type[] interfaces, Object[] arguments)
at Moq.Mock`1.<InitializeInstance>b__0()
at Moq.Mock`1.InitializeInstance()
at Moq.Mock`1.OnGetObject()
at Moq.Mock`1.get_Object()
at Tests.Psi.Type6.Fx.Type6Fixture.GetInputNetwork() in Type6Fixture.cs: line 293 
```

任何想法或任何人都可以指出我正确的方向吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T23:15:37.620

这是合并到 moq 二进制文件 (Castle.Core 2.5.0.0) 的 Castle DynamicProxy 版本中的一个[错误。](http://issues.castleproject.org/issue/DYNPROXY-151)它看起来会影响接受`params`参数的属性。我假设`IInputPort`是用这样的属性装饰的，因为没有提供代码？

您可以使用最新版本的 Castle.Core (3.0.0.0)（*理想*）编译 moq。

或者（*不太理想），从*[Google Code](http://code.google.com/p/moq/downloads/detail?name=Moq.4.0.10827.Final.zip&can=2&q=)下载最新的 moq 版本，其中包括没有`Castle.Core`嵌入的 moq.dll 版本。在您的项目中将其与[Castle.Core 3.0.0.0](https://nuget.org/packages/Castle.Core)一起引用，并在您的 app.config 中添加以下绑定重定向。由于这是一个主要的升级点，我不能保证它的向后兼容性，但我用你的代码测试了这个（以及一个`IInputPort`装饰有一个在 2.5.0.0 中显示错误的属性的界面）并且它有效。

```
 <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="Castle.Core" 
                          publicKeyToken="407dd0808d44fbdc" 
                          culture="neutral" />
        <bindingRedirect oldVersion="2.5.0.0" 
                         newVersion="3.0.0.0" />
      </dependentAssembly>
    </assemblyBinding>
  </runtime> 
```

# ssrs-2008 - SSRS 2008 执行服务 LoadReport 错误

> ID：10922645
> 
> 赞同：5
> 
> 时间：2012-06-06T21:33:59.650
> 
> 标签：ssrs-2008

我正在使用 SSRS 2008（不是 R2）

我有一个部署到开发服务器的报告，我试图通过调用执行服务将报告呈现为 pdf。

我得到的错误是以本机模式运行的报表服务器不支持此操作。---> Microsoft.ReportingServices.Diagnostics.Utilities.OperationNotSupportedNativeModeException：在本机模式下运行的报表服务器不支持此操作。

我注意到两件事：一是 Web 服务 wsdl 显示 LoadReport 有两个参数 - 报告路径和历史 ID，但是当我为 ReportExecution2005.asmx 生成服务引用时，LoadReport 方法有 5 个参数：trusteduserheader、reportPath、historyid、serviceinfoheader , 和执行头

我尝试在 url 末尾添加带有和不带有 ?wsdl 的服务引用，但结果是一样的

这是我正在使用的代码：

```
ReportExecutionServiceSoapClient rs = new ReportExecutionServiceSoapClient("ReportExecutionServiceSoap", "http://xxx:80/ReportServer/ReportExecution2005.asmx");            
        rs.ClientCredentials.Windows.ClientCredential = new NetworkCredential("aaa", "aaa", "aaa"); 

        rs.ClientCredentials.Windows.AllowedImpersonationLevel = TokenImpersonationLevel.Impersonation;

 // Render arguments

    byte[] result = null;
    string reportPath = "/Invoices/InvoiceStandard";
    string format = "PDF";
    string historyID = null;
    string devInfo = "";

    // Prepare report parameter.

    ParameterValue[] parameters = new ParameterValue[3];

    parameters[0] = new ParameterValue();
    parameters[0].Name = "PartyID";
    parameters[0].Value = "19758";
    parameters[1] = new ParameterValue();
    parameters[1].Name = "Contract";
    parameters[1].Value = "17703"; // June
    parameters[2] = new ParameterValue();
    parameters[2].Name = "FinancialPeriod";
    parameters[2].Value = "MAR-2012";
    string encoding="";
    string mimeType="";
    string extension="";
    Warning[] warnings = null;
    string[] streamIDs = null;

    ExecutionInfo execInfo = new ExecutionInfo();
    TrustedUserHeader trusteduserHeader = new TrustedUserHeader();
    ExecutionHeader execHeader = new ExecutionHeader();
    ServerInfoHeader serviceInfo = new ServerInfoHeader();

    execHeader = rs.LoadReport(trusteduserHeader, reportPath, historyID, out serviceInfo, out execInfo);

    rs.SetExecutionParameters(execHeader, trusteduserHeader, parameters, "en-us", out execInfo);

    try
    {                
        rs.Render(execHeader,
                    trusteduserHeader,
                    format, 
                    devInfo, 
                    out result,
                    out extension, 
                    out encoding, 
                    out mimeType, 
                    out warnings, 
                    out streamIDs);
    } 
```

这是我的 web.config

```
<?xml version="1.0"?>
<configuration>
  <connectionStrings>
    <add name="ApplicationServices"
         connectionString="data source=.\SQLEXPRESS;Integrated Security=SSPI;AttachDBFilename=|DataDirectory|\aspnetdb.mdf;User Instance=true"
         providerName="System.Data.SqlClient" />
  </connectionStrings>

  <system.web>
    <compilation debug="true" targetFramework="4.0" />

    <authentication mode="Forms">
      <forms loginUrl="~/Account/Login.aspx" timeout="2880" />
    </authentication>

    <membership>
      <providers>
        <clear/>
        <add name="AspNetSqlMembershipProvider" type="System.Web.Security.SqlMembershipProvider" connectionStringName="ApplicationServices"
             enablePasswordRetrieval="false" enablePasswordReset="true" requiresQuestionAndAnswer="false" requiresUniqueEmail="false"
             maxInvalidPasswordAttempts="5" minRequiredPasswordLength="6" minRequiredNonalphanumericCharacters="0" passwordAttemptWindow="10"
             applicationName="/" />
      </providers>
    </membership>

    <profile>
      <providers>
        <clear/>
        <add name="AspNetSqlProfileProvider" type="System.Web.Profile.SqlProfileProvider" connectionStringName="ApplicationServices" applicationName="/"/>
      </providers>
    </profile>

    <roleManager enabled="false">
      <providers>
        <clear/>
        <add name="AspNetSqlRoleProvider" type="System.Web.Security.SqlRoleProvider" connectionStringName="ApplicationServices" applicationName="/" />
        <add name="AspNetWindowsTokenRoleProvider" type="System.Web.Security.WindowsTokenRoleProvider" applicationName="/" />
      </providers>
    </roleManager>

  </system.web>

  <system.webServer>
     <modules runAllManagedModulesForAllRequests="true"/>
  </system.webServer>
  <system.serviceModel>
    <bindings>
      <basicHttpBinding>
        <binding name="ReportExecutionServiceSoap" closeTimeout="00:01:00"
          openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00"
          allowCookies="false" bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard"
          maxBufferSize="65536" maxBufferPoolSize="524288" maxReceivedMessageSize="65536"
          messageEncoding="Text" textEncoding="utf-8" transferMode="Buffered"
          useDefaultWebProxy="true">
          <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
            maxBytesPerRead="4096" maxNameTableCharCount="16384" />
          <security mode="TransportCredentialOnly">
            <transport clientCredentialType="Windows"/>
            <message clientCredentialType="UserName" algorithmSuite="Default" />
          </security>
        </binding>
      </basicHttpBinding>
    </bindings>
    <client>
      <endpoint address="http://xxx:80/ReportServer/ReportExecution2005.asmx"
        binding="basicHttpBinding" bindingConfiguration="ReportExecutionServiceSoap"
        contract="SSRS.ReportExecutionServiceSoap" name="ReportExecutionServiceSoap" />
    </client>
  </system.serviceModel>
</configuration> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2015-08-24T18:09:37.060

我在使用 SSRS 2008 R2 时遇到了同样的问题，但我不想求助于调用报表查看器控件。

上面，Rick Hodder 使用了以下语句：

```
TrustedUserHeader trusteduserHeader = new TrustedUserHeader(); 
```

`OperationNotSupportedNativeModeException`如果 SSRS 安装未配置 SSL 连接证书，此语句将导致他遇到的错误。检查 SSRS 日志以获取包含以下内容的错误条目：

> 错误：本机模式不支持 TrustedHeader。

如果是这种情况，您需要[将服务器配置为使用 SSL](https://msdn.microsoft.com/en-us/library/ms345223(v=sql.105).aspx)，或者将 null 用于受信任的标头。

```
TrustedUserHeader trusteduserHeader = null; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T07:46:49.143

该报告是从某个前端加载的还是从 DLL 加载的？对我来说，您似乎正在使用 ASP.net 应用程序。在这种情况下，您可以使用 reportViewer 对象为您提取报告，所有繁重的工作都可以由 ReportViewer 完成，然后您可以使用类似这样的方式将文件保存为 PDF

```
 reportViewer.ServerReport.ReportServerUrl = new Uri(Config.ReportServerURL);
 reportViewer.ServerReport.ReportPath = String.Format("{0}/{1}", Config.ReportServerEnvironment, reportName);
 reportViewer.ServerReport.ReportServerCredentials = new ReportsCredentials(Config.ReportServerUser, Config.ReportServerPassword, Config.ReportServerDomain);

reportViewer.GetDocumentStream(SSRSFormatType.Pdf, documentName); 
```

这里的 reportViewer 是对屏幕上 ReportViewer 对象的引用。

# sql-server - 在 SQL Server 2005 中，如何获取视图所依赖的其他数据库中的表？

> ID：10922654
> 
> 赞同：2
> 
> 时间：2012-06-06T21:35:11.543
> 
> 标签：sql-server, sql-server-2008, sql-server-2005

在 SQL Server 2008 中，对于给定数据库中的视图，我可以通过执行以下命令获取视图所依赖的其他数据库中的表：

```
select distinct referenced_database_name, referenced_schema_name, referenced_entity_name
from sys.dm_sql_referenced_entities ('dbo.NameOfView', 'OBJECT')
where referenced_database_name is not null 
```

但是，`sys.dm_sql_referenced_entities`在 SQL Server 2005 中不可用。有没有办法从元数据中获取视图所依赖*的其他数据库中的表列表？*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T21:55:13.183

来自 Aaron Bertrand[模糊相关的博客条目](https://sqlblog.org/2008/09/09/keeping-sysdepends-up-to-date-in-sql-server-2008)：

> 系统表 sysdepends 不维护位于本地数据库之外的任何对象的依赖关系信息。这意味着，如果您想检查 SQL Server 2005 或更早版本中名称由三部分或四部分组成的对象的有效性，您将不得不手动解析所有对象的定义。

他接着从[这里](http://www.sqlmag.com/article/tsql3/a-dependency-checker-you-can-depend-on)推荐了一个解析器——但恐怕在 2005 年这仍然是一项令人讨厌的工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T21:50:59.283

您可以使用[sys.sql_dependencies](http://msdn.microsoft.com/en-us/library/ms174402%28v=sql.90%29.aspx)。不过，它会为您提供每列依赖项，因此您必须唯一的主要 id 才能获取表。

```
select distinct object_name(referenced_major_id)
from sys.sql_dependencies
where object_id = object_id('viewName') 
```

至于从其他数据库获取结果，这将很棘手，因为我不知道数据是如何跨数据库存储的，也无法测试它，因为我没有现成的 SQL Server 2005 安装可供查看。在 SQL Server 2008+ 中，新视图是 sys.sql_expression_dependencies 驱动您提到的 sys.dm_sql_referenced_entities。

我会做更多的挖掘，看看我是否能找到更多的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-06T23:43:17.080

我发现了一些你可能感兴趣的东西。试试 sp_depends。BOL 声明您可以在 SQL Server 2005 中使用此存储过程派生视图的依赖关系。[BOL 链接](http://msdn.microsoft.com/en-us/library/ms189487%28v=sql.90%29.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T07:33:26.240

是的，Zhenny，我们可以从 sqlserver2008+ 版本中实现这一点。然后使用下面的查询列出其他数据库中使用的所有对象。

```
select  referenced_entity_name,referenced_database_name
from sys.sql_expression_dependencies 
where referencing_id = object_id('SCHEMA.OBJECTNAME') 
```

# c# - 如果 ASPX WebMethod 函数名称已更改，则为“未知的 Web 方法”。动态编译问题？

> ID：10922655
> 
> 赞同：0
> 
> 时间：2012-06-06T21:35:24.230
> 
> 标签：c#, jquery, asp.net, ajax, webmethod

我有一个独立的 .ASPX 页面（后面没有代码），它包含一个简单的 WebMethod，我通过 JQuery Ajax 调用它。见下文：

（请注意这是概念验证代码，而不是生产代码！）

```
<!DOCTYPE html>
<%@ Page Language="C#" %>
<%@ Import Namespace="System.Data" %>
<%@ Import Namespace="System.Data.SqlClient" %>

<html>
<head runat="server">
<title>Untitled</title>

<script runat="server" type="text/c#">
[System.Web.Services.WebMethod] 
public static int GetData(int Id)
{
    string connectionString = "Data Source=xxx;Initial Catalog=xxx;User Id=xxx;Password=xxx;";
    using (SqlConnection connection = new SqlConnection(connectionString))
    {
        string query = "SELECT AVG(Number) FROM Data WHERE ID = @Id;";
        using (SqlCommand command = new SqlCommand(query, connection))
        {
            command.Parameters.AddWithValue("@Id", Id);
            connection.Open();
            return (int)command.ExecuteScalar();
        }
    }
}
</script>

<script src="http://code.jquery.com/jquery.min.js" type="text/javascript"></script>

<script type="text/javascript">
    function getAvg() {
        $.ajax({
            type: 'POST',
            url: "WebMethodAjaxExample.aspx/GetData",
            data: JSON.stringify({Id: $('#tbId').val()}),
            contentType: 'application/json',
            success: function (data, textStatus) {
                $('#theParagraph').text(data.d);
            }
        })
    }
</script>
</head>
<body>
<div>
<input type="text" id="tbId" />
<button onclick="getAvg()">Go</button>
</div>
<p id="theParagraph"></p>
</body>
</html> 
```

我已经理智地检查了 SQL 查询，并且知道它返回一个 FLOAT（七位和一位）。但是，如您所见，我的 WebMethod 返回一个 int。因此，我的页面总是四舍五入。

我决定将 WebMethod 返回类型和 ExecuteScalar 转换为 Double。但是页面仍然返回“7”。

经过一番修改，我了解到的最有趣的事实是，当我决定将 C# 代码中的 WebMethod 名称更改为 GetDatum，并对 JQuery Ajax 函数名称进行相关更改时，这次运行页面我得到了回报来自 Ajax 调用的状态 500，错误消息为“未知 Web 方法”。

感觉页面没有像我期望的那样被动态重新编译，而是仍然使用缓存版本，即使请求标头状态为“无缓存”。

如果有任何帮助，该页面托管在 Sharepoint 2010 中。

谁能明白发生了什么？

更新：回收应用程序池可以使最新的 WebMethod 代码正常工作，但在再次重置应用程序池之前不会反映进一步的更新。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-09T19:46:16.757

我从另一个我似乎找不到链接的答案中抓住了这个，但您不需要重置整个应用程序池！我有一个使用 AJAX 从 Web 服务中提取数据的 ASMX 文件。我快疯了，因为更新 Web 服务并没有更改网页正在提取的数据。

将此添加到页面加载后面的代码中，它将清除缓存并使用新更新的 Web 服务：

```
Response.Cache.SetCacheability(HttpCacheability.NoCache);
Response.Cache.SetExpires(DateTime.Now);
Response.Cache.SetNoServerCaching();
Response.Cache.SetNoStore(); 
```

这正是我需要的，但我认为我真的只需要该`SetExpires`行来清除此页面的缓存。

# sql - 自加入问题

> ID：10922656
> 
> 赞同：5
> 
> 时间：2012-06-06T21:35:28.363
> 
> 标签：sql, sql-server, tsql, sql-server-2008, self-join

我有一个名为 tblAccInfo 的表，下面是表数据。我需要像下面这样的输出。

```
Input
PolicyNumber    BankAc   StorageDate    VerNum
6003210400      123      2012-01-01     1
6003210400      164      2012-01-03     2
6003210400      860      2012-01-05     3
6004317654      301      2012-02-05     1
6004317654      615      2012-03-01     2
6004317654      253      2012-03-12     3
6004317654      887      2012-04-03     4 
```

输出

```
PolicyNumber  IntialBankAc IntialSDate VerNum  LatestBankAc LatestSDate VerNum
6003210400    123          2012-01-01  1       860          2012-01-05  3
6004317654    301          2012-02-05  1       887          2012-04-03  4 
```

我尝试过以下自我加入，但没有成功。请帮我解决这个问题。

```
Select DISTINCT
    P.PolicyNumber,
    P.BankAc [IntialBankAc],
    P.StorageDate IntialSDate],
    P.VerNum,
    P1.BankAc [LatestBankAc],
    P1.StorageDate [LatestSDate],
    P1.VerNum
FROM tblAccInfo P
INNER JOIN tblAccInfo P1
ON P1.PolicyNumber=P.PolicyNumber
AND (P.BankAc<>P1.BankAc AND P.StorageDate<>P1.StorageDate AND P.VerNum<>P1.VerNum) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T21:45:04.740

试试这个：

```
SELECT
    T1.PolicyNumber,
    T2.BankAc AS IntialBankAc,
    T2.StorageDate AS IntialSDate,
    T2.VerNum AS InitalVerNum,
    T3.BankAc AS LatestBankAc,
    T3.StorageDate AS LatestSDate,
    T3.Vernum AS LatestVerNum
FROM
(
    SELECT
        PolicyNumber,
        MIN(VerNum) AS MinVerNum,
        MAX(VerNum) AS MaxVerNum
    FROM tblAccInfo
    GROUP BY PolicyNumber
) AS T1
JOIN tblAccInfo AS T2
ON T1.PolicyNumber = T2.PolicyNumber
AND T1.MinVerNum = T2.VerNum
JOIN tblAccInfo AS T3
ON T1.PolicyNumber = T3.PolicyNumber
AND T1.MaxVerNum = T3.VerNum 
```

在线查看它：[sqlfiddle](http://sqlfiddle.com/#!2/29a34/3)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T21:57:25.253

```
DECLARE @x TABLE 
(
  PolicyNumber VARCHAR(32), 
  BankAc       INT, 
  StorageDate  DATE, 
  VerNum       INT
);

INSERT @x VALUES
('6003210400','123','2012-01-01',1),
('6003210400','164','2012-01-03',2),
('6003210400','860','2012-01-05',3),
('6004317654','301','2012-02-05',1),
('6004317654','615','2012-03-01',2),
('6004317654','253','2012-03-12',3),
('6004317654','887','2012-04-03',4);

WITH x AS
(
    SELECT PolicyNumber, BankAc, StorageDate, VerNum,
      f = ROW_NUMBER() OVER (PARTITION BY PolicyNumber ORDER BY VerNum),
      l = ROW_NUMBER() OVER (PARTITION BY PolicyNumber ORDER BY VerNum DESC)
    FROM @x
)
SELECT 
    x.PolicyNumber, 
    InitialBankAc   = x.BankAc, 
    InitialSDate    = x.StorageDate,
    InitialVerNum   = x.VerNum,
    LatestBankAc    = x2.BankAc, 
    LatestSDate     = x2.StorageDate,
    LatestVerNum    = x2.VerNum
FROM x INNER JOIN x AS x2
ON x.PolicyNumber = x2.PolicyNumber
WHERE x.f = 1 AND x2.l = 1
ORDER BY x.PolicyNumber; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T21:44:55.417

未经测试 - 但应该给你的想法。（可能有一种更有效的方法来做到这一点——这只是我突然想到的方法。）

```
select initial.policynumber
,initial.initialbankaccoutn
,initial.initialstoragedate
,initial.intialvernum
,final.latestbankaccount
,final.lateststoragedate
,final.latestvernum
from 
(select a.policynumber, a.bankaccount as initialbankaccount, a.storagedate as initialstoragedate, a.vernum as initialvernum
from tblAccInfo a1
    inner join (select min(storagedate) as storagedate, policynumber
               from tblAccInfo 
               group by policynumber) a
               on a.policynumber = a1.policynumber
               and a.storagedate = a1.storagedate) initial
inner join 
(select b.policynumber, b.bankaccount as latestbankaccount, b.storagedate as lateststoragedate, b.vernum as latestvernum
from tblAccInfo b1
    inner join (select min(storagedate) as storagedate, policynumber
               from tblAccInfo 
               group by policynumber) b
               on a.policynumber = b1.policynumber
               and a.storagedate = b1.storagedate) final
on final.policynumber = initial.policynumber 
```

# c# - 检测修饰键按下？

> ID：10922657
> 
> 赞同：3
> 
> 时间：2012-06-06T21:35:29.983
> 
> 标签：c#, .net, wpf

我有一个 WPF 应用程序需要在第一次按下修饰键（例如 Alt 或 Control）时做出响应。无论是否同时按下其他键，都需要做出响应，所以我基本上需要能够知道这些键中的任何一个按下的瞬间。

我看到的修饰键的事件行为与其他键不同——看起来 KeyDown 事件和 PreviewKeyDown 事件实际上是在按下按钮后弹出时触发的，这没有帮助。

在深入研究事件触发问题时，我创建了一个定时后台循环来轮询所有当前的关键状态。即使这样也不起作用 --- 如果我按下修饰键，并且我没有释放该键或按下任何其他键，则此民意调查错误地表示修饰键实际上并未按下（无限期地，直到另一个键按下）

我觉得我一定错过了一些基本的东西，但到目前为止还没有运气。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T16:37:24.517

事实证明，这种行为特定于我的环境（在 Parallels 6.0 VM 中运行 Windows 和 Visual Studio）。Parallels 必须拦截这些事件以保留一些低级 Mac OS 功能。我不确定其他 VM 设置，但这在本机 Windows 环境中看起来不是问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T01:15:54.270

您是否附加到主窗口实例上的“Keyboard.KeyDown”事件？

```
<Window x:Class="WpfApplication3.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="350" Width="525" Keyboard.KeyDown="Window_KeyDown">

</Window> 
```

# wpf - 如何在堆栈面板上禁用制表位

> ID：10922658
> 
> 赞同：18
> 
> 时间：2012-06-06T21:35:37.683
> 
> 标签：wpf, stackpanel, tabstop

我有一个堆栈面板，当我在应用程序中四处切换时，它会不断获得焦点。

使用 snoop 我可以看到堆栈面板有一个 ContentControl，它有一个 ContentPresenter。获得焦点的是 ContentControl。我怎样才能禁用它？为什么这是默认行为？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-06-07T01:25:29.840

这不是默认行为，如果它已被某些资源覆盖，那么您可以使用重置它

```
KeyboardNavigation.IsTabStop="False" 
```

或者...

```
FocusManager.IsFocusScope="False" 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-12-18T15:14:16.507

使用 StackPanel 作为容器的 DataTemplate 也有类似的问题。然后将 DataTemplate 用于 ListBox 项。在我在实际列表框中使用以下内容之前，没有任何建议对我有用以防止项目接收制表位：

```
KeyboardNavigation.TabNavigation="None" 
```

# php - 使用关系查找模型的兄弟姐妹

> ID：10922666
> 
> 赞同：2
> 
> 时间：2012-06-06T21:36:45.587
> 
> 标签：php, yii

这是模型的表：

```
CREATE TABLE IF NOT EXISTS `SomeModel` (  
  `id` int NOT NULL AUTO_INCREMENT,  
  `parent_id` int NOT NULL
) 
```

我的目标是能够使用以下方法查询具有兄弟姐妹的模型：

```
SomeModel::model()->with('siblings')->findByPk($id); 
```

这是我目前对这种关系的尝试：

```
public function relations()
{
    return array(
        'siblings' => array(self::HAS_MANY, 'SomeModel', array('parent_id'=>'parent_id')),
    );
} 
```

问题是我找不到创建条件的方法，以便模型本身不会与`$model->siblings`数组中的兄弟姐妹一起返回。

任何想法都会很棒。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T04:45:28.737

改变你的关系：

```
'siblings'=>array(self::HAS_MANY, 'Address', array('parent_id'=>'parent_id'),'condition'=>'siblings.id!=t.id') 
```

编辑：一些解释，在[文档中`relation()`](http://www.yiiframework.com/doc/api/1.1/CActiveRecord#relations-detail "http://www.yiiframework.com/doc/api/1.1/CActiveRecord#relations-detail")，我们可以为发生的连接指定额外的选项和这些额外的选项：

> 其他选项可以指定为其余数组元素中的名称-值对。

再加上表的默认别名是`t`use `t.id`。

编辑：来自评论：

实现延迟加载，你想要的方式，将很难完成（我不知道如何，也不确定是否可能），但是我可以建议使当前代码更好，通过

1.  使用[命名范围](http://www.yiiframework.com/doc/guide/1.1/en/database.ar#named-scopes "http://www.yiiframework.com/doc/guide/1.1/en/database.ar#named-scopes")，在进行预加载时使用范围，并`siblings.id!=t.id`在范围中添加条件：

    ```
    // add this function to your model, and remove the condition from the relation
    public function scopes(){
     return array(
        'eagerSibs'=>array(
            'condition'=>'siblings.id!=t.id',
        ),
     );
    } 
    ```

    使用范围进行急切加载：

    ```
    SomeModel::model()->eagerSibs()->with('siblings')->findByPk($id); 
    ```

    这将消除延迟加载的错误`$model->siblings`

2.  虽然延迟加载的错误将被删除，但您仍将获得当前记录，以反驳您可以添加和使用模型的功能，该功能将在没有当前记录的情况下加载相关记录，但您当然不会使用`$model->siblings`，而是有类似的东西：`$model->getLazySibs();`

    ```
    public function getLazySibs(){
        $sibs=$this->siblings;
        foreach ($sibs as $asib){
            if ($asib->id != $this->id)
                $lazySibs[]=$asib;
        }
        return $lazySibs;
    } 
    ```

# asp.net-mvc-3 - NUnit 测试因企业库而失败

> ID：10922669
> 
> 赞同：2
> 
> 时间：2012-06-06T21:37:03.943
> 
> 标签：asp.net-mvc-3, unit-testing, c#-4.0, nunit, enterprise-library

我在这里看到了几个处理类似问题的问题，但没有一个对我有帮助。

我在 MVC 3 项目中使用 NUnit 和 VS 2010。我有一个测试项目，正在编写我的第一个测试 Evar！:-)

你不为我终于得到它而感到自豪吗？！

这是我得到的错误

> Microsoft.Practices.ServiceLocation.ActivationException：尝试获取数据库类型的实例时发生激活错误，键“MyConnection”----> Microsoft.Practices.Unity.ResolutionFailedException：依赖项解析失败，类型=“Microsoft.Practices。 EnterpriseLibrary.Data.Database”，名称 = “MyConnection”。异常发生时：解决时。异常是： InvalidOperationException - 无法构造类型数据库。您必须配置容器以提供此值。

我已经配置了`web.config`所有这些，并且当不在测试中运行时数据完美返回，所以我知道不是配置正在死去，它只是在与 NUnit 一起使用时死去。

这是我的连接信息：

```
<section name="dataConfiguration" type="Microsoft.Practices.EnterpriseLibrary.Data.Configuration.DatabaseSettings, Microsoft.Practices.EnterpriseLibrary.Data, Version=5.0.505.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" requirePermission="true" />
...
<dataConfiguration defaultDatabase="MyConnection" />
<connectionStrings>
<add name="MyConnection" connectionString="Data Source=MyServerName;Initial Catalog=MyDB;user id=MyUser;password=MyPassword"
  providerName="System.Data.SqlClient" />
</connectionStrings> 
```

我已经使用 NuGet 安装了 DaaB，并且还做了一个干净的手动参考。无论哪种方式，数据在正常使用中加载良好，但在测试中它在这一行消失：

```
var database = DatabaseFactory.CreateDatabase("MyConnection"); 
```

在这个方法中

```
public IEnumerable<SchoolSearchResultsDTO> Find(SchoolSearchInputDTO dto) {
    List<SchoolSearchResultsDTO> fullList;
    var database = DatabaseFactory.CreateDatabase("MyConnection");
    using (var command = database.GetStoredProcCommand("dbo.usp_School_SearchBySchoolName")) {
        database.AddInParameter(command, "@I_strSchoolName", DbType.String, dto.SearchTerm);
        database.AddInParameter(command, "@I_intNumberOfRecords", DbType.Int32, dto.MaxSearchResults);
        using (var reader = database.ExecuteReader(command)) {
            fullList = new List<SchoolSearchResultsDTO>();
            while (reader.Read()) {
                var fullRecord = new SchoolSearchResultsDTO();
                fullRecord.SchoolID = reader.GetInteger("SchoolId");
                fullRecord.SchoolName = reader.GetString("SchoolName");
                fullRecord.IsDetailedDisplayMode = reader.GetBoolean("IsDetailedDisplayMode");
                fullList.Add(fullRecord);
            }
            reader.Close();
        }
    }
    return fullList;
} 
```

所有其他帖子都谈到了错误配置等。我很确定我的配置正确，否则我不会在正常使用下获得数据。所以它必须与 NUnit 和 DaaB 一起使用。

有什么好主意吗？:-) 谢谢大家！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T00:49:25.697

同意@Jesse 关于模拟依赖项。如果您不隔离 sut 那么它不是单元测试。（推荐阅读[单元测试艺术](http://artofunittesting.com/)）

因此，从那开始，您可以说您正在编写集成测试。

如果不查看您的确切设置，很难说出问题所在。你提到的一件事是你已经“配置了你的`web.config`”。

但是您是否在测试项目中设置了配置文件？配置将从您的单元测试项目加载，而不是 MVC 项目。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T23:01:00.357

通常最好避免在单元测试中直接访问数据库。我建议留出一些时间来阅读有关创建有价值且可靠的单元测试的模拟。通过模拟，您可以将模拟服务层注入到相关控制器中，该服务层将被设置为返回您预期的数据库数据。

在您的测试中，您将创建该服务层的模拟。对于使用[moq](http://code.google.com/p/moq/)的示例（我的模拟框架首选项）：

```
// create your expected data
var YourExpectedData = new IList<SchoolSearchResultsDTO>();

// .... add your expected information

//create & setup mock
var _service = new Mock<IYourService>();
_service.Setup(service => service.Find(It.IsAny<SchoolSearchInputDTO>())).Returns(YourExpectedData);

// create your controller
var controller = new YourCountroller(_service.object()) 
```

从这一点开始，您的单元测试非常简单。每当在各种代码中调用方法 find 时，您的测试模拟就会启动并返回您的预期数据。

# asp.net-mvc-3 - mvc3 - 覆盖表单集合键

> ID：10922676
> 
> 赞同：0
> 
> 时间：2012-06-06T21:37:52.040
> 
> 标签：asp.net-mvc-3, dynamic, formcollection

我将 mvc3 与动态创建的表单一起使用，默认的 modelBinder 对我没有帮助。

我想获得对与控制值关联并回发到表单集合中的表单集合键的控制权。

```
controllerContext.HttpContext.Request.Form["IWantToSetThisKeyRightHere"] 
```

目前，这些键是在我不理解支持默认模型绑定的某个地方自动生成的，这对我来说无论如何都不起作用。

在创建视图时如何设置这些值，以便我可以在发布动态表单时尝试使用自己的自定义模型绑定器来提取数据？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T21:06:12.300

表单集合的关键来自输入元素的名称属性。我试图通过使用 html 帮助程序并为 name 属性传入一个*新*值来覆盖它。

像这样：

```
@{ var uniqueNameAttribute = new { name = Model.UniqueName };}   
@Html.TextBox(Model.MessageText, Model.Answer, uniqueNameAttribute) 
```

我试图设置的名称值 (Model.UniqueName) 被一个字符串覆盖，该字符串可能是由 mvc 设计的，以允许它在发布后的 modelBinding 期间将值映射回相同的 Model 类。

由于我的系统是动态的，mvc 无法将数据映射回模型。我想控制该值，以使我能够在发布时*手动*将数据映射回。

解决方案非常简单，我所要做的就是*不*使用 @Html.TextBox 帮助器来生成文本框，而是使用我想要的 name 属性自己创建它。

```
<input type="text" class="vmFreeTextAnswer" name="@Model.UniqueName" value="" /> 
```

这允许我在发布时将发布的值挂钩回我的动态结构化模型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T04:39:17.190

根据您之前的问题，您的问题似乎并不那么复杂。你让它变得比它必须要困难得多。您所需要的只是一个如下所示的简单模型：

```
public class Container {
    public List<Container> Containers {get;set;}
    public Question Question {get;set;}
}

public class Question {
    public List<Answer> Answers {get;set;}
} 
```

只是在这里猜测，一个答案可能不能包含任何东西，所以它需要自己的对象，一个问题只能包含答案。如果一个问题可以包含其他问题或容器，那么您可以稍微修改一下以使其正常工作。

这些都不需要特殊的模型粘合剂。

您不需要从单个基中继承所有对象，也不需要使用奇怪的模板选择器。

您可以通过执行以下操作来做到这一点：

EditorTemplates/Container.cshtml

```
@model Container

@Html.EditorFor(m => m.Containers)
@Html.EditorFor(m => m.Question) 
```

EditorTemplates/Question.cshtml

```
@model Question

@Html.EditorFor(m => m.Answers) 
```

EditorTemplates/Answer.cshtml

```
@model Answer

// whatever your answer code is.. if you have multiple answer types then you 
// need a template for each type 
```

默认的 MVC 模板系统将为您处理所有这些，并为您绑定所有内容。您只需要在将模型传递给视图之前正确地实例化您的模型。

# javascript - 谷歌地图信息窗口未从 var 加载内容

> ID：10922679
> 
> 赞同：1
> 
> 时间：2012-06-06T21:38:04.187
> 
> 标签：javascript, google-maps, google-maps-api-3

我需要帮助获取信息窗口以显示来自位置 [i] [0] 的值

位置 [i] [1] 对于地址值工作得很好，但我希望能够从 var“位置”为信息窗口中的每个标记设置自定义标题。

我可以定义一个 var 来设置内容和信息窗口以这种方式工作，但它对于每个标记都是相同的，而不是从 var“位置”中提取

任何帮助表示赞赏！

```
function initialize() {

geocoder = new google.maps.Geocoder();
var myOptions = {
zoom: 10,
center: new google.maps.LatLng(0, 0),
mapTypeId: google.maps.MapTypeId.ROADMAP
}
var map = new google.maps.Map(
document.getElementById("map_canvas"),
myOptions);
setMarkers(map, locations);
}

var locations = [
['Bondi Beach', '798 9th Ave, New York, NY', 4],
['Coogee Beach', '42 E 29th St, New York, NY', 5],
['Cronulla Beach', '56 W 25th St, New York, NY', 3],

];

function setMarkers(map, locations) {

var infowindow = new google.maps.InfoWindow();
var bounds = new google.maps.LatLngBounds();
 var marker, i; 

for (var i=0; i<=locations.length; i++) { 

   geocoder.geocode({'address': locations[i][1]}, function(results, status) { 

    marker = new google.maps.Marker({
    position: results[0].geometry.location,
    map: map,

    });

  google.maps.event.addListener(marker, 'click', (function(marker, i) {
    return function() {

      infowindow.open(map, marker);
      infowindow.setContent(locations[i][0]);
    }
  })(marker, i));

bounds.extend(marker.getPosition());

map.fitBounds(bounds);

})
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T22:48:23.950

发生的事情是单击事件侦听器正在`i = 3`使用（循环结束后 i 的最后一个值），因此由于这种未定义的状态，没有出现 InfoWindow。

因为引入了地理编码器，所以外部`for`循环在点击侦听器获得分配给它们的功能之前完成。因此，需要在地理编码之外的另一个函数范围包装器来在侦听器中保持 i 的正确值。

```
function setMarkers(map, locations) {

  var infowindow = new google.maps.InfoWindow();
  var bounds = new google.maps.LatLngBounds();
  var marker, i; 

  //CHANGED REMOVED EQUALS SIGN
  for (var i=0; i<locations.length; i++) { 

   //ADDED
   (function(i) {
   geocoder.geocode({'address': locations[i][1]}, function(results, status) { 

     marker = new google.maps.Marker({
       position: results[0].geometry.location,

      //REMOVED COMMA
       map: map
     });

     google.maps.event.addListener(marker, 'click', (function(marker, i) {
       return function() {

         //CHANGED ORDER
         infowindow.setContent(locations[i][0]);
         infowindow.open(map, marker);
       }
     })(marker, i));

     bounds.extend(marker.getPosition());
     map.fitBounds(bounds);
     });

    // ADDED
    })(i);
   }
 } 
```

# regex - 从 CKEditor 输出 html 中删除所有标签

> ID：10922683
> 
> 赞同：1
> 
> 时间：2012-06-06T21:38:46.083
> 
> 标签：regex, html-parsing, ckeditor

我在我的应用程序中使用 CKeditor。当我保存 CKEditor 输出的内容时，会添加
这样的标签。

```
<B>Summary:</B> 
<P><BR><SPAN style="TEXT-ALIGN: left; WIDOWS: 2; TEXT-TRANSFORM: none; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; LETTER-SPACING: normal; DISPLAY: inline !important; FONT: 15px/20px Helvetica, Arial, sans-serif; WHITE-SPACE: normal; ORPHANS: 2; FLOAT: none; COLOR: rgb(0,0,0); WORD-SPACING: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px">The company's latest tweet simply states that "our team continues to investigate, but at this time, we're still unable to confirm that any security breach has occurred. Stay tuned here."</SPAN></P><BR>
<P><BR>Facebook&nbsp; : <A href="http://www.facebook.com">http://www.facebook.com</A></P><BR> 
```

如何使用 javascript 中的常规表达式从上述示例中删除所有“中断”标签。

保存文本后应附加到“摘要：”，如此处

> 摘要：如果您没有收到他们的消息，请致电部门。最初的故事是在俄罗斯论坛的用户声称他入侵并上传了近 650 万后触发的。最初的故事是在俄罗斯论坛的用户声称他入侵后触发的并上传了近 650 万

但现在它是这样来的

> 概括：
> 
> 最初的故事是在俄罗斯论坛的用户声称他入侵并上传了近 650 万后触发的。最初的故事是在俄罗斯论坛的用户声称他入侵并上传了近 650 万后触发的

我正在使用 replace(/[\n\r\f]/g, ' ') ；

替换(/\<!>[\s\S]*?\<!>/ig, '')

但没用。帮帮我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T23:14:34.400

最后

> `CKEDITOR.instances.editor1.getData().replace(/(\r\n|\n|\r)/gm,"");`

非常适合我的问题。

谢谢。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T22:10:18.767

```
replace(/[\n\r\f]/g, ' ') ; 
```

将删除实际的换行符而不是编码的换行符

```
replace(/<BR>/g, '') ; 
```

或者如果您想删除所有标签

```
replace(/<[^>]*?>/g, ' ') ; 
```

# php - 如何使用 PHP、HTML、jQuery 执行实时操作

> ID：10922686
> 
> 赞同：1
> 
> 时间：2012-06-06T21:39:02.560
> 
> 标签：php, jquery, html, chat

我正在为网站开发一种聊天工具，但我无法想象如何启动它，例如，当我使用 facebook 聊天工具时，我可以看到即使我使用两种不同的浏览器，这些命令也适用于两者。如果我使用一个浏览器离线，我可以看到另一个浏览器也离线。

还有一件事，当我发送消息时，另一边的人怎么知道？

PS：我知道提到的编程语言，我只需要知道实时聊天是如何工作的（不是代码，而是想法）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T21:44:18.470

为了像 facebook 一样进行实时聊天，您的服务器需要将数据“推送”到浏览器，而 ajax 是一种“轮询”技术。

我使用[APE Push Engine](http://www.ape-project.org/)，但您也可以使用[Socket.IO](http://socket.io/)客户端和 Node.js 服务器端或[Comet](http://en.wikipedia.org/wiki/Comet_%28programming%29)。老实说，如果我可以回去的话，我会选择 Socket.IO 或 Comet 路线，因为它有更大的社区/更好的文档。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T21:48:03.177

您可以尝试使用一种名为[Comet](http://en.wikipedia.org/wiki/Comet_%28programming%29)的技术。

有一些插件将它集成到 jQuery 中，（像[这样](http://archive.plugins.jquery.com/project/Comet)？）但我只听说过它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-06T21:51:27.150

PHP 不是这项工作的正确工具。您需要在不同线程中处理不同请求的东西。我曾经使用 Node.js 来完成这种工作。请参阅**[本](http://www.stoimen.com/blog/2010/12/02/diving-into-node-js-a-long-polling-example/)**教程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T21:42:14.350

选项是：

*   在服务器上找到一个支持阻塞连接的库，然后服务器有数据时会返回答案
*   轮询
*   “旧方式”即。获得一个不断增长的无休止的文档，并使用它来流式传输数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-06T21:43:23.843

您必须在服务器上有一个主数据库和一个 PHP 脚本。您使用 jQuery 使用 AJAX 调用更新浏览器输出。

# javascript - 试图找到一种正确的方法来全局访问画布

> ID：10922688
> 
> 赞同：1
> 
> 时间：2012-06-06T21:39:11.777
> 
> 标签：javascript, jquery, html, global-variables

我对 Javascript 还是有点陌生​​，并且在我的代码中的很多地方都注意到我正在使用 JQuery 来获取对我的画布元素的引用，如下所示：

`$('#myCanvas')[0].getContext('2d');`

我怀疑它正在减慢我的网站速度，因为我在很多可能经常被调用的地方都有它。理想情况下，我只需执行一次并从任何 javascript 页面访问上下文。

我试图创建一个全局变量，但它没有工作（可能是因为它在页面加载之前运行）所以我把这个函数放在我第一个引用的 javascript 文件中的全局范围内：

```
var drawingCanvasContext;

function getDrawingCanvas() {
    if (drawingCanvasContext == null) {
        drawingCanvasContext = $('#myCanvas')[0].getContext('2d');
    }

    return drawingCanvasContext;
} 
```

因此，每当我需要代码中的画布时，我都会调用该方法..但它看起来相当..混乱。我怀疑这是一个不常见的愿望，所以我很好奇正确的解决方案。我希望它只是一个变量而不是一个函数，并且可以在没有所有这些 null 检查的情况下全局访问。有谁知道如何做到这一点？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T22:14:56.613

你可以简单地做到这一点

```
var drawingCanvasContext = $('#myCanvas')[0].getContext('2d'); 
```

而不是为此定义一个函数。

如果您小心全局范围污染，则应将其包装在函数中或使用命名空间。例如

```
var myNamespace = myNamespace || {};
myNamespace.drawingCanvasContext = $('#myCanvas')[0].getContext('2d'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T21:47:59.550

我对您的代码只有两个小改进：

```
(function(){
    // move the var out of the global context by wrapping everything in a closure
    var /* static */ drawingCanvasContext;

    function getDrawingCanvas() {
        if (!drawingCanvasContext) // no need to check for null, defaultvalue is undefined
            drawingCanvasContext = $('#myCanvas')[0].getContext('2d');
        return drawingCanvasContext;
    }

    window.getDrawingCanvas = getDrawingCanvas;
})(); 
```

当然，您可以/应该将该方法放在命名空间对象中，我猜您有不止一个这样的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T21:48:19.497

最终，您所能做的就是存储上下文以供以后检索。我在这里看到的问题可能是操作顺序，在页面准备好之前请求上下文，并且您的 VAR 声明可能正在失去范围（我认为）。

```
;(function($, window, document) {

   /* private */ var canvas = null;
   /* private */ var context = null;

   $(document).ready(function() {
      canvas = $("#myCanvas")[0];
      context = canvas.getContext('2d');
      $('body').trigger('CanvasReady', [canvas, context]); // You can fire an event to bind to with jquery for when the canvas is ready.
   });

   /* public */ window.getCanvas = function() { return canvas; };
   /* public */ window.getCanvasContext = function() { return context; };

   // You can also use a namespace here too if you want
   // window.Canvas = {};
   // window.Canvas.GetContext = ... etc ...

})(jQuery, window, document); 
```

这将在画布准备好时获取画布，当画布被找到并准备好进行操作时触发一个您可以订阅的事件。

它将全局公开 2 个函数：

`getCanvas`这将为您提供 Canvas Instance `getCanvasContext`将为您提供 Canvas Context

如果需要，您可以调整它以使用注册表模式，以便它可以获取和存储多个画布元素/上下文，但这只是向您展示的简单模式。

*注意：如果在画布/文档准备好之前调用方法，它将返回 null，无论如何，您应该在 domReady 之后执行所有设置代码。*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T22:00:34.113

您可以在全局变量上定义一个 getter，每次从该变量读取时都会执行该 getter（有关使其向后兼容的提示，请参见[此处）：](http://blogs.msdn.com/b/ie/archive/2010/09/07/transitioning-existing-code-to-the-es5-getter-setter-apis.aspx)

```
var _drawingCanvasContext;//behind the scenes variable that keeps the value
Object.defineProperty(this, "drawingCanvasContext", {
    get: function() {
        return _drawingCanvasContext || (_drawingCanvasContext = $('#myCanvas')[0].getContext('2d'));
    }
}); 
```

[这是一个小提琴](http://jsfiddle.net/briguy37/N6H7p/)，我将其设置为 'foo' 以向您展示它是如何工作的。

# svn - Subversion：如何在 Mac 上签出 Windows 存储库？

> ID：10922690
> 
> 赞同：0
> 
> 时间：2012-06-06T21:39:32.943
> 
> 标签：svn

我有一个 Windows 7 机器上的存储库，我想在我的 MacBook 上结帐。这两台机器在同一个网络上。在其他 Windows 机器上使用 TortoiseSVN 没有问题，但是，当我尝试在我的 Mac 上检查存储库时，我得到“无法打开存储库”。我的 repo URL 格式为“file://hostname/repo”。有什么建议么？

谢谢！安德鲁

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T21:58:24.773

虽然基于文件的 Subversion 存储库访问适用于 1 个用户、1 台机器，但一旦涉及多台计算机（或用户），您可能需要考虑运行 Subversion 服务器。我怀疑你的情况是 Windows 文件共享到你的 MacBook 的问题，但建议运行 Subversion 服务器来解决你的问题。

请参阅：从[Subversion 1.7 手册中](http://svnbook.red-bean.com/en/1.7/index.html)[选择服务器配置](http://svnbook.red-bean.com/en/1.7/svn.serverconfig.choosing.html)

如果您决定不这样做，请尝试在不涉及 Mac 上的 Subversion 客户端的情况下访问该文件夹，并确保其正常工作 - 我怀疑它无法检出的原因是它无法访问文件共享。

# perl - ZeroMQ，如何在不混合消息的情况下使两个套接字与一个套接字通信

> ID：10922691
> 
> 赞同：2
> 
> 时间：2012-06-06T21:39:35.100
> 
> 标签：perl, sockets, zeromq

这是我的情况：我有一个服务器，它打开一个套接字（ZMQ_DEALER）并将它与 ipc 绑定到 /tmp/server.ipc。然后我有一个外壳，它通过另一个套接字（ZMQ_DEALER）连接到服务器。shell 向服务器发送一些命令，服务器执行它们。但是，有时，某些命令是需要向服务器发送其他命令的脚本。

问题是我无法选择必须从服务器接收答案的套接字。因此，脚本会处理 shell 的消息，反之亦然。

你能帮我理解如何解决这个问题吗？我使用了错误的套接字类型吗？

我必须只使用一个插座而不是两个来解决这个问题。

如果有帮助，我正在使用 ZeroMQ 的 perl 绑定。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T17:54:50.983

感谢 ZeroMQ irc 频道上的 michelp，我找到了一个解决方案。

您可以在这里找到解决方案：

[http://zguide.zeromq.org/page:all#Router-to-Dealer-Routing](http://zguide.zeromq.org/page:all#Router-to-Dealer-Routing)

# linq - 使用 linq 根据 mongodb 中嵌入的文档值选择文档

> ID：10922692
> 
> 赞同：0
> 
> 时间：2012-06-06T21:39:37.390
> 
> 标签：linq, mongodb-.net-driver

如何根据嵌入文档中的值选择文档？例如，我有一个 r 类，它有一个 i 类的列表。我想选择所有具有 i.name=="foo" 的 r。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T06:14:21.470

如果你想选择所有`r`至少有一个`i`的，`i.Name == "foo"`可以使用这个查询：

```
var result = collectionOfRs.Where(r => r.ListOfIs.Any(i => i.Name == "foo")); 
```

如果你想选择所有`r`有**all** `i`的`i.Name == "foo"`你可以使用这个：

```
var result = collectionOfRs.Where(r => r.ListOfIs.All(i => i.Name == "foo")); 
```

# ios - iOS：使用 ARC 在 UIScrollView 中延迟加载

> ID：10922693
> 
> 赞同：0
> 
> 时间：2012-06-06T21:39:38.870
> 
> 标签：ios, uiscrollview, uiimageview, automatic-ref-counting, lazy-loading

我正在开发一个带有 ARC 的 iPad 应用程序，它必须在 UIScrollView 中显示数千个 UIImageViews ......

当我一次加载它们（或者更准确地说是在 GCD 队列中）时，加载一段时间后内存不足。

现在，我认为我必须使用延迟加载并仅加载那些必要的 UIImages 和一种释放不再可见的 UIImages，但我不知道这是否可以使用 ARC..

任何人都有这样做的想法，或者有更好的想法来处理这种情况..？

谢谢， tonistair

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T21:50:23.167

制作实现 UIScrollViewDelegate 的东西，并在其 viewDidScroll 方法中，根据 contentOffset 和边界计算当前可见的 rect。然后删除不再可见的东西，并添加刚刚变得可见的东西（或其他一些适当的算法）。ARC与此无关。

# jquery - jQuery同步动画不起作用

> ID：10922694
> 
> 赞同：0
> 
> 时间：2012-06-06T21:39:39.297
> 
> 标签：jquery, jquery-animate

我有一个包含两个`div`元素的 HTML 页面。一个是红色的，另一个是蓝色的。红色的在左上角，蓝色的在右上角。我有一个“点击我”链接，当点击它时，它应该是动画的。两个盒子都应该向下移动。它没有发生。有人能告诉我为什么吗？

```
 <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd"
    >
<html lang="en">
<head>
    <title>Test</title>
    <script src="jquery-1.7.2.min.js" type="text/javascript"></script>
    <style type="text/css">
        #box{
            background:red;
            width: 300px;
            height: 300px;
            float: left;
            position: relative;
        }
        #box1{
            background: blue;
            width: 300px;
            height:300px;
            float: right;
            position: relative;
        }

        a{
            position:absolute;
            top: 310px;
            left: 550px;
        }

    </style>
    <script type="text/javascript">
        $(function(){
            $('a').click(function(){
                $('#box').animate(function(){bottom : "0px";}, 2000);
                $('#box1').animate(function(){bottom : "0px";}, 2000);
                })
            });
    </script>
</head>
<body>
    <div id="box" ></div>
    <div id="box1"></div>
    <br>
    <a href="#">Click Me!</a>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T21:43:21.747

尝试同时为它们设置动画：

```
 $(function(){
        $('a').click(function(){
            $('#box, #box1').animate({top: "300px"}, 2000);
        });
    }); 
```

`bottom: 0px`当没有尺寸时，你什么也不做`<body>`

我改变了它来移动盒子的高度。

演示：http: [//jsfiddle.net/maniator/fjVpZ/](http://jsfiddle.net/maniator/fjVpZ/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T22:03:51.933

你的语法是错误的。我想你是这个意思。

```
function(){
    return { bottom: "0px" };
} 
```

不是

```
function(){
    bottom: "0px";
} 
```

所以这里有一个快速修复。改变这个

```
$(function(){
    $('a').click(function(){
        $('#box').animate(function(){bottom : "0px";}, 2000);
        $('#box1').animate(function(){bottom : "0px";}, 2000);
    });
}); 
```

至：

```
$(function(){
    $('a').click(function(){
        $('#box, #box1').animate( {bottom : "0px" }, 2000);
    });
}); 
```

您还需要为 document.body 定义一个高度，以便项目可以移动。

`.animate()`api：[http ://api.jquery.com/animate/](http://api.jquery.com/animate/)

```
.animate( properties [, duration] [, easing] [, complete] ) 
```

属性是对象文字，而不是函数。例子：

```
{ body: 1 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T22:05:20.690

```
 <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd"
    >
<html lang="en">
<head>
    <title>Test</title>
    <style type="text/css">
        #box{
            background:red;
            width: 300px;
            height: 300px;
            float: left;
            position: absolute;
        }
        #box1{
            background: blue;
            width: 300px;
            height:300px;
            float: right;
            position: absolute;
            right: 0;
        }

        a{
            position:absolute;
            top: 310px;
            left: 550px;
        }

    </style>
    <script type="text/javascript">
        $(function(){
            $('a').click(function(){
                $('#box').animate({bottom : 0}, 2000);
                $('#box1').animate({bottom : 0}, 2000);
                })
            });
    </script>
</head>
<body>
    <div id="box" ></div>
    <div id="box1"></div>
    <br>
    <a href="#">Click Me!</a>

</body>
</html> 
```

在 JS 小提琴上：http: [//jsfiddle.net/xkizer/yym6s/](http://jsfiddle.net/xkizer/yym6s/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T21:42:18.610

```
$('a').click(function(){
  $('#box').animate({bottom : 0}, 2000);
  $('#box1').animate({bottom : 0}, 2000);
}) 
```

试试看。您的代码中有一些语法错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-06T22:00:58.463

```
​  $(function(){
     $('a').click(function(){     
         $('#box,#box1').animate({top:"100%"}, 2000);
    }); 
}); 
```

css（绝对代替相对）

```
#box{
        background:red;
        width: 100px;
        height: 300px;

        position: absolute;
        top:0;
    left:0;
    }
    #box1{
        background: blue;
        width: 100px;
        height:300px;

        position: absolute;
    top: 0;right:0;
    }

    a{
        position:absolute;
        top: 0;
        left: 550px;
    }​ 
```

# python - Python 静态方法，为什么？

> ID：10922700
> 
> 赞同：14
> 
> 时间：2012-06-06T21:41:02.337
> 
> 标签：python, oop, attributes, static-methods, class-method

> **可能重复：**
> [Python 中的@staticmethod 和@classmethod 有什么区别？](https://stackoverflow.com/questions/136097/what-is-the-difference-between-staticmethod-and-classmethod-in-python)

我有几个关于类中的静态方法的问题。我将从举一个例子开始。

示例一：

```
class Static:
    def __init__(self, first, last):
        self.first = first
        self.last = last
        self.age = randint(0, 50)
    def printName(self):
        return self.first + self.last
    @staticmethod
    def printInfo():
        return "Hello %s, your age is %s" % (self.first + self.last, self.age)

x = Static("Ephexeve", "M").printInfo() 
```

输出：

```
Traceback (most recent call last):
  File "/home/ephexeve/Workspace/Tests/classestest.py", line 90, in <module>
    x = Static("Ephexeve", "M").printInfo()
  File "/home/ephexeve/Workspace/Tests/classestest.py", line 88, in printInfo
    return "Hello %s, your age is %s" % (self.first + self.last, self.age)
NameError: global name 'self' is not defined 
```

示例二：

```
class Static:
    def __init__(self, first, last):
        self.first = first
        self.last = last
        self.age = randint(0, 50)
    def printName(self):
        return self.first + self.last
    @staticmethod
    def printInfo(first, last, age = randint(0, 50)):
        print "Hello %s, your age is %s" % (first + last, age)
        return

x = Static("Ephexeve", "M")
x.printInfo("Ephexeve", " M") # Looks the same, but the function is different. 
```

输出

```
Hello Ephexeve M, your age is 18 
```

我看到我不能在静态方法中调用任何 self.attribute，我只是不确定何时以及为什么使用它。在我看来，如果您创建一个带有一些属性的类，也许您以后想使用它们，并且没有一个所有属性都不可调用的静态方法。任何人都可以向我解释这个吗？Python 是我的第一个编程语言，所以如果这在 Java 中是一样的，我不知道。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-06T23:20:07.280

你想达到什么目的`staticmethod`？如果您不知道它的作用，您如何期望它解决您的问题？

或者你只是在玩，看看有什么`staticmethod`作用？[在这种情况下，阅读文档以了解它的](http://docs.python.org/library/functions.html#staticmethod)作用可能会更有效率，而不是随机应用它并试图从行为中猜测它的作用。

在任何情况下，应用于`@staticmethod`类中的函数定义都会产生“静态方法”。不幸的是，“静态”是编程中最容易混淆的重载术语之一。这意味着该方法*不依赖或改变对象的状态*。如果我`foo`在类中定义了一个静态方法，那么无论属性包含什么`Bar`，调用`bar.foo(...)`（类`bar`的某个实例在哪里`Bar`）都会做同样的事情。事实上，当我什至没有实例时，`bar`我可以直接从类中调用它！`Bar.foo(...)`

这是通过简单地不将实例传递给静态方法来实现的，因此静态方法没有`self`参数。

静态方法很少需要，但偶尔很方便。它们实际上与在类外部定义的简单函数相同，但将它们放在类中会将它们标记为与类“关联”。您通常会使用它们来计算或执行与类密切相关的事情，但实际上并不是对某个特定对象的操作。

# shell - 对非连续字段排序：POSIX 等价于 'sort +0 -1 +2'

> ID：10922701
> 
> 赞同：3
> 
> 时间：2012-06-06T21:41:02.553
> 
> 标签：shell, unix, sorting

给定文件内容：

```
1234  1  15ECS3
1234  2  MS21042
1234  1  16AS338
1235  1  0321042 
```

我需要按第 1 列、第 3 列、第 2 列进行排序，如下所示：

```
1234  1  15ECS3
1234  1  16AS338
1234  2  MS21042
1235  1  0321042 
```

我可以让它与以下不推荐使用的命令一起工作：

```
sort +0 -1 +2 file 
```

但是对于我的一生，我无法让它与 -km.n -km.n 等效项一起使用。我试过了：

```
sort -b -k1 -k3 file 
```

作为我的基线，以及大约 20 种变体，抛出所有看似相关但大多是多余的开关（绝望的迹象）。

我错过了什么？上述工作代码的 posix 版本是什么？

提前致谢。

-斯科特

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T12:05:34.050

我相信这就是您正在寻找的：

```
sort -k1,1 -k3,3 
```

# vb.net - 编辑单个插件的设置

> ID：10922703
> 
> 赞同：0
> 
> 时间：2012-06-06T21:41:14.983
> 
> 标签：vb.net

我有一个 vb.net 项目，它在运行时加载“插件”dll，以稍微不同的方式处理一些数据并返回结果。为此，所有插件都实现相同的接口，因此 GUI 不在乎插件如何到达其最终数据集，只要所有插件以相同的方式将其传递回 GUI 即可。

除了主程序选项之外，我还想设置每个插件选项。我有一个接受类型对象`System.Configuration.ApplicationSettingsBase`并在控件中显示内容的选项表单`PropertyGrid`，因此它将`My.Settings`以相同的方式显示任何对象。问题是，如何`My.Settings`从运行时加载的插件中提取对象？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T14:56:30.117

弄清楚了。我使用`My.Settings`for each 类库来保存单独的设置，并在我的插件界面中指定每个插件应该实现自己的`RaiseOptions()`方法，这将创建一个选项表单的新实例，将`My.Settings`对象推送到表单，然后显示表单`PropertyGrid`控件上的那些设置。由于插件正在调用，它被设置为使用正确的`My.Settings`对象（而不是`My.Settings`来自 GUI 的对象）。

它确实需要添加一些引用，以便类库可以正确显示表单，但 IntelliSense 非常擅长准确地指出我需要什么。

# jquery - 在 jQuery Mobile 中的新页面上自动打开模式

> ID：10922704
> 
> 赞同：0
> 
> 时间：2012-06-06T21:41:19.617
> 
> 标签：jquery, mobile, jquery-mobile

用户进入新页面后，我希望模式立即出现在页面上方。

在 jQuery Mobile 中是否有特定的方法来完成此操作？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T22:09:54.070

您可以绑定到`page-events`jQuery mobile 公开的其中之一。如果您想在每次显示页面时都显示对话框，那么您可以使用`pageshow`，或者如果您希望它仅在用户第一次查看您可以使用的页面时显示`pageinit`。以下是 jQuery Mobile 提供的完整事件列表：http: [//jquerymobile.com/demos/1.1.0/docs/api/events.html](http://jquerymobile.com/demos/1.1.0/docs/api/events.html)

`pageinit`这是为每个页面绑定到事件的快速示例：

```
$(document).delegate('[data-role="page"]', 'pageinit', function () {
    //now call the code to show the dialog
}); 
```

我之所以使用`.delegate()`该页面，是因为在发生此绑定时，DOM 中可能不存在页面。

# java - 如何在 GUI 线程之间共享信息？

> ID：10922707
> 
> 赞同：1
> 
> 时间：2012-06-06T21:41:37.900
> 
> 标签：java, multithreading, swing, user-interface, eventqueue

我正在编写一个带有 GUI (Swing) 的客户端应用程序。我的两个类 ClientClass 和 MainFrame 正在运行不同的线程，但需要相互调用方法。ClientClass 在应用程序生命周期的某个时间点在 EventQueue 线程 (displayGUI()) 上实例化 GUI (MainFrame)。ClientClass 包含许多方法，例如从客户端类线程调用的 recv()，用于更新 MainFrame。反过来，MainFrame 具有由事件触发的方法，例如按下按钮调用 ClientClass 中的方法。我假设 EventQueue 线程正在调用示例中处理按钮按下的烦人方法？

我很确定这种应用程序非常普遍，我很喜欢其他人的见解。我有一种感觉，我正在做的事情不是线程安全的，那么我该如何修复/改进这个应用程序的当前模型？

示例代码：

MainFrame.java：

```
public MainFrame(ClientClass c) {
    client = c;

    // <Misc init code here>

    btnSend = new JButton("Send");
    btnSend.addMouseListener(new MouseAdapter() {
        @Override
        public void mouseClicked(MouseEvent arg0) {
            client.send("Hello!");
        }
    });
    btnSend.setBounds(171, 120, 89, 23);
    contentPane.add(btnSend);
}

public void updateElement() {
    // Update of some element here, called from ClientClass
} 
```

客户端类.java：

```
private MainFrame mainFrame;

public ClientClass() {
}

public void displayGUI() {
    final ClientClass c = this;

    EventQueue.invokeLater(new Runnable() {
        public void run() {
            try {
                mainFrame = new MainFrame(c);
                mainFrame.setVisible(true);
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
    });
}

public void send(String msg) {
    // Socket send operations here
    // Currently called by the GUI's EventQueue thread?
}

public void recv() {
    // Socket recv operations here
    mainFrame.updateElement();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T22:54:47.557

在这种特殊情况下，至强的答案可能对您更直接有用，但作为一般原则，您可能需要阅读[Singletons](http://en.wikipedia.org/wiki/Singleton_pattern)。

通过创建单个 Singleton（在您描述的情况下通常称为 Manager 或类似名称），您可以拥有一个执行与您的应用程序相关的“工作”的类，并让 GUI 线程发送该单身人士的任务。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T21:52:56.920

您可以使用`SwingUtilities`在 EDT 上调用代码（在 UI 线程上）。

在 UI 线程上调用鼠标单击 - 因此您应该`send`在后台调用（如果需要很长时间，不要阻塞 UI）。

在您的方法中，如果您更改 GUI 状态（JLabel 文本等），`recv`您应该在 UI 线程上调用- 您可以通过以下方式执行此操作：`mainFrame.updateElement();`

```
SwingUtilities.invokeLater(new Runnable() {... // 
```

一般而言 - 您所做的任何可能影响您应该在 EDT 上执行的 GUI 元素（更改文本、无效化、添加组件等）。

以及您应该在后台执行的所有可能阻止用户界面的操作 - 生成新的`Thread`.

如果您需要阻止任何事件并等待后台 - 您可以显示模式`JDialog`（请记住，您应该将其隐藏在`finally`块中 - 以防万一）

您还应该查看[SwingWorker](http://docs.oracle.com/javase/6/docs/api/javax/swing/SwingWorker.html)类和[教程](http://java.sun.com/products/jfc/tsc/articles/threads/threads2.html#introduction_to)。

# android - How can I make this sqlite query work?

> ID：10922708
> 
> 赞同：1
> 
> 时间：2012-06-06T21:41:43.313
> 
> 标签：android, mysql, sqlite

I can't run this query in sqlite:

```
Cursor c = mDb.rawQuery(
                "SELECT count(sim1.movie_id) FROM stars_in_movies sim1 WHERE "
                        + "EXISTS ( SELECT 1 FROM stars_in_movies sim2 WHERE "
                        + "sim1.movie_id = sim2.movie_id HAVING COUNT(*) = 4) "
                        , null); 
```

This query gets all the movies in the stars_in_movies table that have four actors in them.

I get this run-time error: `SQLiteException : A group by clause is required before having`

This query runs in my Mysqln terminal, but it looks like sqlite doesn't like it. How can I change the above query to get the same results in SQLite?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T02:47:52.957

因此，您要计算`movie_id`表中有四个条目的 s 的数量。SQL 查询应该是：

```
SELECT COUNT(*) 
FROM 
(
   SELECT 1
   FROM stars_in_movies
   GROUP BY movie_id
   HAVING COUNT(*) = 4
) s_i_m 
```

# iphone - NSString with umlaute encoding

> ID：10922709
> 
> 赞同：0
> 
> 时间：2012-06-06T21:41:44.720
> 
> 标签：iphone, ios, nsstring

i have created a plist with strings. Inside the strings i have umlaute, and can't encode them to be shown correctly. my code looks like this:

```
NSString *myFile = [[NSBundle mainBundle] pathForResource:@"LevelText" ofType:@"plist"];

    strings = [[NSDictionary alloc]  initWithContentsOfFile:myFile ];
    stringkeys = [strings allKeys];
    NSEnumerator *enumerator = [strings objectEnumerator];

    while (value = [enumerator nextObject]) {
        if(![value isEqualToString:@""]){
            NSString *right = [NSString stringWithCString:value.UTF8String encoding: NSUTF8StringEncoding];

            NSLog(@"Value: %s", right.UTF8String);
        }

    } 
```

i get load the plist into a NSDictionary object and then enumerate through it. I also looked at another example on stackoverflow but it doesn't work like that. The Umlaut always is represented like that:

> anh√∂ren

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T21:50:09.260

首先，摆脱对`UTF8String`. 没有理由来回转换。

```
while (value = [enumerator nextObject]) {
    if([value length] > 0){ // A little safer approach that is a good habit to get into
        NSString *right = value;
        NSLog(@"Value: %@", right);
    }
} 
```

如果您仍然看到问题，请验证它`LevelText.plist`是 UTF8 编码的，但我怀疑上述方法可以解决问题。

# java - need help on simple Java pattern coding

> ID：10922715
> 
> 赞同：2
> 
> 时间：2012-06-06T21:42:10.647
> 
> 标签：java, for-loop

I am to make this following pattern on a for loop:

```
XXXXXXXXXX
XXXXXXXXXY
XXXXXXXXYY
XXXXXXXYYY
... 
```

..and so on

```
public class ex{
    public static void main(String[] args){
            for(int i=0;i<=10;i++){
                    System.out.println();
                    for(int j=0;j<=10;j++){
                            if(i==0){
                                    System.out.print("X");
                            }

                            if(i==1){
                                    System.out.print("X");
                                    if(j==9){
                                            System.out.print("Y");
                                    }
                            }
                    }
            }
    } 
```

} ~

I am getting extra "X" at the end for my output that I don't want. I think there is a better way to do this but can't think of a way right now

Any help guys?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T21:46:27.603

尝试在一个循环中嵌套两个循环。向上计数，然后在外循环的每次迭代中`i`继续计数：`10`

```
// 10 lines
for(int i = 10; i >= 0; i--){

    int j = 0; 

    // Print 'X's (10 - i of them)
    for(; j < i; j++)
        System.out.print("X");

    // Print 'Y's (i of them)
    for(; j < 10; j++)
        System.out.print("Y");

    System.out.println();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T21:56:44.947

矩阵的 / 对角线的条件是 i + j = n，因此左上部分为 i + j < n，右下部分为 i + j > n。

```
public static void main(String... arg) {
    int n = 10;
    for (int i = 0; i < n; i++) {
        for (int j = 0; j < n; j++) {
            if ( i + j < n) {
                System.out.print("X");
            } else {
                System.out.print("Y");
            }
        }
        System.out.println();
    }
} 
```

如果要在\对角线上分离，对角线的条件是i = j，上部分i > j，下部分i < j。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T21:46:08.407

提示：每一行的长度相同，向下的每一行只有一个少一个 X 和一个多一个 Y。

```
public class XY
{
        public static void main(String[] args)
        {
                System.out.print(xy(10,10));
        }
        public static String xy(int rows,int origRows)
        {
                return X(rows,origRows-rows)+"\n"+((rows>0)?xy(rows-1,origRows):"");
        }
        public static String X(int x,int y)
        {
                return (x>0?"X":"")+((x>0||y>0)?X(x-1,y-1):"")+(y>0?"Y":"");
        }
} 
```

嘻嘻。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T21:47:06.683

您的具体问题的答案是：

```
for(int i=0;i<=10;i++) 
```

`i<=10`应该是`i<10`，因为从 0 到 10（含）有 11 个循环。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-06T21:53:24.103

可能不是最有效的版本，但在这里：

```
public static void main(String[] args) {
    for (int i = 0; i <= 10; i++) {
        System.out.println(repeat("X", 10 - i) + repeat("Y", i));
    }
}

private static String repeat(String string, int times) {
    return new String(new char[times]).replaceAll("\0", string);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-06T22:02:17.353

这是一个递归解决方案：

```
 public class ex {
    public static final String X = "X";
    public static final String Y = "Y";

    public static void main(String[] args){
      printall(10, 0);
    }

    private static void printall(int length, int saturation){
      if (saturation > length) {
        return;
      } else {
        System.out.print(printRow(length, saturation, 0);
        printall(length, saturation + 1);
      }
    }

    private static String printrow(int length, int saturation, int position) {
      if (position > length) {
        return "";
      } else {
        return getChar(length, saturation, position) + printrow(length, saturation, position + 1);
      }
    }

    private static String getChar(int length, int saturation, int position) {
      if (length-saturation < position) {
        return Y;
      } else {
        return X;
      }
    }
  } 
```

# php - 多次循环 jQuery 表单发布

> ID：10922719
> 
> 赞同：1
> 
> 时间：2012-06-06T21:42:13.057
> 
> 标签：php, jquery, post

`<div>`我以这样的形式加载了一个外部 php 页面`$_POST`：

```
$("#tblStudents").on("click", "tr", function(e) {
    var row_id = $("td:first a.ajaxCall", this).attr("rel");
    $("#ajaxContent").show().html("<div id='wait'></div>");
    $.ajax({
        url: "/pages/editstudent.php",
        data: {
            'student_id': row_id
        },
        success: function(data) {
            $("#ajaxContent").html(data);
        }
    });
});​ 
```

现在看来，当我在里面`<div>`并提交表单时，我只能执行一次 - 然后脚本停止运行。如何编辑我的代码以允许多次？我想我需要在某个地方停止并启动一个功能，但是在哪里以及如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T07:39:27.437

```
$("#tblStudents").on("click", "tr", function(e) {
    var row_id = $("td:first a.ajaxCall", this).attr("rel");
    $("#ajaxContent").empty(); //empty first before appending to avoid append repitition 
    $.ajax({
        url: "/pages/editstudent.php",
        data: {
            'student_id': row_id
        },
        success: function(data) {
            $("#ajaxContent").append(data); //TRY TO USE OF .append() not .html() maybe 
        }
    });
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T22:07:30.517

我自己解决了。我有另一个脚本回显表单提交的状态，并且该元素有一个`fadeout(4000)`. 我只是在测试时快速提交，并且没有让淡出完成

# java - 从其他类访问变量

> ID：10922726
> 
> 赞同：0
> 
> 时间：2012-06-06T21:42:31.910
> 
> 标签：java, class, user-interface, variables

我有两节课。一类作品进行计算，而另一类作品是一个图形用户界面来呈现它们。

我的问题是 - 我已将文件路径“硬编码”到我的计算类中，但似乎无法找到使其动态的方法。由于代码比较长，所以上传了。请告诉我您是否希望我将其粘贴到此处。

界面类： http: [//pastebin.com/qNU7jVV0](http://pastebin.com/qNU7jVV0)

计算类： http: [//pastebin.com/rSGr9KL7](http://pastebin.com/rSGr9KL7)

一个简单的解决方案将非常有帮助。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T21:59:34.983

在计算类：

```
public File setFile(String filepath){
    try{
        jpegFile = new File(filepath);
    }
    catch (IOException e) {
        e.PrintStackTrace();
    }
    return jpegFile;
} 
```

现在在 GUI 中，将文件设置为给定的文件路径，只需调用`metaData.setFile("C:\mypic.jpg");`

# c++ - condition_variable 的常见用例场景

> ID：10922728
> 
> 赞同：4
> 
> 时间：2012-06-06T21:42:37.847
> 
> 标签：c++, multithreading, synchronization, c++11

条件变量可用于向其他线程发出信号表明发生了某些事情：

```
mutex m;
condition_variable cv;

thread t1([&cv]{
    // processing
    ...
    cv.notify_one();
});
...
unique_lock<std::mutex> lck(m);
cv.wait(lck); 
```

但是正如你所看到的，在我们等待被通知之前，有一个机会窗口，线程处理完成并且通知正在传递，所以我们将永远等待。

在这种情况下，一个常见的解决方案是使用标志：

```
mutex m;
condition_variable cv;
bool done = false;

thread t1([&cv,&done]{
    // processing
    ...
    done = true; 
    cv.notify_one();
});
...
unique_lock<std::mutex> lck(m);
cv.wait(lck, [&done]{return done;}); 
```

使用标志是使用 a 的常用方法`condition_variable`，还是我的解释错误？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-07T01:07:54.960

条件变量应始终与某些*条件*相关联，您应该对其进行测试：

```
    unique_lock<mutex> lck(m);
    而（！*某事*）
      cv.wait(lck);
```

在持有互斥锁的同时检查条件，这意味着互斥锁应该保护与条件关联的数据，因此您知道它在测试和等待之间不会改变。

该测试`while`不仅是`if`因为某些条件变量实现（包括基于 pthreads 的实现）可能会虚假地唤醒，即当没有人发出信号时，因此您应该在循环中检查条件并在它不正确时重新等待。有一个重载`wait`需要一个谓词，并通过等待谓词返回 true 来自动处理虚假唤醒，例如，上面的示例修改为使用检查条件的 lambda：

```
    unique_lock<mutex> lck(m);
    cv.wait(lck, [&] { return *something* ; });
```

（在简单的情况下，我发现显式`while`循环更容易阅读。）

正在使用的条件变量可以被认为是由条件变量、互斥体和谓词组成的 3 元组，它们在概念上通过一起用于等待条件变量而绑定在一起。对特定条件变量对象的所有并发等待必须使用相同的互斥锁，并且通常也会等待相同的谓词（或依赖于相同数据的相关谓词，受相同的互斥锁保护。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T22:15:49.327

通常`condition_variable`在一个线程检测到它无法继续并决定等待某个*条件*（在英语意义上）满足的情况下使用变量。它`condition_variable`本身不是通知线程应该继续的主要机制，而是如果任何线程正在等待它应该重新检查，因为状态可能已经改变并且现在可以继续。

最简单的示例之一是生产者/消费者队列，其中消费者的代码如下：

```
void consume() {
   empty.wait( [&] { return !queue.empty(); } );
   // extract data from the queue and consume it here
} 
```

也就是说，线程不只是等待`condition_variable`变量，而是等待对象的状态使得线程可以继续。类似地，通知 a`condition_variable`并不是告诉另一个线程继续，只是通知任何等待满足*条件*的线程重新测试，因为状态可能已经改变。

回到你的用例，如果你的线程需要满足的*条件*`done`是另一个线程是，那么使用这样的标志是非常好的。

# .htaccess - htaccess ReWriteRule 到新域

> ID：10922729
> 
> 赞同：0
> 
> 时间：2012-06-06T21:42:40.153
> 
> 标签：.htaccess

为 .htaccess 文件编写一些正则表达式。下半场工作，但上半场让我发疯。任何正则表达式大师想伸出援助之手？

```
<IfModule mod_rewrite.c>
Options +FollowSymLinks 
RewriteEngine on
RewriteRule (*./) www.domain1.com/ [R=301,L] # This is not working
RewriteRule (.*) $1.domain2.com/ [R=301,L] # This is working
</IfModule> 
```

我想要的是所有网址，例如：www。测试 .com/example 以转到示例。domain2 .com/ （这部分正在工作）。

但我也想要www的主要网址。测试 .com/ 以访问 www。domain1 .com/ （这部分不起作用）。

我知道它就在我面前，但这是漫长的一天，我脑子里放了个屁）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T21:55:08.457

它看起来像第一个正则表达式，搜索 (*./) 已关闭。我认为应该是 (.*/)。

像这样的东西

`RewriteRule ^(.*)$ http://www.new-domain.com/$1 [R=301,L]`

应该将请求重定向到新域。

有关更多信息，我会查看此站点以获取 htaccess 帮助[http://perishablepress.com/stupid-htaccess-tricks/#redirects](http://perishablepress.com/stupid-htaccess-tricks/#redirects)以及此[http://rubular.com/的快速正则表达式测试使用](http://rubular.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T21:55:47.443

尝试用这个替换你的规则：

```
RewriteRule ^$ www.domain1.com/ [R=301,L]
RewriteCond %{HTTP_HOST} .*
RewriteRule ^(.+)$ http://$1.domain2.com/ [R=301,L] 
```

# linux - 更改 Xubuntu 以将自己报告为 Ubuntu

> ID：10922730
> 
> 赞同：0
> 
> 时间：2012-06-06T21:42:41.493
> 
> 标签：linux, ubuntu, xubuntu

我有一个想要用来运行商业程序的 Xubuntu 12.04 安装。商业程序在启动时运行一个脚本来检查分发。如果它像 Ubuntu 一样受支持，那么没问题，但如果它看到 Xubuntu，它就会抱怨该平台。有没有办法让 Xubuntu 将自己报告为 Ubuntu？

```
linux_dist () {
   _dist=`lsb_release -d 2> /dev/null | sed 's!^[^:]*: *!!'` 
   if [ -z "$_dist" ]; then
     if [ -f /etc/SuSE-release ]; then
       _dist=`head -n 1 /etc/SuSE-release`
     elif [ -f /etc/issue ]; then
       _dist=`head -n 1 /etc/issue`
     else
       _dist=`cat /proc/version | sed -e 's/^.*(\([^()]*Linux[^()]*\)).*$/\1/'`
     fi
   fi
   if [ -z "$_dist" ]; then _dist='unknown' ; fi
   echo $_dist
} 
```

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T06:46:33.500

简单的解决方案：

```
sudo sed -i "s/Xubuntu/Ubuntu/g" /etc/lsb-release 
```

玩得开心 ;）

# iis - Azure 启动任务 Appcmd 来配置我的站点

> ID：10922733
> 
> 赞同：1
> 
> 时间：2012-06-06T21:42:59.773
> 
> 标签：iis, azure, startup, appcmd

我有一个 azure 站点正在运行，我想解决臭名昭著的应用程序池重启预热问题。似乎 MS 已经发布了应用程序初始化 IIS。

所以我必须执行以下操作 1\. 安装应用程序初始化 2\. 进行此处提到的一些配置更改[http://learn.iis.net/page.aspx/1089/iis-80-application-initialization/](http://learn.iis.net/page.aspx/1089/iis-80-application-initialization/)

a) 在 %WINDIR%\system32\inetsrv\config\applicationhost.config 文件的应用程序池部分

b) 在 %WINDIR%\system32\inetsrv\config\applicationhost.config 文件的站点部分 ... ....

我的问题是，如何编写 Appcmd 脚本来解决 2\. b）将**preloadEnabled="true"**添加到正确的位置，因为我需要做 1）找到根站点，因为我不知道站点名称，也不知道站点 ID。2) 将**preloadEnabled="true"** 属性添加到我在步骤 2) 中找到的根站点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T14:06:59.820

再加上大卫重置空闲超时的答案，您还可以通过使用以下作为启动任务来完全防止应用程序池回收：

```
%windir%\system32\inetsrv\appcmd set config -section:applicationPools -applicationPoolDefaults.recycling.periodicRestart.time:00:00:00 
```

您还需要设置另外两件事：`startMode`和`preloadEnabled`.

对于`startMode`，您可以将其添加到您为上述代码创建的启动任务中：

```
%windir%\system32\inetsrv\appcmd set config -section:applicationPools -applicationPoolDefaults.startMode:AlwaysRunning 
```

对于`preloadEnabled`，您可以按照 Alex 所说的去做，并在您的启动任务中执行此操作：

```
appcmd set app "websitename/vdirname" /preloadEnabled:true 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T17:41:34.873

If you are looking to configure the site/application pool using an AppCmd startup task, check out my recent post about this:

[http://mvolo.com/configure-iis-websites-windows-azure-startup-tasks-appcmd/](http://mvolo.com/configure-iis-websites-windows-azure-startup-tasks-appcmd/)

This covers how to find the site/application pool to edit, and also how to run the task AFTER the site/apppool configuration is created and not before.

We are actually enabling application warmup via serviceAutoStartProviders using this approach, I will blog about the configuration tool we use / issues we solved in a later post.

If you need help with that now, send me an email.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-03T22:37:57.443

我知道这是一个老问题，但希望能回答这部分：

> 如何编写 Appcmd 脚本来解决 2\. b) 将 preloadEnabled="true" 添加到正确的位置，因为我需要这样做

使用`appcmd`：

```
appcmd set app "websitename/vdirname" /preloadEnabled:true 
```

问候亚历克斯

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T21:46:53.190

就避免重新启动而言，将此命令添加到您的启动脚本中：

```
%windir%\system32\inetsrv\appcmd set config -section:applicationPools -applicationPoolDefaults.processModel.idleTimeout:00:00:00 
```

不确定您的预加载问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-07T02:55:04.663

[http://blogs.msdn.com/b/tom/archive/2011/02/18/installing-and-using-an-httpmodule-in-windows-azure.aspx](http://blogs.msdn.com/b/tom/archive/2011/02/18/installing-and-using-an-httpmodule-in-windows-azure.aspx)上有一个示例。本质上，您需要将 executionContext 设置为提升，以便您的 Web 角色的入口点（但不是 ASP.NET 应用程序）将在管理员权限下运行。在入口点内，您可以使用 IIS 管理 API 来配置预热模块。

# jquery - 为什么我的表单被处理为 HTML 请求而不是 JS？

> ID：10922737
> 
> 赞同：0
> 
> 时间：2012-06-06T21:43:20.613
> 
> 标签：jquery, ruby-on-rails

我正在 Rails 3.0.3 上开发并使用 jQuery。这是我的 javascipt 包含标签：

```
<%= javascript_include_tag "http://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js", "rails.js" %> 
```

我想在更改下拉列表时发送 JS 请求并编写以下代码来执行此操作。此表单不会作为 JS 处理，而是作为 HTML 请求处理：

```
<% form_tag(aggregatedata_path, :method=>'post', :id => "dd-container", :remote => true ) do %>
    <%= select_tag( 
        :group, 
        options_for_select(groups_list, @group), 
        {
            :id => "dd", 
            :onchange => "this.form.submit();"
        } ) %>
<% end %> 
```

我在 SO 上阅读了一篇类似的帖子，该帖子表明问题出在 js 库上，但除非没有其他办法，否则我宁愿避免在这一点上改变这一点，以免一百万其他事情中断。我有另一种形式作为 JS 请求处理就好了。这里是：

```
<% form_tag(poweroutput_path, :method=>'post', :id => "date-form", :remote => true ) do %>
    <%= text_field_tag(
        'dt', nil,
        {  
            :id => 'date-field',
            :class => 'dateformat-d-dt-m-dt-Y',
            :value => Time.now.getlocal.strftime("%d.%m.%Y")             
        }) %>
    <%= submit_tag " ", :id => "go-button" %>
<% end %> 
```

我看到的唯一明显区别是第一个使用`:onchange => "this.form.submit();"`，而第二个没有。该函数中是否有某些内容覆盖了我之前的内容`:remote => true`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T22:27:37.123

当我搜索“Rails 3 远程表单”时，我得到的第一个点击就是这个链接：

[http://www.alfajango.com/blog/rails-3-remote-links-and-forms/](http://www.alfajango.com/blog/rails-3-remote-links-and-forms/)

它在第一组要点中解释了它，讨论了什么`:remote => true`：

> 1.  它找到远程链接、表单和输入，并覆盖它们的点击事件以通过 AJAX 提交给服务器。

由于您是手动提交表单，我认为任何点击处理程序都被绕过了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T22:39:16.310

我同意戴夫。既然你已经在使用 jQuery，我会选择这样的：

```
$('#dd-container').change(function(){
  $.ajax({
    type: "POST",
    url: your_path,
    data: $(this).find('option:selected').attr('value'),
    success: function( response ) {
      console.log( response );
    }
  });
}); 
```

哦，别忘了从表单中删除`:onchange => "this.form.submit();"`and 。`, :remote => true`

# c++ - Solaris 10 -- 从 recvmsg() 的 UDP 多播数据包中获取 IP 源地址

> ID：10922740
> 
> 赞同：2
> 
> 时间：2012-06-06T21:43:30.543
> 
> 标签：c++, c, sockets, solaris

我有创建 UDP 套接字来接收多播数据包的项目代码。该代码可移植到 Linux 和 Solaris 操作系统。我的项目的一个扩展是在使用 recvmsg() 函数时检索 UDP 数据包的源 IP 地址。我曾就此事询问过一位专家，她提到 Linux 似乎能够提供源 IP 地址，但 Solaris 在使用 recvmsg() 函数时可能无法提供。所以我在这里提出问题，我能否在 Solaris 10 上使用 recvmsg() 检索源 IP 地址？

操作系统：Solaris 10、Sunstudio 12 cc（无 U1 或 U2）。代码库：C/C++

```
//Socket initially opened with the following options from a different function.
// This connects the socket to receive multicast:
setsockopt(data->fd, IPPROTO_IP, IP_ADD_SOURCE_MEMBERSHIP,
    (char *)&mregs, sizeof(mregs) ) < 0)

//A different function performs an infinite loop reading from the socket:

struct iovec vector;
vector.iov_base = buf;     //passed in param
vector.iov_len = len;      //passed in param
struct msghdr msg;
char    caddr[100] ;
msg.msg_name =  caddr;
msg.msg_namelen = 100;
msg.msg_iov = &vector;
msg.msg_iovlen = 1;
int flags = 0;

char controlBuffer[1024];
msg.msg_control = controlBuffer;
msg.msg_controllen = 1024;

bytes = ::recvmsg(data->fd, &msg, flags);

//removed error checking    

struct cmsghdr *cmsg;
struct in_pktinfo *dest_ip_ptr;
rrcp_u32_t dest_ip = 0;
cmsg = CMSG_FIRSTHDR(&msg);
for ( cmsg = CMSG_FIRSTHDR(&msg);
    cmsg != NULL;
    cmsg = CMSG_NXTHDR( &msg, cmsg ) )
{
    //if ( cmsg->cmsg_type == IPPROTO_IP && cmsg->cmsg_level == IP_PKTINFO )
    {
#ifdef Linux
        struct in_pktinfo *dest_ip_ptr = (struct in_pktinfo*)CMSG_DATA(cmsg);
        dest_ip = dest_ip_ptr->ipi_addr.s_addr;
#else
        //in_addr only has 1 address
        struct in_addr * dest_ip_ptr = (struct in_addr *)CMSG_DATA(cmsg);
        dest_ip = dest_ip_ptr->_S_un._S_addr;
#endif
    }
}
if( ipaddr ) 
    ipaddr->IP = dest_ip;

//according to the Linux article mentioned below, the caddr should have the source
//socket address.  In my case, the caddr field is not filled with any coherent data,
//so this does not seem to be the source address.  Then again, "source socket" could
//be the interface IP on the local machine, which isn't what I need. 
```

我也看到了以下文章，但他们似乎没有回答我的问题： [Get destination address of a received UDP packet](https://stackoverflow.com/questions/5281409/get-destination-address-of-a-received-udp-packet)，解决方案在：[Get destination address of a received UDP packet](https://stackoverflow.com/questions/5281409/get-destination-address-of-a-received-udp-packet/5309155#5309155)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T05:16:57.863

有两个问题：一是你没有`caddr`在任何地方使用，你也不说它是什么，所以很难帮助你；另一个（可能是您遇到的问题）是您从中获得的地址`recvmsg`不是*字符串*。

`msg.msg_name`应该指向 a`struct sockaddr_in`并且`msg.msg_namelen`应该`sizeof(struct sockaddr_in)`。然后，您可以从中获取地址。

# vim - Vim73 没有选择任何颜色，包括方案

> ID：10922750
> 
> 赞同：-1
> 
> 时间：2012-06-06T21:44:18.620
> 
> 标签：vim, putty, color-scheme

在过去的 6 个月里，我一直在 Windows 机器上通过 Putty 使用 Vim，一切都很好。在看到有人使用具有惊人色彩的新文本编辑器后，我决定冒险走色彩方案的道路。这工作了大约 24 小时，然后我决定我想添加一堆插件，这需要我重新编译我的 VIM。这样做之后（使用 vim73），我不再可以在我的 vim 中获得任何颜色。它是黑白相间的，背景是雾蒙蒙的。我的 .vimrc 文件没有改变，我使用的配色方案 zenburn 也没有改变。

我没有收到任何错误，只是颜色不起作用。

我做了一个

```
strace -o vim_strace vim 
```

确保我的 .vimrc 文件正在加载但仍然没有。我想知道我是否有一些遗留文件实际上是在事后读取并覆盖我想要的颜色。

对这个有什么想法？？？几乎陷入无路可走。

更新信息：@epsilonhalbe：我使用了这个版本的 VIM 和配置选项：

```
hg clone https://vim.googlecode.com/hg/ vim
./configure --enable-rubyinterp
make 
```

这杀死了我的颜色。我在配置文件中找不到“颜色”选项。

@kev：我尝试运行 colors:zenburn ，但它什么也没做，但是，尝试另一种方案，如 color:desert 实际上确实改变了颜色，但是，一切仍然是黑白的，只是各种色调。就像我使用黑白而不是颜色一样，但它似乎正在阅读和应用场景，只是不正确。

我的 .vimrc 文件位于 -> ~/.vimrc

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T16:07:29.057

非常感谢所有的帮助，但我想通了。看起来当我再次编译时，语法的默认功能已关闭。

我所要做的就是添加：

```
:syntax on 
```

到我的 .vimrc 文件，我又开始行动了。

再次感谢！！

# c++ - 计算程序形状的法线

> ID：10922752
> 
> 赞同：-1
> 
> 时间：2012-06-06T21:44:31.673
> 
> 标签：c++, opengl, geometry

给定下面的代码。取自[http://pastie.org/pastes/764327/text](http://pastie.org/pastes/764327/text)

```
 void CreateSphere(int PointRows, int PointsPerRow)
{
    NumVertices = (PointRows-2)*PointsPerRow + 2;
    Vertices = new SVertex[NumVertices];
    IndexVect.clear();  //to be sure it is empty
    float x,y,z;
    int i,j;
    double r;
    for (i = 1; i < (PointRows-1); i++)
    {
        for (j = 0; j < PointsPerRow; j++)
        {
            y = 1.0 - float(i) / float(PointRows-1)*2.0;
            r = sin (acos(y));  //radius of the row
            x = r * sin(float(j) / float(PointsPerRow)*PI*2.0);     
            z = r * cos(float(j) / float(PointsPerRow)*PI*2.0);
        Vertices[(i-1)*PointsPerRow+j].x = x;
        Vertices[(i-1)*PointsPerRow+j].y = y;
        Vertices[(i-1)*PointsPerRow+j].z = z;
        Vertices[(i-1)*PointsPerRow+j].r = (float)(i) / float(PointRows);
        Vertices[(i-1)*PointsPerRow+j].g = 0.7;
        Vertices[(i-1)*PointsPerRow+j].b = (float)(j) / float(PointsPerRow);
    }

}
//The highest and deepest vertices:
Vertices[(PointRows-2)*PointsPerRow].x = 0.0;
Vertices[(PointRows-2)*PointsPerRow].y = 1.0;
Vertices[(PointRows-2)*PointsPerRow].z = 0.0;
Vertices[(PointRows-2)*PointsPerRow].r = 1.0;
Vertices[(PointRows-2)*PointsPerRow].g = 0.7;
Vertices[(PointRows-2)*PointsPerRow].b = 1.0;
Vertices[(PointRows-2)*PointsPerRow+1].x = 0.0;
Vertices[(PointRows-2)*PointsPerRow+1].y = -1.0;
Vertices[(PointRows-2)*PointsPerRow+1].z = 0.0;
Vertices[(PointRows-2)*PointsPerRow+1].r = 1.0;
Vertices[(PointRows-2)*PointsPerRow+1].g = 0.7;
Vertices[(PointRows-2)*PointsPerRow+1].b = 1.0;

for (i = 1; i < (PointRows-2); i++)
{
    for (j = 0; j < (PointsPerRow-1); j++)
    {
        IndexVect.push_back((i-1)*PointsPerRow+j);
        IndexVect.push_back((i-1)*PointsPerRow+j+1);
        IndexVect.push_back((i)*PointsPerRow+j);

        IndexVect.push_back((i-1)*PointsPerRow+j+1);
        IndexVect.push_back((i)*PointsPerRow+j+1);
        IndexVect.push_back((i)*PointsPerRow+j);
    }

    IndexVect.push_back((i-1)*PointsPerRow+PointsPerRow-1);
    IndexVect.push_back((i-1)*PointsPerRow);
    IndexVect.push_back((i)*PointsPerRow+j);

    IndexVect.push_back((i)*PointsPerRow);
    IndexVect.push_back((i-1)*PointsPerRow);
    IndexVect.push_back((i)*PointsPerRow+j);
}       

//The triangles to the highest and deepest vertices:
for (j = 0; j< (PointsPerRow-1); j++)
{
    IndexVect.push_back(j);
    IndexVect.push_back(j+1);
    IndexVect.push_back((PointRows-2)*PointsPerRow);
}
IndexVect.push_back(j);
IndexVect.push_back(0);
IndexVect.push_back((PointRows-2)*PointsPerRow);

for (j = 0; j< (PointsPerRow-1); j++)
{
    IndexVect.push_back((PointRows-3)*PointsPerRow+j);
    IndexVect.push_back((PointRows-3)*PointsPerRow+j+1);
    IndexVect.push_back((PointRows-2)*PointsPerRow+1);
}
IndexVect.push_back((PointRows-3)*PointsPerRow+j);
IndexVect.push_back((PointRows-3)*PointsPerRow);
IndexVect.push_back((PointRows-2)*PointsPerRow+1);
Indices = new GLuint[IndexVect.size()];  //allocate the required memory
for (i = 0; i < IndexVect.size(); i++)
{
    Indices[i] = IndexVect[i];
}
NumIndices = IndexVect.size();
IndexVect.clear();  //no longer needed, takes only memory 
```

}

您将如何使用结果顶点计算法线......？

然后我希望使用 glEnableClientState(GL_NORMAL_ARRAY) 和 glNormalPointer(GL_FLOAT,0, Normals) 以及 glDrawElements 将结果索引与法线一起绘制。

我试过了，但它看起来不对。灯光出现在球体的左侧，而不是下方。

道歉。我在这里没有给出完整的图片。基本上，我试图通过在数据中输入噪声来生成随机形状。

如果我在第一个嵌套循环的末尾使用以下代码：

```
Normals[(i-1)*PointsPerRow+j].x = x;
Normals[(i-1)*PointsPerRow+j].y = y;
Normals[(i-1)*PointsPerRow+j].z = z; 
```

我能够为球体生成正确的法线，一切看起来都很好。

但是，如果我这样做：

```
x=x+(noise3(x,y,z));
y=y+(noise3(x,y,z));
z=z+(noise3(x,y,z)); 
```

然后尝试使用：

```
Normals[(i-1)*PointsPerRow+j].x = x;
Normals[(i-1)*PointsPerRow+j].y = y;
Normals[(i-1)*PointsPerRow+j].z = z; 
```

某些面孔的法线看起来是错误的。一旦创建了完整的形状，我想遍历结果索引，然后计算每个点的法线，如果这有任何意义的话....？

好的，这就是我得到的。它似乎不起作用。它可能完全错误，所以放轻松。

```
 for (j = 0; j < NumIndices-2; j=j+3)
   {

Ax = Vertices[Indices[j]].x;    Bx = Vertices[Indices[j+1]].x;   Cx = Vertices[Indices[j+2]].x;
Ay = Vertices[Indices[j]].y;   By = Vertices[Indices[j+1]].y;   Cy = Vertices[Indices[j+2]].y;
Az = Vertices[Indices[j]].z;   Bz = Vertices[Indices[j+1]].z;   Cz = Vertices[Indices[j+2]].z;

dms::Vector3 p1(Ax,Ay,Az);
dms::Vector3 p2(Bx,By,Bz);
dms::Vector3 p3(Cx,Cy,Cz);
dms::Vector3 V1= (p2 - p1);
dms::Vector3 V2 = (p3 - p1);
dms::Vector3 normal = V1.cross(V2);

Normals[j].x = normal[0];
Normals[j].y = normal[1];
Normals[j].z = normal[2];;

Normals[j+1].x = normal[0];
Normals[j+1].y = normal[1];
Normals[j+1].z = normal[2];;

Normals[j+2].x = normal[0];
Normals[j+2].y = normal[1];
Normals[j+2].z = normal[2];; 
```

}

编辑 - -

通过重新安排计算 2 个向量的部分，我能够获得更好的结果。我更改了以下内容：

```
dms::Vector3 V1= (p2 - p1);
dms::Vector3 V2 = (p3 - p1); 
```

到：

```
dms::Vector3 V1= (p2 - p1);
dms::Vector3 V2 = (p1 - p3); 
```

但是看起来还是不太对劲，球体的前面有一条黑色的条带，球体的顶部看起来很奇怪。

非常感谢 Kaganar 的出色回答，我将努力解决我剩下的问题。也非常感谢巴特！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T13:33:14.293

根据评论，这是一个可能的答案：

*   第 1 步：将所有顶点法线设置为零向量。
*   第二步：计算每个三角形的法线，并将其加到每个三角形的所有顶点上。
*   第 3 步：归一化所有顶点法线。

关于您在撰写此答案时发布的代码：

*   目前尚不清楚法线是否被初始化为零向量。
*   您正在分配，而不是将法线添加到顶点法线。（所以第 2 步不能正常工作。）此外，您添加到顶点法线的法线本身并未标准化。（叉积不会自动标准化——您必须标准化叉积的结果。）
*   您根本没有执行第 3 步。

进一步注意：当您进行规范化时，请注意传递给规范化函数的接近零长度的向量，尤其是在您使用嘈杂生成的形状时。由于归一化只是划分向量长度的分量，因此通常在进行您通常期望的除法之前检查该长度是否接近于零。如果它接近于零，则这种归一化函数的输出通常只是向上向量（因为在大多数着色模型中，零向量会导致虚假的暗结果。）

# asp.net - 使用服务器路径在远程服务器上复制文件时出错

> ID：10922753
> 
> 赞同：0
> 
> 时间：2012-06-06T21:44:41.340
> 
> 标签：asp.net, vb.net

我正在尝试将上传文件复制到远程服务器，但出现异常。复制一个 100kb 的文件需要 5 分钟。

```
System.Threading.ThreadAbortException: Thread was being aborted.
   at Microsoft.Win32.Win32Native.CreateFile(String lpFileName, Int32 dwDesiredAccess, FileShare dwShareMode, SECURITY_ATTRIBUTES securityAttrs, FileMode dwCreationDisposition, Int32 dwFlagsAndAttributes, IntPtr hTemplateFile)
   at Microsoft.Win32.Win32Native.SafeCreateFile(String lpFileName, Int32 dwDesiredAccess, FileShare dwShareMode, SECURITY_ATTRIBUTES securityAttrs, FileMode dwCreationDisposition, Int32 dwFlagsAndAttributes, IntPtr hTemplateFile)
   at System.IO.FileStream.Init(String path, FileMode mode, FileAccess access, Int32 rights, Boolean useRights, FileShare share, Int32 bufferSize, FileOptions options, SECURITY_ATTRIBUTES secAttrs, String msgPath, Boolean bFromProxy)
   at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize, FileOptions options, String msgPath, Boolean bFromProxy)
   at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share)
   at System.Net.Mail.AttachmentBase.SetContentFromFile(String fileName, String mediaType)
   at System.Net.Mail.Attachment..ctor(String fileName)
   at AFI.WarrantyClaim.SendConfirmationMail(String sClaimID, String sRecepient, Boolean bIsCust, ArrayList alUploadedFiles)
   at AFI.WarrantyClaim.btnNext_Click(Object sender, EventArgs e) 
```

导致此问题的代码：

```
For i As Integer = 0 To Request.Files.Count - 1
            Dim hpfFile As HttpPostedFile = Request.Files(i)

            If hpfFile.ContentLength > 0 Then
                Dim sFileExtention As String = System.IO.Path.GetExtension(hpfFile.FileName)
                Dim sFileName As String = String.Empty

                sFileName = sClaimNo + "_" + System.IO.Path.GetFileNameWithoutExtension(hpfFile.FileName) + "_" + iPhoto.ToString() + _
                            sFileExtention

                Dim sScopeIdentity As String = SaveImageData(Convert.ToInt32(sClaimNo), Convert.ToString(iPhoto), sFileName)
                hpfFile.SaveAs(ConfigurationManager.AppSettings(m_sUPLOADED_FILE_PATH) + sFileName)

               iPhoto = iPhoto + 1
            End If
        Next 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T03:35:38.450

看起来操作正在超时....检查您 PC 上的防火墙设置，或检查远程服务器上的日志。

# python - 另一种 Python 进程技术的 Python 看门狗？

> ID：10922754
> 
> 赞同：1
> 
> 时间：2012-06-06T21:44:53.810
> 
> 标签：python, monitor, watchdog

我有一个无限期运行的实时数据采集器，通过 HTTP 采集数据并每隔几秒将其放入 MySQL 数据库。

在我的程序中，我有一个 while True 循环，只要上次生成时间大于 X 秒，就会生成工作人员（下载数据并保存数据的函数）：

```
while True:
    if _last_updated - datetime.now() > timedelta(seconds=5):
        green_pool.spawn_n(worker) # yes I'm using Eventlet!
        _last_updated = datetime.now() 
```

确保该模块始终正常工作、永不冻结且永不停机的最佳方法是什么？我应该检查绿色游泳池的大小吗？我正在考虑用 Python 为它写一个看门狗，你会推荐这样做吗？如果是这样，我应该记住什么？

最好的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T22:01:09.880

这可能有点矫枉过正，但我​​会考虑使用[supervisord](http://supervisord.org/)。这是一个控制其他进程的进程（有点像init.d）。它将允许您启动/停止/重新启动包含`while True:`循环的控制脚本。如果它停止工作，它还将自动重新启动控制脚本。

正如您所提到的，您应该在控制脚本中密切关注池大小和工人产卵的成功/失败。但是为了确保控制脚本始终运行，supervisord 符合要求。

# git - 从 git 存储库中提取作者信息

> ID：10922759
> 
> 赞同：2
> 
> 时间：2012-06-06T21:45:09.000
> 
> 标签：git, repository, author

我正在尝试从 git 存储库中提取（源代码行，作者标签）对。最简单的方法是使用 git blame。问题是 git blame 将最后一个提交者作为作者，无论提交者只是缩进代码还是真正更改代码。你知道更好的方法吗？

或者也许在尝试解决问题之前，我应该首先检查有多少源代码行与多个作者相关联。如果百分比很小，则无需担心。但我发现即使是数数也很困难。对于具有单亲的提交，我们如何知道提交更改了一行而不是删除了一行并添加了一行？对于有两个父母的提交（如合并），我应该如何结合两个分支的差异结果？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T23:16:14.393

### 概述

这是对 Git 工作原理的根本误解。Git 不提交补丁或差异；它提交树和 blob，尽管[包文件](http://git-scm.com/book/en/Git-Internals-Packfiles)肯定会进行某种分类。大多数提交历史是在运行时*计算*的，带有一些差异。

换句话说，如果你的差异工具可以做你想做的事，那么 Git 也可以。

### 混帐责备

git-blame 命令不会做你想做的事，因为手册页说（强调我的）：

> 使用上次修改该行的修订版中的信息注释给定文件中的**每一行。**

换句话说，它是严格面向行的。

### 混帐日志

你可以使用 git-log 接近你想要的。例如：

```
# Show diffs with indifference to whitespace changes (e.g. indenting).
git log --patch --ignore-space-change

# Just ignore whitespace altogether.
git log --patch --ignore-all-space

# Show deletions with [- -] and additions with {+ +}.
git log --patch --word-diff=plain

# Custom diff format where ~ denotes newlines.
git log --patch --word-diff=porcelain 
```

瓷器格式旨在用于文本处理，但从视觉角度来看它非常不直观。但是，`man 1 git-diff`为了您的编程乐趣，它已被详细记录。

缺点是您必须从与每个提交关联的 GIT_AUTHOR_NAME 或 GIT_COMMITTER_NAME 获取作者信息，而不是让 Git 为您装饰它。

# android - 在手机版android中打开google play store的链接

> ID：10922762
> 
> 赞同：88
> 
> 时间：2012-06-06T21:45:39.707
> 
> 标签：android, google-play

我在我最新的应用程序中有我的其他应用程序的链接，我以这种方式打开它们。

```
Uri uri = Uri.parse("url");
Intent intent = new Intent (Intent.ACTION_VIEW, uri); 
startActivity(intent); 
```

此代码打开谷歌播放商店的浏览器版本。

尝试从手机打开时，手机会提示我是要使用浏览器还是 google play，如果我选择第二个，它会打开手机版的 google play store。

你能告诉我这怎么会同时发生？我的意思是不问我，而是直接打开手机版的google play，我直接从手机打开它时看到的那个。

* * *

## 回答 #1

> 赞同：265
> 
> 时间：2012-06-06T21:59:18.660

您将要使用指定的`market`协议：

```
final String appPackageName = "com.example"; // Can also use getPackageName(), as below
startActivity(new Intent(Intent.ACTION_VIEW, Uri.parse("market://details?id=" + appPackageName))); 
```

请记住，这将在任何未安装 Market 的设备（例如模拟器）上崩溃。因此，我建议如下：

```
final String appPackageName = getPackageName(); // getPackageName() from Context or Activity object
try {
    startActivity(new Intent(Intent.ACTION_VIEW, Uri.parse("market://details?id=" + appPackageName)));
} catch (android.content.ActivityNotFoundException anfe) {
    startActivity(new Intent(Intent.ACTION_VIEW, Uri.parse("http://play.google.com/store/apps/details?id=" + appPackageName)));
} 
```

在使用[`getPackageName()`](http://developer.android.com/reference/android/content/Context.html#getPackageName())from`Context`或其子类以保持一致性时（感谢[@cprcrack](https://stackoverflow.com/users/423171/cprcrack)！）。您可以在此处找到有关市场意图的更多信息：**[链接](http://developer.android.com/guide/publishing/publishing.html#marketintent)**。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-09-12T07:19:36.770

下面的代码可以帮助您在移动版本中显示 google play sore 的应用程序链接。

申请链接：

```
Uri uri = Uri.parse("market://details?id=" + mContext.getPackageName());
Intent myAppLinkToMarket = new Intent(Intent.ACTION_VIEW, uri);

  try {
        startActivity(myAppLinkToMarket);

      } catch (ActivityNotFoundException e) {

        //the device hasn't installed Google Play
        Toast.makeText(Setting.this, "You don't have Google Play installed", Toast.LENGTH_LONG).show();
              } 
```

对于开发者链接：

```
Uri uri = Uri.parse("market://search?q=pub:" + YourDeveloperName);
Intent myAppLinkToMarket = new Intent(Intent.ACTION_VIEW, uri);

            try {

                startActivity(myAppLinkToMarket);

            } catch (ActivityNotFoundException e) {

                //the device hasn't installed Google Play
                Toast.makeText(Settings.this, "You don't have Google Play installed", Toast.LENGTH_LONG).show();

            } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-08-20T08:28:40.873

您可以使用[Android Intents](https://github.com/d-tarasov/android-intents/)库在 Google Play 中打开您的应用程序页面，如下所示：

```
Intent intent = IntentUtils.openPlayStore(getApplicationContext());
startActivity(intent); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-10-18T07:25:23.643

[d.android.com 上的文档：http://developer.android.com/distribute/googleplay/promote/linking.html](http://developer.android.com/distribute/googleplay/promote/linking.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-04-10T10:14:59.297

您可以检查是否安装了*Google Play Store*应用，如果是这样，您可以使用*“market://”*协议。

```
final String my_package_name = "........."  // <- HERE YOUR PACKAGE NAME!!
String url = "";

try {
    //Check whether Google Play store is installed or not:
    this.getPackageManager().getPackageInfo("com.android.vending", 0);

    url = "market://details?id=" + my_package_name;
} catch ( final Exception e ) {
    url = "https://play.google.com/store/apps/details?id=" + my_package_name;
}

//Open the app page in Google Play store:
final Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse(url));
intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_WHEN_TASK_RESET);
startActivity(intent); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-05-26T13:13:57.743

在 Google Play 上打开应用页面：

```
Intent intent = new Intent(Intent.ACTION_VIEW,
                Uri.parse("market://details?id=" + context.getPackageName()));
startActivity(intent); 
```

# javascript - 如何使用 Javascript 在 UL-LI 块中进行简单的 DOM 操作？

> ID：10922763
> 
> 赞同：1
> 
> 时间：2012-06-06T21:45:44.437
> 
> 标签：javascript, dom

我们在[这里](https://chat.stackoverflow.com/transcript/message/4015811#4015811)与 rlemon 就 DOM 操作进行了很长时间的交谈。基本上问题是`'How can I change the UL-LI DOM with Javascript?'`，例如，假设我想要而不是`"<ul id='uids'><li>1</li><li>2</li></ul>"`显示这样的东西`"<ul><li><i>Hello 1, have a nice day!</i></li>...</ul>"`——我怎么能用 DOM 操作来做到这一点？

我知道这是一个简单的问题，所以我对参考感到满意，而不是重新发明轮子。

> **关于 DOM 操作的简单演示，你能做这样的事情吗？**
> 
> > **输入**
> > 
> > ```
> >  <ul id="uid">
> >             <li>1</li>
> >             <li>2</li>
> >     </ul> 
> > ```
> > 
> > **输出**
> > 
> > ```
> >  <ul id="uid">
> >             <li>Hello beautful lady 1!</li>
> >             <li>Hej gentleman 2.</li>
> >     </ul> 
> > ```

> **也许对其他新手熟悉 JS 的功能特性很有用**
> 
> 1.  [https://chat.stackoverflow.com/rooms/17/conversation/learn-javascript-videos](https://chat.stackoverflow.com/rooms/17/conversation/learn-javascript-videos)
>     
>     
> 2.  [http://ejohn.org/apps/learn/](http://ejohn.org/apps/learn/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T22:17:59.553

使用innerHTML的捷径：

```
var lis = document.getElementById("uid").getElementsByTagName("li");
for(var i = 0; i < lis.length; i++)
    lis[i].innerHTML = "<i>Hello "+lis[i].innerHTML+", have a nice day!</i>"; 
```

jsFidlde：http: [//jsfiddle.net/eZv4D/3/](http://jsfiddle.net/eZv4D/3/)

很长的路要走，真正的 DOM 操作：

```
var lis = document.getElementById("uid").getElementsByTagName("li");
for(var i = 0; i < lis.length; i++) { // Loop through all <li> elements
    // Create an <i> element to contain the text
    var el = document.createElement("i");

    // Add the start of the text to the <i>
    el.appendChild(document.createTextNode("Hello "));
    // Add everything in the <li> to the <i> (they are removed from the <li>)
    while(lis[i].firstChild)
        el.appendChild(lis[i].firstChild);
    // Add the end of the text to the <li>
    el.appendChild(document.createTextNode(", have a nice day!"));

    // Add the <i> to the <li>
    lis[i].appendChild(el);
} 
```

​ ​ jsFiddle：http: [//jsfiddle.net/eZv4D/2/](http://jsfiddle.net/eZv4D/2/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T22:19:00.350

一种方法如下：

```
var liElems = document.getElementsByTagName('li'),
    strings = ['Hello beautiful lady ','Hej gentlemen '];

for (var i = 0, len = liElems.length; i < len; i++){
    elem = liElems[i].firstChild,
    curText = elem.nodeValue;
    if (i%2 == 0){
        elem.nodeValue = strings[0] + curText;
    }
    else {
        elem.nodeValue = strings[1] + curText;
    }
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/vFaw6/)。

参考：

*   [数组](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array)。
*   [`document.getElementsByTagName()`](https://developer.mozilla.org/en/DOM/document.getElementsByTagName).
*   [`for () {...}`](https://developer.mozilla.org/en/JavaScript/Reference/Statements/for).
*   [`node.firstChild`](https://developer.mozilla.org/en/DOM/Node.firstChild).
*   [`node.nodeValue`](https://developer.mozilla.org/en/DOM/Node.nodeValue).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-06T22:26:07.333

这是另一种方法：

[http://jsfiddle.net/cWRPZ/](http://jsfiddle.net/cWRPZ/)

从...开始：

```
<ul>
    <li>1</li>
    <li>2</li>
</ul> 
```

js是..

```
var demo = {
    __elems: false,
    replacement: 'This is element __replaceme__',
    go: function(){
        this.__elems = document.querySelectorAll('li');
        for(var i = 0; i < this.__elems.length; i++){
            elem = this.__elems[i];
            elem.firstChild.nodeValue = this.replacement.replace('__replaceme__',elem.firstChild.nodeValue);
        }                
    }
}

demo.go(); 
```

一些重要的事情要记住， DOM 中[有一些 nodeTypes](https://developer.mozilla.org/en/nodeType)，并不是所有的都是你想要的，所以你应该过滤。例如，如果在文本前面有一个注释节点，那么这将无法按您的预期工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-06T22:43:07.577

> *“不学习是相当困难的。”*

我正在使用视频中介绍的工具 JSLint 分析他们的代码，这里[大约](http://www.jslint.com/)44.00 点[。](http://www.youtube.com/watch?v=hQVTIJBZook&list=PL20115B23208B1033&index=2&feature=plpp_video)Billiand 的简单版本具有最少的规范（？）错误。视频中提到了一种叫做 ES3.1 的东西即将到来，无论如何我没有资格说它们现在是对还是错——取决于规格（根据视频，当前是 1999 年的规格）。反正我是倾向于用simple-method，反馈一下分析？

> **大卫托马斯**
> 
> ```
> 'document' was used before it was defined.
> var liElems = document.getElementsByTagName('li'),
> line 2 character 40Missing space between ',' and 'Hej gentlemen '.
>     strings = ['Hello beautiful lady ','Hej gentlemen '];
> line 4 character 6Move 'var' declarations to the top of the function.
> for (var i = 0, len = liElems.length; i < len; i++){
> line 4 character 6Stopping. (30% scanned). 
> ```
> 
> **辉煌**
> 
> > **简单的**
> > 
> > ```
> > 'document' was used before it was defined.
> > var lis = document.getElementById("uid").getElementsByTagName("li");
> > line 2 character 4Missing space between 'for' and '('.
> > for(var i = 0; i < lis.length; i++)
> > line 2 character 5Move 'var' declarations to the top of the function.
> > for(var i = 0; i < lis.length; i++)
> > line 2 character 5Stopping. (66% scanned). 
> > ```
> > 
> > **DOM 版本**
> > 
> > ```
> > 'document' was used before it was defined.
> > var lis = document.getElementById("uid").getElementsByTagName("li");
> > line 2 character 4Missing space between 'for' and '('.
> > for(var i = 0; i < lis.length; i++) { // Loop through all <li> elements
> > line 2 character 5Move 'var' declarations to the top of the function.
> > for(var i = 0; i < lis.length; i++) { // Loop through all <li> elements
> > line 2 character 5Stopping. (12% scanned). 
> > ```
> 
> **丹普**
> 
> ```
> Unexpected dangling '_' in '__elems'.
>     __elems: false,
> line 4 character 17Expected exactly one space between 'function' and '('.
>     go: function(){
> line 4 character 19Expected exactly one space between ')' and '{'.
>     go: function(){
> line 4 character 19Missing space between ')' and '{'.
>     go: function(){
> line 5 character 9Missing 'use strict' statement.
>         this.__elems = document.querySelectorAll('li');
> line 5 character 14Unexpected dangling '_' in '__elems'.
>         this.__elems = document.querySelectorAll('li');
> line 5 character 24'document' was used before it was defined.
>         this.__elems = document.querySelectorAll('li');
> line 6 character 12Missing space between 'for' and '('.
>         for(var i = 0; i < this.__elems.length; i++){
> line 6 character 13Move 'var' declarations to the top of the function.
>         for(var i = 0; i < this.__elems.length; i++){
> line 6 character 13Stopping. (46% scanned).
> undefined
> document 'go' 4 
> ```
> 
> **柠檬**
> 
> ```
> 'document' was used before it was defined.
> var list = document.getElementById('uids'), // get the parent ul
> line 3 character 45Expected exactly one space between 'function' and '('.
> Array.prototype.forEach.call(items, function(item) { // because nodeLists are not arrays we do this for a forEach
> line 4 character 5Missing 'use strict' statement.
>     var value = item.textContent || item.innerText; // gets the text content cross browser
> line 5 character 10Expected exactly one space between 'while' and '('.
>     while(item.hasChildNodes()){ // this just removes the contents of the li without innerHTML, and is faster for this amount of data
> line 5 character 32Expected exactly one space between ')' and '{'.
>     while(item.hasChildNodes()){ // this just removes the contents of the li without innerHTML, and is faster for this amount of data
> line 5 character 32Missing space between ')' and '{'.
>     while(item.hasChildNodes()){ // this just removes the contents of the li without innerHTML, and is faster for this amount of data
> undefined
> document 'items' 3
> clear 
> ```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-07T01:00:51.760

```
var list = document.getElementById('uids'), // get the parent ul
    items = list.getElementsByTagName('li'); // get the items as a nodeList
Array.prototype.forEach.call(items, function(item) { // because nodeLists are not arrays we do this for a forEach
    var value = item.textContent || item.innerText; // gets the text content cross browser
    while(item.hasChildNodes()){ // this just removes the contents of the li without innerHTML, and is faster for this amount of data
        item.removeChild(item.lastChild);
    }
    item.appendChild(document.createTextNode("Wuddup " + value)); // append your new message :P
}); 
```

这是我的看法，但是如果可能的话，在将列表输出到文档之前在服务器上执行所有这些操作......这样更有意义。

这是一个关于消息生成[的演示；）](http://jsfiddle.net/rlemon/5XRB6/)

# python - 为什么 Mac OS X python 与 CentOS Linux python 对字符串中的 \U 转义有不同的解释？

> ID：10922766
> 
> 赞同：5
> 
> 时间：2012-06-06T21:45:54.507
> 
> 标签：python, macos, unicode, centos

两个 python 解释器会话。第一个来自 CentOS 上的 python。第二个来自 Mac OS X 10.7 上的内置 python。为什么第二个会话从 \U 转义序列中创建长度为 2 的字符串，并随后出错？

```
$ python
Python 2.6.6 (r266:84292, Dec  7 2011, 20:48:22) 
[GCC 4.4.6 20110731 (Red Hat 4.4.6-3)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> u'\U00000020'
u' '
>>> u'\U00000065'
u'e'
>>> u'\U0000FFFF'
u'\uffff'
>>> u'\U00010000'
u'\U00010000'
>>> len(u'\U00010000')
1
>>> ord(u'\U00010000')
65536 
```

* * *

```
$ python
Python 2.6.7 (r267:88850, Jul 31 2011, 19:30:54) 
[GCC 4.2.1 (Based on Apple Inc. build 5658) (LLVM build 2335.15.00)] on darwin
>>> u'\U00000020'
u' '
>>> u'\U00000065'
u'e'
>>> u'\U0000FFFF'
u'\uffff'
>>> u'\U00010000'
u'\U00010000'
>>> len(u'\U00010000')
2
>>> ord(u'\U00010000')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: ord() expected a character, but string of length 2 found 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T02:03:19.610

我对此完全不确定，但可能是您的 Mac OS X 系统使用了 python 的“窄构建”，它表示 unicode，只有 16 位用于 unicode 的内部编码，并表示 2* 以上的 unicode 代码点*16 作为字符对（这将解释`len(u'\U00010000') == 2`.

在 OS X 上试一下`unichr(0x10000)`，看看您是否收到有关窄构建的错误。另请参阅[普通 python 字符串使用什么编码？](https://stackoverflow.com/questions/3547534/what-encoding-do-normal-python-strings-use)，特别是IVH的回答。

即使系统上的默认 python 使用窄版本，也可以重新编译 python 以使用宽版本。

# php - 解析错误：语法错误，意外的 T_ENDWHILE

> ID：10922771
> 
> 赞同：1
> 
> 时间：2012-06-06T21:46:14.833
> 
> 标签：php

```
<?php get_header(); ?>
<div id="content">

<?php if (have_posts()): ?>

    <?php $i=0;?>
    <?php while (have_posts()) : the_post(); ?>
    <?php $i++;?>
    <div class="cols"<? if($i%3==0) echo ' style="margin-right:0"';?>>
        <div class="post" id="post-<?php the_ID(); ?>">
            <?php $thumb=get_post_meta($post->ID, 'image', true); ?>
            <a href="<?php the_permalink() ?>" rel="bookmark" title="Permanent Link to <?php the_title_attribute(); ?>">
            <?php if($thumb!=''){
            $thumb = str_replace(get_bloginfo('url').'/','',$thumb);
            ?>
            <img src="<?php bloginfo('template_url');?>/thumb.php?src=<?=$thumb;?>&w=183&h=140&zc=1" class="thumb" alt="<?php the_title(); ?>" />
            <? } else { ?>
            <img src="<?php bloginfo('template_url'); ?>/images/pic.jpg" alt="" class="thumb" />
            <? } ?>
            </a>

            <h2 class="title"><a href="<?php the_permalink() ?>" rel="bookmark" title="Permanent Link to <?php the_title_attribute(); ?>"><?php echo cut_string(get_the_title(),30,'...'); ?></a></h2>
            <p><?php echo cut_string(get_the_content(),60,'...'); ?></p>
            <p class="meta">
            <?php if(function_exists('the_views')) { ?>
            <span class="views"><?php the_views(); ?></span> <?php } ?>
            <?php comments_popup_link('No Comments', '1 Comment', '% Comments', 'comments'); ?>
            </p>
            <p><?php if(function_exists('the_ratings')) { the_ratings(); } ?> </p>

        </div></div>

    <?php endwhile; ?>
    <div class="clearfix"></div>
    <div class="page_navi"><?php page_navi();?></div>

<?php else: ?>

    <div class="post">
        <h2 class="title">Not Found</h2>
    </div>

<?php endif; ?>
</div>

<!-- end content -->

<?php get_sidebar(); ?>
<?php get_footer(); ?> 
```

解析错误：

> 语法错误，第 36 行 /home/fakecsc1/domains/jocuri2k.com/public_html/wp-content/themes/Games/index.php 中的意外 T_ENDWHILE

这段代码有什么问题？我该如何解决？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-06T21:49:12.413

看起来问题是您在这里使用[短标签](http://us3.php.net/manual/en/ini.core.php#ini.short-open-tag)：`<?`而不是`<?php`

```
 <? } else { ?>
            <img src="<?php bloginfo('template_url'); ?>/images/pic.jpg" alt="" class="thumb" />
            <? } ?>
            </a> 
```

如果您的服务器没有将这些解释为 PHP，则 php 将`endwhile`在看到结束标记之前看到 。将它们更改为`<?php`而不是`<?`.

# ruby-on-rails - 在 solaris 10 上执行 setuid 脚本时，rails 3.2.1 rails runner 失败

> ID：10922774
> 
> 赞同：1
> 
> 时间：2012-06-06T21:46:35.723
> 
> 标签：ruby-on-rails, ruby, solaris-10

我们需要使用基于大型机的调度程序而不是 cron 来执行实用程序任务。此调度程序与主机上的代理通信，然后执行通用 setuid ksh 脚本，该脚本将实用程序与所需的任何参数一起作为参数执行。setuid ksh 脚本然后调用另一个脚本及其参数。

在我的例子中，下一个脚本 ( `execute_something.ksh`) 将一些环境变量`cd`s 设置为 Rails 根目录，并`rails runner Module.function -e <environment>`在 environment 是传递的 arg 的位置执行。

所以那是：

```
mainframe -> agent -> setuid_script -> execute_something.ksh -> Module.function 
```

当我像我自己一样直接调用时`execute_something.ksh`，它工作正常。当我调用 setuid 脚本时，出现以下错误：

> /[path]/bin/rails:15:in `force_encoding': 未知编码名称 - 来自 /[path]/bin/rails:15:in main 的 BINARY (ArgumentError)

这*不是*权限问题。所有涉及的文件要么归 setuid 用户所有，要么拥有 setgid 组的完整组权限并属于该组。（是的，矫枉过正，但这就是我得到的。）

setuid 脚本继承了我的环境（除了存在 setuid 用户的 EUID）。

此外，正在执行的 rails 脚本与安装在我的 linux 笔记本电脑上的脚本不同（我确实提到这是一个 solaris 问题）。

rails 脚本是：

```
#!/usr/bin/env ruby
#
# This file was generated by RubyGems.
#
# The application 'railties' is installed as part of a gem, and
# this file is here to facilitate running it.
#

require 'rubygems'

version = ">= 0"

if ARGV.first
  str = ARGV.first
  str = str.dup.force_encoding("BINARY") if str.respond_to? :force_encoding
  if str =~ /\A_(.*)_\z/
    version = $1
    ARGV.shift
  end
end

gem 'railties', version
load Gem.bin_path('railties', 'rails', version) 
```

这对我有用。我明确删除了对我的主目录沙箱的所有引用`PATH`-`LD_LIBRARY_PATH`它仍然适用于我，而不适用于 setuid 用户。

我无权更改全局环境中的内容 - 我必须提出请求并等待。没有办法改变模块必须执行的方式。

请有人 - 给我一些想法？我不认为这适用于很多人，但这不是一个有趣的谜题吗？

TIA。

卡里达

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T01:43:34.683

rails 命令的目的是调用 script/rails（如果存在），因此您可以直接调用该脚本：

```
./script/rails runner Module.function -e <environment> 
```

# javascript - 谷歌关闭：依赖错误

> ID：10922775
> 
> 赞同：2
> 
> 时间：2012-06-06T21:46:37.273
> 
> 标签：javascript, google-closure-compiler

自从 Google 关闭 3 天以来，我遇到了一个问题，因为依赖项的顺序错误，我得到了这个：

**main.js**

```
(function () {
goog.provide('MYENGINE.Core');
goog.require('MYENGINE.engines.GraphicEngine');
goog.require('MYENGINE.engines.PhysicEngine');
goog.require('MYENGINE.engines.AudioEngine');
goog.require('MYENGINE.engines.GameEngine');

/*********************************
* @constructor
*
**********************************/
ENGINE.Core = function() 
{

};

})(); 
```

这段代码（使用正确的名称）：

```
(function () {
goog.provide('MYENGINE.engines.GraphicEngine');

/*********************************
* @constructor
*
**********************************/
MYENGINE.engines.GraphicEngine = function() 
{

};

})(); 
```

我不知道为什么，但是当我编译它时，“MYENGINE.engines.GraphicEngine”首先出现在 MYENGINE.Core 之前。所以，当我运行页面时，我得到了错误：* *Uncaught ReferenceError: MYENGINE is not defined **

我使用此代码来编译项目：

```
../extlib/closure/closure/bin/build/closurebuilder.py \
--root=../extlib/closure/ \
--root=../src \
--namespace="MYENGINE.Core" \
--output_mode=compiled \
--compiler_jar=compiler.jar \
> MYENGINE_min.js 
```

在我的“MYENGINE_min.js”中，我可以在核心或初始命名空间（MYENGINE）之前找到 GraphicEngine 的创建，我是不是忘了做点什么！？

非常感谢你的帮助 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T23:15:41.223

闭包的设计使得您不需要将每个模块包装在匿名函数中。如果您删除匿名函数包装器，您的错误应该会消失。例如，**main.js**变为：

```
goog.provide('MYENGINE.Core');

goog.require('MYENGINE.engines.GraphicEngine');
goog.require('MYENGINE.engines.PhysicEngine');
goog.require('MYENGINE.engines.AudioEngine');
goog.require('MYENGINE.engines.GameEngine');

/**
 * @constructor
 */
MYENGINE.Core = function() 
{

}; 
```

你还问：

> 我不知道为什么，但是当我编译它时，“MYENGINE.engines.GraphicEngine”首先出现在 MYENGINE.Core 之前。

`MYENGINE.Core`在行中：

```
goog.require('MYENGINE.engines.GraphicEngine'); 
```

表示`MYENGINE.Core`取决于`MYENGINE.engines.GraphicEngine`。因此，`MYENGINE.engines.GraphicEngine`必须首先出现，以便在从 调用时对其进行定义`MYENGINE.Core`。例如，Closure's`base.js`通常是 Closure Builder 生成的清单中的第一个源，因为所有其他 Closure Library 源都依赖于`base.js`引导该库。

如果您想将编译后的 JavaScript 包装在匿名函数中以额外防止名称冲突，则 Closure Compiler 提供以下标志：

```
--output_wrapper 将输出插入到该字符串中指定的位置
                    通过标记标记 %output%。

```

使用[Closure Builder](https://developers.google.com/closure/library/docs/closurebuilder)，将在命令行上指定输出包装器，如下所示：

```
--compiler_flags="--output_wrapper=(function(){%output%})();" 
```

此外，将编译器警告级别设置为详细将有助于在编译时捕获其他错误：

```
--compiler_flags="--warning_level=VERBOSE" 
```

新的构建命令将是：

```
../extlib/closure/closure/bin/build/closurebuilder.py \
--root=../extlib/closure/\
--root=../src\
--namespace="MYENGINE.Core" \
--output_mode=编译\
--compiler_jar=compiler.jar \
--compiler_flags="--output_wrapper=(function(){%output%})();" \
--compiler_flags="--warning_level=VERBOSE" \
> MYENGINE_min.js

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-27T06:55:58.037

你可以使用 goog.scope

```
goog.scope(function(){
    //code here
});
```

# ruby - 在 Mac OS X 上调试 Ruby 中的 malloc 错误

> ID：10922777
> 
> 赞同：8
> 
> 时间：2012-06-06T21:46:43.107
> 
> 标签：ruby, macos, debugging, malloc

我正在尝试调试运行一些 Ruby 脚本时遇到的以下错误：

```
ruby(47333,0x7fff72aee960) malloc: *** error for object 0x7f98b6a6e3f0: pointer being freed was not allocated
*** set a breakpoint in malloc_error_break to debug 
```

知道如何实际设置这样的断点并进行调试吗？我想看看这是由 Ruby 本身还是某些扩展引起的..

我正在使用`Mac OS X 10.7.3 (Lion)`和`ruby 1.8.7 (2010-01-10 patchlevel 249) [universal-darwin11.0]`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-17T07:32:23.963

当我看到 OP 的消息时，这就是解决我的问题的方法：

我收到消息是因为我弄乱了路径，试图获取`rvm`或`gem`安装某些东西，并且我设法真正弄乱了我的权限。然后我收到了 OP 报告的相同消息。对我来说，唯一要做的就是转到 Mac OS X 的`Disk Utility`，在左窗格（Macintosh HD）中选择我的卷，然后单击`Repair Disk Permissions`。

完成后，我能够成功打开并启动一个新的终端窗口。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T22:25:56.213

如果您使用的是 Ruby 1.9.2+，请安装调试器 gem ( `gem install debugger`)。有两种调试方法：直接包含`debugger`gem 或使用`redbug`二进制文件。假设我们有一个玩具脚本，我们想知道`$blah`调用后为什么是 4 `foo()`（假设它是一个外部库）。

# 方法一：包括`debugger`

这是在您的代码中手动设置断点：

```
require 'debugger'

$blah = 3

def foo
  $blah += 1
end

def bar
  $blah += 4
end

foo()
debugger() # opens rdb
bar()

puts $blah 
```

将其运行为`ruby debug.rb`. 这将使您进入 ruby​​ 调试控制台：

```
% ruby debug.rb
debug.rb:15
bar()
(rdb:1) list
[10, 19] in debug.rb
   10    $blah += 4
   11  end
   12  
   13  foo()
   14  debugger()
=> 15  bar()
   16  
   17  puts $blah
(rdb:1) display $blah
1: $blah = 4 
```

# 方法2：运行`rdebug`

这是我们的示例示例脚本`debug.rb`：

```
$blah = 3

def foo
  $blah += 1
end

def bar
  $blah += 4
end

foo()
bar()

puts $blah 
```

从外壳，执行`rdebug debug.rb`. 这是一个示例会话：

```
% rdebug debug.rb
(rdb:1) list 1,20
[1, 20] in /mnt/hgfs/src/stackoverflow/debug.rb
=> 1  $blah = 3
   2  
   3  def foo
   4    $blah += 1
   5  end
   6  
   7  def bar
   8    $blah += 4
   9  end
   10  
   11  foo()
   12  bar()
   13  
   14  puts $blah
(rdb:1) break 12
Breakpoint 1 file /mnt/hgfs/src/stackoverflow/debug.rb, line 12
(rdb:1) display $blah
1: $blah = 
(rdb:1) continue
Breakpoint 1 at /mnt/hgfs/src/stackoverflow/debug.rb:12
1: $blah = 4
/mnt/hgfs/src/stackoverflow/debug.rb:12
bar()
(rdb:1) display $blah
2: $blah = 4 
```

关键命令是`break LINE-NUMBER`和`display VARIABLE`。希望有帮助！

# 资源

*   [红宝石调试文档](http://bashdb.sourceforge.net/ruby-debug.html)
*   [调试器宝石](https://github.com/cldwalker/debugger)

# wordpress - 用户活动日志 Joomla、Wordpress 或 Drupal

> ID：10922782
> 
> 赞同：0
> 
> 时间：2012-06-06T21:47:30.857
> 
> 标签：wordpress, drupal, joomla, content-management-system

我将构建一个在内容管理系统（Joomla、Wordpress 或 Drupal）上运行的站点。当然，如果您使用的是您喜欢的其他 CMS，我不会接受任何其他建议。

一种情况是用户活动插件、模块或组件。它将只对注册用户关闭，我的客户想看看用户在看什么。

你知道任何可以让我跟踪用户在网站上的活动的模块、插件、组件吗？尤其是他们看过哪些网页，哪些没有看过。我更喜欢一个免费的插件，可以进一步修改以满足我的需要。

谢谢您的回答！五。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T12:37:09.177

WordPress [UserTracker](http://wordpress.org/extend/plugins/usertracker/)插件或[Statistics](http://drupal.org/documentation/modules/statistics) Drupal 模块应该适合您的需求。我对 Joomla 不熟悉，所以我不能在那里给你推荐。

Protip：我保证，如果您在一般意义上询问使用哪个 CMS，您将开始一场激烈的战争。我认为最好独立研究每一个，然后决定你认为最适合使用哪一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T21:55:15.397

您应该查看[MODx](http://www.modx.com)，在那里您可以轻松输入跟踪代码。或者用 PHP 编写自己的跟踪器。据我所知，MODx 本身也提供某种跟踪，但我不确定。MODx 的优点之一是，您可以清晰地分离 HTML 和 PHP，这是大多数 CMS 不提供的，同时在您的设计中具有很大的灵活性。当您开始时，我建议您使用 Evolution。革命对于初学者来说可能有点压倒性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-16T16:02:56.403

j4Age 很棒，它可以跟踪用户、页面、时间、IP、浏览器等。我唯一不喜欢的是：page_id 有自己的分类，与 Joomla 的核心不同。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-07T00:26:28.087

与您提到的所有 3 个 CMS 合作后，我建议您使用最新版本的[Joomla](http://demo.joomla.org/)。[他们的扩展存储库](http://extensions.joomla.org/extensions/site-management/analytics)中有大量统计插件可用。虽然一开始就使用 CMS 有很多争论，但它们占用了 80% 的开发时间，让您有时间开发业务解决方案，而且 Joomla 似乎拥有最大的新开发代码集合。

# android - 从 /assets 复制预填充的数据库

> ID：10922791
> 
> 赞同：0
> 
> 时间：2012-06-06T21:48:06.693
> 
> 标签：android

我正在使用[本文](http://www.reigndesign.com/blog/using-your-own-sqlite-database-in-android-applications/)中的代码将我拥有的预填充数据库复制到新创建的数据库中，从而覆盖它。

覆盖成功。我能够在正确的路径 data/data/my.package/databases/myDatabase 中看到正确复制的 db。但这仅在我离开 getWritableDatabse() 之前查看数据库的情况下。

如果我离开 getWritableDatabse() 数据库无效：它仍然保持正确的大小但它只有 android_metadata 而不是我的表然后全部消失。

我没有设法访问 Eclipse 的 Android 源代码（按照所有说明操作，但它仍然不起作用），但使用[GrepCode](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.0.3_r1/android/database/sqlite/SQLiteOpenHelper.java#SQLiteOpenHelper.getWritableDatabase%28%29)我设法将问题缩小到方法中的第 173-176 行`getWritableDatabase()`。

```
173 db.setVersion(mNewVersion);
174 db.setTransactionSuccessful();
175 } finally {
176   db.endTransaction(); 
```

任何人都知道为什么这段代码可能会重写我的数据库并将其清空？

这是相关的堆栈：

```
Thread [<1> main] (Suspended)   
StournamentDbAdapter$DatabaseHelper(SQLiteOpenHelper).getWritableDatabase() line: 180   
StournamentDbAdapter.open() line: 192   
ActivityTournamentsList.onCreate(Bundle) line: 57   
ActivityTournamentsList(Activity).performCreate(Bundle) line: 4465  
Instrumentation.callActivityOnCreate(Activity, Bundle) line: 1049   
ActivityThread.performLaunchActivity(ActivityThread$ActivityClientRecord, Intent) line: 1920    
ActivityThread.handleLaunchActivity(ActivityThread$ActivityClientRecord, Intent) line: 1981 
ActivityThread.access$600(ActivityThread, ActivityThread$ActivityClientRecord, Intent) line: 123    
ActivityThread$H.handleMessage(Message) line: 1147  
ActivityThread$H(Handler).dispatchMessage(Message) line: 99 
Looper.loop() line: 137 
ActivityThread.main(String[]) line: 4424    
Method.invokeNative(Object, Object[], Class, Class[], Class, int, boolean) line: not available [native method]  
Method.invoke(Object, Object...) line: 511  
ZygoteInit$MethodAndArgsCaller.run() line: 784  
ZygoteInit.main(String[]) line: 551 
NativeStart.main(String[]) line: not available [native method] 
```

我首先使用`mDb = mDbHelper.getWritableDatabase();`which 调用`DatabaseHelper.onCreate()`实际发生数据库创建的位置。在`DatabaseHelper.onCreate()`我只打电话给`copyDatabase();`它看起来像这样：

```
private void copyDatabase() throws IOException
    {
        //Open your local db as the input stream
        InputStream myInput =  sContext.getAssets().open(StournamentConstants.Database.DATABASE_NAME);

        // Path to the just created empty db
        String outFileName = StournamentConstants.Database.DB_PATH + StournamentConstants.Database.DATABASE_NAME;

        //Open the empty db as the output stream
        OutputStream myOutput = new FileOutputStream(outFileName);

        //transfer bytes from the inputfile to the outputfile
        byte[] buffer = new byte[1024];
        int length;
        while ((length = myInput.read(buffer))>0)
        {
            myOutput.write(buffer, 0, length);
        }

        //Close the streams
        myOutput.flush();
        myOutput.close();
        myInput.close();
    } 
```

所有这一切都很好，并且数据库被正确复制。只有当我爬出堆栈并返回到`getWritableDatabase() line: 180`那个问题时：数据库的大小保持不变，但它会丢失除 àndroid_metadata 之外的所有表。

* * *

**中间结论**

我对代码进行了更多研究（上面提到的 GrepCode 站点非常有帮助），因为我想深入了解它。进入后`getWritableDatabase()`，在第 165 行它会调用`onCreate()`，我在其中使用`copyDatabase();`. 问题是，在之前， on`getWritableDatabase() line 162` `db.beginTransaction();`被调用。为什么这是个问题？我将通过显示事件的顺序来解释：

1.  称呼`getWritableDatabase()`
2.  `getWritableDatabase()`调用`db = SQLiteDatabase.create(null);`因此创建一个数据库
3.  `getWritableDatabase()`来电`db.beginTransaction();`
4.  `getWritableDatabase()`来电`onCreate()`
5.  在里面`onCreate()`我通过调用`copyDatabase();`将数据库从资产复制到数据库位置来替换数据库。不知道为什么已经创建的数据库在那一刻没有崩溃。也许是因为它没有锁？
6.  在第 176 行`getWritableDatabase()`调用`db.endTransaction();`，这是关键部分：很高兴我将我的数据库复制到最初创建的数据库中，但是当`db.endTransaction();`被调用时，系统会将所有更改提交到我新复制的数据库。但请记住：我没有做任何更改，我没有创建表 - 我只是将数据库复制到正确的位置。所以提交不提交任何内容，从而用 NOTHING 重写数据库。**为此，我得到一个空的 db**。

我有一个邪恶的想法：

1.  将数据库复制到`onCreate()`
2.  打开新复制的数据库并用它替换数据库`getWritableDatabase()`使用（`onCreate()`获取数据库作为参数`getWritableDatabase()`）。

像这样的东西：

```
@Override
public void onCreate(SQLiteDatabase db) 
{
    try 
    {               
        copyDatabase();

        String dbPath = StournamentConstants.Database.DB_PATH + StournamentConstants.Database.DATABASE_NAME;
        SQLiteDatabase activeDb = SQLiteDatabase.openDatabase(dbPath, null, SQLiteDatabase.OPEN_READONLY);              

         db = activeDb;
    } 
       catch (IOException e) 
    {
       Log.i(getClass().getName() + ".onCreate ", e.getMessage());
   }   
} 
```

问题是我得到了一个`android.database.sqlite.SQLiteDatabaseLockedException: database is locked`所以我不能得到新复制的数据库。除此之外 - 我不确定在这种不正当的行为背后隐藏着什么样的险恶后果。

所以我会按照@Barak 的建议去做，并将我的复制移到构造函数中——在系统尝试创建数据库之前。因此，当`getWritableDatabase()`最终到达时，数据库已经存在并且系统不会尝试触摸它。我今天学到了很多——我很高兴。

结论：如果你能读懂（代码），你有一定的优势:^)

将让您了解这对我来说是如何工作的。

* * *

**定论**

我解决了这个问题。

几个区别：

1.  我不在`DatabaseHelper`'s 的构造函数中这样做。那将需要太多的代码更改。相反`open()`，我在`private static class DatabaseHelper extends SQLiteOpenHelper`课堂上做
2.  我不使用`getReadableDatabase()`但是`getWritableDatabase()`。原因很简单：`getReadableDatabase()`总是会打电话`getWritableDatabase()`，所以我想我会保存那个...

我也试图成为一个聪明的人，而不是`getWritableDatabase()`简单地自己创建数据库文件（这有一些代码开销）。我失败了。我认为这是由于许可问题或其他原因。这是我在里面尝试的`copyDatabase()`：

```
File f = new File(DB_PATH);
if (!f.exists()) 
{
    f.mkdir();
} 
```

但它总是失败。后来我发现`OutputStream myOutput = new FileOutputStream(outFileName);`实际上应该处理文件创建。

希望这对任何人都有帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T06:01:35.033

好吧，我看到的唯一区别是我没有在 中进行数据库复制/创建`onCreate`，那是空的。我在构造函数中完成所有操作，如下所示：

```
private static class DatabaseHelper extends SQLiteOpenHelper {
    DatabaseHelper(Context context, String dbname, int dbversion) {
        super(context, dbname, null, dbversion);
            if (checkDataBase(dbname)) {
                openDataBase(dbname);
            } else {
                try {
                    this.getReadableDatabase();
                    copyDataBase(dbname);
                    this.close();
                    openDataBase(dbname);
                } catch (IOException e) {
                     throw new Error("Error copying database");
                }
                Toast.makeText(context,"Initial " + dbname + " database has been created",
                    Toast.LENGTH_LONG).show();
            }
      }
    @Override
    public void onCreate(SQLiteDatabase db) {
    }
    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
    }
} 
```

# jquery - 在滚动功能期间切换类

> ID：10922795
> 
> 赞同：3
> 
> 时间：2012-06-06T21:49:02.293
> 
> 标签：jquery, function, scroll

如果有可能以某种方式编写一个片段，在窗口的滚动功能期间，主体会附加一个类？

```
$(window).scroll(function() {
    $('body').toggleClass('scrolling');
 }); 
```

如果用户正在滚动，则正文具有“滚动”类。如果当前未发生滚动，则正文没有类。

滚动功能似乎与上面的功能一起快速触发。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T22:21:24.783

没有像“mouse down”和“mouse up”这样的“scroll start”和“scroll end”对：“scroll”事件更像是“刚刚发生的滚动”。*如果n*毫秒内没有发生滚动，您可以设置超时以清除“滚动”类：

```
var scrollTimerId;

$(window).scroll(function() {
    if (!scrollTimerId)
       $('body').addClass('scrolling');

    clearTimeout(scrollTimerId);
    scrollTimerId = setTimeout(function(){
        $('body').removeClass('scrolling');
           scrollTimerId = undefined;
    },150);
}); 
```

演示：http: [//jsfiddle.net/8CaRE/2/](http://jsfiddle.net/8CaRE/2/)

（改变延迟，直到你找到你满意的东西——对我来说，150ms 似乎在 Chrome 中是一个合理的设置。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T22:00:29.320

在性能方面可能不是很健康，但是您可以`setInterval`每隔几毫秒添加一个来删除该类，并结合您的`scroll`处理程序在滚动时添加它。

```
$(window).on('scroll', function() {
    $('body').addClass('scrolling');
});

setInterval(function() {
    $('body').removeClass('scrolling');
}, 100);​ 
```

[http://jsfiddle.net/pYVL8/](http://jsfiddle.net/pYVL8/)

或者，稍微优化一下：

```
setInterval(function() {
    document.getElementsByTagName('body')[0].className = '';
}, 100);​ 
```

[http://jsfiddle.net/pYVL8/1/](http://jsfiddle.net/pYVL8/1/)

# asp.net - 更新时数据未绑定到下拉列表

> ID：10922800
> 
> 赞同：0
> 
> 时间：2012-06-06T21:49:18.717
> 
> 标签：asp.net, entity-framework, c#-4.0, linq-to-entities

我有两个下拉列表；第一个绑定到实体数据源，第二个根据用户从第一个列表中选择的内容而变化（最初它也是基于第一个下拉列表预先填充的）。由于某种原因，第二个列表中的数据没有保存到数据库中，我不知道为什么。

这是我的表单视图：

```
<asp:FormView ID="FormView1" runat="server" DataKeyNames="SuggestionID" OnItemCommand="FormView1_ItemCommand" OnItemUpdated="FormView1_ItemUpdated"
    DataSourceID="UpdateSuggestionEntity" DefaultMode="Edit" OnDataBound="FormView1_Databound" OnItemUpdating="Formview1_OnItemUpdating">
    <EditItemTemplate>
            <asp:DropDownList ID="DropDownList1" runat="server" OnSelectedIndexChanged="DropDownList1_SelectedIndexChanged" 
                DataSourceID="ServiceAreaEntity" DataTextField="ServiceAreaConcatenated" AutoPostBack="true" 
                DataValueField="ServiceAreaID" SelectedValue='<%# Bind("ServiceAreaID") %>'>
            </asp:DropDownList>
            <asp:DropDownList ID="DropDownList2" runat="server" OnPreRender="AddEmptySelect">
            </asp:DropDownList>
        <asp:Button ID="UpdateButton" runat="server" CausesValidation="True" 
            CommandName="Update" Text="Update" />
        &nbsp;<asp:Button ID="UpdateCancelButton" runat="server" 
            CausesValidation="False" CommandName="Cancel" Text="Cancel" />
    </EditItemTemplate>
</asp:FormView> 
```

这是我在后面的代码中设置的内容：

```
protected void Page_Load(object sender, EventArgs e)
    {
        if (!IsPostBack) {
            DigitalSuggestionBox.Data_Access.DigitalSuggestionBox_Entities context = new DigitalSuggestionBox.Data_Access.DigitalSuggestionBox_Entities();
            DropDownList DropDownList2 = (DropDownList)FormView1.FindControl("DropDownList2") as DropDownList;
            int ID = Int32.Parse(Request.QueryString["SuggestionID"]);
            var suggestion = from u in context.Suggestions
                             where u.SuggestionID == ID
                             select u;
            foreach (var i in suggestion) {
                var subServiceArea = from u in context.SubServiceAreas
                                    where u.ServiceAreaID == i.ServiceAreaID
                                    select u;
                DropDownList2.DataSource = subServiceArea;
                DropDownList2.DataTextField = "SubServiceAreaName";
                DropDownList2.DataValueField = "SubServiceAreaID";
                DropDownList2.DataBind();
                DropDownList2.SelectedValue = i.SubServiceAreaID.ToString();
            }
        }
    }

    // Dynamically populate the SubService Area Dropdown
    protected void DropDownList1_SelectedIndexChanged(Object sender, EventArgs e) {
        DigitalSuggestionBox.Data_Access.DigitalSuggestionBox_Entities context = new DigitalSuggestionBox.Data_Access.DigitalSuggestionBox_Entities();
        DropDownList DropDownList1 = (DropDownList)FormView1.FindControl("DropDownList1") as DropDownList;
        DropDownList DropDownList2 = (DropDownList)FormView1.FindControl("DropDownList2") as DropDownList;
        int valueSelected = Int32.Parse(DropDownList1.SelectedItem.Value);
        var subServiceArea = from u in context.SubServiceAreas
                             where u.ServiceAreaID == valueSelected
                             select u;
        DropDownList2.DataSource = subServiceArea;
        DropDownList2.DataValueField = "SubServiceAreaID";
        DropDownList2.DataTextField = "SubServiceAreaName";
        DropDownList2.DataBind();
    }

    protected void AddEmptySelect(Object sender, EventArgs e) {
        DropDownList DropDownList2 = (DropDownList)FormView1.FindControl("DropDownList2") as DropDownList;
        DropDownList2.Items.Insert(0, new ListItem("- Select -", "0"));
    } 
```

为什么除了 DropDownList2 之外的所有内容都正确保存？它完全忽略了用户在该下拉列表中选择的任何值。它绑定正确（一切显示正确），但似乎没有与表单视图的其余部分一起提交。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T13:11:35.120

我不断挖掘并找到这篇文章： http: [//www.codeproject.com/Questions/191898/DropDownList-and-capturing-values-after-SelectedIn](http://www.codeproject.com/Questions/191898/DropDownList-and-capturing-values-after-SelectedIn)

我觉得有更好的方法可以做到这一点，但我还没有想出任何办法，这种方法就像一种魅力。如果有人愿意贡献，我很想看看还有什么其他解决方案是可能的。

# c# - 从 C# 调用 Delphi 6 DLL 会导致不同的舍入？

> ID：10922804
> 
> 赞同：3
> 
> 时间：2012-06-06T21:49:35.803
> 
> 标签：c#, delphi, dll, dllimport

当值似乎落在 0.5 括号内时，我在 delphi 舍入（从 ac# 项目中使用时）和结果的一致性方面遇到了一些严重问题，即它是向上还是向下舍入？？？

我创建了一个执行许多操作的 delphi DLL。其中一项操作的症结是（例如）

```
double := Round(double1   * double2); 
```

其中 double1 = 1.9 和 double2 = 225 （从文件中读取的值）

我的计算器上的结果显示它应该是 427.5。[delphi DLL 中的结果为 427。四舍五入，根据Round()](http://www.delphibasics.co.uk/Method.asp?NameSpace=System&Class=Math&Method=Round)的 delphi 文档，一切都很好

这些计算的值是针对代表表单的 Delphi（我相信的类）存储的。在上面这样的情况下

```
property SRDairy           : Double   read FSRDairy             write FSRDairy; 
```

该属性属于一堆类，并像这样被序列化到 Delphi DLL 中的缓冲区（AOvrFarm 是包含要序列化的所有项目的父级，包括我的 SRDairy 一个）

```
procedure GetResultString(AOvrFarm: TdataV6; outputStringBuffer: PChar; var
    bufLen: Integer);
var
  MyStrings : TStringList;
  resultString   : string;
begin
  MyStrings := TStringList.Create;
  try
    AOvrFarm.SavetoStrings(MyStrings);
    resultString := MyStrings.Text;

    if outputStringBuffer = nil then
    begin
      bufLen := Length(resultString) + 1;
    end
    else
    begin
      StrLCopy(outputStringBuffer, PChar(resultString), bufLen - 1);
    end;
  finally
    MyStrings.Free;
  end;
end; 
```

在这个 DLL 中完成了许多其他属性、表单（类）等。最后，该文件被序列化为一个字符串，该字符串返回给调用者（c#）应用程序，并使用类似（在 delphi 中）填充 refoutputStringBuffer：

```
 StrLCopy(outputStringBuffer, PChar(resultString), bufLen - 1); 
```

我的问题是当我从 ac# 应用程序调用这个 DLL 时。我得到的结果不是 427，而是 428。四舍五入！！！

德尔福签名：

函数 ConvertString(fileContents: PChar; fileExt: PChar; var outputStringBuffer: PChar; var outputStringBufferSize: Integer; var errorMsgBuffer: PChar; var errorMsgBufferSize: Integer): WordBool; 标准调用；出口;

我使用我的 c# 中的 DLL，如下所示：

```
[DllImport("OvrFileImport.dll",
               CallingConvention = CallingConvention.StdCall,
               CharSet = CharSet.Ansi)]

public static extern bool
        ConvertString(
        string fileContents, 
        string fileExt, 
        ref string refputStringBuffer,
        ref int outputStringBufferSize, 
        ref string errorMsgBuffer, 
        ref int errorMsgBufferSize); 
```

转换字符串被调用一次以获取缓冲区大小，然后再次调用以填充缓冲区。在第二次通话中，我注意到了不同之处。当使用来自 Test Delphi 项目的相同 DLL 时，我得到 427（而不是 c# 428）。

我已经尝试针对任何 CPU 构建我的 c#，并且只是 x86，以防它是某种 cpu 64 位问题，因为我的 PC 是 64 位机器。

有没有人遇到过这种事情，如果有，他们有什么办法解决吗？

**编辑 - 答案**

正如 David Heffernan 所提到的，从 c# 调用 DLL 时使用的控制字与从另一个 Delphi 应用程序调用时使用的控制字不同。从 c# 调用时使用的控制字实际上是 639 美元。

不幸的是，将控制字设置为 $1372 会导致我的 c# 应用程序在调试时出现问题，即它导致本地的监视窗口显示所有变量的“由于堆栈溢出状态而无法评估”异常。我发现了[一篇文章——奇怪的浮点结果](http://wiert.me/2009/05/06/delphi-michael-justin-had-strange-floating-point-results-when-his-8087-fpu-control-word-got-hosed/)，它讨论了这个问题，因此将其改为 $133F（它解决了浮点差异和 c# 调试问题）。

代码是：

```
begin
     cw := Get8087CW;
     Set8087CW($133F);
     ....
     finally
        Set8087CW(cw); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T22:15:21.403

1.9 不能用浮点数精确表示，而 225 可以精确表示。

目前尚不清楚输入数字的来源，但使用 IEEE754 算法根本不可能精确地执行 1.9*225 的乘积。您看到的行为与舍入无关，实际上与可表示性有关。如果您需要精确地执行此计算，那么您需要使用十进制算术而不是浮点数。这意味着在 Delphi 中使用货币类型或在 C# 中使用十进制。

您的不同行为的根源可能是控制浮点寄存器的 8087 控制字。当您的 DLL 执行时，从 C# 调用，控制字将不同于默认的 Delphi 设置。在 DLL 的入口点调用 Set8087CW($1372) 以使用默认的 Delphi 控制字。请记住在从 DLL 返回之前恢复它。

# java - 控制 Oracle 游标

> ID：10922807
> 
> 赞同：0
> 
> 时间：2012-06-06T21:49:48.223
> 
> 标签：java, oracle

**问题：游标数量一直增加，直到达到最大值。**

第一个连接被创建。**此连接永远不会关闭（）**

```
Class.forName("oracle.jdbc.driver.OracleDriver");
con = DriverManager.getConnection(url, schema, password);

con.setAutoCommit(true);
con.setHoldability(ResultSet.CLOSE_CURSORS_AT_COMMIT); 
```

使用相同的连接，客户端可以

```
public ResultSet runSelect(final StringBuilder query) {

    Statement stmt = null;
    ResultSet rs = null;

    try {
        stmt = con.createStatement();
        rs = stmt.executeQuery(query.toString());
    } catch (SQLException e) {
        logger.error("Failed to execute database query (select):" + query, e);
    }

    return rs;
} 
```

收到结果后，客户端`close()`将其与语句一起

```
 if (rs != null) {
            try {
                rs.close();
                ... 
```

这里有什么东西会导致游标数量增加吗？

我在想可能是我错过了关闭 stmt 并且应该是

```
 if (rs != null) {
            try {
                Statement stmt = rs.getStatement();

                stmt.close();
                rs.close();
                ... 
```

**此外，在结果集关闭的顺序上..在关闭结果集之前关闭语句是否可以？**

不幸的是，我要到明天才能确认这一点。你怎么看？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T22:27:53.747

[Statement.close() 的 Javadoc](http://docs.oracle.com/javase/6/docs/api/java/sql/Statement.html#close%28%29)：

> 当 Statement 对象关闭时，其当前的 ResultSet 对象（如果存在）也将关闭。

因此，您应该关闭第`ResultSet`一个然后`Statement`关闭 ，或者只关闭`Statement`.

另外，关闭`ResultSet`和/或`Statement`在一个`finally`块中。

# regex - 如何抓取列表项的左侧 3 个字符

> ID：10922810
> 
> 赞同：0
> 
> 时间：2012-06-06T21:50:02.777
> 
> 标签：regex, forms, parsing, coldfusion, listitem

我在 ColdFusion 工作。这是我遇到的问题。我有一个包含许多字段的表单，包括复选框。复选框遵循标准命名约定，例如每个复选框都命名为“chk”，然后是名称。因此 EMT 将被命名为 chkEMT，以此类推。我正在遍历 form.fieldnames，我需要获取所有以“chk”开头的表单字段，然后从字段名中删除“chk”并仅返回名称的其余部分，例如“EMT”。因此“chkEMT”被解析并作为“EMT”返回，其余的字段名可以被跳过。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T22:15:35.503

```
<cfset testList = "chkOne,chkTwo,chkThree,zzzNothing,chkFour" />
<cfloop list="#testList#" index="i" >
    <cfif left(i,3) eq "chk">
        <cfoutput>#right(i,len(i)-3)#</cfoutput>
    </cfif>
</cfloop> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T22:02:06.317

您可以使用`chk(\w+)`
which 捕获以单词开头`str`和继续的字符串 (words/numbers/undersocre)

这将在捕获括号内捕获单词的其余部分。您可以使用您使用的相关正则表达式 API 访问捕获的部分。

# mysql - 来自相关“访问”表的 MySQL COUNT(*)

> ID：10922813
> 
> 赞同：1
> 
> 时间：2012-06-06T21:50:10.560
> 
> 标签：mysql

我一直在处理 MySQL 查询，想知道是否有更好的方法来做到这一点（没有相关的子查询等）。有问题的查询是

```
SELECT 
   (SELECT COUNT(*) as num_visits FROM visit WHERE data_type='gallery'
    and gallery.id=visit.object_id) as num_visits, gallery.id
FROM gallery
    ORDER BY num_visits desc 
```

表结构的相关部分是

```
gallery
-------
id

visit
-----
id
data_type --> enum('gallery','etc')
object_id --> ties to various tables 
```

对此的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T21:53:34.227

```
 SELECT COUNT(v.object_id) as num_visits, g.id
     FROM gallery g
LEFT JOIN visit v ON g.id=v.object_id AND v.data_type='gallery'
 GROUP BY g.id
 ORDER BY num_visits DESC 
```

但更好的解决方案（从性能角度来看）是预先计算访问量并将其存储在`gallery`表中（或其他一些）

# c++ - PhysFS 可以使用 ifstreams 吗？

> ID：10922814
> 
> 赞同：1
> 
> 时间：2012-06-06T21:50:20.250
> 
> 标签：c++, physfs

我有个问题。我有很多以这种方式使用 ifstreams 的代码：

前任：

```
bool AudioManager::_loadSounds( const std::string& path, const std::string& appendPath )
{
    //open the file
    std::ifstream ifs( path.c_str() );

    //ensure it is open
    if(!ifs.is_open())
    {
        return false;
    }

    std::string line;

    //read each sound
    while( getline( ifs, line ) )
    { 
```

...

问题是我需要在应用程序范围内进行更改才能使用 PhysFS。所有数据将保持结构相同的目录明智，除了它将被划分为 zip 文件。

有没有一种简单的方法可以让 PhysFS 应用于 ifstreams，这样我就不需要修改所有这些类？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T02:04:27.597

没有*简单*的方法可以做到这一点。无论如何，您将不得不不使用 fstreams。`std::streambuf`但是，您可以通过简单地编写一个从 PhysFS 中提取其数据的派生类来继续使用流。这不是一件小事，因为`streambuf`它具有各种复杂性。但这肯定是可行的。

您可以采用任何`istream`- 派生类并将不同的类推`streambuf`入其中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T22:14:04.523

PhysFS 是一个 C 库，没有 C++ 类型的概念。如果要将 PhysFS 句柄视为流对象，则需要找到 C++ 包装器或编写自己的包装器。

# c++ - 流、stream_bufs、codecvt facets 和 \n 到 \r\n 转换

> ID：10922818
> 
> 赞同：5
> 
> 时间：2012-06-06T21:50:35.943
> 
> 标签：c++, iostream, streambuf, codecvt

C++ IO 流的哪一部分进行了`\r`to`\r\n`转换？它是它`stream_buf`本身还是它是通过`codecvt`方面的内部到外部编码转换的一部分？

**更新 1**

你们都说是在streambuf/filebuf中完成的。好的。但是这种安排如何处理，例如，像 UTF-16 这样的外部编码？然后似乎必须使用`ios::binary`禁用翻译的标志打开文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T22:20:52.347

这种转换（通常）不是由流、streambuf 或 facet 执行的。由 streambuf和`fputc()`调用的 C 库代码（例如）负责。`overflow()``underflow()`

如果出于某种原因需要它（例如，在实现 dos2unix 例程时），[boost.iostreams 中有一个方便的示例。](http://www.boost.org/doc/libs/release/libs/iostreams/doc/tutorial/unix2dos_filters.html)

编辑：`std::filebuf`仅支持文本文件的多字节编码，例如 UTF-8 或 GB18030 或任何语言环境使用的编码。UTF-16 文件必须以二进制模式打开，作为纯字节流（可以使用 C++11 的 codecvt 工具将其解释为 UTF-16），是的，行尾不会被转换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T22:10:15.723

IFAIR 它是在 streambuf 实现中完成的，`codecvt`只处理语言环境表示的细节。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-06T22:43:32.210

它由 std::filebuf 执行，如果它在没有 ios::binary 标志的情况下打开。

# html - 我的 CSS 渐变不适用于 IE 9 或更低版本

> ID：10922819
> 
> 赞同：3
> 
> 时间：2012-06-06T21:50:50.883
> 
> 标签：html, internet-explorer, css

我有一个在 IE 9 或更低版本中不起作用的图像的 CSS 渐变。我尝试添加一个 height:100%; 因为我看到这对其他人有所帮助，但它仍然没有影响我的。图片是注册按钮，我的网址是[http://ht.io-web.com/](http://ht.io-web.com/)。这是CSS

```
.white {
background: -moz-linear-gradient(center top , #FFFFFF, #DEDCDC) repeat scroll 0 0 transparent;
border: medium none #DEDCDC;
color: #85B700;
margin-left: 5px;} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T21:53:55.583

即渐变：

`filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#cccccc', endColorstr='#000000');`

webkit 浏览器的渐变：

`background: -webkit-gradient(linear, left top, left bottom, from(#ccc), to(#000));`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T21:54:03.097

如果没有 Microsoft 脚本（如 Keith 所述），则 CSS 渐变在 IE9 及以下版本中不可用。

[http://caniuse.com/#search=linear-gradient](http://caniuse.com/#search=linear-gradient)

而且您的 CSS 代码专门使用 Mozilla 浏览器前缀，因此它只能在 Firefox 浏览器中运行。

您可以使用“-webkit-”和“-o-”来定位 Safari/Chrome 和 Opera 浏览器（如 CanIUse.com 中所述），但我相信它们具有不同的参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T22:26:07.173

IE 不支持 CSS 渐变——甚至在 IE9 中也不支持。

但是，有一个名为 CSS3Pie 的 javascript hack 可以为您解决这个问题。

见[http://www.css3pie.com/](http://www.css3pie.com/)

将此脚本添加到您的站点，IE 将能够处理 CSS 渐变。

（css3pie 也做其他 CSS 东西，比如圆角，但 IE9 已经支持它们，所以这些 hack 只适用于 IE8 及以下）

# iphone - InAppPurchase 适用于模拟器，但不适用于 iPhone

> ID：10922823
> 
> 赞同：1
> 
> 时间：2012-06-06T21:51:02.230
> 
> 标签：iphone, ios, app-store, in-app-purchase, storekit

我有一个应用程序 v1.0 已经在商店发布，但没有应用内购买。我开发了一个 v1.1 添加一个应用内购买。

IAP 在模拟器上运行良好（标题、描述、价格和 ID 都从 iTunes Connect 正确返回），但在设备上却不行。正如 Eric 在这篇文章中所说，解决方案是从 iphone 中删除该应用程序并重新安装。 [在 App Purchase 中适用于模拟器但不适用于 iPhone](https://stackoverflow.com/questions/7837019/in-app-purchase-works-in-simulator-but-not-on-iphone/10922303#10922303) => 它适用

但是问题！我的用户是否还需要卸载他们的应用程序 v1.0 并安装 1.1 才能正常工作？？？？（或者问题只是一个“沙盒”问题，我的用户可以进行更新并让 IAP 工作一次？？）

（如果他们需要重新安装，这是一个大问题，因为他们将丢失存储在 v1.0 中的数据以在 v1.1 中更新，只是为了让 IAP 能够正常工作......）。

谢谢您的帮助

# c# - 如何通过 menuItemClick 进行服务器验证

> ID：10922825
> 
> 赞同：0
> 
> 时间：2012-06-06T21:51:03.540
> 
> 标签：c#, validation, textbox, server-side

我是 .Net 的新手，我有一个快速的问题。在我的网络表单中，我有 3 个文本框，应该在服务器端的 menuItemClick 上进行验证。如何做到这一点。我看到每个文本框都有 onValidation 属性，但是什么时候执行这个验证呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T22:12:34.500

在 Web 应用程序中，我们有两种类型的验证。

1- 服务器端验证 2- 客户端验证

客户端验证通常由浏览器本身使用 java 脚本执行。由于它部署在客户的计算机上，因此可以更改甚至禁用它。它们只是帮助您在将任何内容发送到服务器之前更轻松地验证输入。

服务器端验证是您应该始终在服务器端执行的主要验证，以在任何操作之前验证和清理输入值。这不能由客户端更改，因为它位于服务器端，为了更改它们，用户需要访问在服务器上创建的程序集。

如果我理解正确，您所说的是客户端验证，这意味着每当您要将表单发布回服务器时，验证将在客户端浏览器上执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T08:27:19.907

最后，验证过程对我来说很清楚。对于服务器端验证，应完成以下过程。首先，我们创建验证器并将它们映射到特定的控件。之后，我们将控件的 CausesValidation 属性设置为 true。然后在每次回发（在我的情况下为 OnClick 事件）中，我们检查 Page.IsValid 是否 == 为真。

# asp.net - Asp：登录控制在第二次登录尝试时无法正确重定向

> ID：10922831
> 
> 赞同：1
> 
> 时间：2012-06-06T21:51:52.537
> 
> 标签：asp.net, login-control

正如标题中所说，我使用的登录控件与我第一次登录时的重定向方式不同。问题是我第一次登录重定向是正确的（default.aspx），在我注销然后再次登录后，它会将我带到我注销的页面。我不知道该怎么做！感谢所有帮助！谢谢！

```
<asp:Login ID="Login1" runat="server" DestinationPageUrl="~/Default.aspx" DisplayRememberMe="False"
TitleText="" UserNameLabelText="Username:" OnAuthenticate="Login1Authenticate" 
FailureText="Incorrect username or password" Width="100%" VisibleWhenLoggedIn="False" 
FailureAction="Refresh"  >
</asp:Login> 
```

* * *

```
protected void Login1Authenticate(object sender, AuthenticateEventArgs e)
{
    var filecontent = Server.MapPath(@"~/App_Data/UsersFile.txt");
    var lines = File.ReadAllLines(filecontent);

    foreach (var line in lines)
    {
        if (line.Contains(@"username"))
        {
            var str = line; int index = str.IndexOf("=", StringComparison.Ordinal);
            var newstr = str.Substring(index + 1);
            Username = newstr.Trim();
        }
        if (line.Contains(@"password"))
        {
            var str = line; int index = str.IndexOf("=", StringComparison.Ordinal);
            var newstr = str.Substring(index + 1);
            Password = newstr.Trim();
        }

        if ((!Login1.UserName.Trim().Equals(Username)) || (!Login1.Password.Trim().Equals(Password))) continue;
        e.Authenticated = true;
        LogUserActions(Username, "Logged in successfully at: ");
        break;
    }

    if (e.Authenticated) return;
    LogUserActions(Username, "Failed to login in at: ");
    LoginStatus1_ModalPopupExtender.Show();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T14:13:37.223

当我没有注意到`Loginstatus`页面上的属性时，我很傻。这解决了我添加`LogoutAction`和后的问题`LogOutURL`。

```
<asp:LoginStatus ID="LoginStatus1" runat="server" 
LogoutAction="RedirectToLoginPage" LogoutPageUrl="~/Login.aspx" /> 
```

# php - PHP以特定格式验证日期

> ID：10922835
> 
> 赞同：-3
> 
> 时间：2012-06-06T21:52:10.440
> 
> 标签：php

我有一个格式为 mm/dd/yyyy 的生日，我想验证它，我在 stackoverflow 上找到了一个链接，但无法实现它。我该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T21:55:11.077

解析月份日期和年份的日期，然后您可以使用 PHP 函数 checkdate()，您可以在此处阅读：http: [//php.net/manual/en/function.checkdate.php](http://php.net/manual/en/function.checkdate.php)

其他方法是使用正则表达式来检查日期，我认为该页面上也有讨论这个问题的评论:)

# java - Java小程序游戏在不同的电脑上运行速度不同

> ID：10922836
> 
> 赞同：1
> 
> 时间：2012-06-06T21:52:33.057
> 
> 标签：java, applet

我已经构建了一个 Java 游戏（小程序）并将其放在一个[测试网站上](http://www.breakoutgame.hostzi.com/)。我无法在这里显示整个代码，因为它太大了，但是游戏以 20 帧/秒的速度运行，因为它在主循环中休眠了 50 毫秒。我已经在三台计算机上运行了游戏，其中两台在处理器速度和内存方面比另一台更快。另一个是一个小笔记本，它不能正常运行我的游戏。我的比赛就像一个带有球拍和球的突围比赛，问题是，当球移动时，它会减慢速度并加快常规巴顿（非常明显）。这发生在小型计算机上，但不会发生在其他两台计算机上。

游戏：为了制作这款游戏​​，我[在 YouTube 上关注了这个系列](http://www.youtube.com/watch?v=NWESIsSB1qY)。

所以基本上：

一共有三台电脑：

*   笔记本电脑（2GB 内存和 1.60 GHz） - 运行有问题的游戏（慢球和快球）
*   笔记本电脑（4GB 内存，2.7 GHz）- 运行游戏的速度与台式机一样快（完美）
*   台式机（16GB RAM，不确定但比 2.7 GHz 高得多）- 完美运行游戏

有了上面的知识，我可以排除游戏**不**依赖于处理器速度，必须是别的东西。会不会是因为笔记本处理器，因为它的两个处理器比较弱呢？但它是 1.6 GHz，所以我不知道如何玩一个小游戏。我真的不知道该怎么想，任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T00:02:05.057

不要只是在周期之间睡觉，而是尝试这样的事情：

...

```
final long timeSlice = 100;
while(true) {
  long startTime = System.currentTimeMillis() ;
  doMyStuff();
  long endTime = System.currentTimeMillis();
  sleep(Math.max(timeSlice + startTime - endTime, 0))
} // end while() 
```

...

您最终将花费大约相同的时间来完成每个周期。

# objective-c - 在 Objective C 中监视方法的结束

> ID：10922839
> 
> 赞同：1
> 
> 时间：2012-06-06T21:52:45.787
> 
> 标签：objective-c, ios, cocoa-touch

有没有办法监视 Objective C 中的方法以查看它何时完成？这是我无权访问的 SDK 方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T21:54:36.520

一般来说，没有。

“监视”某些类型的操作的能力有时会随着一些委托协议弹出，这些委托协议可能具有委托回调`WillFoo`的`DidFoo`类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T21:58:01.177

[您正在描述面向方面编程 (AOP)](http://en.wikipedia.org/wiki/Aspect-oriented_programming)的案例研究，这是面向对象编程的替代和扩展概念。

Objective-C 或底层 C 不提供此功能 - 但是有可能通过运行时操作将其部分添加到 Objective-C/Cocoa，例如方法调配。

在 github 上教授 Objective-C AOP 有多种尝试，但您必须自己测试它们，我从未使用过。

*   [https://github.com/moszi/AOP-in-Objective-C](https://github.com/moszi/AOP-in-Objective-C)
*   [https://github.com/tomdalling/AspectObjectiveC](https://github.com/tomdalling/AspectObjectiveC)
*   [https://github.com/ndcube/AOP-for-Objective-C](https://github.com/ndcube/AOP-for-Objective-C)

就我个人而言，我在 NSObject 上使用普通方法 swizzeling 来记录它的 dealloc 调用一次。如果对象属于某个子类，它就非常方便，因为我只记录了它。

* * *

我找到了一篇博客文章，它准确地展示了如何使用 NSInvocations：[Aspect Oriented Programming in Objective-C](http://moszi.net/wordpress/index.php/2011/08/11/aspect-oriented-programming-in-objective-c-2/)

编码

```
NSMutableArray* testArray = (NSMutableArray *)[[AOPProxy alloc] initWithNewInstanceOfClass:[NSMutableArray class]];

[(AOPProxy*)testArray interceptMethodEndForSelector:@selector(removeObjectAtIndex:)
                              withInterceptorTarget:self
                                interceptorSelector:@selector( removeInterceptor: )]; 
```

`removeInterceptor:`将在结束时调用该方法`removeObjectAtIndex:`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T21:58:30.757

不用于代码，不。

有一些分析技术可以为您执行此操作，例如[DTrace](http://en.wikipedia.org/wiki/DTrace)（可以在 Instruments 中使用），但这对您的代码没有帮助。您*可以* [调整方法](http://cocoadev.com/wiki/MethodSwizzling)，但如果您不确定自己在做什么，那么您**真的*非常*不应该这样做。**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-07T02:54:43.843

听起来答案是否定的。一点谷歌搜索发现这个：

> 离线保存对象
> 
> 大多数保存功能会立即执行，并在保存完成时通知您的应用。如果您不需要知道保存何时完成，则可以使用 saveEventually 代替。优点是如果用户当前没有网络连接，saveEventually 会将更新存储在设备上，直到重新建立网络连接。如果您的应用在连接恢复之前关闭，Parse 将在下次打开应用时重试。

从该文本中，听起来解析 API 包含此保存方法的变体，这些变体具有回调。

# android - Android：标签不会用 Holo 主题填充父级？

> ID：10922845
> 
> 赞同：3
> 
> 时间：2012-06-06T21:53:19.500
> 
> 标签：android

下面的代码创建了一个带有 4 个选项卡的视图。使用默认主题（在 androidmanifest.xml 中没有定义主题），我得到了第一个图像，其中选项卡平均增长以填充可用空间。如果我将主题设置为`android:theme="@android:style/Theme.Holo"`，我会得到第二张图像，其中 tabwidget（具有绿色背景）仍然填充父级的宽度，但选项卡不会增长以填充 tabwidget。

关于如何在使用 Theme.Holo 时获得第一个结果的任何想法？

![在此处输入图像描述](../Images/882275efc7ea42927177e4045f47c8e6.png)

![在此处输入图像描述](../Images/407e5121c0926520dc0e5687fab2d6e3.png)

```
public class TempProjActivity extends Activity 
{
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);

        setContentView(new MyTabHost(this));
    }

    private class MyTabHost extends TabHost
    {
        public MyTabHost(Context context) 
        {
            super(context, null);

            setId(android.R.id.tabhost);

            TabWidget widget = new TabWidget(getContext());
            widget.setId(android.R.id.tabs);
            widget.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT));
            widget.setBackgroundColor(Color.GREEN);

            FrameLayout layout = new FrameLayout(getContext());
            layout.setId(android.R.id.tabcontent);
            layout.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.FILL_PARENT));

            LinearLayout linearLayout = new LinearLayout(getContext());
            linearLayout.setOrientation(LinearLayout.VERTICAL);
            linearLayout.setLayoutParams(new TabHost.LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.FILL_PARENT));
            linearLayout.addView(widget);
            linearLayout.addView(layout);

            addView(linearLayout);

            setup();

            TabSpec spec = newTabSpec("tab1");
            spec.setIndicator("", getContext().getResources().getDrawable(R.drawable.ic_launcher));
            spec.setContent(new TabContentFactory() 
            {
                @Override
                public View createTabContent(String tag) 
                {
                    return new View(getContext());
                }
            });
            addTab(spec);

            spec = newTabSpec("tab2");
            spec.setIndicator("", getContext().getResources().getDrawable(R.drawable.ic_launcher));
            spec.setContent(new TabContentFactory() 
            {
                @Override
                public View createTabContent(String tag) 
                {
                    return new View(getContext());
                }
            });
            addTab(spec);

            spec = newTabSpec("tab3");
            spec.setIndicator("", getContext().getResources().getDrawable(R.drawable.ic_launcher));
            spec.setContent(new TabContentFactory() 
            {
                @Override
                public View createTabContent(String tag) 
                {
                    return new View(getContext());
                }
            });
            addTab(spec);

            spec = newTabSpec("tab5");
            spec.setIndicator("", getContext().getResources().getDrawable(R.drawable.ic_launcher));
            spec.setContent(new TabContentFactory() 
            {
                @Override
                public View createTabContent(String tag) 
                {
                    return new View(getContext());
                }
            });
            addTab(spec);
        }

    }
} 
```

编辑：

如果我在 MyTabHost 的构造函数末尾添加下面的代码，我会得到下图。但是，该图标仍未在选项卡中居中，而且它似乎不是一段特别安全的代码。

有比这更好的选择吗？或者关于这是否是一个合理的选择的意见？

![在此处输入图像描述](../Images/eb755b1105a10c2a147bb1131b27e244.png)

```
 post(new Runnable() 
        {

            @Override
            public void run() 
            {
                for(int i = 0; i < widget.getChildCount(); i++)
                {
                    widget.getChildAt(i).getLayoutParams().width = getWidth()/widget.getChildCount();
                }
            }
        });
    } 
```

# indexing - 重新定义行号（索引）

> ID：10922846
> 
> 赞同：0
> 
> 时间：2012-06-06T21:53:22.617
> 
> 标签：indexing, row, redefinition, redefine

> **可能重复：**
> [更改数据帧的索引号](https://stackoverflow.com/questions/7567790/change-the-index-number-of-a-dataframe)

我对数据框进行了各种操作并排除了一些行。正如您在我的示例中看到的，数据框现在以 366 开头。我想将此行号重新定义回 1，当然还有以下索引号。

```
 -> head(new_pred)
pred_mean_temp pred_precipitation pred_visibility pred_wind
366     -0.4707149          156.00677       260.24943 12.006212
367      3.3950894           85.07009        28.66573 12.618096
368      0.9394914          276.67157        12.39165  8.249188
369     -2.9786171          147.03749        10.21351  7.432625
370     -3.5502385           24.66432        16.59086 13.495728
371     -4.2262573           37.21946        17.51434  9.309708 
```

所以它看起来像这样：

```
-> head(new_pred)
pred_mean_temp pred_precipitation pred_visibility pred_wind
1     -0.4707149          156.00677       260.24943 12.006212
2      3.3950894           85.07009        28.66573 12.618096
etc. 
```

最好的感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-24T20:52:46.133

`rownames(new_pred) <- seq(nrow(new_pred))`更简单，而且`rownames(x) <- NULL`更简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T14:41:08.480

解决方法很简单：

```
 dimnames(new_pred)[[1]]<-seq_len(nrow(new_pred)) 
```

# python - python数组中对象变量的平均值

> ID：10922849
> 
> 赞同：0
> 
> 时间：2012-06-06T21:53:40.390
> 
> 标签：python, arrays, numpy

蟒蛇问题。

我有一个 numpy 对象数组（B）的列表（A）。我想获得 B 数组中所有对象的对象变量之一的平均值。现在，我只是解析 B 数组，对变量求和，然后除以 B 中的对象数。有没有更好或更 Pythonic 的方法来做到这一点？

如果我能得到 A 列表中所有对象的平均值（即所有对象），那也很棒

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T21:56:24.917

您正在做的事情对于对象数组来说听起来不错，这确实是获得平均值的唯一方法。至于A中所有元素的平均值，只需在遍历列表时添加每个平均值，然后除以A中的对象总数

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T05:28:08.467

您可以将其全部包含在列表理解中：

```
[sum(x)/len(x) for x in array_list] 
```

如果您想获得所有对象的平均值，您可以执行以下操作：

```
from __future__ import division
sums, lengths = zip(*[(sum(x),len(x)) for x in array_list])
mean = sum(sums) / sum(lengths)
# still can get averages for each object too
array_averages = [s/l for s,l in zip(sums,lengths)] 
```

只是因为我对第一次将列表解压缩到 zip 的语法感到困惑，快速说明：

```
>>> tuples = [(1,2,'a'), (3,4,'b'), (5,6,'c'), (7,8,'d')]
>>> print zip(*tuples)
[(1,3,5,7), (2,4,6,8), ('a','b','c','d')]
>>> a,b,c = zip(*tuples)
>>> print a
(1,3,5,7)
>>> print c
('a','b','c','d') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T06:32:35.633

如果你有一个 numpy 数组，你可以调用该`mean`方法：

```
In [24]: import numpy as np

In [25]: b = np.arange(5)

In [26]: b
Out[26]: array([0, 1, 2, 3, 4])

In [27]: b.mean()
Out[27]: 2.0 
```

如果您有一个 numpy 数组列表，则获取每个 numpy 的平均值就是：

```
In [28]: A = [np.arange(i) for i in range(3, 6)]

In [29]: A
Out[29]: [array([0, 1, 2]), array([0, 1, 2, 3]), array([0, 1, 2, 3, 4])]

In [30]: for B in A: print B.mean()
1.0
1.5
2.0 
```

或者，如果您要获取所有元素的平均值（在 A 中 B 的所有元素上），请使用以下`sum`方法：

```
In [31]: sum(B.sum() for B in A) / sum(len(B) for B in A)
Out[31]: 1.5833333333333333 
```

# ms-access - ms access - 基于文本框值的复选框

> ID：10922853
> 
> 赞同：2
> 
> 时间：2012-06-06T21:53:57.453
> 
> 标签：ms-access, vba, checkbox

我在 access 2007 中构建报告，并尝试根据文本框中字符串的值将复选框设置为 true。例如：如果 txtBoxValue = "Injury" 那么 chkBoxValue = True(Checked) 否则 chkBoxValue = False(unchecked)。

这是我在 chkBoxValue 的源代码管理中的值。

```
=IIf([txtBoxValue]=”Injury”,1,0) 
```

我是 VBA 新手，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-06T22:51:32.710

这应该作为 的控制源`chkBoxValue`：

```
=([txtBoxValue]="Injury") 
```

请注意您在 VBA 代码中使用的引号。请注意，您使用了“（ASCII 148），而我使用了”（ASCII 34）。

**编辑**：正如@nicholas 指出的那样，当`[txtBoxValue]`为Null 时，该控制源表达式将为您提供Null。如果您愿意`False`，请添加该`Nz()`功能。

```
=(Nz([txtBoxValue],"")="Injury") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T22:09:15.577

True / False 字段在 Access 中使用值 -1 和 0。你也有常量 TRUE 和 FALSE。

复选框的控制源应为：

```
=IIf([txtBoxValue]="Injury",TRUE,FALSE) 
```

# google-app-engine - 谷歌应用程序替代品

> ID：10922857
> 
> 赞同：2
> 
> 时间：2012-06-06T21:54:14.977
> 
> 标签：google-app-engine, real-time, collaboration

google apppot 引擎有什么替代品吗？我尝试了 google apppot，但结果非常昂贵，我想知道是否可以在我的服务器 (vps) 上安装守护进程，但它需要类似于 google apppot。有任何想法吗

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T22:30:24.927

是的，有些项目（几乎）与 GAE API 兼容：[AppScale](http://code.google.com/p/appscale/) (Java/Python)、[TyphooneAE](http://code.google.com/p/typhoonae/) (Python)

# bash - Bash 打印，如何

> ID：10922859
> 
> 赞同：-1
> 
> 时间：2012-06-06T21:54:21.140
> 
> 标签：bash, printing, ghostscript, postscript

用bash写了一个脚本。现在我需要将信息带入文本文件，例如在 PostScript 中，但有一个问题。我需要有一定长度的字符串，并在页面布局的整个宽度上拉伸或收缩字符串。我试过`a2ps`and `enscript`，但没有这样的选择。请告诉我这个问题的解决方案，也许在 Ghostscript 中。如何更改字母间距以填充线条？提前致谢！

**例如：**

输入

```
aaa
bbbb
ccccccc 
```

输出

```
a  a  a
b b b b
ccccccc 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T22:04:27.147

您的流程基本上分为三个步骤：

1.  生成你的文本文件（例如你的 shell 脚本）

2.  打印格式（可能转换为 Postscript，例如通过 a2ps，可能完全是其他东西，例如“troff”）

3.  将格式化的结果输出到打印机（例如“lpr”）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T23:09:34.530

```
sed -e 's/./& /g' -e 's/$/\\p/' < inputfile | groff -Tascii 
```

使用 groff 进行调整，但 groff 只会调整单词，所以先使用 sed 让每个字符成为一个单词。如果您想要不同的字体或更好的打印或其他什么，您可以使用 groff 来输出 postscript。

# maven-3 - Maven - 跳过特定模块的报告

> ID：10922861
> 
> 赞同：0
> 
> 时间：2012-06-06T21:54:34.197
> 
> 标签：maven-3

我正在寻找一种解决方案，以跳过对最终产品不重要的模块的一些 Maven 报告。例如仅作为单元测试的模块，或者像 Log4J 这样的第三方插件。

我有一个父 POM，其中定义了模块。

```
<project>
  <modules>
    <module>module1</module>
    <module>module2</module>
    <module>module3</module>
    <module>module4</module>
  </modules>
</project> 
```

还有依赖项和配置文件。请记住，这个项目是完全构建的。我希望减少完成 mvn 包站点的时间（目前超过 30 分钟）

进入 Module1 有父信息、工件 id 和包装 (pom)。然后定义了更多的子模块

```
<modules> 
    <module>package1</module>
    <module>package2</module>
    <module>package1.tests</module>
</modules> 
```

我想跳过报告的正是这个 package1.test。

我能找到的大部分内容都围绕着插件，比如来自 maven 网站的插件：

```
<build>
<plugins>
  <plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-site-plugin</artifactId>
    <version>3.1</version>
    <configuration>
      <skip>true</skip>
      <skipDeploy>true</skipDeploy>
    </configuration>
  </plugin>
</plugins>
</build> 
```

但我没有看到如何将其应用于模块。我确实尝试将`<config>`and添加`<skip>`到模块行。

我将不胜感激一些建议。我是 Maven 世界的新手，所以非常欢迎解释。

目前使用 maven 3.0.4。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T05:09:51.460

> 我没有看到如何将其应用于模块。我确实尝试将 and 添加到模块行。

跳过站点生成和部署的 maven 站点插件配置适用于项目 pom 而不是模块。您可以将上述代码段添加到您不希望为其生成站点信息的每个项目 pom 中。

# javascript - 在 javascripot 正则表达式中转义 metachar

> ID：10922863
> 
> 赞同：0
> 
> 时间：2012-06-06T21:54:36.927
> 
> 标签：javascript, regex

我有一个字符串片段，我正在寻找它以 DOT 开头和结尾。字符。

我正在尝试在javascript中解析这个：

```
var regex = new RegExp('\\.([^\\.]+)\\.', '');
var ar = s.match(regex); 
```

但它不起作用。我究竟做错了什么？顺便说一句，正则表达式还有更多内容，但我认为这是不起作用的部分，因为其他部分非常简单。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T21:58:06.257

您可以使用正则表达式文字语法去除一级转义：

```
var regex = /\.([^.]+)\./; 
```

除此之外，inside并不像outside 那样具有特殊意义`[…]`。`.`

# html - 使用 HTML 和 CSS 创建带圆角的 L 形边框

> ID：10922871
> 
> 赞同：2
> 
> 时间：2012-06-06T21:55:17.927
> 
> 标签：html, css

这是所需解决方案的图片（注意圆角）：

![在此处输入图像描述](../Images/8d143774183949b0156f19a69564a028.png)

这是我到目前为止所拥有的：

[http://jsfiddle.net/cBwh8/1/](http://jsfiddle.net/cBwh8/1/)

[http://jsfiddle.net/cBwh8/2/](http://jsfiddle.net/cBwh8/2/)

[http://jsfiddle.net/cBwh8/3/](http://jsfiddle.net/cBwh8/3/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T22:19:34.067

我认为我不会只使用标记而没有图像来解决这样的问题，但是既然你问了：

[http://jsfiddle.net/dcePR/](http://jsfiddle.net/dcePR/)

# .net - 如何保存从 linq 到 xml 的字符串？

> ID：10922873
> 
> 赞同：1
> 
> 时间：2012-06-06T21:55:35.630
> 
> 标签：.net, xml, linq, linq-to-xml

我想将我的节点输出保存到一个字符串中，以便以后可以使用它。我该怎么做？当我尝试使用 Stringbuilder() 时，它会将整个 XML 文件写入字符串，而不仅仅是我选择的节点。

这是我的代码：

```
XDocument xmlDoc = XDocument.Load("file.xml");

        var q = from c in xmlDoc.Descendants("Parent")
                select (string)c.Element("Child");
        foreach (string Child in q)
        {
            Console.WriteLine("Site: " + Child);
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T22:09:08.477

很难说出你在这里的真正目的。您是说上面的代码是您想要的，只是您想将子节点内容存储到本地 var 中？

如果是这样的话...

```
 var sb = new StringBuilder();
        XDocument xmlDoc = XDocument.Load("file.xml");

        var q = from c in xmlDoc.Descendants("Parent")
                select (string)c.Element("Child");
        foreach (string Child in q)
        {
            sb.AppendLine("Site: " + Child);
        }

        var result = sb.ToString(); 
```

# javascript - 为什么这个循环向后比向前慢得多？

> ID：10922874
> 
> 赞同：4
> 
> 时间：2012-06-06T21:55:39.650
> 
> 标签：javascript, performance, loops

我在这里有另一个人问题的答案[如何计算字符串中出现的字符串？](https://stackoverflow.com/questions/4009756/how-to-count-string-occurrence-in-string/7924240#7924240)[所以我在这里](http://jsperf.com/count-string-occurrence-in-string/3) 玩算法，在对一些函数进行基准测试后，我想知道为什么向后循环比向前循环慢得多。

![图形](../Images/c746866d97ef5ef80a9fcdafb027a88f.png)

[**基准测试在这里**](http://jsperf.com/charat-forward-vs-charat-backwards)

* * *

> 注意：下面的代码不能正常工作，还有其他代码可以工作（这不是这个问题的重点），在复制>粘贴之前要注意

**向前**

```
function occurrences(string, substring) {

  var n = 0;
  var c = 0;
  var l = substring.length;

  for (var i = 0, len = string.length; i < len; i++) {

    if (string.charAt(i) == substring.charAt(c)) {
      c++;
    } else {
      c = 0;
    }

    if (c == l) {
      c = 0;
      n++;
    }
  }
  return n;
} 
```

**向后**

```
function occurrences(string, substring) {

  var n = 0;
  var l = substring.length - 1;
  var c = l;

  for (i = string.length; i > 1; i--) {

    if (string.charAt(i) == substring.charAt(c)) {
      c--;
    } else {
      c = l;
    }

    if (c < 0) {
      c = l;
      n++;
    }
  }
  return n;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T22:08:27.270

我认为向后测试有一个错误：

`for (i = string.length; i > 1; i--) {`

应该

`for (i = string.length - 1; i >= 0; i--) {`

什么时候,`i`是未定义的。这样做几千次，它可能会产生很大的不同。`string.length``string.charAt(i)`

[这是一个修改后的测试](http://jsperf.com/charat-forward-vs-charat-backwards/2)，它似乎产生了更接近相同性能的结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T08:22:43.473

我自己找到了瓶颈。

当我这样做时

```
for (i = string.length; i > 1; i--) { 
```

我不小心删除了 var 中的“var” `var i`，所以我把它变成了`i`全局的。修复它后，我得到了预期的结果。

```
for (var i = string.length; i > 1; i--) { 
```

我从来没有想过这可能是一个巨大的差异，所以要注意伙计们。

[在此处修复基准测试](http://jsperf.com/charat-forward-vs-charat-backwards/4)

# 前：

![前](../Images/b90d4cac99bb1f156364acc23bbd8235.png)

# 后：

![后](../Images/e5df5eb345d6eff2a798527ff1f68faa.png)

PS：为了实际使用，不要使用这个函数，[indexOf](https://stackoverflow.com/questions/4009756/how-to-count-string-occurrence-in-string/7924240#7924240)版本要快得多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T22:09:36.913

你在测试什么数据。如果您的数据有很多匹配的前缀，但反过来却没有很多错误匹配，那可能会影响它。

也不会像“aaabbaaa”这样的搜索错误尝试找到“aab”它将匹配aa，然后失败，然后从第三个a继续并失败。?

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T23:15:09.150

因为它们不是完整的镜像函数，所以在两个函数`console.log()`的所有`if`s 和`else`s 中添加 s 并比较结果，您会发现测试不公平。

你做错了什么。我建议在开始测试之前确保它们都按预期工作。

# jquery - Jquery 移动点击事件不起作用 - DOM Prob？

> ID：10922876
> 
> 赞同：0
> 
> 时间：2012-06-06T21:55:48.923
> 
> 标签：jquery, checkbox, click

尝试了这个最新的一组代码的一些组合。简而言之，我将我的 javascript 从一个单独的文件运行到 html，我要做的就是设置一些代码以观察何时更改复选框以在其上运行一些逻辑。

尝试通过 .document.userdetails.signal、#signal（为此添加了类）和普通信号进行观看。

我会很感激一些指导，因为我在同一个 html 文件中查看了许多示例，所以我认为这是我试图解决按钮的方式。

```
<form id="userdetails" name="userdetails" action="javascript: savesettings()" >
       <p>
        <p>
        <div data-role="fieldcontain">
          <fieldset data-role="controlgroup" data-type="horizontal">
            <input name="signal" type="checkbox" class="custom" id="signal" value="1" checked="true" />
            <label class="signal" for="signal">Traffic Data</label>
            </legend>
</div> 
```

和 Javascript

```
 $(".document.userdetails.signal").click(function(e){
   e.preventDefault();
   alert('signal clicked!');
}); 
```

谢谢

人族

编辑 - 最后使用这个例子 -[点击事件没有在 jQuery Mobile 中触发？](https://stackoverflow.com/questions/6421047/click-event-not-firing-in-jquery-mobile)

EDIT2 - [http://forum.jquery.com/topic/calling-a-script-when-button-clicked](http://forum.jquery.com/topic/calling-a-script-when-button-clicked)添加了 $(document).ready 所以现在 $(document).ready(".document.userdetails.signal") .click(function(e){........ 当我打开应用程序时似乎注意到了变化 - 我想我现在需要找到正确的目标，因为 Jquery 重新创建了复选框等。

编辑 3 - Jasons 解决方案，尽管目标周围其他贡献者的评论很有用。

```
$(function() {
   $("#userdetails").on("change","#signal",function(eventObj) {
        //do code here. 
        eventObj.preventDefault();
   });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T23:12:36.547

`$(".document.userdetails.signal")`正在寻找具有三个类的元素，例如`class="document userdetails signal"`.

尝试`$("#signal")`：

```
$(function() { // shorthand for doc ready
    $(document).on('click','#signal',function(e) { // use .on in jquery 1.7
        alert('hello');
        e.preventDefault();
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T23:23:59.413

该`click`事件将适用于复选框，但通常如果您想在更改时运行 javascript，请改用该`change`事件。我已经包含了一个示例，`change`如果您想复制粘贴选择框或文本字段的代码

```
$(function() {
   $("#userdetails").on("change","#signal",function(eventObj) {
        //do code here. 
        eventObj.preventDefault();
   });
}); 
```

..编辑以回应评论..

```
 $(function () {
        $("#trafficdata").toggle(function () {
            alert('First handler for .toggle() called.');
        }, function () {
            alert('Second handler for .toggle() called.');
        });

        $("#userdetails").on("click", "#signal", function (eventObj) {

            eventObj.preventDefault();

            $("#trafficdata").click();

        });
    }); 
```

# c# - 如何在 List(Of Integer()) 上做一个不同的事情？

> ID：10922877
> 
> 赞同：2
> 
> 时间：2012-06-06T21:55:49.903
> 
> 标签：c#, .net, vb.net, linq

从此

(vb.net)

```
 Dim test As New List(Of Integer())
    test.Add(New Integer() {1, 2, 3})
    test.Add(New Integer() {1, 3, 3})
    test.Add(New Integer() {3, 2, 3})
    test.Add(New Integer() {1, 1, 3})
    test.Add(New Integer() {1, 2, 3})
    Dim a = test.Distinct 
```

（C＃）

```
 List<int[]> test = new List<int[]>();
    test.Add(new int[] { 1, 2, 3 });
    test.Add(new int[] { 1, 3, 3 });
    test.Add(new int[] { 3, 2, 3 });
    test.Add(new int[] { 1, 1, 3 });
    test.Add(new int[] { 1, 2, 3 });
    var a = test.Distinct(); 
```

不起作用，你会怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-06T22:09:10.550

您必须提供一个自定义的平等比较器`Distinct`才能在这种情况下工作 - 否则您正在比较参考，这是一个初步尝试：

```
class SequenceComparer<T,U> : IEqualityComparer<T> where T: IEnumerable<U>
{
    public bool Equals(T x, T y)
    {
        return Enumerable.SequenceEqual(x, y);
    }

    public int GetHashCode(T obj)
    {
        int hash = 19;
        foreach (var item  in obj)
        {
            hash = hash * 31 + item.GetHashCode();
        }
        return hash;
    }
} 
```

现在您可以在调用中使用它`Distinct()`：

```
var results = test.Distinct(new SequenceComparer<int[],int>())
                  .ToList(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-06T22:05:05.100

使用可以提供并实现它的[`Distinct`重载](http://msdn.microsoft.com/en-us/library/bb338049.aspx)`IEqualityComparer`来比较两个列表。

最小实现：

```
class ListComparer<T> : IEqualityComparer<List<T>> {
    public bool Equals(List<T> a, List<T> b) {
        if (a.Count != b.Count)
            return false;

        for (int i = 0; i < a.Count; i++)
            if (! a[i].Equals(b[i])
                return false;

        return true;
    }

    public int GetHashCode(List<T> a) {
        int ret = 11;
        unchecked {
            foreach (var x in a)
                ret = ret * 17 + x.GetHashCode();
        }
        return ret;
    }
} 
```

但是一个真正的实现应该有第二个构造函数`IEqualityComparer<T>`（除其他外，以便它们可以嵌套在嵌套列表中使用）。

# python - 按最低值对元组列表进行排序

> ID：10922879
> 
> 赞同：2
> 
> 时间：2012-06-06T21:55:58.097
> 
> 标签：python

假设我有一个元组列表：

```
my_list = [(1, 4), (3, 0), (6, 2), (3, 8)] 
```

无论位置如何，如何按元组中的最小值对该列表进行排序？我的最终名单如下：

```
my_sorted_list = [(3, 0), (1, 4), (6, 2), (3, 8)] 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-06T21:57:45.147

您可以利用该`key`参数来选择`.sort`或`sorted`：

```
>>> my_list = [(1, 4), (3, 0), (6, 2), (3, 8)]
>>> sorted(my_list, key=min)
[(3, 0), (1, 4), (6, 2), (3, 8)] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T21:58:00.107

```
my_sorted_list = sorted(my_list, key=min) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-06T22:20:36.367

```
sorted(my_list, key=lambda x: x[0] if x[0] < x[1] else x[1]) 
```

# java - Weave 构造函数在运行时创建了 Aspects？

> ID：10922880
> 
> 赞同：0
> 
> 时间：2012-06-06T21:55:59.073
> 
> 标签：java, aspectj, javaagents, aspect

是否可以通过构造函数定义切面切入点的属性，然后在创建实例后允许它在运行时编织？还可以在运行时加载/卸载/修改特定方面吗？我计划通过 rmi 公开这方面的一些方法，以允许与客户端应用程序通信。也许这对java代理技术是可能的？

# php - Zend Framework form_TableForm 需要有多个表

> ID：10922883
> 
> 赞同：2
> 
> 时间：2012-06-06T21:56:15.507
> 
> 标签：php, zend-framework, zend-form

好的，我是 Zend 框架的新手，如果这有点无知，请原谅。

现在我有一个内置在表格中的表格，表格看起来像

```
<table>
  <tr>
    <td><label><input>[Text]</td>
  </tr>
  <tr>
    <td><label><input>[Text]</td>
  </tr>
  <tr>
    <td><label><input>[Text]</td>
  </tr>
</table> 
```

最初建造它的人为我正在为之工作的人们留下了一些东西。这些同样的人现在想要基本上有一个看起来像..

```
<table>
  <tr>
    <td><label><input>[Text]</td>
  </tr>
</table>
<table>
  <tr>
    <td><label><input>[Text]</td>
  </tr>
  <tr>
    <td><label><input>[Text]</td>
  </tr>
  <tr>
    <td><label><input>[Text]</td>
  </tr>
</table> 
```

该表目前通过 foreach 语句推出，因为字段是动态的并且是基于角色的。本质上，代码会吐出一个完整的表单元素数组，然后 foreach 将其构建出来。我对此非常了解。但我的主要问题是，有没有办法打破桌子，可以这么说，然后推出另一个？

总的来说，我想在本质上注入`</tr></table><br><table>`一些方法，以便我可以拥有 2 个不同的表。

***用循环更新*** 我必须排除一些变量和一些类似的东西，作为正在进行的propietray的一部分，所以我不允许在网络上发布任何代码，所以说这是一个最小版本，剥离了任何可能使很明显

```
$form = new form_TableForm(self::CHANGEPREFS);
        $form->setAction($this->_helper->url('saveprefs'));
    foreach ($defaults as $name => $value)
            {
               if ($name == 'xxx1' && (!xxx::eval('xxx','view') || $zzz)) continue;
               if ($name == 'xxx2' && !xxx::eval('xxx','view')) continue;
               if ($name == 'xxx3' && !xxx::eval('xxx','alerts')) continue;
               if ($name == 'xxx4' && !xxx::eval('xxx','alerts')) continue;

               $element = new Zend_Form_Element_Checkbox($name);
               $element->setLabel($this->_helper->Literal->xxx($name));
               if ($value) $element->setValue($value);
               $element->setOptions(array(
                   'required' => false,
                   'fullrow' => true
                   ));
               $form->addElement($element);
               //if($name == 'xxx5'){$form .= "</table><table>";}
               //bad attempt at injection above
            }
        $form->addDisplayGroup(array('savebutton'), 'buttonsgroup', array('fullrow' => true));
        return $form; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T23:40:44.623

It's been a long time since I've used Zend_Form_Decorators but I think the solution will be with those.

A brief overview of Zend_Form and decorators might help.

Zend_Form is sort of the master container of Zend_Form_Element items. These classes have default "decorators" that, when you print the entire Zend_Form object, the class will loop through all the objects and spit out the HTML formatting that's set in it's class.

You can set the decorator HTML when you create your Zend_Form_Element object. In your foreach loop, you're creating the elements so you can do a conditional to modify the specific element that should close/open a new table. But it can be tricky to get to work right due to how Zend_Form generates it's HTML. I recall needing to create a custom decorator because it just wasn't possible to do something fairly easy with the standard decorators.

In your case above, you can't just append some HTML code to the $form object because the $form object is a complex class.

Anyway, enough talk. Try something like this:

```
// create the form element
$element = new Zend_Form_Element_Checkbox($name);
... // same code as above

// do something different for 'special' items
if($name == 'xxx5'){

    $element->setDecorators(array(
        array('ViewHelper'),
        // you might need to do this instead of the above
        // array('ViewHelper', array('helper' => 'formCheckbox')),
        array('HtmlTag', array(
            'tag' => 'table', 
            'placement'=>'APPEND', 
            'closeOnly' => true)),
        array(
            'decorator' => array('My_Alias_HtmlTag' => 'HtmlTag'),
            'options' => array(
                'tag' => 'table', 
                'placement'=>'APPEND', 
                'openOnly' => true)
        ),
    ));
}

// now add the element to the form object
$form->addElement($element); 
```

Let me try to break this down for you.

```
$element->setDecorators( array($d1, $d2, [...]) ); 
```

This sets the decorators for this element. Each decorator ($d1, $d2, etc) is built upon from the previous decorator. Think of it as $d1 is going to spit out an HTML string and then $d2 will append/prepend it's HTML string to $d1.

```
array('ViewHelper'), 
```

This is the default decorator to even get to the element to show. If you don't have this, there will be nothing to show. Each element has a standard decorator. I believe this might include it, but you might need to force the default with:

```
array('ViewHelper', array('helper' => 'formCheckbox')), 
```

Play around with both. At this point the HTML generated should be:

```
<input type="checkbox" /> 
```

or perhaps it will include table row/cell tags. This part I'm a bit rusty on.

```
<tr><td><input type="checkbox" /></td></tr> 
```

If it doesn't, we can get them added by defining them. But lets move on...

```
array('HtmlTag', array(
        'tag' => 'table', 
        'placement'=>'APPEND', 
        'closeOnly' => true)), 
```

"HtmlTag" is a standard decorator that ships with Zend_Framework. It basically allows you to add whatever HTML tag you want. The options I set tell it to use the "table" tag, append it to the previous decorator HTML string, and only use the close tag (</table>).

At this point lets assume we just have the input tag for brevity. We now have:

```
<input type="checkbox" /></table> 
```

Now we want to also add an opening table decorator:

```
array(
        'decorator' => array('My_Alias_HtmlTag' => 'HtmlTag'),
        'options' => array(
            'tag' => 'table', 
            'placement'=>'APPEND', 
            'openOnly' => true)
    ), 
```

This part might be slightly confusing. Zend_Form doesn't allow you to use the same decorator more than once on a given element. The reason is how the code generates. Basically the decorator name is used like a namespace. If you add two of the same decorators, the later one overrides the former one.

To get around this, you can give it an alias name, that's what this bit of code is doing:

```
'decorator' => array('My_Alias_HtmlTag' => 'HtmlTag'), 
```

"My_Alias_HtmlTag" can be anything you want, but following the same rules don't use an Alias name twice. You'll need a new Alias name every time.

The rest of the code should be self evident. I want to append an opening table tag to my current HTML string. The final result should be:

```
<input type="checkbox" /></table><table> 
```

So, when you print out the $form object, when it hits the "specially decorated" elements, it should produce the HTML code above.

Of course, this will take some playing around with. Like I mentioned, I'm a bit rusty with the whole Zend_Form and it's decorators.

There's also a concern that the custom Zend_Form class might be doing unexpected things that might not make this work right.

But give it a try.

I think this blog post by Matthew Weier O'Phinney helped a lot: [http://devzone.zend.com/1240/decorators-with-zend_form/](http://devzone.zend.com/1240/decorators-with-zend_form/)

I hope that helps!

Cheers!

*update*

I had a typo. " 'tag' => 'true' " should have been " 'tag' => 'table'". I updated my previous code.

# javascript - 未捕获的语法错误：意外的标识符？

> ID：10922885
> 
> 赞同：15
> 
> 时间：2012-06-06T21:56:36.157
> 
> 标签：javascript

我似乎无法纠正控制台所说的错误，谁能帮助我。我的代码如下。我创建了一个 Web 表单，将数据保存到本地存储并在屏幕上显示，然后如果需要，可以删除所有存储的数据。但由于某种原因，它根本不会从表单中获取数据。

```
// Wait until the DOM is ready 
window.addEventListener("DOMContentLoaded", function (){
  // getElementById function
  function $(x) {
    var theElement = document.getElementById(x);
    return theElement;
  } // end theElement function

  function makeCats () {
    var formTag = document.getElementsByTagName("form"), // form tag is an array
    selectListItem = $('select'),
    makeSelect = document.createElement('select'),
    makeSelect.setAttribute("id", "groups");
    for(var i=0, j=notesCategories; i<j; i++) {
      var makeOption = document.createElement('option');
      var optionText = notesCategories[i]
      makeOption.setAttribute("value", "optionText");
      makeOption.innerHTML = optionText;
      makeSelect.appendChild(makeOption);
    } // end for loop
    selectListItem.appendChild(makeSelect);
  } // end makeCat function

  function getSelectedRadioBtn() {
    var radio = document.forms[0].favNote 
    for (var i=0; i<radio.length; i++) {
      if(radio[i].checked) {
        favoriteValue = radio[i].value;
      } // end if
    } // end for loop
  } // end get selected radio btn function

  function getcheckedBoxBtn() {
    if($('fav').checked) {
      favoriteValue = $('fav').value;
    } else {
      favoriteValue = "No"
    }
  } // end function

  function toggleControls(a) {
    switch(a){
      case "on":
        $('noteForm').style.display = "none"
        $('clear').style.display = "inline"
        $('displayLink').style.display = "none"
        break
      case "off":
        $('noteForm').style.display = "block"
        $('clear').style.display = "inline"
        $('displayLink').style.display = "inline"
        $('items').style.display = "none"
        break
      default:
        return false;
    }
  }

  function saveNotes() {
    var id                  = Math.floor(Math.random()*1000001);
    // gather up all form fields values and store them in an object 
    // object properites will contain an array with form labels and input values 

    getSelectedRadioBtn(); // calls function
    getcheckedBoxBtn();
    var item                = {}
    item.group          = ["Group", $('groups').value ];
    item.notetitle      = ["Title", $('notetitle').value ];
    item.noteinfo       = ["Note", $('noteinfo').value ];
    item.date           = ["Date", $('date').value ];
    item.items          = ["Number of Itmes", $('items').value ];
    item.attach         = ["Attach a File", $('attach').value ];
    item.favorite       = ["Favorite Note", favoriteValue ];

    // save data into local storage. Use stringify to convert our object to a string 
    localStorage.setItem(id, JSON.stringify(item));

    alert("Note Saved");
  } // end store data function

  function getNotes() {
    toggleControls("on");
    var makeDiv = document.createElement('div');
    makeDiv.setAttribute("id", "items");
    var createList = document.createElement('ul');
    makeDiv.appendChild(createList) // puts createList into ul element created above 
    document.body.appendChild(makeDiv) // attach makeDiv to the document 
    $('items').style.display = "block";
    for(i=0, entries=localStorage.length; i<entries; i++) {
      var createLi = document.createElement('li');
      createList.appendChild(createLi);
      var key = localStorage.key(i);
      var value = localStorage.getItem(key);
      var savedNote = JSON.parse(value); // parse the save note object back into an object 
      var createSubList = document.createElement('ul');
      var createLi.appendChild(createSubList);
      for(a in savedNote) {
        var creatSubListItem = document.createElement('li');
        createSubList.appendChild(creatSubListItem)
        var subText = savedNote[a][0] + " " + savedNote[a][1];
        creatSubListItem.innerHTML = subText;
      } // end for in loop
    } // end for loop
  } // end getNotes function

  function clearNotes() {
    if(localStorage.length === 0){
      alert("Move along buddy, nothing here to clear.");
    } else {
      localStorage.clear()
      alert("All notes are deleted");
      window.location.reload();
      return false;
    } // end if 
  } // end clearNotes function

  // Variables defaults 
  var notesCategories = ["--Choose a Category--       ","Grocery","Fitness","Entertainment","Dining","Shopping","Sports"],
  favoriteValue = "No";
  makeCats();

  // Set links and submits click events 
  var displayLink = $('displayLink');
  displayLink.addEventListener("click", getNotes);
  var clearLink = $('clear');
  clearLink.addEventListener("click", clearNotes);
  var save = $('submit');
  save.addEventListener("click", saveNotes);

}) // end main function 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-06-06T22:05:21.687

这里有错误：

```
var formTag = document.getElementsByTagName("form"), // form tag is an array
selectListItem = $('select'),
makeSelect = document.createElement('select'),
makeSelect.setAttribute("id", "groups"); 
```

代码必须更改为：

```
var formTag = document.getElementsByTagName("form");
var selectListItem = $('select');
var makeSelect = document.createElement('select');
makeSelect.setAttribute("id", "groups"); 
```

顺便说一句，第 129 行还有另一个错误：

```
var createLi.appendChild(createSubList); 
```

将其替换为：

```
createLi.appendChild(createSubList); 
```

# objective-c - 将唯一的强引用设置为 nil 后，弱 NSString 变量不为 nil

> ID：10922888
> 
> 赞同：12
> 
> 时间：2012-06-06T21:57:03.027
> 
> 标签：objective-c, memory-management, nsstring, automatic-ref-counting, weak-references

我对这段代码有疑问：

```
__strong NSString *yourString = @"Your String"; 
__weak NSString *myString = yourString;
yourString = nil;
__unsafe_unretained NSString *theirString = myString;
NSLog(@"%p %@", yourString, yourString);
NSLog(@"%p %@", myString, myString);
NSLog(@"%p %@", theirString, theirString); 
```

我期待所有的指针都`nil`在这个时候，但它们不是，我不明白为什么。第一个（强）指针是`nil`，但其他两个不是。这是为什么？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-06-06T22:03:39.287

**tl; 博士：**问题是字符串文字永远不会被释放，所以你的弱指针仍然指向它。

* * *

# 理论

**强**变量将保留它们指向的值。

**弱**变量不会保留它们的值，当值被释放时，它们会将指针设置为 nil（为了安全起见）。

**不安全的未保留**值（您可能可以从名称中读取）不会保留该值，如果它被释放，他们什么也不做，可能指向一块坏的内存

* * *

## 字面量和常量

当你使用它创建一个字符串时，`@"literal string"`它就变成了一个永远不会改变的字符串文字。如果您在应用程序的许多地方使用相同的字符串，它始终是相同的对象。字符串文字不会消失。使用`[[NSString alloc] initWithString:@"literal string"]`不会有什么不同。因为它变成了指向文字字符串的指针。然而值得注意的是，它的`[[NSString alloc] initWithFormat:@"literal string"];`工作方式不同，并将释放其字符串对象。

### 逐行：

```
__strong NSString *yourString = @"Your String"; 
```

您正在创建一个指向字符串的强指针。这将确保价值不会消失。*在您的情况下，它有点特别，因为字符串是一个字符串文字，在技术上**不会被释放***。

```
__weak NSString *myString = yourString; 
```

您创建一个指向与强指针相同的事物的弱指针。如果此时强指针指向别的东西，它指向的值将被释放，那么弱指针将改变它的值，使其指向`nil`。现在它仍然指向与强指针相同。

```
yourString = nil; 
```

您的强指针指向`nil`。没有任何东西指向旧字符串，所以如果*不是因为它是一个文字字符串，*它应该被释放。如果您尝试对自己创建的其他对象进行完全相同的操作，那么弱变量将更改为指向`nil`. 但是，由于字符串文字是文字并且不会消失。弱变量仍将指向它。

```
__unsafe_unretained NSString *theirString = myString; 
```

创建了一个新的未保留指针，指向指向字符串文字的弱指针。

```
NSLog(@"%p %@", yourString, yourString);
NSLog(@"%p %@", myString, myString);
NSLog(@"%p %@", theirString, theirString); 
```

你打印了所有的字符串，并感到困惑为什么第一个值是`nil`，而其他两个不是。

* * *

## 相关阅读：

[字符串常量和字符串文字有什么区别？](https://stackoverflow.com/a/25798/608157)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-04T18:02:28.120

大卫的回答是 100% 正确的。[我刚刚使用GHUnit](http://gabriel.github.com/gh-unit/)添加了四个显式示例。

## 对象引用的生命周期限定符行为。

作为`NSObject`所有对象的代理，生命周期限定符的行为符合预期。

```
- (void) test_usingNSObjects
{
    NSObject *value1 = [[NSObject alloc] init];
    NSObject *value2 = [[NSObject alloc] init];
    NSObject *value3 = [[NSObject alloc] init];
    __strong NSObject *sRefToValue = value1;
    __weak NSObject *wRefToValue = value2;
    __unsafe_unretained NSObject *uRefToValue = value3;

    value1 = value2 = value3 = nil;

    GHAssertNotNil(sRefToValue,
                   @"Strong reference to the object that was originally \
                   assigned to value1\.  Even though value1 was set to nil, the \
                   strong reference to the object keeps the object from being \
                   destroyed.");

    GHAssertNil(wRefToValue,
                @"Weak reference to the object that was originally assigned to \
                value2\.  When value2 was set to nil, the weak reference does \
                not prevent the object from being destroyed. The weak \
                reference is also set to nil.");

    // Removing the #ifdef and #endif lines will result in a EXC_BAD_ACCESS
    // signal.  Receiving a EXC_BAD_ACCESS signal is the expected behavior for
    // that code.
#ifdef RECIEVE_EXC_BAD_ACCESS
    GHAssertNotNil(uRefToValue,
                   @"Unsafe unretained reference to the object that was \
                   originally assigned to value3\.  When value3 was set to nil, \
                   the unsafe unretained reference does not prevent the object \
                   from being destroyed. The unsafe unretained reference is \
                   unaltered and the reference is invalid.  Accessing the \
                   reference will result in EXC_BAD_ACCESS signal.");
#endif

    // To avoid future EXC_BAD_ACCESS signals.
    uRefToValue = nil;
} 
```

## `NSString`文字s (@"something")的生命周期限定符行为。

这与 基本相同`test_usingNSObjects`，但不是使用 a `NSObject`，而是使用`NSString`分配了文字字符串的 a 。由于文字字符串不会像其他对象一样被破坏，因此可以观察到变量`__weak`和`__unsafe_unretained`变量的不同行为。

```
- (void) test_usingLiteralNSStrings
{
    NSString *value1 = @"string 1";
    NSString *value2 = @"string 2";
    NSString *value3 = @"string 3";
    __strong NSString *sRefToValue = value1;
    __weak NSString *wRefToValue = value2;
    __unsafe_unretained NSString *uRefToValue = value3;

    value1 = value2 = value3 = nil;

    GHAssertNotNil(sRefToValue,
                   @"Strong reference to the object that was originally \
                   assigned to value1\.  Even though value1 was set to nil, \
                   literal strings are not destroyed.");

    GHAssertNotNil(wRefToValue,
                   @"Weak reference to the object that was originally assigned \
                   to value2\.  Even though value2 was set to nil, \
                   literal strings are not destroyed so the weak reference is \
                   still valid.");

    GHAssertNotNil(uRefToValue,
                   @"Unsafe unretained reference to the object that was \
                   originally assigned to value3\.  Even though value3 was set \
                   to nil, literal strings are not destroyed so the unsafe \
                   unretained reference is still valid.");
} 
```

## 非文字 s的生命周期限定符行为`NSString`。

这与 基本相同`test_usingNSObjects`，但不是使用 a `NSObject`，而是使用`NSString`分配了非文字字符串的 a 。由于非文字字符串像其他对象一样被销毁，因此行为与在 中观察到的相同`test_usingNSObjects`。

```
- (void) test_usingNonliteralNSStrings
{
    NSString *value1 = [[NSString alloc] initWithFormat:@"string 1"];
    NSString *value2 = [[NSString alloc] initWithFormat:@"string 2"];
    NSString *value3 = [[NSString alloc] initWithFormat:@"string 3"];
    __strong NSString *sRefToValue = value1;
    __weak NSString *wRefToValue = value2;
    __unsafe_unretained NSString *uRefToValue = value3;

    value1 = value2 = value3 = nil;

    GHAssertNotNil(sRefToValue,
                   @"Strong reference to the object that was originally \
                   assigned to value1\.  Even though value1 was set to nil, the \
                   strong reference to the object keeps the object from being \
                   destroyed.");

    GHAssertNil(wRefToValue,
                @"Weak reference to the object that was originally assigned to \
                value2\.  When value2 was set to nil, the weak reference does \
                not prevent the object from being destroyed. The weak \
                reference is also set to nil.");

    // Removing the #ifdef and #endif lines will result in a EXC_BAD_ACCESS
    // signal.  Receiving a EXC_BAD_ACCESS signal is the expected behavior for
    // that code.
#ifdef RECIEVE_EXC_BAD_ACCESS
    GHAssertNotNil(uRefToValue,
                   @"Unsafe unretained reference to the object that was \
                   originally assigned to value3\.  When value3 was set to nil, \
                   the unsafe unretained reference does not prevent the object \
                   from being destroyed. The unsafe unretained reference is \
                   unaltered and the reference is invalid.  Accessing the \
                   reference will result in EXC_BAD_ACCESS signal.");
#endif

    // To avoid future EXC_BAD_ACCESS signals.
    uRefToValue = nil;
} 
```

## `NSString`创造 - 文字与非文字。

显示以各种方式创建的字符串，无论它们是文字还是非文字。

```
- (void) test_stringCreation
{
    NSString *literalString = @"literalString";
    NSString *referenced = literalString;
    NSString *copy = [literalString copy];
    NSString *initWithString = [[NSString alloc] initWithString:literalString];
    NSString *initWithFormat = [[NSString alloc] initWithFormat:@"%@", literalString];

    // Testing that the memory addresses of referenced objects are the same.
    GHAssertEquals(literalString, @"literalString", @"literal");
    GHAssertEquals(referenced, @"literalString", @"literal");
    GHAssertEquals(copy, @"literalString", @"literal");
    GHAssertEquals(initWithString, @"literalString", @"literal");
    GHAssertNotEquals(initWithFormat, @"literalString",
                      @"nonliteral - referenced objects' memory addresses are \
                      different.");

    // Testing that the objects referenced are equal, i.e. isEqual: .
    GHAssertEqualObjects(literalString, @"literalString", nil);
    GHAssertEqualObjects(referenced, @"literalString", nil);
    GHAssertEqualObjects(copy, @"literalString", nil);
    GHAssertEqualObjects(initWithString, @"literalString", nil);
    GHAssertEqualObjects(initWithFormat, @"literalString", nil);

    // Testing that the strings referenced are the same, i.e. isEqualToString: .
    GHAssertEqualStrings(literalString, @"literalString", nil);
    GHAssertEqualStrings(referenced, @"literalString", nil);
    GHAssertEqualStrings(copy, @"literalString", nil);
    GHAssertEqualStrings(initWithString, @"literalString", nil);
    GHAssertEqualStrings(initWithFormat, @"literalString", nil);
} 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-05-08T14:41:30.630

弱属性只会在自动释放池耗尽后设置为零。

尝试：

```
@autoreleasepool {
    _strong NSString *yourString = @"Your String"; 
    __weak NSString *myString = yourString;
    yourString = nil;
    __unsafe_unretained NSString *theirString = myString;
}

NSLog(@"%p %@", yourString, yourString);
NSLog(@"%p %@", myString, myString);
NSLog(@"%p %@", theirString, theirString); 
```

# jquery - 使用 jQuery 获取孩子的最大高度值，然后将该高度值应用于所有孩子

> ID：10922889
> 
> 赞同：11
> 
> 时间：2012-06-06T21:57:15.380
> 
> 标签：jquery

我意识到在大多数情况下 CSS 是实现均匀高度元素的最佳方式。但是，在某些情况下，我们正在处理我们无法完全控制的页面或 CMS，我认为 jQuery 解决方案会非常方便。

我想知道如何在 jQuery 中实现以下目标。我对 jQuery 语法不是很熟悉，但这是我淡化的伪 jQuery / 英语语法……这有意义吗，还是有更简单的方法来实现这一点？我意识到以下代码根本不起作用，这只是我试图为解决方案做出贡献的方式，并在逻辑部门投入一点：

```
$('div.columns')each.get.height;
create an array of the height values
grab the largest value in this array
$('div.columns')each.css(height: $max-height); 
```

一旦你停止嘲笑我的伪代码，有什么想法吗？谢谢！！

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-06-06T22:05:27.813

尝试这样的事情：

```
var maxHeight = -1;
$('div.columns').each(function() {
    if ($(this).height() > maxHeight) {
        maxHeight = $(this).height();
    }
});
$('div.columns').height(maxHeight); 
```

**注意：**这是未经测试的代码。但它应该为您准备好基本概念。您最初的概念很接近，但如果您只想保留最大高度值，则此处不需要数组。

# ruby-on-rails - Rails：使用哈希填写表单值

> ID：10922891
> 
> 赞同：1
> 
> 时间：2012-06-06T21:57:28.017
> 
> 标签：ruby-on-rails, forms

我正在使用哈希来填写一些表格。其中之一是用户信息。我在用户注册表单中成功使用了这个哈希。想法是使用相同的 Hash 来填写编辑表单，如下：

```
<% NEW_USER_HASH.each do |column_name,field_info|  %>
    <div class="field">
      <% if field_info["type"] != "hidden_field" %>
          <%= f.label field_info["label"] %>
      <% end %>
      <%= f.send(field_info["type"].to_sym, column_name , :value => @user.column_name) %>
    </div>
<% end %> 
```

但我收到以下错误消息：

```
undefined method `column_name' 
```

我尝试了以下变体，结果相同：

```
:value => @user.column_name.to_s
:value => @user.column_name.to_sym 
```

有任何想法吗？

# 回答：

column_name 不是@user 方法，所以答案是使用 send 方法，以变量 column_name 作为参数。

所以，替换：

```
:value => @user.column_name 
```

和

```
:value => @user.send(column_name) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T23:37:17.490

I think the culprit is `@user.column_name`. One way is to use eval("@user." + column_name). Better way is what I have shown below.

Try this:

```
<% NEW_USER_HASH.each do |column_name,field_info|  %>
    <div class="field">
      <% if field_info["type"] != "hidden_field" %>
          <%= f.label field_info["label"] %>
      <% end %>
      <%= f.send(field_info["type"].to_sym, column_name , :value => @user.send(column_name)) %>
    </div>
<% end %> 
```

Let me know if this works.

Good luck!

# macos - 在商业原生 Cocoa 应用程序中使用 Google Web 字体？

> ID：10922896
> 
> 赞同：14
> 
> 时间：2012-06-06T21:57:49.940
> 
> 标签：macos, cocoa, webfonts, google-webfonts, custom-font

**Google Web 字体**可以在 OS X 上的**商业原生 Cocoa**应用程序中合法使用吗？谷歌官方表示可以在商业网站上免费使用这些字体，但没有具体说明原生应用程序的情况。

目前，我已经`woff`从 CSS 中定义的 URL 下载了字体（格式），通过在线工具将其转换为`ttf`并包含在我的项目中。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-18T07:54:56.567

来自[http://www.google.com/webfonts/#AboutPlace:about](http://www.google.com/webfonts/#AboutPlace:about)

“所有字体都是开源的。这意味着您可以自由地与朋友和同事分享您的最爱。您甚至可以自定义它们以供自己使用，或者与原始设计师合作改进它们。您可以在以您想要的各种方式，无论是私下还是商业上——印刷、计算机或网站上。”

# maven - 如何在maven项目中公开依赖项的依赖项

> ID：10922897
> 
> 赞同：0
> 
> 时间：2012-06-06T21:57:51.137
> 
> 标签：maven, dependency-management

我有一个 Maven Web 应用程序，它使用我创建的 jar，并在我的 pom 文件中作为依赖项引用。

我创建的 jar 文件有另一个 jar 文件作为依赖项。

当我部署 Web 应用程序时，它说找不到我创建的 jar 文件的依赖项中的类。

解决此问题的唯一方法是将 jar 文件的依赖项添加为 war 文件的依赖项。这似乎是不必要的。

有没有办法可以配置war文件以查看依赖jar文件的依赖项中定义的类？

我的 jar pom 文件看起来像： 具有无法找到的类的依赖项是 QRS 之一。

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
     xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
<modelVersion>4.0.0</modelVersion>
<groupId>group</groupId>
<artifactId>artifact</artifactId>
<packaging>jar</packaging>
<version>1.0.7</version>
<name>name</name>
<dependencies>
    <dependency>
        <groupId>group2</groupId>
        <artifactId>QRS</artifactId>
        <version>8.1</version>
    </dependency>
</dependencies>
    <build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-jar-plugin</artifactId>
            <version>2.3</version>
            <configuration>
                <archive>
                    <manifest>
                        <addClasspath>true</addClasspath>
                        <classpathPrefix>lib</classpathPrefix>
                    </manifest>
                </archive>
            </configuration>
        </plugin>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-dependency-plugin</artifactId>
            <executions>
                <execution>
                    <id>copy-dependencies</id>
                    <phase>prepare-package</phase>
                    <goals>
                        <goal>copy-dependencies</goal>
                    </goals>
                    <configuration>
                        <outputDirectory>${project.build.directory}/classes/lib</outputDirectory>
                        <overWriteReleases>false</overWriteReleases>
                        <overWriteSnapshots>false</overWriteSnapshots>
                        <overWriteIfNewer>true</overWriteIfNewer>
                    </configuration>
                </execution>
            </executions>
        </plugin> 
```

我的战争 pom 看起来像：

```
 <dependency>
        <groupId>group</groupId>
        <artifactId>artifact</artifactId>
        <version>1.0.7</version>
    </dependency> 
```

并且配置了war插件：

```
 <plugin>
            <dependencies>
                <dependency>
                    <groupId>org.apache.maven.plugins</groupId>
                    <artifactId>maven-war-plugin</artifactId>
                    <version>2.2</version>
                </dependency>
            </dependencies>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-war-plugin</artifactId>
            <version>2.2</version>
            <configuration>
                <warName>${project.name}-${project.version}-${env}</warName>
                <webResources>
                    <resource>
                        <directory>src/main/webapp/WEB-INF</directory>
                        <filtering>true</filtering>
                        <include>jboss-web.xml</include>
                        <include>web.xml</include>
                        <targetPath>/WEB-INF</targetPath>
                    </resource>
                </webResources>
                <warSourceExcludes>**/toAggregateAndRemove/**</warSourceExcludes>
                <goal>war:manifest</goal>
                <archive>
                    <manifest>
                        <addClasspath>true</addClasspath>
                        <classpathPrefix>lib/</classpathPrefix>
                    </manifest>
                </archive>
            </configuration>
        </plugin> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T21:59:09.173

Maven 已经解决了传递依赖。

这并不表明您可能做得不对：您创建的另一个 jar 应该是一个带有自己的 pom 的 Maven 项目，至少在本地通过 安装`mvn install`，并在第二个项目中列为依赖项（第一个使用它）。

使用 jar 的项目只需要指定该工件作为其依赖项，其他项目的依赖项将被传递确定并包含为项目依赖项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T04:46:37.743

@Dave Newton 已经回答，这应该默认发生。

从问题中的片段中得到一些观察 - 如果这有帮助......

*   将依赖的 jar 打包为`artifact`项目 jar 的文件夹。

*   将 maven 战争插件 jar 本身定义`dependency`为 maven 战争插件 - 这根本不是必需的！

*   `war:manifest`Maven 战争插件配置中的目标。

实际制造战争的可能`war:war`没有运行。

# c - 在 C 中打印新行之前是否可以等待几秒钟？

> ID：10922900
> 
> 赞同：24
> 
> 时间：2012-06-06T21:57:56.647
> 
> 标签：c, time, line

例如，我可以让它输入类似

```
"Hello"
"This"
"Is"
"A"
"Test" 
```

每条新线之间有 1 秒的间隔？

谢谢，

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-06-06T22:14:46.927

好吧，`sleep()`功能做到了，有几种使用方法；

在 Linux 上：

```
#include <stdio.h>
#include <unistd.h> // notice this! you need it!

int main(){
    printf("Hello,");
    sleep(5); // format is sleep(x); where x is # of seconds.
    printf("World");
    return 0;
} 
```

在 Windows 上，您可以像这样使用 dos.h 或 windows.h：

```
#include <stdio.h>
#include <windows.h> // notice this! you need it! (windows)

int main(){
    printf("Hello,");
    Sleep(5); // format is Sleep(x); where x is # of milliseconds.
    printf("World");
    return 0;
} 
```

或者您可以将 dos.h 用于 linux 风格的睡眠，如下所示：

```
#include <stdio.h>
#include <dos.h> // notice this! you need it! (windows)

int main(){
    printf("Hello,");
    sleep(5); // format is sleep(x); where x is # of seconds.
    printf("World");
    return 0;
} 
```

这就是你在 Windows 和 linux 上都睡在 C 中的方式！对于 Windows，这两种方法都应该有效。只需将 # of seconds 的参数更改为您需要的参数，然后在需要暂停的地方插入，就像我一样在 printf 之后。*另外，注意：使用windows.h时，请记住`S`sleep中的大写，也就是毫秒！（感谢克里斯指出这一点）*

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-06T22:19:10.163

不如 sleep() 优雅的东西，但使用标准库：

```
/* data declaration */
time_t start, end;

/* ... */

/* wait 2.5 seconds */
time(&start);
do time(&end); while(difftime(end, start) <= 2.5); 
```

我将为您找出正确的标题 ( `#include`)和`time_t`，以及它们的含义。这是乐趣的一部分。:-)`time()``difftime()`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-06T22:06:27.303

您可以查看将线程挂起指定秒数的[sleep() 。](http://pubs.opengroup.org/onlinepubs/009604599/functions/sleep.html)

* * *

## 回答 #4

> 赞同：-7
> 
> 时间：2012-06-06T22:25:21.190

适用于所有操作系统

```
int main()
{
char* sent[5] ={"Hello ", "this ", "is ", "a ", "test."};
int i =0;
while( i < 5 )
{
printf("%s", sent[i] );
int c =0, i++;
while( c++ < 1000000 ); // you can use sleep but for this you dont need #import
} 
return 0;
} 
```

# php - PHP 扩展类和同级访问

> ID：10922907
> 
> 赞同：2
> 
> 时间：2012-06-06T21:58:29.577
> 
> 标签：php, class, extends, siblings

好的，所以我试图弄清楚如何最有效地构建我的代码。我最近将它从一个包含我所有方法的巨型类文件转换为与一个基类组合的更小文件。这就是我想要的，但是我无法让它正常工作，我需要一些关于结构的帮助。

基本上我需要这样做：

*   会有一些函数只是其他类的“工具”（例如转换器函数等）——它们需要所有子类都可以访问。
*   在某些情况下，“子类一”需要使用“子类二”的函数。
*   子类需要能够设置另一个子类可以看到的变量。

请让我知道如何开始满足这些要求；代码示例将不胜感激！

也许一些伪代码会有所帮助 - 但如果我离开，请告诉我什么会更好！

```
class main {
    private $test;
    public function __construct() {
        //do some stuff
    }
    public function getTest() {
        echo('public call: '.$this->test);
    }
    private function randomFunc(){
        echo('hello');
    }
}
class child1 extends main {
    public function __construct() {
        parent::$test = 'child1 here';
    }
}
class child2 extends main {
    public function __construct() {
        echo('private call: '.parent::$test); //i want this to say "private call: child1 here"
        parent::randomFunc();
    }
}
$base = new main;
new child1;
new child2;
$base->getTest(); 
```

所以我希望结果是：

```
private call: child1 here
hello
public call: child1 here 
```

到目前为止，我尝试过的方法不起作用...请帮助！谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T22:15:59.023

第一点：

对于 Helper 类，您可以选择将方法设为静态，因此您不需要实例：

```
class Helper
{
  public static function usefulMethod()
  {
     // do something useful here
  }
} 
```

现在可以像这样从任何地方访问：

```
Helper::usefulMethod() 
```

* * *

接下来的几点需要进一步解释，我将其作为注释添加到您的伪代码中：

```
// always start your class names with upper case letter, it's a good convention
class Main
{
    // don't make this private if you want to access from the child classes too
    // private $test;

    // instead make it protected, so all sub classes can derive
    protected $test;

    public function __construct()
    {
        //do some stuff
    }

    public function getTest()
    {
        echo 'public call: '.$this->test;
    }

    private function randomFunc()
    {
        echo 'hello';
    }
}

class Child1 extends Main
{
    public function __construct()
    {
        // $test is now derived from the parent into the sub class
        $this->test = 'child1 here';
    }
}

class Child2 extends Main
{
    public function __construct()
    {
        // this doesn't quite work like expected:
        // echo 'private call: '.$this->test; //i want this to say "private call: child1 here"

        // because this isn't a reference, but think of every class instance
        // as a container which holds its own properties and methods (variables and functions)
        // if you really want to do it like intended then you would need a subclass from main1
        // but that is kind of strange, I don't know exactly what you want to achieve

        // this will print out 'hello' as expected
        parent::randomFunc();
    }
} 
```

我确信这并不能完全回答所有问题，但我已尽力而为。也许你可以进一步提出你的意图

# python - 发布带有线程类的模块并控制它们 python

> ID：10922908
> 
> 赞同：0
> 
> 时间：2012-06-06T21:58:30.590
> 
> 标签：python, multithreading, module, command-line-arguments

基本上我正在构建一个应用程序，它有几个编号选项供您选择。

它被命名为*main.py*，我为每个可能的选项编写了独立的模块，这样我就可以单独运行这些模块。现在我写的这个模块它包含一个线程类。我在命令时遇到的一个问题：`python mod_keepOnline.py`它没有将控制权传回终端|AND| 当我通过 main.py 运行模块*时*，*main.py*停止监听新的选择。我知道这是因为线程。我想知道如何“让线程在它们产生后自行管理”。因此，从`mod_keepOnline.py`终端或主脚本中获得控制权。

我也希望能够再次杀死释放的线程。

就像是`mod_keepOnline.py -killAll`

嗯，这是我的代码：

```
###########################################
################## SynBitz.net ############
import threading
import objects
import time
import mechanize
import os
import gb
##########################################
class Class_putOnline (threading.Thread):
    def __init__ (self,person,onlineTime):
        threading.Thread.__init__ (self)
        self.startTime = time.time()
        self.alive = True
        self.person = person
        self.onlineTime = onlineTime
        self.firstMessage=True
    def run(self):
        while(self.alive):
            if(self.firstMessage):
                print self.person.getInfo() + " SPAWNED ONLINE"
                self.firstMessage=False

            self.person.login()
            time.sleep(300)
            self.person.logout()
            if((time.time()-self.startTime) > self.onlineTime):
                print self.person.getInfo() + " SPAWNED OFFLINE "
                self.alive = False
                self._Thread__stop()
#########################################              
def main():
    for line in open(gb.accFile,"r"):
        gb.accountList.append(line.rstrip('\n'))
    for account in gb.accountList:
        gb.accountInfo = account.split('|',4)
        browser =  mechanize.Browser()
        browser.set_handle_robots(False)
        browser.set_handle_redirect(True)
        browser.set_handle_referer(True)
        browser.addheaders = [('User-agent', 'Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.1) Gecko/2008071615 Fedora/3.0.1-1.fc9 Firefox/3.0.1')]  
        gb.spiderList.append(objects.spider.Bot(gb.accountInfo[0],gb.accountInfo[2],gb.accountInfo[1],gb.accountInfo[3],browser))
    if gb.accountInfo[2] not in gb.distros:
        gb.distros.append(gb.accountInfo[2])
    onlineAccounts = []
    for index, acc in enumerate(gb.spiderList):
        onlineAccounts.append(Class_putOnline(acc,115200)) # 600*6*8*4= 28800 = 8 uur 3600 test seconds = 1 h (1200 seconds for test time of 20 minutes...  )
        time.sleep(0.1)
        onlineAccounts[index].start()

if __name__ == "__main__":
    main() 
```

当我打开到我的服务器的 ssh 会话并运行 python 脚本时，即使我在后台运行它，它也会在我关闭会话后死掉。未连接时如何保持脚本运行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T20:53:35.713

我认为：

当你运行一个进程时，终端的输入和输出被重定向到进程的输入和输出。

如果你启动线程，这不会改变任何东西。只要两者都存在，该进程就有终端输入和输出。您可以做的是将此程序发送到后台（使用 control-z）。

如果你运行一个程序，它有自己的命名空间。您可以导入一个模块并更改它的属性，但这永远不会更改另一个程序中的模块。

如果你想拥有两个程序，一个在后台运行所有进程（例如，Tyson 建议的作业），一个来自命令行，你需要在这两个进程之间进行通信。

也许还有其他方法可以绕过流程的边界，但我不知道。

因此我写了这个模块，我可以在其中存储值。每次直接存储值时，模块的状态都会保存到磁盘。

```
'''
This is a module with persistent attributes

the attributes of this module are spread all over all instances of this module
To set attributes:
    import runningConfiguration
    runningConfiguration.x = y

to get attributes:
    runningConfiguration.x

'''

import os
import types
import traceback

fn = fileName = fileName = os.path.splitext(__file__)[0] + '.conf'

class RunningConfiguration(types.ModuleType):

    fileName = fn

    def __init__(self, *args, **kw):
        types.ModuleType.__init__(self, *args, **kw)
        import sys
        sys.modules[__name__] = self
        self.load()

    def save(self):
        import pickle
        pickle.dump(self.__dict__, file(self.fileName, 'wb'))

    def load(self):
        import pickle
        try:
            dict = pickle.load(file(self.fileName, 'rb'))
        except EOFError:
            pass
        except:
            import traceback
            traceback.print_exc()
        else:   
            self.__dict__.update(dict)

    def __setattr__(self, name, value):
##        print 'set', name, value,
        l = []
        v1 = self.__dict__.get(name, l)
        self.__dict__[name] = value
        try:
            self.save()
##            print 'ok'
        except:
            if v1 is not l:
                self.__dict__[name] = v1
            raise

    def __getattribute__(self, name):
        import types
        if name in ('__dict__', '__class__','save','load','__setattr__',                    '__delattr__', 'fileName'):
            return types.ModuleType.__getattribute__(self, name)
##        print 'get', name
        self.load()
        l = []
        ret = self.__dict__.get(name, l)
        if ret is l:
            if hasattr(self.__class__, name):
                return getattr(self.__class__, name)
            if name in globals():
                return globals()[name]
            raise AttributeError('%s object has no attribute %r' %                                  (self.__class__.__name__, name))
        return ret

    def __delattr__(self, name):
        del self.__dict__[name]
        self.save()

RunningConfiguration(__name__) 
```

我将它保存到 runningConfiguration.py。

你可以像这样使用它：

```
# program1
import runningConfiguration
if not hasattr(runningConfiguration, 'programs'):
    runningConfiguration.programs = [] ## variable programs is set
runningConfiguration.programs+= ['program1'] ## list is changed and = is used -> module is saved 
```

这是一个不安全的模块，并不是所有的东西都可以保存到它，但很多东西。此外，当两个模块同时保存时，第一个写入的值可能会丢失。

试试看：从两个不同的程序中导入 ist 并查看它的行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T22:11:59.403

> 当我打开到我的服务器的 ssh 会话并运行 python 脚本时，即使我在后台运行它，它也会在我关闭会话后死掉。未连接时如何保持脚本运行？

将其作为 cronjob 运行，如果您需要按需运行脚本，请手动启动 cronjob。

> 好的，我对 python 很陌生

我也是。

编辑：快速提示，使用 """ 进行长评论。

例子：

“““描述：

这做这个和那个，并扩展这个和那个。像这样那样使用它。

"""

# iphone - insertSubView:belowSubview: 用于 UIImageView

> ID：10922911
> 
> 赞同：1
> 
> 时间：2012-06-06T21:58:34.297
> 
> 标签：iphone, ios, uiview, uiimageview, addsubview

如果可以使用 insertSubView:belowSubview: 我很伤心，因为下面的代码正在抛出这个警告错误

```
Incompatible pointer types sending 'UIImage *__strong' to parameter of type 'UIView *' 
```

我希望也许我做错了什么你们可以看到，因为我能想到的唯一其他方法是将 UIImageView 放入 UIView ......请告诉我有更好的方法.. 哈哈

下面的代码。

```
UIImage *shadowImage = [UIImage imageNamed: @"shade.png"];
UIImageView *shadowImageView = [[UIImageView alloc] initWithImage:shadowImage];

[otherNav.view addSubview:shadowImageView];
[otherNav.view insertSubview:shadowImage belowSubview:animatedActionView]; 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T22:00:57.817

尝试这个

```
[otherNav.view insertSubview:shadowImageView belowSubview:animatedActionView]; 
```

因为第一个参数必须是一个View或者uiview的子类

在您的情况下，您尝试传递不是 UIView 或 UIview 子类的 UIImage

# visual-studio - Visual Studio Express 2012 Editions - Exe 名称和注册表路径？

> ID：10922913
> 
> 赞同：3
> 
> 时间：2012-06-06T21:58:43.183
> 
> 标签：visual-studio, express, visual-studio-2012

简而言之，我正在寻找每个 Visual Studio 2012 Express 版本的 InstallDir 键的**可执行名称**和**注册表路径。**

它们是（减去 RC 标签）

*   适用于 Windows 8 的 Visual Studio Express 2012
*   适用于 Web 的 Microsoft Visual Studio Express 2012
*   Visual Studio 团队基础服务器速成版 2012

注册表路径将位于 HKLM 配置单元中，类似于：

> {HKLM}\软件\微软\????\11.0

如果可以使用以前版本的 VS Express，则每个版本的可执行文件名称可能不同。

为了完整起见，这里是从 2002 年到 2012 年的每个以前版本的 Visual Studio .Net 的、`edition number`和。`version``solution version``HKLM relative registry path`

```
public class VSType
{
    public VSType(){}
    public VSType(string edition, string version, string solutionVersion, string hklmRegistryPath) {/*...*/}
    public static VSType VS2002 = new VSType("2002", "7.0", "7.00", "SOFTWARE\\Microsoft\\VisualStudio\\7.0");
    public static VSType VS2003 = new VSType("2003", "7.10", "8.00", "SOFTWARE\\Microsoft\\VisualStudio\\7.1");
    public static VSType VS2005 = new VSType("2005", "8.0", "9.00", "SOFTWARE\\Microsoft\\VisualStudio\\8.0");
    public static VSType VS2008 = new VSType("2008", "9.0", "10.00", "SOFTWARE\\Microsoft\\VisualStudio\\9.0");
    public static VSType VS2010 = new VSType("2010", "10.0", "11.00", "SOFTWARE\\Microsoft\\VisualStudio\\10.0");
    public static VSType VS2012 = new VSType("2012", "11.0", "12.00", "SOFTWARE\\Microsoft\\VisualStudio\\11.0");
}

public class VSExpressType : VSType
{
    public VSExpressType(VSType vsType, string name, string exeName, string hklmRegistryPath) {/*...*/}

    // 2005  ***********************************************************************
    public static VSExpressType VSExpress2005CSharp = new VSExpressType(VS2005,
        "Microsoft Visual C# 2005 Express Edition",
        "VCSExpress.exe",
        "SOFTWARE\\Microsoft\\VCSExpress\\8.0");

    public static VSExpressType VSExpress2005VB = new VSExpressType(VS2005,
        "Microsoft Visual Basic 2005 Express Edition",
        "vbexpress.exe",
        "SOFTWARE\\Microsoft\\VBExpress\\8.0");

    public static VSExpressType VSExpress2005Web = new VSExpressType(VS2005,
        "Microsoft Visual Web Developer 2005 Express Edition",
        "VWDExpress.exe",
        "SOFTWARE\\Microsoft\\VWDExpress\\8.0");

    // 2008  ***********************************************************************
    public static VSExpressType VSExpress2008CSharp = new VSExpressType(VS2008,
        "Microsoft Visual C# 2008 Express Edition",
        "VCSExpress.exe",
        "SOFTWARE\\Microsoft\\VCSExpress\\9.0");

    public static VSExpressType VSExpress2008VB = new VSExpressType(VS2008,
        "Microsoft Visual Basic 2008 Express Edition",
        "vbexpress.exe",
        "SOFTWARE\\Microsoft\\VBExpress\\9.0");

    public static VSExpressType VSExpress2008Web = new VSExpressType(VS2008,
        "Microsoft Visual Web Developer 2008 Express Edition",
        "VWDExpress.exe",
        "SOFTWARE\\Microsoft\\VWDExpress\\9.0");

    // 2010  ***********************************************************************
    public static VSExpressType VSExpress2010CSharp = new VSExpressType(VS2010,
        "Microsoft Visual C# 2010 Express Edition",
        "VCSExpress.exe",
        "SOFTWARE\\Microsoft\\VCSExpress\\10.0");

    public static VSExpressType VSExpress2010VB = new VSExpressType(VS2010,
        "Microsoft Visual Basic 2010 Express Edition",
        "vbexpress.exe",
        "SOFTWARE\\Microsoft\\VBExpress\\10.0");

    public static VSExpressType VSExpress2010Web = new VSExpressType(VS2010,
        "Microsoft Visual Web Developer 2010 Express Edition",
        "VWDExpress.exe",
        "SOFTWARE\\Microsoft\\VWDExpress\\10.0");

    // 2012 ***********************************************************************
    public static VSExpressType VSExpress2012WIn8 = new VSExpressType(VS2012,
        "Visual Studio Express 2012 for Windows 8",
        "EXENAME",
        "SOFTWARE\\Microsoft\\REGISTRYPATH");

    public static VSExpressType VSExpress2012Web = new VSExpressType(VS2012,
        "Microsoft Visual Studio Express 2012 for Web",
        "EXENAME",
        "SOFTWARE\\Microsoft\\REGISTRYPATH");

    public static VSExpressType VSExpressTFS2012 = new VSExpressType(VS2012,
                "Visual Studio Team Foundation Server Express 2012",
                "EXENAME",
                "SOFTWARE\\Microsoft\\REGISTRYPATH");
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T11:27:20.770

**适用于 Windows 8 的 Visual Studio Express 2012**

*   exe名称：`VSWinExpress.exe`
*   注册路径：`{HKLM}\\SOFTWARE\\Microsoft\\VSWinExpress\\11.0`

**适用于 Web 的 Microsoft Visual Studio Express 2012**

*   exe名称：`VWDExpress.exe`
*   注册路径：`{HKLM}\\SOFTWARE\\Microsoft\\VWDExpress\\11.0`

**Visual Studio 团队基础服务器速成版 2012**

*   ExeName：`TfsMgmt.exe`用于管理控制台
*   注册路径：`{HKLM}\\SOFTWARE\\Microsoft\\TeamFoundationServer\\11.0`

请注意，没有`InstallDir`直接在 TFS\11 路径下。取而代之的是一个`InstalledComponents`节点，其中包含已安装的组件列表和每个组件的 InstallPath 密钥。

另请注意，在 64 位 PC 上，密钥将位于`{HKLM}\\SOFTWARE\\Wow6432Node\\`节点下方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-09T19:06:05.433

1.  Windows Phone：“C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE\VPDExpress.exe”
2.  桌面：“C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE\WDExpress.exe”

# eclipse - 在 Eclipse 中向工具栏添加/重新添加按钮？

> ID：10922919
> 
> 赞同：11
> 
> 时间：2012-06-06T21:59:11.427
> 
> 标签：eclipse, toolbar

我不小心删除了eclipse中的“创建新类”按钮。我怎样才能把它放回顶部工具栏？我浏览了所有菜单，但找不到选项。

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-06T22:08:13.600

只需右键单击您的透视图（右上角默认）并选择自定义。

在那里您可以选择和取消选择工具栏图标。Java 元素创建 -> 新建 Java 项目/包/类

高频

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-09-23T08:55:09.617

在 eclipse 4.4 中，选择**Window->Customize perspective**。第一个选项卡（**工具栏可见性**）允许自定义工具栏按钮。

# ms-access - Access 2007 链接表管理器为一个用户禁用 - 和错误 8458

> ID：10922922
> 
> 赞同：0
> 
> 时间：2012-06-06T21:59:30.700
> 
> 标签：ms-access, ms-access-2007

我有一个 Access 前端数据库连接到各种后端（Access、mySQL、dBase），它在每个用户计算机上作为单独的实例运行。所有用户都有Access 2007，本系统共有5个用户。每个用户都从他们的本地硬盘驱动器运行数据库。

在一台计算机上，我无法打开任何链接表并收到错误消息“来自外部数据库驱动程序 (8458) 的意外错误”。另外，我注意到右键单击表链接定义时，链接表管理器被禁用（灰显）。

奇怪的是，如果我在这台计算机上创建一个空白的 Access 数据库，我可以毫无问题地创建和打开链接表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T13:58:04.410

如果您还没有，请尝试 Microsoft 的以下“修复”。

启动 Windows 资源管理器，然后浏览到**Borland**文件夹。

如果您找不到该文件夹​​，请按照下列步骤操作。*注：由于 Microsoft Windows 有多个版本，因此您的计算机上的以下步骤可能会有所不同。如果是，请参阅您的产品文档以完成这些步骤。*

*   单击**开始**，然后单击**搜索**。
*   单击**所有文件和文件夹**。
*   在全部或部分文件名框中，键入**Borland**。
*   在查找范围列表中，单击**我的电脑**。
*   单击**搜索**。

**将Borland**文件夹重命名为**BorlandOld**。（例如，将*C:\Borland*重命名为*C:\BorlandOld*。）

# python - 传入的字符串表示有两个参数

> ID：10922926
> 
> 赞同：0
> 
> 时间：2012-06-06T21:59:56.373
> 
> 标签：python, integer, arguments, parameter-passing, add

我正在编写的用于添加和减去位于类中的值的函数有点问题。

我正在尝试将我从 csv 读取的值传递给我的 add 函数。这个值是一个十进制值（例如 500.00） 我已经尝试消除尾随的 0 使其只有 500，这也不起作用。我不断得到：

```
TypeError: add() takes exactly one argument (two given). 
```

即使我有一个打印声明确认它只是试图通过 500。

这是我的功能：

```
def add(amount):
    self.total = self.total + amount 
```

它被调用`v.add(i)`即使我将 i 设置为任意整数值，它仍然会导致相同的错误。我对python相对缺乏经验，所以也许我在这里缺少一些简单的东西。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T22:02:57.937

```
class Myclass(object):
    def __init__(self, total=0.):
        self.total = total

    def add(self, amount):     # <= needs `self` parameter
        self.total += amount

v = Myclass()
v.add(2.) 
```

当您调用对象方法时，它会隐式传递对该对象的引用 - 因此调用`v.add(something)`实际上调用了`Myclass.add(v, something)`.

瞧 - 两个参数，当你告诉它只期望一个时......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T22:12:51.540

听起来您可能有两个问题：

1.  方法的正常定义假定“self”参数

    def 添加（自我，金额）：

2.  如果您尝试删除尾随零，您似乎正在处理一个字符串。您可能希望/需要将字符串值“500.00”转换为浮点值

    self.total = self.total + float(数量)

如果您尝试将字符串添加到数字中，Python 会报错。您可以使用 type() 函数查看保存在变量中的对象的类型。例如，您可能希望在 add() 方法中打印“数量”参数的类型，如下所示（用于调试）：

```
print "the type of amount is", type(amount) 
```

它会告诉你你有什么（str、int等）

（顺便说一句，在方法之外将其转换并让方法只接受数量的数值可能会更好。）

# c# - 如何在 C# 中从 MySQL 中检索 tinyint 的数据类型？

> ID：10922928
> 
> 赞同：9
> 
> 时间：2012-06-06T22:00:00.847
> 
> 标签：c#, mysql, tinyint

因此，在 C# 中，每当我从我的 MSSQL 数据库中检索到 tinyint 时，我都会使用以下演员表。

```
(int)(byte)reader["MyField"]; 
```

但是，该演员表似乎在 MySQL 中不起作用。

**我试过的**

```
(byte)reader["MyField"]; 
```

并且只是

```
(int)reader["MyField"]; 
```

**编辑 1**

**例外**

```
The specified cast is not valid. 
```

**编辑 2**

这是数据类型。

```
{Name = "SByte" FullName = "System.SByte"} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-06T22:07:39.920

问题是由于强制转换和显式运算符：

`(byte)objectExpression`is 与 不同`(byte)sbyteExpression`。

第一个是 [direct]*强制转换*失败，因为真实对象类型 is`sbyte`和 not `byte`。后者将执行恰好使用显式运算符（“显式转换”）的转换，不幸的是，它仍然*看起来**像*上面的 [直接]*转换*。这是一个失败的 sans-database 示例：

```
var obj = (object)(sbyte)0;
var i1 = (int)(sbyte)obj;  // okay: object (cast)-> sbyte (conversion)-> int
var i2 = (int)obj;         // fail: sbyte (cast)-> int (but sbyte is not int!) 
```

要么使用`(sbyte)objectExpression`对真实对象类型有效的强制转换，要么使用`Convert.ToInt32(objectExpression)`an`object`并做一些魔术*将*其转换为 int。（使用`Convert.ToByte`可能会在溢出时引发异常。）

快乐编码！

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-06-06T22:01:25.497

要确定正确的类型，请查看

```
reader["MyField"].GetType() 
```

在调试器中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-02-23T14:53:45.473

我可以建议让系统自相矛盾吗？DataReader 类提供了获取正确类型值的功能：

```
reader.GetInt32("id");
reader.GetByte("MyByteField"); 
```

这样，Reader 就会为您提供您期望的类型。

# mysql - 如何选择除 id 之外具有不同列的表

> ID：10922929
> 
> 赞同：1
> 
> 时间：2012-06-06T22:00:22.773
> 
> 标签：mysql, sql

我正在运行 MySQL 5.1.61，我的 MyISAM 表设置为

```
objects:
id | owner | created_date
---------------------------------
1  | xxx   | xxxxxxxx
2  | xxx   | xxxxxxxx

photos:
id | width | height | url
-------------------------
2  | 800   | 480    | http://somewhere.com/photo.jpeg

posts:
id | message
------------
1  | Hello, world!
2  | Goodbye! 
```

我想要类似的东西

```
SELECT * FROM objects LEFT JOIN posts ON objects.id=posts.id LEFT JOIN photos ON objects.id=photos.id 
```

但运行这个查询给了我

```
id | owner | created_date | id | message | id   | width | height | url
----------------------------------------------------------------------
1  | xxx   | xxxxxxxx     | 1  | Hell... | NULL | NULL  | NULL   | NULL
2  | xxx   | xxxxxxxx     | 2  | Good... | 2    | 800   | 480    | http://som.... 
```

这是我想要的，除了重复的 id 列。

没有拼出我想要的所有列，这会很乏味但只有一次，我怎样才能摆脱那些重复的 id 列？我只想要一列，因为无论如何它们都将具有相同的值。

另请注意，我可能会添加更多表，例如“video”、“url”，因此不仅仅是这两个表。

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T22:02:39.940

> 没有拼出我想要的所有列，这会很乏味但只有一次，我怎样才能摆脱那些重复的 id 列？

您**应该**明确说明列。

你可以做你想做的事`USING`，但我仍然建议不要使用`SELECT *`：

```
SELECT *
FROM objects
LEFT JOIN posts USING (id)
LEFT JOIN photos USING (id) 
```

结果：

```
ID  OWNER   CREATED_DATE    MESSAGE         WIDTH   HEIGHT  URL
1   xxx     xxxxxxxx        Hello, world!   (null)  (null)  (null)
2   xxx     xxxxxxxx        Goodbye!        800     480     http://somewhere.com/photo.jpeg 
```

在线查看它：[sqlfiddle](http://sqlfiddle.com/#!2/87acb/1)

# eclipse - 如何在eclipse中更改搜索背景颜色

> ID：10922934
> 
> 赞同：41
> 
> 时间：2012-06-06T22:00:56.380
> 
> 标签：eclipse

我已经搜索了大约 40 分钟，这真是令人沮丧......

eclipse 中的标准搜索结果背景颜色是白色和黑色。每次我搜索某些东西时，我都必须扫描屏幕 50 秒，然后才能找到 Eclipse 找到某些东西的位置。我不知道是哪个笨蛋这样设置的，但他一定是和那个为配置颜色编程界面的笨蛋一起工作……我找不到。

在哪里更改搜索结果的背景颜色？

我很惭愧不得不在这里问这个......但我尝试过的事情，比如设置它一般>编辑器>文本编辑器>注释不起作用。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-10-19T14:06:41.290

在 Eclipse 菜单栏中：Windows->Preferences->General->Editors->Text Editors->Annotations

然后向下滚动到“搜索结果”并设置突出显示的文本颜色。

这适用于 Eclipse Helios 和 Eclipse Juno。我没有测试过其他版本。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-06-08T20:00:44.807

我不确定我是否理解您的意思，但这可能会有所帮助，请访问：

Eclipse -> Preferences -> General -> Search 右边有一行写着：“潜在匹配的前景颜色”，它旁边有一个框，您可以在其中更改颜色。您可以更改搜索的颜色。否则，您还可以通过以下方式更改 Eclipse 突出显示的颜色：

Eclipse -> Preferences -> General -> Appearance -> Colors and Fonts -> Match Highlight 背景颜色
并在此处更改颜色。

希望这可以帮助！你也可以看看这个网页：

[http://help.eclipse.org/indigo/index.jsp?topic=%2Forg.eclipse.platform.doc.user%2Fconcepts%2Faccessibility%2Ffontsandcolors.htm](http://help.eclipse.org/indigo/index.jsp?topic=%2Forg.eclipse.platform.doc.user%2Fconcepts%2Faccessibility%2Ffontsandcolors.htm)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-08-12T21:55:39.277

这可能不适用于所有模式，但我在 Mac 上使用带有 Flash Builder 插件的 Eclipse，结果我不得不修改当前的选择突出显示：

常规 -> 编辑器 -> 文本编辑器 -> 选择背景颜色

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-11-27T15:25:20.133

同样在**搜索**结果窗口（列出树中的所有结果）中，背景颜色在不同的设置下：`Windows->Preferences->General->Appearance->Colors and Fonts->Match highlighting background color`.

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-11-07T00:31:13.123

您可以像这样更改搜索背景颜色：（适用于 Luna 和以前的版本）

在 Eclipse 菜单栏中：Windows->Preferences->General->Editors->Text Editors->Annotations 然后向下滚动到“Search Results”并设置突出显示的文本颜色。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-03-04T22:59:07.643

老问题，但我会添加我的发现。我正在使用使用 Eclipse Mars.1 的 MacBook Pro，同时进行“文本”搜索（使用 Emacs）。要设置搜索突出显示（或背景）颜色，我执行以下操作： `Preferences->General->Editors->Text Editors`请参阅该`Appearance color options`部分。突出显示`Selection background color`并使用调色板设置所需的颜色。这有点令人沮丧，因为我可以让它工作的唯一方法是重新启动 Eclipse。重启后我很高兴。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-07-10T19:18:59.583

与@bitityz 的答案相同，除了我重要的注释是“发生”。我在 Eclipse 4.3 Kepler 上试过这个。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-09-19T18:51:01.557

在 Juno 中突出显示匹配的关键字

Windows->Preferences->General->Text Editor-.Annotations-> 在 Annotation Types 框中，查找 Write Occurrences。改变那里的颜色。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-02-26T00:22:18.907

如果您的意思是（就像我认为的那样）如何更改与您在编辑器中选择的字符串匹配的突出显示颜色（例如，双击“文件名”，Eclipse 会以暗灰色突出显示对“文件名”的其他引用背景），然后下面的帖子回答了这个问题： [Eclipse：如何更改当前选择的方法/表达式的突出显示颜色？](https://stackoverflow.com/questions/3434363/eclipse-how-do-you-change-the-highlight-color-of-the-currently-selected-method)

简而言之，您需要： * 常规 -> 编辑器 -> 文本编辑器 -> 注释 * 在注释类型列表中查找“出现次数”并将其从灰色更改为您喜欢的颜色！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-07-26T20:42:10.703

我还发现，如果您正在查看 C++ 代码（至少在 Eclipse Mars 2 中），更改以下选项将设置当前（或最近）搜索的所有出现的突出显示颜色，以防这是您的身份寻找：

General->Editors->Text Editors->Annotations->C/C++ Occurrences

为什么哦为什么这不在 C++ 首选项窗格中，我永远不会知道。

# ajax - 如何在不添加新 js 文件的情况下向我的表单添加 ajax 响应？

> ID：10922937
> 
> 赞同：0
> 
> 时间：2012-06-06T22:01:02.737
> 
> 标签：ajax, jquery, jquery-plugins

我有这个简单的提交表单，我想“ajaxify”它，所以提交后用户不会被重定向到这个页面**thanks.php**。我希望**thanks.php**中的内容响应并显示在div 中。

什么 jquery 代码将插入其中以显示响应。

```
<div ><form method="post" action="http://domain.com/thanks.php">
<input type="text" placeholder="Enter Email" name="email" id="email" > &nbsp;
<input type="submit" name="submit" value="Submit" ></form></div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T22:08:56.353

我会给'form'和'div'一个类或id，所以它不是那么通用，但这应该可行。

```
$("form").submit(function (){
    $.ajax({
        url: "http://{url}/thanks.php",
        type: 'POST',
        data: {email: $("#email").val()},
        success: function ( data ) {
          $("div").html(data);
        }
    });

    return false;
}); 
```

# sql - 使用 SQL 插入重复记录

> ID：10922940
> 
> 赞同：2
> 
> 时间：2012-06-06T22:01:53.137
> 
> 标签：sql, sql-server, stored-procedures

我通过搜索 UniqueColID 并将结果插入回表中来复制记录..这样做我有一个重复的条目，这是我想要的，除了我希望一个列不重复并且该列是 UniqueColID..

下面是我的代码：

```
CREATE PROCEDURE [dbo].[InsertDuplicateFields] 
    (@UniqueColID varchar(50), @IndividualID varchar(50) = null)
AS
Begin           
    INSERT INTO TableCollisionBegin 
        SELECT * FROM TableCollisionBegin 
        WHERE [UniqueColID] = @UniqueColID;

    INSERT INTO TableCollisionDetails 
        SELECT * FROM TableCollisionDetails 
        WHERE [UniqueColID] = @UniqueColID;

    INSERT INTO TableCollisionLocation 
        SELECT * FROM TableCollisionLocation 
        WHERE [UniqueColID] = @UniqueColID;

    INSERT INTO TableDriver 
        SELECT * FROM TableDriver 
        WHERE [UniqueColID] = @UniqueColID;

    INSERT INTO TableFollowUp 
        SELECT * FROM TableFollowUp 
        WHERE [UniqueColID] = @UniqueColID;

    INSERT INTO TableOfficerLogs 
        SELECT * FROM TableOfficerLogs 
        WHERE [UniqueColID] = @UniqueColID;

    INSERT INTO TablePolice 
        SELECT * FROM TablePolice 
        WHERE [UniqueColID] = @UniqueColID;

    INSERT INTO TableRecVerified 
        SELECT * FROM TableRecVerified 
        WHERE [UniqueColID] = @UniqueColID;

    INSERT INTO TableSignature 
        SELECT * FROM TableSignature 
        WHERE [IndividualID] = @IndividualID;

    INSERT INTO TableTrailer 
        SELECT * FROM TableTrailer 
        WHERE [UniqueColID] = @UniqueColID;

    INSERT INTO TableValidateLog 
        SELECT * FROM TableValidateLog 
        WHERE [UniqueColID] = @UniqueColID;

    INSERT INTO TableVehicle 
        SELECT * FROM TableVehicle 
        WHERE [UniqueColID] = @UniqueColID;

    INSERT INTO TableWitness 
        SELECT * FROM TableWitness 
        WHERE [UniqueColID] = @UniqueColID;

End 
```

每个表都有 NUMEROUS 列，但它们都共享 UniqueColID。

当我插入重复项时，我希望所有详细信息都是重复的，但我想插入一个新的 UniqueColID ..我该怎么做？

**新的 UniqueColID 由 ASP.NET 代码中的特殊方法生成。我想要 2 或 3 或 4 个不同的 UniqueColID，其余列重复。**

我尝试了你说的第二个代码块，但得到了错误：

```
"Unknown object type 'TEMPORARY' used in a CREATE, DROP, or ALTER statement."

CREATE PROCEDURE [dbo].[AmendInsertDuplicateFields] (@UniqueColID varchar(50), @NewUniqueColID varchar(50)) 

AS 
Begin CREATE TEMPORARY TABLE Temp AS SELECT * FROM [MVCNew].[dbo].[CollisionBegin] WHERE [UniqueColID] = @UniqueColID; 

UPDATE Temp SET UniqueColID = @NewUniqueColID; 
INSERT INTO [MVCNew].[dbo].[CollisionBegin] SELECT * FROM Temp; 
DROP TEMPORARY TABLE IF EXISTS Temp; 
End 
```

我只是在想....我是否可以插入一条带有一些随机 UniqueColID 值的新记录，但所有其他列都插入了值“o”或“u”或“一些随机文本”，然后我插入到这个新记录 UniqueColID 的所有列，除了 UniqueColID？这样，我将拥有一个新的 UniqueColID，其余列具有相同的值。

KCD 我已经尝试了你的代码块并且没有工作.. :(

我个人看不到 SELECT @NewUniqueColID.... 甚至是如何工作的，因为表中没有名为 @NewUniqueColID 的值的列

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-07T15:01:55.747

不管看起来多么可怕，我建议使用指定完整列列表的查询。但是您不需要自己输入所有字段：使用 SQL Server Management Studio，右键单击对象资源管理器中的表并选择菜单项“脚本表为 | 插入到 | 新查询窗口”。

这会给你这样的东西：

```
INSERT INTO [dbo].[TableOfficerLogs]
           ([UniqueColID]
           ,[OtherField1]
           ,[OtherField2] -- etc.
           ,[OtherFieldN]
     VALUES
           (<UniqueColID, int,>
           ,<OtherField1, nvarchar(200),>
           ,<OtherField2, nvarchar(200),> --etc.
           ,<OtherFieldN, nvarchar(200),>) 
```

不要让这吓到你——你仍然不会手动输入所有的 VALUES。现在让该窗口保持一秒钟，然后返回对象资源管理器。使用同一张表上的上下文菜单，获取另​​一个脚本：“将表编写为 | SELECT To | New Query Window”。这将是一个完全标准的选择列表，其中列出了您的所有字段。复制整个查询并将其粘贴到第一个查询窗口中的 VALUES 子句中。

这将为您提供一个完整的 INSERT ... SELECT 查询，其中列出了所有字段。现在，只需根据需要替换 SELECT 部分中的 UniqueColID。

此外，如果您提前知道新的 UniqueColID 值，请在 FROM 子句中加入它们（表示为表值参数，如果您在存储过程中执行所有这些操作）：您最终会得到尽可能多的重复项随你喜欢，每个都有你指定的 ID。

**更新：**

这两个“Script Table as”操作将为您提供如下所示的内容，其中列出了所有字段：

```
INSERT INTO [dbo].[TableOfficerLogs]
               ([UniqueColID]
               ,[OtherField1]
               ,[OtherField2] -- etc.
               ,[OtherFieldN]
SELECT [UniqueColID]
      ,[OtherField1]
      ,[OtherField2] -- etc.
      ,[OtherFieldN] 
```

现在，要实际进行复制，您需要对其进行修改。您的代码最终可能如下所示：

```
CREATE PROCEDURE [dbo].[InsertDuplicateFields]        
    (@UniqueColID varchar(50), @NewUniqueColID varchar(50))         
AS    

INSERT INTO [dbo].[TableOfficerLogs]
               ([UniqueColID]
               ,[OtherField1]
               ,[OtherField2] -- etc.
               ,[OtherFieldN]
SELECT @NewUniqueColID
      ,[OtherField1]
      ,[OtherField2] -- etc.
      ,[OtherFieldN]
WHERE UniqueColID = @UniqueColID 
```

这将复制指定的行并用新 ID 替换旧 ID。当然，您可以对 8 个表中的每一个重复此过程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T23:44:51.480

当您的应用程序生成原始的 UniqueColID 时，我建议它也传递新的 ID。

```
CREATE PROCEDURE [dbo].[InsertDuplicateFields] 
    (@UniqueColID varchar(50), @NewUniqueColID varchar(50), @IndividualID varchar(50) = null)
AS
Begin           
    SELECT *
    INTO TempTable
    FROM TableCollisionBegin 
    WHERE [UniqueColID] = @UniqueColID

    UPDATE TempTable SET [UniqueColID] = @NewUniqueColID

    INSERT INTO TableCollisionBegin
        SELECT * 
        FROM TempTable

    DROP TABLE TempTable

    ...
End 
```

# php - 如何使用 php 制作正则表达式以从以下代码中抓取复杂数组

> ID：10922948
> 
> 赞同：1
> 
> 时间：2012-06-06T22:02:35.880
> 
> 标签：php, javascript, regex

我想从这个网站检索一些数据： [http ://sites.target.com/site/en/spot/search_results.jsp?&mapType=enhanced&startAddress=72756&startingLat=36.322757720947266&startingLong=-93.99922943115234&_requestid=2573952](http://sites.target.com/site/en/spot/search_results.jsp?&mapType=enhanced&startAddress=72756&startingLat=36.322757720947266&startingLong=-93.99922943115234&_requestid=2573952)

上面网页的html源代码中有以下几行，

```
<script>
    function GetMap(){
    var results = new Array();
    results[results.length] = {"lat" : "36.299484", "lon" : "-94.173495", "id" : "2498", "name" : "test", "phoneNumber" : "(479) 986-1100", "hours" : "test", "address" : {"city" : "Rogers", "state" : "AR", "zip" : "72758", "street" : "2404 Promenade Blvd" }, "concepts" : [{"name" : "Pharmacy", "phoneNumber" : "(479) 986-1101", "hours" : "<b>M-Fr:</b> 10:00AM-7:00PM<br><b>Sa:</b> 10:00AM-7:00PM" }, {"name" : "PhotoLab", "hours" : "<b>M-Fr:</b> 9:00AM-9:00PM<br><b>Sa:</b> 9:00AM-9:00PM<br><b>Su:</b> 10:00AM-8:00PM" }, {"name" : "Wine"}, {"name" : "Starbucks"}]};
    results[results.length] = {"lat" : "36.1157", "lon" : "-94.1555", "id" : "1470", "name" : "test", "phoneNumber" : "(479) 443-5517", "hours" : "test", "address" : {"city" : "Fayetteville", "state" : "AR", "zip" : "72703", "street" : "3545 N Shiloh Dr" }, "concepts" : [{"name" : "Pharmacy", "phoneNumber" : "(479) 443-5628", "hours" : "<b>M-Fr:</b> 9:00AM-7:00PM<br><b>Sa:</b> 9:00AM-5:00PM<br><b>Su:</b> 11:00AM-5:00PM" }]};
    results[results.length] = {"lat" : "36.6738", "lon" : "-93.2257", "id" : "2098", "name" : "test", "phoneNumber" : "(417) 243-4500", "hours" : "test", "address" : {"city" : "Branson", "state" : "MO", "zip" : "65616", "street" : "1200 Branson Hills Pkwy" }, "concepts" : [{"name" : "Pharmacy", "phoneNumber" : "(417) 243-4513", "hours" : "<b>M-Fr:</b> 9:00AM-9:00PM<br><b>Sa:</b> 9:00AM-6:00PM<br><b>Su:</b> 9:00AM-6:00PM" }, {"name" : "PhotoLab", "phoneNumber" : "(417) 243-4500", "hours" : "<b>M-Fr:</b> 12:00PM-6:00PM<br><b>Sa:</b> 12:00PM-6:00PM<br><b>Su:</b> 12:00PM-6:00PM" }, {"name" : "Wine"}, {"name" : "Starbucks"}]};
    results[results.length] = {"lat" : "37.0849", "lon" : "-94.474", "id" : "774", "name" : "test", "phoneNumber" : "(417) 659-8755", "hours" : "test", "address" : {"city" : "Joplin", "state" : "MO", "zip" : "64801", "street" : "3151 E 7th St" }, "concepts" : [{"name" : "FreshGrocery"}, {"name" : "Pharmacy", "phoneNumber" : "(417) 206-3377", "hours" : "<b>M-Fr:</b> 9:00AM-9:00PM<br><b>Sa:</b> 9:00AM-6:00PM<br><b>Su:</b> 9:00AM-6:00PM" }, {"name" : "Wine"}, {"name" : "Starbucks"}]};
    results[results.length] = {"lat" : "37.1511", "lon" : "-93.2623", "id" : "1031", "name" : "test", "phoneNumber" : "(417) 889-1511", "hours" : "test", "address" : {"city" : "Springfield", "state" : "MO", "zip" : "65804", "street" : "1825 E Primrose St" }, "concepts" : [{"name" : "FreshGrocery"}, {"name" : "Pharmacy", "phoneNumber" : "(417) 520-1745", "hours" : "<b>M-Fr:</b> 9:00AM-7:00PM<br><b>Sa:</b> 9:00AM-5:00PM<br><b>Su:</b> 11:00AM-5:00PM" }, {"name" : "PhotoLab", "phoneNumber" : "(417) 889-1511", "hours" : "<b>M-Fr:</b> 12:00PM-6:00PM<br><b>Sa:</b> 12:00PM-6:00PM<br><b>Su:</b> 12:00PM-6:00PM" }, {"name" : "Starbucks"}]}; 
```

我想分开纬度、经度、id、姓名、电话号码、城市、州、邮政编码。

是否可以从上面的 javaScript 代码中解析数据，我对制作这种复杂行的正则表达式感到困惑。

我们可以以以下格式获取 PHP 中的数据吗？

```
Array
(
    [lat] => 36.299484
    [lon] => -94.173695
    [id] =>  2498
    [name] => Rogers
    [phoneNumber] => (479) 986-1100
    [city] => Rogers
    [state] => AR
    [zipcode] => 72758 
```

)

这是我不完整的方法..

```
 $fp = fopen("file.csv","w");
    $contents = file_get_contents('http://sites.target.com/site/en/spot/search_results.jsp?&mapType=enhanced&startAddress=72756&startingLat=36.322757720947266&startingLong=-93.99922943115234&_requestid=2573952');
    preg_match_all('Regular Expression Here', $contents, $matches);        
    foreach ($matches[1] as $index) {       
        preg_match('Regular Expression Here', $contents, $matches);
        preg_match_all('Regular Expression Here', $matches [1], $matches);
        $c = count ($matches [1]);
        $results = array();
        for ($i=0; $i<$c; $i++)  {
            $results [$matches [1] [$i]] = trim($matches [2] [$i], "\'");
        }
        fwrite($fp,implode(";",array_values($results))."\r\n");
    }
    fclose($fp); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T22:16:24.193

信息采用称为 JSON 的格式。PHP 有一个 JSON 解析器。

[http://php.net/manual/en/book.json.php](http://php.net/manual/en/book.json.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T22:32:57.963

如果格式像您的示例中那样固定，我不会打扰正则表达式。

我会做的是：

1.  使用`file`而不是`file_get_contents`获取数组中的内容（每个数组元素一行文件）；
2.  循环遍历数组；
3.  使用许多字符串函数中的一些来检查`results[results.length] =`和删除之前的所有内容，包括`results[results.length] =`它自己；
4.  用于`trim`去除结尾和开头和结尾的空格`;`
5.  用于`json_decode`解码剩余的 json 对象，请参见此[示例](http://codepad.org/YT9myFS7)。

# jquery - 在jQuery中查找列表项的索引

> ID：10922951
> 
> 赞同：0
> 
> 时间：2012-06-06T22:02:53.373
> 
> 标签：jquery, list, indexing

我有八个项目的无序列表。在页面加载时，前五个`<li>`有默认缩略图，第 6 个有一个 1px x 1px 占位符图像，ID 为`$('#last')`. 当用户插入新图像时，它会`$('#last')`用他们的新图像替换'src'。这不是最有效的方法，但它确实有效。

```
<ul>
    <li><img src="img1.png" /></li>
    <li><img src="img2.png" /></li>
    <li><img src="img3.png" /></li>
    <li><img src="img4.png" /></li>
    <li><img src="img5.png" /></li>
    <li><img src="1px.png" id="last"/></li>
    <li></li>
    <li></li>
</ul> 
```

当用户添加新图像时，ID`$('#last')`被删除，我用它`each()`来查找下一个空`<li>`图像并将 1px x 1px 图像插入其中，ID 为，`$('#last')`以便为下一次图像上传做好准备。

此时我需要获取`index()`其中`<li>`现在有 1px x 1px 图像的，其 ID 为`$('#last')`，以便我可以将索引存储在会话中，因此当用户返回页面时，`$('#last')`ID 仍然设置并准备接受另一个图像。

我如何获取`<li>`包含该图像的索引，因为它是在页面加载后设置的？有没有办法使用`delegate()`或`on()`获得它？即如何获取页面加载后设置的元素的索引？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T22:07:17.443

以下所有建议都基于这些脚本片段将在插入新脚本*后*运行的假设`li`。

要获取最后一个`li`元素的索引：

```
var lastLi = $('ul li:last').index(); 
```

要有条件地执行此操作，请检查它是否具有匹配项`src`：

```
var lastLi = $('ul li').filter(
                 function(){
                     return $(this).attr('src') == '1px.png';
                 }); 
```

假设最后一个`li`将*始终*包含占位符图像：

```
var lastLi = $('#last').index(); 
```

参考：

*   [`:last`选择器](http://api.jquery.com/last-selector/)。
*   [`attr()`](http://api.jquery.com/attr/).
*   [`filter()`](http://api.jquery.com/filter/).
*   [`index()`](http://api.jquery.com/index/).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T22:36:07.033

据我了解，您可以插入 < img id="#last"... 以获取具有 #last 的 li 的 index()

```
var list = $('#last').parent('li');
alert( $('li').index(list) ); 
```

[例子](http://jsfiddle.net/shahrokhnabavi/qzAth/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T22:19:52.847

从...开始：

```
<ul>
    <li><img src="img1.png" /></li>
    <li><img src="img2.png" /></li>
    <li><img src="img3.png" /></li>
    <li><img src="img4.png" /></li>
    <li><img src="img5.png" /></li>
</ul> 
```

每次添加图像时：

```
$('ul').append('<li><img src="imgn.png" /></li>'); 
```

其中“imgn.png”是新图像文件的名称。在任何时候，如果您需要知道列表中有多少图像：

```
$('ul li').length 
```

但是，如果始终有 8 个列表元素很重要：

```
<ul>
    <li><img src="img1.png" /></li>
    <li><img src="img2.png" /></li>
    <li><img src="img3.png" /></li>
    <li><img src="img4.png" /></li>
    <li><img src="img5.png" /></li>
    <li></li>
    <li></li>
    <li></li>
</ul>

function addImage(url){
    $('ul li:empty').first().html('<img src="' + url + '" />');
}
addImage('img6.png'); 
```

# bash - 这个 .command 文件有什么问题？

> ID：10922955
> 
> 赞同：0
> 
> 时间：2012-06-06T22:03:19.697
> 
> 标签：bash, shell, command-line, terminal, command-prompt

这是我的脚本，用于自动化我的静态博客的 git push。当我在终端中一一运行每个命令时，它就可以工作了。我是否需要添加延迟，也许它太快了。pelican 命令（静态网站生成器）需要相当长的时间（2 秒）。在此期间脚本的其余部分是否崩溃？

```
 #!/bin/sh
    dropbox
    cd blog
    pelican . -s /Users/Paul-Arthur/Desktop/Desktop/Dropbox/blog/pelican.conf.py -t subtle
    cd output
    git add . 
    git commit -m 'commit'
    git push 
```

更新：抱歉，是的，dropbox 是我的 bash_profile 中的自定义命令（这不是问题，我知道它可以工作；））。可悲的是，当我单击我的脚本时，它执行得非常快（但不起作用），所以我看不到错误。

这是 calepin 命令的输出。这些错误是正常的，我希望它能够运行。你认为这是问题所在吗？如果是这样，我该怎么办？

```
 familys-imac:blog Paul-Arthur$     pelican . -s /Users/Paul-Arthur/Desktop/Desktop/Dropbox/blog/pelican.conf.py -t subtle

    ERROR: Skipping ./articles/aboutme.md: impossible to find informations about 'title'
    ERROR: Skipping ./articles/static_sites.md: impossible to find informations about 'title'
    familys-imac:blog Paul 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T11:25:26.683

这可能是由于 « `cd`» 命令，因为它不是命令，它是 shell 的内置命令，并且不像命令。

要调试它，请尝试`pwd`在脚本中的 « `cd`» 行之前和之后添加 « » 命令，以确保工作目录已更改。

这也可能是由于您使用的 shell，在 shebang（脚本的第一行）中，您使用的是 /bin/sh 脚本。是好的吗？当您在 shell 中执行此操作时，您可能正在使用另一种方法，例如 bash、dash、zsh 等。

要确定这一点，请在您当前的 shell 中键入：

```
which `echo $0` 
```

你会得到一个类似的答案：

```
/bin/bash 
```

或类似的东西。在你的 shell 脚本中使用它：

```
#!/bin/bash 
```

再试一次你的脚本。

祝你的项目好运。

# python - 如何在 MongoEngine 的 ListField 中对 EmbeddedDocument 进行原子更新？

> ID：10922956
> 
> 赞同：2
> 
> 时间：2012-06-06T22:03:35.207
> 
> 标签：python, mongodb, mongoengine

我在 StackOverflow 上发现了一些类似的问题，但没有解决我正在寻找的问题，所以任何帮助将不胜感激。

我的模型：

```
class BlogPost(EmbeddedDocument):
  title = StringField(required=True)
  blog_url = StringField(required=True, unique=True)
  content = StringField()
  turned_into_bitly_link = BooleanField(default=False)

class Person(Document):
  name = StringField
  blog_posts = ListField(EmbeddedDocumentField(BlogPost), default=list) 
```

对于每个 blogpost.blog_url，我查询 Bitly API 以查看 url 是否已缩短。我需要做的是将我从 Bitly 返回的数据与我数据库中的相应博文进行匹配。我从 Bitly 返回的对象包含一个 url 字段，我需要使用该字段来匹配和更新数据库中的相应博客文章。也应该说我一次向Bitly发送一批blog_urls，一个一个不是一个选项。

给定一组来自​​给定个人的 blog_posts 和 Bitly 对象： person = Person.objects.get(name__exact='BobSmith')

如何通过唯一 URL 字段选择嵌入在我的 Person 对象中的特定 blog_post？

作为权宜之计，我想我可以遍历我的 person 对象中的 blog_posts，如果 blog_post.url 与我的 Bitly 对象中的 URL 匹配，我可以更新 turn_into_bitly_link 字段，但我不确定这是最有效的解决这个问题的方法。

希望这是有道理的。我很高兴澄清，并提前感谢您的任何建议。

本

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T09:09:30.037

您可以使用位置运算符来更新匹配的嵌入文档。

这是测试中的一个示例（https://github.com/MongoEngine/mongoengine/blob/master/tests/test_queryset.py#L313）

```
def test_update_using_positional_operator(self):
    """Ensure that the list fields can be updated using the positional
    operator."""

    class Comment(EmbeddedDocument):
        by = StringField()
        votes = IntField()

    class BlogPost(Document):
        title = StringField()
        comments = ListField(EmbeddedDocumentField(Comment))

    BlogPost.drop_collection()

    c1 = Comment(by="joe", votes=3)
    c2 = Comment(by="jane", votes=7)

    BlogPost(title="ABC", comments=[c1, c2]).save()

    BlogPost.objects(comments__by="jane").update(inc__comments__S__votes=1)

    post = BlogPost.objects.first()
    self.assertEquals(post.comments[1].by, 'jane')
    self.assertEquals(post.comments[1].votes, 8) 
```

# android - SQLlite vs String-array 用于存储大量小段落？

> ID：10922958
> 
> 赞同：0
> 
> 时间：2012-06-06T22:03:45.183
> 
> 标签：android, sqlite, text, arrays

我需要在我的应用程序的某个地方存储大约 120 个不同的文本段落，以便我可以向用户显示其中的一些段落。

由于这些段落是 12 组，我正在考虑在我的 values/strings.xml 文件中创建 12 个不同的字符串数组，这样我就可以轻松访问它们，而不会有太多麻烦。

这样做的最佳做法是什么？如果我选择一种方式而不是另一种方式，我会失去什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T22:06:23.163

如果它们在运行时从不改变，那么将它们粘贴到字符串资源中是迄今为止更容易的选择。

# meteor - 是一种指定包版本号的方法吗？

> ID：10922965
> 
> 赞同：0
> 
> 时间：2012-06-06T22:04:04.383
> 
> 标签：meteor

新版本迟早会打破旧版本。为了让 Meteor 升级不那么令人惊讶，我希望能够指定包的版本，例如 CoffeeScript、LESS、Bootstrap 等（类似 npm 的版本控制是理想的）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T16:11:21.183

看看[陨石](https://github.com/oortcloud/meteorite)包装系统。它会跟踪版本号，甚至根据您在`smart.json`文件中放入的内容使用最新的 git 版本。

# php - 带有php和相对路径的nginx代理传递

> ID：10922966
> 
> 赞同：0
> 
> 时间：2012-06-06T22:04:08.733
> 
> 标签：php, proxy, nginx

我的问题似乎很简单...

我的局域网 192.168.0.2 上有 1 台服务器，根路径 /var/www/ (apache2) 和 1 个域 example.com (nginx) 和 1 个子域 bug.example.com (nginx)

并且只想要一个代理之间 `http://192.168.0.2/bugs/ --->> http://bug.example.com/`

我在像这样 /var/www/bugs 的根目录中使用错误跟踪器（Mantis）

这个配置工作：

```
server {

    listen 80;
    server_name bug.example.com;

    location / {
            proxy_pass   http://192.168.0.2/bugs/;
   }
 } 
```

但我无法访问 css 或图像...

CSS：

`<link rel="stylesheet" type="text/css" href="http://192.168.0.2/bugs/css/default.css" />`

图片 ：

`<link rel="shortcut icon" href="/bugs/images/favicon.ico" type="image/x-icon" />`

我已经用 "proxy_set_header" 、 "proxy_redirect" 、 "rewrite" 测试了很多配置......但从未成功:(

有谁能够帮我 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T22:10:09.560

这是一个 PHP 问题。该站点不知道重定向...正如我所见，它使用完整路径 192.168.0.2/bugs 呈现 CSS 文件...尝试找到如何在 PHP 中而不是 nginx 中处理此问题的解决方案。

在 Mantis 中查找 HOST_NAME 或类似的配置设置。

至于图像，更改为 bugs.site.com/bugs 应该可以修复它们。否则你需要让 Mantis 知道它没有虚拟路径 /bugs。背后是Apache服务器吗？

更新：实际上您可以尝试剥离 HOST 标头并将其修改为“bugs.site.com”...这完全取决于实际的 Web 服务器/Mantis/ 配置..

# gcc - scrapy安装错误

> ID：10922967
> 
> 赞同：0
> 
> 时间：2012-06-06T22:04:15.073
> 
> 标签：gcc, error-handling, scrapy, easy-install

我在运行 easy_install scrapy 时遇到问题并出现以下错误：

```
**cc1.exe: error: unrecognized command line option '-mno -cygwin'
error: setup script exited with error: command 'gcc' failed with exit status 1** 
```

我在 Windows 32 位上运行 python 2.7。我安装了mingw、libxslt、liblxml2。那里发生了什么事？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T14:52:48.263

解决方法是从 C:\Python27\Lib\distutils\cygwinccompiler.py 中删除所有 -mno-cygwin 实例，重新运行 easy_install。

我有同样的问题，我在这里找到了答案：

[http://www.techques.com/question/1-6034390/Compiling-with-cython-and-mingw-produces-gcc:-error:-unrecognized-command-line-option-'-mno-cygwin](http://www.techques.com/question/1-6034390/Compiling-with-cython-and-mingw-produces-gcc:-error:-unrecognized-command-line-option-) '

我安装了不支持 -mno-cygwin 选项的 GCC 版本 4.6.2。

# mvvm - 如何在 TreeView Silverlight 4.0 中创建 DataTemplate

> ID：10922969
> 
> 赞同：1
> 
> 时间：2012-06-06T22:04:29.270
> 
> 标签：mvvm, silverlight-4.0, mvvm-light, silverlight-toolkit

我有一些复杂的要求要在 Silverlight 中为 TreeView 创建一个 DataTemplate。这是使用 MVVM 设计模式。这就是我想要的：

套餐 1 孩子 1 孩子 2 套餐 2 孩子 3 孩子 4

代码：

```
 Class Package
 {
   string _Name;
   ObservableCollection<Child> _Childs;
public ObservableCollection<Child> Childs{get{return _Childs; } set{_Childs=value;}}
public string PackageName{get{return _Name; } set{_Name=value;}}

  }

 class Child
 {
   string ChildName;
public bool IsEnabled{get;set;}
public string Id{get; set;}
  } 
```

使用上面的数据契约，我应该创建一个树视图：Package Name being TreeItem header value。每个子项都是一个子框，内容为 ChildName，复选框的 Enabled 属性绑定到 Child 的 IsEnabled。

我已经尝试了以下代码，但它根本没有显示任何树视图。

```
 <sdk:TreeView x:Name="SelectedPackagesTV" ItemsSource="{Binding Packages, Mode=TwoWay}"
                              ItemTemplate="{StaticResource PackageTemplate}">
                    <sdk:TreeView.Resources>
                        <DataTemplate x:Key="FormsTemplate" >
                            <CheckBox Content="{Binding Id, Mode=TwoWay}" IsEnabled="{Binding IsEnabled}" >

                            </CheckBox>
                        </DataTemplate>
                        <sdk:HierarchicalDataTemplate x:Key="PackageTemplate" ItemsSource="{Binding Childs, Mode=TwoWay}" ItemTemplate="{StaticResource FormsTemplate}">
                            <TextBlock Text="{Binding Name, Mode=TwoWay}" />
                        </sdk:HierarchicalDataTemplate>                            
                    </sdk:TreeView.Resources>                        
                </sdk:TreeView> 
```

注意：我将值填充到视图模型构造函数中的 PackagesCollection。这会是个问题吗？如果我遗漏任何东西，请告诉我，并建议我解决此问题的最佳方法。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T00:31:54.430

编辑：

“PackageTemplate”中的绑定设置为“Name”，但类的公共属性是“PackageName”。

这是创建数据并附加它的示例。我已经对此进行了测试，并且可以正常工作。

```
public partial class MainWindow : Window
{

    public MainWindow()
    {
        InitializeComponent();

        this.DataContext = new ViewModel();
    }

    public class Package
    {
        public string Name { get; set; }
        public ObservableCollection<Child> Childs { get; set; }
    }

    public class Child
    {
        public string ChildName { get; set; }
        public bool IsEnabled { get; set; }
    }

    public class ViewModel  : INotifyPropertyChanged
    {
        private ObservableCollection<Package> _packages;

        public event PropertyChangedEventHandler PropertyChanged;

        public string TestStr { get { return "testing123"; } }

        public ViewModel()
        {
            List<Package> list = new List<Package>() { new Package() { Name = "pkg1", Childs = new ObservableCollection<Child>(new List<Child>() { new Child() { ChildName = "Child1" } }) } };
            this.Packages = new ObservableCollection<Package>(list);
        }

        public ObservableCollection<Package> Packages
        {
            get
            {
                return this._packages;
            }
            set
            {
                this._packages = value;
            }
        }

        protected void OnPropertyChanged(string name)
        {
            PropertyChangedEventHandler handler = PropertyChanged;
            if (handler != null)
            {
                handler(this, new PropertyChangedEventArgs(name));
            }
        }
    }
} 
```

一些东西：

您的业​​务对象应如下所示：

```
public class Package
    {
        public string Name { get; set; }
        public ObservableCollection<Child> Childs { get; set; }
    }

    public class Child
    {
        public string ChildName { get; set; }
        public bool IsEnabled { get; set; }
    } 
```

绑定只能作用于公共属性，不能作用于私有字段

您的 xaml 可以更正为：

```
<sdk:TreeView ItemTemplate= "{StaticResoruce PackageTemplate}"  ItemsSource="{Binding Packages}">
<sdk:TreeView.Resources>
    <sdk:HierarchicalDataTemplate x:Key="PackageTemplate" 
                                      ItemsSource="{Binding Childs,Mode=TwoWay}"
                                      ItemTemplate="{StaticResource ChildTemplate}">
        <TextBlock Text="{Binding Name,Mode=TwoWay}" />
    </sdk:HierarchicalDataTemplate>

    <sdk:DataTemplate x:Key="ChildTemplate" >
        <CheckBox  Content="{Binding ChildName,Mode=TwoWay}"
                       IsEnabled="{Binding IsEnabled}">
        </CheckBox>
    </sdk:DataTemplate>
</sdk:TreeView.Resources> 
```

模板需要位于 TreeView 或 UserControl 的封闭“资源”括号中。

您的 PackageTemplate 应该有 ItemsSource “Childs”而不是 Packages。您将 PackageTemplate 绑定到“PackageName”，但 Package 类声明“Name”。

不是错误，而是因为您的 ChildTemplate 没有自己的子级，它只需要是一个 DataTemplate，没有层次结构。

还

```
ItemTemplate= {"StaticResoruce PackageTemplate"} 
```

应该：

```
ItemTemplate= "{StaticResource PackageTemplate}" 
```

# android - 开始使用 Google TV 资源和硬件/软件

> ID：10922974
> 
> 赞同：1
> 
> 时间：2012-06-06T22:05:06.570
> 
> 标签：android, google-tv

我很快就会参与 Google TV 项目，并且想知道一些好的资源来开始了解 Google TV。我听说过 Google TV OS 和 SDK，但我想从最新的方法开始，所以我需要对此进行更新。是否有仅适用于 Google TV 的活跃新闻组？同样在硬件方面，我需要什么才能开始使用最新的操作系统等。我有一台罗技设备，但需要知道我应该使用哪些硬件资源来使用最新的 Google TV 功能。

我特别感兴趣的是我们现在可以从三星购买哪些产品来支持 Google TV 以及正在筹备中的哪些产品？由于 Logitech 设备现已过时，我应该购买什么来开始测试 Google TV 应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T18:18:11.743

Google TV 开发者网站：

[https://developers.google.com/tv/](https://developers.google.com/tv/)

是开始为 Google TV 开发应用程序的好地方。如果您有与 Google TV 应用程序开发相关的技术问题，请随时在 StackOverflow 上发布。

有关 Google TV 开发者社区的信息，请参见此处：

[https://developers.google.com/tv/android/community](https://developers.google.com/tv/android/community)

目前市场上没有三星 Google TV 设备。要测试 Google TV 应用，您可以使用任何可用的 Google TV 设备：

[http://support.google.com/googletv/?hl=en](http://support.google.com/googletv/?hl=en)

您还可以使用模拟器来测试您的应用程序：

[https://developers.google.com/tv/android/docs/gtv_emulator](https://developers.google.com/tv/android/docs/gtv_emulator)

# asp.net - ASP.NET 4 应用程序中的双应用程序域

> ID：10922975
> 
> 赞同：18
> 
> 时间：2012-06-06T22:05:19.487
> 
> 标签：asp.net, iis-7, .net-4.0, appdomain

我有一个 ASP.NET 应用程序在具有多个应用程序域的 IIS 7 上运行，我无法理解为什么单个进程中有多个应用程序域。我已经掌握了我的代码库，并且没有明确地创建第二个应用程序域。回收是否有可能超时？

*   这些双域将持续一段时间。
*   如果由于 Web 配置或二进制更改而发生回收，则两个应用程序域都将关闭，并且将启动两个新的应用程序域。
*   这些服务器每天都会受到多个二进制补丁和 IISReset 的影响——有时有 2 个域，有时只有 1 个。
*   网络园艺已禁用。
*   我发现这一点是因为应用程序中有一个计时器向数据库发送心跳，并注意到有一天服务器有两次心跳。

在 windbg 中，!dumpdomain 向我显示以下结果：（过滤为仅显示应用程序域的名称）：

```
Line 59: Name:               None
Line 66: Name:               None
Line 372: Name:               DefaultDomain
Line 460: Name:               /LM/W3SVC/1/ROOT/MyAppDomain-1-129882892717131250
Line 4437: Name:               /LM/W3SVC/1/ROOT/MyAppDomain-4-129285605131450579 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-15T01:13:11.810

1.  即使您没有创建`AppDomain`，您正在使用的库也可能是。您正在使用哪些第三方组件？您是否有任何可能负责的控制反转或动态代理库？这是[Castle](http://www.claassen.net/geek/blog/2007/10/dynamicproxy-rocks.html)发生的这种情况的解释。

2.  您确定应用程序只在 IIS 中的一个地方运行吗？可能有多个 IIS 站点/应用程序从同一个文件运行。这与 (1) 从数据库而不是应用程序获取调试信息以及 (2) 由于编辑`web.config`一致导致重复域而导致的回收是一致的。如果一个位置比另一个更常访问，这可以解释为什么有时只有一个`AppDomain`。

3.  如果您正在利用 ASP.NET 的动态编译和卷影复制功能，ASP.NET 有时会有多个`AppDomain`s. Jim Schubert 写了一篇名为[ASP.NET、AppDomains 和 shadow-copying](http://www.ipreferjim.com/2012/04/asp-net-appdomains-and-shadow-copying/)的文章，其中更详细地解释了这一点，并就如何修改`web.config`以自定义它提出了一些建议。如果我覆盖 DLL ，[我的 ASP.NET 应用程序会停止执行吗？](https://stackoverflow.com/questions/4394410/does-my-asp-net-application-stop-executing-if-i-overwrite-the-dlls/4394472#4394472) 可以通过设置禁用卷影复印`<hostingEnvironment shadowCopyBinAssemblies="false" />`。

## 更新

我被 Jim Schubert 的博客所吸引，最终阅读了这篇无关的帖子，内容是[Allowing Only A Single Instance of a .NET application](http://www.ipreferjim.com/2012/04/allowing-only-a-single-instance-of-a-net-application/)。如果一切都失败了，您可以使用这种方法来确保只有一个应用程序实例正在运行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T22:46:25.273

可以看看你的`ApplicationHost.config`。

看看：`maxProcesses`应该是1。

看来您的 IIS 启动了多个工作进程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-26T11:47:44.787

如果有多个针对同一路径的 IIS 应用程序。如果调用应用程序，将为每个此类 IIS 应用程序创建一个 AppDomain。

例如：

*   [http://myServer/App1](http://myServer/App1)
*   [http://myServer/App2](http://myServer/App2)

如果两者都针对相同的路径，它们仍然算作两个不同的应用程序，并且将创建两个 AppDomain。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-01-05T10:10:21.543

正如另一个线程中的以下答案[https://stackoverflow.com/a/3318367/2001769](https://stackoverflow.com/a/3318367/2001769)所建议的那样 ，ASP.NET 运行时似乎保留了一个 HttpApplication 实例池（与 maxProcesses / Web Garden 无关）。

我不知道控制这个池是否可能，甚至是可取的。最佳实践可能是在 Application_Start 事件中实例化所有应用程序单例，该事件应该每个应用程序只运行一次，而不是每个池化的 HttpApplication 实例运行一次。

# wordpress - 无法安装 bbpress 主题

> ID：10922979
> 
> 赞同：2
> 
> 时间：2012-06-06T22:05:30.123
> 
> 标签：wordpress, bbpress

我遇到了 wordpress 和 bbpress 插件的问题。我需要安装一个 bbpress 主题，但我似乎无法让它们出现在管理员中，尽管我把它放在了正确的目录中。我也尝试过其他主题，结果相同。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T21:52:46.840

这有点 hacky，但我可以`bbpress`通过构建一个子主题来设置主题。通过创建子主题而不是直接更改插件主题，您将确保在更新插件时不会覆盖您的样式更改。

1.  首先从插件文件夹中复制`bbpress`主题（我开始处理`bbp-twentyten`主题），然后将其粘贴到**Wordpress**主题文件夹中。使用您希望`bbpress`调用新主题的任何名称重命名它。进入*主题**>**您的子主题的名称**>** style.css* 并将其添加到标题中：

    `@import url('../ the name of your parent theme /style.css');`

    *   主题名称：您的孩子主题的名称
    *   描述：子主题的描述。
    *   作者：你的名字
    *   模板：您的父主题的名称
2.  进入**Wordpress仪表板的***外观**>**主题*区域，看看是否出现了新主题。如果是，请安装它。

     **您的网站应该看起来与以前完全一样。发生的情况是 @import url 允许主题从父主题中提取所有样式，然后您可以覆盖它们而不会弄乱原始主题。** 
***   现在在*主题****>*** *your-child-theme*`style.css`中编辑文件。请注意，如果您进行的更改似乎没有加载，您可能需要在样式中添加一个 !important。**

# internet-explorer-9 - IE9 在边框半径上没有子像素抗锯齿

> ID：10922989
> 
> 赞同：4
> 
> 时间：2012-06-06T22:06:44.387
> 
> 标签：internet-explorer-9, css

我已经申请`border-radius`了一个 div，结果在 IE9 中的渲染效果很差。我知道我可能要求太多了，但这仍然是根本不应该发生的事情。

向客户解释什么是亚像素抗锯齿是非常困难的。

这是我的 CSS：

```
-moz-border-radius: 10px;
-webkit-border-radius: 10px;
 border-radius: 10px; 
```

![在此处输入图像描述](../Images/f5fc8abcf342f1f76b874483a266f192.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-06T22:49:35.717

我相信我知道问题出在哪里。看起来您正在使用圆角元素中的背景图像。IE 不喜欢这样。如果这确实是导致您的问题的原因，那么您可以通过添加第二个元素来解决它。

父元素需要隐藏圆角边缘和溢出。子元素获取背景图像。

我只能在 Windows 8 发布预览版的 IE10 中对此进行测试（有同样的问题），但我相当肯定它在 IE9 中是一样的。

示例代码：

```
.wrap {
    margin: 100px auto;
    width: 80%;
    border-radius: 50%;
    overflow: hidden;
}

.wrap .content {
    min-height: 400px;
    background: url('bg.jpg');
} 
```

# javascript - 操作更新img.src引起的http请求

> ID：10922990
> 
> 赞同：5
> 
> 时间：2012-06-06T22:06:45.207
> 
> 标签：javascript, html

我目前正在为 iOS 和 Android 创建一个混合移动应用程序（请参阅 phonegap/cordova），并在更新图像的 img.src url（我经常这样做）时注意到 Android http 请求如下所示。

我的问题是它不包含所有重要的 Accept 标头（Accept: */*），因此服务器无法加载图像并返回（HTTP/1.1 406 Not Acceptable）。Chrome/iOS 在更新 img.src url 时在其 http 请求中包含此 Accept 标头。

*我的问题是*，有没有办法附加此标头或执行包含此标头以供后续 img.src 更新的操作？

**安卓 Http 请求：**

```
GET /system/data/ba9320b8-e093-47a9-8858-c6343febf3ec/frame?t=1339017043002 HTTP/1.1
Host: MyHostName
Connection: keep-alive
User-Agent: Mozilla/5.0 (Linux; U; Android 4.0.2; en-us; Galaxy Nexus Build/ICL53F)
AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30
Accept-Encoding: gzip,deflate
Accept-Language: en-US
Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7
Cookie: auth_token=0882f24f-04d7-4f05-9475-cfe2a94af5bf 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-21T12:47:34.753

查看[Google 实施](http://closure-library.googlecode.com/svn/docs/closure_goog_net_imageloader.js.source.html#line173)以处理所有此类问题的兼容性问题。这是来自与PhoneGap兼容的闭包库内部（至少他们是这么说的：）

基本上，您需要做的是更改 http 请求的标头。原生 xhr 对象有一个名为 setRequestHeader(param, value); 的方法；它可以满足您的需求。在 Android 上使用[远程调试](https://developers.google.com/chrome/mobile/docs/debugging)来查看发送了哪些标头以及发送到何处。

不知道你用的是什么库。Google Closure Library 让您将请求标头作为对象参数传递给 xhr 实例的 send 方法（请[参阅](http://closure-library.googlecode.com/svn/docs/class_goog_net_XhrIo.html)），因此非常简单。据我所知，jQuery 也有类似的行为。

```
$.ajax({
         url: "http://someurl",
         data: { signature: authHeader },
         type: "GET",
         beforeSend: function(xhr){xhr.setRequestHeader('X-Test-Header', 'test-value');}
         success: function() { alert('Success!' + authHeader); }
      }); 
```

# jsf-2 - JSF2 重定向问题

> ID：10922994
> 
> 赞同：0
> 
> 时间：2012-06-06T22:07:16.977
> 
> 标签：jsf-2, richfaces

我有登录页面和仪表板页面。

登录过程完成后，将显示仪表板页面（使用导航规则）。

```
 <navigation-rule>
        <from-view-id>/login.xhtml</from-view-id>
        <navigation-case>
            <from-outcome>dashboard</from-outcome>
            <to-view-id>/viewp/dashboard.xhtml</to-view-id>
        </navigation-case>
    </navigation-rule> 
```

我有所有请求的过滤器映射。

这是我的场景，我的仪表板页面上有客户端轮询器。当服务器重新启动时，轮询器发送请求，过滤器将解释该请求。

在过滤器内部我有类似的逻辑

```
If(url.contains("login.xhtml))
{
//dofilter
}else
{
// redirect to login.
} 
```

但不知何故，这不是重定向。

我的一个观察结果是，即使我在仪表板页面上登录后，我的 URL 仍然像`mydomain/login.xhtml`. 我认为因为浏览器中的 URL 是`mydomain/login.xhtml`，`response.redirect("mydomain/login.xhtml")`不起作用。有什么建议么？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T23:06:57.407

轮询器是由 JavaScript/Ajax 执行的，对吧？好吧，如果服务器返回 302 而不是 200，您必须检查 JavaScript/Ajax 并进行相应处理。浏览器本身不会对返回的 JavaScript/Ajax 响应自动执行此操作，而只会对同步请求的响应执行此操作。

您可以`window.location`在 JavaScript 中使用来执行“重定向”。例如

```
if (ajaxResponseStatus == 302) {
    window.location = newURL;
} 
```

# c# - Mongodb，linq 驱动程序。如何使用变量或语句构造包含

> ID：10922998
> 
> 赞同：5
> 
> 时间：2012-06-06T22:07:30.893
> 
> 标签：c#, .net, linq, mongodb, mongodb-.net-driver

我正在使用 C# 的 Mongo LINQ 驱动程序，效果很好。

对很多属性进行排序，但这是我无法解决的问题，它可能很简单。

```
var identifierList = new []{"10", "20", "30"};
var newList = list.Where(x => identifierList.Contains(x.Identifier));

This is NOT supported ... 
```

所以我可以做类似的事情：

```
 var newList = list.Where(x => x.Identifier == "10" || x.Identifier == "20" || x.Identifier == "30"); 
```

但是由于列表是可变的……我该如何构造上面的内容？还是有更好的选择？

是`list`类型`IQueryable<MyCustomClass>`

有关信息...这被用作许多属性的过滤器。在 SQL 中，我可以有一个父 -> 子关系。但由于我不能作为主 ID 的父级，我需要取出所有 ID，然后像这样构造它。

希望这是有道理的。如果需要我会解释更多。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-07T09:02:36.057

回答我自己的问题...... Mongo Sharp LINQ 驱动程序有一个名为“In”的扩展方法，它完全符合我的需要。

然而，他们已经在 1.5 中实现了它，所以我们可以使用旧的方式，比如：[https ://jira.mongodb.org/browse/CSHARP-462](https://jira.mongodb.org/browse/CSHARP-462)

```
 var list = new []{"10", "10"};

 search.Where(x => list.Contains(x.Id)); 
```

但是 1.5 版本的包还没有在 nuget 上。

但是，这应该与 mongo-csharp-driver 带来的特别惊喜的“In”扩展一起使用。

```
 search.Where(x => x.In(list)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T22:24:39.953

```
var identifierList = new []{"10", "20", "30"};
var newList = list.ToList().Where(x => identifierList.Contains(x.Identifier)); 
```

您只需要使用 List 而不是 Ienumerable（通过使用 .ToList() 来实现）

如果它不起作用，请添加您的列表类型