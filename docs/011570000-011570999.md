# StackOverflow 问答 11570000-11570999

# parallel-processing - 有什么方法可以在matlab中为spmd命令添加开关？

> ID：11570004
> 
> 赞同：3
> 
> 时间：2012-07-19T22:02:51.777
> 
> 标签：parallel-processing, matlab

我正在使用 matlab2011 进行多核并行计算，这在我的代码中只是使用块 SPMD END 实现的。但是，有一段时间，我想根据输入参数关闭程序中的spmd。我尝试以下代码，但它不起作用

```
if (switchSpmdOn)
  spmd
end
% here I put my code for calculation in parallel or series
if (switchSpmdOn)
  end % this end is used to close the spmd block
end 
```

我想知道代码中是否有类似 marco 的东西来关闭 spmd。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T23:05:34.833

您可以将工作人员的数量作为参数传递给`spmd`. 如果指定的工人数量是`0`，*即*，

```
spmd(0)
   statement; %# block body
end 
```

然后 MATLAB 将在本地执行块体并创建复合对象，就像没有可用的池一样。

**例子**

```
switchSpmdOn = true;

%# set the number of workers
if (switchSpmdOn)
    workers = 3; 
    matlabpool(workers);
else
    workers = 0;
end

%# application. if 'workers' is 0, MATLAB will execute this code locally
spmd (workers)
    %# build magic squares in parallel
    q = magic(labindex + 2);
end

for ii=1:length(q)
  % plot each magic square
  figure, imagesc(q{ii});
end

if (switchSpmdOn)
    matlabpool close
end 
```

# objective-c - 如何让我的 UITableViewCell 不仅有标题和副标题，还有标题、副标题（日期）和另一个标签（摘要）？

> ID：11570008
> 
> 赞同：0
> 
> 时间：2012-07-19T22:03:20.887
> 
> 标签：objective-c, xcode, uitableview, rss

试图让我的 RSS Feed 应用程序在标签内有摘要，我已经解析了描述（摘要），但我不明白如何在 UITableViewCell 中添加它。我目前正在使用 UITableViewCellStyleSubtitle，所以我可以显示每个帖子的标题及其下方的日期。**如何在其下方再添加一个以显示每个帖子的摘要？**

**MasterViewController.h（TableView 标题）**

```
#import <UIKit/UIKit.h>

@class RSSChannel;
@class WebViewController;

@interface MasterViewController : UITableViewController
<NSXMLParserDelegate>
{
    NSURLConnection *connection;
    NSMutableData *xmlData;

    RSSChannel *channel;
}
- (void)fetchEntries;
@property (nonatomic, strong) WebViewController *webViewController;

@end 
```

**MasterViewController.m（TableView 实现）**

```
#import "MasterViewController.h"
#import "RSSChannel.h"
#import "RSSItem.h"
#import "WebViewController.h"

@interface MasterViewController () {
    NSMutableArray *_objects;
}
@end

@implementation MasterViewController
@synthesize webViewController;

- (void)awakeFromNib
{
    [super awakeFromNib];
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
    [self fetchEntries];
}

- (void)viewDidUnload
{
    [super viewDidUnload];
    // Release any retained subviews of the main view.
}

- (void)insertNewObject:(id)sender
{
    if (!_objects) {
        _objects = [[NSMutableArray alloc] init];
    }
    [_objects insertObject:[NSDate date] atIndex:0];
    NSIndexPath *indexPath = [NSIndexPath indexPathForRow:0 inSection:0];
    [self.tableView insertRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationAutomatic];
}

#pragma mark - Table View

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    NSLog(@"The amount of items in the table: %u", [[channel items] count]);
    return [[channel items] count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UITableViewCell *cell = [tableView
                             dequeueReusableCellWithIdentifier:@"UITableViewCell"];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle
                                      reuseIdentifier:@"UITableViewCell"];

    }
     RSSItem *item = [[channel items] objectAtIndex:[indexPath row]];

    [[cell textLabel] setText:[item title]];
    [[cell detailTextLabel] setText:[item date]];
    return cell;
}

- (void)fetchEntries
{
    // Create a new data container for the stuff that comes back from the service
    xmlData = [[NSMutableData alloc] init];

    // Construct a URL that will ask the service for what you want -
    // Note we can concatenate literal strings together on multiple lines in this way it 
    // results in a single NSString instance
    NSURL *url = [NSURL URLWithString:
                  @"http://sephardijews.com/feed/"];

    // Putting the URL we made into an NSURLRequest, so we can connect to the url data that we specifed
    NSURLRequest *req = [NSURLRequest requestWithURL:url];

    // Creating a connecting that will exchange this request for the data from the URL we specifed
    connection = [[NSURLConnection alloc] initWithRequest:req
                                                 delegate:self 
                                         startImmediately:YES];
}

- (void)parser:(NSXMLParser *)parser
    didStartElement:(NSString *)elementName 
    namespaceURI:(NSString *)namespaceURI
   qualifiedName:(NSString *)qualifedName 
    attributes:(NSDictionary *)attributeDict
{
    NSLog(@"%@ found a %@ element", self, elementName);
    if ([elementName isEqual:@"channel"]) {

        // If the parser saw a channel, create new instance, store in our ivar
        channel = [[RSSChannel alloc] init];

        // Give the channel object a pointer back to ourselves for later
        [channel setParentParserDelegate:self];

        // Set the parser's delegate to the channel object
        [parser setDelegate:channel];
    }
}

// Method used to start at the beginning of the instance of the tableview, it will intialize the connection method to retrieve the posts from the URL

/* - (id) initWithStyle:(UITableViewStyle)style
{
    self = [super initWithStyle:style];

    if (self) {
        [self fetchEntries];
    }

    return self;
}
 */

// This method will be called several times as the data arrives
- (void)connection:(NSURLConnection *)conn didReceiveData:(NSData *)data
{
    // Add the incoming chunk of data to the container we are keeping
    // The data always comes in the correct order
    [xmlData appendData:data];
}

- (void)connectionDidFinishLoading:(NSURLConnection *)conn
{
    // Create the parser object with the data received from the web service
    NSXMLParser *parser = [[NSXMLParser alloc] initWithData:xmlData];

    // Give it a delegate - don't worry about the warning
    [parser setDelegate:self];

    // Tell it to start parsing - the documet will be parsed and the delegate of NSXMLParser will get all of its delegate messages sent to it before this line finishes execution - it is blocking
    [parser parse];

    // Get rid of the XML data as we no longer need it
    xmlData = nil;

    // Get rid of the connection, no longer need it
    connection = nil;

    // Reload the table
    [[self tableView] reloadData];
    NSLog(@"%@\n %@\n %@\n", channel, [channel title], [channel infoString]);

}

- (void)connection:(NSURLConnection *)conn didFailWithError:(NSError *)error
{
    // Release the connection object, we are done with it cause' there is no connection
    // Setting the connection to nil will stop the connection because it is nothing/0
    connection = nil;

    // Release the xmlData object. We stopped to connection to put the data in the xmlData object, so we set it to nil also
    xmlData = nil;

    // Grab the description of the error object passed to us, so we can tell the user
    NSString *errorString = [NSString stringWithFormat:@"Fetch failed: %@", [error localizedDescription]];

    // Create and show an alert view to the user with the error string to tell them the error in the process of the connection
    UIAlertView *av = [[UIAlertView alloc] initWithTitle:@"Error" 
                                                 message:errorString
                                                delegate:nil 
                                       cancelButtonTitle:@"OK"
                                       otherButtonTitles:nil];

    [av show];
}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
     // Push the web view controller onto the navigation stack - this implicitly
    // creates the web view controller's view the first time through
    [[self navigationController] pushViewController:webViewController animated:YES];

    //Grab the selected item
    RSSItem *entry = [[channel items] objectAtIndex:[indexPath row]];

    //Constructs a URL with the link string of the item
    NSURL *url = [NSURL URLWithString:[entry link]];

    // Construct a request object with that URL
    NSURLRequest *req = [NSURLRequest requestWithURL:url];

    // Load the request into the web view
    [[webViewController webView] loadRequest:req];

    // Set the title of the web view controller's navifation item
    [[webViewController navigationItem] setTitle:[entry title]]; 

}

/*
// Override to support rearranging the table view.
- (void)tableView:(UITableView *)tableView moveRowAtIndexPath:(NSIndexPath *)fromIndexPath toIndexPath:(NSIndexPath *)toIndexPath
{
}
*/

/*
// Override to support conditional rearranging of the table view.
- (BOOL)tableView:(UITableView *)tableView canMoveRowAtIndexPath:(NSIndexPath *)indexPath
{
    // Return NO if you do not want the item to be re-orderable.
    return YES;
}
*/

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T22:57:42.027

尝试将 UITableViewCellStyle 更改为自定义并将您自己的 UITextLabel 对象拖到原型单元格中。`@property`为 TableViewController 中的每个数据项制作s...

```
@interface MasterViewController () 

    NSMutableArray *_objects;
    @property (nonatomic, strong) IBOutlet UILabel *title;
    @property (nonatomic, strong) IBOutlet UILabel *date;
    @property (nonatomic, strong) IBOutlet UILabel *summary;

@end 
```

然后将 UITextLabels 连接到它们各自的数据。

# c# - 使用 powershell 调用 Visual Studio 方法

> ID：11570011
> 
> 赞同：0
> 
> 时间：2012-07-19T22:03:30.947
> 
> 标签：c#, .net, powershell

我正在尝试编写一个 powershell 脚本来调用位于我的 Visual Studio (2010) 解决方案中的方法。调用的语法是什么，例如，像这样的方法

```
public void CreateData(string s, int i) 
```

?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-20T02:39:06.893

您可以将您的类库项目编译成 dll，然后在 powershell 中使用反射加载 dll。这是一个例子：

c#代码：

```
public class MyClass {
    public void CreateData(string s, int i) {
        // your logic here
    }
} 
```

电源外壳代码：

```
$lib = [Reflection.Assembly]::LoadFile("C:\path\to\MyClass.dll")
$obj = new-object MyClass
$result = $obj.CreateData("s_value",5) 
```

此代码假定您的课程名为“MyClass”。您可能必须先在 powershell 中运行 set-executionpolicy RemoteSigned。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T22:18:21.643

我会创建一个这样的程序：

```
class Program
{
    static void Main(string[] args)
    {
        if(args.Length > 1)
            CreateData(args[0], int.Parse(args[1]));
    }

    public static void CreateData(string s, int i)
    {
        File.WriteAllText(@"C:\data.txt", 
              string.Format("This is some data:  s = {0}  i = {1}", s, i)); 
    }
} 
```

然后在程序编译后我有可执行文件“ConsoleApp.exe”

我启动以下 powershell 脚本：

```
& "Path_Of_The_Program\ConsoleApp.exe" "MyText" 100 
```

它成功地将数据写入我的文件中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T22:09:17.343

您将需要构建您的 C# 类并使用 InvokeCSharp 之类的东西来调用 CreateData 方法

请参阅链接以获取一个很好的示例[http://vincenth.net/blog/archive/2009/10/27/call-inline-c-from-powershell-with-invokecsharp.aspx](http://vincenth.net/blog/archive/2009/10/27/call-inline-c-from-powershell-with-invokecsharp.aspx)

# git - 运行 git clean 是否会对未来的结帐产生某种永久性影响？

> ID：11570013
> 
> 赞同：0
> 
> 时间：2012-07-19T22:03:36.063
> 
> 标签：git

我有一个非常简单的 git 存储库，我一直在用它来学习 git。除了 ; 我还有两个分支`master`；`javafx`, `netty`. 我在每个分支中创建了一个新的项目模块。对于`netty`分支，项目布局如下所示：

```
sandbox
  netty 
```

对于`javafx`分支，项目布局如下所示：

```
sandbox
  javafx 
```

每当我过去在分支之间切换时，我的工作目录中仍然会有来自另一个分支的目录。我经常切换分支，额外的目录从未被删除。我决定我应该学会正确地清理我的工作目录，在`netty`分支上，我跑了：

```
git clean -fd 
```

它完全符合我的预期，但现在 Git 的结帐行为似乎有所不同。当我从`netty`分支切换到`javafx`分支时，就像以前一样；额外的`netty`目录保留在我的工作目录中。但是，现在当我从`javafx`分支切换到`netty`分支时，`javafx`目录会自动删除/清理。

但是，如果我在另一台机器上克隆 repo，它仍然可以像以前那样工作；所有未跟踪的文件都留在我的工作目录中。`git clean -fd`有某种永久性的影响吗？

编辑：玩了一些之后，我意识到这与我的 IDE（IntelliJ IDEA）有关。当我检查另一个不包含这些项目模块的分支时，Git 似乎无法删除活动项目模块的目录。

例如，如果我在我的`netty`分支上并签出该`javafx`分支，Git 似乎无法删除该`netty`目录。但是，如果我重新签出分支而不重新生成我的 IDEA 项目，Git 删除目录`netty`没有问题。`javafx`

在我的 IDE 阻止这些目录被删除一次后，它们将作为未跟踪的文件永远存在于我的本地存储库中，直到我运行`git clean -fd`. 即使关闭我的 IDE 并在分支之间切换也不会改变任何事情。

如果我在没有启动 IDE 的情况下克隆存储库并签出分支，一切都会像我预期的那样工作。当我签出一个新分支时，不相关的目录将被删除。

如果另一个进程阻止它在签出新分支时删除不需要的文件，Git 会如何反应？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T22:14:35.913

从 git-help 的手册页

> 从当前目录开始，通过递归删除不受版本控制的文件来清理工作树。
> 
> 通常，只删除 git 未知的文件，但如果指定了 -x 选项，也会删除忽略的文件。例如，这对于删除所有构建产品很有用。
> 
> 如果给出任何可选的 ... 参数，则只有那些路径受到影响。

本质上**git clean -fd**会删除本地副本中所有未跟踪的文件和目录，但 .gitignore 中忽略的文件除外。

我怀疑您已经开始在其中一个分支中错误地跟踪那些生成的文件。

# ruby - 使用 key:value 行创建 Ruby 哈希

> ID：11570014
> 
> 赞同：0
> 
> 时间：2012-07-19T22:03:47.700
> 
> 标签：ruby, parsing, hashtable

这是另一个“在 Ruby 中做 X 的最优雅方式是什么”类型的问题。考虑来自 web 服务的响应，在返回主体的每一行上都有键：值对，沿着

```
key1:val1
key2:val2
key3:val3 
```

我想用这些数据创建一个 Ruby 哈希，`{"key1" => "val1", ...}`. 从算法上讲，我可以完成

```
hash = {}
body.lines.each do |line|
  key, val = line.split(':')
  hash[key] = val
end 
```

但我猜有一个更优雅的单线或两线。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T22:14:00.347

这是我的建议：

```
lines = [
  'key1:val1',
  'key2:val2',
  'key3:val3'
]

hash = Hash[lines.map {|it| it.split(':', 2)}] 
```

**解释**

[`Hash[object]`](http://www.ruby-doc.org/core-1.9.3/Hash.html#method-c-5B-5D)从对象创建一个新的哈希。对象是以下之一：

*   元素列表
*   对列表
*   可以转换为哈希的对象

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T22:17:41.533

如果您有成对的对象，那么`Hash[]`您的朋友就是：

```
Hash[lines.map {|key_val| key_val.split(":")}]
=> {"key1"=>"val1", "key2"=>"val2", "key3"=>"val3"} 
```

妈的，太慢了……

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T22:28:59.597

帖子中有插入符号返回，所以真正的主题解决方案是

```
hash = Hash[lines.split(/\s/).map {|line| line.split(':', 2)}] 
```

# objective-c - AVAssetReader/Writer 仅适用于某些设备？

> ID：11570024
> 
> 赞同：1
> 
> 时间：2012-07-19T22:04:49.013
> 
> 标签：objective-c, ios, jailbreak, avassetwriter

我正在使用[本](http://www.subfurther.com/blog/2010/12/13/from-ipod-library-to-pcm-samples-in-far-fewer-steps-than-were-previously-necessary/)教程从音乐库中获取一首歌曲到我指定的目录。它对我来说很好，但其他人报告说这首歌永远不会到达那里。起初我认为存在设备限制，但似乎与我使用相同设备的人遇到了问题。这有点烦人，因为我无法重现他们的问题。

这是我的代码：

```
{
    NSURL *assetURL = [song valueForProperty:MPMediaItemPropertyAssetURL];
    AVURLAsset *songAsset = [AVURLAsset URLAssetWithURL:assetURL options:nil];

    NSError *assetError = nil;
    AVAssetReader *assetReader = [[AVAssetReader assetReaderWithAsset:songAsset
                                                                error:&assetError]
                                  retain];
    if (assetError) {
        NSLog (@"error: %@", assetError);
        return;
    }

    AVAssetReaderOutput *assetReaderOutput = [[AVAssetReaderAudioMixOutput 
                                               assetReaderAudioMixOutputWithAudioTracks:songAsset.tracks
                                               audioSettings: nil]
                                              retain];
    if (! [assetReader canAddOutput: assetReaderOutput]) {
        NSLog (@"can't add reader output... die!");
        return;
    }
    [assetReader addOutput: assetReaderOutput];

    NSString *exportPath = @"Library/PreferenceBundles/MyAlarmSettings.bundle/export.m4a";
    if ([[NSFileManager defaultManager] fileExistsAtPath:exportPath]) {
        [[NSFileManager defaultManager] removeItemAtPath:exportPath error:nil];
    }

    NSURL *exportURL = [NSURL fileURLWithPath:exportPath];
    AVAssetWriter *assetWriter = [[AVAssetWriter assetWriterWithURL:exportURL
                                                           fileType:AVFileTypeAppleM4A
                                                              error:&assetError]
                                  retain];
    if (assetError) {
        NSLog (@"error: %@", assetError);
        return;
    }
    AudioChannelLayout channelLayout;
    memset(&channelLayout, 0, sizeof(AudioChannelLayout));
    channelLayout.mChannelLayoutTag = kAudioChannelLayoutTag_Stereo;

    NSDictionary *outputSettings = [NSDictionary dictionaryWithObjectsAndKeys:
                                    [ NSNumber numberWithInt: kAudioFormatMPEG4AAC], AVFormatIDKey,
                                    [ NSNumber numberWithInt: 2 ], AVNumberOfChannelsKey,
                                    [ NSNumber numberWithFloat: 44100.0 ], AVSampleRateKey,
                                    [ NSData dataWithBytes:&channelLayout length: sizeof( AudioChannelLayout ) ], AVChannelLayoutKey,
                                    [ NSNumber numberWithInt: 320000 ], AVEncoderBitRateKey,
                                    nil];                

    AVAssetWriterInput *assetWriterInput = [[AVAssetWriterInput assetWriterInputWithMediaType:AVMediaTypeAudio
                                                                               outputSettings:outputSettings]
                                            retain];
    if ([assetWriter canAddInput:assetWriterInput]) {
        [assetWriter addInput:assetWriterInput];
    } else {
        NSLog (@"can't add asset writer input... die!");
        return;
    }

    assetWriterInput.expectsMediaDataInRealTime = NO;

    [assetWriter startWriting];
    [assetReader startReading];

    AVAssetTrack *soundTrack = [songAsset.tracks objectAtIndex:0];
    CMTime startTime = CMTimeMake (0, soundTrack.naturalTimeScale);
    [assetWriter startSessionAtSourceTime: startTime];

    __block UInt64 convertedByteCount = 0;

    dispatch_queue_t mediaInputQueue = dispatch_queue_create("mediaInputQueue", NULL);
    [assetWriterInput requestMediaDataWhenReadyOnQueue:mediaInputQueue 
                                            usingBlock: ^ 
     {
         // NSLog (@"top of block");
         while (assetWriterInput.readyForMoreMediaData) {
             CMSampleBufferRef nextBuffer = [assetReaderOutput copyNextSampleBuffer];
             if (nextBuffer) {
                 // append buffer
                 [assetWriterInput appendSampleBuffer: nextBuffer];
                 //             NSLog (@"appended a buffer (%d bytes)", 
                 //                    CMSampleBufferGetTotalSampleSize (nextBuffer));
                 convertedByteCount += CMSampleBufferGetTotalSampleSize (nextBuffer);
                 // oops, no
                 // sizeLabel.text = [NSString stringWithFormat: @"%ld bytes converted", convertedByteCount];

                 NSNumber *convertedByteCountNumber = [NSNumber numberWithLong:convertedByteCount];
                 [self performSelectorOnMainThread:@selector(updateSizeLabel:)
                                        withObject:convertedByteCountNumber
                                     waitUntilDone:NO];
             } else {
                 // done!

                 NSString *songtitle =  [[NSString alloc]initWithFormat:@"Alarm sound set to '%@' \n \n Press OK to respring. ",[song valueForProperty:MPMediaItemPropertyTitle]];

                 UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Done!" message:songtitle delegate:self cancelButtonTitle:@"OK" otherButtonTitles:nil];
                 [alert show];
                 [alert release];

                 [assetWriterInput markAsFinished];
                 [assetWriter finishWriting];
                 [assetReader cancelReading];
                 NSDictionary *outputFileAttributes = [[NSFileManager defaultManager]
                                                       attributesOfItemAtPath:exportPath
                                                       error:nil];
                 NSLog (@"done. file size is %llu",
                        [outputFileAttributes fileSize]);
                 NSNumber *doneFileSize = [NSNumber numberWithLong:[outputFileAttributes fileSize]];
                 [self performSelectorOnMainThread:@selector(updateCompletedSizeLabel:)
                                        withObject:doneFileSize
                                     waitUntilDone:NO];
                 // release a lot of stuff

                 [assetReader release];
                 [assetReaderOutput release];
                 [assetWriter release];
                 [assetWriterInput release];
                 [exportPath release];
                 break;
             }
         }

     }];

    NSLog (@"bottom of convertTapped:");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-06-14T18:42:20.130

如果您从用户 iPod 库中访问 mediaItems，他们可能在云中。利用

[self.mediaItem valueForProperty:MPMediaItemPropertyIsCloudItem]

据我所知，您无法访问这些资产或强制它们流式传输

# c# - 使用 C# 的音量计

> ID：11570025
> 
> 赞同：-4
> 
> 时间：2012-07-19T22:05:03.460
> 
> 标签：c#, volume, microphone, naudio

我想问一下如何为流式音频编程音量电平表。仅使用笔记本电脑的库存麦克风，我想知道它的声级。分贝（dB）。我们的项目是制作一个音量电平表，它可以为我们的真实程序提供输入，该程序将获得分贝并将其转化为数值。

笔记：

编程知识：本科生 使用编译器：Microsoft Visual Studio 2010 操作系统：Windows 7 Professional x64bit / Ultimate x64Bit

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T22:10:39.137

我会看看[DirectSound](http://msdn.microsoft.com/en-us/library/windows/desktop/ee416960.aspx)可以用来[捕捉波形](http://msdn.microsoft.com/en-us/library/windows/desktop/ee416968.aspx)。这将为您提供（通常至少）16 位[分辨率](http://en.wikipedia.org/wiki/Audio_bit_depth)（96Db*动态*）的样本。在特定时期（例如，1/60 秒）内这些值的最大/最小差异将是该帧的音量。“比例”从 -32768（最低幅度）到 32767（最高幅度）。

如果您将这些值“绘制”在代表每帧音量的条中，您将获得您正在寻找的“弹跳音量条”。

只有校准最大值才能确定您正在寻找的*实际分贝。*音量到已知的 # 分贝。这是因为输入增益、麦克风的质量和许多其他变量，最终只能告诉（“波形”）“波形”。测量的最大/最小幅度不对应于（比如说）50 或 120 的特定分贝值。

# javascript - 正则表达式/jquery 在 div 中查找域（url）并附加参数

> ID：11570033
> 
> 赞同：-1
> 
> 时间：2012-07-19T22:05:54.677
> 
> 标签：javascript, jquery, regex

[以前的堆栈溢出](https://stackoverflow.com/questions/11422274/jquery-to-identify-url-and-append-parameters)

此 jquery 语句将查找 domain.com 并将 ? 参数附加到 URL 的末尾。如果 ? 参数已经添加，它将不会附加。

问题：我当前的 jquery 修改了所有 URL 而不是 domain.com。这是我想使用并经过测试可以工作的正则表达式语句。但是，在实施时，没有附加任何内容。任何帮助是极大的赞赏！

我想使用的正则表达式：

```
\b(https?://)?([a-z0-9-]+\.)*domain\.com(/[^\s]*)? 
```

[正则表达式小提琴](http://fiddle.re/6gwv)

[JSFiddle](http://jsfiddle.net/nJCtC/)为方便起见

待修改代码

```
<div id="wp-content-editor-container" class="wp-editor-container"><textarea class="wp-editor-area" rows="10" tabindex="1" cols="40" name="content" id="content">&lt;a title="Link to test domain" href="http://www.domain.com"&gt;Link to google&lt;/a&gt;
&lt;a href="http://www.google.com/directory/subdirectory/index.html"&gt;This is another link&lt;/a&gt;
&lt;a href="http://domain.com/directory/index.html"&gt;This is a 3rd link&lt;/a&gt;

&lt;a href="http://www.domain.com/subdir?parameter"&gt;this url already has parameters&lt;/a&gt;</textarea></div> 
```

当前的 jquery 语句

```
var url = 'www.domain.com';
var append = '?parameter';

$(".wp-editor-area").each(function() {
    $(this).text(urlify($(this).text()));
});

function urlify(text) {
    var urlRegex = /(\b(https?|ftp|file):\/\/[www.domain.com][-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig;
    return text.replace(urlRegex, function(url) {
        // if the url does not contain append, concat append to the URL
        if (url.indexOf(append) == -1) {
            return url + append;
        }
        return url;
    });

} 
```

电流输出

```
 <a title="Link to test domain" href="http://www.domain.com?parameter">Link to google</a>
<a href="http://www.google.com/directory/subdirectory/index.html?parameter">This is another link</a>
<a href="http://domain.com/directory/index.html?parameter">This is a 3rd link</a> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T12:24:42.677

测试此代码 - 它应该是您需要*的（或至少是起点）* >>

```
function urlify(text) {
  var append = '?parameter';
  text = text.replace(/("(?:(?:https?|ftp|file):\/\/)?(?:www.|)domain.com(?:\/[-a-z\d_.]+)*)(\?[^"]*|)(")/ig,
    function(m, m1, m2, m3) {
      return ((m1.length != 0) && (m2.length == 0)) ? m1 + append + m3 : m;
    });
  return text;
}

$(".wp-editor-area").each(function() {
  this.innerHTML = urlify(this.innerHTML);
}); 
```

# node.js - 在 mac 上安装 JSDOM 的问题

> ID：11570034
> 
> 赞同：7
> 
> 时间：2012-07-19T22:05:58.793
> 
> 标签：node.js, jsdom

使用此命令：npm install jsdom，试图让 jsdom 启动并运行以与 node.js 服务器一起使用，我收到以下一系列错误。有人可以帮助澄清这个问题吗？我认为可能还有一个问题，因为它无法安装 contextify ......提前谢谢！

```
npm http GET https://registry.npmjs.org/jsdom
npm http 304 https://registry.npmjs.org/jsdom
npm http GET https://registry.npmjs.org/htmlparser
npm http GET https://registry.npmjs.org/cssom
npm http GET https://registry.npmjs.org/contextify
npm http 304 https://registry.npmjs.org/contextify
npm http 304 https://registry.npmjs.org/cssom
npm http 304 https://registry.npmjs.org/htmlparser
npm WARN package.json cssom@0.2.5 No README.md file found!
npm http GET https://registry.npmjs.org/bindings
npm http 304 https://registry.npmjs.org/bindings

> contextify@0.1.3 install /Users/dereklo/node_modules/jsdom/node_modules/contextify
> node-gyp rebuild

gyp ERR! rebuild error Error: not found: make
gyp ERR! rebuild error     at F (/usr/local/lib/node_modules/npm/node_modules/which/which.js:43:28)
gyp ERR! rebuild error     at E (/usr/local/lib/node_modules/npm/node_modules/which/which.js:46:29)
gyp ERR! rebuild error     at /usr/local/lib/node_modules/npm/node_modules/which/which.js:57:16
gyp ERR! rebuild error     at Object.oncomplete (fs.js:297:15)
gyp ERR! not ok 
npm WARN optional dep failed, continuing contextify@0.1.3
jsdom@0.2.15 node_modules/jsdom
├── cssom@0.2.5
└── htmlparser@1.7.6 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-21T16:19:09.860

您需要 GCC 来编译这些 node.js 模块。

1.  前往 App Store 并免费下载最新版本的 Xcode。
2.  安装 Xcode（应用商店实际上下载了 Xcode 的“安装程序”）
3.  启动 Xcode
4.  转到首选项
5.  前往下载
6.  点击“命令行工具”后的“安装”按钮
7.  重启

完毕！:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-29T13:00:43.050

在确保安装了 XCode 命令行工具后，我仍然遇到`npm install jsdom`. 事实证明我仍在运行我的节点服务器，所以安装会失败。对于可能遇到此问题的其他任何人，请务必按 Ctrl + C 停止您的服务器，然后执行`npm install jsdom`. 像魅力一样工作！:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-01-01T09:41:33.870

以上对我不起作用（Mac 上的节点版本 16.13.0）。我注意到部分错误`node-pre-gyp WARN Pre-built binaries not installable for canvas@2.6.1 and node@16.13.0`。

**所以我使用了 Node 版本 14.18.2 （使用[NVM](https://github.com/nvm-sh/nvm)）**，这在我的情况下很好。
（我认为跳过编译并使用预构建版本。）

然后`npm install`按预期工作。

# google-app-engine - Python27 中的动态后端 - 线程安全？

> ID：11570036
> 
> 赞同：1
> 
> 时间：2012-07-19T22:06:31.723
> 
> 标签：google-app-engine

我正在考虑利用动态后端来完成一些需要十多分钟才能完成的大规模推送任务队列式工作。动态后端根据我的任务队列量按需提供和“自动缩放”的能力非常有吸引力。

当使用“无”的“目标”配置这些队列时，这会导致这些队列使用前端实例进行处理。由于我使用带有线程安全的 Python27，这允许我的任务在更少的实例上由多个线程处理。我的应用程序做了很多 URLFetch-ing 和 time.sleep-ing，所以我觉得我有很多 CPU 能力要烧掉。

理想情况下，我想启动同一后端的 20 个后端实例，但同时运行尽可能多的“请求”。

问题是：后端的行为方式是否如此？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T01:05:12.117

是的，后端的行为方式应该相同。

# jquery - Jquery：选择 $(this) 的兄弟姐妹

> ID：11570038
> 
> 赞同：0
> 
> 时间：2012-07-19T22:07:08.713
> 
> 标签：jquery

我试图让 jquery 查看元素何时更改，然后运行一个涉及它的同级操作，如下所示：

```
$('.row').find('#class').change(function(){
        $(this).siblings('#teacher').removeAttr('disabled');
        var class_id = $(this).val();
    }); 
```

因此，当更改 id 的输入时，`class`它将获取其值，然后影响其 id 的兄弟姐妹`teacher`。它们都在里面，`<div class="row">`并且在页面上重复了几次。

的HTML：

```
<div class="row">
    <div class="grid_2">
        <select name="class" id="class">
        <option></option>
            //PHP that loads choices
        </select>
    </div>

        <div class="grid_2">
            <select name="teacher" id="teacher" disabled="true">
                 //Ajax loads choices
            </select>
        </div>
</div> 
```

这在整个页面中重复了几次。

我需要帮助的是如何在第一个（旁边）更改时选择第二个选择框。

谢谢您的帮助。

编辑：当我尝试 console.log`$(this).siblings()`时，它会返回`[]`。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T22:09:28.977

虽然您**永远不**应该拥有多个具有相同 ID 的元素，但如果这样做，您可以使用属性选择器来选择它们：

```
$(this).siblings('[id=teacher]'); 
```

有关详细信息，请参阅：[具有相同 ID 的多个元素响应一个 CSS ID 选择器](https://stackoverflow.com/questions/7262195/several-elements-with-the-same-id-responding-to-one-css-id-selector/7262229#7262229)

# objective-c - NSPredicate 用于集合中的最新项目

> ID：11570040
> 
> 赞同：0
> 
> 时间：2012-07-19T22:07:13.240
> 
> 标签：objective-c, ios, core-data, nspredicate

我的聊天应用程序中有以下对象（具有一对多关系）

```
@interface ChatEntry : NSManagedObject
@property (nonatomic, retain) NSString * text;
@property (nonatomic, retain) NSDate * timestamp;
@property (nonatomic, retain) ChatContext *context;
@end

@interface ChatContext : NSManagedObject
@property (nonatomic, retain) NSString * name;
@property (nonatomic, retain) NSString * userId;
@property (nonatomic, retain) NSSet *entries;
@end 
```

每个对话 (ChatContext) 将该用户发送的所有消息分组（由 userId 字段唯一标识）。

我正在尝试显示一个对话列表，其中显示每个对话的最后一条消息（类似于 iMessage）。

我正在使用以下代码：

```
NSFetchRequest* request=[[NSFetchRequest alloc] initWithEntityName:@"ChatEntry"];
request.predicate=[NSPredicate predicateWithFormat:@"timestamp=context.entries.@max.timestamp"];
request.sortDescriptors=[NSArray arrayWithObject:[NSSortDescriptor sortDescriptorWithKey:@"timestamp" ascending:NO]];
m_chat=[[NSFetchedResultsController alloc] initWithFetchRequest:request managedObjectContext:m_context sectionNameKeyPath:nil cacheName:@"chat"];
m_chat.delegate=self; 
```

这工作正常，直到我收到一条新消息（使用 NSFetchedResultsChangeInsert）

```
- (void)controller:(NSFetchedResultsController *)controller didChangeObject:(id)anObject atIndexPath:(NSIndexPath *)indexPath forChangeType:(NSFetchedResultsChangeType)type newIndexPath:(NSIndexPath *)newIndexPath
{
...
} 
```

那时，我在表格视图中获得了另一个条目。提取控制器保留前一个条目（即使它的时间戳不再是最新的）。我不确定如何解决这个问题并强制控制器始终评估谓词。

或者，我尝试更改查询以获取 ChatContext 实例，但是我不确定如何实际读取该上下文中的最新条目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T21:20:00.160

好的，我已经设法解决了。我所做的是在上下文中添加一个“ **lastMessage** ”对象，我会不断更新每条新消息。然后我查询上下文列表，按反向**lastMessage.timestamp**排序。新消息会在其上下文中更新**lastMessage**属性——这会触发一个事件并自动更新 UI。

# sql-server - 使用 linq to sql 向实时网站访问的数据库添加列

> ID：11570045
> 
> 赞同：0
> 
> 时间：2012-07-19T22:07:54.237
> 
> 标签：sql-server, linq-to-sql

我有一个数据库（SQL Server）和一个通过 linq to sql 类访问该数据库的实时网站。现在，我需要向该数据库中的一个表添加一列（允许空值）。

如果我先将列添加到数据库，然后更新 linq to sql 类，那么旧的 linq to sql 数据类是否会停止工作（因为数据库模式不同）？我想要的最后一件事是在我更新数据库时网站崩溃。

如果按照我描述的操作确实会导致问题，那么最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T09:54:22.367

在不刷新 LinqToSql 模型的情况下向数据库模式添加新列（允许为 null）不会导致任何问题。

LinqToSQL 在运行时生成参数化查询，只要它允许插入语句为空，就不会受到新列的影响。

# javascript - Rails - 定期更新某些标签而不刷新页面

> ID：11570051
> 
> 赞同：0
> 
> 时间：2012-07-19T22:08:36.557
> 
> 标签：javascript, ruby-on-rails, ajax, prototypejs

我正在创建一个状态板，它将显示多个服务器的特定详细信息，并且需要帮助来更新视图。

**背景：** 我创建了主要设置，其中包含以下内容：

*   保存称为服务器的服务器信息的 MySQL 数据库
*   使用引导程序显示内容
*   用于获取每个服务器信息并更新数据库的 ruby​​ 脚本（在 application.rb 文件中称为 update_all_servers 的方法）
*   每分钟运行一次 ruby​​ 脚本的 Cronjob

**我需要帮助：** 基本上，我需要有关我的 rails 应用程序的 javascript 部分的帮助。我不太确定如何更新我拥有的表中每个服务器的各个属性。我正在寻找的是 javascript/ajax 代码将每隔 30 秒定期从数据库中获取更新的值，并在不刷新页面的情况下更新视图。

在我的 index.html 中，您可以看到我为 server.rhel_version 属性放置了一个 id="comments"。我在想我可以使用 $(#comments). 更新它。在 application.js 文件或其他一些有效/合乎逻辑的方法中。

以下是我所有的源代码。如果你们能指导我应该采取的方法，并可能提供一些示例代码，我将不胜感激！

**/views/servers/index.html.erb**

```
<%- model_class = Server.new.class -%>
<div class="page-header">
  <h1><%=t '.title', :default => model_class.model_name.human.pluralize %></h1>
</div>
<table class="table table-striped">
  <thead>
    <tr>
 <!--     <th><%= model_class.human_attribute_name(:id) %></th> -->
      <th><%= model_class.human_attribute_name(:hostname) %></th>
      <th><%= model_class.human_attribute_name(:port) %></th>
  <!--    <th><%= model_class.human_attribute_name(:username) %></th>
      <th><%= model_class.human_attribute_name(:password) %></th>
      <th><%= model_class.human_attribute_name(:ssh_username) %></th>
      <th><%= model_class.human_attribute_name(:ssh_password) %></th> 
      <th><%= model_class.human_attribute_name(:source_branch) %></th> -->
      <th><%= model_class.human_attribute_name(:source_revision) %></th>
      <th><%= model_class.human_attribute_name(:release) %></th>
      <th><%= model_class.human_attribute_name(:rhel_version) %></th>
      <th><%= model_class.human_attribute_name(:gpu_type) %></th>
      <th><%= model_class.human_attribute_name(:total_users) %></th>
      <th><%= model_class.human_attribute_name(:current_users) %></th>
      <th><%= model_class.human_attribute_name(:created_at) %></th>
      <th><%=t '.actions', :default => t("helpers.actions") %></th>
    </tr>
  </thead>
  <tbody>
    <% @servers.each do |server| %>
      <tr>
  <!--      <td><%= link_to server.id, server_path(server) %></td> -->
        <td><%= server.hostname %></td>
        <td><%= server.port %></td>
   <!--     <td><%= server.username %></td>
        <td><%= server.password %></td>
        <td><%= server.ssh_username %></td>
        <td><%= server.ssh_password %></td>
        <td><%= server.source_branch %></td> -->
        <td><%= server.source_revision %></td>
        <td><%= server.release %></td>
        <td id="comments"><%= server.rhel_version %></td>
        <td><%= server.gpu_type %></td>
        <td><%= server.total_users %></td>
        <td><%= server.current_users %></td>
        <td><%=l server.created_at %></td>
        <td>
          <%= link_to t('.edit', :default => t("helpers.links.edit")),
                      edit_server_path(server), :class => 'btn btn-mini' %>
          <%= link_to t('.destroy', :default => t("helpers.links.destroy")),
                      server_path(server),
                      :method => :delete,
                      :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')),
                      :class => 'btn btn-mini btn-danger' %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<%= link_to t('.new', :default => t("helpers.links.new")),
            new_server_path,
            :class => 'btn btn-primary' %> 
```

**/controllers/servers_controller.rb**

```
class ServersController < ApplicationController
  # GET /servers
  # GET /servers.json
  def index
    @servers = Server.all

    update_all_servers

    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @servers }
    end
  end

  # GET /servers/1
  # GET /servers/1.json
  def show
    @server = Server.find(params[:id])

    respond_to do |format|
      format.html # show.html.erb
      format.json { render json: @server }
    end
  end

  # GET /servers/new
  # GET /servers/new.json
  def new
    @server = Server.new

    respond_to do |format|
      format.html # new.html.erb
      format.json { render json: @server }
    end
  end

  # GET /servers/1/edit
  def edit
    @server = Server.find(params[:id])
  end

  # POST /servers
  # POST /servers.json
  def create
    @server = Server.new(params[:server])

    respond_to do |format|
      if @server.save
        format.html { redirect_to @server, notice: 'Server was successfully created.' }
        format.json { render json: @server, status: :created, location: @server }
      else
        format.html { render action: "new" }
        format.json { render json: @server.errors, status: :unprocessable_entity }
      end
    end
  end

  # PUT /servers/1
  # PUT /servers/1.json
  def update
    @server = Server.find(params[:id])

    respond_to do |format|
      if @server.update_attributes(params[:server])
        format.html { redirect_to @server, notice: 'Server was successfully updated.' }
        format.json { head :no_content }
      else
        format.html { render action: "edit" }
        format.json { render json: @server.errors, status: :unprocessable_entity }
      end
    end
  end

  # DELETE /servers/1
  # DELETE /servers/1.json
  def destroy
    @server = Server.find(params[:id])
    @server.destroy

    respond_to do |format|
      format.html { redirect_to servers_url }
      format.json { head :no_content }
    end
  end
end 
```

**/assets/javascripts/application.js**

```
// This is a manifest file that'll be compiled into application.js, which will include all the files
// listed below.
//
// Any JavaScript/Coffee file within this directory, lib/assets/javascripts, vendor/assets/javascripts,
// or vendor/assets/javascripts of plugins, if any, can be referenced here using a relative path.
//
// It's not advisable to add code directly here, but if you do, it'll appear at the bottom of the
// the compiled file.
//
// WARNING: THE FIRST BLANK LINE MARKS THE END OF WHAT'S TO BE PROCESSED, ANY BLANK LINE SHOULD
// GO AFTER THE REQUIRES BELOW.
//
//= require jquery
//= require jquery_ujs
//= require twitter/bootstrap
//= require_tree . 
```

**视图截图：** ![状态板视图](../Images/78e08f322b14f74269b5782179090aa2.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T22:18:04.327

[您可以使用jQuery.ajax](http://api.jquery.com/jQuery.ajax/)完成所有这些操作，如果您搜索，您可以轻松找到相关的问题/答案，例如[如何定期触发 AJAX 请求？](https://stackoverflow.com/questions/5052543/how-to-fire-ajax-request-periodically)

# ruby-on-rails - 如何在 Mongoid 中做一个自引用模型？

> ID：11570054
> 
> 赞同：1
> 
> 时间：2012-07-19T22:09:01.367
> 
> 标签：ruby-on-rails, mongodb, mongoid

我最近发布了这个问题：[如何与许多父母建立许多自我参照关系？](https://stackoverflow.com/questions/11532187/how-to-model-a-many-self-referential-relationship-with-many-parents)

我得到了足够的答案，但有人告诉我，我可以使用 Mongo/Mongoid 更好地建模。我一直想尝试使用不同的数据库范例，所以也许这将是一个好的开始。

使用 Mongo 建模会更容易吗？如果是这样，你能帮我布置一下吗？

我基本上有两个选择，对吧？1是通过引用Skill id的文档创建一个数组吗？例如，Skill.prerequisites = [Skill1，Skill2，Skill3]。适合这种结构的东西对吗？

否则，我可能需要在该关联上运行一些合乎逻辑的东西，所以我必须创建一个单独的模型。这就是我感到困惑的地方。鉴于我可能需要创建一个单独的模型，它是作为文档还是嵌入式文档存在？我对每种策略的限制是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T22:55:09.347

好的，让我们来看看你的技巧方法吧。这是我在 Mongoid 中建模的方法：

```
class Skill
  include Mongoid::Document

  field :prereqruisite_skill_ids, type: Array, default: []

  def prereqruisite_skills
    Skill.any_of(:_id => prereqruisite_skill_ids).all
  end

  def add_prereqruisite!(skill)
    self.prereqruisite_skill_ids << skill
    safely.save!
  end
end 
```

使用 Mongo，这是我唯一的方法。

使用 ActiveRecord，您可以：

```
class Skill < AR::Base
  has_many :skill_prereqruisites
  has_many :prerequisites, through: skill_prereqruisites, class_name: "Skill"
end

class SkillPrereqruisite < AR::Base
  belongs_to :skill_one, foreign_key: "skill_one_id"
  belongs_to :skill_two, foreign_key: "skill_two_id"
end 
```

# emacs - 如何仅为 emacs 中的自定义编译命令设置自定义错误处理？

> ID：11570065
> 
> 赞同：3
> 
> 时间：2012-07-19T22:10:07.420
> 
> 标签：emacs, elisp

我正在使用 scons 来构建我的 c++ 项目。
我正在使用下一个脚本来正确处理 scons 的错误：

```
34;;; SCons builds into a 'build' subdir, but we want to find the errors
35;;; in the regular source dir.  So we remove build/XXX/YYY/{dbg,final}/ from the
36;;; filenames.
37(defun process-error-filename (filename)
38  (let ((case-fold-search t))
39    (setq f (replace-regexp-in-string
40             "[Ss]?[Bb]uild[\\/].*\\(final\\|dbg\\)[^\\/]*[\\/]" "" filename))
41    (cond ((file-exists-p f)
42           f)
43          (t filename))))
44
45(setq compilation-parse-errors-filename-function 'process-error-filename) 
```

所以。我不仅想将 emacs 与 c++ 和 scons 一起使用。还可以用java等语言。
如何设置 emacs 以仅在我运行

```
M-x compile   
scons 
```

命令？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-20T06:34:20.137

您可以使用模式挂钩
[http://www.gnu.org/software/emacs/manual/html_node/emacs/Hooks.html](http://www.gnu.org/software/emacs/manual/html_node/emacs/Hooks.html)
[http://www.gnu.org/software/emacs/manual/html_node/elisp/Creating- Buffer_002dLocal.html](http://www.gnu.org/software/emacs/manual/html_node/elisp/Creating-Buffer_002dLocal.html)

```
(defun my-c++-mode-hook ()
  (set (make-local-variable
  'compilation-parse-errors-filename-function)
  'process-error-filename))
(add-hook 'c++-mode-hook 'my-c++-mode-hook) 
```

# json - 如何在 Node/Jade/Express 视图中迭代和解析 JSON 数据？

> ID：11570068
> 
> 赞同：0
> 
> 时间：2012-07-19T22:10:11.383
> 
> 标签：json, node.js, express, pug

我对 Node 非常陌生，并且仍处于了解其使用和功能的初始阶段。如果这个问题看起来非常简单或幼稚，我深表歉意 - 我在提问之前做了适当的研究。

在我的 express js 应用程序中，我向远程 API 发送了一个 GET 请求，并正确接收了相应的 JSON 数据作为回报。然后我将它传递给我的视图（Jade），目前能够以字符串形式打印 JSON。一切正常。

我拥有的 JSON 数据是具有相关字段的俱乐部的一组人/成员。我想“抓住”所有人，并在一个组织良好的表格中显示他们的姓名和相关信息。

所以我的问题是，**解析 JSON 数据以便我可以访问视图中的名称和相关信息的最佳方法是什么**？

我的请求如下所示，其中数据是发送到视图的 JSON：

```
res.render('standings.jade', { locals: {
          data: body,
          title: 'Team Member Information'
        }
}); 
```

我非常简单的观点如下：

```
h2= title
p= data 
```

我尝试过使用 data.members、data.[members]、data.["members"]、data[members] 等无济于事。我想念的东西肯定是愚蠢的吗？我对成员列表感兴趣，返回的 JSON 如下所示：

```
{
"club":
{"id":1,"name":"This is a team name"},
"members":
[{"id":2,"name":"Test Name"},{"id":3,"name":"Another Name"},{"id":4,"name":"More Names"},{"id":5,"name":"Cool Person"}]
} 
```

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-20T01:00:59.350

要处理 JSON 数据，请使用`express.bodyParser()`中间件。这将使`req.body`您在路由回调中可以使用对象。在路由处理函数中，`req.body`作为视图局部变量的一部分传递，以使该数据可用于视图。

```
app.post("/some/path", express.bodyParser(), function (req, res) {
    res.render("standings.jade", {
        locals: {data: req.body, title: "Team Member Information"}
    });
}); 
```

在您看来，您将能够`data.members`获得团队成员的访问权限。

```
each member in data.members
    p= member.name 
```

# doxygen - 合并 doxygen 模块

> ID：11570069
> 
> 赞同：4
> 
> 时间：2012-07-19T22:10:27.030
> 
> 标签：doxygen

我有大量代码正在运行 doxygen。为了提高性能，我试图将其分解为模块并将结果合并到一组文档中。我认为标签文件可以解决问题，但要么我配置错误，要么我误解了它的工作原理。

目录布局如下：

```
root +
     |-src+
     |    |-a
     |
     |-doc+
          |-a.dox
          |-main.dox
          |-main.md
          |-output+
                  |-a+
                  |  |-html
                  |-main+
                        |-html 
```

除了“a”之外，还有其他对等目录，但从一个开始。

a.dox 生成输出和标签文件到 root/doc/output

```
OUTPUT_DIRECTORY=output/a
GENERATE_TAGFILE = output/a/a.tag
INPUT=../src/a 
```

main.dox 只是输入具有主页标记的降价文件并引用其他项目标记文件。

```
OUTPUT_DIRECTORY=output/main
INPUT = main.md
TAGFILES=output/a/a.tag=output/a/html 
```

1.  这是否应该合并或链接 main 下的所有文档，我可以在其中浏览“a”全局变量、模块、页面等？或者，如果我从“main”内部明确交叉引用“a”中的文档实体，这是否只会生成指向“a”的链接？
2.  如果这应该有效，对我的语法不正确的地方有什么想法吗？我尝试了各种方法来定义 TAGFILES，输出目录是否相对于 main.dox 文件？到 a.tag 文件？还是到a/html目录？
3.  如果我不在基地，TAGFILES 不能以这种方式工作，是否有另一种方法可以将多组 doxygen 目录合并为一个？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-20T15:37:34.887

我建议您阅读本主题，了解我建议如何使用标记文件以及应适用的条件：[https ://stackoverflow.com/a/8247993/784672](https://stackoverflow.com/a/8247993/784672)

要回答您的第一个问题：doxygen 通常*不会*将各种索引文件合并在一起（然后不会获得任何性能）。尽管对于某个部分，您仍然可以通过设置`ALLEXTERNALS`为来获取索引中的外部成员`YES`。

Doxygen 将（自动）链接来自通过标签文件导入的其他来源的符号。所以一般来说你应该把你的代码分成或多或少的独立模块/组件/库，如果一个这样的模块依赖于另一个，那么导入它的标签文件，以便 doxygen 可以链接到另一个文档集。如果您运行 doxygen 两次（一次用于标记文件，一次用于文档），您还可以解决循环依赖关系（如果有）。

在我的例子中，我创建了一个包含所有模块链接的自定义索引页面，并在每个生成的页面的菜单中创建了一个自定义条目，链接回该索引（参见[http://www.doxygen.nl/manual/customize.html #layout](http://www.doxygen.nl/manual/customize.html#layout)）如何将用户定义的条目添加到导航菜单/树。

# asp.net - ASP.NET CheckListBox 508 合规性

> ID：11570072
> 
> 赞同：1
> 
> 时间：2012-07-19T22:10:36.640
> 
> 标签：asp.net, checkbox, section508

我有一个 CheckListBox 并在项目上指定工具提示。渲染时，它会在复选框（和标签）周围显示一个跨度，并且它是具有标题属性的跨度，而不是复选框（输入类型=复选框）。

有谁知道如何在输入元素上设置标题属性而不是周围的跨度？

为了符合 508，我需要在 input 元素上拥有 title 属性，而不是在 span 上。

**编辑**：请注意，我更愿意在服务器端在 C# 中进行所有必要的更改。我宁愿不必在 javascript/jquery 中执行此操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T22:37:27.257

到过那里。JavaScript 无论如何都不会帮助您处理 508，因为它不会更改源代码。

这应该为您解决它：

```
protected override void OnPreRender(EventArgs e)
{
    base.OnPreRender(e);
    foreach(ListItem li in CheckBoxList1.Items){
            li.Attributes["title"] = "my title";
        }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-20T20:49:50.177

我应该在发布之前进行测试。最快的方法是使用带有 runat="server" 属性的老式 html 控件。然后，您可以通过其 ID 引用您的各个复选框。例如：

```
<asp:Panel ID="BrowserCheckBoxList" runat="server">
    <ul>
        <li><input id="CheckBoxList1_0" type="checkbox" name="" value="Chrome" title="Chrome" runat="server" /> <label for="CheckBoxList1_0">Chrome</label></li>
        <li><input id="CheckBoxList1_1" type="checkbox" name="" value="FireFox" title="FireFox" runat="server" /> <label for="CheckBoxList1_1">FireFox</label></li>
        <li><input id="CheckBoxList1_2" type="checkbox" name="" value="IE" title="IE" runat="server" /> <label for="CheckBoxList1_2">IE</label></li>
        <li><input id="CheckBoxList1_3" type="checkbox" name="" value="Opera" title="Opera" runat="server" /><label for="CheckBoxList1_3">Opera</label></li>
        <li><input id="CheckBoxList1_4" type="checkbox" name="" value="Safari" title="Safari" runat="server" /><label for="CheckBoxList1_4">Safari</label></li>
    </ul>
</asp:Panel> 
```

# c# - 从数据库中获取值到文本框

> ID：11570074
> 
> 赞同：0
> 
> 时间：2012-07-19T22:10:51.147
> 
> 标签：c#, database, winforms, textbox

我有一个 WinForm，它有一个 DataGridView 和一个 ComboBox，允许用户选择一个主题（从数据库中）。

> ```
>  cbxSubject.DataSource = dsSched.Tables["Schedules"];
>   cbxSubject.DisplayMember = "Subject";
>   ... 
> ```

DataGridView 看起来像这样： http: [//i45.tinypic.com/18gmmu.png](http://i45.tinypic.com/18gmmu.png)我添加了 DataGridView，因为我不知道如何从数据库中获取这些值。我使用了类似这样的代码来获取值：

> TextBox1.Text = DataGridView1.Rows[3].Cells[1].Value.ToString();

但后来我意识到，如果有超过 2 个主题可供选择，它将不再起作用，因为代码设置为获取第 3 行和第 1 个单元格的值。所以即使用户改变了主题，输出值（w/c 然后显示在 TextBox 中）仍然是相同的。还有其他方法可以获得这些值吗？请帮忙，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T22:38:05.230

我将尝试消除您的一些疑问：

> 我添加了 DataGridView 因为我不知道如何从数据库中获取这些值

您已经有一个`DataSet`名为“dsSched”的数据库值填充。所以，不，你不需要`DataGridView`. 只需直接从数据集中填写您想要的任何内容：

```
string data = dsSched.Tables["Schedules"].Rows[3].Cells[1].Value.ToString(); 
```

> 然后我意识到如果有超过 2 个主题可供选择，它将不再起作用，因为代码设置为获取第 3 行和第 1 个单元格的值。

好吧，我不确定您在**哪里**运行那段代码 ( `TextBox1.Text = Data...`)，但是如果`SelectedIndexChanged`您`DataGridView`在不明白你要做什么）。

我怀疑的一件事是您的印象是代码：

```
TextBox1.Text = DataGridView1.Rows[3].Cells[1].Value.ToString(); 
```

...将文本框绑定到行/单元格中的值。这不是它的工作原理 - 运行代码时检索一次该值，然后在再次运行代码时再次检索该值。因此，您应该确保在必须获取此值时运行代码。

* * *

**编辑：**

> 我的意思是，我如何获得价值？比如，PrimaryKey 之类的？

这就是问题所在！对不起，我可能走偏了。只需将 设置为`[ValueMember][1]`描述数据集值列的字符串。

cbxSubject.ValueMember = "日程 ID";

比您使用 访问它`[SelectedValue][2]`，例如：

```
int selValue = (int)(cbxSubject.SelectedValue); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T22:56:15.557

我建议你不要使用常量。而不是使用 3 和 1，您需要编写一些代码来查找用户选择的内容`R`。`C`它应该是事件驱动的，您需要在更改时重新设置文本框。我假设您正在使用 on-change 事件，但您实际上还没有向我们提供该信息。

这是一些伪代码，可以帮助我了解我的去向

```
public DataGridView1_SelectionChanged(object sender, ChangedEventArgs e)
{//this might not be the right event, I'll leave it up to you to do your own homework
    int R = //Get the current Selected Row;
    int C = //Get the current Selected Cell/column;

    TextBox1.Text = dsSched.Tables["Schedules"].Rows[R].Cells[C];

    ///OR YOU COULD DO SOMETHING LIKE THIS

    TextBox1.Text = ((DataGridView)sender).SelectedRows[0].Cells[1].Value;
}

//Please note, this is only pseudocode, I dont like doing peoples homework for them. 
```

这应该为您提供您需要的更通用的想法/算法。请记住，这甚至可能不是最好的方法，但我仅根据迄今为止提供给我们的信息推荐它。顺便说一句，你试过什么？你能给我们一些更大的代码示例吗，可能会犯一个更简单的错误，你没有向我们展示，所以我们不能告诉你:-)

考虑到您实际上还没有提出正确的问题，因为我们不知道您为什么要尝试做您所说的事情，所以我无法比这更具体。GIGO，你必须问正确的问题才能得到正确的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T22:29:21.203

您可以通过这种方式添加一个组合框

```
DataGridViewComboBoxColumn subjectsCombo = new DataGridViewComboBoxColumn();
subjectsCombo.DataPropertyName = "SubjectID";
subjectsCombo.HeaderText = "Subjects";

subjectsCombo.DataSource = dsSched.Tables["Subjects"];
subjectsCombo.ValueMember = "SubjectID";
subjectsCombo.DisplayMember = "SubjectText";

cbxSubject.Columns.Add(subjectsCombo); 
```

# javascript - 使用 JQuery/JS 将 div 从一个列表移动到下一个列表

> ID：11570076
> 
> 赞同：1
> 
> 时间：2012-07-19T22:11:04.737
> 
> 标签：javascript, jquery, html, performance

我有两个类似的列表，以便我可以添加和删除。起始列表可以包含 1 到 2,000 个变量，形式为：

```
<div class="notadded" id="X"><input type="checkbox" />Varname and varlabel</div> 
```

我想将所有选中的变量移到下一个列表，将它们从第一个列表中删除。

考虑到我可以移动 2,000 件物品，最好的方法是什么。此外，在移动它们时，我不想有任何重复并按字母顺序保留 varname（它们是以这种方式加载的）。

我也可以随意调整html。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T22:35:50.693

好的，我试图猜测你想要什么。因此，使用 jQuery 查看这段代码：

**HTML：**

```
<div id="sourceList">
    <div class="notadded" id="1"><input type="checkbox" />Varname and varlabel 1</div>
    <div class="notadded" id="2"><input type="checkbox" />Varname and varlabel 2</div>
    <div class="notadded" id="3"><input type="checkbox" />Varname and varlabel 3</div>
    <div class="notadded" id="4"><input type="checkbox" />Varname and varlabel 4</div>
    <div class="notadded" id="5"><input type="checkbox" />Varname and varlabel 5</div>
    <div class="notadded" id="6"><input type="checkbox" />Varname and varlabel 6</div>
    <div class="notadded" id="7"><input type="checkbox" />Varname and varlabel 7</div>
    <div class="notadded" id="8"><input type="checkbox" />Varname and varlabel 8</div>
    <div class="notadded" id="9"><input type="checkbox" />Varname and varlabel 9</div>
</div>

<input id="moveBtn" type="button" value="Move them!"/>
<input id="removeBtn" type="button" value="Remove them!"/>

<div id="targetList"></div> 
```

**JavaScript：**

```
function move( sourceSelector, targetSelector ) {
    var selectedItens = $( sourceSelector + " .notadded input:checked" );
    selectedItens.attr( "checked", false );
    $( targetSelector ).append( selectedItens.parent() );
}

$(function() {
    $( "#moveBtn" ).click(function(){
        move( "#sourceList", "#targetList" );
    });

    $( "#removeBtn" ).click(function(){
        move( "#targetList", "#sourceList" );
    });
}); 
```

jsFiddle：http: [//jsfiddle.net/davidbuzatto/Fnxp2/](http://jsfiddle.net/davidbuzatto/Fnxp2/)

这够快吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T23:47:19.093

我不确定这对于大规模的性能会有多糟糕，如果您的两个列表都充满了 2000 个项目但只有第一个最初可见会发生什么。

编辑复选框并提交后，您只需检查并更改样式以显示或隐藏它们。我唯一担心的是这会有过多的 dom 元素，但 2000 已经很多了。这样做的好处是除了添加/删除类之外，dom 操作更少，并且还有一个额外的好处，那就是保持两个列表中元素的顺序。

我借了很多大卫的小提琴，但对其进行了调整，因此这里没有创建新的 dom[元素](http://jsfiddle.net/jvillars/vLce3/)

希望这可以帮助。

# font-face - 优化多种 Google Web 字体

> ID：11570082
> 
> 赞同：11
> 
> 时间：2012-07-19T22:11:35.340
> 
> 标签：font-face, google-webfonts

从 Google 加载自定义字体时，它们为您提供了一种优化它们的方法：[https ://developers.google.com/webfonts/docs/getting_started#Optimizing_Requests](https://developers.google.com/webfonts/docs/getting_started#Optimizing_Requests)

这意味着如果您只是为标题使用自定义字体，而不是加载整个字体，您可以告诉它您需要哪些字母，这样就不会加载整个字体字母表。到目前为止，一切都很好。

但是，在示例中它只有一种字体样式。两个怎么办？

例如，我使用它来加载字体样式：

正常的 400 我用于很多文本，但 400italic 仅用于一个短标题。

如果我做：

它会像我想要的那样加载整个 400 和 400italic 的“示例标题”，还是会做其他事情？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-12T01:23:10.010

如果您正在进行字符子集化并尝试将多种字体组合到一个 CSS 请求中，那么指定的字符需要是所有字体之间所有必需字符的并集。

看看这里：http: [//jsbin.com/welcome/22005/edit](http://jsbin.com/welcome/22005/edit)

```
<link href="http://fonts.googleapis.com/css?family=Inconsolata|Skranji&text=ABCDHIJK" rel="stylesheet"> 
```

上面有两件事。我们要求使用两种字体（Inconsolate 和 Skranji）并指定两种字体都应为字符 AK 提供服务。如果您只需要一个 AD，另一个需要 HK，那么您必须将上述内容拆分为两个不同的 CSS 请求。

# c# - 在 TeamCity 上运行自动化 Powershell-NUnit 测试

> ID：11570089
> 
> 赞同：1
> 
> 时间：2012-07-19T22:12:23.000
> 
> 标签：c#, powershell, nunit, teamcity

我发现了这种在 Powershell 中使用 NUnit 的巧妙方法。[http://elegantcode.com/2009/10/25/integration-test-brought-to-you-by-powershell-nunit-with-a-little-specification-syntax-for-flavoring/](http://elegantcode.com/2009/10/25/integration-test-brought-to-you-by-powershell-nunit-with-a-little-specification-syntax-for-flavoring/) 我们使用它很多我们的测试。

但是我想在 TeamCity 中运行这些测试。当我们使用 NUnit 运行器在 TeamCity 中运行 C# 测试时，我想要类似的行为，即当测试执行失败时构建失败。你们有没有人做到这一点？我怀疑 Powershell 运行程序只会将它作为一个简单的脚本执行，而没有任何迹象表明测试是通过还是失败。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T07:04:05.503

看看[http://confluence.jetbrains.net/display/TCD7/Build+Script+Interaction+with+TeamCity](http://confluence.jetbrains.net/display/TCD7/Build+Script+Interaction+with+TeamCity)和[http://confluence.jetbrains.net/display/TCD7/Build+Failure+Conditions](http://confluence.jetbrains.net/display/TCD7/Build+Failure+Conditions)

Powershell runner 支持存在问题[http://youtrack.jetbrains.com/issue/TW-21554](http://youtrack.jetbrains.com/issue/TW-21554)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T20:35:33.087

我不熟悉您在 TeamCity 中通过 Powershell 执行 NUnit 测试所引用的方法。但是，我们成功地将[PSake](https://github.com/psake/psake)用于 Powershell 构建脚本，包括执行 NUnit 测试和适当地使构建失败。带有退出代码的 PSake 和 TeamCity 也存在同样的问题，但您可以通过使用 -Command 为脚本执行在构建步骤的脚本源中指定 TeamCity 来解决此问题：

```
import-module .\tools\psake\psake.psm1
$psake.use_exit_on_error = $true
invoke-psake build.ps1 
remove-module psake 
```

您还可以使用 TeamCity 构建步骤中的构建功能选项将测试结果集成到 TeamCity。

# objective-c - XCode 4.2：实现上下文中缺少语义问题“@end”，程序中出现意外的“@”

> ID：11570090
> 
> 赞同：0
> 
> 时间：2012-07-19T22:12:27.213
> 
> 标签：objective-c, xcode, xcode4, xcode4.2

我是 XCODE 的新手，但我正在努力学习。基本上，我的项目是 Nada Jaksic 的在 iPhone 上创建基于表格的表单的返工。我希望能被告知我在编码中出错的地方，以便我可以从错误中吸取教训。任何和所有的帮助都非常感谢！

从 SignupTableViewController.h 文件中：

```
#import <UIKit/UIKit.h>

@interface SignupTableViewController : UITableViewController<UITextFieldDelegate,   UIActionSheetDelegate>

{

    IBOutlet UITableViewCell *cellExaminername;
    IBOutlet UITableViewCell *cellExamineraddress;
    IBOutlet UITableViewCell *cellExaminercity;
    IBOutlet UITableViewCell *cellExaminerstate;
    IBOutlet UITableViewCell *cellExaminerzip;
    IBOutlet UITableViewCell *cellExamineremail;
    IBOutlet UITableViewCell *cellSearchthroughdate;
    IBOutlet UITableViewCell *cellTitleheldby;
    IBOutlet UITableViewCell *cellPropertyaddress1;
    IBOutlet UITableViewCell *cellPropertyaddress2;
    IBOutlet UITableViewCell *cellPropertycity;
    IBOutlet UITableViewCell *cellPropertystate;
    IBOutlet UITableViewCell *cellProperyzip;
    IBOutlet UITableViewCell *cellTitlesearchnotes;    

    IBOutlet UITextField* txtExaminername;
    IBOutlet UITextField* txtExamineraddress;
    IBOutlet UITextField* txtExaminercity;
    IBOutlet UITextField* txtExaminerstate;
    IBOutlet UITextField* txtExaminerzip;
    IBOutlet UITextField* txtExamineremail;
    IBOutlet UITextField* txtSearchthroughdate;
    IBOutlet UITextField* txtTitleheldby;
    IBOutlet UITextField* txtPropertyaddress1;
    IBOutlet UITextField* txtPropertyaddress2;
    IBOutlet UITextField* txtPropertycity;
    IBOutlet UITextField* txtPropertystate;
    IBOutlet UITextField* txtPropertyzip;
    IBOutlet UITextField* txtTitlesearchnotes;

    UIActivityIndicatorView* activityIndicator;

}

@property (nonatomic, retain) IBOutlet UITableViewCell *cellExaminername;
@property (nonatomic, retain) IBOutlet UITableViewCell *cellExamineraddress;
@property (nonatomic, retain) IBOutlet UITableViewCell *cellExaminercity;
@property (nonatomic, retain) IBOutlet UITableViewCell *cellExaminerstate;
@property (nonatomic, retain) IBOutlet UITableViewCell *cellExaminerzip;
@property (nonatomic, retain) IBOutlet UITableViewCell *cellExamineremail;
@property (nonatomic, retain) IBOutlet UITableViewCell *cellSearchthroughdate;
@property (nonatomic, retain) IBOutlet UITableViewCell *cellTitleheldby;
@property (nonatomic, retain) IBOutlet UITableViewCell *cellPropertyaddress1;
@property (nonatomic, retain) IBOutlet UITableViewCell *cellPropertyaddress2;
@property (nonatomic, retain) IBOutlet UITableViewCell *cellPropertycity;
@property (nonatomic, retain) IBOutlet UITableViewCell *cellPropertystate;
@property (nonatomic, retain) IBOutlet UITableViewCell *cellProperyzip;
@property (nonatomic, retain) IBOutlet UITableViewCell *cellTitlesearchnotes;

@property (nonatomic, retain) IBOutlet UITextField* txtExaminername;
@property (nonatomic, retain) IBOutlet UITextField* txtExamineraddress;
@property (nonatomic, retain) IBOutlet UITextField* txtExaminercity;
@property (nonatomic, retain) IBOutlet UITextField* txtExaminerstate;
@property (nonatomic, retain) IBOutlet UITextField* txtExaminerzip;
@property (nonatomic, retain) IBOutlet UITextField* txtExamineremail;
@property (nonatomic, retain) IBOutlet UITextField* txtSearchthroughdate;
@property (nonatomic, retain) IBOutlet UITextField* txtTitleheldby;
@property (nonatomic, retain) IBOutlet UITextField* txtPropertyaddress1;
@property (nonatomic, retain) IBOutlet UITextField* txtPropertyaddress2;
@property (nonatomic, retain) IBOutlet UITextField* txtPropertycity;
@property (nonatomic, retain) IBOutlet UITextField* txtPropertystate;
@property (nonatomic, retain) IBOutlet UITextField* txtPropertyzip;
@property (nonatomic, retain) IBOutlet UITextField* txtTitlesearchnotes;
-(void)signup;

@end 
```

从我的 SignupTableViewController.m 文件中：

```
#import "SignupTableViewController.h"

@implementation SignupTableViewController
@synthesize  cellExaminername, cellExamineraddress, cellExaminercity, cellExaminerstate,    cellExaminerzip, cellExamineremail, cellSearchthroughdate, cellTitleheldby, cellPropertyaddress1, cellPropertyaddress2, cellPropertycity, cellPropertystate, cellProperyzip, cellTitlesearchnotes;
@synthesize  txtExaminername, txtExamineraddress, txtExaminercity, txtExaminerstate, txtExaminerzip, txtExamineremail, txtSearchthroughdate, txtTitleheldby, txtPropertyaddress1, txtPropertyaddress2, txtPropertycity, txtPropertystate, txtPropertyzip, txtTitlesearchnotes;

#pragma mark -
#pragma mark View lifecycle

- (void)viewDidLoad 
{
    [super viewDidLoad];

    // Uncomment the following line to preserve selection between presentations.
    //self.clearsSelectionOnViewWillAppear = NO;

    UIBarButtonItem* btnSubmitSignup = [[UIBarButtonItem alloc]initWithTitle:NSLocalizedString(@"Join",@"") style:UIBarButtonItemStylePlain target:self action:@selector(signup)];
    [[self navigationItem] setRightBarButtonItem:btnSubmitSignup];
}

#pragma mark -
#pragma mark Table view data source

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView {
// Return the number of sections.
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section   {
    // Return the number of rows in the section.
    return 14;
}

// Customize the appearance of table view cells.
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath 
{       

    if (indexPath.row == 0) {
        return cellExaminername;
    }
    if (indexPath.row == 1) {
        return cellExamineraddress;
    }
    if (indexPath.row == 2) {
        return cellExaminercity;
    }
    if (indexPath.row == 3) {
        return cellExaminerstate;
    }
    if (indexPath.row == 4) {
        return cellExaminerzip;
    }    
    if (indexPath.row == 5) {
        return cellExamineremail;
    }    
    if (indexPath.row == 6) {
        return cellSearchthroughdate;
    }
    if (indexPath.row == 7) {
        return cellTitleheldby;
    }
    if (indexPath.row == 8) {
        return cellPropertyaddress1;
    }      
    if (indexPath.row == 9) {
        return cellPropertyaddress2;
    }     
    if (indexPath.row == 10) {
        return cellPropertycity;
    }  
    if (indexPath.row == 11) {
        return cellPropertystate;
    }    
    if (indexPath.row == 12) {
        return cellProperyzip;
    }     
    if (indexPath.row == 13) {
        return cellTitlesearchnotes;
    }

}

#pragma mark -
#pragma mark Table view delegate

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
    // Navigation logic may go here. Create and push another view controller.
    /*
     <#DetailViewController#> *detailViewController = [[<#DetailViewController#> alloc] initWithNibName:@"<#Nib name#>" bundle:nil];
     // ...
     // Pass the selected object to the new view controller.
     [self.navigationController pushViewController:detailViewController animated:YES];
     [detailViewController release];
     */
}

- (BOOL)textFieldShouldReturn:(UITextField *)textField
{ 
    [textField resignFirstResponder];
    return YES;
}

- (void)textFieldDidBeginEditing:(UITextField *)textField

#pragma mark -
#pragma mark Memory management
-(void)didReceiveMemoryWarning {
    // Releases the view if it doesn't have a superview.
    [super didReceiveMemoryWarning];

    // Relinquish ownership any cached data, images, etc that aren't in use.
}

- (void)viewDidUnload {
    // Relinquish ownership of anything that can be recreated in viewDidLoad or on demand.
    // For example: self.myOutlet = nil;
}

-(void) signup
{
    // make sure the keyboard is hidden
    [txtExaminername resignFirstResponder];
    [txtExamineraddress resignFirstResponder];
    [txtExaminercity resignFirstResponder];
    [txtExaminerstate resignFirstResponder];
    [txtExaminerzip resignFirstResponder];
        [txtExamineremail resignFirstResponder];
    [txtSearchthroughdate resignFirstResponder];
    [txtTitleheldby resignFirstResponder];
    [txtPropertyaddress1 resignFirstResponder];
    [txtPropertyaddress2 resignFirstResponder];
    [txtPropertycity resignFirstResponder];    
    [txtPropertystate resignFirstResponder];
    [txtPropertyzip resignFirstResponder];
    [txtTitlesearchnotes resignFirstResponder];

    activityIndicator = [[UIActivityIndicatorView alloc]    initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleWhite];
    [activityIndicator setCenter:CGPointMake(self.view.frame.size.width/2.0, self.view.frame.size.height/2.0+20)]; 
    [activityIndicator startAnimating];
    [self.view addSubview:activityIndicator];   

    if (![self validateSignupForm])
        return;

    //do your signup code here

}

-(BOOL)validateSignupForm
{
    BOOL rtn = YES; 
    // Declare your Alert,  NSArray, increment int
    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:nil     message:NSLocalizedString(@"FormIncomplete", @"") delegate:self cancelButtonTitle:@"OK" otherButtonTitles:nil];
    NSArray *fieldArray;    
    int i = 0;

    // Load up our field array with the UITextField Values
    fieldArray = [NSArray arrayWithObjects: 
                  [NSString stringWithFormat:@"%@",txtExaminername.text], 
                  [NSString stringWithFormat:@"%@",txtExamineraddress.text], 
                  [NSString stringWithFormat:@"%@",txtExaminercity.text], 
                  [NSString stringWithFormat:@"%@",txtExaminerstate.text], 
                  [NSString stringWithFormat:@"%@",txtExaminerzip.text],
                  [NSString stringWithFormat:@"%@",txtExamineremail],
                  [NSString stringWithFormat:@"%@",txtSearchthroughdate.text], 
                  [NSString stringWithFormat:@"%@",txtTitleheldby.text], 
                  [NSString stringWithFormat:@"%@",txtPropertyaddress1.text], 
                  [NSString stringWithFormat:@"%@",txtPropertyaddress2.text], 
                  [NSString stringWithFormat:@"%@",txtPropertycity.text],                  
                  [NSString stringWithFormat:@"%@",txtPropertystate.text], 
                  [NSString stringWithFormat:@"%@",txtPropertyzip.text],                  
                  [NSString stringWithFormat:@"%@",txtTitlesearchnotes.text]];

    // loop through the array, alert if text field is empty, and break the the loop, other wise increment i  
    for (NSString *fieldText in fieldArray){
        NSLog(fieldText); // make sure all is reading correctly in the console
        if([fieldText isEqualToString:@""]){            
            [alert show];   
            rtn = NO;
            break; // break out!!
        }
        i++;        
     }

    // check that all the field were passed (i == array.count) 
    //if(i == [[NSNumber numberWithInt: fieldArray.count] intValue]){
    //NSLog(@"Passed validation..."); 
    //rtn = YES;           
    // {

    //if (rtn)

    @end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T22:15:04.363

您的`-validateSignupForm`方法缺少结束语`}`。

暗示这可能是真的是 Xcode 对缩进的渴望`@end`。

# jquery - jQuery 用两个不同的触发器切换单个 div

> ID：11570094
> 
> 赞同：1
> 
> 时间：2012-07-19T22:12:38.260
> 
> 标签：jquery, html, triggers, hyperlink, toggle

我对 jQuery 的了解有限...当单击两个触发器之一时，我需要有关要切换的单个 div 的特定实例的帮助。现在的问题是，如果使用一个触发器，您必须单击两次才能使另一个触发器工作。

这是我的 jQuery：

```
jQuery(document).ready(function($) {

    jQuery(".move").toggle(function(){
        jQuery(".contact-container").slideDown('fast'); 
    }, function () {
        jQuery(".contact-container").slideUp('fast');
}); 
```

});

我的 HTML 大致是这样的：

```
<div class="contact-container"></div>
<ul>
    <li class="trigger"></li>
</ul>
<a class="trigger"></a> 
```

如果你想在开发网站上看到这个，你可以在这里查看（触发是右上角的“联系”按钮和页脚中的“联系”链接）：[网站链接](http://sharonehakman.com.s118336.gridserver.com)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T22:19:41.190

不确定我是否得到问题，并且我无意通过您的 wordpress 网站查看代码，但请尝试：

```
$(document).ready(function() {
    $(".move").on('click', function(){
        $(".contact-container").slideToggle('fast'); 
    });
}); 
```

如果两个触发元素都具有类“.move”，则应该可以正常工作，否则只需将该类添加到两个触发元素！

它现在不起作用的原因是切换功能使用“.move”类跟踪两个不同元素的状态，但不知道滑动的“.contact-container”元素是否可见。改用 slideToggle 可以解决这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T22:21:02.323

**首先，[小提琴](http://jsfiddle.net/aG8p3/2/)。**

您可以使用 jQuery 的[`.toggle()`](http://api.jquery.com/toggle/)方法来执行此操作。它将根据需要自动显示或隐藏元素。

您还可以`click`按类而不是按特定 ID 设置处理程序。这样，只要具有该类的任何元素（在下面的示例中，我使用`toggle-button`了 ），它将调用单击处理程序函数。

**更新：**我更改了我的示例以匹配您在上面发布的示例代码。

```
<ul>
    <li class="trigger">Trigger 1</li>
</ul>
<a class="trigger">Trigger 2</a>

<div style="height: 400px; width: 400px; background-color:red;" class="contact-container"></div> 
```

​</p>

```
$(document).ready(function() {
    $('.trigger').on('click', function(e) {
       e.preventDefault();
        $('.contact-container').slideToggle('fast');
    });
});​ 
```

# sql - 当列未知时，使用 count() 和 CTE 使用空值进行动态透视

> ID：11570099
> 
> 赞同：2
> 
> 时间：2012-07-19T22:12:55.057
> 
> 标签：sql, sql-server, sql-server-2005

我太近了！我有一个调查，客户希望能够看到使用各种权重的报告作为答案。SQLFiddle 仅允许 2008 年及更高版本，但在 2005 年我得到以下结果：

```
Lesson wt count -> | w1_5 | w2 | w3 | w5_5 | w6_5 | N
-----------------------------------------------------
q2                 | 1.5  | 2  | 3  | 5.5  | 6.5  | 9 
```

显然，它们应该是计数而不是权重。

此外，唯一返回的记录恰好是具有 0 个空值的行。

我制作了一个[SQLFiddle](http://sqlfiddle.com/#!3/9d106/15/0) ，底部有一个我预期结果的非动态示例。

我不确定使我的动态查询不是 sum 而不是动态查询的区别是什么。

这是我以前的工作 ( [1](https://stackoverflow.com/questions/11404062/sql-server-advanced-report-of-multiple-rows-into-one) , [2](https://stackoverflow.com/questions/11459355/sql-server-2005-fill-pivot-table-with-0s) , [3](https://stackoverflow.com/questions/11465666/sql-server-2005-percentage-in-parenthesis-in-pivot-table) )

**---更新---最终解决方案---**

发[在这里](http://sqlfiddle.com/#!3/9d106/35/0) 给有兴趣的人。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T22:40:38.523

您的动态 sql 内部连接每个派生表，并且您为每个权重使用一个派生表。某些权重不存在，因此结果为空结果集。如果将内部替换为左连接，您将看到您的数据，但看到的是权重值，而不是计数。老实说，我不明白你为什么要首先进行连接。你为什么不生成一个类似于你在小提琴底部显示的枢轴示例的枢轴查询？

因此，将 JOIN 替换为 LEFT JOIN：

```
SELECT -- Weight as the alias for join uniqueness
    @join_List = @join_List + ' 
LEFT JOIN 
    (
        SELECT lessonid, weight, count(weight) AS weightcnt 
        FROM tblResultsChoices 
        GROUP BY lessonid,weight
    ) w' + REPLACE(weight,'.','_') + ' 
ON (w' + REPLACE(weight,'.','_') + '.lessonid = weight_count.lessonid AND w' + REPLACE(weight,'.','_') + '.weight = ' + weight + '' +')'
    ,@select_List = @select_List + 
        ',isnull(w' + REPLACE(weight,'.','_') + '.weightcnt , 0) as w' + REPLACE(weight,'.','_') + ''
    ,@pivot_List = COALESCE(@pivot_List + ',', '') + '[' + weight + ']'
FROM Weights 
```

哦，关于 Sql Fiddle：如果我理解了我被告知的内容，如果你想在同一批次中使用分号，你应该用分号分隔每个句子。不过还没试过。

**更新：**玩得更多了。您正在生成`select w1.weight`它应该读取的位置`w1.weightcnt`。正如您在上面的代码片段中看到的，将`.weight`@select_list 部分中的替换为`.weightcnt`，它将起作用。仍然存在一个问题：为什么不构建与工作示例相同的数据透视查询？

# php - foreach 循环内的 PHP foreach 循环

> ID：11570101
> 
> 赞同：4
> 
> 时间：2012-07-19T22:13:17.220
> 
> 标签：php, loops, foreach

我正在尝试在 foreach 循环中执行 foreach 循环。

我有一个表单，用户输入一些文本并点击发送。在服务器站点上，我遍历包含电子邮件地址的数组并发送文本消息。

现在我还希望用户能够在文本区域中使用变量，例如 $name。所以我的循环应该首先遍历电子邮件，然后用我的数组中的名称 str_replace userinput $name 变量。

该循环适用于电子邮件部分 ($tlf)，但不适用于替换 $name 部分。

有人能发现我做错了什么吗？

```
$message = stripslashes(strip_tags($_POST['message2']));
$tlf=array("name1","name2");
$test=array("mname1", "mname2");
$subject = "Hello world";
$from = "me@gmail.com";
$headers = "From: $from";

foreach($tlf as $name){
    $to = $name. "@gmail.com";
    foreach($test as $navn){
        $message = str_replace('$navn', $navn, $message);}
    mail($to,$subject,$message,$headers);
} 
```

非常感谢。

编辑：输出是发送的电子邮件。假设用户输入“hello $name”。我希望它首先遍历 $tlf 数组，在这种情况下创建 2 封电子邮件。这在第一个循环中以 $to 的形式出现。这行得通。

现在下一个循环应该识别用户输入“hello $name”并循环通过 $test 数组替换用户 $name 变量。

输出将是 2 封电子邮件发送。

1.  邮件输出：至：name1@gmail.com 消息：hello mname1

2.  邮件输出：至：name1@gmail.com 消息：hello mname2

如果我需要更好地解释，请告诉我，对不起，我很难解释。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T22:24:58.163

当您执行以下操作时：

```
str_replace('$navn', $navn, $message) 
```

然后***所有***字面上出现的 of`$navn`都将被替换（第一个，第二个，第三个，...）。因此，第二次运行该循环不可能再取代任何东西。

您将需要定义两个占位符，或者进行一些区分，或者[`preg_replace_callback`](http://php.net/preg_replace_callback)如果要声明应用可能的替换字符串的顺序（或其他逻辑），请使用。

如果您告诉我们（但您没有告诉我们）您只想替换每次迭代中的第一次出现，那么正常`preg_replace(.., .., .., 1)`就可以了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T22:24:20.750

这是你想要的吗？

```
$message = stripslashes(strip_tags($_POST['message2']));
$tlf=array(
            array("email" => "name1", "name" => "mname1"),
            array("email" => "name2", "name" => "mname2")
          );
$subject = "Hello world";
$from = "me@gmail.com";
$headers = "From: $from";

foreach($tlf as $contact){
    $to = $contact["email"] "@gmail.com";
    $replacedMessage = str_replace('$navn', $contact["name"], $message);
    mail($to,$subject,$replacedMessage,$headers);
} 
```

# jquery - JQuery 中的 JSP

> ID：11570104
> 
> 赞同：-3
> 
> 时间：2012-07-19T22:13:27.757
> 
> 标签：jquery, jsp

如何在 jquery 方法中编写 JSP 代码。我想在 jQuery 方法中调用一些 JSP 代码并使用其结果来操作 DOM。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T23:05:46.440

在你的 jQuery 代码中使用这个：

```
$.get('ajax/myJSPpage.jsp', function(data) {
// do your DOM modifications here
  $('.employee').html(data.employees[0].firstName);

}); 
```

JSP 文件应该返回一些数据。最好的格式是 JSON，因为它在 jQuery 中得到很好的支持。

所以只需返回一个类似于此的字符串

```
{
"employees": [
{ "firstName":"John" , "lastName":"Doe" }, 
{ "firstName":"Anna" , "lastName":"Smith" }, 
{ "firstName":"Peter" , "lastName":"Jones" }
]
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T22:17:02.907

你可以做的是编写一个收集信息的jsp（例如格式化为JSON）。然后使用 jquery ajax 调用来调用该 jsp 并使用来自 jsp 的数据来更新页面。

# android - jQuery mobile，检测用户何时向右滑动图像

> ID：11570105
> 
> 赞同：2
> 
> 时间：2012-07-19T22:13:31.567
> 
> 标签：android, jquery, jquery-mobile, cordova

我有一个应用程序，我希望用户通过将手指放在图像上并将其“移到”右侧来删除 DOM 元素（img）。我怎样才能检测到呢？我没有要显示的源代码，因为我真的想不出一种技术。

我正在使用 jQuery 移动和 PhoneGap。

注意：目前我正在 Android 上进行测试。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T02:01:58.317

如果您查看 jQM 库的源代码，您可以看到 swiperight 事件：

*   [http://jquerymobile.com/demos/1.1.1/js/jquery.mobile-1.1.1.js](http://jquerymobile.com/demos/1.1.1/js/jquery.mobile-1.1.1.js)

这行得通吗？

*   [http://jsfiddle.net/dQ4bq/](http://jsfiddle.net/dQ4bq/)
*   [http://jsfiddle.net/dQ4bq/1/](http://jsfiddle.net/dQ4bq/1/)（显示/隐藏）

JS：

```
$("#listitem").swiperight(function() {
    $('#theImage').remove();
}); 
```

HTML：

```
<div data-role="page" id="home"> 
    <div data-role="content">
        <p>
            <ul data-role="listview" data-inset="true" data-theme="c">
                <li id="listitem">Swipe Right to remove image</li>
            </ul>
        </p>
        <div id="theImage">
            <img src="http://web.tiscali.it/filemediaxtractor/albumingz/Example%20-%20Stay%20Awake.jpg" />
        </div>
    </div>
</div> 
```

# php - 如何使用 PHP 将这个时间转换并还原到 UNIX？

> ID：11570106
> 
> 赞同：0
> 
> 时间：2012-07-19T22:13:31.737
> 
> 标签：php

我想以 UNIX 格式将此日期格式保存到我的 DB 20/07/2012 22:10 中。我该如何做到这一点，以及如何将其恢复为可读格式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T22:17:55.963

我相信您正在寻找两种可能的变体。

```
//save it
$timestamp = strtotime('20/07/2012 22:10');
$timestamp = mktime(22, 10, 0, 20, 7, 2012); //mktime(h,m,s,M,D,Y)

//retrieve it with
while ($rows = /*...*/) { 
    $timestamp = date("D/M/Y g:i",$rows['timestamp']);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T22:18:41.247

试试 strtotime() PHP 函数。这可能是您正在寻找的。要将其恢复为可读格式，请使用 date() 函数，例如：

```
$date = date('Y-M-d', $unixTime); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T22:31:30.530

正如大卫所说，您可以使用`strtotime('20/07/2012 22:20')`，但您必须小心区域设置。

如果你觉得更舒服，你可以试试这个：

```
list($d, $m, $y, $h, $i) = sscanf('20/07/2012 22:20', '%d/%d/%d %d:%d');
$unix_timestamp = mktime($h, $i, 0, $m, $d, $y); 
```

# css - CSS：将div左/中/右放置在标题内

> ID：11570107
> 
> 赞同：21
> 
> 时间：2012-07-19T22:13:39.163
> 
> 标签：css, html, position, css-float

我一直在尝试创建具有以下结构的站点：
[![所需结构](../Images/337d2568236c06fd061e02dead81e91f.png)](https://i.stack.imgur.com/HF0eJ.png)

但我似乎无法让标题正确（e1 左，e2 居中，e3 右）。我希望三个元素 e1、e2 和 e3 位于左侧、中间和右侧。这就是我正在尝试的：

```
<div id="wrapper">
<div id="header">
    <div id="header-e1">
        1
    </div>
    <div id="header-e2">
        2
    </div>
    <div id="header-e3">
        3
    </div>
</div>
<div id="nav">
    links
</div>
<div id="content">
    content
</div>
<div id="footer">
    footer
</div>
</div> 
```

有了这个CSS：

```
#wrapper
{
    width: 95%;
    margin: 20px auto;
    border: 1px solid black;
}

#header
{
    margin: 5px;
}
#header-e1
{
    float: left;
    border: 1px solid black;
}
#header-e2
{
    float: left;
    border: 1px solid black;
}
#header-e3
{

    border: 1px solid black;
}

#nav
{
    margin: 5px;
}
#content
{
    margin: 5px;
}
#footer
{
    margin: 5px;
} 
```

## 有人可以给我一些提示吗？该结构将用于移动网站。

更新

我上面的代码给了我这个： [![当前结果](../Images/1a33bf78096fbe5ccef19aa4b50813d7.png)](https://i.stack.imgur.com/5347B.png) 但我想要 2 居中和 3 在右侧。我不想将宽度设置为百分比，因为元素中的内容可能会有所不同，这意味着它可能是 20/60/20 - 10/80/10 - 33/33/33 或其他值。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-07-19T23:46:37.010

## [利用溢出魔法：隐藏](http://web.archive.org/web/20150618153020/http://colinaarts.com/articles/the-magic-of-overflow-hidden/?)

如果您可以像这样交换 2 和 3 的 html 位置：

```
<div id="header-e1">
    1 is wider
</div>
<div id="header-e3">
    3 is also
</div>
<div id="header-e2">
    2 conforms
</div> 
```

然后你可以设置这个css，这将导致2因为它[**而“填充”可用空间**](http://jsfiddle.net/ZNGsh/3/)`overlow: hidden`。因此[**，如果 1 和 3 扩大，2 缩小**](http://jsfiddle.net/ZNGsh/4/)（缩小窗口以查看在非常小的尺寸下会发生什么）。

```
#header-e1 {float: left;}
#header-e2 {overflow: hidden;}
#header-e3 {float: right;} 
```

从技术上讲，您可以保留当前的 ​​html 顺序以及`float: left`1 和 2 上的内容，[**并将 3 设为 flex div**](http://jsfiddle.net/ZNGsh/6/)。`overflow: hidden`您[**可以**](http://jsfiddle.net/ZNGsh/7/)通过完全颠倒 html 的顺序并将 2 和 3 设置为 1 来`float: right`对 1执行相同的操作`overflow: hidden`。对我来说，最好有中间的 flex，但你比我更了解你的应用程序。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-19T22:24:49.643

如果您试图使网站具有响应式宽度，您可以尝试以下方法（33% 大约是三分之一）：

```
#header-e1 {
    float: left;
    width:33%;
    border: 1px solid black;
}

#header-e2 {
    float: left;
    width:33%;
    border: 1px solid black;
}

#header-e3 {
    float: left;
    width:33%;
    border: 1px solid black;
} 
```

您还可以为 div 使用固定宽度。如果您希望彼此之间的距离更远，您可以使用他们的左右边距等。希望对您有所帮助！

这是没有宽度的编辑：

```
#wrapper {
    position:relative; (add to wrapper)
}

#header-e1 {
    position:absolute;
    left:0;
    border:1px solid black;
}

#header-e2 {
    position:absolute;
    left:50%;
    border:1px solid black;
}

#header-e3 {
    position:absolute;
    right:0;
    border: 1px solid black;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T22:24:32.827

您需要给标题中的 div 一个宽度，并将 header-e3 向左浮动。

注意：它们都具有相同的 CSS 属性，因此只需给它们提供相同的类，如 .headerDivs，然后您就没有重复代码

编辑：这是一个有效的 jsfiddle：http: [//jsfiddle.net/eNDPG/](http://jsfiddle.net/eNDPG/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T22:40:26.613

我正在使用与 RevCocnept 建议的类似的想法`width: 33%`，除了使用`display: inline-block`而不是`float: left`. 这是为了避免从页面流中移除`div`里面的元素`#header`，导致高度`#header`变为零。

```
#header > div {
    display: inline-block;
    width: 31%;
    margin: 5px 1%;
} 
```

[演示](http://jsfiddle.net/Fxxwd/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-01T23:46:34.577

你可以这样做：

**HTML**

```
<div>
    <div id="left">Left</div>
    <div id="right">Right</div>
    <div id="center">Center</div>
</div> 
```

**CSS**

```
#left {
  float: left;
  border: 1px solid red;
}

#right {
  float: right;
  border: 1px solid blue;
}

#center {
  margin-left: 50px;
  margin-right: 50px;
  border: 1px solid green;
  text-align: center;
} 
```

居中的`<div>`必须是`HTML`代码中的最后一个。

这是一个要测试的 JS Bin：http: [//jsbin.com/evagat/2/edit](http://jsbin.com/evagat/2/edit)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-06-26T05:04:34.940

```
 <style type="text/css">
                        body {
                        margin:0;
                        }
                        #header {
                        width:100%;
                        **strong text**margin:auto;
                        height:10%;
                        background-color:red;
                        }
                        #left {
                        width:20%;
                        float:left;
                        #margin:auto auto auto auto;
                        height:100%;
                        background-color:blue;
                        }
                        #right {
                        float:right;
                        width:20%;
                        #margin:auto auto auto auto;
                        height:100%;
                        background-color:green;
                        }
                        #middle {
                        position:relative;
                        left:0;
                        right:0;
                        margin:auto;
                        height:80%;
                        background-color:yellow;
                        width:100%;
                        }
                        #middle1 {
                        width: 80%;
                        margin:auto;
                        height:45%;
                        background-color:black;
                        }
                        #middle2 {
                        width: 80%;
                        margin:auto;
                        height:40%;
                        background-color:brown;
                        }
                        #middle3 {
                        width: 80%;
                        margin:auto;
                        height:15%;
                        background-color:orange;
                        }
                        #midmain {
                        width: auto;
                        margin:auto;
                        height:100%;
                        background-color:white;
                        }
                        #footer {
                        width:100%;
                        margin:auto;
                        height:10%;
                        background-color:red;
                        }
                        </style>

now check comment for html design. 
```

# firefox - 是否可以在任何浏览器中使用搜索在网页上查找文本并在没有鼠标的情况下“单击”它？

> ID：11570108
> 
> 赞同：0
> 
> 时间：2012-07-19T22:13:46.507
> 
> 标签：firefox, google-chrome, safari, browser

假设我有一个页面，其中有 1000 个蓝色链接堆叠在一起。我想找到一个匹配模式“blah”的，所以我按 ctrl-F/cmd-F 并输入“blah”。我找到了链接，它为我突出显示。这是我的问题...

既然浏览器已经突出显示了这个链接，那么我是否可以“点击”它而不必抓住鼠标？我基本上想将标签焦点移到它上面，这样我就可以按回车键继续前进。

先谢谢了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-22T18:58:26.033

不知何故，我发现这个功能已经在 Chrome 中实现了：只需按`Ctrl`+ `Enter`。:)

# iphone - iPhone Mail Composer 外观更改是否允许？

> ID：11570113
> 
> 赞同：0
> 
> 时间：2012-07-19T22:14:09.413
> 
> 标签：iphone, xcode, uinavigationbar, background-image, mfmailcomposeviewcontroller

我似乎记得以前读到过不允许更改邮件编写器视图控制器的外观。但是，我也只是第一次尝试使用

```
[[UINavigationBar appearance] setBackgroundImage 
```

方法

这会更改邮件编写器视图控制器中的导航栏。那么，现在是否允许进行更改？我进行外观调用的原因是我有很多导航栏，并希望一次将它们全部设置好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T22:29:58.440

外观方法已记录在案，并且它们的效果旨在适用于整个应用程序，因此我认为没有理由使用它们会成为问题。

# c++ - 目标 C++ 调用目标 C

> ID：11570116
> 
> 赞同：1
> 
> 时间：2012-07-19T22:14:19.630
> 
> 标签：c++, objective-c, objective-c++, growl

我有一个需要从 Objective C++ 调用的咆哮动作

```
- (NSDictionary *) registrationDictionaryForGrowl {
    return [NSDictionary dictionaryWithObjectsAndKeys:
            [NSArray arrayWithObject:@"Alert"], GROWL_NOTIFICATIONS_ALL,
            [NSArray arrayWithObject:@"Alert"], GROWL_NOTIFICATIONS_DEFAULT
            , nil];
} 
```

是目标 C 中的操作，但我需要将它放在一个`.mm`文件（目标 C++）中，我很难尝试正确转换它，因为我需要将它放在（C++）内的（C++）函数中（C++）班级。

知道如何将其转移到Objective C++吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T22:25:32.070

在 Objective-C++ 中有 C++ 类和 Objective-C 类。没有 Objective-C++ 类。`GrowlApplicationBridgeDelegate`which 实现`registrationDictionaryForGrowl`必须是一个 Objective-C 对象。您可以在 .mm 文件中定义与在 .m 文件中完全相同的定义。唯一的区别是在您的 .mm 文件中，您定义的 Objective-C 类可以调用和使用 C++ 类和语法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T22:40:15.463

从我收集到的信息中，您想为 Growl 提供一个 C++ 对象，它需要和 Objective-C 对象。你不能这样做。

Objective-C 是一组焊接到 C 上的语言扩展。Objective-C++ 是将完全相同的扩展焊接到 C++ 上的结果。所以在 Objective-C++ 中你有 Objective-C 风格的对象和 C++ 对象，它们是完全不同的东西。当需要另一个时，不能使用一个。它们具有不同的 ABI、用于解决方法调用/消息发送的不同方案、不同的生命周期管理等。

Objective-C++ 的目的不是让 Objective-C 对象和 C++ 对象兼容，而只是让 Objective-C 代码可以在 C++ 中使用，而 C++ 代码可以在 Objective-C++ 中使用。

所以你可以做的是创建你想用作委托的 C++ 类，然后创建一个包装你的 C++ 类的 Objective-C++ 类，并具有简单地转发到你的 C++ 类的实例的方法。

```
class Foo {
    int bar(int i) { return i+1; }
};

@interface ObjCFoo : NSObject
{
    Foo foo;
}

- (int) bar:(int) i;
@end

@implementation ObjFoo
- (int) bar:(int) i;
{
    return foo.bar(i);
}
@end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T22:19:11.247

我不知道你怎么称呼 Objective-C++，但上面的代码，只要它在一个 Objective-C`@implementation`部分中，无论是否启用 Objective-C++（`.m`或`.mm`扩展）都可以正常编译。

顺便说一句，如果您使用的是 Xcode 4.4 或更高版本，以下内容也可以：

```
- (NSDictionary*) registrationDictionaryForGrowl {
    return @{
        GROWL_NOTIFICATIONS_ALL : @[ @"Alert" ],
        GROWL_NOTIFICATIONS_DEFAULT : @[ @"Alert" ] };
} 
```

# ios - ios：使滚动视图出现在笔尖上的项目下方

> ID：11570121
> 
> 赞同：0
> 
> 时间：2012-07-19T22:15:14.590
> 
> 标签：ios

我有一个滚动视图，它使用视图的整个空间，并启用了分页。但是我想要一种从页面跳转到页面的方法，所以我在界面生成器的笔尖上创建了一个小子视图，一个章节索引，带有一些按钮可以跳转到你想要的页面。问题是，scrollView 是以编程方式创建的，它出现在我在笔尖上创建的“章节索引”上方。

我在 viewDidLoad 下添加了这样的滚动视图：

```
[self.view addSubview:self.myScrollView]; 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T22:20:00.130

你应该试试

```
 [self.view insertSubview:self.myScrollView belowSubview:self.chapterIndexView]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T22:26:12.567

你也可以试试：

[self.view bringSubviewToFront:chapterIndex];

# mysql - 比较慢的 MySQL 查询

> ID：11570126
> 
> 赞同：0
> 
> 时间：2012-07-19T22:15:40.267
> 
> 标签：mysql

我有一个看似简单的问题，但正在苦苦挣扎。我有 2 张桌子，如下所示。

表 1 有房间事件和时间（秒） 表 2 有房间访问时间（秒）和人名

对于表 1 中的每一行，我想输出最后一个进入房间的人，但前提是他们在最后 5 分钟内进入房间

time 是两个表的主索引

表 1 示例（事件）

```
|time      |event|
|1294427839|poff |
|1294427939|pofn |
|1294428839|poff | 
```

表 2 示例（条目）

```
|time      |name|
|1294427829|tpeters |
|1294427929|jsmith |
|1294428829|abeach | 
```

表 1 有大约 5,000 行，表 2 大约有 300,000 我目前正在使用以下查询，但需要几分钟才能完成。有人可以告诉我我做错了什么。

```
select (SELECT name FROM entries entries WHERE entries.time > events.time-300 and  entries.time < events.time order by entries.time desc limit 1) from events events 
```

任何帮助将非常感激。

添加了更多细节：

```
ID  SELECT_TYPE        TABLE    TYPE    POSSIBLE_KEYS   KEY     KEY_LEN     ROWS    FILTERED    EXTRA
1   PRIMARY            events   index                   PRIMARY 8           3       100     Using index
2   DEPENDENT SUBQUERY entries  index   PRIMARY         PRIMARY 8           1       300     Using where 
```

CREATE TABLE events ( `time`int(11) NOT NULL DEFAULT '0', PRIMARY KEY ( `time`)) ENGINE=InnoDB DEFAULT CHARSET=utf8 ROW_FORMAT=COMPACT;

CREATE TABLE 条目（ `time`int(11) NOT NULL DEFAULT '0', PRIMARY KEY ( `time`) ）ENGINE=InnoDB DEFAULT CHARSET=utf8 ROW_FORMAT=COMPACT;

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T23:42:23.227

试试这个

```
SELECT name, ev_time, en_time
FROM (
  SELECT
    name,
    IF(events.time = @last_time, 0, 1) AS last,
    @last_time := events.time AS ev_time,
    entries.time AS en_time
  FROM events
  LEFT JOIN entries ON (entries.time BETWEEN events.time-300 AND events.time)
  ORDER BY events.time, entries.time
) as tmp
WHERE last = 1 
```

在[sqlfiddle对其进行了测试](http://sqlfiddle.com/#!2/96e30/2/0)

# javascript - 新日期(2012, 01,01) 不同于新日期(2012 01 01)

> ID：11570127
> 
> 赞同：1
> 
> 时间：2012-07-19T22:15:42.063
> 
> 标签：javascript

在 chrome 控制台中，

`new Date('2012 01 01')` 输出：`Sun Jan 01 2012 00:00:00 GMT-0600 (Central Standard Time)`

`new Date(2012, 01, 01)` 输出： `Wed Feb 01 2012 00:00:00 GMT-0600 (Central Standard Time)`

我真的很好奇为什么会发生这种情况。

有人愿意透露一些信息吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T22:17:48.570

我想你的意思是这些：

```
new Date('2012 01 01');
new Date(2012, 01, 01); // Note the commas 
```

原因是上面的第二个示例使用了接受数字而不是字符串的[构造函数](http://ecma-international.org/ecma-262/5.1/#sec-15.9.3.1)[版本`Date`](http://ecma-international.org/ecma-262/5.1/#sec-15.9.3.1)，并且 JavaScript 中的月份数字以 0 = 一月开头。所以`new Date(2012, 1, 1)`（你的例子中的领先`0`在技术上是一个错误，但大多数引擎允许它并将数字视为八进制）是2012 年**2 月**1 日。

上面的第一个版本使用[`Date`接受字符串](http://ecma-international.org/ecma-262/5.1/#sec-15.9.3.2)并对其进行解析的构造函数，在解析日期字符串时，月份数字通常以 1 = 一月开始。请注意，您要求 Chrome 解析的字符串不是规范定义的任何格式，其他引擎可能无法解析它。事实上，直到 ECMAScript 5 之前，都**没有**定义日期字符串格式（`Date`接受字符串的构造函数被定义为接受任何`toString`输出，但实际上都没有指定）。ECMAScript 5 添加了 ISO-8601 的简化版本。但是在野外，过去十年中的每个引擎都支持形式的日期字符串`yyyy/mm/dd`（但不一定是现在指定的`yyyy-mm-dd`）。

# backbone.js - Backbone.LayoutManager 委托视图事件

> ID：11570129
> 
> 赞同：0
> 
> 时间：2012-07-19T22:15:48.540
> 
> 标签：backbone.js

我一直在使用 Backbone.LayoutManager 开发原型 Backbone 应用程序，但遇到了一些我不明白的事情。

场景是我有一个用于将“人”{firstname, lastname} 添加到列表视图的表单，我很好地保存了模型并且新项目显示在列表中。我还有一个在页面刷新后可以使用的删除函数，但是如果我尝试删除我刚刚创建的人而不刷新页面，则永远不会调用 removeUser() 函数。

我的代码如下。有人可以帮我吗？我只是想学习 Backbone，如果您有这个问题的答案以及任何其他批评，我将不胜感激。谢谢。

```
define([
    // Global application context.
    "app",

    // Third-party libraries.
    "backbone"
],

function (app, Backbone) {
    var User = app.module();

    User.Model = Backbone.Model.extend({
        defaults : {
            firstName: "",
            lastName: ""
        }
    });

    User.Collection = Backbone.Collection.extend({
        model: User.Model,
        cache: true,
        url: "/rest/user"
    });

    User.Views.EmptyList = Backbone.View.extend({
        template: "users/empty-list",
        className: "table-data-no-content",
        render: function (manage) {
            return manage(this).render().then(function () {
                this
                    .$el
                    .insertAfter(".table-data-header")
                    .hide()
                    .slideDown();
            });
        }
    });

    User.Views.Item = Backbone.View.extend({
        template: "users/user",
        tagName: "ul",
        className: "table-data-row"
        events: {
            "click .remove": "removeUser"
        },
        removeUser: function () {
            console.log(this.model);
            this.model.destroy();
            this.collection.remove(this.model);
            this.$el.slideUp();
            if (this.collection.length === 0) {
              this.insertView(new User.Views.EmptyList).render();
            }
        }
    });

    User.Views.List = Backbone.View.extend({
        initialize: function () {
            this.collection.on("change", this.render, this);
        },
        render: function (manage) {
            if (this.collection.length > 0) {
                jQuery(".table-data-no-content").slideUp("fast", function() {
                    $(this).remove();
                });
                this.collection.each(function(model) {
                    this.insertView(new User.Views.Item({
                      model: model,
                      collection: this.collection,
                      serialize: model.toJSON()
                    }));
                }, this);
            } else {
                this.insertView(new User.Views.EmptyList());
            }

            // You still must return this view to render, works identical to
            // existing functionality.
            return manage(this).render();
          }
    });

    User.Views.AddUser = Backbone.View.extend({
        template: "users/add-user",
        events: {
            "click input#saveUser": "saveUser"
        },
        render: function (manage) {
            return manage(this).render().then(function () {
                $("input[type='text']")
                     .clearField()
                     .eq(0)
                     .focus();
            });
        },
        saveUser: function () {
            var user = new User.Model({
                firstName: $(".first-name").val(),
                lastName: $(".last-name").val()
            });

            this.collection.create(user);

            this
                .$("input[type='text']")
                .val("")
                .clearField("refresh")
                .removeAttr("style")
                .eq(0)
                .focus();
        }
    });

    return User;

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T21:57:36.553

问题原来是来自服务器的错误响应。一旦服务器发回正确的 JSON 对象，一切正常。

# java - Java中等效的生成器函数

> ID：11570132
> 
> 赞同：52
> 
> 时间：2012-07-19T22:16:21.410
> 
> 标签：java, python, iterator, generator

我想`Iterator`在 Java 中实现一个类似于 Python 中的以下生成器函数的行为：

```
def iterator(array):
   for x in array:
      if x!= None:
        for y in x:
          if y!= None:
            for z in y:
              if z!= None:
                yield z 
```

java 端的 x 可以是多维数组或某种形式的嵌套集合。我不确定这将如何工作。想法？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2014-01-07T12:07:45.007

有同样的需求，所以为它写了一个小类。这里有些例子：

```
Generator<Integer> simpleGenerator = new Generator<Integer>() {
    public void run() throws InterruptedException {
        yield(1);
        // Some logic here...
        yield(2);
    }
};
for (Integer element : simpleGenerator)
    System.out.println(element);
// Prints "1", then "2". 
```

无限生成器也是可能的：

```
Generator<Integer> infiniteGenerator = new Generator<Integer>() {
    public void run() throws InterruptedException {
        while (true)
            yield(1);
    }
}; 
```

该类在`Generator`内部使用 Thread 来生成项目。通过覆盖`finalize()`，它可以确保如果不再使用相应的生成器，则不会留下任何线程。

性能显然不是很好，但也不是太破旧。在我的具有双核 i5 CPU @ 2.67 GHz 的机器上，可以在 < 0.03 秒内生产 1000 个项目。

代码在[GitHub 上](https://github.com/mherrmann/java-generator-functions)。在那里，您还可以找到有关如何将其包含为 Maven/Gradle 依赖项的说明。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2014-07-12T22:30:27.680

Java 确实没有收益，但您现在可以使用 Java 8 流。IMO 它确实是一个复杂的迭代器，因为它由一个数组支持，而不是一个函数。鉴于它是循环中的循环，循环中的循环可以表示为使用过滤器（跳过空值）和 flatMap 流式传输内部集合的 Stream。它也与 Python 代码的大小有关。我已将它转换为迭代器以供您在闲暇时使用并打印出来进行演示，但如果您所做的只是打印，则可以使用 forEach(System.out::println) 而不是 iterator() 结束流序列。

```
public class ArrayIterate
{
    public static void main(String args[])
    {
        Integer[][][] a = new Integer[][][] { { { 1, 2, null, 3 },
                                                null,
                                                { 4 }
                                              },
                                              null,
                                              { { 5 } } };

        Iterator<Object> iterator = Arrays.stream(a)
                                          .filter(ax -> ax != null)
                                          .flatMap(ax -> Arrays.stream(ax)
                                               .filter(ay -> ay != null)
                                               .flatMap(ay -> Arrays.stream(ay)
                                               .filter(az -> az != null)))
                                          .iterator();

        while (iterator.hasNext())
        {
            System.out.println(iterator.next());
        }
    }
} 
```

作为我关于 Java 8 函数式编程和 Lambda 表达式的博客的一部分，我在[http://thecannycoder.wordpress.com/](http://thecannycoder.wordpress.com/)上写了关于生成器的实现的文章，这可能会为您提供更多将 Python 生成器函数转换为 Java 等价物的想法。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-07-05T20:06:25.023

我希望 Java 有生成器/产量，但由于它不使用迭代器可能是你最好的选择。

在这个例子中，我坚持使用数组，但通常我会建议使用 Iterable Collection 代替，例如。列表。在示例中，我展示了如何轻松获取数组的迭代器：

```
package example.stackoverflow;

import com.sun.xml.internal.xsom.impl.scd.Iterators;

import java.util.Arrays;
import java.util.Iterator;

public class ArrayGenerator<T> implements Iterable<T> {
    private final T[][][] input;

    public ArrayGenerator(T[][][] input) {
        this.input = input;
    }

    @Override
    public Iterator<T> iterator() {
        return new Iter();
    }

    private class Iter implements Iterator<T> {
        private Iterator<T[][]> x;
        private Iterator<T[]> y;
        private Iterator<T> z;

        {
            x = Arrays.asList(input).iterator();
            y = Iterators.empty();
            z = Iterators.empty();
        }

        @Override
        public boolean hasNext() {
            return z.hasNext() || y.hasNext() || x.hasNext();
        }

        @Override
        public T next() {
            while(! z.hasNext()) {
                while(! y.hasNext()) {
                    y = Arrays.asList(x.next()).iterator();
                }
                z = Arrays.asList(y.next()).iterator();
            }
            return z.next();
        }

        @Override
        public void remove() {
            throw new UnsupportedOperationException("remove not supported");
        }
    }

    public static void main(String[] args) {
        for(Integer i :
                new ArrayGenerator<Integer>(
                        new Integer[][][]{
                          {
                            {1, 2, 3},
                            {4, 5}
                          },
                          {
                            {},
                            {6}
                          },
                          {
                          },
                          {
                            {7, 8, 9, 10, 11}
                          }
                        }
                )) {
            System.out.print(i + ", ");
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-07-19T22:40:42.137

Java中没有yield，所以你必须自己做所有这些事情，最终得到如下荒谬的代码：

```
 for(Integer z : new Iterable<Integer>() {

        @Override
        public Iterator<Integer> iterator() {

            return new Iterator<Integer>() {

                final Integer[][][] d3 = 
                        { { { 1, 2, 3 }, { 4, 5, 6 }, { 7, 8, 9 } },
                        { { 10, 11, 12 }, { 13, 14, 15 }, { 16, 17, 18 } },
                        { { 19, 20, 21 }, { 22, 23, 24 }, { 25, 26, 27 } } };

                int x = 0; 
                int y = 0; 
                int z = 0;

                @Override
                public boolean hasNext() {
                    return !(x==3 && y == 3 && z == 3);
                }

                @Override
                public Integer next() {
                    Integer result = d3[z][y][x];
                    if (++x == 3) {
                        x = 0;
                        if (++y == 3) {
                            y = 0;
                            ++z;
                        }
                    }
                    return result;
                }

                @Override
                public void remove() {
                    throw new UnsupportedOperationException();
                }
            };
        }
    }) {
        System.out.println(z);
    } 
```

但如果你的样本不止一个`yield`，结果会更糟。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-02-02T19:58:04.653

从 Python 风格的生成器到 Java 风格的迭代器的转换可以自动化。如果您愿意在构建过程中接受代码生成，您可能会对这个为您进行翻译的原型工具感兴趣：

[https://github.com/Calvin-L/gen2it](https://github.com/Calvin-L/gen2it)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-09-13T11:52:05.453

假设您在问题中描述的 Python 数据结构可以使用以下 Java 类型进行描述：

```
List<List<List<T>>>; 
```

并且您想在这样的操作中使用它：

```
for (T z : iterator(array)) {
  // do something with z
} 
```

如果是这样，那么可以`iterator()`使用 Java 8 流非常简单地实现您的 Python：

```
public <T> Iterable<T> iterator(List<List<List<T>>> array) {
  return array.stream()
      .filter(Objects::nonNull) // -> emits stream of non-null `x`s
    .flatMap(x -> x.stream()).filter(Objects::nonNull) // -> emits […] `y`s
    .flatMap(y -> y.stream()).filter(Objects::nonNull) // -> emits […] `z`s
    .collect(Collectors.toList()); // get list of non-null `z`s to iterate on
} 
```

当然，您不能收集结果并输出流以进行进一步的流式处理（人们告诉我这是个好主意）：

```
public <T> Stream<T> streamContent(List<List<List<T>>> array) {
  return array.stream()
      .filter(Objects::nonNull) // -> emits stream of non-null `x`s
    .flatMap(x -> x.stream()).filter(Objects::nonNull) // -> emits […] `y`s
    .flatMap(y -> y.stream()).filter(Objects::nonNull); // -> emits […] `z`s
}

// ...

streamContent(array).forEach(z -> {
  // do something with z
}); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-02-13T01:41:49.860

比赛很晚，但我想提供我的解决方案作为参考。 [https://github.com/tsi-software/JavaGenerator](https://github.com/tsi-software/JavaGenerator) 一个 Java 类，它允许您编写与 Python 和 C# 尽可能相似的“生成器”代码。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-09-05T19:11:12.790

您可以使用流的迭代器来完成此操作。

```
// Save the iterator of a stream that generates fib sequence
Iterator<Integer> myGenerator = Stream
        .iterate(new Integer[]{ 1, 1 }, x -> new Integer[] { x[1], x[0] + x[1] })
        .map(x -> x[0]).iterator();

// Print the first 5 elements
for (int i = 0; i < 5; i++) {
    System.out.println(myGenerator.next());
}

System.out.println("done with first iteration");

// Print the next 5 elements
for (int i = 0; i < 5; i++) {
    System.out.println(myGenerator.next());
} 
```

输出：

```
1
1
2
3
5
done with first iteration
8
13
21
34
55 
```

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2015-12-11T21:39:07.163

不，Java 本身没有“生成器”或“产量”，但使用[观察者模式](https://en.wikipedia.org/wiki/Observer_pattern)可以获得相同的功能。当使用像[RxJava](https://github.com/ReactiveX/RxJava)这样的现代实现时，这一点得到了增强。您的代码将订阅 Obserable 并且每当它尝试从 Observable 读取下一个值时，它都会导致它“生成”它的下一个值。Observable 可以像 Python 或 JavaScript 的生成器一样维护自己的状态。当没有要读取的新值时，“next()”方法将阻止等待新数据可用。一个很好的例子可以在[这里](https://github.com/ReactiveX/RxJava/wiki/How-To-Use-RxJava#asynchronous-observable-example)找到。

# ruby-on-rails - 第 3 方的 ruby rails 资产路径

> ID：11570135
> 
> 赞同：1
> 
> 时间：2012-07-19T22:16:36.787
> 
> 标签：ruby-on-rails, asset-pipeline

我正在尝试从 Rails 2.3.8 移植到 Rails 3.2.6。我的应用程序当前使用放置在`public/<3rdparty>/<subdir>/../..`

在`layout/application.html.erb`中，我使用绝对路径来检索它们；例如`<%= stylesheet_link_tag "/dojoroot/dojo/resources/dojo.css" %>`和`<%= javascript_include_tag "/dojoroot/dojo/dojo.js" %>`

对于 Rails 3.2.6，资产预计位于`app/assets`或中`lib/assets`。但是，将第 3 方从公共移动到应用程序/资产不起作用，因为标签正在寻找各自类型下的资产。例如，`<%= stylesheet_link_tag "dojoroot/dojo/resources/dojo.css" %>`将查看`app/assets/stylesheet/dojoroot/dojo/resources/dojo.csc`和同样的 javascripts 将查看`apps/assets/javascripts/dojoroot/dojo/dojo.js`. 将第 3 方分解为样式表/javascripts/图像的 3 个子目录似乎相当浪费和耗时。

如果我将绝对路径传递给标签；例如`<%= javascript_include_tag "/dojoroot/dojo/dojo.js" %>`，Rails 不会在 app/assets/dojoroot 中找到它。

有没有一种配置可以让 Rails 在不将“样式表”、“javascripts”注入路径的情况下查找资产？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T22:19:54.387

只是命名文件，没有路径

```
<%= stylesheet_link_tag "dojo" %> 
```

如果你想引用多个，你可以这样做

```
<%= stylesheet_link_tag "dojo", "custom" %> 
```

另外，请确保您在 app/assets/javascript/application.js 中拥有

```
//= require jquery
//= require jquery_ujs
//= require_tree . 
```

`<%= javascript_include_tag(:application) %>`在你的`application.html.erb`

[阅读http://edgeguides.rubyonrails.org/asset_pipeline.html](http://edgeguides.rubyonrails.org/asset_pipeline.html)中的“2.1.2 使用索引文件”

# android - AdMob 收入和替代方案：展示次数与点击次数

> ID：11570139
> 
> 赞同：26
> 
> 时间：2012-07-19T22:17:22.187
> 
> 标签：android, admob

我实际上将 AdMob 用于我的 Android 应用程序。

目前，即使我接近 1000 次展示，我的收入也为零。所以我得出结论，AdMob 是基于 CPC（[每次点击费用](https://www.bloggermafia.online/2019/09/Admob-Revenue.html)）系统的（因为我确实没有点击）。

*   总是这样吗？还是 AdMob 有时也会使用每次展示费用系统？如果是，我们可以选择使用而不是每次印象系统的成本吗？

*   [否则，是否有任何替代广告网络可以全部或部分支付每次展示费用？](https://www.bloggermafia.online/2019/09/Admob-Revenue.html)

**编辑**：

[目前这是我发现的：](https://www.bloggermafia.online/2019/09/Admob-Revenue.html)

*   **AdMob** -> CPC：（根据我自己的经验）

*   **[此页面的](http://www.jumptap.com/sign-up/)**JumpTap** -> CPC ：“*通过按点击付费的广告宣传您的业务*”**

***   **inMobi** -> 不精确

    *   **mmedia** -> CPM、CPC 和 CPA 来自[此页面](http://mmedia.com/help-center/monetize/reporting-performance/reporting/)：“*您的收入指标或有效 CPM。因为我们在我们的网络上提供各种广告系列，包括 CPM（每千次展示费用）、CPC（每次点击费用）和 CPA（每次费用行动），有效每千次展示费用提供了一种一致的方式来跟踪您展示的每个广告的收入。* ”

    但我不知道我们是否可以在这里选择我们喜欢的系统......

    *   **MobFox** : CPC 和 CPM from [this page](http://www.mobfox.com/publisher-ecpmcontrol) : 他们在他们的例子中提到了“*每千人 2 美元*”。但是在这里，不知道我们是否可以控制使用哪个系统，或者我们是否被迫通过 CPC 系统付费。** 

 **我确实认为使用不同的网络可能非常有趣（例如通过 adMob 中的中介）。

还要小心“CPM”或“CPI”：有时网络会提到每次展示费用 (CPI)，但实际上他们只是向您支付 CPC 并通过简单*的 Nb of Impression / Nb of click*来评估 CPI 。当然，在这种情况下，CPI 只是一个指标，并不能保证任何收入。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-19T22:33:40.373

我认为 AdMob 是基于 CPC 的，你不能以任何方式从展示中赚取任何收入。查看使用中介模式的 AdMob SDK 也支持的mMedia ( [http://mmedia.com/ ) 和 inMobi：](http://mmedia.com/) [https ://developers.google.com/mobile-ads-sdk/docs/android/调解/](https://developers.google.com/mobile-ads-sdk/docs/android/mediation/)**

# java - 对文档进行物理排序的算法java

> ID：11570141
> 
> 赞同：0
> 
> 时间：2012-07-19T22:17:30.927
> 
> 标签：java, algorithm, sorting

我有一台扫描仪，可以从几个文档中捕获帐号。我需要一种对这些文档进行物理排序的算法。扫描仪有 11 个用于分隔的口袋。我尝试了一些（合并排序，桶排序）但没有固定数量的口袋。到目前为止，我的解决方案是对所有文档进行一次传递，以识别整个宇宙。我还承认，我必须将所有文档多次通过扫描仪才能进行物理分类。有任何疑问我都可以回答。如果可能的话在java中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-20T03:34:18.527

1965年的阴影！

当我在 1970 年代初上学时，我们必须提交关于打孔卡的程序，为此目的，房间里摆满了打孔卡。在一个角落里是一个卡片分类器，一个长约 10 英尺、高 4 英尺、宽 3 英尺的庞然大物。它有 12 个输出箱，每次通过时都会根据单列中的值将卡片分成箱。

为了对卡片组进行排序，必须在每张卡片的固定位置（通常为 73-80 列）打上序列号。您将多次通过分拣机运行甲板，首先从最后一列 (80) 开始；这一关将卡片分成 10 叠，每叠包含序列号以特定数字结尾的卡片。然后你取出 10 个堆栈并按顺序将它们组合成一个，将排序器设置更改为第 79 列，然后再次运行它们。然后您将重复此操作，直到到达第 73 列（或仅包含零的第一列）。

您应该能够用您的扫描仪做同样的事情。

（哇，我从没想过一点历史奥秘会有用:-)

# string - 这些 ASCII / Unicode 字符串是否等效？

> ID：11570146
> 
> 赞同：-2
> 
> 时间：2012-07-19T22:17:46.340
> 
> 标签：string, unicode, ascii

“1055912799”ASCII 字符串是否等同于“1055912799”Unicode 字符串？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T22:20:31.860

因为 ASCII 是 unicode 的子集，所以任何 ASCII 字符串在 unicode 中都是相同的，当然前提是您使用 UTF-8 对其进行编码。显然 UTF-16 或 UTF-32 编码会导致它相当臃肿。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T22:35:38.503

是的，Unicode 中的数字字符 0 到 9 被定义为与 Ascii 中相同的字符。更一般地说，所有可打印的 Ascii 字符也都以 Unicode 编码（顺便说一下，使用相同的代码编号）。

作为字节序列的内部表示是否相同取决于字符编码。Unicode 的 UTF-8 编码经过设计，使得 Ascii 字符具有与当前用于 Ascii 的唯一编码相同的字节编码表示（将每个 Ascii 代码编号映射到一个 8 位字节，第一位设置为零）。

Ascii 范围内字符的 UTF-16 编码表示可以说与 Ascii 编码“等效”，因为存在一个简单的映射：在 UTF-16 中，每个 Ascii 字符显示为两个字节，一个零字节和一个包含 Ascii 编号的字节。（这些字节的顺序取决于 UTF-16 的字节序。）但是这种“等价”概念通常不会被使用，也不会特别有用。

# sql - 搜索 Sqlite

> ID：11570148
> 
> 赞同：0
> 
> 时间：2012-07-19T22:17:54.133
> 
> 标签：sql, sqlite

我想知道是否有一种方法可以在整个 SQLite 数据库中搜索一个特定的单词。我不知道它所在的列，甚至不知道它所在的表。

包含此特定单词的表和行/列还包含我需要编辑的其他条目。

简而言之：

需要找到一个特定的词

无法查询（我认为我至少不能），因为我不知道它所在的表或列名。

我需要知道这个特定词在哪里被引用。在什么表和行中，这样我就可以访问它旁边的其他人。

基本上，是否有 SQlite 的 CTRL+F 功能可以搜索整个 SQLite 文件？

我有 mac/windows/linux 机器。如果这是一个解决方案，我不受软件的限制。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T01:18:57.490

任何此类功能本质上都是运行检查每个表的每一列的查询。您可以通过运行以下 SQL 的脚本来执行此操作：

1）获取所有表的列表：

```
select name from sqlite_master where type = 'table' 
```

2）对于每个表，获取其所有列（列名在`name`字段中可用）

```
pragma table_info(cows) 
```

3）然后对于每个表，生成一个检查每个字段的查询并运行它：

```
select
  *
from cows
where name like '%Daisy%'
or owner like '%Daisy%'
or farm like '%Daisy%' 
```

# python - numpy.choose 32 选择限制

> ID：11570157
> 
> 赞同：2
> 
> 时间：2012-07-19T22:19:02.140
> 
> 标签：python, numpy

低，我在升级到 1.5.1 后遇到了 numpy.choose 的回归。据我所知，过去的版本（和数字）支持无限数量的潜在选择。“新”选择限制为 32。 [这是](http://mail.scipy.org/pipermail/numpy-discussion/2011-July/057831.html)另一位用户感叹回归的帖子。

我有一个包含 100 个选项 (0-99) 的列表，用于修改数组。作为一种解决方法，我正在使用以下代码。可以理解，它比使用选择慢 7 倍。我不是 C 程序员，虽然我想解决 numpy 问题，但我想知道还有哪些其他可能更快的解决方法。想法？

```
d={...} #A dictionary with my keys and their new mappings
for key, value in d.iteritems():
    array[array==key]=value 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T22:28:07.610

我收集到有`d`钥匙。在这种情况下，解决方案非常简单。首先，将 的值写入NumPy 数组，以某种方式——这似乎是这些值的自然数据结构。然后您可以使用替换的值访问新数组`0``99``d``values``d[i] == values[i]`

```
values[array] 
```

如果您想`array`就地修改，只需执行

```
array[:] = values[array] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-06-18T09:57:23.350

在 Numpy 文档中，有一个示例说明了选择函数的简化版本的外观。

> [...] 这个函数不像从下面的代码描述中看起来那么简单（在 ndi = numpy.lib.index_tricks 下面）：
> 
> ```
> np.choose(a,c) == np.array([c[a[I]][I] for I in ndi.ndindex(a.shape)]). 
> ```

请参阅[https://docs.scipy.org/doc/numpy/reference/generated/numpy.choose.html](https://docs.scipy.org/doc/numpy/reference/generated/numpy.choose.html)

将其放入函数中可能如下所示：

```
import numpy

def choose(selector, choices):
    """
    A simplified version of the numpy choose function to workaround the 32
    choices limit.
    """
    return numpy.array([choices[selector[idx]][idx] for idx in numpy.lib.index_tricks.ndindex(selector.shape)]).reshape(selector.shape) 
```

我不确定这在效率方面是如何转化的，以及与功能相比何时会发生故障`numpy.choose`。但这对我来说效果很好。请注意，patched 函数假定选项中的条目是可下标的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T22:47:02.410

我不确定效率并且它不是到位的（注意：我不经常使用 numpy - 所以有点生疏）：

```
import numpy as np

d = {0: 5, 1: 3, 2: 20}
data = np.array([[1, 0, 2], [2, 1, 1], [1, 0, 1]])
new_data = np.array([d.get(i, i) for i in data.flat]).reshape(data.shape) # adapt for list/other 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-09-28T13:26:45.930

在对小鼠胚胎的显微图像进行着色时，我遇到了一种`choose`实现需求，其中选择的数量为数百（数百个小鼠胚胎细胞）。

[https://github.com/flatironinstitute/mouse_embryo_labeller](https://github.com/flatironinstitute/mouse_embryo_labeller)

由于我不确定上述建议是通用的还是快速的，所以我写了这个替代方案：

```
import numpy as np

def big_choose(indices, choices):
    "Alternate to np.choose that supports more than 30 choices."
    indices = np.array(indices)
    if (indices.max() <= 30) or (len(choices) <= 31):
        # optimized fallback
        choices = choices[:31]
        return np.choose(indices, choices)
    result = 0
    while (len(choices) > 0) and not np.all(indices == -1):
        these_choices = choices[:30]
        remaining_choices = choices[30:]
        shifted_indices = indices + 1
        too_large_indices = (shifted_indices > 30).astype(np.int)
        clamped_indices = np.choose(too_large_indices, [shifted_indices, 0])
        choices_with_default = [result] + list(these_choices)
        result = np.choose(clamped_indices, choices_with_default)
        choices = remaining_choices
        if len(choices) > 0:
            indices = indices - 30
            too_small = (indices < -1).astype(np.int)
            indices = np.choose(too_small, [indices, -1])
    return result 
```

请注意，通用函数尽可能使用底层实现。

# ios - UITableView 在不应该的时候将触摸事件传递给 superview

> ID：11570160
> 
> 赞同：3
> 
> 时间：2012-07-19T22:19:14.263
> 
> 标签：ios, cocoa-touch, mapkit, gesture-recognition

在[GIKAnimatedCallout](http://www.cocoacontrols.com/platforms/ios/controls/gikanimatedcallout)示例代码中，双击手势、两指点击手势、缩放手势和捏合手势都从 UITableView 传递到它下面的 MKMapView。我想阻止这种情况发生。UITableView 内的触摸事件不应传递到 MKMapView。

我尝试为点击添加 UIGestureRecognizer，并将其设为空方法，但这些触摸事件仍会发送到 MKMapView 以及 UITableView。

通过调试器查看 UITableView 的 superview 层次结构，我看到 UITableView 是 MKMapView 的后代。

我真的不知道如何解决这个问题。任何指针表示赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-20T00:58:23.497

如果我理解正确，如果在 UITableView 上做出手势，您希望 MKMapView 根本不做出反应（在示例中，myMKMapView 的 myTableView 属性是有问题的 UITableView）。如果是这样，你应该实施

```
 - (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldReceiveTouch:(UITouch *)touch; 
```

在您的 MKMapView 子类中（如果您没有子类，请创建一个子类。在此示例中，我将子类称为 myMKMapView）。首先让您的 MKMapView 子类 myMKMapView 符合`UIGestureRecognizerDelegate`协议。在 MKMapView 的 .h 文件中：

```
@interface myMKMapView : MKMapView <UIGestureRecognizerDelegate> 
```

完成此操作后，进入 myMKMapView 的 .m 文件并执行以下操作：

```
- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldReceiveTouch:(UITouch *)touch {
    UIView *view = [self.view hitTest:[touch locationInView:self.view] withEvent:nil];

    if ([view isDescendantOfView:(self.myTableView)]) {
        return NO;
    }
    return YES;
} 
```

这告诉 myMKMapView 如果在其 myTableView 属性上执行了一个手势，myMKMapView 应该忽略它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-10-03T15:01:17.327

Swift 5 版本的[Pedro Cattori 的回答](https://stackoverflow.com/a/11571456/1850858)。

```
func gestureRecognizer(_ gestureRecognizer: UIGestureRecognizer, shouldReceive touch: UITouch) -> Bool {
    !(view.hitTest(touch.location(in: view), with: nil)?.isDescendant(of: tableView) == true)
} 
```

# wix - 我可以使用 WiX 在一处更改所有安装程序对话框的尺寸吗？

> ID：11570161
> 
> 赞同：1
> 
> 时间：2012-07-19T22:19:27.273
> 
> 标签：wix

我正在使用 WiX 构建安装程序，并且我希望所有安装程序的对话框都大于默认尺寸。是否有一个中心点，我可以在我的安装程序中为所有对话框设置宽度和高度？如果没有，至少有办法改变内置对话框的尺寸吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-21T05:37:42.017

在 WiX v3.6 中，您可以使用本地化文件来更改对话框和控件的大小和位置。有关详细信息，请参阅[我的博客文章](http://www.joyofsetup.com/2012/07/14/localizing-more-than-strings-in-wix-v3-6/)。改变一切仍然需要做很多工作。

# javascript - HTML5 拖放不会掉落

> ID：11570163
> 
> 赞同：5
> 
> 时间：2012-07-19T22:19:52.760
> 
> 标签：javascript, jquery, html, drag-and-drop, coffeescript

玩拖放，虽然我似乎可以很好地拖动，但我似乎无法放下。

这是我的游乐场：http: [//jsfiddle.net/KZ8RD/1/](http://jsfiddle.net/KZ8RD/1/)

基本上，可拖动节点上的`dragstart`and`dragend`事件似乎可以正常触发。但我还没有触发该目标节点上的任何事件。

```
# Source handlers
$('#source')
  .on('dragstart', (e) -> log '#source dragstart', this, e)
  .on('dragend',   (e) -> log '#source dragend',   this, e)

# Target Handlers
$('#cells td')
  .on('dragenter', (e) -> log 'target dragenter',  this, e)
  .on('dragleave', (e) -> log 'target dragleave',  this, e)
  .on('dragover',  (e) -> log 'target dragover',   this, e)
  .on('drop',      (e) -> log 'target drop',       this, e)​​​ 
```

`dragenter`那么触发目标和`drop`事件需要哪些条件呢？我显然错过了其中一些。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-19T22:39:33.483

您已经被 HTML5 可拖动 API 的[众多怪癖](http://www.quirksmode.org/blog/archives/2009/09/the_html5_drag.html)之一所困扰：您需要将一些数据附加到拖动事件，否则它将被潜在的放置目标忽略。解决方法是添加该行

```
e.originalEvent.dataTransfer.setData 'text/html', 'foo' 
```

到`dragstart`事件。（请注意，这`e.dataTransfer`不起作用，因为jQuery`dataTransfer`没有将属性复制到该属性上`e`，至少从 1.7 开始。）您的游乐场的工作分支：http: [//jsfiddle.net/AK2zJ/](http://jsfiddle.net/AK2zJ/)

请注意，这会给您`dragenter`and `dragover`，但不会`drop`... 正如上述文章指出的那样：

> 要完全触发 drop 事件，您必须取消 dragover 和 dragenter 事件的默认设置。

您可以通过`false`从这些事件中的每一个返回来在 jQuery 中执行此操作。这里也是一个修改的例子，允许`drop`事件发生：http: [//jsfiddle.net/YaEBj/](http://jsfiddle.net/YaEBj/)

除了这种笨拙之外，值得一提的是 HTML5 可拖动 API 中存在[严重缺陷](https://stackoverflow.com/questions/11065803/determine-what-is-being-dragged-from-dragenter-dragover-events)。确实，使用它（而不是像 jQuery UI 之类的东西）的唯一充分理由是，如果您想在多个浏览器窗口中启用拖放操作。

# android - Android NDK，没有制定目标的规则

> ID：11570167
> 
> 赞同：12
> 
> 时间：2012-07-19T22:20:05.287
> 
> 标签：android, java-native-interface, android-ndk

我在其他地方看到过这个问题，但答案似乎不适用于我的情况。我有一个 .cpp 文件（不是 .c 文件）。我收到错误：

make: ***没有规则来制作目标`jni/native.c', needed by`obj/local/armeabi/objs/native/native.o'。停止。Cirapi_android C/C++ 问题

这是我的 Android.mk 文件（非常简单）：

```
LOCAL_PATH:=$(call my-dir)
include $(CLEAR_VARS)
LOCAL_LDLIBS:=-llog
LOCAL_MODULE:=native
LOCAL_SRC_FILES:=native.cpp
include $(BUILD_SHARED_LIBRARY) 
```

我已经删除了解决其他问题的所有额外空格。它在抱怨 native.c，我什至没有在我的 makefile 中列出它。有任何想法吗？

我在 MacOSX Snow Leopard、Eclipse Juno、NDK r8

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-20T20:22:24.017

让它工作...不确定密钥是什么...将makefile更改为..

```
TOP_LOCAL_PATH:=$(call my-dir)
include $(call all-subdir-makefiles)
LOCAL_PATH := $(TOP_LOCAL_PATH)  

include $(CLEAR_VARS)
LOCAL_LDLIBS:=-llog
LOCAL_MODULE:=native
LOCAL_SRC_FILES:=native.cpp

include $(BUILD_SHARED_LIBRARY) 
```

...还从 obj 目录中删除了 .o 文件...怀疑清理工作不正常。

# php - 可以在codeigniter中搜索多个单词吗？

> ID：11570168
> 
> 赞同：0
> 
> 时间：2012-07-19T22:20:10.317
> 
> 标签：php, mysql, codeigniter

这是我第一次愿意添加多个搜索。我不确定应该怎么做。我应该在搜索中使用循环每个单词吗？还是那里有任何内置的mysql功能？

我在想它应该是这样的吗？

```
 $strSearch = $this->input->post("search"); // would hold words etc hello word

 $arry = explode(" ", $strSearch);

 foreach($arry as $item){

 $this->db->query("select * from tbl where item like '%$item%');

} 
```

请指教。

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T02:26:18.087

有很多东西要搜索。

重复你的话只是战斗的一小部分。有词序（Mac Office vs. Office Mac），忽略常用词（a，the），词变体如复数。不要忘记权衡和评分您的搜索。

尝试使用 Zend Search Lucene 等已经完成繁重工作的库。请参阅：[http](http://codeigniter.com/forums/viewthread/207865/) ://codeigniter.com/forums/viewthread/207865/或[http://www.cmjackson.net/2009/02/17/how-to-use-zend_search_lucene-with-the-php-framework-codeigniter /](http://www.cmjackson.net/2009/02/17/how-to-use-zend_search_lucene-with-the-php-framework-codeigniter/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T22:08:02.757

它是如何工作的

我拆分单词并循环遍历每个单词以制作一个额外的字符串，然后通过 mysql 查询执行该字符串。它按我想要的方式工作。

```
$strSearch = $this->input->post("search"); // would hold words etc hello word

 $arry = explode(" ", $strSearch);

 foreach($arry as $item){

$xQuery .= " or name like '%$item%' or location like '%item'";

}

$this->db->query("select * from tbl where name like '$strSearch' or location like '$strSearch'  .$xQuery "); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-20T22:23:03.847

您可能会查看 MySQL 自然语言搜索。

[http://dev.mysql.com/doc/refman/5.5/en/fulltext-search.html](http://dev.mysql.com/doc/refman/5.5/en/fulltext-search.html)

# android - 升级的 eclipse 现在得到 main.xml: NotFoundException: null - Saga 继续

> ID：11570171
> 
> 赞同：1
> 
> 时间：2012-07-19T22:20:34.403
> 
> 标签：android, eclipse, sdk

我查找了平板电脑的模拟器，并注意到一个建议，即在检查 eclipse 中的更新时，最新的 SDK/ADT 等将提供此功能。目前我无法检查这一点，因为我的 main.xml 文件出现以下错误。

> 错误！NotFoundException: null 异常详细信息记录在 Window > Show View > Error Log 中找不到以下类： - ToggleButton（更改为 android.widget.ToggleButton，修复构建路径，编辑 XML）

我已经尝试了它提供的三个选项，并且在选择编辑 XML 时似乎没有显示错误。

该项目在 Android 1.6 下运行（希望使其尽可能向后兼容）并尝试应对不同的屏幕尺寸和方向。目前我有以下布局文件夹：

```
layout(empty folder)
layout-large
layout-normal
layout-normal-land
layout-small
layout-xlarge 
```

这些都是在 eclipse/android 更新之前存在的，我从来没有遇到过这些错误。我在网上搜索这些，我阅读了 Project->clean 的一个建议（完成这个），然后我做了 Project->Build。

我还建议删除 r.java 所以我已经完成了这个并运行干净并构建。仍然得到同样的错误。奇怪的是，除了上述消息出现在 XML 的设计器窗口底部之外，代码和 xml 没有显示任何错误迹象。

设计师设置为 1.6 (API4)，所以设计师并不认为我的项目版本与我的项目不同。

更新1：

自从进入 2.1 版以来 - 我发现虽然布局没有立即显示错误，但如果我尝试对其进行任何更改，它就会出现。我还更新了图像，这些图像似乎也没有改变。

更新 2：

feco 提出了将构建目标移至 2.1 的合理建议，因为现在只有一小部分用户使用 1.6 手机。我已决定这样做，这与其说是解决方案，不如说是一种解决方法，但现在必须这样做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T10:54:21.467

我有同样的问题。我通过在“图形布局”窗口->上部菜单->最后的Android徽标（绿色机器人）中从API4更改为API10（或更多）来解决它

# php - 使用条件逻辑：检查记录是否存在；如果是，更新它，如果不是，创建它

> ID：11570172
> 
> 赞同：2
> 
> 时间：2012-07-19T22:20:35.567
> 
> 标签：php, sql, postgresql, concurrency

我昨晚问了这个问题，并获得了有关合并的信息（在 postgresql 中不可用）。我愿意尝试[建议的解决方法](http://www.depesz.com/2012/06/10/why-is-upsert-so-complicated/)但我只是想了解为什么它不能用条件逻辑来完成。

我已经澄清了这个问题，所以也许这会更容易理解。

我有一个将数据插入表的查询。但它每次都在创造新的记录。有没有办法我可以先检查该行是否存在，然后是否存在，`UPDATE`如果不存在`INSERT`？

```
$user = 'username';
$timestamp = date('Y-m-d G:i:s.u');
$check_time = "start"; //can also be stop
$check_type = "start_user"; //can also be stop_user

$insert_query = "INSERT INTO production_order_process_log (
   production_order_id, production_order_process_id, $check_time, $check_type)
VALUES (
 '$production_order_id', '$production_order_process_id', '$timestamp', '$user')"; 
```

这个想法是该表将记录签入和签出值（`production_order_process_log.start`和`production_order_process_log.stop`）。因此，在生成带有签出时间戳的记录之前，查询应该检查是否`$production_order_process_id`已经存在。如果它确实存在，那么时间戳可以进入`stop`并且`$check_type`可以是`stop_user`。否则，他们可以留下`start`来`start_user`。

我基本上是想避免这个结果。

```
+----+---------------------+--------------------------------+--------------------+-------------------+-------------+-------------+
| id | production_order_id |   production_order_process_id  |        start       |        stop       | start_user  |  stop_user  |
+----+---------------------+--------------------------------+--------------------+-------------------+-------------+-------------+
| 8  | 2343                |   1000                         |  12 july 03:23:23  | NULL              | tlh         |  NULL       |
+----+---------------------+--------------------------------+--------------------+-------------------+-------------+-------------+
| 9  | 2343                |   1000                         | NULL               | 12 july 03:45:00  | NULL        |  tlh        |
+----+---------------------+--------------------------------+--------------------+-------------------+-------------+-------------+ 
```

非常感谢您帮助我找出 postgresql 逻辑来完成这项任务。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T23:27:39.453

这个问题和答案会引起您的兴趣：[在 PostgreSQL 中重复更新时插入？](https://stackoverflow.com/questions/1109061/insert-on-duplicate-update-postgresql)

基本上，要么使用两个查询（进行选择，如果找到更新，否则插入），这不是最好的解决方案（同时运行的两个脚本可能会给出重复的插入），或者按照上述问题的建议做 - 制作一个存储过程/功能来做到这一点（这可能是最好的选择，也是最简单的）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-20T00:57:03.410

认识到您的工作流程的性质，订单似乎不能在开始之前或同时停止，对吧？它必须已经开始才能停止，对吧？如果我错了，请纠正我。

因此，您可以检查它是否是启动操作并`INSERT`在这种情况下执行操作，或者停止操作并执行操作`UPDATE`。

我觉得并发在这里并没有真正发挥作用。

# install4j - install4j 是否提供*完全*无人值守的自动更新？

> ID：11570174
> 
> 赞同：3
> 
> 时间：2012-07-19T22:20:37.960
> 
> 标签：install4j

我们目前正在评估 install4j，一切进展顺利，但是我有一个关于自动更新的问题。目前，我看到大约 3 个自动更新选项的选项和文档，而第三个（无版本检查）似乎最接近我们的需要。然而，它听起来好像仍然提示用户实际开始下载/安装。有没有办法解决这个问题？我们将我们的软件作为服务定位在服务器机房中的许多 Windows 盒子上，因此没有用户可以单击继续进行最后一步。我相信我们可以推出我们自己的服务来监控升级，该升级将使用答案文件进行命令行安装以防止提示，但我很想知道我是否错过了一些可以让我利用 install4j 的自动更新的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T09:21:40.447

当您转到安装程序->屏幕和操作时，单击“添加”按钮并选择“添加应用程序”，您可以从许多预定义的模板中进行选择。但是，它们只是模板，添加它们后，您可以完全更改它们。

如果更新程序应该是自动的，但仍显示进度对话框，您只需将更新程序应用程序的“默认执行模式”属性设置为“带有进度对话框的无人参与模式”。在这种情况下，根本不会显示任何屏幕。

![在此处输入图像描述](../Images/e3371b5f0c97a95857cefa42cd9d74b9.png)

# c# - e.Row.findcontrol() 数据绑定后返回 null 但所有数据绑定字段正常工作

> ID：11570176
> 
> 赞同：3
> 
> 时间：2012-07-19T22:20:55.397
> 
> 标签：c#, asp.net, gridview, web-controls

我正在尝试获取一个gridview来填充从数据库调用到我的标签的文本，如图所示结果已经过测试并返回正确的名称

```
protected void Page_Load(object sender, EventArgs e)
{
    DataTable t = DBProductLink.ListWithOptions(ProductId, LinkType, null);
    TestList.DataSource = t ;
    TestList.DataBind();
} 
```

标签是在 Gridview 中创建的，如下所示：

```
<asp:GridView ID="TestList" runat="server" OnRowDataBound="testDataBound" AutoGenerateColumns="false" DataKeyNames="Id">
    <Columns>
        <asp:TemplateField HeaderText="Sizes">
            <asp:ItemTemplate>
                <asp:Label ID="sizeLabel" runat="server" Text='<%# Eval("size") %>' />
            </asp:ItemTemplate>
        </asp:TemplateField>
    </Columns>
</asp:GridView> 
```

然后我尝试遍历gridview并使用ondatarowbound访问标签，但是在此它为空。

```
protected void testDataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType != DataControlRowType.DataRow)
        return;

    Label sizeLabel = e.Row.FindControl("sizeLabel") as Label;
    sizeLabel.Text = "test";
} 
```

我正在使用完全相同的设置，在另一个网格视图上使用 2 个下拉框和 2 个标签，在同一页面上使用不同的名称，但没有这个问题。有人对此有想法吗？另一个Gridview如下：

```
<asp:GridView ID="SearchList" runat="server" AutoGenerateColumns="False"
    DataKeyNames="Id"  OnRowDataBound="SearchList_RowDataBound"
    OnRowCommand="SearchList_RowCommand" Width="100%"  PageSize="20" >
    <Columns>
        <asp:BoundField DataField="Code" HeaderText="Code" SortExpression="Code" />
        <asp:BoundField DataField="Name" HeaderText="Name" SortExpression="Name" />
        <asp:TemplateField HeaderText="Price" SortExpression="Price">
            <ItemTemplate>
                <robo:MoneyLabel ID="MoneyLabel2" runat="server" 
                    Value='<%# Eval("Price") %>' />
            </ItemTemplate>
        </asp:TemplateField>
        <asp:TemplateField HeaderText="Type">
            <ItemTemplate>
                <asp:Label ID="typeLabel" runat="server" Text='<%# Eval("Type") %>' />
                <asp:HiddenField ID="productId" runat="server" Value='<%# Eval("Id") %>' />
                <asp:HiddenField ID="isFabric" runat="server" Value='<%# Eval("IsFabric") %>' />
                <asp:HiddenField ID="isOldWizard" runat="server" Value='<%# Eval("IsOldWizard") %>' />
            </ItemTemplate>
        </asp:TemplateField>
        <asp:TemplateField HeaderText="Options/Color/Size">
            <ItemTemplate>
                <asp:LinkButton runat="server" ID="GetOptions" Text="Get Options" CausesValidation="false" CommandName="Options"  />
                <asp:Label ID="OptionLabel" Visible="false" runat="server" Text="Option: " />
                <asp:DropDownList ID="ProductOptions" runat="server" Visible="false" />
                <asp:Label ID="ColorLabel" Visible="false" runat="server" Text="Color: "  />
                <asp:DropDownList  ID="RibbonColors" runat="server" Visible="false" AutoPostBack="true" />&nbsp;&nbsp;&nbsp;&nbsp;
                <asp:Label ID="SizeLabel" Visible="false" runat="server" Text="Size: " />
                <asp:DropDownList ID="RibbonSizes" runat="server" Visible="false" AutoPostBack="true"  />
            </ItemTemplate>
            <ItemStyle HorizontalAlign="Center" />
        </asp:TemplateField>
        <asp:TemplateField HeaderText="Add">
            <ItemStyle Width="60px" />
            <ItemTemplate>
                <asp:LinkButton ID="LinkButton1" runat="server" Text="Add" CommandName="Add" CommandArgument='<%# Eval("Id") %>' />
            </ItemTemplate>
        </asp:TemplateField>
    </Columns>
</asp:GridView> 
```

.cs 是

```
protected void SearchList_RowDataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType != DataControlRowType.DataRow)
        return;
    int productId = (int)SearchList.DataKeys[e.Row.RowIndex].Value;
    LinkButton GetOptions = e.Row.FindControl("GetOptions") as LinkButton;
    DropDownList RibbonColors = e.Row.FindControl("RibbonColors") as DropDownList;
    DropDownList  RibbonSizes = e.Row.FindControl("RibbonSizes") as DropDownList;
    DropDownList ProductOptions = e.Row.FindControl("ProductOptions") as DropDownList;
    Label typeLabel = e.Row.FindControl("typeLabel") as Label;
    HiddenField isFabric = e.Row.FindControl("isFabric") as HiddenField;
    HiddenField isOldWizard = e.Row.FindControl("isOldWizard") as HiddenField;

    ProductType typeValue = DBConvert.ToEnum<ProductType>(typeLabel.Text);
    bool isFabricValue = Convert.ToBoolean(isFabric.Value.ToString());
    bool isOldWizardValue = Convert.ToBoolean(isOldWizard.Value.ToString());       
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T23:14:39.620

我刚发现问题

你的标记是错误的，这很棘手......我承认

这个标签：`<asp:ItemTemplate>`应该是`<ItemTemplate>`

改变这个：

```
<asp:TemplateField HeaderText="Sizes">
    <asp:ItemTemplate>
         <asp:Label ID="sizeLabel" runat="server" Text='<%# Eval("size") %>' />
    </asp:ItemTemplate>
</asp:TemplateField> 
```

进入

```
<asp:TemplateField HeaderText="Sizes">
    <ItemTemplate>
         <asp:Label ID="sizeLabel" runat="server" Text='<%# Eval("size") %>' />
    </ItemTemplate>
</asp:TemplateField> 
```

这应该引发异常......但相反，`ItemTemplate`被完全忽略了

# asp.net - 看不到设计视图。.aspx 文件的 html 标记中的嵌套双引号“”

> ID：11570182
> 
> 赞同：0
> 
> 时间：2012-07-19T22:21:51.667
> 
> 标签：asp.net, html, markup

当我使用 asp.net 会话变量时，我遇到了这样的代码情况，

```
<input type="hidden" id="hdnAdmin" value="<%=Session["Administrator"]%>"> 
```

一切都适用于应用程序，但是当我想查看这个 aspx 页面的设计视图时，我在哪里收到了这条消息。

![在此处输入图像描述](../Images/15cfb7a89d3d15beebb067650aae2f83.png)

改变`"<>"`以`'<>'`解决问题。
（即`<input type="hidden" id="hdnIsAdministrator" value='<%=Session["isAdministrator"]%>'>`）

但我只是想了解是什么原因造成的。因为对我来说，嵌套的 "" 在其他地方从来都不是问题。

# linux - 如何使用静态链接构建 git？

> ID：11570188
> 
> 赞同：15
> 
> 时间：2012-07-19T22:22:17.490
> 
> 标签：linux, git, build, installation

[我从https://github.com/git/git](https://github.com/git/git)下载了 git 源代码作为 zip 文件。

我将它提取到 /home/Desktop/denis/git （使用 Ubuntu）。

[现在这里](http://www.lyraphase.com/wp/projects/how-to-build-git-for-a-host-with-no-compiler/)的教程说我应该运行

```
./configure --prefix=/home/denis/git-static CFLAGS="${CFLAGS} -static" 
```

从上面提到的文件夹中作为构建 git 的一个步骤。

但是 git 源似乎在它的根文件夹中没有我可以运行的配置文件（只有 configure.ac，我怀疑这不是我想要的）。

我在这里想念什么？如何手动构建 git？

我这样做是因为我试图让 git 在无法安装 git 的共享托管服务器上工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2016-04-28T21:04:08.900

其他答案对我不起作用。也许他们会为别人。对我有用的是：

1.  获取源代码
2.  创建一个目标目录
3.  进入源码目录
4.  配置
5.  建造
6.  安装

使用以下命令：

```
git clone git@github.com:git/git.git
mkdir git-static
cd git
./configure prefix=/path/to/git-static/ CFLAGS="${CFLAGS} -static"
make
make install 
```

这将在目录中留下一些文件夹`git-static`，但可执行文件是静态链接的。它也比平时大得多（可能大 1.5 MB）。

* * *

## 回答 #2

> 赞同：-7
> 
> 时间：2012-07-19T22:28:05.873

阅读解压缩文件根文件夹中的 INSTALL 文件，其中似乎有一些有用的指令，我怀疑：

> 或者，您可以使用 autoconf 生成的 ./configure 脚本来设置安装路径（通过 config.mak.autogen），因此您可以改为编写

```
 $ make configure ;# as yourself
    $ ./configure --prefix=/usr ;# as yourself
    $ make all doc ;# as yourself
    # make install install-doc install-html;# as root 
```

或者只是简单地：

```
 $ make prefix=/usr all doc info ;# as yourself
    # make prefix=/usr install install-doc install-html install-info ;# as root 
```

# php - 自定义内容管理系统 - 不知道如何或何时从包含标记的数据库中转义内容

> ID：11570190
> 
> 赞同：0
> 
> 时间：2012-07-19T22:22:32.557
> 
> 标签：php, mysql, content-management-system

我正在构建一个 php cms，内容将从 mysql 数据库中提取。如何转义具有 HTML 标记的内容，何时应该这样做？

如果只有“受信任的”用户可以添加内容，我只是不确定这对主页内容字段有多大的影响。

非常感谢提前;）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T22:30:35.790

好吧，当您输出数据时，您可能希望在数据上使用 htmlentities() 函数或 strip_tags() 函数。

不过，第一道防线将是您所期望格式的唯一接受日期。例如，如果它是表单中的名称：字段，您将只接受字母、空格、'、- 和更多字符。在检查数据是否格式正确之前，不要将数据添加到数据库中。

网站上的大多数表单字段不需要像 < 和 > 这样的字符，因此不要在未检查其格式是否正确的情况下将数据添加到数据库中。如果您期望像数字 1,2,3,4... 这样的正整数，请不要让脚本继续执行，直到满足这些要求。

# haskell - 调试 GLFW 显示设置

> ID：11570191
> 
> 赞同：3
> 
> 时间：2012-07-19T22:22:34.387
> 
> 标签：haskell, graphics, x11, glut, glfw

在我的[项目](https://github.com/scan/freetrade.hs)中，我想[`GLFW`](http://www.glfw.org/)用于窗口支持。它在我的笔记本电脑和办公室 PC 上运行良好，但我的家用桌面不允许我打开窗口（它们都是 Ubuntu 12.04）。我也尝试过`GLUT`，这至少给了我一条错误消息，但我能发现的只是 X-Server 不支持窗口的设置（带有 的东西`glXChooseFBConfig`）。

但是，我*能够*使用 SDL 打开一个窗口。现在我很好奇为什么 SDL 可以打开 OpenGL 窗口，而 GLUT 和 GLFW 却不能。如何在 Haskell 程序中调试这些图形设置？这甚至有可能弄清楚还是我必须简单地接受它？

我在这个桌面上有很多游戏，并且从来没有遇到过 OpenGL 的任何问题。这里有什么不同？

# c++ - 冒泡排序 链表 C++

> ID：11570193
> 
> 赞同：0
> 
> 时间：2012-07-19T22:22:46.597
> 
> 标签：c++, sorting, linked-list, bubble-sort

我在使用此代码时遇到问题。我很确定它在交换中。

该行：`curr->Data() = nextEl.Data()`给我以下错误：

> “表达式必须是可修改的左值”

任何帮助表示赞赏。先感谢您。这是我的冒泡排序算法的代码：

```
class Node
{
private:
    int data;
    Node* next;
public:
    Node() {};
    void Set(int d) { data = d;};
    void NextNum(Node* n) { next = n;};
    int Data() {return data;};
    Node* Next() {return next;};
};

class LinkedList
{
    Node *head;
public:
    LinkedList() {head = NULL;};
    virtual ~LinkedList() {};
    void Print();
    void AddToTail(int data);
    void SortNodes();
};

void LinkedList::SortNodes() 
{
Node *curr = head;
Node *nextEl = curr ->Next();
Node *temp = NULL;

if(curr == NULL)
    cout <<"There is nothing to sort..."<< endl;
else if(curr -> Next() == NULL)
    cout << curr -> Data() << " - " << "NULL" << endl;
else
{
    for(bool swap = true; swap;)
    {
        swap = false;
        for(curr; curr != NULL; curr = curr ->Next())
        {
            if(curr ->Data() > nextEl ->Data())
            {
                temp = curr ->Data();
                curr ->Data() = nextEl ->Data();          
                nextEl ->Data() = temp;
                swap = true;
            }
            nextEl = nextEl ->Next();
        }
    }
}
curr = head;
do
{
    cout << curr -> Data() << " - ";
    curr = curr -> Next();
}
while ( curr != NULL);
cout <<"NULL"<< endl;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T22:31:19.867

你这样做是不对的。您不能更改函数返回的临时变量的值。

但是你可以让它这样工作..

```
int& Data() {return data;}; 
```

虽然这不是一个好习惯。相反，只需使用您拥有的二传手..

```
curr->Set(nextEl->Data()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T22:27:38.013

该声明

```
curr->Data() = nextEl.Data(); 
```

永远不会工作，你正试图为函数的返回值分配一些东西。我不知道您是如何定义 Node 的，但您的意思可能类似于

```
curr->Data = nextEl.Data(); 
```

即，将某些内容分配给 Node 的成员。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T23:42:14.007

改变

```
curr ->Data() = nextEl ->Data(); 
nextEl ->Data() = temp; 
```

到

```
curr->Set(nextEl ->Data()); 
nextEl->Set(temp); 
```

# php - MySQL 语法错误 >.<

> ID：11570194
> 
> 赞同：-1
> 
> 时间：2012-07-19T22:22:49.563
> 
> 标签：php, mysql, mysql-error-1064

让我们看看是否有人可以在我调试之前回答这个问题。这是我尝试更改的语法问题。我经常犯这个错误，我想一个明确的事实说明我为什么这样做会有所帮助。

提前致谢！

这次的错误：

```
You have an error in your SQL syntax; check the manual that corresponds to your MySQL
server version for the right syntax to use near ' 'Andrew', 'West', '***@gmail.com',
'7*7 **', '', ' at line 14 
```

使用的代码：

```
 $db_insert = mysql_query("INSERT INTO catches (
        catch_affid,
        catch_firstname,
        catch_lastname,
        catch_email,
        catch_street1,
        catch_street2,
        catch_city,
        catch_state,
        catch_postalcode,
        catch_country,
        catch_contactid
    ) VALUES (
        $a,
        '$f',
        '$l',
        '$e',
        '$s1',
        '$s2',
        '$c',
        '$s',
        $p,
        '$cy',
        '$cid'
    )"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T22:26:24.387

没有看到你的字符串操作的实际最终产品（例如真正的查询），我猜你`$a`是空的：

```
 ... ) VALUES (,'Andrew', ...
                 ^---$a being blank 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T22:26:37.067

我猜$a的内容有问题。可能为空？

# javascript - evt.offsetX 在 Safari 上返回 undefined

> ID：11570195
> 
> 赞同：4
> 
> 时间：2012-07-19T22:22:53.210
> 
> 标签：javascript, svg, mobile-safari, touchstart

我正在尝试使用 Javascript 在 SVG 元素上实现拖动/移动操作。我正在使用这样的事件处理程序：

```
function handleMouseDown(evt) {
            currentX = evt.offsetX;
            currentY = evt.offsetY;
            dX = currentX - Number($(evt.srcElement).attr("x"));
            dY = currentY - Number($(evt.srcElement).attr("y"));
            isDragging = true;
            $info.html("mousedown at " + currentX + ", " + currentY); //feedback for debugging
        } 
```

请注意，我已经有代码可以将 mousedown 或 touchstart 指向 handleMouseDown，具体取决于它是否是触摸设备。

在我的桌面上，代码在 IE9、Google 和 Safari 上运行良好。然而，在 iPad 上，在 touchstart 上，反馈显示“mousedown at undefined, undefined”。如果我用 .pageX 和 .pageY 替换 .offsetX 和 .offsetY，那么我会得到实际坐标。因此，Safari Mobile 似乎不处理 .offsetX 和 .offsetY，但它确实处理了 .pageX 和 .pageY。

我知道我可以使用源元素 position.left 属性从 pageX 计算 .offsetX ，但如果可能的话，我想避免这种情况。所以我的问题是：我的代码或方法是否有问题，或者 .offsetX 没有在 Safari Mobile 中处理。

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-06T09:56:35.597

在元素上使用 jQuery 的`.on`函数绑定事件处理程序时遇到了类似的问题`canvas`（不知道原因）。

我通过使用绑定事件处理程序解决了它`addEventListener`。处理程序中的`event`对象具有使用适当值定义的 offsetX 和 offsetY。

希望能帮助到你...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T08:59:40.830

您可以使用`clientX`and`clientY`代替。

# python - Python:Get the name of a variable

> ID：11570196
> 
> 赞同：1
> 
> 时间：2012-07-19T22:22:53.013
> 
> 标签：python

I declare a variable, say:

```
var=33 
```

I want to assign to another variable the string 'var', that is , how to get the symbol's name of the value of the variable.

How can I do it ?

* * *

I reformulate the question.

```
WHITE=0
RED=1
BLACK=2 
```

X=2.

I want to assign the value 'BLACK' to a variable, say, Y, taking into account that X=2.

It is hard to formulate exactly this question.

I want to avoid a code like this:

```
color=''
if X==0:
     color='WHITE'
elif X==1:
etc. 
```

Is it possible to get the name of the color-variable as a string?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-19T22:25:22.743

> I want to assign to another variable the string 'var', that is , how to get the symbol's name of a variable.

No, you don't want to do that. Use a dict:

```
mydata = {}
varname = 'var'
mydata[varname] = 33 
```

Technically, you could use the `dict` from `globals()` or `locals()` to store this, and it would be available as a "real variable", but really, there's no good reason to do that, it will make your code much more difficult to understand.

The way to avoid the code you give:

```
color=''
if X==0:
     color='WHITE'
elif X==1:
etc. 
```

Is with:

```
COLORS = ('WHITE', 'RED', 'BLACK')
x = 2
try:
    color = COLORS[x]
except IndexError:
    color = 'DEFAULT COLOR' 
```

This eliminates sequential ifs, and maintenance beyond expanding `COLORS`. You could also do:

```
COLORS = {0: 'WHITE', 1: 'RED', 2: 'BLACK'}
x = 2
color = COLORS.get(x, 'DEFAULT COLOR') 
```

But that requires manual management of the indices (keys) also.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T22:40:03.937

```
colors = {0:"WHITE", 1:"RED", 2:"BLACK"}
X=2
print colors[X] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T22:45:19.073

If you absolutely, positively, MUST have it:

```
x = 2
n = locals()
n['x'] # 2 
```

# c# - 在 Visual Studio 2010 Ultimate 中自动化测试（使用 TFS）

> ID：11570199
> 
> 赞同：1
> 
> 时间：2012-07-19T22:23:29.170
> 
> 标签：c#, visual-studio-2010, testing, automated-tests

我有一系列使用 Visual Studio 2010 Ultimate 创建的 Web 测试，每个测试都运行良好，但现在我需要这些测试每周自动运行一次。

我已经读过“有一种可能的方法可以通过 TFS 来实现”，但我什至无法在 TFS 上加载一个测试......

如果有人可以分享“嘿，这应该怎么做”的链接，我会全力以赴

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T19:33:29.180

如果您有可用的 TFS（您不清楚），那么您可以使用调度来设置这些类型的自动运行。MSDN 上有一篇[很好的文章展示了如何做到这一点](http://msdn.microsoft.com/en-us/library/ms182465)。

如果您没有 TFS，那么您可以使用调度程序作业通过命令行（ [MSDN 文章）运行测试。](http://msdn.microsoft.com/en-us/library/ms182486)

不过，更好的解决方案是使用 Hudson/Jenkins、Team City 或其他一些免费/便宜的构建服务器。每种方法的实现（操作方法）各不相同，但有很多人使用 Team City，而且设置起来相当简单。（小型团队也免费。）

# installation - NSIS 将 int 转换为十六进制字符串

> ID：11570200
> 
> 赞同：1
> 
> 时间：2012-07-19T22:23:35.853
> 
> 标签：installation, nsis

我有一个运行外部程序的 NSIS 脚本，该程序返回 C++ 类型 HRESULT（无符号 int32），并且 NSIS 使用此值作为有符号 int32 运行。而且我需要花时间正确转换价值。

有没有简单的方法在 NSIS 脚本中自动执行此操作？

更新：解决方案是使用这样的 NSIS 命令转换值 IntFmt $0 "0x%X" $0

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T22:37:53.460

NSIS 变量是字符串，但在需要时它们会在内部转换为数字。

您可以使用[`IntCmpU`](http://anders_k.users.sourceforge.net/public/NSIS/2.46/Manual.html#intcmpu)($0 U>= $1 etc in LogicLib 语法) 来比较无符号数字并`IntFmt`以您喜欢的任何方式格式化数字...

..和 HRESULT 应被视为已签名；<0 表示错误，0=S_OK 和 >0 表示 S_FALSE 和计数。

# ruby-on-rails - Capistrano 部署超时

> ID：11570209
> 
> 赞同：13
> 
> 时间：2012-07-19T22:24:39.843
> 
> 标签：ruby-on-rails, ruby, capistrano

好吧，所以，我在网上四处查看，看起来并没有很多其他人有这个问题，但也许我们正在做的事情有其他问题。

我已经设法将其提炼成我认为有用的测试用例：

配置/部署.rb：

```
## Excerpt
task :big_delay, :roles => :web do
  run "sleep 480"
  run "echo Meow Meow Meow"
end 
```

还有愚蠢的脚本.sh：

```
#!/bin/sh
ssh foo 'sleep 480; echo Meow Meow Meow' 
```

其中 foo 是我们部署到的同一服务器的名称。

当我运行这两个时，它应该连接到另一个框，8 分钟内什么都不做，然后吐出一些无用的文本并完成。

愚蠢的脚本有效，上限任务失败。我看到远程命令以 ps xf 结束，但 cap 似乎不再注意到了。如果 sleep 是 20 而不是 240，则 cap 任务可以正常工作。

显然这个任务是超级没用的，但我们确实在部署时运行了昂贵的东西来触发这个，我已经这样做了，以排除对 ssh 的任何指责。

另一个数据点，如果我们 ssh 进入盒子并将代码放在那里，然后从那里运行 cap deploy，那么它工作正常。

所以......似乎在 ssh 和 capistrano 之间发生了一些奇怪的相互作用。想法？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-03T16:12:08.197

按照 choover 的建议，在服务器上的 /etc/ssh/sshd_config 中设置 ClientAliveInterval 和 ClientAliveCountMax。在我进行更改之前，我在部署时遇到了与“assets:precompile”完全相同的问题。

# ruby-on-rails - 处理来自网络抓取的无效字符

> ID：11570211
> 
> 赞同：0
> 
> 时间：2012-07-19T22:24:48.640
> 
> 标签：ruby-on-rails, ruby, web-scraping, mechanize

我编写了一个网络爬虫，使用 Nokigiri 和 Mechanize 从网站中提取大量信息，它会输出数据库种子文件。不幸的是，我发现源网站上的文本中有很多无效字符，例如`keppnisÃ¦find`和`ScÃ©mario`，`KlÃ¤tiring`这会阻止种子文件运行。种子文件太大，无法进行搜索和替换，那么我该如何处理这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T23:04:11.757

这些几乎可以肯定是 UTF-8 字符；这些词应该看起来像keppnisæfind、Scémario 和Klätiring。有问题的网站可能正在发送 UTF-8，但没有将其声明为编码，在这种情况下，您将不得不强制 Mechanize 对没有声明编码的网站使用 UTF-8。但是，如果您遇到没有声明编码的其他网站并且它们发送除 UTF-8 之外的其他内容，这可能会使事情复杂化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T22:28:13.067

我认为这些是 html 字符，您需要做的就是编写可以清除字符的函数。这取决于编程平台

# java - 带参数的泛型方法与带通配符的非泛型方法

> ID：11570215
> 
> 赞同：18
> 
> 时间：2012-07-19T22:24:59.980
> 
> 标签：java, generics

根据[Java Generics FAQ 中的这个条目，在](http://www.angelikalanger.com/GenericsFAQ/FAQSections/ProgrammingIdioms.html#FAQ302B)某些情况下，泛型方法没有使用通配符类型的等效非泛型方法。根据那个答案，

> 如果方法签名使用多级通配符类型，则通用方法签名和通配符版本之间总是存在差异。

他们给出了一个方法的例子`<T> void print1( List <Box<T>> list)`，它“需要一个相同类型的盒子列表”。通配符版本，`void print2( List <Box<?>> list)`“接受不同类型的盒子的异构列表”，因此不等效。

您如何解释以下两个方法签名之间的差异：

```
 <T extends Iterable<?>> void f(Class<T> x) {}
                         void g(Class<? extends Iterable<?>> x) {} 
```

直觉上，这些定义似乎应该是等价的。但是，调用`f(ArrayList.class)`使用第一种方法进行编译，但`g(ArrayList.class)`使用第二种方法的调用会导致编译时错误：

```
g(java.lang.Class<? extends java.lang.Iterable<?>>) in Test
    cannot be applied to (java.lang.Class<java.util.ArrayList>) 
```

有趣的是，这两个函数都可以用彼此的参数调用，因为以下编译：

```
class Test {
    <T extends Iterable<?>> void f(Class<T> x) {
        g(x);
    }
    void g(Class<? extends Iterable<?>> x) {
        f(x);
    }
} 
```

使用`javap -verbose Test`，我可以看到它`f()`具有通用签名

```
<T::Ljava/lang/Iterable<*>;>(Ljava/lang/Class<TT;>;)V; 
```

并`g()`具有通用签名

```
(Ljava/lang/Class<+Ljava/lang/Iterable<*>;>;)V; 
```

什么解释了这种行为？我应该如何解释这些方法的签名之间的差异？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-20T21:42:18.377

好吧，按照规范，这两种调用都不合法。但是为什么第一个类型检查而第二个没有呢？

不同之处在于如何检查方法的适用性（特别是参见[§15.12.2](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.12.2)和[§15.12.2.2](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.12.2.2)）。

*   要使简单的非泛型`g`适用，参数`Class<ArrayList>`需要是`Class<? extends Iterable<?>>`. 这意味着`? extends Iterable<?>`需要[包含](http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html#jls-4.5.1-400) `ArrayList`，书面`ArrayList <= ? extends Iterable<?>`。规则[4](http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html#jls-4.5.1-400-D)和[1](http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html#jls-4.5.1-400-A)可以传递应用，因此`ArrayList`需要是`Iterable<?>`.

    [按照 §4.10.2](http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html#jls-4.10.2)，任何参数化`C<...>`都是 raw type 的（直接）子类型`C`。`ArrayList<?>`的子类型也是如此`ArrayList`，但反之则不然。传递地，`ArrayList`不是 的子类型`Iterable<?>`。

    因此`g`不适用。

*   `f`是通用的，为简单起见，我们假设类型参数`ArrayList`是明确指定的。要测试`f`适用性，`Class<ArrayList>`需要是`Class<T> [T=ArrayList] = Class<ArrayList>`. 由于子类型是[反身](http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html#jls-4.10-110)的，这是真的。

    同样为了`f`适用，类型参数需要[在其范围内](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.12.2.2-110-B)。这不是因为，正如我们上面所展示的，`ArrayList`它不是`Iterable<?>`.

**那么为什么它仍然编译呢？**

这是一个错误。在[错误报告](https://bugs.eclipse.org/bugs/show_bug.cgi?id=127583#c2)和[后续修复之后](http://git.eclipse.org/c/jdt/eclipse.jdt.core.git/commit/org.eclipse.jdt.core/compiler/org/eclipse/jdt/internal/compiler/lookup/TypeBinding.java?id=a25cead90931bbc9548552bec95aa6f79a389aa3)，JDT 编译器明确排除了第一种情况（类型参数包含）。第二种情况仍然被忽略，因为 JDT 认为`ArrayList`是`Iterable<?>`( `TypeBinding.isCompatibleWith(TypeBinding)`) 的子类型。

我不知道为什么 javac 的行为相同，但我假设出于类似的原因。`ArrayList`您会注意到 javac 在将 raw 分配给any 时不会发出未经检查的警告`Iterable<?>`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-20T02:52:18.803

如果类型参数是通配符参数化类型，则不会出现问题：

```
Class<ArrayList<?>> foo = null;
f(foo);
g(foo); 
```

我认为这几乎可以肯定是一个奇怪的情况，因为类文字的类型是`Class<ArrayList>`，所以这种情况下的类型参数 ( ) 是原始类型，原始和通配符参数化`ArrayList`之间的子类型关系很复杂.`ArrayList``ArrayList<?>`

我没有仔细阅读语言规范，所以我不确定为什么子类型在显式类型参数情况下有效，但在通配符情况下无效。它也很可能是一个错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T23:07:55.690

猜：代表第一个的东西？(ArrayList) 不“实现” `ArrayList<E>`（通过双嵌套通配符）。我知道这听起来很有趣，但是......

考虑（对于原始列表）：

```
 void g(Class<? extends Iterable<Object> x) {} // Fail
 void g(Class<? extends Iterable<?> x) {}  // Fail
 void g(Class<? extends Iterable x) {}  // OK 
```

和

```
// Compiles
public class Test{
    <T extends Iterable<?>> void f(ArrayList<T> x) {}
    void g(ArrayList<? extends Iterable<?>> x) {}

    void d(){
        ArrayList<ArrayList<Integer>> d = new ArrayList<ArrayList<Integer>>();
        f(d);
        g(d);
    }
} 
```

这

```
// Does not compile on g(d)
public class Test{
    <T extends Iterable<?>> void f(ArrayList<T> x) {}
    void g(ArrayList<? extends Iterable<?>> x) {}

    void d(){
        ArrayList<ArrayList> d = new ArrayList<ArrayList>();
        f(d);
        g(d);
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-20T03:08:16.830

这些并不完全相同：

```
<T extends Iterable<?>> void f(Class<T> x) {}
void g(Class<? extends Iterable<?>> x) {} 
```

不同之处在于`g`接受“实现未知的 Iterable 的未知类”，但`ArrayList<T>`受限于实现`Iterable<T>`, not `Iterable<?>`，因此不匹配。

为了更清楚，`g`会接受`Foo implements Iterable<?>`，但不会`AraryList<T> implements Iterable<T>`。

# excel - Excel 2010 中的条件最小值和最大值

> ID：11570223
> 
> 赞同：6
> 
> 时间：2012-07-19T22:25:58.910
> 
> 标签：excel

![在此处输入图像描述](../Images/dc1edbc7dd90180a42bc39ee0df643ea.png)

我想根据类型（第 1 列）找到数量的最小值和最大值（第 2 列），是否可以这样做？

我试过这个，但结果出乎意料 [类似的问题](https://stackoverflow.com/questions/10746792/excel-find-min-max-date-in-a-range-if-it-matches-criteria-of-other-columns)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-19T22:39:10.833

假设您上面的数据在 A2:B13 中，这有效：

```
=MAX(IF(A2:A13="A",1,0)*(B2:B13))
=MAX(IF(A2:A13="B",1,0)*(B2:B13))
=MAX(IF(A2:A13="C",1,0)*(B2:B13)) 
```

将公式输入单元格时，必须按 ctrl+shft+Enter。这将查找所有带有 、 或 的行，`A`如果`B`该字母与您的公式匹配，则与它旁边的值`C`相乘，如果它不匹配。然后你取的值。`1``0``MAX()`

<<< 编辑 >>>

正如@GSerg 建议的那样，如果在将它们输入每​​个单元格时按 ctrl+shft+Enter ，您也可以使用这些公式：

```
=MAX(IF(A:A="A",B:B))
=MAX(IF(A:A="B",B:B))
=MAX(IF(A:A="C",B:B)) 
```

一种更优雅的方式！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-12-13T06:50:34.540

除了数据透视表（如@andy holaday 所建议的那样）之外的任何东西似乎都是纯粹的受虐狂（除非出于非常好的但可能非常特殊的原因）：

[![SO11570223 示例](../Images/10e7a410f167c309598a4f874549d21c.png)](https://i.stack.imgur.com/nHBNS.jpg)

请注意，为了说明起见，我将 OP 的数据量翻了一番，`B`然后又将`C`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-08-12T17:13:10.483

@JamesL 的解决方案在尝试时对我来说总是为零

=MIN(IF(A2:A13="A",1,0)*(B2:B13))

如果我为错误结果设置了一个任意大的数字，那么它就起作用了

=MIN(IF(A2:A13="A",1,99999)*(B2:B13))

但是，@GSerg 的优雅解决方案也适用于最小值：

=MIN(IF(A:A="A",B:B))

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-07T16:55:50.147

一个相当偷偷摸摸但简单的方法是
1\. 创建一个连接 Type 和 Qty 的新列，并将其命名为“TypeQty”或任何你想要的
2\. 对新表进行排序（升序），即 Type、Qty 和 TypeQty 全部在一起，但按 TypeQty 列排序。
3\. 应用一个公式来检查上面行中的类型是否与当前行相同。如果不是，则标记该行，因为它是当前类型的最后一个。

您最终会得到“标记”，只有每种类型的最大行数。查看屏幕截图

[![在此处输入图像描述](../Images/42978ebb7d5c49537c3221c1eed28fa1.png)](https://i.stack.imgur.com/ufrJf.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-12T04:52:02.220

这在没有 ctrl+shift+enter 的情况下有效，但您的表应按 TYPE 列排序。

假设你的桌子放在 B3:C15，然后放在 A4

```
=IF(B4=B3;A3;A3+1) 
```

在 E4 - “1”，在 E5 - “2”，在 E6 - “3”，在 F4 中输入：

```
=MAX(INDIRECT("C" & MATCH(E4;$A$1:$A$17;0) & ":C" & MATCH(E4;$A$1:$A$17;1) )) 
```

并将其复制到 F5 和 F6

在 G4 中：

```
=MIN(INDIRECT("C" & MATCH(E4;$A$1:$A$17;0) & ":C" & MATCH(E4;$A$1:$A$17;1) )) 
```

并将其复制到 G5 和 G6

[![在此处输入图像描述](../Images/e1e5735e645c6bf22c23bebc2407b78c.png)](https://i.stack.imgur.com/IhqpG.png)

MATCH 函数处理字符串不正确，所以我必须对 TYPE 进行编号，您可以使用 VLOOKUP 将 E 列中的数字更改为字符串

在我的表中，我使用此解决方案以这种方式查找具有最大值的字符串：

[![在此处输入图像描述](../Images/678b9c0cd88c6caac628195fd0fb672b.png)](https://i.stack.imgur.com/KAPMR.png)

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2016-01-08T14:13:34.563

我建议使用`=large(if(...=...;...);k)`来解决这个问题。

# grails - Grails where 查询条件限定

> ID：11570227
> 
> 赞同：3
> 
> 时间：2012-07-19T22:26:15.863
> 
> 标签：grails, grails-orm

有没有办法在 Grails 中限定方法参数与域属性，*其中*查询条件名称相同？

例如：

```
def getPeople(age, sex) {
    People.find { age == age && sex == sex }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T23:18:55.907

像这样的东西！？

```
def getPeople(age, sex) {
    People.find { delegate.age == age && delegate.sex == sex }
} 
```

# php - 将 cakephp 的 auth 与 hybridauth (oauth) 相结合

> ID：11570228
> 
> 赞同：2
> 
> 时间：2012-07-19T22:26:17.540
> 
> 标签：php, session, cakephp, oauth, hybridauth

我想我只是在寻找一些关于如何使用 cakephp 2.0 在我的网站上设置我的用户 + 身份验证区域的指导。

我在我的 UserController.php 中设置了基本的登录和注册功能，其中还包含用于查找和显示其他用户的功​​能。

我还想使用 hybridauth 插件来允许用户使用他们的社交媒体/oauth 帐户登录/注册（允许数据库中每个用户拥有多个社交帐户，以便同一用户可以使用他们的 twitter 或 facebook 详细信息， 例如）。我目前只有 3 个提供者，所以我计划在我的用户数据库中创建 6 列，令牌和隐藏在同一用户行中。这是在另一个控制器中 - HybridauthController.php。

我设置了混合身份验证，以便它从帐户详细信息创建其“混合身份”对象，这很好 - 但我希望能够将整个“身份验证”合并在一起，以便我的 cakephp 会话包含混合身份验证会话数据（ object）创建我可以使用的通用“当前用户”数组，并在其中设置一些通用变量，具体取决于它们是否来自 oauth。

我目前没有将会话存储在数据库中，理想情况下，我希望允许所有人使用持久会话，无论他们是否使用 oauth 帐户。我真的不明白持久会话应该如何与混合身份验证一起工作，因为在这个例子中，当用户第二天返回时，$current_user_id 将如何填写？不是通过cookie，确定吗？

[http://hybridauth.sourceforge.net/userguide/HybridAuth_Sessions.html](http://hybridauth.sourceforge.net/userguide/HybridAuth_Sessions.html)

因此，总而言之，我正在寻找一种简单的解决方案，将我的所有“会话”/“身份验证”/“用户”数据组合到用户会话中的一个简单数组中。希望这一切都说得通！

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T23:38:58.117

迟到回答，但希望它会帮助你或其他人搜索。

我很难将 HybridAuth 集成到已经使用 Cake Sessions 和 Auth 组件的现有 CakePHP (1.3) 应用程序中。我最初尝试使用从 HybridAuth 网站下载的 Cake 示例，但这对我不起作用。

我们预先存在的用户控制器已经有一堆逻辑，包括一个`beforeFilter`方法。这就是我`session_start()`在 HybridAuth Cake 示例中的类声明上方插入我的地方：

```
class UsersController extends AppController {
    ...
    var $components = array('Session','Auth','Email');
    ...
    public function beforeFilter(){
        // following two lines may not be necessary for your setup
        $this->Auth->allow('oauth', 'oauthLogout');
        $excludeBeforeFilter = array('oauth', 'oauthLogout');
        if ( ! in_array($this->action, $excludeBeforeFilter) ) {
            // preexisting Auth logic -- I had to bypass it because
            // calling `session_start` was messing up Cake's Auth
            ...
        } else {
            /* THIS IS NECCESSARY FOR HYBRIDAUTH (OAUTH) */
            /* setting the session ID made it so users could NOT log
               in from a 3rd party and our site */
            session_id($_COOKIE['CAKEPHP']);
            session_start();
        }
    }

    ...

    public function oauth($provider){
        $this->autoRender = false;
        // include HybridAuth
        require_once( WWW_ROOT . 'hybridauth/Hybrid/Auth.php' );

        try {
            // I stored my provider config in a Cake config file
            // It's essentially a copy from the site/Cake example
            $hybridAuth  = new Hybrid_Auth(Configure::read('HAuth.config'));
            $adapter     = $hybridAuth->authenticate($provider);
            $userProfile = $adapter->getUserProfile();

            // method on the User model to find or create the 3rd party user
            $user        = $this->User->findOrCreate($userProfile, $provider);

            if ( ! $user ) {
                echo 'Unable to find/create user';
            } else {
                // configure your fields as necessary
                $this->Auth->fields = array(...);
                $this->Auth->login($user);
            }
        } catch (Exception $e) {
            echo $e->getMessage();
        }
    }
} 
```

此时，可以在 Auth 组件中访问第 3 方 (HybridAuth) 用户。这样，用户只登录了一个第 3 方服务或预先存在的登录（但不能同时登录）。

我也有注销的问题。为此，为了安全起见，我基本上销毁了所有会话/cookie。在`oauthLogout`方法中`UsersController`：

```
// probably overkill/paranoia
$this->Auth->logout();
$this->Session->destroy();
session_destroy($_COOKIE['CAKEPHP']);
/* these two seemed to make the difference 
   especially the 4th parameter */
setcookie( 'PHPSESSID', '', 1, '/' ); 
setcookie( 'CAKEPHP', '', 1, '/' ); 
```

看起来超级hacky - 对不起。希望它有所帮助！

# javascript - JavaScript 从开始日期计算年数和天数

> ID：11570232
> 
> 赞同：0
> 
> 时间：2012-07-19T22:26:36.510
> 
> 标签：javascript, date, leap-year

我有某人出生的日期，我需要用 JavaScript 或 jQuery 左右计算，从出生日期到现在有多少年、多少天。

所以结果可能是 20 年 89 天。

我需要与维基百科的“年龄”功能相同的结果，因为它需要考虑闰年而不是什么。到目前为止，我得到了有效的代码，但在某些情况下会犯 1 天的错误。我的功能是：

```
function DateDiff(date1, date2){
var res=((date1.getTime() - date2.getTime())/1000/60/60/24)-offset_d;
var full_days=Math.floor(res/365.25);
var f1=Math.round((res%365.25))
return  full_days + " years, " +f1 +  " days" ; } 
```

感谢您的帮助，我已经这样做了好几天了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T00:55:54.137

不久前我写了以下内容，您应该可以对其进行调整以完成这项工作：

```
// Given a date object, calcualte the number of
// days in the month
function daysInMonth(x) {
  var d = new Date(x);
  d.setDate(1);
  d.setMonth(d.getMonth() + 1);
  d.setDate(0);
  return d.getDate();
}

/* For person born on birthDate, return their 
** age on datumDate.
**
** Don't modify original date objects
**
** tDate is used as adding and subtracting
** years, months and days from dates on 29 February 
** can affect the outcome, 
**
** e.g.
**
** 2000-02-29 + 1 year => 2001-03-01
** 2001-03-01 - 1 year => 2000-03-01 so not symetric
**
** Note: in some systems, a person born on 29-Feb
** will have an official birthday on 28-Feb, other 
** systems will have official birthday on 01-Mar.
*/
function getAge(birthDate, datumDate) {

  // Make sure birthDate is before datumDate
  if (birthDate - datumDate > 0) return null;

  var dob = new Date(+birthDate),
      now = new Date(+datumDate),
      tDate = new Date(+dob),
      dobY = dob.getFullYear(),
      nowY = now.getFullYear(),
      years, months, days;

  // Initial estimate of years
  years = nowY - dobY;
  dobY = (dobY + years);
  tDate.setYear(dobY);

  // Correct if too many
  if (now < tDate) {
    --years;
    --dobY;
  }
  dob.setYear(dobY);

  // Repair tDate
  tDate = new Date(+dob);

  // Initial month estimate
  months = now.getMonth() - tDate.getMonth();

  // Adjust if needed
  if (months < 0) {
    months = 12 + months;

  } else if (months == 0 && tDate.getDate() > now.getDate()) {
    months = 11;
  }
  tDate.setMonth(tDate.getMonth() + months);

  if (now < tDate) {
    --months;
    dob.setMonth(tDate.getMonth() - 1); 
  }

  // Repair tDate
  tDate = new Date(+dob);

  // Initial day estimate
  days = now.getDate() - tDate.getDate();

  // Adjust if needed 
  if (days < 0) {
    days = days + daysInMonth(tDate);
  }
  dob.setDate(dob.getDate() + days);

  if (now < dob) {
    --days;
  }

  return years + 'y ' + months + 'm ' + days + 'd';
}

function parseDMY(s) {
  var b = s.split(/\D/);
  var d = new Date(b[2], --b[1], b[0]);
  return d && d.getMonth() == b[1]? d : new Date(NaN); 
}

window.onload = function() {
  var form = document.forms['ageCalc'];
  form.onsubmit = function() {
    var dob = parseDMY(form.dob.value);
    form.age.value = isNaN(dob)? 'Invalid date' : getAge(dob, new Date());
    return false;
  }
}
```

```
<form id="ageCalc">
<table>
  <tr>
    <td>Date of Birth (d/m/y)
    <td><input name="dob">
  <tr>
    <td>Age today (y, m, d)
    <td><input readonly name="age">
  <tr>
    <td><input type="reset">
    <td><input type="submit" value="Calculate Age">
</table>
</form>
```

这是一个直接的年份和日期版本：

```
function diffInYearsAndDays(startDate, endDate) {

  // Copy and normalise dates
  var d0 = new Date(startDate);
  d0.setHours(12,0,0,0);
  var d1 = new Date(endDate);
  d1.setHours(12,0,0,0);

  // Make d0 earlier date
  // Can remember a sign here to make -ve if swapped
  if (d0 > d1) {
    var t = d0;
    d0 = d1;
    d1 = t;
  }  

  // Initial estimate of years
  var dY = d1.getFullYear() - d0.getFullYear();

  // Modify start date
  d0.setYear(d0.getFullYear() + dY);

  // Adjust if required
  if (d0 > d1) {
    d0.setYear(d0.getFullYear() - 1);
    --dY;
  }

  // Get remaining difference in days
  var dD = (d1 - d0) / 8.64e7;

  // If sign required, deal with it here
  return [dY, dD];  
}

alert(diffInYearsAndDays(new Date(1957, 11, 4), new Date(2012, 11, 2))); // [54, 364] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T22:31:51.757

你可以自己动手……但我强烈推荐[Moment.js 之](http://momentjs.com/)类的东西。它是一个可靠的库，已在该领域证明可以像这样计算数学。它只有 4k，所以我认为你的尺寸也可以。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-23T01:52:34.843

最终解决方案与任何库无关，而是与逻辑有关。我将开始年龄小时和分钟设置为与当天的小时和分钟相同。然后我继续增加 12 个月，直到一年结束。那是为了计算整年。然后，我将不超过当前日期的最后一个“生日”设置为获取和使用标准日期差异的信息，以针对该日期和当前日期的天数。

它起到了魅力的作用。

感谢大家的大力帮助。它帮助我专注于主题。

# php - 将复杂的 SQL 语句转换为 PDO

> ID：11570237
> 
> 赞同：0
> 
> 时间：2012-07-19T22:26:59.277
> 
> 标签：php, mysql, sql, pdo

我有以下 sql 语句，它运行良好，因为我将所有内容都转移到 PDO，所以我在尝试转换这个复杂的语句时遇到了最糟糕的时间。它在下面工作：

```
$sql_res=mysql_query("SELECT a.first_name, a.last_name, a.uid, a.hometown, 
IF(b.friend_two IS NULL, 0, 1) AS isFriend FROM users a LEFT JOIN friends 
b ON a.uid = b.friend_two AND b.friend_one = $uid WHERE  
CONCAT(a.first_name, ' ', a.last_name) LIKE '%$q%' AND a.uid <> $uid 
ORDER BY isFriend DESC"); 
```

我已经尝试了几个小时来转换，这就是我可以从另一个 SO 示例中得到的全部内容（它甚至还没有接近工作）

非常感谢任何帮助。哦，还有 $q 是来自用户的 POST 变量，所以在我的情况下，PDO 是必须的。

更新代码（第二次）：

```
$sql = "select a.first_name, a.last_name, a.uid, a.hometown, 
IF(b.friend_two IS NULL, 0, 1) AS isFriend FROM users a LEFT JOIN 
friends b ON a.uid = b.friend_two AND b.friend_one = :friend_one 
where ( first_name like concat('%', :fname, '%') or last_name like 
concat('%', :lname, '%') ) and a.uid <> :uid ORDER BY isFriend DESC"; 
$stmt= $db->prepare($sql); $stmt->bindValue(':fname', "%$q%", PDO::PARAM_STR); 
$stmt->bindValue(':lname', "%$q%", PDO::PARAM_STR); 
$stmt->execute(array(':friend_one' => $uid,':uid' => $uid)); 
```

**这可以正常工作，但无法产生与原始 sql 语句相同的结果。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T22:40:01.483

删除了额外的`from`并放在`()`你的名字过滤器周围，如
`A OR B AND C`= `A OR (B AND C)`，我猜你想要`(A OR) B AND C`

```
select
  a.first_name,
  a.last_name,
  a.uid,
  a.hometown,
  IF(b.friend_two IS NULL, 0, 1) AS isFriend 
FROM users a 
LEFT JOIN friends b
  ON a.uid = b.friend_two AND b.friend_one = :uid
where 
  (
    first_name like concat('%', :fname, '%') or 
    last_name  like concat('%', :lname, '%') 
  ) and
  a.uid <> :uid 
ORDER BY
  isFriend DESC 
```

# php - json 编码数组中的条件语句

> ID：11570239
> 
> 赞同：2
> 
> 时间：2012-07-19T22:27:06.927
> 
> 标签：php, callback, json, conditional-statements

我正在显示页面的“查看您的订单：”部分，其中包含 json_encode 数组的成功回调。我可能在技术方面说完全错误，但希望你能看到我想要做什么。

PHP处理页面的一部分...

```
 $results = array(
 'roomname' => $_POST['roomX'],
 'qty' => $_POST['qtyX'], 
```

我希望结果返回为......

房间名称：无论返回什么。（注意标签“房间名称：”）

但我只希望标签显示 POST 是否已分配值。

我认为它应该看起来如何但它不起作用的示例..

```
 $results = array(
 'roomname' => if (!$_POST['roomX']=='' { echo 'Room Name: ' .$_POST['roomX'];}, 
```

那有意义吗？每个订单有几十个选项，我不希望在一堆空值前面出现“标签：”。

**编辑：从下面的答案中添加了代码。**

```
// beginning of array
$results = array(
'roomname' => $_POST['roomX'],
'qty' => $_POST['qtyX'],
// more code...
// end of array.. remember not to have a comma on this last one.
);

// pasted answer between the array ending and the json_encode line.
if ($_POST['roomX'] != ''){
$results['roomname'] = "Room Name: ".$_POST['roomX'];
}

$json = json_encode($results);
echo $json; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T22:29:10.113

这是一种方法，您可以使用[三元运算](http://en.wikipedia.org/wiki/Ternary_operation)

```
$results = array(
 'roomname' => $_POST['roomX']==''? 'Room Name: '.$_POST['roomX']: '',
 ); 
```

如果值为空，这将添加一个空白字符串

另一种方法是稍后添加值；

```
$results = array(...);

if ($_POST['roomX'] != ''){
$results['roomname'] = $_POST['roomX']
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T22:31:29.343

您可以在将任何数据分配给 roomname 之前进行 if 语句，如下所示

```
$result = array( 
    'roomname' => ($_POST['roomX'] !== '')? 'Room name: '.$_POST['roomX']:''
); 
```

我在这里使用的是一个缩短的 if 语句，其工作方式如下：（if 语句）？真假;

我希望这能帮到您。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T22:34:27.477

```
$results = array();
if (isset($_POST['roomX'])) {
   $results[] = array(...);
} 
```

如果没有 post 值，你只会得到一个空数组。

# events - 使用来自 Schema.org 的微数据的 MusicEvent 的正确格式

> ID：11570241
> 
> 赞同：1
> 
> 时间：2012-07-19T22:27:16.973
> 
> 标签：events, schema.org

我对如何使用 schema.org 中的模式正确格式化 MusicEvent 感到有点困惑。事实上，我不是以英语为母语的人并没有让理解文档变得更容易......

文档说我应该`itemscope itemtype="http://schema.org/Event"`用于事件。

但是 schema.org 上还有一个 MusicEvent，请参见这里[http://schema.org/MusicEvent](http://schema.org/MusicEvent)

那么这是否意味着，我应该使用`itemscope itemtype="http://schema.org/Event/MusicEvent"`还是什么？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T19:19:04.497

是的，你应该使用 MusicEvent。在 schema.org 上的 MusicEvent 页面顶部，您会看到一些如下所示的面包屑：

东西 > 活动 > MusicEvent

这意味着 MusicEvent 类型包括包含 Thing 类型的 Event 类型。该页面还列出了 Thing 和 Event 中可用于 MusicEvent 的所有属性。目前没有仅适用于 MusicEvent 的属性，因此它只是告诉搜索引擎它是什么类型的事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T16:39:26.620

您应该使用 MusicEvent，但您的语法有误。

当更具体的类型可用于命名类型时，您只需声明该 itemtype，而不是类型，而不是该 itemtype 和更一般（“父”）的 itemtype。

这是不正确的： itemscope itemtype="http://schema.org/Event/MusicEvent"

这是正确的： itemscope itemtype="http://schema.org/MusicEvent"

# e-commerce - 仅当使用我的推荐人代码访问网站时，才能在零售网站上制作促销/优惠券代码？

> ID：11570243
> 
> 赞同：-2
> 
> 时间：2012-07-19T22:27:22.147
> 
> 标签：e-commerce

我正在建立一个网站，我的合作伙伴电子商务网站可以在我的网站上宣传他们的销售。例如，零售商会在我的网站上宣传促销活动，而我网站上的链接（“Enter Sale”）会使用推荐人代码将他们带到零售商的网站。

在那里，用户可以在结账时使用特殊的优惠券/促销代码来获得折扣。

我的问题是：我的合作伙伴零售商是否可以轻松地在他们的终端上进行设置，以便这些特殊的促销/优惠券代码仅在使用我的推荐人代码访问网站后才能使用？（即当用户直接访问零售商的常规网址时，代码将不起作用）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T22:36:55.527

让他们也检查一下 http 标头。

在这里看到这个：

[http://en.wikipedia.org/wiki/HTTP_referer](http://en.wikipedia.org/wiki/HTTP_referer)

# processing - kinect/ processing / simple openni - point cloud data not being output properly

> ID：11570247
> 
> 赞同：1
> 
> 时间：2012-07-19T22:27:50.780
> 
> 标签：processing, kinect, openni, point-clouds

I've created a processing sketch which saves each frame of point cloud data from the kinect to a text file, where each line of the file is a point (or vertex) that the kinect has registered. I plan to pull the data into a 3d program to visualize the animation in 3d space and apply various effects. The problem is, when I do this, the first frame seems proper, and the rest of the frames seem to be spitting out what looks like the first image, plus a bunch of random noise. This is my code, in its entirety. It requires simple openni to work properly. You can see the comments

```
import SimpleOpenNI.*;
//import processing.opengl.*;

SimpleOpenNI context;
float        zoomF =0.5f;
float        rotX = radians(180);  // by default rotate the hole scene 180deg around the x-axis, 
float        rotY = radians(0); // the data from openni comes upside down

int maxZ = 2000;
Vector <Object> recording = new Vector<Object>(); 
boolean isRecording = false;
boolean canDraw = true;
boolean mouseMode = false;
int currentFile = 0;
int depthWidth = 640; //MH - assuming this is static?
int depthHeight = 480;
int steps = 5;
int arrayLength = (depthWidth/steps) * (depthHeight/steps); //total lines in each output file

void setup()
{
  size(1024,768,P3D);  // strange, get drawing error in the cameraFrustum if i use P3D, in opengl there is no problem
  //size(1024,768,OPENGL); 

  context = new SimpleOpenNI(this);
  context.setMirror(true);
  depthWidth = context.depthWidth();
  depthHeight = context.depthHeight();

  // enable depthMap generation 
  if(context.enableDepth() == false)
  {
     println("Can't open the depthMap, maybe the camera is not connected!"); 
     exit();
     return;
  }

  stroke(255,255,255);
  smooth();

  perspective(radians(45),
  float(width)/float(height),
  10.0f,150000.0f);
 }

void draw()
{

  //println(isRecording);

  // update the cam
  context.update();

  background(0,0,0);

  // set the scene pos
  translate(width/2, height/2, 0);
  rotateX(rotX);
  rotateY(rotY);
  scale(zoomF);

  // draw the 3d point depth map
  int[]   depthMap = context.depthMap();
  int     index = 0;
  PVector realWorldPoint;
  PVector[] frame = new PVector[arrayLength];

  translate(0,0,-1000);  // set the rotation center of the scene 1000 infront of the camera
  stroke(200); 
  for(int y=0;y < context.depthHeight();y+=steps)
  {
    for(int x=0;x < context.depthWidth();x+=steps)
    {
      int offset = x + y * context.depthWidth();
      realWorldPoint = context.depthMapRealWorld()[offset];
      if (isRecording == true){
        if (realWorldPoint.z < maxZ){
          frame[index] = realWorldPoint;
        } else {
          frame[index] = new PVector(-0.0,-0.0,0.0); 
        }
        index++;
      } else {
        if (realWorldPoint.z < maxZ){
          if (canDraw == true){
            point(realWorldPoint.x,realWorldPoint.y,realWorldPoint.z);
          }
        }
      }
    } 
  }

  if (isRecording == true){
   recording.add(frame); 
  }

 if (mouseMode == true){
   float rotVal = map (mouseX,0,1024,-1,1); //comment these out to disable mouse orientation
   float rotValX = map (mouseY,0,768,2,4);
   rotY = rotVal;
   rotX = rotValX;
 } 

}

// -----------------------------------------------------------------
// Keyboard event
void keyPressed()
{
  switch(key)
  {
    case ' ':
      context.setMirror(!context.mirror());
      break;
    case 'm':
      mouseMode = !mouseMode;
      break;
    case 'r':
      isRecording = !isRecording;
      break;
    case 's':
      if (isRecording == true){
        isRecording = false;
        canDraw = false;
        println("Stopped Recording");
        Enumeration e = recording.elements();
        int i = 0;
        while (e.hasMoreElements()) {

          // Create one directory
          boolean success = (new File("out"+currentFile)).mkdir(); 
          PrintWriter output = createWriter("out"+currentFile+"/frame" + i++ +".txt");
          PVector [] frame = (PVector []) e.nextElement();

          for (int j = 0; j < frame.length; j++) {
           output.println(j + ", " + frame[j].x + ", " + frame[j].y + ", " + frame[j].z );
          }
          output.flush(); // Write the remaining data
          output.close();
          //exit();
        }
        canDraw = true;
        println("done recording");
      }
      currentFile++;
      break;
  }

  switch(keyCode)
  {
    case LEFT:
      if(keyEvent.isShiftDown())
        maxZ -= 100;
      else
        rotY += 0.1f;
      break;
    case RIGHT:
      if(keyEvent.isShiftDown())
        maxZ += 100;
      else
        rotY -= 0.1f;
      break;
    case UP:
      if(keyEvent.isShiftDown())
        zoomF += 0.01f;
      else
        rotX += 0.1f;
      break;
    case DOWN:
      if(keyEvent.isShiftDown())
      {
        zoomF -= 0.01f;
        if(zoomF < 0.01)
          zoomF = 0.01;
      }
      else
        rotX -= 0.1f;
      break;
  }
} 
```

I imagine the loop is where the problems begin occurring: for(int y=0;y < context.depthHeight();y+=steps) { , etc. although it could just be a problem with the python script I wrote for the 3d program. Anyway, this is a cool sketch, and I think would be super useful for anyone wanting to do 3d effects to point cloud data (or build models, etc), but I'm stuck at the moment. Thanks for your help!

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-20T16:19:24.077

Unfortunately I can't explain a lot right now, but I've sone something similar a few months back saving to [PLY](http://local.wasp.uwa.edu.au/~pbourke/dataformats/ply/) and CSV:

```
import processing.opengl.*;
import SimpleOpenNI.*;

SimpleOpenNI context;
float        zoomF =0.5f;
float        rotX = radians(180);  
float        rotY = radians(0);

boolean recording = false;
ArrayList<PVector> pts = new ArrayList<PVector>();//points for one frame

float minZ = 100,maxZ = 150;

void setup()
{
  size(1024,768,OPENGL);  

  context = new SimpleOpenNI(this);
  context.setMirror(false);
  context.enableDepth();
  context.enableScene();

  stroke(255);
  smooth();  
  perspective(95,float(width)/float(height), 10,150000);
 }

void draw()
{
  context.update();
  background(0);

  translate(width/2, height/2, 0);
  rotateX(rotX);
  rotateY(rotY);
  scale(zoomF);

  int[]   depthMap = context.depthMap();
  int[]   sceneMap = context.sceneMap();
  int     steps   = 10;  
  int     index;
  PVector realWorldPoint;
  pts.clear();//reset points
  translate(0,0,-1000);  
  //*
  //stroke(100); 
  for(int y=0;y < context.depthHeight();y+=steps)
  {
    for(int x=0;x < context.depthWidth();x+=steps)
    {
      index = x + y * context.depthWidth();
      if(depthMap[index] > 0)
      { 
        realWorldPoint = context.depthMapRealWorld()[index];
        if(realWorldPoint.z > minZ && realWorldPoint.z < maxZ){//if within range
          stroke(0,255,0);
          point(realWorldPoint.x,realWorldPoint.y,realWorldPoint.z);
          pts.add(realWorldPoint.get());//store each point
        }
      }
    } 
  } 
  if(recording){
      savePLY(pts);//save to disk as PLY
      saveCSV(pts);//save to disk as CSV
  }
  //*/
}

// -----------------------------------------------------------------
// Keyboard events

void keyPressed()
{
  if(key == 'q') minZ += 10;
  if(key == 'w') minZ -= 10;
  if(key == 'a') maxZ += 10;
  if(key == 's') maxZ -= 10;

  switch(key)
  {
    case ' ':
      context.setMirror(!context.mirror());
    break;
    case 'r':
      recording = !recording;
    break;
  }

  switch(keyCode)
  {
    case LEFT:
      rotY += 0.1f;
      break;
    case RIGHT:
      // zoom out
      rotY -= 0.1f;
      break;
    case UP:
      if(keyEvent.isShiftDown())
        zoomF += 0.01f;
      else
        rotX += 0.1f;
      break;
    case DOWN:
      if(keyEvent.isShiftDown())
      {
        zoomF -= 0.01f;
        if(zoomF < 0.01)
          zoomF = 0.01;
      }
      else
        rotX -= 0.1f;
      break;
  }
}
void savePLY(ArrayList<PVector> pts){
  String ply = "ply\n";
  ply += "format ascii 1.0\n";
  ply += "element vertex " + pts.size() + "\n";
  ply += "property float x\n";
  ply += "property float y\n";
  ply += "property float z\n";
  ply += "end_header\n";
  for(PVector p : pts)ply += p.x + " " + p.y + " " + p.z + "\n";
  saveStrings("frame_"+frameCount+".ply",ply.split("\n"));
}
void saveCSV(ArrayList<PVector> pts){
  String csv = "x,y,z\n";
  for(PVector p : pts) csv += p.x + "," + p.y + "," + p.z + "\n";
  saveStrings("frame_"+frameCount+".csv",csv.split("\n"));
} 
```

I'm using an if statement to save only the points within a certain Z threshold, but feel free to alter/use as you see fit. The post processing idea reminds of the [Moullinex video for Catalina](http://moullinex.tumblr.com/post/3180520798/catalina-music-video). Check it out, it's well documented and includes source code as well.

![catalina 1](../Images/415a37aa705dd3a1d113c1e4268a4680.png)

![catalina 2](../Images/084add0d126206c6fb5741e5cffd6105.png)

![catalina 3](../Images/59f3e811a8980acea2ee1d8510e60747.png)

![catalina 4](../Images/747c831ddb77f7f483468a1616fd3ef2.png)

**Update** The posted code saves 1 file per frame. Even though the playback speed would be low, the sketch should still save a file for each frame. The code be simplified a bit:

```
import processing.opengl.*;
import SimpleOpenNI.*;

SimpleOpenNI context;
float        zoomF =0.5f;
float        rotX = radians(180);  
float        rotY = radians(0);

boolean recording = false;
String csv;

void setup()
{
  size(1024,768,OPENGL);  

  context = new SimpleOpenNI(this);
  context.setMirror(false);
  context.enableDepth();

  stroke(255);
  smooth();  
  perspective(95,float(width)/float(height), 10,150000);
 }

void draw()
{
  csv = "x,y,z\n";//reset csv for this frame
  context.update();
  background(0);

  translate(width/2, height/2, 0);
  rotateX(rotX);
  rotateY(rotY);
  scale(zoomF);

  int[]   depthMap = context.depthMap();
  int[]   sceneMap = context.sceneMap();
  int     steps   = 10;  
  int     index;
  PVector realWorldPoint;
  translate(0,0,-1000);  
  //*
  beginShape(POINTS);
  for(int y=0;y < context.depthHeight();y+=steps)
  {
    for(int x=0;x < context.depthWidth();x+=steps)
    {
      index = x + y * context.depthWidth();
      if(depthMap[index] > 0)
      { 
        realWorldPoint = context.depthMapRealWorld()[index];
        vertex(realWorldPoint.x,realWorldPoint.y,realWorldPoint.z);
        if(recording) csv += realWorldPoint.x + "," + realWorldPoint.y + "," + realWorldPoint.z + "\n";
      }
    } 
  }
  endShape(); 
  if(recording) saveStrings("frame_"+frameCount+".csv",csv.split("\n"));
  frame.setTitle((int)frameRate + " fps");
  //*/
}

// -----------------------------------------------------------------
// Keyboard events

void keyPressed()
{

  switch(key)
  {
    case ' ':
      context.setMirror(!context.mirror());
    break;
    case 'r':
      recording = !recording;
    break;
  }

  switch(keyCode)
  {
    case LEFT:
      rotY += 0.1f;
      break;
    case RIGHT:
      // zoom out
      rotY -= 0.1f;
      break;
    case UP:
      if(keyEvent.isShiftDown())
        zoomF += 0.01f;
      else
        rotX += 0.1f;
      break;
    case DOWN:
      if(keyEvent.isShiftDown())
      {
        zoomF -= 0.01f;
        if(zoomF < 0.01)
          zoomF = 0.01;
      }
      else
        rotX -= 0.1f;
      break;
  }
} 
```

The preview can be separated from the recording with different loops and you could have a low res preview, but save more data, still, it would be slow.

I've got another suggestion: Record to the [.oni format](http://openni.org/docs2/ProgrammerGuide.html#Recording) instead. If you've installed OpenNI, you could make use of a couple of samples like [NiViewer](http://openni.org/docs2/ProgrammerGuide.html#NiViewer) and [NiBackRecorder](http://openni.org/docs2/ProgrammerGuide.html#NiBackRecorder). SimpleOpenNI also exposes this functionality, have a look at the **RecorderPlay** sample.

I suggest trying something like this:

1.  Record your scene to an .oni file. It should be fast/responsive
2.  When you're happy with you're .oni recording, process each frame (convert depth to x,y,z points/ filter as needed/ save to the desired format/etc.)

Here's another sketch to illustrate the idea:

```
import SimpleOpenNI.*;

SimpleOpenNI  context;
boolean       recordFlag = true;

int frames = 0;

void setup(){
  context = new SimpleOpenNI(this);

  if(! recordFlag){
    if(! context.openFileRecording("test.oni") ){
      println("can't find recording !!!!");
      exit();
    }
    context.enableDepth();
  }else{  
    // recording
    context.enableDepth();
    // setup the recording 
    context.enableRecorder(SimpleOpenNI.RECORD_MEDIUM_FILE,"test.oni");
    // select the recording channels
    context.addNodeToRecording(SimpleOpenNI.NODE_DEPTH,SimpleOpenNI.CODEC_16Z_EMB_TABLES);
  }
  // set window size 
  if((context.nodes() & SimpleOpenNI.NODE_DEPTH) != 0)
    size(context.depthWidth() , context.depthHeight());
  else 
    exit();
}
void draw()
{
  background(0);
  context.update();
  if((context.nodes() & SimpleOpenNI.NODE_DEPTH) != 0) image(context.depthImage(),0,0);
  if(recordFlag) frames++;
}
void keyPressed(){
  if(key == ' '){
    if(recordFlag){
      saveStrings(dataPath("frames.txt"),split(frames+" ",' '));
      exit();
    }else saveONIToPLY();
  }
}
void saveONIToPLY(){
  frames = int(loadStrings(dataPath("frames.txt"))[0]);
  println("recording " + frames + " frames");
  int w = context.depthWidth();
  int h = context.depthHeight();
  noLoop();
  for(int i = 0 ; i < frames; i++){
    PrintWriter output = createWriter(dataPath("frame_"+i+".ply"));
    output.println("ply");
    output.println("format ascii 1.0");
    output.println("element vertex " + (w*h));
    output.println("property float x");
    output.println("property float y");
    output.println("property float z");
    output.println("end_header\n");
    context.update();
    int[]   depthMap = context.depthMap();
    int     index;
    PVector realWorldPoint;
    for(int y=0;y < h;y++){
      for(int x=0;x < w;x++){
        index = x + y * w;
        realWorldPoint = context.depthMapRealWorld()[index];
        output.println(realWorldPoint.x + " " + realWorldPoint.y + " " + realWorldPoint.z);
      }
    }
    output.flush();
    output.close();
    println("saved " + (i+1) + " of " + frames);
  }
  loop();
  println("recorded " + frames + " frames");
} 
```

When the `recordFlag` is set to true, data will be saved to an .oni file. I haven't found anything in the docs to read how many frames there are in an .oni file so as a quick workaround I've added the `frame` counter. If you hit space, the recording will stop, but will also save the number of frames in a txt file then exit the app. This will be useful later.

When the `recordFlag` is set to false, if there is a recording already, it will playback. If you hit space in this 'mode', drawing will stop, the frame number will be load from the .txt file and for each frame:

1.  The context will be updated (moving to the next frame)
2.  Each pixel in the depth map will be converted to a point
3.  ALL the points will be written to a .ply file (you can process with [meshlab](http://meshlab.sourceforge.net/))

After all frames were saved, the sketch will resume drawing. Since there's no 3D drawing and the sketch is fairly simple, performance should be better, but bare in mind that large .oni file will require a lot of RAM. Feel free to modify the sketch to your needs (e.g. filter out the information you don't want saved, etc.).

Also note that the above, although should save to PLY each separate frame, it saves the same. It seems the context doesn't update() when noLoop() has been called. Here's a modified hacky version that uses a 3s. delay (hopefully the .ply fille will be written to disk by then).

```
import SimpleOpenNI.*;

SimpleOpenNI  context;
boolean       recordFlag = false;
boolean       saving = false;
int frames = 0;
int savedFrames = 0;

void setup(){
  context = new SimpleOpenNI(this);

  if(! recordFlag){
    if(! context.openFileRecording("test.oni") ){
      println("can't find recording !!!!");
      exit();
    }
    context.enableDepth();
  }else{  
    // recording
    context.enableDepth();
    // setup the recording 
    context.enableRecorder(SimpleOpenNI.RECORD_MEDIUM_FILE,"test.oni");
    // select the recording channels
    context.addNodeToRecording(SimpleOpenNI.NODE_DEPTH,SimpleOpenNI.CODEC_16Z_EMB_TABLES);
  }
  // set window size 
  if((context.nodes() & SimpleOpenNI.NODE_DEPTH) != 0)
    size(context.depthWidth() , context.depthHeight());
  else 
    exit();
}
void draw()
{
  background(0);
  context.update();
  if((context.nodes() & SimpleOpenNI.NODE_DEPTH) != 0) image(context.depthImage(),0,0);
  if(recordFlag) frames++;
  if(saving && savedFrames < frames){
      delay(3000);//hack
      int i = savedFrames;
      int w = context.depthWidth();
      int h = context.depthHeight();
      PrintWriter output = createWriter(dataPath("frame_"+i+".ply"));
      output.println("ply");
      output.println("format ascii 1.0");
      output.println("element vertex " + (w*h));
      output.println("property float x");
      output.println("property float y");
      output.println("property float z");
      output.println("end_header\n");
      rect(random(width),random(height),100,100);
      int[]   depthMap = context.depthMap();
      int     index;
      PVector realWorldPoint;
      for(int y=0;y < h;y++){
        for(int x=0;x < w;x++){
          index = x + y * w;
          realWorldPoint = context.depthMapRealWorld()[index];
          output.println(realWorldPoint.x + " " + realWorldPoint.y + " " + realWorldPoint.z);
        }
      }
      output.flush();
      output.close();
      println("saved " + (i+1) + " of " + frames);
      savedFrames++;
  }
}
void keyPressed(){
  if(key == ' '){
    if(recordFlag){
      saveStrings(dataPath("frames.txt"),split(frames+" ",' '));
      exit();
    }else saveONIToPLY();
  }
}
void saveONIToPLY(){
  frames = int(loadStrings(dataPath("frames.txt"))[0]);
  saving = true;
  println("recording " + frames + " frames");
} 
```

I'm not sure frames and files sync and the depth data is saved at medium quality, but I hope my answer provides some ideas.

# iphone - 为 MKOverlay 创建循环脉冲（类似于当前位置叠加）

> ID：11570250
> 
> 赞同：1
> 
> 时间：2012-07-19T22:28:06.807
> 
> 标签：iphone, ios, google-maps, mkmapview, mkoverlay

我有一个关于 IOS 应用程序的地图视图的问题。我有显示围绕一个特定坐标的标准叠加层的地图视图，并且我还有显示在谷歌地图中的正常当前位置标记。当您查看谷歌地图中的标准当前位置时，它会显示当前位置以及带有脉动圆圈的圆形叠加层。我正在尝试为我的地图视图上的其他位置标记创建相同类型的脉动圆圈覆盖。

这是我的标准地图叠加层的代码。有谁知道如何模仿当前位置的外观，但对于特定的标记位置？很抱歉语言混乱，只是想尽可能地解释它。

```
- (MKOverlayView *)mapView:(MKMapView *)mapView viewForOverlay:(id<MKOverlay>)overlay{
    MKCircleView* aView = [[[MKCircleView alloc] initWithCircle:(MKCircle *)overlay] autorelease];

    aView.fillColor = [[UIColor cyanColor] colorWithAlphaComponent:0.35];
    aView.strokeColor = [[UIColor blueColor] colorWithAlphaComponent:0.7];
    aView.lineWidth = 3;

    return aView;

} 
```

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T18:13:23.563

我在github上看过一个例子，但不记得它的名字了。

当时的想法是 MKCircle 不能用于此目的。

诀窍是使用 UIImage 与绘制的圆圈和应用于该图像的恒定比例动画......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-18T11:55:49.477

尝试使用这个：

[http://yickhong-ios.blogspot.it/2012/04/animated-circle-on-mkmapview.html](http://yickhong-ios.blogspot.it/2012/04/animated-circle-on-mkmapview.html)

它是一个完全满足您需要的库

# awk - 嵌套的awk命令？

> ID：11570253
> 
> 赞同：1
> 
> 时间：2012-07-19T22:28:10.407
> 
> 标签：awk

我有以下两个代码：

```
nut=`awk "/$1/{getline; print}" ids_lengths.txt` 
```

和

```
grep -v '#' neco.txt |
grep -v 'seq-name' |
grep -E '(\S+\s+){13}\bAC(.)+CA\b' |
awk '$6 >= 49 { print }' |
awk '$6 <= 180 { print }' |
awk '$4 > 1 { print }' |
awk '$5 < $nut { print }' |
wc -l 
```

我希望我的脚本在这个地方替换“nut”：

```
awk '$4 < $nut { print }' 
```

从这里返回的数字：

```
nut=`awk "/$1/{getline; print}" ids_lengths.txt` 
```

但是，上面代码中的 $1 不应代表 ids_lengths.txt 中的列，而是 neco.txt 中的第一列！（类似于我在主代码中使用 $6 和 $4）。

如何解决这些嵌套 awks 的帮助肯定会受到赞赏:-)

* * *

编辑：我的输入文件（neco.txt）的行如下所示：

```
FZWTUY402JKYFZ  2   100.000 3   11  9     4.500 7   0   0   0   .   TG  TGTGTGTGT 
```

最大的问题是，在使用第一列（例如 FZWTUY402JKYFZ）进行搜索时，我想过滤那些在第五列中编号小于编号的行，这些行是我从另一个文件（ids_lengths.txt）中获得的。这就是为什么我在我的草稿脚本中放入“nut”变量的原因 :-)

ids_lengths.txt 看起来像这样：

```
>FZWTUY402JKYFZ 
153
>FZWTUY402JXI9S 
42
>FZWTUY402JMZO4 
158 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T23:00:51.430

您可以将这两个`grep -v`操作和四个连续的`awk`操作组合成一个。这为您提供了有用的经济性，而无需完全重写所有内容：

```
nut=`awk "/$1/{getline; print}" ids_lengths.txt`
grep -E -v '#|seq-name' neco.txt |
grep -E '(\S+\s+){13}\bAC(.)+CA\b' |
awk -vnut="$nut" '$6 >= 49 && $6 <= 180 && $4 > 1 && $5 < nut { print }' |
wc -l 
```

我不会费心让单个`awk`脚本确定值`nut`并进行基于值的过滤。可以做到，但它会使事情变得不必要地复杂化——除非你能证明整个事情是生产系统性能的瓶颈，在这种情况下你会更加努力（尽管在这种情况下我可能会使用 Perl；它可以在一个命令中完成所有工作）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T22:48:42.533

大约：

```
awk -v select="$1" '$0 ~ select && FNR == NR { getline; nut = $0; } FNR == NR {next} $4 > 1 $5 < nut && $6 >= 49 && $6 <= 180 && ! /#/ && ! /seq-name/ && $NF ~ /^AC.+CA$/ {count++} END {print count}' neco.txt ids_lengths.txt 
```

正则表达式需要调整为 AWK 可以理解的内容。我看不出正则表达式如何匹配您提供的示例数据。部分解决方案可能是使用字段计数作为条件之一。也许`NF == 13`或`NF >= 13`。

这是上面的脚本，为了便于阅读，分成多行：

```
awk -v select="$1" '
    $0 ~ select && FNR == NR {
        getline
        nut = $0; 
    }
    FNR == NR {next}
    $4 > 1
    $5 < nut && 
    $6 >= 49 && 
    $6 <= 180 && 
    ! /#/ && 
    ! /seq-name/ &&
    $NF ~ /^AC.+CA$/ {
        count++
    } 
    END {
        print count
}' ids_lengths.txt neco.txt 
```

# expressionengine - 使用表达式引擎的独立 PHP 脚本

> ID：11570255
> 
> 赞同：3
> 
> 时间：2012-07-19T22:28:17.397
> 
> 标签：expressionengine

有没有办法制作一个我可以做类似事情的脚本`$this->EE->db`（即使用表达式引擎的类，例如访问数据库），但可以在命令行中运行？

我尝试搜索它，但文档似乎不包含此信息（[如果我错了，请纠正我](http://agentdir.com/development/)）。我正在使用 EE 2.4（上面的链接应该指向 2.4 文档）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-20T03:09:00.937

以下文章似乎有一种可能的方法：[Bootstrapping EE for CLI Access](http://www.thenerdary.net/post/20965500651/bootstrapping-ee-for-cli-access)

> *   复制您的 index.php 文件并将其命名为 cli.php。
> *   将 index.php 文件移到 DOCUMENT_ROOT 之外。现在，从技术上讲，这不是必需的，但是没有理由窥探你的辛勤工作，所以为什么不保护它。
> *   在 cli.php 中更新第 26 行的 $system_path 以指向您的系统文件夹。
> *   在 cli.php 中，将第 96 行的 $routing['controller'] 更新为 cli。
> *   在 cli.php 内部，将第 96 行的 APPPATH 更新为 $system_path.'cli/'。
> *   复制 system/expressionengine 目录并将其命名为 system/cli。
> *   复制 cli/controllers/ee.php 文件并将其命名为 cli/controllers/cli.php。
> *   最后，将 cli/controllers/cli.php 中的类名更新为 Cli 并删除方法。
> *   默认情况下 EE 调用 index 方法，所以添加一个 index 方法来做你需要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-25T14:17:19.197

@Zenbuman 这是一个有用的起点，尽管我会补充说，我的所有请求都转到 cli-> index 时遇到问题，而我想要一些转到 cli->task1、cli->task2 等的请求

我必须更新 * *system\codeigniter\system\core\URI.php* * 以便它知道如何提取我通过命令行传递的参数，我从支持 CLI 的更新版本的 Codeigniter 获得以下代码

```
// Is the request coming from the command line?
if (php_sapi_name() == 'cli' or defined('STDIN'))
{
    $this->_set_uri_string($this->_parse_cli_args());
    return;
}

// Let's try the REQUEST_URI first, this will work in most situations 
```

并且还在同一个文件中创建了函数

```
private function _parse_cli_args()
{
    $args = array_slice($_SERVER['argv'], 1);

    return $args ? '/' . implode('/', $args) : '';
} 
```

还必须在我的 cli.php 文件中注释掉以下内容，因为所有路由都将转到我的 cli 控制器中的 index 方法并忽略我的参数

```
/*
 *  ~ line 109 - 111 /cli.php
 * ---------------------------------------------------------------
 *  Disable all routing, send everything to the frontend
 * ---------------------------------------------------------------
 */
$routing['directory'] = '';
$routing['controller'] = 'cli';
//$routing['function'] = ''; 
```

甚至离开

```
$routing['function'] = ''; 
```

将强制请求转到索引控制器

最后我觉得这有点 hacky，但我真的需要在我的情况下使用 EE API 库。否则，我将使用 Codeigniter 创建一个单独的应用程序来处理我的 CLI 需求，希望以上内容对其他人有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-08-18T01:51:15.777

在解决了我自己的这个问题的变体后，我找到了@Zenbuman 的答案。我的示例允许您将 cron 脚本保存在模块中，因此如果您需要您的模块具有 cron 功能，则所有内容都可以整齐地打包在一起。[这是我博客上的详细指南](http://doingisknowing.blogspot.com.au/2015/08/cron-jobs-using-expressionengine-2.html)。

# javascript - JS / Jquery - 从 event.target 聚焦到下一个输入字段

> ID：11570259
> 
> 赞同：0
> 
> 时间：2012-07-19T22:28:52.390
> 
> 标签：javascript, jquery, events, focus, jquery-events

试图拥有它，以便在单击一个输入旁边的链接时，它将隐藏该链接并聚焦到下一个 div 中的输入字段。出于其他原因，我需要使用事件目标来引用它。

如果我改变`.focus();`它的`.val('blah');`工作，以及其他更典型的方法，即`$('a').click(function() {...`会完成这项工作。这只是使用事件目标的限制吗？

这是一个[小提琴](http://jsfiddle.net/nosfan1019/jDXDx/1/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T22:42:17.397

您的 mousedown 事件不会触发处理程序，您需要使用 click() 代替。

像这样[的小提琴](http://jsfiddle.net/jDXDx/3/)

# c# - 为 COM 互操作公开 dll

> ID：11570262
> 
> 赞同：8
> 
> 时间：2012-07-19T22:29:08.643
> 
> 标签：c#, visual-studio-2010, com, com-interop

我以为我知道如何做到这一点，但显然不是，所以我会很感激一些帮助！我无法让我的 dll 注册，因此我可以在 VBS 或其他地方实例化它。

我编写了以下示例类，选中“使程序集 COM 可见”，选中“注册 COM 互操作”，然后构建它。当我尝试从 VBS 实例化它时，我收到“Activex 组件无法创建对象”错误。

这是类代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace Smurf
{
    public class Pants
    {
        public string Explode(bool Loud)
        {
            string result;
            if (Loud)
                result = "BANG";
            else
                result = "pop";
            return result;
        }
    }
} 
```

...这是 VBS：

```
Dim a

Set a = CreateObject("Smurf.Pants")

msgbox("ok") 
```

我还需要做什么？

谢谢 ：）

[编辑]

忘了提，在第一次失败后，我尝试了 REGSVR32 和 REGASM - 没有帮助！

[/编辑]

请注意，当我尝试 REGSVR32 时，会收到以下消息：

**模块“C:...\Smurf.dll”已加载，但未找到入口点 DllRegisterServer。确保“C:...\Smurf.dll”是有效的 DLL 或 OCX 文件，然后重试。**

这有多大帮助？？

这是最新版本的代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Runtime.InteropServices;

namespace Smurf
{
    [Guid("EAA4976A-45C3-4BC5-BC0B-E474F4C3C83F")]
    public interface IPants
    {
        [DispId(1)]
        string Explode(bool Loud);
    }

    [Guid("7BD20046-DF8C-44A6-8F6B-687FAA26FA71"),
        InterfaceType(ComInterfaceType.InterfaceIsIDispatch)]
    public interface IPantsEvents
    {
        string Explode(bool Loud);
    }

    [ComVisible(true)]
    [Guid("0D53A3E8-E51A-49C7-944E-E72A2064F938"),
        ClassInterface(ClassInterfaceType.None),
        ComSourceInterfaces(typeof(IPantsEvents))]
    public class Pants : IPants
    {
        public Pants() { }

        [ComVisible(true)]
        [ComRegisterFunction()]
        public static void DllRegisterServer(string key) { }
        [ComVisible(true)]
        [ComUnregisterFunction()]
        public static void DllUnregisterServer(string key) { }

        [ComVisible(true)]
        public string Explode(bool Loud)
        {
            string result;
            if (Loud)
                result = "BANG";
            else
                result = "pop";
            return result;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-25T18:10:35.590

这里可能有一些不同的事情在起作用。首先，您需要在提升的命令提示符下使用 regasm 工具和 /codebase /tlb 开关（假设是 Windows Vista、7 或 Windows Server 2008）。就像是：

```
regasm "Path to Smurf.dll" /codebase /tlb 
```

使用 regasm 注册 dll 后，您*应该*能够使用 VBS、VBA 或 VB6 调用它。

我能够使用 VBA 中的早期绑定和后期绑定来调用该`Explode`方法。但是，当我尝试使用 VBScript 时，我收到“ActiveX 无法像您一样创建对象错误”。

我在 Windows 7 64 位上运行，我记得在编译为 32 位 dll 并在 64 位操作系统上运行它们时，这可能会导致问题。一时兴起，我启动了命令提示符并输入：

```
C:\Windows\SysWow64\CScript.exe "Path to VBScript" 
```

结果是脚本正确运行并在屏幕上显示“Pop”。

这是我使用的稍微简化的 C# 代码以及 VBScript 文件的内容。

```
namespace Smurf
{
    [Guid("EAA4976A-45C3-4BC5-BC0B-E474F4C3C83F")]
    public interface IPants
    {
        string Explode(bool Loud);
    }

    [Guid("7BD20046-DF8C-44A6-8F6B-687FAA26FA71"),
     InterfaceType(ComInterfaceType.InterfaceIsIDispatch)]
    public interface IPantsEvents
    {
        string Explode(bool Loud);
    }

    [ComVisible(true)]
    [Guid("0D53A3E8-E51A-49C7-944E-E72A2064F938")]
    [ClassInterface(ClassInterfaceType.None)]
    [ComSourceInterfaces(typeof(IPantsEvents))]
    public class Pants : IPants
    {

        [ComVisible(true)]
        public string Explode(bool Loud)
        {
            string result;
            if (Loud)
                result = "BANG";
            else
                result = "pop";
            return result;
        }
    }
} 
```

VB脚本：

```
Dim x 
Set x = CreateObject("Smurf.Pants")
MsgBox (x.Explode(False))
Set x = Nothing 
```

# python - 如何使用 python 将控制 C 发送到 Mac 终端？

> ID：11570266
> 
> 赞同：2
> 
> 时间：2012-07-19T22:29:36.593
> 
> 标签：python, macos, terminal, interrupt

我有一个 python 脚本需要将控制 C 发送到 mac 终端。我尝试发送纯文本“^C”，但我发现终端无法识别该命令。（终端表示python创建的伪终端）

基本上，我正在使用终端运行旧的 Unix 可执行文件，而我能想到的优雅终止它的唯一方法是发送中断信号。有什么办法可以让终端误以为我按下了控制 C？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T22:33:27.993

如果您可以使用[`os.kill`](http://docs.python.org/library/os.html#os.kill).

```
os.kill(pid, signal.SIGINT) 
```

这将要求您对脚本进行检测以获取进程 PID，但这是模拟“ctrl-c”行为的最佳方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T22:42:42.750

如果您使用`subprocess`'s打开进程`Popen`，您应该能够发送如下控制信号：

```
proc.send_signal(signal.SIGINT) 
```

你需要`import signal`得到`SIGINT`.

# maven - 用于将 Grails 与 Maven 集成的 POM 文件，在 BuildConfig.groovy 中具有依赖项

> ID：11570272
> 
> 赞同：3
> 
> 时间：2012-07-19T22:30:20.910
> 
> 标签：maven, grails

我有一个 Grails 应用程序作为一个更大的 Java 源代码的一部分，它都是用 Maven 构建的。我想在 Maven 持续集成、夜间构建等中包含 Grails 应用程序。

（理想情况下，我还希望它成为 Maven 父项目层次结构的一部分，这样我就可以从其他项目中获取实时代码更改，而无需将它们安装到我的本地存储库中。我还想要一只小马。）

我尝试运行“grails create-pom”，在 BuildConfig.groovy 中设置“pom true”，并使用 POM 来管理我的依赖项。然而，这让我陷入了[org.xml.sax.Locator 类加载器地狱](http://jira.grails.org/browse/GRAILS-9283)。所以我回到使用 BuildConfig.groovy 作为我的依赖项。

我知道“pom true”是最近的（Grails 2.1.0）功能，应该可以将 Grails 集成到 Maven 构建中，同时仍然管理 BuildConfig.groovy 中的依赖项。问题是，在这种情况下，我找不到任何关于应该进入 POM 的文档。我在我的 POM 中放了什么？

# jquery - 使用 jQuery 显示嵌套列表的路径

> ID：11570273
> 
> 赞同：0
> 
> 时间：2012-07-19T22:30:21.653
> 
> 标签：jquery

所以我有一个嵌套列表：

```
<ul>
    <li>
        <a href="#">a</a>
        <ul>
            <li>
                <a href="#">a.1</a>
            </li>
            <li>
                <a href="#">a.2</a>
            </li>
        </ul>
    </li>
    <li>
        <a href="#">b</a>
        <ul>
            <li>
                <a href="#" class="open">b.1</a>
            </li>
            <li>
                <a href="#">b.2</a>
            </li>
        </ul>
    </li>
</ul> 
```

而且我有一个在单击时触发的事件，该事件将项目移动到下一个嵌套列表（如果单击 a，它将在列表中显示 a.1 和 a.2）。我想做的是能够通过模拟点击来设置当前菜单；但是，我不知道让链执行功能的最佳方法。在这种情况下，我必须在 b 上执行单击，然后在 b.2 上执行单击，并按此顺序执行。我怎么能用最少的代码完成这个？真正的问题是我可能有很多嵌套列表（最多 4 个），所以我希望这有点灵活。帮助！据我所知，这是：

```
currentMenu: function() {
    var $open = $mID.find('.open');
    if($open.length > 0) {

    }
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-19T22:54:35.203

我在这里添加了一个[演示](http://jsfiddle.net/6dcZR/)，这就是你可能会做的。希望能帮助到你！

# javascript - 基于下拉选择的动态搜索参数

> ID：11570274
> 
> 赞同：0
> 
> 时间：2012-07-19T22:30:30.773
> 
> 标签：javascript, html, search

我有一个像这样的表格：

```
 <form name="search" class="form-search" method="get" action="http://www.bernhardt.com/search.php?">
            <div>
              <input name="search" type="text" class="search-query input-large" onkeypress="return submitenter(this,event)">
              <select>
                <option>Option1</option>
                <option>Option2</option>
                <option>Option3</option>
              </select>
              <button type="submit" class="btn btn-primary">Search</button>
            </div>
        </form> 
```

我想要它，以便在选择option1时，表单的输入就是这样：

```
<form name="search" class="form-search" method="get" action="http://www.websitehere.com/search.php?">
<div>
<input name="search" type="text" class="search-query input-large" onkeypress="return submitenter(this,event)">
<button type="submit" class="btn btn-primary">Search</button>
</div> 
```

当Option2时，像这样：

```
<form name="search" class="form-search" method="get" action="http://www.websitehere.com/search.php?">
<div>
<input name="searchbynum" type="text" class="search-query input-large" onkeypress="return submitenter(this,event)">
<input type="hidden" name="searchbydesc" value="" />
<input type="hidden" name="Submit" value="Go" />
<button type="submit" class="btn btn-primary">Search</button>
</div> 
```

所以没有其他选项等等。我知道这里需要相当多的 Javascript，但我不知道如何（我知道基本的 HTML 和 CSS，而不是 Javascript）。我将不胜感激有关此主题的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T22:47:00.600

看看 document.createElement()

你应该能够做到：

```
<script>
function addInputs() {
    var input = document.createElement("input");
    document.getElementById("frm").appendChild(input);
}
</script>

<form id="frm">
<select onchange="addInputs()" id="sel">
<option>Option 1</option>
</select>
</form> 
```

# javascript - 将 Questions 数组和 Answers 多维数组洗牌相同

> ID：11570276
> 
> 赞同：1
> 
> 时间：2012-07-19T22:30:40.770
> 
> 标签：javascript, arrays

好吧，事情就是这样；

现在我为自己制作了这个网站，通过列出日语单词及其定义来更轻松地学习日语。我把日文单词放在第1课.txt中，把答案放在第1课.txt中以相同的顺序。我用 php 把它们读出来，然后用 javascript 把它们放在数组中。

现在的问题是，每次我启动网站时这些数组都有相同的顺序，这对我来说很烦人，因为我一直在寻找答案，我什至不读日语单词（该死的人脑！） . 所以我认为解决这个问题的最佳方法是随机化两个数组的元素，但它们都必须以相同的模式随机化，因为否则问题不再正确对应于答案。

我拥有的数组之一是多维的。该数组首先包含代表我从 .txt 文件中读取的行的元素。该行中有多个字符，因此数组的第二个元素代表每个字符（不要问我为什么这样做，这与我无法在 php 中读出日文字符并直接将它们放入 js 中有关） . 另一个数组就是我保存答案的数组。

所以我有 AnswersArray(); 和 JapaneseCharactersArray();

我已经被这个问题困扰了一整天了，请有人帮忙或给点提示..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T22:38:33.380

您应该将它们合并到一个对象数组中：

```
// assuming AnswersArray.length == JapaneseCharactersArray.length
var array = [];
for (var i=0; i<AnswersArray.length; i++)
    array[i] = {
       answer: AnswersArray[i],
       japanese: JapaneseCharactersArray[i]
    }; 
```

现在你只有一个数组，每一项都包含一个单词的所有信息。您现在可以轻松[随机播放](https://stackoverflow.com/questions/2450954/how-to-randomize-a-javascript-array)。

`AnswersArray[x]`然后，您将`array[x].answer`在代码中进一步使用，而不是您。

* * *

当然，您可以调整您的`fisherYates`函数以以相同的方式随机播放两个或多个数组：

```
function fisherYates(first/*, ... arrays */) {
    var i = first.length,
        argl = arguments.length;
    if (i == 0) return false;
    while (--i) {
        var r = Math.floor(Math.random() * (i + 1));
        for (var j=0; j<argl; j++) {
            var tempi = arguments[j][i];
            var tempj = arguments[j][r];
            arguments[j][i] = tempj;
            arguments[j][r] = tempi;
        }
    }
}

// usage:
> fisherYates(AnswersArray, JapaneseCharactersArray); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T22:40:24.073

尽管*最好*的方法可能是将它们创建为单个数组，但另一种方法是创建一个与其他数组长度相同的新数组，其中数组中的每个项目都是一个数字：1、2、3 ... n. 但是不要让数字按顺序排列，而是`Math.random()`用来随机化它们的顺序。

然后像这样循环遍历该新数组：

```
for(i=0; i<AnswersArray.length; i++) {
    AnswersArray[RandomArray[i]]; // whatever
} 
```

另一种方法是在随机化数组时交换整行。

# c# - 集合中的第一个匹配项

> ID：11570283
> 
> 赞同：10
> 
> 时间：2012-07-19T22:31:40.053
> 
> 标签：c#, linq

我想将此代码转换为 linq 解决方案。它的作用是查看一组客户，并查看其中至少一个是否有中间名。这段代码工作正常，我只是想学习 linq，所以寻找替代解决方案。：

```
//Customers - List<Customer>
private bool checkMiddleName()
{
    foreach (Customer i in Customers)
    {
        if (i.HasMiddleName == true)
        {
            return true;
        }
    }
    return false;
} 
```

我试着写一些类似的东西：`(Customers.Foreach(x=>x.HasMiddleName==true)...` 但看起来这不是我正在寻找的方法。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-07-19T22:34:16.320

如果您只想知道是否至少有一个，您可以使用`Enumerable.Any`：

```
bool atLeastOneCustomerWithMiddleName = Customers.Any(c => c.HasMiddleName); 
```

如果您想知道第一个匹配的客户，您可以使用`Enumerable.First`或[`Enumerable.FirstOrDefault`](http://msdn.microsoft.com/en-us/library/bb340482.aspx)找到第一个客户`MiddleName==true`：

```
var customer = Customers.FirstOrDefault(c => c.HasMiddleName);
if(customer != null)
{
    // there is at least one customer with HasMiddleName == true
} 
```

`First` 如果源序列为空，则抛出 InvalidOperationException，如果没有匹配则`FirstOrDefault`返回。`null`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T22:35:44.527

```
var result   = Customers.Where(x=>x.HasMiddleName == true).FirstOrDefault(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T22:32:57.907

基于此：

> 它的作用是查看一组客户，并查看其中至少一个是否有中间名。

尝试

```
return Customers.Where(x => x.HasMiddleName).Any(); 
```

`true`如果至少一个客户拥有该属性，则此查询返回`HasMiddleName = true`

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-07-19T22:41:28.537

您可以使用以下内容来实现您所需要的：

```
Customers.Where(cust=> cust.HasMiddleName).Count > 0 
```

因此，如果 Count 大于零意味着您有一些具有中间名的客户。

或者为了获得更好的性能，您可以说：

```
bool customerWithMiddleName;

foreach(Customer cust in Customers)
{
  if(cust.HasMiddleName)
  {
    customerWithMiddleName = true;
    break;
  }
} 
```

# android - windows 7 adb驱动三星galaxy S3

> ID：11570284
> 
> 赞同：11
> 
> 时间：2012-07-19T22:31:41.983
> 
> 标签：android, adb

出于应用程序开发目的，我想通过我的 Windows 7 32 位笔记本电脑上的 ADB 接口访问三星 Galaxy S3 (ICS) 手机。我在哪里可以找到手机的 ADB 驱动程序？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-11-05T03:31:56.357

这对我有用。从以下位置下载驱动程序：

[http://developer.samsung.com/android/tools-sdks/Samsung-Android-USB-Driver-for-Windows](http://developer.samsung.com/android/tools-sdks/Samsung-Android-USB-Driver-for-Windows)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-03-03T13:01:37.260

> adb shell --> '错误：找不到设备'

这是对我有用的 Win7 64 位

1.  从[http://developer.samsung.com/android/tools-sdks/Samsung-Andorid-USB-Driver-for-Windows安装](http://developer.samsung.com/android/tools-sdks/Samsung-Andorid-USB-Driver-for-Windows)
    *   注意：这（2014 年）- 可能需要其他操作系统的其他驱动程序
2.  打开设备管理器 | 其他设备 | Smasung（黄色问号）
3.  右键单击 | 更新驱动软件...
4.  浏览我的电脑以获取驱动程序软件 + 下一步
5.  让我从计算机上的设备驱动程序列表中选择
6.  从列表中选择三星移动驱动程序

    结果：设备管理器在其他设备下不显示手机，而是在三星安卓手机下显示——>现在可以连接

7.  刷新：也尝试通过再次杀死 adb.exe 进程和 adb shell 来刷新 adb。

# android - Android NFC Android 应用程序记录错误

> ID：11570286
> 
> 赞同：1
> 
> 时间：2012-07-19T22:31:54.963
> 
> 标签：android, nfc, ndef, android-applicationrecord

我正在尝试使用[Android 开发人员链接](http://developer.android.com/guide/topics/connectivity/nfc/nfc.html#aar)`createApplicationRecord(packagename)`中提到的添加应用程序记录，但我看到了一个错误：`NdefMessage`

> 未定义类型 NdefRecord 的方法 createApplicationRecord(String)

我已经从 Eclipse 更新了我的 Android SDK 管理器。这是代码的一部分：

```
private NdefMessage getMessageAsNdef() {
    byte[] textBytes = mInfo.getBytes();
    NdefRecord textRecord = new NdefRecord(NdefRecord.TNF_MIME_MEDIA,
            "text/plain".getBytes(), new byte[] {}, textBytes);
    return new NdefMessage(new NdefRecord[] { textRecord, NdefRecord.createApplicationRecord("com.nfcgeo.mypackage") });
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T23:00:46.940

检查您在 Eclipse 中的项目设置是否已将 Android“项目构建目标”设置为 API 级别 14 或更高。`NdefRecord.createApplicationRecord()`仅适用于 Android 4.0 ICS 及更高版本。

# python - 我可以将多个服务器绑定到同一个 TCP 端口吗？

> ID：11570290
> 
> 赞同：1
> 
> 时间：2012-07-19T22:32:37.727
> 
> 标签：python, port

我希望在同一个端口上有多个服务器会导致问题。事实上，当我尝试在同一个端口上启动两台服务器时，我希望它抛出异常。问题是，在同一个端口上启动多个服务器似乎非常高兴。我可以让以下代码的许多实例运行得很好，没有例外。

```
import BaseHTTPServer
import SimpleHTTPServer
import sys

def main():
    try:
        server = BaseHTTPServer.HTTPServer(('127.0.0.1',5000), SimpleHTTPServer.SimpleHTTPRequestHandler)
        print "On port: " + str(server.socket.getsockname()[1])
    except Exception, e:
        print e
    server.serve_forever()

if __name__ == "__main__":
    main() 
```

所有这些都声称在端口 5000 上。如果它试图使用已经占用的端口，我怎样才能让它抛出异常？

编辑：这是 Python 2.6.4

编辑 2：[http](http://www.youtube.com/watch?v=rVOG3JdbHAM&feature=youtu.be) ://www.youtube.com/watch?v=rVOG3JdbHAM&feature=youtu.be因为人们似乎认为我在解释是不可能的？或者我完全误解了人们。无论哪种方式，这个视频都应该清除它。我启动了两台服务器，它们都没有打印出任何异常。当我关闭第一个时，第二个开始工作。为什么会这样？我希望第二台服务器永远不会启动并打印异常。这不应该发生吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T22:40:51.643

我试图执行你的代码并返回第二个实例，

```
 [Errno 98] Address already in use 
```

正如它应该。SuSE Linux 上的 Python 2.6。

可以使用 netstat 实用程序检查端口 5000 是否真的被占用？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T23:00:39.720

一个 TCP 端口可以被一个且只有一个进程绑定。正如@phihag 所指出的，您只认为您有多个服务器绑定到端口 5000，因为您正在丢弃告诉您已经绑定该端口的异常。

> 我在 Windows 7 上运行。它将端口状态列为 TIME_WAIT

这是一个次要问题，通常是由于客户端没有正确关闭连接造成的。TIME_WAIT 是一种[有效的 TCP 状态](http://en.wikipedia.org/wiki/File%3aTcp_state_diagram_fixed.svg)，但服务器需要[2 分钟才能清除](http://en.wikipedia.org/wiki/Maximum_Segment_Lifetime)。您应该查看为什么您的客户端会断开连接而不是让服务器关闭它。

如果您在客户端使用标准浏览器，您应该假设您的服务器代码中存在第二个未在此处显示的错误。

**添加以回应评论**

你的期望有问题。这个版本的代码应该清楚：

```
def bind():
    return BaseHTTPServer.HTTPServer(('127.0.0.1',5000), SimpleHTTPServer.SimpleHTTPRequestHandler)

s1 = bind()
s2 = bind() 
```

最后一行将以“地址已在使用”异常中止您的程序。如果您选择忽略（或捕获并丢弃）异常，`s2`将没有有效的服务器。这就是异常告诉你的。在 C 语言中，如果您以同样的方式忽略错误，它看起来像：

```
fp = fopen("a_file_that_does_not_exist", "r")
fgets(buf, BUFSIZ, fp) 
```

两者都`fopen`将`fgets`返回`EOF`您忽略的内容。该程序会运行，但它肯定不会做任何有用的事情，因为您无法从不存在的文件中读取。您可以忽略错误返回，但将手放在眼睛上也不会使怪物消失。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-05T15:15:02.240

我同意各种答案和评论，表明您不能对单个 TCP 端口有多个侦听器；但是，我遇到了与 OP 相同的行为。我正在运行 Windows 8，我的程序实例（用 C++ 编写，使用 Boost）都没有抛出异常。的输出`netstat`如下所示：

```
C:\windows\system32>netstat -an

Active Connections

  Proto  Local Address          Foreign Address        State
  TCP    0.0.0.0:135            0.0.0.0:0              LISTENING
  TCP    0.0.0.0:445            0.0.0.0:0              LISTENING
  TCP    0.0.0.0:5357           0.0.0.0:0              LISTENING
  TCP    0.0.0.0:7112           0.0.0.0:0              LISTENING
  TCP    0.0.0.0:17500          0.0.0.0:0              LISTENING
  TCP    0.0.0.0:49152          0.0.0.0:0              LISTENING
  TCP    0.0.0.0:49153          0.0.0.0:0              LISTENING
  TCP    0.0.0.0:49154          0.0.0.0:0              LISTENING
  TCP    0.0.0.0:49155          0.0.0.0:0              LISTENING
  TCP    0.0.0.0:49157          0.0.0.0:0              LISTENING
  TCP    0.0.0.0:50102          0.0.0.0:0              LISTENING
  TCP    0.0.0.0:50102          0.0.0.0:0              LISTENING
  TCP    127.0.0.1:2559         0.0.0.0:0              LISTENING
  TCP    127.0.0.1:19872        127.0.0.1:49248        ESTABLISHED
  TCP    127.0.0.1:49248        127.0.0.1:19872        ESTABLISHED
  TCP    127.0.0.1:50102        127.0.0.1:52616        TIME_WAIT
  TCP    127.0.0.1:50102        127.0.0.1:52618        TIME_WAIT
  TCP    127.0.0.1:50102        127.0.0.1:52620        TIME_WAIT
  TCP    127.0.0.1:50102        127.0.0.1:52622        TIME_WAIT 
```

在这种情况下，第一个开始侦听端口 50102 的程序实例会接收所有客户端连接。然后，当我关闭该实例时，第二个实例开始接收客户端连接。奇怪但真实。

我希望第二个程序实例无法开始侦听与第一个实例相同的端口。

# python - Merceros.com API 使用的 Python 代码

> ID：11570291
> 
> 赞同：1
> 
> 时间：2012-07-19T22:32:44.610
> 
> 标签：python, urllib2

我正在尝试通过一些代码来通过 Python 连接到 Merceros.com 的其余 API。

通过一些研究，我设法使用以下 urllib2 代码使 GET 访问正常工作：

```
# NOTE:  This api key has been made bogus
lcMOS_APIKey = '07203c82fab495xxxxxxxxxxxxxxxxxxxc2a499c'
# also bogus...
lcMOS_Acct = '98765'
lcBaseURL = 'https://api.merchantos.com/API/Account/' + lcMOS_Acct + '/' 

# create a password manager
password_mgr = urllib2.HTTPPasswordMgrWithDefaultRealm()
password_mgr.add_password(None, lcBaseURL, lcMOS_APIKey, 'apikey')
# create "opener" (OpenerDirector instance)    
handler = urllib2.HTTPBasicAuthHandler(password_mgr)
opener = urllib2.build_opener(handler)
urllib2.install_opener(opener)

# use the opener to fetch a URL
#loReturn = opener.open(lcBaseURL + lcURLEnd)  
loReturn = opener.open(lcBaseURL + 'Customer.xml?firstName=Alex')  
lcResponse = loReturn.read() 
```

所以，上面成功地拉回了数据。我得到了客户记录的 XML。

现在，我需要做的是更改方法，以便我可以执行 PUT（用于更新）和 POST（用于创建/新建）。

MerchantOS 需要以下内容才能进行更新：

UPDATE / HTTP PUT 要更新现有记录/对象，您需要执行 HTTP PUT 请求。put/post 数据应该是定义对象更新的 XML 块。例如，要更新一个项目，您将使用一个块 PUT 到 API/Account/1/Item/2（在此示例中，1 是帐号，2 是 itemID）。

因此，例如，我想做一个 PUT 来更新客户 ID = 2

我将为 XML 块提供数据引用

```
<Customer>
   ..contents omitted here...
</Customer> 
```

而且，我要把它指向[URL](http://api.merchantos.com/API/Account/my_acct_num/Customer/2)。

我在这里面临的问题是..

*   我不知道在哪里/如何将方法更改为 PUT
*   我最需要知道如何附加我的数据块并发布它

那么，有人可以告诉我如何将上述代码调整为 GET 以制作 PUT .. 以及 POST（用于创建新记录）

提前感谢您在这方面的任何帮助。

斯科特。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T04:23:02.527

您可以尝试使用 cURL 而不是 urllib。cURL 非常灵活，可以满足您的需求：

[http://pycurl.sourceforge.net/](http://pycurl.sourceforge.net/)

以下是您可以使用 cURL 设置的两个选项：

CURLOPT_POST：设置为 1 的参数告诉库执行常规 HTTP 发布... CURLOPT_POSTFIELDS：在 HTTP POST 操作中发布的完整数据...

# emacs - 是否可以在 MSYS 下运行 emacs？

> ID：11570300
> 
> 赞同：1
> 
> 时间：2012-07-19T22:33:54.947
> 
> 标签：emacs

我正在使用带有 mintty
的 MSYS 可以用它运行 emacs 吗？这个 emacs 应该接受 posix 路径等。
我想使用路径，例如： /c/Ptogram\ Files/
我应该使用哪个构建？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T22:43:35.660

当然。只需运行适用于 Windows 的标准 Emacs 构建，并确保它位于您的 $PATH 中。

# node.js - res.redirect 来自 POST

> ID：11570301
> 
> 赞同：35
> 
> 时间：2012-07-19T22:33:54.777
> 
> 标签：node.js, post, express

出于某种原因，一旦我的登录完成，我就无法重定向到 /blog。在我的登录控制器中，我有以下内容。

```
module.exports = {

    post: function(req, res) {
         var login = req.body['login'];                      

         if (login && req.body['login']['password'] == "password") {
            console.log('Granted access');
            res.send({redirect: '/blog'});

         }

         else {
             console.log('wrong password');
             res.redirect('back');

         }

    }

}; 
```

jquery ajax

```
$(document).ready ->

    $('#login-button').click () ->

        $.ajax
            url: '/login'
            type: 'POST'
            data: $('#Password').serialize()
            dataType: 'json'
            success: (data, textStatus, jqXHR) ->
                if typeof data.redirect == 'string'
                    window.location = data.redirect 
```

更新为工作代码

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2012-07-20T07:03:58.140

您不能在 AJAX 之后进行重定向。你需要用Javascript自己做。

服务器

```
post: function(req, res) {
     var login = req.body['login'];          
     app.use(express.bodyParser());

     if (login && req.body['login']['password'] == "tom") {
        var loginPassword = req.body['login']['password'];
        console.log(loginPassword);
        console.log('Granted access');
        res.send({redirect: '/blog'});

     }

     ...

} 
```

客户

```
$(document).ready ->
    $('#login-button').click () ->
        $.ajax
            url: '/login'
            type: 'POST'
            data: $('#Password').serialize()
            dataType: 'json'
            success: (data, textStatus, jqXHR) ->
                if typeof data.redirect == 'string'
                    window.location = data.redirect 
```

这应该有效。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-20T13:45:43.310

POST 被重定向到 GET。您不能将 POST 重定向到 POST；你可以转发它，但这会很奇怪。我建议向您的 GET 路由添加逻辑，以处理登录用户与未登录用户。

此外，304 可能意味着您的响应正在被浏览器缓存，因为您使用了 301（永久重定向、登录时非常糟糕等；使用 302）。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2017-06-14T01:26:39.497

你失踪了`return`：

```
return res.redirect('/'); 
```

# tsql - T-SQL：选择 ... 其中 ID = 一组可能的 ID 之一

> ID：11570304
> 
> 赞同：0
> 
> 时间：2012-07-19T22:34:00.987
> 
> 标签：tsql

我将介绍存储过程现在是如何工作的，然后再讨论这个问题。当前过程接受与树中的节点相对应的 ID 号 - ID 被格式化，使得子节点的左子字符串包含其直接父节点的 ID。因此，如果子节点的 ID 为 10100349，则其父节点的 ID 为 101003。该过程通过以下方式返回属于所选节点及其子节点的任何信息：

```
CREATE PROCEDURE [dbo].[blah]

-- Parameter
@IDNumber varchar(100),

...

-- Get the length of the ID number
DECLARE @IDNumLength integer
SET @IDNumLength = LEN(@IDNumber)

...

SELECT
    *whatever information*
WHERE
    LEFT(table.[IDNumber], @IDNumLength) = @IDNumber 
```

出于说明目的：

```
1010 (root node)
|
|_ 101001
|  |_ 10100101
|  |_ 10100102
|  |_ 10100103
|  |_ 10100104
|
|_ 101002
.  |_ 10100201
.  |_ 10100202
.  |_ 10100203 
```

因此，搜索节点 101001 上的信息将返回其自身及其子节点 10100101 到 10100104 的信息。

这适用于仅选择一个 ID 的情况，但我正在尝试修改查询以接受多个 ID，以便查询返回多个节点的信息。选定的节点 ID 作为逗号分隔的字符串 ('101001,10100201,10100202') 传入，其中指定的 ID 都不是字符串中任何其他节点的子节点（这样做是为了避免信息重复 - 这种情况是在执行查询之前强制执行）。

我已经对在 T-SQL 中模拟数组进行了一些研究，但是我遇到的任何事情都只涉及搜索“数组”中的任何元素。我遇到的问题是将长度值与每个 ID 相关联，类似于单 ID 查询的形成方式。

提前致谢。如果有人有问题，我会尽我所能回答他们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T22:43:51.927

我喜欢关注点分离的想法，所以

首先，您可能要考虑[解析字符串](http://mangalpardeshi.blogspot.com/2009/03/how-to-split-comma-delimited-string.html) 其次，遍历您的字符串列表，将单个值传递给您的工作 sp，根据情况将结果返回到临时表或表变量。

最后处理完成的结果

希望这可以帮助！

# pytest - 如何调试 funcargs 函数？

> ID：11570305
> 
> 赞同：1
> 
> 时间：2012-07-19T22:34:03.747
> 
> 标签：pytest

如何在 funcargs 函数中放入 pdb？以及如何在 funcargs 函数中查看 print 语句的输出？

* * *

我最初的问题包括以下内容，但事实证明我只是在检测错误的 funcarg。叹。

> 我试过：
> 
> ```
> print "hi from inside funcargs" 
> ```
> 
> 使用和不使用 -s 调用。
> 
> 我试过：
> 
> ```
> import pytest
> pytest.set_trace() 
> ```
> 
> 和：
> 
> ```
> import pdb
> pdb.set_trace() 
> ```
> 
> 和：
> 
> ```
> raise "hi from inside funcargs" 
> ```
> 
> 没有产生任何输出或导致测试失败。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T07:47:03.730

首先想到的是 py.test -s

但默认情况下 funcargs 给你回溯和输出/错误 - 你使用什么插件？某事显然隐藏了它

例如对于程序

```
def pytest_funcarg__foo(request):
    print 'hi'
    raise IOError

def test_fun(foo):
   pass 
```

一个 py.test 调用给了我 - funcarg 函数和文本中的回溯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-20T13:54:49.280

要调试 funcarg：

```
def pytest_funcarg__myfuncarg(request):
    import pytest
    pytest.set_trace()
    ...

def test_function(myfuncarg):
    ... 
```

然后：

```
python -m pytest test_function.py 
```

正如[Ronny](https://stackoverflow.com/users/78110/ronny)回答的那样，查看 funcarg 的输出是`pytest -s`有效的。

# oauth-2.0 - 错误：如果重定向 URI 包含“&”字符，SoundCloud OAuth2 连接将失败

> ID：11570311
> 
> 赞同：2
> 
> 时间：2012-07-19T22:34:38.943
> 
> 标签：oauth-2.0, soundcloud

我在通过 OAuth2 连接到 Sound API 时遇到错误。

这是我使用的连接链接：

[https://soundcloud.com/connect?client_id=27e07408838149bc81b98928b76468f9&redirect_uri=http%3A%2F%2Fbeta.mydomain.com%2Fapd%2F%3Fmodule%3Dsoundcloud%26action%3Dreturn&response_type=code&consumer_key=28e07409898149a968b9898149a968b](https://soundcloud.com/connect?client_id=27e07408838149bc81b98928b76468f9&redirect_uri=http%3A%2F%2Fbeta.mydomain.com%2Fapd%2F%3Fmodule%3Dsoundcloud%26action%3Dreturn&response_type=code&consumer_key=28e07409898149a981b98928b76468f9)

通过单击它，我被重定向到：

[http://beta.mydomain.com/apd/?module=soundcloud&action=return&error=redirect_uri_mismatch&error_description=The+redirection+URI+provided+does+not+match+a+pre-registered+value](http://beta.mydomain.com/apd/?module=soundcloud&action=return&error=redirect_uri_mismatch&error_description=The+redirection+URI+provided+does+not+match+a+pre-registered+value)。

但是指定的redirect_uri参数（编码）和注册的url（在Redirect URI字段中）是完全一样的：

[http://beta.mydomain.com/apd/?module=soundcloud&action=return](http://beta.mydomain.com/apd/?module=soundcloud&action=return)

我不知道是否有任何错误或有任何其他限制返回相同的错误。或者“重定向 URI”可能不是适用的字段。这应该足够了。

（应用名称为 bigpress）（出于安全原因，Domain 和 consumer_key 已更改）

**更新：**好的，我想我明白了。在进行了十几次检查之后……如果 redirect_uri 包含“&”字符，SoundCloud 将始终返回此错误。

# php - 两个不寻常的PHP运算符一起使用来获取图像像素颜色，请解释

> ID：11570312
> 
> 赞同：3
> 
> 时间：2012-07-19T22:34:49.537
> 
> 标签：php, gd, rgb

PHP [imagecolorat()](http://www.php.net/manual/en/function.imagecolorat.php)函数可用于获取图像像素的 RGB 值，如文档中所示：

```
$im = imagecreatefrompng("php.png");
$rgb = imagecolorat($im, 10, 15);
$r = ($rgb >> 16) & 0xFF;
$g = ($rgb >> 8) & 0xFF;
$b = $rgb & 0xFF; 
```

我根本不明白最后三行；我知道它们返回正确的值，但我无法弄清楚`>>`and`&`运算符如何协同工作。有人可以解释一下吗？

作为参考，当 时`$rgb = 9750526`，RGB 值变为`(148,199,254)`。

感谢您的任何回复。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-19T22:56:10.670

& 和 >> 是两个不同的[位运算符](http://en.wikipedia.org/wiki/Bitwise_operation)（[PHP 中的位运算符](http://php.net/manual/en/language.operators.bitwise.php)）。它们使用值的位表示，这为我们提供了一些有用（而且快速！）的可能性。

**>>**是[右移](http://en.wikipedia.org/wiki/Logical_shift)。如果您右移一个值，您将在表示中向右移动所有位。如果您有“11100”并将其右移两个位置，则剩下“111”（右端移出的位消失）。>> 右侧的数字表示要移位的位数。

**&**是[按位和](http://en.wikipedia.org/wiki/Bitwise_operation#AND)。如果您有两个值表示为 111000 和 101011，并决定按位计算它们，那么您最终将得到 101000（两个值中设置相同位的位将为 1，否则为 0）。

我们现在有了理解上面代码所需的东西。$rgb 包含一个整数值（该值不感兴趣，但位模式是），它表示 24 位（RGBA 为 32 位，但我们将在这里忽略它）。该值由红色的 8 位、绿色的 8 位和蓝色的 8 位组成。然而，我们对这 24 位一起代表什么数字不感兴趣，而是对单独的 R、G 和 B 值是什么感兴趣。

我们的值代表颜色的以下位：

```
rrrrrrrr gggggggg bbbbbbbb 
```

如果我们用 >> 16 移动这个位掩码，我们将得到：

```
 rrrrrrrr 
```

这就是 >> 16 所做的，只剩下代表红色的位。由于我们现在将这些位一直向下移动，该值表示 [0, 255] 中的一个数字。然后我们添加 & 255（这里用十六进制表示为 0xFF）以删除我们感兴趣的 8 以上的任何杂散位。当我们查看如何获得 G 值时，我们将了解现在是如何发生的：

我们的价值依然勇敢地代表着不同的颜色：

```
rrrrrrrr gggggggg bbbbbbbb 
```

如果我们用 >> 8 将此位掩码移动 8 位，我们将得到：

```
 rrrrrrrr gggggggg 
```

可是等等！这不仅是代表 g 的位，还有代表 r 的位！这不是我们追求的值（因为我们只想要 g）。在前面的例子中我们很幸运，因为我们没有设置任何高于 r 的位，但是这次我们真的完成了我们的工作。但是我们知道 &，是时候真正看到它的东西了。

我们现在有：

```
 rrrrrrrr gggggggg 
```

然后我们应用 & 255（代码中的 0xFF），它以位值表示为：

```
 00000000 11111111 
```

由于 & 只保留在两个操作数中设置的位，我们最终将只得到 g 值：

```
 gggggggg 
```

移位值中表示红色的位现在为 0，我们只剩下表示原始颜色的绿色的位。由于它们已经移位到表示 [0, 255] 的相同 8 位，我们再次得到了我们的值。

最后一个值更容易，因为它已经位于我们想要的位置：在表示 [0, 255] 的位中。我们可以在这里做 & 操作，然后从另一边出去：

```
rrrrrrrr gggggggg bbbbbbbb & 
00000000 00000000 11111111 
```

最后是：

```
 bbbbbbbb 
```

我们也有我们的蓝色价值。

希望能解释清楚！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T22:40:38.997

我猜第一次出现，>>16，将所有位向右移动，直到只剩下红色，然后用 &0xFF 切断数字的开头。虽然在那个例子中我不能告诉红色的位深度（我希望颜色是 3 个字节的倍数），但它有点像这样：

```
rrggbb = 125438 // input
>> 16 // shift right (might be 8 for this example)
0000rr = 000012 // result
& 0xFF // cut beginning
rr = 12 
```

其他颜色也类似。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T22:48:27.590

`>>`表示按位右移，因此这些位向右移动 n 个（分别为 16 和 8 个）位置：

> R = 1 字节 = 8 位

```
RRGGBB >> 16  =  0000RR
RRGGBB >> 8   =  00RRGG 
```

逐位与操作`&`用于删除我们不希望在结果中出现的剩余内容，方法是使用除应保留的部分之外的所有地方都为零的掩码：

```
00RRGG & 0000FF = 0000GG 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-19T22:52:55.180

我们试试看：

```
$rgb = 9750526;
var_dump(sprintf('%032b', $rgb)); 
```

$rgb = 00000000100101001100011111111110 //整数是 32 或 64 位 - b 部分是最后 8 位

你只需要第三个、第二个和第一个字节，所以>>（移位）它们，你得到二进制

```
$rgb >> 16 =  string(32) "00000000000000000000000010010100" //r part is last 8 bits
$rgb >> 8 =  string(32) "00000000000000001001010011000111" //g part is last 8 bits 
```

& 0xFF 是和操作 11111111 所以结果你得到

```
r = 10010100
g = 11000111
b = 11111110 
```

我希望那些是 (148,199,254) ;)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-19T22:47:21.143

imageColorAt() 返回一个包含红色、绿色和蓝色值的 24 位数字。红色值乘以 2^16，绿色乘以 2^8，蓝色保持“原样”。

在十六进制中，您的值为 0x94C7FE；通过将其右移 16 位，您会丢失最后四个半字节，并留下 0x94。“& 0xFF”取最后 8 位（因此是多余的）。

通常这种 shift'n'cut 是这样完成的：

```
$value = imageColorAt(...)   // Gets 94C7FE
$blue  = $value & 0xFF;       // Takes the last "FE" (254 in decimal)
$value >>= 8;                 // Shifts right, 94C7 remains
$green = $value & 0xFF;       // Takes "C7"
$value >>= 8;                 // Shifts right, 94 remains
$red   = $value;              // Takes "94" hex, which is 148 dec. 
```

# java - java renameTo方法不起作用

> ID：11570314
> 
> 赞同：1
> 
> 时间：2012-07-19T22:35:09.207
> 
> 标签：java, file-rename

我知道这可能已经在这里被回答了一百万次，但我所看到的一切都没有帮助我。这是我的代码：

```
for(File g: f.listFiles()){
    for(File h : g.listFiles()){
        try{
            Scanner s = new Scanner(h);
            String timestamp = s.next().split("[?]")[4];
            File z = new File(h.getAbsolutePath().split("[.]")[0] + timestamp + h.getAbsolutePath().split("[.]")[1]);
            boolean q = h.renameTo(z);
        }catch(Exception e){

        }
    }
} 
```

我检查了 File z 是否存在，但它不存在。我检查了文件 h 是否存在并且确实存在。我已经仔细检查了 h 是绝对路径。如果我打印 z 的绝对路径，我会得到正确的路径。f 中的目录或 g 中的文件均未打开。h 表示的文件未打开。Windows 不允许我的程序重命名它的文件上是否有一些标志集或某些东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T22:41:43.830

我的猜测是您遇到的问题与我在这里遇到的问题类似[文件删除/移动失败](https://stackoverflow.com/questions/8714893/file-deletion-moving-failing)

尝试对扫描仪使用 FileinputStreams

```
FileInputStream fin = new FileInputStream(h);
fin.open()
Scanner s = new Scanner(fin);
//do work
fin.close() 
```

并在重命名之前关闭流

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T22:52:11.203

renameTo 的行为因平台而异。在一个平台上成功的操作可能在另一个平台上失败。例如，在我的本地开发工作站 (OS X) 上，一切都按预期工作。在生产系统 (Solaris) 上，renameTo 始终失败。我终于确定当文件位于不同的分区时它失败了。显然这里不是这种情况，但它说明该方法可以以意想不到的方式运行。

要获得一致的行为，请将数据复制到新文件，然后删除原始文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-07T20:34:37.497

我有一个几乎相同的问题。一些重命名案例成功，一些失败。对于那些失败的情况，我发现源文件路径和目标文件路径不在同一个文件系统中。在我的情况下，NTFS 安装了另一个文件系统，目标文件将被移动到该文件系统。由于重命名函数的最初目的只是重命名一个名称，而不是移动相关文件的数据。如果源文件路径和目标文件路径都在不同的文件系统中，则某些版本的 JVM 在某些平台上会失败。实际上，这是 java.io 中的一个错误，Solaris 已在新版本中修复了此错误。祝你好运！

永远快乐，

# php - 创建一个启动 PHP 代码的 jQuery 事件处理程序

> ID：11570318
> 
> 赞同：0
> 
> 时间：2012-07-19T22:35:29.737
> 
> 标签：php, jquery

我正在尝试做的是创建一些 jQuery 代码，当我单击图像时将启动一些 PHP 代码并重新加载页面。我已经创建了下面的代码，但是对于启动 PHP 代码需要 jQuery 中的什么类型的事件处理程序感到困惑。我怀疑这是边界 AJAX，除了这是同步的。这是下面的代码。

```
<script src="http://code.jquery.com/jquery-latest.js"></script>

<style>

img:hover { border:1px solid #021a40; margin: 1px; padding: 1px; color: #000000; 

cursor:pointer;};

</style>

<script>

$(document).ready(function(){

$('img').on('click',"img",function(){

$(this).slideUp();

What do I put here?????

});

});

</script> 

<img  src="image.gif" width="50" height="50" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T23:01:09.543

没有ajax尝试：

```
$(document).ready(function()
{
   $('img').on('click',"img",function()
   {
       $(this).slideUp('slow',function () 
       {
          window.location = "url/to/phpfile.php?data="+yourdata
       });
   });
}); 
```

然后在 php 文件中，进行更新并输出或重定向到另一个页面。

关于您上面的评论，[slideUp()](http://api.jquery.com/slideUp/)的第二个参数是动画完成后的回调函数，因此您应该在页面转换之前获得视觉反馈。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T22:43:45.760

这是我认为你可以做的。

```
$(document).ready(function(){
  $('img').on('click',"img",function(){
   $(this).slideUp('slow',function () {
      $.ajax({/* your ajax call here will run when the sliding is done */})
   });
  });
}); 
```

# nginx - 在子域上使用具有不同根文件夹的多个位置配置 nginx

> ID：11570321
> 
> 赞同：246
> 
> 时间：2012-07-19T22:35:48.183
> 
> 标签：nginx, webserver

我希望将子域的根 url 和子域的目录提供给我服务器上的两个不同文件夹。这是我拥有但不工作的简单设置......

```
server {

    index index.html index.htm;
    server_name test.example.com;

    location / {
            root /web/test.example.com/www;
    }

    location /static {
            root /web/test.example.com/static;
    }
} 
```

在此示例中，`test.example.com/`将带入索引文件`/web/test.example.com/www`

并且`test.example.com/static`会带入索引文件`/web/test.example.com/static`

* * *

## 回答 #1

> 赞同：280
> 
> 时间：2012-07-20T06:22:52.433

您需要将`alias`指令用于`location /static`：

```
server {

  index index.html;
  server_name test.example.com;

  root /web/test.example.com/www;

  location /static/ {
    alias /web/test.example.com/static/;
  }

} 
```

[nginx wiki](http://wiki.nginx.org/HttpCoreModule#alias)比我更好地解释了 root 和 alias 之间的区别：

> 请注意，它乍一看可能类似于 root 指令，但文档根目录没有改变，只是用于请求的文件系统路径。请求的位置部分被丢弃在 Nginx 发出的请求中。

请注意，`root`并`alias`以不同的方式处理尾部斜杠。

* * *

## 回答 #2

> 赞同：127
> 
> 时间：2015-05-04T19:36:30.003

位置指令系统是

就像你想转发所有开始的请求**`/static`**和你的数据一样**`/var/www/static`**

所以一个简单的方法是将最后一个文件夹与完整路径分开，这意味着

完整路径 ：`/var/www/static`

最后一条路径：`/static` 和第一条路径：`/var/www`

```
location <lastPath> {
    root <FirstPath>;
} 
```

所以让我们看看你做错了什么以及你的解决方案是什么

你的错误：

```
location /static {
    root /web/test.example.com/static;
} 
```

您的解决方案：

```
location /static {
    root /web/test.example.com;
} 
```

* * *

## 回答 #3

> 赞同：54
> 
> 时间：2012-07-20T16:17:37.343

```
server {

    index index.html index.htm;
    server_name test.example.com;

    location / {
        root /web/test.example.com/www;
    }

    location /static {
        root /web/test.example.com;
    }
} 
```

[https://nginx.org/en/docs/http/ngx_http_core_module.html#root](https://nginx.org/en/docs/http/ngx_http_core_module.html#root)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2020-09-15T21:24:22.347

一个更详细的例子。

设置：您有一个网站，`example.com`并且您有一个网络应用程序`example.com/webapp`

```
...
server {
  listen 443 ssl;
  server_name example.com;

  root   /usr/share/nginx/html/website_dir;
  index  index.html index.htm;
  try_files $uri $uri/ /index.html;

  location /webapp/ {
    alias  /usr/share/nginx/html/webapp_dir/;
    index  index.html index.htm;
    try_files $uri $uri/ /webapp/index.html;
  }
}
... 
```

我已经命名`webapp_dir`并且`website_dir`是故意的。如果您有匹配的名称和文件夹，则可以使用该`root`指令。

此设置有效，并已使用 Docker 进行测试。

注意！！！小心斜线。完全按照示例中的方式放置它们。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-08-02T18:49:42.940

如果你使用这个，我建议你也设置这个命令。

```
location /static/ {
    proxy_set_header Host $host/static; // if you change the directory and the browser can't find your path
    alias /web/test.example.com/static/;
} 
```

# android - 显示活动后执行代码

> ID：11570323
> 
> 赞同：1
> 
> 时间：2012-07-19T22:36:06.397
> 
> 标签：android, android-asynctask, android-activity

我正在尝试在显示活动后运行一些脚本。我正在从网络上加载一些图像并在活动中动态显示它们。我正在运行多个可运行对象，每个可运行对象调用一个`Asynctask`（读取图像并分配给`ImageView`，图像视图在`onCreate`函数中创建），但只有在所有可运行对象异步任务完成后才会显示活动。

我希望你能帮助我实现这一目标。我正在寻找的是显示活动，然后一个接一个地加载和显示图像。

```
public void onWindowFocusChanged(boolean hasFocus) {
    super.onWindowFocusChanged(hasFocus);

    if (!hasFocus)
        return;
    Handler h = new Handler();
    Runnable[] r;
    int i = 0;
    r = new Runnable[files.length];
    for (i = 0; i < files.length; i++) {
        final int j = i;
        r[i] = new Runnable() {
            public void run() {
                ViewGroup vg = (ViewGroup) findViewById(R.id.RootView);

                Log.v("ASYNC", "Starting Call " + j);
                // new BitmapWorkerTask().execute(img, i);
                new BitmapWorkerTask(img, j).execute();
                vg.invalidate();
            }
        };
        h.post(r[i]);
        Log.v("ASYNC", "Posted " + i);
    }
    return;
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T23:16:44.820

`onWindowFocusChanged(boolean hasFocus)`不是`Activity`生命周期方法。相反，您应该开始执行任务`onCreate`。如果加载需要很长时间，那么您可以显示某种进度微调器。

# python - Ubuntu 上的 Firefox 14 无法连接

> ID：11570326
> 
> 赞同：1
> 
> 时间：2012-07-19T22:36:32.967
> 
> 标签：python, ajax, firefox, ubuntu, xmlhttprequest

我有一个在 Ubuntu 上用 python 编写的自定义应用程序。展开所有部分以减少要问的问题有点麻烦（如果我到达那里会发布更多内容），但我有一些事情要列举。经过反复试验，我已将此问题退回到 Firefox 14。

1.  firefox 13 上一切正常，firefox 14 在 Ubuntu 上进行了更新，但东西坏了。（这并不少见，但我在任何地方都找不到这个问题）
2.  我们转到 web 服务中的一个页面并重新加载 10 次左右，然后重新加载挂起，状态栏中显示“正在连接”。
3.  XHR 正在消耗 Firefox 上的连接。增加 Firefox 中的最大连接设置可以解决此问题。基本上，我们打开了一个 XHR，我什至看不到 chrome，但在 firefox 节目中使用了 firebug 中的微调器。XHR 似乎在页面重新加载时保持打开状态，并最终消耗到该站点的打开连接。
4.  大约几分钟后，连接释放并且负载通过。

有人见过这个吗？有没有合适的方法来释放连接？所有其他尝试过的浏览器都没有这个问题。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T03:49:05.350

在我更新到 firefox 14.01 之前，我的 rails 应用程序中有很多测试都可以正常工作。之后，Firefox 浏览器打开并挂在那里。我不得不切换到 Chrome（从谷歌下载的驱动程序）。如果有任何帮助，这就是我在 ruby​​ 中初始化驱动程序的方式：

```
@driver = Selenium::WebDriver.for :chrome, :switches => %w[--ignore-certificate-errors --disable-popup-blocking --disable-translate] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T20:52:10.450

升级到 Firefox 15 beta 解决了这个问题。如果我在 FF 发行说明中找到任何内容，我会更新答案。

现在有一个 Firefox 错误来跟踪这个[问题](https://bugzilla.mozilla.org/show_bug.cgi?id=779637)。

# php - â€‹ 字符从 jsFiddle 粘贴后出现在代码中

> ID：11570327
> 
> 赞同：2
> 
> 时间：2012-07-19T22:36:37.880
> 
> 标签：php, javascript, jquery, html, forms

好的，这就是我在做什么。我正在制作一个基于用户选择的下拉菜单，它将显示正确的表单。现在我可以让它在这里工作[http://jsfiddle.net/13lackHawk/Vhbw8/](http://jsfiddle.net/13lackHawk/Vhbw8/)但是当我将它应用到实际页面时它不起作用。我不知道我在这里做错了什么。这似乎是直截了当的。谁能帮我确定问题？过去几天一直困扰着我。

这是一个现场版本。

[http://panel.dev.adkgamers.com/site/scripts/forms.php](http://panel.dev.adkgamers.com/site/scripts/forms.php)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T22:39:37.127

# javascript - Ruby On Rails：通过 jquery/ajax 请求发送文件

> ID：11570331
> 
> 赞同：4
> 
> 时间：2012-07-19T22:37:10.257
> 
> 标签：javascript, ruby-on-rails, ajax, sendfile

我无法通过 ajax 从我的 rails 服务器下载文件：

我的下载控制器中有一个显示操作，`send_file`如果将参数传递给显示操作，它会调用该操作。

然后我有一个页面，其中有一个`select`下拉列表，显示服务器上的文件列表。当我选择一个值并单击下载按钮时，它会发出一个 ajax 请求，该请求会发送一个由我的下载控制器处理的 GET 请求。

查看我的服务器日志，似乎 ajax 请求正在工作，它说：

```
Started GET "/download?file=test.txt" for 127.0.0.1 at 2012-07-19 15:13:41 -0700
Processing by DownloadsController#show as HTML
  Parameters: {"file"=>"test.txt"}
Sent file /Users/Admin/Documents/rails_projects/test/public/data/test.txt (0.1ms)
Completed 200 OK in 0ms (ActiveRecord: 0.0ms) 
```

但是实际上没有下载任何内容。当我实际`show`手动访问该页面时，该文件实际上已下载。我究竟做错了什么？

--

Javascript

```
 <script type="text/javascript">
    $(function() {
      $('#button').click(function() {
        var s = $("select#dropdown_select").val();
               $.ajax({
                      type: 'GET',
                      url: 'http://localhost:3000/download?file=' + s,
                      dataType: "HTML"
                      });
      })
    });
  </script> 
```

下载控制器

```
def show

    filename = params[:dl]

    if(filename.nil? == false)

    path = Rails.root.join('public/data', filename)
    send_file path, :x_sendfile => true

    end
end 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-01T20:28:15.743

我有同样的问题，很好，但我没有使用 JS 点击功能，而是使用了 rails`link`标记。

最初，在我**看来**，我有一个`link_to`标签`remote: true`（产生 ajax 调用）

该链接针对生成 PDF 的操作。PDF 已生成（带有 prawn 和 thinreports）并发送，但没有弹出下载对话框。

所以我删除`remote: true`并添加了一个`target: '_self'`，所以它最终是这样的（我使用的是haml）

```
!= link_to image_tag( 'print.png' ) + (I18n.t :buttons)[:comments][:print],
    customer_comment_path(@address_book),
    { target: '_self' } 
```

它工作得很好。

为什么不尝试使用 Rail 的`link`标签重写代码？

# javascript - 如何获取 Twitter Bootstrap Modal 的调用者元素？

> ID：11570333
> 
> 赞同：64
> 
> 时间：2012-07-19T22:37:21.880
> 
> 标签：javascript, twitter-bootstrap, modal-dialog

我有一个`a`调用模态的元素：

```
<a class="btn" data-toggle="modal" data-target="#myModal" href="http://some-url" >Launch Modal</a> 
```

而且，说这是我的模态：

```
<div class="modal hide" id="myModal">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal">×</button>
    <h3>Modal header</h3>
  </div>
  <div class="modal-body">
    <p>One fine body…&lt;/p>
  </div>
  <div class="modal-footer">
    <a href="#" class="btn" data-dismiss="modal">Close</a>
    <a href="#" class="btn btn-primary">Save changes</a>
  </div>
</div> 
```

我可以将函数绑定到模态触发的事件：

```
$('#myModal').on('hidden', function () {
  // do something…
}) 
```

我的问题是：如何`a`从我的事件订阅者函数中访问调用模态的元素？

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2014-01-23T10:04:35.303

由于`event.relatedTarget`.

```
$('#your-modal').on('show.bs.modal', function (e) {
  var $invoker = $(e.relatedTarget);
}); 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-09-23T15:39:31.130

你必须听：

```
$('[data-toggle="modal"]').on('click', function() {
    $($(this).attr('href')).data('trigger', this);
});
$('.modal').on('show.bs.modal', function() {
    console.log('Modal is triggered by ' + $(this).data('trigger'));
}); 
```

您当然可以用show.bs.modal 或它们触发的任何其他事件替换show.bs.modal。请注意，这适用于 Bootstrap 3.0.0。如果您使用的是 2.3.2，则需要摆脱**.bs.modal**（我认为）。

我喜欢这个解决方案的地方：你不必记住谁是**this**、**self**、**that**和其他代理调用解决方法。

当然，您必须测试 href 属性是否不是真正的链接（动态模式加载选项）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-02-21T15:36:59.493

modal 元素有一个名为的数据对象`modal`，它保存所有传递的选项。您可以在触发模式的元素上设置“源”数据属性，将其设置为源的 ID，然后稍后从`options`变量中检索它。

触发器将是：

```
<a id="launch-modal-1" class="btn" data-toggle="modal" data-target="#myModal" href="http://some-url" data-source="#launch-modal-1">Launch Modal</a> 
```

在事件回调中，获取`modal`数据对象，查看`source`选项：

```
$('#myModal').on('hidden', function () {
  var modal = $(this).data('modal');
  var $trigger = $(modal.options.source);
  // $trigger is the #launch-modal-1 jQuery object
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-31T23:53:26.197

目前，它不能开箱即用。如果您想自己编辑引导模式代码，有一个功能请求和解决方法。

看[这里](https://github.com/twitter/bootstrap/issues/531)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-14T11:03:25.900

就像你说的那样，我遇到了一种情况，我必须绑定一些与“调用者”相关的数据。我设法通过将“点击”事件绑定到它并使用如下数据来解决它：

**调用者**

```
<img id="element" src="fakepath/icon-add.png" title="add element" data-toggle="modal" data-target="#myModal" class="add"> 
```

**用于捕获与调用者相关的数据的 JS**（只是一些代码示例）

```
$('#element').on('click', function () { // Had to use "on" because it was ajax generated content (just an example)
    var self = $(this);
}); 
```

像这样，您可以随心所欲地处理与调用者相关的数据。

# jquery-ui - 在 ClojureScript 中使用 jquery-ui 和 jayq

> ID：11570334
> 
> 赞同：4
> 
> 时间：2012-07-19T22:37:24.403
> 
> 标签：jquery-ui, clojurescript

我正在尝试将 jayq 与 jquery.ui.sortable 一起使用以使页面上的列表可排序。查看[http://jqueryui.com/demos/sortable/](http://jqueryui.com/demos/sortable/)似乎应该很简单：

```
(.sortable ($ :#sortable)) 
```

编译为：

```
jayq.core.$.call(null, "\ufdd0'#sortable").sortable(); 
```

并抛出：

```
Uncaught TypeError: Cannot call method 'call' of undefined 
```

当我尝试将其包含在页面中时。有趣的是，当我将生成的代码粘贴到 js 控制台时，它确实在页面中工作，这对我来说意味着在执行该行之后加载了一些必要的东西。

我已经修改

```
(def cljs-options {:advanced {:externs ["externs/jquery.js"]}}) 
```

到

```
(def cljs-options {:advanced {:externs ["externs/jquery.js" "js/ui/jquery-ui.js]}}) 
```

在阅读 [http://lukevanderhart.com/2011/09/30/using-javascript-and-clojurescript.html](http://lukevanderhart.com/2011/09/30/using-javascript-and-clojurescript.html)之后 ，这似乎还不够。我猜 jquery.ui 修改了 $ Prototype，但我不确定如何在 clojurescript 中完成此操作

如果有什么不同的话，我也在使用 noir 和 noir-cljs。

[考虑将 jQueryUI 与闭包编译器一起使用](https://stackoverflow.com/questions/6134290/using-jqueryui-with-closure-compiler)，可能只是 jquery-ui 需要一个手卷的externs 文件才能使用，这可能是一项重大任务。任何人都可以确认吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-17T04:27:24.237

解决这个问题有两个不同的方面。

1.  要在高级模式下编译，我需要将以下内容添加到我的 externs 文件中。

    ```
    $.prototype.sortable = function (a,b) { };
    $.prototype.disableSelection = function (a,b) { }; 
    ```

2.  我正在使用 noir-cljs，在我的视图模板中，有以下内容：

    ```
    (:require [noir.cljs.core :as cljs])
    (:use [hiccup.page :only [include-js]])
    ...
    (cljs/include-scripts :with-jquery)  
    (include-js "/js/jquery-ui.js") 
    ```

但这永远行不通，因为 jquery-ui 代码需要包含在 jquery 之后但在生成的 ClojureScript 之前。解决方案是在页面中手动包含库：

```
(include-js "/js/jquery.js")
(include-js "/js/jquery-ui.js")
(include-js "/cljs/bootstrap.js") ;; Generated 
```

# c++ - Windows Metro 模式 (C++)：等待信号量 (WaitForSingleObjectEx)：因访问被拒绝而失败 [部分解决]

> ID：11570336
> 
> 赞同：1
> 
> 时间：2012-07-19T22:37:42.530
> 
> 标签：c++, winapi, windows-runtime, semaphore

可能这对你来说是个愚蠢的问题..但它对我不起作用！（WinRT 的新手 .. 也可能是 Windows！）只是尝试创建信号量并尝试获取它.. 没什么特别的。但它失败了 WAIT_FAILED: 5 (Access denied)

```
void MainPage::simple_Sema_test1()
{

    HANDLE p_sema;
    DWORD ret, err;
    p_sema = CreateSemaphoreEx(NULL, 1, MAX_LIMIT, L"sema1", 0, SEMAPHORE_MODIFY_STATE);
    if(p_sema == NULL)
        print_on_textbox("CreateSemaphoreEx Failed!\n");
    ret = WaitForSingleObjectEx(p_sema, 1000, TRUE);
    switch(ret){
    case WAIT_ABANDONED:
        print_on_textbox("WAIT_ABANDONED\n");
    case WAIT_IO_COMPLETION:
        print_on_textbox("WAIT_IO_COMPLETION\n");
    case WAIT_OBJECT_0:
        print_on_textbox("WAIT_OBJECT_0\n");
    case WAIT_TIMEOUT:
        print_on_textbox("WAIT_TIMEOUT\n");
    case WAIT_FAILED:
        print_on_textbox("WAIT_FAILED: " + (GetLastError()).ToString());
} 
```

> > > 编辑 <<<（部分解决）使用 SEMAPHORE_ALL_ACCESS 创建信号量

IE

```
*sema = CreateSemaphoreEx(NULL, initial, MAX_LIMIT, L"sema1", 0, SEMAPHORE_ALL_ACCESS); 
```

如果有人知道为什么它不适用于修改访问，请解释！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T23:07:49.367

要等待同步对象，您必须具有[`SYNCHRONIZE`访问权限](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686670.aspx)：

> `SYNCHRONIZE`: 使用对象进行同步的权利。这使线程能够等待，直到对象处于信号状态。

该`SEMAPHORE_ALL_ACCESS`值包括`SYNCHRONIZE`标志。

# c# - 快速创建 Pdf 的库

> ID：11570342
> 
> 赞同：2
> 
> 时间：2012-07-19T22:38:13.857
> 
> 标签：c#, .net, asp.net-mvc, pdf

我想获取对象列表并将其创建到表格中并将其显示到 pdf 文件中。有没有我可以使用的好图书馆？

```
MyObject a = new MyObject();
a.Name = "bob";
a.Address = "123 fake st";

pdf output

Name    Address
bob    123 fake st
jim     test 
```

我查看了 pdfsharp/migradoc，但它似乎不适用于中等信任，所以我不确定它是否适用于我的共享主机。

我听说过 itextsharp 但并没有真正研究它，因为他们似乎已经改变了他们的许可，而且我相信新的许可迫使你让你的项目开放。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T05:59:04.033

你可以使用 iTextsharp。这里有[一篇关于 CodeProject 的好文章，](http://www.codeproject.com/Articles/260470/PDF-reporting-using-ASP-NET-MVC3)它说明了如何使用 iTextsharp 和 RazorEngine 包将 Razor 视图直接导出为 PDF。

# asp.net-mvc - 在 asp.net mvc 中创建 es-la/es-xl 资源

> ID：11570346
> 
> 赞同：5
> 
> 时间：2012-07-19T22:39:02.787
> 
> 标签：asp.net-mvc, asp.net-mvc-3, c#-4.0, globalization

因此，我正在对一个 asp.net mvc3 网站进行全球/本地化处理，并列出了我需要支持的文化。到目前为止，每个人都运作良好，但我无法让西班牙（拉丁美洲）文化代码发挥作用。微软似乎不支持它：

[http://msdn.microsoft.com/en-us/goglobal/bb896001.aspx](http://msdn.microsoft.com/en-us/goglobal/bb896001.aspx)

有没有办法绕过这个？我知道我可以添加每种特定的国家文化，但是当浏览器设置为 es-la 时，这实际上不起作用（特别是在 chrome 中）。如果我没有找到合理的解决方法，这将成为一个缺陷。:(

我很乐意添加所需的任何其他详细信息。任何帮助是极大的赞赏。即使答案是我无法真正解决它。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T19:13:23.230

您可能会认为这有点小题大做，但在拉丁美洲使用中立文化“es”是否可行？然后任何其他西班牙文化，如西班牙，都会有特定的文化，并在适当的时候被使用。

# eclipse - Eclipse：以编程方式创建首选项

> ID：11570348
> 
> 赞同：0
> 
> 时间：2012-07-19T22:39:12.120
> 
> 标签：eclipse, eclipse-plugin, eclipse-rcp

我需要以编程方式创建一些首选项页面。当我第一次触发以下代码时，它会按预期工作：

```
 IPreferencePage page = new NewPreferencePage(test);
    page.setTitle("First Title");

    PreferenceManager pm = PlatformUI.getWorkbench().getPreferenceManager();
    PreferenceNode node = new PreferenceNode("node." + nodeName, page);
    pm.addToRoot(node);

    Shell shell = PlatformUI.getWorkbench().getActiveWorkbenchWindow()
            .getShell();

    PreferenceDialog pd = new PreferenceDialog(shell, pm);
    pd.setPreferenceStore(Activator.getDefault().getPreferenceStore());

    pd.create();
    pd.open(); 
```

问题是当我尝试从标准模式（Window -> Preferences）访问首选项时发生错误，并且我创建的节点为空。此外，当我触发此代码超过 2 次时，会创建一个新节点，并且前一个节点在首选项列表中显示为空白行。

任何人都有一些教程或一些详细信息来描述如何以编程方式创建它。我在网上搜索并尝试了不同的方法，但没有成功。

或者，如果有人知道如何在触发菜单时更改标准 PreferenceDialog，我可以尝试另一种解决方案。

这个问题与这个问题类似： [Eclipse: create preference page programmatically](https://stackoverflow.com/questions/4017001/eclipse-create-preference-page-programmatically)，但我还是无法解决它。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T14:28:42.537

我遇到了同样的问题，我通过在我的偏好页面中覆盖 getPreferenceStore() 来解决它，它可以工作。请看下面的代码：

```
@Override
public IPreferenceStore getPreferenceStore() {
    return MarkerPlugin.getDefault().getPreferenceStore();
} 
```

# sql - t-SQL 更新表以删除重叠的时间范围

> ID：11570354
> 
> 赞同：6
> 
> 时间：2012-07-19T22:39:39.053
> 
> 标签：sql, sql-server, sql-update

我想知道是否有人可以帮助我处理这个 SQL 语句？

比如说，我有一个这样的 SQL Server 2008 表：

```
id -- INT PRIMARY KEY
dtIn -- DATETIME2
dtOut -- DATETIME2
type -- INT

id  dtIn    dtOut    type
1   05:00   10:00    1
2   08:00   16:00    2
3   02:00   08:00    1
4   07:30   11:00    1
5   07:00   12:00    2 
```

我需要删除上表中的任何时间重叠。这可以用这张图来说明： ![在此处输入图像描述](../Images/3114f8fef61d7514335a48d56ef97dd0.png)

所以我想出了这个SQL：

```
UPDATE [table] AS t 
SET dtOut = (SELECT MIN(dtIn) FROM [table] WHERE type = t.type AND t.dtIn >= dtIn AND t.dtIn < dtOut) 
WHERE type = t.type AND t.dtIn >= dtIn AND t.dtIn < dtOut 
```

但它不起作用。知道我在这里做错了什么吗？

****编辑****

好的，我花了一段时间才明白这一点。似乎是我需要它的工作SQL：

```
--BEGIN TRANSACTION;

--delete identical dtIn
DELETE dT1
FROM tbl dT1
WHERE EXISTS
(
    SELECT *
    FROM tbl dT2
    WHERE dT1.Type = dT2.Type
    AND dT1.dtIn = dT2.dtIn
    AND (
            dT1.dtOut < dT2.dtOut
            OR (dT1.dtOut = dT2.dtOut AND dT1.id < dT2.id)
        )
);

--adjust dtOuts to the max dates for overlapping section
UPDATE tbl
SET dtOut = COALESCE((
    SELECT MAX(dtOut)
    FROM tbl as t1
    WHERE t1.type = tbl.type
    AND t1.dtIn < tbl.dtOut 
AND t1.dtOut > tbl.dtIn
    ), dtOut);

-- Do the actual updates of dtOut
UPDATE tbl
SET dtOut = COALESCE((
    SELECT MIN(dtIn)
    FROM tbl as t2
    WHERE t2.type = tbl.type AND
          t2.id <> tbl.id AND
          t2.dtIn >= tbl.dtIn AND t2.dtIn < tbl.dtOut
    ), dtOut);

--COMMIT TRANSACTION; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T23:13:19.047

我认为[CROSS APPLY](http://msdn.microsoft.com/en-us/library/ms175156%28v=sql.105%29.aspx)可能会成功：

```
DECLARE @T TABLE (ID INT, DTIn DATETIME2, dtOut DATETIME2, Type INT)
INSERT @T VALUES
(1, '05:00', '10:00', 1),
(2, '08:00', '16:00', 2),
(3, '02:00', '08:00', 1),
(4, '07:30', '11:00', 1),
(5, '07:00', '12:00', 2)

UPDATE  @T
SET     DtOut = T3.DtOut
FROM    @T T1
        CROSS APPLY
        (   SELECT  MIN(DtIn) [DtOut]
            FROM    @T T2
            WHERE   T2.Type = T1.Type
            AND     T2.DtIn > T1.dtIn 
            AND     T2.DtIn < T1.dtOut
        ) T3
WHERE   T3.dtOut IS NOT NULL

SELECT  *
FROM    @T 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T22:46:06.360

就在我的脑海中，我相信 Joe Celko 的一本书以这个问题为例。您可能会在 Google 上找到摘录。

这可能更接近。我认为您并没有真正以正确的方式执行子查询。

```
UPDATE table
SET dtOut = (
    SELECT MIN(t2.dtIn)
    FROM [table] as t2
    WHERE t2.id <> table.id AND t2.type = table.type
        AND table.dtIn < t2.dtIn AND t2.dtIn < table.dtOut
        AND table.dtOut <= t2.dtOut
    )
WHERE EXISTS (
    SELECT 1
    FROM [table] as t3
    WHERE
            t3.type = table.type
        AND t3.id <> table.id
        AND table.dtIn < t3.dtIn AND t3.dtIn < table.dtOut
        AND table.dtOut <= t3.dtOut
    ) 
```

**编辑** 我忽略了页面顶部的 id 列，所以显然这比确保端点不匹配更好。如果您可以假设没有两行相同类型的行具有 dtIn，则该解决方案可能会更容易。

顺便说一句，当子查询将完成完全相同的工作时，没有理由使用 CROSS APPLY。

**编辑 2** 我做了一些快速测试，我认为我的查询处理了图表中的场景。在一种情况下，它可能无法执行您想要的操作。

对于给定的类型，按开始时间的顺序考虑最后两个段 S1 和 S2。S2 在 S1 之后开始，但也可以想象它在 S1 之前结束。S2 完全包含在 S1 的区间中，因此要么可以忽略，要么需要将两个段的信息分成第三段，这就是问题变得更加棘手的地方。

所以这个解决方案只是假设它们可以被忽略。

* * *

**编辑 3**基于关于组合更新的评论

*OP 发布的 SQLFiddle*

```
-- eliminate redundant rows
DELETE dT1 /* FROM tbl dT1 -- unnecessary */
WHERE EXISTS
(
    SELECT *
    FROM tbl dT2
    WHERE dT1.Type = dT2.Type AND dT1.dtIn = dT2.dtIn
    AND (
        dT1.dtOut < dT2.dtOut
        OR (dT1.dtOut = dT2.dtOut AND dT1.id < dT2.id)
    )
);

--adjust dtOuts to the max dates
UPDATE tbl
SET dtOut = COALESCE((
    SELECT MAX(dtOut)
    FROM tbl as t1
    WHERE t1.type = tbl.type
    ), dtOut);

-- Do the actual updates of dtOut
UPDATE tbl
SET dtOut = COALESCE((
    SELECT MIN(dtIn)
    FROM tbl as t2
    WHERE t2.type = tbl.type AND
          t2.id <> tbl.id AND
          t2.dtIn >= tbl.dtIn AND t2.dtIn < tbl.dtOut
    ), dtOut); 
```

下面的两个更新中的任何一个都应该替换上面的两个更新。

```
UPDATE tbl
SET dtOut = (
    SELECT
        COALESCE(
            MIN(dtIn),
            /* as long as there's no GROUP BY, there's always one row */
            (SELECT MAX(dtOut) FROM tbl as tmax WHERE tmax.type = tbl.type)
        )
    FROM tbl as tmin
    WHERE tmin.type = tbl.type

        AND tmin.dtIn > tbl.dtIn
        /*  
        regarding the original condition in the second update:
            t2.dtIn >= tbl.dtIn AND t2.dtIn < tbl.dtOut

        dtIns can't be equal because you already deleted those
        and if dtIn was guaranteed to be less than dtOut it's
        also automatically always less than max(dtOut)
        */
);

UPDATE tbl
SET dtOut = COALESCE(
  (
    SELECT MIN(dtIn) FROM tbl as tmin
    WHERE tmin.type = tbl.type AND tmin.dtIn > tbl.dtIn
  ),
  (        
    SELECT MAX(dtOut) FROM tbl as tmax
    WHERE tmax.type = tbl.type
  )
); 
```

# java - 全屏Java中的JFrame

> ID：11570356
> 
> 赞同：121
> 
> 时间：2012-07-19T22:39:56.760
> 
> 标签：java, swing, fullscreen

我很快就会做一个项目，我将不得不在**其中使用全屏模式。**

它将在窗口中绘制一些图形。如果我使用**JFrame**或类似的东西会很方便。

我不知道屏幕的最终分辨率是多少。请告诉我图形是否会自动重新缩放？

```
JFrame jf = new JFrame();
jf.setSize(1650,1080);
//make it fullscreen;
//now is everything is going to be rescaled so it looks like the original? 
```

* * *

## 回答 #1

> 赞同：233
> 
> 时间：2012-07-19T22:45:32.647

添加：

```
frame.setExtendedState(JFrame.MAXIMIZED_BOTH); 
frame.setUndecorated(true);
frame.setVisible(true); 
```

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2012-07-19T23:06:30.170

如果您想将您的框架置于全屏模式（如全屏电影），请检查这些答案。

*   [如何在 OSX 上用 Java 进行全屏显示](https://stackoverflow.com/questions/1155838/how-can-i-do-full-screen-in-java-on-osx)
*   [Java setFullScreenWindow() 保持领先](https://stackoverflow.com/a/11499100/870248)

类[`java.awt.GraphicsEnvironment`](http://docs.oracle.com/javase/7/docs/api/java/awt/GraphicsEnvironment.html)和[`java.awt.GraphicsDevice`](http://docs.oracle.com/javase/7/docs/api/java/awt/GraphicsDevice.html)用于将应用程序置于一个屏幕上的全屏模式（配置）。

例如：

```
static GraphicsDevice device = GraphicsEnvironment
        .getLocalGraphicsEnvironment().getScreenDevices()[0];

public static void main(String[] args) {

    final JFrame frame = new JFrame("Display Mode");
    frame.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);
    frame.setUndecorated(true);

    JButton btn1 = new JButton("Full-Screen");
    btn1.addActionListener(new ActionListener() {
        @Override
        public void actionPerformed(ActionEvent e) {
            device.setFullScreenWindow(frame);
        }
    });
    JButton btn2 = new JButton("Normal");
    btn2.addActionListener(new ActionListener() {
        @Override
        public void actionPerformed(ActionEvent e) {
            device.setFullScreenWindow(null);
        }
    });

    JPanel panel = new JPanel(new FlowLayout(FlowLayout.CENTER));
    panel.add(btn1);
    panel.add(btn2);
    frame.add(panel);

    frame.pack();
    frame.setVisible(true);

} 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-07-19T22:40:52.000

使用[`setExtendedState(int state)`](http://docs.oracle.com/javase/6/docs/api/java/awt/Frame.html#setExtendedState%28int%29), 状态将在哪里[`JFrame.MAXIMIZED_BOTH`](http://docs.oracle.com/javase/6/docs/api/java/awt/Frame.html#MAXIMIZED_BOTH)。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-07-20T02:32:53.380

一种方法是使用扩展状态。这要求底层操作系统最大化 JFrame。

```
setExtendedState(getExtendedState() | JFrame.MAXIMIZED_BOTH); 
```

其他方法是根据您的要求手动最大化屏幕。

```
Dimension dim = Toolkit.getDefaultToolkit().getScreenSize();
setBounds(100, 100, (int) dim.getWidth(), (int) dim.getHeight());
setLocationRelativeTo(null); 
```

但这在 Ubuntu 操作系统中存在缺陷。我发现的解决方法是这样的。

```
if (SystemHelper.isUnix()) {
    getContentPane().setPreferredSize(
    Toolkit.getDefaultToolkit().getScreenSize());
    pack();
    setResizable(false);
    show();

    SwingUtilities.invokeLater(new Runnable() {
        public void run() {
            Point p = new Point(0, 0);
            SwingUtilities.convertPointToScreen(p, getContentPane());
            Point l = getLocation();
            l.x -= p.x;
            l.y -= p.y;
            setLocation(p);
        }
    });
}

Dimension dim = Toolkit.getDefaultToolkit().getScreenSize();
setBounds(100, 100, (int) dim.getWidth(), (int) dim.getHeight());
setLocationRelativeTo(null); 
```

在 Fedora 中不存在上述问题。[但是Gnome](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CFgQFjAA&url=http://www.gnome.org/&ei=O8MIULiKBsqfiQeI-u30CQ&usg=AFQjCNF2ZWwZveprRZtBNuoIBfzW-AuD1A&sig2=q6o5-IXrVzgM_jqYR2p_ig)或[KDE](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&sqi=2&ved=0CFUQFjAA&url=http://www.kde.org/&ei=IcMIUKXtJoeiiAfIjPHeCQ&usg=AFQjCNG3NyABb3lRUA8yy_AK4IS1RiRemw&sig2=DqDUGJf4O22dp34VO0r8YQ)存在一些并发症。所以最好小心点。希望这可以帮助。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2016-01-30T23:40:13.867

有史以来最简单的修复：

```
for ( Window w : Window.getWindows() ) {
    GraphicsEnvironment.getLocalGraphicsEnvironment().getDefaultScreenDevice().setFullScreenWindow( w );
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2012-11-07T22:59:34.960

只需使用此代码：

```
import java.awt.event.*;
import javax.swing.*;

public class FullscreenJFrame extends JFrame {
    private JPanel contentPane = new JPanel();
    private JButton fullscreenButton = new JButton("Fullscreen Mode");
    private boolean Am_I_In_FullScreen = false;
    private int PrevX, PrevY, PrevWidth, PrevHeight;

    public static void main(String[] args) {
        FullscreenJFrame frame = new FullscreenJFrame();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setSize(600, 500);
        frame.setVisible(true);
    }

    public FullscreenJFrame() {
        super("My FullscreenJFrame");

        setContentPane(contentPane);

        // From Here starts the trick
        FullScreenEffect effect = new FullScreenEffect();

        fullscreenButton.addActionListener(effect);

        contentPane.add(fullscreenButton);
        fullscreenButton.setVisible(true);
    }

    private class FullScreenEffect implements ActionListener {
        @Override
        public void actionPerformed(ActionEvent arg0) {
            if (Am_I_In_FullScreen == false) {
                PrevX = getX();
                PrevY = getY();
                PrevWidth = getWidth();
                PrevHeight = getHeight();

                // Destroys the whole JFrame but keeps organized every Component
                // Needed if you want to use Undecorated JFrame dispose() is the
                // reason that this trick doesn't work with videos.
                dispose();
                setUndecorated(true);

                setBounds(0, 0, getToolkit().getScreenSize().width,
                        getToolkit().getScreenSize().height);
                setVisible(true);
                Am_I_In_FullScreen = true;
            } else {
                setVisible(true);
                setBounds(PrevX, PrevY, PrevWidth, PrevHeight);
                dispose();
                setUndecorated(false);
                setVisible(true);
                Am_I_In_FullScreen = false;
            }
        }
    }
} 
```

我希望这有帮助。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-09-17T15:54:42.547

它将帮助您使用框架的即时对象

`frame.setExtendedState(JFrame.MAXIMIZED_BOTH);`

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-02-10T00:29:05.740

首先，这是您要使用的分辨率，`1650,1080`.

现在添加：

```
frame.setExtendedState(JFrame.MAXIMIZED_BOTH); 
```

如果您对 JFrame 上的组件有疑问，则在使用该`frame.add(component)`方法添加所有组件后，添加以下语句。

```
frame.pack(); 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-04-30T15:18:16.340

你只需要这个：

```
JFrame frame = new JFrame();
frame.setExtendedState(JFrame.MAXIMIZED_BOTH);
frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
frame.setVisible(true); 
```

当您使用 MAXIMIZED_BOTH 修饰符时，它将在整个窗口（高度和宽度）中一直保持最大值。

有一些建议使用这个：

```
frame.setUndecorated(true); 
```

我不会推荐它，因为您的窗口没有标题，因此没有关闭/恢复/最小化按钮。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2019-05-09T08:35:27.980

```
JFrame frame = new JFrame();
frame.setPreferredSize(new Dimension(Toolkit.getDefaultToolkit().getScreenSize())); 
```

这只是使框架成为屏幕的大小

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-12-26T17:00:04.567

您可以使用属性工具。*为您的JFrame*
设置 2 个属性：

 *```
extendedState 6
resizeable    true 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-11-18T03:53:21.313

我的意思是强调的价值观：

![JFrame - 属性](../Images/f8acd061b7197c1a4d021ba56340776e.png)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-02-10T07:01:58.773

你可以简单地这样做 -

```
public void FullScreen() {
        if (Build.VERSION.SDK_INT > 11 && Build.VERSION.SDK_INT < 19) {
            final View v = this.activity.getWindow().getDecorView();
            v.setSystemUiVisibility(8);
        }
        else if (Build.VERSION.SDK_INT >= 19) {
            final View decorView = this.activity.getWindow().getDecorView();
            final int uiOptions = 4102;
            decorView.setSystemUiVisibility(uiOptions);
        }
    } 
```

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2014-11-14T08:35:43.007

在下面设置 2 个属性：

1.  扩展状态 = 6
2.  可调整大小 = 真

这个对我有用。*

# jquery - 使用 this.securejson = true;

> ID：11570357
> 
> 赞同：2
> 
> 时间：2012-07-19T22:39:56.563
> 
> 标签：jquery, ajax, coldfusion, coldfusion-9

如果我放：

```
this.securejson = true; 
```

进入我的 Application.cfc，然后我的 $.ajax 函数调用不会回调 .done 函数。

如果我关闭securejson，它会起作用。

有没有一种已知的方法可以在 ajax 中使用securejson？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-19T22:57:57.953

`This.SecureJson`仅适用于内置 cfajax 功能 - 您需要禁用它才能与任何其他库一起使用。

有关更多信息，请参阅[Pete Freitag 的“ColdFusion 中的前缀序列化 JSON”](http://www.petefreitag.com/item/720.cfm)

有关解决方法，请参阅[Chris.m0nk3y 的“在运行时禁用 secureJson 前缀”](http://chris.m0nk3y.net/blog/post/disabling-securejson-prefix-at-runtime) - 他建议`getPageContext().getFusionContext().setSecureJSON(boolean)`根据需要使用它来打开/关闭它。

# database - 用户登录多个数据库

> ID：11570363
> 
> 赞同：0
> 
> 时间：2012-07-19T22:40:28.210
> 
> 标签：database, login

我正在创建一个具有多个数据库的应用程序。每个用户都有自己的数据存储在远程或本地数据库服务器上。我想知道如何使用一个登录表单为所有用户管理登录过程。拥有一个包含用户电子邮件/密码和其他客户端信息（如数据库服务器 ip、数据库密码、数据库名称、应用程序位置...）的“登录”数据库是否是一种好方法，并且在成功登录后，然后连接到包含应用程序/客户端数据的用户数据库？还是有其他方法可以处理？

# ruby-on-rails - 如何从炼油厂cms 菜单中删除特定的引擎页面和引擎菜单项？

> ID：11570364
> 
> 赞同：0
> 
> 时间：2012-07-19T22:40:27.153
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, refinerycms

我在refinerycms 中创建了一个引擎，我将数据拉到主页上。Refinerycms 自动为此引擎创建一个页面和一个菜单项。

如何删除引擎页面并将其从菜单栏中删除？

菜单.html.erb

```
<%
  # Collect the root items.
  # ::Refinery::Menu is smart enough to remember all of the items in the original collection.
  if (roots = local_assigns[:roots] || (collection ||= refinery_menu_pages).roots).present?
    dom_id ||= 'menu'
    css = [(css || 'menu clearfix')].flatten.join(' ')
    hide_children = Refinery::Core.menu_hide_children if hide_children.nil?
-%>
<div id="nav">
  <ul>
    <%= render :partial => '/refinery/menu_branch', :collection => roots,
               :locals => {
                 :hide_children => hide_children,
                 :sibling_count => (roots.length - 1),
                 :menu_levels => local_assigns[:menu_levels],
                 :apply_css => true #if you don't care about class='first' class='last' or class='selected' set apply_css to false for speed.
               } -%>
  </ul>
</div>

<% end -%> 
```

menu_branch.html.erb

```
<%
  if !!local_assigns[:apply_css] and (classes = menu_branch_css(local_assigns)).any?
    css = "class='#{classes.join(' ')}'".html_safe
  end
-%>
<li<%= ['', css].compact.join(' ').gsub(/\ *$/, '').html_safe %>>
<%= link_to(menu_branch.title, refinery.url_for(menu_branch.url)) -%>
  <% if ( (children = menu_branch.children unless hide_children).present? &&
          (!local_assigns[:menu_levels] || menu_branch.ancestors.length < local_assigns[:menu_levels]) ) -%>
    <ul class='clearfix'>
      <%= render :partial => '/refinery/menu_branch', :collection => children,
                 :locals => {
                   :apply_css => local_assigns[:apply_css],
                   :hide_children => !!hide_children,
                   :menu_levels => local_assigns[:menu_levels]
                 } -%>
    </ul>
  <% end -%>
</li> 
```

我特别想从菜单栏中删除的菜单项是“新程序”

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-26T08:36:50.603

最简单的方法是从控制台中删除页面：

*   在 rails 控制台输入：`bundle exec rails c`
*   找到要删除的页面：`page = Refinery::Page.find("your-page-id")`
*   毁灭它 ：`page.destroy!`

请注意，“your-page-id”应替换为您的页面 id ;)，当您在前端或后端访问此页面时，您可以在 URL 中看到它。

我们也使用该`destroy!`方法，因为默认情况下，此页面设置为不可删除。

最后，您可以通过编辑引擎的种子文件来阻止创建此页面。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-30T18:45:35.633

我终于发现，在 Refinerycms 中编辑页面时，如果单击高级选项，则有一个复选框，用于选择是否将页面包含在公共菜单中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-02T07:58:41.930

您还可以在生成引擎时添加 skip-frontend 选项：

```
rails generate refinery:engine NAME [field:type field:type] --skip-frontend 
```

# jasper-reports - iReport 4.5：带有子数据集问题的填充表

> ID：11570365
> 
> 赞同：0
> 
> 时间：2012-07-19T22:40:34.660
> 
> 标签：jasper-reports, ireport

好的，这就是交易。我正在尝试通过以下方式进行报告：

*   一个主查询，它将用 mysql 数据库中的一些详细信息填充我的大部分报告。
*   一个带有自己查询的子数据集，它将用其他数据库表中的一些项目填充报表中的表。

主查询工作正常，报告得到正确的数据。但是，应该填充表的子数据集实际上用所有 NULL 值填充它。当我在 mysql 中执行相同的查询时，我得到了正确的结果，但在 iReport 中，我得到的只是 NULL 值（对于每一列）。

我使用了以下程序：

*   主查询包含输入参数、命名等。 Main_ID;
*   我设计了一个在 where 子句中使用输入参数的主查询。
*   主查询运行良好，报告得到了良好的结果。
*   然后，我将表格添加到我的报告中。在向导中，我专门为给定的表创建了一个新数据集。在数据集中，我使用输入参数，命名等设计查询。
*   完成向导后，我右键单击表，然后选择编辑表数据源。在对话框顶部，我选择刚刚创建的数据集。
*   然后我转到参数选项卡，然后单击添加。从下拉列表中选择 Sub_ID，对于值表达式我设置 $P{Main_ID}，因为我将在子数据集中的 where 子句中使用相同的输入参数。

单击“确定”并尝试预览报告后，正如我在开头所说的那样，我在表中获得了所有 NULL 值。我试图找到解决方案，但到目前为止，没有任何在线参考资料有帮助。

如果有人有想法，我将不胜感激。

干杯!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T11:14:27.393

嗨，索科洛维奇，

```
 Can you please check the report connection you are using to connect your main report with your Table data set ? 
```

我也遇到了同样的问题，更改报告连接对我有用。

# apache - Apache mod_rewrite 不会从文件夹中读取

> ID：11570366
> 
> 赞同：1
> 
> 时间：2012-07-19T22:40:35.837
> 
> 标签：apache, .htaccess, mod-rewrite, redirect

```
RewriteEngine On
RewriteBase /city_name

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)/$ /city_name/index.php?page=$1 [L] 
```

所以我有这个工作，所以如果我这样做`domain.com/calgary/`，它将正确地从数据库中读取。

但是，如果我这样做，则该文件夹无法正确读取，因为即使它是虚拟目录，`domain.com/calgary/test.php`它也认为文件在其中。`/calgary/`

所以我可能在文件夹中的`.htaccess`目录中寻找帮助，`/city_name/`以便它`.php`从`/city_name/`目录而不是`/calgary/`（虚拟）读取文件

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T23:49:38.123

尝试添加这些规则：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} /([^\./]+)\.php$
RewriteCond %{DOCUMENT_ROOT}/city_name/%1.php -f
RewriteRule ^(.*)/([^\./]+)\.php$ /city_name/$2.php?page=$1 [L] 
```

# jquery - 改变手风琴行为

> ID：11570367
> 
> 赞同：1
> 
> 时间：2012-07-19T22:40:36.900
> 
> 标签：jquery, html

我使用了一个名为 tinyAccordion 的小插件，我想改变它的行为，但我这样做只是为了自学一些手风琴技能，而我对如何改变它一无所知，所以手风琴一次只打开一个标签。为了澄清，如果您打开另一个选项卡，打开的选项卡将关闭。

我有以下代码：

```
 <script type="text/javascript">

    var parentAccordion=new TINY.accordion.slider("parentAccordion");
    parentAccordion.init("acc","h6",0,0);

    var nestedAccordion=new TINY.accordion.slider("nestedAccordion");
    nestedAccordion.init("nested","h6",0,0,"acc-selected");

    </script> 
```

这是 jsfiddle 链接：http: [//jsfiddle.net/LQsV5/](http://jsfiddle.net/LQsV5/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T23:00:01.570

您不需要插件，只需尝试我为您写的这几行：

## *[jsFiddle 演示](http://jsfiddle.net/LQsV5/2/)*

```
$('.acc li h3').next('.acc-section').hide();
$('.acc li h3').click(function() {
    var el = $(this).next('.acc-section');
    check = (el.is(':visible')) ? el.slideUp() : ($('.acc-section').slideUp()) (el.slideDown());
}); 
```

它将隐藏已打开的选项卡，但如果再次单击也会隐藏打开的选项卡。
如果你有问题，只是问！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-22T22:52:47.827

改变

```
parentAccordion.init("acc","h6",0,0); 
```

&

```
nestedAccordion.init("nested","h6",0,0,"acc-selected"); 
```

至

```
parentAccordion.init("acc","h6",1,0); 
```

&

```
nestedAccordion.init("nested","h6",1,0,"acc-selected"); 
```

# image - 访问 2010 查询结果，旁边有图像

> ID：11570368
> 
> 赞同：0
> 
> 时间：2012-07-19T22:40:37.597
> 
> 标签：image, ms-access-2010

我有一个返回项目列表的查询。我想要的是能够在带有图像（绿色/红色圆圈）的表单上显示它，以指示该项目是否正常工作。我不确定这是可能的，但如果是的话，我会很感激一个指针。

表格示例：

（绿色）卡车1
（绿色）卡车2
（红色）卡车3
（红色）汽车1
（绿色）汽车2

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T22:41:53.747

您可以将文本框的内容设置为侧翼并编码颜色。在 Access 2010 中，您可以将切换按钮的颜色设置为一种颜色，如果切换绑定到 YesNo 数据类型，则颜色会很好地改变。

1.  根据相关查询创建一个连续表单。我将假设 Working 是一个 YesNo 字段。

2.  在合适的位置添加一个文本框，并将控制源设置为`="n"`

3.  设置文本框字体为WebDings，设置字体颜色为红色

4.  右键单击并选择条件格式：

![条件格式](../Images/5570d70e751f8a348550ba80c5429fbc.png)

如您所见，我选择`Expression Is`并输入了 YesNo 字段的名称。然后我选择了绿色的字体颜色。

**结果**

![小彩色标记](../Images/31cd6257164263234b4e56e6bb160794.png)

# macos - 编译程序集 OSX (10.6.8)

> ID：11570379
> 
> 赞同：1
> 
> 时间：2012-07-19T22:41:10.497
> 
> 标签：macos, gcc, assembly, gnu-assembler

我决定学习一些组装，但是我无法弄清楚如何实际组装它。我正在运行安装了开发工具的 OSX 10.6.8。我正在运行 Xcode 3.13，在我看到的版本的首选项中没有下载选项卡，并且从 Apple 网站下载的命令行工具不会在低于 10.7 的任何版本上运行。

我看到一些在线资源说我应该使用“as”“gas”或“gcc”命令，但是终端告诉我这些命令都不存在。（为了测试，我只是打开了一个新的终端窗口并输入了不带参数的命令名称。我认为这会起作用，但我可能会弄错。）我找不到任何关于这些东西是否与开发人员一起安装的具体文档工具/如何检查是否已安装/安装位置。

在这里问这个问题是我最后的手段，但是我确信信息已经在那里，我只是找不到它，所以如果有人可以的话：

*   解释为什么这些命令不起作用/如果我想组装一些基本程序集我应该安装什么
*   告诉我我怎么能自己解决这个问题

我会很感激的。提前致谢。

[编辑] Developer/usr/bin/ 文件夹中有一个名为“as”的文件，所以我不确定为什么找不到该命令。除了导航到我正在组装的文件的目录并键入“作为文件名”之外，我还需要做更多的事情吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T00:50:16.127

当您安装 Xcode 时，您想检查“UNIX 开发”。（你当时怎么知道的？）

你可以重新安装 Xcode，确保选中那个魔法框。

但是，命令行驱动程序*实际上*是存在的，它们只是不在您的路径中（`/Developer/usr/bin`如果我没记错的话，它们在 . 因此，您应该能够将其添加到`$PATH`并使用它们。

作为第三种选择，您始终可以下载`gcc`或的发行版`clang`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T23:42:04.693

确保您已安装 Xcode“命令行工具”附加下载。它位于 Xcode 首选项窗口的“下载”选项卡中。

# jquery - jQuery Cycle 永久链接不起作用，总是转到第一张幻灯片

> ID：11570380
> 
> 赞同：0
> 
> 时间：2012-07-19T22:41:27.040
> 
> 标签：jquery, anchor, cycle, permalinks

我有循环生成锚链接，它在幻灯片页面中工作正常。但是，从另一个页面链接到它们并不完全有效。他们总是转到组的第一张幻灯片，而不是由 url 哈希定义的幻灯片。这是我的代码：

```
$(function() {
$('#cms').cycle({
    fx:  'fade',
    speed:  'fast',
    pager:  '#nav',
    pagerAnchorBuilder: function(idx, slide) { 
        return '<li><a href="#' + slide.title + '">' + slide.title + '</a></li>';
    }, 
    timeout: 0,
    after: function(curr,next,opts) {
        window.location.hash =  $(this).attr('title');
    }
    });
}); 
```

和相关的HTML：

```
<div id="nav"></div>
<div id="cms">  
<div title="About"><?php include 'about.php' ?></div>
<div title="Music"><?php include 'music.php' ?></div>
<div title="Shows"><?php include 'shows.php' ?></div>
</div> 
```

基本上，如果我链接到（或打开一个新的浏览器选项卡并输入）“http://path/to/my/page/#Music”或#Shows，它只会转到#About。

我知道我在这里遗漏了一些东西，但我不确定是什么

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T18:15:08.777

Malsup 在[jQuery 论坛上](http://forum.jquery.com/topic/malsup-cycle-restarts-goto-doesn-t-work)发布了一个可能是问题的答案。cycle lite 不支持大多数“goto”类型的功能。你必须有完整的插件。

# sockets - Chrome 实验性 Socket API：`chrome.experimental.socket.sendTo()` 和 `recvFrom()` 有什么作用？

> ID：11570382
> 
> 赞同：1
> 
> 时间：2012-07-19T22:41:28.507
> 
> 标签：sockets, google-chrome, tcp, google-chrome-extension, chromium

本周，我稍微弄乱了 Chromium 的 Socket API。但是对于这个记录不良的实验界面，我并不是很清楚。

## Google Code 上的[文档](http://code.google.com/chrome/extensions/trunk/experimental.socket.html)是怎么说的：

......关于`sendTo()`此刻：

> 在给定的套接字上写入数据。
> 
> 1.  ***`socketId ( integer )`***套接字标识符。
>     
>     
> 2.  ***`data ( ArrayBuffer )`***要写入的数据。
>     
>     
> 3.  ***`address ( string )`*** 远程机器的地址。
>     
>     
> 4.  ***`port ( integer )`***远程机器的端口。
>     
>     
> 5.  ***`SendToCallback ( function )`***

但是 的描述与( *- Writes data on the given socket.* )`sendTo()`的描述完全相同。和- 两者的描述完全相同（*- 从给定套接字读取数据。/ - 从给定套接字*读取*数据。*）。**但是没有人对这些差异**说任何有趣的事情。`write()`*`write`*`recvFrom()``read()`*`read`**`recvFrom`*

 **## 我发现了什么：

不管我在做什么，`sendTo`总是返回以下对象：

> *   **[-]** *对象*
>     *   `bytesWritten`：`-2`
>     *   **[+]** `__proto__` :*对象*

如果我在所有这些情况下都使用`write`而不是`sendTo`，一切都会按预期发生。

`recvFrom()`与`read()`-相同，`read()`按预期工作但`recvFrom()`失败。

## 我的问题：

*   和和有什么`sendTo()`区别？`write()``sendTo()`
*   和和有什么`recvFrom()`区别？`read()``recvFrom()`
*   为什么有这么多类似的方法？
*   **并且：**还有关于 Socket API 的**更多信息吗？**Google 代码文档非常轻量级。没有`chromium.org`相关的文章吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T17:01:59.053

为混乱道歉。我们正在根据您的问题[对文档进行改进。](https://chromiumcodereview.appspot.com/10796067/)

Chrome 套接字 API 是 POSIX 套接字 API 子集之上的一个薄层。它遵循 read()/write() 用于连接的套接字，而 sendto()/recvfrom() 用于未连接的套接字的约定。冒着过度简化的风险，您可能希望将前者用于面向连接的协议 (TCP)，而将后者用于无连接协议 (UDP)。[在关于 UDP 的 Wikipedia 文章](http://en.wikipedia.org/wiki/User_Datagram_Protocol#Comparison_of_UDP_and_TCP)中，对为什么选择 TCP 与 UDP 进行了很好的比较。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-20T01:29:07.640

我对套接字知之甚少，但我认为文档混淆了，当从浏览器启动连接时使用 sendTo （或者可能反过来，当客户端启动套接字时应该使用另一个）连接到浏览器，但我在任何地方都看不到任何 SocketServer 支持，所以......无论如何）。从[源代码](http://code.google.com/codesearch#wZuuyuB8jKQ/chromium/src/chrome/common/extensions/api/experimental_socket.idl&q=SendToCallback&type=cs)（查看参数）：

*   **写（）**

    ```
     // Writes data on the given socket.
      // |socketId| : The socketId.
      // |data| : The data to write.
      // |callback| : Called when the first of any of the following happens: the
      // write operation completes without blocking, the write operation blocked
      // before completion (in which case onEvent() will eventually be called with
      // a <code>writeComplete</code> event), or an error occurred.
      static void write(long socketId,
                        ArrayBuffer data,
                        WriteCallback callback); 
    ```

*   **发送至（）**

    ```
     // Writes data on the given socket.
      // |socketId| : The socketId.
      // |data| : The data to write.
      // |address| : The address of the remote machine.
      // |port| : The port of the remote machine.
      // |callback| : Called when the first of any of the following happens: the
      // write operation completes without blocking, the write operation blocked
      // before completion (in which case onEvent() will eventually be called with
      // a <code>writeComplete</code> event), or an error occurred.
      static void sendTo(long socketId,
                         ArrayBuffer data,
                         DOMString address,
                         long port,
                         SendToCallback callback); 
    ```

您可以在我给您的链接（experimental_socket.idl）中找到其余的文档。**

# asp.net - 模拟登录表单到不同站点的发布

> ID：11570386
> 
> 赞同：1
> 
> 时间：2012-07-19T22:41:48.293
> 
> 标签：asp.net, vb.net, jsp, login

我的任务是从一个交换机类型的站点集成一大堆网站。我正在使用 VB 作为背后代码使用 asp.net 构建的网站。我们有一个站点，我正在尝试将登录凭据传递给我遇到问题的站点。我不熟悉外部站点的构建方式，但能够找到具有登录表单的 login.jsp 文件。

所以我试图做的是从这个外部站点的登录表单中获取操作 URL，然后尝试使用该 URL，并将登录凭据添加到我的站点的 URL 字符串的末尾。URL 看起来像这样：

[http://www.oursite.com/Controller?ACTION=COMPOST&POSTMANAGER=LOGON&POSTOPERATION=LOGON&ERRORJSP=login.jsp&MANAGER=ENTRANCE&OPERATION=GETHOMEPAGE&JSP=dynamic.jsp&UserName=user1&Password=password1](http://www.oursite.com/Controller?ACTION=COMPOST&POSTMANAGER=LOGON&POSTOPERATION=LOGON&ERRORJSP=login.jsp&MANAGER=ENTRANCE&OPERATION=GETHOMEPAGE&JSP=dynamic.jsp&UserName=user1&Password=password1)

我通过后面的代码使用用户凭据动态构建此 URL，并将其设置为我的链接的 HREF。

当我第一次单击此链接时，从我的网站将我带到另一个网站，但没有登录。但是，如果我点击后退箭头并再次单击该链接，那么我将被带到另一个网站这次我确实自动登录了。有谁知道为什么这样的事情在我第一次点击链接时可能不起作用，但第二次起作用？

有没有人对我如何处理这个问题有任何其他建议？我尝试了一个 httpwebrequest，但这并没有将我重定向到该站点，我需要确保我不仅传递了凭据，而且将用户带到了下一个站点。

谢谢，乔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T22:48:35.543

可能是第一次尝试为您创建会话/cookie，并且代码运行速度太快而无法登录。但是当返回然后返回此页面时，先前创建的 cookie//session 是他们的，它成功登录

为什么建议是检查它在您的第一步创建的 cookie 等，然后将 ti 与您的第二步进行比较

# c++ - windows CopyFile 的正确输入格式是什么？

> ID：11570395
> 
> 赞同：0
> 
> 时间：2012-07-19T22:43:00.413
> 
> 标签：c++, windows, winapi

我正在尝试使用 windows CopyFile 功能复制一个文件并将其重命名为另一个文件夹中的另一个文件。然而，即使我给它的路径是正确的并且文件和文件夹都存在，它总是返回路径有问题。我究竟做错了什么？

使用“C:\Dummy.png”作为源，使用“C:\Dest”作为目标。

```
void CreateDummyItemsAssetsPNG()
{
    string  DummyAsset;  
    string  dummyDestination; 

    cout<<"Please Provide dummy file asset that is a .png: "; 
    cin>>DummyAsset; 

    cout<<"Please Provide a Destination: "; 
    cin>>dummyDestination; 

    vector<string>::iterator itor; 
    string fullDest; 

    for(itor = listOfItems.begin(); itor<listOfItems.end(); ++itor)
    {
        fullDest.clear(); 
        fullDest = dummyDestination + "\\"+ (*itor)+".png"; 
        cout<<"Copy: "<<DummyAsset<<" TO: "<<fullDest<<endl; 
        if(!CopyFile(LPCTSTR(DummyAsset.c_str()),LPCTSTR(dummyDestination.c_str()),false) )
        {
            printf("Could not copy file.\n"); 
            cout<<GetLastError()<<endl; 
        }
    }
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T22:46:11.507

`CopyFile()`需要一个文件*名*作为第二个参数，而您只传递目标*目录*。指定全名（您似乎在 中所做的`fullDest`），这应该可以。

# ajax - jquery 代码可以正常工作，除非在颜色框中。我该如何解决？

> ID：11570399
> 
> 赞同：0
> 
> 时间：2012-07-19T22:43:23.100
> 
> 标签：ajax, jquery, colorbox

我有一些代码使用 jquery 将搜索结果加载到同一页面上。在独立页面上运行时它工作正常。当加载到颜色框窗口中时，相同的代码中途失败。我怎样才能解决这个问题？

这是在独立页面上运行良好但在颜色框窗口中失败的代码。

```
<script>
  $('button.trigger').on('click', function(){
    $mybtn = $(this);
    $mybtn.text('Searching...').addClass('disabled');
    $.post(
      '/results/people?layout="no"',
      $('#find_or_add_person').serialize(),
      function(data){
        $('#response').html(data);
        $mybtn.text('Search').removeClass('disabled').removeClass('btn-primary');
      }
    );
    return false; 
  });
</script> 
```

注意：将按钮文本设置为“正在搜索”并禁用按钮后，它会失败。

这是调用颜色框的代码。

```
<script>
    $('a.add').colorbox({
          width:440,
            height:400,
            onComplete: function(){
                    $('#colorbox').css('display', 'block');
              }
    });
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T23:57:12.457

我找到了答案——很偶然。事实证明，标签的奇怪 HTML 排序是罪魁祸首。

具体来说，在我加载到颜色框窗口的 HTML 中，我打开了一个 div 标签，然后打开了 form 标签，然后在关闭 form 标签之前关闭了 div 标签。无论出于何种原因，当我将该页面用作独立页面时，我的这种奇怪行为并没有引起任何问题。然而，它搞砸了我的一些水豚测试。在解决水豚问题时，我修复了标签排序和中提琴！页面立即开始在颜色框窗口中工作。

我永远不会猜到。最终我不明白导致这种奇怪行为的潜在机制，但我很高兴它得到了解决。

# javascript - 防止后退按钮上的 hashchange

> ID：11570406
> 
> 赞同：2
> 
> 时间：2012-07-19T22:44:00.830
> 
> 标签：javascript, jquery, backbone.js

我有一个使用骨干哈希路由的应用程序。当页面重新加载时，我使用该`onbeforeunload`事件告诉用户有未保存的更改并阻止页面加载。这不适用于哈希更改；因此，如果用户按下回，对话框不会告诉他们有未决的更改而只是返回。

有没有办法检测散列变化并防止它发生？就像是`onbeforehashchange`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T22:53:40.720

不，您可以通过以下方式检测到 hashchange，但在它发生之前您无法真正检测到它。如果您在更改之前需要哈希，您可以将其存储在某个地方。

```
var myHash = document.location.hash;

$(document).on('hashchange', function() {
    if (myHash != document.location.hash) {
        //do something
    }
}); 
```

你也不能真正检测到后退按钮，如果它没有触发重新加载，`onbeforeunload`也不会工作。

如果此功能必不可少，您应该考虑尝试使用[haschange 插件](https://github.com/cowboy/jquery-hashchange)或[history 插件](http://tkyk.github.com/jquery-history-plugin/)，因为其中之一会使这变得更容易，并让您控制浏览器历史记录和来回。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T00:58:19.970

我最终在我的路由器中创建了一个功能。这在每条路线之前运行并提出一个 jquery ui 对话框并等待回复以运行路线。这是相当混乱的代码，我去掉了应用程序特定的东西。

```
close: function(callback) {
    var hash = window.location.hash;

    if (this.afterHash && this.afterHash == hash) {
        this.dialog.dialog("close");
        return;
    }

    callback = callback || function () {};
    if (window.onbeforeunload) {
        var text = window.onbeforeunload();
        if (text) {
            if (!this.dialog) {
                var t = this;
                this.afterHash = this.previous;
                this.dialog = $("<div><p>" + text + "</p><p>Are you sure you want to close the dialog?</p></div>").dialog({
                    modal: true,
                    width: 420,
                    title: "Confirm Navigation",
                    close: function() {
                        t.dialog.dialog("destroy");
                        if (t.afterHash) {
                            t.navigate(t.afterHash, {
                                trigger: false
                            });
                            t.afterHash = null;
                        }
                        t.dialog = null;
                    },
                    buttons: {
                        'Leave this Page': function() {
                            t.afterHash = null;
                            t.dialog.dialog("close");

                            closeViewer();
                            callback.apply(t);
                        },
                        'Stay on this Page': function() {
                            t.dialog.dialog("close");
                        }
                    }
                });
            }
            return;
        }
    }
    this.previous = window.location.hash;
    callback.apply(this);
},​ 
```

在初始化时，您必须添加`this.previous = window.location.hash;`

# php - MySQLi 程序查询不工作

> ID：11570409
> 
> 赞同：0
> 
> 时间：2012-07-19T22:44:25.470
> 
> 标签：php, mysqli

此查询不更新数据库中的行。

```
$link = mysqli_connect("localhost", "username", "password", "database");
mysqli_query("UPDATE `LOGIN` SET `HASH`='$hash' WHERE `USER`='$user'"); 
```

它根本不会更新行中的哈希。我检查了 PMA 中的查询，它似乎运行正常。我已经在屏幕上回显了我的 $hash 和 $user 变量，以确保它们是有效的，而且它们确实有效。mysqli_connect 凭据也正确...任何输入？

我也将它添加到 mysqli_query 上，它只是打印出“错误描述：”，因为我相信我的服务器有错误关闭。

```
or die("Error desc: ".mysqli_error($link)); 
```

感谢您的任何帮助！

编辑：该表有大约 3 条记录，所以这里没有重复的问题。此外，在任何人提到它之前，我将为每个用户添加一个主键到表中，一旦我弄清楚发生了什么，我会将 mysqli 切换到 OO 样式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T22:55:22.357

alfasin 在评论中写道使用 bind_param (http://www.php.net/manual/en/mysqli-stmt.bind-param.php)

效果很好。它对 OO 和程序都有好处。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-19T23:04:30.960

$link = mysqli_connect("localhost", "username", "password", "database"); $result = mysqli_query($link, "UPDATE `LOGIN`SET `HASH`='$hash' WHERE `USER`='$user'");

# powershell - PS Remoting 失败：必须信任计算机才能进行委派，并且必须将当前用户帐户配置为允许委派。”

> ID：11570410
> 
> 赞同：1
> 
> 时间：2012-07-19T22:44:44.513
> 
> 标签：powershell, powershell-2.0, powershell-remoting

我在远程机器上加密/解密时遇到了一些问题。例如：当我运行以下命令时，出现以下错误。

谁能知道如何解决这个问题？

```
[remote machine]: PS C:\> Add-Type -assembly System.Security
[remote machine]: PS C:\> $passwordBytes = [System.Text.Encoding]::Unicode.GetBytes("Password!")
[remote machine]: PS C:\> $entropy = [byte[]](1,2,3,4,5)
[remote machine]: PS C:\> $encrytpedData = [System.Security.Cryptography.ProtectedData]::Protect($passw
ordBytes, $entropy, "CurrentUser")
Exception calling "Protect" with "3" argument(s): "The requested operation cannot be completed. The computer must be tr
usted for delegation and the current user account must be configured to allow delegation.
"
At line:1 char:71
+ $encrytpedData = [System.Security.Cryptography.ProtectedData]::Protect <<<< ($passwordBytes, $entropy, "CurrentUser")
    + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException
    + FullyQualifiedErrorId : DotNetMethodException 
```

问候， 纳雷什

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T04:06:37.717

您可以查看Bruce Payette 好书第 13 章中的[在多跳环境中转发凭据。](http://www.manning.com/payette2/SampleCh-13.pdf)

您可能需要 CredSSP 机制，该机制使您能够通过受信任的中介将您的凭据安全地传递给目标机器。

# c# - 在 C# 中查找 datagridview 单元格类型？

> ID：11570411
> 
> 赞同：1
> 
> 时间：2012-07-19T22:44:45.953
> 
> 标签：c#, winforms, datagridview, visual-c#-express-2010

我正在尝试查找每个 DatagridviewImageCell 并将其属性设置`ImageLayout`为`DataGridViewImageCellLayout.Zoom`以便缩放该单元格中的图像。我正在使用此代码，但出现错误：`Unable to cast object of type 'System.Windows.Forms.DataGridViewRow' to type 'System.Windows.Forms.DataGridViewImageCell'.`here: `(DataGridViewImageCell Imgrow in dataGridView1.Rows`。这是我正在使用的代码。

```
 foreach (DataGridViewImageCell Imgrow in dataGridView1.Rows)
                {                       
                    if (dataGridView1.Rows[a].Cells[1].Value == "Image")
                    {
                        Imgrow.ImageLayout = DataGridViewImageCellLayout.Zoom;
                    }
                } 
```

我如何解决它？此外，该列是一个 texbox 列，但我正在使用它来替换单元格。

```
int a = 0;
dataGridView1.Rows.Insert(0, 1);
dataGridView1.Rows[a].Cells["Column1"] = new DataGridViewImageCell();
dataGridView1.Rows[a].Cells["Column1"].Value = picturebox1.Image; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T22:53:30.280

您需要使用行对象遍历行，然后使用单元格对象遍历单元格。

像这样的东西：

```
foreach (DataGridViewRow dr in dataGridView1.Rows) {
  foreach (DataGridViewCell dc in dr.Cells) {
    if (dc.GetType() == typeof(DataGridViewImageCell)) {
      ((DataGridViewImageCell)dc).ImageLayout = DataGridViewImageCellLayout.Zoom;
    }
  }
} 
```

# java - 在 Java 中绘制位图

> ID：11570415
> 
> 赞同：2
> 
> 时间：2012-07-19T22:45:32.627
> 
> 标签：java, swing, bitmap

我将很快开始一个项目，我将不得不在 JFrame 中的 .bmp/.jpg/.ps（其中任何一个）上绘制一些东西。

图片将显示地图，我将不得不在它们上生成一些点等。如何在 Java 中做到这一点？一般如何在Java中绘制图片？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T02:08:11.960

看看[ImageIO](http://docs.oracle.com/javase/6/docs/api/javax/imageio/ImageIO.html) api，它开箱即用地支持 JPEG、PNG、BMP、WBMP 和 GIF。您可以从[Advanced Image API](http://www.oracle.com/technetwork/articles/javaee/jai-142803.html)获得 TIFF 支持。

后期脚本支持有点棘手，但一些 PDF 渲染器实际上可以实现这一点（我使用这种方法来转换 illustrator 图像格式）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T22:54:47.337

网上有一些教程。看看这个网站上的代码清单 14.17： [Java ist auch eine Insel](http://openbook.galileodesign.de/javainsel5/javainsel14_008.htm#Rxx747java14008040004CF1F022100)
尽管文本是德语，但代码应该是可读的。希望它有助于迈出摇摆的第一步 :)

关于位图：我编写了自己的位图类来将 png 转换为 bmp，因为 BitmapFactory 和 co 对我不起作用。如果您需要它并且没有人有更好的类似“Java-API”的解决方案，您可以写信给我。

# java - 如何防止 Eclipse+Tomcat 运行当前类而不是项目（Vaadin）

> ID：11570418
> 
> 赞同：1
> 
> 时间：2012-07-19T22:45:44.027
> 
> 标签：java, eclipse, debugging, tomcat, vaadin

这很可能被证明是一个简单的配置更改，但我似乎无法找到一个明显的设置来解决以下问题：

我在 Eclipse 中有一个 Vaadin 项目，它被配置为使用 Tomcat v6 进行调试。如果我在项目资源管理器中选择项目的顶部并点击调试，Eclipse 浏览器将启动，我的 Web 应用程序将使用以下 url 打开：

`http://localhost:8080/MyVaadinProject/` **这行得通**

但是，如果我当前正在查看一个 java 文件（比如 Myproject.java），Eclipse 会尝试在此 url 打开 java 文件：

```
http://localhost:8080/MyVaadinProject/WEB-INF/classes/com/example/myproject/Myproject.java 
```

当然，这会产生 404。

每次我想调试时都必须取消选择/关闭我的 java 文件是非常乏味的。有什么方法可以防止日食中的这种行为吗？

我在 OSX Lion，Eclipse 版本 3.7.2。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-09T20:30:07.657

运行项目时，不要在项目资源管理器中突出显示类文件，而是在运行之前突出显示项目的基础。

无论如何，这是我们想要运行的，而不是类文件本身。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-03T08:23:46.213

去

Windows -> 首选项 -> 运行/调试 -> 启动

在底部，选择“始终启动以前启动的应用程序”。现在您只需在包资源管理器中单击您的项目名称并执行一次运行方式 -> 在服务器上运行一次。

启动后，您只需点击运行按钮，您的应用程序应始终按应有的方式启动。

# ios-provisioning - 团队管理员可以创建分发配置文件吗？还是只是团队代理？

> ID：11570419
> 
> 赞同：2
> 
> 时间：2012-07-19T22:45:49.710
> 
> 标签：ios-provisioning

从我在论坛上看到的情况来看，似乎只有**团队代理**可以看到 iOS 配置门户中的 Provisioning -> Distribution 选项卡。

但是......文档清楚地说明了其他情况，所以我很困惑。作为**团队管理员**，我应该能够看到分发选项卡吗？因此能够创建临时配置文件？还是文档有误，只有团队代理才能做到这一点？

[这是此Apple 文档](https://developer.apple.com/library/ios/#recipes/ProvisioningPortal_Recipes/CreatingaDistributionProvisioningProfile/CreatingaDistributionProvisioningProfile.html)的摘录，其中明确指出：

> 只有团队代理和**管理员**可以创建分发配置文件

但这里是分发选项卡的屏幕截图，我**无法**以团队管理员的身份看到（它根本不存在）：

![在此处输入图像描述](../Images/f46d274b9c9f1c5f122e344f6fb19a8e.png)

这是我是团队管理员的证明：

![在此处输入图像描述](../Images/cd3eaf652f53c1e67cfd12b1214fa248.png)

我要疯了吗？我应该就此向 Apple 提出罚单，还是文档不正确？

或者在我看到这个标签之前我需要做一些步骤？

希望有人知道答案！

欢呼，伸展

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T23:31:25.620

这是我的工作帐户。我是它的管理员，但不是代理。它与我在我作为代理的个人帐户上看到的屏幕相同。

![我是管理员但不是代理的我的 Works 帐户。](../Images/cbe9793cb812087788f1d9c014b23920.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T22:41:11.267

我向 Apple 登记了一张票 - 他们已经承认这是一个错误，他们正在调查它。

更新：苹果确实在几周后解决了这个问题。我接到了他们的几个电话，让我了解它的进展——对此印象深刻。

# javascript - javascript中的列排序与重复列

> ID：11570424
> 
> 赞同：0
> 
> 时间：2012-07-19T22:46:22.987
> 
> 标签：javascript, jquery, tablesorter

我需要一个可以处理重复列的 javascript 表格排序器。该表以多列布局，因为它太窄了。例如：

```
<table>
<thead>
  <tr> <th>name</th> <th>score</th>  <th>name</th> <th>score</th> </tr>
</thead>
<tbody>
<tr> <td> n1 </td> <td> 4 </td>    <td> n3 </td> <td> 2 </td> </tr>
<tr> <td> n2 </td> <td> 3 </td>    <td> n4 </td> <td> 1 </td> </tr>
</tbody>
</table> 
```

当单击分数标题之一时，我希望表格对两个分数列的分数进行排序。当然，名称也是如此。在我的实际应用程序中，我可能有 100 行，每行只有几个字符（2 列）宽，重组后的表可能只有 20 行（=> 10 列），因此更容易查看。

（实际上，我真正想要的是一个 html 表，它可以通过将长表和窄表拆分为宽表和短表来自动扩大自己，但这要求太多了。我不相信这存在。）

是否存在具有这种能力的 js（更好的是 jquery）tablesorter？

/iaw

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T23:08:14.590

嘿，我估计您正在寻找表格排序器插件来对列进行排序并**在此处查看工作演示：http:** [//jsfiddle.net/f9VvL/](http://jsfiddle.net/f9VvL/)

在给定的示例中，您可以单击分数，您可以看到正在发生的排序。

如果你热衷：[http ://tablesorter.com/docs/](http://tablesorter.com/docs/)

对于样式，您可以使用 css awesomne​​ss 来做到这一点；

希望这有助于原因`:)`

**脚本**

```
 <script type='text/javascript' src="http://mottie.github.com/tablesorter/js/jquery.tablesorter.js"></script>

  <script type='text/javascript' src="http://mottie.github.com/tablesorter/js/jquery.tablesorter.widgets.js"></script>

  <script type='text/javascript' src="http://mottie.github.com/tablesorter/addons/pager/jquery.tablesorter.pager.js"></script>

  <link rel="stylesheet" type="text/css" href="http://mottie.github.com/tablesorter/addons/pager/jquery.tablesorter.pager.css"> 
```

**代码**

```
$('table').tablesorter({
    // *** Appearance ***
    // fix the column widths
    widthFixed: false,
    // include zebra and any other widgets
    widgets: ['zebra'],
    // other options: "ddmmyyyy" & "yyyymmdd"
    dateFormat: "mmddyyyy",

    // *** Functionality ***
    // starting sort direction "asc" or "desc"
    sortInitialOrder: "asc",
    // These are detected by default,
    // but you can change or disable them
    headers: {
        // set "sorter : false" (no quotes) to disable the column
        0: { sorter: "text" },
        1: { sorter: "digit" },
        2: { sorter: "text" },
        3: { sorter: "url" }
    },
    // extract text from the table - this is how is
    // it done by default
    textExtraction: {
        0: function(node) {
            return $(node).text();
        },
        1: function(node) {
            return $(node).text();
        }
    },
    // forces the user to have this/these column(s) sorted first
    sortForce: null,
    // initial sort order of the columns
    // [[columnIndex, sortDirection], ... ]
    sortList: [],
    // default sort that is added to the end of the users sort
    // selection.
    sortAppend: null,
    // Use built-in javascript sort - may be faster, but does not
    // sort alphanumerically
    sortLocaleCompare: false,
    // Setting this option to true will allow you to click on the
    // table header a third time to reset the sort direction.
    sortReset: false,
    // Setting this option to true will start the sort with the
    // sortInitialOrder when clicking on a previously unsorted column.
    sortRestart: false,
    // The key used to select more than one column for multi-column
    // sorting.
    sortMultiSortKey: "shiftKey",

    // *** Customize header ***
    onRenderHeader: function() {
        // the span wrapper is added by default
        $(this).find('span').addClass('roundedCorners');
    },
    // jQuery selectors used to find the header cells.
    selectorHeaders: 'thead th',

    // *** css classes to use ***
    cssAsc: "headerSortUp",
    cssChildRow: "expand-child",
    cssDesc: "headerSortDown",
    cssHeader: "header",
    tableClass: 'tablesorter',

    // *** widget css class settings ***
    // column classes applied, and defined in the skin
    widgetColumns: {
        css: ["primary", "secondary", "tertiary"]
    },
    // find these jQuery UI class names by hovering over the
    // Framework icons on this page:
    // http://jqueryui.com/themeroller/
    widgetUitheme: {
        css: [
            "ui-icon-arrowthick-2-n-s", // Unsorted icon
            "ui-icon-arrowthick-1-s", // Sort up (down arrow)
            "ui-icon-arrowthick-1-n" // Sort down (up arrow)
        ]
    },
    // 
    widgetZebra: {
        css: ["even", "odd"]
    },

    // *** prevent text selection in header ***
    cancelSelection: true,

    // *** send messages to console ***
    debug: false

}).tablesorterPager({

    // target the pager markup - see the HTML block below
    container: $(".pager"),

    // use this format: "http:/mydatabase.com?page={page}&size={size}"
    // where {page} is replaced by the page number and {size} is replaced
    // by the number of records to show
    ajaxUrl: null,

    // process ajax so that the data object is returned along with
    // the total number of rows
    ajaxProcessing: function(ajax) {
        if (ajax && ajax.hasOwnProperty('data')) {
            // example ajax:
            // {
            //   "data" : [{ "ID": 1, "Name": "Foo", "Last": "Bar" }],
            //   "total_rows" : 100
            // }
            // return [ "data", "total_rows" ];
            return [ajax.data, ajax.total_rows];
        }
    },

    // output string - default is '{page}/{totalPages}';
    // possible variables:
    // {page}, {totalPages}, {startRow}, {endRow} and {totalRows}
    output: '{startRow} to {endRow} ({totalRows})',

    // apply disabled classname to the pager arrows when the rows at
    // either extreme is visible - default is true
    updateArrows: true,

    // starting page of the pager (zero based index)
    page: 0,

    // Number of visible rows - default is 10
    size: 10,

    // if true, the table will remain the same height no matter
    // how many records are displayed. The space is made up by an empty
    // table row set to a height to compensate; default is false
    fixedHeight: false,

    // remove rows from the table to speed up the sort of large tables.
    // setting this to false, only hides the non-visible rows; needed
    // if you plan to add/remove rows with the pager enabled.
    removeRows: false,

    // css class names of pager arrows
    cssNext: '.next',
    // next page arrow
    cssPrev: '.prev',
    // previous page arrow
    cssFirst: '.first',
    // go to first page arrow
    cssLast: '.last',
    // go to last page arrow
    cssPageDisplay: '.pagedisplay',
    // location of the "output"
    cssPageSize: '.pagesize',
    // dropdown that sets the "size" option
    // class added to arrows when at the extremes 
    // (i.e. prev/first arrows are "disabled" when on the first page)
    // Note there is no period "." in front of this class name
    cssDisabled: 'disabled'

});​ 
```

# python - 是否可以将字符串方法视为函数？

> ID：11570426
> 
> 赞同：2
> 
> 时间：2012-07-19T22:46:30.850
> 
> 标签：python, function, methods

是否可以为方法编写包装函数？

```
>>> lowtide = [ 'oh', 'i', 'do', 'like', 'to', 'be', 'beside', 'the', 'seaside' ]

>>> [ x.capitalize() for x in lowtide ]
['Oh', 'I', 'Do', 'Like', 'To', 'Be', 'Beside', 'The', 'Seaside']

>>> list(map(lambda x: x.capitalize(), lowtide))
['Oh', 'I', 'Do', 'Like', 'To', 'Be', 'Beside', 'The', 'Seaside']

>>> def mef(m):
...     def _mef(m,x):
...         return x.m()
...     return partial(_mef, m)
... 
>>> list(map(mef(capitalize), lowtide))

Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'capitalize' is not defined 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-19T22:47:40.157

你可以简单地做

```
list(map(str.capitalize, lowtide)) 
```

在 Python 3.x 中，`str.capitalize()`是一个采用单个参数的函数`self`。

在 Python 2.x 中，`str.capitalize()`是一种“未绑定方法”，但其行为类似于采用单个参数的函数。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-19T22:56:09.250

虽然您可以使用`str.capitalize`and `unicode.capitalize`，但如果您假设某种类型，这些可能会失败......最安全的方法是只使用：

```
from operator import methodcaller
capitalize = methodcaller('capitalize') 
```

这保证了对对象使用正确的方法，并且还允许成功完成鸭子类型。

**摘自我在 Google Groups/comp.lang.python 2010 年 8 月 23 日发布的帖子**

> 使用 methodcaller 允许您“保留” Python 的鸭子类型以及子类中的任何覆盖方法。在您的示例中，这可能是矫枉过正，因为您只处理一个类
> 
> 另一个（复杂的）示例：

```
class mystr(str):
    def lower(self):
        return self.upper()

>>> s = mystr('abc')
>>> s.lower()
'ABC'

>>> lower = methodcaller('lower')
>>> lower(s)
'ABC'

>>> str.lower(s)
'abc' 
```

> ^^^ 很可能不正确
> 
> 它还增加了一点灵活性（诚然，可以使用 functools.partial 进行模拟）：

```
split_tab = methodcaller('split', '\t')
split_comma = methodcaller('split', ',') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T22:51:06.537

这是您如何重写`mef`函数以使其正常工作的方法。这里使用的好处`str.capitalize`是它也适用于 Unicode 字符串以及 Python 2.x：

```
def mef(m):
    def _mef(x):
        return getattr(x, m)()
    return _mef

list(map(mef('capitalize'), lowtide)) 
```

请注意，这与使用`lambda x: x.capitalize()`.

# c# - 给定一个项目列表，每个项目都包含一个子项目，获取子项目并删除重复项

> ID：11570427
> 
> 赞同：1
> 
> 时间：2012-07-19T22:46:36.713
> 
> 标签：c#, linq, entity-framework-4

给定一个 groupos 列表，其中每个 groupo 有一个 empresa，多个 groupos 可以有相同的 empresa，你如何获得包含列表中任何 groupos 的 empresas？

我有这个模型：

```
public class Grupo
{
    public int id { get; set; }
    public string descripccion { get; set; }
    [ForeignKey("Empresas")]
    public int empresa { get; set; }

    public virtual empresa Empresas { get; set; }
}

public class empresa
{    
    public int id { get; set; }
    public string descripcion { get; set; }

    public virtual ICollection<Grupo> Grupos { get; set; }
} 
```

所以这个方法给了我一个列表

```
private List<Grupo> VerEmpresas(int userId)
{    
    var lista = (from ga in db.GrupoAccesos
    join g in db.Grupos
        on ga.grupo equals g.id
    where ga.usuario == userId
    select g).ToList();
    return lista;
} 
```

现在我想用这种方法向我展示与 grupo 相关的 empresas。

下面 emp 给出了一个布尔值，相反，我想要我的 grupos 列表中的所有 empresas。

```
List<Grupo> verEmpresa = VerEmpresas(1);

var emp = (from p in db.Empresas
           select p.Grupos).Contains(verEmpresa);       

ViewBag.empresa = new SelectList(emp, "id", "descripcion"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T00:07:55.070

您可以尝试从 Grupo 列表中获取 empresa id，并使用外键关系来获取 empresas：

```
var empresaIds = verEmpresa.Select( v => v.empresa ).Distinct().ToList();
var emp = from p in db.Empresas
          where empresaIds.Contains( p.id )
          select p; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T23:50:20.697

在您的代码中，您传递的是 Grupo 列表“VerEmpresa”。您应该从该列表中传递一个 Grupo 对象。尝试在 verEmpresa List 上使用`Any`and方法。`All`尝试类似：

```
from p in db.Empresas
           where verEmpresa.Any(val => p.Contains(val))
           select p; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T23:57:53.723

如果您想要的只是 empresas，请尝试：

```
var emp = (from e in db.Empresas
           from g in db.Grupos
           where e.Grupos.Contains(g)
           select e); 
```

# javascript - 想要将 Json 放入数组中？

> ID：11570428
> 
> 赞同：-1
> 
> 时间：2012-07-19T22:46:38.787
> 
> 标签：javascript, json

我有来自 API 的这个请求

[http://api.koordinates.com/api/vectorQuery.json/?key=78582ad1ffea4388813d19ab9b5a2b63&layer=144&x=174.6964&y=-41.3768&geometry=true&radius=100000&max_results=100](http://api.koordinates.com/api/vectorQuery.json/?key=78582ad1ffea4388813d19ab9b5a2b63&layer=144&x=174.6964&y=-41.3768&geometry=true&radius=100000&max_results=100)

我想在 JS 中放入一个数组。

我该怎么做呢？

如果我对 Json 作为一名设计师不太了解，请提供帮助，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T22:57:24.010

有几件事，那就是一大堆 json，而您正在问一个加载的问题。在 VIM 中浏览它，我只是猜测您想要“功能”数组。一个天真的答案是你让对象说一些叫做“响应”的东西，然后你会想要拉出 response.features。我怀疑您要求更多，为此我会将您引导到像 jquery 这样的库。[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)你可能想找到那个 javascript 朋友来帮助你设置。此外，您可能需要处理跨域请求的问题。

希望这可以帮助

# javascript - Javascript REGEX：需要从嵌入 URL 检索 ID 以及开始和结束时间

> ID：11570430
> 
> 赞同：0
> 
> 时间：2012-07-19T22:46:51.630
> 
> 标签：javascript, regex, url, youtube

这是我将使用的 url 结构示例（忽略电子视频的时代 :)）

[http://www.youtube.com/embed/ABCumLrphFA?&start=20&end=50](http://www.youtube.com/embed/ABCumLrphFA?&start=20&end=50)

基本上，我希望能够获取视频 ID、选择的开始时间 (20) 和结束选择的时间 (50)，并将它们保存为来自任何遵循上述模式的 URL 的变量。

所以一个简单的设置是这样的：

```
var url = 'http://www.youtube.com/embed/ABCumLrphFA?&start=20&end=50'

// get youtube id
function youtubeid(url) {
    var ytid = url.match(dont know);
    ytid = ytid[1];
    return ytid;
}
// get youtube start time
function youtubeStart(url) {
    var ytStart = url.match(dont know);
    ytStart=ytStart[1];
    return ytStart;
}
// get youtube end time
function youtubeEnd(url) {
    var ytEnd = url.match(dont know);
    ytEnd=ytEnd[1];
    return ytEnd;
} 
```

如果你能帮我填空，那将是最神奇的。我一直盯着正则表达式文档有一段时间了，而且越来越困惑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T22:55:03.960

检索 id

```
url.match(/embed\/(.*)\?/) 
```

检索 URL 参数（开始和结束）的最佳方法是[使用 Dojo 执行类似 Get Querystring](https://stackoverflow.com/questions/7825329/get-querystring-with-dojo/7825382#7825382)然后您可以使用以下内容来检索开始和结束

```
var qs = getUrlParams();
console.log("start is " + qs.start + " and end is " + qs.end ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T22:57:45.270

1

```
/http:\/\/www\.youtube\.com\/embed\/([^?]+)/ 
```

2

```
/http:\/\/www\.youtube\.com\/embed\/[^?]+.*[?&]start=(\d+)(?:&|$)/ 
```

3

```
/http:\/\/www\.youtube\.com\/embed\/[^?]+.*[?&]end=(\d+)(?:&|$)/ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T22:58:00.247

这个其他堆栈溢出答案可能会对您有所帮助。我在下面使用了 Peter Mortensen 的答案。

*   [在 JavaScript 中获取查询字符串值](https://stackoverflow.com/questions/901115/get-query-string-values-in-javascript)

要获取实际的 YouTube Id，您可以使用以下正则表达式：

```
http:\/\/www.youtube.com\/embed\/(.{11}) 
```

该正则表达式将返回括号中的值。你可以在这里测试它：

*   [http://www.pagecolumn.com/tool/regtest.htm](http://www.pagecolumn.com/tool/regtest.htm)

示例代码：

```
var url = 'http://www.youtube.com/embed/ABCumLrphFA?&start=20&end=50'

// get youtube id
function youtubeid(url) {
    var ytid = url.match(/http:\/\/www.youtube.com\/embed\/(.{11})/);
    ytid = ytid[1];
    return ytid;
}
alert(youtubeid(url));

function getParameterByName(name, url) {
    var match = RegExp('[?&]' + name + '=([^&]*)')
                    .exec(url);
    return match && decodeURIComponent(match[1].replace(/\+/g, ' '));
}

alert(getParameterByName('start', url));
alert(getParameterByName('end', url)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T23:06:35.080

仅当您知道您的 URL 看起来与您提供的*完全*一样时，这才有效（没有额外的查询参数；始终按该顺序开始和结束；没有 HTTPS；等等）。但是你可以一次得到它们：

```
js> str = 'http://www.youtube.com/embed/ABCumLrphFA?&start=20&end=50'      
    http://www.youtube.com/embed/ABCumLrphFA?&start=20&end=50
js> rxp = /http:\/\/www.youtube.com\/embed\/(.*)\?&start=(\d+)?&end=(\d+)?/
    /http:\/\/www.youtube.com\/embed\/(.*)\?&start=(\d+)?&end=(\d+)?/
js> result = rxp.exec(str)
    http://www.youtube.com/embed/ABCumLrphFA?&start=20&end=50,ABCumLrphFA,20,50
js> result[0]
    http://www.youtube.com/embed/ABCumLrphFA?&start=20&end=50
js> result[1]
    ABCumLrphFA
js> result[2]
    20
js> result[3]
    50 
```

我相信可以编写一个正则表达式来处理我上面提到的所有怪癖，但它更丑陋并且更难理解。无论如何-希望这会有所帮助！

另请参阅： [JavaScript 正则表达式转义序列](http://www.javascriptkit.com/javatutors/redev2.shtml)和[JavaScript 正则表达式方法](http://www.javascriptkit.com/javatutors/redev3.shtml)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-19T23:20:09.560

```
var url = "http://www.youtube.com/embed/ABCumLrphFA?&start=20&end=50";

// get youtube id
function youtubeid(url) {
    q = url.substring(url.lastIndexOf("/")+1);
    var ytid = q.substring(q.lastIndexOf("?"), -1);
    return ytid;
}

// get youtube start time
function youtubeStart(url) {
    q = url.substring(url.lastIndexOf("/")+1);
var ytStart = q.substring(q.indexOf("&start")+7,q.indexOf("&end"));
    return ytStart;
}

// get youtube end time
function youtubeEnd(url) {
q = url.substring(url.lastIndexOf("/")+1);
var ytEnd = q.substring(q.indexOf("&end")+5);
    return ytEnd;
}

console.log(youtubeid(url));
console.log(youtubeStart(url));
console.log(youtubeEnd(url)); 
```

# powershell - 执行传递给 powershell 脚本的参数，就好像它是脚本中的一行一样

> ID：11570433
> 
> 赞同：2
> 
> 时间：2012-07-19T22:47:01.537
> 
> 标签：powershell

我有一个包装器 powershell 脚本，我希望用它来自动化一些事情。它非常基本，并接受我希望脚本运行的参数，就好像它是脚本中的一行一样。我绝对不能让它工作。

例子：

```
param( [string[]] $p)
echo $p
# Adds the base cmdlets
Add-PSSnapin VMware.VimAutomation.Core
# Add the following if you want to do things with Update Manager
Add-PSSnapin VMware.VumAutomation
# This script adds some helper functions and sets the appearance. You can pick and choose parts of this file for a fully custom appearance.
. "C:\Program Files (x86)\VMware\Infrastructure\vSphere PowerCLI\Scripts\Initialize-VIToolkitEnvironment.ps1"

$p 
```

在上面的示例中，我希望 $p 像脚本中的一行一样执行。我知道这不安全，这可能就是问题所在。

以下是我尝试运行脚本并为 $p 传递参数的方法：

```
D:\ps\test>powershell -command "D:\ps\test\powershell_wrapper.ps1" 'Suspend-VM servername -Verbose -Confirm:$False' 
```

如何让我的“Suspend-VM servername -Verbose -Confirm:$False”参数在我的脚本中运行？如果我只是在脚本中包含该值而不是将其作为参数传递它运行没有任何问题...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T23:27:49.660

您基本上可以采用这两种方式，具体取决于您的实际需求以及您希望如何构建代码。

**方法 #1 - 调用表达式**

`Invoke-Expression`基本上允许您将字符串视为表达式并对其进行评估。考虑以下简单的示例：

```
Invoke-Expression '{"Hello World"}' 
```

这将评估字符串，就好像它是直接输入的表达式一样，并将字符串“Hello World”放在管道上。您可以使用它来获取您的字符串参数并在您的脚本中即时运行它。

**方法 #2 - 使用 ScriptBlock**

PowerShell 有一种称为 ScriptBlock 的特殊数据类型，您可以在其中将脚本绑定到变量，然后将该脚本作为代码的一部分调用。同样，这是一个简单的例子：

```
function Test-SB([ScriptBlock]$sb) {
  $sb.Invoke()
}

Test-SB -sb {"Hello World"} 
```

此示例创建一个具有单个参数 $sb 的函数，该参数类型为 ScriptBlock。注意参数绑定到实际的代码块`{"Hello World"}`？该代码分配给 $sb 参数，然后调用 .Invoke 方法实际执行代码。您可以调整您的代码以接收 ScriptBlock 并将其作为脚本的一部分调用。

**方法 #3 - 更新您的个人资料**

好的，所以我说有两种方法可以解决它。实际上还有第三种......您可以将 VMWare cmdlet 添加到您的`$profile`设备中，以便它们始终存在，并且您不需要将包装器加载到这些库中。诚然，这是一个相当大的锤子——但如果这是你经常工作的环境，这可能是有道理的。你也可以创建一个 PowerShell 的快捷方式，在启动时运行一个 .ps1，其中包含这些库并挂起（这个是 MS 对 SharePoint 管理外壳和其他几个外壳所做的）。查看此 TechNet 页面以获取有关 $profile 的更多信息以及是否可以帮助您：

[http://msdn.microsoft.com/en-us/library/windows/desktop/bb613488.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/bb613488.aspx)

# .net - DB2 查询偶尔会出现 SQL0925N：由于中断错误而取消处理

> ID：11570439
> 
> 赞同：4
> 
> 时间：2012-07-19T22:47:28.863
> 
> 标签：.net, sql, entity-framework, db2

我有一个与 DB2 数据库交互的 .Net 应用程序（实体框架，不确定该细节是否重要）。 *有时*我会在查询中收到以下错误：

```
ERROR [57014] [IBM][DB2] SQL0952N  Processing was cancelled due to an interrupt. 
```

这是整个错误文本（内部异常）。它没有 SQLSTATE。

同样，这不会每次都发生（即使对于相同的查询）。例如，我可以一遍又一遍地运行相同的查询，并且只看到错误发生 5 次中的 1 次。查询的持续时间总是相当一致的。

我搜索了一些文档，发现以下内容： [http ://www-01.ibm.com/support/docview.wss?uid=swg21450816](http://www-01.ibm.com/support/docview.wss?uid=swg21450816)

只是为了排除故障，我遵循了上述文档中的建议并`QueryTimeout=0`在我的连接字符串中进行了设置。这没有帮助，我仍然以大致相同的速度得到错误。我什至试过`QueryTimeout=500`......同样的结果。有趣的是，在测试中，当这个错误发生时，它大约发生在 30 秒标记处（文档提到的是默认超时）。我还在以某种方式使用默认超时设置吗？

下面的连接字符串：

```
<add name="myConn" connectionString="(entity framework stuff);provider=IBM.Data.DB2;provider connection string=&quot;Database=myDB;User ID=myId;Server=myServer;QueryTimeout=0&quot;" providerName="System.Data.EntityClient" /> 
```

1.  是否有其他超时设置覆盖或优先于我在连接字符串中指定的设置？
2.  是否有可能我*不是*在处理超时问题，而是在处理其他一些问题？我已经读过这可能是锁定的迹象......但我可以在测试中重现这一点，这是当时唯一访问数据库的人。会不会是别的东西？

**编辑**

我只是尝试设置`QueryTimeout=1`认为这肯定会导致每个查询超时。这似乎没有任何影响。使用 WELL 超过一秒后，仍有 5 个查询中的 4 个完成。我在这里想念什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-20T22:34:35.217

`CommandTimeout`我可以通过在我的 EF 数据上下文中设置如下来解决这个问题：

```
using (dataContext = new myDB2Entities())
{
     dataContext.CommandTimeout = 60;
     // DB CODE
} 
```

我现在明白`QueryTimeout`我一直在尝试使用的设置只是一个时间间隔，并且在每个时间间隔数据库都会检查应用程序是否仍在等待响应。我没有解决应用程序在默认 30 秒后发出中断的事实。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-11-28T18:09:52.890

错误是 SQL0952N

为了解决，我从 DB2 命令行执行了命令

db2 UPDATE CLI CFG FOR SECTION COMMON 使用 QUERYTIMEOUTINTERVAL 0

[https://www.ibm.com/support/pages/sql0952n-error-returned-long-running-sql-statement](https://www.ibm.com/support/pages/sql0952n-error-returned-long-running-sql-statement)

# python - 当 full=True 在反向关系上时，Django Tastypie 会抛出“超出最大递归深度”。

> ID：11570443
> 
> 赞同：7
> 
> 时间：2012-07-19T22:47:48.477
> 
> 标签：python, django, tastypie

如果运行以下代码，我会超出最大递归深度：

```
from tastypie import fields, utils
from tastypie.resources import ModelResource
from core.models import Project, Client

class ClientResource(ModelResource):
    projects = fields.ToManyField(
        'api.resources.ProjectResource', 'project_set', full=True
    )
    class Meta:
        queryset = Client.objects.all()
        resource_name = 'client'

class ProjectResource(ModelResource):
    client = fields.ForeignKey(ClientResource, 'client', full=True)
    class Meta:
        queryset = Project.objects.all()
        resource_name = 'project'

# curl http://localhost:8000/api/client/?format=json
# or
# curl http://localhost:8000/api/project/?format=json 
```

如果 set full=False 在其中一个关系上有效。我确实理解为什么会发生这种情况，但我需要两种关系来带来数据，而不仅仅是“resource_uri”。有没有一种美味的方法来做到这一点？我设法解决了在我的项目模型上创建序列化方法的问题，但它远非优雅。谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-19T23:16:07.380

您必须`full_dehydrate`在至少一个资源上覆盖方法以跳过导致递归的脱水相关资源。

或者，您可以定义两种类型的资源，它们使用相同的模型，一种使用`full=True`，另一种使用`full=False`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-18T07:09:22.253

感谢@astevanovic 指出正确的方向。

我发现`dehydrate`仅处理某些指定字段的覆盖`full_hydrate`方法比跳过字段的覆盖方法要少一些乏味。

为了追求可重用性，我想出了以下代码片段。希望它对某些人有用：

```
class BeeModelResource(ModelResource):

    def dehydrate(self, bundle):
        bundle = super(BeeModelResource, self).dehydrate(bundle)
        bundle = self.dehydrate_partial(bundle)        
        return bundle

    def dehydrate_partial(self, bundle):
        for field_name, resource_field in self.fields.items():
            if not isinstance(resource_field, RelatedField):
                continue

            if resource_field.full: # already dehydrated
                continue

            if not field_name in self._meta.partial_fields:
                continue

            if isinstance(resource_field, ToOneField):
                fk_object = getattr(bundle.obj, resource_field.attribute)
                fk_bundle = Bundle(obj=fk_object, request=bundle.request)
                fk_resource = resource_field.get_related_resource(fk_object)

                bundle.data[field_name] = fk_resource.dehydrate_selected( 
                        fk_bundle, self._meta.partial_fields[field_name]).data
            elif isinstance(resource_field, ToManyField):
                data = []

                fk_objects = getattr(bundle.obj, resource_field.attribute)
                for fk_object in fk_objects.all():
                    fk_bundle = Bundle(obj=fk_object, request=bundle.request)
                    fk_resource = resource_field.get_related_resource(fk_object)
                    fk_bundle = fk_resource.dehydrate_selected_fields( 
                            fk_bundle, self._meta.partial_fields[field_name])
                    data.append(fk_bundle.data)
                bundle.data[field_name] = data

        return bundle

    def dehydrate_selected_fields(self, bundle, selected_field_names):
        # Dehydrate each field.
        for field_name, field_object in self.fields.items():
            # A touch leaky but it makes URI resolution work. 
            # (borrowed from tastypie.resources.full_dehydrate)
            if field_name in selected_field_names and not self.is_special_fields(field_name):
                if getattr(field_object, 'dehydrated_type', None) == 'related':
                    field_object.api_name = self._meta.api_name
                    field_object.resource_name = self._meta.resource_name

                bundle.data[field_name] = field_object.dehydrate(bundle)

        bundle.data['resource_uri'] = self.get_resource_uri(bundle.obj)
        bundle.data['id'] = bundle.obj.pk

       return bundle

    @staticmethod
    def is_special_fields(field_name):
        return field_name in ['resource_uri'] 
```

对于 @sigmus 的示例，资源将需要 3 处修改：

1.  两种资源都将`BeeModuleResource`用作其超类（或者，添加`dehydrate_partial`到一个资源和另一个资源`dehydrate_selected`。）
2.  `full=True`在任一资源上取消设置
3.  将未设置的资源添加`partial_fields`到资源中`Meta`

```

```
class ClientResource(BeeModelResource): # make BeeModelResource a super class
    projects = fields.ToManyField(
        'api.resources.ProjectResource', 'project_set'
    ) # remove full=True
    class Meta:
        queryset = Client.objects.all()
        resource_name = 'client'
        partial_fields = {'projects': ['memo', 'title']} # add partial_fields

class ProjectResource(BeeModelResource): # make BeeModelResource a super class
    client = fields.ForeignKey(ClientResource, 'client', full=True)
    class Meta:
        queryset = Project.objects.all()
        resource_name = 'project' 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-06-05T12:46:31.977

**死的简单解决方案：**在两个关系字段上设置`use_in = 'list'`kwarg！

文档：[http ://django-tastypie.readthedocs.org/en/latest/fields.html#use-in](http://django-tastypie.readthedocs.org/en/latest/fields.html#use-in)

# java - 如何解码字符串化的 unicode？

> ID：11570445
> 
> 赞同：1
> 
> 时间：2012-07-19T22:48:03.970
> 
> 标签：java, json, unicode

我正在使用 Ajax 将字符串化字符串传递给 Java。

```
$.ajax({
    url: "url",
    data: {
       item: JSON.stringify( object with unicode string values ) 
    }
}); 
```

我曾经用 PHP 解析它，`urldecode`并且所有字符都解码得很好。现在，我需要在 Java 中做到这一点。我试过`URLDecoder.decode(string, "UTF-8")`了，但没有用。我应该改用什么？

**更新**：通过“没有工作”，我的意思是我得到以下结果：

标题：“æä¼ææ¿ä»（来自JAVA）

而不是标题：“最优惠房（来自PHP）

**更新2**：

看来我之前必须使用以下内容`request.getParameter`：

```
request.setCharacterEncoding("UTF-8") 
```

而且我的 Ajax 请求必须是 POST 类型的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T22:52:41.360

为什么不使用一些可以自动完成的现有库呢？查看：

*   [Java 中的 JSON](http://www.json.org/java/)
*   [谷歌-gson](http://code.google.com/p/google-gson/)

# c# - 如何连接 JObect

> ID：11570446
> 
> 赞同：1
> 
> 时间：2012-07-19T22:48:06.137
> 
> 标签：c#, json.net

我有几个 JObjects 从不同的地方返回，但具有所有相同的属性。我需要将它连接/合并到一个更大的 jObject 中。这是可能的，我将如何去做？

我希望它具有与单个对象相同的属性。例如。

```
jObject1 = { "data": [{"name": "foo","id": "1234" }]};
jObject2 = {"data": [{ "name": "foo2", "id": "5678" }]}; 
```

导致这样的事情。

```
jobject3 = { "data": [{ "name": "foo", "id": "1234"}, { "name": "foo2", "id": "5678" }]}; 
```

我正在用 C# 编码，到目前为止我唯一想到的就是这样的事情，这是无效的。不太确定如何开始，也无能为力。

```
jobject3 = jObject1.Concat(jObject2); 
```

我正在尝试手动循环遍历每个对象并构建一个新对象。我想我很接近，但在添加第二项（oAlldepartment.Add）时不断收到错误消息，说“无法将属性添加到 Newtonsoft.Json.Linq.JObject。对象上已经存在同名的属性。”。

动态 dynObj = JsonConvert.DeserializeObject(people); foreach (var item in dynObj.data) { string id = item.id; 字符串名称 = item.name;

```
department = getdepartment(id);

JObject oDepartment = new JObject();

try
{
    if (!String.IsNullOrEmpty(department))
        oDepartment = JObject.Parse(department);
}
catch (Exception ex)
{
}

JArray departmentArray = new JArray();

if (oDepartment != null)
{
    foreach (var x in oDepartment["data"].Children())
    {
        try
        {
            JObject departmentObject = new JObject();

            ((JObject)departmentObject).Add(new JProperty("name", x["name"]));
            ((JObject)departmentObject).Add(new JProperty("department", new JObject(new JProperty("name", x["department"]["name"]))));
            ((JObject)departmentObject).Add(new JProperty("hire_date", x["hire_date"]));
            ((JObject)departmentObject).Add(new JProperty("description", x["description"]));
            departmentArray.Add(departmentObject);

        }
        catch (Exception ex)
        {
        }

        ((JObject)x).Add(new JProperty("itemtype", "post"));
    }
    try
    {
        oAlldepartment.Add(new JProperty("", new JArray(departmentArray)));
    }
    catch (Exception ex)
    {
    }
} 
```

}

谢谢，

朗达

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T15:20:58.633

我最终做的是创建一个定义我想要返回的 json 的类，并从每个单独的对象中添加 json 属性。另一个好处是我的方法返回给客户端的数据更干净，因为我只需要担心我需要的属性，而不是一个带有一堆我不需要的属性的巨大 json 对象。

朗达

# html - text-align: 在 Chrome 中右边有边距或缓冲区

> ID：11570447
> 
> 赞同：2
> 
> 时间：2012-07-19T22:48:06.897
> 
> 标签：html, css, cross-browser

我试图简单地将一组文本和`<input>`元素对齐到右侧，以便输入的左侧始终对齐在同一位置（它们的宽度相同，所以真正发生的是右侧对齐到它们容器的右侧），标签文本的左侧是锯齿状的。

它不适合大型表格，但对于我需要的东西，这样看起来更好。

这是 HTML 和 CSS（也在[这个 jsfiddle](http://jsfiddle.net/rockerest/zbygT/2/)）：

HTML：

```
<div id="pullthrough-control-panel">
    <div class="float-l right-text" id="pullthrough-range-panel">
        <h3 class="center-text">Date Range</h3>
        Start: <input type="text" name="rangestart" />
        <br />
        End: <input type="text" name="rangeend" />
    </div>
</div> 
```

CSS：

```
.float-l{
    float: left;
}

.right-text{
    text-align: right;
}

.center-text{
    text-align: center;
}

#pullthrough-control-panel{
    height: 6em;
    padding: .25em;
} 
```

而已。现在，当我尝试跨浏览器访问页面时，真正的问题就出现了。像往常一样，Firefox 按预期工作。问题出在 Chrome 上。下部输入（“End”）突出到上部输入的右侧。没有理由发生这种情况。

如果您同时拥有这两种浏览器，则可以在我上面发布[的 jsfiddle](http://jsfiddle.net/rockerest/zbygT/2/)中查看。

这是 Chrome 的 CSS 引擎中的错误吗？有没有我不知道的事情发生？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T22:57:18.583

您可以简单地更改`<br/>`为`<p>`，它将起作用。

[http://jsfiddle.net/Jd7PR/](http://jsfiddle.net/Jd7PR/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T23:09:39.253

**你做的很好，只需**`<br />`在上面的行中移动`input`:

```
 Start: <input type="text" name="rangestart" /><br />
        End: <input type="text" name="rangeend" /> 
```

## *[jsFiddle 演示](http://jsfiddle.net/zbygT/11/)*

而已！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T22:56:14.477

这是我给你的演示。好像chrome不喜欢`</br>`

[演示](http://jsfiddle.net/zbygT/9/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T23:15:20.123

你需要在一个div上同时拥有一个类和一个id吗？（我不想说你不应该因为我不确定，但我以前没有遇到过）

您可以为每个输入提供一个类/id，然后将该类/id 的 css 设置为：float:right; - 或者，您可以使用位置：绝对；- 就个人而言，我会将两对放在父 div 中并使用 display:inline; 和浮动：对；在父 div 上。

# java - PepareStatement 使用 MS Access，其中一些值来自不同的表

> ID：11570453
> 
> 赞同：0
> 
> 时间：2012-07-19T22:49:04.593
> 
> 标签：java, mysql, ms-access, servlets

我正在尝试使用 Servelts ( `PreparedStatement`) 和 HTML 表单将数据插入 MS Access DB。

可以在 MS Acces Insert Query 上帮助我吗？我的要求是将表单值插入 MS Access，并且其中一个字段`insert`必须来自不同的表。

所以我有这种方式：

```
insert into tablename(Col1, col2, col3)
values(?,?, select col3 from diffferent_table where name=col1)) 
```

我可以这样写吗？我必须根据我为 Col1 获得的输入从不同的表中获取 col3 的值

有人可以帮忙吗。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T23:00:22.570

一种方法是：

```
PreparedStatement insertStatement= connection.prepareStatement("insert into tablename(col1, col2, col3) values(?,?, select col3 from different_table where name = ?)");
//Then set your parameters accordingly. As per your requirement, the 1st and last paramter should've the same value 
```

如果我是你，我会按照以下方式做一些事情：

```
PreparedStatement retrieveStatement= connection.prepareStatement("select col3 from diffferent_table where name=?");
PreparedStatement insertStatement= connection.prepareStatement("insert into tablename(col1, col2, col3) values(?,?, ?)");

//set the value
retrieveStatement.setXX(1,Col1); 
```

然后，我将通过执行从结果集中检索值`retrieveStatement`并将该值设置在`insertStatement`

如果您在将值从一个表插入到另一个表时需要处理特定场景，第二个选项将有所帮助。我想你可以按照这个并想出你自己的代码

# python - Python：通用 CSV 文件解析和操作

> ID：11570455
> 
> 赞同：3
> 
> 时间：2012-07-19T22:49:13.323
> 
> 标签：python, csv

我的 Python 脚本的目的是比较多个 CSV 文件中存在的数据，寻找差异。数据是有序的，但文件之间的顺序不同。这些文件包含大约 70K 行，重约 15MB。这里没有什么花哨或铁杆。以下是部分代码：

```
def getCSV(fpath):
    with open(fpath,"rb") as f:
        csvfile = csv.reader(f)

        for row in csvfile:
            allRows.append(row)

allCols = map(list, zip(*allRows)) 
```

*   我是否正确读取我的 CSV 文件？我正在使用`csv.reader`，但我会从使用中受益`csv.DictReader`吗？
*   如何创建包含在精确列中具有特定值的整行的列表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T23:17:52.713

这应该可行，您无需创建另一个列表即可访问这些列。

```
import csv
import sys

def getCSV(fpath):
    with open(fpath) as ifile:
        csvfile = csv.reader(ifile)

        rows = list(csvfile)

    value_20 = [x for x in rows if x[20] == 'value'] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T23:29:28.737

您确定要保留所有行吗？这将创建一个仅具有匹配值的列表......`fname`也可能来自您`glob.glob()`选择`os.listdir()`的任何其他数据源。请注意，您提到第 20 列，但 row[20] 将是第 21 列...

```
import csv

matching20 = []

for fname in ('file1.csv', 'file2.csv', 'file3.csv'):
    with open(fname) as fin:
        csvin = csv.reader(fin)
        next(csvin) # <--- if you want to skip header row
        for row in csvin:
            if row[20] == 'value':
                matching20.append(row) # or do something with it here 
```

您只需`csv.DictReader`要有标题行并希望按名称访问列。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T23:08:49.677

如果我正确理解了这个问题，您想`value`在该行中包含一行，但您不知道哪一列`value`是，对吗？

如果您的行是列表，那么这应该工作：

```
testlist = [row for row in allRows if 'value' in row] 
```

后期编辑：

如果，如您所说，您想要一个`value`在指定列中的行列表（由 integer 指定`pos`，那么：

```
testlist = []
pos = 20
for row in allRows:
    testlist.append([element if index != pos else 'value' for index, element in enumerate(row)]) 
```

（我还没有测试过这个，但如果可行的话，现在让我看看）。

# image - 将照片添加到开放群组的 Facebook 相册

> ID：11570457
> 
> 赞同：1
> 
> 时间：2012-07-19T22:49:38.493
> 
> 标签：image, facebook, upload, facebook-group

是否可以使用 php 或 javascript API 将图片添加到 Facebook 开放组的相册中？

我可以将图片添加到我的个人资料中

```
 $data = array(
                "name" => $_POST["message"],
                "image" => "@" . realpath($_FILES["image"]["tmp_name"]));
            $fb->setFileUploadSupport(true);
            $status = $fb->api("/me/photos", "POST", $data); 
```

# android - 定期 LogCat 轮询更新并保存到 SD 卡

> ID：11570458
> 
> 赞同：2
> 
> 时间：2012-07-19T22:49:38.897
> 
> 标签：android

**目标**

收集 LogCat 的定期更新并将这些文本块保存（附加）到 SD 卡上的文件中

**问题**

由于特定时间戳，Log 类不提供更新

**可能的解决方案**

我的计划是定期运行类似于以下内容的代码：[http](http://www.helloandroid.com/tutorials/reading-logs-programatically) ://www.helloandroid.com/tutorials/reading-logs-programatically 或[https://stackoverflow.com/a/9039352/550471](https://stackoverflow.com/a/9039352/550471)

但是，有一个显着的区别：使用`-v time`参数来确保每一行都带有时间戳。

每次收集 LogCat 数据后，应用程序将存储最后一个 Log 条目的时间戳。下次收集 LogCat 数据时，应用程序将搜索文本以查找时间戳，然后将数据块保存到自指定时间戳以来添加到日志的 sdcard。

**可能的问题**

如果在太短的时间内收集 LogCat 数据，则 CPU 正忙于处理大量“旧”数据。如果 Logcat 数据的收集时间过长，则可能会丢失一些数据。

***有没有更好的办法 ？***

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T22:51:36.073

这就是我想出的——当它不冻结时效果很好。

正如您可能知道的那样，`Runtime.getRuntime().exec("")`在 Android 中导致 ANR 的可能性比 Jelly Bean 更早。如果有人有解决 ANR 的方法，请分享。

```
import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileWriter;
import java.io.IOException;
import java.io.InputStreamReader;

import android.os.Environment;
import android.util.Log;

/*
 * For (compressed) buffer sizes, see: http://elinux.org/Android_Logging_System
 * buffer:main = 64KB
 * buffer:radio = 64KB
 * buffer:system = 64KB
 * buffer:event = 256KB
 * 
 * NOTE: the 'command' must include "-d -v time" !!
 * to switch buffers, use "-b <buffer>"
 */
public class LogCatReader {
    // constants
    private static final String CR = "\r\n";
    private static final String END_OF_DATE_TIME = "): ";
    private static final int DEFAULT_SEARCH_START_INDEX = 0;

    // member variables
    private StringBuilder mLog;
    private LogThread mLogThread = null;
    private String mLastLogReadToken = "";
    private String mLogCommand = "";
    private int mStringCapacity;
    private File mFileTarget = null;

    // constructor
    public LogCatReader(String command, int capacity) {
        mLogCommand = command;
        mStringCapacity = capacity;
    }

    // returns complete logcat buffer
    // note: takes about 1.5sec to finish
    synchronized public StringBuilder getLogComplete() {
        try {
            // capacity should be about 25% bigger than buffer size since the
            // buffer is compressed
            mLog = new StringBuilder(mStringCapacity);

            // command to capture log
            Process process = Runtime.getRuntime().exec(mLogCommand);
            BufferedReader bufferedReader = new BufferedReader(
                    new InputStreamReader(process.getInputStream()));

            String line;
            while ((line = bufferedReader.readLine()) != null) {
                // append() is costly if capacity needs to be increased, be sure
                // to reserve enough in the first place
                mLog.append(line + CR);
            }
        } catch (IOException e) {
        }

        return mLog;
    }

    public String getLogUpdatesOnly() {
        String strReturn = "";

        StringBuilder sbLog = getLogComplete();

        try {
            int iStartindex = DEFAULT_SEARCH_START_INDEX;

            // if there exists a token from a previous search then use that
            if (mLastLogReadToken.length() > 0) {
                iStartindex = sbLog.indexOf(mLastLogReadToken);

                // if string not found then start at beginning
                if (iStartindex == -1) {
                    // start search at beginning of log
                    iStartindex = DEFAULT_SEARCH_START_INDEX;
                }
            }

            int iEndindex = sbLog.length();

            // if token is found then move index to the next line
            if (iStartindex > DEFAULT_SEARCH_START_INDEX) {
                iStartindex = sbLog.indexOf(CR, iStartindex);

                if (iStartindex != -1) {
                    iStartindex += CR.length();
                } else {
                    // return an empty string
                    iStartindex = iEndindex;
                }
            }

            // grab the data between the start and end indices
            strReturn = sbLog.substring(iStartindex, iEndindex);

            // grab date/time token for next search
            iStartindex = sbLog.lastIndexOf(END_OF_DATE_TIME);

            if (iStartindex != -1) {
                iEndindex = iStartindex;
                iStartindex = sbLog.lastIndexOf(CR, iEndindex);
                iStartindex += CR.length();

                if (iStartindex == -1) {
                    // read from beginning
                    iStartindex = 0;
                }

                mLastLogReadToken = sbLog.substring(iStartindex, iEndindex);
            }
        } catch (Exception e) {
            strReturn = "";
        }

        return strReturn;
    }

    public void startPeriodicLogCatReader(int timePeriod, String logfilename) {
        if (mLogThread == null) {
            mLogThread = new LogThread(timePeriod, logfilename);
            mLogThread.start();
        }
    }

    public void stopPeriodicLogCatReader() {
        if (mLogThread != null) {
            mLogThread.interrupt();
            mLogThread = null;
        }
    }

    private class LogThread extends Thread {
        private boolean mInterrupted;
        private int mTimePeriod;// in seconds
        private String mLogref;
        private BufferedWriter mBuffWriter = null;
        public boolean mPauseLogCollection = false;

        // constructor: logfilename is optional - pass null to not use
        public LogThread(int timePeriod, String logfilename) {
            mTimePeriod = timePeriod;

            if (logfilename != null) {
                File fLogFolder = new File(
                        Environment.getExternalStorageDirectory() + "/logfiles");
                if (fLogFolder.exists() == false) {
                    if (fLogFolder.mkdirs() == false) {
                        Log.e("LogCatReader",
                                "Could not create "
                                        + fLogFolder.getAbsolutePath());
                    }
                }

                mFileTarget = new File(
                        Environment.getExternalStorageDirectory() + "/logfiles",
                        logfilename);

                if (mFileTarget.exists() == false) {
                    try {
                        // file doesn't yet exist - create a fresh one !
                        mFileTarget.createNewFile();
                    } catch (IOException e) {
                        e.printStackTrace();
                        mFileTarget = null;
                    }
                }
            }
        }

        @Override
        public void interrupt() {
            mInterrupted = true;
            super.interrupt();
        }

        @Override
        public void run() {
            super.run();

            // initialization
            mInterrupted = false;

            // set up storage
            if (mFileTarget != null) {
                try {
                    mBuffWriter = new BufferedWriter(new FileWriter(
                            mFileTarget, true), 10240);
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }

            while ((mInterrupted == false) && (mBuffWriter != null)) {
                if (mPauseLogCollection == false) {
                    // read log updates
                    mLogref = getLogUpdatesOnly();

                    // save log updates to file
                    try {
                        mBuffWriter.append(mLogref);
                        mBuffWriter.flush();
                    } catch (IOException e) {
                        e.printStackTrace();
                    }
                }

                if (!mInterrupted) {
                    try {
                        sleep(mTimePeriod * 1000);
                    } catch (InterruptedException e) {
                    }
                }
            }

            if (mBuffWriter != null) {
                try {
                    mBuffWriter.close();
                    mBuffWriter = null;
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }
        }
    }// end of inner class
}// end of outer class 
```

我用来仅查找更新的过程是捕获 logcat 的最后一行的日期和时间，并将其用作下次搜索标记。

要使用这个类，下面是一个例子：

```
 LogCatReader logcatPeriodicReader = new LogCatReader("logcat -b main -d -v time", 80 * 1024);//collect "main" buffer, exit after reading logcat
        logcatPeriodicReader.startPeriodicLogReader(90, "log.txt");//read logcat every 90 secs 
```

# django - 如何在 django-nonrel 中将 AutoField ID 设置为嵌套模型？

> ID：11570459
> 
> 赞同：0
> 
> 时间：2012-07-19T22:49:44.217
> 
> 标签：django, mongodb, django-nonrel

我需要 django-nonrel 中嵌套模型的 ID，例如条目中的每个评论。

```
class Entry(models.Model):
    comments = ListField(EmbeddedModelField('Comment'))

class Comment(models.Model):
    text =  CharField(max_length=200) 
```

我试过了：

```
id = models.AutoField(primary_key=True)
id = models.NativeAutoField(primary_key=True) 
id = models.CharField(max_length=200, primary_key=True) 
```

似乎没有人会自动生成一个 Id。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T22:07:25.653

也许有什么`CharField(..., default=ObjectId)`？

# ruby-on-rails - 带有 cmd 修复编码的 Rspec

> ID：11570461
> 
> 赞同：2
> 
> 时间：2012-07-19T22:50:13.953
> 
> 标签：ruby-on-rails, rspec, cmd

我正在关注 Mhartl Ruby on Rails 教程并开始使用 Rspec。我想知道是否有一种方法可以修复我认为在输出到 cmd 时未正确编码的行尾字符，例如：←[0m

```
C:\PROGRAMMING\RailsSites\sample_app>bundle exec rspec spec/requests/static_pages_spec.rb
←[32m.←[0m←[32m.←[0m←[31mF←[0m

Failures:

  1) Static Pages About page should have the content 'About Us'
     ←[31mFailure/Error:←[0m ←[31mvisit '/static_pages/about'←[0m
     ←[31mActionController::RoutingError:←[0m
       ←[31mNo route matches [GET] "/static_pages/about"←[0m
←[36m     # ./spec/requests/static_pages_spec.rb:20:in `block (3 levels) in <top (required)>'←[0m

Finished in 3.66 seconds
←[31m3 examples, 1 failure←[0m

Failed examples:

←[31mrspec ./spec/requests/static_pages_spec.rb:19←[0m ←[36m# Static Pages About page should have the content 'About Us'←[0m 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T23:05:04.410

这些是为文本着色的[ANSI 代码。](http://en.wikipedia.org/wiki/ANSI_escape_code#Colors)

`--no-color`当您运行 rspec 命令以禁用这些代码时传递该选项。您还可以添加`--no-color`到`.rspec`文件中，使其成为项目的默认选项。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-15T05:10:50.237

试试这个：

[Windows下的ANSI命令行颜色](http://softkube.com/blog/ansi-command-line-colors-under-windows/)

它适用于我的旧 XP 机器，它适用于博客作者的 W7，它可能也适用于你。顺便说一句，它使我的 cmd 历史记录归零，但在第一次测试后它看起来像是回来了。

# php - 这个 Jquery 脚本有什么问题？

> ID：11570464
> 
> 赞同：0
> 
> 时间：2012-07-19T22:50:48.133
> 
> 标签：php, ajax, jquery

尝试在用户使用 Jquery/Ajax 功能选择状态后填充城市的下拉列表

HTML 表单具有...

```
 <?php $allRegions = Region::newInstance()->getStatesByCountry('US'); ?>

     <select name="regionId" id="regionId">

     <?php foreach($allRegions as $region) { ?>
     <option value="<?php echo $region['value'] ; ?>"><?php echo $region['name'] ; ?></option>
     <?php } ?>
     </select> 

       <select name="cityId" id="cityId">Choose a city</select> 
```

jquery代码...

```
 $(document).ready(function(){

  $("#regionId").change( function() {

  var regionId = $(this).val();

  var url = '<?php echo site_base_url(true)."?page=ajax&action=cities&regionId="; ?>' + regionId;

  $.ajax({
  type: "GET"
  url: url,
  dataType: 'json',
  success: function(msg){
  if (msg != ”){
  $("#cityId").html(msg).show();

  }

  }
  });
  });
  });
  </script> 
```

问题是，在选择一个区域时，城市下拉选择不会被填充......无法弄清楚......任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T22:52:55.687

一个问题是你有一个奇怪的引号字符：

```
if (msg != ”){ 
```

你可能是这个意思：

```
if (msg != ''){ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T22:53:27.567

另一个问题是：

```
 type: "GET" 
```

那应该是：

```
 type: "GET", 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-20T09:10:57.650

不要粗鲁，但是您的代码非常嵌套，并且不必要的复杂。修复上面提到的所有其他人，还有这个：

```
 <?PHP
 foreach($allRegions as $region) {
 <option value="<?php echo $region['value'];" . "><" . echo $region['name']; .
 "</option>" } ?>
 </select> 
```

# python - 从 PDF 中搜索文本的脚本

> ID：11570466
> 
> 赞同：5
> 
> 时间：2012-07-19T22:51:05.527
> 
> 标签：python, macos, parsing, pdf, tcl

### 问题

在 Mac OS X 平台上，我想用 Python 或 Tcl 编写一个脚本来搜索 PDF 文件中的文本并提取相关部分。我很感激任何帮助。

### 背景

我正在编写脚本来查看 PDF 中的内容，以确定它是否是账单、来自哪家公司以及在什么时期。根据这些信息，我重命名 PDF 并将其移动到适当的目录。例如，文件`Statement_03948293929384.pdf`可能会变成`2012-07-15 Water Bill.pdf`并移动到我的`Utilities`文件夹。

### 到目前为止我做了什么？

*   我已经搜索了 PDF 到纯文本的工具，但还没有找到任何东西
*   我查看了 Tcl wiki 并找到了一个示例，但无法使其工作（我搜索了 PDF 中的文本，但没有找到）。
*   我正在调查`pdf-parser.py`迪迪埃·史蒂文斯
*   我听说过一个名为 pyPdf 的 Python 包，接下来会看它。

### 更新

我找到了一个名为[pdftotext](http://www.bluem.net/en/mac/packages/)的命令行工具，由 Glyph & Cog, LLC 编写；由[Carsten Bluem](http://www.bluem.net/)构建和打包。这个工具很简单，它解决了我的问题。我仍在寻找那些可以直接搜索 PDF 而无需转换为文本文件的工具。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T23:19:33.843

我已成功使用[PyODConverter](http://www.artofsolving.com/opensource/pyodconverter)转换为 PDF（还有更强大的 Java 版本）。将 PDF 转换为文本后，进行搜索应该很简单。我也相信[iText](http://itextpdf.com/)应该能够做类似的事情，但我还没有测试过。

# c# - 从动态 asp 脚本中读取动态 xml

> ID：11570469
> 
> 赞同：0
> 
> 时间：2012-07-19T22:51:34.653
> 
> 标签：c#, xml, asp-classic

我正在尝试读取由 ASP 脚本创建的动态 xml，但不幸的是我无法读取。看来我的 C# 代码无法理解 ASP 脚本。

我很乐意听到一些建议。

您可以在此处查看 ASP 脚本：http: [//www.ad-net.co.il/test.asp](http://www.ad-net.co.il/test.asp)

```
<%
Response.Buffer = True
Response.ContentType = "text/xml"
body = ""
body = body & "<?xml version=""1.0"" encoding=""utf-8""?>"
body = body & "<PROGRAM>"
body = body & "<EMAIL>email@gmail.com</EMAIL>"
body = body & "<USERNAME>username@gmail.com</USERNAME>"
body = body & "<PASSWORD>password</PASSWORD>"
body = body & "</PROGRAM>"
Response.Write(body)
%> 
```

C#代码是：

```
private static void LoadXmlFromServerToProgram()
    {
        try
        {
            XmlDocument xDoc = new XmlDocument();
            xDoc.Load("http://www.ad-net.co.il/test.asp");

            EMAIL = xDoc.DocumentElement.SelectSingleNode("EMAIL").InnerText;
            USERNAME = xDoc.DocumentElement.SelectSingleNode("USERNAME").InnerText;
            PASSWORD = xDoc.DocumentElement.SelectSingleNode("PASSWORD").InnerText;                
        }
        catch
        {
            MessageBox.Show("Can't Read From XML");
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T22:58:06.003

你*不应该那样*使用 SelectSingleNode 。你需要一个 XPath 查询，而不是一个顶级节点。[在此处查找有关 XPath 的信息](http://www.w3schools.com/xpath/)。

你需要尝试这样的事情：

```
EMAIL = xDoc.CreateNavigator().SelectSingleNode("/PROGRAM/EMAIL").Value; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T23:24:52.047

尝试这个：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Xml;

namespace TestApplication2
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void Form1_Load(object sender, EventArgs e)
        {
            Form1.LoadXmlFromServerToProgram();

            MessageBox.Show(string.Concat("Email: ", Email, "\r\n", "UserName: ", UserName, "\r\n", "Password: ", Password));
        }

        public static string Email { get; set; }
        public static string UserName { get; set; }
        public static string Password { get; set; }

        private static void LoadXmlFromServerToProgram()
        {
            try
            {
                XmlDocument xDoc = new XmlDocument();
                xDoc.Load("http://www.ad-net.co.il/test.asp");

                Email = xDoc.DocumentElement.SelectSingleNode("EMAIL").InnerText;
                UserName = xDoc.DocumentElement.SelectSingleNode("USERNAME").InnerText;
                Password = xDoc.DocumentElement.SelectSingleNode("PASSWORD").InnerText;
            }
            catch
            {
                MessageBox.Show("Can't Read From XML");
            }
        }
    }

    partial class Form1
    {
        /// <summary>
        /// Required designer variable.
        /// </summary>
        private System.ComponentModel.IContainer components = null;

        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        /// <param name="disposing">true if managed resources should be disposed; otherwise, false.</param>
        protected override void Dispose(bool disposing)
        {
            if (disposing && (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            this.SuspendLayout();
            // 
            // Form1
            // 
            this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 13F);
            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
            this.ClientSize = new System.Drawing.Size(284, 262);
            this.Name = "Form1";
            this.Text = "Form1";
            this.Load += new System.EventHandler(this.Form1_Load);
            this.ResumeLayout(false);

        }

        #endregion
    }
} 
```

# ruby-on-rails - 从多个表单更新设计用户

> ID：11570470
> 
> 赞同：0
> 
> 时间：2012-07-19T22:51:43.340
> 
> 标签：ruby-on-rails, ruby, devise

我正在一个注册过程是多步骤的网站上工作。这么多的小表单都更新了用户模型（我正在使用设计 gem 进行用户身份验证）。

我应该将这些步骤中的每一个发布到相同的更新操作（覆盖 RegistrationController 更新操作）吗？每个表单在更新发生之前可能需要一些逻辑，因此表单将需要某种方式来确定它当前正在处理的表单（隐藏字段或尝试从存在的参数中建立）

..或者我应该将表单发布到单个操作（这不是非常 RESTful）？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T22:57:30.263

我不会覆盖`RegistrationsController`添加更新操作。我将有一个完全独立`UsersController`的定义一个`update`动作，该动作采用更新用户的参数。

在 Spree（我从事的工作）内部，我们有[一个`update`动作`CheckoutController`](https://github.com/spree/spree/blob/d67f8826d8fa30d768bc25297fd67c5ae79264b0/core/app/controllers/spree/checkout_controller.rb#L15-37)，类似于您希望用户更新动作的工作方式。一探究竟。

# jquery - Twitter API 出现 401 错误

> ID：11570477
> 
> 赞同：0
> 
> 时间：2012-07-19T22:52:16.367
> 
> 标签：jquery, api, twitter, twitter-oauth

我有 JQuery Twitter api 插件，我经常从一个站点到另一个站点（[从这里](http://www.queness.com/post/8881/create-a-twitter-feed-with-attached-images-from-media-entities)）使用。我最近在一个新站点上安装了它，但现在收到 401 错误：

```
Failed to load resource: the server responded with a status of 401 (Unauthorized)
jsonp1342737708184({"error":"This method requires authentication.","request":"\/1\/statuses\/user_timeline.json\/?callback=jsonp1342737708184&include_rts=true&count=3&include_entities=true"}) 
```

错误所指的行如下所示：

```
 at: function(tweet) {
            return tweet.replace(/\B[@＠]([a-zA-Z0-9_]{1,20})/g, function(m, username) {
                    return '<a target="_blank" class="twtr-atreply" href="http://twitter.com/intent/user?screen_name=' + username + '">@' + username + '</a>';
                                });
                            }, 
```

我认为这与 OAuth 身份验证有关，但我不确定如何更新我的脚本。

有没有人遇到过这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T00:01:26.817

发现问题：我没有配置我的脚本来正确处理用户名。正如您在错误中看到的那样，不存在用户名。我的用户名 var 有一个错误。

谢谢！

# c++ - 为 C++ 模板类提供 swap() 会破坏 std::swap()？

> ID：11570478
> 
> 赞同：0
> 
> 时间：2012-07-19T22:52:22.093
> 
> 标签：c++, visual-studio-2010, visual-c++, argument-dependent-lookup, copy-and-swap

我试图在我的自定义 Matrix 类中实现[复制和交换习语](https://stackoverflow.com/questions/3279543/what-is-the-copy-and-swap-idiom)，但我在以链接到问题中建议的方式实现 swap() 时遇到了一些麻烦：

（我使用的编译器是MS VS2010 IDE的编译器，方言是很好的老式C++03。）

```
// matrix.h

namespace my_space 
{

template<typename T> class Matrix
{
public:
    /* ... */

    friend void swap(Matrix<T> &first, Matrix<T> &second)
    {
        using std::swap;
        swap(first.width_, second.width_);
        swap(first.height_, second.height_);
        swap(first.data_, second.data_);
    }
};

} // namespace 
```

现在我无法在代码中为驻留在此命名空间中的函数访问常规 std::swap() ：

```
// some_code.cpp:
#include "matrix.h"
#include <algorithm>

using namespace my_space;
using namespace std;

// SomeClass is part of my_space!
void SomeClass::some_function()
{
    int a = 3, b = 7;
    swap(a,b);  // I wan't std::swap!
} 
```

不幸的是，由于某种原因，`my_space::swap()`对于 Matrix 似乎将所有其他调用别名为`std::swap()`，我不知道为什么因为参数不适合并且 ADL 应该支持`std::swap`：

```
1>f:\src\some_code.cpp(653): error C3767: 'swap': candidate function(s) not accessible
1>          could be the friend function at 'f:\src\matrix.h(63)' : 'swap'  [may be found via argument-dependent lookup] 
```

（对于我尝试使用的每一行，错误都会重复 10 次`std::swap`）

`my_space::swap()`总是否决`std::swap()`in `my_space`，即使论点不合适？它不是`std::swap()`不可见的，它在`my_space::swap()`创建之前工作正常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T04:03:01.480

如果代码真的像您发布的那样，那是编译器的问题。代码在 clang++ 中编译得很好，因为它应该。

友元声明很奇怪，因为它们声明了一个具有命名空间范围的函数，但该声明仅在 ADL 中可用，即使这样，也只有至少一个参数是具有友元声明的类的类型。除非有命名空间级别声明，否则该函数在命名空间范围内不可用。

* * *

**测试 1** （没有明确声明的命名空间级别的函数不可用）：

```
namespace A {
   struct B {
      friend void f();  // [1]
   };
   // void f();         // [2]
}
void A::f() {}          // [3] 
```

在 [1] 中，我们添加了一个朋友声明，它声明`void A::f()`为 的朋友`A::B`。如果没有在命名空间级别的 [2] 中的附加声明，[3] 中的定义将无法编译，因为在`A`命名空间之外该定义也不是自我声明。

* * *

这里的含义是，因为该函数不可用于在命名空间级别查找，而只能通过 ADL on `Matrix<T>`（对于某些特定的实例化类型`T`），编译器不可能将其与两个`int`值的交换匹配。

在他的回答中，Jesse Good 指出*Matrix 和 Matrix 的每个实例化都将包含相同的交换函数定义，因为您在 Matrix 模板中定义了友元函数，*这完全是荒谬的。

在类中定义的友元函数将声明并定义一个命名空间级别的函数，同样，该声明只能在类中使用，并且可以通过 ADL 访问。当这在模板内完成时，它将在命名空间级别为使用该函数的模板的每个实例定义一个非模板化的自由函数。也就是说，它会产生*不同的*定义。请注意，在类模板范围内，模板的名称标识了正在实例化的特化，也就是说，在内部`Matrix<T>`，标识符`Matrix`不命名模板，而是模板的一个实例化。

**测试 2**

* * *

```
namespace X {
   template <typename T>
   struct A {
      friend void function( A ) {}
   };
   template <typename T>
   void funcTion( A<T> ) {}
}
int main() {
   using namespace X;
   A<int> ai;    function(ai); funcTion(ai);
   A<double> ad; function(ad); funcTion(ad);
}

$ make test.cpp
$ nm test | grep func | c++filt
0000000100000e90 T void X::funcTion<double>(A<double>)
0000000100000e80 T void X::funcTion<int>(A<int>)
0000000100000e70 T X::function(A<double>)
0000000100000e60 T X::function(A<int>) 
```

的输出`nm`是符号列表，并且`c++filt`会将损坏的名称转换为 C++ 语法中的等效名称。程序的输出清楚地表明，这`X::funcTion` *是*一个已经为两种类型实例化的模板，同时`X::function`是两个重载的非模板化函数。再次：**两个**非模板函数。

* * *

声称它会生成*相同*的函数没有什么意义，考虑到它有一个函数调用，比如说，代码必须为函数的当前实例`std::cout << lhs`选择正确的重载。`operator<<`没有一个`operator<<`可以说 a`int`和 an `unsigned long`or `std::vector<double>`（没有什么能阻止你用*任何*类型实例化模板。

ildjarn 的答案提出了一个替代方案，但没有提供对该行为的解释。替代方法有效，因为*using-directive与**using-declaration*完全不同。特别是，*前者*`using namespace X;`（包含满足包含*使用 using 指令*的代码的分支）。*`X`*

 **另一方面，*using-declaration* ( `using std::swap;`)在存在*using-declaration**的*`std::swap`上下文中提供函数的声明。这就是为什么您必须使用*using-declarations*而不是*using-directives*来实现您的交换功能：

 *****测试 3**

* * *

```
namespace Y { struct Z {}; void swap( Z&,Z& ); }
namespace X {
   struct A { int a; Y::Z b; };
   void swap( A& lhs, A& rhs ) {
      //using namespace std;       // [1]
      using std::swap;             // [2]
      swap( lhs.a, rhs.a );        // [3]
      swap( lhs.b, rhs.b );        // [4]
   }
} 
```

如果我们使用了*using 指令*​​[1]，则命名空间中的符号`::std`将可用于在函数内部执行的查找，`::X::swap(X::A&,X::A&)`就好像它们已在中声明`::`（这是`::std`and的共同祖先`::X`）。现在 [3] 中的交换将不会`swap`通过 ADL 找到任何函数，因此它将开始在`swap`封闭的命名空间中搜索函数。第一个封闭的命名空间是`X`，它确实包含一个`swap`函数，因此查找将停止并且重载解析将启动，但`X::swap`它不是有效的重载`swap(int&,int&)`，因此它将无法编译。

通过使用*using-declaration*，我们将声明带到了（在函数内部！）`std::swap`的范围内。`X::swap`同样，ADL 不会在 [3] 中应用，并且会开始查找。在当前范围内（函数内部），它将找到模板的声明`std::swap`并实例化模板。在 [4] 中，ADL 确实启动了，它会搜索在`swap`函数*内部*`::Y::Z`和/或 in 中定义的函数`::Y`，并将其添加到当前作用域中找到的重载集（再次，`::std::swap`）。在这一点上，`::Z::swap`是一个更好的匹配`std::swap`（给定一个完美的匹配，一个非模板化的函数比一个模板化的更好）并且你得到了预期的行为。

* * *

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T23:33:36.890

在 中包括以下行`Matrix`：

```
template<typename U> friend void swap(Matrix<U> &first, Matrix<U> &second); 
```

并定义`swap`类的外部。您收到错误的原因是因为您在模板中定义了友元函数，并且`function template has already been defined`每个实例化都将包含您的交换函数的相同定义。`Matrix<unsigned short>``Matrix<char>``Matrix`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-20T03:37:24.397

STL 容器采用的方法是使用成员函数，然后重载静态函数。例如：

```
template<class T, class Alloc=std::allocator<T> >
class vector
{
   T *data;
   size_t n;
   size_t max_n;
public:
   void swap(vector<T, Alloc> &other)
   {
      swap(this->data, other.data);
      swap(this->n, other.n);
      swap(this->max_n, other.max_n);
   }
};

template<class T, class A>
void swap(vector<T, A> &lhs, vector<T, A> &rhs)
{
   lhs.swap(rhs);
} 
```

在建议的 Matrix 类中，只需采用相同的方法...

```
namespace my_space
{
template<typename T>
class Matrix
{
   unsigned width_;
   unsigned height_;
   std::vector<T> data_;
public:
   void swap(Matrix<T> &other)
   {
      std::swap(this->width_, other.width_);
      std::swap(this->height_, other.height_);
      std::swap(this->data_, other.data_);  // calls this->data_.swap(other.data_);
   }
};
}

namespace std
{
   template<typename T>
   void swap(my_space::Matrix<T> &lhs, my_space::Matrix<T> &rhs)
   {
      lhs.swap(rhs);
   }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-20T00:10:04.820

使用 VC++ 2010 SP1 为我构建了以下内容：

矩阵.h：

```
#pragma once

#include <algorithm>
#include <vector>

namespace my_space
{
    template<typename T>
    class Matrix
    {
    public:
        Matrix(unsigned const w, unsigned const h)
          : width_(w), height_(h), data_(w * h)
        { }

    private:
        unsigned width_;
        unsigned height_;
        std::vector<T> data_;

        friend void swap(Matrix& lhs, Matrix& rhs)
        {
            using std::swap;
            swap(lhs.width_,  rhs.width_);
            swap(lhs.height_, rhs.height_);
            swap(lhs.data_,   rhs.data_);
        }
    };
} 
```

.cpp：

```
#include "Matrix.h"

int main()
{
    using namespace my_space;
    using std::swap;

    int a(0), b(1);
    swap(a, b);

    Matrix<int> c(2, 3), d(4, 5);
    swap(c, d);

    Matrix<short> e(6, 7), f(8, 9);
    swap(e, f);
} 
```

由于您没有发布[SSCCE](http://sscce.org/)（*提示*、*提示*），因此很难准确看出哪里出错了，但您可以以此为起点来缩小问题范围。*****

# javascript - 浏览器是否可以缓存 Javascript/DOM 更改？

> ID：11570486
> 
> 赞同：0
> 
> 时间：2012-07-19T22:53:24.200
> 
> 标签：javascript, html, caching, browser, history.js

我正在开发一个使用 Javascript 进行样式设置的表单，该表单将用于提交许多不同的内容。然而，在大多数情况下，不同的东西只会略有不同，因此如果当您按下浏览器上的“*后退”*按钮时，表单与您提交表单之前离开时的表单完全相同，这将真正使用户受益。

**注意**：这在使用普通的 HTML/Javascript-less 表单时已经有效，我要问的问题是如何在使用 Javascript 隐藏/替换输入字段等时保留此功能。

我已经尝试过[History.js](https://github.com/balupton/history.js/)和 HTML5 `replaceState()`，但似乎没有任何效果。此外，如果有帮助，这将是一个需要安装最新浏览器的私人网站，因此请不要犹豫推荐仅在最新浏览器版本中可用的解决方案。

非常感谢！

**更新＃1**：这是一张更好地解释我需要的图片。

![图片](../Images/64cc399aad05a8280a5d4e2bf18dcd0f.png)

**更新#2**：好的，我成功破解了它，包括跨浏览器。明天睡觉后我会发布一个解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T17:50:01.450

好的，所以我回到绘图板并尝试使用我已经知道存在的工具来解决问题。每个浏览器*（通常没有测试任何非主流浏览器）*的情况是，当您在提交表单后按“**后退”**按钮时，通常会填充文本输入字段。我想看看这是否适用于隐藏的输入字段，事实证明确实如此！

所以接下来我设置了一些 Javascript 事件来监听页面加载。

```
if($.browser.mozilla)
{
    $(window).on('pageshow', pageManager.init);
}
else
{
    $(pageManager.init);
} 
```

这适用于 Chrome、Firefox 和 IE9。我还没有测试过任何其他浏览器，但这些是唯一可用于我的私人网站的浏览器，所以对我来说已经足够好了。我相信您可以根据自己的需要设置自己喜欢的解决方案，但这对我来说最有效。

无论如何，上面的代码意味着每次页面加载时，`pageManager.init()`都会运行。这是我用来检查是否按下**后退**按钮的代码摘录，它不仅仅是页面刷新或首次访问：

```
if($('input[name="form_submitted"]').val() != '')
{
    // back button was pressed
} 
```

如您所见，它就像检查隐藏的表单字段是否包含值一样简单。要真正保证会设置一个值，请确保在提交表单时设置：

```
$('#my-form').submit(function()
{
    $('input[name="form_submitted"]').val('true');
} 
```

它真的是那么简单。这是我能想到的确定浏览器的**后退**按钮是否被按下的最佳方法之一。现在，要缓存可见字段的所有表单值，它可以像`JSON.stringify()`在字段上使用并将其全部粘贴在稍后解码的隐藏字段中一样简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T01:50:38.803

AFAIK，这通常是手动处理的。也就是说，您使用主题标签或 pushState（带有适当的状态对象），并且在哈希更改或 popstate 上您获取哈希/状态，并根据需要（重新）构建您的 DOM。

（请注意，我在那里将两种非常不同的场景合二为一，抱歉。如果您只使用哈希更改，您可能不会使用`pushState`，因为根据 MDN`pushState`不会触发。）`onhashchange`

# eclipse - 有什么方法可以禁用 Eclipse CDT 中的前期索引？

> ID：11570490
> 
> 赞同：2
> 
> 时间：2012-07-19T22:53:38.287
> 
> 标签：eclipse, indexing, eclipse-cdt

当我使用 Eclipse CDT 时（这个问题现在已经存在于几个版本中），前期索引索引了一堆 C 头文件，并用 100 个我永远不会使用的 C 函数污染了代码完成。

这使我无法轻易看到我所在的名称空间中的实际内容，这真的很烦人。

为什么它们甚至默认包含在内，有没有办法删除它们？即使是一个丑陋的解决方法也很好，我只是想要一种方法来摆脱它们而不会破坏我的代码。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-06-04T14:45:18.240

您可以尝试调整索引器设置。这可以全局完成（在 Window -> Preferences -> C++ -> Indexer 中）或在每个项目的基础上完成（在 Project Properties -> C++ General -> Indexer 中）。尝试禁用`Index source files not included in the build`and `Index unused headers`。

# python - 图像未显示在 Django 应用程序上

> ID：11570491
> 
> 赞同：1
> 
> 时间：2012-07-19T22:53:39.190
> 
> 标签：python, django

我是一名 Django 初学者，试图通过 lightbird.net 上的本教程来构建照片共享应用程序。我在让照片显示在开发服务器上时遇到问题。虽然我可以在管理界面上上传和保存图像，但照片也不会显示在那里。相反，我只看到一个 jpeg 图标。当我在开发服务器上查看页面时，会出现相同的 jpeg 图标而不是照片。

昨天我花了一段时间才安装 PIL 和 jpeg 库，虽然我的应用程序现在运行没有错误，但我怀疑图像不显示的原因与这两个安装之一有关。我认为这可能是浏览器问题，但我无法查看来自 firefox、google chrome 或 safari 的图像。

在此先感谢您的帮助。这个网站很震撼！

代码的html是：

```
{% extends "pbase.html" %}

{% block content %}
    <div class="main">
        <!-- Albums -->
        <ul>
            {% for album in albums.object_list %}
                <div class="title">{{ album.title }} ({{ album.image_set.count}} images)</div>
                <ul>
                    {% for img in album.images %}
                        <a href="{{ media_url }}{{ img.image.name }}"><img border="0" alt="" 
                            src="{{ media_url }}{{ img.thumbnail2.name }}" /></a>
                    {% endfor %}
                </ul>
            {% endfor %}
        </ul>

        <!--Next/Prev page links-->
        {% if albums.object_list and albums.paginator.num_pages > 1 %}
        <div class="pagination">
            <span class="step-links">
                {% if albums.has_previous %}
                    <a href= "?page={{ albums.previous_page_number }}">previous &lt;&lt;</a>
                {% endif %}

                <span class="current"> 
                    &nbsp;Page {{ albums.number }} of {{ albums.paginator.num_pages }}
                </span>
                {% if albums.has_next %}
                    <a href="?page={{ albums.next_page_number }}"> &gt;&gt; next</a>
                {% endif %}
            </span>
        </div>
        {% endif %}
    </div>
{% endblock %} 
```

观点是：

```
def main(request):
    albums = Album.objects.all()
    if not request.user.is_authenticated():
        albums = albums.filter(public=True)

    paginator = Paginator(albums, 10)
    try: page = int(request.GET.get("page", "1"))
    except ValueError: page = 1

    try:
        albums = paginator.page(page)
    except(InvalidPage, EmptyPage):
        albums = paginator.page(paginator.num_pages)

    for album in albums.object_list:
        album.images = album.image_set.all()[:4]

    return render_to_response("list.html", {'albums':albums, 'user':request.user, 'media_url':MEDIA_URL}) 
```

我的模型是：

```
class Album(models.Model):
    title = models.CharField(max_length=60)
    public = models.BooleanField(default=False)
    def __unicode__(self):
        return self.title

    def images(self):
        lst = [x.image.name for x in self.image_set.all()]
        lst = ["<a href='/media/%s'>%s</a>" % (x, x.split("/")[-1])for x in lst]
        return join(lst, ",")
    images.allow_tags = True

class Tag(models.Model):
    tag = models.CharField(max_length=60)
    def __unicode__(self):
        return self.tag

class Image(models.Model):
    title = models.CharField(max_length=60, blank=True)
    image = models.FileField(upload_to="images/")
    tags = models.ManyToManyField(Tag, blank=True) 
    albums = models.ManyToManyField(Album, blank=True)
    created = models.DateTimeField(auto_now_add=True)
    rating = models.IntegerField(default=50)
    width = models.IntegerField(blank=True, null=True)
    height = models.IntegerField(blank=True, null=True)
    user = models.ForeignKey(User, null=True, blank=True)

    thumbnail2 = models.ImageField(upload_to="images/", blank=True, null=True)

    def save(self, *args, **kwargs):
        """save image dimensions."""
        super(Image, self).save(*args, **kwargs)
        im = PImage.open(os.path.join(MEDIA_ROOT, self.image.name))
        self.width, self.height = im.size

        # large thumb
        fn, ext = os.path.splitext(self.image.name)
        im.thumbnail((128,128), PImage.ANTIALIAS)
        thumb_fn = fn + "-thumb2" + ext
        tf2 = NamedTemporaryFile()
        im.save(tf2.name, "JPEG")
        self.thumbnail2.save(thumb_fn, File(open(tf2.name)), save=False)
        tf2.close()

        #small thumb
        im.thumbnail((40,40), PImage.ANTIALIAS)
        thumb_fn = fn + "-thumb" + ext
        tf = NamedTemporaryFile()
        im.save(tf.name, "JPEG")
        self.thumbnail2.save(thumb_fn, File(open(tf.name)), save=False)
        tf.close()

        super(Image, self).save(*args, **kwargs)    

    def size(self):
        return "%s x %s" % (self.width, self.height)

    def tags_(self):
        lst = [x[1] for x in self.tags.values_list()]
        return str(join(lst, ', '))

    def __unicode__(self):
        return self.image.name

    def albums_(self):
        lst = [x[1] for x in self.albums.values_list()]
        return str(join(lst, ', '))

    def thumbnail(self):
        return """<a href="/media/%s"><img border="0" alt="" src="/media%s" height="40" /></a>""" % (self.image.name, self.image.name)
    thumbnail.allow_tags = True 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-12T05:02:53.510

您可能还需要使用以下内容更新您的项目 urls.py：

```
(r'^media/(?P<path>.*)$', 'django.views.static.serve', {
'document_root': settings.MEDIA_ROOT}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-20T04:14:51.373

您可以使用`{{img.image.url}}`获取图像字段的绝对网址。我希望你已经提到了 [https://docs.djangoproject.com/en/dev/ref/models/fields/#django.db.models.FileField.storage](https://docs.djangoproject.com/en/dev/ref/models/fields/#django.db.models.FileField.storage)

[如何在 Django 模板中包含图像文件？](https://stackoverflow.com/questions/901551/how-do-i-include-image-files-in-django-templates)

[如何在从管理面板 Django 1.3 上传的模板中显示图像](https://stackoverflow.com/questions/6800166/how-to-show-an-image-in-template-uploaded-from-admin-panel-django-1-3)

# emacs - emacs, python-mode.el 定义键映射分配

> ID：11570493
> 
> 赞同：1
> 
> 时间：2012-07-19T22:53:46.927
> 
> 标签：emacs, key-bindings, python-mode

当我在 emacs 中加载 python-mode.el 文件时，我没有得到任何指定的键绑定。我开始使用该文件并注意到当我更改时：

```
(define-key map [(control c)(\#)] 'py-comment-region) 
```

至：

```
(define-key global-map [(control c)(\#)] 'py-comment-region) 
```

它工作正常。

我去查看定义映射变量的位置并看到：

```
(defvar py-shell-map nil
  "Keymap used in *Python* shell buffers.")

;; used by py-completion-at-point, the way of python.el
(defvar python-shell-map
  (let ((map (copy-keymap comint-mode-map)))
    (define-key map [tab]   'py-shell-complete)
    (define-key map "\C-c-" 'py-up-exception)
    (define-key map "\C-c=" 'py-down-exception)
    map)
  "Keymap used in *Python* shell buffers.") 
```

'map' 变量定义好吗？我应该对我的初始化文件做一些更改吗？我假设该文件对其他人都有效，那么为什么我需要将“地图”变量更改为“全局地图”才能在我的计算机上工作？

如果有任何帮助，我正在虚拟机中运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T04:32:07.103

您引用的您认为`map`定义的代码实际上并不是代码的相关部分。它是用于 python shell 的不同键盘映射，而不是在 Emacs 中编辑 python 文件时使用的键盘映射。

您正在编辑的行出现在`python-mode`以下代码块中：

```
(defvar python-mode-map)
(setq python-mode-map
      (let ((map (make-sparse-keymap)))
        ;; electric keys
        (define-key map [(:)] 'py-electric-colon)
        (define-key map [(\#)] 'py-electric-comment)
        ... 
```

如您所见，该变量`map`首先被初始化为“稀疏键映射”，然后在该映射中定义了某些键绑定，最后将该映射设置为`python-mode-map`. 后者是在缓冲区中使用的键映射`python-mode`。

所以键绑定应该可以工作 - 但当然只能在`python-mode`. `python-mode`要在缓冲区中激活，请键入`M-x python-mode`。这仅在文件`python-mode.el`加载后才有效。

您可以通过两种方式检查当前缓冲区是否存在`python-mode`：

*   您的模式行应显示字母“Py”
*   type `M-: ENTER major-mode ENTER`-> 这应该将“python-mode”打印到 minibuffer

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T04:26:43.753

每个主要模式和一些次要模式都有自己的键盘映射，它覆盖在全局键盘映射（即`global-map`）上。当您按下一个键时，Emacs 会尝试在覆盖的键映射中找到该键的绑定，然后回退到“更全局”的键，直到它到达全局映射。这就是为什么`global-map`有效而`map`无效的原因。

在 lisp 中，`let`用于绑定局部变量。该`map`变量不存在于之外`let`（或者它可能存在，但它可能不是您想要的那个）。阅读`let`和`defvar`（例如`C-h f defvar`）的文档。

您需要确定在主要模式中使用了哪个键映射，并`define-key`在其上使用。在这种情况下，`(define-key python-mode-map (kbd "C-c #") 'py-comment-region)`可能会起作用。注意我不使用 python-mode.el，但查看源代码似乎它`python-mode-map`用作键映射变量。其他键映射用于辅助缓冲区。

# android - 将开关放在Android上的操作栏内

> ID：11570494
> 
> 赞同：11
> 
> 时间：2012-07-19T22:53:48.340
> 
> 标签：android, android-actionbar

我正在做一个项目，我目前正试图在应用程序操作栏中放置一个开关（如在 wi-fi 设置中： http: [//tinypic.com/r/2l8vt35/6](http://tinypic.com/r/2l8vt35/6)）

如何才能做到这一点？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-19T23:53:52.030

添加`android:actionLayout`到您`<item>`的菜单 XML 资源中，指向一个布局 XML 资源，该资源具有您的`Switch`. 然后，使用`getActionView()`on`MenuItem`来注册监听器以了解交换机的变化。

请注意，`Switch`仅适用于 API 级别 14 及更高级别。

# grails - Grails数据绑定一对多关系

> ID：11570495
> 
> 赞同：0
> 
> 时间：2012-07-19T22:53:57.897
> 
> 标签：grails, one-to-many, cascade, all-delete-orphan

我正在尝试利用 Grails 为一对多关联处理数据绑定的能力。我能够成功地分配给关系，但删除单个元素或所有元素都不起作用。

这是我的模型的示例：

```
class Location {
    Float latitude
    Float longitude
}

class Route {
    Location start
    Location stop

    static belongsTo: [courier: Courier]
}

class Courier {
    String name
    static hasMany = [pickups: Location]
}

class ScheduledCourier extends Courier {
    static hasMany = [routes: Route]

    static mapping = {
        routes(cascade: 'all-delete-orphan')
    }
} 
```

通过网站创建一个新的 ScheduledCourier 对象时，我可以传递一个路由列表以自动与标记绑定，如下所示：

```
<input type="hidden" name="routes[0].latitude" value="5" />
<input type="hidden" name="routes[0].longitude" value="5" />
<input type="hidden" name="routes[1].latitude" value="10" />
<input type="hidden" name="routes[1].longitude" value="10" /> 
```

这在我的控制器中对我来说很好：

```
class CourierController {
    // Very simplistic save
    def saveScheduled = {
        def courier = new ScheduledCourier(params)
        courier.save()
    }

    // Very simplistic update
    def update = {
        def courier = Courier.get(params.id)
        courier.properties = params
        courier.save()
    }
} 
```

如果我改用以下标记，我可以单步调试调试器并看到 routes 属性现在是 [] 并且对象保存得很好，但记录不会从数据库中删除。

```
<input type="hidden" name="routes" value="" /> 
```

另外，如果我这样发送标记：

```
<input type="hidden" name="routes[0].latitude" value="5" />
<input type="hidden" name="routes[0].longitude" value="5" /> 
```

courier.routes 不会更新为仅包含 1 个对象。

有没有人见过这种行为？

这是 Grails 1.3.7……至少现在是这样。

编写了一个重现此行为的集成测试：

```
public void testCourierSave() {
    def l1 = new Location(latitude: 5, longitude: 5).save(flush: true)
    def l2 = new Location(latitude: 10, longitude: 10).save(flush: true)

    def params = ["name": "Courier", "pickups[0].id": l1.id, "pickups[1].id": l2.id,
        "routes[0].start.id": l1.id, "routes[0].stop.id": l2.id,
        "routes[1].start.id": l2.id, "routes[1].stop.id": l1.id]

    def c1 = new ScheduledCourier(params).save(flush: true)

    assertEquals(2, c1.routes.size())

    params = [routes: ""]
    c1.properties = params
    c1.save(flush: true)
    c1.refresh()    // Since the Routes aren't deleted, this reloads them

    assertEquals(0, c1.routes.size())    // Fails

    assertEquals([], Route.findAllByCourier(c1))    // Fails if previous assert is removed
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T06:34:36.520

我想知道是否正在发生以下情况：

传递`params [routes:""]`框架时忽略它，因为它只是一个空字符串。

同样`<input type="hidden" name="routes[0].latitude" value="5" />`，可能只是更新集合中的第零个路线条目，其他的不会被删除，因为你告诉它的是第零个路线的纬度值应该是 5，而不是现在应该是唯一的路线收藏。

为了得到你想要的效果，你需要`routes.clear()`在绑定参数之前添加一个。

要控制模型的状态何时持久保存到数据库，您可以使用Grails 中提供的[Spring 事务性。](http://grails.org/doc/latest/guide/single.html#programmaticTransactions)如果后续处理失败，这将允许您恢复到对象的原始状态。例如：

```
Courier.withTransaction {status ->

  // Load the courier

  //clear the existing routes

  // bind the new properties

  // perform extra processing

  //if the object is invalid, roll back the changes
  status.setRollbackOnly()

} 
```

# python - 在 Python 中的字典树中生成所有叶到根的路径

> ID：11570499
> 
> 赞同：5
> 
> 时间：2012-07-19T22:54:20.127
> 
> 标签：python, recursion, tree

我有一个“非标准”形式的字典树，如下所示：

```
tree = {'0': {'A': {'B': {'C': {}}}},
             {'D': {'E': {}},
                   {'F': {}}}} 
```

叶节点被定义为字典键值对，其中值是一个空字典。我想将所有叶到根路径提取为列表列表，如下所示：

```
paths_ = [['C', 'B', 'A', '0'],
          ['E', 'D', '0'],
          ['F', 'D', '0']] 
```

如果有帮助，路径也可以反转。

```
paths_ = [['0', 'A', 'B', 'C'],
          ['0', 'D', 'E'],
          ['0', 'D', 'F']] 
```

我知道我必须递归地执行它，并且我需要每个路径的累加器列表。如果函数产生路径列表也很好。我到目前为止是这样的：

```
def paths(node, subtree, acc=[]):
    if not subtree:
        yield [node]+acc
    for n, s in subtree.items():
        yield paths(n, s, acc) 
```

它并没有真正做到我想要的：

```
paths_ = list(paths('0', tree['0'])) 
```

理想情况下，这应该返回列表列表。任何帮助都感激不尽。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-19T23:23:07.490

假设您实际上打算使用以下结构`tree`：

```
tree = {'0': {'A': {'B': {'C': {}}},
              'D': {'E': {},
                    'F': {}}}} 
```

这是一个类似的`paths()`功能，应该做你想做的事：

```
def paths(tree, cur=()):
    if not tree:
        yield cur
    else:
        for n, s in tree.items():
            for path in paths(s, cur+(n,)):
                yield path 
```

结果：

```
>>> list(paths(tree))
[('0', 'A', 'B', 'C'), ('0', 'D', 'E'), ('0', 'D', 'F')] 
```

请注意，我使用元组而不是列表作为默认参数，这是因为[可变的默认参数会让您陷入困境](https://stackoverflow.com/q/1132941/505154)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-02-18T10:08:22.303

您可以使用类似于所选答案的内容。

```
 import collections

 def iter_paths(tree, parent_path=()):
     for path, node in tree.iteritems():
         current_path = parent_path + (path,)
         if isinstance(node, collections.Mapping):
             for inner_path in iter_paths(node, current_path):
                 yield inner_path
         else:
             yield current_path 
```

对于以下字典：

`tree = {'A':1, 'B':{'B1':1, 'B2':2}, 'C':{'C1':{'C11':1, 'C12':2},'C2':{'C21':1, 'C22':2}}}`

输出应该是（产量顺序可能不同）：

```
('A',)
('C', 'C2', 'C22')
('C', 'C2', 'C21')
('C', 'C1', 'C12')
('C', 'C1', 'C11')
('B', 'B1')
('B', 'B2') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T23:23:17.677

假设树结构是这种格式： {'0': {'A': {}, 'B': {}}} 那么这样的东西应该可以解决问题。

```
def paths(nodeId, children, ancestors, allPaths):
    ancestors.append(nodeId)
    if len(children) == 0:
        allPaths.append(ancestors)
    else:
        for childId in children:
            paths(childId, children[childId], ancestors[:], allPaths)

allPaths = []
paths('0', tree['0'], [], allPaths) 
```

像这样的东西应该工作。通常我会先试试这个，但我现在在我的 iPad 上。如果它不起作用，它应该给你一些想法。

# entity-framework - EF poertools beta 2 - 预生成视图部署错误

> ID：11570501
> 
> 赞同：1
> 
> 时间：2012-07-19T22:54:33.717
> 
> 标签：entity-framework, entity-framework-4, ef-code-first

我们使用 EF powertools beta 2，具有逆向工程代码优先功能来生成我们的 e 实体、上下文和视图。我们有奇怪的行为，在几台机器上的团队中，生成的编译视图的哈希是不同的，然后在 TFS 团队上构建与其他机器上的相同，我们得到如下异常。

问题是基于什么电动工具为编译视图生成哈希？并且我们可以更改它是一致的，我们使用带有 EF 4.3.1 的 power tools beta 2 ，system.data .v4.0.30319 ，针对使用 devart oracle 驱动程序的 Oracle db。

上下文生成视图

```
//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:4.0.30319.551
//
//     Changes to this file may cause incorrect behavior and will be lost if  the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

[assembly: System.Data.Mapping.EntityViewGenerationAttribute(typeof(Edm_EntityMappingGeneratedViews.ViewsForBaseEntitySetsC6473E0A11A196A36CC5839589DE2DE553F202E361016A89F2142797168B2534))]

namespace Edm_EntityMappingGeneratedViews
{
    /// <Summary>
    /// The type contains views for EntitySets and AssociationSets that were generated at design time.
    /// </Summary>
    public sealed class ViewsForBaseEntitySetsC6473E0A11A196A36CC5839589DE2DE553F202E361016A89F2142797168B2534 : System.Data.Mapping.EntityViewContainer
    {

        /// <Summary>
        /// The constructor stores the views for the extents and also the hash values generated based on the metadata and mapping closure and views.
        /// </Summary>
        public ViewsForBaseEntitySetsC6473E0A11A196A36CC5839589DE2DE553F202E361016A89F2142797168B2534()
        {
            this.EdmEntityContainerName = "Context";
            this.StoreEntityContainerName = "CodeFirstDatabase";
            this.HashOverMappingClosure = "2c6bbce22db7c9c65f8a70c5a1bae1225522a2124aad50e74bdc186ce8c70508";
            this.HashOverAllExtentViews = "26cad9d7334571a0116f89413345d00ec8e031706228df6e653c7b6396c94591";
            this.ViewCount = 56;
        }

exception :
System.Data.EntityCommandCompilationException: System.Data.EntityCommandCompilationException: An error occurred while preparing the command definition. 

System.Data.MappingException: The mapping and metadata information for EntityContainer 'MyContext' no longer matches the information used to create the pre-generated views.
   at System.Data.Mapping.StorageMappingItemCollection.ViewDictionary.SerializedAddGeneratedViewsInEntityViewContainer(MetadataWorkspace workspace, EntityViewContainer entityViewContainer, Dictionary`2 extentMappingViews)
   at System.Data.Mapping.StorageMappingItemCollection.ViewDictionary.SerializedCollectViewsFromObjectCollection(MetadataWorkspace workspace, Dictionary`2 extentMappingViews)
   at System.Data.Mapping.StorageMappingItemCollection.ViewDictionary.SerializedGetGeneratedViews(EntityContainer container)
   at System.Data.Common.Utils.Memoizer`2.<>c__DisplayClass2.<Evaluate>b__0()
   at System.Data.Common.Utils.Memoizer`2.Result.GetValue()
   at System.Data.Common.Utils.Memoizer`2.Evaluate(TArg arg)
   at System.Data.Mapping.StorageMappingItemCollection.ViewDictionary.GetGeneratedView(EntitySetBase extent, MetadataWorkspace workspace, StorageMappingItemCollection storageMappingItemCollection)
   at System.Data.Mapping.StorageMappingItemCollection.GetGeneratedView(EntitySetBase extent, MetadataWorkspace workspace)
   at System.Data.Metadata.Edm.MetadataWorkspace.GetGeneratedView(EntitySetBase extent)
   at System.Data.Query.PlanCompiler.PreProcessor.ExpandView(Node node, ScanTableOp scanTableOp, IsOfOp& typeFilter)
   at System.Data.Query.PlanCompiler.PreProcessor.ProcessScanTable(Node scanTableNode, ScanTableOp scanTableOp, IsOfOp& typeFilter)
   at System.Data.Query.PlanCompiler.PreProcessor.Visit(ScanTableOp op, Node n)
   at System.Data.Query.InternalTrees.ScanTableOp.Accept[TResultType](BasicOpVisitorOfT`1 v, Node n)
   at System.Data.Query.InternalTrees.BasicOpVisitorOfT`1.VisitNode(Node n)
   at System.Data.Query.PlanCompiler.SubqueryTrackingVisitor.VisitChildren(Node n)
   at System.Data.Query.PlanCompiler.SubqueryTrackingVisitor.VisitRelOpDefault(RelOp op, Node n)
   at System.Data.Query.PlanCompiler.PreProcessor.Visit(ProjectOp op, Node n)
   at System.Data.Query.InternalTrees.ProjectOp.Accept[TResultType](BasicOpVisitorOfT`1 v, Node n)
   at System.Data.Query.InternalTrees.BasicOpVisitorOfT`1.VisitNode(Node n)
   at System.Data.Query.PlanCompiler.SubqueryTrackingVisitor.VisitChildren(Node n)
   at System.Data.Query.PlanCompiler.SubqueryTrackingVisitor.VisitRelOpDefault(RelOp op, Node n)
   at System.Data.Query.PlanCompiler.PreProcessor.Visit(FilterOp op, Node n)
   at System.Data.Query.InternalTrees.FilterOp.Accept[TResultType](BasicOpVisitorOfT`1 v, Node n)
   at System.Data.Query.InternalTrees.BasicOpVisitorOfT`1.VisitNode(Node n)
   at System.Data.Query.PlanCompiler.SubqueryTrackingVisitor.VisitChildren(Node n)
   at System.Data.Query.PlanCompiler.SubqueryTrackingVisitor.VisitRelOpDefault(RelOp op, Node n)
   at System.Data.Query.PlanCompiler.PreProcessor.Visit(ProjectOp op, Node n)
   at System.Data.Query.InternalTrees.ProjectOp.Accept[TResultType](BasicOpVisitorOfT`1 v, Node n)
   at System.Data.Query.InternalTrees.BasicOpVisitorOfT`1.VisitNode(Node n)
   at System.Data.Query.PlanCompiler.SubqueryTrackingVisitor.VisitChildren(Node n)
   at System.Data.Query.InternalTrees.BasicOpVisitorOfNode.VisitDefault(Node n)
   at System.Data.Query.InternalTrees.BasicOpVisitorOfNode.VisitPhysicalOpDefault(PhysicalOp op, Node n)
   at System.Data.Query.InternalTrees.BasicOpVisitorOfT`1.Visit(PhysicalProjectOp op, Node n)
   at System.Data.Query.InternalTrees.PhysicalProjectOp.Accept[TResultType](BasicOpVisitorOfT`1 v, Node n)
   at System.Data.Query.InternalTrees.BasicOpVisitorOfT`1.VisitNode(Node n)
   at System.Data.Query.PlanCompiler.PreProcessor.Process()
   at System.Data.Query.PlanCompiler.PreProcessor.Process(PlanCompiler planCompilerState, StructuredTypeInfo& typeInfo)
   at System.Data.Query.PlanCompiler.PlanCompiler.Compile(List`1& providerCommands, ColumnMap& resultColumnMap, Int32& columnCount, Set`1& entitySets)
   at System.Data.Query.PlanCompiler.PlanCompiler.Compile(DbCommandTree ctree, List`1& providerCommands, ColumnMap& resultColumnMap, Int32& columnCount, Set`1& entitySets)
   at System.Data.EntityClient.EntityCommandDefinition..ctor(DbProviderFactory storeProviderFactory, DbCommandTree commandTree) 
```

# c# - SQLite 数据库插入非常慢

> ID：11570508
> 
> 赞同：0
> 
> 时间：2012-07-19T22:55:02.333
> 
> 标签：c#, sqlite

我正在使用 SQLite 数据库，并将记录插入其中。这需要很长时间！我见过有人说他们可以在一分钟内处理几千个。我有大约 2400 条记录。每条记录需要 30s-2m 才能完成。重新创建数据库不是一种选择。我试图以不同的方式创建一个交易。我需要使用计时器，因为我正在使用 a`ProgressBar`向我展示正在发生的事情。这是我正在使用的代码：

```
string con;
con = string.Format(@"Data Source={0}", documentsFolder);

SQLiteConnection sqlconnection = new SQLiteConnection(con);
SQLiteCommand sqlComm = sqlconnection.CreateCommand();
sqlconnection.Open();
SQLiteTransaction transaction = sqlconnection.BeginTransaction();

Timer timer2 = new Timer();
timer2.Interval = 1000;
timer2.Tick += (source, e) =>
                    {
                        URL u = firefox.URLs[count2];
                        string newtitle = u.title;
                        form.label1.Text = count2 + "/" + pBar.Maximum;
                        string c_urls = "insert or ignore into " + table + " (id,
 url, title, visit_count, typed_count, last_visit_time, hidden) values (" + dbID + ",'" + u.url + "','" 
    + newtitle + "',1,1, " + ToChromeTime(u.visited) + ", 0)";
                        string c_visited = "insert or ignore into " + table2 + " (id,
 url, 
    visit_time, transition) values (" + dbID2 + "," + dbID + "," + 
ToChromeTime(u.visited) + ",805306368)";
                        sqlComm = new SQLiteCommand(c_urls, sqlconnection);
                        sqlComm.ExecuteNonQuery();
                        sqlComm = new SQLiteCommand(c_visited, sqlconnection);
                        sqlComm.ExecuteNonQuery();

                        dbID++;
                        dbID2++;

                        pBar.Value = count2;
                        if (pBar.Maximum == count2)
                        {
                            pBar.Value = 0;
                            timer.Stop();
                            transaction.Commit();
                            sqlComm.Dispose();
                            sqlconnection.Dispose();
                            sqlconnection.Close();
                        }

                        count2++;
                    };
timer2.Start(); 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T23:33:54.930

这就是我要按顺序解决的问题。它可能会也可能不会解决问题，但看到它不会有什么坏处（而且它可能只是做了一些魔术）：

1.  确保数据库*没有*被更新（来自另一个线程、进程甚至计时器！）。写入者将获得锁，并且未关闭/运行时间过长的事务可能会以不良方式进行交互。（对于需要“30 秒到 2 分钟”的更新，我想在获取锁时会出现问题。还要确保数据库所在的媒体足够，例如本地驱动器。）

2.  交易未被使用 (??)。*在*计时器回调中移动事务，将其附加到适当的 SQLCommands，并在回调结束之前将其处理掉。（使用`using`）。

3.  并非所有 SQLCommand 都被正确处理。把每一个都扔掉。（使用`using`简化了这一点。不要让它流过回调。）

4.  未使用占位符。这不仅更简单易用，而且对 SQLite 和适配器也更加友好。

（仅作为示例；以下代码中可能存在错误。）

```
// It's okay to keep long-running SQLite connections.
// In my applications I have a single application-wide connection.
// The more important thing is watching thread-access and transactions.
// In any case, we can keep this here.
SQLiteConnection sqlconnection = new SQLiteConnection(con);
sqlconnection.Open();

// In timer event - remember this is on the /UI/ thread.
// DO NOT ALLOW CROSS-THREAD ACCESS TO THE SAME SQLite CONNECTION.
// (You have been warned.)
URL u = firefox.URLs[count2];
string newtitle = u.title;
form.label1.Text = count2 + "/" + pBar.Maximum;

try {
   // This transaction is ONLY kept about for this timer callback.
   // Great care must be taken with long-running transactions in SQLite.
   // SQLite does not have good support for (long running) concurrent-writers
   // because it must obtain exclusive file locks.
   // There is no Table/Row locks!
   sqlconnection.BeginTransaction();
   // using ensures cmd will be Disposed as appropriate.
   using (var cmd = sqlconnection.CreateCommand()) {
     // Using placeholders is cleaner. It shouldn't be an issue to
     // re-create the SQLCommand because it can be cached in the adapter/driver
     // (although I could be wrong on this, anyway, it's not "this issue" here).
     cmd.CommandText = "insert or ignore into " + table
       + " (id, url, title, visit_count, typed_count, last_visit_time, hidden)"
       + " values (@dbID, @url, 'etc, add other parameters')";
     // Add each parameter; easy-peasy
     cmd.Parameters.Add("@dbID", dbID);
     cmd.Parameter.Add("@url", u.url);
     // .. add other parameters
     cmd.ExecuteNonQuery();
   }
   // Do same for other command (runs in the same TX)
   // Then commit TX
   sqlconnection.Commit();
} catch (Exception ex) {
   // Or fail TX and propagate exception ..
   sqlconnection.Rollback();
   throw;
}

if (pBar.Maximum == count2)
{
    pBar.Value = 0;
    timer.Stop();
    // All the other SQLite resources are already
    // cleaned up!
    sqlconnection.Dispose();
    sqlconnection.Close();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-20T01:00:23.967

我不确定这是否是您的问题，但您使用 ADO.NET 的一般模式是错误的 - 您不应该为每次插入创建新命令（并反复为查询准备付费）。

相反，请执行以下操作：

*   循环前：
    *   一次创建命令。
    *   创建适当的绑定参数。
*   在循环：
    *   只需为绑定参数分配适当的值。
    *   并执行命令。

您还可以考虑使用不那么细粒度的事务：尝试在同一个事务中放入多个插入，以最大限度地减少[为事务持久性支付的费用](https://stackoverflow.com/a/11451927/533120)。

您可能还想看看[这篇文章](http://petesbloggerama.blogspot.com/2007/02/sqlite-adonet-prepared-statements.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-12-23T05:21:08.853

您可以尝试以下方法之一来提高性能：

*   **将所有插入包装在事务中**- 有助于减少对数据库的实际写入。
*   **使用 WAL** - [Write-Ahead-Log](https://www.sqlite.org/wal.html)是一种日志模式，可加快写入速度并启用并发性。（如果您的数据库位于网络位置，则不推荐）。
*   **同步 NORMAL** - 同步模式指示数据实际刷新到物理内存的频率（fsync() 调用）。这可能是一些机器上的时间，因此这种刷新发生的频率是至关重要的。确保`"Synchronous=NORMAL"`在大多数情况下显式打开具有理想的连接。`FULL`Synchronous MODE as和`NORMAL`(NORMAL 大约好 1000 倍)之间存在巨大差异。

在类似的帖子中查找更多详细信息 => [System.Data.SQLite 版本 1.0.74 和最新的 1.0.113 之间发生了什么变化？](https://stackoverflow.com/questions/65185112/what-changed-between-system-data-sqlite-version-1-0-74-and-the-most-recent-1-0-1/65256860#65256860)

# mysql - mysql文件系统

> ID：11570512
> 
> 赞同：0
> 
> 时间：2012-07-19T22:55:19.393
> 
> 标签：mysql, database

有没有办法创建这样的文件系统。每当注册新用户时，都会创建一个具有唯一 ID 的文件夹，用于在该用户的文件系统中存储图像。如果他/她为图片创建一个新相册，则会在该唯一文件夹内为用户创建另一个新文件夹。感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T23:01:15.753

您可以使用服务器端脚本来做到这一点。例如，使用 php，您可以使用以下`mkdir()`函数创建一个新目录：http: [//php.net/manual/en/function.mkdir.php](http://php.net/manual/en/function.mkdir.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T23:05:02.863

当心可扩展性问题。如果间接，我建议您添加另一个级别，即将用户目录存储在表中。起初，您可以随心所欲地创建目录结构，但是当您在一个文件系统级别拥有数万个目录时，您可能会遇到文件系统级别的性能问题。然后，您只需重新组织文件夹、移动文件和更新表格链接。

# windows-7 - 低级键盘挂钩

> ID：11570513
> 
> 赞同：4
> 
> 时间：2012-07-19T22:55:21.747
> 
> 标签：windows-7, keyboard, hook, drivers

我刚买了一个新键盘，我有兴趣准确跟踪我在键盘的整个生命周期中进行了多少次按键/敲击。（我只想记录keyUp，因为我不关心重复）

我一直在谷歌搜索最好的方法来做到这一点，但我什至不知道该采取什么方法，所以我在智能搜索时遇到了麻烦。此外，我真正使用过的唯一语言是 C#。没有用 C/C++ 或 WinAPI 做任何事情

直接修改Win 7驱动难吗？我确实希望能够从计算机启动的那一刻起记录击键，但这可能不容易做到。我更喜欢使用现有的驱动程序或挂钩，因为我现在真的不想学习设备驱动程序。

我已经简要地查看了 Ctrl2Cap，但我不知道如何修改类似的东西以适合我的情况。

我看过的其他问题，

*   [编写键盘设备驱动程序](https://stackoverflow.com/questions/3527707/writing-a-keyboard-device-driver)
*   [低级键盘 Hook 不在 UI 线程](https://stackoverflow.com/questions/10054839/low-level-keyboard-hook-not-at-ui-thread)

这表明编写 USB 过滤器驱动程序可能有效，但我不知道从哪里开始。 [在 Windows C++ 中禁用键盘？](https://stackoverflow.com/questions/1214648/disabling-the-keyboard-in-windows-c)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T18:59:53.207

没有必要走司机路线，这不适合胆小的人。您可以使用一个低级的键盘钩子，它可以在 .NET 中正常工作。

我做了一个快速的 bing 并在 codeplex [http://globalmousekeyhook.codeplex.com/上找到了以下内容](http://globalmousekeyhook.codeplex.com/)

它应该让你前进

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-10-18T03:29:20.043

如果你想这样做，你需要使用**Kernel Level Keylogger**。它在操作系统生效之前抓取击键，这对于检测技术来说 99% 是不可见的。然后，您可以在 Windows 登录屏幕上输入密码/用户名等内容。

@ChrisTaylor 的键盘记录器不适用于我认为的 WinLog-on 屏幕。如果您可以在系统键盘设备驱动程序执行操作之前安装键盘驱动程序过滤器，您也可以处理 Windows 用户登录屏幕。但要安装此驱动程序级别的密钥挂钩，您需要具有管理员权限。

我从 Github找到了[Unix](https://github.com/AishaNair/Key-Logger)和[Windows 键盘记录器。](https://github.com/akayn/kbMon)免费玩这个[https://www.adlice.com/kernelmode-rootkits-part-3-kernel-filters/](https://www.adlice.com/kernelmode-rootkits-part-3-kernel-filters/) 玩得开心！

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-08-09T18:38:05.457

那，你想要的很危险！使用相同的代码，每个人都可以创建键盘记录器* 但如果您不是病毒创建者，那么我建议您搜索“C/C++ 中的热键”或类似的东西，然后用热键勾住键盘！我用VB6编写了HotKey Maker，它可以从键盘的每个按钮上制作热键。但我真的对病毒不感兴趣 :) 祝你好运！

*病毒会挂在你的键盘上，并将你在键盘上写的所有内容发送给病毒所有者

# ruby - 找不到 Ruby Mechanize 代码转换器

> ID：11570516
> 
> 赞同：0
> 
> 时间：2012-07-19T22:55:29.723
> 
> 标签：ruby, character-encoding, mechanize, mechanize-ruby

例如，我尝试了很多东西：

[Ruby 1.9.3 编码问题上的机械化](https://stackoverflow.com/questions/8768929/mechanize-on-ruby-1-9-3-encoding-issue)以及 [如何从 Mechanize::File 对象转换为 Mechanize::Page 对象？](https://stackoverflow.com/questions/10286700/how-do-i-convert-from-a-mechanizefile-object-to-a-mechanizepage-object)

但我不断得到的错误是

```
.rvm/gems/ruby-1.9.3-p194/gems/mechanize-2.0.1/lib/mechanize/util.rb:59:in `encode': code converter not found (UTF-8 to UTF8) (Encoding::ConverterNotFoundError)
    from /home/dhahn/.rvm/gems/ruby-1.9.3-p194/gems/mechanize-2.0.1/lib/mechanize/util.rb:59:in `encode_to'
    from /home/dhahn/.rvm/gems/ruby-1.9.3-p194/gems/mechanize-2.0.1/lib/mechanize/util.rb:45:in `from_native_charset'
    from /home/dhahn/.rvm/gems/ruby-1.9.3-p194/gems/mechanize-2.0.1/lib/mechanize/form.rb:187:in `from_native_charset'
    from /home/dhahn/.rvm/gems/ruby-1.9.3-p194/gems/mechanize-2.0.1/lib/mechanize/form.rb:181:in `block in proc_query'
    from /home/dhahn/.rvm/gems/ruby-1.9.3-p194/gems/mechanize-2.0.1/lib/mechanize/form.rb:180:in `map'
    from /home/dhahn/.rvm/gems/ruby-1.9.3-p194/gems/mechanize-2.0.1/lib/mechanize/form.rb:180:in `proc_query'
    from /home/dhahn/.rvm/gems/ruby-1.9.3-p194/gems/mechanize-2.0.1/lib/mechanize/form.rb:206:in `block in build_query'
    from /home/dhahn/.rvm/gems/ruby-1.9.3-p194/gems/mechanize-2.0.1/lib/mechanize/form.rb:198:in `each'
    from /home/dhahn/.rvm/gems/ruby-1.9.3-p194/gems/mechanize-2.0.1/lib/mechanize/form.rb:198:in `build_query'
    from /home/dhahn/.rvm/gems/ruby-1.9.3-p194/gems/mechanize-2.0.1/lib/mechanize/form.rb:249:in `request_data'
    from /home/dhahn/.rvm/gems/ruby-1.9.3-p194/gems/mechanize-2.0.1/lib/mechanize.rb:618:in `post_form'
    from /home/dhahn/.rvm/gems/ruby-1.9.3-p194/gems/mechanize-2.0.1/lib/mechanize.rb:520:in `submit'
    from /home/dhahn/.rvm/gems/ruby-1.9.3-p194/gems/mechanize-2.0.1/lib/mechanize/form.rb:167:in `submit'
    from /home/dhahn/user-management/test_script/EWI.rb:73:in `add_ext'
    from testewi.rb:15:in `<main>' 
```

我有一个使用 mechanize 的类，它适用于 ruby​​ 1.8.7，但我需要它适用于 1.9.3，因为 Rails 应用程序的其余部分在 1.9.3 中。抱歉，我现在有点混乱，所以如果我需要包含其他内容，请告诉我。这也是我在这里的第一个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T23:02:43.400

您正在访问的页面可能错误地描述了其编码。

我认为解决方法是自己改变它，通过做类似的事情

```
page.encoding = "utf-8" 
```

# javascript - 在我的 WebView 中实现脚本

> ID：11570517
> 
> 赞同：0
> 
> 时间：2012-07-19T22:55:32.903
> 
> 标签：javascript, android, webview

我有这个 WebView，我想在其中打开这个脚本。我该怎么做呢？

```
WebView webview = (WebView) findViewById(R.id.webView1);
   webview.getSettings().setJavaScriptEnabled(true);
    webview.loadUrl("javascript:<script>http://ad.leadboltads.net/show_app_ad.js?section_id=xxxxxxxxx</script>") 
```

这是脚本：

```
<script type="text/javascript" src="http://ad.leadboltads.net/show_app_ad.js?section_id=xxxxxxxx"></script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T23:36:28.133

像这样尝试，我还没有测试过，所以可能会有小错误。但它应该给你的想法：

```
webview.getSettings().setJavaScriptEnabled(true);  
webview.setWebViewClient(new WebViewClient() {  
  @Override  
  public void onPageFinished(WebView view, String url){
    webview.loadUrl("javascript:(function() { " +  
    "var script=document.createElement('script');" +
    "script.type='text/javascript';" + 
    "script.src='http://ad.leadboltads.net/show_app_ad.js?section_id=xxxxxxxx';" +
    "document.getElementsByTagName('head').item(0).appendChild(script);"+  
    "})");  
  }  
});  
webview.loadUrl("http://www.google.com"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T23:45:50.060

这是解决方案：

```
 WebView webview = (WebView) findViewById(R.id.webView1);
    webview.setVisibility(View.VISIBLE);
    webview.bringToFront();
    webview.getSettings().setJavaScriptEnabled(true);
    webview.setBackgroundColor(Color.TRANSPARENT);
    String html = "<script type='text/javascript' src='http://ad.leadboltads.net/show_app_ad.js?section_id=xxxxxxxx'></script>";
    webview.loadData(html, "text/html", "utf-8"); 
```

# php - PHP脚本计算code128

> ID：11570519
> 
> 赞同：2
> 
> 时间：2012-07-19T22:55:39.667
> 
> 标签：php, barcode, code128

在整个网络上，我都可以找到如何使用 php 生成条形码图像的示例。

但是我需要将字符串转换为 code128 值的函数，以便我可以在 OpenOffice 和 Word 中使用它，使用 code128 字体对其进行格式化并获得真正的条形码。

虽然理论上我可以自己编码，但我相信已经有很好的和经过测试的解决方案。

更准确地说：我需要将“3870639399632”变成“ÍFf_}Ç_È2yÎ”的脚本。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T23:05:30.967

试试： [http ://barcode-coder.com/en/barcode-php-class-203.html](http://barcode-coder.com/en/barcode-php-class-203.html)

或者，如果您使用 PEAR，您可以使用[http://pear.php.net/package/Image_Barcode2](http://pear.php.net/package/Image_Barcode2)

还有[http://www.brandonchecketts.com/archives/quick-php-script-to-generate-a-barcode](http://www.brandonchecketts.com/archives/quick-php-script-to-generate-a-barcode)和[http://www.barcodebakery.com/en](http://www.barcodebakery.com/en)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-09-07T10:08:37.833

使用作曲家包“hbgl/php-code-128-encoder”。 [https://packagist.org/packages/hbgl/php-code-128-encoder](https://packagist.org/packages/hbgl/php-code-128-encoder)

```
$encoded = Code128Encoder::encode('ABC123456DEF');
assert ($encoded === 'ÌABCÇ,BXÈDEFqÎ'); 
```

# c# - 数据表未显示 C#

> ID：11570520
> 
> 赞同：0
> 
> 时间：2012-07-19T22:55:46.693
> 
> 标签：c#, winforms, datagridview, datatable

我有这个数据表，它将显示数据库中的值。

```
 private void CreateTable() {
    dt = new DataTable();
    dt.Columns.Add("ScheduleID", typeof(int));
    dt.Columns.Add("Username", typeof(string));
    dt.Columns.Add("Subject", typeof(string));
    dt.Columns.Add("Description", typeof(string));
    ... } 
```

我正在使用这段代码，没有错误，但我不知道为什么这些值没有显示出来。有什么帮助吗？谢谢。

```
dgvSchedule.DataSource = new DataView(dt, "Username = '" + lblUsername.Text + "' and Subject = '" + cbxSubject.Text + "'", "Subject", DataViewRowState.CurrentRows); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T23:06:54.210

同意其他评论，并且数据视图的构造函数似乎不正确。

[DataView Constructors](http://msdn.microsoft.com/en-us/library/system.data.dataview.dataview.aspx)，但这可能取决于您使用的框架

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T23:14:28.237

为了便于阅读，我在这里发布我的答案。

如果 dt 是你的数据表，那么你可以做这样的事情

```
var row = dt.NewRow(); 
row["ScheduleID"] = 5; 
row["Username"] = "kerzek";
dt.rows.add(row); 
```

# android - Android：如何查询存储桶名称列表

> ID：11570521
> 
> 赞同：12
> 
> 时间：2012-07-19T22:55:46.477
> 
> 标签：android, gallery, bucket

我只想检索存储桶的名称（相册）。例如，相机、下载等，但不是所有照片中的相机、下载等列表，那么如何为每个存储桶名称分别检索一行？

我在图库应用程序中的意思是，您首先拥有相册，例如相机。当您单击它时，它会显示相机的所有照片。

我可以使用查询的 Where 子句查询相机胶卷中的照片。但是，如果我只想要每个专辑的名称而不是照片的名称，是否可以查询呢？如果我查询所有照片并且每组照片只拍摄一行，那么这将非常耗时。

请帮忙

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-12-10T05:05:18.373

我有同样的问题，这是我的解决方案（在跟踪画廊源代码之后）来获取专辑名称和其中的第一张图片（可以用作这张专辑的缩略图）：

（请注意，桶重复被 groupby 和 order 技术删除）

```
 // which image properties are we querying
    String[] PROJECTION_BUCKET = {
            ImageColumns.BUCKET_ID,
            ImageColumns.BUCKET_DISPLAY_NAME,
            ImageColumns.DATE_TAKEN,
            ImageColumns.DATA};
    // We want to order the albums by reverse chronological order. We abuse the
    // "WHERE" parameter to insert a "GROUP BY" clause into the SQL statement.
    // The template for "WHERE" parameter is like:
    //    SELECT ... FROM ... WHERE (%s)
    // and we make it look like:
    //    SELECT ... FROM ... WHERE (1) GROUP BY 1,(2)
    // The "(1)" means true. The "1,(2)" means the first two columns specified
    // after SELECT. Note that because there is a ")" in the template, we use
    // "(2" to match it.
    String BUCKET_GROUP_BY =
            "1) GROUP BY 1,(2";
    String BUCKET_ORDER_BY = "MAX(datetaken) DESC";

    // Get the base URI for the People table in the Contacts content provider.
    Uri images = MediaStore.Images.Media.EXTERNAL_CONTENT_URI;

    Cursor cur = getContentResolver().query(
            images, PROJECTION_BUCKET, BUCKET_GROUP_BY, null, BUCKET_ORDER_BY);

    Log.i("ListingImages"," query count=" + cur.getCount());

    if (cur.moveToFirst()) {
        String bucket;
        String date;
        String data;
        int bucketColumn = cur.getColumnIndex(
                MediaStore.Images.Media.BUCKET_DISPLAY_NAME);

        int dateColumn = cur.getColumnIndex(
                MediaStore.Images.Media.DATE_TAKEN);
        int dataColumn = cur.getColumnIndex(
                MediaStore.Images.Media.DATA);

        do {
            // Get the field values
            bucket = cur.getString(bucketColumn);
            date = cur.getString(dateColumn);
            data = cur.getString(dataColumn);

            // Do something with the values.
            Log.i("ListingImages", " bucket=" + bucket 
                    + "  date_taken=" + date
                    + "  _data=" + data);
        } while (cur.moveToNext());
    } 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-09-30T12:33:08.103

这里是。这个对我有用：

```
Uri images = MediaStore.Images.Media.EXTERNAL_CONTENT_URI;
    String[] projection = new String[]{   
            MediaStore.Images.Media.BUCKET_ID,
            MediaStore.Images.Media.BUCKET_DISPLAY_NAME,
            MediaStore.Images.Media.DATE_TAKEN,
            MediaStore.Images.Media.DATA
    };

    String BUCKET_ORDER_BY = MediaStore.Images.Media.DATE_MODIFIED + " DESC";
    String BUCKET_GROUP_BY = "1) GROUP BY 1,(2";
    Cursor imagecursor = managedQuery(images,
            projection, // Which columns to return
            BUCKET_GROUP_BY,       // Which rows to return (all rows)
            null,       // Selection arguments (none)
            BUCKET_ORDER_BY        // Ordering
            );

    this.imageUrls = new ArrayList<String>();
    this.imageBuckets  = new ArrayList<String>();
    for (int i = 0; i < imagecursor.getCount(); i++)
    {
        imagecursor.moveToPosition(i);
        int bucketColumnIndex = imagecursor.getColumnIndex(MediaStore.Images.Media.BUCKET_DISPLAY_NAME);
        String bucketDisplayName = imagecursor.getString(bucketColumnIndex);
        imageBuckets.add(bucketDisplayName);
        int dataColumnIndex = imagecursor.getColumnIndex(MediaStore.Images.Media.DATA);
        imageUrls.add(imagecursor.getString(dataColumnIndex));

    } 
```

imageBuckets Arraylist 包含专辑名称

imageUrls Arraylist 包含专辑最后修改图像的路径，您可以将其用作缩略图

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-03-06T15:45:10.473

使用以下功能获取 Video 或 Images 专辑：

```
 /*
    *
    *   Author : @nieldeokar
    *   mediaType could be one of
    *
    *   public static final int MEDIA_TYPE_IMAGE = 1;
    *
    *   public static final int MEDIA_TYPE_VIDEO = 3;
    *
    *   from android.provider.MediaStore class
    *
    */
fun getAlbumList(mediaType: Int, contentResolver: ContentResolver) {
    val countColumnName = "count"
    var contentUri = MediaStore.Images.Media.EXTERNAL_CONTENT_URI
    if (mediaType == MEDIA_TYPE_VIDEO) {
        contentUri = MediaStore.Video.Media.EXTERNAL_CONTENT_URI
    }

    val projection = arrayOf(ImageColumns.BUCKET_ID, ImageColumns.BUCKET_DISPLAY_NAME, ImageColumns.DATE_TAKEN, ImageColumns.DATA)
    val bucketGroupBy = "1) GROUP BY ${ImageColumns.BUCKET_ID}, (${ImageColumns.BUCKET_DISPLAY_NAME}"
    val bucketOrderBy = MediaStore.Images.Media.DATE_MODIFIED + " DESC"

    val cursor = contentResolver.query(contentUri, projection, bucketGroupBy, null, bucketOrderBy)

    if (cursor != null) {
        while (cursor.moveToNext()) {
            val bucketId = cursor.getString(cursor.getColumnIndexOrThrow(MediaStore.Images.ImageColumns.BUCKET_ID))
            val name = cursor.getString(cursor.getColumnIndexOrThrow(MediaStore.Images.ImageColumns.BUCKET_DISPLAY_NAME))
            val path = cursor.getString(cursor.getColumnIndexOrThrow(MediaStore.MediaColumns.DATA)) // Thumb image path

            val selection = MediaStore.Images.Media.BUCKET_ID + "='" + bucketId + "'"

            val countCursor = contentResolver.query(contentUri, arrayOf( "count(" + MediaStore.Images.ImageColumns._ID + ")"), selection, null, null)

            var count = 0
            if (countCursor != null) {
                countCursor.moveToFirst()
                count = countCursor.getInt(0)
                countCursor.close()
            }

            Log.d("AlbumScanner", "bucketId : $bucketId | name : $name | count : $count | path : $path")
        }
        cursor.close()

    }

} 
```

这形成了一个 SQL 语句：

```
SELECT bucket_id, bucket_display_name, datetaken, _data FROM images WHERE (1) GROUP BY bucket_id,(bucket_display_name) ORDER BY date_modified DESC 
```

**更新：** 正如@PerracoLabs 指出的那样，此代码需要改进以针对**Android Q**。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-09T17:10:55.133

您可以查询 MediaStore.Images.Media.BUCKET_DISPLAY_NAME 。Peter Knego[提供了一个很好的例子。](https://stackoverflow.com/questions/4195660/get-list-of-photo-galleries-on-android)这是一个很好的示例，您可以使用 ContentResolver 对象中的 query() 来更新它，而不是使用已弃用的 managedQuery()。

```
// which image properties are we querying
String[] projection = new String[]{
        MediaStore.Images.Media._ID,
        MediaStore.Images.Media.BUCKET_DISPLAY_NAME,
        MediaStore.Images.Media.DATE_TAKEN
};

// Get the base URI for the People table in the Contacts content provider.
Uri images = MediaStore.Images.Media.EXTERNAL_CONTENT_URI;

// Make the query.
ContentResolver cr = getContentResolver();
Cursor cur = cr.query(images,
        projection, // Which columns to return
        "",         // Which rows to return (all rows)
        null,       // Selection arguments (none)
        ""          // Ordering
        );

Log.i("ListingImages"," query count="+cur.getCount());

if (cur.moveToFirst()) {
    String bucket;
    String date;
    int bucketColumn = cur.getColumnIndex(
        MediaStore.Images.Media.BUCKET_DISPLAY_NAME);

    int dateColumn = cur.getColumnIndex(
        MediaStore.Images.Media.DATE_TAKEN);

    do {
        // Get the field values
        bucket = cur.getString(bucketColumn);
        date = cur.getString(dateColumn);

        // Do something with the values.
        Log.i("ListingImages", " bucket=" + bucket 
               + "  date_taken=" + date);
    } while (cur.moveToNext());

} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2017-03-08T09:02:15.187

在查询中进行投影，如下所示：

```
String bucketProjection[] = {"Distinct "+ MediaStore.Images.Media.BUCKET_DISPLAY_NAME}; 
```

# oracle - 甲骨文合并。我该如何使用它？

> ID：11570527
> 
> 赞同：5
> 
> 时间：2012-07-19T22:56:21.833
> 
> 标签：oracle, plsql, upsert

我有这个功能：

```
 Procedure UpdateDefaultWeight  ( vYear Number, costWeight Number, qualityWeight Number, serviceWeight Number ) 
      AS

        type weight_table is table of Number(5,2) index by varchar2(50);
        weightArray weight_table;
        currentPosition varchar2(50);
      Begin

        weightArray('Cost Weighting')    := costWeight;
        weightArray('Quality Weighting') := qualityWeight;
        weightArray('Service Weighting') := serviceWeight;

        currentPosition := weightArray.first;

        Loop
          Exit When currentPosition is null;
          Insert Into GVS.GVSSD16_DFLT_WEIGHT
            ( cal_year, metric_name, metric_val )
          Values
            ( vYear, currentPosition, weightArray(currentPosition) ); 

          currentPosition := weightArray.next(currentPosition);
        End Loop;
      END; 
```

现在当我写它时，它只是做一个 INSERT。但是，我需要它来 UPSERT。我查看了有关 MERGE 的文档，但主要是让我对如何将语法应用于我的特定案例感到困惑。

我看过[这里](https://stackoverflow.com/questions/237327/oracle-how-to-upsert-update-or-insert-into-a-table)和[这里](http://www.idevelopment.info/data/Oracle/DBA_tips/SQL/SQL_14.shtml)，我得到了它的要点，但语法让我失望。

有人愿意帮助 Oracle 新手吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-20T00:20:36.350

假设 cal_year 和 metric_name 定义了连接标准，这应该让你接近（未经测试）：

```
MERGE INTO GVS.GVSSD16_DFLT_WEIGHT d
     USING (SELECT vYear AS YY,
                   currentPosition AS POS,
                   weightArray (currentPosition) AS WA
              FROM DUAL) v
        ON (d.cal_year = v.YY AND d.metric_name = v.pos)
WHEN MATCHED
THEN
   UPDATE SET metric_val = v.WA
WHEN NOT MATCHED
THEN
   INSERT     (cal_year, metric_name, metric_val)
       VALUES (v.YY, v.POS, v.WA); 
```

# java - Java 不遵循代码？

> ID：11570533
> 
> 赞同：3
> 
> 时间：2012-07-19T22:57:41.683
> 
> 标签：java

这是我认为不遵循代码应该做什么的代码片段：

```
public void updateTimeElapsed() {
    timeElapsedLabel.setText("Time elapsed: " + ((System.nanoTime() - time) / Math.pow(10, 9)));
}

public void updateTimeElapsedIndefinitely() {
    while (true) {
        //System.out.println("Hi");
        //TODO: Why this no work?
        if (start) { System.out.println("Shoulda'"); updateTimeElapsed(); }
    }
} 
```

如果我评论

```
System.out.println("Hi") 
```

该代码显然不起作用。如果我取消注释它，那么它就是！

注意：当您按下“s”开始游戏时，start 为真。但是，该方法是在开始时调用的，所以“hi”应该显示很多次并且无限期地显示，直到我按下“s”键。

一张图说一千个字，那我给你上百张图（视频）来解释我的意思： [https ://dl.dropbox.com/u/2792692/CodeWeird.ogv](https://dl.dropbox.com/u/2792692/CodeWeird.ogv)

[https://dl.dropbox.com/u/2792692/CodeWeird.wmv](https://dl.dropbox.com/u/2792692/CodeWeird.wmv)

谁能告诉我发生了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-19T23:14:59.777

看起来布尔值`start`正在由另一个线程更新，但您没有将其声明为`volatile`，因此循环永远不会查看更新的值。

通过添加 println 来“修复”它只是 JVM 在获取控制台打印机的本机系统对象时管理线程堆栈状态的方式的一个奇怪结果。解决方法是使 start 不稳定和/或在访问它时同步。

SCCE：

从不打印：

```
public class Testit {

    public static void main(String[] args) {
        busted t = new busted();
        t.start();
        try {
        Thread.sleep(1000L);
        } catch (Exception e) {}
        t.startUpdating();

}

    public static class busted extends Thread {

        private boolean start = false;

        public void startUpdating() {
            start = true;
        }

        @Override
        public void run() {
            updateTimeElapsedIndefinitely();
        }

        public void updateTimeElapsedIndefinitely() {
            while (true) {
                if (start) {
                    System.out.println("Hello");
                }
            }
        }
    }
} 
```

在 1 秒后开始向 Hello 发送垃圾邮件，方法是更改​​为：

`private volatile boolean start = false;`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T23:30:29.547

我认为 Affe 的想法可能是个好主意，但我想建议你在未来尝试使用[Timer](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Timer.html)而不是 while(true) 循环。至少在我看来要好得多。

# ruby-on-rails - 为什么这个 AWS rails 函数 url_for 不为我的请求设置内容处置？

> ID：11570534
> 
> 赞同：2
> 
> 时间：2012-07-19T22:57:42.277
> 
> 标签：ruby-on-rails, amazon-s3, content-disposition

我正在使用带有 ruby​​ 1.8.7 的 rails 2.3.14。我正在生成经过身份验证的 URL 以获取 S3 对象，并且我正在使用最新的 aws-sdk gem。我看过这个答案，我的代码是一样的：[AWS S3 Ruby url_for response headers (custom file name and file type)](https://stackoverflow.com/questions/10429050/aws-s3-ruby-url-for-response-headers-custom-file-name-and-file-type)

这是我的代码。当我点击生成的 url 时，它没有在响应中设置 content-disposition 标头，它似乎完全忽略了该选项。我究竟做错了什么？

```
AWS::S3::S3Object.url_for(key, bucket, 
    :authenticated => true, 
    :use_ssl => (ENV['RAILS_ENV'] == 'production'),
    :expires_in => S3_EXPIRE_TIME,
    :response_content_disposition => 'attachment;'   # seconds
    ) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T11:58:36.487

就像链接的帖子所建议的那样，确保您使用的是[aws-sdk](http://rubygems.org/gems/aws-sdk) gem，而不是[aws-s3](http://rubygems.org/gems/aws-s3) gem。

# objective-c - 以编程方式使用 BWToolkit

> ID：11570543
> 
> 赞同：2
> 
> 时间：2012-07-19T22:58:48.270
> 
> 标签：objective-c, xcode, cocoa, bwtoolkit

Xcode 不再支持 ibplugins，所以我想知道是否有人有任何以编程方式使用 BWToolkit 的经验。基本上 BWSplitView 做了我需要的一切（网站上的介绍视频说明了一切），但我对如何使用该课程有点迷茫。

有人做过吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-01T21:56:11.413

通过查看`BWToolkit`我注意到的一些关键事项。

*   `BWSplitView`是 的子类`NSSplitView`。所以它应该有一些类似的方法（即init方法）。

*   `BWSplitView`确实有一种`init`方法可以将其用作
    单例。

话虽这么说（在 Xcode 中没有尝试任何这些），您应该能够创建一个`BWSplitView`使用它的超类的实例`NSSplitView`init 方法。然后将其添加到您的视图中。

这是一个示例（同样，未经测试）：

```
BWSplitView *splitView = [[BWSplitView alloc] initWithFrame:[[theWindow contentView] bounds]];

NSTextView *textView1 = [NSTextView new];
NSTextView *textView2 = [NSTextView new];

[splitView addSubview:textView1];
[splitView addSubview:textView2];

[splitView adjustSubviews];

[[theWindow contentView] addSubview:splitView];

[textView1 release];
[textView2 release]; 
```

您可能必须将一些访问器方法写入 BWSplitView 私有方法。

希望这可以帮助。

# actionscript-3 - 预加载器闪存 AS3 它不再工作 [GZIP 问题]

> ID：11570544
> 
> 赞同：0
> 
> 时间：2012-07-19T22:59:36.810
> 
> 标签：actionscript-3, preloader

我在下面使用这个预加载器 AS3 代码。它不工作！当我在 Flash CS5.5 上执行时工作正常，但不能在线。

```
var l:Loader = new Loader();
l.contentLoaderInfo.addEventListener(ProgressEvent.PROGRESS, loop);
l.contentLoaderInfo.addEventListener(Event.COMPLETE, done);
l.load(new URLRequest("movie.swf"));

function loop(e:ProgressEvent):void
{
    var perc:Number = e.bytesLoaded / e.bytesTotal;
    percent.text = Math.ceil(perc*100).toString();
}

function done(e:Event):void
{
    removeChildAt(0);
    percent = null;
    addChild(l);
} 
```

**我找到了问题和解决方案！**

问题是因为我的在线服务器在 Apache 上为 mod_deflate 选项启用了 gzip。

mod_deflate 模块提供了 DEFLATE 输出过滤器，它允许您的服务器的输出在通过网络发送到客户端之前被压缩。

所以movie.swf是用gzip压缩的。那是个大问题。

**解决方案：**

好吧，只需在服务器根文件夹的 .htaccess 文件中创建或放入一些代码。

创建一个文件（或将此代码放入）.htaccess

```
SetEnv no-gzip dont-vary 

# Don't compress images/flash  
SetEnvIfNoCase Request_URI \ 
\.(?:gif|jpe?g|png|swf|flv)$ no-gzip dont-vary 
```

玩得开心：P

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T13:15:29.703

问题是，当您在线上传它时，程序试图到达您上传它的站点 FTP 上的 movie.swf。所以movie.swf到你自己的域，然后粘贴它的url。例如：

```
l.load(new URLRequest("http://mysite.com/movie.swf")); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-02T16:16:28.557

如果您可以访问服务器的 .htaccess 文件，则您的解决方案非常有效，但如果您没有，该怎么办。我发现我可以通过在我的 HTTP 请求中添加一个标头来解决这个问题。默认情况下，IE 会有一个名为“Accept-Encoding”的请求头，设置为“gzip,deflate”。您可以覆盖它并将其值设置为“x”或其他内容。除了“gzip”之外的任何东西

例如。

var header:URLRequestHeader = new URLRequestHeader("Accept-Encoding", "xxx");

var request:URLRequest = new URLRequest(" [http://www.whatever.com/myfile.zip](http://www.whatever.com/myfile.zip) "); request.requestHeaders = [标题];

var loader:Loader = new Loader(); loader.load（请求）；

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T23:32:04.507

如果它不能在线工作但在本地工作，那么这里有几个很好的起点。

1.  确保您的文件位于您的应用程序认为的位置
2.  确保从闪存导出时，您的网络设置设置为远程而不是本地。要检查这一点，请转到“发布设置”，然后转到“Flash”选项卡，然后转到“本地播放安全”的高级部分。

侦听错误而不只是 loader 上的进度/完成事件是一种很好的做法，这样您就可以更轻松地追踪这些问题。

[`IOErrorEvent.IO_ERROR`](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/events/IOErrorEvent.html#IO_ERROR)听众会[`SecurityErrorEvent.SECURITY_ERROR`](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/events/SecurityErrorEvent.html#SECURITY_ERROR)确认上述可能存在的问题。

# vb.net - 从 vb.net 调用 php 文件的最快方法是什么

> ID：11570549
> 
> 赞同：2
> 
> 时间：2012-07-19T23:00:31.570
> 
> 标签：vb.net, sockets

从 vb.net 调用 php 文件的最佳方法是什么？理想情况下，我需要一些可以放在函数中并使用几个参数调用以传递到 url 字符串的东西。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T02:16:38.100

您可以使用[System.Net.HttpWebRequest](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest%28v=vs.80%29.aspx)：

```
 Dim request As System.Net.HttpWebRequest = System.Net.HttpWebRequest.Create(New System.Uri("http://contoso.com/query.php?param1=val1&param2=val2"))

    request.Method = System.Net.WebRequestMethods.Http.Get

    Dim response As System.Net.HttpWebResponse = request.GetResponse()

    ' process response here

    response.Close() 
```

# java - 瓷砖游戏行走动画

> ID：11570552
> 
> 赞同：2
> 
> 时间：2012-07-19T23:00:44.993
> 
> 标签：java, animation, tile

我想在我正在制作的游戏中实现步行动画，但我不确定推荐的方式是什么。

[你可以在这里](http://www.youtube.com/watch?v=NHjm0SAuTtw)看到我的游戏进度Pokémon 图形只是在测试时，所以不用担心。

如您所见，我现在只有一个粉红色的正方形，但在调试信息中您可以看到我的“面向”方向。

基本上，我想要一个动画，用于在每个方向上行走。如果可能的话，我还想添加一个“空闲”动画，这样你的角色在静止一段时间（可能会移动它的头）时会变得谨慎。

我应该使用什么方法？

多张图片？精灵表？或者是其他东西？

我们将不胜感激任何信息。

谢谢

编辑：

我正在使用 SpriteSheet 阅读器，我的工作正常，但是我可以弄清楚如何绘制透明颜色的背景。

例如，我正在使用这个 spritesheet [SpriteSheet](https://dl.dropbox.com/u/7923805/Game/Dude_Walking.png "精灵表")，你可以看到它有一个白色的背景，当我在我的游戏上绘制这个时，我可以看到白色的[Example](https://dl.dropbox.com/u/7923805/Game/guy.png)。这可以删除吗？

如果有帮助，这就是我绘制玩家的方式

```
 g.drawImage(GameHelper.localPlayer.getImage(), ((16 * HelpersPackage.GeneralHelper.TileScale)* HelpersPackage.GameHelper.localPlayer.Location.X), ((16 * HelpersPackage.GeneralHelper.TileScale)* HelpersPackage.GameHelper.localPlayer.Location.Y), (16 * HelpersPackage.GeneralHelper.TileScale), (16 * HelpersPackage.GeneralHelper.TileScale), null); 
```

编辑2：

没关系，我已经使我的图像透明并且效果很好:)
谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T23:08:54.237

gamedev.stackexchange.com 或许可以为您提供更多帮助。

如果您从头开始，Sprite 表可能是最好的方法。动画的每一帧在较大的精灵表文件中都有不同的 x 和 y 偏移。您跟踪当前正在播放哪个动画的哪一帧，并在每一帧绘制相应的精灵表。决定使用哪个动画以及何时播放空闲动画必须由处理用户输入、碰撞等的代码的相同部分来处理。

或者，您可以找到现有的库或带有精灵动画类的游戏引擎。有时，这些可以为您节省大量编码时间。不幸的是，我不熟悉任何特定的好的、免费的java。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T23:09:12.197

如果您主要专注于游戏，您应该考虑使用像[Slick这样的 2D 库](http://slick.cokeandcode.com/)

如果您想自己实现动画，您可能应该使用包含一个对象的所有“图像”的精灵表，并通过以正确的顺序剪切正确的图像来创建动画。我建议查看 slick 网站和论坛，您会发现一些用于 spritesheets 的工具和许多提示

# eclipse - Eclipse 的 aptana 插件中不显示行号

> ID：11570555
> 
> 赞同：2
> 
> 时间：2012-07-19T23:00:57.017
> 
> 标签：eclipse, aptana, line-numbers

在 Eclipse 的 Aptana 插件中，不显示行号（在 Aptana 组件中，例如 Pydev，不在 Eclipse 组件中）。下面是aptana提供的HTML编辑器截图（注意缺少行号）：

![在此处输入图像描述](../Images/ec5410ac748060f7fa1b52fc87653558.png)

为了证明这不是 Eclipse 问题，这里有一个 markdown 编辑器（由 Eclipse 提供）。注意行号：

![在此处输入图像描述](../Images/493005c23d4fb75577dd5434cf3d1abf.png)

有什么办法可以解决这个问题？我尝试更改 Aptana 主题，但没有任何效果。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-22T16:02:03.123

如果您查看粘贴在高对比度显示器（或放大）上的图像@lkjoel，您会看到行号确实存在，它们的颜色与灰度边缘非常相似。

要更改数字的颜色（变为灰色以外的颜色），请访问：

窗口 -> 首选项 -> 常规 -> 编辑器 -> 文本编辑器。更改“行号前景”

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-20T01:20:21.497

右键单击左侧标尺栏（编辑器折叠注释的左侧），应该会出现一个菜单。

单击“显示行号”，您应该进行设置。

# c# - 为资源不足的硬件编写代码

> ID：11570561
> 
> 赞同：-1
> 
> 时间：2012-07-19T23:01:41.747
> 
> 标签：c#, performance

我有一个程序将大量用户导入活动目录，在资源高度不足的服务器环境中（客户端正在迁移到新的、更强大的服务器）。

在为此类环境编写可能会占用大量内存的程序时，是否有最佳实践？此外，在这种分配中，记忆门派上用场了吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T23:13:53.853

没有足够的信息。

现代计算机确实有足够的内存，人们只是在滥用它们。正确设计您的系统，以减少您必须保留在内存中的最大数据量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T23:04:05.037

是的。

[使用内存池](http://en.wikipedia.org/wiki/Memory_pool)是个好主意。

# iphone - 带有 Iphone 网址的 QR 码

> ID：11570564
> 
> 赞同：0
> 
> 时间：2012-07-19T23:02:15.390
> 
> 标签：iphone, qr-code

我想创建带有网址（在其中编码）的二维码。

iPhone 的 QR 尺寸、版本、纠错级别是否有任何要求/限制？

仅嵌入网址就足够了，还是 iPhone 需要一些特殊格式才能知道如何解释 qr 内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T23:09:58.197

选择简单文本格式的 QR 码（只是 URL），以及适合您长度的最大纠错级别。不要忘记代码周围的白色边框，不要裁剪它。让它保持完全的黑白对比。此外，请尝试在尽可能大的表面上打印您的二维码。建筑横幅是最理想的格式；）

说真的，尽量贴近标准。比如说，有人喜欢在代码中嵌入彩色徽标。这减少了纠错，一些设备拒绝识别生成的代码。

# nuget - 托管您自己的 NuGet 和符号源服务器？

> ID：11570567
> 
> 赞同：22
> 
> 时间：2012-07-19T23:02:46.453
> 
> 标签：nuget, remote-debugging, debug-symbols, nuget-package, nuget-server

我知道我们可以托管我们自己的私有/内部 NuGet 服务器，但有没有办法也托管您自己的链接到您的私有 NuGet 包的符号源服务器？我公司的政策不允许发布源代码，甚至不允许发布到 SymbolSource.Org 私人仓库。

谢谢你。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-21T03:18:20.850

刚刚发现 SymbolSource 发布了一个名为[SymbolSource Server Basic](http://www.symbolsource.org/Public/Blog/View/2012-03-13/Releasing_the_community_edition_of_SymbolSource)的社区版本。一个小时左右就搞定了！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-20T00:58:06.963

根据这篇文章，NuGet.Server 作为符号+源服务器应该可以做到这一点：[NuGetsymbolssource-repository](http://thinkbeforecoding.com/post/2012/02/26/NuRep-your-local-NuGetsymbolssource-repository)

如果这不起作用，请告诉我，

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-02T12:12:18.800

从 7.x 版开始，我相信 TeamCity 可以是开箱即用的 NuGet 服务器。还有一个添加了插件的符号服务器。这是插件的链接：[http ://confluence.jetbrains.com/display/TW/Symbol+Server](http://confluence.jetbrains.com/display/TW/Symbol+Server)

# javascript - 从下拉列表中更改加载项

> ID：11570569
> 
> 赞同：1
> 
> 时间：2012-07-19T23:03:00.010
> 
> 标签：javascript, jquery

我想根据下拉选择将不同的内容加载到 div 中。这是到目前为止的代码：

```
 $(document).ready(function(){
    var x;
    $('#loadCategory').change(function(){
        if ($(this).val() == "videos"){
            x = 'videos.txt';
        }
        if ($(this).val() == "ads"){
            x = 'ads.txt';
        }
        if ($(this).val() == "widgets"){
            x = 'widgets.txt';
        }
        if ($(this).val() == "images"){
            x = 'images.txt';
        }else{
            x = 'videos.txt';
        }
    });
    $('.content').load(x,function(){
            $('img').wrap('<li></li>');
            $('.media-container').pajinate({
                items_per_page : 7
            });

            $( ".media-container li" ).draggable({
                appendTo: ".playlist ol",
                helper: "clone"
            });
    }); 
```

当我输入“alert(x);” 在 .change() 中，它显示了正确的值，但不会更改 .content 中的内容。我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T23:09:05.647

```
$(document).ready(function(){
    $('#loadCategory').on('change', function(){
        loadContent(this.value+'.txt');
    });

    function loadContent(file) {
        $('.content').load(file, function(){
            $('img').wrap('<li></li>');
            $('.media-container').pajinate({
                items_per_page : 7
            });

            $( ".media-container li" ).draggable({
                appendTo: ".playlist ol",
                helper: "clone"
            });
        });
    }
}); 
```

如果`else`确实需要该声明，您总是可以这样做：

```
$('#loadCategory').on('change', function(){
    var t = this.value,
        x = (t=='videos'||t=='ads'||t=='widgets'||t=='images')?this.value:'videos';
    $('.content').load(x+'.txt', function(){
        $('img').wrap('<li></li>');
        $('.media-container').pajinate({
            items_per_page : 7
        });

        $( ".media-container li" ).draggable({
            appendTo: ".playlist ol",
            helper: "clone"
        });
    });
}); 
```

**编辑**

试试这个：

```
$(document).ready(function(){
    loadContent('videos.txt');

    $('#loadCategory').on('change', function(){
        loadContent(this.value+'.txt');
    });

    function loadContent(file) {
        $('.content').load(file, function(){
            $('img').wrap('<li></li>');
            $('.media-container').pajinate({
                items_per_page : 7
            });

            $( ".media-container li" ).draggable({
                appendTo: ".playlist ol",
                helper: "clone"
            });
        });
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T23:07:07.703

您希望在`change`事件发生时执行加载部分 - 因此您需要将该代码移动到该事件的事件处理程序中：

```
//assign the event handler
$('#loadCategory').change(function(){
    //prepare the value of x
    //corrected your conditions by adding else
    if ($(this).val() == "videos"){
        x = 'videos.txt';
    }
    else if ($(this).val() == "ads"){
        x = 'ads.txt';
    }
    else if ($(this).val() == "widgets"){
        x = 'widgets.txt';
    }
    else if ($(this).val() == "images"){
        x = 'images.txt';
    }
    else{
        x = 'videos.txt';
    }

    //load the right content based on x
    $('.content').load(x,function(){
            $('img').wrap('<li></li>');
            $('.media-container').pajinate({
                items_per_page : 7
            });

            $( ".media-container li" ).draggable({
                appendTo: ".playlist ol",
                helper: "clone"
            });
    });    
}); 
```

在您的原始代码中，会发生以下情况：

*   声明局部变量`x`( `undefined`)
*   分配更改事件处理程序
*   `x`加载内容是基于`undefined`那个时候的！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T23:05:56.610

您`$('.content').load()`的更改事件处理程序中没有。

此外，所有这些 if 语句似乎有点多余。尝试使用 switch 语句。

```
switch ($(this).val()) {
    case "videos":
        x = "videos.txt";
        break;
    case "widgets":
        x = "widgets.txt";
        break;
    ... etc ..
} 
```

或者甚至可能

```
x = $(this).val() + ".txt"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T23:06:21.400

您应该将内容加载到与“更改”事件挂钩的函数中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-19T23:08:17.123

```
 $('#loadCategory').change(function(){
    if ($(this).val() == "videos"){
        x = 'videos.txt';
    }
    if ($(this).val() == "ads"){
        x = 'ads.txt';
    }
    if ($(this).val() == "widgets"){
        x = 'widgets.txt';
    }
    if ($(this).val() == "images"){
        x = 'images.txt';
    }else{
        x = 'videos.txt';
    }

    $('.content').load(x,function(){
        $('img').wrap('<li></li>');
        $('.media-container').pajinate({
            items_per_page : 7
        });

        $( ".media-container li" ).draggable({
            appendTo: ".playlist ol",
            helper: "clone"
        });

  }); 
```

如果您仍然希望它在第一次加载然后将加载部分放在一个函数中并在 onchange 中调用该函数

# php - 确定适合文件大小的图像质量？

> ID：11570574
> 
> 赞同：1
> 
> 时间：2012-07-19T23:03:47.030
> 
> 标签：php, image, gd

我目前正在将上传的图像重新采样为静态宽度和高度。我希望能够以低于某个文件大小阈值的最高质量创建图像的新副本。目前，我正在使用一种非常幼稚的方法 - 像这样：

```
$size = NULL;
$quality = 100;

while ($size === NULL || $size > MAX_SIZE) {
    // write the image to disk using $quality

    clearstatcache(TRUE, $image);
    $size = filesize($image);

    $quality -= 10;
} 
```

有没有更好的方法来确定我应该使用什么质量？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T23:18:32.390

生成的文件大小不仅取决于质量参数，还取决于图像本身。通常，无法准确预测文件大小。

您可以对典型图像进行一系列测量并创建一些比例，让您更快地猜出准确的质量参数。

您也可以进行二分搜索，在一些迭代后会收敛到足够好的点。

# android - 标记“}”的语法错误，删除此标记

> ID：11570576
> 
> 赞同：1
> 
> 时间：2012-07-19T23:03:56.937
> 
> 标签：android, eclipse, syntax, token

我不断收到此错误消息，提示“令牌“}”上的语法错误，请删除此令牌。” 在最后一行，为什么？我一直在寻找错误，但似乎找不到。如您所见，它是一项服务，每隔一段时间就会调用另一项服务。

```
package com.iggeman.updater;

import android.app.Service;
import android.content.Intent;
import android.os.IBinder;
import android.util.Log;

public class UpdaterService extends Service {

private static final String TAG = UpdaterService.class
        .getSimpleName();
private Updater updater;
public boolean isRunning = false;

@Override
public IBinder onBind(Intent intent) {
    // TODO Auto-generated method stub
    return null;
}

@Override
public void onCreate() {
    // TODO Auto-generated method stub
    super.onCreate();

    updater = new Updater();

    Log.d(TAG, "onCreate");
}

@Override
public void onStart(Intent intent, int startId) {
    // TODO Auto-generated method stub
    super.onStart(intent, startId);

    if (this.isRunning == false) {
        updater.start();
        this.isRunning = true;
    }

    Log.d(TAG, "onStart");
}

@Override
public synchronized void onDestroy() {
    // TODO Auto-generated method stub
    super.onDestroy();

    if (this.isRunning) {
        updater.interrupt();
    }

    updater = null;

    Log.d(TAG, "onDestroy");
}

class Updater extends Thread {
    static final long DELAY = 10000;
    private boolean isRunning = false;

    public Updater() {
        super("Updater");
    }

    @Override
    public void run() {
        // TODO Auto-generated method stub
        super.run();
        isRunning = true;
        while (isRunning) {
            try {
                // Do something

                startService(new Intent(getBaseContext(), StartServiceTwo.class));

                Log.d(TAG, "Updater running");

                Thread.sleep(DELAY);
            } catch (InterruptedException e) {
                // interrupted
                isRunning = false;
            }
        } // while
    }

    public boolean isRunning() {
        return this.isRunning();
    }
}
} 
```

我已经翻遍了所有的括号，但我找不到任何不在它应该在的地方的人。

编辑：

仍然是错误：

```
package com.iggeman.updater;

import android.app.Service;
import android.content.Intent;
import android.os.IBinder;
import android.util.Log;

public class UpdaterService extends Service {

private static final String TAG = UpdaterService.class
        .getSimpleName();
private Updater updater;
public boolean isRunning = false;

@Override
public IBinder onBind(Intent intent) {
    // TODO Auto-generated method stub
    return null;
}

@Override
public void onCreate() {
    // TODO Auto-generated method stub
    super.onCreate();

    updater = new Updater();

    Log.d(TAG, "onCreate");
}

@Override
public void onStart(Intent intent, int startId) {
    // TODO Auto-generated method stub
    super.onStart(intent, startId);

    if (this.isRunning == false) {
        updater.start();
        this.isRunning = true;
    }

    Log.d(TAG, "onStart");
}

@Override
public synchronized void onDestroy() {
    // TODO Auto-generated method stub
    super.onDestroy();

    if (this.isRunning) {
        updater.interrupt();
    }

    updater = null;

    Log.d(TAG, "onDestroy");
}

class Updater extends Thread {
    static final long DELAY = 10000;
    private boolean isRunning = false;

    public Updater() {
        super("Updater");
    }

    @Override
    public void run() {
        // TODO Auto-generated method stub
        super.run();
        isRunning = true;
        while (isRunning) {
            try {
                // Do something

                startService(new Intent(getBaseContext(), StartServiceTwo.class));

                Log.d(TAG, "Updater running");

                Thread.sleep(DELAY);
            } catch (InterruptedException e) {
                // interrupted
                isRunning = false;
            }
        } // while
    } //Run     
} //Class updater

public boolean isRunning() {
        return this.isRunning();
   }
}  //Main body 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-19T23:21:18.783

这可能不是您的代码的问题，而是 Eclipse。重新启动计算机，然后重新构建项目。

如果这不起作用，请尝试使用其他程序进行编译。如果它有效，那么它只是 Eclipse 很奇怪。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T23:04:49.773

粘贴时，错误消息不正确，并且您在正确的位置有正确数量的匹配大括号（尽管上面的缩进是不可原谅的）。但是，除非出现无法正确匹配大括号的疯狂编译器极端情况，否则我猜您已经粘贴了除了它抱怨的最后一个大括号之外的所有内容。按照错误消息的建议执行并删除它建议的行上的令牌。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-20T16:43:13.907

将您的 ADT 插件升级到版本 20.0.1。这是[ADT 20 中的一个已知错误](http://code.google.com/p/android/issues/detail?id=33985)。

所有其他关于清理、重新创建项目等的技巧都不会永久解决问题，而只会暂时解决问题，直到您碰巧再次触发错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-08-10T19:08:00.987

对我来说，这是一个编码问题或一些奇怪的不可见字符，因为我从 Microsoft Teams 粘贴了一些代码。

我打开Outlook（gmail，whataver），粘贴代码，将电子邮件发送给自己并再次复制，然后它工作正常。

我无法使用唯一的 UITF-8 验证器来解决它，并且 notepad++ 也没有显示任何奇怪的东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-09-16T12:01:11.737

`clean install`我通过运行一个后跟摆脱了这个错误`Maven -> Update Project`

# c# - 将图像发布到 Facebook

> ID：11570584
> 
> 赞同：-1
> 
> 时间：2012-07-19T23:05:04.937
> 
> 标签：c#, facebook

我对 Facebook API 完全陌生，并没有看到关于 C# 的大量资源。我只是对将图像发布到 Facebook 感兴趣。有没有人对此有任何见解或经验？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T23:46:14.970

看看：[http](http://csharpsdk.org) ://csharpsdk.org 那是最“官方”的 c# facebook sdk。

你在写什么？ASP.net/phone/win 应用程序？

首先让用户进行身份验证（取决于平台），然后查看 facebook 开发人员文档，了解发布帖子所涉及的内容，以及以下内容：[http](http://csharpsdk.org/docs/making-synchronous-requests) ://csharpsdk.org/docs/making-synchronous-requests有关使用 sdk 发出正确 http 请求的一些文档。

我没有使用过这个，但看起来文档很快就会出现，尽管它目前非常少。

祝你好运！

# java - Java i++操作说明

> ID：11570589
> 
> 赞同：2
> 
> 时间：2012-07-19T23:05:36.310
> 
> 标签：java

> **可能重复：**
> [a += b 和 a =+ b 以及 a++ 和 ++a 之间有什么区别？](https://stackoverflow.com/questions/5098282/what-is-the-difference-between-a-b-and-a-b-also-a-and-a)
> [“x = x++”之后的 x 是什么？](https://stackoverflow.com/questions/7911776/what-is-x-after-x-x)

在 Test1 中 i 将其值增加 1 并返回旧值并将其增量值保留在 i 变量中。但在 Test2 中，我将其值增加 1 并返回其旧值，并且增量也发生了。他们是否为未在 i 变量中分配的增量复制 i 。Test2中的操作步骤是什么。

**测试1**

```
int i = 0;
System.out.print(i++);
System.out.print(i); 
```

输出 01

**测试2**

```
int i = 0;
i = i++;
System.out.println(i); 
```

输出 0

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-19T23:08:31.560

该语句`i = i++`在 Java 中具有明确定义的行为。首先，将 的值`i`压入堆栈。然后，变量`i`递增。最后，栈顶的值被弹出并赋值给`i`. 最终结果是什么都没有发生——智能优化器可以删除整个语句。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T23:10:34.950

`i = i++;`是一个棘手的构造，它真正做的是如下所示：

```
int iOld = i;
i = i + 1;
i = iOld; 
```

您只想`i++;`用作独立语句。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T23:11:45.570

当`++`运算符出现在变量之后时，如在您的示例`i++`中，i 的增量发生在操作结束后。这就是为什么第一个示例中的第一个打印为零，您尚未添加，然后第二个打印为 1。

第二个示例与保存 i，然后将其递增，然后将原始内容放回原处相同。

```
i++ 
```

本身就是一个运算符。

您可以在执行打印操作之前尝试第一个`++i`会增加 i

# php - 传递一个带有很多空格的 MySQL 查询可以吗？

> ID：11570598
> 
> 赞同：3
> 
> 时间：2012-07-19T23:06:24.723
> 
> 标签：php, mysql, sql, tsql

我在 PHP 中使用这个查询：

```
$query = "UPDATE viajens SET tipo_operacao = $tipo_operacao, 
                             percurso = $percurso, 
                             tipo_cliente = $tipo_cliente, 
                             previsao_inicio = '$previsao_inicio', 
                             previsao_fim = '$previsao_fim', 
                             quilometragem_estimada = '$km_estimada', 
                             origem_empresa_id = $origem, 
                             transportador_empresa_id = $transportador, 
                             motorista_id = $motorista, 
                             veiculo_id = $veiculo1, 
                             reboque1_veiculo_id = $veiculo2, 
                             reboque2_veiculo_id = $veiculo3, 
                             reboque3_veiculo_id = $veiculo4 
                       WHERE id_viajem = $id_viajem;"; 
```

解析视图：

```
$query = "UPDATE viajens SET tipo_operacao = $tipo_operacao,                                percurso = $percurso,                                tipo_cliente = $tipo_cliente,                               previsao_inicio = '$previsao_inicio',                                previsao_fim = '$previsao_fim',                                quilometragem_estimada = '$km_estimada',                                origem_empresa_id = $origem,                                transportador_empresa_id = $transportador,                                motorista_id = $motorista,                                veiculo_id = $veiculo1,                                reboque1_veiculo_id = $veiculo2,                                reboque2_veiculo_id = $veiculo3,                                reboque3_veiculo_id = $veiculo4                                WHERE id_viajem = $id_viajem;"; 
```

通过这样做，MySQL 处理这个查询会比内联查询慢吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T23:08:04.050

是的，空格很好，所以如果你觉得它更具可读性，请坚持使用你所拥有的。去除空格并不是计算机有任何麻烦的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T04:01:08.270

空格没有问题，请记住，SQL 和其他语言一样，在执行代码之前，会对其进行解析以构造 AST（从您的代码派生的*抽象语法树），忽略注释和空格。*

顺便说一句，AST 只包含执行代码所需的信息。

# html - 有没有一种快速的方法来编写静态 a href 链接？HTML

> ID：11570603
> 
> 赞同：0
> 
> 时间：2012-07-19T23:06:37.917
> 
> 标签：html, static, href, webpage

我有一个 html 页面，我在其中列出了指向我的照片的静态链接，我必须逐行列出它们并更改数字，即照片的名称。数字按顺序排列是一件好事，而 jpg 文件仅以 4 位数字命名。例如：

```
<a href=pics/0001.jpg target=blank><img src=pics/0001.jpg></a>
<a href=pics/0002.jpg target=blank><img src=pics/0001.jpg></a>
<a href=pics/0003.jpg target=blank><img src=pics/0001.jpg></a>
<a href=pics/0004.jpg target=blank><img src=pics/0001.jpg></a>
<a href=pics/0005.jpg target=blank><img src=pics/0001.jpg></a>
...
<a href=pics/1999.jpg target=blank><img src=pics/1999.jpg></a> 
```

有没有更优雅的方法来做到这一点？还是手动输入 0001.jpg 到 1999.jpg 的唯一方法？是否有 perl/python 脚本可以帮助编写静态 html？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T23:26:43.633

[http://jsfiddle.net/Cbcak/](http://jsfiddle.net/Cbcak/)

```
<script type="text/javascript">
$(function(){
    var str = '';
    for (var i=1;i<=1999;i++) {
        var num = zeroFill(i, 4);
        str += '<a href=pics/'+num+'.jpg target=blank><img src=pics/'+num+'.jpg></a>'+"\n";
    }
    $('pre').text(str);

    function zeroFill( number, width )
    {
     width -= number.toString().length;
      if ( width > 0 )
     {
       return new Array( width + (/\./.test( number ) ? 2 : 1) ).join( '0' ) + number;
     }
     return number + ""; // always return a string
  }
});
</script>
<pre></pre>​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T23:13:24.237

您可以使用 javascript 动态生成它们，但您仍然必须在源位置（文件）中提供 href 和 src

否则，您将使用 .NET、Java、php 或其他可以从数据库或 xml 文件中读取图像的 Web 脚本语言

我敢肯定还有其他选择，只是暂时没有想到。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T23:18:20.643

试试这个 python 3 脚本：

```
for d in range(2000):
    print("<a href=pics/" + str(d).zfill(4) + ".jpg target=blank><img src=pics/" + str(d).zfill(4)+ ".jpg></a>" ) 
```

运行将产生您预期的输出 ( `<a href=pics/xxxx.jpg target=blank><img src=pics/xxxx.jpg></a>` )，您可以将其复制并粘贴到您的 html 文件中。

# regex - 在 Vim 交互式会话中折叠空行

> ID：11570609
> 
> 赞同：1
> 
> 时间：2012-07-19T23:07:07.797
> 
> 标签：regex, vim, buffer, lines

在交互式编辑 Vim 缓冲区时，如何通过*单个*替换命令将多个空行（真正为空或包含可选空格）的每个序列替换为单个空行 - 最好不要从非空行中删除任何尾随空格...？

自然地，这样的多个“空”行块可能存在于缓冲区中的任何位置，包括缓冲区的开头和结尾。

由于我只对追踪我对 Vim 处理正则表达式方式的误解感兴趣，涉及某种形式或其他迭代的解决方案（Vim 的 ":global" 命令、宏、函数......等）是*不是*我要找的。

* * *

我需要修正一个错字，所以我使用 CTRL-H 来尝试修正它。奇怪的事情发生了 :-) 当我按下 Enter 键转到下一行时，我输入的任何内容都会被发布，我必须使用编辑按钮向其中添加内容。@kev：非常有趣的解决方案，我确实有很多问题.. 但我什至无法回复您的帖子.. 我刚刚发现我的“声誉”还不够.. 所以你必须等到我找到一个改变它的方法..！我不认为有任何方法可以通过常规邮件列表使用这个论坛..？我刚刚注意到我还剩下 -176 个字符。因此，我最初的努力被截断了。哦，好吧..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T23:34:09.920

您可以使用多行模式：

```
:%s/^\_s*$// 
```

`\_s`匹配空格（包括换行符）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T20:25:56.860

@xev ..你没有回答这个问题。您的替换命令查找空行并将它们替换为`//`，换句话说，什么都不替换！

您正在删除这些行而不是折叠它们。

如果您认为情况并非如此，只需`//`通过例如一串然后破折号来更改替代命令中的 ..

```
:%s/^\_s*$/----------/ 
```

您会注意到所有空行都被十个破折号替换！

也许你正在运行一个旧的错误版本的 Vim？

如果不是，请解释您认为它应该如何工作。

# php - PHP imap_open 失败，但 OpenSSL 连接

> ID：11570612
> 
> 赞同：2
> 
> 时间：2012-07-19T23:07:27.933
> 
> 标签：php, openssl, imap, ssl, pop3

我试图通过连接到 POP3 服务器`imap_open`

```
imap_open('{mail.domain.com:995/pop3/tls}INBOX', 
    'user@domain.com', 
    'password'); 
```

但我得到这些错误：

```
Warning: imap_open(): Couldn't open stream {mail.domain.com:995/pop3/tls}INBOX
Fatal error: Maximum execution time of 30 seconds exceeded
Notice: Unknown: POP3 connection broken in response (errflg=2) 
```

（按这个顺序，这很奇怪，因为通知是在致命错误之后）

在终端中运行此命令可以正常工作：

```
> openssl s_client -crlf -connect mail.domain.com:995

+OK The Microsoft Exchange POP3 service is ready.
USER user@domain.com
+OK
PASS password
+OK User successfully logged on. 
```

我尝试了各种其他开关，例如`/novalidate-cert`, `/debug`，`OP_DEBUG`但得到了相同的结果。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T12:30:59.437

即使服务器指定了 TLS，在 PHP 中使用 SSL 连接仍然有效。

```
imap_open('{mail.domain.com:995/pop3/ssl}INBOX', 
    'user@domain.com', 
    'password'); 
```

# balanced-payments - 商家是否需要在 Balanced Payments 上关联其银行账户？

> ID：11570617
> 
> 赞同：-3
> 
> 时间：2012-07-19T23:08:08.987
> 
> 标签：balanced-payments

平衡支付是否要求商家将其银行账户与该账户相关联才能接受信用？创建“用户”所需的信息量是多少？我希望尽可能减少摩擦，直到商家有动力输入更多信息（当他们得到报酬时）。理想情况下，当他们第一次尝试从我的市场中获取现金时，我会显示用户屏幕以收集最后一点信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T23:17:08.967

在 Balanced nonclementure 中，向人们支付的款项称为 Credits，用户由 Account 表示。

对于[接受 ACH 付款](https://www.balancedpayments.com/docs/merchant)的帐户，它必须具有“商家”角色。由于 Balanced 为商家账户提供担保，因此您必须在添加角色之前提供识别信息。

在最好的情况下，可以通过使用他们的姓名、出生日期和地址来识别商家。如果 Balanced 无法仅从这些信息中识别用户，那么作为开发人员，您可以选择[提示他们提供更多信息](https://www.balancedpayments.com/docs/merchant#requests-for-more-information)并重新提交请求，或者将他们重定向到 Balanced 网站以获取信息。

为了满足您的要求，您可以将资金保留在您的市场托管账户中，直到付款到期并且您已提示他们提供信息以创建他们的账户。这将需要您进行一些簿记以跟踪资金，直到它们被支付。

# shell - 在 awk 中全局声明数组

> ID：11570629
> 
> 赞同：0
> 
> 时间：2012-07-19T23:09:22.320
> 
> 标签：shell, awk

我写了一个 awk 脚本，现在我正在对其进行模块化。我将仅举一个简单的例子来说明我所做的事情。

```
awk 
BEGIN
{
     declaring local variables 
}

{
      if(variable==A)
      {
            array[A]++;
            array1[A]++;
      }

}
END
{
      print contents of array and array1
} 
```

我想使用函数来做下面的事情，我只是在编辑动作块，即

```
{
      addArrays(A);
}

function addArrays(A)
{
       array[A]++;
       array1[A]++;
} 
```

如果我这样做，我只想知道是否可以在 END 语句中访问 array 和 array1 的内容。我的疑问是数组 1 和数组 2 是否在函数内部本地声明。如果它是一个本地数组。我只需要知道如何将它作为一个全局数组，以便我能够在 END 函数中使用它。谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T23:19:00.120

变量和数组在 AWK 中是全局的。使变量成为本地变量的唯一方法是在参数列表中命名它们（即使没有为所有参数传入值。因此，为避免创建本地数组，不要将其名称包含在参数列表中。

从`gawk`手册：

> 参数名称在语法上与局部变量名称没有区别。相反，调用函数时提供的参数数量决定了有多少参数变量。因此，如果给定三个参数值，则 PARAMETER-LIST 中的前三个名称是参数，其余的是局部变量。
> 
> 因此，如果在对函数的所有调用中参数的数量不相同，则 PARAMETER-LIST 中的某些名称在某些情况下可能是参数，而在其他情况下可能是局部变量。另一种思考方式是省略的参数默认为空字符串。
> 
> 通常，当您编写函数时，您会知道要使用多少个名称作为参数以及要使用多少个名称作为局部变量。通常在参数和局部变量之间放置一些额外的空间，以记录您的函数应该如何使用。

# c# - 如何在控制器类中有多个 Put 动词

> ID：11570633
> 
> 赞同：1
> 
> 时间：2012-07-19T23:09:39.633
> 
> 标签：c#, asp.net-mvc, asp.net-web-api

我正在使用 ASP.NET Web API 和控制器类来处理来自客户端的 JSON 数据。我遇到了单个控制器需要多个 Put 方法的情况。

例子：

我可以拥有的一位客户

```
var box = {size:2,color:'red',height:45,width:12} 
```

现在，如果我想更新整个盒子对象，我可以做一个

```
public void Put(Box box)
 {
 } 
```

好的，我得到了这么多。

但我需要能够更新框的单个值，如下所示：

```
 public void Put(int id, width value)
    {

    }
    public void Put(int id, height value)
    {

    }
    public void Put(int id, color value)
    {

    } 
```

我将如何在我的 .net c# 控制器中映射额外的 Put 动词？

* * *

我将为我刚刚创建的赏金添加更多代码。我需要有人向我展示如何使我提供的代码工作。我需要将多个方法映射到一个`httpVERB PUT`。原因是我需要对服务器上的项目进行微更新。就像名字一样，我不想通过网络发送一个大对象来更新一个字段，因为我的程序也将连接到移动设备。

---此代码不起作用，只返回`PutName`而不是`PutBrand`. 我也以您能想象到的任何方式切换了签名。

```
 [AcceptVerbs("PUT")]
    [ActionName("PutBrand")]
    public HttpResponseMessage PutBrand(int id, int val)
    {
        return Request.CreateResponse(HttpStatusCode.Created, "Brand");
    }
    [AcceptVerbs("PUT")]
    [ActionName("PutName")]
    public HttpResponseMessage PutName(IDString idString)
    {
        return Request.CreateResponse(HttpStatusCode.Created, "Name");
    }
public class IDString
{
    public IDString() { }
    public int ID { get; set; }
    public string Value { get; set; }
} 
```

- - 客户

```
 $.ajax(
                         {
                             url: "/api/project",
                             type: "PUT",
                             data: JSON.stringify({ id: 45, val:'xxx' }),
                             contentType: "application/json",
                             success: function (result) {

                             }
                         }); 
```

---路由配置

```
 public class RouteConfig
    {
        public static void RegisterRoutes(RouteCollection routes)
        {
            routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

            routes.MapHttpRoute(
                name: "DefaultApi",
                routeTemplate: "api/{controller}/{id}",
                defaults: new { id = RouteParameter.Optional }
            );

            routes.MapRoute(
                name: "Default",
                url: "{controller}/{action}/{id}",
                defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional }
            );
        }
    } 
```

* * *

建议的解决方案

```
 $.ajax(
                 {
                     url: "/api/project?a=name",
                     type: "PUT",

              $.ajax(
                 {
                     url: "/api/project?a=brand",
                     type: "PUT",

              $.ajax(
                 {
                     url: "/api/project?a=size",
                     type: "PUT", 
```

当然我会用一个变量来代替 a=myJavaScriptVariable

```
 public HttpResponseMessage Put(Project project)
        {

  string update = HttpContext.Current.Request.QueryString["a"];
        switch (update)
        {
            case "name":
                break;
            case "brand":
                break;
            case "size":
                break;

            default:
                break;
        }
        return Request.CreateResponse(HttpStatusCode.Accepted);
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T23:20:11.587

HTTP 动词不是动作的名称，它是一个注解。

这样，您的控制器应如下所示：

```
[VERB]
public ActionResult SomeMeaningfulName(ARGUMENTS)
{
//...
} 
```

VERB是, ,或**_**`HttpDelete``HttpPost``HttpPut``HttpGet`

希望这可以帮助。

问候

* * *

**更新**：我上面的答案对于 ASP.NET MVC 应用程序是正确的。但是，如果我们谈论的是*WebAPI*应用程序，那么还有另一个选项来设置动作的动词：WebAPI 使用将*动作名称*理解为**动词**的约定，只要它是有效的 HTTP 动词。动作甚至可以有一个有意义的名称，但它必须以动词开头。更多信息[在这篇文章](http://blogs.microsoft.co.il/blogs/roadan/archive/2012/02/21/asp-net-web-api-fun-with-verbs.aspx)。

感谢@Anand 指出这一点（*以及让我理解的努力=）*）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T23:24:52.187

您可以使用 ActionName 属性，以便可以使用相同的名称调用具有此属性的所有操作。

```
[ActionName("Put")]
 public void PutWidth(int id, width value)
    {

    }
[ActionName("Put")]
    public void PutHeight(int id, height value)
    {

    }
[ActionName("Put")]
    public void PutColor(int id, color value)
    {

    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T06:10:38.887

老实说，您的解决方案转向 RPC 编码风格，而不是 Rest 编码风格。

首先考虑您的 URL 以执行 CRUD 功能。

> **“/盒子/{id}”**

这应该足以完成所有 CRUD 功能。此外，Web API 的匹配语义遵循以下规则

1.  它将动作的名称与动词相匹配
2.  匹配方法签名（因此您可以拥有 2 个 get 、1 个无参数和其他带参数）

如果您有具有相同动词和相同签名的方法，那么充其量，首先定义的方法会被调用。

我可以理解您为 put 制作多种方法的原因，因为您必须一次更新一个 box 属性。它可以通过以下小技巧来实现。从客户端仅发送更新的值。例如，假设仅更改高度。所以将以下 Box 对象发送到服务器

```
//send only Id and height
var data = {size:null,color:null,height:45,width:null,id: 91}
 $.ajax(
                         {
                             url: "/api/project",
                             type: "PUT",
                             data: JSON.stringify(data),
                             contentType: "application/json",
                             success: function (result) {

                           }
                     }); 
```

并在服务器上检查哪些字段在更新之前为空。我的代码假定您正在使用实体框架工作，但它对于任何数据库都是相同的。

```
public void Put(Box box)
{
   //fetch the item from DB
   var item = _db.Box.First(i => i.id = box.id);
   if(item == null)
     // If you can't find the box to update
    throw new HttpResponseException(HttpStatusCode.NotFound);

   //check for properties if not null
   if(box.height != null)
      item.height= box.height;
   if(box.width!= null)
      item.width= box.width;
   if(box.color!= null)
      item.color= box.color;
   if(box.size!= null)
      item.size= box.size;  
   //update the item in database
  _db.SaveChanges();
  return new HttpResponseMessage<Box>(HttpStatusCode.Accepted);
} 
```

# html - CSS Focus 无法影响其他元素

> ID：11570636
> 
> 赞同：3
> 
> 时间：2012-07-19T23:10:23.693
> 
> 标签：html, css, focus, pseudo-class

我环顾四周，找不到在表单获得焦点时显示标题的解决方案。我可能遗漏了一些非常明显的东西（可能无法用这个选择器完成）。

理想情况下，我想避免使用 jQuery 并坚持使用 CSS（更高级的 CSS 很好），因为我没有计划支持 IE - 我喜欢学习，但 IE 对我来说太痛苦了。

这是我目前的CSS：

```
#search-title {
    color: rgba(0, 0, 0, 0);
    font-size: 20px;
    font-weight: 300;
    margin-left: -30px;
    -webkit-transition: all 200ms;
    -moz-transition: all 200ms;
    -ms-transition: all 200ms;
    -o-transition: all 200ms;
    transition: all 200ms;
}

input[type="text"]:focus #search-title {
    color: #F70;
    margin-left: 35px;
} 
```

提前致谢，

山姆

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-20T00:26:05.700

好的，我有一个完全适用于 CSS 的解决方案，但您将不得不稍微调整一下您的 html 元素。

选择不是引用元素（我知道）的后代的另一个元素的唯一方法是使用[兄弟选择器](http://developer.mozilla.org/en/CSS/Adjacent_sibling_selectors)（一般或相邻）。但是，该解决方案依赖于引用元素（输入）和目标（标题）是 dom 层次结构中的同级元素。

这是一个简单的例子：http: [//jsfiddle.net/7AaDc/1/](http://jsfiddle.net/7AaDc/1/)

作为记录，该示例使用通用的兄弟选择器 (~)，但在这种情况下，相邻的 (+) 也可以正常工作。

这是对兄弟（和子）选择器的更好解释：http: [//css-tricks.com/child-and-sibling-selectors/](http://css-tricks.com/child-and-sibling-selectors/)

以下是与兄弟选择器相关的兼容性问题的简要说明：http: [//caniuse.com/#search=sibling](http://caniuse.com/#search=sibling)（tl;dr，这些天得到了广泛的支持）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T23:48:54.227

您已经使用了后代选择器，这意味着“#search-title”必须出现*在*您的输入元素中才能匹配规则——这显然不会发生。

考虑到文档的结构，当您的输入是任何特定状态时，实际上没有一个 CSS 选择器会匹配 #search-title。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T23:18:37.887

也许在表单中尝试一个 div 可能会奏效

或者，尝试[其中之一](http://meyerweb.com/eric/css/tests/css2/sec05-11-03.htm)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T23:55:35.320

在我看来，问题就像您正在尝试为未嵌套的项目设置样式，即

```
input[type="text"]:focus #search-title 
```

`search-title`说当它是匹配 ' ' 的元素的子元素时，使用 id "" 设置元素的样式，`input[type="text"]:focus`但从您发布的片段来看，我猜它实际上不是 DOM 意义上的子元素。

您可以查看兄弟样式选择器（例如，“ `A + B`”匹配项目 B，但仅当它具有前面的兄弟 A 时），特别是“~”可能会有所帮助，但如果元素在 DOM 树中完全不同，那么您可能必须重组你的 DOM 做一些棘手的事情，或者回退到 javascript。

# matlab - 如何在 MATLAB 模态中制作等待栏

> ID：11570639
> 
> 赞同：3
> 
> 时间：2012-07-19T23:10:47.620
> 
> 标签：matlab, user-interface, progress-bar, modal-dialog

我正在开发一个必须显示进度条的 MATLAB GUI。我的功能有两个问题`waitbar`：

1.  我想使进度条模态化，以便在显示进度条时用户不能在 GUI 上做任何其他事情。

2.  栏的右上角有最小化按钮和关闭按钮（与任何其他窗口非常相似）。如果按下关闭按钮，进度条会关闭，我希望隐藏或禁用此按钮，以便用户无法关闭进度条。

我该如何实现这些行为？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-20T14:20:25.810

例子：

```
plot(sin(1:100))
h = waitbar(0, 'Please wait...');
set(h, 'WindowStyle','modal', 'CloseRequestFcn','');
for i=1:10
    waitbar(i/10, h);
    pause(.5)
end
delete(h) 
```

![截屏](../Images/c0df469f0849e068eb91ba03752cb086.png)

通过设置`CloseRequestFcn`为空字符串，单击关闭按钮不会执行任何操作。您只需要等待循环完成即可。

请注意，您仍然可以点击`Ctrl+c`杀死正在运行的计算（我认为这是一件好事，毕竟您不想惹恼用户！）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T00:42:58.160

对于数字 1，您应该研究 Matlab 中的线程。您可能需要并行计算工具箱才能访问必要的功能。你可以在这里找到更多[。](http://www.mathworks.com/help/toolbox/distcomp/f3-6010.html)

就2号而言。您应该能够覆盖 GUI 代码中的 close 函数。

这将是这样的：

```
function MyWaitBar_CloseRequestFcn(hObject, eventdata, handles)

delete(hObject); % This of course deletes the object and we don't want this. 
```

因此，您只需将函数留空。但不要忘记在某个时候关闭它！

# assembly - 以 1ms 为增量获取时间

> ID：11570642
> 
> 赞同：5
> 
> 时间：2012-07-19T23:11:03.767
> 
> 标签：assembly, x86, clock

x86中断0x1A似乎给了计算机的时钟时间，但它只能给出55ms以内的准确时间（AH=0）。有没有办法获得比这更小的增量（也许更“正常”），比如 1ms？我正在尝试制作自己的玩具操作系统，所以我不能使用我自己无法编写的任何东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-19T23:24:55.340

您可以使用[`rdtsc`](http://en.wikipedia.org/wiki/Time_Stamp_Counter)x86 上的（读取时间戳计数器）指令将 64 位 CPU 时间戳转换为`edx:eax`. 该指令的实现取决于您的处理器，但它要么每个时钟递增一次，要么以恒定速率递增。因此，时间分辨率也有所不同，但应该优于 1ms。

使用有一些注意事项`rdtsc`：

1.  时间戳计数器不一定在 CPU 内核之间同步。这可能是超线程和多核 CPU 中的一个问题。
2.  计数器不一定以恒定速率递增。它可能会受到处理器的节流或节能功能的影响。
3.  休眠会导致计数器重置。

由于您正在编写自己的操作系统，因此您可能无需担心其中一些问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-20T08:54:01.740

由于您正在制作自己的操作系统，因此您不必保持计时器周期。可以重新编程 PIT 以更频繁地触发 INT 8 (IRQ 0)。见[这里](http://wiki.osdev.org/Programmable_Interval_Timer)。

在较新的计算机上，您还可以使用[高精度事件计时器](http://en.wikipedia.org/wiki/High_Precision_Event_Timer)。

# oracle11g - Oracle 序列最大值

> ID：11570644
> 
> 赞同：0
> 
> 时间：2012-07-19T23:11:14.287
> 
> 标签：oracle11g

对于那里的 Oracle 专家来说，这应该是一个简单的问题。我有一个列，（例如 ID NUMBER(10)，我使用 Oracle 序列生成下一个值。据此：[http ://docs.oracle.com/cd/B28359_01/server.111/b28286/statements_6015 .htm](http://docs.oracle.com/cd/B28359_01/server.111/b28286/statements_6015.htm) 序列可以生成 28 位的最大值。我想知道的是，当生成足够的序列以达到上列的最大大小并且在序列定义中我指定 CYCLE 但我没有指定一个 MAXVALUE。Oracle 是否以一种智能的方式处理此问题并从头开始，或者我是否必须指定否则 Oracle 将继续生成大于上述 ID 列中可以存储的数字？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-20T01:14:44.623

序列和列之间没有关系——`ID`完全有可能有一个序列用于为多个不同的表生成键。这意味着该序列不知道您如何声明该`ID`列。如果您不指定 a `MAXVALUE`，该序列将愉快地继续生成最多 10^27 的数字。

如果您希望序列在达到 10^11 而不是 10^27 时循环，则需要指定`MAXVALUE`10^11 - 1 的 a。

# php - 使用 PHP ZipArchive 将 zip 解压到特定目录

> ID：11570646
> 
> 赞同：3
> 
> 时间：2012-07-19T23:11:43.163
> 
> 标签：php, ziparchive

我一直无法弄清楚是否有办法使用 php.ini 将 zip 解压缩到特定目录中。使用代码时，例如

```
$zip->extractTo("files/"); 
```

它会将 zip 解压缩到目录“files”，并将所有文件放在与 zip 名称匹配的目录中。我不希望上传方能够决定要上传到的目录的名称。例如，如果我在提取时上传了一个名为“zip.pdf”的 zip，其中包含“myimg.jpg”，它的位置将变为：

```
files/zip/myimg.jpg 
```

我希望它在哪里

```
files/myimg.jpg 
```

无论如何，我想知道是否有办法让 ZipArchive 不创建一个新目录来存放解压缩的内容，或者我是否必须遍历所有解压缩文件并在解压缩完成后移动它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T23:13:53.390

最安全的方法是随机播放 zip 内容并单独处理每个文件。即解压到唯一的临时目录，然后查看每个文件并决定。如果不同用户的文件发生冲突怎么办？不要让这种情况盲目地发生。

# android - Android Threaded Surfaceview 不刷新

> ID：11570649
> 
> 赞同：1
> 
> 时间：2012-07-19T23:11:52.293
> 
> 标签：android, multithreading, refresh, surfaceview

我编写了一个线程表面视图。它有效，但似乎不能很好地刷新。我的意思是不能很好地刷新是EX：如果我移动一个位图位置，它将继续绘制在最后一个位置+是一个新位置。

这是我的代码：

```
public GameView(Context context) 
{               
    super(context);
    holder=getHolder(); 
    currentScreen=new TestScreen();
    currentScreen.Load(this.getResources());
}

protected void Resume()
{
    isRunning=true;
    renderThread=new Thread(this);
    renderThread.start();   
}

public void run() 
{
    while(isRunning)
    {
        gametime=lasttime-System.nanoTime();
        lasttime=System.nanoTime();
        if(!holder.getSurface().isValid())
                continue;

        if(!(currentScreen==null))
        {
            currentScreen.Update(gametime);
            Canvas cv=holder.lockCanvas();
            currentScreen.Draw(cv, gametime);        
            holder.unlockCanvasAndPost(cv);                         
        }       
    }
}

public void pause()
{
    isRunning=false;
    while(true)
    {
        try
        {
            renderThread.join();
        }
        catch (InterruptedException e)
        {

        }
        break;
    }
    renderThread=null;
} 
```

屏幕类代码：

```
public void Load(Resources resources) {
    square=BitmapFactory.decodeResource(resources, R.drawable.square);
    x=y=0;
    super.Load(resources);
}

@Override
public void Update(long gametime) {
    x++;
    super.Update(gametime);
}

@Override
public void Draw(Canvas cv, long gametime) {
    cv.drawBitmap(square, x, y, null);
    super.Draw(cv, gametime);
} 
```

我尝试不使用 Screen 类方法，但它做同样的事情。我是否缺少一些行来清除屏幕？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-03T06:24:57.580

由于您没有为 lockCanvas() 提供脏矩形，因此系统不会保证在 unlockCanvasAndPost(Canvas) 和下次调用 lockCanvas() 之间 Canvas 会发生什么。

为此，您必须重新绘制 Canvas 的全部内容，而不仅仅是已更改的部分。看起来您只是在绘制移动的正方形，而没有绘制背景来填充 Canvas 的其余部分。

注意：如果你使用 lockCanvas(Rect dirty)，情况会有所不同。

# excel - 对两列 Excel 进行排序

> ID：11570650
> 
> 赞同：0
> 
> 时间：2012-07-19T23:11:56.997
> 
> 标签：excel, sorting, rows

我在 Excel 上有两个不同的列。我想创建一个脚本，对 F 列进行排序（有一个标题），并根据 F 列的排序结果对 B 列进行排序。（但不影响任何其他列！）

所以如果我有

```
 ColB       ColF
 1\. Cat        2
 2\. Mouse      1
 3\. Dog        3 
```

排序会给我

```
 ColB       ColF
 1\. Mouse        1
 2\. Cat          2
 3\. Dog          3 
```

我怎样才能做到这一点？我尝试录制一个仅将其排序的宏，但我收到一条错误消息，提示“无法通过多项选择执行命令，请单击单个范围并重试”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T00:04:48.663

我能想到的最简单的方法是将两列临时复制到一个垂直查找表中，F 列在左侧。

然后对 F 列进行排序并使用 VLookup 更新 D 列，格式如下：

```
=VLOOKUP(F1,[Temp Table Range],2,FALSE) 
```

然后，如果您想删除临时表，只需确保将 D 列的公式替换为值即可。

你可以用一个宏来完成所有这些，它只有几个步骤。我可以为你写，但这并不是 Stackoverflow 的真正意义所在。

玩得开心。:-)

# powershell - PowerShell - 将特定文件从源子文件夹移动到具有相同子文件夹结构的目标

> ID：11570653
> 
> 赞同：0
> 
> 时间：2012-07-19T23:12:20.187
> 
> 标签：powershell

我正在编写一个 PS 脚本，按文件类型将 5 个最新文件从源目录移动到目标目录，同时保留子文件夹结构。例如，我想将任何以 AB_ 开头的文件从 ParentFolder1\FolderA、ParentFolder1\FolderB、ParentFolder1\FolderC 等移动到 ParentFolder2\FolderA、ParentFolder2\FolderB、ParentFolder2\FolderC。

父文件夹 1

--文件夹A

----AB_1234.txt

----AB_5678.txt

----XY_9876.txt

----XY_9876.txt

--文件夹B

----AB_1234.txt

----AB_5678.txt

----XY_9876.txt

----XY_9876.txt

--文件夹C

----AB_1234.txt

----AB_5678.txt

----XY_9876.txt

----XY_9876.txt

有没有办法将其绑定到 for 循环中？这是我到目前为止所拥有的：

```
$source = "C:\Test"
$dest = "E:\archive"
$AB = Get-ChildItem -Path $source -include AB_* -Recurse | Where-Object {-not $_.PsIsContainer}
$XY = Get-ChildItem -Path $source -include XY_* -Recurse | Where-Object {-not $_.PsIsContainer}
$keep = 5
$logfile = "E:\_archive\temp\log_{0:MM-dd-yyyy}.log" -f (Get-Date)

if ($AB.Count -gt $keep) {
    $AB | Sort -property LastWriteTime | Select-Object -First ($AB.Count - $keep) | Move-Item -destination $dest\AB -Force -Verbose
    }
Else
    {"No AB_ files to archive." | Out-File $LogFile -Append -Force}

if ($XY.Count -gt $keep) {
    $XY | Sort -property LastWriteTime | Select-Object -First ($XY.Count - $keep) | Move-Item -destination $dest\XY -Force -Verbose
    }
Else
    {"No XY_ files to archive." | Out-File $LogFile -Append -Force} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T06:33:44.477

```
function Move-Newest-Files 
{
    param (
        [parameter(Mandatory = $true)] [string] $source,
        [parameter(Mandatory = $true)] [string] $destination,
        [parameter(Mandatory = $true)] [array] $filter,
        [parameter(Mandatory = $false)][int] $keep = 5
    )

    try
    {
        $source = Resolve-Path $source

        $list = Get-ChildItem -Path $source -Include $filter -Recurse -Force |
            Where-Object { -not $_.psIsContainer } |
            Sort-Object -property LastWriteTime -descending | 
            Select-Object -First $keep

        foreach ($file in $list)
        {
            $destfile = $file -replace [regex]::Escape($source), $destination
            $destpath = Split-Path $destfile -Parent

            if (!(Test-Path $destpath))
                { $null = New-Item -ItemType Container -Path $destpath }

            Move-Item $file -Force -Destination $destfile
        }
    }

    catch
    {
        Write-Host "$($MyInvocation.InvocationName): $_"
    }
}

Move-Newest-Files . "D:\xyzzy" @("*.cs", "*.txt", "*.exe") 10 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T23:23:32.670

[使用Robocopy](http://technet.microsoft.com/en-us/library/cc733145.aspx)可能会更好。

# security - Nmap：服务器在 nmap 运行后停止接受新连接

> ID：11570654
> 
> 赞同：0
> 
> 时间：2012-07-19T23:12:30.103
> 
> 标签：security, centos, port, centos6, nmap

我有一个安装了 nmap 5.51 的 CentOS 6 服务器。我发出以下命令：

```
nmap -sS -PN -p1-1024 --traceroute --reason -O -sV {My IP} -vv

(This is all "don't quote me")
-sS is a type of scan where TCP connections are not fully established
-PN means skip checking if host is online
-p1-65535 is the port range
--traceroute means add traceroute
--reason "Shows the reason each port is set to a specific state and the reason each host is up or down."
-O means OS detection
-sV detects the version of the program listening on each port
-vv means "be verbose" 
```

所以无论如何......我运行这个命令，等待几分钟，它会打印结果并退出。我打开另一个终端窗口（或选项卡），尝试通过 SSH 连接到同一台服务器......并且连接超时。每次都会发生这种情况，并且只有在运行 nmap 之后才会发生。重新启动是唯一可以修复它的方法。

似乎如果我已经建立了连接，它会继续通信，但新的连接会被拒绝。就像我说的，nmap 已经退出，并且我确保它不在进程列表中（ps uax | grep nmap）。

还有一件事，最奇怪的是：nmap 运行时一切正常。当它消失时，恶作剧就开始了。

但这并不一致。当我添加参数 -T2（“礼貌”扫描）时，服务器立即关闭，包括现有连接。

接下来是什么？

请注意，搞砸的服务器是进行扫描的服务器，而不是目标。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:55:30.120

1.  禁用 SELinux

2.  禁用 IPtables

3.  额外信息[http://nmap.org/book/man-bypass-firewalls-ids.html](http://nmap.org/book/man-bypass-firewalls-ids.html)

# c++ - OSX Lion 上的 SDL 与终端/g++ 的链接错误

> ID：11570658
> 
> 赞同：1
> 
> 时间：2012-07-19T23:13:01.623
> 
> 标签：c++, compilation, terminal, osx-lion, sdl

今天早上我在使用 Sublime Text 和 Terminal 学习了 C++ 一段时间以使用 SDL 之后安装了 OSX Lion 和 Xcode，但是我在尝试在 Terminal 中编译时遇到了一些问题，这是我的代码。

```
#include "SDL/SDL.h"

int main(int argc, char* args[])
{
    //Start SDL
    SDL_Init(SDL_INIT_EVERYTHING);

    //Quit SDL
    SDL_Quit();

    return 0;
} 
```

我将 SDL.framework、SDL_mixer.framework 和 devel-lite 放入我的 Library 文件夹中，然后在不起作用时使用 Macports 获取 SDL，后者没有帮助。

当我使用 'g++ sdltest.cpp -o sdltest -lSDL' 时，我得到以下结果 - 'ld: library not found for -lSDLcollect2: ld returned 1 exit status'。有什么办法可以让这个工作吗？

另外，出于兴趣，如果我在格式化硬盘并重新安装 OSX Lion 和 XCode（我正在考虑很快这样做）之后对 SDL 进行“全新安装”，那么最好的方法是什么？我发现的所有指南都遇到了错误（这对我来说绝对是个问题，我只需要找到最容易理解的指南），其中很多似乎是针对使用 Xcode 而不是一个文本编辑器和终端。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-05-25T04:20:35.283

您应该使用包含的 sdl-config（或 SDL2 的 sdl2-config）文件为 g++ 生成包含和库参数。例如，由于我在 OSX 上通过 Homebrew 使用 SDL2，因此：

```
g++ sdltest.cpp -o sdltest `sdl2-config --cflags` `sdl2-config --lib` 
```

转换为并运行：

```
g++ sdltest.cpp -o sdltest -I/usr/local/include/SDL2 -D_THREAD_SAFE -L/usr/local/lib -lSDL2 
```

对于带有 sdl-config 的 SDL 1.x 应该同样工作，并且还有一个“--static-libs”选项，在我的身上给出：

```
-L/usr/local/lib -lSDL2 -lm -liconv -Wl,-framework,OpenGL -Wl,-framework,ForceFeedback -lobjc -Wl,-framework,Cocoa -Wl,-framework,Carbon -Wl,-framework,IOKit -Wl,-framework,CoreAudio -Wl,-framework,AudioToolbox -Wl,-framework,AudioUnit 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T23:18:08.993

您告诉 g++ 使用 链接 libSDL `-lSDL`，但您没有告诉它在哪里查看。`-L/Users/snarehanger/Library/SDL`使用或其他方式将 SDL 路径添加到命令行。

* * *

抱歉，我没有意识到这不清楚，所以我将 Joachim 的评论纳入答案。

*   命令行选项*区分大小写*
*   选项`-l`（小写的 ell）给出库的名称：它没有指定文件名或搜索路径
    *   例如，`-lSDL`可以匹配命令行中指定的搜索路径或编译到 gcc 中的默认值中的任何一个`libSDL.a`或,`libSDL.so`
    *   [gcc 手册：链接选项](http://gcc.gnu.org/onlinedocs/gcc/Link-Options.html#Link-Options)
*   选项`-L`（大写 ell）将目录添加到查找请求的库时使用的搜索路径`-l`
    *   例如，完整的命令行将`g++ sdltest.cpp -o sdltest -L/opt/local/lib -lSDL`允许 g++ 查找`/opt/local/lib/libSDL.so`它是否存在
    *   [gcc 手册：目录选项](http://gcc.gnu.org/onlinedocs/gcc/Directory-Options.html#Directory-Options)

# php - 使用 strtotime 时增加两个小时

> ID：11570659
> 
> 赞同：2
> 
> 时间：2012-07-19T23:13:06.177
> 
> 标签：php

当我进行此转换时

```
$date = '09/20/2012 02:00';
echo $stamp = strtotime($date); 
```

给我**1348099200**但是当我通过网站在线转换它时，它会显示 2 小时前的时间。

如何增加 2 小时？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T23:15:44.007

该`strtotime`函数总是相对于`now()`php.ini 设置称为 timezone 的东西（实际上：`date.timezone`，请参阅下面的链接）。

所以你应该说你的服务器（或网站）位于哪个时区，配置它，你不需要添加这两个小时。如果夏令时更改，这两个小时甚至可能会更改，因此不要将其硬编码到您的应用程序中。

*   [`date_default_timezone_set`^(*文档*)](http://php.net/manual/function.date-default-timezone-set.php)
*   [`date.timezone`字符串^(*文档*)](http://php.net/manual/datetime.configuration.php#ini.date.timezone)

（假设：希腊 UTC+2 现在是夏天）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T23:19:13.257

```
date_default_timezone_set('Europe/London');
$date = new DateTime('09/20/2012 02:00');
$date->modify('+2 hour');
echo date_format($date, 'Y-m-d h:i'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-01-16T10:40:54.900

试试这个，它会工作

`$date1 = '09/20/2012 02:00'; echo $stamp = strtotime("+2 hours",strtotime($date1)); echo date('Y-m-d h:i', $stamp);`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T23:27:02.343

您默认使用哪个时区，在线工具使用哪个时区？我猜在线工具的 TZ 是 GMT (UTC) 而你的是 GMT+2，这可以解释差异。

我建议明确设置您的 TZ，或使用基于 GMT 的时间戳来避免这种类型的歧义。这样您就可以始终确定您使用的是什么基础，并且 TZ 转换很简单。

例如：

```
$ts = new DateTime('09/20/2012 02:00', new DateTimeZone('America/Lima'));
$ts->setTimeZone(new DateTimeZone('Asia/Tokyo'));
echo $ts->format('Y-m-d H:i:sP') . "\n"; 
```

上面的代码输出：

```
2012-09-20 16:00:00+09:00 
```

高温高压

# java - Java“优化”：如果控制在较低的类中

> ID：11570661
> 
> 赞同：-1
> 
> 时间：2012-07-19T23:13:08.247
> 
> 标签：java

是在调用层次结构的上层“仅”（主要）控制变量和参数，
还是
单独保存每个类以防止错误的参数更好，因为您不知道将来谁会调用它。

我此刻有点矛盾。但我倾向于写更多的 ifs 而不是让课程不受保护。

你怎么看？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T23:21:59.023

如果您指的是清理参数或实施业务规则，我认为您应该在专家模式背后应用相同的概念，即清理，在您拥有必要信息/知识的地方实施规则。

例如，在 MVC 应用程序中，应用程序的用户插入他的年龄，您可以验证控制器中的年龄是否为正（控制器应该具有的常识），但您只能验证用户介于指定此规则的模型层中某处的特定年龄。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T23:22:15.383

如果您的方法是类的公共接口（公共或受保护）的一部分，那么您不能信任您收到的参数，因此您应该验证它们。另一方面，如果该方法是私有的，则您可以完全控制要传递的参数，并且如果您确定永远不会传递无效数据，那么您可以放心地假设它们始终是正确的，并避免使用任何代码来验证它们.

现在，除了您自己之外，任何人都可能不知道您系统的公共接口到底是什么。即使一个类具有公共方法，声明它们的类完全封装并且其他用户无法访问，可能无法扩展它或在给定上下文之外使用它，在这些情况下，您的封装级别可以帮助您决定您是否真正控制作为参数传递的内容，然后您可以决定在给定的上下文中验证数据是否更安全。但是，当您相信您可以忽略作为参数传递的内容时，您应该验证它，恕我直言。

# javascript - 传单 GeoJSON 显示

> ID：11570669
> 
> 赞同：2
> 
> 时间：2012-07-19T23:14:21.093
> 
> 标签：javascript, geojson, leaflet

我遇到了一个任务，需要使用带有 geojson 的传单 js 库作为数据存储。几乎立即遇到以下问题：从 geojson 对象创建的多边形未显示在地图上。而由本机传单方法创建的多边形 - 完美运行。

这是我的代码：

```
 var map = new L.Map('map');
        var bingLayer = new L.BingLayer('AhVaalRWmmprMAMHj6lw18ALO-iVnIGzvkq7gYAX3U_bisCT8Q_lgGV25YOa0kiV', 'Aerial');
        map.setView(new L.LatLng(51.505, -0.09), 13).addLayer(bingLayer);
        var polygon = {
            "type": "Feature",
            "properties": {
                    "style": {
                        "color": "#004070",
                        "weight": 4,
                        "opacity": 1
                    }
            },
            "geometry": {
                "type": "Polygon",
                "coordinates": [[
                    [51.509, -0.08],
                    [51.503, -0.06],
                    [51.51, -0.047],
                    [51.509, -0.08]
                ]]
            }
        };
        var geojsonLayer = new L.GeoJSON(polygon);
        map.addLayer(geojsonLayer); 
```

如您所见，它几乎复制了一个由传单提供的示例。并且不起作用。我完全被这个麻烦所困扰，并将非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-30T21:24:03.683

问题是在`GeoJSON`规范中，坐标应该在表单中传递，`[lon, lat]`而 Leaflet`[lat, lon]`用于其对象。只需将其更改为`[-008, 51.509]`等，就可以了。:)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-04-29T06:44:56.033

我只是想补充一些我的观点-

只是一个令人困惑和矛盾的标准问题。

在谈论地理位置时，我们通常使用 Lat-long。

将`map.setView`a`l.LatLong`作为输入，其中第一个坐标是 a `Latitude`，第二个是`Longitude`。

示例：-因此，当您需要时`52.23N, 4.97E`，您可以通过`[52.23943, 4.97599]`

GeoJSON 标准规定，对于任何点，第一个参数是 the `X Coordinate (i.e. Longitude)`，第二个参数是`Y coordinate (i.e. Latitude)`;

因此，当您想`51.505N, 0.09E`进入时`GeoJSON`，您需要通过 `[-0.09, 51.505]`

```
var map = new L.Map('map');
var bingLayer = new L.BingLayer('AhVaalRWmmprMAMHj6lw18ALO-iVnIGzvkq7gYAX3U_bisCT8Q_lgGV25YOa0kiV', 'Aerial');
map.setView(new L.LatLng(-0.09, 51.505), 13).addLayer(bingLayer);
var polygon = {
    "type": "Feature",
        "properties": {
        "style": {
            "color": "#004070",
                "weight": 4,
                "opacity": 1
        }
    },
        "geometry": {
        "type": "Polygon",
            "coordinates": [
            [
                [51.509, -0.08],
                [51.503, -0.06],
                [51.51, -0.047],
                [51.509, -0.08]
            ]
        ]
    }
};
var geojsonLayer = new L.GeoJSON(polygon);
map.addLayer(geojsonLayer); 
```

你可以通过修改这个来调整你的视图..

```
map.setView(new L.LatLng(-0.09, 51.505), 13).addLayer(bingLayer); 
```

至

```
map.setView(new L.LatLng(-008, 51.509), 13).addLayer(bingLayer); 
```

我认为这个解释会有所帮助！更多请[点击这里](http://leafletjs.com/examples/geojson.html)

# java - 为什么将 Mapper 和 Reducer 类声明为静态的？

> ID：11570674
> 
> 赞同：6
> 
> 时间：2012-07-19T23:15:02.330
> 
> 标签：java, hadoop, mapreduce

这可能表明我缺乏对 Java 的理解，但我想知道为什么在大多数 MapReduce 程序中，mapper 和 reducer 类被声明为静态的？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-20T01:44:20.857

当将 mapper 和 reducer 类声明为另一个类的内部类时，必须将它们声明为 static，以便它们不依赖于父类。

Hadoop 使用反射为每个运行的 map 或 reduce 任务创建类的实例。创建的新实例需要一个零参数构造函数（否则它怎么知道要传递什么）。

通过在没有 static 关键字的情况下声明内部映射器或 reduce 类，java 编译器实际上创建了一个构造函数，该构造函数期望在构造时传入父类的实例。

您应该能够通过对生成的类文件运行 javap 命令来看到这一点

此外，在父类声明中使用 static 关键字时无效（这就是为什么您永远不会在顶层看到它，而只会在子类中看到它）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T23:20:14.463

我可以想到两个原因：

1.  在执行 map-reduce 方法时，**不需要**必须在对象中保留的状态。因此，所有必要的信息都传递给该方法，无需在对象中存储额外的数据。如果对象的**生命周期**不会超过一次方法调用，那么为什么还要与实例化作斗争呢？
2.  拥有多个对象是没有意义的，这与实现[Singleton Pattern](http://c2.com/cgi/wiki?SingletonPattern)的原因类似。

# solr - Solr 查询 - 返回所有不包含某个字段的结果

> ID：11570675
> 
> 赞同：2
> 
> 时间：2012-07-19T23:15:13.487
> 
> 标签：solr, lucene

有没有办法编写一个查询来返回所有不包含某个字段的结果？

例如，假设我有一个包含名字、姓氏和出生日期的人员索引。我想查询所有没有出生日期的人。不是所有birthDate 为空的人，而是所有没有birthDate 字段的人。这可能吗？

编辑：MATAN 在这里向我指出了答案 - [solr 搜索字段不存在的文档](https://stackoverflow.com/questions/4365369/solr-search-for-documents-where-a-field-doesnt-exist)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-02-20T13:43:15.963

您可以在现场使用负数。像那样：

```
-birthDate:*
or
-birthDate:[* TO *] 
```

# visual-studio-2010 - 泛化包含路径

> ID：11570678
> 
> 赞同：1
> 
> 时间：2012-07-19T23:15:20.913
> 
> 标签：visual-studio-2010, visual-studio, visual-c++, msbuild, include-path

我正在使用 Microsoft Visual Studios 2010，并且我发现了如何设置新的包含路径。现在我想做它，以便其他用户可以使用我的项目。例如，如果我当前的路径是 C:\Users\jsestrad\Documents\Homework\EE350\Lab\power，有没有办法可以从 ..\Homework\EE350\Lab\power 开始搜索，以便其他用户可以利用包含路径吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T23:17:44.427

您可以在路径中使用 MSBuild 属性`$(ProjectDir)`，其中 是项目所在`$(SolutionDir)`的目录，以及 是解决方案所在的目录。

最简单的做法是确保每个人都将包含文件放在相对于项目的相同位置，然后将包含路径设置为相对于`$(ProjectDir)`.

例如，如果您的项目在**C:\Users\jsestrad\Documents\Homework\EE350\Lab**中，并且您的包含在**C:\Users\jsestrad\Documents\Homework\Stuff**中，则可以添加**$(ProjectDir)..\东西**到你的包含路径。

# facebook - Facebook Connect 是否将电子邮件权限添加为扩展权限？

> ID：11570680
> 
> 赞同：1
> 
> 时间：2012-07-19T23:15:27.690
> 
> 标签：facebook, api, facebook-graph-api, facebook-php-sdk

最后我看到身份验证过程中的“电子邮件”权限是所有应用程序初始对话框（以及基本信息）的一部分。但是，今天我注意到对于我的应用程序，它在用户接受初始身份验证后显示为附加步骤（如扩展权限）。看截图： ![截屏](../Images/58bfdb13d7b67283e2ebd76124019d75.png)

我仍然看到其他具有旧式身份验证的站点/应用程序（第一步中的电子邮件）。我想知道我是否对导致它的权限或应用程序设置做错了什么？这就是我的 LoginUrl 的样子

[https://www.facebook.com/dialog/oauth?client_id=[app_id]&redirect_uri=[redirect_uri]&state=[state_code]&scope=email&display=popup](https://www.facebook.com/dialog/oauth?client_id=[app_id]&redirect_uri=[redirect_uri]&state=[state_code]&scope=email&display=popup)

在 Facebook 上的“身份验证对话框”>“经过身份验证的推荐人”>“用户和朋友权限”的应用程序设置中，我添加了“电子邮件”和“发布操作”权限。

# c - 如何中断输入

> ID：11570684
> 
> 赞同：2
> 
> 时间：2012-07-19T23:16:28.097
> 
> 标签：c, unix, io, pthreads

我正在实现一个使用两个线程的客户端：一个从服务器接收数据并将其打印到标准输出，另一个使用 fgets 向用户询问字符串并向服务器发送消息。线程始终在执行中，但有一个问题：我不知道如何停止从用户那里获取输入的线程。我尝试用 fclose 关闭标准输入，但流保持打开状态，直到用户输入一个字符串。如何关闭输入缓冲区以某种方式 fgets 被打断？
我希望这个问题很清楚。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T23:19:57.413

信号可以中断 I/O 操作。假设您没有将 SA_RESTART 标志用于 sigaction 信号处理程序，则读取将返回 EINTR 的 errno。

# android - 如何在同一个 Flash/Flex 代码库中实现多个移动商店 API？

> ID：11570689
> 
> 赞同：1
> 
> 时间：2012-07-19T23:17:20.887
> 
> 标签：android, ios, flash, apache-flex, mobile

Q/A 风格，因为我已经知道答案，但我认为其他人可能也会感兴趣。显然，更清洁的实现和建议也非常受欢迎。

Adobe Flex 允许对移动应用程序进行轻松的跨平台开发，但必须考虑到平台之间的某些功能不同。

Flex 通过本机扩展来管理这一点，但如果将 iOS 的本机扩展加载到 Android 应用程序中，则会破坏您的程序。

特别是，每个平台都有自己的应用内购买 API。一个人如何干净地实现多个商店 API，因为这个代码包含决定需要在编译时而不是运行时做出（像 Parsley 或 Swiz 这样的东西会很有用）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T23:17:20.887

我正在使用条件编译来换出编译时使用的实际存储实现类。它必须在编译时完成，因为在桌面或其他类型的手机上运行时加载 iOS Storekit 或 Android 存储本机扩展将不起作用。

我创建了一个或多或少是一个外壳的 PurchaseService，它的存在只是为了继承并因此实现其中一个商店实现：

```
CONFIG::AMAZON
{
import com.zo.comm.amazon.PurchaseServiceImpl;
}

CONFIG::DESKTOP
{ // used for testing without having to copy to a device
import com.zo.comm.desktop.PurchaseServiceImpl;
}

CONFIG::GOOGLE
{
import com.zo.comm.google.PurchaseServiceImpl;
}

CONFIG::IOS
{
import com.zo.comm.ios.PurchaseServiceImpl;
}

public class PurchaseService extends PurchaseServiceImpl
{...} 
```

每个 PurchaseServiceImpl 都继承自一个共享的通用 PurchaseServiceBase，它定义了 PurchaseService 类的外部接口。

以这种方式，唯一的条件编译代码位于 PurchaseService 类中。在 Flash Builder 中管理各种编译标志有点麻烦，但在 Ant 脚本中，它们很容易传递给 mxmlc：

闪存生成器：

```
-define=CONFIG::DESKTOP,false
-define=CONFIG::IOS,false
-define=CONFIG::ANDROID,true
-define=CONFIG::AMAZON,CONFIG::ANDROID&&false
-define=CONFIG::GOOGLE,CONFIG::ANDROID&&!CONFIG::AMAZON
-define=CONFIG::SANDBOX,false
-define=CONFIG::PRODUCTION,false
-define=CONFIG::STAGING,false
-define=CONFIG::LOCAL,true 
```

请注意，我在其中留下了一些其他东西，以便您可以查看可能使用条件编译的其他东西。由于我的大多数配置标志都是三个一组，我只是把它们拼出来。如果它是一个简单的“如果不是 ANDROID，那就是 IOS”，我只需将 IOS 设置为 true 或 false 并将 ANDROID 设置为 !CONFIG::IOS，正如在亚马逊与谷歌中所见的那样（尽管我必须改变当我添加 Nook 支持时... :-)。

在蚂蚁中：

```
 <define name="CONFIG::DESKTOP" value="${output.config.environment.desktop}"/>
  <define name="CONFIG::IOS" value="${output.config.environment.ios}"/>
  <define name="CONFIG::ANDROID" value="${output.config.environment.ios}"/>
  <define name="CONFIG::AMAZON" value="${output.config.environment.amazon}"/>
  <define name="CONFIG::GOOGLE" value="${output.config.environment.google}"/>
  <define name="CONFIG::PRODUCTION" value="${output.config.environment.production}"/>
  <define name="CONFIG::STAGING" value="${output.config.environment.staging}"/>
  <define name="CONFIG::LOCAL" value="${output.config.environment.local}"/>
  <define name="CONFIG::SANDBOX" value="${output.config.environment.sandbox}"/> 
```

对导入使用条件编译的注意事项：您必须使用如上所示的大括号。以下**将不起作用**，并且最后一次导入将始终获胜：

```
CONFIG::AMAZON
import com.zo.comm.amazon.PurchaseServiceImpl;

CONFIG::DESKTOP
import com.zo.comm.desktop.PurchaseServiceImpl;

CONFIG::GOOGLE
import com.zo.comm.google.PurchaseServiceImpl;

CONFIG::IOS
import com.zo.comm.ios.PurchaseServiceImpl; 
```

在 Flash Builder 中，您还需要管理哪些扩展包含在哪个平台的构建中。

# django - 如何将这些 Django 模型链接在一起？

> ID：11570693
> 
> 赞同：0
> 
> 时间：2012-07-19T23:17:33.103
> 
> 标签：django, django-models

我正在尝试将我们使用的 Excel 时间表移动到 Django 中。我已经掌握了非常基础的知识，但缺少一件事。我有大多数低级模型工作：

```
class Employee(models.Model):
    name = models.CharField(max_length=50)    
    def __unicode__(self):
        return self.name

class Client(models.Model):
    name = models.CharField(max_length=50)    
    def __unicode__(self):
        return self.name

class Location(models.Model):
    client = models.ForeignKey(Client)
    name = models.CharField(max_length=50)
    def __unicode__(self):
        return self.name 
```

这部分效果很好，我可以添加一个“客户端”并设置它们的多个位置。现在我正试图将所有这些与另一个模型联系起来。

```
Class WorkEvent(models.Model):
    description = models.CharField(max_length=100)
    startTime = models.DateTimeField('Start Time') 
```

在这里，我需要将 WorkEvent 的实例与“Employee”的实例和“Location”的实例联系起来。许多“WorkEvent”可以指向同一个“Employee”或“Location”，但每个“WorkEvent”只能有一个。我不确定如何建立这种关系。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T23:24:10.973

如果我了解您要查找的内容，则可以使用（我实际上还没有尝试过，可能存在语法或其他问题）：

```
Class WorkEvent(models.Model):
  description = models.CharField(max_length=100)
  startTime = models.DateTimeField('Start Time')
  client = models.ForeignKey(Client)
  employee = models.ForeignKey(Employee) 
```

# python - 使用 PyGTK 的像素坐标

> ID：11570700
> 
> 赞同：1
> 
> 时间：2012-07-19T23:18:35.723
> 
> 标签：python, ubuntu, pygtk, canonical-quickly

我正在使用**PyGTK在****Ubuntu**中创建一个图像查看器。

 **但是，我并不完全了解**pygtk** API。

我无法弄清楚如何使用**PyGTK**

1.  访问图像上的**点击点坐标**
2.  **读取一个像素值**。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-22T16:10:54.550

我认为您无法使用 PyGTK 提供的 API 以您想要的方式操作图像。
对于访问图像数据，我建议查看[Python Imaging Library (PIL)](http://www.pythonware.com/products/pil/)。
如果您是 GTK 的初学者，请不要错过[Gnome 开发者中心](http://developer.gnome.org)的教程。甚至还有[一个图像查看器的示例](http://developer.gnome.org/gnome-devel-demos/unstable/image-viewer.py.html.en)。
此外，请记住最近的 Ubuntu 应用程序是用 GTK 3 编写的。您在 Internet 上找到的许多示例仍然适用于 PyGTK 2.x，并且不鼓励您使用其中的代码（以防万一他们工作）。**

# mysql - MySQL左连接查询

> ID：11570703
> 
> 赞同：0
> 
> 时间：2012-07-19T23:18:47.377
> 
> 标签：mysql

我的数据库中有一个关系表，它有四个值 AKA...

```
id, int, primary, auto-incriment 
mem1, int
mem2, int
type, enum('a','b') 
```

我还有另一个表，其中包含成员 id、用户名、名字和姓氏

我想单击一个按钮并获得没有重复的两个人之间的关系。这是我到目前为止的查询...

```
SELECT 
    myMembers.id AS id, 
    myMembers.username AS username, 
    myMembers.firstname AS firstname,
    myMembers.lastname AS lastname 
FROM myMembers 
INNER JOIN memberRelations 
    ON memberRelations.mem2=myMembers.id
WHERE memberRelations.mem1='$id' OR memberRelations.mem2='$id' ORDER BY myMembers.username 
ASC 
```

这里的问题是，在某些用户上，它给了我正确的值，但在其他用户上，它给了我个人资料用户而不是其他成员关系。我怀疑这与查询的 ON 部分有关，但说实话我迷路了！有没有更好的方法来实现我的目标？或者我可以更正查询中的某些内容吗？任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T00:25:28.380

根据您的问题，我认为您需要以下选择关系的两个成员：

```
SELECT
    R.type,
    M1.id AS id1, 
    M1.username AS username1, 
    M1.firstname AS firstname1,
    M1.lastname AS lastname1,
    M2.id AS id1, 
    M2.username AS username2, 
    M2.firstname AS firstname2,
    M2.lastname AS lastname2
FROM memberRelations AS R
       INNER JOIN myMembers AS M1 ON R.mem1=M1.id
       INNER JOIN myMembers AS M2 ON R.mem2=M2.id
WHERE R.mem1='$id' OR R.mem2='$id' 
```

# php - 如何在 PHP 中接收 JSON 对象？

> ID：11570713
> 
> 赞同：6
> 
> 时间：2012-07-19T23:19:36.373
> 
> 标签：php, javascript, jquery, ajax, json

我正在尝试将 JSON 对象从 AJAX 请求发送到我的服务器。

我用这样的 JQuery 做这个：

```
 $.ajax({
    type: "POST",
    url: settings.ajax.post,
    dataType: 'json',
    data: basket.aggregate(Basket.EXPORT_JSON, qty),
    success: function(data, textStatus, jqXHR) {
      if (typeof settings.ajax.success == "function") settings.ajax.success(data, textStatus, jqXHR);
    },
    error: function(jqXHR, text, e) {
      if (typeof settings.ajax.error == "function") settings.ajax.error(jqXHR, text, e);
    }
  }); 
```

url 指向服务器上的这个文件：

```
<?php

$to = "<my-email-address>";
$subject = "JSON test";
$message = "POST dump:\n\n";

foreach($_POST as $key=>$value)
    {
        $message .= $key . ":" . $value;
    }

mail ($to, $subject, $message);

exit;
?> 
```

但是 POST var 似乎是空的，即使在 Firebug 中我可以看到正确的数据已发送到服务器：

![Firebug 可以看到 JSON 对象](../Images/aacf9233ec14d42899be4ef3bebd55d2.png)

每次发送请求后，调用ajax错误函数，出现未定义错误（我猜是因为服务器没有回复？还是我不知道？）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-19T23:35:03.677

POST 需要键值对，但您只是在没有键的情况下向其发送一个值（JSON 字符串）。它必须是一个数组。

其次，您需要先对 JSON 进行解码，然后才能在 PHP 中将其用作数组或对象。`json_decode()`用于此。

# php - AJAX/JS：抓取多个输入字段而不刷新或按钮单击和 php 回显值

> ID：11570718
> 
> 赞同：2
> 
> 时间：2012-07-19T23:20:02.333
> 
> 标签：php, javascript, jquery, ajax

我目前正在使用 Ajax/JS 提交表单，而无需刷新页面或单击按钮。我已经设置了一个计时器`keyup`来触发该功能。我已经用一个输入字段对其进行了测试并且效果很好，但是现在已经添加了其他输入字段，我没有得到 PHP 回显的结果。我已经使用 firefox bug 工具进行了检查，结果正在存储中。我不确定这是 JS 还是 PHP 问题。

用户停止输入后，如何正确回显输入字段的值？[例子](http://webprolearner2346.zxq.net/TabsNextPrev/index.php)

**JS/AJAX**

```
<script>
$(document).ready(function() {
  var timer = null; 
  var dataString;   
     function submitForm(){
    $.ajax({ type: "POST",
    url: "index.php",
    data: dataString,
    success: function(result){
    $('#special').html('<p>' +  $('#resultval', result).html() + '</p>');}
                                  });
               return false;
             }
          $('#contact_form').on('keyup', function() {
    clearTimeout(timer);
    timer = setTimeout(submitForm, 2000);
    var name = $("#contact_name, #email, #phone, #address, #website").val();
    dataString = 'name='+ name;
             });
             }); 
</script> 
```

**HTML/PHP 片段**

```
<form action="" method="post" enctype="multipart/form-data" id="contact_form" name="form4">
 <div class="row"> 
  <div class="label">Contact Name *</div> <!-- end .label -->
    <div class="input">
      <input type="text" id="contact_name" class="detail" name="contact_name" value="<?php echo isset($_POST['contact_name'])? $_POST['contact_name'] : ''; ?>" /> 
      <div id="special"><span id="resultval"><? echo $_POST['contact_name'];  ?></span></div>
    </div><!-- end .input-->
 </div><!-- end .row -->

 <div class="row"> 
  <div class="label">Email Address *</div> <!-- end .label -->
   <div class="input">
    <input type="text" id="email" class="detail" name="email" value="<?php echo isset($_POST['email'])? $_POST['email'] : ''; ?>" /> 
    <div id="special"><span id="resultval"><? echo $_POST['email'];  ?></span></div>
   </div><!-- end .input-->
 </div><!-- end .row --> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T23:40:20.077

您需要建立数据，而不是尝试进行批量分配。例如，您目前拥有：

```
 var name = $("#contact_name, #email, #phone, #address, #website").val(); 
```

该 jquery 应该匹配它匹配的第一个标识符，最有可能是 ID 为 contact_name 的元素，这将是*name*的唯一值，因为您希望获得多个表单数据字段。

实际上，您根本不需要构建 dataString，因为您的数据将通过表单通过邮寄方式提交。

重写JS：

```
$(document).ready(function() {
    var timer = null; 
    var dataString;   
    function submitForm(){
        $.ajax({ type: "POST",
            url: "index.php",
            dataType: 'json',
            success: function(result){
            $('#special').html('<p>' +  $('#resultval', result).html() + '</p>');}
                              });
        return false;
    }
    $('#contact_form').on('keyup', function() {
        clearTimeout(timer);
        timer = setTimeout(submitForm, 2000);
    });
}); 
```

在您的 index.php 中，您可以访问 $_POST 数组中的表单值，例如 $_POST['contact_name']。

# php - 如何使用友好的 URL？

> ID：11570720
> 
> 赞同：1
> 
> 时间：2012-07-19T23:20:08.467
> 
> 标签：php, mysql, url, rewrite

我一直在研究一小段 php 脚本，花了我几天时间（我是菜鸟）

这是我的代码：

```
<?php
require ('connect.php');

$requete = mysql_query('SELECT * FROM videos WHERE id="'.$_GET['id'].'"') or die(mysql_error());

if(mysql_num_rows($requete)=='0'){
}else{
    while($resultats = mysql_fetch_array($requete)){ 
?> <!-- some html content --> <?php
    }
}

mysql_close(); 
?>
</body>
</html> 
```

该脚本根据 ID 从我的数据库中检索内容。

> http://localhost/mysite/video/atest.php?id=1

我想知道我必须使用哪种 url 重写来检索一些关键字。我想要那种网址：

> http://localhost/mysite/video/1-first-video-title

```
RewriteEngine On

RewriteCond %{REQUEST_URI} !\.(css|png|jpe?g|gif|js|mp3|3gp|ico)$
RewriteRule atest/([a-zA-Z0-9\-]+)-([0-9]+) atest.php?id=$1&url=$2[L,QSA] 
```

出事了吗？

我也想使用它，但屏幕上什么也没显示（找不到此页面）。

```
if($resultats["url"]!=$_GET["url"]) {
  header ("location:/mysite/video/".$resultats["url"]."-".$resultats["id"]);
} 
```

它在我的表中搜索它找到 URL 关键字。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T03:22:07.410

我认为您的问题实际上可能非常简单：RewriteRule 以错误的方式捕获变量，`RewriteRule atest/([a-zA-Z0-9\-]+)-([0-9]+) atest.php?id=$1&url=$2[L,QSA]`将匹配“atest/example-42”并将其映射到“atest.php?id=example&url=42” - $1 指的是第一个一组括号，第二个是 $2。尝试一个`print_r()`或`var_export()``$_GET`

顺便说一句，该正则表达式在某些极端情况下可能会出错，因为它没有断言 ID 必须出现在最后 - 所以“atest/example-2-word-42”最终可能会选择 ID 为 2 ，而不是 42。添加“$”应该可以解决这个问题：`RewriteRule atest/([a-zA-Z0-9\-]+)-([0-9]+)$ atest.php?id=$1&url=$2 [L,QSA]`

如果重写规则根本不起作用（您的问题不清楚结果是什么），那么 Apache 的 .htaccess 处理可能有些微妙......

# debugging - Valgrind 之类的内存泄漏检查器如何免费识别

> ID：11570724
> 
> 赞同：1
> 
> 时间：2012-07-19T23:20:53.500
> 
> 标签：debugging, memory-management, memory-leaks

我想了解内存泄漏检查器如何识别是否为给定的 malloc 调用了 free。malloc 可以通过 brk 系统调用轻松识别，因此，如果我正在编写分析器并在系统调用中断的进程上执行单步操作，我可以很容易地理解 malloc 已经完成。我如何才能找到这个 malloc 是否已调用免费？

下面是 strace 的输出。这段代码有 free，我们如何通过检查这个 strace 来判断是否调用了 free -

```
read(0, "13608\n", 4096)                = 6
brk(0)                                  = 0x8cc6000
brk(0x8ce7000)                          = 0x8ce7000
write(1, "File name - /proc/13608/maps\n", 29) = 29
open("/proc/13608/maps", O_RDONLY)      = 3
fstat64(3, {st_mode=S_IFREG|0444, st_size=0, ...}) = 0
mmap2(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x55559000
read(3, "00349000-00363000 r-xp 00000000 "..., 4096) = 1046
write(1, "ptr1-ffd1f49a\n", 14)         = 14
write(1, "ptr2-ffd1f4a8\n", 14)         = 14
write(1, "Buffer read - 00349000-00363000 "..., 102) = 102
write(1, "\n", 1)                       = 1
write(1, "ptr1-ffd1f49a\n", 14)         = 14
write(1, "ptr2-ffd1f4aa\n", 14)         = 14
write(1, "Buffer read - 00367000-004a6000 "..., 104) = 104
write(1, "\n", 1)                       = 1
write(1, "ptr1-ffd1f49a\n", 14)         = 14
write(1, "ptr2-ffd1f4bd\n", 14)         = 14
write(1, "Buffer read - 08048000-08049000 "..., 123) = 123
write(1, "\n", 1)                       = 1
write(1, "ptr1-ffd1f49a\n", 14)         = 14
write(1, "ptr2-ffd1f4a1\n", 14)         = 14
write(1, "Buffer read - ffad8000-ffaf1000 "..., 95) = 95
write(1, "\n", 1)                       = 1
write(1, "ptr1-ffd1f479\n", 14)         = 14
write(1, "ptr2-ffd1f479\n", 14)         = 14
write(1, "Buffer read - ffffe000-fffff000 "..., 55) = 55
write(1, "\n", 1)                       = 1
read(3, "", 4096)                       = 0
close(3)                                = 0
munmap(0x55559000, 4096)                = 0
write(1, "Starting Address - 00349000\n", 28) = 28
write(1, "Ending Address - 00363000\n", 26) = 26
write(1, "Permissions - r-xp\n", 19)    = 19
write(1, "Offset - 00000000\n", 18)     = 18
write(1, "PathName - </lib/ld-2.5.so>\n", 28) = 28
write(1, "\n", 1)                       = 1
write(1, "\n", 1)                       = 1
write(1, "Starting Address - 00367000\n", 28) = 28
write(1, "Ending Address - 004a6000\n", 26) = 26
write(1, "Permissions - r-xp\n", 19)    = 19
write(1, "Offset - 00000000\n", 18)     = 18
write(1, "PathName - </lib/libc-2.5.so>\n", 30) = 30
write(1, "\n", 1)                       = 1
write(1, "\n", 1)                       = 1
write(1, "Starting Address - 08048000\n", 28) = 28
write(1, "Ending Address - 08049000\n", 26) = 26
write(1, "Permissions - r-xp\n", 19)    = 19
write(1, "Offset - 00000000\n", 18)     = 18
write(1, "PathName - </fs_user/samirba/myP"..., 49) = 49
write(1, "\n", 1)                       = 1
write(1, "\n", 1)                       = 1
write(1, "Starting Address - ffad8000\n", 28) = 28
write(1, "Ending Address - ffaf1000\n", 26) = 26
write(1, "Permissions - rw-p\n", 19)    = 19
write(1, "Offset - 7ffffffe6000\n", 22) = 22
write(1, "PathName - <[stack]>\n", 21)  = 21
write(1, "\n", 1)                       = 1
write(1, "\n", 1)                       = 1
write(1, "Starting Address - ffffe000\n", 28) = 28
write(1, "Ending Address - fffff000\n", 26) = 26
write(1, "Permissions - r-xp\n", 19)    = 19
write(1, "Offset - ffffe000\n", 18)     = 18
write(1, "PathName - <EMPTY>\n", 19)    = 19
write(1, "\n", 1)                       = 1
write(1, "\n", 1)                       = 1
exit_group(0)                           = ? 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T23:29:39.953

malloc 调用和系统调用之间没有一对一的关系。通常，malloc 库将使用例如 brk 系统调用或 mmap 系统调用从操作系统获取大块。然后这些大块将被切割成更小的块，以服务于连续的 malloc 调用。free 通常不会导致调用系统调用（例如 munmap）。因此，您无法在系统调用级别真正跟踪 malloc 和 free 。

Valgrind 可以跟踪内存泄漏，因为它拦截（和替换）malloc、free、...... Valgrind 替换函数正在维护分配块的列表。

Valgrind 通过扫描所有活动内存来发现真正的泄漏（即无法再访问的内存，即所有指向它的指针都已丢失/擦除）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T23:24:43.433

AFAIK，操作系统分配的内存块由起始地址标识。因此，查找`free()`使用相同参数调用的方法，该参数由`malloc()`先前返回。随着`strace`记录更多低级`mmap`和`brk`调用，用于`ltrace`记录高级库调用，密切关注返回值和参数。

# intellij-idea - IntelliJ 和 M2 存储库

> ID：11570726
> 
> 赞同：9
> 
> 时间：2012-07-19T23:21:00.623
> 
> 标签：intellij-idea

我已经在 IntelliJ 中配置了 Maven，并且路径对 M2 存储库是正确的。当我的项目需要依赖项时，我如何告诉 IntelliJ 查看该存储库？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T15:42:31.403

[在 Settings > Maven 单击 Local repository directory http://www.jetbrains.com/idea/webhelp/maven.html](http://www.jetbrains.com/idea/webhelp/maven.html)旁边的 Override

希望这可以帮助。

# actionscript-3 - Adobe Flex：如何定期轮询 HTTP 服务？

> ID：11570728
> 
> 赞同：0
> 
> 时间：2012-07-19T23:21:03.013
> 
> 标签：actionscript-3, apache-flex, flex4

我有一个嵌入式系统，通过 CGI 进程提供 JSON 结果。我正在尝试设置一个 Flex 应用程序。每秒定期轮询服务器一次并更新 GUI。我正在使用计时器尝试以下方法，但我只得到初始结果，没有进行后续更新。可能出了什么问题？

```
<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
               xmlns:s="library://ns.adobe.com/flex/spark" 
               xmlns:mx="library://ns.adobe.com/flex/mx" minWidth="955" minHeight="600"
               creationComplete="application1_creationCompleteHandler(event)">
    <fx:Declarations>
        <!-- Place non-visual elements (e.g., services, value objects) here -->
        <mx:HTTPService id="getPacketCounts" showBusyCursor="true" resultFormat="text" 
                        url="http://10.1.10.28/cgi-bin/getpacketcounts" 
                        requestTimeout="500"
                        result="getPacketCounts_resultHandler(event)"
                        fault="faultHandler(event)">
        </mx:HTTPService>       
    </fx:Declarations>
    <fx:Script>
        <![CDATA[
            import mx.controls.Alert;
            import mx.events.FlexEvent;
            import mx.rpc.events.FaultEvent;
            import mx.rpc.events.ResultEvent;
            private var timer:Timer = new Timer(1000, 0);
            private var counter:int;

            protected function application1_creationCompleteHandler(event:FlexEvent):void
            {
                timer.addEventListener(TimerEvent.TIMER, timerListener);
                timer.start();
            }

            private function timerListener(evt:Event):void {
                label.text = "get http://10.1.10.28/cgi-bin/getpacketcounts";
                getPacketCounts.send();
            }

            protected function getPacketCounts_resultHandler(event:ResultEvent):void
            {
                label.text = event.result.toString().substr(0, 60);
            }           

            protected function faultHandler(event:FaultEvent):void
            {
                Alert.show("The server returned error code " + event.statusCode + ".", event.fault.faultString);
            }               
        ]]>
    </fx:Script>
    <s:Label id="label" text="v1.0"/>
</s:Application> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T01:03:14.400

尽管我怀疑问题在于您`Timer`与`HTTPService`. 您`Timer`每秒都会触发一次，但您可能需要更长的时间`HTTPService`才能返回结果，并且您的下一个滴答声会`Timer`践踏上一个`getPacketCounts.send()`请求。不过，我对此不是 100% 确定的。

如果我正在编写这个应用程序，我会对其进行设置，以便`Timer`触发一次，重置`Timer`, 发送的`HTTPService`请求，然后等待响应，然后重新启动`Timer`.

```
 // Make the Timer run once.
   private var timer:Timer = new Timer(1000, 1);

   // ....

   // Add listeners to the Timer and start it
   protected function application1_creationCompleteHAndler(event:FlexEvent):void
   {
       timer.addEventListener(TimerEvent.TIMER_COMPLETE, timerListener);
       timer.start();
   }

   // Send the request
   private function timerListener(e:TimerEvent):void
   {
       timer.reset();
       // Your other stuff
   }

   protected function getPacketCounts_resultHandler(event:ResultEvent):void
   {
       timer.start()
       // Your code
   }           

   protected function faultHandler(event:FaultEvent):void
   {
       timer.start()
       // Your code
   } 
```

# ios - 关闭弹出窗口时是否可以弹出到弹出窗口中的特定视图？

> ID：11570729
> 
> 赞同：0
> 
> 时间：2012-07-19T23:21:09.843
> 
> 标签：ios

我有一个弹出框，它有一个主视图，用于从几个子视图中进行选择，当用户在弹出框外部点击并关闭窗口时，我想将弹出框重置为主视图。

例如，主弹出视图具有选项、类别、单词列表和结果。我想这样做，以便用户下次调用弹出框时，他们会转到主视图，而不是回到他们上次关闭弹出框时所在的视图。

如果我只有一层深，我可以使用

```
- (void)viewWillDisappear:(BOOL)animated {
    [[self navigationController] popToRootViewControllerAnimated:YES];
    [super viewWillDisappear:animated];
} 
```

但是，如果我在层次结构中很深，例如 WordList:Category:Words 我不能在 WordList 或 Category 中弹出到根目录，因为当视图消失时，我想进入下一个级别。如果我使用上面列出的代码，我无法降低一个级别。我弹出到根视图。

我想要的是能够告诉弹出视图在它被解雇时弹出到它的根。像这样的东西：

```
- (void)popoverControllerDidDismissPopover:(UIPopoverController *)popoverController {
    [[self popover] popToRootViewControllerAnimated:YES];
    [self.popoverController dismissPopoverAnimated:YES];

} 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T16:08:16.137

初始化弹出框时，我测试它是否已经存在。如果是这样，我跳过初始化并直接进入弹出窗口。这就是为什么当弹出框被关闭时，它会停留在用户离开它的任何视图中。

为了让它从第一个视图开始，我只需要将弹出框设置为 nil。

```
- (void)popoverControllerDidDismissPopover:(UIPopoverController *)popOverController {

    [self.popoverController dismissPopoverAnimated:YES];
    self.popoverController = nil; 
```

现在，当用户调用弹出框时，它会创建一组新的视图，从主菜单开始。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T00:22:06.603

我相信你想要的是 UIPopoverController 的`contentViewController`属性，它将是你初始化弹出框的任何视图控制器——很可能是导航控制器。这个...

[self.popover.contentViewController popToRootViewControllerAnimated:YES];

...应该为您解决问题。

# python - 在python中读/写带有变音符号的文件（html到txt）

> ID：11570732
> 
> 赞同：0
> 
> 时间：2012-07-19T23:21:21.007
> 
> 标签：python, utf-8

我知道这已经被问过好几次了，但我认为我做的一切都是正确的，但它仍然不起作用，所以在我临床发疯之前，我会发一个帖子。这是代码（它应该将 HTML 文件转换为 txt 文件并省略某些行）：

```
fid = codecs.open(htmlFile, "r", encoding = "utf-8")
if not fid:
    return
htmlText = fid.read()
fid.close()

stripped = strip_tags(unicode(htmlText))   ### strip html tags (this is not the prob)
lines = stripped.split('\n')
out = []

for line in lines: # just some stuff i want to leave out of the output
    if len(line) < 6:
        continue
    if '*' in line or '(' in line or '@' in line or ':' in line:
        continue
    out.append(line)

result=  '\n'.join(out)
base, ext = os.path.splitext(htmlFile)
outfile = base + '.txt'

fid = codecs.open(outfile, "w", encoding = 'utf-8')
fid.write(result)
fid.close() 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T02:37:32.770

您还没有指定问题，所以这是一个完整的猜测。

你的`strip_tags()`函数返回了什么？它是返回一个 unicode 对象，还是一个字节字符串？如果是后者，当您尝试将其写入文件时可能会导致解码问题。例如，如果`strip_tags()`返回一个 utf-8 编码的字节字符串：

```
>>> s = u'This is \xe4 test\nHere is \xe4nother line.'
>>> print s
This is ä test
Here is änother line.

>>> s_utf8 = s.encode('utf-8')
>>> f=codecs.open('test', 'w', encoding='utf8')
>>> f.write(s)    # no problem with this... s is unicode, but
>>> f.write(s_utf8)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/lib64/python2.7/codecs.py", line 691, in write
    return self.writer.write(data)
  File "/usr/lib64/python2.7/codecs.py", line 351, in write
    data, consumed = self.encode(object, self.errors)
UnicodeDecodeError: 'ascii' codec can't decode byte 0xc3 in position 8: ordinal not in range(128) 
```

如果这是您所看到的，您需要确保将 unicode 传入`fid.write(result)`，这可能意味着确保 unicode 由`strip_tags()`.

* * *

此外，我顺便注意到了一些其他的事情：

`codecs.open()``IOError`如果无法打开文件，将引发异常。它不会返回 None，因此`if not fid:`测试将无济于事。您需要使用`try/except`，最好与`with`.

```
try:
    with codecs.open(htmlFile, "r", encoding = "utf-8") as fid:
        htmlText = fid.read()
except IOError, e:
    # handle error
    print e 
```

而且，您从通过打开的文件中读取的数据`codecs.open()`将自动转换为 unicode，因此调用`unicode(htmlText)`没有任何效果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T23:23:06.840

不确定，但通过做

```
'\n'.join(out) 
```

使用非 unicode 字符串（但普通的旧`bytes`字符串），您可能会退回到某些非 UTF-8 编解码器。尝试：

```
u'\n'.join(out) 
```

确保您在任何地方都使用 unicode 对象。

# ruby-on-rails - 当自动保存关联执行 DDL 失败时，保存在具有嵌套属性的模型上不会回滚

> ID：11570733
> 
> 赞同：1
> 
> 时间：2012-07-19T23:21:35.513
> 
> 标签：ruby-on-rails, activerecord, transactions, ruby-on-rails-3.2, oracle-call-interface

以下是父级和子级之间的类定义：-

```
class System
  has_many :members, :dependent => :destroy
  accepts_nested_attributes_for :members
  attr_accessible :name, :members_attributes
  validates_presence_of :name , :members

class Member
   belongs_to :system
   attr_accessible  :name
   validates_presence_of :name
   before_create :create_physical_schema_for_user 
```

在控制器中，我一口气创建了整个关系：-

```
@system = System.new(params[:system])
...
@system.save 
```

事情一直很好，直到孩子中的一个 before_create 回调因 OCIError（由 ruby​​-oci8 gem 引发）导致 ActiveRecord::StatementInvalid 异常而失败。在这个阶段，即使其中一个子关联没有被保存，父也会被保存。我不确定，如果这是 rails 或 oracle 适配器的问题。

另外仅供参考，create_physical_schema_for_user 方法以下列方式运行一组 DDL：-

```
def self.create_physical_schema_for_user(name)
  ddl_stmt = ['...',name]
  self.connection.execute(sanitize_sql(ddl_stmt))
end 
```

我发现这些链接正在讨论相同的问题（只是回调不同）

[https://rails.lighthouseapp.com/projects/8994/tickets/3391-nested-attributes-vs-before_save](https://rails.lighthouseapp.com/projects/8994/tickets/3391-nested-attributes-vs-before_save)

[https://rails.lighthouseapp.com/projects/8994/tickets/3045-nested_attributes-doesnt-rollback-parent-when-before_saveafter_save-callbacks-fail](https://rails.lighthouseapp.com/projects/8994/tickets/3045-nested_attributes-doesnt-rollback-parent-when-before_saveafter_save-callbacks-fail)

其中一个说这已经合并到 Rails 2 中，我仍然在 rails 3.2.5 中遇到了这个问题，但是使用了 Oracle 适配器

我想知道在单个事务中固有地保存父级及其所有关联的最佳方法是什么，这样即使一个子级创建失败，我们也会回滚整个父级事务。

环境：Rails 3.2.5，Ruby 1.9.2

数据库：Oracle 11g XE 通过 ruby​​-oci8 (2.1.2) & activerecord-oracle_enhanced-adapter (1.4.1) gem

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-21T01:07:33.997

如果我没有在回调中使用 DDL，这整个问题就不会发生——它会自动提交打开的事务。因此，即使其中一个 DDL 失败，父级也不能回滚，因为它已经提交了。

我已经完成以下操作以在单独的数据库连接中执行 DDL，因此它们的失败不会影响模型的事务并且可以安全地回滚。

我定义了一个类来在单独的连接中处理 DDL 执行。

```
class SqlSystem  < ActiveRecord::Base
 establish_connection Rails.configuration.database_configuration[Rails.env]
 private
 def self.execute_ddl(stmt)
    self.connection.execute(sanitize_sql(stmt))
 end
end 
```

在成员类的 before_create 回调中：-

```
def self.create_physical_schema_for_user(name)
  begin 
    SqlSystem.execute_ddl('...')
  rescue => error
    return false # Or Re-Raise the exception, whichever suits
  end
end 
```

注意：我知道它不是从 ActiveRecord 执行 DDL 的 Rails 方式，但我正在为 DBA 开发一个应用程序来管理他们的生产环境，例如。配置用户、授予权限等，因此需要执行 DDL。我还没有找到更好的方法来做到这一点。

# javascript - jQuery UI Accordion + Cookies - 默认关闭？

> ID：11570734
> 
> 赞同：3
> 
> 时间：2012-07-19T23:21:37.053
> 
> 标签：javascript, jquery, jquery-ui

使用 jQuery UI Accordion，我成功地使用 cookie 来记住刷新页面时的最后一个活动状态 - 但是我无法：

1.  设置为在首次访问时崩溃

2.  让cookie记住用户是否在打开后手动折叠

我试图尝试在“活动”选项上创建一个带有条件语句的函数，但没有成功。

[http://jsfiddle.net/77xC9/18/](http://jsfiddle.net/77xC9/18/)

```
jQuery(document).ready(function(){
        var act = 0;
        $( "#accordion" ).accordion({
            create: function(event, ui) {
                //get index in cookie on accordion create event
                if($.cookie('saved_index') != null){
                   act =  parseInt($.cookie('saved_index'));
                }
            },
            change: function(event, ui) {
                //set cookie for current index on change event
                $.cookie('saved_index', null);
                $.cookie('saved_index', ui.options.active);
            },
            active:parseInt($.cookie('saved_index')),
            collapsible: true
        });
    }); 
```

​</p>

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-05-07T17:16:48.783

共享代码在 jQuery UI 1.9+ 中不起作用。以下代码有效！

```
jQuery(document).ready(function() {
    $("#accordion").accordion({
        activate: function(event, ui) {
            $.cookie('saved_index', $("#accordion").accordion("option", "active"));
        },
        active: parseInt($.cookie('saved_index')),
        collapsible: true
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-20T00:00:57.730

```
jQuery(document).ready(function(){
    $( "#accordion" ).accordion({
        change: function(event, ui) {
            $.cookie('saved_index', ui.options.active !== false ? ui.options.active : null);
        },
        active: $.cookie('saved_index') != null ? parseInt($.cookie('saved_index')) : false,
        collapsible: true
    });
}); 
```

ps：如果您将页面作为本地文件打开，谷歌浏览器不接受 cookie。

# iphone - NSHTTPCookieStorage 的共享实例不保留 cookie

> ID：11570737
> 
> 赞同：16
> 
> 时间：2012-07-19T23:22:10.570
> 
> 标签：iphone, ios, ios5, nshttpcookie

我正在开发一个应用程序，服务器向我发送一个 cookie 来识别用户。

我的连续请求需要该 cookie 才能获得用户期望的响应。我无法理解的是 NSHTTPCookieStorage 的共享实例如何以及何时丢失其 cookie。

我使用的第一个解决方案是在应用程序终止时将 cookie 从我的服务器存档并保存到用户默认值，然后在应用程序启动时从我的服务器中清除现有的 cookie 并重置我存储的那些。在开发过程中我没有遇到问题，因为调试会话非常短，通常不需要将应用程序置于后台。

在 beta 测试期间，麻烦开始了。我带来的技巧是不仅在应用程序终止时保存 cookie，而且在将这些 cookie 交还给我的 API 调用之后保存。并且不仅在应用程序启动时加载保存的 cookie，而且在应用程序返回前台时加载。

NSHTTPCookieStorage 共享实例如何摆脱这些 cookie 以及处理它的最佳实践是什么，因为它是我的应用程序的重要组成部分，如果没有更有经验的开发人员支持，我不能相信这样一个被黑的解决方案。

预先感谢您的回答

编辑：以下是保存/读取/清除 cookie 的方法

```
-(void)saveStoredCookies
{
    NSURL *httpUrl = @"http://myServer.com";
    NSURL *httpsUrl = @"https://myServer.com";

    NSArray *httpCookies = [[NSHTTPCookieStorage sharedHTTPCookieStorage] cookiesForURL:httpUrl];
    NSData *httpCookiesData = [NSKeyedArchiver archivedDataWithRootObject:httpCookies];
    [[NSUserDefaults standardUserDefaults] setObject:httpCookiesData forKey:@"savedHttpCookies"];

    NSArray *httpsCookies = [[NSHTTPCookieStorage sharedHTTPCookieStorage] cookiesForURL:httpsUrl];
    NSData *httpsCookiesData = [NSKeyedArchiver archivedDataWithRootObject:httpsCookies];
    [[NSUserDefaults standardUserDefaults] setObject:httpsCookiesData forKey:@"savedHttpsCookies"];

    [[NSUserDefaults standardUserDefaults] synchronize];
}

-(void)readStoredCookies
{
    //clear, read and install stored cookies
    NSURL *httpUrl = @"http://myServer.com";
    NSURL *httpsUrl = @"https://myServer.com";

    NSArray *cookies = [[NSHTTPCookieStorage sharedHTTPCookieStorage] cookiesForURL:httpUrl];
    for (NSHTTPCookie *cookie in cookies) {
        [[NSHTTPCookieStorage sharedHTTPCookieStorage] deleteCookie:cookie];
    }
    cookies = [[NSHTTPCookieStorage sharedHTTPCookieStorage] cookiesForURL:httpsUrl];
    for (NSHTTPCookie *cookie in cookies) {
        [[NSHTTPCookieStorage sharedHTTPCookieStorage] deleteCookie:cookie];
    }

    NSData *httpCookiesData = [[NSUserDefaults standardUserDefaults] objectForKey:@"savedHttpCookies"];
    if([httpCookiesData length]) {
        NSArray *savedCookies = [NSKeyedUnarchiver unarchiveObjectWithData:httpCookiesData];
        for (NSHTTPCookie *cookie in savedCookies) {
            [[NSHTTPCookieStorage sharedHTTPCookieStorage] setCookie:cookie];
        }       
    }
    NSData *httpsCookiesData = [[NSUserDefaults standardUserDefaults] objectForKey:@"savedHttpsCookies"];
    if([httpsCookiesData length]) {
        NSArray *savedCookies = [NSKeyedUnarchiver unarchiveObjectWithData:httpsCookiesData];
        for (NSHTTPCookie *cookie in savedCookies) {
            [[NSHTTPCookieStorage sharedHTTPCookieStorage] setCookie:cookie];
        }       
    }
}

-(void)clearStoredCookies
{
    NSURL *httpUrl = @"http://myServer.com";
    NSURL *httpsUrl = @"https://myServer.com";
    NSArray *cookies = [[NSHTTPCookieStorage sharedHTTPCookieStorage] cookiesForURL:httpUrl];
    for (NSHTTPCookie *cookie in cookies) {
        [[NSHTTPCookieStorage sharedHTTPCookieStorage] deleteCookie:cookie];
    }
    cookies = [[NSHTTPCookieStorage sharedHTTPCookieStorage] cookiesForURL:httpsUrl];
    for (NSHTTPCookie *cookie in cookies) {
        [[NSHTTPCookieStorage sharedHTTPCookieStorage] deleteCookie:cookie];
    }
} 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-08-10T04:15:39.823

NSHttpCookieStorage 丢失了它的 cookie，因为你没有设置 cookie 的过期时间。设置过期时间是必要的，否则当您的应用退出时，您的 cookie 将丢失。

下面是我在应用退出和启动期间如何存储我的 cookie 的快速浏览，

```
NSMutableDictionary *cookieProperties = [NSMutableDictionary dictionary];
[cookieProperties setObject:name forKey:NSHTTPCookieName];
[cookieProperties setObject:strValue forKey:NSHTTPCookieValue];
[cookieProperties setObject:@"myserver.com" forKey:NSHTTPCookieDomain];    // Without http://
[cookieProperties setObject:@"myserver.com" forKey:NSHTTPCookieOriginURL]; // Without http://
[cookieProperties setObject:@"/" forKey:NSHTTPCookiePath];

// set expiration to one month from now or any future NSDate of your choice
// this makes the cookie sessionless and it will persist across web sessions and app launches
/// if you want the cookie to be destroyed when your app exits, don't set this
[cookieProperties setObject:[[NSDate date] dateByAddingTimeInterval:2629743] forKey:NSHTTPCookieExpires];

NSHTTPCookie *cookie = [NSHTTPCookie cookieWithProperties:cookieProperties];
[[NSHTTPCookieStorage sharedHTTPCookieStorage] setCookie:cookie]; 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-11T04:06:36.333

这是模拟器吗？并使用滚动饼干？

在模拟器中，cookie 并没有真正按照应有的方式持续存在，因为它们与桌面 Safari 共享。当 cookie 滚动时，一个最终会覆盖另一个。

这不是设备本身的问题，每个应用程序都有自己的 cookie 存储。（而且，说实话，我还没有注意到它发生在山狮。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T15:12:52.690

胡马云可能是对的-

但是，您不应该将 cookie 写入 NSUserDefaults -

sharedHTTPCookieStorage 的全部意义在于您从那里读取它们。

```
NSArray *httpCookies = [[NSHTTPCookieStorage sharedHTTPCookieStorage] cookiesForURL:httpUrl]; 
```

出于安全原因，您甚至不能将这些 cookie 写入 NSUserDefaults。但也许你可以。无论哪种方式，超时都可能没有像humayun提到的那样设置。

无论哪种方式，请重构您的代码，不要尝试将 cookie 存储在用户首选项中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-02T14:12:36.353

解决了 ！

经过一些简单的调试后，我发现问题出在我在`cookiesForURL:`. 我只是开始使用`cookies`属性，现在它工作正常。

# xml - 在 Magento 中，一个新的主题，新的页面布局，页眉和页脚工作，但不是背景。为什么？

> ID：11570739
> 
> 赞同：0
> 
> 时间：2012-07-19T23:22:21.403
> 
> 标签：xml, templates, magento, layout, php

我对此完全陌生，我只是无法弄清楚。这是代码：

页面.xml

```
<layout version="0.1.0">
    <default translate="label" module="page">
        <label>All Pages</label>
        <block type="page/html" name="root" output="toHtml" template="page/pd-1column.phtml">

            <!-- Add Styles to Head -->
            <block type="page/html_head" name="head" as="head">
                <action method="addCss"><stylesheet>css/style.css</stylesheet></action>
            </block>

            <!-- Our Header -->
            <block type="page/html_header" name="header" as="header" translate="label">
                <label>Header</label>
            </block>

            <!-- Background -->
            <block type="page/html_background" name="background" as="background" translate="label">
                <label>Background</label>
            </block>

            <!-- The Footer -->
            <block type="page/html_footer" name="footer" as="footer" template="page/html/footer.phtml">
                <label>Footer</label>
            </block>
        </block>
    </default>
</layout> 
```

pd-1column.phtml

```
<!DOCTYPE html>
<head>
    <?php echo $this->getChildHtml('head'); ?>
</head>
<body>
    <div id="wrapper">
            <?php echo $this->getChildHtml('header'); ?>      
            <?php echo $this->getChildHtml('background'); ?>      
            <?php echo $this->getChildHtml('footer'); ?>
    </div>
</body>
</html> 
```

文件名：header.phtml、background.phtml、footer.phtml

我究竟做错了什么？

编辑：解决方案是将 page.xml 文件修改为

```
<block type="page/html_header" name="background" as="background" template="page/html/background.phtml">
            <label>Background</label>
 </block> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T01:39:36.457

```
 <block type="page/html_header" name="header" as="header" translate="label"> 
```

此`page/html_header`类型对应于存在于的块类文件

```
app/code/core/Mage/Page/Block/Html/Header.php 
```

这是 Magento 的核心块类。每个块类型都指向一个特定的类文件。所以你的头模板可以访问所有这些方法`Header.php`

同样`Background.php`块不存在于路径中`app/code/core/Mage/Page/Block/Html/`

块在[这里更好地解释](https://stackoverflow.com/questions/4287226/what-block-type-for-left-column-in-magento-theme)

# java - 如何以编程方式换出 Android 中的视图控件？

> ID：11570741
> 
> 赞同：0
> 
> 时间：2012-07-19T23:22:42.247
> 
> 标签：java, android, android-layout, android-view, android-xml

我有以下 XML 布局驱动我的 UI：

```
<TableLayout
    android:id="@+id/tableLayout1"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:stretchColumns="1"
    android:layout_margin="10dp" >

    <TableRow
        android:id="@+id/tableRow1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" >

        <TextView
            android:id="@+id/textView1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Username:" />

        <EditText
            android:id="@+id/txtUsername"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:ems="10"
            android:inputType="textPersonName" >

        </EditText>

    </TableRow>

       <!-- more rows are here -->

</TableLayout> 
```

我想在我的应用程序的另一部分重用这个布局，但在一个地方稍微改变一些东西。我希望将`EditText` `txtUsername`其更改为`TextView`, 在同一位置和所有内容中。所以基本上我在代码中将 EditText 换成了 TextView。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T23:29:49.377

如果这是您需要的唯一更改，我会通过将 TextView 添加到您的布局中（默认为 View.GONE）并在适当的地方使用 View.setVisibility(View.VISIBLE) 和 View.setVisibility(View.GONE) 来交换它们.

```
<TableRow
    android:id="@+id/tableRow1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" >

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Username:" />

    <EditText
        android:id="@+id/txtUsername"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:ems="10"
        android:inputType="textPersonName" >

    </EditText>
    <TextView
        android:id="@+id/txtUsernameTV"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:ems="10"
        android:inputType="textPersonName" 
        android:visibility="gone">

    </TextView>
</TableRow> 
```

然后在你的java中你可以保留你已经拥有的活动，在新的活动中（你想要TextView的地方）做这样的事情：

```
editTextReference.setVisibility(View.GONE);
textViewReference.setVisibility(View.VISIBLE); 
```

请注意，两个视图的 id 需要不同的值。

# c++ - Boost Preprocessor - 将 BOOST_PP_ENUM_PARAMS 传递给静态 const int？

> ID：11570746
> 
> 赞同：0
> 
> 时间：2012-07-19T23:23:16.397
> 
> 标签：c++, boost, boost-preprocessor

我想要这样的东西：

```
class MyClass
{
    public:
       static const int n = some_traits_class<SomeClass>::value;

       template <BOOST_PP_ENUM_PARAMS(MyClass::n, typename P)>
       void operator()( BOOST_PP_ENUM_BINARY_PARAMS(MyClass::n, const P, & p) )
       {
          ....
       }
} 
```

编译器似乎不喜欢这样 - 是否有某种修复可以到达我想要的位置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T23:29:38.193

不，第一个参数`BOOST_PP_ENUM_PARAMS`必须是一个整数：一个实际的整数标记或扩展为一个的宏的名称。

宏替换发生在编译器开始解析代码和评估整数常量表达式之前很久（在预处理期间评估的唯一常量表达式是出现在`#if`or`#elif`指令中的那些，它们具有可以使用的一组受限操作）。

# java - Java opc 客户端应用程序

> ID：11570753
> 
> 赞同：12
> 
> 时间：2012-07-19T23:24:13.093
> 
> 标签：java, opc

我正在寻找一些库和一些示例来创建可以与 opc 服务器连接的 Java 客户端 OPC 应用程序。提前致谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-19T23:30:41.527

您是否检查[过使用 Java 进行 OPC 客户端编程](http://www.opcconnect.com/java.php#javacom)？

他们为此区域提供了不同的链接：

*   **Utgard - 纯 Java OPC 库**

> [Utgard](http://openscada.org/projects/utgard/)是一个开源项目，提供一个用纯原生Java 编写的OPC 库，即不依赖于JNI 或其他DLL。它是根据 GPL 许可的。

*   **JEasyOPC 客户端**

> Antonín Fischer 的[Java OPC 客户端](https://sourceforge.net/projects/jeasyopc)现在得到了极大的增强并托管在 SourceForge 上。它使用一个用 Delphi 编码的 JNI 层。提供了完整的源代码（Java 和 Delphi）。

我认为您正在寻找的是**Utgard**，您可以在文档部分中找到**示例代码**，分别在文档下的项目源代码中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-30T08:20:44.923

你有两个选择：

1.  按照 platzhirsch 的建议，选择传统的 OPC DCOM。DCOM 需要 JNI，并且只能在 Windows 环境中工作。

2.  选择 OPC UA（统一架构），这是 OPC 的新版本。OPC UA 在纯 Java 中可用，并且在所有 Java SE 6 环境中可用。OPC UA 包含许多高级功能，例如内置安全性、信息建模等。

OPC UA 为您提供更好的未来证明，因为 OPC UA 是目前所有开发的地方。您还可以借助包装器（例如[UaGateway ）从 OPC UA 客户端连接到 OPC DCOM 服务器](http://www.unified-automation.com/uagateway.htm)

对于 OPC UA，我可以建议[Prosys OPC UA Java SDK](http://www.prosysopc.com/opc-ua-java-sdk.php)，它是目前 Java 最先进的选项（商业，是的，我自己也参与其中）。

[您可以从此处](https://opcfoundation.org/about/what-is-opc/)阅读有关 OPC UA 的更多信息

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-16T22:18:31.507

以下是 GitHub 上的一些开源 UPC UA 实现：

*   [https://github.com/digitalpetri/ua-server-sdk](https://github.com/digitalpetri/ua-server-sdk)
*   [https://github.com/digitalpetri/opc-ua-stack](https://github.com/digitalpetri/opc-ua-stack)
*   [https://github.com/bcopy/opc-ua-stack](https://github.com/bcopy/opc-ua-stack)

它们正在出现且不完整，但如果您正在研究或制作原型，那么与功能齐全的商业图书馆相反，这是正确的开始方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-06T07:27:36.300

在 C++ 中实现 OPC API。使其成为 DCOM 对象并作为 Windows 服务运行。

您可以通过 J-Interop 或 JACOB 连接到 DCOM 对象，两者都是 JAVA-DCOM 桥。

# c# - 将 ViewModel 绑定到 ContentControl 作为其 DataContext

> ID：11570754
> 
> 赞同：7
> 
> 时间：2012-07-19T23:24:26.693
> 
> 标签：c#, wpf, mvvm

我想在按钮单击时更改 UserControls（我不会在这里复杂化，所以我只会提到重要的部分）。所以想法是将这些 UserControls 的 ViewModels 绑定到 ContentControl，然后使用 DataTemplates 将它们关联起来。这是代码：

```
<Window x:Class="Project.MainWindow">
<Window.Resources>
    <DataTemplate DataType="{x:Type UserControl:ViewUserControlViewModel}" >
        <UserControl:ViewUserControl/>
    </DataTemplate>
    <DataTemplate DataType="{x:Type UserControl:EditUserControlViewModel}" >
        <UserControl:EditUserControl/>
    </DataTemplate>
</Window.Resources>
<Grid>
    <ContentControl DataContext="{Binding UserControlViewModel}" />
    <Button Content="View" Click="ChangeToView()"/>
    <Button Content="Edit" Click="ChangeToEdit()"/>
</Grid>
</Window> 
```

视图模型：

```
public class MainWindowViewModel : DependencyObject
{
    public DependencyObject UserControlViewModel
    {
        get { return (DependencyObject)GetValue(UserControlViewModelProperty); }
        set { SetValue(UserControlViewModelProperty, value); }
    }
    public static readonly DependencyProperty UserControlViewModelProperty = 
           DependencyProperty.Register("UserControlViewModel", typeof(DependencyObject), typeof(MainWindowViewModel), new PropertyMetadata());

    public MainWindowViewModel()
    {
        UserControlViewModel = new EditUserControlViewModel();
    }
} 
```

但是有一个问题。当我开始项目时，我只看到按钮，但看不到任何用户控件。我做错了什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-19T23:59:30.790

如果您`Window.DataContext`的设置正确，`MainWindowViewModel`应该可以完成这项工作

```
<ContentControl Content="{Binding UserControlViewModel}" /> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-20T05:58:36.003

在执行 mvvm 时，您的视图模型应该实现 INotifyPropertyChanged 而不是从 DependencyObject 继承。

```
public class MainWindowViewModel : INotifyPropertyChanged
{
   private object _currentWorkspace; //instead of object type you can use a base class or interface
   public object CurrentWorkspace
   {
      get { return this._currentWorkspace; }
      set { this._currentWorkspace = value; OnPropertyChanged("CurrentWorkspace"); }
   }

   public MainWindowViewModel()
   {
      CurrentWorkspace= new EditUserControlViewModel();
   }

   //todo: to switch the workspace, create DelegeCommand/RelayCommand and set the CurrentWorkspace
   //if you don't know about these commands let me know and i post it

   public ICommand SwitchToViewCommand {get{...}}
   public ICommand SwitchToEditCommand {get{...}}
} 
```

xaml：您应该将 Content 属性设置为 CurrentWorkspace。

```
<ContentPresenter Content="{Binding UserControlViewModel}" />
<Button Content="View" Comamnd="{Binding SwitchToViewCommand}"/>
<Button Content="Edit" Comamnd="{Binding SwitchToEditCommand}"/> 
```

！不要忘记将窗口的 DataContext 设置为 MainWindowViewModel 实例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T23:38:42.633

首先，您应该发布 UserControl 的代码，因为（在上面的代码片段中）它负责显示一些数据。

其次，您没有在代码中绑定任何内容。

第三，您对 ViewModel 的实现是错误的。您不需要子类化 DependencyObject，而是实现 INotifyPropertyChanged 接口以建立能够通知您的视图的 ViewModel。

第四，我不知道你在做什么

```
<ContentControl DataContext="{Binding UserControlViewModel}" /> 
```

也许你可以进一步解释？

第五，在实现 MVVM 模式（你目前不做的）时，你应该避免使用像点击事件这样的事件，而是使用命令。

（我知道这还不是一个真正的答案，但我不想用注释语法写）

# sql - 服务器主体 Xuser 在当前安全上下文下无法访问数据库 Ydb。sql server 2008

> ID：11570763
> 
> 赞同：1
> 
> 时间：2012-07-19T23:25:19.567
> 
> 标签：sql, sql-server-2008, security

我试图弄清楚为什么我的存储过程无法从另一个数据库的列中进行选择。

数据库 Kdb 和 Ydb 具有相同的数据库所有者。使用该数据库所有者帐户创建的两个数据库中的存储过程和表。

Ydb 中有一个存储过程试图访问由最小权限用户执行的 Kdb 中的表（只有在 Ydb 上执行和连接，对 Kdb 没有权限）。

```
Use [Ydb]
GO
ALTER PROCEDURE  [dbo].[CreateSecureTableAEntry]
@fid int
AS
BEGIN
DECLARE @operatorId uniqueidentifier
DECLARE @orgName nvarchar(max)
SELECT @orgName = SUBSTRING(SYSTEM_USER,1,LEN(SYSTEM_USER)-4)
SELECT @operatorId = Id FROM Kdb.dbo.Organizations WHERE Kdb.dbo.Organizations.Name =  @orgName
INSERT INTO TableA (operatorId, sourceFid) VALUES (@operatorId, @fid);
END 
```

我在 Kdb 和 Ydb 上都启用了跨数据库链接。我让 Ydb 值得信赖。

这显然是一个权限问题，但是在保持权限尽可能严格的同时我还应该做什么呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T18:01:41.250

我通过将选择查询合并到 Ydb 内的视图中并使用以下查询在 Kdb 上启用来宾帐户成功地解决了这个问题：

```
USE [Kdb];
GO
GRANT CONNECT TO guest; 
```

# android - usb 附件的接收器处理程序出现空指针异常

> ID：11570771
> 
> 赞同：0
> 
> 时间：2012-07-19T23:26:36.977
> 
> 标签：android, crash, nullpointerexception

我是嵌入式程序员，也是安卓新手

开发板通过 USB 发送了新消息，我编写了 java 代码来接受该消息并将其显示在 android 设备上。但是应用程序崩溃了，这里是 LogCat

```
D/UsbDeviceManager(  163): entering USB accessory mode: UsbAccessory[mManufacturer=Embedded Artists AB, mModel=AOA Board - Nodes, mDescription=Demo - AOA Nodes, mVersion=1.0, mUri=http://www.embeddedartists.com/_aoa/Demo_AOA_Nodes.apk, mSerial=N/A]

I/ActivityManager(  163): START {flg=0x10000000 cmp=com.android.systemui/.usb.UsbConfirmActivity (has extras)} from pid 163

I/ActivityManager(  163): Displayed com.android.systemui/.usb.UsbConfirmActivity: +71ms

I/ActivityManager(  163): START {act=android.hardware.usb.action.USB_ACCESSORY_ATTACHED flg=0x10000000 cmp=com.embeddedartists.aoa.nodes/.MainActivity (has extras)} from pid 315

I/EA AOA CAN(30663): onResume

I/EA AOA  (30663): Receiver.run

I/EA AOA  (30663): Recv Node Add: id=144, capLen=7

I/EA AOA  (30663): Recv Node id=144, CapId= 16, data=2650

I/ActivityManager(  163): Displayed com.embeddedartists.aoa.nodes/.MainActivity: +97ms

D/OpenGLRenderer(  315): Flushing caches (mode 0)

I/EA AOA  (30663): Recv Node id=144, CapId= 32, data=227

I/EA AOA  (30663): Recv Node id=144, CapId= 48, data=0

D/OpenGLRenderer(  315): Flushing caches (mode 1)

I/EA AOA  (30663): Recv Node id=144, CapId= 32, data=245

I/EA AOA  (30663): Recv Node id=144, CapId= 96, data=245

D/AndroidRuntime(30663): Shutting down VM

W/dalvikvm(30663): threadid=1: thread exiting with uncaught exception (group=0x40a471f8)

E/AndroidRuntime(30663): FATAL EXCEPTION: main

E/AndroidRuntime(30663): java.lang.NullPointerException

E/AndroidRuntime(30663):    at com.embeddedartists.aoa.nodes.NodeView$1.handleMessage(NodeView.java:171)

E/AndroidRuntime(30663):    at android.os.Handler.dispatchMessage(Handler.java:99)

E/AndroidRuntime(30663):    at android.os.Looper.loop(Looper.java:137)

E/AndroidRuntime(30663):    at android.app.ActivityThread.main(ActivityThread.java:4424)

E/AndroidRuntime(30663):    at java.lang.reflect.Method.invokeNative(Native Method)

E/AndroidRuntime(30663):    at java.lang.reflect.Method.invoke(Method.java:511)

E/AndroidRuntime(30663):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)

E/AndroidRuntime(30663):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)

E/AndroidRuntime(30663):    at dalvik.system.NativeStart.main(Native Method)

W/ActivityManager(  163):   Force finishing activity com.embeddedartists.aoa.nodes/.MainActivity

D/dalvikvm(  163): GC_FOR_ALLOC freed 401K, 24% free 12582K/16391K, paused 54ms

W/ActivityManager(  163): Activity pause timeout for ActivityRecord{4134eaf0 com.embeddedartists.aoa.nodes/.MainActivity}

I/EA AOA  (30663): Recv Node id=144, CapId= 32, data=222

I/EA AOA  (30663): Recv Node id=144, CapId= 96, data=222

I/EA AOA  (30663): Recv Node id=144, CapId= 32, data=233

I/EA AOA  (30663): Recv Node id=144, CapId= 96, data=233

I/Process (30663): Sending signal. PID: 30663 SIG: 9

W/InputDispatcher(  163): channel '41356ab0 com.embeddedartists.aoa.nodes/com.embeddedartists.aoa.nodes.MainActivity (server)' ~ Consumer closed input channel or an error occurred.  events=0x8

E/InputDispatcher(  163): channel '41356ab0 com.embeddedartists.aoa.nodes/com.embeddedartists.aoa.nodes.MainActivity (server)' ~ Channel is unrecoverably broken and will be disposed!

W/InputDispatcher(  163): Attempted to unregister already unregistered input channel '41356ab0 com.embeddedartists.aoa.nodes/com.embeddedartists.aoa.nodes.MainActivity (server)'

I/ActivityManager(  163): Process com.embeddedartists.aoa.nodes (pid 30663) has died.

I/WindowManager(  163): WIN DEATH: Window{410e8e00 com.embeddedartists.aoa.nodes/com.embeddedartists.aoa.nodes.MainActivity paused=false}

W/ActivityManager(  163): Force removing ActivityRecord{4109b628 com.embeddedartists.aoa.nodes/.MainActivity}: app died, no saved state

I/WindowManager(  163): WIN DEATH: Window{41356ab0 com.embeddedartists.aoa.nodes/com.embeddedartists.aoa.nodes.MainActivity paused=false}

I/WindowManager(  163): WINDOW DIED Window{41356ab0 com.embeddedartists.aoa.nodes/com.embeddedartists.aoa.nodes.MainActivity paused=false}

W/InputManagerService(  163): Got RemoteException sending setActive(false) notification to pid 30663 uid 10012

D/UsbDeviceManager(  163): exited USB accessory mode

D/MtpService(25247): addStorageLocked 65537 /mnt/sdcard

D/MtpService(25247): starting MTP server in MTP mode

D/MtpService(25247): addStorageLocked 65537 /mnt/sdcard

D/dalvikvm(  315): GC_CONCURRENT freed 332K, 58% free 8215K/19271K, paused 6ms+5ms 
```

我从 LogCat 中发现，NodeView.java 中的 Handler 导致了异常。在第 171 行，它从 Node.java 调用 getValue()。您可以在下面找到这两个 java 文件。

```
case Node.DEV_ACCL_X:
val = Integer.toString(v);
break; 
```

这些是我添加到正常工作的预先存在的代码库中的行。我明白问题是什么。我看到新消息正在从 USB（开发板）的另一端正确发送我还在应用程序中看到新消息，就在它崩溃 I/EA AOA (30663) 之前：Recv Node id=144, CapId = 96，数据 = 245

那么为什么会有 NullPointerException 呢？哪位高手能指出错误吗？我在解释 LogCat 时也可能是错误的，如果是这样，请指出这一点，以便我可以分享适当的代码。

提前致谢！

#####**更新**### 完整代码

节点视图.java

```
/*****************************************************************************
 *
 *   Copyright(C) 2011, Embedded Artists AB
 *   All rights reserved.
 *
 ******************************************************************************
 * Software that is described herein is for illustrative purposes only
 * which provides customers with programming information regarding the
 * products. This software is supplied "AS IS" without any warranties.
 * Embedded Artists AB assumes no responsibility or liability for the
 * use of the software, conveys no license or title under any patent,
 * copyright, or mask work right to the product. Embedded Artists AB
 * reserves the right to make changes in the software without
 * notification. Embedded Artists AB also make no representation or
 * warranty that such application will be suitable for the specified
 * use without further testing or modification.
 *****************************************************************************/
package com.embeddedartists.aoa.nodes;

import java.util.HashMap;
import java.util.Map;

import com.embeddedartists.aoa.nodes.R;

import android.content.Context;
import android.os.Handler;
import android.os.Message;
import android.widget.ImageView;
import android.widget.LinearLayout;
import android.widget.TextView;

public class NodeView extends LinearLayout implements Node.OnValueChangeListener {

/**************************************************************************
 * Private variables 
 *************************************************************************/ 

private TextView nodeIdView;
private Node node;
private Map<Integer, TextView> values;

private static final int VALUE_UPDATED = 0;

/**************************************************************************
 * Constructor 
 *************************************************************************/ 

/**
 * Create a NodeView
 * @param context context
 * @param node node associated with this view
 */
public NodeView(Context context, Node node) {
    super(context);
    this.node = node;

    this.setOrientation(VERTICAL);      

    values = new HashMap<Integer, TextView>();
    node.addOnValueChangeListener(this);

    nodeIdView = new TextView(context);
    nodeIdView.setTextSize(24);
    nodeIdView.setText("Node: " + node.getNodeId());

    addView(nodeIdView, new LinearLayout.LayoutParams(
            LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));

    LinearLayout capLayout = new LinearLayout(context);
    capLayout.setOrientation(HORIZONTAL);
    addView(capLayout, new LinearLayout.LayoutParams(
            LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));

    int[] caps = node.getCapabilities();

    for (int i = 0; i < caps.length; i++) {
        LinearLayout vl = new LinearLayout(context);
        vl.setOrientation(HORIZONTAL);          
        vl.setMinimumWidth(110);

        ImageView iv = getImageView(context, caps[i]);
        if (iv == null) continue;
        iv.setPadding(0, 0, 10, 5);
        vl.addView(iv, new LinearLayout.LayoutParams(
                LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));

        TextView tv = new TextView(context);
        tv.setText("" + node.getValue(caps[i]));
        vl.addView(tv, new LinearLayout.LayoutParams(
                LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT));

        // Mapping capability with the TextView that holds its value.
        // A limitation with using the capability type as key is
        // that a node can only have one capability of each type
        values.put(Integer.valueOf(caps[i]), tv);   
        capLayout.addView(vl, new LinearLayout.LayoutParams(
            LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT));

    }

}

/**************************************************************************
 * Public methods 
 *************************************************************************/ 

/**
 * Get Node associated with this NodeView
 * @return
 */
public Node getNode() {
    return this.node;
}

/**
 * OnValueChangeListener
 */
public void onValueChange(int capId) {

    Message m = Message.obtain(handler, VALUE_UPDATED);
    m.arg1 = capId;
    handler.sendMessage(m);     

}   

/**************************************************************************
 * Private methods 
 *************************************************************************/ 

/**
 * Get ImageView given a capability
 * @param context
 * @param capability capability ID
 * @return ImageView
 */
private ImageView getImageView(Context context, int capability) {
    ImageView iv = null;
    switch (capability) {
    case Node.DEV_TEMP:
        iv = new ImageView(context);
        iv.setImageResource(R.drawable.temperature);
        break;
    case Node.DEV_LIGHT:
        iv = new ImageView(context);
        iv.setImageResource(R.drawable.lightbulb);          
        break;
    case Node.DEV_BTN:
        iv = new ImageView(context);
        iv.setImageResource(R.drawable.button);         
        break;

    }

    return iv;
}

private final Handler handler = new Handler() {

    @Override
    public void handleMessage(Message msg) {

        switch(msg.what) {
        case VALUE_UPDATED: 

            TextView tv = values.get(msg.arg1);
            tv.setText(node.getValue(msg.arg1));                

            break;                                      
        }
    }

};      

} 
```

节点.java

```
/*****************************************************************************
 *
 *   Copyright(C) 2011, Embedded Artists AB
 *   All rights reserved.
 *
 ******************************************************************************
 * Software that is described herein is for illustrative purposes only
 * which provides customers with programming information regarding the
 * products. This software is supplied "AS IS" without any warranties.
 * Embedded Artists AB assumes no responsibility or liability for the
 * use of the software, conveys no license or title under any patent,
 * copyright, or mask work right to the product. Embedded Artists AB
 * reserves the right to make changes in the software without
 * notification. Embedded Artists AB also make no representation or
 * warranty that such application will be suitable for the specified
 * use without further testing or modification.
 *****************************************************************************/
package com.embeddedartists.aoa.nodes;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.Map;

public class Node {

/**************************************************************************
 * Public constants 
 *************************************************************************/ 

public static final int DEV_TEMP  = (0x01 << 4);
public static final int DEV_LIGHT = (0x02 << 4);
public static final int DEV_BTN   = (0x03 << 4);
public static final int DEV_RGB   = (0x04 << 4);
public static final int DEV_LED   = (0x05 << 4);
public static final int DEV_ACCL_X   = (0x06 << 4);
//  public static final int DEV_ACCL_Y   = (0x07 << 4);
//  public static final int DEV_ACCL_Z   = (0x08 << 4);

/**************************************************************************
 * Private variables 
 *************************************************************************/ 

private int nodeId; 

private Map<Integer, Integer> values;
private int[] capabilities;
private AccessoryControl accessoryControl;

private ArrayList<OnValueChangeListener> listeners;

/**************************************************************************
 * Public interface 
 *************************************************************************/ 

public interface OnValueChangeListener {
    public void onValueChange(int capId);
}

/**************************************************************************
 * Constructor 
 *************************************************************************/ 

/**
 * Create a new Node
 * 
 * @param nodeId the unique ID of the Node
 * @param capabilites node capabilities is an array with capability IDs
 *                    DEV_TEMP, DEV_LIGHT, ...
 */
public Node (int nodeId, int[] capabilites, AccessoryControl accessoryControl) {
    this.nodeId = nodeId;
    this.capabilities = capabilites;
    this.accessoryControl = accessoryControl;

    listeners = new ArrayList<OnValueChangeListener>();

    values = new HashMap<Integer, Integer>();
    for (int i = 0; i < capabilities.length; i++) {
        values.put(Integer.valueOf(capabilites[i]), 0);         
    }
}

/**************************************************************************
 * Public methods 
 *************************************************************************/ 

/**
 * Get Node ID
 * @return the node ID
 */
public int getNodeId() {
    return nodeId;
}

/**
 * Get Node capabilities
 * @return node capabilities
 */
public int[] getCapabilities() {
    return capabilities;
}

/**
 * Add value change listener  
 * @param l listener to add
 */
public void addOnValueChangeListener(OnValueChangeListener l) {
    listeners.add(l);
}

/**
 * Remove value change listener
 * @param l listener to remove
 */
public void removeOnValueChangeListener(OnValueChangeListener l) {
    listeners.remove(l);
}   

/**
 * Update the value of a capability in this node object
 *  
 * @param capId capability ID
 * @param value value to set
 */
public void setValue(int capId, int value) {

    values.put(Integer.valueOf(capId), Integer.valueOf(value));

    for (OnValueChangeListener l : listeners) {
        l.onValueChange(capId);
    }

}

/**
 * Get the value of a specific capability
 * @param capId capability ID
 * @return the value of the capability
 */
public String getValue(int capId) {
    String val = "";
    int v = values.get(Integer.valueOf(capId));

    switch (capId) {
    case Node.DEV_TEMP:
        val = Double.toString( ((double)v)/100 );
        break;
    case Node.DEV_LIGHT:
        val = Integer.toString(v);
        break;
    case Node.DEV_BTN:
        val = Integer.toString(v);
        break;  
    case Node.DEV_ACCL_X:
        val = Integer.toString(v);
        break;
/*      case Node.DEV_ACCL_Y:
        val = Integer.toString(v);
        break;
    case Node.DEV_ACCL_Z:
        val = Integer.toString(v);
        break; */

    }

    return val;
}

/**
 * Set the RGB LED on the node. A message will be sent
 * to the attached accessory
 */
private void setRgb(int led, boolean on) {
    byte[] data = new byte[5];
    data[0] = AccessoryControl.MESSAGE_OUT_SET_VALUE;
    data[1] = (byte)this.nodeId;
    data[2] = DEV_RGB;
    data[3] = (byte)led;
    data[4] = (byte)(on ? 1 : 0);
    accessoryControl.writeCommand(data);        
}

/**
 * Set Red LED
 * @param on true if LED should be turned on
 */
public void setRedLed(boolean on) {
    setRgb(AccessoryControl.MESSAGE_RGB_VAL_RED, on);
}

/**
 * Set Blue LED
 * @param on true if LED should be turned on
 */
public void setBlueLed(boolean on) {
    setRgb(AccessoryControl.MESSAGE_RGB_VAL_BLUE, on);
}

/**
 * Set Green LED
 * @param on true if LED should be turned on
 */
public void setGreenLed(boolean on) {
    setRgb(AccessoryControl.MESSAGE_RGB_VAL_GREEN, on);
}   

/**
 * Set LED state. A message will be sent to the Accessory
 * 
 * @param on true if the LED should be turned on
 */
public void setLed(boolean on) {
    byte[] data = new byte[5];
    data[0] = AccessoryControl.MESSAGE_OUT_SET_VALUE;
    data[1] = (byte)this.nodeId;
    data[2] = DEV_LED;
    data[3] = 0;
    data[4] = (byte)(on ? 1 : 0);
    accessoryControl.writeCommand(data);
}
} 
```

AccessoryControl.java（节点正在接收器中构建）

```
/*****************************************************************************
 *
 *   Copyright(C) 2011, Embedded Artists AB
 *   All rights reserved.
 *
 ******************************************************************************
 * Software that is described herein is for illustrative purposes only
 * which provides customers with programming information regarding the
 * products. This software is supplied "AS IS" without any warranties.
 * Embedded Artists AB assumes no responsibility or liability for the
 * use of the software, conveys no license or title under any patent,
 * copyright, or mask work right to the product. Embedded Artists AB
 * reserves the right to make changes in the software without
 * notification. Embedded Artists AB also make no representation or
 * warranty that such application will be suitable for the specified
 * use without further testing or modification.
 *****************************************************************************/
package com.embeddedartists.aoa.nodes;

import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;

import android.app.PendingIntent;
import android.content.Context;
import android.content.Intent;
import android.os.ParcelFileDescriptor;
import android.util.Log;

import com.android.future.usb.UsbAccessory;
import com.android.future.usb.UsbManager;

public class AccessoryControl { 

public static final String ACTION_USB_PERMISSION = 
        "com.embeddedartists.aoa.nodes.MainActivity.action.USB_PERMISSION"; 

/*
 * Message indexes for messages sent from the Accessory
 */
public static final byte MESSAGE_IN_NODE_ADD    = 0;
public static final byte MESSAGE_IN_NODE_REMOVE = 1;    
public static final byte MESSAGE_IN_NODE_VALUE  = 2;

/*
 * Message indexes for messages sent to the Accessory
 */
public static final byte MESSAGE_OUT_SET_VALUE    = 10;

/*
 * Special messages to/from the accessory
 */

/** 
 * Sent to the accessory to indicate that the application is 
 * ready to receive data.
 */
private static final byte MESSAGE_CONNECT = 98; 
/** 
 * Sent to the accessory to indicate that the application is 
 * closing. The accessory acks the message using the same
 * ID/index.
 */
private static final byte MESSAGE_DISCONNECT = 99;

/*
 * 
 */
public static final int MESSAGE_RGB_VAL_RED = 0x01;
public static final int MESSAGE_RGB_VAL_BLUE = 0x02;
public static final int MESSAGE_RGB_VAL_GREEN = 0x04;

/** Manufacturer string expected from the Accessory */
private static final String ACC_MANUF = "Embedded Artists AB";
/** Model string expected from the Accessory */
private static final String ACC_MODEL = "AOA Board - Nodes";

/** Tag used for logging */
private static final String TAG = "EA AOA";

public enum OpenStatus {
    CONNECTED, REQUESTING_PERMISSION, UNKNOWN_ACCESSORY, NO_ACCESSORY, NO_PARCEL
}

private boolean permissionRequested = false;    
private boolean isOpen = false;
private UsbManager usbManager;
private Context context;

private ParcelFileDescriptor parcelFileDescriptor; 
private FileOutputStream accOutputStream;   
private Receiver receiver;
private NodeList nodeList;

private static AccessoryControl instance;

/**
 * Private constructor
 */
private AccessoryControl() {        
    nodeList = NodeList.getInstance();
}

/**
 * Get instance of AccecssoryControl
 * @return instance
 */
public static AccessoryControl getInstance() {
    if (instance == null) {
        instance = new AccessoryControl();
    }

    return instance;
}

/**
 * Initialize with context
 * 
 * @param context
 */
public void init(Context context) {
    this.context = context;
    usbManager = UsbManager.getInstance(context);
}

/**
 * Open the accessory and establish a connection. This method will
 * check if there is any accessory connected to the device, request
 * permissions if necessary and then establish input and output 
 * streams to/from the accessory.
 * 
 * @return status of the Open call. 
 */
public OpenStatus open() {

    if (isOpen) {
        return OpenStatus.CONNECTED;
    }

    UsbAccessory[] accList = usbManager.getAccessoryList();
    if (accList != null && accList.length > 0) {

        if (usbManager.hasPermission(accList[0])) {
            return open(accList[0]);
        }
        else if (!permissionRequested) {

            PendingIntent permissionIntent = PendingIntent.getBroadcast(
                    context, 0, new Intent(ACTION_USB_PERMISSION), 0);              

            Log.i(TAG, "Requesting USB permission");

            usbManager.requestPermission(accList[0], permissionIntent);
            permissionRequested = true;

            return OpenStatus.REQUESTING_PERMISSION;
        }
    }

    return OpenStatus.NO_ACCESSORY;
}

/**
 * Open an accessory. This method should be called if an accessory
 * object has already been obtained. The method will establish the 
 * connection and start receiver thread.
 * 
 * @param accessory an instance of UsbAccessory
 * @return status of the Open call
 */
public OpenStatus open(UsbAccessory accessory) {

    if (isOpen) {
        return OpenStatus.CONNECTED;
    }

    // check if it is a known and supported accessory 
    if (!ACC_MANUF.equals(accessory.getManufacturer()) 
            || !ACC_MODEL.equals(accessory.getModel())) {

        Log.i(TAG, "Unknown accessory: " + accessory.getManufacturer() 
                + ", " + accessory.getModel());

        return OpenStatus.UNKNOWN_ACCESSORY;
    }

    parcelFileDescriptor = usbManager.openAccessory(accessory); 
    if (parcelFileDescriptor != null) {
        byte[] data = new byte[1];

        accOutputStream = new FileOutputStream(parcelFileDescriptor.getFileDescriptor());       
        receiver = new Receiver(new FileInputStream(parcelFileDescriptor.getFileDescriptor()));

        isOpen = true;
        new Thread(receiver).start();

        // notify the accessory that we are now ready to receive data
        data[0] = MESSAGE_CONNECT;
        writeCommand(data);

        return OpenStatus.CONNECTED;
    }

    Log.i(TAG, "Couldn't get any ParcelDescriptor");
    return OpenStatus.NO_PARCEL;
}

/**
 * Close the connection with the accessory.
 */
public void close() {

    if (!isOpen) {
        return;
    }

    permissionRequested = false;
    isOpen = false;

    try {
        receiver.close();
        accOutputStream.close();
        parcelFileDescriptor.close();
    } catch (IOException ioe) {
        Log.w(TAG, "Got exception when closing", ioe);
    }
}

/**
 * Call this method when the application is closing. This method
 * will notify the accessory that the application is about to
 * be closed.
 */
public void appIsClosing() {
    byte[] data = new byte[1];
    if (!isOpen) {
        return;
    }

    Log.i(TAG, "Sending Disconnect message to accessory");
    data[0] = AccessoryControl.MESSAGE_DISCONNECT;
    writeCommand(data);
    long t = System.currentTimeMillis() + 5000;
    try {
        while (!receiver.done && System.currentTimeMillis() < t) {
            Thread.sleep(200);
        }
    } catch(InterruptedException ie) {  
    }

}

/** 
 * Write/send a command to the accessory. For simplicity all messages
 * are 3 bytes long; command index and two data bytes.
 * 
 * @param cmd - command index
 * @param hiVal - first data byte
 * @param loVal - second data byte
 */
public void writeCommand(byte[] buffer) {

    if (!isOpen) {
        return;
    }

    try {
        synchronized(accOutputStream) {
            accOutputStream.write(buffer);
        }
    } catch(IOException ioe) {      
    }

}

/*
 * The receiver thread. This Thread is responsible for reading
 * data from the Accessory and dispatching messages to the Handler
 * (UI thread)
 */

private class Receiver implements Runnable  {

    private FileInputStream inputStream;
    private boolean done = false;

    Receiver(FileInputStream inputStream) {
        this.inputStream = inputStream;
    }

    public void run() {

        int msgLen = 0;
        int numRead = 0;
        int pos = 0;
        byte[] buffer = new byte[16384];

        Log.i(TAG, "Receiver.run");

        try {

            while(!done) {
                numRead = inputStream.read(buffer);
                pos = 0;

                while(pos < numRead) {
                    int len = numRead - pos;

                    switch(buffer[pos]) {

                    case AccessoryControl.MESSAGE_IN_NODE_ADD:

                        msgLen = 3;
                        if (len >= 3) {

                            int nodeId = (int) (buffer[pos+1] & 0xff);
                            int capLen = (int) (buffer[pos+2] & 0xff);

                            Log.i(TAG, "Recv Node Add: id="+nodeId+", capLen="+capLen);

                            msgLen += capLen;
                            int[] caps = new int[capLen];
                            int maxLen = caps.length;
                            if (maxLen > len-3) {
                                maxLen = len-3;
                            }
                            for (int i = 0; i < maxLen; i++) {
                                caps[i] = (int) (buffer[pos+3+i] & 0xff);
                            }

                            Node n = new Node(nodeId, caps, AccessoryControl.this);
                            nodeList.addNode(n);
                        }
                        pos += msgLen;
                        break;
                    case AccessoryControl.MESSAGE_IN_NODE_REMOVE:

                        Log.i(TAG, "Recv Node Remove: id="+(buffer[pos+1] & 0xff));

                        if (len >= 2) {
                            nodeList.removeNode((int) (buffer[pos+1] & 0xff));
                        }
                        pos += 2;
                        break;              

                    case AccessoryControl.MESSAGE_IN_NODE_VALUE:
                        if (len >= 5) {
                            int nodeId = (int) (buffer[pos+1] & 0xff);
                            int capId = (int) (buffer[pos+2] & 0xff);

                            Node n = nodeList.getNodeWithId(nodeId);
                            if (n != null) {
                                Log.i(TAG, "Recv Node id="+nodeId+", CapId= "+capId+", data="+toInt(buffer[pos + 3], buffer[pos + 4]));
                                n.setValue(capId, toInt(buffer[pos + 3], buffer[pos + 4]));
                            }
                        }
                        pos += 5;
                        break;              

                    case AccessoryControl.MESSAGE_DISCONNECT:

                        Log.i(TAG, "Received Disconnect (ACK) message from accessory");

                        // We want to make sure the Receive thread ends at this point
                        // and doesn't start reading data
                        done = true;
                        pos = numRead;
                        break;              

                    default:
                        // invalid message (or out of sync)

                        Log.w(TAG, "Unknown command: " + buffer[pos]);
                        pos += len;
                        break;
                    }

                }

            }

        } catch (IOException ioe) {
        }

    }

    /**
     * Close the receiver thread.
     */
    public void close() {
        done = true;

        try {
            inputStream.close();
        } catch(IOException ioe) {              
        }
    }

    /** Convert two bytes to an integer */
    private int toInt(byte hi, byte lo) {
        return (( (int)(hi&0xff) << 8) | (int)(lo&0xff));
    }

};
} 
```

MainActivity.java（这是主文件） [http://pastie.org/private/ga1skp82s3b1eeslluenw](http://pastie.org/private/ga1skp82s3b1eeslluenw)

NodeActivity.java （另一个已从原始代码库编辑的文件） [http://pastie.org/private/cgcuizhdtnhg7tgsg5zcg](http://pastie.org/private/cgcuizhdtnhg7tgsg5zcg)

还有两个 java 文件，我很确定错误不是由这些文件引起的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T23:58:59.730

我看不到`new Node(int nodeId, int[] capabilites, AccessoryControl accessoryControl);`任何地方，我认为您需要先构造它，然后才能从值中获取任何东西，因为其中没有值。

# css - CSS 中的灵活布局，如 vBulletin

> ID：11570778
> 
> 赞同：0
> 
> 时间：2012-07-19T23:27:18.377
> 
> 标签：css

当您调整[vBulletin](https://www.vbulletin.com/forum/forum.php)的大小时，您可以看到 3 列很好地重新缩放（Board Name、Threads / Posts、Last Post）。

你怎么能在 CSS 中实现这样的目标？当我尝试这样做时，它总是相互重叠。.board-icon 宽度需要保持不变，因为里面有一个图像。

这是我的 CSS

```
.board-icon {
float: left;
width: 55px;
}

.board-title {
float: left;
background: red;
width: 50%;
}

.board-info {
float: left;
background: green;
width: 120px;
}

.board-lastpost {
float: left;
background: orange;
width: 240px;
} 
```

以下是使用相同灵活布局的其他示例：

*   [http://punbb.informer.com/forums/](http://punbb.informer.com/forums/)
*   [http://www.simplemachines.org/community/index.php](http://www.simplemachines.org/community/index.php)
*   [http://community.invisionpower.com/](http://community.invisionpower.com/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T00:18:43.470

它背后的 CSS 对于现代浏览器来说并不复杂。尽管这些技术中的一些在不进行一些修改的情况下无法在早期版本的 ie 中工作。

使用这个 HTML

```
<body>

    <div id="canvas">

        ...

    </div>

</body> 
```

而这个 CSS

```
body {
    margin:0;
    padding:0;
    position:relative;
}

#canvas, .main-width {
    min-width:960px;
    width: 80%;
    margin:0 auto;
}

.clear, #canvas:after {
    clear: both;
    height: 0;
    visibility: hidden;

#canvas:after {
    content: ".";
    display: block;
} 
```

开始使用 % 宽度，而不是示例中的 px 宽度。唯一使用固定宽度值的时间应该是最小宽度声明。

例如，您可以在画布 div 中创建两个流体列

```
<div class="col1>

    ...

</div>

<div class="col2">

    ...

</div>

<br class="clear" /> 
```

和 CSS（现在不需要最小宽度，因为 960px 的 34% 也一样好）

```
.col1,.col2 {
    float:left;

}

.col1 {
    width:34%;
}

.col2 {
    width:66%;
} 
```

注意到`.main-width`上面的声明了吗？这`#canvas`会将样式应用于#canvas div 中的任何容器，使其具有完全相同的宽度和流动性。

```
<div class="main-width"> ... </div> 
```

这应该让你走上正确的轨道，只要记住你需要在 % 而不是 px 中工作。如果您需要在元素上使用边框，请确保它们`display:block`以 % 宽度保持定位。

# java - 单元测试 REST 客户端——模拟服务

> ID：11570779
> 
> 赞同：3
> 
> 时间：2012-07-19T23:27:25.007
> 
> 标签：java, spring, spring-mvc

`REST`当响应状态指示错误时，我正在尝试测试客户端功能。所以我想模拟其余服务以返回错误代码（如 404）并测试客户端是否正确处理错误情况。有没有办法模拟服务？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T01:26:44.630

试试[Mockito](http://code.google.com/p/mockito/)

这是一个很好的 Java 模拟框架

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T01:48:58.817

尝试使用[Spring MVC 测试支持](https://github.com/SpringSource/spring-test-mvc)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T00:09:03.040

mockito 是单元测试的不错选择。如果您对自动化集成测试感兴趣，您可能想尝试一些 web 服务模拟工具，例如这个： [https ://sourceforge.net/p/soaprest-mocker](https://sourceforge.net/p/soaprest-mocker)

您可以在模拟上设置响应代码和/或响应正文，针对模拟执行您的请求并验证到达模拟的请求。

# clojure - 为什么clojure的向量函数定义这么冗长？

> ID：11570782
> 
> 赞同：7
> 
> 时间：2012-07-19T23:28:10.783
> 
> 标签：clojure

我真的很好奇为什么vector的实现如此冗长？它不能做的原因是什么`[]`，`[a]`和`[a & args]`？

这是我从中得到的`clj-1.4.0`。

```
=> (source vector)
(defn vector
  "Creates a new vector containing the args."
  {:added "1.0"
   :static true}
  ([] [])
  ([a] [a])
  ([a b] [a b])
  ([a b c] [a b c])
  ([a b c d] [a b c d])
  ([a b c d & args]
     (. clojure.lang.LazilyPersistentVector (create (cons a (cons b (cons c (cons d args))))))))
nil 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-19T23:40:48.703

前几个案例直接调用以使它们更快，因为它们是最常调用的。使用许多参数调用它的罕见情况可能需要更多调用，因此需要更多时间，但这使常见情况保持简洁。**这是一种刻意的速度和冗长的权衡**。通过查看参数列表，它还可以清楚地使用该函数，而不会使人们的 IDE 与大量的 arities 列表混淆。

Clojure 的大部分核心函数都有类似的签名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-04T08:06:03.573

除了[@ArthurUlfeldt 的解决方案](https://stackoverflow.com/a/11570880/1562315)。

有一个核心功能的*参考实现*的案例，比如在 namespace `clojure.core.reference`。这些会更短，因此更清晰，尽管比标准对应物慢。测试制度将确保它们产生相同的结果。

例如，参考实现`vector`可能是

```
(ns clojure.core.reference)

(defn vector
  "Creates a new vector containing the args."
  {:added "1.0"
   :static true}
  [& args]
  (. clojure.lang.LazilyPersistentVector (create args))) 
```

除了测试核心库采用的各种优化和加速之外，参考实现将是那些试图理解代码功能的人的首选。

# .htaccess - htaccess 隐藏扩展不允许 ExpressionEngine 登录

> ID：11570783
> 
> 赞同：1
> 
> 时间：2012-07-19T23:28:14.070
> 
> 标签：.htaccess, redirect, expressionengine

说了这么多，但是在我的 .htaccess 中使用它

```
 Options +FollowSymLinks -MultiViews

    # Turn mod_rewrite on
    RewriteEngine On
    RewriteBase /

    ## removes index.php
    # Add/Hide index.php from everything except admin
    RewriteCond $1 !\.(gif|jpe?g|png)$ [NC]
    RewriteCond $1 !admin$ [NC]
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ /index.php?$1 [L]

    ## hide .php extension
    # To externally redirect foo.php to foo
    RewriteCond %{THE_REQUEST} ^[A-Z]{3,}\s([^.]+)\.php [NC]
    RewriteRule ^ %1 [R,L,NC]

    ## To internally redirect /dir/foo to /dir/foo.php
    RewriteCond %{REQUEST_FILENAME}.php -f
    RewriteRule ^ %{REQUEST_URI}.php [L] 
```

将允许我使用 /admin 作为 url，但不允许我登录，

如果我删除这一行`RewriteCond $1 !admin$ [NC]`，它会将 index.php 附加到 /admin 上，使其成为 index.php/admin 并且我看不到该页面

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T20:29:20.407

你想达到什么目的？只是删除 index.php？如果是这样，这个 .htaccess 有效：

```
重写引擎开启
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
重写规则 ^(.*)$ /index.php/$1 [L]

```

然后你当然必须访问 /admin.php，或者如果你愿意，你可以把它放在一个名为 /admin 的目录中。

# c# - 重写 Visual Studio 对组件派生类的处理

> ID：11570784
> 
> 赞同：3
> 
> 时间：2012-07-19T23:28:16.897
> 
> 标签：c#, .net, visual-studio, system.componentmodel

有什么方法可以告诉 Visual Studio 我想将我的类视为普通类而不是组件？我的班级是这样声明的：

```
public class WebDavClient : WebClient
{
} 
```

我想，因为`WebClient`派生自`System.ComponentModel.Component`，所以 Visual Studio 假定它是一个组件。因此，双击解决方案资源管理器中的文件会显示设计器界面而不是代码。此外，如果我在上面的声明之前添加另一个类，在解决方案资源管理器中双击文件会给我一个“可以设计类 WebDavClient，但不是文件中的第一个类”错误。

在所有情况下，我只想将这个类视为普通类，并且永远不需要设计器表面。有没有办法覆盖 Visual Studio 的默认行为？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T23:35:29.917

尝试添加此属性：

```
[System.ComponentModel.DesignerCategory("")]
public class WebDavClient : WebClient
{
} 
```

[http://msdn.microsoft.com/en-us/library/system.componentmodel.designercategoryattribute.aspx](http://msdn.microsoft.com/en-us/library/system.componentmodel.designercategoryattribute.aspx)

# python - tkinter 树视图 - 拖放？

> ID：11570786
> 
> 赞同：4
> 
> 时间：2012-07-19T23:28:20.450
> 
> 标签：python, tkinter

我可以看到如何在树中剪切和粘贴节点，或者使用按钮或键绑定上下移动它们。有没有办法在树视图周围实现拖放节点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-13T01:40:15.680

这是一些处理左键单击和 shift-left-click 的工作示例代码：

```
import Tkinter as tk
import ttk

def bDown_Shift(event):
    tv = event.widget
    select = [tv.index(s) for s in tv.selection()]
    select.append(tv.index(tv.identify_row(event.y)))
    select.sort()
    for i in range(select[0],select[-1]+1,1):
        tv.selection_add(tv.get_children()[i])

def bDown(event):
    tv = event.widget
    if tv.identify_row(event.y) not in tv.selection():
        tv.selection_set(tv.identify_row(event.y))    

def bUp(event):
    tv = event.widget
    if tv.identify_row(event.y) in tv.selection():
        tv.selection_set(tv.identify_row(event.y))    

def bUp_Shift(event):
    pass

def bMove(event):
    tv = event.widget
    moveto = tv.index(tv.identify_row(event.y))    
    for s in tv.selection():
        tv.move(s, '', moveto)

root = tk.Tk()

tree = ttk.Treeview(columns=("col1","col2"), 
                    displaycolumns="col2", 
                    selectmode='none')

# insert some items into the tree
for i in range(10):
    tree.insert('', 'end',iid='line%i' % i, text='line:%s' % i, values=('', i))

tree.grid()
tree.bind("<ButtonPress-1>",bDown)
tree.bind("<ButtonRelease-1>",bUp, add='+')
tree.bind("<B1-Motion>",bMove, add='+')
tree.bind("<Shift-ButtonPress-1>",bDown_Shift, add='+')
tree.bind("<Shift-ButtonRelease-1>",bUp_Shift, add='+')

root.mainloop() 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-20T13:53:18.240

您必须自己进行设置，但这绝对是可能的。您只需要为`<ButtonPress-1>`（识别要拖动的项目）、`<ButtonRelease-1>`（实现拖放）和`<B1-Motion>`（在拖动过程中提供反馈）进行适当的绑定

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-01-11T19:45:35.903

无法对解决方案发表评论，因此在此处添加了我的 50c：要解决通过多级树上下拖动的问题，您需要在移动时指定父 ID，如下所示：

tv.move(s, tv.identify_row(event.y), moveto)

这可能对某人有用...

# vb.net - 广泛使用全局变量对项目进行多实例化

> ID：11570787
> 
> 赞同：0
> 
> 时间：2012-07-19T23:28:30.080
> 
> 标签：vb.net, global-variables

我们有一个用 Visual Basic .NET 开发的相当健壮的程序，并且我们创建了一个 API，它基本上将整个程序表示为单个对象。这工作得很好，我们已经使用它多年了——但现在出现了一个项目，我们真的可以使用它的多个实例。

问题是代码库对启动模块中的全局变量 (gSvcMgr) 有广泛的引用。如何使该对象的多个实例引用不同的变量？我可以使用命名空间吗？还是阴影关键字？

如果我不清楚，或者具体细节可能会有所帮助，我可以进一步描述结构。

虽然重构全局变量是唯一的选择，但我们有一个非常大的代码库，而且只有少数开发人员。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T01:58:25.693

您可以使用[AppDomain.CreateInstanceAndUnWrap](http://msdn.microsoft.com/en-us/library/3c4f1xde.aspx)在单独的[应用程序域中](http://msdn.microsoft.com/en-us/library/cxk374d9.aspx)创建应用程序对象的每个实例。这将为选项的每个实例创建一个不同的域，该域将拥有自己的共享全局数据副本并且不会相互接触。

然而，使用应用程序域会带来性能成本 - 所有方法调用都将在应用程序域之间[编组](http://en.wikipedia.org/wiki/Marshalling_%28computer_science%29)（读取复制）。您还必须从[MashalByRefObject](http://msdn.microsoft.com/en-us/library/system.marshalbyrefobject.aspx)派生您的应用程序对象。

有关使用应用程序域解决与您的问题类似的问题的示例，请参阅此[博客文章。](http://www.wintellect.com/cs/blogs/jeffreyr/archive/2010/09/01/using-appdomains-to-make-non-threadsafe-code-threadsafe.aspx)

# synchronization - cuda 线程栅栏

> ID：11570789
> 
> 赞同：4
> 
> 时间：2012-07-19T23:29:13.387
> 
> 标签：synchronization, cuda, gpgpu

我正在编写一个必须执行块间同步（N 维和其他内存传输操作的总和）的代码。当我增加问题的维度时，结果是错误的。

我正在与`__threadfence()`第一个维度（N<192）进行同步，这没关系，但是如果我`__threadfence()`在代码段中插入其他维度，则结果对于更多维度是正确的。

一个`threadfence()`还不够同步？此外，数据结果在同一块中使用。

在编程指南中，信息表明`threadfence`等待所有内存空间都准备好（共享和全局）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-20T16:12:34.183

没有很好的方法来执行块之间的同步。您可以采用一种 hacky 方法来等待自旋并占用您的 GPU 内存带宽，或者您可以终止您的内核并启动一个新内核。

`__threadfence()`*不适*用于块之间的同步。`__threadfence()`用于暂停当前线程，直到所有先前对共享内存和全局内存的写入都被其他线程可见。它不会停止也不会影响其他线程的位置！

您可以检查以下问题：

*   [cuda 块同步](https://stackoverflow.com/questions/6404992/cuda-block-synchronization)
*   [CUDA __threadfence()](https://stackoverflow.com/questions/5232689/cuda-threadfence/5233737#5233737)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-09-14T06:04:57.743

合作组将允许同一内核中不同块之间的同步。它现在也很容易使用。

```
#include <cooperative_groups.h>
namespace cg = cooperative_groups;

// and then in your code
cg::grid_group grid = cg::this_grid();
grid.sync(); // All threads in all blocks must run this line 
```

整个内核中每个块中的每个线程都必须运行它`grid.sync()`。只有在所有线程都运行了下一行之后，才会继续执行下一行。

[https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#cooperative-groups](https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#cooperative-groups)

# java - 将字符串分配给字节并在 Java 的开头指定字符串长度

> ID：11570790
> 
> 赞同：0
> 
> 时间：2012-07-19T23:29:16.897
> 
> 标签：java, bytearray, byte

我想为 分配一个`String`数据，`byte array`并在开头放置一个 4 字节的字符串数据长度。实现的最佳方法是什么？我需要这个来通过套接字连接传输字节数据。服务器端读取开头提到的尽可能多的字节。

有没有更好的方法来做到这一点？

```
private byte[] getDataSendBytes(String data) {
    int numberOfDataBytes = data.getBytes().length;

    ByteBuffer bb = ByteBuffer.allocate(HEADER_LENGTH_BYTES);
    bb.putInt(numberOfDataBytes);
    byte[] headerBytes = bb.array();
    byte[] dataBytes = data.getBytes();

    // create a Datagram packet
    byte[] sendDataBytes = new byte[HEADER_LENGTH_BYTES + dataBytes.length];

    System.arraycopy(headerBytes, 0, sendDataBytes, 0, headerBytes.length);
    System.arraycopy(dataBytes, 0, sendDataBytes, headerBytes.length,
            dataBytes.length);
    return sendDataBytes;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T07:07:00.927

我会使用 DataOutputStream

```
public byte[] getDataSendBytes(String text) {
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    try {
        new DataOutputStream(baos).writeUTF(text);
    } catch (IOException e) {
        throw new AssertionError(e);
    }
    return baos.toByteArray();
} 
```

或 ByteBuffer 用于控制长度类型和字节序。

```
public byte[] getDataSendBytes(String text) {
    try {
        byte[] bytes = text.getBytes("UTF-8");
        ByteBuffer bb = ByteBuffer.allocate(4 + bytes.length).order(ByteOrder.LITTLE_ENDIAN);
        bb.putInt(bytes.length);
        bb.put(bytes);
        return bb.array();
    } catch (UnsupportedEncodingException e) {
        throw new AssertionError(e);
    }
} 
```

或为了性能，重用 ByteBuffer 并假设 ISO-8859-1 字符编码

```
// GC-less method.
public void writeAsciiText(ByteBuffer bb, String text) {
    assert text.length() < (1 << 16);
    bb.putShort((short) text.length());
    for(int i=0;i<text.length();i++)
        bb.put((byte) text.charAt(i));
} 
```

# postgresql - postgreSQL - 作为时间类型返回间隔

> ID：11570791
> 
> 赞同：0
> 
> 时间：2012-07-19T23:29:24.023
> 
> 标签：postgresql, plpgsql, intervals

在我们的表格中，人们将通过首先指定一个类别（分钟、小时、天、月、年）然后输入一个整数值来输入年龄。这种做法的问题是年龄变得不一致——18个月大于1年，这使得统计分析变得困难。

在内部，我需要将此数据存储为不是两个整数（因为它当前存储），而是作为一个间隔和一个整数。第二个整数表示原始单位。

这是一个问题：告诉 postgreSQL 将此间隔返回为输入时间的简单方法是什么？例如，用户输入：18 个月。现在，它将以 1 年 6 个月的形式返回。-- 无法在表单上重新显示。我根据另一个整数知道他们输入的内容，所以不会有小数部分 - 即如果他们在几天内输入，就不会有小时等。

理想情况下，它会像

```
SELECT as_time((person.age).value,'months') 
```

请注意，这些间隔按原样输入，因此月份不会是 30 天间隔“月份”（代表月份）以外的任何内容。如果需要，我可以使用 plpgsql 函数，因为我需要查找时间类型代码；但在所有情况下的严格要求是，如果他们输入了某个时间，他们就会准确地回到那个时间，没有四舍五入，没有“更正”等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T02:21:17.780

```
WITH x(unit, t) AS (
    VALUES
     (1, interval '1 month')
    ,(1, interval '2 month')
    ,(1, interval '3 month')
    ,(1, interval '12 month')
    ,(1, interval '13 month')
    ,(1, interval '18 month')
    ,(1, interval '24 month')
    ,(1, interval '30 month')
    ,(1, interval '300 month')
    ,(2, interval '1 year')
    ,(2, interval '2 year')
    ,(2, interval '5 year')
    ,(2, interval '100 year')
    )
SELECT CASE unit
         WHEN 1 THEN **EXTRACT(year FROM t)::int * 12
                 + EXTRACT(month FROM t)::int** 
         WHEN 2 THEN **EXTRACT(year FROM t)::int**
         ELSE -1 -- should not occour
         END AS units
      ,CASE unit
         WHEN 1 THEN 'months'
         WHEN 2 THEN 'years'
         ELSE 'unknown' -- should not occour
       END as unit
FROM   x; 
```

[手册中的 EXTRACT()。](http://www.postgresql.org/docs/current/interactive/functions-datetime.html#FUNCTIONS-DATETIME-EXTRACT)

您可以尝试提取`epoch`值（秒数）并将其转换 - 就像@Magnus[在这里](https://stackoverflow.com/q/952493/939860)演示的那样，但是月份和年份对于月份的不规则性质是合理的，因此计算会以更大的间隔关闭。

# javascript - 将 DIV 元素绑定到溢出滚动条

> ID：11570794
> 
> 赞同：0
> 
> 时间：2012-07-19T23:29:34.963
> 
> 标签：javascript, jquery, css, html-table

我正在尝试创建一个允许我修复标题的数据网格表。我已将表格放在两个 DIV 元素中，并修复了表格的 THEAD 部分。我动态填充表格，可以有不同数量的列，并且每次可能有不同的宽度。

```
<DIV style="position: relative; width="500px">
 <DIV style="height:105px; overflow: auto;">
  <TABLE width="502px">
    <THEAD>
      <TR style="left:-1px;top: 0;position: absolute;">
        ... header content ...
      </TR>
    </THEAD>
    <TBODY>
      ... data columns ...
    </TBODY>
  </TABLE>
 </DIV>
</DIV> 
```

该解决方案适用于垂直溢出。但是，我正在与水平溢出作斗争。因为我修复了 THEADs TR 元素，所以如果我的表格超过了 DIV 宽度，就会出现水平滚动条，我可以水平滚动数据，但标题是静态的，不会滚动。

我在想，如果我可以获得动态创建的滚动条的 ID/名称，我可能能够以某种方式使用 jQuery 滚动表头，但我不知道这是否是正确的解决方案，或者它是否可能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T23:41:50.630

很多人尝试使用 html 和 css 为表格制作固定的标题和左列，在滚动时保持不变，不幸的是它不起作用。

您唯一的选择是使用 javascript 在表格滚动时对其进行操作。我没有要推荐的具体代码，但做一些谷歌搜索。

# java - 右键单击 setIcon() 标记炸弹 - 扫雷

> ID：11570796
> 
> 赞同：1
> 
> 时间：2012-07-19T23:29:40.730
> 
> 标签：java, swing, mouselistener, minesweeper, jtogglebutton

我对编程很陌生，正在尝试制作扫雷 GUI。游戏运行完美，右键单击 JToggleButton 在按钮上显示“B”代表炸弹，但是当我在 mouselistener 中将 setText() 替换为 setIcon() 时，它会在左右单击时显示图标。我在 setText() 时没有这个问题。

```
 public void mousePressed(MouseEvent e){
        if(e.isMetaDown())
            if(btnPresses == 0)
            {
                startTime = System.currentTimeMillis();
                btnPresses++;
            }
            //if(btn[y][x].getText().equals("B"))
            if(btn[y][x].getIcon()==flag)
            {
                //btn[y][x].setText("");
                btn[y][x].setIcon(null);
                if(bombs[y][x]!=BOMB)
                    markers++;
            }
            else
            {
                //btn[y][x].setText("B");
                btn[y][x].setIcon(flag);
                if(bombs[y][x]==BOMB)
                    markers++;
                else
                    markers--;
            } 
```

我在 actionlistener 中添加了一个 btn[y][x].setIcon(null)，这会导致标志图标在左键单击时仅短暂出现，但我宁愿它根本不出现。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T01:20:25.600

您需要区分鼠标左键单击 MouseEvent.BUTTON3 和鼠标右键单击 MouseEvent.BUTTON3，然后采取相应措施。例如，当我做这样的事情时，我通过以下方式在我的模型中设置“标志”布尔值（使用 MVC）：

```
@Override
public void mousePressed(MouseEvent e) {
   if (e.getButton() == MouseEvent.BUTTON3) {
      model.upDateButtonFlag();
   }
} 
```

MouseListener 应该只用于设置或取消设置标志。否则，您应该让您的 JButton 通过其 ActionListener 响应左键单击。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T01:00:36.353

`System.err.println("" + System.currentTimeMillis() + " " + e);`在处理程序的开头添加一个。我强烈怀疑您的代码被调用的次数比您想象的要多 - 因为单击一次可以生成多个事件。一旦你知道发生了什么，它应该很容易修复。

# javascript - 我可以在 javascript 图像轮播加载 36 张图像时显示加载指示器吗？

> ID：11570799
> 
> 赞同：0
> 
> 时间：2012-07-19T23:30:00.250
> 
> 标签：javascript, html, css, carousel, nivo-slider

我正在使用 Nivo Slider [Nivo Slider](http://nivo.dev7studios.com/)作为图像轮播。但是，我需要嵌入一个 powerpoint 演示文稿，因此我将所有幻灯片转换为 JPG 图像，总计约 3.5 MB。现在加载所有图像需要一段时间。但是在加载时，包含的 div 区域完全是空的，并显示了页面背景。

我的问题是我是否可以在加载所有 36 张图像时显示某种加载指示器。另一个可能的选择是延迟加载图像，以便只加载第一个图像，当用户单击下一个箭头转到下一个图像时，它会加载等等。这些选项中的任何一个都可能吗？

编辑：响应下面的评论 - 图像加载了静态 img 标签

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T23:49:00.333

```
$(window).load(function() { 
    //all resources including external are loaded
    //remove loading messages and fadein presentation
    }); 

$('#presentation img').load(function(){
    //track individual image load
    //you can keep a gloabl count and increment as each image load is triggered
    }); 
```

对于延迟加载：

将图像位置保留为 Json，然后随时随地创建图像元素并附加到演示文稿。

编辑

上面提到的是一般方法，但是对于 nivo 滑块，看起来他们已经有了加载指示器和东西，你还在寻找什么？您想添加加载图像吗？

解释：

当关联的 html 页面完全加载到浏览器并创建相应的 DOM 时，会发生 DOM 就绪事件，此时可能无法完全加载图像等外部资源。

当包括图像在内的所有资源都已加载并且页面准备好呈现时，会发生窗口加载事件。

在 nivo 滑块中，他们使用这种样式：

```
.theme-default .nivoSlider img {
    display: none;
    left: 0;
    position: absolute;
    top: 0;
} 
```

因此，现代浏览器默认不加载图像，因为它的显示是无的。window.load 将在所有图像实际加载之前触发（它们不需要显示页面，因为它们是隐藏的）

# haskell - selectOneMany Yesod 持久

> ID：11570800
> 
> 赞同：3
> 
> 时间：2012-07-19T23:30:03.387
> 
> 标签：haskell, yesod

我试图让 selectOneMany 以有限的成功工作。

我有以下数据库模型

```
User
 email Text
 verkey Text Maybe
 verified Bool
 password Text Maybe
 UniqueUser email
 date UTCTime
 deriving Show

Competence
 parent CompetenceId Maybe
 title Text
 UniqueCompetence title
 deriving Show Read

UserCompetence
 competence CompetenceId
 user UserId Eq
 UniqueUserCompetence user competence
 deriving Show Read 
```

我的处理程序的代码

```
mmember <- runMaybeT $ do
  id <- MaybeT $ maybeAuth
  user <- MaybeT . runDB . get . entityKey $ id
  Entity memberId member <- MaybeT . runDB . getBy . UniqueMember . userEmail $ user
  competences <- lift . runDB . runJoin $ (selectOneMany (UserCompetenceUser <-.) userCompetenceUser)
  return (member,competences) 
```

首先; 我无法在不添加大类型签名的情况下运行此代码，这是应该的吗？

```
competences <- lift . runDB . runJoin $ (selectOneMany (UserCompetenceUser <-.) userCompetenceUser :: SelectOneMany SqlPersist (UserGeneric SqlPersist) (UserCompetenceGeneric SqlPersist)) 
```

其次; 什么是能力类型。理想情况下，我想以 [Entity 能力 ID 能力] 结束。

最后; 如何将过滤器添加到上述连接中以便仅获得“用户”的权限？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T19:37:40.573

感谢 dflemstr 的（大量）帮助，我最终得到了

```
mmember <- runMaybeT $ do
  id <- MaybeT $ maybeAuth
  let user = entityVal id
  Entity memberId member <- MaybeT . runDB . getBy . UniqueMember . userEmail $ user
  let competenceStatement =
        Text.concat
        [ "SELECT ?? "
        , "FROM   competence,     user_competence "
        , "WHERE  competence.id = user_competence.competence_id "
        , "AND    ?             = user_competence.user_id"
        ]
  competences <- lift . runDB $ rawSql competenceStatement
                 [toPersistValue . entityKey $ id]
  return (member, competences :: [Entity Competence]) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-20T00:29:32.780

我已经告诉过你，由于`SelectOneMany`使用的类型别名可能不是归纳的，因此无法避免额外的类型签名。即你的代码试图比它应该的更多态，并且类型签名是限制这种多态性所必需的。

您可以通过“从不同角度”约束类型来避免使用巨大的签名，例如：

```
return (member, competences :: [(Entity User, [Entity UserCompetence])]) 
```

由于类型别名`User`并`UserCompetence`选择特定的数据库后端，因此应该适当地解析类型。

另外，我只是`competences`为你破坏了类型。哈！我希望这对你来说已经足够了。如果您想要直接进行多对多三表连接，以便您可以获得用户“拥有”的所有权限，那么由于潜在的 AST 开销，您无论如何都应该使用准备好的语句，因此请查看[通用的原始 SQL 接口](http://hackage.haskell.org/packages/archive/persistent/0.9.0.4/doc/html/Database-Persist-GenericSql-Raw.html)，它让你做`"SELECT * FROM foo WHERE bar = ?" [filteredBarValue]`你可能更习惯使用的传统；它没有提供与其他类型相同的类型安全性，`persistent`但我认为这是在您的情况下实现三表连接的最简单方法。

您可以`User`通过修改其结果的`oneFilterMany`类型来限制选择的 s `OneFilterMany`。像这样（没有测试过，但应该可以）：

```
let join = (selectOneMany (UserCompetenceUser <-.) userCompetenceUser)
           { somFilterOne = [... filters for User ...] }
competences <- lift . runDB . runJoin $ join 
```

# javascript - 如何摆脱 Sencha Touch 2 工具栏中的填充？

> ID：11570804
> 
> 赞同：0
> 
> 时间：2012-07-19T23:30:51.143
> 
> 标签：javascript, css, extjs, sencha-touch-2

这里是：http: [//jsfiddle.net/sd1212/awHkT/2/](http://jsfiddle.net/sd1212/awHkT/2/)

按钮之间有空间，我不希望这样。我用萤火虫试图消除填充。我认为布局类是：

```
 x-inner x-toolbar-inner x-layout-hbox 
```

所以在我的 CSS 文件中，我放了：

```
.x-inner x-toolbar-inner x-layout-hbox
{
   padding: 0 !important;
} 
```

没啥事儿。

有人可以帮我吗？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T23:58:21.720

这里有几件事不对

**CSS 语法**

`.x-inner x-toolbar-inner x-layout-hbox`是错误的语法。

如果你有这样的事情

```
<div class="x-inner">
  <div class="x-toolbar-inner">
    <div class="x-layout-hbox"> 
```

然后你会使用：

```
.x-inner .x-toolbar-inner .x-layout-hbox 
```

或者

```
.x-inner > .x-toolbar-inner > .x-layout-hbox 
```

如果你有这样的事情：

```
<div class="x-inner x-toolbar-inner x-layout-hbox"> 
```

然后你会使用：

```
.x-inner.x-toolbar-inner.x-layout-hbox 
```

**.x-inner.x-toolbar-innerx-layout-hbox 上没有填充**

如果您使用这些 CSS 类检查 div，您可以在 Firebug 中看到没有定义填充。因此，再次将其设置为 0 不会改变任何内容。

**删除按钮之间的空间**

但是，按钮有一个设置的填充和边距，如下定义：

```
.x-toolbar .x-button {
  margin: 0 .2em;
  padding: .3em .6em;
  height:2.2em // of whatever you want
} 
```

所以如果你想修改它，你应该重写这个类

**最后但并非最不重要的一点：不要覆盖 Sencha Touch CSS 类**

不要覆盖 Sencha Touch CSS 类，使用`cls`工具栏上的属性，如：

```
cls:'my-toolbar', 
```

然后是这样的：

```
.my-toolbar .x-button {
  margin: 0;
  padding: 0;
  height:2.2em // of whatever you want
} 
```

希望这可以帮助

# python - 从 GAE 图像 API 上传到 Facebook 的转换图像

> ID：11570805
> 
> 赞同：0
> 
> 时间：2012-07-19T23:30:59.310
> 
> 标签：python, image, google-app-engine, facebook-graph-api

**有谁知道如何将 GAE Images API Image 对象转换为“类似对象的文件”？**

我正在尝试上传从 GAE 图片 API 转换到 Facebook 的图片。我正在使用 execute_transforms 函数，它返回图像的“图像表示”。我尝试使用以下代码上传它，但我收到一个 FB API 错误“没有上传的图像”

```
img = images.Image(ORIGINAL_IMAGE)
img.crop(0.0, 5.0/img.height, 713.0/img.width, 644.0/img.height)
output = img.execute_transforms(output_encoding=images.PNG)
graph = fb.GraphAPI(access_token)
graph.put_photo(output, 'Look at this cool photo!') 
```

我认为问题在于*输出*不是 put_photo 所需要的“类文件对象”，但 GAE 文档没有转换为“类文件对象”的功能。尝试创建临时文件并写入它们，但 GAE 不允许写入文件系统。我也尝试写入 StringIO 对象，但没有奏效。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T01:19:38.753

使用 StringIO

```
enter code here

import StringIO

graph.put_photo(StringIO.StringIO(output), 'Look at this cool photo!') 
```

[在http://docs.python.org/library/stringio.html](http://docs.python.org/library/stringio.html)阅读文档

# javascript - 带有确认的 jQuery UI 对话框

> ID：11570808
> 
> 赞同：0
> 
> 时间：2012-07-19T23:31:29.407
> 
> 标签：javascript, jquery, jquery-ui

我有一个获取一行文本的 jQuery UI 对话框。如果此文本不包含在 localStorage 字典中，我将其插入到字典中。如果*存在*，我想为用户提供不覆盖“ok”处理程序中现有条目的选项。

因为 jQuery UI 对话框是有状态的并且在多个调用中持续存在，除非明确删除（AFAICT），所以我没有看到一个清晰的路径来呈现“你确定要核对你以前的条目吗？” 警觉而不诉诸……呃……警觉。

问题简洁地说：你能从 jQuery UI 对话框中创建一个确认框吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T12:46:27.460

我想你可能已经用谷歌搜索了一些东西来找到这些链接：

无论如何都有它并取笑：

1.  [jQuery 对话框](http://labs.abeautifulsite.net/archived/jquery-alerts/demo/)
2.  [jQuery 确认](http://jqueryui.com/demos/dialog/#modal-confirmation)

干杯！！！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T23:39:33.577

我没有使用过 jQuery UI 对话框，但你总是可以创建你自己的 html 元素并用它们做任何你想做的事情，包括将它们分层放在 jQuery 对话框的顶部。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-20T17:47:57.733

好的，事实证明我发现处理这个问题的最好方法是使用闭包。像这样（伪代码）：

```
getThingieName: handler(function() {
  var $dialog;
  $dialog = $('<div id="thingie-name-dialog" class="ui-widget"></div>').html("<p>Enter a name for this thingie</p>\n<input type=\"text\" id=\"dlg-thingie-name\" style=\"width: 80%\" />").dialog({
    autoOpen: false
  }, {
    title: 'enter a name',
    modal: true,
    buttons: {
      Add: function() {
        var value = $('#dlg-thingie-name').val();
        $(this).dialog('close');
        $('#thingie-name-dialog').remove();
        return handler(value);                  // <= closure to handle the onAdd
      },
      Cancel: function() {
        $(this).dialog('close');
        return $('#thingie-name-dialog').remove();
      }
    }
  });
  return $dialog.dialog('open');
}),

getConfirmation: function(message, handler) {
  var $dialog;
  $dialog = $('<div id="confirmation-dialog" class="ui-widget"></div>').html("<p>" + message + "</p>").dialog({
    autoOpen: false
  }, {
    title: 'confirm overwrite',
    modal: true,
    buttons: {
      Ok: function() {
        $(this).dialog('close');
        $('#confirmatio-dialog').remove();
        return handler(true);               // <= closure to handle onOk
      },
      Cancel: function() {
        $(this).dialog('close');
        $('#Thingie-name-dialog').remove();
        return handler(false);              // <= closure to handle onCancel
      }
    }
  });
  return $dialog.dialog('open');
}

// Calling sequence
Snippets.getSnippetName(function(value) {
  if (value == null) return false;
  if (localStorage.getItem(value)) {
    getConfirmation("This thingie, " + value + ", already exists. Overwrite?", function(response) {
      if (response) return localStorage.setItem(value, snippet);
    });
  } else {
    localStorage.setItem(value, snippet);
  }
} 
```

这可能不是最佳代码，但通过将它们嵌入处理程序中，它确实使对话框的触发依赖于按钮推送。

# perl - 如何在 Perl 的字符串中匹配一个模式并排除另一个模式

> ID：11570809
> 
> 赞同：0
> 
> 时间：2012-07-19T23:31:37.937
> 
> 标签：perl, expression, matching

我的目标是匹配模式前不包含“#”的模式，例如：

```
array = ("# abc", "# abcd" "abc" " abc ", "abcd" "abc # foo") 
```

我想匹配“abc”。“ABC”。“A B C D” 。“abc # foo” 我需要什么正则表达式才能仅匹配不包含“#”的“abc”模式？

我试过`m/[^#]+abc/g`了，但它不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T23:40:14.783

寻找正则表达式后瞻和前瞻。

像这样的东西：

```
m/^(?<!#).*/g 
```

可能会起作用，这是一个负面的看法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-20T01:02:21.937

你的标准一点都不清楚。你想拒绝任何`#`作为第一个字符的东西吗？

```
print "$_\n" for grep /^[^#]/, @array; 
```

会这样做。但是，如果您还想检查`abc`可能的前导空格，那么您需要

打印 "$_\n" 为 grep /^\s*abc/, @array;

这些从您的数据中产生相同的结果并选择您说想要的项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T23:53:49.457

`#`如果您以前不想要任何地方`abc`，那么您几乎就在那里。试试这个：`^[^#]*abc`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T23:48:25.623

这应该可行，它使用负前瞻：

```
^[^#]*abc(?!(.*#)) 
```

新的想法...

我再次仔细阅读了您的问题，发现我并没有完全理解您的意思。你的意图真的很困惑，我可以肯定地说，如果字符串在同一行中有 1 个或多个 # 在 abc 后面，你不想得到匹配（我猜你不在乎是否还有其他东西或不在他们之间）。我很困惑，因为您明确地说您想匹配“abc # foo”，但同时又语无伦次地说“只匹配不包含 '#' 的 'abc' 模式”。

如果我们要遵循这种新的解释，正确的正则表达式可能是：

```
(?<!(#.*))abc.* 
```

该表达式不会使用 abc 后面的任何文本，并且如果之前的任何内容根本不包含 # 则从该点开始匹配。

# php - 无法使 Ajax 链接可右键单击

> ID：11570810
> 
> 赞同：1
> 
> 时间：2012-07-19T23:31:53.193
> 
> 标签：php, javascript, ajax, onclick, hyperlink

我遇到了一个问题，我的网站 www.projectbuilder.tk 是 100% ajax 驱动的，我是如何遇到一个似乎让我难过的问题，我可以为每个访问的页面设置 urlbar/history，并让 php 加载页面在用户第一次访问时，基于 ?page= 从那里通过 ajax 加载所有页面和数据。

问题是没有人可以真正右键单击链接（因为我不能给他们 href 属性而不导致页面重新加载，并跳过 onclick 事件）

所以我的问题是如何使 ajax 链接看起来像普通链接以右键单击并在新窗口、选项卡或复制 url 中打开？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T23:44:03.453

将普通链接放在“href”标签中，但将您的 onclick jquery 处理程序方法调整为：

```
function handleLinkClick(event){
    if (event) event.preventDefault();
    ... Continue as normal ...
} 
```

'preventDefault' 停止 normla 事件传播，因此左键单击链接将使用您的 onclick 方法，而不会牺牲存储在 HREF 中的有价值信息。还。小心使用 jquery 'live' 绑定。它也用于捕获右键单击，但可能不再如此。

抱歉刚刚意识到我假设您使用的是 jquery。只是返回错误，因为提到的其他海报应该可以正常工作。这些天我已经习惯了 jQuery。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T23:37:43.420

为什么不跳过onclick就不能给他们href？

只需从 onclick 处理程序返回 false，它就不会使用 href。

我错过了什么吗？因为这是非常基础的。

# iphone - 全局 NSMutableString

> ID：11570812
> 
> 赞同：0
> 
> 时间：2012-07-19T23:32:00.980
> 
> 标签：iphone, objective-c, xcode, global-variables, nsmutablestring

我有一个选项卡式视图，我需要从不同的选项卡式视图中选择各种选项，这些选项应该附加在同一个字符串中。为此，我想使用 NSMutableString。

选择所有选项并根据需要形成字符串后。我想在下一个没有标签的视图中访问这个 NSMutableString。我认为为此我需要将 NSMutableString 声明为全局变量？

有人可以帮我解决这个问题。我是objective-c和xcode的新手。谢谢你。任何帮助深表感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T00:01:41.847

1.  您可以使其成为您的应用程序委托的属性
2.  您可以使用单例
3.  您可以使用 NSUserDefaults
4.  您可以安排所有“相关方”对象共享一些公共对象（在初始化期间传递可寻址性），其中包含指向您的字符串的字段

可能还有其他几个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T23:37:58.730

您可以为此使用 NSUserDefaults：

**保存：（** 在上一个视图类中加载下一个视图之前调用）

```
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults]; 
[defaults setObject:yourString forKey:@"KEYNAMEHERE"];
[defaults synchronize]; 
```

**检索**（在下一个视图的类中加载下一个视图时调用）

```
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults]; 
NSMutableString *string = [defaults objectForKey:@"KEYNAMEHERE"]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T23:58:31.347

另一种选择是拥有一个单例对象，如果您有多个要共享的变量，则特别有用。

这是一篇关于正确处理单身人士的好帖子：http: [//lukeredpath.co.uk/blog/a-note-on-objective-c-singletons.html](http://lukeredpath.co.uk/blog/a-note-on-objective-c-singletons.html)

基本上你会写一个非常简单的类，比如：

状态.h：

```
@interface State : NSObject

@property (atomic, strong) NSMutableString *mystring;
+ (id)sharedInstance;

@end 
```

状态.m：

```
#import "State.h"
@implementation State

@synthesize mystring;

+ (id)sharedInstance
{
  static dispatch_once_t pred = 0;
  __strong static id _sharedObject = nil;
  dispatch_once(&pred, ^{
    _sharedObject = [[self alloc] init]; // or some other init method
  });
  return _sharedObject;
}
@end 
```

然后每当你需要它时，你可以这样做：

```
import "State.h"

[State sharedInstance].mystring 
```

更简单的是，您可以从这里使用单例宏：[https ://gist.github.com/1057420#gistcomment-63896](https://gist.github.com/1057420#gistcomment-63896)

我个人发现这种模式非常有用。

# c# - 如何在 ASP.NET MVC3 的 URL 中将 _ 替换为 -？

> ID：11570813
> 
> 赞同：1
> 
> 时间：2012-07-19T23:32:00.627
> 
> 标签：c#, asp.net-mvc-3, url-rewriting, seo

我将控制器名称设置为“My_Controller”。我正在寻找一种将我的 URL 从**www.mysite.com/My_Controller/My_Action**更改 为 **www.mysite.com/my-controller/my-action/**的方法。

在不使用 URL 重写器扩展的情况下，有没有办法做到这一点？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T23:39:10.977

您可以使用路由处理程序。

```
public class HyphenatedRouteHandler : MvcRouteHandler
{
    protected override IHttpHandler GetHttpHandler(RequestContext requestContext)
    {
        requestContext.RouteData.Values["controller"] = requestContext.RouteData.Values["controller"].ToString().Replace("-", "_");
        try
        {
            requestContext.RouteData.Values["action"] = requestContext.RouteData.Values["action"].ToString().Replace("-", "_");
        }
        catch { }
        return base.GetHttpHandler(requestContext);
    }
} 
```

..并将其添加到您的路线中，如下所示：

```
routes.MapRoute(
            "Default", // Route name
            "{controller}/{action}/{id}", // URL with parameters
            new { controller = "Home", action = "Index", id = UrlParameter.Optional }, // Parameter defaults
        ).RouteHandler = new HyphenatedRouteHandler(); 
```

这意味着，只要您有一个名为“Example_Controller”的控制器和一个名为“Example_Action”的操作，您就可以使用 /example-controller/example-action 调用它

# jquery - 如果没有结果，则 jQuery UI 自动完成显示

> ID：11570820
> 
> 赞同：0
> 
> 时间：2012-07-19T23:32:18.083
> 
> 标签：jquery, jquery-ui, autocomplete, jquery-ui-autocomplete

我正在使用 jQuery UI 自动完成插件，如果没有找到结果，我想显示一些文本。我已经看到很多使用远程数据集执行此操作的示例，但我将源设置为本地 JSON 数组。这是我现在正在使用的代码，它隐藏了所有与所选值不匹配的行。当用户键入与任何可用标签都不匹配的文本时，我想隐藏所有行并在文本框中显示“未找到条目”

```
$( "#archiveVendor" ).autocomplete({
    source: availableTags,
    select: function(event, ui){
        var emptyRow = '<tr class="emptyArchive"><td class="approved_content">---</td><td>---</td><td>---</td><td class="payment_status">---</td></tr>';
        $('.archive_inner .emptyArchive').remove();
        $('.archive_inner tr').show().filter(function(index){
            var tds = $(this).children('td');
            if($(tds).length == 4){
                if($(tds[1]).text() == '---'){
                    return false;
                }
                var title = $(tds[0]).attr('title');
                return title === ui.item.value ? false : true;
            }
        }).hide();

        if($('.archive_approved tr:visible').length == 1){
            $('.archive_approved tbody').append(emptyRow);
        }
        if($('.archive_denied tr:visible').length == 1){
            $('.archive_denied tbody').append(emptyRow);
        }
    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T23:39:06.797

也许您可以将 ui.item.value 与数组进行比较？

```
if(jQuery.inArray(ui.item.value, json_array) == -1) { add text to right field and hide() other fields } 
```

# r - 更改气泡图中使用的大小范围

> ID：11570821
> 
> 赞同：10
> 
> 时间：2012-07-19T23:32:20.640
> 
> 标签：r, charts, ggplot2

我正在使用 R 来创建我正在研究的行业中战略组的竞争地图。网点数量沿着 x 轴，销售额是 y 轴以及气泡的大小。使用的代码：

```
qplot(data = supermarket, x = outlets, y = sales, size = sales, color = retailer) 
```

但是，我需要增加气泡的整体大小，因为目前还不清楚。请参阅下面的示例。

![图形](../Images/fa142508ee9a90754d9ca9deb7dee58c.png)

我需要的是让气泡保持其相对于销售额的大小，但总体上变得更大以增加可见度。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-19T23:46:03.350

玩：`+ scale_size_continuous(range = c())`如：

```
#set.seed(10)
#supermarket <- data.frame(sales = sample(1:50000, 12), 
#    outlets = sample(1:3000, 12), retailer = LETTERS[1:12])

#I use ggplot rather than qplot and understand it so that's what I used here
ggplot(data = supermarket, aes(x=outlets, y=sales, size=sales, color=retailer)) + 
            geom_point() + scale_size_continuous(range = c(3, 8)) 
```

或者您可以只使用您的代码并添加`scale_size_continuous`上面 bdemarest 建议的内容：

```
qplot(data = supermarket, x = outlets, y = sales, size = sales, color = retailer) + 
    scale_size_continuous(range = c(3, 8)) 
```

两者都会产生相同的结果。

# spring - Groovy Spring DSL：使用其他 bean 的属性构造 bean

> ID：11570823
> 
> 赞同：2
> 
> 时间：2012-07-19T23:33:01.510
> 
> 标签：spring, grails

我有一堆 Spring bean，其中一些需要从其他 bean 初始化，其中一些需要从其他 bean 的属性初始化。例如：

```
Foo {
}

Bar {
    String getBaz()
}

Qux {
    Qux(Foo foo, String baz)
} 
```

我以为我可以写类似的东西

```
beans = {
    foo(Foo) {}
    bar(Bar) {}
    qux(Qux, ref('foo'), ref('bar').baz) {}
} 
```

但显然这不起作用，因为`ref('bar')`不是 Bar，而是`RuntimeBeanReference`.

在普通的 Spring (3+) 中，我想要的显然可以使用[spring 表达式](http://www.enigmastation.com/2010/04/07/java-surgery-spring-injection-of-other-beans-properties/)，但我无法弄清楚 Grails Spring DSL 的必要语法。可以做到吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-20T00:34:34.640

我认为你的意思是类看起来像这样：

```
class Foo {
}

class Bar {
   String baz
}

class Qux {
   Foo foo
   String baz

   Qux(Foo f, String b) {
      foo = f
      baz = b
   }
} 
```

第二个`ref('foo')`应该是`ref('bar')`。然后这将起作用：

```
beans = {
   foo(Foo)
   bar(Bar) {
      baz = 'wazzup'
   }
   qux(Qux, ref('foo'), '#{bar.baz}')
} 
```

# python - 在 Python 中处理线程连接的正确方法

> ID：11570824
> 
> 赞同：3
> 
> 时间：2012-07-19T23:33:07.127
> 
> 标签：python, multithreading, join, spawn

所以我编写了一个工具，它获取项目列表，将其拆分为给定数量的列表（比如说 10 个），然后取出这 10 个列表并产生 10 个线程，“EvaluationThreads”（扩展 threading.thread），每个那些线程评估他们提供评估的任何内容。当我启动每个线程时，我将它们全部放入一个列表中，并在生成它们后，我有以下代码：

```
for th in threadList:
    th.join()
    someTotal = th.resultsAttribute 
```

这就是我如何处理等待所有线程完成并收集它们的信息。虽然这是一种等待一切完成然后收集结果的工作方式，但我觉得必须有一种更优雅的方式来做这件事，因为这些线程可以很好地在不同的时间完成，如果第一个开始的线程最后完成所有较早完成的必须等待该线程完成才能加入。有没有办法获取这些线程的信息并在它们完成时加入它们，而不是按照它们开始的顺序？我最初认为我会在线程中使用某种回调或其他东西，但我不确定是否有更可接受的解决方案。

谢谢你的帮助。

编辑：澄清一下，我的评估函数不受 CPU 限制，我也不想在线程之间分配文档以尽快完成它，每个线程都有固定的大约偶数个作业。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T01:32:08.747

对于您的主要问题：

如果你正在做比这更复杂的事情——或者，特别是，如果你重复这样做——你可能需要一个“线程组”类。有几十个是预制的，但如果你不喜欢其中任何一个，自己写一个就很简单了。

然后，而不是这个：

```
threadList = []
for argchunk in splitIntoChunks(values, 10):
  threadList.append(threading.Thread(target=myThreadFunc, args=argchunk))
...
someTotal = 0
for th in threadList:
  th.join()
  someTotal += th.resultsAttribute 
```

你可以这样做：

```
threadGroup = ThreadGroup.ThreadGroup()
for argchunk in splitIntoChunks(values, 10):
  threadGroup.newThread(myThreadFunc, argchunk)
threadGroup.join()
someTotal = sum(th.resultsAttribute for th in threadGroup) 
```

或者，也许更好，一个完整的线程池库，所以你可以这样做：

```
pool = ThreadPool(10)
for argchunk in splitIntoChunks(values, 100):
  pool.putRequest(myThreadFunc, argchunk)
pool.wait() 
```

这里的优点是您可以轻松地在 10 个线程上适当地安排 100 个作业，而不是每个线程一个 10 个作业，而无需维护队列等所有工作。缺点是您不能只迭代线程要获得返回值，您必须迭代作业——理想情况下，您不想让作业一直存活到最后，这样您就可以迭代它们。

这将我们带到您的第二个问题，即如何从线程（或作业）中获取值。有很多很多方法可以做到这一点。

你所做的工作。你甚至不需要任何锁定。

正如您所建议的，使用回调也可以。但请记住，回调将在工作线程上运行，而不是在主线程上，所以如果它正在访问某个全局​​对象，您将需要某种同步。

如果您无论如何都要同步，那么回调可能没有任何好处。例如，如果你想要做的只是对一堆值求和，你可以只 set `total=[0]`，并让每个线程`total[0] += myValue`在锁内执行。（当然在这种情况下，只在主线程中进行求和并避免锁定可能更有意义，但如果合并结果的工作量更大，那么这个选择可能就不那么简单了。）

您还可以使用某种原子对象，而不是显式锁定。例如，标准的 Queue.Queue 和 collections.deque 都是原子的，所以每个线程可以只 set `q = Queue.Queue()`，然后每个线程通过 do 推送它的结果`q.push(myValue)`，然后加入后你只需迭代并总结队列的值。

事实上，如果每个线程只向队列推送一次，您可以在队列本身上执行 10 次阻塞获取，之后您知道`group.join()`or`pool.wait()`或 what 将快速返回。

或者您甚至可以将回调作为作业推送到队列中。同样，您可以在队列上执行 10 次阻塞获取，每次都执行结果。

如果每个线程可以返回多个对象，他们可以在完成后将一个标记值或回调推送到队列中，并且您的主线程会不断弹出，直到它读取 10 个标记。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T23:47:20.907

使用 Queue 将信息从线程中推送出去，只要它可用：

假设这是您的线程：

```
class myThread(threading.Thread):
   def __init__(self, results_queue):
       self.results_queue = results_queue
       #other init code here

   def run(self):
       #thread code here

       self.results_queue.put(result) #result is the information you want from the thread 
```

这是您的主要代码：

```
import Queue #or "import queue" in Python 3.x
results_queue = Queue()

#thread init code here

for i in xrange(num_threads_running):
    data = results_queue.get() # queue.get() blocks until some item is available
    #process data as it is made available

#at this point, there is no need to .join(), since all the threads terminate as soon as they put data to the queue. 
```

# unit-testing - 单元测试可维护性和工厂

> ID：11570826
> 
> 赞同：1
> 
> 时间：2012-07-19T23:33:15.323
> 
> 标签：unit-testing, maintainability, factories

**编辑：**我决定完全放弃这个想法，因为虽然使用相同的方法来创建我的实例很好，但我放弃了其他事情并使问题复杂化。

在我的单元测试项目中，我有一个文件夹，其中基本上包含我的单元测试的所有工厂类，如下面的那个。

```
public static class PackageFileInfoFactory
{
    private const string FILE_NAME = "testfile.temp";

    public static PackageFileInfo CreateFullTrustInstance()
    {
        var mockedFileInfo = CreateMockedInstance(AspNetHostingPermissionLevel.Unrestricted);

        return mockedFileInfo.Object;
    }

    public static PackageFileInfo CreateMediumTrustInstance()
    {
        var mockedFileInfo = CreateMockedInstance(AspNetHostingPermissionLevel.Medium);

        return mockedFileInfo.Object;
    }

    private static Mock<PackageFileInfo> CreateMockedInstance(AspNetHostingPermissionLevel trustLevel)
    {
        var mockedFileInfo = new Mock<PackageFileInfo>(FILE_NAME);

        mockedFileInfo.Protected().SetupGet<AspNetHostingPermissionLevel>("TrustLevel").Returns(() => trustLevel);

        mockedFileInfo.Protected().Setup<string>("CopyTo", ItExpr.IsAny<string>()).Returns<string>(destFileName => "Some Unknown Path");

        return mockedFileInfo;
    }
} 
```

这是我的单元测试的示例。

```
public class PackageFileInfoTest
{
    public class Copy
    {
        [Fact]
        public void Should_throw_exception_in_medium_trust_when_probing_directory_does_not_exist()
        {
            // Arrange
            var fileInfo = PackageFileInfoFactory.CreateMediumTrustInstance();

            fileInfo.ProbingDirectory = "SomeDirectory";

            // Act
            Action act = () => fileInfo.Copy();

            // Assert
            act.ShouldThrow<InvalidOperationException>();
        }

        [Fact]
        public void Should_throw_exception_in_full_trust_when_probing_directory_does_not_exist()
        {
            // Arrange
            var fileInfo = PackageFileInfoFactory.CreateFullTrustInstance();

            fileInfo.ProbingDirectory = "SomeDirectory";

            // Act
            Action act = () => fileInfo.Copy();

            // Assert
            act.ShouldThrow<InvalidOperationException>();
        }

        [Fact]
        public void Should_throw_exception_when_probing_directory_is_null_or_empty()
        {
            // Arrange
            var fileInfo = PackageFileInfoFactory.CreateFullTrustInstance();

            // Act
            Action act = () => fileInfo.Copy();

            // Assert
            act.ShouldThrow<InvalidOperationException>();
        }
    }
} 
```

这有助于我保持单元测试的清洁并专注于测试，我只是想知道其他人如何处理这个问题以及他们在做什么来保持测试的清洁。

**更新：**

作为对 Adronius 的回应，我更新了我的帖子，其中包含了我旨在减少这些工厂的原型。

一个主要问题是在我的测试中使用完全相同的语法来创建实例并减少工厂类的数量。

```
namespace EasyFront.Framework.Factories
{
    using System;
    using System.Collections.Generic;
    using System.Diagnostics.Contracts;

    using EasyFront.Framework.Diagnostics.Contracts;

    /// <summary>
    ///     Provides a container to objects that enable you to setup them and resolve instances by type.
    /// </summary>
    /// <remarks>
    ///     Eyal Shilony, 20/07/2012.
    /// </remarks>
    public class ObjectContainer
    {
        private readonly Dictionary<string, object> _registeredTypes;

        public ObjectContainer()
        {
            _registeredTypes = new Dictionary<string, object>();
        }

        public TResult Resolve<TResult>()
        {
            string keyAsString = typeof(TResult).FullName;

            return Resolve<TResult>(keyAsString);
        }

        public void AddDelegate<TResult>(Func<TResult> func)
        {
            Contract.Requires(func != null);

            Add(typeof(TResult).FullName, func);
        }

        protected virtual TResult Resolve<TResult>(string key)
        {
            Contract.Requires(!string.IsNullOrEmpty(key));

            if (ContainsKey(key))
            {
                Func<TResult> func = GetValue<Func<TResult>>(key);

                Assert.NotNull(func);

                return func();
            }

            ThrowWheNotFound<TResult>();

            return default(TResult);
        }

        protected void Add<T>(string key, T value) where T : class
        {
            Contract.Requires(!string.IsNullOrEmpty(key));

            _registeredTypes.Add(key, value);
        }

        protected bool ContainsKey(string key)
        {
            Contract.Requires(!string.IsNullOrEmpty(key));

            return _registeredTypes.ContainsKey(key);
        }

        protected T GetValue<T>(string key) where T : class
        {
            Contract.Requires(!string.IsNullOrEmpty(key));

            return _registeredTypes[key] as T;
        }

        protected void ThrowWheNotFound<TResult>()
        {
            throw new InvalidOperationException(string.Format("The type '{0}' was not found in type '{1}'.", typeof(TResult).FullName, GetType().ReflectedType.FullName));
        }

        [ContractInvariantMethod]
        [System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Performance", "CA1822:MarkMembersAsStatic", Justification = "Required for code contracts.")]
        private void ObjectInvariant()
        {
            Contract.Invariant(_registeredTypes != null);
        }

    }
} 
```

然后我可以扩展它以采用这样的参数。

```
namespace EasyFront.Framework.Factories
{
    using System;
    using System.Collections.Generic;
    using System.Diagnostics.Contracts;

    using EasyFront.Framework.Diagnostics.Contracts;

    public class ObjectContainer<T> : ObjectContainer
    {
        public TResult Resolve<TResult>(T key = default(T))
        {
            string keyAsString = EqualityComparer<T>.Default.Equals(key, default(T)) ? typeof(TResult).FullName : GetKey(key);

            Assert.NotNullOrEmpty(keyAsString);

            return Resolve<TResult>(keyAsString);
        }

        public void AddDelegate<TReturn>(T key, Func<T, TReturn> func)
        {
            Contract.Requires(func != null);

            Add(GetKey(key), func);
        }

        protected override TResult Resolve<TResult>(string key)
        {
            if (ContainsKey(key))
            {
                Func<TResult> func = GetValue<Func<TResult>>(key);

                Assert.NotNull(func);

                return func();
            }

            throw new InvalidOperationException(string.Format("The type '{0}' was not setup for type '{1}'.", typeof(TResult).FullName, GetType().ReflectedType.FullName));
        }

        /// <summary> Gets the full name of the type and the hash code as the key. </summary>
        /// <remarks> Eyal Shilony, 20/07/2012\. </remarks>
        /// <param name="value"> The value to use to get key. </param>
        /// <returns> The full name of the type and the hash code as the key. </returns>
        private static string GetKey(T value)
        {
            Contract.Ensures(!string.IsNullOrEmpty(Contract.Result<string>()));

            string key = value.GetType().FullName + "#" + value.ToString().GetHashCode();

            Assert.NotNullOrEmpty(key);

            return key;
        }
    }
} 
```

实现将是这样的。

```
namespace EasyFront.Tests.Factories
{
    using System.Web;

    using EasyFront.Framework.Factories;
    using EasyFront.Framework.Web.Hosting.Packages;

    using Moq;
    using Moq.Protected;

    public class PackageFileInfoFactory : IObjectFactory<AspNetHostingPermissionLevel>
    {
        private const string FILE_NAME = "testfile.temp";

        private readonly ObjectContainer<AspNetHostingPermissionLevel> _container;

        public PackageFileInfoFactory()
        {
            _container = new ObjectContainer<AspNetHostingPermissionLevel>();

            _container.AddDelegate(AspNetHostingPermissionLevel.Unrestricted, value =>
            {
                var mockedFileInfo = CreateMockedInstance(value);

                return mockedFileInfo.Object;
            });

            _container.AddDelegate(AspNetHostingPermissionLevel.Medium, value =>
            {
                var mockedFileInfo = CreateMockedInstance(value);

                return mockedFileInfo.Object;
            });
        }

        public TResult CreateInstance<TResult>(AspNetHostingPermissionLevel first)
        {
            return _container.Resolve<TResult>(first);
        }

        private static Mock<PackageFileInfo> CreateMockedInstance(AspNetHostingPermissionLevel trustLevel)
        {
            var mockedFileInfo = new Mock<PackageFileInfo>(FILE_NAME);

            mockedFileInfo.Protected().SetupGet<AspNetHostingPermissionLevel>("TrustLevel").Returns(() => trustLevel);

            mockedFileInfo.Protected().Setup<string>("CopyTo", ItExpr.IsAny<string>()).Returns<string>(destFileName => "Some Unknown Path");

            return mockedFileInfo;
        }
    }
} 
```

最后我可以这样使用它。

```
namespace EasyFront.Framework.Web.Hosting.Packages
{
    using System;
    using System.Web;

    using EasyFront.Tests.Factories;

    using FluentAssertions;

    using global::Xunit;

    public class PackageFileInfoTest
    {
        public class Copy
        {
            private readonly PackageFileInfoFactory _factory;

            public Copy()
            {
                _factory = new PackageFileInfoFactory();
            }

            [Fact]
            public void Should_throw_exception_in_medium_trust_when_probing_directory_does_not_exist()
            {
                // Arrange
                var fileInfo = _factory.CreateInstance<PackageFileInfo>(AspNetHostingPermissionLevel.Medium);

                fileInfo.ProbingDirectory = "SomeDirectory";

                // Act
                Action act = () => fileInfo.Copy();

                // Assert
                act.ShouldThrow<InvalidOperationException>();
            }

            [Fact]
            public void Should_throw_exception_in_full_trust_when_probing_directory_does_not_exist()
            {
                // Arrange
                var fileInfo = _factory.CreateInstance<PackageFileInfo>(AspNetHostingPermissionLevel.Unrestricted);

                fileInfo.ProbingDirectory = "SomeDirectory";

                // Act
                Action act = () => fileInfo.Copy();

                // Assert
                act.ShouldThrow<InvalidOperationException>();
            }

            [Fact]
            public void Should_throw_exception_when_probing_directory_is_null_or_empty()
            {
                // Arrange
                var fileInfo = _factory.CreateInstance<PackageFileInfo>(AspNetHostingPermissionLevel.Unrestricted);

                // Act
                Action act = () => fileInfo.Copy();

                // Assert
                act.ShouldThrow<InvalidOperationException>();
            }
        }
    }
} 
```

我不知道它是否有效，这只是我为帖子提出的一个概念，以证明我的观点，我想知道人们对此有何看法？如果您有任何建议或任何事情，我会很高兴听到的。

我不喜欢重新发明轮子，所以如果你有更好的方法，我也想听听。:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T18:45:36.670

我在单元测试中使用了几乎相同的方法。

如果我在一个测试夹具类中有重复，我将大部分创建（而不是初始化）模拟（双打）放入 setUp 方法。

但是几个测试夹具类之间仍然存在重复。因此，对于那些重复，我使用看起来与您的相似的“ **TestDoubleFactory** ”静态类，除了我没有创建实例的方法，但我总是只创建模拟对象，因此我可以在测试中进一步修改（设置）它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-21T06:00:33.987

我无法在 2 分钟内理解您更新中的 test-factory-class-framework，因此我认为它不会使维护测试变得更容易。

但是，我喜欢您拥有集中式测试数据生成器的概念。

在我看来，在大多数情况下，每种类型的一个测试数据工厂方法就足够了。此方法定义类型的标准测试数据。

实际测试将差异分配给标准测试数据。

简单的例子：

```
public class PackageFileInfoTest
{
    public class Copy
    {
        [Fact]
        public void Should_throw_exception_when_probing_directory_does_not_exist()
        {
            // Arrange
            var fileInfo = TestData.CreatePackageFileInfo();
            fileInfo.ProbingDirectory = "/Some/Directory/That/Does/Not/Exist";
            // Act
            Action act = () => fileInfo.Copy();

            // Assert
            act.ShouldThrow<InvalidOperationException>();
        } 
```

注意：“不存在的目录测试”应该独立于“权限级别”。因此，工厂的标准许可应该足够了。

当涉及多个类型时，每个类型一个工厂方法的更复杂示例：

```
 [Fact]
        public void Should_throw_exception_in_low_trust_when_writing_to_protected_directory()
        {
            // Arrange
            var protectedDirectory = TestData.CreateDirectory();
            protectedDirectory.MinimalPermissionRequired = AspNetHostingPermissionLevel.Full;

            var currentUser= TestData.CreateUser();
            currentUser.TrustLevel = AspNetHostingPermissionLevel.Low;

            // Act
            Action act = () => FileUploadService.CopyTo(protectedDirectory);

            ....
    }
} 
```

在 Dotnet 世界中， [nbuilder](http://nbuilder.org/)可以帮助您填充测试数据数组。

# javascript - 如果加载页面时未执行标记，xfbml 或 html5 不起作用？

> ID：11570827
> 
> 赞同：0
> 
> 时间：2012-07-19T23:33:18.047
> 
> 标签：javascript, lightbox, xfbml, facebook-likebox

我有一个带有图片库的网站。所有模板页面都使用相同的模板和文件。在照片页面 xfbml 上类似作品。在相册页面上，当用户单击某些内容时，它具有灯箱效果和类似 javascript 生成的 fb 代码，但没有任何内容出现，即使我可以看到代码是正确的。html 标签和 sdk 都包含在内。

我需要告诉脚本在生成 javascript 时重新初始化吗？

任何帮助表示赞赏..

肖恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T02:56:07.903

您需要调用`FB.XFBML.parse(someElement)`where`someElement`包含您的 XFBML 标记。

# ios - 属性属性

> ID：11570838
> 
> 赞同：0
> 
> 时间：2012-07-19T23:35:25.270
> 
> 标签：ios, properties, attributes, subclass

当子类化时，我倾向于为我的所有属性赋予属性（非原子，强），除了 IBOutlet，当不是 nib 中的顶级对象时，它们是（非原子，弱）。

是否存在这样的习惯可能不安全，并创建保留循环或产生其他此类负面影响的情况？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T23:46:16.920

对于 NSStrings，您应该使用 (nonatomic, copy)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-20T00:19:52.060

是的，这种习惯可能是不安全的，因为您似乎并没有真正遵循属性属性赋予的规则。

正确的做法是考虑如何使用该属性并为其赋予相应的属性。

这可能出错的一些情况是：

*   代表：保留周期。
*   内存管理：在 2 个类之间共享的图像不能再使用，您必须在两者上都将其设为 nil。
*   线程：将被多个线程访问的属性。

为您提供的快速指南：

如果该属性主要属于该类，即使该类可能共享它：强该类需要该属性才能工作：强（但当您不再需要它时不要忘记将指针归零）如果该属性属于另一个类：弱代表：弱 IBOutlets：弱

对于并发属性，您通常可以使用非原子属性，除非您知道该属性可能被多个线程使用，然后将其设置为原子属性。

这只是一个非常模糊的指南，但在 ARC 下对我来说效果很好。

# twitter-bootstrap - CSS - Twitter Bootstrap：将缩略图网格居中并从链接/图像中删除边框？

> ID：11570840
> 
> 赞同：0
> 
> 时间：2012-07-19T23:35:52.043
> 
> 标签：twitter-bootstrap, center

我正在使用 Twitter Bootstrap 创建图像网格。这是**HTML**代码：

```
<div class="container">
  <div class="row">
    <ul class="thumbnails">
      <li class="span6">
        <a href="x" class="thumbnail">
          <img src="http://www.loremipsum.com" />
        </a>
      </li>
    </ul>
  </div><!-- /.row -->
</div><!-- /.contaner --> 
```

**问题：**

该网格不在页面上居中，左边距总是小于右边距。

我已经尝试设置`text-align: center`为父元素：没有运气。

我也试过

```
.thumbnails { text-align:center; }
.thumbnails > li > a { display: inline-block; float: none; } 
```

你猜怎么了？没运气！

使用偏移量也没有任何效果。

*我该怎么做才能使这个网格居中？*如果需要，我可以提供截图。

*另外，有没有办法从链接中删除边框？*我已经在 中注释掉了`thumbnails.less`，但这给了我一些编译器错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T01:15:36.447

这是一个快速的 jsfiddle ( [jsfiddle](http://jsfiddle.net/jonschlinkert/4NQTp/4/) )，我在 .row 和 .container 上使用背景颜色来显示正在发生的事情。我在您的代码结构中使用了两个 span6，如果您只需要一个 span6，只需删除另一个。至于边框，您必须在 .thumbnail 类上同时调整 box-shadow 和边框，因为 box-shadow 在边框的外观中起着一定的作用。

这是另一个不使用s/ s 的 jsfiddle ( [2nd jsfiddle](http://jsfiddle.net/jonschlinkert/ufyjf/6/) ) ，但确实使用并将类放入网格中。在这个版本中，缩略图以 span6 为中心。`ul``li``.row-fluid``.thumbnails`

最后一个示例（[第 3 个 jsfiddle](http://jsfiddle.net/jonschlinkert/ufyjf/14/)）使用`.row-fluid`自定义类`.thumbnail-container`来包装缩略图并将其居中放置在网格内。如果您将 a 嵌套`.row-fluid`在常规`.row`中，请记住您需要使用 a`.span12`来表示流体行以跨越它所在容器的整个宽度。这是因为流体行使用百分比。

希望这些示例中的一个可以引导您找到答案。我可以帮助您完全按照您的意愿工作，但我需要了解更多细节。如果我做的小提琴对你没有帮助，请让我知道更多细节不起作用，我会尽力让你完成剩下的工作。特别是，每行有多少个拇指，大小是多少（这无关紧要，但对示例有帮助），您是否使用两个 span6？基本上是两列？还是您只为图像使用一个 span6？类似的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T00:51:06.730

好的，对不起。现在明白了，只是我太笨了。我可以向所有开始使用 Twitter Bootstrap 的人推荐的一件事是：了解`row`和 `row-fluid 之间的区别。;-)

# preg-match - preg_match 错误

> ID：11570843
> 
> 赞同：0
> 
> 时间：2012-07-19T23:36:15.423
> 
> 标签：preg-match

我在网上找到了这个功能，但是当我将它粘贴到 Dreamweaver 或 netbeans 中时，它们会标记一行错误：

```
function valid_date($date){
        $search = '^[0-9]{4}-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])$/';
        if(preg_match($search, $date)){ //**** error on this line ****
           echo 'go';
        }else{
           echo 'no go';
        }
} 
```

当我在浏览器中加载它时，它会出现意外的 T_STRING 错误。

有谁知道为什么？

更新代码：

```
function valid_date($date){
    $search = '/^[0-9]{4}-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])$/';
    if(preg_match($search, $date)){
            echo 'go';
    }else{
            echo 'no go';
    }
} 
```

截图 - [http://www.nickstestsite.co.uk/preg_match.png](http://www.nickstestsite.co.uk/preg_match.png) “

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T23:42:52.083

你需要`/`在你的`$search`变量中领先。在 PHP 中，`/`' 表示正则表达式的开始和结束。

# google-maps - 在谷歌地图中检测按键

> ID：11570847
> 
> 赞同：6
> 
> 时间：2012-07-19T23:36:37.110
> 
> 标签：google-maps, google-maps-api-3, keyboard-events

有没有办法**仅**在 Google Maps 画布*处于焦点*时检测按键？

Google Maps JavaScript API V3 具有内置的键盘快捷键。当用户单击或拖动地图图块时，地图将成为*焦点*，并将响应键盘快捷键。如果您单击地图画布之外的任何其他位置，这些键盘快捷键将不再起作用。

我想扩展其中一些快捷方式（特别是箭头键）以执行其他操作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T17:09:46.447

您可以像这里一样禁用谷歌地图中的键盘快捷键

[https://developers.google.com/maps/documentation/javascript/reference?hl=en#MapOptions](https://developers.google.com/maps/documentation/javascript/reference?hl=en#MapOptions)

然后您可以将键盘快捷键用于您自己的目的。

# postgresql - 如何在 PL/pgSQL 中编写此函数

> ID：11570848
> 
> 赞同：0
> 
> 时间：2012-07-19T23:36:54.430
> 
> 标签：postgresql, stored-procedures, plpgsql, window-functions

我有一个具有以下架构的表：

```
CREATE TABLE foo (
     the_date date,
     user_id  int,
     pop      REAL,
     hip      REAL,
     lop      REAL,
     cop      REAL
 ); 
```

我想编写一个`foofunc()`引用前一行并根据以下逻辑返回值的函数：

```
function foofunc() returns numeric as $body$
begin
-- # calculate  (current_row.hip - current_row.lop) as val1 for current row
-- # calculate  abs(current_row.hip - previous_row.cop) as val2
-- # calculate  abs(current_row.lop - previous_row.cop) as val3 
-- RETURN max(val1, val2, val3)
end;
$body$ language plpgsql 
```

我希望能够`foofunc()`像这样调用函数：

```
SELECT foofunc()
from foo 
where the_date between date1 and date2 
and user_id=some_id; 
```

我该如何实施`foofunc()`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T01:26:03.910

假设“previous”由`the_date`..定义

你实际上并不需要一个 plpgsql 函数。带有窗口函数的普通查询可以完成这项工作，而且速度也更快：

```
WITH x AS (
    SELECT *
          ,lag(cop,1,0::real) OVER (ORDER BY the_date) AS p_cop
    FROM   foo
    WHERE  the_date <= <date2> -- don't exclude earlier rows yet
    AND    user_id = <some_id>
    )
SELECT GREATEST (
       hip - lop
      ,@(hip - p_cop)
      ,@(lop - p_cop)
       )
FROM   x
WHERE  the_date >= <date1>
ORDER  BY the_date; 
```

* * *

如果你真的需要一个功能：

```
CREATE OR REPLACE FUNCTION foofunc(_user_id int, _date date)
 RETURNS real AS
$BODY$
BEGIN

RETURN (
    WITH x AS (
        SELECT *
              ,lag(cop,1,0::real) OVER (ORDER BY the_date) AS p_cop
        FROM   foo
        )
    SELECT GREATEST(
         hip - lop
        ,@(hip - p_cop)
        ,@(lop - p_cop)
        )
    FROM   x
    WHERE  the_date = _date
    AND    user_id  = _user_id
    );

END;
$BODY$ language plpgsql; 
```

称呼：

```
SELECT foofunc(1, '2012-07-21'); 
```

# php - 输出某些内容而不先转义它有多危险

> ID：11570849
> 
> 赞同：3
> 
> 时间：2012-07-19T23:36:57.463
> 
> 标签：php, html, content-management-system, xss

继我在构建自定义 cms 时询问有关转义内容的问题之后，我想了解不从数据库中转义内容有多危险 - 假设数据在插入数据库之前已被过滤/验证。

我知道转义输出是一种最佳做法，但我只是不确定某人将值“注入”到要显示的页面内容中是否容易甚至可能。

例如，假设使用简单的 echo 语句显示带有 HTML 标记的内容：

```
<p>hello</p> 
```

诚然，就内容写作而言，它不会赢得任何奖项；）

我的问题是有人可以为了邪恶的目的而改变它，假设在插入数据库之前进行过滤/验证吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T00:10:36.097

*总是逃避适当的上下文；*它是 JSON 或 XML/HTML 或 CSV 或 SQL 都没有关系（尽管您应该使用 SQL 的占位符和 JSON 的库）等。

为什么？*因为它是一致的。*保持一致也是一种懒惰：你不需要考虑数据是否“对 HTML 安全”，因为*这无关紧要*。懒惰（以一种好的方式）是一种有价值的编程特征。（在这种情况下，它也懒得避免由于未来的变化而不得不修复“错误”。）

不要忽略转义“因为它永远不会包含需要转义的数据” ..因为有一天，在许多情况下，*这种假设**将**是错误*的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T23:48:50.040

例如，它也可能是与其他一些漏洞相关的问题，例如 sql 注入。然后有人可以在添加到数据库之前省略过滤/验证并显示他可以显示的任何内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T23:52:42.833

如果您不转义 HTML 输出，则可以简单地将脚本插入页面的 HTML 代码 - 在访问您页面的每个客户端的浏览器中运行。它被称为[跨站点脚本（XSS）](http://en.wikipedia.org/wiki/Cross-site_scripting)。

例如：

```
<p>hello</p><script>alert('I could run any other Javascript code here!');</script> 
```

代替`alert()`，您基本上可以使用任何东西：访问 cookie、操作 DOM、与其他服务器通信等等。

好吧，这是一种非常简单的插入脚本的方法，并且`strip_tags`可以防止这种情况发生。但是有数百个更复杂的技巧，`strip_tags`根本无法防御。

如果您真的想存储和输出 HTML，[HTMLPurifier](http://htmlpurifier.org/)可能是您的解决方案：

> 黑客拥有大量隐藏在 HTML 规范深处的 XSS 向量库。HTML Purifier 是有效的，因为它将整个文档分解为标记并删除非白名单元素，检查标签的格式和嵌套，并根据它们的 RFC 验证所有属性。HTML Purifier 的综合算法辅以广博的知识，确保格式丰富的文档不被剥离。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T23:44:18.133

如果您从数据库中提取单词 hello 并显示它，则不会发生任何事情。如果内容包含`<script>`标签，那么它是危险的，因为用户 cookie 可能会被窃取并用于劫持他们的会话。

# php - 许多许多 css 背景性能

> ID：11570851
> 
> 赞同：4
> 
> 时间：2012-07-19T23:37:16.830
> 
> 标签：php, javascript, css, background-image, background-position

我正在尝试不同的方法将图像转换为代表每个像素的 div。

一种方法是使用 php imagecolorat 创建 div `background-color`，效果很好。

但是，如果我有**数千个**div，`width:1px;height:1px;`每个 div 都具有相同的 css`background-image`并且背景位置增加了怎么办？

这会对性能造成什么影响？即：浏览器是多次绘制整个图像还是仅绘制作为背景可见的部分？注意原始图像有几百 kb。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T23:42:27.843

应该只绘制图像的一部分，但是绘制操作将被调用与像素数量一样多的次数，因此会影响性能。您是否尝试编写任何测试代码并测量其工作方式？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T23:47:29.280

无论如何，数千个 div 都会影响您的性能，因为浏览器必须解析每个 div，将其添加到 DOM，然后渲染它。

在不同的浏览器上实际性能会有所不同。只有被请求的图像部分会被绘制，但会为每个 div 调用绘制图像的渲染函数。特定浏览器的实现是否可以更快地渲染图像的一个像素或解析字符串并打印图像，或多或少。如果浏览器在内存中有图像，则差异可能没有实际意义。但是，如果浏览器每次都必须打开图像文件，那么磁盘访问将杀死您。

话虽如此，我敢打赌有更好的方法来做你想做的事。您可以使用 JavaScript 获取鼠标单击/悬停/等的像素，然后在该特定点添加一个绝对 div 以创建您正在谈论的“过滤器”。此外，如果两个相邻的像素被标记，您可以只扩展前一个 div，而不是创建一个新的，这将大大提高性能

换句话说，看看只是加载带有`img`标签的图像，然后使用 JavaScript 来做你想做的事情。

# node.js - 在 NodeJS TCP 服务器中读取客户端数据输入

> ID：11570855
> 
> 赞同：3
> 
> 时间：2012-07-19T23:38:04.847
> 
> 标签：node.js

我试图创建一个 NodeJS TCP 服务器，它将读取客户端的输入，然后采取相应的行动。

我想知道如何读取数据，所以我可以设置条件来执行过程。

```
var net = require('net');
var server = net.createServer(function (socket) {

socket.on('data', function(data) {
    buf = new Buffer(256);
    len = buf.write(data.toString());

    if (buf.toString('utf8', 0, len) === "test"){
        console.log("you typed test");
    }

    console.log(len + " bytes: " + buf.toString('utf8', 0, len));
});
socket.write("Connected to server.\r\n");
});
server.listen(8080, "127.0.0.1"); 
```

我正在输出此处输入的值： `console.log(len + " bytes: " + buf.toString('utf8', 0, len));` 但是当我在客户端窗口中实际键入“test”时，我在此日志上方的 if 语句与值“test”不匹配。

任何帮助表示赞赏

-克里斯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-20T13:41:48.423

我使用以下`toString()`方法解决了这个问题：

```
socket.on('data', function(data) {
  var response = data.toString().trim();

  if (/disconnect/.test(response)) {
    console.log("Client is diconnecting.");
    socket.end('Disconnecting you now.\r\n');
  } 
});

socket.on('end', function() {
  console.log('client disconnected');
}); 
```

# objective-c - 是否可以在不实际加载的情况下测试是否可以使用 NSStringEncoding 加载文本文件？

> ID：11570856
> 
> 赞同：0
> 
> 时间：2012-07-19T23:38:07.277
> 
> 标签：objective-c, character-encoding, nsstring, text-files, nsstringencoding

我正在开发一个处理文本文件的应用程序。

在打开的对话框附件视图中，当用户选择一个文件时，我想在 NSPopUpButton 上显示所选文件的支持编码，但到目前为止，我能找到的唯一方法是测试是否可以使用某种编码打开文件是实际尝试将其加载到 NSString。

现在我正在为每个编码这样做：

```
NSString *fileContents = [NSString stringWithContentsOfURL:selectedURL encoding:encoding error:nil];

if (fileContents)
{
    /* Add encoding to the list of supported encodings */
} 
```

这会将整个文件加载到`fileContents`对象中。

是否可以只测试文件是否可以在不实际加载的情况下加载？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T03:38:27.867

除非您阅读所有内容，否则无法以 100% 的准确度进行预测。例如，许多编码是 ASCII 的超集，如果您在文件中途停止阅读，您就会被愚弄；也许第一段恰好只*包含*ASCII，然后 4 段之后文件突然包含一堆数学方程。

一个好的中间立场是支持用于指定已经存在的编码的*约定。*例如，文本编辑器喜欢`vim`并`emacs`指定在文件的前几行中嵌入编码提示的特定语法，HTML 和 XML 文件可以包含`<meta>`带有编码信息的标签。如果您可以阅读这些内容，则可以假设它们是正确的并且没有阅读整个文件是相当安全的；否则，您必须阅读整个文件才能确定。

（一个例外：某些 Unicode 编码以不被任何其他编码使用的字节顺序标记开头，因此您可以假设它们就是它们所说的那样。）

# asp.net - 在 ASP.NET 上创建身份验证和授权，能够访问 LDAP

> ID：11570860
> 
> 赞同：1
> 
> 时间：2012-07-19T23:38:55.933
> 
> 标签：asp.net, authentication, ldap, authorization

所以，我已经厌倦了尝试在网上搜索我的问题。

我目前正在创建一个 ASP.NET 2.0 应用程序。该应用程序当前连接到一个数据库，该数据库存储了我需要存储的所有信息。我还可以连接到我工作场所的 LDAP 目录。我正在为我的应用程序使用 LDAP 目录，因为所有内容都由员工 ID 跟踪。我现在需要添加身份验证和授权。

由于我的工作场所很大，我需要能够限制谁可以访问公司内的网站以及允许他们在网站上做什么。我知道 ASP.NET 有某种身份验证和授权，但我完全不知道它是如何工作的。

我当前的解决方案是在我的数据库中添加一个包含两列（员工 id 和 access_id）的表。员工 ID 可用于在需要时从 LDAP 中提取有关员工的信息。access_id 是一组整数，表示允许用户在网站上看到的内容。

当用户第一次在我的网站上启动会话时，我使用他们的 nt id 并从 LDAP 中提取员工 id。然后，我查找所有 access_id 并将它们存储在会话的数组中。每次用户访问网站的一部分时，我都会检查他们是否具有与该部分关联的 access_id 并根据该部分允许或禁止他们。我的第一个 access_id 为 1 允许用户通过将 C# 中的可见性设置为来查看网页

```
if(access_id == 1)
  Enter.visible = true;. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T18:44:32.307

您使用的是哪种 LDAP 目录？如果是 Active Directory，请尝试：http: [//msdn.microsoft.com/en-us/library/ff650308.aspx](http://msdn.microsoft.com/en-us/library/ff650308.aspx) 或 [http://msdn.microsoft.com/en-us/library/ff647405](http://msdn.microsoft.com/en-us/library/ff647405)

您也可以考虑：http: [//msdn.microsoft.com/en-us/library/ff649313](http://msdn.microsoft.com/en-us/library/ff649313)

如果不是 AD，您可以实现自己的 MembershipProvider：http: [//msdn.microsoft.com/en-us/library/f1kyba5e.aspx](http://msdn.microsoft.com/en-us/library/f1kyba5e.aspx)

最好在可能的地方使用框架，并且只在必要时使用自己的代码。

# ruby - 在 ruby 、windows 中录制声音

> ID：11570865
> 
> 赞同：1
> 
> 时间：2012-07-19T23:39:13.063
> 
> 标签：ruby, audio, record, microphone

我想知道如何在 ruby​​、windows xp 或 7 中从麦克风录制声音

用于检测音高

谷歌“红宝石录音”，“红宝石录音”

没有给我任何答案

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T23:47:51.540

我没用过，但是这里有一个 ruby​​-PortAudio 包装[器](https://github.com/jvoorhis/ruby-portaudio)。

这是[PortAudio API](http://www.portaudio.com/)的站点。

希望有帮助！

# php - 创建订阅功能（链接多个表？）？

> ID：11570866
> 
> 赞同：1
> 
> 时间：2012-07-19T23:39:23.330
> 
> 标签：php, mysql, sql

我目前有 3 个 sql 表“新闻”“内容”和“用户”。我在这里尝试实现的是订阅/关注功能，该功能允许用户关注“内容”表中列出的任何内容，然后在将有关该内容的新闻添加到“新闻表”时接收通知。我需要以某种方式链接 2 个表格“内容”和“新闻”吗？除了我目前没有任何想法。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T04:54:24.903

`TRIGGER`在`news`桌子上使用 a 。触发动作将执行`JOIN`查找关注相关内容的用户。

# javascript - 如何自动点击确认框？

> ID：11570868
> 
> 赞同：14
> 
> 时间：2012-07-19T23:39:40.383
> 
> 标签：javascript, greasemonkey, confirm

我的脚本单击站点上的图像。该图像有一个锚点`href`和一个`onclick` `href`，但 onclick href 有一个确认框，一旦单击它就会弹出。
onclick HTML 是：

```
onClick="this.href='link2';if (!confirm('Are you sure?')) { return false; } 
```

一旦弹出，我如何让脚本在该确认框中单击“***确定”？***

我正在使用此功能单击图片链接：

```
function click(elm) {
 var evt = document.createEvent('MouseEvents');
 evt.initMouseEvent('click', true, true, window, 0, 1, 1, 1, 1, false, false, false, false, 0, null);
 elm.dispatchEvent(evt);
}
click(picture element) 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-07-20T07:47:21.817

您可以覆盖该`confirm`方法以暂时使其静音并返回`true`。下面的示例只会使确认对话框静音一次，并且仅在它被调用时。一旦执行了静音对话框，它将恢复其原始功能，随后对`confirm`方法的调用将正常工作。

```
var realConfirm=window.confirm;
window.confirm=function(){
  window.confirm=realConfirm;
  return true;
};
click(picture element); 
```

# .htaccess - URL 重写检查静态文件，然后重写为 index.php

> ID：11570869
> 
> 赞同：1
> 
> 时间：2012-07-19T23:39:51.200
> 
> 标签：.htaccess, mod-rewrite, redirect

好的，我对 .htaccess 文件中的重写规则感到厌烦！

我想要的场景是（以 URL`http://doma.in/`为例）：

*   首先检查子目录中是否`index.html`存在文件；`/public`如果是的话，服务它
    *   如果没有；服务（重写）`index.php`

为了扩展我的示例，假设我们请求了 URL `http://doma.in/js/foobar.js`：

*   首先检查子目录中是否`foobar.js`存在文件；`/public/js`如果是的话，服务它
    *   如果没有；服务（重写）`index.php?controller=js%2Ffoobar.js`

这将涵盖静态文件，但我还需要以下 URL `http://doma.in/foo`：

*   首先检查子目录中是否`foo`存在文件；`/public`如果是的话，服务它
    *   如果没有；服务（重写）`index.php?controller=foo`

和一个网址`http://doma.in/foo/bar`：

*   我们可以假设该文件`foo/bar`不存在于`/public`子目录中，因为文件不能这样命名。
    *   所以服务（重写）`index.php?controller=foo&action=bar`

我确定如果这个复杂的（对我来说）位被涵盖，那么我也可以在这个场合使用查询字符串；所以`http://doma.in/foo/bar/foo/bar`会服务`index.php?controller=foo&action=bar&querystring=foo%2Fbar`。

我还想确保尾部斜杠的处理方式与省略尾部斜杠相同，例如：`http://doma.in/foo/bar/foo/bar`和`http://doma.in/foo/bar/foo/bar/`

我将在我的应用程序中处理 404，就好像该文件不存在一样，它会重定向到`index.php`确实存在的文件 - 除非您有更好的解决方案，否则我对此很满意 :)

我真的希望这一切都有意义，因为我整天都在寻找解决这种情况的方法，这就是我所拥有的：

```
Options +FollowSymLinks

RewriteEngine on

RewriteBase /

#RewriteBase /prompt-v3/
#RewriteCond %{REQUEST_URI} ^/prompt-v3/(.*)$

RewriteCond $1 !^public
RewriteRule ^(.*)$ public/$1 [R] 
```

注释掉的行在远程主机上处理子目录。到目前为止，`/public`如果文件存在，我可以重定向到子目录，仅此而已。

谢谢你们每一个人的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T13:30:13.443

```
Options +FollowSymLinks

RewriteEngine on

RewriteBase /
#RewriteBase /sub-dir/
#RewriteCond %{REQUEST_URI} ^/sub-dir/(.*)$

RewriteRule ^index.html$ $1 [L,R=301]

RewriteCond $1 !^public
RewriteCond $1 !^lib
RewriteRule ^(.*)$ public/$1 [L]

RewriteCond $1 ^public/$
RewriteCond %{REQUEST_FILENAME}/index.html !-f
RewriteRule ^(.*)$ lib/bootstrap.php [L]

RewriteCond $1 !^public/$
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond $1 ^public/(.*)$
RewriteRule ^(.*)$ lib/bootstrap.php?path=%1 [L] 
```

这将在公共目录中查找 index.html 文件，如果不存在，则将 URL 重写为 lib/bootstrap.php。实际上，它首先将任何请求作为公共目录中的静态文件进行检查，并且也处理规范化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T06:39:08.167

将此 .htaccess 放在您的文档根目录中

```
<ifModule mod_rewrite.c>
  RewriteEngine on

  # For /js/foobar.js (/js/*)
  RewriteRule ^js/(.*)$ /public/js/$1 [NC]
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteRule ^public/(.*)$ index.php?controller=$1  [NC,L]

  # For foo/bar (/*/*?*)
  RewriteRule ^(.*)/(.*)$ /public/$1/$2 [NC]
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteRule ^public/(.*)/(.*)$ index.php?controller=$1&action=$2&querystring=%{QUERY_STRING}  [NC,L]
</IfModule> 
```

# cassandra - 部分复合键上的 Cassandra-secondary 索引？

> ID：11570871
> 
> 赞同：1
> 
> 时间：2012-07-19T23:39:57.417
> 
> 标签：cassandra, secondary-indexes

我正在使用由 2 个字符串 Name1、Name2 和时间戳组成的复合主键（例如，'Joe:Smith:123456'）。我想查询给定相等条件的时间戳范围`Name1`或`Name2`。

例如，在 SQL 中：

`SELECT * FROM testcf WHERE (timestamp > 111111 AND timestamp < 222222 and Name2 = 'Brown');`

和

`SELECT * FROM testcf WHERE (timestamp > 111111 AND timestamp < 222222 and Name1 = 'Charlie);`

据我了解，复合键的第一部分是分区键，所以第二个查询是可能的，但第一个查询需要 Name2 上的某种索引。

是否可以在复合键的组件上创建单独的索引？或者我在这里误解了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T20:06:03.253

如果要使用架构并支持第一个查询，则需要手动创建和维护名称索引。鉴于此要求，我质疑您在数据模型中的选择。您的模型在设计时应考虑到您的阅读模式。我认为您还存储了一些列值，您希望通过时间戳查询这些值。如果是这样，也许以下模型会更好地为您服务：

```
"[current_day]:Joe:Smith" {
    123456:Field1 : value
    123456:Field2 : value
    123450:Field1 : value
    123450:Field2 : value
} 
```

使用此模型，您可以使用当前日期（或某个已知日期）作为标记值，​​然后过滤名字和姓氏。您还可以使用复合列名称按时间戳获取一系列列。

# c# - 从 xyz 坐标数组写入图像文件

> ID：11570874
> 
> 赞同：0
> 
> 时间：2012-07-19T23:40:18.697
> 
> 标签：c#, image, fractals

我目前正在使用 C# 开发分形生成器，并且正在尝试将我的一组坐标导出到一个非常简单的图像文件中。

我拥有的是一个 3d 点（x、y 和 z 坐标）的一维数组，我希望将其保存到 z 值将是像素颜色（仅限灰度）的图像中。

从我收集到的信息来看，RAW 格式是最容易使用的，但即便如此我也找不到关于它的文档。然后我查看了命名空间 System.Drawing，但我迷失了方向，这对于我想要实现的目标来说似乎过于复杂。

有没有一种简单的方法可以写出这样的图像？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T23:50:34.627

此链接应有助于解释如何逐像素创建图像：

[http://msdn.microsoft.com/en-us/library/system.drawing.image%28v=vs.80%29.aspx](http://msdn.microsoft.com/en-us/library/system.drawing.image%28v=vs.80%29.aspx)

那么您应该能够使用 image1.Save 与文件位置的字符串参数。

如果您只想在 winform 上显示它，那么您可以保留链接中的原始源代码。

您可以创建一个新图像，而不是像这样加载一个：

```
System.Drawing.Bitmap myMap = new System.Drawing.Bitmap(200,300); //200x300 pixels 
```

# javascript - PhoneGap 脚本正确读取联系人，直到我包含照片（头像）

> ID：11570883
> 
> 赞同：1
> 
> 时间：2012-07-19T23:40:57.480
> 
> 标签：javascript, jquery, ios, cordova

以下脚本应该返回联系人列表以及他们的电子邮件、电话号码和头像（照片​​）。

它就像一个魅力，当我删除头像（照片​​）检索代码时，我将它添加回来。脚本中断。有没有人有任何尝试通过 phonegap 显示联系人照片的经验？

```
<!DOCTYPE html>
<html>
<head>
<title>Contact Example</title>
<script type="text/javascript" src="jquery-1.7.2.min.js"></script>
    <script type="text/javascript" charset="utf-8" src="cordova-1.9.0.js"></script>
    <script type="text/javascript" charset="utf-8">

        // Wait for Cordova to load
        //
        document.addEventListener("deviceready", onDeviceReady, false);

        // Cordova is ready
        //
        function onDeviceReady() {
            // specify contact search criteria
            var options = new ContactFindOptions();
            options.filter="";          // empty search string returns all contacts
            options.multiple=true;      // return multiple results
            filter = ["displayName", "name", "phoneNumbers"];

            // find contacts
            navigator.contacts.find(filter, onSuccess, onError, options);
        }

        // onSuccess: Get a snapshot of the current contacts
        //
        function onSuccess(contacts) {
            console.log(contacts.length);
            for (var i=0; i<contacts.length; i++) {
                var LI=$("#list").append('<li>'+contacts[i].displayName+'</li>');
                if (contacts[i].phoneNumbers) {
                    for (var j=0; j<contacts[i].phoneNumbers.length; j++) {
                        $(LI).append('<span>'+contacts[i].phoneNumbers[j].value+'</span><Br/>');
                    }
                }
                if (contacts[i].emails) {
                    for (var j=0; j<contacts[i].emails.length; j++) {
                        $(LI).append('<span>'+contacts[i].emails[j].value+'</span><br/>');
                    }
                }
                if (contacts[i].photos) {
                    for (var j=0; j<contacts[i].photos.length; j++) {
                        alert(contacts[i].photos[j].value);
                        //$(LI).append('<span>'+contacts[i].photos[j].value+'</span><br/>');
                    }
                }
                /*if (contacts[i].photos) {
                    for (var j=0; j<contacts[i].photos.length; j++) {
                        $(LI).append('<img src="'+contacts[i].photos[j].value+'"/><br/>');
                    }
                }*/
            }
        };

        // onError: Failed to get the contacts
        //
        function onError(contactError) {
            alert('onError!');
        }

    </script>
</head>
<body>
    <h1>Example</h1>
    <p>All Contacts in a list</p>
    <ul id="list">
    </ul>
</body> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-21T15:31:54.600

您的过滤器不包括“照片”字段。如果没有指定，则不会填充照片数组。

# php - uploadify.php 中的explode() 有问题

> ID：11570885
> 
> 赞同：1
> 
> 时间：2012-07-19T23:41:02.003
> 
> 标签：php, uploadify, explode

我的uploadify.php中有这个片段：

```
if (!empty($_FILES)) {
$name = $_FILES['Filedata']['name'];

$tempFile = $_FILES['Filedata']['tmp_name'];
$targetPath = $targetFolder;
$targetFile = rtrim($targetPath,'/') . '/' . $_FILES['Filedata']['name'];

$path = pathinfo($targetFile);

// this portion here will be true if and only if the file name of the uploaded file does not contain '.', except of course the dot(.) before the file extension
$count = 1;
list( $filename, $ext) = explode( '.', $name, );
$newTargetFile = $targetFolder . $filename . '.' . $ext;
while( file_exists( $newTargetFile)) {
    $newTargetFile = $targetFolder . $filename . '(' . ++$count . ')' . '.' . $ext;
}

// Validate the file type
$fileTypes = array('pdf'); // File extensions
$fileParts = pathinfo($_FILES['Filedata']['name']);

if (in_array($fileParts['extension'],$fileTypes)) {
    move_uploaded_file($tempFile,$newTargetFile);
    echo $newTargetFile;
} else {
    echo 'Invalid file type.';
}
return $newTargetFile;
} 
```

基本上这是相当有效的。上传文件并获取文件的路径，然后将其插入数据库等。但是，我尝试上传一个文件名看起来像这样的文件，

```
filename.1.5.3.pdf 
```

上传成功后，文件名就变成`filename`了单独的，没有文件扩展名，更不用说文件名不完整。据我了解，问题出在我的explode() 上。它分解了具有分隔符的字符串，`'.'`然后将其分配给变量。我将如何将`explode()`字符串切成两半，其中前半部分是文件名，第二部分是文件扩展名？请帮忙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T23:44:00.743

不要使用explode，使用专为工作设计的函数：[pathinfo()](http://php.net/manual/en/function.pathinfo.php)

```
$ext = pathinfo($_FILES['Filedata']['name'], PATHINFO_EXTENSION); 
```

# bash - 为什么 2>&1 需要在 | 之前 （管道）但在“> myfile”之后（重定向到文件）？

> ID：11570886
> 
> 赞同：14
> 
> 时间：2012-07-19T23:41:03.397
> 
> 标签：bash, shell, pipe, stdout, pipeline

将 stderr 与 stdout 结合使用时，为什么`2>&1`需要在`|`（管道）之前但在`> myfile`（重定向到文件）之后？

要将 stderr 重定向到 stdout 以进行文件输出：

```
 echo > myfile 2>&1 
```

将 stderr 重定向到管道的标准输出：

```
 echo 2>&1 | less 
```

我的假设是我可以这样做：

```
 echo | less 2>&1 
```

它会起作用，但它不会。为什么不？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-07-20T00:05:05.643

*管道*是 | 分隔的命令*列表*。您指定的任何重定向都适用于组成命令（简单或复合），但不适用于整个管道。每个管道通过在评估与命令关联的任何重定向*之前*对每个子shell 隐式应用重定向，将一个命令的标准输出链接到下一个命令的标准输入。

```
cmd 2>&1 | less 
```

第一个子外壳的第一个标准输出被重定向到`less`正在读取的管道。接下来，将`2>&1`重定向应用于第一个命令。将 stderr 重定向到 stdout 是可行的，因为 stdout 已经指向管道。

```
cmd | less 2>&1 
```

在这里，重定向适用于`less`. Less 的 stdout 和 stderr 可能都开始指向终端，所以`2>&1`在这种情况下没有效果。

如果要将重定向应用于整个管道、将多个命令分组为管道的一部分或嵌套管道，请使用命令组（或任何其他*复合命令*）：

```
{ { cmd1 >&3; cmd2; } 2>&1 | cmd3; } 3>&2 
```

可能是一个典型的例子。最终结果是：`cmd1`and`cmd2`的 stderr -> `cmd3`; `cmd2`的标准输出 -> `cmd3`; and的 stderr 和`cmd1`的stdout -> 终端。`cmd3``cmd3`

如果您使用 Bash 特定的`|&`管道，事情就会变得奇怪，因为每个管道的标准输出重定向仍然首先发生，但标准错误重定向实际上是最后发生的。例如：

```
f() { echo out; echo err >&2; }; f >/dev/null |& cat 
```

现在，与直觉相反，所有输出都被隐藏了。第一个 stdout`f`进入管道，下一个 stdout`f`被重定向到`/dev/null`，最后，stderr 被重定向到 stdout （`/dev/null`仍然）。

我建议永远不要`|&`在 Bash 中使用——它在这里用于演示。

*   [许多强制性的重定向链接](http://mywiki.wooledge.org/Redirection)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-20T00:33:55.887

要添加到 ormaaj 的答案：

您需要以正确的顺序指定重定向运算符的原因是它们是从左到右进行评估的。考虑这些命令列表：

```
# print "hello" on stdout and "world" on stderr
{ echo hello; echo world >&2; }

# Redirect stdout to the file "out"
# Then redirect stderr to the file "err"
{ echo hello; echo world >&2; } > out 2> err

# Redirect stdout to the file "out"
# Then redirect stderr to the (already redirected) stdout
# Result: all output is stored in "out"
{ echo hello; echo world >&2; } > out 2>&1

# Redirect stderr to the current stdout
# Then redirect stdout to the file "out"
# Result: "world" is displayed, and "hello" is stored in "out"
{ echo hello; echo world >&2; } 2>&1 > out 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-21T11:27:18.307

我的答案是理解文件描述符。每个进程都有一堆文件描述符：打开的文件的条目。默认情况下，数字 0 用于标准输入，数字 1 用于标准输出，数字 2 用于标准错误。

i/o 重定向器 > 和 < 默认情况下连接到它们最合理的文件描述符，stout 和 stdin。如果您将 stdout 重新路由到文件（如`foo > bar`），则在启动进程“foo”时，打开文件“bar”以进行写入并连接到文件描述符编号 1。如果您只希望“bar”中的 stderr，您d 使用`foo 2> bar`which 打开文件栏并将其连接到标准错误。

现在是 i/o 重定向器 '2>&1'。我通常将其读作'将文件描述符 2 与文件描述符 1 相同。从左到右读取命令行时，您可以执行以下操作：`foo 1>bar 2>&1 1>/dev/tty`. 这样，文件描述符 1 设置为文件“bar”，文件描述符 2 设置为与 1 相同（因此为“bar”），之后，文件描述符 1 设置为 /dev/tty。运行将`foo`其输出发送到 /dev/tty 并将其 stderr 发送到文件“bar”。

现在管道进来了：这不会改变文件描述符，但是，它将在进程之间连接它们：左进程的标准输出和下一个进程的标准输入。Stderr 被传递。因此，如果您希望管道仅在 stderr 上工作，您可以使用`foo 2| bar`，它将 stderr of 连接`foo`到 stdin of `bar`。（我不确定 . 的标准输出会发生什么`foo`。）

有了上面，如果你使用`foo 2>&1 | bar`，由于 stderr`foo`被重新路由到 stdout `foo`， stdout 和 stderr 都`foo`到达`bar`.

# php - Zend_Form_Element_Select 默认值

> ID：11570888
> 
> 赞同：1
> 
> 时间：2012-07-19T23:41:24.023
> 
> 标签：php, zend-framework

在我的表单中，我想为选择元素设置选定的（默认）值。但是，使用`setDefaults`对我不起作用。

这是我的代码：

```
$gender = new Zend_Form_Element_Select('sltGender');
$gender->setMultiOptions(array(
    -1 => 'Gender',
    0 => 'Female',
    1 => 'Male'
))
->addValidator(new Zend_Validate_Int(), false)
->addValidator(new Zend_Validate_GreaterThan(-1), false);

$this->setDefaults(array(
    'sltGender' => 0
));

$this->addElement($gender); 
```

我的控制器只是将表单分配给仅显示表单的视图变量。

它通过使用来工作`$gender->setValue(0)`，但使用一组默认值一次设置它们会更容易。我在这里误解了什么吗？

另外，关于类和方法的 Zend Framework 文档在哪里？我正在寻找类似于[Java 文档](http://docs.oracle.com/javase/6/docs/api/)的内容。我能找到的最好的是[这个](http://framework.zend.com/apidoc/core/)，但我不喜欢它——尤其是因为每次我尝试搜索时，它都会崩溃。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-20T00:08:03.660

你有没有尝试过：

```
$this->addElement($gender);

$this->setDefaults(array(
    'sltGender' => 0
)); 
```

另外，请查看[http://framework.zend.com/issues/browse/ZF-12021](http://framework.zend.com/issues/browse/ZF-12021)。

如您所见，上述问题与您描述的问题相似。Zend 似乎对创建对象和分配设置的顺序*非常*讲究。

恐怕你将不得不按照 Zend 想要你做的顺序做事（这似乎没有很好的文档记录，但只有通过反复试验才能发现），或者破解他们的库来让它做什么你想让它做。

# windows - Windows CLI 相当于 Linux 小于符号？

> ID：11570892
> 
> 赞同：0
> 
> 时间：2012-07-19T23:42:07.620
> 
> 标签：windows, linux, powershell, command-line-interface

这是我的第一篇文章，我已经很抱歉，因为这可能是一个太简单的问题。我开始自学 SQL，我正在遵循的超级指南 (http://sql.learncodethehardway.org) 在我尝试在 Windows PC 上学习时使用 linux 命令。

作者使用 linux 命令 < 将输入从右侧的文本文件发送到左侧的程序。Windows PowerShell 中是否有与此命令等效的命令？我用谷歌搜索了它，并在这里尽可能多地搜索，但找不到答案。

感谢你的协助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T23:48:51.870

```
cat c:\temp\q.txt | bla-bla-program 
```

# apache - 在 .htaccess 中使用 ErrorDocument 时出现 XAMPP 错误

> ID：11570893
> 
> 赞同：2
> 
> 时间：2012-07-19T23:42:10.770
> 
> 标签：apache, .htaccess, xampp, http-status-code-404, errordocument

我正在为我制作的短网址系统使用 .htaccess 文件。它应该使用文件 sudir.php 来查找输入的“代码”所针对的 url。但是每当我转到`http://localhost/shorturl/t10m3S`不存在的页面时，它应该使用 sudir.php 进行重定向，但它只会将我带到一个通用的“未找到”页面。

这就是我的`.htaccess`：

> 错误文档 404 /shorturl/sudir.php

如果我将其更改为我的`phptesting`文件夹，它会显示该文件夹的索引。如果我将它更改为仅`shorturl`文件夹，它仍然会给我一般的 404 错误页面。如果我完全删除它，它会显示 Apache 的默认页面。所以它基本上看起来像 Apache 或`.htaccess`其他东西不知道该`shorturl`文件夹存在，即使我可以访问它并且它可以工作。看来我只需要它确认文件夹在那里并实际加载`sudir.php`文件，但我不知道该怎么做。

附加信息：
我正在使用`.htaccess`不同目录中的文件来重定向到 YouTube 页面，就像它的工作原理一样`youtu.be`，它工作得非常好。虽然一开始我确实遇到了同样的问题，但我只是重命名了它所在的文件夹并将其更改`.htaccess`为对应，然后它就开始工作了。我已经尝试过相同的方法`shorturl`，但它没有用。

# jquery - 保持缩小表示和真实世界数据之间的一致性？

> ID：11570901
> 
> 赞同：0
> 
> 时间：2012-07-19T23:42:39.997
> 
> 标签：jquery, html, css, graph, web

我继承了一个用 jQuery 编写的项目，该项目允许用户将项目（可拖动的 div）拖放到页面（更大的 div）上。页面可拖动并可调整大小，项目可以自由放置或相互对齐以及页面边缘。项目不能悬在页面边缘或重叠。

创建这些项目的数据是从另一个程序中读入的。每个项目都有一个“真实的”整数宽度和高度，单位为 1/10 毫米。为了创建代表这些项目的 div，这些“真实单位”使用缩放因子转换为像素（目前为 50%，我们希望在未来使其动态化，以便用户可以放大和缩小）。

当用户对页面上项目的放置感到满意时，他们可以导出他们的设计。项目相对于页面左上角的 x,y 像素位置使用相同的缩放因子转换回“实际单位”。

项目需要捕捉到 5x5 实际单位 (0.5mm) 网格。显然这是不可能的，因为 5 个实际单位 = 2.5px，尽管我们希望它能够在不考虑比例因子的情况下工作。

在真实单位和像素之间来回切换的最简单方法是什么，确保真实单位始终在网格上，同时保持像素表示一致？这可以在仍然依靠 jQuery 可拖动/可拖放/可调整大小的类的同时完成，还是我最好重写整个事情？

# html - 为什么流浪 结束标签生成一个空段落？

> ID：11570902
> 
> 赞同：26
> 
> 时间：2012-07-19T23:42:41.493
> 
> 标签：html, dom, syntax, html-parsing

显然，如果您`</p>`的元素中有一个结束标签而没有匹配的开始标签`body`，那么大多数（如果不是所有）浏览器都会在其位置生成一个空段落：

```
<!DOCTYPE html>
<title></title>
<body>
</p>
</body> 
```

即使结束标记周围存在任何文本，也不会成为该`p`元素的一部分——它将始终为空，并且文本节点将始终独立存在：

```
<!DOCTYPE html>
<title></title>
<body>
some text</p>more text
</body> 
```

如果上面的内容`body`被包裹在`<p>`和`</p>`标签中......我会让你猜会发生什么：

```
<!DOCTYPE html>
<title></title>
<body>
<p>some text</p>more text</p>
</body> 
```

有趣的是，如果`</p>`标签前面没有 a `<body>`or`</body>`标签，除了 IE9 和更早版本的所有浏览器都*不会*生成一个空段落（另一方面，IE ≤ 9 将始终创建一个，而 IE10 和更高版本的行为与所有其他浏览器相同） ：

```
<!DOCTYPE html>
<title></title>
</p> 
```

```
<!DOCTYPE html>
<title></title>
</p><body> 
```

```
<!DOCTYPE html>
<title></title>
</p></body> 
```

我找不到任何引用规定没有相应开始标记的结束标记应该生成一个空元素，但考虑到它甚至不是有效的 HTML，这不应该让人感到惊讶。确实，我只发现浏览器可以对`p`元素执行此操作（在某种程度上，`br`元素也是如此！），但没有任何解释为什么。

在使用传统 HTML 解析器和 HTML5 解析器的浏览器中，它是相当一致的，但是，在 quirks 模式和标准模式下都应用。因此，可以推断这是为了向后兼容早期规范或遗留行为。

事实上，我确实在[一个有点相关的问题](https://stackoverflow.com/questions/5187113/why-the-html-paragraph-p-behaves-so-oddly-on-my-chrome)的答案上找到[了这条评论](https://stackoverflow.com/posts/comments/5830613)，这基本上证实了这一点：

> <p> 标签有效未封闭的原因是，最初 <p> 被定义为“新段落”标记，而不是 p 是容器元素。相当于 <br> 是一个“新行”标记。您可以在 1992 年的这份文件中看到这样的定义：http: [//www.w3.org/History/19921103-hypertext/hypertext/WWW/MarkUp/Tags.html](http://www.w3.org/History/19921103-hypertext/hypertext/WWW/MarkUp/Tags.html)和 1993 年的这份文件：[http://www.w3。 org/MarkUp/draft-ietf-iiir-html-01.txt](http://www.w3.org/MarkUp/draft-ietf-iiir-html-01.txt)因为在更改之前有网页，并且浏览器解析器总是尽可能向后兼容现有的网页内容，所以总是可以使用 <p>那样。

但这并不能完全解释为什么解析器将显式`</p>`结束标记（带有斜杠）简单地视为......一个标记，并在 DOM 中生成一个空元素。[当语法没有像最近](http://www.w3.org/TR/REC-html32#para) 那样严格定义时，这是否是某些解析器错误处理约定的[一部分](http://www.w3.org/TR/html401/struct/text.html#edef-P)？如果是这样，它是否记录在任何地方？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-07-19T23:53:07.640

*它*是必需的，记录在 HTML5 中。请参阅[http://w3c.github.io/html/syntax.html#the-in-body-insertion-mode](http://w3c.github.io/html/syntax.html#the-in-body-insertion-mode)并向下搜索`An end tag whose tag name is "p"`它说：

> 如果打开元素的堆栈没有按钮范围内的元素与令牌的标签名称相同，那么这是一个解析错误；就好像已经看到了一个带有标签名称“p”的开始标签，然后重新处理当前令牌。

翻译成英文意味着如果标签无法与现有标签匹配，则创建一个`p`元素。`</p>``<p>`

*为什么*会这样，更难确定。通常，这是因为过去某些浏览器导致这种情况发生为错误，并且网页开始依赖该行为，因此其他浏览器也必须实现它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-18T17:17:00.110

[HTML4 DTD](http://www.w3.org/TR/html4/sgml/dtd.html)声明结束标记对于段落元素是可选的，但开始标记是必需的。

HTML4的[SGML 声明声明](http://www.w3.org/TR/html4/sgml/sgmldecl.html)[omittag](http://www.webdevout.net/tidings/2006/09/11/shorttag-and-omittag/)为“是”，这意味着可以隐含开始标记。

结束标签遵循[SGML](http://www.w3.org/TR/html4/intro/sgmltut.html#h-3.2.1)规则：

> 结束标签关闭，回到匹配的开始标签，所有未闭合的中间开始标签都省略了结束标签

[匿名块框](http://www.w3.org/TR/CSS2/visuren.html#anonymous-block-level)是为文本节点等内联元素生成的，因此它们不需要被段落元素包裹。

Mozilla bug 数据库中有一个线程解释了这种行为：

*   [Mozilla轻信解析“半标签”，导致XSS安全问题](https://bugzilla.mozilla.org/show_bug.cgi?id=226495)

[这是Boris Zbarsky](https://stackoverflow.com/users/720912/boris-zbarsky)的相关评论：

> 实际上，据我了解，正确解析 SGML/HTML*要求*我们这样做。也就是说，下一个标签的“<”是关闭前一个标签的标记的有效方法......

[并由Ian Hickson](http://ln.hixie.ch/?start=1037910467)总结：

> 看来，这里的基本原理是通过延迟任何关闭标记来修复标记，直到所有其他打开的元素都关闭之后，并且不尝试使 DOM 遵循 HTML DTD。

**参考**

*   [SGML 制作](http://www.w3.org/MarkUp/SGML/productions.html)

*   [HTML 2.0 规范](http://www.w3.org/MarkUp/1995-archive/html-spec.html)

*   [反对 SGML 的论据](http://xml.coverpages.org/naggumAgainstSGML.html)

*   [标签汤：UA如何处理](http://ln.hixie.ch/?start=1037910467)

*   [标签汤：Mac IE 5 和 Safari 如何处理](https://hsivonen.fi/soup-dom/)

*   [Web SGML 和 HTML 4.0 解释](http://www.is-thought.co.uk/book/sgml-9.htm)

*   [跨浏览器测试 SGML SHORTTAG 支持](http://kangax.github.io/jstests/shorttag_test/)

*   [Mozilla 错误 226495](https://bugzilla.mozilla.org/show_bug.cgi?id=226495)

*   [短标签和省略标签](http://www.webdevout.net/tidings/2006/09/11/shorttag-and-omittag/)

*   [记录 SGML 系列文档语言的解析器：SGML、HTML、XML](http://broadcast.oreilly.com/print/37844.html)

*   [XML 的简短而固执的历史 - bobdc.blog](http://www.snee.com/bobdc.blog/2012/01/a-brief-opinionated-history-of.html)

# json - WinRT 序列化 DateTimeOffset

> ID：11570903
> 
> 赞同：0
> 
> 时间：2012-07-19T23:42:46.933
> 
> 标签：json, serialization, windows-runtime

我正在开发一个引用 ac# WinRT 项目的 Windows 8 Metro 应用程序。除其他外，c# 项目向 Azure 服务发出 Web 请求，以对 SQL Azure 数据库执行 CRUD 操作。

在服务上执行 POST 操作时，我正在序列化一个类的实例并将其放入请求的正文中。

```
public sealed class Foo
{
    int FooId { get; set; }
    DateTimeOffset FooDate { get; set; }
} 
```

当它使用 序列化时`DataContractJSONSerializer`，结果是这样的：

```
{"FooId":1,"FooDate":{"DateTime":"/Date(1342732970000)/","OffsetMinutes":-420}} 
```

仅供参考，这是 2012 年 7 月 19 日下午 2:22:50 -07:00。

好的，太好了......唯一的问题是 Azure 服务只需要一个`DateTime`，而不是一个`DateTimeOffset`. 我不拥有 Azure 服务，因此无法更改其行为。

所以（忽略我正在丢失偏移量）我需要的是序列化为：

```
{"FooId":1,"FooDate":"/Date(1342732970)/"} 
```

我的第一种方法是使用返回部分的`DateTime`getter 向类添加一个新的别名属性/数据成员。但是，WinRT 不支持 DateTime 类型。`DateTime``DateTimeOffset`

有几种 hacky 方法可以解决这个问题，但我想看看是否有一种优雅的方法可以做到这一点，然后再诉诸其中一种：

*   POST前序列化结果的正则表达式
*   返回 JSON 格式日期的类的字符串属性

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T21:34:14.613

我最终在类上实现了一个属性，它使用了一个适当地格式化日期的 getter。

我用 IgnoreDataMember 属性修饰了 Foo 字段，以便在序列化过程中忽略它。然后我添加了一个新字段，并为其赋予了 Foo 的别名以进行序列化。

谢谢

# vb6 - Windows 2003 R2 上的 Vb6 组件不会注册

> ID：11570904
> 
> 赞同：2
> 
> 时间：2012-07-19T23:42:51.020
> 
> 标签：vb6, 64-bit

我正在尝试在 Windows Server 2003 Standard x64 R2 上部署一些 Vb6 组件。我通常在 com+ 应用程序中运行这些程序，然后完成创建 COM+ 应用程序和添加所有组件的常规程序。在我真正尝试使用任何组件之前，一切似乎都运行良好。我会出现某种“ActiveX 组件无法创建对象”或“应用程序定义或对象定义错误”或类似的东西。

为了尽可能多地删除变量，我创建了一个非常简单的 VB 表单来使用最简单的组件并进行了尝试。没有。所以我创建了一个简单的安装来安装组件，并且它工作正常。所以我尝试了一个寄予厚望的更复杂的组件......但是安装后我仍然无法成功调用该组件。使用 Dependency Walker 我发现由于某种原因 msvbvm60.dll 没有正确注册。

我已经下载了 VBRUN60.exe 和 VBRUN60SP6.exe 并尝试安装它们。甚至以管理员帐户运行并删除“以受限访问权限运行此程序”的复选框。我尝试在 SysWow64 目录中手动注册 msvbvm60.dll。

似乎没有任何效果。它只是不会注册。有人有什么建议吗？在这一点上，我会尝试任何事情。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-14T11:00:58.260

我在使用 Visual Basic 6 的未注册组件时遇到了麻烦——尽管没有尝试使用与您提到的相同的组件。无论使用哪个注册服务器，手动注册都无法解决问题

问题（最终）原来是 Internet Explorer 10。卸载它（由于 Windows 7 将 IE 处理为 Windows 更新的方式，这意味着首先卸载新版本以公开旧版本）有效。之后，重新安装最新的 IE 没有问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T10:09:57.307

如果您手动注册组件，则需要格外注意。由于您使用的是 64 位操作系统，因此有两个版本的 regsvr32.exe。注册 VB6 组件时，您必须确保使用 regsvr32 的 32 位版本，该版本位于以下位置：

```
%WINDIR%\SysWOW64\regsvr32.exe 
```

如果您只是在命令提示符下键入 regsvr32，通常会选择 64 位版本（因为 %PATH% 环境变量中包含 %WINDIR%\system32），因此请确保使用上述完整路径。

如果您使用 32 位 MSI 安装组件，将自动选择此版本，并且注册应该可以正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-24T11:53:31.360

如果您还没有这样做，您应该尝试一下[Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx) - 我在 dll 注册问题上使用过的最好的工具之一。

以下链接将提供一些常用的线索：

*   [使用 Process Monitor 解决问题](http://blogs.technet.com/b/appv/archive/2008/01/24/process-monitor-hands-on-labs-and-examples.aspx)的优秀教程；
*   [ActiveX 组件无法创建对象](https://stackoverflow.com/questions/1880867/activex-component-cant-create-an-object)

*   [解决！ActiveX 组件无法创建对象：针对 SQL Server 2005 Analysis Services 的多维数据集构建失败](http://blogs.msdn.com/b/brismith/archive/2007/03/09/activex-component-can-t-create-object-cube-build-failure-against-sql-server-2005-analysis-services.aspx)

希望它有所帮助：D

# c - C中的字符串搜索和格式化

> ID：11570909
> 
> 赞同：1
> 
> 时间：2012-07-19T23:43:34.220
> 
> 标签：c, string, search, buffer

一个快速的：在 CI 中有一个充满数据的缓冲区，如下所示：

```
char buffer[255]="CODE=12345-MODE-12453-CODE1-12355" 
```

我的问题是如何搜索这个。例如，对于`CODE=12345`, 部分，请记住数字会发生变化，因此我想`CODE=*****`使用通配符或在`CODE=`部分后预设数量的空格进行搜索。

此方法不会编译最后一个尝试

```
#include <stdio.h>
#include <string.h>
#include <windows.h>

int main ()
{
    char buf[255]="CODE=12345-MODE-12453-CODE1-12355";

#define TRIMSPACES(p) while(*p != '\0' && isspace((unsigned char)*p) != 0) ++p 
#define NSTRIP(p, n) p += n 
#define STRIP(p) ++p 

char* getcode(const char *input) 
{ 
  char *p = (char*) input, *buf, *pbuf; 

  if((buf = malloc(256)) == NULL) 
    return NULL; 

  pbuf = buf; 
  while(*p != '\0') { 
    if(strncmp(p, "CODE", 3) == 0) { 
      NSTRIP(p, 4); //remove 'code' 
      TRIMSPACES(p);//trim white-space after 'code' 

     if(*p != '=')  
       return NULL; 

      STRIP(p); // remove '=' 
      TRIMSPACES(p); //trim white-spaces after '=' 

/* copy the value until found a '-'  
   note: you must be control the size of it,  
   for avoid overflow. we allocated size, that's 256 
   or do subsequent calls to realloc() 
*/ 
      while(*p != '\0' && *p != '-') 
    *pbuf ++ = *p++; 

    //  break; 
    } 
    p ++; 
  } 

//put 0-terminator. 
  *pbuf ++ = '\0'; 

  return buf; 
} 

//   
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T23:49:01.827

您可以使用 sscanf() 函数：

```
int number;
sscanf(buffer, "CODE = %i", &number); 
```

为了使其正常工作，您的缓冲区必须以空值终止。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-20T00:34:55.530

另一种方法来代替`sscanf()`：

```
 char *input, *code;

  input = strstr(buf, "CODE");
  if(input == NULL) {
    printf("Not found CODE=\n");
    return -1;
  }

  code = strtok(strdup(input), "=");
  if(code != NULL) {
    code = strtok(NULL, "-");
    printf("%s\n", code); // code = atoi(code);
  } else {
    //not found '='
  } 
```

或者更强大的方式..更复杂一点：

```
 #define TRIMSPACES(p) while(*p != '\0' && isspace((unsigned char)*p) != 0) ++p
    #define NSTRIP(p, n) p += n
    #define STRIP(p) ++p

    char* getcode(const char *input, size_t limit)
{
    char *p = (char*) input, *buf, *pbuf;
    size_t i = 0;

    while(*p != '\0') {
        if(strncmp(p, "CODE", 3) == 0) {

        NSTRIP(p, 4); //remove 'code'
        TRIMSPACES(p);//trim all white-spaces after 'code'

        /* check we have a '=' after CODE (without spaces).
           if there is not, returns NULL
        */
        if(*p != '=') 
            return NULL;

        /* ok. We have.. now we don't need of it
            just remove it from we output string.
        */
        STRIP(p);

        /* remove again all white-spaces after '=' */
        TRIMSPACES(p);

        /* the rest of string is not valid,
            because are white-spaces values.
        */
        if(*p == '\0')
            return NULL;

        /* allocate space for store the value
            between code= and -.
            this limit is set into second parameter.
        */
        if((buf = malloc(limit)) == NULL)
            return NULL;

    /* copy the value until found a '-' 
        note: you must be control the size of it, 
       for don't overflow. we allocated 256 bytes.
        if the string is greater it, do implementation with
        subjecents call to realloc()
    */
     pbuf = buf;
      while(*p != '\0' && *p != '-' && i < limit) {
        *pbuf ++ = *p++; 
        i ++;
    }

      *pbuf ++ = '\0';
      return buf;
    }
    p ++;
  }

  return NULL;
} 
```

接着：

```
char buf[255] = "foo baa CODE =     12345-MODE-12453-CODE-12355";
char *code = getcode(buf,256);

if(code != NULL) {
    printf("code = %s\n", code);
    free(code);
} else {
    printf("Not found code.\n");
} 
```

输出：

> 代码 = 12345

看看这个[`online`](http://codepad.org/yAZyzmiz)。

如果你不想区分大小写，你可以使用[`strncasecmp()`](http://pubs.opengroup.org/onlinepubs/007904975/functions/strcasecmp.html)that's POSIX function。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T23:49:08.897

假设这`CODE=`部分总是出现在字符串的开头，这很容易：

```
sscanf(buffer, "CODE = %d", &number); 
```

...但你想`buffer`成为`char[255]`，不是`unsigned long`。

编辑：如果该`CODE=`部分不一定在字符串的开头，您可以使用在缓冲区`strstr`中查找`CODE`，从该点开始执行 sscanf，然后立即查看：

```
int codes[256];
char *pos = buffer;
size_t current = 0;

while ((pos=strstr(pos, "CODE")) != NULL) {
     if (sscanf(pos, "CODE = %d", codes+current))
         ++current;
     pos += 4;
} 
```

Edit2：例如，你会使用这样的东西：

```
#include <stdio.h>
#include <string.h>
#include <windows.h>

int main ()
{
    // This is full of other junk as well 
    char buffer[255]="CODE=12345 MODE-12453 CODE=12355" ; 
    int i;
    int codes[256]; 
    char *pos = buffer; 
    size_t current = 0; 

    while ((pos=strstr(pos, "CODE")) != NULL) { 
        if (sscanf(pos, "CODE = %d", codes+current)) 
            ++current; 
        pos += 4; 
    } 

    for (i=0; i<current; i++)
        printf("%d\n", codes[i]);

    return 0;
} 
```

对我来说，这会产生以下输出：

```
12345
12355 
```

...正确阅读两个“CODE=xxx”部分，但跳过“MODE=yyy”部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-20T05:58:07.773

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

char *getcode(const char *str, const char *pattern){
    //pattern: char is match, space is skip, * is collect
    static const char *p=NULL;
    char *retbuf, *pat;
    int i, match, skip, patlen;
    if(str != NULL) p=str;
    if(p==NULL || *p=='\0') return NULL;
    if(NULL==(retbuf=(char*)malloc((strlen(p)+1)*sizeof(char))))
        return NULL;
    pat = (char*)pattern;
    patlen = strlen(pat);
    i = match = skip = 0;
    while(*p){
        if(isspace(*p)){
            ++p;
            ++skip;
            continue;
        }
        if(*pat){
            if(*p == *pat){
                ++match;
                ++p;
                ++pat;
            } else if(*pat == '*'){
                ++match;
                retbuf[i++]=*p++;
                ++pat;
            } else {
                if(match){//reset
                    pat=(char*)pattern;
                    p -= match + skip -1;
                    i = match = skip = 0;
                } else //next
                    ++p;
            }
        } else {
            break;
        }
    }
    if(i){//has match
        retbuf[i++]='\0';
        retbuf=realloc(retbuf, i);
        return retbuf;
    } else {
        free(retbuf);
        return NULL;
    }
}

int main (){
    char *code;
    code=getcode("CODE=12345-MODE-12453-CODE1-12355", "CODE=*****");
    printf("\"%s\"\n",code);//"12345"
    free(code);
    code=getcode(" CODE = 12345-MODE-12453-CODE1-12355", "CODE=*****");
    printf("\"%s\"\n",code);//"12345"
    free(code);
    code=getcode("CODE-12345-MODE-12453-CODE1-12355", "CODE=*****");
    if(code==NULL)printf("not match\n");//not match
    code=getcode("CODE=12345-MODE-12453-CODE=12355", "CODE=*****");
    printf("\"%s\"\n",code);//"12345"
    free(code);
    code=getcode(NULL, "CODE=*****");
    printf("\"%s\"\n",code);//"12355"
    free(code);
    code=getcode("CODE=12345-MODE-12453-CODE1-12355", "CODE=*****");
    printf("\"%s\"\n",code);//"12345"
    free(code);
    code=getcode(NULL, "CODE1-*****");
    printf("\"%s\"\n",code);//"12355"
    free(code);
    return 0;
} 
```

# python - 我应该导入哪个模块来使用 PyHKEY？

> ID：11570910
> 
> 赞同：-1
> 
> 时间：2012-07-19T23:43:53.890
> 
> 标签：python, pywin32

我正在尝试 pywin32 扩展的 win32api.RegLoadKey 部分，但是，我假设我需要先创建一个 PyHKEY。但是我不知道 PyHKEY 在哪个模块。文档同样没用。[http://docs.activestate.com/activepython/2.4/pywin32/PyHKEY.html](http://docs.activestate.com/activepython/2.4/pywin32/PyHKEY.html)另请注意，那里的文档确实注意到 PyHKEY 只是一个 PyHANDLE，它只是一个 int，但在调用中使用了一个 int导致异常：`error: (6, 'RegLoadKey', 'The handle is invalid.')`

任何帮助将不胜感激！

快速更新：

```
import win32api

handle = int()

win32api.RegLoadKey(handle, "tempKey", "C:\\Users\\Default\\NTUSER.dat") 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T23:56:33.183

Python是动态的；除非您创建自己的对象，否则您不会“使用”类型，否则您会使用给您的对象。[`win32api.RegOpenKeyEx()`](http://docs.activestate.com/activepython/2.4/pywin32/win32api__RegOpenKeyEx_meth.html)将为您提供一个您可以使用的关键对象，或者，作为`win32api.RegLoadKey()`状态的文档，您可以使用 4 个预定义常量之一来加载配置单元根。

# actionscript-3 - as3 marquee select 拖动多个子对象

> ID：11570914
> 
> 赞同：1
> 
> 时间：2012-07-19T23:44:04.723
> 
> 标签：actionscript-3, flash

谁能告诉我如何使用 AS3 实现选取框选择效果，通过在它们周围绘制一个动态矩形来选择多个影片剪辑，然后将它们拖放到任何地方？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T06:13:04.177

如果您需要多个对象可拖动，请不要使用`startDrag()`，因为它一次只允许拖动一个对象。相反，监听鼠标事件并手动移动：

```
var oldX:int;
var oldY:int;
var dragging:Boolean = false;

function onMouseDown(evt:MouseEvent):void {
    dragging = true;
    oldX = evt.stageX;
    oldY = evt.stageY;
}

function onMouseMove(evt:MouseEvent):void {
    if (!dragging) return;
    var dX:int = evt.stageX - oldX;
    var dY:int = evt.stageY - oldY;
    for (int i = 0; i < selectedClips.length; i++) {
        var clip:DisplayObject = selectedClips[i];
        clip.x += dX;
        clip.y += dY;
    }
    oldX = evt.stageX;
    oldY = evt.stageY;
}

function onMouseUp(evt:MouseEvent):void {
    dragging = false;
} 
```

此代码假定：

1.  您的选定对象数组称为`selectedClips`。
2.  您的选定对象数组都继承自`DisplayObject`.
3.  您已经为调用这些函数的 、 和鼠标事件`MOUSE_DOWN`在`MOUSE_MOVE`所有可拖动对象上添加了事件侦听器。`MOUSE_UP`

如果不满足这三个条件中的任何一个，请更新我的代码或您的代码以正常工作。此外，如果您需要在放置对象时进行任何额外的处理，您可以使用鼠标向上处理程序来添加自定义代码。

# c# - 最快的绘图，笔分配和 if 语句

> ID：11570915
> 
> 赞同：1
> 
> 时间：2012-07-19T23:44:10.537
> 
> 标签：c#, performance, graphics, pen

哪个是最有效的，哪个是（主观上）最易读的？（另一位开发人员编写了第二个选项，我想确定我有充分的理由更改它以匹配下面的第一个选项）

```
Pen pen = Pens.Red;
if (highlight)
    pen = new Pen(Color.Red, 3.0f); 
```

或者

```
Pen pen;
if (highlight)
    pen = new Pen(Color.Red, 3.0f);
else
    pen = Pens.Red; 
```

我知道它会产生微小的差异，但我有一个绘制算法需要尽可能快！所以每一点都有帮助。不，此时使用另一种语言来处理绘图不是一种选择。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T23:47:14.363

这里的“性能”没有问题：如果*怀疑*有性能问题，那么*基准测试、基准测试、基准测试*（在*实际使用场景中*）然后查看。

无论如何，我的偏好是：

```
var pen = highlight
  ? new Pen(Color.Red, 3.0f)
  : Pens.Red; 
```

但是在上述两个中，*我更喜欢**没有**默认值的那个*，但不是为了“性能”：我这样做是因为然后可以依赖 C# 编译器来确保执行至少*一个*值设置路径（或者它会抛出一个关于使用未分配的局部变量的编译错误）。

*（是的，虽然对于分配了*初始值的情况也是如此，但对于更复杂的情况，它会崩溃，因为需要确保其中*一个*执行路径实际执行。因此，我在可行的情况下选择一致性。）

快乐编码！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-20T00:04:31.353

```
var pen = highlight ? highlightPen : Pens.Red;

static readonly Pen highlightPen = new Pen(Color.Red, 3.0f); 
```

# javascript - 谷歌地图蜘蛛功能 - 在同一点多个标记

> ID：11570916
> 
> 赞同：0
> 
> 时间：2012-07-19T23:44:16.207
> 
> 标签：javascript, google-maps, google-maps-api-3, google-maps-markers

我正在尝试使用 Overlapping Marker Spiderfier for Google Maps API v3 found here。（我的问题在这个文本/代码块的底部）

[https://github.com/jawj/OverlappingMarkerSpiderfier/blob/master/README.textile](https://github.com/jawj/OverlappingMarkerSpiderfier/blob/master/README.textile)

我试图在其上实现它的页面与他们在源代码页面上使用的代码有点不同。他们初始化他们的页面并在初始化函数中实现所有的函数调用。我的页面初始化地图并加载一个点，然后稍后使用单独的函数（通过地理编码）添加其他点。

所以，基本上此时地图已经初始化，现在我调用我的数据库来获取要添加的新位置。

```
var cityArray= <?php echo json_encode($cityArray); ?>; //get the city
var title = <?php echo json_encode($title); ?>; //and the title to go on it's infowindow

  function plotMarkers(){ 
        for(var i = 0; i < <?php echo json_encode($length); ?>; i++){
            codeAddresses(cityArray[i],title[i]); //geocode the address
        }
  } 
```

所以，上面的这个片段给了我两个数组；一个带有位置，另一个带有标题以进入信息窗口。这

所以，现在这里是对地址进行地理编码并将该标记添加到地图的 codeAddresses 函数。从 plotMarkers 函数中可以看出，数组被循环并添加到 codeAddresses 函数中。

```
function codeAddresses(address,title){
      geocoder.geocode( { 'address': address}, function(results, status) { 
              if (status == google.maps.GeocoderStatus.OK) {
                  marker = new google.maps.Marker({
                 map: map,
                 position: results[0].geometry.location
                });      
            google.maps.event.addListener(marker, 'click', (function(marker) {
              return function() {
                  infowindow.setContent(title);
                  infowindow.open(map, marker);
              }
            })(marker));
        }
    });
  } 
```

我的问题是我是否将侦听器（在上面链接的页面上）添加到加载第一个点的第一个函数中，还是应该将其添加到 codeAddresses 函数中？

另外，我应该将它包含在我的 codeAddresses 函数中还是其他地方？如果它确实进入 codeAddresses，这是否意味着我可以摆脱 for 循环，因为 codeAddresses 是从循环触发的（并在每次迭代期间运行）？

```
 for (var i = 0; i < window.mapData.length; i ++) {
   var datum = window.mapData[i];
   var loc = new gm.LatLng(datum.lat, datum.lon);
   var marker = new gm.Marker({
   position: loc,
   title: datum.h,
   map: map
});
 marker.desc = datum.d;
 oms.addMarker(marker);  // <-- here
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T23:56:39.580

最好的[策略](https://developers.google.com/maps/articles/geocodestrat)是离线对地址进行地理编码（使用[地理编码网络服务](https://developers.google.com/maps/documentation/geocoding/)），将坐标存储在数据库中，然后使用它们来显示标记，这将减少加载页面的时间，因为地理编码器受速率限制和配额。

# java - 在这个代码示例中我应该给一个变量什么修饰符？

> ID：11570918
> 
> 赞同：0
> 
> 时间：2012-07-19T23:44:24.187
> 
> 标签：java, swing, modifiers

`label`在下面的代码示例中，我应该给变量 , 什么修饰符？我是 Java 新手，但我想做的第一件事是分解出我可以在 swing 中使用的所有类，如 JLabel 并制作它，以便我可以动态调用它们。我希望我在下面做到了。但是，是的，我不确定，`private static JLabel label;`因为最终我希望能够在某个主文件中声明所有的 Swing 类。谢谢。

```
package base;

import java.awt.Component;

import javax.swing.JFrame;
import javax.swing.JLabel;

public class CreateLabel extends JLabel {
    private static final long serialVersionUID = 1L;
    private static JLabel label;

    public Component createLabel(JFrame frame, String text) {
        label = new JLabel(text);
        return frame.getContentPane().add(label);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T03:11:53.350

我的理解是，您希望您的`createLabel()`方法添加一个`JLabel`到传递的`JFrame`. 你可以做的是：

```
public class LabelCreator /*extends JLabel*/ {
    /*private static final long serialVersionUID = 1L;*/
    /*private static JLabel label;*/

    public Component createLabel(JFrame frame, String text) {
        JLabel label = new JLabel(text);
        return frame/*.getContentPane()*/.add(label);
    }
} 
```

请注意更改类名以尊重命名约定。

# ruby-on-rails - Ruby on Rails：如何覆盖资源的“显示”路线？

> ID：11570924
> 
> 赞同：17
> 
> 时间：2012-07-19T23:45:50.430
> 
> 标签：ruby-on-rails, ruby-on-rails-3

目前我有一条看起来像这样的路线：

```
resources :posts 
```

我想覆盖“显示”操作，以便可以显示如下网址：

```
posts/:id/:slug 
```

我目前可以通过添加自定义`match`路线来做到这一点：

```
resources :posts
match 'posts/:id/:slug' => 'posts#show' 
```

但是，当我使用`link_to`助手时，它不使用我的自定义显示路线。

```
<%= link_to 'show', post %>  # renders /posts/123 
```

如何定义我的显示路线以便我仍然可以使用`link_to`助手？

**更新：**正如您在以下答案中所读到的，您可以覆盖到“显示”操作的路线，但这可能比它的价值更多。创建自定义路由更容易：

```
# config/routes.rb
match 'posts/:id/:slug' => 'posts#show', as: 'post_seo'

# app/views/posts/index.html.erb
<%= link_to post.title, post_seo_path(post.id, post.slug) %> 
```

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-07-20T00:36:52.967

您有两条指向的路线`posts#show`（您应该可以通过运行来确认这一点`rake routes`），并且您的链接使用了错误的路线。

当你调用`link_to('show', post)`时，链接的 URL 是通过调用`url_for(post)`which （最终在途中经过其他几个方法之后）调用生成的`post_path(post)`。由于`posts#show`您的调用创建的路由`resources(:posts)`被命名为`post`，这就是`post_path`生成的路由。

您目前还有不一致的显示、更新和销毁操作路线，这可能会在以后给您带来问题。

您可以通过将路线更改为以下内容来解决此问题：

```
resources :posts, :except => ['show', 'update', 'destroy']
get    'posts/:id/:slug' => 'posts#show', :as => 'post'
put    'posts/:id/:slug' => 'posts#update'
delete 'posts/:id/:slug' => 'posts#destroy' 
```

不幸的是，您仍然不能使用`link_to('show', post)`，因为它依赖于能够`post.to_param`用作构建帖子路径所需的单个参数。您的自定义路由需要*两个*参数， an`id`和 a `slug`。所以现在您的链接代码需要如下所示：

```
link_to 'show', post_path(post.id, post.slug) 
```

您可以通过在以下位置定义您自己的`post_path`和`post_url`助手来解决该问题`app/helpers/posts_helper.rb`：

```
module PostsHelper
  def post_path(post, options={})
    post_url(post, options.merge(:only_path => true))
  end

  def post_url(post, options={})
    url_for(options.merge(:controller => 'posts', :action => 'show',
                          :id => post.id, :slug => post.slug))
  end
end 
```

这意味着我们终于可以使用：

```
link_to 'show', post 
```

* * *

如果这一切看起来工作量太大，一个常见的替代方法是使用看起来更像`posts/:id-:slug`.`to_param``Post`

```
def to_param
  "#{id}-#{slug}"
end 
```

您还需要做一些工作，将其拆分`params[:id]`为 ID 和 slug，然后才能在节目中查找相关实例、编辑、更新和销毁控制器操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-20T01:18:45.980

```
resources :posts, except: :show do
    get ":slug" => :show, as: "", on: :member
end 
```

并定义助手

```
 def post_path post
     "/posts/#{post.id}/#{post.slug}"
  end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T23:47:47.257

db/migrate/add_slug_to_articles.rb

```
add_column :articles, :slug, :string
add_index :articles, :slug 
```

模型/文章.rb

```
class Article < ActiveRecord::Base
  extend FriendlyId
  friendly_id :name, use: :slugged

  def should_generate_new_friendly_id?
    new_record?
  end
end 
```

# 或者...

```
class Article < ActiveRecord::Base
  extend FriendlyId
  friendly_id :name, use: :history
end 
```

[http://railscasts.com/episodes/314-pretty-urls-with-friendlyid](http://railscasts.com/episodes/314-pretty-urls-with-friendlyid)

[https://github.com/norman/friendly_id](https://github.com/norman/friendly_id)

# matlab - 如何使用循环在matlab中实现类似的语句？

> ID：11570925
> 
> 赞同：0
> 
> 时间：2012-07-19T23:45:54.203
> 
> 标签：matlab, variables, loops, eval

查看 mathworks 文档中的代码片段，

[硬盘驱动器的数字伺服控制](http://www.mathworks.com/products/control/examples.html?file=/products/demos/shipping/control/diskdemo.html)

```
Gf1 = tf(w1*[a1 b1*w1],[1 2*z1*w1 w1^2]); % first  resonance
Gf2 = tf(w2*[a2 b2*w2],[1 2*z2*w2 w2^2]); % second resonance
Gf3 = tf(w3*[a3 b3*w3],[1 2*z3*w3 w3^2]); % third  resonance
Gf4 = tf(w4*[a4 b4*w4],[1 2*z4*w4 w4^2]); % fourth resonance 
```

我的问题是，如何在循环中实现上述语句，例如，

```
% pseudo code

for i = 1:4

Gf%d = tf(w%d*[a%d b%d*w%d],[1 2*z%d*w%d w%d^2]); i 
```

然后在matlab中执行结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T23:52:16.903

这是一个选项：

```
w = [w1 w2 w3 w4];
%# same thing for a, b, d...

for i=1:4
    Gf(i) = tf(w(i)*[a(i) b(i)*w(i)],[1 2*z(i)*w(i) w(i)^2]); % ith  resonance
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T23:50:20.393

最好的方法是使用数组。

```
for i = 1:n
  trans(i) = % your stuff here %
end 
```

然后只需用正确的数组索引替换不同的变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T23:52:08.527

您可以使用`eval`：

```
for i = 1:4
    eval(sprintf('Gf%d = tf(w%d*[a%d b%d*w%d],[1 2*z%d*w%d w%d^2]);', i));
end 
```

或者您可以将参数转换为数组。如果您可以控制数据的格式，数组会更有效。

# ruby-on-rails - 按最高组排序 - 轨道

> ID：11570929
> 
> 赞同：2
> 
> 时间：2012-07-19T23:46:25.993
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, activerecord

此处的代码按高中名称对用户朋友进行分组。

```
<% @user.friends.group_by(&:highschool_name).map do |hsname, friends| %>
<% next if hsname.blank? %>
<div class="contentbox">
    <div class="box-header">
        <h3><%= hsname %></h3>
    </div>
    <ul class="friends-list">
        <% friends.map do |friend| %>
           <li><%= image_tag(friend.image) %>
        <% end %> 
    </ul> 
</div>
<% end %> 
```

但它没有任何顺序分组，我想按最高值排序。先显示最高组，然后再显示。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T00:06:48.880

`group_by`给你一个哈希作为回报。您可以在迭代之前对值的计数进行排序：

```
groups = @user.friends.group_by(&:highschool_name)
sorted_groups = groups.sort_by{|key, values| values.count}.reverse
sorted_groups.each do |hsname, friends|
  # do your thing here
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T00:24:41.530

你试过了吗？

```
@user.friends.group(:highschool_name).order("highschool_name DESC") 
```

# jquery - 使用分页取消绑定和绑定表排序器（停用并激活 jquery 插件）

> ID：11570933
> 
> 赞同：0
> 
> 时间：2012-07-19T23:47:00.330
> 
> 标签：jquery, jquery-plugins, binding

我正在为我的动态 html 表使用 tablesorter [http://www.pengoworks.com/workshop/jquery/tablesorter/tablesorter.htm](http://www.pengoworks.com/workshop/jquery/tablesorter/tablesorter.htm) ，我遇到了分页问题，​​因为出于某种原因它仍然保留了初始化时的分页值。

单击按钮时，我需要删除表格上的插件（Tablesorter 的分页和排序）保留，然后在获得数据回传后重新绑定插件。

如何绑定和重新绑定 tablesorter 插件。解除绑定会释放插件中的所有初始化值吗？

这将停用插件对数据的保留并创建对新数据集的保留。

PS：我确实有办法找出新的表格行集何时可用于应用插件，只是不确定绑定解除绑定部分

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T15:24:33.843

在 tablesorter.pager.js 文件上进行了此更改以到达我需要去的地方。

```
 $(config.cssNext,pager).unbind('click');
                 $(config.cssPrev,pager).unbind('click');
                 $(config.cssFirst,pager).unbind('click');
                 $(config.cssLast,pager).unbind('click'); 
```

代码在前面。

```
 $(config.cssFirst,pager).click(function() {
                    moveToFirstPage(table);
                    return false;}); 
```

# c# - 在html中格式化数字字符串

> ID：11570934
> 
> 赞同：1
> 
> 时间：2012-07-19T23:47:11.350
> 
> 标签：c#, asp.net, html

我有以下格式的数据

> “1214423-034”

在 html 表中，如何格式化字符串，以便只显示连字符后的所有内容，所以在这种情况下只显示“

> 034"

有没有我可以使用的 html 函数？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T23:56:08.327

[您可以使用 Javascript 使用indexOf()](http://www.w3schools.com/jsref/jsref_indexof.asp)和[substring()](http://www.w3schools.com/jsref/jsref_substring.asp)函数轻松完成此操作，如下所示：

```
<script type="text/javascript">
    var str = "1214423-034";
    var pos = str.indexOf("-");
    document.write(str.substring(pos + 1));
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T23:56:28.043

使用 jQuery

```
e.g. <div id="lblText" >1214423-034</div>

<script type="text/javascript">
$(document).ready(function(){
var element = $("#lblText").text().split("-");
});
</script> 
```

如果您决定使用 C#

```
string text = "1214423-034";

text = text.split("-").[1];

int number = 0;

bool result = Int32.TryParse(text, out number); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-20T03:03:02.733

字符串 foo = "1214423-034";
Response.Write(foo.Substring(foo.IndexOf("-") + 1));

# google-maps - 谷歌地图非地理空间

> ID：11570937
> 
> 赞同：0
> 
> 时间：2012-07-19T23:47:19.783
> 
> 标签：google-maps, space

我想知道你们中是否有人可以指出我解决以下问题的 Google Maps API V3 代码示例：

我有一个没有地理参考的二维点数据的数据集；即，数据不涉及地球表面的位置。在我的例子中，数据是用于位于人工/合成的二维“信息”空间中的文档。

目前，我成功地在 Google Maps API 中显示这些点并与之交互，将所有点映射为以经度/纬度坐标 0:0 为中心的经度/纬度坐标；即，在非洲西海岸附近的大西洋某处:-)

尽管出于实验目的我可以侥幸逃脱（0:0 附近的海洋几乎是空的，所以它不会干扰我的可视化），但我想采用一个新的抽象坐标空间；基本上取代了谷歌的 ROAD/TERRAIN/etc。maptype 和我自己的（空的）一个。

从我在谷歌上搜索的内容来看，这确实可以做到，而且我已经看到了一些令人印象深刻的 DNA/基因组学工作，实际上这已经完成了。但是，我不想破解那些复杂的应用程序，而是希望看到一个非常简单的基本代码示例，其中有人使用 Google API 在任意空间中绘制一些任意点。

你们中有人能举出这样一个例子吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T00:01:33.633

全部，

似乎答案一直摆在我面前（通常是……叹息）。似乎developers.google.com 在 [https://developers.google.com/maps/documentation/javascript/maptypes#CustomMapTypes](https://developers.google.com/maps/documentation/javascript/maptypes#CustomMapTypes)给出了一个很好的例子。

示例本身的代码位于[https://developers.google.com/maps/documentation/javascript/examples/maptype-base](https://developers.google.com/maps/documentation/javascript/examples/maptype-base)

似乎这对于我开始工作来说已经足够基本了。

# python - 如何将 numpy 数组转换为和弦音乐？

> ID：11570942
> 
> 赞同：4
> 
> 时间：2012-07-19T23:47:33.827
> 
> 标签：python, arrays, numpy, audio, scipy

我想使用一个数组来播放音乐/声音。输出的音乐/声音需要是和弦的。

我试过这个：

```
from scipy.io.wavfile import write
import numpy as np

duration=0.24
amp=1E4
rate=44100

def note(freq, duration, amp, rate):
    t = np.linspace(0, duration, duration * rate)
    data = np.sin(2*np.pi*freq*t)*amp
    return data.astype(np.int16) # two byte integers

tone0 = note(0, duration, amp, rate) #silence
tone1 = note(261.63, duration, amp, rate) # C4
tone2 = note(329.63, duration, amp, rate) # E4
tone3 = note(392.00, duration, amp, rate) # G4

seq1 = np.concatenate((tone1,tone0,tone0,tone0, tone1),axis=1)
seq2 = np.concatenate((tone0,tone2,tone0,tone0, tone2),axis=1)
seq3 = np.concatenate((tone0,tone0,tone3,tone0, tone3),axis=1)

song = np.dstack((seq1,seq2,seq3))

write('song.wav', 44100, song) 
```

我想播放 song.wav 文件，然后依次听到音符 C、E 和 G，然后是静音，然后是 C 和弦（C、E、G 音符同时播放）。

我得到的是 write 函数的错误。没关系，因为 write 功能（据我所知，它不能创建和弦 wav 文件）。

以防万一，错误是：

```
Traceback (most recent call last):
  File "music2.py", line 26, in <module>
    write('song.wav', 44100, song)
  File "/usr/lib/python2.7/dist-packages/scipy/io/wavfile.py", line 168, in write
    fid.write(struct.pack('<ihHIIHH', 16, 1, noc, rate, sbytes, ba, bits))
struct.error: 'I' format requires 0 <= number <= 4294967295 
```

1.  您知道支持复音的写入功能的替代方案吗？
2.  我对我的代码的完整替代方案持开放态度。重要的一点是从一个 numpy 数组生成（或播放）复音。我正在尝试做这样的事情：http: [//img44.imageshack.us/img44/6182/music.swf](http://img44.imageshack.us/img44/6182/music.swf)，但要简单得多；不是图形用户界面；不是交互式的，与 1 和 0 数组的概念相同，即行已分配和特定的声音/音符以及播放这些音符的时间的列代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T00:10:01.373

您得到的错误是由于`write`只需要一个 1 维或 2 维数组。您正在向它传递一个 3 维数组（的输出`dstack`是 3D）。

我不确定我明白你所说的复音是什么意思，但如果你只是想让不同的音调相互叠加，那么你需要做的就是叠加波形：

```
song = seq1 + seq2 + seq3 # Assumes seqs are of same length 
```

最后，您可能想要传递一个一维数组。如果您想编写立体声声音，则使用 2-D 数组。

# ios - iOS内存没有被释放，后台线程

> ID：11570943
> 
> 赞同：0
> 
> 时间：2012-07-19T23:47:41.180
> 
> 标签：ios, xcode, memory

我有两个视图控制器，一个带有按钮网格，第二个是基于用户按下的按钮的详细描述。

我在 Instruments 分配工具中使用“Mark Heap”，并在用户看到详细的视图控制器然后按下导航栏中的后退按钮后发现我的应用程序的内存正在增加。它应该导致内存的净变化为零......我正在使用ARC，xcode 4.2.1，部署到ios 5.0+

当我在按下按钮后加载新的 ViewController 时，我在后台线程中加载了一些数据图像。是否有可能因为我快速按下后退按钮，数据仍在后台线程中加载并且永远不会从内存中释放？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T00:03:16.377

从班级的幻灯片中，我描述了您可能面临的内存周期问题：

如果你有一个类的以下属性怎么办？

```
@property (strong, nonatomic) NSArray* myBlocks;    // array of blocks 
```

然后尝试在该类的方法之一中执行以下操作？

```
[self.myBlocks addObject:^() {
    [self doSomething];
}]; 
```

块内引用的所有对象都将保留在堆中，只要该块存在。（换句话说，块保留了指向其中引用的所有对象的强指针。）

在这种情况下，self 是此块中引用的对象。因此该块将有一个指向自身的强指针。但请注意 self 也有一个指向块的强指针（通过它的 myBlocks 属性）

这是一个严重的问题！

现在，无论是 self 还是 block 都无法逃离堆。那是因为总会有一个指向它们的强指针（彼此的指针）。这称为记忆“循环”。

解决方案：

局部变量总是很强大。没关系，因为当它们超出范围时，它们就会消失，所以强指针消失了。但是有一种方法可以声明局部变量是弱的。就是这样 ...

```
__weak MyClass* weakSelf = self;
[self.myBlocks addObject:^{
    [weakSelf doSomething];
}]; 
```

这解决了问题，因为现在该块只有一个指向自身的弱指针。（self 仍然有一个指向 block 的强指针，但这没关系）只要宇宙中的某个人有一个指向这个 self 的强指针，block 的指针就是好的。并且如果 self 不存在，则该块将不存在（因为 myBlocks 将不存在），一切都很好！

# c# - ASP.NET Web 应用程序中的授权文件访问

> ID：11570951
> 
> 赞同：0
> 
> 时间：2012-07-19T23:48:37.743
> 
> 标签：c#, asp.net, authorization

有人可以帮我了解一下吗？我有一个 C# 网站应用程序，我想在其中授权访问网站目录中的文档。

[如果用户通过我的网站http://www.mywebapp.com/documents/test.pdf](http://www.mywebapp.com/documents/test.pdf)中的链接请求文件说 pdf ，在浏览器中打开 test.pdf 之前，我实际上想验证用户是否有权根据他获得的角色访问 pdf。我已经为 IIS 中的文件夹“documents”启用了表单身份验证，如果用户未通过身份验证，系统将重定向到登录页面。我对此很好，但坚持授权。

我无法在 web.config 中设置角色，因为它对于不同的用户会有所不同。用户角色存储在该特定用户的 httpcookie 中。

在我的文档文件夹中，会有针对不同角色的不同文档。

为称为供应商的角色说 test.pdf。所以只有供应商可以访问这个 pdf

角色供应商的另一个文档 form.pdf - 只有具有角色供应商的用户才能看到此 pdf。

在浏览器中加载 pdf 之前，我应该编写一些处理程序来执行吗？或者当请求以 /documents/ 出现时，我是否应该重写 URL 以执行 aspx 页面以验证授权，如果授权显示该页面？

任何人都可以帮助我了解如何实施此授权。

感谢你的帮助！

谢谢，KK

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T00:40:39.750

看起来您的问题是“如何在 cookie 正常时检查页面上的 cookie 值并返回具有正确文档类型的文件流”。

*   确保您正在处理所有请求（使用 MVC 比使用 WinForms 更容易，但以后也可以）
*   读取并验证 cookie
*   如果检查通过则返回文件，不要忘记设置“content-diposition”和“content-type”标题。同样，MVC 中的文件结果更易于使用...如果使用模拟，请确保在正确的帐户下读取文件内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T04:19:18.763

您可以将以下代码添加到 web.config 并尝试

```
<location path="documents/test.pdf ">
        <system.web>
                <authorization>
                        <allow roles="Vendors"/>
                        <deny users="*"/>
                </authorization>
        </system.web>
</location>

<location path="documents/form.pdf ">
        <system.web>
                <authorization>
                        <allow roles="Role Supplier"/>
                        <deny users="*"/>
                </authorization>
        </system.web>
</location> 
```

# jquery - TypeError: 'undefined' 不是函数（评估 '$(".fancybox").fancybox()'）

> ID：11570952
> 
> 赞同：2
> 
> 时间：2012-07-19T23:48:43.690
> 
> 标签：jquery, fancybox, fancybox-2

在我的网站的新版本上工作，但无法正确加载精美的框：

[http://www.taintmovie.com/storecartloom2/](http://www.taintmovie.com/storecartloom2/)

我检查了对 jquery 的重复调用，但没有看到任何调用。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-20T02:30:33.497

深入研究这个问题，并不是像以前建议的那样损坏的 fancybox.js 文件的打包版本（我将该文件与 fancybox 网站进行了比较，它们匹配。）

为了消除错误并使fancybox正常工作，您必须在您的网站中修复三件事：

1）。关闭你的`<head>`标签（目前没有`</head>`关闭标签）

2）。你说你检查了 jQuery 重复但是你正在加载这个脚本：

```
<script type="text/javascript" id="cljs" src="https://taintmovie.cartloom.com/cart/cl?dr=1&ol=1"></script> 
```

[LINK HERE](https://taintmovie.cartloom.com/cart/cl?dr=1&ol=1)，其中包括 jQuery v1.4.2，因此它与已加载的 v1.7.2 冲突。

这实际上是这个错误的原因：

```
Error: TypeError: $(".fancybox").fancybox is not a function
Source File: http://www.taintmovie.com/storecartloom2/
Line: 40 
```

...您可能想要编辑该文件并删除 jQuery 部分。

3）。您正在将 fancybox 绑定到选择器，`.fancybox`例如：

```
$(".fancybox").fancybox(); 
```

...但是您的 html 看起来像：

```
<a class="fancybox.iframe" href="http://www.youtube.com/embed/bHEEdUQCNsM?autoplay=1"><img src="images/pantheonblack300.png"></a> 
```

您实际上需要设置除类`fancybox`之外的`fancybox.iframe`类，例如：

```
<a class="fancybox fancybox.iframe" href="http://www.youtube.com/embed/bHEEdUQCNsM?autoplay=1"><img src="images/pantheonblack300.png"></a> 
```

...否则它将无法正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T00:15:28.067

与 firebug 混在一起，fancybox.js 的打包版本似乎被破坏了。我将开发人员控制台中的源代码更改为解压版本，并且运行正常。

# mysql - 如何将日期，年份和月份更新到mysql中的现有表

> ID：11570958
> 
> 赞同：0
> 
> 时间：2012-07-19T23:48:53.767
> 
> 标签：mysql

如何将当前日期、月份、年份更新到现有表，以及当表中的数据自动修改时，应修改日期。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T23:51:20.637

这在此处的 MySQL 文档中得到了解决：http: [//dev.mysql.com/doc/refman/5.0/en/timestamp-initialization.html](http://dev.mysql.com/doc/refman/5.0/en/timestamp-initialization.html)

另请查看以下问题：

[MySQL ON UPDATE CURRENT_TIMESTAMP 未更新](https://stackoverflow.com/questions/5571323/mysql-on-update-current-timestamp-not-updating)

[MySQL CURRENT_TIMESTAMP 在创建和更新时](https://stackoverflow.com/questions/4897002/mysql-current-timestamp-on-create-and-on-update)

# azure - 如何检测 Azure/Amazon VM

> ID：11570965
> 
> 赞同：5
> 
> 时间：2012-07-19T23:49:20.010
> 
> 标签：azure, amazon, virtual-machine

一般来说，有什么方法可以检测您的代码是否在 Azure 或 Amazon 虚拟机上执行。我不是特别指某种网络或工作者角色，我的意思是给定任何可执行文件，是否有任何东西可以将该机器解析为云 VM - 例如在 Azure 下没有域，所以我不能简单地依赖域名.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-01-27T01:55:46.523

# AWS

[如果您的客人已经联网，那么您可以通过访问http://169.254.169.254](http://169.254.169.254)来探测实例元数据

例如：

```
$ curl http://169.254.169.254/1.0/meta-data/instance-id
i-87dc2f76 
```

然而，击中网络是相当重的。

在 AWS 上，您还可以通过查看 dmidecode 进行检查：

```
$ /usr/sbin/dmidecode -s bios-version | tr "[:upper:]" "[:lower:]" | grep -q "amazon" 
```

dmidecode 是轻量级的，因为它只访问客户操作系统的内存。但是，正如之前的答案所指出的，这取决于亚马逊是否继续在其版本字符串中包含“亚马逊”一词。

# 天蓝色

在 Azure 上，您可以检测管理程序详细信息，但这不允许您区分 Azure 和 HyperV。根据您的情况，这可能不是必需的。

要使用 dmidecode 检测 Azure/HyperV，请检查以下字符串：

```
$ /usr/sbin/dmidecode -s system-manufacturer | tr "[:upper:]" "[:lower:]" | grep -q "microsoft corporation"

$ /usr/sbin/dmidecode -s system-product-name | tr "[:upper:]" "[:lower:]" | grep -q "virtual machine" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T23:56:52.303

您可以查看机器的 IP 地址，并确定它是否在特定云的 IP 地址块中。

对于 Azure，每个子区域的已发布 IP 地址范围列表是一个 xml 文件，位于：

[http://download.microsoft.com/download/E/F/C/EFC5E4D8-E4EA-4EFE-9356-D8AEEBC85F50/Azure_IP_Ranges.xml](http://download.microsoft.com/download/E/F/C/EFC5E4D8-E4EA-4EFE-9356-D8AEEBC85F50/Azure_IP_Ranges.xml)

亚马逊将在添加新范围时发布博客条目。他们目前是：

美国东部（弗吉尼亚北部）：

*   72.44.32.0/19 (72.44.32.0 - 72.44.63.255)
*   67.202.0.0/18 (67.202.0.0 - 67.202.63.255)
*   75.101.128.0/17 (75.101.128.0 - 75.101.255.255)
*   174.129.0.0/16 (174.129.0.0 - 174.129.255.255)
*   204.236.192.0/18 (204.236.192.0 - 204.236.255.255)
*   184.73.0.0/16 (184.73.0.0 – 184.73.255.255)
*   184.72.128.0/17 (184.72.128.0 - 184.72.255.255)
*   184.72.64.0/18 (184.72.64.0 - 184.72.127.255)
*   50.16.0.0/15 (50.16.0.0 - 50.17.255.255)
*   50.19.0.0/16 (50.19.0.0 - 50.19.255.255)
*   107.20.0.0/14 (107.20.0.0 - 107.23.255.255)
*   23.20.0.0/14 (23.20.0.0 – 23.23.255.255)
*   54.242.0.0/15 (54.242.0.0 – 54.243.255.255)
*   54.234.0.0/15 (54.234.0.0 – 54.235.255.255) 新
*   54.236.0.0/15 (54.236.0.0 – 54.237.255.255) 新

美国西部（俄勒冈）：

*   50.112.0.0/16 (50.112.0.0 - 50.112.255.255)
*   54.245.0.0/16 (54.245.0.0 – 54.245.255.255)

美国西部（北加利福尼亚）：

*   204.236.128.0/18 (204.236.128.0 - 204.236.191.255)
*   184.72.0.0/18 (184.72.0.0 – 184.72.63.255)
*   50.18.0.0/16 (50.18.0.0 - 50.18.255.255)
*   184.169.128.0/17 (184.169.128.0 - 184.169.255.255)
*   54.241.0.0/16 (54.241.0.0 – 54.241.255.255)

欧盟（爱尔兰）：

*   79.125.0.0/17 (79.125.0.0 - 79.125.127.255)
*   46.51.128.0/18 (46.51.128.0 - 46.51.191.255)
*   46.51.192.0/20 (46.51.192.0 - 46.51.207.255)
*   46.137.0.0/17 (46.137.0.0 - 46.137.127.255)
*   46.137.128.0/18 (46.137.128.0 - 46.137.191.255)
*   176.34.128.0/17 (176.34.128.0 - 176.34.255.255)
*   176.34.64.0/18 (176.34.64.0 – 176.34.127.255)
*   54.247.0.0/16 (54.247.0.0 – 54.247.255.255)
*   54.246.0.0/16 (54.246.0.0 – 54.246.255.255) 新

亚太地区（新加坡）

*   175.41.128.0/18 (175.41.128.0 - 175.41.191.255)
*   122.248.192.0/18 (122.248.192.0 - 122.248.255.255)
*   46.137.192.0/18 (46.137.192.0 - 46.137.255.255)
*   46.51.216.0/21 (46.51.216.0 - 46.51.223.255)
*   54.251.0.0/16 (54.251.0.0 – 54.251.255.255)

亚太地区（东京）

*   175.41.192.0/18 (175.41.192.0 - 175.41.255.255)
*   46.51.224.0/19 (46.51.224.0 - 46.51.255.255)
*   176.32.64.0/19 (176.32.64.0 - 176.32.95.255)
*   103.4.8.0/21 (103.4.8.0 - 103.4.15.255)
*   176.34.0.0/18 (176.34.0.0 - 176.34.63.255)
*   54.248.0.0/15 (54.248.0.0 - 54.249.255.255)

南美洲（圣保罗）

*   177.71.128.0/17 (177.71.128.0 - 177.71.255.255)
*   54.232.0.0/16 (54.232.0.0 – 54.232.255.255) 新

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-08-08T15:28:10.710

这是检查您的机器实例是否在亚马逊的内部方法：

```
dmidecode | grep Version
version: 4.2.amazon     <--- This is what you would want to key on 
```

这只有在亚马逊在其 VM 的虚拟 BIOS 设置中保持其签名时才有效。我没有使用过 Azure，但我相信您也可以使用它来推断信息`dmidecode`。我已经用 VMware 和 VirtualBox 完成了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-12T19:27:49.433

@Dan 的答案不再适用于 Azure，请使用以下 URL 获得更好的列表

[http://msdn.microsoft.com/en-us/library/windowsazure/dn175718.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/dn175718.aspx)

如果此网址在这里消失，则为今天（2013 年 8 月 12 日）的副本

```
Europe West
65.52.128.0/19
213.199.128.0/20
168.63.0.0/19
168.63.96.0/19
137.116.192.0/19
137.117.128.0/17
168.61.56.0/21

Europe North
65.52.64.0/20
65.52.224.0/19
168.63.92.0/22
168.63.32.0/19
94.245.88.0/21
94.245.104.0/21
168.63.64.0/20
168.63.80.0/20
168.61.96.0/19
137.116.224.0/20

US East
168.62.32.0/19
157.56.176.0/21
168.62.160.0/19
168.61.32.0/20
168.61.48.0/21
137.117.64.0/18
137.135.64.0/18
138.91.96.0/19
137.116.112.0/20

US West
168.62.192.0/20
168.62.208.0/21
168.61.0.0/20
168.61.64.0/20
137.117.0.0/19
137.135.0.0/18
137.116.184.0/21
138.91.64.0/19
65.52.112.0/20
168.63.89.0/24
157.56.160.0/21
168.62.0.0/19

US North Central
65.52.0.0/19
65.52.0.0/20
65.52.16.0/20
65.52.192.0/19
65.52.48.0/20
157.55.24.0/21
157.55.64.0/20
157.55.160.0/20
157.55.136.0/21
157.55.208.0/20
157.56.8.0/21
157.55.252.0/22
168.62.96.0/19
157.55.248.0/22
168.62.224.0/19

US South Central
157.55.176.10/22
157.55.183.223/27
157.55.184.10/22
157.55.191.223/27
157.55.192.10/24
157.55.193.223/27
157.55.194.10/24
157.55.195.223/27
157.55.196.10/23
157.55.200.10/23
157.55.80.10/23
157.55.83.223/27
157.55.84.10/23
157.55.87.223/27
65.52.32.10/22
65.52.39.224/28
70.37.160.10/22
70.37.167.224/28
70.37.118.0/24
70.37.119.138/28
70.37.119.170/28
70.37.48.10/22
70.37.55.224/28
70.37.56.10/22
70.37.63.224/28
70.37.116.0/24

SE Asia
111.221.96.0/20
168.63.160.0/19
111.221.80.0/20
168.63.224.0/19
137.116.128.0/19

East Asia
65.52.160.0/19
111.221.78.0/23
168.63.128.0/19
168.63.192.0/19
137.116.160.0/20 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-06-25T23:45:05.510

您也可以为 Azure VM 使用元数据终结点：

```
Invoke-RestMethod -Headers @{"Metadata"="true"} -Method GET -Proxy $Null -Uri "http://169.254.169.254/metadata/instance?api-version=2021-02-01" | ConvertTo-Json -Depth 64 
```

参考： [https ://docs.microsoft.com/en-us/azure/virtual-machines/windows/instance-metadata-service?tabs=windows](https://docs.microsoft.com/en-us/azure/virtual-machines/windows/instance-metadata-service?tabs=windows)

# java - 如何使此消息气泡位于右侧？

> ID：11570968
> 
> 赞同：0
> 
> 时间：2012-07-19T23:49:57.197
> 
> 标签：java, android, listview

我将此作为列表视图中项目的布局：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:background="@drawable/msgbox_self_default" >

    <RelativeLayout
        android:id="@+id/layout"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:paddingLeft="7dip" >

        <ImageView android:id="@+id/pending" android:layout_height="fill_parent"
            android:layout_width="wrap_content" android:layout_marginLeft="2dip"
            android:src="@drawable/ic_sms_mms_pending" 
            android:visibility="gone"
             />
        <TextView           
            android:id="@+id/body"
            android:text="@+id/body"
            android:singleLine="false"
            android:paddingLeft="@dimen/message_item_text_padding_left_right"
            android:paddingRight="@dimen/message_item_text_padding_left_right"
            android:paddingTop="@dimen/message_item_text_padding_top"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:linksClickable="false"
            android:textAppearance="?android:attr/textAppearanceSmall"
            android:textColor="#ff000000"
            android:textSize="16sp"
            android:layout_alignParentRight="true" />

        <RelativeLayout
            android:layout_height="wrap_content"
            android:layout_width="wrap_content"
            android:layout_below="@id/body"
            android:id="@+id/picture_layout"
            android:orientation="vertical"

            >

        <ImageView android:layout_width="wrap_content"
            android:layout_height="wrap_content" android:id="@+id/picture"
            android:visibility="gone"
            android:maxWidth="178dip" android:maxHeight="178dip"
            android:layout_alignParentRight="true"
            android:adjustViewBounds="true" android:background="@android:drawable/picture_frame"
            android:layout_centerHorizontal="true"/>
        </RelativeLayout>

        <TextView 
            android:paddingRight="@dimen/message_item_text_padding_left_right"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_below="@id/picture_layout"
            android:paddingLeft="3dip"
            android:textAppearance="?android:attr/textAppearanceSmall"
            android:id="@+id/date"
            android:text="@+id/date" 
            android:singleLine="true"
            android:layout_alignParentRight="true" />

</RelativeLayout> 
```

我希望泡沫在右侧。这是消息气泡的布局。我试图把它放在右边，就像 iPhone 对话一样。我已经尝试了所有我能想到的与将其放在右侧而不是左侧有关的事情。有人看到我的布局有什么问题吗？请帮忙！谢谢

** 编辑 **

绿色气泡是我在这张照片中瞄准的那个

[http://getandroidstuff.com/wp-content/uploads/2010/12/GO-SMS-Android.jpg](http://getandroidstuff.com/wp-content/uploads/2010/12/GO-SMS-Android.jpg)

***更改布局***

到目前为止，这就是我所拥有的……还有什么想法吗？

![例子](../Images/90b78c0b8749f33f6db8251f1659535f.png)

我希望灰色气泡看起来像白色气泡，除了右侧。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T00:08:49.733

我不打算筛选你的代码，但基本上你只想要每条消息这样的东西

```
<RelativeLayout
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:padding="put the right amount of padding in">

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:background="make this your background, make sure to add padding in so that the text view is in the right place, look at 9 patches"
        android:layout_alignParentRight="true"/><!-- Or make this left -->

</RelativeLayout> 
```

不要让事情变得过于复杂，只需使用带有 9 补丁的文本视图，它就会做你想做的事。

只需水平交换 9 补丁，它就会在另一个方向

# c++ - Qt没有匹配函数调用mainWindow::connect()

> ID：11570969
> 
> 赞同：0
> 
> 时间：2012-07-19T23:50:03.987
> 
> 标签：c++, qt

我正在尝试连接组合框值和标签，以便在组合框更改时标签反映这一点。我已经用谷歌搜索了我的心，试图找到答案，但到目前为止，还没有任何效果；我仍然收到错误：`no matching function for call to mainWindow::connect(QComboBox*&, const char [38], QString*, const char [26])`

我已经尝试过`QObject::connect`，`QWidget::connect`以及其他任何与 Qt 打交道的东西，但都无济于事。

创建一个表示组合框值的标签并不是我对该程序的最终意图。相反，我希望让它使用一个简单的标签，然后将其更改为我希望它显示的内容（因此是`tempLabel`）。

主窗口.h：

```
class MainWindow : public QMainWindow
{
public:
    MainWindow();

private slots:
    QString getClass(QComboBox *box);
}; 
```

主窗口.cpp：

```
MainWindow::MainWindow()
{
    QString qMathClassName;

    QComboBox* mathClassCombo = new QComboBox;
    QLabel* label = new QLabel(qMathClassName);

    // omitting layout code...

    connect(mathClassCombo, SIGNAL(currentIndexChanged(const QString &)), 
            &qMathClassName, SLOT(getClass(mathClassCombo)));
}

QString MainWindow::getClass(QComboBox *box)
{
    return box->currentText();
} 
```

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T00:04:44.787

您正在将信号连接到具有不同签名的插槽。您必须将您的插槽更改为类似

```
getClass(const QString &) 
```

匹配`currentIndexChanged`信号。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-21T07:40:46.797

我认为您需要阅读 Qt 的[信号和插槽文档](http://qt-project.org/doc/qt-4.8/signalsandslots.html)。同样，如果你已经这样做了。特别注意他们的例子。

我认为您对 C++ 中的 Qt 有以下误解：

1.  那个 QLabel 引用了一个 QString，并且当那个字符串改变时它会更新它的文本。它不会。当你给它字符串时，QLabel 将显示字符串的值。那是它唯一会更新的时间。

2.  在堆栈上构造的对象不会在函数结束时被销毁。他们不会。在构造函数结束时， qMathClassName 将被销毁，并且对它的任何引用都将变为无效。因此，即使可以，您也不想与它建立联系。

3.  QObject::connect 的第三个参数是一个指向放置槽返回值的位置的指针。它不是。第三个参数是指向要在其上调用槽的 QObject 的指针。通过 QObject::connect 对其进行的任何调用都不会使用槽的返回值。

4.  您可以将值绑定到连接中的插槽。不幸的是没有。在 SLOT 宏中，您必须放置插槽的函数签名。您不得引用任何变量。参数部分必须只有类名。也就是说`SLOT(getClass(QComboBox*))`，不是`SLOT(getClass(mathClassCombo))`。

确保组合框的内容显示在标签中的最简单方法是：

```
QComboBox* mathClassCombo = new QComboBox;
QLabel* tempLabel = new QLabel;
connect(mathClassCombo, SIGNAL(currentIndexChanged(const QString&)), 
        tempLabel, SLOT(setText(const QString&))); 
```

如果您想做一些更复杂的事情，我建议您在窗户上制作一个可以处理这些复杂情况的插槽。例如：

主窗口.h：

```
class MainWindow : public QMainWindow
{
Q_OBJECT
public:
    MainWindow();

private slots:
    void updateLabelText(const QString& className);

private:
    QComboBox* mathClassCombo;
    QLabel* tempLabel;
} 
```

主窗口.cpp：

```
MainWindow::MainWindow()
{
    mathClassCombo = new QComboBox;
    tempLabel = new QLabel;

    // omitting layout code...

    connect(mathClassCombo, SIGNAL(currentIndexChanged(const QString&)), 
            this, SLOT(updateLabelText(const QString&)));
}

void MainWindow::updateLabelText(const QString& className)
{
    QString newLabelString = className + " is the best class ever!";
    tempLabel->setCurrentText(newLabelString);
} 
```

# ruby-on-rails-3 - Rails - 现有查询中连接城市表的附近城市

> ID：11570973
> 
> 赞同：2
> 
> 时间：2012-07-19T23:51:13.680
> 
> 标签：ruby-on-rails-3, join

我有以下型号：

```
class User
 has_one :player
 belongs_to :city
end

class Player
 belongs_to :user
end

class City
 has_many :users
end 
```

每个城市都有一个**纬度**和**经度**属性。

我有以下查询（它有点长，但重要的是城市部分）我用来获取哪些相关用户来自特定城市的玩家。像这样：

```
def self.search(city)
  self.includes(:user => :city).
  where(['cities.name = ?', city])
end 
```

我将如何更改此查询以获取与用户相关的城市在给定城市附近（例如 10 公里）附近的教授？

编辑：我在 City 模型中有这个方法，它给了我最近的城市给定一个特定的半径（以公里为单位），纬度和经度：

```
 def near_by(latitude,longitude,radius)
    City.select("cities.*,
                6371 *
                acos(cos(radians(#{latitude})) *
                cos(radians(cities.latitude)) *
                cos(radians(cities.longitude) - radians(#{longitude})) +
                sin(radians(#{latitude}))*sin(radians(cities.latitude)))
                AS km_away").group('km_away ASC').having('km_away <= ?', radius)
  end 
```

**EDIT2**：这是我迄今为止为了结合这两个查询：

```
# Pass a city object to the search instead of a city name, so we can use lat and long

def self.search(city)
  self.includes(:user => :city).
  where(['cities.id IN (?)', City.near_by(city.latitude,city.longitude)])
end 
```

但这是一个好方法吗？如果是这样，我怎样才能让教授按靠近经过的城市排序？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T10:58:07.113

为了处理地理数据，我建议您查看此[railscast](http://railscasts.com/episodes/273-geocoder)中描述的[Geocoder gem](https://github.com/alexreisner/geocoder)。

从自述文件中：使用地理编码对象，您可以执行以下操作：

```
obj.nearbys(30)                      # other objects within 30 miles
obj.distance_from([40.714,-100.234]) # distance from arbitrary point to object
obj.bearing_to("Paris, France")      # direction from object to arbitrary point 
```

# javascript - 从 .js 文件中围绕其底部中心旋转 png 图像

> ID：11570990
> 
> 赞同：0
> 
> 时间：2012-07-19T23:53:09.827
> 
> 标签：javascript, image, png, rotation, image-rotation

首先，让我快速解释一下为什么我提出了这个问题，尽管这里有类似的问题： [画布从底部中心图像角度旋转？](https://stackoverflow.com/questions/365382/canvas-rotate-from-bottom-center-image-angle)

到目前为止，我所看到的所有信息都与嵌入在 html 标记中的 javascript 有关。我不知道这些信息是否足以满足比我更有经验的人，但我对 javascript 和 html 知之甚少。不过，我确实在很多脚本语言方面有一点经验。

我的问题是我有一个 .js 文件，它接受一个对象 i，并将 i.image 设置为来自 url 的 png 图像（例如 example.com/pic.png）。我想添加几行代码，首先将图像旋转 x 度或弧度（我不在乎，我总是可以转换），然后将其设置为 i.image。所以：image="example.com/pic.png"; i.image=MagicRotateFunction(image,45);

我只是不知道 MagicRotateFunction 会是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T22:07:47.293

如果您有兴趣在 .js 文件中进行 CSS 转换，请尝试以下操作：

```
i.src = "http://maps.google.com/mapfiles/marker.png";
i.style.WebkitTransform = "rotate(45deg)";
i.style.MozTransform = "rotate(45deg)";
i.style.OTransform = "rotate(45deg)";
i.style.msTransform = "rotate(45deg)";
i.style.transform = "rotate(45deg)"; 
```

资料来源：

*   [如何使用 JavaScript 动态设置样式 -webkit-transform？](https://stackoverflow.com/questions/708895/how-to-set-the-style-webkit-transform-dynamically-using-javascript)
*   [http://www.zachstronaut.com/posts/2009/02/17/animate-css-transforms-firefox-webkit.html](http://www.zachstronaut.com/posts/2009/02/17/animate-css-transforms-firefox-webkit.html)

# android - 如何创建简单的自我 LVL 类库

> ID：11570993
> 
> 赞同：-1
> 
> 时间：2012-07-19T23:53:28.657
> 
> 标签：android, android-lvl

我一直在尝试理解 LVL 库，但没有运气。我所需要的只是一个简单的方法，它可以在没有策略的情况下发送和接收许可证的当前状态，只需从 ILicensingService 服务发送/回复。我想创建自定义 LVL 库，但我必须先了解它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T19:58:25.740

那么，您是否看过 Android 提供的实际 Market Licensing 源文件？一旦你花几分钟时间，你应该能够理解这些政策是如何运作的。它们实际上很简单。

所有动作发生的关键类是`LicenseValidator`类。那里是进行许可检查请求的地方，那里是连接到远程服务以进行许可检查的地方。

在那个类中看看`Policy`接口类是如何使用的。