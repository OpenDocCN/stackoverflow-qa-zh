# StackOverflow 问答 000643000-000643999

# mfc - 最大文件数限制是多少？

> ID：643013
> 
> 赞同：0
> 
> 时间：2009-03-13T14:40:45.947
> 
> 标签：mfc, file

此代码中的最大文件数限制是多少？

FIX：公用文件对话框多选文件限制 [http://support.microsoft.com/kb/179372](http://support.microsoft.com/kb/179372)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-13T15:42:51.583

您链接到的页面上的示例代码使用此：

```
 DWORD MAXFILE = 2562;
 dlg.m_ofn.nMaxFile = MAXFILE;
 char* pc = new char[MAXFILE]; 
```

缓冲区`pc`长度为 2562 个字符，可打开的文件数受此限制。只要所有选中的文件名（包括路径）的总长度在这 2562 个字节中，就成功，否则失败。因此，可能的实际文件数取决于您要打开的文件名的长度。

您可以通过检查以下内容来检测缓冲区是否太小`FNERR_BUFFERTOOSMALL`：

```
if(CommDlgExtendedError() == FNERR_BUFFERTOOSMALL) {
  // the buffer was to small, not all file names did fit into it
} 
```

# c# - 重复维护 - 代码和文档

> ID：643022
> 
> 赞同：3
> 
> 时间：2009-03-13T14:43:40.290
> 
> 标签：c#, java, documentation, maintenance

这可能不是最好的标题 - 如果有人在阅读我的问题后能提出一个更好的标题，我将不胜感激。另外，我想提前说一下，我主要是在互联网上自学的，所以可能有很多我不知道的工具。

我正在维护在 Java 和 C# 中实现基于流的编程 (FBP) 概念的软件。对于其中的每一个，我都有以下代码：

*   我的网站
*   SourceForge 文件发布系统（zip 文件或 jar 文件）
*   SourceForge SVN

此外，我有版本参考和（有时是部分）描述：

*   我的网站 (HTML)
*   我的维基
*   Javadoc

还有一个绘图工具，也在我的网站和 SourceForge 上，它必须了解最新版本的 Java 版本的 FBP 代码。

一切都非常彻底地交叉链接，但有时我会错过参考！几天前，我意识到我已经很长时间没有为我的项目更新 SourceForge News 了，所以我不得不忙着去做 :-)

我意识到其中一些车辆可能是多余的，但一般来说，我不知道谁在看什么。

所以我的问题是是否有办法减少所有这些开销，例如 HTML“嵌入”功能会很好，所以我至少可以将最新版本号存储在一个地方。我可能可以简化 Java 交叉引用，但我猜跨语言会更好，但不太可能。

任何想法都会受到欢迎。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T15:06:59.800

在我看来，您希望在构建/部署过程中更新和维护您的文档，例如

1.  建造
2.  单元测试等
3.  编译文档
4.  部署构建
5.  部署编译的文档

否则你*总是*会追着你的尾巴。显然，文档部署将需要不同的解决方案来确定它的去向（例如复制到您的网站、通过 FTP 传输到其他地方等）

我不确定这一切是否有灵丹妙药。我在属性文件/配置文件中维护版本号，并进行适当的搜索/替换。代码文档尽可能放在代码本身中，然后在我的构建中进行预处理（上面的第 3 步）。

你见过/使用过[doxygen](http://www.doxygen.nl)吗？这将处理您的多语言要求，并且在构建/维护文档方面非常成熟。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T15:16:21.057

听起来您需要自动化构建/发布过程。不久前我在 O'Reilly 上阅读[了这篇文章- 看来你们俩的情况很相似？](http://broadcast.oreilly.com/2009/02/writing-technical-documentatio.html)他的解决方案大量使用了 Python，但至少它可能会给你一些想法。

# c++ - 受保护继承与公共继承和 OO 设计

> ID：643023
> 
> 赞同：1
> 
> 时间：2009-03-13T14:43:41.523
> 
> 标签：c++, oop

你什么时候使用每个继承？

```
class Base{};

class Derived: protected Base{};
class Derived2: public Base{}; 
```

**我的情况：**

我有一个名为 Snapshot 的类，它只包含 GetXXX 方法。它是一个轻量级的类，用于存储 Value 类的当前状态。我也用它来恢复，在 Value 类实例消失后很长时间保持这个类的实例。一个 Manager 类，处理 Snapshot 类的实例。让我给你看一下代码：

```
class Snapshot
{
        public:
            Snapshot (const Snapshot * snap)
            {
              _x=snap->_x;   
              _y=snap->_y;  
              _z=snap->_z;  
            }
            Snapshot (){_x=_y=_z=0;}
            int GetX(){return _x;}
            int GetY(){return _y;}
            int GetZ(){return _z;}
            ~virtual Snapshot(){} 

         protected: 
             int _x,_y,_z;               
};

class Value:public Snapshot 
{

 /*Very heavy class with a lot of components used to calculate _x, _y, _z*/

};

class Manager
{
       public:
         void Process( const Snapshot * snap)
         {

         }  
}; 
```

你觉得这个设计怎么样？有哪些替代方案？

谢谢

**解决方案和问题**

*   解决方案：我将创建 makeSnapshot 函数，该函数将通过给定的 Value 对象返回 Snapshot 对象。

*   问题：

    *   主要问题：我非常频繁地发送快照（每秒，甚至更少），因此我不想招致构建和销毁成本小问题：

    *   半主要问题 我将不得不让 Value 成为 Snapshot 的朋友，因为我不想
        介绍 setter。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T14:48:15.337

至于关于私有继承和受保护继承的问题，可以在这里找到相当详尽的解释：

*   [C++ 常见问题精简版](http://www.parashift.com/c++-faq-lite/private-inheritance.html)
*   [继承的使用和滥用，第 1 部分](http://www.gotw.ca/publications/mill06.htm)
*   [继承的使用和滥用，第 2 部分](http://www.gotw.ca/publications/mill07.htm)

主要问题是语义 - 某物是否是某物，或者某物是否是某物的 IS-IMPLEMENTED-IN-TERMS-OF。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T14:48:29.517

我将创建 makeSnapshot 函数，该函数将通过给定的 Value 对象返回 Snapshot 对象。

你真的需要价值作为快照吗？

您也可以考虑 GOF 设计模式“Memento”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T14:52:19.990

一般来说，如果我想实现一个特定的接口，我会使用公共继承，例如，如果我的类要通过一个特定的合同来访问。如果您只想重用父级中实现的功能，可以使用受保护的继承。

我会让 Snapshot 成为一个纯虚拟类，例如只是一个接口，而 Value 将实现 getXYZ 方法。例如，您可能不需要快照中的 _x,_y,_z 成员。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T15:18:48.117

给我上色 Luddite，但在 20 多年的 C++ 编程中，我从未使用过受保护或私有继承，也从未见过使用其他语言功能（通常是包含）无法更好地使用它们的示例。

# actionscript-3 - Flex3 画布、滚动条

> ID：643025
> 
> 赞同：0
> 
> 时间：2009-03-13T14:43:50.383
> 
> 标签：actionscript-3, apache-flex, flex3

我想`Sprite`在 flex中添加一个“简单” `Canvas`。我正在这样做：

```
var uic:UIComponent=new UIComponent;
var s:Sprite=new Sprite(); //<-- my simple Sprite
uic.addChild(s);

myCanvas.addChild(uic); 
```

已`Sprite`正确添加到`Canvas`，但现在，我需要`Canvas`根据`Sprite`大小激活 ScrollBar。（画布有固定大小）

任何想法欢迎，

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T19:49:44.253

您发现的问题是普通 UIComponent 不会向其父级报告宽度或高度值（因为它根本不知道该值应该是什么！）。

如果您必须在 Flex 中使用简单的 Sprite 和其他原始显示对象，我建议创建一个 UIComponent 的子类，并覆盖该`measure()`函数。在那里，将measuredWidth 和measuredHeight 属性设置为UIComponent 子项的大小。

这是您可能想要尝试的快速（且未经测试）的解决方案（在您的 UIComponent 子类中，它将替换普通的 UIComponent）：

```
override protected function measure():void
{
    super.measure();

    for(var i:int = 0; i < this.numChildren; i++)
    {
        var child:DisplayObject = this.getChildAt(i);
        this.measuredWidth = Math.max(this.measuredWidth, child.x + child.width);
        this.measuredHeight = Math.max(this.measuredHeight, child.y + child.height);
    }
} 
```

就个人而言，只要有可能，我都会尝试使所有内容都成为 UIComponent 的正确子类，而不是创建这样的技巧来使 Sprite 或其他非 UIComponent 类型在 Flex 的容器中工作。但是，您的方法似乎很常见，因此希望这对您和其他人有用。

# algorithm - 迪士尼的 FastPass 是否有效和/或有用的队列理论

> ID：643032
> 
> 赞同：166
> 
> 时间：2009-03-13T14:46:02.360
> 
> 标签：algorithm, optimization, performance

在迪斯尼乐园，他们使用名为[Fastpass](http://en.wikipedia.org/wiki/FASTPASS)的系统为热门游乐设施创建第二条较短的线路。这个想法是你可以在标准线上等待，通常等待超过一个小时，或者你可以获得一个快速通行证，允许你在指定的时间段内（通常是几个小时后）回来，只等待 10分钟或更短。使用 FastPass，您一次只能“等待”一趟。

我一直在试图弄清楚这个概念背后的排队理论，但我发现的唯一解释是，它旨在让人们摆脱排队并做能够带来额外收入的事情（购物、吃饭等）。

这是实施 FastPass 的原因，还是它解决了真正的访客效率问题？是否有应用了类似逻辑的软件应用程序？是否有应用类似逻辑的软件应用程序*？*

我看到在软件中实现类似的部分问题是它基于用户选择他们的队列。对于软件中更快的等待周期，我认为该理论的良好应用需要应用程序足够智能，以知道根据人们的需求将哪些队列放置在不需要最终用户选择的情况下。

**更新**

12 年（以及后来对 FastPass 的两次重大更新），[迪士尼的 FastPass：复杂的历史](https://youtu.be/9yjZpBq1XBE)给出了“它很复杂”的深入、明确的答案

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-03-13T15:05:30.490

这是关于积累，而不是队列效率。

Fastpass 之所以有效，是因为它使队列中的各个项目在“消费”某些东西时更有效率。与其说是等待指令执行的处理器那样的队列，不如说是人们排队等候食物。

对于迪斯尼乐园的人来说，它可以让他们最大限度地**享受乐趣**。

想想一个处理器接受指令。每条指令都在等待在队列中执行，以执行其任务。现在改变它——想象每条指令排队等待不是为了执行一条指令，而是为了从处理器中**获取**一些东西——每次它到达一个处理器时，它都会得到一颗金星作为奖励，它的工作是积累尽可能多的这些尽可能。

Fastpass 就像允许指令去到其他地方，到不同的处理器，在那里获得金星，然后返回主处理器从中获得金星。

就迪士尼乐园的用户而言，他们有兴趣获得乐趣——积累乘车体验。快速通行证允许用户以更短的线路找到不同的游乐设施，从而实现最大化，因此他们可以在更短的时间内积累更多。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-03-13T15:08:01.590

快速通过线显然不会增加给定乘车队列的总吞吐量，但它确实有助于资源调度和资源分配，其中人和乘车是资源。

就像我说的那样，您不会为所述乘车创造更多的总吞吐量，但其他地方可能有游乐设施未被充分利用。如果您现在能够乘坐这些游乐设施以及您必须等待的游乐设施，那么您可以提高公园的整体效率。我的意思是尽量减少低于载客量的游乐设施数量。

如果您的计算机资源处于空闲状态，等待执行可能需要很长时间的任务，那么在此期间将这些资源用于其他事情是有意义的，对吧？从这个角度来看很简单。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-03-13T15:35:50.837

我已经尝试过 FastPass，这就是我的看法：

假设您乘坐 1 小时的预计等待时间，如果您使用 FastPass，您将获得一个指定的时间段，保证您可以立即进入。通常在 1 小时以上之后。

我们为流行的游乐设施获得了快速通行证，在那段时间里，我们排了 10-15 米长的队列，让我们在 FastPass 虚拟队列中排队并去 3 个游乐设施。他们还为一些非常不受欢迎的游乐设施提供了额外的不计其数的快速通行证，如果我们使用这些，我们将从更受欢迎的游乐设施中获得一些负担并填补非常不受欢迎的游乐设施。

这是一个比较我们花费的时间与非快速通行选项的图表：

[![快速通道](https://i.stack.imgur.com/iNiyM.png)](https://i.stack.imgur.com/iNiyM.png)

在我看来，这是一种有效的排队理论，它允许执行预期等待时间较短的资源，同时延迟预期等待时间较长的资源。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-03-13T14:58:47.977

FastPass 基本上实现了具有某种优先级队列的非阻塞访问者。他们不阻塞，他们不睡觉，他们花钱。它之所以有效，是因为 john 在上午 11:00 使用它，而 joe 在上午 11:15（或上午 11:01）使用它。现在，如果每个人都有快速通行证，那么常规线路会快得多，而大多数游客在食物和礼物上花费的钱更多。对于迪士尼来说，这在一定程度上是想要的效果。

通行证做了一些假设并有一些限制。它假设持有快速通行证的人是少数.. 如果这种情况发生变化，他们将不得不让通行证在多次骑行中发挥作用，或者快速通行证持有人会花钱，同时看到常规线路中的人很少.. 适得其反。由于只支持一次乘车，因此没有两个快速通行证持有人会同时要求同一趟乘车。

现在，考虑到乔可能会在轮到他之前离开公园，你必须想出某种访客“futex”来使系统高效。如果 joe 离开了，而 john 早到了，john 就可以骑马了。此外，约翰会奇怪为什么他的快速通行证没有通知他可以提前 nn 分钟骑行。那才是真正有趣的地方，如果乔离开只是为了从车上拿些防晒霜然后回来怎么办？毕竟，轮到他的时间还有两个小时，除非他前面还有 200 人在他挡路（涂防晒霜时）离开公园，这是一项不能被打断的任务。因此，在这种情况下，我们将 Joe 置于某种磁盘睡眠状态，或者无法中断或终止的睡眠状态。他没有收到任何信号，他没有投票，他已经离开了公园。

这是一种驱动实际无锁编程的理论。[它和哲学家进餐问题](http://en.wikipedia.org/wiki/Dining_philosophers_problem)一样有趣，实际上更有趣。

就迪士尼而言.. 这不是一个错误，它的一个特点是人们不太愿意离开公园，而更倾向于花钱。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-03-13T14:59:18.787

在一个普通的队列中，您无法真正估计您的乘车速度。你很紧张，有时会考虑放弃这个想法。

使用 FastPass，您“知道”骑行将在精确定义的时间段内进行。您“确定”何时会发生这种情况，并考虑减少戒烟的频率。您去购物和吃饭，并在需要时返回。由于您提前申请了行程并感到承诺，因此您很可能会返回。Joel Spolsky[描述了星巴克排队时使用的类似承诺理念](http://www.joelonsoftware.com/inc.html?11)。

所以FastPass对公园和游客来说都是一种便利。游客更高兴，公园可以在他们等待的时候卖更多。

只是良好社会工程学的一个例子。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-03-13T14:57:35.750

我认为您可以将其与[异步编程模型](http://en.wikipedia.org/wiki/Asynchronous_I/O)进行比较。

您要求系统执行一项操作，稍后您将返回结果。

最大的区别是您要么指定在完成时调用哪个事件/回调，要么在您准备好等待时需要进入等待。我还没有看到一种机制可以告诉您稍后再回来并保证减少等待时间。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-03-13T15:12:57.570

对我来说，这似乎是一个[优先队列](http://en.wikipedia.org/wiki/Priority_queue)。

首次使用*SpeedPass*时，优先级更高。然后，当弹出*SpeedPass*`general line queue`在队列中具有更高的优先级。

 *如果我们同意这是一个优先级队列，那么最明显的软件实现就是[操作系统调度](http://en.wikipedia.org/wiki/Scheduling_(computing))

从调度 wiki 文章修改：

> *迪士尼乐园*调度程序主要关注：
> 
> *   乘车利用率 - 使乘车尽可能忙碌。
>     
> *   吞吐量 - 每个时间单位完成骑行的人数。
>     
> *   周转时间 - 执行特定骑行的时间量。
>     
> *   等待时间 - 一个人在就绪队列中等待的时间。
>     
> *   响应时间 - 从线路排队到产生第一个响应所需的时间。
>     
> *   公平 - 每个人的乘车时间均等。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-13T15:24:48.897

对我来说，FastPass 想法看起来像是我需要执行任务 1 到 N 的系统的解决方案，并且基于我对自己的一些了解*（在迪士尼，我可能知道我的孩子在等待Soarin'FastPass 时间片到达）*我可以安排自己进入任务 N 的“FastPass”队列，也进入任务 M 的标准队列。这将在任务顺序不一定重要且队列时间不重要的情况下工作是已知的，我可以估计完成任务 M 或 N 需要多长时间。虽然我不确定我是否有一个很好的现实世界编程示例 - 我们的大部分思维本质上是线性的，所以我们的工作流程往往是这样的.

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-13T15:10:13.630

FastPass 允许您同时在多条线路中等待。它可以让您避免等待，但会增加平均等待时间，因为线路实际上会变长。

但大多数人不会把所有时间都花在骑车上。有些活动，比如游行，真的没有等待时间。通过使用快速通行证，您可以参加更多此类无线路或短线路赛事，而无需牺牲尽可能多的长途骑行。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-13T15:17:33.860

我想到了两个在软件开发中具有相似行为的地方。然而，两者都不是一个精确的类比，因为它们都需要

首先是异步编程。如前所述，[在](https://stackoverflow.com/questions/643032/is-disneys-fastpass-valid-and-or-useful-queue-theory/643099#643099)等待方式方面，异步模型和快速通行模型之间存在一些差异。但是，其他一些编程模型（例如[Message Passing Interface](http://www.mpi-forum.org)）为您提供了一些其他选项，它们可能更接近于 FastPass 模型。

特别是，我在考虑 MPI 中的 MPI_Gather 方法——它们使用的模型可能更接近一些。每个函数都在集群中传递出去，然后你可以从根调用gather来获取当前处理的数据。目标是相同的（让每个人减少等待 [不阻塞用户] 并四处走动、花费 [或处理数据]）。

我可以看到的另一个相似之处是高级线程编程模型，例如[TPL](http://msdn.microsoft.com/en-us/magazine/cc163340.aspx)中的新调度程序。C# 4 中出现的 TPL 的主要优点之一是调度程序将允许工作窃取，在我看来，这似乎是软件中尝试动态切换线路的明确实现——这与 FastPass 相关联。快速通行证的好处之一是您可以少排队，多骑，多走动。使用 TPL，（希望）更少的阻塞和等待，因为完成队列的线程可以从其他队列中窃取任务。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-25T04:10:28.523

FastPass 的一个有趣方面是它为迪士尼引入了一个反馈渠道。通过拥有几乎总是等待吸引力变得可用的单条线路，除了以某种方式测量线路在一天中的固定时间间隔内有多长之外，您无能为力。迪士尼使用 FastPass 实时收集每个景点的需求和交通数据，并且已经数字化 - 它应该立即进入他们的数据仓库进行挖掘。

我倾向于同意那些将 FastPass 视为资源分配系统而不是资源排队系统的人。另一个类比是将每个迪士尼客户视为单线程的操作系统进程，直到客户拿起 FastPass。这使客户成为一个 2 线程进程，该进程像以前一样在整个公园内循环，并正在运行另一个等待指定资源的线程（FastPass 吸引力）。向用户（进程）允许多个 FastPass 将使此类进程更加多线程。当客户最终到达 FastPass 景点并享受它时，就会发生线程同步。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-13T14:53:56.553

我能看到的唯一软件类比是这种方法避免了队列缓冲区溢出——如果许多客户端几乎同时尝试添加到队列中，它可能会迅速填满该队列。如果要求客户端等待给定的时间长度，那么他们必须在添加到队列之前在本地缓冲（相对）较少的项目。

然而，在大多数其他情况下，这会导致吞吐量效率降低，因为如果等待时间选择不当，可能会导致队列变得饥饿。

尝试编写一个测试应用程序，在各种指标下使用和不使用“FastPass”的排队并比较结果 - 如果您发现任何有趣的事情，请告诉我们！:)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-13T14:57:04.223

不知道它将如何应用于软件。但是这个系统对游客来说绝对有它的优势：你可以在一次骑行中获得快速通行证，同时去另一个线路不那么长的骑行（或者，如你所说，去购物、吃饭等）。当我和我的家人在那里时，它是救命稻草（尽管不可否认，那是淡季）。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-03-13T14:58:20.427

鉴于它[正在被利用](http://www.schneier.com/blog/archives/2009/02/cheating_at_dis.html)，您必须信任队列用户；-)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-03-13T15:01:35.023

从我的供应链课程中，我立即想到的排队方面是减少了你感知的等待时间，所以人们根本不介意等待。我不认为它缩短了主要线路，但它确实减轻了人们在常规线路中等待的焦虑，因为他们知道一旦他们下车，他们就可以第二次回来（如果他们的快速通行证反正时间到了）。

我知道我认为我可以通过快速通行证乘坐更多的游乐设施，但我不知道这是否真的如此，或者这只是对我的等待时间的巧妙重新规划。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-03-13T15:34:23.947

> 我发现的唯一解释是，它旨在让人们摆脱困境并做一些能带来额外收入的事情（购物、吃饭等）。

我认为你已经抓住了要点，但你让它听起来比它应得的更邪恶。我当然宁愿在购物和吃饭时“虚拟排队”，而不是实际排队。

从理论上讲，FastPass 可以尝试在自然需求较低的时候安排更多的人；这就是您要从真正的预定队列中获得更多吞吐量的方法。但在实践中，我怀疑游乐设施在一天中的大部分时间都在满负荷运行，因此从中获得的生产力很少。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-04-18T11:50:55.110

它是关于热门游乐设施的资源调度以及通过销售商品产生额外收入的一种方式。如果你在排队等候，这意味着你没有机会花更多的钱。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-06-11T21:45:57.297

让顾客满意符合迪士尼的最大利益。虽然推销肯定是可观的收入，但获得回头客的价值要高出许多倍。

如果我花 150 美元买了 1 天的 park-hopper 门票，但因为线路太长而只能乘坐 10 次，我会怀疑这些游乐设施是否真的值 15 美元一张。但是，如果有办法让我进行 30 次骑行，那么我将获得更好的体验，不太可能质疑这种体验的价值，并且更有可能返回并给迪士尼乐园另外 150 美元 + 食品 + 商品。

在 FastPass 之前，我骑 10 次和 30 次之间的唯一区别是公园有多拥挤。这是其他理想景点试图以其他方式解决的常见问题。例如，Tahoe 的 Northstar 滑雪胜地将限制他们在某一天销售的缆车票数量（或者至少他们过去曾经如此）。这也解决了这个问题，但对收入的负面影响更大。

在软件中，类似的范例是加载网页。在古代，这个过程是单线程的：获取所有内容，渲染所有内容并显示页面。随着流量和数据的增加（特别是图像的合并），该模型面临与迪士尼乐园相同的问题。如果页面上有很多图片并且加载时间很长，我不会等待内容，也可能不会费心回到那个网站。

现在，网页的加载方式有所不同。内容首先被加载、渲染和显示，而另一个线程加载、渲染和显示图像。这极大地改善了用户体验，如果有理想的内容，我将继续回到该网站，它可以将我重复的页面浏览量变成 $$$。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-06-11T21:52:06.750

这在某些方面类似于实时操作系统。

一些进程具有快速通过，并被标记为实时。

他们有保证，他们将在一定的时间段内获得资源。他们不能插队，但他们可以插队！当他们不使用该游乐设施时，其他非实时客人可以使用它。

-亚历克斯

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2010-12-10T21:02:02.980

这是很棒的东西。迪士尼本质上是在排队，根据 FASTpass 分发的数量线性降低服务费率。

可以将短 FASTpass 队列建模为在短暂等待时始终处于平衡状态的队列。保持队列简短可以最大限度地减少两个队列之间的反馈——这有利于随机建模。另一个队列是典型队列，服务速率较慢。

当然，如果 FASTpass 配额过大，两个队列之间的反馈就会随之而来，使系统变得混乱，并最小化队列模型描述结果的效果。

另一种策略是尽量减少用户等待，将严格按预约安排乘车，在这种情况下，它是一个纯批处理队列，并且易于优化。我认为这在美国行不通。:-)

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2011-04-12T16:35:22.947

您不会乘坐更多游乐设施。不受欢迎的线路现在更长了，因为更多的人在等待他们的热门乘车通行证成熟时在他们身上消磨时间。容量就是容量。

“Twitter 目前真的很忙。请在 15:00 到 15:15 之间回来，我们保证在 5 秒或更短的时间内收到你的推文。”

# asp.net - ViewState 和动态移除的控件

> ID：643033
> 
> 赞同：2
> 
> 时间：2009-03-13T14:46:16.917
> 
> 标签：asp.net, dynamic, controls, viewstate

ASP.NET 页面`ViewState`似乎难以跟上动态删除的控件及其中的值。

我们以下面的代码为例：

**ASPX：**

```
<form id="form1" runat="server">
<div>
    <asp:Panel runat="server" ID="controls" />
</div>
</form> 
```

**CS：**

```
protected void Page_Init(object sender, EventArgs e) {
    Button b = new Button();
    b.Text = "Add";
    b.Click +=new EventHandler(buttonOnClick);
    form1.Controls.Add(b);
    Button postback = new Button();
    postback.Text = "Postback";
    form1.Controls.Add(postback);
}

protected void Page_Load(object sender, EventArgs e) {
    if (ViewState["controls"] != null) {
        for (int i = 0; i < int.Parse(ViewState["controls"].ToString()); i++) {
            controls.Controls.Add(new TextBox());
            Button remove = new Button();
            remove.Text = "Remove";
            remove.Click +=new EventHandler(removeOnClick);
            controls.Controls.Add(remove);
            controls.Controls.Add(new LiteralControl("<br />"));
        }
    }
}

protected void removeOnClick(object sender, EventArgs e) {
    Control s = sender as Control;
    //A hacky way to remove the components around the button and the button itself
    s.Parent.Controls.Remove(s.Parent.Controls[s.Parent.Controls.IndexOf(s) + 1]);
    s.Parent.Controls.Remove(s.Parent.Controls[s.Parent.Controls.IndexOf(s) - 1]);
    s.Parent.Controls.Remove(s.Parent.Controls[s.Parent.Controls.IndexOf(s)]);
    ViewState["controls"] = (int.Parse(ViewState["controls"].ToString()) - 1).ToString();
}

protected void buttonOnClick(object sender, EventArgs e) {
    if (ViewState["controls"] == null)
        ViewState["controls"] = "1";
    else
        ViewState["controls"] = (int.Parse(ViewState["controls"].ToString()) + 1).ToString();
    controls.Controls.Add(new TextBox());
} 
```

然后，假设您创建 4 个控件并插入以下值：

```
[ 1 ] [ 2 ] [ 3 ] [ 4 ] 
```

我们要删除第二个控件；删除第二个控件后，输出为：

```
[ 1 ] [ 3 ] [ 4 ] 
```

这就是我们想要的。不幸的是，在随后的 PostBack 中，列表变为：

```
[ 1 ] [ ] [ 3 ] 
```

所以，我的问题是，为什么会这样？据我所知，`ViewState`应该保存与其索引相关的控件属性，而不是实际控件。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-13T21:58:03.307

夫妇的事情。控件是按其 ID 还是按索引加载取决于 ViewStateModeById 属性。默认为 false（表示按索引加载）。

但是，文本框的处理方式不同。它们的视图状态不包含输入值，除非它们被禁用或不可见。text 属性被使用其 ID 的发布值覆盖。由于您没有管理文本框 ID，因此会发生这种情况。

添加四个控件后，您将拥有四个文本框：ctrl0、ctrl1、ctrl2 和 ctrl3，其值分别为 1、2、3 和 4。

接下来，您移除 ctrl1 框，客户端得到三个框：ctrl0、ctrl2 和 ctrl3，并具有相应的值。现在，当您执行任何回发时，这三个值将以 ctrl0=1&ctrl2=3&ctrl3=4 的形式提交。

然后，在 Page_Load 上创建三个控件，这次是：ctrl0、ctrl1、ctrl2，没有值。

框架调用 LoadRecursive 来加载视图状态，然后调用 ProcessPostData 来分配输入值。它看到提交的 ctrl0 和 ctrl2，找到具有相同 id 的控件并为它们分配值 1 和 3。它没有找到 ctrl3，所以它跳过它。剩下的 ctrl1 只是简单地进行而没有任何值。

例如，考虑这个解决方案（不是最好的）：

```
protected void Page_Init(object sender, EventArgs e)
{
    Button b = new Button();
    b.Text = "Add";
    b.Click += new EventHandler(buttonOnClick);
    form1.Controls.Add(b);

    Button postback = new Button();
    postback.Text = "Postback";
    form1.Controls.Add(postback);
}

protected void Page_Load(object sender, EventArgs e)
{
    if (ViewState["controls"] != null)
    {
        List<string> ids = (List<string>)ViewState["controls"];

        for (int i = 0; i < ids.Count; i++)
        {
            TextBox textbox = new TextBox();
            textbox.ID = string.Format("txt_{0}", ids[i]);
            textbox.Text = textbox.ID;
            controls.Controls.Add(textbox);

            Button remove = new Button();
            remove.Text = "Remove";
            remove.Click += new EventHandler(removeOnClick);
            remove.ID = ids[i];
            controls.Controls.Add(remove);

            controls.Controls.Add(new LiteralControl("<br />"));
        }
    }
}

protected void removeOnClick(object sender, EventArgs e)
{
    Control btn = sender as Control;

    List<string> ids = (List<string>)ViewState["controls"];
    ids.Remove(btn.ID);

    //A hacky way to remove the components around the button and the button itself
    btn.Parent.Controls.Remove(btn.Parent.Controls[btn.Parent.Controls.IndexOf(btn) + 1]);
    btn.Parent.Controls.Remove(btn.Parent.Controls[btn.Parent.Controls.IndexOf(btn) - 1]);
    btn.Parent.Controls.Remove(btn);

    ViewState["controls"] = ids;
}

protected void buttonOnClick(object sender, EventArgs e)
{
    List<string> ids;

    if (ViewState["controls"] == null)
        ids = new List<string>();
    else
        ids = (List<string>)ViewState["controls"];

    string id = Guid.NewGuid().ToString();
    TextBox textbox = new TextBox();
    textbox.ID = string.Format("txt_{0}", id);
    textbox.Text = textbox.ID;
    controls.Controls.Add(textbox);

    Button remove = new Button();
    remove.Text = "Remove";
    remove.Click += new EventHandler(removeOnClick);
    remove.ID = id;
    controls.Controls.Add(remove);

    controls.Controls.Add(new LiteralControl("<br />"));

    ids.Add(id);

    ViewState["controls"] = ids;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T15:56:00.320

您在 Page_Load 中执行一半代码，在回发事件中执行一半代码。在这个混乱的某个地方，你遇到了冲突。他们直到第二次回发才出现的事实告诉我，您的逻辑有些混乱。

我不确定问题究竟出在哪里，但是当您执行自定义 ViewState crud 时，ViewState 处理并不是世界上最有趣的事情。我将不得不重建应用程序并设置监视条件以查看发生了什么，但我相当确定这是您的 Page_Load 代码和事件处理程序之间的阻抗不匹配。

# .net - 我可以在 Windows 上只使用单声道的系统数据吗？

> ID：643035
> 
> 赞同：1
> 
> 时间：2009-03-13T14:46:25.713
> 
> 标签：.net, dll, mono

我有一个与 linux 的单声道远程通信的 Windows WinForms 应用程序。我是否有可能获得单声道的 system.data.dll 并在 Windows 上使用它而不是.net 的内置。

我想使用二进制类型的远程处理格式，并确保两端可以正确序列化/反序列化。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T14:52:18.697

在不影响 Microsoft 的 .Net 安装的情况下，您不太可能实现这一目标。会让你得到的事情是，无论你调用什么 API，每当 CLR 尝试加载 DLL 时，如果那里存在兼容版本， 它**总是会从 GAC 获取它。**

在某些情况下，WinForms 会隐式加载 System.Data.dll，CLR 会进行 GAC 检查。如果您使用的是 MS 版本的 WinForms，这将解析为 GAC 中的 MS 版本。如果不修改 GAC，就无法打破这一点。

所有 MS 程序集都使用私钥签名，AFAIK 单声道无法复制该私钥。因此，您似乎无法在内置 GAC DLL 之前加载 DLL，因此无法替换它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T14:51:55.327

Mono 程序集在 Windows 以及 Linux 和 Mac 等上运行良好。我曾多次以这种方式使用 Mono 程序集，用于各种目的。

在 Windows 上使用完整的 Mono 客户端并不总是可取的，因为它确实具有与 .net 客户端不同的运行时行为。它与 Microsoft CLR 的性能和功能水平并不完全相同（尽管它一直在接近）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T14:49:13.350

如果 Mono 遵循规范，它应该与 MS 二进制兼容。IIRC就是这样。

如果确实有问题，为什么不在客户端也使用单声道呢？

# sql-server-express - 控制台应用程序中的 SQL Server 用户实例

> ID：643044
> 
> 赞同：0
> 
> 时间：2009-03-13T14:49:02.837
> 
> 标签：sql-server-express, console-application, user-instance

是否可以使用控制台应用程序使用 SQL Server Express 用户实例数据库，或者它们仅在 Web 项目中工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T14:51:50.757

据我所知，没有关于用户实例的特定“网络”；它应该在控制台、web、winform 或 wpf 中工作相同...

唯一的区别是 Express IDE 可能没有为您设置它的选项……但这没关系。创建数据库，然后手动将其与连接字符串挂钩。

* * *

我刚刚尝试过（通过在 Express 中的控制台应用程序中添加 mdb + ldf），它运行良好；它甚至为我添加了连接字符串（在用户实例模式下）。那*可能*是因为我安装了额外的 VS 工具，但它确实有效......

在运行时，它不知道它是来自 Express、Pro 还是 Team Suite。

# c# - C# 中的哪些语言决定让您烦恼？

> ID：643050
> 
> 赞同：7
> 
> 时间：2009-03-13T14:50:39.073
> 
> 标签：c#

我只是在处理字符串，我发现自己对字符串可以为空感到恼火。所以，我必须有

```
if((teststring??string.Empty)==string.Empty) 
```

到处都是。会串吗？在需要它的相对少数情况下（dbs，白痴用户输入等），很难允许可空性。在我想要某种形式的 const 正确性的情况下，我还发现自己不得不导出只读接口而感到恼火。那么，什么 C# 语言的构造/决策让您烦恼？

编辑：感谢 isnullorempty 功能，我以前没见过！仍然没有减轻我对它可以为空的烦恼：D

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-03-13T14:53:11.377

最好使用以下方法测试 Null 或 Empty 字符串：

```
if (string.IsNullOrEmpty(testString))
{
} 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-03-13T14:59:20.003

让字符串成为引用类型对我来说似乎是完全合理的。

遗憾的是，不能将变量/参数/返回类型声明为*不可为空*- 例如

```
// Never returns null
public string! Foo()
{
} 
```

我相信 .NET 4.0 中的代码合同将对此有所帮助 - 但让它普及还为时已晚。

不久前，我写了[一篇关于 C# 错误的博客文章](http://msmvps.com/blogs/jon_skeet/archive/2008/02/05/c-4-part-1-looking-back-at-the-past.aspx)。总结那个帖子：

**C# 1：**

*   缺乏对属性的单独 getter/setter 访问。
*   缺乏泛型。从一开始，仿制药的生活就会变得更加美好。
*   默认情况下不密封类。
*   枚举只是被命名的数字。
*   "\x" 字符转义序列。
*   关于 switch 语句的各种事情:)
*   一些奇怪的重载解决规则
*   “lock”关键字，而不是“using”与锁定令牌。

**C# 2：**

*   缺少部分方法（来自 C# 3）
*   缺乏通用差异（在 C# 4 中出现）
*   `System.Nullable`班级（不-那`Nullable<T>`很好！）
*   InternalsVisibleTo 需要强签名程序集的整个公钥，而不是公钥令牌。

**C# 3：**

*   缺乏对不可变性的支持——许多改变改进了改变类型（自动属性、对象和集合初始化器）的机会，但这些都不适用于可变类型
*   扩展方法发现

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-13T22:03:55.397

对我来说，C# 中最大的明显漏洞可能是枚举。

Java 枚举是类型安全的类，您可以为其赋予行为、实现接口等。

C#/.Net 枚举只是美化了 int，而 int 常量的所有问题都可以追溯到 C 和 C++。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-13T14:55:38.127

out 和 ref 参数

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-13T14:55:56.330

扩展米奇的答案。

这实际上是一个 CLR 决定，而不是 C# 决定。C# 无法控制 BCL 的 System.String 类的实现细节。

真正的 C# 可能在编译器中有特殊的大小写字符串，并说我们将进行特殊的空检查，但恕我直言，这是一个错误的决定。String.IsNullOrEmpty 是可接受的折衷方案。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-30T15:59:35.447

在非空情况下强制中断。

枚举的冗长，尤其是在 case 语句中。如果我有 switch (expr) 并且 expr 是一个枚举，我不应该被迫在每种情况下完全限定每个枚举，除非存在命名冲突。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-30T16:18:51.873

检查异常会很棒。我知道很多人讨厌 Java，但我认为它总是强制执行完整性检查，尤其是在 I/O 上。与 Java 相比，我喜欢 C# 更改和/或添加的大部分内容，但我真的希望它们采用检查异常。现在为时已晚（更改 .NET 框架以拥有它们会破坏几乎所有程序）但我认为拥有它们会更好。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-13T14:54:16.600

我必须从 c# 3.0 中的接口实现属性的方式，即使它们与我不更改自动属性的默认行为时的接口完全相同。

例如

```
public interface MyInterface
{
   int MyProperty { get; set;}
}

public class MyClass : MyInterface
{
   public int MyProperty { get; set; }
}

public class MyClass2 : MyInterface
{
   public int MyProperty { get; set; }
}

public class MyClass3 : MyInterface
{
   public int MyProperty { get; set; }
} 
```

编辑：解决对此的一些评论。我没有改变我的 getter 的任何默认行为。我理解类和接口之间的区别谢谢，我的意思是我用接口标记它我不应该在每个实现类中都有这个属性，除非我想更改 getter 或 setter 的默认行为。想象一下 500 个类实现了这个接口？

也缺少 Mixins..

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-30T16:09:37.967

重写基类或实现接口方法时不允许协方差或访问权限更改：

```
public class A
{
    protected virtual Stream method()
    {
        //...stuff...
    }
}

public class B : A
{
    // compiler borks...
    public override FileStream method()
    {
        //...more stuff...
    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-30T16:28:11.103

我讨厌不得不到处打字`IEnumerable<MyType>`。很难读。我更喜欢某种简写方式来使我的代码更干净。

这篇[SO 帖子](https://stackoverflow.com/questions/794369/should-c-introduce-a-syntactic-short-hand-for-ienumerablet)很好地总结了它。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-30T16:32:08.083

如此多的核心方法是静态的，尤其是围绕字符串和数组等常用的东西，我觉得非常恼火。

为什么：

```
Array.Sort(myArray);
String.IsNullOrEmpty(myString); 
```

代替：

```
myArray.Sort();
myString.IsNullOrEmpty 
```

不是说没有充分的理由，也没什么大不了的，但是如果 JS 可以管理它，为什么 C# 不能呢？*

也是**开关**实现。我真的认为他们应该相信我们会失败。

**说到这里，我也想念 JS 的闭包语法。*

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-30T16:34:26.113

我不喜欢 IDisposable/Dispose 等。来自 C++，发现自己不得不考虑 C# 中的内存管理非常烦人。如果一次性对象仅在一个函数中使用，则 using 语句很好。如果必须传递它，您需要手动引用计数或执行其他操作以了解何时可以处置该对象。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-04-30T16:51:59.987

我希望将类对象视为语言中的第一类对象。

这将允许您覆盖静态方法，并在接口中声明它们。

# java - 如何访问 Hibernate 统计信息

> ID：643055
> 
> 赞同：24
> 
> 时间：2009-03-13T14:51:33.800
> 
> 标签：java, hibernate, jpa, jboss, jakarta-ee

所以在我的`persistence.xml`我打开了`hibernate.generate_statistics`。

```
<property name="hibernate.generate_statistics">true</property> 
```

我的问题是如何访问它们？统计数据去哪儿了？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-13T18:22:16.380

在您的 dao 服务中，您可以：

```
Session session = this.sessionFactory.getCurrentSession();
SessionStatistics sessionStats = session.getStatistics();
Statistics stats = this.sessionFactory.getStatistics(); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-13T15:15:50.527

如果您使用 Spring，我宁愿使用[通过 JMX 发布的 Hibernate Statistics，您可以使用](http://www.hibernate.org/216.html)[带有 Spring 的 Hibernate Statistics MBean](http://raibledesigns.com/wiki/Wiki.jsp?page=HibernateJMX)使其变得非常容易

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2019-05-07T08:12:15.753

您可以通过多种方式访问​​ Hibernate 统计信息：

# 以编程方式

如果要[`Statistics`](https://vladmihalcea.com/hibernate-statistics/)在应用程序中获取对象，可以按如下方式进行：

```
Session session = entityManager.unwrap(Session.class);

Statistics statistics = session.getSessionFactory().getStatistics(); 
```

# 日志记录

如果要记录`Statistics`报告，则需要添加以下日志配置条目：

```
<logger name="org.hibernate.engine.internal.StatisticalLoggingSessionEventListener" level="info"/> 
```

# JMX

您还可以`Statistics`通过设置属性通过 JMX 公开对象[`hibernate.jmx.enabled`](https://vladmihalcea.com/hibernate-statistics-jmx/)。

为此，您需要设置以下配置属性：

```
<property name="hibernate.jmx.enabled" value="true"/> 
```

`org.hibernate.core`并在您的 JMX 客户端应用程序中找到MBean 包。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-05-19T17:09:36.863

您还可以为其添加记录器。看; [http://www.thoughts-on-java.org/how-to-activate-hibernate-statistics-to-analyze-performance-issues/](http://www.thoughts-on-java.org/how-to-activate-hibernate-statistics-to-analyze-performance-issues/)

```
<!--Hibernate Statistics-->
            <logger category="org.hibernate.stat" use-parent-handlers="true">
                <level name="DEBUG"/>
            </logger> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-12-01T09:04:02.317

在我们的应用程序中，我们通过 JMX 发布它并使其完整，我们不得不[使用方面手动添加条件查询数据](http://hons82.blogspot.com/2011/12/hibernate-statisctics-criteria-queries.html)

# html - 文本区域列的宽度是多少？

> ID：643066
> 
> 赞同：1
> 
> 时间：2009-03-13T14:53:02.343
> 
> 标签：html, layout, textarea

如果我在网页上指定 X 列宽的文本区域并且我有可变宽度字体，那么文本区域的宽度是多少？什么是列单位？

它是最宽字符的宽度吗？平均宽度？平均的？

或者无论给出的字体如何，都可能有一些宽度单位？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-13T14:58:57.087

它是指定字体的[平均字符宽度](http://www.w3.org/TR/html401/interact/forms.html#adef-cols-TEXTAREA)。

# c# - 不使用打印机选择对话框打印

> ID：643080
> 
> 赞同：1
> 
> 时间：2009-03-13T14:54:17.317
> 
> 标签：c#, crystal-reports, printing, report

我想直接打印我的水晶报告，而不弹出打印机选择。我怎样才能做到这一点 ？

```
myReportDocument.SetDataSource(saveDataSet);
//Print
crystalReportViewer1.ShowRefreshButton = false;
crystalReportViewer1.ShowCloseButton = false;
crystalReportViewer1.ShowGroupTreeButton = false;
crystalReportViewer1.ReportSource = myReportDocument;
crystalReportViewer1.PrintReport(); 
```

我正在使用默认（也是唯一的）打印机。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T16:37:48.770

```
myReportDocument.PrintOptions.PrinterName = "PRINTER_NAME";
myReportDocument.PrintToPrinter(copies, collate, startPage, endPage); 
```

# c# - 学习实体框架

> ID：643081
> 
> 赞同：2
> 
> 时间：2009-03-13T14:54:17.893
> 
> 标签：c#, .net, linq, entity-framework, linq-to-entities

我有兴趣了解有关实体框架的所有信息。

我找到[了这些视频](http://blogs.msdn.com/adonet/archive/2008/05/20/how-do-i-new-entity-framework-videos.aspx)。

我还有 Julia Lerman 的《Programming Entity Framework, 1st Edition》一书。

有人对学习这项新技术有任何其他建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-13T15:10:16.000

最好关注一些博客，例如[ADO.Net 团队博客](http://blogs.msdn.com/adonet/archive/tags/Entity+Framework/default.aspx)（标记为 Entity Framework）。它将介绍他们的设计决策、缺少的内容、未来计划等。在[MSDN 杂志](http://msdn.microsoft.com/en-us/magazine/cc501043.aspx)的 Data Points 下有一些很好的文章。

# asp.net - 页面能否引发用户控件可以处理的事件？

> ID：643083
> 
> 赞同：0
> 
> 时间：2009-03-13T14:54:27.457
> 
> 标签：asp.net, vb.net

我已经多次这样做了，因为它是有意义的（页面知道控件，因为它已添加到页面并可以处理'child'事件）

是否有可能以另一种方式做到这一点？我认为不是因为控件不知道它将在哪个页面上

我问这个的原因是我在页面上有一个模式弹出窗口要求用户登录，只有当用户登录时，我才希望我的用户控件消失并执行一些代码，但我不太确定如何告诉控件这已经发生了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-13T15:43:52.143

我不确定我是否理解。

如我所见，当用户未登录时，您正在 Internet Explorer 中启动模式页面。在后端，这是通过用户控件处理的，但由于您无法在浏览器中启动用户控件而没有它放在一个页面上，整个模态对话框就是一个页​​面和一个控件。

如果是这样，您真正的问题是处理关闭模式弹出窗口，这可以通过 JavaScript 处理。

为了弄清楚确切的机制，我要做的是创建一个测试项目并在这个测试项目中为 JavaScript 编写基本的“事件处理”。一旦你有了基本的“点击这个按钮并且‘模态’关闭”，你就会知道你必须在你的 .NET 代码中发出什么。

由于控件必须通过某些东西进行通信，因此即使“控件”不知道，您也可以终止页面。

这是点击，还是我错过了什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T20:59:35.520

周五下午“我的脑子被炸了”的问题，我需要做的就是在用户控件上有一个公共子节点，一旦登录完成，页面就可以调用它！

由于我的愚蠢，我投票关闭

# linq - can linq update and query atomically?

> ID：643087
> 
> 赞同：1
> 
> 时间：2009-03-13T14:54:41.247
> 
> 标签：linq, atomic

I need to get 1000 rows from a database, and at the same time tag them as 'in process'. This way, another thread can not take the same 1000 rows and process them as well.

With linq i do something like this:

msgs = (from m in database.messages where (m.status == MESSAGESTATUSINIT) select m).Take(1000).ToList();

ideally I would at the same time set the status to MESSAGESTATUSPROCESSING. Of course this MUST be atomic.

any ideas? Or is it back to SQL?

thanks!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T15:27:58.610

You can't do that in linq2sql. Use a stored procedure, and configure it on the designer to output Message. This way you can manipulate the loaded entities and commit changes normally.

Check this for the how to do it (specifically Mapping the Return Type of SPROC Methods to Data Model Classes): [http://weblogs.asp.net/scottgu/archive/2007/08/16/linq-to-sql-part-6-retrieving-data-using-stored-procedures.aspx](http://weblogs.asp.net/scottgu/archive/2007/08/16/linq-to-sql-part-6-retrieving-data-using-stored-procedures.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T15:23:46.497

Linq itself is not going to offer this ability; Keep in mind Linq == Queries. Data updating happens elsewhere.

You might be better off in this instance writing a stored procedure to return the results; The sproc can update the table and return the results atomically, and your application then will have a single call.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T15:03:01.883

You can surround the code with a lock{}.

[Lock Keyword](http://msdn.microsoft.com/en-us/library/c5kehkcz(VS.71).aspx)

# c# - 如何创建服务器端定时事件？

> ID：643088
> 
> 赞同：1
> 
> 时间：2009-03-13T14:54:57.690
> 
> 标签：c#, .net-3.5

我正在为一个新的网络应用程序工作。我正在确定功能的关键点，而我显然不知道如何处理的一件事如下：

服务器每分钟需要对其数据运行一系列计算，并发布新的派生摘要。

因此，从本质上讲，我需要的是一种每分钟运行一次服务器端脚本的方法，即使用户不活跃，也很可靠。

我正在使用 ASP.NET 3.5、C# 作为 Web 界面。使用 SQL 2005 作为数据后端。

我想所有正在更改的数据都是 SQL 端的，所以如果那更可行的话，脚本可以在那里完全运行。

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T15:00:10.080

将一个项目放入缓存中，并在几分钟内到期。确保为它分配了一个回调方法，用于删除项目。一分钟后，该项目被删除，您的回拨运行。你把东西放在那里然后再次将项目添加到缓存中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T15:02:24.367

网站上的“后台”处理有两种选择。您不能将其作为站点的一部分进行，而是在 Windows 服务中进行（可以使用相同的业务对象），或者您可以在 Web 应用程序中启动的后台线程中进行。我们已经成功地使用了这两种方法，在不同的地方使用了不同的方法。在我们的 Application_Start 中，我们这样做：

```
//Submit background thread to update time left hospital
System.Threading.Thread checkoutThread = 
  new System.Threading.Thread(BackgroundThread.CheckoutUpdate);
checkoutThread.IsBackground = true;
checkoutThread.Priority = System.Threading.ThreadPriority.BelowNormal;
checkoutThread.Start(); 
```

其中 BackgroundThread.CheckoutUpdate 被定义为`public static void CheckoutUpdate()`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T15:40:05.163

你不能只使用 System.Timers 吗？

```
using System;
using System.Timers;
namespace App
{
    class Program
    {
        static void TimerEvent(object s,ElpasedEventArgs arg)
        {
            //handle your stuff here
        }
        static void Main()
        {
            Timer t = new Timer(60000); //60 seconds * 1000 = 60.000
            t.Elapsed += new ElapsedEventHandler(TimerEvent);
            t.Start();
        }
    }
} 
```

以防万一你不知道..

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T15:14:45.270

让 Sql Server 完成这一切。创建一个存储过程来执行操作，并在 Enterprise Manager --> Management--> Jobs 中设置一个作业。告诉作业调用存储过程。

# visual-studio - Windows Server (2003/2008) 作为开发机器？

> ID：643095
> 
> 赞同：7
> 
> 时间：2009-03-13T14:56:18.390
> 
> 标签：visual-studio, windows-vista, hardware, windows-server-2008, development-environment

我想知道这里有多少人使用 Windows Server 2008（或 w2k3）作为他们的开发机器。如果这样做，您发现的优点/缺点是什么？如果你不这样做，你觉得这样做有什么好处吗？

我在网上阅读了许多轶事，说它是一个比 Vista SP1 更稳定的开发环境，以及一些[关于 SO 的设置技巧](https://stackoverflow.com/questions/327448/windows-server-2008-as-development-machine-step-by-step)。我刚买了一台新机器（2 个四核 Xeons，16GB 内存），并试图决定我应该使用 Server 2008 还是 Vista Ultimate x64（我有两个操作系统的许可证）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-13T15:52:28.100

我们刚刚沿用 Windows Server 2008 作为本地开发工作站的路线，其规格与您大致相同，而且运行完美。

主要原因是 64 位和 16GB RAM - 它允许我们使用 HyperV 来包含运行从 Windows XP 到 Windows Server 2008 本身的任何东西的本地虚拟机，这允许开发人员维护自己的本地暂存环境而不会打扰基础架构管理员。

Server 2008 的开销比 Vista 少，同时仍然允许您进行所需的开发。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T15:00:32.653

这取决于你在做什么。如果您要编写主要在服务器上运行的程序（网页、数据库工作等），那么我会使用 windows 服务器。如果您要编写主要在台式机或工作站上运行的程序，我会选择 Vista。

无论哪种方式，您都可以考虑在虚拟机中运行另一个。您的新系统当然有足够的内存来支持这一点，否则您的额外许可证只会浪费。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T15:00:47.193

我唯一知道它会产生很大不同的地方是，如果您正在为需要在服务器操作系统上构建的目标进行开发——我 100% 肯定只有 SharePoint 是一个。当然，对于您拥有的硬件，我可能会说使用 Server 2008 作为您的基本操作系统，然后为您想要开发的任何其他操作系统设置 VM。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-13T15:03:35.877

我使用 Vista Business x64 作为我的主要操作系统，然后使用 VMWare 创建虚拟机作为开发环境。由于我目前的主要开发目标是 SharePoint 2007，因为它依赖于 Microsoft.Sharepoint.dll 以及随后的 Windows 2003/2008。

使用 Vista 作为基础操作系统使我能够灵活地在一个机器上运行多个开发环境并根据需要在它们之间切换。您可以轻松地使用 Windows 2008 和 Hyper-V 来获得同样的优势。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-13T15:18:28.943

我愿意。话虽如此，我们在这里没有 VMWare 或 Virtual PC 的好处。有时我在设置上遇到了一点困难，确保加载了正确的视频驱动程序和声音驱动程序，但除此之外我没有任何问题。好处是您正在将代码部署到的目标环境中进行开发。我看不出任何开发人员如何真正知道他们的代码发生了什么，除非他们有一个模拟器或将其作为他们的开发操作系统运行。

我不能保证 2008 和 Vista，但我可以告诉你，在 XP 和 2k03 上运行的 IIS 是不同的，在进行 IIS/ASP.Net 开发时，这些差异可能会让你大吃一惊。我就 2k03 上的 IIS 如何工作（多个网站等）进行了无数次讨论，因为人们在没有一些选项的 XP 上运行 IIS。我想不出我在 XP 中写的东西不能在 2k03 上运行的时候，但我经常看到人们尝试做一些困难的事情，因为他们真的不明白 2k03 上的 IIS 是如何运行的。可以说通过更好地理解 IIS 可以克服这一点，但是将其作为开发环境会迫使您查看它开始理解它。附带说明一下，将其作为您的开发环境可以更轻松地构建 SharePoint Web 部件。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-13T16:12:20.937

我使用 Windows Server 2003 R2 作为我的开发机器已经快 3 年了，我非常喜欢它。启用主题后，我也可以获得 Windows XP 桌面开发的完整体验。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-13T16:18:49.207

我更喜欢 Windows 服务器，因为 1) 我主要从事 Web 开发工作 2) IIS 6+ 允许创建多个站点，这很有帮助，而不是使用一个默认站点并重命名或创建 VDirs。3) 我可以让队列/Smtp/ftp 服务器在本地运行以进行测试。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-14T05:38:49.597

是的。如果您进行 Web 开发，那么服务器是您的必经之路（好吧，现在谁再做其他事情了 :)） 虚拟环境中的服务器为您提供了单独的环境开发。它还允许您与您的团队成员共享您的开发服务器映像，这样您就可以运行完全相同的环境。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-14T06:08:04.770

作为三个都跑过的人，如果你不打算玩任何游戏，我会说选择 2008 年。Vista 如果你运行游戏很多（或双启动）。我自己喜欢 2008 年，2003 年作为工作站操作系统很痛苦，2008 年要好得多..

# c# - 如何发布到网页

> ID：643105
> 
> 赞同：2
> 
> 时间：2009-03-13T14:59:02.237
> 
> 标签：c#

这是我很好奇的事情，因为我学会了如何调用一个 url 并获得一个 http 响应，这样我就可以在我的应用程序中解析结果。就像 Chris M 在这里所说的：

[在 ASP.net C# 中伪造浏览器请求](https://stackoverflow.com/questions/642860/faking-browser-request-in-asp-net-c)

现在我想知道的是如何发布我以这种方式下载的表格，填写表格的字段。

我的工作并不需要这个，这只是为了扼杀我作为程序员的好奇心:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T15:03:29.697

用值模拟表单帖子的最简单方法（在 C# 中）：

```
using (WebClient client = new WebClient())
{
    NameValueCollection fields = new NameValueCollection();
    fields.Add("foo", "123");
    fields.Add("bar", "abc");
    client.UploadValues(address, fields);
} 
```

只是为了完整性，jQuery 可以再次更有效地做到这一点......

```
$.post(address, { foo: "123", bar: "abc" } ); 
```

如果你想*检查*html 来创建你的 POST，要么使用[`WebBrowser`](http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.aspx)和自动化，要么使用[Html Agility Pack](http://www.codeplex.com/htmlagilitypack)来查看它。

# javascript - IE cookie 怪癖

> ID：643111
> 
> 赞同：1
> 
> 时间：2009-03-13T14:59:43.513
> 
> 标签：javascript, internet-explorer, cookies

我们面临以下检查在 IE 中间歇性失败的问题：

伪代码：

```
setCookie("name","value", "1d");
if(getCookie("name") === "value"){ 
  return SUCCESS;
} else {
  return FAILURE;
} 
```

这个小程序检查用户是否启用了 cookie。它不应该失败，但确实如此。是因为 IE 只能处理一定数量的 cookie 吗？（我们设置了很多 cookie）。

还有其他更可靠的cookie检查方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T15:07:36.973

是的，IE 对每个主机都有预设的 cookie 限制。之后，程序开始丢弃 cookie。[在这里](http://www.enhanceie.com/ie/bugs.asp)查看更多信息...

我建议您仅使用 cookie 来跟踪用户 ID，对于其他所有内容，您应该使用“会话状态”之类的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T15:23:03.690

正如bastos.sergio所说，使用会话。

也就是说，如果您有负载平衡的 Web 服务器，请忽略会话并在需要时直接从数据库服务器中提取数据。

如果是单个 Web 服务器，则使用 session。

无论如何，请查看您存储的数据。域的所有 cookie 都会在每个 Web 请求上发送回来。所有会话数据也会为每个 Web 请求加载。

如果您不需要每个网页的数据，那么您不应该将其缓存在 cookie 或会话中，因为它实际上会导致更大的性能损失，而不是在需要时提取它。

这就是为什么通常存储在 cookie 或会话中的唯一内容是用户 ID 等简单项目的原因。

另外，我相信 IE 将站点限制为 20 个单独的 cookie，总共 4KB 的数据。
请参阅[http://support.microsoft.com/kb/306070](http://support.microsoft.com/kb/306070)

**更新**：取消 20 的限制。如果应用了 2007 年 8 月的特定更新，IE 5,6 和 7 最多支持 50 个 cookie。 [http://support.microsoft.com/kb/941495](http://support.microsoft.com/kb/941495) 但是，4KB 的限制仍然存在。

并查看[此博客条目](http://blogs.msdn.com/ie/archive/2007/08/29/update-to-internet-explorer-s-cookie-jar.aspx)，该条目准确地涵盖了为什么大量 cookie 是一个坏主意。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T15:58:48.770

> 是因为 IE 只能处理一定数量的 cookie 吗？

可能是，但这个限制非常高——比你在实践中应该设置的要多得多。不要在 cookie 中放入大量数据；它们在每个 HTTP 请求上发送，从而减慢您的应用程序的速度。[在 IE 上，您可以在userData](http://msdn.microsoft.com/en-us/library/ms531424(VS.85).aspx)中存储大量数据，在较新的浏览器上，您可以使用[DOM Storage](https://developer.mozilla.org/en/DOM/Storage)，无论哪种方式都没有 HTTP 开销。但是依赖这些并不是很好的兼容性。你真的需要在客户端存储那么多吗？对于通用网络应用程序，这可能表明您做错了。

> 还有其他更可靠的cookie检查方法吗？

不，差不多就是这样。请注意，您可能无法设置 cookie-with-expires-date 但成功设置会话 cookie（没有过期日期；浏览器关闭时过期）。这是因为在 IE 中，当您阻止持久性 cookie 时，它​​们会被完全阻止，而不是像在其他一些浏览器上那样降级为会话 cookie。因此，出于某些目的，您需要进行两次检查。

# php - 正则表达式去除注释和多行注释和空行

> ID：643113
> 
> 赞同：25
> 
> 时间：2009-03-13T14:59:55.900
> 
> 标签：php, regex, preg-replace

我想解析一个文件，我想使用 php 和 regex 来剥离：

*   空行或空行
*   单行注释
*   多行注释

基本上我想删除任何包含

```
/* text */ 
```

或多行注释

```
/***
some
text
*****/ 
```

如果可能，另一个正则表达式来检查该行是否为空（删除空行）

那可能吗？有人可以向我发布一个正则表达式吗？

非常感谢。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-03-13T15:05:22.877

```
$text = preg_replace('!/\*.*?\*/!s', '', $text);
$text = preg_replace('/\n\s*\n/', "\n", $text); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-13T15:11:01.443

请记住，如果您正在解析的文件的字符串包含与这些条件匹配的内容，那么您使用的任何正则表达式都将失败。例如，它会变成这样：

```
print "/* a comment */"; 
```

进入这个：

```
print ""; 
```

这可能*不是*你想要的。但也许是，我不知道。无论如何，正则表达式在技术上无法以某种方式解析数据以避免该问题。我说技术上是因为现代 PCRE 正则表达式已经添加了许多技巧，使它们都能够做到这一点，更重要的是，不再是*正则*表达式，而是其他的。如果您想避免在引号内或在其他情况下剥离这些内容，则无法替代成熟的解析器（尽管它仍然可以很简单）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-10-02T12:15:40.257

```
//  Removes multi-line comments and does not create
//  a blank line, also treats white spaces/tabs 
$text = preg_replace('!^[ \t]*/\*.*?\*/[ \t]*[\r\n]!s', '', $text);

//  Removes single line '//' comments, treats blank characters
$text = preg_replace('![ \t]*//.*[ \t]*[\r\n]!', '', $text);

//  Strip blank lines
$text = preg_replace("/(^[\r\n]*|[\r\n]+)[\s\t]*[\r\n]+/", "\n", $text); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-02-03T15:06:17.777

```
$string = preg_replace('#/\*[^*]*\*+([^/][^*]*\*+)*/#', '', $string); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-13T15:12:48.490

这*是*可能的，但我不会这样做。您需要解析整个 php 文件以确保您没有删除任何必要的空格（字符串、关键字/标识符之间的空格（publicfuntiondoStuff()）等）。更好地使用 PHP 的[tokenizer 扩展](http://us.php.net/manual/en/function.token-get-all.php)。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-13T15:28:10.620

这应该可以将所有 /* 替换为 */。

```
$string = preg_replace('/(\s+)\/\*([^\/]*)\*\/(\s+)/s', "\n", $string); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-10-04T18:59:06.653

这是一个很好的功能，而且有效！

```
<?
if (!defined('T_ML_COMMENT')) {
   define('T_ML_COMMENT', T_COMMENT);
} else {
   define('T_DOC_COMMENT', T_ML_COMMENT);
}
function strip_comments($source) {
    $tokens = token_get_all($source);
    $ret = "";
    foreach ($tokens as $token) {
       if (is_string($token)) {
          $ret.= $token;
       } else {
          list($id, $text) = $token;

          switch ($id) { 
             case T_COMMENT: 
             case T_ML_COMMENT: // we've defined this
             case T_DOC_COMMENT: // and this
                break;

             default:
                $ret.= $text;
                break;
          }
       }
    }    
    return trim(str_replace(array('<?','?>'),array('',''),$ret));
}
?> 
```

现在使用这个函数'strip_comments'来传递包含在某个变量中的代码：

```
<?
$code = "
<?php 
    /* this is comment */
   // this is also a comment
   # me too, am also comment
   echo "And I am some code...";
?>";

$code = strip_comments($code);

echo htmlspecialchars($code);
?> 
```

将结果输出为

```
<?
echo "And I am some code...";
?> 
```

从 php 文件加载：

```
<?
$code = file_get_contents("some_code_file.php");
$code = strip_comments($code);

echo htmlspecialchars($code);
?> 
```

加载一个 php 文件，剥离注释并将其保存回来

```
<?
$file = "some_code_file.php"
$code = file_get_contents($file);
$code = strip_comments($code);

$f = fopen($file,"w");
fwrite($f,$code);
fclose($f);
?> 
```

来源：[http ://www.php.net/manual/en/tokenizer.examples.php](http://www.php.net/manual/en/tokenizer.examples.php)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-05-31T16:59:28.207

这是我的解决方案，如果不习惯正则表达式。以下代码删除所有由 # 分隔的注释，并以这种样式 NAME=VALUE 检索变量的值

```
 $reg = array();
  $handle = @fopen("/etc/chilli/config", "r");
  if ($handle) {
   while (($buffer = fgets($handle, 4096)) !== false) {
    $start = strpos($buffer,"#") ;
    $end   = strpos($buffer,"\n");
     // echo $start.",".$end;
       // echo $buffer ."<br>";

     if ($start !== false)

        $res = substr($buffer,0,$start);
    else
        $res = $buffer; 
        $a = explode("=",$res);

        if (count($a)>0)
        {
            if (count($a) == 1 && !empty($a[0]) && trim($a[0])!="")
                $reg[ $a[0] ] = "";
            else
            {
                if (!empty($a[0]) && trim($a[0])!="")
                    $reg[ $a[0] ] = $a[1];
            }
        }

    }

    if (!feof($handle)) {
        echo "Error: unexpected fgets() fail\n";
    }
    fclose($handle);
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-05-24T08:39:04.963

我发现这个更适合我，`(\s+)\/\*([^\/]*)\*/\n*`它删除了多行、标签或不注释以及它后面的间隔。我将留下这个正则表达式匹配的评论示例。

```
/**
 * The AdditionalCategory
 * Meta informations extracted from the WSDL
 * - minOccurs : 0
 * - nillable : true
 * @var TestStructAdditionalCategorizationExternalIntegrationCUDListDataContract
 */ 
```

# .net - 数据表复制

> ID：643120
> 
> 赞同：0
> 
> 时间：2009-03-13T15:01:22.700
> 
> 标签：.net, datatable

嗨，我有一个包含 5 列的数据表，我只想将其中两列复制到另一个数据表。做这个的最好方式是什么？

数据表1：

```
col1 col2 col3 col4 col5
1    2    3    4    5
6    7    8    9    10 
```

数据表2：

```
col1 col2
1    2  
6    7 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-13T15:04:18.900

这样的事情会有效吗？

```
 DataTable myTable = new DataTable();
        myTable.Columns.Add("Col1");
        myTable.Columns.Add("Col2");
        myTable.Columns.Add("Col3");
        myTable.Columns.Add("Col4");
        myTable.Columns.Add("Col5");
        myTable.Rows.Add(new object[] { "hey", "hey", "Hey", "hey", "Hey" });
        GridView1.DataSource = myTable;
        GridView1.DataBind();

        DataTableReader myReader = myTable.CreateDataReader();

        DataTable myTable2 = new DataTable();
        myTable2.Load(myReader);
        myTable2.Columns.Remove("Col3");
        myTable2.Columns.Remove("Col4");

        GridView2.DataSource = myTable2;
        GridView2.DataBind(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-18T03:13:13.923

或者您可以克隆日期表并删除您不需要/不需要的列

```
DataTable dtTest = dtAllData.Clone();
dtTest.Columns.Remove("col3");
dtTest.Columns.Remove("col4"); 
```

# mysql - 如何检测 Mysql / innodb 中的死锁？

> ID：643122
> 
> 赞同：14
> 
> 时间：2009-03-13T15:01:41.247
> 
> 标签：mysql, transactions, deadlock, innodb

我知道在 Innodb 中使用事务时不可避免地会发生死锁，并且如果应用程序代码正确处理它们是无害的 - 正如手册所说，“再试一次”。

所以我想知道 - 你如何检测死锁？死锁是否会发出一些特殊的 mysql 错误号？如果这很重要，我正在使用 PHP 的 mysqli 扩展。

谢谢你。

编辑：找到解决方案，见评论

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2011-01-17T22:35:02.070

MySQL 命令行客户端（不是查询浏览器）中的“SHOW ENGINE INNODB STATUS”将为您提供有关死锁的信息。

死锁也可能是由未提交的事务（通常是程序错误）引起的，运行未提交事务的人不会看到问题，因为他们会正常工作（因为他们的数据不会被提交）。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-13T15:04:54.670

[http://dev.mysql.com/doc/refman/5.0/en/innodb-error-codes.html](http://dev.mysql.com/doc/refman/5.0/en/innodb-error-codes.html)

> 第1213章
> 
> 事务死锁。您应该重新运行事务。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-13T15:04:17.497

试试[MaatKit](http://www.maatkit.org/)。它有一个死锁记录器。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-07-25T08:51:47.463

尝试使用[MONyog](http://www.webyog.com/en/)。启用 MONyog 的“死锁监控”选项来跟踪 INNODB STATUS 报告的死锁。当发生新的死锁时，MONyog 将向用户发送警报。 ![在此处输入图像描述](https://i.stack.imgur.com/vH6gH.png)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-05-18T16:43:50.590

如果你在 Mac 上：

$ brew install percona-toolkit

$ pt-deadlock-logger -uroot --ask-pass localhost

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-07-06T01:58:35.743

试试innotop，会为你检测死锁。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-03-28T13:51:54.430

我最近创建了一个非常简单的死锁检查，用于实施 Web 应用程序的冒烟测试。代码可以改进很多，但它现在正在工作。有关下面使用的查询的输出的更多信息，请参阅[https://dev.mysql.com/doc/refman/8.0/en/innodb-standard-monitor.html](https://dev.mysql.com/doc/refman/8.0/en/innodb-standard-monitor.html)。

```
$status = DB::select("SHOW ENGINE INNODB STATUS")["Status"]??null;

if(strpos($status,"LATEST DETECTED DEADLOCK") !== false)
{
  trigger_error("LATEST DETECTED DEADLOCK section present in output of SHOW ENGINE INNODB STATUS");
}

if(strpos($status,"LATEST FOREIGN KEY ERROR") !== false)
{
  trigger_error("LATEST FOREIGN KEY ERROR section present in output of SHOW ENGINE INNODB STATUS");
} 
```

# php - Symfony 日志记录

> ID：643129
> 
> 赞同：3
> 
> 时间：2009-03-13T15:03:39.073
> 
> 标签：php, logging, symfony1

在 Java 中，我使用*log4J*，它是一个日志框架。在 Log4j 中，您可以执行以下操作：

```
if (log.isDebug()) {
  // do some expensive operation that should only be displayed if DEBUG is turned on
} 
```

阅读一些 Symfony 示例，我无法找到一种方法来确定是否在当前类上下文中激活了 DEBUG 日志记录。有没有办法做到这一点？

```
if (--need something here--) {
  $this->logMessage('Expensive operation return value: '.expensiveFunction(), 'debug');
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-13T15:38:36.150

就像是

```
$this->getLogger()->getLogLevel() == sfLogger::DEBUG 
```

应该做。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-07-29T12:45:54.820

你应该检查[Monolog的用法](http://symfony.com/doc/current/cookbook/logging/monolog.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-07T05:38:53.000

您也可以尝试：`sfConfig::get('sf_logging_enabled').` 它显示是否启用了日志记录。可以在 factory.yml 中配置级别。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-10T14:35:42.347

您可以通过以下方式检查是否处于调试模式：

```
if ($this->get('kernel')->isDebug()) {
    ...
} 
```

这是有关记录器服务[https://symfony.com/doc/2.8/components/console/logger.html](https://symfony.com/doc/2.8/components/console/logger.html)和[http://symfony.com/doc/current/cookbook/logging/index.html的信息](http://symfony.com/doc/current/cookbook/logging/index.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-07-28T21:35:00.333

如果您在控制器中，您可以使用 symfony 记录器服务，您可以使用以下代码调用此服务：

```
if ($this->get('kernel')->isDebug()) {
 $this->get('logger')->err('my custom message');
} 
```

如果你想改进你的系统，你可以查看 MonologBu​​ndle [http://symfony.com/doc/current/logging.html](http://symfony.com/doc/current/logging.html)

# prism - Prism（复合应用程序库）应用程序的更多示例？

> ID：643130
> 
> 赞同：2
> 
> 时间：2009-03-13T15:03:39.683
> 
> 标签：prism, cag

Microsoft 的模式和实践提供的示例非常有用：

*   大约六个涉及特定问题的简单**快速入门**
*   StockTrader**参考实现**，它是一个相当全面的应用程序

但它缺少一个更有用的基础**应用程序来读取和写入数据源**（XML 或数据库），允许用户**登录、编辑数据、注销**等（类似于 ASP.NET MVC 附带的东西）。

由于 Prism 应用程序可能会变得相当复杂和冗长（StockTrader 示例几乎有 300 个文件没有测试），因此拥有一个处理每个人都需要为大多数应用程序构建**的 CRUD 批量的应用程序会很有帮助。**

有谁知道那里有任何**数据编辑 Prism 示例应用程序**？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-19T07:25:11.417

在这里 ( [http://petedoesstuff.net/Blog/?p=79](http://petedoesstuff.net/Blog/?p=79) ) 您会找到一堆使用 Prism 的示例链接。

特别是，LateNight ( [http://code.google.com/p/cwpfsamples/](http://code.google.com/p/cwpfsamples/) ) 可能是您需要的。它具有登录屏幕和数据编辑功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T06:41:10.410

我看过很多它的反馈。我将把它传递给团队，看看我们是否可以在这个空间周围获得更多在线示例。

我现在正在编写自己的演示应用程序，所以我也会尝试通过我的博客将它放到网上。

**Scott Barnes - 富平台产品经理 - Microsoft。**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T15:11:00.583

数据访问被排除在 Prism RI 之外的原因是它在很大程度上与 Pr​​ism 无关。我认为你最好看看像[DinnerNow](http://www.dinnernow.net/)这样的东西。

# .net - 是否有 RRDTool .net 等价物

> ID：643131
> 
> 赞同：8
> 
> 时间：2009-03-13T15:04:14.173
> 
> 标签：.net, monitoring, rrdtool

我需要监控大量数据，而且我知道 RRDTool 是一个不错的选择，但整个应用程序都是 c#，所以我更喜欢一些 Microsoft 方式或 .net 端口。

是否有与 RRDTool 相同的 .net 方式？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-02-11T06:01:50.303

不幸的是，MHawk 只是为每个 RRD 命令启动 RRDTool 进程。建议将 MHawk 连接到 librrd，以便可以将调用保持在进程中。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-15T07:19:52.863

也许[**NHawk**](http://www.codeproject.com/KB/cs/NHawk.aspx)可以提供帮助？
“NHawk 是一项为 .Net 和 Mono 框架提供精简、完整的 RRDtool 提供程序的计划。”

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-11-01T08:27:07.813

如果您仍在寻找 C# 版本，请参阅 google code。[您可以在此博客](http://blog.minidev.se/2010/02/10/Rrd4NetArePublic.aspx)中找到网址和一些背景信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-05-07T20:30:12.497

我已经使用[RrdSharp](http://sourceforge.net/projects/rrdsharp/)完成了与 RrdTool 相同的操作，完全在 C# 中。我没有使用[Rrd4Net](http://code.google.com/p/rrd4net/)的经验；与 RrdSharp 的 4 年以上相比，它的总开发时间为 4 个月以上。（你必须从某个地方开始！）

RrdSharp 有点尘土飞扬（.NET v1.1；最后更新 2009-07-17），二进制数据文件格式[与 RrdTool 不兼容](http://www.codeproject.com/KB/cs/NHawk.aspx?msg=3276387#xx3276387xx)。但是，您需要的功能可能就在那里。

# sql - 如何使用 SQLPLUS 假脱机到 CSV 格式的文件？

> ID：643137
> 
> 赞同：157
> 
> 时间：2009-03-13T15:05:29.210
> 
> 标签：sql, oracle, csv, sqlplus

我想将一些查询提取为 CSV 输出格式。不幸的是，我不能使用任何花哨的 SQL 客户端或任何语言来做到这一点。我必须使用 SQLPLUS。

我该怎么做？

* * *

## 回答 #1

> 赞同：159
> 
> 时间：2009-03-17T15:23:32.823

您也可以使用以下内容，尽管它确实在字段之间引入了空格。

```
set colsep ,     -- separate columns with a comma
set pagesize 0   -- No header rows
set trimspool on -- remove trailing blanks
set headsep off  -- this may or may not be useful...depends on your headings.
set linesize X   -- X should be the sum of the column widths
set numw X       -- X should be the length you want for numbers (avoid scientific notation on IDs)

spool myfile.csv

select table_name, tablespace_name 
  from all_tables
 where owner = 'SYS'
   and tablespace_name is not null; 
```

输出将如下所示：

```
 TABLE_PRIVILEGE_MAP           ,SYSTEM                        
    SYSTEM_PRIVILEGE_MAP          ,SYSTEM                        
    STMT_AUDIT_OPTION_MAP         ,SYSTEM                        
    DUAL                          ,SYSTEM 
... 
```

这比输入所有字段并用逗号连接起来要简单得多。如果需要，您可以使用一个简单的 sed 脚本来删除逗号之前出现的空格。

这样的事情可能会奏效......（我的 sed 技能非常生疏，所以这可能需要工作）

```
sed 's/\s+,/,/' myfile.csv 
```

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2017-02-14T21:55:16.930

如果您使用的是 12.2，您可以简单地说

```
set markup csv on
spool myfile.csv 
```

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2010-11-12T15:29:51.413

我将此命令用于为维度表 (DW) 提取数据的脚本。因此，我使用以下语法：

```
set colsep '|'
set echo off
set feedback off
set linesize 1000
set pagesize 0
set sqlprompt ''
set trimspool on
set headsep off

spool output.dat

select '|', <table>.*, '|'
  from <table>
where <conditions>

spool off 
```

并且有效。我不使用 sed 来格式化输出文件。

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2009-11-20T10:12:21.907

我看到一个类似的问题...

我需要从 SQLPLUS 假脱机 CSV 文件，但输出有 250 列。

我做了什么来避免烦人的 SQLPLUS 输出格式：

```
set linesize 9999
set pagesize 50000
spool myfile.csv
select x
from
(
select col1||';'||col2||';'||col3||';'||col4||';'||col5||';'||col6||';'||col7||';'||col8||';'||col9||';'||col10||';'||col11||';'||col12||';'||col13||';'||col14||';'||col15||';'||col16||';'||col17||';'||col18||';'||col19||';'||col20||';'||col21||';'||col22||';'||col23||';'||col24||';'||col25||';'||col26||';'||col27||';'||col28||';'||col29||';'||col30 as x
from (  
      ...  here is the "core" select
     )
);
spool off 
```

问题是您将丢失列标题名称...

你可以添加这个：

```
set heading off
spool myfile.csv
select col1_name||';'||col2_name||';'||col3_name||';'||col4_name||';'||col5_name||';'||col6_name||';'||col7_name||';'||col8_name||';'||col9_name||';'||col10_name||';'||col11_name||';'||col12_name||';'||col13_name||';'||col14_name||';'||col15_name||';'||col16_name||';'||col17_name||';'||col18_name||';'||col19_name||';'||col20_name||';'||col21_name||';'||col22_name||';'||col23_name||';'||col24_name||';'||col25_name||';'||col26_name||';'||col27_name||';'||col28_name||';'||col29_name||';'||col30_name from dual;

select x
from
(
select col1||';'||col2||';'||col3||';'||col4||';'||col5||';'||col6||';'||col7||';'||col8||';'||col9||';'||col10||';'||col11||';'||col12||';'||col13||';'||col14||';'||col15||';'||col16||';'||col17||';'||col18||';'||col19||';'||col20||';'||col21||';'||col22||';'||col23||';'||col24||';'||col25||';'||col26||';'||col27||';'||col28||';'||col29||';'||col30 as x
from (  
      ...  here is the "core" select
     )
);
spool off 
```

我知道这有点硬核，但它对我有用......

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2015-06-18T05:54:09.627

使用较新版本的客户端工具，有多个选项可以格式化查询输出。剩下的就是根据客户端工具将其假脱机到文件或将输出另存为文件。以下是几种方法：

*   **SQL*Plus**

使用 SQL*Plus 命令，您可以格式化以获得所需的输出。使用**SPOOL**将输出假脱机到文件。

例如，

```
SQL> SET colsep ,
SQL> SET pagesize 20
SQL> SET trimspool ON
SQL> SET linesize 200
SQL> SELECT * FROM scott.emp;

     EMPNO,ENAME     ,JOB      ,       MGR,HIREDATE ,       SAL,      COMM,    DEPTNO
----------,----------,---------,----------,---------,----------,----------,----------
      7369,SMITH     ,CLERK    ,      7902,17-DEC-80,       800,          ,        20
      7499,ALLEN     ,SALESMAN ,      7698,20-FEB-81,      1600,       300,        30
      7521,WARD      ,SALESMAN ,      7698,22-FEB-81,      1250,       500,        30
      7566,JONES     ,MANAGER  ,      7839,02-APR-81,      2975,          ,        20
      7654,MARTIN    ,SALESMAN ,      7698,28-SEP-81,      1250,      1400,        30
      7698,BLAKE     ,MANAGER  ,      7839,01-MAY-81,      2850,          ,        30
      7782,CLARK     ,MANAGER  ,      7839,09-JUN-81,      2450,          ,        10
      7788,SCOTT     ,ANALYST  ,      7566,09-DEC-82,      3000,          ,        20
      7839,KING      ,PRESIDENT,          ,17-NOV-81,      5000,          ,        10
      7844,TURNER    ,SALESMAN ,      7698,08-SEP-81,      1500,          ,        30
      7876,ADAMS     ,CLERK    ,      7788,12-JAN-83,      1100,          ,        20
      7900,JAMES     ,CLERK    ,      7698,03-DEC-81,       950,          ,        30
      7902,FORD      ,ANALYST  ,      7566,03-DEC-81,      3000,          ,        20
      7934,MILLER    ,CLERK    ,      7782,23-JAN-82,      1300,          ,        10

14 rows selected.

SQL> 
```

*   **SQL 开发者版本 pre 4.1**

或者，您可以使用**SQL Developer**中的新**提示**。**`/*csv*/`**

 ****```
/*csv*/ 
```

例如，在我的**SQL Developer 版本 3.2.20.10 中**：

![在此处输入图像描述](https://i.stack.imgur.com/YO4b9.jpg)

现在您可以将输出保存到文件中。

*   **SQL 开发者版本 4.1**

SQL Developer 版本 4.1 中的新功能，像 sqlplus 命令一样使用以下命令并作为脚本运行。查询中不需要提示。

```
SET SQLFORMAT csv 
```

现在您可以将输出保存到文件中。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2016-09-07T14:32:55.697

我知道这是一个旧线程，但是我注意到没有人提到下划线选项，它可以删除列标题下的下划线。

```
set pagesize 50000--50k is the max as of 12c
set linesize 10000   
set trimspool on  --remove trailing blankspaces
set underline off --remove the dashes/underlines under the col headers
set colsep ~

select * from DW_TMC_PROJECT_VW; 
```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2009-03-13T15:43:01.117

这很粗糙，但是：

```
set pagesize 0 linesize 500 trimspool on feedback off echo off

select '"' || empno || '","' || ename || '","' || deptno || '"' as text
from emp

spool emp.csv
/
spool off 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2009-03-13T15:41:08.640

您可以显式格式化查询以生成带有以下内容的分隔字符串：

```
select '"'||foo||'","'||bar||'"'
  from tab 
```

并根据需要设置输出选项。作为一个选项，SQLPlus 上的 COLSEP 变量将允许您生成分隔文件，而无需显式生成将字段连接在一起的字符串。但是，您必须在可能包含嵌入式逗号字符的任何列上为字符串加上引号。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2010-02-24T21:07:20.110

更喜欢在 sqlplus 提示符中使用“set colsep”，而不是一一编辑 col 名称。使用 sed 编辑输出文件。

```
set colsep '","'     -- separate columns with a comma
sed 's/^/"/;s/$/"/;s/\s *"/"/g;s/"\s */"/g' $outfile > $outfile.csv 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2014-07-11T07:47:01.727

我曾经写过一个小的 SQL*Plus 脚本，它使用`dbms_sql`并`dbms_output`创建一个 csv（实际上是一个 ssv）。你可以[在我的 githup 存储库](https://github.com/ReneNyffenegger/oracle_scriptlets/blob/master/sqlpath/to_csv.sql)中找到它。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2017-02-14T21:49:38.353

您应该知道字段值可能包含逗号和引号字符，因此某些建议的答案将不起作用，因为 CSV 输出文件不正确。要将字段中的引号字符替换为双引号字符，可以使用oracle提供的REPLACE函数，将单引号改为双引号。

```
set echo off
set heading off
set feedback off
set linesize 1024   -- or some other value, big enough
set pagesize 50000
set verify off
set trimspool on

spool output.csv
select trim(
       '"'   || replace(col1, '"', '""') || 
       '","' || replace(col2, '"', '""') ||
       '","' || replace(coln, '"', '""') || '"' ) -- etc. for all the columns
from   yourtable
/
spool off 
```

或者，如果您想要字段的单引号字符：

```
set echo off
set heading off
set feedback off
set linesize 1024   -- or some other value, big enough
set pagesize 50000
set verify off
set trimspool on

spool output.csv
select trim(
'"'   || replace(col1, '''', '''''') || 
'","' || replace(col2, '''', '''''') ||
'","' || replace(coln, '''', '''''') || '"' ) -- etc. for all the columns
from   yourtable
/
spool off 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-12-02T20:46:07.353

使用 vi 或 vim 编写 sql，将 colsep 与 control-A 一起使用（在 vi 和 vim 中，在 ctrl-A 之前使用 ctrl-v）。确保将 linesize 和 pagesize 设置为合理的值并打开 trimspool 和 trimout。

把它放到一个文件中。然后...

```
sed -e 's/,/;/g' -e 's/ *{ctrl-a} */,/g'  {spooled file}  > output.csv 
```

sed 的东西可以变成脚本。ctrl-A 前后的“*”挤出所有无用的空格。他们费心启用 sqlplus 的 html 输出而不是本机 csv，这不是很好吗？？？？？？

我这样做是因为它处理数据中的逗号。我把它们变成分号。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-03-21T20:22:54.343

使用 sqlplus 创建 csv 文件时出现问题。如果您只希望列标题在输出中出现一次并且有数千或数百万行，则不能将页面大小设置得足够大而不会重复。解决方案是从 pagesize = 50 开始并解析出标题，然后再次发出 select 以 pagesize = 0 获取数据。请参阅下面的 bash 脚本：

```
#!/bin/bash
FOLDER="csvdata_mydb"
CONN="192.168.100.11:1521/mydb0023.world"
CNT=0376
ORD="0376"
TABLE="MY_ATTACHMENTS"

sqlplus -L logn/pswd@//${CONN}<<EOF >/dev/null
set pagesize 50;
set verify off;
set feedback off;
set long 99999;
set linesize 32767;
set trimspool on;
col object_ddl format A32000;
set colsep ,;
set underline off;
set headsep off;
spool ${ORD}${TABLE}.tmp;
select * from tblspc.${TABLE} where rownum < 2;
EOF
LINES=`wc -l ${ORD}${TABLE}.tmp | cut -f1 -d" "`
[ ${LINES} -le 3 ] && {
  echo "No Data Found in ${TABLE}."
}
[ ${LINES} -gt 3 ] && {
  cat ${ORD}${TABLE}.tmp | sed -e 's/ * / /g' -e 's/^ //' -e 's/ ,/,/g' -e 's/, /,/g' | tail -n +3 | head -n 1 > ./${ORD}${TABLE}.headers
}

sqlplus -L logn/pswd@//${CONN}<<EOF >/dev/null
set pagesize 0;
set verify off;
set feedback off;
set long 99999;
set linesize 32767;
set trimspool on;
col object_ddl format A32000;
set colsep ,;
set underline off;
set headsep off;
spool ${ORD}${TABLE}.tmp;
select * from tblspc.${TABLE};
EOF
LINES=`wc -l ${ORD}${TABLE}.tmp | cut -f1 -d" "`
[ ${LINES} -le 3 ] && {
  echo "No Data Found in ${TABLE}."
}
[ ${LINES} -gt 3 ] && {
  cat ${ORD}${TABLE}.headers > ${FOLDER}/${ORD}${TABLE}.csv
  cat ${ORD}${TABLE}.tmp | sed -e 's/ * / /g' -e 's/^ //' -e 's/ ,/,/g' -e 's/, /,/g' | tail -n +2 | head -n -1 >> ${FOLDER}/${ORD}${TABLE}.csv
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-06-21T01:34:52.163

我在 1994 年编写了这个纯粹的 SQLPlus 脚本来将表转储到 CSV。

如脚本注释中所述，Oracle 的某个人将我的脚本放在了 Oracle 支持说明中，但没有注明出处。

[https://github.com/jkstill/oracle-script-lib/blob/master/sql/dump.sql](https://github.com/jkstill/oracle-script-lib/blob/master/sql/dump.sql)

该脚本还为 SQL*LOADER 构建了一个控制文件和一个参数文件

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2020-07-16T05:30:20.210

```
spool D:\test.txt

    select * from emp

    spool off 
```

* * *

## 回答 #16

> 赞同：-3
> 
> 时间：2016-05-12T21:30:23.653

您可以使用 csv 提示。请参见以下示例：

```
select /*csv*/ table_name, tablespace_name
from all_tables
where owner = 'SYS'
and tablespace_name is not null; 
```

# database - 如果要存储的数据多于集群中的 RAM，那么像 Hazelcast 和 Scalris 这样的分布式内存云数据库会发生什么情况？

> ID：643142
> 
> 赞同：2
> 
> 时间：2009-03-13T15:07:18.317
> 
> 标签：database, open-source, cloud, key-value, hazelcast

像这样的分布式内存云数据库正在发生什么

1.  [榛树](http://www.hazelcast.com/)
2.  [斯卡拉里斯](http://code.google.com/p/scalaris/)

如果集群中存储的数据多于 RAM？

他们要交换吗？如果交换空间已满怎么办？我在两个数据库中都看不到灾难恢复策略！如果内存已满，可能所有数据都会丢失？

是否可以将内容写入硬盘以解决内存问题？是否有其他数据库提供与 Hazelcast 或 Scalaris 相同的功能，具有备份功能/硬盘存储/灾难恢复？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-09-28T00:55:36.467

我不知道 Martin K. 接受的答案发表时的情况如何，但 Scalaris FAQ 现在声称这是受支持的。

[我可以在 Scalaris 中存储比集群中可用的 ram+swapspace 更多的数据吗？](http://code.google.com/p/scalaris/wiki/FAQ#Can_I_store_more_data_in_Scalaris_than_ram+swapspace_is_availabl)

> 是的。我们有几个数据库后端，例如 src/db_ets.erl (ets) 和 src/db_tcerl (tokyocabinet)。前者使用主存存储数据，而后者使用 tokyocabinet 将数据存储在磁盘上。使用 tokycoabinet，只有您的本地磁盘才能限制数据库的总大小。但是请注意，这仍然不能提供持久性。
> 
> 有关将数据库后端切换到 tokyocabinet 的说明，请参阅 [Tokyocabinet](http://code.google.com/p/scalaris/wiki/Tokyocabinet)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-22T13:47:12.343

关于 Hazelcast 和 Scalaris 的团队，他们都说，不支持写入比 RAM 更多的数据。

Hazlecast 团队将在不久的将来编写一个平面文件存储。

# unix - 如果使用 uniq 命令（在 shell 中），如何保持文件的格式？

> ID：643143
> 
> 赞同：6
> 
> 时间：2009-03-13T15:07:28.317
> 
> 标签：unix, file, shell, sorting, duplicates

为了使用 uniq 命令，您必须先对文件进行排序。

但是在我拥有的文件中，信息的顺序很重要，那么我怎样才能保持文件的原始格式但仍然摆脱重复的内容呢？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-13T15:37:11.847

另一个 awk 版本：

```
awk '!_[$0]++' infile 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-13T15:18:23.797

这`awk`将保留第一次出现。与其他答案使用的算法相同：

```
awk '!($0 in lines) { print $0; lines[$0]; }' 
```

这是一个只需要存储重复行（而不是所有行）的`awk`：

```
sort file | uniq -d | awk '
   FNR == NR { dups[$0] }
   FNR != NR && (!($0 in dups) || !lines[$0]++)
' - file 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-13T15:41:17.377

还有“行号，双重排序”方法。

```
 nl -n ln | sort -u -k 2| sort -k 1n | cut -f 2- 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-13T15:15:37.173

您可以在文件的排序版本上运行 uniq -d 以查找重复的行，然后运行一些脚本：

```
if this_line is in duplicate_lines {
    if not i_have_seen[this_line] {
        output this_line
        i_have_seen[this_line] = true
    }
} else {
    output this_line
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-13T16:08:02.867

仅使用 uniq 和 grep：

**创建 d.sh：**

```
#!/bin/sh
sort $1 | uniq > $1_uniq
for line in $(cat $1); do
cat $1_uniq | grep -m1 $line >> $1_out
cat $1_uniq | grep -v $line > $1_uniq2
mv $1_uniq2 $1_uniq
done;
rm $1_uniq 
```

**例子：**

```
./d.sh infile 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-13T15:12:31.423

你可以使用一些可怕的 O(n^2) 东西，像这样（伪代码）：

```
file2 = EMPTY_FILE
for each line in file1:
  if not line in file2:
    file2.append(line) 
```

这可能相当慢，尤其是在 Bash 级别实施时。但是，如果您的文件相当短，它可能会工作得很好，并且可以快速实施（`not line in file2`然后就是`grep -v`，依此类推）。

否则，您当然可以编写一个专用程序，在内存中使用一些更高级的数据结构来加速它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-13T15:21:00.000

```
for line in $(sort file1 | uniq ); do
    grep -n -m1 line file >>out
done;

sort -n out 
```

首先进行排序，

对于第一个匹配的每个唯一值 grep (-m1)

并保留行号

按行号对输出进行数字排序（-n）。

然后，您可以使用 sed 或 awk 删除行#

# reporting-services - 在任何情况下，服务器都可以向客户端请求任何服务吗？

> ID：643154
> 
> 赞同：0
> 
> 时间：2009-03-13T15:10:46.297
> 
> 标签：reporting-services, client, client-server

在任何情况下，服务器都可以向客户端请求任何服务吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-13T15:15:59.997

服务器如何向客户端请求服务？它是一个客户端，它将向服务器请求服务。

那么你的问题到底是什么？您可以添加更多详细信息吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T15:27:44.880

您可以做的是在客户端上安装某种类型的插件或活动 x 对象，并在客户端上运行，并将信息发送回服务器。但是，那里存在安全问题。无论如何，请求任何东西的不是服务器，而是运行应用程序然后再次连接到服务器的客户端。

如果你能更清楚地知道你需要完成什么，我想你会得到一个更清晰的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T15:17:47.167

如果您正在考虑网络应用程序，那么没有。服务器将始终为客户端发出的任何请求提供响应。

# database - 在数据库中搜索字符串“某处”

> ID：643155
> 
> 赞同：6
> 
> 时间：2009-03-13T15:10:49.760
> 
> 标签：database, string, postgresql, search

这是我的问题：我第一次查看某人基于 Postgresql 的数据库应用程序，并试图找出导致系统日志文件中某些警告/错误的原因。我对数据库架构一无所知。我对源代码一无所知。但我需要找出问题所在。

我可以使用 UNIX 命令“grep”轻松搜索基于文本文件的代码（如 php 和 perl）的字符串内容；即使对于已编译的二进制文件，我也可以使用 UNIX 命令“查找”和“字符串”。

我的问题是日志文件中产生的一些文本来自数据库本身。检查数据库的错误日志文件没有任何用处，因为应用程序使用的查询没有问题。

我想做的是彻底搜索数据库的所有列和所有表以查找字符串。这可能吗，怎么做？

在此先感谢您的任何指点。使用的环境是 Postgresql 8.2，但了解如何在其他类型的关系数据库中执行此操作也会很有用。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-13T15:33:35.117

它可能不是最佳的，但由于我已经知道如何 grep 文本文件，我只需将数据库转换为文本文件并 grep 即可。在这种情况下，将数据库转换为文本文件意味着使用[pg_dump](http://www.postgresql.org/docs/8.3/interactive/backup-dump.html)转储数据。

最快/最简单/最有效的方式并不总是优雅的......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T15:23:08.527

我对 Postgresql 不熟悉，但我认为，像 SQL Server 一样，它具有描述数据库架构的元数据表/视图（对于 SQL Server 2005+，我建议您参考 sys.tables 和sys.columns）。这个想法是基于表模式生成一系列即席查询，每个查询都在特定的表/字段组合中找到匹配项，并将匹配项泵入“日志”表中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T15:33:34.273

我过去使用过[这种](http://www.postgresonline.com/journal/index.php?/archives/69-How-to-determine-if-text-phrase-exists-in-a-table-column.html)变体。

# xslt - 有没有 XSL Lint 工具？

> ID：643159
> 
> 赞同：9
> 
> 时间：2009-03-13T15:11:13.797
> 
> 标签：xslt, lint

我正在寻找一个积极维护的 XSL lint 工具。我唯一能找到的是[这个](http://nwalsh.com/obsolete/xslint/)，但最后一次更新是在 2000 年（9 岁！）。任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T16:38:36.957

**是**的，看看这个，发表于 2008 年 12 月：

[**http://lists.xml.org/archives/xml-dev/200812/msg00178.html**](http://lists.xml.org/archives/xml-dev/200812/msg00178.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-21T16:07:24.807

菲利普，

为 xlst 创建一个好的 lint 非常困难，因为 xslt 模板的有效性取决于所使用的解析器。每个解析器都有自己的扩展。例如 java 的 xalan 可以很容易地用自定义的 xpath 函数进行扩展，这些函数显然是用 java 编写的。因此，任何 .net 验证器都无法验证高级 xalan 的 xslt。

所以首先你需要知道你要使用什么处理器。如果您使用基于 java 的处理器，我建议使用 Eclipse，它可以即时验证模板。

两个eclipse插件累了，值得一提的是都支持调试和xslt/xpath代码补全：

* * *

[Oxygen XML 编辑器](http://www.oxygenxml.com/)- 一个商业（约 300 美元）XML/XSLT 编辑器/eclipse 插件。它可以使用以下引擎：Xalan、Saxon、Xsltproc、

它能够检查：

*   xsl:template 的正确性
*   xsl:call-template 的名称属性的正确性
*   xslt 变量的重复定义
*   dtd 的有效性
*   xslt 标头的有效性
*   xml 命名空间的有效性
*   XPath 的有效性
*   如果 xml 关联到 xslt，则 xsl:value-of 的有效性
*   xsl:import 用于本地和远程文件的正确性（它支持 xml 目录）

我必须说该插件非常好，但另一方面它不是开源的。

* * *

[XSLT Project](http://wiki.eclipse.org/XSLT_Project) - 一个开源插件（它是 Eclipse Web 工具平台的一部分）。它还很年轻（始于 2008 年 9 月），但它拥有非常活跃的社区。目前它只支持 Xalan 和 JAXP。

它检测以下错误和警告：

*   无效的 xslt 标头
*   错误的 dtd
*   不正确的导入（它只处理相对导入，为 1.1 版计划了 xml 目录）

上面的列表肯定是不完整的，因为缺乏对 xml 目录的支持使得这个项目对我来说无法使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T15:21:55.427

您应该寻找“XSL 分析器”或“XSL 调试器”。有几十个。

# vb.net - VB.Net OOP 问题 - 超类、MyBase.net 和构造函数参数

> ID：643161
> 
> 赞同：0
> 
> 时间：2009-03-13T15:11:57.540
> 
> 标签：vb.net, oop

我有一个基类，它的 New 构造函数中包含相当多的参数。我有 7 个继承 Super 基类的子类。我的问题/问题是，所有子类对基类的 New 构造函数中的大多数参数使用相同的值，并且这些子类可以一个接一个地调用。我想填充超类的公共值，然后为每个子类使用这些值，但我想不出一个好方法来做到这一点。如果我能弄清楚如何做到这一点，我就不必在每个子类的 MyBase.New 调用中传递所有这些参数。我会尝试用一些代码来说明......

```
Public Class BaseRequest

    Public Sub New(ByVal param1 As String, ByVal param2 As String, ByVal param3 As String, ByVal param4 As String, ByVal param5 As String, ByVal param6 As String, ByVal param7 As String, ByVal param8 As String, ByVal param9 As String, ByVal param10 As String)

        'Private Level Variables Assigned Here'

    End Sub

End Class

Public Class SubClass1
    Inherits BaseRequest

    Public Sub New(ByVal param1 As String, ByVal param2 As String, ByVal param3 As String, ByVal param4 As String, ByVal param5 As String, ByVal param6 As String, ByVal param7 As String, ByVal param8 As String, ByVal param9 As String, ByVal param10 As String)

        MyBase.New(param1, param2, param3, param4, param5, param6, param7, param8, param9, param10)    
    End Sub

End Class

Public Class SubClass2
    Inherits BaseRequest

    Public Sub New(ByVal param1 As String, ByVal param2 As String, ByVal param3 As String, ByVal param4 As String, ByVal param5 As String, ByVal param6 As String, ByVal param7 As String, ByVal param8 As String, ByVal param9 As String, ByVal param10 As String)

        MyBase.New(param1, param2, param3, param4, param5, param6, param7, param8, param9, param10)    
    End Sub

End Class

Public Class SubClass3
    Inherits BaseRequest

    Public Sub New(ByVal param1 As String, ByVal param2 As String, ByVal param3 As String, ByVal param4 As String, ByVal param5 As String, ByVal param6 As String, ByVal param7 As String, ByVal param8 As String, ByVal param9 As String, ByVal param10 As String)

        MyBase.New(param1, param2, param3, param4, param5, param6, param7, param8, param9, param10)    
    End Sub

End Class

Private Sub CallClasses

    If CallClass1 Then
        Dim sClass1 As New SubClass1(Param1Value, Param2Value, Param3Value, Param4Value,  Param5Value, Param6Value, Param7Value, Param8Value, Param9Value, Param10Value)
    End If

    If CallClass2 Then
        Dim sClass2 As New SubClass2(Param1Value, Param2Value, Param3Value, Param4Value,  Param5Value, Param6Value, Param7Value, Param8Value, Param9Value, Param10Value)
    End If

    If CallClass3 Then
        Dim sClass3 As New SubClass3(Param1Value, Param2Value, Param3Value, Param4Value,  Param5Value, Param6Value, Param7Value, Param8Value, Param9Value, Param10Value)
    End If

End Sub 
```

我想摆脱每个子类中对“MyBase.New”的冗余调用，并且在我新建对子类的调用时必须填充参数。换句话说，做这样的事情......

```
Dim MySuperClass as New BaseRequest(Param1Value, Param2Value, Param3Value, Param4Value,  Param5Value, Param6Value, Param7Value, Param8Value, Param9Value, Param10Value)

If CallClass1 Then
    Dim sClass1 As SubClass1

    sClass1 = MySuperClass 'This Downcasting doesn't work, which is my problem.
End If

If CallClass2 Then
    Dim sClass2 As SubClass2
    sClass2 = MySuperClass 'This Downcasting doesn't work, which is my problem.
End If

If CallClass3 Then
    Dim sClass3 As SubClass3
    sClass3 = MySuperClass 'This Downcasting doesn't work, which is my problem.
End If 
```

我希望这是可以理解的。最好的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T15:38:16.387

哈波是正确的。

然而，这种情况听起来很适合工厂设计模式。您可以尝试将对象创建封装到另一个返回类型为 BaseRequest 的 [Factory] ​​类中。然后，这个工厂方法可以确定要创建哪种类型的对象，然后您可以检查返回对象的类型。例如

```
Public Class BaseRequestFactory

    Public Function CreateRequest(ByVal arg1 As Object,,,) As BaseRequest
        If condition1 Then
            Return New SubClass1(arg1,,,)
        Else If condition2 Then
            Return New SubClass2(arg1,,,)
        Else 
            ''etc
        End If
    End Function

End Class 
```

最后一件事; 正如您可能意识到的那样，拥有具有大量参数的方法并不是一个好习惯。看看您是否可以改用 get/set 属性，或者考虑将另一个类的实例作为参数传递给您的构造函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T15:30:11.943

您当前的方法是最好的方法。你应该接受这一点并继续前进。对 MyBase.New 的调用不是“多余的”——它们每个都说一些不同的东西，没有它们，你就不会得到你想要的行为。如果您查看框架本身中的子类构造函数，您会发现它是以相同的方式完成的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T15:41:03.820

*如果*您使用继承，则实际上没有替代传递参数的方法。但是，您可能会发现使用组合更合适。尝试使您的基类具体化并将其作为参数传递给其他类。

# linux - 当我按下键盘上的一个键并显示在外壳上时，实际发生的动作路径是什么？

> ID：643162
> 
> 赞同：5
> 
> 时间：2009-03-13T15:12:03.000
> 
> 标签：linux, shell, encoding

我使用的是通用 USB 键盘、带有 gnome 桌面、gnome-terminal 和 bash shell 的 Linux 2.6.27。我很想知道软件中发生了什么。我的键盘上的特殊字符是如何通过字符编码解释的，字符图片来自哪里？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-13T16:49:27.587

带有 USB 驱动程序的 Linux 输入层从键盘获取扫描码（基本上是“KEY 1 DOWN”“KEY 1 UP”）。

X 使用其键盘映射将扫描码转换为键盘码和 X 输入事件。

GTK 输入法将输入事件序列转换为组合的 Unicode 字符。

Gnome-terminal 将这些编码为 UTF-8 用于 shell。

壳牌不在乎。它只知道它正在处理多字节编码。

shell 通过 TTY 回显多字节编码的文本。

Gnome-terminal 解码传入的文本并确定 unicode 代码点。

Gnome-terminal 使用 GTK+ 工具绘制字符。

GTK+ 使用 Pango 渲染文本，并调用 X 库将像素绘制到屏幕上。

X 服务器将字符绘制到屏幕缓冲区中，然后视频卡显示它们。

这是我对图表的尝试：

[替代文字 http://osoft.us/system_layers.png](http://osoft.us/system_layers.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T15:38:49.020

分层看。首先是硬件，例如，Linux 内核中的设备驱动程序将具有通过设备中的状态寄存器和中断处理程序控制和响应键盘的特定方法。

接下来是 Linux 内核，它将有一些方法为在引导时检测到的每个硬件加载适当的驱动程序。加载后，设备驱动程序符合某些内核驱动程序接口，将数据从设备提供给内核，反之亦然。

在内核之外，在某种程度上，设备驱动程序和硬件是可见的，通常作为 /dev 目录中的列表。需要使用设备的软件（如终端仿真器）将通过 /dev 中的条目访问设备。

用户级应用程序和设备之间的通信现在通过一系列读/写和 ioctl 操作进行。这些陷阱进入内核（有关详细信息，请参阅这些手册页），此时内核与上面加载的设备驱动程序进行通信。

终端仿真器将在您键入字符时（在大多数情况下）以及从设备接收字符时（在大多数情况下）使用它可以访问的字体来显示字符，这些字体位于不同的位置，具体取决于应用程序。（我在这里泛泛而谈，因为我不具体了解 Gnome）。

这有帮助吗？

# html - 如何处理网页中不同长度的语言？

> ID：643169
> 
> 赞同：2
> 
> 时间：2009-03-13T15:13:04.730
> 
> 标签：html, css, layout, localization

我发现如果应用另一种语言，某些网页布局非常适合英语变得混乱。根本原因是某些语言中的某些单词太长并且将其他**div**推离了它们的最佳位置。

例如，

```
 <div style="width:40em; overflow: hidden">
        <div id="div1" style="float: left">Bla Bla Bla</div>
        <div id="div2" style="float: left">Something</div>
   </div> 
```

如果 div1 中的“Bla Bla Bla”被翻译成超过 40em 的某种语言，那么 div2 就会被推到看不见的地方。

是否有任何最佳实践来布局 Web 内容，以便它们可以完美地适用于任何语言环境？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T15:47:46.567

以下是允许多少空白的一些经验法则。这是基于初始英文文本长度的翻译字符串的额外增长率。

所以不会让我做一个合适的表格所以这是我的 ASCII 版本:)

```
    原始附加
    英语成长
    （字）国际
    1 到 4 100%
    5 到 10 80%
    11 至 20 60%
    21 至 30 40%
    31 至 50 20%
    超过 50 10%

```

远东语言（中文、日文、韩文）通常也需要更大的字体。

我敢告诉你这是从哪里来的吗？[VB6 程序员](http://msdn.microsoft.com/en-us/library/aa716226(VS.60).aspx)指南:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T15:26:42.590

添加更多空格。

如果您遇到文本溢出分配空间的问题，那么您可能需要确保分配更多空间。大多数设计都可以从给他们的内容更多的喘息空间中受益。

[http://www.alistapart.com/articles/whitespace](http://www.alistapart.com/articles/whitespace)

另一个考虑因素是尝试使包装无害。因此，如果您溢出的文本将其他内容推到了不合适的位置，那么也许您应该重新考虑设计，这样包装就不会伤害任何东西。

# c# - C#中的锁和互斥锁应该一起使用吗

> ID：643170
> 
> 赞同：8
> 
> 时间：2009-03-13T15:13:12.810
> 
> 标签：c#, locking, mutex

这不是矫枉过正，而且只有其中之一是必要的吗？[我在此处](https://stackoverflow.com/questions/301160/what-are-the-differences-between-various-threading-synchronization-options-in-c)和[此处](https://stackoverflow.com/questions/59590/lock-keyword-in-c)搜索并找到了有关 C# 中的互斥和锁定的不同帖子。

示例：
在我们的应用程序中，我们有一个分离多个重新连接线程的函数，在这个线程中我们使用 a`Mutex`和 a `lock`。不会`lock`阻止对这部分代码的访问并防止`connect`被任何其他线程更新吗？

```
bool connect = false;
Mutex reconnectMutex = new Mutex(false, "Reconnect_" + key);

try
{
   lock(site)
   {
      if(site.ContainsKey(key))
      {
         siteInfo = (SiteInfo)site[key];
         if(reconnectMutex.WaitOne(100, true))
         {
            connect = true;
         }
      }
   }

   if (connect)
   { 
      // Process thread logic
   }
}
catch
{}

reconnectMutex.ReleaseMutex(); 
```

更多信息：
这是在 ASP.NET WebService 中，不在 Web Garden 中运行。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-13T15:17:05.797

该 Mutex（因为它有一个名称）也会停止同一台机器上访问它的任何进程，而 lock 只会停止同一进程中的其他线程。从那个代码示例中我看不出为什么你需要两种锁。将简单的锁保持一小段时间似乎是一种好习惯——但随后更重的进程间互斥锁可能会被锁定更长的时间（尽管重叠）！只使用互斥锁会更简单。也许是为了找出进程间锁是否真的有必要。

顺便说一句，`catch {}`在那种情况下使用绝对是错误的。你应该使用`finally { /* release mutex */ }`. 它们非常不同。catch 将吞下比它应该的更多种类的异常，并且还将导致嵌套的 finally 处理程序执行以响应低级异常，例如内存损坏、访问冲突等。所以而不是：

```
try
{
    // something
}
catch
{}

// cleanup 
```

你应该有：

```
try
{
    // something
}
finally
{
    // cleanup
} 
```

如果您可以从中恢复特定的异常，您可以捕获它们：

```
try
{
    // something
}
catch (DatabaseConfigurationError x)
{
    // tell the user to configure the database properly
}
finally
{
    // cleanup
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-13T15:21:14.803

"lock" 基本上只是 Montor.Enter/Exit 的语法糖。互斥锁是一种多进程锁。

他们有非常不同的行为。在同一个应用程序或方法中使用两者并没有错，因为它们旨在阻止不同的事物。

但是，就您而言，我认为您最好研究一下信号量和监视器。听起来您不需要跨进程锁定，因此在这种情况下它们可能是更好的选择。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-13T19:12:45.277

正如其他人指出的那样，互斥锁跨进程锁定，本地锁（监视器）仅锁定当前进程拥有的那些线程。然而 ...

您显示的代码有一个非常严重的错误。看起来您在最后（即）无条件地释放了 Mutex ，但只有在返回时`reconnectMutex.ReleaseMutex()`才会获取 Mutex 。`site.ContainsKey()``true`

因此，如果`site.ContainsKey`返回`false`，则释放互斥锁将抛出`ApplicationException`，因为调用线程不拥有互斥锁。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-13T15:22:55.750

您没有提供足够的信息来真正回答这个问题。正如 Earwicker 所述，Mutex 允许您跨进程进行同步。因此，如果您运行同一应用程序的两个实例，则可以序列化访问。例如，您可以在使用外部资源时这样做。

现在，您锁定站点可保护站点免受同一进程中其他线程的访问。这可能是必要的，具体取决于其他方法/线程正在做什么。现在，如果这是该站点被锁定的唯一地方，那么是的，我认为这是矫枉过正。

# sql-server-2008 - 对 2000 行数据使用批量插入

> ID：643171
> 
> 赞同：1
> 
> 时间：2009-03-13T15:13:50.233
> 
> 标签：sql-server-2008, bulkinsert

对 2000 行数据使用批量插入有意义吗？

实际可能是500-2K。

顺便说一句，批量插入会忽略约束还是设置？

（在服务器端使用 sql server 2008 和 .net，数据通过 Web 服务（wse 或 WCF）进入）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T15:18:08.570

批量插入对于 2000 行可能没有意义。可能有 200,000 行。

忽略约束是[默认行为](http://msdn.microsoft.com/en-us/library/ms186247.aspx)。（也在[这里](http://msdn.microsoft.com/en-us/library/ms188365.aspx)描述）。

> `CHECK_CONSTRAINTS`
> 
> 指定在批量导入操作期间必须检查目标表或视图上的所有约束。如果没有 CHECK_CONSTRAINTS 选项，任何 CHECK 和 FOREIGN KEY 约束都将被忽略，并且在操作之后，表上的约束被标记为不可信。
> 
> **注意：** 始终强制执行 UNIQUE、PRIMARY KEY 和 NOT NULL 约束。

“ ”的“ `KEEPIDENTITY`”选项`BULK INSERT`：

> 指定将导入数据文件中的一个或多个标识值用于标识列。如果未指定 KEEPIDENTITY，则验证此列的标识值但不导入，SQL Server 会根据创建表期间指定的种子值和增量值自动分配唯一值。

# c# - 来自 COM 插件的 SheetBeforeDoubleClick

> ID：643172
> 
> 赞同：1
> 
> 时间：2009-03-13T15:13:58.270
> 
> 标签：c#, excel, vba, com, add-in

我正在尝试在 C# 中为 Excel XP 编写一个 COM 插件，该插件禁止双击单元格进行编辑。

我想弹出一个框，说禁止以这种方式编辑单元格，然后停止所有执行。

浏览 Microsoft 的文档，这似乎是一项非常简单的任务，您可以`AppEvents_SheetBeforeDoubleClickEventHandler`使用签名创建一个 Application 事件，并将其`func(object sheet, Range Target, ref bool Cancel)`设置`Cancel`为 true 以便停止执行。

我有以下内容：

```
public void OnConnection(object application, Extensibility.ext_ConnectMode connectMode, object addInInst, ref System.Array custom)
{
    Excel.Application app = application as Excel.Application;
    app.SheetBeforeDoubleClick += Excel.AppEvents_SheetBeforeDoubleClickEventHandler(beforeDoubleClick);
}

void beforeDoubleClick(object sheet, Excel.Range Target, ref bool Cancel)
{
    MessageBox.Show("Cannot edit cells this way sorry.");
    Cancel = true;
} 
```

显示消息框，但随后将单元格置于编辑模式，但是，如果我从 VBA 获得相同的东西，它就可以工作。

使用以下代码的 VB.NET 插件也会发生同样的情况。

```
Private WithEvents app As Excel.Application
Public Sub OnConnection(ByVal application As Object, 
                            ByVal connectMode As Extensibility.ext_ConnectMode, 
                            ByVal addInInst As Object, 
                            ByRef custom As System.Array) 
                            Implements Extensibility.IDTExtensibility2.OnConnection
    app = application
End Sub

Sub Worksheet1_BeforeDoubleClick(ByVal obj As Object, 
                                 ByVal Target As Excel.Range, 
                                 ByRef Cancel As Boolean) 
                                 Handles app.SheetBeforeDoubleClick
    MsgBox("Double-clicking in this sheet is not allowed.")
    Cancel = True
End Sub 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T21:48:09.320

我执行您的代码没有问题：“取消”阻止了双击操作。

一些搜索从 MSKB 中发现了以下内容：[BUG：Office 事件的取消参数在 Visual Studio .NET 2003 中被忽略](http://support.microsoft.com/default.aspx/kb/830519)。

在使用使用 Visual Studio .NET 2003 (.NET Framework 1.1) 创建的 .NET 代码时，Excel 2002 及更低版本似乎存在这种忽略取消参数的行为。

文章中给出了一个复杂的解决方法，涉及手动调整互操作程序集。不过，如果付出相当大的努力，它看起来还是很可行的。

升级到 VS 2005 或 VS 2008 会更容易。我使用面向 .NET 3.5 的 VS 2008 编译了我的代码，并在 Excel 2007 上运行了我的代码。

顺便说一下，用户将能够通过在公式栏中键入、执行复制-粘贴命令等来输入值。为了防止用户输入值，您可以改为保护工作表。

# python - 正则表达式有助于将 exp1^exp2 转换为 pow(exp1, exp2)

> ID：643173
> 
> 赞同：2
> 
> 时间：2009-03-13T15:14:07.927
> 
> 标签：python, c, regex

我正在将一些 matlab 代码转换为 C，目前我有一些使用 ^ 具有权力的行，这很容易用这些行来做`\(?(\w*)\)?\^\(?(\w*)\)?`

`(glambda)^(galpha)`使用python中的子例程可以很好地进行转换`pattern.sub(pow(\g<1>,\g<2>),'(glambda)^(galpha)')`

我的问题来自嵌套括号

所以我有一个像这样的字符串：

`glambdastar^(1-(1-gphi)*galpha)*(glambdaq)^(-(1-gphi)*galpha);`

而且我不知道如何将该行转换为：

`pow(glambdastar,(1-(1-gphi)*galpha))*pow(glambdaq,-(1-gphi)*galpha));`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T15:21:04.257

不幸的是，正则表达式不是处理嵌套结构的正确工具。有一些正则表达式引擎（例如 .NET）支持递归，但大多数（包括 Python 引擎）不支持，并且只能处理构建到表达式中的嵌套级别（这会很快变得丑陋） ）。

你真正需要的是一个简单的解析器。例如，遍历字符串计数括号并将它们的位置存储在列表中。当你找到一个`^`字符时，将最近的右括号组放入一个“左”变量中，然后观察下一个左括号组成的组。当它关闭时，将其用作“正确”值并打印`pow(left, right)`表达式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T15:30:57.697

我认为你可以在这里使用递归。

一旦你弄清楚左右部分，再次将它们传递给你的函数。基本情况是找不到 ^ 运算符，因此您不需要将 pow() 函数添加到结果字符串中。

该函数将返回一个字符串，其中包含所有正确的 pow()。如果你愿意，我会举一个例子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T15:19:04.887

嵌套括号不能用正则表达式描述，需要完整的解析器（能够理解语法，这比正则表达式更强大）。我认为没有解决办法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T15:23:50.197

请参阅最近的讨论[function-parser-with-regex-in-python](https://stackoverflow.com/questions/637773/function-parser-with-regex-in-python)（许多类似讨论之一）。然后按照[pyparsing](http://pyparsing.wikispaces.com/)的建议进行操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T15:23:58.963

另一种方法是迭代直到所有 ^ 都用完。不？。

红宝石代码：

```
# assuming str contains the string of data with the expressions you wish to convert
while str.include?('^')
  str!.gsub!(/(\w+)\^(\w+)/, 'pow(\1,\2)')
end 
```

# flash - 使用 NPAPI 在自定义桌面应用程序中嵌入闪存？

> ID：643177
> 
> 赞同：3
> 
> 时间：2009-03-13T15:15:16.130
> 
> 标签：flash, plugins, npapi

注意：请不要*只使用 Adob​​e AIR*回答。我知道​​，它不适用于这种情况。

我一直在查看[Gecko 插件 API 参考](https://developer.mozilla.org/en/Gecko_Plugin_API_Reference)。

我假设我必须实现所有必需的浏览器端功能。我的目标是能够在低级别访问 Flash 的图形输出，以便将它们与其他本地代码一起集成到应用程序中。Adobe AIR 是一种未来的可能性，但对于这个项目来说，性能还远远不够好。

有谁知道充当 NPAPI 插件主机的开源项目？我想替代方案是从 WebKit 等中提取必要的位。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-14T09:57:01.940

是的，看看 ScreenweaverHX：

[http://haxe.org/com/libs/swhx](http://haxe.org/com/libs/swhx)

[http://code.google.com/p/screenweaver-hx/](http://code.google.com/p/screenweaver-hx/)

高温高压

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-07-15T17:25:30.160

nspluginwrapper 实现了浏览器端的 npapi 来制作一个代理，允许在 64 位浏览器中使用 32 位插件，并且代码行数比浏览器少，如果你想实现它，这可能是一个很好的起点。

也可能不相关但针对类似环境的是 chromeless，它是 Firefox 的衍生产品，它是一种没有界面的轻量级浏览器，可用于使用 html、javascript 和插件制作桌面应用程序。

# c# - 如何使用可能不存在的 .NET Framework 版本安全地检查 .NET Framework 版本？

> ID：643201
> 
> 赞同：3
> 
> 时间：2009-03-13T15:19:59.987
> 
> 标签：c#, .net

我有一个使用 .NET 3.5 构建的应用程序。如果用户在未安装 .NET 3.5 的情况下运行它，我希望控制他们看到的内容，并可能提供他们可以理解的消息（带有指向 .NET 3.5 的链接）与未处理的异常堆栈跟踪。但如果他们实际上没有 .NET 3.5，我的应用程序怎么能控制任何东西？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T15:25:07.977

您是否假设至少安装了某些版本的 .NET？

您可以编写一个与所有版本兼容的小型加载程序来进行检查。

或者，如果没有安装 .NET，找到一个简单的批处理程序（尽管如果您愿意，这可以很容易地在 C++ 中完成）。

```
@ECHO OFF
SET FileName=%windir%\Microsoft.NET\Framework\v1.1.4322
IF EXIST %FileName% GOTO Skip
ECHO.You currently do not have the Microsoft® .NET Framework 1.1 installed.
ECHO.This is required by the setup program for MyApplication.
ECHO.
ECHO.The Microsoft® .NET Framework 1.1 will now be installed on you system.
ECHO.After completion setup will continue to install MyApplication on your system.
ECHO.
Pause
SET FileName=
Start /WAIT .\dotnetfx.exe
Start .\Setup.exe
ECHO ON
Exit
Tongue Tiedkip
SET FileName=
Start .\Setup.exe
ECHO ON
Exit 
```

[这](http://msdn.microsoft.com/en-us/kb/kb00318785.aspx)也可能有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T15:35:40.527

您可以考虑使用需要安装 3.5 的安装程序。如果用户无法运行，这将阻止应用程序首先到达用户手中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-13T16:07:23.133

更好的是，您可以使用安装程序技术，例如 Wix 或 Visual Stuido 安装项目，在安装过程中检查您的软件的所有先决条件，例如特定的 .NET 框架运行时是否存在。如果没有，它将安装它们，或者至少告诉用户在哪里获取它们以及下一步做什么

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-13T16:01:01.010

您需要一个检查 .NET 运行时的非 .NET EXE 文件。它可以写成任何你知道存在于目标 PC 中的东西。例如，如果面向 Windows 2000 或更高版本，您知道存在 Visual Basic 6.0 运行时，因此您的安装程序可以始终启动 Visual Basic 6.0 启动应用程序，该应用程序在启动 .NET EXE 文件之前检查运行时。更好的方法是编写一个不依赖于除 Windows API 之外的任何运行时的 C++ 应用程序。

# c# - 将 C++ 字符串发送到 C# 字符串。互操作

> ID：643202
> 
> 赞同：2
> 
> 时间：2009-03-13T15:20:47.877
> 
> 标签：c#, c++, string, interop, sendmessage

我是进程间通信的新手，需要一些帮助。我希望能够将字符串从 C++ 程序发送到 C# 程序。我的问题是生成的字符串是乱码。这是我的代码：

发送程序（C++）：

```
void transmitState(char* myStr)
{

    HWND hWnd = ::FindWindow(NULL, _T("myApp v.1.0"));
    if (hWnd)
    {
        COPYDATASTRUCT cds;
        ::ZeroMemory(&cds, sizeof(COPYDATASTRUCT));
        cds.dwData = 0;
        cds.lpData = (PVOID) myStr;
        cds.cbData = strlen(myStr) + 1;

        ::SendMessage(hWnd, WM_COPYDATA, NULL, (LPARAM)&cds);
    }
} 
```

以及接收程序（C#）（我已经覆盖了 WndProc）：

```
private void OnCopyData(ref Message m)
{
    COPYDATASTRUCT cds = new COPYDATASTRUCT();
    cds = (COPYDATASTRUCT)Marshal.PtrToStructure(m.LParam, typeof(COPYDATASTRUCT));

    String myStr;
    unsafe
    {
        myStr = new String((char*) cds.lpData);
    }

    label1.Text = myStr;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T15:25:41.300

C++ 中的 char* 是 ANSI 字符串（通常每个字符一个字节），C# 中的 char* 是 Unicode 字符串（如 WCHAR* - 每个字符两个字节）。

实际上，您将 char* 重新解释为 WCHAR*。这行不通。在 C++ 端使用 MultiByteToWideChar() 进行转换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T15:26:29.410

您在 C++ 中的字符串是 ANSI。您需要在 C# 的某个地方转换为 Unicode。自从我做互操作以来已经有几年了，所以其他人将不得不告诉你具体如何做到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T15:29:48.823

您必须以某种方式将字符数组从 ASCII 转换为 Unicode。[这是一个可以从 C# 方面帮助完成的页面](http://www.dreamincode.net/forums/showtopic63794.htm)。

# sql - where 子句中的条件顺序会影响查询的速度吗？

> ID：643207
> 
> 赞同：0
> 
> 时间：2009-03-13T15:22:17.093
> 
> 标签：sql, performance

where 子句中的条件顺序会影响查询的速度吗？

例如，可以：

```
select fname, lname 
from people 
where isValid = 1 and lname like '%test%' 
```

比

```
select fname, lname 
from people 
where lname like '%test%' and isValid = 1 
```

**重复：** [WHERE 子句中列的顺序是否重要？](https://stackoverflow.com/questions/642784/does-the-order-of-columns-in-a-where-clause-matter)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T15:34:46.237

如果是这样，您认为这会是 Stack Overflow 上的一个晦涩问题吗？

如果 where 子句的顺序很重要，你不觉得吗

*   供应商将记录这一点。

*   将有 3rd 方工具来优化您的 where 子句。

*   会有特殊的 JDBC 或 DAO 包装器，它们会根据您提供的某些标准重新排序您的 where 子句以优化性能。

*   对于一种优化策略相对于另一种优化策略的微妙之处，将会发生巨大的宗教战争。

由于这些都不是真的，您可以放心地打赌，where 子句被分解为“合取范式”进行处理，原始结构完全丢失。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T15:25:09.553

取决于[查询优化器](http://en.wikipedia.org/wiki/Query_optimizer)。一般来说，好的优化器会根据索引统计将顺序更改为最佳优化器。但并非所有数据库都有好的优化器。

# .net - 如何诊断 SqlDbType 上的 ArgumentOutOfRangeException？

> ID：643211
> 
> 赞同：0
> 
> 时间：2009-03-13T15:22:51.943
> 
> 标签：.net, sql-server, thick-client

我们有一些使用我们的 .NET 2.0 胖客户端应用程序的客户在从 SQL 2000 SP4 Server 读取数据时遇到奇怪的间歇性错误，而这些操作刚刚成功。我们有一些使用 SQL 2000 的客户（还有许多使用 2005）不会发生这些错误。

我注意到的一件事是我们测试环境中的应用程序引用了 System.Data 2.0.50727。**3053** ; 而应用程序引用 2.0.50727。**1433**在客户的系统上。这两个修订版有什么区别，是否与下面描述的错误有关？

这是错误堆栈跟踪的示例，其中枚举值为 8，但我还有更多实例，其中“越界”枚举值为 4 或 14，具有相同的确切堆栈跟踪。枚举值是否有时可以找到，但有时却不能？当应用程序的同一部分运行时没有错误怎么办？

```
TYPE: System.ArgumentOutOfRangeException
MSG: The SqlDbType enumeration value, 8, is invalid.
Parameter name: SqlDbType
SOURCE: System.Data
SITE: GetSqlDataType

at System.Data.SqlClient.MetaType.GetSqlDataType(Int32 tdsType, UInt32 userType, Int32 length)
at System.Data.SqlClient.TdsParser.CommonProcessMetaData(TdsParserStateObject stateObj, _SqlMetaData col)
at System.Data.SqlClient.TdsParser.ProcessMetaData(Int32 cColumns, TdsParserStateObject stateObj)
at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
at System.Data.SqlClient.SqlDataReader.ConsumeMetaData()
at System.Data.SqlClient.SqlDataReader.NextResult()
at Ceoimage.Basecamp.Data.Document._GetDocumentModelWithCollections(IDataReader rdr) 
```

**更新：**我刚刚从客户的一个工作站下载了 System.Data。他们在 GAC 中有两个版本，一个在 GAC 目录中，一个在 GAC_32 目录中。在 GAC 中，版本号为 1.14322.2365。在 GAC_32 中，版本号为 2.0.50727.1433，如上所述。但是，在所有三个版本中，SqlDbType 可枚举将相同的 int 值映射到错误消息中的相同类型：

```
DateTime = 4
Int = 8
UniqueIdentifier = 14 
```

恐怕这个版本可能是一个红鲱鱼：如果问题与框架版本有关，那么问题不应该 100% 发生而不是暂时发生吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-11-07T16:21:21.463

[这个古老的讨论](http://bytes.com/topic/c-sharp/answers/502397-ado-connection-still-connecting-after-open)跟踪了一个类似的错误，即使用在一个线程上创建的连接在不同的线程中运行查询。SqlConnection [“不保证实例成员是线程安全的”](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection.aspx)。如果您的应用程序是多线程的，请确保正确使用连接。

该问题也可能是 SQL-Server 端已在较新版本中解决的问题。

我在这里回答是因为我在将 SqlCommand.Cancel 与 SQL 2005 一起使用时遇到了这个错误。（根据查询被取消的时间，除了“用户取消操作”之外，还会发生一些异常。）我看到了作为“来自服务器的意外响应”错误……如果确实发生，清除连接池可能是个好主意。

[如何取消长时间运行的数据库操作？](https://stackoverflow.com/questions/889102/how-to-cancel-a-long-running-database-operation/3699391#3699391)

[如何在使用连接池时强制 SqlConnection 物理关闭？](https://stackoverflow.com/questions/1145892/how-to-force-a-sqlconnection-to-physically-close-while-using-connection-pooling)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T15:31:12.173

您的客户端在未安装 3.5 的 .NET 2.0 上。您的测试服务器是 3.5。在 3.5 中添加到枚举中的唯一内容是：

```
Structured
Date
Time
DateTime2
DateTimeOffset 
```

这并不意味着没有一些潜在的变化。

如果可能的话，我会在没有安装 3.5 的情况下测试 2.0 下的应用程序，看看你遇到了什么错误。这应该给你一个很好的起点。

为了找出错误点，我必须遍历枚举并查看项目在枚举中的顺序。Reflector 是执行此操作的绝佳工具，但您必须在 2.0 系统和 3.5 系统上执行此操作才能看到更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-29T09:59:01.493

此[解决方案](https://stackoverflow.com/a/2407194)可能会解决您的问题：

> 您的本地机器是否使用 SQL Server 2008，而另一个机器是 2005？@RUNTIME 参数是 SqlDbType.Time 类型。SQL Server 2005 中不存在该类型。此外，如异常所述，SqlDbType.Time 的值为 32。您不能只存储 sql server 2008 之前的时间值。您必须在 2005 年将 @RUNTIME 存储为 SqlDbType.DateTime。

而如果你使用**.NET Framework 2.0** 使用必须安装**.NET Framework 2.0 SP2**和 sql2008 来解决这个问题。

# asp.net - 什么是在 asp.net 中返回验证器状态的内置 javascript 函数

> ID：643216
> 
> 赞同：0
> 
> 时间：2009-03-13T15:23:23.580
> 
> 标签：asp.net, javascript, jquery, validation

这是一个很难问的问题。我正在使用 asp.net 验证器，但我想将它们绑定到我与 jQuery 绑定的简单单击事件。

我发现我可以使用：

```
ValidatorValidate($("#<%= rfvFirst.ClientID %>")[0]); 
```

触发**rfvFirst**验证器，但我不知道如何在某处获得实际的错误返回以告诉我表单无效。

我所需要的只是我可以在（客户端）调用的函数或变量或属性来告诉我表单是否有效。

我希望这是有道理的，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-13T15:26:42.590

如果您使用验证组，您可以执行以下操作：

```
if (Page_ClientValidate('Group Name'))
{
 //Valid
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T15:38:39.677

Page_IsValid 会告诉你页面是否有效。您还可以使用验证器的 isvalid 属性来验证单个验证器。

# data-structures - 这个内存查找表的最佳数据结构是什么？

> ID：643217
> 
> 赞同：5
> 
> 时间：2009-03-13T15:23:24.940
> 
> 标签：data-structures, dictionary, lookup

我需要将查找表作为实例成员存储在我的一个类中。构造对象时将初始化该表。每个“行”将有 3 个“列”：

```
StringKey (e.g., "car")
EnumKey (e.g., LookupKeys.Car)
Value (e.g, "Ths is a car.") 
```

我想选择能够通过 StringKey***或***EnumKey 进行查找时产生最佳性能的数据结构。

对于相同的字典值有 2 个键有点尴尬。我以前从未遇到过这种情况，所以我想知道这种事情的标准是什么。

我可以创建一个键/值/值结构而不是键/键/值，但我想知道这会产生什么样的性能影响。

我在想这一切都错了吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-13T15:26:02.623

嗯......“错误”是一种苛刻的说法。我认为，因为最常见的字典是“值的单键”，并且为此（映射）提供有效的数据结构付出了很多努力，所以通常最好只使用其中的两个，共享值的内存，如果完全有可能。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-13T15:31:55.463

你有两个哈希图。

*   一个从 StringKey 到 value。

*   一个从 EnumKey 到 value。

您不必复制所有 Value 实例，这些对象可以在两个 hashmap 之间共享。

如果项目很多，您可能希望使用两个树形图而不是两个哈希图。但基本原则（“分享价值观”）适用于这两种结构。一组带有两个映射的值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T15:36:34.907

真的有必要用两种类型的键键入相同的结构吗？您可能不需要自己重建复杂的数据结构。您可以对查找表进行某种封装，以便在内存不是问题的情况下真正拥有两个查找表。您可以使用此封装结构来模拟能够使用任一类型的键从“相同”结构中提取值。

或者

如果有某种方法可以在枚举值和字符串键之间进行映射，那么您可以只使用一种类型的查找表就可以走这条路。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T16:11:19.067

LINQ 的 ILookup(TKey, TElement) 接口可能会有所帮助。假设您的字典类似于：

```
Dictionary<carKey, carValue> cars; 
```

你可以使用：

```
ILookUp<carValue, carKey> lookup = cars.ToLookup(x => x.Value, x => x.Key); 
```

（......实际上我认为我可能稍微误读了这个问题 - 但 ILookUp 可能仍然符合要求，但键/值集可能需要是键和枚举。）

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-13T16:51:25.523

如果保证每个值都可以被两种类型的键访问，另一种想法是将一种类型的键转换为另一种类型的键。例如：

```
public Value getValue(String key)
{
    dictionary.get(key); // normal way
}

public Value getValue(Enum enumKey)
{
    String realKey = toKey(enumKey);
    getValue(realKey); // use String key
} 
```

您可以让您的 Enum 实现一个 toKey() 方法来返回它们的 String 键，或者可能有另一个字典将 Enum 值映射到 String 对应项。

# javascript - “请稍候……”、“加载中”、“正在保存”、“生成”实现

> ID：643224
> 
> 赞同：0
> 
> 时间：2009-03-13T15:25:05.170
> 
> 标签：javascript, html, ajax, yui

在使用 HTML、Ajax 或 YUI（通常是 JavaScript）的浏览器中，“请稍候，我们正在处理您的请求”的成功和优先实现是什么？

其他上下文是，我处理的 Web 应用程序有一些请求可能需要大量的 IO/CPU 时间（10 - 30 秒），并且需要与用户沟通我们收到您的请求并且我们正在处理它。

编辑：另一方面是你有没有看到一个给你留下深刻印象的网站实现？*你喜欢的例子*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-13T15:30:11.130

对于需要这么长时间的事情，你应该使用进度条或类似的东西。例如：

*   jQuery [http://jqueryui.com/demos/progressbar/](http://jqueryui.com/demos/progressbar/)
*   道场[http://dojocampus.org/explorer/#Dijit_Progress%20Bar_Typing%20Monitor](http://dojocampus.org/explorer/#Dijit_Progress%20Bar_Typing%20Monitor)
*   YUI [http://developer.yahoo.com/yui/examples/container/panel-loading.html](http://developer.yahoo.com/yui/examples/container/panel-loading.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-13T15:29:11.400

使指示器：明显、突出，并且始终出现在同一个位置或由单击以启动操作的控件显示。根据您的应用程序的受众，现在无处不在的[“加载圈”](http://www.ajaxload.info/)可以解决问题，但在它旁边添加一个“正在加载...”并没有什么坏处。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T15:43:51.410

@vartec 提供了规范的 YUI 示例。一位名叫 Satyam 的优秀西班牙开发人员也有一个有趣的 YUI 实现，如果您可以在要求用户等待的时间提供进度反馈。

[萨蒂扬的进度条](http://satyam.com.ar/yui/2.5.0/progressbar/index.html)。适用于 YUI 2.x 和 YUI 3.x，预计将在后续版本中成为官方 YUI 库的一部分。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-13T15:47:55.207

通常，您会在那里放置一个带有[旋转轮/颤动器](http://en.wikipedia.org/wiki/Throbber)的阻塞覆盖层作为忙碌指示器。Dojo 提供了一些现成的工具：[Busy Button](http://docs.dojocampus.org/dojox/form/BusyButton)和更通用的[Standby](http://docs.dojocampus.org/dojox/widget/Standby)。

# visual-studio-2008 - Web 部署项目，Team Suite 2008

> ID：643227
> 
> 赞同：0
> 
> 时间：2009-03-13T15:25:19.193
> 
> 标签：visual-studio-2008, tfs

我在本地构建时得到以下信息

```
 Granting IIS read access to the folder 'C:\Projects\YourClubMatters\Trunk\YCM\WebSite_deploy\Release'.
C:\Program Files\MSBuild\Microsoft\WebDeployment\v9.0\Microsoft.WebDeployment.targets(676,5): error : Some or all identity references could not be translated.
Warning: Unable to grant IIS access to folder 'C:\Projects\YourClubMatters\Trunk\YCM\WebSite_deploy\Release'. 
```

在本地或团队基础服务器上构建时出现此错误。

不完全确定如何解决它，让 iis 应用程序池和网站以 tfs 用户身份运行，因此查看网站没有任何问题，但该错误真的很烦人，因为它总是告诉我我的构建已损坏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-13T15:35:38.590

对有问题的文件夹运行审核并找出失败的访问尝试。这将告诉您哪个帐户有问题。然后，您可以授予该帐户的访问权限，您的错误就会消失。

如果您无法设置审核，请与您的网络人员交谈并告诉他们您正在解决什么问题。

我不确定在这种情况下 IIS 可能会使用哪个帐户。它可能是实际运行服务的帐户（可能？），但可能涉及另一个帐户。即使您使用的是 TFS 帐户（很可能是管理员），它也会将工作委派给 IIS 进行部署。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-31T13:54:33.157

我找到了解决问题的方法：http: [//lacy.ie/web-deployment-project-iis-deploy-error-on-team-foundation-server/](http://lacy.ie/web-deployment-project-iis-deploy-error-on-team-foundation-server/)

# c# - C# 链接分析器收到错误请求错误？

> ID：643231
> 
> 赞同：0
> 
> 时间：2009-03-13T15:26:21.327
> 
> 标签：c#, httpwebrequest

我有一个相当简单的程序，它接受一个 URL 并吐出它重定向到的第一个位置。无论如何，我一直在一些链接上对其进行测试，并注意到在一些 url 上出现 400 个错误。我尝试通过将其粘贴到我的浏览器中来测试这些 url，并且效果很好。

```
 static string getLoc(string curLoc, out string StatusDescription, int timeoutmillseconds)
    {
        HttpWebRequest x = (HttpWebRequest)WebRequest.Create(curLoc);            
        x.UserAgent = "Opera/9.52 (Windows NT 6.0; U; en)";
        x.Timeout = timeoutmillseconds;            
        x.AllowAutoRedirect = false;
        HttpWebResponse y = null;
        try
        {
            y = (HttpWebResponse)x.GetResponse(); //At this point it throws a 400 bad request exception. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-13T17:35:48.100

我认为饼干正在发生一些奇怪的事情。事实证明，由于我测试链接的方式，它工作所需的 cookie 在我的浏览器中，但不在链接中。事实证明，我手动测试的一些链接（当其他链接失败时）正在生成 cookie。

发生的事情有点令人费解，但简短的回答是我的浏览器有 cookie，程序没有，在重定向之间维护 cookie 并没有解决问题。

根本问题是由于我正在测试的链接需要额外参数或 cookie 或两者兼而有之。我试图在我的测试中避免这两种情况，因为参数/cookie 用于跟踪并且我不想中断跟踪。

简而言之，我知道问题是什么，但这不是一个可以解决的问题。

# asp.net-mvc - 请帮我清理我的 ASP.NET MVC 标签汤

> ID：643237
> 
> 赞同：0
> 
> 时间：2009-03-13T15:27:26.567
> 
> 标签：asp.net-mvc

我正在为我的网站创建一个菜单。它有一个层次结构。

这就是我想要的：

*   曾祖父母
    *   祖父母
        *   家长
            *   兄弟姐妹1
            *   兄弟姐妹2
            *   兄弟姐妹3
            *   自己
                *   孩子1
                *   孩子2
                *   孩子3

HTML：

```
<ul>
    <li><a href="/389">Great Grandparent</a>
        <ul>
            <li><a href="/456">Grandparent</a>
                <ul>
                    <li><a href="/389">Parent</a>
                        <ul>
                            <li><a href="/986">Sibling1</a></li>
                            <li><a href="/983">Sibling2</a></li>
                            <li><a href="/418">Sibling3</a></li>
                            <li><strong>Self</strong>
                                <ul>
                                    <li><a href="/310">Child1</a></li>
                                    <li><a href="/953">Child2</a></li>
                                    <li><a href="/927">Child3</a></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
            </li>
        </ul>
    </li>
</ul> 
```

这是我的 ASPX 页面中的代码。这有效：

```
<% For Each Ancestor As Node In ViewData("Ancestors")%>
    <ul>
        <li><%=Html.RouteLink(Html.Encode(Ancestor.Name), "IdOnly", New With {.id = Ancestor.Id})%>
<% Next%>
            <ul>
<% For Each Sibling As Node In ViewData("Siblings")%>
                <li><%=Html.RouteLink(Html.Encode(Sibling.Name), "IdOnly", New With {.id = Sibling.Id})%></li>
<% Next%>
                <li><strong><%=Html.Encode(Model.Name)%></strong>
<% If Model.Children.Count > 0 Then%> 
                    <ul>
    <% For Each Child As Node In ViewData("Children")%>
                        <li><%=Html.RouteLink(Html.Encode(Child.Name), "IdOnly", New With {.id = Child.Id})%></li>
    <% Next%>
                    </ul>
<% End If%>
                </li>
            </ul>
<% For Each Ancestor As Node In ViewData("Ancestors")%>
        </li>
    </ul>
<% Next%> 
```

该 ASPX 页面似乎很难阅读。我怎样才能清理它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T15:51:05.247

更好的解决方案是创建一个不存在的 html 助手。

看看这个问题以获得有关如何做到这一点的想法

[用于 YUI 控件（雅虎用户界面）的 ASP.NET MVC HtmlHelper 扩展？](https://stackoverflow.com/questions/478927/asp-net-mvc-htmlhelper-extensions-for-yui-controls-yahoo-user-interfaces)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T15:32:34.933

我建议的一件事是在编写父标签之前检查应该在“li”标签中的项目数，否则您最终可能会得到无法验证的空“ul”标签。如果这没有意义，我稍后会在有更多时间时详细说明。就格式而言，也许更多的缩进可能会使它更易于阅读。

# wcf - WCF 客户端调用单向操作的问题

> ID：643241
> 
> 赞同：24
> 
> 时间：2009-03-13T15:28:08.173
> 
> 标签：wcf, soap, sap-pi, sap-xi

从我的 WCF 客户端调用 SAP PI 总线上的 Web 服务时遇到问题。操作定义为单向，我的代理操作合约上的方法在添加服务引用时进行了相应的修饰。但是，服务客户端在调用相应操作时会出现异常：

***单向操作返回了一条带有 Action='' 的非空消息***

使用 SoapUI，可以成功调用总线上的方法，并返回一个空主体的 SOAP 信封。巴士人员告诉我，这是根据 SOAP 规范：

* * *

（SOAP 规范，第 4.7.9 章，单向操作）：

在执行单向操作时如何使用 HTTP 有不同的解释。

**R2714**对于单向操作，实例不得返回包含信封的 HTTP 响应。具体来说，HTTP 响应实体主体必须为空。

**R2750**消费者必须在单向操作中忽略 HTTP 响应消息中携带的信封。

**R2727**对于单向操作，消费者不得将成功的 HTTP 响应状态代码（即 2xx）解释为消息有效或接收者将处理它。

* * *

看来，我的 WCF 客户端不符合 R2750。

我发现当我强制代理上的操作合同为*IsOneWay = false*时，一切正常。

WCF 处理单向操作的方式有什么问题，还是我做错了什么（更有可能）？还有什么我应该做的吗，覆盖生成的 WCF 代理客户端似乎不正确。

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-13T18:29:24.520

看起来 SAP PI 错误地发送了一个空的 SOAP 信封，而 .NET 错误地解释了该信封。

[该线程](http://www.go4answers.com/Example/exception-while-making-way-call-wcf-56416.aspx)的一些选项：

*   更改生成的代理并删除 OneWay=true（或添加 OneWay=false）到方法定义
*   在异常处理程序中捕获协议冲突并忽略它
*   使用 2.0 样式的 webreference 调用服务
*   应用 SAP 补丁[说明 1459995 - Soap Sender Adapter HTTP 202](http://www.stechno.net/sap-notes.html?view=sapnote&id=1459995)并将 &responsecode202=true 添加到 url

第一个和最后一个选项都对我有用。[对此sap.com 线程](http://scn.sap.com/message/9031931)的进一步讨论。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-12-19T17:10:38.130

[我也会在这里](http://bloggingabout.net/blogs/gerben/archive/2010/02/01/wcf-best-practice-5-one-way-is-not-always-really-one-way.aspx)看看 Gerben van Loon 的这篇文章。根据标准，一种方式操作可能不是真正的一种方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-06T21:01:03.507

检查此 SAP 线程以获取完整讨论： [http ://scn.sap.com/thread/1627368](http://scn.sap.com/thread/1627368)

@Brian Low 已经正确且非常彻底地回答了这个问题（应该被标记为答案）。

我还想补充一点，这是一个已知错误，其中 SOAP 适配器不符合上述 WS-I Basic Profile 1.1 (R2750) 并且 WCF 不符合 (R2750)。结果......浪费了几个小时的时间和咬牙切齿......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-05-27T17:56:35.550

我相信可以通过将以下属性声明添加到客户端 porxy 中的操作来解决此特定问题：

`[WebInvoke(BodyStyle = WebMessageBodyStyle.Wrapped)]`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-05-31T18:52:46.607

在没有看到该方法的签名是什么样子的情况下，我最好的猜测是您的方法定义为返回“void”以外的内容。由于操作是单向的，方法只能使用“void”定义（没有返回）。其他任何事情，并且操作不是单向的。

# php - 我们如何让编码人员在编写自己的函数之前查找现有函数？

> ID：643248
> 
> 赞同：7
> 
> 时间：2009-03-13T15:30:00.460
> 
> 标签：php, spl

为什么这么多人仍在标准库中编写糟糕的版本？不是追随 PHP 开发人员，而是去阅读[PHP SPL](http://ca2.php.net/spl)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-13T15:36:28.153

同行评审可以帮助抓住这类事情。如果您有另一个开发人员查看代码，并且他们不断地找到标准库方法的实现，那么除非有充分的理由重新发明轮子，否则它应该无法通过审查。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-13T15:40:36.817

年轻、雄心勃勃的程序员喜欢自己解决每一个问题。他们不需要任何臭气熏天的图书馆。年长的、懒惰的程序员宁愿寻找手头问题的现有解决方案。

所以我的建议是：下次雇佣程序员时，选择在接待区睡着的老家伙。

开个玩笑，主要是。同行评审和教育就是答案。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-13T15:40:11.340

**更好的搜索技术。** 和**特定领域的熟悉度**

开发人员如何检查他们不知道名称的函数？或者也许没有一个 EXACT 内置函数来做他们想做的事，但他们可以用它来节省大量代码。您需要能够为手头的问题找到正确的术语，并从那里知道要搜索什么。这最好通过阅读特定于您的问题领域的主题来实现。摆脱对特定资源的编码，花一些时间在你正在编码的领域……无论是零售、医疗、保险等。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-13T15:43:25.297

**总结：假设是所有 FUBAR 之母**

我从不熟悉框架概念的同事那里看到了很多这一点（天哪，他们如何抱怨“两种语言合二为一”），也就是说：老 C++ 家伙突然面临 C# 首先从头开始重新创建哈希表。 .

显然，从这个角度来看，这种现象的很大一部分并没有摆脱旧的心态和习惯。如果您在新环境中，则需要学习新规则。解决这个问题的唯一方法是提供培训，无论是一段时间的结对编程还是更正式的培训。

不熟悉你的工具会招致他人的蔑视。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-13T15:41:09.997

一个简单的编码风格文档可能有助于提醒开发人员有可用的库（可能列出一些首选）并且他们应该熟悉它们。

有时候，你只需要提醒人们。

同行评审会有所帮助。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-13T15:49:51.037

当且仅当您确切知道要查找的内容时，PHP 才具有良好的文档记录。例如，您将打开[Arrays](http://www.php.net/manual/en/language.types.array.php)和[Array functions](http://www.php.net/manual/en/book.array.php)部分以查看您可以使用数组做什么。你猜怎么着，甚至没有提到 SPL。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-13T16:14:42.303

在真正开始编写代码之前，您还应该鼓励进行研究。我通常通过思考解决问题的方法来解决问题，然后尝试在标准库或任何其他库中找到任何可以帮助我的东西。我想说，在某些情况下，一个小时的研究可能值得几天的编码。

如果人们不这样做，最好让某人向他们询问有关他们解决问题的一般方法以及他们正在考虑使用哪些库函数/类的问题。如果他们遗漏了一些明显的东西，请向他们提出建议。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-13T15:58:12.983

两个原因很快浮现在脑海。首先，标准 PHP 库并不广为人知，而且文档很差。php.net 网站被广泛认为是该语言的最佳资产，但许多较新的内置类（如 SPL、反射 API、DomDocument 等）只不过是没有大量上下文的方法列表。

更重要的是，看起来完整的 SPL 在（未发布的）5.3 之前的任何版本的 PHP 中都没有默认提供。就收养而言，这是一个杀手。通常，编写 PHP 代码的人无法控制编译到他们的 PHP 二进制文件中的内容。这由他们的网络主机和/或运营团队处理，网络主机和/或运营团队的目标与开发人员不同，并且不会安装随之而来的每个可选扩展。这也意味着 Drupal、Joomla、Wordpress 等项目不能依赖随处安装的 SPL，因此他们不使用它。

**PHP “胜出” perl 的部分**原因是一次安装就能满足您的一切需求。可选扩展在成为基本安装的一部分之前从未被广泛采用。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-13T15:43:28.777

非常难回答的问题。显然，同行评审有帮助，但也有适当的文档。您的项目是否有技术规范，您在哪里绘制出要创建的类和接口？

如果是这样，团队中的其他人应该审查规范并指出可以使用现有代码的地方......

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-13T16:04:27.883

同意培训和同行评审，但执行单元测试和代码文档应该有助于解决[NIH](http://en.wikipedia.org/wiki/Not_Invented_Here)综合症 :)

# c# - 在 C# 中构建 url

> ID：643254
> 
> 赞同：4
> 
> 时间：2009-03-13T15:31:13.080
> 
> 标签：c#, url

我需要用 C# 中的查询字符串构建一个 URL。这样做的最佳方法是什么？现在，我正在使用类似的东西，

```
string url = String.Format("foo.aspx?{0}={1}&{2}={3}", "a", 123, "b", 456); 
```

有没有更好的首选方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-13T15:37:32.003

我认为这是一个很好的方法，如果它总是知道你有什么参数，如果这在当时是未知的，你总是可以保留一个 List<KeyValuePair<string,string>> ，键是名称，值是值，然后使用 foreach 循环构建查询字符串，例如

```
StringBuilder sb = new StringBuilder();
foreach(KeyValuePair<string,string> q in theList)
{
 // build the query string here.
    sb.Append(string.format("{0}={1}&", q.Key, q.Value);
} 
```

注意：代码未经测试，也未编译，因此可能无法完全按原样工作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-13T15:40:38.500

我认为您应该在每个参数上使用 Server.UrlEncode，这样您就不会在 URL 中发送任何错误字符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T17:13:33.303

我已经为这些类型的东西编写了一个简洁的小型开源库。查看[WebBuddy](http://webbuddy.codeplex.com/)，尤其是[UriBuddy](http://webbuddy.codeplex.com/#UriBuddy)。二进制文件适用于 Silverlight，但您可以轻松[浏览源代码](http://webbuddy.codeplex.com/SourceControl/ListDownloadableCommits.aspx)并翻录所需的任何内容。

以下是你如何称呼 UriBuddy：

```
// Take a base url
Uri sample = new Uri("http://www.nytimes.com");

// some highly useful parameters
Dictionary<String, String> query = new Dictionary<string, string>
{
    {"param1","nice"},
    {"param2","code man"}

};

// create a new url using a chained style of coding
Uri newSample = sample
    .AppendPath("/pages/world")
    .AppendQueryValues(query); 
```

顺便说一句，我从来没有在 Silverlight 之外做这种事情。我相当确定“真正的”.NET 库具有与我的非常相似的内置函数。

# java - 在 Java 小程序中动态加载本机库

> ID：643264
> 
> 赞同：2
> 
> 时间：2009-03-13T15:32:35.620
> 
> 标签：java, applet, java-native-interface, rxtx

我正在尝试编写一个将从用户的串行端口读取的 Java 小程序。为此，我将[Java Comm API](http://java.sun.com/products/javacomm/)与[RXTX 库](http://www.rxtx.org/)结合使用。我已经成功地设法通过本地 Java 应用程序读取数据，但我似乎无法从小程序中执行相同的操作。问题是 RXTX 库是一个本地库，我还没有找到在 Java 小程序中加载这个库的方法。我发现了两篇有趣的文章（Using [JNI in Applets](http://mindprod.com/jgloss/jni.html#APPLETS)其中引用了[这篇文章](http://www.javaworld.com/jw-10-1998/jw-10-apptowin32.html)），但都已有 10 多年的历史，我想知道是否有更新的解决方案。或者，如果您可以提出替代方案，我很想听听！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T16:23:36.500

使用 Java Web Start。您可以将本机库作为签名的 jar 包含在内，一切都应该正常工作。

1）将本机库放在根目录中的 jar 中 2）签署所有 jar 3）编写引用所有 jar 的 JNLP（去搜索如何编写 jnlp）

之后它应该工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T15:39:01.483

首先，我建议在 Applet 中这样做可能是个坏主意。

如果您仍然继续，[JNLPAppletLauncher](https://applet-launcher.dev.java.net/)可能会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T15:40:08.220

我不知道小程序，除了它们被严重锁定。安全/访问机器的资源等。

如果您需要可在 Web 上部署的解决方案，您是否看过[Java Web Start](http://java.sun.com/javase/technologies/desktop/javawebstart/index.jsp)？请特别参阅此[常见问题解答条目](http://java.sun.com/j2se/1.5.0/docs/guide/javaws/developersguide/faq.html#210)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T15:55:37.687

坦率地说，尝试从 Java 小程序访问设备是一个坏主意，即使你可以让它工作，而将动态库加载到传统小程序中是一个更糟糕的主意。事实上，如果你能找到一种方法来欺骗现代浏览器，我会感到惊讶。（考虑可能的安全隐患。）

正如其他问题所建议的那样，您最好构建一个可以通过 Web Start 启动的应用程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-21T01:19:31.873

我也会对这里的答案很感兴趣。我的建议是将 RXTX 的 .jar 和 .dll 安装到 \program files\java\ 树中。您可以在尝试使用小程序之前将它们安装在目标系统上。我喜欢使用 Java Web Start 的想法。如果你签署小程序，你不能在机器上读/写任何文件吗？所以你可以安装 .jar 和 .dll 然后再使用它们？

对于 Windows，我建议使用“Windows Java Serial Com Port Driver”而不是 rxtx。您可以从[http://www.engidea.com/blog/informatica/winjcom/winjcom.html](http://www.engidea.com/blog/informatica/winjcom/winjcom.html)下载它。 我发现它更容易安装和使用，而且更无错误。我无法将 RXTX 与 USB 串行设备一起使用，因为拔下 USB 端口时 RXTX 会崩溃。winjcom 为我解决了这些问题，等等。

我仍在尝试决定如何部署 DLL，但我并不担心，因为我不希望“Windows Java Serial Com Port Driver”的 DLL 发生变化。-斯托什

# unique - 唯一的、数字的、增量的标识符

> ID：643267
> 
> 赞同：3
> 
> 时间：2009-03-13T15:33:19.813
> 
> 标签：unique, uniqueidentifier

我需要为我对某个 XML RPC 发出的每个请求生成唯一的、增量的、数字的事务 ID。这些数字只需要在我的域中是唯一的，但会在多台机器上生成。

我真的不想在数据库中跟踪这个数字并处理每个事务的行锁定等。我尝试使用微秒时间戳来破解它，但只有几个线程发生冲突——我的应用程序需要支持数百个线程。

任何想法，将不胜感激。

**编辑：如果每个事务 id 必须比前一个请求的大怎么办？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T15:38:47.647

如果您要从数百个线程中使用它，在多台机器上工作，并且需要一个增量 ID，那么您将需要一些集中的地方来存储和锁定最后生成的 ID 号。这不一定必须在数据库中，但这将是最常见的选择。一个只提供 ID 的中央服务器可以提供相同的功能，但这可能会破坏分发它的目的。

如果它们需要增量，任何形式的时间戳都不能保证是唯一的。

如果您不需要它们是增量的，则 GUID 可以工作。可能对每个系统上的时间戳和硬件 ID 进行某种类型的合并可以提供唯一的标识符，但 ID 号部分不一定是唯一的。

您可以使用一对硬件 ID + 增量时间戳吗？这将使每台特定机器的 ID 递增，但不一定在整个域中是唯一的。

- - 编辑 - - -

我认为使用任何形式的时间戳都不适合您，原因有两个。

首先，您永远无法保证不同机器上的 2 个线程不会尝试在完全相同的时间进行调度，无论您使用什么分辨率的计时器。在足够高的分辨率下，这是不可能的，但不能保证。

其次，要完成这项工作，即使您可以解决上面的冲突问题，您也必须让每个系统都具有完全相同的时钟，精度为微秒，这并不实际。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T15:40:20.857

这是一个非常困难的问题，特别是如果您不想造成性能瓶颈。您说 ID 需要是“增量的”和“数字的”——这是具体的业务约束，还是出于其他目的而存在的约束？

如果这些不是必需的，您可以使用 UUID，大多数常见平台都有库。它们允许您在很短的时间内生成许多（数百万！）ID，并且在没有冲突的情况下非常舒适。维基百科上的相关文章声称：

> 换句话说，仅在接下来的 100 年每秒生成 10 亿个 UUID 之后，仅创建一个副本的概率约为 50%。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T15:38:02.737

如果您从需求中删除“增量”，则可以使用[GUID](http://en.wikipedia.org/wiki/Globally_Unique_Identifier)。

如果没有某种通用数据，我看不出如何跨多个进程实现增量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T15:42:20.727

如果您以 Windows 平台为目标，您是否尝试过[Interlocked API](http://msdn.microsoft.com/en-us/library/ms684122(VS.85).aspx)？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T15:43:01.040

谷歌为您正在寻找的任何语言[提供 GUID 生成器，然后如果您真的需要它是数字，则将其转换为数字。](http://www.google.com/search?q=guid+generator)虽然它不是增量的。

或者让每个线程“保留”一千个（或百万，或十亿个）事务 ID，并一次分发一个，并在用完时“保留”下一组。仍然不是真正的增量。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-13T15:56:38.057

我是 GUID 人群，但如果这不可能，您可以考虑在重量级数据库上使用[db4o](http://developer.db4o.com/Resources/view.aspx/Reference/Client-Server/Concurrency_Control)或[SQL Lite吗？](http://www.sqlite.org/lockingv3.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-13T16:03:23.080

如果每个客户端都可以跟踪自己的“下一个 id”，那么您可以与 sentral 服务器通信并获取一系列 id，一次可能是 1000 个。一旦客户端的 id 用完，它将不得不再次与服务器通信。

这将使您的系统拥有 id 的中央来源，并且仍然避免必须为每个 id 与数据库对话。

# wcf - 对于带有远程胖客户端的自托管跨域 WCF 服务，我有哪些绑定选项？

> ID：643273
> 
> 赞同：1
> 
> 时间：2009-03-13T15:34:47.890
> 
> 标签：wcf

我正在尝试构建一个 WCF 自托管服务（最终在 Windows 服务中），它将从在我的托管计算机上没有帐户的远程胖客户端接收二进制和基于文本的消息。我试图弄清楚我的绑定选项和安全选项，并且在阅读模式和实践指南时，我的头脑至少完全旋转了一次。

客户端将根据基于 SQL 的自定义方法进行身份验证，因此我希望能够在初始登录请求中传递该信息，然后设置某种授权令牌。（这部分问题可能超出了问题的范围，但我将其包括在内，以防它*可能*产生影响。）

任何想法都会非常有帮助。

瑞安

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-19T08:41:25.873

绑定和安全选项的选择取决于 WCF 服务的使用情况。它只是针对您的富客户端，还是您打算将其作为 API 向世界公开？如果它只是为了你的富应用程序，它是在 LAN 上运行还是在不受信任、不可靠的 Internet 上运行？

使用 WCF，您可以配置服务以公开具有不同绑定的多个端点，例如[SOAP 和 REST](http://www.codemeit.com/wcf/wcf-restful-pox-json-and-soap-coexist.html)。一般来说，我会从一些无状态和轻量级的东西开始，比如 basicHttpBinding 和 webHttpBinding，在每个请求上传递用户和密码。一旦启动并运行它，您就可以优化缓存身份验证，提供二进制端点等。只有在它确实有帮助的情况下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T05:02:44.343

没有必要只有一个绑定。话虽如此，如果它是自托管的，那么您在这里“独自”。我从来没有看过涉及的内容。

# asp.net - 中继器内的 GridView 分页

> ID：643274
> 
> 赞同：1
> 
> 时间：2009-03-13T15:35:07.157
> 
> 标签：asp.net

我有一个嵌套在转发器中的gridview，我试图在gridview 上启用分页但没有取得多大成功。

gridview数据绑定是这样的

```
<asp:repeater....> 
    <asp:gridview id="GridView1" Datasource='<%# LoadData(CInt(Eval("Id"))) %>' 
         OnPageIndexChanging="GridViewPageIndexChanging" AllowPaging="true" 
PageSize="10" ............. </asp:GridView>
</asp:repeater> 
```

在我的`LoadData`方法背后的代码中获取对象列表：

```
Public Function LoadData(ByVal Id As Integer) As IList(Of Client)
            Dim ds As IList(Of Client) = client.GetClientById(Id)
            Return ds
        End Function 
```

事件处理程序如下：

```
Protected Sub GridViewPageIndexChanging(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewPageEventArgs)
            sender.PageIndex = e.NewPageIndex
End Sub 
```

我的代码没有改变gridview中的页面，我错过了什么吗？

很感谢任何形式的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T15:55:40.133

您必须调用 DataBind()。

```
Dim grid as GridView = DirectCast(sender, GridView)
grid.PageIndex = e.NewPageIndex
grid.DataBind() 
```

**编辑**

由于我还不能发表评论，并且为答案创建另一个答案会使一切变得混乱，我将只编辑这个。

恐怕中继器是用于您想要的错误控件。问题源于当 GridView 的页面事件触发时它不保留 DataItem 的事实。因此，“id”被评估为空，随后为零。顺便说一句，在 C# 中你会得到一个空异常。

我建议您改用 DataList：

```
<asp:DataList ID="DataList" runat="server" DataKeyField="id">
    <ItemTemplate>
        <asp:GridView ID="Grid" runat="server"
            AllowPaging="true"
            PageSize="2"
            OnPageIndexChanging="Grid_PageIndexChanging"
            DataSource='<%# GetData(DirectCast(DataList.DataKeys(DirectCast(Container, DataListItem).ItemIndex), Integer)) %>'
        >
        </asp:GridView>
        <hr />
    </ItemTemplate>
</asp:DataList> 
```

后面有代码：

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    If Not IsPostBack Then
        DataList.DataSource = New Integer() {1, 2, 3, 4, 5}.Select(Function(x) New With {.id = x})
        DataList.DataBind()
    End If
End Sub

Protected Function GetData(ByVal id As Integer) As String()
    Dim arr As String() = New String(4) {}
    For i As Integer = 0 To arr.Length - 1
        arr(i) = String.Format("id {0}; grid item {1}", id, i)
    Next
    Return arr
End Function

Protected Sub Grid_PageIndexChanging(ByVal sender As Object, ByVal e As GridViewPageEventArgs)
    Dim grid As GridView = DirectCast(sender, GridView)
    grid.PageIndex = e.NewPageIndex
    grid.DataBind()
End Sub 
```

这段代码有效——我测试过。虽然，我个人不喜欢使用绑定表达式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T16:15:58.243

我更进一步，在完成绑定后，我在 Eval 上遇到了异常。我在数据源中将其更改为 <%#LoadData(DataBinder.Eval(Container.DataItem,"Id"))%>

绑定后我不再收到 Eval 异常。但是我的网格仍然是空的。

[更新]

好的，我通过将我的 ID 保存在哈希表中解决了这个问题，然后我用哈希表中的等效 ID 重新绑定了我的 gridview。

现在一切都很好，感谢大家的帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T16:01:39.120

我看到的一件事是你的标记。您的示例在 Repeater 控件中直接具有 GridView。您将在 ItemTemplate 中需要它。

```
<asp:Repeater ID="rpt" runat="server" ...>
   <ItemTemplate>
      <asp:GridView id="gv1" runat="server" ...>
      .
      .
      .
      </asp:GridView>
   </ItemTemplate>
</asp:Repeater> 
```

# c# - c# 在listview中拖放

> ID：643275
> 
> 赞同：0
> 
> 时间：2009-03-13T15:35:17.063
> 
> 标签：c#, listview, drag-and-drop

我有一个列表框，我从中拖动到 ListView 中。现在我在 ListView 中有组，因此当 ListView 中的项目被放置在 listviewgroup 的点时，它必须将其添加到该组下。

这是处理丢弃的代码。

```
 private void lstvPositions_DragDrop(object sender, DragEventArgs e)
    {

        var group = lstvPositions.GetItemAt(e.X, e.Y);
        var item = e.Data.GetData(DataFormats.Text).ToString();
        lstvPositions.Items.Add(new ListViewItem {Group = group.Group, Text = item});

    } 
```

我没有找到可以提供 groupitem 的函数，所以我使用了 GetItemAt，我也可以从中访问 listviewgroup。

但是 GetItemAt 总是返回 null。

难道我做错了什么？有没有更好的方法来实现这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T15:51:18.710

首先，我假设您使用的是 ListView，而不是 ListBox，因为 ListBox 不包含 GetItemAt 成员。

要解决您的问题，请将点转换为本地坐标：

```
private void lstvPositions_DragDrop(object sender, DragEventArgs e)
{
   var localPoint = lstvPositions.PointToClient(new Point(e.X, e.Y));
   var group = lstvPositions.GetItemAt(localPoint.X, localPoint.Y);
   var item = e.Data.GetData(DataFormats.Text).ToString();
   lstvPositions.Items.Add(new ListViewItem {Group = group.Group, Text = item});
} 
```

# drupal - 什么时候你需要成为一名程序员才能使用 Drupal？

> ID：643276
> 
> 赞同：2
> 
> 时间：2009-03-13T15:35:27.547
> 
> 标签：drupal

Drupal 似乎可以为非程序员提供很多东西。大量的模块和易于安装。但是在什么时候你会说你需要成为一名程序员？它在哪里掉下来并需要更多的动手操作？

此外，即使它们不是“打算”完成的，我对您必须对代码库进行的任何自定义调整感兴趣。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-13T17:21:57.900

我强烈不同意当您想要做一些不同于“开箱即用”功能的事情时需要编程技能的想法，除非“开箱即用”包括可以混合和匹配数千种第三方的无数方式-派对插件。

最大的挑战是：Drupal 的社区越来越倾向于构建小型、可重用的块，这些块可以通过配置以新颖的方式组合，而不是编码。这意味着通过管理屏幕组合小块可以完成的事情的数量令人印象深刻。但是，这意味着您以这种方式组合在一起的工具缺少许多“平滑边缘”，而这些“平滑边缘”将具有单个内置规范插件。

正是那些地方——粗糙的边缘——最经常需要自定义代码的地方。编写一个简短的 hook_form_alter() 函数来隐藏一些不需要的表单字段或更改表单完成后重定向到的位置，构建一个简单的自定义侧边栏块，为用户提供一些有用的链接到您组装的不同部分，诸如此类. 自定义主题也占用了很多“平滑”工作。

这就是说，你可以用零代码做很多疯狂的事情，但你会达到收益递减点，尤其是在尝试构建复杂的基于规则的逻辑时（“在某些情况下，我希望 X 出现，否则应提示用户输入 Y...")。至少了解一些 PHP，不要害怕窥视幕后发生的事情，并且愿意编写一个（小！）自定义模块来完成某些微调目标，这肯定会在更复杂的网站上为您提供良好的服务。

此外，很容易找到做有趣事情但仍处于测试/开发阶段的插件。如果您决定使用“未完成”的代码，了解一些 PHP 将帮助您保持头脑清醒。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T15:42:48.183

唯一需要程序员的情况是，如果有一些你想要的功能，而当前的插件没有提供你想要的东西。大多数 Drupal 支持的站点都可以由非编程类型运行。简而言之，如果您需要开发现在在 Drupal 的任何可用插件中都没有的自定义功能，我想说您需要成为一名程序员。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T15:43:34.423

稍微偏离主题，但解决您提出的一点：

> 此外，即使它们不是“打算”完成的，我对您必须对代码库进行的任何自定义调整感兴趣。

它是开源软件。你可以根据你的需要和愿望来决定什么是“应该做的”。

一些最好的功能一开始是有人以一种没有人预料到的方式改变或使用某物，从而产生了一些新的、有趣的和有用的东西。找出其他人像这样进行的自定义是扩大您的理解的好方法，没有什么可以偷偷摸摸的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T15:39:53.760

我用过drupal，不需要做任何“编程”，如果你没有编程技能，你总是可以使用便宜的承包商（例如rent-a-coder或类似的）来快速/便宜地修改/创建一个插件-为你。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T15:44:24.937

有很多可用的模块，但**只要你想做一些与开箱即用功能稍有不同的事情**，你就需要成为一名程序员。

就个人而言，我从未更改过核心代码库。真的不推荐。我已经使用了现有的模块，或者将它们的一部分用于我自己的模块，或者将它们重命名并将它们修改为我自己的。

# java - 无效的比例大小。不能小于零

> ID：643280
> 
> 赞同：1
> 
> 时间：2009-03-13T15:36:21.163
> 
> 标签：java, sql, oracle, spring, oracle10g

我正在使用 spring-2.5.6 使用 org.apache.commons.dbcp.BasicDataSource 从独立应用程序连接到 Oracle 10g 数据库 (ojdbc14.jar)。当我尝试使用该`public SqlRowSet queryForRowSet(String sql, Object[] args) throws DataAccessException`方法检索 SqlRowSet 时，我得到一个 'java.sql.SQLException: Invalid scale size。不能小于零'。

调用表的sql是：

```
select CUSTAREADESC, BEGCOL, COLLENGTH from CUSTOMERAREA where upper(trim(FLEET)) = upper(trim(?)) and CUSTAREANO = ? 
```

BEGCOL 和 COLLENGTH 列属于未定义精度的数据类型 number。

我发现了一些关于这个问题的信息，似乎是 Oracle 驱动程序与 Sun 的 com.sun.rowset.CachedRowSetImpl 实现不兼容。

[Java 数据库连接 (JDBC) - 填充 CachedRowSet 产生 SQLException: Invalid scale size](http://forums.sun.com/thread.jspa?threadID=569712)

[使用带有子查询分解 SQL 的 queryForRowSet 会产生错误](http://forum.springframework.org/showthread.php?t=19848)

他们建议将 sql 更改为以下内容作为解决方法。

```
select CUSTAREADESC, (BEGCOL + 0) BEGCOL, (COLLENGTH + 0) COLLENGTH from CUSTOMERAREA where upper(trim(FLEET)) = upper(trim(?)) and CUSTAREANO = ? 
```

有谁知道一个更好的通用解决方案，它不涉及任何现有表的自定义 sql，其中列没有定义精度？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-13T19:38:19.703

此错误是由 Oracle JDBC 驱动程序不兼容引起的。您可以通过将系统属性 oracle.jdbc.J2EE13Compliant 设置为 true 来修复它。例如，在命令行上：

`java -Doracle.jdbc.J2EE13Compliant=true`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T15:37:29.127

我最终创建了一个实现 ResultSetExtractor 的 ResultSetExctractor 类，并使用它来获取 SqlRowSet 的 OracleCachedRowSet 实现。要使用它，您需要在项目中包含 oracle 驱动程序 jar（使用 ojdbc14.jar）。

```
public class SqlRowSetOracleResultSetExtractor implements ResultSetExtractor {

    public Object extractData(ResultSet rs) throws SQLException {
        return createSqlRowSet(rs);
    }

    protected SqlRowSet createSqlRowSet(ResultSet rs) throws SQLException {
        CachedRowSet rowSet = newCachedRowSet();
        rowSet.populate(rs);
        return new ResultSetWrappingSqlRowSet(rowSet);
    }

    protected CachedRowSet newCachedRowSet() throws SQLException {
        return new OracleCachedRowSet();
    }
} 
```

然后通过以下方式使用它来提取 SqlRowSet。

```
SqlRowSet rs = (SqlRowSet) this.jdbcTemplate.query(SELECT_CUSTOMER_AREA,
                new Object[]{new SqlParameterValue(Types.VARCHAR, companyId),
                new SqlParameterValue(Types.NUMERIC, areaNumber)},
                new SqlRowSetOracleResultSetExtractor()); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-02-22T14:23:28.257

如果您使用的是 oracle 10g，并且您的数字列定义为数字且没有比例大小

```
create table EXAMPLE
(
FILED1 NUMBER(2,0),
FILED2 NUMBER
) 
```

在填充 FIELD2 时，您将收到此异常。

检查数字字段的表结构。

我希望这可以帮助你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T16:02:28.800

您使用的是什么 Oracle Jar？尝试升级到最新版本（假设您使用的是 JDK 5 或更高版本）。我相信最新的 ojdbc5.jar [或 ojdbc6.jar] 已修复此问题 - 这是由于 Oracle 的驱动程序未正确支持 CachedRowSet 接口造成的。

下载链接：[Oracle JDBC 驱动程序](http://www.oracle.com/technology/software/tech/java/sqlj_jdbc/htdocs/jdbc_111060.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-10T15:43:53.607

试试这个查询：

```
select NVL(CUSTAREADESC, '0'), (NVL(BEGCOL,0) + 0) BEGCOL, (NVL(COLLENGTH, 0) + 0) COLLENGTH 
from CUSTOMERAREA 
where NVL(upper(trim(NVL(FLEET, ''))), '') = NVL(upper(trim(NVL(?, ''))), '') 
    and NVL(CUSTAREANO, '0') = NVL(?, '') 
```

SQL 异常是否仍在发生？

# c# - ServiceProcessInstaller 失败并显示“未完成帐户名称和安全 ID 之间的映射”

> ID：643287
> 
> 赞同：8
> 
> 时间：2009-03-13T15:37:38.947
> 
> 标签：c#, .net, web-services, installation

我有一个使用`ServiceProcessInstaller`. 在构造函数的安装程序类中，我将其添加到安装程序：

```
serviceProcessInstaller = new ServiceProcessInstaller();
serviceInstaller = new ServiceInstaller();

// Add Both Installers to Project Installers Collection to be Run
Installers.AddRange(new Installer[]
                                {
                                    serviceProcessInstaller,
                                    serviceInstaller
                                }); 
```

并在安装方法中设置用户名和密码：

```
public override void Install(IDictionary stateSaver)
{
    .... open the form, bla bla bla
    serviceProcessInstaller.Password = accountForm.txtPassword.Text;
    serviceProcessInstaller.Username = accountForm.txtServiceAccount.Text;
    serviceProcessInstaller.Account = ServiceAccount.User;
} 
```

但是，当我尝试运行它时，我收到非常描述性的错误消息：“没有完成帐户名称和安全 ID 之间的映射”。我究竟做错了什么？

编辑：我测试了这个错误只有在我使用 msi 包安装这个组件时才会发生。当我对它运行 InstallUtil 时，它工作得很好。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-16T14:31:54.720

终于找到了： 中似乎有一个“功能” `ServiceProcessInstaller`，其中代码用上下文中的值覆盖了我明确提供的值。MSI 安装程序将用户名设置为一些废话（我的公司名称），并`ServiceProcessInstaller`尝试以该用户身份安装服务，而不是我明确提供的用户。所以解决方法是在配置中设置正确的值：

```
public override void Install(IDictionary stateSaver)
{
    .... open the form, bla bla bla
    serviceProcessInstaller.Password = accountForm.txtPassword.Text;
    Context.Parameters["PASSWORD"] = accountForm.txtPassword.Text;
    serviceProcessInstaller.Username = accountForm.txtServiceAccount.Text;
    Context.Parameters["USERNAME"] = accountForm.txtServiceAccount.Text;
    serviceProcessInstaller.Account = ServiceAccount.User;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-16T12:19:09.000

也许它与您机器环境上的服务帐户有关

*   [http://www.shog9.com/log/archives/1-No-mapping-between-account-names-and-security-IDs-was-done.html](http://www.shog9.com/log/archives/1-No-mapping-between-account-names-and-security-IDs-was-done.html)
*   [http://support.microsoft.com/kb/890737](http://support.microsoft.com/kb/890737)
*   [http://bytes.com/groups/net-c/227254-serviceprocessinstaller-account-user-doesnt-work](http://bytes.com/groups/net-c/227254-serviceprocessinstaller-account-user-doesnt-work)

希望对了解您的情况有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-01T17:01:13.897

我多年来一直遇到这个问题，试图用我自己的帐户运行用户服务。问题原来是我的帐户没有密码。一旦我输入密码，它就会立即生效

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-11-14T15:49:05.740

我必须将用户名从`user`to更改`.\user`为表示它在本地计算机上。

# sql - 修改 master.dbo.syslanguages 或插入新语言

> ID：643301
> 
> 赞同：0
> 
> 时间：2009-03-13T15:39:42.590
> 
> 标签：sql, sql-server, sql-server-2005, date

在我的应用程序中，我们必须`SET DATEFORMAT YMD`在每次操作之前调用。在`master.dbo.syslanguages`我的语言（波兰语，lcid=1045）的输入条目中有`dmy`格式。

那么有什么办法可以更改此条目或创建一种类似于旧语言的新语言，但已更改`DATEFORMAT`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-14T09:58:43.027

SQL Server 2005 删除了更新 SQL Server 2000 中存在的系统表的选项（使用`sp_configure 'allow updates', 1`）

您不能更改您的客户日期格式，以便无论 DATEFORMAT 设置如何都能正确识别吗？例如 4 位数年份、ISO 格式等，例如（不详尽）“2008 年 2 月 21 日 14:32”、“2008-02-21 14:32”、“20080221 14:32”等。

# c# - 从 ListView 检索到的错误数据

> ID：643310
> 
> 赞同：0
> 
> 时间：2009-03-13T15:41:01.853
> 
> 标签：c#, algorithm, listview, loops, foreach

我的程序逻辑循环遍历存在于两个单独 ListView 中的数据集合时遇到了一些问题。在循环并从 ListView 中提取数据之后，我将所有内容添加到逗号分隔的文本文件 ( **CLOSEULDCONFIG.TXT** ) 中。

我第一次执行此逻辑时，一切正常。如果我再次执行此逻辑，我将获得 ListView 中的 2 个副本。每次运行此逻辑时，先前添加的 ListView 项的副本数都会增加 1。

这是不可取的，因为我想将与 ListView 中相同数量的元素添加到我的文本文件中。谁能发现导致这种情况的嵌套 foreach 语句有什么问题？

```
 // HAZMAT PACKAGE ERROR LISTVIEW ITEMS               
                        foreach (ListViewItem HazPackErrItems in HazmatPackageErrorListview.Items)
                        {
                            bool first = true;
                            foreach (ListViewItem.ListViewSubItem HazPackErrSub in HazPackErrItems.SubItems)
                            { 
                                // removes the first element of each comma delimited string
                                if (first)
                                    first = false;
                                else
                                    CloseULDSubmitLogDataResponseHazpackerrCloseULDConfig += " " + HazPackErrSub.Text + ",";
                            }
                        } 

                        // HAZMAT WEIGHT AND COUNT COLLECTED LISTVIEW ITEMS
                        foreach (ListViewItem HazWeightAndCountItems in HazmatWeightAndCountListview.Items)
                        {
                            bool first = true;
                            foreach (ListViewItem.ListViewSubItem HazWeightAndCountSub in HazWeightAndCountItems.SubItems)
                            {
                               // removes the first element of each comma delimited string
                                if (first)
                                    first = false;
                                else
                                    CloseULDSubmitLogDataResponseHazWeightAndCountCloseULDConfig += " " + HazWeightAndCountSub.Text + ",";
                            }
                        }

                        using (System.IO.StreamWriter sw = new System.IO.StreamWriter("CLOSEULDCONFIG.TXT", true))
                        {
                            if (!AlreadyExists)
                            {
                                sw.WriteLine(PresetNameConfig +
                                CloseULDSubmitLogDataRequestCloseULDConfig +
                                CloseULDSubmitLogDataResponseCloseULDConfig +
                                CloseULDSubmitLogDataResponseHazpackerrCloseULDConfig +
                                CloseULDSubmitLogDataResponseHazWeightAndCountCloseULDConfig +
                                CloseULDDateTimeConfig);
                            }
                        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T16:10:20.893

如果我没记错的话，您正在打开要附加的文件，而不是覆盖。您是否检查过文件本身以查看数据是否在那里重复？

# c++ - 通过存储指向成员函数的指针的虚拟行为

> ID：643317
> 
> 赞同：1
> 
> 时间：2009-03-13T15:42:07.903
> 
> 标签：c++

为什么要阻止虚拟行为？

```
class  MyClass
    {
       //........
       virtual double GetX();
       virtual double GetSomethingElse();
       virtual double GetT();
       virtual double GetRR();
       //........

    };

    class Processor
    {
     private:
          typedef double (MyClass::*MemFuncGetter)();
          static map<std::string, MemFuncGetter> descrToFuncMap;

     public:
            static void Initialize();
            void Process(Myclass m, string);

    };

    void Processor::Initialize()
    {

         descrToFuncMap["X"]=&MyClass::GetX;
         descrToFuncMap["SomethingElse"]=&MyClass::GetSomethingElse;
         descrToFuncMap["RR"]=&MyClass::GetRR;
         descrToFuncMap["T"]=&MyClass::GetT;
    };

    void Processor::Process(MyClass *ms, const std::string& key)
    {
         map<std::string, Getter>::iterator found=descrToFuncMap.find(key);
         if(found!=descrToFuncMap.end())
         {
            MemFuncGetter memFunc=found->second;
            double dResult=(ms).*memFunc();
            std::cout<<"Command="<<key<<", and result="<<result<<std::end;
          }
     } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-13T15:45:48.457

这一行在这里：

```
void Processor::Process(MyClass ms, const std::string& key) 
```

尝试将其替换为

```
void Processor::Process(MyClass &ms, const std::string& key) 
```

发生的事情称为[slicing](https://stackoverflow.com/questions/274626/what-is-the-slicing-problem-in-c)，即使您可能已经传入了 MyClass 的子类，但当您调用 Process 时，会使用 MyCLass 的复制构造函数在堆栈上创建一个新的 MyClass 对象。这个新对象在任何方面都是一个 MyClass，包括拥有 MyClass 的虚拟表。

当您通过引用或使用指针传递时，不会进行任何复制，并且对 MyClass 的引用可以引用真正属于 SubClassOfMyClass 类型的对象。

编辑：

好吧，问题在于许多编译错误之一，如果你把这一切都编译好了，它就可以正常工作：

```
class  MyClass
{
public:
   //........
   virtual double GetX() { return 0.0; }
};

class  MyClass2 : public MyClass
{
public:
   //........
   virtual double GetX()  { return 1.0; }
};

class Processor
{
public:
   typedef double (MyClass::*MemFuncGetter)();
   static void Initialize();
   void Process(MyClass *m, const string &);
private:
   static map<std::string, MemFuncGetter> descrToFuncMap;
};

void Processor::Initialize()
{
     descrToFuncMap["X"]=&MyClass::GetX;
}

void Processor::Process(MyClass *ms, const std::string& key)
{
     map<std::string, MemFuncGetter>::iterator found=descrToFuncMap.find(key);
     if(found!=descrToFuncMap.end())
     {
        MemFuncGetter memFunc=found->second;
        double dResult=(ms->*memFunc)();
        std::cout<<"Command="<<key<<", and result="<<dResult<<std::endl;
      }
 }

map<std::string, Processor::MemFuncGetter> Processor::descrToFuncMap;

int main()
{
    Processor::Initialize();
    Processor p;

    MyClass2 mc2;
    p.Process(&mc2, "X");
} 
```

哪个输出：

> 命令=X，结果=1

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T16:14:30.277

哇，在您遇到真正的问题之前，我从未见过一个示例代码有这么多其他语法错误。

发布代码时，您想帮助的人应该可以编译它。
除了您希望其他人帮助您解决的一个错误。

我不确定您要实现什么，但它不是虚拟功能。所以你应该重新命名你的问题。

我想你的主要问题是这一行：

```
MemFuncGetter memFunc=found->second;
double dResult=(ms).*memFunc(); 
```

根据您是否接受 Josh 的建议，语法应如下所示。

```
 MemFuncGetter memFunc=found->second;
 double dResult=(ms.*memFunc)();    // MyClass& ms

 -- or

 double dResult=(ms->*memFunc)();   // MyClass* ms 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T16:18:26.460

您是否考虑过使用 boost::bind 和 boost::function？它允许您将指针绑定到自由/成员函数，并允许您绑定特定参数以及延迟调用。

这是一个教程/示例： http: [//www.codeproject.com/KB/library/BoostBindFunction.aspx](http://www.codeproject.com/KB/library/BoostBindFunction.aspx)

# visual-studio - 禁用 StyleCop 规则

> ID：643331
> 
> 赞同：81
> 
> 时间：2009-03-13T15:43:54.220
> 
> 标签：visual-studio, stylecop

我正在使用 StyleCop。但是我想忽略一些规则，例如`this.`在班级成员面前使用。

如何关闭 StyleCop 规则。我已经看过但找不到怎么做。

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2009-03-13T16:01:20.463

在您的 StyleCop 安装中，有一个`Settings.StyleCop`文件。您可以对其进行编辑以全局关闭规则。将该文件拖到该文件中的 Settings Editor 可执行文件上进行编辑。

您还可以将设置文件的副本放入项目中以覆盖全局设置。

如果您使用的是 Visual Studio 集成而不仅仅是 MSBuild 集成，您应该能够通过右键单击您的项目并选择`StyleCop Settings`类似的东西来访问每个项目的设置编辑器。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2017-02-09T20:04:15.950

Stylecop 可在项目级别进行配置。使用图形界面轻松管理规则，而不是编辑设置文件。（有时在某些版本中称为 Stylecop 设置）

选择设置选项后，您应该会看到一个搜索/查找选项，如下图所示。

例如：如果您想删除一条规则，其中 // 评论是不允许的并且 //// 是 stylecop 允许的，然后搜索 stylecop 规则 ID。在这种情况下，它是 SA1005。当您在项目中运行 stylecop 时，您可以在警告部分看到这一点。使用关键字 SA1005 查找，您应该在结果部分看到它。只需取消选中即可。

[![在此处输入图像描述](https://i.stack.imgur.com/qyyqG.png)](https://i.stack.imgur.com/qyyqG.png)

您可以按以下方式管理规则

[![在此处输入图像描述](https://i.stack.imgur.com/9ywIF.png)](https://i.stack.imgur.com/9ywIF.png)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-04-04T21:48:49.327

该特定规则位于可读性规则 - 成员访问 - SA1101：PrefixLocalCallsWithThis 下。

如果你把它关掉，它应该不会再对你大喊大叫了……我必须这样做。Stylecop 一直让我头疼。

# visual-studio-2008 - 我是否应该在每次构建时更改 .vdproj 文件中的 ProductCode？

> ID：643336
> 
> 赞同：3
> 
> 时间：2009-03-13T15:45:40.393
> 
> 标签：visual-studio-2008, windows-installer

目前，我们的构建会自动更新部署项目文件（VS2008）中的版本号并更改 ProductCode 和 PackageCode。

我们根本不使用太多的 MSI 功能，它更多的是一种打包方法和一种运行自定义操作的方式，这些操作根据作为 MSI 内容提供的定义文件执行一些活动。

因此，就 MSI 功能而言，我们所有的构建看起来都一样，它们只会引入其他项目输出的更新版本，而不是部署项目中的任何更改，因此我们不会更改 MSI 的结构全部。

那么，我可以安全地保持 ProductCode 稳定吗？

我想这样做的原因是我是通过产品代码卸载的，直到我发现这是一种愚蠢的方式，因为我们的构建一直在改变它们！

或者，有什么方法可以使用从未更改的值升级代码进行卸载？

反馈：

我对此进行了更多研究，并改变了我们在部署系统中进行卸载的方式，该系统部署到我们相当大的测试环境中。我现在不是从 MSI 中提取 ProductCode 并在 MSI /X 命令中使用它，而是从 MSI 中提取 UpgradeCode。作为卸载的一部分，我提供并远程执行（通过 PSEXEC）一个小的 vbs 脚本，该脚本通过

```
set oWI = CreateObject("WindowsInstaller.Installer")
set related - oWI.RelatedProducts(wscript.arguments(0))  
if related.Count == 1 then
    uninstallString = "msiexec /X " & related.Item(0) & " /qn"
    set oShell = CreateObject("WScript.Shell")
    oShell.Run uninstallString, 1, True
end if 
```

好的，可能不是世界上最好的 vbs - 但它通过将 UpgradeCode 作为第一个参数传递给脚本来工作。还有更多用于记录等的行，因此我们可以了解审计跟踪中发生了什么。

有点啰嗦，只是通过 psexec 直接调用 msiexec，但我已经提供了 msi 和一个设置文件，所以发送一个小脚本并不是真正的问题。

这可能会帮助其他人——谁知道呢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T16:01:42.583

如果您在 Visual Studio 中打开 .vdproj，在“解决方案资源管理器”窗格中选择项目，然后在“属性”窗格中查找，您将找到一个名为“RemovePreviousVersions”的属性。如果此属性设置为 true，则在安装新版本时，将自动卸载具有相同 UpgradeCode 但具有较早版本的任何已安装产品。

# ruby - 如何在鞋子应用程序中启用文本选择、复制和粘贴？

> ID：643339
> 
> 赞同：3
> 
> 时间：2009-03-13T15:46:41.887
> 
> 标签：ruby, shoes

有没有办法允许在鞋子应用程序中选择、复制和粘贴文本？我正在制作一个小实用程序，如果它能够支持此功能，那就太好了。我知道鞋子使用 Pango/Cairo 进行文本渲染，所以我想有一种方法可以打开它。任何人？_为什么？

另外，_why，感谢伟大的工具包！

非常感激，

鲍比

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-01-18T12:45:12.863

文本选择、复制和粘贴在 edit_boxes 中有效，但无法选择文本块（例如 para）。阅读[旧邮件列表的 gmane 存档](http://news.gmane.org/gmane.comp.lib.shoes)，_为什么要[在 Policeman 之后发布](http://article.gmane.org/gmane.comp.lib.shoes/630/match=text+selection)。也有人提到[Pango](http://thread.gmane.org/gmane.comp.lib.shoes/1982/focus=1984)是无法选择 para 文本的原因。

# javascript - 冻结 TH 标题和滚动数据

> ID：643340
> 
> 赞同：6
> 
> 时间：2009-03-13T15:46:45.523
> 
> 标签：javascript, jquery, html

我有一个 html 表，我想冻结标题行标签以滚动数据。我怎么能这样做？我需要使用 Dom 吗？谢谢 ！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T16:23:03.330

我的解决方案是使用两个表并固定列宽。下面的表格在一个可滚动的 div 中并且没有标题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T20:37:11.330

如果您认真对待可访问性，那么两张表不是可行的方法，因为它违反了规则。

有一些方法可以在纯 CSS 中做到这一点，但让它在所有浏览器中都能工作是一件令人头疼的事情。网上有一些示例，但它们并非都可以在没有调整的情况下 100% 使用 IE。

我目前正在开发仅 CSS 的版本，这已经非常接近了：http: [//www.coderanch.com/t/431995/HTML-JavaScript/Table-with-fixed-header-scolling#1918825](http://www.coderanch.com/t/431995/HTML-JavaScript/Table-with-fixed-header-scolling#1918825)

在 IE8rc1 中还不能工作，IE6/7 有一个边框问题，你必须忍受滚动条在 FF 和 IE 中看起来不同。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-13T21:12:19.903

使用 FireFox，你可以把 style="height: 200px;overflow-y: auto" 但是为了有一个与所有主流浏览器兼容的纯 CSS 版本，我使用[这个例子](http://www.imaputz.com/cssStuff/bigFourVersion.html)，因为 IE 不支持 tbody 或 thead 中的样式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-10-09T14:09:50.410

我想出了一个解决方案，它结合了前面提到的两个。它使用 jQuery 和两个表，一个用于标题，一个用于内容。标题表设置为 100% 的宽度，没有设置列宽。在内容表的底部，定义了一行以将标题表与设置的列宽相匹配。该行被隐藏，因此不显示，但保留列宽。

对于这个例子，我给我的标题行一个 ID 'Header1' 和底行和 ID 'Header2'。此外，我将内容表包装在 ID 为“scrollTable”的 div 中。

我在我的 CSS 文件中为 scrollTable ID 设置样式，见下文：

```
 #scrollTable {
 height:250px;
 overflow-x:hidden;
 overflow-y:scroll;
    } 
```

现在是 jQuery 部分。基本上我在这里所做的是获取底部行列的宽度并将标题列设置为匹配。我拉伸了标题最后一列的宽度，使其适合滚动条的顶部。请参见下面的代码：

```
 $(document).ready(function(){
 var maxWidth = $('#Header1').width();    // Get max row Width
 $('#Header2 th').each(function(i) {     // Set col headers widths to to match col widths 
      var width = $(this).width();
      $('#Header1 th').eq(i).width(width);
 });

 var blankSpace = maxWidth - $('#Header1').width();               // Calculate extra space
 $('#Header1 th:last').width( $('#Header1 th:last').width() + blankSpace );  // Stretch last header column to fill remaining space

}); 
```

我已经在 Windows XP 上的 IE 6、7 和 8、Firefox 3.0.1.4、Chrome 3.0.195.25、Opera 10 和 Safari 3.2.2 上成功测试了这一点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T16:30:51.110

我过去使用 CSS 通过为我的表上`height`的`<TBODY>`标记定义 a 并使用`overflow:auto`. 这是不久前的事情，我认为存在一些兼容性问题。我不记得它们是什么，但这个解决方案可能适用于您的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-13T17:15:52.517

最好的解决方案（使用大量数据进行扩展的解决方案）是使用 2 个表格，如 aaron 所说，顶部表格有标题，底部表格应该将标题作为最后一行（或页脚），但不透明0，所以你看不到它们。

底部的标题使底部表格与顶部表格具有相同的列宽，从而使事情排成一行。确保您的页眉和页脚样式相同。

您还必须为表格右侧的垂直滚动创建一个单独的滚动条，否则滚动条会弄乱您的宽度。添加滚动事件监听器，将表格的scrolltop设置为滚动条的scrolltop，并将滚动条的大小调整为与表格相同的高度。

其实很简单=）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-13T21:33:36.047

像往常一样创建一个表来满足可访问性问题。使用jQuery基于thead动态创建一个新表（复制thead）并将其注入到第一个表上方的页面中并给它固定位置。它应该在表格的其余部分滚动时保持在原位，但它仍然可以访问并在禁用 JavaScript 的情况下工作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-10-10T18:22:32.427

你试过 JQuery 的这个插件吗？[http://plugins.jquery.com/project/floatobject](http://plugins.jquery.com/project/floatobject) 我相信这可以满足您的需求。查看演示 @ [http://amirharel.com/labs/fo/float_demo.html](http://amirharel.com/labs/fo/float_demo.html) 干杯！

# .net - itemCommand 事件未在使用自定义 ITemplate 的 ListView 中触发

> ID：643341
> 
> 赞同：1
> 
> 时间：2009-03-13T15:46:50.123
> 
> 标签：.net, itemplate

我已经为我的 listView 控件创建了一个自定义项模板，但项命令不会为通过 ITemplate 生成的按钮触发。不仅如此，当您单击任何按钮时，这些项目都会消失。以下是我正在使用的代码，它有问题。

ITemplate 的代码

公共类 FirstItemTemplate : ITemplate {

```
public void InstantiateIn(System.Web.UI.Control container)
{
    var oTR = new HtmlGenericControl("tr"); 
    var oTD1 = new HtmlGenericControl("td"); 

    Button btnEnter = new Button(); 
    btnEnter.ID = "btnEnter";        
    oTD1.Controls.Add(btnEnter); 
    oTR.Controls.Add(oTD1); 

    var oTD2 = new HtmlGenericControl("td"); 
    Label lblProduct = new Label(); 
    lblProduct.ID = "lblProduct"; 
    oTD2.Controls.Add(lblProduct); 
    oTR.Controls.Add(oTD2);

    oTR.DataBinding += new EventHandler(oTR_DataBinding);
    container.Controls.Add(oTR);

}

void oTR_DataBinding(object sender, EventArgs e)
{
    var container = (HtmlGenericControl)sender; 
    var dataItem = ((ListViewDataItem)container.NamingContainer).DataItem;

    PaperObject pro = (PaperObject)dataItem;

    Button btnEnter = (Button)container.FindControl("btnEnter"); 
    Label lblProduct = (Label)container.FindControl("lblProduct");
    btnEnter.Text = pro.PaperId.ToString();
    btnEnter.CommandName = "Select";
    btnEnter.CommandArgument = pro.PaperId.ToString();

    lblProduct.Text = pro.Description;

} 
```

}

和数据绑定：

ListView1.ItemTemplate = new FirstItemTemplate(); ListView1.DataSource = p.SelectPaper(); ListView1.DataBind();

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-01-07T18:43:04.023

我遇到了同样的麻烦，只是我的情况略有不同。我正在使用数据网格来提供使用一系列查询的向下钻取。在第一个钻取（链接点击）到第二个报告时它工作正常，但在第二到第三个报告中它只是刷新页面而不触发点击事件，但在页面刷新后它可以工作，这意味着用户必须点击两次才能获得第三份报告。

这是我所拥有的：

```
Private Class DrilldownTemplate : Implements ITemplate
    Private _fieldName As String

    Sub New(ByVal fieldName As String)
        _fieldName = fieldName
    End Sub

    Sub InstantiateIn(ByVal container As Control) Implements ITemplate.InstantiateIn
        Dim linkbtn As LinkButton = New LinkButton
        AddHandler linkbtn.DataBinding, AddressOf BindHyperLinkColumn
        container.Controls.Add(linkbtn)
    End Sub

    Public Sub BindHyperLinkColumn(ByVal sender As Object, ByVal e As EventArgs)
        Dim linkbtn As LinkButton = CType(sender, LinkButton)
        Dim container As DataGridItem = CType(linkbtn.NamingContainer, DataGridItem)

        With linkbtn
            .CommandName = "Drilldown|" & _fieldName
            .CommandArgument = Convert.ToString(DataBinder.Eval((CType(container, DataGridItem)).DataItem, _fieldName))
            .Text = Convert.ToString(DataBinder.Eval((CType(container, DataGridItem)).DataItem, _fieldName))
        End With
    End Sub
End Class 
```

# php - (PHP) 选择 memcache::connect 还是 memcache::pconnect？

> ID：643345
> 
> 赞同：4
> 
> 时间：2009-03-13T15:47:47.673
> 
> 标签：php, memcached

我正在使用 php::memcache 模块连接本地 memcached 服务器 (@127.0.0.1)，但我不知道应该使用哪个， memcache::connect() 还是 memcache::pconnect ？memcache::pconnect 会消耗服务器的很多资源吗？

非常感谢您的回答！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-13T18:08:59.563

Memcached 使用 TCP 连接（握手是 3 个额外的数据包，关闭通常是 4 个数据包）并且不需要**任何身份验证**。因此，使用持久连接的唯一好处是您不需要发送那额外的 7 个数据包，也不必担心会有几秒钟 的剩余[TIME-WAIT端口。](http://en.wikipedia.org/wiki/Transmission_Control_Protocol#Connection_termination)

可悲的是，牺牲这些资源的负面影响远远大于次要的好处。所以我建议不要在 memcached 中使用持久连接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T16:20:40.793

`pconnect`代表持久连接。这意味着客户端（在您的情况下是脚本）将不断地打开到您的服务器的连接，这可能不是资源问题 - 更多的是缺乏可用的连接。

`connect`除非您知道需要使用持久连接，否则您可能应该想要标准。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T16:24:42.483

据我所知，连接到 MySQL 时管理持久连接和常规连接的相同[规则也适用于 memcached。](https://stackoverflow.com/questions/247807/mysqlconnect-vs-mysqlpconnect)结果是，在这两种情况下，您可能都不应该使用持久连接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-15T11:47:49.507

In application I'm developing I use pconnect as it uses connection pool and from the view of hardware - one server keeps one connection to memcache. I don't know exactly how it works but I think memcached is smart enough to track IP of memcached client machine.

I've played with memcached for a long time and found that using memcache::getStatus shows that connections count doesn't increased when using pconnect.

You can use debug page which show memcached stats and try to tweak pconnect or connect and see what's going on.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T16:08:58.557

“消耗” TCP 端口。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-02-17T13:38:24.707

一个缺点是，如果一个或所有持久连接的 memcached 守护进程消失，PHP 不会收到明显的错误或警告。这是一个相当大的缺点。

# java - 在低端笔记本电脑上进行 Java 编程的好 IDE 是什么？

> ID：643346
> 
> 赞同：10
> 
> 时间：2009-03-13T15:47:52.743
> 
> 标签：java, windows, ide

我不得不时不时地远离我的台式电脑工作（例如在旅行中）。这是一款低端笔记本电脑。我可以使用 Eclipse，但它非常慢。

有更好的选择吗？如果可能的话，不要像 vi oder emacs 那样。

笔记本电脑：
512 MB DDR RAM
Intel Pentium M 760 2.0 GHz
Windows XP SP3

不可能添加更多 RAM

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-13T15:50:24.063

到底有多低端？我曾经使用[IntelliJ Idea](http://www.jetbrains.com/idea/)并喜欢它，它对我来说也比 eclipse 运行得更快。[DrJava](http://drjava.sourceforge.net/)也非常小巧轻便。但我个人更喜欢 vim + javac 最好的。:)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-13T15:50:43.297

Netbeans 比 Eclipse 慢一点，但它是一个巨大的内存猪。

Emacs 也总是一个不错的选择。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-13T16:24:51.670

我实际上不认为这是一台“低端”机器。

我在 P3 1.2 Ghz 512M RAM 笔记本电脑上使用了 Eclipse 和 NetBeans，它们都可以运行。它们有点迟钝，但可以使用。在这两者之间，我会说 NetBeans 不那么迟钝，可能是因为没有那么多的 UI 元素和框架。

我的主要家用笔记本电脑是东芝 512M Pentium M 2 Ghz，Ec​​lipse 在其上运行良好（Visual Studio 2008 也是如此）。

似乎在这些大型 IDE 中，RAM > CPU 会影响速度。

编辑：值得注意的是，我的 P3 1.2 Ghz 笔记本电脑运行的是 Ubuntu，而我的 Pentium M 2 Ghz 运行的是 Win XP。

Eclipse 在 Linux 中的速度明显更快。我曾经测试过大型项目的构建时间：

WinXP 运行 Eclipse -vs- WinXP 运行 VMWare Workstation 运行 Ubunty 运行 Eclipse

令人惊讶的是，VMWare 中的 Ubuntu 始终快得多，比 Windows 上 7 分钟的构建过程快了大约 30 秒。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-13T16:39:19.577

你可以试试[JEdit](http://www.jedit.org/)，虽然它不是一个真正的 IDE，但它确实支持大量以 Java 为中心的功能，如源格式、语法突出显示和 Java 调试器，以及许多其他功能，所有这些功能都可以通过插件添加/减去系统。过去，当我想要比记事本功能更强大但比 Eclipse 更轻巧的东西时，我曾使用过它。

由于它是用 Java 编写的，因此它都是开源和免费的，并且可以移植到大多数系统中。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-14T01:55:40.240

[Notepad++](http://notepad-plus.sourceforge.net/uk/site.htm)是一个不错的轻量级编辑器。Notepad++ 基于强大的编辑组件 Scintilla，采用 C++ 编写，使用纯 Win32 API 和 STL，确保更高的执行速度和更小的程序大小。通过在不失去用户友好性的情况下尽可能多地优化例程，Notepad++ 正试图减少世界二氧化碳排放量。当使用较少的 CPU 功率时，PC 可以降低功耗并降低功耗，从而实现更环保的环境。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-17T10:56:31.657

我猜它是 JCreator Pro .. 免费版，JCreator lite 还可以，但功能有限。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-13T15:52:26.133

你可以看看[BlueJ](http://www.bluej.org/)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-13T15:57:12.033

我还没有尝试过，但最近偶然发现了[JCoder](http://support.jcoder.com/index.php)，这是一个用 C++ 编写的 Java IDE。规定的最低内存要求为 512MB。

此外，您可以考虑运行旧版本的 Eclipse，和/或尝试调整 Eclipse 以更好地在您的硬件上运行。谷歌搜索“Eclipse 性能调整”会出现一堆页面，其中包含可能适用的建议。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-03-13T16:00:01.700

像 3、4、5 这样的旧版本 IntelliJ IDEA 可以在该内存上轻松运行 - 只要您没有大型项目，并且愿意错过新版本中的某些功能。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-03-13T16:06:44.490

如果您在低端计算机上并且不需要调试等，文本编辑器加上 Java 控制台是您最好的工具。

这真的取决于你的项目，而不是实际的硬件，所以你需要考虑它的利弊。

祝你好运。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-03-14T01:59:32.633

以前我总是偏爱[JCreator](http://www.jcreator.com/)。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-03-13T15:57:49.397

您可以仅将 netbeans 与您使用的模块一起使用（与 eclipse 相同）或 geany（使用 linux？）不是 ide，而是具有 ide 功能的非常好的文本编辑器，其他选项是使用更高效的 netbeans/eclipse 旧版本

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-03-13T16:21:13.210

如果可以的话，获取更多内存。

SciTE、JUnit、Ant 和 jvisualvm 曾经在我的笔记本电脑上运行良好，它有 768M，或者我现在使用的 2GB/1GHz 上网本。在极少数情况下您必须使用调试器，然后总是有 jdb。我在笔记本电脑上使用 IDE 时遇到的问题更多是与屏幕空间有关，而不是与性能有关。OTOH 我放弃了 Netbeans，因为我上次签约时它的文本编辑器在“标准构建的商业桌面”机器上太慢了。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-03-13T16:44:57.690

gvim + ctags + 蚂蚁

如果使用几乎任何现代 AppServer，您将耗尽内存。

我希望你不是。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-03-13T20:10:04.407

我一直在使用[E Text Editor ，这是](http://www.e-texteditor.com/)[TextMate](http://macromates.com/)的一个端口，我很喜欢它。带有内置的语法高亮、片段，可以下载 TextMate 包和完全可定制/可扩展的 ruby​​。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-03-14T02:27:40.333

我偶尔将 TextPad 用于简单的 Java 程序。它非常轻量级、免费（好吧，nagware，但价格不贵），并且有一个简单易用的编译和运行选项。还有语法高亮，虽然我从来没有用过。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-03-14T16:46:39.623

重要的问题是您认为一个好的 IDE 应该具备哪些功能。

代码完成？鼠标悬停中的JavaDoc？“去定义”？内置调试器？语法高亮？增量编译？

一个好的起点是使用 ant 构建代码，因为它允许您将其移出 IDE，希望它需要更少的空间来运行。

我相信旧版本的 JBuilder 的要求相当低。为此，您可能想购买二手的。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-03-13T15:54:48.420

有没有机会升级笔记本电脑的内存？CPU 无关紧要，但 IDE 几乎总是占用大量内存（甚至 EMACS 在当时也被认为是这样）。

我想说，如果您不做大型项目并且不同时运行任何其他大型应用程序，您可以使用 Windows XP 在 1GB（甚至 512MB）中很好地运行 eclipse。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-03-13T15:55:59.337

只要我已经建立了一个项目，我就使用[vim/gvim](http://www.vim.org/)进行大多数维护开发或鬼混。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-03-13T16:41:47.620

首先，内存是个问题。

Linux 在内存不足的情况下表现相当不错，但 pc 不是很好，mac 很糟糕！（如果你有 512M 和少于 4gb 的可用硬盘，它几乎不会工作！这是因为 mac 从硬盘上的“可用空间”分配它的交换）

Mac 很容易升级。我在 Fry's 以不到 100 美元的价格购买了 4GB 的笔记本电脑，插槽位于电池仓内。升级后，我的最底层 mac 从来没有给我任何时间来关注它的性能。

PC 比 mac 更难，但因型号而异。

好的，假设您不想升级。

最重要的事情是确保您拥有 Javadocs 的本地副本。如果你没有 eclipse/netbeans，你会很快错过它们。

在那之后，谁在乎你使用什么编辑器。就我个人而言，我会使用内置编辑器，因为我实际上对着色和自动格式化印象不深。

如果您需要上下文着色，我猜 vim 将是具有 Java 模式的最轻量级的编辑器（至少我相信它有一个）。JEdi​​t 相当轻量级，emacs 也是如此，我知道它们都有 java 模式。

对于仅使用 ant 或 maven 的构建，在 IDE 中构建很好，但被高估了。

正如我所说，最重要的是始终将 javadocs 放在浏览器书签上。

# tfs - “tf add /recursive”中是否有错误？

> ID：643350
> 
> 赞同：0
> 
> 时间：2009-03-13T15:48:41.557
> 
> 标签：tfs, tf-cli

我正在尝试将以下文件夹树添加到 TFS：

```
C:\TFS\folder1
C:\TFS\folder1\folder2
C:\TFS\folder1\folder2\folder3
C:\TFS\folder1\folder2\folder3\test.txt 
```

在上面的示例中，文件夹“C:\TFS”是一个映射的 TFS 工作文件夹。我从控制台发出以下命令：

```
cd C:\TFS
tf add folder1 /recursive 
```

此命令完成后，我的存储库包含以下树（作为挂起的更改）：

```
$/folder1
$/folder1/folder2 
```

如您所见，“folder3”和下面的文本文件“test.txt”完全丢失了！为什么？

**更新：**我已将此作为错误提交给 Microsoft：

[http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=423279](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=423279)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-17T21:53:37.437

为我工作。

```
c:\Temp>md Test\1\2\3\4\5

c:\Temp>dir test /s/b
c:\Temp\test\1
c:\Temp\test\1\2
c:\Temp\test\1\2\3
c:\Temp\test\1\2\3\4
c:\Temp\test\1\2\3\4\5

c:\Temp>cd test

c:\Temp\Test>tf add 1 /recursive
1

1:
2

1\2:
3

1\2\3:
4

1\2\3\4:
5

c:\Temp\Test> 
```

在 Tfs 中 [![TFS 树视图](https://i.stack.imgur.com/0e4Y4.png)](https://i.stack.imgur.com/0e4Y4.png)

如果我从 Test 或以上的 Test 目录执行，则相同

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T06:22:48.207

来自微软的基本命令如下：

```
tf add itemspec [/lock:(none|checkin|checkout)] [/type:filetype] 
[/noprompt] [/recursive] [/login:username,[password]] 
```

我输入了以下命令，它工作正常：

```
"C:\Program Files (x86)\Microsoft Visual Studio 10.0\Common7\IDE\tf.exe" add itemspec /r "where to add to" 
```

您从要复制文件的文件夹中运行命令，然后在“添加到的位置”下的命令中键入目标

# ant - 如何将列表的每个元素分配给任务 Ant 的参数？

> ID：643352
> 
> 赞同：4
> 
> 时间：2009-03-13T15:48:59.853
> 
> 标签：ant, macrodef

如何将已定义任务的参数值放入（值）列表中，而不必为每个参数值重写任务？

示例：我想避免必须重写三次相同的任务来回显三个不同的值（值 1、值 2、值 3）：

```
<exec executable="cmd">
    <arg value="/c"/>
    <arg value="value 1"/>
</exec>

<exec executable="cmd">
    <arg value="/c"/>
    <arg value="value 2"/>
</exec>

<exec executable="cmd">
    <arg value="/c"/>
    <arg value="value 3"/>
</exec> 
```

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-16T06:30:42.053

您可以使用该[`MacroDef`任务](http://ant.apache.org/manual/Tasks/macrodef.html)来抽象您的任务的公共部分：

```
<macrodef name="myMacro">
    <attribute name="value"/>
    <sequential>
         <exec executable="cmd">
             <arg value="/c"/>
             <arg value="@{value}"/>
         </exec>
    </sequential>
</macrodef>

<myMacro value="value 1"/>
<myMacro value="value 2"/>
<myMacro value="value 3"/> 
```

# vb.net - 如何更改由 VisualStyleRenderer 绘制的形状的颜色？

> ID：643353
> 
> 赞同：0
> 
> 时间：2009-03-13T15:49:09.510
> 
> 标签：vb.net, winforms, gdi+

我有一个将图表动态绘制到 winform 上的应用程序。

图表背景和单独的图表条都是使用 VisualStyleRenderer 对象绘制的：

```
 For Each rect As Rectangle In barRectangles

   Dim renderer As New VisualStyleRenderer (VisualStyleElement.StartPanel.UserPane.Normal)
   renderer.DrawBackground(e.Graphics, rect)
 next 
```

这绘制了一个具有完整 XP 视觉样式的渲染良好的矩形，我的问题是：如何更改用于绘制形状的颜色？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T13:17:39.360

此[链接](http://msdn.microsoft.com/en-us/library/system.windows.forms.visualstyles.visualstylerenderer.aspx)可能会有所帮助。

# security - 带有令牌参数的 https URL：它有多安全？

> ID：643355
> 
> 赞同：100
> 
> 时间：2009-03-13T15:49:31.227
> 
> 标签：security, url, https, token

在我们的网站上，我们根据用户的私人信息（通过表格提供）向用户提供模拟。我们希望允许他们稍后返回他们的模拟结果，但不强迫他们创建登录/密码帐户。

我们曾考虑向他们发送一封带有链接的电子邮件，他们可以从中获取结果。但是，很自然，我们必须保护这个 URL，因为私人数据受到威胁。

因此，我们打算在 URL 中传递一个令牌（如 40 个字符的字母和数字组合，或 MD5 哈希）并使用 SSL。

最后，他们会收到这样的电子邮件：

> 嗨，在[https://www.example.com/load_simulation?token=uZVTLBCWcw33RIhvnbxTKxTxM2rKJ7YJrwyUXhXn](https://www.example.com/load_simulation?token=uZVTLBCWcw33RIhvnbxTKxTxM2rKJ7YJrwyUXhXn)
> 上取回您的结果

你怎么看待这件事？是否足够安全？对于令牌生成，您有什么建议？在 https 请求中传递 URL 参数怎么样？

* * *

## 回答 #1

> 赞同：111
> 
> 时间：2009-03-13T16:15:45.250

SSL 将保护传输中的查询参数；但是，电子邮件本身并不安全，电子邮件在到达目的地之前可能会在任意数量的服务器上反弹。

此外，根据您的 Web 服务器，完整的 URL 可能会记录在其日志文件中。根据数据的敏感程度，您可能不希望您的 IT 人员访问所有令牌。

此外，带有查询字符串的 URL 将保存在您的用户历史记录中，允许同一台机器的其他用户访问该 URL。

最后，使这非常不安全的是，URL 是在任何资源的所有请求的Referer 标头中发送的，甚至是第三方资源。因此，例如，如果您使用 Google Analytics（分析），您将向 Google 发送 URL 令牌并将其全部发送给他们。

在我看来，这是一个坏主意。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-13T16:18:47.083

我会为此使用cookie。工作流程应该是这样的：

1.  用户第一次访问您的网站。
2.  网站设置 cookie
3.  用户输入数据。使用存储在 cookie 中的某个键将数据存储在数据库中。
4.  当用户离开时，您向他们发送一封带有 https: 链接的电子邮件
5.  当用户回来时，站点会发现 cookie 并可以向用户呈现旧数据。

现在，用户想要在不同的机器上使用不同的浏览器。在这种情况下，提供一个“转移”按钮。当用户点击这个按钮时，她会得到一个“令牌”。她可以在另一台计算机上使用此令牌来重置 cookie。这样，用户可以决定她想要转移令牌的安全性。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-13T15:55:39.480

SSL 保护传输中的数据内容，但我不确定 URL。

无论如何，减轻攻击者重复使用该 URL 令牌的一种方法是确保每个令牌只能使用一次。您甚至可以设置一个 cookie，以便合法用户可以继续使用该链接，但在第一次访问后，它只对拥有 cookie 的人有效。

如果用户的电子邮件被泄露并且攻击者首先获得了链接，那么你就完蛋了。但用户也有更大的问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-13T15:55:34.910

电子邮件本质上是不安全的。如果任何人都可以单击该链接并获取数据，那么您并没有真正保护它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-13T15:56:47.247

那么令牌在通过 SSL 传递时是安全的。您将遇到的问题是，人们（那些不适合使用它的人）可以通过查看 URL 来使用它。

如果是像 SSN 这样的私人信息，我认为我不会通过电子邮件发送 URL。我宁愿让他们为该站点创建用户名和密码。对于您和他们来说，使用此类信息危及您的利益的电子邮件太容易泄露。如果某人的帐户被盗用，就会有人质疑这到底是谁的错。从严格的 CYA 角度来看，您越安全越好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-13T15:56:30.290

您是否知道，如果任何黑客访问您的数据库，可以免费提供大量个人信息？

在那之后，我会说这不是一个坏主意。我不会使用 MD5 或 SHA1，因为它们对于散列不是很安全。它们可以很容易地“解密”（我知道这不是加密）。

否则，我可能会使用不会通过电子邮件发送的第二个信息，例如密码。原因很简单，如果有人可以访问用户的电子邮件（如果您不终止会话，使用 hotmail 很容易），他将可以访问用户发送的任何信息。

请注意，HTTPS 将保护和加密从您的站点发送到最终用户的数据。没有别的，把它当作一个安全的隧道。不多不少。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-13T15:58:16.477

对于存在严重隐私问题的情况，我真的认为这不够安全。您在（可能是明文）电子邮件中发送 URL 的事实是迄今为止最薄弱的环节。之后是对令牌进行暴力攻击的风险，令牌（缺乏真正的身份验证机制的结构）可能比结构良好的用户名和密码设置更容易受到攻击。

顺便说一句，https 请求中的参数完全没有问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-08T16:42:27.097

事实上，这将是一个坏主意。您将轻松使用安全性。如前所述，SSL 只会保护服务器和客户端浏览器之间的信息传输，只会防止中间人攻击。电子邮件非常危险且不安全。

最好的方法是通过用户名和密码身份验证来访问信息。

我或多或少喜欢饼干的想法。您还应该加密 cookie 信息。您还应该使用盐和关键短语以及 $_SERVER['HTTP_USER_AGENT'] 生成令牌以限制攻击的可能性。在 cookie 中存储尽可能多的关于客户端的非敏感信息以供验证使用。

关键短语可以存储在 cookie 中以便于使用，但请记住，cookie 也可能被盗 =(.

最好让客户键入他提供的关键词，该关键词也与他的数据一起存储在数据库中。

或者，如果该人使用 $_SERVER['HTTP_USER_AGENT'] 参数不同的不同机器或只是错过了 cookie，则可以使用该密钥。所以cookie可以被传输或设置。

还要确保数据库中的敏感数据已加密。你永远不会知道 ;）

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-03-13T15:56:48.790

根据我对您的想法的理解，理论上有人可以输入随机的 40 个字符串或 MD5 哈希并获取其他人的详细信息。虽然这可能极不可能发生，但它只需要发生一次。

更好的解决方案可能是向用户发送令牌，然后要求他们输入一些详细信息，例如他们的姓名、邮政编码、ssn 或这些的组合。

# c# - 如何在 Silverlight 中手动将数据添加到 DataGrid

> ID：643361
> 
> 赞同：1
> 
> 时间：2009-03-13T15:51:05.263
> 
> 标签：c#, silverlight, datagrid, dictionary, itemssource

我发现可以在 Silverlight 中动态创建和绑定数据网格列。但是我找不到将数据绑定到这些列的方法。

如果我尝试使用 AutoGenerateColumns = true 绑定任何类型的对象，则对象的每个属性的名称都会添加为列，并且除了不显示数据的现有列之外，对象信息还会显示在网格中。

如果我应用 AutoGenerateColumns = false 的列表，那么我仍然会在表中显示行，但列中没有数据。

我不想为需要在数据网格中显示数据的每种情况创建一个特定的对象。

我不想让我的列名仅限于属性名称，例如没有空格的名称。

我希望能够将列表或字典数组绑定到数据网格。我还希望能够控制哪些数据显示在哪些列中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T20:14:39.957

您可能快到了，但只是在您的 xaml 中有一些微妙的错误，这是一个工作示例：

```
<UserControl x:Class="Testproject.EditableDataGrid"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    xmlns:data="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Data"
    Width="400" Height="300">
    <Grid x:Name="LayoutRoot" Background="White">
        <data:DataGrid x:Name="myDataGrid" AutoGenerateColumns="False"> 
            <data:DataGrid.Columns>
                <data:DataGridTextColumn Header="My text" Binding="{Binding StringValue}" />
                <data:DataGridCheckBoxColumn Header="Check Box" Binding="{Binding IsChecked}" />
                <data:DataGridTemplateColumn Header="A template column">
                    <data:DataGridTemplateColumn.CellTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                            <Rectangle Width="20" Height="5" Fill="Red"/>
                            <TextBlock Text="{Binding IntValue}" />
                        </StackPanel>
                    </DataTemplate>
                </data:DataGridTemplateColumn.CellTemplate>

            </data:DataGridTemplateColumn>
                <data:DataGridTextColumn Header="My int" Binding="{Binding IntValue}" />
            </data:DataGrid.Columns>
        </data:DataGrid>
    </Grid>
</UserControl>

using System.Windows;
using System.Windows.Controls;
using System.Collections.Generic;

namespace Testproject
{
    public partial class EditableDataGrid   :UserControl
    {
        public EditableDataGrid()
        {
            InitializeComponent();

            myDataGrid.ItemsSource = new List<ClassForDataGridTest>()
                            {
                                new ClassForDataGridTest() {StringValue="hello", IntValue=21, IsChecked=false}
                                , new ClassForDataGridTest() {StringValue="the second", IntValue=122, IsChecked = true}
                            };
        }
    }

    public class ClassForDataGridTest   : DependencyObject
    {

        public string StringValue {get; set;}

        public int IntValue {get; set;}

        public bool IsChecked { get; set; }

    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-20T13:27:27.957

假设您有一个要绑定信息的类或其他容器，您可以执行以下操作。

```
DataGridTextColumn product = new DataGridTextColumn();
                product.Binding = new System.Windows.Data.Binding("Product");
                product.Header = "Product";

                DataGridTextColumn date = new DataGridTextColumn();
                date.Binding = new System.Windows.Data.Binding("Date");
                date.Header = "Date";

                DataGridTextColumn version = new DataGridTextColumn();
                version.Binding = new System.Windows.Data.Binding("FileVersion");
                version.Header = "Version";

                DataGridTextColumn timestamp = new DataGridTextColumn();
                timestamp.Header = "TimeStamp";
                timestamp.Binding = new System.Windows.Data.Binding("TimeStamp");

                DataGridTextColumn user = new DataGridTextColumn();
                user.Header = "User";
                user.Binding = new System.Windows.Data.Binding("User");

                rpdata.Columns.Add(product);
                rpdata.Columns.Add(date);
                rpdata.Columns.Add(version);
                rpdata.Columns.Add(timestamp);
                rpdata.Columns.Add(user); 
```

现在只需将数据网格的 itemsource 设置为您拥有的项目集合。

这允许您设置要显示的标题，并将信息绑定到容器中的变量，因此它仅显示您添加的列的信息。

# unix - 将父文件夹和子文件夹的名称附加到多个文件的名称中

> ID：643372
> 
> 赞同：0
> 
> 时间：2009-03-13T15:55:01.837
> 
> 标签：unix, shell, sysadmin

我有文件夹和子文件夹，里面有 10K 张照片。

现在我需要将所有 10K 文件放入一个文件夹中。我想用现有文件名附加文件夹和子文件夹名称，以便文件名对我有意义。

我需要帮助

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-13T16:09:27.527

您可以编写一个快速的 shell 脚本来为您执行此操作。要获取当前文件夹的名称：

```
pwd|awk -F'/' '{print $NF}' 
```

并获取当前文件夹的父级：

```
pwd|awk -F'/' '{SL = NF-1; print $SL}' 
```

**更新**

创建一个如下所示的文件：

```
#!/bin/bash

for f in `find . -name '*jpg'`
do
   filename=`echo $f|awk -F'/' '{SL = NF-1; TL = NF-2; print $TL "_" $SL  "_" $NF}'`
   cp $f newfolder/$filename
done 
```

然后就`chmod +x`可以了。在顶层运行脚本。在这种情况下，您需要提前创建目的地 newfolder。

我采用了这个目录结构：

```
./bar
./bar/baz
./bar/baz/1.jpg
./bar/baz/2.jpg
./bar/baz/3.jpg
./bar/buz
./bar/buz/1.jpg
./bar/buz/2.jpg
./bar/buz/3.jpg
./foo
./foo/baz
./foo/baz/1.jpg
./foo/baz/2.jpg
./foo/baz/3.jpg
./foo/buz
./foo/buz/1.jpg
./foo/buz/2.jpg
./foo/buz/3.jpg 
```

并做到了这一点：

```
./newfolder/bar_baz_1.jpg
./newfolder/bar_baz_2.jpg
./newfolder/bar_baz_3.jpg
./newfolder/bar_buz_1.jpg
./newfolder/bar_buz_2.jpg
./newfolder/bar_buz_3.jpg
./newfolder/foo_baz_1.jpg
./newfolder/foo_baz_2.jpg
./newfolder/foo_baz_3.jpg
./newfolder/foo_buz_1.jpg
./newfolder/foo_buz_2.jpg
./newfolder/foo_buz_3.jpg 
```

希望这就是你要找的。

# asp.net - 数据库连接池大小合理限制？

> ID：643378
> 
> 赞同：2
> 
> 时间：2009-03-13T15:55:40.930
> 
> 标签：asp.net, sql, connection-pooling

我们的网络应用程序到我们的数据库的池大小设置为 600 个连接。然而，我刚刚收到一封来自客户的电子邮件，说他们正在向 4000 多名用户推送我们的培训课程，告诉他们应该在本月 27 日之前完成。我应该把它提高到4000吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T16:06:26.520

首先，请记住在 8 小时内有 4000 个用户在不同时间访问系统中的内容，这与有 4000 个并发用户的负载不同。

此外，除非数据访问的实现方式存在一些问题，否则您真的不需要这样做。这实际上取决于类型负载 + 架构 + [插入其他因素]。最好的办法是做一些负载测试。还可以考虑获取有关当前负载的性能/资源使用信息，并进行一些基于事务成本的分析。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T16:10:57.650

不，连接池为您管理连接。

在您的代码中，当您关闭连接时，它会返回池并由其他请求者使用。

我想说的是，您的连接大小不必等于用户数。默认连接池大小是 100，那么我认为你的连接池大小是（600）足够了。

# redirect - IIS6 301 重定向，同时保留路径

> ID：643382
> 
> 赞同：4
> 
> 时间：2009-03-13T15:56:22.300
> 
> 标签：redirect, iis-6, http-status-code-301

我遇到了 IIS6 301 重定向问题。

我已经为域设置了以下重定向，`domain.com`以转到`www.domain.com$S$Q`站点属性中的主目录选项卡下。

如果我导航到`domain.com`我会被重定向到`www.domain.com`没有问题。但是，如果我去，`domain.com/dir`我会被重定向到`www.domain.com/dir/dir`.

我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T16:11:51.810

您希望按照[这些说明](http://www.highposition.net/301-redirect-tutorial-iis/)设置 HTTP 301。

**编辑：**对于它的价值听起来你需要在主目录选项卡上检查“客户端将被发送到此资源的永久重定向”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T16:23:59.130

检查“上面输入的确切 URL”复选框似乎可以解决问题。

# vb6 - 在运行时将项目添加到列表视图

> ID：643385
> 
> 赞同：2
> 
> 时间：2009-03-13T15:56:45.250
> 
> 标签：vb6, listview, listviewitem

当我使用以下方法向列表视图添加新值时：

```
 Set lstView = ListView(0).ListItems.Add(, , txtName)
    lstView.ListSubItems.Add , , txtValue
    lstView.Refresh 
```

唯一的问题是这只在列表视图中显示一个空白的新行，知道如何正确更新它吗？

通常我使用的是记录集，所以只需清除然后重新填充数据，但我需要用户能够将条目添加到列表视图。然后，只有在用户完成修改列表视图后，我才会循环通过列表视图将值添加到数据库中。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-13T16:25:52.853

假设您的 ListView 的 .View 属性设置为“报告”，下面将向控件添加几行并设置子项文本。

```
Dim li As ListItem

With ListView1
    .ColumnHeaders.Add , , "One"
    .ColumnHeaders.Add , , "Two"
    .ColumnHeaders.Add , , "Three"

    Set li = .ListItems.Add(, , "Row1Item1")
    li.SubItems(1) = "Row1Item2"
    li.SubItems(2) = "Row1Item3"

    Set li = .ListItems.Add(, , "Row2Item1")
    li.SubItems(1) = "Row2Item2"
    li.SubItems(2) = "Row2Item3"
End With 
```

# c# - 在 Compact Framework 中获取多行文本框中显示的行数

> ID：643390
> 
> 赞同：0
> 
> 时间：2009-03-13T15:57:14.110
> 
> 标签：c#, compact-framework

我有一个多行文本框，通常显示很长的字符串（例如许可协议），并且围绕显示的要求是，如果用户通过垂直滚动条“翻阅”文本（不单击箭头或滚动框，但单击滚动框上方或下方），在最后一个“页面”上，第一行必须是上一页的最后一行，并且文本用空白行填充以适应这一点。

我知道我可以获取字符串的大小和文本框中的行数，但是是否可以一次检索文本框中*显示*的行数，以便我可以计算需要填充多少文本? 查看我可以通过 P/Invoke 发送的[消息](http://www.developerfusion.com/article/46/sending-messages/3/)列表，我没有看到请求显示行数的消息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T16:19:55.770

您可以通过计算字体高度并以此划分文本框高度来获得一次显示的最大行数。

只是一个想法......不确定它是否会正确，但你可以做一些测试，看看它是否匹配。

要获取字体高度：

[public SizeF MeasureString（字符串文本，字体字体）](http://msdn.microsoft.com/en-us/library/6xe5hazb.aspx)

# java - 简单的 Java 日期计算

> ID：643402
> 
> 赞同：7
> 
> 时间：2009-03-13T16:01:18.607
> 
> 标签：java, date-arithmetic

我想用Java做简单的日期计算。例如，计算到日期之间的天数差异（时间分量为 0）。当然，您可以做一个简单的毫秒减法，除以每天的毫秒数，这很好 - 直到夏令时进入现场。我意识到对“天数差异”的不同解释是可能的，特别是是否应该考虑时间部分。为简单起见，让我们假设我们有一个 0 时间分量。

这种计算似乎是一种非常普遍的需求，我很高兴能就这个问题的不同方法进行讨论。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-13T16:08:18.980

我会看看[Joda](http://joda-time.sourceforge.net/)日期/时间库，特别是[ReadableInterval](http://joda-time.sourceforge.net/api-release/org/joda/time/ReadableInterval.html)类。

在 Java 中操作日期/时间时，Joda 让生活变得更加轻松，我相信这是新的 Java [JSR 310](http://www.infoq.com/news/2007/02/jsr-310) wrt 的基础。日期/时间。即它（或非常相似的东西）将出现在Java 的未来版本中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-14T18:37:52.210

看起来 Date、Calendar 和 DateUtils 可以满足您的所有需求。 [http://commons.apache.org/lang/api/org/apache/commons/lang/time/DateUtils.html](http://commons.apache.org/lang/api/org/apache/commons/lang/time/DateUtils.html)

DateUtils 允许截断或舍入时间，因此您可以只处理日期。您还提到了夏令时。主要问题是当有人说他们在 DST 更改的一天 01:30 做了某事时……是哪个 01:30？第一个还是第二个？幸运的是，这可以由 Calendar 类处理，因为它存储时区和 DST 偏移量。有关所有这些的详细信息，请查看： [http ://www.xmission.com/~goodhill/dates/deltaDates.html](http://www.xmission.com/~goodhill/dates/deltaDates.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-04-19T05:39:01.240

更简单的选择是使用 Joda 中的 Days、Weeks、Months 和 Years 类。

这样，您可以执行以下简单的操作：

```
int daysDifference = Days.daysBetween(startInstant, endInstant).getDays(); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-04-28T08:27:41.477

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-13T16:11:16.087

[这是一篇](http://www.javaworld.com/javaworld/jw-03-2001/jw-0330-time.html?page=1)讨论在 Java 中使用日期/日历工具来计算经过时间的文章。

# unit-testing - 如何使用 Mocks 避免重复逻辑

> ID：643410
> 
> 赞同：7
> 
> 时间：2009-03-13T16:03:06.123
> 
> 标签：unit-testing, mocking, code-duplication

我有以下挑战，我还没有找到一个好的答案。我正在使用 Mocking 框架（在本例中为 JMock）来允许将单元测试与数据库代码隔离开来。我正在模拟对涉及数据库逻辑的类的访问，并使用 DBUnit 单独测试数据库类。

我遇到的问题是，我注意到逻辑在概念上在多个地方重复的模式。例如，我需要检测数据库中的某个值不存在，因此在这种情况下我可能会从方法中返回 null。所以我有一个数据库访问类，它进行数据库交互，并适当地返回 null。然后我有一个业务逻辑类，它从模拟中接收 null，然后在值为 null 时进行测试以适当地采取行动。

现在，如果将来该行为需要更改并且返回 null 不再合适，比如说因为状态变得更加复杂，所以我需要返回一个报告该值不存在的对象以及来自的一些附加事实数据库。

现在，如果我将数据库类的行为更改为在这种情况下不再返回 null，那么业务逻辑类似乎仍然可以正常工作，并且该错误只会在 QA 中发现，除非有人记得耦合，或者正确地遵循了方法的用途。

我觉得我错过了一些东西，必须有一种更好的方法来避免这种概念上的重复，或者至少对其进行测试，以便如果它发生变化，那么没有传播变化的事实会使单元测试失败。

有什么建议么？

更新：

让我试着澄清我的问题。我正在考虑代码何时随时间演变，如何确保通过模拟测试的类和模拟所代表的类的实际实现之间的集成不会中断。

例如，我刚刚有一个案例，我有一个最初创建的方法并且不期望 null 值，所以这不是对真实对象的测试。然后，该类的用户（通过模拟测试）得到增强，可以在某些情况下将 null 作为参数传递。在集成中断时，因为未对真实类进行空值测试。现在，在开始构建这些类时，这没什么大不了的，因为您在构建时正在测试两端，但是如果设计需要在两个月后发展，而您往往会忘记细节，那么您将如何测试它们之间的交互这两组对象（通过模拟测试与实际实现测试的对象）？

潜在的问题似乎是重复之一（即违反 DRY 原则），期望确实保留在两个地方，虽然关系是概念上的，但没有实际的重复代码。

[在 Aaron Digulla 对他的回答进行第二次编辑后编辑]：

对，这正是我正在做的事情（除了在通过 DBUnit 测试并在测试期间与数据库交互的类中与 DB 有一些进一步的交互，但这是相同的想法）。所以现在，假设我们需要修改数据库行为以使结果不同。使用模拟的测试将继续通过，除非 1）有人记得或 2）它在集成中中断。所以数据库的存储过程返回值（比如）在模拟的测试数据中本质上是重复的。现在让我困扰的是重复的逻辑是重复的，这是对 DRY 的微妙违反。可能就是这样（毕竟集成测试是有原因的），但我觉得我错过了一些东西。

[编辑开始赏金]

阅读与 Aaron 的互动就可以找到问题的重点，但我真正想要的是一些关于如何避免或管理明显重复的见解，以便真实班级行为的变化将出现在与 mock 交互的单元测试是有问题的。显然这不会自动发生，但可能有一种方法可以正确设计场景。

[关于奖励赏金的编辑]

感谢所有花时间回答问题的人。获胜者教会了我一些关于如何考虑在两层之间传递数据的新知识，并首先得到了答案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-08T17:43:03.640

你从根本上要求不可能的事。当您更改外部资源的行为时，您要求您的单元测试预测并通知您。如果不编写测试来产生新的行为，他们怎么知道？

您所描述的是添加一个必须测试的全新状态 - 而不是空结果，现在有一些对象从数据库中出来。你的测试套件怎么可能知道被测对象的预期行为对于一些新的随机对象应该是什么？你需要编写一个新的测试。

正如您评论的那样，模拟不是“行为不端”。模拟正在做你设置它做的事情。规范更改的事实对模拟没有影响。在这种情况下，唯一的问题是实施更改的人忘记更新单元测试。实际上，我不太确定您为什么认为存在任何重复的担忧。

向系统添加一些新的返回结果的编码器负责添加单元测试来处理这种情况。如果该代码也 100% 确定现在*不可能*返回 null 结果，那么他也可以删除旧的单元测试。但你为什么要？单元测试正确地描述了被测对象在收到空结果时的行为。如果您将系统的后端更改为某个返回 null 的新数据库，会发生什么情况？如果规范改回返回 null 怎么办？您不妨保留测试，因为就您的对象而言，它确实可以从外部资源中获取任何东西，并且它应该优雅地处理所有可能的情况。

模拟的全部目的是将您的测试与真实资源分离。它不会自动使您免于将错误引入系统。如果您的单元测试准确地描述了收到 null 时的行为，那就太好了！但是这个测试不应该知道任何其他状态，当然也不应该以某种方式被告知外部资源将不再发送空值。

如果你在做正确的、松耦合的设计，你的系统可以有你能想象到的任何后端。您不应该只考虑一种外部资源来编写测试。如果您添加一些使用真实数据库的集成测试，从而消除模拟层，听起来您可能会更开心。这对于进行构建或健全性/烟雾测试总是一个好主意，但通常会阻碍日常开发。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-08T22:22:39.537

你不会在这里错过任何东西。这是使用模拟对象进行单元测试的一个弱点。听起来您正在正确地将单元测试分解为合理大小的单元。这是一件好事；在“单元”测试中发现人们测试过多的情况更为常见。

不幸的是，当您在这种粒度级别进行测试时，您的单元测试不会涵盖协作对象之间的交互。您需要进行一些集成测试或功能测试来涵盖这一点。我真的不知道比这更好的答案了。

有时在单元测试中使用真正的协作者而不是模拟是很实际的。例如，如果您正在对数据访问对象进行单元测试，那么在单元测试中使用真实的域对象而不是模拟通常很容易设置并执行得一样好。反过来往往不正确——数据访问对象通常需要数据库连接、文件或网络连接，而且设置起来非常复杂且耗时；在对域对象进行单元测试时使用真实的数据对象会将需要几微秒的单元测试变成需要数百或数千毫秒的单元测试。

所以总结一下：

1.  编写一些集成/功能测试来捕捉协作对象的问题
2.  并不总是需要嘲笑合作者——用你最好的判断

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-13T16:09:37.090

单元测试无法告诉您某个方法何时突然产生了一组较小的可能结果。这就是代码覆盖的用途：它会告诉您代码不再执行。这反过来又会导致在应用层中发现死代码。

[编辑] 基于评论：模拟不能做任何事情，只能允许实例化被测类并允许收集其他信息。特别是，它绝*不能*影响您要测试的结果。

[EDIT2] 模拟数据库意味着您不关心数据库驱动程序是否工作。您想知道的是您的代码是否可以正确解释数据库返回的数据。此外，这是测试您的错误处理是否正常工作的唯一方法，因为您无法告诉真正的 DB 驱动程序“当您看到此 SQL 时，抛出此错误”。这只能通过模拟来实现。

我同意，这需要一些时间来适应。这是我所做的：

*   我有检查 SQL 是否有效的测试。每个 SQL 都会针对静态测试数据库执行一次，我验证返回的数据是否符合我的预期。

*   所有其他测试都使用返回预定义结果的模拟数据库连接器运行。我喜欢通过对数据库运行代码，在某处记录主键来获得这些结果。然后，我编写了一个工具，它采用这些主键并将带有模拟的 Java 代码转储到 System.out。这样，我可以非常快速地创建新的测试用例，并且测试用例将反映“真相”。

    更好的是，我可以通过再次运行旧 ID 和我的工具来重新创建旧测试（当数据库更改时）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-12T15:11:18.640

您的数据库抽象使用 null 表示“未找到结果”。忽略在对象之间传递 null 是一个坏主意这一事实，当您的测试想要测试什么都没有找到时会发生什么时，不应使用该 null 文字。相反，请使用常量或[测试数据构建器](http://www.natpryce.com/articles/000714.html)，以便您的测试仅涉及对象之间传递的信息，而不涉及该信息的表示方式。然后，如果您需要更改数据库层表示“未找到结果”（或您的测试所依赖的任何信息）的方式，您在测试中只有一个地方可以更改它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-09T13:46:47.697

我想把问题缩小到它的核心。

## 问题

当然，您的大部分更改都会被测试捕获。
但是有一部分场景您的测试不会失败 - 尽管它应该：

在编写代码时，您会多次使用您的方法。您会得到方法定义和使用之间的 1:n 关系。每个使用该方法的类都将在相应的测试中使用它的模拟。所以mock也用了n次。

您的方法结果曾经被认为永远不会是`null`. 更改此设置后，您可能会记得修复相应的测试。到现在为止还挺好。

您运行您的测试 -**全部通过**。

**但是**随着时间的流逝，您忘记了一些东西……模拟永远不会返回`null`. 因此，使用模拟的 n 类的 n 测试不测试`null`.

你的**QA 会失败**——尽管你的测试没有失败。

显然，您将不得不修改其他测试。但是没有失败的工作。所以你需要一个比记住所有引用测试更好的解决方案。

## 一个办法

为避免此类问题，您必须从一开始就编写更好的测试。如果您错过了测试类应该处理错误或`null`值的情况，那么您只是有**不完整的测试**。这就像没有测试您班级的所有功能。

以后很难添加这个。- 所以尽早开始并进行广泛的测试。

正如其他用户所提到的 - 代码覆盖率揭示了一些未经测试的案例。但是缺少错误处理代码*和*缺少根据测试不会出现在代码覆盖率中。*（100% 的代码覆盖率并不意味着你没有遗漏任何东西。）*

所以写好测试：**假设外界是恶意的。**这不仅包括**传递错误的参数**（如`null`值）。**你的模拟也是外部世界的一部分。**通过`null`s 和异常 - 并观察您的班级按预期处理它们。

如果您决定`null`成为一个有效值 - 这些测试稍后将失败（因为缺少异常）。所以你会得到一个失败的列表。

*因为每个调用类处理错误或`null`不同 - 这不是可以避免的重复代码。不同的治疗需要不同的测试。*

* * *

**提示：**保持你的模拟简单和干净。将预期的返回值移动到测试方法。（您的模拟可以简单地将它们传递回去。）避免在模拟中测试决策。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-12T21:30:36.523

我是这样理解你的问题的：

*您正在使用实体的模拟对象来使用 JMock 测试应用程序的业务层。您还在使用 DBUnit 测试您的 DAO 层（您的应用程序和数据库之间的接口），并传递填充了一组已知值的实体对象的真实副本。因为您使用 2 种不同的方法来准备测试对象，所以您的代码违反了 DRY，并且您的测试可能会随着代码的更改而与现实不同步。*

**福尔说……**

它不完全相同，但它确实让我想起了 Martin Fowler 的[Mocks Aren't Stubs](http://martinfowler.com/articles/mocksArentStubs.html)文章。我认为 JMock 路线是*模拟*方式，而“真实对象”路线是执行测试的*古典主义*方式。

在解决这个问题时尽可能保持 DRY 的一种方法是成为一个*古典主义者*而不是一个*模仿者*。也许您可以在测试中妥协并使用您的 bean 对象的真实副本。

**用户制造商避免重复**

我们在一个项目上所做的是为我们的每个业务对象创建*Maker*。maker 包含静态方法，这些方法将构造给定实体对象的副本，并填充已知值。然后，无论您需要哪种对象，您都可以调用该对象的制造商并获取其具有已知值的副本以用于您的测试。如果该对象有子对象，您的 maker 将为子对象调用 makers 以便从上到下构造它，您将根据需要获得尽可能多的完整对象图。您可以将这些 maker 对象用于所有测试——在测试 DAO 层时将它们传递给数据库，并在测试业务服务时将它们传递给服务调用。因为制造商是可重复使用的，所以它是一种相当干燥的方法。

然而，您仍然需要使用 JMock 的一件事是在测试您的服务层时模拟您的 DAO 层。如果你的服务调用 DAO，你应该确保它被注入了一个模拟。但是你仍然可以使用你的 Maker —— 在设置你的期望时，只要确保你的模拟 DAO 使用相关实体对象的 Maker 传回期望的结果。这样我们仍然没有违反 DRY。

**编写良好的测试会在代码更改时通知您**

为了避免您的代码随时间变化而出现的问题，我的最后建议是*始终*进行针对空输入的测试。假设当您第一次创建方法时，null 是不可接受的。如果使用 null，您应该有一个测试来验证是否引发了异常。如果稍后可以接受空值，您的应用程序代码可能会更改，以便以新的方式处理空值，并且不再引发异常。发生这种情况时，您的测试将开始失败，并且您将“提醒”事情不同步。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-13T11:29:52.423

您只需决定返回 null 是外部 API 的预期部分还是实现细节。

单元测试不应该关心实现细节。

如果它是您预期的外部 API 的一部分，那么由于您的更改可能会破坏客户端，这自然也应该破坏单元测试。

从外部 POV 来看，这个东西返回 NULL 是否有意义，或者这是一个方便的结果，因为可以在客户端中直接假设这个 NULL 的含义？NULL 应该意味着 void/nix/nada/unavailable 没有任何其他含义。

如果您打算稍后细化此条件，则应将 NULL 检查包装到返回信息异常、枚举或显式命名的布尔值的内容中。

编写单元测试的一个挑战是，即使是第一个编写的单元测试也应该反映最终产品中的完整 API。您需要可视化完整的 API，然后针对它进行编程。

此外，您需要在单元测试代码中保持与在生产代码中相同的纪律，避免重复和功能嫉妒之类的气味。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-13T16:23:55.870

对于特定场景，您正在更改方法的返回类型，这将在编译时被捕获。如果没有，它将出现在代码覆盖率上（如 Aaron 所述）。即使这样，您也应该进行自动化功能测试，这些测试将在签入后不久运行。也就是说，我进行了自动烟雾测试，所以在我的情况下，那些会发现:)。

如果不考虑上述情况，您仍然有两个重要因素在初始场景中发挥作用。您希望对单元测试代码给予与其他代码相同的关注，这意味着保持它们 DRY 是合理的。如果你在做 TDD，那甚至会把这个问题放在你的设计上。如果您对此不感兴趣，则涉及的另一个相反因素是 YAGNI，您不希望在代码中出现所有（不）可能的情况。所以，对我来说，它会是：如果我的测试告诉我我遗漏了一些东西，我会仔细检查测试是否正常并继续进行更改。我确保不要在我的测试中做假设场景，因为这是一个陷阱。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-13T14:42:24.247

如果我正确理解了这个问题，那么您有一个使用模型的业务对象。有一个测试 BO 和 Model 的交互（Test A），还有一个测试 Model 和数据库的交互（Test B）。测试 B 更改为返回一个对象，但该更改不会影响测试 A，因为测试 A 的模型是模拟的。

当测试 B 更改时，我看到使测试 A 失败的唯一方法是不在测试 A 中模拟模型并将两者组合成一个测试，这不好，因为你会测试太多（而且你使用不同的框架）。

如果您在编写测试时知道这种依赖关系，我认为一个可接受的解决方案是在每个测试中留下评论，描述依赖关系以及如果一个更改，您需要更改另一个。无论如何，您必须在重构时更改测试 B，一旦您进行更改，当前测试就会失败。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-05-08T14:03:22.357

您的问题非常令人困惑，并且文本的数量并没有帮助。

但是我可以通过快速阅读来提取的含义对我来说意义不大，因为您希望非合同更改更改会影响模拟的工作方式。

模拟是让您专注于测试系统特定部分的推动力。模拟部分将始终以指定的方式工作，并且测试可以专注于测试它应该测试的特定逻辑。因此，您不会受到无关逻辑、延迟问题、意外数据等的影响。

您可能会有不同数量的测试在另一个上下文中检查模拟功能。

关键是，模拟接口和实际实现之间根本不应该存在任何联系。它只是没有任何意义，因为你在嘲笑合同并给它一个你自己的实现。

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2009-05-08T21:51:10.487

我认为您的问题违反了 Liskov 替换原则：

*子类型必须可以替代它们的基本类型*

理想情况下，您将拥有一个依赖于抽象的类。一个抽象说“为了能够工作，我需要这个方法的实现，它接受这个参数，返回这个结果，如果我做错了，就会抛出这个异常”。这些都将在您所依赖的接口上定义，无论是通过编译时间限制还是通过注释。

从技术上讲，您似乎依赖于抽象，但在您所说的场景中，您并不真正依赖抽象，您实际上依赖于实现。你说“如果这个方法改变了它的行为，它的用户就会崩溃，我的测试永远不会知道”。在单元测试级别上，您是对的。但在合约层面，以这种方式改变行为是错误的。因为通过更改方法，您显然违反了方法与其调用者之间的约定。

为什么要改变方法？很明显，该方法的调用者现在需要不同的行为。因此，您要做的第一件事不是更改方法本身，而是更改您的客户所依赖的抽象或合同。他们必须先改变并开始使用新合同：“好的，我的需求改变了，我不再希望这个方法在这个特定的场景中返回那个，这个接口的实现者必须返回这个”。所以，你去改变你的界面，你去根据需要改变界面的用户，这包括更新他们的测试，你做的最后一件事就是改变你传递给客户的实际实现。这样，您就不会遇到您所说的错误。

所以，

```
class NeedsWork(IWorker b) { DoSth() { b.Work() }; }
...
AppBuilder() { INeedWork GetA() { return new NeedsWork(new Worker()); } } 
```

1.  修改 IWorker，使其反映 NeedsWork 的新需求。
2.  修改 DoSth 使其与满足其新需求的新抽象一起工作。
3.  测试 NeedsWork 并确保它适用于新行为。
4.  更改您为 IWorker 提供的所有实现（在此场景中为 Worker）（您现在首先尝试这样做）。
5.  测试工作者，使其满足新的期望。

看起来很可怕，但在现实生活中，这对于微小的变化来说是微不足道的，而对于巨大的变化来说是痛苦的，事实上，它必须如此。

# c++ - 将字符串（字符）发送到活动窗口

> ID：643413
> 
> 赞同：2
> 
> 时间：2009-03-13T16:03:31.347
> 
> 标签：c++, c, x11, keyboard-events

我编写了一个简单的程序，它从串行端口（/dev/ttyS1）读取外部设备（条形码扫描仪）的字符并将其提供给当前活动的窗口（使用 XSendEvent）。

程序在速度较快的计算机上运行良好，但在速度较慢的计算机上，情况会发生（经常），字符的接收顺序与发送的顺序不同。例如，scanner 发送 1234567 到串口，我的程序发送 char 事件 1234567，但是活动程序（例如 xterm）收到 3127456。我尝试在各个地方调用 XSync 并添加*usleep*调用，但没有帮助。

有谁知道如何强制角色的“顺序”？

还是有其他方法可以将字符串发送到活动窗口（如果需要，我什至不介意使用外部程序）？

这是代码，也许我只是做错了什么：

```
#include <stdio.h>
#include <stdlib.h>
#include <termios.h>
#include <unistd.h>
#include <errno.h>
#include <sys/types.h>  // serial port stuff
#include <sys/stat.h>
#include <string.h>
#include <fcntl.h>
#include <X11/Xlib.h>

/*
    BarCode KeyboardFeeder: BCKF
    Copyright (c) Milan Babuskov
    Licence: GNU General Public Licence

    Compile with: g++ bckf.cpp -lX11 -L /usr/X11R6/lib/ -o bckf
    Keycodes:  /usr/X11R6/include/X11/keysymdef.h
*/
//-----------------------------------------------------------------------------
void SendEvent(XKeyEvent *event, bool press)
{
    if (press)
        XSendEvent(event->display, event->window, True, KeyPressMask, (XEvent *)event);
    else
        XSendEvent(event->display, event->window, True, KeyReleaseMask, (XEvent *)event);
    XSync(event->display, False);
}
//-----------------------------------------------------------------------------
bool sendChar(int c)
{
    if (c >= 0x08 && c <= 0x1b)     // send CR twice
    {
        sendChar(0xff0d);
        c = 0xff0d;
    }

    printf("Sending char : 0x%02x\n", c);
    char disp[] = ":0";
    char *dp = getenv("DISPLAY");
    if (!dp)
        dp = disp;
    else
        printf("Using env.variable $DISPLAY = %s.\n", dp);
    Display *dpy = XOpenDisplay(dp);
    if (dpy == NULL)
    {
        printf("ERROR! Couldn't connect to display %s.\n", dp);
        return false;
    }
    else
    {
        Window cur_focus;   // focused window
        int revert_to;      // focus state
        XGetInputFocus(dpy, &cur_focus, &revert_to);    // get window with focus
        if (cur_focus == None)
        {
            printf("WARNING! No window is focused\n");
            return true;
        }
        else
        {
            XKeyEvent event;
            event.display = dpy;
            event.window = cur_focus;
            event.root = RootWindow(event.display, DefaultScreen(event.display));
            event.subwindow = None;
            event.time = CurrentTime;
            event.x = 1;
            event.y = 1;
            event.x_root = 1;
            event.y_root = 1;
            event.same_screen = True;
            event.type = KeyPress;
            event.state = 0;
            event.keycode = XKeysymToKeycode(dpy, c);
            SendEvent(&event, true);
            event.type = KeyRelease;
            SendEvent(&event, false);
        }
        XCloseDisplay(dpy);
    }

    usleep(20);
    return true;
}
//-----------------------------------------------------------------------------
// Forward declaration
int InitComPort(const char *port);
//-----------------------------------------------------------------------------
int main(int argc, char **argv)
{
    if (argc != 2)
    {
        printf("Usage: bckf serial_port\n");
        return 1;
    }

    int port = InitComPort(argv[1]);
    if (port == -1)
        return 1;

    while (true)
    {
        char buf[30];
        ssize_t res = read(port, buf, 30);
        if (res > 0)
        {
            for (ssize_t i=0; i<res; ++i)
            {
                int c = buf[i];
                printf("Received char: 0x%02x\n", c);
                if (c >= '0' && c <= '9' || c >= 0x08 && c <= 0x1b)
                    if (!sendChar(c))   // called from console?
                        break;
            }
        }
    }
    return 0;
}
//-----------------------------------------------------------------------------
int InitComPort(const char *port)
{
    int c, res;
    struct termios newtio;
    struct termios oldtio;

    // Open modem device for reading and writing and not as controlling tty
    // because we don't want to get killed if linenoise sends CTRL-C.
    int fdSerial = open(port, O_RDWR | O_NOCTTY );
    if (fdSerial < 0)
    {
        printf(0, "Error opening port: %s\n%s", port, strerror(errno));
        return -1;
    }

    tcgetattr(fdSerial,&oldtio); // save current port settings
    memset(&newtio, 0, sizeof(newtio));
    newtio.c_cflag = B9600 | CS8 | CLOCAL | CREAD;                  // CREAD   : enable receiving characters
                                                                    // CS8     : character size 8
                                                                    // CLOCAL  : Ignore modem control lines
    newtio.c_iflag = IGNPAR;                                        // IGNPAR  : ignore bytes with parity errors
    newtio.c_oflag = 0;                                             // 0       : raw output (no echo, non-canonical)
    //newtio.c_cc[VTIME]    = timeout;                              // 10=1sec : inter-character timer (deciseconds)
    newtio.c_cc[VMIN]     = 1;                                      // 50      : blocking read until 50 chars received
    tcflush(fdSerial, TCIOFLUSH);                                   // clear the line and...
    tcsetattr(fdSerial,TCSANOW,&newtio);                            // ...activate new settings for the port
    return fdSerial;
}
//----------------------------------------------------------------------------- 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T19:33:48.800

您的代码中的问题是您每次都使用 XOpenDisplay(...) 打开显示。每次调用 XOpenDisplay 都会创建一个新的协议上下文。您应该只打开一次显示，并且在发送事件时始终使用相同的显示句柄。在单个显示句柄的上下文中，事件保证保持有序。

在开始调用 sendChar(...) 之前初始化一次显示，例如在 main(...) 中，并始终使用相同的 Display 指针。仅在完成后关闭显示，就像使用 Com 端口一样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T16:08:10.823

您是否尝试强制时间戳每增加一？这应该告诉 X 服务器事件是随时间传播的，但这也意味着它会使您的扫描仪成为大约 142 次扫描/秒的瓶颈。不过，这听起来不错，假设人类参与了它的使用。

# asp.net - CSS 友好控制适配器导致安全错误？

> ID：643414
> 
> 赞同：0
> 
> 时间：2009-03-13T16:03:40.130
> 
> 标签：asp.net, css, visual-studio-2008, security, configuration

我刚刚添加了对 CSS 友好控制适配器 dll 的引用，并将以下文件 (CSSFriendlyAdapters.browser) 添加到我的“App_Browsers”文件夹中：

```
<browsers>
  <browser refID="Default">
    <controlAdapters>
      <adapter controlType="System.Web.UI.WebControls.TreeView"
               adapterType="CSSFriendly.TreeViewAdapter" />
    </controlAdapters>
  </browser>

  <browser id="W3C_Validator" parentID="default">
    <identification>
      <userAgent match="^W3C_Validator" />
    </identification>
    <capabilities>
      <capability name="browser"              value="W3C Validator" />
      <capability name="ecmaScriptVersion"    value="1.2" />
      <capability name="javascript"           value="true" />
      <capability name="supportsCss"          value="true" />
      <capability name="supportsCallback"     value="true" />
      <capability name="tables"               value="true" />
      <capability name="tagWriter"            value="System.Web.UI.HtmlTextWriter" />
      <capability name="w3cdomversion"        value="1.0" />
    </capabilities>
  </browser>
</browsers> 
```

现在，当我尝试运行网站的任何部分时，我收到以下错误：

*   应用程序试图执行安全策略不允许的操作。要授予此应用程序所需的权限，请联系您的系统管理员或在配置文件中更改应用程序的信任级别。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T16:17:03.563

看看这个[链接](http://cssfriendly.codeplex.com/Thread/View.aspx?ThreadId=19533)

唯一的解决方法是删除 web.config 中的所有信任级别设置

# jquery - Jquery onclick ids 不适用于从 ajax 请求返回的 ids

> ID：643418
> 
> 赞同：0
> 
> 时间：2009-03-13T16:04:37.990
> 
> 标签：jquery, ajax

我有用于图像悬停的 document.ready 功能。

当`sign_up_close`文档中存在图像 ID 时，悬停正在工作。如果相同的 id 来自 AJAX 请求，则悬停在 JQuery 中不起作用。

请给出一个解决方案，我有很多这样的功能可以处理 AJAX 请求。AJAX 请求与 ID 为 sign_up_close 的图像一起提供。

```
$(document).ready(function(){
    $("img#sign_up_close").hover(function(){
        $("img#sign_up_close").attr("src","images/buttons/btn_type1_23_close_pp_icon_.gif");
    },function(){
        $("img#sign_up_close").attr("src","images/buttons/btn_type1_23_close_pp_icon.gif");
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-17T17:55:05.033

如果 Paolo Bergantino 是正确的，另一个可行的选择是使用 Jquery 的 LiveQuery。

可以在[http://docs.jquery.com/Plugins/livequery找到文档](http://docs.jquery.com/Plugins/livequery)

您的代码可能看起来像这样：

```
$(document).ready(function(){
        $("img#sign_up_close").livequery(function() {
            $(this).hover(function() {
                $("img#sign_up_close").attr("src","images/buttons/btn_type1_23_close_pp_icon_.gif");
            }, function() { 
                $("img#sign_up_close").attr("src","images/buttons/btn_type1_23_close_pp_icon.gif");
            });
        });
}); 
```

# python - 如何在 Eclipse 中自动填充段落？

> ID：643422
> 
> 赞同：2
> 
> 时间：2009-03-13T16:05:51.937
> 
> 标签：python, eclipse, formatting, word-wrap

我想在 Eclipse 中将一个段落自动填充为 80 个字符（或其他一些固定宽度）。这可以通过 Emacs 中的键盘命令实现吗？或者是否有插件（我在谷歌上没有找到任何东西）？

编辑：我不确定这是否相关，但我需要 Python 代码中的文档字符串（使用 PyDev 插件）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-01-06T22:31:20.867

[您可以使用 Ctrl+2+w 将段落包装在 Pydev 中（请参阅 Pydev 键绑定： http](http://pydev.org/manual_adv_keybindings.html) ://pydev.org/manual_adv_keybindings.html ）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T16:08:40.463

突出显示文本，然后按 Ctrl-Shift-F，或打开上下文菜单并选择 Source / Format。

# word-processor - 你用什么文字处理器来处理技术论文？

> ID：643427
> 
> 赞同：6
> 
> 时间：2009-03-13T16:06:33.667
> 
> 标签：word-processor

我一直在寻找用于撰写技术论文的文字处理器，但我还没有真正找到。拥有一个可以很好地处理数学表达式、代码和伪代码的编辑器真的很棒。我还没有找到一个效果很好的。

有人有什么建议吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-03-13T16:07:50.980

我个人相信 LaTeX。好处：

*   您可以专注于内容而不是形式。
*   使用逻辑而不是语义格式（例如，\methodname 与仅斜体）。
*   更容易从多个文件组装大型文档。
*   使用基于文本的版本控制（CVS/SVN/等）
*   被广泛使用的
*   即使在超弱机器上也更加稳定
*   可编程的。例如，我使用宏来隐藏内容、突出显示内容、混淆名称，方法是使用具有真实名称但经过混淆替换的宏名称。
*   查看 SO 上可用的所有提示和技巧。
*   无论您在哪个平台上编译，输出看起来都是一样的。从来没有这样的运气，每个版本和每台机器都会产生一些稍微不同的东西。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-13T16:21:26.890

我的答案很长，所以我想提前说：我认为您想要 OpenOffice Writer（我使用 v2.4，尚未尝试 3.0）。

我过去大量使用 Word 和公式编辑器和 LaTeX，最近使用 OpenOffice Writer。我在写论文时使用了前两个。

LaTeX 在输出质量和使用基于文本的版本控制的能力方面可能仍然具有优势，但在这一点上它们被 OO Writer 大大削弱了。

带有方程式编辑器的微软，即使是最新版本，似乎仍然很弱。

我喜欢 OpenOffice 的地方在于，您可以在窗口在您正在编写的文档和您可以键入非常类似于 LaTeX 的格式说明的另一个区域之间拆分的模式下使用公式格式设置机制。LaTeX的一*大* 优势是你可以输入类似 $x \in S$ 的东西来表示“x 是 S 的一个元素”。OO Writer 允许您执行此操作*并*查看结果。

回到我写论文的时候，LaTeX 比 Word with Eqn 更可取。编辑因为我的文档的长度（超过 200 页）、结果的质量以及指定方程式的容易程度。LaTeX 在使用简单方面确实有一个缺点，OO Writer 使这个缺点更加突出。

也就是说，我确信我会使用 OO Writer 来编写会议到期刊长度的文章（~8-15 页对 ~15-40 页）以及更短的工作。对于论文长度的工作，我不确定我最终会使用哪个：Word 在更长的问题上对我来说从来没有这么好过；我怀疑 OO Writer 表现得更好，但我没有足够的经验来做出坚定的判断。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-13T16:09:38.667

我喜欢 LyX（[http://www.lyx.org/](http://www.lyx.org/)）——它是“花费所有时间编写文档”和“花费所有时间编写标记”之间的一个很好的权衡。最新版本甚至可以使用！

除此之外，如果您使用样式和其他“高级”功能，Word 2008 实际上相当不错。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-13T16:22:58.820

我完全同意 L ^A T [E] X 是一个不错的选择。我在大学里用过论文，包括我的硕士论文。对于 L ^A T [E] X，我一直在使用[Kile](http://kile.sourceforge.net/)。

但现在有一个有趣的替代方案，即带有[MathML 扩展的](http://www.docbook.org/schemas/mathml.html)[DocBook](http://www.docbook.org/whatis)。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-13T16:11:58.830

LaTeX 和[TexMaker](http://www.xm1math.net/texmaker/index.html)让我读完了研究生。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-13T16:09:44.110

取决于您所说的“文字处理器”是什么意思。如果你不介意没有所见即所得的界面，我推荐 LaTeX ( [http://www.latex-project.org/](http://www.latex-project.org/) )。

我用它写了我最后一年的硕士论文，其中包含很多伪代码、公式等。还以相当典型的技术论文格式输出。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-13T16:18:12.577

我使用[FrameMaker](http://www.adobe.com/products/framemaker/)。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-13T16:35:57.293

[带有Mathtype](http://www.dessci.com/en/products/mathtype/)的MS Word 。与默认公式编辑器相比，它具有许多优点，包括但不限于：

*   键盘快捷键
*   在tex模式下写方程然后转换它们
*   将方程式从“正常”模式转换为“线性”模式（您可以在程序中使用的模式，您知道 a=b/c 等）
*   模板
*   没有更多的乳胶。我可以专注于材料，而不是写作

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-13T16:10:20.847

数学部分的带有 MS 方程的单词。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-13T16:51:59.423

我喜欢[DocBook](http://www.docbook.org/)并使用[FOP](http://xmlgraphics.apache.org/fop/)从中创建 PDF。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-13T17:16:44.463

我使用[reStructuredText](http://docutils.sourceforge.net/rst.html)是因为它可以在[Trac](http://trac.edgewall.org/)中使用，转换为 PDF 和 HTML，标记开销很小，而且它的普通形式也很漂亮。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-22T18:47:51.233

Microsoft Word 被认为是市场标准的文字编辑器。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-04-14T17:10:56.900

我的建议是让你使用[Authorea](https://authorea.com)。

作为前博士后（天体物理学）和博士。（信息学）拥有 12 年以上的研究经验（哈佛、欧洲核子研究中心、加州大学洛杉矶分校），我长期撰写技术论文。我又爱又恨 LaTeX。在过去的 2 年中，我与朋友和同事一起开发了下一代协作编写技术/研究文档的平台。它被称为 Authorea。从技术角度来看，Authorea 是基于 Git 构建的，并采用 LaTeX、Markdown、HTML（甚至 JS，以在您的论文中包含花哨的 d3.js）。奖励：您不需要了解 LaTeX（或任何其他格式），但您可以轻松地将方程式、表格、引文和数据添加到您的论文中。我希望你会发现它有用。

# wpf - 基于 PresentationFramework.Aero 覆盖 WPF TextBox 中的默认样式

> ID：643440
> 
> 赞同：31
> 
> 时间：2009-03-13T16:08:42.130
> 
> 标签：wpf, resources, aero

我想使用 Aero 文本框样式，但仍会覆盖一些属性。我尝试通过以下方式完成此操作：

```
<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="/PresentationFramework.Aero, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, ProcessorArchitecture=MSIL;component/themes/aero.normalcolor.xaml" />
    </ResourceDictionary.MergedDictionaries>

    <Style x:Key="{x:Type TextBox}" TargetType="{x:Type TextBox}" BasedOn="{StaticResource {x:Type TextBox}}">
        <Setter Property="Margin" Value="2" />
        <Setter Property="Padding" Value="2" />
    </Style>
</ResourceDictionary> 
```

但是，这会导致`StackOverflowException`启动我的应用程序时出现错误。当我删除对 PresentationFramework.Aero 的引用时，这可行，但我得到了默认的操作系统样式，这使应用程序变得丑陋。;)

因此，实际上：如果我想在所有文本框上覆盖某些样式，我将无法获得 Aero 外观。如果我想要 Aero 外观，我无法覆盖任何样式。僵局。

有什么办法可以解决这个问题？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-03-13T17:18:09.530

如果你把它`Style`作为一个较低级别的资源，而不是在同一个 ResourceDictionary 中，它似乎可以工作：

```
<Grid xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <Grid.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/PresentationFramework.Aero, Version=3.0.0.0, Culture=Neutral, PublicKeyToken=31bf3856ad364e35, ProcessorArchitecture=MSIL;component/themes/aero.normalcolor.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Grid.Resources>
    <Border BorderBrush="Blue" BorderThickness="3">
        <Border.Resources>
            <Style TargetType="{x:Type TextBox}" BasedOn="{StaticResource {x:Type TextBox}}">
                <Setter Property="Margin" Value="2" />
                <Setter Property="Padding" Value="2" />
            </Style>
        </Border.Resources>
        <TextBox />
    </Border>
</Grid> 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2011-02-13T21:42:57.373

与已接受答案中的代码不同，此代码允许将资源字典用于样式。无耻地从[http://social.msdn.microsoft.com/forums/en-US/wpf/thread/3c66adb7-fd26-40c7-8404-85f6fefbd392/偷来，由](http://social.msdn.microsoft.com/forums/en-US/wpf/thread/3c66adb7-fd26-40c7-8404-85f6fefbd392/)*Vivien Ruitz*回答

 *```
<!--App.xaml-->
        <ResourceDictionary.MergedDictionaries> 
            <ResourceDictionary Source="/MyAppli;component/Resources/Themes/StyleDictionary.xaml"/>  
            <ResourceDictionary Source="/MyAppli;component/Resources/Themes/ApplyStyleDictionary.xaml"/>  
            ...  
        </ResourceDictionary.MergedDictionaries> 

<!--StyleDictionary.xaml-->
        <ResourceDictionary.MergedDictionaries> 
            <ResourceDictionary Source="/PresentationFramework.Aero;V3.0.0.0;31bf3856ad364e35;component/themes/aero.normalcolor.xaml" /> 
        </ResourceDictionary.MergedDictionaries> 
        <Style x:Key="ButtonStyleToApply" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}" > 
            ...  <!--Extend the aero style here-->
        </Style> 

<!--ApplyStyleDictionary.xaml-->
        <Style TargetType="Button" BasedOn="{StaticResource ButtonStyleToApply}"/> 
```

# security - 您猜出可能生成的 GUID 有多容易？

> ID：643445
> 
> 赞同：27
> 
> 时间：2009-03-13T16:09:38.540
> 
> 标签：security, session, guid

GUID 经常用于为 Web 应用程序创建会话密钥。我一直想知道这种做法的安全性。由于 GUID 是根据来自机器的信息、时间以及其他一些因素生成的，因此很难猜测未来可能出现的 GUID。假设您启动了 1000 个或 10000 个新会话，以获得正在生成的 GUID 的良好数据集。这是否会使生成可能用于另一个会话的 GUID 变得更容易。您甚至不必猜测特定的 GUID，只需继续尝试可能在特定时间段内生成的 GUID。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-13T16:13:50.403

[这是来自维基百科](https://en.wikipedia.org/wiki/Globally_unique_identifier#Algorithm)的一些东西（[原始来源](https://web.archive.org/web/20120607034312/http://www.gotdotnet.ru/blogs/denish/1965)）：

> 包含 MAC 地址和时间的 V1 GUID 可以通过第三组数字的第一个位置的数字“1”来标识，例如 {2f1e4fc0-81fd-11da-9156-00036a0f876a}。

据我了解，他们并没有真正隐藏它。

> V4 GUID 使用后一种算法，它是一个伪随机数。它们在相同的位置有一个“4”，例如 {38a52be4-9352-453e-af97-5c3b448652f0}。更具体地说，“data3”位模式在第一种情况下为 0001xxxxxxxxxxxx，在第二种情况下为 0100xxxxxxxxxxxx。WinAPI GUID 生成器的密码分析表明，由于 V4 GUID 的序列是伪随机的，给定初始状态，可以预测函数 UuidCreate [1](https://en.wikipedia.org/wiki/Globally_unique_identifier#Algorithm)***返回的多达下 250 000 个 GUID***。**这就是为什么不应在密码学中使用 GUID，例如，作为随机密钥。**

 *** * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-13T16:26:53.773

GUIDs are guaranteed to be unique and that's about it. Not guaranteed to be be random or difficult to guess.

TO answer you question, at least for the V1 GUID generation algorithm if you know the algorithm, MAC address and the time of the creation you could probably generate a set of GUIDs one of which would be one that was actually generated. And the MAC address if it's a V1 GUID can be determined from sample GUIDs from the same machine.

Additional tidbit from wikipedia:

> The OSF-specified algorithm for generating new GUIDs has been widely criticized. In these (V1) GUIDs, the user's network card MAC address is used as a base for the last group of GUID digits, which means, for example, that a document can be tracked back to the computer that created it. This privacy hole was used when locating the creator of the Melissa worm. Most of the other digits are based on the time while generating the GUID.

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-03-13T16:22:18.057

.NET Web 应用程序调用 Guid.NewGuid() 来创建一个 GUID，然后最终调用[CoCreateGuid()](http://msdn.microsoft.com/en-us/library/ms688568(VS.85).aspx) COM 函数在堆栈更深的几个帧中。

从 MSDN 库：

> The **CoCreateGuid** function calls the RPC function **UuidCreate**, which creates a GUID, a globally unique 128-bit integer. Use the **CoCreateGuid** function when you need an absolutely unique number that you will use as a persistent identifier in a distributed environment.To a very high degree of certainty, this function returns a unique value – no other invocation, on the same or any other system (networked or not), should return the same value.

And if you check the page on [UuidCreate](http://UuidCreate):

> The **UuidCreate** function generates a **UUID** that cannot be traced to the ethernet/token ring address of the computer on which it was generated. It also cannot be associated with other **UUID**s created on the same computer.

The last contains sentence is the answer to your question. So I would say, it is pretty hard to guess unless there is a bug in Microsoft's implementation.

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-13T16:15:20.023

如果有人继续使用连续的 GUID 流访问服务器，那将更像是拒绝服务攻击。

有人猜测 GUID 的可能性几乎为零。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-13T16:14:08.280

依靠。如果 GUID 设置合理，例如使用加盐的安全哈希并且您有很多位，则很难。如果 GUID 短而明显，则说明它很弱。

由于这可能会产生服务器负载，您可能希望采取措施阻止某人创建 10000 个新会话。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-04-29T19:10:53.063

"GUIDs are guaranteed to be unique and that's about it". GUIDs are not garanteed to be unique. At least the ones generated by CoCreateGuid: "To a **very high degree of certainty**, this function returns a unique value – no other invocation, on the same or any other system (networked or not), **should** return the same value."

# scripting - 所有脚本都是用脚本语言编写的吗？

> ID：643448
> 
> 赞同：5
> 
> 时间：2009-03-13T16:10:12.330
> 
> 标签：scripting, programming-languages

我对脚本的概念感到困惑。

我可以说makefile是一种脚本吗？

是否有用 C 或 Java 编写的脚本？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-13T16:13:07.673

我会参考[维基百科](http://en.wikipedia.org/wiki/Scripting_language)的详细解释。

“脚本”通常是指在另一个程序的上下文中运行的一段代码或一组指令。它们通常不是独立的可执行软件。

Makefile 是由“make”或 MSBuild 等运行的脚本。

C 需要编译成可执行文件或库，因此用（标准）C 编写的程序通常不会被视为脚本。（有[例外](http://csl.sourceforge.net/csl.html)，但这不是使用 C 的正常方式。）

Java（尤其是 .net）有点不同。一个典型的 java 程序被编译并作为可执行文件运行，但这是一个灰色区域。可以对用 java 编写的“脚本”进行运行时编译并执行它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-13T16:13:19.047

在非常一般的意义上，术语“脚本”与部署并期望从词法表示运行的代码有关。一旦您编译代码并分发结果输出而不是代码，它就不再是“脚本”。

脚本的缩小和模糊不被认为是编译，结果仍然被认为是脚本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T16:12:44.617

这取决于您对脚本的定义。对我来说，脚本可以是您为小目的编写的任何小程序。它们通常是用解释性语言编写的。但是，没有什么能阻止您用编译语言编写小程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-13T22:27:31.580

是的，可以用 Java 编写脚本。我已经看过很多次了：
*）（这是对糟糕的意大利面条代码的讽刺）*

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-13T16:35:37.153

对我来说，脚本必须由一个**文件组成。** 并且该文件必须能够执行为其编写脚本的任务，而无需中间步骤。

所以这些就可以了：

```
bash backup_my_home_dir.sh
perl munge_some_text.pl
python download_url.py 
```

但这不符合条件，即使文件很小：

```
javac HandyUtility.java
java HandyUtility 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-13T16:38:21.997

“脚本”一词可以涵盖相当广泛的活动。示例是使用[命令式](http://en.wikipedia.org/wiki/Imperative_programming)解释语言（如 VBScript、Python）或 shell 脚本（如 csh 或 bash）进行编程，或者使用[声明性语言](http://en.wikipedia.org/wiki/Declarative_programming)（如 XSL、SQL 或 Erlang）来表达任务。

一些脚本语言属于称为*[域特定语言](http://en.wikipedia.org/wiki/Domain-specific_programming_language)*(DSL) 的类别。很好的 DSL 示例是“makefile”、许多其他类型的配置文件、SQL、XSL 等等。

你问的是相当主观的，一个人的脚本是另一个人的应用程序。如果您对脚本的解释意味着使用脚本语言不应该强迫用户遵循传统的编译 -> 链接 -> 运行周期，那么您可能会形成无法用 C 或 Java 编写“脚本”的观点。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-13T16:21:36.953

脚本基本上是几乎任何语言或 shell 的不可编译的文本文件，带有一个解释器，用于自动化您重复执行的某些过程或命令列表。脚本通常用于备份文件、编译例程、svn 提交、shell 初始化等，无止境。您可以使用可执行文件（完成安装等）的脚本做一百万零一件事，这简直是矫枉过正。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-13T22:24:19.857

我用 F# 编写脚本。最近的一个是小型数据加载器，用于接收一组数据，对其进行一些处理，然后将其转储到数据库中。约 40 行。不需要单独的编译步骤；我可以让 F# Interactive 直接运行它。

好处是我得到了一个功能强大的语言，它有一个很棒的 IDE 和所有的安全静态检查，而推理使它不像 Java 或 C# 那样冗长。

因此，这是一种提供相当不错的类型系统、编译和检查的语言，它没有被解释，但可以很好地用于脚本。

# delphi - 输出字符串不正确

> ID：643451
> 
> 赞同：0
> 
> 时间：2009-03-13T16:10:45.607
> 
> 标签：delphi

```
procedure TForm1.Button1Click( Sender: TObject );
var
    arrSize: array[ 0..255 ] of Char;
begin
    {same formating like in statusbar of Explorer}
    StrFormatByteSize( 70846, arrSize, Length( arrSize ) * Sizeof( arrSize) );
    Label1.Caption := 'Result: ' + arrSize;
end; 
```

StrFormatByteSize 要求 arrsize 为 PWideChar。

如何让结果在 Delphi 2009 中正确显示？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-13T16:34:24.503

这在 Delphi 2009 中运行良好：

```
procedure TForm1.Button1Click(Sender: TObject);
var
  Buff: UnicodeString;
  TheSize: Int64;
begin
  SetLength(Buff, 255);;
  TheSize := 1024768;
  StrFormatByteSizeW(TheSize, PWideChar(Buff), Length(Buff));
  Label1.Caption := Buff;
end; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T16:33:32.867

用 WideChar 数组替换 Char 数组，调用 StrFormatByteSizeW。

# memcached - 如何使用 capistrano 清除内存缓存？

> ID：643470
> 
> 赞同：7
> 
> 时间：2009-03-13T16:13:56.893
> 
> 标签：memcached, capistrano

我使用 capistrano 将我的应用程序部署到使用 memcache 的机器上。我希望 capistrano 在部署新版本的站点时清除内存缓存。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T16:31:33.653

[类似的东西？](http://github.com/engineyard/eycap/blob/35c69f12aa78b5ee6f99bd9c1b22980698076b1f/lib/eycap/recipes/memcached.rb)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-02-26T01:29:13.437

看看这个 GIST 解决了这个问题：[https ://gist.github.com/matthuhiggins/668744](https://gist.github.com/matthuhiggins/668744)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T16:16:22.237

不知道 capistrano，但你不能直接杀死 memcached 进程并生成一个新进程吗？也可能更好地消除碎片。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-06T20:56:22.597

Susan Potter 的这个看起来不错[https://gist.github.com/rays/154570](https://gist.github.com/rays/154570)

```
# 2007 Copyright Susan Potter <me at susanpotter dot net>
# You can read her software development rants at: http://geek.susanpotter.net
# Released under CreativeCommons-attribution-noncommercial-sharealike license:
# http://creativecommons.org/licenses/by-nc-sa/1.0/
namespace :memcached do
  desc "Restart the Memcache daemon"
  task :restart, :roles => :app do
    deploy.memcached.stop
    deploy.memcached.start
  end

  desc "Start the Memcache daemon"
  task :start, :roles => :app do
    invoke_command "memcached -P #{current_path}/log/memcached.pid  -d", :via => run_method
  end

  desc "Stop the Memcache daemon"
  task :stop, :roles => :app do
    pid_file = "#{current_path}/log/memcached.pid"
    invoke_command("killall -9 memcached", :via => run_method) if File.exist?(pid_file)
  end
end 
```

# oracle - Oracle：如何“稍后”运行存储过程

> ID：643475
> 
> 赞同：1
> 
> 时间：2009-03-13T16:14:47.483
> 
> 标签：oracle, plsql

我们有一个系统，允许用户将数据连接到数据库中，以设置用于在数据合并到主表之前更改数据的各种规则。例如，订单可能有一个规则，该规则根据客户的地址设置要使用的送货公司。

这最初旨在仅对正在加载的数据进行操作，因此它仅限于您可以从 select 语句中调用的函数。需要注意的重要一点是数据尚未在目标表中。

现在，我有一个需要更新到另一个表的项目（很好 - 我可以为此使用自治事务编译指示）。但是，我需要运行一些函数，这些函数需要在它们运行之前插入数据（即它们正在聚合数据）。

所以，我真的很想排队运行我的程序，直到一段时间后（它不依赖于时间）。

我如何在 Oracle 中做到这一点？当我只想做一些简单的事情时，大量的文档是相当庞大的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-13T20:13:07.347

```
BEGIN
  DBMS_SCHEDULER.create_job (
    job_name => 'daily_tasks_job',
    job_type              => 'STORED_PROCEDURE',
    job_action            => 'prc_daily_tasks',
  repeat_interval       => 'FREQ=DAILY; INTERVAL=1',
  enabled               => TRUE,
  comments              => 'Calls stored procedure once a day'
  );
END;

BEGIN
     DBMS_SCHEDULER.create_job(
    job_name        => 'SHELL_JOB',
    repeat_interval  => 'FREQ=DAILY; BYHOUR=2',
    job_type         => 'EXECUTABLE',
    job_action       => '/u01/app/oracle/admin/tools/shell_job.sh',
    enabled          => TRUE,
    comments         => 'Perform stuff'
);
END; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-13T16:28:41.647

对此的标准方法是使用 dbms_jobs 来安排调用该过程的作业。

如果有一些先决条件，作业可以检查先决条件。如果完成，则作业继续，否则重新安排自身并退出。

# perl - 我可以在 DBIx::Class 中建立“父母有_很多孙子”关系吗？

> ID：643476
> 
> 赞同：2
> 
> 时间：2009-03-13T16:14:50.447
> 
> 标签：perl, orm, dbix-class

我想要这样的功能：

```
$parent->get_grandchildren_by_category({category => 'foo'}); 
```

我可以通过简单的链式连接在父类之外轻松完成：

```
$schema->resultset('Parent')->search(
    {
        'me.id' => 62,
        'grandchildren.category' => 'foo'
    },
    {
        join => {'children' => 'grandchildren'}
    }
); 
```

但是在父类中，我无权（也不应该）访问模式对象。在我可以访问的父类内部，`$self->children`但它返回一个子类的结果集，我必须遍历它们以获取每个子类的`grandchildren`.

有什么方法可以定义这种 ActiveRecord 风格吗？

```
class Parent < ActiveRecord::Base
   has_many :children
  has_many :grandchildren, :through => :children
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T20:17:46.883

我得到了很多帮助`#dbix-class`。可能没有办法显式定义`:through`ActiveRecord 样式的关系，但有一种方法可以在结果链的下游进一步抓取子项。

使用`ResultSet`'s [search_related](http://search.cpan.org/dist/DBIx-Class/lib/DBIx/Class/ResultSet.pm#search_related)方法，您可以通过关系访问并使用孩子的访问器。例如，在我的 Parent 类中：

```
sub get_grandchildren_by_category{
    my ($self, $category) = @_;
    my @gchildren = $self->children->search_related('grandchildren'
        {
             'grandchildren.category' => $category
        }
    );

    return \@gchildren;
} 
```

由于`search_related`返回结果集，我想您可以`search_related`根据需要链接这些调用。

# asp.net - IIS7 的 ASP MVC 路由问题

> ID：643477
> 
> 赞同：5
> 
> 时间：2009-03-13T16:14:52.927
> 
> 标签：asp.net, asp.net-mvc

我们在 IIS7 服务器上部署 MVC 应用程序时发现了问题：任何路由导航都会出现 404 错误。我在网上发现可以通过将应用程序池管理的管道模式设置为集成来解决问题，但现在我们有例外：

```
Request is not available in this context

Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. 

Exception Details: System.Web.HttpException: Request is not available in this context

Source Error: 

Line 19: 
Line 20:         public override void SetActiveUser(Guid userOid) {
Line 21:             FormsAuthentication.SignOut();
Line 22:             HttpContext.Current.Items[Key] = userOid.ToString();
Line 23:             FormsAuthentication.RedirectFromLoginPage(userOid.ToString(), true); 
```

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-13T16:31:49.063

问题可能出在 web.config 文件中。从 IIS7 开始，现在有两个地方可以配置处理程序和模块。当您在经典模式下运行时，就像在 IIS 6 上运行（尽管在 IIS7 下）。

这是配置文件：

```
<system.web>
[...]
    <httpHandlers>
            [...]
        </httpHandlers>
        <httpModules>
            [...]
            <add name="UrlRoutingModule" type="System.Web.Routing.UrlRoutingModule, System.Web.Routing, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />

        </httpModules>
    </system.web> 
```

应该只有 IIS 6 配置。

IIS 7 配置应放在：

```
 <system.webServer>
[...]
            <modules runAllManagedModulesForAllRequests="true" >
                <remove name="UrlRoutingModule"/>
                <add name="UrlRoutingModule" type="System.Web.Routing.UrlRoutingModule, System.Web.Routing, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
            </modules>
            <handlers>
                <add name="UrlRoutingHandler" preCondition="integratedMode" verb="*" path="UrlRouting.axd" type="System.Web.HttpForbiddenHandler, System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" />
            </handlers>
        </system.webServer> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T16:40:26.983

盯着kvalcanti所说的。标准路由是为 IIS 7 设计的。为旧版本的 IIS 添加了一个 kludge。因此，如果您正在开发旧版本，那么您将拥有配置文件的混乱版本。更改配置可以解决问题。

除了 kvalcanti 提到的内容之外，您还可能在 global.asax 中设置了一些杂项。我不确定它在最新版本的 ASP.NET MVC 中是否仍然是强制性的，因为在过去的几个月里我除了 Vista 没有开发任何东西。

这篇文章有一些见解： http: [//www.developingfor.net/aspnet-mvc/deploying-aspnet-mvc-on-iis6.html](http://www.developingfor.net/aspnet-mvc/deploying-aspnet-mvc-on-iis6.html)

[Scott Guthrie 在他的博客 ( http://weblogs.asp.net/scottgu/](http://weblogs.asp.net/scottgu/) )上有一篇很棒的博客文章，但我没有将它添加为书签。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2011-03-27T20:03:51.727

1.  打开 Nuget
2.  安装[NotFoundMvc](http://nuget.org/List/Packages/NotFoundMvc)
3.  ？？？
4.  利润

# silverlight - 如何使用 Silverlight 实现 3D 图像处理？

> ID：643478
> 
> 赞同：0
> 
> 时间：2009-03-13T16:15:15.423
> 
> 标签：silverlight

我想实现 3D 图像处理（即图像编辑、调整大小、**旋转**、放大和缩小）。请尽快给我你的想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T20:45:20.233

Silverlight 2.0 不支持真正的 3D。Silverlight 3 将支持透视投影模拟 3D（想想 PowerPoint 中的 3D 图像）。

对于标准图像处理，您有几种方法可以使用。如果您只是为了*显示*目的而进行旋转和调整大小，您可以在图像对象上设置一个 RenderTransform。这实际上并没有改变图像中的位，只是使它们以不同的方式绘制。

如果您想了解完整的图像处理，请参阅 StackOverflow 上的其他帖子：

[图像处理](https://stackoverflow.com/questions/35120/image-processing-in-silverlight-2)

# asp.net-mvc - ASP.NET MVC 错误：“未声明名称 '__o'。”

> ID：643485
> 
> 赞同：8
> 
> 时间：2009-03-13T16:16:49.180
> 
> 标签：asp.net-mvc

我的 View aspx 文件中有一大堆这些错误。

但是，它的构建和运行都很好。

这些是什么？我该如何摆脱它们？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-13T16:18:20.017

Mikhail Arkhipov[在 ASP.NET 论坛上发布了解释和解决方法](http://forums.asp.net/p/923745/1266105.aspx)：

> 我们终于获得了可靠的复制品并确定了根本问题。一个简单的复制看起来像这样：
> 
> ```
> <% if (true) { %>
>     <%=1%>
> <% } %>
> <%=2%> 
> ```
> 
> 为了在设计时在 <%= %> 块中提供智能感知，ASP.NET 生成对临时 __o 变量和语言（VB 或 C#）的赋值，然后为变量提供智能感知。这是在页面编译器看到第一个 <%= ... %> 块时完成的。但是在这里，块在 if 里面，所以在 if 关闭之后，变量就超出了范围。我们最终会生成这样的东西：
> 
> ```
> if (true) { 
>     object @__o;
>     @__o = 1;
> }
> @__o = 2; 
> ```
> 
> 解决方法是在页面的早期添加一个虚拟表达式。例如 <%="" %>。这不会渲染任何东西，它会确保 __o 在任何潜在的“if”（或其他范围）语句之前在 Render 方法中声明为顶级。

# javascript - 如何使用 jQuery 遍历这个 DOM 并检索所需的文本？

> ID：643488
> 
> 赞同：4
> 
> 时间：2009-03-13T16:17:44.370
> 
> 标签：javascript, jquery, dom, dom-manipulation

我在一个页面上有一个表单，它有一堆兄弟`h5`标签。我想`h5`使用 jQuery 检索每个标签之间的文本。我希望有一个回调或者能够在一个简单的循环结构中执行此操作，我可以在其中获取文本并对其进行有意义的 HTML，然后将最终字符串插入其他地方。

如何使用 jQuery 做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-13T16:18:55.257

这将抓取表单下的所有 h5 并提醒他们的文本。你可以从那里做任何事情。

```
$('#myform h5').each(function() {
    alert($(this).text());
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T22:59:25.903

通过兄弟标签，您的意思是它们与表单处于同一级别，如下所示？：

```
<form id="the-form">
  ...
</form>
<h5>Title 1</h5>
<h5>Title 2</h5>
<h5>Title 3</h5> 
```

如果这是正确的，您可以执行以下操作：

```
$("#the-form ~ h5").each(function (){
  // do something with $(this).text()
}); 
```

注意 ~，它选择兄弟姐妹。

或者，如果您希望将文本发送到回调：

```
function callback( textFound ){
  // do something with textFound
}

$("#the-form ~ h5").each(function (){
  callback( $(this).text() );
}); 
```

# language-agnostic - 数据访问接口名称建议

> ID：643490
> 
> 赞同：0
> 
> 时间：2009-03-13T16:18:05.120
> 
> 标签：language-agnostic

我正在寻找有关接口名称的建议。

该接口用于稍后将在 DAL 中定义的原始 CRUD 方法，但是我需要在较低级别的 API 中使用它。接口本身只有四个成员，Create()、Read()、Update() 和 Delete()。

我目前正在考虑与 IDataAccessPrimatives 类似的东西，但对这个名称非常矛盾。你们有什么建议？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T16:23:35.293

ICantBelieveItsNotButter 怎么样？

或者，ICanReadUpsideDown？

或者，（更严重的）**IPersistData**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T16:24:04.950

删除“原语”。

除非您需要与另一个“原始” DAL 接口区分开来，否则我会选择**IDataAccess 。**

为您常用的接口使用最直接的名称。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T16:32:00.267

听起来您正在使用[表数据网关](http://martinfowler.com/eaaCatalog/tableDataGateway.html)模式。ITableDataGateway 或 IGateway 或其他一些衍生产品怎么样？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T16:30:47.990

我将使用 IDataAccessOperation/IDataAccessService。

这清楚地表明了接口的责任。

另一种选择是在后面的选项中将 Service 替换为 Manager。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T16:36:02.300

**克鲁德。** 严重地。为什么不？每个开发人员都知道 CRUD 是什么意思。

# flash - 如何修复 Flash 中的此隐式强制错误？

> ID：643494
> 
> 赞同：1
> 
> 时间：2009-03-13T16:18:31.920
> 
> 标签：flash, actionscript-3, physics

我正在使用[AS3 的物理引擎，](http://www.cove.org/ape/)下面的代码基本上是 hello world 示例。但是，我通过在类定义的开头将属性“ball”声明为 WheelParticle 进行了轻微更改。（如果有错，请原谅我的术语）。之前，它在构造函数中被声明为

```
var ball:WheelParticle = new WheelParticle(...); 
```

效果很好。但是现在，以我的方式尝试我得到了错误

> 将 org.cove.ape.WheelParticle 类型的值隐式强制转换为不相关的类型 Class | 球：WheelParticle = 新...等
> 
> “非法分配给 WheelParticle 类”

所以我想我的声明`public var ball:WheelParticle`应该是别的东西。但是什么？

无论如何，这是代码。它很短。我会参考文档，但没有。反正我也找不到。

包裹{

```
 import org.cove.ape.*;
    import flash.events.*;
    import flash.display.Sprite;    

    public class Bounce extends Sprite {

         public var ball:WheelParticle;

    public function Bounce() {

        stage.focus = this;
        stage.frameRate = 100;
        addEventListener(Event.ENTER_FRAME, run);

        stage.addEventListener(KeyboardEvent.KEY_DOWN, moveLeft);

        APEngine.init(0.3);
        APEngine.container = this;
        APEngine.addMasslessForce(new Vector(0,2));

        var defaultGroup:Group = new Group();
        defaultGroup.collideInternal = true;

        var ball:WheelParticle = new WheelParticle(250,10,40, false, 1, 0.7, 0.1);
        defaultGroup.addParticle(ball);

        var rp:RectangleParticle = new RectangleParticle(250,300,300,50,0,true);
        defaultGroup.addParticle(rp);

        APEngine.addGroup(defaultGroup);
      }

      private function moveLeft(e:Event):void{
          ball.speed += 1;
    }

      private function run(evt:Event):void {
         APEngine.step();
         APEngine.paint();
      }
   } 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T17:47:37.010

`WheelParticle`将类（以及您需要的所有其他类）显式导入为：

```
package {
import flash.display.Sprite;
import flash.events.Event;
import flash.events.KeyboardEvent;

import org.cove.ape.APEngine;
import org.cove.ape.Group;
import org.cove.ape.RectangleParticle;
import org.cove.ape.Vector;
import org.cove.ape.WheelParticle;

    public class Bounce extends Sprite { 
```

缺少导入是导致错误的最可能原因。另外，请注意您的示例代码有一个小故障。

```
 public class Bounce extends Sprite {

     public var ball:WheelParticle; 
```

为名为的`Bounce`类声明一个成员变量。`WheelParticle``ball`

```
var ball:WheelParticle = new WheelParticle(250,10,40, false, 1, 0.7, 0.1); 
```

创建另一个具有相同类型和相同名称但对于 的构造函数是本地的变量`Bounce`。而这个遮蔽了前者。如果要使用成员变量，请使用：

```
ball = new WheelParticle(250,10,40, false, 1, 0.7, 0.1); 
```

# html - HTML/IE：拉伸图像以适应，保持纵横比

> ID：643500
> 
> 赞同：6
> 
> 时间：2009-03-13T16:19:23.510
> 
> 标签：html, internet-explorer

在 HTML 窗口中，我正在设置自定义正文

```
<img src="file://[filename]"> 
```

显示图像。

现在我想拉伸图像以适应可用窗口，但保持纵横比。

```
<img src="file://[filename]" width="100%" height="100"> 
```

拉伸但也会扭曲图像。

是否有一些 HTML 技巧可以做到这一点？仅 IE 的解决方案很好，因为这是在托管的浏览器控件中。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-13T16:50:13.450

如果你想保持纵横比，你只需要指定一维，即：

```
<img src="file://[filename]" width="100%" alt="" /> 
```

您可以使用 javascript 来确定最大尺寸并相应地调整大小

```
<script type="text/javascript">
function getImgSize(id){
var pic = document.getElementById(id);
var h = pic.offsetHeight;
var w = pic.offsetWidth;
alert ('The image size is '+w+'*'+h);
}
</script> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-13T16:33:08.873

如果您知道高度或宽度，则只能设置它。其他尺寸将根据图像的纵横比自动设置。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-13T16:26:33.507

不，您将不得不为此使用 Javascript，而且它比听起来更棘手。前一周我做了类似的事情，这里是我为它创建的功能，你也许可以重新使用它

哦，它需要 jQuery

```
function resize_background(){

    var target = $("#background_image");
    var window = $(window);
    var ratio = 1;
    var anchor_point = 200;
    var register_point = 400;

    if(window.width() > min_width){
        ratio = window.width() / min_width;
        target.css("marginLeft", 0);
    }else{
        // center to screen
        // For this project, this aint needed.
        //var left_margin = (window.width() / 2) - (min_width / 2);
        //target.css("marginLeft", left_margin);
    }

    // now figure out anchor stuff
    var top = ((register_point * ratio) - anchor_point) * -1;

    target.width(min_width * ratio);
    target.height(min_height * ratio);
    target.css("marginTop", top);

    $("#trace").text(top);

} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-07-07T06:46:36.250

纯 HTML 解决方案：这是我的技术。

```
 .iCon {
    height: 267px;
    width: 520px;
    background-color: #0F3;
    overflow: hidden;
    }
.iCon img {
    margin-right: auto;
    margin-left: auto;
    height: 350px;
    text-align: center;
    display: table-cell;
    margin-top: -50px;
    } 
```

HTML：

```
<div class="iCon">
   <img src="http://media.caranddriver.com/images/13q2/510832/2014-ford-fiesta-16l-sedan-hatchback-first-drive-review-car-and-driver-photo-523592-s-450x274-1.jpg">
</div> 
```

演示：http: [//jsfiddle.net/PBbcF/](http://jsfiddle.net/PBbcF/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-10-15T20:32:40.423

设置 width = 100% 并不是一个很好的答案，因为它不考虑高度，并且可能会在 Y 方向上溢出窗口之外的元素。

此解决方案在加载和调整大小时调整元素的大小，检查窗口的纵横比并确定高度应为 100% 还是宽度应为 100%。这将始终将 FULL 元素保留在窗口中并在保持纵横比的同时最大化。

```
function changeElementSize(){
    // Compare your element's aspect ratio with window's aspect ratio
    // My element was 100w x 80h so mine was 1.25
    if (window.innerWidth/window.innerHeight > 1.25){
        $('#element').css('height','100%');
        $('#element').css('width','auto');
    } else {
        $('#element').css('width','100%');
        $('#element').css('height','auto');
    }
}

$( window ).resize(function() {
    changeElementSize();
});

$( window ).load(function() {
    changeElementSize();
}); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-07-19T06:14:55.570

这个版本的@hfarazm 代码在其中创建了一个 div，图片处于水平居中的全垂直尺寸，如果你将其水平设置为全尺寸，它将垂直居中，我认为这是不使用 js 的最佳方式（使用 tommybananas 代码可能是可能使其完全工作）或php或其他东西：HTML

```
<div class="centeredImage">
    <img src="http://media.caranddriver.com/images/13q2/510832/2014-ford-fiesta-16l-sedan-hatchback-first-drive-review-car-and-driver-photo-523592-s-450x274-1.jpg">
</div> 
```

CSS

```
.centeredImage {
    height: 500px;
    width: 500px;
    background: rgba(0,0,0,0.0);
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
}
.centeredImage img {
    margin: auto;
    width: 500px;
} 
```

[http://jsfiddle.net/5p0ugfLw/](http://jsfiddle.net/5p0ugfLw/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-13T16:23:03.390

纯 HTML 没有。

如果您知道图像的纵横比，这可以在 JavaScript 中完成。不知道这是否可以通过 JS 实现，但如果您也使用任何其他语言，则可以将该值传递给 JavaScript。

# asp.net - 当我在 HTML 页面中包含来自 ASP.NET .aspx 页面的输出时，我需要做什么？就像是

> ID：643504
> 
> 赞同：0
> 
> 时间：2009-03-13T16:20:21.010
> 
> 标签：asp.net, updatepanel, scriptmanager, base

我在 http://localhost/nn/n.aspx 有一个 ASP.NET 文件， [处理](http://localhost/nn/n.aspx) 该文件的输出包含在 [http://localhost/index.asp](http://localhost/index.asp)中。

我应该做一些一般或特定的事情，以便客户端上的 ASP.NET 代码知道它是什么？

设置 `<form action="http://localhost/nn/n.aspx` 使它发布到正确的位置，但我的更新面板失败了。

我想这可能是 ScriptManager 的 ScriptPath，我大概可以弄清楚。

但我担心可能还有其他问题，我希望有类似 HTML 标签的东西，我可以用它来告诉我的客户端代码它在哪里。

谢谢奥拉夫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T16:36:03.453

一个）。“..处理该文件的输出包含在..中”到底是什么*意思*？

乙）。`<base>`标签是邪恶的 html 气味，导致的问题多于解决的问题，是架构失败的征兆

C）。HTML页面是什么意思？普通的 HTML 页面不可能包含 .aspx 内容，HTML 不是服务器端语言。当然有方法和手段，但你需要具体。

D)。你需要给我们一些关于你的代码和网站架构的更多想法，这里没有足够的信息来解决这个问题“我的更新面板失败”确实非常模糊。*它是如何*失败的？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T16:42:26.263

您是否正在寻找创建服务器端控件？您不会在另一个 ASPX 文件中包含“处理输出”。相反，您创建一个 ASCX 文件 - 一个服务器端控件，然后将其合并*到*目标 ASPX 文件中。

这很容易做到，很可能就是您正在寻找的。但是，您的问题很模棱两可，所以我无法确定！

# sql - 在一个连接中混合 ON 和 USING

> ID：643508
> 
> 赞同：1
> 
> 时间：2009-03-13T16:21:16.673
> 
> 标签：sql, oracle

有没有办法在 Oracle 中执行以下操作：

```
SELECT *
FROM   Tbl1
JOIN   Tbl2 
USING  (col1)
AND ON Tbl1.col2 = Tbl2.col3 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T16:25:12.513

在标准 SQL 中，您可以使用 USING 或 ON，但不能同时使用两者。如果您可以同时使用两者，您将在示例中省略 AND。

* * *

PMV 评论（更准确地说，问 - 另见海报的答案）：

> 我的问题是我有一堆表，都使用 USING 连接。如果我尝试添加具有不同键名的表，则会出现模棱两可的列错误。有没有一种优雅的方法可以做到这一点，而无需将我的所有加入都转换为 ON 加入？

好吧，限制由可悲的错误命名的列造成的损害的最佳方法可能是（并且大致 - 我没有调试下面的 SQL）：

```
SELECT *
    FROM (SELECT *
             FROM Tbl1
                  JOIN Tbl2 USING (col1, col2, col3, col4)
                  JOIN Tbl3 USING (col2, col4, col6, col23)
                  JOIN Tbl4 USING (col2, col8, col3, col23)
          ) AS SystematicNaming
          JOIN Tbl5
              ON  SystematicNaming.Col1 = Tbl5.Col1
              AND SystematicNaming.ColA = Tbl5.PoorlyNamedColA
              AND SystematicNaming.ColB = Tbl5.PoorlyNamedColB 
```

这尽可能长时间地保留了方便和系统的 USING 表示法，同时管理与 Tbl5 的连接，因为它必须在给定与 Tbl5 连接所需的非统一列名的情况下进行管理。

我不确定这是最好的查询布局，尽管我认为它是合理的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T16:31:03.530

```
SELECT * FROM TBL1 JOIN TBL2 ON TBL1.COL1 = TBL2.COL1 AND TBL1.COL2 = TBL2.COL3 
```

问候 K

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T17:19:11.773

```
SELECT *
FROM   Tbl1
       INNER JOIN Tbl2
ON     Tbl1.col1 = Tbl2.col1
   AND Tbl1.col2 = Tbl2.col3 
```

# apache-flex - 使用 SWFLoader 的带有 RSL 的嵌套弹性应用程序的内存消耗？

> ID：643513
> 
> 赞同：1
> 
> 时间：2009-03-13T16:22:50.443
> 
> 标签：apache-flex, swfloader, rsl

这些天我读了很多关于 RSL 的文章。一个缺点是 RSL 必须加载到内存中，但可以节省大量加载时间。

现在在以下场景中会发生什么：

我有一个 superFramework.swf 和一个 subapp.swf。subapp.swf 使用 SWFLoader 在 superframework.swf 中按需显示和加载。但是，这两个 SWF 都依赖于 common.swc，它将被编译为 RSL。

所以依赖项看起来像这样：

```
superframework.swf           ---RSL---> common.swc
   ---SWFLoader-->subapp.swf ---RSL---> common.swc 
```

现在我的问题：

*   subapp.swf 是否加载到单独的内存空间中？
*   如果是：这是否意味着 common.swc RSL 两次加载到内存中？
*   如果不是：那么像 common.swc 中的 ModelLocator 这样的单例呢？subapp.swf 和 superframework.swf 是否可以同时使用同一个实例？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T18:23:20.233

RSL 不是真正的动态库。它们更像是在运行时静态链接*整个*库。

> *   subapp.swf 是否加载到单独的内存空间中？

是的，有点。所有 SWF 都在 Flash Player 中运行。出于安全原因，他们有自己的小沙箱。

> *   如果是：这是否意味着 common.swc RSL 两次加载到内存中？

是的，每个调用应用程序都会加载给定 RSL 的一份副本。

> *   如果不是：那么像 common.swc 中的 ModelLocator 这样的单例呢？subapp.swf 和 superframework.swf 是否可以同时使用同一个实例？

不，他们会有不同的实例。

RSL 有助于减少可分发的大小。但这不一定总是一个优势。我建议你在开始之前先浏览[一下这个](http://livedocs.adobe.com/flex/3/html/help.html?content=rsl_02.html)页面。

# opengl - 我在哪里可以获得 OpenGL 库？

> ID：643515
> 
> 赞同：0
> 
> 时间：2009-03-13T16:22:57.230
> 
> 标签：opengl

OpenGL 库和头文件是 • opengl32.lib • glu32.lib • gl.h • glu.h

我在哪里可以得到这些文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T16:52:46.847

通常，默认情况下（至少在 Visual Studio 中）提供的头文件和库文件没有那么有用，尤其是您计划使用“现代”OpenGL 功能或扩展时。

你应该看看[跨平台扩展加载库](http://www.opengl.org/sdk/libs/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T16:25:14.633

这应该包含在您的编译器中。g++ 发布它们（据我所知），MSVC 也是。

您的编译器/操作系统/编程语言到底是什么？

编辑：看看是否有效：

```
#include <gl/gl.h>
#include <gl/glu.h> 
```

编辑2：您应该重新考虑提出问题的方式，以及您选择的标签。\咆哮

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T16:40:20.260

对于 Visual Studio，您需要platformsdk。它附带 Visual Studio CD（至少是专业版），但如果您使用快速下载，则需要单独下载。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-11-21T18:21:41.740

您提到的所有这些文件都是编译器头文件和库的一部分，并且随您使用的任何文件一起提供。它们确实存在于 gcc 和 Visual Studio 编译器中。

你只是这样使用它们：

```
// for any compiler
#include <gl/gl.h>
#include <gl/glu.h>

// VisualStudio-specific
#pragma comment(lib, "glu32.lib") 
```

使用 GNU 编译器，您应该像这样传递链接器参数（取自 opengl.org）：

> -lGLU -lGL -lXmu -lX11

希望这会有所帮助=)

# algorithm - 找到与输入最相似的字符串的最快方法？

> ID：643538
> 
> 赞同：14
> 
> 时间：2009-03-13T16:26:22.680
> 
> 标签：algorithm, string, language-agnostic

给定一个长度为 N 的查询字符串 Q 和一个长度为 N 的 M 个序列的列表 L，找到 L 中与 Q 的不匹配位置最少的字符串的最有效算法是什么？例如：

```
Q = "ABCDEFG";
L = ["ABCCEFG", "AAAAAAA", "TTAGGGT", "ZYXWVUT"];
answer = L.query(Q);  # Returns "ABCCEFG"
answer2 = L.query("AAAATAA");  #Returns "AAAAAAA". 
```

显而易见的方法是扫描 L 中的每个序列，使搜索花费 O(M * N)。有没有办法在亚线性时间内做到这一点？我不在乎将 L 组织到某个数据结构中是否有很大的前期成本，因为它将被查询很多次。此外，任意处理并列分数也可以。

编辑：为了澄清，我正在寻找汉明距离。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2011-01-09T16:36:07.983

除了提到最好的第一个算法的答案之外，所有答案都非常偏离。本地敏感哈希基本上是在做梦。这是我第一次在 stackoverflow 上看到如此多的答案。

首先，这是一个困难但标准的问题，多年前已经以不同的方式解决了。

一种方法使用特里树，例如 Sedgewick 在此处预设的特里树：

[http://www.cs.princeton.edu/~rs/strings/](http://www.cs.princeton.edu/~rs/strings/)

Sedgewick 也有示例 C 代码。

我引用了 Bentley 和 Sedgewick 题为“用于排序和搜索字符串的快速算法”的论文：

"''近邻'' 查询**定位查询词的给定汉明距离内的所有词**（例如，代码与苏打水的距离为 2）。我们给出了一种用于字符串中近邻搜索的新算法，给出了一个简单的 C 实现，并描述其效率的实验。”

第二种方法是使用索引。将字符串拆分为字符 n-gram 并使用倒排索引进行索引（谷歌搜索 Lucene 拼写检查器，看看它是如何完成的）。使用索引拉出潜在候选人，然后对候选人进行汉明距离或编辑距离。这是保证效果最好的方法（并且相对简单）。

第三个出现在语音识别领域。那里的查询是一个 wav 信号，而数据库是一组字符串。有一个“表”将信号片段与单词片段相匹配。目标是找到最匹配的词来表示。这个问题被称为单词对齐。

在发布的问题中，将查询部分与数据库部分匹配存在隐含成本。例如，删除/插入/替换可能具有不同的成本，甚至可能会因“ph”与“f”不匹配而产生不同的成本。

语音识别中的标准解决方案使用动态编程方法，该方法通过直接修剪的启发式方法变得高效。这样，只保留最好的，比如说 50 个候选人。因此，名称最佳优先搜索。从理论上讲，您可能不会得到最佳匹配，但通常会得到一个很好的匹配。

以下是对后一种方法的参考：

[http://amta2010.amtaweb.org/AMTA/papers/2-02-KoehnSenellart.pdf](http://amta2010.amtaweb.org/AMTA/papers/2-02-KoehnSenellart.pdf)

使用后缀数组和 A* 解析的快速近似字符串匹配。

这种方法不仅适用于单词，也适用于句子。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-13T17:01:38.603

[正如我从CACM 中的这篇评论文章中了解到的那样，](http://mags.acm.org/communications/200801/?searchterm=nearest+neighbor+in+high+dimensions&pg=119)[位置敏感散列](http://en.wikipedia.org/wiki/Locality_sensitive_hashing)似乎是已知的渐近最佳方法的基础。说的文章很毛茸茸，我没有通读。另请参阅[最近邻搜索](http://en.wikipedia.org/wiki/Nearest_neighbor_search)。

要将这些引用与您的问题联系起来：它们都处理度量空间中的一组点，例如 n 维向量空间。在您的问题中，n 是每个字符串的长度，每个坐标上的值是可以出现在字符串中每个位置的字符。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-12-31T08:18:29.747

“最佳”方法将根据您的输入集和查询集而有很大差异。拥有固定的消息长度可以让您在分类上下文中处理此问题。

信息论决策树算法（例如 C4.5）将提供最佳的整体性能保证。为了从这种方法中获得最佳性能，您必须首先根据互信息将字符串索引聚类为特征。请注意，您需要修改分类器以返回最后一个分支的所有叶节点，然后计算每个叶节点的部分编辑距离。编辑距离只需要为树的最后一次分裂所代表的特征集计算。

使用这种技术，查询应该是~O(k log n)，k << m，其中k是特征大小的期望值，m是字符串的长度，n是比较序列的数量。

初始设置保证小于 O(m^2 + n*t^2), t < m, t * k ~ m，其中 t 是项目的特征计数。这是非常合理的，不需要任何严重的硬件。

由于固定的 m 约束，这些非常好的性能数字是可能的。享受！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-13T16:30:33.390

我认为您正在寻找[Levenshtein 编辑距离](http://en.wikipedia.org/wiki/Levenshtein_distance)。

[关于这个已经](http://www.google.com/search?q=levenshtein+site%3Astackoverflow.com)有几个问题了，我想你可以找到一些好的答案。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-13T16:38:46.753

您可以将每个序列视为 N 维坐标，将生成的空间分块为知道其中出现什么序列的块，然后在查找时首先搜索搜索序列的块和所有连续块，然后根据需要向外扩展。（维护多个分块范围可能比搜索真正的大块组更可取。）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-13T16:41:51.957

对目标序列的某些[最佳优先搜索](http://en.wikipedia.org/wiki/Best-first_search)将比 O(M * N) 做得更好。其基本思想是您将候选序列中的第一个字符与目标序列的第一个字符进行比较，然后在您的第二次迭代中只与具有最少不匹配数量的序列进行下一个字符比较，等等。在您的第一个示例中，您将第二次与 ABCCEFG 和 AAAAAAA 进行比较，仅第三次和第四次比较 ABCCEFG，第五次比较所有序列，之后仅比较 ABCCEFG。当您到达候选序列的末尾时，具有最低错配计数的目标序列集就是您的匹配集。

（注意：在每个步骤中，您都在与搜索分支的下一个字符进行*比较*。渐进式比较都不会跳过字符。）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-13T16:42:45.933

您是否在寻找字符串之间的[汉明距离](http://en.wikipedia.org/wiki/Hamming_distance)（即在等效位置的不同字符的数量）？

还是字符“之间”的距离（例如英文字母的 ASCII 值之间的差异）对您也很重要？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-16T23:33:04.433

我想不出一个小于 O(N * M) 的通用、精确算法，但是如果你有足够小的 M 和 N，你可以使用位并行创建一个执行为 (N + M) 的算法操作。

例如，如果 N 和 M 都小于 16，您可以使用 64 位整数 (16*log2(16) = 64) 的 N * M 查找表，并在一次遍历字符串中执行所有操作，其中每个计数器中的 4 位组对于匹配的字符串之一计数 0-15。显然，您需要 M log2(N+1) 位来存储计数器，因此可能需要为每个字符更新多个值，但通常单遍查找可能比其他方法更快。所以它实际上是 O( N * M log(N) )，只是具有较低的常数因子 - 使用 64 位整数会在其中引入 1/64，所以如果 log2(N) < 64 应该会更好。如果 M log2(N +1) < 64，结果为 (N+M) 次操作。但这仍然是线性的，而不是次线性的。

```
#include <stdint.h>
#include <stdlib.h>
#include <stdio.h>
#include <inttypes.h>

size_t match ( const char* string, uint64_t table[][128] ) ;

int main ()
{
    const char* data[] = { "ABCCEFG", "AAAAAAA", "TTAGGGT", "ZYXWVUT" };
    const size_t N = 7;
    const size_t M = 4;

    // prepare a table
    uint64_t table[7][128] = { 0 };

    for ( size_t i = 0; i < M; ++i )
        for ( size_t j = 0; j < N; ++j )
            table[j][ (size_t)data[i][j] ] |= 1 << (i * 4);

    const char* examples[] = { "ABCDEFG", "AAAATAA", "TTAGQQT", "ZAAGVUT" };

    for ( size_t i = 0; i < 4; ++i ) {
        const char* q = examples[i];
        size_t result = match ( q, table );

        printf("Q(%s) -> %zd %s\n", q, result, data[result]);
    }
}

size_t match ( const char* string, uint64_t table[][128] )
{
    uint64_t count = 0;

    // scan through string once, updating all counters at once
    for ( size_t i = 0; string[i]; ++i )
        count += table[i][ (size_t) string[i] ];

    // find greatest sub-count within count
    size_t best = 0;
    size_t best_sub_count = count & 0xf;

    for ( size_t i = 1; i < 4; ++i ) {
        size_t sub_count = ( count >>= 4 ) & 0xf;

        if ( sub_count > best_sub_count ) {
            best_sub_count = sub_count;
            best = i;
        }
    }

    return best;
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-02-02T11:39:16.223

*很抱歉碰到这个旧线程*

逐元素搜索意味着复杂度为 O(M*N*N) - O(M) 用于搜索，O(N*N) 用于计算 levenshtein 距离。

OP 正在寻找一种有效的方法来找到最小的汉明距离 (c)，而不是字符串本身。如果你在 c 上有一个上限（比如 X），你可以在 O(log(X)*M*N) 中找到最小的 c。

正如 Stefan 指出的那样，您可以快速找到给定汉明距离内的字符串。此页面[http://blog.faroo.com/2015/03/24/fast-approximate-string-matching-with-large-edit-distances/](http://blog.faroo.com/2015/03/24/fast-approximate-string-matching-with-large-edit-distances/)讨论了使用 Tries 的一种方式。修改它以测试是否有这样的字符串和从 0 到 X 的 c 上的二进制搜索。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-03-13T17:07:38.713

如果前期成本无关紧要，您可以为每个可能的输入计算最佳匹配，并将结果放入哈希映射中。

当然，如果 N 不是非常小，这将不起作用。

# javascript - JavaScript 不支持带有局部变量的闭包吗？

> ID：643542
> 
> 赞同：60
> 
> 时间：2009-03-13T16:27:24.817
> 
> 标签：javascript, loops, closures

我对这段代码感到非常困惑：

```
var closures = [];
function create() {
  for (var i = 0; i < 5; i++) {
    closures[i] = function() {
      alert("i = " + i);
    };
  }
}

function run() {
  for (var i = 0; i < 5; i++) {
    closures[i]();
  }
}

create();
run(); 
```

据我了解，它应该打印`0,1,2,3,4`（这不是闭包的概念吗？）。

相反，它打印`5,5,5,5,5`.

我试过犀牛和火狐。有人可以向我解释这种行为吗？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-03-13T16:57:47.770

通过添加一个额外的匿名函数来修复 Jon 的答案：

```
function create() {
  for (var i = 0; i < 5; i++) {
    closures[i] = (function(tmp) {
        return function() {
          alert("i = " + tmp);
        };
    })(i);
  }
} 
```

解释是 JavaScript 的作用域是函数级的，而不是块级的，创建闭包只是意味着封闭的作用域被添加到封闭函数的词法环境中。

循环终止后，函数级变量`i`的值为`5`，这就是内部函数“看到”的内容。

* * *

附带说明：您应该注意不必要的函数对象创建，尤其是在循环中；它效率低下，如果涉及 DOM 对象，很容易创建循环引用，从而在 Internet Explorer 中引入内存泄漏。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-13T16:39:43.633

我认为这可能是你想要的：

```
var closures = [];

function createClosure(i) {
    closures[i] = function() {
        alert("i = " + i);
    };
}

function create() {
    for (var i = 0; i < 5; i++) {
        createClosure(i);
    }
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-13T16:42:50.223

解决方案是让一个自动执行的 lambda 包装您的数组推送。您还将 i 作为参数传递给该 lambda。自动执行的 lambda 中的 i 值将影响原始 i 的值，并且一切都将按预期工作：

```
function create() {
    for (var i = 0; i < 5; i++) (function(i) {
        closures[i] = function() {
            alert("i = " + i);
        };
    })(i);
} 
```

另一种解决方案是创建另一个闭包，它捕获 i 的正确值并将其分配给另一个变量，该变量将在最终的 lambda 中“被捕获”：

```
function create() {
    for (var i = 0; i < 5; i++) (function() {
        var x = i;

        closures.push(function() {
            alert("i = " + x);
        });
    })();
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-13T16:30:09.507

是的，关闭在这里工作。每次循环您正在创建的函数时，都会抓取`i`. 您创建的每个函数都共享相同的`i`. 您看到的问题是，由于它们都共享相同的内容，`i`因此它们也共享最终值，`i`因为它是相同的捕获变量。

**编辑： Skeet 先生的** [这篇文章](http://csharpindepth.com/Articles/Chapter5/Closures.aspx)更深入地解释了闭包，并特别以一种比我在这里提供的信息更丰富的方式解决了这个问题。 ***但是要小心，因为 Javascript 和 C# 处理闭包的方式有一些细微的差别。*** 跳到“比较捕获策略：复杂性与功率”一节，了解他对这个问题的解释。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-13T17:24:33.243

John Resig 的[Learning Advanced JavaScript](http://ejohn.org/apps/learn/)解释了这一点以及更多内容。这是一个交互式演示文稿，解释了很多关于 JavaScript 的内容，示例阅读和执行都很有趣。

它有一章是关于闭包的，[这个例子](http://ejohn.org/apps/learn/#62)看起来很像你的。

这是损坏的示例：

```
var count = 0; 
for ( var i = 0; i < 4; i++ ) { 
  setTimeout(function(){ 
    assert( i == count++, "Check the value of i." ); 
  }, i * 200); 
} 
```

和修复：

```
var count = 0; 
for ( var i = 0; i < 4; i++ ) (function(i){ 
  setTimeout(function(){ 
    assert( i == count++, "Check the value of i." ); 
  }, i * 200); 
})(i); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-10-27T23:18:39.233

只需定义一个内部函数，或将其分配给某个变量：

```
closures[i] = function() {... 
```

不会创建整个执行上下文的私有副本。在最近的外部函数**退出**之前不会复制上下文（此时这些外部变量可能会被垃圾收集，所以我们最好获取一个副本）。

这就是为什么在你的内部函数周围包装另一个函数有效的原因——中间人实际上执行并退出，提示最里面的函数保存他自己的堆栈副本。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-03-13T16:40:56.720

以下是你应该做的来达到你的结果：

```
<script>
var closures = [];
function create() {  
    for (var i = 0; i < 5; i++) {   
        closures[i] = function(number) {      
        alert("i = " + number);   
        };  
    }
}
function run() {  
    for (var i = 0; i < 5; i++) {   
        closures[i](i); 
    }
}
create();
run();
</script> 
```

# inno-setup - 如何配置 Inno Setup 以卸载所有内容？

> ID：643547
> 
> 赞同：24
> 
> 时间：2009-03-13T16:29:13.797
> 
> 标签：inno-setup

我是 Inno Setup 的新手。卡在一个问题上〜如何配置卸载部分以删除由应用程序创建的所有文件、文件夹、子文件夹，甚至新文件/文件夹等（换句话说，100% 删除应用程序和相关文件）。

我在这里和他们的论坛上搜寻，结果空无一物。任何人都可以向我指出有关如何执行此操作的文档、常见问题解答等吗？

**更新**

感谢到目前为止的所有反馈（非常棒）。所以看起来我可以使用卸载部分中的 {app}*.* 指令删除所有内容。看起来每个人都反对它。**所以现在的问题变成了**（我想知道这是否应该是一个全新的问题）在卸载过程中是否有一种方法可以询问用户“您要删除与此应用程序关联的所有项目文件吗？” 如果他们回答是，运行卸载 {app}*.* 块？

谢谢 -

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-13T16:45:28.267

我认为推荐的方法是在卸载部分指定要删除的内容。原因是，如果用户出于某种原因决定将他们自己的文件放在他们不想删除的安装目录中，或者保存他们可能想要保留的数据（也许他们卸载是为了安装更新的版本？ )

话虽如此，我不知道脚本是什么，但如果您使用 ISTool（强烈推荐），只需进入卸载删除部分并添加您想要删除的内容。它应该在一个漂亮的 GUI 中显示所有可能的选项并为您生成脚本。

编辑：来自 Inno Setup 文档的示例：

```
[UninstallDelete]
Type: files; Name: "{win}\MYPROG.INI" 
```

但他们强烈你不会做类似的事情

```
[UninstallDelete]
Type: files; Name: "{app}\*.*" 
```

> 注意：不要试图在这里使用通配符来删除 {app} 目录中的所有文件。我强烈建议不要这样做，原因有两个。首先，用户通常不喜欢在没有警告的情况下删除他们放在应用程序目录中的数据文件（例如，他们可能只是卸载它，因为他们想将其移动到不同的驱动器）。如果需要，最好让最终用户手动删除它们。另外，如果用户不小心将程序安装在错误的目录（例如C:\WINDOWS），然后又去卸载它，可能会造成灾难性的后果。再说一次，不要这样做！

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-16T09:55:55.460

您可能应该将此作为一个全新的问题，但我也会在这里回答您更新的问题。查看Inno 安装文档中的**“Pascal 脚本：卸载代码”部分。**

举例说明如何在卸载过程中有条件地删除数据文件：

```
[Code]

procedure DeleteBitmaps(ADirName: string);
var
  FindRec: TFindRec;
begin
  if FindFirst(ADirName + '\*.*', FindRec) then begin
    try
      repeat
        if FindRec.Attributes and FILE_ATTRIBUTE_DIRECTORY <> 0 then begin
          if (FindRec.Name <> '.') and (FindRec.Name <> '..') then begin
            DeleteBitmaps(ADirName + '\' + FindRec.Name);
            RemoveDir(ADirName + '\' + FindRec.Name);
          end;
        end else if Pos('.bmp', AnsiLowerCase(FindRec.Name)) > 0 then
          DeleteFile(ADirName + '\' + FindRec.Name);
      until not FindNext(FindRec);
    finally
      FindClose(FindRec);
    end;
  end;
end;

procedure CurUninstallStepChanged(CurUninstallStep: TUninstallStep);
begin
  if CurUninstallStep = usUninstall then begin
    if MsgBox('Do you want to delete all data files?', mbConfirmation,
        MB_YESNO) = IDYES 
    then begin
      DeleteBitmaps(ExpandConstant('{app}'));
    end;
  end;
end; 
```

但是根据您需要清理的东西的数量，您最好创建一个特殊的帮助程序，它是安装的一部分，并且可以在卸载应用程序期间执行（使用*[UninstallRun]*中的条目）部分）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-03-19T04:04:44.970

有时需要删除在安装时最初未写入用户磁盘的文件。其中一种情况是您的应用程序在启动时会自行更新。可以以这种方式将不属于卸载程序的新文件添加到磁盘中。

对于这种情况，我建议您创建一个“补丁清单”文件，该文件会记录 {app} 目录中应包含哪些文件。在下面找到从 {app} 目录中名为“patch_manifest.txt”的文件中读取的代码示例

```
procedure CurUninstallStepChanged(CurUninstallStep: TUninstallStep);
var
  i: Integer;
  arrayLen: Longint;
  item: String;
  itemsToDelete: Array of String;
begin
  case CurUninstallStep of
    usUninstall:
      begin
        LoadStringsFromFile(ExpandConstant('{app}') + '\patch_manifest.txt', itemsToDelete);
        arrayLen := GetArrayLength(itemsToDelete);
        for i := 0 to arrayLen-1 do
          begin
          item := ExpandConstant('{app}') + '\' + itemsToDelete[i];
          if FileExists(item) then
            DeleteFile(item);
          if DirExists(item) then
            RemoveDir(item);
          end;
      end;
  end;
end; 
```

和 patch_manifest.txt 的样本

```
data/something_here.dat
data/moredatahere.dat
data/
Launcher.exe
patch_manifest.txt 
```

注意：patch_manifest 中的行顺序很重要。目录中的所有文件应首先列出，然后是目录 - 非空目录不能删除。

您的应用程序应该附带一个 patch_manifest，并且 patch_manifest 应该随每个补丁更新。将此作为构建过程的一部分，这样您就不会忘记更新它！

即使提示用户，也不要使用通配符 ( *. ) 删除，这一点非常重要。*卸载程序具有提升的权限，这可能会破坏用户的计算机。以用户不小心将您的应用程序安装到 C:\Windows\ 或 C:\Program Files 为例。

另一个好主意是通过在删除之前执行 MD5 检查来验证该文件实际上是“您的文件”。在这种情况下，您的 patch_manifest.txt 不仅包括文件的相对路径，还包括 MD5 校验和。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-13T16:51:24.133

您不能使用 InnoSetup 卸载它没有安装的任何东西，而且您不应该这样做。如果我安装了一个应用程序，输入了大量数据，然后决定使用其他东西来代替从你的应用程序中读取这些数据，我会非常不高兴。如果您的卸载杀死了我已经完成的所有工作，我可能会很想来找您。而且可能不会给你买杯咖啡。

或者考虑一下我在评估几个过程中安装您的应用程序的情况。我尝试了这些应用程序，并继续使用您的应用程序，因为我更喜欢它，并且每次输入更多数据。然后我决定暂时不做任何事情，所以我删除了所有测试应用程序。一周后，我决定我现在需要使用你的应用程序，然后重新安装它。哎呀！我所做的所有我现在想使用的测试工作都消失了。

以上就是为什么，当您卸载应用程序时，它会留下您在文件夹中创建的任何内容，例如配置文件、数据文件等。它不知道您希望它对它们做什么，所以它不理会它们。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-09-18T05:00:41.527

这应该可以解决问题：

```
[Dirs]
Name: "{app}"; Flags: uninsalwaysuninstall 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2018-11-14T10:05:54.680

在 Inno Setup Studio 中添加删除文件/文件夹项。或者直接使用脚本如下。

**[生成的代码示例]**

```
[UninstallDelete]
Type: filesandordirs; Name: "{app}\unnecessary_files" 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-02-17T04:38:18.060

我想删除`gData.dat`在安装文件夹中运行时创建的

对我来说工作得很好

```
[UninstallDelete]
Type: files; Name: "{app}\gData.dat" 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-13T16:36:48.227

如果您没有为条目指定“uninsneveruninstall”，那不是默认设置吗？

编辑 - 对不起，我没有意识到你在谈论新创建的数据文件。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2015-03-12T11:34:23.830

要删除我使用的所有内容：

```
[UninstallDelete]
Type:files; Name: "{app}" 
```

# linux - Linux 文件夹权限

> ID：643553
> 
> 赞同：3
> 
> 时间：2009-03-13T16:31:17.723
> 
> 标签：linux

在我的办公室，我们有一个这样的网络目录结构：

```
/jobs/2004/3999-job_name/...
/jobs/2004/4000-job_name/... 
```

问题是员工重命名了“4000-job_name”文件夹（这反过来又破坏了其他依赖名称与数据库一致的东西）。

如何阻止用户重命名父文件夹，同时仍然允许他们完全控制该文件夹的内容？

请记住，这是 Windows 用户将访问的 Samba 共享。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-13T16:33:05.113

我想你想这样做：

```
chmod a=rx /jobs     #chdir and lsdir allowed, modifying not
chmod a=rwx /jobs/*  #allow everything to everyone in the subdirectories 
```

由于目录`/jobs/*`实际上是文件，`/jobs`因此如果没有`/jobs`. 在每个人的子目录中，`/jobs/`都可以使用上面的命令做任何事情。

此外，请确保在添加新目录时将其权限设置为 rwx。

（由 Bill K 编辑以修复示例——解决方案是正确的，但由于添加了奇怪的颜色，他误读了问题）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-13T22:07:20.863

问题已经回答了，所以我只想做一个简短的说明：在您的问题中，您可以互换使用术语“文件夹”和“目录”。这两者非常不同，根据我的经验，99% 的 Unix 权限问题都与混淆两者有关。记住：Unix 有目录，而不是文件夹。

* * *

编辑：文件夹是粘在一起的两块纸板，其中*包含*文件。因此，文件夹是一个容器，它实际上包含它所保存的文件。因此，显然一个文件一次只能在一个容器中。要重命名文件，您不仅需要访问文件夹，还需要访问文件。删除文件也一样。

目录OTOH*本身就是*一个文件。*[事实上，这正是旧 Unix 文件系统中目录的实现方式：只是带有特殊标志的常规文件，您甚至可以在编辑器中打开它们并更改它们。]*它包含从名称到位置的映射列表（想想电话目录，或者一个大仓库）。*[在 Unix 中，这些映射称为**链接**或**硬**链接。]*由于目录只包含文件的名称，而不是文件本身，同一个文件可以以不同的名称存在于多个目录中。更改文件名（或更准确地说，更改文件名*）*一个文件的名称，因为它可以有多个），您只需要对目录而不是文件的写访问权。删除文件也一样。嗯，实际上，你*不能*删除一个文件，你只能删除目录中的一个条目——其他目录中可能还有其他条目指向该文件。*[这就是为什么调用`unlink`而不是删除文件的系统调用/库函数的原因`delete`：因为您只是删除了链接，而不是文件本身；如果没有更多指向该文件的链接，该文件将自动“收集垃圾”。]*

这就是为什么我认为 Unix 目录的文件夹隐喻是错误的，甚至是危险的。我所在的一个 Unix 邮件列表中的第一个安全问题是“为什么 A 可以删除 B 的文件，即使他没有写权限？” 答案是，他只需要目录的写权限。因此，由于文件夹的隐喻，人们认为他们的文件是安全的，即使他们不是。使用目录隐喻，更容易解释发生了什么：如果我想从我的电话簿中删除你，我不必追捕你并杀死你，我只需要一支铅笔！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-13T23:20:41.157

如果您让用户的父目录--/jobs/2004/--non-writable，他们将无法重命名该文件夹。

我在自己的机器上做了以下实验来说明这一点：

```
ndogg@seriallain:/tmp$ sudo mkdir jobs
ndogg@seriallain:/tmp$ sudo mkdir jobs/2004
ndogg@seriallain:/tmp$ sudo mkdir jobs/2004/3999-job_name/
ndogg@seriallain:/tmp$ cd jobs/2004/
ndogg@seriallain:/tmp/jobs/2004$ sudo chown ndogg.ndogg 3999-job_name/
ndogg@seriallain:/tmp/jobs/2004$ ls -alh
total 12K
drwxr-xr-x 3 root  root  4.0K 2009-03-13 18:23 .
drwxr-xr-x 3 root  root  4.0K 2009-03-13 18:23 ..
drwxr-xr-x 2 ndogg ndogg 4.0K 2009-03-13 18:23 3999-job_name
ndogg@seriallain:/tmp/jobs/2004$ touch 3999-job_name/foo
ndogg@seriallain:/tmp/jobs/2004$ mv 3999-job_name/ blah
mv: cannot move `3999-job_name/' to `blah': Permission denied 
```

# c# - 如何从 WinForms 迁移到 WPF

> ID：643564
> 
> 赞同：2
> 
> 时间：2009-03-13T16:33:15.567
> 
> 标签：c#, .net, wpf, winforms, user-interface

我以前很少使用 WPF，有些东西看起来很不一样。来自 winforms 背景，哪些事情看起来会有所不同，需要一段时间才能弄清楚。

在我的脑海中，我记得如果我没记错的话，我无法像在 winforms 中那样指定在树视图控件中选择了哪些节点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T16:45:24.587

我记得整个 MVVM 原理..

但现在好了..我们现在是好朋友了！:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T16:53:24.427

哦，从哪里开始？WPF 和 WinForms 对我来说似乎*非常*不同。使用标记定义布局的概念是完全不同的，尽管类似于 Web 开发。您需要明确选择布局容器（用于多个元素）这一事实很新颖。我记得尝试直接在 Window 中添加一堆元素并变得非常困惑......

我认为要利用 WPF 所提供的所有优势，您需要具备 WPF 思维方式。例如，您不必使用样式、模板和绑定，但这些概念正是 WPF 的强大之处。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T17:01:15.157

正如丹尼尔所说，WPF 是不同的，它需要不同的心态。在进行 Winforms 或其他传统的 UI 端开发时，你必须忘记你所做/学到的所有 UI 端假设。我在这个网站上遇到了很多类似的问题。下面列出了一些有趣的曾经。你可以在这里找到很多。

*   [WPF 开发中最常见的错误是什么？](https://stackoverflow.com/questions/322612/what-are-the-most-common-mistakes-made-in-wpf-development/322620#322620)
*   [如何开始 WPF 开发？](https://stackoverflow.com/questions/129772/how-to-begin-wpf-development/129867#129867)
*   [Winforms 什么时候是 WPF 的正确选择？](https://stackoverflow.com/questions/388711/when-is-winforms-the-correct-choice-vs-wpf)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T16:49:42.563

对于您在树视图中选择的节点，ModelView ViewModel 方法效果很好。人们现在已经为这种事情制定了良好的设计模式，使过程变得更加容易。

# javascript - 任何人都使用 Pyjamas (pyjs) python to javascript 编译器（如 GWT ..）

> ID：643565
> 
> 赞同：18
> 
> 时间：2009-03-13T16:33:22.727
> 
> 标签：javascript, python, gwt

有人用过这个吗？我没有大量的 Javascript 背景，这个库看起来可以加快速度。

www.pyjs.org

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-08T17:20:21.453

是的。我。我是首席开发人员。顺便去groups.google.com“pyjamas-dev”打个招呼。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-04-15T01:48:44.863

是的，我用过。太奇妙了！我认为它比基于 Java 的 GWT 更容易使用。我发现上面的 Google Code wiki 非常实用：[http ://code.google.com/p/pyjamas/w/list](http://code.google.com/p/pyjamas/w/list)

如果您刚刚开始使用它，那么一定要查看展示：[http](http://pyjs.org/showcase/Showcase.html) ://pyjs.org/showcase/Showcase.html以获取可用的片段/小部件

截至目前，它在 M$ Windows 上不受支持，但在 Linux 上运行良好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T18:59:06.853

是的。我已经使用 pyjs 构建了扫雷游戏：[http ://pymines.appspot.com/](http://pymines.appspot.com/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-06-12T23:42:41.520

是的，它在 Windows 上运行良好（它是一个编译器：你只需要 python，即可运行到 javascript 的转换）。但是，如果您正在考虑 pyjamas-desktop，0.6 添加了对 MSHTML 作为引擎之一的支持，所以它也可以。

# ruby-on-rails - Howto：“访问过您个人资料的用户...”

> ID：643579
> 
> 赞同：1
> 
> 时间：2009-03-13T16:37:51.280
> 
> 标签：ruby-on-rails

我想向每个访问过她/他的用户资料的用户展示。起初它看起来很简单，因为[作为可读](http://github.com/mbleigh/acts-as-readable/tree/master)插件可以满足我的一切需求。但是，此插件不适用于用户模型。

如果将来我决定将访问者添加到文章、相册等中怎么办？

```
/usr/local/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/base.rb:1833:in `method_missing': undefined local variable or method `acts_as_readable' for #<Class:0xb70d1bfc> (NameError)
        from /home/www/ror/app/models/user.rb:22
        from /usr/local/lib/ruby/gems/1.8/gems/activesupport-2.2.2/lib/active_support/dependencies.rb:382:in `load_without_new_constant_marking'
        from /usr/local/lib/ruby/gems/1.8/gems/activesupport-2.2.2/lib/active_support/dependencies.rb:382:in `load_file'
        from /usr/local/lib/ruby/gems/1.8/gems/activesupport-2.2.2/lib/active_support/dependencies.rb:521:in `new_constants_in'
        from /usr/local/lib/ruby/gems/1.8/gems/activesupport-2.2.2/lib/active_support/dependencies.rb:381:in `load_file'
        from /usr/local/lib/ruby/gems/1.8/gems/activesupport-2.2.2/lib/active_support/dependencies.rb:256:in `require_or_load'
        from /usr/local/lib/ruby/gems/1.8/gems/activesupport-2.2.2/lib/active_support/dependencies.rb:427:in `load_missing_constant'
        from /usr/local/lib/ruby/gems/1.8/gems/activesupport-2.2.2/lib/active_support/dependencies.rb:77:in `const_missing'
         ... 31 levels...
        from /usr/local/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/../lib/mongrel/command.rb:212:in `run'
        from /usr/local/lib/ruby/gems/1.8/gems/mongrel-1.1.5/bin/mongrel_rails:281
        from /usr/local/bin/mongrel_rails:19:in `load'
        from /usr/local/bin/mongrel_rails:19 
```

有谁知道可以做到这一点的替代插件？（user1.users_who_read 等）遗憾的是，[行为可读性](http://github.com/mbleigh/acts-as-readable/tree/master)在用户模型中不起作用。将此功能添加到选定的模型中非常有用。

最好的祝福。阿斯比约恩·莫雷尔。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T16:42:03.813

为什么不自己滚动？

```
class User < ActiveRecord::Base
  has_many :user_visits
  has_many :visitors, :through => :user_visits, :source => :visitor
end

class UserVisit < ActiveRecord::Base
  # user_id :integer
  # visitor_id :integer
  # visited_at :datetime

  belongs_to :user
  belongs_to :visitor, :foreign_key => 'visitor_id', :class_name => 'User'
end

User.first.visitors = [user_1, user2] 
```

您可以使用 STI，因为您将有那么多 *viss 加入表。YMMV 因为它使缓存等事情变得复杂。如果它可以带来更快的体验，我宁愿在代码方面有一点“湿润”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T18:00:31.840

嗯，这确实给我带来了一些问题：

```
User.first.visitors
ActiveRecord::HasManyThroughSourceAssociationNotFoundError: 
Could not find the source association(s) :visitor or :visitors in model UserVisit.  
Try 'has_many :visitors, :through => :user_visits, :source => <name>'.  
Is it one of :user? 
```

我试图将 :source => :user 添加到我的用户模型中。但是，我只在执行 user.visitors 时才获得所有者。

这是我的迁移：

```
class CreateUserVisits < ActiveRecord::Migration
    def self.up
        create_table :user_visits do |t|
            t.integer :user_id
            t.integer :visit_id
        end
    end

    def self.down
    drop_table :user_visits
    end
end 
```

有什么想法吗？

# c++ - 关于设置类变量的C++问题

> ID：643581
> 
> 赞同：2
> 
> 时间：2009-03-13T16:38:36.130
> 
> 标签：c++

我对编程并不陌生，但是在使用 Java 工作之后，我又回到了 C++，并且对不是指针的类变量有点困惑。给定以下代码：

```
#include <iostream>
#include <map>

using namespace std;

class Foo {
    public:
        Foo() {
            bars[0]     = new Bar;
            bars[0]->id = 5;
        }

        ~Foo() { }

        struct Bar {
            int id;
        };

        void set_bars(map<int,Bar*>& b) {
            bars = b;
        }

        void hello() {
            cout << bars[0]->id << endl;
        }

    protected:
        map<int,Bar*> bars;
};

int main() {
    Foo foo;
    foo.hello();

    map<int,Foo::Bar*> testbars;
    testbars[0]     = new Foo::Bar;
    testbars[0]->id = 10;

    foo.set_bars(testbars);

    foo.hello();

    return(0);
} 
```

我得到了 5 和 10 的预期输出。但是，我对 C++ 中的引用和指针等缺乏了解，这让我想知道这是否真的可以在野外工作，或者一旦测试栏超出范围，它就会出错。当然，在这里，testbars 不会在程序结束之前超出范围，但是如果它是在另一个类函数中作为函数变量创建的呢？无论如何，我想我的主要问题是创建 bar 类变量作为指向地图的指针对我来说会更好/更安全吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T16:44:11.780

> 无论如何，我想我的主要问题是创建 bar 类变量作为指向地图的指针对我来说会更好/更安全吗？

不，C++ 在这方面和其他方面都不像 Java。如果您发现自己经常使用指针并为它们分配新的对象，那么您可能做错了什么。为了学习正确的做事方式，我建议获取Koenig & Moo的[Accelerated C++的副本，](http://www.acceleratedcpp.com/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-13T16:46:46.813

成员变量`bars`是“字典”类/关联数组类的单独实例。所以当它在 set_bars 中赋值时，参数的内容`b`被复制到`bars`. 因此无需担心 和 的相对生命周期`foo`，`testbars`因为它们是独立的“类值”实体。

Bar 对象的生命周期存在更多问题，目前这些对象永远不会被删除。如果您在某处添加代码来删除它们，那么您将引入另一个问题，因为您正在复制 Bar 对象的地址（而不是对象本身），因此您有两个不同的映射指向的同一个对象。一旦对象被删除，另一个地图将继续引用它。这是你应该避免的事情，就像 C++ 中的瘟疫一样！指向已分配对象的裸指针`new`是等待发生的灾难。

引用（用 & 声明）在对象生命周期方面与指针没有区别。为了允许您从两个地方引用同一个对象，您可以使用指针或引用，但这仍然会给您带来释放问题。

您可以通过使用类似 的类来解决解除分配问题`shared_ptr`，任何最新的 C++ 环境（在 中）都应包含该类`std::tr1`。但是你可能会遇到循环指针网络的问题（例如，A 指向 B，B 指向 A），它不会被自动清理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T16:46:03.663

对于每个新的，您都需要相应的删除。如果您在调用 delete 后尝试引用内存 - 无论在哪里 - 那么程序确实会“呕吐”。

如果你不这样做，你会没事的，就这么简单。

您应该设计您的类，使内存的所有权是明确的，并且您**知道**对于每个分配，您都在进行平等的释放。永远不要假设另一个类/容器会删除您分配的内存。

希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T23:15:30.920

> 我对编程并不陌生，但是在使用 Java 工作之后，我又回到了 C++，并且对不是指针的类变量有点困惑。

混淆似乎来自堆上的数据和不一定在堆上的数据的组合。这是造成混淆的常见原因。

在您发布的代码中，`bars`不是指针。因为它在类范围内，所以它会一直存在，直到包含它的对象 ( `testbars`) 被销毁。在这种情况下`testbars`，它是在堆栈上创建的，因此当它超出范围时它将被销毁，无论该范围嵌套多深。当`testbars`被销毁时，子对象`testbars`（无论它们是父类还是对象中包含的`testbars`对象）将让它们的析构函数在那个确切的时刻以明确定义的顺序运行。

这是 C++ 的一个非常强大的方面。想象一个具有 10 行构造函数的类，它打开网络连接、在堆上分配内存并将数据写入文件。想象一下，类的析构函数撤消了所有这些（关闭网络连接、释放堆上的内存、关闭文件等）。现在想象创建这个类的对象在构造函数中途失败（例如，网络连接断开）。程序如何知道析构函数的哪些行将撤消构造函数中成功的部分？没有通用的方法可以知道这一点，因此该对象的析构函数不会运行。

现在想象一个包含十个对象的类，每个对象的构造函数都做了一件必须回滚的事情（打开网络连接，在堆上分配内存，将数据写入文件等），而析构函数这些对象中的每一个都包含回滚操作所需的代码（关闭网络连接、释放对象、关闭文件等）。如果只有五个对象被成功创建，那么只有这五个对象需要被销毁，并且它们的析构函数**将**在那个确切的时间运行。

如果`testbars`是在堆上创建的（通过`new`），那么它只会在调用时被销毁`delete`。一般来说，使用堆栈上的对象要容易得多，除非有某种原因使对象比创建它的范围更持久。

这让我想到`Foo::bar`. `Foo::bars`是`map`指堆上的对象。好吧，在这个代码示例中，它指的是指针，指的是在堆上分配的对象（指针也可以指在堆栈上分配的对象）。在您发布的示例中，这些指针引用的对象永远不会是`delete`d，并且因为这些对象位于堆上，您会遇到（小）内存泄漏（操作系统在程序退出时清理）。根据 STL，当它们被销毁时 ，`std::maps`就像`Foo::bar`它们**所引用的指针一样。** [对于这个问题， Boost](http://boost.org)有一些解决方案。在您的情况下，简单地不在堆上分配这些对象可能是最简单的：`delete`

```
#include <iostream>
#include <map>

using std::map;
using std::cout;

class Foo {
    public:
        Foo() {
            // normally you wouldn't use the parenthesis on the next line
            // but we're creating an object without a name, so we need them
            bars[0] = Bar();
            bars[0].id = 5;
        }

        ~Foo() { }

        struct Bar {
            int id;
        };

        void set_bars(map<int,Bar>& b) {
            bars = b;
        }

        void hello() {
            cout << bars[0].id << endl;
        }

    protected:
        map<int,Bar> bars;
};

int main() {
    Foo foo;
    foo.hello();

    map<int,Foo::Bar> testbars;
    // create another nameless object
    testbars[0] = Foo::Bar();
    testbars[0].id = 10;

    foo.set_bars(testbars);
    foo.hello();
    return 0;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T16:46:20.450

在下面的代码中，您可以传递 Bars 的映射，然后就可以在类之外修改 Bars。

但。但除非你再次调用 set_bars。

最好由一个对象负责 Bars 的创建和删除。在你的情况下这是不正确的。

如果您愿意，可以使用 boost::shared_ptr< Bars > 而不是 Bars*。那将是更像 Java 的行为。

```
class Foo {
public:
    Foo() {
        bars[0]     = new Bar;
        bars[0]->id = 5;
    }

    ~Foo() { freeBarsMemory(); }

    struct Bar {
        int id;
    };

    typedef std::map<int,Bar*> BarsList;

    void set_bars(const BarsList& b) {
        freeBarsMemory();
        bars = b;
    }

    void hello() {
        std::cout << bars[0]->id << std::endl;
    }

protected:
    BarsList bars;

    void freeBarsMemory()
    {
        BarsList::const_iterator it = bars.begin();
        BarsList::const_iterator end = bars.end();

        for (; it != end; ++it)
            delete it->second;

        bars.clear();
    }
}; 
```

# bash - 如何在 bash 中汇总文件大小，按日期将结果分组在一起？

> ID：643584
> 
> 赞同：13
> 
> 时间：2009-03-13T16:38:54.587
> 
> 标签：bash, file

在我使用的 Linux 服务器上，一个进程以随机间隔写入随机命名的文件。这是一个小示例，显示了文件大小、修改日期和时间以及文件名：

```
27659   2009-03-09  17:24  APP14452.log
0       2009-03-09  17:24  vim14436.log
20      2009-03-09  17:24  jgU14406.log
15078   2009-03-10  08:06  ySh14450.log
20      2009-03-10  08:06  VhJ14404.log
9044    2009-03-10  15:14  EqQ14296.log
8877    2009-03-10  19:38  Ugp14294.log
8898    2009-03-11  18:21  yzJ14292.log
55629   2009-03-11  18:30  ZjX14448.log
20      2009-03-11  18:31  GwI14402.log
25955   2009-03-12  19:19  lRx14290.log
14989   2009-03-12  19:25  oFw14446.log
20      2009-03-12  19:28  clg14400.log 
```

（请注意，有时文件大小可能为零。）

我想要的是一个 bash 脚本来总结文件的大小，按日期分解，产生类似这样的输出（假设我的算术是正确的）：

```
27679 2009-03-09
33019 2009-03-10
64527 2009-03-11
40964 2009-03-12 
```

结果将显示一段时间内的活动趋势，并突出显示异常繁忙的日子。

在 SQL 中，操作很简单：

```
SELECT SUM(filesize), filedate
FROM files
GROUP BY filedate; 
```

现在，这在 Perl 或 Python 中可能很容易，但我真的更喜欢 bash shell 或 awk 解决方案。在 bash 中按日期对文件进行分组对我来说似乎特别棘手（特别是如果你不能假设特定的日期格式）。我想对大小求和可以循环完成，但有没有更简单、更优雅的方法？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-13T17:58:22.977

我经常使用 awk 的这个成语：

```
awk '{sum[$2]+= $1;}END{for (date in sum){print sum[date], date;}}' 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-12-12T14:53:09.193

只有文件，递归地，按日期排序并求和

```
find ./ -type f -printf '%TY-%Tm-%Td %s\n'|awk '{sum[$1]+= $2;}END{for (date in sum){print date, sum[date];}}'|sort 
```

仅来自当前目录的文件，按日期排序并求和

```
find ./ -maxdepth 1 -type f -printf '%TY-%Tm-%Td %s\n'|awk '{sum[$1]+= $2;}END{for (date in sum){print date, sum[date];}}'|sort 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-10-21T07:24:33.937

(查找 ... | xargs stat "--printf=%s+"; echo 0) | 公元前

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-13T18:32:59.633

遵循 ashawley 和 vartec 的建议，以下“单线”非常出色：

```
ls -l --time-style=long-iso *log |
    awk '{sum[$6]+= $5;}END{for (s in sum){print sum[s], s;}}' |
    sort -k2 |
    column -t 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-13T21:01:28.403

考虑到在 Linux 上你可能有 GNU awk，所以你不需要其他命令：

```
ls -l --time-style=long-iso * | 
  WHINY_USERS=-9 awk 'END {
    for (s in sum)
      printf "%-15s\t%s\n", sum[s], s
      }
  { sum[$6]+= $5 }
  ' 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-26T11:14:37.623

我创建了一个工具，它允许对文本数据执行类似 SQL 的查询，包括分组、连接、条件和其他内容。您可以在[这里](https://github.com/harelba/q)查看详细信息。

# xml - 在 XSLT 中，如何获取 XML 文件的文件创建/修改日期？

> ID：643592
> 
> 赞同：1
> 
> 时间：2009-03-13T16:40:46.047
> 
> 标签：xml, xslt, xslt-1.0, datecreated

我想知道我的 XSLT 代码当前正在处理的 XML 文件的文件创建/修改日期。

我正在处理一个 XML 文件并生成一个 HTML 报告。我想在 HTML 报告中包含源 XML 文件的日期。

注意：我正在使用 C# .NET 2008 并使用内置的 XslCompiledTransform 类。此后，我使用此处其他答案的输入找到了解决方案（单独的答案）。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T16:44:04.357

创建/修改日期必须写入 XML 文件，否则您无法找到它，除非您以某种方式与文件系统通信。

这个问题有点相关：[xslt-how-to-get-file-names-from-a-certain-directory](https://stackoverflow.com/questions/627226/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-13T18:03:37.393

XSLT 可以访问的唯一内容是源树的节点、通过`document()`函数读取的文档中的节点、XSLT 模板本身中的节点（同样通过`document()`函数）以及作为参数传递给转换的值。

因此，如果您希望文件名及其创建/修改日期可用于您的转换，您必须将它们放在这些地方之一。

可以实现 XSLT 扩展方法来执行此操作，具体取决于您使用的平台，但这是我的最后选择。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-13T20:52:53.307

根据 Kaarel 和 Robert 的建议，我得到了以下解决方案：

在 C# 中获取文件修改日期并将其传递给 XSLT 处理器，如下所示：

```
XmlTextWriter tw = new XmlTextWriter(htmlPath, null);
tw.Formatting = Formatting.Indented;
tw.Indentation = 4;

XsltArgumentList args = new XsltArgumentList();
FileInfo fi = new FileInfo(xmlPath);
args.AddParam("FileDate", string.Empty,
   fi.LastWriteTime.Date.ToShortDateString());

XslCompiledTransform xslt = new XslCompiledTransform();
xslt.Load(xsltPath);
xslt.Transform(xmlPath, args, tw);
tw.Close(); 
```

然后在 XSLT 代码中，定义并访问该参数作为参数，如下所示：

```
<xsl:param name="FileDate"/>

<xsl:text>Revision Date: </xsl:text>
<xsl:value-of select="$FileDate"/> 
```

# c# - C# 设计问题 - 静态变量？

> ID：643593
> 
> 赞同：0
> 
> 时间：2009-03-13T16:40:51.650
> 
> 标签：c#

我有以下类层次结构

```
public abstract BaseClass : System.Web.UI.UserControl
{

  public virtual void Process(string sType)
  {
     //Do something
     //Here I want to create a CSV list Ex: "type1, type2"
     //Do I need to create a static variable? There might be several controls calling //Process. I need to scope it to the UserControl
  }
} 
```

在继承自 BaseClass 的用户控件中

```
public void ProcessParams()
{
  base.Process("type1");
  base.Process("type2");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T16:45:47.940

我会避免在静态中执行此操作，除非您想存储所有实例中的参数。您可以将一个集合添加到您的基类中，或者将一个 IEnumerable 作为 Process() 的参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T16:49:22.890

此外，您可以使用单例模式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T16:50:35.573

我不确定您具体要完成什么，但我认为没有任何静态变量的理由。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T16:53:56.127

如果您有基于实例的子类（无论它们是否是 UserControls），那么您就不想使用静态字段。您需要使用实例字段，以便您的 Process() 方法根据上下文向每个单独的用户控件返回适当的值。

如果您希望 Process() 的返回值在 BaseClass 的所有子类实例中相同，请使用静态字段。希望这可以帮助！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T17:34:56.323

要创建传递给基类 Process 方法的所有字符串的单个列表，您需要一个静态成员。

```
public abstract BaseClass : System.Web.UI.UserControl
{
  private static List<string> collection = new List<string>();
  private static string csvString = String.Empty;
  public virtual void Process(string sType)
  {
     //to create a list
     collection.Add(sType);
     //Or to create just a csv string
     csvString += sType + ",";
  }
} 
```

不过，重要的是要注意，如果子类覆盖了功能，那么您当前如何将方法声明为公共虚拟可能并不总是被调用。

# algorithm - 提出这个问题的最阴险的方式是什么？

> ID：643594
> 
> 赞同：7
> 
> 时间：2009-03-13T16:40:55.940
> 
> 标签：algorithm, analysis, puzzle

到目前为止我最好的镜头：

> 运送车辆需要进行一系列运送（d [1] ,d [2] ,...d [n]），并且可以按任何顺序进行 - 换句话说，集合 D = {d [1]的所有可能排列， d [2] ,...d [n] } 是有效的解决方案——但具体的解决方案需要在路线的一端离开基站之前确定（假设需要在车辆 LIFO 中装载包裹，例如）。
> 
> 此外，各种排列的成本也不相同。[它可以计算为 d i -1]和 d [i]之间行进距离的平方和，其中 d [0]被视为基站，但需要注意的是，任何涉及方向改变的段的成本是其 3 倍（想象一下这是在铁路或气动管上发生的，并且备份会干扰其他交通）。
> 
> 给定一组传递`D`表示为它们与基站的距离（所以`abs(d`[i] `-d`[j]`)`是两个传递之间的距离）和一个`permutations(D)`将连续产生每个排列的迭代器，找到一个成本小于或等于任何排列的排列其他排列。

现在，从这个描述中直接实现可能会导致这样的代码：

```
function Cost(D) ...

function Best_order(D)
    for D1 in permutations(D)
        Found = true
        for D2 in permutations(D)
            Found = false if cost(D2) > cost(D1)
        return D1 if Found 
```

这是 O(n*n!^2)，例如非常糟糕——尤其是与有洞察力的人通过简单地对 D 进行排序会发现的 O(n log(n)) 相比。

我的问题：你能想出一个合理的问题描述，它自然会导致粗心的人进入*更糟糕*（或不同程度糟糕）的排序算法实现吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-13T17:49:48.503

*我假设你在面试中使用这个问题来看看申请人是否能在一个看似复杂的问题中注意到一个简单的解决方案。*

[这个假设是不正确的——MarkusQ]

你提供的信息太多。

解决这个问题的关键是意识到点是一维的，并且只需要排序。为了使这个问题更加困难，尽可能地隐藏这个事实。

最大的线索是距离公式。它引入了改变方向的惩罚。我想到的第一件事就是尽量减少这种惩罚。为了消除惩罚，我必须按某个方向对它们进行排序，这种排序是自然的排序顺序。

我会取消改变方向的惩罚，这太过分了。

另一个主要线索是算法的输入值：整数列表。给他们一个排列列表，甚至是*所有*排列。这使他们认为实际上可能需要 O(n!) 算法。

我将其表述为：

> 给定 n 个交付位置的所有可能排列的列表，其中每个交付排列 (d [1] , d [2] , ..., d [n] ) 的成本定义为：
> 
> ![](https://latex.codecogs.com/gif.latex?%5Csum_%7Bi=1%7D%5E%7Bn-1%7D%5Csqrt[]%7B(d_%7Bi%7D-d_%7Bi+1%7D)%5E2%7D)
> 
> 返回排列 P 使得 P 的成本小于或等于任何其他排列。

真正需要做的就是在第一个排列中读取并对其进行排序。

如果他们构建一个循环来比较成本，问他们算法的 big-o 运行时间是多少，其中 n 是交付位置的数量（另一个陷阱）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T16:48:22.457

这不是一个直接的答案，但我认为需要进一步澄清。

d [i]是否允许为负数？如果是这样，据我所知，仅排序是不够的。

例如：

`d`[0] = 0

`deliveries = (-1,1,1,2)`

在这种情况下，最佳路径似乎是`1 > 2 > 1 > -1`.

编辑：这实际上可能不是最佳路径，但它说明了这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-18T16:51:36.950

你可以改写它，首先找到最佳解决方案，如

“给我一个证明，证明以下说服对于以下规则集是最优的，其中最优意味着最小的数字来自所有阶段成本的总和，同时考虑到所有阶段`(A..Z)`只需要出现一次。

说服：

```
A->C->D->Y->P->...->N 
```

阶段费用：

```
A->B = 5,
B->A = 3,
A->C = 2,
C->A = 4,
...
...
...
Y->Z = 7,
Z->Y = 24." 
```

那应该让某人忙一阵子。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-22T07:49:09.757

这让我想起了[背包问题](http://en.wikipedia.org/wiki/Knapsack_problem)，而不是旅行推销员。但是背包也是一个 NP-Hard 问题，因此如果他们将您的问题与背包相关联，您可能可以欺骗人们使用动态编程来想出一个过于复杂的解决方案。基本问题在哪里：

> 可以在不超过重量 W 的情况下达到至少 V 的值吗？

现在问题是当 V 是唯一的时可以找到一个相当好的解决方案，您的距离，如下所示：

> 每种类型的物品 j 具有每单位重量的不同值 (vj = pj/wj) 的背包问题被认为是最简单的 NP 完全问题之一。实际上，经验复杂度为 O((log n)2) 量级，并且可以非常快速地解决非常大的问题，例如，在 2003 年，使用商用个人计算机[1](http://en.wikipedia.org/wiki/Knapsack_problem)解决 n = 10,000 实例所需的平均时间低于 14 毫秒。

所以你可能想说明几个站点/包裹可能共享同一个 vj，邀请人们思考真正困难的解决方案：

> 然而，在多个项目共享相同值 vj 的退化情况下，在 vj = 常数是复杂度为 O(2N/2N) 的子集和问题的极端情况下变得更加困难。

因此，如果您将每个值的权重替换为每个值的距离，并声明几个距离实际上可能共享相同的值，退化，有些人可能会落入这个陷阱。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T16:49:03.500

这不只是（NP-Hard）[旅行商问题](http://en.wikipedia.org/wiki/Travelling_salesman_problem)吗？你似乎不太可能让它变得更难。

也许用措辞来表达问题，使实际算法不清楚——例如，将路径描述为单轨铁路线，这样人们就不得不从领域知识中推断出回溯成本更高。

如果以某人很想进行递归比较的方式来描述问题，例如“您能否通过使用最佳（迄今为止）结果的最佳最大子集来加速算法”？

顺便说一句，这样做的目的是什么——听起来意图是折磨受访者。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-23T08:58:32.577

您需要更清楚送货卡车是否必须返回基地（使其成为往返）。如果卡车*确实*返回，那么简单的排序**不会**产生最短路线，因为从最远点到基地返回的平方成本非常高。在“出去”的路上错过一些啤酒花并在回来的路上使用它们会更便宜。

如果您欺骗某人给出错误的答案（例如，不向他们提供所有信息），那么是他们的愚蠢还是您的欺骗导致了它？

如果智者不注意自我的谎言，他们的智慧有多大？

# .net - ORM 建议 – 使用 Sprocs

> ID：643597
> 
> 赞同：1
> 
> 时间：2009-03-13T16:41:23.910
> 
> 标签：.net

好的，我有一个我知道非常固执的问题（基于我读过的所有帖子），但我需要帮助。长话短说，过去几年我一直在使用以下模型进行数据访问。

Database->Sprocs->XSD(Typed dataset, drag drop sproc in.net)-> 在 DAL 项目中 make 函数调用 XSD 创建的方法，加载所有数据然后映射到项目业务对象。

这样做的好处：

1) 轻松拖放以创建 SQL 调用

2）由于其他限制，Sprocs 几乎是最多的，并且易于添加

3）项目使用适合解决方案而不是数据库的自己的业务对象，我只是将它们映射到 C#

4）代码映射，易于重构

5）谁不喜欢所有的东西都被打字和智能感知

缺点：1）构建缓慢

2）拉数据慢（表适配器和数据集与数据读取器相比性能较差）

3) 关于空值的错误。天哪，这个 krap 可能是错误的，这会浪费很多时间。

所以这就是我一直在做的事情，而不是一个白痴，我意识到必须有更好的方法。因此，我上周一直在研究 NHiberabte、LINQ to SQL、实体框架，或者回到使用带有数据读取器和无类型的代码来完成这一切。

**所以，问题是什么是好的数据库（可能是对象的存储过程）映射器。**

我对我看过的3的想法：

1）Linq to SQL——好吧，它唯一的SQL和微软几乎都说它是一种死技术，所以看起来毫无意义。

2）实体框架——我可能需要更多地接触这个，但似乎将这些东西映射到我自己的对象会让我回到原来的位置。

3) Nhibernate——看起来很有希望，但是我讨厌编写 XML 文件，而且我目前的项目有 30 到 50 个业务对象。此外，我必须在各个领域使用存储过程。

任何人的建议或关于良好 ORM 教程的非常好的链接将不胜感激。抱歉这个问题太长了。谢谢，乔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T16:43:32.843

查看：[www.summerofnhibernate.com](http://www.summerofnhibernate.com)以及来自 Davy Brion 的关于 SPROCS 和 nHibernate 的帖子：[Sprocs 和 NHibernate](http://davybrion.com/blog/2008/11/populating-entities-from-stored-procedures-with-nhibernate/)

你也可以使用[Fluent NHibernate](http://www.fluentnhibernate.org)来避免 XML ......这真的不是那么糟糕。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T16:46:44.333

您可能要考虑：

[Fluent NHibernate](http://fluentnhibernate.org/) - 它是 NHibernate，具有更清洁、更好的 .NET 界面，因此您不必编写太多 XML 等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T16:47:29.090

关于编写 xml 文件，我很确定有一些工具可以检查你的类并为你输出 xml 文件（你可能仍然需要调整，但它比打脸要好:)） .

# c++ - 将数字列表传递给 C++ 中的函数而不首先构建数组？

> ID：643617
> 
> 赞同：3
> 
> 时间：2009-03-13T16:46:38.017
> 
> 标签：c++, arrays, function

我正在尝试构建一个以以下方式接受数组的函数：

```
int inCommon = findCommon({54,56,2,10}, 4);

int findCommon(int nums[], int len){
  for(int i=0; i<len; i++)  cout<<nums[i]<<endl;
  return 1;
} 
```

请注意，这实际上不是我的函数所做的，但我确实循环遍历了数组。我只是想确定是否可以传递像 {54,56,2,10} 这样的数组，而不必创建一个数组并传递它？（像这样：

```
int theArray[]= {54,56,2,10};
int inCommon = findCommon(theArray,4); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-13T16:58:27.037

这在当时是不可能的。然而，在下一个 C++ 标准 C++0x 中，这将使用初始化列表来完成：

```
int findCommon(std::initializer_list<int> nums)
{
    std::initializer_list<int>::iterator it;
    for (it = nums.begin() ; it != nums.end() ; ++it)
    {
        std::cout << *it << std::endl;  
    }
    return 1;
} 
```

请参阅Bjarne Stroustrup 的[此演示文稿](http://iap.cse.tamu.edu/IAP_Initializers)和Wikipedia 的[这篇文章](http://en.wikipedia.org/wiki/C%2B%2B0x#Initializer_lists)

如果您想尝试 C++0x 功能，您可以查看支持其中一些功能[的 gcc 的最新版本。](http://gcc.gnu.org/projects/cxx0x.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-13T16:51:28.783

你需要 C++0x！

[http://en.wikipedia.org/wiki/C%2B%2B0x#Initializer_lists](http://en.wikipedia.org/wiki/C%2B%2B0x#Initializer_lists)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-13T16:49:11.270

不，我相信 {} 只能用于初始化数组。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-13T20:39:39.623

[您可以使用可变参数列表](http://publications.gbdirect.co.uk/c_book/chapter9/stdarg.html)来做您想做的事情。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-13T16:57:36.680

不。是不可能的。但是您可以创建类似模板 T* arrayCreator(...) 函数来创建您的数组，
或者使用带有未指定参数计数的构造函数的数组包装器。
或创建将重载运算符逗号或 << 并将创建您的数组的对象，findCommon( arrCreator() << 1 << 2 << 3 << 5, other parammeters ) - 此方法更安全
或等待 C++ 0x 实现。

# .net - 如何从 SQL Server 2005 访问 .NET TimeZoneInfo 类？

> ID：643620
> 
> 赞同：2
> 
> 时间：2009-03-13T16:46:57.500
> 
> 标签：.net, sql-server, clr, timezone

TimeZoneInfo 类具有 MayLeakOnAbort 的主机保护属性。

这似乎阻止我从 SQL Server CLR 访问它。但是有解决方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T16:59:10.170

好，当然。您将其封装在另一个 .NET 类中，然后从 SQL Server 中的 .NET 程序集进行引用。然后，您在 SQL Server 数据库中完成禁用安全性，以便可以运行第二个类。

如果这不起作用，您可以创建一个 COM 包装器，然后创建一个 Interop 包装器，但仍然会破坏 SQL Server 中的安全性以运行该东西。

现在，如果安全性对您来说真的很重要，您可以创建一个 WCF 服务来包装您需要的位，并将其用作 SQL 代码中的服务。它本身有一点延迟，不能针对 SQL Server 中的对象工作，但它更干净。

对不起，听起来很尖刻，但我现在心情很奇怪。:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-18T22:01:10.070

将您的 CLR 过程部署为不安全：

在 Visual Studio 中右键单击项目 > 属性 > 数据库选项卡 > 权限级别

然后，要部署它，您需要配置数据库，使其接受不安全的程序集。两种选择：

> 数据库所有者 (DBO) 具有 UNSAFE ASSEMBLY 权限，并且数据库具有 TRUSTWORTHY 数据库属性；
> 
> ...或者程序集使用证书或非对称密钥签名，该证书或非对称密钥具有相应的登录名并具有 UNSAFE ASSEMBLY 权限。

# rdbms - 键值存储与 RDBM 与“云”数据库 (SDB)

> ID：643627
> 
> 赞同：6
> 
> 时间：2009-03-13T16:49:00.833
> 
> 标签：rdbms, cloud, in-memory

在过去的几年里，我设计了几个应用程序，然后不断改进性能和可伸缩性方面，我对 MySQL 领域感到很自在。我也有一些使用 memcached 为经常查询的结果集提供应用程序端加速的经验。最近，我将 Amazon SDB 作为我的主要“数据库”用于电子商务实验。

简单地说，我想到使用 SDB 服务的一个快速理由是，使用无模式数据库结构可以让我专注于我的项目的逻辑问题，并在我的数据存储中快速积累内容。也就是说，不必担心事先设置和规范化产品属性的所有可能排列；只需开始加载产品，SDB 就会记住所有可用的内容。

现在我已经设法完成了项目的前几次迭代，并且我需要为数据设置简单的接口，我遇到了我认为使用 MySQL 理所当然的问题。例如：在 select 语句中分组并限制语法以查询“项目 50 到 100”。使用 SDB 的无模式架构获得的易用性优势，我失去了查询/循环仅包含 1800 多个项目的结果集的性能损失。

现在我正在阅读诸如东京内阁之类的项目，这些项目正在扩展内存中键值存储的概念，以更快的速度提供伪关系功能（我在某处读到的 14 倍）。

我的问题：作为应用程序设计师/开发人员，我是否可以通过一些基本指南或启发式方法来评估哪种数据库技术最适合我的项目的每个阶段。

例如：在原型设计阶段，应用程序的逻辑/技术未知数使数据结构变得流畅：使用 SDB。在更成熟的阶段，优先考虑用户交付，使用传统工具，您不必花费开发时间编写排序、分组或分页逻辑。

非常感谢使用这些工具的实际经验。

谢谢！

沙希布·R。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-13T05:12:58.357

您发现的问题是为什么 RDBMS 专家对某些替代系统持怀疑态度。是的，替代系统处理某些特定要求的速度非常快，但是一旦您想用相同的数据做其他事情，最快速的系统就会突然变得落后。相比之下，RDBMS 通常会更加沉着地管理变化。对于 Fleetest 经过微优化以处理的专门工作负载，它可能不如 Fleetest 快，但是当被要求处理其他查询时，它很少会以最快的速度恶化。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-10-25T02:34:08.720

新的解决方案不是灵丹妙药。

与传统的 RDBMS 相比，这些系统通过**权衡**其他方面（降低的查询能力、最终一致性、某些操作的糟糕性能）在某些方面（可扩展性、可用性或简单性）进行了改进。

不要将这些视为传统数据库的替代品，但它们是针对已知的特定需求的专用工具。

以 Amazon Simple DB 为例，SDB 基本上是一个巨大的电子表格，如果您的数据是这样的，那么它可能运行良好，并且出色的可扩展性和简单性将为您节省大量时间和金钱。

如果您的系统需要非常结构化和复杂的查询，但您坚持使用这些很酷的新解决方案之一，您很快就会发现自己正处于**重新实现一个业余的、设计不当的 RDBMS 的过程中，其中存在所有固有的问题。**

在这方面，如果您不知道这些是否适合您的需要，我认为在传统的 RDBMS 中进行前几次迭代实际上会更好，因为它们为您提供了最佳的灵活性和功能，尤其是在单服务器部署和适度的情况下加载。（见[CAP 定理](http://en.wikipedia.org/wiki/CAP_theorem)）。

一旦您对数据的外观和使用方式有了更好的了解，您就可以使用替代解决方案来满足您的需求。

如果您想要云托管解决方案的简单性，但需要关系数据库，您可以查看：[Amazon Relational Database Service](http://aws.amazon.com/rds/)

# latex - 如何防止 LaTeX 在段落之间填充空格，以便下一部分从下一页的顶部开始？

> ID：643635
> 
> 赞同：31
> 
> 时间：2009-03-13T16:50:07.680
> 
> 标签：latex

我有一篇两栏的论文，空间限制非常严格。

刚刚看了我上一版的手稿，发现上半部分有一个数字（如预期的那样），但下半部分的段落之间有很大的垂直空间（足以多挤 10 行），而且那个 LaTeX可能添加了它，以便在下一页的开头有一个新的编号部分将从页面顶部开始。

我知道有一种方法可以调整它，所以 LaTeX 不会那么努力，但我不确定如何。有什么帮助吗？谢谢！

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-03-13T17:05:00.310

控制段落间距的参数称为`\parskip`（参见[段落间距](https://www.overleaf.com/learn/latex/Paragraph_formatting#Paragraph_spacing)）。您使用以下方式设置它（使用“橡胶”值）：

```
 \setlength{\parskip}{1cm plus4mm minus3mm} 
```

的默认值`\parskip`取决于类。“加号”和“减号”部分告诉 TeX 它可以调整多少值以改进布局（即它们使间距有弹性，因此称为“橡胶”）。减少（或消除）橡胶的“加号”部分可能会有所帮助。

但请注意，如果对 TeX 进行过多限制，可能会导致其他布局伪影。

* * *

其他需要考虑的事情：

*   寡妇和俱乐部处罚可能适用于部分标题，并且可能会影响 TeX 的布局选择（请参阅[https://stackoverflow.com/questions/512967/how-can-one-keep-a-section-from-being-at-the -end-of-a-page-in-latex](https://stackoverflow.com/questions/512967/how-can-one-keep-a-section-from-being-at-the-end-of-a-page-in-latex)用于讨论）。
*   您可能还需要考虑弄乱`\baselineskip`which 控制文本行之间允许的间距，并且还可以具有橡胶值。
*   这是一个常见问题，可能已经在[CTAN](http://www.ctan.org/)上准备了一些相当复杂的处理方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-12-25T22:50:25.420

`\vfill`在新部分对我来说完美之前。

# asp.net - 是否可以将带有下拉列表的网格视图作为一个新控件？

> ID：643638
> 
> 赞同：1
> 
> 时间：2009-03-13T16:51:15.353
> 
> 标签：asp.net, controls, custom-controls

这部分参考了这一点：

[为什么不从 GridView 的下拉列表中触发 SelectedIndexChanged 事件？](https://stackoverflow.com/questions/485390/why-isnt-the-selectedindexchanged-event-firing-from-a-dropdownlist-in-a-gridview/641715#641715)

我认为它足够不同，可以问另一个问题。

我的想法是，与其将下拉列表（ddl）添加到gridview，然后使用上面的技术，我可以创建一个全新的控件，其中包含一个ddl并直接引用它。

我认为这更像是我如何创建 asp.net 2.0+ 控件，但我要问的可能吗？您能否制作一个“新”gridview 控件，它恰好总是有一个 ddl 并且只是（以某种方式）引用它而没有 findcontrol 和其他所有内容？

我意识到它将为一个独特的应用程序高度定制。我只是想看看是否有可能，因为我可能想用它来创建其他控件。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-14T04:19:19.503

这取决于您对“新 GridView”的定义。答案仍然存在，但要付出代价。

如果您的控件基于 WebControl，您可以编写具有任何功能的新网格控件。不知何故，我不认为这是你的想法。

如果你想继承现有的 GridView 并添加额外的控件，那么它也是可行的，但有很大的限制。原因是因为 GridView 的实现打破了所有可能的可扩展性准则。我猜是因为他们从来没有打算延长它。例如，他们几乎在任何情况下都会清除 Controls 集合，并明确期望 Controls[0] 是一个表。我想，如果您决定保持在表格布局（页眉、页脚和所有内容）的范围内，那么您可能有更多的发挥空间。

最后，您可以创建一个包装器，它有一个 GridView 作为其私有成员，并简单地公开您可能需要的所有内容以及更多内容。但这很快就会变得丑陋。

这是第二种方法的粗略演示（工作）。请注意，下拉菜单位于末尾。您可以覆盖 Render 方法，但您必须重新创建大量 MS 代码。

**扩展网格视图**

```
public class ExtendedGridView : GridView
{
    protected DropDownList DropDown { get; set; }

    public ExtendedGridView() : base()
    {
        this.DropDown = new DropDownList();
        this.DropDown.Items.Add("white");
        this.DropDown.Items.Add("red");
        this.DropDown.Items.Add("blue");
        this.DropDown.Items.Add("green");
        this.DropDown.AutoPostBack = true;
        this.DropDown.ID = "dropdown";
        this.DropDown.SelectedIndexChanged += new EventHandler(DropDown_SelectedIndexChanged);
    }

    void DropDown_SelectedIndexChanged(object sender, EventArgs e)
    {
        BackColor = System.Drawing.Color.FromName(this.DropDown.SelectedValue);
    }

    protected override int CreateChildControls(System.Collections.IEnumerable dataSource, bool dataBinding)
    {
        int itemCount = base.CreateChildControls(dataSource, dataBinding);
        Controls.Add(this.DropDown);
        return itemCount;
    }
} 
```

**一些页面.aspx**

```
<%@ Register TagPrefix="my" Namespace="MyProject" Assembly="MyProject" %>
<my:ExtendedGridView id="myGridView" runat="server" onpageindexchanging="myGridView_PageIndexChanging"></my:ExtendedGridView> 
```

**SomePage.aspx.cs**

```
protected void Page_Load(object sender, EventArgs e)
{
    myGridView.DataSource = new string[] { "aaa", "bbb", "ccc", "ddd", "eee" };
    myGridView.AllowPaging = true;
    myGridView.PageSize = 2;
    myGridView.DataBind();
}

protected void myGridView_PageIndexChanging(object sender, GridViewPageEventArgs e)
{
    myGridView.PageIndex = e.NewPageIndex;
    myGridView.DataBind();
} 
```

# c# - 如何使用asp.net创建和下载excel文档

> ID：643643
> 
> 赞同：11
> 
> 时间：2009-03-13T16:51:58.783
> 
> 标签：c#, asp.net, excel, openxml

如何使用 asp.net 创建和下载 excel 文档？

目的是使用 xml、linq 或其他任何东西通过浏览器向客户发送 excel 文档。

编辑：**用例**

客户在浏览器中加载一个gridview（用ajax框架制作），gridview直接链接到一个sql数据库。我放了一个“导出到 excel”按钮，让客户将此 gridview 数据保存在他的计算机上，并且我想启动一个干净的 excel 下载。

这里提出的解决方案并不干净，比如发送一个html文档并将标题更改为excel文档等，我现在正在codeplex上搜索一个简单的解决方案，我会告诉你的。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-22T14:51:26.840

## 入门套件

首先我下载了[**​​ Open XML Format SDK 2.0**](http://www.microsoft.com/downloads/details.aspx?FamilyID=c6e744e5-36e9-45f5-8d8c-331df206e0d0&DisplayLang=en)。

它带有 3 个有用的工具：

C:\Program Files\Open XML 格式 SDK\V2.0\tools

*   `DocumentReflector.exe`至极自动生成 c# 以从代码构建电子表格。
*   `OpenXmlClassesExplorer.exe`显示 Ecma 规范和类文档（使用 MSDN 样式格式）。
*   `OpenXmlDiff.exe`以图形方式比较两个 Open XML 文件并搜索错误。

我建议任何开始将***.xlsx*****重命名** ***为**********.zip**，因此您可以看到驱动我们的电子表格的 XML 文件（例如，我们的工作表在 "xl\worksheets" 中）。*****

 ****** * *

## 编码

**免责声明**：我从[**MSDN 技术文章**](http://msdn.microsoft.com/en-us/library/dd452407.aspx)中窃取了所有代码；D

以下代码使用我手动制作的 *.xlsx 模板以便能够对其进行修改。

命名空间引用

```
using System.IO;
using System.Xml;
using DocumentFormat.OpenXml.Packaging;
using DocumentFormat.OpenXml.Spreadsheet;
using DocumentFormat.OpenXml;

// Database object
        DataClassesDataContext db = new DataClassesDataContext();

        // Make a copy of the template file.
        File.Copy(@"C:\inetpub\wwwroot\project.Web\Clients\Handlers\oxml-tpl\livreurs.xlsx", @"C:\inetpub\wwwroot\project.Web\Clients\Handlers\oxml-tpl\generated.xlsx", true);

        // Open the copied template workbook. 
        using (SpreadsheetDocument myWorkbook = SpreadsheetDocument.Open(@"C:\inetpub\wwwroot\project.Web\Clients\Handlers\oxml-tpl\generated.xlsx", true))
        {
            // Access the main Workbook part, which contains all references.
            WorkbookPart workbookPart = myWorkbook.WorkbookPart;

            // Get the first worksheet. 
            WorksheetPart worksheetPart = workbookPart.WorksheetParts.ElementAt(2);

            // The SheetData object will contain all the data.
            SheetData sheetData = worksheetPart.Worksheet.GetFirstChild<SheetData>();

            // Begining Row pointer                       
            int index = 2;

            // Database results
            var query = from t in db.Clients select t;

            // For each item in the database, add a Row to SheetData.
            foreach (var item in query)
            {
                // Cell related variable
                string Nom = item.Nom;

                // New Row
                Row row = new Row();
                row.RowIndex = (UInt32)index;

                // New Cell
                Cell cell = new Cell();
                cell.DataType = CellValues.InlineString;
                // Column A1, 2, 3 ... and so on
                cell.CellReference = "A"+index;

                // Create Text object
                Text t = new Text();
                t.Text = Nom;

                // Append Text to InlineString object
                InlineString inlineString = new InlineString();
                inlineString.AppendChild(t);

                // Append InlineString to Cell
                cell.AppendChild(inlineString);

                // Append Cell to Row
                row.AppendChild(cell);

                // Append Row to SheetData
                sheetData.AppendChild(row);

                // increase row pointer
                index++;                

            }

            // save
            worksheetPart.Worksheet.Save();

        } 
```

我还没有完成，我的第二个工作是修改后自动下载电子表格。

* * *

最后，我将用户重定向到我生成的电子表格（来自我的 aspx）

```
 context.Response.Redirect("Oxml-tpl/generated.xlsx"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T16:54:51.223

只需设置 Response.ContentType = "application/vnd.ms-excel" ，您的页面将在客户端浏览器上呈现为 excel 表

[示例代码在这里](http://www.thaicreate.com/asp.net/asp.net-excel-application-vnd.ms-excel.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T17:03:52.623

有很多方法可以处理这个问题，具体取决于 Excel 功能的广泛程度。如果 Excel 只是一个电子表格并且没有内置的直接 Excel 功能，则 Binoj 的答案有效。客户端可以添加功能、连接等。在客户端执行某些操作之前，这些都是“愚蠢的”excel 文档。

要创建功能更全面的 Excel 文档，您有两个我可以临时想到的基本选择。

1.  使用 office 组件（re: bad）创建一个 excel 文档，或使用第三方组件，如 SoftArtisan 的 ExcelWriter。伟大的组件，但有一个成本。

2.  使用允许导出到 Excel 的页面上的控件。大多数 ASSP.NET 控件供应商在其网格上都有此功能。

选项 #1 允许您使用 Excel 的几乎所有功能。选项#2 有一些限制，至少在我尝试过的控件中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-16T22:59:12.513

关于如何从 Erika Ehrli 导出到 excel 的好文章 [http://blogs.msdn.com/erikaehrli/archive/2009/01/30/how-to-export-data-to-excel-from-an-asp-net -application-avoid-the-file-format-differ-prompt.aspx](http://blogs.msdn.com/erikaehrli/archive/2009/01/30/how-to-export-data-to-excel-from-an-asp-net-application-avoid-the-file-format-differ-prompt.aspx)

# asp.net - 动态添加在 web.config 中注册的用户控件

> ID：643645
> 
> 赞同：2
> 
> 时间：2009-03-13T16:52:25.427
> 
> 标签：asp.net

我正在开发一个项目，该项目的所有[用户控件都注册在其 web.config 文件中](http://weblogs.asp.net/scottgu/archive/2006/11/26/tip-trick-how-to-register-user-controls-and-custom-controls-in-web-config.aspx)（看起来非常干净整洁）

到目前为止一切顺利（问题来了）但是我正在尝试动态创建用户控件并将其添加到页面。这些用户控件触发需要处理的事件。

通常这不会是一个问题：您只需在页面中注册控件，加载控件，将其转换为正确的类型，并分配事件处理程序，将其添加到页面，坐下来让魔术发生，简单轻松。

但是在web.config中注册控件时，我无法引用控件的类型，也就是说没有强制转换，也就是没有事件处理！

奇怪的是，如果您在设计时将用户控件添加到页面，您可以引用类型！

必须有办法解决这个问题（不必在页面上注册控件，或者在设计时添加控件），我到底错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T22:15:26.633

已经有一段时间了，但是当项目是网站而不是 Web 应用程序时，我想我已经在 ASP.NET 中看到过这种行为。据我记得，网站将每个页面编译成自己的程序集，并且没有公共名称空间，并且无论配置如何都需要 <%@ Register %> 指令。如果不这样做，您将得到缺少程序集引用的确切错误。

我必须进行测试才能确定...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T16:59:46.143

通过说：“如果在设计时将用户控件添加到页面，则可以引用类型”

你的意思是它在页面顶部添加了一个 <%@ Register %> 指令吗？

或者，它在源文档中添加了 using / Imports（取决于您使用 c#/vb.net）子句？

因为，为了能够转换为您的控件类型，您通常需要在代码绑定中导入命名空间。也许这正是缺少的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T17:59:09.777

web.config 中的 <controls> 部分和 <%@ Register %> 指令是相同的（除了 web.config 中的条目适用于整个应用程序的小例外）。它们允许您将设计时控件添加到 Web 表单。

如果要动态地将控件添加到页面，请使用 LoadControl 函数获取控件的实例。给定一个类名为“Header”的控件，下面将加载一个控件，设置一个属性，并将该控件添加到名为“form1”的表单中：

```
 Dim head As Header = LoadControl("~/Controls/Header.ascx")
    head.Text = "Some text..."
    Me.form1.Controls.Add(head) 
```

# c# - 在 C# 中创建一个简单的名称值映射器类

> ID：643655
> 
> 赞同：2
> 
> 时间：2009-03-13T16:54:44.440
> 
> 标签：c#

我想创建一个简单地将名称映射到值（1 到 1）的类（静态？）。做这样的事情的干净方法是什么：

```
public static class FieldMapper
{
  public static GetValue(string Name)
  {
    if (Name == "abc")
        return "Value1";

    if (Name == "def")
        return "Value2";
  }
} 
```

我今天可能脑子有问题。对于这样一个简单的问题，我想不出一个干净的解决方案:(

**编辑：所有值在编译时都是已知的（没有唯一性 - 不同的键可以映射到相同的值）。我不应该创建在运行时添加值的数据结构。另外，我想避免使用 XML 文件**

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-13T16:56:54.963

听起来像是字典的工作。

```
Dictionary<string, string> values = new Dictionary<string, string>();
values.Add("abc", "Value1");
values.Add("def", "Value2");
Console.WriteLine(values["abc"]);   // Prints "Value1" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T16:58:33.103

您正在描述[哈希表](http://en.wikipedia.org/wiki/Hash_table)数据结构。这些通常使用[散列函数](http://en.wikipedia.org/wiki/Hash_function)来实现。

C# 已经实现了这种类型的数据结构。请参阅[字典接口](http://msdn.microsoft.com/en-us/library/system.collections.idictionary.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T17:06:37.483

如果您可以将项目预加载到字典中，那将有很大帮助：

```
IDictionary<string, string> myValues = new Dictionary<string, string>( 3 )
{
        {"abc", "Value1"},
        {"def", "Value2"},
        {"ghi", "Value3"}
};

var mySearchString = "abc";
return myValues.Keys.Contains( "abc" ) ? myValues[ mySearchString ] : string.Empty; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T16:59:51.523

如果您谈论的是在编译时已知的值，您可以尝试将它们存储为资源。像这样的东西：

```
//Name Spaces Required
using System.Resources;
using System.Reflection;

// Create the resource manager.
Assembly assembly = this.GetType().Assembly;

//ResFile.Strings -> <Namespace>.<ResourceFileName i.e. Strings.resx>
resman = new ResourceManager("StringResources.Strings", assembly);

// Load the value of string value for Client
strClientName = resman.GetString("Client"); 
```

[（从这里](http://snipplr.com/view/2140/csharp-reading-string-from-resource-file--------------------/)偷来的）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T17:00:41.367

我认为字典会更好，但是，如果您要在代码中执行此操作：

```
 public static class FieldMapper
{  
     public static GetValue(string Name)  
    {    
       switch (Name)
      {
        case "abc":
         return Value1;
      }
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-13T17:21:05.297

如果您希望在编译时而不是在启动时创建集合，您可以只使用一个开关。

如果开关包含多个项目（五个 IIRC），则它是使用哈希查找实现的，因此即使您在其中放置很多案例，它也非常快。（即任何情况下的访问时间都是相同的。）

```
public static class FieldMapper {

   public static string GetValue(string name) {
      switch (name) {
         case "abc": return "Value1";
         case "def": return "Value2";
      }
      throw new ArgumentException("Unknown name.", "name");
   }
} 
```

# fluent-nhibernate - 流利的休眠 HasOne WithForeignKey 不起作用

> ID：643656
> 
> 赞同：23
> 
> 时间：2009-03-13T16:54:48.090
> 
> 标签：fluent-nhibernate

每当我加载 Task 类时，Document 属性始终为 null，尽管 db 中有数据。

任务类：

```
public class Task
{
    public virtual Document Document { get; set; } 
```

AutoPersistenceModel 的任务映射覆盖：

```
public void Override(AutoMap<Task> mapping)
{
    mapping.HasOne(x => x.Document)
        .WithForeignKey("Task_Id"); 
```

如您所见，NHProf 所说的正在运行，连接条件错误，WithForeignKey 似乎没有生效。事实上，我可以在上面的代码中写任何字符串，这没什么区别。

```
FROM   [Task] this_
    left outer join [Document] document2_
    on this_.Id = document2_.Id 
```

它应该是：

```
FROM   [Task] this_
    left outer join [Document] document2_
    on this_.Id = document2_.Task_Id 
```

如果我破解数据库中的数据以使 id 匹配，则加载数据，但显然这是不正确的 - 但至少它证明它加载了数据。

编辑：在流利的 nhib 源中翻找 XML 会产生以下结果：

```
<one-to-one foreign-key="Task_Id" cascade="all" name="Document" class="MyProject.Document, MyProject, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" /> 
```

编辑：继承人架构：

```
CREATE TABLE [dbo].[Document](
[Id] [int] IDENTITY(1,1) NOT NULL,
[Task_Id] [int] NOT NULL,

CREATE TABLE [dbo].[Task](
[Id] [int] IDENTITY(1,1) NOT NULL, 
```

有人有什么想法吗？

谢谢

安德鲁

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2010-03-05T11:42:42.037

我今天遇到了同样的问题。我相信诀窍不是将 .ForeignKey(...) 与 .HasOne 映射一起使用，而是使用 .PropertyRef(...) 。以下是我如何定义组织（父）与其管理员（子）之间的一对一关系：

```
HasOne(x => x.Admin).PropertyRef(r => r.Organisation).Cascade.All(); 
```

管理员使用其外键对组织进行了简单的引用：

```
References(x => x.Organisation, "ORAD_FK_ORGANISATION").Not.Nullable(); 
```

检索组织时，这将加载正确的管理员记录，并正确级联更新和删除。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-13T17:10:27.770

你应该使用：

参考文献（x => x.Document，“DocumentIdColumnOnTask”）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-13T17:09:33.047

我认为这里的问题是“HasOne”约定意味着您指向另一件事（说“多对一”/“一对一”的标准关系方式）；通过将 Task_ID 放在文档上，实际关系是 HasMany，但您有某种隐含的理解，即每个任务只有一个文档。

抱歉 - 我不知道如何解决这个问题，但我有兴趣看看解决方案是什么（我不使用 NHibernate 或 Fluent NHibernate，但我一直在研究它以供将来使用）。一个解决方案（来自一个很少有想法的人）是让 Documents 成为 Task 上的一个集合，然后提供一个 Document 属性，该属性返回集合中的第一个属性（使用一个隐藏 Documents 属性的界面，因此没有人认为他们可以添加新项目）。

查看文档并考虑 eulerfx 的答案，也许该方法类似于：

```
References(x => x.Document)
    .TheColumnNameIs("ID")
    .PropertyRef(d => d.Task_ID); 
```

编辑：所以这个答案有适当的解决方案：正确的路径是更新数据库模式以匹配代码的意图。这意味着将 DocumentID 添加到 Task 表中，因此 Task 和 Document 之间存在多对一的关系。如果无法更改架构，则 References() 将是适当的解决方案。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-03-27T06:39:22.493

我试过这个解决方案：

就在文档中：

```
mapping.HasOne(x => x.Task).ForeignKey("Task_ID").Constrained().Cascade.All(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T17:40:03.737

正如 eulerfx 指出的那样，

> 表结构表明一个任务可能有多个文档

克里斯说：

> 通过将 Task_ID 放在文档上，实际关系是 HasMany，但您有某种隐含的理解，即每个任务只有一个文档。

这当然是正确的，因此我将其反转，因此 Task 具有可为空的 Document_Id。

感谢两位的帮助！

我为接受的答案掷了一枚硬币，如果我能同时勾选两个我会的！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-12-30T10:33:39.577

我一直在努力解决同样的 Has One 问题，最后发现这行得通：

```
public class ParentMap : ClassMap<Parent>
{
    public ParentMap()
    {
        Id(x => x.Id);
        HasOne(s => s.Child).Cascade.All();
    }
}

 public class ChildMap : ClassMap<Model.Child>
{
    public ChildMap()
    {
        Id(x => x.Id);
        HasOne(s => s.Parent).Constrained().ForeignKey();           
    }
} 
```

# java - XSLT/Java：错误：'找不到外部方法'max'（必须是公共的）。'

> ID：643659
> 
> 赞同：1
> 
> 时间：2009-03-13T16:55:45.513
> 
> 标签：java, xml, xslt, jstl, transform

我正在复制[XSLT Cookbook: 2nd Edition](http://oreilly.com/catalog/9780596009748/) (O'Reilly: Mangano, 2006) 中的一个示例，其中 Mangano 使用 SVG 创建了一个树形图。作为快速测试此代码的一种方法，我只是使用 JSTL 的`<x:transform/>`标记转换 XML，并在 Jetty 6 中运行它。XSLT 似乎挂在调用上`java:java.lang.Math:max`，说：

> 错误：'找不到外部方法'max'（必须是公开的）。' 致命错误：“无法编译样式表”

给我错误的代码包含在此处`...Math:max(...`称为：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.1"
                xmlns:emath="http://www.exslt.org/math"
                xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns:tree="http://www.ora.com/XSLTCookboox/ns/tree"
                xmlns:xalan="http://xml.apache.org/xslt"
                xmlns:Math="xalan:java.lang.Math">
...
<!--Pass 1 copies input with added bookkeeping attributes -->  
<xsl:variable name="treeWithLayout">
  <xsl:apply-templates mode="layout"/>
</xsl:variable>

<xsl:variable name="maxPos" 
      select="Math:max($treeWithLayout/*/@tree:WEIGHT * 
                       ($nodeWidth + $horzSpace),
                       $treeWithLayout/*/@tree:MAXDEPTH * 
                         ($nodeHeight + $vertSpace))"/>
... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T17:39:51.617

我在[网上找到了这种用法](http://www.ibm.com/developerworks/library/x-xalanextensions.html)：

```
<xsl:stylesheet version="1.0" 
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:math="xalan://java.lang.Math"
  extension-element-prefixes="math"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-02-18T15:00:22.803

如果缺少任何参数，您可以收到此消息。例如：

你写

```
<xsl:variable name="maxPos" select="Math:max(9)"/> 
```

反而

```
<xsl:variable name="maxPos" select="Math:max(9, 15)"/> 
```

# coding-style - 其他语言的 StyleCop

> ID：643666
> 
> 赞同：16
> 
> 时间：2009-03-13T16:58:13.730
> 
> 标签：coding-style, stylecop

我们一直在使用 StyleCop 来执行 C# 中的编码标准，我想知道其他语言是否有类似的工具？即：

*   js
*   css
*   sql

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-13T17:38:40.433

没见过 StyleCop，但对于 Java，有 Checkstyle：[http ://checkstyle.sourceforge.net/](http://checkstyle.sourceforge.net/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-09-09T08:01:09.943

JavaScript：[JSHint](http://jshint.com/)

CSS：[CSS 皮棉](http://csslint.net/)

SQL：声纳

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-28T23:49:44.390

[PHP_CodeSniffer](http://pear.php.net/package/PHP_CodeSniffer)（[博客文章/公告](http://gregsherwood.blogspot.com/2008/10/phpcodesniffer-csscodesniffer.html)）支持的 CSS 和 JS 编码标准已经有了一些进展。它目前（2009 年 3 月）处于候选发布状态。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-11-30T16:40:31.227

我不知道有任何 js 工具实际上会强制执行提交规则，但[http://www.jslint.com/](http://www.jslint.com/)是一个好的开始。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-12-03T11:50:59.293

对于 Perl，有一个工具叫做`perlcritic`.

# objective-c - 将图像读取和写入 SQLite DB 以供 iPhone 使用

> ID：643682
> 
> 赞同：22
> 
> 时间：2009-03-13T17:03:47.380
> 
> 标签：objective-c, ios, cocoa-touch, sqlite, nsdata

`NSString`我已经建立了一个目前可以完美读写 s 的 SQLite 数据库。我还想将图像存储在数据库中并稍后调用。我已经阅读了一些关于使用`NSData`和编码图像的内容，但我并不完全确定我想要做什么的语法是什么。任何代码片段或示例将不胜感激。

我当前的过程是这样的： `UIImagePickerController`-> 用户从照片中选择图像-> selectedImage 设置为实例`UIImageView`->**现在我想获取此图像并将其存储在数据库中**

我应该提到这个调用最终将被对远程服务器的调用所取代。不确定这是否会对性能产生影响。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-03-13T17:41:13.330

您需要将 UIImageView 中托管的 UIImage 转换为二进制 BLOB 以存储在 SQLite 中。为此，您可以使用以下内容：

```
NSData *dataForImage = UIImagePNGRepresentation(cachedImage);
sqlite3_bind_blob(yourSavingSQLStatement, 2, [dataForImage bytes], [dataForImage length], SQLITE_TRANSIENT); 
```

这将生成图像的 PNG 表示，将其存储在 NSData 实例中，然后将 NSData 中的字节绑定为 SQL 查询中第二个参数的 BLOB。如果您愿意，可以使用上面的 UIImageJPEGRepresentation 以该格式存储。您需要将 BLOB 列添加到 SQLite 数据库中的相应表中。

要检索此图像，您可以使用以下命令：

```
NSData *dataForCachedImage = [[NSData alloc] initWithBytes:sqlite3_column_blob(yourLoadingSQLStatement, 2) length: sqlite3_column_bytes(yourLoadingSQLStatement, 2)];       
self.cachedImage = [UIImage imageWithData:dataForCachedImage];
[dataForCachedImage release]; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-13T17:32:29.340

一种选择（在使用 SQL 时通常是首选）是将图像写入系统上的文件并将路径（或某种其他类型的标识符）存储在数据库中。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2011-04-15T10:21:56.957

Apple 的建议是不要将 BLOB 存储在大于 ~2 KB 的 SQLite 数据库中。

SQLite 将数据库组织成页面。每页大小为 4 KB。当您从 SQLite 数据库文件中读取数据时，它会将这些页面加载到内部页面缓存中。在 iPhone 上，我认为这个缓存的大小默认为 1 兆字节。这使得读取相邻记录非常快，因为它们可能已经在页面缓存中。

当 SQLite 将您的数据库记录读入内存时，它会读取整个记录以及它占用的所有页面。因此，如果您的记录包含 BLOB，它可能会占用许多页面，您将从缓存中弹出现有页面并用 BLOB 记录的页面替换它们。

如果您只是扫描并加载所有 BLOBS 以对它们执行某些操作（例如显示它们），这还不错。但是，如果说您执行了一个查询，您只是想获取一些与 BLOB 位于同一行的数据，则此查询将比记录不包含大 BLOB 时慢得多。

因此，您至少应该将 BLOB 数据存储在单独的表中。例如：

```
CREATE TABLE blobs ( id INTEGER PRIMARY KEY, data BLOB );
CREATE TABLE photos ( id INTEGER PRIMARY KEY, name TEXT, blob_id INTEGER, 
    FOREIGN KEY(blob_id) REFERENCES blobs(id) ); 
```

或者更好的是，将 BLOB 数据存储为 SQLite 数据库之外的文件。

请注意，可以使用[SQL PRAGMA 语句](http://www.sqlite.org/pragma.html)调整页面缓存大小（如果您不使用 CoreData）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-01-29T13:05:41.263

将图像写入 SQLite DB

```
if(myImage != nil){
    NSData *imgData = UIImagePNGRepresentation(myImage);
    sqlite3_bind_blob(update_stmtement, 6, [imgData bytes], [imgData length], NULL);    
    }
    else {
        sqlite3_bind_blob(update_stmtement, 6, nil, -1, NULL);
    } 
```

从 SQLite DB 读取：

```
NSData *data = [[NSData alloc] initWithBytes:sqlite3_column_blob(init_statement, 6) length:sqlite3_column_bytes(init_statement, 6)];
        if(data == nil)
            NSLog(@"No image found.");
        else
            self.pictureImage = [UIImage imageWithData:data]; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-05T12:21:48.507

最佳做法是压缩图像并将其存储在数据库或文件系统中。如果您不关心图像的分辨率，您可以继续使用，甚至可以使用以下方法调整图像大小：

```
 UIGraphicsBeginImageContext(newSize);  
   [image drawInRect:CGRectMake(0,0,newSize.width,newSize.height)];   
   UIImage* newImage = UIGraphicsGetImageFromCurrentImageContext();    
   UIGraphicsEndImageContext(); 
```

之后，您可以使用`UIImageJPEGRepresentation`值为“0”的 jpeg 图像进行最大压缩。或者您可以使用`UIImagePNGRepresentation`png 图像

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-05-27T07:08:01.577

您应该首先在文件系统上写入图像。然后获取图像路径并将该图像路径（URL）作为文本存储在sqlite中。

# c# - 有没有一种方法可以在 Visual Studio 中交换一组表达式的左侧和右侧？

> ID：643687
> 
> 赞同：9
> 
> 时间：2009-03-13T17:04:51.153
> 
> 标签：c#, .net, vb.net, visual-studio, macros

我有一组体面的数据需要存储在活动记录中。为了预先填充页面上的表单字段，我已经编写了以下代码：

```
Device device = new Device(DeviceID); // device is simply the active record

txtDeviceName.Text = device.Name;
txtNotes.Text = device.Notes;
txtHostName.Text = device.Hostname;
txtAssetTag.Text = device.AssetTag;
txtSerialNumber.Text = device.SerialNumber;
// snip... the list goes on! 
```

是否有某种方法（内置功能、宏等）可以用来交换表达式的每一侧，以便将数据保存到活动记录中，而不是从中读取以执行数据库插入？例如，在高亮上面的代码并运行宏之后，它会变成：

```
device.DeviceName = txtDeviceName.Text;
device.Notes = txtNotes.Text;
device.Hostname = txtHostName.Text;
device.AssetTag = txtAssetTag.Text;
device.SerialNumber = txtSerialNumber.Text;
// snip again... 
```

由于此活动记录封装的数据库中的列数相当大，因此似乎可以通过简单的自动化过程来避免大多数此类输入。

显然这不会 100% 起作用，因为有时必须进行类型转换（例如`int`to `string`），但在大多数情况下，我认为这会节省大量时间。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-13T17:28:17.727

这是一个可以做到这一点的宏：

```
Imports System
Imports EnvDTE
Imports EnvDTE80
Imports System.Diagnostics
Imports System.Text.RegularExpressions

Public Module Helpers
    Sub SwapAssignment()
        If (Not IsNothing(DTE.ActiveDocument)) Then
            Dim selection As TextSelection = CType(DTE.ActiveDocument.Selection, TextSelection)
            selection.Text = Regex.Replace(selection.Text, "([^\s]*)\s*=\s*([^\s]*);", "$2 = $1;")
        End If
    End Sub
End Module 
```

基本上，它采用选定的文本（一行或您选择的多行）并使用正则表达式来交换值。不漂亮，但宏永远不会。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T13:19:38.107

无法让它与 Regex 一起使用（必须是 visualstudio 2010 的东西）我已经使用经典拆分以旧时尚的方式完成了它。它还包括一个检查以跳过 VB 和 c# 注释行。发给需要的人吧。。

```
Imports System
Imports EnvDTE
Imports EnvDTE80
Imports System.Diagnostics
Imports System.Text.RegularExpressions

Public Module Helpers
    Sub SwapAssignment()
        If (Not IsNothing(DTE.ActiveDocument)) Then
            Dim selection As TextSelection = CType(DTE.ActiveDocument.Selection, TextSelection)
            Dim lineArray() = selection.Text.Split(vbCrLf)
            Dim output = ""
            For Each line As String In lineArray
                line = line.Trim()

                If line.Length >= 1 Then
                    If line.Substring(0, 1).Equals("'") OrElse line.Substring(0, 1).Equals("/") Then
                        output &= line & vbCrLf
                        Continue For
                    End If
                End If

                If line.Contains(" = ") Then
                    Dim splittedline = line.Split("=")
                    output &= splittedline(1) + " = " + splittedline(0) & vbCrLf
                Else
                    output &= line & vbCrLf
                End If
            Next
            Dim check = output
            selection.Text = output
        End If
    End Sub
End Module 
```

# c# - 在 WPF UserControl 中附加 ICommand

> ID：643689
> 
> 赞同：7
> 
> 时间：2009-03-13T17:05:05.303
> 
> 标签：c#, wpf, mvvm, user-controls

我实现了一个带有图像的简单按钮：

```
 <Button Command="{Binding ButtonCommand, ElementName=ImageButtonControl}">
        <StackPanel Orientation="Horizontal">
            <Image Source="{Binding ButtonImage, ElementName=ImageButtonControl}"/>
            <TextBlock Text="{Binding ButtonText, ElementName=ImageButtonControl}" Margin="2,0,0,0"/>
        </StackPanel>
    </Button> 
```

如您所见，我公开了一个 ButtonCommand 属性，以便能够将 ICommand 附加到此 UserControl：

```
public partial class ImageButton : UserControl
{
    /// <summary>
    /// The dependency property that gets or sets the source of the image to render.
    /// </summary>
    public static DependencyProperty ImageSourceProperty = 
        DependencyProperty.Register("ButtonImage", typeof(ImageSource), typeof(ImageButton));

    public static DependencyProperty TextProperty =
        DependencyProperty.Register("ButtonText", typeof(string), typeof(ImageButton));

    public static DependencyProperty ButtonCommandProperty =
        DependencyProperty.Register("ButtonCommand", typeof(ICommand), typeof(ImageButton));

    public ImageButton()
    {
        this.DataContext = this;
        InitializeComponent();
    }

    /// <summary>
    /// Gets or sets the button command.
    /// </summary>
    public ICommand ButtonCommand
    {
        get { return (ICommand)GetValue(ImageButton.ButtonCommandProperty); }
        set { SetValue(ImageButton.ButtonCommandProperty, value); }
    }

    /// <summary>
    /// Gets or sets the button image.
    /// </summary>
    public ImageSource ButtonImage
    {
        get { return (ImageSource)GetValue(ImageButton.ImageSourceProperty); }
        set { SetValue(ImageButton.ImageSourceProperty, value); }
    }

    /// <summary>
    /// Gets or sets the button text.
    /// </summary>
    public string ButtonText
    {
        get { return (string)GetValue(ImageButton.TextProperty); }
        set { SetValue(ImageButton.TextProperty, value); }
    }
} 
```

然后，当我声明我的按钮时，它会给出：

`<uc:ImageButton Grid.Row="1" Grid.Column="0" ButtonCommand="{Binding AttachContextCommand}" ButtonImage="{StaticResource AssociateImage}" ButtonText="Associer"/>`

还有 badaboom，当我点击我的 ImageButton 时，什么都不会发生。当我用一个简单的按钮替换 ImageButton 时，会调用 ICommand。

我什至尝试简单地扩展 Button 类并绑定一个 ICommand，但再一次，它没有工作......

帮助表示赞赏！

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-16T14:17:54.160

您可以使用样式和几个附加属性以更简洁的方式实现此目的。

附加的属性将存储您的特定信息。该样式将使用这些属性并构建您想要的外观。

该元素仍将是一个按钮，因此命令和其他一切都将起作用。

```
 public class ImageButton
    {

        public static ImageSource GetImage(DependencyObject obj)
        {
            return (ImageSource)obj.GetValue(ImageProperty);
        }

        public static void SetImage(DependencyObject obj, ImageSource value)
        {
            obj.SetValue(ImageProperty, value);
        }

        public static readonly DependencyProperty ImageProperty =
            DependencyProperty.RegisterAttached("Image", typeof(ImageSource), typeof(ImageButton), new UIPropertyMetadata(null));

        public static String GetCaption(DependencyObject obj)
        {
            return (String)obj.GetValue(CaptionProperty);
        }

        public static void SetCaption(DependencyObject obj, String value)
        {
            obj.SetValue(CaptionProperty, value);
        }

        public static readonly DependencyProperty CaptionProperty =
            DependencyProperty.RegisterAttached("Caption", typeof(String), typeof(ImageButton), new UIPropertyMetadata(null));

    }

<Style TargetType="{x:Type Button}"
               x:Key="ImageButton">
            <Setter Property="ContentTemplate">
                <Setter.Value>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                            <Image Source="{Binding Path=(local:ImageButton.Image), RelativeSource={RelativeSource AncestorType={x:Type Button}}}" />
                            <TextBlock Text="{Binding Path=(local:ImageButton.Caption), RelativeSource={RelativeSource AncestorType={x:Type Button}}}"
                                       Margin="2,0,0,0" />
                        </StackPanel>
                    </DataTemplate>
                </Setter.Value>
            </Setter>   
        </Style> 
```

然后，您可以使用它来声明按钮：

```
 <Button Style="{DynamicResource ImageButton}"
                        local:ImageButton.Caption="Foo" 
                        local:ImageButton.Image="..." /> 
```

笔记：

我很确定通过“模板”属性并使用 ControlTemplate 和 TemplateBindings 会更干净，但这意味着在您的内容周围重新创建边框和其他内容，所以如果您只想定义一个默认值“内容”，我认为我的例子是要走的路。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-14T04:38:09.757

如果您想要为按钮添加的唯一功能是在其上添加图像，那么我认为您从错误的方向接近这个。WPF 非常棒，因为它的 UI 控件**看起来很少。** 这意味着控件只是功能的定义+一些模板来定义它的外观。这意味着可以随时更换模板以更改外观。此外，几乎任何内容都可以放在几乎任何控件中

例如，要在您的 xaml 中定义一个具有您所需要的外观的按钮是这样的：

```
<Window ...>
    ...
    <Button Command="{Binding AttachContextCommand}">
        <StackPanel Orientation="Horizontal">
            <Image Source="{StaticResource AssociateImage}"/>
            <TextBlock Text="Associer"/>
        </StackPanel>
    </Button>
    ...
</Window> 
```

请记住，使用 WPF 时，您不必在每次想要更改某些东西的外观和感觉时都定义新的 CustomControl 或 UserControl。唯一需要 CustomControl 的情况是，如果您想向现有 Control 添加功能或创建任何其他 Control 中不存在的功能。

**编辑由于评论：**

如果您不想每次都为按钮定义内容，另一种选择是只使用一个 poco（普通的旧 CLR 对象）类来定义您感兴趣的所有内容（我将编写我的示例，就好像您'正在为工具栏执行此操作，因为这对我来说很有意义）：

```
public class ToolBarItem : INotifyPropertyChanged
{
    public string Text { get ... set ... }
    public ICommand Command { get ... set ... }
    public ImageSource Image { get ... set ... }
} 
```

它在某处定义了一个数据模板（App.xaml、Window.Resources 等）：

```
<DataTemplate DataType="{x:Type l:ToolBarItem}">
    <Button Command="{Binding Command}">
        <StackPanel Orientation="Horizontal">
            <Image Source="{Binding Image}"/>
            <TextBlock Text="{Binding Text}"/>
        </StackPanel>
    </Button>
</DataTemplate> 
```

然后像这样在你的 xaml 中使用这个人：

```
<Window ...>
    ...
    <ContentControl>
        <ContentControl.Content>
            <l:ToolBarItem Image="..." Command="..." Text="..."/>
        </ContentControl.Content>
    </ContentControl>
    ...
</Window> 
```

我只是不知道您尝试这样做的方式是您可以做到的最 WPF 方式。

**编辑根据第二条评论更新** 对不起，我忘了包括围绕它的 ContentControl。现在我想起了这一点，我意识到这并不比您手动指定内容的原始版本少多少。我将发布一个新答案以帮助您解决原始问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-16T17:42:58.737

要重新回答原始问题：

我认为您想要做的是创建一个名为*ImageButton*的新 CustomControl 。然后将其更改为从 Button 而不是 Control 扩展。您不需要 Command 属性，因为 Button 已经有一个。您只需要添加一个 Image 属性，就可以重用按钮的 Content 属性，而不是 Text 属性。

创建 CustomControl 后，它将在 Generic.xaml 中为 ImageButton 的默认样式添加一个条目。在 Template 属性的 Setter 中，您可以将 ControlTemplate 更改为：

```
<ControlTemplate TargetType="{x:Type local:ImageButton}">
    <StackPanel Orientation="Horizontal">
        <Image Source="{TemplateBinding Image}"/>
        <ContentPresenter/>
    </StackPanel>
</ControlTemplate> 
```

然后，再次，当你想使用它时：

```
<Window ... >
...
    <l:ImageButton Image="{StaticResource ...}" Command="...">
        Associer
    </l:ImageButton>
...
</Window> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T18:23:48.030

内置 WPF 按钮包含触发附加命令以响应单击的代码。您的“ImageButton”派生自 UserControl，因此您不会得到这种行为。获得所需内容的最短路径可能是让 ImageButton 类实际派生自 WPF Button 类。为此，将 ImageButton 的标记从

```
<UserControl
...
>
...
</UserControl> 
```

到

```
<Button
...
>
...
</Button> 
```

然后将 ImageButton 的基类从 更改`UserControl`为`Button`。

在一切正常之前，您可能需要进行一些其他小的更改。

# database - 将类型存储在 DB 中时的最大 MIMEType 长度

> ID：643690
> 
> 赞同：118
> 
> 时间：2009-03-13T17:05:12.980
> 
> 标签：database, mime-types

人们在他们的数据库中使用什么作为 MIMEType 字段的长度？到目前为止，我们看到的最长的是 72 字节：

```
application/vnd.openxmlformats-officedocument.wordprocessingml.document 
```

但我只是在等待更长的时间。我们现在使用 250，但有没有人见过比这更长的 MIMEType？

编辑：从接受的答案中，类型和子类型各为 127，因此最大为 254，加上“/”是组合值的 255 的限制。

* * *

## 回答 #1

> 赞同：179
> 
> 时间：2009-03-13T17:28:59.567

根据 RFC 4288“媒体类型规范和注册程序”，类型（例如“应用程序”）和子类型（例如“vnd...”）都[可以是最大 127 个字符](https://datatracker.ietf.org/doc/html/rfc4288#section-4.2)。所以包括斜线在内，最大长度为 255。

**编辑：**同时，该文档已被[RFC 6838](https://datatracker.ietf.org/doc/html/rfc6838#section-4.2)废弃，它不会改变最大大小，但添加了一条注释：

> 另请注意，虽然此语法允许名称最多为 127 个字符，但实施限制可能会使此类长名称产生问题。因此，`<type-name>`应该`<subtype-name>`限制为 64 个字符。

# c# - WPF 中的动态控件和滑动面板/展开

> ID：643691
> 
> 赞同：0
> 
> 时间：2009-03-13T17:06:12.617
> 
> 标签：c#, .net, wpf, user-interface

做滑动面板是否容易，例如本[视频](http://www.youtube.com/watch?v=TbVIu61fQcA&feature=related)中的一个节目，其中控件是动态填充的，但在用户单击面板时也会展开/折叠。如果可见面板的高度大于应用程序的高度，它还允许滚动。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T18:01:56.213

是的。

为了回答您的下一个问题，滑动面板在您的 XAML 中与任何其他面板一样使用。对于一些示例控件，请检查[此问题](https://stackoverflow.com/questions/485232/is-there-a-wpf-control-i-can-use-to-expand-collapse-panels-animated)

# unicode - UTF-8 和 Unicode 有什么区别？

> ID：643694
> 
> 赞同：629
> 
> 时间：2009-03-13T17:06:46.190
> 
> 标签：unicode, encoding, utf-8, character-encoding, terminology

[根据Wikipedia UTF-8](http://en.wikipedia.org/wiki/UTF-8)页面，我从人们那里听到了相互矛盾的意见。

它们是一样的，不是吗？有人可以澄清吗？

* * *

## 回答 #1

> 赞同：580
> 
> 时间：2009-03-13T17:37:20.903

为了扩展其他人给出的答案：

我们有很多语言，有很多字符，计算机应该理想地显示。Unicode 为每个字符分配一个唯一的数字或代码点。

计算机处理诸如字节之类的数字......在这里跳过一点历史并忽略内存寻址问题，8位计算机会将8位字节视为硬件上容易表示的最大数字单位，16位计算机将扩展到两个字节，依此类推。

ASCII 等旧字符编码来自（前）8 位时代，并试图将当时计算中的主要语言，即英语，塞进从 0 到 127（7 位）的数字。字母表中有 26 个字母，包括大写和非大写形式、数字和标点符号，效果都很好。对于其他非英语语言，ASCII 被扩展了第 8 位，但通过此扩展提供的额外 128 个数字/代码点将根据所显示的语言映射到不同的字符。ISO-8859 标准是这种映射最常见的形式；ISO-8859-1 和 ISO-8859-15（也称为 ISO-Latin-1、latin1，是的，8859 ISO 标准也有两个不同的版本）。

但是，当您想要表示来自一种以上语言的字符时，这还不够，因此将所有可用字符塞进一个字节是行不通的。

本质上存在两种不同类型的编码：一种通过添加更多位来扩展值范围。这些编码的示例是 UCS2（2 字节 = 16 位）和 UCS4（4 字节 = 32 位）。它们本质上与 ASCII 和 ISO-8859 标准存在相同的问题，因为它们的值范围仍然有限，即使限制要高得多。

另一种类型的编码使用每个字符的可变字节数，最常见的编码是 UTF 编码。所有 UTF 编码的工作方式大致相同：您选择一个单位大小，UTF-8 为 8 位，UTF-16 为 16 位，UTF-32 为 32 位。然后，该标准将其中一些位定义为标志：如果设置了它们，则单元序列中的下一个单元将被视为同一字符的一部分。如果未设置，则此单位完全代表一个字符。因此，最常见的（英文）字符在 UTF-8 中仅占用一个字节（在 UTF-16 中为两个，在 UTF-32 中为 4 个），但其他语言字符可以占用六个字节或更多。

多字节编码（上面的解释我应该说多单元）的优点是它们相对节省空间，但缺点是查找子字符串、比较等操作都必须将字符解码为 un​​icode 码可以执行此类操作之前的点（尽管有一些快捷方式）。

UCS 标准和 UTF 标准都对 Unicode 中定义的代码点进行编码。理论上，这些编码可以用来编码任何数字（在编码支持的范围内）——当然，这些编码是用来编码 Unicode 代码点的。这就是他们之间的关系。

Windows 将所谓的“Unicode”字符串处理为 UTF-16 字符串，而如今大多数 UNIX 系统默认为 UTF-8。HTTP 等通信协议往往最适合 UTF-8，因为 UTF-8 中的单位大小与 ASCII 中的相同，并且大多数此类协议都是在 ASCII 时代设计的。另一方面，UTF-16 在表示所有现存语言时提供了最佳的*平均*空间/处理性能。

Unicode 标准定义的代码点少于 32 位可以表示的代码点。因此，出于所有实际目的，UTF-32 和 UCS4 成为相同的编码，因为您不太可能必须处理 UTF-32 中的多单元字符。

希望补充一些细节。

* * *

## 回答 #2

> 赞同：346
> 
> 时间：2015-01-14T09:07:10.350

Let me use an example to illustrate this topic:

```
A Chinese character:      汉
its Unicode value:        U+6C49
convert 6C49 to binary:   01101100 01001001 
```

Nothing magical so far, it's very simple. Now, let's say we decide to store this character on our hard drive. To do that, we need to store the character in binary format. We can simply store it as is '01101100 01001001'. Done!

But wait a minute, is '01101100 01001001' one character or two characters? You knew this is one character because I told you, but when a computer reads it, it has no idea. So we need some sort of encoding to tell the computer to treat it as one.

This is where the rules of UTF-8 come in: [https://www.fileformat.info/info/unicode/utf8.htm](https://www.fileformat.info/info/unicode/utf8.htm)

```
Binary format of bytes in sequence

1st Byte    2nd Byte    3rd Byte    4th Byte    Number of Free Bits   Maximum Expressible Unicode Value
0xxxxxxx                                                7             007F hex (127)
110xxxxx    10xxxxxx                                (5+6)=11          07FF hex (2047)
1110xxxx    10xxxxxx    10xxxxxx                  (4+6+6)=16          FFFF hex (65535)
11110xxx    10xxxxxx    10xxxxxx    10xxxxxx    (3+6+6+6)=21          10FFFF hex (1,114,111) 
```

According to the table above, if we want to store this character using the UTF-8 format, we need to prefix our character with some 'headers'. Our Chinese character is 16 bits long (count the binary value yourself), so we will use the format on row 3 as it provides enough space:

```
Header  Place holder    Fill in our Binary   Result         
1110    xxxx            0110                 11100110
10      xxxxxx          110001               10110001
10      xxxxxx          001001               10001001 
```

Writing out the result in one line:

```
11100110 10110001 10001001 
```

This is the UTF-8 binary value of the Chinese character! See for yourself: [https://www.fileformat.info/info/unicode/char/6c49/index.htm](https://www.fileformat.info/info/unicode/char/6c49/index.htm)

## Summary

```
A Chinese character:      汉
its Unicode value:        U+6C49
convert 6C49 to binary:   01101100 01001001
encode 6C49 as UTF-8:     11100110 10110001 10001001 
```

P.S. If you want to learn this topic in Python, [click here](https://nbviewer.jupyter.org/gist/guocheng/1ae6c2d76461a66cfc5ec6009b5791d1).

* * *

## 回答 #3

> 赞同：227
> 
> 时间：2009-03-13T17:11:10.000

不幸的是，根据上下文，“Unicode”以各种不同的方式使用。它最正确的用途 (IMO) 是作为*编码字符集*- 即一组字符以及字符与表示它们的整数*代码点之间的映射。*

[UTF-8](http://en.wikipedia.org/wiki/UTF-8)是一种字符编码——一种将字节序列转换为字符序列的方法，反之亦然。它涵盖了整个 Unicode 字符集。ASCII 被编码为每个字符一个字节，而其他字符占用更多字节，具体取决于它们的确切代码点（所有当前定义的代码点最多 4 个字节，即最多 U-0010FFFF，实际上 4 个字节可以处理最多U-001FFFFF）。

当“Unicode”用作字符编码的名称时（例如，作为 .NET [Encoding.Unicode](http://msdn.microsoft.com/en-us/library/system.text.encoding.unicode.aspx)属性），它通常表示[UTF-16](http://en.wikipedia.org/wiki/UTF-16)，它将最常见的字符编码为两个字节。某些平台（尤其是 .NET 和 Java）使用 UTF-16 作为其“本机”字符编码。如果您需要担心无法以单个 UTF-16 值编码的字符（它们被编码为“代理对”），这会导致棘手的问题 - 但大多数开发人员从不担心这一点，IME。

关于 Unicode 的一些参考资料：

*   [Unicode 联盟网站](http://unicode.org)，尤其是[教程](http://www.unicode.org/standard/tutorial-info.html)部分
*   [乔尔的文章](http://www.joelonsoftware.com/articles/Unicode.html)
*   [我自己的文章](http://csharpindepth.com/Articles/General/Unicode.aspx) （面向.NET）

* * *

## 回答 #4

> 赞同：119
> 
> 时间：2009-03-13T17:09:23.670

它们不是一回事——UTF-8 是一种特殊的 Unicode 编码方式。

根据您的应用程序和您打算使用的数据，您可以选择许多不同的编码。据我所知，最常见的是 UTF-8、UTF-16 和 UTF-32。

* * *

## 回答 #5

> 赞同：92
> 
> 时间：2009-03-13T17:14:36.747

Unicode 只定义了*代码点*，即代表一个字符的数字。您如何将这些代码点存储在内存中取决于您使用的*编码。*UTF-8 是编码 Unicode 字符的一种方式，等等。

* * *

## 回答 #6

> 赞同：38
> 
> 时间：2013-02-24T18:36:01.737

**Unicode**是一种标准，它与 ISO/IEC 10646 一起定义**通用字符集 (UCS)**，它是表示几乎所有已知语言所需的所有现有字符的超集。

Unicode为其曲目中的每个字符分配一个名称和一个数字（*字符代码*或*代码点）。*

**UTF-8 编码**，是一种在计算机内存中以数字方式表示这些字符的方法。UTF-8 将每个代码点映射到八位字节序列（8 位字节）

例如，

UCS 字符 = [Unicode 汉字](http://www.fileformat.info/info/unicode/char/24b62/index.htm)

UCS 代码点 = U+24B62

UTF-8 编码 = F0 A4 AD A2 (hex) = 11110000 10100100 10101101 10100010 (bin)

* * *

## 回答 #7

> 赞同：25
> 
> 时间：2009-03-13T17:37:07.193

[Unicode](http://en.wikipedia.org/wiki/Unicode)只是一个标准，它定义了一个字符集 ( [UCS](http://en.wikipedia.org/wiki/Universal_Character_Set) ) 和编码 ( [UTF](http://en.wikipedia.org/wiki/Unicode_Transformation_Format) ) 来编码这个字符集。但总的来说，Unicode 是指字符集而不是标准。

[在 5 分钟内](http://wiki.secondlife.com/wiki/Unicode_In_5_Minutes)阅读[每个软件开发人员绝对、绝对必须了解 Unicode 和字符集（没有借口！）](http://www.joelonsoftware.com/articles/Unicode.html)和Unicode 的绝对最低要求。

* * *

## 回答 #8

> 赞同：23
> 
> 时间：2014-05-19T13:57:22.447

* * *

## 回答 #9

> 赞同：21
> 
> 时间：2017-09-26T05:05:13.883

**UTF-8** is one possible encoding scheme for **Unicode** text.

**Unicode** is a broad-scoped standard which defines over 140,000 characters and allocates each a numerical code (a code point). It also defines rules for how to sort this text, normalise it, change its case, and more. A character in Unicode is represented by a code point from zero up to 0x10FFFF inclusive, though some code points are reserved and cannot be used for characters.

There is more than one way that a string of Unicode code points can be encoded into a binary stream. These are called "encodings". The most straightforward encoding is **UTF-32**, which simply stores each code point as a 32-bit integer, with each being 4 bytes wide. Since code points only go up to 0x10FFFF (requiring 21 bits), this encoding is somewhat wasteful.

**UTF-8** is another encoding, and is becoming the de-facto standard, due to a number of advantages over UTF-32 and others. UTF-8 encodes each code point as a sequence of either 1, 2, 3 or 4 byte values. Code points in the ASCII range are encoded as a single byte value, to be compatible with ASCII. Code points outside this range use either 2, 3, or 4 bytes each, depending on what range they are in.

UTF-8 has been designed with these properties in mind:

*   ASCII characters are encoded exactly as they are in ASCII, such that an ASCII string is also a valid UTF-8 string representing the same characters.

*   More efficient: Text strings in UTF-8 almost always occupy less space than the same strings in either UTF-32 or UTF-16, with just a few exceptions.

*   Binary sorting: Sorting UTF-8 strings using a binary sort will still result in all code points being sorted in numerical order.

*   When a code point uses multiple bytes, none of those bytes contain values in the ASCII range, ensuring that no part of them could be mistaken for an ASCII character. This is also a security feature.

*   UTF-8 can be easily validated, and distinguished from other character encodings by a validator. Text in other 8-bit or multi-byte encodings will very rarely also validate as UTF-8 due to the very specific structure of UTF-8.

*   Random access: At any point in a UTF-8 string it is possible to tell if the byte at that position is the first byte of a character or not, and to find the start of the next or current character, without needing to scan forwards or backwards more than 3 bytes or to know how far into the string we started reading from.

* * *

## 回答 #10

> 赞同：18
> 
> 时间：2015-01-05T09:28:52.563

## 1\. Unicode

There're lots of characters around the world,like "$,&,h,a,t,?,张,1,=,+...".

Then there comes an organization who's dedicated to these characters,

They made a standard called "Unicode".

The standard is like follows:

*   create a form in which each position is called "code point",or"code position".
*   The whole positions are from U+0000 to U+10FFFF;
*   Up until now,some positions are filled with characters,and other positions are saved or empty.
*   For example,the position "U+0024" is filled with the character "$".

PS:Of course there's another organization called ISO maintaining another standard --"ISO 10646"，nearly the same.

## 2\. UTF-8

As above,U+0024 is just a position,so we can't save "U+0024" in computer for the character "$".

There must be an encoding method.

Then there come encoding methods,such as UTF-8,UTF-16,UTF-32,UCS-2....

Under UTF-8,the code point "U+0024" is encoded into 00100100.

00100100 is the value we save in computer for "$".

* * *

## 回答 #11

> 赞同：13
> 
> 时间：2019-07-18T07:17:46.627

If I may summarise what I gathered from this thread:

Unicode assigns **characters** to **ordinal numbers (in decimal form)**. (These numbers are called code points.)

```
à -> 224 
```

UTF-8 is an encoding that 'translates' these **ordinal numbers (in decimal form)** to **binary *representations***.

```
224 -> 11000011 10100000 
```

Note that we're talking about the binary *representation* of 224, not its binary form, which is 0b11100000.

* * *

## 回答 #12

> 赞同：12
> 
> 时间：2011-05-30T09:37:52.173

我已经检查了 Gumbo 答案中的链接，并且我想将其中的一部分粘贴到 Stack Overflow 上。

“......有些人误以为 Unicode 只是一个 16 位代码，其中每个字符占用 16 位，因此有 65,536 个可能的字符。这实际上是不正确的。这是关于 Unicode 的最常见的神话，所以如果你这么想，不要难过。

事实上，Unicode 对字符有不同的思考方式，你必须了解 Unicode 对事物的思考方式，否则什么都说不通。

到目前为止，我们假设一个字母映射到一些可以存储在磁盘或内存中的位：

A -> 0100 0001

在 Unicode 中，一个字母映射到一个称为代码点的东西，这仍然只是一个理论概念。该代码点如何在内存或磁盘中表示是另一回事......”

“...每个字母表中的每个柏拉图字母都由 Unicode 联盟分配了一个幻数，如下所示：U+0639。这个幻数称为代码点。U+ 表示“Unicode”，数字是十六进制。 U+0639 是阿拉伯字母 Ain。英文字母 A 将是 U+0041...."

"...好吧，假设我们有一个字符串：

你好

在 Unicode 中，它对应于这五个代码点：

U+0048 U+0065 U+006C U+006C U+006F。

只是一堆代码点。数字，真的。我们还没有说明如何将它存储在内存中或在电子邮件中表示它......”

“......这就是编码的用武之地。

导致关于两个字节的神话的 Unicode 编码的最早想法是，嘿，让我们将这些数字分别存储在两个字节中。所以*你好*变成

00 48 00 65 00 6C 00 6C 00 6F

对？没那么快！难道也不能这样：

48 00 65 00 6C 00 6C 00 6F 00 ? ……”

* * *

## 回答 #13

> 赞同：11
> 
> 时间：2019-10-12T04:30:59.687

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2018-01-11T19:12:34.130

> They are the same thing, aren't they?

**No, they aren't.**

* * *

I think the first sentence of the [Wikipedia page](https://en.wikipedia.org/wiki/UTF-8) you referenced gives a nice, brief summary:

> UTF-8 is a variable width character encoding capable of encoding all 1,112,064 valid code points in Unicode using one to four 8-bit bytes.

To elaborate:

*   **Unicode** is a standard, which defines a **map from characters to** numbers, the so-called **code points**, (like in the example below). For the full mapping, you can have a look [here](https://en.wikipedia.org/wiki/List_of_Unicode_characters).

    ```
    ! -> U+0021 (21),  
    " -> U+0022 (22),  
    \# -> U+0023 (23) 
    ```

*   **UTF-8 is one of the ways to encode these code points in** a form a computer can understand, aka **bits**. In other words, it's a way/algorithm to convert each of those code points to a sequence of bits or convert a sequence of bits to the equivalent code points. Note that there are a lot of alternative encodings for Unicode.

* * *

Joel gives a really nice explanation and an overview of the history [here](https://www.joelonsoftware.com/2003/10/08/the-absolute-minimum-every-software-developer-absolutely-positively-must-know-about-unicode-and-character-sets-no-excuses/).

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2018-01-26T13:35:55.527

**UTF-8** is a method for encoding Unicode characters using 8-bit sequences.

**Unicode** is a standard for representing a great variety of characters from many languages.

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2022-01-15T01:23:39.753

My explanation, after reading numerous posts and articles about this topic:

# 1 - The Unicode Character Table

"Unicode" is a giant table, that is 21bits wide, these 21bits provide room for 1,114,112 codepoints / values / fields / places to store characters in.

Out of those 1,114,112 codepoints, 1,111,998 are able to store Unicode characters, because there are 2048 codepoints reserved as surrogates, and 66 codepoints reserved as non-characters. So, there are 1,111,998 codepoints that can store a unique character, symbol, emoji and etc.

However, as of now, only 144,697 out of those 1,114,112 codepoints, have been used. These 144,697 codepoints contain characters that cover all of the languages, as well as symbols, emojis and etc.

Each character in the "Unicode" is assigned to a specific codepoint aka has a specific value / Unicode number. For Example the character "❤&quot;, has the following value aka Unicode number "U+2764". The value "U+2764" takes exactly one codepoint out of the 1,114,112 codepoints. The value "U+2764" looks like that in binary: "11100010 10011101 10100100", which is exactly 3 bytes or 24bits (without the two empty space characters, each of which taking 1 bit, but I have added them for visual purposes only, in order to make the 24bits more readable, so please ignore them).

Now, how is our computer supposed to know if those 3 byters "11100010 10011101 10100100" are to be read separate or together? If those 3 bytes are read separate and then converted to characters the result would be "Ô, Ø, ñ", which is quite the difference compared to our heart emoji "❤&quot;.

# 2 - Encoding Standarts (UTF-8, ISO-8859, Windows-1251 and etc)

In order to solve this problem people have invented the Encoding Standarts. The most popular one being UTF-8, since 2008\. UTF-8 accounts for an average of 97.6% of all web pages, that is why we will UTF-8, for the example below.

## 2.1 - What is Encoding?

Encoding, simply said means to to convert something, from one thing to another. In our case we are converting data, more specifically bytes to the UTF-8 format, I would also like to rephrase that sentence as: "converting bytes to UTF-8 bytes", although it might not be technically correct.

## 2.2 Some information about the UTF-8 format, and why it's so important

UTF-8 uses a minimum of 1 bytes to store a character and a maximum of 4 bytes. Thanks to the UTF-8 format we can have characters which take more than 1 byte of information.

This is very important, because if it was not for the UTF-8 format, we would not be able to have such a vast diversity of alphabets, since the letters of some alphabets can't fit into 1 byte, We also wouldn't have emojis at all, since each one requires atleast 3 bytes. I am pretty sure you got the point by now, so let's continue forward.

## 2.3 Example of Encoding a Chinese character to UTF-8

Now, lets say we have the Chinese character "汉&quot;.

This character takes exactly 16 binary bits "01101100 01001001", thus as we discussed above, we can not read this character, unless we encode it to UTF-8, because the computer will have no way of knowing, if these 2 bytes are to be read seperately or together.

Converting this "汉&quot; character's 2 bytes into, as I like to call it UTF-8 bytes, will result in the following:

(Normal Bytes) "01101100 01001001" -> (UTF-8 Encoded Bytes) "11100110 10110001 10001001"

Now, how did we end up with 3 bytes instead of 2? How is that supposed to be UTF-8 Encoding, turning 2 bytes into 3?

In order to explain how the UTF-8 encoding works, I am going to literally copy the reply of @MatthiasBraun, a big shoutout to him for his terrific explanation.

## 2.4 How does the UTF-8 encoding actually work?

What we have here is the template for Encoding bytes to UTF-8\. This is how Encoding happens, pretty exciting if you ask me!

Now, take a good look at the table below and then we are going to go through it together.

```
 Binary format of bytes in sequence:

        1st Byte    2nd Byte    3rd Byte    4th Byte    Number of Free Bits   Maximum Expressible Unicode Value
        0xxxxxxx                                                7             007F hex (127)
        110xxxxx    10xxxxxx                                (5+6)=11          07FF hex (2047)
        1110xxxx    10xxxxxx    10xxxxxx                  (4+6+6)=16          FFFF hex (65535)
        11110xxx    10xxxxxx    10xxxxxx    10xxxxxx    (3+6+6+6)=21          10FFFF hex (1,114,111) 
```

> 1.  The "x" characters in the table above represent the number of "Free Bits", those bits are empty and we can write to them.
>     
>     
> 2.  The other bits are reserved for the UTF-8 format, they are used as headers / markers. Thanks to these headers, when the bytes are being read using the UTF-8 encoding, the computer knows, which bytes to read together and which seperately.
>     
>     
> 3.  The byte size of your character, after being encoded using the UTF-8 format, depends on how many bits you need to write.
>     
>     
> 
> *   In our case the "汉&quot; character is exactly 2 bytes or 16bits:
>     
>     
> *   "01101100 01001001"
>     
>     
> *   thus the size of our character after being encoded to UTF-8, will be 3 bytes or 24bits
>     
>     
> *   "11100110 10110001 10001001"
>     
>     
> *   because "3 UTF-8 bytes" have 16 Free Bits, which we can write to
>     
>     
> 
> 4.  Solution, step by step below:

## 2.5 Solution:

```
 Header  Place holder    Fill in our Binary   Result         
        1110    xxxx            0110                 11100110
        10      xxxxxx          110001               10110001
        10      xxxxxx          001001               10001001 
```

## 2.6 Summary:

```
 A Chinese character:      汉
        its Unicode value:        U+6C49
        convert 6C49 to binary:   01101100 01001001
        encode 6C49 as UTF-8:     11100110 10110001 10001001 
```

# 3 - The difference between UTF-8, UTF-16 and UTF-32

Original explanation of the difference between the UTF-8, UTF-16 and UTF-32 encodings: [https://javarevisited.blogspot.com/2015/02/difference-between-utf-8-utf-16-and-utf.html](https://javarevisited.blogspot.com/2015/02/difference-between-utf-8-utf-16-and-utf.html)

The main difference between UTF-8, UTF-16, and UTF-32 character encodings is how many bytes they require to represent a character in memory:

UTF-8 uses a minimum of 1 byte, but if the character is bigger, then it can use 2, 3 or 4 bytes. UTF-8 is also compatible with the ASCII table.

UTF-16 uses a minimum of 2 bytes. UTF-16 can not take 3 bytes, it can either take 2 or 4 bytes. UTF-16 is not compatible with the ASCII table.

UTF-32 always uses 4 bytes.

Remember: UTF-8 and UTF-16 are variable-length encodings, where UTF-8 can take 1 to 4 bytes, while UTF-16 will can take either 2 or 4 bytes. UTF-32 is a fixed-width encoding, it always takes 32 bits.

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2022-01-04T14:50:54.587

So you end up here usually from Google, and want to try different stuff.
But how do you print and convert all these character sets?

Here I list a few useful one-liners.

In **Powershell**:

```
# Print character with the Unicode point (U+<hexcode>) using this: 
[char]0x2550

# With Python installed, you can print the unicode character from U+xxxx with:
python -c 'print(u"\u2585")' 
```

If you have more Powershell trix or shortcuts, please comment.

In **Bash**, you'd appreciate the `iconv`, `hexdump` and `xxd` from the `libiconv` and `util-linux` packages (probably named differently on other *nix distros.)

```
# To print the 3-byte hex code for a Unicode character:
printf "\\\x%s" $(printf '═'|xxd -p -c1 -u)
#\xE2\x95\x90

# To print the Unicode character represented by hex string:
printf '\xE2\x96\x85'
#▅

# To convert from UTF-16LE to Unicode
echo -en "════"| iconv -f UTF-16LE -t UNICODEFFFE

# To convert a string into hex: 
echo -en '═�'| xxd -g 1
#00000000: e2 95 90 ef bf bd

# To convert a string into binary:
echo -en '═�\n'| xxd -b
#00000000: 11100010 10010101 10010000 11101111 10111111 10111101  ......
#00000006: 00001010

# To convert a binary string into hex:
printf  '%x\n' "$((2#111000111000000110000010))"
#e38182 
```

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2021-11-10T21:52:53.957

*As a simple answer that gets straight to the point:*

*   Unicode is a standard for representing characters from many human languages.
*   UTF-8 is a method for encoding Unicode characters.

* * *

* *Yes: I'm overlooking the inner workings of UTF-8 on purpose.*

# c# - 使用文本文件转换值

> ID：643695
> 
> 赞同：1
> 
> 时间：2009-03-13T17:06:59.900
> 
> 标签：c#

我正在尝试用 C# 编写一个控制台应用程序，它允许用户以 x,pound,ounce 格式输入以下信息，其中 X 是要转换的值。

我创建了一个文本文件，其中包含以下格式的转换因子。

磅，盎司，16.0

我希望应用程序做的是获取用户输入，然后在文本文件中找到正确的转换因子，然后计算结果。

我尝试使用 Node 类来循环浏览转换因子列表，但它似乎不起作用 =(

你能帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T17:14:53.500

使用流阅读器可以轻松逐行读取文件。然后，您可以通过拆分字符串来获取这三位。这看起来像这样：

```
string line;
StreamReader reader = new StreamReader(filePath);
while(null != (line = reader.Read())
{
   //You have to create the constant COMMA_SEP
   string split = line.Split(COMMA_SEP);
} 
```

做出正确的计算是你必须创造的。例如，知道列表中的开始和结束，您可以创建一个类的状态机类型，该类返回要调用的正确类。然后，您创建一个工厂类以返回一个包含您想要的算法的类。

```
public class CalculatorFactory
{
    public ICalculator GetCalculator(string origin, string result)
    {
          //Implementation to get correct calculator
    }
} 
```

然后你可以在这个接口上调用Calculate方法得到你的答案。

说得通？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-21T23:33:53.080

我设法使用数组来解决它:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T17:26:29.667

转换因子的平面文件不够企业化。您需要将这些因素存储在 XML 中：

```
<?xml version="1.0" encoding="utf-8" ?>
<ConversionFactors>
  <ConversionFactor>
    <From>Pounds</From>
    <To>Ounce</From>
    <Factor>16</Factor>
  </ConversionFactor>
  <ConversionFactor>
    <From>Fortnight</From>
    <To>Day</From>
    <Factor>14</Factor>
  </ConversionFactor>
  <ConversionFactor>
    <From>KesselRun</From>
    <To>Parsec</From>
    <Factor>12</Factor>
  </ConversionFactor>
</ConversionFactors> 
```

通过这种方式，您可以创建一个`XmlDocument`对象并使用 XPath 表达式选择您的转换因子。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T17:30:21.390

有很多方法可以解决这个问题。这是一个简单的方法，可以用很少的代码解决问题：

创建一个字典来保存转换；对于文件中的每个转换因子行，您可以执行转换因子.Add(from-to, value)，其中 from-to 是这两个单位的串联 - 它只是一个查找键，所以没关系你如何格式化它。假设是用户将输入相同的文本字符串。

然后获取用户的输入，构造从到“键”，通过执行字典[from_to] 从字典中获取转换因子“值”并进行乘法。

当然不优雅，但它可能是十几行代码。听起来像家庭作业，所以我会留下我的解决方案。

# python - 如何使用 numpy.correlate 进行自相关？

> ID：643699
> 
> 赞同：125
> 
> 时间：2009-03-13T17:07:53.470
> 
> 标签：python, math, numpy, numerical-methods

我需要对一组数字进行自相关，据我所知，这只是该组与自身的相关。

我已经尝试使用 numpy 的相关函数，但我不相信结果，因为它几乎总是给出第一个数字*不是*最大的向量，因为它应该是。

所以，这个问题实际上是两个问题：

1.  究竟在[`numpy.correlate`](https://docs.scipy.org/doc/numpy/reference/generated/numpy.correlate.html)做什么？
2.  我如何使用它（或其他东西）进行自相关？

* * *

## 回答 #1

> 赞同：134
> 
> 时间：2009-03-24T06:09:02.647

要回答您的第一个问题，`numpy.correlate(a, v, mode)`是执行`a`与反向的卷积`v`并给出由指定模式裁剪的结果。[卷积](http://mathworld.wolfram.com/Convolution.html)的定义，C(t)=∑ [-∞ < i < ∞] a [i] v [t+i] where -∞ < t < ∞，允许从 -∞ 到 ∞ 的结果，但你显然不能存储无限长的大批。所以它必须被剪裁，这就是模式的用武之地。有 3 种不同的模式：完整、相同和有效：

*   “完整”模式返回每个`t`位置的结果，`a`并且`v`有一些重叠。
*   `a`“相同”模式返回与最短向量 (或)长度相同的结果`v`。
*   “有效”模式仅在完全重叠`a`时返回结果。`v`的[文档](http://docs.scipy.org/doc/numpy/reference/generated/numpy.convolve.html)提供`numpy.convolve`了有关模式的更多详细信息。

对于你的第二个问题，我认为`numpy.correlate` *是*给你自相关，它也只是给你更多。自相关用于找出信号或函数在某个时间差与其自身的相似程度。在时间差为 0 时，自相关应该是最高的，因为信号与其自身相同，因此您预计自相关结果数组中的第一个元素将是最大的。但是，相关性并不是从 0 的时间差开始。它从负的时间差开始，接近 0，然后变为正数。也就是说，您期望：

自相关 (a) = ∑ [-∞ < i < ∞] a [i] v [t+i]其中 0 <= t < ∞

但你得到的是：

自相关(a) = ∑ [-∞ < i < ∞] a [i] v [t+i]其中 -∞ < t < ∞</p>

您需要做的是获取相关结果的后半部分，这应该是您正在寻找的自相关。一个简单的python函数可以做到这一点：

```
def autocorr(x):
    result = numpy.correlate(x, x, mode='full')
    return result[result.size/2:] 
```

当然，您需要进行错误检查以确保它`x`实际上是一维数组。此外，这种解释可能不是最严格的数学解释。我一直在抛出无穷大，因为卷积的定义使用它们，但这并不一定适用于自相关。因此，这种解释的理论部分可能有点不可靠，但希望实际结果会有所帮助。[这些关于自相关的](http://mathworld.wolfram.com/Autocorrelation.html) [页面](http://en.wikipedia.org/wiki/Autocorrelation)非常有帮助，如果您不介意涉足符号和繁重的概念，它们可以为您提供更好的理论背景。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2011-11-02T13:27:37.917

自相关有两个版本：统计和卷积。它们都做同样的事情，除了一点细节：统计版本被标准化为区间 [-1,1]。这是您如何进行统计的示例：

```
def acf(x, length=20):
    return numpy.array([1]+[numpy.corrcoef(x[:-i], x[i:])[0,1]  \
        for i in range(1, length)]) 
```

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2018-07-04T07:32:40.810

我认为有两件事给这个话题增加了混乱：

1.  统计与信号处理的定义：正如其他人指出的那样，在统计中，我们将自相关归一化为 [-1,1]。
2.  部分与非部分均值/方差：当时间序列以滞后 > 0 移动时，它们的重叠大小将始终 < 原始长度。我们是使用原始（非部分）的均值和标准差，还是总是使用不断变化的重叠（部分）计算新的均值和标准差。（这可能有一个正式的术语，但我现在要使用“部分”）。

我创建了 5 个函数来计算一维数组的自相关，具有部分与非部分的区别。有些使用统计公式，有些使用信号处理意义上的相关，也可以通过 FFT 完成。**但所有结果都是统计**定义中的自相关，因此它们说明了它们如何相互关联。下面的代码：

```
import numpy
import matplotlib.pyplot as plt

def autocorr1(x,lags):
    '''numpy.corrcoef, partial'''

    corr=[1\. if l==0 else numpy.corrcoef(x[l:],x[:-l])[0][1] for l in lags]
    return numpy.array(corr)

def autocorr2(x,lags):
    '''manualy compute, non partial'''

    mean=numpy.mean(x)
    var=numpy.var(x)
    xp=x-mean
    corr=[1\. if l==0 else numpy.sum(xp[l:]*xp[:-l])/len(x)/var for l in lags]

    return numpy.array(corr)

def autocorr3(x,lags):
    '''fft, pad 0s, non partial'''

    n=len(x)
    # pad 0s to 2n-1
    ext_size=2*n-1
    # nearest power of 2
    fsize=2**numpy.ceil(numpy.log2(ext_size)).astype('int')

    xp=x-numpy.mean(x)
    var=numpy.var(x)

    # do fft and ifft
    cf=numpy.fft.fft(xp,fsize)
    sf=cf.conjugate()*cf
    corr=numpy.fft.ifft(sf).real
    corr=corr/var/n

    return corr[:len(lags)]

def autocorr4(x,lags):
    '''fft, don't pad 0s, non partial'''
    mean=x.mean()
    var=numpy.var(x)
    xp=x-mean

    cf=numpy.fft.fft(xp)
    sf=cf.conjugate()*cf
    corr=numpy.fft.ifft(sf).real/var/len(x)

    return corr[:len(lags)]

def autocorr5(x,lags):
    '''numpy.correlate, non partial'''
    mean=x.mean()
    var=numpy.var(x)
    xp=x-mean
    corr=numpy.correlate(xp,xp,'full')[len(x)-1:]/var/len(x)

    return corr[:len(lags)]

if __name__=='__main__':

    y=[28,28,26,19,16,24,26,24,24,29,29,27,31,26,38,23,13,14,28,19,19,\
            17,22,2,4,5,7,8,14,14,23]
    y=numpy.array(y).astype('float')

    lags=range(15)
    fig,ax=plt.subplots()

    for funcii, labelii in zip([autocorr1, autocorr2, autocorr3, autocorr4,
        autocorr5], ['np.corrcoef, partial', 'manual, non-partial',
            'fft, pad 0s, non-partial', 'fft, no padding, non-partial',
            'np.correlate, non-partial']):

        cii=funcii(y,lags)
        print(labelii)
        print(cii)
        ax.plot(lags,cii,label=labelii)

    ax.set_xlabel('lag')
    ax.set_ylabel('correlation coefficient')
    ax.legend()
    plt.show() 
```

这是输出图：

[![在此处输入图像描述](https://i.stack.imgur.com/cXdbN.png)](https://i.stack.imgur.com/cXdbN.png)

我们没有看到所有 5 条线，因为其中 3 条重叠（在紫色处）。重叠都是非部分自相关。这是因为信号处理方法 ( `np.correlate`, FFT) 的计算不会为每个重叠计算不同的均值/标准差。

另请注意，`fft, no padding, non-partial`（红线）结果是不同的，因为它在进行 FFT 之前没有用 0 填充时间序列，所以它是循环 FFT。我无法详细解释为什么，这是我从其他地方学到的。

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2014-02-18T19:10:37.863

使用[`numpy.corrcoef`](https://docs.scipy.org/doc/numpy/reference/generated/numpy.corrcoef.html)函数而不是[`numpy.correlate`](https://docs.scipy.org/doc/numpy/reference/generated/numpy.correlate.html)计算滞后 t 的统计相关性：

```
def autocorr(x, t=1):
    return numpy.corrcoef(numpy.array([x[:-t], x[t:]])) 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2013-06-13T14:52:10.863

由于我刚刚遇到同样的问题，我想与您分享几行代码。事实上，到目前为止，关于 stackoverflow 中自相关的文章有几篇非常相似的文章。如果您将自相关定义为`a(x, L) = sum(k=0,N-L-1)((xk-xbar)*(x(k+L)-xbar))/sum(k=0,N-1)((xk-xbar)**2)`[这是 IDL 的 a_correlate 函数中给出的定义，并且它与我在问题[#12269834](https://stackoverflow.com/questions/12269834/is-there-any-numpy-autocorrellation-function-with-standardized-output)的答案 2 中看到的一致]，那么以下似乎给出了正确的结果：

```
import numpy as np
import matplotlib.pyplot as plt

# generate some data
x = np.arange(0.,6.12,0.01)
y = np.sin(x)
# y = np.random.uniform(size=300)
yunbiased = y-np.mean(y)
ynorm = np.sum(yunbiased**2)
acor = np.correlate(yunbiased, yunbiased, "same")/ynorm
# use only second half
acor = acor[len(acor)/2:]

plt.plot(acor)
plt.show() 
```

如您所见，我已经使用 sin 曲线和均匀随机分布对此进行了测试，这两个结果看起来都符合我的预期。请注意，我使用`mode="same"`而不是`mode="full"`像其他人那样使用。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2016-10-20T12:46:02.253

您的问题 1 已经在这里的几个优秀答案中得到了广泛讨论。

我想与您分享几行代码，它们允许您仅基于自相关的数学属性来计算信号的自相关。也就是说，可以通过以下方式计算自相关：

1.  从信号中减去平均值并获得无偏信号

2.  计算无偏信号的傅里叶变换

3.  通过取无偏信号的傅里叶变换的每个值的平方范数，计算信号的功率谱密度

4.  计算功率谱密度的傅里叶逆变换

5.  通过无偏信号的平方和对功率谱密度的傅里叶逆变换进行归一化，并且只取结果向量的一半

执行此操作的代码如下：

```
def autocorrelation (x) :
    """
    Compute the autocorrelation of the signal, based on the properties of the
    power spectral density of the signal.
    """
    xp = x-np.mean(x)
    f = np.fft.fft(xp)
    p = np.array([np.real(v)**2+np.imag(v)**2 for v in f])
    pi = np.fft.ifft(p)
    return np.real(pi)[:x.size/2]/np.sum(xp**2) 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2019-04-24T18:38:24.547

numpy.correlate 的替代方法在[statsmodels.tsa.stattools.acf()](https://www.statsmodels.org/stable/generated/statsmodels.tsa.stattools.acf.html)中可用。这会产生一个不断减小的自相关函数，就像 OP 所描述的那样。实现它相当简单：

```
from statsmodels.tsa import stattools
# x = 1-D array
# Yield normalized autocorrelation function of number lags
autocorr = stattools.acf( x )

# Get autocorrelation coefficient at lag = 1
autocorr_coeff = autocorr[1] 
```

默认行为是在 40 nlag 处停止，但这可以通过`nlag=`针对您的特定应用程序的选项进行调整。[该功能背后的统计数据在](https://www.jstor.org/stable/25049287?seq=1#metadata_info_tab_contents)页面底部有一个引文。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-04-12T15:25:30.047

我是一名计算生物学家，当我必须计算随机过程的时间序列对之间的自/互相关时，我意识到这`np.correlate`并没有做我需要的工作。

实际上，似乎缺少的`np.correlate`是对距离***上所有可能的时间点的平均***。

这是我如何定义一个函数来做我需要的：

```
def autocross(x, y):
    c = np.correlate(x, y, "same")
    v = [c[i]/( len(x)-abs( i - (len(x)/2)  ) ) for i in range(len(c))]
    return v 
```

在我看来，以前的答案都没有涵盖这个自/互相关的例子：希望这个答案对像我这样从事随机过程的人有用。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-12-22T05:06:48.107

我使用 talib.CORREL 进行这样的自相关，我怀疑你可以对其他包做同样的事情：

```
def autocorrelate(x, period):

    # x is a deep indicator array 
    # period of sample and slices of comparison

    # oldest data (period of input array) may be nan; remove it
    x = x[-np.count_nonzero(~np.isnan(x)):]
    # subtract mean to normalize indicator
    x -= np.mean(x)
    # isolate the recent sample to be autocorrelated
    sample = x[-period:]
    # create slices of indicator data
    correls = []
    for n in range((len(x)-1), period, -1):
        alpha = period + n
        slices = (x[-alpha:])[:period]
        # compare each slice to the recent sample
        correls.append(ta.CORREL(slices, sample, period)[-1])
    # fill in zeros for sample overlap period of recent correlations    
    for n in range(period,0,-1):
        correls.append(0)
    # oldest data (autocorrelation period) will be nan; remove it
    correls = np.array(correls[-np.count_nonzero(~np.isnan(correls)):])      

    return correls

# CORRELATION OF BEST FIT
# the highest value correlation    
max_value = np.max(correls)
# index of the best correlation
max_index = np.argmax(correls) 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-07-23T13:22:38.553

没有熊猫的简单解决方案：

```
import numpy as np

def auto_corrcoef(x):
   return np.corrcoef(x[1:-1], x[2:])[0,1] 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-09-17T06:20:55.287

使用傅里叶变换和卷积定理

时间复杂度为 **N*log(N)**

```
def autocorr1(x):
    r2=np.fft.ifft(np.abs(np.fft.fft(x))**2).real
    return r2[:len(x)//2] 
```

这是一个标准化和无偏的版本，它也是 **N*log(N)**

```
def autocorr2(x):
    r2=np.fft.ifft(np.abs(np.fft.fft(x))**2).real
    c=(r2/x.shape-np.mean(x)**2)/np.std(x)**2
    return c[:len(x)//2] 
```

A. Levy 提供的方法有效，但我在我的 PC 上测试过，它的时间复杂度似乎是**N*N**

```
def autocorr(x):
    result = numpy.correlate(x, x, mode='full')
    return result[result.size/2:] 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-02-01T21:17:42.833

我认为 OP 问题的真正答案简洁地包含在 Numpy.correlate 文档的摘录中：

```
mode : {'valid', 'same', 'full'}, optional
    Refer to the `convolve` docstring.  Note that the default
    is `valid`, unlike `convolve`, which uses `full`. 
```

这意味着，当没有“模式”定义使用时，Numpy.correlate 函数将返回一个标量，当给定其两个输入参数的相同向量时（即 - 当用于执行自相关时）。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-10-08T12:42:32.750

绘制给定 pandas datatime 返回系列的统计自相关：

```
import matplotlib.pyplot as plt

def plot_autocorr(returns, lags):
    autocorrelation = []
    for lag in range(lags+1):
        corr_lag = returns.corr(returns.shift(-lag)) 
        autocorrelation.append(corr_lag)
    plt.plot(range(lags+1), autocorrelation, '--o')
    plt.xticks(range(lags+1))
    return np.array(autocorrelation) 
```

# java - “缓存项被锁定”导致休眠中的 Select 语句

> ID：643700
> 
> 赞同：3
> 
> 时间：2009-03-13T17:08:16.903
> 
> 标签：java, hibernate, jpa, ehcache, second-level-cache

我无法完全按照我想要的方式获得一些缓存来使用休眠。我创建了一些示例代码来复制我遇到的这个问题。

我有一个包含自身实例的对象。例如，由多个 Part 组成的 Part。

当更新的对象进入时，我真的需要最小化 Hibernate 正在使用的 select 语句。在查看日志后，我看到导致 SELECT 语句的日志输出：

**缓存项被锁定：com.cache.dataobject.Part.parts#1**

我可以在注释映射、xml 文件、缓存提供程序或逻辑中进行哪些更改以防止缓存项被锁定？我真的很想摆脱那个选择语句。

我包括了实体、数据对象、我正在测试的代码和日志输出。

**休眠版本：** 3.4

**EHCache 版本：** 1.2.3（包含在 Hibernate 下载中）

**部分数据对象：**

```
package com.cache.dataobject;

import java.io.Serializable;
import java.lang.String;
import java.util.List;

import javax.persistence.*;

import org.hibernate.annotations.Cache;
import org.hibernate.annotations.CacheConcurrencyStrategy;

import static javax.persistence.CascadeType.ALL;

/**
 * Entity implementation class for Entity: Part
 * 
 */
@Entity
@Cache(usage = CacheConcurrencyStrategy.READ_WRITE)
public class Part implements Serializable {

    private int id;
    private String name;
    private static final long serialVersionUID = 1L;
    private Part mainPart;
    private List<Part> parts;

    public Part() {
        super();
    }

    @Id
    public int getId() {
        return this.id;
    }

    public void setId(int id) {
        this.id = id;
    }

    @Column(name = "PART_NAME")
    public String getName() {
        return this.name;
    }

    public void setName(String name) {
        this.name = name;
    }

    @ManyToOne(cascade = ALL)
    public Part getMainPart() {
        return mainPart;
    }

    public void setMainPart(Part mainPart) {
        this.mainPart = mainPart;
    }

    @OneToMany(cascade = ALL)
    @JoinColumn(name = "mainPart_id", referencedColumnName = "id")
    @Cache(usage = CacheConcurrencyStrategy.READ_WRITE)
    public List<Part> getParts() {
        return parts;
    }

    public void setParts(List<Part> parts) {
        this.parts = parts;
    }

} 
```

**缓存道：**

```
package com.cache.dao;

import java.util.List;

import javax.ejb.Stateless;
import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;
import javax.persistence.Query;

import com.cache.dataobject.Part;

/**
 * Session Bean implementation class CacheDao
 */
@Stateless(mappedName = "ejb/CacheDao")
public class CacheDao implements CacheDaoRemote {

    @PersistenceContext(unitName="CacheProjectUnit")
    EntityManager em;

    /**
     * Default constructor. 
     */
    public CacheDao() {
        // TODO Auto-generated constructor stub
    }

    public Part addPart(Part part){
        System.out.println("CALLED PERSIST");
        em.persist(part);
        return part;
    }

    public Part updatePart(Part part){
        System.out.println("CALLED MERGE");
        em.merge(part);
        return part;
    }

} 
```

**测试客户端代码：**

```
package com.cache.dao;

import java.util.ArrayList;
import java.util.List;

import javax.naming.InitialContext;
import javax.naming.NamingException;

import com.cache.dao.CacheDaoRemote;
import com.cache.dataobject.Part;

public class test {

    /**
     * @param args
     */
    public static void main(String[] args) {
        InitialContext ctx;
        try {
            ctx = new InitialContext();
            CacheDaoRemote dao = (CacheDaoRemote) ctx.lookup("ejb/CacheDao");
            Part computer = new Part();
            computer.setId(1);
            computer.setName("Computer");

            List<Part> parts = new ArrayList<Part>();

            Part cpu = new Part();
            cpu.setId(2);
            cpu.setName("CPU");

            Part monitor = new Part();
            monitor.setId(3);
            monitor.setName("Monitor");

            parts.add(cpu);
            parts.add(monitor);

            computer.setParts(parts);

            dao.addPart(computer);

            computer.setName("DellComputer");

            dao.updatePart(computer);

        } catch (NamingException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

    }

} 
```

**持久性.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence version="1.0"
    xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd">
    <persistence-unit name="CacheProjectUnit">
        <provider>org.hibernate.ejb.HibernatePersistence</provider>
        <!-- JNDI name of the database resource to use -->
        <jta-data-source>jdbc/H2Pool</jta-data-source>
        <properties>
            <!-- The database dialect to use -->
            <property name="hibernate.dialect" value="org.hibernate.dialect.H2Dialect" />
            <!-- drop and create tables at deployment -->
            <property name="hibernate.hbm2ddl.auto" value="create-drop" />
            <property name="hibernate.max_fetch_depth" value="3" />
            <property name="hibernate.cache.provider_class" value="org.hibernate.cache.EhCacheProvider" />
        </properties>
    </persistence-unit>
</persistence> 
```

**EhCache.xml**

```
<ehcache>
    <diskStore path="java.io.tmpdir"/>

    <defaultCache
            maxElementsInMemory="10000"
            eternal="false"
            timeToIdleSeconds="120"
            timeToLiveSeconds="120"
            overflowToDisk="true"
            diskPersistent="false"
            diskExpiryThreadIntervalSeconds="120"
            memoryStoreEvictionPolicy="LRU"
            />

    <cache name = "com.cache.dataobject.Part"
        maxElementsInMemory="100000"
        eternal="true"
        diskPersistent="false"
        timeToIdleSeconds="0"
        timeToLiveSeconds="0"
    />

    <cache name = "com.cache.dataobject.Part.parts"
        maxElementsInMemory="100000"
        eternal="true"
        diskPersistent="false"
        timeToIdleSeconds="0"
        timeToLiveSeconds="0"
    />

</ehcache> 
```

**输出日志：**

```
INFO: CALLED PERSIST
FINEST: Cache lookup: com.cache.dataobject.Part#1
FINE: key: com.cache.dataobject.Part#1
FINE: Element for com.cache.dataobject.Part#1 is null
FINEST: Cache miss: com.cache.dataobject.Part#1
FINEST: Cache lookup: com.cache.dataobject.Part#2
FINE: key: com.cache.dataobject.Part#2
FINE: Element for com.cache.dataobject.Part#2 is null
FINEST: Cache miss: com.cache.dataobject.Part#2
FINEST: Cache lookup: com.cache.dataobject.Part#3
FINE: key: com.cache.dataobject.Part#3
FINE: Element for com.cache.dataobject.Part#3 is null
FINEST: Cache miss: com.cache.dataobject.Part#3
FINEST: Invalidating: com.cache.dataobject.Part.parts#1
FINE: key: com.cache.dataobject.Part.parts#1
FINE: Element for com.cache.dataobject.Part.parts#1 is null
FINE: insert into Part (mainPart_id, PART_NAME, id) values (?, ?, ?)
FINE: insert into Part (mainPart_id, PART_NAME, id) values (?, ?, ?)
FINE: insert into Part (mainPart_id, PART_NAME, id) values (?, ?, ?)
FINE: update Part set mainPart_id=? where id=?
FINE: update Part set mainPart_id=? where id=?
FINEST: Inserting: com.cache.dataobject.Part#1
FINE: key: com.cache.dataobject.Part#1
FINE: Element for com.cache.dataobject.Part#1 is null
FINEST: Inserted: com.cache.dataobject.Part#1
FINEST: Inserting: com.cache.dataobject.Part#2
FINE: key: com.cache.dataobject.Part#2
FINE: Element for com.cache.dataobject.Part#2 is null
FINEST: Inserted: com.cache.dataobject.Part#2
FINEST: Inserting: com.cache.dataobject.Part#3
FINE: key: com.cache.dataobject.Part#3
FINE: Element for com.cache.dataobject.Part#3 is null
FINEST: Inserted: com.cache.dataobject.Part#3
FINEST: Releasing: com.cache.dataobject.Part.parts#1
FINE: key: com.cache.dataobject.Part.parts#1

INFO: CALLED MERGE
FINEST: Cache lookup: com.cache.dataobject.Part#1
FINE: key: com.cache.dataobject.Part#1
FINEST: Cache hit: com.cache.dataobject.Part#1
FINEST: Cache lookup: com.cache.dataobject.Part#1
FINE: key: com.cache.dataobject.Part#1
FINEST: Cache hit: com.cache.dataobject.Part#1
FINEST: Cache lookup: com.cache.dataobject.Part#2
FINE: key: com.cache.dataobject.Part#2
FINEST: Cache hit: com.cache.dataobject.Part#2
FINEST: Cache lookup: com.cache.dataobject.Part#2
FINE: key: com.cache.dataobject.Part#2
FINEST: Cache hit: com.cache.dataobject.Part#2
FINEST: Cache lookup: com.cache.dataobject.Part#3
FINE: key: com.cache.dataobject.Part#3
FINEST: Cache hit: com.cache.dataobject.Part#3
FINEST: Cache lookup: com.cache.dataobject.Part#3
FINE: key: com.cache.dataobject.Part#3
FINEST: Cache hit: com.cache.dataobject.Part#3
FINEST: Cache lookup: com.cache.dataobject.Part.parts#1
FINE: key: com.cache.dataobject.Part.parts#1
FINEST: Cached item was locked: com.cache.dataobject.Part.parts#1
FINE: select parts0_.mainPart_id as mainPart3_1_, parts0_.id as id1_, parts0_.id as id18_0_, parts0_.mainPart_id as mainPart3_18_0_, parts0_.PART_NAME as PART2_18_0_ from Part parts0_ where parts0_.mainPart_id=?
FINEST: Caching: com.cache.dataobject.Part.parts#1
FINE: key: com.cache.dataobject.Part.parts#1
FINEST: Cached: com.cache.dataobject.Part.parts#1
FINEST: Invalidating: com.cache.dataobject.Part.parts#2
FINE: key: com.cache.dataobject.Part.parts#2
FINE: Element for com.cache.dataobject.Part.parts#2 is null
FINEST: Invalidating: com.cache.dataobject.Part.parts#3
FINE: key: com.cache.dataobject.Part.parts#3
FINE: Element for com.cache.dataobject.Part.parts#3 is null
FINEST: Invalidating: com.cache.dataobject.Part.parts#1
FINE: key: com.cache.dataobject.Part.parts#1
FINEST: Invalidating: com.cache.dataobject.Part#1
FINE: key: com.cache.dataobject.Part#1
FINE: update Part set mainPart_id=?, PART_NAME=? where id=?
FINE: update Part set mainPart_id=null where mainPart_id=?
FINE: update Part set mainPart_id=null where mainPart_id=?
FINEST: Updating: com.cache.dataobject.Part#1
FINE: key: com.cache.dataobject.Part#1
FINEST: Updated: com.cache.dataobject.Part#1
FINEST: Releasing: com.cache.dataobject.Part.parts#2
FINE: key: com.cache.dataobject.Part.parts#2
FINEST: Releasing: com.cache.dataobject.Part.parts#3
FINE: key: com.cache.dataobject.Part.parts#3
FINEST: Releasing: com.cache.dataobject.Part.parts#1
FINE: key: com.cache.dataobject.Part.parts#1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-18T12:25:44.423

您可能已经看到了这一点，但是有一个开放的 Hibernate 错误似乎与您的问题有关 - [“二级缓存集合被锁定导致缓存未命中”。](http://opensource.atlassian.com/projects/hibernate/browse/HHH-1813).

从那个错误中，修复可能是为您的添加/更新调用使用新会话。您可以获得 EntityManagerFactory 而不是 EntityManager 并为每次调用请求一个新的 Entity Manager。显然，这取决于代码的更广泛上下文是否合适。

# jquery - 隐藏（）单选按钮*和*它在jquery中的文本标签

> ID：643704
> 
> 赞同：11
> 
> 时间：2009-03-13T17:09:11.737
> 
> 标签：jquery, radio-button

我要回顾最近的一个项目，整理可访问性问题，并确保所有表单元素都有标签。将标签文本放入标签会导致我之前编写的一些笨拙的代码出现问题。

基本上，如果您有一个单选按钮及其标签：

```
<label for="zone_r1"><input type="radio" name="zone" id="zone_r1" value="NY" />New York</label> 
```

你使用 jquery 来隐藏它，如下所示：

```
$('#zone_r1').hide(); 
```

实际按钮是隐藏的，但不是标签文本。最初我为标签文本做了一个跨度并像这样隐藏它：

```
<input id="NY" type="radio" name="zone" value="NY" /><span id="nyTXT">New York</span> 
```

和

```
$('#NY').hide();
$('#nyTXT').hide(); 
```

有任何想法吗？我不喜欢使用 kludge，它可能无法通过标签中的跨度验证，但也许我过于热心了。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-13T17:38:26.673

我认为这应该对你有用

```
$("label[for=zone_r1],#zone_r1").hide(); 
```

这将选择带有“for”属性的标签，该标签设置为您要查找的单选按钮，以及单选按钮本身，并将它们都隐藏起来

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-13T17:12:26.830

```
$('#zone_r1').parent().hide(); 
```

为我工作

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-13T17:13:08.437

关于什么`$('label:has(#zone_r1)').hide();`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-13T17:13:37.840

对于第一个单选按钮，您可以隐藏实际按钮，然后隐藏[其父](http://docs.jquery.com/Traversing/parent)按钮：

```
$('#zone_r1').hide().parent().hide(); 
```

对于第二种情况，您可以隐藏按钮和“[下一个](http://docs.jquery.com/Traversing/next)”兄弟：

```
$('#NY').hide().next().hide(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-21T16:14:30.790

你可以这样做：

1.) 定义没有周围标签的单选按钮输入。

2.) 将“选项文本”（单选按钮右侧的文本）包裹在`<span>`.

3.) 使用这个 jQuery 语句：`$("input:radio:not(:checked), input:radio:not(:checked) + span").hide();`

这将选择单选按钮和单选按钮右侧的文本并将其隐藏。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-24T13:25:05.353

只需将“标签”选择器放在父级中：

```
$(':radio[id=zone_r1]').parent('label').hide(); 
```

请参阅[我的 jsFiddle 示例](http://jsfiddle.net/A8upf/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-11-15T10:41:13.117

根据值隐藏单选按钮容器或 TD

jQuery("input[type=radio][value='EU2']").parent().hide();

# c - 可执行文件（用 C 编写）是否有某种内存限制才能正常运行？

> ID：643710
> 
> 赞同：1
> 
> 时间：2009-03-13T17:09:35.450
> 
> 标签：c, memory, crash, codeblocks

我正在使用 C 做一个项目，而 CodeBlocks 是我的 IDE。Windows Vista 是操作系统。我在已经工作的代码中添加了一些新东西，现在可执行文件每次都崩溃。我编译后没有错误。计算机和编程不是我的领域，但我怀疑它可能与某种内存限制有关（如果存在并且甚至有意义的话）。我这样说是因为我正在使用三个不同的 3D 矩阵/维度数组：

*   1500x5x2
*   1500x5x12
*   1500x5x200

然后我有另外两个维度为 1500 的一维数组。这一切都很好。

当我添加另外三个维度为 1500x5 的二​​维矩阵/数组时，它开始崩溃。如果我评论一些现有的矩阵，新的矩阵可以正常工作，但一次只有一个。

（顺便说一句，上面提到的所有矩阵都是 INT 类型，并且是用指针和 callocs 定义的）

有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-13T17:14:32.770

平台等存在限制，但您的 3 个 3D 矩阵仅使用几 MB 的 RAM（刚刚超过 6 个），所以我怀疑您是否达到了这些限制。

如果在您添加其他矩阵时它刚刚开始崩溃，我会更加怀疑您在定义您添加的新矩阵代码的指针上存在内存分配/访问错误。

你如何定义你的矩阵？

- - 编辑 - -

您应该尝试[在 CodeBlocks 中进行调试](http://wiki.codeblocks.org/index.php?title=Debugging_with_Code::Blocks)。这应该可以准确地告诉您崩溃发生的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T17:25:21.057

我不知道数组可能有负维度。

事实上，我相当肯定他们不能，因为数组维度是您计划放入其中的项目数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T17:23:36.630

我建议您学习如何使用 IDE 的调试器。我们真的没有任何事情要做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T18:13:34.577

**可执行文件（用 C 编写）是否有某种内存限制才能正常运行？**

在 32 位操作系统上，您的程序被限制为 4GB 内存（实际上更少，但这是硬上限），因为您的指针大小是 32 位，并且您只能使用 32 位指针引用 4GB。

不过，这不应该是问题，因为您最大的数组只消耗不到 6MB - 即使您实例化了数百个这样的数组，您也可以。

您几乎遵循[在 C 中创建动态多维数组的标准方法](http://c-faq.com/aryptr/dynmuldimary.html)：

```
int *** layer=calloc(lines, sizeof(int **));
for(i=0;i<lines;i++)
{ 
   layer[i]=calloc(columns, sizeof(int*));
   for(j=0;j<columns;j++) 
   { 
     layer[i][j]=calloc(hight, sizeof(int));
   }
} 
```

所以我会在你的代码中寻找其他地方。使用调试器。确保您的数组访问不会超出范围，或者在没有超出范围时将数组元素视为指针。

-亚当

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-26T16:27:00.750

你能指定什么样的崩溃？

你收到什么信息？

我在上面引用一个答案：

“我建议你学习如何使用 IDE 的调试器。我们真的没有任何事情要做。”

不要猜测可能的原因，而是使用可用的工具将问题缩小到特定的代码行。

我现在在您的评论中看到您已经解决了您的问题，但通常正确调试是编程的唯一方法，并且在发布问题时提供尽可能多的代码和细节！

# c# - C# 和 .NET 3.5 - 如何使用不同的凭据、隐藏窗口以及能够捕获标准输出和退出代码来启动进程？

> ID：643723
> 
> 赞同：3
> 
> 时间：2009-03-13T17:15:43.373
> 
> 标签：c#, .net, .net-3.5, process, credentials

我有一个用 C# 和 .NET 3.5 开发的 Windows 服务，用于在我们的 3 个域中执行各种管理任务。我在每个域中都有一个管理员帐户，该帐户具有此服务正在执行的必要权限/权限。

对于所有 AD 交互，我可以使用域的正确用户名/密码绑定到 AD，一切都很好。但是，我现在需要启动一个外部进程（robocopy）来执行一些工作，我在 .NET 3.5 中找不到任何代码示例来执行此操作。

我需要做的是在隐藏窗口中使用备用凭据启动 robocopy，捕获标准输出以便我记录实际完成的操作，并捕获退出代码以便判断它是否成功。

[我从K. Scott Allen 的博客](http://odetocode.com/Blogs/scott/archive/2004/10/28/602.aspx)中找到了一些旧的 .NET 1.1 代码（请参阅最后几条评论以获得良好的代码清单），它扩展了 System.Diagnostics.Process 对象并调用 Win32 API 函数 CreateProcessAsUserW。但是，由于 .NET 2.0 中的一些 API 更改，该代码不起作用。使用引用博客上最后一条评论中的代码片段，它使用反射调用 Process 对象的私有 SetProcessHandle 函数，当我尝试与进程交互（杀死它或获取退出代码）时，会导致访问被拒绝错误。

有没有人有一个很好的例子来说明如何做到这一点？

编辑：内置的 .NET Process 和 ProcessStartInfo API 确实允许您指定备用凭据，但是当您这样做时，它希望创建一个可见窗口（即使您指定 CreateNoWindow 或 WindowStyle Hidden），该窗口在作为 Windows 服务运行时会失败。因此，这些不是此应用程序的选项。模拟也不起作用，因为在启动外部进程时，它使用父进程的凭据，而不是模拟的凭据。

解决方案：正如 Reed 在下面指出的，使用 Win32 API 函数之一的 P/Invoke 应该允许您实现这一点。我最终使用了一个[名为 RunProcess 的旧的免费软件 NT4 实用程序](http://ss64.net/westlake/nt/)，它允许您在命令行上指定用户名/密码，从而采用了稍微不同的路线。它在 Vista 和 2k3 上工作，并且在由作为本地系统运行的 Windows 服务启动时也能正常工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T17:20:26.890

我想你想看看：

[ProcessStartInfo](http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.aspx)

这提供了一种 .NET 唯一的方法来在具有不同凭据的不同用户下启动进程。不再需要 Win32 API。

- - 编辑 - -

其他替代方法可能是使用[此处](http://www.dotnet247.com/247reference/msgs/32/160308.aspx)指定的 P/Invoke （首先查看底部的注释）或更可能的是，将 P/Invoke 与[CreateProcessWithLogonW](http://groups.google.com/group/microsoft.public.dotnet.languages.csharp/msg/3e2a3345bdd184d6?pli=1)一起使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T17:57:18.657

只是一个未经验证的想法，但在 .net 2+ 中使用动态模拟对整个代码块是否有效？因此，模拟所需的用户，然后在模拟的上下文/范围内执行您需要的任何操作，例如以正常方式启动流程？认为我们做了类似的事情来集成 mstsc.exe 使用已经提供的凭据启动。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T17:23:25.320

这应该与`Process`类和`ProcessStartInfo`.

不同的凭据：

*   [ProcessStartInfo.UserName 属性](http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.username.aspx)
*   [ProcessStartInfo.Password 属性](http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.password.aspx)

重定向标准输出：

*   [ProcessStartInfo.RedirectStandardOutput 属性](http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.redirectstandardoutput.aspx)
*   [Process.StandardOutput 属性](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.standardoutput.aspx)

退出代码：

*   [Process.ExitCode 属性](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.exitcode.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T17:44:15.740

StartInfo 有一个名为 CreateNoWindow 的属性，它可以使 Reed 的建议对您有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-03-18T16:51:41.547

如果您想查看实际使用的退出代码，请查看 www.robocopyplus.com。它就像 robocopy 的包装器，为电子邮件通知和报告过滤添加开关。这可能已经做了一些你想要实现的东西。

# version-control - 让 Emacs 忽略 *.orig 文件

> ID：643727
> 
> 赞同：6
> 
> 时间：2009-03-13T17:18:20.950
> 
> 标签：version-control, emacs, ignore

我最终得到一堆 *.orig 文件，来自 hg reverts。当我发现自己错误地编辑 foo.c.orig 而不是 foo.c 时，这很烦人。（我使用 ido 模式，第一场比赛并不总是最短的。）

有没有办法告诉 Emacs 忽略 *.orig 文件，就好像它们是 *~ 文件一样？我对谷歌的运气并不好——我发现有一百万页告诉我如何更改它保存自己的备份文件的位置，而不是如何忽略其他文件。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-13T17:38:24.333

`(add-to-list 'completion-ignored-extensions ".orig")`

# c# - 可以在实体框架的 CreateOrUpdate 方法中依赖 try-catch 吗？

> ID：643731
> 
> 赞同：2
> 
> 时间：2009-03-13T17:20:18.480
> 
> 标签：c#, entity-framework, exception, exception-handling, try-catch

这样做可以接受吗？首先尝试添加实体。如果添加失败，没关系，因为这意味着实体已经存在？

还是有更优雅/更简单的解决方案？

```
EntityFrameworkEntities dal = EntityDataModelHelper.GetEntityDataModel();

try
{
    dal.AddToXXXXXX(xxxxxxx);
}
catch
{

}

try
{
    dal.SaveChanges();
    return true;
}
catch
{
    return false;
} 
```

好的，我将其缩短为...

```
EntityFrameworkEntities dal = EntityDataModelHelper.GetEntityDataModel();

if(xxxxxxx.ID == 0)
{
    dal.AddToXXXXXX(xxxxxxx);
}

try
{
    dal.SaveChanges();
    return true;
}
catch
{
    return false;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-13T17:22:23.047

这样做肯定**不行**。C# 中没有类型的 catch 语句意味着“捕获任何标准或非标准异常”。但是您的目的是防止重复添加。添加可能由于各种原因而失败，这些原因并不表示现有条目。例如，该方法可能会抛出一个空引用，并且您会假设它已被添加。

如果要检查重复添加，则**必须**仅捕获为重复添加引发的异常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T17:27:00.447

您可能希望从 IfExists 样式方法开始，然后跳过保存更改，除非您确实有更改。

正如 Lucas 所指出的，如果您落入 catch 块中，try-catch 块会产生很大的开销，因此通常您不想依赖它，除非无法确定该项目是否已经存在。

不要使用 try-catch 来完成 If 语句的工作。Try-catch 用于不寻常的意外事件。

**编辑** 在您更新的代码中，您未能捕获“AddToXXXXXX”方法引发的异常。

你应该做

```
If(!XXXXXX.Contains(newItemValue))
{
   try
   {
      add...
      savechanges...
   }
   catch
   {

   }
} 
```

或者，您可以将 Add 和 Savechanges 分离到不同的 try-catch 块中，但这只有在即使 Add 失败时也执行 SaveChanges 时才需要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T17:23:23.013

您可以将第一个 Try-Catch 替换为 If 语句，但我认为您仍然需要第二个。

**编辑：**也不建议只在一个块中捕获所有异常而不考虑它们是什么。

PS Try Catch 块使用比 If 语句更多的处理能力（时间）。

# iis-6 - IIS 挂起故障排除

> ID：643734
> 
> 赞同：1
> 
> 时间：2009-03-13T17:21:10.787
> 
> 标签：iis-6, .net-2.0, windows-server-2003, freeze

我在偶尔挂起的 IIS 6 (Windows Server 2003) 上运行一个网站。

> 时间线：
> 
> 发布到野外，网站运行了 3 天。
> 
> 网站挂起每个请求，直到网站停止和启动。
> 
> 网站运行 2 周没有问题。
> 
> 网站在每次请求时都会挂起，直到网站重新启动。

在挂起开始之前，我们看到了一些应用程序日志条目：Faulting application w3wp.exe, faulting module unknown, version 0.0.0.0 fault address --------。

安装在网站上的应用程序是用 .Net 2.0 编写的。

谁能指导我解决这个问题？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T17:35:46.913

您最好的选择可能是使用 adplus 捕获挂起的 w3wp 进程的内存转储，然后使用 windbg + sos 扩展来尝试确定挂起的原因。

您可以在这里获得 adplus 和 Windbg：http: [//www.microsoft.com/whdc/devtools/debugging/default.mspx](http://www.microsoft.com/whdc/devtools/debugging/default.mspx)

此外，Tess Ferrandez 的博客绝对是有关学习如何使用 Windbg 分析内存转储的信息的金矿。她甚至有一组实验室，您可以针对特定场景进行实验。

[https://docs.microsoft.com/en-us/archive/blogs/tess/](https://docs.microsoft.com/en-us/archive/blogs/tess/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T18:07:20.847

发生这种情况的原因有很多。几年前，我在生产中的 web 项目中发生了这种情况，并打电话给微软来修复它。我希望我能给你具体的细节，但这是我记得的。

.NET 将文件夹缓存在您的 Web 应用程序中。服务器上有一个注册表项（不记得在哪里）设置了文件夹限制（信不信由你）。默认情况下，限制设置为 150 个文件夹。如果您的 Web 应用程序中有多个文件夹，并且您尝试访问第 151 个文件夹，则会导致 IIS 崩溃。

是的，这听起来很疯狂，但相信我，我在微软工作了数周，直到我们找到了崩溃的原因。当时的答案是提高注册表的限制并重新启动服务器。这是几年前的事了，我希望在以后的更新中可以解决这个问题，但我提供给你是为了以防你使用的是旧版本的 Server 2003。

很抱歉，我无法提供更具体的细节，但我只想让你知道我的经历，以防这听起来像你的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-18T16:44:01.993

make sure IIS is set to be able to recycle its process automaticly, might help to fix the issue if it is a memory leak. (well ok cope with the problem not fix)

My advice is to give you app its own application pool, so you are 100% sure that its the appication you think pulling the server down, what dose the application log say when this happens?

From the information you have given it sounds like its a memory leak or open db connection / thread issue.

P.s If you are using N2 there was a known issue that when IIS recycled it wouldnt come back up.

# php - Zend Form：在文本字段右侧添加链接

> ID：643736
> 
> 赞同：5
> 
> 时间：2009-03-13T17:21:16.620
> 
> 标签：php, zend-framework, zend-form

我意识到我*应该*能够做到这一点，但我能说什么，我不*明白*。我什至 rtfm'ed 直到我的眼睛被炸了。我通过例子学得最好，而不是 Zend 的文档给出的深入解释，或者这类问题通常产生的典型“使用装饰器”响应。我需要的是这样的标记：

> ```
> <dt>
>     <label for="name">Name</label>
> </dt>
> <dd>
>     <input type="text" name="name" id="name" value="">
>     <a href="#">My Link</a>
> </dd> 
> ```

它都是香草，除了输入后的额外链接。是的，它在 dd 内，就在链接旁边，这就是我无法做到的。

这是我用来创建上述 HTML 的（稍作修改的）代码

> ```
> $name = new Zend_Form_Element_Text( 'name' );
> $name->setLabel( 'Name' );        
> $this->addElements( $name );
> $this->addDisplayGroup( array( 'name' ), 'people'); 
> ```

任何示例代码或更好的解释都会让这个菜鸟非常非常高兴。

干杯!

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-14T13:05:55.160

请参阅我在邮件列表中[对此主题](http://www.nabble.com/Zend_Form_Element_Button-question-and-a-general-Zend_Form-question-tt22319567.html#a22319567)的回复以及我的[博客文章](http://monzee.wordpress.com/2009/02/23/decorators-are-hard-lets-go-shopping/)。这与 Aaron 描述的过程基本相同。

您也可以采用装饰器方式，使用 description 属性来保存链接（未测试）：

```
<?php
$foo = new Zend_Form_Element_Text('name');
$foo->setLabel('Name')
    ->setDescription('<a href="#">Link</a>')
    ->setDecorators(array(
        'ViewHelper',
        array('Description', array('escape' => false, 'tag' => false)),
        array('HtmlTag', array('tag' => 'dd')),
        array('Label', array('tag' => 'dt')),
        'Errors',
      ));
$form->addElement($foo); 
```

我不确定装饰器`'tag'=>false`中的`Description`是否可以工作，但值得一试。抱歉，我现在无法测试，我的开发盒现在坏了。如果失败，请尝试这两个链接中描述的手动装饰器渲染方法。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-13T22:51:14.863

我认为您正在寻找通过视图脚本对装饰器的完全控制：

[Zend 框架手册](http:///framework.zend.com/manual/en/zend.form.standardDecorators.html#zend.form.standardDecorators.viewScript)

基本上，您希望将元素的 viewScript 属性设置为脚本的路径，然后传递您想要发送的任何其他信息，可能是您正在构建的链接的链接Href 或标题。

```
$name = new Zend_Form_Element_Text( 'name' );
$name->setLabel( 'Name' );   
$name->viewScript = 'path/to/viewScript.phtml';
$name->decorators = array('ViewScript', array('linkHref' => '#',
                                              'linkTitle' => 'My Link');
$this->addElements( $name );
$this->addDisplayGroup( array( 'name' ), 'people'); 
```

然后你的 viewScript 看起来像这样，我不确定所有 Helpers 是如何在 Zend_Form_Element 的实例中的，但它有点像这样：

```
<dt><?= $this->formLabel($this->element->getName(),
                     $this->element->getLabel()) ?></dt>
<dd><?= $this->{$this->element->helper}(
                     $this->element->getName(),
                     $this->element->getValue(),
                     $this->element->getAttribs()
                ) ?>
<a href="<?= $this->linkHref; ?>"><?= $this->linkTitle; ?></a>
<?= $this->formErrors($this->element->getMessages()) ?>

</dd> 
```

有时，在 viewScript 中这样做会更好，因为它可以让您 100% 控制元素，同时仍然非常干燥。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-01-15T14:58:11.127

只是为了给 Aaron 的帖子添加一些支持，经过几个小时的头疼做一些非常简单的事情（这似乎否定了拥有一个框架的意义），如果你发现这在你的复选框上不起作用，那是因为你必须在您的 .phtml 中使用它（基于 Aaron 的示例）：

```
<dt><?= $this->formLabel($this->element->getName(),
                     $this->element->getLabel()) ?></dt>
<dd><?= $this->{$this->element->helper}(
                     $this->element->getName(),
                     $this->element->getValue(),
                     $this->element->getAttribs(),
                     $this->element->options
                ) ?>
<a href="<?= $this->linkHref; ?>"><?= $this->linkTitle; ?></a>
<?= $this->formErrors($this->element->getMessages()) ?>

</dd> 
```

选项！选项！选项！当我需要找到你的时候，你在哪里？！因此，如果您使用复选框，请不要忘记将以下内容添加到您的助手中：

```
$this->element->options 
```

这适用于使用**Zend_Form_Element_Checkbox添加****条款和条件**复选框（用于 SEO）

 **# c++ - `vcall'{0,{flat}}' 在下面的例子中是什么意思？

> ID：643738
> 
> 赞同：0
> 
> 时间：2009-03-13T17:22:15.340
> 
> 标签：c++, visual-c++

我不确定这个问题是否已经解决。我正在检查堆栈溢出功能之一并产生了这个疑问。

让我们先检查代码：

```
#include <string>
#include <map>
#include <iostream.h>

class MyClass
{
public:

    virtual  int Func()
    {
        return 0;
    }

    int Func2()
    {
        return 0;
    }

};

class MyClass2 :  public MyClass
{
public:

    int Func( )
    {
        return 1;
    }

    int Func2()
    {
        return 1;
    }

};

class Processor
{
 private:
      typedef int (MyClass::*MemFuncGetter)();
      static std::map<std::string, MemFuncGetter> descrToFuncMap;

 public:
        static void Initialize();
        void Process(MyClass* m, const std::string&);

};

std::map<std::string, Processor::MemFuncGetter> Processor::descrToFuncMap;
void Processor::Initialize()
{

     descrToFuncMap["Func"]=&MyClass::Func;
     descrToFuncMap["Func2"]=&MyClass::Func2;
};

void Processor::Process(MyClass* ms, const std::string& key)
{
    std::map<std::string, MemFuncGetter>::iterator found = descrToFuncMap.find(key);
     if(found != descrToFuncMap.end())
     {
        MemFuncGetter memFunc = found->second;
        int dResult = (ms->*memFunc)();
        cout << "Result is : "<< dResult <<endl;
      }
 }

int main(int argc, char* argv[])
{
    Processor::Initialize();
    Processor p;

    MyClass *pMC2 = new MyClass2;
    p.Process(pMC2, "Func");
    p.Process(pMC2, "Func2");

    delete pMC2;
    pMC2 = NULL;

    return 0;
} 
```

在此示例中，结果与预期一致：

```
Result is : 1
Result is : 0 
```

但是，当我使用 VC 6 调试器进行调试并观察Processor::Process中**memFunc的值时，发现以下值：**

在 p.Process(pMC2, "Func"); 称呼

```
memFunc 0x004011bd [thunk]:`vcall'{0,{flat}}' 
```

在 p.Process(pMC2, "Func2"); 称呼

```
memFunc 0x0040118b MyClass::Func2(void) 
```

我不明白"[thunk]:`vcall'{0,{flat}}" 中的**thunk**和**flat吗？**谁能帮我理解这里的内部结构？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T17:30:21.670

维基百科上对 thunk 的含义有一个非常彻底的解释

[http://en.wikipedia.org/wiki/Thunk](http://en.wikipedia.org/wiki/Thunk)

thunk 的要点是在运行时访问 C++ 虚拟表的机制。它被设置为针对对象的运行时类型调用适当的虚函数。

至于 vcall{0,{flat}} 的含义，我不是 100% 确定的。我的**猜测**是它报告了 thunk 访问该方法的值。

*   0：vtable 中的偏移量
*   {flat}：继承层次是扁平的而不是多重的

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T22:05:05.333

不同的符号是因为成员函数指针需要能够处理各种虚拟和非虚拟成员函数（尽管不是静态成员函数），并且它需要能够通过各种形式的继承处理属于类的成员函数（公共、私人和/或虚拟）。

我遇到的解释成员函数指针如何工作的最佳文章是 Doug Clugston在 The Code Project 上的[“成员函数指针和最快的 C++ 委托” 。](http://www.codeproject.com/KB/cpp/FastDelegate.aspx)

> 您可能会猜到“成员函数指针”，就像一个普通的函数指针一样，只是保存一个代码指针。你会错的。在几乎所有编译器上，成员函数指针都比函数指针大。最奇怪的是，在 Visual C++ 中，成员函数指针的长度可能是 4、8、12 或 16 个字节，具体取决于与其关联的类的性质，以及使用的编译器设置！成员函数指针比你想象的要复杂。

这并不容易阅读，但值得一读——这些信息在其他任何地方都很难找到。好好阅读那篇文章可能会让您深入了解调试器在向您显示诸如以下内容时真正在说什么

```
[thunk]:`vcall'{0,{flat}}' 
```

[JaredPar 的回答](https://stackoverflow.com/questions/643738/what-does-vcall0-flat-signify-in-below-example/643779#643779)可能非常符合要求 - Clugstons 的文章将为您提供故事的其余部分。

# sql - 在同一张表中扩展问题多对多关系

> ID：643740
> 
> 赞同：1
> 
> 时间：2009-03-13T17:22:49.240
> 
> 标签：sql, mysql

我有一个表，它包含 4 个字段

```
身份证|医院| 医生|病人

1 A D1 P11

2 B D6 P61

3 A D2 P21

4 A D1 P12

5 B D7 P71

6 B D6 P62

7 B D6 P63
```

医生是医院独有的。他们不在其他医院工作。患者对于他们不拜访任何其他医生的医生来说是独一无二的。每家医院都有多名医生。

如果您观察到每个医生有多个患者。

现在的问题是：我怎样才能得到与每个医生相关的“只有一个病人”。它可以是记录中的任何患者。

我期待看到这样的事情

```
医院医生病人
  A D1 P11

  A D2 P21

  B D6 P61

  B D7 P71
```

我从表 GROUP BY Hospital,Doctor ORDER BY Hospital,Doctor 中得到了 select Hospital,doctor, max(patient) 之类的答案；

如何获取上表中唯一的 id，例如。

```
id 医院 医生 病人
 1 A D1 P11

 3 A D2 P21

 2 B D6 P61

 5 B D7 P71
```

我很抱歉重新发布这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T17:36:58.067

尝试类似：

```
select Id,Hospital,Doctor,Patient
  from table
  where Id in (select max(t.Id) from table t group by t.Hospital,t.Doctor)
  order by Hospital,Doctor; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T17:48:54.887

```
SELECT  m.*
FROM    (
        SELECT  (
                SELECT  id
                FROM    mytable mi
                WHERE   mi.hospital = md.hospital
                        AND mi.doctor = md.doctor
                LIMIT 1
                ) AS first_patient
        FROM    (
                SELECT  DISTINCT hospital, doctor
                FROM    mytable
                ) md
        ) mo, mytable m
WHERE   m.id = mo.first_patient 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T18:01:59.457

您可能会考虑将事物分解为三个表：Hospitals（带有主键 id 和 Hospital 字段）、Doctors（带有其他 PK、医院的外键和 Doctor 字段）和 Patients（带有其他 PK、外键医生和患者领域）。那么您的陈述将类似于：

```
SELECT H.Id, H.Hospital, D.Doctor, Max(P.Patient)
FROM Hospitals H
INNER JOIN Doctors D ON H.Hospital = D.Hospital
INNER JOIN Patients P ON D.Doctor = P.Doctor
ORDER BY Hospital, Doctor 
```

# svn - SVN存储库的本地副本，同步到远程副本？

> ID：643748
> 
> 赞同：2
> 
> 时间：2009-03-13T17:24:01.887
> 
> 标签：svn, tortoisesvn

有什么方法可以签入/签出本地存储库，并使这些更改在后台与远程存储库同步？

我们所在的互联网连接很弱，存储库很大。当我想用 TortoiseSVN 的 Repo Browser 浏览存储库时，我可以等待 30 分钟来加载存储库信息。

理想情况下，我将与本地服务器通信，该服务器将在后台/定期与远程服务器同步。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T17:54:05.560

虽然我从未使用过它，但我听说[git-svn](http://git-scm.com/docs/git-svn)正是您想要的。您拉 SVN 一次，在 git 中完成所有本地工作（在 svn checkout 之上），并在您的连接更好时提交回 SVN。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-13T17:32:46.220

您可以使用[SVK](http://svk.bestpractical.com/view/HomePage)创建 SVN 存储库的本地镜像。您可以将更改提交到本地 SVN 存储库（使用 SVN）并使用 SVK 将更改推送到“真实”存储库。

我相信这个策略在[Using SVK as a repository mirroring system中有描述](http://svk.bestpractical.com/view/UsingSVKAsARepositoryMirroringSystem)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T17:28:56.807

Subversion 支持复制到只读从属服务器。请参阅 SVN Book 中的[相关章节](http://svnbook.red-bean.com/en/1.5/svn.reposadmin.maint.html#svn.reposadmin.maint.replication)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-13T17:57:54.210

另一种方法是在您的远程站点使用 git 而不是 subversion。Git 能够以您想要的方式与颠覆同步。然后，您将在本地签入并从 git 刷新，并定期将您的 git 存储库提交回远程 subversion。

缺点是您必须在远程站点学习新的版本控制系统。但是，像 git、mercurial 和 bzr 这样的分布式版本控制系统比 subversion 更适合您的环境类型。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-13T18:28:25.913

我今天刚刚发现[这篇文章](http://devlicio.us/blogs/christopher_bennage/archive/2009/03/11/mirroring-subversion-from-windows.aspx)讨论了使用一个名为[svnsync](http://svn.collab.net/repos/svn/trunk/notes/svnsync.txt)的工具来镜像 Subversion 存储库。希望这可以帮助！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-09-16T13:08:15.127

您可以使用 VisualSVN Server 的多[站点存储库复制](http://www.visualsvn.com/server/features/multisite-replication/)功能设置（多个）可写从存储库：

1.  在主要办公地点设置一个主存储库，
2.  在远程位置设置从存储库，
3.  在另一个远程位置设置另一个从站，
4.  等等

总部的用户访问主存储库，位于远程站点的用户访问可写的从存储库。主服务器和它的从服务器之间的双向复制是透明且自动完成的，您甚至可以忘记您已经实施了多站点解决方案。对于您的用户，master 和 slave 就像任何其他 Subversion 存储库一样可用。

有关其他信息，请参阅[“开始使用多站点存储库复制”](http://www.visualsvn.com/support/topic/00068/)。

# python - python的pip是否支持http认证？

> ID：643756
> 
> 赞同：6
> 
> 时间：2009-03-13T17:25:56.970
> 
> 标签：python, easy-install, pip

正如标题所说，pip 是否支持 http 身份验证，就像 easy_install 一样？

如果没有，是否有任何（更好的）替代方法来运行私有包存储库？我看到 pip 可以访问源存储库（git、svn 等），但是可以使用版本要求吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-02-26T04:42:16.427

对于仍在寻找答案的人，您可以使用以下语法：

```
pip install -r https://user:pass@domain.com/path/requirements.txt 
```

如果您还需要验证他们的证书使用情况：

```
pip install --cert host.pem -r https://user:pass@domain.com/path/requirements.txt 
```

这正在处理：

```
$ pip --version
pip 1.5.4 from /usr/local/lib/python2.7/dist-packages (python 2.7) 
```

要升级您的 pip，请执行以下操作：

```
pip install --upgrade pip 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-01T12:42:13.607

pip[使用](http://oss.openplans.org/pip/browser/pip/trunk/pip.py)urllib2.urlopen() 来获取文件。urllib2.urlopen() 支持 HTTP 身份验证，但 pip 在构建其打开器时似乎没有安装 HTTPBasicAuthHandler。添加这样的支持将是微不足道的；您可以解析 user:password 的 URL，也可以接受与命令行参数相同的信息。[feedparser通过](http://feedparser.org/docs/http-authentication.html)[继承](http://code.google.com/p/feedparser/source/browse/trunk/feedparser/feedparser.py)urllib2.HTTPDigestAuthHandler来支持这两种方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-08-09T06:00:47.290

目前只是 pip 不支持身份验证。

但是[pip 的主要作者认为该功能是可取的](http://groups.google.com/group/python-virtualenv/msg/7aff34d86c595f84)，因此它可能会在中期出现。[PIP 跟踪](http://projects.openplans.org/pip/ticket/30)中还有一个项目，其中包含一个启用 http auth 的补丁。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-11-22T14:09:24.773

仅供参考，它目前正在[`http_auth_index`](http://github.com/brosner/pip/tree/http_auth_index "http_auth_index")分支中进行，这将允许将基本身份验证用于自定义索引。

# silverlight - 迭代 Silverlight DataGrid

> ID：643759
> 
> 赞同：1
> 
> 时间：2009-03-13T17:26:29.743
> 
> 标签：silverlight, silverlight-2.0

在 ASP.NET 中，人们发现自己经常编写如下代码：

```
foreach(DataListItem item in theDataList.Items){
    MyUserControl foo = item.FindControl("myUserControl") as MyUserControl;
    foo.DoSomethingNice();
} 
```

在 Silverlight 中，如何遍历 DataGrid（或其他集合绑定控件）的组成控件？我想将每个的不透明度设置为 0.5，然后在处理它们时将不透明度更新为 1。

使用 ItemSource 属性可以获得对绑定的基础 IEnumerable 的引用，但我想要实际的控件引用。

为了更具体，假设您有一个这样的用户控件：

```
<UserControl x:Class="GridTest.TestControl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    Width="Auto" Height="25">
    <StackPanel Orientation="Horizontal">
        <TextBox Width="150" Text="{Binding FirstName}" />
        <TextBox Width="150" Text="{Binding LastName}" />
    </StackPanel>
</UserControl> 
```

您的 DataGrid 模板如下所示：

```
<data:DataGrid x:Name="theDataGrid">
            <data:DataGrid.Columns>
                <data:DataGridTemplateColumn Header="People" Width="Auto">
                    <data:DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <this:TestControl />
                        </DataTemplate>
                    </data:DataGridTemplateColumn.CellTemplate>
                </data:DataGridTemplateColumn>
            </data:DataGrid.Columns>
        </data:DataGrid> 
```

你是这样绑定的：

```
theDataGrid.AutoGenerateColumns = false;
people = new List<Person>( 
    new Person[]{
                new Person { FirstName = "John", LastName = "Carmack" },
                new Person { FirstName = "Linus", LastName = "Torvalds" }
    }
);
theDataGrid.ItemsSource = people; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T23:49:03.680

我会通过在 opacity 属性上使用转换器来解决您的问题。让我解释。

Silverlight 数据绑定方法的优点在于从模型到 UI 的通信。这是通过使用 ObservableCollection 而不是 List 来绑定更改 UI 的列表，或为具有更改 UI 的属性的对象实现 INotifyPropertyChanged 来实现的。

这使您可以避免分析和修改 UI 问题的代码。

基本上，您可以对更改不透明度所需的任何数据进行数据绑定，并依靠转换器根据数据绑定值返回不透明度值。甜的！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-05T01:54:32.313

也许你可以为你的UserControl添加一个'Loaded'事件，然后你可以通过这种方式获取控件引用：'TestControl testCtl = sender as TestControl;'

# silverlight-2.0 - 如何创建一个 Silverlight 面板来排列子项以防止重叠？

> ID：643762
> 
> 赞同：0
> 
> 时间：2009-03-13T17:27:12.410
> 
> 标签：silverlight-2.0

我正在尝试创建一个使用绝对定位但会重新排列项目的自定义面板，以便没有孩子重叠。此面板将用于 ItemsControl 的 ItemsPanel。ItemsControl 绑定到在地图上显示为各个城市的插图的数据，因此目标是使插图尽可能靠近他们的城市，而不会与任何其他插图重叠。我有一个重新排列项目的算法（虽然它很慢而且我有兴趣找到一个更好的，所以如果有人有建议，请告诉我）但我一直在为自定义面板苦苦挣扎。

可以在下面找到最新的代码减去算法以使其更短。我还附上了重叠面板下视觉树的图像。

问题：

1.) 我遇到的第一个问题是，尽管 MSDN 说如果 MeasureOverride 想要占用可用的全部空间，它应该返回一个正无穷大的高度和宽度，但当我尝试这样做时会出现错误。因此，我遇到了一个问题，即我的一些子项目被剪裁了，因为包含 OverlapPanel 的 ItemsPresenter 仅调整为返回的 MeasureOverride 大小并剪裁了我的一些插图，因为在 ArrangeOverride 之后，它们被移动了并且最终尺寸更大。

2.）我尝试使用 VisualTreeHelper.FindElementInHostCoordinates 使用每个“ItemsControl”的 Canvas.Left 和 Canvas.Top 属性，在每个插图的“ContentPresenter”下方几个级别，以在 OverlapPanel 子树中查找其他重叠项。我必须深入到 ItemsControl 的原因是因为它是第一个具有有效 canvas.top 和 left 属性以及 DesiredSize.Width 和 DesiredSize.Height 的项目。但是，无论我尝试什么，FindElementInHostCoordinates 都会返回 0 个项目。我什至尝试使用 TransformToVisual 在使用它之前将我的坐标转换为各个级别，但我仍然无法获得任何预期的结果。

3.) 因为我使用 OverlapPanel 作为 ItemsControl 的 ItemsPanel，所以我必须深入到可视化树几个级别以获得实际的左侧/顶部值和宽度/高度来计算定位，但这不允许面板用作通用面板。我怎样才能使它整体上更有用？

这是我目前正在使用的代码。请注意，“PreArrange”最终会在每个子元素上调用“Arrange”，并设置其左侧/顶部属性。为简洁起见，我将其代码保留了下来：

```
Protected Overrides Function MeasureOverride(ByVal availableSize As System.Windows.Size) As System.Windows.Size
        'Return MyBase.MeasureOverride(availableSize)
        Dim infinite As New Size(Double.PositiveInfinity, Double.PositiveInfinity)

        Dim maxX, maxY As Double
        maxX = 0
        maxY = 0

        For Each elem As FrameworkElement In Children
            elem.Measure(infinite)
            Dim ic As ItemsControl = CType(VisualTreeHelper.GetChild(VisualTreeHelper.GetChild(elem, 0), 0), ItemsControl)
            If (elem.GetValue(Canvas.LeftProperty) + ic.DesiredSize.Width) > maxX Then
                maxX = elem.GetValue(Canvas.LeftProperty) + ic.DesiredSize.Width
            End If
            If (elem.GetValue(Canvas.TopProperty) + ic.DesiredSize.Height) > maxY Then
                maxY = elem.GetValue(Canvas.TopProperty) + ic.DesiredSize.Height
            End If
        Next

        Return New Size(maxX, maxY)
    End Function

    Protected Overrides Function ArrangeOverride(ByVal finalSize As System.Windows.Size) As System.Windows.Size
        If Children.Count = 0 Then
            Return MyBase.ArrangeOverride(finalSize) 'New Size(Width, Height)
        End If

        Dim maxX As Double = 0
        Dim minX As Double = 0
        Dim maxY As Double = 0
        Dim minY As Double = 0

        For i As Integer = 0 To Children.Count - 1
            PreArrange(Children(i), 5, 1, 10)
            Dim ic As ItemsControl = CType(VisualTreeHelper.GetChild(VisualTreeHelper.GetChild(Children(i), 0), 0), ItemsControl)
            Dim x1 As Double = Children(i).GetValue(Canvas.LeftProperty)
            Dim x2 As Double = ic.DesiredSize.Width + x1
            Dim y1 As Double = Children(i).GetValue(Canvas.TopProperty)
            Dim y2 As Double = ic.DesiredSize.Height + y1

            If x1 < minX Then minX = x1
            If x2 > maxX Then maxX = x2
            If y1 < minY Then minY = y1
            If y2 > maxY Then maxY = y2
        Next

        Return New Size(Math.Abs(minX) + maxX, Math.Abs(minY) + maxY)
        'Return MyBase.ArrangeOverride(finalSize)
    End Function 
```

[替代文字 http://www.mistertnt.com/images/OverlapPanelVisualTree.jpg](http://www.mistertnt.com/images/OverlapPanelVisualTree.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-13T18:22:09.673

Check out the DragDockPanel [here](http://here):

[http://mightymeaty.members.winisp.net/blacklight.silverlight/](http://mightymeaty.members.winisp.net/blacklight.silverlight/)

# c++ - C++模板参数有什么要求？

> ID：643763
> 
> 赞同：8
> 
> 时间：2009-03-13T17:27:34.453
> 
> 标签：c++, templates, parameters, constants, extern

如果您在 C++ 中使用一个将整数值作为参数的模板，那么对于用作参数的整数变量是否有任何要求与将变量用作函数调用中的参数不同？

[这是对here](https://stackoverflow.com/questions/641397/c-best-way-to-define-cross-file-constants/641431#641431)的后续问题 。我特别想解决函数或模板是否存在声明为“extern const int”的差异 WRT 变量？

我可以看到，对于某些模板案例，编译时需要参数值。这总是正确的吗？有没有办法指定在运行时使用该值，也许仅用于参数值的某些用途？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-13T18:12:58.277

The following is from the standard.

14.3.2.1:

> A template-argument for a non-type, non-template template-parameter shall be one of:
> 
> *   an integral constant-expression of integral or enumeration type; or
> *   the name of a non-type template-parameter; or
> *   the address of an object or function with external linkage, including function templates and function template-ids but excluding non-static class members, expressed as & id-expression where the & is optional if the name refers to a function or array, or if the corresponding template-parameter is a reference; or
> *   a pointer to member expressed as described in 5.3.1 .

5.19.1:

> In several places, C++ requires expressions that evaluate to an integral or enumeration constant: as array bounds (8.3.4, 5.3.4), as case expressions (6.4.2), as bit-field lengths (9.6), as enumerator initializers (7.2), as static member initializers (9.4.2), and as integral or enumeration non-type template arguments (14.3).
> 
> ```
>  constant-expression:
>             conditional-expression 
> ```
> 
> An integral constant-expression can involve only literals (2.13), enumerators, const variables or static data members of integral or enumeration types initialized with constant expressions (8.5), non-type template parameters of integral or enumeration types, and sizeof expressions. Floating literals (2.13.3) can appear only if they are cast to integral or enumeration types. Only type conversions to integral or enumera- tion types can be used. In particular, except in sizeof expressions, functions, class objects, pointers, or references shall not be used, and assignment, increment, decrement, function-call, or comma operators shall not be used.

With respect to your previous post I believe the essence in the part "const variables ... *initialised* with ..." (and I don't think initialised externally counts).

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-13T18:14:58.753

It has to be a integral constant expression. That's explained by the Standard document at `5.19`:

> An integral constant-expression can involve only literals (2.13), enumerators, const variables or static data members of integral or enumeration types initialized with constant expressions (8.5), non-type template parameters of integral or enumeration types, and sizeof expressions. Floating literals (2.13.3) can appear only if they are cast to integral or enumeration types. Only type conversions to integral or enumeration types can be used.

Note that "integral" is another term for "integer", but is not the same as "int". "char" for example has integer/integral type, but is not the int type, obviously. So concretely, the following is allowed

*   `10 or 10L or anything like that`
*   `enum { THIS, OR, THAT };`
*   `int const this_one = 10;`
*   `sizeof(char)`
*   of course, any other template parameter as detailed above

Any of those can be used as a template argument for a parameter that has an integral type of the corresponding type. Some conversions are still applied though. So if it wants an int and you pass a char, it automatically promotes the char to the int. Same if you provide an enumerator and it wants an int.

So by those rules, if you have

```
extern const int SomeName; 
```

And it does not see a definition which initializes that constant with a integral constant expression, it can't be used as a template argument. But it can be used as a function argument, of course. Those don't need to be known at compile time because those are not part of a type. The moment you name a template specialization, the arguments you used become part of the type:

```
MyGreatStack<int, 4> // 4 is now part of the type MyGreatStack<int, 4>! 
```

Note that there *are* other ways to pass `SomeName` as an argument. However, all of which can *not* be accepted by an integer template parameter. You can accept the above by a reference parameter, for example

```
template<const int& V> struct NowItWorks { }; 
```

And it would accept the `SomeName` of above. Now, rather than a value, a particular location that is unique across the whole program (as the variable has `extern` linkage) has been chosen.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-13T17:30:43.667

在编译时总是需要 int 的值。

由于每个模板实例化都是一段单独的编译代码（即使对于整数模板参数），整数需要在编译时可用（并且必须保证永远不会更改）。

这也是为什么当您要使用大量唯一值时最好不要使用整数模板参数的原因——您很快就会得到一个巨大的可执行文件。

# spring.net - Spring：删除单例

> ID：643764
> 
> 赞同：1
> 
> 时间：2009-03-13T17:27:44.530
> 
> 标签：spring.net

我正在对一个调用的类进行单元测试

```
ContextRegistry.GetContext().GetObject("ISomething") 
```

如果没有定义 ISomething 也没关系。所以我试图以两种方式测试它。由于此定义通常来自 app.config 文件，并且我不想在测试之间编辑该文件，因此我使用 [TestFixtureSetUp] 和 [TestFixtureTearDown] 来注册单例，测试，然后我想'取消注册。这很好地注册了它：

```
...ObjectFactory.RegisterSingleton("ISomething", new SomethingMOCK()); 
```

我可以检查它是否存在：

```
if (...ObjectFactory.ContainsSingleton("ISomething")) 
```

但我似乎无法删除我注册的单身人士。我尝试使用空值：

```
...ObjectFactory.RegisterSingleton("ISomething", null); 
```

但这会抛出。有没有更好的办法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T21:47:07.840

据我所知，不存在这样的功能。无论如何，这将是棘手的。如果单例在最终被移除之前已经连接到其他对象，那么语义应该是什么？可能无法将对象属性重新设置为 null，因为您不能假设受影响的属性允许为 null。如果对象是通过构造函数注入连接的，则可能甚至没有 setter 方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-27T15:56:46.803

除了您始终可以使用 new XmlApplicationContext("assembly://myconfigresource") 来实例化您自己的应用程序上下文之外，您可能还想查看 Spring.NET 对此的单元测试支持。参考文档包含一个专门的章节：[http ://www.springframework.net/doc-latest/reference/html/testing.html](http://www.springframework.net/doc-latest/reference/html/testing.html)

hth，埃里希

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-17T17:24:31.967

正如已经提到的：开箱即用是不可能的，**但是您可以通过代码轻松地做到这一点，而无需接触 Spring.net**。只需使用代理模式并允许删除/更新委托目标，例如通过简单的 get/set 属性。您所需要的只是一种获取 IoC 容器的已创建对象的方法。

# javascript - 帮我优化这个选择器？$('#data div.item:has(div.video_guid:empty)')

> ID：643770
> 
> 赞同：0
> 
> 时间：2009-03-13T17:28:48.477
> 
> 标签：javascript, jquery, optimization, selector

目前还没有到使网站无法使用的速度，但在 iphone 上的移动 safari 中存在明显的滞后。有没有更简单的方法来做到这一点？

“查找具有空 div.video_guid 的 div.items”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-13T17:32:52.007

页面上的其他任何地方是否有具有类 video_guid 的 div？如果没有，您可以将其简化为：

```
$('div.video_guid:empty'); 
```

您的选择器和我的选择器之间的唯一区别是您的选择器会匹配父级`div.item`，而我的会匹配实际的`div.video_guid`. 为了解决这个问题，一旦我的选择器匹配，如果你想对父级执行操作，`div.item`你可以这样做：

```
$('div.video_guid:empty').each(function() {
    var container = $(this).parents('div.item');
    // do something to the containing div
}); 
```

考虑到所有因素，我希望它表现更好..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T21:54:15.013

阅读[此相关问题](https://stackoverflow.com/questions/604097/jquery-equivalent-selectors/604250#604250)。根据这个，

```
$(‘div.item:has(div.video_guid:empty)’, '#data') 
```

应该更快。奇怪，但显然是可以测量的。

# c# - 如何修复此 SocketException

> ID：643774
> 
> 赞同：0
> 
> 时间：2009-03-13T17:29:49.940
> 
> 标签：c#, .net-3.5, socketexception

我有一个循环打开一个套接字，作用于套接字，然后关闭套接字并重新启动。但是，在我得到的第二次迭代`SocketException`中，每个套接字地址（协议/网络地址/端口）通常只允许使用一次。
但是，套接字应该关闭，`netstat -a`并不表明我正在侦听该端口或其他任何东西。抛出异常的代码是：

```
_bindedLocalSocket = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
_bindedLocalSocket.Bind(new IPEndPoint(Util.ChannelProfileToListeningAddress(_profile), _profile.ListenPort));
_bindedLocalSocket.Listen(30);
_bindedLocalSocket.BeginAccept(new AsyncCallback(OnRequested), null); 
```

但是，我认为罪魁祸首不是那个代码，就在我得到那个代码之前，在我尝试关闭连接之前，我得到了这个：

```
现有连接被远程主机强行关闭
   在 System.Net.Sockets.Socket.EndReceive（IAsyncResult asyncResult）
   在 Poderosa.PortForwarding.SynchronizedSocket.EndReceive(IAsyncResult ar)
   在 Poderosa.PortForwarding.Channel.OnSocketData（IAsyncResult 结果）
```

一旦我关闭程序并再次运行它，它可以使第一个连接正常，第二个行为相同（SocketException）。有谁知道我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-13T17:36:57.007

我以为 socket.Close() 会解决这个问题，但我猜不是。在这种情况下，您需要使用：

```
socket.SetSocketOption(SocketOptionLevel.Socket, SocketOptionName.ReuseAddress, true); 
```

[您可以在此处](http://msdn.microsoft.com/en-us/library/system.net.sockets.socketoptionname.aspx)阅读有关套接字选项的更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T17:35:21.283

这是 Windows 上的一个已知问题，即使您关闭了套接字，在资源释放回操作系统之前也有等待时间。

有一种方法可以在 .NET 中手动设置套接字的等待时间，但是重新审视您的设计可能是更好的选择，而是保持侦听器套接字打开，而不是关闭它，而是关闭新的套接字在 Socket.Accept() 期间创建；

# c# - 私有方法和属性与公共方法和属性在 C#（和其他语言）中的内存占用情况

> ID：643775
> 
> 赞同：4
> 
> 时间：2009-03-13T17:29:54.417
> 
> 标签：c#, memory, properties

我记得我最近与一位开发人员讨论了私有与公共属性的内存占用。我说过私人的足迹比公共的少。他声称这没有区别。顺便说一句，我们在谈论 C#。

**谁是对的，为什么？**

显然语言有差异。我也很好奇它们是什么。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-13T17:31:39.920

在什么语言的语境下？

**在大多数语言中**，将方法的可访问性从`public`to更改为`private`或反之亦然**不会影响其内存占用**。这是因为方法的实际实现和实际调用不会改变，只是强制访问它的方式（在编译时或在运行时，基于所讨论的编程语言）。

**对内存占用有影响的是其他限定符*，*例如**Java **`final`、`virtual`C++`static`等。** 这些限定符可能直接影响内存占用（类中相应条目的存在或不存在[`vtable`](http://en.wikipedia.org/wiki/Virtual_table)），或间接影响内存占用因为编译器或运行时可以做出某些优化假设（例如，非`virtual`,`static`和/或`final`方法可以内联，因此可以说会提高性能 - 并且*肯定会*增加内存占用。）

* * *

**比内存占用更重要的是**，在讨论如何限定方法时，您可以对（1）让编译器（或运行时，取决于语言）验证您的一些假设和意图，以及（ 2) 将这些假设和意图传达给程序员，他们将在您之后审查、逆向工程、更改、重构等代码：

*   `private`: 其他类，或者这个类的后代，需要直接访问这个方法吗？如果没有，做它`private`。
*   `protected`：这个类（或这个类本身）的后代，但没有其他类（除了可能`friend`的类）需要直接访问这个方法吗？如果是这样，做它`protected`。
*   `static`：该方法是否需要访问成员变量或访问`this`？如果不是，它应该是`static`（例如，一个仅依赖于其参数的实用方法）
*   `const`：该方法是否会更改成员变量或在成员变量`const`上调用非成员方法`this`？如果不是，它应该是`const`（例如吸气剂）
*   `virtual`: 这个方法需要被覆盖吗？如果不是，它不*应该*是`virtual`
*   `abstract`（或纯虚拟）：该方法是否需要在此类中具有实现，如果此类的后代将覆盖它？如果没有，做它`abstract`（或`pure virtual`）
*   等等

关于上述最佳实践，有各种各样的文章、讲座和帖子，超越了许多编程语言的界限：

*   [访问权限和封装](https://agora.cs.illinois.edu/download/attachments/19923932/lecture19.pdf?version=1)
*   [封装](http://yosefk.com/c++fqa/class.html#fqa-7.4)
*   [私有与受保护](https://stackoverflow.com/questions/224966/private-and-protected-members-c)
*   等等

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-13T17:32:06.610

没有什么不同的。属性本身只是代码和它的元数据。无论财产是私有的还是公共的，两者都是必需的。为什么会有所作为？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T17:42:22.843

我可以看到私人与公共有所不同的唯一方法是你是否混淆了你的代码。默认情况下，混淆器通常不会混淆公共成员的名称，因为这样您将无法反映它们。这将花费您非常少的内存，因为成员的名称包含在程序集的元数据中。

请注意，我在这里谈论的是少量的节省。真的不值一提。但现在是星期五下午。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-13T18:06:21.443

将属性或方法设为私有可以提高执行速度，因为编译器可能更有可能内联代码，但我不知道有任何实例可以减少内存占用（内联实际上可能会增加内存占用以提高速度）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T17:51:39.637

没有区别。而且，即使有，也必须非常残酷地更换访问器以适应它。

# java - 从 portlet 中的 doView 方法重定向

> ID：643781
> 
> 赞同：3
> 
> 时间：2009-03-13T17:31:03.103
> 
> 标签：java, websphere, redirect, portlet

我正在使用 Websphere 门户 6.0，我想知道是否有一种方法可以告诉服务器从 doView 方法呈现哪个页面。我知道我可以通过 processAction 方法做到这一点，但不幸的是问题的语义不允许这样做。

感谢您的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-18T12:35:16.630

我怀疑是否可以在 doView() 中发送重定向。有两个原因：

*   出于性能和其他各种原因，门户可能会在门户的 HTTP 响应的标头生成并发送出去后调用 doView() - 因此发出重定向为时已晚。
*   能够做到这一点可能非常“邪恶”——portlet 的 doView() 可以随时由门户调用，而无需用户与该 portlet 交互。因此，portlet 可以在随机页面刷新或与另一个 portlet 交互之后进行重定向。

一般来说，我会说如果portlet 需要在doView 中进行重定向，那么它可能需要重新设计。也许尝试更详细地描述您的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-30T09:25:53.590

据我了解，您想决定要向用户显示哪个 JSP/HTML 页面。

在这种情况下，这就是您需要做的。

```
public void doView(RenderRequest req, RenderResponse res) throws IOException,
PortletException {

    PortletRequestDispatcher prd =
        getPortletContext().getRequestDispatcher("/WEB-INF/jsp/view.jsp");
    prd.include(req, res);
} 
```

您可以决定每次要获取哪个 jsp 的请求调度程序。

# javascript - 如何检查对象是否为日期？

> ID：643782
> 
> 赞同：777
> 
> 时间：2009-03-13T17:31:06.690
> 
> 标签：javascript, date

我在网页上有一个烦人的错误：

> date.GetMonth() 不是函数

所以，我想我做错了什么。该变量`date`不是类型的对象`Date`。**如何检查 Javascript 中的数据类型？**我试图添加一个`if (date)`，但它不起作用。

```
function getFormatedDate(date) {
    if (date) {
       var month = date.GetMonth();
    }
} 
```

那么，如果我想编写防御性代码并防止日期（不是一个）被格式化，我该怎么做？

谢谢！

**更新：**我不想检查日期的格式，但我想确保传递给方法的参数`getFormatedDate()`是 type `Date`。

* * *

## 回答 #1

> 赞同：1359
> 
> 时间：2009-03-13T17:43:37.300

作为鸭子打字的替代方法

```
typeof date.getMonth === 'function' 
```

您可以使用`instanceof`运算符，即但它也会为无效日期返回 true，例如`new Date('random_string')`也是 Date 的实例

```
date instanceof Date 
```

如果对象跨越帧边界，这将失败。

解决方法是通过检查对象的类

```
Object.prototype.toString.call(date) === '[object Date]' 
```

* * *

## 回答 #2

> 赞同：173
> 
> 时间：2013-04-24T13:13:35.483

您可以使用以下代码：

```
(myvar instanceof Date) // returns true or false 
```

* * *

## 回答 #3

> 赞同：102
> 
> 时间：2017-05-26T09:56:48.567

为了检查该值是否是标准 JS-date 对象的有效类型，您可以使用此谓词：

```
function isValidDate(date) {
  return date && Object.prototype.toString.call(date) === "[object Date]" && !isNaN(date);
} 
```

1.  `date`检查参数是否不是[假值](https://developer.mozilla.org/en-US/docs/Glossary/Falsy)（`undefined`, `null`, `0`, `""`, 等）
2.  `Object.prototype.toString.call(date)`返回给定对象类型的[本地字符串表示](http://www.ecma-international.org/ecma-262/5.1/#sec-15.2.4.2)- 在我们的例子`"[object Date]"`中。因为[`date.toString()`覆盖了它的父方法](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toString#Examples)，所以我们需要[`.call`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/call)或者直接[`.apply`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/apply)从`Object.prototype`哪个..
    *   绕过具有相同构造函数名称的用户定义对象类型（例如：“日期”）
    *   [与`instanceof`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/instanceof#instanceof_and_multiple_context_(e.g._frames_or_windows))or相比，可以跨不同的 JS 上下文（例如 iframe）工作[`Date.prototype.isPrototypeOf`](https://jsbin.com/vufufoq/edit?js,console)。
3.  `!isNaN(date)`最后检查该值是否不是`Invalid Date`.

* * *

## 回答 #4

> 赞同：40
> 
> 时间：2009-03-13T17:34:57.947

函数是`getMonth()`，不是`GetMonth()`。

无论如何，您可以通过执行此操作来检查对象是否具有 getMonth 属性。这并不一定意味着该对象是一个日期，只是任何具有 getMonth 属性的对象。

```
if (date.getMonth) {
    var month = date.getMonth();
} 
```

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2009-03-13T17:41:14.140

如上所述，在使用之前检查函数是否存在可能是最简单的。如果你真的关心它是一个[`Date`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date)，而不仅仅是一个具有`getMonth()`函数的对象，试试这个：

```
function isValidDate(value) {
    var dateWrapper = new Date(value);
    return !isNaN(dateWrapper.getDate());
} 
```

如果它是 a ，这将创建值的克隆`Date`，或者创建无效的日期。然后，您可以检查新日期的值是否无效。

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2009-03-13T19:23:28.200

对于所有类型，我都制作了一个 Object 原型函数。它可能对你有用

```
Object.prototype.typof = function(chkType){
      var inp        = String(this.constructor),
          customObj  = (inp.split(/\({1}/))[0].replace(/^\n/,'').substr(9),
          regularObj = Object.prototype.toString.apply(this),
          thisType   = regularObj.toLowerCase()
                        .match(new RegExp(customObj.toLowerCase()))
                       ? regularObj : '[object '+customObj+']';
     return chkType
            ? thisType.toLowerCase().match(chkType.toLowerCase()) 
               ? true : false
            : thisType;
} 
```

现在你可以像这样检查*任何*类型：

```
var myDate     = new Date().toString(),
    myRealDate = new Date();
if (myRealDate.typof('Date')) { /* do things */ }
alert( myDate.typof() ); //=> String 
```

[ **2013 年 3 月编辑**] 基于不断进步的洞察力，这是一种更好的方法：

```
Object.prototype.is = function() {
        var test = arguments.length ? [].slice.call(arguments) : null
           ,self = this.constructor;
        return test ? !!(test.filter(function(a){return a === self}).length)
               : (this.constructor.name ||
                  (String(self).match ( /^function\s*([^\s(]+)/im)
                    || [0,'ANONYMOUS_CONSTRUCTOR']) [1] );
}
// usage
var Some = function(){ /* ... */}
   ,Other = function(){ /* ... */}
   ,some = new Some;
2..is(String,Function,RegExp);        //=> false
2..is(String,Function,Number,RegExp); //=> true
'hello'.is(String);                   //=> true
'hello'.is();                         //-> String
/[a-z]/i.is();                        //-> RegExp
some.is();                            //=> 'ANONYMOUS_CONSTRUCTOR'
some.is(Other);                       //=> false
some.is(Some);                        //=> true
// note: you can't use this for NaN (NaN === Number)
(+'ab2').is(Number);                 //=> true 
```

* * *

## 回答 #7

> 赞同：18
> 
> 时间：2020-09-14T01:44:53.527

如果您不关心 iframe/其他上下文，这是一种非常简单的方法。

```
// Invalid Date.getTime() will produce NaN
if (date instanceof Date && date.getTime()) {
    console.log("is date!");
} 
```

*   检查对象是否实际上是 a`Date`而不是看起来像 a 的东西。任何对象都可以具有`getMonth`功能。
*   确保日期不是`Invalid Date`
*   不会将值传递到`new Date()`可以将数字甚至字符串转换为日期的位置。

如果您需要支持 iframe 和不同的上下文，您可以使用接受的答案，但添加额外的检查以识别无效日期。

```
// Invalid Date.getTime() will produce NaN
if (Object.prototype.toString.call(date) === '[object Date]' && date.getTime()) {
    console.log("is date!");
} 
```

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2016-09-15T09:49:42.457

我发现的最好方法是：

```
!isNaN(Date.parse("some date test"))
//
!isNaN(Date.parse("22/05/2001"))  // true
!isNaN(Date.parse("blabla"))  // false 
```

* * *

## 回答 #9

> 赞同：12
> 
> 时间：2016-05-05T09:54:21.937

*UnderscoreJS*和*Lodash*有一个名为的函数[`.isDate()`](https://lodash.com/docs#isDate)，它似乎正是您所需要的。值得看看它们各自的实现：[Lodash isDate](https://github.com/lodash/lodash/blob/master/isDate.js) , [UnderscoreJs](https://github.com/jashkenas/underscore/blob/1bfc9f1fb811060c745e7025ec55e35f87c1d43b/underscore.js#L1321)

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2019-08-28T13:31:19.797

您可以使用以下解决方法，而不是所有解决方法：

```
dateVariable = new Date(date);
if (dateVariable == 'Invalid Date') console.log('Invalid Date!'); 
```

我发现这个黑客更好！

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2017-06-26T21:05:22.550

我一直在使用一种更简单的方法，但不确定这是否仅在 ES6 中可用。

```
let a = {name: "a", age: 1, date: new Date("1/2/2017"), arr: [], obj: {} };
console.log(a.name.constructor.name); // "String"
console.log(a.age.constructor.name);  // "Number"
console.log(a.date.constructor.name); // "Date"
console.log(a.arr.constructor.name);  // "Array"
console.log(a.obj.constructor.name);  // "Object" 
```

但是，这不适用于 null 或 undefined，因为它们没有构造函数。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2022-01-26T10:14:11.277

箭头函数

```
const isValidDate = (value: any) => value instanceof Date && !isNaN(value); 
```

功能：

```
function isValidDate(d) {
  return d instanceof Date && !isNaN(d);
} 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-03-13T17:35:58.007

您可以检查是否存在特定于 Date 对象的函数：

```
function getFormatedDate(date) {
    if (date.getMonth) {
        var month = date.getMonth();
    }
} 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2016-08-22T19:30:41.180

你也可以使用简短的形式

```
function getClass(obj) {
  return {}.toString.call(obj).slice(8, -1);
}
alert( getClass(new Date) ); //Date 
```

或类似的东西：

```
(toString.call(date)) == 'Date' 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2015-03-29T13:38:53.010

`true`如果它是 Date 或其他，此函数将返回`false`：

```
function isDate(myDate) {
    return myDate.constructor.toString().indexOf("Date") > -1;
} 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2018-03-05T08:06:36.717

还有一个变种：

```
Date.prototype.isPrototypeOf(myDateObject) 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2019-02-20T13:40:34.840

使用 try/catch 的方法

```
function getFormattedDate(date = new Date()) {
  try {
    date.toISOString();
  } catch (e) {
    date = new Date();
  }
  return date;
}

console.log(getFormattedDate());
console.log(getFormattedDate('AAAA'));
console.log(getFormattedDate(new Date('AAAA')));
console.log(getFormattedDate(new Date(2018, 2, 10)));
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2021-03-03T11:40:50.143

使用以下方法，您甚至可以检查日期为“无效日期”

```
if(!!date.getDate()){
    console.log('date is valid')
} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-03-13T17:45:25.940

实际上 date 将是 type `Object`。但是您可以检查对象是否具有`getMonth`方法以及它是否可调用。

```
function getFormatedDate(date) {
    if (date && date.getMonth && date.getMonth.call) {
       var month = date.getMonth();
    }
} 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2019-12-22T10:50:29.270

受此[答案](https://stackoverflow.com/a/39508022/7025986)的启发，此解决方案适用于我的情况（我需要检查从 API 收到的值是否为日期）：

```
!isNaN(Date.parse(new Date(YourVariable))) 
```

这样，如果它是来自客户端或任何其他对象的随机字符串，您可以找出它是否是类似日期的对象。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2021-04-19T08:20:28.263

我对 React 钩子有一些问题，其中 Date 稍后会进入/延迟加载，然后初始状态不能为 null，它不会通过 ts 检查，但显然一个空的 Object 可以解决问题！:)

```
const [birthDate, setBirthDate] = React.useState({})

<input
  value={birthDate instanceof Date ? birthDate.toISOString() : ''}
  name="birthDay"
/> 
```

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2019-11-08T09:32:27.497

我们也可以通过下面的代码来验证

```
var a = new Date();
a.constructor === Date
/*
true
*/ 
```

[![在此处输入图像描述](https://i.stack.imgur.com/Sbktx.png)](https://i.stack.imgur.com/Sbktx.png)

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2020-11-25T22:03:27.747

如果您使用的是 Typescript，则可以使用 Date 类型进行检查：

```
const formatDate( date: Date ) => {} 
```

* * *

## 回答 #24

> 赞同：-4
> 
> 时间：2017-04-06T08:14:53.543

你不能用

```
function getFormatedDate(date) {
    if (date.isValid()) {
       var month = date.GetMonth();
    }
} 
```

# c# - .NET 中 OOP 设计模式的可下载代码示例？

> ID：643794
> 
> 赞同：9
> 
> 时间：2009-03-13T17:33:22.910
> 
> 标签：c#, .net, design-patterns

有谁知道一些很好的可下载的 Visual Studio 解决方案文件，这些文件解释了 .NET 中的所有 GOF 设计模式（以及它们的变体，如果可能的话）（首选 C#）？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-13T17:35:36.557

有关一些好的短代码示例，请查看此[Design Patterns in C# and VB.Net](http://www.dofactory.com/Patterns/Patterns.aspx)

# virtualization - ubuntu 8.10 的虚拟机添加？

> ID：643812
> 
> 赞同：-1
> 
> 时间：2009-03-13T17:37:48.673
> 
> 标签：virtualization, virtual-pc, vpc

我知道 VPC 不正式支持 Linux，但我想知道是否有任何方法可以获得类似于 VM 添加的内容，以便我可以获得：

*   1) 比 800x600 更高的屏幕分辨率
*   2）更快的图形，没有急动的动作
*   3) 拖放支持

3号真的不是那么重要，但它会很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T17:44:17.487

[假设您可以从http://www.microsoft.com/windowsserversystem/virtualserver/downloads.aspx](http://www.microsoft.com/windowsserversystem/virtualserver/downloads.aspx)下载虚拟服务器的 Linux VM 添加，并将它们传输到 VM 以在 VirtualPC 中使用。这对于 Ubuntu 或 VirtualPC “不支持”，但可能有效。

就我个人而言，我正在为 Linux 客人使用 VirtualBox；它的添加在 Intrepid 下运行良好。不幸的是，仍然没有拖放，这肯定是我从 VPC 中错过的一个功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T17:47:36.120

Ubuntu 不支持它，但这里有 Linux 版本：

[http://www.microsoft.com/downloads/details.aspx?familyid=bf12642f-77dc-4d45-ae4e-e1b05e0a2674&displaylang=en&tm](http://www.microsoft.com/downloads/details.aspx?familyid=bf12642f-77dc-4d45-ae4e-e1b05e0a2674&displaylang=en&tm)

# python - Python - 列表转换

> ID：643823
> 
> 赞同：34
> 
> 时间：2009-03-13T17:41:29.473
> 
> 标签：python, list

有谁知道我必须使用什么魔法来更改 x 列表：

> x = [1,2,3,4,5,11]

进入你的名单？

> y = ['01','02','03','04','05','11']

提前谢谢大家帮助我...

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-03-13T17:45:20.637

您可以使用列表推导（Python 2.6+）：

```
y = ["{0:0>2}".format(v) for v in x] 
```

或者对于 2.6 之前的 Python：

```
y = ["%02d" % v for v in x] 
```

或者对于使用 f 字符串的 Python 3.6+：

```
y = [f'{v:02}' for v in x] 
```

编辑：错过了你想要零填充的事实......

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-03-13T17:42:44.323

您想使用内置[`map`](http://docs.python.org/library/functions.html#map)功能：

```
>>> x = [1,2,3,4,5]
>>> x
[1, 2, 3, 4, 5]
>>> y = map(str, x)
>>> y
['1', '2', '3', '4', '5'] 
```

**编辑**你改变了对我的要求！要使其显示前导零，请执行以下操作：

```
>>> x = [1,2,3,4,5,11]
>>> y = ["%02d" % v for v in x]
>>> y
['01', '02', '03', '04', '05', '11'] 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-13T17:51:19.200

我自己会使用列表理解，但对于那些感兴趣的人来说，这是另一种使用地图的解决方案......

```
map(lambda v: "%02d" %v, x) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-13T17:51:02.727

```
y = ['%02d'%v for v in x] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-06-28T01:29:53.597

试试这个：

```
>>> [str(v).rjust(2,'0') for v in x]
['01', '02', '03', '04', '05', '11'] 
```

[rjust](https://docs.python.org/2/library/stdtypes.html#str.rjust)作为字符串类的方法，接受一个整数参数（结果长度）和一个可选的填充字符

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-13T17:49:41.763

得到 0：

```
y = ['%02d' % i for i in x] 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-14T15:02:14.507

格式化字符串的替代方法是使用字符串的 zfill() 方法：

```
y = [str(i).zfill(2) for i in x] 
```

另一件事：您可能会根据列表中最大的项目进行填充，因此您可以执行以下操作，而不是仅使用 2：

```
pad_length = len(str(max(x)))
y = [str(i).zfill(pad_length) for i in x] 
```

# visual-studio-2005 - 使用 Vista 进行开发

> ID：643834
> 
> 赞同：1
> 
> 时间：2009-03-13T17:46:10.617
> 
> 标签：visual-studio-2005, windows-vista

我的公司正在推动每个人都在新笔记本电脑上切换到 Vista。我现在正在使用 Visual Studio 2005 和 SQL Server 2005，必须解决一些兼容性问题。我可以推动 XP 并通过 HR，但我也可以只是为了体验而习惯 Vista。

有开发和 Vista 方面的经验吗？优点缺点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-13T17:48:30.910

vista 本身没有编程问题。Vista SP1 对我来说是坚如磐石。

但是，我运行 Vista Ultimate 64 位，所以如果我使用 32 位编译库，我必须以 32 位为目标。

现在 Vista 已经度过了几个冬天，它变得更好了。~~只要确保你禁用 UAC ;)~~

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-13T17:56:53.463

根据我自己的经验，在 Vista 上进行开发工作得很好。此外，如果您正在进行网站开发，现在您不再局限于单个活动网站（如 XP/IIS5.1），这可以消除您生活中许多不必要的痛苦。

与通常的谣言相反，Vista 并不全是坏事。这只是观念上的改变。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T17:50:50.607

您能否向我们提供与 Vista 的特定兼容性问题？

我在家里使用 Vista，在各种 VS 版本上工作和开发。大多数情况下发生在 2008 年。我在正常情况下没有遇到特定于 Vista 的问题。

在 Vista（及更高版本）与 XP 及更低版本上使用 VS 的唯一大区别是 UAC。我知道很多人感觉不同，但我喜欢 UAC（强大的 unix/linux 背景）。UAC 会影响您的开发周期，因为它会阻止您执行潜在的非法操作（例如写入 %ProgramFiles% 或 HKLM）。离开 Admins 组可以在 XP 上获得相同的效果，但很少有人采取这一步骤。

作为受限用户（UAC 路由或缺少管理员）进行开发**通常会**增加应用程序的可靠性。所以总的来说，Vista 可能会更难，但它会产生更好的应用程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-13T17:51:25.550

我已经使用 XP 很多年了，大约一年前切换到 Vista。除此之外，我能够实际看到在 Vista 系统上运行了多少应用程序，这对我来说并没有真正的不同。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-13T17:54:30.940

假设您使用的是 Microsoft 工具，它们都可以正常工作。我不能保证 gcc，但 Visual Studio 堆栈工作得很好。微软付出了很多努力来确保他们的工具在他们自己的操作系统上正常工作。Vista 的名声不好，但现在大部分都是不值得的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-13T17:54:37.947

我最近切换到 vista 64 Ultimate，因为我认为这是值得的麻烦（想做 Directx 10 应用程序）。我还没有发现任何问题，我唯一推荐的就是让 Visual Studio 以管理员身份运行并且不要禁用 uac！！！！它可能真的很烦人，但它是 vista 最好的安全功能。我真的没有遇到过问题，因为当我安装程序时，我以管理员身份运行它们，因此它们不受限制。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-13T18:30:06.223

Vista 远没有发布时那么糟糕。Service Pack 1 修复了很多问题，定期补丁对其他问题有所帮助，还有更多的“问题”是糟糕的公关和认知造成的，而不是任何真正的失败。

甚至 UAC 也没有你听说的那么糟糕。诀窍是在您使用计算机的个人“磨合”期间将它放在第一个月也许两个月。在此期间，您正在安装和配置大量新软件，更改大量用户和系统设置，并且通常只是在玩玩。因此，您当然会在这里看到很多提示。这正是您在网上看到的所有评论说 UAC 有多糟糕时发生的情况：它们仍处于操作系统的老化期。

大约一个月后，发生了两件事：
1\. 您没有看到那么多提示，因为您没有进行那么多系统更改。
2\. 你习惯了它们，所以留下的提示实际上是有意义的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-13T17:47:45.920

我会等待 Windows 7。我现在正在使用它进行开发。我以前用过Vista，后来又换回XP。但是现在从 7 升级到 XP 简直就是地狱。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-13T17:48:37.757

我发现在 vista 上的开发没有问题，并且我使用了各种编译器、CLR 等。

我做了一些 linux 工作，但这发生在 VM 中。

现代处理器上的 VM 与本机处理器一样快，因此如果遇到问题，请加载 XP VM 并使用它运行。增加了一点摩擦，但最近的虚拟机克服了剪切-粘贴问题，并且使用网络映射驱动器，没有什么是您不能轻易做到的。

-亚当

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-13T17:51:45.457

对我有用，但我使用的是 SQL 2008 和 Visual Studio 2008。

说服他们先推出几台笔记本电脑，看看您的特定开发环境是否适用于 Vista。如果它不起作用，那么您可以在要求每个人都运行 Vista 之前专注于修复它。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-13T17:57:05.943

Windows Vista 安全性比 Windows 的早期版本要好得多。主要是因为用户帐户控制 - UAC。Windows Vista 将在用户启动该应用程序时为所有非管理应用程序提供标准权限，即使用户以管理员身份登录 Windows。这可能会导致与旨在与早期版本的 Windows 一起使用的应用程序的兼容性方面出现问题。如果您在运行这些应用程序时遇到问题，您需要告诉 Windows Vista 授予该特定应用程序的管理权限，方法是右键单击图标可以单击以管理员身份运行。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-13T17:59:39.290

确保下载并安装[适用于 Windows Vista 的 Visual Studio 2005 Service Pack 1 Update](http://www.microsoft.com/downloads/details.aspx?familyid=90e2942d-3ad1-4873-a2ee-4acc0aace5b6&displaylang=en)。

# sharepoint - 对于不继承权限的 SPList，CustomAction 未出现在 ListView Web 部件中

> ID：643853
> 
> 赞同：2
> 
> 时间：2009-03-13T17:52:57.107
> 
> 标签：sharepoint, listview, sharepoint-2007, wss

我创建了一个 SharePoint 文档库，并将其设置为不从 Web 继承权限。我已经配置了一个 ListView webpart 来显示文档库的内容，它工作正常。

我创建了一个对文档库具有贡献权限的用户，但只能阅读站点的其余部分。

我创建了一个将 Rights 属性设置为“AddListItems”的自定义操作。

当我以用户身份登录时，我看到了 SharePoint 开箱即用的标准上传和多次上传选项，但我没有看到我的自定义操作“我的上传”。

当我使用站点成员组中的用户登录时，我会在上传菜单中看到我的选择。

我在这里想念什么？它的行为就好像“AddListItems”权限与站点而不是列表相关联，但默认上传的行为与我预期的一样！

```
<Elements xmlns="http://schemas.microsoft.com/sharepoint/">
  <!-- Document Library Toolbar Upload Menu Dropdown -->
  <CustomAction Id="myUploadOption"
    GroupId="UploadMenu"
    ImageUrl="/_layouts/Images/myUploadIcon.jpg"
    Location="Microsoft.SharePoint.StandardMenu"
    Sequence="1000"
    Title="My Upload"
    Rights="AddListItems"
    Description="Assign permissions and meta data values while uploading multiple documents">
    <UrlAction Url="/_layouts/FileUploaderApp/MyFileUpload.aspx"/>
  </CustomAction>
</Elements> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T12:16:33.000

我永远无法按照我的问题中的描述进行这项工作。

为了解决我的问题，我改为为菜单项（“我的上传”）创建了一个自定义控件，该控件使用文档库上的权限进行安全检查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T18:21:06.277

如果删除 rights 属性会发生什么？上传菜单是否被其自己的权限隐藏，还是因为您的自定义操作存在而可见？

# excel - 数字字段在 Excel、SSRS 中显示为文本

> ID：643854
> 
> 赞同：15
> 
> 时间：2009-03-13T17:53:48.743
> 
> 标签：excel, reporting-services, report

在我的 SSRS 报告中，其中一个字段正在使用此表达式，其中字段是数字字段。如果值为 ，我想查看空白字段`0`。

```
=IIf(Fields!PERIOD02_VALUE.Value <> 0,Fields!PERIOD02_VALUE.Value ,"") 
```

Excel 导出版本将此字段视为文本而不是数字。

有没有其他方法可以从 SSRS 方面做到这一点？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2010-06-04T02:28:11.150

我有这个问题。一些单元格将是文本和其他数字 - 都具有相同的格式字符串。解决方法是将您的单元格表达式乘以 1.000（1 不起作用！） - 这会强制 SSRS 将单元格格式化为数字。例如; （你的表达方式）* 1.000

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-18T15:55:49.270

Excel 将此字段识别为文本，因为只要该字段为 0，您就会输出一个空字符串。

你可以试试这个，输出一个空值而不是一个空字符串：

```
=IIf(Fields!PERIOD02_VALUE.Value <> 0,Fields!PERIOD02_VALUE.Value,  Nothing) 
```

但是，这并不能保证有效，因为我似乎记得 Excel 假定该字段是第一个数据行中任何内容的类型。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-06-22T22:07:17.493

我在 excel 导出中遇到了这个问题，并用整数的 CLng 和小数的 CDbl 函数解决了这个问题。

=CLng（字段！数量。值）

这保证了 excel 单元格将是数字的并且比 Fields!Qty.Value * 1.000 更干净

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-08-01T13:42:47.213

问题是您的 IIF 语句以空**字符串**“”结尾。如果将其更改为零，它将按预期工作：

```
=IIf(Fields!PERIOD02_VALUE.Value <> 0,Fields!PERIOD02_VALUE.Value, 0) 
```

代替...

```
=IIf(Fields!PERIOD02_VALUE.Value <> 0,Fields!PERIOD02_VALUE.Value, "") 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2018-02-07T14:15:20.973

以下是针对 3 种不同故障的 3 种不同解决方案：
**值 1**

> 1234
> 空白单元格
> 1234

解决方案 2

```
=IIF(IsNumeric(Fields!TEST.Value.ToString()), CDBL(IIF(IsNumeric(Fields!TEST.Value.ToString()), Fields!TEST.Value.ToString(), "0")), " ") 
```

**价值 2**

> 1234
> 空
> 345
> 空

解决方案 2

```
=IIF(IsNumeric(Fields!TEST.Value.ToString()), CDBL(IIF(IsNumeric(Fields!TEST.Value.ToString()), Fields!TEST.Value.ToString(), "0")), "NULL") 
```

**价值 3**

> 1234
> 无效
> 345不
> 适用
> 550
> 待定
> 440
> 599
> 不适用

解决方案 3

```
=IIF(IsNumeric(Fields!TEST.Value.ToString()), CDBL(IIF(IsNumeric(Fields!TEST.Value.ToString()), Fields!TEST.Value.ToString(), "0")), Fields!TEST.Value.ToString()), 
```

# language-agnostic - 哪个先出现 - 接口或类

> ID：643859
> 
> 赞同：10
> 
> 时间：2009-03-13T17:54:39.927
> 
> 标签：language-agnostic, oop

在您的软件中设计新功能的过程中，哪个过程是最佳实践

1.  设计类将实现的接口。
2.  稍后编写类并提取接口。

如果走 2 号路线，你什么时候决定需要一个接口？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-13T17:57:13.557

当您需要从多个类中重构通用功能时，该界面就会出现。

除非您有多个具有共同特性的类，否则很难预见接口应该是什么。

一旦你有了一些类，就很容易推断出接口需要什么，然后返回并重构这些类以正确实现新发现的接口。

有些人在纸上设计了很多类来弄清楚接口应该是什么。节省重构真实代码。相反，您必须重构您的设计。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-13T18:59:05.623

诡计问题！测试是第一位的。然后是测试的实现，这是一个可能已经实现也可能不实现接口的类。使测试通过的一部分可能涉及从现有类中提取接口，但在您拥有需要该接口的东西之前，不要试图猜测您的接口需要什么。

试图提前解决这个问题会让自己发疯——或者无论如何，我在 TDD 之前的日子里总是这样做。决定你的应用需要什么功能，编写一个测试，然后让测试指导你如何处理你的代码。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-13T20:19:28.613

我同意布赖恩·格思里的观点。测试是第一位的，因为它将推动您的设计。虽然这通常意味着以一个具体的类结束（您通过在一组测试中指定其行为来设计的类），但依赖关系通常通过接口表示（以允许模拟并遵循[依赖倒置原则](http://www.objectmentor.com/resources/articles/dip.pdf)）。

这通常意味着您将在拥有类之前拥有接口，但这只是因为您更早*需要它们。*

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-13T18:09:49.173

我通常选择第二个选项。稍后编写一个类并提取接口。通常提取接口的原因是需要对该接口进行第二次实现（通常作为单元测试的模拟）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-13T18:00:46.090

我会说接口是第一位的，但是当您开发特定的类/方法时它们会出现。当您知道自己依赖于其他类/方法时，请使用接口来添加依赖项并继续编写代码。然后在编写完当前组件后返回并创建实现所需接口的组件。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-13T18:01:29.317

这一切都取决于情况......

当您在设计阶段知道您将拥有多个具有相同“共性”的类，但它们的实现不同时，那么接口首先出现。

但是，软件是有机的；它在不断发展，所以我可以想象在某些情况下，您将拥有一个类，并且在一段时间后，有必要从该类中提取一个接口。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-13T18:47:57.193

最终，无论如何，您的设计阶段都应该在您的实施阶段之前。在您开始编码之前，您应该对类之间的交互有一个清晰的了解，并希望您的接口决策从中显而易见。

但是，如果您已经编写了一个类，现在需要对其进行重构以获得接口，那么请记住，接口只是选择一组具有共同目的的函数/方法，超过一节课。如果您发现其他类需要一些有用的功能，那么这些方法将是接口的良好候选者。

使它们真正有用的接口的另一部分是，如果您发现类的某些部分不是私有的，但是您希望对某些其他对象隐藏，在这种情况下，您可以采用您想要公开的功能，并使它们成为一个界面。

我强烈反对任何说你不应该事先设计的人。程序员都喜欢直接投入其中，有时重构是必要的，但强大的设计阶段将为您节省大量的重构时间。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-13T19:38:33.547

接口对于大多数类来说是非常重要的，因为可以随时更改实现，但是一旦在接口中提供了某些内容，就很难或不可能收回它。对于项目的其他人来说，接口才是最重要的，而实现则是别人的问题。

理想情况下，接口的主要功能将在任何实现工作之前指定。（预先设计测试也是一个好主意。）可以允许细节发展，但是对接口的任何更改都应该基于其他类和例程的需要，而不是实现的工件。实现应该始终由接口决定，而不是相反。

（由于这是一个与语言无关的问题，我假设正在讨论的“接口”是该类的公共功能，而不是 Java 替代 C++ 抽象类。在 C++ 中，这将是标记为“public”的类定义。）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-16T09:00:51.973

我想就接口是什么提出两种不同的看法：

1.  接口是系统中重要实体的抽象。您可以根据接口和它们之间的协作来设计您的系统。
2.  接口是系统中允许实现变化的地方。平台差异、第 3 方库等被一个界面隐藏，该界面可以针对您的软件的不同配置以不同方式实现。

然而，在这两种情况下，您首先设计，然后编码。

对于一个新系统，我希望首先确定候选接口，然后由类实现。对于现有系统，当您发现系统中的一个重要实体或变化点之前它不那么重要或您之前不需要提供变化点时，就会从现有类开发接口。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-16T09:20:02.863

哪个先出现？需要一个特性还是一个特性的实现？

在我自己的工作流程中，界面首先是自发出现的。如果我的项目的某些部分需要一个新功能，它是围绕我想要使用它的方式构建的，即它的界面。然后实现如下。

这样，实现只包含实际需要的内容，并且不会浪费时间过度设计一段闪亮的无用代码。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-13T17:57:08.673

好吧，如果您真的经历了设计阶段，那么您将在编码之前为接口和类创建设计。对？

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-13T17:59:12.710

通常，您不需要接口，除非您想到了几个将实现它的类。因此，界面将是第一位的。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-13T18:06:01.740

我不得不同意 S. Lott 的观点，并补充说，界面的设计一旦创建就“一成不变”。

仅出于这个原因，在您知道它将包含的*所有内容*之前，不应创建接口。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-03-13T20:09:05.593

课堂应该是第一位的。

一个美丽的设计只有在经历了变化的坩埚后才能被确定为美丽。如果您的接口不是从一开始就从代码中伪造的，那么您如何知道它们是否能够经受住时间的考验？

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-03-20T11:36:41.567

随着时间的推移，接口发展得非常糟糕。每当您更改界面时，您就违反了合同。所有实现接口的类都必须重构。为了保持向后兼容，开发人员在 IFoo 上获得创意和设计 IFoo2。随着时间的推移，这将成为维护的噩梦。

请注意以下几点：更喜欢定义类而不是接口。当您想要提供值类型的多态层次结构时，请使用接口。使用接口的另一种方式是实现与多重继承类似的效果。

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2009-03-13T20:22:55.267

我不知道哪个是最好的，但我敢肯定，在所有情况下，正确的答案始终是这两个选项之一！

# c# - 使用 WCF 的分布式事务

> ID：643862
> 
> 赞同：2
> 
> 时间：2009-03-13T17:56:51.967
> 
> 标签：c#, wcf, .net-3.5, distributed-transactions

基本架构：n 个物理盒子，每一个都承载相同的 WCF 服务，开始放置一个负载均衡器。每个盒子都击中一个**不**支持事务的数据库基础设施 - 不要问:(

因此，在我的应用程序的数据访问层中，我需要一些分布式事务的方法。我有哪些选择？

请注意，我系统的客户端将是使用基本 Web 服务（BasicHttpBinding）和闪亮的新 WCF 客户端（NetTcpBinding 或 NetNamedPipeBinding）进行通信的旧应用程序。

* * *

**编辑 1**

例如，将在物理框 1 上对 WCF 层进行一次调用，例如 EditEntity(...)。此调用将触发对数据库的 2 次写入。在第一次写入之后，另一个客户端调用 EditEntity(...) 为第二个物理框上我的 WCF 服务的第二个实例上的同一实体。在第二个框中，我如何知道该特定实体的交易已经在进行中？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T18:09:51.997

不确定您是否已经为我们提供了足够的支持，但如果我没看错，您是在尝试确保您可以通过 WCF 服务支持事务吗？虽然您的数据库不支持事务，并且您的 WCF 端点位于负载均衡器后面？我有这个正确的吗？如果是这样的话....

由于您的数据库没有事务支持，因此将转移到您的 WCF 层。这表明您的方法中有一个粗略的粒度级别，以便您可以确保对 WCF 服务的单个调用足以包含您的事务。不要将事务分散到多个 WCF 调用中，这是在自找麻烦。

* * *

更新：负载均衡器可以使用一些策略来确保连接之间的持久性，但这对您没有帮助。如果您连续调用 EditEntity()，并且第一个条目是启动事务，第二个条目是完成事务......那么您的服务不够精细。

**将这两个调用合并到一个方法，即EditEntityComplete()。**

您是否有理由不能创建一种方法，而不是两种？

* * *

更新 #2：重新表述问题 - 单个方法在不支持事务的数据库中执行条目。所讨论的方法执行一系列必须按顺序完成的步骤。WCF 方法表示并发争用违反正确顺序的步骤完成的机会。

在此基础上，假设您不需要函数的任何返回数据，请考虑使用可以记录来自 WCF 端点的请求的异步队列。然后从单个后台进程处理队列。

* * *

最终修订：

**重新考虑不更改数据存储的要求。**

考虑到对多个客户端的要求，数据存储中需要扩展、负载平衡和事务支持，最后的建议是——推动更改数据库。理解这是一个静态需求，但是当大量简单的数据库平台为您提供事务支持时，您将花费大量精力来尝试实现事务支持。尝试重新创建此功能几乎没有好处，但有很多缺点。

# svn - 如何使用 svn export 应用补丁？

> ID：643868
> 
> 赞同：3
> 
> 时间：2009-03-13T17:57:39.013
> 
> 标签：svn

我想使用 svn 将补丁从一个 Joomla 版本应用到另一个版本。我正在使用安装了版本的 mac，但不介意在命令行上使用 svn。到目前为止，我已经弄清楚如何生成从一个修订版更改为另一个修订版的文件列表，但我想将这些更改的文件导出到我的工作目录。如何做到这一点？我是否需要保存 diff 输出并使用 awk 对其进行处理，或者是否有命令行选项可以将这些文件通过管道传输到导出命令中？

我使用的 diff 命令是：svn diff [http://joomlacode.org/svn/joomla/development/releases/1.5@11255](http://joomlacode.org/svn/joomla/development/releases/1.5@11255) [http://joomlacode.org/svn/joomla/development/releases/1.5@11410](http://joomlacode.org/svn/joomla/development/releases/1.5@11410) - -总结

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-13T18:37:16.500

用于创建补丁使用：

```
svn diff > ~/patch.diff 
```

应用补丁使用：

```
patch -p0 -i ~/patch.diff 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-16T06:55:51.897

我不确定您当前存储库的设置以及您有多少灵活性，但遵循红豆书中详述的[供应商删除流程可能会有所帮助。](http://svnbook.red-bean.com/en/1.4/svn-book.html#svn.advanced.vendorbr)

# linux - 如何在 Mono 中嵌入 Flash？

> ID：643872
> 
> 赞同：2
> 
> 时间：2009-03-13T17:58:24.317
> 
> 标签：linux, flash, mono, webbrowser-control

是否可以在单声道应用程序中嵌入闪存？

最好类似于它可以作为 ActiveX 控件嵌入到 .Net 中的方式，但是任何可以以某种方式将 flash 命令冒泡到 Mono 应用程序的任何东西都可以。

我曾假设可以使用 Web 浏览器查看 flash，但是我无法确定如何将 flash 插件安装到 WebBrowser 控件中，因为我已经通过 RPM 安装了 Flash 插件而 flash 不是安装在 Mono.Mozilla.WebBrowser 控件中。

我可能应该补充一点，该应用程序将在 Linux 上运行......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-16T18:36:02.370

您可以使用 NPAPI 在本地托管 Flash 插件，但它需要大量工作和大量代码。这是[Gecko 插件 API 参考](https://developer.mozilla.org/en/Gecko_Plugin_API_Reference)。基本上，您必须实现 Flash 所期望的整个 Netscape 一半的 API。您可以查看[Webkit](http://webkit.org/building/checkout.html)源代码以了解如何处理其中的大部分内容。

这不是一项简单的任务，一路上有很多未记录的怪癖和陷阱。如果你走这条路，至少计划一两个月的工作。然而，这是可能的，因为有 Webkit 存在证明。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-16T18:31:36.907

```
strace -eopen -o1.txt mono myapp.exe 
```

然后查看 1.txt 并查看它加载了哪些文件。也可以尝试不使用“-e”来查看所有系统调用。然后你至少可以知道它是否正在尝试......然后，幸运的是，新显示器正在错误的目录中寻找插件，你很高兴。

如果您想知道 rpm 将其存储在哪里，那就是“废话”

```
rpm -ql flahsplugin 
```

请将插件名称更改为您正在查询的包名称。

顺便说一句：stackoverflow 中的第一篇文章... /me 哭了一点...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T15:55:05.297

如果您使用 GTK#，最简单的方法可能是使用 GtkMozEmbed 的 CIL 绑定来嵌入一个仅包含 Flash 对象的小页面。

# css - CSS使HTML页面页脚以最小高度留在页面底部，但不与页面重叠

> ID：643879
> 
> 赞同：522
> 
> 时间：2009-03-13T17:59:22.660
> 
> 标签：css, footer

我有以下页面（死链接：）`http://www.workingstorage.com/Sample.htm`，它有一个页脚，我不能让它坐在页面底部。

我希望页脚

*   当页面较短且屏幕未填满时，贴在窗口底部，并且
*   当内容超过一屏时（而不是重叠内容），停留在文档末尾并正常向下移动。

CSS是继承的，让我感到困惑。我似乎无法正确更改它以在内容上设置最小高度或使页脚进入底部。

* * *

## 回答 #1

> 赞同：370
> 
> 时间：2013-12-03T13:50:28.497

# 以下是我的4种不同的方法：

在每个示例中，文本都是可自由编辑的，以说明内容在不同场景中的呈现方式。

* * *

## 1) 弹性盒

```
body{ height:100vh; margin:0; }

header{ min-height:50px; background:lightcyan; }
footer{ min-height:50px; background:PapayaWhip; }

/* Trick */
body{ 
  display:flex; 
  flex-direction:column; 
}

footer{
  margin-top:auto; 
}
```

```
<body>
  <header contentEditable>Header</header>
  <article contentEditable>Content</article>
  <footer contentEditable>Footer</footer>
</body>
```

* * *

## 2) 网格

```
body{ 
  min-height: 100vh; 
  margin: 0; 

  display: grid;
  grid-template-rows: auto 1fr auto;
}

header{ 
  min-height:50px;
  background:lightcyan; 
}

footer{ 
  min-height:50px; 
  background:PapayaWhip; 
}
```

```
<body>
  <header contentEditable>Header</header>
  <article contentEditable>Content</article>
  <footer contentEditable>Footer</footer>
</body>
```

* * *

下面的这个方法通过在 上放置一个`::after`伪元素来使用“技巧”，并将其`body`设置为具有页脚的*确切*高度，因此它将占据与页脚完全相同的空间，所以当页脚`absolute`位于它上面时，看起来页脚确实占用了空间并消除了它的绝对定位的负面影响（例如，遍历正文的内容）

## 3）`position:absolute`（无*动态*页脚高度）

```
body{ min-height:100vh; margin:0; position:relative; }
header{ min-height:50px; background:lightcyan; }
footer{ background:PapayaWhip; }

/* Trick: */
body {
  position: relative;
}

body::after {
  content: '';
  display: block;
  height: 50px; /* Set same as footer's height */
}

footer {
  position: absolute;
  bottom: 0;
  width: 100%;
  height: 50px;
}
```

```
<body>
  <header contentEditable>Header</header>
  <article contentEditable>Content</article>
  <footer contentEditable>Footer</footer>
</body>
```

* * *

## 4）表格布局

```
html{ height:100%; }
body { min-height:100%;  margin:0; }

header {
  height: 50px;
  background: lightcyan;
}

article { 
  height: 1%;
}

footer {
  height: 50px;
  background: PapayaWhip;
}

/**** Trick: ****/

body {
  display: table;
  width: 100%; 
}

body > footer {
   display: table-row;
}
```

```
<body>
  <header contentEditable>Header</header>
  <article contentEditable>Content</article>
  <footer contentEditable>Footer</footer>
</body>
```

* * *

## 回答 #2

> 赞同：367
> 
> 时间：2009-03-27T10:53:47.807

一个简单的方法是制作`100%`你的页面的body，用`min-height`of`100%`也可以。如果页脚的高度没有改变，这可以正常工作。

给页脚一个负边距顶部：

```
footer {
    clear: both;
    position: relative;
    height: 200px;
    margin-top: -200px;
} 
```

* * *

## 回答 #3

> 赞同：65
> 
> 时间：2013-11-01T09:02:56.773

一个非常简单的跨浏览器效果很好的方法是：

[http://matthewjamestaylor.com/blog/keeping-footers-at-the-bottom-of-the-page](http://matthewjamestaylor.com/blog/keeping-footers-at-the-bottom-of-the-page)

```
html,
body {
   margin:0;
   padding:0;
   height:100%;
}
#container {
   min-height:100%;
   position:relative;
}
#header {
   background:#ff0;
   padding:10px;
}
#body {
   padding:10px;
   padding-bottom:60px;   /* Height of the footer */
}
#footer {
   position:absolute;
   bottom:0;
   width:100%;
   height:60px;   /* Height of the footer */
   background:#6cf;
}
```

```
<div id="container">
   <div id="header">header</div>
   <div id="body">body</div>
   <div id="footer">footer</div>
</div>
```

* * *

## 回答 #4

> 赞同：49
> 
> 时间：2016-03-22T16:41:40.107

我用它把我的页脚贴在底部，它对我有用：

**HTML**

```
<body>
    <div class="allButFooter">
        <!-- Your page's content goes here, including header, nav, aside, everything -->
    </div>
    <footer>
        <!-- Footer content -->
    </footer>
</body> 
```

这是您必须在 HTML 中进行的唯一修改，将其添加`div`到`"allButFooter"`类中。我对所有页面都做了，那些很短，我知道页脚不会粘在底部，还有足够长的页面，我已经知道我必须滚动。我这样做了，所以我可以看到它在页面内容是动态的情况下可以正常工作。

**CSS**

```
.allButFooter {
    min-height: calc(100vh - 40px);
} 
```

该类`"allButFooter"`的`min-height`值取决于视口的高度（`100vh`表示视口高度的 100%）和页脚的高度，我已经知道是`40px`.

这就是我所做的一切，它对我来说非常有效。我没有在每个浏览器中都尝试过，只有 Firefox、Chrome 和 Edge，结果如我所愿。页脚贴在底部，您不必弄乱 z-index、位置或任何其他属性。我文档中每个元素的位置都是默认位置，我没有将其更改为绝对或固定或任何东西。

***使用响应式设计***

这是我想澄清的事情。当我使用`Twitter-Bootstrap`. 我不得不修改我在函数中减去的值：

```
.allButFooter {
    min-height: calc(100vh - 95px); 
} 
```

这可能是因为`Twitter-Bootstrap`它有自己的边距和填充，所以这就是我必须调整该值的原因。

我希望这对你们有一些用处！至少，这是一个简单的尝试解决方案，并且不需要对整个文档进行大的更改。

* * *

## 回答 #5

> 赞同：48
> 
> 时间：2017-08-18T18:16:09.330

一个非常简单的 flex 解决方案，它不假设固定高度或改变元素的位置。

**HTML**

```
<div class="container">
  <header></header>
  <main></main>
  <footer></footer>
</div> 
```

**CSS**

```
.container {
  display: flex;
  flex-direction: column;
  min-height: 100vh;
}

main {
  flex: 1;
} 
```

* * *

**浏览器支持**

所有主流浏览器，IE11 及以下版本除外。

确保对适当的前缀使用[Autoprefixer](https://autoprefixer.github.io/)。

```
.container {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
  -ms-flex-direction: column;
  flex-direction: column;
  min-height: 100vh;
}

main {
  -webkit-box-flex: 1;
  -ms-flex: 1;
  flex: 1;
}

/////////////////////////////////////////////

body,
html {
    margin: 0;
    padding: 0;
}

header,
main,
footer {
  margin: 0;
  display: block;
}

header,
footer {
  min-height: 80px; 
}

header {
  background-color: #ccc;
}

main {
  background-color: #f4f4f4;
}

footer {
  background-color: orange;
}
```

```
<div class="container">
  <header></header>
  <main></main>
  <footer></footer>
</div>
```

* * *

## 回答 #6

> 赞同：44
> 
> 时间：2013-07-23T09:35:37.560

从 IE7 开始，您可以简单地使用

```
#footer {
    position:fixed;
    bottom:0;
} 
```

请参阅[caniuse](http://caniuse.com/css-fixed)以获得支持。

* * *

## 回答 #7

> 赞同：18
> 
> 时间：2014-09-19T07:16:52.440

**我使用的一个简单的解决方案，适用于 IE8+**

在 html 上给出 min-height:100% ，这样如果内容较少，则页面仍会采用完整的视口高度，页脚会停留在页面底部。当内容增加时，页脚会随着内容向下移动并保持在底部。

JS 小提琴工作演示：http: [//jsfiddle.net/3L3h64qo/2/](http://jsfiddle.net/3L3h64qo/2/)

## CSS

```
html{
  position:relative; 
  min-height: 100%;
}
/*Normalize html and body elements,this style is just good to have*/
html,body{
  margin:0;
  padding:0;
}
.pageContentWrapper{
  margin-bottom:100px;/* Height of footer*/
} 
.footer{
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height:100px;
    background:#ccc;
} 
```

## html

```
 <html>
    <body>
        <div class="pageContentWrapper">
            <!-- All the page content goes here-->
        </div>
        <div class="footer">
        </div>
    </body>
    </html> 
```

* * *

## 回答 #8

> 赞同：16
> 
> 时间：2014-08-09T12:56:43.830

然而，另一个非常简单的解决方案是这个：

```
html, body {
    height: 100%;
    width: 100%;
    margin: 0;
    display: table;
}

footer {
    background-color: grey;
    display: table-row;
    height: 0;
} 
```

**[jsFiddle](http://jsfiddle.net/vfSM3/551/)**

诀窍是将 a`display:table`用于整个文档，将`display:table-row`with`height:0`用于页脚。

由于页脚是唯一显示为 as 的 body 子`table-row`项，因此它呈现在页面底部。

* * *

## 回答 #9

> 赞同：14
> 
> 时间：2021-06-05T06:20:53.743

### 使用 Flexbox 将页脚保持在底部

```
<div style="min-height:100vh; display:flex; flex-direction:column; 
            justify-content:space-between;">

     <div> <!-- Wrapper (Without footer) -->

        <header>
         I am a header.
        </header>

        <article>
        I am an article!
        </article>

    </div> <!-- End: Wrapper (Without footer) -->

     <footer>
     I am a footer.
     </footer>

</div>
```

#### 笔记

*   确保您`<div>`使用以下 CSS 样式将所有内容包装在一个或任何其他块级元素中`min-height:100vh; display:flex; flex-direction:column; justify-content:space-between;` ：

*   确保将除页脚元素之外的所有内容都包装在 a`<div>`或任何其他块级元素中。

*   确保您使用`<footer>`或任何其他块级元素来包装页脚。

#### 代码说明

*   `min-height: 100vh`确保 body 元素将至少伸展到屏幕的整个高度

*   `flex-direction: column`在保留堆叠的块元素方面保持正常文档流的行为（假设正文的直接子元素实际上都是块元素）。

*   `justify-content:space-between`将页脚推到屏幕底部。

* * *

查看如何使用 Bootstrap 5 执行相同操作（将页脚保持在底部） -[链接](https://stackoverflow.com/questions/10099422/flushing-footer-to-bottom-of-the-page-twitter-bootstrap/68836851#68836851)

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2017-09-01T05:17:27.340

做这个

```
<footer style="position: fixed; bottom: 0; width: 100%;"> </footer> 
```

您还可以阅读所有现代浏览器都支持的 flex

**更新**：我阅读了 flex 并尝试了它。它对我有用。希望它对你也一样。这是我的实现方式。这里主要不是 ID 它是 div

```
body {
    margin: 0;
    display: flex;
    min-height: 100vh;
    flex-direction: column;
}

main {
    display: block;
    flex: 1 0 auto;
} 
```

在这里你可以阅读更多关于 flex [https://css-tricks.com/snippets/css/a-guide-to-flexbox/](https://css-tricks.com/snippets/css/a-guide-to-flexbox/)

请记住，旧版本的 IE 不支持它。

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2009-03-13T18:00:15.547

这称为粘性页脚。[谷歌搜索](http://www.google.com/search?q=sticky+footer)它会出现很多结果。[CSS Sticky Footer](https://web.archive.org/web/20090210170534/http://ryanfait.com/sticky-footer/)是我成功使用的一个。但还有更多。

```
* {
    margin: 0;
}
html, body {
    height: 100%;
}
.wrapper {
    min-height: 100%;
    height: auto !important;
    height: 100%;
    margin: 0 auto -4em;
}
.footer, .push {
    height: 4em;
}
```

```
<html>
    <head>
        <link rel="stylesheet" href="layout.css" ... />
    </head>
    <body>
        <div class="wrapper">
            <p>Your website content here.</p>
            <div class="push"></div>
        </div>
        <div class="footer">
            <p>Copyright (c) 2008</p>
        </div>
    </body>
</html>
```

[此代码的来源](https://web.archive.org/web/20090210170449/http://ryanfait.com:80/resources/footer-stick-to-bottom-of-page/)

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2013-04-20T13:01:09.553

需要提防的一件事是移动设备，因为它们以“不寻常”的方式实现了视口的概念：

[http://developer.apple.com/library/ios/#documentation/AppleApplications/Reference/SafariWebContent/UsingtheViewport/UsingtheViewport.html#//apple_ref/doc/uid/TP40006509-SW25](http://developer.apple.com/library/ios/#documentation/AppleApplications/Reference/SafariWebContent/UsingtheViewport/UsingtheViewport.html#//apple_ref/doc/uid/TP40006509-SW25)

因此，使用`position: fixed;`（正如我在其他地方所推荐的那样）通常不是要走的路。当然，这取决于您所追求的确切行为。

我使用过并且在台式机和移动设备上运行良好的是：

```
<body>
    <div id="footer"></div>
</body> 
```

和

```
body {
    position: absolute;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    padding: 0;
    margin: 0;
}

#footer {
    position: absolute;
    bottom: 0;
} 
```

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2016-08-01T15:24:39.990

这就是我解决相同问题的方法

```
html {
  height: 100%;
  box-sizing: border-box;
}

*,
*:before,
*:after {
  box-sizing: inherit;
}

body {
  position: relative;
  margin: 0;
  padding-bottom: 6rem;
  min-height: 100%;
  font-family: "Helvetica Neue", Arial, sans-serif;
}

.demo {
  margin: 0 auto;
  padding-top: 64px;
  max-width: 640px;
  width: 94%;
}

.footer {
  position: absolute;
  right: 0;
  bottom: 0;
  left: 0;
  padding: 1rem;
  background-color: #efefef;
  text-align: center;
}
```

```
<div class="demo">

  <h1>CSS “Always on the bottom” Footer</h1>

  <p>I often find myself designing a website where the footer must rest at the bottom of the page, even if the content above it is too short to push it to the bottom of the viewport naturally.</p>

  <p>However, if the content is taller than the user’s viewport, then the footer should disappear from view as it would normally, resting at the bottom of the page (not fixed to the viewport).</p>

  <p>If you know the height of the footer, then you should set it explicitly, and set the bottom padding of the footer’s parent element to be the same value (or larger if you want some spacing).</p>

  <p>This is to prevent the footer from overlapping the content above it, since it is being removed from the document flow with <code>position: absolute; </code>.</p>
</div>

<div class="footer">This footer will always be positioned at the bottom of the page, but <strong>not fixed</strong>.</div>
```

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2021-05-01T10:53:56.690

为我工作。

```
#container{ 
  height:100vh; 
  margin:0; 
  display:flex; 
  flex-direction:column; 
}

#footer{
  margin-top:auto; 
}

<div id="container">
   <div id="header">header</div>
   <div id="body">body</div>
   <div id="footer">footer</div>
</div> 
```

```
#container{ 
  height:100vh; 
  margin:0; 
  display:flex; 
  flex-direction:column; 
}

#footer{
  margin-top:auto; 
}
```

```
<div id="container">
   <div id="header">header</div>
   <div id="body">body</div>
   <div id="footer">footer</div>
</div>
```

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2018-10-20T05:34:33.697

```
footer {
  margin-top:calc(5% + 60px);
} 
```

这工作正常

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2018-12-14T20:32:18.737

我刚刚在这里回答了类似的问题：

[将页脚放置在具有固定页眉的页面底部](https://stackoverflow.com/questions/18469262/position-footer-at-bottom-of-page-having-fixed-header)

我是 Web 开发的新手，我知道这已经得到了回答，但这是我发现解决它的最简单方法，我认为有些不同。我想要一些灵活的东西，因为我的 Web 应用程序的页脚有一个动态高度，我最终使用了 FlexBox 和一个分隔符。

1.  首先为您的 html 和 body 设置高度

```
html, body {
    height: 100%;
    display: flex;
    flex-direction: column;
    margin: 0px;
} 
```

我假设`column`我们的应用程序有一个行为，以防您需要添加标题、英雄或任何垂直对齐的内容。

2.  创建间隔类

```
.spacer {
    flex: 1; 
} 
```

3.  因此，稍后您的 HTML 可能类似于

```
<html>
  <body>
    <header> Header </header>
    Some content...
    <div class='spacer'></div>
    <footer> Footer </footer>
  </body>
</html> 
```

你可以在这里玩它 [https://codepen.io/anon/pen/xmGZQL](https://codepen.io/anon/pen/xmGZQL)

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2013-10-18T08:36:15.267

我的 jQuery 方法，如果页面内容小于窗口高度，则此方法将页脚放在页面底部，否则将页脚放在内容之后：

此外，在其他代码之前将代码保留在自己的外壳中将减少重新定位页脚所需的时间。

```
(function() {
    $('.footer').css('position', $(document).height() > $(window).height() ? "inherit" : "fixed");
})(); 
```

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2021-03-22T00:12:56.677

我使用 CSS 网格实现了这一点，基本上我定义了 3 行：

*   标题
*   内容
*   页脚

并且使用网格来定义大小，诀窍是在行尾对齐页脚，如下所示：

**CSS**

```
body {
    display: grid;
    grid-template-rows: auto auto auto;
}

footer {
    display: grid;
    align-self: end; /* The trick */
} 
```

**HTML 文件**

```
<html>
<head>
<meta charset="utf-8">
<title>Untitled Document</title>
</head>

<body>
  <header>
    Header content
  </header>

  <h1>main body</h1>
  <p>This is a paragraph.</p>

  <footer>
    <p>Hello there.</p>
  </footer>
</body>
</html> 
```

您可以使用更多行，但请记住将其添加到 CSS 中，或者将所有内容包装在 div 中。

[此处的](https://css-tricks.com/snippets/css/complete-guide-grid/#prop-align-self)本指南确实帮助我解决了这个问题。

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2013-09-26T17:09:45.300

我自己一直在研究这个问题。我见过很多解决方案，每个解决方案都有问题，通常涉及一些神奇的数字。

因此，使用来自各种来源的最佳实践，我想出了这个解决方案：

[http://jsfiddle.net/vfSM3/248/](http://jsfiddle.net/vfSM3/248/)

我想在这里特别实现的是让主要内容在绿色区域内的页脚和页眉之间滚动。

这是一个简单的CSS：

```
html, body {
    height: 100%;
    margin: 0;
    padding: 0;
}
header {
    height: 4em;
    background-color: red;
    position: relative;
    z-index: 1;
}
.content {
    background: white;
    position: absolute;
    top: 5em;
    bottom: 5em;
    overflow: auto;
}
.contentinner {
}
.container {
    height: 100%;
    margin: -4em 0 -2em 0;
    background: green;
    position: relative;
    overflow: auto;
}
footer {
     height: 2em;
     position: relative;
     z-index: 1;
     background-color: yellow;
} 
```

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2020-08-14T05:25:36.817

# 使用 Bootstrap 的 ONE line 解决方案

除了提供的所有 CSS 和 jQuery 解决方案之外，
我还列出了一个使用**Bootstrap的解决方案，在*****body***标记上带有一个类声明：`d-flex flex-column justify-content-between`

*   这*不需要*提前***知道***页脚的高度。
*   这*不需要*设置***绝对位置***。
*   这***适用***于在较小屏幕上**溢出**的动态 div 。

 **```
html, body {
  height: 100%;
}
```

```
<html>

    <head>
      <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    </head>

    <body class="d-flex flex-column justify-content-between text-white text-center">

        <header class="p-5 bg-dark">
          <h1>Header</h1>
        </header>
        <main class="p-5 bg-primary">
          <h1>Main</h1>
        </main>
        <footer class="p-5 bg-warning">
          <h1>Footer</h1>
        </footer>

        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
    </body>

</html>
```

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2018-01-16T14:46:04.950

你可以这样做

```
.footer {
  position: absolute;
  right: 0;
  bottom: 0;
  left: 0;
  padding: 1rem;
  text-align: center;
} 
```

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2021-02-09T05:41:27.203

我认为您可以将主要内容设置为视口高度，因此如果内容超出，主要内容的高度将定义页脚的位置

```
* {
  margin: 0;
  padding: 0;
  width: 100%;
}

body {
  display: flex;
  flex-direction: column;
}

header {
  height: 50px;
  background: red;
}

main {
  background: blue;
  /* This is the most important part*/
  height: 100vh; 

}
footer{
  background: black;
  height: 50px;
  bottom: 0;
}
```

```
<header></header>
<main></main>
<footer></footer>
```

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2021-06-30T15:43:32.970

`fixed`使用`bottom`,`left`和设置为 0 的位置`right`最适合我：

```
.footer {    
    position: fixed;
    background : #d1ccc0;
    bottom : 0;
    left : 0;
    right : 0;
    height : 50px;
} 
```

位置`absolute`不会粘在底部，但`fixed`会。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2014-12-30T15:43:20.167

与其他解决方案相比，不需要添加额外的容器。因此，这个解决方案更加优雅。在代码示例下面，我将解释为什么会这样。

```
<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>test</title>
        <style>

            html
            {
                height:100%;
            }

            body
            {
                min-height:100%;
                padding:0; /*not needed, but otherwise header and footer tags have padding and margin*/
                margin:0; /*see above comment*/
            }

            body
            {
                position:relative;
                padding-bottom:60px; /* Same height as the footer. */           
            }

            footer
            {
                position:absolute;
                bottom:0px;
                height: 60px;

                background-color: red;
            }

        </style>
    </head>
    <body>
        <header>header</header>

        <footer>footer</footer>
    </body>
</html> 
```

所以我们做的第一件事，就是让最大的容器（html）100%。html 页面与页面本身一样大。接下来我们设置 body 高度，它可以大于 html 标签的 100%，但至少应该一样大，因此我们使用 min-height 100%。

我们也使身体相对。相对意味着您可以将块元素从其原始位置相对移动。我们在这里不使用它。因为亲戚有第二个用途。任何绝对元素对于根 (html) 或第一个相对父/祖父母都是绝对的。这就是我们想要的，我们希望页脚是绝对的，相对于主体，即底部。

最后一步是将页脚设置为绝对和底部：0，这会将其移动到第一个相对的父/祖父的底部（当然 body ）。

现在我们还有一个问题要解决，当我们填满整个页面时，内容会位于页脚下方。为什么？好吧，因为页脚不再在“html 流”内，因为它是绝对的。那么我们如何解决这个问题呢？我们将在 body 中添加 padding-bottom。这确保了身体实际上比它的内容更大。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2018-10-12T03:04:54.500

只需自定义页脚部分

```
.footer 
{
   position: fixed;
   bottom: 0;
   width: 100%;
   padding: 1rem;
   text-align: center;
} 
```

```
 <div class="footer">
   Footer is always bootom
 </div> 
```

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2020-05-16T08:19:47.457

```
<!DOCTYPE html>

<html>
 <head>
   <link rel="stylesheet" type="text/css" href="main.css" />
 </head>

<body>
 <div id="page-container">
   <div id="content-wrap">
     <!-- all other page content -->
   </div>
   <footer id="footer"></footer>
 </div>
</body>

</html>

#page-container {
  position: relative;
  min-height: 100vh;
}

#content-wrap {
  padding-bottom: 2.5rem;    /* Footer height */
}

#footer {
  position: absolute;
  bottom: 0;
  width: 100%;
  height: 2.5rem;            /* Footer height */
} 
```

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2021-12-17T21:14:01.997

虽然我找到了许多类似的答案，但我能找到的唯一解决方案是页脚始终位于底部*且未*显示在现有数据之上：

```
footer {
    position: relative;
    clear: both;
} 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2021-12-15T07:50:27.080

```
<!DOCTYPE html>

<html>
 <head>
   <link rel="stylesheet" type="text/css" href="main.css" />
 </head>

<body>
   <header class='header'></header>
   <div class="body-content">
     <!-- all other page content -->
   </div>
   <footer class="footer"></footer>
</body>

</html>

html,
body{
  height:100%;
}
body {
  display:flex,
  flex-direction: column,
}

.body-content {
  flex-grow:1   
} 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2021-12-16T05:14:44.930

你需要使用`position: absolute;`这个很重要，那么`bottom:0`

```
.footer {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
} 
```

* * *

## 回答 #30

> 赞同：-1
> 
> 时间：2014-07-15T13:07:10.250

只需将 html、body 和除页脚之外的其他行设置为 100%。例如

```
<body>
<header></header>
<content></content>
<footer></footer> 
```

CSS变成

```
html, body, header, content{
height:100%;
} 
```

* * *

## 回答 #31

> 赞同：-1
> 
> 时间：2017-09-06T06:58:54.737

## 使用 jQuery 的动态一班轮

我遇到的所有 CSS 方法都太死板了。`fixed`此外，如果这不是设计的一部分，则不能选择将页脚设置为。

* * *

测试：

*   铬：60
*   法郎：54
*   即：11

假设这种布局：

```
<html>

<body>
  <div id="content"></div>
  <div id="footer"></div>
</body>

</html> 
```

使用以下 jQuery 函数：

```
$('#content').css("min-height", $(window).height() - $("#footer").height() + "px"); 
```

所做的是将 for 设置`min-height`为`#content`窗口**高度**-**页脚的高度，**无论当时可能是什么。

由于我们使用了`min-height`，如果`#content`height 超过了**窗口 height**，该函数会优雅地降级并且不会产生任何影响，因为它不是必需的。

看看它的实际效果：

```
$("#fix").click(function() {
  $('#content').css("min-height", $(window).height() - $("#footer").height() + "px");
});
```

```
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  background: #111;
}

body {
  text-align: center;
  background: #444
}

#content {
  background: #999;
}

#footer {
  background: #777;
  width: 100%;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

<html>

<body>
  <div id="content">
    <p>Very short content</p>
    <button id="fix">Fix it!</button>
  </div>
  <div id="footer">Mr. Footer</div>
</body>

</html>
```

[JsFiddle](https://jsfiddle.net/84nLyn6z/)上的相同片段

* * *

## 奖金：

我们可以更进一步，让这个函数适应动态查看器高度调整，如下所示：

```
$(window).resize(function() {
    $('#content').css("min-height", $(window).height() - $("#footer").height() + "px");
  }).resize();
```

```
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  background: #111;
}

body {
  text-align: center;
  background: #444
}

#content {
  background: #999;
}

#footer {
  background: #777;
  width: 100%;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

<html>

<body>
  <div id="content">
    <p>Very short content</p>
  </div>
  <div id="footer">Mr. Footer</div>
</body>

</html>
```

* * *

## 回答 #32

> 赞同：-1
> 
> 时间：2020-07-02T16:22:42.973

我做了什么

html

```
 <div>
      <div class="register">
         /* your content*/    
      </div>
      <div class="footer" />
  <div/> 
```

CSS

```
.register {
          min-height : calc(100vh - 10rem);
  }

.footer {
         height: 10rem;
 } 
```

不需要使用 position **fixed**和**absolute**。只需以正确的方式编写html。

* * *

## 回答 #33

> 赞同：-1
> 
> 时间：2020-09-07T10:08:59.853

其实很简单。此解决方案不需要知道页脚高度。

```
<body>
  <div class="app">
    Website
  </div>
  <div class="footer">
    Footer
  </div>
</body> 
```

```
.app {
  min-height: 100vh;
} 
```

* * *

## 回答 #34

> 赞同：-1
> 
> 时间：2020-09-09T19:41:25.837

有些解决方案对我不起作用，但当我决定使用 flex 选项时，我发现的最佳选择是下面的示例。

```
html, body{
    height: 100%;   
}

body{
    display: flex;
    flex-direction: column;
}

.main-contents{ 
    flex: 1 0 auto;
    min-height: 100%;
    margin-bottom: -77px;
  background-color: #CCC;
}

.footer{
    height:  77px;
    min-height: 77px;
    width: 100%;
    bottom: 0;
    left: 0;
    background: #000000;
    flex-shrink: 0;
    flex-direction: row;
    position: relative;

}

.footer-text{
  color: #FFF;
}

@media screen and (max-width: 767px){
    #content{
        padding-bottom: 0;
    }
    .footer{
        position: relative;
        /*position: absolute;*/
        height: 77px;
        width: 100%;
        bottom: 0;
        left: 0;
    }

}
```

```
<html>
  <body>
    <div class="main-contents" >
      this is the main content
    </div>
  </body>

  <footer class="footer">
    <p class="footer-text">This is the sticky footer</p>
  </footer>

</html>
```

* * *

## 回答 #35

> 赞同：-1
> 
> 时间：2021-09-01T13:07:22.553

对于**固定高度**的页脚，您也可以使用**css 变量**来完成。

```
/* Globals */

* {
  padding: 0;
  margin: 0;
  box-sizing: border-box;
}

body {
  font-family: Arial;
}

main {
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: calc(100vh - var(--navbar-height) - var(--footer-height));
  background-color: #1b1b1b;
  color: cyan;
}

/* Navbar */

:root {
  --navbar-height: 60px;
}

.navbar {
  display: flex;
  justify-content: center;
  align-items: center;
  height: var(--navbar-height);
  color: white;
  background-image: linear-gradient(75deg, yellow, orange);
}

/* Footer */

:root {
  --footer-height: 40px;
}

footer {
  display: flex;
  justify-content: center;
  align-items: center;
  height: var(--footer-height);
  color: white;
  font-weight: 700;
  background-image: linear-gradient(70deg, yellow 0%, orange 25%, teal 25%, cyan 50%, red 50%, magenta 75%, black 75%, grey 100%);
  /* background-image: linear-gradient(70deg, black 0%, cyan 100%); */
}
```

```
<body>
  <nav class="navbar">Navbar</nav>
  <main>Main Section</main>
  <footer>&copy; Test 2021 - FOREVER ❤♾</footer>
</body>
```

* * *

## 回答 #36

> 赞同：-3
> 
> 时间：2016-12-19T13:09:24.723

我已经在我的许多项目中使用过，但从未遇到过任何问题:)

供您参考，代码在片段中

```
* {
    margin: 0;
}
html, body {
    height: 100%;
}
.wrapper {
    min-height: 100%;
    height: auto !important; /* This line and the next line are not necessary unless you need IE6 support */
    height: 100%;
    margin: 0 auto -50px; /* the bottom margin is the negative value of the footer's height */
  background:green;
}
.footer, .push {
    height: 50px; /* .push must be the same height as .footer */
}

.footer{
  background:gold;
  }
```

```
<html>
<head>
<meta charset="utf-8">
<title>Untitled Document</title>
</head>

<body>
  <div class="wrapper">
    Content Area
    </div>

  <div class="push">
    </div>

  <div class="footer">
    Footer Area
    </div>
</body>
</html>
```

* * *

## 回答 #37

> 赞同：-3
> 
> 时间：2020-05-22T17:19:54.130

那个怎么样：

```
<div style="min-height: 100vh;"> 
 content
</div>

<footer>
 copyright blah blah
</footer> 
```

# c# - CommandType.Text 与 CommandType.StoredProcedure

> ID：643880
> 
> 赞同：15
> 
> 时间：2009-03-13T17:59:24.783
> 
> 标签：c#, sql, database, ado.net

与仅使用文本命令相比，显式使用 StoredProcedure CommandType 有什么好处吗？换句话说，是

```
cmd = new SqlCommand("EXEC StoredProc(@p1, @p2)");
cmd.CommandType = CommandType.Text;
cmd.Parameters.Add("@p1", 1);
cmd.Parameters.Add("@p2", 2); 
```

任何比

```
cmd = new SqlCommand("StoredProc");
cmd.CommandType = CommandType.StoredProcedure;
cmd.Parameters.Add("@p1", 1);
cmd.Parameters.Add("@p2", 2); 
```

编辑：修复了错误的复制粘贴作业（再次）。此外，问题的重点在于数据访问类。我宁愿能够在一行中传递存储的过程名称和参数，而不是每个参数的额外行。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-13T18:19:54.373

一个区别是消息泵的发生方式。

在我以前工作的地方，我们有许多批处理过程需要通宵运行。其中许多只涉及运行存储过程。我们曾经使用 sql server 作业来安排这些工作，但从它移到了 .Net 程序中调用这些过程。这使我们能够将*所有*计划任务保存在一个地方，即使是那些与 Sql Server 无关的任务。

它还允许我们在调用过程的 .Net 程序中构建更好的日志记录功能，以便所有通宵进程的日志记录是一致的。存储过程将使用 sql`print`和`raiserror`函数，.Net 程序将接收并记录这些。我们学到的是，*总是*`CommandType.StoredProcedure`将这些消息缓冲成大约 50 条。在过程完成或刷新缓冲区之前，.Net 代码不会看到任何日志事件，无论您在连接上设置了什么选项或您在其中做了什么你的 sql。为我们解决了这个问题。*`CommandType.Text`*

 *作为一个附带问题，我会在您的查询参数中使用显式类型。在某些情况下，让 .Net 尝试推断您的参数类型可能会导致问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-13T18:02:09.283

它更干净。

您正在调用存储过程，为什么不直接使用`CommandType.StoredProcedure`?

# sql - 将查询扩展到 WHERE 子句中指定的范围之外

> ID：643885
> 
> 赞同：1
> 
> 时间：2009-03-13T18:01:25.527
> 
> 标签：sql, postgresql, union

必须有更好的方法来编写此查询。

我想选择一对日期之间的所有数据。理想情况下，结果集的第一行和最后一行将是 WHERE 子句中指定的行。如果这些行不存在，我希望行在请求范围之前和之后。

一个例子：

如果我的数据是：

```
...
135321, 20090311 10:15:00
135321, 20090311 10:45:00
135321, 20090311 11:00:00
135321, 20090311 11:15:00
135321, 20090311 11:30:00
135321, 20090311 12:30:00
... 
```

查询是：

```
 SELECT * 
    FROM data_bahf 
    WHERE param_id = 135321 
    AND datetime >= '20090311 10:30:00' 
    AND datetime <= '20090311 12:00:00' 
```

我希望返回的数据包括 10:15 的行和 12:30 的行。不仅仅是那些严格符合 WHERE 子句的人。

这是我想出的最好的。

```
SELECT * FROM (
    SELECT * 
    FROM data_bahf 
    WHERE param_id = 135321 
    AND datetime > '20090311 10:30:00' 
    AND datetime < '20090311 12:00:00'

    UNION

    (
        SELECT * FROM data_bahf 
        WHERE param_id = 135321 
        AND datetime <= '20090311 10:30:00' 
        ORDER BY datetime desc
        LIMIT 1
    )

    UNION

    (
        SELECT * FROM data_bahf 
        WHERE param_id = 135321 
        AND datetime >= '20090311 12:00:00'
        ORDER BY datetime asc
        LIMIT 1
    )
) 
AS A
ORDER BY datetime 
```

（暂时忽略 SELECT * 的使用）

编辑：我在 param_id、datetime 和 (param_id, datetime) 上有索引

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T18:11:05.783

我会这样说：

```
SELECT 
  o.* 
FROM 
  data_bahf o
WHERE 
  o.param_id = 135321 
  AND o.datetime BETWEEN
  ISNULL(
    (
      SELECT   MAX(datetime) 
      FROM     data_bahf i
      WHERE    i.param_id = 135321 AND i.datetime <= '20090311 10:30:00'
    ),
    '0001-01-01 00:00:00'
  )
  AND
  ISNULL(
    (
      SELECT   MIN(datetime) 
      FROM     data_bahf i
      WHERE    i.param_id = 135321 AND i.datetime >= '20090311 12:00:00'
    ),
    '9999-12-31 23:59:59'
  ) 
```

编辑：添加了后备。
当子查询没有匹配的行时，它会产生一个`NULL`值，必须被捕获，`ISNULL()`否则`BETWEEN`操作符将失败，主查询将根本不返回任何行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-16T12:59:02.883

首先，确保您有一个**复合**索引`(param_id, datetime)`

其次，像这样查询：

```
SELECT  *
FROM    data_bahf
WHERE   param_id = 135321
        AND datetime BETWEEN
        COALESCE(
        (
        SELECT  MAX(datetime)
        FROM    data_bahf
        WHERE   param_id = 135321
              AND datetime <= '2009-01-01 00:00:00'
        ), '0001-01-01')
        AND 
        COALESCE(
        (
        SELECT  MIN(datetime)
        FROM    data_bahf
        WHERE   param_id = 135321
              AND datetime >= '2009-01-02 00:00:00'
        ), '9999-01-01') 
```

刚刚检查过，它运行在`1.215 ms`一个示例`200,000`行表中

# programming-languages - 修复 Lisp 语法

> ID：643892
> 
> 赞同：17
> 
> 时间：2009-03-13T18:02:34.027
> 
> 标签：programming-languages, syntax, lisp, scheme

作为 Lisp 的新手，我想知道 Lisp 语法是否可以“固定”？

有人说 Lisp 中的语法是其最大的优势之一。我不太明白这一点。

难道不能用空格、换行和缩进的组合来替换“明显的”括号吗？就像在 Python 中一样？

在我看来，括号是 Lisp 代码中最常用的字符。我想知道这是否属实 - 但如果是这样，这不是一个建议，语法中有一些冗余吗？

这个问题是否有一些简单的答案 - 为什么有这么多括号？

例如：

```
(defun factorial (x)
    (if (= x 0)
        1
        (* x 
           (factorial (- x 1))))) 
```

为什么不：

```
defun factorial (x)
  if (= x 0)
    1
    * x
      factorial
        - x 1 
```

例如，在行尾关闭括号，并始终在新行中打开它们。只有 1 是模棱两可的——它是 1 还是 (1)——但我们可以引入一个例外——单个标记没有“列出”。

这能行吗？

编辑：

谢谢你们！我现在看到lispin[网站](http://www.lispin.org)上有一些[链接](http://www.lispin.org/wiki?page=default/links)。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-03-13T22:10:27.097

一旦你写了几个宏，你就会改变主意。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-03-13T18:17:52.633

它已经完成了很多次（一个 < 20 行的预处理器会创造奇迹）。但是让它们显式化也有一个优势。它推动了代码和数据之间的并行性，并在某种程度上让你摆脱了那种让你觉得它们很烦人的想法。

您可以（对于一个类似的示例）采用面向对象的语言并将所有方法的语法分组删除到类中（因此它们实际上变成了重载函数）。这会让你更多地看待它，就像你看一种直接的命令式语言一样，但也会丢失一些东西。

当您查看 lisp 时，您应该认为“一切都是列表。Ommm”

（好吧，好吧，“Ommm”是可选的）。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-03-14T03:55:12.527

“也许这个过程应该被视为 Lisp 黑客的一种仪式。”

——斯蒂尔和加布里埃尔，“Lisp 的演变”，1993

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-03-13T18:10:12.183

您的建议似乎已在~~[Lispin中实施](http://www.lispin.org/)~~

**编辑：** [sindikat](https://stackoverflow.com/users/596361/sindikat)在下面的评论中指出该链接不再有效。这是 Web 存档中该站点的最后一个有效版本：[http ://wayback.archive.org/web/20080517144846id_/http://www.lispin.org/](http://wayback.archive.org/web/20080517144846id_/http://www.lispin.org/)

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-03-14T04:02:21.637

有几次我比较了 Lisp 代码和其他语言的等效代码。Lisp 代码有更多的括号，但如果你计算其他语言中的所有分组字符 []{}()，Lisp 的括号比所有这些都少。它不是更冗长：它更一致！

从这个角度来看，“问题”只是 Lisp 对所有内容都使用一种类型的构造（列表）。这是它的宏、它的对象系统、它的几个最强大的循环结构等等的基础。你所看到的轻微风格问题（括号看起来更酷吗？可能）实际上是语言能力的标志。

也就是说，Lisp 就是为程序员提供权力。如果您愿意，可以编写您自己的方言来执行此操作。Lisp（不像我可以提到的一些语言！）完全是关于程序员的能力，所以使用它。如果你能让它发挥作用，也许它会起飞。我不认为它会，但没有什么可以阻止你尝试，无论哪种方式你都会学到很多东西。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-03-14T20:06:39.097

lisp“语法”的要点是它不存在。s 表达式是一棵身份树，其中树结构由括号（**和**缩进）表示。值得注意的是，sexps 只是一种低级表示，但人们最终更喜欢它并继续使用它。

**表达式**对执行引擎的意义在 lisp 中非常灵活，而且它也是上下文**敏感****的。**

在其他语言中，上下文敏感性的级别要低得多，并且可以用来构建自己的抽象的构建块集的自由扩展性要小得多。因此，表示少数给定结构的特殊语法很适合图片。

在 lisp 中，我可以更改所有内容的含义，即使是以上下文相关的方式。为一些预定义的构造使用特殊语法会很愚蠢，因为我最终可能会使用我自己的“if”或我自己的专门闭包等。如果我的新“if”需要 4 个参数怎么办（例如，将某些 if 分组计划并告诉一些小组在某些情况下总是失败或成功）？我应该如何扩展预定义的“if”的语法？求助于 AST（sexps）要容易得多，但是为什么还要使用特殊的语法呢？

还要注意，使用像 emacs 这样的编辑器可以很容易地以结构化的方式编辑这样的树。例如，有一个键来转置树中的两个节点对于交换变量声明和交换程序块中的两个语句同样有用（提示：这就是“额外”括号在 let、cond 等中有用的原因）。

所以，这就是为什么**lisp 的非语法**如此**吸引许多习惯于扩展语言**而不是弯曲问题以适应一组预定义工具的人的原因......但这并不意味着语法糖不用于用户给定的构造！

我们使用的用户定义语法的一些示例：

*   [cl-syntax-sugar](http://common-lisp.net/project/cl-syntax-sugar/) - 最显着的扩展是`[]`用于您不想命名闭包变量的小闭包的括号
*   [cl-quasi-quote](http://common-lisp.net/project/cl-quasi-quote/present-class.html) - 最值得注意的是`<xml >`在 lisp 代码中内联 xhtml 生成的语法（请注意，此语法由**用户**库提供，并且可以以上下文相关的方式启用）

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-03-13T18:10:28.500

它可以工作。它叫[迪伦](http://wiki.opendylan.org/wiki/view.dsp?title=Dylan%20Language%20FAQ)。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-03-13T22:19:44.830

即使是 Lisp 语言家族的倡导者[Paul Graham也从他自己的方言](http://www.paulgraham.com/)[Arc](http://www.paulgraham.com/arc.html)中删除了一些括号：

> Lisp 黑客注意事项：如果你习惯了传统的 Lisp `cond`运算符，那么这个 if 相当于同样的事情，但括号更少。例如
> 
> ```
> (cond (a b)
>       (c d)
>       (t e)) 
> ```
> 
> 变成
> 
> ```
> (if a b
>     c d
>     e) 
> ```

（来自[弧教程](http://ycombinator.com/arc/tut.txt)）

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-03-13T18:34:18.333

有两种人™：通过大脑中内置的堆栈机处理信息的人，以及以大块或块形式消费信息的人。这些群体互不相容；他们读不同的书，有不同的写作风格，最重要的是，他们用不同的编程语言编写代码。我属于第二类；但是，我认识第一组的许多程序员。

对于第一类人来说，嵌套从句和从句绝对没有错；他们自然地掌握递归；他们慢慢地看代码，逐句逐句地查看代码，大脑中的堆栈机器不断地在潜意识层面计算大括号和括号。Lisp 语法对他们来说很自然。见鬼，他们可能*发明了*堆栈机器和 Forth 语言。但是给他们看，比如说，Python（哦，不！），他们会无助地瞥一眼代码，无法理解为什么这些愚蠢的代码块是*打开*的，没有匹配的结束语句。

*对于我们第二组的穷人来说，除了将代码语句组合成块*，并在视觉上缩进它们之外别无选择。我们看着充满代码的屏幕，首先注意到大规模的结构，然后是单独的函数或方法，然后是这些方法中的语句组，然后是行和语句，从上到下。我们不能线性思考；我们需要视觉边界和干净的缩进策略。因此，我们不能屈从于使用 Lisp。对我们来说，这是一堆不规则的关键字和愚蠢的括号。

大多数编程语言都兼容这两种思维方式（那些“块”是有原因的）。值得注意的例外是 Lisp 和 Forth，它们只属于第一组，而 Python 只属于第二组。如果你属于第二类，我认为你不需要让 Lisp 适应你的思维方式。如果您仍然需要函数式语言，请尝试 Haskell。它是一种功能性语言，专为以块而不是堆栈思考的人设计。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-13T18:15:21.843

要回答为什么的问题：

据我所知，它的主要用途是可读性，以便查看您的代码的人可以更轻松地破译它。

希望能帮助到你。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-14T00:57:44.467

通过链接阅读，我发现了这个 -[缩进敏感语法](http://srfi.schemers.org/srfi-49/srfi-49.html)- 还有一个 Guile 模块，它实现了这种语法，所以可以直接尝试。

可以在[这里](http://arclanguage.org/)找到一个非常[有前途](http://www.paulgraham.com/arcll1.html)的 Lisp 方言（Arc） 。（我想应该先用一些真实的代码看看感觉如何）

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-03-16T01:34:29.190

我个人对此的看法是：不要使用换行符和缩进作为“隐式”分隔符（我也不喜欢按运算符优先级进行隐式分组，但这是一个不同的主题，尽管相关）。

示例：这是有效的 Python 吗？它是否符合您的预期？

```
if foo < 0 :
    bar
  else :
    baz
quuz 
```

我有一个小建议：我们可以使用预处理器自动缩进 Python 代码，方法是在代码中添加特殊字符，告诉它语句的开始和结束位置。括号怎么样？

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-03-21T18:11:10.673

你可以看看 Clojure。更少的括号，但更多的语法要记住。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-10-23T18:14:18.473

我已经尝试并编写了几个依赖缩进的语法。最好的结果是整个语法改变了它的本质，因此语言已经从一种转向另一种。好的基于缩进的语法不再接近 lisp。

为缩进赋予句法意义的麻烦并不是从白痴和 \t 与空格的辩论中产生的。标记化既不是问题，因为阅读换行符和空格不应该比其他任何事情更难。最困难的事情是确定缩进在它出现的位置应该意味着什么，以及如何在不为语言制作过于复杂的语法的情况下为其添加含义。

当您通过一些巧妙的编程最大限度地减少括号的数量时，我开始考虑原始的 lisp 样式语法毕竟更好。这可以做到，在当前的 lisp 实现中不是那么容易，但在未来的 lisp 实现中可以更容易地做到。当您只需要标记几个规则并且几乎不需要解析时，解析起来既快速又简单。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2012-10-05T11:25:59.853

这个线程很旧，但我决定贡献，因为我创建了一个非常相似的[阅读器系统](http://www.cliki.net/cl-2dsyntax)。

编辑：一些使用示例：

```
!defun 事实 (n)
  if (zerop n)
    1
    * n
      事实
        (1-n)

```

```
!defun 事实 !n
  如果 !zerop n
    1
    !* n !fact !1- n

```

有关更多信息，请查看项目主页。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2014-09-12T07:29:30.967

有一个[备用的 Racket Syntax](http://docs.racket-lang.org/scribble/reader.html?q=at%20syntax&utm_content=buffer67913&utm_medium=social&utm_source=twitter.com&utm_campaign=buffer#(tech._~40._form))。

```
@foo{blah blah blah} 
```

读作

```
(foo "blah blah blah") 
```

# ruby-on-rails - Ruby on Rails 部署要求

> ID：643897
> 
> 赞同：4
> 
> 时间：2009-03-13T18:05:07.623
> 
> 标签：ruby-on-rails, deployment

我已经开始考虑将 RoR 作为开发我的应用程序的一种选择，但我对此知之甚少。我通常将我的应用程序部署到基于 Windows XP 或 Vista 的 PC 上，并使用 SQL Server 作为数据库。

开发 Ruby on Rails 应用程序有哪些系统要求？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-13T18:14:29.240

甚至在一年前，Ruby on Rails 应用程序的部署也非常困难。（我是作为一个热爱 Rails 的人说的。）但是今天，事情变得容易多了。不幸的是，我没有任何在 Windows 服务器上部署 Rails 的经验。但是，我可以告诉您有关在 Linux 上部署的信息。

最简单的设置可能是运行 Apache 和 Phusion Passenger 的 Linux（或 BSD 机器）。Apache 应该默认安装在大多数 Linux 服务器上，Passenger 有一个很好的[命令行安装工具](http://www.modrails.com/install.html)。

对于数据库，我通常使用 MySQL，但如果您执行大量非常复杂的查询，PostgreSQL 可能更合适。同样，MySQL 将安装在大多数 Linux 服务器上。

至于您的实际部署过程，我建议使用[Capistrano](http://www.capify.org/)。这允许您使用单个命令将更新的代码推送到您的服务器，根据需要更新您的数据库，甚至在出现问题时恢复到旧版本的代码。

在 Windows 上部署的好处是您已经了解它。在 Linux 上部署的好处是很多人都熟悉该设置，并且能够帮助您解决最常见的问题。如果您决定在 Windows 上进行部署，我会确保您找到一个很好的支持社区来回答您的问题。（你越偏离典型的 Rails 设置，你需要知道的事情就越多。所以即使你最终没有选择最多的人群，找到一个较小的人群并跟随他们也是有帮助的。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T18:18:55.953

部署到 Windows 肯定是可能的，但工具支持不如 Unix 风格的操作系统好。

Ezra Zygmuntowicz、Bruce Tate 和 Clinton Begin所著的“[部署 Rails 应用程序：逐步指南](http://www.pragprog.com/titles/fr_deploy/deploying-rails-applications)”一书中有一整章是关于 Windows 部署的。另请参阅Brian Hogan 的“ [Windows 服务器上 Rails 的部署策略](http://www.napcs.com/howto/rails/deploy/index.html)”文章。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T20:26:50.920

您可以在您的 PC 上开箱即用地开发 Ruby/Rails 应用程序，无需任何额外的安装工具，除了 PC 上的 Ruby、Rails、Ruby Gems 和 SQLite。您甚至不需要 Web 服务器，因为脚本/服务器将为您完成工作（Ruby 中开发 Web 服务器的实现）。

部署问题比较棘手，但 Rails 在这方面相当成熟，您可以同时选择 Capistrano 和 Phusion。

虽然 Windows 部署是可能的，但如果您计划在 Internet 上托管应用程序，您要么将部署到虚拟化环境（[http://www.morphexchange.com](http://www.morphexchange.com)、[www.herkugarden.com](http://www.herkugarden.com)、[www.heroku.com](http://www.heroku.com)，等）或者您将处理基于 Linux 的虚拟主机或基于 Linux 的共享主机。如果您使用 Capistrano 或 Phusion，开发环境实际上与您的部署环境集成。

实际上，我在基于 *NIX 的系统上拥有最稳定的开发环境。有时我会遇到取决于平台的 gem 行为不端的问题。由于我的大部分工作都部署到 Internet，因此我的开发环境尽可能接近我的部署环境更有意义。

如果您的意图是坚持使用 Windows，那么使用相同的平台进行部署和开发会更好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-03-20T17:10:40.877

我坚持让这一切在 Windows 上正常工作。也许我会节省一些时间。

我使用此处的说明安装了 rails ok - [http://rubyonrails.org/download](http://rubyonrails.org/download)

但是我在这些说明中有一个问题：然后我在命令行中运行 gem install rails 来安装 Rails。它似乎安装了一切。它说“找不到文件'lib'”几次。我不确定这是否有问题。然后我运行 rails new path/to/your/new/application

它在该目录中创建了很多东西，但最后有一个问题：

```
Gem: InstallError: The 'json' native gem requires installed build tools.
Please update your PATH to include build tools or download the DevKit from 'http://rubyinstaller.org/downloads' and follow the instructions at 'http://github.com/oneclick/rubyinstaller/wiki/Development-Kit' 
An error occurred while installing json (1.6.5), and Bundler cannot continue. Make sure that 'gem install json -v '1.6.5'' succeeds before bundling. 
```

我去了这两个网站，想知道下一步该做什么。我下载了开发工具包并开始安装它。

这些指示似乎奏效了。在我这样做之后，我再次尝试 rails new path/to/your/new/application 并且它没有错误地完成。然后 cd C:\www-app 和 rails server 它在[http://localhost:3000/](http://localhost:3000/)正确出现。伟大的。

所以我想要一个真正的 Web 服务器，我可以用 Windows 启动。Windows 不支持乘客。在我尝试之前，这并不明显。所以我决定尝试 Apache 并通过它使用 Mongrel。这些说明看起来不错 - [http://weblog.rubyonrails.org/2006/5/11/deploying-rails-on-windows-servers/](http://weblog.rubyonrails.org/2006/5/11/deploying-rails-on-windows-servers/)

我以前安装过 Apache，没什么大不了的。然后，我浏览了 RailsWithApacheAndMongrel.pdf 以使其通过 Apache 运行并遇到了无数问题。那个文件已经过时了。我不得不对命令进行许多更改，但我确实让 WEBrick 通过 Apache 为演示 Ruby 应用程序提供服务。当谈到反向代理时，我了解到他们推荐的 Ruby 插件不支持 Rails 3。

然后我在尝试运行 Mongrel 时遇到错误，“因为您的计算机中缺少 msvcrt-ruby18.dll”，即使我安装了 -include-dependencies。用不了Mongrel，最后放弃了。

我真的很努力。“只需运行这个命令”就是所有指令所说的，而且从来没有那么容易。如果有人在 Windows 上找到一个不错的 RoR 指南，请告诉我！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-22T05:22:21.333

关于部署，我推荐 Heroku。我过去和他们一起工作过，我对他们有很多好话要说。易于上手，并且可以免费开发。

如果要进行设置，请查看立即开始编程一书的[部署部分。](http://www.startprogrammingnowbook.com/book/deployment)

# php - 静态方法中使用的模拟方法

> ID：643898
> 
> 赞同：3
> 
> 时间：2009-03-13T18:05:29.620
> 
> 标签：php, unit-testing, phpunit

我试图阻止发送电子邮件的方法实际发送电子邮件，并且我认为模拟对象（或某些变体）是可行的方法。情况如下：

```
class UserModel {

    public static function resetPassword()
    {
      // Code to generate new password, etc, etc

      self::_sendMail($to, $body);
      return 1;
    }

    private function _sendMail($to, $body)
    {
      // Send email
    }
} 
```

PHPUnit 中是否有我可以模拟 _sendMail() 并注入我自己的代码，以便我可以正确测试 resetPassword() 中的其他逻辑？

我的测试看起来像：

```
$this->assertTrue(UserModel::resetPassword()); 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T18:52:04.530

我想这就是你的做法

```
class MockUserModel extends UserModel
{
    static function _sendMail( $to, $body )
    {
        // do nothing
    }
} 
```

然后

```
$this->assertTrue( MockUserModel::resetPassword() ); 
```

但我不是单元测试专家，所以如果这让你陷入困境，我深表歉意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T10:45:30.260

您可以重构原始代码。它变得更加清晰和可测试。

```
class UserModel
{
    public static function resetPasswordAndSendMail()
    {
      if (!self::resetPassword()) {
        return false;
      }
      self::_sendMail($to, $body);
      return true;
    }

    public static function resetPassword()
    {
      // Code to generate new password, etc, etc
      return true;
    }

    private static function _sendMail($to, $body)
    {
      // Send email
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-11-29T23:05:24.960

[您可能会发现在这里使用适配器模式](http://en.wikipedia.org/wiki/Adapter_pattern)很有用。有关类似场景和其他一些可能的解决方案，请参阅[PHPUnit 中的模拟/存根 FTP 操作。](https://stackoverflow.com/q/8318133/212218)

# vb.net - Linq：IsNot 在对象集合中

> ID：643899
> 
> 赞同：0
> 
> 时间：2009-03-13T18:06:00.133
> 
> 标签：vb.net, linq

```
Dim goodCustObjList As New List(Of CustomerObj)
goodCustObjList = DataBLLModule.GetCustomerRecordList(String.Empty)
Dim custList = From t In goodCustObjList _ 
               Where t.ID.ToString() IsNot Guid.Empty.ToString() _
               Select t 
```

我有一个 CustomerObj 列表，如果 ID (GUID) 不为空，那么我想选择该对象。我做了一个类似的查询，但条件是另一个对象的属性（整数），如果它是 1 或 2 则匹配，然后选择它。

有人可以指出我在上面的 linq 语句中做错了什么吗？如果您要在 linq 中测试条件。IsNot 不是测试该条件的正确语句吗？

杰克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T18:15:16.227

VB中的“IsNot”表示测试两个对象引用是否指向不同的对象。我不确定为什么你会为这种特定的语法得到这个。你能发布CustomerObj的定义吗？

不过，您真正想做的是直接比较 .ID 属性。

```
Where t.Id <> Guid.Empty 
```

这是比较 GUID 值的最可靠方法。比较它们的 String 值要慢得多，如果您不小心进行了区分大小写的比较，可能会被丢弃。

# qt - Qt 或 WxWidgets 中的自动隐藏面板

> ID：643905
> 
> 赞同：1
> 
> 时间：2009-03-13T18:08:30.393
> 
> 标签：qt, wxwidgets, hide, dock

我正在寻找一种方法来拥有一个类似于 Visual Studio 中的面板的停靠面板。

本质上是一个可以设置为自动隐藏或可以固定打开的面板。

可能这个问题有点含糊。我要找的基本上是[这个产品](http://www.codejock.com/products/dockingpane/tour_43.asp)

如果我缺少详细信息，请发表评论，因为我希望解决这个问题。我已经在谷歌上进行了相当多的搜索，但未能找到可能的解决方案。如果情况变得更糟，我最终将使用快捷方式来隐藏和取消隐藏侧面板。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-17T06:58:53.847

查看 wxWidgets 中的 AUI 演示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-17T07:02:52.480

Qt 有[QDockWidget](http://doc.qt.io/qt-5/qdockwidget.html)，也许这就是你要找的？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-22T19:30:38.193

遗憾的是，Qt 不支持这一点。我已经窃听了他们和其他人，但没有得到任何消息。我正在写我自己的东西来做这件事。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-02T18:56:26.570

目前，有一个针对 Qt 的 Visual Studio 对接实现。它实现了常规 MFC 对接中存在的所有功能 - 自动隐藏面板、栏、浮动窗口和贴纸。如果任务对您来说仍然是实际的，您可以尝试在此处下载示例 - [http://www.devmachines.com/qtitandocking-overview.html](http://www.devmachines.com/qtitandocking-overview.html)

# java - Java Void 引用类型的用途？

> ID：643906
> 
> 赞同：169
> 
> 时间：2009-03-13T18:08:43.480
> 
> 标签：java, void

有一个`Void`Java——大写 V——[引用类型](https://docs.oracle.com/javase/9/docs/api/java/lang/Void.html)。我见过它使用的唯一情况是参数化`Callable`s

```
final Callable<Void> callable = new Callable<Void>() {
            public Void call() {
                foobar();
                return null;
            }
        }; 
```

`Void`Java引用类型还有其他用途吗？它可以被分配除 之外的任何东西`null`吗？如果有，你有例子吗？

* * *

## 回答 #1

> 赞同：123
> 
> 时间：2009-03-13T18:35:02.450

`Void`已成为您不感兴趣的通用参数的约定。没有理由应该使用任何其他不可实例化的类型，例如`System`.

它也经常用于例如`Map`值（尽管`Collections.newSetFromMap`用作`Boolean`映射不必接受`null`值）和`java.security.PrivilegedAction`.

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2009-03-13T21:43:34.120

您可以使用反射创建 Void 实例，但它们对任何事情都没有用。Void 是一种表示泛型方法不返回任何内容的方式。

```
Constructor<Void> constructor = Void.class.getDeclaredConstructor();
constructor.setAccessible(true);
Void v = constructor.newInstance();
System.out.println("I have a " + v); 
```

打印类似的东西

```
I have a java.lang.Void@75636731 
```

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2009-03-13T18:11:48.840

[`Future<Void>`](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/Future.html)像魅力一样工作。:)

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2009-03-13T18:12:00.447

鉴于[没有公共构造函数](http://java.sun.com/javase/6/docs/api/java/lang/Void.html)，我会说它不能被分配除`null`. 如您的示例所示，我仅将其用作“我不需要使用此通用参数”的占位符。

它也可以用于反射，从它的[Javadoc](http://java.sun.com/javase/6/docs/api/java/lang/Void.html)说：

> Void 类是一个不可实例化的占位符类，用于保存对表示 Java 关键字 void 的 Class 对象的引用。

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2009-03-13T22:20:35.187

所有原始包装类（`Integer`、`Byte`、`Boolean`、`Double`等）都包含对静态字段中相应原始类的引用`TYPE`，例如：

```
Integer.TYPE == int.class
Byte.TYPE == byte.class
Boolean.TYPE == boolean.class
Double.TYPE == double.class 
```

`Void`最初被创建为在某个地方放置对`void`类型的引用：

```
Void.TYPE == void.class 
```

但是，使用`Void.TYPE`. 当您使用`void.class`它时，您会更清楚地知道您正在使用该`void`类型进行操作。

顺便说一句，我上次尝试时，[BeanShell](http://www.beanshell.org/)无法识别`void.class`，所以你必须在`Void.TYPE`那里使用。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2013-12-12T10:29:06.877

当您使用[访问者模式](http://en.wikipedia.org/wiki/Visitor_pattern)时，当您想确保返回值为 null 时，使用 Void 而不是 Object 会更简洁

例子

```
public interface LeavesVisitor<OUT>
{
   OUT visit(Leaf1 leaf);

   OUT visit(Leaf2 leaf);
} 
```

当您将实现您的访问者时，您可以明确地将 OUT 设置为 Void 以便您知道您的访问者将始终返回 null，而不是使用 Object

```
public class MyVoidVisitor implements LeavesVisitor<Void>
{
    Void visit(Leaf1 leaf){
        //...do what you want on your leaf
        return null;
    }

    Void visit(Leaf2 leaf){
        //...do what you want on your leaf
        return null;
    }
} 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-03-14T21:41:22.443

在泛型之前，它是为反射 API 创建的，用于保存由 Method.getReturnType() 返回的 TYPE，用于 void 方法，对应于其他原始类型类。

编辑：来自 Void 的 JavaDoc：“Void 类是一个不可实例化的占位符类，用于保存对表示 Java 关键字 void 的 Class 对象的引用”。在泛型之前，我知道除了反射之外没有其他用途。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2015-01-07T19:34:08.307

由于你不能实例化 Void，你可以使用[Apache commons Null object](https://commons.apache.org/proper/commons-lang/javadocs/api-2.6/org/apache/commons/lang/ObjectUtils.Null.html)，所以

```
Null aNullObject = ObjectUtils.Null;
Null noObjectHere = null; 
```

在第一行，你有一个对象，所以`aNullObject != null`成立，而在第二行没有引用，所以`noObjectHere == null`成立

为了回答发帖人的原始问题，其用法是区分“无”和“无”，它们是完全不同的事物。

PS：对空对象模式说不

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-04-21T07:30:08.550

`Void`被创建来包装它的原始`void`类型。每个原始类型都有其对应的引用类型。`Void`用于实例化泛型类或使用泛型方法，您不感兴趣的泛型参数。这是一个示例...

```
public void onNewRegistration() {
    newRegistrationService.createNewUser(view.getUsername(), view.getPassword(),
            view.getInitialAmount(), view.getCurrency(), new AsyncCallback<Void>() {
      @Override
      public void onFailure(Throwable caught) {

      }

      @Override
      public void onSuccess(Void result) {
        eventBus.fireEvent(new NewRegistrationSuccessEvent());
      }
    });
  } 
```

在这里，如您所见，我不希望服务器提供任何我要求创建新注册的东西，但`public interface AsyncCallback<T> { .... }`它是一个通用接口，所以我提供，`Void`因为泛型不接受原始类型

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-08-10T15:33:42.987

当您不需要对象时，它也常用于 Async-IO 完成回调`Attachment`。在这种情况下，您为 IO 操作指定 null 并实现`CompletionHandler<Integer,Void>`.

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-12-13T08:09:38.997

这可能很少见，但有一次，我`Void`在方面类中使用过。

这是一个在具有`@Log`注释的方法之后运行的方面，如果方法返回类型不是 void，则记录返回的方法和一些信息。

```
 @AfterReturning(value = "@annotation(log)", 
       returning = "returnValue", 
       argNames = "joinPoint, log, returnValue"
      )
    public void afterReturning(final JoinPoint joinPoint, final Log log,
            final Object returnValue) {

            Class<?> returnType = ((MethodSignature) joinPoint.getSignature())
            .getReturnType();
           if (Void.class.isAssignableFrom (returnType)) ) {
            //Do some log
         }
} 
```

# php - Magento Themeing

> ID：643917
> 
> 赞同：0
> 
> 时间：2009-03-13T18:10:38.250
> 
> 标签：php, magento, e-commerce

I've read through all the docs on the Magento E-Commerce website, but I'm still fighting with Magento to get my theme looking just right. I have the basic understanding of the XML file layout files, but all the template code is frustrating me. Can someone explain the basic tags and maybe give a reference or two on where I can learn more?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-17T18:27:08.063

与 Justin Lawrence 所说的类似，我建议您查看[Firebug Firefox 插件](http://getfirebug.com/)。

这个附加组件允许您即时查看和更改 CSS，这样您就可以在不破坏原始样式的情况下查看您对每个元素所做的更改。您还可以使用内置工具来了解页面上每个元素的作用，以及哪些样式专门适用于该元素，包括继承。

我建议阅读[本教程](http://net.tutsplus.com/tutorials/tools-and-tips/how-to-theme-any-cms-using-firebug-with-a-wiki-example/)以使用 Firebug 重新设计 CMS 主题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-17T12:58:50.973

是的，magento 主题绝对是最大的进入障碍，但这里有一些我发现有用的东西：

1.  [magento 备忘单](http://oscommerceguides.com/product_info.php?cPath=21&products_id=149)
2.  Firefox 以及[CSS Viewer](https://addons.mozilla.org/en-US/firefox/addon/2104)或[Web-developer](https://addons.mozilla.org/en-US/firefox/addon/60)附加组件。这允许您只需指向任何元素并获取 CSS。
3.  [magento 截屏视频](http://www.magentocommerce.com/media/screencasts/)

伙计，我希望他们能在 Magento 这边工作。这实际上都是有道理的，一旦你掌握了它的窍门，它就非常聪明，因为系统被设计成易于升级，尽管有定制。也许一个向导可能会作为一个开始。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-10T06:38:06.607

您可以通过以下方式打开模板和块提示： `Configuration -> Developer`，从“当前配置范围”中选择“主网站”。然后打开“模板路径提示”和“将块添加到提示”

不要在生产中这样做。

这将在每个框周围添加一个提示，指向该块正在使用哪个模板文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T19:37:29.460

不幸的是，magento 遭受了糟糕的文档和过时的 wiki 的困扰。

恐怕查找有关此主题的任何信息的最佳地点是 magento 论坛社区。

另外，我建议使用他们的空白主题。它更容易修改，因为它是非常“清晰”的设计。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-11-12T15:38:22.123

另一个捷径是购买一个库存的 Magento 模板，看看他们是如何完成覆盖、布局文件等的。

另一个很好的技巧是使用 local.xml 布局进行调查 - 它是一种将各种布局更新集中到一个文件中的方法，而不是让它们分布在目录、客户等所有各种布局中。

有关 local.xml 的教程，请参阅[classylama](http://classyllama.com/magento-development/)

# asp.net - Asp.Net ListBox 和 JQuery

> ID：643921
> 
> 赞同：1
> 
> 时间：2009-03-13T18:12:11.243
> 
> 标签：asp.net, jquery, listbox

我们有一个页面，其中包含一个禁用的 ListBox（在代码隐藏中）。这个 ListBox 可以通过选中页面上的复选框来启用；它通过使用 JQuery 的 javascript 重新启用。

所以，问题是当控件第一次被禁用然后在页面上重新启用时，即使选中了一个，它也没有选中的项目。

如果 ListBox 从未在代码隐藏中禁用，则相同的代码可以正常工作。

有没有办法使用 JQuery 重新启用 ListBox，以便将所选值发布到服务器？

* * *

这是一个使用 VS 2005 且没有 .NET MVC 的 .net 2.0 项目

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T18:24:24.987

您将需要提出一个解决方案，其中 ListBox 始终在服务器端启用且可见。所以只有 jQuery 的解决方案来禁用`select`. 我会添加一个隐藏字段，让它存储一个是否`select`应该启用的开关。这将允许您的 jQuery 代码向服务器报告在回发时控件是否启用。

您显然必须编写 jQuery 代码来绑定隐藏字段并选择在一起并管理禁用/启用状态。

**编辑：** 现在我想起来了。您可以从`Request.Form`集合中获取 select 的值并将该值分配给您的`ListBox`during `Page_Init`。你会失去任何`ListBox.*Changed`事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T18:38:54.517

解决此问题的方法可能是通过 Request.Form[listbox.ClientID] 获取回发值。它不像使用 ViewState 那样“好”，但它应该可以工作。

# javascript - 如何使用 jQuery 按类选择元素？

> ID：643922
> 
> 赞同：0
> 
> 时间：2009-03-13T18:12:15.970
> 
> 标签：javascript, jquery

我有一个班级的 div`example`

在 JavaScript 中，我有：

```
var selectWithThis = 'example' 
```

使用这个变量我将如何编写一个`$()`选择器来选择这个 div？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T18:18:15.923

```
var elements = $('.' + selectWithThis); 
```

请注意，它返回具有相同类的所有元素的数组。如果只有一个元素，仍然是一个只有一个元素的数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T18:16:24.663

$('.' + selectWithThis);

使用存储在变量中的类/字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T18:34:55.243

如果您确定只有一个 DIV 或只关心第一个，请按照 Chetan 指出的那样做，但使用索引器或更好的选择器：

获取第一个元素（返回一个 DOM 对象）：

```
var element = $('.' + selectWithThis)[0] 
```

获取第一个元素（返回一个 jQuery 对象）：

```
var element = $('.' + selectWithThis).eq(0) 
```

获取第一个元素（返回一个 jQuery 对象）：

```
var element = $('.' + selectWithThis + ':first') 
```

要进一步获取底层 DOM 对象，您始终可以将 [0] 附加到查询中。

# c# - 如何根据整数字段获取 List<> 中的项目？

> ID：643923
> 
> 赞同：1
> 
> 时间：2009-03-13T18:12:26.263
> 
> 标签：c#, generics, list

我的程序中有一个 List<> ，里面装满了我的自定义类。我希望能够通过简单地指定一个整数来从列表中提取一个对象，然后返回所有将整数属性设置为该整数的对象。我正在考虑这样做：

```
int exampleint = 5;
List<MyClass> extract = new List<MyClass>();
for(int i = 0; i < list.Length; i++) {
    if(list[i].Number == exampleint)
        extract.Add(list[i]);
}
return extract; 
```

有没有更好或更快的方法来做到这一点？就是想。

更新：克里斯，你的回答有点不对劲。这：

```
 List<MyClass> extract = list.FindAll(delegate(int obj) { return obj.Number == exampleint; }); 
```

实际上应该是这样的：

```
List<MyClass> extract = list.FindAll(new Predicate<MyClass>(delegate(MyClass obj) { return obj.Number == exampleint; })); 
```

你的第一个例子给了我错误。但是感谢您为我指明了正确的方向，它现在似乎有效。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-13T18:16:35.553

```
List<MyClass> extract = list.FindAll(obj => obj.Number == exampleint); 
```

或（如果您使用的是 .NET 2.0 并且不能使用表达式）

```
List<MyClass> extract = list.FindAll(delegate(MyClass obj) { return obj.Number == exampleint; }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T18:21:31.673

如果你只有 C#2，试试这个：

```
public delegate bool Predicate<T>(T item);

public static IEnumerable<T> Where(IEnumerable<T> source, Predicate pred)
{
    foreach (T item in source)
    {
        if (pred(item))
            yield return item;
    }
} 
```

每当您有这种过滤要求时，您都可以重用它，如下所示：

```
IEnumerable<MyClass> filtered = Where(list, delegate(MyClass c) { return c.Number == exampleint; }); 
```

它本质上与 Linq 解决方案相同，它将使您能够在升级编译器时适应这种类型的列表处理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T18:16:05.210

如果您使用的是 C# 3：

```
`return (from e in list
        where e.Number == exampleint
        select e).ToList();` 
```

`这将运行一个 LINQ 查询，将它们拉出，然后转换为列表。如果可以改为返回 IEnumerable，则可以避免 ToList() 调用。`

 `* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T18:16:14.710

使用 Linq/扩展方法：

```
var result = list.Where(x => x.PropertyValue == YourSelectedValue); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T18:16:19.017

如果你可以使用 Linq：

列表提取 = existingList.Where(x => x.Number == exampleInt).ToList();

# asp.net - Session Best Practices

> ID：643925
> 
> 赞同：4
> 
> 时间：2009-03-13T18:12:46.997
> 
> 标签：asp.net, session-variables

Hi I use Sessions in my application and I was wondering what is the best practice for maintaining session value on a page. I need the value that is stored in the session to be saved until the post back on a particular page. Let me illustrate:

```
Page A:                             Page B:
Sets Session["ID"] = 5       -->    Gets Session["ID"]
And redirects to Page B             and populates data. 
```

I need the `Session["ID"]` on Page B to stay alive until a post back is performed on Page B. I need this because I will be using the value of `Session["ID"]` update data in the database.

My question is: Is the any guarantee that the `Session["ID"]` will maintain its value until a post back is performed? Won't it die? If so: What are some methods I can take to make sure it maintains its value?

I was thinking of making a private variable in Page B to store the `Session["ID"]` on Page_Load. Please let me know what you think, thank you.

I'm sorry, I should have said: I cannot allow the user to modify the `ID`. So no `Query Strings`, thanks.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T19:22:20.340

会话默认存储在服务器的内存中。如果用户的会话超时，这可能会出现问题。此外，如果您将多个服务器用作场，则不能在内存中使用 Session，因为您不能保证用户每次都会使用相同的服务器。

保证会话信息不会丢失的最好方法是将用户的会话持久化到 SqlServer 数据库。[这是有关如何设置它的教程。](http://faqfront.com/document/sql-server-session-state)

Session 并不像一些海报所暗示的那样是性能杀手。这是一种非常有用的方法，可以轻松维护每个用户的状态。

另请参阅我对[这个问题](https://stackoverflow.com/questions/620134/pass-values-or-data-from-one-page-to-another-when-you-use-login-control-in-asp-ne)的回答，了解包装 ASP.NET 会话对象的好方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T19:55:21.947

由于您使用的是 asp.net，并且您希望将数据从一个页面传输到另一个页面，您还可以使用 CrossPage 回发

来自 msdn 的跨页回发：

> 在某些情况下，您可能希望将一个页面发布到另一页面。例如，您可能正在创建一个多页表单，该表单在每个页面上收集不同的信息。在这种情况下，您可以将页面上的某些控件（实现 IButtonControl 接口的控件，例如 Button 控件）配置为发布到不同的目标页面。这称为跨页发布。与使用 Transfer 方法重定向到另一个页面相比，跨页面发布提供了一些优势。有关详细信息，请参阅将用户重定向到另一个页面。

```
if (Page.PreviousPage != null)
{
    TextBox SourceTextBox = 
        (TextBox)Page.PreviousPage.FindControl("TextBox1");
    if (SourceTextBox != null)
    {
        Label1.Text = SourceTextBox.Text;
    }
} 
```

来源：http: [//msdn.microsoft.com/en-us/library/ms178139.aspx](http://msdn.microsoft.com/en-us/library/ms178139.aspx)

这是我们在一些项目中使用的方法，并且效果很好。我不知道它是否适合您的需求，但可能值得一看。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T18:17:00.450

Instead of using session you could transfer the variable from page to page either through the querystring or though a hidden post field, that way it would live with the client and not timeout like it would if it was in the session.

EDIT: If you don't want the user to tamper with the value you could encrypt/obfuscate the hidden post field.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T18:18:38.620

Session variables stay alive until the session times out (timeout period being specified in your web.config file)

You need to remember persisting data in the session takes up resources on the server so you need to be careful.

In asp.net you can use the viewstate to persist data across postbacks on the same page.

For your question I would recommend using the URL query string parameters to pass the ID between pages

i.e. myurl.aspx?ID=5

then in your aspx code do:

```
int ID = (int)page.request.params["ID"]; 
```

**Edit:**

If you are concerned with users altering the ID parameter you can put business logic in the pageload of page B to ensure the user has the proper rights to alter that ID value.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T18:19:04.500

If the session timed out, your value would of course be lost. You could store it in a variable in page load - that should work.

The real thing I'm wondering is why don't you just pass it as a GET parameter when you redirect from Page A to Page B? You might have a perfectly valid reason, but normally if I wanted to pass data from one page to another, that's how I would do it.

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2015-03-11T19:23:21.210

如果我们有一个不需要会话超时的页面，那么按照

来源：[https](https://msdn.microsoft.com/en-us/magazine/cc163730.aspx) ://msdn.microsoft.com/en-us/magazine/cc163730.aspx ，

我们可以使用 <%@Page EnableSessionState="False" %>

该链接还讨论了各种最佳实践。

# wpf - DataBinding in a List View

> ID：643928
> 
> 赞同：0
> 
> 时间：2009-03-13T18:13:34.187
> 
> 标签：wpf, data-binding, xaml, objectdataprovider

Am new to XAML/WPF and have come across this weird issue:

I have a list view to which I set a DataSource. The DataSource is an arraylist of "CatalogPartRows". I create my columns in the code. I then set their cell templates (some of my columns contain combo boxes and check boxes). My problem here is that I need to call a function in the "CatalogPartRow" class which fetches the string that I need to set in a cell.

Here is the code I am trying to use:

```
 // THIS DOES NOT WORK
            //
            ObjectDataProvider ODP = new ObjectDataProvider();
            ODP.MethodName = "PropertyValueAsString";
            ODP.MethodParameters.Add(PropertyName);
            ODP.ObjectType = typeof(CatalogPartRow);

            Binding DataBindingText = new Binding();
            DataBindingText.Source = ODP;

            // THIS WORKS
            //
            //String BindingPathText = /*NOXLATE*/"PropertyValues[" + CPR.IndexOf(PropertyName) + /*NOXLATE*/"]";
            //Binding DataBindingText = new Binding(BindingPathText);

            FrameworkElementFactory TextBlockElement = new FrameworkElementFactory(typeof(TextBlock));
            TextBlockElement.SetBinding(TextBlock.TextProperty, DataBindingText);

            FrameworkElementFactory PropertyColumnElement = new FrameworkElementFactory(typeof(Grid));
            PropertyColumnElement.AppendChild(TextBlockElement);

            DataTemplate DT = new DataTemplate();
            DT.VisualTree = PropertyColumnElement;

            GVC.CellTemplate = DT; 
```

Is my approach correct?

CPR = CatalogPartRow

GVC = GridViewColumn

Thanks, Raj.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-21T23:38:35.690

由于将方法包装在属性中是行不通的（因为需要参数），所以最好的方法是创建一个值转换器。您可以将`PropertyName`其用作列的绑定，然后在您的转换器中，您可以将其传递给您的方法，并返回该方法的值。

# python - 在 python (django) 中使用带有参数的游标/查询中的“like”

> ID：643930
> 
> 赞同：8
> 
> 时间：2009-03-13T18:14:21.283
> 
> 标签：python, sql, django, sql-like, database-cursor

我知道这可能是愚蠢的，但我决定问任何方式。

我一直在尝试查询类似的内容：

```
 cursor.execute("select col1, col2   \
                    from my_tablem \
                    where afield like '%%s%'
                    and secondfield = %s
                    order by 1 desc " % (var1, var2) ) 
```

但是我在类似的句子中遇到错误。它不喜欢我需要获得包含第一个 %s 值的所有结果的额外 % 。

想法？

蒂亚！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-13T18:32:31.443

首先，您为什么不为此使用 Django ORM？

```
MyClass.objects.filter( aField__contains=var1, secondField__exact=var2 ) 
```

其次，确保你得到了你期望的 SQL。

```
stmt= "select... afield like '%%%s%%' and secondfield = '%s'..." % ( var1, var2 )
print stmt
cursor.execute( stmt ) 
```

第三，您的方法有一个称为 SQL 注入攻击的安全漏洞。你真的不应该像这样做 SQL。

如果您绝对必须在 Django 的 ORM 之外执行操作，则必须在查询中使用绑定变量，而不是字符串替换。请参阅[http://docs.djangoproject.com/en/dev/topics/db/sql/#performing-raw-sql-queries](http://docs.djangoproject.com/en/dev/topics/db/sql/#performing-raw-sql-queries)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-07-03T23:32:09.577

可以将字符串 '%' 破解为搜索字符串吗？

```
var1 = '%' + var1 + '%'

then query normally:

cursor.execute("select col1, col2 
                    from my_tablem                     where afield like %s
                    and secondfield = %s
                    order by 1 desc " , [var1, var2] ) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-01-03T18:15:59.550

我有一个类似的问题。我试图在连接的名称字段中进行搜索。我的查询类似于：

```
sql = """SELECT * from auth_user WHERE lower(first_name) || ' ' || lower(last_name) = '%%%s%%'"""

User.objects.raw(sql, [q]) 
```

问题是 %% 破坏了我的查询。我最终得到的解决方案是：

```
q = '%' + q + '%'
sql = """SELECT * from auth_user WHERE lower(first_name) || ' ' || lower(last_name) = %s"""

User.objects.raw(sql, [q]) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-14T15:42:07.860

```
Persona.objects.raw("**SELECT** id,concat_ws(' ',nombre,apellido) **AS** nombre_completo **FROM** persona **GROUP BY** id **HAVING** concat_ws(' ',nombre,apellido) **ILIKE** '%s' " % ('%%' + query + '%%')) 
```

（PostgreSQL 9.1）

# c# - How can I programmatically change a value in the Window's Registry?

> ID：643947
> 
> 赞同：9
> 
> 时间：2009-03-13T18:16:43.180
> 
> 标签：c#, registry, batch-file

I need to programmatically change the "Level" String found in \HKEY_CURRENT_USER\Software\Intuit\QBWebConnector to "Verbose"

What is the best way to do this? C#, bat file? I have never tinkered with the registry before...

Thanks.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-13T18:50:21.073

如果您要更改的注册表项已经在注册表中，创建 *.reg 文件以根据需要更改注册表项的最简单方法如下：

1.  打开注册表
2.  在左侧树视图中找到要更改的注册表项正上方的注册表文件夹。
3.  右键单击该文件夹并选择“导出”。
4.  使用记事本打开刚刚导出的文件，然后删除除第一行（“Windows 注册表编辑器版本 5.00”或类似内容）、文件夹名称（在您的情况下为 [HKEY_CURRENT_USER\Software\Intuit\QBWebConnector]）和名称值对之外的任何内容对于您要更改的密钥
5.  编辑您想要适当更改的值并保存文件。在您的情况下，您应该得到以下 *.reg 文件：

> Windows 注册表编辑器版本 5.00
> 
> [HKEY_CURRENT_USER\Software\Intuit\QBWebConnector]
> 
> “级别”=“详细”

双击该文件并确认安全警告将在您的注册表上执行更改。

或者，在批处理文件中，您可以通过“REGEDIT /S pathname”静默导入注册表文件

小心注册表，否则您可能会破坏您的 Windows 安装。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-07-22T18:52:47.150

以下是上面未提及的其他一些按容易程度排列的方法：

1.  Reg.exe *add* - 键入`reg /?`以查看选项和[Reg 参考](http://technet.microsoft.com/en-us/library/cc732643.aspx) 以获取详细信息。
2.  Regini.exe [脚本文件] - 比 .reg 文件更强大，您可以删除子项和数据项并设置权限。键入`regini /?`以查看说明或 MSDN 文章[分发注册表更改](http://msdn.microsoft.com/en-us/library/ms954395.aspx)以了解详细信息。
3.  ATL::CRegKey 类，SetStringValue() 成员，请参阅[MSDN](http://msdn.microsoft.com/en-us/library/5eccs806%28v=vs.100%29.aspx)。
4.  .NET 注册表类 SetValue()（C#、C++、F#、VB） - 请参阅[MSDN 参考](http://msdn.microsoft.com/en-us/library/microsoft.win32.registry%28v=vs.110%29.aspx)。
5.  Win32 API，例如 RegSetKeyValue()。请参阅[注册表函数](http://msdn.microsoft.com/en-us/library/windows/desktop/ms724875%28v=vs.85%29.aspx) 参考。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-13T18:24:04.460

Actually, the easiest way to change a bunch of registry keys is to use a [*.reg file](http://support.microsoft.com/kb/310516) and simply load it into the registry. But be careful: You generally can't send these files to people via e-mail, because they get filtered by many mail servers.

We occasionally use this technique to pass around application configurations and test them on other machines.

I only mention this non-programmatic solution because you suggested that either a C# application or a batch file would be OK, which suggests that you're looking for something lightweight and you aren't too worried about the details.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-13T18:33:14.967

从批处理文件中，您可以使用`reg.exe`.

# python - 我如何重写 $x = $hash{blah} || Python中的“默认”？

> ID：643950
> 
> 赞同：3
> 
> 时间：2009-03-13T18:16:50.670
> 
> 标签：python

如何在不触发 KeyError 的情况下从 Python 字典中提取项目？在 Perl 中，我会这样做：

```
$x = $hash{blah} || 'default' 
```

什么是等效的 Python？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-13T18:19:21.787

使用[`get(key, default)`](http://docs.python.org/library/stdtypes.html#dict.get)方法：

```
>>> dict().get("blah", "default")
'default' 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-13T18:26:11.740

如果您要经常这样做，最好使用[collections.defaultdict](http://docs.python.org/library/collections.html#collections.defaultdict)：

```
import collections

# Define a little "factory" function that just builds the default value when called.
def get_default_value():
  return 'default'

# Create a defaultdict, specifying the factory that builds its default value
dict = collections.defaultdict(get_default_value)

# Now we can look up things without checking, and get 'default' if the key is unknown
x = dict['blah'] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T18:19:23.550

```
x = hash['blah'] if 'blah' in hash else 'default' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T18:21:09.753

```
x = hash.has_key('blah') and hash['blah'] or 'default' 
```

# xml - 在 AS3 中使用 E4X 在 XML 节点中创建新属性

> ID：643958
> 
> 赞同：4
> 
> 时间：2009-03-13T18:19:03.410
> 
> 标签：xml, actionscript-3, e4x

有什么办法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-16T16:53:45.657

谢谢回答。

我确实发现您的解释和链接建议很有趣且令人鼓舞。

无论如何，我并没有明确我的问题。我确实想知道的是如何创建*任何*属性，即使不知道它的名称。我确实阅读了几个文档和教程，直到我弄明白了。希望这能有所帮助。

```
var data:XML = <node/>;
var $my_attr:String = 'id';
data.@[$my_attr] = 'foo'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-20T08:39:47.623

要添加属性，您需要编写为

> xmlNode.attributes.@attr = "值";

希望它有效。

谢谢阿米特

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-03-24T17:17:31.947

xmlNode.attributes['attribute'] = '属性值';

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T18:28:00.160

长答案：请阅读文档。它确实非常丰富。整章都专门讨论 XML 和 E4X。[这](http://livedocs.adobe.com/flex/3/html/help.html?content=13_Working_with_XML_03.html)是一个可能对您有帮助的链接。

简短的回答：是的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T21:50:16.133

急切地没有直接告诉你怎么做，我想是出于教育目的。尽管如此，方法如下：

```
var xml:XML = <node/>;
xml.@attr = "value"; 
```

多田！但拜托，RTFM。

# javascript - 如何使用 jQuery 进行后期绑定？

> ID：643965
> 
> 赞同：1
> 
> 时间：2009-03-13T18:20:05.280
> 
> 标签：javascript, jquery

我有一个通过 XHR 引入的表单，我需要能够在其上绑定一个事件以进行提交。我已经下载了 jquery.form.js 插件。执行后期绑定的最佳方法是什么，以便我可以执行以下操作：

```
 $(document).ready(function() { 
        // bind 'myForm' and provide a simple callback function 
        $('#myForm').ajaxForm(function() { 
            alert("Thank you for your comment!"); 
        }); 
    }); 
```

不幸的是，由于在第一次填充 DOM 时表单并不容易获得，所以这不起作用。

** 编辑 **

在通过 XHR 检索到表单之后，我尝试绑定到表单，但运气不佳。这是它的外观：

```
 $.get("foo.php", function(data) { 
    $('#my_form').ajaxForm(function() { 
         alert("Thank you for your comment!"); 
     });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T18:30:20.090

jQuery 1.3 引入了[“Live”事件](http://docs.jquery.com/Events/live#typefn)，它将绑定到选择器定义的任何当前和未来元素。

我没有对它们做任何事情，但是您应该能够执行以下操作似乎是合理的：

```
$(document).ready(function() {
    $('form').live("ready",function() {
        alert("Something");
    });
}); 
```

不确定在这种情况下 ready 事件是否真的有效，但似乎值得一试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T18:31:51.680

我觉得你做的不对。我使用 jquery 表单的方式是这样的：

```
$('#myform').submit(function(){
 $(this).ajaxSubmit(function(){
  alert('Thanks for your comment');
 });
 return false
}); 
```

在将表单注入 DOM 后调用它。另一种方法是使用来自[jquery](http://docs.jquery.com/Events/live#typefn)`live`的绑定

```
$('#myform').live('submit', function(){
 $(this).ajaxSubmit(function(){
  alert('Thanks for your comment');
 });
 return false
}); 
```

无论您选择哪种方式，都必须将这段代码包含在`$(document).ready()`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T18:22:49.437

对 XHR 请求回调执行绑定。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T18:30:23.787

在通过 XHR 加载表单后绑定事件。

# asp.net - RDLC Medium Trust

> ID：643970
> 
> 赞同：1
> 
> 时间：2009-03-13T18:21:21.080
> 
> 标签：asp.net, reporting-services, reporting, medium-trust

Does anyone know of a free (for a non-profit group) RDLC reporting tool that will work under medium trust in IIS 7?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-13T20:25:24.057

我们的[Data Dynamics Reports](http://www.datadynamics.com/Products/DDRPT/)产品不是免费的，但我们确实为在限制性中等信任环境中工作提供了特殊支持。我不知道它是否在 IIS7 上进行了测试，但我认为安全策略是相同的，所以它应该在任何情况下都可以工作。如果它没有让我们知道，我们肯定会让它工作，因为这是我们明确希望确保我们提供一个很好的解决方案的场景。有关更多信息，请参阅以下链接：

*   有关我们何时从数据动态产品经理添加该功能的简要信息：http: [//mrdotnet.wordpress.com/2007/11/18/new-release-of-data-dynamics-reports](http://mrdotnet.wordpress.com/2007/11/18/new-release-of-data-dynamics-reports/) Reports
*   在 ASP.NET 中设置安全性的说明，包括如何配置中等信任：[http ://www.datadynamics.com/Help/ddReports/ddrtskSettingPermissions.html](http://www.datadynamics.com/Help/ddReports/ddrtskSettingPermissions.html)
*   一般产品信息：[http ://www.datadynamics.com/Products/DDRPT](http://www.datadynamics.com/Products/DDRPT/)

此外，您可以随时联系 sales@grapecity.us.com 了解有关非营利组织定价的更多信息。

希望这可以帮助。

斯科特·威勒克

# c++ - How do I call a function only once per value in C++?

> ID：643971
> 
> 赞同：2
> 
> 时间：2009-03-13T18:21:28.350
> 
> 标签：c++

I'm looking for an easy-to-use macro for calling a function only once for a specific value. For example:

```
void foo( Object* obj )
{
   // Print out the name of each object only once
   DO_ONCE( obj, printf("This gets printed only once per object! %s\n",obj->GetName()) );
} 
```

Then

```
Object obj1("obj1Name"),obj2("obj2Name");
foo(&obj1);
foo(&obj1);
foo(&obj2); 
```

Should print out

```
This gets printed only once per object! obj1Name
This gets printed only once per object! obj2Name 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T18:29:27.567

将您的对象放入容器和过滤器/组中，以便每个对象只出现一次。这可以通过使用`set`（或`std::tr1::unordered_set`）作为对象的容器来轻松完成。这有效地使它们独一无二。然后，您可以遍历容器。

或者，正如其他人建议的那样，将函数内部的容器用作记忆设备。但是，总的来说，我认为将结果明确分组可能更合适。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T18:31:40.853

我更喜欢地图

```
void foo( Object* obj ){
    // Print out the name of each object only once 
    static std::map<Object*, size_t> calls;
    if(calls[obj] == 0) {
        std::cout << "This gets printed only once per object! "
                  << obj->GetName();
        calls[obj] = 1;
    }
} 
```

如果您也想计算调用次数，您也可以决定增加计数器。但请注意，它也不是真正的故障安全。如果您删除一个对象，然后再次新建它，并且它恰好获得相同的地址，则假定它已经被打印了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T19:29:59.060

```
#include <set>

...

#define DO_ONCE(type, val, stmt) \
do \
{ \
    type __tmp = (val); \
    static std::set < type > __memo; \
    if (__memo.find(__tmp) == __memo.end()) \
    { \
        __memo.insert(__tmp); \
        do { stmt; } while(0); \
    } \
} \
while(0)

...

DO_ONCE(Object *, obj, printf(...)); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-13T18:33:13.920

```
#include <iostream>
#include <ostream>
#include <set>
#include <string>

class Object
{
public:
    Object( const std::string& name ):
        name_( name )
    {}
    std::string GetName() const
    {
        return name_;
    }
private:
    std::string name_;
};

void print( Object* object )
{
    std::cout << object->GetName() << std::endl;
}

template <typename T, typename TFunction>
void doOnce( T* object, TFunction function )
{
    static std::set<T*> objectsThatWasThere;

    if ( objectsThatWasThere.end() == objectsThatWasThere.find( object ) )
    {
        function( object );
        objectsThatWasThere.insert( object );
    }
}

int main()
{
    Object obj1("Test");
    Object obj2("The");

    doOnce( &obj1, print );
    doOnce( &obj1, print );
    doOnce( &obj1, print );
    doOnce( &obj2, print );
    doOnce( &obj2, print );
    doOnce( &obj2, print );

    return 0;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-13T18:35:03.153

您可能需要记住这些对象。东西链接

```
bool do_once( Object * obj )
{
    static std::set<Object*> memo; 
    if ( memo.count(obj) )
    {
        memo.insert(obj);
        return true;
    }
    return false;
}
#define DO_ONCE(o,a) (do_once(obj) && a) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-08-13T23:19:14.370

概念：

```
template<class t1> void do_once(t1* obj) {
    static std::map<t1*,bool> was_here;
    if (was_here[obj]==false) was_here[obj]=true, throw obj;
}

void ff(int * x)
{
    try {do_once(x); } catch (int* obj) { printf("First time: %d\n",*obj);}
} 
```

# math - Solving the water jug problem

> ID：643975
> 
> 赞同：7
> 
> 时间：2009-03-13T18:21:48.007
> 
> 标签：math, computer-science, theory

While reading through some [lecture notes](http://ocw.mit.edu/NR/rdonlyres/Electrical-Engineering-and-Computer-Science/6-042JFall-2005/E7AB2626-FB19-480E-95F5-A9C23C2BD885/0/ln6.pdf) on preliminary number theory, I came across the solution to water jug problem (**with two jugs)** which is summed as thus:

Using the property of the G.C.D of two numbers that GCD(a,b) is the smallest possible linear combination of a and b, and hence a certain quantity Q is only measurable by the 2 jugs, iff Q is a n*GCD(a,b), since Q=sA + tB, where:

```
n = a positive integer
A = capacity of jug A
B=  capacity of jug B 
```

And, then the method to the solution is discussed

Another model of the solution is to model the various *states* as a state-space search problem as often resorted to in Artificial Intelligence.

My question is: What other known methods exist which models the solution, and how? Google didn't throw up much.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-09-25T11:21:12.670

严格针对 2 壶问题

```
Q = A * x + B * y 
```

Q = 您需要的加仑数。

**注意：** *Q 必须是 Gcd(A,B) 的倍数，否则无解。如果 Gcd(A,B) == 1，则任何 Q 都有解。*

1）**方法1：** [扩展欧几里得算法](http://en.wikipedia.org/wiki/Extended_Euclidean_algorithm)将比任何图算法更快地解决它。

2）**方法2：** 这是一种*幼稚的方法。*（注意，这可以抛出 2 个解决方案，您必须选择哪个更短）

有问题的问题可以简单地通过`repeatedly`从一个桶 A 填充到另一个桶 B （顺序无关紧要）直到它填满你想要的数量......ofcoz，当一个桶装满时，你清空它并继续。

```
 A = 3, B = 4 and Q = 2 
```

反复填充 A->B

```
 A B
   ######
    0 0
    4 0
    1 3
    1 0
    0 1
    4 1
    2 3 <-Solution 
```

让我们试着观察如果我们反过来，填充 B->A 会发生什么

```
A  B
#####
0  0
0  3
3  0
3  3
4  2 <- Solution 
```

在这种情况下，填充 B->A 给我们的目标状态比 A->B 快

**Generic N Jugs** 这是一篇有趣的[论文](http://algo2006.csie.dyu.edu.tw/paper/3/A34.pdf)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-16T18:00:06.827

一个惊人而有趣的方法（对于 3 个水壶）是通过*[重心坐标](http://en.wikipedia.org/wiki/Barycentric_coordinates_(mathematics))*（真的！），正如总是出色的网站 Cut-the-Knot: [Barycentric coordinates: A Curious Application](http://www.cut-the-knot.org/triangle/glasses.shtml)中所描述的那样。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-15T17:03:56.000

这种类型的问题通常适用于[动态规划](http://en.wikipedia.org/wiki/Dynamic_programming)技术。我经常看到这个特定问题被用作运筹学课程中的一个例子。一个很好的分步描述在[这里](http://www.tutor.ms.unimelb.edu.au/pub/pub_dp.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-11T05:36:27.600

搜索空间方法是我所建议的。我编写了一个程序来使用 BFS 解决一般水壶问题。如果你愿意，可以发给你。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-09-17T12:55:22.320

我在一项研究中遇到了这个问题。正如你和 st0le 在这里所说的那样，我发现扩展欧几里德算法作为问题的答案。但是这个答案并不让我满意，因为我认为这是一个定量的答案，而不是一个定性的答案（即算法没有说要采取什么步骤才能达到结果）。

我想我找到了一个不同的解决方案，它总是以最少的步骤达到结果。

这里是：

1.  检查问题的可行性：
    *   Q 是 MCD(A,B) 的倍数；
    *   Q <= max(A,B)。
2.  选择服务水壶（即您将用泵重新装满的水壶）。假设 A > B（你可以很容易地找到哪个水壶更大）：

    ```
    if(Q is multiple of B)
        return B

    a_multiplier = 1
    b_multiplier = 1
    difference = A - B
    a_multiple = A
    b_multiple = B
    while(|difference| differs Q)
        if b_multiple < a_multiple
            b_multiple = b_multiplier + 1
            b_multiple = b_multiplier * B
        else
            a_multiple = a_multiplier + 1
            a_multiple = a_multiplier * A

        difference = a_multiple - b_multiple

    if(difference < 0)
        return B
    else
        return A 
    ```

3.  开始填充过程：

    *   用泵填充服务壶（如果为空）

    *   使用服务之一填充另一个水壶

    *   检查另一个水壶是否装满，以防万一，将其倒空

    *   当较大的水壶包含 Q 时停止

在下面，您会发现该算法在 C++ 中的一个非常幼稚的实现。随意重用它，或根据需要改进它。

```
#include <cstdio>
#include <cstdlib>
#include <cstring>

unsigned int mcd(unsigned int a, unsigned int b) {
    // using the Euclide's algorithm to find MCD(a,b)
    unsigned int a_n = a;
    unsigned int b_n = b;
    while(b_n != 0) {
        unsigned int a_n1 = b_n;
        b_n = a_n % b_n; 
        a_n = a_n1;
    }
    return a_n;
}

unsigned int max(unsigned int a, unsigned int b) {
    return a < b ? b : a;
}

unsigned int min(unsigned int a, unsigned int b) {
    return a > b ? b : a;
}

void getServiceJugIndex(unsigned int capacities[2], unsigned int targetQty, unsigned int &index) {
    unsigned int biggerIndex = capacities[0] < capacities[1] ? 1 : 0;
    unsigned int smallerIndex = 1 - biggerIndex;
    if(targetQty % capacities[smallerIndex] == 0) {
        // targetQty is a multiple of the smaller jug, so it's convenient to use this one
        // as 'service' jug
        index = smallerIndex;
        return;
    }

    unsigned int multiples[2] = {capacities[0], capacities[1]};
    unsigned int multipliers[2] = {1, 1};
    int currentDifference = capacities[0] - capacities[1];
    while(abs(currentDifference) != targetQty) {
        if(multiples[smallerIndex] < multiples[biggerIndex])
            multiples[smallerIndex] = capacities[smallerIndex] * ++multipliers[smallerIndex];
        else
            multiples[biggerIndex] = capacities[biggerIndex] * ++multipliers[biggerIndex];

        currentDifference = multiples[biggerIndex] - multiples[smallerIndex];
    }

    index = currentDifference < 0 ? smallerIndex : biggerIndex;
}

void print_step(const char *message, unsigned int capacities[2], unsigned int fillings[2]) {
    printf("%s\n\n", message);
    for(unsigned int i = max(capacities[0], capacities[1]); i > 0; i--) {
        if(i <= capacities[0]) {
            char filling[9];
            if(i <= fillings[0])
                strcpy(filling, "|=====| ");
            else
                strcpy(filling, "|     | ");
            printf("%s", filling);
        } else {
            printf("        ");
        }
        if(i <= capacities[1]) {
            char filling[8];
            if(i <= fillings[1])
                strcpy(filling, "|=====|");
            else
                strcpy(filling, "|     |");
            printf("%s", filling);
        } else {
            printf("       ");
        }
        printf("\n");
    }
    printf("------- -------\n\n");
}

void twoJugsResolutor(unsigned int capacities[2], unsigned int targetQty) {
    if(capacities[0] == 0 && capacities[1] == 0) {
        printf("ERROR: Both jugs have 0 l capacity.\n");
        return;
    }
    // 1\. check feasibility
    //  1.1\. calculate MCD and verify targetQty is reachable
    unsigned int mcd = ::mcd(capacities[0], capacities[1]);
    if ( targetQty % mcd != 0 ||
    //  1.2\. verify that targetQty is not more than max capacity of the biggest jug
            targetQty > max(capacities[0], capacities[1])) {
        printf("The target quantity is not reachable with the available jugs\n");
        return;
    }
    // 2\. choose 'service' jug
    unsigned int serviceJugIndex;
    getServiceJugIndex(capacities, targetQty, serviceJugIndex);
    unsigned int otherJugIndex = 1 - serviceJugIndex;
    unsigned int finalJugIndex = capacities[0] > capacities[1] ? 0 : 1;
    // 3\. start fill process
    unsigned int currentFilling[2] = {0, 0};
    while(currentFilling[finalJugIndex] != targetQty) {
        // 3.1 fill with the pump the service jug (if needed)
        if(currentFilling[serviceJugIndex] == 0) {
            currentFilling[serviceJugIndex] = capacities[serviceJugIndex];
            print_step("Filling with the pump the service jug", capacities, currentFilling);
        }

        // 3.2 fill the other jug using the service one
        unsigned int thisTimeFill = min(currentFilling[serviceJugIndex], capacities[otherJugIndex] - currentFilling[otherJugIndex]);
        currentFilling[otherJugIndex] += thisTimeFill;
        currentFilling[serviceJugIndex] -= thisTimeFill;
        print_step("Filling the other jug using the service one", capacities, currentFilling);
        // 3.3 check fullness of the other jug and, in case, empty it
        if(currentFilling[otherJugIndex] == capacities[otherJugIndex]) {
            currentFilling[otherJugIndex] = 0;
            print_step("Empty the full jug", capacities, currentFilling);
        }
    }
    printf("Done\n");
}

int main (int argc, char** argv) {
    if(argc < 4)
        return -1;
    unsigned int jugs[] = {atoi(argv[1]), atoi(argv[2])};
    unsigned int qty = atoi(argv[3]);

    twoJugsResolutor(jugs, qty);
} 
```

我不知道我描述的过程背后是否有任何数学概念来选择正确的水壶以最小化所需步骤的数量，我将其用作启发式。

我希望这可以帮助你。

# python - 在 Python 中替换三元运算符的最佳方法是什么？

> ID：643983
> 
> 赞同：12
> 
> 时间：2009-03-13T18:23:06.317
> 
> 标签：python

> **可能重复：**
> [Python 中的三元条件运算符](https://stackoverflow.com/questions/394809/ternary-conditional-operator-in-python)

如果我有一些代码，例如：

```
x = foo ? 1 : 2 
```

我应该如何将它翻译成 Python？我可以这样做吗？

```
if foo:
  x = 1
else:
  x = 2 
```

x 是否仍会在 if / then 块之外的范围内？还是我必须做这样的事情？

```
x = None
if foo:
  x = 1
else:
  x = 2 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-03-13T18:24:58.997

在 Python 2.5+ 中使用三元运算符（正式的[条件表达式）。](http://docs.python.org/reference/expressions.html#boolean-operations)

```
x = 1 if foo else 2 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-13T18:53:59.207

一个不错的 python 技巧是使用这个：

```
foo = ["ifFalse","ifTrue"][booleanCondition] 
```

它创建了一个 2 成员列表，布尔值变为 0（假）或 1（真），这将选择正确的成员。不是很可读，但是 pythony :)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-13T18:49:35.550

[提到](https://stackoverflow.com/questions/643983/whats-the-best-way-to-replace-the-ternary-operator-in-python/644001#644001)的三元运算符仅在 Python 2.5 中可用。来自[WeekeePeedeea](http://en.wikipedia.org/wiki/Ternary_operation)：

> 尽管由于语法上的分歧而推迟了几年，但 Python 的三元运算符被批准为 Python 增强提案 308，并于 2006 年 9 月添加到 2.5 版本中。
> 
> Python 的三元运算符与常见的 ?: 运算符的不同之处在于其操作数的顺序；一般形式是`op1 if condition else op2`. 这种形式要求将 op1 视为正常值，将 op2 视为例外情况。
> 
> 在 2.5 之前，可以使用丑陋的语法`(lambda x:op2,lambda x:op1)[condition]()`，它也只处理实际需要的评估表达式，以防止副作用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-13T18:29:59.467

这个的副本[。](https://stackoverflow.com/questions/394809/python-ternary-operator)

我使用它（尽管如果它不正确，我正在等待有人反对或评论）：

```
x = foo and 1 or 2 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-16T18:34:27.197

我仍在我的一个项目中使用 2.4，并且遇到过几次。我见过的最优雅的解决方案是：

```
x = {True: 1, False: 2}[foo is not None] 
```

我喜欢这个，因为它代表了比使用索引值为 0 和 1 的列表来获取返回值更清晰的布尔测试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-13T18:24:34.940

你可以使用类似的东西：

```
val = float(raw_input("Age: "))
status = ("working","retired")[val>65]
print "You should be",status 
```

虽然它不是很*pythonic*

（其他选项更接近 C/PERL，但这涉及更多元组魔法）

# c# - 基于环境的类数据抽象存储（web/windows）

> ID：643987
> 
> 赞同：0
> 
> 时间：2009-03-13T18:23:57.237
> 
> 标签：c#, .net, factory

我有一个类，其信息的存储将取决于它是否被 Web 或 Windows 应用程序使用。我打算使用工厂模式来传递正确的对象。如果我不想重新创建对象，我猜调用者会适当地存储该对象。有人对基于平台抽象出数据存储有其他建议吗？

例如，我想在 Windows 应用程序调用时将数据存储为局部变量（发送适当的子类），并在 Web 应用程序调用时保存在 Session 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T21:54:15.983

正如 sgreeve 所说，为了获得可维护的代码，需要考虑分离关注点。

使用存储库的想法，Winform 应用程序和 Web 应用程序可以注入它们自己的存储提供程序。如果继承或组合需要，这些提供者可以共享一些通用逻辑。

```
public class MyClassRepository
{
    IStorageProvider _provider;
    public MyClassRepository(IStorageProvider provider)
    {
        _provider = provider;
    }

    public void Save(MyClass o)
    {
        _provider.Save(o);
    }

    public MyClass GetBy(string id)
    {
        return _provider.GetBy(id);
    }
} 
```

Winforms 应用程序将通过以下方式调用存储：

```
var provider = new WindowsStorageProvider();
var rep = new MyClassRepository(provider);
rep.Save(myClassObject); 
```

和网络应用程序：

```
var provider = new WebStorageProvider();
var rep = new MyClassRepository(provider);
rep.Save(myClassObject); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T21:22:14.203

在我看来，工厂模式似乎不是解决您遇到的问题的方法。工厂模式旨在提供类的特定子类型的实例，保护工厂的调用者免受（a）返回的实际子类型和（b）工厂用来决定返回哪个子类型的逻辑。

这不是你在这里需要的。我认为您需要将数据的存储从对存储的数据建模的类中抽象出来。

您有两个应用程序共有的类，每个应用程序都应实现以适合该应用程序的方式存储由您的类封装的数据的功能。这意味着两件事：

1.  每个应用程序（Web 和 Windows 窗体）都应该包含存储数据的功能 - 但两者都不需要包含对方使用的代码。例如，Windows 窗体应用程序不需要知道如何在 Web 会话中存储数据。因此，在 Web 会话中存储数据的代码应该在一个对象中，该对象是 Web 应用程序的一部分，而不是 Windows 窗体应用程序的一部分，反之亦然。

2.  鉴于这种情况，并且您要存储的数据的类必须对两个应用程序都是通用的，因此该存储逻辑不能是该类的一部分。（遵循公认的 OO 设计原则，该类不应该知道如何将自己存储在应用程序的不同部分中，因为这会引入使未来更改变得困难的依赖关系。请参阅[单一责任原则](http://butunclebob.com/ArticleS.UncleBob.PrinciplesOfOod "单一职责原则")......）

希望这会有所帮助

# svn - SVN 分支和“IIS URL 已映射到不同位置”

> ID：643990
> 
> 赞同：3
> 
> 时间：2009-03-13T18:24:06.940
> 
> 标签：svn, iis

我在我的开发电脑和构建盒上维护了几个颠覆开发分支。

你们如何处理在一个分支上打开解决方案并将 IIS 配置到该位置。然后在不同的分支/位置打开相同的解决方案/项目并获得“IIS Url 已经映射到不同的位置”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-15T16:55:44.203

1.  我将 localhost.branch 添加到我的主机文件中
2.  在 IIS 中，我创建了一个映射到主机头 localhost.branch 的新网站。
3.  我在分支中的所有 csproj 文件中搜索并替换`<IISUrl>http://localhost/myapp</IISUrl>`为。`<IISUrl>http://localhost.branch/myapp</IISUrl>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-10T16:48:53.603

简单的方法，从 iis 中的连接中删除文件。返回 Visual Studio 并重新加载文件。再次，它会要求创建一个虚拟目录，按确定。

# php - php文件上传超过200mb

> ID：643991
> 
> 赞同：1
> 
> 时间：2009-03-13T18:24:13.490
> 
> 标签：php, file-upload, reliability

在更改最大文件大小、会话时间和帖子最大大小之后，使用 php 上传大于 200mb 的文件是否明智？可靠的？（这忽略了是否保持客户端连接）

编辑：通过http而不是ftp完成

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T18:42:50.513

没问题。

我们有一个上传/下载网站，以便客户可以发送打印数据。这些文件可能会变得非常大。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T19:16:36.453

我认为主要问题是客户端的浏览器稳定性和客户端的连接。在没有任何意外的情况下传输这么多数据是相当困难的......

# geometry - Algorithm to merge adjacent rectangles into polygon

> ID：643995
> 
> 赞同：16
> 
> 时间：2009-03-13T18:24:34.410
> 
> 标签：geometry, polygon

I guess that my problem is related to "convex hull", but no the same. All shapes in the drawing are rectangles with same width and height. Many are adjacent to each other. I want to combine those adjacent rectangles into polygons. Unlike "convex hull", the resuled polygons could be "hollow" inside.

Is there any open source algorithm available?

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-11T14:28:49.327

作为 HTML5 画布的实验项目的一部分，我不得不编写一个合并相邻多边形的算法（没什么光彩的，一个拼图游戏 :-) 生成的多边形中的孔自然是受支持的。Javascript 例程位于 www dot raymondhill dot net /uzzle-rhill / jigsawpuzzle-rhill-3 dot js 中名为 Polygon.prototype.merge() 的函数中

关键是删除重复但方向相反的段。粗略解释：一个Point是{x:?,y:?}，一个Segment是{ptA:?,ptB:?}，一个Contour是{pts:[]}（连接的Point对象的集合），一个Polygon是{contours:[]}（Contour 对象的集合。）

合并算法将*所有*段收集到一个段对象的大胖池中，其中重复项被消除。首先，将定义多边形 A 的所有轮廓的所有段添加到池中。然后，将定义多边形 B 的所有轮廓的所有段添加到池中，但我们测试并删除重复项（使用 Point 对象作为哈希键很容易完成）。

然后我们从池中取出一个段（随机也可以），我们“走”它直到我们到达一个“死胡同”，即不能再连接更多段。这形成了一个轮廓对象。我们重复直到使用了整个段集合。使用段时，会将它们从池中删除。“走”一个段意味着我们取它的终点，然后我们查找一个起点与它匹配的段。

如前所述，因此我们有一组定义多边形的轮廓对象。有些轮廓将被填充，有些可能是空心的。要确定一个轮廓是填充的还是空心的，只是测试轮廓是顺时针还是逆时针，或者它的面积是正还是负。这是一个约定，在我的情况下，顺时针轮廓是填充的，逆时针是空心的。

这是我的实现，减去细节和错误处理。希望我复制/粘贴的内容足以让您立即使用，否则请参阅上面的 JS 文件以获取上下文：

```
// Point object
function Point(a,b) {
    // a=x,b=y
    if (b) {
        this.x=a;
        this.y=b;
        }
    // a=Point or {x:?,y:?}
    else if (a) {
        this.x=a.x;
        this.y=a.y;
        }
    // empty
    else {
        this.x=this.y=0;
        }
    }
Point.prototype.toHashkey = function() {
    return this.x+"_"+this.y;
    };
Point.prototype.clone = function() {
    return new Point(this);
    };
// Segment object
function Segment(a,b) {
    this.ptA = new Point(a);
    this.ptB = new Point(b);
    }
// Contour object
function Contour(a) {
    this.pts = []; // no points
    if (a) {
        if (a instanceof Array) { // assume array of Point objects
            var nPts = a.length;
            for (var iPt=0; iPt<nPts; iPt++) {
                this.pts.push(a[iPt].clone());
                }
            }
        }
    }
Contour.prototype.clone = function() {
    return new Contour(this);
    };
Contour.prototype.addPoint = function(p) {
    this.pts.push(p);
    };
// Polygon object
function Polygon(a) {
    this.contours = []; // no contour
    if (a) {
        if (a instanceof Polygon) {
            var contours = a.contours;
            var nContours = contours.length;
            for ( var iContour=0; iContour<nContours; iContour++ ) {
                this.contours.push(new Contour(contours[iContour]));
                }
             }
        else if ( a instanceof Array ) {
            this.contours.push(new Contour(a));
            }
        }
    }
Polygon.prototype.merge = function(other) {
    // A Javascript object can be used as an associative array, but
    // they are not real associative array, as there is no way
    // to query the number of entries in the object. For this
    // reason, we maintain an element counter ourself.
    var segments={};
    var contours=this.contours;
    var nContours=contours.length;
    var pts; var nPts;
    var iPtA; var iPtB;
    var idA; var idB;
    for (var iContour=0; iContour<nContours; iContour++) {
        pts = contours[iContour].pts;
        nPts = pts.length;
        iPtA = nPts-1;
        for ( iPtB=0; iPtB<nPts; iPtA=iPtB++ ) {
            idA = pts[iPtA].toHashkey();
            idB = pts[iPtB].toHashkey();
            if (!segments[idA]) {
                segments[idA]={n:0,pts:{}};
                }
            segments[idA].pts[idB] = new Segment(pts[iPtA],pts[iPtB]);
            segments[idA].n++;
            }
        }
    // enumerate segments in other's contours, eliminate duplicate
    contours = other.contours;
    nContours = contours.length;
    for ( iContour=0; iContour<nContours; iContour++ ) {
        pts = contours[iContour].pts;
        nPts = pts.length;
        iPtA=nPts-1;
        for (iPtB=0; iPtB<nPts; iPtA=iPtB++) {
            idA = pts[iPtA].toHashkey();
            idB = pts[iPtB].toHashkey();
            // duplicate (we eliminate same segment in reverse direction)
            if (segments[idB] && segments[idB].pts[idA]) {
                delete segments[idB].pts[idA];
                if (!--segments[idB].n) {
                    delete segments[idB];
                    }
                }
            // not a duplicate
            else {
                if (!segments[idA]) {
                    segments[idA]={n:0,pts:{}};
                    }
                segments[idA].pts[idB] = new Segment(pts[iPtA],pts[iPtB]);
                segments[idA].n++;
                }
            }
        }
    // recreate and store new contours by jumping from one point to the next,
    // using the second point of the segment as hash key for next segment
    this.contours=[]; // regenerate new contours
    var contour;
    for (idA in segments) { // we need this to get a starting point for a new contour
        contour = new Contour();
        this.contours.push(contour);
        for (idB in segments[idA].pts) {break;}
        segment = segments[idA].pts[idB];
        while (segment) {
            contour.addPoint(new Point(segment.ptA));
            // remove from collection since it has now been used
            delete segments[idA].pts[idB];
            if (!--segments[idA].n) {
                delete segments[idA];
                }
            idA = segment.ptB.toHashkey();
            if (segments[idA]) {
                for (idB in segments[idA].pts) {break;} // any end point will do
                segment = segments[idA].pts[idB];
                }
            else {
                segment = null;
                }
            }
        }
    }; 
```

当我们“走”段以创建轮廓时，存在一个段可以连接到多个段的情况：

```
+------+-------+
|   Poly A     | two segments sharing same start point Z
|              | 
+      +---<---Z---->---+
|      |       | Poly B |
|      |       |        |
+      +-------+--------+
|                       |
|                       |
+------+-------+--------+ 
```

这可能导致两个有效结果（上面的算法将随机导致一个或另一个）：

结果 1，一个填充轮廓：

```
+------+--->---+
|   Poly A     |
|              | 
+      +---<---+---->---+
|      |       |        |
|      |       |        |
+      +--->---+        +
|                       |
|                       |
+------+---<---+--------+ 
```

结果 2，一个填充轮廓，一个空心轮廓：

```
+------+--->---+
|   Poly A     |
|              | 
+      +---<---+---->---+
|      | Hole A|        |
|      |       |        |
+      +--->---+        +
|                       |
|                       |
+------+---<---+--------+ 
```

但这应该不是问题，因为您的代码应该已经准备好处理漏洞。

其他重要细节：上面的算法并没有去掉中间点（'+'），实际上它们是预期的，否则算法将无法工作，如下例所示：

```
+------>-------+
|   Poly A     |
|              | 
|              | +---->---+
|              | | Poly B |
|              | |        |
|              | +----<---+
|              |
|              |
+------<-------+ 
```

我的理解是，这就是你所拥有的。我想可以通过预先查找和添加相交点来扩展算法以支持这种情况（在我的情况下这是不必要的）：

```
+------>-------+
|   Poly A     |
|              | 
|              + +---->---+
|              | | Poly B |
|              | |        |
|              + +----<---+
|              |
|              |
+------<-------+ 
```

希望这有帮助。

PS：您可以使用拼图“测试”算法，通过将碎片拼在一起生成孔等：[http ://www.raymondhill.net/puzzle-rhill/puzzle-rhill.php?puzzlePieces=16&puzzleComplexity=1&puzzleURL =http://www.public-domain-photos.com/free-stock-photos-4/travel/los-angeles/los-angeles-skyline.jpg&puzzleRotate=0&puzzleVersion=3](http://www.raymondhill.net/puzzle-rhill/puzzle-rhill.php?puzzlePieces=16&puzzleComplexity=1&puzzleURL=http://www.public-domain-photos.com/free-stock-photos-4/travel/los-angeles/los-angeles-skyline.jpg&puzzleRotate=0&puzzleVersion=3)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-13T18:32:32.863

我会研究像[General Polygon Clipper](http://www.cs.man.ac.uk/~toby/alan/software//)这样的东西。你基本上是在做联合（OR）多边形操作。它们都是矩形的事实只是让数学变得更容易一些，但它可以很容易地用 GPC 之类的东西来完成。

那里也有许多语言的语言包装器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T18:56:25.520

如果您使用的是空间处理库（如 JTS [java]、NTS [.net] 或 GEOS [c++]，它们都是开源且可用于商业应用程序，与 GPC 不同），您只需合并矩形即可。

执行此操作的通用方法是构建输入（矩形）的边缘图，执行交集，将边缘标记为结果的内部或外部，并仅保留外部边缘。我不知道处理矩形的特定算法，但它可能是相似的，除非如前所述，数学会更简单。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-14T02:11:55.597

如果您的界限合理，请使用 2D 边数数组，否则您必须使用嵌套字典。

因为所有的宽度和高度都相同，您可以通过 x、y 和方向（垂直或水平）的组合来唯一标识一条边

示例伪代码：list_of_edges = new list arr_count = new int[][][]

```
fill_with_zeroes(arr_count )

foreach rect
   foreach edge
      arr_count [edge.x][edge.y][edge.orientation] += 1

foreach edge in arr_count
   if count[edge] = 1
      list_of_edges.add(edge] 
```

当然，如果你想订购边缘，那么你必须再次通过数组

```
foreach edge in arr_count
    if count[edge] = 1
        add_recursive(edge)

add_recursive(x,y):
    for both horizontal and vertical orientations of edge starting at x, y:
    count[edge] = 0
    if (edge.orientation is horizontal)
        return add_recursive( x+1, y)
    else 
        return add_recursive( x, y+1 ) 
```

对不起，这个伪代码很草率，但你应该明白大体的想法

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-06-06T08:21:58.223

How about trying the following. I think this will work if designed properly.

1.  Find the smallest emclosing rectangle, basically max-x, min-x and max-y and min-y. This will be our canvas for drawing. Initialise a 2D array of bits dx X dy where dx, dy are width of this outer rectangle, to all 0s.

2.  Our objective is to find the contour, basically some corners of the rectangles so we can scale down this problem to a level where we can handle it computationally, once we have the points we can scale up to get the actual coordinates.

3.  Scan through the above 2D array and mark a point 1 if it is contained in one of the given rectangle.

4.  Now scan the 2D array and look for points whose neighbourhood has a 3:1 split, that means on 3 sides it has 1s and on one side 0s or vice versa. These points are those that will define the contour.

I think the complexity will be managiable if we can scale down the problem wisely.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-05-15T06:59:53.003

我之前也遇到过类似的问题。我不知道你的点是如何对齐的，但我的点总是彼此间隔 5 米。

我的解决方案是按 x 坐标排序。

有两个列表，一个称为先前列表，一个称为当前列表。

如果当前为空，则将该点添加到当前。如果 current 不为空，则检查该点是否与 current 中的一个点相邻（向后运行列表，因为最近的点相邻的可能性更高）

如果该点与 current 中的任何点都不相邻，则检查 current 中的任何点是否与先前列表中的任何点相邻。如果是，则合并（连接）它们，如果不是，则将点从先前的移动到另一个包含完整多边形的列表，然后设置先前 = 当前，清空当前并将正在处理的点添加到当前。

根据您的点的处理方式（顺序），您可能需要再次运行所有最终多边形以检查它们是否与任何其他多边形相邻。

对不起，长长的文字墙，如果你想编码，请告诉我，它是用 c# 编写的，不是很干净。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-05-06T07:40:47.727

我找到了一个更简单的方法：

1.  创建黑色图像。
2.  在图像上以白色绘制填充矩形。这样所有重叠的矩形都将连接起来。
3.  找到斑点的轮廓。

而已！

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-03-13T18:37:15.113

只需测试矩形是否接触，然后在它们的点的联合上运行凸包。

或者您也可以手动测试以查看矩形的哪一侧正在接触，然后以正确的顺序将点添加到多边形对象。

这些假设封闭的多边形就足够了（其中不能有孔）。`******************