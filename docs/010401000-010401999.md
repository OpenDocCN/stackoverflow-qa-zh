# StackOverflow 问答 10401000-10401999

# css - 非平凡的响应式设计布局技术（即，四处移动）

> ID：10401002
> 
> 赞同：4
> 
> 时间：2012-05-01T16:38:40.467
> 
> 标签：css, layout, responsive-design

在狭窄的视口中清除一列是一项简单的壮举，但我需要移动事物的技术。我正在尝试调和一对差异很大的移动和桌面模拟。桌面模拟包含一个 3 列网格，它应该在移动视图中折叠成一个单列网格，然后隐藏一些元素并重排其他元素。

隐藏元素是微不足道的`display: none`。对我来说，困难的部分是将元素从列中分离出来并将它们移动到各处，就像[http://bostonglobe.com/](http://bostonglobe.com/)一样。从 Firebugging 他们的布局中，我发现您可以通过操纵浮动来颠覆源顺序，浮动可能会被重置并通过移动视口中的媒体查询清除元素。这是使折叠视图中其他 2 列内容下方的中间列（在 3 列网格中）清晰的一种方法。

这是使用纯 CSS 响应式重排布局的程度吗？我可以使用其他技术（可能使用 JavaScript）吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T20:27:24.547

您无法在那种程度上操纵 DOM……实际上无法重新排序标记。我解决这个问题的方法是复制元素并将其定位在特定视口宽度所需的位置并将其隐藏直到需要它为止。

完全避免这种情况的最好方法是首先设计移动设备：

[http://stuffandnonsense.co.uk/projects/320andup/](http://stuffandnonsense.co.uk/projects/320andup/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T20:08:50.140

我认为浮动示例是纯 CSS 可以做的限制，但使用 javascript 你几乎可以做任何事情 - jQuery .append 可用于拉出任何元素并将其放在其他地方；有效地改变 DOM 的顺序和布局。

[http://api.jquery.com/append/](http://api.jquery.com/append/)

但是从性能的角度来看， .append 并不便宜，所以如果可以的话，我会尽量避免它，通过“首先构建移动/小型”。实现它的另一种方法是为不同的屏幕宽度实际使用不同的布局，然后使用媒体查询（不仅仅是 CSS 来隐藏东西，而是实际上在 javascript 中，因此“隐藏”的内容实际上不会呈现或包含在代码中直到需要它，所以 DOM 不会挤满未使用/隐藏的元素或不必要的代码）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-13T21:40:29.203

Bootstrap 3.0 具有[列重新排序](http://getbootstrap.com/css/#grid-column-ordering "Bootstrap 3.0 列重新排序"):) 这意味着您可以纯粹使用预先设置的 CSS 类名，为每个媒体查询单独指定列排序，无需 javascript 或任何时髦的 hack！

来自 Bootstrap 文档的示例：

```
<div class="row">
  <div class="col-md-9 col-md-push-3">Appears first in code, second in browser</div>
  <div class="col-md-3 col-md-pull-9">Appears second in code, first in browser</div>
</div> 
```

# javascript - 修复无效 JSON 的正则表达式

> ID：10401004
> 
> 赞同：2
> 
> 时间：2012-05-01T16:38:55.753
> 
> 标签：javascript, regex, json

我正在对服务进行 API 调用，但它返回了无效的 JSON。photo_url 字段没有用引号封装的 url。我把它作为一个字符串，并试图编写一个正则表达式来在 url 周围添加引号。我用 Javascript 做这一切，使用 Titanium。

这是我现在的代码：

```
var response = '[{"friend_request":{"about_me":"","friend_id":"11043271728","gender":"M","display_name":"foo","age":21,"photo_url":http:\/\/s.foo.com\/img\/nopic\/MB_90x90_male.gif,"hometown":""},"friend_request":{"hometown":"","display_name":"bar","gender":"M","age":"","friend_id":"11040542298","about_me":"","photo_url":http:\/\/s.foo.com\/img\/nopic\/MB_90x90_male.gif}}]';
var pattern = /http.*(,|\}|\s)/i;
var flip = target.match(pattern);
var foo  = target.replace(flip, "\"" + flip + "\"");
console.log(foo); 
```

这是人类可读形式的 JSON：

```
[
  {
    "friend_request": {
      "about_me": "",
      "friend_id": "11043271728",
      "gender": "M",
      "display_name": "foo",
      "age": 21,
      "photo_url": http:\/\/s.foo.com\/img\/nopic\/MB_90x90_male.gif,
      "hometown": ""
    },
    "friend_request": {
      "hometown": "",
      "display_name": "bar",
      "gender": "M",
      "age": "",
      "friend_id": "11040542298",
      "about_me": "",
      "photo_url": http:\/\/s.foo.com\/img\/nopic\/MB_90x90_male.gif
    }
  }
] 
```

现在，它正在寻找模式的开始，但会更进一步。我相信它与逗号有关。我知道应该发生多个模式匹配，但现在，我只是想让一个工作。在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T16:47:29.743

```
var response = '[{"friend_request":{"about_me":"","friend_id":"11043271728","gender":"M","display_name":"foo","age":21,"photo_url":http:\/\/s.foo.com\/img\/nopic\/MB_90x90_male.gif,"hometown":""},"friend_request":{"hometown":"","display_name":"bar","gender":"M","age":"","friend_id":"11040542298","about_me":"","photo_url":http:\/\/s.foo.com\/img\/nopic\/MB_90x90_male.gif}}]';

var str = response.replace( /("photo_url":)([^,}]+)([,\}])/g, '$1"$2"$3' ) 
```

# android - Sqlite DB Android 备份/恢复

> ID：10401011
> 
> 赞同：3
> 
> 时间：2012-05-01T16:39:30.607
> 
> 标签：android, sqlite, backup, restore

我想知道在 android 上备份和恢复 SQLite DB 的最佳实践是什么。目前，我通过备份数据库并使用文件输入/输出流将其复制到 sd 卡来解决这个问题。然后，如果我想恢复和旧备份，我会使用相反的过程。

此方法似乎有效，并且尚未损坏我的数据。我想知道这是否是最好的方法，或者是否有更安全的方法？

谢谢

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-31T22:17:07.643

只是一个关于备份数据库的 FYI。我目前在我的应用程序中执行此操作的方式与您在上面解释的方式相同。以这种方式创建备份时要小心。它在大多数情况下都很好用，但问题是创建的备份不能保证与所有设备和 Android 版本兼容。我第一次听说这听起来很奇怪，但我现在发现这是真的。我最近收到了几份关于丢失数据、消失数据等的报告。当用户从不同的设备或不同的 Android 版本或 ROM 恢复备份时，这一切都发生了。他们中的一些人直接联系了我，这很好，所以我能够从他们那里获取备份文件来测试它们并检查它们。当我尝试恢复它们时，我会收到以下 logcat 错误：**android.database.sqlite.sqlitedatabasecorruptexception：数据库磁盘映像格式错误**

我发现，主要是某些 HTC 设备和一些自定义 rom（在任何设备上）正在创建这些备份，这些备份不会恢复到其他设备或 rom。数据库并没有真正损坏，但 Android 认为它们是。我会将它们带入 SQLite 浏览器，那里也不会显示任何数据。事实证明，较新版本的 SQLite 默认启用了 WAL（预写日志），如果启用并使用该数据库进行备份，则无法将其恢复到旧版本的 SQLite，甚至有时甚至无法恢复到相同版本（对于一些奇怪的原因）。因此，我使用“PRAGMA journal_mode = DELETE”禁用了 WAL，然后我能够在浏览器中查看数据库并能够在我的测试设备上恢复它。另一个问题是没有'

很抱歉，回复太长了，但我想解释一下我在这种备份中看到的情况。我正在尝试寻找另一种在 SD 卡上创建通用备份的方法。创建 csv 文件和像@Kingamajick 说的 sql 脚本可能是另一种方法。它需要更多的代码和更多的工作，但如果它适用于任何设备、SQLite 版本和 ROM，那么它是值得的。您的客户丢失数据绝不是一件好事。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-01T16:58:37.567

这似乎是最好的方法。您可能需要考虑在复制 SQLite 文件并将其与目标文件进行比较之前对它进行校验和，以获得额外的保证。只需确保在获取副本时没有打开的数据库连接，否则在恢复时可能会导致数据库处于意外状态。

我能看到的唯一另一种方法是读取数据库的实际内容并生成一个包含可以从中恢复的 SQL 的文件，这显然是一个更复杂的并且不提供任何优势证明这种复杂性是合理的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-11T14:04:17.363

我会在 Kingamajick 的回答中添加一条额外的评论（论坛不允许我将其添加为实际评论）。在简单地复制文件的方法中，如果用户曾经恢复数据库并且其中已经有任何数据，它将被覆盖。例如，如果用户升级到新手机，使用一段时间，然后从旧手机恢复数据库，则新手机上已有的所有数据都将丢失。这是读取数据库并将其写入文件（XML 或 CSV 等）的复杂性的一个优势。

我发布了另一个问题（[Android sqlite backup/restore without overwriting](https://stackoverflow.com/questions/35227272/android-sqlite-backup-restore-without-overwriting/35328146#35328146)），希望有人有更好的解决方案来避免这个问题，但到目前为止似乎还没有。在这和 ssuperz28 指出的担忧之间，备份数据库似乎更安全的方法是将其写入 xml，然后读取它并在恢复时将其重新添加。

此外，[https://stackoverflow.com/a/34477622/3108762](https://stackoverflow.com/a/34477622/3108762)是我迄今为止看到的其他建议中最好的，并承诺从 Marshmallow 开始以更好的方式解决这个问题。

# java - 关于工厂设计模式

> ID：10401016
> 
> 赞同：-5
> 
> 时间：2012-05-01T16:39:45.830
> 
> 标签：java, design-patterns

我正在对工厂模式进行研发我已经开发了以下代码，请根据工厂模式的功能告知它是否正确..

```
 public abstract class Animal {
    public abstract String makeSound();
}

public class Dog extends Animal {

    @Override
    public String makeSound() {
        return "Woof";
    }

}

public class Cat extends Animal {

    @Override
    public String makeSound() {
        return "Meow";
    }

}

public class AnimalFactory {

    public Animal getAnimal(String type) {
        if ("canine".equals(type)) {
            return new Dog();
        } else {
            return new Cat();
        }
    }

}

public class Main {

    public static void main(String[] args) {
        AnimalFactory animalFactory = new AnimalFactory();

        Animal a1 = animalFactory.getAnimal("feline");
        System.out.println("a1 sound: " + a1.makeSound());

        Animal a2 = animalFactory.getAnimal("canine");
        System.out.println("a2 sound: " + a2.makeSound());
    }

} 
```

请告知根据工厂模式的设计是否正确，我可以进一步改进它吗

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T16:45:35.720

如果你传入类名，你可以避免类型检查：

```
public class AnimalFactory {

    public Animal getAnimal(String className) throws Exception {
        Class animalClass = Class.forName(className);              
        return animalClass.newInstance();
    }

} 
```

# wcf - 通过 3G 向 WCF 服务发送 POST 请求

> ID：10401019
> 
> 赞同：3
> 
> 时间：2012-05-01T16:40:09.767
> 
> 标签：wcf, post, httpwebrequest, windows-phone, 3g

使用我的 Windows Phone（HttpWebRequest 对象），我试图访问部署在 IIS 上的 WCF REST 服务。

当我通过 Wi-Fi 发出请求时，我得到了成功的响应。当我尝试通过 3G 调用相同的服务时，我得到以下响应：

```
<?xml version="1.0"?>
<!DOCTYPE wml PUBLIC "-//WAPFORUM//DTD WML 1.1//EN"
"http://www.wapforum.org/DTD/wml_1.1.xml">
<wml>
  <card id="FEHLER" title="ERROR">
    <p>
      The requested item could not be loaded <br/>       Wrong MIME-Type
      <do type="prev" label="back">
        <prev/>
      </do>
    </p>
  </card>
</wml> 
```

我需要修复什么才能使事情正常进行（客户端或服务器设置<-由于我使用托管，服务器的设置很难更改）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T22:40:58.510

原来我需要删除下面的注释行。

```
 HttpWebRequest hwrq = (HttpWebRequest)WebRequest.Create(url);
        //hwrq.Accept = "text/xml";   //this was causing problems (only on 3G)
        hwrq.Method = "POST"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T10:23:49.193

只需确认在 wifi 上发送的 http 请求的 Content type 头，并将其与 3G 请求进行比较。通过 3G 网络的请求可能会在标头中生成不同的内容类型。您可以使用 fiddler 进行检查。

# c# - 如何使用sql将多个值返回到标签中

> ID：10401020
> 
> 赞同：0
> 
> 时间：2012-05-01T16:40:33.257
> 
> 标签：c#, asp.net, sql-server

在 stackoverflow 上有一个类似的问题没有得到解答，但我相信我非常接近解决它。但基本上，我的 sql 语句返回多个值，但标签中只显示一个值，而它应该是 4 或 5 个值。

```
 protected void btnPopulate_Click(object sender, EventArgs e)
    {

        SqlConnection con = new SqlConnection(strings.settings.connectionString);
        SqlCommand command = new SqlCommand("SELECT ID FROM dbo.MDRMASTER WHERE MASTERPID = @MASTERPID",con);
       command.Parameters.Add("@MASTERPID", SqlDbType.NVarChar).Value = txtMASTERID.Text;
        con.Open();
        SqlDataReader dr = command.ExecuteReader();
        while (dr.Read()) 
        {
            string ID = dr["ID"].ToString();
            lblIDs.Text = ID;
        }
        con.Close();
    } 
```

任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T16:42:42.373

每次循环都覆盖标签的文本。你可以简单地改变：

```
lblIDs.Text = ID; 
```

到：

```
lblIDs.Text += ID + " "; 
```

并且基本上用空格分隔的列表填充标签。

此外，作为一般最佳实践编程提示：在此示例中，您将 UI 代码与数据访问代码非常紧密地耦合在一起。您应该研究 MVC、Presenter 和其他几个选项以避免紧密耦合。这是[一篇针对初学者](http://aspalliance.com/1360_Decoupling_Business_Logic_Layer_from_the_User_Interface_Layer_using_C)的文章。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-01T16:42:55.377

你的意思是这样的？

```
var ids = List<string>();
while (dr.Read()) 
{
    ids.Add(dr["ID"].ToString());            
}
lblIDs.Text = String.Join(", ", ids); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-01T16:44:13.340

您正在用每个步骤替换文本`dr.Read()`

尝试以下

```
var text = new StringBuilder();
while (dr.Read()) 
{
    text.Append(dr["ID"].ToString());
}

lblIDs.Text = text.ToString(); 
```

# iphone - 带有动画 UIImageView 的 viewDidLoad 和 viewDidAppear 之间的延迟

> ID：10401024
> 
> 赞同：0
> 
> 时间：2012-05-01T16:40:53.910
> 
> 标签：iphone, objective-c, cocoa-touch

我有一个控制器，它使用动画 UIImageView 来显示 30 512 x 512 帧的序列。当我运行应用程序时，视图会快速执行以下操作。

```
- (void)viewDidLoad {
    [super viewDidLoad];
    [[self imageView] setAnimationImages:[[self dataModel] framesForLOOP]];
    [[self imageView] setAnimationDuration:2.5];
    [[self imageView] setAnimationRepeatCount:1];
    [[self imageView] startAnimating];
    NSLog(@"MARKER_001");
}

- (void)viewDidAppear:(BOOL)animated {
    [super viewDidAppear:animated];
    NSLog(@"MARKER_002");
} 
```

这一切都很好，但我想要解决的是，在`viewDidLoad:`调用之后有 2 秒的延迟`viewDidAppear:`（在 MARKER_001 和 MARKER_002 之间）。

我在想可能会延迟设置帧`NSArray`或在调用之后`setAnimationImages:`或之后`startAnimating`。

无论如何要减少/消除这种延迟，我宁愿在启动时预加载动画并在那里受到打击，而不是在 viewController 加载时延迟，因为它使触发 segue 以实例化新控制器的按钮感觉滞后。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T17:59:37.687

只是一些想法：

1.  减轻疼痛 - 你需要 30x512x512 吗？
2.  分配痛苦 - 在 vi​​ewWillAppear 上加载第一个图像，启动一个操作以加载其他图像并在新图像准备好时更新动画图像（例如，如果需要，可以提供代码）
3.  移动痛苦 - 在应用程序初始化中准备 UIImages 数组。
4.  深入挖掘 - 让我们看看 framesForLoop 方法，也许还有更多的机会来减少/分散/移动那里的痛苦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T17:11:57.530

请注意，即使您调用`startAnimating`，`viewDidLoad`动画也不会从那里开始。您无法在尚未显示的控制器中运行动画。

你应该打电话`startAnimating`来`viewDidAppear`代替。

这两种方法之间的两秒延迟并不奇怪。延迟可能更长或更短，具体取决于应用程序内部发生的情况。测量两种未连接的方法之间的时间是没有意义的。测量各个方法需要多少时间呢？

如果有任何延迟，您可能应该粘贴在用户操作与显示所有内容和延迟发生的那一刻之间发生的所有代码。

# javascript - JavaScript Date 对象不适用于传递给它的字符串

> ID：10401028
> 
> 赞同：0
> 
> 时间：2012-05-01T16:41:23.567
> 
> 标签：javascript, validation

我正在尝试使用从数据库中获取的变量来创建日期对象。该字符串已经是正确的格式，已经用逗号分隔“yyyy,mm,dd,hh,mm,ss”。但是，尝试创建 Date 对象会返回 Invalid Date 错误。

```
var foo ='2012,03,09,12,00,00,00';
document.write(foo); //<-- obviously writes the string 2012,03,09,12,00,00,00 to the browser
var then=(new Date(foo));
document.write(then); //<-- returns Invalid Date 
```

我有一个解决方案，如下所示：

```
var x = foo.split(/[,]/);
var then = new Date(x[0], x[1], x[2], x[3], x[4], x[5]); 
```

想知道为什么在本质上它正在重新创建传递给它的相同字符串时需要这样做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T16:48:12.137

这是因为您尝试转换为 Date 对象的字符串无效。Date 对象不仅接受任何格式作为字符串。如果不被识别，它将无法工作。

请参阅日期文档[https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Date](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Date)

这是有关支持格式的信息

[https://www.rfc-editor.org/rfc/rfc2822#page-14](https://www.rfc-editor.org/rfc/rfc2822#page-14)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T16:47:58.027

`"yyyy,mm,dd,hh,mm,ss"`不是*日期*字符串的“正确格式”。

JavaScript`Date`对象只能解析特定的格式。检查 MDN 文档以`Date`获取有效`dateString`的 s。 [https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Date](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Date)

反正。您的第二个示例有效，因为您*没有*重新创建字符串，而是传递了 6 个不同的参数，而不是一个长参数。

您不能将逗号分隔的字符串传递给函数并期望它将其分解为参数，那样做是行不通的。

# frameworks - 玩 2 框架代码生成工具还是 Yii/Cakephp 框架？

> ID：10401031
> 
> 赞同：2
> 
> 时间：2012-05-01T16:41:35.673
> 
> 标签：frameworks, web, playframework, yii, cakephp-2.0

我正在尝试开始使用几个 Web 应用程序。但是，选择要使用的框架可能会让人不知所措！

我过去使用过 Java，因为我在工作中使用 C# .NET，所以我不介意学习和扩展我的 Java 知识。现在，似乎唯一可以在没有 jsp 和其他我从未理解的小应用程序的情况下工作的框架是 Play 2 Framework。我下载了这个框架，将可执行文件放在我的路径中，它似乎对我有用。但是，我遇到了 CakePHP 和 Yii 框架（我相信还有更多），并注意到有一个代码生成工具可以获取数据库并自动为您生成模型 + CRUD 等。天哪，这是节省时间。

我去谷歌搜索了我的问题，发现这在 Play Framework 中也是可能的（但只能找到 1.x 框架的模块。）

[play framework 1.2如何快速生成模型？](https://stackoverflow.com/questions/8033139/how-to-quickly-generate-models-in-play-framework-1-2)

[http://www.playframework.org/modules/db](http://www.playframework.org/modules/db)

所以，我的问题是...

**是否有一个模块可以让您在 Java Play 2.0 框架中轻松完成这项工作，就像在提到的 PHP 框架中一样？**

**如果不是，那么坚持 Java 框架是否值得（任何优势）？**

**如果没有，您认为哪个 php 框架甚至 python（但 Ruby）框架具有最好的工具，例如这种自动完成功能？**我不是说要学习一门新的语言，无论如何我都得学。但是为了学习一门语言，我可以做 Web 开发以外的事情（对于 Ruby，我知道你可以做更多的事情，但学习其他语言可能只是浪费时间。但是，学习 Python、Java 会打开应用程序和电话开发）

不要打算展开辩论，请在回答中简洁（不像我）。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T17:12:10.917

从个人经验来看，这两个框架有几个不同之处，特别是在 cake 与 yii 中处理模型的方式。

在`cakephp`你不能使用的情况`composite primary key`下，这对我来说是主要的`deal-breake`r。`Composite primary key`Yii 支持。 `Cakephp`强制执行约定，而`yii favors convention`，您不必遵循某个标准。

开箱即用的性能，我认为`yii has the advantage`，但与性能调整一样，使用适当的缓存配置，只要你在使用 ActiveRecord 模式时小心，它们之间并没有太大的区别作为旁注，我已经领导了 web 应用程序的实现对于 CakePHP 和 Yii，我从团队得到的反馈是经验较少的团队更喜欢 CakePHP，而经验丰富的团队更喜欢 Yii。随心所欲。

好吧，这可能是一场很长的辩论。每个人都有自己的生活。到目前为止，我发现经验`Yii`比所有人都更有希望。对我来说，谁在更短的时间内完成更多工作很重要。Cake 有点重，但 Yii 是轻量级框架。我来自 .Net 背景，但花了几个星期才开始使用 Yii

# jquery - 使用 jQuery 即时创建标签

> ID：10401034
> 
> 赞同：16
> 
> 时间：2012-05-01T16:41:48.453
> 
> 标签：jquery, forms, jquery-ui, jquery-ui-datepicker, dom-manipulation

我需要动态创建一个标签和文本字段，还需要为文本字段包含日期选择器。我需要这样的东西：

```
<label for="from">From </label> <input type="text" id="from" name="from" /> 
```

我在 jQuery 中尝试过这样的事情：

```
var label = $("<label>").attr('for', "from");   
                    label.html('Date: ' +
                        '<input type="text" id="from name="from" value="">');

                    $(function() {
                        $("#from").datepicker();
                    }); 
```

这个不知何故不会创建标签和文本字段。我不确定我错过了什么。

**编辑**

更准确地说，我在 portlet 中使用它，并且我在 jsp 页面中没有正文标记。因此，当我调用该函数附加到正文时，它不会。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-05-01T16:47:45.880

像这样的东西会起作用：

```
//Create the label element
var $label = $("<label>").text('Date:');
//Create the input element
var $input = $('<input type="text">').attr({id: 'from', name: 'from'});

//Insert the input into the label
$input.appendTo($label);
//Insert the label into the DOM - replace body with the required position
$('body').append($label);

//applying datepicker on input
input.datepicker(); 
```

[jsFiddle 演示](http://jsfiddle.net/HEy4Z/1/)

`for`请注意，如果输入元素在其中，则不必使用标签上的属性。所以使用其中之一：

```
<label><input id="x1"></label>

<label for="x1"></label> <input id="x1"> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-01T16:45:00.433

您需要将您创建的标签附加到 DOM 以使其显示：

```
var label = $("<label>").attr('for', "from");
    label.html('Date: ' +
      '<input type="text" id="from name="from" value="">');

label.appendTo('body');

// set up datepicker
label.find('#from').datepicker(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T16:45:33.510

你想在哪里插入标签？如果你想要它在页面的开头，你可以做这样的事情。

```
var $label = $("<label>").attr('for', "from");   

$label.html('Date: <input type="text" id="from" name="from" value="">');

$(function() {
    $('body').prepend($label);

    $(':input', $label).datepicker();
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T16:45:38.277

1）您在 ID 属性末尾缺少结束引号。
2）您没有将标签本身附加到任何东西上。

# java - 从 Activity 传递给非 Activity 构造函数的上下文实例是什么？

> ID：10401039
> 
> 赞同：2
> 
> 时间：2012-05-01T16:42:27.207
> 
> 标签：java, android, android-activity, android-context

Android API 中的几个类在`Context`其构造函数中需要一个参数，例如`ArrayAdapter`,`SQLiteOpenHelper`或`Intent`. 从 内部创建这样的对象时`Activity`，哪个上下文实例更适合传递给它们：（`this`活动实例本身）或活动`getApplicationContext()`方法返回的对象，为什么？

到目前为止，我都使用了这两种方法，并且没有看到结果功能有任何区别。有什么经验法则吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T16:52:05.677

从`getApplicationContext()`方法的文档：

> 返回当前进程的单个全局应用程序对象的上下文。这通常只应在您需要一个生命周期与当前上下文分离的上下文时使用，该上下文与进程的生命周期而不是当前组件相关联。

> 例如考虑它如何与 {@ #registerReceiver(BroadcastReceiver, IntentFilter)} 交互：
> 
> *   如果从 Activity 上下文中使用，则接收器正在该 Activity 中注册。这意味着您应该在活动完成被销毁之前取消注册；事实上，如果您不这样做，框架将在删除活动并记录错误时清理您泄露的注册。因此，如果您使用 Activity 上下文来注册一个静态的接收器（对于进程来说是全局的，不与 Activity 实例关联），那么无论您使用的 Activity 被销毁的任何时候，该注册都会在您身上被删除。
>     
>     
> *   如果从此处返回的 Context 中使用，则接收器正在使用与您的应用程序关联的全局状态进行注册。因此，它永远不会为您取消注册。如果接收器与静态数据相关联，而不是特定组件，则这是必要的。但是，如果您忘记取消注册、取消绑定等，在其他地方使用 ApplicationContext 很容易导致严重的泄漏。

# mysql - 在这种情况下如何使用嵌套的 INSERT/SELECT 命令？

> ID：10401042
> 
> 赞同：0
> 
> 时间：2012-05-01T16:42:47.153
> 
> 标签：mysql

我有这个命令：

```
INSERT INTO table2 (username,profile) SELECT DISTINCT username,profile 
FROM table1 WHERE profile='$profile' and username <> '$sender' 
```

我的问题是我想要这个：`INSERT INTO table2 (username,profile,type)`类型将是相同的字符串，比如“字符串”

重要提示：我只想`username`与众不同。`profile`并且`type`可以相同。此外，`profile`将始终是相同的值。

我怎样才能做到这一点？

非常感谢，问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T16:49:35.013

```
INSERT INTO table2 (username, profile, type)
SELECT username, profile, "string"
FROM table1
WHERE profile='$profile' AND username <> '$sender'
GROUP BY username 
```

请**绝对确定**并且`$profile`已经`$sender`清除了可能的 SQL 注入攻击（如果这对您没有任何意义，请阅读有关[Bobby Tables](http://bobby-tables.com)的信息）。最好使用准备好的语句，将变量作为参数传递给其中*，*这些参数不会被 SQL 评估。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T16:57:44.607

我做了一个很大的假设，即您正在寻找类似...的输出

```
UserFred profile1 type1
UserBill profile2 type1
UserJim  profile1 type8 
```

您需要在子选择中应用 GROUP BY 语句...

```
INSERT INTO table2 (username,profile)
   SELECT DISTINCT username,profile 
   FROM table1 WHERE profile='$profile' and username <> '$sender'
   GROUP BY username; 
```

# hibernate-annotations - 在环境之间移动带注释的 jpa 实体

> ID：10401049
> 
> 赞同：1
> 
> 时间：2012-05-01T16:43:21.560
> 
> 标签：hibernate-annotations, spring-annotations, spring-data-jpa

我在 sts 中使用 spring-data 和 jpa 项目方面直接从我的数据库模式生成实体。管理“注释”实体在不同环境（开发、登台、产品 ..etc）之间迁移的最佳实践是什么。

给定一个实体

```
@Entity
@Table(name="DevEnvironment.dbo.mytable")
public class MyTable implements Serializable {} 
```

我如何将上述实体迁移（仅生成针对特定环境的 Maven 工件）到

```
@Entity
@Table(name="ProdEnvironment.dbo.mytable")
public class MyTable implements Serializable {} 
```

也许使用*spel*？

环境 spring-data-jpa, spring3.1.0 , osojvHibernateJpaVendorAdapter

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:38:51.947

虽然我没有收到最终的“推荐”答案这对我来说很好

```
 <!-- entity manager -->
<bean id="entityManagerFactory"
    class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
    <property name="dataSource" ref="myDataSource" />
    <property name="jpaVendorAdapter" ref="jpaAdapter" />
    <property name="persistenceUnitName" value="mypu" />
    <property name="jpaProperties">
        <props>
            <prop key="hibernate.dialect">org.hibernate.dialect.SQLServerDialect</prop>
            <prop key="hibernate.default_schema">${default_schema}</prop>
        </props>
    </property>
</bean> 
```

# jquery - jQuery找到深度嵌套的输入元素

> ID：10401055
> 
> 赞同：1
> 
> 时间：2012-05-01T16:43:46.927
> 
> 标签：jquery, asp.net, forms, traversal, descendant

我在[此处列出的项目中使用表单控件](http://www.obout.com/SuperForm/aspnet_firstlook_checkout.aspx)

当我将它包含在我的页面中时，它会生成一整套动态 html 来很好地格式化所有内容。但是，我正在尝试应用于`jQuery datepicker`表单中的一些输入元素，但我不知道如何选择我想要的输入。

我已经将 SuperForm 直接嵌套在一个`div`名为“ `bookings`”中，所以我知道我可以将其用作起点，但我需要遍历该 div 的所有后代，直到找到正确的输入，我知道它们的顺序出现所以我假设我可以在这里的某个地方使用 nth-child(x) 但到目前为止我还没有运气。任何帮助将不胜感激！

解决了！这是我的解决方案：

```
$("#bookings :input[type='text']:eq(2)").datepicker({...}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T15:44:23.717

解决了！这是我的解决方案：

```
$("#bookings :input[type='text']:eq(2)").datepicker({...}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T16:53:37.820

将类、属性或 id 应用于您想要的元素或以这种方式检查每个元素。

```
$('#bookings input').each(function () {
   //Check here

 }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T17:15:10.650

您显然需要一些标识符/选择器来过滤您的输入元素。

```
$('#bookings').find('.applyDatePicker').datepicker({...}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T21:31:30.923

使用 HTML5 中支持的新输入类型。

新的输入类型是：

*   颜色
*   日期
*   约会时间
*   本地日期时间
*   电子邮件
*   月
*   数字
*   范围
*   搜索
*   电话
*   时间
*   网址
*   星期

如果将它们设置为日期（或日期时间），则可以使用以下方法选择所有元素：

```
$('input[type="date"]').each(function(index,element){
   $(element).datepicker...
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-08-15T22:51:11.890

你在使用简单选择器时是对的，但是如果你的主选择器很复杂，你可能不能在主选择器中使用输入选择器，所以最好使用

```
.find(" :input[type='text']") 
```

例如在可排序的场景中，如果主选择器是这样的：

```
$("#ulId").children('li:not(.ui-sortable-placeholder)') 
```

如果您编写如下代码，您将无法获得任何元素：

```
$("#ulId").children('li:not(.ui-sortable-placeholder) :input[type='text']') 
```

但我们可以使用这个：

```
$("#ulId").children('li:not(.ui-sortable-placeholder)').find(" :input[type='text']") 
```

希望这有帮助。

# jquery - 如何将 cookie 附加到我的 jQuery 发布请求标头？

> ID：10401056
> 
> 赞同：2
> 
> 时间：2012-05-01T16:43:53.443
> 
> 标签：jquery, post, cookies

与[如何在我的 Web 客户端上复制此 cookie 功能相关？](https://stackoverflow.com/q/10400064/198048)

我在上一个问题中发现我需要在我的请求标头中设置一个 cookie。

我在第 3 方 Web 服务上调用登录方法，这将返回一个 cookie，我需要在对该服务器的后续请求中使用该 cookie。我曾假设浏览器保留此 cookie 并将其附加到适当的请求，但是，情况似乎并非如此（我可以看到它不在 firebug 中）。

如何在我的请求标头上设置 cookie？

我的电话如下：

```
var call = serviceUriString + '?' + strRequest;
$.post(call, function(d) {}, 'text').success(function(d) { ..//do something 
```

我想我可能必须在发送之前使用[jQuery.ajax( url [, settings] )](http://api.jquery.com/jQuery.ajax/)，但是我找不到任何关于如何设置 cookie 的好例子，或者实际上如何从响应中取出它/坚持它以前的登录请求（以便我可以附加它）。

正如@edr 指出的那样，我正在做这个客户端。所以我的网站在客户端代码中调用了一个 Web 服务。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T17:50:29.963

我不确定是否有答案，但是我可以添加`;jsessionid=[value_here]?`到我的 url 并且有效。

例如：

```
var call = serviceUriString + ';jsessionid=' + [value_here] + '?' + strRequest;
$.post(call, function(d) {}, 'text').success(function(d) { ..//do something 
```

类似的答案在这里：[https ://stackoverflow.com/a/10353875](https://stackoverflow.com/a/10353875)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T17:57:41.290

这里只是推测：

由于在进行 ajax 调用时 cookie 随行，我怀疑创建的 cookie 是为第 3 方域创建的，因此有理由认为您不会在域的 cookie 中找到*它*。

在发布之前尝试在客户端代码中添加 cookie。这个 SO 问题可能会有所帮助：

[如何使用 jQuery 设置/取消设置 cookie？](https://stackoverflow.com/questions/1458724/how-to-set-unset-cookie-with-jquery)

# python - 如何在 Python 中使用 librt 函数？

> ID：10401059
> 
> 赞同：4
> 
> 时间：2012-05-01T16:44:19.077
> 
> 标签：python, c, linux, shared-libraries, perforce

我正在尝试使用第三方 .so，P4API.so，它调用 librt.so 中定义的 clock_gettime，并希望我的脚本的用户不必设置 LD_PRELOAD。所以在**init** .py 文件中，我有：

```
import ctypes

librt = ctypes.cdll.LoadLibrary('librt.so') 
```

这可以很好地加载库，但运行脚本仍然会发出：

```
ImportError: /path/to/P4API.so: undefined symbol: clock_gettime 
```

我试过了：

```
__builtins__['clock_gettime'] = librt.clock_gettime 
```

但这也行不通。

如何让 P4API.so 识别加载的 librt？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T17:05:06.060

你需要加载它

```
 ctypes.CDLL('librt.so', mode=ctypes.RTLD_GLOBAL) 
```

为了使其可用于其他图书馆。

# wpf - XAML 中绑定的路径属性的串联

> ID：10401060
> 
> 赞同：2
> 
> 时间：2012-05-01T16:44:19.183
> 
> 标签：wpf, xaml, data-binding, path, concatenation

我有一个与使用 WPF 在 XAML 中绑定时设置路径有关的问题。

假设我的 DataContext 是 PropertyInfo 类型。PropertyInfo 包含有关属性名称的数据。

在该对象中，我嵌套（例如）TextBox，我想将哪个 Text 属性绑定到具有另一个元素 DataContext 名称的属性。

类似的东西[它是伪代码，因为那样不可能]：

```
<DataTemplate>
    <TextBox Text={Binding ElementName=someElement, Path=DataContext. + {Binding Path=Name}}/>
</DataTemplate> 
```

我想创建灵活的视图，这就是我需要解决这个问题的原因。有没有办法在没有代码的情况下实现这一目标？

考虑到上述所有情况，我认为我可以让我的问题简短，并简单地询问是否有办法在设置绑定路径时连接字符串。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T16:50:33.103

我不确定我是否理解正确，但这是多重绑定可以帮助的吗？

```
<TextBlock Grid.Row="3" Grid.Column="1" Padding="5"><TextBlock.Text>
<MultiBinding StringFormat="[{0}, {1}]">
            <Binding Path="LastName"></Binding>
            <Binding Path="FirstName"></Binding>
 </MultiBinding>
    </TextBlock.Text>
  </TextBlock> 
```

# c# - 文本框和消息框

> ID：10401061
> 
> 赞同：0
> 
> 时间：2012-05-01T16:44:20.420
> 
> 标签：c#, wpf, textbox, focus, messagebox

我的表单上有 2 个输入框。如果用户输入数据，他可以按回车键查看它们是否正确，否则会出现错误消息框。现在我有一个小问题。当 messagebox 出现并且用户按下回车键时，msgbox 消失并立即出现另一个。我想消失，让用户更改他们的数据。我该如何解决？我试图以这种方式解决这个问题：我添加了不可见的文本框，当用户按下 Enter 时，此文本框获得焦点，如果出现错误 msgbox，最终发件人获得焦点。代码：

```
private void login(object sender, KeyEventArgs e)
{
    if (e.Key == Key.Enter)
    {
        focus.Focus();
        if (password.Password == "" || account.Text == "")
        {
            MessageBoxResult result = MessageBox.Show("Fill login and password.");
        }
        if(sender.GetType() == account.GetType())
          ((TextBox)sender).Focus();
        else
          ((PasswordBox)sender).Focus();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T17:14:45.913

尝试这个：

```
if (e.Key == Key.Enter && !string.IsNullOrWhiteSpace(txtPass.Text))
        {
            if (1 + 1 != 3)
            {
                MessageBox.Show("Wrong!!!");
                txtPass.Clear();
                txtPass.Focus();
            }
        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T16:48:03.633

尝试设置**e.Handled = true;** 以防止按键传播到您的文本框。

# c# - 防止用户导航到文档

> ID：10401062
> 
> 赞同：1
> 
> 时间：2012-05-01T16:44:22.793
> 
> 标签：c#, .net, asp.net-mvc-3

我的网站中有一个文件夹，其中包含另一个文件夹，其中包含许多文件夹，这些文件夹都包含各种文档：pdf、word 文档、txt 文件、excel 文档、图像等。我想阻止用户通过浏览器导航到这些文档中的任何一个. 我怎样才能做到这一点？我正在使用 MVC3。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T16:51:29.227

您可以将目录结构移动到`App_Data`特殊文件夹中。此文件夹不可直接访问。然后简单地编写一个控制器动作，它给出一个 id 将文件流式传输到客户端。然后使用 Authorize 属性装饰控制器操作，以确保只有经过身份验证的用户才能访问它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T16:52:31.083

目录浏览只会阻止用户查看文件夹内的文档列表，但不会阻止用户输入指向现有文档的有效 URL 并查看它。如果这是您需要的，您需要拒绝所有用户访问该文件夹。

```
<location path="folder">
<system.web>
<authorization>
  <deny users="*"/> 
</authorization>
</system.web>
</location> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T16:52:54.157

如果您不能在 IIS 中轻松完成，请在 Web.config 中完成，您可以：

```
<configuration>
  <location path="Secured">
    <system.webServer>
      <directoryBrowse enabled="false" />
    </system.webServer>
  </location>
</configuration> 
```

[编辑]

我看到您想让内容无法访问，而不仅仅是阻止目录列表。在这种情况下，请执行 Icarus 答案中的其他步骤。

# python - Python 的“import X”和“from module import X”的区别？

> ID：10401063
> 
> 赞同：1
> 
> 时间：2012-05-01T16:44:24.663
> 
> 标签：python, google-app-engine

Google App Engine 只是给了我一个我不明白的错误。给定一个包含文件“Car.py”的模块“X”，其中包含一个类“Car”，

并给出这段代码：

```
import X 

class Passenger(db.Model):
  car = db.ReferenceProperty(X.Car.Car) 
```

我得到错误：

```
AttributeError: 'module' object has no attribute 'Car' 
```

但是，如果我将其更改为：

```
from X import Car

class Passenger(db.Model):
  car = db.ReferenceProperty(Car.Car) 
```

有用。它们在我看来是一样的，但显然不是。有什么不同？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T16:49:53.190

正如 Lattyware 所指出的，`X`是一个包，而这正是包的工作方式。导入外部级别不会自动让您访问其中的模块。如果您`import X.Car`想将整个事物称为`X.Car.Car`.

（另外请注意 Python 不是 Java：没有理由将每个类放在单独的文件中，即使你这样做了，模块和包通常也有小写的名称。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T16:49:21.270

这里的问题是，当包 X 被加载时，它包含模块但它们不在它的命名空间中。

要将模块放入包的命名空间，请将`import module`（`module`当然，模块的名称在哪里）添加到包的`__init__.py`文件中。然后它将位于包的命名空间中，您可以使用第一种访问 Car 的方式。

# jquery - 非宽度特定的 jquery 轮播

> ID：10401064
> 
> 赞同：0
> 
> 时间：2012-05-01T16:44:26.427
> 
> 标签：jquery

我正在尝试使这个 jquery 轮播以不同的宽度工作。现在，在它重复之前，末尾有一堆空白。

我怎样才能清除最后的空白？

这是我的jsfiddle。

[http://jsfiddle.net/A4sZb/](http://jsfiddle.net/A4sZb/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T14:23:24.287

### 怎么了

轮播通过显示图标的水平列表来工作。旋转图标时，轮播只是使用 CSS 左右移动列表。最后出现空白是因为您将所有列表元素都放在左侧。然后，当您再次单击“下一步”时，您的所有元素都会移回最右侧。

### 如何修复它

就像 Dutchie432 所说，您需要重新附加屏幕外项目。从头开始获取元素并使其再次显示在末尾的功能不是您可以仅通过 CSS 修改来完成的；您需要编写一些 JavaScript/jQuery 代码来实际修改 DOM。

### 示例实现

使用 jQuery，您可以使用`:first`or`:last`选择器选择列表中的第一个或最后一个项目。当用户单击“下一步”时，选择第一个列表元素，将其删除，并将其附加到轮播列表的末尾。像这样循环您的列表元素必须在您完成动画转换后进行。显然，您需要通过某种方式检查第一个/最后一个项目是否在移动之前不再可见。此外，您需要确保一旦删除第一个项目并将其放在最后，您将移动列表元素以补偿丢失的图像宽度。

# ruby-on-rails-3 - Rails 3 HABTM 未更改 created_at 和 updated_at 字段

> ID：10401068
> 
> 赞同：2
> 
> 时间：2012-05-01T16:44:42.160
> 
> 标签：ruby-on-rails-3

我有两个模型：产品和类别。他们有 HABTM 关系。

在产品表格中，我有：

```
<% Category.find(:all).each do |c| %>
    <%= check_box_tag 'product[category_ids][]', c.id, @product.category_ids.include?(c.id) %> <%=c.name%>
<% end %> 
```

它工作得很好，但是当创建 categories_products 记录时， created_at 字段为空（ 0000-00-00 00:00:00 ）。

我怎样才能让 Rails 创建/更新这些字段？

谢谢。

# c# - 在 TextArea 内以不同颜色显示每一行

> ID：10401070
> 
> 赞同：0
> 
> 时间：2012-05-01T16:44:42.923
> 
> 标签：c#, asp.net, visual-web-developer

我正在开发一个 ASP.NET 网站，其中有 TextArea，我需要为每一行设置不同的颜色。

我的代码中有以下内容：

```
for (int j = 0; j < Max_Senses; j++)
{
    for (int k = 0; k < n; k++)
    {
        if (j == 0) //first line black
             TextArea1.Attributes["Style"] = "FONT-FAMILY: ''consolas';FONT-STYLE:bold; COLOR: Black; BACKGROUND-COLOR: White";
        else // other lines red
             TextArea1.Attributes["Style"] = "FONT-FAMILY: 'consolas';FONT-STYLE:bold; COLOR: Red; BACKGROUND-COLOR: White";

        TextArea1.Value += res[k, j].PadRight(11);
    }

    TextArea1.Value += "\r\n";
} 
```

它用红色显示所有行，而我需要将第一行涂成黑色！谁能告诉我如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T16:46:15.503

HTML`TextArea`不支持这一点。您可能需要一个支持[CKEditor](http://ckeditor.com/)`ContentEditable`的控件

# parsing - 选区解析器和依赖解析器之间的区别

> ID：10401076
> 
> 赞同：121
> 
> 时间：2012-05-01T16:45:01.443
> 
> 标签：parsing, nlp

*选区解析器*和*依赖解析器*有什么区别？两者有什么不同的用法？

* * *

## 回答 #1

> 赞同：198
> 
> 时间：2012-05-01T17:12:30.200

选区分析树将文本分成子短语。树中的非终结符是短语的类型，终结符是句子中的单词，边缘是未标记的。对于一个简单的句子“John sees Bill”，选区解析将是：

```
 Sentence
                     |
       +-------------+------------+
       |                          |
  Noun Phrase                Verb Phrase
       |                          |
     John                 +-------+--------+
                          |                |
                        Verb          Noun Phrase
                          |                |
                        sees              Bill 
```

依赖解析根据它们的关系连接单词。树中的每个顶点代表一个词，子节点是依赖于父节点的词，边由关系标记。“John sees Bill”的依赖解析将是：

```
 sees
                |
        +--------------+
subject |              | object
        |              |
      John            Bill 
```

您应该使用最接近目标的解析器类型。如果您对句子中的子短语感兴趣，您可能需要选区解析。如果您对单词之间的依赖关系感兴趣，那么您可能需要依赖解析。

斯坦福解析器可以为您提供任何一种（[在线演示](https://corenlp.run/)）。实际上，它真正起作用的方式是始终使用选区解析器解析句子，然后，如果需要，它会对选区解析树执行确定性（基于规则）的转换，以将其转换为依赖树。

更多可以在这里找到：

[http://en.wikipedia.org/wiki/Phrase_structure_grammar](http://en.wikipedia.org/wiki/Phrase_structure_grammar)

[http://en.wikipedia.org/wiki/Dependency_grammar](http://en.wikipedia.org/wiki/Dependency_grammar)

# mediawiki - 显示 Semantic MediaWiki 错误文本而不是警告图标

> ID：10401077
> 
> 赞同：1
> 
> 时间：2012-05-01T16:45:03.320
> 
> 标签：mediawiki, semantic-mediawiki

从 Semantic MediaWiki 版本 1.0* 左右开始，某些错误不再以文本形式报告，并被替换为黄色三角形警告图标 ( ![Semantic MediaWiki error.png](../Images/6d3d5378c01a25966d94c46409b1f987.png))，错误文本显示在滚动工具提示中。

（图片来自：[http](http://semantic-mediawiki.org/w/extensions/SemanticMediaWiki/skins/images/warning.png) ://semantic-mediawiki.org/w/extensions/SemanticMediaWiki/skins/images/warning.png ）

有没有办法改变这种行为来显示文本？

* [http://semantic-mediawiki.org/wiki/Help:Upgrading_from_0.7_to_1.0](http://semantic-mediawiki.org/wiki/Help:Upgrading_from_0.7_to_1.0)

**编辑：** 这是出现此图标的 HTML 示例：

```
<span class="smwttpersist"><span class="smwtticon">warning.png</span>
<span class="smwttcontent"><ul>
<li>Some subquery has no valid condition.</li></ul></span></span> 
```

我更喜欢在某处的 prefs 文件中切换，但也欢迎使用 JavaScript 解决方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T22:03:17.050

使用 javascript 将工具提示转换为普通文本相当容易，例如：

```
$(function() {
    $('img[src$="warning.png"]').each(function() {
        var tooltip = $(this).attr('title');
        $(this).after($('<span>').text(tooltip));
    });
}); 
```

如果它不是普通的工具提示（`title`属性）而是更花哨的东西，那么通常只需使用以下内容覆盖 CSS 就足够了：

```
.tooltip-class {
    display: inline;
    position: static;
    border: 0;
    padding: 0;
    background-color: transparent;
} 
```

您可以使用 wiki 页面`MediaWiki:Common.js`来放置 javascript 和`MediaWiki:Common.css`CSS 代码。

# objective-c - Objective C 如何解决 NSCoreDataOptimisticLockingException

> ID：10401082
> 
> 赞同：3
> 
> 时间：2012-05-01T16:45:16.920
> 
> 标签：objective-c, exception, core-data, ios4, locking

如何对控制台中收到的 _NSCoreDataOptimisticLockingException 消息进行故障排除？或调试它？

我正在使用后台线程来更新核心数据上下文，并且我正在将主线程上的上下文与主线程对象合并，但是我收到了这些控制台消息，我无法看到它们来自哪里。

```
objc[58487]: EXCEPTIONS: catch(_NSCoreDataOptimisticLockingException)
objc[58487]: EXCEPTIONS: unwinding through frame [ip=0x2235ec7 sp=0xb08e8a10] for exception 0x3dd42950
objc[58487]: EXCEPTIONS: unwinding through frame [ip=0x22622a6 sp=0xb08e8ad0] for exception 0x3dd42950
objc[58487]: EXCEPTIONS: handling exception 0x3dd42950 at 0x226234a
objc[58487]: EXCEPTIONS: finishing handler 
```

@jonusx 的第一个答案谈到使用嵌套上下文来处理这种情况，但是当针对 iOS 4 SDK 时，可以做些什么来调试这些异常呢？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T04:49:28.820

该错误来自无法从两个上下文正确合并的更改。你到底是怎么做你的背景的？您应该尝试使用新的 iOS 5 嵌套上下文进行后台保存。父级可以在私有队列中，而子级（后台上下文）在线程限制队列中。子节点的保存被推送到主上下文。在后台完成后，只需保存父上下文以将更改保存到磁盘。

# python - 我应该继续使用 os 模块清除屏幕还是使用子进程？

> ID：10401084
> 
> 赞同：0
> 
> 时间：2012-05-01T16:45:33.257
> 
> 标签：python, python-2.7

所以，我的问题是我是否应该`os.system('cls')`在 python 命令行程序中使用清除命令行输出。我通常使用`os`模块方式，但是，我读过使用子进程模块是调用命令行的更好选择。一般来说，我应该使用哪个？如果我确实使用子流程方式，我将如何去做，因为我对模块的经验很少，即使我已经尝试阅读文档。预先感谢您的回复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T16:50:49.567

如果您想使用`subprocess`模块来调用`cls`而不是`os.system()`，只需：

```
import subprocess
subprocess.call("cls", shell=True) 
```

如果您想要更复杂的内容，请参阅[*子流程*文档](http://docs.python.org/library/subprocess.html)。

# android - 可以在同一行上创建布局和视图翻转器吗？

> ID：10401101
> 
> 赞同：0
> 
> 时间：2012-05-01T16:46:24.907
> 
> 标签：android, android-layout

![在此处输入图像描述](../Images/9a591a71e21a2f8167c6970d23e373fb.png)可以通过以下方式创建屏幕吗？

![画面][2]

当我更改页面时，每个页面上都会显示相同的布局

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T16:52:09.490

是的，布局是可能的：

```
<RelativeLayout android:layout_width="fill_parent"
       android:layout_height="fill_parent">
   <ViewFlipper android:layout_width="fill_parent"
       android:layout_height="fill_parent">
   </ViewFlipper>
   <!-- I assumed your layout at the top-left corner is a LinearLayout, otherwise replace it with what you have --> 
   <LinearLayout android:layout_width="wrap_content" 
       android:layout_height="wrap_content"
       android:layout_alignParentTop="true" 
       android:layout_alignParentLeft="true"
       android:id="@+id/firstLayout">
   </LinearLayout>
   <TextView android:layout_width="wrap_content" 
    android:layout_height="wrap_content" 
    android:layout_toRightOf="@id/firstLayout"
    android:layout_margin="5dp"/>
</RelativeLayout> 
```

**编辑：**

您的问题有点模棱两可，如果您只想在布局中的元素`TextView`附近添加一个，然后添加并设置它的属性（有一些边距以放置一些间隙）。检查上面布局中的修改。如果您希望像在图片中那样垂直居中（考虑到 的高度），那么您可以将and包裹在其中（宽度和高度设置为）并与父级中的顶部和左侧对齐。`Layout``TextView``toRightOf``TextView``Layout``Layout``TextView``LinearLayout``wrap_content``RelativeLayout`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T17:34:20.767

你的问题不是很清楚，但我怀疑你正在寻找的正是 Kursprog 给你的，除了你想把左上角布局和文本视图放入包装器线性布局中，所以你的 xml 看起来像this（减去所有属性）。

```
<RelativeLayout>  <!--Parent -->
   <ViewFlipper/>
   <LinearLayout android:orientation="horizontal"><!-- wrapper to your two top layouts 
      <LinearLayout/> <!-- whatever layout it is that you're describing in your diagram -->
      <TextView/> <!-- the text view in your diagram -->
   </LinearLayout>
</RelativeLayout> 
```

您需要为包装器指定宽度 fill_parent 并将两个内部元素的 layout_weight 设置为 1，以便它们均匀分布在屏幕上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-23T14:31:46.107

我用 FrameLayout 解决了这个问题。FrameLayout 允许重叠视图

# facebook - 添加“操作”参数以在墙上上传照片

> ID：10401105
> 
> 赞同：1
> 
> 时间：2012-05-01T16:46:40.967
> 
> 标签：facebook, facebook-graph-api

我使用 php sdk 3 在粉丝页面上发布我的帖子，并在每个帖子中添加一个操作链接，是否也可以在上传的照片中添加一个操作链接？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T19:26:12.203

不，操作链接仅对提要故事有效，不适用于任何其他内容类型

# cocoa - 从 NSTask 运行的程序中阻止标准输出

> ID：10401109
> 
> 赞同：0
> 
> 时间：2012-05-01T16:47:03.010
> 
> 标签：cocoa, redirect, nstask

我正在使用 NSTask 和 setStandardOutput 将命令行工具的标准输出重定向到我的程序，因此我可以使用它进行处理。这很好用，但是当我运行我的程序时，工具的输出会显示为输出。我想完全重定向它，所以它只转到我指定的 NSPipe 对象。

这可能吗？下面的示例显示了输出标准输出，但我也想使用标准错误来执行此操作。

```
NSTask *ls=[[NSTask alloc] init];
NSPipe *pipe=[[NSPipe alloc] init];
NSFileHandle *handle;
NSString *string;

[ls setLaunchPath:@"/bin/ls"];
[ls setArguments:[NSArray arrayWithObjects:@"-l",@"/System",nil]];
[ls setStandardOutput:pipe];
handle=[pipe fileHandleForReading];

[ls launch];

string=[[NSString alloc] initWithData:[handle readDataToEndOfFile]
    encoding:NSASCIIStringEncoding]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T17:05:26.700

我做了一些更多的测试，发现上面的代码做了我想要的，而且我的程序运行时没有显示输出，所以看起来我毕竟没有问题。（：

# python - 使用 Beautiful Soup 将 CSS 属性转换为单个 HTML 属性？

> ID：10401110
> 
> 赞同：2
> 
> 时间：2012-05-01T16:47:05.210
> 
> 标签：python, html, css, html-parsing, beautifulsoup

我正在尝试编写一个程序，该程序将采用 HTML 文件并使其对电子邮件更友好。现在所有的转换都是手动完成的，因为没有一个在线转换器能完全满足我们的需要。

这听起来像是一个很好的机会，可以突破我的编程知识极限并实际编写一些有用的代码，所以我提出在业余时间尝试编写一个程序，以帮助使过程更加自动化。

我对 HTML 或 CSS 了解不多，所以我主要依靠我的兄弟（他知道 HTML 和 CSS）来描述这个程序需要做出哪些改变，所以如果我问了一个愚蠢的问题，请多多包涵。这对我来说是全新的领域。

大多数更改都是非常基本的——如果您看到标记/属性 X，然后将其转换为标记/属性 Y。但是在处理包含样式属性的 HTML 标记时遇到了麻烦。例如：

```
<img src="http://example.com/file.jpg" style="width:150px;height:50px;float:right" /> 
```

只要有可能，我想将样式属性转换为 HTML 属性（或将样式属性转换为对电子邮件更友好的东西）。所以转换后它应该是这样的：

```
<img src="http://example.com/file.jpg" width="150" height="50" align="right"/> 
```

现在我意识到并不是所有的 CSS 样式属性都有 HTML 等价物，所以现在我只想关注那些有的。我编写了一个 Python 脚本来进行这种转换：

```
from bs4 import BeautifulSoup
import re

class Styler(object):

    img_attributes = {'float' : 'align'}

    def __init__(self, soup):
        self.soup = soup

    def format_factory(self):
        self.handle_image()

    def handle_image(self):
        tag = self.soup.find_all("img", style = re.compile('.'))
        print tag
        for i in xrange(len(tag)):
            old_attributes = tag[i]['style']
            tokens = [s for s in re.split(r'[:;]+|px', str(old_attributes)) if s]
            del tag[i]['style']
            print tokens

            for j in xrange(0, len(tokens), 2):
                if tokens[j] in Styler.img_attributes:
                    tokens[j] = Styler.img_attributes[tokens[j]]

                tag[i][tokens[j]] = tokens[j+1]

if __name__ == '__main__':
    html = """
    <body>hello</body>
    <img src="http://example.com/file.jpg" style="width:150px;height:50px;float:right" />
    <blockquote>my blockquote text</blockquote>
    <div style="padding-left:25px; padding-right:25px;">text here</div>
    <body>goodbye</body>
    """
    soup = BeautifulSoup(html)
    s = Styler(soup)
    s.format_factory() 
```

现在这个脚本可以很好地处理我的特定示例，但它不是很健壮，我意识到当与现实世界的示例对比时，它很容易崩溃。我的问题是，我怎样才能使它更健壮？据我所知，Beautiful Soup 无法更改或提取样式属性的各个部分。我想这就是我想要做的。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-09T13:44:23.983

对于这种类型的事情，我建议将 HTML 解析器（如 BeautifulSoup 或 lxml）与专门的 CSS 解析器结合使用。我[在 cssutils package](http://pypi.python.org/pypi/cssutils/)上取得了成功。与尝试提出正则表达式来匹配您可能在野外找到的任何可能的 CSS 相比，您将拥有更轻松的时间。

例如：

```
>>> import cssutils
>>> css = 'width:150px;height:50px;float:right;'
>>> s = cssutils.parseStyle(css)
>>> s.width
u'150px'
>>> s.height
u'50px'
>>> s.keys()
[u'width', u'height', u'float']
>>> s.cssText
u'width: 150px;\nheight: 50px;\nfloat: right'
>>> del s['width']
>>> s.cssText
u'height: 50px;\nfloat: right' 
```

因此，使用它，您可以非常轻松地提取和操作所需的 CSS 属性，并使用 BeautifulSoup 直接将它们插入 HTML。不过，请注意属性中弹出的换行符`cssText`。我认为 cssutils 更适合将内容格式化为独立的 CSS 文件，但它足够灵活，可以主要用于您在这里所做的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-16T09:21:02.870

而不是重新发明轮子使用石器包[http://pypi.python.org/pypi/StoneageHTML](http://pypi.python.org/pypi/StoneageHTML)

# javascript - Javascript 对象方法和绑定函数

> ID：10401113
> 
> 赞同：0
> 
> 时间：2012-05-01T16:47:13.767
> 
> 标签：javascript, jquery

我正在寻求帮助，因为我认为我不太了解 Javascript 范围规则。我在下面的示例中尝试做的是在页面上按下一个按钮，然后开始监听键盘输入。一旦键盘输入开始，如果输入中断两秒钟，我想停止捕获输入并弹出一个警报，其中包含收集到该点的输入的全部内容。这是我纯粹为这个问题做的一个例子。

我看到的是我单击按钮并开始输入输入。在每次按键时，都会提醒我收集到该点的字符串。两秒钟后，无操作超时发生，我看到一条内容为“未定义”的警报。上面列出的第一个警报来自 startLog()。第二个警报来自 stopLog()。当我调用 stopLog 告诉我 this.message 未定义时，我做错了什么？

```
function Logger() {
    this.message = '';
    this.listenTimer;

    this.startLog = function() {
        this.message = '';
        $(document).bind('keypress', {this_obj:this}, function(event) {
            event.preventDefault();
            var data = event.data;
            clearTimeout(data.this_obj.listenTimer);
            data.this_obj.message += String.fromCharCode(event.which);
            alert(data.this_obj.message);
            data.this_obj.listenTimer = setTimeout(data.this_obj.stopLog, 2000);
        });
    };

    this.stopLog = function() {
        $(document).unbind("keypress");
        alert(this.message);
    };
}

var k = new Logger();
$('.logging-button').click(function() {
    k.startLog();
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T16:50:49.297

问题是`this`。当您将对象方法作为事件处理程序传递时，它会丢失其对象上下文；`this`将引用`window`对象。

有多种方法可以解决此问题，但主要问题是您需要传递`setTimeout`一个仍将引用正确上下文的闭包：

```
setTimeout(function() { data.this_obj.stopLog() }, 2000); 
```

另外，您可以通过使用闭包来引用对象来节省一些不必要的代码，而不是将其绑定为`event.data`：

```
this.startLog = function() {
    this.message = '';
    var this_obj = this;
    $(document).bind('keypress', function(event) {
        event.preventDefault();
        clearTimeout(this_obj.listenTimer);
        // etc
    });
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T17:04:50.433

```
var k = new Logger();

$('.logging-button').click(function() {
    k.startLog.apply(this); 
    //Setting context of "this" so that it refers to element even in startLog()
}); 
```

# mysql - MySQL更改表中的所有列

> ID：10401116
> 
> 赞同：0
> 
> 时间：2012-05-01T16:47:30.430
> 
> 标签：mysql

我有 4 个表。每个表中都有具有相同名称的列。例如，每个表都有“id”列。

这些使得 PHP 中的数组很糟糕。

解决我的问题的方法是在列名前加上表名。

是否有一条 MySQL 语句会在表名中的每一列的开头添加“名称”？例如，表中的`id`字段`people`将变为`peopleid`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T16:49:16.970

当您进行选择时，您可以为该列指定一个别名。

```
SELECT id AS 'PeopleID' FROM People 
```

# c# - 抽象类可以包含公共方法吗？

> ID：10401121
> 
> 赞同：3
> 
> 时间：2012-05-01T16:47:54.783
> 
> 标签：c#, abstract-class

an 的构造函数`abstract` `class`should not be `public`，它们应该是`protected`。我的问题是关于方法的`abstract` `class`。出于同样的原因，我们可以将它们声明为`public`还是应该声明它们？`protected`

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-01T16:53:34.840

`abstract`类型的构造函数的理由`protected`是，除了派生类型之外，根本没有其他实体可以调用构造函数。在这种情况下，构造构造函数`public`是没有意义的，因为它永远不能在类型层次结构之外调用。因此，建议使用`protected`它，因为它是最合适的访问修饰符。

相同的逻辑不适用于该类型的其他成员。如果它们的访问修饰符允许，它们可以从类型层次结构外部自由调用。

```
public abstract class Dog {

  // Public is appropriate here as any consumer of Dog could access
  // Breed on an instantiated object
  public abstract string Breed { get; }

  // Public would be meaningless here. It's not legal to say 
  // 'new Dog' because 'Dog' is abstract. You can only say 
  // 'new Poodle' or 'new Bulldog'.  Only derived types like
  // Poodle or Bulldog could invoke the Dog constructor hence it's
  // protected
  protected Dog() { }
}

public class Poodle : Dog { } 
public class Bulldog : Dog { } 
```

特定成员是否应该`public`或`protected`高度依赖于特定 API。`abstract`类型的推理应该与非抽象类型的推理完全相同

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-01T16:54:28.707

抽象类不应该有公共构造函数，因为它们没有意义。抽象类是不完整的，因此允许公共构造函数（任何人都可以调用）将不起作用，因为无论如何您都无法实例化实例。

抽象类的方法是另一回事。您可以在抽象类中实现，这是所有子类都将继承的行为。想想一个 Shape 类。它的目的是在屏幕上绘制一个形状，因此公开一个 Draw 方法是有意义的，因为您希望调用者能够要求您的 Shape 进行绘制。方法本身可以是抽象的，强制子类实现，或者可能提供一个允许或不允许覆盖的实现。这取决于您的类的定义行为应该是什么。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-01T16:54:07.133

这取决于您的用例。如果您希望派生类的实例可以看到抽象类的方法，您应该将它们设为公开。另一方面，如果您希望这些方法仅对您的派生类可见，则应使它们受到保护。

# javascript - 仅当一行先前的输入不为空时，如何在单击时获取新的表行？

> ID：10401123
> 
> 赞同：1
> 
> 时间：2012-05-01T16:48:00.453
> 
> 标签：javascript

**仅当一行先前的**输入不为空时，如何在单击时获取新行？

* *“一行先前的输入” - 我有 1 行空白输入，只要我点击它，就会创建下一行，但我第一行将是空的或部分满的，而不是我不想创建一个新行。*

以下代码是我到目前为止所拥有的：
- 在加载时创建的第一行
- 当单击输入时创建新行
- 可以使用 checkempty 函数

```
<!DOCTYPE html PUBLIC "-//W3C//Dtd XHTML 1.0 Transitional//EN" "http://www.w3.org/tr/xhtml1/Dtd/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>GE Watch</title>
<style type="text/css">
input{width:76px;height:20px;padding:0;margin:0;display:block;float:left}table{padding:0;margin:0;border:thin dotted #333}tr{padding:0;margin:0}td{width:80px;height:20px;padding:0;margin:0;text-align:center}
</style>
<script language="javascript" type="text/javascript">

function addRow(id){

    var tbody = document.getElementById
    (id).getElementsByTagName("tbody")[0];
    var row = document.createElement("tr")

    var RowCount = 11;
    for (i = 1; i <= RowCount; ++i) {
        var td = document.createElement("td")

        td.appendChild(document.createElement("input"))
        td.id = "td" + i;

        td.setAttribute("onclick", "javascript:addRow('myTable');")
        row.appendChild(td);
    }
    tbody.appendChild(row);
}

function checkempty() {
    checking = document.getElementById(cellId);

    if (checking.value == "" || " " || null) {
        return false;
    } else {
        return true;
    }
}

</script>
</head>
<body onLoad = "javascript:addRow('myTable')">
<a href="javascript:addRow('myTable')">Add row</a>
<table id="myTable">
  <tr>
    <td>#</td>
    <td>CHECK</td>
    <td>DATE</td>
    <td>HOUR</td>
    <td>MIN</td>
    <td>MARKET</td>
    <td>MAX</td>
    <td>BUY</td>
    <td>SELL</td>
    <td>PROFIT</td>
    <td>FLIP TIME</td>
  </tr>
</table>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T18:29:57.203

补充一下保罗所说的——你有很多问题

一、你遇到的问题

1) 加载 = ....

永远不要设置 onload 事件，而是添加到它。阅读[https://stackoverflow.com/a/10017532/643500](https://stackoverflow.com/a/10017532/643500)

2) setAttribute 与点击

```
button_element.setAttribute('onclick','doSomething();'); // for FF  
button_element.onclick =   function() {doSomething();}; // for IE 
```

3）将onclick设置为行而不是每个单元格

对于解决方案：

步骤是：

1）用户点击一行，获取上一行——或所有行，不确定你想要什么

```
if(elem.previousSibling != null){
        while (elem.previousSibling.tagName == 'TR') {
           ...
        }
} 
```

2）检查该行中的每个单元格

```
if(elem.previousSibling != null){
        while (elem.previousSibling.tagName == 'TR') {
           var cells = elem.previousSibling.childNodes;
           for(i = 0 ; i < cells.length; i++){
               if(!checkIfEmpty(cells[i])){
                  canInsertRow = true;
               }    
           }
           elem = elem.previousSibling;
        }
} 
```

这是一个不完整的 jsfiddle .. 我只是用它来弄乱你的代码——不是在 writeCode 模式下写这一切，但你应该理解这个概念[http://jsfiddle.net/mHgms/12/](http://jsfiddle.net/mHgms/12/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T20:23:44.903

这是一个使用 jquery 的快速示例（在 ff 11 && chrome 中快速测试）：

```
<!DOCTYPE html PUBLIC "-//W3C//Dtd XHTML 1.0 Transitional//EN" "http://www.w3.org/tr/xhtml1/Dtd/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>GE Watch</title>
<style type="text/css">
body{
    padding:0px;
    margin:0px;
    font-size:11px;
    color:#333;
    font-family:Arial;
    background:#efefef;
    text-align:center;
}
#content{
    width:600px;
    padding:15px;
    margin:20px auto;
    background:#fff;
    border:solid 1px #ddd;
    text-align:left;
}

table{
    width:100%;
    padding:0;
    margin:0;
    border:solid 1px #ddd;
    border-collapse:collapse;
}

tr{
    padding:0;
    margin:0
}

td{
    width:80px;
    height:20px;
    padding:4px;
    margin:0;
    border:solid 1px #ebebeb;
    text-align:center
}

table#myTable td input[type="text"]{
    padding:2;
    margin:0;
    display:block;
    border:solid 1px #ddd;
}
table#myTable td input[type="text"].incomplete{
    border:solid 1px #ff0000;
}

th{
    font-size:11px;
    border:solid 1px #ddd;
    background:#efefef;
    text-align:center;
    color:#999;
}

#addRow{
    padding:3px;
    width:80px;
    text-align:center;
    text-decoration:none;
    background:#0000ff;
    color:#fff;
    margin:10px 0px;
    font-weight:bold;
    font-size:10px;
    display:inline-block;
}

#message{
    color:#DB1925;
    padding:4px;
    font-size:10px;
    font-weight:bold;
    border:dotted 1px #DB1925;
    background:#FFBABA;
    display:inline-block;
    opacity:0;
}
</style>

</head>
<body>

<div id="content">

    <a href="javascript:" id="addRow">Add row</a>

    <span id="message">Please complete inputs that are in red</span>

    <br style="clear:both"/>

    <table id="myTable">
        <thead>
            <tr>
              <th>CHECK</th>
              <th>DATE</th>
              <th>HOUR</th>
            </tr>
        </thead>

        <tbody>
        </tbody>

    </table>

</div>

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js"></script>

<script language="javascript" type="text/javascript">

    var rowTemplateHTML = '<tr class="dataRow"><td><input type="text" value=""/></td><td><input type="text" value=""/></td><td><input type="text" value=""/></td></tr>';

    $(document).ready(function(){

        var $tableBody    = $('#myTable'),
            $addRowButton = $('#addRow'),
            $message      = $('#message');

        $addRowButton.click(function(event){
            event.preventDefault();
            $('.incomplete').removeClass('incomplete');
            addRow();
        });

        function addRow(){
            if(previousRowNotEmpty()){
                $message.css("opacity", "0");
                $tableBody.append(rowTemplateHTML);
            }else{
                //alert('please complete previous row');
                $message.animate({
                    "opacity" : "1"
                }, 50);
            }
        }

        function previousRowNotEmpty(){
            var rowComplete = true;
            $tableBody.find('tr.dataRow:last').find('input[type="text"]').each(function(index, input){
                var $input = $(input);
                if($input.val() === ""){
                    $input.addClass('incomplete');
                    rowComplete = false;    
                }
            });
            return rowComplete;
        }

        function addFirstRow(){
            $tableBody.append(rowTemplateHTML);
        }

        addFirstRow();
    })

</script>

</body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T17:46:40.037

首先，您的`checkempty`函数需要接受一个参数，例如：`checkempty(cellId)`

其次，您的`addrow`函数应该为输入元素提供 ID 和名称，否则您将无法以足够的方式处理表单。还要为行提供 id 或数据属性。

第三，如果你有你的`addrow`函数来做到这一点，你只需要获取最后一行，从数据属性中提取行 id 并使用它来遍历该行中的所有输入元素。如果至少一个输入元素的值不为空，您的脚本可以添加一个新行。

# c - struct：存储大小未知，或变量未声明

> ID：10401126
> 
> 赞同：1
> 
> 时间：2012-05-01T16:48:18.543
> 
> 标签：c

我想调用一个`low_level_init`有签名的函数

```
void low_level_init(struct netif *netif) 
```

我努力了

```
struct netif dummy;
low_level_init(&dummy); 
```

但我得到了错误

> 'dummy' 的存储大小未知

我也尝试过（如建议[here](https://stackoverflow.com/questions/7772897/storage-size-of-struct-isnt-known-c)）

```
extern struct netif dummy;
low_level_init(&dummy); 
```

但后来我得到了错误

> 错误：未声明“虚拟”（在此函数中首次使用）

我怎么打电话`low_level_init`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T16:50:48.773

包括定义该结构的头文件。否则编译器无法知道要保留多少空间。

# node.js - Node.js 非阻塞行为的新手查询

> ID：10401127
> 
> 赞同：0
> 
> 时间：2012-05-01T16:48:22.910
> 
> 标签：node.js, nonblocking, event-based-programming

一直在关注这个精彩的[教程](http://www.nodebeginner.org/#continuereading)。作为 Javascript 和函数式编程的新手，我想了解非阻塞的本质含义。我故意在我的 JS 代码中添加了 10 秒的“睡眠”，以实现阻塞行为。

```
 function route(pathname, handle)
{
    console.log("About to route a request for :"+pathname);

    if(typeof handle[pathname]==='function')
    {
        handle[pathname]();
    }
    else
    {
        console.log("No request handler for "+pathname);
    }

    sleep(10000);
    console.log("Exiting router");
}

function sleep(milliSeconds)
{
    var startTime = new Date().getTime(); // get the current time
    while (new Date().getTime() < startTime + milliSeconds); // hog cpu
}

exports.route=route; 
```

此代码被用作另一个“服务器”脚本的回调，我从浏览器调用该脚本。我希望一旦我同时向我的服务器脚本发出 100 个请求，我会在 10 秒后得到并行的 100 个响应。但是这段代码会一一遍历请求。这肯定失败了 node.js 背后的哲学，对吗？？当我在 Java servlet 中编写如此糟糕的代码并在 Tomcat 上运行时，这甚至不会发生！

在这种情况下的另一个观察结果是请求没有按时间顺序处理 - 它们是随机执行的。这对我来说听起来不太好！！

我相信我的代码存在一些问题 - 请帮助我理解这里的概念，并回答我的 2 个查询（另一个关于年表的查询）。

谢谢 ！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T16:58:14.777

> 我希望一旦我同时向我的服务器脚本发出 100 个请求，我会在 10 秒后得到并行的 100 个响应。但是这段代码会一一遍历请求。

是的。Node 严格来说是单线程的，因此每个请求都将串行运行。JavaScript 代码中没有并行性（尽管计算机的底层 I/O 子系统可能是并行执行的）。

> 这肯定不符合 node.js 背后的理念，对吧？

不会。node.js 的理念是在 I/O 事件准备好执行时尽快执行事件处理程序。

请注意，您的“睡眠”功能并没有真正睡眠，而是与 CPU 挂钩 - 因为节点是单线程的，所以所有其他操作都会阻塞 CPU 处理代码 - 如果您的代码正在执行一些实际的 CPU 密集型操作，也会发生同样的情况. 但是，如果您的代码改为执行 I/O 操作（并且设计正确），那么 node 将围绕您的 I/O 阻塞代码安排其他操作。这样想 - node.js 防止代码阻塞 I/O，而不是阻塞 CPU 使用。如果您的代码是 CPU 密集型的，并且您担心它会阻塞其他处理程序，那么您必须将其设计为让给事件循环以让其他处理程序运行。

> 在这种情况下的另一个观察结果是请求没有按时间顺序处理 - 它们是随机执行的。

是的，这是可能的。您必须记住，node.js 本质上只是一种将“事件处理程序”附加到感兴趣的 I/O 事件的方法。这些 I/O 事件由底层操作系统中的操作触发（例如，已建立套接字连接、已完成文件读取等），并且 node.js 会调用您的处理程序作为响应。

由于操作系统会自己“内部记账”关于事情何时实际发生以及何时认为它们可用于“用户空间”进程，因此您期望它们发生的时间与计算机说它们实际发生的时间之间可能存在差异. 此外，我不认为该节点（甚至操作系统）在调度事件时保证“公平”。

# iphone - OpenEars - 第一次触发 Flite 时未调用 fliteDidFinishSpeaking

> ID：10401128
> 
> 赞同：0
> 
> 时间：2012-05-01T16:48:24.183
> 
> 标签：iphone, xcode, openears

一个列表，因为它更容易编写：

• 音乐开始播放
• 跳到下一首
歌曲 • Flite 说出歌曲标题
•`fliteDidFinishSpeaking`不响——为什么？
• 点击播放开始播放音乐——`[musicPlayer play];`在失败方法的末尾
• 跳到下一首曲目（或只是等待歌曲结束）
• Flite 说出最后一首歌曲的标题——不接受新参数`say:`
•音乐重新启动 -- 从此时起，Flite 没有问题
• 跳到下一首曲目
• Flite 说话正常
• 音乐重新启动

这仅在应用程序首次启动时发生，因此初始化有问题，无论是在我的代码中还是在 OpenEars/Flite 本身中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T15:15:11.117

蛮力似乎运作良好：

```
- (void)fliteWillStartSpeaking {
    [self resetFliteController];
    [fliteController say:@"some words" withVoice:curVoice];

    fliteDidFinish = NO;
    fliteFinishTimer = [NSTimer scheduledTimerWithTimeInterval:kFliteTimerCycle
                         target:self selector:@selector(forceFliteDidFinish)
                         userInfo:nil repeats:NO];
}

- (void)forceFliteDidFinish {
    if (!fliteDidFinish) {
        [self fliteDidFinishSpeaking];
    }

    [fliteFinishTimer invalidate];
} 
```

如果有人找到一个适当的修复将是理想的。

# javascript - 让我的 jquery 选项卡式浏览更智能

> ID：10401129
> 
> 赞同：1
> 
> 时间：2012-05-01T16:48:33.207
> 
> 标签：javascript, jquery

我整理了一个非常简单的选项卡式浏览器，您可以在此处查看 [http://jsfiddle.net/zandergrin/sN2Eu/](http://jsfiddle.net/zandergrin/sN2Eu/)

我只是想知道是否有一种方法可以使脚本更智能，以便自动处理所有编号 - 即我可以添加一个新选项卡并且不需要添加新的 javascript。

我知道我可以用 jquery ui 做到这一点，但是 a) 我试图保持它超轻量级，更重要的是，b) 我正在努力学习！

谢谢 - 我的 javascript 非常基础，所以任何解释都将不胜感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T17:09:04.530

您需要向每个选项卡添加一个 comman 类，以便您可以选择所有选项卡和一个唯一 id，该 id 也是`href`链接中的值。还要为所有链接添加一个公共类..

```
<div class="tab-nav">
     <ul>
         <li><a href="#tab1" class="tabclick active">Overview</a></li>
         <li><a href="#tab2" class="tabclick">Specs</a></li>
         <li><a href="#tab3" class="tabclick">More Info</a></li>
     </ul>
</div>

<div id="tab1" class="tab">
    <p>content1</p>
</div>

<div id="tab2" class="tab" style="display: none">
    <p>content2</p>
</div>

<div id="tab3" class="tab" style="display: none">
    <p>content3</p>
</div> 
```

你的javascript现在可以

```
function tabActions(e) {
    // e.preventDefault(); // stop default browser action of link will not add the hash to the url

    var targetId = $(this).attr('href'); // extract the value in the href (the #tab1 for example)

    $('.tabclick').removeClass('active'); // remove the active class from all links (find them by their common class)
    $(this).addClass('active'); // add it to the currently clicked link

    $('.tab').hide(); // find all tabs (by the common class) and hide them
    $(targetId).show(); // show the current tab 
};

$('.tabclick')
    .click(tabActions) // bind handler
    .filter(function(){ // find the link that points to the hash in the url
        return this.hash == window.location.hash;
    })
    .click(); // manually trigger click on it 
```

演示在[http://jsfiddle.net/gaby/sN2Eu/3/](http://jsfiddle.net/gaby/sN2Eu/3/)

# c# - 无法到达 in xml file using XmlDocument

[问问题](https://stackoverflow.com/questions/ask)问问题 2012-05-01T16:48:53.650583 次This question shows research effort; it is useful and clear0This question does not show any research effort; it is unclear or not usefulBookmark this question.Show activity on this post.

trying to get to `<style>` to modify it, but I can't get any further than `<layouts>`, here is my code:

```
XmlDocument doc = new XmlDocument();
doc.Load(fi.FullName);

XmlNamespaceManager nsmgr = new XmlNamespaceManager(doc.NameTable);
nsmgr.AddNamespace("rep", "http://developer.cognos.com/schemas/report/8.0/");

XmlNodeList nodeList = doc.SelectNodes("descendant::rep:layouts", nsmgr);

foreach (XmlNode node in nodeList)
{
 Console.WriteLine(node.Name);
 //XmlNode styleNode = node.SelectSingleNode("style");
 //if (styleNode != null)
 // Console.WriteLine(styleNode.InnerText);

} 
```

So, this works `("descendant::rep:layouts")`, I get to see `(Console.WriteLine=) "layouts"`. But if I try to get further, even if one node at a time, `(descendant::rep:layouts/layout/reportPages/page/pageBody/contents/crosstab/style)`, there is no single node in the list.. please help!!! My ultimate goal is to modify the "CSS style".

XML file is below (pasted from comment):

```
<report xmlns= developer.cognos.com/schemas/report/8.0/">
 <queries> 
<layouts> <layout> <reportPages> 
 <page name="Page1"> <pageBody> <contents>
 <block> <contents> <block> <crosstab name="Crosstab1" refQuery="Query1"> 
 <style> 
 <CSS value="border-collapse:collapse;font-family:'Times New Roman';border:0.75pt solid black" /> <defaultStyles> 
 </style> 
```

[c#](/tags/c# "show questions tagged 'c#'")[xml-namespaces](/tags/xml-namespaces "show questions tagged 'xml-namespaces'")[xmldocument](/tags/xmldocument "show questions tagged 'xmldocument'")[xmlnode](/tags/xmlnode "show questions tagged 'xmlnode'")4

## 1 回答 1

This answer is useful0

Most likely all other nodes have some non-empty namespaces (note that empty prefix does not mean "no namespace"). One would need to see XML for better answer.

Yes all your nodes are have "[how to ignore namespaces with XPath](https://stackoverflow.com/questions/4440451/how-to-ignore-namespaces-with-xpath)" set as default namespace, so no nodes have it as prefix. If you want to learn more - click on "xml-namespaces" tag for details. Otherwise use following to ignore namespaces [how to ignore namespaces with XPath](https://stackoverflow.com/questions/4440451/how-to-ignore-namespaces-with-xpath) or prefix node names with namespace prefix as you've done for `layouts` one:

```
XmlNode styleNode = node.SelectSingleNode("rep:style", nsmgr); 
```

于 2012-05-01T16:55:01.110 回答

#### Related

[1](/questions/19603120 "Question score (upvotes - downvotes)")[python - python：避免列表的zip截断](/questions/19603120)[1](/questions/19603122 "Question score (upvotes - downvotes)")[javascript - Twitter Bootstrap v3.0.0 不显示模态组件](/questions/19603122)[3](/questions/19603125 "Question score (upvotes - downvotes)")[c# - 从设置的对象中获取字段](/questions/19603125)[1](/questions/19603129 "Question score (upvotes - downvotes)")[c# - wpf Datagrid：wpf datagrid中的组合框集成](/questions/19603129)[2](/questions/19603130 "Question score (upvotes - downvotes)")[ios - 如何在另一个静态库中添加一个静态库 .a 文件](/questions/19603130)[1](/questions/19603133 "Question score (upvotes - downvotes)")[c# - 为什么在启动后台工作程序时它在下载文件时永远不会进入计时器滴答事件？](/questions/19603133)[2](/questions/19603141 "Question score (upvotes - downvotes)")[css - 透明滚动条](/questions/19603141)[2](/questions/19603153 "Question score (upvotes - downvotes)")[php - 如何使用 PHP 调用 VOICECLOUD API](/questions/19603153)[1](/questions/19603154 "Question score (upvotes - downvotes)")[jquery - maintaining order of the ajax request in jquery's $.each()](/questions/19603154)[1](/questions/19603157 "Question score (upvotes - downvotes)")[ios - 应用程序标题与 iOS 7.x 中的 iphone 元数据合并](/questions/19603157)

#### Reference

[php](https://php.github.net.cn) × 1429865[c/c++](https://c-cpp.com) × 756500[nginx](https://nginx.github.net.cn) × 49975[mongodb](https://mongodb.net.cn) × 159057[mybatis](https://mybatis.net.cn) × 3233[anaconda](https://anaconda.org.cn) × 13410[pycharm](https://pycharm.net.cn) × 14671[python](https://python.github.net.cn) × 1902243[vscode](https://vscode.github.net.cn) × 56040[docker](https://dockerdocs.cn) × 110988[github](https://github.net.cn) × 49000[flask](https://flask.github.net.cn) × 49129[ffmpeg](https://ffmpeg.github.net.cn) × 24037[jmeter](https://jmeter.net) × 16910[matplotlib](https://matplotlib.net) × 63493[bootstrap](https://getbootstrap.net) × 54641[](https://stackoverflow.com)

##### [Stack Overflow 中文网](https://stackoverflow.org.cn)

遵从 CC BY-SA 知识共享许可协议。

> ID：10401133
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

# spring-security - 无法使用 X.509 证书和匿名用户配置 Spring Security

> ID：10401149
> 
> 赞同：0
> 
> 时间：2012-05-01T16:50:16.710
> 
> 标签：spring-security

我正在尝试通过 X.509 智能卡对我的应用程序进行身份验证。目前，我的应用程序没有定义任何用户，所以我正在尝试使用匿名身份验证。创建用户后，我会将其切换为 hasRole()。

```
<security:authentication-manager alias="authenticationManager">
    <security:authentication-provider user-service-ref="myUserService" />
</security:authentication-manager>

<!-- TODO: Enable this once I am ready to start annotating the service interfaces -->
<security:global-method-security pre-post-annotations="enabled" /> 

<security:http use-expressions="true" authentication-manager-ref="authenticationManager" access-denied-page="/index2.xhtml" >
    <security:anonymous enabled="true" />
    <security:x509 subject-principal-regex="CN=(.*?)," user-service-ref="myUserService" />
    <security:intercept-url pattern="/**" access="isAnonymous()" requires-channel="https" />
    <!-- TODO: configure invalid-session-url, delete sessionid -->
    <security:session-management>
        <security:concurrency-control max-sessions="2" error-if-maximum-exceeded="true"/>
    </security:session-management>
</security:http>

<bean id="roleVoter"
    class="org.springframework.security.access.vote.RoleHierarchyVoter">
    <constructor-arg ref="roleHierarchy" />
</bean>

<bean id="roleHierarchy"
    class="org.springframework.security.access.hierarchicalroles.RoleHierarchyImpl">
    <property name="hierarchy">
        <value>
            ROLE_USER > ROLE_AUTHENTICATED
            ROLE_AUTHENTICATED > ROLE_UNAUTHENTICATED
            ROLE_UNAUTHENTICATED > ROLE_ANONYMOUS
        </value>
    </property>
</bean> 
```

它似乎陷入了无限循环问题，我以为我在避免使用 isAnonymous()。

我可能犯了一个愚蠢的错误，所以如果有人能指出所说的愚蠢，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T12:19:04.867

问题是在 web.xml 中配置 FacesServlet 的问题。FacesServlet 被映射到一个路径，这似乎与为 Spring Security 定义的拦截 URL 不兼容。

我们已经抛弃了 JSF（并且摆脱了）。

# c++ - 使用 std::vector 链接错误

> ID：10401150
> 
> 赞同：0
> 
> 时间：2012-05-01T16:50:26.570
> 
> 标签：c++, vector, hyperlink, std

我在使用矢量声明时遇到问题。
这是代码：

。H

```
#ifndef ANIMATEDSPRITE_H_
#define ANIMATEDSPRITE_H_

#include "Sprite.h"
#include <vector>

//using namespace std;

class AnimatedSprite //abstract class to point sprites
{
public:
    AnimatedSprite();
    ~AnimatedSprite();

    //gets and sets
    Sprite GetMySprite(int _index);
    void SetSpriteToList(Sprite _sprite);
    int GetState() const;
    void SetState(int _state);

    //other

private:
    std::vector<Sprite> spriteList;

    int state; //estado que esse sprite representa (parado esquerda, andando direita, etc)
};

#endif 
```

.cpp

```
#include "AnimatedSprite.h"

AnimatedSprite::AnimatedSprite()
{
    spriteList.clear();
    state = NULL;
}

AnimatedSprite::~AnimatedSprite()
{

}

Sprite AnimatedSprite::GetMySprite(int _index)
{
    return spriteList[_index];
}

void AnimatedSprite::SetSpriteToList( Sprite _sprite )
{
    //Sprite* temp = new Sprite(1,2);
    spriteList.push_back(_sprite);
}

int AnimatedSprite::GetState() const
{
    return state;
}

void AnimatedSprite::SetState( int _state )
{
    state = _state;
} 
```

但我收到 2 个错误：

> 错误 1 ​​错误 LNK2019：未解析的外部符号**imp** _CrtDbgReportW 在函数“public: class Sprite & __thiscall std::vector >::operator[](unsigned int)”(??A?$vector@VSprite@@V?$allocator @VSprite@@@std@@@std@@QAEAAVSprite@@I@Z) AnimatedSprite.obj
> 
> 错误 2 致命错误 LNK1120: 1 unresolved externals C:\DevProjects\SDLSkeleton\Debug\SDLSkeleton.exe

我找到了一个从预处理器定义中删除 _DEBUG 的解决方案，但这样做似乎有点错误。
这是正确的解决方案吗？去掉有什么后果？
在我检查过的书和文档中，它应该只是一个公共变量声明，但出现了这个错误。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T16:55:07.740

这是因为您的构建不一致：您定义了 _DEBUG 宏，但与发布 CRT 版本 (/MD) 链接。所以要么删除_DEBUG，要么选择/MDd 选项。

# javascript - 使用jquery在iframe中的褪色效果

> ID：10401160
> 
> 赞同：1
> 
> 时间：2012-05-01T16:51:15.013
> 
> 标签：javascript, jquery, fadein, fading, fadeout

我正在创建一个菜单，其中单击的链接加载到具有淡入淡出效果的 iframe 中，但是，旧内容会消失，而新内容会在加载时闪烁。有谁知道如何解决这个问题？

JavaScript 代码：

```
 <script type="text/javascript">
            $(document).ready(function() {

               $('#nav a').click(function() {
                    var page = $(this).attr('href');
                    $('#content').fadeOut('slow',function() {
                    $('#content').load(page, function () {
                        $(this).fadeIn('slow');
                });
                });
          });
          });
        </script> 
```

其中 content 是 iframe 的 id。

# java - 生成网站缩略图？

> ID：10401163
> 
> 赞同：10
> 
> 时间：2012-05-01T16:51:25.203
> 
> 标签：java, swt

对于我的应用程序，我需要动态创建网站的缩略图。到目前为止，我有来自 SO 的代码：

```
public class CreateWebsiteThumbnail {

    private static final int WIDTH = 128;
    private static final int HEIGHT = 128;

    private BufferedImage image = new BufferedImage(WIDTH, HEIGHT, BufferedImage.TYPE_INT_RGB);

    public void capture(Component component) {
        component.setSize(image.getWidth(), image.getHeight());

        Graphics2D g = image.createGraphics();
        try {
                component.paint(g);
        } finally {
                g.dispose();
        }
    }

    private BufferedImage getScaledImage(int width, int height) {
        BufferedImage buffer = new BufferedImage(width, height,
                        BufferedImage.TYPE_INT_RGB);
        Graphics2D g = buffer.createGraphics();
        try {
                g.drawImage(image, 0, 0, width, height, null);
        } finally {
                g.dispose();
        }
        return buffer;
    }

    public void save(File png, int width, int height) throws IOException {
        ImageIO.write(getScaledImage(width, height), "png", png);
    }

    public static void main(String[] args) throws IOException {

        Shell shell = new Shell();
        Browser browser = new Browser(shell, SWT.EMBEDDED);
        browser.setUrl("http://www.google.com");

        CreateWebsiteThumbnail cap = new CreateWebsiteThumbnail();
        cap.capture(What her?);
        cap.save(new File("foo.png"), 64, 64);
    }

} 
```

但正如您在此处看到的，我不知道应该将浏览器的哪个部分传递给我的捕获方法。有什么提示吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-05T16:40:05.570

我不明白，您提供的代码如何工作。没有打开，`Shell`没有大小，`Browser`没有时间实际加载任何东西，似乎没有运行事件循环来启用任何绘图，...

以下代码使用 SWT 浏览器截取页面：

```
import java.io.IOException;

import org.eclipse.swt.SWT;
import org.eclipse.swt.browser.Browser;
import org.eclipse.swt.browser.ProgressEvent;
import org.eclipse.swt.browser.ProgressListener;
import org.eclipse.swt.graphics.GC;
import org.eclipse.swt.graphics.Image;
import org.eclipse.swt.graphics.ImageData;
import org.eclipse.swt.graphics.ImageLoader;
import org.eclipse.swt.layout.FillLayout;
import org.eclipse.swt.widgets.Display;
import org.eclipse.swt.widgets.Shell;

public class CreateWebsiteThumbnail {

   private static final int WIDTH  = 800;
   private static final int HEIGHT = 600;

   public static void main( String[] args ) throws IOException {
      final Display display = new Display();
      final Shell shell = new Shell();
      shell.setLayout(new FillLayout());
      final Browser browser = new Browser(shell, SWT.EMBEDDED);
      browser.addProgressListener(new ProgressListener() {

         @Override
         public void changed( ProgressEvent event ) {}

         @Override
         public void completed( ProgressEvent event ) {
            shell.forceActive();
            display.asyncExec(new Runnable() {

               @Override
               public void run() {
                  grab(display, shell, browser);
               }
            });

         }
      });
      browser.setUrl("http://www.google.com");

      shell.setSize(WIDTH, HEIGHT);
      shell.open();

      while ( !shell.isDisposed() ) {
         if ( !display.readAndDispatch() ) display.sleep();
      }
      display.dispose();
   }

   private static void grab( final Display display, final Shell shell, final Browser browser ) {
      final Image image = new Image(display, browser.getBounds());
      GC gc = new GC(browser);
      gc.copyArea(image, 0, 0);
      gc.dispose();

      ImageLoader loader = new ImageLoader();
      loader.data = new ImageData[] { image.getImageData() };
      loader.save("foo.png", SWT.IMAGE_PNG);
      image.dispose();

      shell.dispose();
   }

} 
```

但是有一些严重的警告：

*   您不能在屏幕外执行此操作。SWT 屏幕截图只是当前显示的副本。
*   截屏时，包含浏览器的窗口必须位于顶部。
*   该页面应该在 onLoad 之后可见（实际上 google.com 并非如此，但由于 asyncExec 调用对我有用——如果你得到一个白色图像，请尝试另一个 URL）
*   结果取决于您的操作系统及其安装的浏览器

我会使用非 Java 解决方案，以便摆脱屏幕绘图。我相信链接的问题可能会帮助您走得更远。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-01T19:15:38.177

据我所知，当您使用 Browser 对象时，您加载的网页会直接呈现在您通过构造函数传递给它的 Composite 对象上。在您的情况下，它呈现在您的 Shell 项目上，这是一个窗口样式的对象。没有方法可以直接在 Image 对象上呈现网页。

不过，您可以尝试在 Canvas 对象上实例化您的浏览器并直接从那里保存图像。

不幸的是，我无法测试这是否有效，因为我既没有安装 Eclipse 也没有安装 SWT；我很确定，如果你想做的是可行的，这是唯一的方法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-04T15:32:43.193

我自己做了一些实验。我的直觉是尝试`JEditorPane`就像[您的代码所基于的答案中提到的那样。](https://stackoverflow.com/a/170392/613495)我不知道它会有多少帮助，但它可能会有所帮助。我给出了一些结果，但由于显而易见的原因，css 支持等的运气`JEditorPane`看起来都很丑陋。

这是我的代码：

```
import java.awt.BorderLayout;
import java.awt.Component;
import java.awt.Graphics2D;
import java.awt.event.ActionEvent;
import java.awt.image.BufferedImage;
import java.io.File;
import java.io.IOException;
import java.net.URL;
import javax.imageio.ImageIO;
import javax.swing.*;
import javax.swing.text.html.HTMLEditorKit;

public class WebPageToImageThumbnail {

    public static void main(String[] a) throws Exception {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                JFrame frame = new JFrame();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                final JEditorPane editorPane = new JEditorPane();
                editorPane.setEditorKit(new HTMLEditorKit());
                try {
                    editorPane.setPage(new URL("http://weblogs.java.net/blog/alex2d/archive/2008/12/jwebpane_projec.html"));
                } catch (IOException ex) {
                }
                final JPanel panel = new JPanel(new BorderLayout());
                panel.add(new JScrollPane(editorPane), BorderLayout.CENTER);
                panel.add(new JButton(new AbstractAction("SAVE") {
                    @Override
                    public void actionPerformed(ActionEvent e) {
                        BufferedImage image = capture(editorPane);
                        try {
                            save(image, new File("foo.png"), 64, 64);
                        } catch (IOException ex) {
                        }
                    }
                }), BorderLayout.SOUTH);
                frame.setContentPane(panel);
                frame.setSize(600, 400);
                frame.setVisible(true);
            }
        });
    }

    public static BufferedImage capture(Component component) {
        BufferedImage image = new BufferedImage(component.getWidth(), component.getHeight(), BufferedImage.TYPE_INT_RGB);//component.setSize(image.getWidth(), image.getHeight());
        Graphics2D g = image.createGraphics();
        try {
            component.paint(g);
        } finally {
            g.dispose();
        }
        return image;
    }

    private static BufferedImage getScaledImage(BufferedImage image, int width, int height) {
        BufferedImage buffer = new BufferedImage(width, height,
                BufferedImage.TYPE_INT_RGB);
        Graphics2D g = buffer.createGraphics();
        try {
            g.drawImage(image, 0, 0, width, height, null);
        } finally {
            g.dispose();
        }
        return buffer;
    }

    public static void save(BufferedImage image, File png, int width, int height) throws IOException {
        ImageIO.write(getScaledImage(image, width, height), "png", png);
    }
} 
```

我还对`SWT`我发现了一些可能有用的想法进行了一些挖掘，但由于我目前运气好，我无法测试。从我读到的内容，我必须同意@Emanuele Bezzi (+1) 的观点，即我们将不得不以某种方式使用 Shell 来获取我们实际上只感兴趣的网站内容。

我发现[Shell](http://help.eclipse.org/indigo/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/api/org/eclipse/swt/widgets/Shell.html)有`print`一个方法可以使用[GC](http://help.eclipse.org/indigo/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/api/org/eclipse/swt/graphics/GC.html)对象，该对象可以绘制到 Image 和其他我们感兴趣的东西，文档说：*“类 GC 是 SWT 支持的所有绘图功能所在的位置。实例用于在图像、控件或直接在显示器上绘制。”* .

然而，在这个特定的时刻，我不清楚如何让它做我想做的事。无论如何，我提出这一点只是为了让你知道。我还需要进一步研究。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-04T15:33:10.823

也许您最好从一开始就将页面渲染到屏幕外。例如，对于这样的任务，您可以使用“飞碟”（仅限 xhtml，因此您需要整理一下）。似乎还有一些工具可以直接从 Java 接口 Webkit。

# python - Python字典初始化？

> ID：10401180
> 
> 赞同：5
> 
> 时间：2012-05-01T16:52:32.860
> 
> 标签：python

我不确定这是错误还是功能。我有一本要用空列表初始化的字典。

让我们说

```
keys =['one','two','three']
sets = dict.fromkeys(keys,[]) 
```

我观察到的是，如果您将任何项目附加到任何列表中，所有列表都会被修改。

```
sets = dict.fromkeys(['one','two','three'],[])
sets['one'].append(1) 
```

套

```
{'three': [1],'two': [1], 'one': [1]} 
```

但是当我使用循环手动进行时，

```
for key in keys:
      sets[key] = []
sets['one'].append(1) 
```

套

```
{'three': [], 'two': [], 'one': [1]} 
```

我认为第二种行为应该是默认行为。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-01T16:54:45.450

这就是 Python 中的工作方式。

当您`fromkeys()`以这种方式使用时，您会以对同一列表的三个引用结束。当您更改一个列表时，这三个列表似乎都发生了变化。

在这里也可以看到相同的行为：

```
In [2]: l = [[]] * 3

In [3]: l
Out[3]: [[], [], []]

In [4]: l[0].append('one')

In [5]: l
Out[5]: [['one'], ['one'], ['one']] 
```

同样，这三个列表实际上是对同一列表的三个引用：

```
In [6]: map(id, l)
Out[6]: [18459824, 18459824, 18459824] 
```

（注意他们如何拥有相同的 id）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-01T17:01:08.333

其他答案涵盖了“为什么”，这就是方法。

您应该使用理解来创建所需的字典：

```
>>> keys = ['one','two','three']
>>> sets = { x: [] for x in keys }
>>> sets['one'].append(1)
>>> sets
{'three': [], 'two': [], 'one': [1]} 
```

For Python 2.6 and below, the dictionary comprehension can be replaced with:

```
>>> sets = dict( ((x,[]) for x in keys) ) 
```

# wcf - WCF 中 DataContract 中的 ToString 方法覆盖

> ID：10401186
> 
> 赞同：3
> 
> 时间：2012-05-01T16:53:12.877
> 
> 标签：wcf, datacontract

即使我通过在类 ActivityType 中返回 ActivityType.Code 属性值来覆盖 DataContract 中的 ToString 方法。我仍然没有在客户端上获取用于绑定网格的 ActivityType.Code 属性值。能否告诉我如何将 ToString 方法提供给客户端。

这是代码库

数据合约

```
 [DataContract]
    public class Activity
    {
        [DataMember]
        public ActivityType ActivityTypeId { get; set; }
        [DataMember]
        public string Code { get; set; }
        [DataMember]
        public string Description { get; set; }
        [DataMember]
        public EntityStatus Status { get; set; }

    }
    [DataContract]
    public enum EntityStatus
    {
        [EnumMember]
        Active = 0,
        [EnumMember]
        Inactive = 1
    }

    [DataContract]
    public class ActivityType
    {
        [DataMember]
        public string Code { get; set; }
        [DataMember]
        public string Name { get; set; }
        [DataMember]
        public string Description { get; set; }

        public override string ToString()
        {
            if (Code != null)
            {
                return Code.ToString(CultureInfo.InvariantCulture);
            }
            else
            {
                return base.ToString();
            }
        }
    } 
```

服务实施

```
 public class TimeSheetManagementService : ITimeSheetManagementService
    {
        public List<BusinessEntities.Activity> GetActivities()
        {
            TimeSheetManagementDataController controller = new TimeSheetManagementDataController();

            var activities = controller.GetActivities();
            var activitiesresult = activities.Select(activity => new BusinessEntities.Activity()
                                                                     {
                                                                         ActivityTypeId =
                                                                             new BusinessEntities.ActivityType()
                                                                                 {
                                                                                     Code = activity.ActivityType.Code,
                                                                                     Description =
                                                                                         activity.ActivityType.
                                                                                         Description,
                                                                                     Name = activity.ActivityType.Name
                                                                                 },
                                                                         Code = activity.Code,
                                                                         Description = activity.Description,
                                                                         Status =  (EntityStatus)  Enum.Parse(typeof(EntityStatus),Convert.ToString((activity.Status==true)?1:0))
                                                                     });

            return activitiesresult.ToList();
        }
    } 
```

客户端实施

```
<asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="False">
            <Columns>
             <asp:BoundField runat="server" DataField="Code"/>

             <asp:BoundField runat="server" DataField="Description"/>

             <asp:BoundField runat="server" DataField="Status"/>

             <asp:BoundField runat="server" DataField="ActivityTypeId"/>
            </Columns>
        </asp:GridView> 
```

输出

```
 Code Description                   Status    ActivityTypeId
    ACT2    Requirement Feasibility Study Inactive TimeSheetManagementServiceRef.ActivityType
    ACT1    Requirement analysis    Inactive     TimeSheetManagementServiceRef.ActivityType 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-02T08:38:58.153

数据合约用于传输数据——而不是用于传输逻辑。当您使用添加服务引用、添加 Web 引用、xsd.exe、wsdl.exe 或 svcutil.exe 时，仅描述属性 - 您在服务器上声明的所有方法都将丢失。有两种方法可以解决这个问题：

*   丑陋的方式：与服务和客户端之间的数据契约共享库，而不是通过上述工具之一在客户端上创建新类型
*   这些工具应该创建部分类。您的`ToString`方法显然属于客户端，因为它与数据表示有关，因此在客户端上创建合同类的第二部分并`ToString`在该类中声明方法。

# xpath - 如何为带有特定文本的元素编写 xpath 表达式？

> ID：10401188
> 
> 赞同：1
> 
> 时间：2012-05-01T16:53:15.527
> 
> 标签：xpath

如何构造一个 xpath 表达式，在该表达式中，我希望在 <p> 元素之后获取 <p> 元素，该元素带有一个子 <strong> 元素，其文本为“关于此事件：”。

换句话说，什么路径表达式会给我一个“<p>”元素，在 <P> 之后有一个“Hello”文本，下面是 <Strong> 文本……</p>

```
<p>
    <strong>About this event:</strong>
    …
</p>
<p>Hello</p> 
```

? -

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T17:08:33.843

```
//p[strong[.='About this event:']]/following-sibling::p 
```

或者

```
//p[strong[.='About this event:']]/following-sibling::p[.='Hello'] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T17:04:16.870

试试这个：

```
//p[normalize-space(strong)='About this event:']/following-sibling::p 
```

`p`您还可以通过添加以下内容将其缩小到第一个`[1]`：

```
//p[normalize-space(strong)='About this event:']/following-sibling::p[1] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T17:08:33.670

我相信这应该是可行的。这是 Perl`xpath`工具的输出：

```
so zacharyyoung$ xpath so.xml '//p[strong = "About this event:"]/following-sibling::p[1]'
Found 1 nodes:
-- NODE --
<p>Hello</p> 
```

XPath 是`//p[strong = "About this event:"]/following-sibling::p[1]`

# mysql - NOT IN 逻辑运算符如何生成此输出？

> ID：10401189
> 
> 赞同：0
> 
> 时间：2012-05-01T16:53:18.680
> 
> 标签：mysql, sql

我有以下表格和数据：[**此处数据的屏幕截图**](http://i.imgur.com/bGEU1.png?1)

```
course:
course#     ctitle               units
---------   -------------------  -----
ACCT 201    Financial Account      3
CHEM 356    Organic Chemistry      4
HIST 101    US History             5
MINS 235    Database Design        4
MINS 301    Intro to Business IS   3
MINS 350    Systems Analysis       4
PHED 434    Advanced Gym           2

class:
class#  course#      sec#   semyr
------  ----------   -----  -----
203     ACCT 201       03    F11
204     ACCT 201       04    F11
307     MINS 301       07    F11
418     MINS 235       04    F11
438     MINS 350       01    F11
624     PHED 434       02    F11

student:
sid  sname       major
---  ----------  ----------
 1    Bob        MINS
 2    Mary       POMG
 3    Joe        MGMT
 4    Sue        MKTG
 5    Jim        ACCT

class_student:
class  sid   grade
-----  ----  -----
 203     2     B
 203     5     D
 204     1     C
 204     4     C
 307     1     B
 307     2     B
 307     4     A
 418     1     A
 418     2     B
 418     5     C
 438     1     B
 438     4     C
 634     5     F

grade:
grade  grade_pts
-----  ---------
  A        4
  B        3
  C        2
  D        1
  F        0 
```

当我运行以下查询时：

```
SELECT      *  
FROM        STUDENT 
WHERE       SID NOT IN 
            (   SELECT  SID 
                FROM    CLASS_STUDENT 
                WHERE   GRADE IN ('A' , 'B')
            ) 
ORDER BY    SID; 
```

我认为甲骨文会产生这个输出。

```
sid sname major
--- ----- -----
 1  bob   mins
 4  sue   mktg
 5  jim   acct
 5  jim   acct
 5  jim   acct 
```

我想了解 NOT IN 逻辑运算符的工作原理。运算符如何`NOT IN`在上述查询中工作以生成输出？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T16:55:33.017

它返回成绩低于`B`.

`NOT IN`过滤掉你之后定义的内容。

用一句话来说：

> 选择所有学生，但不选择有成绩的学生`A`或`B`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T17:03:59.273

子查询`(SELECT SID FROM CLASS_STUDENT WHERE GRADE IN ( 'A' , 'B' ))`选择至少在一个班级中成绩为 A 或 B 的所有学生的 SID。与`IN`运算符一起使用时，列表会被隐式删除重复数据。在您的数据中显示，学生 1、2 和 4 在至少一个班级中都有 A 或 B，因此将包含在此子查询的结果集中。

然后，完整查询只是从中选择`STUDENT`不包含在子查询返回的列表中的所有行。所以我认为你得到了两行，SID 为 3 和 5。

您的“预期结果”毫无意义。当您的查询选择所有学生然后过滤掉一些学生时，没有理由期望同一个学生有多个行。

您的查询正在执行的是显示至少在一个班级中没有 A 或 B 成绩的学生。我怀疑您想要的是显示每个学生班级组合的成绩比 B 差（这似乎与您的预期结果一致）。为此，我建议将查询从`CLASS_STUDENT`表中移开，并加入以`STUDENT`获取学生信息（如果需要，可能还`CLASS`可以`COURSE`获取课程名称）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T17:06:00.047

```
SELECT SID FROM CLASS_STUDENT WHERE GRADE IN ( 'A' , 'B' ) 
```

将选择具有 A、B 成绩的学生的 sid。将产生一个 sid 列表

```
SID
2
1
2
4
1
2
1 
```

然后

```
SELECT  *  FROM STUDENT 
WHERE   SID NOT IN  ... 
```

将导致：

```
SID     sname       Major
3       joe         mgmt
5       jim         acct 
```

# java - 确定哪个按钮调用了 actionPerformed 方法

> ID：10401190
> 
> 赞同：2
> 
> 时间：2012-05-01T16:53:22.203
> 
> 标签：java, user-interface

我正在用 Java 制作一个迷宫程序，它由一个 MazeButtons 网格组成，它扩展了 JButton 并有一个 State 字段（这是按钮的位置以及有关迷宫应该如何工作的一些其他信息）。另一个类 MazeFrame 扩展了 JFrame 并实现了 ActionListener。当我在设置类中构建 GUI 时，我将 MazeFrame ActionListener 添加到每个按钮。我希望 MazeFrame 中的 actionPerformed 方法能够检查用户尝试的操作是否被允许，但为了做到这一点，我需要知道单击了哪个按钮。

你怎么知道哪个按钮调用了给定的 actionPerformed 方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T16:56:49.993

在事件上使用 getSource 方法，它将返回触发它的对象

# ruby-on-rails-3 - Rails 3: validate that a record belongs to user

> ID：10401191
> 
> 赞同：2
> 
> 时间：2012-05-01T16:53:26.837
> 
> 标签：ruby-on-rails-3

I have a HABTM relationship between Products and Categories. Those Categories belongs to a user.

At my product form, I only show checkboxes for the current user. But i want to validate this on model too, so users can't fake POST variables and assign it to invalid categories.

How can i do such validation?

Example: given a category_id 5, i have to check if this category belongs to current_user.id ( provided by devise ).

Thanks.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T17:21:24.767

您可以添加`attr_accessor: creator_id`到您的`Post`模型中。（`creator_id`不在数据库中）

并`current_user.id`从表单发送到`Post`'s `creator_id`。

然后使用模型回调。例如`after_validation`：

```
after_validation do
  if User.find(creator_id).categories.pluck(:id).include?(category_id)
    true
  else
    errors.add :category, "is invalid for user"
  end
end 
```

# asp.net-mvc - two models in a view - not working for me

> ID：10401196
> 
> 赞同：0
> 
> 时间：2012-05-01T16:53:42.533
> 
> 标签：asp.net-mvc

I have created an entity data model from my database. however in certain areas of the application i need to pass two models. thus i create a third model which has as properties the objects of each required model.

In the scenario, i want to use one model just to show some data to the user and the other is to be populated by the user using form elements. therefore, i create a constructor in my custom model to populate it. here's the code:

THE CUSTOM MODEL

```
public class ordersModel
{
    public ordersModel(order or)
    {
        this.prods = new order_products();
        this.new_order = new order();
        this.new_order.customer_id = or.customer_id;
        this.new_order.my_id = or.my_id;
        this.new_order.my_order_id = or.my_order_id;
        this.new_order.order_date = or.order_date;
        this.new_order.order_status_id = or.order_status_id;
    }
    public order new_order { get; set; }
    public order_products prods { get; set; }
} 
```

IT IS USED IN THE CONTROLLER AS FOLLOWS:

```
public ActionResult Create()
    {
        order or = new order();
        // Store logged-in user's company id in Session
        //or.my_id = Session["my_id"].ToString();
        //do something to allow user to select customer, maybe use ajax
        or.customer_id = "123";
        or.order_amount = 0;
        or.my_id = "74973f59-1f6c-4f4c-b013-809fa607cad5";
        // display date picker to select date
        or.order_date = DateTime.Now.Date;
        // fetch statuses from database and show in select list box
        or.order_status_id = 1;
        return View(or);
    } 

    //
    // POST: /Orders/Create

    [HttpPost]
    public ActionResult Create(order or)
    {
        using (invoicrEntities db = new invoicrEntities())
        {
            var temp = db.last_order_number.SingleOrDefault(p => p.my_id == or.my_id);
            if (temp != null)
            {
                or.my_order_id = temp.my_order_id + 1;
                if (ModelState.IsValid)
                {
                    ordersModel ord = new ordersModel(or);

                    db.orders.AddObject(or);
                    temp.my_order_id = temp.my_order_id + 1;
                    //TempData["my_order_id"] = or.my_order_id;
                    db.SaveChanges();
                    return RedirectToAction("AddProducts", ord);
                    //return RedirectToAction("AddProducts", new { id = or.my_order_id });
                }
                return View(or);
            }
            return RedirectToAction("someErrorPageDueToCreateOrder");
        }
    }

    public ActionResult AddProducts()
    {
        using (invoicrEntities db = new invoicrEntities())
        {
            //string my_id = TempData["my_id"].ToString();
            //string my_order_id = TempData["my_order_id"].ToString();

            string my_id = "74973f59-1f6c-4f4c-b013-809fa607cad5";
            int my_order_id = 1;
            //Int64 my_order_id = Convert.ToInt64(RouteData.Values["order_id"]);

            // Display this list in the view
            var prods = db.order_products.Where(p => p.my_id == my_id).Where(p => p.my_order_id == my_order_id).ToList();

            var or = db.orders.Where(p => p.my_id == my_id).Where(p => p.my_order_id == my_order_id).ToList();
            if (or.Count == 1)
            {
                //ViewData["name"] = "sameer";
                ViewData["products_in_list"] = prods;
                ViewData["order"] = or[0];
                return View();
            }
            return RedirectToAction("someErrorPageDueToAddProducts");
        }
    }

    [HttpPost]
    public ActionResult AddProducts(order_products prod)
    {
        prod.my_id = "74973f59-1f6c-4f4c-b013-809fa607cad5";
        // find a way to get the my_order_id
        prod.my_order_id = 1;
        return View();
    } 
```

THIS ALL WORKS OUT WELL, UNTIL IN THE "ADDPRODUCTS" VIEW:

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Site.Master" Inherits="System.Web.Mvc.ViewPage<invoicr.Models.ordersModel>" %> 
```

AddProducts

```
<h2>AddProducts</h2>
<%: Model.new_order.my_id %> 
```

the above statement gives an error

Exception Details: System.NullReferenceException: Object reference not set to an instance of an object.

what am i doing wrong here?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T16:57:19.037

`Create`重新显示视图时，您似乎传递了错误的模型。

尝试传递`ord`类型的实例，`ordersModel`这是您的视图被强类型化的对象：

```
public ActionResult Create(order or)
{
    using (invoicrEntities db = new invoicrEntities())
    {
        var temp = db.last_order_number.SingleOrDefault(p => p.my_id == or.my_id);
        if (temp != null)
        {
            or.my_order_id = temp.my_order_id + 1;
            ordersModel ord = new ordersModel(or);
            if (ModelState.IsValid)
            {
                db.orders.AddObject(or);
                temp.my_order_id = temp.my_order_id + 1;
                db.SaveChanges();
                return RedirectToAction("AddProducts", ord);
            }
            return View(ord);
        }
        return RedirectToAction("someErrorPageDueToCreateOrder");
    }
} 
```

* * *

更新：

现在您已经展示了您的`AddProducts`操作，尽管您的视图需要一个`ordersModel`实例，但您并没有将任何模型传递给视图。所以不要只是`return View();`。您需要传递一个实例`ordersModel`：

```
if (or.Count == 1)
{
    ViewData["products_in_list"] = prods;
    ViewData["order"] = or[0];
    ordersModel ord = new ordersModel(or[0]);
    return View(ord);
} 
```

# android - NAT traversal techniques and idea

> ID：10401200
> 
> 赞同：3
> 
> 时间：2012-05-01T16:54:03.653
> 
> 标签：android, traversal, nat, stun

So I was in a middle of making NAT traversal.

The scenario is next: I got two Android phones and I want to connect them(sockets) using HTTP server(both devices are behind NAT).

So far so good, both clients connect to HTTP server, HTTP server records their IP address&PORTS,

however there is a little problem, since I use Java HttpDefaultClient(), it will change the port each time I send request from client to the server. Okay that sounds like simple problem: let's just use Socket() to actually maintain a valid TCP connection into server.

public Socket(InetAddress address, int port, InetAddress localAddr, int localPort) throws IOException

I will just use this class and put the localPort something random which I will remember. Now I do everything again, this time it seems that port wont change, like I want.

Now after I have opponent's IP&port(he's also behind NAT), theoretically I could drop the SERVER connection and use the same localPort I already used to actually host a clientServer?

unless, and now comes the part where I have question: 1)If I drop the HTTP server socket, will NAT understand that and remove the port mapping?(that's bad) 2) How does actually passing symmetric-cone nat work? 3) does the STUN libraries work somehow differently?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T17:10:13.140

NAT 的工作方式不尽相同，但您可以依靠以下几点：1）如果您的客户端认为它在端口 X 上，NAT 会将其转换为不同的端口 2）NAT 通常允许响应的数据包进入传出的数据包。

STUN 在服务器的帮助下尝试猜测实际的传出端口是什么，然后将地址+端口传递给另一个客户端。这不是很可靠。TURN 只是通过服务器路由所有内容。这更可靠，尽管它会在服务器上产生 CPU 和带宽成本。

如果你可以使用现有的代码来做 NAT 穿越，你会为自己省去很多麻烦。否则，做类似 TURN through sockets 之类的事情，或者使用类似 Urban Airship 之类的东西。我也使用过二进制 SMS，但那是针对特殊情况的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T15:27:10.290

我认为您在 Nats 方面遇到了一些问题。我实际上让这个工作了一段时间（使用第三方服务器（我的）和公共 STUN 服务器创建对等 android 连接。

我强烈建议您阅读[RFC5389 - Nat traversal](https://www.rfc-editor.org/rfc/rfc5389) 它很复杂。我还建议您使用[JStun 库](http://jstun.javawi.de/)之类的东西，或者像我一样实现自己的库。

> 我将只使用这个类并将 localPort 随机放置一些我会记住的东西。现在我再次做所有事情，这次似乎端口不会改变，就像我想要的那样。

我的猜测是你在 nat 后面，所以你请求的内部端口被映射到不同的外部端口。

> 现在，在我拥有对手的 IP 和端口（他也在 NAT 之后）之后，理论上我可以断开 SERVER 连接并使用我已经用于实际托管 clientServer 的相同 localPort？

还没有，大多数 nat 不仅记录客户端连接两个的端口，还记录它们连接的 IP 地址，这样它们就会阻止来自其他 IP 的流量。例如，Phone1 在 IP-a 上，并从 ip-a 上的 port-b 连接到服务器 nat 将 port-b 转换为 port-c。从服务器的角度来看，电话位于端口 c 上的 IP-a。它将此信息中继到phone2。nat 将阻止来自 phone2 的所有通信，直到 phone1 从端口 b 向 phone2 发送数据。

> 1）如果我丢弃 HTTP 服务器套接字，NAT 会理解并删除端口映射吗？（那很糟糕） 2）

我从经验中学到的东西是不要对 nats 端口映射行为抱有任何期望，除非您的端口将被映射，并且某些 nat 会更改所述映射，因为从您的角度来看，这似乎是愚蠢的原因。这需要大量更新。但总的来说没有。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T02:29:32.980

如今，对于**大多数**（但不是全部）NAT，您可以假设一些一致性和可预测的端口映射行为。（即不同服务器连接使用同一个本地端口，在NAT上映射到同一个本地端口）。但听起来你想通过 TCP 进行 NAT 遍历，这是一个比 UDP 更难的问题。

根本问题是大多数 NAT 也充当防火墙。他们不允许来自远程 ip:port 的入站连接。我相信诀窍是在双方同时进行连接。

您可以在此处阅读有关 TCP 打孔的更多信息：[http ://en.wikipedia.org/wiki/TCP_hole_punching](http://en.wikipedia.org/wiki/TCP_hole_punching)

# css - 包含多个 div 的粘性页脚不起作用

> ID：10401215
> 
> 赞同：0
> 
> 时间：2012-05-01T16:55:28.380
> 
> 标签：css, html, footer, sticky

我真的很挣扎我的页脚。我已按照[http://www.cssstickyfooter.com/](http://www.cssstickyfooter.com/)上的说明将页脚粘贴到页面底部。在我将 div 添加到页脚 div 之前它工作正常 - 紫色背景和图像消失。我会将其作为单个 div 进行，但如果不创建单独的框，我无法弄清楚如何进行锯齿形边缘。

任何帮助将不胜感激！几天来我一直在努力让它发挥作用。这是我的 HTML：

```
 <body>
    <div id="wrapper">

     <!-- Begin Header -->
     <div id="header">

    <a href="index.html"><img src="images/logo.png" width="435px" height="112px" alt="Lauren Womack Logo" /></a>

    <div id="menu">
    <a href="/"><img src="images/menu/home.png" width="142" height="160" alt="Home"  /></a> 
    <a href="about.html"><img src="images/menu/about.png" width="131" height="157" alt="About"  /></a>
    <a href="contact.html"><img src="images/menu/contact.png" width="128" height="160" alt="Contact"  /></a>     
    </div>             
    </div>
     <!-- End Header -->
     <!-- Begin Content -->
     <div id="content">
    <div id="rightholder">
    <div class="outerleft">
    <div class="inner"><h2>Animation and Interactive</h2>
    </div> 
    </div>
    <div class="outerright">
    <div class="inner">
    <h2>Web Design</h2>
    </div>       
    </div>
    <div class="outerleft">
    <div class="inner">
    <h2>Print Design</h2>
</div></div>

    <div class="outerright">
    <div class="inner">
    <h2>Illustration</h2>
</div>   
       </div></div>          <!-- End Content -->
    </div>
    </div><!-- Begin Footer -->   
    <div id="footer">
    <div class="footeredge">  </div>
    <div class="footerinner">     <p>© Lauren Womack 2012</p>
    </div>        </div>   </div>
            <!-- End Footer --></body></html> 
```

这是我的CSS：

```
 body {font-size: 13px; background: url(images/background.jpg) no-repeat center center fixed; -webkit-background-size: cover; -moz-background-size: cover; -o-background-size: cover; background-size: cover; height: 100%;}
    html {height: 100%;}
    #wrapper{ min-height:100%; min-width:992px; margin-left:0px; margin-right:0px;}
    #header {height: 170px; padding-top:36px; border: none;}
    #menu {float:right;}
    #content { position: relative; min-width: 1141px; border:none;background: none; overflow:auto; padding-right:32px; padding-left:32px; padding-bottom: 86px;}
    #rightholder { float: right; clear: left;min-width: 639px;width: 60%;padding-top: 90px;}
    .outerright {background-image:url(images/threadborder.jpg);min-width: 257px;width: 45%; height: 98px; margin-top: 22px; margin-bottom: 22px; margin-left: 20px;float: right;clear: right;}
    .outerleft {background-image:url(images/threadborder.jpg);
min-width: 257px; width: 45%; height: 98px; margin-top: 22px;margin-bottom: 22px;margin-right: 20px; float: left;clear: left;}
    .inner {padding: 5px; height: 87px;}
    #footer {position: relative; margin-top:-86px; margin-left:0px; margin-right:0px; padding-left:0px; padding-right:0px; height:86px; clear:both; padding-right: 32px; margin-left:0px; margin-right:0px; border: none;
    /*Opera Fix*/
    body:before {
content:"";
height:100%;
float:left;
width:0;
margin-top:-32767px;/
    }
    .footeredge {
background-color: none;
background-image:url(images/footer/zigzag.png);
    background-repeat:repeat-x;
    height: 20px;
    }
    .footerinner {
background-color:#663366;
height: 66px;
    } 
```

我希望它看起来如何：[http](http://tinypic.com/r/242swuc/6) ://tinypic.com/r/242swuc/6底部的紫色框和之字形没有显示，只是文本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T05:17:50.573

#footer 没有右大括号，这反过来又会在此之后中断您的样式声明。

# jquery - jquery - showing div based on radio button checked?

> ID：10401216
> 
> 赞同：0
> 
> 时间：2012-05-01T16:55:28.710
> 
> 标签：jquery, html, hide, show, radio

First of all, I searched here for the past hour to see if I found an answer to my question before I posted, but you're my last hope! I found a piece of code that nearly works as I want it, but not quite.

*   I need to get rid of the fade-in and fade-out.
*   I need the script to check onload which radio button is checked and show the correct div.

Here is my code:

```
 <input type="radio" name="d_method" class="c_email"/>Email   
 <input name="d_method" type="radio" class="c_collection"/>Colletion 
 <input name="d_method" type="radio" class="c_post"/>Post

 <div id="c_email" style="display:none;">
   email textbox
 </div>
 <div id="c_collection" style="display:none;">
   collection textbox
 </div>
 <div id="c_post" style="display:none;">
   post textbox
 </div> 
```

And here is the jquery:

```
 $(':radio').change(function() {
     var itemSelector = '#' + $(this).attr('class');
     $('div').stop().fadeOut(function() {
         $(itemSelector).fadeIn();
     });
 }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T17:01:34.657

尝试这个

```
$(function(){
    $(':radio').click(function() {
        $('#' + $(this).attr('class')).fadeIn().siblings('div').hide();
    })
    .filter(':checked').click();//trigger the click event
});​ 
```

工作演示 - [http://jsfiddle.net/H8VVP/1/](http://jsfiddle.net/H8VVP/1/)

# asp.net-mvc-3 - Model State - What you see is not what you get - revisited

> ID：10401218
> 
> 赞同：2
> 
> 时间：2012-05-01T16:55:30.243
> 
> 标签：asp.net-mvc-3

There are already several good discussions about how model properties set in the form post controller won't show up in view because of model state. To take the discussion a step further I have an example where items in the VIEW are updated but the model is not, again due to Model state. That's right, what your user sees will NOT match the model properties that are returned in the post!

say you have a model with a list

```
public class FruitBasket {
    public string OwnersName { get; set; }
    public IEnumerable<Fruit> Fruits { get; set; }
    public string FruitColor { get; set; }
    public FruitBasket() {
        this.OwnersName = "Bob";
        this.FruitColor = "Red";
    }
}
public class Fruit {
    public string Name { get; set; }
    public string Color { get; set; }
} 
```

And a data access class has methods that retrieves a list of fruits based on color

Data Access code

```
public IEnumerable<Fruit> GetFruits(string color) {
    if (color == "Red") {
        List<Fruit> fruits = new List<Fruit> {
            new Fruit { Name = "Apple", Color = "Red" },
            new Fruit { Name = "Grape", Color = "Red" }
        };
        return fruits;
    } else {
        List<Fruit> fruits = new List<Fruit> {
            new Fruit { Name = "Banana", Color = "Yellow"},
            new Fruit { Name = "Apple", Color = "Red" },
            new Fruit { Name = "Grape", Color = "Red" }
        };
        return fruits;
    }
} 
```

Controller (where db is the data access class)

```
public ActionResult FruitBasket() {
    FruitBasket basket = new FruitBasket();
    basket.Fruits = db.GetFruits("Red");
    return View(basket);
}
[HttpPost]
public ActionResult FruitBasket(FruitBasket basket) {
    basket.Fruits = db.GetFruits("All");
    return View(basket);
} 
```

View

```
@model GEWeb.Models.FruitBasket
<!DOCTYPE html>
<html>
<head>
    <title>FruitBasket</title>
</head>
<body>
@using (Html.BeginForm()) {
    <p>@Html.DisplayFor(model => Model.OwnersName)</p>
    <table>
        @Html.EditorFor(model => model.Fruits)
    </table>
    <input type="submit" value="filter" />
}
</body>
</html> 
```

Editor Template (the template for editorfor is in views/shared/EditorTemplates) the hiddenfor helpers are included so that the model will be populated with list data on post back

```
@model GEWeb.Models.Fruit
<tr>
    <td>
        @Html.DisplayFor(model => model.Name)
        @Html.HiddenFor(model => model.Name)
    </td>
    <td>
        @Html.DisplayFor(model => model.Color)
        @Html.HiddenFor(model => model.Color)
    </td>
    <td>
        @Html.CheckBoxFor(model => model.Remove)
    </td>
</tr> 
```

Scenario - The user requests the page and sees the list of red fruits. - The user clicks the filter button, the post controller loads all fruits, the user sees a list of all three fruits - The user clicks the filter button a second time. Now inspect the basket properties as passed to the post controller, the list will not match what the user saw.

Now imagine that you wanted to use that checkbox to select fruits to remove from the basket. You could pass the basket.fruits model to a method in your data access class which would delete the fruits and then you could have your conroller reload the basket.fruits list. But it will not work because the list returned to the controller does not match what the user is seeing.

This "feature" can be subverted by putting the following into the Post controller

```
ModelState.Clear(); 
```

But realy, I shouldn't have to. Views and controllers should pass the model back and forth accurately. ModelState is an attempt to persist View properties between page loads and that doesn't seem to be in keeping with the MVC phylosophy where state is managed by the database, and not the view!

# php - PHP PDO bug when trying to parameterize SQL LIMIT :offset, :display?

> ID：10401220
> 
> 赞同：4
> 
> 时间：2012-05-01T16:55:52.787
> 
> 标签：php, mysql, pdo, rowcount

This query returns 5 results in phpMyAdmin:

```
SELECT * FROM tbl_product WHERE 1 ORDER BY last_update DESC LIMIT 0,5 
```

And this returns count=12 in phpMyAdmin (which is fine, because there are 12 records):

```
SELECT COUNT(*) AS count FROM tbl_product WHERE 1 ORDER BY last_update DESC LIMIT 0,5 
```

This function was working fine before I added the two variables (offset, display), however now it doesn't work, and printing the variables out gives me offset=0, display=5 (so still `LIMIT 0,5`).

```
function getProducts($offset, $display) {
    $sql = "SELECT * FROM tbl_product WHERE 1 ORDER BY last_update DESC LIMIT ?,?;";
    $data = array((int)$offset, (int)$display);
    $rows = dbRowsCount($sql, $data);
logErrors("getProducts(".$offset.",".$display.") returned ".$rows." rows.");
    if ($rows > 0) {
        dbQuery($sql, $data);
        return dbFetchAll();
    } else {
        return null;
    }
} 
```

It's not working because my `dbRowsCount(...)` method was returning empty string (stupid `PDOStatement::fetchColumn`), so I changed it to return the count with `PDO::FETCH_ASSOC` and it returns count=0.

Here is the function which does the row-count:

```
function dbRowsCount($sql, $data) {
    global $db, $query;
    $regex = '/^SELECT\s+(?:ALL\s+|DISTINCT\s+)?(?:.*?)\s+FROM\s+(.*)$/is';
    if (preg_match($regex, $sql, $output) > 0) {
        $query = $db->prepare("SELECT COUNT(*) AS count FROM {$output[1]}");
logErrors("Regex output: "."SELECT COUNT(*) AS count FROM {$output[1]}");
        $query->setFetchMode(PDO::FETCH_ASSOC);
        if ($data != null) $query->execute($data); else $query->execute();
        if (!$query) {
            echo "Oops! There was an error: PDOStatement returned false.";
            exit;
        }
        $result = $query->fetch();
        return (int)$result["count"];
    } else {
logErrors("Regex did not match: ".$sql);
    }
    return -1;
} 
```

My error log gives me this output from the program:

> Regex output: SELECT COUNT(*) AS count FROM tbl_product WHERE 1 ORDER BY last_update DESC LIMIT ?,?;
> getProducts(0,5) returned 0 rows.

As you can see, the SQL has not been malformed, and the method input variables were 0 and 5 as expected.

Does anyone know what has gone wrong?

# Update

Following a suggestion, I did try to execute the query directly, and it returned the correct result:

```
function dbDebugTest() {
    global $db;
    $stmt = $db->query("SELECT COUNT(*) AS count FROM tbl_product WHERE 1 ORDER BY last_update LIMIT 0,5;");
    $result = $stmt->fetch();
    $rows = (int)$result["count"];
    logErrors("dbDebugTest() returned rows=".$rows);
} 
```

Output:

```
> dbDebugTest() returned rows=12 
```

Following another suggestion, I changed !=null to !==null, and I also printed out the $data array:

```
logErrors("Data: ".implode(",",$data));
if ($data !== null) $query->execute($data); else $query->execute(); 
```

Output:

```
> Data: 0,5 
```

**However, the dbRowsCount($sql, $data) still returns 0 rows for this query!**

# Update 2

Following advice to implement [a custom PDOStatement class](https://stackoverflow.com/a/7716896/259457) which would allow me to output the query after the values have been binded, I found that the function would stop after $query->execute($data) and so the output would not be printed, although the custom class works for every other query in my program.

Updated code:

```
function dbRowsCount($sql, $data) {
    global $db, $query;
    $regex = '/^SELECT\s+(?:ALL\s+|DISTINCT\s+)?(?:.*?)\s+FROM\s+(.*)$/is';
    if (preg_match($regex, $sql, $output) > 0) {
        $query = $db->prepare("SELECT COUNT(*) AS count FROM {$output[1]}");
logErrors("Regex output: "."SELECT COUNT(*) AS count FROM {$output[1]}");
        $query->setFetchMode(PDO::FETCH_ASSOC);
logErrors("Data: ".implode(",",$data));
        $query->execute($data);
logErrors("queryString:".$query->queryString);
logErrors("_debugQuery():".$query->_debugQuery());
        if (!$query) {
            echo "Oops! There was an error: PDOStatement returned false.";
            exit;
        }
        $result = $query->fetch();
        return (int)$result["count"];
    } else {
logErrors("Regex did not match: ".$sql);
    }
    return -1;
} 
```

Output:

> Regex output: SELECT COUNT(*) AS count FROM tbl_product_category WHERE id=?;
> Data: 5
> queryString:SELECT COUNT(*) AS count FROM tbl_product_category WHERE id=?;
> _debugQuery():SELECT COUNT(*) AS count FROM tbl_product_category WHERE id=?;
> 
> Regex output: SELECT COUNT(*) AS count FROM tbl_product WHERE 1 ORDER BY last_update DESC LIMIT ?,?;
> Data: 0,5
> // function stopped and _debugQuery couldn't be output

# Update 3

Since I couldn't get the custom PDOStatement class to give me some output, I thought I'd rewrite the `getProducts(...)` class to bind the params with named placeholders instead.

```
function getProducts($offset, $display) {
    $sql = "SELECT * FROM tbl_product WHERE 1 ORDER BY last_update DESC LIMIT :offset, :display;";
    $data = array(':offset'=>$offset, ':display'=>$display);
    $rows = dbRowsCount($sql, $data);
logErrors("getProducts(".$offset.",".$display.") returned ".$rows." rows.");
    if ($rows > 0) {
        dbQuery($sql, $data);
        return dbFetchAll();
    } else {
        return null;
    }
} 
```

Output:

> Regex output: SELECT COUNT(*) AS count FROM tbl_product WHERE 1 ORDER BY last_update DESC LIMIT :offset, :display;
> Data: 0,5
> // Still crashes after $query->execute($data) and so `logErrors("getProducts(".$offset."...))` wasn't printed out

# Update 4

This dbDebugTest previously worked with declaring the limit values 0,5 directly in the SQL string. Now I've updated it to bind the parameters properly:

```
function dbDebugTest($offset, $display) {
    logErrors("Beginning dbDebugTest()");
    global $db;
    $stmt = $db->prepare("SELECT COUNT(*) AS count FROM tbl_product WHERE 1 ORDER BY last_update LIMIT :offset,:display;");
    $stmt->bindParam(':offset', $offset, PDO::PARAM_INT);
    $stmt->bindParam(':display', $display, PDO::PARAM_INT);
    if ($stmt->execute()) {
      $result = $stmt->fetch();
      $rows = (int)$result["count"];
      logErrors("dbDebugTest() returned rows=".$rows);
    } else {
      logErrors("dbDebugTest() failed!");
    }
} 
```

The function crashes, and only this is output:

> Beginning dbDebugTest()

# Update 5

Following a suggestion to turn errors on (they are off by default), I did this:

```
$db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION); 
```

That itself, made the dbDebugTest() from Update 4 work!

> Beginning dbDebugTest() dbDebugTest() returned rows=12

And now an error is generated in my webserver logs:

> [warn] mod_fcgid: stderr: PHP Fatal error:
> Uncaught exception 'PDOException' with message 'SQLSTATE[42000]:
> Syntax error or access violation: 1064 You have an error in your SQL syntax;
> check the manual that corresponds to your MySQL server version for the right syntax to use
> near ''0', '5'' at line 1'
> in /home/linweb09/b/example.com-1050548206/user/my_program/database/dal.php:36

Line 36 refers to `dbRowsCount(...)` method and the line is `$query->execute($data)`.

So the other method `getProducts(...)` still doesn't work because it uses this method of binding the data and the params turn into ''0' and '5'' (is this a bug?). A bit annoying but I'll have to create a new method in my dal.php to allow myself to bind the params in the stricter way - with `bindParam`.

Thanks especially to @Travesty3 and @eggyal for their help!! Much, much appreciated.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T18:44:45.320

根据问题中的更新 2，在`execute`语句之后执行停止，看起来查询失败了。查看[一些 PDO 文档](http://php.net/manual/en/pdo.error-handling.php)后，默认错误处理设置似乎是 PDO::ERRMODE_SILENT，这将导致您看到的行为。

这很可能是由于您的 LIMIT 子句中的数字在作为参数传入时被放入单引号中，就像在[这篇文章](https://stackoverflow.com/q/2269840/259457)中发生的那样。

该帖子的解决方案是使用该[`bindValue`](http://php.net/manual/en/pdostatement.bindvalue.php)方法将参数指定为整数。所以你可能不得不做类似的事情。

看起来您还应该使用 try-catch 块执行查询以捕获 MySQL 错误。

* * *

绑定值方法：

```
if ($data !== null)
{
    for ($i=0; $i<count($data); $i++)
        $query->bindValue($i+1, $data[$i], PDO::PARAM_INT);
    $query->execute($data);
}
else
    $query->execute(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T17:25:13.263

您正在测试是否`$data`使用`NULL`相等运算符而不是标识运算符（有关各种比较运算符如何处理值的更多信息，请参阅[PHP 手册）。](http://www.php.net/manual/en/types.comparisons.php)`NULL`您需要使用身份测试`===`/ `!==`，或者调用[`is_null()`](http://php.net/manual/en/function.is-null.php).

正如上面提到的@Travesty3，要测试数组是否为空，请使用[`empty()`](http://php.net/manual/en/function.empty.php).

# spring - ApplicationEventMulticaster not initialized with spring-data for mongo

> ID：10401221
> 
> 赞同：3
> 
> 时间：2012-05-01T16:55:54.533
> 
> 标签：spring, spring-security, spring-data

I'm currently experiencing the following exception when my spring application starts:

```
2012-04-27 17:42:51,021 ERROR [main] com.hazelcast.impl.FactoryImpl - /10.188.31.125:54327 [dev] ApplicationEventMulticaster not initialized - call 'refresh' before multicasting events via the context: org.springframework.context.support.ClassPathXmlApplicationContext@1fd0fafc: startup date [Fri Apr 27 17:42:46 CEST 2012]; root of context hierarchy
java.lang.IllegalStateException: ApplicationEventMulticaster not initialized - call 'refresh' before multicasting events via the context: org.springframework.context.support.ClassPathXmlApplicationContext@1fd0fafc: startup date [Fri Apr 27 17:42:46 CEST 2012]; root of context hierarchy
       at org.springframework.context.support.AbstractApplicationContext.getApplicationEventMulticaster(AbstractApplicationContext.java:337) [spring-context-3.1.0.RELEASE.jar:3.1.0.RELEASE]
       at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:324) [spring-context-3.1.0.RELEASE.jar:3.1.0.RELEASE]
       at org.springframework.data.mapping.context.AbstractMappingContext.addPersistentEntity(AbstractMappingContext.java:263) ~[spring-data-commons-core-1.2.1.RELEASE.jar:na]
       at org.springframework.data.mapping.context.AbstractMappingContext$PersistentPropertyCreator.doWith(AbstractMappingContext.java:364) ~[spring-data-commons-core-1.2.1.RELEASE.jar:na]
       at org.springframework.util.ReflectionUtils.doWithFields(ReflectionUtils.java:570) ~[spring-core-3.1.0.RELEASE.jar:3.1.0.RELEASE]
       at org.springframework.data.mapping.context.AbstractMappingContext.addPersistentEntity(AbstractMappingContext.java:247) ~[spring-data-commons-core-1.2.1.RELEASE.jar:na]
       at org.springframework.data.mapping.context.AbstractMappingContext$PersistentPropertyCreator.doWith(AbstractMappingContext.java:364) ~[spring-data-commons-core-1.2.1.RELEASE.jar:na]
       at org.springframework.util.ReflectionUtils.doWithFields(ReflectionUtils.java:570) ~[spring-core-3.1.0.RELEASE.jar:3.1.0.RELEASE]
       at org.springframework.data.mapping.context.AbstractMappingContext.addPersistentEntity(AbstractMappingContext.java:247) ~[spring-data-commons-core-1.2.1.RELEASE.jar:na]
       at org.springframework.data.mapping.context.AbstractMappingContext.getPersistentEntity(AbstractMappingContext.java:165) ~[spring-data-commons-core-1.2.1.RELEASE.jar:na]
       at org.springframework.data.mapping.context.AbstractMappingContext.getPersistentEntity(AbstractMappingContext.java:140) ~[spring-data-commons-core-1.2.1.RELEASE.jar:na]
       at org.springframework.data.mapping.context.AbstractMappingContext.getPersistentEntity(AbstractMappingContext.java:65) ~[spring-data-commons-core-1.2.1.RELEASE.jar:na]
       at org.springframework.data.mongodb.core.MongoTemplate.determineCollectionName(MongoTemplate.java:1494) ~[spring-data-mongodb-1.0.1.RELEASE.jar:na]
       at org.springframework.data.mongodb.core.MongoTemplate.findAll(MongoTemplate.java:959) ~[spring-data-mongodb-1.0.1.RELEASE.jar:na]
       at net.bigpoint.globalchat.hazelcast.MongoMapStore.loadAllKeys(MongoMapStore.java:59) ~[classes/:na]
       at com.hazelcast.impl.concurrentmap.MapStoreWrapper.loadAllKeys(MapStoreWrapper.java:131) ~[hazelcast-2.0.2.jar:2.0.2]
       at com.hazelcast.impl.FactoryImpl.checkInitialization(FactoryImpl.java:588) [hazelcast-2.0.2.jar:2.0.2]
       at com.hazelcast.impl.FactoryImpl.getOrCreateProxyByName(FactoryImpl.java:546) [hazelcast-2.0.2.jar:2.0.2]
       at com.hazelcast.impl.FactoryImpl.getMap(FactoryImpl.java:514) [hazelcast-2.0.2.jar:2.0.2]
       at com.hazelcast.impl.FactoryImpl$HazelcastInstanceProxy.getMap(FactoryImpl.java:240) [hazelcast-2.0.2.jar:2.0.2]
       at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.6.0_27]
       at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) ~[na:1.6.0_27]
       at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) ~[na:1.6.0_27]
       at java.lang.reflect.Method.invoke(Method.java:597) ~[na:1.6.0_27]
       at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:149) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
       at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:570) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
       at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactory 
```

Background:

*   my authenticationProvider for spring-security requires a hazelcast map
*   hazelcast loads data at startup from a mapstore that is based on spring-data for mongo
*   spring data wants to use the ApplicationEventMulticaster
*   it's not there yet.

as far as i can tell the Multicaster is created when init() on the configurableApplicationContext is called, which seem to happen after the spring security stuff. (imediately after...)

can i force the the application context to set up the multicaster earlier or to set up hazelcast later?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-06T12:48:21.973

不确定它是 Spring Security 还是一般 Spring 问题，但 Spring Security 类在`init()`调用之前被初始化`configurableApplicationContext`（所以在`ApplicationEventMulticaster`创建之前）。

我认为这是一个重要问题，因为解决此问题的唯一方法是从我的安全实现中删除依赖注入，并在第一次使用时从应用程序上下文中手动获取所有内容（我现在已经这样做了）。

我可能会为此提出一个 Jira 问题。

# android - Nesting surfaceview>Linearlayout>Horizontal scrollview

> ID：10401225
> 
> 赞同：0
> 
> 时间：2012-05-01T16:56:04.357
> 
> 标签：android, android-linearlayout, surfaceview, horizontalscrollview

I've been working through some tutorials on 2D apps in android.

Currently I'm working with a canvas drawn onto a surfaceview, but I want to make my screen horizontally scrollable to make a rudimentary hex based strategy game. So far I've had little joy:

(Tutorial I've been working from: [http://www.droidnova.com/playing-with-graphics-in-android-part-vii,220.html](http://www.droidnova.com/playing-with-graphics-in-android-part-vii,220.html))

Should I be extending Linearlayout?

XML:

```
<?xml version="1.0" encoding="utf-8"?>

<HorizontalScrollView xmlns:android="http://schemas.android.com/apk/res/android"

android:layout_width="fill_parent"
android:layout_height="wrap_content"
>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="vertical"
android:layout_width="wrap_content"
android:layout_height="fill_parent"
android:id="@+id/linearLayout"
>

</LinearLayout>

</HorizontalScrollView> 
```

Relevant code:

```
package com.blackslot.BlackMark;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.Map;

import com.blackslot.BlackMark.gamethread;
import android.widget.LinearLayout;

import android.content.Context;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Canvas;
import android.media.AudioManager;
import android.media.SoundPool;
import android.util.Log;

import android.view.SurfaceHolder;
import android.view.SurfaceView;

public class Panel extends SurfaceView implements SurfaceHolder.Callback  {

/**
 * Thread which contains the game loop.
 */

private gamethread _thread;

 /**
 * List of graphics to handle.
 */
private ArrayList<Graphic> _graphics = new ArrayList<Graphic>();

/**
 * Sound pool
 */
private SoundPool _soundPool;

/**
 * Cache variable for all used images.
 */
private Map<Integer, Bitmap> _bitmapCache = new HashMap<Integer, Bitmap>();

/**
 * Constructor called on instantiation.
 * @param context Context of calling activity.
 */
public Panel(Context context) {
    super(context);
    fillBitmapCache();
    _soundPool = new SoundPool(16, AudioManager.STREAM_MUSIC, 100);
    getHolder().addCallback(this);
    _thread = new gamethread(this);
    setFocusable(true);
}

private void fillBitmapCache() {

    _bitmapCache.put(R.drawable.tacticalbuttondefault, BitmapFactory.decodeResource(getResources(), R.drawable.tacticalbuttondefault));
    _bitmapCache.put(R.drawable.targettingbuttondefault, BitmapFactory.decodeResource(getResources(), R.drawable.targettingbuttondefault));
   // _bitmapCache.put(R.drawable.ship1, BitmapFactory.decodeResource(getResources(), R.drawable.ship1));
   //_bitmapCache.put(R.drawable.ship2, BitmapFactory.decodeResource(getResources(), R.drawable.ship2));
    _bitmapCache.put(R.drawable.abstrakt, BitmapFactory.decodeResource(getResources(), R.drawable.abstrakt));
}

/**
 * Draw on the SurfaceView.
 * Order:
 * <ul>
 *  <li>Background image</li>
 *  <li>Items on the panel</li>
 * </ul>
 */
@Override
public void onDraw(Canvas canvas) {
    // draw the background
    canvas.drawBitmap(_bitmapCache.get(R.drawable.abstrakt), 0, 0, null);
    Bitmap bitmap;
    Graphic.Coordinates coords;
    // draw the UI
    canvas.drawBitmap(_bitmapCache.get(R.drawable.tacticalbuttondefault), -2, 0, null);
    canvas.drawBitmap(_bitmapCache.get(R.drawable.targettingbuttondefault), -2, 120, null);

    // draw the normal items
    for (Graphic graphic : _graphics) {
        bitmap = graphic.getBitmap();
        coords = graphic.getCoordinates();
        canvas.drawBitmap(bitmap, coords.getX(), coords.getY(), null);
    }
}
// @Override
public void surfaceChanged(SurfaceHolder holder, int format, int width, int height) { }

/**
 * Called on creation of the SurfaceView.
 * Which could be on first start or relaunch.
 */
// @Override
public void surfaceCreated(SurfaceHolder holder) {
    if (!_thread.isAlive()) {
        _thread = new gamethread(this);
    }
    _thread.setRunning(true);
    _thread.start();
}

/**
 * Called if the SurfaceView should be destroyed.
 * We try to finish the game loop thread here.
 */
// @Override
public void surfaceDestroyed(SurfaceHolder holder) {
    boolean retry = true;
    _thread.setRunning(false);
    while (retry) {
        try {
            _thread.join();
            retry = false;
        } catch (InterruptedException e) {
            // we will try it again and again...
        }
    }
    Log.i("thread", "Thread terminated...");
}
} 
```

Thanks.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T18:45:35.850

决定使用位图的 X 和 Y 像素偏移来解决问题（允许双向滚动）并一起放弃水平滚动视图。

虽然不是我正在寻找的解决方案，但对于更多的控制来说，它并没有太多额外的工作。

# android - 如何检查应用程序是否已从 Google Play 或“未知来源”加载

> ID：10401227
> 
> 赞同：1
> 
> 时间：2012-05-01T16:56:11.657
> 
> 标签：android, google-play

有没有办法让安卓应用程序检查它是直接从 Google Play（前安卓市场）安装还是从其他来源手动安装的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T17:38:02.277

是的，您可以注册一个 BroadcastReseiver，如果从 Market 安装，它将在安装时触发。尝试谷歌“android 接收器 install_referrer”。

# php - OpenCart 配置类是如何工作的？

> ID：10401231
> 
> 赞同：2
> 
> 时间：2012-05-01T16:56:22.880
> 
> 标签：php, opencart

Iam 正在浏览 OpenCart 的代码。我找到了一个名为的库类文件。配置.class.php。

这是代码：

```
public function load($filename)
{
    $file = SYS_CONFIG_DIR . $filename . '.php';
    if(file_exists($file))
    { 
        $cfg = array();
        require($file);
        $this->data = array_merge($this->data, $cfg);
    }
    else
    {
        trigger_error('Error: Could not load config ' . $filename . '!');
        exit();
    }
} 
```

我可以看到它首先尝试检查文件是否存在。然后 a 创建一个 var ($cfg) 作为数组。然后它需要该文件。然后它合并它。这是我不明白的地方。

```
$this->data = array_merge($this->data, $cfg); 
```

所以我正在加载到此类中的配置文件。我将如何构建它以便能够将它与这个系统配置类合并？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T17:14:17.507

看看[array_merge 的 PHP 文档](http://php.net/manual/en/function.array-merge.php)，它准确地说明了它是如何工作的：

> **如果输入数组具有相同的字符串键，则该键的后一个值将覆盖前一个。**但是，如果数组包含数字键，则后面的值不会覆盖原始值，而是会被追加。

这基本上意味着在你的配置中（稍后加载）你可以有一个空`$cfg`数组，然后它什么也不做。如果您在配置数组中设置了一些变量：

```
$cfg = array();
$cfg["var"] = "value"; 
```

它将创建一个新设置（如果之前未设置）或覆盖此类设置。

当然，如果您在加载另一个配置*后*再次覆盖两个配置中设置的任何值。最后一个获胜。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T17:17:09.860

您基本上需要创建一个 php 文件并使用键值对定义 $cfg 数组。例子

```
<?php

$cfg['some_var'] = 'value';
$cfg['som_other_var'] = 'some other value'; 
```

# ruby-on-rails - 如何在 Ruby on Rails 中为通知设置“监视”？

> ID：10401237
> 
> 赞同：1
> 
> 时间：2012-05-01T16:57:05.167
> 
> 标签：ruby-on-rails, ruby, design-patterns

我想为我的 Web 应用程序设置一个简单的通知系统，它是用 Ruby on Rails 编写的。我的网站是一个简单的拍卖网站，但每次拍卖都有 2 个阶段：一个 5 天的“无最低出价”阶段，任何人都可以出价；一个 3 天的“最低出价 1 美元”阶段，只有前 10% 的投标人阶段可以出价。

我想在拍卖从第一阶段进入第二阶段时通知我的用户。做这个的最好方式是什么？

我想到了两种设计方案：

*   我不知道 RoR 有这个，以及这是否是一个有效的系统（因为我想建立一个系统，让成千上万的用户参与数百次拍卖 - 它是否变得那么大无关紧要，这有点像我学习编写高质量、可扩展的 RoR 的一个附带项目）但基本上，当用户在拍卖中出价时，他们会成为拍卖中的某种观察者。然后，不知何故，在第 5 天的时候，所有的听众都会收到通知。我不知道该触发器是如何在 RoR 中发生的（有没有办法说“在创建后 5 天后触发”或类似的事情？）。总而言之，我想使用观察者模式。

    对我来说，关键问题是试图弄清楚如何在一段时间后触发。我认为，最好的方法是为每次拍卖设置一些称为“拍卖状态”的状态变量。一段时间后，这种情况会发生转变，届时拍卖中的每个观察者都会收到通知。

*   每天有一个 rake 任务在每天的某个固定时间运行。它通过每次拍卖，如果在第 6 天有任何拍卖，则通知该拍卖的观察者。这似乎是一种非常糟糕的方式——我喜欢有状态拍卖的想法。

想法？

谢谢！林戈

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T17:28:02.007

您可以查看[https://github.com/pluginaweek/state_machine](https://github.com/pluginaweek/state_machine)，特别是转换回调。或者，您也可以使用标准的活动记录回调[http://api.rubyonrails.org/classes/ActiveRecord/Callbacks.html](http://api.rubyonrails.org/classes/ActiveRecord/Callbacks.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T17:41:42.293

看看[https://github.com/bvandenbos/resque-scheduler](https://github.com/bvandenbos/resque-scheduler)，如果你还没有听说过，resque 是一个用于创建后台处理的 gem，在 redis 中有队列。这个 gem resque-scheduler，让您指定何时运行任务/作业。

例如，在您的模型中，您将有一个 after_create 来安排更改投标状态的任务。

```
 after_create :shedule_state_change

  private
    def record_signup
      Resque.enqueue_in(5.days, ChangeState)
    end 
```

然后，您可以通知该任务中该投标的所有投标人，或为其创建一个观察者。

# c++ - 计算位掩码，枚举 0

> ID：10401239
> 
> 赞同：6
> 
> 时间：2012-05-01T16:57:14.090
> 
> 标签：c++, python, c, binary

我在一次采访中遇到了以下问题，我相信我给出了一个有效的实现，但我想知道是否有更好的更快的实现，或者只是我错过了一个技巧。

给定 3 个无符号 30 位整数，返回 30 位整数的个数，当与任何原始数字比较时，具有相同的位置位设置为 1。也就是说，我们枚举所有的 0

让我举个例子，但为了清楚起见，让我们使用 4bit。

鉴于：

```
A = 1001
B = 0011
C = 0110 
```

它应该返回 8，因为集合中有 8 个 4 位整数。集合是：

```
0011
0110
0111
1001
1011
1101
1110
1111 
```

现在我的计算方法是获取每个数字并枚举一组可能性，然后计算所有不同的值。我枚举集合的方式是从数字开始，向其添加一个，然后将其与自身 OR 直到我到达掩码。数字本身在集合中，掩码（全部设置为 1）也在集合中。因此，例如枚举 1001 的集合：

```
1001 = the start
1011 = (1001 + 1) | 1001
1101 = (1011 + 1) | 1001
1111 = (1101 + 1) | 1001 (this is the last value as we have reached our mask) 
```

所以对每个数字都这样做，然后计算唯一性。

这就是python代码中的内容（但是只要您可以进行按位运算，语言并不重要，因此为什么这个问题也被标记为c / c ++）：

```
MASK = 0x3FFFFFFF

def count_anded_bitmasks( A, B, C ):
    andSets = set(
      enumerate_all_subsets(A) +
      enumerate_all_subsets(B) +
      enumerate_all_subsets(C)
    )
    return len(andSets)

def enumerate_all_subsets( d ):
    andSet = []
    n = d
    while n != MASK:
        andSet.append(n)
        n = (n + 1) | d
    andSet.append(n)
    return andSet 
```

现在这有效并给出了正确的答案，但我想知道我是否错过了一个技巧。由于问题是只询问计数而不枚举所有值，因此也许有一种更快的方法。要么先组合数字，要么在不枚举的情况下进行计数。我有一种感觉。由于包含大量零的数字，枚举呈指数增长，并且可能需要相当长的时间。

如果您有 AB 和 C，则将位设置为 1 的数字集的计数，其中 A、B 或 C 的相应位设置为 1。

有些人不理解这个问题（没有帮助我没有首先正确地问它）。让我们使用上面给定的 AB 和 C 值：

A：

```
1001
1011
1101
1111 
```

乙：

```
0011
0111
1011
1111 
```

C：

```
0110
0111
1110
1111 
```

现在组合这些集合并计算不同的条目。这就是答案。有没有办法在不枚举值的情况下做到这一点？

编辑：对不起这个问题的错误。现在修好了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-01T17:29:20.237

**编辑：**更新要求：*给定 3 个无符号 30 位整数，返回 30 位整数的数量，与任何原始数字相比，将相同的位置位设置为 1。也就是说，我们枚举所有的 0*

好吧，这有点难。计算一个数字很容易，因为在这种情况下，可能的整数数量仅取决于零位的数量，如下所示：

```
// Count bits not set
const size_t NUMBITS=30;
size_t c;
size_t v = num;
for (c=NUMBITS; v; v >>= 1) 
  c -= v & 1;

return c; 
```

天真地，您可能会尝试通过对每个整数执行此操作并将结果求和来将其扩展到三个整数，但是这是错误的，因为可能性需要是*唯一的*，例如给定

```
A = 1001
B = 0011
C = 0110 
```

例如，您将计数 1111 三次而不是一次。您应该减去任何两个数字之间共享的组合数，但不要将任何组合减去两次。 **这只是 Winston Ewert 答案的 C++ 翻译！**

```
size_t zeroperms(size_t v)
{
    // Count number of 0 bits
    size_t c = 1;
    for (c=NUMBITS; v; v >>= 1)
        c -= v & 1;
    // Return number of permutations possible with those bits
    return 1 << c;
}

size_t enumerate(size_t a, size_t b, size_t c)
{
    size_t total = zeroperms(a) + zeroperms(b) + zeroperms(c);
    total -= zeroperms(a | b); // counted twice, remove one
    total -= zeroperms(b | c); // counted twice, remove one
    total -= zeroperms(a | c); // counted twice, remove one
    total += zeroperms(a | b | c); // counted three times, removed three times, add one
    return total;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T17:55:02.383

```
N = 4

def supers(number):
    zeros = sum(1 for bit in xrange(N) if (number >> bit) & 1 == 0)
    return 2**zeros

def solve(a,b,c):
    total = supers(a) + supers(b) + supers(c)
    total -= supers(a | b) # counted twice, remove one
    total -= supers(b | c) # counted twice, remove one
    total -= supers(a | c) # counted twice, remove one
    total += supers(a | b | c) # counted three times, removed three times, add one

    return total

print solve(0b1001,0b0011,0b0110) 
```

## 解释

设`S(n)`为由数产生的集合`n`。

`supers(n)`返回`|S(n)|`数字 n 的集合的大小。`supers`不是一个好名字，但我很难想出一个更好的名字

诀窍是意识到这一点`S(a) ^ S(b) = S(a | b)`。结果，使用超级我可以计算出所有这些集合的大小。

要弄清楚其余部分，请绘制集合的维恩图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T17:17:30.537

### 技巧1：

总的答案是每个单独的 30 位数字的并集。这转换为按位联合运算符 OR。这意味着我们可以`D = A | B | C` 使用您的 4 位示例，我们到达`D = 1111` 现在我们只需要使用 1 个数字

### 技巧2：

一点点数学告诉我们，每`1`增加一倍我们可能的数字集。这意味着您需要做的就是将 2 提高到 1 的数量的幂。循环数1，每次向下移动

```
bits = 0
D = 0b1111 #our number from trick 1
for i in range(4): #here 4 is the number of bits
    if D & 1:
        bits += 1
    D >>= 1 #drop off the smallest number
print 2 ** bits 
```

在这种情况下，它将打印 16

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-01-29T10:08:18.110

在 C# 中计算零的数量。许多零，你可以用给定的数字屏蔽的多种方式。因此，零的数量将使需要考虑的数字数量的变化=>这将是 2^（零计数）。

然后累积每三个数字的总匹配数。这里有些数字可能会翻倍。所以减去那个数字。添加为前一个数字减去的常用数字（按照三个重叠圆圈的范图）。

```
public static int count(int d)
    {
        int bits = 0;
        for(int i = 0; i < 30; i++)
        {
            if(((d>>i)&1)==0) bits++;
            //if ((d & 1) == 0) bits++;
            //d >>= 1; //shift right
        }
        return (int)Math.Pow(2, bits);
    }
    public static int BitWiseConfirm(int A, int B, int C)
    {
        // write your code in C# 6.0 with .NET 4.5 (Mono)
        int total = 0;
        total += count(A);
        //Console.WriteLine("total"+total);
        total += count(B);
        //Console.WriteLine("total"+total);
        total += count(C);
        //Console.WriteLine("total"+total);
        //remove duplicates
        total -= count(A | B);
        //Console.WriteLine("total"+total);
        total -= count(B | C);
        //Console.WriteLine("total"+total);
        total -= count(C | A);
        //Console.WriteLine("total"+total);
        total += count(A | B | C);
        //Console.WriteLine("total"+total);
        return total;
    } 
```

# debian - 在 debian 中杀死一个进程 - “sh: /usr/bin/p$: not found”

> ID：10401241
> 
> 赞同：0
> 
> 时间：2012-05-01T16:57:19.830
> 
> 标签：debian

我刚刚通过 shell 登录到我的服务器，因为我被拒绝通过 ssh 访问。似乎有一个持续运行的过程并产生以下结果 -

```
sh: /usr/bin/p$: not found
sh: /usr/bin/p$: not found
sh: /usr/bin/p$: not found
sh: /usr/bin/p$: not found 
```

关于如何阻止这种情况的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T17:46:49.287

pstree 和更详细的“pstree -cpa”可以很好地反映整个系统的子进程关系。

很难捕捉短暂的进程，但如果你确实捕捉到了它，pstree 将显示正在启动的进程是什么。

示例 pstree 输出：

```
pstree
init─┬─acpid
     ├─atd
     ├─avahi-daemon───avahi-daemon
     ├─bluetoothd
     ├─bonobo-activati───2*[{bonobo-activat}]
     ├─chrome─┬─chrome───{chrome}
     │        ├─chrome
     │        └─21*[{chrome}]
     ├─chrome─┬─2*[chrome───4*[{chrome}]]
     │        └─nacl_helper_boo
     ├─console-kit-dae───64*[{console-kit-da}]
     ├─cron
     ├─cupsd
     ├─2*[dbus-daemon]
     ├─dbus-launch
     ├─dhclient
     ├─dnsmasq
     ├─gconfd-2
     ├─gdm-binary─┬─gdm-simple-slav─┬─Xorg
     │            │                 ├─gdm-session-wor─┬─gnome-session─┬─applet.+
     │            │                 │                 │               ├─bluetoo+
     │            │                 │                 │               ├─gdu-not+
     │            │                 │                 │               ├─gnome-p+
     │            │                 │                 │               ├─gnome-p+
     │            │                 │                 │               ├─metacit+
     │            │                 │                 │               ├─mintupd+
     │            │                 │                 │               ├─nautilu+
     │            │                 │                 │               ├─polkit-+
     │            │                 │                 │               ├─ssh-age+
     │            │                 │                 │               ├─wicd-cl+
     │            │                 │                 │               ├─zeitgei+
     │            │                 │                 │               └─2*[{gno+
     │            │                 │                 └─{gdm-session-wo}
     │            │                 └─{gdm-simple-sla}
     │            └─{gdm-binary}
     ├─6*[getty]
     ├─gnome-keyring-d───5*[{gnome-keyring-}]
     ├─gnome-screensav───{gnome-screensa}
     ├─gnome-settings-───{gnome-settings}
     ├─gvfs-afc-volume───{gvfs-afc-volum}
     ├─gvfs-fuse-daemo───3*[{gvfs-fuse-daem}]
     ├─gvfs-gdu-volume
     ├─gvfs-gphoto2-vo
     ├─gvfsd
     ├─gvfsd-burn
     ├─gvfsd-metadata
     ├─gvfsd-trash
     ├─indicator-apple───2*[{indicator-appl}]
     ├─indicator-appli───{indicator-appl}
     ├─indicator-sound───2*[{indicator-soun}]
     ├─irqbalance
     ├─libvirtd───6*[{libvirtd}]
     ├─mintmenu─┬─gnome-terminal─┬─bash───pstree
     │          │                ├─gnome-pty-helpe
     │          │                └─2*[{gnome-terminal}]
     │          └─2*[{mintmenu}]
     ├─named───4*[{named}]
     ├─nmbd
     ├─notify-osd───{notify-osd}
     ├─polkitd───{polkitd}
     ├─pulseaudio─┬─gconf-helper───{gconf-helper}
     │            └─2*[{pulseaudio}]
     ├─rsyslogd───2*[{rsyslogd}]
     ├─rtkit-daemon───2*[{rtkit-daemon}]
     ├─smbd───smbd
     ├─syndaemon
     ├─udevd───2*[udevd]
     ├─udisks-daemon─┬─udisks-daemon
     │               └─2*[{udisks-daemon}]
     ├─upowerd───{upowerd}
     ├─upstart-socket-
     ├─upstart-udev-br
     ├─wicd───wicd-monitor
     ├─wnck-applet───{wnck-applet}
     ├─wpa_supplicant
     └─zeitgeist-daemo─┬─cat
                       ├─zeitgeist-datah
                       └─{zeitgeist-daem} 
```

添加选项 -cpa

pstree -cpa

通过提供每个进程的详细信息、要终止的进程号以及启动进程时指定的任何选项来更改显示

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-07T07:24:22.797

您还可以对包含以下内容的脚本进行暴力搜索`/usr/bin/p$`：

```
find /*bin/ /usr/*bin/ /usr/local/*bin/ /etc/cron.*/ /etc/init.d/ -type f -exec egrep -l '^\/usr\/bin\/p\$' \{\} \; 
```

并且 - 如果失败了 - 更野蛮的事情：

```
find / -type f -exec egrep -l '^\/usr\/bin\/p\$' \{\} \; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-23T19:59:22.837

**使用 killall**
要杀死一个进程，您可以使用：
`kill <PID>`
或者
`killall <Process Name>`

你可以通过做找到左边的pid`ps -aux`

:) --- Olivr3000

# java - 为什么当我将我的国际象棋项目作为可运行的 jar 文件运行时，我会得到一个奇怪的行为，而当我在 eclipse 中运行它时一切正常？

> ID：10401242
> 
> 赞同：3
> 
> 时间：2012-05-01T16:57:22.630
> 
> 标签：java, jar, export, nullpointerexception

有一天，我决定通过构建一个简单的国际象棋游戏来测试我的 Java 技能。我花了一些时间，过了一会儿我完成了。现在问题从这里开始：我想把我的游戏发给我的朋友，所以我通过 Eclipse 创建了一个可运行的 jar 文件。令人惊讶的是，可运行 jar 文件中的游戏显示了一些奇怪的行为，例如 Pieces 出现在它们不应该出现的地方以及一些其他奇怪的错误，但没有任何例外。当我意识到当我在 Eclipse 中运行项目时，我更加惊讶了，一切都像它应该的那样工作。我也尝试通过 Eclipse 创建一个普通的 jar 文件并运行它，但是我得到了以下 NPE 错误：

```
01/05/12 19:47:30.433 [0x0-0x54054].com.apple.JarLauncher: Exception in thread "main" 

01/05/12 19:47:30.498 [0x0-0x54054].com.apple.JarLauncher: java.lang.NullPointerException

01/05/12 19:47:30.498 [0x0-0x54054].com.apple.JarLauncher:  at sun.launcher.LauncherHelper.getMainClassFromJar(LauncherHelper.java:399)

01/05/12 19:47:30.498 [0x0-0x54054].com.apple.JarLauncher:  at sun.launcher.LauncherHelper.checkAndLoadMain(LauncherHelper.java:463) 
```

我已经在这个网站上发布了一个关于这个的问题，但是我没有得到正确的答案，所以我也发布了这个问题。这是另一个问题的链接：[Getting a奇怪行为时在 Eclipse 上为我的 Chess 项目创建可运行的 jar 文件](https://stackoverflow.com/questions/10385696/getting-a-strange-behavior-when-creating-a-runnable-jar-file-on-eclipse-for-my-c)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T21:07:24.503

您应该在可执行 jar 中具有以下清单标头：

```
Main-Class: classname 
```

您可以在从 Eclipse 导出 jar 时自动执行此操作，方法是在导出 jar 向导中选择一个主类。

# android - 通过重定向链接在 Google Play 中打开应用

> ID：10401247
> 
> 赞同：25
> 
> 时间：2012-05-01T16:57:40.827
> 
> 标签：android, google-play

在 Android 设备上，打开指向 Google Play 应用程序的链接：

[https://play.google.com/store/apps/details?id=com.rovio.angrybirds&hl=en](https://play.google.com/store/apps/details?id=com.rovio.angrybirds&hl=en)

默认情况下会自动打开 Google Play 应用。

但是，如果您有一个重定向到 Google Play 链接的链接，设备会打开浏览器，然后导航到 Google Play 的浏览器版本。为什么会出现这种行为？

不幸的是，我不能将 market:// 与可以打开 Play 的 Intent 一起使用，我只能控制一个网络链接。

**编辑：** 似乎如果我将链接重定向到市场：// url，它可以在设备上使用 Google Play 打开。

如果在浏览器中打开链接，尽管浏览器不支持 market://，但它能够以某种方式重定向到 Google Play 的浏览器版本。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-12-11T03:02:44.100

采用`target="_top"`

```
 <a href="market://details?id={package_name}" target="_top">App</a> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-01T17:30:06.367

基本上，[https://play](https://play) .... 只是一个 Web URL。我怀疑它的工作方式（这是 Android 的标准工作方式）是：

1.  Market Play 应用程序注册为能够处理此类 URL（您可以注册以处理某些意图，并应用过滤器来进一步定义您的应用程序将处理的内容）。
2.  [该应用程序使用https://play](https://play) ... URL启动 Intent
3.  向用户显示已注册以处理该意图的所有应用程序的列表。因此，用户能够启动 Play 应用程序 - 第一次（在手机上）启动 https:\play... 意图
4.  当用户选择哪个应用程序来实现 Intent 时，如果他们选择浏览器（然后将其设置为默认值） - 浏览器将启动（并且下次不会为用户提供选项）。
5.  此默认值可以是：“Settings\Applications\All - 然后找到浏览器应用程序，选择它，然后选择清除默认值”

您可以根据市场意图直接调用 Play Market，也可以使用 URL 方式。我个人使用 URL 方式——尽管使用它有一些额外的挑战（比如处理这个特定问题）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T17:06:44.047

我的猜测是这种行为是由谷歌强制执行的。重定向可能会使恶意的开发人员更容易安装他们的应用程序。Google 可能会检查用户是否来自重定向，如果是，则不会触发 Play 应用程序的打开。

# jquery - jQuery 自动完成功能适用于测试网络服务器，但不适用于生产网络服务器

> ID：10401252
> 
> 赞同：0
> 
> 时间：2012-05-01T16:57:57.117
> 
> 标签：jquery, autocomplete

我正在尝试为我的公司网站实现 jquery 自动完成功能，结果发现虽然我的本地网络服务器上一切正常，但当我将其上传到生产网络服务器时却无法正常工作。我已经完成了确保所有必需文件都正确上传和配置的典型故障排除例程，因此我可以放心地将其作为问题的根源丢弃。

使用 FireBug 查找发生了什么的线索，我查看了我的 HTTP 标头，发现在我的本地网络服务器和生产网络服务器上，请求标头似乎是相同的。这是请求标头：

> 接受 application/json, text/javascript, */*; q=0.01 Accept-Encoding gzip, deflate Accept-Language en-us,en;q=0.5 Connection keep-alive Content-Length 56 Content-Type application/x-www-form-urlencoded; charset=UTF-8 Cookie pemco_tpl=pemco; __utma=249376134.120577909.1319559821.1335888590.1335890492.201；__utmz=249376134.1335369030.191.2.utmcsr=google|utmccn=(有机)|utmcmd=有机|utmctr=(未提供%20); __utmc=249376134; csrf_cookie_name=822b8ced4d8a7bc49d02b11f44efcb15；ci_session=UmYHbQs0VmsGfQckUDxRYwMyAD8Fc1UgXGUNdQMrVT0BbQxpXANWawIzVSdaalcjATtTMFUxBz5TcANkVjBabVE8DmdQaVA0VGYKOAxtUmdSMgdlCzdWYAY2B2BQPlFrA2AAYQUyVWZcZA0zA2BVZwE0DGZcZVZkAjZVJ1pqVyMBO1MyVTMHPlNwA29WcloDUWwOYVBvUCNUMgpyDH9SJFI8ByQLOlZgBjIHbVAkUWADMgA1BX9VYlwyDTIDdlVnATIMKVxtVjECZ1UnWmpXIwE7UzJVMwc%2BU3ADc1ZxWjlRfw5aUGpQNlQyCm8MeFIkUjwHJAs6VmYGNAdtUCRRHwNtAH8FOFU%2FXGwNZwN3VWEBLAw3XHxWKgIAVWxaP1c0AW5TdFVwByRTHANSViJaalEjDjRQMFBxVAAKTgxbUjBSMwdsCyBWIwZwB21QN1FjAywANQV4VXNcRw1jAztVPwFtDChcblYyAmZVNVphV2EBMVMyVSMHQlM7A3RWZ1o6UWIOfVAkUGBUZgovDDxSJFI8ByQLOlZgBjUHbVAkUT4DYwB2BSVVDFxhDWUDLFU9AXQMblwoVnsCdVU%2BWjhXagEwUzBVMAcxU2oDP1YyWmhRNA41UDBQLA%3D%3D; __utmb=249376134.2.10.1335890492 主机 www.pemco.com.pa 推荐人[http://www.pemco.com.pa/](http://www.pemco.com.pa/) User-Agent Mozilla/5.0 (Windows NT 6.1; WOW64; rv:11.0) Gecko/20100101 Firefox/11.0 X-Requested-With XMLHttpRequest

然而，响应标头差异很大。这是我本地网络服务器的响应标头：

> Connection Keep-Alive Content-Length 289 Content-Type text/html Date Tue, 01 May 2012 15:48:05 GMT Keep-Alive timeout=5, max=100 Server Apache/2.2.21 (Win32) PHP/5.3.9设置 Cookie csrf_cookie_name=3473477c216fd9456d709fb0dbda10e1; expires=星期二，2012 年 5 月 1 日 17:48:05 GMT；path=/ ci_session=4cmpiXkC37H53h8PD3hIRPObPeip0rCTEEYg5CDilBAi7k9J%2BesxJbu21Ls2Kbo8vSrW3ptOtEGNL1K8pGxI6%2BG1D8ZNd7%2BYiwNQG55MBRz7sAvwtIX7hVDPlyglV3DZwlOH0eCSlPFm7ZmdH46KTnwbd3%2FcftOykBlJZKlNHpdY9obcKVnYTVaCAta3fFGiM4K%2FfoqlIz%2FPCpn9Kfghv8r7fjJ7z17H8huuoWE%2FI0EmTWyag3wJxrshi80ab7JZ1c73f7cIZTpTKn7bMFB4vm9cSgu6XXBFw%2Fmx2bAoawmQHRMhQFHtBZaLcHZGHCrPwLcX3qr8KwxzfwpvKN7TzEX0GpQHJZL72CwAEA8cJ27EfzBfzx1qz8KQ4VL1W1Hq; path=/ X-Powered-By PHP/5.3.9

这是来自我的生产网络服务器的响应标头：

> Connection Keep-Alive Content-Length 0 Content-Type text/html Date Tue, 01 May 2012 16:41:51 GMT Keep-Alive timeout=15, max=90 MS-Author-Via DAV Server Apache Set-Cookie csrf_cookie_name=822b8ced4d8a7bc49d02b11f44efcb15 ; expires=星期二，2012 年 5 月 1 日 18:41:51 GMT；path=/ X-Powered-By PleskLin

我可以清楚地看到来自生产网络服务器的响应标头返回的 Content-Length 为 0，但我的问题是为什么？正如我之前提到的，我非常有信心我的所有脚本都已正确上传和配置，因此它必须是我的生产网络服务器上的某种类型的配置，它以某种方式影响了我的脚本。我的公司网站的 URL 是[www.pemco.com.pa](http://www.pemco.com.pa)，以防您自己检查。我真诚地感谢您为解决此问题提供的任何帮助。我完全被困在这一点上，不知道该怎么做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T15:54:01.737

问题已解决。问题是我的生产网络服务器使用的是 PHP v5.1，并且直到 PHP v5.2 才包含对 JSON 的本机支持。使用 PECL 安装 JSON 扩展后，我设法解决了这个问题。感谢大家的反馈。

# jquery - jQuery多选

> ID：10401255
> 
> 赞同：1
> 
> 时间：2012-05-01T16:58:19.760
> 
> 标签：jquery, jquery-selectors

有这个代码：

```
 var firstname = $('#Passenger_FirstName');
 var lastName = $('#Passenger_LastName');

 $('#Passenger_FirstName,#Passenger_LastName').keyup(function () {}); 
```

我想像这样使用它：

```
$(firstname,lastname).keyup(function () {}); 
```

但是选择器似乎无法正常工作，有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T17:01:31.910

你也可以使用`.add()`

```
firstname.add(lastName).keyup(function() {}); 
```

# asp.net-mvc-3 - MVC3 和 Razor：如何构建表单和操作以允许类似回发的功能？

> ID：10401256
> 
> 赞同：0
> 
> 时间：2012-05-01T16:58:33.107
> 
> 标签：asp.net-mvc-3

我有一个带有下拉列表的视图。其默认值存储在会话变量中。但是，用户更改会对此进行更改，在这种情况下会输入新数据。

我在下拉列表中有一个更改处理程序：

```
@using (Html.BeginForm())
{
  @Html.DropDownListFor(model => model.SelectedID, 
                        new SelectList(Model.SelectValues, "Key", "Value",
                        Model.SelectedID), "", new { onchange = "this.form.submit()" });

 ... more fields ...
 <input type="submit" name="Save" />
}

  [HttpPost]
  public ActionResult Index(ViewModel vm)
  {
     ... decide if I update my data or save the changes ...
  } 
```

我尝试将选择包装在一个单独的表单标签中，但是我的 SelectedID 的值没有在我的视图模型中更新。

如何确定何时通过下拉更改发布表单，以及何时通过单击按钮发布表单？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T17:02:23.653

如果您不想在用户更改下拉列表的选择时重新加载整个页面，您可以使用 AJAX 静默触发对不同控制器操作的请求，该操作将执行必要的更新。例如：

```
@Html.DropDownListFor(
    model => model.SelectedID, 
    new SelectList(Model.SelectValues, "Key", "Value"), 
    "", 
    new { 
        id = "myddl",
        data_url = Url.Action("update")
    }
) 
```

然后在一个单独的 javascript 文件中：

```
$(function() {
    $('#myddl').change(function() {
        var form = $(this).closest('form');
        $.ajax({
            url: $(this).data('url'),
            type: 'POST',
            data: form.serialize(), 
            success: function() {
                alert('update success');
            }
        });
    });
}); 
```

最后你可以有一个负责更新的控制器操作：

```
[HttpPost]
public ActionResult Update(ViewModel vm)
{
    ... this will be triggered everytime the user changes some value in the
        droipdown list
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T17:03:07.427

最简单的方法是简单地将一些行为附加到这些元素的事件上，并使用事件目标设置一个隐藏字段（现在听起来应该非常熟悉`__EVENTTARGET`）。

像这样：

```
$('#someButton').click(function()
{
    $('#someHiddenField').val('someButton');
});

$('#someDropDown').change(function()
{
   $('#someHiddenField').val('someDropDown');
}); 
```

然后你的操作方法可以检查这个值并采取适当的行动。

**然而**

听起来您正在考虑 MVC 的过时概念。如果您确实需要一些新信息，您应该考虑使用一些 Ajax，然后如果您想更新页面的一部分，则让您的操作方法之一返回部分视图。

# javascript - 动态加载到 iframe 中的 JavaScript 在父范围内运行

> ID：10401260
> 
> 赞同：1
> 
> 时间：2012-05-01T16:58:45.610
> 
> 标签：javascript, jquery, html, iframe

我有一个 iframe，我使用以下代码动态地将一些 html+javascript 加载到其中：

```
var allMyCode = "<div id='test'>html code</div> <script type='text/javascript'>alert(document.getElementById('test').innerHTML);<\/script>";
$("#myFrame").contents().find("body").html(allMyCode); 
```

问题是我希望这能提醒文本“html 代码”，但它实际上获取了 id 为“test”的父级 div 中的 html，因此它没有引用自身。我在这个小提琴中展示了这个：http: [//jsfiddle.net/BNG4n/](http://jsfiddle.net/BNG4n/)

为什么要这样做，我怎样才能让 JavaScript 在自己的范围内运行！？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T17:07:36.120

因为`jQuery`在设置 iframe 的 body 元素的 html 之前执行 script 元素，它总是在父范围内。

您可以尝试创建一个脚本元素并将其附加到 iframe 的正文中，它将按预期工作。

像这样的东西。

```
var allMyCode = "<div id='test'>html code</div>";
$("#myFrame").contents().find("body").html(allMyCode);
var el = document.createElement("script");
el.setAttribute("type","text/javascript");
el.innerHTML = "alert(document.getElementById('test').innerHTML);";
$("#myFrame").contents().find("body")[0].appendChild(el); 
```

工作演示 - [http://jsfiddle.net/BNG4n/1/](http://jsfiddle.net/BNG4n/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T17:13:43.643

问题是你在你的 js 中指的是文档，就目前的 javascript 而言，它仍然指的是父文档。

相反，您必须先找到框架（document.getElementById（'myFrame'）），然后从框架（contentWindow.document）中的测试ID中找到HTML内容，如下所示：

```
var allMyCode = "<div id='test'>html code</div> <script type='text/javascript'>alert(document.getElementById('myFrame').contentWindow.document.getElementById('test').innerHTML);<\/script>"; 
```

# linux - 在 Linux 内核级别限制用户登录

> ID：10401261
> 
> 赞同：0
> 
> 时间：2012-05-01T16:58:54.827
> 
> 标签：linux, linux-kernel, kernel

在某些事件（例如某些用户的注销）之后，通过内核 haking 限制系统中任何用户的登录是可能的（并且是合理的？）？可能存在其他方式吗？如果可能，需要修改内核源代码的哪一部分？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T17:02:29.067

通过操作用户数据库或更改登录程序在用户空间中执行此操作。必要的支持是内核中已经存在的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T17:21:49.057

这应该可以解决问题：

```
touch /etc/nologin 
```

对于此类问题，触摸内核是不明智的。请参阅[man nologin](http://linux.die.net/man/8/pam_nologin)。“root”用户仍然可以登录。

# java - 如何以二进制形式打印 Long？

> ID：10401263
> 
> 赞同：6
> 
> 时间：2012-05-01T16:58:55.293
> 
> 标签：java

我正在尝试以二进制形式打印 Long ，但它一直在切断`0`'s. 有没有办法强制它显示所有位？

这是我的代码：

```
long l = 1;
System.out.println(Long.toBinaryString((long)l)); 
```

仅`1`由于删除`0`'si 希望保持：

`0000 0000 0000 0000 0000 0000 0000 0001`

提前致谢。

我临时讨厌的解决方案：

```
public String fillZeros(Long value) 
{
    String str = Long.toBinaryString((long) value);
    String temp;
    temp = str;
    while(temp.length() < 32) {
        temp = "0" + temp;
    }
    return temp;
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-01T17:11:46.323

你可以这样做

```
for(int i = 0; i < Long.numberOfLeadingZeros((long)l); i++) {
      System.out.print('0');
}
System.out.println(Long.toBinaryString((long)l)); 
```

这将得到你想要的，除了每 4 个数字之间没有空格（你应该能够编码）。可能有一种方法可以使用[Formatter](http://docs.oracle.com/javase/6/docs/api/java/util/Formatter.html)自动执行此操作， 但我找不到它。

编辑：

如果你知道你需要的 0 的数量，你可以使用`String's`格式方法（我忘了把它改回一个数字，这将修复异常）。

```
String.format("%032d", new BigInteger(Long.toBinaryString((long)l))); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T17:27:04.403

如果你愿意引入 Apache Commons StringUtil，你可以这样做：

```
 long l = 1;
    System.out.println( StringUtils.leftPad( Long.toBinaryString( l ), 64, "0" ) ); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2018-03-23T17:42:59.393

```
long value=4;
String mask = "00000000000000000000000000000000";
String str = Long.toBinaryString((long) value);
System.out.println(mask.substring(0, mask.length()-str.length())+str);

For a value of 4 the result will be 00000000000000000000000000000100 
```

# c# - 输入字符串的格式不正确 - 计算标签总数

> ID：10401267
> 
> 赞同：0
> 
> 时间：2012-05-01T16:59:17.307
> 
> 标签：c#

基本上，下面的第一个 for 语句会根据用户输入创建一个 testvalue 标签列表。

第二个 for 语句应该计算出创建的动态标签的总数，但是当我播放它时，我收到一条错误消息，说“输入字符串的格式不正确”。`tots += double.Parse(value[p].ToString());`任何帮助将不胜感激。 谢谢

```
ArrayList value = new ArrayList();

int p =0;

for (int i = 0; i < weight.Count; i++)
{
    Label test = new Label();
    System.Drawing.Point l8 = new System.Drawing.Point(440, 48 + s);
    test.Location = l8;
    value.Add(test);

    k += 35;

    Label l2 = testpercent1[i] as Label;
    Double.TryParse(l2.Text.Trim(), out label2);
    Label l = testpercent2[i] as Label;
    Double.TryParse(l.Text.Trim(), out label1);
    Double testvalue = Math.Round(((label1 * .3) + (label2 * .4)));
    test.Text = testvalue.ToString();
}

Double total = 0;
for (int p = 0; p < value.Count; p++)
{
    tots += double.Parse(value[p].ToString());
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T17:04:22.893

```
tots += double.Parse(((Label)value[p]).Text); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T17:05:36.637

value[p] is of type Label. If you want to get the text value of the label, you should use value[p].Text.

```
Double total = 0;
for (int p = 0; p < value.Count; p++)
{
   tots += double.Parse(((Label)value[p]).Text);
} 
```

Another thing, you should use `List<Label>` for value instead of `ArrayList`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T17:05:39.117

You are trying to parse the `ToString()` of a label. Were you instead looking to parse some property of the label?

When you call `value[p]`, whats being returned is a on object of type `Label`. If you wanted to parse the text of the label your code would instead be

`tots += double.Parse(((Label)value[p]).Text);`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-01T17:05:56.163

It's obvious you are adding a control to the ArrayList. So this don't work:

```
tots += double.Parse(value[p].ToString()); 
```

I reccomend you to do:

```
value.Add(test.Text); 
```

Then:

```
tots += double.Parse(value[p]); 
```

**PS:** Please use a `List<string>` instead of an `ArrayList`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-01T17:08:03.727

Storing your data in labels is a very bad idea. Use a data structure that is better suited for this purpose like an array or a list of doubles. Only use the lables for displaying the data.

```
double[] values = new double[N];
Label[] lables = new Label[N]; // Only for display!

//  Calculate (just as an example)
double result = values[i] + values[k];

// NOT LIKE THIS!
double result = Double.Parse(labels[i]) + Double.Parse(labels[k]); 
```

# vb.net - 为什么不在 VB.NET 中使用“Return”语句？

> ID：10401269
> 
> 赞同：1
> 
> 时间：2012-05-01T16:59:24.977
> 
> 标签：vb.net, return

我已经获得了一些代码来查找问题和可以改进和改变的东西（这是一个家庭作业，但这个问题与任务本身无关），部分代码是：

```
Function CheckIfSameCell(ByVal FirstCellPosition As CellReference, ByVal SecondCellPosition As CellReference) As Boolean
    Dim InSameCell As Boolean
    InSameCell = False
    If FirstCellPosition.NoOfCellsSouth = SecondCellPosition.NoOfCellsSouth And FirstCellPosition.NoOfCellsEast = SecondCellPosition.NoOfCellsEast Then
        InSameCell = True
    End If
    CheckIfSameCell = InSameCell
End Function 
```

我不明白为什么要`InSameCell`创建 is 变量，什么时候可以将它分配给函数名`CheckIfSameCell`？

或者只使用如下的 return 语句？

```
Function CheckIfSameCell(ByVal FirstCellPosition As CellReference, ByVal SecondCellPosition As CellReference) As Boolean
    If FirstCellPosition.NoOfCellsSouth = SecondCellPosition.NoOfCellsSouth And FirstCellPosition.NoOfCellsEast = SecondCellPosition.NoOfCellsEast Then
        Return True
    End If
    Return False
End Function 
```

我可以理解不`If`直接返回语句中的表达式，以增加可读性。

我知道为函数名称分配返回值不会退出函数，而 Return 会退出，但这只是一个人的风格，还是第一个版本有什么优势（IMO，第二个更具可读性）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T17:09:26.590

也许曾经有更多的检查，其中的值`InSameCell`可能会更改多次，然后才会返回。使用`return`then 会改变行为。

也许作者想避免繁琐的重命名。你知道，当你想重命名一个函数，并且你在它自己的函数体中多次使用这个函数的名字时，你有很多地方可以替换，而当你引入一个变量时，你只有一个地方可以改变名字。 （我知道 IDE 会为你正确地做到这一点；但在 VB6 中情况并非如此，而且习惯很难改掉。）

也许作者对没有`return`.

也许这是风格或政策的问题。

无论如何，我会把它写成：

```
Function CheckIfSameCell(ByVal FirstCellPosition As CellReference, ByVal SecondCellPosition As CellReference) As Boolean
    Return FirstCellPosition.NoOfCellsSouth = SecondCellPosition.NoOfCellsSouth AndAlso FirstCellPosition.NoOfCellsEast = SecondCellPosition.NoOfCellsEast
End Function 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-01T17:28:43.437

将结果分配给函数名是 VB6 中使用的旧样式，在 VB.NET 中不应再使用。使用`Return value`！

就我个人而言，我不喜欢这种风格的陈述

```
If condition Then
    Return True
Else
    Return False
End If 
```

他们只是愚蠢，因为`condition`已经产生了返回值！更好的：

```
Return condition 
```

这也是GSerg选择的解决方案。

* * *

没有人会写

```
If x + y = 0 Then
    Return 0
ElseIf x + y = 1 Then
    Return 1
ElseIf x + y = 2 Then
    Return 2
ElseIf x + y = 3 Then
    Return 3
... 
```

但是当表达式是布尔类型时，有些人会不断地这样做。我认为他们没有意识到条件等同于算术表达式。它们只是布尔算术而不是数字算术。

另一个误解是 If 语句需要一些比较，例如`If x > 0 Then`. 如果他们有一个布尔变量`b`，他们会写`If b = True Then`. 但是所有的 If 语句需要的是一个由布尔表达式给出的布尔值。这个表达式可以像查询一个变量一样简单：`If b Then`.

为什么这行得通？因为 if `b`is `True`then `b = True`yield`True`并且 if `b`is `False`then `b = True`yield `False`。所以，`b = True`很像说`x * 1`。当然，这和刚才一样`x`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-01T17:07:21.613

The second method is more readable, I concur. It also happens to be my preference for returning out of methods. **I really cannot think of a single downside to the latter in comparision, but can for the former**. What happens if the method gets longer and someone forgets to set a Boolean flag? A subtle bug would be born. Additionally, it takes more code to write as well. In the latter approach, the code won't compile if it is missing a return, and it also will be shorter.

The only time you **need** local variables for the return type is when the routine needs to do some other work after the return value is first determined. In the example you post, this is not the case.

[Code Complete, 2nd Edition](https://rads.stackoverflow.com/amzn/click/com/0735619670) agrees on page 391:

> ***Use a* return *when it enhances readability*** In certain routines, once you know the answer, you want to return it to the calling routine immediately. If the routine is defined in such a way that it doesn’t require any further cleanup once it detects an error, not returning immediately means that you have to write more code.

* * *

> **NOTE:** As other answers [[1](https://stackoverflow.com/a/10401399/452274),[2](https://stackoverflow.com/a/10401626/452274)] have mentioned, you can reduce the method to a single code statement. Also using [`AndAlso`](http://msdn.microsoft.com/en-us/library/cb8x3kfz%28v=vs.80%29.aspx) should help speed up the evaluation by short-circuiting the logical expression early if the first part is false:
> 
> ```
> Return FirstCellPosition.NoOfCellsSouth = SecondCellPosition.NoOfCellsSouth 
>     AndAlso FirstCellPosition.NoOfCellsEast = SecondCellPosition.NoOfCellsEast 
> ```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T22:14:26.403

函数名称的返回和赋值有一件重要的事情。如果您（出于任何扭曲的原因）想写类似的东西

```
Public Function TestFunct() as Boolean
  Dim testVar as Boolean = True
  If testVar then
   TestFunct = True
  Else
   TestFunct = False
  EndIf
  'do more stuff here 
  ...
  TestFunct = False
End Function 
```

它总是返回 false。如果您使用返回，则执行将停止并且函数将返回正确的值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-04-12T21:36:05.420

如果由于某种原因它需要出现在赋值的右侧，并且您不想引起递归，则可以使用变量：

```
Dim Function F() As Boolean
    F = True
    If a = b Then 
        F = Not F()
    End If
End Function 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-06-18T00:37:55.037

简而言之-是的，您的最后一个示例非常有效。

然而，家庭作业中使用的大多数示例要么用于展示其他教学示例。作业表中的代码仅显示了以传统方式使用函数的基础知识，您的第二个示例显示了下一个学习步骤，并且是实现所需结果的最紧凑方式。

此外，第一个示例也可用于强化之前学到的经验教训——例如关于分配变量、布尔值的使用等。

提高编码技能的最佳方法之一是反复练习所学内容。

# twitter-bootstrap - twitter bootstrap 按钮在 Firefox 和 chrome 中奇怪地改变了渲染

> ID：10401270
> 
> 赞同：3
> 
> 时间：2012-05-01T16:59:30.987
> 
> 标签：twitter-bootstrap

我有一个问题，我试图用我自己的颜色覆盖 twitter bootstrap (v 2.0.3) 主按钮，它在 IE 中运行良好，但在 FireFox 或 Chrome 中不行。因此，在我的页面上，我首先链接到 bootstrap.css，然后立即链接到我自己的样式表，该样式表有我自己的更改。现在，我的类与引导类的名称相同，但我认为我的类会优先，因为我的样式表链接到引导类之后：

```
<link href="~/Content/bootstrap.css" rel="stylesheet" type="text/css" />
<link href="~/Content/mystyles.css" rel="stylesheet" type="text/css" /> 
```

...所以在 mystyles.css 中，我有以下内容（同样，就像在 bootstrap.css 中一样，但我有不同的颜色）：

```
.btn-primary {
  background-color: #faa732 !important;
  *background-color: #f89406 !important;
  background-repeat: repeat-x !important;
  border-color: #f89406 #f89406 #ad6704 !important;
  border-color: rgba(0, 0, 0, 0.1) rgba(0, 0, 0, 0.1) rgba(0, 0, 0, 0.25) !important;
   background-image: linear-gradient(top, #fbb450, #f89406) !important;
}

.btn-primary:hover,
.btn-primary:active,
.btn-primary.active,
.btn-primary.disabled,
.btn-primary[disabled] {
  background-color: #f89406 !important;
  *background-color: #df8505 !important;
}

.btn-primary:active,
.btn-primary.active {
  background-color: #c67605 \9 !important;
} 
```

我什至在其中添加了 !important ，它仍然呈现奇怪的旧颜色，然后在我悬停时添加我的颜色（但只是中途）。试图发布图片，但它不会让我....基本上，在 IE 中，颜色是正确的和橙色的，但在其他浏览器中，它是蓝色的，带有橙色的轮廓（蓝色是引导程序中的默认原色)，当我将鼠标悬停在它上面时，一半按钮突出显示橙色，但另一半仍然是蓝色，当我完全单击它时，它变成橙色。

谢谢！！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T19:03:20.130

您走在正确的轨道上，您只需要取消`background-image`这些按钮中设置的属性即可获得所需的颜色，因此将以下内容与您的定义一起添加，它应该可以工作：

```
.btn-primary {
    background-image: none;
    filter: none;
} 
```

演示：http: [//jsfiddle.net/ETagZ/](http://jsfiddle.net/ETagZ/)

# arrays - WCF：在异步合同中我返回列表 但我在客户端收到一个数组

> ID：10401271
> 
> 赞同：0
> 
> 时间：2012-05-01T16:59:35.433
> 
> 标签：arrays, wcf, list, asynchronous

在我的 WCF 服务合同中，我声明了一个返回 List 的异步方法，但是当在我的客户端中我收到来自该方法的返回时，我收到一个数组。我的合同如下：

```
[OperationContract(AsyncPattern = true)]
IAsyncResult BeginGetUsers(Paramusers paramUserParameters, AsyncCallback callback, object state);
List<Users> EndGetUsers(IAsyncResult result); 
```

在我的客户中，我有以下代码：

```
Task<List<Users>> task = Task<List<Users>>.Factory.FromAsync(_proxy.Proxy.BeginGetUsers, _proxy.Proxy.EndGetUsers, myParameters,  null);
List<Users> myUsers = await task; 
```

在客户端，我在 FromAsync 方法的第二个参数中收到错误，因为它说 EndGetUsers 方法返回一个数组，而不是一个列表。

我尝试使用一组用户并且工作正常，但我想从异步方法接收列表，而不是数组。可能吗？

谢谢。戴姆洛克。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-01T17:50:28.323

创建客户端代理时，指定您希望将集合表示为列表而不是数组 - 使用“添加服务引用”对话框时，选择“高级”按钮，然后`System.Collections.Generic.List`在集合类型下拉列表中进行选择。

如果使用`svcutil`，则可以使用`/collectionType`（或`/ct`）参数来指定要使用的集合类型：

```
svcutil http://the.service.com/service.svc /ct:System.Collections.Generic.List`1 
```

# tortoisesvn - 在哪里可以找到 TortoiseSvn Subwcrev 错误代码列表？

> ID：10401275
> 
> 赞同：2
> 
> 时间：2012-05-01T16:59:48.520
> 
> 标签：tortoisesvn

今天，我们的一位开发人员从我的 subwcrev 构建后命令中收到“错误 9009”。它在命令行中运行良好。修复它的是重新启动 Visual Studio。其他几个人发现更新 SVN 和/或确保它在路径上是罪魁祸首； [http://forum.battleclinic.com/index.php?topic=42617.0;建筑问题](http://forum.battleclinic.com/index.php?topic=42617.0;Building-problems) http://www.autismcollaborative.org/wiki/index.php?title=Troubleshooting

我很惊讶没有看到 SubWcRev 的错误代码及其含义的列表。有谁知道在哪里可以找到那个？谢谢你！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-02T10:36:57.883

[您可以在源](http://code.google.com/p/tortoisesvn/source/browse/trunk/src/SubWCRev/SubWCRev.cpp#140)代码中找到错误代码。

```
// Internal error codes
#define ERR_SYNTAX      1   // Syntax error
#define ERR_FNF         2   // File/folder not found
#define ERR_OPEN        3   // File open error
#define ERR_ALLOC       4   // Memory allocation error
#define ERR_READ        5   // File read/write/size error
#define ERR_SVN_ERR     6   // SVN error
// Documented error codes
#define ERR_SVN_MODS    7   // Local mods found (-n)
#define ERR_SVN_MIXED   8   // Mixed rev WC found (-m)
#define ERR_OUT_EXISTS  9   // Output file already exists (-d)
#define ERR_NOWC       10   // the path is not a working copy or part of one 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2015-09-25T15:23:22.977

将其从以下位置删除：项目--> 属性 ---> 构建事件 --> 预构建事件命令行

subwcrev "$(SolutionDir)." "$(ProjectDir)Properties\AssemblyInfoTemplate.cs" "$(ProjectDir)Properties\AssemblyInfo.cs" -f

然后构建项目

# z3 - 等效量词免费公式

> ID：10401277
> 
> 赞同：1
> 
> 时间：2012-05-01T17:00:15.733
> 
> 标签：z3

我想知道Z3是否可以在量词消除后显示等效公式。

示例 (exists k) (ixk) = 1 and k > 5 等价于

i > 0 和 5 i - 1 < 0。

在这里，量词 k 已被删除。

这可能吗？

谢谢，考斯图布。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T17:33:15.350

是的，Z3 可以检查两个公式是否等价。检查`p`和`q`是否等价。我们必须检查是否`(not (iff p q))`不满足。

您的示例使用非线性算术`i*k`。Z3 中的量词消除模块对非线性*实*数运算的支持有限。它基于虚拟术语替换，这是不完整的。但是，对于您的示例就足够了。我们必须启用 Z3 中的量词消除模块和非线性扩展（即虚拟术语替换）。

以下是我们如何在 Z3 中对您的示例进行编码：[http ://rise4fun.com/Z3/rXfi](http://rise4fun.com/Z3/rXfi)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T17:30:55.063

一般来说，可以得到消除量词的结果。例如，通过在[rise4fun](http://rise4fun.com/Z3)中输入以下内容：

```
(declare-const i Real)
(assert (exists ((k Real)) (and (= (* i k) 1.0) (> k 5.0))))
(apply qe) 
```

本例涉及非线性算术，Z3 不消除量词。

# c - 在 Windows 7 x64 上使用 C 和 MinGW 访问虚拟串行端口

> ID：10401280
> 
> 赞同：3
> 
> 时间：2012-05-01T17:00:39.313
> 
> 标签：c, winapi, serial-port, mingw

我正在尝试在 Windows 7 x64 机器上使用 MinGW 与虚拟串行端口通信。根据设备管理器，我的设备在`COM27`. 我有这个代码：

```
#include <windows.h>
#include <stdio.h>

    int main()
    {
        HANDLE hComm;

        const WCHAR FileFullPath[] = {L"COM1"} ;

        hComm = CreateFile( (LPCTSTR)FileFullPath,
                            GENERIC_READ | GENERIC_WRITE,
                            0,
                            0,
                            OPEN_EXISTING,
                            FILE_FLAG_OVERLAPPED,
                            0);

        if (hComm == INVALID_HANDLE_VALUE) {
            printf("Invalid value: %d\r\n", GetLastError());
        }
    } 
```

这给了我一个`ERROR_FILE_NOT_FOUND`（[错误代码2](http://msdn.microsoft.com/en-us/library/windows/desktop/ms681382%28v=vs.85%29.aspx)）。输出：

```
Invalid value: 2 
```

如果我将端口名称更改为`COM1`（我拥有的另一个端口），则无法创建错误 1450 的文件，或者`ERROR_NO_SYSTEM_RESOURCES`.

我究竟做错了什么？我接受 MinGW 的替代品，这不是强制性的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T09:40:11.027

COM 端口名称应该是`\\.\COM1`（`\\\\.\\COM1`在转义反斜杠之后），而不是`COM1`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-02T03:54:48.320

尝试创建文件A

我在使用 Qt 和 mingw 时遇到了同样的问题，更改为 CreateFileA 对我有用。我已经在使用“\\\\.\\COM??”

# jquery - JQuery Cycle pagerAnchorBuilder - 列表标签附加了不同的类。

> ID：10401290
> 
> 赞同：0
> 
> 时间：2012-05-01T17:01:24.610
> 
> 标签：jquery, jquery-cycle

我正在尝试使 pagerAnchorBuilder 函数构建这个：

```
<ul id="banner_nav">
<li class="how">link code</li>
<li class="who">link code</li>
<li class="why">link code</li>
</ul> 
```

我不确定告诉它用 3 个不同的类构建 li 标签。有任何想法吗？这可以做到吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-06T01:05:29.920

你可以像这样构建它。你可能希望将类名放在一个数组或其他东西中：

[http://jsfiddle.net/RcMJW/1/](http://jsfiddle.net/RcMJW/1/)

```
pagerAnchorBuilder: function(idx, slide) {
  var cssClass="";

  switch (idx) {
    case 0: 
      cssClass="how";
      break;
    case 1: 
      cssClass="who";
    break;
    case 2: 
      cssClass="why";
      break;
    default: 
      cssClass="when";
  }

  return '<li class="' + cssClass + '"><a href="#">' + idx + '</a></li>';
} 
```

# python - 爬取流行论坛/公告板软件的工具

> ID：10401291
> 
> 赞同：0
> 
> 时间：2012-05-01T17:01:28.717
> 
> 标签：python, dataset, vbulletin, web-crawler

我已经开始编写一个爬虫来爬取 vbulletin 板。但是，我不是网络程序员（我可以做 json api，但这并不是真正的网络爬行），因此我不知道什么是最好的爬行方式，以及可用的工具。

我完全有能力编写爬虫，但是我发现底层的 HTML 非常不规则，所以我不想成为新版本 vbulletin 中 HTML 结构变化的受害者。

我正在使用 pycurl 和美丽的汤编写一个界面。但是，有没有更好的方法来做到这一点，是否有任何好的爬虫已经可用于 vbulletin ？（语言不是问题）。元论坛爬虫（适用于多种论坛类型）会更好。

如果你不能推荐一个，你能告诉我吗，如果你有经验，从我对底层 HTML 稳定性的期望来看，我是否应该担心新版本的 vbulletin 会破坏我的爬虫？

也许有更好的方法来提取 vbulletin 数据集？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T17:26:02.220

更改 HTML 是网络爬虫的继承问题。这就是为什么它应该只是绝对的最后手段。如您所见，维护爬虫可能是一项艰巨的任务，因为 HTML 可以每天更改，并且没有保证。

因为通常搜索的数据是统一的，scrapy 是一个很好的选择。 [http://doc.scrapy.org/en/0.14/index.html](http://doc.scrapy.org/en/0.14/index.html)

它使用 xpath 来选择元素，这在 imo 中相对容易维护。

即使有一个 vbulletin 特定的刮板，它仍然依赖于可以随意破坏的 HTML。因为 vbulletin 是一个平台，所以你可能会很好地抓取它。我认为 HTML 只会在不应该那么频繁的版本更新上发生变化。

移动 API 是否为您提供所需的任何功能？ [https://www.vbulletin.com/forum/content.php/367-API-Overview](https://www.vbulletin.com/forum/content.php/367-API-Overview)，我想这取决于每个站点的 vbulletin 设置。

# ios - 如何将核心数据类路由到 RestKit 中的多个资源路径？

> ID：10401292
> 
> 赞同：1
> 
> 时间：2012-05-01T17:01:30.677
> 
> 标签：ios, web-services, core-data, restkit

我有一个 Web 服务，需要两部分查询才能完全获取我需要的信息。我可以通过对 /vehicles.json 的 GET 请求来查询所有车辆的列表，它会为我提供所有车辆的列表，如下所示：

```
{ 
    vehicles: [
       {
           vehicle_name: "Sam's Toyota Corola",
           uri: ".../vehicle/1001.json"
       },
       {
           vehicle_name: "John's Honda Accord",
           uri: ".../vehicle/1002.json"
       }
    ]
} 
```

uris 是唯一的 id。然后，如果我想要更多信息，我可以通过对车辆 uri 的 GET 请求（即 /vehicle/1001.json）查询车辆的详细信息，它为我提供了这样的车辆的详细信息：

```
{ 
    vehicle: {
       engine: "V6",
       sunroof: "no"
    }
} 
```

我想用一种核心数据类型表示车辆，该类型包含：名称、uri、引擎和天窗，但在 RestKit 中有两条路线映射到相同的核心数据类型，如下所示：

```
// Map the list of all vehicles route
[objectManager.router routeClass:[CDVehicle class] toResourcePath:@"/vehicles.json" forMethod:RKRequestMethodGET];

// Map the show of a specific vehicle route
[objectManager.router routeClass:[CDVehicle class] toResourcePath:@"/vehicle/(vehicleID).json" forMethod:RKRequestMethodGET]; 
```

RestKit 不喜欢这样，并给我一个错误，即 GET 方法有两条路由映射到同一事物。为什么？！？这当然是可以做到的，看看你如何用 RestKit 做几乎任何事情。

有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T01:42:22.417

这个问题有点老了，但我用谷歌搜索了你的问题和一个类似的问题，另一个有一个很好的答案，以防你仍然感兴趣，请参考这篇文章：[我如何为同一个班级提供两条帖子路线在 RestKit](https://stackoverflow.com/questions/7450926/how-do-i-have-two-post-routes-for-the-same-class-in-restkit)

他们在谈论 postObject，但 RestKit 中的 get 方法也可以做同样的事情。

# python - 基于 git 分支配置 Python 应用

> ID：10401293
> 
> 赞同：1
> 
> 时间：2012-05-01T17:01:31.453
> 
> 标签：python, git, configuration

我一直在考虑如何在我的 Python 应用程序中自动设置配置。

我通常使用以下类型的方法：

```
'''config.py'''
class Config(object):
    MAGIC_NUMBER = 44
    DEBUG = True

class Development(Config):
    LOG_LEVEL = 'DEBUG'

class Production(Config):
    DEBUG = False
    REPORT_EMAIL_TO = ["ceo@example.com", "chief_ass_kicker@example.com"] 
```

通常，当我以不同的方式运行应用程序时，我可以执行以下操作：

```
from config import Development, Production

do_something():
    if self.conf.DEBUG:
       pass

def __init__(self, config='Development'):
    if config == "production":
        self.conf = Production
    else:
        self.conf = Development 
```

我喜欢这样工作，因为这很有意义，但是我想知道我是否也可以以某种方式将其集成到我的 git 工作流程中。

我的许多应用程序都有单独的脚本或可以单独运行的模块，因此并不总是有一个单一的应用程序可以从某个根位置继承配置。

如果许多这些脚本和单独的模块可以检查当前签出的分支并基于此做出*默认*配置决策，例如，通过查找`config.py`与当前名称共享相同名称的类，那将是很酷的签出分支。

这可能吗，实现它的最干净的方法是什么？

这是一个好/坏主意吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T00:51:52.877

我更喜欢[spinlok](https://stackoverflow.com/questions/10401293/configuring-python-application-based-upon-git-branch#comment13417689_10401293)的方法，但是是的，你可以在你的 中做几乎任何你想做的事情`__init__`，例如：

```
import inspect, subprocess, sys

def __init__(self, config='via_git'):
    if config == 'via_git':
        gitsays = subprocess.check_output(['git', 'symbolic-ref', 'HEAD'])
        cbranch = gitsays.rstrip('\n').replace('refs/heads/', '', 1)
        # now you know which branch you're on...
        tbranch = cbranch.title() # foo -> Foo, for class name conventions
        classes = dict(inspect.getmembers(sys.modules[__name__], inspect.isclass)
        if tbranch in classes:
            print 'automatically using', tbranch
            self.conf = classes[tbranch]
        else:
            print 'on branch', cbranch, 'so falling back to Production'
            self.conf = Production
    elif config == 'production':
        self.conf = Production
    else:
        self.conf = Development 
```

这是，嗯，“稍微测试过”（python 2.7）。请注意，`check_output`如果 git 无法获得符号引用，则会引发异常，这也取决于您的工作目录。您当然可以使用其他`subprocess`功能（例如提供不同`cwd`的功能）。

# php - 使用 Tesseract 进行 OCR 读取电话号码

> ID：10401295
> 
> 赞同：1
> 
> 时间：2012-05-01T17:01:33.530
> 
> 标签：php, ocr, tesseract

我正在尝试完成一个必须包含一些 OCR 的项目。对于这项工作，我选择了 Tesseract OCR，但结果并不是最优的。我试图将字符集限制为`1234567890-`但结果并不好。是否有我可以使用的最佳图像尺寸或某种方法来训练 Tesseract 更好地识别这种字符串？

图像是这样的：![电话](../Images/f34f41c946dd0232838a462f6916b99c.png)

并且 tesseract 返回的结果是 05175150152 这是不对的，应该更好，因为图像没有以任何方式修改。我通过 PHP 使用 tesseract 和 exec 并使用以下命令：

```
"C:\Program Files\Tesseract-OCR\tesseract.exe" C:\wamp\www\a
dwords\phones\center_ctl09_ctl04.png sssd -l eng -psm 7 nobatch letters 
```

关于我做错了什么的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-12T20:47:46.767

96 DPI 的图像分辨率对于任何 OCR 引擎来说都很难。尝试将其重新缩放到 300 DPI，您将获得更好的结果。

此外，JPEG 是一种有损图像格式。如果可能，请使用不同的格式，例如 TIFF 或 PNG。

# javascript - 为什么这个 javascript 'If...Else...' 语句中没有比较语句

> ID：10401297
> 
> 赞同：6
> 
> 时间：2012-05-01T17:01:36.727
> 
> 标签：javascript, conditional-statements, if-statement

在下面的代码中

```
var $next =  $active.next().length ? $active.next()
        : $('#slideshow IMG:first'); 
```

'$active.next().length' 部分似乎没有比较任何东西，我不明白条件是如何确定为真或假的。

还是说：如果各种 $next 等于 $active.next().length 那么条件为真？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-01T17:04:04.740

在 javascript 中，任何表达式都可以转换为真值或假值，因此在比较位置有效。javascript中为假的值是

*   `false`
*   `0`
*   `""`（空字符串）
*   `null`
*   `undefined`
*   `NaN`

在这种情况下`length`，指的是一个数值，如果它的计算结果为，`0`那么它将被认为是虚假的。否则会是真的

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-01T17:03:54.507

如果`length`属性等于`0`或`undefined`（即`$active`不是数组），则条件为`false`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-01T17:04:27.020

如果`$active.next().length`是`true`，表示有下一个元素，那么`$next = $active.next()`。否则`$next = $('#slideshow IMG:first')`。该`?`运算符称为三元运算符。它是一个简短的`if else`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-01T17:05:17.067

这是一个三元比较，相当于：

```
if($active.next().length) {
    $next = $active.next();
}
else {
    $next = $('#slideshow IMG:first');
} 
```

所以条件基于 $active.next().length 应该返回一个零或更大的值。任何大于零的东西，JavaScript 都会解释为真，零为假。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-01T17:07:06.560

您正在查看的[三元运算](http://en.wikipedia.org/wiki/Ternary_operation)是 If...Else... 的缩写，您在标题中提到过吗？

所以你的陈述的长版本是;

```
if($active.next().length){
 $next = $active.next();
}else {
 $next = $('#slideshow IMG:first');
} 
```

# mysql - Mysql查询混合日期时间和位置

> ID：10401301
> 
> 赞同：0
> 
> 时间：2012-05-01T17:01:55.593
> 
> 标签：mysql, datetime

我有一个这样的查询：

```
SELECT message_text 
FROM messages 
WHERE message_date >= '$connection_time' 
```

很简单。这使我可以检索自连接时间以来发布的消息。

但我还需要检索在该连接时间之前发布的最后 15 条消息。（最好是用一个查询来完成这一切）。

我该怎么做？

PS：我考虑获取检索到的第一条消息的 id 并减去 15，但它仅在 id 是连续的情况下才有效，但情况并非总是如此。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T17:07:00.950

将以下查询加入到您现有的查询中[`UNION`](http://dev.mysql.com/doc/refman/5.5/en/union.html)：

```
SELECT   message_text
FROM     messages
WHERE    message_date < '$connection_time'
ORDER BY message_date DESC
LIMIT    15 
```

顺便说一句，我真的真的很希望你**绝对确定** `$connection_time`已经被剥夺了任何潜在的 SQL 注入攻击（如果你不知道这意味着什么，去阅读[Bobby Tables](http://bobby-tables.com)）。您应该使用准备好的语句，将变量作为参数传递给其中，这些参数不会被 SQL 评估。

# android - 开发类似 GPS 的应用程序的最佳方法

> ID：10401303
> 
> 赞同：0
> 
> 时间：2012-05-01T17:02:09.233
> 
> 标签：android, views, imageview

我是 android 新手，我开始为 android 开发类似 GPS 的应用程序，该应用程序的基本概念是显示蓝图，并在其顶部显示与蓝图上的位置相关的信息的引脚和其他设置。

这方面的一个例子是绘制一个可以缩放和平移的公寓蓝图，并在其顶部放置带有公寓每个部分信息的标记，并且明显定位在正确的位置，如浴室、卧室、厨房等。

我的问题是开发这种功能的最佳方法是什么？

我的第一个想法是使用 RelativeLayout 作为容器，使用具有缩放和平移功能的蓝图 ImageView 和用于固定的单个视图，并根据图像的缩放和平移定位信息的相应位置。

然后我继续挖掘并看到了 2d Graphics 选项，但我真的不知道如何实现这一点。

如果有人可以向我发送正确的方向，我将不胜感激，如果可能的话，也可以提供一些示例。

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T17:51:14.377

使用 a`MapView`和 an`ItemizedOverlay`来显示标记。这是如何完成此[操作的分步答案（请参阅答案的](https://stackoverflow.com/questions/10216151/updating-google-maps-marker-from-a-broadcast-sms-receiver/10216546#10216546)*B 项*）。

# silverlight - 如何从预定代理播放通知声音？

> ID：10401304
> 
> 赞同：2
> 
> 时间：2012-05-01T17:02:17.267
> 
> 标签：silverlight, windows-phone-7, silverlight-4.0

我的应用程序有一个预定的代理程序，它检查新邮件并在收到新邮件时更新磁贴，我还想从后台代理程序播放通知声音，以通知用户有关新邮件的通知，就像谷歌邮件应用程序一样，但是我除了似乎无法从计划任务中使用的 SoundEffect 之外，没有找到任何东西。有没有办法播放这种通知声音？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T21:35:50.003

无法从后台代理播放声音。（请参阅[后台代理不支持的 API](http://msdn.microsoft.com/en-us/library/hh202962%28v=vs.92%29.aspx)列表）

如果您想通知用户更改，您可以提出 a`ShellToast`代替。（根据用户设置，这可能会播放声音。）

# .net - 如何从 System.Windows.Forms.Screen 对象创建 System.Drawing.Graphics 对象？

> ID：10401305
> 
> 赞同：1
> 
> 时间：2012-05-01T17:02:21.047
> 
> 标签：.net, vb.net, winapi, graphics, gdi+

我正在寻找一个图形覆盖来显示一些数据，这些数据将位于任何窗口的顶部，甚至是全屏应用程序。

我可以使用 API 挂钩来获取活动窗口，这将允许我创建一个图形对象并在活动窗口的顶部进行绘制，这*几乎*是我正在寻找的。唯一的问题是，当我尝试使用拉绳调用时，它会使用该窗口的边界来绘制数据。

所以调用：

```
gphx.DrawString("test", New Font("Tahoma", 12), New SolidBrush(Color.Red), New PointF(0, 0)) 
```

将在表单可用区域的左上角显示“测试”，甚至在标题栏中也不显示。您甚至不能在该调用中使用负数，因为它使用表单可用区域作为画布，因此您最终只能绘制到不可见的区域。

我的目标是让数据始终显示在屏幕的同一位置，无论窗口位于何处。

**API Hook 用于获取活动窗口。**

```
<Runtime.InteropServices.DllImport("user32.dll")>
    Public Function GetForegroundWindow() As IntPtr
    End Function 
```

是否有获取屏幕句柄（我严重怀疑）或直接绘制到屏幕的方法的功能？

我宁愿不必使用 DirectX 库来完成此操作，但如果无法使用 GDI+ 或通过其他一些 API 调用，我将不得不走这条路。

# asp.net-mvc - 在同一项目解决方案中从 ASP.NET MVC 应用程序调用 ASP.NET 网页表单页面

> ID：10401313
> 
> 赞同：1
> 
> 时间：2012-05-01T17:03:08.540
> 
> 标签：asp.net-mvc

我在同一个 Visual Studio 解决方案中有 2 个项目。
一个是 ASP.NET MVC 项目，另一个是 ASP.NET Web 应用程序（Webforms）。

我想从 MVC 调用 ASP.NET Web 应用程序，而不必在 MVC 中重新编写整个 Web 应用程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T17:07:45.287

You could use an anchor:

```
<a href="http://address_of_the_application_that_you_dont_want_to_rewrite">
    Go to the WebForms application
</a> 
```

or an iframe:

```
<iframe src="http://address_of_the_application_that_you_dont_want_to_rewrite" /> 
```

# collision-detection - OpenGL。球对球碰撞

> ID：10401314
> 
> 赞同：1
> 
> 时间：2012-05-01T17:03:10.997
> 
> 标签：collision-detection

在 OpenGL 中制作概率机。

```
Ball ballArray[5];

while(elapsed > 0)
{
     timeStep = m_Timer.getSeconds();
     for(int i = 0; i < NUMBER_OF_BALLS; ++i)
     {
        ballArray[i].updateBall(timeStep); // where collision with pegs dealt 
        //ballArray[0].ballBallCollision(timeStep,ballArray[0],ballArray[1]);
      }
      Redraw();
} 
```

我无法让注释行工作:(我如何传递 2 个球实例

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T17:25:28.990

假设`ballBallCollision()`工作正常，您可能希望每个球与其他球发生碰撞，即 0 与 1、0 与 2、1 与 2 等。为此，您将需要第二个循环。

我首选的解决方案是创建一个遍历所有剩余球的循环，如下所示：

```
for(int i = 0; i < NUMBER_OF_BALLS; ++i)
{
   ballArray[i].updateBall(timeStep); // where collision with pegs dealt 
   for(int j = i + 1; i < NUMBER_OF_BALLS; ++j)
   {
      ballArray[i].ballBallCollision(timeStep,ballArray[i],ballArray[j]);
   }
} 
```

请注意，由于我们从 开始`i + 1`，我们永远不会让球相互碰撞（0 与 0），并且我们不会对每一对检查两次（我们检查 0 与 1，但不再检查 1 与 0）。

# ruby-on-rails - Rails 3.1 中的路由错误

> ID：10401315
> 
> 赞同：0
> 
> 时间：2012-05-01T17:03:18.143
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我当然为此而失去理智/睡眠。这是我的 questions_controller.rb

```
class QuestionsController < ApplicationController
  # GET /questions
  # GET /questions.json
  def index
    @questions = Question.all

    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @questions }
    end
  end 
```

这是我的 applications_controller.rb

```
class ApplicationController < ActionController::Base
  protect_from_forgery
end 
```

这是我的 rake 路线：

```
 questions GET    /questions(.:format)          questions#index
              POST   /questions(.:format)          questions#create
 new_question GET    /questions/new(.:format)      questions#new
edit_question GET    /questions/:id/edit(.:format) questions#edit
     question GET    /questions/:id(.:format)      questions#show
              PUT    /questions/:id(.:format)      questions#update
              DELETE /questions/:id(.:format)      questions#destroy
   home_index GET    /home/index(.:format)         home#index 
```

这是我的路线.rb

```
App::Application.routes.draw do
  resources :questions
end 
```

前往时出错`http://0.0.0.0:3000/questions`

```
uninitialized constant QuestionsController 
```

可能是什么错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T17:09:01.870

当一个文件中存在语法错误时，有时会发生这种错误。重新启动您的开发服务器并在其输出中查找错误。

特别是检查线

```
format.html # index.html.erb 
```

我不认为它可以这样写。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T00:54:35.493

你能确保控制器文件名的复数形式正确吗？

```
app/controllers/questions_controller.rb 
```

谢谢。

# java - 简单的递归解释

> ID：10401316
> 
> 赞同：3
> 
> 时间：2012-05-01T17:03:24.103
> 
> 标签：java, recursion

这是Java中的递归静态方法。

```
public static int mystery(int m, int n) {
    int result = 1;   

    if (m > 0) {
      result = n * mystery(m-1, n);
    }       

    System.out.println (m + "  " + result);
    return result;
} 
```

如果我们调用神秘（3,4）方法，标准输出会打印什么？调用神秘（3,4）的最终返回值是多少？

标准输出部分的答案的解释是什么。

输出：

```
0 1
1 4
2 16
3 64 
```

最终返回值为 64。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T17:06:21.130

Consider `n` to be fixed (which for all intents and purposes it is) and let `f(m)` be `mystery(m,n)`.

Then

```
f(0) = 1
f(1) = n * f(0) = n
f(2) = n * f(1) = n * n
f(3) = n * f(2) = n * n * n 
```

Can you see the general pattern? Can you give a closed form for `f(n)`?

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T17:29:05.820

鉴于您的代码是

```
public static int mystery(int m, int n) {
int result = 1;   

if (m > 0) {
  result = n * mystery(m-1, n);
}       

System.out.println (m + "  " + result);
return result;
} 
```

让我们从 m = 3 和 n = 4 开始，让我们尝试通过尝试成为调试器来模拟它...

```
mystery(3,4){
   int result = 1
   if(3 > 0){
       result = 4 * mystery(3-1,4);
       //We proceed from this point only after evaluating mystery(2,4)
       mystery(2,4){
            int result = 1
            if(2 > 0){
                result = 4*mystery(2-1,4);
                //Now we have to evaluate mystery(1,4)
                mystery(1,4){
                    int result = 1;
                      if(1 > 0){
                          result = 4*mystery(1-1,4);
                          //Evaluate mystery(0,4)
                          mystery(0,4){
                             int result = 1;
                             if(0 > 0){
                                //Not evaluated
                             }
                             System.out.println(0 + " "+1);
                             return 1;
                          }...mystery(0,4) done continue with evaluation of mystery(1,4)
                          result = 4*1 //1 is what is returned by mystery(0,4)
                          System.out.println(1+ "" + 4);
                          return 4; 
                       }//done with the evaluation of mystery(1,4), resume evaluation of mystery(2,4)
                result = 4*4 //4 is the value returned by mystery(1,4)
                System.out.println(2 + " " + 16);
                return 16;            
                }//At this point we are done with evaluating (2,4) and on the way to resume evaluation of mystery(3,4)
       result = 4 * 16
       System.out.println(3 + " "+ 64)
       return 64;
       }
   } 
```

希望这可以帮助

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T17:16:39.360

此示例计算 m 的 n 次方。因此，在您的情况下，该值为 64。

但是，您是否尝试过并进行了分析？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-14T21:20:57.743

第一个调用是神秘（3,4），然后调用神秘（2,4），然后调用神秘（1,4），然后调用神秘（0,4）。在此示例中，基本情况是神秘（0,4），即 m > 0 的计算结果为 false 并且 result = n*mystery(m-1,n) 将不会被执行（递归在此终止）。您的基本情况位于调用堆栈的顶部，而堆栈的底部是神秘的（3,4）。从调用堆栈的顶部向底部进行评估......</p>

![在此处输入图像描述](../Images/6f53cb1568501aac9c010426d339cbf3.png)

# php - CodeIgniter - 搜索结果 - 如何创建好的查询和 URI？

> ID：10401320
> 
> 赞同：1
> 
> 时间：2012-05-01T17:03:41.333
> 
> 标签：php, codeigniter, search

我正在编写一些脚本，我想创建搜索。我的项目基于 CodeIgniter，我希望所有代码内容都与它兼容。

所以，我已经在研究用于搜索的查询，但这并不好，因为它不支持多于一个的单词。因此，如果我在搜索表单中输入单词“test”（假设测试单词在数据库中的某个字段中），结果将很少，但是如果我输入单词“test test test”（再次假设测试单词是在其中一个字段的数据库中）将没有任何结果。

我目前的查询：

`$this->db->select('title, content, date, hyperlink')->or_like(array('title' => $query, 'content' => $query))->order_by('id_article', 'desc')->get('news');`

下一个问题是 URI，因为如果我搜索“某篇文章，今天是晴天”，则逗号有问题，在其他情况下也可能有其他不允许的字符。我在那里读过其他几个问题，但我发现的只是`$this->uri->uri_to_assoc()`，我认为这在我的情况下是行不通的，因为我在我的项目中不使用英语。

这两个问题的最佳解决方案是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T18:09:22.403

要解决搜索问题，您可能应该将查询分解成碎片。

```
$query = 'test test 2 test3';
$parts = explode(' ', $query); 
```

然后循环遍历各个部分并添加 or_like 条件。

```
foreach ($parts as $q)
{
    $this->db->or_like(array('title' => $q, 'content' => $q));
} 
```

现在它检查任何单词。

您可能还希望允许将引用的值视为一个单词，以便“test 2”将搜索序列 test 2 而不仅仅是 test 和 2。您需要调整获取部分的方式，可能通过正则表达式如：

```
preg_match_all('/"(?:\\\\.|[^\\\\"])*"|\S+/', $query, $parts); 
```

对于 URI 中的无效字符，一端通过 urlencode 传递字符串，另一端通过 urldecode 传递字符串。

```
$uri = urlencode('some article, today is sunny'); 
```

# c++ - “上下文模式”的这种实现看起来不错吗？

> ID：10401321
> 
> 赞同：2
> 
> 时间：2012-05-01T17:03:52.183
> 
> 标签：c++, design-patterns

我有多个可能存在于数组中的处理单元，每个处理单元都有自己的参数。在建议作为[另一个问题的解决方案](https://stackoverflow.com/questions/10398852/is-there-a-recommended-design-pattern-for-communicating-parameters-with-a-proces)之后，我想使用*上下文模式*来传达每个处理单元的参数。但是，我无法在线找到该模式的简单 C++ 示例。我在下面做了一个简化的实现供您检查。代码可以正常工作和编译，但是**我是否正确实现了该模式？**任何和所有关于风格改进的建议都将受到欢迎。

 **```
#include <iostream>
#include <sstream>

#include <map>

class cParamsContext
{      
     typedef std::map<std::string, float> myMap_t; //Make the return type of getter less wordy
     myMap_t paramMap;

public:              
    cParamsContext()
    {
        paramMap["a0"] = 1.f;
        paramMap["a1"] = 2.f;
    }

    myMap_t const& getMap() const {return paramMap;} //Return read-only alias   
};

class cProcessUnit
{
    float parameter;
    int id;

public:
    cProcessUnit(cParamsContext &contextObj, int id_) : parameter (0.f), id(id_)
    {
        std::stringstream idStream;
        idStream << id;

        std::string key = std::string( "a" + idStream.str() );

        if(contextObj.getMap().find( key ) != contextObj.getMap().end())        
            parameter = contextObj.getMap().find( key )->second; // https://stackoverflow.com/questions/10402354/using-overloaded-operator-via-an-accessor-function#10402452                 
    }

    float getParam() {return parameter;}
};

int main(int argc, char *argv[])
{
    cParamsContext contextObj;

    for (int nn=0; nn<3; nn++)
    {
        cProcessUnit temp(contextObj, nn);
        std::cout << "Processing unit "  << nn << " param = " << temp.getParam() << std::endl;
    }
} 
```

此外，如果参数映射发生变化，您能否建议我如何使每个类中的参数自行更新？

如果您感兴趣，输出看起来像这样。. . .

```
Processing unit 0 param = 1
Processing unit 1 param = 2
Processing unit 2 param = 0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T17:23:29.717

这看起来确实是一个有效的实现。它通过了你的测试吗？我没有以这种特殊方式使用上下文模式的经验，但对我来说确实很好。

至于更新值，我目前在分配给我的项目中做一些非常相似的事情，我正在使用[观察者模式](http://en.wikipedia.org/wiki/Observer_pattern)。在这种情况下，这`cParamsContext`将是*可观察*的。我正在使用观察者模式的[信号/插槽/事件/委托](https://stackoverflow.com/questions/359928/)实现。到目前为止，它为我的任务创造了奇迹。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T17:47:56.673

看起来它可以正常工作，但这里有一些建议：

1.  考虑使用性能更高的哈希映射/表。Boost hast 一个，你可以看看。std::map 在性能方面表现不错，但根据数据集，哈希表的性能可能更高。

2.  考虑将值模板化，或者至少通过为每种类型和相应的 getter/setter 创建一个映射来允许不同的类型。像现在这样，使用的参数只能是float，但是如果将来需要不同的参数怎么办？**

# wpf - 为什么将 UpdateSourceTrigger 设置为 Explicit 仍会更新源？

> ID：10401326
> 
> 赞同：1
> 
> 时间：2012-05-01T17:04:15.257
> 
> 标签：wpf, wpfdatagrid, updatesourcetrigger

我有一个带有 DataGridTextColumn 的 WPF DataGrid

```
<DataGridTextColumn Header="Grouping" Binding="{Binding Value.GroupIndexPlusOne, UpdateSourceTrigger=Explicit, Converter={StaticResource StringToIntConverter}}" CanUserSort="False" Width="Auto" Utilities:IsReadOnlyDpAttachable.IsReadXOnly="{Binding Data.GroupingIsReadonly, Source={StaticResource proxy}}" /> 
```

尽管已将 UpdateSourceTrigger 设置为 Explicit 以便从代码中进行实际更新，但当我更改列中的值时，源仍然会更新。

源是一个`ListCollectionView`包装 a `ObservableCollection<KeyValuePair<string, LayoutColumn>>`。

没有意义，我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T17:18:17.800

我不确定您是否真的可以为 DataGridTextColumn 设置所需的绑定。（对不起，我找不到“证据”）。尝试使用您自己构建的 TemplateColumn。

# validation - 如何获得 Axis/Castor Web 服务来验证针对 XSD 的请求？

> ID：10401328
> 
> 赞同：2
> 
> 时间：2012-05-01T17:04:21.660
> 
> 标签：validation, xsd, axis, castor

我使用我们组织内另一个团队开发的 XSD 以合同优先（自上而下）的方式开发了一个小型 Web 服务。我遇到的问题是，如果请求格式稍有错误，服务仍会运行。我真的需要它来验证针对 XSD 的请求，但我不知道如何强制 Axis 或 Castor 这样做。

当我说“格式稍有错误”时，我的意思是请求包含正确的元素，但排序不正确。在 Castor 解组期间，将拒绝真正格式错误的请求。格式稍有错误的请求将解组，并可能产生不希望的结果。这是一个例子：

一个有效的请求应该包含如下所示的项目列表：

```
<ItemList>
  <Item>Value1</item>   
  <Item>Value2</item>   
  <Item>Value3</item>   
</ItemList> 
```

这将正确解组，Web 服务将处理所有三个值。

但是，我发现如果像这样呈现相同的一组值：

```
<ItemList>
  <Item>Value1</item>   
  <Item>Value2</item>   
</ItemList>
<ItemList>
  <Item>Value3</item>   
</ItemList> 
```

然后这也将以与第一个示例相同的方式解组，并且将处理所有三个值。在这种情况下，最终结果是可以接受的，但是根据 XSD，这种结构是不正确的，我更希望它产生故障。

这是取自 XSD 的请求定义：

```
<xsd:complexType name="SampleRequestType">
  <xsd:sequence>
    <xsd:element name="ItemList" minOccurs="1" maxOccurs="1">
      <xsd:complexType>
        <xsd:sequence>
          <xsd:element name="Item" type="xsd:string" minOccurs="1" maxOccurs="unbounded"/>
        </xsd:sequence>
      </xsd:complexType>
    </xsd:element>
  </xsd:sequence>   
</xsd:complexType> 
```

SoapUI 将第二个示例报告为无效，因此我确信 XSD 是正确的。

我已经尝试了一些方法来强制进行 XSD 验证，但到目前为止没有任何效果。有谁知道如何强制 Axis 或 Castor 进行验证？

由于历史原因，我正在使用这两个组件的旧版本 - Axis 1.3 和 Castor 1.1，但如果我能让 XSD 验证正常工作，我愿意承受任何升级的痛苦。

非常感谢

史蒂夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T17:17:16.670

试试这个链接：

[http://www.mail-archive.com/axis-user@ws.apache.org/msg21382.html](http://www.mail-archive.com/axis-user@ws.apache.org/msg21382.html)

它与 Axis 1.3 相关，涉及使用自定义过滤器和帮助程序类来进行验证。

至于 Castor，在他们的网站上有一些关于模式验证的示例，不确定它们与您的版本的相关性如何（看起来很旧），但可能是升级的原因：

[http://www.castor.org/how-to-enable-xml-validation.html](http://www.castor.org/how-to-enable-xml-validation.html)

整个事情太大了，无法在这里发布，但我发布的链接看起来很稳定。

# oracle - 我可以使用 IN 和 COUNT 限制结果吗？

> ID：10401331
> 
> 赞同：1
> 
> 时间：2012-05-01T17:04:24.670
> 
> 标签：oracle

我需要限制查询的结果，但我无法实现我见过的使用 count 和 rownum 的任何示例。鉴于此表

```
rec error
___ _____
  1   123
  2   123
  3   456
  4   456
  5   456
  6   456
  7   456
  8   456
  9   456
 10   789
 11   789
 12   789
 13   789 
```

该表有更多行，其中包含许多不同的错误代码。我正在使用它来获取我需要的记录：

```
select rec, error from table where error in (123,456,789) 
```

但是假设我只想每个错误返回不超过 2 条记录。我不知道该怎么做。如果我只是在寻找一个错误，我可以简单地使用 count 或 rownum。使用 IN 条件时不知道该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T17:07:16.940

您是否关心针对任何特定错误代码获得哪两行？这样的事情将为您提供具有最小值的每个错误代码的两行`rec`。如果您更改分析函数`ORDER BY`中的`ROW_NUMBER`，您可以更改返回哪两行。

```
SELECT rec,
       error
  FROM (SELECT rec,
               error,
               row_number() over (partition by error
                                      order by rec asc) rnk
          FROM your_table_name)
 WHERE error in (123,456,789)
   AND rnk <= 2 
```

# algorithm - 如何在谷歌地图中找到“公共路线”？

> ID：10401339
> 
> 赞同：2
> 
> 时间：2012-05-01T17:05:07.393
> 
> 标签：algorithm, map

给定 2 个用户

*   一种
*   乙

和 2 次旅程

*   A 从 X 到 Y
*   B 从 J 到 Z

可以在谷歌地图中找到共同路线吗？我可以使用什么样的算法来发现类似的旅程？

编辑：我试图更准确：对于共同路线，我的意思是他们可以一起旅行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T17:11:21.907

据我所知，您需要的是类似于 Dijikstras 算法的东西。使用它来构建图表，然后比较它们以找到共同路径

# objective-c - 可可偏好被覆盖

> ID：10401340
> 
> 赞同：0
> 
> 时间：2012-05-01T17:05:07.737
> 
> 标签：objective-c, xcode, cocoa

我有几个关于使用 NSUserDefaults 的应用程序偏好的问题。

在我的最后一个应用程序中，我会使用绑定到 NSUserDefaults 将我的首选项链接起来，这非常有效。然后，在应用程序启动方法中，我可以根据存储在 NSUserDefaults 中的值执行操作。

当我更新我的应用程序并重新分发它时出现了问题，其中所有设置都将被我计算机中的首选项覆盖。因此，如果有人更改了设置，然后收到了更新，他们的设置就会被我的覆盖。

回顾有关保存首选项的 Apple 文档，我注意到以下我没有使用的行，它用于将首选项写入磁盘：

```
[defaults synchronize]; 
```

我的问题是，这段代码是否将首选项写入用户的硬盘，这样如果我使用不同的设置重新分发应用程序，NSUserDefaults 会改为从磁盘读取？

很抱歉造成误解，但我找不到答案。

提前谢谢大家。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T17:19:42.180

如果你想使用绑定来控制你的偏好，你应该使用`NSUserDefaultsController`. 在任何一种情况下，要为您的默认值设置初始值，您应该使用初始值创建一个字典，然后将其传递给`registerDefaults:`如果您使用的是 vanilla NSUserDefaults，`initWithDefaults:initialValues:`或者`setInitialValues:`如果您使用的是 NSUserDefaultsController 之一。这是一个 NSUserDefaultsExample：

```
- (void)applicationDidFinishLaunching {
    // For decent-sized applications, I normally like to store this in its own plist
    // but I'm creating it in-line here for readability's sake.
    NSDictionary *initialPreferences = [NSDictionary dictionaryWithObjectsAndKeys:
        [NSNumber numberWithInteger:21], @"UserAge",
        @"red", @"FavoriteColor",
        @"Idaho", "Location", nil];
    [[NSUserDefaults standardUserDefaults] registerDefaults:initialPreferences];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T17:09:13.110

`NSUserDefaults`仅在**`synchronize`**被调用时写入。

当您发布应用程序并希望在首次启动时进行特定设置时，您需要自己在代码中进行设置。我通常会查找`nil`特定键的值，如果它是空值，我将设置所需的“默认”值。

## 例子

我在应用程序启动时这样做：

```
NSUserDefaults * defaults = [NSUserDefaults standardUserDefaults];

/*  count how many times the user has launched the app  */
int total = [[defaults objectForKey:@"kLaunchCount"] intValue];  total++;
[defaults setObject:[NSNumber numberWithInt:total] forKey:@"kLaunchCount"];

/*  User chose to reset Scanner Feed, remove the .plist from Documents directory.  */
if ( [[defaults objectForKey:@"kResetScannerFeeds"] boolValue] == YES ){
    [[NSFileManager defaultManager] removeItemAtPath:SCANNERFEED error:nil];
    [defaults setObject:[NSNumber numberWithBool:NO] forKey:@"kResetScannerFeeds"];
}

/*  Check to see if Default Prefs are NULL, if so, enable them.  */
if ( [defaults objectForKey:@"kShakeToToggleVisibility"] == nil ){
    [defaults setObject:[NSNumber numberWithBool:YES] forKey:@"kShakeToToggleVisibility"];
}
if ( [defaults objectForKey:@"kBackgroundAudio"] == nil ){
    [defaults setObject:[NSNumber numberWithBool:YES] forKey:@"kBackgroundAudio"];
}
if ( [defaults objectForKey:@"kUseMyLocation"] == nil ){
    [defaults setObject:[NSNumber numberWithBool:YES] forKey:@"kUseMyLocation"];
}
if ( [defaults objectForKey:@"kAttachTwitterIcon"] == nil ){
    [defaults setObject:[NSNumber numberWithBool:YES] forKey:@"kAttachTwitterIcon"];
}
if ( [defaults objectForKey:@"kAttachTwitterLink"] == nil ){
    [defaults setObject:[NSNumber numberWithBool:YES] forKey:@"kAttachTwitterLink"];
}
/*  User chose to log out of Facebook Session, do that now.  */
if ( [[defaults objectForKey:@"kLogoutFacebook"] boolValue] == YES ){
    [defaults setObject:[NSNumber numberWithBool:NO] forKey:@"kLogoutFacebook"];
    [self fbLogout];
}

[defaults synchronize]; 
```

# java - Quartz Cron Trigger，运行两次

> ID：10401344
> 
> 赞同：0
> 
> 时间：2012-05-01T17:05:24.483
> 
> 标签：java, cron, quartz-scheduler

我有 cron 表达式

```
0 0/45 * * * ? 
```

恰好运行两次，例如第一次运行是 8:45 AM 下一次运行是 9:00 AM、9:45 AM、..10:00 AM

有什么问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T17:12:19.363

这个 cron 表达式表示它应该在整点 (0) 或整点后 45 分钟 (45) 运行。这是预期的行为。

# r - Pass the value of one argument to multiple functions within a function wrapper

> ID：10401347
> 
> 赞同：2
> 
> 时间：2012-05-01T17:05:38.977
> 
> 标签：r, function, wrapper

I am trying to write a function wrapper to make multiple plots within the same chart. The function that I use is `plotCI()` in 'gplots' package

```
sprPlot = function(data.frame, condition, ...){
require(gplots)
for(i in 1:condition){
    if(i == 1) 
       plotCI(...)
    else 
       plotCI(add = T, ...)
} 
```

However, as you can see, since there are basically two plotCI()s, if I try to set some of the arguments in `plotCI()` - e.g. `pch = -`, I get an error message saying that the formal argument pch matches multiple arguments in the function. I wonder if there is any way to get around it. Thanks.

# javascript - 使用 html2canvas 截屏并将 img 存储为 JS var

> ID：10401350
> 
> 赞同：6
> 
> 时间：2012-05-01T17:05:44.920
> 
> 标签：javascript, image, screenshot, html2canvas

我试图让我网站上的用户按下按钮来截取当前屏幕的屏幕截图（正文中的所有内容）。

根据我的研究，html2canvas 似乎是一种使这成为可能的资源。

我的问题是文档没有提供示例代码，我正在努力掌握所涉及的步骤。

[http://html2canvas.hertzen.com/documentation.html](http://html2canvas.hertzen.com/documentation.html)

以下 SO 问题（[如何使用 html2canvas 上传屏幕截图？](https://stackoverflow.com/questions/9250505/how-to-upload-a-screenshot-using-html2canvas)）让我有点困惑。我现在只想知道如何获取图像。

从他的代码。

```
$(window).ready(function(){
    ('body').html2canvas();
    var canvasRecord = new html2canvas(document.body).canvas;

     //At this point does the .toDataURL method return a png?
}); 
```

在这一点上，我迷失了图像的位置，甚至迷失了如何/何时创建它。我会担心稍后将其发送到服务器。

任何信息表示赞赏。谢谢！（甚至需要html2canvas？）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-25T18:20:30.167

当您使用 html2canvas jQuery 插件时，这里是一个示例片段

```
var screenshot;

$('body').html2canvas({
  onrendered: function(canvas) {
    screenshot = canvas.toDataURL();

    //code to process/send the image to server
  }
}); 
```

在上面的代码片段中，html2canvas 创建了页面的屏幕截图。

您还可以使用 PhantomJS 创建网页的屏幕截图 - 只要它们是公共页面，因为您可能无法访问服务器端的登录保护页面；在这种情况下，只有像 html2canvas 这样的客户端解决方案才能工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T07:34:35.347

```
$("#screenshot").click(function() {
  $("body").html2canvas({
    onrendered: function( canvas ) {
      $(".filt_opt_n").html(canvas);
      //window.open(img);
    }
  });
});
<div id="screenshot"></div> 
```

.filt_opt_n 这是一个 div，你想显示对我有用的输出

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-03T10:31:38.017

可能是一个老问题。你可以试试这个！

```
var htmlCanvas = new html2canvas(document.body);
var queue = htmlCanvas.parse();
var canvas = htmlCanvas.render(queue, { elements: { length: 1} });
var img = canvas.toDataURL(); 
```

# vim - 使用哪个jade.vim 插件？

> ID：10401351
> 
> 赞同：11
> 
> 时间：2012-05-01T17:05:49.667
> 
> 标签：vim, pug, vim-plugin

Github 有 [statianzo](https://github.com/statianzo/vim-jade)、 [vim-scripts](https://github.com/vim-scripts/jade.vim)和 [digitaltoad](https://github.com/digitaltoad/vim-jade)生成的模块。这三个都不是通过分叉相关的

谷歌发现了这一点：

[http://www.vim.org/scripts/script.php?script_id=3192](http://www.vim.org/scripts/script.php?script_id=3192)

哪个最好？

* * *

从下面复制（如果您发现他们的信息有用，请给他们投票）：

[vim.org](http://www.vim.org/scripts/script.php?script_id=3192) == [vim-scripts](https://github.com/vim-scripts/jade.vim) - 这是原始模块

...经过一些编辑和扩展（据我所知，更多的语法突出显示案例）代码演变成...

[digitaltoad](https://github.com/digitaltoad/vim-jade) - 最受欢迎

[statianzo](https://github.com/statianzo/vim-jade) - 外观与 digitaltoad 相似，关注者较少

现在，我将使用 digitaltoad 模块。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T17:30:27.803

GitHub 上的 vim-scripts 存储库只是 vim.org 上插件的 git 镜像。它甚至在 GitHub 上的那个 repo 的 README 中这么说，并指向 vim.org 上的脚本。这会处理您的两个链接。

看起来 digitaltoad 存储库似乎在某个时候基于 vim.org 上的包，因为某些文件将维护者归为同一个人。那个 repo 可能已经与 vim.org 上的那个不同了。

stantianzo repo 看起来可能与其他任何一个都有些不同。

我的建议是尝试一下并使用您认为最适合您的那个。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-01T17:47:21.767

digitaltoad repo 有最近的提交，所以我可能会为那个而丰满。最近的提交并不*一定*意味着更好/更稳定，但至少你知道有人正在积极致力于它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-26T18:02:52.607

我已经尝试过使用 vundle 安装和 digitaltoad 的“刚刚工作”，而 statianzo 没有自动缩进。一如既往，ymmv。

# c# - SQL Query selecting where there are more than 3 distinct

> ID：10401355
> 
> 赞同：0
> 
> 时间：2012-05-01T17:06:05.253
> 
> 标签：c#, sql

I am having problems with a SQL query, i need a list of consumers having purchased at least 3 different products whose suppliers are from a certain city (Lets say new york).

Tabels Columns:

Tb_Consumer..........Con_ID(PK), Name, City

Tb_Supplier.............Supp_ID(PK), Name, City

Tb_Transactions.....Tran_ID(PK), Supp_ID(FK), Con_ID(FK), PROD_ID(FK)

Tb_Products............Prod(ID(PK), Name

What i have so far:

```
var query8Result = (from c in context.Tb_Consumer
                                join t in context.Tb_Transactions on c.Con_ID equals t.Con_ID
                                join s in context.Tb_Supplier on t.Supp_ID equals s.Supp_ID
                                join p in context.Tb_Product on t.Prod_ID equals p.Prod_ID
                                where s.City == "New York" 
                                select new { Name = c.Name }).Distinct(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T17:13:58.167

我认为你需要一些 Group-by's

```
var query8Result = (from c in context.Tb_Consumer
                                join t in context.Tb_Transactions on c.Con_ID equals t.Con_ID
                                join s in context.Tb_Supplier on t.Supp_ID equals s.Supp_ID
                                join p in context.Tb_Product on t.Prod_ID equals p.Prod_ID
                                where s.City == "New York" 
                                group c by new { c.Name, t.Prod_ID } into customerProducts
                                group customerProducts by new { customerProducts.Key.Name } into customers
                                where customers.Count() > 3
                                select g.Key); 
```

抱歉，如果这不是 100% 正确 - 测试这个有点困难......

# formatting - Doxygen @todo 标签

> ID：10401356
> 
> 赞同：3
> 
> 时间：2012-05-01T17:06:06.580
> 
> 标签：formatting, doxygen, todo

`@todo`当我在最新版本的 doxygen (1.8) 的列表中在它下面有其他格式化数据时，我遇到了一个奇怪的命令问题。考虑以下示例：

```
/**
@page build_instructions Build Instructions
- Library1
    - @todo Detail build process

    - get source
    - build release/debug version for x64
    - build release/debug version for x86
*/ 
```

如果你运行它，你会注意到`@todo`标签在最后两个列表项（在“get source”之后）添加了额外的缩进。如果您删除`@todo`标签，那么缩进看起来没问题。另外，如果我删除`-`前面的`@todo`，它将下面的项目包含在一个框中。

这是一个错误吗？如何让`@todo`标签只影响一行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T17:18:32.417

我可以确认这一点：您的代码在 1.5 中有效，但在 1.8 中无效，所以这似乎是一个错误。两种可能的解决方法如下：

*   尝试将`todo`项目作为列表中的最后一个元素，

*   如果您希望该`todo`项目位于列表的顶部（或除最后一个元素之外的任何位置），请尝试在该项目后面的每个列表项目之间放置一个空行`todo`。

# opengl - Cg problems with OpenGL

> ID：10401357
> 
> 赞同：4
> 
> 时间：2012-05-01T17:06:06.777
> 
> 标签：opengl, shader, cg, glew, ogre

I'm working on an OpenGL project on Windows, using GLEW to provide the functionality the provided Windows headers lack. For shader support, I'm using NVIDIA's Cg. All the documentation and code samples I have read indicate that the following is the correct method for loading an using shaders, and I've implemented things this way in my code:

1.  Create a Cg context with `cgCreateContext`.
2.  Get the latest vertex and pixel shader profiles using `cgGLGetLatestProfile` with `CG_GL_VERTEX` and `CG_GL_FRAGMENT`, respectively. Use `cgGLSetContextOptimalOptions` to create the optimal setup for both profiles.
3.  Using these profiles and shaders you have written, create shader programs using `cgCreateProgramFromFile`.
4.  Load the shader programs using `cgGLLoadProgram`.

Then, each frame, for an object that uses a given shader:

1.  Bind the desired shader(s) (vertex and/or pixel) using `cgGLBindProgram`.
2.  Enable the profile(s) for the desired shader(s) using `cgGLEnableProfile`.
3.  Retrieve and set any needed uniform shader parameters using `cgGetNamedParameter` and the various parameter setting functions.
4.  Render your object normally
5.  Clean up the shader by calling `cgGLDisableProfile`

However, things start getting strange. When using a single shader everything works just fine, but the act of loading a second shader with `cgGLLoadProgram` seems to make objects using the first one cease to render. Switching the draw order seems to resolve the issue, but that's hardly a fix. This problem occurs on both my and my partner's laptops (fairly recent machines with Intel integrated chipsets).

I tested the same code on my desktop with a GeForce GTX 260, and everything worked fine. I would just write this off as my laptop GPU not getting along with Cg, but I've successfully built and run programs that use several Cg shaders simultaneously on my laptop using the [OGRE graphics engine](http://www.ogre3d.org) (unfortunately the assignment I'm currently working on is for a computer graphics class, so I can't just use OGRE).

In conclusion, I'm stumped. What is OGRE doing that my code is not? Am I using Cg improperly?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T17:19:01.610

你必须先打电话`cgGLEnableProfile`，然后再打电话`cgGLBindProgram`。从你的问题看来，你是反过来的。

来自 Cg 文档[`cgGLBindProgram`](http://http.developer.nvidia.com/Cg/cgGLBindProgram.html)：

> cgGLBindProgram 将程序绑定到当前状态。程序必须先用 cgGLLoadProgram 加载，然后才能绑定。此外，必须启用程序的配置文件才能使绑定起作用。这可以通过 cgGLEnableProfile 函数来完成。

# grails - Grails：查询 hasMany 关联

> ID：10401366
> 
> 赞同：0
> 
> 时间：2012-05-01T17:07:16.387
> 
> 标签：grails, grails-orm

我知道关于这个主题有几个问题，但似乎没有一个对我有用。我有一个带有以下域对象的 Grails 应用程序：

```
class Tag {
    String name
}

class SystemTag extends Tag {
    // Will have additional properties here...just placeholder for now
}

class Location {
    String name
    Set<Tag> tags = []
    static hasMany = [tags: Tag]
} 
```

我正在尝试查询已被 1 个或多个标签标记的所有 Location 对象：

```
class LocationQueryTests {

    @Test
    public void testTagsQuery() {
        def tag = new SystemTag(name: "My Locations").save(failOnError: true)
        def locationNames = ["L1","L2","L3","L4","L5"]
        def locations = []
        locationNames.each {
            locations << new Location(name: it).save(failOnError: true)
        }
        (2..4).each {
            locations[it].tags << tag
            locations[it].save(failOnError: true)
        }

        def results = Location.withCriteria {
            tags {
                'in'('name', [tag.name])
            }
        }

        assertEquals(3, results.size())     // Returning 0 results
    }
} 
```

我已验证数据正在正确创建/设置...创建了 5 个位置对象，其中最后 3 个已被标记。

我看不出上面的查询有什么问题。我真的很想远离 HQL，我相信这应该是可能的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T18:17:19.543

欢迎冬眠。

save 方法通知持久性上下文应该保存或更新一个实例。除非使用 flush 参数，否则对象不会立即持久化

如果您不使用刷新，它会分批保存，因此当您在保存后立即设置查询时，似乎数据不存在。

你需要添加

```
 locations[it].save(failOnError: true, flush:true) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T18:26:05.070

您应该使用[`addTo*`](http://grails.org/doc/latest/ref/Domain%20Classes/addTo.html)for 为一对多或多对多关系添加域类关系。

```
(2..4).each {
    locations[it].addToTags(tag)
} 
```

# vb.net - 验证 Gamefield VB.NET

> ID：10401370
> 
> 赞同：1
> 
> 时间：2012-05-01T17:07:23.807
> 
> 标签：vb.net, matrix, minesweeper

所以我正在开发一个扫雷游戏并分配地雷，但我必须检查现在地雷在哪里，以便生成数字。问题是，当我验证列和行时，我需要程序不要离开游戏领域。

这是我的代码现在的样子：

```
Public Sub avisinhos(ByVal line, ByVal column)
    If mat(line, column) = 0 Then
        mat(line, column) = -1
        numbandeiras = numbandeiras + 1
    End If
    For auxlinha = -1 To 1
        For auxcolumn = -1 To 1

        Next
    Next
End Sub 
```

如何创建一个 IF 函数来验证我没有脱离游戏领域？最好的问候，乔奥。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T17:26:27.703

伪代码

```
int linestart = -1;
int lineend = 1;
int colstart = -1;
int colend = 1;

Assuming a 10 x 10 grid (zero based)

if line < 2 linestart = 0
if line > 8 lineend = 0
if column < 2 colstart = 0
if column > 8 colend = 0

For auxlinha = linestart To lineend
   For auxcolumn = colstart To colend
     // check
   Next     
Next 
```

就个人而言，虽然我不会为循环而烦恼，但它们几乎没有添加

HasMineAbove = (line > 1) 和 (gamefield[line -1,column] = MinePresentValue

将是我的方法，一举两得。

更不用说当 auxlinha 和 auxcolumn 都为零时的巨大潜在混乱......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T17:52:20.010

我不确定你的代码到底在说什么。这有点神秘，因为您使用的是缩写和所有小写名称。您可能想尝试骆驼拼写并更完整地拼出单词，智能感知是您的朋友。=)

但抛开编码风格不谈，如果您尝试遍历有限范围的值，您可以使用模数运算符 (%) 来限制值。例如，如果您需要将值保持在 0-7 之间，并且最终的值为 12，则只需将 8 的模数循环回到值为 4 的范围内：

```
12 % 8 = 4
9  % 8 = 1
15 % 8 = 7
24 % 8 = 0 
```

我意识到这并不能回答您的具体问题，但它是一种方便的技术，可能会很有用。

# android - Scrolling in OpenGL ES 1.1

> ID：10401376
> 
> 赞同：0
> 
> 时间：2012-05-01T17:07:38.767
> 
> 标签：android, opengl-es, scroll

I'm developing a 2D side-scrolling game.I have a tiled bitmap for background with size 2400x480.How can i scroll this bitmap?

I know that i can do it with following code:

```
for(int i=0;i<100;i++)
draw(bitmap,2400*i,480); 
```

So it will scroll bitmap for 240000 pixels.

But i don't want to draw images which stays out of screen(with size 800x480).

How can i render scrolling tile?How can i give velocity to it?(For parallax scrolling after normal scrolling)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T07:02:09.233

下面的代码不是使用两个四边形，而是一个四边形，并相应地调整纹理坐标。请注意，我剥离了所有纹理处理代码。投影矩阵仅包含`glOrthof(0.0f, 1.0f, 0.0f, 1.0f, -1.0f, 1.0f);`。`Quad2D`定义一个四边形，其 tex 坐标可以使用 动画`updateTexCoords`：

```
static class Quad2D {
    public Quad2D() {
        /* SNIP create buffers */
        float[] coords = { 1.0f, 0.0f, 0.0f, 0.0f, 1.0f, 1.0f, 0.0f, 1.0f, };
        mFVertexBuffer.put(coords);
        float[] texs = { 1.0f, 1.0f, 0.0f, 1.0f, 1.0f, 0.0f, 0.0f, 0.0f, };
        mTexBuffer.put(texs);
        /* SNIP reposition buffer indices */
    }

    public void updateTexCoords(float t) {
        t = t % 1.0f;
        mTexBuffer.put(0, 0.33f+t);
        mTexBuffer.put(2, 0.0f+t);
        mTexBuffer.put(4, 0.33f+t);
        mTexBuffer.put(6, 0.0f+t);
    }

    public void draw(GL10 gl) {
        glVertexPointer(2, GL_FLOAT, 0, mFVertexBuffer);
        glTexCoordPointer(2, GL_FLOAT, 0, mTexBuffer);
        glDrawArrays(GL_TRIANGLE_STRIP, 0, 4);
    }
    /* SNIP members */
} 
```

现在怎么打电话`updateTexCoords`？在里面`onDrawFrame`，输入以下代码：

```
 long time = SystemClock.uptimeMillis() % 3000L;
    float velocity = 1.0f / 3000.0f;
    float offset = time * velocity;
    mQuad.updateTexCoords(offset); 
```

由于纹理坐标超出`1.0f`，S 坐标的纹理环绕必须设置为`GL_REPEAT`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T07:42:13.947

如果您可以使用着色器，我们可以使用更清洁且可能更有效的方式来执行此操作。

创建一个四边形覆盖整个屏幕的 VBO。宽度和高度应分别为 800 和 480。

然后将您的顶点着色器创建为：

```
attribute vec4 vPos;
uniform int shift;
varying mediump vec2 fTexCoord;
void main(void){
   gl_Position = vPos;
   fTexCoord = vec2((vPos.x-shift)/800.0, vPos.y/480.0);//this logic might change slightly based on which quadarnt you choose.
} 
```

片段着色器将类似于：

```
precision mediump float;
uniform sampler2D texture;    
varying mediump vec2 fTexCoord;
void main(void){
   gl_FragColor = texture2D(texture, fTexCoord);
} 
```

你就完成了。要滚动只需使用“glUniformX()”api 设置统一值。

# android-animation - 使图像视图平滑地出现和消失

> ID：10401377
> 
> 赞同：0
> 
> 时间：2012-05-01T17:07:42.963
> 
> 标签：android-animation

我想为视图的可见性属性设置动画，使其平滑地出现/消失。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T17:19:22.147

如果您想为 Alpha 值设置动画，则应该查看[AlphaAnimation](http://developer.android.com/reference/android/view/animation/AlphaAnimation.html)

请参阅下面的链接以获取更多帮助：

1.  [安卓动画](http://www.barebonescoder.com/2010/06/android-development-more-animations-part-2/)

# java - Java：System.out.println() 应该写入控制台，但它没有

> ID：10401380
> 
> 赞同：8
> 
> 时间：2012-05-01T17:07:50.913
> 
> 标签：java, console

我正在尝试编写 Java 控制台应用程序，代码很简单：

```
public class ConsoleTest {
    public static void main(String[] args) {
        System.out.println("test");
    }
} 
```

如果我从 Eclipse 运行此应用程序，那么我`test`会在 Eclipse 的“控制台”中看到“”，但如果我将我的应用程序导出为“可运行的*JAR 文件*”并从 Windows XP 运行它`cmd.exe`，那么控制台不会回显任何内容。

为了安全起见，我尝试检查`System.console()`，它返回`null`。

有什么问题？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-01T17:15:53.793

你是如何在eclipse之外运行你的程序的？

你应该使用命令行

`java -jar yourjar.jar`

或者

`java -cp yourjar.jar ConsoleTest`

如果您偶尔使用`javaw`，则不会产生控制台输出。的标准输出`javaw`是`null`。当您单击 jar 文件时，可能会发生这种情况。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-01T17:14:25.027

您需要从命令行运行您的 jar 文件。

如果您双击它，您将无法看到在后台运行的命令行操作。Jar 文件通常只有在涉及 GUI 时才通过双击运行。

要从命令提示符运行 jar 文件，只需执行以下操作：

```
java -jar ConsoleTest.jar 
```

假设您已经为 java.exe 设置了环境变量并且当前目录有 jar 文件。

如果这不起作用，那么很可能不是您的代码的错。还有可能指向 Main 类的清单文件设置不正确。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-01T17:12:17.530

尝试从命令行将其编译成一个类，然后运行它。那样有用吗？

```
javac ConsoleTest.java
java ConsoleTest 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-01T17:10:35.403

您的可运行 jar 文件可能没有按预期工作，并且实际上没有运行您的 ConsoleTest 类。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-01T17:13:20.087

就像 Hovercraft Full Of Eels 写的一样，使用 cmd.exe 使用以下命令编译 .java 文件：

```
javac ConsoleTest.java 
```

然后这将创建一个 .class 文件，我们想用这个命令编译它：

```
java ConsoleTest 
```

然后它应该显示“测试”输出。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-05-01T17:14:33.460

您必须安装 java jdk 并将包含文件 java.exe 的目录的根添加到系统目录中，您将在 jdk 的安装指南中找到更多信息。

然后使用命令在控制台中运行该文件

```
> java file.java 
```

# excel - Excel 2010 到其他工作簿中单元格的相对链接

> ID：10401385
> 
> 赞同：1
> 
> 时间：2012-05-01T17:08:09.140
> 
> 标签：excel

我正在尝试在 excel 中建立与单元格中其他 excel 文件的相对链接。当文件在同一个文件夹中时，所有链接都可以，但是当文件在父文件夹中时，链接在移动文件时会成为问题。

我正在尝试执行 ..\Workbook.xlsm 之类的操作来在父文件夹中查找文件，但由于某种原因，除了 VBA 之外，我找不到任何解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T17:39:38.707

我认为这应该是可能的，但在管理文件夹之间的链接时需要小心。有关 Excel 如何管理链接的详细信息，请查看此 MS 知识库文章：http: [//support.microsoft.com/kb/328440](http://support.microsoft.com/kb/328440)。

如果需要，解压缩 .xlsm 文件的内容可以检查链接位置的路径。

# sql - 使用 SQL 删除反转对

> ID：10401393
> 
> 赞同：0
> 
> 时间：2012-05-01T17:09:03.180
> 
> 标签：sql, sql-server, oracle

我有一个与这个问题密切相关的 sql 问题 - [SQL - Need to find duplicate records but EXCLUDE reversed transactions](https://stackoverflow.com/questions/302022/sql-need-to-find-duplicate-records-but-exclude-reversed-transactions)

我需要使用（如果可能）非过程 SQL 删除记录集的所有反转“对”。具体的 rdbms 是 Oracle 11g，但我希望 SQL 尽可能通用，以便在 SQL Server 2008 中使用相同的策略。示例记录集如下所示：

* * *

```
 ROW     |    DATE    |    QTY    |    FUEL_TYPE    |    REVERSAL    |
1        | 01-MAY-12  |    23.3   |    DSL          |    N           |
2        | 01-MAY-12  |   -23.3   |    DSL          |    Y           |
3        | 01-MAY-12  |    23.3   |    DSL          |    N           |
4        | 01-MAY-12  |    23.3   |    DSL          |    N           |
5        | 01-MAY-12  |    23.3   |    DSL          |    N           |
6        | 01-MAY-12  |    18.6   |    DSL          |    N           |
7        | 01-MAY-12  |   -18.6   |    DSL          |    Y           |
8        | 01-MAY-12  |    14.9   |    GAS          |    N           | 
```

查询的期望结果会将此记录集减少到：

* * *

```
 ROW     |    DATE    |    QTY    |    FUEL_TYPE    |    REVERSAL    |
3        | 01-MAY-12  |    23.3   |    DSL          |    N           |
4        | 01-MAY-12  |    23.3   |    DSL          |    N           |
5        | 01-MAY-12  |    23.3   |    DSL          |    N           |
8        | 01-MAY-12  |    14.9   |    GAS          |    N           | 
```

请注意，重复是可能的，但总是需要删除反转“对”。

*编辑* 行和行号无关紧要，仅用于说明。删除哪些记录并不重要，只是总有一个“对”——一个正数和负数。因此，例如，第 2 行可以与 1、3、4 或 5 配对并删除。

此外，填充表的逻辑和表结构本身由供应商软件控制，并且不包括在冲销记录中被冲销的记录的原始 ID。我真的无法控制这个。 */编辑*

顺便说一句，如果 MINUS 关键字被更改，它的功能类似于 UNION 和 UNION ALL，我会很高兴 - 因为 MINUS 只会删除与第二个记录集匹配的单个行集，但 MINUS ALL 会删除与第二个记录集匹配的*每一*行记录集。如果是这样的话，这个问题将是微不足道的（至少对于我的大脑思考方式而言）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T19:34:45.870

您面临的问题是冲销没有直接分配给他们正在冲销的交易。

假设反转是精确反转，您可以采取以下方法。对于给定的一组交易信息，列举逆转和非逆转。然后，取所有不匹配的非反转。

这是执行此操作的 SQL 示例：

```
with t as 
(
  select row, date, qty, fuel_type, reversal,
    ROW_NUMBER() over (partition by row, date, qty, fuel_type, reversal) as rownum
  from table
)
select *
from 
(
   select *
   from t
   where t.reversal = 'N'
 ) n 
 left outer join
 (
   select *
   from t
   where t.reversal = 'Y'
 ) y
    on n.date = y.date 
    and n.qty = y.qty 
    and n.fuel_type = y.fuel_type 
    and n.rownum = y.rownum 
where n.row is null 
```

这应该适用于 SQL 和 Oracle，因为它们都支持 row_number 窗口/分析函数。

请注意，此解决方案不保证反转是正确的。它还假设逆转发生在原始交易的同一天。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T11:53:31.407

事实证明，我正在以一种非常糟糕的方式看待这个问题。我没有找到*确切的*反转对，而是用 GROUP BY 做了一个 SUM，所以只保留了我关心的值。

最终结果是交易最终会变得不同——尤其是在我的情况下，真正的交易表实际上是一个日期时间值而不是日期。

```
SELECT SUM(QTY) AS newQTY, DATE, FUEL_TYPE
FROM fuel_transactions
GROUP BY DATE, FUEL_TYPE 
```

The only time this won't produce the values that you really want are if you have a need to maintain the id's of the transactions, or if you have a situation in which multiple transactions occur at the *exact* same time.

# mvvm - 如何绑定 Silverlight 数据网格行中的单选按钮并读取 Viewmodel 中每一行的选定值

> ID：10401397
> 
> 赞同：0
> 
> 时间：2012-05-01T17:09:23.877
> 
> 标签：mvvm, silverlight-4.0, wpfdatagrid

我有一个数据网格，每一行在 1 列中有一组单选按钮。我已经使用列表框数据模板绑定了这些单选按钮以动态生成单选按钮。

这是模板的代码：

```
<data:DataGrid   x:Name="formTemplate" AutoGenerateColumns="False" GridLinesVisibility="All" HeadersVisibility="All"  ItemsSource="{Binding Path=FormFieldInformation,Mode=TwoWay}"  >
  <data:DataGrid.Columns>
       <data:DataGridTemplateColumn DisplayIndex="1">
              <data:DataGridTemplateColumn.CellTemplate>
                 <DataTemplate>
                      <StackPanel>
                          <RadioButton GroupName="GN1" Content="From" Width="50" 
                                HorizontalAlignment="Left" VerticalAlignment="Center"/>
                       </StackPanel>
                  </DataTemplate>
               </data:DataGridTemplateColumn.CellTemplate>
       </data:DataGridTemplateColumn>
   <data:DataGrid.Columns>
 </data:DataGrid> 
```

但是这里有两个问题： 1.我只能在为整个数据网格生成的所有单选按钮中选择一个单选按钮。我想每行选择一个单选按钮。2\. 如何在 ViewModel 中获取选中的单选按钮值？

任何建议都提前表示赞赏。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T18:37:57.783

（对不起，我的英语不好）

`GroupName`1）您需要为每个`RadioButton`集合赋予唯一性。我认为最简单的方法是将 绑定`GroupName`到您将数据网格绑定到的类上的属性。例如，假设你有这个类：

```
public class Item
{
    public int Id { get; set; }
    public string Name { get; set; }
    public bool Radio1IsChecked { get; set; }
    public bool Radio2IsChecked { get; set; }
} 
```

其中“Id”是唯一的，将其绑定到 ，`GroupName`以便每一行都有不同的行。

2）要获得检查值，您必须将 绑定`RadioButton` `IsChecked`到您的类上的属性。使用上面的类，它会是这样的：

```
<DataTemplate>
    <StackPanel Orientation="Horizontal">
        <RadioButton GroupName="{Binding Id}" Content="From" IsChecked="{Binding Radio1IsChecked,Mode=TwoWay}"/>
        <RadioButton GroupName="{Binding Id}" Content="To" IsChecked="{Binding Radio2IsChecked,Mode=TwoWay}"/>
    </StackPanel>
</DataTemplate> 
```

**编辑1**

我假设您发布的 XAML 代码不是您正在运行的实际代码，对吧？试试这个`CellTemplate`：

```
<DataTemplate>
<StackPanel>
    <TextBlock Text="{Binding Name}"/>
    <ItemsControl ItemsSource="{Binding Radios}">
        <ItemsControl.ItemTemplate>
            <DataTemplate>
                <StackPanel>
                    <RadioButton GroupName="{Binding GroupName}" Content="{Binding Name}" IsChecked="{Binding IsChecked,Mode=TwoWay}"/>
                </StackPanel>
            </DataTemplate>
        </ItemsControl.ItemTemplate>
    </ItemsControl>
</StackPanel> 
```

现在你的班级必须是这样的：

```
public class Item
{
    public int Id { get; set; }
    public string Name { get; set; }
    public List<Radio> Radios { get; set; }
}

public class Radio
{
    public int Id { get; set; }
    public string Name { get; set; }
    public bool IsChecked { get; set; }
    public string GroupName { get; set; }   
} 
```

现在您可以拥有多个 RadioButtons（只需将它们添加到 Item.Radios 列表中）。

那对你有用吗？

# session - 如何在 Spring MVC 中的控制器之间共享 SessionAttributes？

> ID：10401402
> 
> 赞同：6
> 
> 时间：2012-05-01T17:09:41.787
> 
> 标签：session, spring-mvc, attributes

我想使用 @SessionAttributes 注释在 Spring MVC 中的两个控制器之间共享会话属性。

这是我用来测试属性共享的简单代码：AController.java

```
@Controller
@SessionAttributes("myParam")
public class AController {

@RequestMapping(value="/a")
public String handle(Model model){

    if(!model.containsAttribute("myParam"))
        model.addAttribute("myParam", randomInt());

    return "a";
}

private int randomInt(){
    return new Random().nextInt(100);
}

} 
```

一个.jsp

```
<%@taglib uri="http://java.sun.com/jstl/core" prefix="c" %>
<html>
<h1>Page A</h1>
<p>Param = ${myParam}</p>
</html> 
```

BController.java

```
@Controller
@SessionAttributes("myParam")
public class BController {

@RequestMapping(value="/b")
public String handle(Model model){

    if(!model.containsAttribute("myParam"))
        model.addAttribute("myParam", randomInt());

    return "b";
}

private int randomInt(){
    return new Random().nextInt(100);
}

} 
```

b.jsp

```
<%@taglib uri="http://java.sun.com/jstl/core" prefix="c" %>
<html>
<h1>Page B</h1>
<p>Param = ${myParam}</p> 
```

我期望的行为是转到 /a URL，myParam 将设置为 0 到 99 之间的随机值，然后该值将在两个控制器之间共享。

但是，会发生以下情况：我转到 /a URL，myParam 设置为一个值（比如说 10）。然后我转到 /b URL，myParam 设置为另一个值（比如说 20）。当我返回 /a URL 时，myParam 值是 BController 设置的值（myParam =20）。

一旦执行了两个控制器方法，该值就会被共享，但在此之前，每个控制器都会重新定义一个新值。

看起来如果控制器从未为 SessionAttribute 设置值，那么如果它是由另一个控制器设置的，它就不会检测到该属性。

我真的希望能够在不使用 HttpSession 对象并坚持使用 Spring MVC 3 对象的情况下在控制器之间共享会话属性。

我想知道我是否遗漏了什么，或者是否有其他做法可以在控制器之间的会话中共享数据。

注意：webapp 部署在 Tomcat7 服务器上。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-06T11:34:36.730

在 Spring MVC 中，@SessionAttributes 并不意味着在控制器之间共享。

我所做的是创建一个具有 Session 范围的对象（通过 POJO），它包含我需要为 Session 存储的所有值。

然后我使用 JDK 动态代理将对象自动连接到控制器。

# http - 缓存控制：在公共或最大年龄之前？

> ID：10401404
> 
> 赞同：9
> 
> 时间：2012-05-01T17:09:56.497
> 
> 标签：http, header

我相信他们都是等价的，但可以肯定的是我想认识其他人。

哪个版本是正确的？

1.  `Cache-Control: public, max-age=60`

2.  `Cache-Control: max-age=60, public`

?

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-01T17:15:10.873

以下是RFC 7234中[Cache-Control 指令的语法：](https://www.rfc-editor.org/rfc/rfc7234#section-5.2)

```
Cache-Control   = 1#cache-directive
cache-directive = token [ "=" ( token / quoted-string ) ] 
```

`1#cache-directive`意味着您[至少需要一个](https://www.rfc-editor.org/rfc/rfc7230#section-7) `cache-directive`. 由于`public`和`max-age`都是 Cache-Control 指令，因此**顺序无关紧要**。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T17:11:50.207

它们是等价的。无论如何，订单在那种情况下甚至都没有什么不同。

# c++ - 不实施方法是否合法和良好的做法？

> ID：10401405
> 
> 赞同：-2
> 
> 时间：2012-05-01T17:10:01.937
> 
> 标签：c++, virtual

```
#include <iostream>

using namespace std;

class base
{
public:
  virtual void taunt() = 0;
  virtual void hide() = 0;
};

template <int nx, int ny>
class derivedA : public base
{
  void hide();
public:
  void taunt() { cout << "derivedA" << endl; }

  char c[nx][ny];
};

template <int nx, int ny, int nz>
class derivedB : public base
{
  void taunt();
public:

  void hide() { cout << "hide B" << end; }
  char c[nx][ny][nz];
};

int main()
{
  derived * dp = new derivedA();

  dp->taunt();

  delete dp;

  DerivedB b;

  dp = &b;

  dp->hide();

  return 0;
} 
```

A 和 B 都是从纯虚拟类基派生的，并且都有一个未实现的方法。不实施一种方法是否合法？不实施一种方法是可以接受的还是好的做法？有没有更好的方法？

编辑：我刚刚注意到这些类不是从基类派生的。我已经更改了代码，所以它确实如此。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T17:14:14.283

如果您从具有纯虚方法的类派生并且您没有在派生类中覆盖该方法，则该派生类也将是一个抽象类。如果这对您来说没问题（例如，您将进一步推导它），那么您可以这样做。如果您*确实*想实例化该派生类，则必须覆盖所有纯抽象方法

请注意，在您的示例中，您不是从抽象类派生的：`base`两者都是独立类。你需要：`derivedA``derivedB`

```
class derivedA : public base {
  //...
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T17:13:41.617

不允许实例化任何具有纯虚成员函数的类。你当然*可以有*这样一个类，但它的任何实例都必须是所有纯虚都已定义的子类。

# c# - 使用最小起订量填充 httpcontext.request

> ID：10401409
> 
> 赞同：0
> 
> 时间：2012-05-01T17:10:17.890
> 
> 标签：c#, asp.net-mvc, unit-testing, nunit, moq

我正在使用[hanselman 教程](http://www.hanselman.com/blog/ASPNETMVCSessionAtMix08TDDAndMvcMockHelpers.aspx)来使用 Moq 为将 httpcontext 作为输入参数的方法创建单元测试。

```
public static class MvcMockHelpers
{

    public static HttpContextBase FakeHttpContext()
    {
        var context = new Mock<HttpContextBase>();
        var request = new Mock<HttpRequestBase>();
        var response = new Mock<HttpResponseBase>();
        var session = new Mock<HttpSessionStateBase>();
        var server = new Mock<HttpServerUtilityBase>();

        context.Setup(ctx => ctx.Request).Returns(request.Object);
        context.Setup(ctx => ctx.Response).Returns(response.Object);
        context.Setup(ctx => ctx.Session).Returns(session.Object);
        context.Setup(ctx => ctx.Server).Returns(server.Object);

        return context.Object;
    }

    public static HttpContextBase FakeHttpContext(string url)
    {
        var context = FakeHttpContext();
        context.Request.SetupRequestUrl(url);  <---- error here
        return context;
    } 

} 
```

我在**context.Request.SetupRequestUrl(url);上收到以下错误**

*错误 1“System.Web.HttpRequestBase”不包含“SetupRequestUrl”的定义，并且找不到接受“System.Web.HttpRequestBase”类型的第一个参数的扩展方法“SetupRequestUrl”（您是否缺少 using 指令或装配参考？）*

请帮忙。

我正在尝试找到一个非常简单易学的教程来设置 httpcontext 请求对象并使用上下文输入参数传递给方法，并能够创建单元测试，但谷歌中的所有示例要么不起作用要么很复杂。请帮忙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T17:12:39.480

确保您已在类中声明了`SetupRequestUrl`扩展方法，[如 Haacked 所示](http://haacked.com/archive/2007/11/05/rhino-mocks-extension-methods-mvc-crazy-delicious.aspx)：`MvcMockHelpers`

```
public static void SetupRequestUrl(this HttpRequestBase request, string url)
{
    ...
} 
```

您应该已经从文章中复制粘贴了整个代码片段。

# javascript - 如何在我的视频导航中增加 videoIndex？

> ID：10401413
> 
> 赞同：1
> 
> 时间：2012-05-01T17:10:59.847
> 
> 标签：javascript, jquery, html, css, web-applications

我有一个视频播放器，我想用 javascript 控制它。它看起来像这样：

```
<iframe height="309" width="500" frameborder="0" id="video_player" src="" allowfullscreen></iframe> 
```

视频播放器源现在等于没有。但后来我命令它等于一个 youtube 链接。还有两个按钮可以控制电影的哪个部分。这就是我的麻烦所在。我可以遍历加载的第一个视频，但不能遍历剩余的视频。这对我来说太复杂了，无法弄清楚。

```
<button id="back_btn" style="float:left">Back</button>  
<button id="next_btn" style="float:right">Next</button> 
```

在视频播放器和按钮之后，我添加了控制它的代码。我使用了一个 for 循环来生成视频菜单。我将视频数据存储在一个多维数组中。当我使用术语多维数组时，我觉得我来自外太空。比如让我们打开多维门户抓取视频数据。然后我必须使用模块模式将 i 的值存储在我为每个菜单项创建的每个事件侦听器中。我制作了一个没有 jQuery 库的程序版本，代码似乎并没有缩短多少。我在工作中的菜鸟技能。

```
<script type="text/javascript">
    //Javascript Video Player and Table of Contents
    var partId = 1;
    var videoIndex = 0;
    var videoPlayer = $("#video_player");
    var videos = new Array(
        ["Dr. Dive Flies a Helicopter",
         "http://www.youtube.com/embed/8t_cEvjpyp0",
         "http://www.youtube.com/embed/LbXF4un-b5Y",
         "http://www.youtube.com/embed/ec27I2F1y7E",
         "http://www.youtube.com/embed/Y4b9lMcPx64",
         "http://www.youtube.com/embed/9BqEkbK9sjA",
         "http://www.youtube.com/embed/veSPoE3CaTM"],
        ["California Diving Competition",
         "http://www.youtube.com/embed/dUjKW3aN96k"],
        ["Dr. Dive Diving",
         "http://www.youtube.com/embed/s2iZ-raCKq0"],
        ["Tom Hairabedian playing his harmonica at age 88!",
         "http://www.youtube.com/embed/jQZbVY4HCzQ"]);
    loadVideo();
    for(var i = 0; i < videos.length; i++){
        (function(i){
            var a = $("<a>").html(videos[i][0]);
            //videoIndex = i;//This will break the script
            a.css("display","block");
            a.css("cursor","pointer");
            a.click(function(){
                videoPlayer.attr("src", videos[i][1]);
            });
            $("#contents").append(a);
        }(i));
    }
    $("#back_btn").click(function(){
        partId--;
        loadVideo();
    });
    $("#next_btn").click(function(){
        partId++;
        //videoIndex++;//I add one to...no
        loadVideo();
    });
    function loadVideo(){
        videoPlayer.attr("src", videos[videoIndex][partId]);
    }
</script> 
```

我只能在加载的第一个视频上使用下一个和后退按钮。当我在第一个视频以外的任何视频上并使用下一个和后退按钮时，它将返回到视频阵列中的第一个视频。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T17:23:15.347

你试过了吗：

```
 <script type="text/javascript">
                //Javascript Video Player and Table of Contents
                var partId = 1;
                var videoIndex = 0;
                var videoPlayer = $("#video_player");
                var videos = new Array(["Dr. Dive Flies a Helicopter","http://www.youtube.com/embed/8t_cEvjpyp0","http://www.youtube.com/embed/LbXF4un-b5Y","http://www.youtube.com/embed/ec27I2F1y7E","http://www.youtube.com/embed/Y4b9lMcPx64","http://www.youtube.com/embed/9BqEkbK9sjA","http://www.youtube.com/embed/veSPoE3CaTM"],["California Diving Competition","http://www.youtube.com/embed/dUjKW3aN96k"],["Dr. Dive Diving","http://www.youtube.com/embed/s2iZ-raCKq0"],["Tom Hairabedian playing his harmonica at age 88!","http://www.youtube.com/embed/jQZbVY4HCzQ"]);
                loadVideo();
                for(var i = 0; i < videos.length; i++){
                    (function(i){
                    var a = $("<a>").html(videos[i][0]);
                    //videoIndex = i;//This will break the script
                    a.css("display","block");
                    a.css("cursor","pointer");
                    a.click(function(){
                            videoPlayer.attr("src", videos[i][1]);
                        });
                    $("#contents").append(a);
                    }(i));
                }
                $("#back_btn").click(function(){
                    partId--;
                    loadVideo();
                });
                $("#next_btn").click(function(){
                    partId++;
                    videoIndex=i++;
                    loadVideo();
                });
                function loadVideo(){
                    videoPlayer.attr("src", videos[videoIndex][partId]);
                }
            </script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T18:46:47.267

下面是另一个稍微更健壮的脚本，它可以解决您可能遇到的一些问题。

```
<iframe height="309" width="500" frameborder="0" id="video_player" src="" allowfullscreen></iframe> 
<a href="#" id="back_btn">Back</a>   
<a href="#" id="next_btn">Next</a> 

<div id="contents">&nbsp;</div>

<script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>
<script type="text/javascript">

// Keep everything in a single function variable to reduce global impact;
var loadVideo = (function() {

  var videos = [["Dr. Dive Flies a Helicopter","http://www.youtube.com/embed/8t_cEvjpyp0","http://www.youtube.com/embed/LbXF4un-b5Y","http://www.youtube.com/embed/ec27I2F1y7E","http://www.youtube.com/embed/Y4b9lMcPx64","http://www.youtube.com/embed/9BqEkbK9sjA","http://www.youtube.com/embed/veSPoE3CaTM"],["California Diving Competition","http://www.youtube.com/embed/dUjKW3aN96k"],["Dr. Dive Diving","http://www.youtube.com/embed/s2iZ-raCKq0"],["Tom Hairabedian playing his harmonica at age 88!","http://www.youtube.com/embed/jQZbVY4HCzQ"]],
      $videoPlayer = $("#video_player"),  // $ in front of jQuery variables for clarity
      currentVideo = 0, i, l,

  // Increment video index safely
  inc = function() {
    var x = currentVideo + 1;
    if ( x >= videos.length ) {
      x = 0;
    }
    currentVideo = x;
    return currentVideo;
  },

  // Decrement video index safely
  dec = function() {
    var x = currentVideo - 1;
    if ( x < 0 ) {
      x = (videos.length - 1);
    }
    currentVideo = x;
    return currentVideo;
  };

  for(i = 0, l = videos.length; i < l; i++){

    // Use normal anchors, clean up and chain jQuery
    $("<a>").
      html(videos[i][0]).
      css({"display" :"block"}).  // Or add a class and use CSS for this.
      attr("href", "#").  // Makes links work
      data("id", i).  // Save our video index number on the link
      click(function(e) {
       currentVideo = $(this).data("id");  // update current video index
       loadVideo(currentVideo);
        e.preventDefault;  // Prevent default # handling.
      }).
      appendTo('#contents');
  }

  // Go back one video
  $("#back_btn").click(function(e){
    loadVideo( dec() );
    e.preventDefault();
  });

  Go forward one video
  $("#next_btn").click(function(e){
    loadVideo( inc() );
    e.preventDefault();
  });

  // fills loadVideo variable with reusable function that takes an video number
  return function(videoNum) {
    var v = videoNum || currentVideo;
    $videoPlayer.attr("src", videos[v][1]);
  };

})();

loadVideo();  // Make it go and load video.
</script> 
```

# wpf - 使用 WPF 延迟输入验证

> ID：10401414
> 
> 赞同：3
> 
> 时间：2012-05-01T17:11:07.980
> 
> 标签：wpf, validation, xaml, .net-4.0

我的 WPF 应用程序中有以下场景：

1.  用户在文本框中输入一个值。
2.  我启动了一个后台线程来验证该值（通过 Web 服务调用）。
    （98% 的时间输入是有效的。）
3.  用户离开文本框并继续处理下一个文本框。
4.  后台线程返回，结果表明输入无效。
    它通过触发事件让视图模型知道这一点。（我正在使用 Prism 事件和模块。）

我需要一种方法让该事件让 TextBox 知道它的输入存在验证错误。（请记住，焦点不再在该控件中。）

我可以想出各种方法来“滚动我自己的验证”并完成这项工作。但我想在 WPF 中现有的验证框架内工作。

注意：我不确定它是否相关，但我需要维护一个“NeededValidations”列表，在我启用“保存”按钮之前，所有这些都必须通过。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T19:43:15.367

您可以尝试以下几种使用 IDataErrorInfo 的方法。它们都依赖于提高 INotifyPropertyChanged 通知将导致重新评估绑定验证的事实。

有两个文本框。一种使用异步绑定并假设 Web 服务调用是同步的。第二个使用同步绑定并假设 Web 服务调用是异步的。

Xaml

```
<Window.DataContext>
    <WpfValidationUpdate:ViewModel/>
</Window.DataContext>

<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="Auto"/>
        <RowDefinition/>
    </Grid.RowDefinitions>

    <TextBox Margin="5" Grid.Row="0" Text="{Binding Text1, IsAsync=True, ValidatesOnDataErrors=True}"/>
    <TextBox Margin="5" Grid.Row="1" Text="{Binding Text2, ValidatesOnDataErrors=True}"/>
</Grid> 
```

查看模型

```
public class ViewModel : IDataErrorInfo, INotifyPropertyChanged
{
    private string _text1;
    private string _text2;
    private bool _text1ValidationError;
    private bool _text2ValidationError;

    #region Implementation of IDataErrorInfo

    public string this[string columnName]
    {
        get
        {
            if(columnName == "Text1" && _text1ValidationError)
            {
                return "error";
            }

            if(columnName == "Text2" && _text2ValidationError)
            {
                return "error";
            }

            return string.Empty;
        }
    }

    public string Error
    {
        get
        {
            return string.Empty;
        }
    }

    public string Text1
    {
        get { return _text1; }
        set
        {
            _text1 = value;
            OnPropertyChanged("Text1");

            // Simulate web service synchronously taking a long time
            // Relies on async binding
            Thread.Sleep(2000);
            _text1ValidationError = true;

            OnPropertyChanged("Text1");
        }
    }

    public string Text2
    {
        get { return _text2; }
        set
        {
            _text2 = value;
            OnPropertyChanged("Text2");

            // Simulate web service asynchronously taking a long time
            // Doesn't rely on async binding
            Task.Factory.StartNew(ValidateText2);
        }
    }

    private void ValidateText2()
    {

        Thread.Sleep(2000);

        _text2ValidationError = true;
        OnPropertyChanged("Text2");
    }

    #endregion

    #region Implementation of INotifyPropertyChanged

    public event PropertyChangedEventHandler PropertyChanged;

    private void OnPropertyChanged(string propertyName)
    {
        var handler = PropertyChanged;
        if(handler != null)
        {
            handler(this, new PropertyChangedEventArgs(propertyName));
        }
    }
    #endregion
} 
```

# jquery - jQuery Validation 只验证第一个隐藏的输入元素？

> ID：10401416
> 
> 赞同：2
> 
> 时间：2012-05-01T17:11:12.017
> 
> 标签：jquery, asp.net, asp.net-mvc, validation

我的表单上有两个隐藏的输入字段，已链接到 jquery 验证规则。这些是某种“全局”表单规则（例如，多个字段的总数不等于 100%），因此我在表单顶部使用隐藏字段来显示适用于整个表单的消息。

它们的定义如下：

```
<input type="hidden" class="futuretotalsunder"/>
<input type="hidden" class="futuretotalsrequired"/> 
```

这是我的规则定义。你可以得到它的想法。第一条规则检查一堆文本框的总数是否小于 100，第二条规则检查以确保总数不为 0。问题是，唯一触发的是适用于第一个隐藏的文本框输入元素。第二个永远不会开火。知道为什么吗？

```
$.validator.addMethod("futuretotalsunder", function (val, element, params) {
        alert("under");
        var total = 0;

        $(".TransferPercentTextBox").each(function () {
            total = total + parseInt($(this).val());
        });

        if ((total < 100) && (total != 0)) {
            window.location.href = "#Top";
            return false;
        }
        else {
            return true;
        }
    }, "Total percentage must equal 100%.");

     $.validator.addMethod("futuretotalsrequired", function (val, element, params) {

        var total = 0;

        $(".TransferPercentTextBox").each(function () {
            total = total + parseInt($(this).val());
        });

        if (total == 0) {
            window.location.href = "#Top";
            return false;
        }
        else {
            return true;
        }
    }, "Transfer amount must be greater than 0."); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T02:47:38.253

我想到了。问题（奇怪）是我的输入元素没有名称属性。一旦我添加它们，它就可以正常工作。

# python - python scrapy如何删除多余的解析字符

> ID：10401417
> 
> 赞同：1
> 
> 时间：2012-05-01T17:11:15.673
> 
> 标签：python, scrapy

在使用scrapy的解析过程中，我发现了这个输出

> [u'TARTARINI AUTO SPA (CENTRALINO SELEZIONE PASSANTE)'],"[u'VCBONAZZI\xa043', u'40013', u'CASTEL MAGGIORE']",[u'0516322411'],[u'info@tartariniauto. it'],[u'CARS (LPG INSTALLERS)'],[u'track.aspx?id=0&url=http://www.tartariniauto.it']

如您所见，有一些额外的字符，例如

> 你'\xa043“'[]

这是我不想要的。我怎样才能删除这些？此外，此字符串中有 5 个项目。我希望字符串看起来像这样：

> 项目 1 , 项目 2 , 项目 3 , 项目 4 , 项目 5

这是我的 pipelines.py 代码

```
from scrapy.contrib.loader import ItemLoader
from scrapy.contrib.loader.processor import TakeFirst, MapCompose, Join
import re
import json
import csv

class InfobelPipeline(object):
    def __init__(self):
      self.file = csv.writer(open('items.csv','wb'))
    def process_item(self, item, spider):
      name = item['name']
      address = item['address']
      phone = item['phone']
      email = item['email']
      category = item['category']
      website = item['website']
      self.file.writerow((name,address,phone,email,category,website))
    return item 
```

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T17:22:41.117

您看到的额外字符是 unicode 字符串。如果你在网上抓取，你会经常看到它们。常见示例包括版权符号：© unicode point`U+00A9`或商标符号™ unicode point `U+2122`。

删除它们的最快方法是尝试将它们编码为 ascii，然后如果它们不是 ascii 字符（它们都不是）则将它们丢弃

```
>>> example = u"Xerox ™ printer"
>>> example
u'Xerox \u2122 printer'
>>> example.encode('ascii')
Traceback (most recent call last):
 File "<stdin>", line 1, in <module>
UnicodeEncodeError: 'ascii' codec can't encode character u'\u2122' in position 6: ordinal 
not in range(128)
>>> example.encode('ascii', errors='ignore')
'Xerox  printer'
>>> 
```

如您所见，当您尝试将符号解码为 ascii 时，它会引发 a `UnicodeEncodeError`，因为该字符无法用 ascii 表示。但是，如果您添加`errors='ignore'`关键字参数，那么它将简单地忽略它无法编码的符号。

# android - 使用 AlarmManager 启动通知

> ID：10401418
> 
> 赞同：0
> 
> 时间：2012-05-01T17:11:21.520
> 
> 标签：android, alarmmanager

我希望能够每周通知用户执行一项任务。我知道我需要做什么，但不知道该怎么做。我需要以某种方式将注释掉的代码（最后一行）传递给 AlarmManager。

```
 Context context = getApplicationContext();
        CharSequence contentTitle = notiType+" reminder for "+projName;
        CharSequence contentText = "Take your photo now!";
        Intent notificationIntent = new Intent(getApplicationContext(), ProjectPreview.class);
        notificationIntent.putExtra("projname", "asdsad");
        PendingIntent contentIntent = PendingIntent.getActivity(this, 0, notificationIntent, 0);
        notification.setLatestEventInfo(context, contentTitle, contentText, contentIntent);
        am.set(AlarmManager.RTC_WAKEUP, calendar.getTimeInMillis(), contentIntent);

        //mNotificationManager.notify(1, notification); 
```

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T17:23:12.453

您可以告诉您的 AlarmManager 调用 BroadcastReceiver（通过使用 PendingIntent.getReceiver）。

在接收方的 onReceive() 方法中，使用 NotificationManager 设置通知。

# objective-c - 将 GKSession 对象的副本从一个视图传递到另一个视图

> ID：10401421
> 
> 赞同：2
> 
> 时间：2012-05-01T17:11:29.773
> 
> 标签：objective-c, object, memory-management

我想将 GKSession 对象从一个视图控制器传递到另一个。实际上我想传递对象的副本，但是当我阅读特定对象时，它是不可复制的。

所以像这样的声明会返回错误：

```
@property (nonatomic, copy) GKSession *currentSession; 
```

有没有其他方法可以做到这一点......？

提前致谢....

# google-maps - 移动后地图的 Google Maps API v3 坐标

> ID：10401422
> 
> 赞同：1
> 
> 时间：2012-05-01T17:11:34.560
> 
> 标签：google-maps

我是一个 VB.net 程序员。不熟悉jscript。

我正在构建一个网络应用程序，它将显示来自数据库的谷歌地图上的点。我保存每条记录的纬度和经度，并使用它们来加载地图上的点。

我有它的工作，但我无法弄清楚一旦用户移动地图如何更新点。有没有办法在用户移动或缩放后获取地图的左上纬度经度和右下纬度经度，以便我知道从我的数据库中加载哪条记录？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T19:14:29.023

是的，您想在触发or事件`map.getBounds()`时使用。我建议您查阅事件文档以获取有关事件的更多信息： [https ://developers.google.com/maps/documentation/javascript/events](https://developers.google.com/maps/documentation/javascript/events)`bounds_changed``idle`

# windows - x86 程序参数位置

> ID：10401423
> 
> 赞同：2
> 
> 时间：2012-05-01T17:11:35.583
> 
> 标签：windows, x86, command-line-arguments, x86-64, assembly

我正在编写一个在程序集中打印命令行参数的 Windows 应用程序。我有所有的处理代码。我需要知道的是程序参数在堆栈上的位置

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T17:18:04.180

命令行参数并没有真正在堆栈上传递。获取命令行指针的官方方法是调用KERNEL32函数GetCommandLine。

# python - 在 Python 解释器中重新加载

> ID：10401424
> 
> 赞同：10
> 
> 时间：2012-05-01T17:11:43.783
> 
> 标签：python, interpreter, reload

```
$ python
>>> import myapp
>>> reload(myapp)
<module 'myapp' from 'myapp.pyc'>
>>> 
```

`ctrl+D`

```
$ python
>>> from myapp import *
>>> reload(myapp)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'myapp' is not defined 
```

为什么这表现不同？使用时如何重新加载`from myapp import *`？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-01T17:21:18.640

从[http://docs.python.org/library/functions.html#reload](http://docs.python.org/library/functions.html#reload)：

> 如果一个模块使用 from ... import ... 从另一个模块导入对象，则为另一个模块调用 reload() 不会重新定义从它导入的对象 - 解决此问题的一种方法是重新执行 from 语句，另一种是改为使用导入和限定名称（module.name *）*。

因此，您应该执行以下操作：

```
from myapp import *
....
import myapp
reload(myapp)
from myapp import * 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-01T17:22:00.100

使用`from myapp import *`，您没有在变量名中引用您的模块，因此您不能使用变量名来引用模块。

当然，没有什么可以阻止您再次导入它以获取对您可以使用的名称的模块的引用。由于它已经导入过一次，因此实际上不会再次导入：

```
import myapp
reload(myapp) 
```

您也可以直接从`sys.modules`.

```
import sys
reload(sys.modules["myapp]") 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-01T17:16:29.840

> 使用时如何重新加载`from myapp import *`？

你不能。这就是为什么使用`from X import *`是一个坏主意的原因之一。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-01T17:30:16.083

为了澄清 Wooble 的评论，使用“from foo import *”将 foo 中的所有内容带入当前命名空间。这可能导致名称冲突（您无意中为已使用的名称分配了一个新值），并且还可能使您更难分辨某物的来源。虽然一些库经常以这种方式使用，但它通常会导致比其价值更多的问题。

此外，由于它已被带入当前命名空间，因此不能简单地重新加载。通常最好将其保存在单独的命名空间中（可能使用更短的便利别名，例如 m）。这允许您重新加载（这对测试很有用，但在测试之外很少是一个好主意）并有助于保持命名空间的纯净。

# php - 使用 PHP 到 MySQL 日期时间格式

> ID：10401428
> 
> 赞同：0
> 
> 时间：2012-05-01T17:12:06.330
> 
> 标签：php, mysql, datetime

我正在尝试转换`$dt = "Tue May 15 00:09:06 UTC+0100 2012"`为`datetime`MySQL 数据库服务器的字段，但输入的值总是落后 6 小时。

我的服务器在美国达拉斯，我在英国。

任何想法如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T17:22:47.993

利用

```
 date_default_timezone_set("America/New_York"); 
```

将“America/New_York”替换为伦敦的代码，以将您的服务器时区转移到正确的 GMT 时区。如果您寻找时区的东西，您可以在 php.net 上查找正确的代码。

只需将它放在您使用日期的每个页面的顶部，然后将 php DateTime 对象与 ->format('c') 函数一起使用。

如果您有权访问，您还可以在 php.ini 文件中设置时区信息。

-约旦

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T17:17:10.657

如果没有更多信息（例如某些代码），很难调试，但鉴于您提供的变量*，*此代码段可能会起作用：

```
<?php
$dt_for_db = gmdate("Y-m-d H:i:s", strtotime($dt)); 
```

然后，每次从数据库中提取数据时，请确保在*每个*日期后附加`GMT`（开头有一个空格） 。

 *```
<?php
$dt_from_db = $dt_from_db.' GMT'; 
```

基本上，MySQL`datetime`列中的日期*不*存储时区信息，因此您必须确保始终知道您使用的时区 (UTC/GMT)。然后，在使用任何函数之前，将该时区附加到您从数据库中提取的每个日期的末尾`date`（因为`date`函数假定未指定时区的日期为本地时间）。*

# c++ - 给定一个指向该元素的指针，获取双端队列中元素的索引？

> ID：10401432
> 
> 赞同：1
> 
> 时间：2012-05-01T17:12:21.837
> 
> 标签：c++, pointers, stl, iterator, deque

有没有办法从指向元素的指针中获取元素的索引？具体来说，我需要的是指向 I 点之前或之后的元素的索引（或迭代器）。我知道在使用向量时，您可以轻松地进行算术运算，但在双端队列中就不是那么容易了。

我必须使用双端队列。矢量不是一种选择。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T17:16:27.217

我相信答案是否定的。但是为什么不使用迭代器而不是指针呢？

# sql - SQL 查询，如何处理复杂的查询？

> ID：10401435
> 
> 赞同：1
> 
> 时间：2012-05-01T17:12:45.237
> 
> 标签：sql

我这个学期正在学习 DBMS 课程，我想确保我取得了良好的进步并练习了良好的思维，我自己处理查询的方法有点像分而治之 - 我将查询拆分为子查询并使其成为视图，然后一般来说，使用这些视图来简单地收集我需要的信息，这是一个好方法吗？

有什么替代方法？

你自己的方法是什么？如果您认为它比我的更好，为什么？

例子 ：

给定：数据库：[http ://sqlfiddle.com/#!2/cdd98/1](http://sqlfiddle.com/#!2/cdd98/1)

> (Q7) 查找访问过与其保险公司相关的所有骨科医师（专科）的患者。

.

```
CREATE VIEW Orthos AS
SELECT  d.cid,d.did
FROM Doctors d
WHERE d.speciality='Orthopedist';

CREATE VIEW OrthosPerInc AS
SELECT  o.cid, COUNT(o.did) as countd4i
FROM Orthos o
GROUP BY o.cid;

CREATE VIEW OrthoVisitsPerPat AS
SELECT v.pid,COUNT(o.did) as countv4d
FROM Orthos o,Visits v,Doctors d
WHERE o.did=v.did and d.did=o.did
GROUP BY v.pid,d.cid;

SELECT  p.pname,p.pid,p.cid
FROM  OrthoVisitsPerPat v, OrthosPerInc i,Patient p
WHERE i.countd4i = v.countv4d and p.pid=v.pid and p.cid=i.cid 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T17:15:02.943

这真的取决于数据库。一些数据库（例如 MySQL）在优化使用视图的查询方面很糟糕。其他人并没有那么糟糕。

但是您将查询分解为多个部分然后将它们组合成更复杂的查询的策略是一个很好的策略。我只会（通常）最终进行一个组合这些部分的大型查询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T18:57:15.360

不要为此使用视图，请使用派生表、临时表或 CTES。视图是数据库中的永久对象，过度使用它们是一个真正的问题，尤其是当您开始编写调用其他视图的视图时。我们几乎失去了一个价值数百万美元的客户，因为开发人员被错误地告知视图是一件好事，使系统变得如此缓慢，以至于在加载数据后无法使用。初学者永远不需要编写视图。

学习使用真正的连接——它会让你变得更好。

但是，是的，可以将复杂的事物分成块。只是不要通过使用视图来做到这一点。

隐含连接是一种非常糟糕的技术，它们已经过时了 20 年，没有理由在 2012 年使用它们。保证自己永远不会再使用它们。不要学不好的技术，要学习正确的技术。

我会做类似的事情（未经测试）：

```
SELECT  MDByPatient.pname,MDByPatient.pid,MDByPatient.cid
FROM 
    (
    SELECT   p.pname,p.pid,p.cid, count(v.did) as CountMDByPatient
    FROM  Patient p  
    INNER JOIN (SELECT DISTINCT v.pid, v.did FROM Visits) v
        ON p.pid = v.pid
    INNER JOIN Doctors d 
        ON d.did = v.did and p.cid = d.cid
    WHERE d.speciality='Orthopedist' 
    GROUP BY p.pname,p.pid,p.cid
    ) MDByPatient
INNER JOIN 
    (
    SELECT cid, count(did)as CountMDByIns
    FROM Doctors 
    WHERE d.speciality='Orthopedist' 
    GROUP BY cid
    ) MDByInsurance
        ON  MDByPatient.cid = MDByInsurance.cid
where MDByPatient.CountMDByPatient = MDByInsurance.CountMDByIns 
```

您会看到它仍然被分成几块，一个是通过保险公司获取骨科医师的数量，另一个是通过保险公司和访问者获取骨科医师的数量。我还做了一个“SELECT DISTINCT v.pid, v.did FROM Visits”，因为我不希望医生的数量不正确，因为我不止一次拜访了同一个人。

# bash - bash 中的语法错误

> ID：10401436
> 
> 赞同：2
> 
> 时间：2012-05-01T17:12:58.187
> 
> 标签：bash, unix

我想用 bash 编写脚本（我开始用 bash 编程），但我有错误，我尝试了一切，但我仍然不知道如何修复它。

```
#!/bin/bash
cap=0
cat|while read line
  do
  read a
    if[$a -gt $cap]
       then echo "MORE"
fi
done 
```

这是简单的脚本，但我是 bash 的新手，请有人帮助我；）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-01T17:16:48.627

语法错误在这里：

```
if[$a -gt $cap] 
```

您需要空格和引号（对于带有空格或空值的内容是安全的）：

```
if [ "$a" -gt "$cap" ] 
```

使用测试机制会更好一些`[[`，它是语法（而不是`[`命令），并且不需要双引号来保证安全：

```
if [[ $a -gt $cap ]] 
```

甚至比使用数学上下文更好，它允许您使用传统的数学运算符并自动取消引用变量：

```
if (( a > cap )) ; then ...
fi 
```

# php - symfony 2 - 一对一映射

> ID：10401442
> 
> 赞同：2
> 
> 时间：2012-05-01T17:13:43.410
> 
> 标签：php, symfony

当我想使用自动生成的表单添加新的 UserProfile 时，出现以下错误。错误是： **期望一个对象，但得到一个集合。您是否忘记将“multiple=true”传递给实体字段？**

我正在使用**Symfony 2.0.12**

这是我的 UserProfile 实体的代码。问题发生在控制器中，但我不确定如何解决。请帮忙。

```
<?php

namespace Infidia\OutsourceBundle\Entity;

use Doctrine\ORM\Mapping as ORM;
use Doctrine\Common\Collections\ArrayCollection;

/**
 * Infidia\OutsourceBundle\Entity\UserProfile
 *
 * @ORM\Table()
 * @ORM\Entity(repositoryClass="Infidia\OutsourceBundle\Entity\UserProfileRepository")
 */
class UserProfile
{
/**
 * @var integer $id
 *
 * @ORM\Column(name="id", type="integer")
 * @ORM\Id
 * @ORM\GeneratedValue(strategy="AUTO")
 */
private $id;

/**
 *
 * @ORM\OneToOne(targetEntity="User")
 * @orm:JoinColumn(name="userid", referencedColumnName="id")
 */
private $user;

/**
 * @var  integer $userid
 */
private $userid;

/**
 * @var text $street_address
 *
 * @ORM\Column(name="street_address", type="text")
 */
private $street_address;

/**
 * @var string $city
 *
 * @ORM\Column(name="city", type="string", length=255)
 */
private $city;

/**
 * @var string $country
 *
 * @ORM\Column(name="country", type="string", length=255)
 */
private $country;

/**
 * @var string $zipcode
 *
 * @ORM\Column(name="zipcode", type="string", length=255)
 */
private $zipcode;

/**
 * @var string $timezone
 *
 * @ORM\Column(name="timezone", type="string", length=12)
 */
private $timezone;

/**
 * @var string $contact_no
 *
 * @ORM\Column(name="contact_no", type="string", length=20)
 */
private $contact_no;

/**
 * @var date $birthday
 *
 * @ORM\Column(name="birthday", type="date")
 */
private $birthday;

/**
 * @var string $gender
 *
 * @ORM\Column(name="gender", type="string", length=15)
 */
private $gender;

/**
 * Get id
 *
 * @return integer 
 */
public function getId()
{
    return $this->id;
}

/**
 * Set street_address
 *
 * @param text $streetAddress
 */
public function setStreetAddress($streetAddress)
{
    $this->street_address = $streetAddress;
}

/**
 * Get street_address
 *
 * @return text 
 */
public function getStreetAddress()
{
    return $this->street_address;
}

/**
 * Set city
 *
 * @param string $city
 */
public function setCity($city)
{
    $this->city = $city;
}

/**
 * Get city
 *
 * @return string 
 */
public function getCity()
{
    return $this->city;
}

/**
 * Set country
 *
 * @param string $country
 */
public function setCountry($country)
{
    $this->country = $country;
}

/**
 * Get country
 *
 * @return string 
 */
public function getCountry()
{
    return $this->country;
}

/**
 * Set zipcode
 *
 * @param string $zipcode
 */
public function setZipcode($zipcode)
{
    $this->zipcode = $zipcode;
}

/**
 * Get zipcode
 *
 * @return string 
 */
public function getZipcode()
{
    return $this->zipcode;
}

/**
 * Set timezone
 *
 * @param string $timezone
 */
public function setTimezone($timezone)
{
    $this->timezone = $timezone;
}

/**
 * Get timezone
 *
 * @return string 
 */
public function getTimezone()
{
    return $this->timezone;
}

/**
 * Set contact_no
 *
 * @param string $contactNo
 */
public function setContactNo($contactNo)
{
    $this->contact_no = $contactNo;
}

/**
 * Get contact_no
 *
 * @return string 
 */
public function getContactNo()
{
    return $this->contact_no;
}

/**
 * Set birthday
 *
 * @param date $birthday
 */
public function setBirthday($birthday)
{
    $this->birthday = $birthday;
}

/**
 * Get birthday
 *
 * @return date 
 */
public function getBirthday()
{
    return $this->birthday;
}

/**
 * Set gender
 *
 * @param string $gender
 */
public function setGender($gender)
{
    $this->gender = $gender;
}

/**
 * Get gender
 *
 * @return string 
 */
public function getGender()
{
    return $this->gender;
}

/**
 * Set experience
 *
 * @param \Infidia\OutsourceBundle\Entity\text $experience
 */
public function setExperience($experience)
{
    $this->experience = $experience;
}

/**
 * Get Experience
 *
 * @return \Infidia\OutsourceBundle\Entity\text
 */
public function getExperience()
{
    return $this->experience;
}

/**
 * Set UserId
 *
 * @param int $userid
 */
public function setUserid($userid)
{
    $this->userid = $userid;
}

/**
 * Get UserId
 * @return int
 */
public function getUserid()
{
    return $this->userid;
}

public function __construct()
{
    $this->user = new ArrayCollection();
}

/**
 * Set user
 *
 * @param Infidia\OutsourceBundle\Entity\User $user
 */
public function setUser(\Infidia\OutsourceBundle\Entity\User $user)
{
    $this->user = $user;
}

/**
 * Get user
 *
 * @return Infidia\OutsourceBundle\Entity\User 
 */
public function getUser()
{
    return $this->user;
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T04:19:24.810

问题出在您的表格中...试试这个。

```
 public function buildForm(FormBuilder $builder, array $options) {

        $builder
->add('employeeType', 'entity', array(
                    'class' => 'MyProject\EntityBundle\Entity\Employee',
                    'property' => 'name',
                      'multiple'=>'true','query_builder' => function ($repository) { return $repository->createQueryBuilder('es')->orderBy('es.name', 'ASC'); },

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T18:31:14.893

当在另一个表单中嵌入表单时，您需要通过在 UserType::getDefaultOptions() 中设置 data_class 选项来声明嵌入表单映射到的对象类型。

有关示例，请参见[http://symfony.com/doc/current/book/forms.html#embedding-a-single-object 。](http://symfony.com/doc/current/book/forms.html#embedding-a-single-object)

# assembly - 中断表修改

> ID：10401445
> 
> 赞同：0
> 
> 时间：2012-05-01T17:13:48.077
> 
> 标签：assembly, operating-system, x86, interrupt

我正在编写自己的操作系统，需要知道如何修改中断表，以便将某些（打印字符串等）重定向到命令提示符应用程序，类似于 DOS 的做法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T17:25:38.293

对于它的价值，我只是在 DOS 中完成了这件事，现在感觉就像是另一种生活，但是 - 如果我没记错的话 - 我们所做的只是禁用中断，在中断表中写入一个指向所需条目的新指针（从地址 0:0)，然后重新启用中断。

# ios - 什么应该处理 UIView 中 UIViewController 的拖放？

> ID：10401447
> 
> 赞同：1
> 
> 时间：2012-05-01T17:13:56.790
> 
> 标签：ios, xcode, ios5

我有一个 UIView 作为小部件的容器（UIViewController 子类）。我能够将简单的 UIButtons 添加到 UIView 容器并让拖放功能正常工作，但是当我尝试从添加到 UIView 容器的 Widget 拖放 UIButton 时遇到了问题。当我尝试与按钮交互时，除了默认的触摸行为之外什么都没有发生。

在这种情况下我是否应该使用委托，告诉我的小部件按钮 UIView 容器将是处理拖放的容器？

我正在容器的 ViewController 中添加小部件，其中包含以下内容：

```
 // Widget is a UIViewController subclass, WidgetTestViewController is a Widget subclass
    Widget *testWidget = [[WidgetTestViewController alloc] initWithNibName:@"WidgetTest" bundle:nil];

    [testWidget.widgetButton addTarget:self action:@selector(widgetDrag:forEvent:) forControlEvents:UIControlEventTouchDragInside];

    [containerView addSubview:testWidget.view];
    testWidget.view.frame = frame; 
```

我正在通过这个函数处理容器的 ViewController 中的拖动：

```
- (IBAction)widgetDrag:(id)sender forEvent:(UIEvent *)event {
    CGPoint point = [[[event allTouches] anyObject] locationInView:containerView];
    UIControl *control = sender;
    control.center = point;
} 
```

# visual-studio - Sharepoint 设计器与 Visual Studio 2010

> ID：10401448
> 
> 赞同：6
> 
> 时间：2012-05-01T17:13:56.907
> 
> 标签：visual-studio, sharepoint, sharepoint-2010

对于 sharepoint 开发（我是新手） - 任何人都可以建议我是否应该使用 Sharepoint Designer 2010 for developer 还是应该使用 Visual Studio 2010。

Sharepoint Designer 使用 Sharepoint 许可证是免费的，而 Visual Studio 需要付费。

谁能帮忙。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T12:43:22.687

这完全取决于您计划如何使用 SharePoint。SharePoint Designer 和 Visual Studio 都是工具。它们有一些重叠，但您会希望为正确的目的使用正确的工具。

Visual Studio 用于创建应用程序。如果您打算将 SharePoint 用作自定义 Web 应用程序的平台，那么您应该使用 Visual Studio。在 Visual Studio 中开发的 SharePoint 解决方案包可跨网站、网站集、Web 应用程序、环境甚至组织重复使用。对于应用程序，SharePoint Designer 可用作开发环境中的原型制作工具，但不应在生产环境中使用。

Visual Studio 为您提供最大的灵活性和可用选项。请注意，这可能是好是坏。SharePoint 对象模型将为您提供足够的绳索让您上吊。如果您不小心，您的代码可能会表现不佳并消耗内存。

与任何其他 Web 应用程序一样，在 Visual Studio 中为 SharePoint 开发应用程序允许您在您选择的源代码控制存储库中维护您的代码。

但是，开发自定义 Web 应用程序远非 SharePoint 的唯一用途。许多 SharePoint 场包含常规、现成的团队网站、会议工作空间或用于协作和内容管理的发布网站。这些站点不需要是可移植的或可重复使用的。没有开发或登台环境——只有生产环境。在某些情况下，站点定制甚至站点创建都是由最终用户完成的，而不是由开发人员完成的。对于这些网站，SharePoint Designer 是比 Visual Studio 更好的工具，但使用 SharePoint Designer 无法实现所需功能的情况除外。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T21:12:54.280

SharePoint Designer 允许您直接对网站集进行编辑。它对于处理那些您不会投入 SharePoint 解决方案（由网站集管理员部署...）的事情很有用

为了将 SharePoint 解决方案与 Web 部件组合在一起，您将需要使用 Visual Studio。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T20:11:28.893

有一个免费版本的 Visual Studio，尽管它可能只对学生可用。SharePoint Designer 让您可以非常轻松地做事，但您没有在 Visual Studio 中那么大的自由度。

如果您只是想在 SharePoint 中做一些基本的事情并且您没有太多的编程经验，那么我会坚持使用 Designer。如果您尝试创建更复杂的解决方案，我建议您使用 Visual Studio。

# javascript - 为单页应用程序从 .live() 升级到 .on()

> ID：10401453
> 
> 赞同：5
> 
> 时间：2012-05-01T17:14:09.347
> 
> 标签：javascript, jquery, events, upgrade, singlepage

众所周知，从 jQuery 1.7 开始：

```
$('someSelector').live('click', fn()); 
```

基本上变成了：

```
$(document).on('click', 'someSelector', fn()); 
```

所有实时事件不直接绑定到选择器中的元素，而是委托绑定到文档。

我认为这是因为`'someSelector'`将来匹配的元素不存在于 DOM 中，因此不能绑定事件处理程序（通过直接或委托绑定）。

对于绝大多数元素（如果不是所有元素都是动态加载的）的单页应用程序，是否有关于如何最好地处理将所有内容绑定到文档的性能问题的指南？

例如，在通过加载新内容时注册/重新注册事件处理程序的最佳方式`ajax()`以及如何更新以惰性`.live()`思维方式编写的代码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T17:36:57.100

我不确定是否有“已发布的指南”。

我认为这种方法有其优点：

*   查找不会从文档中删除的最接近的逻辑共同祖先。

    *示例：*对于可拖动的表行行为，这将是父表（或 tbody）。

*   在那里绑定事件。这使您可以让同一事物的不同实例表现出不同的行为，而无需进行上下文检查。

    *示例：*如果在您的一个表上临时禁用行拖动，则处理该事件的表自然会知道。`document`不会 。

*   它将处理的事件数量保持`document`在最低限度，因此当事件发生时不会有很多“这真的有必要”检查。

    *示例：*如果当前没有具有可拖动行的表，则甚至不需要在该`document`级别触发事件处理程序（只是为了找出这`table.draggable tr`不是事件的真正来源并立即将其关闭）。

*   如果共同祖先经常被删除，您可以决定是在创建事件处理程序时重新绑定它还是将它们绑定到层次结构中的几个级别会更好。

我会在创建容器时重新绑定容器事件，但我认为这是个人喜好。毕竟，重新绑定很容易：

```
// once, beforehand
var draggableTableRowBehavior = {
  dragstart: function () { /* ... */ },
  dragstop: function () { /* ... */ }
  /* ... */
};

//in Ajax success:
$table.on(draggableTableRowBehavior, 'tr'); 
```

# javascript - Chrome 阻止了 JavaScript 打印，解决方法？

> ID：10401454
> 
> 赞同：21
> 
> 时间：2012-05-01T17:14:10.540
> 
> 标签：javascript, google-chrome, printing

我知道它之前已经在这里讨论过，但是我没有找到实用的解决方案/解决方法，我希望有人知道如何解决这个问题！

这是它：

如果您尝试`window.print()`在谷歌浏览器的单个页面中频繁调用方法（就像用户单击打印按钮），浏览器会在控制台中抛出警告消息，说明：

> 忽略对 print() 的过于频繁的调用

什么也没有发生！几秒钟后，一切恢复正常，并在您`window.print()`再次调用命令时出现打印对话框！更糟糕的是，优秀的 Chrome 开发人员对调用打印命令的页面使用指数等待时间，这意味着用户点击按钮打印的次数越多，他等待打印对话框出现的时间就越长！

这个问题已经在 chrome 中存在了很长一段时间（14 个后续版本），**并且被确认**是一个`Area-UI`错误，我昨天[再次为谷歌团队发布了它，](http://code.google.com/p/chromium/issues/detail?id=50186)希望 Chrome 团队的人可以验证这个令人难以置信的烦人功能何时会得到修复！

但是，我在这里寻找的是解决此问题的方法，我能做些什么来使它正常工作吗**？**我的公司正在开发一个高度交易的财务系统，其中包含许多需要打印的报告，而仅仅因为这个小故障，整个项目就有可能在我最喜欢的谷歌 Chrome 浏览器中运行！

更新：

[这是导致此功能的 Chrome 浏览器中的代码，](http://git.chromium.org/gitweb/?p=chromium.git;a=commitdiff_plain;h=8a86b38e5c593998369f4c3a789489e3fd9e8354)看起来至少需要 2 秒才能有人再次调用打印命令，因此 UI 中 2 秒间隔的计时器可能会阻止进入无限等待回调！还有其他想法吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-04T17:54:12.423

您可以有条件地替换该`window.print()`功能：

```
// detect if browser is Chrome
if(navigator.userAgent.toLowerCase().indexOf("chrome") >  -1) {
    // wrap private vars in a closure
    (function() {
        var realPrintFunc = window.print;
        var interval = 2500; // 2.5 secs
        var nextAvailableTime = +new Date(); // when we can safely print again

        // overwrite window.print function
        window.print = function() {
            var now = +new Date();
            // if the next available time is in the past, print now
            if(now > nextAvailableTime) {
                realPrintFunc();
                nextAvailableTime = now + interval;
            } else {
                // print when next available
                setTimeout(realPrintFunc, nextAvailableTime - now);
                nextAvailableTime += interval;
            }
        }
    })();
} 
```

您可以使用内部安全计时器/包装器，而不是使用外部安全计时器/包装器。只需添加它并`window.print`在 Chrome 和其他任何地方正常运行即可。（另外，闭包意味着`realPrintFunc`,`interval`并且`nextAvailableTime`是新的私有的`window.print`

如果您需要协调`window.print`多个框架页面之间的调用，您可以`nextAvailableTime`在父页面中设置，而不是在闭包中，以便所有框架都可以使用`window.parent.nextAvailableTime`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-14T00:15:58.810

我一直遇到同样的问题，对我来说最直接的解决方案就是创建一个新窗口，写下我需要的内容，关闭它，然后打印它。我不必处理 Chrome 的限制，因为我将其更改为以这种方式工作，并且我不需要进行任何跟踪。

```
print_window= window.open();
print_window.document.write(print_css + divToPrint[0].outerHTML+"</html>");
print_window.document.close();
print_window.focus();
print_window.print();
print_window.close(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-04T12:42:38.513

`window.print()`我的解决方案是不那么频繁地打电话。您可以尝试包装`window.print()`到您自己的方法中，并在再次执行之前放置一个必须经过的最小时间间隔`window.print()`。您可以在 UI 中进行某种更改/动画，以表明工作正在完成。

“在职的”

除非您认为它真的认为每秒/每隔几秒按一次以上打印按钮会有所帮助？我的意思是，如果`window.print()`操作需要那么长时间，那不是您的代码错误，无论如何，UI 中都应该有一个“等待并耐心等待”的指示器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-04T16:42:07.093

如果您的所有打印机都与网络兼容，您可以更改单击打印按钮时发生的情况。除了打印页面，您的应用程序可以向服务器发送一个请求，其中包含要打印的页面的 URL 以及要打印的打印机的信息。

然后服务器手动启动打印过程，中间不会有浏览器，这可能会阻止您这样做。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-15T20:43:25.947

我看到提到这个问题的所有地方都建议使用计时器。但是他们没有解决问题，我觉得 Kamyar 是唯一真正阅读源代码并理解问题的人，所以我想知道他为什么接受他所做的答案。

主要问题是 Chrome 中的延迟时间是指数级的，因此为了让这些计时器工作，它们的延迟也必须在每次使用时增加，这当然会很快变得非常烦人。Chrome 实际上只在取消打印请求后应用延迟，但我们无法检测打印是否成功。

Abathur 的解决方案实际上比您预期的要好得多。我不确定我是否会使用它，但它确实有效。

好消息：

1) 在更新的 Chrome 版本中，延迟实际上减少了。它现在去：`[2, 2, 2, 4, 8, 16, 32, 32, ...]`。

2) 8 月 28 日有人处理了这个问题：[http](http://code.google.com/p/chromium/issues/detail?id=50186) ://code.google.com/p/chromium/issues/detail?id=50186如果你想解决这个问题，请给它加星标。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-15T14:15:24.433

没有更多的变通办法！如果我没记错的话，作为 v.23 的一部分修复[的错误。](http://code.google.com/p/chromium/issues/detail?id=50186)

因此，如果发布周期是每 6 周，并且 Chrome 22 于 9 月 25 日发布，那么**到 11 月 6 日**（大约）修复将在 Chrome 稳定版中

# c# - ProtoBuf-Net 和 Compact Framework 出现“源数据中的无效字段：0”错误

> ID：10401464
> 
> 赞同：11
> 
> 时间：2012-05-01T17:15:02.387
> 
> 标签：c#, serialization, compact-framework, deserialization, protobuf-net

在使用 ProtoBuf-Net 在紧凑框架和完整的 .Net 框架之间进行序列化/反序列化时，有人知道任何问题吗？我有一个名为 LogData 的类，我在紧凑框架 3.5 下对其进行序列化，传输到服务器（运行 .Net 框架 4.0），然后进行反序列化。有时它有效，有时它会引发上述错误，我尚未将其缩小到任何特定原因。我已经用不同的值进行了许多测试，似乎找不到任何错误发生的押韵或原因。我在下面包括我的类（减去各种构造函数）。我曾多次查看任一侧的字节缓冲区，但尚未发现通过线路从一侧发送到另一侧的数据存在差异。

```
[ProtoContract]
public class LogData
{

  [ProtoContract]
  public enum LogSeverity
  {
     [ProtoEnum(Name = "Information", Value = 0)]
     Information,
     [ProtoEnum(Name = "Warning", Value = 1)]
     Warning,
     [ProtoEnum(Name = "Error", Value = 2)]
     Error,
     [ProtoEnum(Name = "Critical", Value = 3)]
     Critical
  }

  [ProtoMember(1)]
  public string UserID { get; set; }
  [ProtoMember(2)]
  public string ComputerName { get; set; }
  [ProtoMember(3)]
  public ExceptionProxy Exception { get; set; }
  [ProtoMember(4)]
  public LogData.LogSeverity Severity { get; set; }
  [ProtoMember(5)]
  public string Source { get; set; }
  [ProtoMember(6)]
  public string Caption { get; set; }
  [ProtoMember(7)]
  public string Description { get; set; }
  [ProtoMember(8)]
  public DateTime TimeOfOccurrence { get; set; }
  [ProtoMember(9)]
  public Guid SessionID { get; set; }
  [ProtoMember(10)]
  public string MethodName { get; set; }
  [ProtoMember(11)]
  public string OSVersion { get; set; }
  [ProtoMember(12)]
  public string Category { get; set; }
  [ProtoMember(13)]
  public string Location { get; set; }
}

[ProtoContract]
public class ExceptionProxy
{

  [ProtoMember(1)]
  public Type ExceptionType { get; set; }
  [ProtoMember(2)]
  public string Message { get; set; }
  [ProtoMember(3)]
  public string StackTrace { get; set; }
  [ProtoMember(4)]
  public ExceptionProxy InnerException { get; set; }

} 
```

这是我进行序列化和发送的代码

```
 private void WriteLogDataToServer(LogData data)
  {
     using (var client = new TcpClient())
     {
        client.Connect(Host, SignalLineServerPort);
        using (var stream = client.GetStream())
        {
           using (var ms = new MemoryStream())
           {
              Serializer.Serialize<LogData>(ms, data);
              var buffer = ms.GetBuffer();
              int position = 0;
              WriteFrameMarkers(stream);
              byte[] frameLengthBuffer = BitConverter.GetBytes(buffer.Length);
              stream.Write(frameLengthBuffer, 0, IntByteSize);
              while (position < buffer.Length)
              {
                 int length = Math.Min(ChunkSize, buffer.Length - position);
                 stream.Write(buffer, position, length);
                 position += ChunkSize;
              }
           }
        }
        client.Close();
     }         
  } 
```

这是读取服务器上数据的代码

```
 public override LogData ReadData(NetworkStream stream)
  {
     if (stream.DataAvailable)
     {
        try
        {
           const int chunkSize = 250;
           byte[] buffer = new byte[IntByteSize];
           int messageSize = 0;
           int totalBytesRead = 0;
           LogData data;
           using (var ms = new MemoryStream())
           {
              if (!ReadFrameMarkers(stream))
                 return null;
              totalBytesRead = stream.Read(buffer, 0, IntByteSize);
              if (totalBytesRead != IntByteSize)
                 return null;
              messageSize = BitConverter.ToInt32(buffer, 0);
              totalBytesRead = 0;
              while ((totalBytesRead < messageSize))
              {
                 int bufferSize = Math.Min(chunkSize, messageSize - totalBytesRead);
                 buffer = new byte[bufferSize];
                 int bytesRead = stream.Read(buffer, 0, bufferSize);
                 if (bytesRead != 0)
                 {
                    totalBytesRead += bytesRead;
                    ms.Write(buffer, 0, bytesRead);
                 }
              }
              ms.Seek(0, SeekOrigin.Begin);
              data = Serializer.Deserialize<LogData>(ms);
           }
           return data;
        }
        catch (Exception ex)
        {
           Console.WriteLine(string.Format("Error occurred: {0}", ex.Message));
           return null;
        }
     }
     return null;
  } 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-01T18:23:53.497

简单的一个：你使用：

```
var buffer = ms.GetBuffer(); 
```

然后`buffer.Length`。这意味着您正在使用超大的填充缓冲区。如果你这样做，你需要使用`ms.Length`，它会告诉你**实际**长度。或者，`ms.ToArray()`可以使用，但这涉及额外的副本。

我的建议：继续使用 GetBuffer()，但只写 ms.Length 字节，而不是 buffer.Length 字节。

一旦你删除了这些额外的不正确的零，我希望你会发现它有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-03T13:41:09.180

我意识到主要开发人员@MarcGravell 已经回答了，但我只想分享我自己的 0.02 美元，这对我解决了这个问题。如果我有一个固定大小的 byte[] 并获得读取的字节数作为回报，我可以在 MemoryStream 声明中指定它并解决问题。此外，因为它适用于 OP，所以在完成阅读之前不要声明 MemoryStream。

```
byte[] msg = new byte[4096];
int bytesRead = someStreamClass.Read(msg, 0, 4096);
using (MemoryStream ms = new MemoryStream(msg, 0, bytesRead))
{    
    logData = Serializer.Deserialize<LogData>(ms);
} 
```

@MarcGravell：感谢这个伟大的图书馆！

# sas - sas日期格式

> ID：10401471
> 
> 赞同：2
> 
> 时间：2012-05-01T17:15:19.253
> 
> 标签：sas

我正在尝试编写一个 SAS 脚本，该脚本将简单地读取 SAS .sas7bdat 数据文件并以文本格式输出。我希望日期以 YYYYMMDD 格式输出。我不知道日期列的名称是什么。我的脚本目前是：

```
libname tmplib '~/testdatadir/';
OPTIONS MISSING='00'x;
data tmpdata;
set tmplib.testdatafile;
array flds{*} _NUMERIC_;
do i=1 to dim(flds);
  if missing(flds(i)) then flds(i)=.;
end;
array charflds{*} _CHARACTER_;
do i=1 to dim(charflds);
  if missing(charflds(i)) then charflds(i)=' ';
end;
drop i;
RUN;

PROC EXPORT
  DATA = tmpdata
  OUTFILE = 'testdataoutfile.txt'
  DBMS = TAB REPLACE;
  PUTNAME = YES;
RUN; 
```

我想遍历所有日期字段（就像我对*NUMERIC*字段和*CHARACTER字段所做的那样），或者为每个**NUMERIC*字段添加检查以测试它是否是日期（然后我可以更改格式），或者添加一个选项PROC EXPORT 表示输出日期格式。使输出文件的日期格式为 YYYYMMDD 的任何其他方法也是可以接受的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T17:26:15.800

您可以使用该[`varfmt`](http://support.sas.com/documentation/cdl/en/lrdict/64316/HTML/default/viewer.htm#a000148399.htm)函数查找数值变量的格式，这可以帮助您确定它是否为日期，即其格式是否为日期格式。从技术上讲，您可能有一个日期格式不正确的日期，所以它只是显示为 16239 或其他东西，但这些很难检测到，因为它也可能只是数字 16,239。此方法将查找在数据浏览器中显示为日期的任何内容。

然后使用`put`和的某种组合`input`将其转换为 YYYYMMDD 格式。

仅使用的一个问题`put`是，我认为默认情况下它将返回一个字符变量，因此您要么需要创建一个新的字符变量来保存日期，要么将 YYYYMMDD 转换回 8 位数字，所以数字20120501 而不是字符串`20120501`。

例如[2](http://support.sas.com/documentation/cdl/en/lrdict/64316/HTML/default/viewer.htm#a000148399.htm)，您应该注意`varfmt`返回给定数据集名称和变量编号的变量格式。在示例中，他们设置了一个单独`vars`的表，其目的是遍历所有变量。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-15T12:32:37.193

我建议改为更改变量格式。在不改变变量格式的情况下，使用 put/input 可能会导致不正确的结果。例如，如果您使用 put/input 将日期更改为年份，但将变量格式保留为 date9，则日期仍将被读取为 date9（基础值将是年份）。如果您导出为 CSV，日期将不正确。

这是一个简单的宏，它将检查所有变量并隔离日期以将其格式修改为年份。您需要指定哪些日期格式可以在您的数据集中（或创建一个比宏中的更详尽的列表），并对其进行修改以生成您需要的数据格式。

```
%macro _toyear(dsin=,dsout=);
/* proc contents will list all variables in the dataset, with formats */
proc contents data=&dsin out=_contents noprint; 
    run;
data _contents; 
    set _contents (where=(format in: ("DATE", "MMDDYY", "MMYY"))); 
    run;

/* use proc sql to create a macro variable with a list of the date variables */
proc sql noprint;
    selet name into: datevars separated by " " from _contents;
    quit;

/* simple error checking, in case there are no date variables */
%let dsid = %sysfunc(open(_contents, is));
%let nlobs = %sysfunc(attrn(&dsid, nlobs));

/* output dataset */
data &dsout;
    set &dsin;
    %if &nlobs ne 0 %then %do; format &datevars year4.; %end;
    run;

/* clean-up */
%let rc = %sysfunc(close(&dsid));
proc datasets nolist; delete _contents;
    run;
%mend _toyear; 
```

# .net - 在 Visual Studio Express 2010 版中提取接口是否有简单的方法？

> ID：10401475
> 
> 赞同：2
> 
> 时间：2012-05-01T17:15:31.077
> 
> 标签：.net, visual-studio-express, automated-refactoring

我有一个大类，我想从中提取接口。

我只在 Refactor Option 下找到了“Extract Method”，所以我想知道是否有任何可用的免费工具可以做到这一点，所以我不必手动创建界面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T06:12:43.430

我正在为有同样问题的其他用户回答我自己的问题。

浏览网页后，我发现了[SharpDevelop](http://sharpdevelop.codeplex.com/)，它是 .NET 的开源 IDE，它具有 Visual Studio Express 中缺少的一些功能。

其中一项功能也是提取接口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-22T17:34:20.287

我是通过 Resharper 完成的，但它可以通过类设计器在 VS 中本地完成。从[这里](http://msdn.microsoft.com/en-us/library/ek50xay4%28v=vs.100%29.aspx)：

> 将成员提取到新界面
> 
> 在类设计器中，右键单击包含要提取的一个或多个成员的类型，指向重构，然后单击提取接口。
> 
> “提取接口”对话框显示接口名称的默认值以及将在其中声明它的代码文件的名称。接受默认值或更改它们。
> 
> 在 Select public members to form interface 窗格中，选中或清除要提取到新接口中的成员旁边的复选框，然后单击 OK。
> 
> 创建了一个新界面，并将包含它的文件添加到项目中。

# visual-studio-2010 - Visual Studio 2010 项目中的外部库

> ID：10401476
> 
> 赞同：0
> 
> 时间：2012-05-01T17:15:36.030
> 
> 标签：visual-studio-2010, dll, projects-and-solutions

我有一个关于 Visual Studio 2010 中适当的库管理的问题。
问题是我有几个项目的解决方案（“A”、“B”、“C”、“D”）。其中一个项目是“库”项目（“A”），我已经在其中放置了一些类，这些类在同一解决方案中的其他项目中对我很有用。
现在，我意识到我需要使用 Internet 上的另一个第三方库（“E”），它以 .dll 文件的形式分发。
我的问题是：如何在需要这个外部库的 VS 2010 中设置项目，使这些 dll 留在我的“库”项目“A”中，但可以在其他项目“B”中使用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T17:26:41.917

如果您想跨多个项目共享第三方依赖项，只需将第三方 DLL`E.dll`放在一个公共文件夹中，`A`并`B`通过项目-->添加引用（都指向同一个 /folder/e.dll）引用此程序集。

# javascript - Hello World phonegap 应用程序崩溃

> ID：10401478
> 
> 赞同：0
> 
> 时间：2012-05-01T17:15:48.567
> 
> 标签：javascript, html, css, cordova

好吧，我试图让演示在他们的网站上运行，但是当我尝试安装它并在我的手机上运行时，我在 Eclipse 中得到了这个异常：

`05-01 13:10:49.637: E/AndroidRuntime(19669): java.lang.SecurityException: ConnectivityService: Neither user 10128 nor current process has android.permission.ACCESS_NETWORK_STATE.`

我想可能是因为它在 WiFi 上，但在我禁用它之后它仍然存在。有谁知道是什么原因造成的？我实际上是在做最低限度的工作。这是我的 HTML：

```
<!DOCTYPE HTML>
<html>
<head>
   <title>PhoneGap</title>
   <script type="text/javascript" charset="utf-8" src="cordova-1.7.0rc1.js"></script>
</head>
<body>
   <h1>Hello World</h1>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T17:20:13.273

我想通了，就像我发布这篇文章后的 3 秒一样。

基本上，您必须在 androidmanifest.xml 文件中添加一行到权限。在eclipse中，你只需要添加这个：

`android.permission.ACCESS_NETWORK_STATE`

这就是诀窍！

* * *

由于显然这不清楚，这是为了 ECLIPSE。Eclipse 有一个不错的编辑器，它允许您通过下拉菜单添加属性。您仍然可以进入并手动将条目添加到清单文件中。不过，这要简单得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T17:23:17.947

该错误意味着您没有正确完成他们指南中的步骤之一。正在设置您的 AndroidManifest.xml 文件以正确反映 phonegap 所需的权限/它将在每个 android 设备上使用的活动。

尝试重新阅读它的内容：http: [//phonegap.com/start#android](http://phonegap.com/start#android)

**特别是在步骤 #3 下，当说明说：** 右键单击 AndroidManifest.xml 并选择打开方式 > 文本编辑器 在 versionName 下粘贴以下权限：（查看下图）

并确保您在 Eclipse hello world 项目中的 AndroidManifext.xml 包含所有内容，完全按照它告诉您粘贴它。

# python - MongoKit“ImportError：没有名为 objectid 的模块”错误

> ID：10401499
> 
> 赞同：7
> 
> 时间：2012-05-01T17:17:32.317
> 
> 标签：python, python-2.7, flask, pymongo, mongokit

使用 MongoKit 时出现一些非常奇怪的错误：

```
>>> from mongokit import *
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/local/lib/python2.7/dist-packages/mongokit/__init__.py", line 35, in <module>
    from document import Document, ObjectId
  File "/usr/local/lib/python2.7/dist-packages/mongokit/document.py", line 48, in <module>
    from pymongo.objectid import ObjectId
ImportError: No module named objectid 
```

我尽一切努力寻找原因，但没有任何帮助。实际上我用谷歌搜索了“ImportError：没有名为 objectid 的模块”错误，它根本没有结果。我尝试按照简单的教程[http://namlook.github.com/mongokit/introduction.html#a-quick-example](http://namlook.github.com/mongokit/introduction.html#a-quick-example)使用 MongoKit，教程的第一行产生了这个奇怪的错误。下面是 MongoKit 安装的日志。

我做错了什么？

```
user@server:~$ sudo pip install mongokit
Downloading/unpacking mongokit
  Downloading mongokit-0.7.2.tar.gz (69Kb): 69Kb downloaded
  Running setup.py egg_info for package mongokit

Downloading/unpacking pymongo>=2.0.1 (from mongokit)
  Downloading pymongo-2.2.tar.gz (228Kb): 228Kb downloaded
  Running setup.py egg_info for package pymongo

Downloading/unpacking anyjson>=0.2.2 (from mongokit)
  Downloading anyjson-0.3.1.tar.gz
  Running setup.py egg_info for package anyjson

Installing collected packages: mongokit, pymongo, anyjson
  Running setup.py install for mongokit

  Running setup.py install for pymongo
    building 'bson._cbson' extension
    gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -Ibson -I/usr/include/python2.7 -c bson/_cbsonmodule.c -o build/temp.linux-i686-2.7/bson/_cbsonmodule.o
    gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -Ibson -I/usr/include/python2.7 -c bson/time64.c -o build/temp.linux-i686-2.7/bson/time64.o
    gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -Ibson -I/usr/include/python2.7 -c bson/buffer.c -o build/temp.linux-i686-2.7/bson/buffer.o
    gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -Ibson -I/usr/include/python2.7 -c bson/encoding_helpers.c -o build/temp.linux-i686-2.7/bson/encoding_helpers.o
    gcc -pthread -shared -Wl,-O1 -Wl,-Bsymbolic-functions -Wl,-Bsymbolic-functions -Wl,-z,relro build/temp.linux-i686-2.7/bson/_cbsonmodule.o build/temp.linux-i686-2.7/bson/time64.o build/temp.linux-i686-2.7/bson/buffer.o build/temp.linux-i686-2.7/bson/encoding_helpers.o -o build/lib.linux-i686-2.7/bson/_cbson.so
    building 'pymongo._cmessage' extension
    gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -Ibson -I/usr/include/python2.7 -c pymongo/_cmessagemodule.c -o build/temp.linux-i686-2.7/pymongo/_cmessagemodule.o
    gcc -pthread -fno-strict-aliasing -DNDEBUG -g -fwrapv -O2 -Wall -Wstrict-prototypes -fPIC -Ibson -I/usr/include/python2.7 -c bson/buffer.c -o build/temp.linux-i686-2.7/bson/buffer.o
    gcc -pthread -shared -Wl,-O1 -Wl,-Bsymbolic-functions -Wl,-Bsymbolic-functions -Wl,-z,relro build/temp.linux-i686-2.7/pymongo/_cmessagemodule.o build/temp.linux-i686-2.7/bson/buffer.o -o build/lib.linux-i686-2.7/pymongo/_cmessage.so

  Running setup.py install for anyjson

Successfully installed mongokit pymongo anyjson
Cleaning up... 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-01T17:22:51.040

这是依赖项中的错误。从[PyMongo 1.11](http://api.mongodb.org/python/1.11/api/index.html) [`objectid`开始，`bson`模块中没有`pymongo`](http://api.mongodb.org/python/current/api/index.html).

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-04T21:33:15.910

正如Electro所说，这是一个错误。

我使用以下肮脏的小技巧来保持我的网站运行，直到它被修复：

```
import sys
import pymongo
import bson.objectid
pymongo.objectid = bson.objectid
sys.modules["pymongo.objectid"] = bson.objectid 
```

# r - 将字符串版本的运算符放在其操作数之间

> ID：10401500
> 
> 赞同：2
> 
> 时间：2012-05-01T17:17:49.540
> 
> 标签：r

如果我有一个变量保存比较运算符的字符串表示形式，例如：

```
> comparison <- "==" 
```

如何在其操作数之间插入此字符串版本的二元运算符？例如

```
> 2 <insert comparison> 2
TRUE 
```

注意。我不想使用`mapply(get(comparison),2,2`，因为我打算`2 <insert comparison> 2`将`which`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T17:26:44.770

我不太明白你为什么不想使用`mapply`，但`do.call`无论如何可能更好。

```
comparison <- "=="
do.call(comparison, list(2,2))

which( do.call(comparison, list(2,0:4)) ) 
```

# ms-access - 尝试从子窗体访问孙窗体时 Microsoft Access 运行时错误 2455

> ID：10401501
> 
> 赞同：4
> 
> 时间：2012-05-01T17:17:56.717
> 
> 标签：ms-access, ms-access-2007, vba, ms-access-2003, grandchild

我在 Access 2003 数据库（在 Access 2007 中开发）中有三个表单，它们位于父 -> 子 -> 孙关系中。在子表单的“Form_Load”子中，我设置了孙子表单的一些属性（表单标题、行源和控制逻辑）。当我查看子表单时，一切正常。当我查看父表单时，我收到错误：

> 运行时错误“2455”：您输入的表达式对表单/报表属性的引用无效。

参考该行：

```
Me.GrandchildFormName.Form.Foo.Caption = "bar" 
```

*我可以访问除*Form 属性之外的孙窗体的任何属性，而不会引发任何错误。有谁知道这可能是什么原因造成的？我在一个新数据库中做了一个测试用例，它工作得很好，所以我倾向于在我继承的数据库中存在一些东西（我被告知，它可以追溯到 18 年前的访问前数据库系统），这是导致问题的原因，但我想我会在这里检查一下，看看你们中是否有人知道解决方法。

如果相关，表单的实际结构会更复杂一些，孙表单在子表单中多次出现（在不同的控件名称下），如下所示：

```
|--------------|
| A            |
|  |----------||
|  | B        ||
|  |  |------|||
|  |  | C[1] |||
|  |  |------|||
|  |          ||
|  |  |------|||
|  |  | C[2] |||
|  |  |------|||
|  |----------||
|--------------| 
```

消除除一种外孙形式之外的所有形式并不能解决问题。

如果有办法让孙子表单知道它被加载为哪个实例，我可能会编写代码来解决这个问题，但据我所知，这是不可能的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-09-28T18:27:03.323

我将使用`Parent`、`Child`和`GrandChild`来指代各自的表单（而不是数据源）。

通常，`Form`子窗体控件的属性只有在显示子窗体后才会获得“有效引用”。因此，如果你想执行 中的代码`Child.Form_Load`，你必须确保它在打开`GrandChild`时是可见的。`Parent`

**解决方案**

由于我假设在您的情况下`GrandChild`，如果您打开`Child`（不打开`Parent`）是可见的，但`GrandChild`在您打开时不可见`Parent`，我建议您在不更改 UI 的情况下使用以下解决方案：

`Child.Form_Load`将访问的代码移动`GrandChild.Form`到`GrandChild.Form_Load`. 无论何时`GrandChild`加载，它都可以从`Child`( `Me.Parent.Form`) 甚至`Parent`( `Me.Parent.Parent.Form`) 访问所有内容。

换句话说`GrandChild`，必须（从`Child`or `Parent`）提取信息并更改自身，而不是通过更改`Child`将信息向下推送。`GrandChild``GrandChild`

**例子：**

假设与`Parent`有 1:n 关系，`Child`与`Child`有 1:n 关系`GrandChild`。`Parent`呈现`Child`为数据表，因此打开`GrandChild`时不显示。`Parent`在这种情况下，任何访问都会`GrandChild.Form`导致*2455 运行时错误*，因为`GrandChild`未显示。

在此示例中，数据表的每一行`Child`都有一个加号，可以显示`GrandChild`. 假设您放置了一个按钮，在该按钮上`Parent`执行您当前在`Child.Form_Load`子程序中拥有的代码。打开后单击此按钮`Parent`会导致错误（见上文），但如果您单击其中的一个加号`Child`，然后单击该按钮，则代码将在没有*2455 错误*的情况下执行，因为在这种情况下`GrandChild`，在`GrandChild.Form`访问被执行。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-07T16:17:33.200

就在给出问题类型的行上方： On Error Resume Next

运行它，这将解决您的问题。运行一次后，您可以擦除该行并继续工作。

# java - Socket Handler 连接 Java 失败

> ID：10401505
> 
> 赞同：-2
> 
> 时间：2012-05-01T17:18:12.683
> 
> 标签：java, sockets, applet, ip

更新：这是一个签名的小程序

所以，我有一个小程序，在初始化期间，它会尝试连接到服务器 ip。就像是

```
handler = new SocketHandler("xxx.xxx.xxx.xx", 5000); 
```

服务器位于美国。如果客户来自美国，我一直在测试它是否可以正常工作（小程序将正确加载）。但如果客户从其他国家/地区打开网站，则小程序无法加载。它似乎无法连接到服务器或其他东西。有没有人知道是什么问题或如何解决它。我是否需要使用不同的 IP 地址或其他东西以供国际使用？

更新：无论如何都会增加超时连接吗？发生的另一件事是，如果我使用较慢的连接，Java 控制台说超时套接字连接

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T17:24:29.280

出于安全原因，不受信任的 Applet 只能连接到从中下载它的服务器。因此，请检查您的 java 控制台。可能你会在那里发现安全异常。

其他可能的问题是您的服务器和客户端之间有防火墙。

顺便问一下，为什么要使用 TCP 套接字在 applet 和服务器之间进行协商？为什么不使用 Web 服务，例如基于 HTTP 的 RESTful API？至少这解决了防火墙的问题：如果您的小程序使用 HTTP 成功下载，它将使用相同的协议成功地与服务器通信。

# c# - 让关键手势和执行方法在 WPF 中工作

> ID：10401506
> 
> 赞同：0
> 
> 时间：2012-05-01T17:18:14.733
> 
> 标签：c#, wpf

我尝试`DelegateCommand`了方法，它执行正确，但我的关键手势不起作用：

```
public DelegateCommand StageCommand { get; private set; }

...
StageCommand = new DelegateCommand(StageExecuted);
...

private void StageExecuted(object action)
{
    System.Console.WriteLine("yay!");
} 
```

和我的上下文菜单的 XAML：

```
 <ContextMenu.InputBindings>
            <KeyBinding Command="{Binding PlacementTarget.Tag.StageCommand, RelativeSource={RelativeSource AncestorType=ContextMenu}}"
                        Gesture="Enter" />
        </ContextMenu.InputBindings>

        <MenuItem Header="Stage" Command="{Binding PlacementTarget.Tag.StageCommand, RelativeSource={RelativeSource AncestorType=ContextMenu}}">
        </MenuItem> 
```

所有这一切都正确执行，但我错过了关键手势，它甚至没有显示它：

![在此处输入图像描述](../Images/5effba0556e0e5b291c23e727d4f9840.png)

这就是我使用上下文菜单的方式：

```
<DataGrid 
          ContextMenu="{DynamicResource TestContextMenu}"
          Tag="{Binding}"> 
```

**更新：**

`Enter` *如果我在*上下文菜单打开时按下，它将执行。只要附加了上下文菜单的控件具有焦点，我怎样才能使它执行？而且，它仍然不显示手势键。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T17:21:59.810

[`CommandBinding`](http://msdn.microsoft.com/en-us/library/system.windows.input.commandbinding.aspx)为某些控件中的命令创建一个[`InputBindings`](http://msdn.microsoft.com/en-us/library/system.windows.uielement.inputbindings.aspx).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T17:39:07.567

来自[MSDN](http://msdn.microsoft.com/en-us/library/system.windows.controls.menuitem.inputgesturetext.aspx)`MenuItem.InputGestureText`：_

> 此属性不将输入手势与菜单项关联；它只是将文本添加到菜单项。应用程序必须处理用户的输入以执行操作。

基本上，因为这纯粹是一个文本字段，用于在默认控制模板中向用户显示输入手势，`MenuItem`所以它与您决定使用`KeyBinding`.

您可以通过绑定或 a`StaticResource`或通过附加属性/行为来处理此问题，该属性/行为搜索`KeyBinding`s 并将输入手势分配给使用匹配命令的任何子项。

# javascript - 带有确认按钮的 Dojo 对话框

> ID：10401512
> 
> 赞同：14
> 
> 时间：2012-05-01T17:18:48.403
> 
> 标签：javascript, dojo

我想添加一个带有“确定”和“取消”按钮的通用对话框支持回调函数。

如何使用 Dojo AMD 实现这一目标？

例如：

```
 myDialog = new Dialog ({

  title: "My Dialog",
  content: "Are you sure, you want to delete the selected Record?",
  style: "width: 300px",
  onExecute:function(){ //Callback function 
      console.log("Record Deleted") 
  },
  onCancel:function(){ 
      console.log("Event Cancelled") } 
  });
  // create a button to clear the cart
   new Button({ label:"Ok"
       onClick: myDialog.onExecute()
   }

   new Button({ label:"Cancel"
        onClick: function(){ myDialog.onCancel() }
   } 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-05-01T23:52:31.600

这是我遇到同样问题时提出的解决方案。它不是完全程序化的，但使用模板使代码更具可读性和更改灵活性。

最好看一次而不是听 100 次，所以请在 jsFiddle 上查看以下所有代码：http: [//jsfiddle.net/phusick/wkydY/](http://jsfiddle.net/phusick/wkydY/)

我采用的主要原则是，它`dijit.Dialog::content`不仅可以是一个字符串，还可以是一个小部件实例。所以我子类`dijit.Dialog`来声明`ConfirmDialog`类。在`ConfirmDialog::constuctor()`我声明并从模板实例化一个小部件并将其设置为对话框的内容。然后我`onClick`在`ConfirmDialog::postCreate()`方法中连接动作：

```
var ConfirmDialog = declare(Dialog, {

    title: "Confirm",
    message: "Are you sure?",

    constructor: function(/*Object*/ kwArgs) {
        lang.mixin(this, kwArgs);

        var message = this.message;

        var contentWidget = new (declare([_Widget, _TemplatedMixin, _WidgetsInTemplateMixin], {
            templateString: template, //get template via dojo loader or so
            message: message    
        }));
        contentWidget.startup();
        this.content = contentWidget;
    },

    postCreate: function() {
        this.inherited(arguments);
        this.connect(this.content.cancelButton, "onClick", "onCancel");
    }

}) 
```

模板标记：

```
<div style="width:300px;">

  <div class="dijitDialogPaneContentArea">
    <div data-dojo-attach-point="contentNode">
        ${message}              
    </div>
  </div>

  <div class="dijitDialogPaneActionBar">

    <button
      data-dojo-type="dijit.form.Button"
      data-dojo-attach-point="submitButton"
      type="submit"
    >
      OK
    </button>

    <button
      data-dojo-type="dijit.form.Button"
      data-dojo-attach-point="cancelButton"
    >
      Cancel
    </button>

  </div>

</div> 
```

现在使用`ConfirmDialog`代替`dijit.Dialog`：

```
var confirmDialog = new ConfirmDialog({ message: "Your message..."});
confirmDialog.show(); 
```

**重要提示：**不要忘记断开与对话框回调的任何连接并在关闭时销毁对话框。

如果您`ConfirmDialog`经常在代码的多个位置使用，请考虑：

```
var MessageBox = {};
MessageBox.confirm = function(kwArgs) {
    var confirmDialog = new ConfirmDialog(kwArgs);
    confirmDialog.startup();

    var deferred = new Deferred();
    var signal, signals = [];

    var destroyDialog = function() {
        array.forEach(signals, function(signal) {
            signal.remove();
        });
        delete signals;
        confirmDialog.destroyRecursive();
    }

    signal = aspect.after(confirmDialog, "onExecute", function() {
        destroyDialog();
        deferred.resolve('MessageBox.OK');
    });
    signals.push(signal);

    signal = aspect.after(confirmDialog, "onCancel", function() {
        destroyDialog();   
        deferred.reject('MessageBox.Cancel');            
    });
    signals.push(signal);

    confirmDialog.show();
    return deferred;
} 
```

您的代码将更具可读性，并且您不必处理清理工作：

```
MessageBox.confirm().then(function() {
    console.log("MessageBox.OK")
}); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2016-02-24T13:47:34.140

以下是如何使用`dijit/ConfirmDialog`和配置其按钮。

```
require(["dijit/ConfirmDialog"], function(ConfirmDialog){

    // create instance
    var dialog = new ConfirmDialog({
        title: "Session Expiration",
        content: "the test. Your session is about to expire. Do you want to continue?",
        style: "width: 300px"
    });

    // change button labels
    dialog.set("buttonOk","Yes");
    dialog.set("buttonCancel","No");

    // register events
    dialog.on('execute', function() { /*do something*/ });
    dialog.on('cancel', function() { /*do something*/ });

    // show
    dialog.show();
}); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-01-17T00:18:28.620

Dojo 1.10 包含一个新的[dijit/ConfirmTooltipDialog](http://dojotoolkit.org/reference-guide/1.10/dijit/ConfirmDialog.html)和内置的 OK 和 Cancel 按钮。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-04-14T08:07:57.177

**Dojo Confirm Dialog**非常简单且很有帮助。
[http://dojotoolkit.org/reference-guide/1.10/dijit/ConfirmDialog.html](http://dojotoolkit.org/reference-guide/1.10/dijit/ConfirmDialog.html)

```
require(["dijit/ConfirmDialog", "dojo/domReady!"], function(ConfirmDialog){
    myDialog = new ConfirmDialog({
        title: "My ConfirmDialog",
        content: "Test content.",
        buttonCancel: "Label of cancel button",
        buttonOk: "Label of OK button",
        style: "width: 300px",
        onCancel: function(){
            //Called when user has pressed the Dialog's cancel button, to notify container.
        },
        onExecute: function(){
           //Called when user has pressed the dialog's OK button, to notify container.
        }
    });
}); 
```

# django - Nginx + Gunicorn + Django Stack 上的站点缓慢故障排除

> ID：10401513
> 
> 赞同：20
> 
> 时间：2012-05-01T17:19:01.803
> 
> 标签：django, nginx, hosting, gunicorn

## 我遇到的问题

我遇到了一些网站需要很长时间才能加载的问题（“长时间”是指最多 16 秒）。有时它们可​​能会完全超时，从而产生 Nginx 504 错误。通常，当一个站点超时时，我可以再次重新加载该站点，它会很快加载。我遇到问题的网站的流量非常低。我正在通过加载 Django 管理索引页面来测试该站点，以尝试消除由于代码不佳而可能导致的任何缓慢。还应注意，此特定站点仅使用 Django 管理员，因为它是仅供员工使用的 Intranet 类型站点。

## 主机设置

我托管的所有站点都在两台 Rackspace 云服务器上。第一个服务器是我的应用服务器，它有 1024 MB 的 RAM，我的第二个服务器是我的数据库服务器，它有 2048 MB 的 RAM。应用服务器使用 Nginx 为每个站点提供服务，Nginx 为每个站点提供所有静态文件并将其他所有内容代理给 Django Gunicorn 工作人员。

查看数据库服务器的 RAM 和 CPU 负载时​​，似乎数据库服务器上的一切都很好。

```
$ free -m
             total       used       free     shared    buffers     cached
Mem:          1999       1597        402          0        200       1007
-/+ buffers/cache:        389       1610
Swap:         4094          0       4094

Top shows a CPU load average of: 0.00, 0.01, 0.05 
```

为了尝试解决正在发生的事情，我编写了一个快速的小[脚本](https://gist.github.com/2503939)，它可以打印出应用服务器上的内存使用情况。

使用匿名站点域打印的示例：

```
Celery:     23 MB
Gunicorn:  566 MB
Nginx:       8 MB
Redis:     684 KB
Other:      73 MB

             total       used       free     shared    buffers     cached
Mem:           993        906         87          0         19         62
-/+ buffers/cache:        824        169
Swap:         2047        828       1218

Gunicorn memory usage by webste:
site01.example.com    31 MB
site02.example.com    19 MB
site03.example.com     7 MB
site04.example.com     9 MB
site05.example.com    47 MB
site06.example.com    25 MB
site07.example.com    14 MB
site08.example.com    18 MB
site09.example.com    27 MB
site10.example.com    15 MB
site11.example.com    14 MB
site12.example.com     7 MB
site13.example.com    18 MB
site14.example.com    18 MB
site15.example.com    10 MB
site16.example.com    25 MB
site17.example.com    13 MB
site18.example.com    18 MB
site19.example.com    37 MB
site20.example.com    30 MB
site21.example.com    23 MB
site22.example.com    28 MB
site23.example.com    80 MB
site24.example.com    15 MB
site25.example.com     5 MB 
```

示例 Gunicorn 配置文件：

```
pidfile = '/var/run/gunicorn_example.com.pid'
proc_name = 'example.com'
workers = 1
bind = 'unix:/tmp/gunicorn_example.com.sock' 
```

示例 Nginx 配置：

```
upstream example_app_server {
    server unix:/tmp/gunicorn_example.com.sock fail_timeout=0;
}

server {

    listen       80;
    server_name  example.com;
    access_log   /var/log/nginx/example.com.access.log;
    error_log    /var/log/nginx/example.com.error.log;

    location = /favicon.ico {
        return  404;
    }

    location  /static/ {
        root  /srv/sites/example/;
    }

    location  /media/ {
        root  /srv/sites/example/;
    }

    location  / {
        proxy_pass            http://example_app_server;
        proxy_redirect        off;
        proxy_set_header      Host             $host;
        proxy_set_header      X-Real-IP        $remote_addr;
        proxy_set_header      X-Forwarded-For  $proxy_add_x_forwarded_for;
        client_max_body_size  10m;
    }

} 
```

正如你所看到的，有很多内存被交换，所以为了解决我的问题，我升级了应用服务器上的内存，这完全解决了网站的缓慢问题。尽管我能够解决这个问题，但我花费的时间比我想要的要长得多，而且我仍然觉得我基本上是在猜测导致网站运行缓慢的原因。这一切都让我想到了我的问题......

## 问题

1.  您如何判断低流量站点上的站点缓慢不是由于站点不活动导致站点变为不活动，然后导致 Gunicorn 在站点变为不活动后必须再次加载站点？是否有防止网站进入非活动状态的设置？
2.  似乎我有一些网站占用了太多内存。我可以使用哪些工具来减少站点使用的内存量？我应该使用一些 Python 分析工具吗？
3.  为了确定瓶颈发生在堆栈的哪个级别，需要采取哪些工具和步骤？
4.  确定是您的 Gunicorn 进程正在被交换还是其他进程正在被交换的最佳方法是什么？
5.  我托管的大多数网站都没有大量流量，所以我只使用了一个 Gunicorn 工作人员。是否有更科学的方法来确定和调整您在网站上拥有多少 Gunicorn 工人？
6.  在同一台服务器上托管多个站点时，有没有办法配置东西以使用更少的内存？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T19:46:22.463

在只有 1GB 内存的服务器上托管了很多网站。您的内存利用率接近 100%，并且您拥有的数字可能是“备用”数字。在处理请求的过程中，每个进程的 RAM 使用量可以并且将会激增。马上，您需要为此实例添加更多 RAM，并且最好将一些站点移到另一台服务器上。

至于你的问题：

1.  您从哪里得知网站变得“不活跃”而 Gunicorn 必须再次加载该网站？那是垃圾。只要 Gunicorn 进程正在运行（即没有手动终止或因站点上的错误而终止），它就会保持完全初始化并准备就绪，无论是一个小时还是一个月。

2.  你在这里砍树叶，不碰根。每个 Gunicorn 进程的内存使用情况并没有什么异常。它*需要*RAM 才能运行。您的问题是试图在功率严重不足的服务器上运行太多。没有优化可以在这里拯救你。您需要更多 RAM 或更多服务器。大概两者兼而有之。

3.  没必要。同样，问题已经确定。事实上，您发布的数字非常清楚。

4.  没有办法可靠地知道哪些进程正在被交换。它每秒都在变化，取决于哪些正在积极运行并需要更多 RAM，哪些不活跃或根本不活跃。当您的服务器资源紧张时，它会花费一半的时间来确定接下来要处理哪个进程，尤其是当它们都处于活动状态并争夺资源时。

5.  是的。Gunicorn 推荐 2*cores+1。所以在双核系统上，是 5；在四核上，9。但是，在这个系统上，您甚至无法为这些站点中的每个站点运行 5 个工作人员。您甚至无法可靠地为每个工作人员运行 1 个工作人员。

6.  这取决于“事物”。但是，当多个站点托管在同一台服务器上时，这些服务器在规范方面是*野兽。*在像您这样的小型 VPS 实例上，尤其是只有 1GB 的 RAM，一个站点几乎是您的极限。两个，也许。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T06:42:17.977

1）不知道你所说的不活跃是什么意思？如，被 nginx 禁用？还是工作太慢？

2 和 3) django-debug-toolbar 和 django-debug-logging 将是一个很好的起点。如果这没有帮助，是时候转移到服务器级别的分析来查看哪些进程导致了问题。

4）使用top：[如何找出linux中哪些进程正在交换？](https://stackoverflow.com/questions/479953/how-to-find-out-which-processes-are-swapping-in-linux)

5) 是的 - 基准测试。选择一个基准测试工具（例如 apachebench）并针对您当前的配置运行测试。调整一些东西。再次运行测试。重复直到你的性能问题消失！为获得最佳效果，请使用与您的实时流量相似的流量（在 URL 分发、GET/POST 等方面）。

6) 是的，在 nginx 和应用程序级别。通过分析每个站点并提高其内存使用率，您可能会获得最大的好处（参见 2）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-09T10:48:30.510

关于：

> 关于您对 5 的回答，我认为 Gunicorn 的建议是矫枉过正。

我最近对工人数量进行了一些临时测试，发现假设您有足够的 RAM，那么 2*cores+1 的经验法则非常准确。我发现请求/秒几乎呈线性增长，直到我接近这个数字，然后随着操作系统开始抖动而下降。

由于结果很大程度上取决于工作负载，因此请尝试不同的值并查看您的性能峰值在哪里。

# objective-c - 流未使用 memcpy 建立

> ID：10401515
> 
> 赞同：1
> 
> 时间：2012-05-01T17:19:21.583
> 
> 标签：objective-c, c, cocoa

不知道为什么我得到一个 24 相对于 40 的 strlen？谢谢

```
 char bufferData[1000];
            memset(bufferData, '\0', 1000);
            long j;
            long offset;
            double mice;

            mice = 32.45;
            j=0;
            offset = sizeof(double) * j;
            NSLog(@"offset: %d", offset);
            memcpy(bufferData+offset, &mice, sizeof(double));
            mice = 21.35;
            j=1;
            offset = sizeof(double) * j;
            NSLog(@"offset: %d", offset);
            memcpy(bufferData+offset, &mice, sizeof(double));
            mice = 11.55;
            j=2;
            offset = sizeof(double) * j;
            NSLog(@"offset: %d", offset);
            memcpy(bufferData+offset, &mice, sizeof(double));
            mice = 41.25;
            j=3;
            offset = sizeof(double) * j;
            NSLog(@"offset: %d", offset);
            memcpy(bufferData+offset, &mice, sizeof(double));
            mice = 51.50;
            j=4;
            offset = sizeof(double) * j;
            NSLog(@"offset: %d", offset);
            memcpy(bufferData+offset, &mice, sizeof(double));

            NSLog(@"sizeof(double): %d     strlen(bufferData): %d", sizeof(double), strlen(bufferData));
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T17:23:33.920

由于`strlen`寻找设置为零的单个字节，它在到达时停止`41.25`，因为它的八个字节中有五个为零。

`41.25`转换`double`为`0x4044A00000000000`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T17:22:52.180

因为您正在 memcpy() 输入数据，并且在第 24 个字节处的双精度值之一的二进制表示中存在零

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-01T17:25:27.683

要将二进制数据转换为字符串，您可以使用`sprintf()`.

以您的方式进行操作，将数据保留为二进制格式，与字符串表示完全不同。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-01T17:23:35.853

Strlen 在它找到的第一个空字节处终止，因此它不是查找缓冲区中字节数的合适函数。

# java - 转发或重定向后表单参数为空

> ID：10401517
> 
> 赞同：0
> 
> 时间：2012-05-01T17:19:33.260
> 
> 标签：java, http, jsp, servlets

我有一个非常简单的登录 servlet，代码如下：

```
 userName = request.getParameter("username");
    password = request.getParameter("password");

    if ("xxx".equals(userName) && "xxx".equals(password)) {
        RequestDispatcher requestDisSecure = request
                .getRequestDispatcher("VendorList_Secure.jsp");
        requestDisSecure.forward(request, response);
    }
    if ("xxx".equals(userName) && "xxx".equals(password)) {
        RequestDispatcher requestDisSecure = request
                .getRequestDispatcher("VendorList_Secure.jsp");
        requestDisSecure.forward(request, response);
    }
    if ("xxx".equals(userName) && "xxx".equals(password)) {
        RequestDispatcher requestDisSecure = request
                .getRequestDispatcher("VendorList_Secure.jsp");
        requestDisSecure.forward(request, response);
    }
    if ("xxx".equals(userName) && "xxx".equals(password)) {
        RequestDispatcher requestDisSecure = request
                .getRequestDispatcher("VendorList_Secure.jsp");
        requestDisSecure.forward(request, response);
    } else {
        /**
         * Unauthenticated user
         */
        RequestDispatcher requestDisUnSecure = request
                .getRequestDispatcher("VendorLoginError.jsp");
        requestDisUnSecure.forward(request, response);
    } 
```

我们从具有用户名和密码参数的 VendorLogin.jsp 来到这个 servlet 逻辑，如果登录正确，它会转发到 VendorList_Secure.jsp，但如果不是，它将转发到 VendorLoginError.jsp，但在输入新的用户名和密码后并点击上面的 servlet，我将用户名和密码参数都设为 null，而不是 servlet 中的新更新值！

我尝试了重定向，但我得到了相同的效果

我知道我可以通过保护 web.xml 中的资源来更好地实现登录，但我想知道为什么这个简单的例子不起作用

那么我在这里做错了什么？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T17:30:27.303

您的表单元素应与 getParameter 中给出的名称匹配。

```
userName = request.getParameter("username");
password = request.getParameter("password"); 
```

就像下面

```
<input type="text" name="username"  />
<input type="password" name="password"  /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T17:22:26.580

您的登录 jsp 应该包含用户名和密码作为名称的元素。

```
<input type="text" name="username" id="txtUserName" /> 
```

# php - 使用 PHP 创建随机序列

> ID：10401520
> 
> 赞同：8
> 
> 时间：2012-05-01T17:19:53.380
> 
> 标签：php

我希望每次有人访问时在我的网站上创建一个随机序列。

序列号格式应为 XXXXX-XXXXX-XXXXX-XXXXX。

X 代表随机数或大写字母。

不幸的是，我不知道该怎么做。有人可以帮我吗？

因此，例如随机串行输出可能是：3WT4A-NB34O-JU87P-B3UHS 非常

感谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-01T18:17:03.630

另一种方法是将四个段计算为以 36 为基数的随机数。

```
function generate_serial() {
    static $max = 60466175; // ZZZZZZ in decimal
    return strtoupper(sprintf(
        "%05s-%05s-%05s-%05s",
        base_convert(random_int(0, $max), 10, 36),
        base_convert(random_int(0, $max), 10, 36),
        base_convert(random_int(0, $max), 10, 36),
        base_convert(random_int(0, $max), 10, 36)
    ));
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-01T17:37:15.467

最直接的解决方案是这样的。

```
$tokens = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';

$serial = '';

for ($i = 0; $i < 4; $i++) {
    for ($j = 0; $j < 5; $j++) {
        $serial .= $tokens[rand(0, 35)];
    }

    if ($i < 3) {
        $serial .= '-';
    }
}

echo $serial; 
```

样本输出：

```
51C8A-P9NZD-UM37Q-YKZHO 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-01T17:27:11.727

肯定有更好的方法来做到这一点，但这是首先想到的：

```
$chars = array(0,1,2,3,4,5,6,7,8,9,'A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z');
$serial = '';
$max = count($chars)-1;
for($i=0;$i<20;$i++){
    $serial .= (!($i % 5) && $i ? '-' : '').$chars[rand(0, $max)];
} 
```

**05/26/13 编辑：**建议将[Count](http://php.net/manual/en/function.count.php)函数保持在循环之外。这样做的原因是，当您可以简单地运行一次时，您不想在每次迭代中花费额外的时钟周期来运行此函数。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-05-01T17:27:40.027

有很多方法可以解决这个问题。一种简单的方法是：

```
$string1 = substr(md5(uniqid(rand(), true)), -5, 5);
$string2 = substr(md5(uniqid(rand(), true)), -5, 5);
$string3 = substr(md5(uniqid(rand(), true)), -5, 5);
$string4 = substr(md5(uniqid(rand(), true)), -5, 5);
$serial  = sprintf('%s-%s-%s-%s', $string1, $string2, $string3, $string4); 
```

有更好的方法来生成随机字符串，但这将为您提供您正在寻找的基本功能。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-01T17:39:08.483

如果你想使用这个序列只是因为唯一性 - 你也可以尝试使用[UUID v4](http://en.wikipedia.org/wiki/Universally_unique_identifier#Version_4_.28random.29)，如这里的答案之一所述：[PHP function to generate v4 UUID](https://stackoverflow.com/questions/2040240/php-function-to-generate-v4-uuid)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-05-01T17:35:51.297

尝试这个

```
function rand_string( $length ) {
    $length += 3;
    $chars = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";  
    $str= "";
    $size = strlen( $chars );
    for( $i = 0; $i < $length; $i++ ) {
            if($i == 5 || $i == 11 || $i == 17 )
                $str .= '-';
            else
                $str .= $chars[ rand( 0, $size - 1 ) ];
    }

    return $str;
}

$getstring = rand_string(20,5);
echo $getstring; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-05-01T17:22:10.107

SO上有很多这样的答案：[https ://stackoverflow.com/a/4356295/1091195](https://stackoverflow.com/a/4356295/1091195)

您可以使用那里提到的随机字符串生成器，您可以使用一次获得 20 个字母的字符串然后插入破折号，或者您可以调用 4 次以获得 5 个字母并连接结果。

# django - 只允许叶类别作为选择 - Django

> ID：10401521
> 
> 赞同：1
> 
> 时间：2012-05-01T17:20:05.647
> 
> 标签：django

我有以下型号：

```
class Category(models.Model):
    name = models.CharField(max_length=200)
    slug = models.SlugField()
    parent = models.ForeignKey('self', blank = True, null = True, related_name="children")

class Business(models.Model):
    user = models.OneToOneField(User)
    name = models.CharField(max_length=200)
    slug = models.SlugField()
    category = models.ForeignKey(Category)
    city = models.ForeignKey(City) 
```

使用 modelForm 添加业务时，非叶子类别会显示在选择框中。

例如，假设我们有以下类别层次结构：

```
- Cars
     -- Car Rental
     -- Car Dealership
     -- Mechanics
- Restaurants
    -- Burgers
    -- Chinese
    -- Sushi
    -- Pizza
    -- Latin american
         -- Mexican
         -- Venezuelan
         -- Argentinian 
```

使用此层次结构，除汽车、餐厅和拉丁美洲之外的所有选项都应显示在类别选择框中，因为它们具有子类别。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T17:28:21.323

```
Category.objects.filter(children__isnull=True)

class MyModelForm(forms.ModelForm):
    def __init__(self, *args, **kwargs):
        super(MyModelForm, self).__init__(*args, **kwargs)
        self.fields['myfield'].queryset = Category.objects.filter(children__isnull=True) 
```

# c# - 发出 HttpRequest 时出现 HTTP 错误 401.2

> ID：10401528
> 
> 赞同：0
> 
> 时间：2012-05-01T17:21:05.293
> 
> 标签：c#

我正在尝试发布到 asp.net 网页并接收生成的 xml。

这是我的代码：

```
 Uri url = new Uri("https://www.dmr.nd.gov/oilgas/feeservices/getcpfilesxml.asp");
        HttpWebRequest request = (HttpWebRequest)WebRequest.Create(url);
        request.Credentials = nc;
        request.Method = "POST";

        Byte[] postBuffer = Encoding.UTF8.GetBytes("FileNumber=04113");
        request.ContentLength = postBuffer.Length;
        request.ContentType = "text/xml; Charset=UTF-8";

        using (Stream postData = request.GetRequestStream())
        {
            postData.Write(postBuffer, 0, postBuffer.Length);
        }

        HttpWebResponse response = (HttpWebResponse)request.GetResponse(); 
```

当我运行它时，我收到一个 HTTP 错误 401.2 错误解释：您无权使用您提供的凭据查看此目录或页面，因为您的 Web 浏览器正在发送未配置 Web 服务器的 WWW-Authenticate 标头字段接受。

在网站上使用 asp.net 页面时，这是我在 Fiddler 中获得的标题信息：

```
HTTP/1.1 200 OK
Date: Tue, 01 May 2012 15:34:44 GMT
Server: Microsoft-IIS/6.0
X-Powered-By: ASP.NET
Content-Length: 4325
Content-Type: text/xml; Charset=UTF-8
Cache-control: private
Keep-Alive: timeout=15, max=99
Connection: Keep-Alive 
```

使用此身份验证信息：

*   不存在 Proxy-Authenticate 标头。
*   不存在 WWW-Authenticate Header。

运行我的应用程序时，这是我在 Fiddler 中获得的标头信息：

```
HTTP/1.1 200 OK
Date: Tue, 01 May 2012 17:18:04 GMT
Server: Microsoft-IIS/6.0
X-Powered-By: ASP.NET
Content-Length: 124
Content-Type: text/xml; Charset=UTF-8
Cache-control: private
Set-Cookie: ASPSESSIONIDASADTBCS=JEBNCDNDNEPNLEBIEAFHENJF; path=/
X-Pad: avoid browser bug 
```

使用此身份验证信息：

*   不存在 Proxy-Authenticate 标头。
*   存在 WWW-Authenticate 标头：Basic realm="www.dmr.nd.gov"

如何避免 WWW-Authenticate Header 被推倒？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T16:50:29.233

经过进一步调查，我发现身份验证问题并不是我的问题。显然我想要一个 GET 操作，而我正在运行一个 POST 操作。

# java - ButtonGroup：选定元素的数量

> ID：10401530
> 
> 赞同：0
> 
> 时间：2012-05-01T17:21:05.360
> 
> 标签：java, swing, selected, jtogglebutton, buttongroup

如何获取 ButtonGroup 中所有选定 JToggleButtons 的数量？

```
ButtonGroup bGroup = new ButtonGroup();
bGreen = new JToggleButton("Green");
bYellow = new JToggleButton("Yellow");
bRed = new JToggleButton("Red");

bGroup.add(bGreen);
bGroup.add(bYellow);
bGroup.add(bRed); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T17:30:55.157

有几种方法。例如`bGroup.getSelection().getSelectedObjects().length`. 您也可以调用`getElements()`，然后遍历枚举并询问`isSelected()`每个按钮。请参考 API 文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T17:32:03.093

您必须为每个工具添加一个项目侦听器

```
public int counter = 0;
public void itemStateChanged(ItemEvent e) {
    if(e.getStateChange() == ItemEvent.SELECTED)
    {
         counter++;
    }
    else
    {
        counter --;
    } 
} 
```

# image-processing - emguCV 中的 CvInvoke.findFundamentalMatrix 方法

> ID：10401532
> 
> 赞同：2
> 
> 时间：2012-05-01T17:21:17.703
> 
> 标签：image-processing, emgucv

您好我尝试使用 emguCV 库计算基本矩阵。这是我所做的，但返回的矩阵在图像[http://i46.tinypic.com/2v8pt6v.jpg中有值](http://i46.tinypic.com/2v8pt6v.jpg)

我检查了 EmguCV 文档，参数似乎合适。

矩阵 firstImagePoints = new Matrix(2, 8);

```
 firstImagePoints[0, 0] = 224.0;
  firstImagePoints[0, 1] = 245.0;
  firstImagePoints[0, 2] = 232.0;
  firstImagePoints[0, 3] = 277.0;
  firstImagePoints[0, 4] = 533.0;
  firstImagePoints[0, 5] = 477.0;
  firstImagePoints[0, 6] = 528.0;
  firstImagePoints[0, 7] = 510.0;

  firstImagePoints[1, 0] = 60.0;
  firstImagePoints[1, 1] = 95.0;
  firstImagePoints[1, 2] = 284.0;
  firstImagePoints[1, 3] = 223.0;
  firstImagePoints[1, 4] = 48.0;
  firstImagePoints[1, 5] = 86.0;
  firstImagePoints[1, 6] = 302.0;
  firstImagePoints[1, 7] = 266.0; 
```

矩阵 secondImagePoints = new Matrix(2, 8);

```
 secondImagePoints[0, 0] = 111.0;
    secondImagePoints[0, 1] = 129.0;
    secondImagePoints[0, 2] = 123.0;
    secondImagePoints[0, 3] = 159.0;
    secondImagePoints[0, 4] = 401.0;
    secondImagePoints[0, 5] = 344.0;
    secondImagePoints[0, 6] = 402.0;
    secondImagePoints[0, 7] = 382.0;

    secondImagePoints[1, 0] = 79.0;
    secondImagePoints[1, 1] = 111.0;
    secondImagePoints[1, 2] = 295.0;
    secondImagePoints[1, 3] = 236.0;
    secondImagePoints[1, 4] = 52.0;
    secondImagePoints[1, 5] = 94.0;
    secondImagePoints[1, 6] = 317.0;
    secondImagePoints[1, 7] = 279.0;

   fundamentalMatrice=new Matrix<double>(3,3,1);

    CvInvoke.cvFindFundamentalMat(firstImagePoints.Ptr, secondImagePoints.Ptr, fundamentalMatrice.Ptr, Emgu.CV.CvEnum.CV_FM.CV_FM_RANSAC, 1.0, 0.99, IntPtr.Zero);
    isFundamentalMatrixCalculated = true; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T14:15:07.580

你可以删除`IntPtr.Zero`并尝试看看你得到了什么？

# objective-c - 如何通过 IBAction 更改 UITableViewCell 内容视图？

> ID：10401533
> 
> 赞同：0
> 
> 时间：2012-05-01T17:21:18.280
> 
> 标签：objective-c, uitableview, ibaction, nsindexpath

我有一个包含许多单元格的 UITableView，所有单元格都进入一个 xib 视图，我在那个 xib 视图中有 2 个按钮 - 向上，向下。我想要做的是在按下这些按钮之一时跳转到下一个/后退单元格内容，内容视图需要更改，例如 Mail.app、Reeder 应用程序等...

这是我试图做的，但没有奏效：

```
 NSIndexPath *currentPath = [tipsGuideViewTv indexPathForSelectedRow];
  NSIndexPath *nextPath = [NSIndexPath indexPathForRow:indexVariable.row+1         inSection:indexVariable.section];

 [self.navigationController popToViewController:nextPath animated:YES]; 
```

我在网上搜索解决方案，但我没有找到我的意思。有人知道怎么做吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T18:00:31.047

```
NSIndexPath *currentPath = [tipsGuideViewTv indexPathForSelectedRow];
NSIndexPath *nextPath    = [NSIndexPath indexPathForRow:currentPath.row+1 
                                              inSection:currentPath.section];

[tipsGuideViewTv selectRowAtIndexPath:nextPath animated:YES]; 
```

**根据评论编辑**

```
// To make it function the same as if they had tapped the row, do the following:
// Only call the methods that are implemented in your controller.
[tipsGuideViewTv tableView:tipsGuideViewTv willSelectRowAtIndexPath:nextPath];
[tipsGuideViewTv tableView:tipsGuideViewTv didSelectRowAtIndexPath:nextPath]; 
```

确保新的索引路径是有效的（即您还不是表格的末尾）。

# django - 将应用程序模型保存在一个文件中还是将每个模型分开到一个新文件中？

> ID：10401549
> 
> 赞同：0
> 
> 时间：2012-05-01T17:22:38.437
> 
> 标签：django, django-models

我正在阅读以下代码，`models`它们的结构使得每个类/模型都有一个单独的文件，然后将其导入`__init__.py`. 例如：

```
# __init__.py
from service            import Service
from note               import Note
etc...

# service.py (one example of the imports)
from django.db import models

class Service(models.Model):

    #: service provider name (e.g. Hulu)
    name                = models.CharField(max_length=64, verbose_name="Title Name", unique=True)

    def __unicode__(self):
        return u'Service id=%s, name=%s' % (self.pk, self.name) 
```

哪种方法更好，将所有模型放在一个`models.py`文件中，还是每个模型一个文件？我通常将一个应用程序的所有模型保存在一个文件中，而且我从未见过将模型分开，这就是我问这个问题的原因。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T17:37:50.263

如果您在谈论真正的“最佳实践”，那将遵循 Django 推荐的方式并仅使用 models.py。然而，这个话题有很多意见和争论。尽管如此，我的建议是：

如果你有一个简单的应用程序，只有几个模型。坚持使用 models.py 的“Django 方式”。

如果您有一个包含大量模型和数千行代码的大型应用程序，那么将其拆分可能会更好。但是，此时，您还应该问自己为什么您的应用程序如此庞大，以及是否可以将任何东西分解到辅助应用程序中。

总而言之，我个人的观点是，将模型分成单独的文件*绝不*是一个好主意。在某些情况下，它可能会导致问题，老实说，我看不到真正合理的用例。通常，如果您的应用程序大到足以保证这样做，这实际上表明您将太多功能集中在一起，这些功能最好委派给其他应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T17:37:11.783

最佳做法是将它们放在一个文件中。例如，查看 django 源代码。

您从未见过它的原因是因为它实际上从未完成过。

如果你能以某种方式证明它是合理的，那么一定要这样做，但这绝对不是推荐的结构。当文件变得太大/可以逻辑分离时，人们开始探索拆分模型。

# c# - 响应 BinaryWrite 在 Android 浏览器上不起作用

> ID：10401557
> 
> 赞同：3
> 
> 时间：2012-05-01T17:23:07.640
> 
> 标签：c#, android, asp.net

我在数据库中有一个字节数组，我需要以 pdf 文件格式显示它。这是我这样做的方式。但是，这不适用于 Android 平板电脑（在 2.3.5 和 3.2 中检查）。

```
Response.Clear();
Response.ContentType = "application/octet-stream";
Response.BufferOutput = true;
Response.Buffer = false;
Response.AddHeader("Content-Length", binaryData.Length.ToString());
Response.AppendHeader("Content-Disposition", "inline;filename=ClientDocument.PDF");
// Response.BinaryWrite(binaryData);
Response.OutputStream.Write(binaryData, 0, binaryData.Length);
Response.End(); 
```

你们能想出什么方法可以让它在所有浏览器上运行吗？

感谢帮助

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T19:13:16.693

几件事...

1.  更改内容类型以更正 PDF 文件的 MIME 类型。有大量这些在使用 application/pdf、application/x-pdf、application/acrobat、applications/vnd.pdf、text/pdf、text/x-pdf"，我们只使用 application/pdf。

    Response.ContentType = "应用程序/pdf";

2.  然后，如果您希望浏览器打开并显示 PDF 文件，请删除 Content-Disposition 标题。

3.  ...或...如果您希望浏览器下载 PDF 文件，请将 Content-Disposition 类型更改为“附件”而不是“内联”。

    Response.AppendHeader("Content-Disposition", "attachment;filename=ClientDocument.PDF");

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-02T11:23:17.570

您是否已在测试平板电脑/手机上升级到最新版本的 Android？

当我遇到类似问题（仅在 Android 上从流或字节 [] 发送到浏览器时，PDF 无法打开或下载）时，这为我解决了这个问题。

# asp.net - MVC3 控制器中的 TempData[] 使用错误 w/SessionStateTempDataProvider 类需要启用会话状态

> ID：10401567
> 
> 赞同：0
> 
> 时间：2012-05-01T17:23:41.817
> 
> 标签：asp.net, asp.net-mvc-3

我正在尝试在 mvc3 控制器中使用 TempData[] 并且遇到以下错误：

> SessionStateTempDataProvider 类需要启用会话状态。

以下是在 webconfig 中设置的（不是我的代码或项目）但是......

```
<modules runAllManagedModulesForAllRequests="true">
  <add name="Custom http Module" type="CustomHttpModule" />
</modules> 
```

其中CustomHttpModule：

```
public class CustomHttpModule: IHttpModule 
```

这是我可以更改或可能在此 CustomHttpModule 类中定义的配置设置吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T17:38:33.120

[`IRequiresSessionState`](http://msdn.microsoft.com/en-us/library/system.web.sessionstate.irequiressessionstate.aspx)如果您希望能够从 HTTP 模块访问会话，请确保您的模块实现了标记接口：

```
public class CustomHttpModule: IHttpModule, IRequiresSessionState
{
    ...    
} 
```

还要`web.config`确保[会话状态](http://msdn.microsoft.com/en-us/library/h6bb9cz9.aspx)已启用：

```
<sessionState mode="InProc" /> 
```

当然，您在此处指定的模式将取决于设置和要求。例如，如果您在 Web 场中运行，将会话数据存储在内存中可能容易出错，因为 Web 场的每个节点都将存储自己的会话，并且无法共享。在这种情况下，您可能需要考虑一些其他模式，使您能够在场的节点之间共享会话。

# php - 在php中保护变量不被窃取

> ID：10401568
> 
> 赞同：2
> 
> 时间：2012-05-01T17:23:42.080
> 
> 标签：php, security, plugins, content-management-system

我有一个问题在我脑海里盘旋了很久很久。我在一个 CMS 项目上，我真的不知道该怎么做：我希望这个 cms 可以通过使用插件系统进行修改，直到现在都没有什么困难。好吧，我现在有这个问题，如何保护管理员用户的 mysql 密码等变量/常量？例如，在文件 settings.php 我有

```
$mysql = array("user" => "admin"...); 
```

我怎样才能让一堂课不读呢？一个简单的类（插件）可以做

```
class myplugin extends plugin_container {
function badfunction() {
mail("my bad address", "data stolen", $GLOBALS["mysql"]);
} 
```

这样，一个简单的插件就可以窃取用户的敏感数据。我怎样才能解决这个问题 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T17:28:00.697

你不能......插件可以执行代码，而你无法控制该代码。

但是，您可以一一批准插件，以避免潜在问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T17:30:02.600

你不能在 PHP 中真正做到这一点。您可以将变量放在一个对象中，将其设为私有，但使用反射，其他代码也可以获取它。地狱，即使它不能，仍然有办法在你不应该的时候获取对象的内部结构，比如`var_dump`,`debug_zval_dump`等等。

我会建议：

*   连接到数据库后丢弃密码（并在连接*后*加载模块）
*   将其存储在内存以外的其他地方（配置文件），但这并不能解决任何问题，因为插件仍然可以访问该配置文件
*   放弃并说“模块是可信的”——这可能是所有 CMS 所做的
*   一些更奇怪的方法 - 沙盒模块，以删除的 unix 权限作为单独的进程运行，虚拟化它们......我想这些都没有实际用处

通常，当您的代码在某些上下文中运行（例如在 PHP 脚本中）并且您希望允许某些模块或插件在同一上下文中运行时，没有办法隐藏任何内容。该插件将可以访问相同的内存（所有变量）、所有打开的资源（数据库连接），并且基本上与该上下文中的任何其他代码没有区别。这同样适用于许多其他环境，例如在操作系统中运行的本机进程。当然，您可以使获取某些变量或资源变得“更难”，但您永远无法确保无法访问它。除非您在不同的上下文中运行其他代码（其他进程、虚拟化等）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T17:31:01.593

尽管您可以尝试将 $mysql 的范围更改为某个本地范围 - 通过调用如下函数获取数据： function mySafeBox() { return $mysql; 现在，插件代码将无法从 $_GLOBALS 访问它，但这样做没有意义……因为您通过使用它来依赖插件...这样，您将永远找不到这个问题的一个很好的“解决方案”，从未存在过

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-02T08:30:19.790

PHP 不提供内部安全边界的工具。大多数语言都是这样的；Java 是个例外。

So if you want to build a trust boundary in a PHP script you would have to do it via OS-level privilege separation mechanisms: spawn a process running under a separate user principal with lower privileges, and use a pipe to communicate between that and the main trusted app. This would require a load of architectural rework that doesn't fit within the usual PHP invocation model.

# lua - Lua中的Wireshark解剖器

> ID：10401569
> 
> 赞同：8
> 
> 时间：2012-05-01T17:23:47.530
> 
> 标签：lua, wireshark, wireshark-dissector

首先，我完全是 Lua 新手，这是我第一次尝试编写一个wireshark 解析器。

我的协议很简单——一个 2 字节长度的字段，后跟一个该长度的字符串。

当我通过 Lua 控制台运行代码时，一切都按预期工作。

将代码添加到 Wireshark 插件目录时，出现错误

> Lua 错误：[string "C:\Users...\AppData\Roaming\Wireshark..."]:15: call 'add' on bad self（期望数字，得到字符串）

第 15 行对应的是`t:add(f_text...`行。

谁能解释执行方法之间的差异？

```
do
    local p_multi = Proto("aggregator","Aggregator");

    local f_len = ProtoField.int16("aggregator.length","Length",base.DEC)
    local f_text = ProtoField.string("aggregator.text","Text")

    p_multi.fields = { f_len, f_text }

    local data_dis = Dissector.get("data")

    function p_multi.dissector(buf,pkt,root)
            pkt.cols.protocol = "Aggregator"
            local len = buf(0,2):int()
            local t = root:add(p_multi,buf(0,len+2))
            t:add(f_len,buf(0,2),"Length: " .. buf(0,2):int())
            t:add(f_text,buf(2,len),"Text: " .. buf(2,len):string())
    end

    local tcp_encap_table = DissectorTable.get("tcp.port")
    tcp_encap_table:add(4321,p_multi)
end 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-02T14:42:31.493

您的解析器代码非常接近正确，但是您正在做界面不接受的额外工作。如果你`dissector`像这样改变你的功能，

```
function p_multi.dissector(buf,pkt,root)
        pkt.cols.protocol = "Aggregator"
        local len = buf(0,2):int()
        local t = root:add(p_multi,buf(0,len+2))
        t:add(f_len,buf(0,2)) --let Wireshark do the hard work
        t:add(f_text,buf(2,len)) --you've already defined their labels etc.
end 
```

你会得到想要的行为。已经为您的字段定义了标签“文本”和“长度”，因此无需在第 15 行和第 16 行再次提供它们。

# php - Symfony 2 + Doctrine 2 + 继承

> ID：10401570
> 
> 赞同：6
> 
> 时间：2012-05-01T17:23:53.850
> 
> 标签：php, inheritance, symfony, doctrine, doctrine-orm

我正在寻找使用 Symfony 2 框架中内置的 Doctrine 2 来解决以下数据库继承问题的解决方案。这就是我想做的...

![在此处输入图像描述](../Images/7d9b961863630e7a1019567cb9728860.png)

我想创建两个与抽象类 Hodiny 具有相同接口的表（UredniHodiny、KonzultacniHodiny）。这就是我正在尝试的方式

```
<?php

// src/CvutPWT/ImportBundle/Entity/Hodiny.php
namespace CvutPWT\ImportBundle\Entity;

use Doctrine\ORM\Mapping as ORM;

/**
 * @ORM\MappedSuperclass
 */
abstract class Hodiny
{

    /**
     * @ORM\Id
     * @ORM\Column(type="integer")
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    protected $id;

    /**
     * @ORM\ManyToOne(targetEntity="Osoba")
     */
    protected $osoba;

    /**
     * @ORM\ManyToOne(targetEntity="Mistnost")
     */
    protected $mistnost;

    /**
     * @ORM\Column(type="datetime")
     */
    protected $zacatek;

    /**
     * @ORM\Column(type="datetime")
     */
    protected $konec;

}

<?php

// src/CvutPWT/ImportBundle/Entity/KonzultacniHodiny.php
namespace CvutPWT\ImportBundle\Entity;

use Doctrine\ORM\Mapping as ORM;

/**
 * @ORM\Entity
 * @ORM\Table(name="konzultacnihodiny")
 */
class KonzultacniHodiny extends Hodiny 
{

}

<?php

// src/CvutPWT/ImportBundle/Entity/UredniHodiny.php
namespace CvutPWT\ImportBundle\Entity;

use Doctrine\ORM\Mapping as ORM;

/**
 * @ORM\Entity
 * @ORM\Table(name="urednihodiny")
 */
class UredniHodiny extends Hodiny 
{

} 
```

现在，当我运行`php app/console doctrine:generate:entities CvutPWTImportBundle`Symfony 时，会从类 Hodiny 生成所有变量（更准确地说是列），作为两个子类的私有变量。现在，当我尝试创建这些表时，`app/console doctrine:schema:update --force`我遇到了`$id must be protected or weaker`. 当我手动更改此保护时，我可以创建表，但只有一列（id）。但这不是我所希望的。有人可以给我任何建议我做错了什么吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-03T13:50:28.283

这不是表继承。映射的超类只是映射继承。与您的最终实体相对应的表格不会以任何方式被依赖在一起。

如果您想要真正的表继承（单表或连接表），请使用：[http ://docs.doctrine-project.org/projects/doctrine-orm/en/2.0.x/reference/inheritance-mapping.html#single -表继承](http://docs.doctrine-project.org/projects/doctrine-orm/en/2.0.x/reference/inheritance-mapping.html#single-table-inheritance)

如果您仍想使用映射的超类，则必须将`@ORM\Id`定义放在两个最终类中。您**不能**将 id 放在映射的超类中。

# django - 有序列表在 Django 中不起作用

> ID：10401571
> 
> 赞同：0
> 
> 时间：2012-05-01T17:24:06.500
> 
> 标签：django

我试图在 HTML 中使用有序列表来列出我的查询列表中的项目，但由于某种原因没有发生排序。列表显示但没有排序。

这是我的 Django 代码，

```
<o1>
{% for t in teamrel %}
        <li> {{t.teamrelation}} </li>
{% endfor %}
</o1> 
```

这是我在 HTML 代码中的输出，

顾客关系团队 志愿者关系团队 志愿者关系团队

它没有被订购。

让我知道你的意见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T17:30:09.323

主要问题是您的代码示例似乎有一个`<o1>`标签 (o+ONE) 而不是`<ol>`(o+L)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T17:30:24.080

可能是因为`<o1>`应该`<ol>`。

否则，`QuerySet`需要通过电话正确订购`queryset.order_by('foo')`。无论无效标签如何，都应该对输出进行排序。

您可以打印`print queryset.query`以查看询问数据库的实际排序。

# android - 按下通知会删除 alertDialog

> ID：10401574
> 
> 赞同：0
> 
> 时间：2012-05-01T17:24:27.843
> 
> 标签：android, notifications, android-alertdialog

我有一个“奇怪”的问题。
我做了一个警报对话框，当蓝牙连接时出现，还做了一个通知，说明它，所以你现在会在应用程序在后台时看到它。当我在应用程序内时蓝牙连接时，一切都很好。也当应用程序在背景中（当通知声音时）并且我按下应用程序图标（在启动器上）或按下“最后使用”。一切都好。
但如果应用程序在后台（当通知声音时）并且我按下通知以启动应用程序，则警报对话框消失。当我按下后退按钮时重新出现......我找不到原因。我需要你的帮助来尝试指导我解决问题。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T09:11:08.100

我发现了问题。当您按下通知时，它创建了一个重复的活动...当您按下图标时，它转到 onresume .. 所以我在活动下添加了 android:launchMode="singleInstance" 的manifast，它可以工作...希望它有帮助任何人。

# c# - 当我尝试将它们添加到列表时，BlockingCollection 自动执行我的功能

> ID：10401576
> 
> 赞同：1
> 
> 时间：2012-05-01T17:24:32.150
> 
> 标签：c#, execute, blockingcollection

```
 var tasks0 = new BlockingCollection<object>(new ConcurrentQueue<object>());
            tasks0.Add(Fetch(APCounter));
            tasks0.Add(Decode(APCounter));
            tasks0.Add(ALURes(APCounter));
            tasks0.Add(Memory(APCounter));
            tasks0.Add(WriteB(APCounter));

            var tasks1 = new BlockingCollection<object>(new ConcurrentQueue<object>());
            tasks1.Add(Fetch(APCounter+1));
            tasks1.Add(Decode(APCounter + 1));
            tasks1.Add(ALURes(APCounter + 1));
            tasks1.Add(Memory(APCounter + 1));
            tasks1.Add(WriteB(APCounter + 1)); 
```

我不希望它执行现在添加的功能。稍后我将使用业务逻辑手动执行此操作。！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T17:37:23.727

如果我正确理解您想要存储在函数队列列表中的问题，稍后将调用该问题。如果是这种情况，您需要的是：

```
tasks0.Add(() => Fetch(APCounter)); 
tasks0.Add(() => Decode(APCounter)); 
```

等等 - 因为

```
tasks0.Add(Fetch(APCounter)); 
```

将调用的结果添加到`Fetch(APCounter)`，而

```
tasks0.Add(() => Fetch(APCounter)); 
```

添加一个委托调用`Fetch(APCounter)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T17:39:26.613

如果您尝试这样做，则不会将方法添加到列表中。您正在调用类似的方法`Fetch(APCounter)`，然后将该方法的结果添加到`BlockingCollection`.

尝试创建委托并将委托添加到集合中。

```
public delegate FetchFunction(int apCounter);
tasks0.Add(FetchFunction(APCounter);

// or using lambda expressions
tasks0.Add(() => Fetch(APCounter)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T18:05:19.177

正如其他人所说，您需要存储代表列表或类似的东西，才能做您想做的事。您正在执行这些函数，然后将结果存储在阻塞集合中。您需要做的第一件事是将阻塞集合上的泛型类型更改为：

```
//add tasks
//if the functions return a common object other than "object" then adjust this accordingly
var tasks0 = new BlockingCollection<Func<object>>();//defaults to using a ConcurrentQueue
tasks0.Add(()=>Fetch(APCounter));
tasks0.Add(()=>Decode(APCounter));
tasks0.Add(()=>ALURes(APCounter));
tasks0.Add(()=>Memory(APCounter));
tasks0.Add()=>(WriteB(APCounter)); 
```

然后实际执行功能：

```
//run tasks
object firstResult = tasks0.Take()();
object secondResult = tasks0.Take()();
//... 
```

# mysql - 如何获取由另一列分组的给定条件的两列计数？

> ID：10401578
> 
> 赞同：4
> 
> 时间：2012-05-01T17:24:44.047
> 
> 标签：mysql, sql

*数据库*：[**SQL 小提琴**](http://sqlfiddle.com/#!2/cdd98/1)

*需要查询*：返回每个保险公司的 25-35 岁女性和男性的人数。

*我的进步*：

```
CREATE VIEW MenInAge AS
SELECT p.pname,p.pid,p.cid
FROM Patient p
WHERE p.gender = 'm' and p.age between 25 and 35;

CREATE VIEW WomenInAge AS
SELECT p.pname,p.pid,p.cid
FROM Patient p
WHERE p.gender = 'f' and p.age between 25 and 35;

CREATE VIEW MenInAgeCount AS
SELECT m.cid, COUNT(m.pid) as c
FROM MenInAge m
GROUP BY m.cid;

CREATE VIEW WomenInAgeCount AS
SELECT w.cid, COUNT(w.pid) as c
FROM WomenInAge w
GROUP BY w.cid; 
```

如何为每个 InsuranceCompany.cid 显示 WomenInAgeCount.c 和 MenInAgeCount.c 列？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T17:33:42.653

*说明*：

您必须通过连接两个表中列上的记录来连接表`InsuranceCompanies`并`Patient`使用*LEFT OUTER JOIN*`cid` ，并且还必须应用过滤器以仅选择**25**至**35**岁之间的患者（包括那些边界值）。*CASE*语句仅检查患者是男性还是女性，并通过在值匹配时分配值 1 和如果值不匹配时分配值 0 来计算两个不同的列。最后，您必须按 cname 对结果进行分组，以按保险公司名称获取计数。

*案例说明*：

在 CASE 表达式中，查询状态 WHEN 性别字段值为**f将值 1 分配给***女性*列。值 1 是硬编码的，因为这意味着查询找到了与 gender='f' 记录匹配的 1 行，这也表示 1人。您也可以声明 ELSE 0，但它是隐含的，因此无需指定。此 CASE 表达式计算查询结果中的每条记录。最后，您将获得女性列包含 1 或 0 的所有行。当您将此列女性相加时，您将获得女性的总数，男性列的逻辑相同。

# 使用 COALESCE：

`COALESCE`这里用第二个参数中的给定值替换任何 NULL 值（在这种情况下为零）。

[**单击此处查看 SQL Fiddle 中的演示。**](http://sqlfiddle.com/#!2/cdd98/38)

*脚本*：

```
SELECT              ic.cname
                ,   COALESCE(SUM(CASE WHEN gender = 'f' THEN 1 END), 0) female
                ,   COALESCE(SUM(CASE WHEN gender = 'm' THEN 1 END), 0) male 
FROM                InsuranceCompanies ic
LEFT OUTER JOIN     Patient p
ON                  p.cid = ic.cid
AND                 age BETWEEN 25 AND 35
GROUP BY            ic.cname; 
```

*输出*：

```
CNAME      FEMALE MALE
---------- ------ ----
Clalit Inc    0    2
Harel Inc     2    0 
```

# 没有合并：

[**单击此处查看 SQL Fiddle 中的演示**](http://sqlfiddle.com/#!2/cdd98/39)

*脚本*：

```
SELECT              ic.cname
                ,   SUM(CASE WHEN gender = 'f' THEN 1 END) female
                ,   SUM(CASE WHEN gender = 'm' THEN 1 END) male 
FROM                InsuranceCompanies ic
LEFT OUTER JOIN     Patient p
ON                  p.cid = ic.cid
AND                 age BETWEEN 25 AND 35
GROUP BY            ic.cname; 
```

*输出*：

```
CNAME      FEMALE MALE
---------- ------ ----
Clalit Inc  NULL   2
Harel Inc     2   NULL 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T17:30:24.580

JOIN 怎么样？

```
SELECT I.cname, ISNULL(W.c,0) AS WomenCount, ISNULL(M.c,0) as MenCount
FROM InsuranceCompanies AS I
LEFT JOIN MenInAgeCount AS M ON M.cid = I.cid
LEFT JOIN WomenInAgeCount AS W ON W.cid = I.cid 
```

`LEFT JOIN`此处以防 Men 或 Women 视图不包含 InsuranceCompanies 表中每一行的条目。`ISNULL`适用于 SQL Server，但您可以根据需要为 MySQL、Oracle 进行修改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T17:31:12.210

这应该会给你一些帮助-

```
select count(pid) as numPatients, cid, gender
from patient
group by cid, gender 
```

# c++ - 运算符新字段值在多重继承中具有错误的偏移量

> ID：10401579
> 
> 赞同：0
> 
> 时间：2012-05-01T17:24:51.057
> 
> 标签：c++, operator-overloading, new-operator

使用 gcc/g++ 4.6.1 这是编译器错误还是语言功能？尽管编译器没有对我大喊大叫，但我想这至少是编译器的一个缺点。

我有一个运算符`new`重载的父类：

```
class C{ // just here to be faithful to the original code
  int y;
}

class A{
public:
  void* operator new(size_t enfacia_size, uint count){
      size_t total_size 
      = enfacia_size
      + item::size() * count; // the 'tail'
      ;
      this_type *new_pt = (this_type *)malloc(total_size);
      new_pt->count = count;
      return new_pt;
  }
  uint count;
}

class B : public C, public A{
public:
    int i;
}; 
```

对象本身是可变长度的，所以它需要知道它有多长。因此有一个`count`领域。在此调用中，计数位于偏移量 0 处：

```
...
new A *pt = new(10) A;  // offset_of(A,count)==0
new B *pt = new(10) B;  // offset_of(B,count)==4 
```

这是问题所在，在 operator 内部，无论是从父级调用还是从子级调用，它`new`的值总是写在偏移量 0 处。`count`那么，当用于继承时，程序会崩溃.. 静态方法和继承是否存在问题？这是怎么回事？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T19:20:06.723

您提出的解决方案通过在该类的生命周期之外访问非 POD 类的成员来调用未定义的行为。

阅读 C++2003 的§3.8，

> T 类型对象的生命周期开始于：
> 
> *   获得具有适合类型 T 的对齐和大小的存储，并且
> *   如果 T 是具有非平凡构造函数（12.1）的类类型，则构造函数调用已完成。

由于您的`B`对象有一个重要的构造函数，生命周期在`B`' 构造函数完成后开始。`A`的构造函数在 的构造函数完成之前运行`B`，因此在`B`.

> 在对象的生命周期开始之前，但在分配对象将占用的存储空间之后……任何指向对象将……所在的存储位置的指针都可以使用，但只能以有限的方式使用。... 如果对象 [*满足某些条件，而你的*]，则程序在以下情况下具有未定义的行为：
> 
> *   指针用于访问非静态数据成员或调用对象的非静态成员函数，或
> *   指针被隐式转换（4.10）为指向基类类型的指针，或者
> *   指针用作 static_cast (5.2.9) 的操作数（转换为 void* 或 void* 并随后转换为 char* 或 unsigned char* 时除外）。
> *   该指针用作 dynamic_cast (5.2.7) 的操作数。

因此，您提出的任何违反这四个条件之一的解决方案都会调用未定义行为。具体来说，您问题中的代码使用指针作为 a 的操作数`static_cast`，并使用它来访问非静态数据成员。

* * *

说了这么多，这里有一个程序，虽然没有由 C++ 标准定义，但对于您的特定编译器可能仍然有效。也就是说，这不是 C++ 程序，但它可能是 MSVC++ 程序或 G++ 程序：

```
#include <iostream>
#include <cstdlib>
class C{ // just here to be faithful to the original code
  int y;
};

template <class this_type>
class A {
public:
  void* operator new(size_t enfacia_size, unsigned int count){
      size_t total_size
      = enfacia_size
      + 42 * count; // the 'tail'
      ;
      this_type *new_pt = (this_type *)malloc(total_size);
      new_pt->count = count;
      return new_pt;
  }
  unsigned int count;
};

class B : public C, public A<B>{
public:
    int i;
};

int main () {
  B *b = new(10) B;
  std::cout << b->count << "\n";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T20:36:01.413

是的，多继承中的字段移动，这是一个显示移动字段的示例，其代码形式与原始示例相同。唯一显着的区别是，方法不是被称为“operator new”，而是称为“method”。在代码示例之后是显示字段移动的调试器输出，并且即使通过它移动了正确分配给该字段的值：

```
#include <cstddef>
#include <stdlib.h>
typedef unsigned int uint;

class C{ // just here to be faithful to the original code
  int y;
};

class A{
public:
  typedef A this_type;

  void* method(uint count){
    void *vp;
    vp = (void *)this;
    this_type *p;
    p = (this_type *)vp;
    p->count = count;   
  };

  uint count;
};

class B : public C, public A{
public:
    typedef B this_type;
    int i;
};

int main(){
  int j;

  A a;
  a.method(5);
  j++;

  B b;
  b.method(5);
  j++;

}; 
```

调试器输出：

```
(gdb) b main
Breakpoint 1 at 0x80484a1: file try_offsets_2.ex.cc, line 36.
(gdb) r
Starting program: /try_offsets_2 
Breakpoint 1, main () at try_offsets_2.ex.cc:36
(gdb) n
(gdb) 
$1 = (A *) 0xbffff758
(gdb) x /10x &a
0xbffff758: 0x00000005  0x003dbff4  0x08048500  0x003dbff4
0xbffff768: 0x00000000  0x0027d113  0x00000001  0xbffff804
0xbffff778: 0xbffff80c  0x0012eff4
(gdb) n
(gdb) x /10x &b
0xbffff74c: 0x003dc324  0x00000005  0x00296c55  0x00000005
0xbffff75c: 0x003dbff5  0x08048500  0x003dbff4  0x00000000
0xbffff76c: 0x0027d113  0x00000001
(gdb) 
```

请注意，在父项中位于偏移量 0 处的 5 在子项中位于偏移量 4 处。还要注意，尽管父方法被继承给子方法，但它的类型已更新，以便正确写入偏移量 4 处的字段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T18:02:57.913

这不可能奏效。`operator new`不知道正在分配的对象的类型。只有大小。由于您可以直接调用操作员，因此可能根本没有对象。

在每个派生类中定义`this_type`不同（我猜你在演示文稿中错过了这部分）不会影响它在基类方法中的含义。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-04T12:54:35.893

您正在对“由于继承而移动的字段”提出一些奇怪的主张，但没有发生这样的事情。

试试这个程序：

```
#include <iostream>
#include <stdint.h>

struct C
{
    int i;
};

struct A
{
    int count;

    void f()
    {
        uintptr_t pt = reinterpret_cast<uintptr_t>(this);
        uintptr_t pc = reinterpret_cast<uintptr_t>(&count);
        std::cout << "Offset of A::count within A is " << (pc - pt) << '\n';
    }
};

struct B : C, A
{
    void g()
    {
        uintptr_t pt = reinterpret_cast<uintptr_t>(this);
        uintptr_t pc = reinterpret_cast<uintptr_t>(&count);
        std::cout << "Offset of A::count within B is " << (pc - pt) << '\n';
    }
};

int main()
{
    A a;
    a.f();
    B b;
    b.f();
    b.g();
} 
```

这会产生：

```
Offset of A::count within A is 0
Offset of A::count within A is 0
Offset of A::count within B is 4 
```

无论您在 B 类型的对象或 A 类型的对象上调用 A::f 都没有关系，它仍然是 A::f 并且它仍然以固定偏移量访问 A:count。当您调用 B::g 时*，*该函数知道 A::count 成员与`this`

同样的事情发生在你的`operator new`，那个函数是 A 的成员并且对 B 一无所知。当你访问时，`this_type::count`你正在访问`A::count`。您将其称为 B 无关紧要，仅`A::operator new`存在（该函数并未`B::operator new`像您想象的那样被复制来生成）。

模板版本有效，因为类型`this_type`指的是 B 而不是 A，所以函数访问`B::count`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-01T19:26:20.003

基类和派生类之间的偏移量不同是正常的，尤其是在涉及多重继承时。每当指针从一种类型转换为另一种类型时，编译器都会提供不可见的修正来修改指针地址。

它必须是这样的，因为每个指针类型在它指向的对象类型上必须是一致的。`A* p1 = new A`并且`A* p2 = new B`必须对 p1 和 p2 使用相同的偏移量。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-03T07:15:57.177

这编译得很好：

```
#include <cstddef>
#include <stdlib.h>
typedef unsigned int uint;

class C{ // just here to be faithful to the original code
  int y;
};

class A{
public:
  typedef A this_type;

  void* operator new(size_t enfacia_size, uint count){
      size_t total_size 
    = enfacia_size
    + sizeof(int) * count; // the 'tail'
    ;
      this_type *new_pt = (this_type *)malloc(total_size);
      new_pt->count = count;
      return new_pt;
  };
  uint count;
};

class B : public C, public A{
public:
    int i;
};

int main(){
  B *b_pt = new(5) B;  
  uint j=0;
  j++;
}; 
```

这是gdb中显示的“问题”：

```
(gdb) b main
Breakpoint 1 at 0x80484e1: file try_offsets.ex.cc, line 32.
(gdb) r
Starting program try_offsets 
Breakpoint 1, main () at try_offsets.cc:32
(gdb) n
(gdb) p &(b_pt->count)
$1 = (uint *) 0x804a00c
(gdb) x/10 b_pt
0x804a008:  5   0   0   0
0x804a018:  0   0   0   0
0x804a028:  0   135129
(gdb) p b_pt
$2 = (B *) 0x804a008
(gdb) 
```

请注意，count 位于 0x804a00c，但分配给 count 时写入 0x804a008。现在有了 Rob 指出的变体，其中通过模板将这种类型设置为子项：

```
#include <cstddef>
#include <stdlib.h>
typedef unsigned int uint;

class C{ // just here to be faithful to the original code
  int y;
};

template<typename this_type>
class A{
public:

  void* operator new(size_t enfacia_size, uint count){
      size_t total_size 
    = enfacia_size
    + sizeof(int) * count; // the 'tail'
    ;
      this_type *new_pt = (this_type *)malloc(total_size);
      new_pt->count = count;
      return new_pt;
  };
  uint count;
};

class B : public C, public A<B>{
public:
    int i;
};

int main(){
  B *b_pt = new(5) B;  
  uint j=0;
  j++;
}; 
```

我们得到正确的行为：

```
(gdb) b main
Breakpoint 1 at 0x80484e1: file try_offsets.ex.cc, line 32.
(gdb) r
Starting program
Breakpoint 1, main () at try_offsets.cc:32
(gdb) n
(gdb) p &(b_pt->count)
$1 = (uint *) 0x804a00c
(gdb) x/10 b_pt
0x804a008:  0   5   0   0
0x804a018:  0   0   0   0
0x804a028:  0   135129
(gdb) 
```

不过有趣的是，当 this_type 设置为“A”时，使用此解决方案将无法编译：

```
class B : public C, public A<A>{
public:
    int i;
}; 
```

给出：

```
try_offsets.cc:26:31: error: type/value mismatch at argument 1 in template parameter list for ‘template<class this_type> class A’
try_offsets.cc:26:31: error:   expected a type, got ‘A’ 
```

我确定的解决方案：

```
#include <cstddef>
#include <stdlib.h>
typedef unsigned int uint;

class C{ // just here to be faithful to the original code
  int y;
};

class A{
public:
  typedef A this_type;

  A(uint count):count(count){;}

  void* operator new(size_t enfacia_size, uint count){
      size_t total_size 
    = enfacia_size
    + sizeof(int) * count; // the 'tail'
    ;
      this_type *new_pt = (this_type *)malloc(total_size);
      return new_pt;
  };
  uint count;
};

class B : public C, public A{
public:
    B(uint count):A(count){;}
    int i;
};

int main(){
  B *b_pt = new(5) B(5);  
  uint j=0;
  j++;
}; 
```

虽然这打破了旧的惯例。分配器在分配点上方写入分配的长度是正常的。也就是说，例如，delete/free 如何知道堆上的块有多长。此外，由于 operator delete 不能带参数，这就是我们获取信息的方式。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-04T23:42:19.470

这是另一个解决方案：

```
#include <cstddef>
#include <stdlib.h>

typedef unsigned int uint;

class C{ // just here to be faithful to the original code
  int y;
};

class A{
public:
  uint count;
};

class B : public C, public A{
public:
    int i;
};

template<typename T>
struct A_allocation_helper : T
{
  void* operator new(size_t enfacia_size, uint count){
    size_t total_size
      = enfacia_size
      + sizeof(int) * count; // the 'tail'
      ;
    T *new_pt = (T *)malloc(total_size);
    new_pt->count = count;
    return new_pt;
  };

};

int main(){
  B *b_pt = new(5) A_allocation_helper<B>;
  return b_pt->count;
}; 
```

现在进行内存分配的代码知道正确的类型，而不是由只知道基数的类型完成。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-05-05T00:38:27.740

此代码在转换为本地类型的方法中也有一个 void 指针：

```
#include <cstddef>
#include <stdlib.h>
typedef unsigned int uint;

class C{ // just here to be faithful to the original code
  int y;
};

class A{
public:
  typedef A this_type;

  void* method(uint count){
    void *vp;
    vp = (void *)this;
    this_type *p;
    p = (this_type *)vp;
    p->count = count;   
  };

  uint count;
};

class B : public C, public A{
public:
    typedef B this_type;
    int i;
};

int main(){
  int j;

  A a;
  a.method(5);
  j++;

  B b;
  b.method(5);
  j++;

}; 
```

它按预期工作：

```
(gdb) b main
Breakpoint 1 at 0x80484a1: file try_offsets_2.ex.cc, line 36.
(gdb) r
Starting program: /try_offsets_2 
Breakpoint 1, main () at try_offsets_2.ex.cc:36
(gdb) n
(gdb) 
$1 = (A *) 0xbffff758
(gdb) x /10x &a
0xbffff758:    0x00000005    0x003dbff4    0x08048500    0x003dbff4
0xbffff768:    0x00000000    0x0027d113    0x00000001    0xbffff804
0xbffff778:    0xbffff80c    0x0012eff4
(gdb) n
(gdb) x /10x &b
0xbffff74c:    0x003dc324    0x00000005    0x00296c55    0x00000005
0xbffff75c:    0x003dbff5    0x08048500    0x003dbff4    0x00000000
0xbffff76c:    0x0027d113    0x00000001
(gdb) 
```

您可以看到孩子的计数已设置。是的，我知道这是如何工作的，当然这是预期的结果。原因是，在调用 method() 时正确设置了“this”指针。

问题，这里的原始问题是 operator new 不会为孩子产生预期的结果，而是像父类型一样行事。然而，其中带有赋值的操作符 new 是在没有来自编译器的任何噪音的情况下继承的。

我认为，所有这一切的真正答案是 operator new 与其他方法的不同之处在于它没有传递 this 指针的幻像第一个操作数。以及上面提到的 nm 怎么可能呢，因为该对象还不存在。尽管类型定义已经存在，但编译器在多重继承中将类型传递给子方法的方式是通过幻像第一个操作数 this 指针，该指针已设置为指向对象中定义该方法的类型的正确区域.

如果编译器以 this 指针的方式为我们提供了 this_type，那么 operator new 可以通过强制转换 void * 来访问它创建的分配中的字段。这在许多情况下都非常有用。

但留给我的底线问题是，为什么编译器没有为非法赋值给出错误，然后生成代码，为子级生成错误值，如原始代码所示。（乔恩，是的，我给孩子打电话了 new ，它分配了作为父母的计数，没有警告等。公平地说，在任何普通程序员的眼中，这是一个意想不到的结果）。

# c++ - 将两个字符串加在一起创建一个新的 LPSTR

> ID：10401585
> 
> 赞同：1
> 
> 时间：2012-05-01T17:25:08.827
> 
> 标签：c++, winapi

此代码不可编译：

```
LPSTR a1 = "a1";
LPSTR lpResult = a1 + "a2"; 
```

如何获得指向“a1a2”字符串的长指针**lpResult ？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T17:35:16.677

一种选择是使用 std::string 连接。您还可以使用 Microsoft 的[StringCchCat](http://msdn.microsoft.com/en-us/library/windows/desktop/ms647518%28v=vs.85%29.aspx)函数。

这是一个例子：

```
#include <Strsafe.h>

//... later in your code:

LPSTR a1 = "a1";
LPSTR a2 = "a2";

TCHAR dest[ 5 ];
StringCchCopy(dest, 5, a1);  // copy "a1" into the buffer
StringCchCat(dest, 5, a2);   // concatenate "a2" into the buffer 
```

# php - 向 magento adminhtml 模块添加块

> ID：10401587
> 
> 赞同：0
> 
> 时间：2012-05-01T17:25:10.107
> 
> 标签：php, magento, adminhtml

我目前正在尝试简单地向自定义 Adminhtml 模块添加一个块。我能够显示块的内容，但它在页面顶部呈现灰色背景，然后带有设计和菜单的标准 magento 布局直接呈现在其下方。

我试图以正确的方式做事以学习最佳实践，并且正在关注书籍和教程以及 magento 核心，但到目前为止一直无法正确添加内容。

到目前为止，我有：

```
public function indexAction()
{
    $this->loadLayout();
    $this->_setTitle();
    $main_block = new Invent_General_Block_Info();
    echo $main_block->toHtml();
    //$this->_addContent($main_block);
    $this->renderLayout(); 
```

我可以看到在法师核心中这样做的一般方法是

```
/**
  * Append customers block to content
  */
    $this->_addContent(
        $this->getLayout()->createBlock('adminhtml/customer', 'customer')
    ); 
```

因为我已经创建了块 $main_block 对我来说 ->createBlock 没有意义，所以我不知道从这里做什么。

像往常一样感谢任何帮助。谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-03T11:39:04.913

我找到了解决这个问题的答案。

当然，它来自 Alan Storm。谢谢艾伦。线程在[这里](https://stackoverflow.com/questions/3513910/magento-custom-admin-module-is-blank/)找到！

所以为了解决这个问题，我所做的就是：

在 app/design/adminhtml/mythemename/info.phtml 中创建一个文件夹

然后在我的控制器操作中我只是做了：

```
$this->loadLayout();
    $this->_setTitle();
 $this->_addContent($this->getLayout()->createBlock('adminhtml/template')->setTemplate('shipment/info.phtml'));
    $this->renderLayout(); 
```

而且效果很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T18:28:35.337

如果它是您通过 CMS 创建的静态块，请使用它

```
/**
  * Append customers block to content
  */

$this->_addContent(
  $this->getLayout()
    ->createBlock('cms/block')
    ->setBlockId('{block_name}')
    ->toHtml() 
); 
```

# iphone - 使用不同的行数将 UITableview 部分刷新为一个

> ID：10401598
> 
> 赞同：0
> 
> 时间：2012-05-01T17:26:03.500
> 
> 标签：iphone, objective-c, xcode, uitableview

我最近一直在使用 UITableView。它被动态填充一次，然后当用户选择一个选项时，我希望列表更改为一个新选项。我正在使用一个包含 3 个部分的分组表，当您单击行时，这三个组需要重新填充不同数量的新行。**虽然当新部分中的行数与旧部分中的行数相同时，我的代码可以正常工作，但当该数字发生变化时它会崩溃。**有趣的是，它会等待崩溃，直到它尝试绘制以前存在的单元格之一（tableView 仍然认为该部分具有旧的行数，尝试绘制不再在我的模型对象中的单元格，并且所以我认为它崩溃是因为它引用了新数组中不存在的值。

它在这里崩溃：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath     *)indexPath{

UITableViewCell *cell = nil;

cell = [tableView dequeueReusableCellWithIdentifier:@"MyCell"];

if (cell == nil){

    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault
                                  reuseIdentifier:@"MyCell"];
}

if (indexPath.section==2){
//CRASH BELOW
    cell.textLabel.text = [NSString stringWithFormat:@"%@", (NSString *)[[[[storyArray objectAtIndex:pageNumber]getChoices] objectAtIndex:(unsigned long)indexPath.row]objectAtIndex:0]] ;
}
return cell;
} 
```

我用来重新加载表的功能在这里：

```
-(void)changePage:(int)pageChangeNumber{

NSLog(@"The page change! Changing to: %@",[[storyArray objectAtIndex:pageChangeNumber]getTitle]);
pageHeader.text=[[storyArray objectAtIndex:pageChangeNumber] getTitle];
pageBody.text=[[storyArray objectAtIndex:pageChangeNumber] getBody];

[myTableView reloadSections:[NSIndexSet indexSetWithIndex:0] withRowAnimation:UITableViewRowAnimationFade];

[myTableView reloadSections:[NSIndexSet indexSetWithIndex:1] withRowAnimation:UITableViewRowAnimationFade];

 [myTableView reloadSections:[NSIndexSet indexSetWithIndex:2] withRowAnimation:UITableViewRowAnimationFade];

   [myTableView reloadData];    
pageNumber=pageChangeNumber;
NSLog(@"Page Change Done");
} 
```

我还将 numberofRowsInSection 更改为动态...

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section{
    NSLog(@"Recounting Rows");
if (section==2){
    return [[[storyArray objectAtIndex:pageNumber]getChoices] count];
} else {
    return 0;
}

} 
```

当每个部分的行数发生变化时，我有什么想法可以让它工作吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T14:12:04.297

在更新表格视图的数据并调用 reloadSections 之前，您需要先调用`[myTableView beginUpdates]`，一旦完成`[myTableView endUpdates]`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T22:22:21.270

我不知道您遇到了什么崩溃，但是如果`numberOfSectionsInTableView:`or`tableView:numberOfRowsInSection:`方法在表自身重组时返回不同数量的行，我会遇到崩溃。

例如，UITableView 在重绘时（包括动画期间）多次调用这些方法。在我的后端，一些值在动画期间发生了变化。

在更改 UITableView 之前，我必须特别注意同步这些值

# x86-16 - 我们可以在汇编中使用 '\n' 吗？

> ID：10401599
> 
> 赞同：0
> 
> 时间：2012-05-01T17:26:15.527
> 
> 标签：x86-16, assembly

计算输入行中的字符数，如果按下回车则终止。

```
MOV AX, 1
MOV AL, 0
INPUT:  INT 21H
    INC AL
    CMP DL,'\n'
    JE OUT
    LOOP INPUT
OUT: 
```

在上面的代码中我使用了`\n`. 我很好奇我们是否可以使用它，或者我必须使用它的 ascii 代码？请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T17:29:47.450

这完全取决于您的汇编程序。可能是的，否则使用 ascii 表自己翻译它（`0x0A`或`10`）。

您可能应该尝试组装它，看看它是否有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T17:29:49.303

`'\n'`不是汇编语言常量。至少在大多数汇编语言中不是。

您必须使用正在使用的字符集直接转换它。您可以在几乎所有现代处理器上安全地假设 ASCII，因此`\n`在大多数操作系统上都是 10（十进制）。在 Windows 上，使用两个字符序列 13 和 10。

# arrays - 坐标纹理数组不适用于 glDrawElements

> ID：10401605
> 
> 赞同：0
> 
> 时间：2012-05-01T17:26:40.147
> 
> 标签：arrays, opengl, sdl, textures, cube

我的程序的目的是在每个面上加载和显示一个具有相同纹理的简单立方体。但问题是输出不是很好（只有 4 个面的纹理正确）。我在纹理数组中尝试了很多坐标组合，但大多数时候情况更糟。是否可以使用函数 glDrawElements 正确设置纹理？

```
#define OFFSET_BUFFER(bytes) ((GLfloat *)NULL + bytes)

GLfloat vertices[] =
{
    -1.0, -1.0, -1.0,
    1.0, -1.0, -1.0,
    1.0, 1.0, -1.0,
    -1.0, 1.0, -1.0,
    -1.0, -1.0, 1.0,
    1.0, -1.0, 1.0,
    1.0, 1.0, 1.0,
    -1.0, 1.0, 1.0,
};

GLubyte indices[] =
{
    0, 1, 2, 3,
    4, 7, 6, 5,
    0, 4, 5, 1,
    3, 2, 6, 7,
    0, 3, 7, 4,
    1, 5, 6, 2
};

GLfloat textures[] =
{
    0,0, 1,0, 1,1, 0,1,
    0,1, 1,1, 1,0, 0,0,
    /*//0,0, 1,0, 1,1, 0,1,
    //0,0, 1,0, 1,1, 0,1,
    0,1, 1,1, 1,0, 0,0,
    0,1, 1,1, 1,0, 0,0,
    //0,0, 1,0, 1,1, 0,1*/
};

int main(int argc, char *argv[])
{
    SDL_Init(SDL_INIT_VIDEO);
    SDL_WM_SetCaption("Texture Mapping",NULL);
    SDL_SetVideoMode(500, 500, 32, SDL_OPENGL);

    bool continuer = true;
    SDL_Event event;
    GLuint texCube;

    glClearDepth(1.0f);
    glClearColor(0.1f, 0.1f, 0.1f, 0.1f);
    glEnable(GL_DEPTH_TEST);
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    gluPerspective(70.0f, (float)500.0f / (float)500.0f, 1.0f, 3000.0f);
    glewInit();

    texCube = loadTexture("caisse.jpg");
    glBindTexture(GL_TEXTURE_2D, texCube);

    glEnable(GL_TEXTURE_2D);

    while (continuer)
    {
        glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

        SDL_WaitEvent(&event);
        switch(event.type)
        {
            case SDL_QUIT:
                continuer = false;
        }

        glMatrixMode(GL_MODELVIEW);
        glLoadIdentity();

        gluLookAt(0.0f, 0.0f, 3.0f, 0.0f, 0.0f, 0.0f, 0.0f, 1.0f, 0.0f);

        //Draw Cube ---------------------------------------

        glPushMatrix();
        glRotatef(45.0f, 1.0f, 1.0f, 0.0f);

        glEnableClientState(GL_VERTEX_ARRAY);
        glVertexPointer(3, GL_FLOAT, 0, vertices);

        glEnableClientState(GL_TEXTURE_COORD_ARRAY);
        glTexCoordPointer(2, GL_FLOAT, 0, textures);

        glDrawElements(GL_QUADS, 24, GL_UNSIGNED_BYTE, indices);

        glDisableClientState(GL_VERTEX_ARRAY);
        glDisableClientState(GL_TEXTURE_COORD_ARRAY);

        //-------------------------------------------------

        glPopMatrix();

        glFlush();
        SDL_GL_SwapBuffers();
    }

    glDisable(GL_TEXTURE_2D);
    SDL_Quit();

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T18:09:18.463

您正在尝试仅使用 8 个顶点。要获得正确的纹理，您必须使用 12 个独立的三角形，每个三角形都有“正确的”纹理坐标。问题是，当您尝试将平面图绘制到与球体同胚的东西上（例如，在您的情况下为立方体）时，您会遇到这样的“麻烦”。

因此，将立方体分成 12 个三角形（是的，它们将共享坐标）并使用其中一种映射方法计算纹理坐标。

有关映射详细信息，请参见此处：

[http://local.wasp.uwa.edu.au/~pbourke/texture_colour/texturemap/](http://local.wasp.uwa.edu.au/~pbourke/texture_colour/texturemap/)

您的问题“是否可以使用函数 glDrawElements 正确设置纹理？”的答案？是“是的，但您必须更改阵列的布局”。

更重要的是，这个网站上已经写了一个解决方案： [Problems texturing a cube](https://stackoverflow.com/questions/7818649/problems-texturing-a-cube)

顶点和纹理坐标的详细布局在这里：http: [//blogs.msdn.com/b/dawate/archive/2011/01/20/constructing-drawing-and-texturing-a-cube-with-vertices-in -xna-on-windows-phone-7.aspx](http://blogs.msdn.com/b/dawate/archive/2011/01/20/constructing-drawing-and-texturing-a-cube-with-vertices-in-xna-on-windows-phone-7.aspx)

# node.js - jquery 模板 - 如何使用 node.js 和 Express 编写非转义缓冲

> ID：10401610
> 
> 赞同：0
> 
> 时间：2012-05-01T17:27:06.090
> 
> 标签：node.js, express, jquery-templates

当我使用：

```
app.set('view options', {layout:true}); 
```

在 express 中，<%- body %> 是 ejs 的非转义缓冲，而 body!= body 是玉的非转义缓冲。我如何为 jquery 模板执行此操作？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-29T23:08:04.770

使用以下代码

```
p!= body 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T17:33:57.083

您是否尝试过直接调用变量？

```
<div>#{body}</div> 
```

# asp.net - ASP.NET 是 HttpCookie 一种持久或会话类型的 cookie

> ID：10401611
> 
> 赞同：0
> 
> 时间：2012-05-01T17:27:11.207
> 
> 标签：asp.net

即以下cookie

```
 HttpCookie cookie = Request.Cookies["Cookie"]; 
```

HttpCookie 是持久性或会话类型的 cookie

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T17:30:29.390

`expires`如果您附加一个属性，它只会在客户端上持续存在。否则，没有`expires`属性的 cookie 将被视为会话 cookie，并在浏览器会话结束时被删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T17:35:01.373

**会话 cookie**

*这些是临时 cookie 文件，在您关闭浏览器时会被删除。当您重新启动浏览器并返回创建 cookie 的网站时，该网站将无法识别您。如果网站使用这些功能，您将必须重新登录（如果需要登录）或再次选择您的偏好/主题。将生成一个新的会话 cookie，它将存储您的浏览信息，并在您离开网站并关闭浏览器之前一直处于活动状态。*

**持久性 cookie**

*这些文件保留在您浏览器的一个子文件夹中，直到您手动删除它们或您的浏览器根据持久性 cookie 文件中包含的持续时间删除它们。*

# jpa - intellij idea 社区版 + JPA

> ID：10401613
> 
> 赞同：0
> 
> 时间：2012-05-01T17:27:13.843
> 
> 标签：jpa, intellij-idea

每个人！

我是 intellij idea 的新手，所以我会问一个简短的问题：是否可以在 intellij idea 的社区版中使用持久性 api。

提前感谢您的回答！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T21:20:28.470

是的，您可以在社区版的项目中使用 JPA，但 IntelliJ IDEA 不会帮助您使用它。我认为您只会在配置和映射文件中获得基本的 xml 代码完成，但仅此而已。

# asp.net - asp:sqldatasource SelectCommandType="Text" 只有在将参数传递给 SQL 时才填充下拉菜单

> ID：10401615
> 
> 赞同：0
> 
> 时间：2012-05-01T17:27:25.457
> 
> 标签：asp.net

我正在尝试使用`asp:SqlDataSource`带有参数的 SQL 选择驱动。只要我没有任何论据，它就可以工作。我可以通过工作室运行参数化查询，它可以工作并返回行。如果我有任何论点，则`asp:View`不会呈现。

首先，当我通过 Studio 执行 SQL 时，代码返回 2 行。其次，我不希望它作为存储过程。部署问题。微笑，放手。:-)

* * *

```
<asp:DropDownList ID="lstUsers" runat="server" DataSourceID="sqlGetCSGUsersOnClaim" DataTextField="username" DataValueField="userID" />

<asp:SqlDataSource ID="sqlGetCSGUsersOnClaim" runat="server" ConnectionString="<%$ ConnectionStrings:SiteSqlServer%>" SelectCommandType="Text" SelectCommand="
SELECT aspnet_Users.UserId as userID, aspnet_users.username as username
FROM claims, aspnet_Users
WHERE claims.claimid = @ClaimID and 
(Claims.AdjusterID = aspnet_Users.UserId or Claims.SupervisorID = aspnet_Users.UserId )">
<SelectParameters>
   <asp:SessionParameter Name="ClaimID" SessionField="ClaimID" Type="Int32" DbType="Int32" />
</SelectParameters>
</asp:SqlDataSource> 
```

* * *

如果我删除`@ClaimID`and`SelectParameters`参数，则会填充下拉列表。只有在我添加参数后才会失败。

我究竟做错了什么？

在此先感谢，杰森

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T05:23:09.290

好吧，如果我删除了 SelectParameter 的 Type 和 DBType 属性，代码就可以工作了。叹....

我不知道，为什么。

# haproxy - Haproxy 将 www 重定向到非 www

> ID：10401621
> 
> 赞同：20
> 
> 时间：2012-05-01T17:28:05.713
> 
> 标签：haproxy

我目前正在使用 Haproxy 来平衡几个 express.js 节点。我知道可以使用 express.js 进行重定向，但我希望使用 Haproxy 进行重定向。

我想知道如何从 www.mysite.com 永久重定向到 mysite.com？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-05-01T19:07:16.813

```
redirect prefix http://example.com code 301 if { hdr(host) -i www.example.com } 
```

有关更多信息，请参阅[重定向前缀](http://cbonte.github.com/haproxy-dconv/configuration-1.4.html#4-redirect%20prefix)规则的文档。

如果您使用的是更新版本的 HAProxy，即至少 1.6，您可以使用更通用的语法，它允许重定向任何主机，而不仅仅是显式命名

```
http-request redirect prefix http://%[hdr(host),regsub(^www\.,,i)] code 301 if { hdr_beg(host) -i www. } 
```

在这里，我们使用[regsub](http://cbonte.github.io/haproxy-dconv/configuration-1.6.html#7.3.1-regsub)过滤器来动态生成不带`www.`前缀的正确主机名。

如果您想以相反的方式执行重定向，即添加一个`www`如果已经没有，则规则变得更简单：

```
http-request redirect prefix http://www.%[hdr(host)] code 301 unless { hdr_beg(host) -i www. } 
```

# c# - 如何覆盖 EmbeddedNavigator_ButtonClick (XtraGrid)

> ID：10401622
> 
> 赞同：2
> 
> 时间：2012-05-01T17:28:09.223
> 
> 标签：c#, .net, devexpress, xtragrid

我在 C#.NET 中编程并在我的应用程序中使用 XtraGrid 控件。

我在我的项目中使用 MyXtraGrid（自定义控件）。

现在我需要覆盖`EmbeddedNavigator_ButtonClick`自定义按钮：

1.  导出到 Excel
2.  打印等

但我不使用覆盖方法`EmbeddedNavigator_ButtonClick`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T07:28:48.867

[EmbeddedNavigator.CustomButtons](http://help.devexpress.com/#WindowsForms/DevExpressXtraEditorsNavigatorButtonsBase_CustomButtonstopic)属性提供对自定义按钮集合的访问。您可以将所有需要的按钮添加到此集合中。要覆盖[嵌入式导航器](http://help.devexpress.com/#WindowsForms/DevExpressXtraGridGridControl_EmbeddedNavigatortopic)按钮的行为或实现自定义按钮的反应，您应该处理[NavigatorBase.ButtonClick](http://help.devexpress.com/#WindowsForms/DevExpressXtraEditorsNavigatorBase_ButtonClicktopic)事件。这是一些示例代码：

```
class MyGridControl : DevExpress.XtraGrid.GridControl {
    public MyGridControl() {
        EmbeddedNavigator.ButtonClick += EmbeddedNavigator_ButtonClick;
    }
    //...
    void EmbeddedNavigator_ButtonClick(object sender, NavigatorButtonClickEventArgs e) {
        if(e.Button.ButtonType == DevExpress.XtraEditors.NavigatorButtonType.Delete) {
            // ... your code is here
            e.Handled = true;  // disable the default processing
        }
        if(e.Button.ButtonType == DevExpress.XtraEditors.NavigatorButtonType.Custom) {
            // ... your code is here
            e.Handled = true;  // disable the default processing
        }
    }
} 
```

# php - 单字算术？

> ID：10401623
> 
> 赞同：0
> 
> 时间：2012-05-01T17:28:18.913
> 
> 标签：php

由于一些编码问题，我需要发明自己的转换函数。我决定现在我将为我的角色创建一个转换表。

我想知道如何执行如下 C 代码之类的操作来打印字符 'a' 到 'z'：

```
char a='a';
for(i=0;i<26;i++){ 
  printf("%c",a);
} 
```

如何在 PHP 中做到这一点（按值递增字符值）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T17:30:15.553

包含字符的变量在 PHP 中可以像在 C 中一样递增：

```
<?php

for ($i = 'a'; $i < 'z'; ++$i) echo $i; 
```

此外，PHP 允许增加字符串：

```
$x = "abc";
echo ++$x; # abd 
```

您还可以使用`range`：

```
echo implode(range('a', 'z')); # abcdef.... 
```

[`chr`](http://www.php.net/manual/en/function.chr.php)最后，您可以通过和在字符和数字 ASCII 索引之间进行转换[`ord`](http://www.php.net/manual/en/function.ord.php)。分别。

# java - 无法使用 Java 中的 FTPClient 在 FTP 服务器上写入文件

> ID：10401625
> 
> 赞同：0
> 
> 时间：2012-05-01T17:28:30.090
> 
> 标签：java, android

我正在读取 FTP 服务器上的文件并将该数据写入另一个文件。但是在正确读取数据后，我无法将文件写入 FTP 服务器。

我可以使用“检索文件”检索文件，但不能使用该`storefile`功能存储文件。

我的代码是：

```
import java.io.BufferedReader;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.OutputStream;
import org.apache.commons.net.ftp.FTPClient;
import org.apache.commons.net.ftp.FTPFile;

public class FtpDemo {

public static void main(String args[]){

FTPClient client=new FTPClient();       
try {
                if(client.isConnected()){
                    client.disconnect();
                    Boolean isLog=client.logout();
                    System.out.println(isLog);
                }

                client.connect("server");
                Boolean isLogin=client.login("user","password");

                if(isLogin){
                    System.out.println("Login has been successfully");
                    FTPFile[] files=client.listFiles();
                    System.out.println("Login has been successfully"+files.length);
                    for(int i=0;i<files.length;i++){
                        if(files[i].getName().equals("rajesh.txt")){
                            System.out.println("match has been successfully");
                            InputStream is=client.retrieveFileStream("/rajesh.txt");
                            BufferedReader br=new BufferedReader(new InputStreamReader(is));
                            String str;
                            String content="";
                            str=br.readLine();

                            while(str!=null){
                                content+=str;
                                str=br.readLine();
                            }

                            System.out.println(content);
                            Boolean isStore=client.storeFile("/rajesh.txt",is);
                            System.out.println(isStore);
                        }
                    }
                }
            }
            catch(Exception e){
                System.out.println(e.getMessage());
            }
        }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T07:13:04.547

几点，`is`被读到最后`br`。新文件具有相同的名称。使用 Reader（文本）而不是 Stream（二进制数据）依赖于读取编码中的文本。最好使用流。

```
 InputStream is=client.retrieveFileStream("/rajesh.txt");
                        final String encoding = "UTF-8"; // "Cp1252"?
                        BufferedReader br=new BufferedReader(new InputStreamReader(is, encoding));
                        String str;
                        String content="";
                        str=br.readLine();

                        while(str!=null){
                            content+=str + "\n"; // "\r\n"?
                            str=br.readLine();
                        }
                        br.close();

                        InputStream is2 = new ByteArrayInputStream(content.getBytes(encoding));

                        System.out.println(content);
                        Boolean isStore=client.storeFile("/rajesh2.txt",is2); 
```

# c# - 验证文本框字段仅用于数字输入。

> ID：10401633
> 
> 赞同：9
> 
> 时间：2012-05-01T17:29:26.347
> 
> 标签：c#, validation, textbox

我创建了一个需要一些输入验证的基于表单的程序。我需要确保用户只能在距离文本框内输入数值。

到目前为止，我已经检查了 Textbox 里面有什么东西，但是如果它有一个值，那么它应该继续验证输入的值是数字：

```
else if (txtEvDistance.Text.Length == 0)
        {
            MessageBox.Show("Please enter the distance");
        }
else if (cboAddEvent.Text //is numeric)
        {
            MessageBox.Show("Please enter a valid numeric distance");
        } 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-01T17:31:01.533

您可以尝试[TryParse](http://msdn.microsoft.com/en-us/library/system.int32.tryparse.aspx)方法，该方法允许您将字符串解析为整数并返回一个布尔结果，指示操作成功或失败。

```
int distance;
if (int.TryParse(txtEvDistance.Text, out distance))
{
    // it's a valid integer => you could use the distance variable here
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-01T17:33:07.897

这是另一个简单的**解决方案**

```
try
{
    int temp=Convert.ToInt32(txtEvDistance.Text);
}
catch(Exception h)
{
    MessageBox.Show("Please provide number only");
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-01T17:54:54.107

如果要防止用户在 TextBox 中输入信息时输入非数字值，可以像这样使用 OnKeyPress 事件：

```
private void txtAditionalBatch_KeyPress(object sender, KeyPressEventArgs e)
        {
            if (!char.IsDigit(e.KeyChar)) e.Handled = true;         //Just Digits
            if (e.KeyChar == (char)8) e.Handled = false;            //Allow Backspace
            if (e.KeyChar == (char)13) btnSearch_Click(sender, e);  //Allow Enter            
        } 
```

如果用户使用鼠标（右键单击/粘贴）将信息粘贴到文本框中，则此解决方案不起作用，在这种情况下，您应该添加额外的验证。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-05-01T17:35:30.827

您可以通过客户端的*javascript或在文本框上使用一些正则表达式***验证器**来完成。

## Javascript

```
script type="text/javascript" language="javascript">
    function validateNumbersOnly(e) {
        var unicode = e.charCode ? e.charCode : e.keyCode;
        if ((unicode == 8) || (unicode == 9) || (unicode > 47 && unicode < 58)) {
            return true;
        }
        else {

            window.alert("This field accepts only Numbers");
            return false;
        }
    }
</script> 
```

## 文本框（带有固定的 ValidationExpression）

```
<asp:TextBox ID="TextBox1" runat="server"></asp:TextBox>
<asp:RegularExpressionValidator ID="RegularExpressionValidator6" runat="server" Display="None" ErrorMessage="Accepts only numbers." ControlToValidate="TextBox1" ValidationExpression="^[0-9]*$" Text="*"></asp:RegularExpressionValidator> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-01-02T11:47:57.703

你可以这样做

```
 // Check if the point entered is numeric or not
   if (Int32.TryParse(txtEvDistance.Text, out var outParse))
    {
       // Do what you want to do if numeric
    }
   else
    {
       // Do what you want to do if not numeric
    } 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-01-02T11:57:55.423

我同意 Int.TryParse 但作为替代方案，您可以使用正则表达式。

```
 Regex nonNumericRegex = new Regex(@"\D");
 if (nonNumericRegex.IsMatch(txtEvDistance.Text))
 {
   //Contains non numeric characters.
   return false;
 } 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-05-01T17:34:37.543

我有这个多用途的扩展：

```
 public static bool IsNumeric(this object value)
    {
        if (value == null || value is DateTime)
        {
            return false;
        }

        if (value is Int16 || value is Int32 || value is Int64 || value is Decimal || value is Single || value is Double || value is Boolean)
        {
            return true;
        }

        try
        {
            if (value is string)
                Double.Parse(value as string);
            else
                Double.Parse(value.ToString());
            return true;
        }
        catch { }
        return false;
    } 
```

它适用于其他数据类型。应该可以很好地完成您想做的事情。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-01-28T15:26:45.220

```
 if (int.TryParse(txtDepartmentNo.Text, out checkNumber) == false)
        {
            lblMessage.Text = string.Empty;
            lblMessage.Visible = true;
            lblMessage.ForeColor = Color.Maroon;
            lblMessage.Text = "You have not entered a number";
            return;
        } 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-12-13T15:15:55.860

这是一个解决方案，它允许仅使用减号的数字或带有减号和小数点的小数。以前的大多数答案都没有考虑到选定的文本。如果您将文本框的 ShortcutsEnabled 更改为 false，那么您也不能将垃圾粘贴到您的文本框中（它会禁用右键单击）。一些解决方案允许您在减号之前输入数据。请确认我已经抓住了一切！

```
 private bool DecimalOnly_KeyPress(TextBox txt, bool numeric, KeyPressEventArgs e)
        {
            if (numeric)
            {
                // Test first character - either text is blank or the selection starts at first character.
                if (txt.Text == "" || txt.SelectionStart == 0)
                {
                    // If the first character is a minus or digit, AND
                    // if the text does not contain a minus OR the selected text DOES contain a minus.
                    if ((e.KeyChar == '-' || char.IsDigit(e.KeyChar)) && (!txt.Text.Contains("-") || txt.SelectedText.Contains("-")))
                        return false;
                    else
                        return true;
                }
                else
                {
                    // If it's not the first character, then it must be a digit or backspace
                    if (char.IsDigit(e.KeyChar) || e.KeyChar == Convert.ToChar(Keys.Back))
                        return false;
                    else
                        return true;
                }
            }
            else
            {
                // Test first character - either text is blank or the selection starts at first character.
                if (txt.Text == "" || txt.SelectionStart == 0)
                {
                    // If the first character is a minus or digit, AND
                    // if the text does not contain a minus OR the selected text DOES contain a minus.
                    if ((e.KeyChar == '-' || char.IsDigit(e.KeyChar)) && (!txt.Text.Contains("-") || txt.SelectedText.Contains("-")))
                        return false;
                    else
                    {
                        // If the first character is a decimal point or digit, AND
                        // if the text does not contain a decimal point OR the selected text DOES contain a decimal point.
                        if ((e.KeyChar == '.' || char.IsDigit(e.KeyChar)) && (!txt.Text.Contains(".") || txt.SelectedText.Contains(".")))
                            return false;
                        else
                            return true;
                    }
                }
                else
                {
                    // If it's not the first character, then it must be a digit or backspace OR
                    // a decimal point AND
                    // if the text does not contain a decimal point or the selected text does contain a decimal point.
                    if (char.IsDigit(e.KeyChar) || e.KeyChar == Convert.ToChar(Keys.Back) || (e.KeyChar == '.' && (!txt.Text.Contains(".") || txt.SelectedText.Contains("."))))
                        return false;
                    else
                        return true;
                }

            }
        } 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-10-03T17:02:20.040

要检查该值是否为双精度：

```
private void button1_Click(object sender, EventArgs e)
{

    if (!double.TryParse(textBox1.Text, out var x))
    {
        System.Console.WriteLine("it's not a double ");
        return;
    }
    System.Console.WriteLine("it's a double ");
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-07-29T07:23:02.090

我知道这是一个老问题，但我想我还是应该提出我的答案。

以下代码片段遍历文本的每个字符并使用 IsNumber() 方法，如果字符是数字则返回 true，反之则返回 false，以检查是否所有字符都是数字。如果都是数字，则该方法返回 true。如果不是，则返回 false。

```
using System;

private bool ValidateText(string text){
    char[] characters = text.ToCharArray();

    foreach(char c in characters){
        if(!char.IsNumber(c))
            return false;
    }
    return true;
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-08-14T10:33:28.033

如下使用正则表达式。

```
if (txtNumeric.Text.Length < 0 || !System.Text.RegularExpressions.Regex.IsMatch(txtNumeric.Text, "^[0-9]*$")) {
 MessageBox.show("add content");
} else {
 MessageBox.show("add content");
} 
```

# php - 如何使用php检索json复选框的值

> ID：10401634
> 
> 赞同：0
> 
> 时间：2012-05-01T17:29:32.370
> 
> 标签：php, json, checkbox

我有一个 json 表单字段，其中有一个编码为复选框：

```
{"name":"Act","description":"Checkthis","type":"checkbox"} 
```

谁能告诉我 如果使用 php**检查它，如何获取此复选框的此值**

这是表格：

```
<iframe src='http://www.facebook.com/plugins/registration.php?
                    client_id=360&
                    redirect_uri=http://www.pingcampus.com/facebook_registration_plugin/store_user_data.php&
                    fields=[
                    {"name":"name"},
                    {"name":"email"},
                    {"name":"gender"},
                    {"name":"birthday"},
                    {"name":"captcha"},
                    {"name":"Act","description":"Checkthis","type":"checkbox"}
                    ]'
                    scrolling="auto"
                    frameborder="no"
                    style="border:none"
                    allowTransparency="true"
                    width="500"
                    height="600">
            </iframe> 
```

这是PHP代码：

```
<?php
        define('FACEBOOK_APP_ID', '');
        define('FACEBOOK_SECRET', '');

        // No need to change function body
        function parse_signed_request($signed_request, $secret) {
            list($encoded_sig, $payload) = explode('.', $signed_request, 2);

            // decode the data
            $sig = base64_url_decode($encoded_sig);
            $data = json_decode(base64_url_decode($payload), true);

            if (strtoupper($data['algorithm']) !== 'HMAC-SHA256') {
                error_log('Unknown algorithm. Expected HMAC-SHA256');
                return null;
            }

            // check sig
            $expected_sig = hash_hmac('sha256', $payload, $secret, $raw = true);
            if ($sig !== $expected_sig) {
                error_log('Bad Signed JSON signature!');
                return null;
            }

            return $data;
        }

        function base64_url_decode($input) {
            return base64_decode(strtr($input, '-_', '+/'));
        }

        if ($_REQUEST) {
            $response = parse_signed_request($_REQUEST['signed_request'],
                            FACEBOOK_SECRET);
            /*
            echo "<pre>";
            print_r($response);
            echo "</pre>"; // Uncomment this for printing the response Array
            */

            echo $_POST["Act"];

            $name = $response["registration"]["name"];
            $email = $response["registration"]["email"];
            $password = $response["registration"]["password"];
            $gender = $response["registration"]["gender"];
            $dob = $response["registration"]["birthday"];
            $phone = $response["registration"]["phone"];
            $act1 = $response["registration"]["Act"];

      // Connecting to Database

            mysql_connect('', '', '') or die(mysql_error());
            mysql_select_db('pingcampus');

            $result = mysql_query("INSERT INTO usxxx set 

            name='$name',
            email='$email',

            gender='$gender',
            act='$act'
             ");
            if ($result) {

                // User successfully stored
                // Redirect to some page
            } else {
                echo mysql_error();

                // Redirect to error page
            }
        } else {
            echo '$_REQUEST is empty';
        }
        ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T17:42:01.450

```
<?php
if(isset($_POST["Act"])){
  $act = $_POST["Act"];
  if(!empty($act)){
    // if Act is checked
  }
  else{
    //Act not checked
  }
}
?> 
```

或添加`value`到：

```
{"name":"Act","description":"Checkthis","type":"checkbox", "value":"1"} 
```

并这样做：

```
 <?php
    if(isset($_POST["Act"])){
      $act = $_POST["Act"];
      if($act == 1){
        // if Act is checked
      }
      else{
        //Act not checked
      }
    }
    ?> 
```

# c++ - 在 boost::multi_array 中以字节表示步幅

> ID：10401639
> 
> 赞同：1
> 
> 时间：2012-05-01T17:29:56.420
> 
> 标签：c++, boost, boost-multi-array

我有一个被读取为短裤的二维原生 C 数组，我希望将 a 映射`boost::multi_array_ref`到它的一部分，但将其表示为浮点数。有没有办法以字节为单位设置步幅（而不是数据大小的倍数）？

# java - MouseJointDef libgdx - 像愤怒的小鸟一样画一条轨迹线

> ID：10401644
> 
> 赞同：4
> 
> 时间：2012-05-01T17:30:10.050
> 
> 标签：java, libgdx, box2d

在 libgdx 游戏中

我想 touchDown 然后拖动某处，然后在释放 (touchUp) 时根据与目标身体的距离和方向施加方向力。当您触地时，目标身体保持静止，然后在触地时沿所需轨迹施加力。

（非常类似于愤怒的小鸟——当你拿着弹弓时，你可以看到目标身体的虚线轨迹——我也想做同样的事情）

所以我想这可能不是最难做的事情，但考虑到一些选项，我倾向于使用 MouseJointDef，但它会立即施加力（即目标立即移动 - 我希望它保持静止，然后一旦发生修饰事件然后施加力）

绘制轨迹的最简单方法是什么？我也在使用 Box2D。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-05T13:11:42.033

创建一个继承类的`InputAdapter`类，然后创建它的一个实例并注册它以监听触摸输入。

```
 Gdx.input.setInputProcessor(inputAdapter); 
```

有 3 种方法可以处理触摸事件`touch_down`，您必须重写它们`touch_dragged`。`touch_up`

在`touch_down`中，检查触摸位置是否在鸟区。如果是，则使布尔标志为真。

在`touch_dragged`中，检查上面的标志，如果为真，计算触摸位置相对于小鸟射击中心的距离和射击角度。

在`touch_up`中，您可以通过调用以计算出的数量进行拍摄

```
 body2shoot.applyLinearImpulse(impulse, body2shoot.getWorldCenter()); 
```

无需`MouseJointDef`移动`body2shoot`. 只需将`body2shoot`触摸位置的变换设置为在每个渲染周期中拖动即可。

为了计算轨迹，我写了一个这样的类：

```
public class ProjectileEquation
{
public float gravity;
public Vector2 startVelocity = new Vector2();
public Vector2 startPoint = new Vector2();

public ProjectileEquation()
{   }

public float getX(float t)
{
    return startVelocity.x*t + startPoint.x;
}

public float getY(float t)
{
    return 0.5f*gravity*t*t + startVelocity.y*t + startPoint.y;
}
} 
```

并且为了绘制它，我只设置了`startPoint`and`startVelocity`然后在一个循环中我`t`递增地给出一个（时间）并调用`getX(t)`and `getY(t)`。

# java - 编辑 .txt 文件 Java

> ID：10401645
> 
> 赞同：1
> 
> 时间：2012-05-01T17:30:11.553
> 
> 标签：java, input

我需要编写一个 Java 程序，它将控制台中输入的信息写入 .txt 文件。如果 .txt 文件已经存在，则必须打开它并在另一行写入附加信息。如果新的“升降机”不存在 .txt 文件，它将创建 .txt 并将其写入。基本上我不知道如何为输入的每个名称创建一个新的 .txt 以及如何编辑它，如果人的 .txt 已经存在。我该怎么做呢？

```
import java.io.IOException;
import java.io.PrintWriter;
import java.util.Random;
import java.util.Scanner;

public class MeetPrinter {

    public static void getInfo() {

        Scanner scanner = new Scanner(System.in);
        int question;
        String firstName;
        String lastName;
        int squat;
        int bench;
        int lift;
        String meetName;
        do {

            System.out.println("Enter first name: ");
            firstName = scanner.next();

            System.out.println("Enter Last Name: ");
            lastName = scanner.next();

            System.out.println("Enter new Meet Name: ");
            meetName = scanner.next();

            System.out.println("Enter max squat weight in kg: ");
            squat = scanner.nextInt();

            System.out.println("Enter max bench press in kg: ");
            bench = scanner.nextInt();

            System.out.println("Enter max deadlift in kg: ");
            lift = scanner.nextInt();

            System.out
                    .println("Enter '1' to enter more lifters or '2' if you are done entering.");
            question = scanner.nextInt();
        } while (question == 1);

        try{
            PrintWriter out = new PrintWriter("output.txt");
            Random randomGenerator = new Random();
            int randomInt = randomGenerator.nextInt(100000);
            out.println(lastName + ", " + firstName + " Record #: " + randomInt);
            out.println("");
            String meet = "Meet Name";
            String sq = "SQ Max";
            String bp = "BP Max";
            String sub = "SUB Total";
            String dl = "DL Max";
            String tot = "Total";
            out.printf("%20s %15s %18s %19s %18s %18s",meet ,sq,bp,sub,dl,tot);
            out.println("");
            out.printf("%20s", meetName);
            out.printf("%10d (%6.2f)", squat, squat * 2.2);
            out.printf("%10d (%6.2f)", bench, bench * 2.2);
            float subPounds = (float) ((float)(squat + bench) * 2.2);
            out.printf("%10d (%6.2f)", squat + bench, subPounds);
            out.printf("%10d (%6.2f)", lift, lift * 2.2);
            float tPounds = (float) ((float)(squat + bench + lift) * 2.2);
            out.printf("%10d (%6.2f)", squat + bench + lift, tPounds);
            out.close();
        }catch(IOException e){
            e.printStackTrace();
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T17:34:50.670

**更新**

改变

```
PrintWriter out = new PrintWriter("output.txt"); 
```

至

```
FileWriter out = new FileWriter("output.txt", true); 
```

如果`true`文件存在，它将告诉 FileWriter 附加到文件，这正是您想要做的。

这是[FileWriter](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/FileWriter.html)的 javadoc 。

FileWriter 可以选择写入字符串，这就是您所做的。

也像 twain249 建议的那样，对路径做一些事情......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T18:07:33.917

**Java文件操作**

```
File file  = new File("<file name>");
BufferedWriter writer = null;

if(file.exists()){ //Check existence check 
writer = new BufferedWriter(new FileWriter(toFile,true)); 
//bytes will be written to the end of the file rather than the beginning
}else{
file.createNewFile() //creating new file
writer = new BufferedWriter(new FileWriter(toFile)); 
}
BufferedWriter writer = new BufferedWriter(writer);
writer.write(...);
---or----
PrintWriter out
   = new PrintWriter(new BufferedWriter(writer));
out.println(...); 
```

# jquery - jQuery UI 对话框 - 与 javascript 函数的链接

> ID：10401648
> 
> 赞同：1
> 
> 时间：2012-05-01T17:30:18.140
> 
> 标签：jquery, jquery-ui-dialog

是否可以在调用 javascript 函数的 jquery 对话框中有一个链接？像这样的东西 -

```
var msg-dialog = $('#dialog-msg');
msg-dialog .html("Please click < a href='javascript:void(0)' onclick='javascript:reload();'>here</a> to reload.");
msg-dialog('open');

 function reload() {
      // do something.
      alert('test');
    } 
```

该链接在对话框中显示得很好，但单击它不会做任何事情。我错过了什么？我还想关闭函数中的对话框。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T17:38:37.800

假设您有适当的库，这将开箱即用：

```
<html>
<head>
<link href="jqueryUI/css/ui-lightness/jquery-ui-1.8.19.custom.css" rel="stylesheet" type="text/css">
<script src="jquery-1.7.1.js"></script>
<script src="jqueryUI/js/jquery-ui-1.8.19.custom.min.js"></script>

<script type="text/javascript">
function doSomething() {
    $('#dialog').dialog('close');
}

$(document).ready(function() {
    $("#dialog").dialog();
    $("#dialog").html("<a href=\"#\" onclick=\"doSomething();\">Call doSomething() function!</a>");
});
</script>

</head>
<body>
<div id="dialog"></div>

</body>

</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T17:40:55.393

`msg-dialog`根据 ECMAScript 5.1 / Unicode 6.1 是无效变量。

```
var msg_dialog = $('#dialog-msg');
msg_dialog .html("Please click <a href='javascript:void(0)' onclick='javascript:reload();'>here</a> to reload.");
msg_dialog.dialog(); // notice this 
```

并且在 a 之前**有**`< a href='...'>here</a>`一个空格应该是**`<a href='...'>here</a>`**

 **[**演示。**](http://jsfiddle.net/heera/RL23U/2/)

[**Javascript 变量名验证器。**](http://mothereff.in/js-variables#%E0%B2%A0_%E0%B2%A0)**

# c# - C# 中带有列表的自定义属性只需要访问每个项目的列表

> ID：10401655
> 
> 赞同：0
> 
> 时间：2012-05-01T17:30:28.390
> 
> 标签：c#, asp.net, xml

我有一个名为 Questions 的自定义属性，代码如下。

```
public class Questions
{
    private List<Question> _q = new List<Question>();

    public List<Question> Question
    {
        get { return _q; }
    } 
}

public class Question
{
    public string Text { get; set; }
    public string Name { get; set; }
    public string Type { get; set; }
    public string Answer { get; set; }
    private List<string> _Options = new List<string>(); 

    public List<string> Option {
      get { return _Options; }
    }

} 
```

然后我用下面的代码填充属性

```
 XmlDocument doc = new XmlDocument();
    Question q = new Question();
    Questions qs = new Questions();
    doc.Load(string.Format(@"questions.xml"));
    XmlNodeList list = doc.SelectNodes("/questions/question");
    foreach (XmlNode node in list)
    {

            q.Text = node.SelectSingleNode("text").InnerText;
            q.Type = node.SelectSingleNode("type").InnerText;
            q.Name = node.SelectSingleNode("name").InnerText;
            XmlNodeList options = doc.SelectNodes("/questions/question/options");
            foreach (XmlNode option in options)
            {
                q.Option.Add(option.SelectSingleNode("option").InnerText);
            }
            load.Visible = false;
            qa.Visible = true;

            qs.Question.Add(q);
            DisplayQuestion(qs);

    } 
```

现在，当我尝试使用下面的代码访问它时，我没有得到我期望的输出。因此，这就是我需要帮助的地方。示例 XML 位于底部

```
 Label1.Text = q.Question[CurrentQ].Text;
                for (int i = 0; i < q.Question[CurrentQ].Option.Count; i++)
                {
                    CheckBoxList1.Items.Add(q.Question[CurrentQ].Option[i]);
                } 
```

XML:

```
<?xml version="1.0"?>
<questions>
  <question>
    <num>1</num>
    <type>radio</type>
    <text>Do you like cake?</text>
    <options>
      <option>Yes</option>
      <option>No</option>
      <option>Sometimes</option>
    </options>
    <name>cake</name>
  </question>
  <question>
    <num>2</num>
    <type>dropdown</type>
    <text>Do you like TV?</text>
    <options>
      <option>Yes</option>
      <option>No</option>
      <option>Sometimes</option>
    </options>
    <name>tv</name>
  </question>
  <question>
    <num>3</num>
    <type>checkbox</type>
    <text>What do you like?</text>
    <options>
      <option>Cake</option>
      <option>TV</option>
      <option>Flipper Reruns</option>
    </options>
    <name>flipper</name>
  </question>
</questions> 
```

和输出：

你喜欢什么？

是的

是的

蛋糕

是的

是的

蛋糕

是的

是的

蛋糕

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T17:48:57.653

您正在选择选项节点，而不是循环内部的`doc`当前节点。`node`

这个表达

```
doc.SelectNodes("/questions/question/options"); 
```

产量

```
<options>
  <option>Yes</option>
  <option>No</option>
  <option>Sometimes</option>
</options>
<options>
  <option>Yes</option>
  <option>No</option>
  <option>Sometimes</option>
</options>
<options>
  <option>Cake</option>
  <option>TV</option>
  <option>Flipper Reruns</option>
</options> 
```

从这个选项组列表中，您总是选择每个组的第一个选项！

试试这个

```
node.SelectNodes("options/option"); 
```

* * *

一切都放在一起

```
foreach (XmlNode node in list) {
    Question q = new Question(); // As RoXaS pointed out!
    ...
    XmlNodeList options = node.SelectNodes("options/option");
    foreach (XmlNode option in options) {
        q.Option.Add(option.InnerText);
    }
    ...
    qs.Question.Add(q);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T17:56:54.357

答案很简单。错误在下面的代码中。

```
XmlDocument doc = new XmlDocument();
Question q = new Question();
Questions qs = new Questions();
doc.Load(string.Format(@"questions.xml"));
XmlNodeList list = doc.SelectNodes("/questions/question");
foreach (XmlNode node in list)
{

        q.Text = node.SelectSingleNode("text").InnerText;
        q.Type = node.SelectSingleNode("type").InnerText;
        q.Name = node.SelectSingleNode("name").InnerText;
        XmlNodeList options = doc.SelectNodes("/questions/question/options");
        foreach (XmlNode option in options)
        {
            q.Option.Add(option.SelectSingleNode("option").InnerText);
        }
        load.Visible = false;
        qa.Visible = true;

        qs.Question.Add(q);
        DisplayQuestion(qs);

} 
```

C# 通过引用自动工作（意味着指向对象的指针而不是复制它）。所以在上面的声明中你声明 `Question q = new Question();` 然后你填写它并将它添加到你的列表中并再次填写它。这意味着只有一个问题被实例化，因此结果都是一样的。

```
XmlDocument doc = new XmlDocument();

Questions qs = new Questions();
doc.Load(string.Format(@"questions.xml"));
XmlNodeList list = doc.SelectNodes("/questions/question");
foreach (XmlNode node in list)
{
        Question q = new Question(); // <--- Look here

        q.Text = node.SelectSingleNode("text").InnerText;
        q.Type = node.SelectSingleNode("type").InnerText;
        q.Name = node.SelectSingleNode("name").InnerText;
        XmlNodeList options = doc.SelectNodes("/questions/question/options");
        foreach (XmlNode option in options)
        {
            q.Option.Add(option.SelectSingleNode("option").InnerText);
        }
        load.Visible = false;
        qa.Visible = true;

        qs.Question.Add(q);

}
DisplayQuestion(qs); //<-- And here 
```

这样，每当一个新问题被实例化并添加到列表中而不是被覆盖时。因为在您的 questionList 中，每个条目都只是指向您拥有的问题对象的一个​​实例的指针。

哦，为什么我把它`DisplayQuestion(qs);`放在那里？因为您不想一遍又一遍地绘制整个列表，对吗？

确保您的 Displayquestion 函数遍历每个问题并绘制正确的控件

亲切的问候罗哈斯，我希望这会有所帮助

# sql - SQL 计算记录的不同值，但过滤一些重复

> ID：10401661
> 
> 赞同：0
> 
> 时间：2012-05-01T17:30:48.190
> 
> 标签：sql, sql-server-2008, distinct, survey

我有一个 MS SQL 2008 调查响应表，我需要生成一些报告。该表相当基本，它有一个自动编号键、一个响应人的用户 ID、一个日期，然后是每个单独问题的一堆字段。大多数问题都是多项选择，响应字段中的数据值是该选择的简短 varchar 文本表示。

我需要做的是计算每个选择选项的不同响应的数量（即对于问题 1，10 人回答 A，20 人回答 B，等等）。这并不过分复杂。然而，不同的是，有些人已经多次参加调查（因此他们将拥有相同的用户 ID 字段）。对于这些回复，我应该只在我的报告中包含最新数据（基于调查日期字段）。对于拥有多条记录的用户，排除旧调查记录的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T17:49:02.503

由于您没有向我们提供您的数据库架构，因此我不得不做出一些假设，但您应该能够使用 row_number 来识别用户进行的最新调查。

```
with cte as 
    (
         SELECT 
              Row_number() over (partition by userID, surveyID order by id desc) rn,
              surveyID 
          FROM 
              User_survey
    )
SELECT 
       a.answer_type,
       Count(a.anwer) answercount
FROM
      cte 
      INNER JOIN Answers a 
      ON cte.surveyID  = a.surveyID 

 WHERE
      cte.rn = 1
 GROUP BY 
     a.answer_type 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T17:44:25.003

也许不是最有效的查询，但怎么样：

从 my_table 组中选择 userid, max(survey_date) by userid

然后您可以在同一张表上进行内部连接以获取其他数据。

# c++ - 截止日期计时器到期，现在怎么办？

> ID：10401662
> 
> 赞同：1
> 
> 时间：2012-05-01T17:30:49.260
> 
> 标签：c++, boost-asio

我正在查看[http://www.boost.org/doc/libs/1_44_0/doc/html/boost_asio/example/timeouts/async_tcp_client.cpp中的 asio 示例](http://www.boost.org/doc/libs/1_44_0/doc/html/boost_asio/example/timeouts/async_tcp_client.cpp)

这是我真正难以理解的内容：

1.  为什么handle_read会再次回调start_read？
2.  计时器到期时会发生什么？我没有看到提供给计时器的回调例程。

> void start_read()
> { // 设置读取操作的截止日期。截止日期_.expires_from_now(boost::posix_time::seconds(30));
> 
> ```
> // Start an asynchronous operation to read a newline-delimited message.
> boost::asio::async_read_until(socket_, input_buffer_, '\n',
>     boost::bind(&client::handle_read, this, _1)); 
> ```
> 
> }
> 
> void handle_read(const boost::system::error_code& ec)
> { if (stopped_) return;
> 
> ```
> if (!ec)
> {
>   // Extract the newline-delimited message from the buffer.
>   std::string line;
>   std::istream is(&input_buffer_);
>   std::getline(is, line);
> 
>   // Empty messages are heartbeats and so ignored.
>   if (!line.empty())
>   {
>     std::cout << "Received: " << line << "\n";
>   }
> 
>   start_read();
> }
> else
> {
>   std::cout << "Error on receive: " << ec.message() << "\n";
> 
>   stop();
> } 
> ```
> 
> }

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T17:38:55.060

> 为什么handle_read会再次回调start_read？

如果没有，客户端只会读取一次套接字，然后再也不读取。因此，在成功读取时，客户端想要再次尝试读取。这使得永久读取套接字。

> 计时器到期时会发生什么？我没有看到提供给计时器的回调例程。

代码位于源文件的顶部：

```
deadline_.async_wait(boost::bind(&client::check_deadline, this)); 
```

`check_deadline()`如果截止日期已过，该函数将关闭套接字。

# meteor - 在流星中动态插入模板

> ID：10401665
> 
> 赞同：8
> 
> 时间：2012-05-01T17:31:00.167
> 
> 标签：meteor

好的，所以我在自己的名为 myApp.html 的文件中找到了我的模板。我的模板代码如下

```
<template name="initialInsertion">
  <div class="greeting">Hello there, {{first}} {{last}}!</div>
</template> 
```

现在我想在单击按钮时将此模板插入 DOM。我已经在 DOM 中呈现了我的按钮，并且我有一个与其相关的点击事件，如下所示

```
Template.chooseWhatToDo.events = {
  'click .zaButton':function(){
     Meteor.ui.render(function () {
       $("body").append(Template.initialInsertion({first: "Alyssa", last: "Hacker"}));
     })
  }
} 
```

现在显然 $("body").append 部分是错误的，但返回 Template.initialInsertion... 不会将该模板插入 DOM。我试过放一个partia {{> initialInsertion}}，但这只是错误，因为我还没有第一组和最后一组......任何线索？多谢你们

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2014-08-23T20:44:02.317

# 在流星 1.x 中

```
'click .zaButton':function(){
   Blaze.renderWithData(Template.someTemplate, {my: "data"}, $("#parrent-node")[0])
 } 
```

### 在流星 0.8.3

```
'click .zaButton':function(){
   var t = UI.renderWithData(Template.someTemplate, {my: "data"})
   UI.insert(t, $(".some-parrent-to-append"))
 } 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-01T20:17:27.320

第一个和最后一个最终会进入 Meteor.Collection 吗？

如果没有，我知道的最简单的方法是将数据放入会话中：

```
Template.chooseWhatToDo.events = {
    'click .zaButton' : function () {
         Session.set('first', 'Alyssa');
         Session.set('last', 'Hacker');
    }
} 
```

然后你会定义：

```
Template.initialInsertion.first = function () {
  return Session.get('first');
}

Template.initialInsertion.last = function () {
  return Session.get('last');
}

Template.initialInsertion.has_name = function () {
  return Template.initialInsertion.first() && Template.initialInsertion.last();
} 
```

最后，像这样调整您的 .html 模板：

```
<template name="initialInsertion">
    {{#if has_name}}
        <div class="greeting">Hello there, {{first}} {{last}}!</div>
    {{/if}}
</template> 
```

这是与您的问题完全相反的解决方案，但它似乎是“流星方式”。（基本上，不用担心自己操作 DOM，只需包含会话、集合和模板系统。）顺便说一句，我还是 Meteor 的新手，所以如果这不是“Meteor 方式”，请告诉我:-)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-30T01:51:13.717

我认为您可能想在附加语句中使用 Meteor.render 。另外，请注意，如果您将数据传递到模板中，则必须将 Template.initialInsertion 包装在匿名函数中，因为这是 Meteor.render 所期望的。我正在做类似的事情，似乎正在工作：

```
Template.chooseWhatToDo.events = {
  'click .zaButton':function(){
    $("body").append(Meteor.render(function() {
      return Template.initialInsertion({first: "Alyssa", last: "Hacker"})
    }));
  }
} 
```

希望这可以帮助！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-03-30T18:18:00.037

这里的许多答案都会遇到新的 Blaze 引擎的问题。这是一个在 Meteor 0.8.0 中使用 Blaze 的模式。

```
//HTML
<body>
  {{>mainTemplate}}
</body>

//JS Client Initially
var current = Template.initialTemplate;
var currentDep = new Deps.Dependency;

Template.mainTemplate = function()
{
  currentDep.depend();
  return current;
};

function setTemplate( newTemplate )
{
    current = newTemplate;
    currentDep.changed();
};

//Later
setTemplate( Template.someOtherTemplate ); 
```

[本节Meteor 文档](http://docs.meteor.com/#deps_dependency)中的更多信息

# c++ - const ref和const指针之间的区别，c ++

> ID：10401669
> 
> 赞同：2
> 
> 时间：2012-05-01T17:31:08.333
> 
> 标签：c++, pointers, reference, constants

我想知道 C++ 中的 const ref 和 const 指针有什么区别。当我声明某个东西是 const ref 时，我可以改变它的价值吗？还是 const 在对象上？因为我知道 const 指针意味着你不能改变 POINTER 但你可以改变它指向的 VALUE。

例如：

```
const char& a; // ?
const char* a; // pointer is const 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T17:41:02.313

> 弗雷德 const&x;

这意味着 x 为 Fred 对象起别名，但 x 不能用于更改该 Fred 对象。

> 弗雷德常数* p;

Fred const* p 的意思是“p 指向一个常量 Fred”：Fred 对象不能通过 p 改变。

> 弗雷德*常数 p;

Fred* const p 的意思是“p 是一个指向 Fred 的 const 指针”：你不能改变指针 p，但是你可以通过 p 改变 Fred 对象。

* * *

可以结合最后一个来获得：

> 弗雷德 const* const p;

Fred const* const p 的意思是“p 是一个指向常量 Fred 的常量指针”：不能改变指针 p 本身，也不能通过 p 改变 Fred 对象。

有关此的更多信息，请访问此[链接](http://www.parashift.com/c++-faq-lite/const-correctness.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T17:38:47.890

我更喜欢这样写：`char const * a`vs. `char * const a`。

这使您可以从右向左读取：`char const * a`is:`a`是指向常量的指针`char`，并且`char * const a`is:`a`是指向 a 的常量指针`char`。如果我阅读其他代码，我只记得`const char* a = char const* a`.

回答您问题的另一部分： *当我声明某事物为 const ref 时，我可以更改它的 VALUE 吗？* 人们误用术语 const ref 实际上表示对常量的引用（因为常量引用没有意义）。因此， const ref`const char& a`意味着您*无法*更改该值。但是，如果您实际上的意思是您想要一个恒定的参考，`char& const a`那么您*可以*更改该值并且该`const`部分没有任何区别。

对于指针，`const char* a`意味着您不能更改`a`指向的值。与此相比，`char* const a`这意味着您无法更改指针，但可以更改指向的值`a`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-01T17:35:13.930

`const char* a; // pointer is const`

错了，这是一个指向常量的指针。这个：

`char* const a; // pointer is const`

是一个常量指针。

# c++ - 编写专门用于类及其子类的函数模板

> ID：10401676
> 
> 赞同：0
> 
> 时间：2012-05-01T17:31:28.580
> 
> 标签：c++, templates, sfinae

我正在尝试编写一个函数模板。一个版本应该用于不满足另一个版本标准的所有类型；当参数是给定类的基类或该类本身时，应使用其他版本。

我尝试过重载`Base&`，但是当类派生自 时`Base`，它们使用通用的，而不是特定的。

我也尝试过这种 SFINAE 方法：

```
struct Base { };

struct Derived : public Base { };

struct Unrelated { };

template<typename T>
void f(const T& a, bool b = true) {
    cout << "not special" << endl;
}

template<typename T>
void f(const Base& t, bool b = is_base_of<Base, T>::value) {
    cout << "special" << endl;
}

Base b;
Derived d;
Unrelated u;

f(b); f(d); f(u); 
```

但是所有这些都打印“不特殊”。我不擅长 SFINAE，我可能只是做错了。我怎样才能写出这样的函数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T17:40:39.420

首先，这些都不会调用“特殊”`f`重载，因为`T`不能从函数参数中推断出来。它的第一个参数需要是类型`T`：

```
void f(const T& t, bool b = is_base_of<Base, T>::value) 
```

一旦完成，请注意“特殊”重载并没有真正使用 SFINAE 来影响重载解析： `is_base_of<T, U>::value`总是有一个值：它是`true`or `false`。要影响重载决议，您需要使用`enable_if`，它根据布尔值有条件地定义类型。

此外，两个重载都需要使用 SFINAE：如果`T`从基类派生（或者是基类），则必须启用“特殊”重载，并且只有`T`不是从基类派生时才必须启用“非特殊”重载，否则会出现重载解析的歧义。

这两个重载应声明并定义为：

```
template<typename T>
void f(T const& a, typename enable_if<!is_base_of<Base, T>::value>::type* = 0)
{
    cout << "not special" << endl;
}

template<typename T>
void f(T const& t, typename enable_if<is_base_of<Base, T>::value>::type* = 0)
{
    cout << "special" << endl;
} 
```

最后，请注意这里没有专业化。这两个函数命名`f`为*重载*。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T17:37:37.987

这是一个简单的 C++03 方法：

```
namespace detail // implementation details, users never invoke these directly
{
    template<bool B>
    struct f_impl
    {
        template<typename T>
        static void f(T const& t) { std::cout << "not special\n"; }
    };

    template<>
    struct f_impl<true>
    {
        static void f(Base const& t) { std::cout << "special\n"; }
    };
}

template<typename T>
void f(T const& t)
{
    detail::f_impl<is_base_of<Base, T>::value>::f(t);
} 
```

[现场演示](http://ideone.com/LD2Ex)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T17:48:22.617

使用重载的一种方法是这样的：

```
#include <iostream>

using namespace std;

struct Base { };

struct Derived : public Base { };

struct Unrelated { };

void f(...) {
    cout << "not special" << endl;
}

void f(const Base& t) {
    cout << "special" << endl;
}

int main(){ 
    Base b;
    Derived d;
    Unrelated u;

    f(b); 
    f(d);
    f(u);

    return 0;
} 
```

结果：

```
special
special
not special 
```

采用可变参数列表的重载将采用任何类型的参数，但始终被认为不如任何其他有效的重载适用。

# asp.net-mvc - VS与 Html.TextBox

> ID：10401677
> 
> 赞同：3
> 
> 时间：2012-05-01T17:31:30.987
> 
> 标签：asp.net-mvc, asp.net-mvc-3, html.textbox

我在 asp.net 应用程序中工作，添加表单元素、验证和从 DB 填充数据等功能。

1.  我可以使用 ASP: 控件，但我想知道是否可以使用`HTML.TextBox`或`<input type="text">`

2.  如果我可以使用`<input type="text"`或者`Html.TextBox`使用它们与使用它们的优缺点是什么

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T17:33:04.713

忘记 ASP.NET MVC 中的服务器端控件。在 ASP.NET MVC 中包含的所有`runat="server"`内容都是一个很大的**NO 。**无论如何都不会在 Razor 中工作。没有优点和缺点。永远不要使用服务器端控件，因此没有什么可比较的。只需使用 HTML 帮助器，例如`Html.EditorFor`和`Html.TextBoxFor`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-01T17:34:31.967

如果您使用的是 ASP.NET MVC，那么手动输入 ( `<input type="text" />`) 或辅助扩展 ( `Html.TextBoxFor(x => x.SomeProperty)`) 将是您最好的选择，这实际上取决于您计划做什么。如果您正在制作的控件在您的元素上没有属性，则只需手动编写输入标签会容易得多。

永远不要`<asp:Checkbox ID="blah" runat="server" />`在 MVC 应用程序中使用。

# r - 将波形拟合到一组点并从中选择离散间隔

> ID：10401679
> 
> 赞同：0
> 
> 时间：2012-05-01T17:31:36.547
> 
> 标签：r, curve-fitting, waveform, spline, wavelet

我有一个 data.frame 的值，其中的样本间隔不准确。样本形成未知幅度和周期的振荡波。我想在每个确切的时间估计值。

```
 hours value
60 63.06667 22657
61 64.00000 21535
62 64.93333 20797
63 65.86667 20687
64 66.80000 20129
65 67.73333 19671
66 68.66667 19066
67 69.60000 19534
68 70.53333 19994
69 71.46667 19575
70 72.40000 21466 
```

RI 中有没有一种方法可以将曲线拟合到该数据集，然后在我的给定点（63、64、65、66 ...）对其进行采样？我知道`spline()`但不知道如何让它给我精确的“小时”整数值。

编辑：为了澄清，这是我希望拥有的结果数据框（带有“值”的虚拟条目）

```
 hours value
63.00000 22800
64.00000 21535
65.00000 20780
66.00000 20500
67.00000 20011
68.00000 ...
69.00000 ...
70.00000 ...
71.00000 ...
72.00000 ...
73.00000 ... 
```

重新创建数据的代码：

```
structure(list(hours = c(63.06666647, 63.9999998, 64.93333313, 
65.86666646, 66.79999979, 67.73333312, 68.66666645, 69.59999978, 
70.53333311, 71.46666644, 72.39999977), value = c(22657L, 21535L, 
20797L, 20687L, 20129L, 19671L, 19066L, 19534L, 19994L, 19575L, 
21466L)), .Names = c("hours", "value"), row.names = 60:70, class = "data.frame") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:05:10.460

使用 Sean 的答案，但使用该`splinefun`工具创建您自己的插值函数。运行在小时值向量上创建的函数，以计算这些精确值的插值。页面上给出的示例`?splinefun`非常清楚。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T17:49:09.247

样条拟合的简单方法可能是：

```
D <- structure(list(hours = c(63.06666647, 63.9999998, 64.93333313, 
65.86666646, 66.79999979, 67.73333312, 68.66666645, 69.59999978, 
70.53333311, 71.46666644, 72.39999977), value = c(22657L, 21535L, 
20797L, 20687L, 20129L, 19671L, 19066L, 19534L, 19994L, 19575L, 
21466L)), .Names = c("hours", "value"), row.names = 60:70, class = "data.frame")

sm <- smooth.spline(D$hours, D$value, spar = 0.5) 
```

`spar`或您喜欢的任何平滑因子

```
plot(D$hours, D$value)
lines(sm, col = "red") 
```

您可以通过平滑样条访问每个小时的拟合 y 值

```
sm$y
[1] 22421.54 21682.93 21023.05 20469.70 19998.72 19634.10 19448.09 19506.52 19783.97
[10] 20251.24 20891.14 
```

# java - 如何以编程方式查找活动的清单选项？

> ID：10401684
> 
> 赞同：1
> 
> 时间：2012-05-01T17:32:22.467
> 
> 标签：java, android, android-manifest

您如何以编程方式找到我们在清单中声明的​​有关 Activity 的选项？例如，我想知道是否设置`android:configChanges`或`android:screenOrientation`设置为什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T18:17:47.623

用于`PackageManager`获取`ApplicationInfo`、`ActivityInfo`等与您正在寻找的信息。`configChanges`并且`screenOrientation`在`ActivityInfo`.

# c# - Visual Studio 找不到我引用的 DLL 的命名空间

> ID：10401685
> 
> 赞同：15
> 
> 时间：2012-05-01T17:32:26.473
> 
> 标签：c#, dll, namespaces

这是一个非常令人沮丧的问题。突然之间，我无法使用引用的 DLL。我在同一解决方案中添加了对项目的程序集引用，并且名称空间无法识别。我什至可以在对象查看器中看到引用。在没有客户端配置文件的情况下，我还将项目更改为 .NET 4 和 3.5，但无济于事。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-05-01T17:58:45.590

根据您的[屏幕截图](http://www.imagebam.com/image/8f730f187884338)，您在多个项目中引用了相同的“ServerLibrary”DLL，但是，看起来一个引用版本是在 .NET 3.5 中编译的，而另一个引用版本（它出现的项目引用）是在 .NET 中编译的。 NET 4\. 确保所有项目都指向相同版本的 DLL 并重新编译所有项目。那应该可以解决您的问题。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2015-10-19T06:17:10.810

我遇到了这个问题，我通过关闭视觉工作室、重新打开视觉工作室、清理和重建解决方案来解决它。这对我有用。在其他一些帖子上，我已经阅读了回复，并且大多数用户都通过这种方式解决了问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-10-10T18:52:15.940

我从使用它的路径中删除了 DLL 名称和命名空间。出于某种奇怪的原因，它起作用了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-10-08T13:10:26.150

这主要是因为在相同解决方案的不同项目中使用不同版本的相同包。我建议在所有项目中将所有包更新到最新版本。

> 右键单击具有降级包的项目->管理nuget包->单击更新选项卡->选中“*选择所有包*”复选框->单击*更新*

**对解决方案中的所有项目执行此操作。**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-08-13T16:43:00.173

确保类也是`public`类。当我找不到我的模型类时，我遇到了这个问题。愚蠢的错误，但被忽视时令人沮丧。

# php - 获取推文并在 Wordpress 中显示它们

> ID：10401688
> 
> 赞同：0
> 
> 时间：2012-05-01T17:32:42.437
> 
> 标签：php

所有，我有以下代码来检索一些推文：

```
if( ! $tweet ) {
    $url = "http://api.twitter.com/1/statuses/user_timeline.json?screen_name={$username}&count={$how_many}";
    $curl = curl_init();
    curl_setopt( $curl, CURLOPT_URL, $url );
    curl_setopt( $curl, CURLOPT_RETURNTRANSFER, 1 );
    $contents = curl_exec( $curl );
    curl_close( $curl );
    if ( ! empty( $contents ) ) {
        // Decode it.
        $tweet = json_decode( $contents );
        }
    }

    // Check to make sure we have a tweet and display it.
    if ( $tweet ) {
        do_action( 'themeblvd_twitter_slider', $tweet, $options, $username, $slider_id );
    } else {
        $output = 'Twitter timed out.';
    }
    return $output; 
```

然后我有以下代码将它们放入滑块中：

```
function themeblvd_twitter_slider_default( $tweet, $options, $username, $slider_id ) {
$tweet = (array)$tweet;
$classes = themeblvd_get_classes( 'slider_standard', true );
$classes .= ' hide-nav_standard';
$classes .= ' show-nav_arrows';
$classes .= ' show-pause_play';

//themeblvd_twitter_slider_js( $slider_id, $options );
?>
<div id="tb-slider-<?php echo $slider_id; ?>" class="slider-wrapper standard-slider-wrapper">
    <div class="slider-inner<?php echo $classes; ?>">   
        <div class="slides-wrapper slides-wrapper-<?php echo $slider_id; ?>">
            <div class="slides-inner">
                <div class="slider standard-slider flexslider">
                    <div class="tb-loader"></div>
                    <ul class="slides">
                                <?php
                                foreach($tweet as $t){
                                ?>
                                <li class="slide tight <?php echo $classes; ?>">
                                    <div class="slide-body">
                                        <div class="grid-protection">
                                        <?php
                                        echo '<span class="tweet-icon '.$options['icon'].'"></span>';
                                        echo '<a href="http://twitter.com/'.$username.'/status/'.$t->id_str.'" target="_blank">';
                                        echo $t->text;
                                        echo '</a>';
                                        ?>

                                        </div><!-- .grid-protection (end) -->
                                    </div><!-- .slide-body (end) -->
                                </li>
                                <?php
                                }
                                ?>
                    </ul>
                </div><!-- .slider (end) -->
            </div><!-- .slides-inner (end) -->                  
        </div><!-- .slides-wrapper (end) -->
    </div><!-- .slider-inner (end) -->
    <div class="design-1"></div>
    <div class="design-2"></div>
    <div class="design-3"></div>
    <div class="design-4"></div>                    
</div><!-- .slider-wrapper (end) -->
<?php
}
?> 
```

这段代码大约有 90% 的时间工作，并根据用户名等抓取推文。然而，大约 10% 的时间它只是旋转而不显示任何文本。有没有人看到我可以改进这个解决方案以便始终显示推文的任何东西或方法？从错误处理的角度来看，如果它无法检索推文，我是否可以添加任何内容以不显示它？

感谢您提前提供任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T21:55:23.917

您可以尝试检查 twitter 返回的内容是否实际上是推文列表。目前，您只检查 twitter 是否返回任何内容。

```
// Check to make sure we have a tweet and display it.
if ( is_array($tweet) && isset($tweet[0]->id_str) ) {
    do_action( 'themeblvd_twitter_slider', $tweet, $options, $username, $slider_id );
} else {
    $output = 'Twitter timed out.';
} 
```

# iphone - 如何使我的图像在滚动视图中可缩放？

> ID：10401689
> 
> 赞同：0
> 
> 时间：2012-05-01T17:32:50.420
> 
> 标签：iphone, objective-c, image, uiscrollview, zooming

我希望我的名为 bildfraga 的图像可以缩放。它被放置在称为滚动的滚动视图中。我可以滚动图片，但不能缩放它。

这是显示图像时的代码：

```
 bildfraga = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"dtk2.png"]];
scroll.contentSize = bildfraga.frame.size;
[scroll addSubview:bildfraga];
scroll.minimumZoomScale = 0.4;
scroll.maximumZoomScale = 4.0;
[scroll setZoomScale:scroll.minimumZoomScale];

- (UIView *)viewForZoomingInScrollView:(UIScrollView *)scroll{
return bildfraga;
 } 
```

但是当我尝试构建它时，我收到一条错误消息，例如：“使用未声明的标识符'viewForZoomingInScrollView'”。

提前致谢！

/一个菜鸟

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:18:33.113

这可能是问题所在。您是否在 .h 文件中添加了 UIScrollViewDelegate ？

# ios - 在 iOS 上的接口上调用 Web 服务

> ID：10401691
> 
> 赞同：2
> 
> 时间：2012-05-01T17:32:57.927
> 
> 标签：ios, cfnetwork

我有一个独特的情况，即使启用了 WiFi，我也需要调用运营商 3/4G 网络上的 Web 服务来验证某些数据。我查看了这篇文章[Binding NSURLConnection to specific interface](https://stackoverflow.com/questions/9379094/binding-nsurlconnection-to-specific-interface)讨论了可达性 API，但我需要使用特定接口发送。

有人对如何做到这一点有任何指示吗？

肯

# http - 通过 HTTP 隧道传输 RTSP

> ID：10401694
> 
> 赞同：0
> 
> 时间：2012-05-01T17:33:12.807
> 
> 标签：http, rtsp, bada

我需要在 2 个移动设备之间发送视频流。Bada 不支持 rtsp，所以我发现它可以通过 http 进行隧道传输。有人可以帮我提供一个关于如何开始的样本。我是 bada 应用程序开发的新手。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T20:59:45.280

*bada本身*没有 RTSP ，但它有套接字 - `Osp::Net::Sockets::Socket`. 我认为您最好的选择是研究 RTSP 的描述并通过套接字重新实现它。由于 bada 套接字在 API 方面与 POSIX 套接字不同（尽管我很确定 bada 套接字是 POSIX 套接字之上的一个薄层），因此您不太可能找到现成的开源 RTSP 库。

# javascript - js画布渐变缩放？

> ID：10401696
> 
> 赞同：1
> 
> 时间：2012-05-01T17:33:25.557
> 
> 标签：javascript, canvas, zooming

我一直在研究一个非常庞大的模拟，这意味着放大和缩小变得有必要。

我找到了一个很好的工作脚本，但是当模拟变大时，我发现它有问题......你放大的越多，步骤就越小，你缩小的越远，越大。

这是一个问题，因为无论您是什么缩放级别，我都需要步骤相同。

我现在使用的脚本是：

```
var total = 75,
    delta = e.detail ? e.detail * -120 : e.wheelDelta; //e is mouse event

this.zoomValue += (delta > 0) ? 1 : -1;

this.zoomRatio = 1 + (this.zoomValue / total) * 2;
e.preventDefault(); 
```

你可以在这里看到它的实际效果：http: [//clanpvp.com/sol](http://clanpvp.com/sol)（如果它不起作用，我要么在摆弄它，要么你正在使用 Internet Explorer）

稍后我使用 zoomRatio 来计算各种对象的位置。

谁知道放大的更好方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T09:50:49.160

anwser 实际上非常简单......但在我自己看到之前，我需要有人给我看。

解决方案是让它以指数方式缩放，所以

```
this.zoomRatio = Math.exp(this.zoomValue); 
```

诀窍，你可以做类似的事情

```
this.zoomRatio = Math.exp(this.zoomValue / 10); 
```

使其以较小的“步骤”滚动。

# mysql - MySQL UTF8 varchar 列大小

> ID：10401704
> 
> 赞同：5
> 
> 时间：2012-05-01T17:34:02.887
> 
> 标签：mysql, utf-8, varchar

MySQL 文档说，从 5.0 开始，varchar 长度指的是字符单位，而不是字节。但是，我最近遇到了一个问题，即在插入应该适合它指定的 varchar 列的值时，我收到了截断数据警告。

我在 v5.1 中用一个简单的表复制了这个问题

```
mysql> show create table test\G
*************************** 1\. row ***************************
Table: test
Create Table: CREATE TABLE `test` (
  `string` varchar(10) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8
1 row in set (0.00 sec) 
```

然后我插入了多个 10 个字符值，其中包含不同数量的 UTF8 字符

```
mysql> insert into test (string) values 
    -> ('abcdefghij'),
    -> ('ãáéíçãáéíç'),
    -> ('ãáéíç67890'),
    -> ('éíç4567890'),
    -> ('íç34567890');
Query OK, 5 rows affected, 4 warnings (0.06 sec)
Records: 5  Duplicates: 0  Warnings: 4

mysql> show warnings;
+---------+------+---------------------------------------------+
| Level   | Code | Message                                     |
+---------+------+---------------------------------------------+
| Warning | 1265 | Data truncated for column 'string' at row 2 |
| Warning | 1265 | Data truncated for column 'string' at row 3 |
| Warning | 1265 | Data truncated for column 'string' at row 4 |
| Warning | 1265 | Data truncated for column 'string' at row 5 |
+---------+------+---------------------------------------------+

mysql> select * from test;
+------------+
| string     |
+------------+
| abcdefghij |
| ãáéíç |
| ãáéíç |
| éíç4567 |
| íç345678 |
+------------+
5 rows in set (0.00 sec) 
```

我认为这表明 varchar 大小仍然以字节为单位定义，或者至少在字符单位中不准确。

问题是，我是否正确理解了文档，这是一个错误吗？还是我误解了文档？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-01T18:35:59.893

确实，VARCHAR 和 CHAR 的大小是以字符而不是字节为单位考虑的。

当我将连接字符集设置为 latin1（单字节）时，我能够重新创建您的问题。

确保在使用以下命令运行插入查询之前将连接字符集设置为 UTF8：

```
SET NAMES utf8 
```

如果您不这样做，一个两字节 UTF8 字符将作为两个单字节字符发送。

您可能会考虑更改您的[默认客户端字符集](http://dev.mysql.com/doc/refman/5.1/en/server-system-variables.html#sysvar_character_set_client)。

# c# - 下载代码在 Windows 7 中有效，但在 XP SP2 中无效？

> ID：10401706
> 
> 赞同：0
> 
> 时间：2012-05-01T17:34:22.637
> 
> 标签：c#, .net, network-programming

我编写了一段简单的代码，可以从 url 下载文件。此代码在 Windows 7 中完美运行，以良好的速度下载文件并保持显示下载进度的进度条。但是，当我从 Windows XP SP2 运行相同的代码时，它会产生一个 .NET IOException ，对我来说它为什么不起作用是没有意义的。它以相同的方式开始，正确完成第一次读取，然后在第二次尝试从流中读取时抛出以下异常：

```
 System.IO.IOException: Unable to read data from the transport connection: An operation on a
 socket could not be performed because the system lacked sufficient buffer space or because a
 queue was full. ---> 

 System.Net.Sockets.SocketException: An operation on a socket could not be  
 performed because the system lacked sufficient buffer space or because a queue was full
 at System.Net.Sockets.Socket.Receive(Byte[] buffer, Int32 offset, Int32 size, SocketFlags socketFlags)

 at System.Net.Sockets.NetworkStream.Read(Byte[] buffer, Int32 offset, Int32 size)
 --- End of inner exception stack trace ---
 at System.Net.ConnectStream.Read(Byte[] buffer, Int32 offset, Int32 size)
 at ServicePackChk.SrvPackChk.DownLoadServicePack(Boolean bWindowsXP)
 at ServicePackChk.SrvPackChk.CheckServicePackStatus()
 at ServicePackChk.Form1.Form1_Load(Object sender, EventArgs e)
 at System.Windows.Forms.Form.OnLoad(EventArgs e) 
```

代码 ：

```
 Uri uri;

        if (bWindowsXP)
            uri = new Uri("http://download.microsoft.com/download/d/3/0/d30e32d8-418a-469d-b600-f32ce3edf42d/WindowsXP-KB936929-SP3-x86-ENU.exe");
        else
            uri = null;

        WebRequest req = WebRequest.Create(uri);
        WebResponse resp = req.GetResponse();

        ProgBarForm pform = new ProgBarForm();

        updateEvent += new SrvPackChk.UpdateDownloaded(pform.UpdateProgBar);

        Stream stream = resp.GetResponseStream();
        ArrayList alBytes = new ArrayList();
        int nLen = (int)resp.ContentLength;

        pform.DownLoadSize = nLen;

        pform.Show();

        byte[] byExe = new byte[nLen];

        bool bMoreToDownload = true;

        FileStream fs = new FileStream(System.IO.Path.GetTempPath() + "XPSP3.exe", FileMode.Create);

        MessageBox.Show("Saving File to " + System.IO.Path.GetTempPath() + "XPSP3.exe");

        while (bMoreToDownload)
        {
            Application.DoEvents();

            int nRead = 0;

            nRead = stream.Read(byExe, 0, nLen);

            nDownloaded += nRead;

            updateEvent(nDownloaded);

            if (nDownloaded == nLen)
            {
                bMoreToDownload = false;
            }

            fs.Write(byExe, 0, nRead);
            fs.Flush();

            Application.DoEvents();
        }

        stream.Close();

        fs.Close(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T17:41:50.060

您下载的文件有超过 300 兆字节，您尝试从流中一口气读取。

您最好按块读取流，例如 4MByte 块。

# ruby-on-rails-3 - 从方法的值设置属性

> ID：10401712
> 
> 赞同：0
> 
> 时间：2012-05-01T17:34:48.323
> 
> 标签：ruby-on-rails-3, rails-models

我确定我只是做错了，有人可以指出我正确的方向吗？

我需要将 Effective_date 的值设置为修改后的格式日期

`effective_date`是请求的一个属性

```
class Request < ActiveRecord::Base

  def format_date=(format_date)
    date_a = format_date.split("/")
    month, day, year = date_a
    effective_date = Date.parse("#{year}-#{month}-#{day}")
  end

  def format_date
    effective_date
  end
end 
```

`Request.create(format_date: "04/21/2012")`没有将值设置为 effect_date

编辑：我想这没有意义，所以我会尝试更好地解释它：

我需要从 format_date （不是数据库中的列）设置有效日期（数据库中的列）的值。我正在使用 format_date 方法从 format_date 转换日期并将其存储到有效日期。如果这还不够信息，请告诉我。我不确定还要添加什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T22:11:27.573

如果`effective_date`是数据库中的列名，则更改很简单

```
def format_date=(format_date)
  date_a = format_date.split("/")
  month, day, year = date_a
  self.effective_date = Date.parse("#{year}-#{month}-#{day}")
end 
```

唯一的变化`effective_date =`是`self.effective_date =`。如果不在`self`那里添加，解释器就无法知道您是要设置一个局部变量调用`effective_date`还是调用该`effective_date=`方法。它假定局部变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T20:25:41.913

如果`effective_date`是属性但不在表中，那么我认为您需要实例变量。

```
class Request < AR::Base
  ...
  def format_date=(f_date)
    ...
    @effective_date = Date.parse("#{year}-#{month}-#{day}")
  end

  def format_date
    @effective_date
  end
end 
```

此外，使用名称作为方法名称（format_date）的局部变量也不好，这里没有错误，但有点误导。

更新：您可以在这里看到更多关于虚拟属性：

[http://railscasts.com/episodes/16-virtual-attributes?view=asciicast](http://railscasts.com/episodes/16-virtual-attributes?view=asciicast)

[http://railscasts.com/episodes/167-more-on-virtual-attributes](http://railscasts.com/episodes/167-more-on-virtual-attributes)

# solr - SOLR / LUCENE如何将列表扩展为多值字段？

> ID：10401715
> 
> 赞同：0
> 
> 时间：2012-05-01T17:34:52.427
> 
> 标签：solr, lucene

我正在从 RDBMS 索引。我在表中有一个带有管道分隔值的列，并且在索引时我想将这些值转换为多值字段。例如，

```
ColumnA (From RDBMS)
---------------------
apple|orange|banana 
```

我想将其转换为：

```
SOLR Index
------------
Fruit=apple
Fruit=orange
Fruit=banana 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T17:47:21.383

我使用 RegexTransformer，您可以指定 splitBy="|"

```
<field column="Fruit" splitBy="|" sourceColName="ColumnA"/> 
```

[http://wiki.apache.org/solr/DataImportHandler#RegexTransformer](http://wiki.apache.org/solr/DataImportHandler#RegexTransformer)

# xml - 从 xml 中提取元素时遇到问题

> ID：10401716
> 
> 赞同：1
> 
> 时间：2012-05-01T17:34:55.053
> 
> 标签：xml, c#-4.0, xml-parsing

我有一个这样的 xml：

```
 <?xml version="1.0" encoding="UTF-8"?>
   <InsertReceipts> 
<receipts xmlns:a="http://schemas.microsoft.com/2003/10/Serialization/Arrays">
    <a:string> 
    <![CDATA[ test]]>
     </a:string>
    </receipts> 
    </InsertReceipts> 
```

我想从这个 xml 中提取元素 a:string，但不知道怎么做？

当我使用 `XmlElement foo = (XmlElement)doc.SelectSingleNode("//a:string");`

它给出了一个解析错误

反馈和帮助表示赞赏

# php - 解析错误：语法错误，意外的 T_VARIABLE，期望 T_FUNCTION

> ID：10401722
> 
> 赞同：2
> 
> 时间：2012-05-01T17:35:28.347
> 
> 标签：php, ajax, syntax-error

有人可以告诉我我做错了什么吗？

我只想在特定房间在线显示用户。

下面的代码是调用我的 online.php 的函数，它在我的 chat.php 下，当我加载该函数也加载的页面时。

```
function whos_online() {
  if ( window.XMLHttpRequest ) {
    xmlhttp = new XMLHttpRequest();
  } else { 
    xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
  }
  xmlhttp.open("GET", "online.php?room=<?php $_SESSION['room']?>", false);
  xmlhttp.send();
  document.getElementById("whos_online").innerHTML = xmlhttp.responseText; 
} 
```

在线.PHP

这是我的 online.php 的内容

```
<link rel="stylesheet" type="text/css" href="style.css" />
<?php

    session_start();
    include 'db.inc.php';

    class WhosOnline{
        $rn = $_GET['room'];
        protected $get_status_query = "SELECT * FROM `online_users` WHERE `room` = '{$rn}'";
        public function DisplayUsers(){
            $get_current_status = mysql_query( $this->get_status_query );
            if( mysql_num_rows( $get_current_status ) != 0 ) {
                while( $row_status = mysql_fetch_array( $get_current_status ) ) {
                    if( $_SESSION['username'] == true ) {
                        echo "<div class='online_margin'>
                                <b>".base64_decode($row_status['username'])."</b>
                              </div>
                              <hr style='border: 0; border-top: solid 1px #D8D8D8;margin: 5px 10px 5px 10px;' />";
                    }
                }
            }
        }
    }

    $Online = new WhosOnline;
    $Online->DisplayUsers();
?> 
```

有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T17:40:08.737

> ```
> $rn = $_GET['room'];
> protected $get_status_query = "SELECT * FROM `online_users` WHERE `room` =     '{$rn}'"; 
> ```

这是一个你需要立即改掉的坏**习惯**。

```
protected function get_status_query($rn) {
  return "SELECT * FROM `online_users` WHERE `room` =     '". sanitize($rn) . "'";
}; 
```

实现`sanitize()`留给读者。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T17:42:17.550

你不能直接在类中初始化任何变量，试试这个

```
public $rn;
protected $get_status_query;

public __construct(){
      $this->rn = $_GET['room'];
      $this->get_status_query = "SELECT * FROM `online_users` WHERE `room` = '{$this->rn}'";
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T17:48:01.057

好的，即使这给出了一个错误：

```
class WhosOnline{
    public $rn = $_GET['room'];
} 
```

这也给出了一个错误：

```
$v = "Hi there";
class WhosOnline{
    public $rn = $v;
} 
```

该错误是因为您试图根据类定义中的另一个变量设置一个变量。您可以在构造函数中执行此操作。或者您可以基于 CONSTANTS 设置类成员（就像您对查询字符串所做的那样）。但是为什么不像这样重写你的 WhosOnline 方法：

```
public function DisplayUsers(){
    $get_current_status = mysql_query(
        "SELECT * FROM `online_users` WHERE `room` = '" 
            . mysql_real_escape_string($_GET['room']) . "'");
    if(mysql_num_rows($get_current_status)!=0){
        while($row_status = mysql_fetch_array($get_current_status)){
            if($_SESSION['username']==true){
                echo "<div class='online_margin'>   <b>".base64_decode($row_status['username'])."</b></div><hr style='border: 0; border-top:  solid 1px #D8D8D8;margin: 5px 10px 5px 10px;' />";
            }
        }
    }
} 
```

`$this->`这也将消除您在缺少引用时可能遇到的任何潜在错误。

# c++ - 将文本光标移动到特定的屏幕坐标？

> ID：10401724
> 
> 赞同：10
> 
> 时间：2012-05-01T17:35:43.807
> 
> 标签：c++, c, windows, console

如何在 C 或 C++ 中将光标设置在控制台上的所需位置？

我记得一个名为 的函数`gotoxy(x,y)`，但我认为它已被弃用。有没有其他选择？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-01T18:44:19.280

C 和 C++ 都没有屏幕或控制台的概念。他们只看到字节流，没有固有的显示特征。有许多第三方 API（例如[ncurses](http://en.wikipedia.org/wiki/Ncurses)）可以帮助您做到这一点。

如果您想要一个快速的解决方案*并且*您正在使用的终端理解[ANSI 转义序列](http://en.wikipedia.org/wiki/ANSI_escape_code)，那么您可以执行以下操作

```
printf("\033[%d;%dH", row, col); 
```

将光标移动到特定的行和列（左上角为 {1,1}）。不过，您最好使用 ncurses（或您平台的等价物）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-02T02:16:07.443

使用[SetConsoleCursorPosition](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686025%28v=vs.85%29.aspx)。

MSDN 库的同一部分中还有许多其他功能。其中一些可能也很有用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-01T17:53:39.680

如果您在谈论[ncurses](http://tldp.org/HOWTO/NCURSES-Programming-HOWTO/)库，您所追求的功能是`move (row, column)`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-05-25T19:44:26.010

我使用一个非常简单的方法。除非您真正深入到控制台应用程序中，否则您不需要过度了解 HANDLE 是什么，COORD 对象位于 windows.h 标准库中，并且有两个成员数据整数 X 和 Y。0,0 是左上角角和 Y 增加向下屏幕。您可以使用此命令并继续使用 std::cout<< 打印您需要的任何内容。

```
#include <windows.h>

int main(void){
//initialize objects for cursor manipulation
HANDLE hStdout;
COORD destCoord;
hStdout = GetStdHandle(STD_OUTPUT_HANDLE);

//position cursor at start of window
destCoord.X = 0;
destCoord.Y = 0;
SetConsoleCursorPosition(hStdout, destCoord);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-06-02T07:36:13.260

您可以使用它来将光标设置到屏幕上的特定坐标，然后只需使用 cout<< 或 printf 语句在控制台上打印任何内容：

```
#include <iostream>
#include <windows.h>

using namespace std;

void set_cursor(int,int);

int main()
{
     int x=0 , y=0;
     set_cursor(x,y);
     cout<<"Mohammad Usman Sajid";

     return 0;
}

void set_cursor(int x = 0 , int y = 0)
{
    HANDLE handle;
    COORD coordinates;
    handle = GetStdHandle(STD_OUTPUT_HANDLE);
    coordinates.X = x;
    coordinates.Y = y;
    SetConsoleCursorPosition ( handle , coordinates );
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-12-25T03:18:46.147

这是在stackoverflow上...

```
`#include <stdio.h>

// ESC-H, ESC-J (I remember using this sequence on VTs)
#define clear() printf("\033[H\033[J")

//ESC-BRACK-column;row (same here, used on terminals on an early intranet)
#define gotoxy(x,y) printf("\033[%d;%dH", (y), (x))

int main(void)
{
    clear();
    gotoxy(23, 12);
    printf("x");
    gotoxy(1, 24);
    return 0;
}` 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-10-22T21:33:27.807

对于 Windows：#include<windows.h>

> #define cursor(x, y) SetConsoleCursorPosition(GetStdHandle(STD_OUTPUT_HANDLE), (COORD){x, y})

对于 Linux：

> #define cursor(x,y) printf("\033[%d;%dH", x, y)

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-05-01T18:21:03.620

我想出了这个来设置光标。

```
#include <iostream>

void setPos(std::ostream& _os, const std::streamsize& _x, const std::streamsize& _y)
{
    char tmp = _os.fill();

    if(_y>0) {
            _os.fill('\n');
            _os.width(_y);
            _os << '\n';
    }
    if(_x>0) {
            _os.fill(' ');
            _os.width(_x);
            _os << ' ';
    }
    _os.flush();
    _os.fill(tmp);
}

int main(int argc, char **argv)
{
    setPos(std::cout, 5, 5);
    std::cout << "foo" << std::endl;
    return 0;
} 
```

要做更多事情，您需要对分辨率或类似[ncurses](http://tldp.org/HOWTO/NCURSES-Programming-HOWTO/)的库进行假设。

# asp.net - 从网格视图中读取下拉列表值

> ID：10401728
> 
> 赞同：0
> 
> 时间：2012-05-01T17:35:59.320
> 
> 标签：asp.net

我有一个带有下拉列表列的gridview，并且我启用了分页功能。问题是每次翻到下一页后，上一页下拉列表的选中值又回到默认值。

我试图用 包装代码`if(!ispostback)`，只有可用的第一页其他页面消失了

```
protected void Page_Load(object sender, EventArgs e)
    {
        if (!IsPostBack)
        {
            List<CPDEmployee> employeelist = (List<CPDEmployee>)Cache["EmployeeList"];

            unverifiedlist.DataSource = employeelist;
            unverifiedlist.AllowPaging = true;
            unverifiedlist.PageSize = 10;
            unverifiedlist.DataBind();
        }
    }
protected void PageSelect_SelectedIndexChanged(object sender, EventArgs e)
{
    int page = int.Parse(PageSelect.SelectedItem.Text);
    unverifiedlist.PageIndex = page;
    DataBind();
}

 <asp:GridView ID="unverifiedlist" runat="server" AutoGenerateColumns="false" AllowSorting="true" AllowPaging="true" ViewStateMode="Enabled">
                        <Columns><asp:TemplateField HeaderText="Options" >
                                <ItemTemplate>
                                    <asp:DropDownList ID="options" runat="server" AutoPostBack="true">
                                        <asp:ListItem Value="1">Verified</asp:ListItem>
                                        <asp:ListItem Value="0">Rejected</asp:ListItem>
                                    </asp:DropDownList>
                                </ItemTemplate>
                             </asp:TemplateField>
                    </Columns>
                    <PagerSettings Visible="false"/>            
        </asp:GridView>
<asp:DropDownList ID="PageSelect" runat="server" AutoPostBack="true" OnSelectedIndexChanged="PageSelect_SelectedIndexChanged"></asp:DropDownList> 
```

有谁知道如何解决它，我应该把ispostback放在哪里？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T18:15:52.603

您需要处理 OnRowDataBound 并以编程方式设置适当的元素。例子：

```
<asp:GridView ID="unverifiedlist" runat="server" 
   OnRowDataBound="unverifiedlist_RowDataBound" AutoGenerateColumns="false" 
    AllowSorting="true" AllowPaging="true" ViewStateMode="Enabled"> 
```

并实现类似的东西：

```
protected void unverifiedlist_RowDataBound(Object sender, GridViewRowEventArgs e)
{
  if(e.Row.RowType == DataControlRowType.DataRow)
  {
     ((DropDownList)e.Row.FindControl("options")).SelectedValue=((CPDEmployee)e.Row.DataItem).Unverified;

  }
} 
```

显然，假设您的业务对象上有一个名为 Unverified 的属性。你应该使用任何合适的。这只是一个例子。

**更新：**

由于网格内的下拉菜单是自动回发的，因此我会将 OnSelectedIndexChanged 的​​事件处理程序添加到网格内的下拉列表中。就像是：

```
<asp:DropDownList ID="options" runat="server" AutoPostBack="true" OnSelectedIndexChanged="options_SelectedIndexChanged">
  <asp:ListItem Value="1">Verified</asp:ListItem>
  <asp:ListItem Value="0">Rejected</asp:ListItem>
</asp:DropDownList> 
```

进而

```
protected void options_SelectedIndexChanged(object sender, EventArgs e)
{ 
    string selecteValue = ((DropDownList)sender).SelectedValue;
    //Now persist this value in the appropriate business object  
    //this is the difficult part because you don't know for which row in the gridview
    //you are changing this selection. You'll need to devise a way to pass an extra 
    //value (an Employee ID, I would imagine) that would allow you to grab the 
    // record from the List<CDPEmployee> and change the property to the new selection.
} 
```

# android - 在对话框中设置多个按钮

> ID：10401732
> 
> 赞同：0
> 
> 时间：2012-05-01T17:36:10.973
> 
> 标签：android, android-button, android-dialog

我按照教程向对话框添加按钮，对不起，忘记链接，这是我显示对话框的代码：

```
final Dialog dialog = new Dialog(MainActivity.this);
dialog.requestWindowFeature(Window.FEATURE_NO_TITLE);
dialog.setContentView(R.layout.about);
dialog.setCancelable(true);

Button buttonEmail = (Button) dialog.findViewById(R.id.aboutQuit);
buttonEmail.setOnClickListener(new OnClickListener() {
public void onClick(View v) {
     String inURL = "mailto:my@email.com";
     openWebURL(inURL);
}
});
Button buttonQuit = (Button) dialog.findViewById(R.id.aboutQuit);
buttonQuit.setOnClickListener(new OnClickListener() {
public void onClick(View v) {
     dialog.dismiss();
}
}); 
```

它有效，它显示对话框和所有但它只会设置一个按钮，这取决于我放置它们的顺序，我该如何解决这个问题，感谢您的时间'n'帮助，zeokila ;)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T17:43:27.367

您仅为 R.id.aboutQuit 按钮设置了两次 setOnClickListener() 。尝试正确更改 ID。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T17:38:34.647

首先，您在设置侦听器时遇到错误。以下行：

```
Button buttonEmail = (Button) dialog.findViewById(R.id.aboutQuit); 
```

得到的是退出按钮而不是电子邮件。您应该将 R.id.aboutQuit 更改为您的电子邮件按钮 ID。

对于另一个问题，您应该使用 ID R.layout.about 发布布局。

# wordpress - wordpress 中的主题目录路径

> ID：10401740
> 
> 赞同：2
> 
> 时间：2012-05-01T17:37:07.503
> 
> 标签：wordpress

我看到这个网站来获取文件所在的主题路径：http: [//codex.wordpress.org/Function_Reference/get_bloginfo](http://codex.wordpress.org/Function_Reference/get_bloginfo)

我有一个表单（文件 register.php），可以将帖子发送到同一目录中的文件（register_proc.php）。

```
<form id = "form" name = "form" method = "post" action = "<?php echo get_option ('template_url');? > /register_proc.php "> 
```

这两个文件位于： wp-content/themes/theme_name 。

但是当我在浏览器中提交链接是“http://127.0.0.1/register_proc.php”时，它说找不到文件。为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T18:02:32.017

你想要`get_bloginfo('template_url')`而不是`get_option('template_url')`

# wcf - 保护 WCF RESTful 服务——除非经过身份验证，否则无法调用它

> ID：10401747
> 
> 赞同：2
> 
> 时间：2012-05-01T17:37:43.353
> 
> 标签：wcf, security, rest, forms-authentication

我将使用 webHttp 或 basicHTTP 绑定编写一个 RESTful WCF 服务——没什么特别的。

但是，我想保护它，除非有人登录/验证了我的 ASP.Net MVC 网站，否则他们无法使用该服务。我一定是找错地方了，因为我读到的每篇讨论或文章都涉及通过证书或 SSL 保护服务调用。

很高兴知道，但我更感兴趣的是如何防止某人使用该服务，给他们一个错误消息，除非他们已经登录？我正在使用表单身份验证 FWIW，但也有兴趣了解如何使用 OAuth 进行此操作。感谢您的提示和建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T17:50:01.390

我想说这是一个重复的问题：[How do I set oAuth authentication for a WCF REST C# Site](https://stackoverflow.com/questions/4686451/how-do-i-set-oauth-authentication-for-a-wcf-rest-c-sharp-site)。但是，那里的信息也非常有限。你也可以看看这篇文章：[http](http://weblogs.asp.net/cibrax/archive/2008/11/14/oauth-channel-for-wcf-restful-services.aspx) ://weblogs.asp.net/cibrax/archive/2008/11/14/oauth-channel-for-wcf-restful-services.aspx 。

# wcf - 删除 web.config 中子应用程序的自定义绑定元素

> ID：10401753
> 
> 赞同：2
> 
> 时间：2012-05-01T17:37:53.260
> 
> 标签：wcf, jsonp, custom-binding

我有一个在[http://example.com](http://example.com)运行的 WCF 服务 (.NET 3.5) 应用程序；它的 web.config 配置为 JSONP 编码：

```
<extensions>
  <bindingElementExtensions>
    <add name="jsonpMessageEncoding" type="My.SharePoint.WebServices.JsonpBindingExtension, My.SharePoint.WebServices, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" />
  </bindingElementExtensions>
</extensions> 
```

其中类`My.SharePoint.WebServices.JsonpBindingExtension`是应用程序的一部分。

现在，我们正在[http://example.com/other-services/](http://example.com/other-services/)上部署另一个 WCF 应用程序，这就是我遇到问题的地方 - 当我尝试调用此服务时，我收到一个错误，它无法加载 My.SharePoint .WebServices 程序集，即使我没有在其他应用程序中使用它。看起来顶级应用程序的 web.config 与此 web.config 合并。

有没有办法`jsonpMessageEncoding`在这个子应用程序中删除/取消注册？

我希望做类似的事情：

```
<extensions>
  <bindingElementExtensions>
    <remove name="jsonpMessageEncoding"/>
  </bindingElementExtensions>
</extensions> 
```

但是`remove`这个配置部分没有。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T08:30:40.863

如果您的新应用程序直接部署在第一个应用程序下，则确实合并了 Web 配置。不幸的是，扩展不能被删除——即使相关的配置类不支持除了 add 方法之外的任何东西，原因是 add 的调用将首先被处理，并且在达到预期的删除之前已经解析了类型。

作为解决方法（未经测试），您可以尝试[在根应用程序 web.config 中使用 location 元素，](http://www.kowitz.net/archive/2007/05/16/stopping-asp-net-web-config-inheritance)并仅为根应用程序定义扩展。

# php - 以递归方式或通过迭代从表中检索数据 - 作为谱系树

> ID：10401759
> 
> 赞同：0
> 
> 时间：2012-05-01T17:38:29.220
> 
> 标签：php, mysql, arrays, algorithm

我在使用 PHP 从 MySQL 表中检索信息时遇到问题。我在 MySQL 数据库中有下表：

id | pigeon_sn | 妈妈_sn | Father_sn

id - 表示唯一 ID；
pigeon_sn - 代表鸽环序列号
Mother_sn - 代表鸽子的母亲 - 环序列号
Father_sn - 代表鸽子的父亲 - 环序列号

我想从数据库中检索信息作为谱系文件。
这意味着我需要按如下方式检索信息：

我插入鸽子戒指的序列号。
- 它给了我母亲和父亲戒指的序列号。
- 然后，对于每个新的序列号（母亲和父亲），检索与之前获得的序列号对应的父亲，以及与之前获得的序列号对应的母亲。
- 算法进行给定次数的迭代（例如 3 将通过他们的父母序列号检索 3 代鸽子）。

我相信这可以递归地完成，也可以仅通过用于给定迭代次数的 for 算法来完成。对于每只鸽子（鸽子由之前从鸽子获得的序列号表示），该算法将创建一个关联数组，其中包含该行表上的所有信息。

谢谢你的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-06T17:38:16.173

如果有人需要的话，可以解决这个问题：

首先你得到第一只鸽子和他们的父母：

$pedigree[0] = $this->fetchRow("pigeon_sn='{$sn}'");

$pedigree[1][] = $this->fetchRow("pigeon_sn='{$pedigree[0]['SN_m']}'");

$pedigree[1][] = $this->fetchRow("pigeon_sn='{$pedigree[0]['SN_t']}'");

之后你会这样：

```
 public function recurseDB($last_level,&$result,$level=1,$limit=2){
        //Check if las level was an array
        if($level <= $limit){
            if(is_array($last_level)){   
                foreach($last_level as $array){
                    $result[$level+1][] = $this->fetchRow("pigeon_SN='{$array['SN_m']}'");
                    $result[$level+1][] = $this->fetchRow("pigeon_SN='{$array['SN_t']}'");
                }
                $this->recurseDB($result[$level+1],$result,$level+1,$limit);
            }
            else
            {
                $result[$level][] = $this->fetchRow("pigeon_SN='{$last_level['SN_m']}'");
                $result[$level][] = $this->fetchRow("pigeon_SN='{$last_level['SN_t']}'");
            }
        }
    } 
```

对于递归函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T18:44:33.153

两件事情。您既需要一种跟踪父子关系的方法（当您拥有父母的 sn 时，查找和引用 id 的逻辑在将字段到字段的查找与 id 编号相关联以产生您需要的结果时会变得非常复杂）以迭代和递归方式重复该过程）在同一字段中，以及一种构建查询逻辑的方法，使其在数据库上运行的次数最少。

所以，我会考虑做的第一件事是创建一个查找表（pigeon_id、mother_id、father_id）并`LEFT JOIN`在 id 值上创建一个，或者向数据库添加两个字段（mother_id 和father_id）并为该表创建一个别名当您`JOIN`构建查询时，您迭代地查找 id 查找中的值。

# ios - 部署目标为 4.2 时将 QuartzCore 添加到项目中

> ID：10401767
> 
> 赞同：0
> 
> 时间：2012-05-01T17:38:58.750
> 
> 标签：ios, xcode

我正在构建一个应用程序，部署目标是 4.2。我需要使用 QuartzCore，但是当我尝试将其添加到“Link Binary With Libraries”时，我只能使用 5.0 SDK。

我可以使用 5.0 还是应该从某个地方获得 4.2 的 QuartzCore？

# c# - 无法将 httpcontextbase 传递给具有 HttpContext 类型变量的方法

> ID：10401768
> 
> 赞同：0
> 
> 时间：2012-05-01T17:39:04.413
> 
> 标签：c#, asp.net, unit-testing, moq

我有期望 HttpContext 类型变量的方法。

```
public string GetQueryStringValues(HttpContext context) 
```

我正在使用 Moq 从文章[hanselman 文章](http://www.hanselman.com/blog/ASPNETMVCSessionAtMix08TDDAndMvcMockHelpers.aspx)中编写单元测试 来创建/填充 HttpContext 并按如下方式传递给方法：

```
 string url = "http://localhost:51209/WebForm1.aspx?height=6&width=7&length=8&mode=walk";
        HttpContextBase contextbase = MoqHelper.FakeHttpContext(url);
        string result = new Helper(whitelist).GetQueryStringValues(context); 
```

我收到以下错误消息：

无法从“System.Web.HttpContextBase”转换为“System.Web.HttpContext”

如何在不更改方法 GetQueryStringValues 的签名的情况下解决此问题？

请帮忙。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T17:40:23.617

不幸的是，如果不更改签名，您将无法做到这一点。但是，使用抽象而不是具体类型，您的签名会更好。

# jquery - 在将对象拖到 div 之外时防止对象可见

> ID：10401773
> 
> 赞同：0
> 
> 时间：2012-05-01T17:39:20.697
> 
> 标签：jquery, css

我想知道如何防止将对象拖到 div 外时不可见。这是一个与我的问题有关的 jsfiddle：http: [//jsfiddle.net/thomaslefeuvre/zAWMX/](http://jsfiddle.net/thomaslefeuvre/zAWMX/)。

当对象被拖到 div 的边缘时，我想实现这种效果：http: [//i.stack.imgur.com/W7f4H.png](http://i.stack.imgur.com/W7f4H.png)

我知道如何使用 iframe 来实现这种效果，但由于我的 javascript 需求，我认为使用这种方法并不实用。我还应该注意，我不希望将滚动条放置在容器 div 上。

有没有办法通过 CSS 来实现，例如使用 z-index？

我试过玩这个，但还没有走得很远。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T17:41:23.023

由于对象正在移动到容器区域之外，因此您需要将溢出：隐藏添加到#container。这隐藏了超出父元素限制的任何内容。我已经更新了你的例子：http: [//jsfiddle.net/zAWMX/1/](http://jsfiddle.net/zAWMX/1/)

# linux - debian 上的新手并试图使 Java 7 成为使用的默认 Java 版本

> ID：10401776
> 
> 赞同：12
> 
> 时间：2012-05-01T17:39:44.400
> 
> 标签：linux, debian

2个问题。

1.  在我的新 Debian 本地机器上安装 Oracle Java 7 后，我打开一个终端并执行以下命令：

java版本

当我这样做时，它指出：Java 版本“1.6.0_26”Java(TM) SE 运行时环境（构建 1.6.0_26-b03）Java HotSpot(TM) 客户端 VM（构建 20.1-b02，混合模式，共享）

我分别在以下目录中安装了 Java 7 JDK 和 Java 7 JRE：

/usr/lib/jvm/jdk1.7.0 /usr/lib/jvm/jre1.7.0

1.  有没有办法同时删除 java-6-sun 和 java-6-sun-1.6.0.26 文件夹，或者只是把它们留在那里会伤害吗？

对于这两个问题的任何帮助/指导将不胜感激。

问候。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-01T17:43:16.803

> sudo update-alternatives --config java

我相信交换它的命令。

然后你可以打电话

> 哪个java

它应该引用选择的版本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-02T13:56:19.333

`sudo update-java-alternatives -s ...`将同时配置所有备选方案 `update-java-alternatives -l`列出备选方案

# android - 线程以未捕获的异常退出 (group=0x4001b188)

> ID：10401778
> 
> 赞同：0
> 
> 时间：2012-05-01T17:39:57.050
> 
> 标签：android, pdf, itext, uncaught-exception

我收到一个我不明白的错误。我要做的就是从pdf中提取文本。我正在使用 droidText ( [http://code.google.com/p/droidtext/](http://code.google.com/p/droidtext/) ) 这是代码：

```
public void parsePdf(URL pdf) throws IOException {

    PdfReader reader = new PdfReader(pdf.openStream());
    PdfTextExtractor pdfEx = new PdfTextExtractor(reader);

    for(i=1; i <= reader.getNumberOfPages(); i++){
        Scanner scanner = new Scanner(pdfEx.getTextFromPage(i));
        while(scanner.hasNextLine()){
        paragraphs.add(scanner.nextLine());
        }
    } 
```

}

这是日志：

```
05-01 17:04:37.059: D/dalvikvm(295): GC freed 4534 objects / 194136 bytes in 47ms
05-01 17:04:38.970: D/dalvikvm(295): GC freed 4416 objects / 411552 bytes in 62ms
05-01 17:04:38.980: I/dalvikvm-heap(295): Grow heap (frag case) to 5.906MB for 523658-byte allocation
05-01 17:04:39.049: D/dalvikvm(295): GC freed 334 objects / 15008 bytes in 64ms
05-01 17:04:39.371: D/dalvikvm(295): GC freed 504 objects / 284696 bytes in 50ms
05-01 17:04:39.380: I/dalvikvm-heap(295): Grow heap (frag case) to 6.625MB for 1054154-byte allocation
05-01 17:04:39.450: D/dalvikvm(295): GC freed 0 objects / 0 bytes in 74ms
05-01 17:04:39.520: D/dalvikvm(295): GC freed 1904 objects / 595384 bytes in 64ms
05-01 17:04:39.780: D/dalvikvm(295): GC freed 10610 objects / 1483240 bytes in 57ms
05-01 17:04:40.160: D/dalvikvm(295): GC freed 17834 objects / 808256 bytes in 62ms
05-01 17:04:40.610: D/dalvikvm(295): GC freed 20850 objects / 963048 bytes in 64ms 
05-01 17:04:41.090: D/dalvikvm(295): GC freed 30108 objects / 1060848 bytes in 67ms
05-01 17:04:41.210: D/AndroidRuntime(295): Shutting down VM
05-01 17:04:41.210: W/dalvikvm(295): threadid=3: thread exiting with uncaught exception (group=0x4001b188)
05-01 17:04:41.220: E/AndroidRuntime(295): Uncaught handler: thread main exiting due to uncaught exception
05-01 17:04:41.334: I/DEBUG(27): *** *** *** *** *** *** *** *** *** *** *** *** ***  *** *** ***
05-01 17:04:41.334: I/DEBUG(27): Build fingerprint: 'generic/sdk/generic/:2.1-update1/ECLAIR/35983:eng/test-keys'
05-01 17:04:41.342: I/DEBUG(27): pid: 295, tid: 295  >>> com.android.horse <<<
05-01 17:04:41.342: I/DEBUG(27): signal 11 (SIGSEGV), fault addr 00000008
05-01 17:04:41.342: I/DEBUG(27):  r0 00000000  r1 beac7ae8  r2 4187033c  r3 00000000
05-01 17:04:41.342: I/DEBUG(27):  r4 beac7ae8  r5 4186be84  r6 beac7ae0  r7 40009ae8
05-01 17:04:41.342: I/DEBUG(27):  r8 ad00f380  r9 0000bd00  10 4186be58  fp 00000000
05-01 17:04:41.342: I/DEBUG(27):  ip 00000000  sp beac7a90  lr ad0544d3  pc ad034474  cpsr 40000030
05-01 17:04:41.400: I/DEBUG(27):          #00  pc 00034474  /system/lib/libdvm.so
05-01 17:04:41.400: I/DEBUG(27):          #01  pc 000544ce  /system/lib/libdvm.so
05-01 17:04:41.400: I/DEBUG(27):          #02  pc 00013f58  /system/lib/libdvm.so
05-01 17:04:41.411: I/DEBUG(27):          #03  pc 00019888  /system/lib/libdvm.so
05-01 17:04:41.411: I/DEBUG(27):          #04  pc 00018d5c  /system/lib/libdvm.so
05-01 17:04:41.411: I/DEBUG(27):          #05  pc 0004d6d0  /system/lib/libdvm.so
05-01 17:04:41.411: I/DEBUG(27):          #06  pc 0004d702  /system/lib/libdvm.so
05-01 17:04:41.411: I/DEBUG(27):          #07  pc 000404b8  /system/lib/libdvm.so
05-01 17:04:41.411: I/DEBUG(27):          #08  pc 00041334  /system/lib/libdvm.so
05-01 17:04:41.420: I/DEBUG(27):          #09  pc 00037e3a  /system/lib/libdvm.so
05-01 17:04:41.420: I/DEBUG(27):          #10  pc 00027a12  /system/lib/libdvm.so
05-01 17:04:41.420: I/DEBUG(27):          #11  pc 00027c7e  /system/lib/libandroid_runtime.so
05-01 17:04:41.420: I/DEBUG(27):          #12  pc 00008cae  /system/bin/app_process
05-01 17:04:41.420: I/DEBUG(27):          #13  pc 0000c2c6  /system/lib/libc.so
05-01 17:04:41.420: I/DEBUG(27):          #14  pc b00018aa  /system/bin/linker
05-01 17:04:41.430: I/DEBUG(27): code around pc:
05-01 17:04:41.430: I/DEBUG(27): ad034464 bdf0b011 0004bbfc 00000354 1c03b510 
05-01 17:04:41.430: I/DEBUG(27): ad034474 30106899 f7ff0849 bd10ff65 4d37b5f0 
05-01 17:04:41.430: I/DEBUG(27): ad034484 9100b083 1c16447d d0012a00 60132300 
05-01 17:04:41.430: I/DEBUG(27): code around lr:
05-01 17:04:41.430: I/DEBUG(27): ad0544c0 f86ef7ea 46c0bd10 6800b510 f7df1c0c 
05-01 17:04:41.430: I/DEBUG(27): ad0544d0 6020ffcf 46c0bd10 1c0cb510 fa8cf7ec 
05-01 17:04:41.430: I/DEBUG(27): ad0544e0 22002101 ffccf7df bd106020 1c03b510 
05-01 17:04:41.430: I/DEBUG(27): stack:
05-01 17:04:41.430: I/DEBUG(27):     beac7a50  0000bd00  [heap]
05-01 17:04:41.430: I/DEBUG(27):     beac7a54  00000012  
05-01 17:04:41.430: I/DEBUG(27):     beac7a58  00000000  
05-01 17:04:41.430: I/DEBUG(27):     beac7a5c  4506848e  /dev/ashmem/mspace/dalvik-heap/2 (deleted)
05-01 17:04:41.430: I/DEBUG(27):     beac7a60  00000001  
05-01 17:04:41.430: I/DEBUG(27):     beac7a64  ad054403  /system/lib/libdvm.so
05-01 17:04:41.430: I/DEBUG(27):     beac7a68  00000001  
05-01 17:04:41.430: I/DEBUG(27):     beac7a6c  0005c368  [heap]
05-01 17:04:41.430: I/DEBUG(27):     beac7a70  00000000  
05-01 17:04:41.430: I/DEBUG(27):     beac7a74  00000001  
05-01 17:04:41.430: I/DEBUG(27):     beac7a78  000007ab  
05-01 17:04:41.430: I/DEBUG(27):     beac7a7c  00000001  
05-01 17:04:41.440: I/DEBUG(27):     beac7a80  afe0df40  /system/lib/libc.so
05-01 17:04:41.440: I/DEBUG(27):     beac7a84  00000001  
05-01 17:04:41.440: I/DEBUG(27):     beac7a88  df002777  
05-01 17:04:41.440: I/DEBUG(27):     beac7a8c  e3a070ad  
05-01 17:04:41.440: I/DEBUG(27): #00 beac7a90  beac7ae8  [stack]
05-01 17:04:41.440: I/DEBUG(27):     beac7a94  ad0544d3  /system/lib/libdvm.so
05-01 17:04:41.440: I/DEBUG(27): #01 beac7a98  41f7c228  /data/dalvik-cache/system@framework@core.jar@classes.dex
05-01 17:04:41.440: I/DEBUG(27):     beac7a9c  ad013f5c  /system/lib/libdvm.so
05-01 17:04:41.790: D/Zygote(29): Process 295 terminated by signal (11)
05-01 17:04:41.790: I/WindowManager(51): WIN DEATH: Window{44df4c38 com.android.horse/com.android.horse.HorseEdgeActivity paused=false}
05-01 17:04:41.790: I/ActivityManager(51): Process com.android.horse (pid 295) has died. 
```

有谁知道我的代码有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-18T05:49:27.527

我的代码也有同样的问题，然后我打开我的清单，发现有多个不需要的标签，它们要么是双重声明的，要么是非关闭的，在更正它们之后，我的应用程序现在可以正常工作了。

这就是我之前的 minifest 的样子

```
 <application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name=".MainActivity"
        android:label="@string/title_activity_main" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
     <intent-filter >
            <action android:name="android.appwidget.action.APPWIDGET_UPDATE"/>
        </intent-filter>

            </intent-filter>
    </activity>

    <activity android:name=".SecondActivity"/>
    <activity android:name=".ThirdActivity"/>
    <activity android:name=".FourthActivity"/>
    <activity android:name=".FifthActivity"/>
    <activity android:name=".SixthActivity"/>
    <activity android:name=".SeventhActivity"/>

    </application> 
```

在做了一些更正之后，它现在看起来像这样，

```
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"
           package="my.project.mil"
           android:versionCode="1"
           android:versionName="1.0" >

    <uses-sdk
           android:minSdkVersion="5"
           android:targetSdkVersion="15" />

    <application
           android:icon="@drawable/ic_launcher"
           android:label="@string/app_name"
           android:theme="@style/AppTheme" >
    <activity
           android:name=".MainActivity"
           android:label="@string/title_activity_main" >
    <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />

            <action android:name="android.appwidget.action.APPWIDGET_UPDATE"/>
    </intent-filter>
    </activity>   

    <activity android:name=".SecondActivity"/>
    <activity android:name=".ThirdActivity"/>
    <activity android:name=".FourthActivity"/>
    <activity android:name=".FifthActivity"/>
    <activity android:name=".SixthActivity"/>
    <activity android:name=".SeventhActivity"/>

   </application>

  </manifest> 
```

每当有未捕获的线程异常时，就意味着存在运行时错误，或者更准确地说是程序流程中的错误。

如果这不起作用，请参阅 [Uncaught handler: thread main exiting due to uncaught exception](https://stackoverflow.com/questions/7118980/uncaught-handler-thread-main-exiting-due-to-uncaught-exception) 也讨论了线程。

# indexing - 将列更新为二级索引后，Cassandra DB 何时索引数据

> ID：10401781
> 
> 赞同：1
> 
> 时间：2012-05-01T17:40:10.883
> 
> 标签：indexing, nosql, cassandra

我通过使用更新列创建了二级索引...来自 cassandra-cli ，然后我使用 commnand 进行了测试`get User where code = 'MX'`，代码是我作为索引放置的列，此命令只返回创建索引后插入的数据，但之前的数据是没有返回，我以为以前的数据也会被索引，有人有线索吗？提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T13:00:31.307

在 Cassandra 中，二级索引仅在创建后才开始工作。浏览 apache-cassandra 库中的 SecondaryIndex 类。它将帮助您理解。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T15:18:59.120

您可能会发现这个有用[的 Cassandra 二级索引](http://www.datastax.com/dev/blog/whats-new-cassandra-07-secondary-indexes)

# objective-c - 如何让基于 NSString 的切换语句更加高效和可扩展？

> ID：10401784
> 
> 赞同：1
> 
> 时间：2012-05-01T17:40:31.930
> 
> 标签：objective-c, ios

我有很多基于按钮字符串值的切换语句（例如将箭头图像移动到 UIButton 的坐标）。我意识到我的代码中有很多重复。我想到的一件事是例如使用实际的“switch”函数，但不幸的是它只使用 int 作为切换变量类型而不是字符串。

这是我正在寻找改进的代码示例：

```
-(void)initAperture{

//Set
if ([[[self dataObject] logAperture] isEqualToString:@"dark"]) {
    [self moveImageView:selectorAperture
              toUIButton:buttonApertureDark
               animated:NO];
} 
if ([[[self dataObject] logAperture] isEqualToString:@"cloudy"]) {
    [self moveImageView:selectorAperture
             toUIButton:buttonApertureCloudy
               animated:NO];
} 
if ([[[self dataObject] logAperture] isEqualToString:@"sunny"]) {
    [self moveImageView:selectorAperture
              toUIButton:buttonApertureSunny
               animated:NO];        
} 
if ([[[self dataObject] logAperture] isEqualToString:@"pinhole"]) {
    [self moveImageView:selectorAperture
              toUIButton:buttonAperturePinhole
               animated:NO];
} 

} 
```

感谢任何改进建议或最佳实践。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T17:46:37.973

`NSDictionary`在您的键是这些`NSString`对象并且您的对象是对象的地方使用`UIButton`。

然后将您的`if`逻辑替换为：

```
[self moveImageView:selectorAperture toUIButton:[_myDictionary objectForKey:[[self dataObject] logAperture] animated:NO]]; 
```

我只是用指尖输入的，所以我不确定它是否会编译......但我认为我的例子“足够好”。

# maven - 我可以在 Maven settings.xml 文件中使用多个用户名吗？

> ID：10401791
> 
> 赞同：0
> 
> 时间：2012-05-01T17:41:06.963
> 
> 标签：maven, nexus

我们的 Nexus 存储库配置为使用存储库目标权限：user1 可以部署到 com.company.group1，user2 可以部署到 com.company.group2，等等。

我们可以在 .m2/settings.xml 文件中同时拥有同一个 Maven 存储库的 user1 和 user2 凭据吗？如果其中之一的许可被拒绝，Maven 会尝试它们吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T05:29:24.487

我在 distributionManagement 中使用属性，例如-

```
 <distributionManagement>
    <repository>
      <id>releases</id>
      <url>${url.releases}</url>
    </repository>
    <snapshotRepository>
      <id>snapshots</id>
      <url>${url.snapshots}</url>
    </snapshotRepository>
    <site>
      <id>site</id>
      <url>${url.site}</url>
    </site>
  </distributionManagement> 
```

我的 settings.xml 具有为目标存储库定义这些属性的配置文件。与settings.xml 中的匹配，因此您可以对`<id>`不同的用户名/密码/存储库组合使用不同的。在 settings.xml 中，设置 为部署所需的默认配置文件。当您需要切换到不同的配置文件时，您可以在命令行上执行此操作。`<server>``<id>``<activeProfiles>`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T19:35:26.070

`settings.xml`据我所知，您不能在同一个文件中混合凭据；似乎这将是一个很大的安全漏洞。每个用户都应该在您的构建机器上拥有自己的登录名；然后每个人都有自己的`.m2/settings.xml`和`.m2/settings-security.xml`文件（您需要后者来[加密密码](http://maven.apache.org/guides/mini/guide-encryption.html)）。每个用户添加条目，其 id 与正在部署的项目`<server>`的部分中的 id 匹配。`<distributionManagement>`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T19:44:01.547

例如，您可以为每个用户使用不同的配置文件，并将用户名和密码设置为这些配置文件中的属性。然后，您可以根据您目前想要使用的用户来激活配置文件。您还可以将配置文件之一设置为默认处于活动状态，这样您就不必在调用中始终使用配置文件名称。

另一种方法是为用户提供单独的 settings.xml 文件，并使用 -s 标志为 maven 调用指定所需的文件。

# mysql - 不支持对组函数的引用

> ID：10401796
> 
> 赞同：0
> 
> 时间：2012-05-01T17:41:42.103
> 
> 标签：mysql, sql-order-by

我从以下查询中收到以下错误，因为我试图通过在查询本身中检索到的值对结果进行排序。请你告诉我如何解决这个错误，我猜是通过在查询中创建一个子查询，我不知道怎么做！

```
SELECT q.*, COUNT(DISTINCT a.qid) AS `a_count`
FROM `questions` AS q
INNER JOIN `answers` AS a
ON a.qid = q.id
ORDER BY MAX(a_count)
LIMIT 0, 10; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T17:44:00.663

你不能`ORDER BY MAX(a_count)`，因为那没有意义。（您不能真正按单个值排序）

你可能想这样做`ORDER BY a_count`。

# java - 更改默认的“选项卡”操作（转移焦点）

> ID：10401798
> 
> 赞同：1
> 
> 时间：2012-05-01T17:41:46.890
> 
> 标签：java, swing, focus, jtextfield

在 Java`SWING`中，“ *Tab* ”在所有之间`key`全局转移。是否有可能以某种方式修改这种“*默认*”行为？`focus``components`

 *因此，我不想让“ *Tab* ”`key`改变`focus`，我想要“ *Enter* ”键来做。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T18:42:54.430

改变focusTraversalSystem 需要做很多工作。我建议在面板上添加一个actionListener，它包含所有swing组件并检查按下的键是否输入只需将焦点更改为具有tabFocus变量+ 1的下一个元素（您需要将组件放入数组中循环或使用本机摇摆方法（如果适用）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T20:42:10.533

我确定通过使用

1）`KeyBindings`你可以做到这一点非常简单和最安全的方式

2) 你可以在 Window from 方法中 得到 last `Component`, J/Component`Focus``Component#getOppositeComponent()`

否`Array`或`SwingUtilities`必需，默认情况下也许`Z-Order`可以这样做，但并非所有人都支持`Look and Feels`*

# iphone - CGPDF - 使用 FlateDecode 过滤器保存图像

> ID：10401799
> 
> 赞同：1
> 
> 时间：2012-05-01T17:41:47.440
> 
> 标签：iphone, objective-c, c, pdf, cgpdf

我正在为工作编写一个 PDF 解析器，我们使用 Core Graphics 通过回调读取所有数据，然后使用 Lib Haru 将其写出，因为我们的客户需要写出“真实”注释而 CG 不能做。

好吧，我已经到了获取图像的地步（并将它们保存到一个文件中，以确保在开始绘制它们之前我正在做它）并且我遇到了一个问题。我正在从 Resource 字典中获取所有 Image XObjects，然后尝试使用此代码将它们保存出来

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDir = [paths objectAtIndex:0];                

NSData *imageFileData = (NSData *)CGPDFStreamCopyData(objectStream, CGPDFDataFormatRaw);

NSString *fileName = [NSString stringWithFormat:@"%@/%s.png", documentsDir, name];
[imageFileData writeToFile:fileName atomically:YES]; 
```

其中 objectStream 使用 CGPDFDictionaryGetStream 来提取 XObject。好吧，当过滤器是“DCTDecode”时它工作正常，但是当过滤器是“FlateDecode”时，保存的图像已损坏并且无法打开。

我在[这篇文章](https://stackoverflow.com/questions/4584540/is-there-any-pdf-parser-written-in-objective-c-or-c "这个帖子")中读到 CGPDFStreamCopyData 可以使用 FlateDecode 解码文本（一直到评论中文章的底部），但是 CGPDFDataFormats 中只有 3 种数据格式，并且它们都不起作用。

我相信我也遇到了使用 FlatDecode 编码的文本的问题。有没有人对如何解码这个有任何建议？当然 CGPDF 有一些东西可以处理这个问题，因为它几乎出现在我试图打开的每个 pdf 中（尽管我无法找到它）。

**编辑：**我在几个地方读到了可以使用 zlib 解压缩它，所以我尝试了这段代码，我可以找到关于如何做到这一点的代码：

```
 NSData* uncompressedImageData;
            if ([imageFileData length] == 0) 
                uncompressedImageData = imageFileData;
            else
            {                
                z_stream strm;
                strm.zalloc = Z_NULL; 
                strm.zfree = Z_NULL; 
                strm.opaque = Z_NULL; 
                strm.total_out = 0; 
                strm.next_in=(Bytef*)[imageFileData bytes]; 
                strm.avail_in = [imageFileData length];

                // Compresssion Levels: // Z_NO_COMPRESSION // Z_BEST_SPEED // Z_BEST_COMPRESSION // Z_DEFAULT_COMPRESSION
                if (deflateInit(&strm, Z_DEFAULT_COMPRESSION) != Z_OK) 
                    uncompressedImageData = nil;

                NSMutableData *compressed = [NSMutableData dataWithLength:16384]; // 16K chuncks for expansion
                do 
                {
                    if (strm.total_out >= [compressed length]) 
                        [compressed increaseLengthBy: 16384];

                    strm.next_out = [compressed mutableBytes] + strm.total_out; strm.avail_out = [compressed length] - strm.total_out;
                    deflate(&strm, Z_FINISH);
                } 
                while (strm.avail_out == 0);

                deflateEnd(&strm);
                [compressed setLength: strm.total_out]; 

                uncompressedImageData = [NSData dataWithData: compressed]; 
            }

            if(uncompressedImageData != nil)
                [uncompressedImageData writeToFile:fileName atomically:YES]; 
```

当我运行该代码时，它没有抛出任何异常，但生成的图像仍然不可读。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T14:36:19.520

您的使用`CGPDFStreamCopyData`似乎表明您在那里有一个误解：您没有设置您想要的格式，该函数将其设置为它在流中遇到的格式。一个典型的用途是：

```
CGPDFDataFormat format;
CGPDFStreamCopyData(objectStream, &format);
if (format == CGPDFDataFormatRaw) {
    //handle raw data...
} else if (format == CGPDFDataFormatJPEGEncoded) {
    //handle jpeg data...
} else if (format == CGPDFDataFormatJPEG2000) {
    //handle jpeg 2000 data
} 
```

PDF 标准根本不支持 PNG 图像，因此您永远无法从图像数据流中获得有效的 PNG 文件。选项是 JPEG、JPEG2K 和原始图像（有关这些的详细信息，请参阅规范）。

Quartz 透明地处理 zlib 压缩，因此您永远不会自己获得 zlib 压缩数据。

# regex - Unicode字符串的正则表达式

> ID：10401801
> 
> 赞同：1
> 
> 时间：2012-05-01T17:41:51.293
> 
> 标签：regex, python-2.7

我有一些文本数据的文件。我需要从这个文件中获取所有对我感兴趣的字符串。所有有趣的字符串都用“\x01\x00\x00\x00”和“\x00”框起来。我尝试使用以下正则表达式来查找这些字符串：

```
(\x01\x00\x00\x00[\u0000-\uFFFF]+\x00) 
```

但它不能正常工作。我究竟做错了什么？完整代码在这里：

```
# -*- coding: utf-8 -*-

import re

file  = open(r"H:\1705\test.adb")
temp = file.readlines()
resString = ""
for line in temp:
    resString += line
p = re.compile(ur"(\x01\x00\x00\x00[\u0000-\uFFFF]+\x00)", re.UNICODE)
res = p.finditer(resString)
for match in res:
    print match.group()[0].decode("cp1251") 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T04:57:58.023

在正则表达式中，反斜杠转义特殊字符以抑制其特殊含义，例如，如果您想使用正则表达式搜索点，您将使用`\.`.

因此，要搜索反斜杠，您需要使用`\\`，导致您的可搜索字符串为

```
\\x01\\x00\\x00 
```

等等。

# c# - IEntityChangeTracker 错误的多个实例

> ID：10401804
> 
> 赞同：2
> 
> 时间：2012-05-01T17:42:07.047
> 
> 标签：c#, asp.net-mvc-3, ado.net

我已经阅读了至少十几个其他问题，就像这个问题一样，但我无法掌握其中的一些内容。

我习惯于使用链接到实体框架的存储库和代码优先实体来开发 ASP.NET MVC3。

我最近切换到具有服务开发的数据库优先 ADO.NET。我觉得这很干净，因为我可以通过我的外键访问东西。

无论如何，我的旧保存方法似乎被破坏了，因为我经常收到这个错误

> 一个实体对象不能被多个 IEntityChangeTracker 实例引用

所以这里看一下我的保存操作和我的服务：

行动：

```
[HttpPost]
        public ActionResult AddReview(Review review, int id)
        {
            User loggedInUser = userService.GetUserByusername(User.Identity.Name);
            review.WriterId = loggedInUser.UserId;
            review.ProductId = id;

            if (ModelState.IsValid)
            {
                reviewService.Save(review);
                Product product = productService.GetProduct(id);

                if(product.Quantity>=1)
                    product.Quantity--;
                product.TimesBought++;

                productService.UpdateRating(product, reviewService);

                loggedInUser.GoldCoins -= product.Price;
                Session["goldCoins"] = loggedInUser.GoldCoins;
                userService.Save(loggedInUser);
                productService.Save(product);

            }
            else
            {
                return View(review);
            }
            return RedirectToAction("Index", "Answers", new { reviewId = review.ReviewId }); 
```

服务：

```
public class ReviewService : Service<Review, CapstoneEntities>
    {

        ...

        public void Save(Review review)
        {

        using (var db = new CapstoneEntities())
        {
            if (review.ReviewId == 0)
            {
                db.Reviews.Add(review);
                db.Entry(review).State = EntityState.Added;
            }
            else
            {
                db.Entry(review).State = EntityState.Modified;
            }
            db.SaveChanges();
        }
    }
} 
```

我怀疑这行代码：使用`(var db = new CapstoneEntities())`，但我不知道该怎么做。同样，这与我以前的做事方式完美配合，但现在我在几乎所有 CRUD 操作中都会遇到错误。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T18:08:05.413

看起来这是由一个实体属于多个 DataContexts 引起的。无论调用该操作的代码都应该使用相同的 DataContext 来创建实体，因为它用于将实体持久保存到数据存储区。

在大多数情况下，您应该只保留一个 DataContext 实例。您可以使用像 Castle 这样的 DI 框架将依赖项（在本例中为 DataContext）定义/存储为 Transient 或 PerWebRequest，并将其注入到服务和控制器中，因此您将始终拥有对同一 DataContext 实例的引用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-12-16T11:04:51.147

我是 MVC 和实体框架的新手。经过很多努力后我遇到了同样的问题这个解决方案对我有用。希望它对你们有用。

```
var mediaItem = db.MediaItems.FirstOrDefault(x => x.Id == mediaItemViewModel.Id);
    mediaItem.Name = mediaItemViewModel.Name;
    mediaItem.Description = mediaItemViewModel.Description;
    mediaItem.ModifiedDate = DateTime.Now;
    mediaItem.FileName = mediaItem.FileName;
    mediaItem.Size = KBToMBConversion(mediaItemViewModel.Size);
    mediaItem.Type = mediaItem.Type;

//db.Entry(mediaItem).State = EntityState.Modified;// coment This line
db.SaveChanges(); 
```

因为您正在从 db 读取整个对象并将其保存在当前上下文中，当您尝试修改实体状态时，它会告诉您已经有一个实体附加到当前上下文。只需调用保存更改它就会保存它。

# data-structures - 是否可以计算十二生肖，还是必须使用查找表？

> ID：10401805
> 
> 赞同：11
> 
> 时间：2012-05-01T17:42:07.550
> 
> 标签：data-structures, calendar, logic

我正在构建一个应用程序，它会告诉你的中文标志。我环顾四周，但只找到了图表（从 1900 年到 2020 年），没有逻辑可以创造出更动态的东西。

生肖的判断就没有逻辑吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-13T08:57:16.303

这是否回答你的问题：

```
public string ChineseZodiac(System.DateTime date)
{
    System.Globalization.EastAsianLunisolarCalendar cc = 
          new System.Globalization.ChineseLunisolarCalendar();
    int sexagenaryYear = cc.GetSexagenaryYear(date);
    int terrestrialBranch = cc.GetTerrestrialBranch(sexagenaryYear);

    // string[] years = "rat,ox,tiger,hare,dragon,snake,horse,sheep,monkey,fowl,dog,pig".Split(',');
    // string[] years = "Rat,Ox,Tiger,Rabbit,Dragon,Snake,Horse,Goat,Monkey,Rooster,Dog,Pig".Split(',');
    // string[] years = new string[]{ "rat", "ox", "tiger", "hare", "dragon", "snake", "horse", "sheep", "monkey", "fowl", "dog", "pig" };    
    string[] years = new string[]{ "Rat", "Ox", "Tiger", "Rabbit", "Dragon", "Snake", "Horse", "Goat", "Monkey", "Rooster", "Dog", "Pig" };

    return years[terrestrialBranch - 1];
} // End Function ChineseZodiac 
```

对于那些需要另一种编程语言的源代码的人：
我已经从 .NET 框架中提取了相应的源代码，这里： [https ://gist.github.com/ststeiger/709354299a457e2d79b06d0127096fee](https://gist.github.com/ststeiger/709354299a457e2d79b06d0127096fee)

**编辑：**
我将此移植到 JavaScript：

```
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ChineseZodiac = void 0;
var DateTimeKind;
(function (DateTimeKind) {
    DateTimeKind[DateTimeKind["Unspecified"] = 0] = "Unspecified";
    DateTimeKind[DateTimeKind["Utc"] = 1] = "Utc";
    DateTimeKind[DateTimeKind["Local"] = 2] = "Local";
})(DateTimeKind || (DateTimeKind = {}));
var GregorianCalendar = (function () {
    function GregorianCalendar() {
    }
    GregorianCalendar.prototype.GetYear = function (time) {
        var ticks = time.JavaScriptTicks;
        var dt = new Date(ticks);
        return dt.getUTCFullYear();
    };
    GregorianCalendar.prototype.GetMonth = function (time) {
        var ticks = time.JavaScriptTicks;
        var dt = new Date(ticks);
        return (dt.getUTCMonth() + 1);
    };
    GregorianCalendar.prototype.GetDayOfMonth = function (time) {
        var ticks = time.JavaScriptTicks;
        var dt = new Date(ticks);
        return dt.getUTCDate();
    };
    return GregorianCalendar;
}());
var DotNetDateTime = (function () {
    function DotNetDateTime(ticks, dt) {
        this.m_ticks = 0;
        this.m_ticks = ticks;
    }
    DotNetDateTime.fromJsDate = function (dt) {
        var jsTicks = dt.getTime();
        var dotNetJsbaseTicks = 621355968000000000;
        var tenK = 10000;
        var dotTicks = dotNetJsbaseTicks + jsTicks * tenK;
        return new DotNetDateTime(dotTicks, DateTimeKind.Unspecified);
    };
    Object.defineProperty(DotNetDateTime.prototype, "Ticks", {
        get: function () {
            return this.m_ticks;
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(DotNetDateTime.prototype, "JavaScriptTicks", {
        get: function () {
            var dotNetJsbaseTicks = 621355968000000000;
            var dotNetTicksSince1970 = this.m_ticks - dotNetJsbaseTicks;
            var jsTicks = parseInt((dotNetTicksSince1970 / 10000).toString(), 10);
            return jsTicks;
        },
        enumerable: false,
        configurable: true
    });
    return DotNetDateTime;
}());
var MinLunisolarYear = 1901;
var MaxLunisolarYear = 2100;
var DaysPerYear = 365;
var DaysPer4Years = DaysPerYear * 4 + 1;
var DaysPer100Years = DaysPer4Years * 25 - 1;
var DaysPer400Years = DaysPer100Years * 4 + 1;
var DaysTo10000 = DaysPer400Years * 25 - 366;
var TicksPerMillisecond = 10000;
var TicksPerSecond = TicksPerMillisecond * 1000;
var TicksPerMinute = TicksPerSecond * 60;
var TicksPerHour = TicksPerMinute * 60;
var TicksPerDay = TicksPerHour * 24;
var MinTicks = 0;
var MaxTicks = DaysTo10000 * TicksPerDay - 1;
var MinValue = new DotNetDateTime(MinTicks, DateTimeKind.Unspecified);
var MaxValue = new DotNetDateTime(MaxTicks, DateTimeKind.Unspecified);
var Jan1Month = 1;
var Jan1Date = 2;
var nDaysPerMonth = 3;
var s_daysToMonth365 = [0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334];
var s_daysToMonth366 = [0, 31, 60, 91, 121, 152, 182, 213, 244, 274, 305, 335];
var s_yinfo = [
    [0, 2, 19, 19168],
    [0, 2, 8, 42352],
    [5, 1, 29, 21096],
    [0, 2, 16, 53856],
    [0, 2, 4, 55632],
    [4, 1, 25, 27304],
    [0, 2, 13, 22176],
    [0, 2, 2, 39632],
    [2, 1, 22, 19176],
    [0, 2, 10, 19168],
    [6, 1, 30, 42200],
    [0, 2, 18, 42192],
    [0, 2, 6, 53840],
    [5, 1, 26, 54568],
    [0, 2, 14, 46400],
    [0, 2, 3, 54944],
    [2, 1, 23, 38608],
    [0, 2, 11, 38320],
    [7, 2, 1, 18872],
    [0, 2, 20, 18800],
    [0, 2, 8, 42160],
    [5, 1, 28, 45656],
    [0, 2, 16, 27216],
    [0, 2, 5, 27968],
    [4, 1, 24, 44456],
    [0, 2, 13, 11104],
    [0, 2, 2, 38256],
    [2, 1, 23, 18808],
    [0, 2, 10, 18800],
    [6, 1, 30, 25776],
    [0, 2, 17, 54432],
    [0, 2, 6, 59984],
    [5, 1, 26, 27976],
    [0, 2, 14, 23248],
    [0, 2, 4, 11104],
    [3, 1, 24, 37744],
    [0, 2, 11, 37600],
    [7, 1, 31, 51560],
    [0, 2, 19, 51536],
    [0, 2, 8, 54432],
    [6, 1, 27, 55888],
    [0, 2, 15, 46416],
    [0, 2, 5, 22176],
    [4, 1, 25, 43736],
    [0, 2, 13, 9680],
    [0, 2, 2, 37584],
    [2, 1, 22, 51544],
    [0, 2, 10, 43344],
    [7, 1, 29, 46248],
    [0, 2, 17, 27808],
    [0, 2, 6, 46416],
    [5, 1, 27, 21928],
    [0, 2, 14, 19872],
    [0, 2, 3, 42416],
    [3, 1, 24, 21176],
    [0, 2, 12, 21168],
    [8, 1, 31, 43344],
    [0, 2, 18, 59728],
    [0, 2, 8, 27296],
    [6, 1, 28, 44368],
    [0, 2, 15, 43856],
    [0, 2, 5, 19296],
    [4, 1, 25, 42352],
    [0, 2, 13, 42352],
    [0, 2, 2, 21088],
    [3, 1, 21, 59696],
    [0, 2, 9, 55632],
    [7, 1, 30, 23208],
    [0, 2, 17, 22176],
    [0, 2, 6, 38608],
    [5, 1, 27, 19176],
    [0, 2, 15, 19152],
    [0, 2, 3, 42192],
    [4, 1, 23, 53864],
    [0, 2, 11, 53840],
    [8, 1, 31, 54568],
    [0, 2, 18, 46400],
    [0, 2, 7, 46752],
    [6, 1, 28, 38608],
    [0, 2, 16, 38320],
    [0, 2, 5, 18864],
    [4, 1, 25, 42168],
    [0, 2, 13, 42160],
    [10, 2, 2, 45656],
    [0, 2, 20, 27216],
    [0, 2, 9, 27968],
    [6, 1, 29, 44448],
    [0, 2, 17, 43872],
    [0, 2, 6, 38256],
    [5, 1, 27, 18808],
    [0, 2, 15, 18800],
    [0, 2, 4, 25776],
    [3, 1, 23, 27216],
    [0, 2, 10, 59984],
    [8, 1, 31, 27432],
    [0, 2, 19, 23232],
    [0, 2, 7, 43872],
    [5, 1, 28, 37736],
    [0, 2, 16, 37600],
    [0, 2, 5, 51552],
    [4, 1, 24, 54440],
    [0, 2, 12, 54432],
    [0, 2, 1, 55888],
    [2, 1, 22, 23208],
    [0, 2, 9, 22176],
    [7, 1, 29, 43736],
    [0, 2, 18, 9680],
    [0, 2, 7, 37584],
    [5, 1, 26, 51544],
    [0, 2, 14, 43344],
    [0, 2, 3, 46240],
    [4, 1, 23, 46416],
    [0, 2, 10, 44368],
    [9, 1, 31, 21928],
    [0, 2, 19, 19360],
    [0, 2, 8, 42416],
    [6, 1, 28, 21176],
    [0, 2, 16, 21168],
    [0, 2, 5, 43312],
    [4, 1, 25, 29864],
    [0, 2, 12, 27296],
    [0, 2, 1, 44368],
    [2, 1, 22, 19880],
    [0, 2, 10, 19296],
    [6, 1, 29, 42352],
    [0, 2, 17, 42208],
    [0, 2, 6, 53856],
    [5, 1, 26, 59696],
    [0, 2, 13, 54576],
    [0, 2, 3, 23200],
    [3, 1, 23, 27472],
    [0, 2, 11, 38608],
    [11, 1, 31, 19176],
    [0, 2, 19, 19152],
    [0, 2, 8, 42192],
    [6, 1, 28, 53848],
    [0, 2, 15, 53840],
    [0, 2, 4, 54560],
    [5, 1, 24, 55968],
    [0, 2, 12, 46496],
    [0, 2, 1, 22224],
    [2, 1, 22, 19160],
    [0, 2, 10, 18864],
    [7, 1, 30, 42168],
    [0, 2, 17, 42160],
    [0, 2, 6, 43600],
    [5, 1, 26, 46376],
    [0, 2, 14, 27936],
    [0, 2, 2, 44448],
    [3, 1, 23, 21936],
    [0, 2, 11, 37744],
    [8, 2, 1, 18808],
    [0, 2, 19, 18800],
    [0, 2, 8, 25776],
    [6, 1, 28, 27216],
    [0, 2, 15, 59984],
    [0, 2, 4, 27296],
    [4, 1, 24, 43872],
    [0, 2, 12, 43744],
    [0, 2, 2, 37600],
    [3, 1, 21, 51568],
    [0, 2, 9, 51552],
    [7, 1, 29, 54440],
    [0, 2, 17, 54432],
    [0, 2, 5, 55888],
    [5, 1, 26, 23208],
    [0, 2, 14, 22176],
    [0, 2, 3, 42704],
    [4, 1, 23, 21224],
    [0, 2, 11, 21200],
    [8, 1, 31, 43352],
    [0, 2, 19, 43344],
    [0, 2, 7, 46240],
    [6, 1, 27, 46416],
    [0, 2, 15, 44368],
    [0, 2, 5, 21920],
    [4, 1, 24, 42448],
    [0, 2, 12, 42416],
    [0, 2, 2, 21168],
    [3, 1, 22, 43320],
    [0, 2, 9, 26928],
    [7, 1, 29, 29336],
    [0, 2, 17, 27296],
    [0, 2, 6, 44368],
    [5, 1, 26, 19880],
    [0, 2, 14, 19296],
    [0, 2, 3, 42352],
    [4, 1, 24, 21104],
    [0, 2, 10, 53600],
    [8, 1, 30, 59696],
    [0, 2, 18, 54560],
    [0, 2, 7, 55968],
    [6, 1, 27, 27472],
    [0, 2, 15, 22224],
    [0, 2, 5, 19168],
    [4, 1, 25, 42216],
    [0, 2, 12, 41680],
    [0, 2, 1, 53584],
    [2, 1, 21, 55592],
    [0, 2, 9, 54560],
];

function GregorianIsLeapYear(y) {
    if ((y % 4) != 0) {
        return false;
    }
    if ((y % 100) != 0) {
        return true;
    }
    return (y % 400) == 0;
}

function GetYearInfo(lunarYear, index) {
    if (lunarYear < MinLunisolarYear || lunarYear > MaxLunisolarYear) {
        throw new Error("year");
    }
    return s_yinfo[lunarYear - MinLunisolarYear][index];
}
function CheckTicksRange(ticks) {
    if (ticks < MinValue.Ticks || ticks > MaxValue.Ticks) {
        throw new Error("time");
    }
}
function GregorianToLunar(solarYear, solarMonth, solarDate) {
    var outData = { lunarYear: 0, lunarMonth: 0, lunarDate: 0 };
    var isLeapYear = GregorianIsLeapYear(solarYear);
    var jan1Month;
    var jan1Date;
    var solarDay = isLeapYear ? s_daysToMonth366[solarMonth - 1] : s_daysToMonth365[solarMonth - 1];
    solarDay += solarDate;
    var lunarDay = solarDay;
    outData.lunarYear = solarYear;
    if (outData.lunarYear == (MaxLunisolarYear + 1)) {
        outData.lunarYear--;
        lunarDay += (GregorianIsLeapYear(outData.lunarYear) ? 366 : 365);
        jan1Month = GetYearInfo(outData.lunarYear, Jan1Month);
        jan1Date = GetYearInfo(outData.lunarYear, Jan1Date);
    }
    else {
        jan1Month = GetYearInfo(outData.lunarYear, Jan1Month);
        jan1Date = GetYearInfo(outData.lunarYear, Jan1Date);
        if ((solarMonth < jan1Month) ||
            (solarMonth == jan1Month && solarDate < jan1Date)) {
            outData.lunarYear--;
            lunarDay += (GregorianIsLeapYear(outData.lunarYear) ? 366 : 365);
            jan1Month = GetYearInfo(outData.lunarYear, Jan1Month);
            jan1Date = GetYearInfo(outData.lunarYear, Jan1Date);
        }
    }
    lunarDay -= s_daysToMonth365[jan1Month - 1];
    lunarDay -= (jan1Date - 1);
    var mask = 0x8000;
    var yearInfo = GetYearInfo(outData.lunarYear, nDaysPerMonth);
    var days = ((yearInfo & mask) != 0) ? 30 : 29;
    outData.lunarMonth = 1;
    while (lunarDay > days) {
        lunarDay -= days;
        outData.lunarMonth++;
        mask >>= 1;
        days = ((yearInfo & mask) != 0) ? 30 : 29;
    }
    outData.lunarDate = lunarDay;
    return outData;
}
function TimeToLunar(time) {
    var gregorianCalendar = new GregorianCalendar();
    var gy = gregorianCalendar.GetYear(time);
    var gm = gregorianCalendar.GetMonth(time);
    var gd = gregorianCalendar.GetDayOfMonth(time);
    var ad = GregorianToLunar(gy, gm, gd);
    return {
        year: ad.lunarYear
    };
}
function GetSexagenaryYear(time) {
    CheckTicksRange(time.Ticks);
    var x = TimeToLunar(time);
    return ((x.year - 4) % 60) + 1;
}
function GetTerrestrialBranch(sexagenaryYear) {
    if (sexagenaryYear < 1 || sexagenaryYear > 60) {
        throw new Error("sexagenaryYear");
    }
    return ((sexagenaryYear - 1) % 12) + 1;
}
function ChineseZodiac(date) {
    var dotNetDate = DotNetDateTime.fromJsDate(date);
    var sexagenaryYear = GetSexagenaryYear(dotNetDate);
    var terrestrialBranch = GetTerrestrialBranch(sexagenaryYear);
    var years = ["Rat", "Ox", "Tiger", "Rabbit", "Dragon", "Snake", "Horse", "Goat", "Monkey", "Rooster", "Dog", "Pig"];
    return years[terrestrialBranch - 1];
}
exports.ChineseZodiac = ChineseZodiac; 
```

测试：

```
var exports = {};
// [copy-pasting above code]
exports.ChineseZodiac(new Date(1970,0,1))
exports.ChineseZodiac(new Date(2021,0,1))
exports.ChineseZodiac(new Date(2022,0,1)) 
```

all 返回与 dotnet 相同的值。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-02-26T16:49:21.000

通过使用计算器

```
2013-4=2009
2009/12= 167.41666
167*12=2004
2009-2004=5 (5 is snake which was the animal for 2013) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-02-26T16:45:06.367

用它来计算年份。

```
<?php

$year = 2013;
    switch (($year - 4) % 12) {
        case  0: $zodiac = 'Rat';       break;
        case  1: $zodiac = 'Ox';            break;
        case  2: $zodiac = 'Tiger';     break;
        case  3: $zodiac = 'Rabbit';    break;
        case  4: $zodiac = 'Dragon';    break;
        case  5: $zodiac = 'Snake';     break;
        case  6: $zodiac = 'Horse';     break;
        case  7: $zodiac = 'Goat';  break;
        case  8: $zodiac = 'Monkey';    break;
        case  9: $zodiac = 'Rooster';   break;
        case 10: $zodiac = 'Dog';   break;
        case 11: $zodiac = 'Pig';   break;
    }
    echo "{$year} is the year of the {$zodiac}.<br />";

?> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-01T18:43:02.510

如果您真的想找到一种非表格机制来计算中国十二生肖的年份，那么我建议您查看具有 (LISP) 代码来处理农历新年的[“日历计算，第三版” ，并从中, 推断 <](http://www.calendarists.com/)*相关动物*>的年份是直截了当的。那本书涵盖了许多历法系统，读起来很有趣。农历是阴阳历，比较复杂；数学变得非常详细。

不过，使用表格可能更简单，也可能更紧凑，代码方面。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-01T18:15:09.433

维基百科引用了 2044。

[http://en.wikipedia.org/wiki/Chinese_zodiac](http://en.wikipedia.org/wiki/Chinese_zodiac)

以鼠年为例（1984 年之后的几年），看起来鼠周期如下：

```
383, 353, 353, 383, 354 days 
```

请注意，最后一个周期`354`很可能是由于闰年。也许使用这个公式，你可以计算出任何一年到 2100 年左右。

我用以`T-SQL`下来推断这些数字

```
select DATEDIFF(D,'02/2/1984', '02/19/1985')
select DATEDIFF(D,'02/19/1996', '02/6/1997')
select DATEDIFF(D,'02/7/2008', '01/25/2009')
select DATEDIFF(D,'01/25/2020', '02/11/2021')
select DATEDIFF(D,'02/11/2032', '01/30/2033') 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-01-11T13:23:04.693

总是有一个问题，什么是更快的测试和验证。

在 calculla 上开发[生肖计算器](http://www.calculla.com/en/chinese_zodiac)时，我们决定使用查找表——因为这比实际测试任何算法更快、更方便（即使算法可能很简单，你仍然需要时间来测试它）。

这个查找不是一个大表，您实际上可以从我们网站的源代码中获取 javascript 代码。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-04-20T00:58:57.833

```
Public Function ChineseSign(ByVal DoB As Date) As String

    Dim CSign As String = ""
    Dim YearSign As New Short
    YearSign = Year(DoB) Mod 12

    '// Uncomment the following to use Feb 12th as New Year calculation //
    'If Month(DoB) = 1 Then
    'YearSign = YearSign - 1
    'If YearSign = 0 Then YearSign = 12
    'ElseIf Month(DoB) = 2 And DoB.Day < 12 Then
    'YearSign = YearSign - 1
    'If YearSign = 0 Then YearSign = 12
    'End If

    Select Case YearSign
        Case 1
            CSign = "Rooster"
        Case 2
            CSign = "Dog"
        Case 3
            CSign = "Pig (Boar)"
        Case 4
            CSign = "Rat"
        Case 5
            CSign = "Ox"
        Case 6
            CSign = "Tiger"
        Case 7
            CSign = "Rabbit"
        Case 8
            CSign = "Dragon"
        Case 9
            CSign = "Snake"
        Case 10
            CSign = "Horse"
        Case 11
            CSign = "Goat"
        Case 12
            CSign = "Monkey"
    End Select

    Select Case CSign
        Case "Ox"
            Return "an " & CSign
        Case Else
            Return "a " & CSign
    End Select

End Function 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-12-25T12:12:35.063

首先，您必须创建一个完全如下的星座数组

```
DECLARE sign : [array(1.....12)]
DECLARE year : INTEGER
sign(1) ← "Rat"
sign(2) ← "Ox"
sign(3) ← "Tiger"
sign(4) ← "Rabbit"
sign(5) ← "Dragon"
sign(6) ← "Snake"
sign(7) ← "Horse"
sign(8) ← "Goat"
sign(9) ← "Monkey"
sign(10) ← "Rooster"
sign(11) ← "Dog"
sign(12) ← "Pig" 
DECLARE X, Y, N : INTEGER
X ← (year - 4)
Y ← (X DIV 12) // DIV return only the natural number
Y ← (Y * 12)
N ← N + 1
OUTPUT sign(N) 
```

# c# - 如何将 IMongoFields 值传入函数参数

> ID：10401810
> 
> 赞同：1
> 
> 时间：2012-05-01T17:43:00.533
> 
> 标签：c#, mongodb-.net-driver

说我写了一个函数：

```
public static List<BsonDocument> MyFind(string collection, IMongoQuery query, IMongoSortBy sort, int skip)
{ ..etc..} 
```

我可以很容易地传入值，例如：

```
list = MyFind("collectionname",Query.EQ("field","value"),SortBy.Ascending("field"), 0).ToList() 
```

但是如果我在函数上添加另一个参数：IMongoFields 字段，那么函数看起来像：

```
public static List<BsonDocument> MyFind(string collection, IMongoQuery query, IMongoFields fields, IMongoSortBy sort, int skip)
{ ..etc..} 
```

我在为“字段”传递值时遇到问题。我已经阅读了 MongoDB 驱动程序文档，但无法想象如何将值传递进去。是否有某种方法可以构建类似于您对 List 所做的字段名称？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T15:28:41.610

您正在寻找的是返回 IMongoFields 的流利静态类 Fields：

```
 MyFind("collectionName", Query.EQ("field", "value"),
               Fields.Include("field_a", "field_b").Exclude("excluded_field"), 
               SortBy.Null, 1); 
```

不要伪造包含命名空间：

```
using MongoDB.Driver.Builders; 
```

# php - 使用 php 仅输出已解析电子邮件中的日期

> ID：10401811
> 
> 赞同：2
> 
> 时间：2012-05-01T17:43:03.367
> 
> 标签：php, parsing, email

如何让解析电子邮件仅显示日期，例如 Date: Tue, 01 May 2012 10:38:13 而不是下面的示例

> 日期：2012 年 5 月 1 日星期二 10:38:13 -0400 主题：示例电子邮件发件人：用户收件人：用户消息 ID：线程主题：示例电子邮件线程索引：Ac0nqAlw+FJmG2FhRUuM8nhAxVUpjA== Mime-version ：1.0 内容类型：多部分/替代；边界=\"B_3418713494_2606128\" >

```
$date2 = substr($email, strripos($email,"Date:")+strlen("Date:"));
$date = explode("Delivered To:", $date2);
echo "<br /><br /> Date: " . $date[0]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T18:09:34.657

如果您信任以下内容`Date:`，则`Subject:`可以作为正则表达式解决方案的替代方案（以及因此产生的开销）。

```
$pos = strpos('Subject:', $mail_header);
if ($pos !== false) {
  $date = substr($mail_header, 0, $pos);
  echo $date;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T18:19:59.773

如果我不明白你想要什么，以下应该可以工作 - 改变

```
echo "<br /><br /> Date: " . $date[0]; 
```

到

```
echo "<br /><br /> Date: " . date( "D, d M Y g:i:s", strtotime( $date[0] ) ); 
```

手动参考：[date()](http://php.net/manual/en/function.date.php)，[strtotime()](http://www.php.net/manual/en/function.strtotime.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T18:58:11.960

[日期时间](http://www.php.net/manual/en/datetime.construct.php)类！

注意：（PHP 5 >= 5.2.0）

由于给定的日期格式是标准的不变长度，您还可以使用 substr 来解析字符串：

```
$date = date_create(
    substr($email,6,25)
);

echo $date->format('D, d M Y g:i:s'); //or any valid format you want 
```

# python - Python：用布尔值确定字符串格式？

> ID：10401814
> 
> 赞同：0
> 
> 时间：2012-05-01T17:43:21.063
> 
> 标签：python, string, formatting, boolean

我是 Python 新手，我想知道最好的方法是用布尔值确定插入的部分来格式化字符串。

我有一个很长的 html 表单字符串，其中可能包含错误消息。我只想为表单中未正确验证的那些部分显示错误消息：

```
 form = """Signup
    <form method="post">
      <table>
        <tr>
          <td class="label">
            Username
          </td>
          <td>
            <input type="text" name="username" value="%(un)s">
          </td>
          <td class="error"> 
              %(un_err)s
          </td>
        </tr>
       ............

    </form>""" 
```

当我处理 post call 时，我有这个：

```
self.response.out.write(form % {"un": username, "pw": password, "pwv": validate, "email": email, "un_err": "", "pw_err": "", "verify_err": "", "email_err": ""}) 
```

每个“..._err”消息由一个单独的布尔值确定，例如，如果 valid_username 为 false，则输出应为：

```
self.response.out.write(form % {"un": username, "pw": password, "pwv": validate, "email": email, "un_err": "This is not a valid username", "pw_err": "", "verify_err": "", "email_err": ""}) 
```

有没有很好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T18:11:43.587

您已经达到了迁移到模板系统将是有益的地步。看起来您正在使用 Google AppEngine，它支持 Django 和 Jinja2 模板。[您可以在其文档](https://developers.google.com/appengine/docs/python/gettingstartedpython27/templates)中找到有关 AppEngine 特定集成的更多信息。

我推荐[Jinja2](http://jinja.pocoo.org/docs/)模板，它可以更容易地实现你的目标。您的模板可能包含以下内容：

```
<form method="post">
  <table>
    <tr>
      <td class="label">
        Username
      </td>
      <td>
        <input type="text" name="username" value="%(un)s">
      </td>
      <td class="error"> 
         {% if un_err %}
           {{ un_err }}
         {% endif %}
      </td>
    </tr>
    ...
  </table>
</form> 
```

当您处理要呈现的页面时，您可以执行以下操作：

```
template = jinja_environment.get_template('signup_form.html')
self.response.out.write(template.render(template_values)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T17:59:27.370

```
un_err_map = {
  True: "",
  False: "This is not a valid username"
}

 ...

self.response.out.write(form % {"un": username, "pw": password, "pwv": validate, "email": email, "un_err": un_err_map[valid_username], "pw_err": "", "verify_err": "", "email_err": ""}) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T18:02:18.617

使用此语法：

```
"un_err": "" if valid_username else "This is not a valid username", ... 
```

如果感觉很长，您可以将其变成一个函数：

```
def bool_it(var, s):
    return "" if var else s 
```

接着：

```
"un_err": bool_it(valid_username, "This is not a valid username") 
```

# ruby-on-rails - 如何正确扩展 Devise Recoverable？

> ID：10401816
> 
> 赞同：6
> 
> 时间：2012-05-01T17:43:30.137
> 
> 标签：ruby-on-rails, ruby, devise

我希望 Recoverable 模块为我的用户发送带有重置密码链接的“邀请”电子邮件（该应用程序仅在邀请中），我在初始化程序中部分声明了方法：

```
module Devise
  class Mailer
    def invite_new_user(record)
      devise_mail(record, :invitation_instructions)
    end
  end
end

module Devise
  module Models
    module Recoverable
      def send_invite_user_instructions!
        return unless status == User::STATUS_PENDING
        generate_reset_password_token!
        ::Devise.mailer.invite_new_user(self).deliver
      end
    end
  end
end 
```

并且可恢复的扩展得很好，但它说我的邮件程序没有邀请新用户方法（rails 控制台输出）：

```
1.9.2p290 :002 > user.send_invite_user_instructions! 
  User Load (1.4ms)  SELECT "users".* FROM "users" WHERE "users"."reset_password_token" = 'zMQK1CEXYupjNKpH8dph' LIMIT 1
   (0.3ms)  BEGIN
   (15.0ms)  UPDATE "users" SET "reset_password_token" = 'zMQK1CEXYupjNKpH8dph', "updated_at" = '2012-05-01 17:40:32.085256' WHERE "users"."id" = 59
   (4.5ms)  COMMIT
NoMethodError: undefined method `invite_new_user' for Devise::Mailer:Class 
```

但在同一个控制台会话中调用有方法：

```
1.9.2p290 :003 > ::Devise.mailer.method_defined? 'invite_new_user'
 => true 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-10-11T12:57:24.203

可以根据您的需要设置设计：

**1-**在 app/mailers/auth_mailer.rb 文件中创建一个`Mailer`类并使其继承自`Devise::Mailer`

```
class AuthMailer < Devise::Mailer
  def invite_new_user(record)
    devise_mail(record, :invitation_instructions)
  end
end 
```

**2-**通过编辑 config/initializers/devise.rb 文件并添加来指示设计使用您的类

```
config.mailer = 'AuthMailer' 
```

**3-（可选）**如果*（且仅当）*您使用延迟电子邮件发送，例如 SideKiq 或 DelayedJob，您可能需要在开发中急切加载，或者延迟的工作可能找不到您的`AuthMailer`课程。在 config/environments/development.rb

```
config.eager_load = true 
```

**4-**我个人会`send_invite_user_instructions!`在我的类中定义你的方法，`User`而不是修补 Devise 类

* * *

旁注：我不是一个忠实的粉丝，也不是在 Rails 初始化程序中做一个类的部分声明，因为根据 gem 的设计方式，你可能会遇到 autoload 的问题：有一个 gem (Monologue) 可以在运行时重新加载对象，无需运行初始化程序，因此猴子补丁在第一次调用时效果很好，但在下一次调用时效果不佳。

# jquery - jQuery单击时如何停止Vimeo视频

> ID：10401819
> 
> 赞同：10
> 
> 时间：2012-05-01T17:43:47.560
> 
> 标签：jquery, jquery-plugins, vimeo

这是简单的代码：http: [//jsfiddle.net/YAFuW/1/](http://jsfiddle.net/YAFuW/1/)

基本上我试着像这样使用：

```
<iframe src="http://player.vimeo.com/video/40977539?api=1" width="400" height="225" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>

<a href="#">STOP</a>

$('a').click(function() {
   alert('stoped');
   froogaloop.api('unload');
}); 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-01T18:27:47.863

我不知道完成这个跨浏览器的“好”或“正确”方式。
Youtube 的 JavaScript API 也失败了。

但是这种方法是可靠的并且确实有效。
基本上，它会杀死`<iframe>`并重建它。

```
$('a').click(function() {
  alert('stoped');
  vimeoWrap = $('#vimeoWrap');
  vimeoWrap.html(vimeoWrap.html());
}); 
```

[在 JSFiddle 查看](http://jsfiddle.net/JxBE4/)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-10-17T10:52:44.030

如果您只需要播放或暂停视频，请像这样使用：

```
var iframe = $('#vimeo-player')[0];
var player = $f(iframe);

$('#stop').click(function() {
    alert('stoped');
    player.api('pause');
});

$('#play').click(function(){
    alert('play');
    player.api('play');
}) 
```

和标记：

```
<script src="http://a.vimeocdn.com/js/froogaloop2.min.js"></script>

<iframe id="vimeo-player" src="http://player.vimeo.com/video/40977539?api=1" width="400" height="225" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>
<a id="stop" href="#">STOP</a>
<a id="play" href="#">PLAY</a> 
```

[http://jsfiddle.net/zimm/8CV2S/14/](http://jsfiddle.net/zimm/8CV2S/14/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-10-22T08:59:32.580

最好的方法是使用[Vimeo API](https://github.com/vimeo/player.js)：

例子：

```
<script>
    var iframe = $('.vimeo-iframe').get(0);
    var player = new Vimeo.Player(iframe);
    player.pause();
    //player.play();
</script> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-03-05T10:59:40.610

您错过了获取 vimeo 视频的 id：

```
var iframe = $('#vimeo-player')[0];
var player = $f(iframe);
player.api('unload'); 
```

示例：http: [//jsfiddle.net/joan_r/dutzh512/](http://jsfiddle.net/joan_r/dutzh512/)

```
<html>
<head>
<script src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
<script src="http://a.vimeocdn.com/js/froogaloop2.min.js"></script>
<style>
#play,#pause,#stop{
    width:60px;
    margin:5px;
    text-align: center;
    border: solid;
    cursor:pointer;
}
</style>
</head>
<body>
<iframe id="vimeo-player" src="//player.vimeo.com/video/76979871" width="500" height="281" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>
<div id="play">[PLAY]</div>
<div id="pause">[PAUSE]</div>
<div id="stop">[STOP]</div>
<script>
    $('#play').click(function() {
        var iframe = $('#vimeo-player')[0];
        var player = $f(iframe);
        player.api('play');
    });
    $('#pause').click(function() {
        var iframe = $('#vimeo-player')[0];
        var player = $f(iframe);
        player.api('pause');
    });
    $('#stop').click(function() {
        var iframe = $('#vimeo-player')[0];
        var player = $f(iframe);
        player.api('unload');
    });
</script>
</body>
</html> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-11T11:35:03.770

如果您使用 Vimeo 更新的 API 代码，那么您可以这样做：http: [//jsfiddle.net/deshg/8CV2S/](http://jsfiddle.net/deshg/8CV2S/)。您可以看到停止按钮现在向您发出警报，然后视频被卸载。

干杯!

# javascript - Greasemonkey 脚本从 AJAX 响应中提取我想要的 HTML 内容？

> ID：10401820
> 
> 赞同：-2
> 
> 时间：2012-05-01T17:43:51.600
> 
> 标签：javascript, regex, greasemonkey

我正在尝试制作一个 Greasemonkey 用户脚本，它将在另一个网站上显示来自一个网站的信息。我尝试用正则表达式来做这件事，但被`match()`语法困住了。

页面内容是这样的：

```
<html><body>
<h1 class="pos-title">Fritz Paul</h1>
<div class="columns">
    <div class="pos-column1">
        <ul id="attributes">
             ... ...
        </ul>
    </div>
    <div class="pos-column2">
        <ul class="attributes">
             ... ...
        </ul>
    </div>
</div>
</body></html> 
```

我只想得到：

```
<div class="columns">
    <div class="pos-column1">
        <ul id="attributes">
             ... ...
        </ul>
    </div>
    <div class="pos-column2">
        <ul class="attributes">
             ... ...
        </ul>
    </div>    
</div> 
```

我试过这样的代码：

```
attibutes = responseDetails.responseText.match(xxxx);
playerNotesContent.innerHTML = attibutes; 
```

我尝试了很多`.match(...)`我在这个网站上找到的例子，但我无法让它工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:24:50.947

正如其他人所说，[永远不要尝试使用正则表达式解析 HTML](https://stackoverflow.com/a/1732454/331508)。请改用 DOM 解析。

问题尚不清楚，但您*似乎*正在通过 AJAX 获取页面并尝试解析它，对吗？此外，您真的想要每个文本中的所有标记`<div class="columns">`还是只需要特定的文本位？

这是 Greasemonkey 的一般方法。它使用 jQuery 使 DOM 解析更容易。根据 OP 的评论和[发布的脚本进行了](http://pastebin.com/ZyvHvP3C)
**更新**。：

```
// ==UserScript==
// @name        _Parse Ajax Response for specific nodes
// @namespace   http://www.test.com
// @include     http://www.test.com/player/*/details.php
// @require     http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js
// ==/UserScript==

var player_id = document.location.pathname.match(RegExp('player/([^/]+)/details.php$'))[1];
if (!player_id) { return; }

GM_xmlhttpRequest ( {
    method: 'GET',
    url:    'http://www.test2.com/players/item/' + player_id,
    onload: function (responseDetails) {
                var respDoc     = $(responseDetails.responseText);
                var targNodes   = $("div.columns", respDoc);

                $("#playerContent").after ('<div id="player_stats_block"></div>');

                $("#player_stats_block").append (targNodes);
            }
} ); 
```

# php - 每天获取会员帖子的百分比

> ID：10401821
> 
> 赞同：0
> 
> 时间：2012-05-01T17:43:58.460
> 
> 标签：php

我想计算成员每天发布的帖子数量（例如“每天 46% 的帖子”）。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T17:47:39.413

关于什么，

`$postsPerDay = $totalPosts / $daysSinceRegistration;`

# sockets - Akka ZeroMQ - 有什么方法可以获取套接字地址？

> ID：10401823
> 
> 赞同：0
> 
> 时间：2012-05-01T17:44:01.120
> 
> 标签：sockets, scala, port, akka, zeromq

让我们假设以下代码：

```
class MQActor extends Actor {

    // Bind on port 0... Technically this should pick a free port
    val pubSocket = context.system.newSocket(SocketType.Pub, Bind("tcp://127.0.0.1:0"))

    def receive = {
        // ...
    }

} 
```

我的问题是：

1) 指定端口 0 来请求任何可用端口上的套接字是否正确？

2）假设1）有效，我怎么知道套接字绑定到哪个端口？

3) 如果 1) 不起作用和/或 2) 不可能，我如何绑定到任何可用端口？

提前致谢！

比利

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T19:35:02.270

据我所知，这对于 ZMQ 是不可能的。但是，您可以向参与者询问套接字选项。以下是选项：

[https://github.com/akka/akka/blob/master/akka-zeromq/src/main/scala/akka/zeromq/ConcurrentSocketActor.scala#L85](https://github.com/akka/akka/blob/master/akka-zeromq/src/main/scala/akka/zeromq/ConcurrentSocketActor.scala#L85)

您可以自己确定未使用的端口。但是你的用例到底是什么？为什么需要将套接字绑定到随机端口？发布者如何知道他们应该使用哪个端口？

# ruby-on-rails-3 - ruby on rails 中未定义的方法“断言”

> ID：10401828
> 
> 赞同：4
> 
> 时间：2012-05-01T17:44:22.640
> 
> 标签：ruby-on-rails-3

运行命令后收到此错误消息

耙式测试：单位

```
 undefined method `assert' for ProductTest:Class (NoMethodError)
    from /home/mayank/src/proj/vendor/bundle/ruby/1.8/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:251:in `require'
    from /home/mayank/src/proj/vendor/bundle/ruby/1.8/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:251:in `require'
    from /home/mayank/src/proj/vendor/bundle/ruby/1.8/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:236:in `load_dependency'
    from /home/mayank/src/proj/vendor/bundle/ruby/1.8/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:251:in `require'
    from /home/mayank/src/proj/vendor/bundle/ruby/1.8/gems/rake-0.9.2.2/lib/rake/rake_test_loader.rb:10
    from /home/mayank/src/proj/vendor/bundle/ruby/1.8/gems/rake-0.9.2.2/lib/rake/rake_test_loader.rb:9:in `each'
    from /home/mayank/src/proj/vendor/bundle/ruby/1.8/gems/rake-0.9.2.2/lib/rake/rake_test_loader.rb:9
    from /home/mayank/src/proj/vendor/bundle/ruby/1.8/gems/rake-0.9.2.2/lib/rake/rake_test_loader.rb:4:in `select'
    from /home/mayank/src/proj/vendor/bundle/ruby/1.8/gems/rake-0.9.2.2/lib/rake/rake_test_loader.rb:4
rake aborted! 
```

该应用程序的源代码如下。它在行断言上给出错误。

```
require 'test_helper'

class ProductTest < ActiveSupport::TestCase
  product = Product.new
  assert product.invalid?
  assert product.errors[:title].any?
  assert product.errors[:description].any?
  assert product.errors[:price].any?
  assert product.errors[:image_url].any?
  # test "the truth" do
  #   assert true
  # end
end 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-01T17:55:16.623

应该：

```
class ProductTest < ActiveSupport::TestCase

  test "product attributes must not be empty" do
    product = Product.new
    assert product.invalid?
    assert product.errors[:title].any?
    assert product.errors[:description].any?
    assert product.errors[:image_url].any?
    assert product.errors[:price].any?
  end
end 
```

就像在《[*Agile Web Development with Rails*](http://pragprog.com/book/rails4/agile-web-development-with-rails) 》一书中一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T16:06:25.443

对这个命令使用外部类

```
include Test::Unit::Assertions

require 'rubygems'
require 'selenium-webdriver'
gem "test-unit"
require 'test/unit'

include Test::Unit::Assertions

class Transaction

         def createassert()   

          assert(driver.find_element(:id, "amount").text.include?("$244.00")," amount not valid")

         end

class Evaluate

tra=Transaction.new
tra.createassert()

end 
```

# html - 如何在浏览器中将标签呈现为 html

> ID：10401831
> 
> 赞同：1
> 
> 时间：2012-05-01T17:44:29.020
> 
> 标签：html, tags, rendering

如何在浏览器中将这些标签呈现为 html，例如 chrome？

```
<testname=tar_tests.sh>
    <description>
        Test basic functionality of `tar` command.
    <\description>
    <test_location>
        ltp/testcases/commands/tar/tar_tests.sh
    <\test_location>
<\testname>

<testname=unzip>
    <description>
        Test basic functionality of `unzip` command.

    <\description>
    <test_location>
        ltp/testcases/commands/unzip
    <\test_location>
<\testname> 
```

输出：

```
<testname=tar_tests.sh> <description> Test basic functionality of `tar` command. <\description> <test_location> ltp/testcases/commands/tar/tar_tests.sh <\test_location> <\testname> <testname=unzip> <description> Test basic functionality of `unzip` command. <\description> <test_location> ltp/testcases/commands/unzip <\test_location> <\testname> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T17:46:11.570

您需要为括号使用 HTML 实体。更改`<`为`&lt;`和`>`_`&gt;`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T17:46:10.647

您需要将`<`and`>`字符分别转义为`&lt;`and `&gt;`。

因此，在您的 HTML 中，为了显示：

```
<testname=tar_tests.sh> 
```

你应该写：

```
&lt;testname=tar_tests.sh&gt; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T17:52:57.200

如果您将文本包装在`<pre>`...中`</pre>`，它将被格式化，您不需要将所有标签更改为 HTML 实体。保留空白和布局。

```
<pre>
&lt;testname=tar_tests.sh>
...
</pre> 
```

# exchange-server - 我在哪里可以获得最新的 Microsoft.Exchange.WebServices.DLL？

> ID：10401834
> 
> 赞同：16
> 
> 时间：2012-05-01T17:44:45.603
> 
> 标签：exchange-server, exchangewebservices, exchange-server-2010

我正在尝试使用最新的 Exchange Web Services DLL，但是当我搜索我的硬盘时，我看到了许多版本的 Microsoft.Exchange.WebServices.DLL，最新的是版本 14.0.650.7，日期为 2012 年 1 月 24 日.

我想重建我的机器，但找不到获取此 DLL 的官方位置。我尝试下载[最新的 SDK](http://www.microsoft.com/en-us/download/details.aspx?id=13082)，但没有看到任何要使用的 DLL，也没有任何 CHM 可供我使用。

在哪里可以获得最新版本的 Microsoft.Exchange.WebServices.DLL？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-01T19:24:11.160

这是[EWS 2.2的链接](http://blogs.msdn.com/b/exchangedev/archive/2014/06/02/ews-managed-api-2-2-now-available.aspx)

[http://www.microsoft.com/en-us/download/details.aspx?id=42951](http://www.microsoft.com/en-us/download/details.aspx?id=42951)

这是通过访问 www.microsoft.com/downloads 并搜索“Exchange Web Services Managed API”找到的（感谢 Jakob）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-02T08:11:12.823

EWS 托管 API 的当前版本是[1.2](http://www.microsoft.com/en-us/download/details.aspx?id=28952)。微软似乎有时会忘记更新最新下载的链接，这使得很难找到最新版本，但我通常会在需要时访问[www.microsoft.com/downloads](http://www.microsoft.com/downloads/)并搜索“Exchange Web Services Managed API”全新下载。

* * *

**更新：** EWS 在 NuGet 上： [http ://www.nuget.org/packages?q=EWS](http://www.nuget.org/packages?q=EWS)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-10-11T06:38:19.793

这是一个老问题，OP 和@JakobChristensen 的两个答案确实回答了这个问题。我只想提一下，我发现情况相当混乱。

我最近（手动，不是通过 NuGet）下载了当前的 NuGet 版本，他们目前称之为“2.2.0”。

[https://www.nuget.org/packages/Microsoft.Exchange.WebServices/](https://www.nuget.org/packages/Microsoft.Exchange.WebServices/)

但是 .dll 上的内部文件/产品版本是 15.00.0913.015。

根据这个页面

[https://msdn.microsoft.com/en-us/library/office/dn528373(v=exchg.150).aspx](https://msdn.microsoft.com/en-us/library/office/dn528373(v=exchg.150).aspx)

文件应该放在这里：

C:\Program Files\Microsoft\Exchange\Web Services\2.0\

所以这就是我放置它的地方。后来，在玩弄 Microsoft 示例程序时，我注意到它确实引用了该位置的文件。

但是另一个微软示例程序引用了 GAC 中的文件！

C:\WINDOWS\assembly\GAC_MSIL\Microsoft.Exchange.WebServices\15.0.0.0__31bf3856ad364e35\Microsoft.Exchange.WebServices.dll

此版本的文件/产品版本为 15.00.0847.030。

我不确定该文件是如何到达那里的，可能是 Visual Studio 安装的一部分。

还有一个叫做 EWSCore 的东西，它显然是官方 EWS 的一个分叉版本，并修复了一些错误。

[https://www.nuget.org/packages/EWSCore/](https://www.nuget.org/packages/EWSCore/)

我目前的决定是我会考虑将官方 NuGet 版本作为我将标准化的版本，并将其手动下载到我的开发 PC 和我的构建 PC 并将其放置在这里：

C:\Program Files\Microsoft\Exchange\Web Services\2.0\

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T17:48:36.540

我不确定这不是题外话，但您可能想要下载并安装最新的 Web 服务增强包： http: [//www.microsoft.com/en-us/download/details.aspx ?id=14089](http://www.microsoft.com/en-us/download/details.aspx?id=14089)。

# .htaccess - 这个 htaccess 条目有什么问题？

> ID：10401835
> 
> 赞同：0
> 
> 时间：2012-05-01T17:44:57.397
> 
> 标签：.htaccess, mod-rewrite, redirect

为什么这不起作用？

```
RewriteEngine on
RewriteRule ^/filter/([A-Za-z0-9])*$ /index.php?filter=$1 
```

试图得到这个： [http ://www.site.com/filter/whatever-is-here](http://www.site.com/filter/whatever-is-here)

加载这个： [http ://www.site.com/filter/index.php?filter=whatever-is-here](http://www.site.com/filter/index.php?filter=whatever-is-here)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T17:47:51.393

```
RewriteEngine on
RewriteRule ^/filter/([A-Za-z0-9]*)$ /index.php?filter=$1 
```

你放错了`*`，它需要在字符类上。

另外，如果你想拥有`things-with-dashes`，那么你需要使用`[-A-Za-z0-9]`你的角色类

# javascript - 在下划线模板中使用函数

> ID：10401837
> 
> 赞同：6
> 
> 时间：2012-05-01T17:44:58.913
> 
> 标签：javascript, function, templates, backbone.js, underscore.js

我正在尝试在下划线模板中使用一个函数，[如下所示，](http://lostechies.com/derickbailey/2012/04/26/view-helpers-for-underscore-templates/)但出现错误：

> 未捕获的 ReferenceError：未定义 getProperty

下面是我正在使用的代码

```
var CustomerDetailView = Backbone.View.extend({
    tagName : "div",
    template: "#customer-detail-view-template",

    initialize: function() {
        _.bindAll(this, 'render');
        this.model.bind('change', this.render);
        this.initializeTemplate();
    },

    initializeTemplate: function() {
        this.template = _.template($(this.template).html());
    },

    render: function() {
        var data = this.model.toJSON();
        _.extend(data, viewHelper);
        console.log(data);
        var html = _.template($(this.template), data);
        $(this.el).html(html);
        return this;
    }
}) 
```

和模板：

```
 <script type="text/template" id="customer-detail-view-template">
    <div style="height: 70px;">
        <span class="displayText">
            <p class="searchResultsAuxInfo">Full Name : <%= getProperty("full_name", null) %> </p>
            <p class="searchResultsAuxInfo">Country Code : <%= getProperty("country_code", null) %></p>
            <p class="searchResultsAuxInfo">street : <%= getProperty("street", null) %></p>
            <p class="searchResultsAuxInfo">maiden_name : <%= getProperty("maiden_name", null) %></p>
        </span>
        <span class="displayTextRight">
            <p class="searchResultsAuxInfo">marital_status_code : <%= getProperty("marital_status_code", null) %></p>
            <p class="searchResultsAuxInfo">tax_id_number : <%= getProperty("tax_id_number", null) %></p>
            <p class="searchResultsAuxInfo">primary_phone : <%= getProperty("primary_phone", null) %></p>
            <p class="searchResultsAuxInfo">customer_number : <%= getProperty("customer_number", null) %></p>
        </span>
    </div>
</script> 
```

视图助手对象如下所示：

```
var viewHelper = {
    getProperty:function(propertyName, object) {
        if(typeof(object) === "undefined"){
            object = this["attributes"];
        }
        for (i in object) {
            if (_.isObject(object[i])) {
                var currentObj = object[i];
                if(_.has(currentObj, propertyName)){
                    return currentObj[propertyName];
                }
                this.getProperty(propertyName, currentObj);
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-01T18:54:34.697

你的问题是，一旦你在里面`render`，`this.template`：

```
var html = _.template($(this.template), data); 
```

已经是编译好的模板函数：

```
initializeTemplate: function() {
    this.template = _.template($(this.template).html());
} 
```

[`_.template`](http://documentcloud.github.com/underscore/#template)来电：

> 将 JavaScript 模板编译为可评估以进行渲染的函数。

所以你说的是：

```
_.template($(some_compiled_template_function).html(), data);
//           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ 
```

那是执行的[`$(function() { ... })`](http://api.jquery.com/jQuery/#jQuery3)形式`$()`和那：

> 绑定在 DOM 完成加载时要执行的函数。

那一点点混乱使一切变得混乱，混乱比比皆是。修正你使用模板的方式，事情就会开始变得更有意义：

```
render: function() {
    //...
    var html = this.template(data);
    //...
} 
```

您`this.template`将成为内部的函数，`render`因此将其称为函数。

演示（为了清楚起见做了一些简化）：http: [//jsfiddle.net/ambiguous/SgEzH/](http://jsfiddle.net/ambiguous/SgEzH/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T06:52:55.670

根据您参考的博客文章，

只需删除此行即可：“this.initializeTemplate();”

# c++ - 索引的排序向量

> ID：10401839
> 
> 赞同：1
> 
> 时间：2012-05-01T17:45:37.513
> 
> 标签：c++, sorting, vector

我有一个非常简单的问题，我想我只是在做一些愚蠢的事情，但是几个小时都找不到错误....

```
#include <vector>
#include <algorithm>
#include <iostream>
using namespace std;

typedef unsigned int uint;

enum {ASCEND, DESCEND};

template<typename T>
bool ascend_sort(pair<uint, T> i, pair<uint, T> j){return j.second>i.second;}

template<typename T>
bool descend_sort(pair<uint, T> i, pair<uint, T> j){return i.second>j.second;}

template<typename T>
void sortIdx(vector<uint>& idx, const vector<T>& src, int dir=ASCEND){
    vector< pair<uint, T>  > tmp (src.size());
    for (uint i=0; i<src.size(); i++){
        tmp.push_back(pair<uint, T>(i, src[i]));
        cout << i << " " << src[i] << " \n";
    }

    if (dir==ASCEND){
        sort(tmp.begin(), tmp.end(), ascend_sort<T>);
    }else{
        sort(tmp.begin(), tmp.end(), descend_sort<T>);
    }

    idx.resize(src.size());

    for (uint i=0; i<src.size(); i++){
        idx[i] = (tmp[i].first);
        cout << tmp[i].first << " \n" ;
    }
} 
```

为什么[http://ideone.com/HOnvI](http://ideone.com/HOnvI)有效而  [http://ideone.com/R6H0n](http://ideone.com/R6H0n)无效....

代码仅在升序和降序排序方面有所不同。我还测试了没有地图的排序（直接对向量进行排序），它在那里工作得很好。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T17:56:41.440

线

```
vector< pair<uint, T>  > tmp (src.size()); 
```

创建一个大小`src.size()`为默认元素的向量（这里：pair(0, 0.0)）；

将`.push_back()`附加元素添加到该数组的末尾（现在是 (2* `src.size()`)

然后在排序之后只打印第一个`src.size()`元素，它们都是最初的 0,0.0

要修复，只需将向量声明为空：

```
vector< pair<uint, T>  > tmp; 
```

# sql - SSMS - 每个 SELECT 语句都会创建额外的空行 - 如何抑制？

> ID：10401841
> 
> 赞同：2
> 
> 时间：2012-05-01T17:45:43.173
> 
> 标签：sql, ssms

如果我在 SQL Management Studio 中设置为生成文本输出（不是网格或文件）并运行以下命令：

```
SET NOCOUNT ON
SELECT '1'
SELECT '2'
SELECT '1' 
```

我明白了：

```
1

2

1 
```

如何在每行之后删除额外的新行？我在以下工具->选项中设置为默认值： 1\. 输出格式为制表符分隔 2\. 结果集中排除的列标题 3\. 创建了一个新查询

**更新：** 为简单起见，显示了先前的查询。请把这个当作一个问题：

```
SELECT 1+2
SELECT 'A FOX'
SELECT 1,2,3 
```

想要看到行之间没有多余的行，例如：

```
3
A FOX
1  2  3 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T17:48:43.920

您将获得三个单独的结果集 - 每个选择一个。

为了获得*单个*结果集（带有重复项），您需要`UNION ALL`选择：

```
SET NOCOUNT ON
SELECT '1' UNION ALL
SELECT '2' UNION ALL
SELECT '1' 
```

有关详细信息，请参阅MSDN 上的[UNION (Transact-SQL)](http://msdn.microsoft.com/en-us/library/ms180026.aspx)。

* * *

更新：

你想做的事情是不可能的。每个选择中字段的类型和数量都不同 - 你不能`UNION`。

您不能拥有每行具有不同列数或每行具有不同数据类型的单个结果集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T19:05:21.307

好吧，我决定发布答案，而不是发表评论，因为它可能对某人有所帮助。我需要将存储过程的输出粘贴到 Excel 中并从模板应用“复制格式”。我以这种方式解决了这个问题：

我有最初的陈述

```
SELECT 'Report Header'
SELECT ''
SELECT 'Line of report',1
SELECT 'Line of report',23
SELECT * FROM SUBREPORT
SELECT 'SUBTOTAL:',(select count(*) from another_table)
SELECT ''
SELECT 'REPORT GENERATED AT ', GetDate() 
```

我更新到这个：

```
SELECT 'Report Header'
SELECT '[NEWLINE]'
SELECT 'Line of report',1
SELECT 'Line of report',23
SELECT * FROM SUBREPORT
SELECT 'SUBTOTAL:',(select count(*) from another_table)
SELECT '[NEWLINE]'
SELECT 'REPORT GENERATED AT ', GetDate() 
```

由于多余的空行会破坏格式，因此我必须删除它们。我将文本输出并粘贴到 Word 中。将“^p^p”替换为“^p”，然后将“[NEWLINE]”替换为“”（无）。复制粘贴到 Excel 并从模板复制格式。完毕。

如果有人可以提出更优雅的解决方案，我将不胜感激。

# sql - 如何将动态 SQL 的结果存储到变量中

> ID：10401842
> 
> 赞同：1
> 
> 时间：2012-05-01T17:45:48.480
> 
> 标签：sql, sql-server-2008

有没有办法将 exec 语句的结果存储在 varchar 中？

```
DECLARE @TableName varchar(100)
DECLARE @ExecStatement varchar(max)
DECLARE @PromotionXML varchar(max) 

SET @TableName = 'Feeds'

Set @ExecStatement = (
'
SET @PromotionXML = (
SELECT
    *
FROM
    ' + @TableName + ' for xml auto, elements 
    )'
)

exec @ExecStatement

select @PromotionXML 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T17:56:43.990

您需要使用`sp_executesql`，而不是`EXEC`，因为您需要将内部变量视为输出参数（您不能使用`EXEC`）。所有这些参数也应该是`NVARCHAR`，而不是`VARCHAR`（尽管我很好奇你为什么不将 xml 返回为`XML`）。

```
DECLARE 
    @TableName NVARCHAR(512),
    @sql NVARCHAR(MAX),
    @xml NVARCHAR(MAX);

SET @TableName = N'dbo.Feeds';

SET @sql = N'SELECT @xml = CONVERT(NVARCHAR(MAX), (
    SELECT * FROM ' + @TableName + ' FOR XML AUTO, ELEMENTS));';

EXEC sp_executesql @sql, N'@xml NVARCHAR(MAX) OUTPUT', @xml OUTPUT;

SELECT @xml; 
```

# symfony - 类 Naus\bundle\Entity\Sample 不是有效的实体或映射的超类

> ID：10401845
> 
> 赞同：1
> 
> 时间：2012-05-01T17:46:02.450
> 
> 标签：symfony, doctrine-orm, symfony-forms

我做了一个新的捆绑包，做了一个新的控制器，做了几个实体

当我使用 php 控制台 dotrine:schema:update --force 时，实体确实进入了数据库

我制作了一个表格，表格弹出很好，当我提交时我使用

```
if ($form->isValid()) {
                // perform some action, such as saving the task to the database

                $em = $this->getDoctrine()->getEntityManager();
                $em->persist($type);
                $em->flush();

                return $this->redirect($this->generateUrl('_success'));
            } 
```

我得到一个很大的错误：

> Naus\Biobalance\Entity\Sample 类不是有效的实体或映射的超类。

我已经仔细检查了我的顶部..并使用 Naus\bundle\Entity\Sample; 像它应该被提及的那样被提及？网上没有明确的答案，希望有人能帮助..

实体的第一行（根据要求）

```
<?php 

namespace Naus\Biobalance\Entity;

use Doctrine\ORM\EntityManager;
use Doctrine\ORM\Mapping as ORM;

/**
 * @ORM\Entity
 * @ORM\Table(name="sample")
 */
class Sample
{ 
```

关于appkernel：

```
<?php

use Symfony\Component\HttpKernel\Kernel;
use Symfony\Component\Config\Loader\LoaderInterface;

class AppKernel extends Kernel
{
    public function registerBundles()
    {
        $bundles = array(
            new Symfony\Bundle\FrameworkBundle\FrameworkBundle(),
            new Symfony\Bundle\SecurityBundle\SecurityBundle(),
            new Symfony\Bundle\TwigBundle\TwigBundle(),
            new Symfony\Bundle\MonologBundle\MonologBundle(),
            new Symfony\Bundle\SwiftmailerBundle\SwiftmailerBundle(),
            new Symfony\Bundle\DoctrineBundle\DoctrineBundle(),
            new Symfony\Bundle\DoctrineFixturesBundle\DoctrineFixturesBundle(),
            new Symfony\Bundle\AsseticBundle\AsseticBundle(),
            new Sensio\Bundle\FrameworkExtraBundle\SensioFrameworkExtraBundle(),
            new JMS\SecurityExtraBundle\JMSSecurityExtraBundle(),

            new Knplabs\Bundle\MenuBundle\KnplabsMenuBundle(),
            new Knplabs\Bundle\SnappyBundle\KnplabsSnappyBundle(),
            new Knp\Bundle\PaginatorBundle\KnpPaginatorBundle(),
            new AntiMattr\GoogleBundle\GoogleBundle(),
            new Fp\OpenIdBundle\FpOpenIdBundle(),

            new Naus\Api\NausApi(),
            new Naus\App\NausApp(),
            new Naus\Cms\NausCms(),
            new Naus\Crm\NausCrm(),
            new Naus\Event\NausEvent(),
            new Naus\Form\NausForm(),
            new Naus\Invoicing\NausInvoicing(),
            new Naus\Mail\NausMail(),
            new Naus\Media\NausMedia(),
            new Naus\Member\NausMember(),
            new Naus\Meta\NausMeta(),
            new Naus\Project\NausProject(),
            new Naus\Vacancy\NausVacancy(),
            new Naus\Workgroup\NausWorkgroup(),
            new Naus\Biobalance\NausBiobalance(), 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:57:39.110

显然，设置 config.yml 中的 auto_mapping 设置可以解决问题。

# ios - iOS：无法弄清楚如何编写正确的方法

> ID：10401848
> 
> 赞同：0
> 
> 时间：2012-05-01T17:46:11.603
> 
> 标签：ios, cocoa-touch, sqlite

我已经管理了 NSUserDefaults 并坚持编写根据 standardUserDefaults 中的设置过滤 SQL 选择的方法。

我的应用显示了 6 个大洲，用户可以选择禁用其中的一些。在我的 SQL 方法中，我目前尝试以这种方式管理它：

```
if (![[NSUserDefaults standardUserDefaults] boolForKey:@"europe"])
    {
        sqlContinents="SELECT cont.continentID,cont.continentName,cont.continentImage\
        FROM Continents as cont\
        WHERE cont.continentID <> 1";           
    } 
```

如果用户仅禁用欧洲，它将起作用，但如果他将禁用更多大陆怎么办......所以我无法弄清楚如何编写代码来检查哪些大陆被禁用并省略它们。

当然，可以选择编写许多“ifs”，例如 if(![[NSUserDefaults standardUserDefaults] boolForKey:@"europe"] && ....&&......)，但如果有人愿意，我将不胜感激向我展示如何以更智能和优雅的方式实现这种方法。先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T17:59:42.623

您可以创建一个 WHERE 字符串来保存 SQL 语句之前的所有条件。

```
NSString where = @"WHERE";

if (![[NSUserDefaults standardUserDefaults] boolForKey:@"europe"]){
   where = [where stringByAppendingString: @" cont.continentID <> 1 "];
}

// Rest of continents...

sqlContinents = [@"SELECT cont.continentID,cont.continentName,cont.continentImage\
        FROM Continents as cont " stringByAppendingString: where]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T18:23:55.230

另一种方法：sqlite 知道 where 子句中的 IN，因此可以设置一个带有诸如 "1, 4, 5" 之类的 continet ID 的字符串，从而生成一个语句

```
sql = [NSString stringWithFormat:@"... WHERE cont.continetID NOT IN (%@)", string]; 
```

# iphone - 如何在 Cocoa Touch 中处理用户名？

> ID：10401851
> 
> 赞同：1
> 
> 时间：2012-05-01T17:46:28.863
> 
> 标签：iphone, ios, cocoa-touch

我有一个登录视图控制器，它使用 php/mysql/POST 函数来验证用户是否被授权。一旦获得授权，他们就会进入应用程序。

我的问题是，一旦他们在应用程序中，我如何“获取”他们的用户名并使用它来附加到他们在我的应用程序中上传到我的数据库的任何数据？

我假设我将它附加到我当前的 NSMutableData 字符串中，该字符串带有他们上传的文本块，但我将如何“抓住”这个用户名来附加它？

假设我有两个视图控制器，“login”和“main”，并且内容正在上传到“main”，如何将用户名从“login”视图传递到“main”视图，以便我可以附加它当用户点击上传按钮（位于主视图上）时？

编辑：我希望检索此用户名的位置如下：

```
-(IBAction)uploadImage:(id)sender  {
NSLog(@"uploadImage");

//and for retrieval

NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
NSString *authenticatedUsersName = [defaults objectForKey:@"username"];

NSMutableString *postString = [NSMutableString stringWithString:kPostURL]; 

[postString appendString:[NSString stringWithFormat:@"&%@=%@", kText, textField.text]];

[postString setString:[postString stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T18:02:23.217

如果您不关心用户名的安全性，为什么不在`NSUserDefaults`成功验证后存储用户名？你可以做这样的事情......

```
//upon authentication...

NSUserDefault *defaults = [NSUserDefaults standardUserDefaults];
if ([defaults objectForKey:@"username"] == nil) //we haven't saved anything yet
     [defaults setObject:authenticatedUsersName forKey:@"username"];

[defaults synchronize];  //saves the new defaults

//and for retrieval

NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
NSString *authenticatedUsersName = [defaults objectForKey:@"username"]; 
```

我认为这种设计为您提供了更大的灵活性，因此您可以在应用程序中的所有视图控制器中使用用户名。

*重新编辑后*

为什么你不能在这个函数的某个地方格式化字符串？确切的帖子网址格式是什么？

```
 -(IBAction)uploadImage:(id)sender  {
    NSLog(@"uploadImage");

    //and for retrieval     

    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
    NSString *authenticatedUsersName = [defaults objectForKey:@"username"];

    //MY CHANGES, CAN YOU DO EITHER OF THESE?

    NSMutableString *postString = [NSMutableString stringWithString:[NSString stringWithFormat:@"%@-%@", kPostURL, authenticatedUsersName]; 

    [postString appendString:[NSString stringWithFormat:@"&%@=%@&%@", kText, textField.text, authenticatedUsersName]];

    [postString setString:[postString stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]];

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T20:46:35.100

拥有全局可用变量的另一种方法是使用单例类。

这比使用 NSUserDefaults 的 Convolution 解决方案稍微困难一些，但它更适合某些用例。

以下位置有一个很好的教程： [http ://www.galloway.me.uk/tutorials/singleton-classes/](http://www.galloway.me.uk/tutorials/singleton-classes/)

# java - Guice 如何将 ServletContext/ServletConfig 传递给绑定？

> ID：10401852
> 
> 赞同：1
> 
> 时间：2012-05-01T17:46:29.403
> 
> 标签：java, servlets, guice

嗨，我想知道当我们使用它们的 serve().with() 绑定路由时，Guice 如何将隐式对象传递给 Servlet？我定义了一个自定义路由器 servlet，它将创建一个 Servlet 实例并根据请求调用它的 doGet() 和 doPost()。我这样做是为了允许直接假设目录 A 下的 Servlet 具有自动绑定。

我们可以通过绑定一个绑定来通过这个路由器为 /A 提供所有请求，这个路由器将绑定目录 A 下的所有 servlet 并在它们上调用 doGet()/doPost()。这种方法的问题是调用 getServletContext() 会引发 NullPointerException。

对于解决方案，我最终从路由器 Servlet 传入了 ServletCotext。（当我尝试重定向到 jsp 时，这不起作用）

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-06T23:47:06.820

如果你看一下源码，所有的隐式对象都是通过 ThreadLocal 访问的。

# facebook - 就像一个开放图动作

> ID：10401857
> 
> 赞同：1
> 
> 时间：2012-05-01T17:46:58.297
> 
> 标签：facebook, facebook-opengraph

我已经创建了一个应用程序及其相关的 Open Graph 操作，已获得 Facebook 的批准。

当用户在他们的提要中发布活动/动作时，可以从那里“喜欢”它。但是是否可以从另一个页面喜欢它，即。用“喜欢”插件？不是应用程序用户的人？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T21:58:48.887

要喜欢一个动作，您需要让用户 access_token 或为此使用 FB api

如此处所述：[https ://developers.facebook.com/docs/opengraph/actions/#like_action](https://developers.facebook.com/docs/opengraph/actions/#like_action)

这是我们的做法：

```
 FB.api("[action id]/likes", "post", function(response){...}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T18:00:54.270

Like 按钮与 url 一起使用，这就是 facebook 索引页面的方式。

图形对象具有定义它们的 url，因此您当然可以将图形对象的 url 作为类似按钮的 url。图形操作没有网址，因此我认为您不能将点赞按钮附加到操作上。

我很确定没有办法喜欢 Facebook 之外的动作。

# centos - 无法获取 Centos 5.8 软件包的源 RPM

> ID：10401858
> 
> 赞同：1
> 
> 时间：2012-05-01T17:46:59.143
> 
> 标签：centos, rpm, yum

我正在尝试使用 yumdownloader ，但出现错误：

```
$ yumdownloader --source ntp
Loaded plugins: fastestmirror, priorities
No source RPM found for ntp-4.2.2p1-15.el5.centos.1.i386
Nothing to download

$ yumdownloader --source openssh
Loaded plugins: fastestmirror, priorities
No source RPM found for openssh-4.3p2-82.el5.i386
Nothing to download 
```

我在 CentOs 5.8 上。有任何想法吗 ？我查看了很多网站，但 .repo 文件的解决方案都不起作用

似乎 CentOs 已将其源 RPM 移至 Vault (vault.centos.org) 但我不确定如何设置 /etc/yum.repos.d/CentOS-SRPMS.repo 文件任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-25T04:26:44.463

我怀疑您的源代码库使用了错误的版本，或者仍然配置为好像 Johnny 等人想让获取旧 SRPM 变得不那么麻烦。手动点击[http://vault.centos.org/5.8/updates/SRPMS/](http://vault.centos.org/5.8/updates/SRPMS/)，或调整您的 /etc/yum.repos.d/foo.repo 文件以适应。

# ruby - S3 混淆 const_missing_from_s3_library 错误

> ID：10401859
> 
> 赞同：2
> 
> 时间：2012-05-01T17:47:08.663
> 
> 标签：ruby, amazon-s3

我使用的是典型的 Mac/Ruby 1.9.3p125

```
irb>

require 'aws/s3'
AWS::S3::Base.establish_connection!(:access_key_id => 'AccessKey',:secret_access_key => 'SecretKey' )
Service.buckets 
```

（与 Bucket.find 或几乎任何东西都相同的错误！）

给我：

```
NameError: uninitialized constant Service
from ~/.rvm/gems/ruby-1.9.3-p125/gems/aws-s3-0.6.2/lib/aws/s3/extensions.rb:206
 :in `const_missing_from_s3_library'
from (irb):23
from ~/.rvm/rubies/ruby-1.9.3-p125/bin/irb:16:in `<main>' 
```

我几乎按照规范遵循文档，但我很困惑为什么会这样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T20:33:11.210

您需要在您的课程中包含 AWS::S3 或执行 AWS::S3.Service。

以下是一些代码示例：

```
require 'aws/s3'
class MyClass
  include AWS::S3
  AWS::S3::Base.establish_connection!(:access_key_id => 'AccessKey',:secret_access_key => 'SecretKey' )
  Service.buckets
end 
```

或者

```
require 'aws/s3'
class MyClass
  AWS::S3::Base.establish_connection!(:access_key_id => 'AccessKey',:secret_access_key => 'SecretKey' )
  AWS::S3::Service.buckets
end 
```

# google-app-engine - 引用 Memcache 对象并更新它们

> ID：10401862
> 
> 赞同：2
> 
> 时间：2012-05-01T17:47:22.647
> 
> 标签：google-app-engine, memcached

这是关于 GAE / Java Memcache 的一个非常普遍的问题：

我有一个名为 Network 的对象，它存储在 Memcache 中，我还有另一个名为 User 的对象，它引用了 Network 。

```
Network network=Memcache.get(networkKey);
user._network=network;    //user references an object that came from Memcache... 
```

现在我有一堆代码可以改变 user._network（不接触 Memcache）：

user._network= // 对对象进行一些更改，而不涉及 Memcache

好的，问题来了，看看代码，最后一行是否更新了内存缓存中的网络对象？我有需要访问更新的网络对象的 servlet，问题是我是否将 Memcache 对象视为常规对象是错误的。

也许正确的方法是这样？

```
Network network=Memcache.get(networkKey);
network.doUpdate();
Memcache.put(key,network); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T20:34:12.613

您提供的后一个代码示例是更新 memcache 中的网络对象的正确方法，但它的工作方式与您期望的方式不同。

您的用户对象是指从内存缓存中检索到的网络对象的一个​​实例。每次从 memcache 中检索对象时，都会得到一个不同的实例。而且，由于实例在逻辑上与缓存中的原始实例不同，一旦更新缓存值，这些实例将与缓存版本不同步。

例如：

```
Network network=Memcache.get(networkKey);
Network networkTwo = Memcache.get(networkKey);
user._network=network;
networkTwo.doUpdate();
// network and networkTwo are now different
Memcache.put(networkKey,networkTwo);
// user._network still refers to the initial instance of network, not networkTwo 
```

如果您希望用户对象始终引用内存缓存中的网络版本，则需要在代码中添加额外的逻辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T20:37:34.373

该代码确实会更新 memcache 中的 Network 对象，但不会更新对应用程序其他部分中已经拥有该 Network 实例句柄的对象的引用。Memcache 存储 SERIALIZED 对象。

在 GAE 中使用 memcache 的最佳方式是与 Objectify 之类的东西结合使用，以缓存数据存储对象并存储生成成本高昂的大型对象集合。它不太适合存储经常更改的对象或应用程序中许多其他对象使用的对象。

# email - 如何发送行长超过 990 个字符的 csv 附件？

> ID：10401863
> 
> 赞同：16
> 
> 时间：2012-05-01T17:47:25.613
> 
> 标签：email, csv, mime-types, attachment, sendgrid

好的。我认为这个问题与我的 rails 应用程序有关，但似乎与电子邮件附件的更深层次的工作有关。

我必须从我的 rails 应用程序将一个 csv 文件发送到一个仓库，以履行我商店中的订单。仓库有 CSV 格式，讽刺的是 CSV 文件的标题行超长（1000+ 个字符）。

当我收到测试电子邮件时，我在 csv 文件的标题行中出现换行符，但无法弄清楚它放在那里的内容。但是，一些谷歌搜索终于找到了原因：附件的行字符限制为 1000。为什么？我不知道。这看起来很荒谬，但我仍然必须以某种方式发送这个 csv 文件。

我尝试手动将附件的 MIME 类型设置为 text/csv，但这无济于事。有谁知道如何解决这个问题？

一些相关的谷歌搜索结果：[http ://www.google.com/search?client=safari&rls=en&q=csv+wrapped+990&ie=UTF-8&oe=UTF-8](http://www.google.com/search?client=safari&rls=en&q=csv+wrapped+990&ie=UTF-8&oe=UTF-8)

**更新**

我试过用base64编码附件，如下所示：

```
 attachments['205.csv'] = {:data=> ActiveSupport::Base64.encode64(@string), :encoding => 'base64', :mime_type => 'text/csv'} 
```

这似乎没有什么不同。我通过 Mac 版 Sparrow 收到带有 me.com 帐户的电子邮件。我会尝试使用 gmail 的网络界面。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-05-05T17:52:02.030

这似乎是因为 SendGrid 邮件服务器正在修改附件内容。如您所见，如果您发送带有纯文本存储 mime 类型（例如`text/csv`）的附件，它将每 990 个字符包装一次内容。我认为这与[RFC 2045/821](https://www.rfc-editor.org/rfc/rfc2045)有关：

> 6.  内容传输编码头字段
>     
>     
>     
>     许多可以通过电子邮件有效传输的媒体类型以其“自然”格式表示为 8 位字符或二进制
>     数据。此类数据无法通过某些传输协议传输。
>     例如，RFC 821 (SMTP) 将邮件消息限制为 7 位 US-ASCII
>     数据，行数不超过 1000 个字符，包括任何尾随 CRLF 行分隔符。
>     
>     
>     
>     因此，有必要定义一种标准机制，
>     将此类数据编码为 7 位短线格式。也希望以较少限制的格式对未编码材料进行适当的标记
>     ，以便直接用于限制较少的传输。本文档
>     规定，此类编码将由新的“Content
>     -Transfer-Encoding”头字段指示。该字段尚未由
>     任何以前的标准定义。

如果您使用 base64 编码而不是默认的 7 位发送附件，则附件保持不变（不添加换行符）：

```
attachments['file.csv']= { :data=> ActiveSupport::Base64.encode64(@string), :encoding => 'base64' } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-05T04:34:26.467

您的数据中是否有会导致这种情况的换行符？检查看看是否

```
csv_for_orders(orders).lines.count == orders.count 
```

如果是这样，一个快速/hackish 修复可能会改变您调用`values_for_line_item(item)`的位置`values_for_line_item(item).map{|c| c.gsub(/(\r|\n)/, '')}`（对于其他 line_item 调用也是如此）。

# wordpress - 如何解决激活 WP 插件中的此错误？

> ID：10401864
> 
> 赞同：0
> 
> 时间：2012-05-01T17:47:26.983
> 
> 标签：wordpress

我试图在安装它之后激活这个插件[http://wordpress.org/extend/plugins/the-layout-grid/](http://wordpress.org/extend/plugins/thethe-layout-grid/)但我收到了这个错误：插件无法被激活，因为它触发了一个致命错误。

我怎么解决这个问题 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T00:06:49.013

*   在 WordPress 插件的[支持页面中询问](http://wordpress.org/tags/thethe-layout-grid?forum_id=10#postform)

*   禁用所有其他插件并尝试激活TheThe插件，如果它有效，则一个一个启用其他插件，直到找到冲突

*   确保您使用插件所需的最低 WP 版本（*至少需要：3.0*）

*   检查您的服务器错误日志，看看那里是否有线索

# multithreading - 如何在应用程序关闭时终止 Delphi 中的匿名线程？

> ID：10401865
> 
> 赞同：9
> 
> 时间：2012-05-01T17:47:33.887
> 
> 标签：multithreading, delphi, delphi-xe2, anonymous, terminate

我有一个 Delphi 应用程序，它在一些 TTimer.OnTimer 事件上产生 6 个匿名线程。

如果我从标题栏中的 X 按钮关闭应用程序，地址 $C0000005 的访问冲突就会引发，并且 FastMM 报告泄漏的 TAnonymousThread 对象。

在使用 TThread.CreateAnonymousThread() 方法在 OnTimer 事件中创建的 Delphi 中释放匿名线程的最佳方法是什么？

对我有用的解决方案：

创建了匿名线程的包装器，在被释放后终止它们。

```
type
  TAnonumousThreadPool = class sealed(TObject)
  strict private
    FThreadList: TThreadList;
    procedure TerminateRunningThreads;
    procedure AnonumousThreadTerminate(Sender: TObject);
  public
    destructor Destroy; override; final;
    procedure Start(const Procs: array of TProc);
  end;

{ TAnonumousThreadPool }

procedure TAnonumousThreadPool.Start(const Procs: array of TProc);
var
  T: TThread;
  n: Integer;
begin
  TerminateRunningThreads;

  FThreadList := TThreadList.Create;
  FThreadList.Duplicates := TDuplicates.dupError;

  for n := Low(Procs) to High(Procs) do
  begin
    T := TThread.CreateAnonymousThread(Procs[n]);
    TThread.NameThreadForDebugging(AnsiString('Test thread N:' + IntToStr(n) + ' TID:'), T.ThreadID);
    T.OnTerminate := AnonumousThreadTerminate;
    T.FreeOnTerminate := true;
    FThreadList.LockList;
    try
      FThreadList.Add(T);
    finally
      FThreadList.UnlockList;
    end;
    T.Start;
  end;
end;

procedure TAnonumousThreadPool.AnonumousThreadTerminate(Sender: TObject);
begin
  FThreadList.LockList;
  try
    FThreadList.Remove((Sender as TThread));
  finally
    FThreadList.UnlockList;
  end;
end;

procedure TAnonumousThreadPool.TerminateRunningThreads;
var
  L: TList;
  T: TThread;
begin
  if not Assigned(FThreadList) then
    Exit;
  L := FThreadList.LockList;
  try
    while L.Count > 0 do
    begin
      T := TThread(L[0]);
      T.OnTerminate := nil;
      L.Remove(L[0]);
      T.FreeOnTerminate := False;
      T.Terminate;
      T.Free;
    end;
  finally
    FThreadList.UnlockList;
  end;
  FThreadList.Free;
end;

destructor TAnonumousThreadPool.Destroy;
begin
  TerminateRunningThreads;
  inherited;
end; 
```

在这里结束是你如何称呼它：

```
procedure TForm1.Button1Click(Sender: TObject);
begin
  FAnonymousThreadPool.Start([ // array of procedures to execute
    procedure{anonymous1}()
    var
      Http: THttpClient;
    begin
      Http := THttpClient.Create;
      try
        Http.CancelledCallback := function: Boolean
          begin
            Result := TThread.CurrentThread.CheckTerminated;
          end;
        Http.GetFile('http://mtgstudio.com/Screenshots/shot1.png', 'c:\1.jpg');
      finally
        Http.Free;
      end;
    end,

    procedure{anonymous2}()
    var
      Http: THttpClient;
    begin
      Http := THttpClient.Create;
      try
        Http.CancelledCallback := function: Boolean
          begin
            Result := TThread.CurrentThread.CheckTerminated;
          end;
        Http.GetFile('http://mtgstudio.com/Screenshots/shot2.png', 'c:\2.jpg');
      finally
        Http.Free;
      end;
    end
  ]);
end; 
```

没有内存泄漏，正确关闭且易于使用。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-01T18:31:50.743

如果您想维护和控制线程的生命周期，那么它必须`FreeOnTerminate`设置为`False`. 否则在线程开始执行后引用它是错误的。那是因为一旦它开始执行，你就无法知道它是否已经被释放了。

调用[`CreateAnonymousThread`](http://docwiki.embarcadero.com/Libraries/en/System.Classes.TThread.CreateAnonymousThread)创建一个`FreeOnTerminate`设置为的线程`True`。

> 该线程也被标记为 FreeOnTerminate，因此您不应在调用 Start 后触摸返回的实例。

因此，默认情况下，您无法控制线程的生命周期。但是，您可以在调用 之前立即设置`FreeOnTerminate`为。像这样：`False``Start`

```
MyThread := TThread.CreateAnonymousThread(MyProc);
MyThread.FreeOnTerminate := False;
MyThread.Start; 
```

但是，我不确定我会这样做。的设计`CreateAnonymousThread`是线程在终止时自动释放。我想我个人要么遵循预期的设计，要么派生出我自己的`TThread`后代。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-03-10T23:54:25.093

为了避免在启动之前使用`CreateAnonymousThread`刚刚设置`FreeOnTerminate`的错误。`False`

这样您就可以像平常一样使用线程，而无需任何解决方法。

您可以阅读说明`CreateAnonymousThread`自动设置`FreeOnTerminate`为的文档，`True`这就是您引用线程时导致错误的原因。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-01T18:28:54.077

让你的线程留意来自外部的某种通知。这可能是收到信号的事件、发送到线程拥有的窗口的消息、通过线程侦听的套接字发送的命令，或者您发现的任何其他形式的通信。

如果您确定这个问题是因为您的线程是所谓的“匿名”线程，那么一个简单的解决方法是让它们成为非匿名线程。将匿名函数的主体放入`Execute`方法中，并通过其构造函数将任何捕获的变量传递给线程类。

# python - MySQL 和 Python Select 语句问题

> ID：10401873
> 
> 赞同：6
> 
> 时间：2012-05-01T17:48:00.453
> 
> 标签：python, mysql, select, encoding

感谢您抽时间阅读。这将是一个很长的帖子来解释这个问题。我无法在所有常用来源中找到答案。

问题：我在使用 python 的 select 语句从 mysql 数据库中的表中调用数据时遇到问题。

系统和版本：

```
Linux ubuntu 2.6.38-14-generic #58-Ubuntu SMP Tue Mar 27 20:04:55 UTC 2012 x86_64 x86_64 x86_64 GNU/Linux
Python: 2.7.1+
MySql: Server version: 5.1.62-0ubuntu0.11.04.1 (Ubuntu) 
```

这是表格：

```
mysql> describe hashes;
+-------+--------------+------+-----+---------+-------+
| Field | Type         | Null | Key | Default | Extra |
+-------+--------------+------+-----+---------+-------+
| id    | varchar(20)  | NO   | PRI | NULL    |       |
| hash  | varbinary(4) | NO   | MUL | NULL    |       |
+-------+--------------+------+-----+---------+-------+ 
```

以下是我希望通过普通 mysql 查询得到的响应：

```
mysql> SELECT id FROM hashes WHERE hash='f'; 
+------+
| id   |
+------+
| 0x67 |
+------+

mysql> SELECT id FROM hashes WHERE hash='ff'; 
+--------+
| id     |
+--------+
| 0x6700 |
+--------+ 
```

和以前一样，这些是预期的响应以及我如何设计数据库。

我的代码：

```
import mysql.connector
from database import login_info
import sys
db = mysql.connector.Connect(**login_info)
cursor = db.cursor()
data = 'ff'
cursor.execute("""SELECT
            * FROM hashes
            WHERE hash=%s""",
            (data))

rows = cursor.fetchall()
print rows
for row in rows:
        print row[0] 
```

这将返回我期望的结果：

```
[(u'0x67', 'f')]
0x67 
```

如果我将 data 更改为 : data = 'ff' 我会收到以下错误：

```
Traceback (most recent call last):
 File "test.py", line 11, in <module>
    (data))
  File "/usr/local/lib/python2.7/dist-packages/mysql_connector_python-0.3.2_devel-    py2.7.egg/mysql/connector/cursor.py", line 310, in execute
    "Wrong number of arguments during string formatting")
mysql.connector.errors.ProgrammingError: Wrong number of arguments during string formatting 
```

好的。因此，我在我的 SQL 语句中添加了一个字符串格式化字符，如下所示：

```
cursor.execute("""SELECT
            * FROM hashes
            WHERE hash=%s%s""",
            (data)) 
```

我得到以下回复：

```
[(u'0x665aa6', "f'f")]
0x665aa6 
```

它应该是 0x6700。

我知道我应该用一个 %s 字符传递数据。这就是我构建数据库表的方式，每个变量使用一个 %s：

```
cursor.execute("""
INSERT INTO hashes (id, hash) 
VALUES (%s, %s)""", (k, hash)) 
```

任何想法如何解决这一问题？

谢谢。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-05-01T18:18:14.697

您的执行语句似乎不太正确。我的理解是它应该遵循模式 `cursor.execute( <select statement string>, <tuple>)`，并且通过在元组位置只放置一个值，它实际上只是一个字符串。要使第二个参数成为正确的数据类型，您需要在其中放置一个逗号，因此您的语句如下所示：

```
cursor.execute("""SELECT
            * FROM hashes
            WHERE hash=%s""",
            (data, )) 
```

# macos - Java 7，Mac OS 上的键盘与菜单冲突

> ID：10401875
> 
> 赞同：0
> 
> 时间：2012-05-01T17:48:11.710
> 
> 标签：macos, java-7

如何让 Java 7 应用程序的菜单栏位于屏幕顶部（在 Mac 上），并且键盘快捷键也可以正常工作？

我有一个带有 Swing 用户界面的 Java 应用程序。许多菜单都有键盘等效项，这是必不可少的。

与系统相关的内容很少，但在 Mac OS X 上，菜单栏应该出现在屏幕顶部而不是每个窗口上，所以我设置了`apple.laf.useScreenMenuBar`.

这在 Java 6 上运行良好，但在 Java 7（上周发布！）上编译和运行相同的代码会导致键盘快捷键执行两次菜单操作。例如，在附加的代码中，`Command ⌘`+`O`打开两个文件对话框而不是一个。（其他键盘快捷键也有两次作用，但有时您必须移动窗口才能看到它们的作用。）

如果我不设置`apple.laf.useScreenMenuBar`，键盘问题就会消失，如果我必须这样做，我会这样做，但我的 Mac 用户会不高兴。我真的很想将菜单栏放在正确的位置，并且键盘快捷键可以正常工作。

* * *

**系统：** 2010 年末 MacBook Pro 上的 Mac OS 10.7.3 (Lion)

**Java 7：**
Java 版本“1.7.0_04”
Java(TM) SE 运行时环境（构建 1.7.0_04-b21）
Java HotSpot(TM) 64 位服务器 VM（构建 23.0-b21，混合模式）

**Java 6：**
Java 版本“1.6.0_31”
Java(TM) SE 运行时环境（构建 1.6.0_31-b04-415-11M3635）
Java HotSpot(TM) 64 位服务器 VM（构建 20.6-b01-415，混合模式）

* * *

**我看过的地方：**

关于[为什么`apple.laf.useScreenMenuBar`应该摆脱的](http://mail.openjdk.java.net/pipermail/macosx-port-dev/2011-December/001639.html)讨论 ——我完全赞成，但它似乎没有发生。

一个关于[不使用`mrj.version`来检测你在 Mac 上的](http://osdir.com/ml/macosx-port-development-java/2012-02/msg00687.html)讨论 ——不直接相关，但听起来很有希望。

对于附加代码的长度（148 行），我深表歉意，但我的 Swing 编码非常过时。它应该在没有任何特殊标志或设置的情况下从命令行编译和运行。

```
import javax.swing.*;
import java.awt.Toolkit;
import java.awt.*;
import java.awt.event.*;

/**
 * Shows that using the single screen-top menu bar on a Mac with Java 7
 * causes keyboard shortcuts to act twice.
 *
 * To see the problem(on a Mac -- running OS X 10.7.3 in my case):
 *   1) compile on either Java 6 or Java 7
 *   2) run on Java 7
 *   3) give the command-O shortcut
 * You will see two file dialogues.
 *
 *      -- J. Clarke, May 2012
 */

public class MenuBug {

    private static void go(String[] args) {

        // Comment out the following line to fix the problem;
        // leave it active to see the problem.
        // It doesn't help to ...
        // ... put the line into a static block.
        // ... put the line right after the setLookAndFeel call.
        // ... put the line before after the setLookAndFeel call.
        System.setProperty("apple.laf.useScreenMenuBar", "true");

        MainWindow mainWindow = new MainWindow();
    }

    public static void main(final String[] args) {
        try {
            UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
        }
        catch (Exception e) {
            JOptionPane.showMessageDialog(null,
                    e + " while loading look and feel",
                    "MenuBug error", JOptionPane.ERROR_MESSAGE);
            System.exit(1);
        }

        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                go(args);
            }
        });
    }
}

class MainWindow extends JFrame {

    MainWindow() {
        super ("Main Window");

        setDefaultCloseOperation(WindowConstants.DO_NOTHING_ON_CLOSE);
        addWindowListener (new WindowAdapter() {
                public void windowClosing(WindowEvent e) {
                    dispose();
                    System.exit(0);
                }
            });

        JMenuBar menuBar = createMenuBar();
        setJMenuBar(menuBar);

        pack();
        setSize(350,300);
        setVisible(true);
    }

    private JMenuBar createMenuBar() {
        JMenuBar mBar = new JMenuBar();
        JMenu menu = new JMenu("File");
        String[] menuItemNames = new String[] {"New", "Open...", "Other"};
        for (int i = 0; i < menuItemNames.length; i++) {
            String miName = menuItemNames[i];
            JMenuItem mi = new JMenuItem(miName);
            mi.setActionCommand(miName);
            linkMenuItemToAction(mi);
            menu.add(mi);
        }
        mBar.add(menu);
        return mBar;
    }

    /**
     * Create an Action for menuItem, and make sure the action and the menu
     * item know about each other; where appropriate, add keyboard equivalents.
     * @param menuItem  The menu item to be linked to an action.
     */
    private void linkMenuItemToAction(JMenuItem menuItem) {
        final int META_MASK =
                Toolkit.getDefaultToolkit().getMenuShortcutKeyMask();
        Action a = null;

        String miName = menuItem.getActionCommand();
        if (miName.equals ("New")) {
            a = new NewAction();
            menuItem.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_N,
                    META_MASK));
        }
        else if (miName.equals ("Open...")) {
            a = new OpenAction();
            menuItem.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_O,
                    META_MASK));
        }
        else if (miName.equals ("Other")) {
            a = new OtherAction();
            menuItem.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_T,
                    META_MASK));
        }

        menuItem.setEnabled(a.isEnabled());
        menuItem.addActionListener(a);
    }

    private class NewAction extends AbstractAction {
        public void actionPerformed(ActionEvent e) {
            new MainWindow();
        }
    }

    private void makeDialog() {
        String dialogTitle = "Please choose a file to open";
        FileDialog fileDialog = new FileDialog(this, dialogTitle,
                FileDialog.LOAD);

        fileDialog.setVisible(true);
        String fileName = fileDialog.getFile();
    }

    private class OpenAction extends AbstractAction {
        public void actionPerformed(ActionEvent e) {
            makeDialog();
        }
    }

    private class OtherAction extends AbstractAction {
        public void actionPerformed(ActionEvent e) {
            JOptionPane.showMessageDialog(null,
                    "an example message",
                    "not really an error", JOptionPane.ERROR_MESSAGE);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-12T21:02:28.280

我正在回答我自己的问题 - 有点。正如对原文的评论中所指出的，Java 1.7u10 的问题消失了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-27T06:08:08.713

看起来这个问题仍然存在，但现在它可以在 1.7_21 的 mac 上使用 fn + backSpace (delete) 重现。

我使用了与上面相同的示例，只是添加了文本字段。选择文本字段中的部分文本并按删除（fn+退格键）

在 linkMenuItemToAction 方法中将 KeyStroke 更改为“DELETE”

```
else if (miName.equals ("Other")) 
{
 a = new OtherAction();
 menuItem.setAccelerator(KeyStroke.getKeyStroke("DELETE"));
} 
```

并添加：

```
JTextField textField = new JTextField(10);
textField.setText("Long long long long long long long text");
add(textField, BorderLayout.PAGE_START); 
```

到 MainWindow 构造函数。

# linux-kernel - 为linux内核编译模块时出错

> ID：10401879
> 
> 赞同：0
> 
> 时间：2012-05-01T17:48:39.397
> 
> 标签：linux-kernel, linux-device-driver, kernel-module

我正在使用 Fedora 16。内核是 3.3.2.-6.fc16.i686.PAE。我已经安装了正确的内核 devel。但是当我尝试针对它编译任何模块时，我收到下面提到的错误

> 没有规则来制作目标 `/usr/src/kernels/3.3.2-6.fc16.i686.PAE/arch/x86/syscalls/syscall_32.tbl', needed by`arch/x86/syscalls/../include/generated/asm/unistd_32.h'。停止。

知道什么是错的，需要做什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T09:06:54.047

如果您有内核源代码，只需再次编译它并尝试编译您的模块。

# mysql - MySQL加入最高？

> ID：10401881
> 
> 赞同：0
> 
> 时间：2012-05-01T17:48:43.973
> 
> 标签：mysql

我有两张桌子，一张叫项目，一张叫出价。出价包含一堆带有 item_id 的出价。我正在尝试获取有关具有相关最高出价的项目的所有信息。

我试着做类似的事情

```
SELECT * FROM items JOIN bids ON items.id=bids.item_id GROUP BY item_id 
```

然而，这似乎返回了第一个出价，而不是最高的。

我怎样才能达到最高？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T18:26:11.557

您需要使用子查询来发现最大出价值，然后将其与现有查询相结合以获得所有所需的输出数据。假设出价在名为 的列中`value`，并且该`bids`表的 PK 为名为 的列`id`：

```
SELECT items.*, bids.*
FROM
  items
  JOIN (
    SELECT id, item_id, MAX(value) AS value FROM bids GROUP BY item_id
  ) AS maxbids ON items.id = maxbids.item_id
  JOIN bids    ON  bids.id = maxbids.id
GROUP BY items.id 
```

如果有多个最大金额的出价，则此查询将返回所有出价。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-11T07:22:10.390

我认为，自加入也可以。所以，假设（正如[@eggyal 所做](https://stackoverflow.com/questions/10401881/mysql-join-with-highest#99667)的那样）有一个`bids.value`列：

```
SELECT *
FROM items i
  JOIN bids b1 ON b1.item_id=i.id
  JOIN bids b2 ON b2.item_id=i.id AND b2.value>b1.value
WHERE b2.id IS NULL 
```

但是，如果有多个相同金额的出价，这将返回多行。你想如何处理它们？

（这`SELECT *`应该缩小范围。）

# .net - 0xc0000005 启动.Net进程时

> ID：10401882
> 
> 赞同：3
> 
> 时间：2012-05-01T17:48:48.037
> 
> 标签：.net, 32bit-64bit

我们有一个 .Net 应用程序很长时间了。所有的 .exe 都设置为 x86（realease 和 debug 配置）

我们刚刚发布了一个新版本，突然间，我们的可执行文件将无法在特定的 Windows 7 64 位机器上启动。

事件查看器报告：0xc0000005（访问冲突）

在将我们的应用程序剥离到最低限度后（一个对我们程序集之一的引用，Main() 中的一行：Console.ReadKey()，app.config 文件为空），问题仍然存在。

使其工作的唯一方法是将平台目标设置为 AnyCPU，这不合适，因为我们使用 3rdParty 组件。

知道为什么我有这个问题吗？任何可能的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T19:54:16.800

.Net 和 0xc0000005 是 Microsoft 的 Karel Zikmund 多年来详细解释的一个已知问题。下面是他的 MSDN 帖子，从他早期到更怨恨，所以你可以看到整个线程以及其他人是如何受到影响的，以及他们在很多情况下是如何工作的。这些线程之一如何帮助您。

[http://social.msdn.microsoft.com/Forums/en-US/clr/thread/25ce2de0-1556-4f1f-979d-420bdd212abf](http://social.msdn.microsoft.com/Forums/en-US/clr/thread/25ce2de0-1556-4f1f-979d-420bdd212abf)

[http://social.msdn.microsoft.com/Forums/en-US/clr/thread/2b89ca3a-6a93-4d21-a5eb-d5b5d44c6dce](http://social.msdn.microsoft.com/Forums/en-US/clr/thread/2b89ca3a-6a93-4d21-a5eb-d5b5d44c6dce)

[http://social.msdn.microsoft.com/Forums/en-CA/clr/thread/dd3be208-c46c-4a5d-94ce-f93766c9d122](http://social.msdn.microsoft.com/Forums/en-CA/clr/thread/dd3be208-c46c-4a5d-94ce-f93766c9d122)

# .net - 使用 XML 文件作为数据库

> ID：10401883
> 
> 赞同：1
> 
> 时间：2012-05-01T17:48:52.950
> 
> 标签：.net, vb.net, vb.net-2010

如何将 XML 文件用作数据库并仅在其上执行一些基本的 SELECT 命令！
例如：**从 file.xml 中选择作者，其中 title="MyTitle"**

```
<?xml version="1.0"?>
<catalog>
<book id="bk101">
  <author>Gambardella, Matthew</author>
  <title>XML Developer's Guide</title>
</book>
<book id="bk102">
  <author>Ralls, Kim</author>
  <title>Midnight Rain</title>
</book>
</catalog> 
```

*我从来没有使用过 XML 文件（作为 DB）所以没有代码可以放在这里，但希望有人有一些解决方案！*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T17:55:21.403

我不相信您可以简单地对 XML 使用 SQL，而不需要大量工作（可以使用 XML 解析器转换为您的 XML 结构的 SQL 解析器）。

您可以获得的最接近的方法是将 LINQ to XML 与[`XDocument`](http://msdn.microsoft.com/en-us/library/system.xml.linq.xdocument.aspx)类和[`System.Xml.Linq`](http://msdn.microsoft.com/en-us/library/bb299195.aspx)命名空间一起使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T18:52:43.520

您可以查看 XPath。该`System.XML.XmlDocument.SelectNodes`方法允许您通过 XPath 选择匹配的节点。它不是 SQL，但它是在 XML 文档中查找节点的常用方法。下面的示例使用 XPath 检索所有标题为“Midnight Rain”的书籍的作者。

```
 Dim document As XmlDocument = New XmlDocument()
    document.Load("file.xml")
    Dim matches As XmlNodeList = document.SelectNodes("/catalog/book[title = 'Midnight Rain']/author")
    For Each node As XmlNode In matches
        'Do work
    Next 
```

# sql-server - 本地 SQL Server 版本是否应该与主机版本相同？

> ID：10401884
> 
> 赞同：2
> 
> 时间：2012-05-01T17:48:54.077
> 
> 标签：sql-server

我即将将 ASP.NET 3.5 中的电子商务网站上传到主机。我想将我的数据库（SQL Server 2008 Express Edition）上传到我确定 SQL Server 版本不是 Express 的主机。所以我想知道如果我上传.BAK文件然后通过管理控制面板恢复它，我在主机上的数据库将是快速版还是会自动更改为主机版？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T17:57:09.387

该版本通常不会对数据库产生任何影响，除非您使用的数据库中的功能可能并非在所有 SQL Server 版本中都可用。但是，由于您要从 Express 升级到可能的更高版本（标准/企业版），您可能不会遇到任何问题。

# javascript - 检查浏览器是否启用了javascript

> ID：10401885
> 
> 赞同：4
> 
> 时间：2012-05-01T17:48:57.460
> 
> 标签：javascript, browser

```
<noscript>
    <div>
        You must enable javascript to continue.
    </div>
</noscript> 
```

好的，这是有道理的，但是仍然会显示此元素之后的内容，当然以一种不好的方式，但我正在寻找的是：

如果未启用 javascript，我想显示此警报消息，除此之外，我不想提供建议“如果您启用 Javascript 会更好”，我想强制，“您必须启用才能继续！” ，如果没有启用 javascript，我不想访问我的网站，我该怎么做？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-01T17:51:30.080

添加一个`No-Javascript`使用 CSS 隐藏所有其他内容的 CSS 类，并使用 Javascript 立即删除该类（使用`<script>`该元素中的内联块）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-01T17:51:54.867

```
<noscript>
    <div style='position:fixed;left:0;top:0;width:100%;height:100%;background:#f55;z-index=1000">
        You must enable javascript to continue.
    </div>
</noscript> 
```

另外，您的问题想引起警报..这是JavaScript。您基本上是在问“禁用 JS 时如何执行 JS？”。但仅此 HTML 就可以解决问题。

# c++ - 类向量c++问题

> ID：10401891
> 
> 赞同：-1
> 
> 时间：2012-05-01T17:49:20.337
> 
> 标签：c++, class, vector

我在使用矢量类时遇到了一些问题。出于某种原因，尚未找到：P，我无法将任何对象插入到我的向量中。我尝试过矢量、地图、双端队列等，但它们都有相同的奇怪结果。

我要存储的对象是一个包含 2 个 std::string 的类。这里有一些代码来解释我的观点：

```
vector<DnsAddress> * dnss = new vector<DnsAddress>;
for(int i = 0; i < ns.size(); i++){
   DnsAddress dn;
   dn.SetRecord1(record1);
   dn.SetRecord2(record2);
   cout<<dn.GetRecord1()<<" : "<<dn.GetRecord2()<<endl; //this works, so it is inserting  info to the object
   dnss->push_back(dn);//this is where it begins to fail...
   cout<<dnss->at(i).GetRecord1()<<" : "<<dnss->at(i).GetRecord2()<<endl;//doesn't work

   DnsAddress a = dnss->at(0);//this way doesn't work either...
   cout<<"dns: "<<a.GetRecord1()<<endl;
} 
```

我敢肯定一定有一个菜鸟的错误。我讨厌那些发生的时候。他们花了我一些时间来找出答案。

有人可以帮忙吗？

我很感激 ：）

澄清：没有错误......它没有问题......但是向量中的信息被计算（.size（）函数告诉我插入对象的数量）但是当你尝试访问它时，什么都没有显示...但没有引发错误

这是 DnsAdress 类：

```
class DnsAddress {
public:
    DnsAddress();
    DnsAddress(const DnsAddress& orig);
    virtual ~DnsAddress();
    void SetRecord2(string record2);
    string GetRecord2() const;
    void SetRecord1(string record1);
    string GetRecord1() const;
private:
    string record1;
    string record2;

}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T17:55:49.087

这只是一个猜测，因为您没有展示您的课程`DnsAddress`或告诉我们错误是什么。

我猜：

*   您的类没有复制构造函数（编译时错误）或
*   复制构造函数没有制作正确的副本（运行时错误行为）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T17:55:30.980

我敢打赌你的 DnsAddress 类需要一个复制构造函数。当您在非指针元素的向量上调用 push_back 时，这会有效地调用。

编辑：看起来你确实有一个复制构造函数。实际上，如果您只是删除了复制构造函数，那么默认的构造函数就可以正常工作。如果您仍想手动实现它，则需要在复制构造函数实现中将 record1 和 record2 分配给 orig.record1 和 orig.record2。

# google-analytics - 未捕获的 ReferenceError: _gaq 未定义 (Google Analytics)

> ID：10401894
> 
> 赞同：33
> 
> 时间：2012-05-01T17:49:36.693
> 
> 标签：google-analytics, onload-event

在 chrome 调试日志中查看站点页面时会出现以下消息。

> 未捕获的 ReferenceError：_gaq 未定义

页面本身应该使用`onload`事件处理程序跟踪对象并为 Google Analytics 触发`_trackEvent`。

我最好的猜测是，`ga.js`文件可能没有及时加载，因此`onload` `_trackEvent`没有捕获到触发。在关闭之前使用异步代码段，`</body>`并且对象位于中间`<body>`。

（其他一些帖子也引用了 jQuery 位置，但这可能是一个红鲱鱼）

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2014-03-10T18:14:36.007

来自[https://developers.google.com/analytics/devguides/collection/gajs/](https://developers.google.com/analytics/devguides/collection/gajs/)此代码将您现有的“传统代码段”替换为“最新的异步版本，您应该首先删除现有的跟踪代码段”。

```
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-XXXXX-X']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script> 
```

要查看您的事件（以了解这是否有效），请在“报告”页面左侧的“实时”菜单选项下查找“事件”。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-02-28T23:41:02.260

关于异步片段的位置，[GA 帮助页面](https://developers.google.com/analytics/devguides/collection/gajs/)说 -

> 将此代码段粘贴到您的网站模板页面中，使其显示在结束`</head>`标记之前。

我的第一个想法是应该在页面底部加载JS以提高页面速度。但是，GA 异步跟踪代码段应该加载到头部，因为它不会立即加载 ga.js，也不会阻止页面执行。（它通过将脚本标记动态添加到 DOM 来实现，这会将它在队列的后面。）

如果由于某种原因，您无法将异步代码段移至头部，则可以定义`_gaq`自己，如下所示-

```
<button onclick="var _gaq = _gaq || []; _gaq.push(['_trackEvent', 'button3', 'clicked'])"/><button> 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-04-23T19:46:12.280

有同样的问题。您必须定义`_gaq`数组。只需在标题中的 Google Analytics 脚本之后添加：

```
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-XXXXXX-X']);
_gaq.push(['_trackPageview']); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-11-21T17:47:23.403

您可以使用最新版本的[analytics.js](https://developers.google.com/analytics/devguides/collection/analyticsjs/sending-hits)而不是[ga.js](https://developers.google.com/analytics/devguides/collection/gajs/)

> ga.js 是一个遗留库。如果您要开始一个新的实现，我们建议您使用该库的最新版本，analytics.js。对于现有实现，了解如何从 ga.js 迁移到 analytics.js。

这是一个例子：

```
ga('send', {
  hitType: 'event',
  eventCategory: 'Video',
  eventAction: 'play',
  eventLabel: 'cats.mp4'
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-05-09T15:17:45.983

将跟踪代码更改为：

```
<script type="text/javascript">
      var gaq; 
      var _gaq = gaq || [];
      _gaq.push(['_setAccount', 'UA-XXXXX-X']);
      _gaq.push(['_setDomainName', 'yourdomain.com']);
      _gaq.push(['_setAllowLinker', true]);
       _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script');
        ga.type = 'text/javascript';
        ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www')
                      + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(ga, s);
      })();

</script> 
```

# linux - linux历史命令

> ID：10401898
> 
> 赞同：0
> 
> 时间：2012-05-01T17:49:58.090
> 
> 标签：linux, shell

如果我输入历史命令，我只能查看 1000 行。我想看的远不止这些。如果我可以查看在特定日期或月份之间键入的所有命令，那就太好了。

这可能吗？如果是这样，该怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T17:54:44.470

你想设置 bash 变量`HISTSIZE`并`HISTFILESIZE`在你的`.bashrc`.

`HISTSIZE`确定在历史记录中保留多少命令。`HISTFILESIZE`确定在保存它们的文件中存储了多少行历史记录，通常是`.bash_history`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T18:00:59.647

添加一些命令到 .bash_logout 来组织你的历史文件

例如

```
today=`date +%y%m%d`
cp .bash_history >.bash_history_$today
echo >.bash_history  # to clear out file 
```

但是，有一个问题： .bash_logout 似乎无法在很多基于 X 的环境中运行。在 ssh 帐户上，例如使用虚拟服务器，它可以正常工作。

# objective-c - UIViewController 和 UITableViewController 共享逻辑

> ID：10401900
> 
> 赞同：1
> 
> 时间：2012-05-01T17:50:04.860
> 
> 标签：objective-c, ios, model-view-controller

我有一个`BaseViewController`继承自`UIViewController`的类和一个`BaseTableViewController`继承自的类`UITableViewController`。这两个类具有相同的共享逻辑（即旋转处理、辅助方法等）。现在，代码只是在两者中重复。我考虑过创建一个 ViewControllerHelper 类并将其公开为公共属性，但我想知道是否有更优雅的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T17:56:43.657

`BaseViewController`我会创建一个带有两个初始化程序的通用类：

`initWithList:`（用于表格视图）和`initWithSomething:`简单的 UIViewController 的东西。这些初始化程序中的每一个都将加载单独的 xib（一个带有`UITableView`as 主视图，其他 - as simple `UIView`）。

您在每个实例中都有相同的方法。它只需要实现`UITableViewDelegate`和`UITableViewDataSource`协议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T17:58:44.110

如果你不需要任何共享的 ivars/properties，你可以为 UIViewController 写一个扩展

# java - Shiro 授权使用远程角色填充授权

> ID：10401903
> 
> 赞同：4
> 
> 时间：2012-05-01T17:50:12.343
> 
> 标签：java, tapestry, shiro

我正在使用使用 Apache Shiro 的 Tapestry-Security

我有一个处理授权和身份验证的自定义领域。从技术上讲，我们的身份验证使用远程服务进行，该服务返回用户名和一组角色。我只是将用户名传递给我的自定义 AuthenticationToken，它允许我查询本地数据库并设置 SimpleAuthenticationInfo。

我不知道如何使用从我们的远程服务返回给我的角色列表来填充 AuthorizationInfo doGetAuthorizationInfo 方法。下面是我用来填充领域的代码。

登录类

```
//Remote authentication service
RemoteLoginClient client = new RemoteLoginClient();
RemoteSubject authenticate = client.authenticate(username, password);

//tapestry security authentication
Subject currentUser = SecurityUtils.getSubject();
CustomAuthenticationToken token = new 
    CustomAuthenticationToken(authenticate.getUsername());
System.out.println("roles" + authenticate.getRoles());

currentUser.login(token); 
```

customRealm 公共类 CustomRealm 中的 AuthorizationInfo 方法扩展 AuthorizingRealm {

```
protected AuthenticationInfo doGetAuthenticationInfo(AuthenticationToken token) throws AuthenticationException {
    CustomAuthenticationToken upToken = (CustomAuthenticationToken ) token;
    String email = upToken.getUsername();

    ApplicationUser applicationUser = (ApplicationUser) session.createCriteria(ApplicationUser.class)
            .add(Restrictions.like("email", email + "%"))
            .uniqueResult();

    if (applicationUser == null) {
        throw new UnknownAccountException("User doesn't exist in EPRS database");
    }

    return buildAuthenticationInfo(applicationUser.getId());
}

protected AuthorizationInfo doGetAuthorizationInfo(PrincipalCollection principals) {
//Not sure how to populate the principle or
//read the principle to populate the SimpleAuthorizationInfo
    return new SimpleAuthorizationInfo(roleNames);
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-02T11:27:39.870

如果您需要身份验证和授权，扩展[`AuthorizingRealm`](http://shiro.apache.org/static/current/apidocs/org/apache/shiro/realm/AuthorizingRealm.html)是一个很好的起点。此外，正如 PepperBob 已经说过的，当您使用它时，`Account`接口及其`SimpleAccount`实现在单个接口中支持身份验证和授权，因此您不需要太多单独的代码，`doGetAuthenticationInfo()`并且`doGetAuthorizationInfo()`可以只从两者返回相同的对象方法。

要获取授权信息，您需要做两件事：

*   `getAvailablePrincipal()`通过方法（在 中整齐地预定义）从作为参数传递的主体集合中获取可用主体（在大多数情况下，无论如何，它只包含一个主体`AuthorizingRealm`）。
*   加载您的角色并将它们传递给`setRoles()`您的帐户对象。

...你就完成了。

*编辑添加：*

这将是一种非常简单的方式来存储角色直到您需要它们。请注意，实际的身份验证是在领域中完成的，它依赖于`RemoteLoginClient`.

```
public class MyRealm extends AuthorizingRealm {

    private RemoteLoginClient client = ...;

    private final Map<String, Set<String>> emailToRoles = new ConcurrentHashMap<>();

    @Override
    protected AuthenticationInfo doGetAuthenticationInfo(
             AuthenticationToken token) {
        final UsernamePasswordToken userPass = (UsernamePasswordToken) token;

        final RemoteSubject authenticate = this.client.authenticate(
            userPass.getUserName(), userPass.getPassword());
        if (authenticate != null) { //assuming this means success
            this.emailToRoles.put(userPass.getUserName(), authenticate.getRoles());
            return new SimpleAuthenticationInfo(...);
        } else {
            return null;
        }
    }

    @Override
    protected AuthorizationInfo doGetAuthorizationInfo(
            PrincipalCollection principals) {
         final String username = (String) principals.getPrimaryPrincipal();
         final Set<String> roles = this.emailToRoles.get(username);
         return new SimpleAuthorizationInfo(roles);
    }

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-03T13:09:25.033

我回答了我自己的问题并想发布这个以防其他人需要帮助或可能改进我的解决方案。

Login.class 方法

```
Object onSubmit() {
    try {
        //Remote Authentication
        RemoteLoginClient client = new RemoteLoginClient ();
        RemoteSubject authenticate = client.authenticate(formatUsername(username), password);

        //tapestry security authentication
        Subject currentUser = SecurityUtils.getSubject();
        CustomAuthenticationToken token = new CustomAuthenticationToken(authenticate.getUsername(), authenticate.getRoles());

        currentUser.login(token);
    } //catch errors
} 
```

//自定义令牌用于保存从远程身份验证服务设置的用户名和角色。

```
public class CustomAuthenticationToken implements AuthenticationToken {

private String username;
private Set<String> roles;

public CustomAuthenticationToken(String username, Set<String> roles) {
    this.username = username;
    this.roles = roles;
}

getters/setters 
```

//自定义Realm用于处理本地认证和授权。

```
public class CustomRealm extends AuthorizingRealm {

//Hibernate Session
private final Session session;
public static final String EMPTY_PASSWORD = "";

public CustomRealm(Session session) {
    this.session = session;
    setCredentialsMatcher(new AllowAllCredentialsMatcher());
    setAuthenticationTokenClass(CustomAuthenticationToken.class);
}

protected AuthenticationInfo doGetAuthenticationInfo(AuthenticationToken token) throws AuthenticationException {
    CustomAuthenticationToken customToken = (CustomAuthenticationToken) token;
    String email = customToken.getUsername();

    User user = (User) session.createCriteria(User.class)
            .add(Restrictions.like("email", email+ "%"))
            .uniqueResult();

    if (user == null) {
        throw new UnknownAccountException("User doesn't exist in local database");
    }

    return new SimpleAuthenticationInfo(new CustomPrincipal(user, customToken.getRoles()), EMPTY_PASSWORD, getName());
}

protected AuthorizationInfo doGetAuthorizationInfo(PrincipalCollection principals) {
    return new SimpleAuthorizationInfo(((CustomPrincipal) principals.getPrimaryPrincipal()).getRoles());
} 
```

}

//用于保存用户对象和角色的自定义主体 public class CustomPrincipal {

```
private User user;
private Set<String> roles;

public CustomPrincipal() {
}

public CustomPrincipal(User user, Set<String> roles) {
    this.user = user;
    this.roles = roles;
}

getters/setters 
```

# android - 如何使用警报管理器内容提供程序。

> ID：10401907
> 
> 赞同：3
> 
> 时间：2012-05-01T17:50:36.817
> 
> 标签：android

当我使用警报管理器时。显示权限错误。请告诉我，我们必须在清单文件中使用哪个权限。

我正在使用此代码...

```
 Uri uri = Uri.parse("content://com.android.deskclock/alarm");
        Cursor c = getContentResolver().query(uri, null, null, null, null);
        if (c != null) 
            {
          String names[] = c.getColumnNames();
           for (String temp : names) {
            System.out.println(temp);

            }

           if (c.moveToFirst()) {
             do {
                  int i = 0;
                  for (int j = 0; j < c.getColumnCount(); j++) 
                      {
                          c.getString(j));
                   }
                 } while (c.moveToNext());
                } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T17:55:05.583

检查 LogCat 输出是否有错误。您将在那里看到缺少的权限。如果您无法弄清楚，请在此处粘贴输出。

# xml - Powershell xml函数错误

> ID：10401911
> 
> 赞同：1
> 
> 时间：2012-05-01T17:50:47.210
> 
> 标签：xml, powershell

在函数中格式化 xml 时出错：

```
$newXml = @'
<bindings>
<basicHttpBinding>
</basicHttpBinding>
</bindings>
'@

+     $newXml =  <<<< @', is missing the terminator: '@. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T19:21:20.013

两件事与`here`字符串。确保 . 之后`@'`没有空格， . 之前没有空格`'@`。也就是说，关闭终止符必须从第 0 列开始。

# python - python额外的值添加到变量

> ID：10401912
> 
> 赞同：0
> 
> 时间：2012-05-01T17:50:52.900
> 
> 标签：python, linux, debian

我正在运行一个在两台服务器上运行的 python zabbix trapper 脚本，它在其中一台服务器上运行良好。它每 30 秒运行一次。这是从“ss”读取 time_wait 状态的代码部分

```
file_log = "/tmp/tcpstate.log"
proc = open(file_log,"a")

file = "/var/log/safesquid/safesquid/performance/performance.log"
time_wait_cmd = subprocess.Popen("ss -o state time-wait | grep webcache | wc -l",shell=True,stdout=subprocess.PIPE)
ssquid_time = time_wait_cmd.communicate()[0]
proc_string = datetime.datetime.now().strftime("%d-%m-%y %H:%M:%S") + " " + "Time_WAIT: " + ssquid_time  + "\n"
proc.write(proc_string)
proc.close() 
```

server1 的输出：（确定）

```
01-05-12 17:40:50 Time_WAIT: 286
01-05-12 17:41:20 Time_WAIT: 251
01-05-12 17:41:50 Time_WAIT: 366
01-05-12 17:42:20 Time_WAIT: 335
01-05-12 17:42:50 Time_WAIT: 287
01-05-12 17:43:20 Time_WAIT: 375
01-05-12 17:43:51 Time_WAIT: 386
01-05-12 17:44:21 Time_WAIT: 383 
```

Server2 的输出：（问题）

```
01-05-12 17:44:03 Time_WAIT: 368
01-05-12 17:44:32 Time_WAIT: 388
01-05-12 17:45:01 Time_WAIT: 0
01-05-12 17:45:01 Time_WAIT: 339
01-05-12 17:45:31 Time_WAIT: 311
01-05-12 17:46:00 Time_WAIT: 400
01-05-12 17:46:01 Time_WAIT: 0
01-05-12 17:46:29 Time_WAIT: 411
01-05-12 17:46:58 Time_WAIT: 448 
```

因为它每 30 秒被调用一次，我不知道为什么在 Server2 上它得到“0”值然后立即读取正确的值。

任何想法为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T18:42:23.663

任一进程是否接收信号？这可能会导致系统调用提前终止。

# java - 在 Java 中运行 JavaScript 的最佳方式是什么？

> ID：10401913
> 
> 赞同：2
> 
> 时间：2012-05-01T17:50:56.327
> 
> 标签：java, javascript, json, dwr

我正在寻找获取 JSON 数据的最佳方式，即在客户端从服务器轮询到 JS（由 DWR 生成）。所以我要为它制作Java客户端。非常感谢任何关于它的想法和建议。

更新：主要目标 - 了解如何拦截从服务器传输的 JSON 数据（如在 Firebug 中）。在服务器端 - DWR（JSP 页面），在客户端 - 由服务器生成的 JS。该方案适用于长轮询。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T17:59:38.930

有一个用于 Java 的 JavaScript 实现，称为[Rhino](http://www.mozilla.org/rhino/)（来自 Mozilla）。我认为它从 1.6 版开始就在 JDK 中。你可以在你的 Java 程序中运行 JavaScript（[这里](http://www.java2s.com/Code/Java/JDK-6/RunningScriptswithJavaScriptEngine.htm)有一个小教程，你可以在 google 上找到更多）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T17:54:48.140

为什么不像[Jackson](http://jackson.codehaus.org/)那样为 Java 使用 JSON 解析库？

或者你可以制作一个 webclient，因为这显然是生成的 JS 的目的。

# android - 在 Android DatePicker 中隐藏年份字段？

> ID：10401915
> 
> 赞同：14
> 
> 时间：2012-05-01T17:51:05.820
> 
> 标签：android, datepicker

我正在使用基本的 DatePicker，我试图弄清楚如何隐藏 DatePickerDialog 上的 Year 字段，以便只有 Month 和 Day 可见。我不介意当年的底层代码仍然存在，我只想在对话框中隐藏年份字段。你知道这样的事情：

```
((View) myYear).setVisibility(View.GONE); 
```

我知道这是行不通的，因为 myYear 是 int 而不是 View，而是类似的东西。是否可以？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-17T14:10:51.803

我发现实现 DatePicker 的一种超级简单的方法是在 xml 中调用它：

```
 <DatePicker
    android:id="@+id/thePicker"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"/> 
```

然后在java中隐藏你想要的任何字段（在这种情况下是年份）：

```
 picker = (DatePicker) findViewById(R.id.thePicker);
    try {
        Field f[] = picker.getClass().getDeclaredFields();
        for (Field field : f) {
            if (field.getName().equals("mYearPicker")) {
                field.setAccessible(true);
                Object yearPicker = new Object();
                yearPicker = field.get(picker);
                ((View) yearPicker).setVisibility(View.GONE);
            }
        }
    } 
    catch (SecurityException e) {
        Log.d("ERROR", e.getMessage());
    } 
    catch (IllegalArgumentException e) {
        Log.d("ERROR", e.getMessage());
    } 
    catch (IllegalAccessException e) {
        Log.d("ERROR", e.getMessage());
    } 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-11-26T16:01:34.560

这个解决方案要非常小心。您正在使用反射来访问字段并更改可见性。这不适用于 Android 5.0 ！Google 已经更改了 TimePicker 和 DatePicker 的实现，并且这些类不再公开委托的任何字段。

我还不知道 Android 5.0+ 的解决方案。一旦我发现有趣的东西，我会尽快通知你。

作为一个想法，您可以使用 Build.VERSION.SDK_INT 检查 Android 版本，然后尝试使用反射访问 DatePickerSpinnerDelegate 并设置所需的字段。

同样，这不是理想的解决方案，因为 Google 可以一次又一次地随意更改...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-23T11:22:22.167

在日期选择器中禁用年份字段的简单方法

```
DatePicker dp = findDatePicker((ViewGroup) dialog.getWindow().getDecorView());

if(dp != null) 
{
    ((ViewGroup) ((ViewGroup) dp.getChildAt(0)).getChildAt(0)).getChildAt(2).setEnabled(false);
    ((ViewGroup) ((ViewGroup) dp.getChildAt(0)).getChildAt(0)).getChildAt(2).setAlpha(0.4f);
} 
```

如果您想删除年份字段，只需将结果视图的可见性设置为 View.GONE，如下所示

```
dp.getChildAt(0)).getChildAt(0)).getChildAt(2).setVisibility(View.GONE)

private DatePicker findDatePicker(ViewGroup group) {
    if (group != null) {
        for (int i = 0, j = group.getChildCount(); i < j; i++) {
            View child = group.getChildAt(i);
            if (child instanceof DatePicker) {
                return (DatePicker) child;
            } else if (child instanceof ViewGroup) {
                DatePicker result = findDatePicker((ViewGroup) child);
                if (result != null)
                    return result;
            }
        }
    }
    return null;

} 
```

我参考了以下链接以供参考 [从 DatePickerDialog 中删除年份](https://stackoverflow.com/questions/10233760/remove-year-from-datepickerdialog#)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-09-06T06:14:49.493

您可以使用此功能设置年份范围

```
datePicker.setYearRange(1950,2017); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2018-08-10T23:11:20.510

最近设法通过将日期选择器宽度设置得太小来隐藏对话框的年份部分。

```
<DatePicker
        android:id="@+id/month_day_datepicker"
        android:layout_width="140dp"
        android:datePickerMode="spinner"
        style="?android:attr/borderlessButtonStyle"/> 
```

让我知道这是否有效，显然，绑定中有一个可访问的年份，但在计算日期时你不能选择它。

# django - 使用 Django（或简单的 SQL） - 是否可以使用“通过”表上的字段对 m2m 关系进行排序？

> ID：10401918
> 
> 赞同：0
> 
> 时间：2012-05-01T17:51:20.733
> 
> 标签：django, django-orm

```
class Dog(models.Model):
    name = models.CharField(max_length=255)
    toys = models.ManyToManyField('toys.Toy', through='dogs.DogToy')

class DogToy(models.Model):
    dog = models.ForeignKey('dogs.Dog')
    toy = models.ForeignKey('toys.Toy')
    sort_order = models.IntegerField()

    class Meta:
        unique_together = (
            ('dog', 'toy'),
            ('dog', 'sort_order'),
        ) 
```

使用上面的例子，我想`dog.toys.all()`使用关系的`sort_order`列进行排序，因为多只狗可能有相同的玩具，所以我不能按字段排序`Toy`。查询后我不能使用 Pythonic 排序，因为我的狗有成千上万的玩具，我需要使用分页来进行性能。

在 SO 上提出了一些重复且几乎重复的问题，这些问题的回答不正确（答案等同于 using `dog.toys.order_by('sort_order')`，这当然不起作用）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-05T14:43:44.477

通过中间表 DogToy 执行此操作：

```
dog = Dog.objects.get(...)
ordered_toys = [dogtoy.toy for dogtoy in \
    DogToy.objects.filter(dog=dog).order_by('sort_order')] 
```

# menu - 如何使用选项拆分来控制typo3菜单属性？

> ID：10401926
> 
> 赞同：1
> 
> 时间：2012-05-01T17:51:57.857
> 
> 标签：menu, typo3, typoscript

我正在尝试解决typo3 中的设计问题实现。本质上，我必须实现从目录生成的选项卡式菜单（只有活动状态是选项卡式），但每个活动（选项卡式）菜单必须具有不同的背景颜色（与选项卡正文框匹配）。我最初选择使用 TMENU，但之前被引入到选项拆分功能作为实现此目的的一种方式，但我想不出使用 TMENU 实现此目的的方法，所以我目前正在尝试使用 GMENU，但是我没有得到正确的结果。下面是我当前的代码，它给了我空白的空格。我正在尝试复制选项卡图像并将文本集中在图像中，但使用选项拆分来复制文件。

```
temp.navmenu1 = HMENU
special = directory
special.value = {$idMenu}
entryLevel = 1
temp.navmenu1.1 = GMENU

temp.navmenu1.1 {
  NO = 1
  NO{
  NO.Wrap = <ul style="display: inline; "> | </ul>
  backColor = #d9d9d9
    10 = TEXT
    10.text.field = title
    10.offset = 0,5
    10.align = center
    10.niceText = 1
  }
  ACT < .NO
  ACT{
      XY = [4.w],[4.h]

      4 = IMAGE
      4.file = {$hmtab}|*|{$midtab}|*|{$endtab}
    }

}

# Temp items aren't rendered, so let's copy it into a TSOP
tv.navmenu1 < temp.navmenu1

page = PAGE
page.typeNum = 0
page.10 = USER
page.10.userFunc = tx_templavoila_pi1->main_page 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-02T07:15:09.423

我认为不应再使用新站点`GMENU`。相反，您应该使用`TMENU`CSS。

这是一个可以帮助您入门的基本示例：

```
10 = HMENU
10 {
  special = directory
    # start with pid 3
  special.value = 3
  1 = TMENU
  1 {
    expAll = 1
    wrap = <ul>|</ul>
    NO = 1
    NO {
      wrapItemAndSub = <li>|</li>
      ATagTitle = abstract // description // title
    }
    ACT < .NO
    ACT.wrapItemAndSub = <li class="active">|</li>
    CUR < .NO
    CUR.wrapItemAndSub = <li class="current">|</li>
  }
  2 < .1
  3 < .1
  4 < .1
  4.wrap = <ul class="level-4">|</li>
} 
```

当然你现在可以`option split`像`wrapItemAndSub`这样使用：`wrapItemAndSub = <li class="first">|</li> |*| <li class="normal">|</li> |*| <li class="last">|</li>`

其余的只是普通的 CSS。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-29T21:59:55.110

如果您的问题是您想用不同的类属性将不同的子菜单包装在同一级别上，那么请查看 TMENU 对象的 submenuObjSuffixes 属性。

虽然无法将选项拆分与 wrap 一起使用（仅仅是因为 wrap 只执行一次），但很可能使用 submenuObjSuffixes 获得所需的结果。

这是一个例子：

```
1 = TMENU
1 {
    wrap = <ul>|</ul>
    submenuObjSuffixes =  |*| b |*| c

    NO = 1
    NO {
        wrapItemAndSub = <li>|</li>
    }
}

2 < .1
2.wrap = <ul class="firstItem">|</ul>
2b < .1
2b.wrap = <ul class="middleItems">|</ul>
2c < .1
2c.wrap = <ul class="lastItem">|</ul>

3 < .2
3b < .2b
3c < .2c
4 < .2
4b < .2b
4c < .2c 
```

这将用“firstItem”类包装第一个 2 级菜单，用“lastItem”包装最后一个 2 级菜单，以及用“middleItems”类包装所有中间菜单。

请理解后缀附加到所有后续菜单级别。因此，如果您在级别 1 上使用 submenuObjSuffixes，它不仅会影响级别 2，还会影响级别 3、4，......并且您还必须在这些级别上定义相应的选项，否则它们将不会被渲染。

# asp.net - 在 runat 服务器头内的 ResolveClientUrl

> ID：10401932
> 
> 赞同：1
> 
> 时间：2012-05-01T17:52:47.517
> 
> 标签：asp.net, webforms, runatserver, resolveclienturl

我正在开发一个 Web 表单站点。头标签具有 runat 服务器属性。在母版页中。

我正在尝试将 ResolveClientUrl 用于这样的 .js 文件：

```
 <head runat="server">
   .. 
  <script src='<%= ResolveClientUrl("~/myscript.js") %>' type="text/javascript" >    </script>
 </head> 
```

但是后来，我得到了一个错误：

```
The Controls collection cannot be modified because the control contains code blocks (i.e. <% ... %>). 
```

我发现问题出在 runat 服务器上，所以我从 head 标签中删除了它......现在我收到以下错误：

```
Using themed css files requires a header control on the page. (e.g. <head runat="server" />). 
```

那么，如何在 runat 服务器头中使用 ResolveClientUrl 呢？

**更新：**

我已经使用母版页顶部的包含添加了脚本（似乎工作正常）..但可能有更好的解决方案。

```
<!-- #include file="myscript.js" --> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T18:32:54.923

您可以使用数据绑定：

```
<head ID="head" runat="server">
    ..
    <script src='<%# ResolveClientUrl("~/myscript.js") %>' type="text/javascript" >    </script>
</head> 
```

然后在您的代码隐藏中（最好在页面加载事件处理程序中）：

```
head.DataBind() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-31T15:42:15.430

您收到该消息的原因是，当引入代码块时，必须锁定包含 runat="server" 控件的 ControlCollection，以防止核心框架在渲染时无法恢复的意外情况（因此执行渲染代码块）

更复杂的是，当使用任何想要“添加自身”到服务器控件集合中的代码时。

为了防止这种情况，最好的方法是将任何代码块包装在头部的 Literal 控件中：

```
<head runat="server">
   <title></title>
   <asp:Literal runat="server" id="SCRIPTLIT1">
    <script src='<%# ResolveClientUrl("~/myscript.js") %>' type="text/javascript"></script>
   </asp:Literal>

<!-- ...other stuff -->
   <asp:ContentPlaceholder runat="server" id="head"></asp:ContentPlaceholder>
</head> 
```

所以现在我们已经推动框架锁定 Literal 的控件集合，而不是 <head runat="server"> 控件集合。

# coding-style - 如何配置 PhpStorm 短标签缩进

> ID：10401934
> 
> 赞同：1
> 
> 时间：2012-05-01T17:53:01.333
> 
> 标签：coding-style, phpstorm

这是 PhpStorm 将为此代码生成的缩进：

```
<?php if (count($foo) > 0) : ?>
<div>...</div>
<?php else : ?>
<p>...</p>
<?php endif; ?> 
```

如何将其配置为简单：

```
<?php if (count($foo) > 0) : ?>
    <div>...</div>
<?php else : ?>
    <p>...</p>
<?php endif; ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T18:59:54.243

恐怕现在无法以这种方式缩进代码，请[向 YouTrack 提交请求](http://youtrack.jetbrains.net/issues/WI)。

# types - Python方法包装器类型？

> ID：10401935
> 
> 赞同：42
> 
> 时间：2012-05-01T17:53:01.903
> 
> 标签：types, python-3.x

Python 3 中的方法包装器类型是什么？如果我这样定义一个类：

```
class Foo(object):
    def __init__(self, val):
        self.val = val
    def __eq__(self, other):
        return self.val == other.val 
```

然后做：

```
Foo(42).__eq__ 
```

我得到：

```
<bound method Foo.__eq__ of <__main__.Foo object at 0x10121d0>> 
```

但如果我这样做（在 Python **3**中）：

```
Foo(42).__ne__ 
```

我得到：

```
<method-wrapper '__ne__' of Foo object at 0x1073e50> 
```

什么是“方法包装器”类型？

编辑：对不起，更准确地说：`class method-wrapper`是 的类型`__ne__`，就好像我做的那样：

```
>>> type(Foo(42).__ne__)
<class 'method-wrapper'> 
```

而类型`__eq__`是：

```
>>> type(Foo(42).__eq__)
<class 'method'> 
```

此外`method-wrapper`，似乎是类上任何未定义的魔术方法的类型（因此`__le__`，如果未明确定义，则`__repr__`,等也将具有此类型）。`__str__`

我感兴趣的是`method-wrapper`Python 如何使用该类。类上方法的所有“默认实现”都只是这种类型的实例吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-10-23T15:26:15.380

CPython似乎将该类型`<method-wrapper ..>`用于在 C 代码中实现的方法。基本上该类型不包装另一种方法。相反，它将 C 实现的函数包装为绑定方法。这种方式`<method-wrapper>`与 a 完全一样，`<bound-method>` 只是它是用 C 实现的。

在 CPython 中有两种与此相关的特殊类型。

*   `<slot wrapper>`其中（至少）包装了一个 C 实现的函数。表现得像`<unbound method>`CPython 2 中的 a （至少有时）或`<function>`CPython 3 中的 a
*   `<method-wrapper>`它将 C 实现的函数包装为绑定方法。这种类型的实例有一个`__self__`属性__，它在被调用时用作第一个参数。

如果您有 a `<slot wrapper>`，则将其绑定到一个对象`__get__`以获取`<method-wrapper>`：

```
# returns a <slot_wrapper> on both CPython 2 and 3
sw = object.__getattribute__  

# returns a <method-wrapper>
bound_method = sw.__get__(object()) 

# In this case raises AttributeError since no "some_attribute" exists.
bound_method("some_attribute") 
```

您可以`__get__`在 Python 中调用任何类似函数的对象来获取`<bound method>`or `<method-wrapper>`。注意`__get__`这两种类型都会简单地返回 self。

## 蟒蛇 3

CPython 3 中的类型对and和任何其他比较运算符`object`都有 C 实现。因此为此运算符返回 a 。同样返回可用于比较 this 对象的 a。`__ne__``__eq__``object.__ne__``<slot wrapper>``object().__ne__``<method-wrapper>`

由于您没有`__ne__`在您的类中定义，您将获得一个绑定方法（as `<method-wrapper>`），它是对象实例（包括派生实例）的 C 实现函数。我敢打赌，这个 C 函数将检查您是否定义了 any `__eq__`，调用它，然后*不*检查结果。

## Python 2（未问但已回答）

Python 2 在这里的表现明显不同。因为我们有未绑定方法的概念。这要求您使用正确的第一个参数类型来调用它们，并且两者`<slot wrapper>`都有`<method-wrapper>`一个`__objclass__`which 是第一个参数必须是实例的类型。

此外：Python 2 没有该`object`类型的比较运算符的任何实现。因此`object.__ne__`不是比较对象的功能。相反，有趣的`type`是，作为元类的类型`object`确实有一个 C 实现的`__ne__`运算符。因此，您将获得一个绑定方法，`object.__ne__`该方法将尝试将该类型`object`与任何其他类型（或对象）进行比较。

因此`object().__ne__`实际上会失败，`AttributeError`因为`object`没有定义任何此类方法。鉴于这`object() == object()`确实有效（给出 False），我猜想 CPython 2 在解释器中有用于比较对象的特殊情况。我们再次看到 CPython 3 已经清理了 Python 2 的一些不太幸运的实现细节。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-05-03T14:56:49.060

这是因为 Python 3 中不存在“未绑定方法”。

> 在 Python 3000 中，未绑定方法的概念已被移除，表达式“A.spam”返回一个普通的函数对象。事实证明，第一个参数必须是 A 的实例的限制对诊断问题几乎没有帮助，并且经常成为高级用法的障碍——有些人称其为“duck typing self”，这似乎是一个合适的名称。 [（来源）](http://python-history.blogspot.co.uk/2009/02/first-class-everything.html)

在 Python 2.x 中，我们有绑定方法和未绑定方法。绑定方法绑定到一个对象，这意味着当它被调用时，它将对象实例作为第一个变量（`self`通常）传递。未绑定的方法是指函数是一个方法，但没有它所属的实例 - 如果将对象实例以外的其他内容传递给该方法，则会引发错误。

现在，在 3.x 中，这已更改。代替绑定/未绑定方法，当您请求对象的方法时，它返回函数对象，但包装在一个将实例变量传入的包装函数中。这样就无需区分绑定和未绑定方法- 绑定的方法被包装，未绑定的没有。

为了澄清区别：

2.x：

```
a = A()
f = A.method # f is an unbound method - you must pass an instance of `A` in to it as the first argument.
f = a.method # f is a bound method, bound to the instance `a`. 
```

3.x：

```
a = A()
f = A.method # f is a function
f = a.method # f is a wrapped function with it's first argument filled with `a`. 
```

`a.method`可以认为是：

```
def method-wrapper():
    A.method(a) 
```

有关这方面的更多信息，请查看 Guido 的博客 - [Python 的历史](http://python-history.blogspot.co.uk/2010/06/inside-story-on-new-style-classes.html)。

编辑：

所以，这一切都适用的原因是，这里`__ne__()`没有被覆盖——它处于默认状态，这是一个身份检查，[在 C 中实现](http://hg.python.org/cpython/file/0a9143d7b097/Objects/descrobject.c)（第 980 行）。包装器用于为方法提供上述功能。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2019-04-02T15:48:18.803

下面是我的变量检查例程中的一些测试代码。定义类 Tst，它有一个`__str__`方法。要确定一个类的实例是否已定义`__repr__`或`__str__`定义，您可以测试`hasattr(obj.__str__, '__code__')`：

例子：

```
class Tst(object):
    """ Test base class.
    """
    cl_var = 15

    def __init__(self, in_var):
        self.ins_var = in_var

    def __str__(self):
        # Construct to build the classname ({self.__class__.__name__}).
        # so it works for subclass too.
        result = f"{self.__class__.__name__}"
        result += f"(cl_var: {self.__class__.cl_var}, ins_var: {self.ins_var})"
        return result

    def show(self):
        """ Test method
        """
        print(self.ins_var)

t5 = Tst(299)

print('\n\n----- repr() ------')
print(f"obj.repr(): {repr(t5)}")
print(f"obj.repr.class type: {type(t5.__repr__.__class__)}")
print(f"obj.repr.class.name: {t5.__repr__.__class__.__name__}")
print(f"obj.__repr__ has code: {hasattr(t5.__repr__, '__code__')}")

print('\n\n----- str() ------')
print(f"obj.str(): {str(t5)}")
print(f"obj.str.class type: {type(t5.__str__.__class__)}")
print(f"obj.str.class.name: {t5.__str__.__class__.__name__}")
print(f"obj.__str__ has code: {hasattr(t5.__str__, '__code__')}") 
```

回报：

```
----- repr() ------
obj.repr(): <__main__.Tst object at 0x107716198>
obj.repr.class type: <class 'type'>
obj.repr.class.name: method-wrapper
obj.__repr__ has code: False

----- str() ------
obj.str(): Tst(cl_var: 15, ins_var: 299)
obj.str.class type: <class 'type'>
obj.str.class.name: method
obj.__str__ has code: True 
```

由于`__repr__`未在类上定义，因此它默认为`__repr__`on 基类`object`，`method-wrapper`并提供默认输出。 `__str__`已定义（因此也是一种方法），因此测试`hasattr(t5.__str__, '__code__')`结果为 True。

# ios - 将文件复制到/从 iOS 应用程序的数据目录？

> ID：10401937
> 
> 赞同：3
> 
> 时间：2012-05-01T17:53:19.913
> 
> 标签：ios

安装后，如何将配置文件（在我的特定情况下设置一些日志记录参数）复制到我的 iOS 应用程序的数据目录？

或者，相关地，我如何*从*我的应用程序的数据目录中复制数据文件以供我检查以进行调试？

理想情况下，我想使用我已经设置的 USB 连接进行调试。并且无需编写我自己的应用程序附带的文件传输管理器。

我或多或少在寻找与 Android`adb push`和`adb pull`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T18:08:09.173

我认为您不需要在问题中按照您所说的去做-但我可能是错的。

当应用程序在模拟器中运行时，它会在您计算机上的目录中运行，因此运行模拟器时，要从中获取文件或为其添加文件，您只需从该文件夹中复制文件即可。

这是文件位置的[链接](https://stackoverflow.com/questions/4287005/ios-4-2-simulator-files)。

# android - jQuery Mobile Listview - Android 4 中的 Phantom/未刷新

> ID：10401938
> 
> 赞同：1
> 
> 时间：2012-05-01T17:53:30.280
> 
> 标签：android, jquery-mobile, cordova, android-emulator

`listview`我在 Android 模拟器（jQuery Mobile + PhoneGap，Android 4）中看到以下内容：

![在此处输入图像描述](../Images/9c7a776e7f856adbbef57bbea1859016.png)

首次显示页面时，列表按预期显示，但随后内容立即隐藏。触摸显示屏几次更新为：

![在此处输入图像描述](../Images/b30fba2e6556ad9d2cabcf36a79c7243.png)

该列表本身并没有什么不寻常的，即：

```
<div data-role="page" class="type-home" id="dine-around-list" data-add-back-btn="true">
    <div data-role="header" data-position="fixed" data-theme="e">
        <h1>Venue</h1>
    </div>
    <div data-role="content" class="content">
        <h3>Restaurants</h3>
        <ul data-role="listview" data-inset="true" data-theme="c" data-dividertheme="b">
            <li><a href="#dinearound1">EDGE Restaurant at The Four Seasons Denver</a></li>
            <li><a href="#dinearound3">The Ninth Door</a></li>
            <li><a href="#dinearound4">Bistro Vend&#244;me</a></li>
            <li><a href="#dinearound5">JAX Fish House &amp; Oyster Bar</a></li>
            <li><a href="#dinearound6">Venice Ristorante &amp; Wine Bar</a></li>
            <li><a href="#dinearound7">The Kitchen</a></li>
            <li><a href="#dinearound8">Capital Grille</a></li>
            <li><a href="#dinearound9">ChoLon</a></li>
            <li><a href="#dinearound10">Prima Ristorante</a></li>
            <li><a href="#dinearound11">Osteria Marco</a></li>
        </ul>
    </div>
</div> 
```

知道为什么会发生这种情况吗？我只在 Android Emulator 中的 Android 4 上看到过这个，在任何其他 Android 版本上都没有。

***更新***：一般建议是在清单中激活硬件加速，即：

```
<application android:icon="@drawable/icon" 
             android:label="@string/app_name" 
             android:hardwareAccelerated="true" > 
```

您也可以在代码中执行此操作，即：

```
if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.ICE_CREAM_SANDWICH ){
    getWindow().addFlags(WindowManager.LayoutParams.FLAG_HARDWARE_ACCELERATED);
} 
```

不过没什么区别。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T17:57:02.270

奇怪的是，从应用程序中使用的自定义 CSS 中删除以下内容解决了这个问题：

```
.ui-page { -webkit-backface-visibility: hidden; } 
```

之前添加此行是为了消除 Android 页面转换期间的闪烁（最终通过指定`$.mobile.defaultPageTransition = 'none';`和使用它来解决）。

这是一个奇怪的问题 - 解决方案似乎与问题无关。

# c# - 跳过读取某个父节点内的 xml 元素

> ID：10401942
> 
> 赞同：0
> 
> 时间：2012-05-01T17:53:42.833
> 
> 标签：c#, .net, xml, kml

我正在使用 xmlreader.read() 读取 xml gps 数据。我想输出不在线元素内的所有坐标点。以下包含在文件中，我想排除列出的坐标。

```
<place>
  <desc>home</desc>
  <line>
      <coordinate>123,123,123</coordinate>
      <coordinate>1223,1223,22123</coordinate>
  </line>
</place> 
```

这是一个有效坐标的示例，我想输出和处理（都位于同一个文件中）：

```
<place>
   <desc>home</desc>
   <point>
      <coordinate>123,123,123</coordinate>
   </point>
</place> 
```

不同的是，一个是线对象的一部分，另一个是点。我目前有这个代码，它抓住了一切。

```
 while (lxmlReader.Read())
            {

                    if (lxmlReader.NodeType == XmlNodeType.Element)
                    {
                        if (lxmlReader.Name == "coordinate")
                        {
                            rtxtOutput.Text += "\r\nElement Name: " + lxmlReader.Name.ToString();
                            rtxtOutput.Text += " Value: " + lxmlReader.ReadInnerXml().ToString();
                        }
                    }                   
            } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T18:02:58.087

我不确定如何使用 XmlReader（或者是否可能）来执行此操作 - 您是否考虑将 XML 加载到 XmlDocument 或 XDocument 对象中，这将允许您对其执行适当的查询。

然后你可以做这样的事情：

```
XmlDocument doc = new XmlDocument();
doc.Load("path.xml");
foreach (XmlElement  pointCoord in doc.SelectNodes("/place/point/coordinate"))
{
    /Do something
} 
```

你会发现很多使用 XPath 在线选择基于父节点等的示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T18:10:15.840

如果你有可用的 LINQ，我会做这样的事情：

```
IEnumerable<string> coords = XElement.Load("gps.xml")
    .Descendants("point")
    .Descendants("coordinate")
    .Select(c => c.Value); 
```

# html - 限制div高度

> ID：10401944
> 
> 赞同：1
> 
> 时间：2012-05-01T17:53:47.900
> 
> 标签：html, css

有人可以解释为什么当我告诉一个 div 时：

*   它的高度是500px，它的最大高度也是500px，

*   如果他需要溢出（自动）。

当在 div 中动态放置元素时，它会增长到它需要的大小，考虑到我的限制，整个页面将滚动而不是 div。

为什么？怎么修？

好的，对于最小的细节抱歉，我刚刚得到它，如果使用 display: inline-table，它会忽略我写的所有这些不起作用的东西......谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-01T17:58:05.847

以下似乎对我来说很好。在此处查看演示：http: [//jsbin.com/iqigen/5/edit](http://jsbin.com/iqigen/5/edit)

```
<style>
  #box {
    height: 500px;
    overflow: auto;
  }
</style>
<div id="box"></div> 
```

当嵌套元素的集体高度超过父级时，父级会进行溢出。当内容溢出时，将在父元素上显示一个滚动条，阻止超出其容器边界的子元素的任何视图。

您可以使用以下内容添加几个动态元素：

```
var colors = [ '#F00', '#660', '#066' ];

setInterval( addElement, 1000 );

function addElement(){
  $("<p>", { text: new Date() })
    .css( 'background', colors[ Math.floor( Math.random() * colors.length ) ] )
    .appendTo( "#hello" );
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T17:58:28.310

根据措辞不确定您要问什么。但是，如果您说 div 没有增长并且内容通过 div 到背景上，那么页面滚动而 div 保持小于内容。

会发生的原因是因为你放了一个 max-height: 500px; 在你的 div 上。在这样做时，您是在说'无论如何不要大于 500 像素。如果您将最小高度设置为 500 像素，那么它将始终为 500 像素，除非您需要它更大以适应内容。

如果这不是您要问的，我再次道歉。

# c# - 实体框架在查询时返回错误数据

> ID：10401946
> 
> 赞同：-1
> 
> 时间：2012-05-01T17:53:53.510
> 
> 标签：c#, entity-framework, c#-4.0, entity-framework-4

如果我运行以下

```
 var allrecords = proxy.itemAuditReports.ToList().OrderBy(u=>u.SKU); 
```

我在所有记录中都得到了这个。

*   [0]=库存=60，使用=20，月=1，Sku=001

    [1]=库存=60，使用=20，月=1，Sku=001

但是在数据库中我有值

*   第 1 个月：库存 =60，使用情况=20，SKU：001

    第 4 个月：库存 = 20，使用量 =10，SKU 001

这里出了什么问题？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T18:13:55.667

只有一行代码的最佳猜测是，EF 认为是您的主键，实际上并不是唯一的。

# java - 清除 Thread.interrupt() 标志的方法

> ID：10401947
> 
> 赞同：23
> 
> 时间：2012-05-01T17:53:59.540
> 
> 标签：java, multithreading, interrupt

我最近继承了一个几乎没有线程安全的大型 Java 应用程序。我目前正在做的是让所有线程正确处理被中断而不是使用非常糟糕的`Thread.stop()`.

部分问题是我不知道清除中断标志的每个方法调用。

目前我知道以下将清除中断标志：

```
Thread.interrupted()
Thread.sleep(long)
Thread.join()
Thread.join(long)
Object.wait()
Object.wait(long) 
```

我还缺少什么？谢谢

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-09-09T13:30:02.457

> 部分问题是我不知道清除中断标志的每个方法调用。

重要的是要澄清以下方法只需调用它们即可清除中断标志：

```
Thread.interrupted()
Thread.isInterrupted(true) -- added to your list 
```

出于这个原因`Thread.currentThread().isInterrupted()`，应该始终使用它。

以下方法将通过*立即*抛出来清除中断标志，`InterruptedException`如果它们被调用然后线程被中断*，或者*如果线程*已经*被中断然后它们被调用（参见下面的junit代码）。所以不是清除标志的方法，而是抛出异常。

您的初始清单：

```
Thread.interrupted()
Thread.sleep(long)
Thread.join()
Thread.join(long)
Object.wait()
Object.wait(long) 
```

添加到您的列表中：

```
Thread.sleep(long, int)
Thread.join(int, long)
Thread.isInterrupted(true)
Object.wait(int, long)
BlockingQueue.put(...)
BlockingQueue.offer(...)
BlockingQueue.take(...)
BlockingQueue.poll(...)
Future.get(...)
Process.waitFor()
ExecutorService.invokeAll(...)
ExecutorService.invokeAny(...)
ExecutorService.awaitTermination(...)
CompletionService.poll(...)
CompletionService.take(...)
CountDownLatch.await(...)
CyclicBarrier.await(...)
Semaphore.acquire(...)
Semaphore.tryAcquire(...)
Lock.lockInteruptibly()
Lock.tryLock(...) 
```

**请注意，捕获***任何*代码的正确模式`InterruptedException`是立即重新中断线程。我们这样做以防其他人依赖该`thread.isInterrupted()`方法：

```
try {
    ...
} catch (InterruptedException e) {
    // immediately re-interrupt the thread
    Thread.currentThread().interrupt();
    // log the exception or [likely] quit the thread
} 
```

JUnit 代码演示了其中的一些：

```
assertFalse(Thread.currentThread().isInterrupted());
// you can do this from another thread by saying: someThread.interrupt();
Thread.currentThread().interrupt();
// this method does _not_ clear the interrupt flag
assertTrue(Thread.currentThread().isInterrupted());
// but this one _does_ and should probably not be used
assertTrue(Thread.interrupted());
assertFalse(Thread.currentThread().isInterrupted());
Thread.currentThread().interrupt();
assertTrue(Thread.currentThread().isInterrupted());
try {
    // this throws immediately because the thread is _already_ interrupted
    Thread.sleep(1);
    fail("will never get here");
} catch (InterruptedException e) {
    // and when the InterruptedException is throw, it clears the interrupt
    assertFalse(Thread.currentThread().isInterrupted());
    // we should re-interrupt the thread so other code can use interrupt status
    Thread.currentThread().interrupt();
}
assertTrue(Thread.currentThread().isInterrupted()); 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-05-01T18:04:09.167

通用约定如下：任何抛出`InterruptedException`(+ `Thread.interrupted()`) 的方法都会清除中断标志。

因此，为了使您的线程可中断，您需要找到所有`InterruptedException`被捕获的地方，而无需追溯或恢复中断标志。由于`InterruptedException`是已检查异常，因此不难做到。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-05-13T10:06:45.920

这是一个超级有趣的例子：

1.1.4 版本之前的 ch.qos.logback.core.AsyncAppenderBase 捕获并吞下 InterruptedException 而不重置线程上的标志。

所以，如果你使用任何路由到这个记录器的东西（比如 slf4j），它会默默地吃掉你的线程中断状态。'因为，我的意思是，谁不会在每个可能的日志操作之前和之后检查线程中断状态？

# vb.net - VB.NET：IF 语句的语句结束错误

> ID：10401948
> 
> 赞同：1
> 
> 时间：2012-05-01T17:54:11.707
> 
> 标签：vb.net, if-statement

我有以下 IF 语句，并且在以下条件下出现“语句结束”错误：不在 ('Deferred','Rejected','Closed')

```
 If (temp_var_1 = temp_var_2) And temp_var_3 not in ("Deferred","Rejected","Closed") Then 
```

如果我在 temp_var_3 和最右边的 ')' 周围加上括号，则在***not***我得到：')' 预期

```
If (temp_var_1 = temp_var_2) And (temp_var_3 not in ("Deferred","Rejected","Closed")) Then 
```

几点注意事项：

*   所有临时变量都是字符串。
*   它适用于 MS SQL：temp_var_3 not in ('Deferred','Rejected','Closed')

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T18:00:17.483

```
If (temp_var_1 = temp_var_2) AndAlso (Not {"Deferred", "Rejected", "Closed"}.Contains(temp_var_3)) Then 
```

此外，如果您将**Option Strict On**放在文件顶部，它将帮助您查找错误。

# ios - UITableViewCell。如何在触地期间突出显示单元格？

> ID：10401949
> 
> 赞同：20
> 
> 时间：2012-05-01T17:54:27.573
> 
> 标签：ios, uitableview, custom-cell

我有一个自定义的 tableViewCell。我想通过突出显示来指示用户触地。单元格选择样式为`UITableViewCellSelectionStyleBlue`. 在我设置的父控制器中`self.clearsSelectionOnViewWillAppear = YES`。

我应该可以走了。没有。选择仍然粘在单元格上。我想要的是仅在触地期间的选择指示。外观应在修饰时立即恢复为未选择的外观。

我该怎么做呢？

干杯，
道格

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-05-01T18:26:03.103

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath{

    [tableView deselectRowAtIndexPath:indexPath animated:YES];

} 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2015-05-14T06:09:53.533

下面的 Swift 示例用于`didHighlightRowAtIndexPath`更改触摸时单元格的背景颜色并`didUnhighlightRowAtIndexPath`重置颜色 - 见下文：

```
// MARK: UITableViewDelegate

func tableView(tableView: UITableView, didHighlightRowAtIndexPath indexPath: NSIndexPath) {
  if let cell = tableView.cellForRowAtIndexPath(indexPath) {
     cell.backgroundColor = UIColor.greenColor()
  }
}

func tableView(tableView: UITableView, didUnhighlightRowAtIndexPath indexPath: NSIndexPath) {
  if let cell = tableView.cellForRowAtIndexPath(indexPath) {
     cell.backgroundColor = UIColor.blackColor()
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T17:55:58.650

覆盖`- (void)setSelected:(BOOL)selected animate:(BOOL)animated`而不调用 super

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-30T09:27:59.937

这有效：

它获取带有单元格边框的背景视图，看起来像分隔符。不要更改界面生成器中的默认表格视图设置。确保 UITableViewCellSelectionStyleNone 未设置为 selectionstyle。我正在粘贴工作代码。：

```
 - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{
static NSString *kCellIdentifier = @"PlayListCell";
UITableViewCell *cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:kCellIdentifier];
if (cell == nil) {
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:kCellIdentifier];
}
MPMediaPlaylist *playList = [playlistCollection objectAtIndex:indexPath.row];
cell.textLabel.text = playList.name;
cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
 // cell.selectionStyle = UITableViewCellSelectionStyleNone;
cell.detailTextLabel.text = [NSString stringWithFormat:@"%d Songs",[playList.items count]];
MPMediaItemCollection *playListMediaCollection = [playlistCollection objectAtIndex:indexPath.row ];

cell.imageView.image =[UIImage imageWithCGImage:[self getImageForCollection:playListMediaCollection.items]];

// the main code which make it highlight

UIView *bgColorView = [[UIView alloc] init];
bgColorView.backgroundColor = [UIColor colorWithRed:170.0f/255.0 green:170.0f/255.0 blue:170.0f/255.0 alpha:1.0f];
[bgColorView.layer setBorderColor:[UIColor blackColor].CGColor];
[bgColorView.layer setBorderWidth:1.0f];
[cell setSelectedBackgroundView:bgColorView];

return cell; 
```

}

* * *

## 回答 #5

> 赞同：-5
> 
> 时间：2012-05-01T18:15:57.687

**我有同样的问题。下面的代码非常适合我。**

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath{
[tableView deselectRowAtIndexPath:indexPath animated:YES];
} 
```

# eclipse - 如何从 Eclipse 资源管理器视图中隐藏修订号？

> ID：10401950
> 
> 赞同：24
> 
> 时间：2012-05-01T17:54:32.433
> 
> 标签：eclipse, svn, revision, subversive

![在此处输入图像描述](../Images/e822852d636e8dfbcf7009aad823dde5.png)

有什么办法可以隐藏这个号码，因为这个号码已经太久了？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-05-01T18:00:52.827

`Team->SVN->Label Decorations`您可以从首选项页面中删除标签装饰。有关详细信息，请参阅[此页面](http://www.eclipse.org/subversive/documentation/preferences/pref_label_decors.php)。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2014-07-24T20:56:31.633

在 Eclipse Kepler 中，转到 Window -> Preferences -> General -> Appearance -> Label Decorations -> 并取消选中 SVN。

但是，请注意，这也会关闭所有其他指示符，例如“>”或“<”符号，这表明与签出版本相比，存储库发生了变化……至少，在日食开普勒。

# unix - 显示所有以特定字符开头的表格

> ID：10401954
> 
> 赞同：1
> 
> 时间：2012-05-01T17:54:57.360
> 
> 标签：unix, informix

我想显示或搜索数据库中以名称“bar”开头的所有表。这是我可以通过命令行做的事情吗？

我正在使用informix。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T19:37:48.987

```
select tabname from systables where tabname like "%bar%" 
```

找到了！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T21:28:05.660

基本答案是针对系统目录的查询（如[user856753的](https://stackoverflow.com/users/856753/user856753)[答案](https://stackoverflow.com/questions/10401954/display-all-tables-that-start-with-specific-characters/10403230#10403230)所示）。如果您想确保使用所有类型的 Informix 数据库，那么您可能会使用：

```
dbaccess dbname - <<'EOF'
SELECT TabName FROM informix.SysTables WHERE TabName LIKE 'bar%';
EOF 
```

请注意，另一个答案中的查询使用`LIKE '%bar%'`which 匹配包含名称中`bar`任何位置的表名，而不仅仅是以开头的表名`bar`（尽管它也会选择那些）。`informix.SysTables`即使`dbname`（数据库）碰巧是 MODE ANSI 数据库，使用确保查询也能正常工作。如果没有所有者名称，则查询仅适用于由 user 运行的 MODE ANSI 数据库`informix`。

用于查询随 Informix 分发的数据库的主要命令行工具是`dbaccess`. 第一个参数是数据库名，第二个`-`（的行数到仅包含 的行。周围的单引号表示“在调用输入时不要对 'here-document' 中的材料进行任何 shell 扩展。如果您的脚本选择数据库，您可以在命令行上使用 a 代替数据库名称. 如果你在没有类似选项的情况下运行，那么它会以类似诅咒的交互模式运行。`-``<<'EOF'``EOF``'EOF'``-``dbaccess`

您将从`dbaccess`中获得表格输出。您通常可以使用“输出”命令改进输出：

```
dbaccess dbname - <<'EOF'
OUTPUT TO '/dev/null' WITHOUT HEADINGS
    SELECT TabName FROM informix.SysTables WHERE TabName LIKE 'bar%';
EOF 
```

# c++ - 需要一个包含运行任务时间的二维矩阵的最优解

> ID：10401955
> 
> 赞同：1
> 
> 时间：2012-05-01T17:55:00.810
> 
> 标签：c++, algorithm

我有一个由 m 个处理器（列）和 n 个任务（行）组成的二维矩阵，该矩阵填充了每个进程在处理器上运行所需的时间，我需要找到在 m 个处理器上运行这些 n 个任务的最佳时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T18:20:42.300

所描述的问题属于**并行机器调度问题**的范畴。
此外，由于每个任务在不同的处理器上花费不同的时间，这个问题被称为**统一机器调度问题**。

这类问题是强 NP 难的，因此没有多项式时间算法是已知的。因此，除非矩阵非常小，否则非常不鼓励使用蛮力方法，因为复杂性类似于`O( n ^ m )`.

话虽如此，通过使用混合整数线性规划 (MILP) 并使用 Cplex 或 Gurobi 等最佳线性求解器（我几乎不认为像 LP-solve 这样的开源求解器可以处理超出一定规模的问题）。

[此处](http://www.or.uni-bonn.de/lectures/ss10/scheduling_data/sched10_4.pdf)描述了适用于此问题的 MILP 模型示例。

然而，鉴于它们的复杂性，这类问题通常使用启发式/元启发式来解决，因此无法确保达到最佳解决方案。无论如何，一个好的贪心算法和一个好的局部搜索来改进贪心解决方案，可以非常接近最优。

**编辑 ：**

一种可能的蛮力方法是计算任务 TASK-PROCESSOR 的所有可能组合，然后计算制造跨度。[这是 C/C++ 中的一个示例](http://pastebin.com/J5R5WD7H)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T18:10:34.803

首先计算完成所有处理所需的总线性时间（将所有任务的持续时间相加）。现在除以数量或处理器，`m`。

这是您的目标平均时间。您想找到每个处理器的持续时间组合，它们加起来尽可能接近这个数字

最基本的方法是：

```
avg = <the average from earlier>
list = <all jobs>
FOR i = 0 to m
    WHILE duration(processor[i]) < avg:
        processor[i].add(longest lasting job in `list` that will keep the time less than `avg` 
```

这将在最后留下一些作业，将持续时间最长的作业添加到最短的处理器时间，直到没有作业留在`list`

# c# - 在文本块而不是工具提示中显示 IDataErrorInfo 错误

> ID：10401959
> 
> 赞同：1
> 
> 时间：2012-05-01T17:55:14.873
> 
> 标签：c#, wpf, idataerrorinfo, validation

我已经看到很多关于如何在文本框的工具提示中显示错误的示例。有人可以给我一个示例，说明如何在单独的 TextBlock 中而不是在 TextBox 的工具提示中显示错误？

如果文本框和文本块处于不同的视图中，我特别想知道如何做到这一点。带有文本块的视图可以访问在其上实现了 IDataErrorInfo 的数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T12:47:05.390

你写了

> 带有文本块的视图可以访问在其上实现了 IDataErrorInfo 的数据。

所以一种方法可能是将文本块绑定到与文本框相同的属性。然后为您的文本块创建一个验证模板，覆盖整个文本块。

编辑：也许是这样的？

```
<ControlTemplate x:Key="ValidationTemplate">
    <Grid>
        <AdornedElementPlaceholder Name="MyAdornedElement" />  
        <TextBlock Text="{Binding ElementName=MyAdornedElement,Path=AdornedElement.(Validation.Errors).CurrentItem.ErrorContent}" />
    </Grid>
</ControlTemplate> 
```

当然，您必须将其添加到文本块样式中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T18:55:42.223

所以我最终做的是添加一个我用错误文本设置的属性。每当我的 Name 属性更新时，如果它有错误，我就会更新 NameError 属性。然后我能够绑定到该属性。它似乎有点脏，但它对我有用。

# google-chrome-extension - 消息未从内容脚本发送到 background.js

> ID：10401970
> 
> 赞同：0
> 
> 时间：2012-05-01T17:56:42.640
> 
> 标签：google-chrome-extension, dotjs

我正在尝试使用内容脚本将我自己的 JS 文件注入页面。我尝试这样做的方式是基于名为 dotjs 的 Chrome 扩展使用的系统，该扩展在您的计算机上运行一个小服务器，并使 AJAX 请求到 localhost 以便从该服务器检索文件。

由于同源策略，我相当确定这些 AJAX 请求只有在从 background.js 而不是内容脚本发送时才会通过。我还需要使用 webRequest，它也只能在后台页面中使用。但是，由于我需要将内容注入页面本身，因此我需要一个内容脚本。所以我的扩展与一个内容脚本一起工作，该脚本将消息发送到后台页面，请求它执行它需要的所有 webRequest 和 AJAX。

问题是，background.js 似乎没有收到这些消息。如您所见，我在 background.js 的 onRequest 处理程序中有一些 console.log()，它们没有出现在我的控制台中。

**清单.json**

```
{
  "name": "dotjs",
  "version": "1.5",
  "description": "~/.js",
  "icons": { "48": "icon48.png",
            "128": "icon128.png" },
  "content_scripts": [{
    "all_frames": true,
    "run_at":     "document_start",
    "matches":    ["[censored]"],
    "js":         ["dotjs.js"]
  }],
  "background": {
    "scripts": ["jquery.js", "background.js"]
  },
  "permissions": ["tabs", "webRequest", "extension"]
} 
```

**dotjs.js**

```
console.log("dotjs.js running");

var requestFilter =
    {
        url: "[censored]"
    };

var blockingResponse =
    {
        redirectUrl: "http://localhost:2262/Pigman/ips.chat.js"
    };  

function requestInterceptor(details)
{
    return blockingResponse;
}

chrome.extension.sendRequest(
    {
        type: "setListener",
        func: requestInterceptor,
        filter: requestFilter
    }
);

chrome.extension.sendRequest(
    {
        type: "loadJS",
        filename: "Elizabot/elizabot.js"
    },
    function (response) { eval(response); }
);

chrome.extension.sendRequest(
    {
        type: "loadJS",
        filename: "Elizabot/elizadata.js"
    },
    function (response) { eval(response); }
); 
```

**背景.js**

```
function loadJSFile(filename)
{
    $.ajax({
        url: 'http://localhost:2262/Pigman/' + filename + '.js',
        dataType: 'text',
        success: function(d){
            return d;
        },
        error: function(){
            console.log('no file found at localhost:2262/' + filename + '.js')
        }
    });
}

chrome.extension.onRequest.addListener(
    function(request, sender, sendResponse)
    {
        console.log("background.js received request:");
        console.log(request);
        if (request.type == "setListener")
        {
            chrome.webRequest.onBeforeRequest.addListener(request.func, request.filter);
        }
        if (request.type == "loadJS")
        {
            sendResponse(loadJSFile(request.filename));
        }
    }
); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T20:27:45.483

您的代码/设计中有许多缺陷：

1.  内容脚本*可以*发出跨域 AJAX 请求，前提是资源 URL`permissions`在清单文件的部分中指定。
2.  `webRequest`API 不会捕获在 Chrome 扩展范围内创建的任何请求。
3.  处理程序中的`return`语句**不会**将响应返回给调用者：`success`**`loadJSFile`**

     **```
     sendResponse(loadJSFile(request.filename));
    ...
    function loadJSFile(filename) {
        $.ajax({
            ...
            success: function(d){
                return d;
            } ... 
    ```

    至少使用：

    ```
    loadJSFile(request.filename, sendResponse);
    function loadJSFile(filename, sendResponse) {
        $.ajax({
            url: 'http://localhost:2262/Pigman/' + filename + '.js',
            dataType: 'text',
            success: sendResponse, /// <--- Now it works! 
    ```** 

 **关于调试的最后说明：我很确定消息已记录在控制台中。你只是看错地方了。有关读取后台页面控制台输出的步骤，请参阅[Google chrome 扩展 - 从 background.js 记录。](https://stackoverflow.com/a/10258029/938089?google-chrome-extension-logging-from-background-js)**

# linux - 神秘的psaadm进程

> ID：10401976
> 
> 赞同：2
> 
> 时间：2012-05-01T17:56:54.613
> 
> 标签：linux, plesk

在我的服务器上运行“top”时，我注意到一个刚刚开始弹出的 psaadm 进程。该命令始终是“/usr/bin/sw-engine-cgi -c /usr/local/psa/admin/conf/php.ini -d auto_prepend_file=auth.php3 -u psaadm”。它只占用大约 1-2% 的 CPU，但我不确定为什么该命令会不断重复。有什么见解吗？在服务器方面，我有点新手。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T18:24:42.417

这是您的系统所需的 plesk 服务器。psaadm 是运行该进程的用户。

# iphone - 比较字符数组 contatinig hexa 值

> ID：10401979
> 
> 赞同：0
> 
> 时间：2012-05-01T17:57:05.387
> 
> 标签：iphone, objective-c

我正在以下列方式接收 NSData

```
 - (void)socket:(GCDAsyncSocket *)sock didReadData:(NSData *)data withTag:(long)tag
    { 
    char *ptr = (void *)[data bytes]; // set a pointer to the beginning of your data   bytes 
```

我正在接收数据，然后我需要将此数据与以下数组进行比较

```
 char ch[3]={0x04,0x01,0X00}; 
```

因为数据来自服务器，但数据是动态的，我需要将许多这样的数组与我找到以下方法的服务器数据进行比较，但它是静态方法，但无法以以下方式比较所有数组

```
 if(*ptr == 0x04) {
       }
      ptr++;
      if(*ptr == 0x01) {
       }
  ptr++;
  if(*ptr==0X00){
       }
but i can not compare all array so please help how 
```

我可以比较

```
 char *ptr = (void *)[data bytes]; 
```

和

```
 char ch[3]={0x04,0x01,0X00}; 
```

请帮忙

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T18:13:31.860

如果您使用一个`NSData`对象来比较您正在比较的数据 ( `ch[3]`)，那么您可以使用它[`-[NSData rangeOfData:options:range:]`](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSData_Class/Reference/Reference.html#//apple_ref/doc/uid/20000172-SW7)来查找模式。

这是一个例子

```
//This is just mock up data to represent what would be passed into your method
unsigned char ch1[] = { 0x01, 0x02, 0x03, 0x04, 0x05, 0x04, 0x01, 0x00, 0x0F }; 
NSData *data1 = [[NSData alloc] initWithBytes:ch1 
                                       length:sizeof(ch1)];
//This is the data used for the comparison
NSData *data2 = [[NSData alloc] initWithBytes:(unsigned char[]){0x04, 0x01, 0x00} 
                                       length:3];

NSRange range = [data1 rangeOfData:data2 
                           options:0 
                             range:NSMakeRange(0, [data1 length])];

if(range.location != NSNotFound)
{
     NSLog(@"Found pattern!");
} 
```

# ant - 通过 Maven 调用 Ant 目标

> ID：10401981
> 
> 赞同：1
> 
> 时间：2012-05-01T17:57:10.370
> 
> 标签：ant, maven-2

## 我可以做这个

`build.xml`使用 . 从 Maven运行 ANT `ant run plugin`。

我的`pom.xml`

```
<target>
  <property name="src.dir" location="my_project_folder_location"/>
  <subant>
     <fileset dir="${src.dir}" includes="**/build.xml"/>
  </subant>
</target> 
```

这运行 ANT`build.xml`

```
 <project name="*ant_test" basedir=".">
    <copy overwrite="true" force="true" verbose="true" todir="to_folder">
        <fileset dir="from_folder" />
    </copy>
 </project> 
```

它执行从一个文件夹复制到另一个文件夹的任务。

## 我需要做的是：

运行这个新`build.xml`的`<target>`.

```
 <project name="*ant_test" basedir=".">
   <target name="onlyCopy">
    <copy overwrite="true" force="true" verbose="true" todir="to_folder">
        <fileset dir="from_folder" />
    </copy>
  </target>
 </project> 
```

我应该在`pom.xml`

## 编辑

[这个问题](https://stackoverflow.com/q/10339712/1354000)和之间的区别是：

在`build.xml`我提到的 ANT 中`<targer>`。Target 允许通过从 ANT builtfire 中选择目标名称来运行独立的任务。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T13:45:36.043

基本上，您正在寻找的是使用所有目标运行 ANT，而无需单独运行每个目标。

你可以简单地在你的 subant 中添加一个目标`pom.xml`

`<subant target="onlyCopy">`会成功的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T18:44:44.410

有关从 Maven 调用 ANT 的示例，请参见以下答案：

[如何使用 Maven 调用 Ant Builts](https://stackoverflow.com/questions/10339712/how-do-i-call-ant-builts-using-maven/10356762#10356762)

# ios - 提高更新 Core Data 中现有记录 (~11.000) 的速度

> ID：10401983
> 
> 赞同：7
> 
> 时间：2012-05-01T17:57:27.827
> 
> 标签：ios, core-data, nsfetchrequest

我正在解析最初插入核心数据存储的大量数据。

稍后，我将解析相同的 XML，尽管其中一些*可能*已更新。然后我要做的是检查具有相同标签的现有记录，如果已经存在，我用数据更新记录。

然而，虽然我的初始解析（大约 11.000 条记录）需要 8 秒左右，但更新似乎很昂贵并且需要 144 秒（这些是模拟器运行，因此在实际设备上要长得多）。

虽然第一次很好（我正在显示一个进度条），但第二次太长了，我想做一些事情来提高速度（即使它发生在单独线程的后台）。

不幸的是，这不是[查找或创建](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreData/Articles/cdImporting.html#//apple_ref/doc/uid/TP40003174-SW4)的问题，因为 XML 中的数据可能已针对单个记录进行了更改，因此每个记录本质上都可能需要更新。

我已经对属性进行了索引，这也加快了初始解析和更新的速度，但它仍然很慢（上面的数字带有索引）。我注意到解析/更新似乎逐渐减慢。虽然最初很快，但随着处理的记录越来越多，它变得越来越慢。

所以最后我的问题是，对于我如何提高更新数据集的速度有什么建议吗？我正在使用 MagicalRecord 来获取记录。这是代码：

```
Record *record;
if (!isUpdate) {
    record = [NSEntityDescription insertNewObjectForEntityForName:@"Record" inManagedObjectContext:backgroundContext];
} else {
    NSPredicate *recordPredicate = [NSPredicate predicateWithFormat:@"SELF.tag == %@", [[node attributeForName:@"tag"] stringValue]];
    record = [Record findFirstWithPredicate:recordPredicate];
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T19:08:55.570

与其进行大量的提取，不如对每种实体类型进行一次查询，然后按标签将它们存储在字典中，然后只需检查字典是否存在具有该键的对象。您应该能够将 propertiesToFetch 设置为仅包含标记，并且应该可以减少开销。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T12:51:55.830

所有性能问题的最初答案是运行仪器。然后，使用这些数据，您可以确定您的问题区域。从那里，您可能对提高性能的某些方面有其他具体的问题。

我们人类在识别性能瓶颈方面是出了名的差。所以，首先使用仪器。它肯定会告诉你你的时间都花在了哪里。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T19:45:00.420

您还可以尝试将高级的答案与属性的散列结合起来。

在插入散列属性并将该散列存储为`Record`.
在更新时，您将获取的属性设置为标记和校验和，并对所有项目进行一次获取。然后，当您遍历数据集时，如果校验和与已获取的不同，您可以获取`Record`并更新它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-01T18:19:54.213

您可以尝试的一件事是使用模板 NSPredicate，这样您就不会为正在执行的每个查找/获取重新解析格式字符串。

所以在你进入你的循环之前：

```
NSPredicate *template = [NSPredicate predicateWithFormat:@"SELF.tag == $RECORD_TAG"]; 
```

循环内：

```
Record *record;
if (!isUpdate) {
    record = [NSEntityDescription insertNewObjectForEntityForName:@"Record" inManagedObjectContext:backgroundContext];
} else {
    NSPredicate *recordPredicate = [];
    record = [Record findFirstWithPredicate:[template predicateWithSubstitutionVariables:[NSDictionary dictionaryWithObject:[[node attributeForName:@"tag"] stringValue] forKey:@"RECORD_TAG"]];
} 
```

有关更多信息，请参阅 Apple 的[谓词编程指南](https://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/Predicates/Articles/pCreating.html)。

# iphone - 静态方法目标 c - 初始化一次

> ID：10401985
> 
> 赞同：0
> 
> 时间：2012-05-01T17:57:37.370
> 
> 标签：iphone, objective-c, ios, alloc

我想分类应该只初始化一次并返回一些第一次计算的值。下面是正确的方法吗？

```
@property (nonatomic, retain) NSString *userAgent;

@implementation UserAgent
@synthesize userAgent = _userAgent;

+ (NSString *) userAgentString
{
    UserAgent *thisClass;
    if(self == nil)
    {
        thisClass = [[UserAgent alloc] init];
    }

    if (thisClass.userAgent == nil)
    {
        return @"not initialized";
    }

    return thisClass.userAgent;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T18:08:01.820

不。

1.  `thisClass`是一个局部变量。`+userAgentString`这意味着，每次调用该值都会被重置（垃圾） 。至少能做到`static`。

2.  `self`的含义不是您在类方法中所期望的。你的意思是`thisClass`？

3.  即使进行了上述修复，该方法也不是线程安全的，这可能会也可能不会。

请参阅[在 Objective C 中使用 GCD 的 dispatch_once 创建单例](https://stackoverflow.com/questions/5720029/create-singleton-using-gcds-dispatch-once-in-objective-c)和[在 iOS 5 中使用单例？](https://stackoverflow.com/questions/8796529/singleton-in-ios-5)作为正确构造*单例*的示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T18:07:33.387

几个变化。首先，`thisClass`应该是静态的。其次，您在静态方法中没有`self`指针，因此您应该在`thisClass`那里使用。像这样：

```
+ (NSString *) userAgentString
{
    static UserAgent *thisClass;
    if(thisClass == nil)
    {
        thisClass = [[UserAgent alloc] init];
    }

    if (thisClass.userAgent == nil)
    {
        return @"not initialized";
    }

    return thisClass.userAgent;
} 
```

此外，正如评论者所提到的，更好的方法可能是使用单例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T18:16:27.860

[http://www.galloway.me.uk/tutorials/singleton-classes/](http://www.galloway.me.uk/tutorials/singleton-classes/)

这工作..谢谢@Inafziger

# iphone - 在界面生成器的 UILabel 中使用本地化文本？

> ID：10401987
> 
> 赞同：1
> 
> 时间：2012-05-01T17:57:41.333
> 
> 标签：iphone, objective-c, ios

是否可以直接在界面构建器中使用字符串的本地化版本？还是我需要获取屏幕上每个标签等的引用，然后手动使用`NSLocalizedString(...);`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T18:04:43.090

在实用程序面板的文件检查器中，您将找到本地化部分。您可以在那里添加语言。对于每种语言，Xcode 将为该语言创建一个 XIB，因此您只需编辑每个 XIB。

# python - Django Pagination 适用于第一页，不适用于第二页

> ID：10401989
> 
> 赞同：5
> 
> 时间：2012-05-01T17:57:44.530
> 
> 标签：python, django

我有一个搜索视图，允许用户搜索他们的记事卡，然后一次显示分页 6 的结果。

我在所有其他视图中都使用了分页，它可以正常工作。但是，将它与查询一起使用时，它会显示前 6 个结果，显示“第 1 页，共 2 页”和下一个按钮，但是当您单击“下一步”时，您找不到任何结果。

我已将“*”查询设置为全部搜索，当我搜索该查询时，第一个请求调用是：

`http://127.0.0.1:8000/search/?q=*`

当我单击下一步时，调用是：

`http://127.0.0.1:8000/search/?page=2`

搜索网址是：

`url(r'^search/', 'notecard.search.views.search', name="search"),`

搜索视图是：

```
@login_required(login_url='/auth/login/')
def search(request):
    query = request.GET.get('q', '')
    results = []
    notecard_list = []
    if query:
        if query == "*":
            results = Notecard.objects.filter(section__semester__user=request.user)
        else:
            results = Notecard.objects.filter(Q(section__semester__user=request.user), Q(notecard_body__icontains=query)|Q(notecard_name__icontains=query))
        paginator = Paginator(results, 6)

        try:
            page = int(request.GET.get('page', '1'))
        except ValueError:
            page = 1

        try:
            notecard_list = paginator.page(page)
        except (EmptyPage, InvalidPage):
            notecard_list = paginator.page(paginator.num_pages)
    return list_detail.object_list(
        request,
        queryset = Notecard.objects.filter(section__semester__user=request.user),
        template_name = "notecards/search.html",
        template_object_name = "results",
        extra_context = {"results": results, "notecard_list": notecard_list,},
    ) 
```

搜索模板是：

```
{% extends "base.html" %}
{% block title %} Notecard List | {% endblock %}

{% block content %}
<div id='main'>
<table id='notecards'>
  <tr>
        <th class="name">Search Results</th>
  </tr>
</table>

<table id='known_split'>
        <p>Search results:<a class="edit" href="{% url semester_list %}">Back to Semesters</a></p>
            {% for result in notecard_list.object_list %}
                    <tr>
                        <td class="image">{% if result.known %}<img src="{{ STATIC_URL }}/images/known.png" width="41" height="40" />{% else %}<img src="{{ STATIC_URL }}/images/unknown.png" width="41" height="40" />{% endif %}</td>
                    <td class="text"><a href="{% url notecards.views.notecard_detail result.id %}">{{ result.notecard_name|truncatewords:9 }}</a></td>
                    </tr>
                {% endfor %}
</table>

<div class="pagination">
  <span class="step-links">
{% if notecard_list.has_previous %}
<a class="navlink" href="?page={{ notecard_list.previous_page_number }}">previous</a>
{% endif %}

<span class="current">
Page {{ notecard_list.number }} of {{ notecard_list.paginator.num_pages }}
</span>

{% if notecard_list.has_next %}
<a class="navlink" href="?page={{ notecard_list.next_page_number }}">next</a>
{% endif %}
  </span>
</div>

{% endblock %} 
```

正如我所说，我在其他所有视图中都成功地使用了基本相同的分页，所以我必须相信这是由于查询造成的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T18:16:15.293

1.  您没有`q`在第 2 页的 URL 中提供参数（URL 应该类似于`http://127.0.0.1:8000/search/?q=*&page=2`）
2.  您应该查看基于类的视图（`ListView`更准确地说），其中包括[分页](https://docs.djangoproject.com/en/dev/ref/class-based-views/#django.views.generic.list.MultipleObjectMixin.paginate_by)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-06-04T16:11:55.007

需要在URL中包含`q`参数，`has_previous & has_next`

```
<a class="navlink" href="?page={{ notecard_list.previous_page_number }}&q1={{ request.GET.q1 }}">previous</a> 
```

和，

```
<a class="navlink" href="?page={{ notecard_list.next_page_number }}&q1={{ request.GET.q1 }}">next</a> 
```

# java - Swing JPopupMenu：灰色区域重叠

> ID：10401992
> 
> 赞同：1
> 
> 时间：2012-05-01T17:57:56.247
> 
> 标签：java, swing, jpopupmenu

客户说他们的 UI 有问题。有时当他们打开弹出菜单并在它消失后灰色区域并没有消失。我们使用弹出位置 ( `JPopupMenu`) 处显示的 Swing 和灰色矩形。

![灰色地带](../Images/5083454c977a30550754ba2c66736c57.png)

我无法重现该问题。我在哪里可以读到呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T19:55:59.837

*   不可能直接将 AWT PopupMenu 与任何 Swing JComponent 混合，反之亦然，原因错过了`AWT PopupMenu`与 Swing 混合的方法，反之亦然（aaaach 为什么其他 AWT 和 Swing J/Component 的实现也不相同）

*   out of EDT 与您在此处发布的图像无关，因为 Popup 和 JPopup 都在 API 中正确实现了 MOUSE_RIGHT_CLICK 的相关方法，只有 AWT PopupMenu 将仅显示在第一个监视器上，即使容器可以放置在第二个或第三台显示器，AFAIK 仅适用于 Swing JPopupMenu

如果 EDT 中没有任何事件，例如 30 秒后 EDT 返回 false，则 J/Popup 在 Java6_019 或 22 的所有情况下都有效

```
import java.awt.EventQueue;
import java.awt.Frame;
import java.awt.Label;
import java.awt.MenuItem;
import java.awt.PopupMenu;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.concurrent.*;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.*;

public class IsThereEDT {

    private ScheduledExecutorService scheduler;
    private AccurateScheduledRunnable periodic;
    private ScheduledFuture<?> periodicMonitor;
    private int taskPeriod = 30;
    private SimpleDateFormat sdf = new SimpleDateFormat("HH:mm:ss");
    private Date dateRun;
    private JFrame frame1 = new JFrame("Frame 1");
    private Frame frame2 = new Frame("Frame 2");
    private PopupMenu popup1 = new PopupMenu();

    public IsThereEDT() {
        scheduler = Executors.newSingleThreadScheduledExecutor();
        periodic = new AccurateScheduledRunnable() {

            private final int ALLOWED_TARDINESS = 200;
            private int countRun = 0;
            private int countCalled = 0;
            private int maxCalled = 10;

            @Override
            public void run() {
                countCalled++;
                if (countCalled < maxCalled) {
                    if (countCalled % 3 == 0) {
                        /*if (EventQueue.isDispatchThread()) {
                        SwingUtilities.invokeLater(new Runnable() {

                        @Override
                        public void run() {
                        //some stuff
                        }
                        });
                        } else {
                        try {
                        SwingUtilities.invokeAndWait(new Runnable() {

                        @Override
                        public void run() {
                        //some stuff
                        }
                        });
                        } catch (InterruptedException ex) {
                        Logger.getLogger(IsThereEDT.class.getName()).log(Level.SEVERE, null, ex);
                        } catch (InvocationTargetException ex) {
                        Logger.getLogger(IsThereEDT.class.getName()).log(Level.SEVERE, null, ex);
                        }
                        }*/
                        /*SwingUtilities.invokeLater(new Runnable() {

                        @Override
                        public void run() {
                        System.out.println("Push a new event to EDT");
                        frame1.repaint();
                        isThereReallyEDT();
                        }
                        });*/
                    } else {
                        if (this.getExecutionTime() < ALLOWED_TARDINESS) {
                            countRun++;
                            isThereReallyEDT(); // non on EDT
                        }
                    }
                } else {
                    System.out.println("Terminating this madness");
                    System.exit(0);
                }
            }
        };
        periodicMonitor = scheduler.scheduleAtFixedRate(periodic, 0, taskPeriod, TimeUnit.SECONDS);
        periodic.setThreadMonitor(periodicMonitor);
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                isThereReallyEDT();
                Label label1 = new Label("Hello in frame 1");

                for (int i = 1; i <= 5; i++) {
                    MenuItem menuItem = new MenuItem("item" + i);
                    popup1.add(menuItem);
                }
                label1.add(popup1);
                frame1.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame1.add(label1);
                frame1.pack();
                frame1.setLocation(100, 100);
                frame1.setVisible(true);
            }
        });
        try {
            Thread.sleep(1500);
        } catch (InterruptedException ex) {
            Logger.getLogger(IsThereEDT.class.getName()).log(Level.SEVERE, null, ex);
        }
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                //frame2.setDefaultCloseOperation(Frame.EXIT_ON_CLOSE);
                JLabel label2 = new JLabel("Hello in frame 2");
                frame2.add(label2);
                frame2.pack();
                frame2.setLocation(200, 200);
                frame2.setVisible(true);
                isThereReallyEDT();
            }
        });
    }

    private void isThereReallyEDT() {
        dateRun = new java.util.Date();
        System.out.println("                         Time at : " + sdf.format(dateRun));
        if (EventQueue.isDispatchThread()) {
            System.out.println("EventQueue.isDispatchThread");
        } else {
            System.out.println("There isn't Live EventQueue.isDispatchThread, why any reason for that ");
        }
        if (SwingUtilities.isEventDispatchThread()) {
            System.out.println("SwingUtilities.isEventDispatchThread");
        } else {
            System.out.println("There isn't Live SwingUtilities.isEventDispatchThread, why any reason for that ");
        }
        System.out.println();
    }

    public static void main(String[] args) {
        IsThereEDT isdt = new IsThereEDT();
    }
}

abstract class AccurateScheduledRunnable implements Runnable {

    private ScheduledFuture<?> thisThreadsMonitor;

    public void setThreadMonitor(ScheduledFuture<?> monitor) {
        this.thisThreadsMonitor = monitor;
    }

    protected long getExecutionTime() {
        long delay = -1 * thisThreadsMonitor.getDelay(TimeUnit.MILLISECONDS);
        return delay;
    }
} 
```

*   在调用 Swing JComponent 并且在 EDT 之外可见的情况下，返回从 Native OS 返回的最小边界，但是您的 JPopuMenu 容器返回更大的区域，那么有

a) 您的代码没有添加 JMenuItem(s)

b) 您的代码没有添加 JComponent(s)

c) 可能添加了自定义组件，然后没人知道

# iphone - iOS 远程 xml 正在解析残留内容

> ID：10401993
> 
> 赞同：0
> 
> 时间：2012-05-01T17:57:56.510
> 
> 标签：iphone, objective-c, ios, xcode, cocoa-touch

我正在使用 NSURLRequest 成功解析 xml，当 connectionDidFinishLoading 时，xmlParser 完成了这项工作。问题是，如果我修改远程 xml 文件并再次触发连接，接收到的数据是旧的，直到我将再次触发它随机数次，直到最终被更新！它发生在设备和模拟器上，但有趣的问题是，在模拟器上，当没有连接时，有时会像之前描述的那样运行，带有残留内容和控制台调试消息，就好像连接存在一样......如果代码可以帮助请告知。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T18:40:49.097

这是因为您在`NSURLConnection`. 检查[`NSURLConnections`](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/URLLoadingSystem/Tasks/UsingNSURLConnection.html)文档或将其添加到您的`NSURLRequest`创作中。

```
NSURLRequest* request = [NSURLRequest requestWithURL:[NSURL URLWithString:url]
                            cachePolicy:NSURLRequestReloadIgnoringLocalAndRemoteCacheData
                            timeoutInterval:30]; 
```

`NSURLRequestReloadIgnoringLocalAndRemoteCacheData`可能是您问题的关键。

# objective-c - 如何翻译默认的 CoreData 值

> ID：10401994
> 
> 赞同：1
> 
> 时间：2012-05-01T17:57:58.727
> 
> 标签：objective-c, xcode, core-data, nslocalizedstring

我设置了属性的默认值。该属性是字符串类型。因此，当您创建一个新对象并且内容将自动填充时，会出现文本：组名。我可以将那个“组名”翻译成不同的语言​​​​。我能怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T19:39:21.647

不要在图形数据模型中为字符串设置默认值，而是创建 NSManagedObject 的子类，然后在子类的实现文件中使用`-(void)awakeFromInsert;`.

```
- (void)awakeFromInsert
{
    [super awakeFromInsert];
    self.groupName = NSLocalizedString(@"Group Name", @"");
} 
```

每次将该实体的新实例插入托管对象上下文时，都会调用此方法。然后在您的本地化字符串文件中，您将能够将该字符串翻译成您想要的任何语言。

# javascript - 您可以通过 JavaScript 将特定于媒体查询的样式应用于 HTML 元素吗？

> ID：10401995
> 
> 赞同：1
> 
> 时间：2012-05-01T17:58:01.270
> 
> 标签：javascript, html, css, media-queries

传统上，您可以使用 JavaScript 将样式应用于元素：

```
document.body.style.color = "red"; 
```

但是你能以类似的方式应用特定于媒体查询的样式吗？我在说的是这样的：

```
body {
  color: red;
}

@media only screen and (max-width : 320px) {
  body {
    color: blue;
  }
} 
```

上面的@media-specific 样式。这可以通过 JavaScript 以编程方式应用于元素吗？例如，我想将上述样式应用于`body`元素，但不指定任何 CSS。我想用 JavaScript 来做这一切。这可能吗（以跨浏览器的方式）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T18:05:23.433

在加载和调整大小时检查窗口的宽度。基本思路：

```
function resized() {
  var myWidth = 0, 
      myHeight = 0,
      color = "red";
  if( typeof( window.innerWidth ) == 'number' ) {
    myWidth = window.innerWidth;
    myHeight = window.innerHeight;
  } else if( document.documentElement && ( document.documentElement.clientWidth || document.documentElement.clientHeight ) ) {
    myWidth = document.documentElement.clientWidth;
    myHeight = document.documentElement.clientHeight;
  } else if( document.body && ( document.body.clientWidth || document.body.clientHeight ) ) {
    myWidth = document.body.clientWidth;
    myHeight = document.body.clientHeight;
  }

  if (myWidth <= 320) {
      color = "blue";
  }
  document.body.style.color = color;
}
window.onresize = resized;
resized(); 
```

# jquery - 单击新选项卡时关闭嵌套的 Jquery 手风琴菜单

> ID：10401998
> 
> 赞同：0
> 
> 时间：2012-05-01T17:58:11.110
> 
> 标签：jquery, css, accordion

我正在为移动设备上的导航制作一个简单的手风琴。HTML 的结构如下：

```
 <nav>
    <ul id="topMenu">
    <li>
        <ul>
            <li><h3><a href="#">Work</a></h3></li>
            <li><a href="/work/">Brand ID</a></li>
            <li><a href="/work/">Print</a></li>
            <li><a href="/work/">Book & Editorial</a></li>
            <li><a href="/work/">Web</a></li>
            <li><a href="/work/">Packaging</a></li>
            <li><a href="/work/">Exhibit</a></li>
        </ul>
    </li>
    <li>
        <ul>
            <li><h3><a href="#">About</a></h3></li>
            <li><a href="/about/">Our Story</a></li>
            <li><a href="/about/">Methodology</a></li>
            <li><a href="/about/">Team</a></li>
            <li><a href="/about/">Studio</a></li>
            <li><a href="/about/">Services</a></li>
            <li><a href="/about/">Partners</a></li>
        </ul>
    </li>
</ul>
</nav> 
```

当屏幕尺寸达到移动设备时，我有一套全新的 css（使用媒体查询）来实现这样的屏幕：

![手风琴菜单](../Images/cee2f00df3eb3d621c1440cf39a21301.png)

第一个孩子显示，其余的被隐藏。我正在使用 jquery 创建手风琴风格的显示，如下所示：

```
$("nav #topMenu li ul").toggle(function(){
    $(this).children("li").stop().slideDown();
}, function(){
    $(this).children("li:nth-child(1n+2)").stop().slideUp();
}); 
```

这很好用；但是，我正在寻找一种行为，即当一个面板打开时，其余面板关闭。因此，在任何给定时间，手风琴上只会打开一个面板。这是手风琴的常见行为。

当用户单击任何父级列表项时，您可以帮助 jquery 向下滑动所有打开的面板吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T12:07:55.513

这是一个快速的解决方法[http://jsfiddle.net/sethunath/wayfP/](http://jsfiddle.net/sethunath/wayfP/) 这里我触发下一个 ul 的点击，如果它是可见的