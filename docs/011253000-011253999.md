# StackOverflow 问答 11253000-11253999

# iphone - iPhone网络节点库

> ID：11253001
> 
> 赞同：0
> 
> 时间：2012-06-28T21:14:42.947
> 
> 标签：iphone, objective-c, networking, nodes

我正在尝试为 iPhone 应用程序找到一个库，该库可以表示具有任意数量的节点和节点之间的距离的网络。然后我需要计算节点之间的最短路径。有谁知道这是否适用于可在 iPhone 应用程序中使用的 Objective-C 或 C++？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T21:19:35.580

如果它是一个足够简单的网络，你可以做一个普通的 BFS（广度优先搜索）或 DFS（深度优先搜索）并计算所有可能的路径。然后只选择最快的。请记住，对于图表，您必须存储您已经访问过的节点列表，否则您将永远陷入困境。

# javascript - 即使应用了 tabindex，onclick 也不会使用键盘执行

> ID：11253002
> 
> 赞同：0
> 
> 时间：2012-06-28T21:14:43.600
> 
> 标签：javascript

这是我的问题。我正在尝试使以下代码键盘可以访问。当我将 tabindex=0 插入

```
 if (role.can("deleteFilters"))
    {
      w.print("<span role=\"toolbar\" aria-label=\"Remove Filter\" class=\"employeeName\" title=\"Remove filter\" style=\"text-align: right;\" onclick=\"javascript:removeFilter('"+filterID+"');\">");
      w.print("<img src=\"icon-link-delete-dark.gif\" alt=\"delete icon\" width=\"13\" height=\"13\"/></span>&nbsp;");
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T18:20:58.820

通过用锚标签替换跨度标签来解决。

# wix - WiX MSI 在移除 CRT MSM 之前和之后的行为不同

> ID：11253011
> 
> 赞同：0
> 
> 时间：2012-06-28T21:15:15.753
> 
> 标签：wix, windows-installer, merge-module

我有一个用 WiX 构建的 MSI。它执行以下自定义操作：

```
 <CustomAction Id='StartTray'
                   Directory='INSTALLDIR'
                   ExeCommand='[INSTALLDIR]\myapptray.exe'
                   Return='asyncNoWait'
                   Impersonate='no'
                   Execute='deferred' /> 
```

它是这样安排的：

```
 <Custom Action='StartTray' After='StartServices'>NOT Installed OR (TRAYWASRUNNING AND NOT REMOVE~="ALL")</Custom> 
```

`myapptray.exe`作为当前在桌面上活动的用户，碰巧使用模拟从其本地系统的起始上下文（从 MSI 上下文运行）重新启动自身。这不在我的控制范围内，并且 Impersonate='yes' 不起作用，因为可能会调用 MSI 以从系统服务的上下文进行升级，这意味着 Impersonate='yes' 最终仍将应用程序作为本地系统运行。

我最近从将 VC9 CRT 作为 MSM 包含在此 MSI 中，将其包含在引导程序 exe 中。

这样做会阻止`myapptray.exe`自定义操作成功运行。模拟失败，`WTSQueryUserToken`其中返回`ERROR_PRIVILEGE_NOT_HELD`。这似乎意味着删除 MSM 实际上改变了运行 MSI 的用户上下文，但这似乎很荒谬。我从 wxs 文件中删除的唯一行是 MSM 的`<Merge>`and`<MergeRef>`标记，没有其他任何更改。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T20:38:50.947

我会更多地查看您的 EXE 是针对哪些版本的 CRT 构建的，以及是否有任何策略规则说明它可以运行的内容。在您的 MSI 之前从 MSM 转移到 EXE 运行通常应该是一件好事。

顺便说一句，我曾经做过类似这样的黑客行为。我们不得不使用 MSI 在 SYSTEM 上下文中推出一个 MSI。如果用户已登录，我们必须使用用户桌面登录会话重新启动应用程序。我安装了一个配置为模拟交互式用户来完成此操作的 DCOM 服务器。真的很奇怪，但有一个正当的理由。

不过，这一切都发生在重新启动管理器之前。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T18:48:28.773

我想到了。

CRT MSM 设置 ALLUSERS=1 并且安装程序的行为发生了变化，因为它在我们的基本安装程序中不存在。因此，MSM 的 ALLUSERS 设置被继承到基本安装程序中。

在我们的 wxs 文件中设置 ALLUSERS=1 解决了这个问题！

# c++ - R6205 使用 ATL 服务模板的纯函数调用错误

> ID：11253012
> 
> 赞同：0
> 
> 时间：2012-06-28T21:15:17.140
> 
> 标签：c++, atl, virtual-functions

我有一个非常简单的 ATL 服务，它实现了`CAtlServiceModuleT`. 它在服务的实现中没有使用任何虚函数，但显然 ATL 模板对象确实使用了虚函数。

我查看了它的实现，`CAtlServiceModuleT`它似乎没有定义任何纯虚函数，但是模板本身是使用我不太理解的 declspec(novtable) 声明的。

我了解导致纯虚拟调用错误的基本用例，但这似乎不属于任何这些类别，例如：

[“纯虚函数调用”崩溃从何而来？](https://stackoverflow.com/questions/99552/where-do-pure-virtual-function-call-crashes-come-from/100555#100555)

我编写了一个 purecall 实现来尝试获得更好的堆栈跟踪，但我无法在内部重现它。

这个错误还能从哪里来？

# objective-c - 注册通知的托管对象

> ID：11253018
> 
> 赞同：0
> 
> 时间：2012-06-28T21:15:42.010
> 
> 标签：objective-c, core-data, nsmanagedobject, nsnotifications

托管对象将自己添加为通知的观察者是一种不好的形式吗？我有一个托管对象，它具有几个瞬态属性，并从 CoreData 文档中描述的不同存储中获取其数据。如果存储发生变化，托管对象需要侦听此通知并采取相应措施。我担心注册通知之类的托管对象可能会对性能产生一些影响，因为它们可能有很多，而 CoreData 管理它们的生命周期。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T10:08:15.710

少儿科，

根据我的经验，如果您将 a 设置`NSManagedObject`为观察者，则可能会出现一些潜在的性能问题。它可能会成为瓶颈，但这取决于您拥有的对象数量以及您注册的通知类型。能不能多说点什么？

说到这里，我建议你阅读**Marcus Zarra**的[parent-watching-its-child](http://www.cimgf.com/2011/10/14/parent-watching-its-child/)。这篇文章可以引导你走上正轨。

 **希望有帮助。**

# concurrency - 同时重启多个锁定线程

> ID：11253019
> 
> 赞同：1
> 
> 时间：2012-06-28T21:15:47.067
> 
> 标签：concurrency, pthreads, mutex

我目前有 N 个线程都是打开的 udp/tcp 连接。当我从任何线程中接收到第一个数据包时，主线程（称为 N 线程）需要暂停 N 线程中的执行并在恢复 N 线程之前做一些工作。

我最初的想法是让所有 N 个线程使用一个公共互斥锁，该互斥锁等待来自主线程的 pthread_cond_broadcast。据我了解，所有 N 个线程将在调用广播时按照调度程序确定的某种顺序恢复执行，因为它们都依赖于同一个互斥锁。但是，我需要它们并行恢复。

这基本上就是我的问题的样子：

主线程：

```
//create N threads. Each thread is connected to a different 
//location but uses the same code

//detect that one of the threads has received a packet
//tell all child threads to pause
pauseThreads();

//do some work on the first packet

resumeThreads();

//tell all child threads to resume 
```

子线程代码：

```
while(true){
  recv() data

  //the other N-1 threads should ideally block here, 
  //since I'd like to process just the 
  //very first packet

  //hopefully pauseThreads() has been called by the main
  //thread by here if the first packet has been received.
  //All threads should block here until the main thread 
  //is done processing the first packet. Once it's done
  //processing, *firstPacket will be false and the if statement 
  //can be skipped over

  //only one thread should ever access this
  if(*firstPacket  /*this is a global variable*/  ){
      //process first packet
      *firstPacket = false;
      //the thread that receives the first packet should block here
  }

  //process same packet data in another format
} 
```

线程需要同时重新启动的原因是速度是一个问题，我不能等待每个线程一个一个地完成自己的数据处理。我已经确定了 if 语句中的阻塞，但我想不出一种有效阻塞 N-1 个线程的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T08:28:14.130

# 最好的

让服务器为 udp 数据包添加时间戳或序列号。

# 或者

在接收器中，我假设您只有一个网络适配器，并且服务器和您之间只有一个路由。否则数据包可能会重新排序。

所以现在我们需要在进一步处理之前对数据包进行时间/序列标记。为此使用单个线程，然后将任务的其余部分外包给工作线程。

# c - pthread_create 不工作。通过参数 3 警告

> ID：11253025
> 
> 赞同：7
> 
> 时间：2012-06-28T21:15:59.653
> 
> 标签：c, linux, ubuntu, pthreads

我正在尝试创建一个线程，据我所知，这应该是正确的方法：

```
#include <pthread.h>
#include <stdio.h>
#include <stdlib.h>
#define NUM_THREADS 5

int SharedVariable =0;
void SimpleThread(int which)
{
    int num,val;
    for(num=0; num<20; num++){
        if(random() > RAND_MAX / 2)
            usleep(10);
        val = SharedVariable;
        printf("*** thread %d sees value %d\n", which, val);
        SharedVariable = val+1;
    }
    val=SharedVariable;
    printf("Thread %d sees final value %d\n", which, val);
}

int main (int argc, char *argv[])
{
   pthread_t threads[NUM_THREADS];
   int rc;
   long t;
   for(t=0; t< NUM_THREADS; t++){
      printf("In main: creating thread %ld\n", t);
      rc = pthread_create(&threads[t], NULL, SimpleThread, (void* )t);
      if (rc){
         printf("ERROR; return code from pthread_create() is %d\n", rc);
         exit(-1);
      }
   }

   /* Last thing that main() should do */
   pthread_exit(NULL);
} 
```

我得到的错误是这个：

> test.c：在函数'main'中：test.c:28：警告：从不兼容的指针类型/usr/include/pthread.h:227传递'pthread_create'的参数3：注意：预期'void *（* *）（ void ** )' 但参数类型为 'void (*)(int)'</p>

我无法更改 SimpleThread 函数，因此即使我已经尝试过也无法更改参数的类型，但它也不起作用。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-28T21:18:53.297

`SimpleThread`应声明为

```
void* SimpleThread(void *args) {
} 
```

当您将参数传递给线程时，最好`struct`为它们定义 a ，将指向该参数的指针传递`struct`为`void*`，然后在函数内转换回正确的类型。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-28T21:18:50.757

这是您程序的编译和“工作”版本，尽管我不得不承认不知道它在做什么。对于观众中的批评者，我提前为最后的`pthread_join`循环道歉。

```
#include <stdio.h>
#include <stdlib.h>
#include <pthread.h>

#define NUM_THREADS 5

struct my_thread_info {
    long which;
};

int SharedVariable = 0;

void *SimpleThread(void *data)
{
    int num, val;
    struct my_thread_info *info = data;

    for (num = 0; num < 20; num++) {
        if (random() > RAND_MAX / 2)
            usleep(10);
        val = SharedVariable;
        printf("*** thread %ld sees value %d\n", info->which, val);
        SharedVariable = val + 1;
    }

    val = SharedVariable;
    printf("Thread %ld sees final value %d\n", info->which, val);

    free(info);
    return NULL;
}

int main(int argc, char *argv[])
{
    pthread_t threads[NUM_THREADS];
    int rc;
    long t;
    struct my_thread_info *info;
    for (t = 0; t < NUM_THREADS; t++) {
        printf("In main: creating thread %ld\n", t);

        info = malloc(sizeof(struct my_thread_info));
        info->which = t;

        rc = pthread_create(&threads[t], NULL, SimpleThread, info);
        if (rc) {
            printf("ERROR; return code from pthread_create() is %d\n", rc);
            exit(-1);
        }
    }

    for (t = 0; t < NUM_THREADS; t++) {
        pthread_join(threads[t], NULL);
    }
} 
```

# algorithm - 查找矩阵中连接集总数的算法

> ID：11253027
> 
> 赞同：10
> 
> 时间：2012-06-28T21:16:02.223
> 
> 标签：algorithm, graph, graph-theory

我想知道我应该在这里应用哪种算法。[DFS](http://en.wikipedia.org/wiki/Depth-first_search)会做吗？

给定一个二维矩阵。找到该矩阵中连接集的总数。

连通集可以定义为一组小区，上面提到了 1 个小区，并且在该集中至少有一个其他小区与它们共享邻居关系。一个包含 1 的单元格并且没有包含 1 的周围邻居可以被认为是一个包含一个单元格的集合。邻居可以定义为在 8 个可能方向（即 N、W、E、S、NE、NW、SE、SW 方向）上与给定小区相邻的所有小区。一个细胞不是它自己的邻居。

例如：

```
1 0 0 1

0 0 1 0

0 0 1 0

1 0 0 1 
```

连接组数为 3

```
0 0 1 0 0 1 0 0

1 0 0 0 0 0 0 1

0 0 1 0 0 1 0 1

0 1 0 0 0 1 0 0

1 0 0 0 0 0 0 0

0 0 1 1 0 1 1 0

1 0 1 1 0 1 1 0

0 0 0 0 0 0 0 0 
```

连接集数为 9。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-28T21:49:46.780

我认为您不需要将其视为一般图形问题并应用任何算法，例如[BFS](http://en.wikipedia.org/wiki/Breadth-first_search)或[DFS](http://en.wikipedia.org/wiki/Depth-first_search)。

您将需要对矩阵进行三次扫描。

**扫描1：**

从头开始

1.  用 1..n 给每个数字每个 1，在您的示例中，该步骤之后的第一行看起来像

    > 1 0 0 2

2.  转到下一行，每行中的每个 1 检查您左边的邻居是否为非 0
    *   如果非 0 取左边的值
    *   if 0 检查上一行中的非 0 邻居并取最左边的值
    *   如果所有这些都是 0，则只需将 1 添加到迄今为止给出的最大数量
3.  重复 2 直到处理完最后一行

你的例子应该如下所示

```
1 0 0 2
0 0 2 0
0 0 2 0
3 0 0 2 
```

**扫描2：**

从底部开始检查每个邻居是否与最左边的邻居具有相同的编号以及与其下方行中的邻居相同的编号

基本上如果你有这样的矩阵

> 1 0 2
> 
> 1 0 2
> 
> 0 1 0

检查确保一个集合具有相同的数字

**扫描3：**

计算矩阵中唯一非 0 条目的数量

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-29T11:35:58.873

[连接组件标记](http://en.wikipedia.org/wiki/Connected-component_labeling)算法旨在标记连接的元素组（用于 4 连接和 8 连接）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-10-19T11:52:29.987

Pythonic 实现，更易理解的代码：

```
# sea is 2 D array of 0 and 1s we have to find 1's group surrounded by 0's
def dfs(sea, i, j, b, h, visited):
    surround = ((-1, -1), (0, -1), (1, -1),
                (-1, 0), (1, 0),
                (-1, 1), (0, 1), (1, 1)
                )
    if can_visit(sea, i, j, b, h, visited):
        for s in surround:
            visited[(i, j)] = 1
            dfs(sea, i + s[0], j + s[1], b, h, visited)

def can_visit(sea, i, j, b, h, visited):
    if i >= 0 and j >= 0 and i < b and j < h:
        if (i, j) not in visited and sea[i][j] == 1:
            return True

def find_island(sea):
    visited = {}
    h = len(sea)
    count = 0
    for i, row in enumerate(sea):
        b = len(row)
        for j, item in enumerate(row):
            if can_visit(sea, i, j, b, h, visited):
                count += 1
                dfs(sea, i, j, b, h, visited)
    return count

sea = [[1, 1, 0, 0, 0],
       [0, 1, 0, 0, 1],
       [1, 0, 0, 1, 1],
       [0, 0, 0, 0, 0],
       [1, 0, 1, 0, 1]
       ]

print find_island(sea) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-10T05:29:32.310

有 3 个连接的集合。彼此相邻的所有 1 都被视为一个集合。所有 1 在`a[1,4]`,`a[2,3]`和形成一组，一个在`a[3,3]`形成一组，一个在形成一组。`a[4,4]``a[1,1]``a[4,1]`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-28T21:40:23.467

您想使用[不相交的集合](http://en.wikipedia.org/wiki/Disjoint-set_data_structure)数据结构和算法。这将为每个连接的组件选择一个唯一的代表，您可以在最后计算。

为了有效地评估哪些元素是邻居，您可以逐行扫描矩阵，维护`1`前一行的（连续的）段列表，同时确定当前行上的哪些段与它们相邻。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-28T22:27:50.850

这并不像看起来那么难。事实上，这感觉非常像教授在第一年计算机科学中分配的任务。所以如果这是家庭作业，你应该这样标记它。

但是，解决方案相当简单。

```
for (int y = 0; y < arr.height(); y++)
{
   for (int x = 0; x < arr.width(); x++)
   {
      if (arr[x][y] == 1)
      {
         if (CheckIfConnected(x, y, arr))
         {
            connectedPositionsX.Add(x);
            connectedPositionsY.Add(y);
         }
      }
   }
} 
```

connectedPositions 将是一个链表或任何你想用来存储集合的地方。

`arr`是一个二维数组，其中包含您在上面指定的类型的矩阵。

CheckIfConnected 也可以相当简单地实现。

```
bool CheckIfConnected(int x, int y, int[][]arr)
    {
       if (arr.width() >= 2) || (arr.height() >= 2)
       {
          if ((x < arr.width()) && (x >= 0) && (y < arr.height()) && (y >= 0))
          {
            if ((x-1) >= 0) //West
            {
                if (arr[x-1][y] == 1)
                {
                    adjCount[x-1][y] += 1;
                    return true;
                }
            }
            if (((x-1) >= 0) && ((y-1) >= 0)) //Northwest
            {
                if (arr[x-1][y-1] == 1)
                {
                    adjCount[x-1][y-1] += 1;
                    return true;
                }
            }
            if ((y-1) >= 0) //North
            {
                if (arr[x][y-1] == 1)
                {
                    adjCount[x][y-1] += 1;
                    return true;
                }
            }
            if (((x+1) < arr.width()) && ((y-1) >= 0)) //Northeast
            {
                if (arr[x+1][y-1] == 1)
                {
                    adjCount[x+1][y-1] += 1;
                    return true;
                }
            }
            if ((x+1) < arr.width()) //East
            {
                if (arr[x+1][y] == 1)
                {
                    adjCount[x+1][y] += 1;
                    return true;
                }
            }

            //I'll let you implement Southeast to Southwest on your own,
            //the pattern is clear now.
          }
       }
       return false;
    } 
```

从那里，您知道您在网格中的每个位置上找到了多少次配对。这可以帮助您跟踪您的连接。

二维数组中的计数`adjCount`会为您记录这一点。

您还可以通过并修改 Dijkstra 算法以递归方式为您执行此操作。既然您提到了 DFS（深度优先搜索），我假设您的教授或老师希望您以这种方式解决它。

在这种情况下：

这是伪代码中的 Dijkstra 算法： [http](http://en.wikipedia.org/wiki/Dijkstra) ://en.wikipedia.org/wiki/Dijkstra 's_algorithm

希望有帮助！干杯!

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-28T21:28:33.010

扫描矩阵 1 秒。当你找到一个时，调用一个递归函数来标记它的连接组件，如果它还没有被识别为在一个中。使用递归来查找连接的组件。在某处快速查找，告诉您给定节点是否已被识别为连接组件，以避免识别连接组件 2x，并避免在遍历连接组件时出现无限循环。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-02-27T13:19:14.977

对于值为 1 的每个节点，只需在东、东南、南和西南方向一次递归搜索。如果访问函数的调用是新调用而不是来自递归，则增加连接的组件。

```
import java.util.Scanner;

public class Solution {

    public static void visit(int[][] ar, boolean[][] v,int i, int j){
        int size = ar.length;
        if(ar[i][j] == 1){
            v[i][j] = true;
            if(j>0 && i<size-1){
                visit(ar,v,i+1,j-1); // SouthWest
            }
            if(i<size-1){
                visit(ar,v,i+1,j); // South
                if(j < size-1)
                    visit(ar,v,i+1,j+1); // SouthEast
            }
            if(j<size-1)
                visit(ar,v,i,j+1); // East
        }
    }

    public static void main(String[] args) {
        int[][] ar;
        int count = 0;
        Scanner sc = new Scanner(System.in);
        int n = sc.nextInt();
        ar = new int[n][n];
        boolean[][] v = new boolean[n][n];
        for(int i=0; i<n ; i++) {
            for(int j=0; j<n; j++){
                ar[i][j] = sc.nextInt();
                v[i][j] = false;
            }
        }

        for(int i=0; i<n ; i++) {
            for(int j=0; j<n; j++){                
                if(ar[i][j] == 1 && !v[i][j]){
                    count++;
                    visit(ar,v,i,j);
                }
            }
        }
        System.out.println(count);
    }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-06-28T22:21:24.863

如果你只想通过你的矩阵来做（没有额外的内存），请按以下方式进行：

将扫描仪位置设置为 [0,0]

1.  将计数器设置为零。
2.  从当前扫描仪位置逐行（和逐个单元格）扫描矩阵并找到一个`1`并将扫描仪位置设置为在此之后的下一个元素`1`，如果没有任何`1`转到步骤 6。
3.  将相关的一个设置为`counter+2`并递归地找到它的所有`1`邻居并将它们设置为`count + 2`。
4.  `count = count + 1`
5.  转到第 2 步。
6.  输出`count`。

PS：很清楚扫描仪位置是否大于您的算法将完成的矩阵大小（我没有写这个以防止混淆）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-08-06T20:10:51.637

我有一门课可以帮助你找到二维数组中连接组件的总数。我的课不仅给你总数，还给你集群并为你可视化它们。您可以注释掉不需要的部分。请在（java）中查看此类：[https ://github.com/m-vahidalizadeh/foundations/blob/master/src/algorithms/ConnectedComponetns.java](https://github.com/m-vahidalizadeh/foundations/blob/master/src/algorithms/ConnectedComponetns.java)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-10-19T12:58:10.040

如果你使用python，[scipy](https://docs.scipy.org/doc/scipy/reference/generated/scipy.ndimage.label.html)中有一个函数可以找到这个数字。

```
from scipy.ndimage import label

data = [[0, 0, 1, 0, 0, 1, 0, 0],
        [1, 0, 0, 0, 0, 0, 0, 1],
        [0, 0, 1, 0, 0, 1, 0, 1],
        [0, 1, 0, 0, 0, 1, 0, 0],
        [1, 0, 0, 0, 0, 0, 0, 0],
        [0, 0, 1, 1, 0, 1, 1, 0],
        [1, 0, 1, 1, 0, 1, 1, 0],
        [0, 0, 0, 0, 0, 0, 0, 0]]

connection_structure = [[1,1,1],
                        [1,0,1],
                        [1,1,1]]

_, N = label(data, connection_structure)

print(N) 
>>> 9 
```

# jquery - jquery类选择器问题

> ID：11253029
> 
> 赞同：0
> 
> 时间：2012-06-28T21:16:32.820
> 
> 标签：jquery, jquery-ui, jquery-plugins

我的桌子上有以下按钮

```
<td><Button  id="approval_<?php echo $i; ?>" type="submit"  class="myclass btn success trr" ><span>Approve</span> </button>
</td>
<td><Button  id="approval_<?php // echo $i; ?>" type="submit"  class="smyclass btn failed trr" ><span>Deny</span> </button>
</td> 
```

我需要做一个 onclick 动作

像这样的东西

```
$('.myclass').click(function() {} 
```

问题是我如何知道点击了哪个按钮？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T21:18:34.210

[您可以使用 jQuery 函数hasClass](http://api.jquery.com/hasClass/)检查按钮是否包含一个类。

```
$('.myclass').click(function() {
    if($(this).hasClass('success')){
        alert("Success!");
    }
}); 
```

关键字*this*将是您单击的按钮。您可以通过编写 $(this) 用 jQuery 包装它，这将允许您在其上使用大量方便的 jQuery 函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T21:19:52.610

在 click 函数中，您可以使用 $(this) 引用执行操作的元素。

所以：

```
$('.myclass').click(function() {
    $(this).doStuff();
}); 
```

快速说明 - 您将要缓存 $(this)。这样，您可以根据需要多次引用它，但只会执行一次 DOM 查找。

如：

```
$('.myclass').click(function() {
    var $this = $(this);
    $this.doStuff();
    $this.doMoreStuff();
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T21:21:43.147

```
$('.myclass').click(function() {
    // In here "this" refers to your element that was clicked.
    // You can do whatever you want with it from here.
    // If you want to use jQuery make sure to wrap it like $(this)
}); 
```

我建议看一下[jQuery 教程](http://docs.jquery.com/Tutorials)，它将解释很多关于 jQuery 是如何工作的，这将在未来为您节省大量时间

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-28T21:23:18.263

这样，您将能够获取索引并定义单击的是“成功”还是“失败”

```
$('.myclass').click(function() {
    // Get the index
    var index = $(this).attr('id').split('_')[1];

    // Check success or failed
    if ($(this).hasClass('success')) {
        // success
    } else {
        // failed
    }
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-28T21:28:13.303

我预见到这一点有问题：

`id="approval_<?php echo $i; ?>"`

它出现两次，每个按钮一次。出于这个原因，您不希望元素共享一个 id。将第二个按钮中的代码更改为：

`id="denial_<?php echo $i; ?>"`

然后在您的`click`事件处理程序中，您可以检查 id 的行为：

```
$('.myclass').click(function() {

    var action = this.id.split('_')[0];
    var identifier = this.id.split('_')[1];

    if (action == 'approval') {

        if (identifier == 'abc123') {

            alert('Why is the rum gone!?');

        } else if (identifier == 'def456') {

            alert('I have bath salts, wanna party?');

        }

    } else if (action == 'denial') {

        alert('Fact: Picture messaging is for lovers!');

    }

}); 
```

# elasticsearch - elasticsearch 处理错别字

> ID：11253032
> 
> 赞同：4
> 
> 时间：2012-06-28T21:16:43.633
> 
> 标签：elasticsearch

elasticsearch 是否可以处理**包含拼写错误的查询**。例子

```
trying to query "colthes" would return results of "clothes" 
```

如果有可能，该怎么做？（哪个**分析器**？哪个**标记**器？哪个**过滤器**？）

你能举个例子吗？是否可以为非英语语言应用配置（我正在寻找法语）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T21:32:04.923

是的，这当然是可能的。[在这个站点上](http://med-code.info/?utf8=%E2%9C%93&search=abbendice&catalog=icd&country=ch&locale=fr)可以看到一个法语的工作示例，它使用 Elasticsearch 作为后端。例如，通过搜索“abbendice”，查询返回“appendice”（英文附录）。具体来说，您正在寻找的是[模糊查询](http://www.elasticsearch.org/guide/reference/query-dsl/fuzzy-query.html)。

请注意，根据您尝试索引的数据大小，它可能不适合。希望有帮助。

# backbone.js - 骨干路由器、URL 和测试/生产 Web 上下文

> ID：11253034
> 
> 赞同：0
> 
> 时间：2012-06-28T21:17:04.163
> 
> 标签：backbone.js, backbone-routing

在我的 Backbone 应用程序中，我有一个显示帖子预览的主视图。当用户点击帖子时，帖子会在叠加层中展开，并且 URL 会更改以反映该帖子。当帖子展开时，用户可能会做一些事情来触发需要在根上下文中发生的对服务器的调用。问题是当帖子展开时，需要在根上下文发生的服务器调用发生在帖子上下文中。以下是操作顺序：

1.  页面加载了主视图 url：**http://localhost:8080/my-web-app/**
2.  用户点击post，显示overlay，url更新为：**http://localhost:8080/my-web-app/posts/1**
3.  用户单击触发对服务器的调用的内容。网址为：**http://localhost:8080/my-web-app/posts/1/load**，这是错误的。

在上面的示例中，加载操作需要从根上下文发生：**http://localhost:8080/my-web-app/load**

我尝试更改我的模型、集合等的 url 属性以包含前导 /，但这会删除“/my-web-app/”上下文（url 变为**http://localhost:8080/load**） ，这在我的测试环境中是必需的。当然，这在生产环境中可以正常工作。

为了解决这个问题，我将 Backbone.history 根选项设置为“/my-web-app/”，并将每个 url 属性覆盖如下：

```
url: function() {
  (Backbone.history.options.root != undefined ? Backbone.history.options.root : "") + "load";
} 
```

虽然这种方法有效，但是像这样覆盖每个 url 函数是一件很痛苦的事情……更不用说，它感觉很hacky。对于生产环境，它也是完全不必要的代码。有没有更优雅的方法来管理它，以便它在测试和生产环境中都可以工作？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T22:00:10.323

应用程序路由不应在开发环境和生产环境中有所不同。这总会在某个时候带来麻烦。

假设您在 localhost 上使用 Apache 服务器，您可以选择一个虚拟主机并`/my-web-app/`在`/`.

首先，在 /etc/hosts 文件中添加一个域名并将其指向 127.0.0.1，如下所示：

```
127.0.0.1   mywebapphost 
```

然后将虚拟主机添加到您的 Apache`vhosts.conf`

```
<VirtualHost *:80>
    DocumentRoot "/Users/someone/Sites/my-web-app/" # absolute directory of your webapp
    ServerName mywebapphost
</VirtualHost> 
```

你完成了！您的 webapp 在 //mywebapphost:8080 上可用，并且所有路由都与您的生产环境相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T21:30:23.433

我遇到了这个问题，经过一段时间的强调后，我意识到您可以使用 * 作为路由的前缀来消除 Web 上下文的问题：

```
*posts/1/load 
```

唯一的缺点是路由解析需要做更多的工作，但考虑到它是客户端，它应该可以忽略不计。

虽然您的路线在 dev、qa 生产之间可能不应该有所不同，但我认为可以公平地说许多 Web 应用程序被编写为与上下文无关，因此客户端的东西应该效仿恕我直言。

# css - 无法让 Drupal 自定义下拉菜单位置随屏幕移动

> ID：11253036
> 
> 赞同：0
> 
> 时间：2012-06-28T21:17:06.847
> 
> 标签：css, drupal-7

我正在使用 Drupal 7，并使用 css 制作了一个自定义下拉菜单。一切都显示正常，但屏幕移动时下拉菜单不会改变位置。

**以下是一些截图：**

![浏览器更小](../Images/b79690ce2a95249614d645d0a7297c85.png)

![浏览器扩展](../Images/c4510ce5f9867b01373b91d8797f8ec2.png)

**这是CSS：**

```
**/*---------VISITORS SUBMENU---------*/
#block-menu-menu-visitors .content ul.menu{
  position: relative;
  margin-left: 0 auto;
  margin-right: 0 auto;
}**
#block-menu-menu-visitors .content ul.menu li{
 padding: 2px 15px 2px 15px;
 list-style-type: none;
 display: inline-block;
 background-color: #ffff90;
}

#block-menu-menu-visitors .content ul.menu li:hover{
 padding: 2px 15px 2px 15px;
 display: inline-block;
 background-color: #ffffaa;
} 
```

关于如何使位置相对于屏幕尺寸相同的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T13:41:09.627

所以我发现了问题所在。在我的 php 中，我放置子菜单的 div 本身是浮动的。我的解决方案是将它包装在与主菜单相同的 div 中，并且效果很好。编写 css 或 html 从来没有问题，只是位置问题。考虑解决这个问题。

# java - 选择后如何处理图像？

> ID：11253041
> 
> 赞同：0
> 
> 时间：2012-06-28T21:17:20.260
> 
> 标签：java, android, file-io, filesystems

我正在从 IO 文件管理器（已安装）中检索图像。无论如何，当我尝试检索图像时，我不确定它去了哪里？或者如何将其保存为位图？

下面的代码：

```
public void onClick(View v)
{
    if(v.getId() == R.id.facebook_icon || v.getId() == R.id.facebook_text)
    {
        //Facebook
    }

    if(v.getId() == R.id.camera_icon || v.getId() == R.id.camera_text)
    {
        //Camera
    }

    if(v.getId() == R.id.folder_icon || v.getId() == R.id.folder_text)
    {
        Intent intent = new Intent();
        intent.setType("image/*");
        intent.setAction(Intent.ACTION_GET_CONTENT);
        startActivityForResult(Intent.createChooser(intent,"Select Picture"), MODE_WORLD_READABLE);
    }
}

protected void onActivityForResult()
{
    //Where is the image? How to get?
    System.out.println("Image gotton");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T21:28:55.140

首先，您没有覆盖 onActivityResult。注意方法签名： http: [//developer.android.com/reference/android/app/Activity.html#onActivityResult](http://developer.android.com/reference/android/app/Activity.html#onActivityResult(int) (int , int, android.content.Intent)

您应该使用@Override 注释，这样您就知道什么时候出了问题。

尝试类似：

```
public void onActivityResult(int requestCode, int resultCode, Intent data)
{
    super.onActivityResult(requestCode, resultCode, data);
    if (resultCode == RESULT_OK)
    {
        Uri imageUri = data.getData();
        Bitmap bitmap = MediaStore.Images.Media.getBitmap(this.getContentResolver(), imageUri);
    }
} 
```

# vb.net - 我可以覆盖接口属性吗？

> ID：11253044
> 
> 赞同：2
> 
> 时间：2012-06-28T21:17:32.600
> 
> 标签：vb.net, properties, interface, overriding, implementation

外壳示例如下。基本上，我希望客户和员工实现 IPerson 的 SSN 属性。但是，我希望客户有获取和设置（这不是问题），但我希望员工只有获取。

```
Public Interface IPerson
    Property SSN As String
End Interface

Public Class Client
    Implements IPerson
    Public Property SSN As String Implements AELName.IPerson.SSN
        Get
            Return _SSN
        End Get
        Set(value As String)
            _SSN = value
        End Set
    End Property
End Class

Public Class Employee
    Implements IPerson
    Public Readonly Property SSN As String Implements AELName.IPerson.SSN
        Get
            Return _SSN
        End Get
    End Property
End Class 
```

员工生成错误“'SSN' 无法实现 'SSN'，因为接口 'IPerson' 上没有匹配的属性”。是否有一种简单的方法可以覆盖 Employee 的 SSN 实现？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-28T21:19:34.793

您可以实现一个空的`Set`- 一个不更新任何内容的。

```
Public Class Employee
    Implements IPerson
    Public Readonly Property SSN As String Implements AELName.IPerson.SSN
        Get
            Return _SSN
        End Get
        Set
            ' Make read only for Employee
        End Set
    End Property
End Class 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-28T22:21:09.140

我建议将接口拆分为 IReadablePerson 和 IReadWritePerson，后者继承前者。请注意，前一个接口不是`IImmutablePerson`，因为后一个名称将暗示该类的消费者他们不应期望其任何属性会发生变化；实现的对象`IReadWritePerson`不会遵守这种期望，但会遵守人应该是可读的期望。

拆分接口的一个小烦恼是，有必要在其读/写属性的声明中`IReadWritePerson`包含修饰符`Shadows`，并且实现者`IReadWritePerson`必须提供只读实现`IReadablePerson`和读写实现`IReadWritePerson`. 在 C# 中，读写属性的公共实现可以自动为任何类似命名的只读、只写或读写属性生成实现，这些属性是该类实现的任何接口的一部分，但在显式声明哪个接口时正在实现，接口的样式（只读、只写、读写）必须与实现的样式精确匹配。恼人的。

由于不能简单地`IReadableFoo`用只读属性`IWriteOnlyFoo`和只写属性声明并`IReadWriteFoo`简单地继承两者，这一事实使烦恼变得更糟。如果接口实现了同名的只读属性和只写属性，则这两个属性都将不可用，因为编译器将在`somevariable = object.someProperty`or之类的语句中声明`someObject.someProperty = someVariable`，使用哪个实现是“不明确的”。并不是说我能看到任何歧义——我看不出第一个如何使用除了 getter 之外的任何东西，或者后者除了 setter 之外的任何东西，但编译器无法解决它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-11T04:12:36.793

要回答您的标题问题“我可以覆盖接口属性”......绝对。这是一个如何执行此操作的示例。您只需将**Overridable**关键字添加到您的基本具体实现。我知道这并不能解决将属性更改为 ReadOnly 的问题，但我想我会指出覆盖基类的具体接口实现是可能的。

```
Module Module1

    Sub Main()

        Dim iEntity As IEntity = New MyEntity

        iEntity.SetMessage(iEntity)

        Console.WriteLine(iEntity.Message)

        Console.ReadKey()

    End Sub

End Module

Public Interface IEntity

    Property Message As String

    Sub SetMessage(entity As IEntity)

End Interface

Public Class MyEntity
    Inherits BaseEntity

    Public Overrides Property Message As String
        Get
            Return String.Format("{0}.. and overroad.", MyBase.Message)
        End Get
        Set(value As String)
            MyBase.Message = value
        End Set
    End Property

    Public Overrides Sub SetMessage(entity As IEntity)

        Me.Message = "I was set from MyEntity."

    End Sub

End Class

Public Class BaseEntity
    Implements IEntity

    Public Overridable Property Message As String Implements IEntity.Message

    Public Overridable Sub SetMessage(entity As IEntity) Implements IEntity.SetMessage
        Me.Message = "I was set from BaseEntity."
    End Sub

End Class 
```

# google-docs-api - Google云端硬盘中基于关键字的搜索/查询？

> ID：11253049
> 
> 赞同：2
> 
> 时间：2012-06-28T21:17:58.453
> 
> 标签：google-docs-api, google-drive-api

Google Drive API 是否支持关键字搜索/查询（类似于 Google Docs API 提供的“DocumentQuery”功能）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T04:37:24.473

Yes, it does. See the discussion of this feature here:

[https://developers.google.com/drive/search-parameters](https://developers.google.com/drive/search-parameters)

# android - 从任何活动返回结果

> ID：11253052
> 
> 赞同：2
> 
> 时间：2012-06-28T21:18:00.293
> 
> 标签：android, android-intent

我有一个包含 4 个活动的应用程序，A、X、Y 和 Z。

A是一种登陆Activity，它为用户显示来自数据库的一堆信息。

X、Y 和 Z 是 A 为修改数据而启动的活动。这些活动实际上并不查询数据库，而是将更改的信息返回给 A，A 完成所有工作`onActivityResult`。流程始终是 A -> X 或 Y 或 Z -> A。这非常有效。

我想做的是让用户可以在 X、Y 和 Z 之间导航任意次数，直到单击保存按钮。这将修改流程，使 A -> X -> Y -> Z -> A 成为可能。但是，数据只需要从单击保存的 Activity 中持久化，在该示例中为 Z。然后 A 将从 Z 接收结果，处理此更改，然后继续。如果用户以这种方式导航，那么无论 X 和 Y 发生了什么，它们都已被丢弃。

我在这方面做了一些尝试。我最好的方法是在 X、Y 或 Z 启动另一个不是 A 的活动后立即调用`finish()`。这允许用户在单击保存时返回到 A，这意味着它的导航方面是正确的，但发送的结果代码始终是`RESULT_CANCELED`. 我已经研究过使用 Intent 标志`FLAG_FORWARD_RESULT`，但我没有使用它的经验，并且在与已经为结果启动的活动一起使用时会引发错误。我不确定这是否是要探索的正确技术，因为从我读过的内容来看，它仅在调用活动和返回结果的活动之间存在一个活动时才使用。

这样的流量甚至可能吗？基本上，我需要一个 Activity 来启动另一个以获得结果，允许用户从第二个 Activity 执行任意数量的导航，然后在完成导航后将结果返回给原始 Activity。可以只修改代码，使 X、Y 和 Z 自己访问数据库，但如果可以的话，我宁愿避免它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T21:35:33.130

> 但是，数据只需要从点击保存的Activity中持久化即可，

在我看来，最简单的事情就是不要使用`startActivityForResult(...)`in `Activity A`，而只是使用`startActivity(...)`后跟`finish()`to terminate `Activity A`。

然后，当任何其他`Activities`人点击他们的保存按钮时，让他们调用`startActivity(...)`并`Activity A`传递需要保存为`Intent`附加信息的数据。

`getIntent()`然后，您只需要使用`onCreate(...)`方法`Activity A`来获得有效的“结果”。如果`Intent`是`null`或不包含要持久化的预期数据，那么这是一个“首次启动”方案，但如果数据存在，您将知道`Activity A`是由于另一个 中的 Save 操作而启动的`Activities`。

# java - 多线程批处理以写入和读取数据库

> ID：11253053
> 
> 赞同：3
> 
> 时间：2012-06-28T21:18:01.573
> 
> 标签：java, multithreading, spring, spring-batch

我应该设计一个组件，它应该通过在 Java 中使用多线程来实现以下任务，因为文件很大/多个，并且任务必须在一个非常短的窗口中发生：

1.  读取多个 csv/xml 文件并将所有数据保存在数据库中
2.  根据 txn 类型读取数据库并将数据写入单独的文件 csv 和 xmls 中。（每个文件可能包含不同类型的记录生命文件头、批处理头、批处理页脚、文件页脚、不同的事务和校验和记录）

我对多线程非常陌生，并且对 Spring Batch 进行了一些研究，以便将其用于上述任务。

请让我知道您建议在 Java 或 Spring Batch 中使用传统多线程。这里输入源是多个，输出源也是多个。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-28T21:22:37.047

我建议使用框架中的一些东西，而不是自己编写整个线程部分。我已经非常成功地使用了[Sping 的任务和调度](http://static.springsource.org/spring/docs/3.0.5.RELEASE/reference/scheduling.html)计划任务，这些任务涉及从 DB 获取数据、进行一些处理、发送电子邮件、将数据写回数据库）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T05:24:47.487

Spring Batch 是实现您的要求的理想选择。首先，您可以使用内置的读取器和写入器来简化您的实现 - 对解析 CSV 文件、XML 文件、通过 JDBC 读取数据库等提供了很好的支持。您还可以获得诸如在失败时重试等功能的好处，跳过无效的输入，如果中间出现故障则重新启动整个作业 - 框架将跟踪状态并从中断处重新启动。自己实现这一切是非常复杂的，要做好这一切需要付出很大的努力。

一旦你用 spring batch 实现了你的批处理作业，它就会为你提供简单的并行化方法。一个步骤可以在多个线程中运行 - 它主要是配置更改。如果您有多个要执行的步骤，您也可以对其进行配置。如果需要，还支持在多台机器上分配处理。实现并行性的大部分工作都是由 Spring Batch 完成的。

我强烈建议您使用 Spring Batch 对几个最复杂的场景进行原型设计。如果可行，您可以继续使用 Spring Batch。自己实现它，尤其是当您不熟悉多线程时，肯定会导致灾难。

# python - 用于将 windows 路径更改为 unix 路径的 Python 脚本

> ID：11253054
> 
> 赞同：5
> 
> 时间：2012-06-28T21:18:29.277
> 
> 标签：python, linux, bash, escaping

我想要一个脚本，我可以在其中粘贴 Windows 路径作为参数，然后脚本将路径转换为 ​​unix 路径并使用 nautilus 打开路径。

我希望能够按如下方式使用脚本：

```
mypythonscript.py \\thewindowspath\subpath\ 
```

该脚本当前如下所示：

```
import sys, os

path = "nautilus smb:"+sys.argv[1]

path = path.replace("\\","/")

os.system(path) 
```

我几乎可以工作了:)问题是我必须在参数周围添加 ' ......就像这样：

```
mypythonscript.py '\\thewindowspath\subpath\' 
```

任何知道我如何编写允许该参数的脚本的人都没有 ' ，...即像这样：

```
mypythonscript.py \\thewindowspath\subpath\ 
```

编辑：我想我必须补充一点，问题是没有 ' 参数中的 \ 被视为转义字符。解决方案不一定必须是 python 脚本，但我希望（在 Linux 中）能够将 Windows 路径作为参数粘贴到脚本中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T21:22:25.057

除非您使用的是真正早期版本的 Windows：“/blah/whatever/”只适用于您的 OP。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T23:36:28.173

`xclip`实际上我前段时间有过这样的事情，我制作了一个 bash 脚本来自动下载我复制到剪贴板的链接，在这里它被编辑以使用你的程序（如果你还没有它，你首先需要安装它）：

```
#!/bin/bash

old=""
new=""

old="$(xclip -out -selection c)"

while true 
do

   new="$(xclip -out -selection c)"

   if [ "$new" != "$old" ]
   then
      old="$new"

      echo Found: $new
      mypythonscript.py $new

   fi
   sleep 1
done

exit 0 
```

现在，每当您将新内容复制到剪贴板时，您的 Python 脚本将使用剪贴板中任何内容的参数执行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T22:01:32.957

为避免处理 shell 中的转义，您可以直接使用剪贴板：

```
import os
try:
    from Tkinter import Tk
except ImportError:
    from tkinter import Tk # py3k

# get path from clipboard
path = Tk().selection_get(selection='CLIPBOARD')

# convert path and open it
cmd = 'nautilus'
os.execlp(cmd, cmd, 'smb:' + path.replace('\\', '/')) 
```

`ntpath`, `urlparse`,`os.path`模块可能有助于更稳健地处理路径。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-28T18:51:33.440

```
#!/usr/bin/python
#! python3
#! python2
# -*- coding: utf-8 -*-
"""win2ubu.py changes WINFILEPATH Printing UBUNTU_FILEPATH
Author: Joe Dorocak aka Joe Codeswell (JoeCodeswell.com)
Usage:   win2ubu.py WINFILEPATH
Example: win2ubu.py "C:\\1d\ProgressiveWebAppPjs\\Polymer2.0Pjs\\PolymerRedux\\zetc\\polymer-redux-polymer-2"
    prints /mnt/c/1d/ProgressiveWebAppPjs/Polymer2.0Pjs/PolymerRedux/zetc/polymer-redux-polymer-2
        N.B. spaceless path needs quotes in BASH on Windows   but NOT in Windows DOS prompt!
"""
import sys,os

def winPath2ubuPath(winpath):
    # d,p = os.path.splitdrive(winpath) # NG only works on windows!
    d,p = winpath.split(':')
    ubupath = '/mnt/'+d.lower()+p.replace('\\','/')   
    print (ubupath)
    return ubupath

NUM_ARGS = 1
def main():
    args = sys.argv[1:]
    if len(args) != NUM_ARGS or "-h" in args or "--help" in args:
        print (__doc__)
        sys.exit(2)
    winPath2ubuPath(args[0])

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-06-28T21:36:13.107

可能想试试

```
my_argv_path = " ".join(sys.argv[1:]) 
```

因为它将路径拆分为单独的参数的唯一原因是粘贴路径中的空格

（例如：`C:\Program Files` 最终会成为两个 args `["c:\Program","Files"]`）

# php - Magento 创建新产品模板

> ID：11253055
> 
> 赞同：0
> 
> 时间：2012-06-28T21:18:33.787
> 
> 标签：php, magento, product, mage

我真的很喜欢 magento 结构，但找到东西非常困难；）

我的问题是我有一个自定义属性。通过调用“创建新产品”，该字段应预先填充一个自动值，如实体 ID。这应该只发生在 create new 函数中。

我绝对无法找到相应的代码，其中设置了初始值，谁能给我一个提示？（必须运行脚本，而不是默认值 :)）

非常感谢和问候，马蒂亚斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T21:23:41.477

您可以在这篇文章中找到找到相应代码所需的信息： [Finding Correct Templates and Blocks in Magento](https://stackoverflow.com/questions/10963284/finding-correct-templates-and-blocks-in-magento)

只需将字段的默认属性更改为您需要的属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T10:59:20.737

我的问题的答案是覆盖 Mage_Adminhtml_Block_Catalog_Product_Edit_Tab_Attributes 块。

在此块中，您可以使用简单的 if 条件。以下行必须替换为 if：

```
$values[$attribute->getAttributeCode()] = $attribute->getDefaultValue(); 
```

新解决方案：

```
if($attribute->getAttributeCode() == 'my_attribute_code') {
    $values[$attribute->getAttributeCode()] = SET_THE_OWN_VALUE;
} else {
    $values[$attribute->getAttributeCode()] = $attribute->getDefaultValue();
} 
```

就这样 ：）

希望这对其他人也有帮助！！！

# javascript - 如何使用 JavaScript 修改网站的标题？

> ID：11253058
> 
> 赞同：1
> 
> 时间：2012-06-28T21:18:41.710
> 
> 标签：javascript, greasemonkey, document, title

查看 torrent 页面时，选项卡的标题为：

> Bitsoup.org 最适合您的 Torrent 胃口的网站 :: Torrent "ABC" 的详细信息

其中“ABC”是种子文件的名称。

不幸的是，当我打开 3 个以上的标签时，我看不到 torrent 文件的名称。

我正在尝试创建一个 Greasemonkey 脚本来截断或拆分标题，以便它只显示种子名称，而不是开始部分。

我知道您可以使用修改与页面关联的标题`document.title = ...`

但我不确定将其分配给什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-28T21:24:44.580

您可以使用正则表达式，也许：

```
document.title = document.title.match(/"([^"]+)"/)[1] 
```

此正则表达式使用分组来匹配引号之间的第一件事，并将其分配给`title`（不带引号）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-28T21:25:22.697

如果你知道标题的开头总是相同的，那么使用 substr 方法是迄今为止最简单的。例如，使用您给出的标题：

```
document.title = document.title.substr(76); 
```

如果它不是静态标题，那么 RegEx 将是下一个最合乎逻辑的路线。要匹配最后一组引号并忽略潜在的空格：

```
document.title = document.title.match(/"([^"]+)"\s*$/)[1]; 
```

# ruby - 红宝石快速排序错误

> ID：11253059
> 
> 赞同：0
> 
> 时间：2012-06-28T21:18:44.360
> 
> 标签：ruby

下面是我在 ruby​​ 中的快速排序实现（使用第一个元素作为枢轴）。但是有一个错误我不知道为什么

```
def quicksort(items)
   return items if items.nil? or items.length <= 1

   first=items[0]

   left,right=parti(items,0,items.length)

   quicksort(left) + [first] + quicksort(right)

end

def parti(s,l,r)
  p=s[l]
  i=l+1
  (l+1..r).each do |x|
      if s[x] < p
          s[x],s[i] = s[i],s[x]
          i+=1
      end
  end
  s[l],s[i-1] = s[i-1],s[l]
  return [s[0..i-2],s[i..r]]
end 
```

错误：

```
putarray.rb:38:in `block in parti': undefined method `<' for nil:NilClass (NoM
hodError)
      from inputarray.rb:37:in `each'
      from inputarray.rb:37:in `parti'
      from inputarray.rb:22:in `quicksort'
      from inputarray.rb:47:in `<main>' 
```

它说

```
 if s[x] < p 
```

s[x] 是 NilClass。

更新：事实证明

```
left,right=parti(items,0,items.length) should be 
left,right=parti(items,0,items.length-1) 
```

但是在这个改变之后，一个错误

```
inputarray.rb:37: stack level too deep (SystemStackError) 
```

指向

```
(l+1..r).each do |x| 
```

在互联网上没有找到任何好的解释。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T21:30:03.570

请记住，在 Ruby 中，数组索引从 0 开始，而不是 1。

因此`items.length`将返回大于数组中最大索引的值 1。

尝试`right=parti(items,0,items.length-1)`代替`right=parti(items,0,items.length)`.

# java - 线程安全类与具有所有静态方法的实用程序类

> ID：11253063
> 
> 赞同：3
> 
> 时间：2012-06-28T21:18:59.650
> 
> 标签：java, oop, design-patterns, object-oriented-analysis

当我看到一个记录为线程安全的类时，我想知道为什么它没有被设计成一个具有所有静态方法（如 java.lang.Math 等）的实用程序类。

每当我在没有状态但在单个类中链接方法的场景中设计一个类时，我都缺少有效的驱动力。

**示例 1**：具有“线程安全字段”S 的类 A 怎么样？我的意思是，对象“S”本身是线程安全的。我们可以将类 A 中的所有方法和字段（如 S）声明为静态的吗？

我希望我的解释足够清楚。请澄清。

**注意：**排除 javabean、属性持有类等。我的问题是关于基于输入参数执行某些操作的类，它们可能还需要使用其他类。

我很抱歉我编辑了这个问题。初稿完全模棱两可。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T21:24:46.207

我可以很容易地想象一个类需要有状态的情况，但它也是线程安全的要求。例如，我将队列用于工作线程。它*必须*是线程安全的，并且肯定必须有状态。（即队列中的元素）

编辑：

> 注意：排除 javabean、属性持有类等。我的问题是关于基于输入参数执行某些操作的类，它们可能还需要使用其他类。

如果你的意思是你的问题是关于真正的无状态类，那么 - 根据定义 - 你的观察是正确的。这些几乎总是可以在静态实用程序类中表示。

编辑2：

我认为你被这样一个事实误导了，很多时候我们看到`static`我们可以放松线程安全。（尽管并非在所有情况下都如此，这只是一个经验法则）虽然线程安全和无状态可以在某种程度上齐头并进，但静态是一个正交概念。此外，无状态确实为您提供线程安全，但线程安全并不一定意味着无状态。如果是这样的话，整个概念`synchronized`就没有必要了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-03T16:49:44.257

**为了可测试性，并且因为`static`像拳头适合鼻子一样适合 OO。**

可测试代码要求您可以以受控方式创建测试对象。我不想仅仅因为它是从我正在测试的对象中的某个地方调用的，就必须执行某人的代码。我想单独测试我的对象 - 假设它的合作者工作正常。使用来自某些工具的静态方法使我使用 PowerMock 进行可测试性或吻隔离再见并在我测试时执行该代码。Powermock 是一个问题（因为它使用自己的类加载器），所以测试比我想要的要多。

静态意味着程序代码。有时这很好，因为程序有时很好。但是尝试将 OO 特性（继承、多态）与静态方法一起使用，以便在不使用`static`. 说明这一点的简单示例：[http](http://www.javaworld.com/javaworld/javaqa/2001-05/01-qa-0504-oo.html?page=1) ://www.javaworld.com/javaworld/javaqa/2001-05/01-qa-0504-oo.html?page= 1 - 并非详尽无遗，但显示了我希望的观点。@JB Nizet 对上述答案的评论中列出了其他示例。

我知道这是一个迟到的答案，但老实说，我在使用“无实例”类的静态方法和通常受欢迎的解决方案（即 PowerMock）测试对象时遇到了相当多的问题。

# android - 检查android中的数据库是否为空

> ID：11253067
> 
> 赞同：-3
> 
> 时间：2012-06-28T21:19:27.110
> 
> 标签：android, sqlite

> **可能重复：**
> [如何检查我的 sqlite 表中是否有数据？](https://stackoverflow.com/questions/4397757/how-can-i-check-to-see-if-my-sqlite-table-has-data-in-it)
> [Android检查数据库是否为空](https://stackoverflow.com/questions/11251901/android-check-if-database-is-empty)

谁能告诉我如何检查 sqlite 数据库（在 android 中）是否为空或有表，如果它有表，它是空的还是有值？

我使用sqlite制作了一个登录验证程序，我希望它检查是否没有用户自动登录

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T21:36:19.090

你可以做一个简单的方法来检查数据库是否已经存在。

```
private boolean checkDataBase(){

    SQLiteDatabase checkDB = null;

    try{
        checkDB = SQLiteDatabase.openDatabase(myPath, null, SQLiteDatabase.OPEN_READONLY);
    } catch(SQLiteException e){ 
        //database doesn't exist yet
    }

    if(checkDB != null){
        checkDB.close();
    }

    return checkDB != null ? true : false;
} 
```

# c# - 带有 FAXCOMEXLib 问题的 Windows 2008 传真

> ID：11253074
> 
> 赞同：0
> 
> 时间：2012-06-28T21:20:04.847
> 
> 标签：c#, asp.net, windows-services, fax, winfax

我正在使用 FAXCOMEXLib 来实现传真服务。

我创建了一个 Windows 服务，从数据库中检索传真文档，连接到传真服务器。一切都很好，但是当我打开 Windows 传真和扫描时。传真作业不在发件箱队列中。但是如果我使用 WinForm 程序发送，该作业将出现在发件箱队列中，以便我可以取消它或删除它。

```
 FaxOutgoingQueue outgoingQueues;
    IFaxOutgoingJob outgoingJobs;
    outgoingQueues = fServer.Folders.OutgoingQueue;
    outgoingQueues.Refresh();
    outgoingJobs = outgoingQueues.GetJob(severJobID);
    outgoingJobs.Cancel(); 
```

# java - 将对象从 ArrayList 移动到 Other

> ID：11253075
> 
> 赞同：4
> 
> 时间：2012-06-28T21:20:20.743
> 
> 标签：java, performance, arraylist

我有三个列表，我需要使用列表**animalFilterName将****Animal**对象从列表**animalSource**移动到列表**animalTarget**。只有 AnimalFilterName 列表中存在名称的 Animal**应该**从 **animalSource**移动 到**animalTarget**，性能方面是否有比我在下面做的更好的方法。现在只使用样本数据。

 ******```
public class Animal {

    private String name;
    private String color;

    public String getName() {
        return name;
    }
    public void setName(String name) {
        this.name = name;
    }
    public String getColor() {
        return color;
    }
    public void setColor(String color) {
        this.color = color;
    }
}

public class MoveAnimal {

    /**
     * @param args
     */
    public static void main(String[] args) {

        List<Animal> animalSource = new ArrayList<Animal>();
        List<String> animalFilterName = new ArrayList<String>();
        List<Animal> animalTarget = new ArrayList<Animal>();

        animalFilterName.add("Name1");
        animalFilterName.add("Name2");

        Animal a1 = new Animal();
        a1.setColor("Color1");
        a1.setName("Name1");

        Animal a2 = new Animal();
        a2.setColor("Color2");
        a2.setName("Name2");

        Animal a3 = new Animal();
        a3.setColor("Color1");
        a3.setName("Name3");

        Animal a4 = new Animal();
        a4.setColor("Color1");
        a4.setName("Name4");

        Animal a5 = new Animal();
        a5.setColor("Color5");
        a5.setName("Name1");

        animalSource.add(a1);
        animalSource.add(a2);
        animalSource.add(a3);
        animalSource.add(a4);
        animalSource.add(a5);

        for(String s: animalFilterName) {
            for(Animal a: animalSource) {
                if(s.equals(a.getName())) {
                    animalTarget.add(a);
                }
            }
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T21:30:57.873

为了获得更好的性能，您可能需要使用 Sets。我很确定您正在做的是 m = animalSource.size() 和 n = animalFilterName.size() 的 O(m * n) 操作，因为 ArrayLists 中的查找顺序为 n（到列表大小）

Sets 中的查找、插入和删除通常是摊销的常数时间或对数时间（到集合的大小）（取决于集合实现的细节），所以最坏的情况下，使用集合会将其减少到 O(m * log (n)) 对于相同的 m 和 n。

```
Set<Animal> animalSource = ...;
Set<Animal> animalTarget = ...;
Set<String> animalFilterName = ...;

// add matching animals to new set
for (Animal a : animalSource)
    if (animalFilterName.contains(a.getName())) animalTarget.add(a);

// if you need to remove them from the first set, uncomment these lines
// for (Animal a : animalTarget)
//     animalSource.remove(a); 
```

我认为在一行 ifs 和循环中省略换行符会使它们看起来更整洁。这是个人喜好，你不必复制我的风格。

编辑：固定时间复杂度

另一个编辑：当您说移动时，您的意思是添加到一个列表并从另一个列表中删除吗？还是您只是指添加到一个列表中？

第三次编辑：固定碎片线

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T21:44:40.123

所示算法的复杂度为 O(nxm)（由于两个嵌套循环），其中 n 是第一个列表中的元素数，m 是过滤器中的元素数。

为了改进算法以获得更大的 n 和 m 值的更好性能，您可以将过滤器列表转换为 HashTable。

像这样：

```
 Hashtable<String, String> animalFilterName = new Hashtable<String, String>();
 animalFilterName.put("Name1", null);
 animalFilterName.put("Name2", null); 
```

然后，双for循环可以简化为：

```
for (Animal a: animalSource) {
    if (animalFilterName.containsKey(a.getName())) {
        animalTarget.add(a);
    }
} 
```

现在复杂性要好得多：作为哈希表的 O(n) 表现为 O(1) 的平均值。但是您只会注意到 n 和 m 的数字较大时的差异。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T21:31:25.337

想到两件事

1）您可以制作一组过滤器并检查动物的名字是否在集合中，而不是制作过滤器列表并对其进行迭代。这在大 O 方面更好，实时是否更快取决于实际的集合大小。

2）如果您既不排序也不进行随机访问，LinkedLists 比 ArrayLists 更有效。

```
public static void main(String[] args) {

    List<Animal> animalSource = new LinkedList<Animal>();
    Set<String> animalFilterName = new HashSet<String>();
    List<Animal> animalTarget = new LinkedList<Animal>();

    //Set-up

    for (Animal a : animalSource) {
        if (animalFilterName.contains(a.getName())) {
            animalTarget.add(a);
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-28T21:45:25.503

为了尊重您在 sourceAnimal 列表中允许重复条目的事实，我建议以下内容：

添加两件事：

List 类型的 indexList

```
List<List<Integer>> 
```

它将您的动物的索引保存在您的 sourceAnimal 列表中。这意味着如果您有以下 sourceAnimal 列表

```
sourceAnimal: [ 0:"rabbit", 1:"dog", 2:"cat", 3:"horse", 4:"rabbit" ] 
```

您将拥有以下（新）indexList：

```
indexList: [ 0: [0, 4], 1: [1], 2:[2], 3:[3] ] 
```

当您添加最后一个附加部分时，这一切都是有意义的：哈希表。

HashTable 将动物名称映射到其在 indexList 中的相应索引，您可以在其中读取实际 sourceAnimal 列表中该动物名称的所有出现的实际索引。

这样，您将按如下方式处理您的任务：

```
// Pseudo-Code !

foreach (animal: animalFilter) {

    if (hashtable.contains(animal) {

        int superIndex = hashtable.get(animal);

        foreach (int sourceAnimalIndex : indexList[superIndex]) {

            copy sourceAnimal[sourceAnimalIndex] to targetAnimal;
        }
    }

} 
```

}

这种方法的**好处**是您可以避免任何迭代（除了在上面的示例中“兔子”的索引 0 和索引 4 以及对要过滤的动物的迭代中的乘法累加动物的索引之外）。

当然，**缺点**可能是您必须添加额外的数据结构并增加一些维护开销。

但是我敢肯定，如果您在 sourceAnimalList 中存储大量项目，那么防止对每个动物的整个列表进行“主迭代”将非常有效。******

# excel - Excel 2003：10 个 if 语句的更好解决方法

> ID：11253086
> 
> 赞同：3
> 
> 时间：2012-06-28T21:21:26.767
> 
> 标签：excel, if-statement

![在此处输入图像描述](../Images/76bcfbce99ea80d2ea4fa53bce7a9c36.png)对于使用 2 个单元格的组合的 10 个语句，我有一个非常粗略的解决方法，如下所示

```
Cell 1 (O2)
=IF(C2="TW2-OUT",VLOOKUP($D2,Players,8,FALSE)+VLOOKUP($D2,Players,9,FALSE),IF(C2="TW2-IN",IF($D2="","",VLOOKUP($D2,Players,10,FALSE)),IF(C2="Playing",IF($D2="","",VLOOKUP($D2,Players,8,FALSE)+VLOOKUP($D2,Players,9,FALSE)+VLOOKUP($D2,Players,10,FALSE)),IF(C2="IN1OUT2",VLOOKUP($D2,Players,9,FALSE)+VLOOKUP($D2,Players,10,FALSE),IF(C2="TW1-OUT",IF($D2="","",VLOOKUP($D2,Players,8,FALSE)),IF(C2="TW1-IN",IF($D2="","",VLOOKUP($D2,Players,9,FALSE)+VLOOKUP($D2,Players,10,FALSE)),IF(C2="TW3-OUT",VLOOKUP($D2,Players,8,FALSE)+VLOOKUP($D2,Players,9,FALSE)+VLOOKUP($D2,Players,10,FALSE),0)))))))+P2

Cell 2 (P2)
 =IF(C2="TW3-IN",IF($D2="","",VLOOKUP($D2,Players,11,FALSE)),IF(C2="IN2OUT3",VLOOKUP($D2,Players,10,FALSE),IF(C2="IN1OUT3",VLOOKUP($D2,Players,9,FALSE)+VLOOKUP($D2,Players,10,FALSE),0))) 
```

有没有更好的方法来做到这一点。我通过 Google 搜索阅读了有关使用带有数组的表格方法来达到相同效果的信息。然而，就我而言，球员的状态决定了球员的得分，这让我的事情变得复杂。以下是 10 种可能的状态（if 语句），按照评分的计算方式细分如下：

```
TransferStatuses    Cols
Playing             8+9+10+11
TW1-IN              9+10
TW1-OUT             8
TW2-IN              10+11
TW2-OUT             8+9
TW3-IN              11
TW3-OUT             8+9+10
IN1OUT2             9
IN1OUT3             9+10
IN2OUT3             10

8 = ColK (Transfer Window 0)
9 = ColL(Transfer Window 1)
10 = ColM (Transfer Window 2)
11 = ColN(Transfer Window 3) 
```

'score' 数组将如下所示：

```
=VLOOKUP(C2,$S$2:$T$11,2,FALSE) 
```

问题是我不知道如何将它们放在一起以使其工作，即我必须将我的公式扩展到 300 个单元格，但我不知道如何实现它以便数组正确计算每个单元格的分数玩家？

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T22:33:09.300

如果我理解正确，我会这样处理：

设置一个二进制值矩阵，为每个状态指定应该添加哪些列。使用`OFFSET`和`MATCH`查找每个数据行的状态并返回二进制值的数组/范围，并将`SUMPRODUCT`其全部汇总。看截图：

![在此处输入图像描述](../Images/89a9e6b8c2d5084c3ce7ba3df32495ac.png)

# python - Hadoop：在 Ubuntu 12.04 中通过 NameNode 格式化 HDFS 文件系统

> ID：11253088
> 
> 赞同：3
> 
> 时间：2012-06-28T21:21:41.867
> 
> 标签：python, database, linux, ubuntu, hadoop

我正在关注本教程[http://www.michael-noll.com/tutorials/running-hadoop-on-ubuntu-linux-single-node-cluster/](http://www.michael-noll.com/tutorials/running-hadoop-on-ubuntu-linux-single-node-cluster/)

注意：是的，我知道我确实将 hadoop 安装到 /usr/local/hadoop/hadoop/ 但教程没有

当我运行时：

```
hduser@ubuntu:~$ /usr/local/hadoop/hadoop/bin/hadoop namenode -format 
```

我明白了

```
Warning: $HADOOP_HOME is deprecated.

/usr/local/hadoop/hadoop/bin/hadoop: line 320: /usr/lib/jvm/java-6-sun/bin/java: No such  file or directory
/usr/local/hadoop/hadoop/bin/hadoop: line 390: /usr/lib/jvm/java-6-sun/bin/java: No such file or directory 
```

代替

```
hduser@ubuntu:/usr/local/hadoop$ hadoop/bin/hadoop namenode -format
10/05/08 16:59:56 INFO namenode.NameNode: STARTUP_MSG:
/************************************************************
STARTUP_MSG: Starting NameNode
STARTUP_MSG:   host = ubuntu/127.0.1.1
STARTUP_MSG:   args = [-format]
STARTUP_MSG:   version = 0.20.2
STARTUP_MSG:   build = https://svn.apache.org/repos/asf/hadoop/common/branches    /branch-0.20 -r 911707; compiled by 'chrisdo' on Fri Feb 19 08:07:34 UTC 2010
************************************************************/
10/05/08 16:59:56 INFO namenode.FSNamesystem: fsOwner=hduser,hadoop
10/05/08 16:59:56 INFO namenode.FSNamesystem: supergroup=supergroup
10/05/08 16:59:56 INFO namenode.FSNamesystem: isPermissionEnabled=true
10/05/08 16:59:56 INFO common.Storage: Image file of size 96 saved in 0 seconds.
10/05/08 16:59:57 INFO common.Storage: Storage directory .../hadoop-hduser/dfs/name has    been successfully formatted.
10/05/08 16:59:57 INFO namenode.NameNode: SHUTDOWN_MSG:
/************************************************************
SHUTDOWN_MSG: Shutting down NameNode at ubuntu/127.0.1.1
************************************************************/ 
```

在 /usr/local/hadoop/hadoop/bin/hadoop 行 320 的代码中是：

```
JAVA_PLATFORM=`CLASSPATH=${CLASSPATH} ${JAVA} -Xmx32m ${HADOOP_JAVA_PLATFORM_OPTS}           
org.apache.hadoop.util.PlatformName | sed -e "s/ /_/g"` 
```

第 390 行是：

```
 exec "$JAVA" -Dproc_$COMMAND $JAVA_HEAP_MAX $HADOOP_OPTS -classpath "$CLASSPATH" $CLASS "$@" 
```

知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T22:08:20.833

我有以下文件：/usr/lib/hadoop-0.20/bin/hadoop-config.sh（Cloudera 安装）

在这里，我可以看到它在以下位置搜索 java：

```
# attempt to find java
if [ -z "$JAVA_HOME" ]; then
  for candidate in \
    /usr/lib/jvm/java-6-sun \
    /usr/lib/jvm/java-1.6.0-sun-1.6.0.*/jre/ \
    /usr/lib/jvm/java-1.6.0-sun-1.6.0.* \
    /usr/lib/j2sdk1.6-sun \
    /usr/java/jdk1.6* \
    /usr/java/jre1.6* \
    /Library/Java/Home \
    /usr/java/default \
    /usr/lib/jvm/default-java ; do
    if [ -e $candidate/bin/java ]; then
      export JAVA_HOME=$candidate
      break
    fi
  done 
```

您的 JAVA_HOME 设置是否正确？你可以手动设置它然后尝试再次运行它。

[编辑：基于评论]

1.  检查是否设置了 JAVA_HOME： `echo $JAVA_HOME`
2.  找出你的 jvm 所在的位置，通常在：`/usr/lib/jvm/java-6-sun/`
3.  然后设置它。编辑 bashrc 和 bash_profile：`vi ~/.bashrc`或`vi ~/.bash_profile`
4.  添加以下内容：`export JAVA_HOME=/usr/lib/jvm/java-6-sun/`
5.  请注意，路径应基于您找到 jvm 的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-07T11:30:31.847

`JAVA_HOME`通过将此行添加到`hadoop/bin`文件 hadoop（在上面的给定路径中）中，将您重置为具有 java 的目录：

```
export JAVA_HOME=/home/hduser/jdk1.7.0_07 
```

# php - 添加从 javascript 到 php 脚本的链接

> ID：11253093
> 
> 赞同：-2
> 
> 时间：2012-06-28T21:21:56.517
> 
> 标签：php, javascript

我有以下脚本，它不起作用。我该怎么做才能添加链接？jno = "97856483"; dispTitle = "新书"; dispAuthor = "作者名";

```
document.getElementById('popups').innerHTML = '';
//Add link to add this book:
 var url = encodeURIComponent(jno) + "&tt=" + encodeURIComponent(dispTitle) + "&at=" + encodeURIComponent(dispAuthor);
 //document.writeln(url);
 document.getElementById("addLink").innerHTML = "<a href='memaccountentry.php?isbn='+ url>Add book</a>" ;   //This one just appends the word url.
//window.location.href =  'memaccountentry.php?isbn=' +jno +'&tt=' +dispTitle+'&at=' +dispAuthor;          //I know this is working, but not a right way to do. 
//I need to put a href link to go to the next page. 
//ajax.open('GET', 'memaccountentry.php?isbn=' +jno +'&tt=' +dispTitle+'&at=' +dispAuthor', true); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-28T21:23:30.160

您需要正确打开和关闭报价。
试试看：

```
document.getElementById("addLink").innerHTML = "<a href='memaccountentry.php?isbn="+ url +"'>Add book</a>" ;   //This one just appends the word url. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T21:25:37.277

看来您的字符串格式不正确。

如果这不是你想要的，那么你让我完全糊涂了。

```
document.getElementById("addLink").innerHTML = "<a href='memaccountentry.php?isbn='" + url + ">Add book</a>"; 
```

# java - 如何从 html 中的 Javascript 访问 Java 中的方法？

> ID：11253094
> 
> 赞同：0
> 
> 时间：2012-06-28T21:22:06.753
> 
> 标签：java, javascript, html, webpage

我一直在学习网络编程，目前我一直坚持在服务器客户端（Java）上编写一个方法，当我单击网页上的按钮（在 html 和 javascript 中）时运行。

基本上，我创建了一个 Java 服务器客户端，在运行时，我可以转到 Web 浏览器并键入“localhost:8080/index.html”，页面将显示按钮，并且一些按钮附加了 javascript，以便我可以单击和互动。

但是，我在 Java 中有一种方法，我希望 Javascript 在单击按钮时访问它。我怎么做？

非常感谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-28T21:25:47.623

不要采取错误的方式，但仅此问题就表明您仍然需要大量阅读有关 Web 开发的内容。

由于您使用的是 Java，我建议您在谷歌上搜索“java web 开发教程”或类似的东西。

这里有几个链接可以帮助您入门：

[http://www.apl.jhu.edu/~hall/java/Servlet-Tutorial/](http://www.apl.jhu.edu/~hall/java/Servlet-Tutorial/)

[http://www.mkyong.com/tutorials/spring-mvc-tutorials/](http://www.mkyong.com/tutorials/spring-mvc-tutorials/)

祝你好运！

# visual-studio-2010 - msbuild 中的增量清理是什么，何时触发？

> ID：11253095
> 
> 赞同：20
> 
> 时间：2012-06-28T21:22:12.097
> 
> 标签：visual-studio-2010, msbuild, teamcity

我正在调试我的构建过程中偶尔发生的错误，但我无法直接重现它。我正在将 msbuild 与 teamcity 一起使用。

我有一个这样的依赖层次结构：

```
Some.Interop.dll
   Dependency-> SharedDllABC.dll

SomeService.exe
   Depenendcy-> Some.Interop 
```

通常最终的服务可执行文件进入其发布目录：

```
Some.Interop
SharedDllABC.Dll
ServiceExectuable.exe 
```

但是，我可以在我们的 msbuild 日志中看到，有时在构建所有内容后的增量清理过程中会删除三级依赖项，从而导致：

```
Some.Interop
ServiceExectuable.exe 
```

您可以在 msbuild 日志中看到它：

```
[src\SomeService\SomeService.csproj] _TimeStampAfterCompile
[12:32:43]:  [src\SomeService\SomeService.csproj] Compile

// some other targets

[12:32:43]:  [src\SomeService\SomeService.csproj] _CopyFilesMarkedCopyLocal
[12:32:43]:      [_CopyFilesMarkedCopyLocal] Copy
[12:32:43]:          [Copy] Copying file from "C:Projects\trunk\src\Some.Interop\bin\Release\Some.Interop.dll" to "bin\Release\Some.Interop.dll".

// some other targets

[src\Project\SomeService\SomeService.csproj] IncrementalClean
[18:54:42]:         [IncrementalClean] Delete
[18:54:42]:             [Delete] Deleting file "C:\Projects\trunk\src\Project\SomeService\bin\Release\SharedDllABC.dll".
[18:54:42]:             [Delete] Deleting file "C:\Projects\trunk\src\Project\SomeServiceService\bin\Release\SharedDllABC.pdb".
[18:54:42]:     [src\Project\SomeService\SomeService.csproj] CoreBuild
[18:54:42]:     [src\Project\SomeService\SomeService.csproj] AfterBuild
[18:54:42]:     [src\Project\SomeService\SomeService.csproj] Build 
```

这是我的直接 msbuild 输出，我只是更改了项目名称/dll 名称以匹配我的示例。到此增量清理发生时，`SomeService.csproj`已经构建好了。你可以看到它没有被复制。但是，在其他 msbuild 日志中，它确实被正确复制，然后增量清理不会删除它。

我认为[这篇文章](http://social.msdn.microsoft.com/Forums/en-US/tfsbuild/thread/2a2bcbb4-8afe-41da-a07d-822f50f2ea72)中的增量清理应该清理从以前的版本创建的 dll，但这并不能解释这个 dll 在大多数情况下是如何构建的。在视觉工作室中，这也总是有效的。

我想我只是想知道究竟是`Incremental clean`什么，是什么导致它启动，也许在调试这样的情况时我应该寻找什么（程序集版本、时间戳等？）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2017-07-13T15:17:58.383

尝试以下操作：

添加：

```
<Target Name="IncrementalClean" /> 
```

到包含在所有项目中的 .targets 文件。

来自 --> [https://github.com/Microsoft/msbuild/issues/1054](https://github.com/Microsoft/msbuild/issues/1054)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-02-05T19:49:13.153

@Kebabbi 建议通过编辑 csproj 文件来修复。从 MSBuild 15 开始，有一种简单的方法可以将其应用于所有 CSPROJ 文件，而不是编辑每个 csproj 文件。

[https://docs.microsoft.com/en-us/visualstudio/msbuild/customize-your-build?view=vs-2017](https://docs.microsoft.com/en-us/visualstudio/msbuild/customize-your-build?view=vs-2017)

> Directory.Build.props 和 Directory.Build.targets 在 MSBuild 版本 15 之前，如果您想为解决方案中的项目提供新的自定义属性，您必须手动将对该属性的引用添加到解决方案中的每个项目文件. 或者，您必须在 .props 文件中定义属性，然后在解决方案中的每个项目中显式导入 .props 文件，等等。
> 
> 但是，现在您可以通过在包含源代码的根文件夹中名为 Directory.Build.props 的单个文件中定义一个新属性，一步向每个项目添加一个新属性。当 MSBuild 运行时，Microsoft.Common.props 会在您的目录结构中搜索 Directory.Build.props 文件（Microsoft.Common.targets 会搜索 Directory.Build.targets）。如果它找到一个，它会导入该属性。Directory.Build.props 是一个用户定义的文件，它为目录下的项目提供自定义。

创建一个文件`Directory.Build.props`，并将其与 SLN 文件相邻放置。

```
<Project>
   <Target
     Name="ForceAssignProjectConfigurationBeforeSplitProjectReferencesByFileExistence_KLUDGE" 
     BeforeTargets="_SplitProjectReferencesByFileExistence" 
     DependsOnTargets="AssignProjectConfiguration" />
</Project> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-11-01T09:21:46.670

这可能是由 MsBuild 中的错误引起的：[https](https://github.com/Microsoft/msbuild/issues/1054) ://github.com/Microsoft/msbuild/issues/1054 。评论中提出了修复建议：[https ://github.com/Microsoft/msbuild/issues/1054#issuecomment-406438561](https://github.com/Microsoft/msbuild/issues/1054#issuecomment-406438561)

当 MsBuild 确定要从引用的项目中复制哪些项目时，它应该递归地执行此操作，但不会正确执行此操作。

作为解决方法，可以将以下内容添加到每个 csproj。

```
<Target
    Name="ForceAssignProjectConfigurationBeforeSplitProjectReferencesByFileExistence_KLUDGE" 
    BeforeTargets="_SplitProjectReferencesByFileExistence" 
    DependsOnTargets="AssignProjectConfiguration" 
/> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-03-19T12:45:00.667

我只是花了几天时间试图用类似的模式来解决这个问题。在我们的例子中，从输出文件夹中删除的是 nuget 文件。

```
NugetPackage (that drops files in x86/x64 subfolders in output folder)

LibraryA.dll
   Dependency-> NugetPackage

LibraryB.dll
   Dependency-> LibraryA.dll 
```

在我们的例子中，我们有许多解决方案文件，它们按特定顺序构建为 msbuild 脚本的一部分。问题是 LibraryB.csproj 包含在两个解决方案文件中。

解决方案 1 构建和输出文件都存在。

解决方案 2 构建并看到 LibraryB.dll 存在并且是最新的，因此由于某种原因触发了从输出文件夹中删除 NugetPackage 文件的 IncrementalClean。

从解决方案 2 中删除 LibraryB.csproj 后，问题就解决了，文件出现在输出文件夹中。

# ios - 在带有 UIGestureRecognizer 的视图中不调用 UIBarButtonItem 的操作

> ID：11253099
> 
> 赞同：2
> 
> 时间：2012-06-28T21:22:17.577
> 
> 标签：ios, uibarbuttonitem, uitapgesturerecognizer

我有一个简单的 UIViewController 派生控制器，它具有 UITextFields。

同样使用 IB，我放置了一个 UIToolbar 和两个 UIBarButtonItems。我 Ctrl-Drag 向按钮添加动作。

```
- (IBAction)cancel:(id)sender { ... }
- (IBAction)save:(id)sender { ... } 
```

如果我运行代码，就会调用这些操作。

**问题**：我想*在背景上实现对 resignFirstResponder 范例*的点击，所以我在根视图上添加了一个 UITapGestureRecognizer ：

```
- (void)viewDidLoad { 
    ...
    UITapGestureRecognizer *tap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(dismissKeyboard)];
    [self.view addGestureRecognizer:tap];
   } 
```

当我有手势识别器时，**不会调用 UIBarButtonItems 的操作**

我怎样才能同时拥有它？

感谢任何可以帮助我实现这一点的解释。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-03T01:50:37.980

我通过添加另一个视图并在该视图而不是根视图上设置手势识别器来解决问题。

但我仍然想知道为什么手势识别器会“吃掉”UIBarButtonItem 的动作的解释。

# c++ - 多重继承指针比较

> ID：11253100
> 
> 赞同：18
> 
> 时间：2012-06-28T21:22:19.463
> 
> 标签：c++, inheritance, pointers, multiple-inheritance

我有一个`Derived`直接从两个基类继承的类，`Base1`并且`Base2`. 我想知道一般来说，比较指向基类的指针以确定它们是否是同一个`Derived`对象是否安全：

```
Base1* p1;
Base2* p2;

/*
 * Stuff happens here. p1 and p2 now point to valid objects of either their
 * base type or Derived
 */

//assert(p1 == p2); //This is illegal
assert(p1 == static_cast<Base1*>(p2)); //Is this ok?
assert(static_cast<Derived*>(p1) == static_cast<Derived*>(p2)); //How about this? 
```

指针保证有效，但不一定指向`Derived`对象。我的猜测是这可能很好，但我想知道从技术 C++ 的角度来看是否可以。实际上我从来没有对指针做任何操作，我只是想知道它们是否指向同一个对象。

编辑：如果我能保证`p1`并`p2`指向`Derrived`对象，这似乎是安全的。我基本上想知道如果他们不这样做是否安全-如果一个或两个都指向基础对象，那么比较是否一定会失败？同样，我可以保证指针是有效的（即，`p1`永远不会指向一个`Base2`对象，反之亦然）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-28T21:53:02.430

好吧，不，它不会工作。

我个人非常喜欢通过例子学习，所以这里有一个：

```
#include <iostream>

class Base1
{
public:
    Base1()
    {
        numberBase1 = 1;
    }

    int numberBase1;
};

class Base2
{
public:
    Base2()
    {
        numberBase2 = 2;
    }

    int numberBase2;
};

class Derived : public Base1, public Base2
{
public:
    Derived()
    {
        numberDerived = 3;
    }

    int numberDerived;
};

int main()
{
    Derived d;
    Base1 *b1 = &d;
    Base2 *b2 = &d;

    std::cout << "d: " << &d << ", b1: " << b1 << ", b2: " << b2 << ", d.numberDerived: " << &(d.numberDerived) << std::endl;

    return 0;
} 
```

我的计算机上的一次运行输出如下：

```
d: 0035F9FC, b1: 0035F9FC, b2: 0035FA00, d.numberDerived: 0035FA04 
```

Soo..如果我们将d的地址定义为0，那么b1为0，b2为+4，d的个数为+8。这是因为我机器上的 int 是 4 字节长。

基本上，您必须查看 C++ 内部如何表示类的布局：

```
Address:    Class:
0           Base1
4           Base2
8           Derived 
```

..所以总的来说，实例化一个派生类将为派生类的基类分配空间，最后为派生对象本身腾出空间。因为我们这里有 3 个整数，所以这将是 12 个字节。

现在，您要问的是（除非我误解了某些内容）是否可以将不同基类指针的地址相互比较，以查看它们是否指向同一个对象，答案是否定的-至少不是直接的，在我的示例中，b1 将指向 0035F9FC，而 b2 将指向 0035FA00。在 C++ 中，这种偏移都是在编译时完成的。

您可能可以使用 RIIA 和 sizeof() 来做一些魔术，并确定偏移量 b2 应该有多少与 b1 相当，但随后您会遇到各种其他麻烦，例如虚拟。简而言之，我不会推荐这种方法。

更好的方法是像 ialiashkevich 所说的那样强制转换为 Derived*，但是，如果您的对象不是 Derived* 的实例，这将带来问题。

（免责声明；我已经有 3 到 4 年没有使用 C++了，所以我可能有点偏离我的游戏。要温柔 :)）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-28T21:36:52.007

`Derived*`在比较之前转换为正确的方法。

有一个类似的话题：[C++ 指针多继承乐趣](https://stackoverflow.com/questions/2157104/c-pointer-multi-inheritance-fun)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-29T06:39:43.153

好吧，事实证明，实现您正在寻找的最短方法是：

```
assert(dynamic_cast<void*>(p1) == dynamic_cast<void*>(p2)); 
```

动态转换为`void*`有效地将给定指针向下转换为其最派生的类，因此可以保证如果两者都指向同一个对象，则断言不会失败。

事实上，[动态强制转换为 void 指针有实际用途](https://stackoverflow.com/questions/8123776/are-there-practical-uses-for-dynamic-casting-to-void-pointer)......

编辑：回答问题的编辑，比较**是**不安全的。考虑以下代码：

```
Base2 b2;
Base1 b1;
assert(static_cast<Derived*>(&b1) == static_cast<Derived*>(&b2));  // succeeds! 
```

两个不同基的内存布局类似于 a 的内存布局`Derived`（在一个常见的实现中 - 堆栈的增长与堆相反）。第一个`static_cast`保持指针不变，但第二个将指针`sizeof(Base1)`移回，所以现在它们都指向 on `&b1`，并且断言成功 - 即使对象不同。

`static_cast`仅当您确定演员表正确时才应使用。这不是你的情况，所以你必须使用`dynamic_cast`，可能如上所述。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-28T21:26:39.643

简短的回答是否定的，这通常不是一个好主意。

**注意**：这是假设您想要为所有类自定义等价，如果您想检查它们是否是同一个对象，最好这样做`(Derived *)`。

一个更好的解决方案是重载、和的`==`运算符。`Base1``Base2``Derived`

假设`Base1`有 1 个参数`param1`表示相等，并且`Base2`有另一个参数`param2`表示相等：

```
virtual bool Base1::operator==(object& other){
    return false;
}

virtual bool Base1::operator==(Base1& other)
{
    return this.param1 == other.param1;
}

virtual bool Base2::operator==(object& other){
    return false;
}

virtual bool Base2::operator==(Base2& other)
{
    return this.param2 == other.param2;
}

virtual bool Derived::operator==(object& other){
    return false;
}

virtual bool Derived::operator==(Derived& other){
    return this.param1 == other.param1 && this.param2 == other.param2;
}

virtual bool Derived::operator==(Base1& other){
    return this.param1 == other.param1;
}

virtual bool Derived::operator==(Base2& other){
    return this.param2 == other.param2;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-28T22:34:25.513

```
assert(p1 == p2);                      //This is illegal
assert(p1 == static_cast<Base1*>(p2)); //Is this ok?
assert(static_cast<Derived*>(p1) 
       == static_cast<Derived*>(p2));  //How about this? 
```

它们都不是一个*好的*解决方案。第一个不会编译，因为您无法比较不相关类型的指针。出于同样的原因，第二个也不会编译（除非`Base1`并且`Base2`通过继承相关）：您不能`static_cast`指向不相关类型的指针。

第三个选项是*边界线*。也就是说，它是不正确的，但它会在很多情况下起作用（只要继承不是虚拟的）。

比较身份的正确方法是使用`dynamic_cast`派生类型并检查 null：

```
{
  Derived *tmp = dynamic_cast<Derived*>(p1);
  assert( tmp && tmp == dynamic_cast<Derived*>(p2) );
{ 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-28T21:57:09.850

使用`dynamic_cast`, 并注意 NULL。

```
#include <cassert>

struct Base1 { virtual ~Base1() {} };
struct Base2 { virtual ~Base2() {} };
struct Derived : Base1, Base2 {};

bool IsEqual(Base1 *p1, Base2 *p2) {
  Derived *d1 = dynamic_cast<Derived*>(p1);
  Derived *d2 = dynamic_cast<Derived*>(p2);

  if( !d1 || !d2 ) return false;
  return d1 == d2;
}

int main () {
  Derived d;
  Base1 *p1 = &d;
  Base2 *p2 = &d;
  Base1 b1;
  Base2 b2;

  assert(IsEqual(p1, p2));
  assert(!IsEqual(p1, &b2));
  assert(!IsEqual(&b1, p2));
  assert(!IsEqual(&b1, &b2));
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-28T21:51:02.300

基于这个 SO 问题，它似乎是无效的： [C++ 的多重继承是如何实现的？](https://stackoverflow.com/questions/1002503/how-is-cs-multiple-inheritance-implemented)

基本上，由于对象在内存中的布局方式，强制转换为`Base1*`or`Base2*`导致指针的突变，如果没有 a ，我无法在运行时任意反转`dynamic_cast`，我想避免这种情况。感谢大家！

# php - 使用预设将参数传递给函数

> ID：11253111
> 
> 赞同：0
> 
> 时间：2012-06-28T21:22:50.807
> 
> 标签：php, function, parameters

我正在寻找一种方法来获取正在设置的参数值，无论是通过它还是预先设置。我尝试使用`func_get_params()`. 虽然这确实返回了传入的值，但它不显示值是否是预设的。

```
public function __construct($host = 'null', $user = null, $password = null, $database = null){
var_dump(func_get_args());
die();
    $this->mysqli = new mysqli($host, $user, $password, $database);

    if ($this->mysqli->connect_errno) {
        echo("Connection failed: ". $mysqli->connect_error);
        exit();
    }
} 
```

当没有传入任何值时，得到一个空数组输出，而不是空值。如果我把它`nulls`变成字符串，也会发生这种情况。

是否有替代方法`func_get_args`也返回预设值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T21:36:02.443

非常冗长，您会明白为什么使用命名参数或更有趣的是：

```
<?php
class Foo {
     function __construct($host = 'null', $user = null, $password = null, $database = null){
        //getParameters 
        $ref = new ReflectionMethod(__CLASS__,__FUNCTION__);
        $args = array();
        foreach($ref->getParameters() as $param){
                $args[] = $param->getDefaultValue();
        }
        foreach(func_get_args() as $key => $arg){
           $args[$key] = $arg;
        }
        var_dump($args);
     }
}
new Foo();
/*
array(4) {
  [0]=>
  string(4) "null"
  [1]=>
  NULL
  [2]=>
  NULL
  [3]=>
  NULL
}
*/
new Foo('foo','bar');
/*
array(4) {
  [0]=>
  string(3) "foo"
  [1]=>
  string(3) "bar"
  [2]=>
  NULL
  [3]=>
  NULL
}
*/ 
```

# ios - 如何在视图加载时激活嵌入在导航栏中的 UITextView？

> ID：11253115
> 
> 赞同：1
> 
> 时间：2012-06-28T21:23:17.310
> 
> 标签：ios, xcode, uitextfield

我正在使用 Xcode 4.3.3 和 iOS 5.1 开发 iPad 应用程序。

我有一个 UITextField 作为导航栏的 titleView（在故事板中），连接到这样的插座：

```
@property (weak, nonatomic) IBOutlet UITextField *textFieldName; 
```

在我的 viewDidLoad 实现结束时，我调用：

```
[self.textFieldName becomeFirstResponder]; 
```

而且……什么也没有发生。我可以点击 UITextField 来激活它，但在视图启动时似乎无法激活该字段。

背景：在前一个视图（UITableView）中添加一行后，我将继续使用此视图，并且如果通常显示为视图标题的内容为空，我希望启用文本字段。也就是说，在我的数据库中创建新行时，我希望用户的第一个操作是输入标题。我对其他方法持开放态度，但仍想知道如何完成所述问题。

**编辑**

我可以通过调用来让它工作：

```
 [self.navigationItem.titleView becomeFirstResponder]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T02:41:11.960

您的代码应该可以工作。

我猜您可能缺少一个简单的步骤，例如添加 UITextFieldDelegate。我只是建议通过每个步骤并尝试找出哪些不起作用。如果这不起作用，请发布您的 Xcodeproj，我（或其他人）可以仔细查看。

# c# - linq to entity 查询将列表作为连续字符串返回

> ID：11253116
> 
> 赞同：1
> 
> 时间：2012-06-28T21:23:17.973
> 
> 标签：c#, asp.net-mvc-3, linq, entity-framework

我有一个看起来像这样的查询：

```
var ChangesOthersResult = surveyResponseRepository.Query.Select(r => r.ChangesOthers); 
```

这将从我的表中返回“ChangesOthers”列中的所有条目。

当我在视图中返回数据时：

```
@Html.DisplayFor(modelItem => modelItem.ChangesOthersResult) 
```

它将所有数据作为单个连续的文本字符串返回。如何在它返回的数据列之间添加换行符？

```
 var data = new ResultsViewModel() 
                        {
                            PatientFollowUpResult = PatientFollowUpResult,
                            PatientFollowUpResultPct = PatientFollowUpResultPct,

                            TotalResponsesResult = TotalResponsesResult,

                            ChangesOthersResult = ChangesOthersResult,

                        }; 
```

查看模型类型

```
@model CMESurvey.ViewModels.ResultsViewModel 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T21:26:47.747

```
<table>
    <tr>
        <th>
            HeaderName1
        </th>
    </tr>

    @foreach (var item in Model)
    {
        <tr>
            <td>
            @Html.DisplayFor(modelItem => modeItem.FieldName)
            </td>
        </tr>
    }
</table> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T21:37:34.353

也许是这样的：

```
@foreach (var x in Model.ChangesOthersResult)
{
   @x<br>
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T21:36:35.307

Razor 不知道您在使用时需要在每个项目之间换行

```
@Html.DisplayFor(modelItem => modelItem.ChangesOthersResult) 
```

您可以通过在选择每个项目之前将字符串添加到每个项目来在选择中添加换行符`"<br/>"`：

```
var ChangesOthersResult = surveyResponseRepository
                             .Query
                             .Select(r => r.ChangesOthers + "<br />"); 
```

# jquery - 当鼠标悬停在“over2”窗格上时，此 jQuery 代码不断向下滑动并向上滑动

> ID：11253119
> 
> 赞同：-2
> 
> 时间：2012-06-28T21:23:33.083
> 
> 标签：jquery

```
$(document).ready(function(){

    $('#li1').mouseover(function(){

        $(".over2").slideDown("slow");
        $(".over").hide();
    });
    $('#li1').mouseout(function(){

        $(".over2").slideUp("fast");
        $(".over").show();
    });
}); 
```

这个的html就在这里！！

```
<li id="li1" class="news_tabs">
   <img src="Images/images.jpg" height="290" width="200" />
   <div class="over">
      <h5>The blackberry Launched in</h5>
   </div>
   <div id="over2" class="over2">
      <p>The total discription The total discription The
        total discription The total
        discription The total discription </p>
   </div>
</li>

<li class="news_tabs"> this is two</li>
<li class="news_tabs">this is three</li>
<li class="news_tabs"> this is four</li> 
```

有一个图像，我想做的是->当用户将鼠标悬停在图像上时，标题隐藏并且简短的描述从顶部滑出，当鼠标移出时，标题再次出现并且描述向上滑动。但是在这里，当鼠标在向下滑动的描述上时，描述一次又一次地上下滑动，直到鼠标退出...请帮助

如何通过此代码阻止无法控制的向下和向上滑动？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T21:39:36.543

我看不到您的 HTML 或演示，所以我不肯定这会解决它，但通常您描述的结果是由使用`mouseover`/`mouseout`而不是`mouseenter`/引起的`mouseleave`。

尝试这个。

```
$(document).ready(function() {

    $('#li1').mouseenter(function() {
        $(".over2").slideDown("slow");
        $(".over").hide();
    });
    $('#li1').mouseleave(function() {
        $(".over2").slideUp("fast");
        $(".over").show();
    });

}); 
```

或者，速记版本使用[`.hover()`](http://api.jquery.com/hover/)...

```
$(document).ready(function() {

    $('#li1').hover(
        function() {
            $(".over2").slideDown("slow");
            $(".over").hide();
        },
        function() {
            $(".over2").slideUp("fast");
            $(".over").show();
        }
    );

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T21:50:32.787

给你：这将适用于你想要
多少元素`li`

## *[jsFiddle 演示](http://jsbin.com/uqemic/2/edit#javascript,html,live)*

```
$(document).ready(function(){

  $('ul.news_tabs li').hover(function(){
    $(this).find('.over').stop().fadeTo(300,0);
    $(this).find('.over2').stop().slideDown();
  },function(){
    $(this).find('.over').stop().fadeTo(300,1);
    $(this).find('.over2').stop().slideUp();    
  });

}); 
```

我也更改了您的 HTML，因为我注意到您打算将每个`li`元素命名为不同的`ID`. 不要那样做。喜欢：

```
<ul class="news_tabs">    
    <li>
       <img src="Images/images.jpg" height="290" width="200" />
       <div class="over">
          <h5>1 The blackberry Launched in</h5>
       </div>
       <div class="over2">
          <p>The total discription The total discription The
            total discription The total
            discription The total discription </p>
       </div>
    </li>

    <li>2</li>
    <li>3</li>
    <li>4</li>

</ul> 
```

# c++ - 如何在文件中打印位而不是字节？

> ID：11253123
> 
> 赞同：4
> 
> 时间：2012-06-28T21:24:03.537
> 
> 标签：c++, file, huffman-code

我正在使用霍夫曼算法开发文件压缩器，现在我面临一个问题：

通过对单词使用算法：stackoverflow，我得到以下结果：

```
a,c,e,f,k,l,r,s,t,v,w = 1 time repeated
o = 2 times repeated

a,c,e,f,k,l,r,s,t,v,w = 7.69231%
and
o = 15.3846% 
```

所以我开始将 then 插入到二叉树中，这将得到结果：

```
o=00
a=010
e=0110
c=0111
t=1000
s=1001
w=1010
v=1011
k=1100
f=1101
r=1110
l=1111 
```

这意味着树中角色的路径，考虑到左边为 0，右边为 1。

那么“stackoverflow”这个词将是：100110000100111010011111000010110110111011011111001010

好吧，我想将整个值放入二进制文件中，以位为单位，这将导致 47 位，恰好是 6 字节，但我只能将其设为 47 字节，因为使用 fwrite 放入文件的最小值或者 fprintf 是 1byte，通过使用 sizeof(something)。

我的问题是：我怎样才能在我的文件中只打印一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-28T21:41:10.163

只需将“标题”写入文件：位数，然后将这些位“打包”成字节填充最后一个。这是一个示例。

```
#include <stdio.h>

FILE* f;

/* how many bits in current byte */
int bit_counter;
/* current byte */
unsigned char cur_byte;

/* write 1 or 0 bit */
void write_bit(unsigned char bit)
{
    if(++bit_counter == 8)
    {
        fwrite(&cur_byte,1,1,f);
        bit_counter = 0;
        cur_byte = 0;
    }

    cur_byte <<= 1;
    cur_byte |= bit;
}

int main()
{
    f = fopen("test.bits", "w");

    cur_byte = 0;
    bit_counter = 0;

    /* write the number of bits here to decode the bitstream later (47 in your case) */
    /* int num = 47; */           
    /* fwrite(num, 1, 4, f); */

    write_bit(1);
    write_bit(0);
    write_bit(0);
    /* etc...  - do this in a loop for each encoded character */
    /* 100110000100111010011111000010110110111011011111001010 */

    if(bit_counter > 0)
    {
         // pad the last byte with zeroes
         cur_byte <<= 8 - bit_counter;
         fwrite(&cur_byte, 1, 1, f);
    }

    fclose(f);

    return 0;
} 
```

当然，要完成完整的霍夫曼编码器，您必须在开始时编写位代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-28T21:35:00.930

这是一种编码问题。问题是文件*只能*包含字节——所以 1 和 0 在文件中只能是“1”和“0”——1 和 0 的字符是字节。

您要做的是将这些位打包成字节，创建一个包含一组字节中的位的文件。您将无法在文本编辑器中打开文件 - 它不知道您想要将每个*位*显示为 1 或 0 *char*，它将显示每个打包字节的结果。不过，您可以使用了解如何处理二进制文件的编辑器打开它。例如，[vim](http://tech.zhenhua.info/2008/03/edit-binary-file-in-vim.html)可以做到这一点。

至于额外的尾随字节或文件结束标记，您将不得不创建某种编码约定。例如，您可以使用额外的零打包和填充，就像您在评论中提到的那样，但按照惯例，前 N 个字节是元数据 - 例如数据长度，文件中有多少位感兴趣。这种事情很常见。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T21:37:43.317

您需要自己管理这一点，通过缓冲要写入的位并仅在您拥有完整字节时才实际写入数据。就像是...

```
 void writeBit(bool b)
 {
   static char buffer=0;
   static int bitcount=0;

   buffer = (buffer << 1) | (b ? 1:0);

   if (++bitcount == 8)
   {
     fputc(buffer); // write out the byte
     bitcount = 0;
     buffer = 0;
   }
 } 
```

以上不是可重入的（并且可能效率很低）-您需要确保以某种方式在最后刷新任何半写的字节，（可能要写一个额外的 7 个零位）但是您应该得到一般主意。

# javascript - 选择框，根据数组中的值禁用值

> ID：11253124
> 
> 赞同：-1
> 
> 时间：2012-06-28T21:24:08.830
> 
> 标签：javascript, jquery, html, arrays

我有一个选择菜单，它为用户提供了一些可以用作搜索过滤器的条件选项，用户可以添加任意数量的过滤器，但是目前用户可以多次添加相同的过滤器.

我想要做的是，当用户从选择框中选择一个过滤器时，该值被添加到一个数组中，然后选择框中的那个选项被禁用，这可能与 javascript & jquery 吗？

目前我有以下

**创建新过滤器选择菜单的代码**

```
$('select.option').live({
  change: function() {
    if($(this).val() == 'distance')
    {
        var element = $(this);
        $.ajax({
            url: site_url + 'ajax/row/distance',
            success: function(data) {
                element.parent().next('td.fillin').html(data);
            }
        });
    }
    else if($(this).val() == 'height')
    {
        var element = $(this);
        $.ajax({
            url: site_url + 'ajax/row/height',
            success: function(data) {
                element.parent().next('td.fillin').html(data);
            }
        });
    }
    else if($(this).val() == 'appearance')
    {
        var element = $(this);
        $.ajax({
            url: site_url + 'ajax/row/appearance',
            success: function(data) {
                element.parent().next('td.fillin').html(data);
            }
        });
    }
    else if($(this).val() == 'education')
    {
        var element = $(this);
        $.ajax({
            url: site_url + 'ajax/row/education',
            success: function(data) {
                element.parent().next('td.fillin').html(data);
            }
        });
    }
    else if($(this).val() == 'children')
    {
        var element = $(this);
        $.ajax({
            url: site_url + 'ajax/row/children',
            success: function(data) {
                element.parent().next('td.fillin').html(data);
            }
        });
    }
    else if($(this).val() == 'smoking')
    {
        var element = $(this);
        $.ajax({
            url: site_url + 'ajax/row/smoking',
            success: function(data) {
                element.parent().next('td.fillin').html(data);
            }
        });
    }
    else if($(this).val() == 'drinking')
    {
        var element = $(this);
        $.ajax({
            url: site_url + 'ajax/row/drinking',
            success: function(data) {
                element.parent().next('td.fillin').html(data);
            }
        });
    }
    else if($(this).val() == 'politics')
    {
        var element = $(this);
        $.ajax({
            url: site_url + 'ajax/row/politics',
            success: function(data) {
                element.parent().next('td.fillin').html(data);
            }
        });
    }
    else if($(this).val() == 'religion')
    {
        var element = $(this);
        $.ajax({
            url: site_url + 'ajax/row/religion',
            success: function(data) {
                element.parent().next('td.fillin').html(data);
            }
        });
    }
    else if($(this).val() == 'ethnicity')
    {
        var element = $(this);
        $.ajax({
            url: site_url + 'ajax/row/ethnicity',
            success: function(data) {
                element.parent().next('td.fillin').html(data);
            }
        });
    }
    else if($(this).val() == 'work')
    {
        var element = $(this);
        $.ajax({
            url: site_url + 'ajax/row/work',
            success: function(data) {
                element.parent().next('td.fillin').html(data);
            }
        });
    }
  }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T21:34:58.120

不知道你的 HTML 是什么样子，但我会让它看起来大致如下：

```
<select class="option">
    <option value="distance" data-path="ajax/row/distance">Distance</option>
    <option value="height" data-path="ajax/row/height">Height</option>
    ...
</select> 
```

然后让jQuery成为（假设一页中有多个选择，并且每行只能应用一次过滤器）：

```
$('select.option').live({
    change: function() {
        // get selected history or empty array
        var selected = $(this).data('selected') || [];

        // get selected option
        var $element = $(this).find('option:selected');

        // if selected option in history, return
        if($.inArray($element.val(), selected) return;

        // otherwise, add to history and save back into element
        selected.push($element.val());
        $(this).data('selected', selected);

        // query AJAX by using the data- attribute of the option
        $.ajax({
            url: site_url + $element.data('path'),
            success: function(data) {
                element.parent().next('td.fillin').html(data);
            }
        });
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T21:33:53.897

由于名称`url`和所选选项相同，您可以尝试以下操作：

```
$('select.option').on({
  change: function() {
        var element = $(this).val();
        $(this).prop('disabled', true);
        $.ajax({
            url: site_url + 'ajax/row/' + element,
            success: function(data) {
                element.parent().next('td.fillin').html(data);
            }
        });
}) 
```

# c# - NHibernate 会话应该如何在 Nancy 中处理每个请求的会话？

> ID：11253126
> 
> 赞同：2
> 
> 时间：2012-06-28T21:24:24.830
> 
> 标签：c#, nhibernate, session-management, nancy

真的，我的问题就在标题中...... NHibernate 会话应该如何在 Nancy 中处理，以便按请求进行会话？如果您对此本身有一个很好的答案，那就去做吧……如果您需要更多背景知识，那就是：

* * *

我习惯于在 ASP.NET MVC 中使用 actionFilter 在 Web 请求的开始和结束时在 NHibernate 上下文中打开和关闭会话。这样，请求上下文中的每个数据库操作都使用相同的会话。

我以为我在使用 Nancy 的新项目中设置了相同类型的东西，但每次需要会话时，都会生成一个新会话。这是我在引导程序中处理会话打开和关闭的方式（继承自 StructureMapBootstrapper）：

```
protected override void RequestStartup(IContainer container, IPipelines pipelines, NancyContext context)
{
    var sessionContainer = container.GetInstance<ISessionContainer>();
    pipelines.BeforeRequest.AddItemToStartOfPipeline(x =>
    {
        sessionContainer.OpenSession();
        return x.Response;
    });
    pipelines.AfterRequest.AddItemToEndOfPipeline(x => sessionContainer.CloseSession());
} 
```

我`ISessionContainer`的基于类似于[此站点](http://www.forkcan.com/viewcode/219/UnitOfWork-Action-filter-for-ASPNET-MVC-and-nHibernate)的内容。我的实现`ISessionContainer`使用 NHibernate 的会话上下文来获取“当前会话”。

现在，当我在我的 Nancy 项目中尝试这个时，每次`ISessionContainer.Session`请求属性时都会返回一个新会话。我认为这是因为 Nancy 默认情况下未启用基于 cookie 的会话，所以我将其添加到我的引导程序中：

```
protected override void ApplicationStartup(IContainer container, IPipelines pipelines)
{
    CookieBasedSessions.Enable(pipelines);
} 
```

没有骰子。每次要求一个新的会话时，我仍然会得到一个新的会话。

但是，真的，我不想诊断我的问题。我宁愿听听在 Nancy 中处理 NHibernate 会话管理的标准方法是什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T06:32:14.437

在我[的 RestBucks 示例的 Nancy 端口中，](https://github.com/horsdal/Restbucks-on-Nancy/)我以每个请求的方式使用 NHibernate。

在该[示例的引导程序中，](https://github.com/horsdal/Restbucks-on-Nancy/blob/master/RestBucks/Bootstrapper.cs)我有以下 NHibernate 设置：

```
protected override void ApplicationStartup(IWindsorContainer container, 
                                           Nancy.Bootstrapper.IPipelines pipelines)
{
  base.ApplicationStartup(container, pipelines);
  pipelines.BeforeRequest += ctx => CreateSession(container);
  pipelines.AfterRequest += ctx => CommitSession(container);
  pipelines.OnError += (ctx, ex) => RollbackSession(container);
  // Other startup stuff 
}

private Response CreateSession(IWindsorContainer container)
{
  var sessionFactory = container.Resolve<ISessionFactory>();
  var requestSession = sessionFactory.OpenSession();
  CurrentSessionContext.Bind(requestSession);
  requestSession.BeginTransaction();

  return null;
}

private AfterPipeline CommitSession(IWindsorContainer container)
{
  var sessionFactory = container.Resolve<ISessionFactory>();
  if (CurrentSessionContext.HasBind(sessionFactory))
  {
    var requestSession = sessionFactory.GetCurrentSession();
    requestSession.Transaction.Commit();
    CurrentSessionContext.Unbind(sessionFactory);
    requestSession.Dispose();
  }
  return null;
 }    

private Response RollbackSession(IWindsorContainer container)
{
  var sessionFactory = container.Resolve<ISessionFactory>();
  if (CurrentSessionContext.HasBind(sessionFactory))
  {
    var requestSession = sessionFactory.GetCurrentSession();
    requestSession.Transaction.Rollback();
    CurrentSessionContext.Unbind(sessionFactory);
    requestSession.Dispose();
  }
  return null;
} 
```

您想要设置 NHibernate 会话的确切方式可能会有所不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T21:53:06.393

DinnerParty 是 Nancy 和 RavenDB 的 NerdDinner 的一个端口，最近由 Ayende 在这里进行了审查[http://ayende.com/blog/156609/reviewing-dinner-party-ndash-nerd-dinner-ported-to-ravendb-on-ravenhq ?key=0c283ada-e5e8-4b7c-b76b-e9d27bfc0bf9](http://ayende.com/blog/156609/reviewing-dinner-party-ndash-nerd-dinner-ported-to-ravendb-on-ravenhq?key=0c283ada-e5e8-4b7c-b76b-e9d27bfc0bf9)

我相信它使用按请求会话，因为我记得指出如何使用自定义模块构建器。看看引导程序和 RavenAwareModuleBuilder

# sql-server - 使用 Log4Net 登录数据库时，出现字段名称而不是值

> ID：11253133
> 
> 赞同：1
> 
> 时间：2012-06-28T21:25:18.557
> 
> 标签：sql-server, log4net, log4net-configuration

我在使用 Log4Net 登录到我的数据库时遇到问题。
我不太确定我的结果是什么。当我应该获取字段的值时，我一直在获取字段名称。

该程序是一个 SystemTray 实用程序。我已将 Log4Net 设置如下。

在大会中：

```
[assembly: log4net.Config.XmlConfigurator(Watch = true)] 
```

在 Program.cs 中：

```
 private static readonly ILog log = LogManager.GetLogger(typeof(Program));

        [STAThread]
        static void Main()
        {
            log4net.Config.XmlConfigurator.Configure(); 
```

在调用类中：

```
public class HostManager
{

    #region constants

        protected static readonly ILog log = LogManager.GetLogger(typeof(HostManager));

        ...

        // Inside an event method:

          try
            {

                log.Info(new Log
                {   
                    CreateDate = DateTime.Now.ToString(),
                    SystemUpTime = FormatUpTime(_states.TimeFromStart),
                    EmotivType = "boredom",
                    EmotivValue = _states.AffectivEngagementBoredomScore.ToString(),
                    EventTimer = _eventTimer,
                    SubEventTimer = _subEventTimer
                });

            } 
```

Log 类只是一堆字符串类型的 getter 和 setter。

而且，我的 app.config 文件带有 log4net 设置：

```
 <log4net>
    <appender name="AdoNetAppender" type="log4net.Appender.AdoNetAppender">

      <bufferSize value="1"/>
      <connectionType value="System.Data.SqlClient.SqlConnection, System.Data, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"/>
      <connectionString value="Data Source=localhost; Initial Catalog=[MyDatabase]; Integrated Security=True;"/>

      <commandText value="INSERT INTO Session ([CreateDate], [SystemUpTime], [EmotivType], [EmotivValue], [EventTimer], [SubEventTimer]) 
                   VALUES (@createdate, @systemuptime, @emotivtype, @emotivvalue, @eventtimer, @subeventtimer)"/>

      <parameter>
        <parameterName value="@createdate"/>
        <dbType value="DateTime"/>
        <layout type="log4net.Layout.RawTimeStampLayout" />
      </parameter>

       <parameter>
        <parameterName value="@systemuptime"/>
        <dbType value="DateTime"/>
        <layout type="log4net.Layout.RawTimeStampLayout"/>
      </parameter>

     <parameter>
    <parameterName value="@emotivtype" />
    <dbType value="String" />
    <size value="50" />
    <layout type="log4net.Layout.PatternLayout">
    <conversionPattern value="%emotivtype" />
  </layout>
  </parameter>

  <parameter>
    <parameterName value="@emotivvalue"/>
    <dbType value="String"/>
    <size value="255"/>
    <layout type="log4net.Layout.PatternLayout">
      <conversionPattern value="%emotivvalue"/>
    </layout>
  </parameter>

      <parameter>
        <parameterName value="@eventtimer"/>
        <dbType value="DateTime"/>
        <layout type="log4net.Layout.RawTimeStampLayout"/>
      </parameter>

      <parameter>
        <parameterName value="@subeventtimer"/>
        <dbType value="DateTime"/>
        <layout type="log4net.Layout.RawTimeStampLayout"/>
      </parameter>

    </appender>
    <root>
      <level value="ALL"/>
      <appender-ref ref="AdoNetAppender"/>
    </root>
  </log4net> 
```

结果是 %emotivtype 和 %emotivalue 总是收到字段名称：

```
ID  CreateDate  SystemUpTime    EmotivType  EmotivValue EventTimer  SubEventTimer
13547   17:06:56.787    17:06:56.787    emotivtype  emotivvalue 17:06:56.787    17:06:56.787 
```

这似乎是一件愚蠢的、可以修复的事情，但它让我无法理解。有什么建议么？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T10:46:07.600

log4net 不知道如何处理您的`Log`课程，因此只需调用`ToString()`它...我想您有两个选择。

第一个选项：
您让您的类返回您对在数据库存储过程中解析的某种格式感兴趣的字段。例如

```
emotivtype|emotivevalue|other fields... 
```

然后为存储过程配置一个参数（您需要一个参数来解析数据库中的上述字符串。

```
<parameter>
    <parameterName value="@emotivvalue"/>
    <dbType value="String"/>
    <size value="255"/>
    <layout type="log4net.Layout.PatternLayout">
       <conversionPattern value="%message"/>
    </layout>
</parameter> 
```

明显的缺点是您无法在文件或控制台中获得体面的输出。有一些方法可以解决这个问题（自定义布局转换器），但我不确定这是否是正确的方法。

第二种选择：
您可以使用所谓的上下文属性（这是一个很好的[教程](http://www.beefycode.com/post/Log4Net-Tutorial-pt-6-Log-Event-Context.aspx)）。特别是查看“计算的上下文值”。我不确定我应该写些什么……也许如果您对此有具体问题，我可以回答。

# javascript - 如何检查评估名称是否未定义

> ID：11253140
> 
> 赞同：9
> 
> 时间：2012-06-28T21:25:47.300
> 
> 标签：javascript, html

我有一个基本上是计算器的表格。你可以输入一个方程，它会计算它。我还有 2 个内存字段（名为 m1 和 m2 的文本框），您可以在其中输入一些内容，它将保存该值，然后当您在第一个框中输入表达式时，您可以在等式中引用 m1 或 m2 它将使用您在内存字段中输入的数字进行评估。

问题是如果您尝试在方程式中引用 m1 或 m2 并且文本框为空白，则会出现未定义的错误。

我已经旋转了几个小时来尝试进行某种检查，如果等式被评估为未定义，则只显示一个弹出框。我在**原始 javascript**中需要这个。任何帮助表示赞赏。

```
function displayResult(thisElement)
{
    thisElement.value = eval(thisElement.value); <!-- this line throws the error if you use m1 and no m1 is defined, m2 and no m2 is defined, etc -->
    if(!(thisElement.value>0))
    {
        thisElement.value=0;
    }
}

function mem(v) 
{
    v.value = eval(v.value);
    eval(v.name+"="+v.value);
}

<input id="calcFormula" name="calculate" size="40" />
<input type="submit" value="Calculate" onclick="displayResult(this.form.calculate);" />

<input name="m1" id="m1" size="12" onchange="mem(this);" value="0" />
<input name="m2" id="m2" size="12" onchange="mem(this);" value="0" /> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-28T21:50:24.647

我可以想到三个解决方案：

1.  您可以假设空 m1/m2 表示 0，因此永远不会有未定义的值。这确实简化了事情。
2.  您可以使用正则表达式首先检查方程中是否出现 m1 或 m2，如果存在，则检查是否未定义。
3.  但最好的方法是使用[try...catch](https://developer.mozilla.org/en-US/docs/web/JavaScript/Reference/Statements/try...catch)。

尝试/捕获示例：

```
try {
    eval('12+3+m1');
} catch (e) {
    alert(e.message);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T21:54:31.610

eval 失败，因为它需要从表单字段加载数据，但 m1 不是表单字段的访问键。并且 m1 不是全局变量，因此失败。创建 2 个全局变量，并让 m1 和 m2 表单在更改时将它们的值存储在其中。

您的原始脚本失败，因为您的函数评估 m1 和 m2，但是当函数结束时它们被销毁，因为它们不是全局范围

```
 function displayResult(thisElement) {    thisElement.value = eval(thisElement.value); <!--  this line throws the error if you use m1 and no m1 is defined, m2 and no m2 is defined, etc --> if(!(thisElement.value>0)) { thisElement.value=0; }    }
m1=0;
m2=0;

<input id="calcFormula" name="calculate" size="40" /> <input type="submit" value="Calculate" onclick="displayResult(this.form.calc ulate);" />

<input name="m1" id="m1" onchange="m1=this.value" size="12" value="0" /> <input name="m2" id="m2" size="12" onchange="m2=this.value;" value="0" /> 
```

为什么您的原始代码失败：

```
Step 1\. M1 is stored in the form.
step 2\. Onchange event is fired
step 3\. Function mem(this) is called
step 4\. Entering scope of function mem
step 5\. Inserting this.name into string
step 6\. Inserting this.value into string
Step 7\. evalling string
step 7.1 found code m1=1
step 7.1.1 check window object for variable named m1
step 7.1.1.1 failed. Create local variable for function mem called m1
step 7.1.1.2 assign value 1 to scope variable m1
step 7.1.1.3 exit eval
step 7.1.1.4 exit function mem(this)
step 7.1.1.5 check for scoped variables
step 7.1.1.6 scoped variable found m1
step 7.1.1.7 destroy scoped variable and free up memory
step 7.1.2.2 passed. retrieve pointer to window object variable m1
step 7.1.2.3 assign value 1 to window.m1
step 7.1.2.4 exit eval
step 7.1.2.5 exit function mem(this)
step 7.1.2.6 check for scoped variables
step 7.1.2.7 none found, resume other tasks. 
```

# javascript - Facebook Javascript SDK FB 未定义

> ID：11253144
> 
> 赞同：0
> 
> 时间：2012-06-28T21:25:54.847
> 
> 标签：javascript, facebook, sdk, undefined

尝试使用 Facebook JS SDK 时，我一直遇到错误`FB undefined`。当我通过 IE 上的 JavaScript 调试器观看它时，它在页面加载期间正确运行，然后最后它只是未定义并且没有订阅触发的事件。目标：让页面标签刷新最顶层的页面，通过扇门。

关于我在这里缺少什么的任何想法？

代码：

```
<div id="fb-root"></div>
 <script>

  window.fbAsyncInit = function(){

 FB.init({

 appId : 'APP CODE INSERTED HERE',

 status : true, // check login status

 cookie : true, // enable cookies to allow the server to access the session

 xfbml : true, // parse XFBML

 channelUrl : 'URL to Channel .ASPX'

 });

 // Additional initialization code here

     FB.Event.subscribe('edge.create',

     function(response){

    top.location.href = 'Page to refreshed inserted here';
     });

 };

(function(d) 
{
var js, id = 'facebook-jssdk'; 
if (d.getElementById(id)) {return;}
 js = d.createElement('script'); js.id = id; js.async = true;

 js.src = "//connect.facebook.net/en_US/all.js";

 d.getElementsByTagName('head')[0].appendChild(js);

 }(document)
);

</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T21:45:30.340

[您用于异步加载 SDK 的 JavaScript 与Facebook SDK](http://developers.facebook.com/docs/reference/javascript/)文档当前显示的内容不匹配。见下文：

```
// Load the SDK Asynchronously   
(function(d){
      var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
      if (d.getElementById(id)) {return;}
      js = d.createElement('script'); js.id = id; js.async = true;
      js.src = "//connect.facebook.net/en_US/all.js";
      ref.parentNode.insertBefore(js, ref);
}(document)); 
```

加载 SDK 的两个 JavaScript 块非常相似。您的 JavaScript 使用：

```
d.getElementsByTagName('head')[0].appendChild(js); 
```

加载 SDK。FB 记录的最新版本使用：

```
ref = d.getElementsByTagName('script')[0];
ref.parentNode.insertBefore(js, ref); 
```

您的版本通过附加到 HEAD HTML 标记来添加源引用以加载 FB JavaScript。最新版本通过查找第一个 SCRIPT 引用并在该引用之前插入 FB 引用来做到这一点。

也许您的问题是由这两种方法之间的细微差别引起的。

排除这种情况的一种方法是通过将以下 HTML 放入页面标题中来临时硬编码同步加载 FB JavaScript：

```
<head>
<script type="text/javascript" src="http://connect.facebook.net/en_us/all.js"></script>
.
.
.
</head> 
```

# c# - 属性或变量更改值时触发事件

> ID：11253147
> 
> 赞同：3
> 
> 时间：2012-06-28T21:26:24.247
> 
> 标签：c#, events, variables, properties, inotifypropertychanged

我想向我拥有的项目添加更多功能，该项目使用 NET Framework 中打包的许多类。这些相同的类提供了许多属性，这些属性对于适应我的项目的功能非常有用，但是这些类缺少的一件事是事件。

如果每个属性都有一个适当的事件，该事件会在此类属性的值更改时触发，然后我可以分配一个事件处理程序，该处理程序将根据这些属性值进行操作。

我在下面制作了一个示例案例，以我能想到的最简单的方式来说明我的目标。

> **示例案例：**
> 
> 该类`System.Net.Sockets.Socket`（[MSDN Docs 上的 Socket](http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.aspx)）有一个名为的属性`Connected`，如果套接字连接到指定的端点，则该属性基本上返回 true，否则返回 false。
> 
> 我想要完成的很简单。我想将此属性保留在“监视”下，当它的值发生变化时，触发一个事件。

[对我自己的一个类执行此操作会很简单，尽管使用INotifyPropertyChanged 接口](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.propertychanged.aspx)有点令人厌烦，因为总是因为我的代码更改了属性的值，所以我必须手动触发事件。不幸的是，据我所知，即使是这种过程也不能应用于`Socket`NET Framework 中分布的现有类。

好吧，这个问题变得相当广泛，抱歉，但我希望它对我的目标有所帮助。

现在简单地说，我想观察类的`Connected`属性，`Socket`当它的值发生变化时，触发一个事件。如果也可以使用这种方法来观察变量和属性，那将是非常棒的，不仅对我来说，而且对于在 SO 上偶然发现这个问题的每个人来说都是如此。

当然，一种简单而轻量级的方法是首选，但最重要的是，我想了解它是如何完成的，所以将来我可以将它大规模应用于其他类。

我意识到我问了很多。非常感谢。

*任何问题都可以问。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T23:06:59.837

我实现了一个应该让你开始的基本类。我敢肯定，一个功能齐全、生产就绪、线程安全的类需要做更多的工作，而且您需要实施自己的策略来确定何时轮询值更改。

```
public class TargettedObserver<T>
{
    private static readonly EqualityComparer<T> EqualityComparer = EqualityComparer<T>.Default;

    private Func<T> ValueTarget;
    private T OldValue;

    public event ObservedValueChangedEventHandler<T> ValueChanged;

    public TargettedObserver(Func<T> valueTarget)
    {
        this.ValueTarget = valueTarget;
        OldValue = ObtainCurrentValue();
    }

    public bool CheckValue()
    {
        T oldValue = OldValue;
        T newValue = ObtainCurrentValue();

        bool hasValueChanged = CompareValues(oldValue, newValue);

        if (hasValueChanged)
        {
            OldValue = newValue;
            NotifyValueChanged(oldValue, newValue);
        }

        return hasValueChanged;
    }

    private void NotifyValueChanged(T oldValue, T newValue)
    {
        var valueChangedEvent = ValueChanged;
        if (valueChangedEvent != null)
            valueChangedEvent(this, new ObservedValueChangedEventArgs<T>(oldValue, newValue));
    }

    private static bool CompareValues(T oldValue, T newValue)
    {
        return !EqualityComparer.Equals(oldValue, newValue);
    }

    private T ObtainCurrentValue()
    {
        return ValueTarget();
    }
} 
```

和事件处理：

```
public class ObservedValueChangedEventArgs<T> : EventArgs
{
    public T OldValue { get; private set; }
    public T NewValue { get; private set; }

    public ObservedValueChangedEventArgs(T oldValue, T newValue)
    {
        this.OldValue = oldValue;
        this.NewValue = newValue;
    }
}

public delegate void ObservedValueChangedEventHandler<T>(TargettedObserver<T> observer, ObservedValueChangedEventArgs<T> eventArgs); 
```

用法如下所示：

```
public class TestClass
{
    private Socket MySocket;
    private static TargettedObserver<bool> SocketConnectedObserver;

    public void Main()
    {
        MySocket = new Socket();
        SocketConnectedObserver = new TargettedObserver<bool>(() => MySocket.Connected);
        SocketConnectedObserver.ValueChanged += ReportSocketConnectedStateChanged;
        PerformSocketConnection();

        MainThread.Invoke(PollSocketValue);
    }

    private void PollSocketValue()
    {
        SocketConnectedObserver.CheckValue();
        MainThread.Invoke(PollSocketValue);
    }

    private void ReportSocketConnectedStateChanged(TargettedObserver<bool> observer, ObservedValueChangedEventArgs<bool> eventArgs)
    {
        Console.WriteLine("Socket connection state changed!  OldValue: " + eventArgs.OldValue + ", NewValue: " + eventArgs.NewValue);
    }
} 
```

请注意，构造函数采用一个简单的 lambda 表达式，可以计算您想要观察的值。

另请注意，这`MainThread.Invoke`只是一个伪代码，显示它轮询每个主线程循环的更改。例如，我确信有更好的策略（具有计时器间隔的后台线程）可以以一种很好的、​​可重用的方式实现。在注销观察者方面还有更多工作要做。可能会创建一些不错的工厂方法或 lambda 委托，因此您不需要保持 TargettedObserver 实例浮动并减少接线/手动代码的数量。但至少这应该是一个开始。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T21:40:21.857

您正在寻找的是[Observer Pattern](http://en.wikipedia.org/wiki/Observer_pattern)的实现。像[这样的`Observable<T>`实现](http://www.codeproject.com/Articles/85928/Observable-Automatically-Notify-Property-Owner-Whe)可能会起作用。

另请参阅.NET 4 中的[`IObserver<T>`接口：](http://msdn.microsoft.com/en-us/library/dd783449.aspx)

> 和接口为基于推送`IObserver<T>`的`IObservable<T>`通知提供了一种通用机制。`IObservable<T>`接口代表发送通知的类（提供者）；`IObserver<T>`接口代表接收它们的类（观察者）。`T`表示提供通知信息的类。

# xcode - 核心图像帮助：通过 UIImagePicker 从 UIImage 设置 CIImage（然后过滤它）

> ID：11253148
> 
> 赞同：0
> 
> 时间：2012-06-28T21:26:29.427
> 
> 标签：xcode, ios5, filtering, core-image

在 SO 上四处寻找答案。发现了一些有趣的东西，但我仍然卡住了。

在视图控制器中，我有一个 UIImageView，我在视图加载时设置了从 UIImagePicker 获取的图像。（我也同时设置了一个CIImage）

我有两个滑块（一个用于亮度，一个用于对比度）。移动滑块后，对 CIImage 应用过滤器，然后将 CIImage 渲染到 UIImageView 的 UIImage 中。

拳头，从 UIImagePicker 获取的 UIImage 确实在第一次选择时正确显示。

我还正确设置了我的滑块范围，并验证了正确的浮点值正在传递给委托函数（通过 NSLog）。

但是，当我尝试使用滑块时，我的 UIImageView 变白了！也许你们可以帮忙。我将发布一些代码片段：

首先，我的@interface：

```
@interface PrepViewController : UIViewController <UIImagePickerControllerDelegate , UINavigationControllerDelegate>

@property (weak, nonatomic) IBOutlet UIImageView *editingImage;
@property (weak, nonatomic) CIImage *editingCIImage;
@property (weak, nonatomic) CIContext *editingCIContext;
@property (weak, nonatomic) CIFilter *editingCIFilter;
@property (nonatomic) BOOL didAskForImage;
@property (weak, nonatomic) IBOutlet UISlider *brightnessSlider;
@property (weak, nonatomic) IBOutlet UISlider *contrastSlider;

- (void) doImageFilter:(NSString *)filter withValue:(float)value;

@end 
```

我的 viewDidLoad，非常简单，只是将 didAskForImage 设置为 NO

```
- (void)viewDidLoad
{

    [super viewDidLoad];

    self.didAskForImage = NO;

} 
```

viewDidAppear 是我检查我是否已经请求图像的地方，然后请求它

```
- (void)viewDidAppear:(BOOL)animated{

[super viewDidAppear:animated];

if(!self.didAskForImage){

    UIImagePickerController *picker = [[UIImagePickerController alloc] init];

    picker.delegate = self;
    picker.allowsEditing = NO;

    UIImagePickerControllerSourceType sourceType = UIImagePickerControllerSourceTypePhotoLibrary;

    if ([UIImagePickerController isSourceTypeAvailable:UIImagePickerControllerSourceTypeCamera]) {
        sourceType = UIImagePickerControllerSourceTypeCamera;
    }

    picker.sourceType = sourceType;

    [self presentModalViewController:picker animated:YES];

}

} 
```

这是 imagePickerController didFinishPickingImage 委托方法，这是我实际设置 UIImageView 的图像属性并初始化 CIImage、CIContext 和 CIFilter 对象的地方。

我还设置了 didAskForImage 布尔值和滑块目标。

```
-(void)imagePickerController:(UIImagePickerController *)picker
  didFinishPickingImage : (UIImage *)image
             editingInfo:(NSDictionary *)editingInfo
{

self.didAskForImage = YES;

self.editingImage.image = image;

self.editingCIImage = [[CIImage alloc] initWithImage:image];
self.editingCIContext = [CIContext contextWithOptions:nil];

self.editingCIContext = [CIContext contextWithOptions:nil];
self.editingCIFilter = [CIFilter filterWithName:@"CIColorControls" keysAndValues:kCIInputImageKey, self.editingCIImage, nil];

[self.contrastSlider addTarget:self action:@selector(contrastMove:) forControlEvents:UIControlEventValueChanged];

[self.brightnessSlider addTarget:self action:@selector(brightnessMove:) forControlEvents:UIControlEventValueChanged];

[picker dismissModalViewControllerAnimated:YES];
} 
```

和取消代表

```
-(void)imagePickerControllerDidCancel:(UIImagePickerController *)  picker
{
[picker dismissModalViewControllerAnimated:YES];
picker = nil;
[self.navigationController popToViewController:[self.navigationController.viewControllers objectAtIndex:0] animated:YES];

} 
```

这是滑块的委托方法。同样，NSLogs 显示预期值。

```
- (void) contrastMove:(id)sender{

NSLog(@"%f", [(UISlider *)sender value]);

[self doImageFilter:@"inputContrast" withValue:[(UISlider *)sender value]];

}

- (void) brightnessMove:(id)sender{

NSLog(@"%f", [(UISlider *)sender value]);

[self doImageFilter:@"inputBrightness" withValue:[(UISlider *)sender value]];

} 
```

最后，这是我创建的 doImageFilter 方法，它实际上*执行*过滤器并重新分配 UIImageView（这是它变白的地方）

```
- (void) doImageFilter:(NSString *)filter withValue:(float)value{

[self.editingCIFilter setValue:[NSNumber numberWithFloat:value] forKey:filter];

CIImage *output = [self.editingCIFilter outputImage];
CGImageRef cgi = [self.editingCIContext createCGImage:output fromRect:[output extent]];

self.editingCIImage = output;
self.editingImage.image = [UIImage imageWithCGImage:cgi];

} 
```

所以我有一种预感，CIImage 甚至没有被正确初始化。但我不知道*为什么*。已经在这里待了几个小时了。

感谢你的帮助！

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T23:47:55.683

哈哈哈，哇哦。

所以我想通了，我的 CIContext 和 CIFilter 需要设置为强而不是弱。

惊人的。

# hadoop - 如何在不卸载和重新安装的情况下删除 HBase 中的所有数据和元数据？

> ID：11253150
> 
> 赞同：4
> 
> 时间：2012-06-28T21:26:35.290
> 
> 标签：hadoop, hbase, hdfs, recovery, repair

在我的开发盒上以伪分布式模式运行 HBase。Cloudera CDH4。中央操作系统。

不知何故，我的 HBase 安装已完全损坏。我运行了这个命令：

./bin/hbase hbck -repairHoles

读数以这个结束：

```
Summary:
  -ROOT- is okay.
    Number of regions: 1
    Deployed on:  localhost.localdomain,60020,1340917622717
  .META. is okay.
    Number of regions: 1
    Deployed on:  localhost.localdomain,60020,1340917622717
5 inconsistencies detected. 
```

在这里查看文档：

[http://hbase.apache.org/book/apbs03.html](http://hbase.apache.org/book/apbs03.html)

它是这样说的：如果在这些步骤之后仍然存在不一致，则很可能存在与孤立或重叠区域相关的表完整性问题。

基本上，我没有兴趣深入研究并尝试解决这个问题。我想彻底摧毁我的 HBase 安装并重新开始。但是，我不想卸载/重新安装，因为我们使用 Cloudera，我不想弄乱他们整个奇怪的配置和设置。

有没有办法在不卸载和重新安装的情况下删除 HBase 中的所有数据和元数据？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T01:20:14.170

我不建议这样做，除非您处于不归路。

我不知道这是否是核对 hbase 数据的正确方法，但是当我遇到这种不一致时，我通常会删除包含 hbase 数据的目录的所有内容。所以这个地方会在 hbase-site.xml 中寻找以下属性
`hbase.rootdir`

一旦系统在我的本地开发机器上稳定下来，我就没有使用过这种方法。通常，如果我在关闭系统之前正确关闭了集群，那么我不会遇到此类问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-08-15T11:33:49.447

上面的答案不是全部，我今天用我的 hbase 发现了这个。如果您使用 zookeepers，您还需要删除 zookeeper 保存的那些数据，正如我在这个问题中发布的那样 [https://stackoverflow.com/a/51857841/8428146](https://stackoverflow.com/a/51857841/8428146)

# android - 让 chartengine 在轴的顶部绘制

> ID：11253159
> 
> 赞同：0
> 
> 时间：2012-06-28T21:27:20.150
> 
> 标签：android, achartengine

截至目前，如果我有一个水平或垂直的折线图值，并且恰好是网格线之一的确切值，那么它就变得很难看到。有什么方法可以改变事物绘制方式的 Z 顺序，以便所有内容都绘制在网格线上？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T08:30:59.663

不，没有这样的 API。但是，您可以使用颜色，例如设置网格线颜色、轴颜色的一些透明度级别。

# wpf - WPF用户控件绑定获取数据

> ID：11253162
> 
> 赞同：0
> 
> 时间：2012-06-28T21:27:58.723
> 
> 标签：wpf, binding, user-controls

我是 WPF 和绑定东西的新手。我试图找到解决我的问题的方法，但仍然缺少一些东西；/我想从 UserControl 中的 TextBox 获取数据，并将其放入主窗口中的属性中，以使其正常工作，但其他不是 ;/

我有一个简单的课程

```
public class User
{
    public string Name {get; set;}
    public string Age {get; set;}
} 
```

和一个名为 UserDetails 的简单用户控件，带有两个 TextBox

```
<TextBox Text="{Bind Name}" />
<TextBox Text="{Bind Age}" /> 
```

UserDetails UC 放置在主窗口上，如下所示：

```
<uc:UserDetails DataContext="{Binding User, Mode=TwoWay}" /> 
```

在 MainWindow ViewModel 我有一个属性

```
public User User { get; set;} 
```

在 MainWindow 上还有一个按钮，单击时应使用来自 UserDetials UC 的数据填充 User 属性。现在已经很晚了，我需要在早上完成它，所以任何直接的解决方案都会受到赞赏。

任何想法如何做到这一点？上面的例子很简单，但是如果你能告诉我怎么做，我可以处理剩下的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T22:06:54.407

以下是一些可以尝试的事情：

*   确保将视图模型设置为 MainWindow 的 DataContext。即使您没有为视图模型使用单独的类而只是使用代码隐藏，您也需要分配 DataContext。
*   这可能只是一个错字，但在你的文本框中，你已经写`{Bind Name}`了应该`{Binding Path=Name, Mode=TwoWay}`和时代一样的时间。您需要在属性上将绑定模式设置为两种方式，而不是在示例中的类上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T23:36:44.680

您需要实现 INotifyPropertyChanged 接口并在属性设置器中触发 PropertyChanged 事件。你需要为你`MainViewModel`和`User`班级做这件事。这是如何完成的[示例](http://msdn.microsoft.com/en-us/library/ms229614.aspx)。

# asp.net - onload 事件和最终 HTTP 响应的区别？

> ID：11253164
> 
> 赞同：0
> 
> 时间：2012-06-28T21:28:31.453
> 
> 标签：asp.net, performance, http, onload

我正在努力优化我的网站的性能，并且对一些时间问题感到困惑。

使用 Firebug 和 Page Speed 我得到了类似的`onload`(Firebug) 或`pageLoadTime`(Page Speed) 读数。我假设这个时间是在 onload 事件触发时进行的。

我也一直在使用 Fiddler 来分析站点，并且“序列持续时间”（从请求开始到响应完成的时间）总是大于“onload”和“pageLoadTime”时间。

首先，它们为什么不同？其次，在尝试优化我的网站时，我应该更关注哪一个？我正在尝试最小化和加速 HTTP 请求。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T20:17:39.533

onload 事件在浏览器完成加载 HTML 中定义的所有内容后触发，包括任何 iFrame 和 Javascript 附加到页面的元素。

在 onload 处理程序中或之后执行生成额外网络活动（如分析信标、幻灯片放映等）的 javascript 并不罕见。浏览器通常也会在 onload 之后立即请求 favicon，这也可能会影响 fiddler 的测量值。

至于您应该关注什么，这将取决于您的网站以及对用户体验重要的内容。如果您有一个电子商务风格的网站，那么您可能会关心首屏结果可见的时间点，并且它可能根本无法跟踪加载时间。

# .net - ODATA URI 查询从 FK 扩展到 PK

> ID：11253172
> 
> 赞同：1
> 
> 时间：2012-06-28T21:29:02.363
> 
> 标签：.net, odata, wcf-data-services

拥有来自 ADO.NET 实体数据模型的 WCF 数据服务

三张桌子

```
docSVsys: PK ID 
          ,sValue

docSVtext: composite PK sID, fieldID 
           ,mValue

        sID has FK relation to docSVsys,ID
        fieldID has FK Relation to docFieldDef.ID

docFieldDef PK, ID
            ,fName 
```

docFieldDef 是一个小型半静态表，将 fieldID 与字段名称相关联

可以从 PK 扩展到 FK - 这行得通

```
 http://localhost:64638/WcfDataService1.svc/docSVsys(1)?$expand=docSVtext 
```

无法从此 FK 扩展到 PK - 这失败了。我可以做这个工作吗？

```
 http://localhost:64638/WcfDataService1.svc/docSVtext?$top=1&$expand=docFieldDef 
```

SO 不是为了评论，而是。ODATA 和 EF 是很好的工具。这只是很多没有映射到自动化模型中的数据。我只是添加了一些特定的 WCF 服务，而不是实现 ODATA。

未能成功拦截 .NET 代码中的 TSQL，但能够使用 SSMS Profiler 捕获 TSQL。这是一个有效（但格式错误）的查询超时。它从一个有 330 万条记录的表连接到一个有 100 条记录的表，然后处理前 1 条记录。在 330 万条表上，连接是复合键的第二个 int。连接甚至不是直接的 - 连接是通过子查询。重构为直接连接和仍然很长的查询 (2:30)。排序顺序是 PK 的第二个组成部分，然后是第一个（较大的表）。将排序顺序更改为第一个组件，第二个组件，查询变为 0（瞬时）。两个排序顺序仍然具有相同的查询计划。这也是一个带有 UI 的应用程序，任何查询都不会超过 1 秒，但都是手工制作的 TSQL。

想要一个 ODATA 接口，但既需要限制查询类型，又需要手工制作 TSQL。可以走自定义数据服务提供者的路径并实现 iQueryable 但这非常困难并且不能解决限制查询类型的第一个问题（不允许愚蠢的查询）。有没有办法兼容 ODATA 但限制查询类型（并制作 TSQL）。此应用程序的 ODATA 的目的是根据一些非常简单的标准导出大量数据。

有趣的是这个作品

```
 http://localhost:64638/WcfDataService1.svc/docSVtext(fieldID=101,sID=1)?$expand=docFieldDef 
```

这有效（FK 回到 PK）

```
 http://localhost:64638/WcfDataService1.svc/docSVtext?$top=1&$expand=docSVsys
  (this may be a config issue - will review the keys - keys relationships look in order)
  The only difference I see it that is where it walks the name of the key was the same  in the two tables and where it failed the name of the key changed. 
```

这可行，但按此顺序查看此数据没有价值

```
 http://localhost:64638/WcfDataService1.svc/docFieldDef?$top=1&$expand=docSVtext 
```

失败的提琴手

```
> # Result  Protocol    Host    URL Body    Caching Content-Type    Process Comments    Custom  
> 6 500 HTTP    localhost:64638 /WcfDataService1.svc/docSVtext?$top=1&$expand=docFieldDef   250 no-cache
>   application/xml iexplore:3188            GET
> /WcfDataService1.svc/docSVtext?$top=1&$expand=docFieldDef HTTP/1.1
> Accept: text/html, application/xhtml+xml, */* Accept-Language: en-us
> User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.0;
> Trident/5.0) Accept-Encoding: gzip, deflate Connection: Keep-Alive
> Host: localhost:64638 Cookie:
> ASP.NET_SessionId=l1qpumn5xuopnsyapavocw3a
> 
> 
> HTTP/1.1 500 Internal Server Error Server: ASP.NET Development
> Server/10.0.0.0 Date: Thu, 28 Jun 2012 23:03:32 GMT X-AspNet-Version:
> 4.0.30319 DataServiceVersion: 1.0; Content-Length: 250 Cache-Control: no-cache Content-Type: application/xml Connection: Close
> 
> <?xml version="1.0" encoding="utf-8" standalone="yes"?> <error
> xmlns="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata">
> <code></code>   <message xml:lang="en-US">An error occurred while
> processing this request.</message> </error> 
```

根据 MarkStaffo 的请求打开详细信息。命令：

```
http://localhost:64638/WcfDataService1.svc/docSVtext?$top=1&$expand=docFieldDef 
```

标记超时部分没有意义，因为它（假设）对 PK 击中一个小桌子。

```
<?xml version="1.0" encoding="UTF-8" standalone="true"?>
-<error xmlns="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata"> <code/> <message xml:lang="en-US">An error occurred while processing this request.</message> -<innererror> <message>An error occurred while executing the command definition. See the inner exception for details.</message> <type>System.Data.EntityCommandExecutionException</type>
<stacktrace> at System.Data.EntityClient.EntityCommandDefinition.ExecuteStoreCommands(EntityCommand entityCommand, CommandBehavior behavior) at System.Data.Objects.Internal.ObjectQueryExecutionPlan.Execute[TResultType](ObjectContext context, ObjectParameterCollection parameterValues) at System.Data.Objects.ObjectQuery`1.GetResults(Nullable`1 forMergeOption) at System.Data.Objects.ObjectQuery`1.System.Collections.Generic.IEnumerable<T>.GetEnumerator() at System.Data.Services.Providers.BasicExpandProvider.ExpandedQueryable`1.GetEnumerator() at System.Data.Services.Providers.BasicExpandProvider.ExpandedQueryable`1.System.Collections.IEnumerable.GetEnumerator() at System.Data.Services.WebUtil.GetRequestEnumerator(IEnumerable enumerable) at System.Data.Services.DataService`1.SerializeResponseBody(RequestDescription description, IDataService dataService) at System.Data.Services.DataService`1.HandleNonBatchRequest(RequestDescription description) at System.Data.Services.DataService`1.HandleRequest()</stacktrace> -<internalexception> <message>Timeout expired. The timeout period elapsed prior to completion of the operation or the server is not responding.</message> <type>System.Data.SqlClient.SqlException</type> <stacktrace> at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection) at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection) at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning() at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj) at System.Data.SqlClient.SqlDataReader.ConsumeMetaData() at System.Data.SqlClient.SqlDataReader.get_MetaData() at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString) at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async) at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result) at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method) at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method) at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior) at System.Data.Common.DbCommand.ExecuteReader(CommandBehavior behavior) at System.Data.EntityClient.EntityCommandDefinition.ExecuteStoreCommands(EntityCommand entityCommand, CommandBehavior behavior)</stacktrace> </internalexception> </innererror> </error> 
```

如果您在另一个选项卡中打开图像，您可以缩放。 ![在此处输入图像描述](../Images/6e97b65d8e46516278dacb84a49af41d.png)

# uitableview - Gilt Group iPhone 应用程序中的水平菜单滚动是如何工作的？

> ID：11253173
> 
> 赞同：1
> 
> 时间：2012-06-28T21:29:11.480
> 
> 标签：uitableview, uiscrollview, horizontalscrollview

Gilt iPhone 应用程序使用 UIScrollView 和 UIPageControl 来翻阅他们的内容，但我想知道他们如何在顶部实现水平滚动菜单。

![在此处输入图像描述](../Images/4c38a8e8116ed9915afad00681219189.png)

它是旋转-90 度的 UITableView 吗？它如何知道中心项目应该设置为选中？它是带有按钮的 UIScrollView，也许您检查按钮是否在某个区域中，它选择该按钮并使用 scrollToRect 方法？

有没有人有这方面的经验？

# c# - 覆盖 RadTreeView 中的 TriStateCheckboxes 行为

> ID：11253174
> 
> 赞同：0
> 
> 时间：2012-06-28T21:29:15.870
> 
> 标签：c#, javascript, asp.net, telerik, radtreeview

RTV 的 TriStateCheckboxes 在检查时的默认行为是检查节点的所有子节点并将祖先设置为不确定。我想覆盖此行为以仅将祖先设置为不确定，而不检查子代。

到目前为止，我已经尝试将 CheckChildNodes 设置为 false 并取消 ClientNodeChecking 事件以自己设置节点和祖先值，但是以编程方式设置节点值无论如何都会调用默认行为。

有什么办法可以克服这个吗？

# iis-7.5 - Powershell IIS 日志分析

> ID：11253184
> 
> 赞同：1
> 
> 时间：2012-06-28T21:30:06.030
> 
> 标签：iis-7.5, powershell-2.0

我几乎完成了这个 Powershell 脚本，但我被困在最后一部分，并且在最后一步真的可以使用一些帮助。以下是我迄今为止编写的 PS 脚本

```
$t1 =(get-date).AddMinutes(-10)
$t2 =$t1.ToUniversalTime().ToString("HH:mm:ss")
$IISLogPath = "C:\inetpub\logs\LogFiles\W3SVC1\"+"u_ex"+(get-date).ToString("yyMMdd")+".log" 
$IISLogFileRaw = [System.IO.File]::ReadAllLines($IISLogPath) 
$headers = $IISLogFileRaw[3].split(" ") 
$headers = $headers | where {$_ -ne "#Fields:"}
$IISLogFileCSV = Import-Csv -Delimiter " " -Header $headers -Path $IISLogPath
$IISLogFileCSV = $IISLogFileCSV | where {$_.date -notlike "#*"}
$timeTaken = $IISLogFileCSV | where {$_.("cs-uri-stem") -eq '/Login.aspx' -AND $_.("time") -gt '$t2' } | Format-Table time,s-ip 
```

所以基本上它会查看当前的 IIS 日志，并在用户在过去 10 分钟内进入登录页面时进行过滤。我坚持的部分是我想在这 10 分钟内收到超过 10 次 IP 的电子邮件（基本上是在发生蛮力攻击时收到警报）。我编写的代码的电子邮件部分只需要说明当 s-ip 命中 /login.aspx 超过 10 次时的部分。同样在我的“测试箱”中，我已经改变`$t2`并`$IISLogPath`成为以下

```
$t2 = 20:00:00
$IISLogPath = C:\test\log.log 
```

下面是我的示例日志文件：

```
#Software: Microsoft Internet Information Services 7.5
#Version: 1.0
#Date: 2012-06-27 15:05:24
#Fields: date time s-ip cs-method cs-uri-stem cs-uri-query s-port cs-username c-ip cs(User-Agent) sc-status sc-substatus sc-win32-status time-taken
2012-06-27 20:32:35 ::1 GET /Login.aspx - 80 - ::1 Mozilla/5.0+(Windows+NT+6.1;+WOW64;+rv:13.0)+Gecko/20100101+Firefox/13.0.1 500 0 0 24240
2012-06-27 20:32:35 ::1 GET /Login.aspx - 80 - ::1 Mozilla/5.0+(Windows+NT+6.1;+WOW64;+rv:13.0)+Gecko/20100101+Firefox/13.0.1 500 0 0 24240
2012-06-27 20:32:35 ::1 GET /Login.aspx - 80 - ::1 Mozilla/5.0+(Windows+NT+6.1;+WOW64;+rv:13.0)+Gecko/20100101+Firefox/13.0.1 500 0 0 24240
2012-06-27 20:32:35 ::1 GET /Login.aspx - 80 - ::1 Mozilla/5.0+(Windows+NT+6.1;+WOW64;+rv:13.0)+Gecko/20100101+Firefox/13.0.1 500 0 0 24240
2012-06-27 21:32:35 ::1 GET /Login.aspx - 80 - ::1 Mozilla/5.0+(Windows+NT+6.1;+WOW64;+rv:13.0)+Gecko/20100101+Firefox/13.0.1 500 0 0 24240
2012-06-27 21:32:35 ::1 GET /Login.aspx - 80 - ::1 Mozilla/5.0+(Windows+NT+6.1;+WOW64;+rv:13.0)+Gecko/20100101+Firefox/13.0.1 500 0 0 24240
2012-06-27 21:32:35 ::1 GET /Login.aspx - 80 - ::1 Mozilla/5.0+(Windows+NT+6.1;+WOW64;+rv:13.0)+Gecko/20100101+Firefox/13.0.1 500 0 0 24240
2012-06-27 21:32:35 ::1 GET /Login.aspx - 80 - ::1 Mozilla/5.0+(Windows+NT+6.1;+WOW64;+rv:13.0)+Gecko/20100101+Firefox/13.0.1 500 0 0 24240
2012-06-27 21:32:35 ::1 GET /Login.aspx - 80 - ::1 Mozilla/5.0+(Windows+NT+6.1;+WOW64;+rv:13.0)+Gecko/20100101+Firefox/13.0.1 500 0 0 24240
2012-06-27 21:32:35 ::1 GET /Login.aspx - 80 - ::1 Mozilla/5.0+(Windows+NT+6.1;+WOW64;+rv:13.0)+Gecko/20100101+Firefox/13.0.1 500 0 0 24240
2012-06-27 21:32:35 ::1 GET /Login.aspx - 80 - ::1 Mozilla/5.0+(Windows+NT+6.1;+WOW64;+rv:13.0)+Gecko/20100101+Firefox/13.0.1 500 0 0 24240
2012-06-27 21:32:35 ::1 GET /Login.aspx - 80 - ::1 Mozilla/5.0+(Windows+NT+6.1;+WOW64;+rv:13.0)+Gecko/20100101+Firefox/13.0.1 500 0 0 24240
2012-06-27 21:32:35 ::1 GET /Login.aspx - 80 - ::1 Mozilla/5.0+(Windows+NT+6.1;+WOW64;+rv:13.0)+Gecko/20100101+Firefox/13.0.1 500 0 0 24240
2012-06-27 21:32:35 ::1 GET /Login.aspx - 80 - ::1 Mozilla/5.0+(Windows+NT+6.1;+WOW64;+rv:13.0)+Gecko/20100101+Firefox/13.0.1 500 0 0 24240
2012-06-27 21:32:35 ::1 GET /Login.aspx - 80 - ::1 Mozilla/5.0+(Windows+NT+6.1;+WOW64;+rv:13.0)+Gecko/20100101+Firefox/13.0.1 500 0 0 24240 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T20:30:40.357

在稍微修改了脚本之后，我找到了解决方案。下面是整个脚本

```
$t1 =(get-date).AddMinutes(-10)
$t2 =$t1.ToUniversalTime().ToString("HH:mm:ss")
$IISLogPath = "C:\inetpub\logs\LogFiles\W3SVC1\"+"u_ex"+(get-date).ToString("yyMMdd")+".log" 
$IISLogFileRaw = [System.IO.File]::ReadAllLines($IISLogPath) 
$headers = $headers | where {$_ -ne "#Fields:"} 
$IISLogFileCSV = Import-Csv -Delimiter " " -Header $headers -Path $IISLogPath 
$IISLogFileCSV = $IISLogFileCSV | where {$_.date -notlike "#*"} 
$timeTaken = ($IISLogFileCSV | where {$_.("cs-uri-stem") -eq '/Login.aspx' -AND $_.("time") -gt '$t2' -AND $_.("cs-method") -eq 'Get'}).count  
$count = $timeTaken
if($count -ge 8)
{
 Send-MailMessage -From from@domain.com -To to@domain.com -Subject "IIS Alert" -BodyAsHtml "Email body goes here" -Attachments $IISLogPath  -SmtpServer ip.add.re.ss
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T13:07:19.393

在解析/查询日志文件时，您应该使用[Microsoft LogParser](http://technet.microsoft.com/en-us/scriptcenter/dd919274.aspx)来完成大部分繁重的工作。它会为您节省很多痛苦，并且可能会更快启动。

你可以用 PowerShell 包装它来解析你的查询结果。

# wordpress - wordpress ssl出现404错误

> ID：11253185
> 
> 赞同：19
> 
> 时间：2012-06-28T21:30:07.600
> 
> 标签：wordpress, ssl, http-status-code-404

SSL 安装在我们的服务器上，我们的网站主要是 wordpress，并且有一些非 wordpress 页面可以在 https:// 下正常工作，主页也可以正常工作，但是当我尝试访问 wordpress 页面/帖子时，我得到 404找不到页面错误。我确实尝试了 wordpress https 插件在某些页面上强制使用 ssl，但我得到了同样的错误。我也有自定义永久链接。有什么方法可以在某些 wordpress 页面上强制使用 ssl？问候，J。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2015-05-19T07:10:00.917

apache 的 ssl 虚拟主机配置中需要该`directory`标签，与 http 端口 80 相同，以允许使用`.htaccess`wordpress 覆盖重定向规则。

```
<VirtualHost *:443>
    ..
    ..
    ..
    <Directory /var/www/html/domain.com/>
        DirectoryIndex index.php
        AllowOverride All
        Order allow,deny
        Allow from all
    </Directory>
</VirtualHost> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-07T01:04:59.833

它不是 WordPress 特定的，但您可以设置该`$_SERVER`值以启用 SSL。在 wp-config.php 中添加以下内容：

```
$_SERVER['HTTPS']='on'; 
```

这至少可以让您弄清楚您的服务器配置是否正确，或者您是否有其他一些与 WordPress 相关的问题。

# delphi - delphi中的“降序”记录？

> ID：11253199
> 
> 赞同：8
> 
> 时间：2012-06-28T21:31:34.723
> 
> 标签：delphi, records

我知道你实际上不能从记录中得到任何东西，但我不知道如何用一句话来总结我的问题。如果您这样做，请编辑标题。

我在这里要做的是制作一些泛型类型的数组，它可以是 X 种类型中的一种，该数组将填充那些自定义类型（它们有不同的字段，这很重要）。简单的方法是只创建一个变体记录数组，每个变体都有自己的类型，但显然不能像这样重新声明标识符：

```
GenericRec = Record
  case SubTypeName: TSubTypeName of
    type1name: (SubRec: Type1);
    type2name: (SubRec: Type2);
    ...
    typeNname: (SubRec: TypeN);
  end; 
```

更改`SubRec`为`SubRec1, SubRec2... SubRecN`使引用变得痛苦，但并非不可能。自从我开始寻找上述问题的替代解决方案后，我想到了类。

演示我要实现的目标的明显示例是`TObject`，可以将一组数组分配给许多不同的事物。这就是我想要的，但是有记录（这是不可能的），因为我希望能够将记录保存到文件中并读回它们（也因为这是我已经熟悉的东西）。制作我自己的简单类不是问题，从中制作一个后代类来代表我的子类型——我可以做到。但是如何将其写入文件并读回呢？这归结为序列化，我不知道该怎么做。据我所知，这并不容易，而且该课程必须来自`TComponent`.

```
TMyClass = Class 
```

如果我像上面那样上课有什么不同吗？它没有什么花哨的，最多有 10 个字段，包括一些自定义类型。

将序列化放在一边（只是因为我有很多关于该主题的阅读工作），在这里使用类也可能是不可能的。

在这一点上，我有什么选择？我应该放弃记录并在课堂上尝试吗？或者仅仅坚持记录并处理变体“限制”会不会复杂得多？我全心全意学习，如果爆炸式的课堂方法能让我更聪明，我会去做。我也刚刚研究`TList`过（从未使用过它），但它似乎与记录混​​合得不太好，也许可以做到，但目前这可能不在我的范围内。我愿意接受任何建议。我该怎么办？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-28T23:13:26.553

您将序列化与“通过一次`BlockWrite`调用将所有内容写入磁盘”混为一谈。你可以序列化任何你想要的东西，不管它是从`TComponent`还是`TPersistent`.

虽然一开始用一个`BlockWrite`调用编写所有东西看起来很方便，但如果您想要的记录类型要存储任何特别有趣的东西（如字符串、动态数组、接口、对象或其他引用），您很快就会发现它并不是您真正想要的。或基于指针的类型）。

您可能还会发现不满意的变体记录，因为您将按照最低公分母进行编码。如果不检查实际包含的类型，您将无法访问记录中的任何内容，即使是最少量的数据，其大小也会与最大的数据类型占用相同的空间。

这个问题似乎描述了*polymorphism*，因此您不妨接受该语言已经为此提供的内容。使用对象的数组（或列表，或任何其他容器）。然后你可以使用虚方法统一对待它们。如果需要，您可以实现记录的动态分派（例如，为每个记录提供一个函数指针，该指针指向一个知道如何处理该记录包含的数据类型的函数），但最终您可能会发现自己正在重新发明类.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-29T07:44:34.787

处理此类数据的“自然”方式是使用 a `class`，而不是 a `record`。无论是在定义时还是在处理实现时，它都会更容易使用：特别是，`virtual`方法非常强大，可以为特定类型的类定制流程。然后在较新版本的 Delphi 中使用 a`TList/TObjectList`或 a或基于泛型的数组来存储列表。`TCollection`

关于序列化，有几种方法可以做到。参见[Delphi：以某种结构存储数据](https://stackoverflow.com/questions/7105995/delphi-store-data-in-somekind-of-structure/7107086#7107086)

在您的特定情况下，困难来自您正在使用的“变体”类型的记录。恕我直言，主要缺点是*编译器将拒绝`string`在“变体”部分中设置任何引用计数类型的变量（例如 a ）*。因此，您将能够`integer`在此“变体”部分中仅编写“普通”变量（如 ）。恕我直言，这是一个很大的限制，它降低了这个解决方案的兴趣。

另一种可能性是在其定义的开头存储该类型的记录，例如，使用 a`RecType: integer`甚至更好，`RecType: TEnumerationType`这将比数字更明确。但是您必须手动编写大量代码，并且使用指针，如果您对指针编码不是很流利，这有点容易出错。

因此，您还可以存储记录的类型信息，可通过`TypeInfo(aRecordVariable)`. 然后你可以`FillChar`在分配后将记录内容初始化为零，然后在分配后使用以下函数完成记录内容（这是`Dispose()`内部做的，你应该调用它，否则你会泄漏内存） ：

```
procedure RecordClear(var Dest; TypeInfo: pointer);
asm
  jmp System.@FinalizeRecord
end; 
```

但是这样的实现模式只会重新发明轮子！它实际上是如何`class`实现的：任何`TObject`实例的第一个元素都是指向它的指针`ClassType`：

```
function TObject.ClassType: TClass;
begin
  Pointer(Result) := PPointer(Self)^;
end; 
```

Delphi中还有另外一种结构，叫做`object`. 它是某种类型`record`，但它支持继承 - 请参阅[这篇文章](http://blog.synopse.info/post/2010/08/06/Save-object%2C-stop-class-hegemony%21)。它是 Turbo Pascal 5.5 天中的旧式 OOP 编程，已弃用，但仍然可用。请注意，我[在较新版本的 Delphi 上发现了一个奇怪的编译问题](http://blog.synopse.info/post/2011/01/29/record-and-object-issue-in-Delphi-2010)：有时，`object`堆栈上的分配并不总是被初始化。

Take a look at our `TDynArray` wrapper and its associated functions, who is able to serialize any `record` content, into binary or JSON. See [Delphi (win32) serialization libraries](https://stackoverflow.com/questions/2984362/delphi-win32-serialization-libraries/11257391#11257391) question. It will work with variant records, even if they include a `string` in their unvariant part, whereas a plain "Write/BlockWrite" won't work with reference counted fields.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-28T23:10:27.180

要对记录执行此操作，您将创建前面具有公共字段的不同记录类型，然后将这些相同字段放入通用记录中。然后，您可以在需要时简单地将指向通用记录的指针类型转换为指向特定记录的指针。例如：

```
type
  PGenericRec = ^GenericRec;
  GenericRec = Record 
    RecType: Integer;
  end;

  PType1Rec = ^Type1Rec; 
  Type1Rec = Record 
    RecType: Integer;
    // Type1Rec specific fields...
  end;

  PType2Rec = ^Type2Rec; 
  Type2Rec = Record 
    RecType: Integer;
    // Type2Rec specific fields...
  end;

  PTypeNRec = ^TypeNRec;
  TypeNRec = Record
    RecType: Integer;
    // TypeNRec specific fields...
  end; 

var
  Recs: array of PGenericRec;
  Rec1: PType1Rec; 
  Rec2: PType2Rec; 
  RecN: PTypeNRec;
  I: Integer;
begin
  SetLength(Recs, 3);

  New(Rec1);
  Rec1^.RecType := RecTypeForType1Rec;
  // fill Rec1 fields ...
  Recs[0] := PGenericRec(Rec1);

  New(Rec2);
  Rec2^.RecType := RecTypeForType2Rec;
  // fill Rec2 fields ...
  Recs[1] := PGenericRec(Rec2);

  New(RecN);
  Rec3^.RecType := RecTypeForTypeNRec;
  // fill RecN fields ...
  Recs[2] := PGenericRec(RecN);

  for I := 0 to 2 do
  begin
    case Recs[I]^.RecType of
      RecTypeForType1Rec: begin
        Rec1 := PType1Rec(Recs[I]);
        // use Rec1 as needed...
      end;
      RecTypeForType1Re2: begin
        Rec2 := PType2Rec(Recs[I]);
        // use Rec2 as needed...
      end;
      RecTypeForTypeNRec: begin
        RecN := PTypeNRec(Recs[I]);
        // use RecN as needed...
      end;
    end;
  end;

  for I := 0 to 2 do
  begin
    case Recs[I]^.RecType of
      RecTypeForType1Rec: Dispose(PType1Rec(Recs[I]));
      RecTypeForType2Rec: Dispose(PType2Rec(Recs[I]));
      RecTypeForTypeNRec: Dispose(PTypeNRec(Recs[I]));
    end;
  end;
end; 
```

至于序列化，您不需要`TComponent`。您可以序列化记录，您只需要手动完成。对于写入，`RecType`先写出值，然后再写出特定于记录的值。对于读取，`RecType`首先读取值，然后为该值创建适当的记录类型，然后将特定于记录的值读入其中。：

```
interface

type
  PGenericRec = ^GenericRec;
  GenericRec = Record 
    RecType: Integer;
  end;

  NewRecProc = procedure(var Rec: PGenericRec);
  DisposeRecProc = procedure(Rec: PGenericRec);
  ReadRecProc = procedure(Rec: PGenericRec);
  WriteRecProc = procedure(const Rec: PGenericRec);

function NewRec(ARecType: Integer): PGenericRec;
procedure DisposeRec(var Rec: PGenericRec);
procedure ReadRec(Rec: PGenericRec);
procedure WriteRec(const Rec: PGenericRec);

procedure RegisterRecType(ARecType: Integer; ANewProc: NewRecProc; ADisposeProc: DisposeRecProc; AReadproc: ReadRecFunc; AWriteProc: WriteRecProc);

implementation

type
  TRecTypeReg = record
    RecType: Integer;
    NewProc: NewRecProc;
    DisposeProc: DisposeRecProc;
    ReadProc: ReadRecProc;
    WriteProc: WriteRecProc;
  end;

var
  RecTypes: array of TRecTypeReg;

function NewRec(ARecType: Integer): PGenericRec;
var
  I: Integer;
begin
  Result := nil;
  for I = Low(RecTypes) to High(RecTypes) do
  begin
    with RecTypes[I] do
    begin
      if RecType = ARecType then
      begin
        NewProc(Result);
        Exit;
      end;
    end;
  end;
  raise Exception.Create('RecType not registered');
end;

procedure DisposeRec(var Rec: PGenericRec);
var
  I: Integer;
begin
  for I = Low(RecTypes) to High(RecTypes) do
  begin
    with RecTypes[I] do
    begin
      if RecType = Rec^.RecType then
      begin
        DisposeProc(Rec);
        Rec := nil;
        Exit;
      end;
    end;
  end;
  raise Exception.Create('RecType not registered');
end;

procedure ReadRec(var Rec: PGenericRec);
var
  LRecType: Integer;
  I: Integer;
begin
  Rec := nil;
  LRecType := ReadInteger;
  for I = Low(RecTypes) to High(RecTypes) do
  begin
    with RecTypes[I] do
    begin
      if RecType = LRecType then
      begin
        NewProc(Rec);
        try
          ReadProc(Rec);
        except
          DisposeProc(Rec);
          raise;
        end;
        Exit;
      end;
    end;
  end;
  raise Exception.Create('RecType not registered');
end;

procedure WriteRec(const Rec: PGenericRec);
var
  I: Integer;
begin
  for I = Low(RecTypes) to High(RecTypes) do
  begin
    with RecTypes[I] do
    begin
      if RecType = Rec^.RecType then
      begin
        WriteInteger(Rec^.RecType);
        WriteProc(Rec);
        Exit;
      end;
    end;
  end;
  raise Exception.Create('RecType not registered');
end;

procedure RegisterRecType(ARecType: Integer; ANewProc: NewRecProc; ADisposeProc: DisposeRecProc; AReadproc: ReadRecFunc; AWriteProc: WriteRecProc);
begin
  SetLength(RecTypes, Length(RecTypes)+1);
  with RecTypes[High(RecTypes)] do
  begin
    RecType := ARecType;
    NewProc := ANewProc;
    DisposeProc := ADisposeProc;
    ReadProc := AReadProc;
    WriteProc := AWriteProc;
  end;
end;

end. 
```

.

```
type
  PType1Rec = ^Type1Rec; 
  Type1Rec = Record 
    RecType: Integer;
    Value: Integer;
  end;

procedure NewRec1(var Rec: PGenericRec);
var
  Rec1: PType1Rec;
begin
  New(Rec1);
  Rec1^.RecType := RecTypeForType1Rec;
  Rec := PGenericRec(Rec1);
end;

procedure DisposeRec1(Rec: PGenericRec);
begin
  Dispose(PType1Rec(Rec));
end;

procedure ReadRec1(Rec: PGenericRec);
begin
  PType1Rec(Rec)^.Value := ReadInteger;
end;

procedure WriteRec1(const Rec: PGenericRec);
begin
  WriteInteger(PType1Rec(Rec)^.Value);
end;

initialization
  RegisterRecType(RecTypeForType1Rec, @NewRec1, @DisposeRec1, @ReadRec1, @WriteRec1); 
```

.

```
type
  PType2Rec = ^Type2Rec; 
  Type2Rec = Record 
    RecType: Integer;
    Value: Boolean;
  end;

procedure NewRec2(var Rec: PGenericRec);
var
  Rec2: PType2Rec;
begin
  New(Rec2);
  Rec2^.RecType := RecTypeForType2Rec;
  Rec := PGenericRec(Rec2);
end;

procedure DisposeRec2(Rec: PGenericRec);
begin
  Dispose(PType2Rec(Rec));
end;

procedure ReadRec2(Rec: PGenericRec);
begin
  PType2Rec(Rec)^.Value := ReadBoolean;
end;

procedure WriteRec2(const Rec: PGenericRec);
begin
  WriteBoolean(PType2Rec(Rec)^.Value);
end;

initialization
  RegisterRecType(RecTypeForType2Rec, @NewRec2, @DisposeRec2, @ReadRec2, @WriteRec2); 
```

.

```
type
  PTypeNRec = ^Type2Rec; 
  TypeNRec = Record 
    RecType: Integer;
    Value: String;
  end;

procedure NewRecN(var Rec: PGenericRec);
var
  RecN: PTypeNRec;
begin
  New(RecN);
  RecN^.RecType := RecTypeForTypeNRec;
  Rec := PGenericRec(RecN);
end;

procedure DisposeRecN(Rec: PGenericRec);
begin
  Dispose(PTypeNRec(Rec));
end;

procedure ReadRecN(Rec: PGenericRec);
begin
  PTypeNRec(Rec)^.Value := ReadString;
end;

procedure WriteRecN(const Rec: PGenericRec);
begin
  WriteString(PTypeNRec(Rec)^.Value);
end;

initialization
  RegisterRecType(RecTypeForTypeNRec, @NewRecN, @DisposeRecN, @ReadRecN, @WriteRecN); 
```

.

```
var
  Recs: array of PGenericRec;

procedure CreateRecs;
begin
  SetLength(Recs, 3);

  NewRec1(Recs[0]);
  PRecType1(Recs[0])^.Value : ...;

  NewRec2(Recs[1]);
  PRecType2(Recs[1])^.Value : ...;

  NewRecN(Recs[2]);
  PRecTypeN(Recs[2])^.Value : ...;
end;

procedure DisposeRecs;
begin
  for I := 0 to High(Recs) do
    DisposeRec(Recs[I]);
  SetLength(Recs, 0);
end;

procedure SaveRecs;
var
  I: Integer;
begin
  WriteInteger(Length(Recs));
  for I := 0 to High(Recs) do
    WriteRec(Recs[I]);
end;

procedure LoadRecs;
var
  I: Integer;
begin
  DisposeRecs;
  SetLength(Recs, ReadInteger);
  for I := 0 to High(Recs) do
    ReadRec(Recs[I]);
end; 
```

# python - 具有嵌套多个条件的 if 语句

> ID：11253201
> 
> 赞同：1
> 
> 时间：2012-06-28T21:31:59.800
> 
> 标签：python, if-statement

我试图在 Python 中的 if 语句中放置多个条件，如下所示：

```
if (h9 == h1 or h9 == h2 or h9 == h3 or h9 == h4 or h9 == h5 or h9 == h6 or h9 == h7 or h9 == h8) and (h10 == h1 or h10 == h2 or h10 == h3 or h10 == h4 or h10 == h5 or h10 == h6 or h10 == h7 or h10 == h8) :
     do sth. 
```

`h9`基本上它同时是两者的OR 条件`h10`。
但是，这不起作用，并给出如下错误：

> `IndentationError: unindent does not match any outer indentation level`

有什么问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-28T21:33:49.117

在没有更多上下文的情况下不知道缩进错误，但是您可以采取一些措施来`if`缩短条件：

```
lst = [h1, h2, h3, h4, h5, h6, h7, h8]
if h9 in lst and h10 in lst:
    pass 
```

此外，您应该真正使用更具描述性的变量名称。

* * *

哦，如果您有很多元素并计划进行大量搜索，您可能会喜欢集合：

```
s = set([h1, h2, h3, h4, h5, h6, h7, h8])    # {h1, h2, h3, ...} in Python 3.x
if h9 in s and h10 in s:
    pass 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-28T21:39:54.833

如果您必须使用长条件，您可以将整个 if 条件括在括号中，您可以将其放在多行中而不会出现缩进错误。

```
a = 2
b = 2
if ((a == 1 or a == 2) and 
        (b == 1 or b == 2)):
    print "hello" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T21:37:55.743

这里没有缩进问题。我想里面有缩进问题`do sth.`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-28T21:38:00.163

另一种选择是：

```
if any(h in {h1,h2,...} for h in (h9, h10)): 
```

# objective-c - ARC 就绪的 XML 解析器

> ID：11253202
> 
> 赞同：2
> 
> 时间：2012-06-28T21:32:00.187
> 
> 标签：objective-c, xml, xml-parsing

好的，我只是尝试使用 3 种不同的 xml 解析器，例如 TBXML 等。有谁知道一个弧就绪的 xml 解析器。我试图转换文件以使它们准备就绪，但它无法正常工作，因为该过程会产生新的错误。此外，禁用特定文件的 ARC 机制对我也不起作用。

是否有任何不超过 2 年的 XML 解析器？

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-13T19:59:45.607

我也一直在寻找它，我找到[了 KissXML](https://github.com/robbiehanson/KissXML)。

它的最后一次更新是在 2 年前，但它是将其转换为 ARC。

我一直在使用 TBXML，但它与 ARC 不兼容，并且我不想因此而出现内存泄漏，所以我打算用 KissXML 替换它，看看效果如何。

# actionscript-3 - Flash：纯动作脚本项目：ToolTipManager 类未注册？

> ID：11253206
> 
> 赞同：0
> 
> 时间：2012-06-28T21:32:33.457
> 
> 标签：actionscript-3

我有一个使用开源命令行编译器构建的纯 ActionScript 3 项目。我正在尝试使用 mx.managers.ToolTipManager 向我的控件添加工具提示。

代码编译没有问题，但是当我尝试添加工具提示时，出现以下异常：

```
No class registered for interface 'mx.managers::IToolTipManager2' 
```

我尝试尝试手动针对该接口注册一个类，例如：

```
var toolTipManagerImpl:Object = ApplicationDomain.currentDomain.getDefinition('mx.managers::ToolTipManagerImpl');
Singleton.registerClass("mx.managers::IToolTipManager2", Class( toolTipManagerImpl ) ); 
```

...但这给我留下了一个空的 ToolTipManager 参考。

在这种环境中使用 ToolTipManager 我必须做些什么？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T21:52:50.683

SWC 不是构建路径，更重要的是：它很可能无法工作，因为缺少组件所依赖的整个框架。

# jenkins - 阻止 Jenkins 访问 8080 端口

> ID：11253207
> 
> 赞同：8
> 
> 时间：2012-06-28T21:32:38.320
> 
> 标签：jenkins, reverse-proxy

我在使用 just 安装的 Ubuntu 服务器上安装了 jenkins 的基本安装，因此，现在可以通过简单地添加URL`sudo apt-get install jenkins`从指向我的框的所有域访问 jenkins 。`:8080`

我已成功将 apache 配置为代理 jenkins，以便我可以从中访问它`ci.mydomain.com`，但我无法弄清楚如何防止 jenkins 在端口 8080 上被访问。

这是我的apache conf：

```
<VirtualHost xx.xx.xx.xx:80>
    ServerAdmin me@mydomain.com
    ServerName ci.mydomain.com

    ProxyPass         /  http://localhost:8080/
    ProxyPassReverse  /  http://localhost:8080/
    ProxyRequests     Off

    <Proxy http://localhost:8080/*>
        Order deny,allow
        Allow from all
    </Proxy>
</VirtualHost> 
```

我已按照[此处](https://serverfault.com/a/236405/70084)的 Ubuntu 说明进行操作，但它们似乎没有任何效果。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-28T21:58:46.560

您可以使用 iptables，因为它是 Ubuntu，以阻止对端口 8080 的所有非本地访问。

```
iptables -A INPUT -p tcp --dport 8080 -s localhost -j ACCEPT
iptables -A INPUT -p tcp --dport 8080 -j DROP 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-06-12T13:50:58.687

还有另一种解决方案（不需要IPtables）：

*   防止jenkins在8080端口被服务器外访问：

    *   编辑文件 /etc/default/jenkins
    *   添加 `HTTP_HOST=127.0.0.1`
    *   最后换行：

        *   从： `JENKINS_ARGS="--webroot=/var/cache/$NAME/war --httpPort=$HTTP_PORT"`
        *   到： `JENKINS_ARGS="--webroot=/var/cache/$NAME/war --httpPort=$HTTP_PORT --httpListenAddress=$HTTP_HOST"`
    *   重启詹金斯 `systemctl restart jenkins`

# php - MYSQL：按数组的平均值排序

> ID：11253210
> 
> 赞同：1
> 
> 时间：2012-06-28T21:32:53.430
> 
> 标签：php, mysql, arrays, sum, average

所以我在一个 mysql 表中有一个内爆数组，它基本上只是一个数字序列（例如 1、5、3、1、4、5），我想知道是否可以按平均值排序它们（甚至表中数字集的总和（如果可能的话）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-28T21:41:01.263

不要将数字存储在分隔字符串中，而是利用 MySQL 的关系功能并规范化数据：将数字`(key, value)`成对存储在单独的表中，该表将外键（即现有表的外键）与列表中的单个数字相关联. 如果顺序很重要，请添加一列以指示该数字在列表中的位置。

```
CREATE TABLE `newtable` (
  `key`   INT,
  `value` INT,
  FOREIGN KEY (`key`) REFERENCES `existingtable` (`key`)
) 
```

然后您只需[将](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html)表连接在一起，`GROUP BY`现有表中的键和新表中的值`ORDER BY`的[`AVG()`](http://dev.mysql.com/doc/en/group-by-functions.html#function_avg)或[`SUM()`](http://dev.mysql.com/doc/en/group-by-functions.html#function_sum)；[`GROUP_CONCAT()`](http://dev.mysql.com/doc/en/group-by-functions.html#function_group-concat)如果需要，您甚至可以使用 MySQL 的函数回收逗号分隔的列表：

```
SELECT   `existingtable`.*, GROUP_CONCAT(`newtable`.`value`) AS `values`
FROM     `existingtable` LEFT JOIN `newtable` USING (`key`)
GROUP BY `key`
ORDER BY AVG(`newtable`.`value`) -- or use SUM() if preferred 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T23:10:55.170

正如其他人所提到的，不清楚您的表格是什么样的，或者您表格中的数据是什么样的。完全不清楚“内爆阵列”是什么样的。这是一个示例可以真正帮助您获得所需答案的地方。

但是让我们在这里使用“最坏情况”，并假设您有一个包含要平均的值的字符串。像这样：

```
CREATE TABLE foo (str VARCHAR(1000));
INSERT INTO foo VALUES ('1,5,3,1,4,5');
INSERT INTO foo VALUES ('2.8,4.2');
INSERT INTO foo VALUES ('bar');
INSERT INTO foo VALUES (' 0, -2, 3'); 
```

可以创建一个函数来返回“内爆数组”字符串中值的平均值。举个例子：

```
DELIMITER $$
CREATE FUNCTION `do_average`(p_str VARCHAR(2000))
RETURNS DOUBLE
BEGIN
  DECLARE c INT;
  DECLARE i INT;
  DECLARE s VARCHAR(2000);
  DECLARE v DOUBLE;
  SET c = 0;
  SET v = 0;
  SET s = CONCAT(p_str,',');
  SET i = INSTR(s,',');
  WHILE i > 0 DO
    SET v = v + SUBSTR(s,1,i);
    SET c = c + 1;
    SET s = SUBSTR(s,i+1,2000);
    SET i = INSTR(s,',');
  END WHILE;
  RETURN v / NULLIF(c,0);
END$$
DELIMITER ; 
```

我们可以证明这个工作：

```
SELECT f.str
     , do_average(f.str) AS davg
  FROM foo f
 ORDER BY do_average(f.str)

str                       davg  
-----------  -------------------
bar                            0
 0, -2, 3      0.333333333333333
1,5,3,1,4,5     3.16666666666667
2.8,4.2                      3.5 
```

请注意，使用此函数，我们使用 MySQL 将字符串隐式转换为数字，因此空字符串或无效数字将被转换为零，并且该零将被添加并计算平均值。

一个`do_sum`函数几乎是相同的，只是返回总数而不是总数除以计数。

sqlfiddle 示例在这里[http://sqlfiddle.com/#!2/4391b/2/0](http://sqlfiddle.com/#!2/4391b/2/0)

# c# - 未找到 WCF 服务端点

> ID：11253211
> 
> 赞同：2
> 
> 时间：2012-06-28T21:33:01.103
> 
> 标签：c#, asp.net, wcf, web-config, wcf-binding

我已经在 IIS 上部署了我的 wcf 服务。当我想访问它的一种方法“未找到端点”时，它给了我这个错误，而在本地它对我来说工作正常并返回数据。

这是我的 Web.config 绑定信息

```
 <system.webServer>
    <directoryBrowse enabled="false" />
    <modules runAllManagedModulesForAllRequests="true"/>
  </system.webServer>
  <system.serviceModel>
    <serviceHostingEnvironment multipleSiteBindingsEnabled="true" />
    <services>
      <service name="RTAService" behaviorConfiguration="WtfServiceBehaviour">
        <endpoint address="" binding="webHttpBinding" bindingConfiguration="wtfSslBinding" behaviorConfiguration="WebHttpBehaviour" contract="IRTAService" />
        <endpoint address="soap" binding="basicHttpBinding" contract="IRTAService"/>
        <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange"  />
      </service>
    </services>
    <bindings>
      <webHttpBinding>
        <binding name="wtfSslBinding" />
        <binding name="streamedBinding"
                 maxBufferSize="65536"
                 maxReceivedMessageSize="2000000000"
                 transferMode="Streamed">
          <readerQuotas maxDepth="500000000"
         maxArrayLength="500000000" maxBytesPerRead="500000000"
         maxNameTableCharCount="500000000" maxStringContentLength="500000000"/>
          <security mode="None" />
        </binding>

      </webHttpBinding>
    </bindings>
    <behaviors>
      <endpointBehaviors>
        <behavior name="WebHttpBehaviour">
          <webHttp helpEnabled="true" defaultBodyStyle="Wrapped" defaultOutgoingResponseFormat="Json"
            automaticFormatSelectionEnabled="false" />
        </behavior>
      </endpointBehaviors>
      <serviceBehaviors>
        <behavior name="WtfServiceBehaviour">
          <serviceDebug includeExceptionDetailInFaults="true" />
          <serviceMetadata httpGetEnabled="true" />
        </behavior>
      </serviceBehaviors>
    </behaviors>
  </system.serviceModel> 
```

请告诉我任何解决方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T21:57:08.883

我没有看到端点在任何地方定义。你的配置应该有这样的东西。`

```
 <endpoint address="http://localhost:57800/Services.svc" binding="basicHttpBinding"
            bindingConfiguration="BasicHttpBinding_IServices"     contract="MYServices.IServices"
            name="BasicHttpBinding_IServices" /> 
```

# mdx - 使用 MDX 从一组中获得最高的结果

> ID：11253213
> 
> 赞同：2
> 
> 时间：2012-06-28T21:33:08.030
> 
> 标签：mdx

我需要从立方体中获取每个州的前 50 个卖家名称

这就是我到目前为止所拥有的

```
SELECT NON EMPTY ( [DimGeo].[State].[State].ALLMEMBERS *
[Measures].[Total Sales]) ON COLUMNS,
NON EMPTY TOPCOUNT([DimEmployee].[Employee ID].[EmployeeID].MEMBERS,50,[Measures].[Total  Sales]) ON ROWS
FROM Sales 
```

但这只会得到 50 个结果（即使一个州没有 50 个结果）。我想通过 50 个非空的最高值来限制状态结果。

示例：决赛桌将有 2500 个结果（每 50 个州的前 50 个经销商）。

有没有办法我可以做到这一点？

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T00:40:04.583

我猜你正在寻找[Generate()](http://www.iccube.com/support/documentation/mdx/Generate.html)函数：

```
SELECT 
   NON EMPTY ( [Measures].[Total Sales]) ON COLUMNS, 
   NON EMPTY Generate( [DimGeo].[State].[State].ALLMEMBERS as s,
             TOPCOUNT(s.currentMember * [DimEmployee].[Employee ID].[EmployeeID].MEMBERS, 50, [Measures].[Total  Sales] )) 
ON ROWS FROM fdmdw 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T23:26:23.920

通过将状态移动到行级别，这对您有用吗？

```
SELECT NON EMPTY ( [Measures].[Total Sales]) ON COLUMNS,
NON EMPTY ([DimGeo].[State].[State].ALLMEMBERS  * TOPCOUNT([DimEmployee].[Employee ID].[EmployeeID].MEMBERS,50,[Measures].[Total  Sales])) ON ROWS
FROM fdmdw 
```

# asp.net - 从服务器删除文件：拒绝访问路径

> ID：11253215
> 
> 赞同：2
> 
> 时间：2012-06-28T21:33:36.387
> 
> 标签：asp.net, security, iis-7.5

我用我的代码隐藏调用这个函数：
DeleteFile(Server.MapPath("/") + "sitemap_index.xml")

```
Public Shared Function DeleteFile(ByVal filename As String) As Boolean
'deletes file from server
Dim bResult As Boolean = False
Try
    If File.Exists(filename) Then
        'delete file
        File.Delete(filename)
        bResult = True
    Else
        bResult = True
    End If
Catch ex As Exception

End Try
Return bResult
End Function 
```

然后我收到错误消息：拒绝访问路径“E:\zz\wwwroot\sitemap_index.xml”。

在我自己的其他网站上，这种逻辑效果很好，但在当前网站上却不行。我检查了我的 windows server 2008 R2 Standard 上的安全设置。

在此处查看我在 Windows 服务器上的 wwwroot 文件夹中的设置：

> 系统：完全控制
> 网络服务：读取 + 写入 + 读取和执行 + 列出文件夹内容
> IIS_IUSRS：读取 + 写入

正如我一直在阅读的其他帖子所建议的那样，我尝试添加其他用户组，但我的服务器上没有 ASPNET 服务/组。

以管理员身份登录（表单身份验证）时，我可以单击按钮重新创建 sitemap_index.xml 和 sitemaps.xml
用户应该能够删除图像并将其添加到 wwwroot\images\uploads 文件夹

我应该给哪个组什么权限才能使上述内容成为可能和安全？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-28T22:37:51.283

检查应用程序池用户的访问权限。

找到您的站点正在使用的应用程序池，右键单击它并选择`Advanced Settings...`。池正在使用的用户名列在 旁边`Identity`。

请注意，如果身份显示“ApplicationPoolIdentity”，您应该检查`IIS AppPool\<Name of the app pool here>` [有关 ApplicationPoolIdentity 的用户信息的访问权限](http://blogs.iis.net/webdevelopertips/archive/2009/10/02/tip-98-did-you-know-the-default-application-pool-identity-in-iis-7-5-windows-7-changed-from-networkservice-to-apppoolidentity.aspx)

* * *

It looks like `Modify` permissions are [required to delete files](http://www.techexams.net/forums/server-70-290/19589-ntfs-permission-modify-delete-subfolders-files.html). Try granting NetworkService `Modify` permissions.

# iphone - iPhone 上的实时录音/分析

> ID：11253216
> 
> 赞同：0
> 
> 时间：2012-06-28T21:33:38.980
> 
> 标签：iphone, audio, avaudiorecorder

我正在构建一个将数据发送到耳机插孔的硬件，我需要一种方法来记录短片段并快速分析它（希望不必保存文件并重新打开进行分析）。我玩过[fft](https://stackoverflow.com/questions/3398753/using-the-apple-fft-and-accelerate-framework)和[加速框架](http://developer.apple.com/library/ios/#documentation/Performance/Conceptual/vDSP_Programming_Guide/UsingFourierTransforms/UsingFourierTransforms.html)，但我不认为这正是我想要的。

我主要想知道这样的事情是否可行：录制一段约 30 毫秒的音频片段，然后在整个录制过程中抓取一组代表电压/（分贝电平？）的浮点数。然后我可以通过记录根据不同毫秒的电平来解释数据。像[AVAudioRecorder](https://developer.apple.com/library/mac/#documentation/AVFoundation/Reference/AVAudioRecorder_ClassReference/Reference/Reference.html)这样的东西是否能够以我可以在录音中每毫秒检查一次的分辨率进行录制？由于这将是一个重复的过程，我希望也能降低 cpu 的性能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T21:52:29.353

这是完全可行的。将 AudioSession 与 AudioUnits 一起使用。

# ruby-on-rails - rake assets 预编译失败

> ID：11253218
> 
> 赞同：5
> 
> 时间：2012-06-28T21:33:41.283
> 
> 标签：ruby-on-rails, bundle

当我运行时`bundle exec rake assets:precompile --trace`，我的预编译失败，但我看不到任何具体原因。

请参阅此 pastebin 以获取我的输出： http: [//pastebin.com/zggZyPyM](http://pastebin.com/zggZyPyM)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-28T22:42:18.357

预编译资产会占用大量内存。在我的情况下〜= 400mb。由于内存使用过多，操作系统可能正在终止进程。您可以检查系统日志以验证是否是这种情况。

您可以增加服务器的内存来避免这种情况。如果这不可能，我建议您在本地系统上预编译资产，将它们提交到 repo 并部署到服务器。这样您就不必在服务器上编译资产。但是，您可能想研究以某种方式删除先前生成的资产并自动化该过程的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-10-16T06:09:58.067

，但问题已解决我尝试先安装 node.js。然后，运行以下命令`bundle exec rake assets:precompile`。直到那时我才注意到错误。

最初，我认为这也是因为内存不足。清理了几乎所有正在运行的应用程序，但找不到解决方案。另外，我以管理员身份打开了 Ruby。不确定这是否也有帮助，但问题已解决。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-20T22:32:16.077

这个问题也可以通过使用 node.js JS 运行时来预编译资产来解决，因为它显然具有较低的内存占用。对于 Ubunutu 14.04，我需要运行`apt-get install nodejs`，然后用替换默认的 js 运行时`Gemfile`，`gem 'node'`运行`bundle`并最后重新运行预编译。我会警告不要在其他位置进行预编译，因为您可能会在 css 或 js 更改后忘记执行此操作，从而导致错误。

# ruby-on-rails - Hudson 在构建时加载错误版本的 gem

> ID：11253223
> 
> 赞同：0
> 
> 时间：2012-06-28T21:34:04.030
> 
> 标签：ruby-on-rails, continuous-integration, hudson

我在 Hudson CI 中有一个损坏的构建，我不确定如何修复。问题似乎很简单——加载了不正确的 gem 版本——但 Hudson 控制台输出似乎与错误消息相矛盾。

**Hudson 的`console`构建输出：**

```
[...hudson fetching code from SCM...]

Commencing build of Revision 496c7a18b3b56b14037d2d643858cec217be289a (origin/master)
Checking out Revision 496c7a18b3b56b14037d2d643858cec217be289a (origin/master)
[workspace] $ bash -xe /tmp/hudson424603273172296439.sh
+ export RAILS_ENV=hudson
+ RAILS_ENV=hudson
+ bundle install

[...list of a bunch of gems, truncated...]

Using launchy (2.1.0) 

[...the rest of the gems...]

[32mYour bundle is complete! Use `bundle show [gemname]` to see where a bundled gem is installed.[0m
+ bundle exec rake hudson:all --trace
/home/build/build_gems/gems/bundler-1.0.7/lib/bundler/runtime.rb:27:in `setup': You have already activated launchy 0.3.7, but your Gemfile requires launchy 2.1.0\. Consider using bundle exec. (Gem::LoadError)
    from /home/build/build_gems/gems/bundler-1.0.7/lib/bundler/spec_set.rb:12:in `each'
    from /home/build/build_gems/gems/bundler-1.0.7/lib/bundler/spec_set.rb:12:in `each'
    from /home/build/build_gems/gems/bundler-1.0.7/lib/bundler/runtime.rb:17:in `setup'
    from /home/build/build_gems/gems/bundler-1.0.7/lib/bundler.rb:100:in `setup'
    from /home/build/build_gems/gems/bundler-1.0.7/lib/bundler/cli.rb:343:in `exec'
    from /home/build/build_gems/gems/bundler-1.0.7/lib/bundler/vendor/thor/task.rb:22:in `send'
    from /home/build/build_gems/gems/bundler-1.0.7/lib/bundler/vendor/thor/task.rb:22:in `run'
    from /home/build/build_gems/gems/bundler-1.0.7/lib/bundler/vendor/thor/invocation.rb:118:in `invoke_task'
    from /home/build/build_gems/gems/bundler-1.0.7/lib/bundler/vendor/thor.rb:246:in `dispatch'
    from /home/build/build_gems/gems/bundler-1.0.7/lib/bundler/vendor/thor/base.rb:389:in `start'
    from /home/build/build_gems/gems/bundler-1.0.7/bin/bundle:13
    from /home/build/build_gems/bin/bundle:19:in `load'
    from /home/build/build_gems/bin/bundle:19
Build step 'Execute shell' marked build as failure 
```

因此，该`bundle install`命令显示`launchy (2.1.0)`正在使用，但错误表明`launchy 0.3.7`已激活。我不确定哪里有这种差异/冲突。

如您所见，我们正在使用`bundle exec`运行构建，因此应该应用捆绑包，所以我不确定这里发生了什么。

**在 hudson 项目配置的“Build => Execute shell”部分**，我有以下三行，这就是全部：

```
export RAILS_ENV="hudson"
bundle install
bundle exec rake hudson:all --trace 
```

**`Gemfile`拥有：**

```
...
group :development, :cucumber, :test,:hudson do
  gem "populator",  ">= 0.2.5"
  gem "factory_girl",">= 1.2.1"
  gem "faker", ">= 0.3.1"
  gem "rspec", "1.3.2"
  gem "rspec-rails", "1.3.4"
  gem "webrat"  
  gem "capybara"
  gem 'launchy'
  gem "cucumber","1.1.8"
  gem "cucumber-rails","0.3.2"
  gem "database_cleaner"
  gem "ruby-debug"
end
... 
```

**`Gemfile.lock`有**：

```
GEM
  ...
  specs:
    ...
    launchy (2.1.0)
    ...
...

DEPENDENCIES
  ...
  launchy
  ... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T19:27:07.637

显然答案在这个链接中。不知道我在谷歌搜索时是如何错过这个答案的：

[http://www.opinionatedprogrammer.com/2011/03/bundler-problem-you-have-already-activated-launchy-0-3-7/](http://www.opinionatedprogrammer.com/2011/03/bundler-problem-you-have-already-activated-launchy-0-3-7/)

基本上，为您的应用创建自定义 gemset + 按照文章中的说明进行操作。

# php - CodeIgniter 基于 URL 段

> ID：11253226
> 
> 赞同：3
> 
> 时间：2012-06-28T21:34:13.830
> 
> 标签：php, codeigniter, codeigniter-2, codeigniter-routing

我希望我的 URL 看起来像：**www.domain.com/controller/view/args**而不是**index.php?/controller/view/args**。实际上，我**从不**希望 url "index.php?..." 进行验证。谁能给我一个有关如何强制执行此行为的提示，因为当我这样做时：**A）redirect（）**或**B）**手动输入'index.php'“......” url变成了那个丑陋的模式。

这是我的 .htaccess 文件（我不知道我是否需要这个文件，只是从互联网上复制+粘贴）：

```
#http://codeigniter.com/wiki/Godaddy_Installaton_Tips/

RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ /index.php?$1 [L] 
```

这是我的 config.php：

```
$config['base_url'] = '';
$config['index_page'] = 'index.php?';
$config['uri_protocol'] = 'AUTO';
$config['enable_query_strings'] = FALSE; 
```

这就是改变行为的原因：

```
redirect('...blah', 'either location or refresh'); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T21:41:14.130

您实际上需要在 codeigniter 目录的根目录中的 .htaccess 文件（无论 index.php 在哪里）。.htaccess 文件负责管理参数的重写。如果您查询 yoursite.com/?controller/model，它将与 index.php 在那里一样工作。"?controller/..." 仍然存在，但 index.php 将不会存在，只要您记得始终链接到非 index.php 版本。包含的 .htaccess 在大多数情况下都可以使用（尤其是 apache）。如果 codeigniter 不在您网站的根目录中，您可能需要进行修改（即 public_html/somedir/{codeigniter_goes_here}）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T21:54:29.107

除了需要将 .htaccess 放在 codeigniter 安装的根目录（与 index.php 相同的位置）之外，您还需要确保 mod_rewrite 在您的 Apache 安装上工作，否则 .htaccess 文件将只是被忽略。

此外，您需要在 Apache 虚拟主机中设置 AllowOverride 指令（请参阅[http://httpd.apache.org/docs/2.0/mod/core.html#allowoverride](http://httpd.apache.org/docs/2.0/mod/core.html#allowoverride)） - 它应该设置为：

```
<VirtualHost *:80>
...
AllowOverride All
...
</VirtualHost> 
```

您还应该更改：

```
$config['index_page'] = 'index.php?'; 
```

到：

```
$config['index_page'] = ''; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-28T23:23:47.587

来自 CI Wiki：[http ://codeigniter.com/wiki/mod_rewrite/](http://codeigniter.com/wiki/mod_rewrite/)

# backbone.js - 两个模型之间的骨干关系

> ID：11253227
> 
> 赞同：2
> 
> 时间：2012-06-28T21:34:16.850
> 
> 标签：backbone.js, backbone-relational

通过使用[Backbone-relational](https://github.com/PaulUithol/Backbone-relational)我希望以这种方式执行模型任务：

```
task = {
    id: 1
    assigned_id: 2
    name: 'read a book',
    user: userModel
}; 
```

我确实尝试过这种方式（1），但结果如下（2）。

有任何想法吗？

* * *

(1)

```
var User = Backbone.RelationalModel.extend({
    // urlRoot
});

var Task = Backbone.RelationalModel.extend({
        relations: [
            {
                type: Backbone.HasOne,
                key: 'user',
                relatedModel: User
            }
        ],

        // urlRoot
}); 
```

* * *

(2)

```
task = {
    id: 1
    assigned_id: 2
    name: 'read a book',
    user: null // null instead of having something related to user model
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T14:27:36.010

不确定您的任务模型的确切 JSON 是什么，所以我在这里猜测。

Backbone-relational 期望一个完全嵌套的模型：

```
task = {
    id: 1
    assigned_id: 2
    name: 'read a book',
    user: {
               name: 'Fred Rogers',
               id: 42,
               occupation: 'Hero'
          }
}; 
```

或者一个字符串/数字，它将假定为相关模型的 id：

```
task = {
    id: 1
    assigned_id: 2
    name: 'read a book',
    user: 42
}; 
```

`null`根据您为用户模型获得的价值，我猜您正在遇到第二种情况。

当骨干关系实例化模型的实例，并且相关模型是“键”字符串/数字时，它将搜索其内部模型存储以尝试找到匹配的模型。如果找到它，它将该模型设置为用户属性的值。

如果找不到模型，它会将键隐藏在模型的相关关系属性`model._relations[n].keyContents`中，并将用户值设置为`null`。

此时，您将使用该[`fetchRelated`](https://github.com/PaulUithol/Backbone-relational#fetchrelated-relationalmodelfetchrelatedkeystring-optionsobject-updateboolean)函数从数据存储/API 中获取相关模型。

因此，尝试调用`task.fetchRelated()`以获取相关的用户模型：

```
task.fetchRelated('user'); 
```

# java - 计算对象的内存占用，需要说明

> ID：11253228
> 
> 赞同：1
> 
> 时间：2012-06-28T21:34:17.927
> 
> 标签：java, instrumentation

跑步时

```
java -javaagent:ObjectSizeFetcherAgent.jar PersistentTime 
```

我明白了

## 24

这个什么时候`ObjectSizeFetcherAgent`做

```
public class ObjectSizeFetcher {
    private static Instrumentation  instrumentation;

    public static void premain(String args, Instrumentation inst) {
        instrumentation = inst;
    }

    public static long getObjectSize(Object o) {
        return instrumentation.getObjectSize(o);
    }
} 
```

当`PersistentTime`看起来如下

```
public class PersistentTime {

    List<String>    list    = new ArrayList<String>();

    public static void main(String[] args) {

        PersistentTime p = new PersistentTime();

        p.list.add("a");  // The number is the same with or without this
        p.list.add("b");  // The number is the same with or without this
        p.list.add("c");  // The number is the same with or without this

        System.out.println(ObjectSizeFetcher.getObjectSize(p));
    }
} 
```

**为什么向列表中添加元素没有影响？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T21:42:47.723

因为`getObjectSize`返回（特定于实现的近似值）对象的浅大小。这意味着它包括对 List 的*引用*的大小，但不包括列表本身占用的空间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T21:47:48.667

您的`PersistentTime`对象*仅*包含**一个引用**（对数组列表）。

24 字节对于包含单个*引用*的对象是典型的。

注意：引用的对象不包括在计算中。`getObjectSize`不是递归地收集组合的对象大小。这通常是不可能的：可能有无限的参考循环等；我认为没有容易获得的“深度”计算。

# jsp - 使用 Prepared Statement 将日期插入数据库

> ID：11253229
> 
> 赞同：0
> 
> 时间：2012-06-28T21:34:27.693
> 
> 标签：jsp, date, prepared-statement

我想通过这种方式在 JSP 中使用 Prepared Statement 将用户输入的格式为 YYYY-MM-DD 的日期插入数据库：

```
 SimpleDateFormat reFormat = new SimpleDateFormat("YYYY-MM-DD") 
 Date activityDate = reFormat.parse(request.getParameter("activity_date"));
 java.sql.Date sqlDate = new java.sql.Date(activityDate.getTime());

 String query = "INSERT INTO schedule(login_name,activity_date) VALUES (?, ?)";
 PreparedStatement stmt = connection.prepareStatement(query);
 stmt.setString(1,request.getParameter("name_of_user"));
 stmt.setDate(2,sqlDate);
 stmt.executeUpdate(); 
```

但是，如果用户在数据库中输入例如：2012-06-22，则会保存错误的日期 2012-01-01 而不是 2012-06-22

有谁知道是什么问题？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T21:41:58.447

正确的格式是`yyyy-MM-dd`. `Y`没有任何意义，并且`D`意味着一年中的一天（而不是一个月中的一天）。

# audio - MP3 中的“样本”是什么？

> ID：11253233
> 
> 赞同：7
> 
> 时间：2012-06-28T21:34:49.420
> 
> 标签：audio, mp3

据说，MP3 帧包含 1152 个样本。那么什么是“样本”呢？左右声道的一对值？还是右声道或左声道的单个值？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-29T03:41:33.840

使用的语言可能会有点混乱。唯一的原因是每帧每个音频通道将有 1152 个（或 384 个，或 576 个，取决于 MPEG 版本和层）。由于压缩，数据实际存储的方式比每个通道的单个值更复杂。

如果您想了解更多信息，我会推荐[http://blog.bjrn.se/2008/10/lets-build-mp3-decoder.html](http://blog.bjrn.se/2008/10/lets-build-mp3-decoder.html)一个不错的详细博客，帮助读者了解 MP3 格式为了构建解码器。

您还可以查看[http://wiki.hydrogenaudio.org/index.php?title=MP3#Polyphase_Filterbank_Formula](http://wiki.hydrogenaudio.org/index.php?title=MP3#Polyphase_Filterbank_Formula)以获取更多技术信息。链接锚定到一个特别说明的部分：“音频由每个音频通道的 1152 个样本的帧处理”但是整个页面描述了 MP3 格式的各个方面。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2021-06-12T13:16:43.383

MP3 接收 2304 个 16 位 PCM 样本，每个通道有 1152 个，并且基本上在其上执行重叠的 MDCT，这样每个通道可以获得 576 个频域分量。因为它是半重叠的，所以下一个 MDCT 变换将包括每个通道 756 个新样本和 756 个旧样本，每个通道输出 756 个样本，因此您获得了从时域到频域的 1:1 样本映射。

心理声学模型是执行有损压缩的，我不知道细节。其输出被霍夫曼编码（这是无损压缩）。

每个 MP3 帧包含 2 个 576 个样本的颗粒（对应于 576 个新 PCM 样本和 576 个旧 PCM 样本）。这意味着每个通道 576 个样本，或总共 1152 个样本。因此，每个帧对应于每个通道 1152 个新的 PCM 样本，因此[2304 个样本](https://forum.pjrc.com/threads/38466-Audiolib-MP3)。每个颗粒包含两个通道的霍夫曼位，两个通道的比例因子。帧中的边信息由霍夫曼解码器使用。

样本通常指的是一个时间点，因此这将包括左右通道，但您可以将它们分开。

# c++ - 当应用程序需要更多 RAM 时，如何允许将一段内存换出到磁盘？

> ID：11253238
> 
> 赞同：2
> 
> 时间：2012-06-28T21:35:16.143
> 
> 标签：c++, windows, memory-management, file-mapping

我有一个大的值矩阵，占用大约 2GB 的 RAM。

我需要形成这个矩阵的副本，然后可以将原件换出到磁盘，以便稍后加载。这个矩阵的内容很重要。最初计算它很昂贵，因此您不能轻易将其丢弃并重新创建它。将矩阵放到磁盘上，然后从磁盘重新加载它比从头开始重新计算要快。

有没有比我所拥有的*更简单*或更好的方法来指定一段内存暂时放在磁盘上直到下一次访问，即：

## 当不需要资源（2GB 矩阵）时

*   打开一个文件
*   将文件写入磁盘
*   释放内存

## 当需要资源时

*   打开文件
*   读入矩阵
*   从磁盘中删除文件

我遇到了[文件映射](http://msdn.microsoft.com/en-us/library/aa366801%28VS.85%29.aspx)但我不确定这是正确的使用方法

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T21:44:41.153

看看[内存映射文件](http://msdn.microsoft.com/en-us/library/ms810613.aspx)。

> 内存映射文件 (MMF) 提供了一种独特的内存管理功能，它允许应用程序访问磁盘上的文件，就像访问动态内存一样——通过指针。

操作系统将非常有效地将原始矩阵的部分交换到磁盘或从磁盘交换。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-28T21:46:19.030

假设矩阵不需要在程序重新启动后继续存在，请将您的应用程序编译为 64 位，然后将矩阵留在内存中。操作系统会在内存压力下自动换出最少使用的内存页面。

然而，即使在现代硬件上，您也将拥有超过 2+2 GB ¹的 RAM，而且很有可能一切都将保留在 RAM 中。

*¹原始矩阵 + 副本。*

# c# - 使用 URL 重写

> ID：11253239
> 
> 赞同：1
> 
> 时间：2012-06-28T21:35:19.650
> 
> 标签：c#, asp.net, url-rewriting

我在一台托管服务器下托管 2 个域站点

```
\

 -Site1

 -Site2 
```

我有 2 个域指向托管服务器。

例如

`site1.com`应该指向`site1`文件夹 `site2.com`应该指向`site2`文件夹。

目前在根目录我有默认文件，它将检查 Request.ServerVariables("ServerName") 是否为 site1.com 然后重定向到 (/site1)

所以它显示`site1.com/site1/`和`site2.com/site2/`

如何删除子文件夹？所以它显示`site1.com`和`site2.com`？

我已经研究过使用 URL 重写，但我无法将代码放在一起......我相信每个子文件夹都应该有一个`global.asax`文件，并且 `Application_BeginRequest`我认为我应该做点什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T02:27:04.603

您可以使用 Server.Transfer

代码：

```
void appliaction_BeginRequest(object sender, EventArgs e)
 {
    HttpRequest request = sender as HttpRequest;
     if（request.Url.Host.Contains("site1.com"))
     {
        request.RequestContext.HttpContext.Server.Transfer("site1.com/site1", true);
    }

  } 
```

在浏览器输入site1.com

# django - 表格中的内联标题

> ID：11253240
> 
> 赞同：0
> 
> 时间：2012-06-28T21:35:23.047
> 
> 标签：django, django-forms

我正在尝试使用清晰的表单生成表单，并希望有内联标题，例如，

**个人信息**

姓名 [ ] 地址 [ ]

**评论**

类别 [ ] 留言 [ ]

我看到使用设置字段

```
helper = FormHelper()
helper.form_class = 'form-horizontal'
helper.layout = Layout( ... ) 
```

不会产生任何标题，而只会产生字段的标签。

有谁知道如何将标题整合到表格中？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T22:50:26.017

听起来您正在寻找[`fieldset`](http://www.w3.org/wiki/HTML/Elements/fieldset)：

> fieldset 元素表示一组表单控件，可选地分组在一个通用名称下。

Crispy Forms 有一个用于字段集的布局对象，您可以在这种情况下使用：[`layout.Fieldset`](http://django-crispy-forms.readthedocs.org/en/d-0/api_layout.html#layout.Fieldset)

# python - rpy2 在 debian 上的安装问题

> ID：11253243
> 
> 赞同：1
> 
> 时间：2012-06-28T21:35:27.483
> 
> 标签：python, r, installation, debian, rpy2

我已经尝试了所有我能想到的在我们的 debian 服务器上安装 RPy2 的安装方法，但无论如何我都会收到相同的消息。我已经在我的 Mac 上成功安装并使用了它。有什么我可能会丢失的吗？

**开始**

```
Processing rpy2
Running setup.py -q bdist_egg --dist-dir /opt/rpy2/egg-dist-tmp-oft2ko

returned an empty string.

returned an empty string.

Configuration for R as a library:
  include_dirs: ('/usr/share/R/include',)
  libraries: ('R',)
  library_dirs: ('/usr/lib64/R/lib',)
  extra_link_args: ()
 # OSX-specific (included in extra_link_args)
  framework_dirs: ()
  frameworks: ()
warning: no previously-included files matching '*patch*' found anywhere in distribution
warning: no previously-included files matching '*diff*' found anywhere in distribution
warning: no previously-included files matching '.hg' found anywhere in distribution
warning: no files found matching 'MANIFEST 
```

'

. . .

**结尾**

```
./rpy/rinterface/_rinterface.c:3622: error: ‘embeddedR_isInitialized’ undeclared (first use in this function)
./rpy/rinterface/_rinterface.c:3622: error: ‘Py_False’ undeclared (first use in this function)
./rpy/rinterface/_rinterface.c:3634: error: ‘Py_None’ undeclared (first use in this function)
./rpy/rinterface/_rinterface.c:3635: error: ‘PySexpObject’ has no member named ‘sObj’
./rpy/rinterface/_rinterface.c:3637: error: expected expression before ‘)’ token
./rpy/rinterface/_rinterface.c:3650: error: ‘PySexpObject’ has no member named ‘sObj’
./rpy/rinterface/_rinterface.c:3652: error: expected expression before ‘)’ token
./rpy/rinterface/_rinterface.c:3665: error: ‘PySexpObject’ has no member named ‘sObj’
./rpy/rinterface/_rinterface.c:3667: error: expected expression before ‘)’ token
./rpy/rinterface/_rinterface.c:3680: error: expected expression before ‘)’ token
./rpy/rinterface/_rinterface.c:3694: error: expected expression before ‘)’ token
./rpy/rinterface/_rinterface.c:3705: error: ‘rinterface_unserialize’ undeclared (first use in this function)
./rpy/rinterface/_rinterface.c:3705: warning: implicit declaration of function ‘PyDict_GetItemString’
error: Setup script exited with error: command 'gcc' failed with exit status 1 
```

感谢您的帮助

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-28T21:41:16.460

请试试

```
sudo apt-get install python-rpy2 
```

（或使用您喜欢的任何包装前端）因为包存在于发行版中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T20:01:22.390

如果你编译 R

`./configure --enable-R-shlib`, 然后 R 安装在`/usr/local/lib/R`

因此，您可以将此行添加到 .bashrc，供您和 root 用户使用

```
export R_HOME=/usr/local/lib/R
export LD_LIBRARY_PATH=${LD_LIBRARY_PATH}:$R_HOME/lib 
```

然后你可以从 pip 安装或从 tarball 构建

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T03:38:48.563

正如[Ubuntu 上的 rpy2 安装中](https://stackoverflow.com/questions/4723607/rpy2-installation-on-ubuntu)所指出的，有时缺少 python-dev（RHEL 中的 python-devel）可能会导致这些问题。您可以通过以下任一方式修复

```
 sudo apt-get install python-dev 
```

或者

```
 sudo yum install python-devel 
```

或用于安装 python-dev[el] 的其他操作系统特定说明

# powershell - 将用户名添加到文件路径

> ID：11253246
> 
> 赞同：2
> 
> 时间：2012-06-28T21:35:42.917
> 
> 标签：powershell, powershell-2.0

我正在尝试将用户名添加到文件路径，以便我可以创建一个包含其用户名的目录。

这就是我希望我的用户文件夹的外观：

`D:\Test Space\ArtP$`

当我在外壳中执行此操作时：

```
PS > $samAccountName = "ArtP"
PS > $user_folder = "D:\Test Space\$samAccountName$"
PS > $user_folder
D:\Test Space\ArtP$ 
```

它按预期工作。然后我在一个应该在远程服务器上执行此操作的脚本中尝试此操作：

```
 $samAccountName = "ArtP"
 $user_folder = "D:\Test Space\$samAccountName$"
 invoke-command -computername remote_server -scriptblock {
     new-item -path $user_folder -type directory -Force
 } 
```

我收到以下错误：

```
Cannot bind argument to parameter 'Path' because it is null.
    + CategoryInfo          : InvalidData: (:) [New-Item], ParameterBindingValidationException
    + FullyQualifiedErrorId : ParameterArgumentValidationErrorNullNotAllowed,Microsoft.PowerShell.Commands.NewItemComm
   and 
```

它是说我的路径是空的，我相信关于 shell 如何解释引号和脚本的方式存在一些差异。如何在上面的文件路径中正确获取我的用户名？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T21:46:22.103

[请参阅如何为远程命令传递参数](http://blogs.msdn.com/b/powershell/archive/2009/12/29/arguments-for-remote-commands.aspx)中有关传递本地值的部分

```
$samAccountName = "ArtP"
$user_folderLocalValue = "D:\Test Space\$samAccountName" 
```

使用参数：

```
invoke-command -computername remote_server -scriptblock {
param($user_folder)
new-item -path $user_folder -type directory -Force
} -Args $user_folderLocalValue 
```

或使用 $args

```
invoke-command -computername remote_server -scriptblock {
new-item -path $args[0] -type directory -Force
} -Args $user_folderLocalValue 
```

# php - 一个视图由两个不同的控制器调用（视图中包含的表单调用另一个控制器）

> ID：11253249
> 
> 赞同：1
> 
> 时间：2012-06-28T21:35:56.470
> 
> 标签：php, model-view-controller, codeigniter

亲爱的朋友们： 这似乎更像是一个概念问题而不是编程问题。我是 MVC 的新手，在理解什么可以调用什么方面存在问题。程序控制的流程。

问题：控制器 A --Calls-->Model A--calls-->View A。现在，一旦加载了 View A，它还包含一个用于插入带有 sumbitt 按钮的评论的表单。

一旦评论被插入（并提交），它就会调用 Controller B--calls-->Mocel B. 它将数据插入评论表中——而且它没有要调用的视图。

问题1：如何从模型B调用控制器A（因为模型B没有视图）。可以从 ModelB 加载 ViewA，但这需要重写 Controller a 中已经存在的代码。此外，我希望将评论表单插入到许多页面中，因此我必须手动重新加载所有这些页面（视图）。

问题 2：可以将评论表单（控制器 B 和模型 B）作为控制器 A 和模型 A 的一部分，但是评论表单将不再是可重复使用的模块，并且需要插入到我喜欢的每个页面中中使用。

问题3：我是否有一些概念上的错误。这是MCV的工作方式吗？

总结：：有一个由Controller B和Modal B管理的表单（它没有视图，它显示为由控制器A，模型A和视图A管理的页面的一部分）模型B完成工作后需要调用控制器A（以便它可以刷新页面）如何？提前感谢您勇敢的灵魂

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T21:39:58.463

我认为你的策略有点偏离开始

> Controller A --Calls-->Model A--calls-->View A

你的模型真的不应该调用你的视图。控制器通常负责此操作。向控制器发出请求，控制器从模型中获取所有数据，然后使用视图对其进行格式化/模板化并将其输出给用户。控制器应该是每个请求的中心。

> QUESTION 1 如何从 Model B 调用 Controller A？

Model B 真的不应该调用控制器。MVC 真的不是为此而设计的。如果您需要模型 B 的数据，请从控制器获取。如果您需要控制器 A 中存在的功能，请将其重构为可在应用程序中的任何位置使用的实用程序功能。

> 问题2：可以将评论表单（控制器B和模型B）作为控制器A的一部分吗？

是的，这再次来自一个好的应用程序设计。我想您的模型之一能够检索评论。也许每个用户也许每个时间框架。您可以从控制器 A 调用该模型函数。通过加载模型`$this->load->model('Post')` 并撤消您的帖子`$this->Post->most_recent_posts()`。

> 问题3：我是否有一些概念上的错误。这是MCV的工作方式吗？

是的，您网站的功能与其控制器和模型的绑定过于紧密。它们必须更松散/通用，因此可以在任何控制器中使用功能。

我想回答你最后/主要的一点，但看到一些代码真的很有帮助。

# bash - 合并两个文件的方法，需要意见

> ID：11253252
> 
> 赞同：0
> 
> 时间：2012-06-28T21:36:05.637
> 
> 标签：bash, sed, awk

问题：我有两个文件夹（一个是 Delta 文件夹 - 文件更新的地方，另一个是原始文件夹 - 原始文件存在的地方）。每次 Delta 文件夹中的文件更新时，我都需要将原始文件夹中的文件与 Delta 文件夹中的更新文件合并。

**注意：**虽然 Delta 文件夹和 Original 文件夹中的文件名是唯一的，但文件中的内容可能不同。例如：

```
$ cat Delta_Folder/1.properties
account.org.com.email=New-Email
account.value.range=True

$ cat Original_Folder/1.properties
account.org.com.email=Old-Email
account.value.range=False
range.list.type=String
currency.country=Sweden 
```

现在，我需要将 Delta_Folder/1.properties 与 Original_Folder/1.properties 合并，所以我更新后的 Original_Folder/1.properties 将是：

```
account.org.com.email=New-Email 
account.value.range=True
range.list.type=String
currency.country=Sweden 
```

我选择的解决方案是：

在 Delta-Folder 中找到所有 *.properties 文件并将列表保存到临时文件（delta-files.txt）。

在 Original-Folder 中查找所有 *.properties 文件并将列表保存到临时文件（original-files.txt）

然后我需要获取两个文件夹中唯一的文件列表并将它们放在一个循环中。

然后我需要循环每个文件以从属性文件（1.properties）中读取每一行。

然后我需要从 delta-folder 的属性文件中读取每一行（delta-line="account.org.com.email=New-Email"），并将带有分隔符“=”的行拆分为两个字符串变量。

（delta-line-string1=account.org.com.email；delta-line-string2=New-Email；）

然后我需要从原始文件夹的属性文件中读取每一行（orig-line=account.org.com.email=Old-Email 并用分隔符“=”将行拆分为两个字符串变量。

（orig-line-string1=account.org.com.email；orig-line-string2=Old-Email；）

```
if delta-line-string1 == orig-line-string1 then update $orig-line with $delta-line
 i.e: 
if account.org.com.email == account.org.com.email then replace 

account.org.com.email=Old-Email in original folder/1.properties with 

account.org.com.email=New-Email 
```

一旦循环完成查找文件中的所有行，它就会转到下一个文件。循环继续，直到完成文件夹中的所有唯一文件。

对于循环，我使用**for**循环，对于分割线，我使用**awk**，而对于替换内容，我使用**sed**。

总的来说，它的工作正常，它需要更多的时间（4 分钟）来完成每个文件，因为它为每一行进入三个循环并拆分该行并在其他文件中查找变量并替换该行。

**想知道是否有任何方法可以减少循环，以便脚本执行得更快。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T21:50:55.110

`paste`和`awk`：_

文件 2：

```
$ cat /tmp/l2
account.org.com.email=Old-Email
account.value.range=False
currency.country=Sweden
range.list.type=String 
```

文件 1：

```
$ cat /tmp/l1
account.org.com.email=New-Email
account.value.range=True 
```

命令+输出：

```
paste /tmp/l2 /tmp/l1 | awk '{print $NF}'
account.org.com.email=New-Email
account.value.range=True
currency.country=Sweden
range.list.type=String 
```

`awk`或者如果排序不重要，则使用单个命令：

```
awk -F'=' '{arr[$1]=$2}END{for (x in arr) {print x"="arr[x]}}' /tmp/l2 /tmp/l1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T00:30:12.400

在这里完全可以选择使用数据库吗？

然后你只需要编写代码来从 Delta 文件中提取数据（假设不能被数据库连接替换）。

随着时间的推移，这似乎会变得越来越复杂和越来越慢。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T21:47:23.673

我认为您的两个主要选择是：

1.  用更有特色的语言完全重新实现它，比如 perl。
2.  在读取 delta 文件时，构建一个 sed 脚本。对于 delta 文件的每一行，您需要一个类似于以下内容的 sed 指令：

    ```
    s/account.org.com.email=.*$/account.org.email=value_from_delta_file/g 
    ```

这样，您就不会在原始文件中循环播放很多次。不要忘记逃避 & / 和 \ 如[this answer](https://stackoverflow.com/questions/407523/escape-a-string-for-sed-search-pattern)中所述。

# android - 支持不同的屏幕尺寸

> ID：11253257
> 
> 赞同：0
> 
> 时间：2012-06-28T21:36:21.133
> 
> 标签：android, android-layout, android-emulator, google-play, android-screen-support

我想制作支持所有Android设备（平板电脑和手机）的游戏。我可以通过编码获得屏幕尺寸。我是否已将 3 0r 4 布局设为小、中和大？小号、中号、大号和特大号分别是什么尺寸？有没有其他方法可以为所有设备设置布局？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T07:25:42.447

(1) 支持所有布局尺寸的一种方法是将合适尺寸的图片放入drawable-hdpi、drawable-mdpi、drawable-ldpi和drawable-xhdpi。Android 运行时系统会自动选择特定屏幕尺寸设备的图像。在这种方法中，您不必为每种尺寸制作不同的布局文件。

(2) 第二种方法是动态检测设备的尺寸（密度），然后相应地设置布局，可以这样完成：

```
 DisplayMetrics displayMetrics = new DisplayMetrics();
    getWindowManager().getDefaultDisplay().getMetrics(displayMetrics);
    switch(displayMetrics.densityDpi){ 
        case DisplayMetrics.DENSITY_LOW: 
            // your layout for small-size devices.
            break; 
        case DisplayMetrics.DENSITY_MEDIUM: 
            // your layout for medium-size devices.
            break; 
        case DisplayMetrics.DENSITY_HIGH: 
            // your layout for big-size devices.
            break; 
    } 
```

在这种方法中，您可能必须为每种尺寸分别制作不同的布局文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T21:43:15.287

这是您需要的 Android 文档：

[http://developer.android.com/guide/topics/resources/providing-resources.html](http://developer.android.com/guide/topics/resources/providing-resources.html)

您可以使用屏幕尺寸、屏幕像素密度或其他因素来确定如何分隔布局。

您可以指定不同的布局（您应该尝试这样做）。不同的尺寸可以使用相同的布局。设备最终使用的布局取决于一组规则。

因此，例如，如果您想使用屏幕尺寸，您需要在 res 文件夹下创建名为 layout-small、layout-medium、layout-large、layout-xlarge 的文件夹。这是因为 layout 是布局资源的默认文件夹，然后你添加一个 -。在本例中，为 small、medium、large 或 xlarge。

编辑：上面亚历克斯的链接可能是您正在寻找的。我的链接更多是关于如何做到这一点，但亚历克斯的链接更多是关于如何做好。我不确定你到底在问什么。

# java - 如何在 JPanel 上放置扩展栏？

> ID：11253259
> 
> 赞同：0
> 
> 时间：2012-06-28T21:36:23.957
> 
> 标签：java, eclipse, menu

有没有办法在 jframe 或 jpanel 上添加扩展栏，而无需使用代码创建每个组件（使用已创建的组件）。

这是我使用的代码：（[http://www.eclipse.org/swt/snippets/#expandbar](http://www.eclipse.org/swt/snippets/#expandbar)）

```
Display display = new Display ();
Shell shell = new Shell (display);
shell.setLayout(new FillLayout());
shell.setText("ExpandBar Example");
ExpandBar bar = new ExpandBar (shell, SWT.V_SCROLL); 
```

我尝试将扩展栏添加到面板，以及尝试将显示和外壳添加到面板，但不起作用。

请帮忙。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T22:18:03.850

根据我在网上看到的示例，您的代码相当不完整。我不太了解，`SWT`但`ExpandBar`它不是`Component`nor的子类，`Container`因此不能将它们添加到`Panel`or `Frame`。[在这里](http://www.roseindia.net/tutorials/swt/create-expand-bar-swt.shtml)
找到了一个很好的例子。

我测试了它并且它有效。

该`ExpandBar`文档可在[此处找到](http://help.eclipse.org/indigo/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/api/org/eclipse/swt/widgets/ExpandBar.html)

# css - 显示：表格单元格混乱

> ID：11253260
> 
> 赞同：0
> 
> 时间：2012-06-28T21:36:24.417
> 
> 标签：css, alignment, sass

我在包装器 div 元素中有一组 28 个链接。每一个都是字母表中的一个字母加上一个 # 表示数字和一个表示“全部”。每个都向左浮动。我希望文本水平和垂直居中。使用下面的代码，我将它水平居中，但是当我期望它这样做时，vertical-align: middle 似乎没有任何效果，因为您可以在具有 display: table-cell 的元素上使用它。有人有想法么？

```
a {
  float: left;
  position: relative;
  display: table-cell;
  width: 30px;
  height: 30px;
  margin: 0 4px 4px 0;
  @include border-radius(4px);
  text-align: center;
  vertical-align: middle;
  text-decoration: none;
  color: #fff;
  @include blue-gradient;

  &:nth-of-type(14n) {
    margin-right: 0;
  }

  &:hover {
    top: -1px;
  }
} 
```

亲切的问候，尼尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T21:44:42.510

你可以使用：

```
line-height: 30px; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T21:46:58.980

我会使用 line-height 属性来垂直居中。我发现垂直对齐很少起作用，因为它与其他属性冲突并且浏览器会忽略它。

# objective-c - 为什么我的 UIActionSheet 被 TabBarController 隐藏了？

> ID：11253264
> 
> 赞同：1
> 
> 时间：2012-06-28T21:36:44.590
> 
> 标签：objective-c, ios, xcode, ipad

我在 iPad 5.1 (XCode 4.3) 项目中正确实现 UIActionSheet 时遇到问题。我可以用我需要的所有项目正确地填充它。该列表比窗口长，但滚动条会自动出现，等等。但是，取消按钮（我认为应该在最后）在我的标签栏后面隐藏了一半。如下图所示：

（对不起，所以不会让我发布图片）

这是我的故事板设置：入口点是左侧的选项卡栏控制器，它转到另一个导航控制器（中心），右侧的视图控制器作为根视图。 [http://i854.photobucket.com/albums/ab103/srVincentVega/ScreenShot2012-06-28at52713PM.png](http://i854.photobucket.com/albums/ab103/srVincentVega/ScreenShot2012-06-28at52713PM.png)

我尝试过以各种方式呈现 UIActionSheet，但这种奇怪的行为仍然存在，我不知道如何解决它

```
- (IBAction)cmdReason:(id)sender
{
    NSArray *reasons = [AppState getInspReasons];

    UIActionSheet *action = [[UIActionSheet alloc]
                             initWithTitle:@"Reason for Inspection"
                             delegate:self
                             cancelButtonTitle:@"Cancel"
                             destructiveButtonTitle:nil
                             otherButtonTitles:nil];

    for (NSString *rsn in reasons)
    {
        [action addButtonWithTitle:rsn];
    }

    [action showInView:self.view];
} 
```

我已经尝试了各种方法来显示“动作”——showFromTabBar、showFromToolbar 等——我对这个开发环境非常陌生，所以我还没有跟上这些项目在这个级别如何交互的速度。有人对我如何正确呈现这个有建议吗？

我很抱歉，如果这已经在其他地方被问过。我整天都在尝试来自整个网络的一些代码，包括 SO。我不知道这是否与我的故事板布局有关，或者什么。

还有一件事——当我旋转模拟器时，动作表确实会重绘，但最后的那一点看起来很奇怪，就像它不再知道如何绘制它一样。

非常感谢！

**编辑：** 我整理了一个非常小的项目来展示这种确切的行为。我没有托管 zip 文件的好方法，所以我放了谷歌文档并分享了它。链接如下。如果您单击它，文件下应该有一个下载选项，它将为您提供原始 zip 文件。

[https://docs.google.com/open?id=0B7IYvy9_c_NLaEFneGc5bzc2S2c](https://docs.google.com/open?id=0B7IYvy9_c_NLaEFneGc5bzc2S2c)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T18:07:03.937

似乎没有真正的解决方案。`UIActionSheet`如果您添加这么多按钮标题并从标签栏显示它，这似乎是一个限制。

除此之外，从标签栏显示的正确方法`UIActionSheet`是使用

```
[action showFromTabBar:self.tabBarController.tabBar]; 
```

代替

```
// Taken from your example project
AppDelegate *d = [[UIApplication sharedApplication] delegate];
UIWindow *w = d.window;
UIViewController *vc = w.rootViewController;
UITabBarController *c = (UITabBarController *)vc;
UITabBar *t = c.tabBar;
[action showFromTabBar:t]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T22:42:55.420

尝试这个：

```
CGRect r = CGRectMake(x, y, w, h); //change values to fit location of button
[actionSheet showFromRect:r inView:self.view animated:YES]; 
```

我在我的一个有同样问题的应用程序上使用了它，并且关闭按钮显示正常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T21:41:52.537

我想如果你得到标签栏控制器的引用，那么你应该能够从中呈现它。您可以尝试从主窗口显示它，但我认为您不应该依赖它。

```
[action showInView:[[UIApplication sharedApplication] keyWindow]]; 
```

# android - 即使手机关机，如何安排将来执行的任务

> ID：11253265
> 
> 赞同：0
> 
> 时间：2012-06-28T21:36:44.730
> 
> 标签：android, scheduled-tasks

我需要安排一个任务（例如发送电子邮件或关闭电话）**在未来的某个日期和时间**执行（例如 2013 年 6 月 12 日下午 3:00）

我希望他们完成多项任务，不同的时间，即使手机关机也能持久。

我已经搜索过，但结果有点令人困惑。任何人都可以指导我解决问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T21:45:37.937

> 我需要安排一项任务（例如发送电子邮件或关闭电话）

除非您正在构建自己的固件，否则您无权“关闭手机”。

> 在未来的某个日期和时间执行（例如 2013 年 6 月 12 日下午 3:00）

离开一年有点不寻常。

> 我想要……即使手机关机也要坚持。

这是不可能的，除非“关闭”是指“处于睡眠模式”。在这种情况下，从战术上讲，[使用`AlarmManager`, 和`_WAKEUP`-style alarm](http://developer.android.com/reference/android/app/AlarmManager.html)。

话虽如此，`AlarmManager`并不完全是为未来一年的东西设计的。您可能只想为下周的活动安排活动，包括让您安排下周活动的活动。

而且，如果手机真的关机了（即长按电源键后“关机”），你的闹钟不会响，当设备​​重新开机时你需要重新安排它们。

# c# - 让 C# 识别 Visual Studio 之外的 dll

> ID：11253267
> 
> 赞同：2
> 
> 时间：2012-06-28T21:37:08.410
> 
> 标签：c#, dll, asp-classic, vbscript, .net-2.0

在我开始从事这项工作的几年前，另一位不再在这里的开发人员使用 HTML、vbscript 和 javascript 用经典的 ASP 编写了一个应用程序。这很好，但问题是 2 个页面是用 C# 编写的，带有一个 HTML 文件和一个代码隐藏文件。这两个页面没有解决方案文件。它们可能最初是在 Visual Studio 中创建的，但现在不存在于其中。

这很重要，因为 Visual Studio 为您做了很多事情，甚至无需考虑。

我的问题是，在这两个 C# 页面中，我需要让它们引用 DLL。使用 Visual Studio 时，这是一项简单的任务。您只需添加对项目的引用，生活就很好。但在 VS 之外似乎没有任何效果。

我尝试将 dll 与页面放在同一文件夹中，然后尝试以下操作：

*   使用我的DLL；
*   myDLL dll = 新的 myDLL();
*   我的DLL dll = myDLL();

我在网上找到了一些代码，说要创建一个内部静态类并使用 [DLLImport()]，但这也不起作用。它找不到 dll 或 dll 的入口点。我目前正在研究如何创建一个入口点，以防万一这是使一切正常的方法。

除了必须用 vbscript 重写这些页面（我没有时间这样做）之外，我不知所措。

有没有人遇到过这个问题？有什么可以放在 web.Config 中的吗？或者这只是不可能的，我被水洗了。

顺便说一句，这一切都在 2.0 .net 框架下运行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T21:44:25.280

如果您将希望代码引用的 DLL 放入网站的 bin 文件夹中，则打开 web.config 并找到以下部分`configuration -> system.web -> compilation -> assemblies`。

您需要将程序集的显示名称添加到该列表中 - 以便编译器在其后期绑定构建过程中引用该程序集。

现在您应该能够在这些页面上使用其中的内容了。

如果您不知道程序集的显示名称（通常`yourassembly, version=*.*.*.*, Culture=neutral, PublicKeyToken=null`用于文化不变、非强命名程序集），您可以在[ILSpy](http://wiki.sharpdevelop.net/ILSpy.ashx)之类的工具中打开它（还有其他工具，它只是我最喜欢的）它告诉当您在其 UI 中选择它时：

![ILSpy 显示程序集的显示名称](../Images/49faba8836d2346b02e2c3dfa3627d43.png)

*很抱歉突出显示效果不佳 - 喝了太多咖啡后手生涩*

如果该程序集中的所有代码都在单个命名空间中，您还可以`using`通过添加该命名空间来为项目中的所有 .cs 或 .aspx 代码添加默认值`configuration -> system.web -> pages -> namespaces`- 从而更简单地在页面中使用该代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T20:47:36.557

I created a VS Solution/Project for my app. I compiled and published it to the web server. When I published it I had it copy all project files.

I ran it and it crashed because it could not find my dll.

I tried adding the lines that Andras mentioned above and it seemed like it was getting me closer but it only changed the errors I was getting.

Then I went into IIS on the web server. I expanded the folder listing under Web Site. I right clicked on the folder that contained my app and made that folder into an application folder.

After I did that everything just worked. So then I thought I would see what happened if I backed out all of the additional code I added to my C# app and the Web.Config file. It still worked. All I needed to do was to make the folder an application folder in IIS and put a Using statement in my C# app and life is wonderful again.

Thanks for all the comments and suggestion. Andras thanks for the link to ILSpy. That is a cool little tool.

Take care, Robert

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T21:41:11.993

我同意 Jon 的观点，听起来您应该尝试为这些文件创建一个新项目。让代码变得更好总是比你发现它更好。如果由于某种原因不能选择新项目，您应该在问题中指出这一点。

# javascript - 页面退出警报消息在 Firefox 中不起作用

> ID：11253270
> 
> 赞同：1
> 
> 时间：2012-06-28T21:37:24.960
> 
> 标签：javascript, html, javascript-events

嗨，我在一个页面上有我的 javscript 警报，它用我的自定义消息提醒用户。

> 关于我的脚本，当用户尝试退出或刷新页面时，他们会收到我的自定义消息 **“请留在此页面上以享受折扣”**的警报 当他们选择留下时，他们会被重定向到 **discount_offer.html**

**我的脚本：**

```
<script language="javascript">
    var vals=0;
    function displayMsg() {
        window.onbeforeunload = function evens(evt) {}
            window.location.href = 'discount_offer.html';
    }
    window.onbeforeunload = function evens(evt) {
    var message = 'Please Stay on this page to avail discount';
      if (typeof evt == 'undefined') {
          evt = window.event;
      }
        timedCount();
        vals++;
      if (evt) {
          evt.returnValue = message ;
          return message ;
      }
      trace(evt);
    }
    function timedCount()
    {
        t=setTimeout("timedCount()",100);
        if(vals>0)
        {
            displayMsg();
            clearTimeout(t);
        }
    }
    </script>

<p> <h1> My page Content here! </h1> </p> 
```

***>> 问题：***

我的脚本在 Chrome 中完美运行，但在 Firefox 中没有显示我的自定义消息。相反，它会显示一条 Firefox 默认消息：**

“此页面要求您确认是否要离开 - 您输入的数据可能无法保存”

***>> 我的问题是：***

我怎样才能摆脱这个默认的 Firefox 消息并显示我的消息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T21:56:24.067

不，您无法更改它：

在 FF 4 及更高版本中，根据此[错误](https://bugzilla.mozilla.org/show_bug.cgi?id=588292)，返回的字符串不会显示给用户。

另一种解决方案是突出显示未保存的字段和/或在页面上的某处放置消息。

# jquery - jQuery Ajax 成功/错误回调未在 IE 中触发

> ID：11253275
> 
> 赞同：3
> 
> 时间：2012-06-28T21:37:49.520
> 
> 标签：jquery, ajax, internet-explorer

我一直在尝试让 ajax 调用在 IE9 中正常工作。我可以在网络数据中看到请求顺利通过。jQuery $.ajax() 调用返回的 jqXHR 对象包含响应数据。然而，我的成功/错误/完成回调没有触发。这是代码...

在我的脚本顶部：

```
// override xhr for browser that use XDR
if ('XDomainRequest' in window && window.XDomainRequest !== null) {

  // override default jQuery transport for IE
  jQuery.ajaxSettings.xhr = function() {
      try { return new XDomainRequest(); }
      catch(e) {
        console.log('test'); 
      }
  };

  // Maybe a 304 response is causing the callbacks not to fire?
  // This makes sure I'm getting 200
  jQuery.ajaxSettings.cache = false;

  // also, override the support check
  jQuery.support.cors = true;
} 
```

然后我的ajax调用......很简单。

```
$.ajax({
    url: url,
    success: success,
    complete: complete,
    beforeSend: beforeSend,
    error: error
});

function success(response, textStatus, jqXHR){
    console.log('success');
    if( typeof fn == 'function'){
        fn(response.data);
    } else {
        console.log('Invalid callback supplied for dataGateway');
    }
}

function error(jqXHR, textStatus, errorThrown){
    console.log("Could not retrieve data from API.");
    return;
}

function complete(jqXHR, textStatus){
    console.log('complete');
}

// This is the only callback that gets fired
function beforeSend(jqXHR, settings){
    console.log('before send');
} 
```

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T22:37:45.573

不知道这是否有帮助，但这是我的工作 ajax 调用的一个示例。

```
 $.ajax({
        url: "http://myurl.com",
        type: "POST",
        dataType: "xml",
        data: GetCurrentUserSoapEnv, //my variable containing the xml I sending
        complete: processResult, //the function to call on completion
        contentType: "text/xml; charset=\"utf-8\""
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T00:17:04.740

我知道这与您正在寻找的方法不同，并且您可能已经解决了您的问题，但我最近正在处理类似的 IE 兼容性问题，我认为仅使用 XDomainRequest 的内置处理程序会更简单。

尽管为拒绝遵循标准的浏览器设置例外是令人厌恶的，但我在我的项目中使用类似以下的内容来解释这种情况：

```
 // This is necessary due to IE<10 having no support for CORS.
function fallbackXDR(callObj) {
    if (window.XDomainRequest) { 
        var xdrObj = new XDomainRequest();
        xdrObj.timeout = callObj.timeout;
        xdrObj.onload = function() {
            success({data:xdrObj.responseText});
            complete();
        };
        xdrObj.onerror = function() {
            error(xdrObj);
        };
        xdrObj.ontimeout = function() {
            callObj.xdrAttempts = callObj.xdrAttempts++ || 1;
            if (callObj.xdrAttempts < callObj.maxAttempts) {
                fallbackXDR(callObj);
            }
        };
        xdrObj.onprogress = function() {
            // Unfortunately this has to be included or it will not work in some cases.
        };

        // Use something other than $.param() to format the url if not using jQuery.
        var callStr = callObj ? '?'+$.param(callObj.urlVars) : '';
        xdrObj.open("get", callObj.url+callStr);
        xdrObj.send();
    } else {
        handleError("No XDomainRequest available.", callObj);
    }
}//fallbackXDR() 
```

# objective-c - 混合两个图像并从两个 UIImageViews 绘制调整大小的图像

> ID：11253279
> 
> 赞同：1
> 
> 时间：2012-06-28T21:38:20.697
> 
> 标签：objective-c, ios, xcode, cocoa-touch, uiimageview

我有两个 ImageView，一个称为 imageView，另一个称为 subView（它是 imageView 的子视图）。

我想将这些视图上的图像混合在一起，用户可以用平底锅切换混合的 alpha。我的代码可以工作，但是现在代码很慢，因为每次移动平移手势时我们都在重绘图像。有没有更快/更有效的方法来做到这一点？

奖金问：我想允许我的 subView 图像放大绘制。目前我已经将我的 subView 设置为 UIViewContentModeCenter，但是我似乎无法使用这种内容模式绘制我的图像的一部分。有没有办法解决？

我的drawrect：

```
- (void)drawRect:(CGRect)rect
{
float xCenter = self.center.x - self.currentImage1.size.width/2.0;
float yCenter = self.center.y - self.currentImage1.size.height/2.0;

subView.alpha = self.blendAmount;  // Customize the opacity of the top image.

UIGraphicsBeginImageContext(self.currentImage1.size);

CGContextRef c = UIGraphicsGetCurrentContext();

CGContextSetBlendMode(c, kCGBlendModeColorBurn);
[imageView.layer renderInContext:c];

self.blendedImage = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext();
[self.blendedImage drawAtPoint:CGPointMake(xCenter,yCenter)];

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T21:57:36.887

您需要使用 GPU 进行图像处理，这比使用 CPU 快得多（就像您现在正在做的那样）。

您可以使用非常快速且易于使用但需要 iOS 5 的[Core Image框架，或者您可以直接使用](http://developer.apple.com/library/ios/#documentation/graphicsimaging/Conceptual/CoreImaging/ci_intro/ci_intro.html)[Open GL](http://developer.apple.com/library/ios/#samplecode/GLImageProcessing/Introduction/Intro.html)，但您需要有经验并了解一些有关 Open GL 着色的知识。

# powershell - 使用 Powershell 将文档添加到带有其他列数据的文档库

> ID：11253280
> 
> 赞同：0
> 
> 时间：2012-06-28T21:38:26.133
> 
> 标签：powershell, sharepoint-2010, document-library

我正在尝试遍历目录中的 pdf 文件并将它们发送到共享点文档库。当我发送它们时，我也想将客户、发票等添加到列表中。有人有建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T17:19:49.397

当然。这可以很容易地完成。这是我过去用作参考的文章：

[http://blogs.technet.com/b/heyscriptingguy/archive/2010/09/23/use-powershell-cmdlets-to-manage-sharepoint-document-libraries.aspx](http://blogs.technet.com/b/heyscriptingguy/archive/2010/09/23/use-powershell-cmdlets-to-manage-sharepoint-document-libraries.aspx)

设置元数据也应该很容易，但 PowerShell 无法猜测客户、发票等是什么。所以你必须有一些数据源。如果文件名包含数据，您可以拆分它。如果数据在文件本身中，有一些方法可以从 PDF 中获取纯文本字符串，但这会比您的请求的第一部分更难一些。

让我知道我是否可以在任何细节方面提供进一步帮助。

# ruby - 稍后定义的类上的模块实例方法

> ID：11253282
> 
> 赞同：3
> 
> 时间：2012-06-28T21:38:41.813
> 
> 标签：ruby

我想指出，这完全是一个虚构的问题。我知道还有其他方法可以做到这一点。

我想像这样声明一个模块

```
module Foo
 # some logic here to
 # get instance method 'foo' on
 # a later defined class
end 
```

然后稍后我想声明一个类，如：

```
class Foo::Bar
end 
```

然后不使用包含或扩展就可以做到这一点：

```
Foo::Bar.new.foo 
```

并让它调用我在模块 Foo 中定义的 foo 方法

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T21:41:02.903

```
module Foo
 class Bar
   def foo
     puts "erik is a dummy"
     end
   end
 end
Foo::Bar.new.foo
=> erik is a dummy 
```

# visual-studio-2010 - 设置项目中的快捷方式目标无效或未指定

> ID：11253283
> 
> 赞同：3
> 
> 时间：2012-06-28T21:38:42.307
> 
> 标签：visual-studio-2010, setup-project

几乎每次我在解决方案中构建安装项目时，都会收到以下错误：“快捷方式的目标无效或未指定”。MSDN 提供[了以下无用的帮助](http://msdn.microsoft.com/en-us/library/63a4cstk.aspx)。当我转到对话框以（重新）选择快捷方式的目标时：

![在此处输入图像描述](../Images/326465cda0c5f4f7b0ec8d00e59a19c9.png)

我的主要输出（对于我的主要应用程序）*不存在*，即使它肯定列在文件系统视图中：

![在此处输入图像描述](../Images/f898d8b6b7348a1748b6d6d69e411e16.png)

安装项目被删除并*完全*重新创建，并签入。当它被签出时，我得到了完全相同的错误。

我假设无论是什么原因导致该项目没有出现在“选择目标”对话框中，这与构建失败的原因相同。是什么赋予了？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-10T18:33:17.023

**我刚刚通过将构建模式从调试更改为发布解决了这个问题。**

... (Release x86) 的主要输出 -**它正在寻找 x86 的发布版本。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-06T14:48:08.350

如果您查看错误列表，您应该会看到列出的错误。右键单击它并选择属性窗口。找到“目标”属性并将其设置为正确的值。这也适用于图标问题。

# java - jstat：OGC&OC、PGC&PC的区别

> ID：11253285
> 
> 赞同：10
> 
> 时间：2012-06-28T21:38:58.417
> 
> 标签：java, garbage-collection, jstat

我正在学习 jstat 以及它可以告诉我有关 JVM 不同代的信息。从[jstat 文档](http://docs.oracle.com/javase/6/docs/technotes/tools/share/jstat.html)中，我了解到新一代由 eden、s0 和 s1 组成。例如，如果您对以下内容进行数学运算，您会看到 NGC = EC + S0C + S1C。好东西。

```
$ jstat -gccapacity -t 21830 5000
Timestamp        NGCMN    NGCMX     NGC     S0C   S1C       EC      OGCMN      OGCMX           OGC         OC      PGCMN    PGCMX     PGC       PC     YGC    FGC 
       248767.4   2624.0  87360.0   6656.0  640.0  640.0   5376.0     5376.0   174784.0    12840.0    12840.0  21248.0 131072.0  34304.0  34304.0    457    73
       248772.4   2624.0  87360.0   6656.0  640.0  640.0   5376.0     5376.0   174784.0    12840.0    12840.0  21248.0 131072.0  34304.0  34304.0    457    73
       248777.3   2624.0  87360.0   6656.0  640.0  640.0   5376.0     5376.0   174784.0    12840.0    12840.0  21248.0 131072.0  34304.0  34304.0    457    73 
```

我想知道有什么区别：

*   OGC（当前老一代容量（KB））和
*   OC（当前旧空间容量 (KB)）。

同样适用于：

*   PGC（当前永久发电容量（KB））和
*   PC（当前永久空间容量 (KB)）。

每对都有相同的价值，至少对我来说，现在。除了旧空间之外，旧一代中是否有任何东西？

* * *

编辑：我认为没有区别，但我会留下这个问题以防万一。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-10-31T05:51:00.857

我只是从jdk源中寻找

简而言之： `OGC = sum(all OC)`

一个 gen 可能包含多个空格。

但是，Hotspot old gen 只有 1 个空间（young gen 有 3 个： eden 、 s0 和 s1 ）， jstat 为它们显示相同的值。

**什么是 OC 和 OGC**

从 `jdk/src/share/classes/sun/tools/jstat/resources/jstat_options`

我有

`OGC = sun.gc.generation.1.capacity`

`OC = sun.gc.generation.1.space.0.capacity`

```
 column {
    header "^OGC^"  /* Old Generation Capacity - Current */
    data sun.gc.generation.1.capacity
    scale K
    align right
    width 11
    format "0.0"
  }
  column {
    header "^OC^"   /* Old Space Capacity - Current */
    data sun.gc.generation.1.space.0.capacity
    scale K
    align right
    width 11
    format "0.0"
  } 
```

**GEN.1 中有多少个空间**

运行下面的 groovy 代码来检查

```
import java.lang.management.ManagementFactory
import sun.jvmstat.monitor.*;

name = ManagementFactory.runtimeMXBean.name
pid  = name[0..<name.indexOf('@')]
vmId = new VmIdentifier(pid)
vm   = MonitoredHost.getMonitoredHost(vmId).getMonitoredVm(vmId, 0)

println 'Y count :' + vm.findByName('sun.gc.generation.0.spaces').longValue()
println 'O count :' + vm.findByName('sun.gc.generation.1.spaces').longValue() 
```

输出是：

```
Y count :3
O count :1 
```

你可以对 GEN.2 (PERM GEN) 做同样的事情

# php - ajax 和 php 重新加载以进行分页无法解决

> ID：11253287
> 
> 赞同：1
> 
> 时间：2012-06-28T21:39:08.500
> 
> 标签：php, javascript, jquery, ajax

```
$(function(){
$('.page').click(function() {
    var paging = $(this).attr("name");
    var dataString = 'page='+paging;
    $.ajax({
        type: "POST",
        url: "<?php echo $backtrack; ?>shop.php",
        data: dataString,
        success: function(){
            $('#products').load('shop.php/skateboards/ #products > *', function(){
                $('#products').delay(200).fadeOut();
                $('#products').delay(600).fadeIn();
            });
            $(".current-page").attr("class", "");
        }
    });
    return false;
}); 
```

});

我猜这不起作用，因为我正在重新加载获取帖子的页面部分。我想要做的是将页码发布到当前页面，然后重新加载产品 div 中的项目，它是下一组项目

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T21:48:05.077

我认为你需要做这样的事情：

```
$('.page').click(function() {
    $('#products').delay(200).fadeOut();

    var paging = $(this).attr("name");
    var dataString = 'page='+paging;
    $.ajax({
        type: "POST",
        url: "<?php echo $backtrack; ?>shop.php",
        data: dataString,
        complete: function() {
            $.get('shop.php/skateboards/', function(data) {
                 $('#products').replaceWith(data);
            });
        }
    });
    return false;
}); 
```

# javascript - Javascript Newb：如何将 var 实例化为“blah.1”和“blah.2”？

> ID：11253288
> 
> 赞同：1
> 
> 时间：2012-06-28T21:39:08.893
> 
> 标签：javascript

我目前有一个像这样定义一些变量的块

```
var slider_1  = document.querySelector('#slider_1');
var slider_2  = document.querySelector('#slider_2');
... 
```

带有 ID 的 func 是这样的：

```
function updateFromInput(id){               
    if(id==1){
        var x = input_1.value*1;
        x = Math.round((x*ratio)-offset);     
        slider_1.x.baseVal.value =  x/scale;
    }else if(id==2){
        var x = input_2.value*1;
        x = Math.round((x*ratio)-offset); 
        slider_2.x.baseVal.value =  x/scale;
    }
}; 
```

我正在尝试重构一下。
我在想，如果可以的话，用点而不是下划线来实例化我的变量

```
var slider.1  = document.querySelector('#slider_1');
var slider.2  = document.querySelector('#slider_2'); 
```

然后我就可以更好地利用已经传递到我的函数中的 ID 并消除大量重复。
我希望通过一次调用来简化我的函数，`slider.id.x.baseVal.value = x/scale;`而不是在**每个**IF/ELSE 条件中都有该代码。

但是，当我尝试这样做时，我收到一条错误消息“ *Uncaught SyntaxError: Unexpected number* ”。*这应该*
怎么做？

 ** * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-28T21:40:32.403

您不能在对象中使用纯数字键。

不过，您可以这样做：

```
var slider = {};  // or = [], if array syntax is more appropriate
slider[1] = ...
slider[2] = ... 
```

此外，如果键实际上是变量而不是文字标记，则不允许使用您建议的语法。

在您的示例`slider.id`中，实际上是指具有文字*key的对象，而不是* *变量*碰巧具有`id`的任何值。 *`id`*

 *您必须将变量放在方括号内，即`slider[id]`，因此您的函数将这样编写：

```
function updateFromInput(id){               
    var x = +input[id].value;
    x = Math.round((x*ratio)-offset);     
    slider[id].x.baseVal.value =  x/scale;
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T21:40:42.310

你不能。`.`是变量标识符的无效字符。

您可以在对象属性中使用它。

```
var sliders = {
    "slider.1": document.querySelector('#slider_1'),
    "slider.2": document.querySelector('#slider_2')
}; 
```

然后使用成员运算符的方括号版本来访问该属性。

```
alert( sliders["slider.1"].id ); 
```**

# google-docs - 如何获取 Google Documents List Data API 客户端 ID 和客户端密码

> ID：11253292
> 
> 赞同：1
> 
> 时间：2012-06-28T21:39:39.763
> 
> 标签：google-docs, google-docs-api, google-drive-api

我该怎么做呢？

1.  创建应用程序时，您将其注册到 Google。然后，Google 会提供您稍后需要的信息，例如客户端 ID 和客户端密码。
2.  在 Google API 控制台的服务窗格中激活 Google Documents List Data API。（如果它未在控制台中列出，则跳过此步骤。）
3.  当您的应用程序需要访问用户数据时，它会要求 Google 提供特定的访问范围。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-09-13T10:22:27.577

注意：仅供参考

请参阅如何使用图像制作客户端 ID 和客户端机密请参阅此链接[http://aahow.com/how-to-make-client-id-and-client-secret-for-login-with-google-list-9](http://aahow.com/how-to-make-client-id-and-client-secret-for-login-with-google-list-9)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T03:20:19.613

您无需在 API 控制台中启用文档列表 API，但您必须在同一控制台的 API 访问选项卡中生成 OAuth 2.0 凭据：[https ://code.google.com/apis/console](https://code.google.com/apis/console)

# iphone - 比较两个 NSString 类型的字符串时应用程序崩溃

> ID：11253293
> 
> 赞同：0
> 
> 时间：2012-06-28T21:39:50.890
> 
> 标签：iphone, objective-c, ios

我只是“isEqualToString:”来比较我的 iPhone 应用程序中的字符串。var 值是文本，“subInput”是文本字段中的字符串。到目前为止一切顺利，当输入字段的第一个字符与文本的第一个字符相同时。但是当它们不适合时，应用程序就会崩溃。在开始良好后输入错误的字符时，一切正常。

```
subInput = [[NSString alloc] initWithString:[theInput text]];
compare = [[NSString alloc] initWithString:[value substringToIndex:subInput.length]];

if([subInput isEqualToString:compare]){
//Here the app stops working 
```

我还尝试将结果与“！= 0”或“！= nil”进行比较，但也没有用。

* * *

附加代码

```
if([subInput isEqualToString:compare] != nil){
        NSLog(@"any");
        if([subInput isEqualToString:value]){
            NSLog(@"other");
            NSLog(@"well done");
            theInput.enabled = FALSE;
            lastValid = theInput.text;
            theMessage.backgroundColor = [UIColor orangeColor];
            theMessage.text = @"WELL DONE!!!!";
            theMessage.textColor = [UIColor blackColor];

            //save points for remaining seconds
            score += seconds*10;
            //invalidate counter when typed in all text correct
            [count invalidate];
            [self newTimer:3.0];
        }else{

            if(theInput.text.length >= range){
                NSLog(@"SCROLLEN");
                [theText setSelectedRange:NSMakeRange(range, addRange)];
                range += addRange;
            }
            //NSLog(@"String is ok");
            //self.view.backgroundColor = [UIColor blackColor];
            lastValid = theInput.text;
            theMessage.backgroundColor = [UIColor greenColor];
            theMessage.text = @"GO GO GO";
            theMessage.textColor = [UIColor whiteColor]; 
        }

    } else{
        //incrementing the fail var for every wrong letter
        fails++;

        theInput.text = [@"" stringByAppendingString:lastValid];
        theMessage.backgroundColor = [UIColor redColor];
        theMessage.text = @"WRONG CHARACTER!!!";
        theMessage.textColor = [UIColor whiteColor];
        if (grade >= 2) {
            seconds -= 2;
        }

        if(grade == 3){
            int actual = theInput.text.length;
            actual--;
            NSString *shorterString = [theInput.text substringToIndex:actual];
            lastValid = shorterString;
            theInput.text = shorterString;

        }
        //change bg-color to iritate the player
        self.view.backgroundColor = [UIColor colorWithRed:[self r:255]/255.0 green:[self r:255]/255.0 blue:[self r:255]/255.0 alpha:1];
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T21:59:18.133

您还需要检查 [theInput text] 是否不为零。

```
subInput = [[NSString alloc] initWithString:[theInput text]]; 
```

[NSString initWithString:(NSString *)aString] 上的文档清楚地表明，如果您尝试使用 nil 值进行初始化，则会出现异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T21:47:27.750

您需要检查 value 的长度是否大于 subInput 的长度。如果不是，那么您将超出范围。

# c# - 将测试有效 IP 地址语法和域名语法的函数

> ID：11253297
> 
> 赞同：0
> 
> 时间：2012-06-28T21:39:59.967
> 
> 标签：c#, parsing, syntax, ip-address, domain-name

我在 Windows 窗体中有一个文本框，允许用户输入其设备的主机地址。允许用户输入 IP 地址或域名，我想验证用户的语法是否正确（我不关心主机地址是否存在 - 我只关心语法） .

是否有一个 .NET (2.0) 函数（即 HostAddress.TryParse()）可以测试 IP 和域的给定主机地址的语法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T21:42:58.347

没有什么可以测试两者，我也不知道内置主机地址验证（除非您`Uri.TryParse`对应该为空的段是否为空感到满意并检查）。

您可以`IPAddress.TryParse`在自己的验证功能中使用。

# javascript - HTTP 状态代码 - Backbone.js 和 Jquery

> ID：11253298
> 
> 赞同：3
> 
> 时间：2012-06-28T21:40:10.170
> 
> 标签：javascript, jquery, http, backbone.js, get

Backbone.js 有一个简洁的功能，您可以使用标准 HTTP 动词将更改同步回您的服务器。

例如，您可能有一个模型对象和一些执行 get 的代码：

```
var coolModel = Backbone.Model.extend({url:'mysite/mymodel'});
var myCoolModel = new coolModel();
myCoolModel.fetch({error:processError}); 
```

在服务器返回 4XX 或 5XX 的情况下，将运行错误函数“processError”，这很好，您可以以任何适合的方式处理错误。

由于backbone.js 使用jQuery 执行GET，Jquery 报告错误，它是。4XX 是一个有效的错误，应该从中恢复，我的客户端应用程序没有损坏，它只需要稍微不同的行为。

我的问题是 - 在浏览器控制台窗口或状态栏中显示从 jQuery 引发的此错误是否被认为是不好的做法？我是否应该以某种方式抑制此错误，以便生产中的用户在错误可恢复时看不到浏览器报告的错误？还是在 HTTP 领域保持原样是正确的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T22:12:33.843

在 Backbone 中处理错误是一个非常有趣的话题，我希望在某个时候写出来。以不显眼的方式向用户直观地指示错误非常好。需要考虑的一些事项是：

*   您的用户没有查看状态栏或开发人员工具
*   您的用户期待您的应用程序的特定行为
*   当您的应用程序运行不正确时，视觉问题指示器很重要

我建议考虑失败如何影响用户的意图。例如，如果他们正在为第一页获取数据并且该数据未正确返回，您将需要通过显示检索到的数据失败来处理错误（或者甚至更好地回退到以前从缓存中加载的数据......它它存在）。如果打算保存一个项目并且返回的错误代码是 400，那肯定是不成功的，应该指示用户应该再次重试保存，（或者可能尝试在间隔内重新保存）。

您可以默默地忽略错误而不指出它们，但是您的用户会感到困惑，并且会导致意想不到的问题。我不能宣扬使用完美的错误处理，因为我自己仍然在这方面做得更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T21:49:35.297

我会说 HTTP 状态代码的存在是有原因的，如果它们的原因是有效的，则完全有效，所以是的，只需使用它们。*然而*：`400`means `Bad Request`，这意味着输入在语法上是*错误*的。您*应该*发送一个更[合适的标头](http://en.wikipedia.org/wiki/List_of_HTTP_status_codes)（例如`409`针对冲突、`428`针对失败的前提条件等）。我正在努力想出一个可以有效使用 for 的项目`418 I'm a teapot`，但总有一天我会成功..

任何对您网站的内部运作感兴趣的人都可以查看控制台，但这应该没有问题，您也不应该过度迎合那里的干净外观，只要确保您自己的流程是合理的。

# qt - 如何制作无法打开的 QIODevice

> ID：11253299
> 
> 赞同：2
> 
> 时间：2012-06-28T21:40:20.173
> 
> 标签：qt, unit-testing, io

我正在尝试测试一个使用`QIODevice`. 实际上，该对象可能会使用 a `QFile`，但对于我的单元测试，我更喜欢使用 a`QBuffer`来提高速度。依赖注入和多态性结合起来得到我想要的东西。

但是，我有一个问题。我的类构造函数如下所示：

```
Object::Object(QIODevice& source)
{
   if(!source.open(QIODevice::ReadOnly))
   {
      qDebug("Object: Could not open source.");
   }
} 
```

然后在我的测试中检查消息：

```
void TestObject::printsErrorOnOpenFailure()
{
   QTest::ignoreMessage(QtDebugMsg, "Object: Could not open source.");
   QBuffer buffer;
   Object obj(buffer);
} 
```

`QByteArray`不幸的是，即使没有 a操作，open 似乎仍然成功。给我的对象一个`QIODevice`我知道它无法打开的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T22:07:26.927

您不能`QBuffer::open()`返回 false **(*)**。所以你不能`QBuffer`在你的场景中使用。

但是子类化和覆盖`open()`总是返回 false 呢？

```
class UnopenableDevice : public QBuffer {
public:
    bool open(QIODevice::OpenMode m) { return false; }
}; 
```

* * *

**(*)**至少不使用标志`WriteOnly`和/或`ReadOnly`. 传递无效标志是使其返回 false 的唯一可能性。引用 Qt 4.8.0 来源：

*corelib/io/qbuffer.cpp：*

```
332 bool QBuffer::open(OpenMode flags)              
333 {
334     Q_D(QBuffer);
335 
336     if ((flags & (Append | Truncate)) != 0)
337         flags |= WriteOnly;
338     if ((flags & (ReadOnly | WriteOnly)) == 0) {
339         qWarning("QBuffer::open: Buffer access not specified");
340         return false;    //  <----- only possibility to return false!
341     }
342 
343     if ((flags & Truncate) == Truncate)
344         d->buf->resize(0);
345     d->ioIndex = (flags & Append) == Append ? d->buf->size() : 0;
346 
347     return QIODevice::open(flags);
348 } 
```

*corelib/io/qiodevice.cpp：*

```
540 bool QIODevice::open(OpenMode mode)
541 {
542     Q_D(QIODevice);
543     d->openMode = mode;
544     d->pos = (mode & Append) ? size() : qint64(0);
545     d->buffer.clear();
546     d->accessMode = QIODevicePrivate::Unset;
547     d->firstRead = true;
548 #if defined QIODEVICE_DEBUG
549     printf("%p QIODevice::open(0x%x)\n", this, quint32(mode));
550 #endif
551     return true;
552 } 
```

# c# - Java 运行时环境在编译过程方面与 .NET 框架相比如何？

> ID：11253303
> 
> 赞同：11
> 
> 时间：2012-06-28T21:40:40.777
> 
> 标签：c#, java, compiler-construction

我正在学习通过`.NET`和`JRE`框架将源代码转换为机器代码。首先，我做了一些比较这两个过程的研究并创建了[这个图表](http://s13.postimage.org/jf5tdcghj/IC91955.png)。我需要一些帮助来批评它的正确性，更重要的是添加我错过的任何严重的事情，以更好地理解编译路径。

![在此处输入图像描述](../Images/cd454ff4e9fe5fe8cbc2c2847298f017.png)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-28T22:10:23.813

.NET 和 Java 都编译为字节码，这是一种包含虚拟机指令的中间语言。它不是机器代码，因为它不能直接在物理机器上运行。取而代之的是（至少在今天；Java 在这方面有更黑暗的历史）是在运行时运行一个即时编译器，它将 VM 指令翻译成本机代码，然后直接运行。与仅解释它相比，这具有主要的性能优势。

他们在这方面略有不同。Oracle 的 Java 实现 (Hotspot) 巧妙地结合了解释、测量和 JIT，仅编译大量使用的部分并在其他方面进行解释。这是为了减少 JIT 编译器的初始影响（需要提前运行，否则会延长进程启动时间），同时在需要时仍然允许良好的性能。另一方面，.NET 总是 JIT 编译所有使用的代码（尽管未编译未使用的代码）。

编辑（2019 年）：到目前为止，.NET 还具有分层编译，根据运行的代码量，该代码将得到进一步优化。

至于您在评论中提到的一个问题：是的，CLR 和 JVM*是*运行此类程序的平台。虚拟机也是一台机器，只是更少的硬件。它们都与相应的框架紧密集成，即 .NET 的基类库和 Java 的 Java 类库。这些是框架。

# post - 将多部分表单数据发布到 seam+RESTeasy 无法编组到 InputStream

> ID：11253305
> 
> 赞同：5
> 
> 时间：2012-06-28T21:40:46.180
> 
> 标签：post, jboss, resteasy, multipartform-data

我正在尝试将图像数据发布到 seam+RESTeasy 端点，并且在 JBoss 启动期间遇到了一个非常神秘的错误。我发送的 HTTP 请求的内容类型为 multipart/form-data，它有一个名为“附件”的图像/jpeg 部分。我的服务方法如下所示：

```
@POST
@Path("uploadSymptomsImage/{appointmentGUID}")
@Consumes(MediaType.MULTIPART_FORM_DATA)
@Produces("application/json")
public String uploadSymptomsImage( @FormParam("attachment") InputStream fileInputStream,
                                   @PathParam("appointmentGUID") String strAppointmentGUID )
{ ... 
```

我得到的错误是在启动期间：

```
Caused by: java.lang.RuntimeException: Unable to find a constructor that takes a String param or a valueOf() or fromString() method for javax.ws.rs.FormParam("attachment") on public java.lang.String com....AppointmentRestService.uploadSymptomsImage(java.io.InputStream,java.lang.String) for basetype: java.io.InputStream
at org.jboss.resteasy.core.StringParameterInjector.initialize(StringParameterInjector.java:206) [:]
at org.jboss.resteasy.core.StringParameterInjector.<init>(StringParameterInjector.java:57) [:]
at org.jboss.resteasy.core.FormParamInjector.<init>(FormParamInjector.java:22) [:] 
```

我的理解是媒体类型可以自动编组到 InputStream。我也尝试过 java.io.File、java.io.Reader - 两者都有相同的错误。当我用 byte[] 或 String 替换时，我得到一个零长度数组，或者 null 作为参数值。

你将如何调试这个？此外，是否可以访问原始请求或预编组值？

这里的任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-06-20T20:26:11.230

您应该使用检索内容[`MultipartFormDataInput`](https://docs.jboss.org/resteasy/docs/1.2.GA/javadocs/org/jboss/resteasy/plugins/providers/multipart/MultipartFormDataInput.html)。请参见以下示例：

```
@POST
@Path("uploadSymptomsImage/{appointmentGUID}")
@Consumes(MediaType.MULTIPART_FORM_DATA)
@Produces("application/json")
public String uploadSymptomsImage(@PathParam("appointmentGUID") String strAppointmentGUID,
                               MultipartFormDataInput formData) {

    Map<String, List<InputPart>> formDataMap = formData.getFormDataMap();

   List<InputPart> attachments = formDataMap.get("attachment");
   for(InputPart attachment : attachments) {
        String fileName = extractFilename(attachment);
        if(fileName.isEmpty()) continue;
        InputStream in = attachment.getBody(new GenericType<InputStream>() {});
        // Interact with stream
   }

    // Respond
} 
```

extractFilename 方法是我[编写](https://github.com/devhub-tud/devhub/blob/ab9155bf0eea91fe35efd73fa998e016ddc39117/src/main/java/nl/tudelft/ewi/devhub/server/web/resources/ProjectAssignmentsResource.java)的辅助方法：

```
private static String extractFilename(final InputPart attachment) {
    Preconditions.checkNotNull(attachment);
    MultivaluedMap<String, String> headers = attachment.getHeaders();
    String contentDispositionHeader = headers.getFirst("Content-Disposition");
    Preconditions.checkNotNull(contentDispositionHeader);

    for(String headerPart : contentDispositionHeader.split(";(\\s)+")) {
        String[] split = headerPart.split("=");
        if(split.length == 2 && split[0].equalsIgnoreCase("filename")) {
            return split[1].replace("\"", "");
        }
    }

    return null;
} 
```

# java - asos 将产品添加到购物篮

> ID：11253311
> 
> 赞同：-4
> 
> 时间：2012-06-28T21:41:11.817
> 
> 标签：java, php, shopping-cart, bots

我正在尝试处理添加到购物篮脚本，以便我可以从我的服务器远程将产品添加到 ASOS 购物篮。前段时间有一个 API，但它被关闭了。它不再开放了。我正在考虑开发一个java bot。但是，我仍然希望有一个更简单的解决方案。

编辑：简而言之，我想知道的是如何在 php 中模拟“添加到袋子”按钮按下过程，最终将项目添加到袋子中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T08:26:16.767

你的问题很模糊。也就是说，如果我对您的理解正确，您想模拟最终用户从 Web 表单访问系统。您应该简单地检查表单的 action 属性，然后使用填充的 post 变量对该 url 执行 HTTP POST。尝试查看 Selenium 源代码顺便说一句。

我也很确定系统使用cookies进行登录，所以不要忘记去登录页面->验证->获取cookies->每次向“购物篮”添加内容时将其发送回去。

# php - 如何对 Infinite Scroll 的查询结果进行分页？

> ID：11253316
> 
> 赞同：1
> 
> 时间：2012-06-28T21:41:42.587
> 
> 标签：php, jquery, mysql, pagination, infinite-scroll

我有一个使用 2 个 PHP 文件和一个 MySql 数据库的示例页面，我正在尝试在其上使用 jQuery 无限滚动。如何从数据库中加载下一组数据？例如，我的图片数据库中有 100 条记录，我想显示 20 条，然后在滚动后显示下 20 条。

这是我目前的核心：

**索引.php**

```
<?php
ob_start();
require_once('images.html'); 
ob_end_flush();
?> 
```

**图像.html**

```
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title> trata tata</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <!--[if lt IE 9]><script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <link rel="stylesheet" href="./css/style.css" />
   <!-- scripts at bottom of page -->
</head>
<body class="demos ">
  <nav id="site-nav">
    <h1><a href="./index.html">ole tu jest HOME</a></h1>
    <h2>Menu 1</h2>
    <ul class="docs-list">
        <li><a href="../docs/intro.html">11111111</a>
    </ul>
    <h2>Menu 2</h2>
    <ul class="demos-list">
        <li><a href="../demos/basic-single-column.html">222222222</a>
        <li class="current"><a href="#content">3333333333</a></li>
    </ul>
  </nav> <!-- #site-nav -->

  <section id="content">
     <h1>cos tam ....</h1>
     <div id="container" class="clearfix">
     <?php
     // Make a MySQL Connection
     mysql_connect("localhost", "root", "") or die(mysql_error());
     mysql_select_db("test") or die(mysql_error());

     // Retrieve all the data from the "test " table
     $result = mysql_query("SELECT * FROM foto")
     or die(mysql_error());  

     // store the records of the "TABLENAME" table into $row array and loop through
     while ( $row = mysql_fetch_array( $result, MYSQL_ASSOC ) ) {

     // Print out the contents of the entry 

     //echo "details: ".$row['id'];
     echo '<div class="box photo col3">';
     echo "<img src=\"".$row['src']."\" alt=\"wwwwww\" />";
     echo '</div>';
     }
     ?>
     </div> <!-- #container -->

     <script src="./js/jquery-1.7.1.min.js"></script>
     <script src="./jquery.masonry.min.js"></script>
     <script>
       $(function(){
         var $container = $('#container');
         $container.imagesLoaded( function(){
           $container.masonry({
             itemSelector : '.box'
           });
         });

       });
     </script>
     <footer id="site-footer">
       szaki <a href="http://desandro.com">sdfsdfdsfsdf</a>
     </footer>

  </section> <!-- #content -->

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T21:45:46.413

您需要添加`LIMIT`到您的查询中。[MySQL手册](http://dev.mysql.com/doc/refman/5.0/en/select.html)中的示例：

```
SELECT * FROM tbl LIMIT 5,10;  # Retrieve rows 6-15 
```

这里，`5`是起始偏移量，`10`是您要获取的行数。

对于客户端，您需要[无限滚动 jQuery 插件](https://github.com/paulirish/infinite-scroll/)。

# javascript - 使用 highcharts 调整数据点的大小

> ID：11253318
> 
> 赞同：14
> 
> 时间：2012-06-28T21:41:48.683
> 
> 标签：javascript, charts, highcharts

我们正在使用[highcharts](http://www.highcharts.com)并尝试自定义图表以使其看起来类似于： ![在此处输入图像描述](../Images/2fe3ef5a7f4c3cc8fedc6e11daf89937.png)

我们能够按照文档设置颜色，还可以通过使用该`lineWidth`属性来增加线条的粗细，但找不到自定义数据点的方法，因此它们始终是圆形并且比较粗的线条大。这是它现在的样子： ![在此处输入图像描述](../Images/f525071b328e9066aa5814a1846dce4c.png)

此外，我们找不到删除默认灰色水平线的方法。

帮助！

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-06-28T22:09:20.263

这条灰线称为网格线，您可以按照[参考](http://www.highcharts.com/stock/ref/#yAxis--gridLineWidth)自定义它们。

**删除网格线**

```
 yAxis: {
     gridLineWidth: 0
 } 
```

像这个[例子](http://jsfiddle.net/M7GhX/)。

**更改标记宽度**

```
plotOptions: {
    series: {
        marker: {
            enabled: true,
            symbol: 'circle',
            radius: 7
        }
    }
} 
```

[**演示**](http://jsfiddle.net/jQ28r/2/)

如果您想自定义系列标记，可以查看[此处。](http://www.highcharts.com/stock/ref/#point-marker)

# python - 具有延迟的 GAE 后端实例

> ID：11253321
> 
> 赞同：1
> 
> 时间：2012-06-28T21:42:13.993
> 
> 标签：python, google-app-engine

我正在使用`urlfetch`通过`deferred.defer`. 我收到超时错误。如果您的任务需要更多时间和精力，我已经阅读过使用后端实例。在有关[推送任务](https://developers.google.com/appengine/docs/python/taskqueue/overview-push)的文档中，它向您展示了如何执行此操作：

```
taskqueue.add(url='/path/to/my/worker/', params={'key': key}, target='1.backend1') 
```

但我找不到如何使用[deferred.defer](https://developers.google.com/appengine/articles/deferred)`target`的后端实例的示例。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T12:57:16.033

您可以这样做，使用 _target 参数，例如：

```
deferred.defer(func, key=key, _target='1.backend1') 
```

# excel - 在 Excel 图表中隐藏不重要的数据

> ID：11253325
> 
> 赞同：1
> 
> 时间：2012-06-28T21:42:27.200
> 
> 标签：excel, charts

有没有办法告诉excel不在图表中显示不重要的系列？

假设我有一百个数字，最后 90 个数字的总和小于前 5 个数字之一。我想绘制一个饼图，底部 90 个未显示，或显示为“其他”切片。

我可以使用简单的图表选项或公式吗？我需要更新 Excel 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T00:08:40.980

我认为这是一个很好的问题，因为根本问题是关于最佳实践：将数据与表示分离。Excel 无法决定什么是“重要的”，但您可以。为什么不在你的数据中添加一些表明“重要性”的东西呢？这可以像“是”或“否”一样简单，也可以是从 0 到 100 的粒度变量，其中小于 5 表示“无关紧要”。这通常可以通过公式来完成；确切的方法取决于您的要求。

然后，设置一个演示工作表，您可以在其中通过您选择的方法（sumif、数据透视表、结构化引用等）聚合数据并包括重要性属性。然后，将您的图表基于表示层。您实际上不需要在图表中包含重要性属性，但您可以在聚合中利用它。

所有这些都需要一点额外的工作——但只是一点点——而且它是高度可定制和可维护的。

# java - 我还能做些什么来处理运行 Ant（命令行）的“GC Overhead Limit Exceeded”吗？

> ID：11253329
> 
> 赞同：8
> 
> 时间：2012-06-28T21:42:35.173
> 
> 标签：java, android, ant

我正在尝试使用命令行 Ant 编译一个*非常*大的多项目 Android 项目。我最初使用的是 Ant 1.8.3，但后来升级到了 1.8.4（结果是徒劳的）。虽然我确实安装了 Eclipse（Indigo，今天更新），但该项目的性质排除了为此在 Eclipse 中使用 Ant。

该代码似乎生成得很好，但是当它进入操作的“dex”阶段时，它会出现两个错误之一，具体取决于我的`ANT_OPTS`：“GC Overhead Limit Exceeded”或“Java Heap Space”。

我用谷歌搜索并检查了堆栈。在找到各种链接（参见[此处](https://www.jfire.org/modules/phpwiki/index.php/Development%20Troubleshooting)、[此处](http://javarevisited.blogspot.com/2011/09/javalangoutofmemoryerror-permgen-space.html)、[此堆栈问题](https://stackoverflow.com/questions/11148947/dojo-1-7-build-out-of-memory-errors)和[此堆栈问题](https://stackoverflow.com/questions/2288463/java-out-of-heap-space-error)）后，我修改了我的 Ant 选项。（许多链接涵盖了执行 Java 代码时发生的情况；我的问题实际上出在创建 Android APK 以供上传的 Ant 进程中）。

我的`ANT_OPTS`环境变量目前是：

```
-Xms4g -Xmx4g -Xmn256m -XX:PermSize=256m -XX:MaxPermSize=1024m -XX:+UseConcMarkSweepGC -XX:+CMSPermGenSweepingEnabled -XX:+CMSClassUnloadingEnabled -XX:ParallelGCThreads=8 
```

我尝试使用 完全关闭 GC Overhead Limit `-XX:-UseGCOverheadLimit` ，但所做的只是给我一个 Java Heap Space 错误而不是 GC Overhead Limit 错误。我已经问过我的同事这件事，但他们也没有想法。

哦，还有一个“细节”：我可以使用 Eclipse 编译和加载项目，这似乎“很好”；然而，这个“元项目”所需的项目数量之多表明我试图让 Ant 脚本正常工作。

**系统信息：**

*   操作系统：Windows 7 64 位
*   Java：Sun，1.6，64 位
*   物理内存：8Gb
*   安卓：SDK工具：R20；平台工具：R12（今天更新，6 月 28 日）

还有什么我可以做的吗？另一个要搜索的关键字？还有什么地方可以看？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T14:19:57.713

对此的部分答案。感谢当前的受访者，他们帮助我追踪了这一点。

显然，有*两个*（可能是三个？）Java VM opts 需要更改的不同位置，具体取决于错误发生的确切位置。在这种情况下，`ANT_OPTS`不会*传递*给 Dex。

我能够通过编辑 DX 批处理文件来解决错误，更改：

```
set defaultXmx=-Xmx1024M 
```

到

```
set defaultXmx=-Xmx4096M 
```

然而**显而易见**：我永远不需要更改 dx 批处理文件。有人碰巧知道更改 Ant 传递给 Dex 的 Java 选项的“正确”方法吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-28T22:21:06.420

这听起来像是当应用程序慢慢耗尽堆空间时会发生的情况。如果你设置了 GC 开销限制，JVM 会很快死掉。如果你不这样做，应用程序会继续运行更长的时间，花费越来越多的时间 GC'ing ......然后最终死掉。

如果这是您的应用程序，您应该检查存储泄漏。但由于它是一个众所周知且（可能）经过良好测试的第 3 方应用程序，最简单的尝试是……增加堆大小。

要尝试的另一件事是关闭 CMS。没有理由使用 CMS 进行批处理编译：GC 暂停是无关紧要的。只需使用吞吐量收集器。（这可能不会解决堆大小问题，但它应该让你的构建运行得更快。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T21:46:51.460

我相信您正在寻找的是：

```
-XX:-UseGCOverheadLimit 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-08-12T13:23:57.987

注意错误的目录、无效的符号链接或丢失的文件。例如，如果您的 build.xml 依赖于指向不存在的文件夹的符号链接，则可能会触发“GC Overhead Limit Exceeded”错误，而实际上它与内存或垃圾收集无关问题。

# sql - 将 SQL 转换为有 in 子句的 Linq

> ID：11253330
> 
> 赞同：4
> 
> 时间：2012-06-28T21:42:38.000
> 
> 标签：sql, vb.net, linq, linq-to-sql, sql-to-linq-conversion

我想知道如何将下面列出的 SQL 查询转换为 VB 中的 LINQ 查询。

```
SELECT FacilityID 
FROM tblFacilityProjects 
WHERE FreedomEnabled = True and ProjectID in (840,841,842) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-28T21:50:19.543

我认为应该这样做：

```
Dim projectIds = New Integer() {840, 841, 842}
Dim result = From proj In db.tblFacilityProjects _
             Where proj.FreedomEnabled = True AndAlso _
                   projectIds.Contains(proj.ProjectID) _
             Select FacilityID 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T21:48:01.667

**SQL 中的 IN 查询**

```
SELECT [Id], [UserId]
FROM [Tablename]
WHERE [UserId] IN (2, 3) 
```

**LINQ 中的 IN 查询**

利用`Contains`VB的功能。

```
Dim coll As Integer() = {2, 3}
Dim user = From u In tablename Where coll.Contains(u.UserId.Value) New 
From {
    u.id, u.userid
} 
```

[http://www.c-sharpcorner.com/blogs/4479/sql-in-and-not-in-clause-in-linq-using-vb-net.aspx](http://www.c-sharpcorner.com/blogs/4479/sql-in-and-not-in-clause-in-linq-using-vb-net.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T21:53:18.170

创建项目 ID 列表

```
Dim list As New List(Of Integer)
list.Add(840)
list.Add(841)
list.Add(842) 
```

现在你必须在 LINQ 中使用它。

```
dim facilityId = from fp in tblFacilityProjects 
                 where FreedomEnabled == true
                 where list.Contains(ProjectID)
                 select new
                 {
                   FacilityID=fp.FacilityID
                 } 
```

您可能需要对 VB.net 进行一些调整。

# c++ - 如何在发布模式下调试？

> ID：11253334
> 
> 赞同：42
> 
> 时间：2012-06-28T21:42:53.573
> 
> 标签：c++, visual-studio-2010, debugging, visual-c++, release-mode

我必须调试一个 c++ 项目，但是由于一个依赖项不能在调试模式下编译，并且到目前为止我还无法解决这个问题，我想尝试在发布模式下调试项目。

目前应用程序由于空指针而崩溃，但我没有导致错误的代码。由于在发布模式下显然忽略了断点，我想知道找到错误的最佳方法是什么。

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2012-06-28T21:44:35.797

在 VS 中，右键单击您的项目，选择“属性”。

1.  单击 C/C++ 节点。将调试信息格式设置为 C7 兼容 (/Z7) 或程序数据库 (/Zi)。

2.  展开链接器并单击常规节点。将启用增量链接设置为否 (/INCREMENTAL:NO)。

3.  选择调试节点。将生成调试信息设置为是 (/DEBUG)。

4.  选择优化节点。将引用设置为是 (/OPT:REF)。

    > 如果指定了 /OPT:REF，则 /OPT:ICF 默认开启。

这是直接从微软的文档中提取的：

*   [如何：调试发布版本](http://msdn.microsoft.com/en-us/library/fsk896zz.aspx)
*   [选择优化](http://msdn.microsoft.com/en-us/library/bxwfs976.aspx)

我一直这样做，几乎不再在调试模式下进行调试。如您所知，在发布版本中发生的许多错误可能不会在调试版本中发生（几乎可以肯定是调用 UB 产生的错误）。

此外，我在一个项目中工作，该项目使用大量图像处理并对大图像执行大量压缩/解压缩。使用缓慢的调试构建是不切实际的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-07-25T13:21:06.227

您不能总是只更改项目设置并重新编译。
有时您有想要调试的已发布版本，或客户端发送的转储文件。

在使用优化编译发布的 C++ 项目时，调试器有时不会显示正确的对象信息。

局部变量通常是最先走的，而且很多时候，这个对象的信息会丢失给调试器。

原因是编译器使用可用的硬件寄存器来保存信息，并使用优化来避免分配局部变量。

我建议了一种在此处查找缺失信息的方法：

**[在 C++ 中调试发布项目 - 查找丢失的对象信息](http://www.codeproject.com/Tips/727711/Debugging-Release-Projects-in-Cplusplus-Finding-th)**

# c - mongodb C驱动认证

> ID：11253337
> 
> 赞同：1
> 
> 时间：2012-06-28T21:42:59.887
> 
> 标签：c, authentication, mongodb

我似乎无法从 C 驱动程序中找到有关向 mongodb 进行身份验证的文档。据我所知，C 驱动程序 API 没有关于它的信息。但是，[此链接](https://jira.mongodb.org/browse/CDRIVER-65)使我认为这是可能的。链接或代码片段会很棒。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T18:49:39.483

这是要调用的函数。

```
MONGO_EXPORT int mongo_cmd_authenticate     (
        mongo *         conn,
        const char *    db,
        const char *    user,
        const char *    pass
    )

Authenticate a user.

Parameters:
        conn    a mongo object.
        db      the database to authenticate against.
        user    the user name to authenticate.
        pass    the user's password.

Returns:
    MONGO_OK on sucess and MONGO_ERROR on failure. 
```

以下是测试代码的摘录作为示例 - mongo-c-driver/test/auth_test.c

```
if ( mongo_connect( conn , TEST_SERVER, 27017 ) ) {
    printf( "failed to connect\n" );
    exit( 1 );
}

ASSERT( mongo_cmd_authenticate( conn, db, "user", "password" ) == MONGO_OK );

... 
```

希望这会有所帮助。这里有一些链接可以获取更多信息。

参考：

MongoDB C 语言中心 - [http://www.mongodb.org/display/DOCS/C+Language+Center](http://www.mongodb.org/display/DOCS/C+Language+Center)

MongoDB C 驱动程序文档 - [http://api.mongodb.org/c/current/](http://api.mongodb.org/c/current/)

MongoDB C 驱动程序 API 文档 - [http://api.mongodb.org/c/current/api/index.html](http://api.mongodb.org/c/current/api/index.html)

mongo.h 文件参考 - [http://api.mongodb.org/c/current/api/mongo_8h.html](http://api.mongodb.org/c/current/api/mongo_8h.html)

mongo_cmd_authenticate - [http://api.mongodb.org/c/current/api/mongo_8h.html#a715aaa6b82e23486e6caad2b544f2ebf](http://api.mongodb.org/c/current/api/mongo_8h.html#a715aaa6b82e23486e6caad2b544f2ebf)

MongoDB C 驱动程序源代码 - [https://github.com/mongodb/mongo-c-driver](https://github.com/mongodb/mongo-c-driver)

test/auth_test.c - [https://github.com/mongodb/mongo-c-driver/blob/master/test/auth_test.c](https://github.com/mongodb/mongo-c-driver/blob/master/test/auth_test.c)

# python - 无法在模板包含标记中覆盖默认 kwarg 值 False

> ID：11253338
> 
> 赞同：0
> 
> 时间：2012-06-28T21:43:07.230
> 
> 标签：python, django, django-templates

我写了这个模板包含标签：

```
@register.inclusion_tag('blog/post_detail.html')
def post_detail(post, show_meta=True):
    return {
        'post': post,
        'show_meta': show_meta
    } 
```

我这样称呼它：

```
{% post_detail post show_meta=False %} 
```

这工作得很好。模板正确呈现，`show_meta`值为`False`.

但是，如果我将默认值更改为`show_meta`这样`False`：

```
def post_detail(post, show_meta=False): 
```

然后，如果我尝试使用 调用它`{% post_detail post show_meta=True %}`，模板仍然呈现为`show_meta`具有`False`. 为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T21:49:06.160

`True`并且`False`默认情况下不在模板上下文中定义，并且根据正常的模板语言规则，不存在的名称被视为 False。尝试传递 0 和 1。

# integration-testing - 用 jasmine 测试 ember.js 应用程序

> ID：11253339
> 
> 赞同：16
> 
> 时间：2012-06-28T21:43:08.360
> 
> 标签：integration-testing, ember.js, jasmine

有谁知道有关测试 ember.js 应用程序的任何资源、示例或教程？

你如何测试视图？

似乎没有任何广泛的示例/信息。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-03T13:43:21.080

我无法举一个例子来说明如何实现这一点，但我发现了一个广泛使用 Jasmine 进行测试的项目：你应该看看 GitHub 上的[ember-resource](https://github.com/zendesk/ember-resource)项目。它使用 Jasmine 进行测试，这些测试位于[spec/javascripts](https://github.com/zendesk/ember-resource/tree/master/spec/javascripts)中。

该项目还具有`Rakefile`相应的任务，可让您以方便的方式执行规范。

* * *

有一篇关于用 Jasmine 测试 Ember.js 的博客文章：[http ://www.thesoftwaresimpleton.com/blog/2012/04/03/testing-ember-and-the-runloop/](http://www.thesoftwaresimpleton.com/blog/2012/04/03/testing-ember-and-the-runloop/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-05T07:35:02.687

您还可以使用 Ember 本身的测试功能，如[本文所述](http://darthdeus.github.com/blog/2013/02/19/testing-ember-dot-js-part-1/)

基本上所做的是通过设置禁用 Ember 运行循环：`Ember.testing = true` 这样你就不必检查你的异步代码是否完成。您可以简单地将其包装在自己的运行循环中：

```
// Creating an application normally happens async,
// which is why we have to wrap it in Ember.run
Ember.run(function() {
  App = Ember.Application.create();
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-11T17:51:14.473

这是一篇关于使用 Jasmine 测试 Ember.js 的文章[http://www.devmynd.com/blog/2014-1-ember-js-testing-with-jasmine](http://www.devmynd.com/blog/2014-1-ember-js-testing-with-jasmine)

# android - 通过固件在平板电脑中隐藏 Android 系统栏

> ID：11253340
> 
> 赞同：1
> 
> 时间：2012-06-28T21:43:11.673
> 
> 标签：android, root, android-firmware

我需要知道在 android 平板电脑中显示系统栏（主页按钮、后退按钮、设置）的进程或应用程序。我需要终止此进程或应用程序以避免用户访问 android 设置。我有可能在自定义的 android 固件中执行此操作。

我需要在android代码中修改什么来隐藏这个栏？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T04:05:22.650

查看 GitHub 上的[HideBar](https://github.com/ppareit/HideBar)。该过程是`com.android.systemui`和 HideBar 显示特定的服务类名称。您可以使用`ActivityManager`或`Process`杀死它，但由于它是一个系统进程，它可能会导致不稳定并可能重新生成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-15T05:02:31.900

在互联网上进行了大量搜索后，我设法让系统栏隐藏并出现在 4.2 设备中，使用：

隐藏：

```
Runtime.getRuntime().exec("service call activity 42 s16 com.android.systemui"); 
```

或者对于小于 14 的 API 使用 79 而不是 42。您可能还需要包括 SET_DEBUG_APP 权限，在这种情况下，您需要使用系统密钥对应用程序进行签名或安装在 /system/app/ 目录中。

以显示：

```
Runtime.getRuntime().exec("am startservice --user 0 -n com.android.systemui/.SystemUIService"); 
```

如果使用 API 4.0 到 4.1，请删除 --user 0 选项。或者，有些人使用了 -a（而不是 -n）选项，尽管这导致我的设备出现错误：

错误：未找到；没有服务启动。

# android - 如何在android中对文本路径进行模式填充？

> ID：11253344
> 
> 赞同：2
> 
> 时间：2012-06-28T21:43:27.187
> 
> 标签：android, paint, android-canvas

我正在尝试通过随着时间的推移在两种状态之间进行更改以编程方式生成以下效果

![状态 1 图像](../Images/b03e5783cdfd0d1aff4eb727301fd212.png) ![状态 2 图像](../Images/003bce16231e95ea8472397422f37a58.png)

基本上在第一张图像（状态＃1）中，我想获得用我自己的自定义位图填充的文本*路径*（在上面的示例中为红色圆圈），并且应该在固定距离后重复（恰好是在这种情况下与红色圆圈的直径相同）。在第二张图像（状态 #2）中，红色圆圈采用替代模式，它们的位置是状态 #1 中的空白区域。

从[这个问题的答案中，](https://stackoverflow.com/questions/9046304/android-game-development-how-can-i-fill-a-circle-with-a-repeated-pattern)我收集到我可以用`BitmapShaders`在我的油漆上。以下是我为一种状态提出的代码。但是，我被卡住了，无法思考如何实现这一目标。

```
public void drawText(String text, int x, int y) {
    Paint defPaint = new Paint();
    defPaint.setTextSize(100);
    defPaint.setStrokeWidth(0);

    defPaint.setStyle(Style.FILL_AND_STROKE);

    defPaint.setShader(new BitmapShader(
            ((AndroidPixmap) Assets.redCircle).bitmap, TileMode.REPEAT,
            TileMode.REPEAT));

    Path path = new Path();
    defPaint.getTextPath(text, 0, text.length(), x, y, path);
    canvas.drawPath(path, defPaint);
} 
```

我也尝试过使用，`PathEffects`但也没有成功。

# android - 对话主题活动：正面和负面按钮

> ID：11253345
> 
> 赞同：9
> 
> 时间：2012-06-28T21:44:04.960
> 
> 标签：android, android-dialog, android-theme

我正在尝试将活动主题化为`AlertDialog`. 我面临的问题是我找不到在窗口底部放置两个按钮的方法，这两个按钮看起来像`AlertDialog`

我已经将该行添加到清单中的我的活动中（我正在使用 Sherlock 库）：

```
android:theme="@style/Theme.Sherlock.Dialog" 
```

Activity 看起来完全像一个对话框，但我找不到要在按钮上设置的主题。我能做什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-28T22:28:21.863

好的，如果您正在为 HC/ICS 开发应用程序，而没有 Sherlock，答案就在这里： [https ://gist.github.com/2348305](https://gist.github.com/2348305)

只是主题使用

```
style="?android:attr/buttonBarStyle" 
```

对于容器，

```
style="?android:attr/buttonBarButtonStyle" 
```

用于按钮

和

```
android:divider="?android:attr/dividerHorizontal"
android:showDividers="middle" 
```

对于根布局

# jquery - 带有数字键数组的jquery json

> ID：11253347
> 
> 赞同：0
> 
> 时间：2012-06-28T21:44:24.287
> 
> 标签：jquery, json

如果我有一个输出带有数字键的 json 数据的 php 文件，比如

```
<?php
$array[1] = "abcd";
$array[2] = "efgh";
$array[3] = "1234";
$array[4] = "5678";

echo json_encode($array);
?> 
```

我如何访问说键 4 的值？下面“data.4”中的整数破坏了代码。任何帮助将不胜感激。谢谢！

```
 $.ajax({
         type: "GET",
         url: "http://localhost:8888/myapp/json/json_data",
         async: false,
         beforeSend: function(x) {
          if(x && x.overrideMimeType) {
           x.overrideMimeType("application/j-son;charset=UTF-8");
          }
     },
     dataType: "json",
     success: function(data){
        //$("#box").html(JSON.stringify(data, null, 4));
        $("#box").append("<br/>" + data.4)
     }
    }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T21:47:17.357

使用方括号访问属性：`data['4']`.

注意：您的 PHP**不是**返回一个数组，而是一个对象：`{"1":"abcd","2":"efgh","3":"1234","4":"5678"}`。

PS。你的`overrideMimeType`. 不过，您不必重写它，因为您使用的是 jQuery。有关替代方法，请参阅[`$.getJSON`](http://api.jquery.com/jQuery.getJSON/)。

# javascript - Safari 和 IE 中的 javascript 日期对象问题

> ID：11253351
> 
> 赞同：9
> 
> 时间：2012-06-28T21:44:39.623
> 
> 标签：javascript, internet-explorer, date, safari

我从 2012-12-31 格式的 JSON 对象中获取日期，并尝试将其转换为友好值并输出。

```
 var redeemableDate = item.Deal.RedeemableDate; //this is coming in the form of 2012-12-31
    var redeemableDate = new Date(redeemableDate);
    var rdDay = weekday[redeemableDate.getDay()]; //using an array with weekdays
    var rdDate = redeemableDate.getDate();
    var rdMonth = monthNames[redeemableDate.getMonth()]; //using an array with month names
    var rdYear = redeemableDate.getFullYear();

    response.write('Valid ' + rdDay + ' ' + rdDate + ' ' + rdMonth + ' ' + rdYear + ' ONLY'); 
```

这一切都在 Firefox 和 Chrome 中找到并且花花公子，但 Safari 和 IE（目前仅在 IE8 上测试过）不喜欢它。

在 FF 和 Chrome 中，我得到了预期：

> 仅适用于 2012 年 9 月 2 日星期日

但在 Safari 和 IE 中，我得到：

> 有效的 undefined NaN undefined NaN ONLY

当我将可赎回日期设置为日期对象后发出警报时，Safari 会返回“无效日期”，而 IE 会返回“NaN”。这显然是问题所在。有没有办法可以将我的值转换为这些浏览器的日期对象？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-06-28T21:50:37.080

Safari 和 IE 不支持 yyyy-mm-dd (ISO 8601) 日期格式。虽然它是 ECMAscript 5 的一部分，但它应该只是时间问题。

一种解决方案是将日期作为参数传递给 Date。

```
var date = "2012-12-31".split("-");
var your_date = new Date(date[0], date[1]-1, date[2]); 
```

*请注意，月份参数从零开始（对于一月），因此您必须从从字符串中获得的值中减去 1。*

编辑：有关快捷方式，请参见下面 joe larson 的回答。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-28T21:48:05.847

你最好自己解析日期字符串：

```
function dateFromISO( str ) {
  var d = null;
  str.replace(/^(\d\d\d\d)-(\d\d)-(\d\d)$/, function(_, y, m, d) {
    d = new Date(parseInt(y, 10), parseInt(m, 10) - 1, parseInt(d, 10));
  });
  return d;
}

redeemableDate = dateFromISO( redeemableDate ); 
```

即使其他浏览器喜欢这些日期字符串，您也会遇到它们总是被解释为 UTC 的问题。例如，对我来说，当我将该字符串“2012-12-31”传递给 Firefox 时，它告诉我日期是 2012 年 12 月 30 日，因为我比 UTC 晚了 6 个小时。换句话说，“2012-12-31”被解释为该日期的午夜，UTC 时间。假设您希望世界上的每个人都能看到正确的日期，如果您使用数字构造 Date 对象，则假定它是客户端的本地时间。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-12-23T08:04:16.757

结合千斤顶和乔拉森的回应，以下代码对我来说效果很好：

```
 $scope.formatDate = function(date){
                var date = date.split("-").join("/");
                var dateOut = new Date(date);
                return dateOut;
        }; 
```

适用于 Chrome 和 Safari... :)
感谢 Jack 和 joe larson ！！！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-28T21:50:31.007

较旧的 Internet Explorer 版本（显然是您的 Safari 版本）不会解析 yyyy-mm-dd 字符串，例如`new Date('2012-12-31')`.

另一种选择是[`jQuery.datepicker.parseDate()`](http://docs.jquery.com/UI/Datepicker/%24.datepicker.parseDate)，尽管这可能有点矫枉过正。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-02-24T22:10:57.373

在使用 PHP Web 服务的情况下，我建议使用 `$row['date'] = date('j/n/Y',strtotime($row['date']));`safari/ie 返回您的日期以具有正常功能。

# html - 在 HTML 页面上打开客户端的纯文本文件

> ID：11253355
> 
> 赞同：0
> 
> 时间：2012-06-28T21:44:46.443
> 
> 标签：html, clojure, noir

您如何使用 HTML 在客户端计算机上以纯文本格式打开文件（即 .cpp、.txt 甚至 .html 文件）？我想将用户机器中的纯文本文件提取到 HTML`<textarea>`中。仅供参考，我正在使用 hiccup、clojure 和 webnoir 来生成 HTML 和服务器，所以这些都是用于帮助该过程的所有其他选项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T18:02:57.837

您有两个主要选择：将文件上传到您的服务器以作为 HTML 内容提供，或者使用 HTML 5 的[File API](http://dev.w3.org/2009/dap/file-system/pub/FileSystem/)。[这个问题](https://stackoverflow.com/questions/2376745/does-html5-allow-you-to-interact-with-local-client-files-from-within-a-browser)还涉及更多选项（如小程序、使用 File API 启用拖放等）

* * *

### 上传文件

1.  让用户`<input type="file" .../>`在一页上选择文件
2.  将文件内容上传到您的服务器。
3.  重定向到不同的页面以显示文件内容
4.  在该页面的文本区域中提供上传文件的内容。

**优点**：

*   这种方法非常简单明了。
*   您可以扫描文件并在服务器上进行一些繁重的处理

**缺点**：

*   访问服务器可能很耗时。

* * *

### HTML 5 解决方案

1.  让用户使用`<input type="file" .../>`
2.  不要发布内容，而是使用 JavaScript 将文件加载到 HTML 5 本地存储中（请参见下面的代码）
3.  使用 JavaScript 将文件的内容插入到您的 DOM 中。

**优点**：

*   无需访问服务器（更快）

**缺点**：

*   任何和所有验证/处理都必须在 JavaScript 中的客户端完成。这会使您的客户端变得更重，并允许用户查看/修改您的代码（您可能不需要关心）。

[我从这个站点](http://www.html5rocks.com/en/tutorials/file/filesystem/)抓取了这个代码片段，其中有一些使用 File API 的好例子：

```
function onInitFs(fs) {

  fs.root.getFile('log.txt', {}, function(fileEntry) {

    // Get a File object representing the file,
    // then use FileReader to read its contents.
    fileEntry.file(function(file) {
       var reader = new FileReader();

       reader.onloadend = function(e) {
           // Do something with the contents, which are stored in 'this.result'
       };

       reader.readAsText(file);
    }, errorHandler);

  }, errorHandler);

}

window.requestFileSystem(window.TEMPORARY, 1024*1024, onInitFs, errorHandler); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T21:49:51.213

快速而肮脏的选择是简单的`slurp`：

```
(slurp "mycode.cpp") 
```

# command-line - CopSSH 无法启动交互式 Python 并且不显示交互式程序的输出

> ID：11253356
> 
> 赞同：0
> 
> 时间：2012-06-28T21:44:49.577
> 
> 标签：command-line, copssh

我实际上在 Windows7 上安装的 CopSSH 有问题。当我尝试从 SSH 会话打开交互式 Python 到 Windows7 时，我不能。

```
[myuser@myhostname]$/cygdrive/c/Python27/python
# My comment: Nothing happens... It just shows nothing.... 
```

但是当我将 -i 与 python 一起使用时，它可以工作......

```
[myuser@myhostname]$/cygdrive/c/Python27/python -i
Python 2.7 (r27:82525, Jul  4 2010, 09:01:59) [MSC v.1500 32 bit (Intel)] on win32
Type "help", "copyright", "credits" or "license" for more information.
>>> 
```

同样，当我尝试从 SSH 会话运行 myprogram.exe 到 Windows7 时，我看不到任何输出，因为当我从带有命令提示符的 RDP 会话运行相同的程序时，我看到了彩色输出。**所以，请尽量理解这不是一个预期，而是一个 CopSSH 问题......我刚刚更新了这个问题。以下是我最初的问题....**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T22:46:01.447

问题是你试图在 Windows 下运行一个交互式程序，所以当它以非交互方式运行时（不是从终端或控制台），它的输出会被缓冲，你看不到任何东西。

在 Unix 或 Linux 下，这个问题可以通过终端仿真和其他工具（如`expect`. 但是，我不知道是否可以为 Windows 做任何事情。

如果您是 Windows 上程序的所有者，并且可以对其进行修改，则需要在每次输出到 后刷新缓冲区`stdout`，我想这应该可以解决您的问题。

# php - 如何在 WP_Query 中使用 if/else 语句

> ID：11253358
> 
> 赞同：1
> 
> 时间：2012-06-28T21:45:02.997
> 
> 标签：php, wordpress

我正在尝试根据正在查看的页面类型使用不同的 WP_Query 对象。我想这样做而不必一遍又一遍地重复循环。我只想使用带有条件的不同 WP_Query 语句。这是可能的，还是有其他方法可以做到这一点？现在我的页面上只有空输出。代码如下。

```
$paged = (get_query_var('paged')) ? get_query_var('paged') : 1;

// retrieve posts based on category or pages
$args=array(
    'category_name'=>'name',
    'posts_per_page'=>10,
    'paged'=>$paged
);

if (is_page()) {        
    //create a new instance
    $wp_query = new WP_Query($args);
}

else {
    //create a new instance
    $wp_query = new WP_Query(); 
}

// the Loop
while ($wp_query->have_posts()) : $wp_query->the_post();

// set $more to 0 in order to only get the first part of the post
global $more;
$more = 0;

// Do post layout here

endwhile; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T14:59:17.187

```
$my_args = is_page() ? $args : null;

$my_query = new WP_Query($args);

while ($my_query->have_posts()) : $my_query->the_post();
  ... 
```

`$wp_query`是一个[全局变量](http://codex.wordpress.org/Global_Variables)。避免将其用于那些事情。

# django - collectstatic 不是在 EC2 上使用 django 1.4 的 django-admin.py 的有效子命令

> ID：11253359
> 
> 赞同：2
> 
> 时间：2012-06-28T21:45:17.830
> 
> 标签：django, amazon-ec2, django-admin, django-staticfiles

我有一个在 EC2 上运行的 Amazon Linux 实例。我正在尝试使用 Django 的 staticfiles 应用程序启动并运行。但是，当我尝试运行时：

> django-admin.py 收集静态

它返回“未知命令：'collectstatic'”。而且，确实，当我键入 时`django-admin.py help`，它会列出可用的子命令，并且`collectstatic`不在其中。

我正在运行 Django 1.4，并检查了我的项目的 settings.py，其中 INSTALLED_APPS 确实包含`django.contrib.staticfiles`.

知道是什么原因造成的吗？我需要做些什么来设置/配置静态文件，以便在 django-admin.py 中可以使用 collectstatic 子命令吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T22:35:58.817

尝试`./manage.py help`在您的项目根目录中运行 -`collectstatic`应该是那里的子命令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T20:48:37.410

命令列表受限于您的权限。尝试运行 sudo manage.py collectstatic。

# memory - 调用堆栈会耗尽内存吗？

> ID：11253360
> 
> 赞同：2
> 
> 时间：2012-06-28T21:45:23.893
> 
> 标签：memory, haskell, memory-management, recursion, callstack

我在 Haskell 中编写递归函数时出现了一个问题；任何语言（或只是 Haskell）的任何调用堆栈都可以在特定点耗尽内存吗？

谢谢 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T21:49:59.307

您的内存量是有限的，并且如果调用堆栈上的每一帧都占用非零字节数（尾调用优化使这有点复杂），您*必须*能够通过足够深的递归耗尽资源. 基本逻辑。

也就是说，你能走多远取决于堆栈的实现。在普通中断堆栈（也称为 C 堆栈，因为它与该语言的关联）中实现堆栈的地方，可用空间非常有限，足以在小帧中获得相当深的空间，但当帧大小增加时确实受到限制（具有更多更大类型的变量）。并非所有语言都使用中断堆栈，而是将它们的堆栈定位在堆空间中（大得多）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-28T21:59:43.750

通常堆栈大小在 Haskell 实现中不像在 C 中那样成为问题，因为它是一种具有非标准虚拟机的函数式语言，即它的函数调用不直接映射到进程堆栈帧；它们是托管的，可以在堆上分配（类似于 Stackless Python）。但是大小是有限的，无论如何都会给你一个堆栈溢出。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-28T21:48:39.683

是的，它可以。这取决于为该特定程序分配给堆栈的资源，但如果过于急切，最终会以堆栈溢出结束。您可以在[wikipedia](http://en.wikipedia.org/wiki/Stack_overflow)上找到更多信息和示例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-28T21:49:37.480

是的。堆栈只是一个内存区域，因此是一种有限资源，如果滥用它可能会耗尽。在 C++ 中，这不仅适用于递归，还适用于在堆栈而不是堆上创建太多或（或太大）的变量。

# javascript - 页面加载时，easySlider 幻灯片会短暂地“弹出”或“闪烁”出容器？

> ID：11253361
> 
> 赞同：0
> 
> 时间：2012-06-28T21:45:24.817
> 
> 标签：javascript, jquery, slider, easyslider

以下代码是我网站的通用 scripts.js 文件中的代码。我使用 EasySlider 作为 JavaScript 图像滑块，当页面加载时，我注意到其中一个图像幻灯片从图像滑块中射出，或者另一种描述它的方式是它在屏幕上闪烁，然后返回到滑块。任何想法这可能是什么？如果这些信息不足以帮助诊断问题，请告诉我，我将提供更多代码。

```
 /* 10\. Featured Content Slider */
            #prevBtn, #nextBtn, #slider1prev, #slider1next {
                margin: 0;
                padding: 0;
                display: block;
                overflow: hidden;
                /*text-indent: -8000px;*/
            }
            #prevBtn {
                background: url('images/left-arrow.png') no-repeat;
                width: 44px;
                height: 73px;
                    float: left;
                top: 300px;
                z-index: 10000;
            }
            #nextBtn {
                background: url('images/right-arrow.png') no-repeat;
                width: 44px;
                height: 73px;
                float: right;
                top: 100px;
            }
            .left-panel {
                background-color: #000000;
                opacity: .8;
                width: 100%;
                height: 470px;
                z-index: 800;
                position: absolute;
                border-right: 1px solid #000000;
            }
            .right-panel {
                background-color: #000000;
                opacity: .8;
                width: 100%;
                height: 470px;
                z-index: 800;
                position: absolute;
                right: 0;
                border-left: 1px solid #000000;
            }
            #container {
                position: relative;
                width: 100%;
                overflow: hidden;
                background-color: #555555;
            }
            #content {
                position: relative;
                top: 64px;
            }

            #slider {
                padding: 0px 0px 64px 0px;
                display: block;
                height: 100% !important;
                width: 100% !important;
            }
            #slider li {
                position: relative;
                width: 696px;
                height: 241;
                overflow: hidden;
            }
            #slider li img {
                /*position:absolute;*/
                top: 0;
                width: 100%;
                height: 100%;
            }
            #slider li a {
                text-decoration: none;
            }
            #slider ul, #slider li,
            #slider2 ul, #slider2 li {
                margin: 0;
                padding: 0;
                list-style: none;
            }
            #slider2 {
                margin-top: 1em;
            }
            #slider li, #slider2 li {
                width: 940px;
                height: 400px;
                overflow: hidden;
            }
            #prevBtn, #nextBtn,
            #slider1next, #slider1prev {
                display: block;
                width: 30px;
                height: 77px;
                position: absolute;
                top: 71px;
                z-index: 1000;
            }
            #nextBtn, #slider1next {
                right: 0;
            }
            #prevBtn a, #nextBtn a,
            #slider1next a, #slider1prev a {
                display: block;
                position: relative;
                width: 30px;
                height: 77px;
                background: url(../images/btn_prev.gif) no-repeat 0 0;
            }
            #nextBtn a, #slider1next a {
                background: url(../images/btn_next.gif) no-repeat 0 0;
            }
            ol#controls {
                margin: 1em 0;
                padding: 0;
                height: 28px;
            }
            ol#controls li {
                margin: 0 10px 0 0;
                padding: 0;
                float: left;
                list-style: none;
                height: 28px;
                line-height: 28px;
            }
            ol#controls li a {
                float: left;
                height: 28px;
                line-height: 28px;
                border: 1px solid #ccc;
                background: #DAF3F8;
                color: #555;
                padding: 0 10px;
                text-decoration: none;
            }
            ol#controls li.current a {
                background: #5DC9E1;
                color: #fff;
            }
            ol#controls li a:focus, #prevBtn a:focus, #nextBtn a:focus {
                outline: none;
            }
            .featured-content-slider-title {
                font-family: Museo;
                color: #2e2e2e;
                font-size: 20px;
                position: absolute;
                max-width: 830px;
                left: 10px;
                bottom: 65px;
                padding: 6px 10px;
                left: 30px;
                background-color: #FFFFFF;
            }
            .featured-content-slider-author {
                font-family: Museo;
                color: #2e2e2e;
                font-size: 14px;
                position: absolute;
                left: 10px;
                bottom: 30px;
                padding: 6px 10px;
                left: 30px;
                background-color: #FFFFFF;
            }
            .border {
                background: url('images/cta-border-top.png') repeat-x;
                width: 100%;
                height: 24px;
                margin-top: -7px;
                position: absolute;
                z-index: 500;
            }
            <!-- Container -->
            <div id="container">

                <!-- Content -->
                <div id="content">

                    <span class="left-panel"></span>

                    <span class="right-panel"></span>

                    <!-- Slider -->
                    <div id="slider">

                        <!-- Slider List -->
                        <ul>

                            <!-- Slide 1 -->
                            <li>
                                <a href="">
                                    <img src="<?php echo bloginfo('template_url'); ?>/images/slide6.jpg" alt="" />
                                    <p class="featured-content-slider-title">"I want to put a ding in the Universe."</p>
                                    <p class="featured-content-slider-author">By <span class="pink">Steve Jobs</span> / 02.25.1955</p>
                                </a>
                            </li>
                            <!-- /Slide 1 -->

                            <!-- Slide 2 -->
                            <li>
                                <a href="">
                                    <img src="<?php echo bloginfo('template_url'); ?>/images/slide7.jpg" alt="" />
                                    <p class="featured-content-slider-title">"Innotvation distinguishes between a leader and a follower."</p>
                                    <p class="featured-content-slider-author">By <span class="pink">Steve Jobs</span> / 01.09.2007</p>
                                </a>
                            </li>
                            <!-- /Slide 2 -->

                            <!-- Slide 3 -->
                            <li>
                                <a href="">
                                    <img src="<?php echo bloginfo('template_url'); ?>/images/slide8.jpg" alt="" />
                                    <p class="featured-content-slider-title">"It's really hard to design products by focus groups. A lot of times, people don't know what they want until you show it to them."</p>
                                    <p class="featured-content-slider-author">By <span class="pink">Steve Jobs</span> / 09.14.1984</p>
                                </a>
                            </li>   
                            <!-- /Slide 3 -->

                            <!-- Slide 4 -->
                            <li>
                                <a href="">
                                    <img src="<?php echo bloginfo('template_url'); ?>/images/slide1.png" alt="" />
                                    <p class="featured-content-slider-title">"Your time is limited, so don't waste it living in someone else's life."</p>
                                    <p class="featured-content-slider-author">By <span class="pink">Steve Jobs</span> / 03.22.1986</p>
                                </a>
                            </li>
                            <!-- /Slide 4 -->

                            <!-- Slide 5 -->
                            <li>
                                <a href="">
                                    <img src="<?php echo bloginfo('template_url'); ?>/images/slide3.png" alt="" />
                                <p class="featured-content-slider-title">"An iPod, a phone, an internet mobile communicator... these are NOT three separate devices! And we are calling it iPhone! Today Apple is going to reinvent the phone. And here it is."</p>
                                    <p class="featured-content-slider-author">By <span class="pink">Steve Jobs</span> / 10.05.2011</p>
                                </a>
                            </li>
                            <!-- /Slide 5 -->

                        </ul>
                        <!-- /Slider List -->

                    </div>
                    <!-- /Slider -->

                </div>
                <!-- /Content -->

            </div>
            <!-- /Container -->

            <div class="border"></div>

                            //Dynamically center featured content slide
            var image_width = 940;

            $(document).ready(function() {        
                $('#slider').css('padding-left', ($(window).width() - image_width) / 2);
            });

            $(window).resize(function() {
                $('#slider').css('padding-left', ($(window).width() - image_width) / 2);
            });

            // Dyanmically resize featured content slide left and right panels
            jQuery(window).load(function() {

                // Before window loads, resize left and right featured content slider pannels 
                var browser_width = jQuery(window).width();
                var slide_width = 940;
                var panel_width = ((browser_width-slide_width)/2);
                jQuery(".left-panel").width(panel_width);
                jQuery(".right-panel").width(panel_width);

            });

            // Document Ready
            jQuery(document).ready(function () {

                // Blockquote
                jQuery('blockquote').prepend('<div class="quote"></div>');

                // FAQ
                jQuery('.faq-question').click(function () {
                    jQuery(this).next().toggle();
                });

                //Publish Your Work Signup
                jQuery('.writingsample').click(function () {
                    jQuery(this).val("http://");
                });

                //Navigation Search
                // jQuery('.navigation-search').hover(function () {
                //  jQuery('.search-form').fadeIn('slow', function () {
                //      jQuery('input#s').mouseout(function() {
                //          jQuery(this).fadeOut();
                //      });
                //  });
                // });

                jQuery('.navigation-search').click(function () {
                    jQuery('.search-form').toggle();
                });

                // Search Results
                jQuery('#search-results').keyup(function () {
                        var search = jQuery('#search-results').val();
                    jQuery('.search-feedback').html(search);
                });

                //Floating search result sidebar On Other News
                $(function() {
                    var $sidebar   = $('.search-results-sidebar'), 
                        $window    = $(window),
                        offset     = $sidebar.offset(),
                        topPadding = 15;
                    $window.scroll(function() {
                        if ($window.scrollTop() > offset.top) {
                            $sidebar.stop().animate({
                                marginTop: $window.scrollTop() - offset.top + topPadding
                            });
                        } else {
                            $sidebar.stop().animate({
                                marginTop: 0
                            });
                        }
                    });
                });

                // Resize Featured Content Slider
                var TTB = {
                    resize:function() {
                        jQuery(".left-panel").width((jQuery(document).width()-940)/2);
                        jQuery(".left-panel a").width((jQuery(document).width()-940)/2);
                        jQuery(".right-panel").width((jQuery(document).width()-940)/2);
                        jQuery(".right-panel a").width((jQuery(document).width()-940)/2);
                    }
                }

                // Call Resize  
                jQuery(window).resize(function() {
                        TTB.resize();
                });

                // Featured Content Slider (EasySlider)
                jQuery("#slider").easySlider({
                    auto:           true, 
                    continuous:     true,
                    prevId:         'featured-content-slider-left-panel',
                    prevText:       '',
                    nextId:         'featured-content-slider-right-panel',  
                    nextText:       '',
                    controlsShow:   true,
                    controlsBefore: '',
                    controlsAfter:  '', 
                    controlsFade:   true,
                    firstId:        'firstBtn',
                    firstText:      'First',
                    firstShow:      false,
                    lastId:         'lastBtn',  
                    lastText:       'Last',
                    lastShow:       false,              
                    vertical:       false,
                    speed:          3200,
                    pause:          5000,
                    numeric:        false,
                    numericId:      'controls'
              });

            }); 
```

# jsf - f:convertNumber 不会在十进制的尾随字母字符上引发转换错误

> ID：11253368
> 
> 赞同：5
> 
> 时间：2012-06-28T21:45:43.867
> 
> 标签：jsf, converter, number-formatting

我正在使用`<f:convertNumber>`标签来转换十进制输入。

```
<f:convertNumber minFractionDigits="2" /> 
```

但它接受尾随字母字符。例如，如果我输入`12345.1234AAA`它会转换为`12345.123`. 我希望它抛出一个转换错误，而不是修剪字母字符。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T11:54:44.527

这只是as 所使用的[标准行为](https://stackoverflow.com/questions/4324997/why-does-decimalformat-allow-characters-as-suffix)： 它修剪第一个不允许的字符之后的所有条目（例如，输入语言环境中定义的字母或小数分隔符除外）。仅当违规字符位于开头时，转换才会失败。[`java.text.NumberFormat`](http://docs.oracle.com/javase/8/docs/api/java/text/NumberFormat.html)`<f:convertNumber>`

我不太喜欢这种行为，因为用户可能没有注意到他输入错误的值被修剪，导致意外和（甚至更糟）未被注意到的自动更正为错误值。

有趣的是，特定数字转换器的行为不同。Using`<f:converter converterId="javax.faces.Double" />`不会自动处理非数字输入，而是会导致转换失败。但是，该标签不具备 convertNumber 的附加属性，例如 minFractionDigits 或货币符号。

另一种方法是编写您自己的自定义转换器，该转换器扩展标准转换器，如[本答案](https://stackoverflow.com/a/6670810/840977)中所述。然后，您可以检查字符的值并直接中止进一步处理（抛出相应的转换异常）（如果找到）。如果该值已经是无字符的，您可以调用您从中派生的转换器的标准行为。

这两种方式的缺点是您失去了`convertNumber`. 您没有`minFractionDigits`或`currencySymbol`on 等 属性`<f:converter>`，因此如果您需要此属性，则必须找到另一种传递参数的方法。我们的实现不需要任何这些，所以我没有进一步研究这个（我们选择了方法 A），但是[这个答案](https://stackoverflow.com/a/6933053/840977)提供了一种方法。

# ios5 - 在 phonegap(ios) ipad 应用程序中打开 pdf

> ID：11253377
> 
> 赞同：0
> 
> 时间：2012-06-28T21:46:47.423
> 
> 标签：ios5, phonegap-plugins

我是跨平台 ipad 应用程序开发人员。我正在尝试使用文本搜索选项在我的应用程序中打开一个 pdf 文件。是否有可能在应用程序中加载 pdf 文件？需要phonegap插件吗？我可以使用 CGScanner 搜索 pdf 中的文本吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T04:49:45.180

我想它会类似于[这里](http://eisabainyo.net/weblog/2012/01/24/embed-a-youtube-video-iframe-in-phonegap-app/)的这种方法。尽管这并不一定会给您搜索。

# jquery - jquery表数据

> ID：11253380
> 
> 赞同：-4
> 
> 时间：2012-06-28T21:47:01.823
> 
> 标签：jquery, jquery-plugins, datatables

我有下表

```
<thead>

<tr>

<th>Account ID</th>

<th>Code</th>

<th>Date Created</th>

<th>Date Expires</th>

<th>Balance</th>

<th>Approve</th>

<th>Deny</th>

</tr>

</thead>

<tbody>

<tr class="test">

<td class="giftcardaccount_id"><span>35083</span>

</td>

<td class="code"><span>xxxxxxxxx</span>

</td>

<td><span>2012-06-28</span>

</td>

<td><span>2012-06-28</span>

</td>

<td><span>9.0000</span>

</td>

<td><Button id="approval_0" type="submit" class="save-button btn success floatRight" ><span>Approve</span> </button>

</td>

<td><Button id="deny_0" type="submit" class="save-button btn danger floatRight" ><span>Deny</span> </button>

</td>

</tr>

<tr class="test">

<td class="giftcardaccount_id"><span>35084</span>

</td>

<td class="code"><span>xxxxxxxx</span>

</td>

<td><span>2012-06-28</span>

</td>

<td><span>2012-06-28</span>

</td>

<td><span>9.0000</span>

</td>

<td><Button id="approval_1" type="submit" class="save-button btn success floatRight" ><span>Approve</span> </button>

</td>

<td><Button id="deny_1" type="submit" class="save-button btn danger floatRight" ><span>Deny</span> </button>

</td>

</tr>

</tbody> 
```

我想要做的是，如果有人点击批准，我想获取所有行数据，以及点击批准按钮的信息。与拒绝按钮相同。我将如何使用 jquery 来做到这一点。

谢谢

```
**EDIT**
did this but not sure how to get the button that was clicked. I can get the data by this, but I dont know if the deny was clicked or submit was? 
```

$('.test').click(function() {

```
 var id = $(this).children('.giftcardaccount_id').text();

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T22:32:54.340

```
$('.test').click(function() {
    var id = $(this).find('.giftcardaccount_id:first > span').text();
}); 
```

# php - 用变量扩展一个类？

> ID：11253381
> 
> 赞同：2
> 
> 时间：2012-06-28T21:47:04.800
> 
> 标签：php

这有效并经过测试。PHP代码：

```
$data_stats = json_decode($ret);
$projected_points = $data_stats->body->player_stats->42550689->FPTS 
```

我只需要知道如何使用变量来做到这一点。像这样的东西：PHP代码：

```
$data_stats = json_decode($ret);
$projected_points = $data_stats->body->player_stats->$id->FPTS 
```

我怎样才能让 $id 在这里工作？

这也称为扩展类吗？我什至不知道描述我的问题的正确术语。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T21:53:19.070

我相信您可以使用替代语法访问属性`$obj->player_stats->{$var}`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T21:49:24.017

您正在寻找一个变量变量...类似于：

$你的 ID = 42550689

然后，你这样做：

$projected_points = $data_stats->body->player_stats->$$yourId->FPTS

查看文档以获取更多信息：[http ://www.php.net/manual/en/language.variables.variable.php](http://www.php.net/manual/en/language.variables.variable.php)

# git - 使用每个文件的差异/补丁获取所有提交（摘要）的列表

> ID：11253382
> 
> 赞同：2
> 
> 时间：2012-06-28T21:47:05.600
> 
> 标签：git

我在主分支中有一个简单的 Git 存储库，其中包含非分支提交。我想随时间生成所有提交的列表以及消息（如`git log`产生），但对于每个我想查看该提交与每个文件的前一个之间的增量补丁（如`git diff`显式提供相邻提交值时产生）。

这是我可以直接用 git 生成的东西，还是我只需要抓取输出`git log`并使用脚本将滚动值提供给`git diff`?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T21:49:55.533

您可以使用以下命令：

```
git log -p 
```

该`-p`选项告诉为每个提交`git log`输出一个*补丁*。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-28T21:49:48.547

够了吗`git log -u`？

在这里填写，因为答案太短了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-28T21:57:35.437

### 当前分支的日志

如果您想要仅针对当前分支的带有补丁的日志，您可以使用`git log --patch`它来查看每个条目及其关联的差异格式。

### 一切的日志

git-log(1) 命令还获取提交列表，因此您可以遍历树并查看存储库中的*所有*提交`git log --patch $(git rev-parse --all)`。

### 也可以看看

[http://git-scm.com/book/en/Git-Basics-Viewing-the-Commit-History](http://git-scm.com/book/en/Git-Basics-Viewing-the-Commit-History)

# c++ - 无法打开文件“dxguid.lib”

> ID：11253383
> 
> 赞同：4
> 
> 时间：2012-06-28T21:47:16.530
> 
> 标签：c++, visual-studio, linker, directx

我遇到了烦人的链接器问题 - VS2010 声称它找不到这个文件，但它显然在那里，并且路径是正确的 - 我在同一个文件夹中使用其他库，所有工作都没有问题。（d3d9.lib 和 dinput8.lib）我正在使用 2010 年 2 月版的 DXSDK (DX9)，以防万一。我什至尝试过复制/粘贴文件名，所以我知道我没有输入错误。我的“附加依赖项”行如下所示：

```
Library.lib;d3d9.lib;dinput8.lib;dxguid.lib;%(AdditionalDependencies) 
```

并且附加库目录行是（用于调试构建）：

```
$(DXSDK_DIR)\Lib\;$(SolutionDir)\Debug;%(AdditionalLibraryDirectories) 
```

（Library.lib 是我自己的库，存储在 $(SolutionDir)\Debug 文件夹中，或者 Release 版本的 Release 中，但这不是问题。）

DXSDK 目录包含 2 个子文件夹，x64 和 x86，并且文件存在于它们中，以及其他两个可以正常工作的库。（运行 Windows 7 64 位，所以应该使用第一个。）有什么想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-28T21:51:27.137

编辑： dinput8 和 d3d9 库可能已经在标准库中（它们太旧了），这就是为什么它以前有效。

目录

```
$(DXSDK_DIR)\Lib 
```

不是一条完整的路径。它必须是

```
$(DXSDK_DIR)\Lib\x86 
```

或者

```
$(DXSDK_DIR)\Lib\x64 
```

取决于你的目标。

如果您正在为 32 位环境构建项目（转到配置管理器并检查确切的目标），请使用 x86 子目录，否则使用 x64。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T09:11:17.553

您还应该注意，对于 Visual Studio Express 2008、2010 和 CodeBlocks，您需要位于附加库列表顶部的 DirectX 路径或任何可能调用的路径。使用带有奇怪符号的路径（虚拟路径，对吗？）以及直接浏览到 DirectX 安装中的路径。

如果您在 32 但机器上使用 Lib/x86，如果在 64 位上使用 Lib/x64。还要确保包含带有 DirectX 标头的 Include 目录。

不确定这是否会对您有所帮助，但如果您使用的是旧 DirectX 代码，这里是我的视频教程系列： [http ://hi-techheadache.blogspot.com/p/using-old-source-code.html](http://hi-techheadache.blogspot.com/p/using-old-source-code.html)

它还将阐明我所说的一切，因为我向您展示了如何设置这些 IDE 以使用 DirectX。

# c++ - 使用装饰器模式时，我可以在具体的装饰器对象中添加新的装饰器吗？

> ID：11253388
> 
> 赞同：1
> 
> 时间：2012-06-28T21:47:29.980
> 
> 标签：c++, design-patterns, decorator, encapsulation

例子：

```
class Display
{
public:
    virtual void display() = 0;
};

class PageDisplay : public Display
{
public:
    void display() { /* ... */ }
};

class DisplayDecorator : public Display
{
public:
    DisplayDecorator(Display* display) : m_display(display) {}
    virtual void display() { m_display->display(); }
private:
    Display* m_display;
};

class BorderDecorator : public DisplayDecorator
{
public:
    BorderDecorator(Display* display) : DisplayDecorator(display) {}
    virtual void display() { DisplayDecorator::display(); /* do border stuff here ... */ }
};

int main()
{
    Display* pageDisp = new BorderDecorator(new PageDisplay());
    pageDisp->display();
} 
```

所以，这是装饰器模式的一个相当基本的实现。但是，例如，假设我想从 BorderDecorator 具体类中添加一个额外的装饰器。所以 BorderDecorator::display 函数现在看起来像这样：

```
virtual void display()
{ 
    /*
    I need to add a decorator that will display a slider bar at the side of the screen, 
    and that will wrap the PageDisplay decorator so that it will run before the page display.
    Is there a clean way to get my base class' m_display pointer so that I can do something like this:
    */
    m_display = new SliderDecorator(m_display);

    DisplayDecorator::display();
    /* do border stuff here ... */
} 
```

我也知道，在这个例子中，我真的只想从客户端函数（在本例中为 main）应用 SliderDecorator。我无法想出一个很好的例子来说明为什么需要从具体的装饰器对象中添加额外的装饰器（除了我正在处理的东西），但请耐心等待；我这样做确实有充分的理由。我也知道我可以在抽象装饰器对象（本例中为 m_display）中使抽象基类指针受保护而不是私有，然后就像我在示例中所做的那样从具体的装饰器对象中添加额外的装饰器，但这看起来像一个坏主意，因为它破坏了数据封装，现在装饰器可能不正确地与它们装饰的对象交互。话虽如此，这是我唯一的选择吗？在具体装饰器的“装饰”功能中是否有更好的方法来用另一个装饰器包装复合装饰器，然后像往常一样继续？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T06:33:08.260

事情就是这样。客户应该知道要应用哪些装饰器。将此逻辑推送到内部装饰器没有意义，因为当客户端调用 BorderDecorator 时，它只需要一个边框而不是带有滑块的边框。在客户端代码中，如果要链接多个需要能够动态指定的装饰器，可以使用[责任链](http://en.wikipedia.org/wiki/Chain-of-responsibility_pattern)模式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T06:45:54.427

当然，为什么不呢？您实际上是在对您添加的装饰器进行专门化，或者是用于构造常用装饰器组合的实用程序类/方法。

听起来像是一个很好的代码整合。继续前进。

# python - 查找以字符串开头的数据框列中的所有元素

> ID：11253390
> 
> 赞同：1
> 
> 时间：2012-06-28T21:47:30.467
> 
> 标签：python, pandas

我目前正在使用以下代码汇总数字。对于 中的每个元素`dataframe`，我设置了一些汇总条件，但它是已创建报告中最慢的部分。是否有更快的方法来识别数据框中以某个字符串开头的所有元素？

```
for idx, eachRecord in attributionCalcDF.T.iteritems():        
   if (attributionCalcDF['SEC_ID'].ix[idx] == 0):

       currentGroup = lambda x:  str(x).startswith(attributionCalcDF['GROUP_LIST'].ix[idx])
       currentGroupArray = attributionCalcDF['GROUP_LIST'].map(currentGroup)

       attributionCalcDF['ROLLUP_DAILY_TIMING_IMPACT'].ix[idx] = (
                                                         attributionCalcDF['DAILY_TIMING_IMPACT'][(attributionCalcDF['SEC_ID'] != 0) & 
                                                        (currentGroupArray) & 
                                                        (attributionCalcDF['START_DATE'] == attributionCalcDF['START_DATE'].ix[idx])].sum())

       attributionCalcDF['ROLLUP_DAILY_STOCK_TO_GROUP_IMPACT'].ix[idx] = (
                                                         attributionCalcDF['DAILY_STOCK_TO_GROUP_IMPACT'][(attributionCalcDF['SEC_ID'] != 0) & 
                                                        (currentGroupArray) & 
                                                        (attributionCalcDF['START_DATE'] == attributionCalcDF['START_DATE'].ix[idx])].sum()) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T14:10:32.430

这部分功能可能会给您带来沉重的打击`currentGroup`：

```
attributionCalcDF['GROUP_LIST'].ix[idx] 
```

尝试将其保存到临时变量并在`startswith`. 我计划很快为 pandas 添加矢量化字符串函数，这样在这些情况下也会有很大帮助。

# iphone - 自定义推送通知的有效负载内容，当应用程序在 iPhone 的后台模式下？

> ID：11253393
> 
> 赞同：1
> 
> 时间：2012-06-28T21:47:47.957
> 
> 标签：iphone, apple-push-notifications, payload

我正在将苹果推送通知实现到我的应用程序中，并且我正在正确收到通知。但是当通知以后台模式到达应用程序时，我遇到了一些问题。从服务器端，他们以以下格式发送通知

```
 a/a/The new deal is added/someText/a 
```

但我想在通知栏中自定义有效负载消息，即）我想显示**“新交易已添加”**的消息。那么当应用程序处于后台状态时，如何自定义通知栏中内容的有效负载？

所以请帮帮我。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T22:04:10.283

据我了解，在显示之前更改通过推送通知发送的消息的唯一方法是使用“本地化”机制。

查看有关“本地化格式化字符串”的 Apple 文档：http: [//developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/ApplePushService/ApplePushService.html#//apple_ref/doc/uid /TP40008194-CH100-SW21](http://developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/ApplePushService/ApplePushService.html#//apple_ref/doc/uid/TP40008194-CH100-SW21)

我不确定这是您想要实现的目标。

在我看来，如果你不想在你的应用程序在后台或前台显示不同的消息/数据，你应该更改通过推送通知发送的数据。

像这样的东西：

```
{
    "aps" : {
        "alert" : "Message displayed when app is in background"
    },
    "foreground_alert" : "Another message or data used when app is in foreground"
} 
```

当您的应用程序处于后台时，“警报”的内容将自动显示。

当您的应用程序处于前台时，您必须实现[application:didReceiveRemoteNotification](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIApplicationDelegate_Protocol/Reference/Reference.html#//apple_ref/occ/intfm/UIApplicationDelegate/application%3adidReceiveRemoteNotification%3a)来捕获和处理传入的通知（并以示例显示“foreground_alert”的内容）

# actionscript-3 - 重新设置显示对象时的变换矩阵操作

> ID：11253400
> 
> 赞同：2
> 
> 时间：2012-06-28T21:48:12.007
> 
> 标签：actionscript-3, flash, matrix

从一个层次结构重新设置为另一个层次结构时，我在保持显示对象的相同变换时遇到问题。在下图中，您可以看到包含嵌套子“mc2”的影片剪辑“mc1”。“mc2”有自己的孩子“mc3”等等。每个后代都以某种方式进行了转换（旋转、缩放等）。我想从层次结构“mc1”中取出“mc4”并放入层次结构“do1”的“do3”（每个级别也有不同的转换）。

那么如何在不改变其外观（位置除外）的情况下将方形“mc4”放入其他层次结构中？（想象一下拖放）。

我尝试使用 Transform.concatenedMatrix 属性来做，但我迷路了。

谢谢！

![嵌套影片剪辑](../Images/3619adfec5ae6039bd0e1a87e53eb98f.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T10:29:16.560

经过几次实验，我自己找到了正确的答案：

```
 import flash.display.DisplayObject;
    import flash.display.DisplayObjectContainer;
    import flash.geom.Matrix; 

function changeParent ( displayObject : DisplayObject, newParent : DisplayObjectContainer, depth : int = -1 ) : void {

    var concatenedChildMatrix       : Matrix = displayObject.transform.concatenatedMatrix;

    var concatenedNewParentMatrix   : Matrix = newParent.transform.concatenatedMatrix;

    // invert matrix. It couses visual removal of transformations (movie clip looks like it wasn't transformed )
    concatenedNewParentMatrix.invert();

    concatenedChildMatrix.concat( concatenedNewParentMatrix );

    // if you want to add clip not on top level
    if ( depth >= 0 ) {
        newParent.addChildAt( displayObject, depth );
    } else {
        newParent.addChild( displayObject );
    }

    // assign matrix back
    displayObject.transform.matrix = concatenedChildMatrix;

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T22:51:36.910

你可以试试这个，它适用于我的情况（当你所做的只是修改 scale/x/y/rotation 属性时），但在使用转换矩阵时可能无法正常工作。

```
function changeParent(displayObj:DisplayObject, newParent:DisplayObjectContainer, depth:Number = -1, retainRelativeSize:Boolean = false):void {
var tmpParent:DisplayObjectContainer = displayObj.parent;

    while (tmpParent) {
        displayObj.scaleX *= tmpParent.scaleX;
        displayObj.scaleY *= tmpParent.scaleY;
        displayObj.rotation += tmpParent.rotation;
        tmpParent = tmpParent.parent;
    }

    tmpParent = newParent;
    while(tmpParent){
        displayObj.scaleX = displayObj.scaleX / tmpParent.scaleX;
        displayObj.scaleY = displayObj.scaleX / tmpParent.scaleY;
        displayObj.rotation -= tmpParent.rotation;
        tmpParent = tmpParent.parent;
    }

    var point1:Point= displayObj.localToGlobal(new Point());
    var point2:Point = newParent.globalToLocal(point1);

    if (depth >= 0) {
        newParent.addChildAt(displayObj, depth);
    }else {
        newParent.addChild(displayObj);
    }

    displayObj.x = point2.x;
    displayObj.y = point2.y;

} 
```

# ruby - Ruby - 创建 Google 幻灯片

> ID：11253404
> 
> 赞同：0
> 
> 时间：2012-06-28T21:48:39.683
> 
> 标签：ruby, gem

是否有可用于使用纯文本创建 Google 幻灯片/Powerpoint 的 Ruby gem？我已经搜索了所有内容，但找不到任何我想要的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T23:21:38.843

我找不到任何导出到 Google 或 PowerPoint 的内容，但您可以尝试[ShowOff](https://github.com/schacon/showoff)。

# oracle - Oracle中列的拆分值

> ID：11253409
> 
> 赞同：0
> 
> 时间：2012-06-28T21:48:53.010
> 
> 标签：oracle

我有一列，结果如下所示：

*   第 1 列
*   999999999990
*   000000000000
*   999999999000
*   999999999900

这些字符代表过去 12 个月，所以我想知道 Oracle 10 中是否有任何内置函数，以便我可以将值拆分为列？我的意思是喜欢

*   第 1 列 第 2 列... 第 12 列
*   9 9 0
*   0 0 0

提前感谢您的回答。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T21:52:01.690

当然

```
SELECT substr( <<column name>>, 1, 1 ) column1,
       substr( <<column name>>, 2, 1 ) column2,
       substr( <<column name>>, 3, 1 ) column3,
       ...
       substr( <<column name>>, 12, 1 ) column12
  FROM <<table name>> 
```

该`SUBSTR`函数接受三个参数——字符串、起始位置和长度。所以`SUBSTR( <<column name>>, 3, 1)`告诉 Oracle 转到字符串的第三个字符并获取 1 个字符的子字符串。这将是字符串的第三个字符。

# php - Wordpress 主题：在移动设备上显示不同数量的帖子？

> ID：11253411
> 
> 赞同：0
> 
> 时间：2012-06-28T21:48:58.997
> 
> 标签：php, wordpress, wordpress-theming, mobile-website

我尝试使标题尽可能具有描述性……我想知道的是；如果可以在移动/手持设备的首页上显示不同数量的帖子..

我想您可以为查询做一些其他事情，并且会以某种方式涉及用户代理。但我想知道是否有一些防弹解决方案？这样就没有浏览器或移动/手持设备可以达到完整版本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T22:00:08.243

如果您在 Wordpress 中使用单独的移动主题，您可以编辑该特定主题中的循环以仅显示您想要的任意数量的帖子。

这是这样做的理想方式。

似乎您想在桌面和移动设备上使用相同的 Wordpress 主题，并且只想更改显示的帖子数量。我不会推荐这个。而是使用单独的主题并让 Wordpress 根据用户代理显示不同的主题。

我在下面链接到的插件可能会对您有所帮助。

[http://wordpress.org/extend/plugins/wp-mobile-detector/](http://wordpress.org/extend/plugins/wp-mobile-detector/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T22:00:29.853

[您可以使用http://detectmobiledevices.mobi](http://detectmobiledevices.mobi)上的脚本检测用户是否在您的 wordpress 网站上的移动设备上。正如文章所说，只需将其添加到您的主题文件夹中。

```
include('mobile_device_detect.php');
$mobile = mobile_device_detect(); 
```

您可以在此处找到原始文章：http: [//www.wprecipes.com/how-to-detect-mobile-visitors-on-your-wordpress-blog](http://www.wprecipes.com/how-to-detect-mobile-visitors-on-your-wordpress-blog)

如果您没有单独的移动主题，这可能是您想要的方式。

# ubuntu - Quickly/Glade 自动调整文本位置

> ID：11253412
> 
> 赞同：0
> 
> 时间：2012-06-28T21:48:59.760
> 
> 标签：ubuntu, pygtk, glade, canonical-quickly

在 Quickly/Glade 中，是否可以将文本（以及标签）保持居中，所以当我最大化程序窗口时，文本保持居中？这可能很容易做到，但我一直无法找到自动调整位置的位置。任何帮助将不胜感激。我也被 Askubuntu 推荐到这里，所以我希望这是正确的地方。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T09:00:42.080

查看标签的包装属性（或者可能是标签的容器，`VBox`例如，如果它是 a）并确保`expand`is`True`和`fill`is also `True`。

# python - 'str' 对象不可调用 Django

> ID：11253414
> 
> 赞同：2
> 
> 时间：2012-06-28T21:49:02.460
> 
> 标签：python, django

我是 Django 的新手，我想在自己扩展之前先阅读一些教程。我正在尝试对此处描述的日历应用程序进行编程：http: [//lightbird.net/dbe/cal1.html](http://lightbird.net/dbe/cal1.html)。但是，他们的 URLconfigs 似乎对我不起作用，因为我收到以下错误：

```
TypeError at /admin/

'str' object is not callable

Request Method:         GET
Request URL:    http://ec2-23-20-82-228.compute-1.amazonaws.com:8000/admin/
Django Version:     1.4
Exception Type:     TypeError
Exception Value:    

'str' object is not callable

Exception Location:     /usr/local/lib/python2.7/dist-packages/django/core/handlers/base.py in get_response, line 111
Python Executable:  /usr/bin/python
Python Version:         2.7.3 
```

如果有人能指出我正确的方向，将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-28T21:59:30.430

我很确定您的错误是由错误的 url conf 引起的，您发布的链接仅描述了 2 个 urlpatterns 而不是整个 url conf：

```
(r"^(\d+)/$", "main"),
(r"", "main"), 
```

如果正确设置前缀，则只能引用字符串“main”，因此在您的情况下，您可能具有如下结构：

```
/project
    /app
        views.py
        urls.py 
```

你的 url conf 应该是：

```
urlpatterns = patterns('app.views',
    (r"^(\d+)/$", "main"),
    (r"", "main"),
) 
```

您也可以像这样直接导入函数：

```
from app.views import main

urlpatterns = patterns('',
    (r"^(\d+)/$", main),
    (r"", main),
) 
```

我认为让两个 url 指向同一个视图也是不好的做法，我宁愿为第二个创建重定向并让视图确定是否有要处理的参数

# html - CSS 移动图像

> ID：11253415
> 
> 赞同：-1
> 
> 时间：2012-06-28T21:49:02.993
> 
> 标签：html, css

我正在尝试开发一个主题，并且我想选择放置图像的位置。但仅适用于该图像。我正在用css做。当我做

```
img {
[DIMENSIONS AND STUFF
} 
```

它将所有图像移动到选定的位置。我只希望它移动一个图像。帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T21:51:46.703

为其指定一个 ID 选择器。

**HTML**

```
<img src="" id="image" /> 
```

**CSS**

```
#image {
...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T21:52:28.093

像这样添加`id="theName"`到`<img>`标签中：

```
<img id="theName" /> 
```

然后在css中，你写：

```
#theName {
[DIMENSIONS AND STUFF]
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-28T21:51:26.653

利用 ：

```
<img class="whatever" src="..." alt="..." /> 
```

然后在您的样式表中：

```
.whatever {
DIMENSIONS AND STUFF
} 
```

# c++ - 在 Bullet Physics 中替代刚体模拟？

> ID：11253419
> 
> 赞同：2
> 
> 时间：2012-06-28T21:49:30.343
> 
> 标签：c++, simulation, bulletphysics, rigid-bodies

我想在 Bullet Physics 引擎中创建自己的刚体模拟算法。有没有办法用我的替换 btrigidbody 集成，但仍保持模拟的其余部分（碰撞检测、接触响应等）？

我只是想比较不同的集成算法（显式欧拉、隐式、龙格库塔等）

我虽然是从 btRigidBody 继承的，但问题是 btRigidBody 的方法不是虚拟的，所以我的方法没有被调用。

有什么建议么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T21:56:15.883

您可以定义自己的约束求解器。自定义约束求解器将允许您在基本 Bullet 实现的同时定义自己的物理场。

我认为您不想覆盖刚体对象本身，因为这可能会产生副作用。

见参考：[http ://bulletphysics.org/mediawiki-1.5.8/index.php/BtContactSolverInfo](http://bulletphysics.org/mediawiki-1.5.8/index.php/BtContactSolverInfo)

# java - 从 LuaJ 调用 Lua 函数

> ID：11253420
> 
> 赞同：2
> 
> 时间：2012-06-28T21:49:34.927
> 
> 标签：java, lua, luaj

所以，我有一个这样的脚本：

```
function testfunction()
    print("Test from testfunction");
end 
```

我可以从 Lua 中调用 Java 函数，但是我该如何完成相反的操作呢？如何使用 LuaJ 从 Java 调用 Lua 函数？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-05T12:31:16.747

我正在四处寻找解决同样的问题，我想出了与 Profetylen 的答案非常相似的东西

**测试.java：**

```
import org.luaj.vm2.LuaValue;
import org.luaj.vm2.lib.jse.JsePlatform;

public class test
{
    public static void main(String[] args)
    {
        //run the lua script defining your function
        LuaValue _G = JsePlatform.standardGlobals();
        _G.get("dofile").call( LuaValue.valueOf("./test.lua"));

        //call the function MyAdd with two parameters 5, and 5
        LuaValue MyAdd = _G.get("MyAdd");
        LuaValue retvals = MyAdd.call(LuaValue.valueOf(5), LuaValue.valueOf(5));

        //print out the result from the lua function
        System.out.println(retvals.tojstring(1));
    }
} 
```

**测试.lua：**

```
function MyAdd( num1, num2 )
    return num1 + num2
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T13:58:22.047

我不知道，也许这就是您想要做的：（这将为您提供 Scala 内部的返回值）

Main.scala：

```
import org.luaj.vm2._
import org.luaj.vm2.lib.jse._

object Main extends App {
    val global = JsePlatform.standardGlobals()
    global.get("dofile").call(LuaValue.valueOf("test.lua"))

    val args: Array[LuaValue] = Array(LuaValue.valueof(1), LuaValue.valueof(2))
    val retVals: LuaValue.Vararg = global.get("add").invoke(LuaValue.varargsOf(args))

    println(retVals.arg(1))
} 
```

测试.lua：

```
function add(a, b)
    a = a or 0
    b = b or 0
    return a + b
end 
```

注意：我没有测试代码，但它认为这样的东西应该可以工作。

**编辑：**在谷歌搜索时，我没有意识到这个问题与 Scala 无关（当我来到这里时，我自己正在寻找在 Scala 中解决问题）。但是，demon_ds1 似乎根据我的回答在 Java 中找到了解决方案，现在他给出了自己的答案，所以我很高兴这个令人困惑的答案中有一些好东西！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T07:32:22.727

快速浏览一下[LuaJ 文档](http://luaj.sourceforge.net/api/2.0/index.html)，在我看来，您必须获取`org.luaj.vm2.LuaFunction`表示 Lua 函数的对象，然后`invoke`在其上应用该方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-03T19:21:39.150

这些例子真的很有帮助。无论如何，从 java 调用 Lua 代码是非常简单的，因为你总是可以通过类似 loadstring 的方式来调用它。

[https://github.com/sylvanaar/luaj/blob/master/luaj-vm/examples/jse/SampleJseMain.java](https://github.com/sylvanaar/luaj/blob/master/luaj-vm/examples/jse/SampleJseMain.java)

[https://github.com/sylvanaar/luaj/blob/master/luaj-vm/examples/jse/ScriptEngineSample.java](https://github.com/sylvanaar/luaj/blob/master/luaj-vm/examples/jse/ScriptEngineSample.java)

# html - 设置填充时，div 在另一个 div 上展开

> ID：11253428
> 
> 赞同：0
> 
> 时间：2012-06-28T21:50:16.723
> 
> 标签：html, css

当我为 div .detalhes 设置填充时，.detalhes 框会在 div .seta 上展开。看看：http: [//jsfiddle.net/XdfCp/](http://jsfiddle.net/XdfCp/)

我能做些什么来解决这个问题？我的 detalhes div 的 witdh 为 100%。我希望它考虑填充来计算所需的宽度。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T21:55:54.190

删除宽度，不要浮动 div。[http://jsfiddle.net/XdfCp/3/](http://jsfiddle.net/XdfCp/3/)

```
#ListaEventosPorMes .detalhes{
    display: block; 
    background-color: #722827;          
    text-align: left;
    padding: 10px;
} 
```

如果您正在学习 CSS，请花一些时间了解浮点数的工作原理，并在有替代方案时尽量避免使用它们。不要只是浮动一个元素来“修复”某些东西，它可能会产生令人讨厌的后果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T21:55:38.150

这是因为您添加了填充的元素的宽度设置为 100%，这意味着填充将被添加到此元素上，这将在 .seta 上扩展元素。

最好的办法是改变你的宽度并将填充设置为 % 所以像 width:90%; padding: 5% 或设置最大宽度。

像这样的东西：http: [//jsfiddle.net/XdfCp/2/](http://jsfiddle.net/XdfCp/2/)

# javascript - 我必须使用 google.maps.event.addListener(marker, 'click', function(){}) 吗？

> ID：11253440
> 
> 赞同：1
> 
> 时间：2012-06-28T21:51:06.763
> 
> 标签：javascript, jquery, google-maps, google-maps-api-3

我正在学习 Google Maps API，我想知道是否可以使用 jQuery click 事件代替 google.maps.event.addListener(marker, 'click', function(){}); 打开一个 infoWindow 或我的选择是什么？只是找出什么是可能的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T21:55:14.207

你应该能够使用 jQuery 的`.bind()`方法来得到你想要的。

您必须制作一个 jquery 对象，`google.maps.Marker`然后调用`.bind('click',function(){})`它

[http://api.jquery.com/bind/](http://api.jquery.com/bind/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T22:36:30.460

您可能会喜欢使用[jQuery ui 地图插件](http://code.google.com/p/jquery-ui-map/)。为了解决您的问题，[基本示例页面](http://jquery-ui-map.googlecode.com/svn/trunk/demos/jquery-google-maps-basic-example.html)列出了通过单击创建信息窗口的用法：

```
$('#map_canvas').gmap().bind('init', function(ev, map) {
    $('#map_canvas').gmap('addMarker', {'position': '57.7973333,12.0502107',
                          'bounds': true}).click(function() {
        $('#map_canvas').gmap('openInfoWindow', {'content': 'Hello World!'}, 
                                   this);
    });
}); 
```

我个人坚持使用纯 JavaScript 并遵循 Google 文档中的示例。我隐约记得使用这个（或类似的）插件的一些其他问题会遇到不需要的行为，这些行为被“清除”标记功能不直观地解决，所以如果你使用介于你的想法和谷歌的纯 JavaScript 之间的“便利”工具，请注意地图。如果代码是纯 JavaScript，也可能更容易回答问题。

# python - numpy数组中有多少内存？RAM 是限制因素吗？

> ID：11253443
> 
> 赞同：9
> 
> 时间：2012-06-28T21:51:21.447
> 
> 标签：python, arrays, memory, numpy

我正在使用 numpy 创建一个边长为 100 的立方体数组，因此总共包含 100 万个条目。对于百万个条目中的每一个，我都插入了一个 100x100 矩阵，其条目由随机生成的数字组成。我正在使用以下代码来执行此操作：

```
import random
from numpy import *

cube = arange(1000000).reshape(100,100,100)

for element in cube.flat:
    matrix = arange(10000).reshape(100,100)
    for entry in matrix.flat:
        entry = random.random()*100
    element = matrix 
```

我原以为这需要一段时间，但是生成了 100 亿个随机数，我不确定我的计算机甚至可以处理它。这样的数组会占用多少内存？RAM 会是一个限制因素，即如果我的计算机没有足够的 RAM，它会无法实际生成数组吗？

另外，如果有更有效的方法来实现此代码，我将不胜感激：）

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-06-28T21:59:51.710

几点：

*   numpy 数组在内存中的大小很容易计算。它只是元素数量乘以数据大小，加上一个小的常量开销。例如，如果您的`cube.dtype`is `int64`，并且它有 1,000,000 个元素，它将需要`1000000 * 64 / 8 = 8,000,000`字节 (8Mb)。
*   但是，正如@Gabe 所指出的，100 * 100 * 1,000,000 双打将需要大约[80 Gb](http://www.wolframalpha.com/input/?i=100+*+100+*+1%2C000%2C000+*+8+bytes)。
*   这不会导致任何东西“破坏”，就其本身而言，但操作会非常缓慢，因为你的计算机需要做的所有[交换。](http://en.wikipedia.org/wiki/Paging)
*   你的循环不会像你期望的那样。不会替换 中的元素，而是`cube`简单`element = matrix`地覆盖`element`变量，保持`cube`不变。对于`entry = random.rand() * 100`.
*   相反，请参阅：[http ://docs.scipy.org/doc/numpy/reference/arrays.nditer.html#modifying-array-values](http://docs.scipy.org/doc/numpy/reference/arrays.nditer.html#modifying-array-values)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-28T22:39:12.017

对于函数的“内部”部分，请查看 numpy.random 模块

```
import numpy as np
matrix = np.random.random((100,100))*100 
```

# mysql - MySql Sever 无法在 Mac OSX 上使用 MAMP 启动

> ID：11253446
> 
> 赞同：0
> 
> 时间：2012-06-28T21:51:30.710
> 
> 标签：mysql, macos, mamp

我刚刚安装了 MAMP，但无法正常工作。Apache 工作得很好，但 mysql 没有启动，也没有生成日志文件，它只是保持红色。

我正在使用 Mac OS X 10.7.4 和 MAMP 2.0.5。我没有安装 mysql，但据我所知，MAMP 是自带的。

# ruby - Ruby 无法将 Hash 转换为 Int

> ID：11253449
> 
> 赞同：2
> 
> 时间：2012-06-28T21:51:48.937
> 
> 标签：ruby

我有一个 ruby​​ bash 脚本来下载 zip 文件并将进度条输出到标准输出。我有以下

```
# Temp file name
tmp = ActiveSupport::SecureRandom.hex(8)
file = temp_dl_dir+tmp+'.zip'

print file.inspect

# Download
progress_bar = nil
open(file, 'w', :content_length_proc => lambda { |length|
  if length && 0 < length
    progress_bar = ProgressBar.new('...', length)
    progress_bar.file_transfer_mode
  end 
},
:progress_proc => lambda { |progress|
  progress_bar.set(progress) if progress_bar
}) do |fo|
    fo.print open(dl).read
end 
```

但是当我运行它时，我得到

```
open-uri.rb:32:in `initialize': can't convert Hash into Integer (TypeError)
    from /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/open-uri.rb:32:in `open_uri_original_open'
    from /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/open-uri.rb:32:in `open'
    from ./site.rb:191 (line 191 is the open(file, 'w' ...) one) 
```

`open(file, 'w' ...`这意味着我的功能有问题

我不知道怎么了 +_+

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-28T22:10:04.530

`:content_length_proc`似乎与`OpenURI::OpenRead#open`. （检查`ri open`然后搜索`:content_length_proc`。）

我`ri`关于这种方法的文档说：

> 但是，`mode`必须是读取模式，因为`OpenURI::OpenRead#open`不支持写入模式（目前）。也`perm`被忽略，因为它仅对文件创建有意义。

所以你不能使用`OpenURI::OpenRead#open`with`'w'`模式。如果这是您的实际目标，您必须使用不同的机制来写入您的 URL。（您的英文描述说您正在尝试*下载*文件，但在这种情况下您不会对该方法使用`'w'`模式`OpenURI::OpenRead#open`...）

# perl - 为什么 Perl 的两个 arg open 似乎去除了换行符？

> ID：11253450
> 
> 赞同：6
> 
> 时间：2012-06-28T21:52:00.587
> 
> 标签：perl, filesystems

`open()`当我使用包含尾随换行符的文件名调用 perl 的两个参数时，换行符被忽略。但是，三参数版本保留了换行符。

为什么行为不同？为什么换行符表面上被剥离了？

### -- 文件“nl”不存在。做了

```
$ ls -1 nl; 触摸 nl; ls -1 nl
ls: nl: 没有这样的文件或目录
荷兰语
```

### -- 尝试三参数打开 "nl\n" → ENOENT

strace 显示了我期望的行为，FWIW。

```
$ perl -E 'open(F, "<", "nl\n") 或死 $!'
-e 第 1 行没有这样的文件或目录。

$ strace -e trace=open perl -E 'open(F, "<", "nl\n") 或死 $!' 2>&1 | grep nl
open("nl\n", O_RDONLY|O_LARGEFILE) = -1 ENOENT（没有这样的文件或目录）
```

### -- 现在，试试双参数 open "nl\n" → 成功？

```
$ perl -E 'open(F, "nl\n") 或死 $!'
```

### - 什么？为什么这行得通？让我们看看strace。

哦，它忽略了换行符：

```
$ strace -e trace=open perl -E 'open(F, "nl\n") 或死 $!' 2>&1 | grep nl
打开（“nl”，O_RDONLY|O_LARGEFILE）= 3
```

### -- "nl" 仍然是那里唯一的文件

```
$ ls
荷兰语
```

背景：

```
$ perl -v
```

这是为 i686-linux-thread-multi 构建的 perl 5，版本 16，subversion 0 (v5.16.0)。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-28T21:59:57.873

[perldoc perlopentut](http://perldoc.perl.org/perlopentut.html#Open-agrave-la-shell)：

> 另一件需要注意的重要事情是，就像在 shell 中一样，文件名之前或之后的任何空格都会被忽略。这很好，因为您不希望这些做不同的事情：

```
open INFO, "<datafile"
open INFO, "< datafile"
open INFO, "< datafile" 
```

> 这不是一个错误，而是一个功能。因为[open](http://perldoc.perl.org/functions/open.html)以使用重定向箭头指定如何打开文件的方式模仿 shell，所以它也会在文件名本身周围的额外空格方面这样做。要访问具有顽皮名称的文件，请参阅[Dispelling the Dweomer](http://perldoc.perl.org/perlopentut.html#Dispelling-the-Dweomer)。
> 
> 还有一个 3 参数版本的 open，它允许您将特殊的重定向字符放入它们自己的参数中：
> 
> …
> 
> 在这种情况下，要打开的文件名是 中的实际字符串`$datafile`，因此您不必担心`$datafile`包含可能影响打开模式的字符，或者文件名开头的空格会被 2 参数版本吸收. 此外，减少不必要的字符串插值是一件好事。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-28T22:05:19.300

这很简单：因为 2-arg`open`的语法近似于 shell 的语法，甚至到了允许管道的程度。

# google-maps - 用谷歌地图吃晚餐交响乐

> ID：11253453
> 
> 赞同：0
> 
> 时间：2012-06-28T21:52:04.397
> 
> 标签：google-maps, shapefile, repast-simphony

我正在与 Repast-symphony 合作，试图可视化路由模拟的结果。repast 使用形状文件来可视化道路和其他一切。我查看了 googlemaps api，但我认为我无法从他们那里获得 shapefile。我在想

1-是否有可能解决这个问题？（从谷歌地图直接生成形状文件）

2-如何开发将谷歌地图转换为shapefile的编码器？（我想保留附近的地图原始质量）

我见过人们在谷歌地图上覆盖形状文件，但不是相反！

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T00:11:15.487

使用我的地点从谷歌地图生成一个 kml 文件。您可以在谷歌地图上覆盖生成的 kml。您还可以[将 kml 文件转换为 shapefile](https://www.google.com/search?q=kml+to+shapefile)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-26T10:58:53.237

1- 另一种方法是使用[http://www.openstreetmap.org/](http://www.openstreetmap.org/)。形状文件可直接从那里下载。
2- 或者您可以使用 QuantumGIS 等 GIS 软件。有一些插件允许从谷歌地图转换为形状文件

# jquery - jqGrid 内联导航器 url

> ID：11253458
> 
> 赞同：0
> 
> 时间：2012-06-28T21:52:30.573
> 
> 标签：jquery, ajax, jqgrid

现在玩 jqGrid。并且有一些问题。

我想做的事情很简单。我为 CRUD 操作创建了自定义 Web 服务。使用 ajax 请求，我得到 JSON 并将其绑定到指定的 jqGrid。

现在我想使用他们新的内联导航器来创建新记录并更新现有记录。据我所知，有“editurl”属性来设置更新链接。但它也被用于添加项目。

是否可以将这些 url 分开用于不同的操作并将带有行数据的 JSON 传递给我的服务？或者更好的事件——在某种处理程序中只为服务创建自定义 Ajax 请求？

尝试使用 inlineNav 添加参数，但设法仅为“oneditfunc”设置处理程序。

使用表单编辑没有这样的问题。也许我错过了什么？

**UPD：**设法使用自定义“保存”和“取消”按钮对其进行自定义，我在其中发送所需的请求。但是希望，有没有更简单的解决方案？

**UPD**我的示例可在此处获得：http: [//jqgridtest.cloudapp.net](http://jqgridtest.cloudapp.net:8080/) :8080/在任何情况下 - 添加或删除，始终只调用 Edit 方法。我究竟做错了什么？

**UPD**所描述的链接问题与跨域策略没有任何共同之处。当存在跨域问题时 - 还有另一个错误，如“405 Method not allowed”等。部署的示例服务也有跨域请求的解决方法。是的，它在 IE 中不起作用，因为在我的客户端示例中，我没有添加`$.support.cors=true`使其在 IE 中起作用。您也可以在这里查看：http: [//jsbin.com/uxered/7/](http://jsbin.com/uxered/7/)那里有相对 url 添加和编辑。但只有 Edit 被调用。

还有使用 jqgridtest.cloudapp.net 的视频证明：[http](http://www.youtube.com/watch?v=zivlvsV1r98&feature=youtu.be) ://www.youtube.com/watch?v=zivlvsV1r98&feature=youtu.be如您所见，请求成功，所以没有跨域问题，但是调用编辑 url。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T07:47:31.623

方法[inlineNav](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3ainline_editing#inlinenav)有`addParams`和`editParams`选项。该方法`addRow`具有`addRowParams`选项，可用于指定添加行期间使用的[editRow选项。](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3ainline_editing#editrow)所以以下参数应该可以工作

```
$("#grid").jqGrid("inlineNav", "#pager", {
    addParams: {
        addRowParams: {
            keys: true,
            url: "/MyAddRowAction"
        }
    },
    editParams: {
        keys: true,
        url: "/MyEditRowAction"
    }
}); 
```

**更新**：您的演示中的错误非常简单：您使用`url:"http://jqgridtest.cloudapp.net:81/Service1.svc/web/AddData"`和`url:"http://jqgridtest.cloudapp.net:81/Service1.svc/web/EditData"`在适用于`http://jqgridtest.cloudapp.net:8080/`. Ajax 中存在名为[Same origin policy](http://en.wikipedia.org/wiki/Same_origin_policy)的安全限制。`Service1.svc` *您应该在同一个 ASP.NET 站点中*包含 Web 服务（只包含在同一个项目中）。之后，您将能够使用*相对*URL 路径`url:"/Service1.svc/web/AddData"`，`url:"/Service1.svc/web/EditData"`并且您的代码将正常工作。

# c# - 部署：this.Context.Parameters 在整个安装过程中不可用

> ID：11253460
> 
> 赞同：3
> 
> 时间：2012-06-28T21:52:39.367
> 
> 标签：c#, deployment, windows-installer

我有以下代码，但虽然我可以访问一个属性并检索一个值

```
 this.Context.Parameters["SERVICENAME"] 
```

在 BeforeInstall 中，相同的属性在 OnCommitted 中返回“”。

这些数据去哪里了，它是如何被擦除的，我在哪里可以找到这些方法中的每一个的顺序的细目，以及什么被传递到哪里？

```
[RunInstaller(true)]
    public partial class ProjectInstaller : System.Configuration.Install.Installer
    {

        public string ServiceName { get; protected set; }

        /// <summary>
        /// 
        /// </summary>
        public ProjectInstaller()
        {
            InitializeComponent();
        }

        /// <summary>
        /// 
        /// </summary>
        /// <param name="savedState"></param>
        protected override void OnBeforeInstall(IDictionary savedState)
        {
            base.OnBeforeInstall(savedState);
            this.ServiceName = this.Context.Parameters["SERVICENAME"].ToString();
            this.serviceInstaller1.ServiceName = this.ServiceName;
            this.serviceInstaller1.DisplayName = this.ServiceName;
        }

        /// <summary>
        /// /
        /// </summary>
        /// <param name="savedState"></param>
        protected override void OnCommitted(IDictionary savedState)
        {
            base.OnCommitted(savedState);
            string targetDirectory = Path.GetDirectoryName(Context.Parameters["AssemblyPath"]); ;
            string path = System.IO.Path.Combine(targetDirectory, "Services.Win32.exe.config");
            System.Xml.XmlDocument xDoc = new System.Xml.XmlDocument();
            xDoc.Load(path);
            System.Xml.XmlNode node = xDoc.SelectSingleNode("/configuration/applicationSettings/Services.Win32.Properties.Settings/setting[@name='TaskManagerServiceName']/value");
            node.InnerText = (this.ServiceName); // here this.ServiceName is "" so was this.Context.Parameters[""SERVICENAME"] when i was using that
            xDoc.Save(path);
        } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-24T09:19:25.357

我在尝试向现有部署项目添加其他参数时遇到了这个问题。参数已传递给安装程序，但在`Context.Parameters`. 事实证明，需要将可访问的参数添加到该自定义操作的“自定义操作数据”中。

您可以通过右键单击**.vdproj**项目并选择`View -> Custom Actions`. 从那里您可以找到自定义操作的主要输出。通过右键单击所需步骤（安装、提交、回滚或卸载）中的主要输出并选择属性，您可以编辑该步骤的**自定义操作数据**。[您可以在此处](http://msdn.microsoft.com/en-us/library/2w2fhwzz%28v=vs.100%29.aspx)找到该属性的格式。

希望它会节省一些人的时间，因为我花了很长时间才弄清楚这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T19:46:16.573

最简单、最干净和最强大的解决方案是不使用安装程序类自定义操作来安装服务。使用 Windows Installer 的内置机制：[ServiceInstall](http://msdn.microsoft.com/en-us/library/windows/desktop/aa371637%28v=vs.85%29.aspx)表。

问题是您可能正在使用不公开此功能的 Visual Studio 部署项目。没问题。使用 Windows Installer XML 创建一个封装 XE/Service 组件的合并模块。然后将此合并模块添加到您的 VDPROJ 安装程序。

有关如何连接它的想法，请参阅以下文章：

[使用 Windows Installer XML 增强 InstallShield - 证书](http://blog.iswix.com/2011/01/augmenting-installshield-using-windows_19.html)

[使用 Windows Installer XML 增强 InstallShield - Windows 服务](http://blog.deploymentengineering.com/2011/01/augmenting-installshield-using-windows_19.html)

[Visual Studio 部署项目的赎回](http://blog.iswix.com/2011/03/redemption-of-visual-studio-deployment.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-04-27T12:55:36.003

可以在 Installer 类的 Install 和 Uninstall 覆盖上访问它：

这里有一个完整的例子：

```
[RunInstaller(true)]
public partial class ProjectInstaller : System.Configuration.Install.Installer
{

    public ProjectInstaller()
    {
        InitializeComponent();              
    }

    public override void Install(System.Collections.IDictionary stateSaver)
    {
        UpdateServiceName();
        base.Install(stateSaver);
    }

    public override void Uninstall(System.Collections.IDictionary savedState)
    {
        UpdateServiceName();
        base.Uninstall(savedState);
    }
    private void UpdateServiceName()
    {
        var serviceName = Context.Parameters["servicename"];

        //if service name was set has install parameter then override the value set on the designer:
        if (!string.IsNullOrEmpty(serviceName))
        {

            //serviceInstaller1 is the `ServiceInstaller` component drag to install designer.
            this.serviceInstaller1.ServiceName = serviceName;

            //Since user can change service name and do multiple side installs, by keep the display names similar it can help to keep those side installs packed in Service Management Console.
            this.serviceInstaller1.DisplayName = $"{this.serviceInstaller1.DisplayName} ({serviceName})";
        }
    }
} 
```

# php - 从单个字符串中猜出城市、州和邮政编码

> ID：11253461
> 
> 赞同：2
> 
> 时间：2012-06-28T21:52:42.130
> 
> 标签：php, mysql

所以我有一个位置搜索字段，我想接受几乎所有内容（城市、州和邮政编码），例如：

*   加利福尼亚州洛杉矶
*   加利福尼亚
*   90210
*   橙色 CA

以及其中的任何组合...

从那我把单词分成一个数组

```
$inputs = preg_split("/[\s,-\/]+/", $input); 
```

这给了我类似的东西

```
array(5) {
    [0]=> string(4) "Some"
    [1]=> string(4) "City"
    [2]=> string(3) "New"
    [3]=> string(4) "York"
    [4]=> string(5) "88888"
} 
```

然后我先挑邮编

```
foreach ($inputs as $key => $value) {

    if (is_numeric($value) && strlen($value) == 5) {

        $zip = $value;              
        unset($inputs[$key]);
    }
} 
```

注意`unset()`

现在我需要将州名与我的州数据库相匹配。困境是某些州的名称中有多个单词（北卡罗来纳州，纽约州）。

如何匹配我`$inputs`的州名称和缩写，从我的数组中删除匹配的条件（接下来我必须对城市做同样的事情）？

* * *

我想试试

```
$inputString = "'" . implode("','", $inputs) . "'";

$result = mysql_query("SELECT state_name
                      FROM states
                      WHERE state_name IN ({$inputString})
                      OR state_abbrev IN ({$inputString})"); 
```

但这并不能说明它匹配哪些内容或适用于多词状态

编辑：

对于仇恨者，我宁愿没有 3 个单独的字段。我认为这会使用户体验复杂化。我宁愿让服务器而不是他们来思考，以最好地猜测他们试图传达的位置。我还将进行“高级”搜索，其中将包含这些字段，但是所有这些字段都占用了网站设计的太多空间。

例子：

*   [http://maps.google.com/](http://maps.google.com/)
*   [http://vein.com/index.php](http://vein.com/index.php)
*   [http://www.zillow.com/](http://www.zillow.com/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T22:01:28.333

您可以在`address`表中添加一列，其中包含城市名称、州名称、邮政编码等的串联。然后在其上设置一个`FULLTEXT`索引并在其上运行整个输入字符串的全文搜索。

不过，不确定它的性能如何。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T22:25:50.990

这是我目前正在使用的，但是有太多的循环和查询，我怀疑它是否有效或非常准确地“猜测”

```
 function getLocations($input) {

    $state = NULL;
    $zip = NULL;

    $input = strtoupper(trim($input));

    $inputs = preg_split("/[^a-zA-Z0-9]+/", $input);

    // Resolve zip code
    foreach ($inputs as $key => $value) {

        if (is_numeric($value) && strlen($value) == 5) {

            $zip = $value;              
            unset($inputs[$key]);
        }
    }

    $inputs = array_reverse($inputs);

    $result = mysql_query("SELECT state_name, state_abbrev FROM states");

    // Resolve state (one worded)
    while ($row = mysql_fetch_assoc($result)) {

        foreach ($inputs as $key => $value) {

            if ($row['state_abbrev'] == $value || $row['state_name'] == $value) {

                $state = $row['state_abbrev'];
                unset($inputs[$key]);

                return array(
                    'city' => "'" . implode(" ", array_reverse($inputs)) . "'",
                    'state' => "'" . $state . "'",
                    'zip' => "'" . $zip . "'"
                );
            }
        }
    }

    // Resolve state (2/3 worded)
    for ($i = 0; $i < count($inputs) - 1; $i++) {

        $duoValue = @$inputs[$i + 1] . " " . @$inputs[$i];

        if (count($inputs) > $i + 2) {

            $trioValue = $inputs[$i + 2] . " " . $duoValue;
        }

        $result2 = mysql_query("SELECT state_name, state_abbrev FROM states") or die (mysql_error());

        while ($row = mysql_fetch_assoc($result2)) {

            if ($row['state_abbrev'] == $duoValue || $row['state_name'] == $duoValue) {

                $state = $row['state_abbrev'];
                unset($inputs[$i], $inputs[$i + 1]);

                return array(
                    'city' => "'" . implode(" ", array_reverse($inputs)) . "'",
                    'state' => "'" . $state . "'",
                    'zip' => "'" . $zip . "'"
                );
            }
            else if ($i < count($inputs) - 2) {

                if ($row['state_abbrev'] == $trioValue || $row['state_name'] == $trioValue) {

                    $state = $row['state_abbrev'];
                    unset($inputs[$i], $inputs[$i + 1], $inputs[$i + 2]);

                    return array(
                        'city' => "'" . implode(" ", array_reverse($inputs)) . "'",
                        'state' => "'" . $state . "'",
                        'zip' => "'" . $zip . "'"
                    );
                }
            }
        }
    }

    return array(
        'city' => "'" . implode(" ", array_reverse($inputs)) . "'",
        'state' => "'" . $state . "'",
        'zip' => "'" . $zip . "'"
    );
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T00:04:47.733

我完全同意您的想法，即让用户更轻松并将所有地址信息放在 1 个输入框中。但是，每个用户输入信息的方式可能会有所不同，很难想出一个涵盖所有情况的算法。最好的办法是看看是否有人已经这样做了，正如你提到的，谷歌已经这样做了。幸运的是，他们有一个 API 可以解决这样的问题。

如果您使用 Google Maps Geocoder ( [https://developers.google.com/maps/documentation/geocoding/#GeocodingRequests](https://developers.google.com/maps/documentation/geocoding/#GeocodingRequests) )，您基本上可以将任何看起来合理的地址传递给它，它会返回一个结构良好的地址结果。

谷歌的例子：[https ://google-developers.appspot.com/maps/documentation/javascript/examples/geocoding-simple](https://google-developers.appspot.com/maps/documentation/javascript/examples/geocoding-simple)

另一个示例 - 查找白宫：将此 URL 放入浏览器中： [http](http://maps.googleapis.com/maps/api/geocode/json?address=1600%20pennsylvania%20ave%20washongton%20dc&sensor=false) ://maps.googleapis.com/maps/api/geocode/json?address=1600%20pennsylvania%20ave%20washongton%20dc&sensor=false （注意 I此处故意拼错以显示 API 的容差）。

API 调用返回一个非常有用的 JSON 对象：

```
{
   "results" : [
      {
         "address_components" : [
            {
               "long_name" : "1600",
               "short_name" : "1600",
               "types" : [ "street_number" ]
            },
            {
               "long_name" : "Pennsylvania Ave NW",
               "short_name" : "Pennsylvania Ave NW",
               "types" : [ "route" ]
            },
            {
               "long_name" : "Washington",
               "short_name" : "Washington",
               "types" : [ "locality", "political" ]
            },
            {
               "long_name" : "District of Columbia",
               "short_name" : "DC",
               "types" : [ "administrative_area_level_1", "political" ]
            },
            {
               "long_name" : "United States",
               "short_name" : "US",
               "types" : [ "country", "political" ]
            },
            {
               "long_name" : "20502",
               "short_name" : "20502",
               "types" : [ "postal_code" ]
            }
         ],
         "formatted_address" : "1600 Pennsylvania Ave NW, Washington, DC 20502, USA",
         "geometry" : {
            "location" : {
               "lat" : 38.89767770,
               "lng" : -77.03651700000002
            },
            "location_type" : "ROOFTOP",
            "viewport" : {
               "northeast" : {
                  "lat" : 38.89902668029149,
                  "lng" : -77.03516801970852
               },
               "southwest" : {
                  "lat" : 38.89632871970850,
                  "lng" : -77.03786598029153
               }
            }
         },
         "partial_match" : true,
         "types" : [ "street_address" ]
      },
      {
         "address_components" : [
            {
               "long_name" : "1600",
               "short_name" : "1600",
               "types" : [ "street_number" ]
            },
            {
               "long_name" : "Pennsylvania Ave NW",
               "short_name" : "Pennsylvania Ave NW",
               "types" : [ "route" ]
            },
            {
               "long_name" : "Washington",
               "short_name" : "Washington",
               "types" : [ "locality", "political" ]
            },
            {
               "long_name" : "District of Columbia",
               "short_name" : "DC",
               "types" : [ "administrative_area_level_1", "political" ]
            },
            {
               "long_name" : "United States",
               "short_name" : "US",
               "types" : [ "country", "political" ]
            },
            {
               "long_name" : "20500",
               "short_name" : "20500",
               "types" : [ "postal_code" ]
            }
         ],
         "formatted_address" : "1600 Pennsylvania Ave NW, Washington, DC 20500, USA",
         "geometry" : {
            "location" : {
               "lat" : 38.89871490,
               "lng" : -77.03765550
            },
            "location_type" : "ROOFTOP",
            "viewport" : {
               "northeast" : {
                  "lat" : 38.90006388029150,
                  "lng" : -77.03630651970849
               },
               "southwest" : {
                  "lat" : 38.89736591970851,
                  "lng" : -77.03900448029150
               }
            }
         },
         "partial_match" : true,
         "types" : [ "street_address" ]
      },
      {
         "address_components" : [
            {
               "long_name" : "1600",
               "short_name" : "1600",
               "types" : [ "street_number" ]
            },
            {
               "long_name" : "Pennsylvania Ave NW",
               "short_name" : "Pennsylvania Ave NW",
               "types" : [ "route" ]
            },
            {
               "long_name" : "Washington",
               "short_name" : "Washington",
               "types" : [ "locality", "political" ]
            },
            {
               "long_name" : "District of Columbia",
               "short_name" : "DC",
               "types" : [ "administrative_area_level_1", "political" ]
            },
            {
               "long_name" : "United States",
               "short_name" : "US",
               "types" : [ "country", "political" ]
            },
            {
               "long_name" : "20004",
               "short_name" : "20004",
               "types" : [ "postal_code" ]
            }
         ],
         "formatted_address" : "1600 Pennsylvania Ave NW, Washington, DC 20004, USA",
         "geometry" : {
            "location" : {
               "lat" : 38.89549710,
               "lng" : -77.03008090000002
            },
            "location_type" : "ROOFTOP",
            "viewport" : {
               "northeast" : {
                  "lat" : 38.89684608029150,
                  "lng" : -77.02873191970852
               },
               "southwest" : {
                  "lat" : 38.89414811970850,
                  "lng" : -77.03142988029153
               }
            }
         },
         "partial_match" : true,
         "types" : [ "street_address" ]
      },
      {
         "address_components" : [
            {
               "long_name" : "1600",
               "short_name" : "1600",
               "types" : [ "street_number" ]
            },
            {
               "long_name" : "Pennsylvania Ave SE",
               "short_name" : "Pennsylvania Ave SE",
               "types" : [ "route" ]
            },
            {
               "long_name" : "Hill East",
               "short_name" : "Hill East",
               "types" : [ "neighborhood", "political" ]
            },
            {
               "long_name" : "Washington",
               "short_name" : "Washington",
               "types" : [ "locality", "political" ]
            },
            {
               "long_name" : "District of Columbia",
               "short_name" : "DC",
               "types" : [ "administrative_area_level_1", "political" ]
            },
            {
               "long_name" : "United States",
               "short_name" : "US",
               "types" : [ "country", "political" ]
            },
            {
               "long_name" : "20003",
               "short_name" : "20003",
               "types" : [ "postal_code" ]
            }
         ],
         "formatted_address" : "1600 Pennsylvania Ave SE, Washington, DC 20003, USA",
         "geometry" : {
            "bounds" : {
               "northeast" : {
                  "lat" : 38.87865290,
                  "lng" : -76.98170180
               },
               "southwest" : {
                  "lat" : 38.87865220,
                  "lng" : -76.98170229999999
               }
            },
            "location" : {
               "lat" : 38.87865290,
               "lng" : -76.98170180
            },
            "location_type" : "RANGE_INTERPOLATED",
            "viewport" : {
               "northeast" : {
                  "lat" : 38.88000153029150,
                  "lng" : -76.98035306970850
               },
               "southwest" : {
                  "lat" : 38.87730356970850,
                  "lng" : -76.98305103029151
               }
            }
         },
         "partial_match" : true,
         "types" : [ "street_address" ]
      }
   ],
   "status" : "OK"
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-29T00:24:23.840

一个可能的解决方案是只向用户请求一个邮政编码并使用[http://www.zippopotam.us/](http://www.zippopotam.us/)的 api 来获取州和城市，因此不确定这是否符合您的用户体验设计您的要求，但我'已经使用 jquery 使用他们的 api 完成了此操作，该 api 返回两个字段的值

```
 $("#text-4edcd39ecca23").keyup(function (event) {
        if (this.value.length === 5) {
            var $citywrap = $("#fm-item-text-4edcd393cb50f");
            var $city = $("#text-4edcd38744891");
            var $statewrap = $("#fm-item-text-4edcd38744891");
            var $state = $("#text-4edcd393cb50f");
            var $zip = $('#text-4edcd39ecca23');

            $.ajax({
                url:"http://zippo-zippopotamus.dotcloud.com/us/" + $zip.val(),
                cache:false,
                dataType:"json",
                type:"GET",
                data:"us/" + $zip.val(),
                success:function (result, success) {
                    // Remove Error Message if one is presant
                    $zip.parent().find('small').remove();
                    // US Zip Code Records Officially Map to only 1 Primary Location
                    var places = result['places'][0];
                    $city.val(places['place name']);
                    $state.val(places['state']);
                    $citywrap.slideDown();
                    $statewrap.slideDown();
                },
                error:function (result, success) {
                    $citywrap.slideUp();
                    $statewrap.slideUp();
                    $city.val('');
                    $state.val('');
                    $zip.parent().find('br').remove();
                    $zip.parent().find('small').remove();
                    $zip.after('<br /><small class="error">Sorry your zipcode was not reconized please try again</small>');
                }
            });
        }
    }); 
```

# wpf - WPF DataTrigger“找不到触发目标”

> ID：11253470
> 
> 赞同：4
> 
> 时间：2012-06-28T21:53:24.687
> 
> 标签：wpf, datatrigger

我读过其他类似标题的问题，我认为这是一个不同的问题。

我有一个数据绑定组合框。每个项目都有一个“状态”和一个“名称”，显示文本是通过使用 a`TextBlock`和 2将两者连接起来`Run`的。如果它是“未完成”，我想用红色突出显示“状态”部分。这是我的 XAML：

```
<ComboBox ItemsSource="{Binding Results}">
    <ComboBox.ItemTemplate>
        <DataTemplate>
            <DataTemplate.Triggers>
                <DataTrigger Binding="{Binding Status}" Value="NotComplete">
                    <Setter TargetName="txtStatus" Property="Foreground" Value="Red" />
                </DataTrigger>
            </DataTemplate.Triggers>
            <TextBlock>
                <Run Text="{Binding Status}" Name="txtStatus"/>
                <Run Text="{Binding Name" />
            </TextBlock>
        </DataTemplate>
    </ComboBox.ItemTemplate>
</ComboBox> 
```

我得到一个构建错误说

> 找不到触发器目标“txtStatus”。

我尝试了其他一些事情（例如使用`x:Name`而不是`Name`），但得到了同样的错误。我在正确的方向吗？我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-28T22:33:23.003

必须首先声明触发目标。更改顺序，它将起作用。

```
<DataTemplate>
    <TextBlock>
        <Run Text="{Binding Status}" Name="txtStatus" />
        <Run Text="{Binding Name}" />
    </TextBlock>
    <DataTemplate.Triggers>
        <DataTrigger Binding="{Binding Status}" Value="NotComplete">
            <Setter TargetName="txtStatus" Property="Foreground" Value="Red" />
        </DataTrigger>
    </DataTemplate.Triggers>
</DataTemplate> 
```

# shell - if 和 grep 和 -gt 的 Unix Shell 脚本语法

> ID：11253472
> 
> 赞同：0
> 
> 时间：2012-06-28T21:53:40.197
> 
> 标签：shell, scripting, if-statement, grep

我正在使用下面的代码来复制文件。我在 if 语句中遇到错误..请帮助... $1 是一个数字，将在 $j 这是一个文件中搜索...如果有一些记录，我想复制该文件，否则什么都不会做.. .

```
for j in $2/$file_z
do
 if ``grep $1 $j | wc -l` -gt 0`
 then
  echo $j
  cp $j $3
 fi
done 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T21:56:03.233

您的脚本中有两个错误：

*   `backticks`不允许嵌套。
*   `$2/$file_z`代替`$(<$2/$file_z)`

固定的：

```
for j in `<$2/$file_z`
do
 if grep -q "$1" "$j" > /dev/null
 # if grep "$1" "$j" > /dev/null # if your grep does not support -q
 then
  echo $j
  cp $j $3
 fi
done 
```

更优化：

```
for j in `<$2/$file_z`
do
 grep -l "$1" "$j" /dev/null && cp $j $3
done 
```

`grep`本身可以打印文件名。

你也可以不用`for`：

```
cp -v $(grep -l "$1" `<$2/$file_z`) $3 
```

该命令与您的整个脚本相同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T22:01:42.353

```
for j in $(<$2/$file_z); do
    echo "$1" | grep &>/dev/null "$j" && cp "$j" "$3"
done 
```

这不是便携式的：

```
grep -q 
```

这就是为什么我`grep &>/dev/null`改用 =)

# android - java.lang.OutOfMemoryError：位图大小超出列表视图中的 VM 预算

> ID：11253474
> 
> 赞同：0
> 
> 时间：2012-06-28T21:53:51.150
> 
> 标签：android, listview, memory-leaks

我在[https://stackoverflow.com/a/6779067/1236259](https://stackoverflow.com/a/6779067/1236259)线程中尝试了 hp.android 答案，但我的活动从未调用 onDestroy 方法

我有一个带有图像的 ListView，我通过以下方式调用其他活动：

```
ImageButton imageButtonSeeMap = (ImageButton)this.findViewById(R.id.imageButtonSeeMap);
imageButtonSeeMap.setOnClickListener(new OnClickListener() {.... 
```

从新活动中，我再次调用 ListView 活动，此时我得到了例外：java.lang.OutOfMemoryError：位图大小超出 VM 预算

列表视图中的图像是使用以下方法创建的：

```
thumb_u = new URL(lp.get(i).getImage());
            thumb_d = Drawable.createFromStream(thumb_u.openStream(), "src");

            imageViewPoi.setImageDrawable(thumb_d); 
```

如何释放图像的内存？onDestroy 方法中的 unbindDrawables 永远不会被调用。

任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T22:08:13.283

图像在 android 中是野兽，所以 OutofMemory 异常是你可能不得不习惯的东西。这应该允许您的列表视图从网络获取图像，而不会使您的应用程序崩溃。

假设第二个代码块来自您的 ListView 的适配器 getView() 方法，请尝试：

```
try {
    thumb_u = new URL(lp.get(i).getImage());
    thumb_d = Drawable.createFromStream(thumb_u.openStream(), "src");
    imageViewPoi.setImageDrawable(thumb_d);
} catch (OutOfMemoryError e) {
    System.gc();
    thumb_u = new URL(lp.get(i).getImage());
    thumb_d = Drawable.createFromStream(thumb_u.openStream(), "src");
    imageViewPoi.setImageDrawable(thumb_d);
} 
```

# java - 从json文件中读取多个元素

> ID：11253476
> 
> 赞同：5
> 
> 时间：2012-06-28T21:53:55.343
> 
> 标签：java, json, file-io, gson

我有一个包含许多元素的 json 文件，例如：

```
{ 
"code" : "hfuiew89", 
"type" : "location", 
"coordinates" : [ { "lat" : 40.9861, "lon" : 29.1046, "index" : 1 }, 
          { "lat" : 40.9976, "lon" : 29.1153, "index" : 2 }, 
          { "lat" : 40.9809, "lon" : 29.2194, "index" : 3 }] 
}
{ 
"code" : "klsdsjh", 
"type" : "location", 
"relatedTags" : [ "kolmha" ], 
"coordinates" : [ { "lat" : 40.9808, "lon" : 29.1605, "index" : 1 }, 
              { "lat" : 40.9965, "lon" : 29.1672, "index" : 2 }] 
} 
```

我想用 gson 读取该文件，但我找到的所有示例都只针对一个元素。因此在阅读第一个之后，抛出“预期 EOF”异常。我该如何克服呢？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-29T03:24:36.833

物有所值...

以下陈述是不正确的。Gson 没有内置功能来简单地处理此类 JSON 序列的反序列化。（看评论。）

如果切换 JSON-to/from-Java API 是一种选择，[Jackson](http://jackson.codehaus.org)确实具有这样的功能，如下所示。

**输入.json**

```
{
"name":"A"
}
{
"name":"B"
} 
```

**JacksonFoo.java**

```
import static com.fasterxml.jackson.annotation.JsonAutoDetect.Visibility.ANY;
import static com.fasterxml.jackson.annotation.PropertyAccessor.FIELD;

import java.io.File;
import java.util.Iterator;

import com.fasterxml.jackson.databind.ObjectMapper;

public class JacksonFoo
{
  public static void main(String[] args) throws Exception
  {
    ObjectMapper mapper = new ObjectMapper().setVisibility(FIELD, ANY);
    Iterator<Thing> thingsIterator = mapper.reader(Thing.class).readValues(new File("input.json"));
    while (thingsIterator.hasNext())
    {
      System.out.println(thingsIterator.next());
    }
  }
}

class Thing
{
  private String name;

  @Override
  public String toString()
  {
    return String.format("Thing: name=%s", name);
  }
} 
```

**输出：**

```
Thing: name=A
Thing: name=B 
```

* * *

**更新：**使用 Gson 的类似解决方案。

**GsonFoo.java**

```
import java.io.FileReader;

import com.google.gson.Gson;
import com.google.gson.GsonBuilder;
import com.google.gson.JsonStreamParser;

public class GsonFoo
{
  public static void main(String[] args) throws Exception
  {
    Gson gson = new GsonBuilder().create();

    JsonStreamParser parser = new JsonStreamParser(new FileReader("input.json"));
    while(parser.hasNext())
    {
      System.out.println(gson.fromJson(parser.next(), Thing.class));
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-28T22:36:02.190

格雷格是对的，这是不正确的JSON，你应该尝试生成有效的JSON，即在开头添加“[”，在末尾添加“]”，并用逗号（“，”）分隔每个元素，所以它是 JSON 对象的 JSON 数组。

但是，如果您无法更改现有格式，请将其视为“包含格式良好的 JSON 片段连接的字符串”。以这种方式接近它，将大字符串分解成更小的、有效的 json 字符串，并一一解析。

要将大字符串分成单个片段，您可以简单地计算括号。使用“预解析器”将内容复制到缓冲区（StringBuilder？），每次遇到“{”时增加一个计数器，每次遇到“}”时减少它，如果计数器为零通过缓冲区字符串到 gson 进行解析，清除缓冲区并继续到文件的末尾。

您甚至可以使用该预解析器将其转换为有效的 json，只需在计数器达到零时附加一个“，”，并将所有内容传递给 gson 进行一次解析，但这可能意味着将所有内容加载到 ram 中，我不不知道你的文件有多大。

# javascript - 滑动li元素

> ID：11253477
> 
> 赞同：4
> 
> 时间：2012-06-28T21:53:56.750
> 
> 标签：javascript, jquery, html

我正在尝试找到一种制作`li`元素幻灯片的方法。我可以将它们全部放在一条线上（见我的小提琴）并将它们适应`ul`宽度。但是，当我单击 NEXT 按钮时，我希望它们向右滑动以显示隐藏的`li`.

我的小提琴：http: [//jsfiddle.net/5cmR7/](http://jsfiddle.net/5cmR7/)

类似的小提琴：http: [//jsfiddle.net/L5yEA/](http://jsfiddle.net/L5yEA/)

*编辑*：我想要这样的东西，[但是](http://jsbin.com/uduyiy)以更好的方式构建，并且在单击 NEXT 时更精确。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T22:15:41.183

这就是你所需要的：

## *[jsBin 演示](http://jsbin.com/asiyus/edit#javascript,html,live)*

```
var liN = $('ul.shop-groups li').length;
var galW = $('.content').width();    
var curr = 0; // Set current 'li' slide

function animate(){  
  var setCurr= (curr===-1) ? (curr = liN-1) : (curr = curr%liN);   
  $('ul.shop-groups').stop().animate({left: -(galW*curr) },1200);  
}

$('#prev, #next').click(function(){
  var who= (this.id==='next') ? curr++ : curr-- ;
  animate();
}); 
```

只需给`ID`您的按钮一个：

```
<input id="prev" type="button" value="PREVIOUS"/>
<input id="next" type="button" value="NEXT"/> 
```

这是更改后的 CSS：

```
.content {
    position:relative; /**/
    width:500px;
    height:250px;
    margin-right:auto;
    margin-left:auto;
    background-color:#555; 
    overflow:hidden; /**/
}

ul.shop-groups {
    position:absolute; /**/
    left:0px;
    background-color: #DDDDDD;
    border-bottom: 1px solid #CCCCCC;
    width: 999999px;
}
ul.shop-groups a {
    color: #fff;
    display: block;
    font-size: 1.1em;
    font-weight: bold;
    line-height: 20px;
    min-width: 20px;
    padding: 2px 15px;
    text-align: center;
}
li.shop-items {
    position:relative;/**/
    float:left;/**/
    border: solid 1px #d45;
    float : left;
    background-color:blue;
    height:248px;    /**/
    width:498px;     /**/
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T22:03:05.727

看看这个，是不是这个意思？

[http://jsfiddle.net/5cmR7/5/](http://jsfiddle.net/5cmR7/5/)

# ruby-on-rails - 从四个随机行保存发布的数据，以便它们在页面生成后不会随机化

> ID：11253479
> 
> 赞同：0
> 
> 时间：2012-06-28T21:54:05.330
> 
> 标签：ruby-on-rails, ruby-on-rails-3, sqlite

我正在使用代码：

```
<h2>
<% random_bullets = Bullet.all %>
<ul>
  <% random_bullets.shuffle.first(4).each do |r| %>
<br>
    <li><%= db.save(r.content) %></li>
  <% end %>
</ul>
</h2> 
```

从我的数据库中随机抽取四个项目符号并将它们发布到一个页面；我想要做的是让他们保存项目符号，以便它们仅在生成页面后随机化。我可以对这段代码做些什么来实现这一点吗？如果没有，我该怎么做才能做到这一点。代码在嵌入式 Ruby 中，db 是一个 sqlite3 数据库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T22:06:01.020

设置随机子弹和随机化属于您的控制器。在那里，我建议按顺序设置一个包含 bullet.ids 数组的 cookie。然后，如果它存在，您可以迭代数组，否则创建一个新数组并保存它。

在您的控制器中：

```
if cookies[:bullets].nil?
  @bullets = Bullet.all.shuffle.first(4)
  cookies[:bullets] = @bullets.collect(&:id)
else
  @bullets = []
  cookies[:bullets].each do |id|
    @bullets << Bullet.find(id)
  end
end 
```

在你看来：

```
<ul>
  <% @bullets.each do |r| %>
    <li><%= r.content %></li>
  <% end %>
</ul> 
```

您是否知道将 a 放入`<ul>`a`<h2>`或将 a放入`<br>`a是无效的 html `<ul>`？

# visual-studio-2010 - 如何在查找/替换操作的替换部分中包含通配符匹配？

> ID：11253480
> 
> 赞同：1
> 
> 时间：2012-06-28T21:54:11.337
> 
> 标签：visual-studio-2010

我正在使用 Visual Studio 2010 中的“查找和替换”对话框。获取与查找条件匹配的结果没有问题。问题是，查找/替换操作结束后的结果是字符串中的*。Visual Studio 将星号视为文字字符并在结果中放置 *。不是我需要的，也不是那么有用。

我将其用于查找条件：

```
@Html.TextBoxFor(*) 
```

我将其用于替换条件：

```
@Html.TextBoxFor(*, new { @class = "className" }) 
```

如果这是我的起始字符串，

```
@Html.TextBoxFor( x => x.price) 
```

我希望结果是

```
@Html.TextBoxFor( x => x.price, new { @class = "className" }) 
```

不是这个

```
@Html.TextBoxFor(*, new { @class = "className" }) 
```

如何使用通配符 (*) 执行查找，但不使用文字 * 替换匹配？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T22:22:11.650

选择“使用正则表达式”。

寻找`\@Html\.TextBoxFor\({.*}\)`

用。。。来代替`@Html.TextBoxFor(\1, new { @class = "className" })`

# javascript - 有没有办法让电子邮件中的按钮远程发送数据？

> ID：11253483
> 
> 赞同：0
> 
> 时间：2012-06-28T21:54:33.943
> 
> 标签：javascript, html, forms, email, button

所以我有这个隐藏的表格和这个“我喜欢这个”按钮，我想将它们插入到我发送的电子邮件中。

```
<form method="post" action="http://someWebsite.com/he_likes_it">
    <input type="hidden" name="who_liked" value="heLikedIt@something.com" />
    <input type="submit" value="I Like This" />
</form> 
```

我可以将按钮插入到我的电子邮件中。因此，每当电子邮件收件人单击其电子邮件中的按钮时，带有表单数据的 POST 请求就会发送到我的服务器，让我知道谁喜欢我的电子邮件。但是，单击该按钮也会打开链接（新的浏览器窗口/选项卡等），将用户引导至我的网站。如何防止单击按钮打开链接，而仅将表单中的数据发送到我的服务器？

我希望like按钮不显眼。我不希望通过打开一个新标签来打扰电子邮件收件人。我知道使用 javascript 是可能的，但是，我很确定大多数电子邮件服务提供商都应该在电子邮件中转义 javascript。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T22:08:14.960

对于初学者来说，完全忘记javascript——它不会发生。没有电子邮件客户端会允许 JS 通过，这太冒险了。

至于表单方法，暂且不说邮件客户端是否允许通过，如果页面立即自行关闭（见下面的片段），**一些**操作系统、浏览器和邮件客户端可能会配合，将焦点“交给”邮件客户端（这就是您所追求的——用户被“带回原来的位置”）。但是，无法保证客户端操作系统、浏览器和电子邮件客户端将如何反应。

此外，有些人使用非 HTML 客户端，而有些客户端（如 Outlook）可能会完全禁止这样做。从安全的角度来看，这具有被利用的潜力，因此即使*您*所做的不是利用，整个实践也具有这种潜力，因此可能会被阻止。

非 HTML 电子邮件客户端可能会将您的 HTML 转储为文本，因此在这种情况下看起来会很糟糕。

要立即关闭窗口，您可以尝试：

```
<script type="text/javascript">window.close();</script> 
```

因此，页面`http://someWebsite.com/he_likes_it`仅包含此作为输出（在完成任何需要完成的服务器端工作之后）。根据浏览器、其他选项卡是否打开以及其他一些因素，窗口*可能会*毫无问题地关闭。**可能**是有效的词！然后用户**可能**会被带回电子邮件客户端。没有办法编写脚本，也没有办法控制它。

作为替代方案，我建议您做一些不太容易出现问题的事情，以及电子邮件客户端、操作系统和浏览器的变幻莫测……这远不那么“偷偷摸摸”——不要向用户隐瞒您正在做的事情。而不是表格，只需在您的电子邮件中包含一个链接：

```
Like this email? Let us know: <a href="http://www.mysiteurl.com/he_liked_it/UNIQUE_IDENTIFIER">http://www.mysiteurl.com/he_liked_it/UNIQUE_IDENTIFIER</a> 
```

唯一标识符可以是电子邮件（无论如何，这就是您在表单中所做的事情），或者是链接到用户的某种令牌。无论哪种情况，您都可以在页面上添加一些文本以感谢用户的反馈：

> 谢谢！我们很高兴您喜欢这封电子邮件。您可以关闭此窗口，或 [单击此处](http://www.mysiteurl.com/)转到主页。

这是跨浏览器、跨操作系统的，适用于任何支持 HTML 的电子邮件客户端。对于纯文本客户端，他们将能够将 URL 复制粘贴到他们的浏览器中，而不会看到大量的标记混乱。您的用户会欣赏您的透明度、您表达的感激之情，并且您不会向他们发送引发其电子邮件客户端安全警告的电子邮件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T22:10:10.727

您的解决方案将不起作用，因为大多数（如果不是全部）电子邮件客户端将完全删除您电子邮件中的任何脚本标签 - 因此您的所有 javascript 都将消失。此外，您的表单帖子肯定不起作用。

可以做到这一点的唯一方法（以及所有公司采用的方法）是在您的电子邮件中添加一个链接，单击该链接时，会将用户带到您网站上的页面：

```
<a href="http://YOUR-SITE.com/like">I Like This</a> 
```

当然，服务器随后将能够记录对该页面的请求，因此您可以执行您需要的任何逻辑。

# firefox - 内容类型 HTTP application/octet-stream 在 MVC3 中使用 JPlayer 的 FireFox 不支持

> ID：11253484
> 
> 赞同：3
> 
> 时间：2012-06-28T21:54:41.103
> 
> 标签：firefox, mime-types, content-type, jplayer

我在使用 Firefox 和 JPlayer 时遇到问题（我认为在 IE9 中存在同样的问题）：每当我尝试在 Firefox 中播放视频时，我都会在控制台中收到以下错误，并且视频无法播放：

不支持“application/octet-stream”的“Content-Type”HTTP。

![在此处输入图像描述](../Images/02e8e7ddac6651891be5f49a3ebce901.png)

好吧，翻译一下，这意味着不支持“app/octet-stream”的“Content-Type”HTTP。加载媒体资源“名称”失败。

不过它在 Chrome 中运行良好。根据我的研究，Firefox 似乎在 mime 类型方面存在一些问题，并且不会加载任何包含八位字节流的内容。但是，我还没有找到解决这个问题的方法。我读到我必须在 IIS 配置中声明 mime 类型。但我不知道如何使它在调试时工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T17:16:27.643

好吧，我的问题在 Firefox 上解决了，显然我只需要提供 mv4 类型而不是基本的 mv4、ogv 和 webmv。

```
 new jPlayerPlaylist({
                        jPlayer: "#jquery_jplayer_2",
                        cssSelectorAncestor: "#jp_container_2"}, 
                        messageVideos , 
                       {
                        swfPath: '@Url.Content("~/Scripts/Jplayer.swf")',
                         supplied: "m4v"(used to pass "mv4", "ogv", "webmv")}); 
```

# .net - 解析加密 Byte() 时出现 Encoding.Unicode.GetString 错误

> ID：11253485
> 
> 赞同：0
> 
> 时间：2012-06-28T21:54:42.680
> 
> 标签：.net, xml, vb.net, encryption, aes

一直在尝试将 xml 文件加密为字符串，以便我可以通过服务传输它。使用编译到代码中的对称密钥从服务器到服务器的传输。

我一直在使用[MSDN](http://msdn.microsoft.com/en-us/library/system.security.cryptography.aesmanaged.aspx)中的 AES 示例，然后将字节数组转换为字符串，如下所示：

```
 ' Encrypt the string to an array of bytes.
    Dim encrypted As Byte() = crypto.EncryptString(original, _key, _iv)

    Dim encrypStr As String = Encoding.Unicode.GetString(encrypted)
    '''' >>> Transmit...
    Dim postTrans As Byte() = Encoding.Unicode.GetBytes(encrypStr)

    ' Decrypt the bytes to a string.
    Dim roundtrip As String = crypto.DecryptString(postTrans, _key, _iv) 
```

如果没有中间两行，加密/解密工作正常，包括中间两行，我要么收到格式错误的无法解析的 xml 文档，要么收到“填充无效且无法删除”错误。

这不是字符串加密的好方法吗？它可以完美地工作，无需将 byte() 转换为字符串广告。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T10:31:01.327

不要使用 Encoding.GetString()，不会总是有效。使用 ToBase64()

感谢 Henk Holterman 的回答。

# ruby - 简单的红宝石守卫观察者

> ID：11253489
> 
> 赞同：6
> 
> 时间：2012-06-28T21:55:06.110
> 
> 标签：ruby, gem, guard

有没有办法制作一个简单的守卫手表？我想在特定目录中的文件更改时运行 rake 任务，并且完成所有这些步骤对于这个一次性任务来说太多了。 [https://github.com/guard/guard/wiki/Create-a-guard](https://github.com/guard/guard/wiki/Create-a-guard)

我尝试在 Guardfile 中添加它，但它不起作用。

```
guard :doc do
  watch(%r{^documentation})                       { "rake doc:build" }
end

watch("/documentation")                       { "rake doc:build" } 
```

那么您知道在使用[guard](https://github.com/guard/guard/)更新文件时运行 rake 任务的简单方法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-28T22:16:18.697

最直接的方法是使用[guard-rake](https://github.com/rubyist/guard-rake)对文件修改运行Rake 任务。

更通用的解决方案是使用[guard-shell](https://github.com/hawx/guard-shell)对文件修改运行任何命令行工具。

更复杂的用例应该通过[创建自己的保护插件](https://github.com/guard/guard/wiki/Create-a-guard)来解决。您甚至不需要创建 gem，因为您可以简单地将它们定义为内联保护，正如 Avdi 在他[的 Guardfile for Redis](http://devblog.avdi.org/2011/06/15/a-guardfile-for-redis/)博客文章中向我们展示的那样。

当您想分享您的 Guard 时，只需查看更高级的 Guard 插件，例如[guard-rspec](https://github.com/guard/guard-rspec/)或[guard-jasmine](https://github.com/netzpirat/guard-jasmine)。

# python - numpy：将argsort应用于数组

> ID：11253495
> 
> 赞同：7
> 
> 时间：2012-06-28T21:55:41.023
> 
> 标签：python, arrays, numpy

该[`argsort()`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.argsort.html#numpy.argsort)函数返回一个索引矩阵，可用于索引原始数组，以便结果与结果匹配`sort()`。

有没有办法应用这些索引？我有两个数组，一个是用于获取排序顺序的数组，另一个是一些关联数据。

我想计算`assoc_data[array1.argsort()]`，但这似乎不起作用。

这是一个例子：

```
z=array([1,2,3,4,5,6,7])
z2=array([z,z*z-7])
i=z2.argsort() 
```

* * *

```
z2=array([[ 1,  2,  3,  4,  5,  6,  7],
          [-6, -3,  2,  9, 18, 29, 42]])
i =array([[1, 1, 1, 0, 0, 0, 0],
          [0, 0, 0, 1, 1, 1, 1]]) 
```

我想将 i 应用于 z2 （或具有关联数据的另一个数组），但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-28T22:42:49.483

这可能是矫枉过正，但这将适用于 nd 情况：

```
import numpy as np
axis = 0
index = list(np.ix_(*[np.arange(i) for i in z2.shape]))
index[axis] = z2.argsort(axis)
z2[index]

# Or if you only need the 3d case you can use np.ogrid.

axis = 0
index = np.ogrid[:z2.shape[0], :z2.shape[1], :z2.shape[2]]
index[axis] = z2.argsort(axis)
z2[index] 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-28T23:56:52.930

你很幸运，我刚刚获得了 numpyology 的硕士学位。

```
>>> def apply_argsort(a, axis=-1):
...     i = list(np.ogrid[[slice(x) for x in a.shape]])
...     i[axis] = a.argsort(axis)
...     return a[i]
... 
>>> a = np.array([[1,2,3,4,5,6,7],[-6,-3,2,9,18,29,42]])
>>> apply_argsort(a,0)
array([[-6, -3,  2,  4,  5,  6,  7],
       [ 1,  2,  3,  9, 18, 29, 42]]) 
```

有关发生了什么的解释，请参阅我对[这个问题](https://stackoverflow.com/questions/10921893/numpy-sorting-a-multidimensional-array-by-a-multidimensional-array/10922358#10922358)的回答。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-02-19T14:06:39.320

采用`np.take_along_axis`

```
np.take_along_axis(z2, i, axis=1)
Out[31]: 
array([[ 1,  2,  3,  4,  5,  6,  7],
       [-6, -3,  2,  9, 18, 29, 42]]) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-28T22:04:30.977

啊哈，想通了。

```
In [274]: z2[i,range(z2.shape[1])]
Out[274]:
array([[-6, -3,  2,  4,  5,  6,  7],
       [ 1,  2,  3,  9, 18, 29, 42]]) 
```

# xslt - 如何使用 XSLT 附加 XML 属性

> ID：11253502
> 
> 赞同：3
> 
> 时间：2012-06-28T21:56:16.637
> 
> 标签：xslt

如果我有一个如下所示的 XML：

```
<Component Id="cmp25217AE65B163B199EDDA7F29198730A" Guid="{DEB29383-8BF1-4FD0-830B-DF8639F4069A}">
<Component Id="cmp93E1B1FFA5A62A43251E23BD65FBAA66" Guid="{76E8B8CE-835D-498E-9330-CE940C9510BF}">
<Component Id="cmp3D7B898C57056B0E87C3A964112BB9D6" Guid="{3BA9A892-C44F-4B2E-B0B9-B732120D35DB}"> 
```

我如何使用 XSLT 将 'Win64="yes"' 附加到每个元素的末尾，如下所示：

```
<Component Id="cmp25217AE65B163B199EDDA7F29198730A" Guid="{DEB29383-8BF1-4FD0-830B-DF8639F4069A}" Win64="yes">
<Component Id="cmp93E1B1FFA5A62A43251E23BD65FBAA66" Guid="{76E8B8CE-835D-498E-9330-CE940C9510BF}" Win64="yes">
<Component Id="cmp3D7B898C57056B0E87C3A964112BB9D6" Guid="{3BA9A892-C44F-4B2E-B0B9-B732120D35DB}" Win64="yes"> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T22:06:56.200

您可以使用该`<xsl:attribute>`元素并将其直接应用于（内部）`<xsl:copy>`元素：

```
<xsl:template match="Component">
    <xsl:copy>
        <xsl:attribute name="Win64">yes</xsl:attribute>
        <xsl:apply-templates select="node()|@*"/>
    </xsl:copy>
</xsl:template> 
```

**更新：**嵌入在 XSLT 中，否则会复制 Xml 内容，如下所示：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="xml" indent="yes"/>

    <xsl:template match="node()|@*">
        <xsl:copy>
            <xsl:apply-templates select="node()|@*"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="Component">
        <xsl:copy>
            <xsl:attribute name="Win64">yes</xsl:attribute>
            <xsl:apply-templates select="node()|@*"/>
        </xsl:copy>
    </xsl:template>

</xsl:stylesheet> 
```

**更新 2：**这假设您只想添加`Win64="yes"`到`<Component>`元素。如果不是这种情况，则必须`match`在插入附加属性的模板中调整属性的 XPath 表达式。

**更新 3：**格式良好的输入和输出文档：

我假设这是输入文档：

```
<?xml version="1.0" encoding="UTF-8"?>
<xml>
    <Component Id="cmp25217AE65B163B199EDDA7F29198730A" Guid="{DEB29383-8BF1-4FD0-830B-DF8639F4069A}"/>
    <Component Id="cmp93E1B1FFA5A62A43251E23BD65FBAA66" Guid="{76E8B8CE-835D-498E-9330-CE940C9510BF}"/>
    <Component Id="cmp3D7B898C57056B0E87C3A964112BB9D6" Guid="{3BA9A892-C44F-4B2E-B0B9-B732120D35DB}"/>
</xml> 
```

然后，上述 XSLT 的输出如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<xml>
  <Component Win64="yes" Id="cmp25217AE65B163B199EDDA7F29198730A" Guid="{DEB29383-8BF1-4FD0-830B-DF8639F4069A}" />
  <Component Win64="yes" Id="cmp93E1B1FFA5A62A43251E23BD65FBAA66" Guid="{76E8B8CE-835D-498E-9330-CE940C9510BF}" />
  <Component Win64="yes" Id="cmp3D7B898C57056B0E87C3A964112BB9D6" Guid="{3BA9A892-C44F-4B2E-B0B9-B732120D35DB}" />
</xml> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T23:29:25.320

此样式表将按照您的要求将属性添加到所有元素。请注意，属性的位置可能不在末尾，但这无关紧要。

**XML 输入**（格式正确）

```
<doc>
    <Component Id="cmp25217AE65B163B199EDDA7F29198730A" Guid="{DEB29383-8BF1-4FD0-830B-DF8639F4069A}"/>
    <Component Id="cmp93E1B1FFA5A62A43251E23BD65FBAA66" Guid="{76E8B8CE-835D-498E-9330-CE940C9510BF}"/>
    <Component Id="cmp3D7B898C57056B0E87C3A964112BB9D6" Guid="{3BA9A892-C44F-4B2E-B0B9-B732120D35DB}"/>
</doc> 
```

**XSLT 1.0**（用 Xalan 和 Saxon 6.5.5 测试）

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output indent="yes"/>
    <xsl:strip-space elements="*"/>

    <xsl:template match="text()|comment()|processing-instruction()|@*">
        <xsl:copy>
            <xsl:apply-templates select="node()|@*"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="*">
        <xsl:copy>
            <xsl:attribute name="Win64">yes</xsl:attribute>
            <xsl:apply-templates select="node()|@*"/>
        </xsl:copy>     
    </xsl:template>

</xsl:stylesheet> 
```

**输出**

```
<doc Win64="yes">
   <Component Win64="yes" Id="cmp25217AE65B163B199EDDA7F29198730A" Guid="{DEB29383-8BF1-4FD0-830B-DF8639F4069A}"/>
   <Component Win64="yes" Id="cmp93E1B1FFA5A62A43251E23BD65FBAA66" Guid="{76E8B8CE-835D-498E-9330-CE940C9510BF}"/>
   <Component Win64="yes" Id="cmp3D7B898C57056B0E87C3A964112BB9D6" Guid="{3BA9A892-C44F-4B2E-B0B9-B732120D35DB}"/>
</doc> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-28T22:12:50.833

不幸的是，您不能使用`<xsl:copy>`和添加更多属性。我是这样做的：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"     xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:fn="http://www.w3.org/2005/xpath-functions">
    <xsl:output method="xml" version="1.0" encoding="UTF-8" indent="yes"/>
    <xsl:template match="/root">
        <xsl:apply-templates/>
    </xsl:template>
    <xsl:template match="Component">
            <xsl:element name="Component">
                <xsl:attribute name="Id" select="@Id"/>
                <xsl:attribute name="Guid" select="@Guid"/>
                <xsl:attribute name="Win64" select="'yes'"/>
            </xsl:element>
    </xsl:template>
</xsl:stylesheet> 
```

# excel - VBA减去日期和时间

> ID：11253506
> 
> 赞同：4
> 
> 时间：2012-06-28T21:56:41.640
> 
> 标签：excel, vba, date

```
Dim dtmStart As Date, dtmEnd As Date, dblDuration As Double
dtmStart = "1900/01/01 08:10:00"
dtmEnd = "1900/01/03 21:16:00"
dblDuration = DateDiff("hh:mm", dtmEnd, dtmStart)
'dblDuration = dtmEnd - dtmStart
MsgBox Format(dblDuration, "hh:mm") 
```

如何以“yyyy/mm/dd hh:mm:ss”格式减去两个日期？我尝试了上述两种方法，但都不起作用

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-28T22:08:55.950

```
Sub Test()
    Dim dtmStart As Date, dtmEnd As Date, dblDuration As Double
    dtmStart = "1900/01/01 08:10:00"
    dtmEnd = "1900/01/03 21:16:00"
    dblDuration = dtmEnd - dtmStart
    MsgBox Application.Text(dblDuration, "[hh]:mm")
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-29T23:31:45.300

好吧，我是一个简单的丹麦人，我喜欢简单，所以我就这样做了：

```
Dim dtmStart As Date, dtmEnd As Date, dblDuration As Date

Start:  'STARTTIME
        dtmStart = Time

Slut:           
        'SLUTTIDEN
        dtmEnd = Time
        dblDuration = dtmEnd - dtmStart
        Debug.Print "Modul 1 Slut  " & Time; " Run = "; dblDuration 
```

# c# - 在 Asp.net 中检索对象列表

> ID：11253508
> 
> 赞同：2
> 
> 时间：2012-06-28T21:56:59.707
> 
> 标签：c#, asp.net, visual-studio-2010

我在我的 deafault.aspx.cs 页面中有一个作为变量创建的类对象列表

```
List<BoldGauge> boldGauges = new List<BoldGauge>(); 
```

我在 nessacary 函数中创建对象，然后将新创建的对象添加到列表中，以便稍后根据需要检索它。

当我稍后尝试遍历对象时，boldGagues 计数 = 0。我假设我需要将列表添加到会话变量或会话状态。

有谁知道最好的方法？多个列表中可能有许多不同类型的控件，因此，如果有人可以推荐一种成本最低且高效的方法，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T22:06:32.207

要在回发中保留列表，您需要将列表存储在某处。

您可以将其存储在 中`Session`，但更适用的地方可能是 ViewState。

```
ViewState.Add("GaugesList", boldGauges); 
```

然后稍后取回

```
List<BoldGauges> boldGauges = ViewState["GaugesList"]; 
```

请注意，这仅限于页面，因此如果您需要跨页面的列表，请使用`Session`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T22:09:02.637

```
foreach(var boldGaug in boldGauges)
{
    //do something..
} 
```

# android - 更改开关的“开启”颜色

> ID：11253512
> 
> 赞同：209
> 
> 时间：2012-06-28T21:57:21.243
> 
> 标签：android, togglebutton

我在 ICS 应用程序中使用带有 holo.light 主题的标准 Switch 控件。

我想将切换按钮的突出显示或开启状态颜色从标准的浅蓝色更改为绿色。

这应该很容易，但我似乎无法弄清楚如何去做。

* * *

## 回答 #1

> 赞同：315
> 
> 时间：2016-07-09T05:01:05.360

派对迟到了，但我就是这样做的

**风格**

```
 <style name="SCBSwitch" parent="Theme.AppCompat.Light">
        <!-- active thumb & track color (30% transparency) -->
        <item name="colorControlActivated">#46bdbf</item>

        <!-- inactive thumb color -->
        <item name="colorSwitchThumbNormal">#f1f1f1
        </item>

        <!-- inactive track color (30% transparency) -->
        <item name="android:colorForeground">#42221f1f
        </item>
    </style> 
```

**颜色**

[![在此处输入图像描述](../Images/fa00c59b67832cdbddc6852081ee319d.png)](https://i.stack.imgur.com/xzxmd.png)

**布局**

```
<android.support.v7.widget.SwitchCompat
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentRight="true"
    android:checked="false"
    android:theme="@style/SCBSwitch" /> 
```

**结果**

查看启用和禁用开关的颜色变化

[![在此处输入图像描述](../Images/6a1101e71480f3d7a2e2b4e2a6e3a146.png)](https://i.stack.imgur.com/5CZqs.png)

* * *

## 回答 #2

> 赞同：124
> 
> 时间：2014-11-03T10:41:26.633

到目前为止，最好使用 AppCompat.v7 库中的 SwitchCompat。然后，您可以使用简单的样式来更改组件的颜色。

```
values/themes.xml:

<style name="Theme.MyTheme" parent="Theme.AppCompat.Light">
    <!-- colorPrimary is used for the default action bar background -->
    <item name="colorPrimary">@color/my_awesome_color</item>

    <!-- colorPrimaryDark is used for the status bar -->
    <item name="colorPrimaryDark">@color/my_awesome_darker_color</item>

    <!-- colorAccent is used as the default value for colorControlActivated,
         which is used to tint widgets -->
    <item name="colorAccent">@color/accent</item>

    <!-- You can also set colorControlNormal, colorControlActivated
         colorControlHighlight, and colorSwitchThumbNormal. -->

</style> 
```

参考：[Android 开发者博客](http://android-developers.blogspot.be/2014/10/appcompat-v21-material-design-for-pre.html)

**编辑**：

它应该被正确应用的方式是通过`android:theme="@style/Theme.MyTheme"` ，这也可以应用于父样式，例如 EditTexts、RadioButtons、Switches、CheckBoxes 和 ProgressBars：

```
<style name="My.Widget.ProgressBar" parent="Widget.AppCompat.ProgressBar">

<style name="My.Widget.Checkbox" parent="Widget.AppCompat.CompoundButton.CheckBox"> 
```

* * *

## 回答 #3

> 赞同：52
> 
> 时间：2014-09-03T02:56:50.323

这对我有用（需要 Android 4.1）：

```
Switch switchInput = new Switch(this);
int colorOn = 0xFF323E46;
int colorOff = 0xFF666666;
int colorDisabled = 0xFF333333;
StateListDrawable thumbStates = new StateListDrawable();
thumbStates.addState(new int[]{android.R.attr.state_checked}, new ColorDrawable(colorOn));
thumbStates.addState(new int[]{-android.R.attr.state_enabled}, new ColorDrawable(colorDisabled));
thumbStates.addState(new int[]{}, new ColorDrawable(colorOff)); // this one has to come last
switchInput.setThumbDrawable(thumbStates); 
```

请注意，需要最后添加“默认”状态，如此处所示。

我看到的唯一问题是开关的“拇指”现在看起来比开关的背景或“轨道”大。我认为那是因为我仍在使用默认的轨道图像，它周围有一些空白空间。但是，当我尝试使用这种技术自定义轨道图像时，我的开关似乎有 1 个像素的高度，只出现了一小段开/关文本。必须有解决方案，但我还没有找到它......

**安卓 5 更新**

在 Android 5 中，上面的代码使开关完全消失。我们应该可以使用新的[setButtonTintList](http://developer.android.com/reference/android/widget/CompoundButton.html#setButtonTintList(android.content.res.ColorStateList))方法，但是这似乎被开关忽略了。但这有效：

```
ColorStateList buttonStates = new ColorStateList(
        new int[][]{
                new int[]{-android.R.attr.state_enabled},
                new int[]{android.R.attr.state_checked},
                new int[]{}
        },
        new int[]{
                Color.BLUE,
                Color.RED,
                Color.GREEN
        }
);
switchInput.getThumbDrawable().setTintList(buttonStates);
switchInput.getTrackDrawable().setTintList(buttonStates); 
```

**适用于 Android 6-7 的更新**

正如 Cheruby 在评论中所说，我们可以使用新的`setThumbTintList`并且对我来说按预期工作。我们也可以使用`setTrackTintList`, 但这会将颜色作为混合应用，结果在深色主题中比预期的要暗，在浅色主题中比预期的要亮，有时甚至到了不可见的程度。在 Android 7 中，我可以通过覆盖 track [tint mode](https://developer.android.com/reference/android/graphics/PorterDuff.Mode.html)来最小化这种变化，但在 Android 6 中我无法获得不错的结果。您可能需要定义额外的颜色来补偿混合。（你有没有觉得 Google 不希望我们自定义应用程序的外观？）

```
ColorStateList thumbStates = new ColorStateList(
        new int[][]{
                new int[]{-android.R.attr.state_enabled},
                new int[]{android.R.attr.state_checked},
                new int[]{}
        },
        new int[]{
                Color.BLUE,
                Color.RED,
                Color.GREEN
        }
);
switchInput.setThumbTintList(thumbStates);
if (Build.VERSION.SDK_INT >= 24) {
    ColorStateList trackStates = new ColorStateList(
            new int[][]{
                    new int[]{-android.R.attr.state_enabled},
                    new int[]{}
            },
            new int[]{
                    Color.GRAY,
                    Color.LTGRAY
            }
    );
    switchInput.setTrackTintList(trackStates);
    switchInput.setTrackTintMode(PorterDuff.Mode.OVERLAY);
} 
```

* * *

## 回答 #4

> 赞同：48
> 
> 时间：2016-09-14T08:45:44.183

要在不使用 style.xml 或 Java 代码的情况下更改 Switch 样式，您可以将 switch 自定义为布局 XML：

```
<Switch
        android:id="@+id/checkbox"
        android:layout_width="wrap_content"
        android:thumbTint="@color/blue"
        android:trackTint="@color/white"
        android:checked="true"
        android:layout_height="wrap_content" /> 
```

属性**android:thumbTint**和**android:trackTint**允许您自定义颜色

这是此 XML 的视觉结果：

[![在此处输入图像描述](../Images/815426d83ca1c4575c4efb05a6035128.png)](https://i.stack.imgur.com/jslTJ.png)

* * *

## 回答 #5

> 赞同：44
> 
> 时间：2020-06-05T07:06:25.300

作为现有答案的补充：您可以使用`res/color`文件夹中的选择器自定义拇指和轨道，例如：

**switch_track_selector**

```
<?xml version="1.0" encoding="utf-8"?>
<selector
    xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:color="@color/lightBlue"
        android:state_checked="true" />
    <item android:color="@color/grey"/>
</selector> 
```

**switch_thumb_selector**

```
<selector
    xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:color="@color/darkBlue"
        android:state_checked="true" />
    <item android:color="@color/white"/>
</selector> 
```

使用这些选择器自定义轨道和拇指色调：

```
<androidx.appcompat.widget.SwitchCompat
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    app:trackTint="@color/switch_track_selector"
    app:thumbTint="@color/switch_thumb_selector"/> 
```

请记住，如果您对这些属性使用标准`Switch`和`android`命名空间，它仅适用于 API 23 及更高版本，因此请使用`SwitchCompat`命名`app`空间`xmlns:app="http://schemas.android.com/apk/res-auto"`作为通用解决方案。

结果：

[![在此处输入图像描述](../Images/643292812740db64b2fc40dc2163027c.png)](https://i.stack.imgur.com/cyZaf.png)

* * *

## 回答 #6

> 赞同：37
> 
> 时间：2015-07-15T18:06:57.220

创建一个自定义 Switch 并覆盖 setChecked 以更改颜色：

```
 public class SwitchPlus extends Switch {

    public SwitchPlus(Context context) {
        super(context);
    }

    public SwitchPlus(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    public SwitchPlus(Context context, AttributeSet attrs, int defStyleAttr) {
        super(context, attrs, defStyleAttr);
    }

    @Override
    public void setChecked(boolean checked) {
        super.setChecked(checked);
        changeColor(checked);
    }

    private void changeColor(boolean isChecked) {
        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.JELLY_BEAN) {
            int thumbColor;
            int trackColor;

            if(isChecked) {
                thumbColor = Color.argb(255, 253, 153, 0);
                trackColor = thumbColor;
            } else {
                thumbColor = Color.argb(255, 236, 236, 236);
                trackColor = Color.argb(255, 0, 0, 0);
            }

            try {
                getThumbDrawable().setColorFilter(thumbColor, PorterDuff.Mode.MULTIPLY);
                getTrackDrawable().setColorFilter(trackColor, PorterDuff.Mode.MULTIPLY);
            }
            catch (NullPointerException e) {
                e.printStackTrace();
            }
        }
    }
} 
```

* * *

## 回答 #7

> 赞同：34
> 
> 时间：2019-03-20T16:30:08.943

```
<androidx.appcompat.widget.SwitchCompat
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                app:thumbTint="@color/white"
                app:trackTint="@drawable/checker_track"/> 
```

在 checker_track.xml 里面：

```
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:color="@color/lightish_blue" android:state_checked="true"/>
    <item android:color="@color/hint" android:state_checked="false"/>
</selector> 
```

* * *

## 回答 #8

> 赞同：32
> 
> 时间：2019-10-13T09:46:17.577

制作可绘制的“newthumb.xml”

```
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:color="@color/Green" android:state_checked="true"/>
    <item android:color="@color/Red" android:state_checked="false"/>
</selector> 
```

并使可绘制的“newtrack.xml”

```
<selector xmlns:android="http://schemas.android.com/apk/res/android">
        <item android:color="@color/black" android:state_checked="true"/>
        <item android:color="@color/white" android:state_checked="false"/>
    </selector> 
```

并将其添加到 Switch ：

```
<Switch
        android:trackTint="@drawable/newtrack"
        android:thumbTint="@drawable/newthumb"
         /> 
```

此外，只制作一个可绘制文件（“switchcolors.xml”）并将其用于 trackTint 和 thumbTint 也是完全可以的。

* * *

## 回答 #9

> 赞同：30
> 
> 时间：2016-05-25T16:02:01.420

虽然 SubChord 的回答是正确的，但并没有真正回答如何在不影响其他小部件的情况下设置“开启”颜色的问题。为此，请`ThemeOverlay`在 styles.xml 中使用：

```
<style name="ToggleSwitchTheme" parent="ThemeOverlay.AppCompat.Light">
    <item name="colorAccent">@color/green_bright</item>
</style> 
```

并在您的交换机中引用它：

```
<android.support.v7.widget.SwitchCompat
  android:theme="@style/ToggleSwitchTheme" ... /> 
```

这样做只会影响您要应用它的视图的颜色。

* * *

## 回答 #10

> 赞同：20
> 
> 时间：2015-08-11T18:42:47.020

当开关状态发生变化时，我通过更新滤色器解决了这个问题......

```
public void bind(DetailItem item) {
    switchColor(item.toggle);
    listSwitch.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {
        @Override
        public void onCheckedChanged(CompoundButton compoundButton, boolean b) {
                switchColor(b);
        }
    });
}

private void switchColor(boolean checked) {
    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.JELLY_BEAN) {
        listSwitch.getThumbDrawable().setColorFilter(checked ? Color.BLACK : Color.WHITE, PorterDuff.Mode.MULTIPLY);
        listSwitch.getTrackDrawable().setColorFilter(!checked ? Color.BLACK : Color.WHITE, PorterDuff.Mode.MULTIPLY);
    }
} 
```

* * *

## 回答 #11

> 赞同：13
> 
> 时间：2013-07-03T22:45:49.543

可能有点晚了，但是对于开关按钮，toogle按钮不是答案，您必须更改开关的xml参数中的drawable：

```
 android:thumb="your drawable here" 
```

* * *

## 回答 #12

> 赞同：9
> 
> 时间：2016-01-28T10:24:56.840

在 Android Lollipop 及更高版本中，在您的主题样式中定义它：

```
<style name="BaseAppTheme" parent="Material.Theme">
    ...
    <item name="android:colorControlActivated">@color/color_switch</item>
</style> 
```

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2012-06-28T22:09:26.023

创建您自己的 9-patch 图像并将其设置为切换按钮的背景。

[http://radleymarx.com/2011/simple-guide-to-9-patch/](http://radleymarx.com/2011/simple-guide-to-9-patch/)

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2015-02-25T17:36:06.180

arlomedia 建议的解决方案对我有用。关于他的额外空间问题，我解决了删除所有填充到开关的问题。

编辑

根据要求，这是我所拥有的。

在布局文件中，我的开关位于线性布局内和 TextView 之后。

```
<LinearLayout
        android:id="@+id/myLinearLayout"
        android:orientation="horizontal"
        android:layout_width="match_parent"
        android:layout_height="50dp"
        android:layout_alignParentTop="true"
        android:layout_centerHorizontal="true"
        android:layout_gravity="center_horizontal|center"
        android:gravity="right"
        android:padding="10dp"
        android:layout_marginTop="0dp"
        android:background="@drawable/bkg_myLinearLayout"
        android:layout_marginBottom="0dp">
        <TextView
            android:id="@+id/myTextForTheSwitch"
            android:layout_height="wrap_content"
            android:text="@string/TextForTheSwitch"
            android:textSize="18sp"
            android:layout_centerHorizontal="true"
            android:layout_gravity="center_horizontal|center"
            android:gravity="right"
            android:layout_width="wrap_content"
            android:paddingRight="20dp"
            android:textColor="@color/text_white" />
        <Switch
            android:id="@+id/mySwitch"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:textOn="@string/On"
            android:textOff="@string/Off"
            android:layout_centerHorizontal="true"
            android:layout_gravity="center_horizontal"
            android:layout_toRightOf="@id/myTextForTheSwitch"
            android:layout_alignBaseline="@id/myTextForTheSwitch"
            android:gravity="right" />
    </LinearLayout> 
```

由于我正在使用 Xamarin / Monodroid（最低 Android 4.1），我的代码是：

```
Android.Graphics.Color colorOn = Android.Graphics.Color.Green;
Android.Graphics.Color colorOff = Android.Graphics.Color.Gray;
Android.Graphics.Color colorDisabled = Android.Graphics.Color.Green;

StateListDrawable drawable = new StateListDrawable();
drawable.AddState(new int[] { Android.Resource.Attribute.StateChecked }, new ColorDrawable(colorOn));
drawable.AddState(new int[] { -Android.Resource.Attribute.StateEnabled }, new ColorDrawable(colorDisabled));
drawable.AddState(new int[] { }, new ColorDrawable(colorOff));

swtch_EnableEdit.ThumbDrawable = drawable; 
```

swtch_EnableEdit 以前是这样定义的（Xamarin）：

```
Switch swtch_EnableEdit = view.FindViewById<Switch>(Resource.Id.mySwitch); 
```

我没有设置所有填充，也没有调用 .setPadding(0, 0, 0, 0)。

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2020-04-28T10:33:08.243

最简单的方法是定义轨道色调，并将色调模式设置为 src_over 以去除 30% 的透明度。

```
android:trackTint="@drawable/toggle_style"
android:trackTintMode="src_over" 
```

切换样式.xml

```
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:color="@color/informationDefault"
        android:state_checked="true"
        />
    <item android:color="@color/textDisabled" android:state_checked="false"/>
</selector> 
```

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2017-10-03T07:49:41.753

您可以为开关小部件制作自定义样式，在为其自定义样式时使用颜色口音作为默认设置

```
<style name="switchStyle" parent="Theme.AppCompat.Light">
    <item name="colorPrimary">@color/colorPrimary</item>
    <item name="colorPrimaryDark">@color/colorPrimaryDark</item>
    <item name="colorAccent">@color/colorPrimary</item>    <!-- set your color -->
</style> 
```

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2020-10-15T18:01:15.713

**这对我有用-：**

1.values **/styles.xml中**的代码-：

```
 <style name="SwitchTheme" parent="Theme.AppCompat.Light">
    <item name="android:colorControlActivated">#148E13</item>
</style> 
```

2.在**布局文件的****开关**中添加以下代码行-：

 **```
android:theme="@style/SwitchTheme" 
```

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2018-07-03T01:39:44.697

你可以试试这个库，很容易改变开关按钮的颜色。
[https://github.com/kyleduo/SwitchButton](https://github.com/kyleduo/SwitchButton) [![在此处输入图像描述](../Images/b48dc1dd706e24a07f71ec815bb31e1e.png)](https://i.stack.imgur.com/FWcKN.png)

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2013-07-11T10:06:20.203

尝试在这里找到正确的答案：[TextView 背景颜色上的选择器](https://stackoverflow.com/questions/3592780/selector-on-background-color-of-textview)。简而言之，您应该在 XML 中创建带有颜色的 Shape，然后在选择器中将其指定为“已选中”状态。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2015-03-10T13:07:06.217

我不知道如何从 java 中做到这一点，但是如果您为您的应用程序定义了一个样式，您可以在您的样式中添加这一行，您将拥有我使用过的所需颜色 #3F51B5

```
<color name="ascentColor">#3F51B5</color> 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2020-07-02T14:45:19.833

在 xml 中，您可以将颜色更改为：

```
 <androidx.appcompat.widget.SwitchCompat
    android:id="@+id/notificationSwitch"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:checked="true"
    app:thumbTint="@color/darkBlue"
    app:trackTint="@color/colorGrey"/> 
```

您可以动态更改为：

```
Switch.thumbDrawable.setColorFilter(ContextCompat.getColor(requireActivity(), R.color.darkBlue), PorterDuff.Mode.MULTIPLY) 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2020-08-16T07:39:35.520

基于这里的一些答案的组合，这对我有用。

```
<Switch
    android:trackTintMode="src_over"
    android:thumbTint="@color/white"
    android:trackTint="@color/shadow"
    android:checked="true"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"/> 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2022-01-29T06:08:36.617

更改轨道和拇指可绘制的色调颜色。

```
switch.getThumbDrawable().setTint(ContextCompat.getColor(this,R.color.colorAccent));

switch.getTrackDrawable().setTint(ContextCompat.getColor(this,R.color.colorAccent)); 
```

* * *

## 回答 #24

> 赞同：-2
> 
> 时间：2020-03-09T06:54:37.863

Android Studio 3.6 的解决方案：

```
yourSwitch.setTextColor(getResources().getColor(R.color.yourColor)); 
```

更改颜色 XML 文件定义值 (yourColor) 中 a 的文本颜色。**

# vb.net - 允许数字、点和退格并在文本框中删除

> ID：11253514
> 
> 赞同：3
> 
> 时间：2012-06-28T21:57:29.477
> 
> 标签：vb.net, textbox

我有以下代码：

```
Private Sub TxtPStof_KeyPress(ByVal sender As System.Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles TxtPStof.KeyPress
    e.Handled = Not (Char.IsDigit(e.KeyChar) Or e.KeyChar = ".")

End Sub 
```

只允许数字和 . 在我的文本框中，但是我还需要能够使用退格键或删除按钮删除值。

这可能吗？

谢谢！:)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-28T22:01:44.273

这是错误的做法。

普遍认为限制用户的输入对用户体验不利，并且您总是无法处理特殊情况（例如`Ctrl`+`V`呢？啊，您忘记了。每个人都这样做）。

相反，.NET 提供了用于验证用户输入的[`Validating`事件。](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.validating.aspx)您应该拦截*该*事件，*而不是*按键。允许用户随意输入文本*；*特别是，让他们不间断地犯错误（例如错误输入）——这将非常具有破坏性并且*没有*帮助。

然后，一旦它们完成（因为输入焦点离开控件），一次性进行输入验证。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-28T22:43:47.423

虽然我完全同意 Konrad Rudolph 的回答
（在 KeyPress 事件中处理用户输入真的很麻烦），
但我希望回答您的问题。

[KeyPress](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.keypress%28v=vs.100%29.aspx#Y399)文档中的 MSDN指出`The KeyPress event is not raised by noncharacter keys`. 这意味着您没有得到 Delete 键，而只有 BackSpace 键。您可以通过对事件处理程序的这个小改动来处理这种情况

```
Private Sub TxtPStof_KeyPress(ByVal sender As System.Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles TxtPStof.KeyPress 

    if e.KeyChar <> ControlChars.Back then
        e.Handled = Not (Char.IsDigit(e.KeyChar) Or e.KeyChar = ".") 
    end if

End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T05:59:39.227

```
If Char.IsLetterOrDigit(e.KeyChar) Or e.KeyChar = ControlChars.Back Or e.KeyChar = "." Then

        e.Handled = False

Else

        e.Handled = True

End If 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-20T08:18:22.153

这段代码对我来说很好。

```
 If Not ((Asc(e.KeyChar) >= 48 And Asc(e.KeyChar) <= 57) Or Asc(e.KeyChar) = 46 Or Asc(e.KeyChar) = 8 Or Asc(e.KeyChar) = 127) Then
        e.KeyChar = ""
        e.Handled = False
    End If 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-04-28T07:58:33.097

试试这个：

```
 If Asc(e.KeyChar) < 48 Or Asc(e.KeyChar) > 57 Then
        If Not (Asc(e.KeyChar) = 8 Or Asc(e.KeyChar) = 46) Then e.Handled = True
    End If 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-09-16T06:14:34.553

```
Private Sub TextBox1_KeyPress(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles TextBox1.KeyPress
        Dim NumString = "0123456789.-"
        If Not NumString.Contains(e.KeyChar) Then
            If Asc(e.KeyChar) <> 8 Then  'BackSpace is allowed
                e.KeyChar = ""
            End If
        Else
            If e.KeyChar = "-" Then
                If Len(Trim(TxtDcrAmt.Text)) > 0 Then
                    e.KeyChar = ""
                End If
            End If

            If e.KeyChar = "." Then
                If TxtDcrAmt.Text.Contains(".") Then
                    e.KeyChar = ""
                End If
            End If

            If TxtDcrAmt.Text.Contains(".") Then
                Dim TLen As Integer = 0
                TLen = TxtDcrAmt.Text.IndexOf(".") + 2
                If Len(Trim(TxtDcrAmt.Text)) > TLen Then
                    e.KeyChar = ""
                End If
            End If
        End If
    End Sub 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-06-24T02:29:18.100

```
Private Sub textbox_KeyPress(sender As Object, e As KeyPressEventArgs) Handles textbox.KeyPress
    If (e.KeyChar < "0" OrElse e.KeyChar > "9") AndAlso e.KeyChar <> ControlChars.Back Then
        e.Handled = True

    End If
End Sub 
```

这应该做你想做的事。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2017-03-02T02:51:47.493

把它放在按键事件上。这仅允许点和数字

```
If Asc(e.KeyChar) <> 8 Then
            If Asc(e.KeyChar) < 46 Or Asc(e.KeyChar) > 57 Or (Asc(e.KeyChar) < 48 And Asc(e.KeyChar) > 46) Then
                e.Handled = True
      End If
End If 
```

# javascript - postMessage - 多个 postMessage 事件/函数/回调？

> ID：11253517
> 
> 赞同：2
> 
> 时间：2012-06-28T21:57:50.507
> 
> 标签：javascript, jquery, html, iframe, postmessage

看了这个问答，但它并没有解决我的问题： [PostMessage with multiple functions or custom callbacks](https://stackoverflow.com/questions/8479911/postmessage-with-multiple-functions-or-custom-callbacks)

我需要在加载时使用 postMessage ，然后在点击事件中使用另一个，并且两者的接收者将在同一页面（父）上。

有没有一种方法来确定 postMessage 的范围？或发送多个postMessages？我可以解析消息以触发特定功能，但是如何拥有多个帖子？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T12:57:03.733

我的留言：

```
 $.postMessage(
        'layerTitle|'+ layerTitle +'',
        '*',
        parent
      );
...
var getDocHeight = $(document).height();
     $.postMessage(
        'iframeHeight|'+ getDocHeight +'',
        '*',
        parent
      ); 
```

我收到：

```
$.receiveMessage(
  function(e){
    var message = e.data.split('|');
    if(message[0] == "layerTitle"){
    $('#ui-dialog-title-loginDialog').empty().append(message[1]);
    }
    if(message[0] == "iframeHeight"){
        $('#loginLayer').attr('height', message[1]);
    }

  }
); 
```

# c# - Masked Edit Extender：电子邮件文本框的自定义掩码，有没有办法使用自定义掩码将用户限制到特定域？

> ID：11253518
> 
> 赞同：2
> 
> 时间：2012-06-28T21:57:55.330
> 
> 标签：c#, asp.net, asp.net-ajax, maskedtextbox

我有一个用户注册页面，但它应该只允许用户为其电子邮件输入一个特定域，如下所示：

```
*@example.com 
```

电子邮件的用户名可以是任何内容，但**必须**预先输入域并且不能更改。我正在尝试使用 Ajax Masked Edit Extender 来做到这一点，但我找不到让域成为我想要的静态值的方法。

我如何实现这一目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T07:25:26.837

试试这个代码：

```
 <asp:TextBox ID="txtemail" runat="server"></asp:TextBox>
    <cc1:MaskedEditExtender ID="MaskedEditExtender1" runat="server" Mask="AAAAAA@domain.com"
        InputDirection="LeftToRight" TargetControlID="txtemail">
    </cc1:MaskedEditExtender> 
```

在掩码属性中`in place of AAAAAA`，您要添加更多`AAA`内容，这取决于您要求`character`允许用户输入多少。

或者

您在文本框中输入了这样的选项，用户只能输入`character`您在掩码属性中传递的任何内容。

如下图：

![面具](../Images/7b2ed34ecb1ac576e6daf7417cb4886c.png)

[http://msdn.microsoft.com/en-us/library/system.windows.forms.maskedtextbox.mask(v=vs.90).aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.maskedtextbox.mask(v=vs.90).aspx) [MaskedTextBox](http://msdn.microsoft.com/en-us/library/system.windows.forms.maskedtextbox.mask%28v=vs.90%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T22:01:56.417

您不想在控制器或代码隐藏文件中执行此操作吗？

如果没有.. 你需要用 javaScript 处理它

# ruby-on-rails - 谁能告诉我 ActionController::Base.view_paths.each(&:clear_cache) 做了什么

> ID：11253526
> 
> 赞同：0
> 
> 时间：2012-06-28T21:59:37.200
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我知道 ActionController::Base.view_paths 为我提供了视图的加载路径，但我唯一能找到的 clear_cache 与数据库有关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T22:04:47.583

[https://github.com/rails/rails/blob/3-2-stable/actionpack/lib/action_view/template/resolver.rb#L39-41](https://github.com/rails/rails/blob/3-2-stable/actionpack/lib/action_view/template/resolver.rb#L39-41)

在调用方法的`@cached`任何地方都会修改变量： [https ://github.com/rails/rails/blob/3-2-stable/actionpack/lib/action_view/template/resolver.rb#L70-90](https://github.com/rails/rails/blob/3-2-stable/actionpack/lib/action_view/template/resolver.rb#L70-90)`cached`

从外观上看，它将清除所有缓存的模板并从磁盘重新加载它们。

# c# - 具有三元关系的休眠 n+1。想要三元中的中间实体

> ID：11253529
> 
> 赞同：4
> 
> 时间：2012-06-28T21:59:53.863
> 
> 标签：c#, nhibernate, fluent-nhibernate, nhibernate-criteria

我在使用 nhibernate n+1 时遇到了一个大问题，我尝试的任何方法似乎都无法解决问题。Nhibernate profiler 仍然显示 n+1 选择命中数据库。

这是我的模型：

```
public class CustomerGroup : CoreObjectBase
{
    public virtual long GroupId { get; set; }

    public virtual Site Site { get; set; }

    public virtual IList<Customer> Customers { get; set; }

    public virtual string Name { get; set; }
    public virtual string DisplayName { get; set; }
    public virtual CustomerGroupStatus Status { get; set; }

    public CustomerGroup()
    {
        Customers = new List<Customer>();
    }
} 
```

还有我的客户

```
public class Customer : CoreObjectBase
{
    public virtual int CustomerId { get; set; }
    public virtual Site Site { get; set; }
    public virtual CustomerType CustomerType { get; set; }
    public virtual CustomerName Name { get; set; }
    public virtual Address Address { get; set; }
    public virtual ContactInfo ContactInfo { get; set; }

    public virtual IList<Invoice.Invoice> Invoices { get; set; }

    public virtual IList<ItemBase> Payments { get; set; }

    public virtual CustomerOptions Options { get; set; }
} 
```

和选项

```
public class CustomerOptions : CoreObjectBase
{
    public virtual int CustomerOptionsId { get; set; }

    private int CustomerId { get; set; }
    private Customer Customer { get; set; }

    public virtual bool PortalSignInDisabled { get; set; }
    public virtual CustomerGroup Group { get; set; }

    protected CustomerOptions()
    {

    }

    public CustomerOptions(Customer customer)
    {
        Customer = customer;
    }

    public virtual Customer GetCustomer()
    {
        return Customer;
    }
} 
```

最后，我的发票

```
public class Invoice : CoreObjectBase
{
    public virtual long InvoiceId { get; set; }

    private string SiteId { get; set; }
    private string CustomerId { get; set; }

    [Required]
    [StringLength(50)]
    public virtual string InvoiceNumber { get; set; }

    public virtual decimal Amount { get; set; }
    public virtual decimal OpenAmount { get; set; }
    public virtual decimal ClosedAmount { get; set; }

    public virtual InvoiceStatus Status { get; set; }
    public virtual DateTime? DateDue { get; set; }
    public virtual DateTime? InvoiceDate { get; set; }

    public virtual DateTime Created { get; set; }
    public virtual DateTime Modified { get; set; }

    public virtual Site Site { get; set; }
    public virtual Customer Account { get; set; }

    public virtual IList<InvoiceLineItem> LineItems { get; set; }
    public virtual IList<InvoicePayment> Transactions { get; set; }

    public Invoice()
    {
        Created = DateTime.Now;
        Modified = DateTime.Now;

        Site = new Site();
        Account = new Customer();

        LineItems = new List<InvoiceLineItem>();
        Transactions = new List<InvoicePayment>();
    }

    public override bool Equals(object obj)
    {
        return base.Equals(obj);
    }

    public override int GetHashCode()
    {
        return base.GetHashCode();
    }
} 
```

现在我的客户映射

```
public sealed class CustomerMap : ClassMap<Customer>
{
    public CustomerMap()
    {
        Table("Customers");

        Id(x => x.CustomerId).GeneratedBy.Identity();

        Map(x => x.CustomerType).CustomType<CustomerType>();
        Map(x => x.DriversLicense).CustomType<TrimmedString>();
        Map(x => x.LicenseState).CustomType<TrimmedString>();
        Map(x => x.Notes).CustomType<TrimmedString>();

        References<Site>(x => x.Site, "SiteId");

        HasOne<CustomerOptions>(x => x.Options)
            .Cascade.All();

        Component(x => x.Name, y =>
        {
            y.Map(x => x.Name1).CustomType<TrimmedString>();
            y.Map(x => x.Name2).CustomType<TrimmedString>();
        });

        Component(x => x.Address, y =>
        {
            y.Map(x => x.Address1).CustomType<TrimmedString>();
            y.Map(x => x.Address2).CustomType<TrimmedString>();
            y.Map(x => x.City).CustomType<TrimmedString>();
            y.Map(x => x.State).CustomType<TrimmedString>();
            y.Map(x => x.ZipCode).CustomType<TrimmedString>();
            y.Map(x => x.Country).CustomType<TrimmedString>();
        });

        Component(x => x.ContactInfo, y =>
        {
            y.Map(x => x.EMail).CustomType<TrimmedString>();
            y.Map(x => x.Fax).CustomType<TrimmedString>();
            y.Map(x => x.Phone1).CustomType<TrimmedString>();
            y.Map(x => x.Phone2).CustomType<TrimmedString>();
        });

        HasMany<FTNI.Core.Model.Invoice.Invoice>(x => x.Invoices)
            .KeyColumn("CustomerId")
            .Inverse()
            .Cascade.All()
            .Where("Status = 0")
            .OrderBy("DueDate, InvoiceDate")
            .Fetch.Join();
    }
} 
```

和我的发票映射

```
 public InvoiceMap()
    {
        Table("InvoiceView");

        Map(x => x.InvoiceId).Generated.Always();

        CompositeId()
            .KeyProperty(Reveal.Member<FTNI.Core.Model.Invoice.Invoice>("SiteId"))
            .KeyProperty(Reveal.Member<FTNI.Core.Model.Invoice.Invoice>("CustomerId"))
            .KeyProperty(x => x.InvoiceNumber);

        Map(x => x.Amount);
        Map(x => x.Created).Generated.Insert();
        Map(x => x.ClosedAmount);
        Map(x => x.DateDue, "DueDate");
        Map(x => x.InvoiceDate);
        Map(x => x.OpenAmount);
        Map(x => x.Status).CustomType<InvoiceStatus>();

        References<Site>(x => x.Site, "SiteId");
        References<Customer>(x => x.Account, "CustomerId");

        HasMany<InvoiceLineItem>(x => x.LineItems)
            .KeyColumns.Add("SiteId", "CustomerId", "InvoiceNumber")
            .Cascade.All();

        HasMany<InvoicePayment>(x => x.Transactions)
            .Where("Status IN (0, 1)")
            .KeyColumns.Add("SiteId", "CustomerId", "InvoiceNumber")
            .Cascade.All();
    } 
```

我必须加入这三个字段的其他表，因为我们的一个客户完全转储了他们的数据并从头开始重新加载所有发票（不要问为什么）。因此，为了保持连接性，我加入了允许新发票与刷新数据挂钩的字段上的那些表。

我要做的是显示组中所有成员的所有发票，按客户分隔（按客户名称排序），然后按到期日订购发票。

所以，我的网站看起来像这样：

**客户名称（号码）**

*   发票 1 信息
*   发票 2 信息
*   发票3信息

**下一个客户（数量）**

*   发票A信息
*   发票 B 信息
*   发票C信息

所以，我做了一个查询

```
results = Session.CreateQuery(String.Format(@"select distinct customer from Customer customer join fetch customer.Invoices where customer.Options.Group.GroupId = {0}", 
                groupId)).List().Cast<Customer>(); 
```

这仍然会导致 N+1 问题。关于如何使查询工作的任何想法？

理想情况下，查询将按客户有发票的组 ID（计数 > 0），然后按客户名称和发票到期日排序。这一切对我来说似乎都是直截了当的——在我得到初始设置后，我正在做排序和排除。但是，我仍然遇到 n+1 问题。

在分析器中，我看到它正在执行从客户到发票的连接。但是，它会继续获取每张发票的详细信息。

我怀疑这是因为在我的代码中，我将模型从数据模型（映射到 nhibernate）转换为视图模型（未映射到 nhibernate），以尝试分离数据，以便它不会回调数据库。

我需要一些关于如何处理数据的指导，以便我可以遍历数据集（foreach customer foreach invoice）来呈现我的页面。这是进行转换的linq。

selected invoices 是一个字典，存储在前端选择的要支付的发票。当我加载页面时，我想获取选定的发票是否正在支付、应用了多少以及其他一些信息。

```
var customerModels = from c in customers
     let invoices = c.Invoices
     select new CustomerModel()
     {
         CustomerNumber = c.CustomerNumber,
         CustomerId = c.CustomerId,
         Name = c.Name.DisplayName,
         Invoices = (from i in invoices
                    join s in selectedInvoices on i.InvoiceId equals s.Key into selected
                    from inv in selected.DefaultIfEmpty()
                    select new InvoiceModel()
                    {
                        Amount = i.Amount,
                        ClosedAmount = i.ClosedAmount,
                        DueDate = i.DateDue,
                        InvoiceDate = i.InvoiceDate,
                        InvoiceId = i.InvoiceId,
                        InvoiceNumber = i.InvoiceNumber,
                        OpenAmount = i.OpenAmount,
                        Condensed = false,

                        Selected = inv.Key > 0,
                        ReasonValue = inv.Key > 0 ? inv.Value.Item3 : String.Empty,
                        OtherReason = inv.Key > 0 ? inv.Value.Item4 : String.Empty,
                        PaymentAmount = inv.Key > 0 ? inv.Value.Item2 : i.OpenAmount
                    }).Sort(sortIndex.Value, sortOrder.Value).ToList(),

         EnableReason = enableReasons,
         EnableReasonSelector = enableReasonSelector,
         Reasons = reasons,
         Condensed = false,

         SortIndex = sortIndex.Value,
         SortOrder = newSortOrder
     };

model.Customers = customerModels.ToList(); 
```

我这样做是因为我假设这`.ToList()`会导致数据立即转换并与 nhibernate 分开，而不必对数据库执行 n+1 次调用。但是，它仍然设法拨打这些电话。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T23:14:22.983

我看到您正在为发票使用复合 ID。也许你受到了[`Equals()`问题](https://stackoverflow.com/questions/10176862/nhibernate-producing-proxy-despite-hql-fetch)的影响。

总而言之，您必须有一个覆盖`GetHashCode()`并且`Equals()`知道如何对复合 ID 的所有属性进行比较。

[Stuart 的答案](https://stackoverflow.com/a/10205863/119230)链接到[nhibernate.info上的](http://nhibernate.info/)[NHibernate 和 Composite Keys](http://nhibernate.info/blog/2010/06/30/nhibernate-and-composite-keys.html)帖子，您可以在其中找到更多信息。

# model-view-controller - 输入与输出的 HTML/XSS 转义

> ID：11253532
> 
> 赞同：26
> 
> 时间：2012-06-28T22:00:01.783
> 
> 标签：model-view-controller, xss

从我所看到的一切来看，在用户输入的内容上转义 html 的惯例（为了防止 XSS）似乎是在呈现内容时进行。大多数模板语言似乎默认情况下都会这样做，我遇到过类似[这个 stackoverflow 的答案](https://stackoverflow.com/questions/792974/how-to-escape-html-in-jsp-before-saving-to-database)，他们认为这个逻辑是表示层的工作。

所以我的问题是，为什么会这样？对我来说，在输入（即表单或模型验证）时转义似乎更干净，因此您可以假设数据库中的任何内容都可以安全地显示在页面上，原因如下：

1.  多种输出格式 - 对于现代 Web 应用程序，您可能正在使用服务器端 html 呈现、使用 AJAX/JSON 的 JavaScript Web 应用程序和接收 JSON 的移动应用程序的组合（可能有也可能没有一些 Web 视图，可能是 JavaScript 应用程序或服务器呈现的 html)。所以你必须处理到处都是 html 转义。但是输入在保存到数据库之前总是会被实例化为模型（并经过验证），并且您的模型都可以从同一个基类继承。

2.  您已经必须小心输入以防止代码注入攻击（当然这通常被抽象为 ORM 或 db 游标，但仍然如此），所以为什么不在这里也担心 html 转义，这样您就不必担心任何事情安全相关的输出？

我很想听听为什么 html 在页面渲染上转义是首选的论点

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-12-14T11:43:25.293

除了已经写的内容：

*   正是因为您有多种输出格式，并且您不能保证所有这些格式都需要 HTML 转义。如果您通过 JSON API 提供数据，您不知道客户端是否需要它用于 HTML 页面或文本输出（例如电子邮件）。为什么你要强迫你的客户`Jack &amp; Jill`逃避“”以获得“Jack & Jill”？

*   默认情况下，您正在破坏您的数据。

    *   当有人对“amp”进行关键字搜索时，他们会得到“Jack & Jill”。为什么？因为你已经损坏了你的数据。

    *   假设其中一个输入是 URL `http://example.com/?x=1&y=2`：。您要解析此 URL，并提取`y`参数（如果存在）。这静默失败，因为您的 URL 已损坏为`http://example.com/?x=1&amp;y=2`.

*   这样做只是错误的层 - 与 HTML 相关的内容不应与原始 HTTP 处理混为一谈。数据库不应存储与一种可能的输出格式相关的内容。

*   XSS 和 SQL 注入不是唯一的安全问题，您处理的**每个**输出都存在问题 - 例如文件系统（想想像 '.php' 这样会导致 Web 服务器执行代码的扩展名）和 SMTP（想想换行符），以及任何其他人的数量。认为您可以“处理输入的安全性然后忘记它”会降低安全性。相反，您应该将转义委托给不信任其输入数据的特定后端。

*   您不应该“到处”进行 HTML 转义。对于每个需要它的输出，您应该只执行**一次**- 就像对任何后端进行任何转义一样。对于 SQL，您应该进行**一次**SQL 转义，对于 SMTP 等也是如此。通常，您不会进行**任何**转义 - 您将使用一个为您处理它的库。

    如果您使用的是合理的框架/库，这并不难。我从来没有在我的网络应用程序中手动应用 SQL/SMTP/HTML 转义，也从来没有 XSS/SQL 注入漏洞。如果您构建网页的方法要求您记住应用转义，或者最终出现漏洞，那么您做错了。

*   在表单/http 输入级别进行转义并不能确保安全，因为没有任何东西可以保证数据不会从另一条路径进入您的数据库或系统。您必须手动确保系统的所有输入都应用 HTML 转义。

    您可能会说您没有其他输入，但是如果您的系统增长了怎么办？回头改变决定通常为时已晚，因为此时您已经拥有大量数据，并且可能与外部接口兼容，例如需要担心的公共 API，这些接口都希望数据是 HTML 转义的。

*   即使是系统的 Web 输入也不安全，因为通常您应用了另一层编码，例如您可能需要在某个入口点进行 base64 编码输入。您的自动 HTML 转义将丢失该数据中编码的任何 HTML。因此，您将不得不*再次*进行 HTML 转义，并记住要这样做，并跟踪您在哪里完成了它。

我在这里扩展了这些：http: [//lukeplant.me.uk/blog/posts/why-escape-on-input-is-a-bad-idea/](http://lukeplant.me.uk/blog/posts/why-escape-on-input-is-a-bad-idea/)

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2012-06-28T22:24:53.837

## 最初的误解

不要混淆输出的卫生与验证。

虽然`<script>alert(1);</script>`是一个完全有效的用户名，但在网站上显示之前绝对必须对其进行转义。

是的，有*“表示逻辑”之*类的东西，它与“*领域业务逻辑”*无关。并且所述表示逻辑是表示层处理的内容。尤其是`View`实例。在编写良好的 MVC 中，*视图*是成熟的对象（与 RoR 试图告诉您的相反），当应用于 Web 上下文时，它会处理多个模板。

## 关于你的理由

不同的输出格式应该由不同的视图处理。管理 HTML、XML、JSON 和其他格式的规则和限制在每种情况下都不同。

您总是需要存储原始输入（如果您不使用准备好的语句，则进行清理以避免注入），因为有人可能需要在某些时候对其进行编辑。

存储原始版本和 xss 安全的“公共”版本是浪费。如果你想存储清理过的输出，因为每次清理它都需要太多资源，那么你已经对错误的树生气了。这是一种情况，当你使用缓存，而不是污染数据库时。

# asp.net - ASP.NET 按 Enter 键导致注销

> ID：11253538
> 
> 赞同：0
> 
> 时间：2012-06-28T22:00:40.660
> 
> 标签：asp.net

我已经创建了网站。登录后当我按回车键添加产品时，我的网站就把我踢出去了。？通过鼠标点击添加我的购物车没有问题。有没有人有同样的问题或任何建议..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T23:25:00.447

您需要在 ASP:Panel 中添加控件并将 AddProduct 按钮设置为默认按钮：

```
<asp:Panel ID="panel1" runat="server" DefaultButton="btnAddProduct"">
            //Your Other Stuff
           <asp:Button ID="btnAddProduct" runat="server" onclick="btnAddProduct_Click"/>
</asp:Panel> 
```

当您按 Enter 时，这将触发 AddProduct 按钮。

问候

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-02-14T09:02:32.837

[这是我在这里](https://www.codeproject.com/questions/338481/how-can-we-solved-enter-key-logout-problem-on-text)找到的另一种方法-如果您不想添加面板

```
<asp:Button ID="btnDisableEnter" runat="server" Text="" 
            OnClientClick="return false;" style="display: none;" />
<form id="form1" runat="server" DefaultButton="btnDisableEnter"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-01-12T07:08:15.167

如果您在 asp.net C# 中使用 Master Page，并且您使用的是注销按钮，请输入 Button：

```
<asp:Button ID="btn" runat="server" Text="logout" 
         UseSubmitBehavior="false" /> 
```

`UseSubmitBehavior="false"`在您的母版页中使用。我的问题就这样解决了。

# .net - WinForm - 像 BackgroundWorker 一样实现工作线程但得到错误

> ID：11253539
> 
> 赞同：0
> 
> 时间：2012-06-28T22:00:44.347
> 
> 标签：.net, winforms, multithreading, worker

```
 // sample 1 use BackgroundWorker, it works fine
    private BackgroundWorker workerPorcee = new BackgroundWorker();
    private void button1_Click(object sender, EventArgs e)
    {
        workerPorcee.DoWork += new DoWorkEventHandler(workerPorcee_DoWork);
        workerPorcee.ProgressChanged += new ProgressChangedEventHandler(workerPorcee_ProgressChanged);
        workerPorcee.RunWorkerCompleted += new RunWorkerCompletedEventHandler(workerPorcee_RunWorkerCompleted);
        workerPorcee.WorkerReportsProgress = true;
        workerPorcee.RunWorkerAsync();
    }
    void workerPorcee_ProgressChanged(object sender, ProgressChangedEventArgs e)
    {
        this.progressBar1.Value = e.ProgressPercentage;
    }
    void workerPorcee_DoWork(object sender, DoWorkEventArgs e)
    {
        for (int i = 0; i < 100; i++)
        {
            workerPorcee.ReportProgress(i);
            Thread.Sleep(100);
        }
    }

    void workerPorcee_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
    {
        this.progressBar1.Value = 100;
    } 
```

我只是实现了我的工作线程，但它会出现异常：跨线程操作无效：控件'progressBar1'从创建它的线程以外的线程访问。

```
 // my worker thread
     private void button3_Click(object sender, EventArgs e)
    {
        Worker wk = new Worker();
        Thread thr = new Thread(new ThreadStart(wk.ProcessEvent));
        wk.ProgressChanged += new delCallback(wk_ProgressChanged);
        thr.Start();
    }        

    void wk_ProgressChanged(int percent)
    {
        this.progressBar1.Value = percent;
    //exception:Cross-thread operation not valid: Control 'progressBar1' accessed from a thread other than the thread it was created on.       

     }

     public delegate void delCallback(int percent);

public class Worker
{
    public event delCallback ProgressChanged;

    public void ProcessEvent()
    {
        for (int i = 0; i < 100; i++)
        {
            if (ProgressChanged != null)
            {
                this.ProgressChanged(i);
            }
            Thread.Sleep(100);
        }
    }
} 
```

WinForm，我只想使用我的工作线程来设置进度条值，但它失败了。任何人帮助指出什么问题？如何实现与 BackgroundWorker 一样的功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T22:18:07.347

您需要确保与 winForms 控件的所有交互都在创建控件的主线程上执行 - 这就是异常告诉您的内容。为此，您需要使用 Control.Invoke 方法，该方法将确保在正确的线程上执行对 UI 更改方法的调用。

因此，在您的代码示例中，您需要将其更改为：

```
void wk_ProgressChanged(int percent)
{
    if(this.progressBar1.InvokeRequired)
    {
        this.progressBar1.Invoke(wk_ProgressChanged, new Object[] {percent});
    }
    else
    {
        this.progressBar1.Value = percent;
    }       
 } 
```

第一部分检查是否正在为 progressBar1 控件正确的线程上执行方法调用。如果我们在不同的线程上，Invoke 用于调用相同的方法，但在正确的线程上。然后 Invoke 将调用 wk_ProgressChanged 方法，但这次 InvokeRequired 将为 false（因为我们现在在正确的线程上运行以执行 UI 更新），并且设置了 progressBar1 值。

# python - 如何在 Python 中结合时区感知日期和时间？

> ID：11253540
> 
> 赞同：14
> 
> 时间：2012-06-28T22:00:44.127
> 
> 标签：python, timezone, pytz

我有一个日期和时间，我试图在 Python 中组合。时间是时区感知的。

但是，当我尝试将它们结合起来时，我得到了错误的时间。

```
import pytz
from datetime import time, date
NYC_TIME = pytz.timezone('America/New_York')

start_date = date(2012, 7, 7)
start_time = time(hour = 0, tzinfo = NYC_TIME)
combined = datetime.combine(start_date, start_time)
print combined
print NYC_TIME.normalize(combined) 
```

这将打印`2012-07-07 00:00:00-05:00`，标准化为`2012-07-07 01:00:00-04:00`。为什么会这样？我怎样才能避免它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T22:11:05.857

没有附加日期的时间必须假定它不在夏令时期间。一旦你给它附加了一个日期，这个假设就可以被纠正。区域偏移量会发生变化，时间也会发生变化，以使其保持相同的 UTC 等效值。

# paypal - 如何检查 PayPal 电子邮件地址是否已向我们授予 Grant API 权限？

> ID：11253541
> 
> 赞同：0
> 
> 时间：2012-06-28T22:00:45.173
> 
> 标签：paypal

我是一个 API 调用者（在自适应支付中），我想验证给定的电子邮件地址是否已授予 API 权限以处理他们帐户的退款 API。

最好有一个 API 调用来检查这一点。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T04:12:08.990

使用[Permissions API](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_api_PermissionsAbout)，这将允许您显式设置第三方 API 授权并检查它。

# php - 回显时不会在数组中输出值

> ID：11253543
> 
> 赞同：3
> 
> 时间：2012-06-28T22:00:54.453
> 
> 标签：php

我认为当我回显 $whereArray 和 orderByArray 时会出现问题。如果我输入诸如“问题”之类的单词然后提交，我希望它会显示在 echos "%".Question."%"; 对于两个数组。但相反，在两个回声中，它只为两个回声显示“阵列”。这是否意味着在存储值时两个数组都不起作用？

```
 $searchquestion = $_GET['questioncontent'];
    $terms = explode(" ", $searchquestion);

$whereArray = array();
$orderByArray = array();

    //loop through each term
    foreach ($terms as $each) {
        $i++;
        $whereArray[] = "%".$each."%";
        $orderByArray[] = "%".$each."%"; 

    }

        echo $whereArray;
        echo $orderByArray; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T22:06:30.850

`echo()`仅适用于字符串。PHP 将您的数组转换`"Array"`为备用。

调试时，应使用`var_dump()`. 它将告诉您对象的类型及其内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T22:05:43.077

需要使用 print_r 等特殊函数打印出数组。如果要打印数组中的值，请尝试：

```
echo $whereArray[0]; 
```

获取第一个元素。请小心，因为如果数组为空，您将收到错误消息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-28T22:06:16.220

你也可以遍历它们

```
foreach($arrayname as $value)
     echo $value; 
```

或者

```
 echo implode("",$arrayname); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-28T22:02:31.430

使用`var_dump`or`print_r`代替`echo`（它们是函数，而不是像`echo`is 这样的构造）。

# dojo - Dojo 自定义构建：部署哪些文件

> ID：11253554
> 
> 赞同：3
> 
> 时间：2012-06-28T22:02:19.753
> 
> 标签：dojo, dojox.mobile

首先，我们是 Dojo 的新手，可以自由地以“新”方式做事，所以我基本上忽略了文档中 1.7 之前的部分。不过，在比较各种文章、文档和示例脚本时，我仍然感到困惑。

最重要的是，我找不到关于如何为 Dojo 创建*和部署*自定义构建的简单文章。最具体地说，我们需要部署哪些 .js 和 .css 文件。有很多[关于创建构建的文档](http://dojotoolkit.org/documentation/tutorials/1.7/build/)，但我在部署时没有找到。

我最终收集到，将所有内容构建到单个 dojo.js 中对于移动设备来说是一种合理的做法，我只需从构建目录中提取一个文件并将其部署到我的服务器，但随后我会丢失 CSS 引用，并且试错似乎不是解决这些问题的正确方法。

这是我们当前的具体案例：

```
<script type="text/javascript">
        require(
                // deviceTheme to auto-detect device styles
                [   
                    "dojox/mobile",
                    "dojox/mobile/parser",
                    "dojox/mobile/deviceTheme"
                ]);
</script> 
```

这是构建配置文件：

```
dependencies = {
    stripConsole: "normal",

    layers: [
        {
            name: "dojo.js",
            customBase: true,    // prevent automatic inclusion of dojo/main
            dependencies: [
                "dojox.mobile.parser",
                "dojox.mobile",
                "dojox.mobile.deviceTheme"
            ]
        }
    ],

    prefixes: [
        [ "dijit", "../dijit" ],    // example included; not clear why
        [ "dojox", "../dojox" ]
    ]
} 
```

（由`dojo-release-1.7.2-src\dojox\mobile\build\build.bat`脚本执行。）

所以我想具体的问题是：

1.  对于这种情况，我应该部署哪些 CSS 文件？
2.  我一般如何知道要部署哪些文件，包括 CSS 文件？
3.  我缺少一个好的当前教程吗？
4.  现有的脚本是最新的吗？例如，为什么`mobile-all.profile.js`使用`dependencies=`而不是`profile=`1.7[构建教程](http://dojotoolkit.org/documentation/tutorials/1.7/build/)描述的？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-29T11:49:00.497

### 对于这种情况，我应该部署哪些 CSS 文件？

这是有条件的，如果页面使用特定模块并且它有自己的 css 规则，则包含它们。

*这*不是方法，但从 dojo.css（基础、重置）、dijit.css（基础、布局等）、nihilo.css（示例主题）和 android.css（示例主题）开始将是一个很好的基础

*   如果您想使用主题，请包含“基本名称”，例如 dojox/mobile/themes/iphone/iphone.css
*   例如，如果 iphone.css 没有“@import”**您使用的某些外来小部件**，请包括由小部件本身提供的 css（例如，dojox/widget/ColorPicker/ColorPicker.css）。每个小部件的文档 _should not make this.

### 我一般如何知道要部署哪些文件，包括 CSS 文件？

*   上传所有文件没有害处，**加载程序将决定**从缓存构建中获取哪些文件，不理会哪些文件以及在运行时下载哪些文件。
*   部署一切.. 当你构建一个'action = release'时，所有文件都在定义的dojo（默认值，allways），dijit，dojox和你添加的任何包的前缀内被缩小。
*   构建会优化工具包树，部署全部，否则您可能会遇到缺少条件包含（例如 Toggler.js 或 acme.js 选择器等）的情况。

### 我缺少一个好的当前教程吗？

通过'thumbrule'，任何 1.6+ 文档都是稳定的，但他们大多说相同。当您启动配置文件时，它可能会经历一些试验和错误（脚本文件的 inline-html 包含顺序是最重要的）。您发布的内容看起来不错，但请考虑 customBase:true 是否必要。

确保您已经在1.6-1.7 和[1.8版本中](http://dojotoolkit.org/documentation/tutorials/1.8/build/)[看到了这一点](http://dojotoolkit.org/reference-guide/1.7/quickstart/custom-builds.html?highlight=localeList)

### 现有的脚本是最新的吗？例如，为什么 mobile-all.profile.js 使用 dependencies= 而不是 1.7 构建教程描述的 profile=？

您可以使用现有的，开箱即用。然而，构建器正在发生变化，与备受争议的 2.0 版本相抗衡。目前，新方案和常规方案一样被允许。但实际上变量名可以是 foo 或 bar，只是使用变量的值。该文件必须“返回”一个对象。

据我了解，原因是[CommonJS Packages/1.0](http://wiki.commonjs.org/wiki/Packages/1.0)是 AMD 和 builder 1.7+ 的新圣经。然而，它一直是包层次结构所遵循的“拇指”方案——但随着我们接近 2.0，语法很可能会变得越来越严格。（看看你是否可以在#dojo @ irc.freenode.org 上连接 snover）

# class - Puppet 参数化类和更改参数

> ID：11253557
> 
> 赞同：2
> 
> 时间：2012-06-28T22:02:36.467
> 
> 标签：class, parameterized, puppet

我正在尝试了解 Puppet 参数化类。我有一个这样定义的参数化类：

```
class defaults(
  $no_samba = 'FALSE'
)
{
  if ($no_samba =~ /TRUE/) {
    notify { "will not install samba": } ;
  } else {
    # install samba here
  }

  # More server install tasks here...
} 
```

此外，我定义一个basenode如下：

```
node basenode
{
  class {'defaults':
    no_samba => 'FALSE',
  }
} 
```

然后我实例化一个服务器：

```
node myserver1 inherits basenode {
  Class['defaults'] { no_samba => 'TRUE' }
} 
```

但是，这不起作用。myserver1 节点不显示指示不会安装 samba 的通知消息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T01:50:53.000

是否在 myserver1 上安装了 samba，和/或是否触发了任何其他服务器安装任务？如果只是没有打印通知消息，那么可能确实是 [通知类型](http://docs.puppetlabs.com/references/2.7.6/type.html#notify)与[通知功能](http://docs.puppetlabs.com/references/stable/function.html#notice)的问题。

通知应该看起来像“通知{“我有大括号和一个尾随冒号”：}

Notice 像函数一样被调用：notice("i use parenthesis")

尝试将“通知”更改为“通知”，看看它是否有效。您可能还想使用“puppet parser validate default.pp”检查 puppet 语法（假设您的默认类在 default.pp 中）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T18:18:59.980

这是我的非拼写错误答案-我认为您遇到了[http://projects.puppetlabs.com/issues/7890](http://projects.puppetlabs.com/issues/7890)

这是一个代码示例，我根据票证中的重写示例调整了您的代码以获得您正在寻找的效果：

```
class defaults(
  $no_samba = 'FALSE'
)
{

  notify {"no_samba_hack" :
    message => "$no_samba";
  }

  if ($no_samba =~ /TRUE/) {
    notify { "will not install samba": }
  } else {
    # install samba here
  }

  # More server install tasks here...
}

class basenode($no_samba="FALSE") {
  class {defaults: no_samba => $no_samba}
}

node yourserver {

  class { 'basenode' : no_samba => 'TRUE'}

} 
```

当我在 Ubuntu 12.04 上使用带有 puppet 2.7.11 的“puppet apply sample.pp”运行它时，我得到以下输出：

```
notice: will not install samba
notice: /Stage[main]/Defaults/Notify[will not install samba]/message: defined 'message' as 'will not install samba'
notice: TRUE
notice: /Stage[main]/Defaults/Notify[no_samba_hack]/message: defined 'message' as 'TRUE'
notice: Finished catalog run in 0.05 seconds 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-30T21:19:01.840

这是一个简单的例子：

```
class apache-setup {
  class { 'apache':
    mpm_module => 'prefork',
  }
}

include apache-setup 
```

或者：

```
class { '::mysql::server':
  config_file => '/etc/my.cnf',
  root_password    => 'root', # Sets MySQL root password.
  override_options => {
    'mysqld' => {
      'max_connections' => '512',
      'max_allowed_packet' => '256M',
      'log' => 'ON',
      'log_slow_queries' => 'ON',
      'general_log' => 'ON',
      'wait_timeout' => '28800',
    }
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-03T11:35:27.393

我相信这与范围有关。看起来您正在基节点中创建“默认”类，然后在继承该基节点的事物之后为“默认”类设置资源默认值。

[http://docs.puppetlabs.com/guides/language_guide.html](http://docs.puppetlabs.com/guides/language_guide.html)

“默认值不是全局的——它们只会影响当前范围和低于当前范围的范围。”

# javascript - iframe 调整大小和跨站点脚本

> ID：11253558
> 
> 赞同：0
> 
> 时间：2012-06-28T22:02:40.193
> 
> 标签：javascript, iframe, resize, xss

这就是问题所在！我有一个加载外部网站的 iframe。我希望 iframe 根据内容高度将大小调整为 100%，这样我就不会得到滚动条。将 iframe 高度设置为 100% 不起作用。

我想出了两个解决方案：

1.  将两端的 document.domain 属性设置为同一个域，从而使 iframe 内容可以访问父窗口。可以从 iframe 中启动 resize 方法。
2.  使用 HTML5 postMessage API 采取适当的行动。我用来在两个 iframe 之间进行通信。

这两种方法都很复杂。有没有更简单的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T22:22:14.493

您可以将另一个 iframe 嵌入到您的 iframe 中。如果该 iframe 的源来自与顶级 iframe 相同的域、协议和端口，则它可以通过 parent.parent 访问它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T12:54:24.770

去年我遇到了同样的问题，并在这个博客上找到了一个对我有用的解决方案：http: [//solidgone.org/Set-IFRAME-height-based-on-size-of-remotely-loaded-content](http://solidgone.org/Set-IFRAME-height-based-on-size-of-remotely-loaded-content)

该方法的更新版本可以在他的后续文章中找到： http: [//solidgone.org/Redux-Set-IFRAME-height-based-on-size-of-remotely-loaded-content](http://solidgone.org/Redux-Set-IFRAME-height-based-on-size-of-remotely-loaded-content)

就像杰克描述的那样，该实现需要在您的页面中嵌入一个具有相同父域源的 iframe。

我确实在FF中遇到了一个小问题。解决方法可以在后续文章的评论中找到。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-12T21:11:00.293

一个更简单的解决方案是在 github 上使用这个小项目。

[https://github.com/davidjbradshaw/iframe-resizer](https://github.com/davidjbradshaw/iframe-resizer)

# iphone - 使用 Core Data 合并从一个上下文到另一个上下文的更改

> ID：11253561
> 
> 赞同：0
> 
> 时间：2012-06-28T22:02:53.600
> 
> 标签：iphone, ios, core-data

我对 iOS 5 并发选项有点困惑。通常，使用旧方法，您必须使用 mergeChanges 和通知手动跟踪从一个上下文到另一个上下文的更改。但是，如果我的理解是正确的，使用新选项，您可以拥有一个带有子上下文的 NSMainQueueConcurrencyType。因此，每当您保存子上下文时，更改会自动向上推送并与父上下文合并，而无需任何其他手动工作，对吗？

如果是这样，我有一个问题。假设我有一个由主上下文获取的对象。然后我更改了这些对象的一些属性，但我还没有保存。然后，在父设置为 mainContext 的 NSPrivateQueueConcurrencyType 上，我执行 fetch 以检索我刚刚在主上下文中修改的对象。获取的对象会反映我刚刚对主线程上的属性所做的更改吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T07:51:00.873

> 获取的对象会反映我刚刚对主线程上的属性所做的更改吗？

不会。在您 -refreshObject:mergeChanges:YES 之前，这些更改不会反映在子上下文中。

就像思考的食物一样，UIManagedDocument 以相反的方式执行此操作。它为主线程创建一个子上下文，并使用 NSPrivateQueueConcurrencyType 作为父线程的上下文。现在在主线程上进行的所有更新都将自动传播到父上下文。因此，当文档在后台保存时，所有更改都将在那里。

# function - 更改“a”元素中的参数

> ID：11253562
> 
> 赞同：0
> 
> 时间：2012-06-28T21:49:44.520
> 
> 标签：function

我正在尝试改变：

```
<a href="www.example.com"> 
```

这样：

```
<a onclick="parent.location='www.example.com'"> 
```

我想动态地执行此操作，我的意思是，使用我网站中的所有链接。我不知道如何在functions.php中做到这一点

显然“www.example.com”不是一个常数。

你们中的一些人可以帮助我吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T01:27:31.240

您可以使用 jQuery 轻松完成此操作。

首先，剥离`href`属性并添加`onclick`属性：

```
$('a').each(function() {
    $(this).attr('onclick', 'parent.location=\'' + $(this).attr('href') + '\'').removeAttr('href');
}); 
```

# ruby-on-rails - 每次重新加载 ActiveRecord 模型时如何运行一段代码

> ID：11253568
> 
> 赞同：3
> 
> 时间：2012-06-28T22:03:10.303
> 
> 标签：ruby-on-rails, ruby-on-rails-3

所以我有一些代码可以重写回形针文件路径，以便项目中的每个开发人员都可以拥有自己上传的路径，而不会相互干扰，但这在开发中运行

```
ActiveSupport.on_load(:after_initialize) do 
```

环形。这意味着它仅在初始化时加载。问题是我们正在使用 Active Reload gem（rails 3.1 所以没问题），所以一旦有人编辑了模型，它就会重新加载并使用旧的回形针路径。

我想知道每次重新加载特定模型时如何让这段代码运行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T22:06:49.673

你可以把它包装在一个`config.to_prepare` 块里面`config/application.rb`：

```
config.to_prepare do
  # your code
end 
```

这将在开发中的每个请求时重新加载，但在生产中只加载一次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T05:27:26.007

所以我在上面尝试了 Ryan 的建议，但就像我想的那样，它会在每次页面加载时运行我的代码......没有 Bueno。

我最终做的是使用 Active Reloader 提供给您的这段代码，但我怀疑它是否适用于 Rails 3.2

```
 ActiveSupport::Notifications.subscribe("active_support.dependencies.clear") do |*args|
    my_code_block
  end 
```

而且它很有效，我仍然必须保留原件

```
ActiveSupport.on_load(:after_initialize) do 
```

也阻止那里，所以它有点难看，但它的工作原理！

仍然坚持寻找更清洁的解决方案，如果存在的话。

# javascript - 使用javascript在新窗口中打开链接？

> ID：11253574
> 
> 赞同：1
> 
> 时间：2012-06-28T22:03:43.690
> 
> 标签：javascript

我在下面尝试了 javascript，它确实在打开的窗口中打开了 url，但它清除了当前窗口中的 url 并指向新的 URL。

window.open('http://www.google.com','_blank');

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T23:14:16.347

发生这种情况是因为您拥有 _blank 的第二个位置是名称应该在的位置。

我建议作为上面的链接，Nathan 帖子建议这样做。：

```
window.open(url, windowName, "height=200,width=200"); 
```

然后对导致新窗口打开的任何事件进行一些 javascript 触发。

因此，假设它是一个图像，为图像设置 Target="_blank"，然后设置一个 OnClick 事件以调用其中包含 window.open 代码的函数。

那会成功的。高温高压

# php - Varbinary 编码

> ID：11253576
> 
> 赞同：0
> 
> 时间：2012-06-28T22:03:54.577
> 
> 标签：php, mysql, encoding, varbinary

我的数据库中有一个`varbinary`字段，但在显示特殊（波兰语）字符时遇到了一些问题，例如`ąśćężźć`.

示例：`SELECT local_name from items WHERE id = 140`返回：`Pieczęć`，当我想在我的网站上打印此数据（在 `UTF-8`那里编码）时出现问题，然后`Pieczęć`变成以下字符串：`Piecz��`也尝试使用`utf8_encode()`PHP 函数，但它给出以下结果：`Pieczêæ`。

我该如何解决这个问题，以便它可以毫无问题地打印特殊字符？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T23:13:39.287

与此处相同的建议： [https ://stackoverflow.com/a/11254131/1489924](https://stackoverflow.com/a/11254131/1489924)

```
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" > 
```

和/或

```
SET NAMES 'utf8' 
```

在大多数情况下为我工作。祝你好运！

# asp.net - 如何更改图片上的图像 在后面的代码中？

> ID：11253578
> 
> 赞同：1
> 
> 时间：2012-06-28T22:04:15.727
> 
> 标签：asp.net

我有`<asp:GridView >`一个`<asp:ButtonField ButtonType="Image">`作为列之一。

`gridView_RowDataBound(...)`这就是问题所在：我必须在事件期间根据在该特定 gridview 行中找到的数据动态更改此 ButtonField 的图像。

真正的问题是，如何访问`gridView_RowDataBound(...)`事件中的特定 ButtonField 以便我可以在 C# 代码中更改其图像？

我无法使用

```
Image imgCtrl = (Image)args.Row.FindControl("ctrlID"); 
```

因为`<asp:ButtonField>`不允许设置 ID（当我尝试运行网页时出现解析器错误）。而且我不能使用

```
args.Row.Cells[0].Controls[0]; 
```

因为 .Controls[0] 的第零个索引不存在（我得到一个边界溢出错误）。

必须有一个简单、巧妙、简单的方法来做到这一点！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T23:12:38.860

**快速示例：**

```
 protected void GridView1_RowDataBound(object sender, GridViewRowEventArgs e)
    {
        DataRowView drv = (DataRowView)e.Row.DataItem; 
        if (e.Row.RowType == DataControlRowType.DataRow)
        {
            TableCell tableCell = e.Row.Cells[3]; // Column 3 in the grid have the Image Button 
            foreach (var control in tableCell.Controls)
            {
                if (control.GetType() == typeof(System.Web.UI.WebControls.ImageButton)) ;
                {
                    ImageButton iButton = control as ImageButton;
                    iButton.ImageUrl = "/Logo.jpg";
                }
            }
        }
    } 
```

# ios - plist array null 尽管 plist 确实包含一个字符串

> ID：11253579
> 
> 赞同：0
> 
> 时间：2012-06-28T22:04:29.800
> 
> 标签：ios, nsmutablearray, initialization, nsarray, plist

我有一个 plist 文件，它从主包复制到 docs 目录中。如果该文件已经存在于文档中，它不会将其复制到它应该如何工作的地方。

我遇到的问题是当我在 appDelegate applicationDidFinishLaunching 或 rootViewControllers viewDidLoad 或 viewDidAppear 方法中初始化 plist 数组时。

现在，被复制到 docs 目录的 mainbundle 中的 plist 有一个项目，它是一个字符串

plist 源确实包含一个名为 GBP 的字符串，包含在数组节点中，这也是正确的。

我像这样初始化 plist NSMutableArray

```
NSString *rootPath2 = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];
NSString *plistPath2 = [rootPath2 stringByAppendingPathComponent:@"currency.plist"];
theCurrency = [[NSMutableArray alloc] initWithContentsOfFile:plistPath2]; 
```

在 viewDidLoad 或 viewWillAppear 我检查数组：

```
NSLog(@"Array contains %@", theCurrency); 
```

结果如何为空？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T22:34:04.917

好吧，伙计们，我发现这是我初始化数组的地方。在 viewdidload 中，我提供了在 0.1 秒延迟后执行选择器，并且选择器指向一个方法，该方法包含 plist 的初始化以及我在记录数组内容时检查的条件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T22:22:15.703

假设它找到了文件，plist 应该是一个字典。您在 plist 中的数组应该有一个名称来识别它，所以请尝试以下操作：

```
NSDictionary *dict = [[NSDictionary alloc]initWithContentsOfFile:plistPath2];
NSArray *currencyArray = [dict objectForKey:@"CurrencyArrayKey"]; 
```

其中“CurrencyArrayKey”是您的 plist 中数组的键。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T22:23:11.617

通过将 plist 内容作为文本文件打开来检查它。

通过可视化编辑器创建的 Plist 由`dict`包含其余元素的 a 组成（我不清楚您是否包含字符串或带有字符串的数组）。

如果您看到一个字典，那么您的 plist 将正确反序列化为字典，而不是数组。

您也可以尝试使用：

```
 [NSDictionary dictionaryWithContentsOfFile:path]; 
```

# datanucleus - datanucleus jdo 扩展的详细而清晰的规范？

> ID：11253581
> 
> 赞同：2
> 
> 时间：2012-06-28T22:04:46.663
> 
> 标签：datanucleus

我找不到明确或详细的 datanucleus jdo 扩展规范。我想这是扩展页面： [http ://www.datanucleus.org/plugins/index.html](http://www.datanucleus.org/plugins/index.html)

我对么 ？我很困惑，因为这个页面是关于“插件”的，它们是指“扩展”吗？！

现在，即使在打开该页面之后，您似乎也必须通过每个链接才能找到所需的内容。即使我打开子页面，它也完全没有帮助！

非常感谢有关此主题的任何信息，非常感谢。

# node.js - NodeJS SAML 库

> ID：11253586
> 
> 赞同：10
> 
> 时间：2012-06-28T22:05:31.817
> 
> 标签：node.js, saml

NodeJS 是否有任何 SAML 库？似乎有大量可用于节点的代码，但没有 SAML 库。如果没有，有没有理由不这样做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-28T22:50:48.683

Node.js 仍然是一项新技术，主要用于实时创新的初创公司或企业。因此 SAML 在其中并不流行，您会在该领域发现更多的 OAuth。SAML 不是一个简单的实现规范（与 SWT 或 JWT 之类的东西相反）。最难的部分是数字签名，它需要 XML 规范化等。

几个月前，我写了一篇关于在 node.js 中使用 Windows Azure ACS（使用 WS-Federation 协议和 SimpleWebTokens）的文章

[http://nodeblog.cloudapp.net/using-windows-azure-access-control-service-acs-from-a-node-app](http://nodeblog.cloudapp.net/using-windows-azure-access-control-service-acs-from-a-node-app)

如果您有兴趣为 node.js 编写 SAML 库，请告诉我。我对此很感兴趣。

马蒂亚斯

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-05-17T17:17:14.517

还有这个npm包，我还没有使用或实现过，但看起来很有希望......

[https://www.npmjs.com/package/saml2-js](https://www.npmjs.com/package/saml2-js)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-03-03T03:40:52.183

这里有一个[http://github.com/leandrob/saml20](http://github.com/leandrob/saml20)

```
var saml = require('saml20');

var options = {
    publicKey: 'MIICDzCCAXygAwIBAgIQVWXAvbbQyI5Bc...',
    audince: 'http://myservice.com/'
}

saml.validate(rawAssertion, options, function(err, profile) {
    // err

    var claims = profile.claims; // Array of user attributes;
    var issuer = profile.issuer: // String Issuer name.
}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-04T08:47:51.147

我还没有真正尝试过，但这似乎是您正在寻找的： [https ://npmjs.org/package/passport-saml](https://npmjs.org/package/passport-saml)

它也是一种新的（它是在发布最后一个答案之后出现的）。

# google-app-engine - ndb 模型与 WTForms 的兼容性

> ID：11253588
> 
> 赞同：3
> 
> 时间：2012-06-28T22:05:53.097
> 
> 标签：google-app-engine, webapp2, wtforms, app-engine-ndb

技术堆栈：**ndb 模型**、**WTForms**、**webapp2** 我正在尝试将 WTForms 扩展用于 appengine db 模型。

我有一个简单的数据库架构：

```
class Autho(ndb.Models):
    name = db.StringProperty()

class Notes(ndb.Model):
    title = db.StringProperty()
    author = db.KeyProperty() 
```

然后是一个简单的表单定义表单 WTForms，在处理程序中根据他们的文档：

```
from wtforms.ext.appengine.db import model_form

def get(self, slug):
        form = model_form(Author)()
        self.render_template('form.html', {'form': form}) 
```

[这会在此处](https://bitbucket.org/simplecodes/wtforms/src/a5f9e30260cc/wtforms/ext/appengine/db.py)引发属性错误行 411 `props = model.properties()`

请让我知道，如果这可以解决。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T15:26:05.150

我从未使用过 WTForms，但它似乎与 NDB 不兼容——“model.properties()”是一个旧的 db 习语。也许 WTForms 作者会考虑添加对 NBD 的支持？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T17:09:35.900

看看这个：[https](https://github.com/coto/gae-boilerplate) ://github.com/coto/gae-boilerplate 。
这是一个 ndb 样板，具有接受联合登录的用户身份验证的基本（对我来说不是那么基本）实现。它彻底使用了 WTForms。创建它的人非常容易接触到，并且样板文件会不断维护和更新。值得一看，它对基本模式有很大帮助。

# php - 我应该如何完成我的评分脚本

> ID：11253592
> 
> 赞同：0
> 
> 时间：2012-06-28T22:06:02.220
> 
> 标签：php, javascript, html, rating-system

我的网页有一个表格，您可以在其中选择不同的项目。我希望能够让人们评价这些。我遇到了一个问题，我需要将一个 javascript 变量传递给 php，而从我在线阅读的内容来看，这并不是最简单的事情。你会如何建议我这样做？

代码存储在 98.214.131.200/index.php 和 98.214.131.200/ratings/ratings.php

目前我在 rating.php 中有函数允许我编写或读取评级，但我需要来自 javascript 的字符串来识别正在评级的项目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T22:15:21.303

您可以使用表单中的 POST 请求传递评级。

[http://www.tizag.com/phpT/forms.php/](http://www.tizag.com/phpT/forms.php/)

确保正确清理输入以避免 SQL 注入

[http://www.tizag.com/mysqlTutorial/mysql-php-sql-injection.php](http://www.tizag.com/mysqlTutorial/mysql-php-sql-injection.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T22:16:31.737

您可以使用 jquery，并在幕后传递信息。像这样的东西：

```
$.ajax({
  type: 'POST',
  url: "/your/processing/url/here.php",
  data: {rating_id: item_id, rating: 4},  // <-- set this dynamically with your item
  success: function()
  {
    // do something - success
  },
  dataType: dataType
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T22:09:57.660

`GET`您可以尝试直接在 URL中将评分作为变量传递。这样您就可以执行 ./ratings.php?rating=5&item=20，并在 PHP 中将这些值作为`$_GET['rating']`和`$_GET['item']`.

# jquery - 隐藏第 n 个元素之后的所有元素

> ID：11253596
> 
> 赞同：20
> 
> 时间：2012-06-28T22:06:19.760
> 
> 标签：jquery, html

找到第 4 个`<a>`元素后，我`.hide()`将如何休息？以下是我到目前为止编写的代码：

```
<script src="http://code.jquery.com/jquery-latest.js"></script>

<script>
    $(document).ready(function() {
        if($('a').length >= 4) {
            window.alert('4 or more');
        }
    });
</script>

<a>test </a><br>
<a>fed </a><br>
<a>fdes </a><br>
<a>grr </a><br>
<a>rerf </a><br>
<a>dferf </a> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-06-28T22:07:35.757

使用[:gt(index)](http://api.jquery.com/gt-selector/)选择器：

```
$('a:gt(3)').hide(); 
```

或者更快的[`slice`](http://api.jquery.com/slice/)功能：

```
$('a').slice(4).hide(); 
```

[**现场演示**](http://jsfiddle.net/PrFRP/)

> 因为**:gt()**是 jQuery 扩展而不是 CSS 规范的一部分，所以使用 :gt() 的查询不能利用原生 DOM querySelectorAll() 方法提供的性能提升。**为了在现代浏览器中获得更好的性能，请改用 $("your-pure-css-selector").slice(index) 。**

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-12-24T21:20:50.367

CSS 解决方案

```
ul li:nth-child(n+5) {  
    display: none
} 
```

[http://jsfiddle.net/mckanet/Sp6yE/](http://jsfiddle.net/mckanet/Sp6yE/)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-06-28T22:07:00.690

就如此容易：

```
$("a:gt(3)").hide(); 
```

**演示：http:** [//jsfiddle.net/gmrvK/](http://jsfiddle.net/gmrvK/)

# asp.net - 如何绘制动态html表格？表格内容应来自 WCF Web 服务

> ID：11253600
> 
> 赞同：0
> 
> 时间：2012-06-28T22:06:34.450
> 
> 标签：asp.net, wcf, html-table

我想在 html 页面上动态绘制表格。行数、列数、列名，所有这些数据都应该由 WCF Web 服务返回。1\. 我的网络服务如何序列化并返回这些数据？我在字典中有所有必需的数据。2.如何在html页面上渲染这样的动态表格？

我的 Web 服务将为我提供我只想在 aspx 或 html 页面上以表格格式表示的结果。我不会处理任何 SQL 数据库表或行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T23:20:19.550

从学习 WCF 的基础知识开始。这里有一些很棒的资源（包括视频）可以让你热身：http: [//msdn.microsoft.com/en-us/netframework/first-steps-with-wcf.aspx](http://msdn.microsoft.com/en-us/netframework/first-steps-with-wcf.aspx)

行数、列数、列名等听起来像您需要一个数据集（或数据表）。DataSet 是可序列化的，您可以从 wcf 服务中返回它们。 [http://msdn.microsoft.com/en-us/library/system.data.dataset.aspx](http://msdn.microsoft.com/en-us/library/system.data.dataset.aspx)

你说的是“网页”。你需要一个网络框架。在 .Net Asp.Net Web Forms 和 Asp.Net MVC3 中是您可以使用的一些框架示例。如果这只是一个页面，我建议使用一个简单的 aspx 页面（网络表单）。否则 MVC3 最适合。这里很好的介绍：http: [//www.w3schools.com/aspnet/aspnet_intro.asp](http://www.w3schools.com/aspnet/aspnet_intro.asp)

# java - OpenGL 旋转倾斜问题

> ID：11253614
> 
> 赞同：0
> 
> 时间：2012-06-28T22:07:38.097
> 
> 标签：java, opengl, transformation

我在 OpenGL 内部围绕 x 轴的任何旋转都有一点问题。我所拥有的是一个在着色器内部渲染的基本立方体，带有用于照明计算的法线。立方体的变换是投影矩阵乘以模型矩阵。这种连接是在着色器中完成的，而旋转和平移计算是在我编写的 Matrix 类中完成的。当围绕 y 轴进行任何旋转时，一切都按预期旋转，如下图所示：

![渲染结果](../Images/b18b9ba82af8208b6340cab4674cdf1f.png) ![渲染结果](../Images/0e51215940ccef08bef4ecfea459f436.png)

当围绕 x 轴发生任何旋转时，问题就开始了，如下所示：

![渲染结果](../Images/a270ca75eedcb903c72ca16edf6239d2.png) ![渲染结果](../Images/44ab134cfb3552888602226ade9220b2.png)

显然，x 轴旋转会扭曲场景并导致一切显示不成比例。这是每次渲染时计算矩阵并传递给着色器的代码：

```
glClear(GL_DEPTH_BUFFER_BIT | GL_COLOR_BUFFER_BIT);

viewMatrix.setIdentity();
viewMatrix.translate(new Vector4(translation));
viewMatrix.rotate(1, 0, 0, -rotateX);
viewMatrix.rotate(0, 1, 0, rotateY);
Matrix4 mvMatrix = new Matrix4(viewMatrix);

Matrix4 pMatrix = new Matrix4(projectionMatrix);

lightShader.useShader();        
lightShader.setUniformVector("vColor", new Vector4(.4f,0,0,1f));
lightShader.setUniformMatrix("mvMatrix", mvMatrix);
lightShader.setUniformMatrix("pMatrix", pMatrix);
triangleBatch.draw(lightShader.getAttributes());

Display.update(); 
```

着色器代码如下：

```
uniform mat4 mvMatrix;
uniform mat4 pMatrix;
uniform vec4 vColor;
varying vec4 outFragColor;
attribute vec4 inVertex;
attribute vec4 inNormal;
void main(void) { 
    vec3 newNorm = vec3(inNormal);
    mat3 mNormalMatrix;
    mNormalMatrix[0] = mvMatrix[0].xyz;
    mNormalMatrix[1] = mvMatrix[1].xyz;
    mNormalMatrix[2] = mvMatrix[2].xyz;
    vec3 vNorm = normalize(mNormalMatrix * newNorm);
    vec3 vLightDir = vec3(0.0, 0.0, 1.0); 
    float fDot = max(0.0, dot(vNorm, vLightDir)); 
    outFragColor.rgb = vColor.rgb * fDot;
    outFragColor.a = vColor.a;
    mat4 mvpMatrix;
    mvpMatrix = pMatrix * mvMatrix;
    gl_Position = mvpMatrix * inVertex; 
} 
```

最后，旋转的矩阵数学代码如下：

```
public Matrix4 rotate(Vector4 a, float radians){
    Matrix4 temp = new Matrix4().setToRotate(a, radians);
    this.multiply(temp);
    return this;
}

public Matrix4 setToRotate(Vector4 a, float radians){
    a = new Vector4(a).normalise();
    float c = GameMath.cos(radians);
    float s = GameMath.sin(radians);
    float t = 1-c;
    float x = a.x;
    float y = a.y;
    float z = a.z;
    float x2 = a.x*a.x;
    float y2 = a.y*a.y;
    float z2 = a.z*a.z;
    this.setIdentity();
    this.matrix[0] = c + t*x2;
    this.matrix[1] = t*x*y + s*z;
    this.matrix[2] = t*x*z - s*y;
    this.matrix[4] = t*x*y - s*z;
    this.matrix[5] = c + t*y2;
    this.matrix[6] = t*y*z + s*x;
    this.matrix[8] = t*x*z + s*y;
    this.matrix[9] = t*y*z + s*x;
    this.matrix[10] = c + t*z2;
    return this;
} 
```

矩阵存储在主要列中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T02:18:46.660

我发现了问题所在。显然 setToRotate() 中的一项操作需要从加法更改为减法。它现在按预期工作。

# git - Git：管理和构建项目的工具？

> ID：11253615
> 
> 赞同：0
> 
> 时间：2012-06-28T22:07:38.903
> 
> 标签：git, maven, version-control

我想学习项目设计和构建 Git 存储库。[这里](http://maven.apache.org/what-is-maven.html)有用于 Java 项目的 Maven 等工具，但找不到任何用于 Git 的工具。Maven 线程看起来质量很差，除了[这里](https://stackoverflow.com/questions/16829/structure-of-projects-in-version-control)的这个——警告质量差的线程：[这里](https://stackoverflow.com/questions/1621099/integrating-maven-non-maven-projects)、[这里](https://stackoverflow.com/questions/1893469/could-free-pascal-benefit-of-something-like-apache-maven)、[这里](https://stackoverflow.com/questions/4015036/maven-support-for-android-projects)、[这里](https://stackoverflow.com/questions/7881157/using-maven-for-r-projects)——Y（更多）。所以我肯定想用别的东西！

**帮助问题**

> 1.  项目应该如何设计？
> 2.  像 Maven 之类的非 Java 项目？
> 3.  我真的需要像 Maven 这样的东西来设计一个项目吗？
> 4.  是否存在使用 Git 管理非 Java 项目的工具？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-19T16:22:03.447

还没有，但也许很快！如果您需要协作，您可以通过将适当的工作流工具与一些社交工具相结合来解决问题。如果您一个人做事，请选择 Workflow -tools。

**工作流工具**

> *   Git 的子模块
>     
>     
> *   Gitslave 最大限度地减少重复命令的数量，更多信息请[点击此处](https://stackoverflow.com/a/12027861/164148)。
>     
>     
> *   Git-subtree 可能会帮助您替换一些子模块，更多内容请[点击此处](https://github.com/git/git/tree/master/contrib/subtree)。

**社交工具**

> *   石榴石。现在有两种不同的权限：基本的 *ix 权限和由管理器定义的 Gitolite 权限，例如提交权限和克隆存储库的权限。
>     
>     
> *   Gerrit -code-review -project[这里](http://code.google.com/p/gerrit/)模糊了经理和开发人员之间的界限，截图 [在这里](http://gerrit-documentation.googlecode.com/svn/Documentation/2.4.2/intro-quick.html#_manually_verifying_the_change)。它看起来有一些类似于 Bitbucket.org 和 Github.com 的功能，例如验证提交——尽管 Bitbucket 使用“拇指”来实现这一点，本质上是相同的。

**也许相关**

> 1.  [Git：如何避免重复提交 sub-sub-sub... Git -repos？](https://stackoverflow.com/questions/10068119/avoid-repetitive-committing-with-sub-sub-sub-git-repos)
>     
>     
> 2.  [使用带有子存储库和子模块的深层 Git 存储库-存储库-tree 更改权限？](https://stackoverflow.com/questions/10790634/changing-permissions-with-deep-git-repository-repository-tree-with-sub-repos-an)
>     
>     
> 3.  [我如何托管 Git 存储库并自己管理我的内容托管？](https://stackoverflow.com/questions/11007679/how-can-i-host-git-repositories-and-manage-my-content-hosting-myself)

# firefox - 分析 Firefox 插件

> ID：11253624
> 
> 赞同：3
> 
> 时间：2012-06-28T22:08:17.683
> 
> 标签：firefox, firefox-addon, profiling

关于用于分析用 Javascript 编写的 Firefox 插件的工具有什么建议吗？希望能与最新的 Firefox 一起使用。

在这个主题上，关于用于调试 Firefox 插件的工具有什么建议吗？Chromebug 不再维护。

# java - 转换线的结束坐标的函数

> ID：11253626
> 
> 赞同：5
> 
> 时间：2012-06-28T22:08:25.983
> 
> 标签：java, android, math, geometry, algebra

我在一条线的末端有两个点。
我需要得到这条线的翻译的结束坐标。
平移将是一条平行线，与原始线的距离为 d。
这是我需要的图像：

![在此处输入图像描述](../Images/31466efef1c6531655a9880e44659625.png)

所以我需要一个函数，我可以传递这两个点和距离并在返回中获取两个新坐标。
我一直在这个问题上停留了一段时间。任何帮助将不胜感激！
谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T22:13:31.750

新坐标将是结果向量

> 距离**d**乘以它正在移动的方向的**归一化向量，添加到****原始向量**点。

**编辑：**

给定直线的两个点，您将需要计算连接这些点的向量的法线。[这方面的信息在这里..](https://stackoverflow.com/questions/1243614/how-do-i-calculate-the-normal-vector-of-a-line-segment)

**标准化**这个向量，乘以**d**，添加到每个**点**。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-28T22:20:56.743

计算向量 (x2-x1,y2-y1)。这是您的直线方向的矢量。一个法线向量由下式给出

```
 (-(y2-y1),-(x2-x1)) = (y1-y2,x1-x2). 
```

将此向量除以其大小，得到所需方向的单位向量

```
 A = (y1-y2,x1-x2)/|(y1-y2,x1-x2)| 
```

现在给定您的距离，`d`您的翻译点将由

```
 NewPoint = OldPoint + d * A 
```

# javascript - 如何访问maven项目中的资源？

> ID：11253628
> 
> 赞同：0
> 
> 时间：2012-06-28T22:08:59.797
> 
> 标签：javascript, web-applications, maven

我有一个纯 JavaScript webapp mavin 项目，我需要通过函数从资源文件夹中加载一个 xml 文件：

```
function loadXMLDoc(dname) {
var xhttp;
if (window.XMLHttpRequest) {
  xhttp=new XMLHttpRequest();
  }
else {
  xhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xhttp.open("GET",dname,false);
xhttp.send(null);
return xhttp.responseXML;
} 
```

其中 'dname' 是表示 xml 文件路径的字符串。

这个函数在我的源文件（src/main/javascript）中，我想从资源文件夹（src/main/resources）中获取 xml。最好的方法是什么？我应该以某种方式修改 pom.xml 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T23:32:45.303

正在使用什么包装/插件来构建项目。是Codehaus的[Javascript Maven 工具插件吗？](http://mojo.codehaus.org/javascript-maven-tools/)

如果是这样，则将资源写入`${project.build.outputDirectory}`（默认为目标/类）并将 javascript 文件写入`${project.build.outputDirectory}/js`. 因此，相对于您的 JS 文件，资源位于`../<resourcename>`.

这些设置由[js-import-maven-plugin](http://mojo.codehaus.org/js-import-maven-plugin/)控制，该插件在构建期间从 Javascript Maven 工具插件调用。

# powershell - Powershell：显示哪些组被添加到一组文件夹中？

> ID：11253632
> 
> 赞同：1
> 
> 时间：2012-06-28T22:09:10.733
> 
> 标签：powershell, permissions, active-directory, active-directory-group

我花了一些时间在这里搜索类似的问题，看看我是否能找到一些答案，但我对 AD 一无所知，以至于我什至不知道如何判断我是否找到了我正在寻找的东西......

我在一个地方有许多文件夹。所有这些文件夹的名称都类似：

```
Reports_January_2011  
Reports_March_2012  
Reports_March_2012 
```

所有这些文件夹都有一对同名的子文件夹：

```
Export
Raw 
```

我需要查看在这些文件夹中配置了任何权限的所有组。基本上，在过去的 5 年里，我每个月都有一个 Reports 文件夹，每个文件夹都有两个子文件夹。我需要确保他们都添加了正确的组。

我开始试图找出正则表达式来只选择正确的报告文件夹，但我完全不知道从哪里开始脚本的“获取组”部分。我对 PS 的经验仅限于批量重命名、移动等。简单的一行内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T08:00:03.913

你可以尝试这样的事情：

```
dir c:\ | ? { $_.psiscontainer } |`
Get-Acl  | fl -property @{n="Path";E={ convert-path $_.pspath}}, @{N="AccessList";`
E={ $_.AccessToString -split '\n' | ? { $_.startswith("MyDomain") }}; } 
```

有一个包含路径和访问列表的列表。删除 las 管道也列出了本地用户

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T07:14:36.270

有一个不错的 PowerShell[模块（文件系统安全 PowerShell 模块 1.3）](http://gallery.technet.microsoft.com/1abd77a5-9c0b-4a2b-acef-90dbb2b84e85)可以让您的生活更轻松。使用该模块后，您可以使用 Get-Ace cmdlet 使用如下命令列出文件的权限：

```
Get-Item F:\backup | Get-Ace | Where-Object { $_.ID -like "*users*" } 
```

看看它。

# c# - 将我的描述字段限制为 300 字

> ID：11253634
> 
> 赞同：0
> 
> 时间：2012-06-28T22:09:19.537
> 
> 标签：c#, linq, lambda

我有下面的代码片段，它的所有工作，并引入了我想要的数据，但它为我的搜索结果带来了太多的数据。我想把它分解成300字。我找到了需要附加到描述字段的代码，但我不确定如何执行此操作。我相信前 300 个单词的代码是

`Split(' ').Take(300).Aggregate((a, b) => a + " " + b);`

我正在使用的 linq 代码如下：

```
 searchResults.DataSource = from r in response.Results
                               select new
                               {
                                   Title = r[SearchContentProperty.Title],
                                   Summary = r[SearchContentProperty.HighlightedSummary],
                                   Id = r[SearchContentProperty.Id] * 10,
                                   Quicklink = r[SearchContentProperty.QuickLink],
                                   Description = r[SearchContentProperty.Description]
                               }; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T22:15:51.897

怎么样

```
searchResults.DataSource = from r in response.Results
                           select new
                           {
                               Title = r[SearchContentProperty.Title],
                               Summary = r[SearchContentProperty.HighlightedSummary],
                               Id = r[SearchContentProperty.Id] * 10,
                               Quicklink = r[SearchContentProperty.QuickLink],
                               Description = r[SearchContentProperty.Description].ToString().Split(' ').Take(300).Aggregate((a, b) => a + " " + b);
                           }; 
```

# android - Android SDK 不显示正确的菜单

> ID：11253645
> 
> 赞同：0
> 
> 时间：2012-06-28T22:10:34.123
> 
> 标签：android

我在 2 台 PC 上安装了 Manager，在第一台上一切正常，但在另一台上我得到了这个菜单（第一个带有 HTC OpenSense 和其他垃圾的图像是我不想要的那个）。如何解决？我重装了几次，还是不行。

第一个是错误的，第二个是好的。

![错了一个](../Images/4667ca3f5101215c00ef46238f039e8d.png)

![好一个](../Images/3ad998167f778dddfe7173654ac4002a.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T23:17:44.853

当您尝试重新安装 SDK 时，您是一遍又一遍地运行安装程序，还是先卸载 SDK 并在重新安装之前删除 Windows 用户目录中的 .Android 文件夹？如果您没有尝试在重新安装之前先从您的机器中清除 SDK 文件，我建议您尝试一下。

# netbeans - 查找 NetBeans IDE 使用的命令和选项

> ID：11253647
> 
> 赞同：0
> 
> 时间：2012-06-28T22:10:56.427
> 
> 标签：netbeans, netbeans-7

我正在使用 NetBeans 7.x IDE。我有一个 Netbeans 应用程序模块。我使用 IDE 中的 Build 和 Run 按钮。当我按下 Run Project 或 F6 按钮时，模块运行得很好。我喜欢从命令行运行它。由于一切都是为我自动构建的，我不知道东西在哪里或如何运行它。在 project/build/public-package-jars 中有几个 jar 文件。有没有办法查看 Run Project 正在使用哪些命令和选项？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T00:04:37.063

在命令行上转到应用程序的根目录（或任何有`build.xml`文件的地方）并运行`ant -p`. 这将列出用于构建和运行应用程序的所有可用选项。

# java - 使用 JMX MBean，如何在 JConsole 中自定义通知字段

> ID：11253649
> 
> 赞同：1
> 
> 时间：2012-06-28T22:11:08.883
> 
> 标签：java, jmx, jconsole, mbeans

围绕这个主题进行谷歌搜索后，我没有找到太多关于 JMX Mbean 通知的信息。

*   官方文档：[http ://docs.oracle.com/javase/tutorial/jmx/notifs/index.html](http://docs.oracle.com/javase/tutorial/jmx/notifs/index.html)
*   旧文档（2002）：[http ://www.informit.com/articles/article.aspx?p=27842&seqNum=5](http://www.informit.com/articles/article.aspx?p=27842&seqNum=5)

我已经使用**NotificationBroadcasterSupport**类设置了一个 MBean。当我发送**通知**时，我可以在 JConsole 中看到默认字段：“ *TimeStamp* ”、“ *Type* ”、“ *UserData* ”、“ *SeqNum* ”、“ *Message* ”、“ *Event* ”和“ *Source* ”

在 Jconsole 通知缓冲区输出中，我想配置字段：

*   是否可以隐藏某些字段？
*   是否可以添加新字段？
*   排序似乎在列中不可用。有没有办法做到这一点？

我的目标是提供有关操作的统计信息（每次触发操作时，我都想打印时间戳、执行时间……），但我不想在字符串消息中漂亮地打印所有这些信息。也许有更好的方法来做到这一点？

# android - AsyncTask DoInBackGround 返回类型

> ID：11253651
> 
> 赞同：1
> 
> 时间：2012-06-28T22:11:17.373
> 
> 标签：android, xamarin.android

我知道在 Java 中您可以指定 AsyncTask 类的 DoInBackground 覆盖的返回类型，但在 MonoDroid 中它似乎只允许 Object 返回类型。如果我希望它返回一个纯 ole' 字符串以用于处理 OnPostExecute 怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T22:24:12.170

好吧，因为`String`extends `Object`，您可以返回 a `String`，然后在收到它时强制返回。

```
public Object a() {

    return "this";
}

public void b() {

    Log.e((String)a(),(String)a());

} 
```

这编译并运行

# scala - Scala 中的配置数据——我应该使用 Reader monad 吗？

> ID：11253653
> 
> 赞同：33
> 
> 时间：2012-06-28T22:11:20.183
> 
> 标签：scala, configuration, monads, reader-monad

如何在 Scala 中创建功能正确的可配置对象？我在`Reader`monad 上看过 Tony Morris 的视频，但我仍然无法连接这些点。

我有一个硬编码的`Client`对象列表：

```
class Client(name : String, age : Int){ /* etc */}

object Client{
  //Horrible!
  val clients  = List(Client("Bob", 20), Client("Cindy", 30))
} 
```

我想`Client.clients`在运行时确定，可以灵活地从属性文件或数据库中读取它。在 Java 世界中，我会定义一个接口，实现两种类型的源代码，并使用 DI 分配一个类变量：

```
trait ConfigSource { 
  def clients : List[Client]
}

object ConfigFileSource extends ConfigSource {
  override def clients = buildClientsFromProperties(Properties("clients.properties"))  
  //...etc, read properties files 
}

object DatabaseSource extends ConfigSource { /* etc */ }

object Client {
  @Resource("configuration_source") 
  private var config : ConfigSource = _ //Inject it at runtime  

  val clients = config.clients 
} 
```

这对我来说似乎是一个非常干净的解决方案（代码不多，意图明确），但这`var` *确实*跳出来了（OTOH，在我看来这并不麻烦，因为我知道它*只会**被*注入一次-一次）。

在这种情况下，monad会是什么样`Reader`子，像我 5 岁一样向我解释，它有什么优势？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-06-29T03:41:15.460

让我们从你的方法和方法之间的一个简单的、肤浅的区别开始`Reader`，那就是你不再需要坚持`config`任何地方。假设您定义了以下模糊巧妙的类型同义词：

```
type Configured[A] = ConfigSource => A 
```

现在，如果我需要`ConfigSource`某个函数，比如说一个获取列表中第*n*个客户端的函数，我可以将该函数声明为“已配置”：

```
def nthClient(n: Int): Configured[Client] = {
  config => config.clients(n)
} 
```

因此，我们基本上是在无中生有的`config`情况下，在我们需要的任何时候！闻起来像依赖注入，对吧？现在假设我们想要列表中第一个、第二个和第三个客户的年龄（假设它们存在）：

```
def ages: Configured[(Int, Int, Int)] =
  for {
    a0 <- nthClient(0)
    a1 <- nthClient(1)
    a2 <- nthClient(2)
  } yield (a0.age, a1.age, a2.age) 
```

为此，当然，您需要对`map`和进行一些适当的定义`flatMap`。我不会在这里深入讨论，只是简单地说 Scalaz（或[Rúnar 的精彩 NEScala 演讲](http://www.youtube.com/watch?v=ZasXwtTRkio)，或您已经看过[的 Tony 的演讲）为您提供了所需的一切。](http://vimeo.com/20674558)

这里重要的一点是`ConfigSource`依赖及其所谓的注入大多是隐藏的。我们在这里可以看到的唯一“提示”`ages`是 type`Configured[(Int, Int, Int)]`而不是 simple `(Int, Int, Int)`。我们不需要在`config`任何地方显式引用。

> > **顺便说一句**，这是我几乎总是喜欢考虑 monad 的方式：它们**隐藏了它们的效果**，因此它不会污染你的代码流，同时在类型签名中**明确声明效果。**换句话说，你不必过多地重复自己：你在函数的返回类型中说“嘿，这个函数处理*效果 X* ”，不要再搞砸了。
> > 
> > 在这个例子中，效果当然是从某个固定的环境中读取。您可能熟悉的另一个一元效应包括错误处理：我们可以说它`Option`隐藏了错误处理逻辑，同时在您的方法类型中明确显示错误的可能性。或者，与阅读相反，`Writer`monad 隐藏了我们正在写入的内容，同时在类型系统中显式地显示了它的存在。

最后，正如我们通常需要引导一个 DI 框架（在我们通常的控制流之外的某个地方，例如在 XML 文件中），我们也需要引导这个奇怪的 monad。当然，我们的代码会有一些逻辑入口点，例如：

```
def run: Configured[Unit] = // ... 
```

它最终变得非常简单：因为`Configured[A]`它只是 function 的类型同义词`ConfigSource => A`，我们可以将 function 应用于它的“环境”：

```
run(ConfigFileSource)
// or
run(DatabaseSource) 
```

达达！因此，与传统的 Java 风格的 DI 方法相比，这里没有任何“魔法”发生。可以说，唯一的魔法封装在我们类型的定义中，`Configured`以及它作为 monad 的行为方式。最重要**的是，类型系统让我们诚实地**知道发生在哪个“领域”依赖注入：任何有类型的东西`Configured[...]`都在 DI 世界中，而没有它的东西则不是。我们根本无法在老式 DI 中实现这一点，在这种情况下，*一切*都可能由魔法管理，因此您并不真正知道代码的哪些部分可以安全地在 DI 框架之外重用（例如，在您的单元内）测试，或完全在其他项目中）。

* * *

**更新：**我写了一篇[博](http://mergeconflict.com/reading-your-future)`Reader`文，更详细地解释了。

# .net - Visual Studio 断点栏不存在（字形边距、概览标尺）

> ID：11253654
> 
> 赞同：13
> 
> 时间：2012-06-28T22:11:31.247
> 
> 标签：.net, visual-studio, visual-studio-code, vscode-debugger, code-editor

所以我敲击了一些奇怪的按键组合，现在我的视觉工作室看起来都被顶起来了，我不知道如何将它自定义回原来的样子。我用谷歌搜索了很多，我似乎无法找到解决所有问题的地方。

几周来一直困扰我的只是代码编辑器。我想你们中的一些人可能会有所帮助。

它看起来像这样： ![Visual Studio 代码窗口搞砸了](../Images/de8f8200c72ab463711d2ea0eeea217a.png)

我只是想让代码前面的那些乱七八糟的行消失，并且能够单击编号行的左侧以再次获得断点。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-06-28T22:26:51.300

1.  转到*工具*→*选项*→*文本编辑器*→*常规*
2.  检查*指标保证金*

![在此处输入图像描述](../Images/b2353f5c623b765bb2b066588e87be0a.png)

不过，我不确定您的意思是什么»代码前面的行«。如果您指的是黄色的*未保存更改*指示器，那就是上面选项中的*选择边距*。如果您指的是点（代表空格），则*编辑*→*高级*→*查看空白*或按`Ctrl`+ `E`, `S`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-28T22:30:54.097

> 工具 -> 选项 -> 文本编辑器 -> 指示标记（用于边界断点）
> 
> 工具 -> 选项 -> 文本编辑器 -> 所有语言 -> 行号（用于行号）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-06-16T21:04:44.210

对于**Visual Studio Code**（又名**VSCode**），以及我多年后
几乎完全相同的问题（而我误解了
设置描述），我找到了类似但不同的答案：

**在设置**GUI中启用它，如下所示：

> Editor: **Glyph Margin**
> 控制编辑器是否应该渲染垂直字形边距。字形边距主要用于调试。

*或在***settings.json**中编写等效于以下内容：

```
 "editor.glyphMargin": true, 
```

# php - 从用户存储在 html 中的数据中去除 html 标签

> ID：11253656
> 
> 赞同：-2
> 
> 时间：2012-06-28T22:11:37.203
> 
> 标签：php

我正在做项目，在主页上我们显示用户的详细信息，每个用户自己更新它的详细信息，我们还允许详细的 HTML 标签。

但我面临的问题是，如果人们添加一些 HTML 细节，比如

```
<p><span style="color:#4c4c4c;font-family:Verdana;">Graphic Designer. Contact ***** .</span></p> 
```

但是在索引页面上，我们显示的细节很少，它来到了这样的主页

```
<p><span style="color:#4c4c4c;font-family:Verda 
```

这扰乱了主页的所有结构。

我试过PHP函数

```
strip_tags 
```

这对我不起作用，我还编写了自己的函数来去除主页上的这些标签

```
function strip_html_tags( $text )
{
    $text = preg_replace(
        array(
          // Remove invisible content
            '@<head[^>]*?>.*?</head>@siu',
            '@<style[^>]*?>.*?</style>@siu',
            '@<script[^>]*?.*?</script>@siu',
            '@<object[^>]*?.*?</object>@siu',
            '@<embed[^>]*?.*?</embed>@siu',
            '@<applet[^>]*?.*?</applet>@siu',
            '@<noframes[^>]*?.*?</noframes>@siu',
            '@<noscript[^>]*?.*?</noscript>@siu',
            '@<noembed[^>]*?.*?</noembed>@siu',

            '@</?((address)|(blockquote)|(center)|(del))@iu',
            '@</?((div)|(h[1-9])|(ins)|(isindex)|(p)|(pre))@iu',
            '@</?((dir)|(dl)|(dt)|(dd)|(li)|(menu)|(ol)|(ul))@iu',
            '@</?((table)|(th)|(td)|(caption))@iu',
            '@</?((form)|(button)|(fieldset)|(legend)|(input))@iu',
            '@</?((label)|(select)|(optgroup)|(option)|(textarea))@iu',
            '@</?((frameset)|(frame)|(iframe))@iu',
        ),
        array(
            ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ',"$0", "$0", "$0", "$0", "$0", "$0","$0", "$0",), $text );

    return strip_tags( $text);
} 
```

这也没有用。

我需要的是：剥离所有 html 标签以便在主页上正确显示。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T22:13:56.607

[`strip_tags()`](http://us3.php.net/manual/en/function.strip-tags.php)内置在 PHP 中

[HTML Purifier](http://htmlpurifier.org/)是更强大的解决方案

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T22:16:48.187

您是否考虑过简单地使用`html_entities()`？这将 '<' 替换为 '<' 和 '>' 和 '>' 除其他事项外。它允许您将其回显到页面，而不必过多担心它会干扰页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T22:19:48.337

您的个人信息不只是保存为实体而不是纯文本吗？这可以解释为什么 strip_tags 不起作用。

在这种情况下，使用：[html_entity_decode](http://www.php.net/manual/en/function.html-entity-decode.php)来显示实际的 HTML

# http - Javascript未完全下载

> ID：11253659
> 
> 赞同：2
> 
> 时间：2012-06-28T22:11:50.940
> 
> 标签：http, networking, corrupt

好的，这可能比编程更像是一个网络问题，但我不太确定这里发生了什么：

我的网站出现间歇性问题，我只下载了部分 javascript 文档。间歇性是指在同一个浏览器（在这种情况下为 Safari）上，我可以在浏览器中查看该 javascript 文件并刷新页面，但仍然只能看到部分下载的文件，但另一个浏览器（Chrome）我看到文件已正确下载. 清除浏览器缓存也没有效果。

奇怪的是，它似乎是特定于位置的，因为当我在家中检查网站时，仍然使用 Safari，我的问题为零。这个问题似乎也与机器无关，因为我偶尔也会在我的 iPad 上遇到相同的 javascript 错误（在同一网络上工作时）。

我 100% 确定这不是语法错误或 javascript 的任何内容，因为最常失败的文件是 jQuery 的缩小副本（从他们的网站下载，但托管在我的网站服务器上）

我已经尝试关闭 mod_deflate，因为它可能是导致问题的压缩，但这没有效果。

我已经与我端和托管服务器端的网络管理员进行了交谈，他们声称他们的网络没有任何问题，尽管他们可能只是转移了一个复杂的问题。

关于如何缩小问题范围的任何想法？

# ssh - 无法从家里 ssh 到学校服务器

> ID：11253661
> 
> 赞同：-1
> 
> 时间：2012-06-28T22:12:12.190
> 
> 标签：ssh

我一直在 Ubuntu 终端中使用 ssh 到我的学校服务器做作业，但不知何故这不再起作用了，我确信这不是由学校服务器引起的，因为我可以在其他地方通过 ssh 连接到它。这是我使用`ssh -v blah@linux.student.cs.ublah.ca` -v 标签的命令行给出以下输出

```
OpenSSH_5.5p1 Debian-4ubuntu4, OpenSSL 0.9.8o 01 Jun 2010
debug1: Reading configuration data /etc/ssh/ssh_config
debug1: Applying options for *
debug1: Connecting to linux.student.cs.uwaterloo.ca [129.97.167.126] port 22.
debug1: Connection established.
debug1: identity file /home/cs136/.ssh/id_rsa type -1
debug1: identity file /home/cs136/.ssh/id_rsa-cert type -1
debug1: identity file /home/cs136/.ssh/id_dsa type -1
debug1: identity file /home/cs136/.ssh/id_dsa-cert type -1
debug1: Remote protocol version 2.0, remote software version OpenSSH_5.5p1 Debian-
4ubuntu6local2
debug1: match: OpenSSH_5.5p1 Debian-4ubuntu6local2 pat OpenSSH*
debug1: Enabling compatibility mode for protocol 2.0
debug1: Local version string SSH-2.0-OpenSSH_5.5p1 Debian-4ubuntu4
debug1: SSH2_MSG_KEXINIT sent
debug1: SSH2_MSG_KEXINIT received
debug1: kex: server->client aes128-ctr hmac-md5 none
debug1: kex: client->server aes128-ctr hmac-md5 none
debug1: SSH2_MSG_KEX_DH_GEX_REQUEST(1024<1024<8192) sent
debug1: expecting SSH2_MSG_KEX_DH_GEX_GROUP
debug1: SSH2_MSG_KEX_DH_GEX_INIT sent
debug1: expecting SSH2_MSG_KEX_DH_GEX_REPLY
debug1: Host 'linux.student.cs.uwaterloo.ca' is known and matches the RSA host key.
debug1: Found key in /home/cs136/.ssh/known_hosts:1
debug1: ssh_rsa_verify: signature correct
debug1: SSH2_MSG_NEWKEYS sent
debug1: expecting SSH2_MSG_NEWKEYS
debug1: SSH2_MSG_NEWKEYS received
debug1: Roaming not allowed by server
debug1: SSH2_MSG_SERVICE_REQUEST sent
debug1: SSH2_MSG_SERVICE_ACCEPT received
Connection closed by 129.97.167.126 
```

任何人都可以告诉什么是错的？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T22:19:33.290

检查您的`~/.ssh`目录的权限

请参阅[http://boardreader.com/thread/SSH_Roaming_not_allowed_by_server_b1ltXnjn.html](http://boardreader.com/thread/SSH_Roaming_not_allowed_by_server_b1ltXnjn.html)

# php - 有没有一种简单的方法来获取和操作嵌套 带有 php 的标签

> ID：11253664
> 
> 赞同：1
> 
> 时间：2012-06-28T22:12:34.503
> 
> 标签：php, parsing, html-parsing, getelementbyid, getelementsbytagname

首先，我对 PHP 的了解远非如此——对它只有基本的了解，但我正在寻找一种使用 php 操作嵌套 div 内容的方法。这是当地非营利食品银行的基本网站，允许他们为客户发布活动。

例如，我要解析和使用的文件具有这种结构（认为这是完整的文件，尽管在任何时间点可能有超过 2 个条目）：

```
<div class="event">
 <div class="eventTitle">title text</div>
 <div class="eventContent">event content</div>
</div>

<div class="event">
 <div class="eventTitle">title2</div>
 <div class="eventContent">event content2</div>
</div> 
```

我的想法是解析它（最好的方法是什么？），并构建一个包含 class="event" 的所有 div 的多维数组，以及每个 div 的嵌套内容。然而，到目前为止，我所有的尝试都以失败告终。

这样做的重点是允许用户（非技术食品银行管理员）添加、编辑和删除这些结构。我有代码可以添加结构 - 但不确定我将如何在以后重新打开文件，然后编辑和/或删除“事件”div的选择实例及其嵌套内容。看起来这应该是一件容易的事，但我就是无法围绕我在网上找到的搜索结果。

我用 preg_match()、getElementById() 和 getElementByTagName() 尝试了一些东西。我真的很想帮助这个组织，但我不得不听从我的强者的意见，以寻求如何解决手头任务的建议。

提前致谢。

澄清：这是针对他们的网站，由提供商托管在外部服务上，该提供商不允许他们托管数据库或提供对服务器的 ftp/sftp/ssh 访问以进行定期维护。该计划是让网站在那里一次，然后从那时起，通过一个不安全的（此时没有其他选项）url 对其进行维护。

谁能提供一个示例 php 语法来解析上述 html 并创建一个 div 标签的多维数组？正如我所提到的，我试图通过自己的方式来解决它，但没有成功。我知道我需要做什么，我只是迷失在语法中。

IE：这就是我想出的办法，但它似乎不起作用，而且我对 php 的理解不够深入，无法准确理解为什么它不起作用。

```
 <?php 

        $doc = new DOMDocument();
        $doc->load('events.php');  
        $events = array();
            foreach ($doc->getElementsByTagName('div') as $node) {  
            // looks at each <div> tag and creates an array from the other named tags below // hopefully...
                $edetails = array ( 
                'title' => $node->getElementsByTagName('eventTitle')->item(0)->nodeValue,
                'desc' => $node->getElementsByTagName('eventContent')->item(0)->nodeValue
                );
                array_push($events, $edetails);
            } 

            foreach  ($events as &$edetails) { 
            // walk through the $events array and write out the appropriate information.
                echo $edetails['title'] . "<br>";
                echo $edetails['desc'] . "<br>";
        }
print_r($events); // this is currently empty and not being populated
    ?> 
```

错误：PHP 警告：DOMDocument::load(): Extra content at the end in the document in /var/www/html/events.php, line: 7 in /var/www/html/test.php on line 4

现在看这个，我意识到这永远不会起作用，因为它正在寻找名为 eventTitle 和 eventContent 的标签，而不是类。:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T00:11:40.877

我会使用“数据库”，无论是 sqlite 数据库还是简单的文本文件（似乎足以满足您的需要），并使用 php 脚本来操作该文件并构建所需的 html 来管理文本/数据库文件并显示内容.

这比使用 DOM 操作来添加/编辑/删除事件要容易得多。

顺便说一句，我可能会寻找赞助商，找一个像样的托管服务提供商并使用一个真实的数据库......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T16:16:13.603

如果您想继续使用您拥有的“php”文件（我认为这不必要的复杂），您当前代码失败的原因是：

1) DOMDocument 的 load() 方法是为 XML 设计的，需要格式良好的文件。解决此问题的方法是使用 loadHTMLFile() 方法，或者将所有内容包装在父元素中。

2）循环失败，因为 getElementsByTagName() 正在寻找标签 - 所以最外面的循环在当前示例中获得 6 个不同的 div（父事件，子事件标题和事件内容）

3) 内部循环当然会失败，因为您再次使用 getElementsByTagName()。请注意，标签名称仍然是 'div'；您真正尝试/想要搜索的是“类”属性的值。理论上，您可以通过使用诸如 hasChildNodes() 和/或 getAttribute() 之类的东西放入大量逻辑来解决此问题。

或者，您可以使用有效的 XML 进行重组，而不是您尝试使用的这种奇怪的混合 - 如果您这样做，您可以使用 DOMDocument 写出文件并读取它。除非您想学习如何使用 PHP DOM 库和 XML，否则可能有点矫枉过正。

正如其他人所提到的，我会将 events.php 的格式更改为除了一堆 div 之外的东西。由于数据库不是一个选项，我可能会选择一个管道分隔文件，例如：

```
title text|event content
title2|event content2 
```

解析这个的代码会简单得多，类似于：

```
<?php 
    $events = array();
    $filename = 'events.txt';
    if (file_exists($filename)) {
        $lines = file($filename);
        foreach ($lines as $line) {
            list($title, $desc) = explode('|', $line);
            $event = array('title'=>$title, 'desc'=>$desc);
            $events[] = $event; //better way of adding one element to an array than array_push (http://php.net/manual/en/function.array-push.php)
        }
    }
    print_r($events); 
?> 
```

请注意，此代码将整个文件读入内存，因此如果它们有太多事件或超长描述，这可能会变得笨拙，但对于数百甚至数千个事件左右应该可以正常工作。

# python - 逐行比较文件是否相同，如果相同则输出它们

> ID：11253667
> 
> 赞同：1
> 
> 时间：2012-06-28T22:12:52.173
> 
> 标签：python, slider, analytics, match, string-matching

我将如何解决这个问题，我有一些文件，我已经在其中对信息进行了排序，我想将该文件中的某个索引与另一个文件中的索引进行比较，一个问题是文件非常大，有数百万行。我想逐行比较我拥有的文件，如果它们匹配，我想使用索引方法输入这两个值以及其他值。

========================

让我澄清一下，我想说 line[x] x 将保持不变，因为它是统一格式化的，我想在另一个文件中针对 line[y] 运行 line[x]，我想对整个执行此操作文件并将每个匹配对输出到另一个文件。在那个其他文件中，我还希望能够包含第一个文件中的其他部分，就像添加更多索引一样；line[a],line[b],line[c],line[d]，最后是 line[y] 作为该信息的匹配项。

尝试3：

我有一个包含这种格式信息的文件：

#x 是一行

```
 x= data,data,data,data,data,data 
```

有数百万行。

我有另一个文件，格式相同：

```
 xis a line
    x= data,data,data,data 
```

我想使用第一个文件中的 x[#] 和第二个文件中的 x[#]，我想看看这两个值是否匹配，如果它们匹配，我想输出这些值以及其他几个 x[#] 值第二个文件，它们在同一行。

这对理解有帮助吗？文件的格式就像我说的那样：（但有数百万，我想在两个文件中找到对，因为它们都应该匹配）

```
 line 1  data,data,data,data
  line 2  data,data,data,data 
```

来自文件 1 的数据：

```
 (N'068D556A1A665123A6DD2073A36C1CAF', N'A76EEAF6D310D4FD2F0BD610FAC02C04DFE6EB67',    
N'D7C970DFE09687F1732C568AE1CFF9235B2CBB3673EA98DAA8E4507CC8B9A881'); 
```

来自文件 2 的数据：

```
00000040f2213a27ff74019b8bf3cfd1|index.docbook|Redhat 7.3 (32bit)|Linux
00000040f69413a27ff7401b8bf3cfd1|index.docbook|Redhat 8.0 (32bit)|Linux
00000965b3f00c92a18b2b31e75d702c|Localizable.strings|Mac OS X 10.4|OSX
0000162d57845b6512e87db4473c58ea|SYSTEM|Windows 7 Home Premium (32bit)|Windows
000011b20f3cefd491dbc4eff949cf45|totem.devhelp|Linux Ubuntu Desktop 9.10 (32bit)|Linux 
```

它的排序顺序是字母数字，我想使用滑块方法。我的意思是如果 file1[x] < file2[x] 根据一个值是否大于另一个值，向下或向上移动滑块，直到找到匹配项，如果是，则打印输出以及其他值这将识别该哈希。

结果我想要的是：

file1[x] 及其在 file2[x] 上的对应匹配输出到一个文件，以及其他 file1[x]，其中 x 可以是该行的任何索引。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T22:17:09.313

使用这种方法并逐行比较，您不必将文件存储在内存中，因为文件很大。

```
with open('file1.txt') as f1, open('file2.txt') as f2, open('file3.txt','w') as f3:
    for x, y in zip(f1, f2): 
        if x == y:
            f3.write(x) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T17:58:47.883

我从澄清中得到了什么：

*   file1 和 file2 的格式相同，每一行看起来像

    ```
    {32 char hex key}|{text1}|{text2}|{text3} 
    ```

*   文件按key升序排序

*   对于同时出现在 file1 和 file2 中的每个键，您需要合并输出，所以每一行看起来像

    ```
    {32 char hex key}|{text11}|{text12}|{text13}|{text21}|{text22}|{text23} 
    ```

您基本上想要来自合并排序的冲突：

```
import csv

def getnext(csvfile, key=lambda row: int(row[0], 16)):
    row = csvfile.next()
    return key(row),row

with open('file1.dat','rb') as inf1, open('file2.dat','rb') as inf2, open('merged.dat','wb') as outf:
    a = csv.reader(inf1, delimiter='|')
    b = csv.reader(inf2, delimiter='|')
    res = csv.writer(outf, delimiter='|')

    a_key, b_key = -1, 0
    try:
        while True:
            while a_key < b_key:
                a_key, a_row = getnext(a)
            while b_key < a_key:
                b_key, b_row = getnext(b)
            if a_key==b_key:
                res.writerow(a_row + b_row[1:])
    except StopIteration:
        # reached the end of an input file
        pass 
```

我仍然不知道您试图通过“以及其他 file1[x] 进行通信，其中 x 可以是该行中的任何索引”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-28T22:26:41.083

比较指定索引处的两个文件的内容：

```
fp1 = open("file1.txt", "r")
fp2 = open("file2.txt", "r")

fp1.seek(index)
fp2.seek(index)

line1 = fp1.readline()
line2 = fp2.readline()

if line1 == line2:
    print(line1)

fp1.close()
fp2.close() 
```

逐行比较两个文件以查看它们是否匹配，否则打印该行：

```
fp1 = open("file1.txt", "r")
fp2 = open("file2.txt", "r")

line1, line2 = fp1.readline(), fp2.readline()

while line1 and line2:
    if line1 != line2:
        print("Mismatch.\n1: %s\n2: %s" % (line1, line2))

fp1.close()
fp2.close() 
```

# java - 未找到 DDMS 文件 Android\platform-tools\adb.exe

> ID：11253669
> 
> 赞同：7
> 
> 时间：2012-06-28T22:13:00.523
> 
> 标签：java, android

我有 Eclipse 和 Java SE，并且正在运行 Windows XP，并且正在尝试为 Eclipse 设置 Android。

我先来：

访问[http://developer.android.com](http://developer.android.com)。2\. 在出现的主页面，点击下载Android SDK的链接。3\. 找到适合您的操作系统（Windows、Mac OS X 或 Linux）的链接。4\. 单击链接开始下载。

我安装了 Android SDK 工具

然后，我在下载 ADT 插件时按如下方式安装了 ADT（注意我使用的是 http 而不是 https ）。

[http://developer.android.com/sdk/installing/installing-adt.html](http://developer.android.com/sdk/installing/installing-adt.html)

它给了我一些错误，说需要安装一些如果我安装了 Java EE 就会安装的东西。

我看到一个网站说进入 SDK 管理器，所以我尝试安装一些东西，它给了我这个错误：

[2012-06-28 14:32:27 - DDMS] 未找到 DDMS 文件：K:\Android\platform-tools\adb.exe [2012-06-28 14:32:27 - DDMS] 未找到 DDMS 文件： K:\Android\平台工具\adb.exe

这是什么意思，我怎样才能让 Android 工作。我还需要 Java EE 为 Android 提供的一些东西吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-27T13:48:16.270

我不想这么说，但重新启动 Eclipse。我最近的安装有时会感到困惑，这就是我修复它的方法。还没有改正。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-25T12:00:03.733

文件路径错误。您可能在安装 Eclipse 后重命名了目录中的文件，现在您必须手动更改文件路径或重新安装程序。这就是为什么在说明中要求您在主驱动器上安装到开发人员，而不是其他文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-29T02:38:13.217

将eclipse移动到另一个驱动器后，我遇到了这个问题。通过在 Eclipse > Window > Preferences > Android > SDK Location 设置 SDK 文件夹来修复它：

将驱动器号从 C 更改为 E 为我解决了这个问题。在驱动器上找到 eclipse 文件夹并更正路径或使用浏览按钮。

我的路径是 E:\adt-bundle-windows-x86_64-20140702\sdk

关闭可能通过 adb.exe 连接到手机的任何其他应用程序，例如。使用 android sdk 的 Visual Studio。

如果需要，重新启动 Eclipse。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-22T04:44:36.137

[从http://developer.android.com/sdk/installing/index.html?pkg=tools](http://developer.android.com/sdk/installing/index.html?pkg=tools) andriod intaller安装安装程序就可以了

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-09-26T06:32:01.390

[![在此处输入图像描述](../Images/fb845f8d198d35b3b239875e48da0015.png)](https://i.stack.imgur.com/Aayxn.png)

在 Preferences 中设置您的 SDK 路径（Eclipse > Window > Preferences > Android > SDK Location:)

# python - wx.ListControl 中的图像被截断

> ID：11253671
> 
> 赞同：0
> 
> 时间：2012-06-28T22:13:24.030
> 
> 标签：python, wxpython

我有一个处于报告模式的 wx.ListCtrl，我使用图像列表来显示带有 SetItemColumnImage 的 50x50 像素的图标。现在的问题是，我在图标右列显示的文字高度小于50像素，并且图标高于文字的部分被截掉了。

有没有办法告诉 ListCtrl 将行高调整为图标的高度？最后的避难所是更改文本的字体大小，但应该有更好的方法。

**更新：**

这是我的一些代码：

```
self.list = util.ListCtrl(nb, style=wx.LC_REPORT|
                wx.LC_SINGLE_SEL|wx.LC_NO_HEADER|wx.LC_ALIGN_LEFT)
self.list.InsertColumn(0, 'Avatar', width=-1)
self.list.InsertColumn(1, 'Name', width=-1)
self.list.SetColumnWidth(0, 50)

self.imagelist = wx.ImageList(50, 50, 255, 20)
self.list.SetImageList(self.imagelist, wx.IMAGE_LIST_SMALL)

i = 0
for user in self.users:
    self.list.Append(['', user['name']])

    if user['avatar']:
        bitmap = wx.BitmapFromImage(user['avatar'])
        imageidx = self.imagelist.Add(bitmap)
        self.list.SetItemColumnImage(i, 0, imageidx)

    i += 1 
```

当我删除 LC_REPORT 标志时，图像完全可见，但它们都显示在一行中，并且名称不再可见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T13:35:14.683

由于图像是 50x50，我认为它们不再符合“小”的条件。尝试使用 wx.IMAGE_LIST_NORMAL 而不是 wx.IMAGE_LIST_SMALL。我找不到任何关于手动设置行高的信息，所以我猜这是不可能的。但是，我确实找到了关于这个主题的[错误报告](http://trac.wxwidgets.org/ticket/12806)，说它已在 wx2.9 中解决。你用的是2.9吗？

或者，您可以使用纯 Python 的 UltimateListCtrl，如果它没有该功能，您可能可以快速修补它，因为作者反应非常迅速。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-20T04:01:51.073

我喝了几杯咖啡才弄清楚。

对 ImageList.Add 的调用应在 ListCtrl.Append（或 ListCtrl.InsertItem）**之前**，以便 ListCtrl 根据 ImageList 中图像的高度更改其行的高度。

所以而不是

```
for user in self.users:
    self.list.Append(['', user['name']])

    if user['avatar']:
        bitmap = wx.BitmapFromImage(user['avatar'])
        imageidx = self.imagelist.Add(bitmap)
        self.list.SetItemColumnImage(i, 0, imageidx) 
```

你应该用这样的东西

```
for user in self.users:

    if user['avatar']:
        bitmap = wx.BitmapFromImage(user['avatar'])
        imageidx = self.imagelist.Add(bitmap)

    self.list.Append(['', user['name']])

    if user['avatar']:
        self.list.SetItemColumnImage(i, 0, imageidx) 
```

看起来很难看，直到您实现默认头像：

```
def_avatar = 'default_avatar.jpg'

for user in self.users:

    bitmap = wx.BitmapFromImage(user['avatar'] if user['avatar'] else def_avatar)
    imageidx = self.imagelist.Add(bitmap)

    self.list.Append(['', user['name']])
    self.list.SetItemColumnImage(i, 0, imageidx) 
```

# c# - 如果 tiff 具有不同图像类型的页面，为什么 ImageResizer 不处理 tiff 页面的提取？

> ID：11253672
> 
> 赞同：1
> 
> 时间：2012-06-28T22:13:26.983
> 
> 标签：c#, imageresizer

我在控制台应用程序中使用 imageresizer.net 从 tiff 图像中提取页面，但是当 tiff 包含不同图像类型的页面时，imageresizer 提取的内容并不总是代表原始页面。

我正在使用托管 API，代码如下： `ImageBuilder.Current.Build(sourceImagePath, destinationImagePath, new ResizeSettings("page=[whatever]"));`

TIFF 图像包含...

*   第 1 页，图像类型“Bilevel（白色为零）”，压缩“Group 3”，大小“485kb”。
*   第 2 页，图像类型“YCbCr（2,1 二次采样）”，压缩“JPEG（旧式）”，大小“11MB”。
*   第 3 页，图像类型“YCbCr（2,1 二次采样）”，压缩“JPEG（旧式）”，大小“11MB”。
*   第 4 页，图像类型“灰度（256 灰度，黑色为零）”，压缩“JPEG（旧式）”，大小“4MB”。

我得到的行为是......

*   提取第 1 页工作正常。
*   提取第 2 页最终会提取第 1 页的图像。
*   提取第 3 页最终提取了第 1 页的图像，但在图像左侧压缩成约 1 厘米宽的带，剩余图像为黑色。
*   提取第 4 页工作正常。

我还使用 libtiff.net 使用[这种方法](http://bitmiracle.com/libtiff/help/convert-color-tiff-to-a-32-bit-system.drawing.bitmap.aspx)提取了相同的图像，它没有表现出相同的错误。

编辑 - 使用此代码测试 Wic 解码器：

```
var settings = new ResizeSettings("decoder=wic&page=" + pageNumber);
Config.Current.Plugins.GetOrInstall<WicDecoderPlugin>();
ImageBuilder.Current.Build(sourceImagePath, destImagePath, settings); 
```

这适用于第 1 页和第 4 页（那里没有变化），但我得到一个“对象引用未设置为对象的实例”。使用 Wic 解码器时，第 2 页和第 3 页出现错误。

编辑 2 - 将失败的位转换为 MVC 项目以获取 /resizer.debug：

```
Image resizer diagnostic sheet      29/06/2012 4:08:14 a.m.

4 Issues detected:

(Warning):  To potentially see additional errors here, perform an image resize request.

(Warning):  You are running a hotfix version of the ImageResizer.
            You should upgrade to a released version with an equal or higher version number as soon as possible. Hotfix and release DLLs with the same version number are not the same - the release DLL should be used instead.
            Assemblies marked as hotfix versions: ImageResizer, ImageResizer.Mvc

(Warning):  NoCache is only for development usage, and cannot scale to production use.
            Add DiskCache or CloudFront for production use

(Warning):  Potentially incompatible ImageResizer assemblies were detected.
            Please make sure all ImageResizer assemblies are from the same version. Compatibility issues are possible if you mix plugins from different releases.
            3.2.3 assemblies: ImageResizer, ImageResizer.Mvc
            3.2.2 assemblies: ImageResizer.Plugins.Logging, ImageResizer.Plugins.Wic

You are using paid bundles: Design Bundle

Registered plugins:

ImageResizer.Plugins.Basic.DefaultEncoder
ImageResizer.Plugins.Basic.NoCache
ImageResizer.Plugins.Basic.ClientCache
ImageResizer.Plugins.Basic.Diagnostic
ImageResizer.Plugins.Basic.SizeLimiting
ImageResizer.Plugins.MvcRoutingShim.MvcRoutingShimPlugin
ImageResizer.Plugins.WicDecoder.WicDecoderPlugin
ImageResizer.Plugins.Logging.LoggingPlugin

Configuration:

<resizer>
<plugins>
<add name="MvcRoutingShim" />
<add name="WicDecoder" />
<add name="Logging" />
</plugins>
</resizer>

Accepted querystring keys:

quality, format, thumbnail, maxwidth, maxheight, width, height, w, h, scale, stretch, crop, cropxunits, cropyunits, page, bgcolor, rotate, flip, sourceFlip, sFlip, sRotate, borderWidth, borderColor, paddingWidth, paddingColor, ignoreicc, frame, useresizingpipeline, cache, process, margin, anchor, dpi, mode, zoom, 

Accepted file extensions:

bmp, gif, exif, png, tif, tiff, tff, jpg, jpeg, jpe, jif, jfif, jfi, 

Environment information:

Running Microsoft Windows NT 6.1.7601 Service Pack 1 and CLR 4.0.30319.269
Trust level: Unrestricted
OS bitness: x86 !! Warning, running as 32-bit on a 64-bit OS(AMD64). This will limit ram usage !!
Executing assembly: C:\Program Files (x86)\Common Files\Microsoft Shared\DevServer\10.0\WebDev.WebServer40.exe
IntegratedPipeline: False

Loaded assemblies:

mscorlib                                 Assembly: 4.0.0.0         File: 4.0.30319.269   Info: 4.0.30319.269
System.Web                               Assembly: 4.0.0.0         File: 4.0.30319.272   Info: 4.0.30319.272
System                                   Assembly: 4.0.0.0         File: 4.0.30319.269   Info: 4.0.30319.269
System.Core                              Assembly: 4.0.0.0         File: 4.0.30319.233   Info: 4.0.30319.233
System.Configuration                     Assembly: 4.0.0.0         File: 4.0.30319.1     Info: 4.0.30319.1
System.Xml                               Assembly: 4.0.0.0         File: 4.0.30319.233   Info: 4.0.30319.233
System.Runtime.Caching                   Assembly: 4.0.0.0         File: 4.0.30319.237   Info: 4.0.30319.237
Microsoft.Build.Utilities.v4.0           Assembly: 4.0.0.0         File: 4.0.30319.1     Info: 4.0.30319.1
System.Web.RegularExpressions            Assembly: 4.0.0.0         File: 4.0.30319.1     Info: 4.0.30319.1
Microsoft.Build.Framework                Assembly: 4.0.0.0         File: 4.0.30319.1     Info: 4.0.30319.1
System.Data                              Assembly: 4.0.0.0         File: 4.0.30319.237   Info: 4.0.30319.237
Microsoft.JScript                        Assembly: 10.0.0.0        File: 10.0.30319.1    Info: 10.0.30319.1
CppCodeProvider                          Assembly: 10.0.0.0        File: 10.0.30319.1    Info: 10.0.30319.1
System.Web.WebPages.Deployment           Assembly: 1.0.0.0         File: 1.0.20105.407  
System.Web.WebPages                      Assembly: 1.0.0.0         File: 1.0.20105.407  
System.Web.Mvc                           Assembly: 3.0.0.0         File: 3.0.20105.0    
Microsoft.Web.Infrastructure             Assembly: 1.0.0.0         File: 1.0.20105.407  
System.Web.WebPages.Razor                Assembly: 1.0.0.0         File: 1.0.20105.407  
System.Web.Razor                         Assembly: 1.0.0.0         File: 1.0.20105.407  
App_global.asax.ijrgfwnu                 Assembly: 0.0.0.0        
PNCC.LimDocumentBuilder.ImageResizerTest Assembly: 1.0.0.0         File: 1.0.0.0        
WebDev.WebHost40                         Assembly: 10.0.0.0        File: 10.0.40219.1    Info: 10.0.40219.1
System.Web.Mobile                        Assembly: 4.0.0.0         File: 4.0.30319.1     Info: 4.0.30319.1
System.ServiceModel.Activation           Assembly: 4.0.0.0         File: 4.0.30319.233   Info: 4.0.30319.233
System.ServiceModel                      Assembly: 4.0.0.0         File: 4.0.30319.233   Info: 4.0.30319.233
System.Runtime.DurableInstancing         Assembly: 4.0.0.0         File: 4.0.30319.1     Info: 4.0.30319.1
SMDiagnostics                            Assembly: 4.0.0.0         File: 4.0.30319.1     Info: 4.0.30319.1
System.Xaml.Hosting                      Assembly: 4.0.0.0         File: 4.0.30319.1     Info: 4.0.30319.1
System.Web.Extensions                    Assembly: 4.0.0.0         File: 4.0.30319.272   Info: 4.0.30319.272
Microsoft.CSharp                         Assembly: 4.0.0.0         File: 4.0.30319.1     Info: 4.0.30319.1
System.Web.Services                      Assembly: 4.0.0.0         File: 4.0.30319.1     Info: 4.0.30319.1
System.Drawing                           Assembly: 4.0.0.0         File: 4.0.30319.282   Info: 4.0.30319.282
System.EnterpriseServices                Assembly: 4.0.0.0         File: 4.0.30319.1     Info: 4.0.30319.1
System.IdentityModel                     Assembly: 4.0.0.0         File: 4.0.30319.1     Info: 4.0.30319.1
System.Runtime.Serialization             Assembly: 4.0.0.0         File: 4.0.30319.1     Info: 4.0.30319.1
System.ServiceModel.Web                  Assembly: 4.0.0.0         File: 4.0.30319.233   Info: 4.0.30319.233
System.Activities                        Assembly: 4.0.0.0         File: 4.0.30319.1     Info: 4.0.30319.1
System.ServiceModel.Activities           Assembly: 4.0.0.0         File: 4.0.30319.1     Info: 4.0.30319.1
System.WorkflowServices                  Assembly: 4.0.0.0         File: 4.0.30319.1     Info: 4.0.30319.1
System.Data.DataSetExtensions            Assembly: 4.0.0.0         File: 4.0.30319.1     Info: 4.0.30319.1
System.Xml.Linq                          Assembly: 4.0.0.0         File: 4.0.30319.1     Info: 4.0.30319.1
System.ComponentModel.DataAnnotations    Assembly: 4.0.0.0         File: 4.0.30319.1     Info: 4.0.30319.1
System.Web.DynamicData                   Assembly: 4.0.0.0         File: 4.0.30319.1     Info: 4.0.30319.1
System.Web.ApplicationServices           Assembly: 4.0.0.0         File: 4.0.30319.1     Info: 4.0.30319.1
EntityFramework                          Assembly: 4.1.0.0         File: 4.1.10331.0     Info: 4.1.10331.0
ImageResizer                             Assembly: 3.2.3.766       File: 3.2.3.766       Info: 3-2-beta-3-temp-hotfix-jun-27-2012-9am  Commit: a0f4f1e
ImageResizer.Mvc                         Assembly: 3.2.3.766       File: 3.2.3.766       Info: 3-2-beta-3-temp-hotfix-jun-27-2012-9am  Commit: a0f4f1e
ImageResizer.Plugins.Logging             Assembly: 3.2.2.0         File: 3.2.2.0         Info: 3-2-beta-2  Commit: 3704dd6
ImageResizer.Plugins.Wic                 Assembly: 3.2.2.0         File: 3.2.2.0         Info: 3-2-beta-2  Commit: 3704dd6
NLog                                     Assembly: 2.0.0.0        
System.Web.Abstractions                  Assembly: 4.0.0.0         File: 4.0.30319.1     Info: 4.0.30319.1
System.Web.Helpers                       Assembly: 1.0.0.0         File: 1.0.20105.407  
System.Web.Routing                       Assembly: 4.0.0.0         File: 4.0.30319.1     Info: 4.0.30319.1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T23:20:48.870

这是我在 libtiff.net 中对 BuilderExtension 进行子类化、覆盖 DecodeStream 和粘合的尝试。

这是我的两个测试 tiff[不同大小的页面](http://minus.com/lbch5irLumoSQQ)和[具有不同颜色空间](http://minus.com/lboR49aXnS7tlZ)的页面。我已经针对 ImageBuilder v3.2.2 进行了编译。

当我使用 ImageResizer v3.2.2 源代码中的 ConsoleApplication 项目和以下代码时出现错误。目前我已经没有时间解决这个问题了，所以我想我会把我的进展放在这里，以防其他人想更进一步。

**我的测试代码**

`ImageResizer.ImageBuilder.PrepareDestinationBitmap()`我认为在线失败，`s.destBitmap = ...`参数*无效。*错误。尺寸为 w=9994,h=7102，我怀疑这可能是内存问题 - 但是，如果我`DecodeTiffTo32BitBitmap()`首先使用解码 tiff 并将其作为内存流传递给 ImageResizer，则错误不存在。此外，v3.2.2 和 v3.2.3 都会出现此故障。

```
var Path = @"[whatever]\TiffDecoderTests\";
var c = new Config();      
new TiffDecoder().Install(c);      
c.BuildImage(Path + "different_page_sizes.TIF", Path + "different_page_sizes-page2-TiffReader.png", "format=png&page=2&decoder=tiffdecoder"); 
```

**我的 TiffDecoder 类：**

```
namespace ImageResizer.Plugins.TiffDecoder
{
  using System;
  using System.Collections.Generic;
  using System.Drawing;
  using System.Drawing.Imaging;
  using System.Globalization;
  using System.IO;
  using System.Linq;

  using BitMiracle.LibTiff.Classic;

  using ImageResizer;
  using ImageResizer.Configuration;
  using ImageResizer.Resizing;

  public class TiffDecoder : BuilderExtension, IPlugin, IFileExtensionPlugin
  {
    private static readonly string[] supportedExtensions = new[] { ".tiff", ".tif", ".tff" };

    public IPlugin Install(Config c)
    {
      c.Plugins.add_plugin(this);
      return this;
    }

    public bool Uninstall(Config c)
    {
      c.Plugins.remove_plugin(this);
      return true;
    }

    public IEnumerable<string> GetSupportedFileExtensions()
    {
      return supportedExtensions;
    }

    public override Bitmap DecodeStream(Stream s, ResizeSettings settings, string optionalPath)
    {
      var requested = "tiffdecoder".Equals(settings["decoder"], StringComparison.OrdinalIgnoreCase);
      if (!string.IsNullOrEmpty(settings["decoder"]) && !requested)
      {
        return null; // Don't take it away from the requested decoder
      }

      // If a tiff is coming in, try first, before Bitmap tries to parse it.      
      if (requested || (optionalPath != null && supportedExtensions.Any(ext => optionalPath.EndsWith(ext, StringComparison.OrdinalIgnoreCase))))
      {
        return this.Decode(s, settings);
      }

      return null;
    }

    public override Bitmap DecodeStreamFailed(Stream s, ResizeSettings settings, string optionalPath)
    {
      // Catch tiff files not ending in an expected extension
      try
      {
        return this.Decode(s, settings);
      }
      catch
      {
        return null;
      }
    }

    public Bitmap Decode(Stream s, ResizeSettings settings)
    {
      return DecodeTiffTo32BitBitmap(s, settings["page"]);
    }

    private static Bitmap DecodeTiffTo32BitBitmap(Stream s, string page)
    {
      s.Position = 0;
      using (var image = Tiff.ClientOpen(string.Empty, "r", s, new TiffStream()))
      {
        SetDirectory(image, page);

        // Find the width and height of the image
        var value = image.GetField(TiffTag.IMAGEWIDTH);
        var width = value[0].ToInt();

        value = image.GetField(TiffTag.IMAGELENGTH);
        var height = value[0].ToInt();

        // Read the image into the memory buffer
        var raster = new int[height * width];
        if (!image.ReadRGBAImage(width, height, raster))
        {
          return null;
        }

        // Caller needs to handle disposing the bitmap.
        var bmp = new Bitmap(width, height, PixelFormat.Format32bppRgb);
        var rect = new Rectangle(0, 0, bmp.Width, bmp.Height);

        var bmpdata = bmp.LockBits(rect, ImageLockMode.ReadWrite, PixelFormat.Format32bppRgb);
        var bits = new byte[bmpdata.Stride * bmpdata.Height];

        for (var y = 0; y < bmp.Height; y++)
        {
          var rasterOffset = y * bmp.Width;
          var bitsOffset = (bmp.Height - y - 1) * bmpdata.Stride;

          for (var x = 0; x < bmp.Width; x++)
          {
            var rgba = raster[rasterOffset++];
            bits[bitsOffset++] = (byte)((rgba >> 16) & 0xff);
            bits[bitsOffset++] = (byte)((rgba >> 8) & 0xff);
            bits[bitsOffset++] = (byte)(rgba & 0xff);
            bits[bitsOffset++] = (byte)((rgba >> 24) & 0xff);
          }
        }

        System.Runtime.InteropServices.Marshal.Copy(bits, 0, bmpdata.Scan0, bits.Length);
        bmp.UnlockBits(bmpdata);

        return bmp;
      }
    }

    /// <summary>
    /// Sets the TIFF directory to the first that matches the requested page number, otherwise:
    /// - If page not set OR less than 0, use the first page in the TIFF.
    /// - If tiff has no directories with the "PAGE" tag, use the first frame in the TIFF.
    /// </summary>
    /// <param name="image">The image.</param>
    /// <param name="page">The page.</param>
    /// <remarks>
    /// From what I can tell a TIFF image can store any pages in any directory, so the 1st dir 
    /// might not hold the 1st page - this is why we first iterate all frames looking for a PAGE tag.
    /// </remarks>    
    private static void SetDirectory(Tiff image, string page)
    {
      var pageIndex = GetAdjustedPage(page);
      var numberOfDirectories = image.NumberOfDirectories();

      for (short dirNumber = 0; dirNumber < numberOfDirectories; ++dirNumber)
      {
        image.SetDirectory(dirNumber);

        // Ignore pages that might be thumbnails
        var subFileType = image.GetField(TiffTag.SUBFILETYPE);
        if (subFileType == null || subFileType[0].ToString().ToUpper() != "PAGE")
        {
          continue;
        }

        // Stop if page found
        if (pageIndex == int.Parse(image.GetField(TiffTag.PAGENUMBER)[0].ToString()))
        {
          return;
        }
      }

      // Default to the first frame if the page wasn't found.
      image.SetDirectory(0);
    }

    private static int GetAdjustedPage(string page)
    {
      var pageIndex = 1;
      if (!string.IsNullOrEmpty(page))
      {
        int.TryParse(page, NumberStyles.Number, NumberFormatInfo.InvariantInfo, out pageIndex);
      }

      // So users can use 1-based numbers
      return Math.Max(1, pageIndex) - 1;
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T15:35:52.497

## 2012 年 12 月 12 日更新：

FreeImageDecoder 插件现在支持多页 TIFF 文件，并在内部使用 libtiff。这是处理非常复杂/罕见的 .TIFF 文件的建议方法。

* * *

**TIFF 格式极其复杂且标准化程度很低。大多数库（如 GDI+ (System.Drawing) 和 WIC (WPF)）只实现了标准的一小部分，更不用说事实上的特性和附加功能了。**

要获得这种级别的 .TIFF 支持，您需要使用*专用*于 .TIFF 支持的库，例如[libtiff](http://www.libtiff.org/)或[libtiff.net](http://bitmiracle.com/libtiff/)。

**ImageResizer*确实*通过 FreeImage 和 FreeImageDecoder 插件与 LibTiff 集成，但尚未实现多页面支持**。

没有桨，你就不会上岸——有很多方法可以解决你的困境：

1.  [Fork FreeImageDecoder](http://imageresizing.net/plugins/freeimage)并添加多页支持。难度：7
2.  子类[BuilderExtension](http://documentation.imageresizing.net/doxygen/class_image_resizer_1_1_resizing_1_1_builder_extension.html)，覆盖[DecodeStream](http://documentation.imageresizing.net/doxygen/class_image_resizer_1_1_resizing_1_1_abstract_image_processor.html#ae5d188de9b281e6d1885c86f211190d0)，并粘在 libtiff.net 中。难度：5
3.  子类 BuilderExtension，覆盖 DecodeStream，并在 libtiff 中粘合。难度：10
4.  [在 UserVoice 网站上发布您的想法并获得 30 票](http://resizer.uservoice.com/forums/108373-image-resizer-v3)。困难：？
5.  [付钱给我](http://imageresizing.net/plugins/custom)。难度：3（不过，我的下一个可用位置是几个月后）。

解码器的示例实现已经有 4 个：ImageBuilder.DecodeStream、PsdReader、WicDecoder、FreeImageDeocoder 和 PdfRenderer。它们的源代码[包含在下载中](http://imageresizing.net/download)。平均解码器需要少于 80 行代码。

# windows - 有什么方法可以告诉 Windows 系统重新启动时哪些文件有待删除或重命名？

> ID：11253673
> 
> 赞同：1
> 
> 时间：2012-06-28T22:13:28.287
> 
> 标签：windows, perl, powershell

有谁知道在系统重新启动时告诉哪些文件将被删除或修改的方法？就像您更新系统时一样，系统要求重新启动，因为某些文件被系统阻止并且需要替换或修改它们。我需要制作一个脚本，告诉我在启动时将删除或修改哪个文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T22:18:10.150

[MoveFileEx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365240%28v=vs.85%29.aspx)的文档指出：

> ### 评论
> 
> 如果`dwFlags`参数指定`MOVEFILE_DELAY_UNTIL_REBOOT`，则[MoveFileEx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365240%28v=vs.85%29.aspx)在无法访问注册表时失败。该函数将要在重新启动时重命名的文件的位置存储在以下注册表值中：
> 
> `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\PendingFileRenameOperations`
> 
> 此注册表值的类型为`REG_MULTI_SZ`。每个重命名操作都存储以下以 NULL 结尾的字符串之一，具体取决于重命名是否为删除：
> 
> *   `szDstFile\0\0`
>     
>     
> *   `szSrcFile\0szDstFile\0`
>     
>     
> 
> 该字符串`szDstFile\0\0`表示该文件`szDstFile`将在重新启动时被删除。该字符串`szSrcFile\0szDstFile\0`表示`szSrcFile`要`szDstFile`在重新启动时重命名。

您可以使用[Win32::TieRegistry](http://search.cpan.org/perldoc/Win32::TieRegistry)查询 Windows 注册表：

```
#!/usr/bin/env perl

use strict; use warnings;
use Const::Fast;
use Win32::TieRegistry;
use YAML;

const my $REG_DELIMITER => '/';

$Registry->Delimiter($REG_DELIMITER);

my $key = join $REG_DELIMITER, qw(
    HKEY_LOCAL_MACHINE
    SYSTEM
    CurrentControlSet
    Control
    Session Manager
    PendingFileRenameOperations
);

print Dump $Registry->{$key} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-09-09T18:48:22.147

虽然很久以前用 Perl 脚本回答了这个问题，但我想在这里提供一个 PowerShell 解决方案，因为它是 Windows 原生的，并且问题被标记为[powershell](/questions/tagged/powershell "显示标记为“powershell”的问题")。

我们需要`PendingFileRenameOperations`从`HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager`注册表项中查询。我有以下函数查询此注册表值并返回您可以操作的惯用 PowerShell 对象（与**Windows PowerShell**和**PowerShell Core**兼容）：

```
Function Get-PendingFileRenameOperations {
  [CmdletBinding()]
  Param()

  # Define Registry Variables
  $multiSzPrefix = '^\\\?\?\\'
  $pendingRebootRegPath = 'HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager'

  # Get the PendingFileRenameOperations value as an array of strings
  Write-Verbose "Reading PendingFileRenameOperations from ${pendingRebootRegPath}"
  $pendingFiles = @( Get-ItemProperty $pendingRebootRegPath ).PendingFileRenameOperations
  Write-Verbose "Found $($pendingFiles.Count / 2) PendingFileRenameOperations$([System.Environment]::NewLine)"

  # Loop over each line from PendingFileRenameOperations
  for( $i = 0; $i -lt $pendingFiles.Count; $i++ ) {

    # Get the source file
    $src = $pendingFiles[$i] -replace $multiSzPrefix
    if( !$src ) {

      # Better safe than sorry
      throw [System.InvalidOperationException]::new("${pendingRebootRegPath}\PendingFileRenameOperations is malformed, expected source but got nothing")
    }
    Write-Verbose "Found source: ${src}"

    # Get the target path
    $dst = $pendingFiles[++$i] -replace $multiSzPrefix
    if( $dst ) {
      Write-Verbose "Found target: ${dst}"
    }

    # Determine whether it's a "move" or "delete"
    $operation = if( $dst ) {
      "Move"
    } else {
      "Delete"
    }
    Write-Verbose "Operation: ${operation}$([System.Environment]::NewLine)"

    # Prepare object and return
    [PSCustomObject]@{
      Source = $src
      Target = $dst
      Operation = $operation
    }

    Remove-Variable src, dst, operation
  }
} 
```

* * *

## 这个怎么运作

*   `HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager``REG_SZ_MULTI`是包含（多行字符串）的父键，其中包含用于重命名的暂存路径。偶数行（零索引）是源文件，奇数行是目标路径。
*   我们可以使用上面的**Session Manager**`Get-ItemProperty`键来获取注册表值，然后我们可以在返回的值集合上引用该属性。**`PendingFileRenameOperations`**
***   每行代表一个以字符串为前缀的文件路径`\??\`。我们最终需要从返回的路径中删除它，因此要匹配的正则表达式模式是`^\\\?\?\\`. 有关表达式本身的更多信息，请参见[RegExr](http://regexr.com/65bbq)。*   每个操作将有两行长。如前所述，以开头的偶数行`0`是`source`文件，奇数行将是`target`移动到的路径。*   *空* `target`行表示没有目标路径。这意味着“移动”操作实际上将在重新启动时**删除**源文件。
    *   我不知道`source`一行是否可以出于任何原因为空，或者是否可以安全跳过，因此如果预期的行为空，此函数会谨慎出错并放弃`source`。**

 **现在我们了解了注册表项的工作原理以及如何获取数据，我们可以看一下循环逻辑。

*   我们从 循环遍历每一行`PendingFileRenameOperations`，当我们引用用于该`target`行的下一个索引时递增索引。本质上，我们最终在每次迭代中将循环计数为 2。
*   一旦我们从`source`and中删除前缀，我们就会根据计算结果是否为 false`target`来确定它是**Move**还是**Delete 。** `operation``$dst`
*   `Source`使用、`Target`和`Operation`键创建哈希表，将其转换为`PSCustomObject`，并将对象输出到管道。这比多次建立`@{}`和管道传输要容易。`Add-Member`**

# asp.net-mvc - ASP.NET MVC 4 - 使用子操作在模态保存后重定向

> ID：11253676
> 
> 赞同：5
> 
> 时间：2012-06-28T22:13:37.363
> 
> 标签：asp.net-mvc, asp.net-mvc-3

* * *

**更新**- 有很多关于**不允许**在 SO 和 ASP.NET 论坛上执行重定向操作的子操作的帖子。下面的解决方案似乎是我所见过的针对此问题的最简单的解决方法。如果你有这个问题 - 希望你会发现它有帮助。如果有更好的，我当然愿意接受建议。

* * *

我整天都在为此绞尽脑汁……

我有一个**FranchiseSet**模型和一个**Franchise**模型——关系是 FranchiseSet 有很多特许经营权。

在 FranchiseSet 索引视图上有一个 Franchise Sets 表，其中每一行都是可点击的。当我单击一行时，我从**FranchiseSetController的****Details**方法返回一个视图- 通过 AJAX。

 **在该视图中，还有一个表格，显示该特许经营集的所有相关特许经营权。从本质上讲，它是一个**主/详细**视图 - 如下所示：

![在此处输入图像描述](../Images/03d76feb5b6ddf9cb1b178a2b8c4b55c.png)

有一个 Twitter Bootstrap 模式用于显示特许经营的创建表单。看起来是这样的：

```
<div class="modal hide fade in" id="myModal" )>
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">×</button>
        <h3>Modal header</h3>
      </div>
      <div id="create_franchise_modal_body" class="modal-body">
        @Html.Action("Create", "Franchise", new { FranchiseSetId = Model.FranchiseSetID })       
      </div>
      <div class="modal-footer">
        <a href="#" class="btn" data-dismiss="modal">Close</a>
        <a href="#" class="btn btn-primary">Save changes</a>
      </div>
    </div> 
```

在模态框体内，我使用一个`@Html.Action`助手来调用**FranchiseController 的 Create**方法：

```
@Html.Action("Create", "Franchise", new { FranchiseSetId = Model.FranchiseSetID }) 
```

这是由此生成的模态：

![在此处输入图像描述](../Images/7fb8855c97a978df20d6eedc6c9920c5.png)

Create 方法成功保存了新的特许经营权，但是，我收到此错误：

**不允许子操作执行重定向操作。**

我在 StackOverflow 和 ASP.NET 论坛上看到了**很多**关于这个问题的帖子，并且我尝试实现一些解决方案 - 即使使用 JavaScript 重定向，但我仍然无法让它工作。

我知道，由于我已经在 FranchiseSet 控制器内部，它已经在尝试基于 FranchiseSet 模型渲染视图，因此 Franchise 模型的子视图是未定义的。那么处理父子行为之间交互的理想方式是什么？

这似乎是一个非常普遍的问题，没有一个共同的解决方案。或者至少我找不到。我对.net mvc 比较陌生，所以可能就是我。

在这种情况下是否使用`@Html.Action`了错误的设计选择？我曾尝试使用`@Html.RenderPartial`，但这会导致 500 Internal Server 错误 - 即使我有 Create 方法设置以返回部分视图。

这是我正在使用的 FranchiseController Create 操作 - GET 和 POST：

```
//
// GET: /Franchise/Create

public ActionResult Create(int FranchiseSetId)
{
    ViewBag.PossibleFranchiseSets = franchisesetRepository.All;
    var franchise = new Franchise { FranchiseSetId = FranchiseSetId };
    return PartialView(franchise);
} 

//
// POST: /Franchise/Create

[HttpPost]
public ActionResult Create(Franchise franchise)
{
    if (ModelState.IsValid) {
        franchiseRepository.InsertOrUpdate(franchise);
        franchiseRepository.Save();
        return RedirectToAction("Index", "FranchiseSet");
    } else {
        ViewBag.PossibleFranchiseSets = franchisesetRepository.All;
        return View();
    }
} 
```

`return RedirectToAction("Index", "FranchiseSet");`与从视图的结合似乎`@Html.Action`是问题的根源。

**非常感谢任何建议！**

* * *

**解决方案**

* * *

我使用了 Russell 在下面建议的修改后的模式代码，但是我在代码块中将 @Html.RenderPartial 方法切换为 @Html.RenderAction 方法。

这是它现在的样子。

```
<div class="modal hide fade in" id="myModal" )>
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">×</button>
        <h3>Modal header</h3>
      </div>
      @using (Html.BeginForm("Create", "Franchise", FormMethod.Post))
      {
         <div id="create_franchise_modal_body" class="modal-body">
           @{ Html.RenderAction("Create", "Franchise", new { FranchiseSetId = Model.FranchiseSetID }); }
         </div>
         <div class="modal-footer">
           <a href="#" class="btn" data-dismiss="modal">Close</a>
           <button type="submit" class="btn btn-primary">Save changes</button>
         </div>
      }
  </div> 
```

我还修改了控制器的 Create 方法，就像上面建议的 Russell。

使用这个： `@{ Html.RenderAction("Create", "Franchise", new { FranchiseSetId = Model.FranchiseSetID }); }`

由于我在这里学到的东西，我将它放在`@{ }`标签中： [Html.RenderPartial 给我奇怪的重载错误？](https://stackoverflow.com/questions/5435893/html-renderpartial-giving-me-strange-overload-error)

我能够让 FranchiseController 重定向回其父级 - FranchiseSetController 的 Index 方法 - 没有任何问题。另外，它不需要我返回 JSON 并尝试执行 JavaScript 重定向——这都是 Razor 视图代码。

我希望这可以解决如何从**Child**动作重定向回**Parent**的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T22:46:50.687

试试这个为你的模态：

```
<div class="modal hide fade in" id="myModal" )>
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">×</button>
        <h3>Modal header</h3>
      </div>
      @using (Html.BeginForm("Create", "Franchise", FormMethod.Post))
      {
         <div id="create_franchise_modal_body" class="modal-body">
           @Html.RenderPartial("Create")
         </div>
         <div class="modal-footer">
           <a href="#" class="btn" data-dismiss="modal">Close</a>
           <button type="submit" class="btn btn-primary">Save changes</button>
         </div>
      }
 </div> 
```

然后在您的控制器中，修复您的 GET 方法，使其返回部分视图结果

```
//
// GET: /Franchise/Create

public PartialViewResult Create(int FranchiseSetId)
{
    ViewBag.PossibleFranchiseSets = franchisesetRepository.All;
    var franchise = new Franchise { FranchiseSetId = FranchiseSetId };
    return PartialView(franchise);
} 
```

我在这个修复中做了几个假设。

1.  您的“创建”视图应该是包含所有表单输入的部分视图
2.  当您打电话时，`@Html.Action("Create", "Franchise", new { FranchiseSetId = Model.FranchiseSetID })`您想要呈现该部分视图
3.  您希望模态底部的“保存更改”链接实际保存您的模态，而不是显示的“创建”按钮

如果我遗漏了什么，请告诉我，我会更新我的答案以尝试提供更好的解决方案。**

# cordova - 有没有办法调试创建插件的错误？

> ID：11253680
> 
> 赞同：0
> 
> 时间：2012-06-28T22:14:24.833
> 
> 标签：cordova, phonegap-plugins

我已经逐步完成了我可以找到的用于创建 phonegap 插件的两个教程：

1.  [http://www.adobe.com/devnet/html5/articles/extending-phonegap-with-native-plugins-for-ios.html](http://www.adobe.com/devnet/html5/articles/extending-phonegap-with-native-plugins-for-ios.html)
2.  [http://wiki.phonegap.com/w/page/36753496/How%20to%20Create%20a%20PhoneGap%20Plugin%20for%20iOS](http://wiki.phonegap.com/w/page/36753496/How%20to%20Create%20a%20PhoneGap%20Plugin%20for%20iOS)

在这两种情况下，当我运行示例时，绝对没有任何反应。我假设这是 b/c 我在 javascript 中遇到错误。我有什么办法可以获取有关此错误的信息吗？某种方式来捕捉异常或什么？

感谢您的时间，

——亨利

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T17:57:55.730

尝试使用 weinre，它是在移动设备上调试 javascript 应用程序的一个非常好的工具。在运行您的应用程序时，您可以在工具的控制台窗口中看到所有错误（如果有）。

[http://people.apache.org/~pmuellr/weinre/docs/latest/](http://people.apache.org/~pmuellr/weinre/docs/latest/)

# c# - 异步委托调用的生命周期

> ID：11253684
> 
> 赞同：0
> 
> 时间：2012-06-28T22:14:54.807
> 
> 标签：c#, asynchronous, delegates, windows-services

我的服务中有以下代码：

```
protected override void OnStart(string[] args)
{
    var cleaner = new Cleaner();
    Action action = cleaner.Run;
    action.BeginInvoke(null, null);
} 
```

我担心是否应该将委托移动到实例变量，因为它使用的对象可能会被 GC 收集，因为它们只是在本地创建的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T21:38:53.300

如果收集了仍在“使用”的对象会发生什么？这个问题没有理智的答案。出于这个原因，CLR 保证不会对仍被引用的对象进行垃圾回收。无论您如何编写代码，您都是安全的。

如果对象仍被引用，您甚至无法收集这些对象。即使你想。

# android - Android C2DM 谷歌将为离线设备保留多少消息？

> ID：11253686
> 
> 赞同：0
> 
> 时间：2012-06-28T22:14:58.027
> 
> 标签：android, queue, device, android-c2dm, offline

我一直在寻找有关 Google 在开始丢弃特定离线设备之前为特定离线设备排队多少消息的具体解释？我读过一次只能为一个设备排队 4 个唯一的折叠键，但我刚刚测试了使用唯一折叠键发送 5 条消息，当我将设备联机时，我得到了全部 5 个。我需要知道有多少条消息我可以期待 Google 会保留以及我可以一次排队多少个独特的折叠键。

非常感谢你的回答。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T00:15:34.193

答案可能没有帮助，因为 C2DM（现已弃用）或 GCM 都不能保证消息传递。但无论如何，GCM 的限制似乎是 100。您最多可以排队 100 条消息以进行传递，而不会折叠任何一条消息。[来源](http://developer.android.com/guide/google/gcm/adv.html)

# x86 - x86 溢出标志的简明表达式？

> ID：11253696
> 
> 赞同：0
> 
> 时间：2012-06-28T22:16:28.353
> 
> 标签：x86, alu

我需要一种简洁的方式将 x86 溢出标志表示为两个操作数的函数。我知道两个操作数具有相同符号但结果具有不同符号时的核心集。

例如，

```
添加 SRC[31..0]、DEST[31..0]

```

OF 可以合理地表示为 SRC 和 DEST 位的“单线”布尔函数吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T22:39:06.150

***由于溢出*****标志是符号位****进*****位***与**符号位****进***位的异或，可以表示为：*

 **```
((SRC[31..0] + DEST[31..0]) shr 32) xor ((SRC[30..0] + DEST[30..0]) shr 31) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T07:49:38.713

这是您如何表达两个有符号（2 的补码）32 位整数相加的有符号溢出标志值：

**OV** = ((( **SRC** XOR **DST** ) XOR 80000000H) AND (( **SRC** + **DST** ) XOR **SRC** ) AND 80000000H) ≠ 0

**SRC**和**DST**是整个 32 位整数值。

该表达式本质上比较了和的符号和加数的符号。

仅根据单个位来表示溢出不是很实用，因为您需要有效地复制一个完整的 32 位加法器。这不是一个好的候选人。

如果您想要一个类似的减法表达式，请尝试推导它，或者只用加法表示减法，就像在[这个答案](https://stackoverflow.com/a/8037485/968261)`Sbb()`中的函数中所做的那样。应该不难。

使用测试来确保您的代码有效也是一个好主意。您甚至可以编写一个用于加法/减法的小型汇编程序，它会返回溢出标志并使用它来测试单行代码的正确性。**

# java - for 循环中的 if 语句

> ID：11253702
> 
> 赞同：-4
> 
> 时间：2012-06-28T22:16:52.150
> 
> 标签：java, if-statement, for-loop

不工作

```
 int sum = 0;
          for (int index = 0; index < ratpop; index++) {

// verify whether population falls within blast radius
             if (xcord[index + 1] - xcord[index] <= str
                   || ycord[index + 1] - ycord[index] <= str) 

{
                // if it does sum population of both points
                sum += pop[index] + pop[index + 1];
             }
          }
          // prints out sum and the cordinates are not correct have to figure out
          // later
          System.out.println(xcord[1] + " " + ycord[0] + " " + sum);
       }
    } 
```

我必须列出 x 坐标之一和 y 坐标之一我对这个语句的逻辑是，如果 x 坐标或 y 坐标小于变量 str 则求和，如果不是，但它不会这样做，无论如何它都会求和。这是我最初的问题，但没有可能阻止其他人尝试的所有额外内容，在此先感谢所有使这个网站变得很棒的爱好者，我对误解表示歉意。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T00:17:46.180

问题是您正在尝试访问超出数组范围的索引...

```
 for (int index = 0; index < ratpop - 1; index++) { 
```

这将让您访问 [index+1] 而不会收到 ArrayIndexOutOfBoundsException

# ruby-on-rails - 如何为此模式建模 Rails 关联

> ID：11253705
> 
> 赞同：1
> 
> 时间：2012-06-28T22:17:00.957
> 
> 标签：ruby-on-rails, model, associations

我正在尝试设置三个模型：位置/场地、类别和社区。

位置必须具有父类别和子类别，而其邻居是可选的。在类别模型中，有顶级类别或子类别。

鉴于上述情况，这是定义模型关联的正确方法吗？

```
class Location < ActiveRecord::Base
  attr_accessible # location-specific columns

  belongs_to :category
  belongs_to :parent_category, :class_name => "Category"
  belongs_to :neighborhood
end

class Category < ActiveRecord::Base
  has_many :locations
  has_many :subcategories, :class_name => "Category", :foreign_key => "parent_category_id"
  belongs_to :parent_category, :class_name => "Category"
end

class Neighborhood < ActiveRecord::Base
  has_many :locations
end 
```

（实际上，在阅读了更多适当的[Rails Guide](http://guides.rubyonrails.org/association_basics.html)之后，看起来多态关联可能更合适？）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T00:02:57.500

这在某种程度上取决于您希望您的位置和类别关系如何工作；但是，如果您说 Location 必须属于子类别*和*类别，那么您的意思似乎是 Location 必须仅属于子类别（具有类别）。所以我认为你的关联是正确的，除了 Location 上的“parent_category”是多余的。

例如，假设我有以下内容：

```
 music = Category.create {title: 'Music'}
    rock = Category.create {title: 'Rock', parent_category_id: music.id} 
    location = Location.create {title: 'The Fillmore', category_id: rock.id} 
```

现在我有一个类别为“摇滚”的位置，我可以像这样找出它的父类别（“音乐”）：

```
 location.category.parent_category 
```

鉴于您概述的内容，我认为不需要任何多态关联。

# android - Android 按钮在应该显示时并不总是可见

> ID：11253707
> 
> 赞同：0
> 
> 时间：2012-06-28T22:17:16.177
> 
> 标签：android, android-button

有没有人对我应该如何处理不总是正确响应的按钮有任何建议`button.setVisibility (View.VISIBLE)`？

我已经看到我的代码在调试器中逐步运行。该行肯定正在执行，但按钮并不总是从不可见变为可见。

没有错误消息，并且`setVisibility()`命令正在`runOnUiThread()`. 另外，我正在尽最大努力仔细管理我的线程，所以我认为在命令运行之前运行不会有问题。

有没有人有任何想法？

谢谢，R。

为了响应非常合理的请求，我添加了以下描述和代码（无论如何，什么是“alpha 通道”？）

我的应用程序本质上是一个 Android SurfaceRunner。启动时，活动表面被插入到定义我的按钮的 XML 布局中。有些按钮在 SurfaceRunner 之外，有些在上面。这是给我带来问题的最重要的人（如果这很重要的话）。但是，我还应该指出，它们也是我的代码中唯一开始不可见的部分——开始不可见似乎是问题所在。我从未遇到过任何开始可见的按钮的问题。顺便说一句，没有一个按钮在 XML 中被标记为不可见

按钮显示是使用一种方法处理的，`lblButtons()`每次完成可能影响按钮的操作时都会调用该方法。这是很多代码，所以我只包括这里不能正常工作的部分：

```
rtButton2.setVisibility (View.INVISIBLE);       
rtButton2.setTextColor (DF_VIEW == currState ? Color.BLACK : Color.WHITE);
rtButton2.setBackgroundDrawable (DF_VIEW == currState ? tr_black : tr_white);
if (currState == SEARCH_VIEW)
{
    rtButton2.setTextSize (24f);
    rtButton2.setText (Html.fromHtml (Integer.toString (app.currThr)));
    rtButton2.setVisibility (View.VISIBLE);
}
else if (listening) 
{
    rtButton2.setTextSize (14f);
    rtButton2.setText (Html.fromHtml (muting ? UNMUTE : MUTE));
    rtButton2.setVisibility (View.VISIBLE);
}

rtButton3.setVisibility (View.INVISIBLE);
rtButton3.setTextSize (14f);
rtButton3.setTextColor (DF_VIEW == currState ? Color.BLACK : Color.WHITE);
rtButton3.setBackgroundDrawable (DF_VIEW == currState ? tr_black : tr_white);
if (listening)
{
    rtButton3.setText (Html.fromHtml (recording ? STOP + "<br />" + RECORD : RECORD));
    rtButton3.setVisibility (View.VISIBLE);
} 
```

“listening”是一个布尔值，“currState”是一个枚举状态变量。当我在调试器中运行此代码并且监听为真时，步骤顺序完全符合应有的顺序（即，rtButton2 和 rtButton3 的`setText()`and`setVisibility()`方法都已执行，但是这两个按钮的可见性永远不会受到影响。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T13:56:37.737

会不会就像您将 textColor 和背景设置为黑色或白色一样，这与您的活动或容器的背景颜色相匹配，可以是黑色或白色......所以一切都与您的背景匹配并且看起来不可见？

我相当怀疑这两行代码。

```
rtButton2.setTextColor (DF_VIEW == currState ? Color.BLACK : Color.WHITE);
rtButton2.setBackgroundDrawable (DF_VIEW == currState ? tr_black : tr_white); 
```

将按钮文本和背景的颜色设置为与容器颜色不匹配的颜色。

问候， Aqif hamid

# java - SMSLib 不使用 E226 3G 调制解调器发送 SMS

> ID：11253712
> 
> 赞同：1
> 
> 时间：2012-06-28T22:17:46.210
> 
> 标签：java, modem, 3g, smslib

我想知道是否有人知道为什么我不能用我的 E226 3g 调制解调器发送短信。我已经配置了示例类，我设置了调制解调器型号、PIN 和 Smsc 号码。

```
public class SendMessage
{
    public void doIt() throws Exception
    {
        OutboundNotification outboundNotification = new OutboundNotification();
        System.out.println("Example: Send message from a serial gsm modem.");
        System.out.println(Library.getLibraryDescription());
        System.out.println("Version: " + Library.getLibraryVersion());
        SerialModemGateway gateway = new SerialModemGateway("modem.com1", "COM4", 9600, "Huawei", "E226");
        gateway.setInbound(true);
        gateway.setOutbound(true);
        gateway.setSimPin("1010");
        // Explicit SMSC address set is required for some modems.
        // Below is for VODAFONE GREECE - be sure to set your own!
        gateway.setSmscNumber("+555181136200");
        Service.getInstance().setOutboundMessageNotification(outboundNotification);
        Service.getInstance().addGateway(gateway);
        Service.getInstance().startService();
        System.out.println();
        System.out.println("Modem Information:");
        System.out.println("  Manufacturer: " + gateway.getManufacturer());
        System.out.println("  Model: " + gateway.getModel());
        System.out.println("  Serial No: " + gateway.getSerialNo());
        System.out.println("  SIM IMSI: " + gateway.getImsi());
        System.out.println("  Signal Level: " + gateway.getSignalLevel() + " dBm");
        System.out.println("  Battery Level: " + gateway.getBatteryLevel() + "%");
        System.out.println();
        // Send a message synchronously.
        OutboundMessage msg = new OutboundMessage("+556199655944", "Hello from SMSLib!");
        Service.getInstance().sendMessage(msg);
        System.out.println(msg);
        // Or, send out a WAP SI message.
        //OutboundWapSIMessage wapMsg = new OutboundWapSIMessage("306974000000",  new URL("http://www.smslib.org/"), "Visit SMSLib now!");
        //Service.getInstance().sendMessage(wapMsg);
        //System.out.println(wapMsg);
        // You can also queue some asynchronous messages to see how the callbacks
        // are called...
        //msg = new OutboundMessage("309999999999", "Wrong number!");
        //srv.queueMessage(msg, gateway.getGatewayId());
        //msg = new OutboundMessage("308888888888", "Wrong number!");
        //srv.queueMessage(msg, gateway.getGatewayId());
        System.out.println("Now Sleeping - Hit <enter> to terminate.");
        System.in.read();
        Service.getInstance().stopService();
    }

    public class OutboundNotification implements IOutboundMessageNotification
    {
        public void process(AGateway gateway, OutboundMessage msg)
        {
            System.out.println("Outbound handler called from Gateway: " + gateway.getGatewayId());
            System.out.println(msg);
        }
    }

    public static void main(String args[])
    {
        SendMessage app = new SendMessage();
        try
        {
            app.doIt();
        }
        catch (Exception e)
        {
            e.printStackTrace();
        }
    }
} 
```

它输出

```
run:
Example: Send message from a serial gsm modem.
SMSLib: A Java API library for sending and receiving SMS via a GSM modem or other supported gateways.
This software is distributed under the terms of the Apache v2.0 License.
Web Site: http://smslib.org
Version: 3.5.2
0      2012-06-28 19:08:32,652 [main] INFO  org.smslib.Service  - SMSLib: A Java API library for sending and receiving SMS via a GSM modem or other supported gateways.
This software is distributed under the terms of the Apache v2.0 License.
Web Site: http://smslib.org
3      2012-06-28 19:08:32,655 [main] INFO  org.smslib.Service  - Version: 3.5.2
3      2012-06-28 19:08:32,655 [main] INFO  org.smslib.Service  - JRE Version: 1.7.0_05
5      2012-06-28 19:08:32,657 [main] INFO  org.smslib.Service  - JRE Impl Version: 23.1-b03
Exception in thread "Thread-3" java.lang.ExceptionInInitializerError
5      2012-06-28 19:08:32,657 [main] INFO  org.smslib.Service  - O/S: Windows 7 / amd64 / 6.1
8      2012-06-28 19:08:32,660 [main] DEBUG org.smslib.threading.AServiceThread  - Initialized.
8      2012-06-28 19:08:32,660 [NotifyQueueManager] DEBUG org.smslib.threading.AServiceThread  - Running...
8      2012-06-28 19:08:32,660 [NotifyQueueManager] DEBUG org.smslib.notify.NotifyQueueManager$NotificationQueueManager  - NotifyQueueManager running...
9      2012-06-28 19:08:32,661 [main] INFO  org.smslib.queues.DefaultQueueManager  - Queue directory not defined. Queued messages will not be saved to filesystem.
9      2012-06-28 19:08:32,661 [main] DEBUG org.smslib.threading.AServiceThread  - Initialized.
10     2012-06-28 19:08:32,662 [DelayQueueManager] DEBUG org.smslib.threading.AServiceThread  - Running...
10     2012-06-28 19:08:32,662 [DelayQueueManager] DEBUG org.smslib.queues.AbstractQueueManager$DelayQueueManager  - DelayQueueManager running...
10     2012-06-28 19:08:32,662 [main] DEBUG org.smslib.threading.AServiceThread  - Initialized.
    at org.smslib.modem.SerialModemDriver.connectPort(SerialModemDriver.java:69)
    at org.smslib.modem.AModemDriver.connect(AModemDriver.java:114)
10     2012-06-28 19:08:32,662 [WatchDog] DEBUG org.smslib.threading.AServiceThread  - Running...
    at org.smslib.modem.ModemGateway.startGateway(ModemGateway.java:189)
11     2012-06-28 19:08:32,663 [Thread-3] INFO  org.smslib.modem.ModemGateway  - GTW: modem.com1: Starting gateway, using Huawei E226 AT Handler.
    at org.smslib.Service$1Starter.run(Service.java:276)
Caused by: java.lang.RuntimeException: CommPortIdentifier class not found
11     2012-06-28 19:08:32,663 [Thread-3] INFO  org.smslib.modem.SerialModemDriver  - GTW: modem.com1: Opening: COM4 @9600
    at org.smslib.helper.CommPortIdentifier.<clinit>(CommPortIdentifier.java:76)
    ... 4 more
15010  2012-06-28 19:08:47,662 [WatchDog] DEBUG org.smslib.threading.AServiceThread  - Running...
30011  2012-06-28 19:09:02,663 [WatchDog] DEBUG org.smslib.threading.AServiceThread  - Running...
45012  2012-06-28 19:09:17,664 [WatchDog] DEBUG org.smslib.threading.AServiceThread  - Running...
60012  2012-06-28 19:09:32,664 [WatchDog] DEBUG org.smslib.threading.AServiceThread  - Running...
75013  2012-06-28 19:09:47,665 [WatchDog] DEBUG org.smslib.threading.AServiceThread  - Running...
90014  2012-06-28 19:10:02,666 [WatchDog] DEBUG org.smslib.threading.AServiceThread  - Running... 
```

这就是我几个小时所得到的。知道为什么不起作用吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T22:23:46.217

```
Caused by: java.lang.RuntimeException: CommPortIdentifier class not found 
```

您缺少一个库，以包含`CommPortIdentifier`. 找出您需要的库并将其包含在类路径中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-28T22:33:33.547

您缺少 javax.comm。Windows 上 javax.comm 的情况有点混乱，[smslib 安装说明](http://smslib.org/doc/installation/)建议改用 rxtx 并指向[Cloudhopper 的页面](http://www.cloudhopper.com/opensource/rxtx/)以获取 Windows 版本。获取该库，将其作为依赖项添加到您的项目中，您应该一切就绪。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T09:46:40.437

您缺少通讯库。有两个库可以解决此问题。

这是引发此错误的代码片段：

```
try
        {
            classCommPortIdentifier = Class.forName("javax.comm.CommPortIdentifier");
        }
        catch (ClassNotFoundException e1)
        {
            try
            {
                classCommPortIdentifier = Class.forName("gnu.io.CommPortIdentifier");
            }
            catch (ClassNotFoundException e2)
            {
                throw new RuntimeException("CommPortIdentifier class not found");
            }
        } 
```

因此，请确保任何`javax.comm.CommPortIdentifier`一个`gnu.io.CommPortIdentifier`类都在您的类路径中。此外，请确保将本机**rxtxSerial.dll**添加到 {jre}/bin/

`gnu.io.CommPortIdentifier`来自 具有**新包装约定的****rxtx**库。

 ***最近有包名称更改，因此您会在使用 RxTx 库时感到困惑。请从上面的代码中得到一些想法，让你明白*

以下是[网站](http://rxtx.qbang.org/wiki/index.php/Download)上提到的内容：

*RXTX 2.1 是 RXTX 的主要开发分支。使用的命名空间是 gnu.io。*. 除非您有任何特定原因，否则这是推荐的下载。如果您需要与 javax.comm.* 兼容，请下载 RXTX 2.0，但请注意，该分支没有提供太多的开发工作，因此您将错过主分支正在获得的所有修复。***

# iphone - 在 iOS 上创建发光的文本效果

> ID：11253713
> 
> 赞同：9
> 
> 时间：2012-06-28T22:17:55.233
> 
> 标签：iphone, objective-c, ios

我们目前正在构建一个 iPhone 应用程序，并希望文本具有发光效果以适应逼真的 UI 设计。

这是我们正在努力实现的目标。

![发光的文字](../Images/e7c038e6f626d063e05cf842fd746025.png)

我们目前正在努力创建内部发光效果，因此我们将不胜感激。

在 Photoshop 中这个文本有

*   #98c1c1 的颜色
*   外发光：#ffffff，屏幕混合模式，30% 不透明度，5px 大小。
*   内发光：#c79d85，颜色减淡混合模式，70% 不透明度，5px 大小。

谢谢，马克。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-28T22:43:57.820

要设置带有 #98c1c1 文本颜色的按钮，请使用：

```
UILabel *label = [[UILabel alloc] initWithFrame:CGRectMake(100, 100, 100, 60)];
label.textColor = [UIColor colorWithRed:((float)152/255) green:((float) 193/255) blue:((float) 193/255) alpha:1.0f]; 
```

我用 Photoshop 找到了#98c1c1 的 RGB 分量，结果是 R:152 G:193 B:193。并`colorWithRed:green:blue:alpha:`取一个介于 0 和 1 之间的归一化值，这就是为什么我将 RGB 值设为超过 255 的原因。

对于外发光，使用：

```
label.layer.shadowColor = [UIColor whiteColor].CGColor;
label.layer.shadowOffset = CGSizeMake(0.0, 0.0);    
label.layer.shadowRadius = 10.0;
label.layer.shadowOpacity = 0.3;
label.layer.masksToBounds = NO; 
```

您希望不透明度为 30%，阴影颜色为 #ffffff（白色）。这就是`label.layer.shadowOpacity`设置为 0.3 (30%) 并`label.layer.shadowColor`设置为白色的原因。

我不太确定如何实现内发光，但您可以创建一个复制文本但使字体更小并使新文本居中的方法，以创建内发光的效果。记得导入`<Quartzcore/Quartzcore.h>`！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-02-17T01:22:52.983

更新[pasawaya 发布](https://stackoverflow.com/a/11253941)的代码：

```
label.layer.shadowColor = ([UIColor .green] as! CGColor)
label.layer.shadowOffset = CGSize.zero
label.layer.shadowRadius = 10.0;
label.layer.shadowOpacity = 0.
label.layer.masksToBounds = false 
```

# android - 如何在android中突出显示imageview

> ID：11253714
> 
> 赞同：2
> 
> 时间：2012-06-28T22:17:59.077
> 
> 标签：android

有没有办法以编程方式突出显示android中的imageview？

我正在展示扑克牌，我想突出显示或遮蔽特定的牌（图像视图）。我怎样才能做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-28T22:20:55.160

签[出 imageView.setColorFilter()](http://developer.android.com/reference/android/widget/ImageView.html#setColorFilter%28int,%20android.graphics.PorterDuff.Mode%29)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T23:12:39.673

如果您有自定义突出显示轮廓。

您可以将 ImageView 放在 LinearLayout 中。将突出显示的图像设置为布局的背景。进行一些边距调整后，您将获得细粒度的自定义突出显示。

# javascript - 如何使用 Object.create() 而不是 new 创建具有私有成员的对象

> ID：11253717
> 
> 赞同：7
> 
> 时间：2012-06-28T22:18:08.657
> 
> 标签：javascript, design-patterns, prototype-programming, private-members

编辑：我最终从Bergi的回答中弄清楚了。

谢谢伯吉。

```
pubPrivExample = (function () {
    return {
        init : function () {
            var private;

            this.setPrivate = function (p) {
                private = p;
            };
            this.getPrivate = function () {
                return private;
            };
        },

        public : "This is public\n"
    };
}());

var a;

a = Object.create(pubPrivExample);
a.init();
a.setPrivate("This is private");

document.write(a.getPrivate()); 
```

编辑：看来我的问题的答案是不相干的。我真的对工厂不感兴趣，实际上宁愿不使用 if。我的问题是关于私人国家的。从 Bergi 的回答和评论中，我想我可以把一些东西放在一起。

待续...

编辑：Bergi 已经开始回答下面的问题，但忽略了最重要的部分——私有状态。

我有时间更多地考虑这个想法，但是如果没有某种工厂，我仍然无法使用 Object.create() 实现私有状态。但我想错了，Bergi 提到了一个解决方案......随意以 Bergi 的回答为起点。

原文：我对避免`new`使用 javascript 的追求将我带到了一个特殊的地方。我想要私有对象成员，但我不想放弃`Object.create()`。

这是代码。

```
var trackQueue = {};

trackQueue.factory = function () {
    var that, queue;
    that = this;
    queue = [];

    that.push = function (item) {
        queue.push(item);
    };

    that.work = function () {
        document.write(queue + "<br />");
    };

    return {
        work : that.work,
        push : that.push
    };        
};

var a = Object.create( trackQueue.factory() );
a.push("a");
a.push("b");
a.push("c");

var b = Object.create( trackQueue.factory() );
b.push("d");
b.push("e");
b.push("f");

a.work();
b.work(); 
```

还有一个jsfiddle

[http://jsfiddle.net/dsjbirch/Wj6cp/10/](http://jsfiddle.net/dsjbirch/Wj6cp/10/)

该方法会`init`是一个更惯用/更合适的名称`factory`吗？

这是疯了吗？

友善点 - javascript 不是我的第一语言。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T22:30:11.020

是的，原型上的 init 方法可能是更合适的名称：

```
var proto = {
    init: function(args) {
        // setting up private-scoped vars,
        var example = args;
        // privileged methods
        this.accessPrivate = function(){ return example; };
        // and other stuff
        this.public = 5;
    },
    prop: "defaultvalue",
    ...
}

var instance = Object.create(proto);
instance.init(); 
```

但是，绝对没有理由不使用带有 new 关键字的经典构造函数，它优雅地结合了`Object.create`and`init`调用。

请注意，您使用`Object.create`的是绝对没有用的。您的工厂模式（完全有效的应用）返回好的对象。无需为从它们继承*的每个对象创建新对象。*做就是了：

```
var instance = trackQueue.factory(); 
```

如果您喜欢方法名称“create”的声音，您可以为您的工厂使用更惯用的名称：

```
trackQueueFactory.create = function(args) {...}; 
```

* * *

编辑：您将工厂模式与原型继承相结合的想法并没有那么错误。然而，所有制造对象继承的原型对象需要是静态的，而不是*在每次调用时创建一个新*对象。您的代码可能如下所示：

```
var factory = {
    proto: {
        ...
    },
    create: function(args) {
        var product = Object.create(this.proto);
        // set up private vars scoped to the create function
        // privileged methods
        product.doSomethingSpecial = function(){ ... };
        // and other stuff
    }
};

var a = factory.create(...); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-02T04:53:28.217

我认为这是实现您的要求的明确方法：

```
var personFactory = function(id, name, age){
    var _id = id;
    var _name = name;
    var _age = age;

    var personPrototype = {
        getId: function(){
            return _id;
        },
        setId: function(id){
            _id = id;
        },
        getName: function(){
            return _name;
        },
        setName: function(name){
            _name = name;
        },
        getAge: function(){
            return _age; 
        },
        setAge: function(age){
            _age = age;
        },
        work: function(){
            document.write(this.toString());
        },
        toString: function(){
            return "Id: " + _id + " - Name: " + _name + " - Age: " + _age;
        }
    };

    return Object.create(personPrototype);
}; 
```

用法：

```
var renato = personFactory(1, "Renato Gama", 25);
console.log(renato.getName()); //logs "Renato Gama"
renato.setName("Renato Mendonça da Gama");
console.log(renato.getName()); //logs "Renato Mendonça da Gama" 
```

如果我没记错的话，这是 MODULE PATTERN 的用法之一。请参阅[这篇文章](http://javascriptplayground.com/blog/2012/04/javascript-module-pattern)以获得更好的解释。[这](http://www.adequatelygood.com/2010/3/JavaScript-Module-Pattern-In-Depth/)也是一篇关于这个主题的好帖子。

# python - python-daemon 阻止对 ctypes 链接的 C 用户库的 ioctl 调用

> ID：11253720
> 
> 赞同：1
> 
> 时间：2012-06-28T22:18:18.197
> 
> 标签：python, ctypes, bottle, ioctl, python-daemon

我在瓶子网络服务器中有一个 Python 应用程序，它通过 Linux 平台上的 ctypes Python 模块访问 C 共享对象库。C so-lib 打开一个设备节点 ( `/dev/myhwdev`) 并针对设备的文件描述符声明一个 IOCTL 函数。虽然这是一个复杂的堆栈，但在我将瓶子应用程序包装在 Python 的 python-daemon 上下文中之前它工作得很好，如下所示：

```
# -*- coding: utf-8 -*-
import daemon
import bottle
from bottle import run, route, request

from userlib_via_ctypes_module import *
userlib_grab_device_file_descriptor()

@route('/regread')
def show_regread():
    address = request.query.address or request.forms.address
    length = request.query.length or request.forms.length
    return {'results':assert_ioctl_via_userlib(address, length)}

daemonContext = daemon.DaemonContext(
    detach_process = False
    )
with daemonContext:
    try:
        run(host = '0.0.0.0', port = '80', debug = True)
    except:
        print "(E) Bottle web-service was stopped.\n"; 
```

只需注释掉该`with daemonContext`行（并更正缩进）就可以使该代码正常工作（即，提供正确的 JSON 结果）。但是，在 daemonContext 中，我的 userlib 中的打印语句显示我的设备节点的文件描述符已正确打开，但 ioctl 函数静默失败，错误代码为 -1。

关闭设备的文件描述符并重新打开它（在 userlib 代码或上述路由处理程序中）允许命令正常工作 - 一次。但是，守护进程和瓶服务器锁定并忽略所有进一步的 Web 请求。

建议？目前，我准备放弃守护程序模块，因为没有它一切正常。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T22:18:19.037

在准备这个问题时，答案对我来说变得很明显。

该`userlib_grab_device_file_descriptor()`函数称为 C 级 SO-lib 函数，它打开硬件设备节点的文件描述符，该文件描述符被传递给 userlib ioctl 函数。

python-daemon 在进入上下文时关闭所有文件句柄 - 包括硬件设备的继承文件描述符。userlib 仍然认为文件描述符是有效的。至少，它会在我的调试消息中将 FD 打印为整数 > 2。但是，用户库不知道，文件句柄确实已关闭，因此 IOCTL 会默默地失败。我希望 uclib 或内核提供了更好的错误消息。:(

无论如何，答案是将打开的文件句柄移动到守护进程上下文的内部，如下所示：

```
...
with daemonContext:
    try:
        userlib_grab_device_file_descriptor()   # open fd here
        run(host = '0.0.0.0', port = '80', debug = True)
    except:
        print "(E) Bottle web-service was stopped.\n"; 
```

我尝试使用 python-daemon 的`files_preserve`属性，但它适用于文件描述符编号，而不是文件名。因此，在打开 fd 之后，我的 userlib 必须将 fd 编号传递给守护进程，因此它可以在进入守护进程之前排除 fd。*...我发现在*守护进程中打开文件描述符更容易。:)

希望这对其他人有帮助。:)

# c# - LoadLibrary、FreeLibrary 和 GetModuleHandle Win32 函数是线程安全的吗？

> ID：11253725
> 
> 赞同：11
> 
> 时间：2012-06-28T22:18:58.493
> 
> 标签：c#, multithreading, winapi

我正在开发与本机 DLL 交互的 Web 服务，我使用 LoadLibrary/GetModuleHandle/FreeLIbrary 和 GetProcAddress 动态加载/卸载 DLL，因为它不是很稳定。

```
public class NativeMethods
{
    [DllImport("kernel32.dll", CharSet = CharSet.Auto, SetLastError = true)]
    public static extern IntPtr LoadLibrary(string libname);

    [DllImport("kernel32.dll", CharSet = CharSet.Auto, SetLastError = true)]
    public static extern IntPtr GetModuleHandle(string libname);

    [DllImport("kernel32.dll", CharSet = CharSet.Auto)]
    public static extern bool FreeLibrary(IntPtr hModule);

    [DllImport("kernel32.dll", CharSet = CharSet.Ansi)]
    public static extern IntPtr GetProcAddress(IntPtr hModule, string lpProcName); 
} 
```

我注意到 w3wp.exe 进程在重负载下偶尔会崩溃，当我尝试调试它时，调试器经常会在我的 NativeMethods.GetModuleHandle() 函数调用处停止。

我找不到任何`GetModuleHandle`不是线程安全的证据，所以我想知道在与多线程 .NET 应用程序交互这些 kernel32.dll 函数时，有没有人有类似的经验？

奥斯卡

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-28T22:56:44.983

根据 Igor Tandetnik（Microsoft MVP）的说法。

除了不是线程安全的 GDI 函数。几乎所有需要 an`HWND`和/或 an 的东西都`HDC`必须在创建`HWND`or的同一线程上调用（和类似的都是值得注意的例外）。s、 s 等可以在线程之间传递，但一次只能由一个线程操作。`HDC``SendMessage``PostMessage``HBITMAP``HICON`

大多数其他函数——那些不处理 GDI 或窗口管理的函数——确实是线程安全的。

这应该包括`LoadLibrary`、`GetModuleHandle`和`FreeLibrary`。`GetProcAddress`

但是请记住，**`FreeLibrary`不应从 DllMain 调用**它。

我还可以补充一点，我在多线程环境中使用这些函数已经有一段时间没有问题了。

# r - igraph 固定节点坐标布局

> ID：11253726
> 
> 赞同：8
> 
> 时间：2012-06-28T22:19:07.840
> 
> 标签：r, igraph

我发现这个[答案](https://stackoverflow.com/a/5364376/1317221)非常有用。它可以帮助我绘制网络/图形并选择图中节点的坐标。

但是，布局将坐标重新调整为 -1 到 1。首先，我试图找出它是如何做到这一点的，但没有。它会做这样的事情吗？

```
(coordinate - mean(coordinates))/(coordinate + mean(coordinates) 
```

其次有没有办法保持原来的坐标？我想用图表来绘制坐标轴，所以不想让顶部重新调整所有内容。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-28T23:39:54.210

第一个问题的答案在`plot.igraph`函数的源代码中；输入`plot.igraph`R 提示符以获取完整的源代码。里面有一段说：

```
layout <- layout.norm(layout, -1, 1, -1, 1) 
```

`layout.norm`是另一个`igraph`为您带来魔力的功能；键入`layout.norm`以查看其工作原理。

现在，第二个问题的答案很简单；只需传递`rescale=F`给 的参数`plot`，这会跳过调用位置`igraph`的整个分支，因此它将与您的原始坐标一起使用。然后，您可以像往常一样使用和设置 X 轴和 Y 轴的限制。`plot.igraph``layout.norm``xlim``ylim`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-15T01:51:46.360

```
 set.seed(111)
  ig <- graph_from_data_frame(as.data.frame(matrix(sample(letters,40,rep=TRUE),nc=2)))
  set.seed(123)
  ig.layout <- layout.fruchterman.reingold(ig)
  rownames(ig.layout) <- V(ig)$name
  par(bg="white",mar=c(0,0,0,0),oma=c(0,0,0,0))
  plot.igraph(ig,layout=ig.layout,vertex.color=adjustcolor("gray",alpha.f=0.5),rescale=FALSE,xlim=c(4,11),ylim=c(4,11))
  set.seed(321)
  ig.sub <- subgraph(ig,sample(V(ig)$name,5))
  plot.igraph(ig.sub,layout=ig.layout[V(ig.sub)$name,],add=TRUE,vertex.color=adjustcolor("orange",alpha.f=0.5),rescale=FALSE) 
```

此代码输出图形，其中橙色节点是稍后添加的。

[![在此处输入图像描述](../Images/c44bcdc11122961da648899ac09ed8af.png)](https://i.stack.imgur.com/Jpqd0.png)

# javascript - Marionettte/Backbone 应用程序中没有方法错误

> ID：11253727
> 
> 赞同：1
> 
> 时间：2012-06-28T22:19:17.913
> 
> 标签：javascript, backbone.js, marionette

我收到“没有方法‘结果’backbone.marionette.js:402 错误”。这是跟踪：

```
Uncaught TypeError: Object function (obj) { return new wrapper(obj); } has no method 'result' backbone.marionette.js:402

Marionette.CollectionView.Marionette.View.extend.buildItemView backbone.marionette.js:402
Marionette.CollectionView.Marionette.View.extend.addItemView backbone.marionette.js:360
Marionette.CollectionView.Marionette.View.extend.showCollection backbone.marionette.js:314 
```

...

在主干.marionette.js 中：

```
// Build an `itemView` for every model in the collection. 
buildItemView: function(item, ItemView){
var itemViewOptions = _.result(this, "itemViewOptions");
    ***Uncaught TypeError: Object function (obj) { return new wrapper(obj); } has no method 'result' ***
var options = _.extend({model: item}, itemViewOptions);
var view = new ItemView(options);
return view;
backbone. }, 
```

我的调用代码：

```
MyApp.module("CatalogsApp.Pasteboard", function(Pasteboard, MyApp, Backbone, Marionette, $, _) {
    var CatalogListView, CatalogView;
    CatalogView = Marionette.ItemView.extend({
      tagName: "div",
      className: "catalog-cell",
      template: "catalogs/catalog"
    });
    CatalogListView = Marionette.CollectionView.extend({
      tagName: "div",
      className: "paste-board",
      itemView: catalogView
    });
    Pasteboard.showCatalogs = function(catalogList) {
      var catalogListView;
      catalogListView = new CatalogListView({
        collection: catalogList
      });
      return MyApp.layout.main.show(catalogListView);
    };
  }); 
```

如果有人有任何线索可能是导致类型错误的问题 - 很高兴得到想法。我快到了，我可以说。catalogList 集合似乎很好 - 从服务器填充。我知道这可能很难破译，但也许有人对如何解决问题有一些想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T23:59:51.887

确保您拥有最新的 underscore.js 版本。在 v1.3.3 中添加了“结果”功能

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T23:16:48.440

当你这样做时，你正在覆盖你的类定义`var catalogListView;`。

约定是将您的类定义的名称大写，如下所示：

```
MyApp.module("CatalogsApp.Pasteboard", function(Pasteboard, MyApp, Backbone, Marionette, $, _) {
    var CatalogListView, CatalogView;
    CatalogView = Marionette.ItemView.extend({
      tagName: "div",
      className: "catalog-cell",
      template: "catalogs/catalog"
    });
    CatalogListView = Marionette.CollectionView.extend({
      tagName: "div",
      className: "paste-board",
      itemView: CatalogView
    });
    Pasteboard.showCatalogs = function(catalogList) {
      var catalogListView;
      catalogListView = new CatalogListView({
        collection: catalogList
      });
      return MyApp.layout.main.show(catalogListView);
    };
  }); 
```

# windows-installer - 确定用于安装 Windows 服务的 MSI

> ID：11253731
> 
> 赞同：0
> 
> 时间：2012-06-28T22:20:08.480
> 
> 标签：windows-installer, wmi

有没有办法使用 Win32_Class 和 C# 结合 ManagementBaseObject 来确定用于安装 Windows 服务的 MSI？还是其他方式（最好使用 C#）？

我需要遍历所有当前服务并询问（某些实体...MSI 数据库？）谁安装了此服务？

在 Win32_Service WMI 类上使用 ManagementObjectSearcher 查询遍历我可以执行的所有服务，但我看不到任何方法可以与用于提供服务的 MSI（如果有的话）联系起来。我知道并非所有服务都是使用 MSI 安装的，但对于那些服务，我想记录这些服务以生成我要生成的报告。

关于如何做到这一点的任何想法？

# javascript - 在 SSL 重定向上的 firefox 和 chrome 中 document.referrer 为空白

> ID：11253732
> 
> 赞同：2
> 
> 时间：2012-06-28T22:20:17.797
> 
> 标签：javascript, google-chrome, ssl, referrer, http-status-code-302

javascript 中的 document.referrer 在 Firefox 和 Chrome 中使用 F5 负载平衡器从 http 到 https 的 302 重定向为空白，但在 IE 中显示。是否有这样做的原因或检测推荐人的方法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-28T22:25:03.830

这是重定向/链接跨协议站点时的一项安全功能。

从来没有办法检测到正确的引荐来源网址，因为客户端可以轻松地欺骗或禁用它们。

# qt - QSvgRenderer boundsOnElement() 总是为文本元素返回大小 0,0

> ID：11253734
> 
> 赞同：0
> 
> 时间：2012-06-28T22:20:29.560
> 
> 标签：qt, svg, pyside, typesetting

我在使用 QSvgRenderer 和文本元素时遇到了一些麻烦；每次调用 boundsOnElement() 时，我都会返回一个正确对应于文本元素左上角的 QRect（当然是在应用 matrixForElement() 之后），但它的宽度和高度始终为零。

我正在使用 PySide，因此可能是某些未实现的 Python 层有问题，但是[Qt 和其他地方对 SVG 文本的支持不佳](https://stackoverflow.com/questions/3119882/library-for-text-rendering-that-supports-text-on-path)让我不这么认为。有没有人：

*   直接使用Qt体验过这个，

而且，更重要的是：

*   知道如何在 Qt 中获取 SVG 文本元素的大小吗？

我正在考虑根据字体大小、字符串长度等尝试手动猜测，但这似乎很容易出错，如果可以的话，我想正确地做。如果有人有任何排版经验，如果我必须破解这个，我需要考虑的事情的指针当然是受欢迎的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T20:04:50.490

我也遇到过这个错误。一种替代方法是使用[QFontMetrics](http://doc.qt.nokia.com/4.7-snapshot/qfontmetrics.html)类。（或[QFontMetricsF](http://doc.qt.nokia.com/4.7-snapshot/qfontmetricsf.html)类）

例子：

```
QSvgGenerator svg;
QFont font("Arial", 12);
QFontMetricsF metrics(font, &svg);

QString text = "My SVG String";
QRectF bounds = metrics.boundingRect(text); 
```

这将返回非零边界。但是，根据我的经验，虽然此例程将返回准确的原点和高度信息，但宽度通常比应有的长。您的文本字符串越长，此边界框末尾的“填充”就越多。如果有人对此错误有解决方案***，***请告诉我。

更新：这个尺寸错误是特定字体所独有的。例如：Times New Roman 似乎计算得非常准确，而其他字体可能计算得太短或太长。这似乎暗示了 Qt 正在使用的算法忽略了某些字体中的特定特征。

# smtp - 修改 IMAP 和 SMTP 服务器以不使用 Gmail 的默认值

> ID：11253737
> 
> 赞同：0
> 
> 时间：2012-06-28T22:20:51.150
> 
> 标签：smtp, gmail, imap

我正在为我的电子邮件使用谷歌应用程序。像这样配置它：

```
Incoming Mail (IMAP) Server - requires SSL: imap.gmail.com 
Use SSL: Yes
Port: 993 
Outgoing Mail (SMTP) Server - requires TLS: smtp.gmail.com 
Use Authentication: Yes 
Use STARTTLS: Yes (some clients call this SSL)
Port: 465 or 587 
```

但是我如何使用其他命名的服务器，你看不到 gmail.com？像 imap.mydomain.com 而不是 imap.gmail.com。与传出服务器相同。是否可以更改我的 DNS 设置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T22:24:59.687

如果你真的想这样做，你可以在你的 DNS 区域中设置一些 CNAME：

```
imap.example.com. IN CNAME imap.gmail.com.
smtp.example.com. IN CNAME smtp.gmail.com. 
```

其他人仍然很容易发现您正在使用 Google Apps，尽管这会将其隐藏起来，并且最终用户不想查看它。

# javascript - d3.js - 父级值大于子级总和的树形图

> ID：11253740
> 
> 赞同：2
> 
> 时间：2012-06-28T22:21:03.257
> 
> 标签：javascript, d3.js, treemap

我正在尝试使用 d3.js 显示一个树形图，其中父级的值可能大于其子级的总和。例如，假设我正在可视化命名空间层次结构中的代码行。命名空间 B 和 C 是 A 的子级，各占 1 行。命名空间 A 是 3 行 - 1 行用于 B 和 C，1 行用于自身。因此，仅 B 和 C 并不能决定 A 的大小。

我想在树形图上显示这个属性。特别是，父级应该是大小正确成比例的子级矩形之上的一个矩形。如果父级没有添加任何额外的大小，则父级仍应显示，但尺寸最小（可能是跨越子级顶部的一个小矩形，只是为了指示父级名称）。

目前，子值节点只是在层次结构中向上传播，而不考虑非叶节点的实际大小。

我想要 d3.js 中的解决方案，因为这是我在其余代码中使用的库，但如果它解决了问题，我对另一个框架持开放态度。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T06:23:29.617

您可能想尝试[拉取请求 #574](https://github.com/mbostock/d3/pull/574)，它允许内部层次结构节点具有价值。

否则，您可以将不可见的虚拟节点添加到您的数据中，这些节点包含与内部节点相关联但未被其子节点考虑的额外值。渲染树形图时，您可以[过滤](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/filter)这些节点以防止它们被显示（即使它们是布局的一部分）。或者您可以将其样式设置为显示：无。

# haskell - Data.Serialize "Either String" 的正确用法是什么

> ID：11253744
> 
> 赞同：1
> 
> 时间：2012-06-28T22:21:21.907
> 
> 标签：haskell

我对 Data.Serialize 有疑问。当我对数据结构进行编码时，我可以对作为 Serialize 类实例的所有数据结构进行编码。这很好用。

然后我通过网络发送它。

但是，我在解码时遇到了问题。解码函数给了我一个名为“ `Either String`”的类型，我不太清楚如何进一步使用它来重建我的原始数据结构，接收者只知道它以前是`Serialize`.

```
receiveMessage :: Socket -> IO (a, SockAddr)
receiveMessage s  = do
        (msg, remoteSockAddr) <- recvFrom s 512
        return (S.decode $ msg, remoteSockAddr)

  Couldn't match type `a' with `Either String a0'
      `a' is a rigid type variable bound by
          the type signature for receiveMessage :: Socket -> IO (a, SockAddr)
    In the expression: decode $ msg
    In the first argument of `return', namely
      `(decode $ msg, remoteSockAddr)'
    In the expression: return (decode $ msg, remoteSockAddr) 
```

使用 eg `receiveMessage :: (Serialize a) => Socket -> IO (a, SockAddr)`也无济于事。我该如何处理并最好地取回我的原始数据结构？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-28T22:27:15.293

`Either`是一种处理错误的类型。就像`Maybe`您可以将任意值（在本例中为 some `String`）与对应于`Maybe`'s的“错误”情况相关联`Nothing`。

也就是说，`Either String a`意味着结果可能是 a`String`或您要反序列化的数据。

您可以`Either`通过模式匹配获取数据。`Either`有两个构造函数：`Left`和`Right`. 在这种情况下，`Left`会有一些字符串并且`Right`会有你的值。所以你会做这样的事情：

```
case S.decode msg of
  Left str  -> ... -- handle your data not being deserialized correctly here
  Right res -> ... -- res is your data 
```

此外，您必须指定结果是某种可序列化的类型。现在，您的`receiveMessage`函数承诺返回*任何*类型`a`；相反，您只能从`Serialize`类中返回一个类型。因此，将类型签名更改为类似`Serialize a => Socket -> IO (a, SockAddr)`.

当你实际使用你的函数时，`Haskell`会知道`a`应该是什么类型，并会选择适当的反序列化代码。但是，由于此代码仅存在于类型类的实例中`Serialize`，因此您必须在类型签名中指定它。

`$`在不相关的说明中：您不需要`S.decode $ msg`. 您可以将运算符视为在其后添加括号，因此该`S.decode $ msg`行等效于`S.decode (msg)`，这是不必要的，可以保留为`S.decode msg`。

# amazon-ec2 - Amazon EC2 计算单元和 GCEU（谷歌计算引擎单元）

> ID：11253746
> 
> 赞同：14
> 
> 时间：2012-06-28T22:21:27.780
> 
> 标签：amazon-ec2, google-compute-engine

所以谷歌现在有自己的 IaaS 解决方案，称为[谷歌计算引擎](http://cloud.google.com/pricing/compute-engine.html)。

作为云计算的重度用户，我试图找出[亚马逊的 EC2 计算单元](http://aws.amazon.com/ec2/instance-types/)和 GCEU（谷歌的计算引擎单元）之间的区别——以确定性价比差异等。

有没有人对这两者之间的区别有更深入的了解？

答案：看起来像 1 GCEU ~= 1 EC2 计算单元。在接受的答案下方有更多信息。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-28T23:34:50.053

据亚马逊称，

> 一个 EC2 计算单元可提供相当于 1.0-1.2 GHz 2007 Opteron 或 2007 Xeon 处理器的 CPU 容量。这也相当于我们原始文档中提到的 2006 年初 1.7 GHz Xeon 处理器。

据谷歌称，

> GCEU（Google Compute Engine Unit），简称 GQ，是我们用来描述实例类型计算能力的 CPU 容量单位。我们选择 2.75 GQ 来代表我们 Sandy Bridge 平台上一个逻辑核心（硬件超线程）的最小功率。

很难与谷歌这样模糊的描述进行 1:1 的比较。假设 Amazon 和 Google 使用相同的 CPU，则如下所示：

以 Amazon 的 Cluster Compute 8 Extra Large Instance 为例，因为它定义了 CPU 和 CU 等级。

88 个 EC2 计算单元（2 个 Intel Xeon E5-2670，八核“Sandy Bridge”架构）

这是 32 个逻辑核心，2x 8 物理超线程。谷歌对一个逻辑核心的评分为 2.75 GQ，结果与亚马逊一致，总共为 88 GQ。

同样，这是假设 Google 和 Amazon 将使用相同的 CPU（这很可能），并且如果没有 Google 的官方声明或正在运行的实例的 CPU-stat 就不可能知道。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-06-28T23:34:53.727

[开发人员文档](https://developers.google.com/compute/docs/instances#gceu)中将2.75 GCEU 的定义定义为由谷歌选择的英特尔 Sandy Bridge 平台处理器中的单个处理内核提供的计算能力。

[Amazon 的文档](http://aws.amazon.com/ec2/instance-types/)将单个 EC2 计算单元定义为“相当于 1.0-1.2 GHz 2007 Opteron 或 2007 Xeon 处理器的 CPU 容量”。在对其中一种服务级别的描述中，它将 33 个 EC2 计算单元定义为大致相当于英特尔旧版 Nehalem 平台的 8 个内核。它还将 88 个 EC2 计算单元定义为大致相当于 Sandy Bridge 的 16 个内核。

盲目假设亚马逊和谷歌在他们的 Sandy Bridge 设置中使用*大致*相同的处理器（不一定是安全的假设），每个 Sandy Bridge 核心大约有 5.5 个 EC2 计算单元。我们现在可以比较这两个单位：将 5.5 除以 2.75 会发生什么？你得到2。

**tl;dr**：一个单位的 GECU*可能*大约是两个单位的 EC2。这是完全和完整的推测，需要通过实际测试和使用来证明。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-31T00:32:24.913

根据 Google Compute Engine 常见问题解答，“一个 GCEU 至少与 1.0-1.2 GHz 2007 Opteron 的 CPU 容量一样强大。” 更多信息在这里：

[https://developers.google.com/compute/docs/faq#morecompute](https://developers.google.com/compute/docs/faq#morecompute)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-05-20T05:27:26.680

最好的答案是您自己的基准测试，因为任何其他基准测试都可能会针对不同的用例提供优化的结果。

第二个最佳答案是独立基准测试，如[http://gigaom.com/2013/03/15/by-the-numbers-how-google-compute-engine-stacks-up-to-amazon-ec2/](http://gigaom.com/2013/03/15/by-the-numbers-how-google-compute-engine-stacks-up-to-amazon-ec2/)。

查看这些数字，思考您的代码是否受 CPU 或 IO 限制是有意义的。使用相同的理论 CPU，如果持久写入速度快 4 倍，您的应用程序的运行速度会快多少？或者如果网络通信速度快 20 倍？

幸运的是，在这两个平台和其他平台上的快速测试应该很快，并且从长远来看可以节省大量成本。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-12-01T11:00:55.967

我知道这已经晚了，但也许它会对某人有所帮助。在单个基准测试运行中：

Google Compute Engine：2014-11-28 10:17:16 上 0.185 秒：1 x Intel(R) Xeon(R) CPU @ 2.60GHz；1.7 GB 内存；Ubuntu 14.04（值得信赖）；PHP 版本：5.5.9-1ubuntu4.5（小）

AWS：2014-12-01 11:00:18 上 0.167 秒：1 x Intel(R) Xeon(R) CPU E5-2670 v2 @ 2.50GHz；2 GB 内存；Ubuntu 14.04（值得信赖）；PHP 版本：5.5.9-1ubuntu4.5（小）

DigitalOcean：2014-12-01 10:03:28 上 0.357 秒：2 x Intel(R) Xeon(R) CPU E5-2630L v2 @ 2.40GHz；2 GB 内存；Ubuntu 14.04（值得信赖）；PHP 版本：5.5.9-1ubuntu4.4（20 美元一个）

使用 ApacheBench：

高考：

*   100 100 = 3.14 #/s - 39 断开连接
*   200 200 = 4.7 #/s - 132 丢弃
*   400 400 = 7.7 #/s - 144 丢弃

AWS：

*   100 100 = 5.8 #/s - 32 丢弃
*   200 200 = 8.9 #/s - 110 下降
*   400 400 = 17.6 #/s - 132 下降

做：

*   100 100 = 4.37 #/s - 31 丢弃
*   200 200 = 6.6 #/s - 131 被丢弃
*   400 400 = 13.5 #/s - 132 个断开连接

# c++ - SGI hash_map：基本查询

> ID：11253748
> 
> 赞同：-1
> 
> 时间：2012-06-28T22:21:39.297
> 
> 标签：c++, hashmap, hashtable, sgi

我是 SGI 的 hash_map 以及 C++ 语言的新手，所以请多多包涵。我试图弄清楚如何初始化一个基本的 hash_map 并从中插入和删除。

我已经这样声明了 hash_map：

```
Sgi::hash_map<int, Process*> ProcessManager::ListProcesses; 
```

我打算通过一个 int 值散列并存储一个指向类 Process 对象的指针。

但是，SGI 文档非常模糊且无用。我正在阅读 hash_map 文件，但也不太了解它。有人可以告诉我从 SGI hash_map 插入和擦除的正确方法吗？

需要明确的是：我正在寻找的是一个可供学习的 BASIC 示例。谢谢，麻烦您了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T22:29:18.647

[SGI 文档](http://www.sgi.com/tech/stl/hash_map.html)中的示例有什么问题？它清楚地展示了如何声明 hash_map 以及如何向其添加值。

```
hash_map<const char*, int, hash<const char*>, eqstr> months;

months["january"] = 31;
months["february"] = 28;
months["march"] = 31; 
```

该变量`months`是 a `hash_map`，它使用 type 的键`const char*`并将它们映射到 type 的值`int`，并且因为您不想通过比较指针值是否相等来比较键，所以它使用了一个名为的自定义相等[函子](http://www.sgi.com/tech/stl/functors.html)`eqstr`，它表示两个`const char*`字符串是否具有相同的内容。

要擦除你使用`erase`成员函数，疯了。

`size_type erase(const key_type& k)` 擦除键为 k 的元素。

所以那将是：

```
months.erase("march"); 
```

SGI 文档远非含糊不清。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-28T22:33:55.853

您可以执行以下操作。

```
Sgi::hash_map<int, Process*> ListProcesses;

Process *p1; // Initialize these
Process *p2;

//Insertion
ListProcesses[10] = p1;  // new element inserted
ListProcesses[20] = p2;  // new element inserted

//Erase
ListProcesses.erase(20);  //(20,p2) deleted 
```

正如 ildjarn 评论的那样，您可以使用[std::unordered_map<>](http://www.cplusplus.com/reference/stl/unordered_map/)而不是 SGI 。

# ios - 用于调整内容大小的 Cocoa 最大化事件

> ID：11253750
> 
> 赞同：1
> 
> 时间：2012-06-28T22:22:03.570
> 
> 标签：ios, cocoa, resize, zooming, nswindow

我有一个`NSWindow`并且已经实施`windowWillResize`。

在这种方法中，我有一些代码可以调整窗口内容的大小。它工作得很好。

但是当用户想用绿色加号按钮（在标题栏中）最大化（缩放）窗口时，窗口正在增长但`windowWillResize`不会被调用。

我试图实现`windowShouldZoom`方法。调用了该方法，但此时我无法获取窗口大小。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T02:39:34.123

像这样的通知`windowWillResize:toSize:`实际上更多地用于约束窗口，例如，对于可能希望在某些边界上对齐窗口的图像查看器。框架可以在根本不调用通知的情况下进行更改（`setFrame:display:`例如），因此依赖此类回调进行布局并不好。

考虑创建一个`NSView`子类作为要排列的视图的父类，然后`resizeSubviewsWithOldSize:`在*视图*级别实现方法。这还有一个好处是您可以将布局逻辑包含在子树中：也许有一天您决定视图不一定需要使用整个窗口（例如，用户控制的侧边栏的显示/隐藏），并且这种方式“主”窗口区域可以神奇地使用分配给它的任何空间来进行布局。

注意使用`NSView`作为resize的依据并不意味着窗口状态不可用；例如，视图可以检测窗口是否已开始或结束“实时调整大小”并相应地优化布局。

# scala - Scala循环遍历对象

> ID：11253755
> 
> 赞同：2
> 
> 时间：2012-06-28T22:22:20.780
> 
> 标签：scala

我通过这条线得到一个对象：

```
val product_array:Option[Any] = scala.util.parsing.json.JSON.parseFull(products_json) 
```

打印出来的对象是这样的：

```
(product1Id,Map(product_picture -> https://upload.wikimedia.org/wikipedia/commons/thumb/7/73/IPhone_3G.png/250px-IPhone_3G.png, product_price -> 299.99, recipient_picture -> https://www.allianz.com/static-resources/de/presse/mediendatenbank/people/v_1338807733000/zimerer_portrait_small_326x217.jpg, product_amount_gifted -> 100.00, recipient_username -> jDoe, product_name -> iPhone 3G, recipient_id -> 12345))(product2Id,Map(product_picture -> https://upload.wikimedia.org/wikipedia/en/thumb/7/7c/1stGen-iPad-HomeScreen.jpg/220px-1stGen-iPad-HomeScreen.jpg, product_price -> 399.99, recipient_picture -> https://image1.masterfile.com/em_w/05/11/94/400-05119409w.jpg, product_amount_gifted -> 200.00, recipient_username -> MJohnson, product_name -> iPad, recipient_id -> 67890)) 
```

如何循环遍历数组/对象以提取键和值？

更新：

当我尝试遍历对象时，它会将空白值发送到键和值，如下所示：

```
for((key, value) <- product_array)     {       

} 
```

这是原始的json：

```
{
   "product1Id":{
      "product_name":"iPhone 3G",
      "product_price":"299.99",
      "product_amount_gifted":"100.00",
      "product_picture":"https:\/\/upload.wikimedia.org\/wikipedia\/commons\/thumb\/7\/73\/IPhone_3G.png\/250px-IPhone_3G.png",
      "recipient_picture":"https:\/\/www.allianz.com\/static-resources\/de\/presse\/mediendatenbank\/people\/v_1338807733000\/zimerer_portrait_small_326x217.jpg",
      "recipient_username":"jDoe",
      "recipient_id":"12345"
   },
   "product2Id":{
      "product_name":"iPad",
      "product_price":"399.99",
      "product_amount_gifted":"200.00",
      "product_picture":"https:\/\/upload.wikimedia.org\/wikipedia\/en\/thumb\/7\/7c\/1stGen-iPad-HomeScreen.jpg\/220px-1stGen-iPad-HomeScreen.jpg",
      "recipient_picture":"https:\/\/image1.masterfile.com\/em_w\/05\/11\/94\/400-05119409w.jpg",
      "recipient_username":"MJohnson",
      "recipient_id":"67890"
   }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T03:00:30.940

首先，请注意`parseFull`返回`Option`，这意味着您的第一步是检查它是否包含某些内容（例如发生解析错误），我建议您为此使用模式匹配：

```
products match {
  case Some(p) => println("Products found")
  case None => println("Error parsing JSON")
} 
```

如果您的选项包含实际值，它将被放置在`p`变量中。接下来，请注意 parseFull 返回`Option[Any]`，所以`p`也是`Any`。它应该在迭代之前进行转换：

```
p.asInstanceOf[Map[String,Map[String,Any]]] 
```

现在您可以遍历地图，让我们使用`for`：

```
for {
  (id, desc) <- p.asInstanceOf[Map[String,Map[String,Any]]]
  (propName, propValue) <- desc
} println(propName + "=" + propValue) 
```

它看起来像一个单循环，但实际上它是一个双循环。它遍历外部映射，并进入每个内部映射。在循环体内，您可以访问、`id`和变量。这可能是您正在寻找的。`desc``propName``propValue`

整个脚本：

```
import scala.util.parsing.json.JSON._

val json = """{"product1Id":{"..."recipient_id":"67890"}}"""

val products = parseFull(json)

products match {
  case Some(p) => 
    for {
      (id, desc) <- p.asInstanceOf[Map[String,Map[String,Any]]]
      (propName, propValue) <- desc
    } println(propName + "=" + propValue)

  case None => println("Error parsing JSON")
} 
```

祝你好运。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-28T22:25:29.200

所以你有一个嵌套的地图。尝试这样的事情：

```
val your_map = product_array.get().asInstanceOf[Map[String,Map[String,Any]]]
for((key1, value1) <- your_map){
    for((key2, value2) <- value1){
        // now use key2 and value2
    }
} 
```

# objective-c - 如果我开启了 ARC，是否需要释放 SystemSoundID？

> ID：11253760
> 
> 赞同：2
> 
> 时间：2012-06-28T22:22:40.370
> 
> 标签：objective-c, ios, xcode, avfoundation, audiotoolbox

问题在标题中：“如果我开启了 ARC，我是否需要释放 SystemSoundID？” 这是我的代码：

```
NSURL *pathURL = [NSURL fileURLWithPath:path];
SystemSoundID soundid;
AudioServicesCreateSystemSoundID((__bridge_retained CFURLRef)pathURL, &soundid);
AudioServicesPlaySystemSound(soundid); 
```

如果是这样，我什么时候发布它？（我没有 dealloc 方法，因为我使用的是静态方法并且无法更改）

另外，这是目前播放音效的最佳方式吗？我听说这个框架现在已弃用。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-28T22:32:19.037

是的，您确实需要释放它。ARC 只关注 Obj-C 对象，a`SystemSoundID`不是 obj-c 对象。在某些时候，您确实需要呼吁`AudioServicesDisposeSystemSoundID()`您的`SystemSoundID`价值。您可以使用系统声音完成例程（使用`AudioServicesAddSystemSoundCompletion()`）来做到这一点。

至于塞尔吉奥在说什么，您正在泄漏`pathURL`对象。您已经使用`__bridge_retained`了 ，它将对象的所有权转移给 CoreFoundation。您可能应该将其更改为`(__bridge CFURLRef)pathURL`，这不会转移所有权。AudioServices API 将根据需要保留该对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T22:28:55.060

根据[clang ref](http://clang.llvm.org/docs/AutomaticReferenceCounting.html#objects.operands.casts)

> (__bridge_retained T) op 将必须具有可保留对象指针类型的操作数强制转换为必须是不可保留指针类型的目标类型。ARC 保留该值，但需对本地值进行通常的优化，并且接收者负责平衡该 +1。

因此，您需要进行发布。

换句话说，在桥接中发生的事情是所有权`pathURL`被传递给 CF，然后超出了 ARC 范围。

# jquery - 如何在 Codeigniter 中使用通过 jQuery Sortable 传递的数据

> ID：11253764
> 
> 赞同：0
> 
> 时间：2012-06-28T22:23:11.630
> 
> 标签：jquery, codeigniter, jquery-ui-sortable

我正在尝试使用[jQuery UI Sortable](http://jqueryui.com/demos/sortable/)重新排列 HTML 列表中的某些项目。我已经让它运行起来了，但我被困在如何使用数据上。

我正在使用 Codeigniter，并通过串行将订单传递给`update_order`我的 Category 控制器中的方法。

我知道我将如何将它输入数据库，但我不确定如何使用序列号以便我可以做到。我假设它在某种 POST 变量中，但我不知道它是什么。

JS：

```
<script type="text/javascript"> 
$(document).ready(function() {
    $("#order").sortable({
        update : function () {
            order = $('#order').sortable('serialize');
            $.ajax({
                url: "<?=base_url().'admin/category/update_order'?>",
                type: "POST",
                data: order,
                success: function(){
                    alert("success");
                }
            });
        }
    });
}
);
</script> 
```

的HTML：

```
<ul id="order">
    <li id="item_1">Item 1</li>
    <li id="item_2">Item 2</li>
    <li id="item_3">Item 3</li>
    <li id="item_4">Item 4</li>
    <li id="item_5">Item 5</li>
    <li id="item_6">Item 6</li>
</ul> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T01:23:19.323

最好的解决方案是保存当前元素的索引

```
update: function(event, ui) { 
     alert(ui.item.index()); 
} 
```

我知道你可以自己弄清楚其余的;)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T22:20:37.610

如果做序列化，做`$this->input->post('item')`

它将是 li 标签中 _1、_2 等前面的任何内容。

# r - geom_wordcloud : 这是白日梦吗

> ID：11253765
> 
> 赞同：18
> 
> 时间：2012-06-28T22:23:45.643
> 
> 标签：r, ggplot2, word-cloud

我处理了一些跨各种分组变量的文本数据。`wordcloud`我正在考虑创建一种方法来使用 Ian Fellows 的包制作多面文字云图。我喜欢处理`ggplot2`社会变量的方式。我正在决定如何解决这个问题（多面 wordcloud 图）。

是否可以将 Fellows 的工作用作 geom（我从未制作过 geom，但可能会知道这是否可行）或者 ggplot 不能很好地发挥作用，因为一个是网格，一个是基础（而且 wordcloud 也使用一些 C 编码）还是其他问题？这有多难（我知道这取决于我的能力，但想要一些球场答案）？请告知使用基本图形是否可能是解决此问题的更明智的方法。我预见这可以通过使用包来实现`panes`，`plotrix`以赋予它 ggplot 刻面所赋予的美感。

考虑到词云的大小和刻面快速限制可用空间的方式，也许这是一个愚蠢的概念。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-18T10:14:45.787

这可能是一个白日梦，重用`wordcloud`代码肯定不容易：

1.  正如 Ian Fellows 在评论中指出的那样，`wordcloud`代码计算基本图形中的字长和位置。
2.  代码的几何感知修改需要了解方面。

就使其工作而言，设计解决方案的框架可能是：

1.  重写`wordcloud`以计算网格图形中的字长，而不是基础图形
2.  将字长和位置的结果写入数据帧
3.  将计算包装在一个名为`stat_wordcloud`
4.  修改`geom_text`为新的`geom_wordcloud`

所以，这是一个白日梦，但一旦你做到了，我会热衷于使用它;-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-11-01T00:36:32.507

这是使用 ggplot2 样式的可能解决方案：[https ://github.com/lepennec/ggwordcloud](https://github.com/lepennec/ggwordcloud)

# asp.net-mvc - 回发后的 MVC 3 剃须刀验证

> ID：11253767
> 
> 赞同：1
> 
> 时间：2012-06-28T22:23:50.150
> 
> 标签：asp.net-mvc, asp.net-mvc-3, validation, razor

我有一个表格，用客户信息呈现。有一个下拉菜单，在更改时会使用 JavaScript 在 HTML 中插入新的表单元素。在此事件之后，我得到了用于验证的 JavaScript。

当我发布表单时，我确实将新元素数组放入我的模型中。如果现在我进行服务器验证并且出现错误，我会将所有内容返回到视图，这次使用 razor 生成新元素。到目前为止一切都很好。但是客户端验证不起作用！我确实验证了表单中的其他元素，但没有验证从集合中生成的元素，这些元素之前是手动添加的。

我确实看到元素数组没有 data-val 属性。

如果视图全部呈现，包括值数组的循环，为什么我没有在表单的这一部分获得客户端验证？

```
@{if (Model.pasajeros != null)
      {
          for (int i = 0; i < Model.pasajeros.Count(); i++)
          { 
            <p>Pasajero: @(i + 1)</p>
            <table>
                <tr>
                    <td><span class="lblspan">Nombre</span></td><td><span class="lblspan">Primer Apellido</span></td><td><span class="lblspan">Segundo Apellido</span></td>
                </tr>
                <tr>
                <td>@Html.TextBoxFor(x => x.pasajeros[i].name, new { @class = "txtboxsmall" })<br />@Html.ValidationMessageFor(x => x.pasajeros[i].name)</td>
                <td>@Html.TextBoxFor(x => x.pasajeros[i].lname, new { @class = "txtboxsmall" })<br />@Html.ValidationMessageFor(x => x.pasajeros[i].lname)</td>
                <td>@Html.TextBoxFor(x => x.pasajeros[i].lname2, new { @class = "txtboxsmall" })<br />@Html.ValidationMessageFor(x => x.pasajeros[i].lname2)</td>
                </tr>
                <tr>
                    <td><span class="lblspan">Fecha de Nacimiento (mm/dd/yyyy)</span></td><td style="vertical-align: bottom"><span class="lblspan">Sexo</span></td><td></td>
                </tr>
                <tr>
                    <td>@Html.TextBoxFor(x => x.pasajeros[i].dob, new { @class = "txtboxsmall" })<br />@Html.ValidationMessageFor(x => x.pasajeros[i].dob)</td>
                    <td>@Html.DropDownListFor(x => x.pasajeros[i].sex, Model.sexoItems, new { @class = "ddlsmall" })</td><td></td>
                </tr>

            </table>

        <p>@Html.RadioButtonListFor(x => x.pasajeros[i].radioselect, Model.radioItems) </p>

        <table>
            <tr>
            @if (Model.pasajeros[i].radioselect == "pass")
            {
            <td style="vertical-align: bottom"><span class="lblspan" id="@("numeroA" + i.ToString())">Número de Pasaporte Americano</span><span id="@("numeroR" + i.ToString())" class="statehide">Número de Residencia</span></td>
            }
            else
            {
            <td style="vertical-align: bottom"><span class="statehide" id="@("numeroA" + i.ToString())">Número de Pasaporte Americano</span><span id="@("numeroR" + i.ToString())" class="lblspan">Número de Residencia</span></td>
            }
            <td style="vertical-align: bottom"><span class="lblspan">Fecha de Vencimiento</span></td>
            <td><span class="lblspan">Número de Pasaporte Cubano</span></td><td  style="vertical-align: bottom"><span class="lblspan">Fecha de Vencimiento</span></td>
            </tr>
            <tr>
                @if (Model.pasajeros[i].radioselect == "pass")
                {

                <td>@this.TextBox(x => x.pasajeros[i].numAmericanPassport).Id("numAmericanPassport" + i).Class("txtboxsmall")

                @this.TextBox(x => x.pasajeros[i].numResidencia).Id("numResidencia" + i).Class("statehide").Disabled(true)
                <br /> @Html.ValidationMessageFor(x => x.pasajeros[i].numAmericanPassport) @Html.ValidationMessageFor(x => x.pasajeros[i].numResidencia)</td>
                <td>
                @this.TextBox(x => x.pasajeros[i].expAmericanPassport).Id("expAmericanPassport" + i).Class("txtboxsmall")

                @this.TextBox(x => x.pasajeros[i].expResidencia).Id("expResidencia" + i).Class("statehide").Disabled(true)
                <br /> @Html.ValidationMessageFor(x => x.pasajeros[i].expAmericanPassport) @Html.ValidationMessageFor(x => x.pasajeros[i].expResidencia)</td>
                }
                else
                {
                <td>@this.TextBox(x => x.pasajeros[i].numAmericanPassport).Id("numAmericanPassport" + i).Class("statehide").Disabled(true)

                @this.TextBox(x => x.pasajeros[i].numResidencia).Id("numResidencia" + i).Class("txtboxsmall")
                <br /> @Html.ValidationMessageFor(x => x.pasajeros[i].numAmericanPassport) @Html.ValidationMessageFor(x => x.pasajeros[i].numResidencia)</td>
                <td>
                @this.TextBox(x => x.pasajeros[i].expAmericanPassport).Id("expAmericanPassport" + i).Class("statehide").Disabled(true)

                @this.TextBox(x => x.pasajeros[i].expResidencia).Id("expResidencia" + i).Class("txtboxsmall")
                <br /> @Html.ValidationMessageFor(x => x.pasajeros[i].expAmericanPassport) @Html.ValidationMessageFor(x => x.pasajeros[i].expResidencia)</td>
                }
                <td>@Html.TextBoxFor(x => x.pasajeros[i].numCubanPassport, new { @class = "txtboxsmall" })</td>
                <td>@Html.TextBoxFor(x => x.pasajeros[i].expCubanPassport, new { @class = "txtboxsmall" })</td>
            </tr>
            <tr>
                <td><span class="lblspan">Habilitación</span></td><td><span class="lblspan">Documento</span></td><td colspan="2"></td>
            </tr>
            <tr>
                <td>@Html.TextBoxFor(x => x.pasajeros[i].visa, new { @class = "txtboxsmall" })</td>
                <td colspan="3"><input type="file" name="documents[@i]" /></td>
            </tr>
        </table>
        <hr />
      }
  } 
```

}

这是我观点的一部分

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T05:54:05.450

您需要在`parse`将新元素添加到 DOM 后调用该方法，以便使用不显眼的验证来注册它们：

```
$.validator.unobtrusive.parse('#id_of_the_form_containing_newly_added_inputs'); 
```

显然，这些元素必须具有相应的 HTML5`data-*`属性，这些属性指示您要对其应用的验证规则，就像在服务器上添加的输入一样。

# android - 如何在谷歌驱动器上加载文件

> ID：11253768
> 
> 赞同：3
> 
> 时间：2012-06-28T22:23:51.693
> 
> 标签：android, google-drive-api

我需要做的是在谷歌驱动器上加载文件。

我正在使用**GoogleAccountManager**通过 oauth2 进行授权并获得**AUTHTOKEN**并且现在不知道下一步该做什么。

要创建 Drive 对象，我需要**GoogleCredential**在哪里可以获得它们？

```
Drive service = new Drive(TRANSPORT, JSON_FACTORY, credential); 
```

也许我应该做类似的事情来[连接到在线服务](http://developer.android.com/training/id-auth/authenticate.html#ConnectToService)教程？

```
URL url = new URL("https://www.googleapis.com/tasks/v1/users/@me/lists?key=" + your_api_key);
URLConnection conn = (HttpURLConnection) url.openConnection();
conn.addRequestProperty("client_id", your client id);
conn.addRequestProperty("client_secret", your client secret);
conn.setRequestProperty("Authorization", "OAuth " + token); 
```

那么这个网址来自哪里*“https://www.googleapis.com/tasks/v1/users/@me/lists?key=”*

请给我建议或示例代码如何在谷歌驱动器上加载文件。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T06:16:27.620

这个答案现在已经过时了，因为 AccountManager 身份验证已被弃用，取而代之的是 Play Services。

**新答案**

```
private Drive service;
private GoogleAccountCredential credential;

credential = GoogleAccountCredential.usingOAuth2(this, DriveScopes.DRIVE);
credential.setSelectedAccountName(accountName);
service = new Drive.Builder(AndroidHttp.newCompatibleTransport(), new GsonFactory(), credential).build(); 
```

**原始答案**

我用过这个。 **AuthToken**是您从 AccountManager 收到的令牌。**ApiKey**是您从[Google API 控制台](https://code.google.com/apis/console)获得的密钥。

到目前为止似乎工作。文档很差。希望随着它的成熟，它会有所改善。它似乎是为那些已经知道他们在访问 G Api 方面所做的事情的人编写的。一个完整的样本会节省很多时间。

```
static Drive buildService(final String AuthToken, final String ApiKey) {
    HttpTransport httpTransport = new NetHttpTransport();
    JacksonFactory jsonFactory = new JacksonFactory();

    Drive.Builder b = new Drive.Builder(httpTransport, jsonFactory, null);
    b.setJsonHttpRequestInitializer(new JsonHttpRequestInitializer() {

        @Override
        public void initialize(JsonHttpRequest request) throws IOException {
            DriveRequest driveRequest = (DriveRequest) request;
            driveRequest.setPrettyPrint(true);
            driveRequest.setKey(ApiKey);
            driveRequest.setOauthToken(AuthToken);
        }
    });

    return b.build();
} 
```

# scala - 以下“非法继承”（Scala 2.9.2）背后的原因是什么？

> ID：11253770
> 
> 赞同：2
> 
> 时间：2012-06-28T22:24:09.853
> 
> 标签：scala, inheritance, traits, type-erasure, type-parameter

更新：我用一个更小更精确的例子重新表述了我的问题。

假设我们有以下定义：

```
class A
trait TraitForA extends A

class D[T]
trait TraitForD extends D[A] 
```

然后我们可以创建一个对象，如：

```
scala> new D[A] with TraitForD
res0: D[A] with TraitForD = $anon$1@145d424 
```

但是我们不能创建以下对象：

```
scala> new D[A with TraitForA] with TraitForD
<console>:12: error: illegal inheritance;
 anonymous class $anon inherits different type instances of class D:
D[A] and D[A with TraitForA]
             new D[A with TraitForA] with TraitForD
                 ^ 
```

当使用 self 类型而不是 trait 时，也会发生同样的事情`extends`：

```
scala> trait TraitForD2 { self: D[A] => }
defined trait TraitForD2

scala> new D[A with TraitForA] with TraitForD2
<console>:12: error: illegal inheritance;
 self-type D[A with TraitForA] with TraitForD2 does not conform to TraitForD2's
selftype TraitForD2 with D[A]
              new D[A with TraitForA] with TraitForD2
                                           ^ 
```

上面的创作（确切地说）有什么问题？

我的猜测是，这`D[A with TraitForA]`不被视为 type `D[A]`。`+T`在 class 中使用协变注释时`D`，两个示例都有效。

有人可以解释这些例子失败的原因以及它们为什么要使用`+T`吗？

额外的问题：有没有办法让示例在没有的情况下运行`+T`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T23:02:06.063

考虑

```
class C[T]{ def f(t: T): T = t } 
```

`C[A with Y]`说它将有一个`f`只会拿`A with Y`，只会返回`A with Y`。 `C[A]`无法满足此请求的功能。因此，两者发生冲突。

由于类型声明的成功不取决于所涉及的任何类的方法的详细信息，`Z1 with Z2`或者任何其他组合方式`C[A]`，`C[A with Y]`因此必须是错误的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T21:57:17.743

要查看方差问题，让我们向“TraitForX”添加一些方法。为简单起见，我将这些特征称为`A1`和`D1`，并且我还将制作`A`和`D`特征，再次为简单起见。我不知道你是如何想出有趣的结构的——我不知道 a`trait`甚至可以扩展 a `class`，这很奇怪！

```
trait A
trait A1 extends A { def schoko = 33 }

trait D[T] { def result: T }
trait D1 extends D[A] {
   def result: A = new A {}
} 
```

现在我们知道我们可以用一个实例做一些事情，而用一个实例`A1`是不可能的`A`。此外，`D1`还有一个具体的实现`result`。

仍然可以重现您的案例：

```
new D[A] with D1    // works.

new D[A with A1] {  // works.
   def result = new A with A1 {}
   def test = result.schoko
} 
```

您可以看到`test`可以调用方法`result`，并且由于`D`参数化了`A with A1`（`A1`与顺便说一句相同），因此可以随后调用`schoko`.

因此，以下内容永远不会起作用：

```
new D[A with A1] with D1 {
   def test = result.schoko
} 
```

编译器会说`value schoko is not a member of A`，这只是意味着它拒绝接受`D`其他参数化的内容。`result`被实现`D1`为返回`A`（不知道`schoko`）的实例，因此这里存在固有的冲突。

* * *

现在何时`D`更改为

```
trait D[+T] { def result: T } 
```

（所有其余的仍然如上），你只是'推迟'问题：

```
new D[A with A1] with D1 
```

编译器现在抱怨`error: overriding method result in trait D of type => A with A1`（您观察到这是有效的，因为您实际上并没有实现`result`）。

所以方差注释允许你做一些你以前不能做的事情。如果您没有实施`result`，则完全有可能：

```
trait D2 extends D[A]

new D[A with A1] with D2 {
   def result = new A with A1 {}
} 
```

# java - 在 OS X 上的 Java swing 中设置默认应用程序图标图像

> ID：11253772
> 
> 赞同：13
> 
> 时间：2012-06-28T22:24:20.027
> 
> 标签：java, macos, swing, imageicon

我正在尝试为 Jar 文件设置图标图像：

```
setIconImage(new ImageIcon(getClass().getResource("logo.png")).getImage()); 
```

在 Mac OS X 10.7.4 中运行时，出现以下错误：

```
Jun 28 15:21:40 (my dhcp) java[73383] <Error>: CGContextGetCTM: invalid context 0x0
Jun 28 15:21:40 (my dhcp) java[73383] <Error>: CGContextSetBaseCTM: invalid context 0x0
Jun 28 15:21:40 (my dhcp) java[73383] <Error>: CGContextGetCTM: invalid context 0x0
Jun 28 15:21:40 (my dhcp) java[73383] <Error>: CGContextSetBaseCTM: invalid context 0x0
Jun 28 15:21:40 (my dhcp) java[73383] <Error>: CGContextGetCTM: invalid context 0x0
Jun 28 15:21:40 (my dhcp) java[73383] <Error>: CGContextSetBaseCTM: invalid context 0x0 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-07-01T04:22:16.760

[`setIconImage`](http://docs.oracle.com/javase/1.5.0/docs/api/javax/swing/JFrame.html#setIconImage%28java.awt.Image%29)不设置 jar 图标。它将为最小化窗口的`JFrame`外观设置图标。jar 图标（控制 finder 图标和 Dock 应用程序图标）不能在 jar 文件本身中设置。您只需获得操作系统提供的默认图标。您将需要使用诸如适用于 OS X 的 JarBundler 或适用于 Windows 的 Launch4J[之类的东西来包装它。](https://developer.apple.com/library/mac/#documentation/Java/Conceptual/Jar_Bundler/About/About.html)

您可以在应用程序运行时设置应用程序停靠图标，请参阅[`com.apple.eawt.Application.setDockIconImage`](https://developer.apple.com/library/mac/documentation/Java/Reference/JavaSE6_AppleExtensionsRef/api/com/apple/eawt/Application.html#setDockIconImage%28java.awt.Image%29)。但它并不完美，因为当您双击您的 jar 时，它会使用通用 java 图标在 Dock 中启动，并且仅在 Java 代码开始运行时一两次反弹后切换到您的自定义图标。另外，我认为它不会为未运行的 jar 设置停靠图标（并不是说您无论如何都可以将 jar 文件拖到停靠中 - 似乎对我不起作用）。

以下代码演示了您可以设置的不同图像：

```
import com.apple.eawt.Application;
import javax.swing.*;

class SetIcon extends JFrame {

    SetIcon() {
        setIconImage(new ImageIcon("doc.png").getImage());
        Application.getApplication().setDockIconImage(
            new ImageIcon("app.png").getImage());
    }

    public static void main(String args[]) {
        SetIcon s = new SetIcon();
        s.setVisible(true);
    }
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-04-15T14:13:36.310

只是为了添加我在纯 Java 应用程序中添加 MacOSX Dock 图标的最终解决方案：

```
public boolean exists(String className)
{
    try {
        Class.forName( className, false, null );
        return true;
    }
    catch (ClassNotFoundException exception) {
        return false;
    }
}

public void setIcon( BufferedImage icn )
{
    if ( exists( "com.apple.eawt.Application" ) )
    {
        com.apple.eawt.Application.getApplication().setDockIconImage( icn );
    }
} 
```

这会默默地确保类可用并执行`setDockIconImage()`方法。对我来说效果很好，并且不会干扰其他平台。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-06-29T00:32:46.877

您可以将[`.icns`](https://apple.stackexchange.com/q/40652)文件放在应用程序包的`Contents/Resources`目录中并在`Info.plist`文件中引用它。例如，一个名为的文件`ApplicationName.icns`将被`<dict>`以下形式的条目引用：

```
<key>CFBundleIconFile</key>
<string>ApplicationName.icns</string> 
```

[这里](https://stackoverflow.com/a/8956715/230513)提到了一些相关的细节。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-08-03T02:05:26.123

> java -Xdock:icon=/path/myIcon.png myApp

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-01T17:47:27.177

正如我经历了你的错误，它与升级到 10.7.4 后开始出现的 MacOS jdk 相关

如果这对您有帮助，请通过[此操作：](https://discussions.apple.com/message/18394472#18394472)

# python - 如何从二进制文件中读取块并使用 Python 或 Perl 解包提取结构？

> ID：11253791
> 
> 赞同：2
> 
> 时间：2012-06-28T22:26:36.543
> 
> 标签：python, perl, struct, unpack

我有一个二进制文件，它有 4 KB 的标头信息，然后是 28 字节的数据，然后是我想要读取的 24 字节。我如何每 24 和 28 个字节循环一次并读取（或提取）这 28 和 24 个字节的前 8 个字节的数据。在 python 中我做了这样的事情。不确定如何处理可变长度

```
import sys
import struct
f = open(sys.argv[1],"rb")
f.seek(4096)
byte = f.read(28)
while byte != "":   
    ticks = struct.unpack("<ll",byte[:8]) #not sure how to read 8 bytes 
    byte = f.read(28)
f.close() 
```

这是标题之后的样子。

```
Length
(bytes) Field Name
8   TS_INCR
4   SEQID
2   OP
2   LUN
4   NBLKS
8   LBA

Length
(bytes) Field Name
8   TS_INCR
4   SEQID
2   OP
2   LUN
4   LATENCY_TICKS
2   HOST_ID
2   HOST_LUN 
```

如果你们可以帮助解决这个问题，请。Python 或 PERL 无关紧要。谢谢！！！！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-28T23:53:41.577

您正在阅读的数据的[字节顺序很重要。](http://en.wikipedia.org/wiki/Endianness)您似乎将 8 个八位字节解包为以小端顺序存储的两个长字节。您确定它不是单个 64 位数量（这会使`q`or`Q`格式更合适）吗？不幸的是，我在 32 位机器上，所以我的`perl`不支持`Q`.

但是，以下内容应为您指明正确的方向：

```
#!/usr/bin/env perl

use strict; use warnings;
use autodie;

use Fcntl qw(:seek);
use List::Util qw( sum );

my ($input_file) = @ARGV;
die "Need input file\n" unless defined $input_file;

my $HEADER_SIZE = 4_096;

my @typedef = (
    {
        fields => [
            qw(
                TS_INCR_LO
                TS_INCR_HI
                SEQID
                OP
                LUN
                NBLKS
                LBA_LO
                LBA_HI
            )
        ],
        tmpl => 'LLLSSLLL',
        start => 0,
        size => 28,
    },
    {
        fields => [
            qw(
                TS_INCR_LO
                TS_INCR_HI
                SEQID
                OP
                LUN
                LATENCY_TICKS
                HOST_ID
                HOST_LUN
            )
        ],
        tmpl => 'LLLSSLSS',
        start => 28,
        size => 24,
    },
);

open my $input, '<:raw', $input_file;

seek $input, $HEADER_SIZE, SEEK_SET;

my $BLOCK_SIZE = sum map $_->{size}, @typedef;
read $input, my($buffer), $BLOCK_SIZE;

my @structs;

for my $t ( @typedef ) {
    my %struct;
    @struct{ @{ $t->{fields}} } = unpack(
        $t->{tmpl},
        substr($buffer, $t->{start}, $t->{size})
    );
    push @structs, \%struct;
}

use Data::Dumper;
print Dumper \@structs; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-28T22:35:17.427

我想我会读取`52`每个循环的字节数（`24+28==52`）并简单地索引到您关心的字节数。它看起来像这样：

```
byte = f.read(52)
while byte != "":   
    ticks = struct.unpack("<ll",byte[0:8])
    tocks = struct.unpack("<ll",byte[28:36])
    byte = f.read(52) 
```

请注意，我不知道`while byte != ""`这种情况是否是惯用的循环。我只是建议阅读更大的块并只解析您感兴趣的字节。操作系统级别的`read()`操作非常慢，将它们减半将使您的应用程序的速度大约翻倍。如果你改为读取更大的数据块，你肯定会获得更大的加速——但这可能需要比这个微小的改变更多的重写。

# java - 使用不同语言的最佳实践是什么？

> ID：11253797
> 
> 赞同：1
> 
> 时间：2012-06-28T22:26:59.120
> 
> 标签：java, python, ruby, shell, node.js

我刚刚加入了一个新项目，该项目结合了许多用不同语言（Python、Ruby、Java 和 Perl）编写的组件。该项目是一种处理文档的管道，可以作为命令行 shell 脚本运行。管道/shell 脚本将内容从工具传递到另一个，然后最终将输出打印到文件中。在此过程中，一些工具会打印文件，然后将这些文件用作其他工具的输入。

我在这个项目中的工作是将它带到网络上。所以我的问题是在这样一个项目中应该遵循的正确/最佳实践方式/架构是什么，你有许多组件用不同的语言编写？
并且 Node.js 是可以组合组件的最佳工具/语言，正如*LinkedIn*所说：“[如果你看看 Node，它最擅长做的事情就是与其他服务交谈。](http://venturebeat.com/2011/08/16/linkedin-node) ”

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-28T23:24:39.597

我认为*正确的*答案可以填满书...

也就是说，我建议通过实现某种服务总线来避免与谁知道谁交谈的小模块的肮脏混乱。如果你能做到这一点，那么所有语言/子项目都必须只与总线兼容，而不是与其他每一个兼容。这样，复杂性将从 N 阶乘下降到 2xN。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T23:08:58.100

您最应该警惕的一件事是**安全性**。如果您将某些脚本公开为可通过 Web 执行，尤其是在需要用户输入的情况下，您需要彻底**验证它。**

这可能是最重要的事情。框架或架构的选择将仅次于安全性。

# linux - 在每一行的开头搜索

> ID：11253800
> 
> 赞同：0
> 
> 时间：2012-06-28T22:27:26.077
> 
> 标签：linux, sed, grep

我有一个类似的文本文件：

```
lineat2

corrupt

exitCode() 
```

等等...

每行都有一些文本。我想从这个文件中复制那些`corrupt`以另一个文件开头的行。任何命令（`sed`/ `grep`）来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-28T22:29:02.800

```
grep ^corrupt textfile > anotherfile 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T22:32:24.293

```
sed -n '/^corrupt/p' FILE > NEXTFILE 
```

# windows - 如何让 COM 为每个实例生成一个单独的进程外服务器？

> ID：11253801
> 
> 赞同：1
> 
> 时间：2012-06-28T22:27:33.190
> 
> 标签：windows, com

我有一个使用外部 COM 组件的服务器应用程序，它似乎正在泄漏内存。我没有这个组件的源代码，也没有任何调试或修改它的方法，经过足够的时间后，它会使服务器陷入瘫痪。

我想将 COM 功能移出进程，这并不困难（传递`CLSCTX_LOCAL_SERVER`而不是`CLSCTX_INPROC_SERVER`传递`CoCreateInstance`）但有一个问题：服务器正在从不同的线程创建 COM 对象的多个实例，时间这样可能最终不会有 0 个实例处于活动状态足够长的时间以泄漏足够的内存以使进程外主机崩溃。

显而易见的解决方案是让每个人都`CoCreateInstance`产生自己的进程外服务器。但是我在这方面看到的所有资源，[包括关于 SO 的一个问题](https://stackoverflow.com/questions/2897936/is-it-possible-to-have-an-out-of-process-com-server-where-a-separate-o-s-process)，似乎都要求您有权访问创建 COM 对象的 DLL 的源代码。这不是这里的情况。

`CoCreateInstance`那么，当您唯一能够更改的是正在调用的程序的代码时，有没有办法让每次调用都产生一个新的进程外代理`CoCreateInstance`？

（请不要使用基于 C++ 模板库的解决方案，因为有问题的服务器是用 Delphi 编写的。）

# c# - 读取相邻地址的进程内存的最有效方法？

> ID：11253804
> 
> 赞同：0
> 
> 时间：2012-06-28T22:27:54.967
> 
> 标签：c#, .net

我正在使用以下代码读取内存中的地址。我突然想到我这样做的效率可能非常低，因为我正在对每个地址进行单独调用，尽管所有地址都是彼此的邻居（1 个字节）。

```
 [DllImport("kernel32", EntryPoint = "ReadProcessMemory")]
    private static extern byte ReadProcessMemoryByte(int Handle, int Address, ref byte Value, int Size, ref int BytesRead); 
```

该函数看起来像：

```
pseudo: 
       For loop: 
       read memory address (base address offset)
       add result to array
       addressoffset++ 
```

所以说我有 3 个地址，我会打 3 个单独的电话。如果您知道我的意思，有没有办法只进行 1 次调用，然后执行内部逻辑将结果分成 3 个单独的数据段？就像不是逐字节读取，而是一次读取 4 个字节，然后在添加到数组之前将它们拆分？

我问这个的原因是我的程序需要很长时间才能完成迭代，有时必须读取多达 40,000 个地址，这需要 3 分钟。如果我能做到我所要求的，那么也许我可以在一分钟内将其缩短？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T22:34:13.597

从[http://www.pinvoke.net/default.aspx/kernel32.readprocessmemory](http://www.pinvoke.net/default.aspx/kernel32.readprocessmemory)，方法签名应该是这样的：

```
 [DllImport("kernel32.dll", SetLastError = true)]
  static extern bool ReadProcessMemory( 
    IntPtr hProcess, 
    IntPtr lpBaseAddress,
    [Out] byte[] lpBuffer, 
    int dwSize, 
    out int lpNumberOfBytesRead
   ); 
```

目前，由于您只有一个`byte`for `lpBuffer`/ `Value`，因此您一次只能读取一个字节。`byte[]`通过设置 a并传递`Size`大于 1的值，您可以读取更多内容（可能是您打算读取的所有字节，或者分解成 1024 字节的块） 。

# file - 如何从传递操作系统功能的文件系统中删除确切的文件？

> ID：11253805
> 
> 赞同：0
> 
> 时间：2012-06-28T22:28:19.880
> 
> 标签：file, memory, system, delete-file

我有：

*   安装了某些文件系统的操作系统，如 ext3 或 ntfs 或 smth else
*   此文件系统上的确切文件，如 Ozzy.mp3

我想：

*   删除此文件传递操作系统及其功能，但仅删除此文件而不损坏其他内存

我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T22:47:59.283

如果您想完全绕过操作系统擦除文件，您的程序将需要包含更新每个文件系统的目录结构所需的代码，对于您想要兼容的每个文件系统。

我想这可能是可行的，但远非易事，而且您最终会得到一个相当庞大的程序（如果您需要支持多个文件系统，则需要大量代码）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T22:54:06.533

如果您没有使用操作系统工具来执行此类操作，则需要：

*   作为具有使用 MMIO 或传统 IO 端口访问驱动设备的权限的进程运行（仍需要调用 OS 系统调用来实现此目的）
*   编写代码直接与设备交互
*   编写文件系统驱动程序
*   找到一种方法来注意到操作系统的文件系统驱动程序发生了一些变化

另一种方法是编写操作系统存根来仅操作 FS，但这真的，真的没有意义，因为有这样的工具可用。

* * *

总结：这样做是没有意义的；如果您需要绕过文件系统的安全设施，您必须在互联网上找到一个工具或放弃（因为，我假设您，您甚至不想编写存根裸机应用程序来执行此操作）。本网站并非旨在帮助人们绕过安全功能。

# xml - 识别球衣请求中的布尔标记

> ID：11253807
> 
> 赞同：0
> 
> 时间：2012-06-28T22:28:45.233
> 
> 标签：xml, jaxb, jersey

在 Jersey PUT 请求中，我传递了一个 xml 文件作为 cURL 的数据输入。

我应该如何测试 xml 输入文件中的特定布尔值，因为 JAXB 将所有非真值转换为假。如果标签不存在，那么它给出的值是假的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T09:01:52.637

尝试使用对象类型布尔而不是原始布尔来声明属性。

# java - 为邪恶的刽子手程序存储数据

> ID：11253810
> 
> 赞同：4
> 
> 时间：2012-06-28T22:28:55.437
> 
> 标签：java, data-structures, set

我必须编写一个刽子手程序，只有“房子”是邪恶的，并且改变了这个词，所以玩家（希望）输了。

我将在游戏开始时创建一组所有单词，当玩家选择一个字母时，我将创建一个匹配模式的集合，并继续创建最佳子集。

例如

假设用户选择了 3 个字母的单词，为了这个例子，我们会说英语中只有以下 3 个字母的单词；Dog Fog 和 Fox Cat Not Bus

如果用户猜测“o”，程序将编译一个单词列表，其中没有“o”，我将把这个列表排序为一组，一组是“和”，另一组是“巴士”，另一组是“猫”

但是我想知道存储这些集合的最佳方法是什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T22:31:57.543

作为建议，请考虑您需要有效支持哪些操作。您将需要能够获取一个单词，将其映射到其单词族，然后从那里将单词分配到与该族匹配的单词集合中。为此，请考虑使用类似 a 的东西`Map`，它将单词 family（以您希望的方式表示）与匹配该族的单词集合相关联。您可以用多种方式表示集合 - 作为 a `Set`，作为 a`List`等。这样，您可以轻松地获取字符串，将其转换为单词族，然后将单词族映射到该族中所有单词的集合。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T19:41:46.053

让我重新表述一下你在做什么：

1.  您有一组指定长度的单词。
2.  每次用户指定一个字符时，您都希望从当前集合中删除所有包含该字符的单词而不清空集合。

可选地，更邪恶：

1.  如果您的集合现在是空的，您希望从原始单词集中选择在同一索引处具有指定字符的单词的最大子集。

这是你想做的吗？

如果是这样，我会考虑考虑你将要做什么。

给定一个包含大量单词的文本文件。我将首先形成按字符长度划分的单词集列表。

复制该集合后，您可以开始向用户询问特定字符。由于提供了字符，您必须删除集合中包含该字符的单词。

因此，如您所见，解决这个问题的简单方法是遍历集合中的所有单词，并遍历字符以查看它是否包含指定的字符。

更好的方法可能是按单词包含的字符对单词进行分类。祝你好运！

# class - 为什么在混合特征时会创建一个匿名类？

> ID：11253813
> 
> 赞同：6
> 
> 时间：2012-06-28T22:29:04.250
> 
> 标签：class, scala, anonymous, mixins

```
scala> class A
defined class A

scala> trait B
defined trait B 
```

创建一个类对象`A`给了我们：

```
scala> new A
res4: A = A@11ea3fc 
```

但是创建一个混合`A`了 trait的类对象`B`给了我们：

```
scala> new A with B
res3: A with B = $anon$1@172aa3f 
```

这里我们有一个匿名类（用 暗示`anon`）。为什么 ？

这是因为该类型`A with B`被视为一种新类型（并且之前没有使用标识符定义）吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-28T23:26:32.543

这不仅是因为`A with B`必须被视为一种新类型。对于 Scala 类型系统，是否存在与`A with B`. 生成了一个匿名类，因为它必须包含已混入的特征中所有方法的*桥接方法。*

创建匿名类的原因是该对象必须具有 from 的所有方法和 from 的`A`所有方法的实现`B`。在 JVM 字节码级别，这将保证继承多个类，并且 JVM 不支持多继承模型。

为了模拟多重继承（或 mixin 组合，无论你怎么称呼它），Scala 在你创建一个 trait 时会做以下事情：

1.  如果 trait`T`没有方法实现，它会创建一个接口来定义 trait 中的所有方法。
2.  如果 trait`T`有方法实现，它会另外创建一个类，该类`T$class`对`T`. 此静态方法与 中的相应方法具有相同的主体`T`，但其签名已更改为包含`this`参数。如果`T`有：

    ```
    def foo(x: Int) = x 
    ```

那么`T$class`将有：

```
<static> def foo($this: T, x: Int) = x 
```

通过 mixin 组合某些类`A`和某些 trait获得的类`T`将生成一个特殊的桥接方法，该方法将调用转发到包含主体的静态方法。这样，方法的主体不会在混入的每个类中重复`T`。这就是必须创建匿名类的原因 - 它必须为`T`.

这是一个例子。当您通过混合组合创建新类时，例如调用`new A with T`：

```
class A {
  def bar = println("!")
}

trait T {
  def foo(x: Int) = x
}

new A with T 
```

编译器会将其大致重写为如下内容：

```
class A {
  def bar = println("!")
}

<interface> T {
  def foo(x: Int): Int
}

class T$class {
  <static> def foo($this: T, x: Int) = x
}

class $anon extends A <implements> T {
  // notice that `bar` is inherited, but `foo` is not
  <bridge> def foo(x: Int) = T$class.foo(this, x)
}
new $anon 
```

请注意，编译器实际上可以将调用点重写为`foo`直接从调用点调用静态方法，而不是通过桥接方法。不这样做的原因是因为它不再支持子类型多态性。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-28T22:38:58.167

是的。虽然您的*类型*仍然是`A with B`，但需要有一个实现这两个接口的底层 Java 类。这并没有什么问题，只是如果你以这种方式创建对象数百次，你可能会拥有数百个类文件。在这种情况下，您可能需要创建一个专用`class AB extends A with B`然后实例化`new AB`.

作为旁注，你会发现你也不能直接实例化特征，例如`new B`不会工作。您还需要在这里创建一个显式类，例如`new B {}`，再次生成一个合成（“匿名”）类。

# .net - 极端通知设备 - 如何

> ID：11253814
> 
> 赞同：1
> 
> 时间：2012-06-28T22:29:07.340
> 
> 标签：.net, continuous-integration

谁能告诉我如何制作一个红色（损坏）/绿色（正常）/黄色（建筑物）带有连接到 CruiseControl.Net 的灯的极端通知设备的说明？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T15:02:05.250

我希望在我的项目中提出类似的建议（我们使用 Jenkins）。您可能会发现我发现的一些有用信息：

*   作为起点，您可以查看 CruiseControl 配置[帮助](http://cruisecontrol.sourceforge.net/main/configxml.html#x10)。
*   我正在阅读有关此的博客文章：[http ://www.therealjoshanderson.com/2010/04/ledbloa-ftw-my-teams-new-build-status.html](http://www.therealjoshanderson.com/2010/04/ledbloa-ftw-my-teams-new-build-status.html)
*   我这里还有一本书：O'Reilly 的[书](http://shop.oreilly.com/product/0636920010326.do)，名为**Jenkins，权威指南。**来自约翰弗格森斯马特，其中有一章关于它。也许您可以使用它的信息使其适应 CruiseControl。

# c# - 提供对庞大的非数据库数据集的 oData 访问

> ID：11253818
> 
> 赞同：4
> 
> 时间：2012-06-28T22:29:14.390
> 
> 标签：c#, .net, wcf, wcf-data-services, odata

我在远程计算机上的数据集中有一个非常大的数据集（1,000,000 多个客户）。此数据存储在一个平面文件中，并通过客户编号查找，该客户编号是文件中的偏移量。我想提供对这个集合的 oData 访问，但我只想提供读取单个实体的能力。

权限方面，很容易让 WCF 使用以下内容将其限制为单次读取：

```
config.SetEntitySetAccessRule("Customer", EntitySetRights.ReadSingle); 
```

我遇到的问题是我被迫返回一个 IQueryable 接口，这似乎需要我收集整个数据集。是否有我遗漏的东西，或者有没有办法只收集评估 IQueryable 时所需的记录，我知道（由于 oData 权限）将需要单个记录提取？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T03:08:57.010

IQueryable 和 IEnumerable 非常不同 - 无需过多介绍，IQueryable 允许您构建由查询提供程序（在服务器上）执行并仅返回结果（在您的情况下为单个实体）的查询表达式。您仍然会受到在服务器端检查整个数据集的影响，但我不确定在您的场景中如何避免这种情况。

有关 IEnumerable 和 IQueryable 之间区别的更多详细信息，请参阅此处的答案：[https](https://stackoverflow.com/a/252789/981304) ://stackoverflow.com/a/252789/981304 。具体来说，“...IQueryable 允许内存不足的事物，例如远程数据源，例如数据库或 Web 服务。”

# python - Python：Urllib2 和 OpenCV

> ID：11253820
> 
> 赞同：5
> 
> 时间：2012-06-28T22:29:26.717
> 
> 标签：python, opencv, urllib2, loadimage

我有一个程序将图像保存在本地目录中，然后从该目录中读取图像。

但我不想保存图像。我想直接从 url 读取它。

这是我的代码：

```
import cv2.cv as cv
import urllib2

url = "http://cache2.allpostersimages.com/p/LRG/18/1847/M5G8D00Z/posters/curious-cat.jpg"
filename = "my_test_image" + url[-4:]
print filename
opener = urllib2.build_opener()

page = opener.open(url) 
img= page.read()

abc = open(filename, "wb")
abc.write(img)
abc.close()

img = cv.LoadImage(filename)

cv.ShowImage("Optical Flow", img)
cv.WaitKey(30) 
```

如果我将其更改为：

```
img = cv.LoadImage(img) 
```

这会给我这个错误：

> 参数 1 必须是没有空字节的字符串，而不是 str

我能做些什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T11:06:48.820

如果你愿意，你可以使用 PIL。

```
import cv2.cv as cv
import urllib2
from cStringIO import StringIO
import PIL.Image as pil
url="some_url"

img_file = urllib2.urlopen(url)
im = StringIO(img_file.read())
source = pil.open(im).convert("RGB")
bitmap = cv.CreateImageHeader(source.size, cv.IPL_DEPTH_8U, 3)
cv.SetData(bitmap, source.tostring())
cv.CvtColor(bitmap, bitmap, cv.CV_RGB2BGR) 
```

我想通过这种方法你不需要保存图像文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-05-26T07:11:12.110

```
import numpy as np
import urllib
import cv2

def url_to_image(url):
    response = urllib.urlopen(url)
    image = np.asarray(bytearray(response.read()), dtype="uint8")
    cv2_img = cv2.imdecode(image, cv2.IMREAD_COLOR)
    return cv2_img 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-29T05:58:01.923

[如此处](http://docs.opencv.org/modules/highgui/doc/reading_and_writing_images_and_video.html?highlight=loadimage#cv.LoadImage)所述LoadImage 期望文件名作为第一个参数，而不是数据

# performance - Oracle - 性能问题。使用 groupby 查询

> ID：11253825
> 
> 赞同：0
> 
> 时间：2012-06-28T22:29:46.930
> 
> 标签：performance, oracle, group-by

这是我正在使用的查询：

```
SELECT p.name, p.id
FROM v_emp e 
INNER JOIN  v_prof p ON e.code = p.code
WHERE e.emp_id IN  (SELECT  a.id 
                   FROM t_approval a 
                   WHERE  a.code1 <> 'R'
                   AND a.code2 = 'P'
                   AND a.date1 IS NULL 
                   AND a.date2 IS NULL
                   AND a.code3 = 'ADMIN'
                   GROUP BY a.id
                                   )
GROUP BY p.name, p.id
ORDER BY p.name 
```

该查询需要超过 4 分钟才能执行。表 t_approval 有超过 1500 万条记录，我需要该表中与搜索条件匹配的不同 ID。

该表已经在 id,code1,code2,code3 上有索引。

请让我知道如何使这个运行更快。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-28T22:40:19.543

*   查询计划是什么？
*   为什么`GROUP BY`存在这两个子句？它们似乎都不是必需的，但是由于我们不知道您的数据或您的数据模型，因此很难知道它们是否试图掩盖缺少某些连接条件的问题。
*   子查询返回的 1500 万行中有多少行`t_approval`？每个谓词的选择性如何？
*   另外两个表有多少行？您的整个查询返回多少行？
*   有哪些索引可用？我假设您正在谈论的索引在`t_approval`桌面上。但是，尚不清楚您是在谈论单个复合索引还是 4 个单独的单列索引或其他内容。目前尚不清楚其他两个表上存在哪些索引。

如果不查看查询计划，不知道您的数据模型是什么样的，也不知道您的谓词有多么选择性，就很难猜测问题出在哪里，更不用说推测解决方案了。潜在地，由于您仅从一个表中选择列，并且由于我猜测子查询返回了许多行，因此这样做可能更有效

```
SELECT p.name, p.id
  FROM v_prof p  
 WHERE EXISTS( SELECT 1
                 FROM v_emp e
                      JOIN t_approval a ON (e.emp_id = a.id)
                WHERE e.code = p.code
                  AND a.code1 <> 'R'
                  AND a.code2 = 'P'
                  AND a.date1 IS NULL 
                  AND a.date2 IS NULL
                  AND a.code3 = 'ADMIN' )
 ORDER BY p.name 
```

如果这不起作用，您需要通过发布更多信息来帮助我们。

# c++ - 使用 EnumFontFamiliesEx 函数枚举时字体过多

> ID：11253827
> 
> 赞同：27
> 
> 时间：2012-06-28T22:30:13.053
> 
> 标签：c++, c, windows, winapi, fonts

我正在尝试创建一个字体列表供用户选择。我正在使用该[`EnumFontFamiliesEx`](http://msdn.microsoft.com/en-us/library/dd162620%28VS.85%29.aspx)函数来执行此操作，但不幸的是，返回的字体列表太长了。有许多额外的字体看起来很无聊、重复、用于不同的语言，或者以其他方式不希望向用户显示。我的屏幕截图最能说明我试图过滤掉的垃圾。

我的调用代码`EnumFontFamiliesEx`如下所示：

```
LOGFONT lf;
memset(&lf, 0, sizeof(lf));
lf.lfCharSet = DEFAULT_CHARSET;
// screenDC is result of CreateCompatibleDC(NULL)
EnumFontFamiliesEx(screenDC, &lf, GetFontsCallback, NULL, 0); 
```

在按字母顺序排序并删除具有重复面孔名称的字体后，结果列表如下所示：

![在此处输入图像描述](../Images/1a9c5296edce55fe90b9c088b34cc4e7.png)

如您所见，`ChooseFont`字体通用对话框显示了一个非常合理的字体列表，该列表对用户友好且有意义。另一方面，我的代码显示了一长串额外字体：以“@”开头的字体（为什么？它们甚至是为了什么？），Arial 字体的 3 种额外变体，以及其他几种用途不明的字体，如 Aheroni，安达卢斯、新悦椿、悦椿UPC等。这太疯狂了。

如何过滤返回的字体列表`EnumFontFamiliesEx`，使其与对话框中显示的列表**完全**匹配`ChooseFont`？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-06-29T17:17:41.340

感谢 Jesse Good，我现在了解到 Windows 7 团队做出的一些疯狂的不幸设计决策。我不会接受我自己的答案，因为如果其他人想出一种在 Windows 7 中使用此隐藏字体功能的方法，即使注册表项尚不存在（例如，可能通过使用未记录的 API 或其他一些诡计）并且他们的回答有效，我会接受。

此过滤是通过在 Windows 7 控制面板中实际“隐藏”字体来完成的。默认情况下，其他语言环境的字体是隐藏的，但它们可以由用户显示。至少，这是这个想法。这是讨论此功能的 MSDN 页面： [国际字体管理](http://msdn.microsoft.com/en-us/library/windows/desktop/dd317704%28v=vs.85%29.aspx)。

以下是此页面和 MSDN 中其他附近页面的一些关键摘录（另请参阅Windows中的[http://msdn.microsoft.com/en-us/library/windows/desktop/dd371704(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/dd371704(v=vs.85).aspx) 7 兼容性食谱）：

> 从 Windows 7 开始，字体管理基础结构支持隐藏不适合用户字体选择列表的字体。...此功能意味着用户不再需要面对一长串不合适的字体。
> 
> **在 Windows 7 中，没有用于直接查询隐藏哪些字体或设置隐藏字体的 API。**[强调我的] 如果您今天使用 Windows ChooseFont API（字体常用对话框）启用字体选择，您将免费获得新行为。Windows 7 中引入的新 Windows Scenic Ribbon（字体控件）也支持此行为，并为“Ribbonize”您的应用程序提供了另一个理由。
> 
> 将字体选择到设备上下文中时，由于字体被隐藏，因此不会影响绘图。**EnumFontFamiliesEx 函数继续枚举设置为隐藏的字体。**[强调我的；显然没有办法用 EnumFontFamiliesEx 区分隐藏和可见字体]
> 
> **请注意，字符集是对应于 Unicode 前字符集的遗留概念。**[强调我的]
> 
> ChooseFont 将只列出显示的字体，并在列表框中显示字体时过滤掉隐藏的字体。在 CHOOSEFONT 结构的 flags 成员中添加了附加标志（CF_INACTIVEFONTS），以允许您在字体列表中显示所有已安装的字体，与 Windows 7 之前的 ChooseFont 行为相同。

换句话说，除非您使用 ChooseFont 通用对话框或官方的 Windows 功能区控件（仅在 Windows Vista/7 上可用），否则您根本没有支持过滤隐藏字体的方法。互联网上的许多用户都在抱怨在 Windows 7 控制面板中隐藏字体似乎没有效果，这有什么奇怪或奇怪的吗？！？（我之前错误地发布了 MS Word 2010 过滤掉隐藏字体。它似乎没有，因为它们使用自己的自定义功能区控件，而不是 Windows 内置的功能区。有趣的是，Windows 7 字体控制面板，按设计，与微软的一款旗舰产品不兼容，如果不在 Office 中倾倒更强大的功能区，就无法使其兼容。）

根据 Jesse Good 发布的链接，我了解到隐藏字体存储在未记录的注册表项中。通过此链接，以及使用 Process Monitor 进行的一些实验和分析（查看堆栈跟踪和注册表访问），我了解到以下内容：

*   功能区控件调用 FMS.DLL（字体管理服务）中名为 FmsGetFilteredFontList 的未记录函数。它的目的似乎很明显。真可惜，他们懒得公开记录和维护它。
*   这些设置存储在一个未记录的注册表项中，FMS.DLL 可以访问该注册表项。
*   如果注册表项被删除，它会使用 FmsGetFilteredFontList 的默认设置重新创建，这将隐藏与当前输入语言无关的字体​​。
*   在全新安装的 Windows 上创建的全新用户配置文件不包含与应隐藏哪些字体相关的任何注册表项。

因此，Jesse Good 发布的链接可能适用于许多/大多数情况，但不是 100% 的时间。如果它们不存在，您需要一种方法来可靠地重新创建这些注册表项（或至少假设默认值）。默认行为仍然是隐藏一些字体，即使注册表项已经消失（例如在新的用户配置文件上）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-07-28T20:59:00.043

鉴于 FmsGetFilteredFontList 未记录在案，您获得与用户在 Windows 7+ ChooseFont 对话框中看到的*完全相同的列表的选项可能会受到限制。*但是，仅使用记录在案的 API 可能会很好地接近默认字体列表。

为了减少自动选择适当字体的算法的可能性，我做了类似的事情。

我的方法是在[FONTSIGNATURE](http://msdn.microsoft.com/en-us/library/windows/desktop/dd318064%28v=vs.85%29.aspx)中使用 Unicode 子范围位掩码，可以在枚举字体时对其进行检查。如果您知道需要哪个 Unicode 子范围，字体签名会告诉您当前字体是否覆盖它。如果是，请将其包含在列表中。如果没有，则跳过它。我怀疑这可能类似于 FmsGetFilteredFontList 构建其默认列表的方式。

诀窍是弄清楚用户需要什么子范围。就我而言，这相对容易，因为我确切地知道要渲染什么文本。我根据[文档](http://msdn.microsoft.com/en-us/library/windows/desktop/dd374090%28v=vs.85%29.aspx)构建了子范围到 FONTSIGNATURE 样式的位掩码值的映射。

我扫描了要渲染的文本中的代码点，在映射中查找它们，并建立了一个目标位掩码。我将这个目标位掩码与每个枚举字体的字体签名中的位掩码进行位与运算。每当结果与目标位掩码匹配时，我就知道字体可以（很可能）支持文本。对于我的应用程序，我要求*所有*目标位都出现在字体中。对于您的应用程序，我认为您需要*任何*目标位。

字体签名位掩码是字体提供的字符的一个很好的初步选择。您可以完全确定地使用[GetFontUnicodeRanges](http://msdn.microsoft.com/en-us/library/windows/desktop/dd144887%28v=vs.85%29.aspx)，但我发现这不是必需的，而且它也比仅检查字体签名要慢。

在您的情况下，也许您会以用户的语言提供一些具有代表性的文本字符串。例如，来自他们正在编辑的文档或来自已翻译的 UI 资源。您可以扫描该示例文本以获取目标字体签名。

例如，如果您扫描一些英文文本，您会发现所有必要的字符都在拉丁子范围内。如果您查看 Windows 7 中针对英语用户的字体控制面板小程序（并切换到详细信息视图），您会发现“**显示/隐藏”列与“****设计用于”**列中是否列出拉丁语密切相关，这似乎是字体签名的 Unicode 子范围位掩码的文本表示。

**更新**：我刚刚尝试使用 DirectWrite 枚举字体，认为这个较新的 API 可能会处理字体隐藏功能。唉，它返回所有内容并且没有过滤隐藏字体的选项（我可以找到）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-07-25T05:06:20.413

老实说，Microsoft 没有记录此功能是可耻的，但我们对他们的期望越来越多。

过滤您自己的字体列表的另一种方法是通过枚举字体文件夹来利用 shell。如果您使用资源管理器查看，您会看到隐藏的字体带有一个幻影图标 - 我们可以使用该属性来判断字体是否隐藏。

例如（不完整）：

```
LPITEMIDLIST pidlFonts;
if (SUCCEEDED(SHGetKnownFolderIDList(FOLDERID_Fonts, 0, nullptr, &pidlFonts)))
{
    CComPtr<IShellFolder> psf;
    if (SUCCEEDED(SHBindToObject(nullptr, pidlFonts, nullptr, IID_IShellFolder, reinterpret_cast<void**>(&psf))))
    {
        CComPtr<IEnumIDList> pEnum;
        if (SUCCEEDED(psf->EnumObjects(hWnd, SHCONTF_FOLDERS | SHCONTF_NONFOLDERS | SHCONTF_INCLUDEHIDDEN | SHCONTF_INIT_ON_FIRST_NEXT, &pEnum)))
        {
            LPITEMIDLIST pidl;
            ULONG celt = 0;
            while (pEnum->Next(1, &pidl, &celt) == S_OK)
            {
                SFGAOF hidden = SFGAO_GHOSTED;
                if (SUCCEEDED(psf->GetAttributesOf(1, const_cast<LPCITEMIDLIST*>(&pidl), &hidden)) && (hidden & SFGAO_GHOSTED) == SFGAO_GHOSTED)
                {
                    // this font should be hidden
                    // get its name via IShellFolder::GetDisplayNameOf
                }
                CoTaskMemFree(pidl);
            }
        }
    }
    CoTaskMemFree(pidlFonts);
} 
```

您可以使用此方法构建一组隐藏字体，然后使用它来过滤`EnumFontFamiliesEx`.

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2014-07-27T00:51:41.687

我认为这里的整个讨论具有误导性。

当我向我的用户提供字体选择器时，我为什么要关心 Microsoft 隐藏了哪些字体？为什么我要隐藏微软认为应该默认隐藏的所有字体？

如果我的用户只想使用 Microsoft 隐藏的字体之一怎么办？我会让我的用户负担去控制面板取消隐藏这个字体吗？

如果有一天中国用户想在英文 Windows 上写中文文本并且中文字体被隐藏了怎么办？

我认为有一种更好的方法来限制`EnumFontFamiliesEx()`.

我编写了自己的字体选择器，它有一个字体过滤器，允许用户选择他想要使用的字体组。这样我就不会隐藏任何东西，并将所有的权力交给用户而不是微软！

用户可能想查看所有字体！有时人们只需要 Arial Black 或 Arial Narrow，尽管 Microsoft 认为它应该被隐藏。

```
int CALLBACK EnumFontFamExProc(const LOGFONT* pk_Font, 
                               const TEXTMETRIC* pk_Metric, 
                               DWORD e_FontType, 
                               LPARAM lParam)
{
    if (e_FontType & TRUETYPE_FONTTYPE)
    {   
        // u32_Flags128 = DWORD[4] = 4 * 32 bit = 128 bit
        DWORD* u32_Flags128 = ((NEWTEXTMETRICEX*)pk_Metric)->ntmFontSig.fsUsb;

        if (u32_Flags128[13 / 32] & (1 << (13 % 32)))
        {
            // the font contains arabic characters (bit 13)
        }
        if (u32_Flags128[38 / 32] & (1 << (38 % 32)))
        {
            // the font contains mathematical symbols (bit 38)
        }
        if (u32_Flags128[70 / 32] & (1 << (70 % 32)))
        {
            // the font contains tibetan characters (bit 70)
        }
    } 
```

在回调中，您会得到一个 128 位标志，它准确定义了字体支持的 Unicode 区域。

请参阅[http://msdn.microsoft.com/en-us/library/dd374090%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/dd374090%28v=vs.85%29.aspx)

您可以使用这些 128 位来过滤和减少您在字体列表中显示的字体数量：

![在此处输入图像描述](../Images/b7b8fd2cd9f4ce5d6803674705e2e318.png)

# coronasdk - 半径内的 Corona SDK 碰撞

> ID：11253835
> 
> 赞同：0
> 
> 时间：2012-06-28T22:31:11.517
> 
> 标签：coronasdk

我正在制作的游戏有问题。我正在使用物理学，有 2 个物体，敌人和一个炮塔。我在炮塔上设置了一个身体半径，这是一个传感器。碰撞类型有效，但仅在敌人击中半径和离开半径时才有效。当敌人在传感器内时，如何继续跟踪敌人以便继续射击？如果可能的话，一些例子会很好

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T08:08:35.597

这就是物理引擎的工作原理，它只捕获某些事件：“collision:”、“preCollision”和“postCollision”。

对于“碰撞”有两个阶段：“开始”和“结束”，这就是为什么你的炮塔只有在敌人击中并离开半径时才会开火。

我的建议是：你可以设置一个定时器，当敌人击中半径时，定时器会调用开火函数。当敌人离开半径时，停止并清理计时器。

# html - 使用 jQuery 隐藏多个容器

> ID：11253839
> 
> 赞同：1
> 
> 时间：2012-06-28T22:31:38.163
> 
> 标签：html, jquery, show-hide, jquery-events

在任何给定时间，我在页面上都有几十个带有图像和共享按钮的对象，例如：

```
<li class="entry" id="sjDDulC8wt"> 
    <img src="sjDDulC8wt.jpg" />
    <div class="entry_actions">
    <ul class="entry_actions">
        <li class='share_it'><a onclick='javascript: showShare("sjDDulC8wt");' 
        onblur='javascript: hideShare("sjDDulC8wt")' target='_self' 
        title='Share It' class='share_it'>o</a>
        </li>
    </ul>
    <div class="share_options_container"style="display:none;">
        <ul>
            <li><a href="#" class="facebook">F</a></li>
            <li><a href="#" class="twitter">T</a></li>
            <li><a href="#" class="pinterest">X</a></li>
        </ul>
    </div>
</div> 
```

`showShare()`当我单击`entry_actions`ul内的锚标记时，该函数只是在页面的特定元素内打开 share_options_container div。当我单击它时，该`hideShare()`功能应该隐藏它。

```
function hideShare(id){
$('#' +id+'.share_options_container').hide();
} 
```

当我单击锚标记时，相应的共享容器 div 完美显示。当我单击关闭时，没有任何反应。我也试过这段代码，我在另一个类似的问题上找到了它：

```
$("body").click(function(){ $(".share_options_container").fadeOut(200); }); 
```

但是，当我单击其中一个锚点时，此功能会立即开始将其淡出，因此如果我将淡入淡出更改为隐藏，则容器甚至根本不会弹出。

是否有一个事件我可以将我的原始`hideShare()`函数与之关联，以便当我单击锚标记时它会实际触发？如果不是，我是否可以修改第二个函数，使其不会在弹出时立即隐藏我要显示的特定容器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T22:33:31.800

HTML：

```
<li class='share_it'><a href="javascript:;" title='Share It' class='share_it'>o</a> 
```

JS：

```
$(".share_it a").click(function(){
    $(this).closest(".entry").find(".share_options_container").show();                
    })
$(".share_options_container").mouseleave(function(){
    $(this).hide();              
    }) 
```

**​​演示** ：http: [//jsfiddle.net/JP2Vx/2/](http://jsfiddle.net/JP2Vx/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T23:11:03.857

当您单击锚点时，您应该阻止单击事件冒泡到文档中。

所以试试

```
$(".share_it a").click(function(e){
    e.stopPropagation(); // this line stops the bubbling..
    showShare( $(this).closest(".entry").attr("id") );                
});
$('body').click(function(){
    $(".share_options_container").hide();
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T23:10:34.323

好的，假设你有这样的东西（我已经随机修改了 each `id`，但无论如何你都可以忽略它，请注意标记中没有内联处理程序，如`onclick=""`or `onblur=""`）：

**HTML**

```
<ul>
    <li class="entry" id="sjDDulC8wt">
        <img src="http://goo.gl/UohAz" />
        <div class="entry_actions">
            <ul class="entry_actions">
                <li class='share_it'>
                    <a href="#" title='Share It' class='share_it'>Open Options Container</a>
                </li>
            </ul>
            <div class="share_options_container non-displayed">
                <ul>
                    <li><a href="#" class="facebook">F</a></li>
                    <li><a href="#" class="twitter">T</a></li>
                    <li><a href="#" class="pinterest">X</a></li>
                </ul>
            </div>
        </div>
    </li>
    <li class="entry" id="sjDDulC8wtf">
        <img src="http://goo.gl/UohAz" />
        <div class="entry_actions">
            <ul class="entry_actions">
                <li class='share_it'>
                    <a href="#" title='Share It' class='share_it'>Open Options Container</a>
                </li>
            </ul>
            <div class="share_options_container non-displayed">
                <ul>
                    <li><a href="#" class="facebook">F</a></li>
                    <li><a href="#" class="twitter">T</a></li>
                    <li><a href="#" class="pinterest">X</a></li>
                </ul>
            </div>
        </div>
    </li>
    ... More rows ...
</ul> 
```

然后你可以这样做：

**CSS**

```
.non-displayed {
    display:none;
} 
```

**jQuery**

```
$(document).ready(function(){
    var $entries = $('.entry');

    function toggleShare(){
        $(this)
            .parents('.entry')
            .find('.share_options_container')
            .toggleClass('non-displayed');
    }

    $entries.find('a.share_it').bind('click', toggleShare);
    $entries.find('div.share_options_container').bind('mouseleave', toggleShare);
}); 
```

[http://jsfiddle.net/userdude/vg3n5/1](http://jsfiddle.net/userdude/vg3n5/1)

这就是为什么我说你没有`id`通过处理程序调用或诸如此类的方式发送。

请注意，`mouseleave`我从 mgraph 的答案中窃取的想法。

# cocoa - Delphi 有哪些好的 Cocoa API 端口

> ID：11253840
> 
> 赞同：2
> 
> 时间：2012-06-28T22:31:45.200
> 
> 标签：cocoa, delphi, api, delphi-xe2, porting

Delphi 有没有好的 Cocoa API 端口。

我知道 JCL 为 Delphi 提供了一个很好的 Windows API 端口，但似乎我错过了 Cocoa API 的最佳端口。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T08:53:02.240

如果您有 XE2，请查看 Macapi.* 单位。它们是 AppKit（Cocoa 的主要部分）的一个很好的移植。IOW，您不需要任何外部端口。

也看看我的[这篇文章](https://stackoverflow.com/questions/7442131/delphi-xe2-is-it-possible-to-create-mac-gui-applications-without-firemonkey/7450026#7450026)。

# java - 有没有更好的方法来覆盖文件内容？

> ID：11253843
> 
> 赞同：3
> 
> 时间：2012-06-28T22:32:15.387
> 
> 标签：java, file-io

我正在寻找覆盖已经存在的文件的内容。[显然，我可以根据这个答案](https://stackoverflow.com/a/1016291/1390487)创建一个覆盖旧文件的新文件。但是，我正在编写一个可能会多次执行此操作的程序，并且我想尽可能减少不必要的开销。

所以我的问题是：有没有更好的方法来简单地重写文件本身的内容，而不是编写一个替换旧文件的“新”文件？还是简单地覆盖整个文件内容的开销大致相当于创建新文件然后写入它的开销？（为了记录，这些文件只有 1 KB 大。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-28T22:47:42.890

简短的回答：写两个和配置文件。

较长的答案与相当大的挥手：

覆盖文件将涉及以下系统调用：

```
open
write
close 
```

创建新文件、删除旧文件、重命名新文件将涉及以下系统调用：

```
open
write
close
unlink
rename 
```

系统调用通常是程序中最慢的部分；一般来说，减少系统调用是加快程序速度的好方法。覆盖一个文件将重新使用操作系统的内部目录条目数据；这可能也会导致一些速度提高。（它们可能很难用具有 VM 开销的语言来衡量......）

您的文件足够小，`write()`应该以原子方式处理每个文件，假设您在一次写入中更新整个 1K。（由于您关心性能，这似乎是一个安全的假设。）这确实意味着其他进程不应该看到*部分*写入，除非在灾难性电源故障和有损挂载选项的情况下。（不常见。）即使面对多次写入，文件重命名方法也能提供一致的文件。

但是，1K 文件是一种非常低效的存储机制；许多文件系统将沿 4k 块写入文件。如果这些数据块只存在于您的应用程序中，那么将它们写入某种*容器*中可能是有意义的，一次几个。（Quake 派生系统这样做是为了从 zip 文件中读取它们的地图、纹理等，因为巨大的流式 IO 请求比数千个较小的 IO 请求快得多。）当然，如果您的应用程序正在编写，这会更难这些文件供其他应用程序使用，但如果这些文件很少共享，可能仍然值得研究。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T22:54:32.970

您可以`RandomAccessFile`在这里使用一个简短的示例：

```
 // create a new RandomAccessFile with filename test
     RandomAccessFile raf = new RandomAccessFile("c:/test.txt", "rw");

     // write something in the file
     raf.writeUTF("Hello World");

     // set the file pointer at 0 position
     raf.seek(0);

     // print the string
     System.out.println("" + raf.readUTF());

     // print current length
     System.out.println("" + raf.length());

     // set the file length to 30
     raf.setLength(30);

     // print the new length
     System.out.println("" + raf.length()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T22:42:16.713

只需将其用作链接答案中的示例。让操作系统/文件系统担心取消链接/链接 inode、磁盘上的位置等。如今，绝大多数软件开发都没有充分的理由担心它。

一般来说，不会有太多的开销不会被 CPU/磁盘 i/o 所掩盖。如果您担心磁盘 i/o，请使用内存文件系统（前提是您不需要在发生崩溃时保留文件）或 SATA3 上的速度非常快的 SSD。

# php - cURL 不发送 POST 数据，但在终端中正常工作

> ID：11253848
> 
> 赞同：0
> 
> 时间：2012-06-28T22:32:53.707
> 
> 标签：php, cordova, curl

这是在命令行中工作的 curl 代码：

```
 $ curl -F file=@/path/to/index.html -u lslkdfmkls@gmail.com -F 'data={"title":"API V1  App","package":"com.alunny.apiv1","version":"0.1.0","create_method":"file"}' https://build.phonegap.com/api/v1/apps 
```

这是我的代码：

```
$ch = curl_init();

$data = array("title"=>"sampele title","package"=>"com.fsdlfn.sdfknsdj","version"=>"0.1.0","create_method"=>"file","file"=>"@/path/myfolder/myfile.zip");

$jsdata = json_encode($data);

curl_setopt($ch, CURLOPT_URL, 'https://build.phonegap.com/api/v1/app?auth_token='.$token); //got this token already, so using that here .
curl_setopt($ch, CURLOPT_POST, TRUE);
curl_setopt($ch, CURLOPT_HTTPHEADER, array('Content-Type: multipart/form-data'));
curl_setopt($ch, CURLOPT_POSTFIELDS, $jsdata);

echo curl_exec($ch); 
```

curl 命令在终端中工作，但上面的 curl 命令是用 php 编写的，返回错误：

```
{"error":"no create_method specified: file, remote_repo, or hosted_repo"} 
```

有什么解决办法？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T22:39:33.700

试试这个：

```
$ch = curl_init();

$data = array("title"=>"sampele title","package"=>"com.fsdlfn.sdfknsdj","version"=>"0.1.0","create_method"=>"file");

$jsdata = json_encode($data);

curl_setopt($ch, CURLOPT_URL, 'https://build.phonegap.com/api/v1/app?auth_token='.$token); //got this token already, so using that here .
curl_setopt($ch, CURLOPT_POST, TRUE);
curl_setopt($ch, CURLOPT_POSTFIELDS, array('data' => $jsdata, 'file'=>'@/path/myfolder/myfile.zip'));

echo curl_exec($ch); 
```

这就是我进行修复的原因：

1.  `$data`是`json_encode`d，所以 cURL 不会看到该`file`属性，它将作为字符串发送，而不是读取文件 - 这就是为什么我`file`直接放入`POSTFIELDS`
2.  该变量`$data`不会导致它作为`data=...`单个字符串发送（如`POST`ing XML）。

# visual-studio-2010 - Visual Studio 2010 拦截测试事件

> ID：11253851
> 
> 赞同：1
> 
> 时间：2012-06-28T22:33:12.470
> 
> 标签：visual-studio-2010, testing, visual-studio-extensions

我正在编写一个 Visual Studio 2010 (SP1) 扩展，我想截取测试的创建、执行和结果。

我正在考虑在向导中创建“测试项目”时进行测试。我想我必须使用 TestTools API，但我不知道要使用哪个 API :-(

此外，似乎 TestTools 仅在 Visual Studio Premium/Ultimate 中可用，对吗？

我感谢任何指向要拦截的正确事件的指针。谢谢！！

# mysql - Magento AND/OR 组合模型过滤器

> ID：11253853
> 
> 赞同：1
> 
> 时间：2012-06-28T22:33:25.060
> 
> 标签：mysql, magento, orm

您好在 Magento 中创建了一个自定义模型（资源基于 Mage_Core_Model_Resource_Db_Collection_Abstract ）。一切都很好。我试图对表进行过滤，这将输出以下*where*子句：

```
where
  product_id = 1
  and ((customer_id = 0 and customergroup_id = 2) or (customergroup_id = 0 and customer_id = 3))
  and ((productgroup_id = 0 and product_class = 8) or (product_class = 0 and productgroup_id = 4)) 
```

关于如何使用*addFilter*或其他东西来做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T23:56:24.350

`addFieldToFilter`/`addAttributeToFilter`方法不太适合复杂的查询*。*您必须手动构建查询：

```
$collection->getSelect()
    ->where('product_id = ?', 1)
    ->where(sprintf(
        '((customer_id = %d AND customergroup_id = %d) OR (customer_id = %d AND customergroup_id = %d))',
        0, 2, 3, 0))
    ->where(sprintf(
        '((productgroup_id = %d AND product_class = %d) OR (productgroup_id = %d AND product_class = %d))',
        0, 8, 4, 0)); 
```

# javascript - Javascript。计算百分比会导致 1% 的差异

> ID：11253859
> 
> 赞同：0
> 
> 时间：2012-06-28T22:33:55.710
> 
> 标签：javascript

我在计算百分比时遇到了一些 javascript 问题。它总是有 1% 的折扣：

```
pcOff = parseInt((1-(PriceFrom/PriceFromRRP))*100); 
```

PriceFrom 和 PriceFromRRP 是从 JSON 返回中捕获的，如果`PriceFrom = '40.00'`pcOff`PriceFromRRP = '50.00'`被设置为 19；它应该是 20。这里发生了一些有趣的事情。任何人都可以解释一下吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T22:36:32.360

`parseInt`不圆。`Math.round`回合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T22:36:53.263

看看这个成绩单

```
> (1-(40.0/50.0))*100
19.999999999999996

> parseInt(19.999999999999996)
19

> Math.round(19.999999999999996)
20 
```

`parseInt`尽可能多地读取字符串以形成整数，在这种情况下，在前两个字符 1 和 9 上读取 19。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-28T22:37:18.790

```
(1-(PriceFrom/PriceFromRRP))*100 
```

给出：

```
19.999999999999996 
```

当你`parseInt`这样做时，解析器会读取数字，直到它遇到一个非数字 - 即`19`

* * *

你最好的选择（对于这个例子）是最后划分：

```
100 - PriceFrom*100/PriceFromRRP 
```

```
20 
```

这可以防止首先出现浮点错误

# html - H1 标签和 hr 在 div 包围的 div 中未正确定位 CODE ERROR

> ID：11253861
> 
> 赞同：0
> 
> 时间：2012-06-28T22:34:03.713
> 
> 标签：html, header, alignment

我在包含 javascript 弹出图像（占位符）的 div 之间有一个 h1 标头。我希望它与“网站”h1标签相同，向左对齐，向右对齐。但是 hr 会遍历文本，并且文本在页面中居中。唯一应用的CSS是这个

```
.port_title {
text-indent:35px;
position:relative;
 top: 35px;
}

.port_hr { width:550px;
style="color: #333; background-color: #333; height: 1px;
} 
```

你可以在这里查看 html [http://dl.dropbox.com/u/13722201/Dorset%20Designs/portfolio.html](http://dl.dropbox.com/u/13722201/Dorset%20Designs/portfolio.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T23:13:31.527

试试这个：

```
h1 {
    background: #fff; // or whatever is your bg-color
    display:inline-block;
    padding-right: 1em;
}

h1+hr {
    margin-top: -0.6em;
} 
```

**JSFiddle**
[http://jsfiddle.net/cTMXa/](http://jsfiddle.net/cTMXa/)

# c# - backgroundworker 在 RunWorkerAssync 上停止

> ID：11253862
> 
> 赞同：0
> 
> 时间：2012-06-28T22:34:04.470
> 
> 标签：c#, backgroundworker

我正在使用后台工作程序来运行一个单独的线程，但是似乎我的程序在调用`RunWorkerAssync()`.

这是我设置所有内容的地方：

```
 BackgroundWorker worker = new BackgroundWorker();
   worker.WorkerSupportsCancellation = false;
   worker.WorkerReportsProgress = true;
   worker.DoWork += new DoWorkEventHandler(bw_DoWork);
   worker.ProgressChanged += new ProgressChangedEventHandler(bw_ProgressChanged);
   worker.RunWorkerCompleted += new RunWorkerCompletedEventHandler(bw_RunWorkerCompleted);
   worker.RunWorkerAsync();
   console.writeline("I'm Done!"); 
```

这是我的`bw_DoWork`功能：

```
private void bw_DoWork(object sender, DoWorkEventArgs e)
    {

        System.Threading.Thread.Sleep(5000);

    } 
```

我的`bw_RunWorkerCompleted`和`bw_ProgressChanged`：

```
private void bw_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
    {
        if ((e.Cancelled == true))
        {

        }

        else if (!(e.Error == null))
        {

        }

        else
        {

        }
    }

private void bw_ProgressChanged(object sender, ProgressChangedEventArgs e)
    {

    } 
```

我遇到的问题是，我在控制台运行 5 秒后才得到控制台输出。当我将睡眠时间更改为更大/更短时，等待控制台输出的时间会相应调整。

使用后台工作程序的目的不是让您可以在程序继续执行时将某些任务推到不同的线程吗？还是我错过了什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T22:44:39.630

下面的简单应用程序完全符合我的预期。它写着“我完成了！” 立即，然后 5 秒后“完成”。你能想到你在你的程序中可能做的任何不寻常的事情吗？

```
using System;
using System.ComponentModel;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            BackgroundWorker worker = new BackgroundWorker();
            worker.WorkerSupportsCancellation = false;
            worker.WorkerReportsProgress = true;
            worker.DoWork += new DoWorkEventHandler(bw_DoWork);
            worker.ProgressChanged += new ProgressChangedEventHandler(bw_ProgressChanged);
            worker.RunWorkerCompleted += new RunWorkerCompletedEventHandler(bw_RunWorkerCompleted);
            worker.RunWorkerAsync();
            Console.WriteLine("I'm Done!");
            Console.ReadKey(true);
        }

        private static void bw_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
        {
            Console.WriteLine("Completed");
        }

        private static void bw_ProgressChanged(object sender, ProgressChangedEventArgs e)
        {            
        }

        private static void bw_DoWork(object sender, DoWorkEventArgs e)
        {
            System.Threading.Thread.Sleep(5000);
        }
    }
} 
```

# php - HTML 表单未提交

> ID：11253866
> 
> 赞同：2
> 
> 时间：2012-06-28T22:34:23.423
> 
> 标签：php, html

我在 index.php 中只有一个基本的 html 表单，其中包含两个文本字段：

```
<form action="index.php" method="post">
    <label for="title">Title:</label> <input type="text" size="30" name="title"/><br>
    <label for="number">Number:</label> <input type="text" size="30" name="number"/><br>
    <input type="submit" class="submit" name="add" value="Add"/>
</form> 
```

然后我有一些 PHP 脚本来检查表单是否已提交，如果是，它会运行一些脚本但是这个脚本永远不会运行。

```
if($_POST['add'] == "Submit")
{
    echo "This should print but it doesn't";
} 
```

任何想法为什么这不起作用？谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-28T22:35:53.423

代替：

```
if($_POST['add'] == "Submit") 
```

做：

```
if($_POST['add'] == "Add") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T22:38:26.510

提交按钮的值是“添加”，但您正在检查它是否等于“提交”

尝试：

```
if($_POST['add'] == "Add")
{
    echo "This should print but it doesn't";
} 
```

# ruby-on-rails - 使用循环删除 Haml 中的空格

> ID：11253869
> 
> 赞同：0
> 
> 时间：2012-06-28T22:34:55.000
> 
> 标签：ruby-on-rails, haml

这个问题与这个问题相似，但有一个额外的皱纹：

[从 Haml 输出中自动删除所有换行符](https://stackoverflow.com/questions/4320138/auto-removing-all-newlines-from-haml-output)

假设您正在使用如下代码构建一个以逗号分隔的链接列表：

```
- foos.each_with_index do |foo, i|
  = ', ' if i > 0
  = link_to foo.name, foo 
```

如果逗号前面没有空格，你怎么做？我看不到任何方法可以使用现有的鳄鱼运算符或`surround`/ `precede`/来做到这一点`succeed`。

有没有办法重写循环，以便您可以使用这些运算符？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-12-23T07:56:17.990

HAML 带有一个`succeed`可以在这里使用的方法：

```
- foos.each do |foo|
  = succeed (foo == foos.last) ? '' : ', ' do
    = link_to foo.name, foo 
```

使用字符串插值或表达式，您可以有条件地显示空字符串或带空格的逗号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T23:02:43.553

由于 link_to 只是一个返回字符串的助手，因此您可以在单个语句中执行此操作：

```
- foos.each_with_index do |foo, i|
    = link_to(foo.name, foo) + (i < foos.length ? ', ' : '') 
```

但是，您可能希望将此代码提取到帮助程序中并编写测试。

# cocoa - ARC下GCD的内存管理

> ID：11253870
> 
> 赞同：0
> 
> 时间：2012-06-28T22:35:04.530
> 
> 标签：cocoa

目前我正在使用 gcd 在暂停后做一些工作（此代码在池中的队列内运行）：

```
 NSString *queueName = [NSString stringWithFormat:@"com.ixc.callsfreecalls.QueueUpdateAccount%@",accountForUsing.account];
            dispatch_queue_t queue = dispatch_queue_create([queueName cStringUsingEncoding:NSUTF8StringEncoding], NULL);
            dispatch_async(queue, ^{

                sleep(3600);
             /// some job 
```

我喜欢的最终版本：

```
 dispatch_async(dispatch_get_main_queue(), ^{
                    dispatch_release(queue);

                });

            }); 
```

但是应用程序获得了大量内存（我有时有多达 210 个流等待），看起来这种方式是错误的。任何人都可以提出解决该问题的好方法吗？

# jquery - 在 JqueryMobile 中链接样式表和 Javascript

> ID：11253874
> 
> 赞同：0
> 
> 时间：2012-06-28T22:35:42.480
> 
> 标签：jquery, jquery-mobile

感谢您花时间看我的问题。我一直在研究 Jquery mobile 并试图弄清楚它所提供的一切。但是，离开他们的网站后，我使用他们的服务器来托管快速入门指南中提供的 javascript 和 css 文件。

```
 <link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.css" />
<script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
<script src="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.js"></script> 
```

我从他们的网站下载了所有样式表和 javascript 文件，并且很难弄清楚如何正确链接它们以及要链接哪些文件（总共有 8 个文件，我似乎无法弄清楚如何让正确的样式表工作。我希望我已经提供了足够的信息来获得一些帮助！我感谢我能在这个问题上获得的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T22:40:20.067

只需下载并链接您正在使用的确切文件（jquery-1.7.1.min.js、jquery.mobile-1.1.0.min.js 和 jquery.mobile-1.1.0.min.css -压缩，使用默认主题压缩）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T22:40:30.767

尝试`type`属性：

```
<script type='text/javascript' src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
<script type='text/javascript' src="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.js"></script> 
```

# css - 浮动右图在 IE9 中下推下表中的文本

> ID：11253878
> 
> 赞同：3
> 
> 时间：2012-06-28T22:35:54.793
> 
> 标签：css, image, layout, internet-explorer-9

我不是网站管理员，甚至不是网络开发人员，但我的任务是向由 Some Else(TM) 开发的 Wordpress 网站添加内容。

我没有有效的权限来定义新的 CSS 规则，所以这都是内联样式。

这是一个说明问题的页面：[http](http://www.reginedagan.no/program/fiskekonkurranse-i-hovden/) ://www.reginedagan.no/program/fiskekonkurranse-i-hovden/ 。

它在 Firefox 中显示得很好：

![Firefox 按我的预期呈现](../Images/b34267289dd9a5a20447863d00ba8cf7.png)

但是在IE9中，浮动的图片压低了下表中的文字，所以看起来很糟糕：

![在此处输入图像描述](../Images/ac46aa0e54e8287326bb0173b0cde6e5.png)

我在网上找到了一些相关的问题，例如[“CSS: Float right in IE doesn't work!”](http://www.ozzu.com/website-design-forum/css-float-right-doesn-work-t81129.html) 和[“为什么浮动 DIV 会破坏表格定位？”](http://www.webmasterworld.com/forum83/2158.htm) , 那里的建议使我设置`clear: none`在`div`桌子周围，桌子本身，然后是每个人`tr`，最后甚至是每个人`td`。我还摆`width="99%"`在桌子上，并尝试（但我不知道如何正确）应用 IE6 quirk fix `margin-right: -3px`。

因此，这是用 Wordpress 编写的内容，包括未成功的尝试修复：

```
<h1><div style="float: right"><a href="http://www.reginedagan.no/?attachment_id=671"><img src="http://www.reginedagan.no/wp-content/uploads/2012/06/fiskekonkurranse-2011-bilde-3-nedskalert.jpg" alt="Fra fiskekonkurransen i 2011" title="Fra fiskekonkurransen i 2011" width="200" height="242" class="size-full wp-image-671"/></a></div>Fiskekonkurranse i Hovden!</h1>
<div style="background-color: #FAF0F0; clear: none;"><table width="99%" style="clear: none; right-margin: -3px;">
  <tr style=" clear: none;">
    <td style="text-align: left; clear: none;">Dato:</td>
    <td style="text-align: left; clear: none;">Lørdag 21.juli</td>
  </tr>
  <tr style=" clear: none;">
    <td style="text-align: left; padding-left: 2em";  clear: none;>/ barn, Flytebrygga</td>
    <td style="text-align: left; clear: none;">15.00 &ndash; 16.00</td>
  </tr>
  <tr style=" clear: none;">
    <td style="text-align: left; padding-left: 2em;  clear: none;">/ voksne (over 12 år), Moloen</td>
    <td style="text-align: left; clear: none;">15.00 &ndash; 17.00 </td>
  </tr>
  <tr style=" clear: none;">
    <td style="text-align: left; clear: none;">Sted:</td>
    <td style="text-align: left; clear: none;">Hovden</td>
  </tr>
  <tr style=" clear: none;">
    <td style="text-align: left; clear: none;">Pris:</td>
    <td style="text-align: left; clear: none;">voksen (over 12 år) kr. 50,-, barn kr. 30,-</td>
  </tr style=" clear: none;">
  <tr>
    <td style="text-align: left; clear: none;">Arrangør:</td>
    <td style="text-align: left; clear: none;">Hovden Grendelag</td>
  </tr>
</table></div>

Velkommen til den årlige Fiskekonkurransen i Hovden lørdag 21\. juli!

<a href="http://www.reginedagan.no/program/fiskekonkurranse-i-hovden/fiskekonkurranse-2011-bilde-nedskalertjpg/" rel="attachment wp-att-672"><img src="http://www.reginedagan.no/wp-content/uploads/2012/03/fiskekonkurranse-2011-bilde-nedskalertjpg.jpg" alt="Fra fiskekonkurransen i 2011" title="Fra fiskekonkurransen i 2011"  width="400" height="267" class="alignleft size-full wp-image-672" /></a>Det blir stangfiske fra moloen og egen barnekonkurranse fra flytebrygga.

Premiering for størst fisk, størst antall kg og flest antall stk. Premiering for barn kl. 16:30 på moloen. Alle premieres. Premiering for voksne på festen om kvelden.

Salg av pølser og brus, vafler og kaffe, samt sluker.

<div style="clear: left; border: 1px dashed gray; padding: 1em;">
Fest på Hovden samfunnshus kl. 21 &ndash; 02\. 
Musikk: «Mister West», Steinar Aarsnes, Andøya. CC.
Salg av øl/vin og snacks.
</div>

VEL MØTT &mdash; SKITT FISKE! 
```

并将生成的 HTML 提供给浏览器（仅相关的第一部分）：

```
<h1>
<div style="float: right;"><a href="http://www.reginedagan.no/?attachment_id=671"><img src="http://www.reginedagan.no/wp-content/uploads/2012/06/fiskekonkurranse-2011-bilde-3-nedskalert.jpg" alt="Fra fiskekonkurransen i 2011" title="Fra fiskekonkurransen i 2011" class="size-full wp-image-671" height="242" width="200"></a></div>
<p>Fiskekonkurranse i Hovden!</p></h1>
<div style="background-color: rgb(250, 240, 240); clear: none;">
<table style="clear: none;" width="99%">
<tbody><tr style="clear: none;">
<td style="text-align: left; clear: none;">Dato:</td>
<td style="text-align: left; clear: none;">Lørdag 21.juli</td>
</tr> 
```

通过在桌子上设置，我可以用更简单的代码重现*效果。*`clear: right`但是，我无法使用默认样式或`clear: none`（如上）重现效果。所以看起来这可能是 Wordpress 所做的事情，或者可能是主题的事情或它所做的任何事情 - 但它与其他人观察到的非常*相似*，因此有强烈的迹象表明它也是 IE 中的一个怪癖。

帮助？

（也许对标签也有帮助，我以前从未问过网络开发人员的问题？）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-28T22:45:48.857

请改用绝对定位。

取出浮动 div 并将其放入包含表格的 div 中，这样你就有了

```
<div style="background-color: rgb(250, 240, 240); clear: none;">

    <div style="float: right;"><a href="http://www.reginedagan.no/?attachment_id=671"><img src="http://www.reginedagan.no/wp-content/uploads/2012/06/fiskekonkurranse-2011-bilde-3-nedskalert.jpg" alt="Fra fiskekonkurransen i 2011" title="Fra fiskekonkurransen i 2011" class="size-full wp-image-671" height="242" width="200"></a></div>

    <table style="clear: none;" width="99%">
    ...
    </table>

</div> 
```

然后稍微改变一下css样式，让它看起来像这样。（编辑以反映我最近的评论）

```
<div style="background-color: rgb(250, 240, 240); clear: none; position:relative;">

    <div style="position:absolute;right:0px;top:-120px;z-index:50;"><a href="http://www.reginedagan.no/?attachment_id=671"><img src="http://www.reginedagan.no/wp-content/uploads/2012/06/fiskekonkurranse-2011-bilde-3-nedskalert.jpg" alt="Fra fiskekonkurransen i 2011" title="Fra fiskekonkurransen i 2011" class="size-full wp-image-671" height="242" width="200"></a></div>

    <table style="clear: none;" width="99%">
    ...
    </table>

</div> 
```

并为您的 h1 标签提供样式属性

```
<h1 style="padding-right:200px;"> ... </h1> 
```

使 div 的绝对位置更加稳定，包含您的图像的 div 的位置完全独立于其他内容，使用坐标式定位（right 和 top 属性）

将包含表格的 div 设置为 position:relative; 确保图像 div 相对于容器定位。

填充 h1 标签将确保您的文本在之前的位置中断。

让我知道这是否有效。

干杯。

# ios - SVN 忽略“.a”文件

> ID：11253885
> 
> 赞同：6
> 
> 时间：2012-06-28T22:37:17.757
> 
> 标签：ios, xcode, cocoa-touch, svn

我正在尝试在我的 XCode 项目中添加一个“.a”文件，但它被 SVN 忽略了，因此我无法将它添加到存储库中。任何线索可能是什么原因？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-28T22:39:28.957

是的，你必须手动完成。只需在控制台中导航到它并执行 svn add file_name.a 它应该可以工作。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-28T22:45:52.280

SVN 有一个全局忽略列表。默认情况下，它包括最流行的生成文件类型的掩码。.a 就是其中之一。

忽略列表位于 SVN 配置文件的 miscellany/global-ignores 下。配置文件位于 ~/.subversion/config。默认情况下，它在 Finder 中不可见。

# matlab - 如何在 MATLAB 中将两个图例添加到单个图中？

> ID：11253887
> 
> 赞同：9
> 
> 时间：2012-06-28T22:37:33.390
> 
> 标签：matlab, plot, legend, matlab-figure

我想在 MATLAB 的图中添加两个图例。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-29T00:54:40.177

您可以创建第二个叠加轴，带有自己的图例（当然在不同的位置）。

* * *

### 编辑：

这是一个简单的例子：

```
%# create some plot with a legend
hAx(1) = axes();
hLine(1) = plot(1:10, 'Parent',hAx(1));
set(hAx(1), 'Box','off')
legend(hLine(1), 'line')

%# copy the axis
hAx(2) = copyobj(hAx(1),gcf);
delete( get(hAx(2),'Children') )            %# delete its children
hLine(2) = plot(sin(1:10), 'Color','r', 'Parent',hAx(2));
set(hAx(2), 'Color','none', 'XTick',[], ...
    'YAxisLocation','right', 'Box','off')   %# make it transparent
legend(hLine(2), {'curve'}, 'Location','NorthWest', 'Color','w') 
```

![截屏](../Images/d699676893d71b34f8755bd2eb70f8ae.png)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-04-24T00:17:57.220

要创建粘性图例，您可以调用 `copyobj`

```
handle_legend = legend(handle_plot, 'string1');
copyobj(handle_legend, handle_figure); 
```

该`copyobj`函数只是在图中保留其相关的图例。

这适用于单个轴（无需创建第二个叠加轴），并且可以通过这种方式添加多个图例。

例子：

```
%declare figure
hfigure = figure('Color', 'w');

%plot 2 lines (red and blue)
hplot1 = plot(1:10,'r-.x');
hold on;
hplot2 = plot(10:-1:1,'b--o');

%plot legends
hlegend1 = legend(hplot1, 'Data 1', 'Location','East'); %display legend 1
new_handle = copyobj(hlegend1,hfigure);                 %copy legend 1 --> retain
legend(hplot2, 'Data 2', 'Location','West');            %display legend 2 
```

![在此处输入图像描述](../Images/b45fe0c9f8582d22a7f6feff54a2819f.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-05-12T21:18:42.357

制作第一个图例后，制作一个新的、不可见的轴手柄：

```
ax=axes('Position',get(gca,'Position'),'Visible','Off'); 
```

现在在新轴上制作第二个图例：

```
legend(ax,...); 
```

它与@Amro 的答案原则上相同，但更简单、更短。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-02-15T08:55:05.493

多个图的示例：

```
hAx(1) = axes();
hold on
hLine(1) = plot(1:10, 'Parent',hAx(1),'color','b');
hLine(2) = plot(3:15, 'Parent',hAx(1),'color','b', 'linestyle','--');
set(hAx(1), 'Box','off')
legend([hLine(1), hLine(2)],{ 'line' 'line2'})

%# copy the axis
hAx(2) = copyobj(hAx(1),gcf);
delete( get(hAx(2),'Children') )            %# delete its children
hold on
hLine(3) = plot(sin(1:10), 'Color','r','Parent',hAx(2));
hLine(4) = plot(cos(1:10), 'Color','r','linestyle','--','Parent',hAx(2));
hold off
set(hAx(2), 'Color','none', 'XTick',[], ...
'YAxisLocation','right', 'Box','off')   %# make it transparent
legend([hLine(3),hLine(4)], {'sin' , 'cos'}, 'Location','NorthWest', 'Color','w')
%legend(hLine(3), {'sin'}, 'Location','NorthWest', 'Color','w') 
```

# java - LWJGL + 光滑纹理未加载

> ID：11253890
> 
> 赞同：0
> 
> 时间：2012-06-28T22:37:47.550
> 
> 标签：java, opengl, lwjgl

我无法使用带有 LWJGL 的 TextureLoader 类加载任何纹理，并且无法与 OpenGL 一起使用。这是我的代码：

```
try {
        sprite = TextureLoader.getTexture("PNG", new FileInputStream("sprite.png"));
    }catch(Exception e) {}

    if(sprite == null) {
        System.out.println("Sprite is null");
    }else {sprite.bind();}

    glBegin(GL_QUADS);
    glTexCoord3f(0, 1, 0);
    glVertex3f(0, 1, 0);
    glTexCoord3f(1, 1, 0);
    glVertex3f(1, 1, 0);
    glTexCoord3f(1, 0, 0);
    glVertex3f(1, 0, 0);
    glTexCoord3f(0, 0, 0);
    glVertex3f(0, 0, 0);
    glEnd(); 
```

我知道图像在我班级的同一目录中，我不相信我的 OpenGL 代码有任何问题，因为我已经能够成功绘制四边形/立方体。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T12:43:35.543

我不知道为什么，但是在使用 lwjgl 纹理时，您必须在 3d 四边形之上创建一个 2d 纹理图像 [像这样：]

```
 glBegin(GL_QUADS);

        glTexCoord2d(0, 0);
        glVertex3d(0, 0, 0);
        glTexCoord2d(1, 0);
        glVertex3d(32, 0, 0);
        glTexCoord2d(1, 1);
        glVertex3d(32, 32, 0);
        glTexCoord2d(0, 1);
        glVertex3d(0, 32, 0);

        glEnd(); 
```

# python - 通过复制 TesserCap 的斩波滤波器去除验证码图像的背景噪声

> ID：11253899
> 
> 赞同：10
> 
> 时间：2012-06-28T22:38:44.000
> 
> 标签：python, image-processing, imagemagick, python-imaging-library

我有一个看起来像这样的验证码图像：

![](../Images/036cb5857f0a9134ddcfc626eec6f5c6.png)

使用 McAfee 的名为[TesserCap](http://www.mcafee.com/us/downloads/free-tools/tessercap.aspx)的实用程序，我可以对图像应用“斩波”过滤器。（在运行它之前，我确保图像中只有两种颜色，白色和黑色。）在文本框中使用值为 2 的过滤器的结果给我留下了深刻的印象。它准确地去除了大部分噪音，但保留了正文，结果如下：

![](../Images/59f7f746c15e1c90635047a5fa0e5512.png)

我想在我自己的一个脚本上实现这样的东西，所以我试图找出 TesserCap 使用的图像处理库。我什么也找不到；事实证明它使用自己的代码来处理图像。然后我阅读[了这份白皮书](http://www.mcafee.com/us/resources/white-papers/foundstone/wp-tessercap-visual-captcha-tool.pdf)，该白皮书准确地解释了该程序的工作原理。它给了我关于这个斩波滤波器的以下描述：

> 如果给定灰度值的连续像素数小于数字框中提供的数量，则斩波滤波器会根据用户选择将这些序列替换为 0（黑色）或 255（白色）。CAPTCHA 在水平和垂直方向上进行分析，并进行相应的更改。

我不确定我是否理解它在做什么。我的脚本是用 Python 编写的，所以我尝试使用 PIL 来操作类似于引用所描述的像素。这听起来很简单，但我失败了，可能是因为我真的不知道过滤器到底在做什么：

![](../Images/98686efcc9791541da3aba7877120393.png) （这是由使用圆形图案的稍微不同的验证码制成的。）

我还尝试查看是否可以使用 ImageMagick 的 convert.exe 轻松完成。他们的 -chop 选项完全不同。使用 -median 和一些 -morphology 命令有助于减少一些噪音，但出现了令人讨厌的点并且字母变得非常扭曲。这并不像使用 TesserCap 进行斩波滤波器那么简单。

所以，我的问题如下：如何在 Python 中实现 TesserCap 的斩波过滤器，无论是使用 PIL 还是 ImageMagick？该斩波过滤器比我尝试过的任何替代品都好得多，但我似乎无法复制它。我已经为此工作了几个小时，但还没有弄清楚任何事情。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-29T01:07:45.750

该算法本质上检查一行中是否有多个目标像素（在本例中为非白色像素），如果像素数小于或等于斩波因子，则更改这些像素。

例如，在像素的样本行中，其中`#`是黑色和`-`白色，应用斩波因子`2`将转换`--#--###-##---#####---#-#`为`------###-------#####-------`。这是因为存在小于或等于2个像素的黑色像素序列，并且这些序列被替换为白色。大于 2 个像素的连续序列仍然存在。

这是我的 Python 代码（如下）在您帖子的原始图像上实现的斩波算法的结果：

![“切碎”图像](../Images/99b2f63f9770a22bbe6ae6c124c9d20a.png)

为了将其应用于整个图像，您只需在每一行和每一列上执行此算法。这是完成此任务的 Python 代码：

```
import PIL.Image
import sys

# python chop.py [chop-factor] [in-file] [out-file]

chop = int(sys.argv[1])
image = PIL.Image.open(sys.argv[2]).convert('1')
width, height = image.size
data = image.load()

# Iterate through the rows.
for y in range(height):
    for x in range(width):

        # Make sure we're on a dark pixel.
        if data[x, y] > 128:
            continue

        # Keep a total of non-white contiguous pixels.
        total = 0

        # Check a sequence ranging from x to image.width.
        for c in range(x, width):

            # If the pixel is dark, add it to the total.
            if data[c, y] < 128:
                total += 1

            # If the pixel is light, stop the sequence.
            else:
                break

        # If the total is less than the chop, replace everything with white.
        if total <= chop:
            for c in range(total):
                data[x + c, y] = 255

        # Skip this sequence we just altered.
        x += total

# Iterate through the columns.
for x in range(width):
    for y in range(height):

        # Make sure we're on a dark pixel.
        if data[x, y] > 128:
            continue

        # Keep a total of non-white contiguous pixels.
        total = 0

        # Check a sequence ranging from y to image.height.
        for c in range(y, height):

            # If the pixel is dark, add it to the total.
            if data[x, c] < 128:
                total += 1

            # If the pixel is light, stop the sequence.
            else:
                break

        # If the total is less than the chop, replace everything with white.
        if total <= chop:
            for c in range(total):
                data[x, y + c] = 255

        # Skip this sequence we just altered.
        y += total

image.save(sys.argv[3]) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-28T23:20:44.333

尝试这样的事情（伪代码）：

```
for each row of pixels:
    if there is a group of about 3 or more pixels in a row, leave them
    else remove the pixels 
```

然后只需对列重复相同的操作。似乎它至少可以工作一点。像这样水平和垂直移动也将删除水平/垂直线。

# javascript - 为什么通过在变量名后面放置一个 0 来访问某些 JavaScript 变量？

> ID：11253905
> 
> 赞同：0
> 
> 时间：2012-06-28T22:39:29.610
> 
> 标签：javascript, object

假设您有一个对象文字：

```
var d = {
    x: +'35',
    y: '25'
}; 
```

还有一个匿名函数：

```
function (d) {
    return d.y0 + d.y;
} 
```

当我试验这段代码时，我得到“未定义”代替 d.y0。但是有很多 d3.js 代码通过将 0 附加到它的键来访问一个值。这个 0 有什么作用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T22:47:03.310

在 JavaScript 中，`d.y0`除非`d`有一个名为 的属性，否则它是未定义的`y0`。我对 d3 不熟悉，但如果它使用纯 JavaScript，那么他们可以引用附加 0 的属性的唯一方法是，他们引用属性的对象是否具有具有该名称的属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-29T07:11:34.197

查看链接中的 javascript 源代码，y0 是 d3 中使用的内部名称，用于指代数据集合中第一个点的 y 坐标，例如：

```
function d3_svg_lineBundle(points, tension) {
  var n = points.length - 1;
  if (n) {
    var x0 = points[0][0],
        // Here
        y0 = points[0][1], 
```

或者

```
function d3_svg_lineBasis(points) {
  if (points.length < 3) return d3_svg_lineLinear(points);
  var i = 1,
      n = points.length,
      pi = points[0],
      x0 = pi[0],
      // Here
      y0 = pi[1], 
```

将“0”附加到属性名称绝对没有什么特别之处！

代码示例来自这个 js 文件： http://mbostock.github.com/d3/d3.js? [1.29.1](http://mbostock.github.com/d3/d3.js?1.29.1)

# css - 使用带有 CSS 的自定义字体

> ID：11253910
> 
> 赞同：2
> 
> 时间：2012-06-28T22:40:04.700
> 
> 标签：css, fonts, font-face

我正在尝试获取自定义字体。

当我尝试时，字体不起作用，它使用自定义 Times new Roman。

这是我在样式表中的代码：

```
@font-face {
    font-family: "ARBONNIE";
    src: url(Custom/ARBONNIE.ttf);
}
font {
    font-family: "ARBONNIE";
} 
```

但是，当我查看网站时，没有显示自定义字体。
这是正确的目录和一切。请帮忙 ：（

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-28T23:23:06.143

您的使用`@font-face`不兼容所有浏览器。生成跨浏览器`@font-face`代码的有用工具在这里： [Font Squirrel `@font-face`Generator](http://www.fontsquirrel.com/fontface/generator)。该生成器将为您提供所需的所有文件以及可用于在各种浏览器中进行测试的完整示例。

最终在您的页面上，您的 CSS 将如下所示：

```
@font-face {
    font-family: 'BitstreamVeraSerifBold';
    src: url('verasebd-webfont.eot');
    src: url('verasebd-webfont.eot?#iefix') format('embedded-opentype'),
         url('verasebd-webfont.woff') format('woff'),
         url('verasebd-webfont.ttf') format('truetype'),
         url('verasebd-webfont.svg#BitstreamVeraSerifBold') format('svg');
    font-weight: normal;
    font-style: normal;

}

.custom-font {
    font-family: 'BitstreamVeraSerifBold';
} 
```

请注意，我在`BitstreamVeraSerifBold`这里使用字体，字体文件与 CSS 文件位于同一目录中。

在您的 HTML 中：

```
<span class="custom-font">Your text here</span> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T22:48:47.070

您是否将其用于整个网站？

您放置“font {}”的位置是您应该分配字体的位置，无论它是 div、a、p、span、body 等。

所以尝试`body { font-family: "ARBONNIE"; }`希望它有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T23:03:59.103

我看到两个潜在的问题：

@font-face 仅在某些浏览器和某些字体类型中受支持

IE9 支持 @font-face 用于 .eot 字体 IE8 及更早版本不支持 @font-face Firefox、Opera、Chrome 和 Safari 支持 @font-face 用于 *.ttf 和 *.otf 字体

你在IE中测试这个吗？*.ttf 不起作用。

第二个可能的问题 - 尝试在不使用“字体”作为选择器的情况下执行此操作。使用唯一选择器或将其分配给 body 或 p 选择器

编辑 - 看到你想要一个区域。选择一个新的选择器，使用如下字体样式：

```
@font-face {
  font-family: "ARBONNIE";
  src: url("Custom/ARBONNIE.ttf");}

ArbFont {font:16pt "Arbonnie";} 
```

然后更改您的 html 以使用新的选择器，例如：

```
<div id="ArbFont">This is in Arbonnie</div> 
```

# .net - 如何获得完整的 8 位 alpha 透明表单窗口

> ID：11253915
> 
> 赞同：1
> 
> 时间：2012-06-28T22:40:39.007
> 
> 标签：.net, winforms, transparency, paint

我该怎么做才能在每个像素处使用 8 位透明度绘制表单（使用 PNG 文件），以便我可以拥有 100% 的像素，以及 100% 的像素，以及那些混合的。

混合部分意味着我不能使用 Form.TransparencyKey。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T22:46:24.173

WinForms 对透明度的支持是可怕的。

如果可能，请考虑使用 WPF 编写应用程序的这一部分。您可以将 WPF 集成到 WinForms 应用程序中。看：

[将 WPF 与 WinForm 应用程序混合使用？](https://stackoverflow.com/questions/3685142/mixing-wpf-with-a-winform-application)

# algorithm - Tarjan的SCC算法中的lowlink是什么意思？

> ID：11253918
> 
> 赞同：8
> 
> 时间：2012-06-28T22:40:55.023
> 
> 标签：algorithm, terminology, tarjans-algorithm

我正在阅读以下链接中的代码[http://www.cosc.canterbury.ac.nz/tad.takaoka/alg/graphalg/sc.txt](http://www.cosc.canterbury.ac.nz/tad.takaoka/alg/graphalg/sc.txt) 我一直碰到“低链接”这个词，我没有知道这意味着什么。我知道这是一个相当无聊的问题，但有人可以向我解释一下吗？谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-28T22:55:05.637

如链接文章中所述：

> 该算法还维护了一个低链接数，当一个顶点第一次被访问时，它最初被分配与访问数相同的值。

换句话说，低链路值最初等于节点在初始 DFS 期间具有的数量。如果是访问的第一个节点，则值为 0。如果是第二个节点，则值为 1。第三个节点的值为 2，第四个值为 3，依此类推。

从那里，低链接值被更新，以便它跟踪给定节点恰好在哪个 SCC 中。这个想法是，最初我们认为每个节点都在它自己的 SCC 中，但是如果我们发现两个不同的节点是在同一个 SCC 中，我们更新所有这些节点的低链路值，使它们都相同。

希望这可以帮助！

# javascript - jQuery .active HTML 显示

> ID：11253920
> 
> 赞同：1
> 
> 时间：2012-06-28T22:41:05.307
> 
> 标签：javascript, jquery, html, ajax

此代码调用新数据并将其放入 div 中，但不会替换旧的 htm。它只是增加了它。代码中有错误，但我找不到它们。如何让它替换 htm 文件而不仅仅是添加到数据中？

```
.click(function () {

  $('.tabActive').removeClass('tabActive');
  $(this).addClass('tabActive');
  var lesson = $(this).attr('.lesson');
  var self = this
  $("#loading").show();

  setTimeout(function () {

    $.ajax({
      type: "GET",
      url: 'lessons/' + lesson + '.htm',
      datatype: "html",
      success: function (data) {
        $('#sectionTabContent').append(data);
      },
      complete: function () {
        $("#loading").hide();
      }
    })
  }, 3000);
});
} 
```

HTML

```
<div id='sectionThreeTabs'>                           
    <div id='' class='sectionThreeTab tabActive' lesson='first'>
        Try
    </div>
    <div class='sectionThreeTab' lesson='second'>
        Anger
    </div>
    <div class='sectionThreeTab' lesson='third'>
        Size
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T22:43:42.037

改变

```
 $('#sectionTabContent').append(data); 
```

到

```
 $('#sectionTabContent').html(data); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T22:43:50.127

换行

```
$('#sectionTabContent').append(data); 
```

和

```
$('#sectionTabContent').html(data); 
```

# c# - 地理服务器中的身份验证 - asp.net 中的 POST 方法

> ID：11253926
> 
> 赞同：1
> 
> 时间：2012-06-28T22:41:31.903
> 
> 标签：c#, asp.net, geoserver

我想使用我的 asp.net 应用程序进行 POST 调用以在地理服务器中进行身份验证，这是我的代码

```
HttpWebRequest req = WebRequest.Create(new Uri("http://localhost:1979/geoserver/rest")) as HttpWebRequest;
req.Method = "POST";
req.ContentType = "application/xml";
string authInfo = "admin:geoserver";
req.Headers["Authorization"] =  Convert.ToBase64String(Encoding.ASCII.GetBytes("Basic"+ authInfo));

// Build a string with all the params, properly encoded.
// We assume that the arrays paramName and paramVal are
// of equal length:
StringBuilder paramz = new StringBuilder();
for (int i = 0; i < paramName.Length; i++)
{
    paramz.append(paramName[i]);
    paramz.append("=");
    paramz.append(HttpUtility.UrlEncode(paramVal[i]));
    paramz.append("&");
}

paramz.Append("username");
paramz.Append("=");
paramz.Append("admin");
paramz.Append("&");
paramz.Append("password");
paramz.Append("=");
paramz.Append("geoserver");

CredentialCache cc = new CredentialCache();
cc.Add(
    new Uri("http://localhost:1979/geoserver/rest"),
    "Basic",
    new NetworkCredential("admin", "geoserver", "localhost"));

req.Credentials = new NetworkCredential("admin", "geoserver", "localhost");  
//req.Credentials = CredentialCache.DefaultCredentials;
//req.Credentials = cc;
//req.AllowAutoRedirect = true;

// Encode the parameters as form data:
byte[] formData =
    UTF8Encoding.UTF8.GetBytes(paramz.ToString());
req.ContentLength = formData.Length;

// Send the request:
using (Stream post = req.GetRequestStream())
{
    post.Write(formData, 0, formData.Length);
}

// Pick up the response:
string result = null;

HttpWebResponse resp=null;
try
{
    resp = (HttpWebResponse)req.GetResponse();
    using (resp as HttpWebResponse)
    {
        StreamReader reader =
            new StreamReader(resp.GetResponseStream());
        result = reader.ReadToEnd();
    }
}
catch (WebException we)
{
    HttpWebResponse errorResponse = we.Response as HttpWebResponse;
    if (errorResponse.StatusCode == HttpStatusCode.NotFound)
    {

    }

} 
```

即使我包含我的登录凭据，我也会收到此错误“远程服务器返回错误：（401）未经授权”

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T16:12:39.080

更改此行

```
req.Headers["Authorization"] =  Convert.ToBase64String(Encoding.ASCII.GetBytes("Basic"+ authInfo)); 
```

至

```
req.Headers["Authorization"] =  Convert.ToBase64String(Encoding.ASCII.GetBytes("Basic "+ authInfo)); 
```

Authorization 标头实际上是`Basic YyXxZzEtcEtc`带有嵌入空间的。

# java - 如何找出旋转立方体的顶点坐标？

> ID：11253930
> 
> 赞同：-5
> 
> 时间：2012-06-28T22:42:24.603
> 
> 标签：java, 3d, geometry, cube, vertex

我目前正在尝试用 java 制作一个方向计算器，但在旋转各种对象时遇到了一些麻烦。

假设我们有一个具有初始位置的立方体，并且它的每个顶点都是已知的（以及它的中心）。***然后立方体从Y 轴上***的初始位置以***角度***弧度（或度数，没关系）旋转，并在***X 轴上***以***角度x***弧度旋转。为了简单起见，我将单独保留 Z 轴，并且立方体的中心位于图形的原点。

考虑到所有已知并用***v1***到***v8***标记的顶点的坐标，以及已知的*anglex*和*angley*，有人可以告诉我立方体每个顶点的表达式吗？

请不要告诉我在 Java 中可能会或可能不会找到的辅助方法。只需告诉我每个点的原始表达式（如果可以节省空间，您可以将它们集成到 for 循环中）。

如果您确实需要初始条件示例，请考虑以下多维数据集：

```
 float vertices[]={
1, 1, -1,  //v1 - top front right
1, -1, -1, //v2 - bottom front right
-1, -1, -1,//v3 - bottom front left
-1, 1, -1, //v4 - top front left

1, 1, 1,  //v5 - top back right
1, -1, 1, //v6 - bottom back right
-1, -1, 1,//v7 - bottom back left
-1, 1, 1 //v8 - top back left
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T22:52:30.770

一般来说，它取决于旋转的顺序。旋转通常不会通勤，也就是说，如果您首先围绕轴 a 旋转然后再围绕轴旋转，反之亦然。每次旋转都可以矩阵形式表示为顶点的线性函数。将原始坐标映射到旋转坐标的最终矩阵是各个旋转的乘积。所以你可以计算单个旋转矩阵（只是谷歌“旋转矩阵”），计算它们的乘积，然后计算这个矩阵与每个顶点的乘积，给你最终的顶点。通常，即通常在计算机图形等中，为了避免由于旋转的顺序依赖性而引起的混淆，使用四元数来表示旋转，但这会涉及更多...希望这对您有所帮助并为您提供正确的方向:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T22:58:12.560

您使用旋转矩阵旋转单点。

[http://en.wikipedia.org/wiki/Rotation_matrix](http://en.wikipedia.org/wiki/Rotation_matrix)

所以它最终使用矩阵乘法方程。

```
 v' = R * v 
```

其中 v 是笛卡尔坐标中的向量点，R 是旋转矩阵，v' 是新点。您必须对每个点应用此乘法。

# jdo - 如何将整数列指定为无符号？

> ID：11253933
> 
> 赞同：1
> 
> 时间：2012-06-28T22:42:59.767
> 
> 标签：jdo, unsigned, datanucleus

假设以下类

```
@PersistenceCapable(identityType = IdentityType.APPLICATION, detachable = "true")
public class TclRequest2 {
    @PrimaryKey
    @Persistent(valueStrategy = IdGeneratorStrategy.IDENTITY)
    private long id;
    @Persistent(column = "userid")
    @Column(defaultValue = "1", jdbcType = "INTEGER", length = 11, allowsNull = "false", extensions = {})
    private Member member;
    //Getters and setters
} 
```

“成员”字段的列应转换为整数列。但是该列必须创建一个外键约束来指向“成员”的主键字段，该字段的类型为

```
INT(11) UNSIGNED 
```

我想出了如何制作如图所示的第一部分，但我不知道如何指定该字段应该是`UNSIGNED`！

谢谢你。

# php - 大型 php 脚本的“自动安装程序”如何工作？

> ID：11253934
> 
> 赞同：0
> 
> 时间：2012-06-28T22:43:00.000
> 
> 标签：php, installation

我正在寻找一种方便用户安装并在未来更新他们的软件副本的方法。

在这个阶段，我没有尝试任何东西，也不是在寻找代码，只是为他们的应用程序构建安装程序/更新程序的任何人的想法、问题和过去的经验。

**我在想的是；**

用户将下载一个非常基础的系统，其中将包含一个安装程序文件和几个所需的基本目录。

他们必须为每个目录设置读/写权限，然后运行安装程序。然后，这将下载并创建运行系统所需的所有文件。

然后用户应删除安装程序文件。

以后登录管理员时，系统会查看是否有更新发布，然后点击链接，锁定站点，系统会自行更新，然后重新打开站点。

**明显问题：**

授予 PHP 对该站点的写访问权限允许黑客尝试和安装恶意文件然后运行的可能性。

我知道 Wordpress 具有使用 PHP FTP 类构建的更新功能，这可能是一种选择。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T23:45:12.883

下载一些具有自动安装程序的常用脚本（wordpress、joomla、登录脚本等）并查看代码！通常它是这样的：

1.  检查文件/文件夹/权限
2.  询问数据库连接/用户/密码
3.  检查 dbs 是否正确
4.  创建（并填充）数据库，编写一些配置
5.  移动/删除文件

很简单的东西。但是让非程序员很容易处理产品。

# css - CSS样式表不显示样式

> ID：11253939
> 
> 赞同：-1
> 
> 时间：2012-06-28T22:43:50.243
> 
> 标签：css

我目前正在设计这个网站[http://avs.mybigcommerce.com](http://avs.mybigcommerce.com)。问题是我的styles.css 没有显示它的任何样式。有人可以帮帮我吗？

这是屏幕截图的链接 [https://dl.dropbox.com/u/46754431/store-screen.png](https://dl.dropbox.com/u/46754431/store-screen.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T22:52:28.877

您可以检查几件事：

检查您是否已正确链接它：

```
<LINK rel="stylesheet" type="text/css"
     href="styles.css" title="Default Styles" media="screen"> 
```

*   检查样式表是否在正确的目录中，等等。
*   检查您是否有正确的 CSS 和 HTML 标记。您可以使用[http://validator.w3.org/](http://validator.w3.org/)和[http://jigsaw.w3.org/css-validator/等工具](http://jigsaw.w3.org/css-validator/)
*   确保清除浏览器缓存
*   确保 HTML 不在您的 CSS 中。

进一步的参考可以在这里找到：

*   [http://csscreator.com/node/34253](http://csscreator.com/node/34253)
*   [http://meyerweb.com/eric/articles/webrev/199904.html](http://meyerweb.com/eric/articles/webrev/199904.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T22:59:51.940

嗯，您的样式表 __master/Styles/styles.css 似乎在 __custom/Styles/styles.css?fc3ff 之前有一个 CSS 重置。（重置所有值）。尝试更改样式表的顺序或将重置包含在单独的样式表中，该样式表应该首先出现。希望这可以帮助。

# cxf - Spring WS wsdl 到 java

> ID：11253943
> 
> 赞同：1
> 
> 时间：2012-06-28T22:44:11.500
> 
> 标签：cxf, axis, spring-ws, wsdl2java

我希望使用一些框架来帮助生成基于服务提供商提供的 wsdl 的 java 客户端绑定。

有 Axis 和 CXF 之类的选项，但我也在关注 Spring-WS。

尽管 Spring-WS 首先对编写 Web 服务有很大的支持，但它似乎没有像 wsdl 这样的客户端功能来生成 Java（除非我遗漏了一些东西）。

这是否意味着 Spring WS 对我来说不是一个好选择？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T23:51:50.310

你是对的，它没有像 Axis 或 CXF 那样提供生成客户端绑定的机制。[但是，由于它促进了基于消息的 web 服务，因此围绕 Spring WebserviceTemplate](http://static.springsource.org/spring-ws/site/apidocs/org/springframework/ws/client/core/WebServiceTemplate.html)手动创建适配器将相当容易。

为了从 wsdl 创建类型，java 已经附带了[xjc](http://docs.oracle.com/javase/6/docs/technotes/tools/share/xjc.html)工具，该工具现在可以接收 wsdl（或模式）并生成符合 JAXB2 的 java 类。

# objective-c - 滚动条背景在 NSScrollView 中不透明

> ID：11253949
> 
> 赞同：7
> 
> 时间：2012-06-28T22:45:07.397
> 
> 标签：objective-c, xcode, nsscrollview, scroller

[![滚动条](../Images/6b4cef94c947965853639c43eb220483.png)](https://i.stack.imgur.com/52yi3.png)

你好！我正在使用具有基于视图的 NSTableView 的 NSScrollView。每当表格添加表格单元格时，滚动条就会显示出来，这很好，直到您看到滚动条没有透明背景。出于某种原因，它的背景是白色的，正如您在图像上看到的那样。

我使用 IB 设置了 NSScrollView 和 NSTableView，但我找不到任何可以禁用滚动条背景的选项。有什么想法可能导致这种情况吗？

更新：Xcode 中我的 NSScrollView 的设置

[![Xcode](../Images/0b59203e0ceb142ab9f56ba4a48113aa.png)](https://i.stack.imgur.com/8xwm0.png)

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-10-27T00:41:11.070

覆盖 NSScroller 并执行以下操作。这会给你一个透明的背景。

```
- (void) drawRect: (NSRect) dirtyRect
{
    [self drawKnob];
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-28T22:55:46.603

我唯一的建议是确保您是默认样式，或者如果您使用自定义滚动条，则`NSScrollers`设置为覆盖的类。`+ (BOOL)isCompatibleWithOverlayScrollers`

在 IB 中，检查“滚动旋钮”下的“默认样式”是否被选中，从顶部数第二个。

![在此处输入图像描述](../Images/b060ba2737b72f2e7b7cbddfd7fab704.png)

* * *

OS X Lion 引入了新的`NSScrollers`（覆盖滚动条），与 Snow Leopard 和 SL 之前的版本（旧滚动条）形成对比。覆盖滚动条是淡入/淡出的类型，并在内容顶部绘制而没有明显的白色背景。

在某些情况下，Lion 决定使用旧版滚动条而不是新的覆盖滚动条（因为，例如，如果插入了不带滚轮的指针设备，它就不能完全滚动隐藏的覆盖滚动条）

[OS X 10.7 文档](http://developer.apple.com/library/mac/#releasenotes/MacOSX/WhatsNewInOSX/Articles/MacOSX10_7.html)很好地解释了它。总而言之，检查 a) 用户是否禁用了覆盖滚动条，b) 如果您插入了不受支持的设备，或者 c) 您正在继承 NSScroller、添加附件视图或忘记覆盖`+ (BOOL)isCompatibleWithOverlayScrollers`。

如果您不喜欢出现的遗留滚动条并希望支持不受支持的设备（例如，在不淡入/淡出的内容顶部绘制的灰色滚动条），您必须对其进行子类`NSScroller`化并自定义绘制。像 Twitter for Mac 这样的应用程序可以做到这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-07T22:39:23.213

对我来说，在我的视图控制器中，我将滚动条样式设置为：

```
[_scrollView setScrollerStyle:NSScrollerStyleOverlay]; 
```

这使得滚动条具有透明背景。

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2014-07-22T10:40:53.193

如果你想在 NSScrollView 中实现透明度，或者只是想为滚动视图提供清晰的背景......只需使用`setDrawsBackground`NSScrollView 的属性，即：

```
[scrollView setDrawsBackground:NO]; 
```

希望这可以帮助某人。谢谢 ：）

# cron - Moodle 2.2.3 在命令行中执行时出错

> ID：11253951
> 
> 赞同：0
> 
> 时间：2012-06-28T22:45:18.100
> 
> 标签：cron, syntax-error, moodle

我正在安装 Moodle 2.2.3，但无法让 cron 工作正常工作。我已经配置了 crontab，我什至用其他脚本对其进行了测试，并且它可以工作。

我相信的问题是，即使我尝试通过在命令行中执行此操作来手动执行 cron 脚本：

```
php /kunden/homepages/44/d******/htdocs/moodle/moodle-223/admin/cli/cron.php 
```

我收到此错误：

```
X-Powered-By: PHP/4.4.9
Content-type: text/html

<br />
<b>Parse error</b>:  syntax error, unexpected '{' in <b>/homepages/44/d******/htdocs/moodle/moodle-223/lib/setup.php</b> on line <b>658</b><br /> 
```

引起我注意的是第一行：**PHP/4.4.9**

这是否意味着PHP版本是4.4.9？因为我们的共享主机（1&1）中应该有 PHP 5.4。如果我从任何网站运行 php_info() 我会得到 PHP 版本 5.4.4 ...

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T00:52:34.760

好的，所以我必须做的是在调用脚本时强制**使用 php6 ，例如：**

```
/usr/bin/php6 /kunden/homepages/44/d******/htdocs/moodle/moodle-223/admin/cli/cron.php 
```

在 crontab 中，我放置了与命令完全相同的行，它似乎可以工作。

# ssrs-2008 - SSRS - ReportingService2005.FireEvent - 生成事件权限，它在哪里？

> ID：11253952
> 
> 赞同：1
> 
> 时间：2012-06-28T22:45:28.110
> 
> 标签：ssrs-2008, reportingservices-2005, sqlclr

我目前正在报表服务器上编写一个 CLR 存储过程来触发我的订阅事件。我无法使用 FireEvent，因为会引发错误，说明用户“NT AUTHORITY\SYSTEM”没有权限。我知道我正在寻找的权限是生成事件，但我一生都找不到它。

这是我的错误和 CLR 存储过程，任何帮助将不胜感激。

存储过程位于报表服务器上。报表服务器使用 Windows 身份验证。我对 SQL Server 2008 R2 (SP1) 拥有完全的管理员权限。

```
public partial class StoredProcedures
{
    [Microsoft.SqlServer.Server.SqlProcedure]
    public static void CTest()
    {
        ReportingService2005 rs = new ReportingService2005();
        rs.Credentials = System.Net.CredentialCache.DefaultCredentials;
        rs.Url = "http://erer332/ReportServer/ReportService2005.asmx";
        Subscription[] lSubs;
        try
        {
            lSubs = rs.ListSubscriptions("/WFM Graphical Reports/Sales Order Formats by Company", null);
            rs.FireEvent("TimedSubscription", lSubs[0].SubscriptionID);
        }
        catch (SoapException e)
        {
            SqlContext.Pipe.Send(e.Detail.InnerXml);
        }
    }
};

<ErrorCode xmlns="http://www.microsoft.com/sql/reportingservices">
    rsAccessDenied
</ErrorCode>
<HttpStatus xmlns="http://www.microsoft.com/sql/reportingservices">
    400
</HttpStatus>
<Message xmlns="http://www.microsoft.com/sql/reportingservices">
    The permissions granted to user 'NT AUTHORITY\SYSTEM' are insufficient for performing this operation.
</Message>
<HelpLink xmlns="http://www.microsoft.com/sql/reportingservices">
    http://go.microsoft.com/fwlink/?LinkId=20476&amp;EvtSrc=Microsoft.ReportingServices.Diagnostics.Utilities.ErrorStrings&amp;EvtID=rsAccessDenied&amp;ProdName=Microsoft%20SQL%20Server%20Reporting%20Services&amp;ProdVer=10.50.2500.0
</HelpLink>
<ProductName xmlns="http://www.microsoft.com/sql/reportingservices">
    Microsoft SQL Server Reporting Services
</ProductName>
<ProductVersion xmlns="http://www.microsoft.com/sql/reportingservices">
    10.50.2500.0
</ProductVersion>
<ProductLocaleId xmlns="http://www.microsoft.com/sql/reportingservices">
   127
</ProductLocaleId>
<OperatingSystem xmlns="http://www.microsoft.com/sql/reportingservices">
    OsIndependent
</OperatingSystem>
<CountryLocaleId xmlns="http://www.microsoft.com/sql/reportingservices">
    1033
</CountryLocaleId>
<MoreInformation xmlns="http://www.microsoft.com/sql/reportingservices">
    <Source>
        ReportingServicesLibrary
    </Source>
    <Message msrs:ErrorCode="rsAccessDenied" msrs:HelpLink="http://go.microsoft.com/fwlink/?LinkId=20476&amp;EvtSrc=Microsoft.ReportingServices.Diagnostics.Utilities.ErrorStrings&amp;EvtID=rsAccessDenied&amp;ProdName=Microsoft%20SQL%20Server%20Reporting%20Services&amp;ProdVer=10.50.2500.0" xmlns:msrs="http://www.microsoft.com/sql/reportingservices">
        The permissions granted to user 'NT AUTHORITY\SYSTEM' are insufficient for performing this operation.
    </Message>
</MoreInformation>
<Warnings xmlns="http://www.microsoft.com/sql/reportingservices" />` 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T17:09:04.163

好吧想通了。必须远程进入 Reporting Services 服务器并从那里使用 SSMS 进行连接。然后我可以从那里授予必要的权限。从我在 SSMS 上的计算机上，我一直在 Report Server 中四处寻找权限，但看不到 Reporting Services。

令人困惑！

# php - 向 Twilio 客户端添加应答按钮

> ID：11253954
> 
> 赞同：4
> 
> 时间：2012-06-28T22:45:39.987
> 
> 标签：php, twilio

这可能听起来像一个愚蠢的问题，但我正在浏览客户端快速入门教程，我想知道如何要求在客户端单击按钮来回答。例如：hello-client-monkey-3.php 它只是在响铃后拿起，我想在页面上添加一个拿起按钮？我怎样才能做到这一点？

我已经尝试了以下代码，但它似乎不起作用：

```
function answer() {
    Twilio.Device.accept();
}

<button onclick="answer();">
    Answer
</button> 
```

任何帮助是极大的赞赏

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-07-14T21:57:46.850

我也无法理解这一点。Twilio 的可爱的人给了我这个答案：

我已经看到了几种方法。一种方法是将传入连接存储在临时变量中，例如`incoming_conn`

```
 var incoming_conn = null;

  Twilio.Device.incoming(function(connection) {
    incoming_conn = connection;
  });

  function accept() {
    if (incoming_conn) {
      incoming_conn.accept();
      accepted_conn = incoming_conn;
      incoming_conn = null;
    }
  } 
```

（我）然后您将需要从您的 UI 中调用该函数：

```
 <button onclick="accept();">
      Answer
  </button> 
```

另一种方法是将点击处理程序附加到接受按钮，如果您使用 jQuery，这会更容易，例如

```
 Twilio.Device.incoming(function(connection) {
    $("#answer").click(function() {
        connnect.accept();
    }); 
```

假设您的按钮具有“答案”类：

```
<button id="answer">
    Answer
</button> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T13:21:19.310

可以接受呼叫的不是“设备”，而是连接。从[文档](http://www.twilio.com/docs/client/device#incoming)：

```
Twilio.Device.incoming(function(connection) {
  connection.accept();
  // do awesome ui stuff here
  // $('#call-status').text("you're on a call!");
}); 
```

所以你的回答按钮必须知道`connection`not the `Device`。最好在`Twilio.Device`有新的传入连接时创建答案按钮，然后`onclick`接受该**特定**连接。

# python - 如何检查python方法的源代码？

> ID：11253955
> 
> 赞同：8
> 
> 时间：2012-06-28T22:45:40.293
> 
> 标签：python, methods

简而言之，假设我有一个字符串`'next'`，

```
next = "123rpq" 
```

我可以将一种`str`方法`.isdigit()`应用于`'next'`. 所以我的问题是如何检查这个方法的实现。因此，是否有类似`inspect.getsource(somefunction)`获取“方法”的源代码的事情？

更新：请参阅下面关于变量名称的评论`'next'`。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-28T22:54:47.067

对于模块、类、函数和一些其他对象，您可以使用`inspect.getfile`或`inspect.getsourcefile`. 但是，对于内置对象和方法，这将导致`TypeError`. 正如 C0deH4cker 所提到的，内置对象和方法是用 C 实现的，因此您必须浏览 C 源代码。`isdigit`是内置字符串对象的一个​​方法，在Python源码目录下的文件[`stringobject.c`](http://hg.python.org/cpython/file/c6880edaf6f3/Objects/stringobject.c)中实现。`Objects`这个`isdigits`方法是从这个文件的第 3392 行实现的。另请参阅我[在此处](https://stackoverflow.com/a/8608609/623518)对类似但更一般的问题的回答。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-28T22:54:30.540

`isdigit()`您正在谈论的方法是内置数据类型的内置方法。意思是，此方法的源代码是用 C 编写的，而不是 Python。如果你真的想看它的源代码，那么我建议你去[http://python.org](http://python.org)下载 Python 的源代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T22:49:15.540

您可以尝试打印`method.__doc__`有关该特定方法的文档。如果你只是好奇，你可以检查你的 PYTHONPATH 看看你的模块是从哪里导入的，看看你是否从那个模块中找到了 .py 文件

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-06-24T12:18:55.610

我检查了cpython源代码，isdigit已经是ac stdlib函数。这令人满意地解释了它 [https://www.quora.com/How-does-isdigit-in-Python-work](https://www.quora.com/How-does-isdigit-in-Python-work) 你可以做的是下载 python 源代码和 c stdlib 头文件并编写脚本（bash 或 py）到搜索功能（无论它是什么类型）和 isdigit（无论您搜索什么）在同一行或附近。

顺便说一句，我想知道如果我们部分编译并将代码与 aasembly 相关联会发生什么。人工智能是否能够通过比较马尔可夫链中的程序集来缩短或扩展我们的代码。人工智能辅助编码可能吗？

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-01-22T15:53:25.073

虽然我通常同意这`inspect`是一个很好的答案，但当您的类（以及类方法）在解释器中定义时，它就会变得平淡无奇。

如果您使用`dill.source.getsource`from [`dill`](https://github.com/uqfoundation/dill)，您可以获得函数和 lambda 的来源，即使它们是交互式定义的。它还可以从 curries 中定义的绑定或未绑定的类方法和函数中获取代码……但是，如果没有封闭对象的代码，您可能无法编译该代码。

```
>>> from dill.source import getsource
>>> 
>>> def add(x,y):
...   return x+y
... 
>>> squared = lambda x:x**2
>>> 
>>> print getsource(add)
def add(x,y):
  return x+y

>>> print getsource(squared)
squared = lambda x:x**2

>>> 
>>> class Foo(object):
...   def bar(self, x):
...     return x*x+x
... 
>>> f = Foo()
>>> 
>>> print getsource(f.bar)
def bar(self, x):
    return x*x+x

>>> 
```

对于`builtin`函数或方法，`dill.source`将不起作用……但是……

您可能仍然不必求助于使用您最喜欢的编辑器来打开其中包含源代码的文件（如其他答案中所建议的那样）。有一个名为的新包[`cinspect`](https://github.com/punchagan/cinspect)声称能够查看`builtins`.

# windows - Windows BAT - IF 语句在 FOR 循环中失败

> ID：11253958
> 
> 赞同：0
> 
> 时间：2012-06-28T22:45:54.233
> 
> 标签：windows, if-statement, for-loop, batch-file

所以我一直试图弄清楚这一点，但没有任何结果。我已经把它缩小到一个小案例，所以请让我知道你的想法。

我有一个文件目录（1-a.txt 和 1-b.txt）和一个批处理文件，如下所示：

```
for %%X in (1) do ^
fc %%X-a.txt %%X-b.txt > tmp.txt &^
if errorlevel 0 (echo 5) else (echo 6) &^
echo 7 
```

基本上，如果文件相同，我希望它回显 5，如果文件不同，我希望它回显 6、7。但是，它总是回显 5。回显 7 被完全忽略。

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T22:47:51.983

`if errorlevel`当错误级别*至少*为 0 时为真。它始终是*大于或等于*比较：

```
C:\>help if
Performs conditional processing in batch programs.

...

  ERRORLEVEL number Specifies a true condition if the last program run
                    returned an exit code equal to or greater than the number
                    specified. 
```

通常你可以切换分支：

```
if errorlevel 1 (echo 6) else (echo 5) 
```

在您的情况下，我还建议您使用括号对语句进行分组：

```
for %%X in (1) do (
  fc %%X-a.txt %%X-b.txt > tmp.txt
  if errorlevel 1 (echo 6) else (echo 5)
  echo 7
) 
```

作为程序调用后显式的另一种选择，`if`还有一些运算符根据前一个命令的结果运行另一个命令：

```
fc %%X-a.txt %%X-b.txt > tmp.txt && echo 5 || echo 6 
```

# html - 使用 XPath/Hpple/Objective-C 获取 href 值

> ID：11253963
> 
> 赞同：1
> 
> 时间：2012-06-28T22:46:41.830
> 
> 标签：html, xpath, href, hpple

我尝试了一切对我有意义（和没有意义）的东西。我有以下 html 代码，我尝试在 Objective-C 中使用 XPath 进行解析：

```
<tr style="background-color: #eaeaea">
   <td class="content">
      <a href="index.php?cmd=search&id=foo">bar</a>
   </td>
</tr> 
```

我得到了`"bar"`via `//tr/td[@class='content']/a/text()`。

但我不知道如何获得`index.php?cmd=search&id=foo`.

这真的让我绝望:-(

非常感谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T08:47:08.403

在尝试了整个晚上（再次）之后，我发现了如何解决我的问题：

```
//Put the elements in an array
NSArray *someArray = [xpathParser searchWithXPathQuery:@"//tr/td[@class='content']/a"];

//Just one possibility to make a for-loop
for (TFHppleElement *element in someArray) {
    //This is the important line:
    NSString *myURL = [[element attributes] objectForKey:@"href"];
    //Do whatever you want with myURL
} 
```

我希望这对那里的一些人有所帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T22:55:06.903

要通过 XPATH 获取 href 部分，您需要`@`在属性名称前使用符号。

```
//tr/td[@class='content']/a/@href 
```

## 更新：

看来，你指的是iphone。

尝试这样的事情来获取属性值

```
NSArray *link = [xmlData valueForKey:@"href"]; 
```

# php - 无法在 MySQL 中正确编码

> ID：11253970
> 
> 赞同：2
> 
> 时间：2012-06-28T22:46:58.650
> 
> 标签：php, mysql, character-encoding

我一直在努力解决 MySQL 中的编码问题。我正在构建一个数据库，其中不仅包含拉丁文，还包含西里尔文和阿拉伯文文本。所以这里是一个关于我如何创建数据库的例子：

```
CREATE DATABASE db1
DEFAULT CHARACTER SET utf8   
COLLATE utf8_unicode_ci; 
```

然后是一张表：

```
CREATE TABLE TempTb1
(
ID INT PRIMARY KEY,
name VARCHAR(100) NOT NULL,
arabic VARCHAR(100) NOT NULL
)
DEFAULT CHARACTER SET utf8   
COLLATE utf8_unicode_ci; 
```

当我输入一些数据并选择它时，我只会得到一些奇怪的字符。所以我写了一个小的 PHP 脚本来测试它，但它也不起作用：

```
<?php
header('Content-type: text/plain; charset=utf-8');

$a = mysql_connect('localhost','root','') or die('Problem connecting to database!');
$b = mysql_select_db('db1') or die('Problem selecting database');
mysql_set_charset('utf8');
mysql_query("set names 'utf8'");
mysql_query('set character set utf8');

$query = mysql_query("SELECT * FROM Tb1;");

while($row = mysql_fetch_assoc($query))
    {   
        $id = $row['ID'];
        $name = $row['name'];
        $arabic = $row['arabic'];

        echo $id.' '.$name.' '.$arabic.PHP_EOL;
    }
?> 
```

我已经用`utf8_unicode_ci`和进行了测试`utf8_general_ci`。有什么问题？顺便说一句，我有 EasyPHP 5.2.10。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T22:58:29.830

无论你的角色发生了什么，我猜都是在他们到达 MySQL 之前发生的。当我们输入字符时，计算机会将字符转换为数字。然后这些数字从这里到那里，在 Web 表单和服务器、Web 服务器和脚本解释器之间传播，然后是数据库服务器，然后以相同的方式返回到网页。

您在哪里以及如何输入数据？数据应该以它输入的方式退出。如果您的数据是通过网络表单提供的，请检查您的网页编码以及提交表单的方式。如何在 PHP 脚本中获取它们以及如何将它们发送到数据库服务器。这里有罪的部分可能不是 MySQL，而是另一个地方。也可以是 MySQL；但它不是唯一可能出现不当行为的地方，而且可能不是。

检查您的页面，在它们到达您的浏览器时检查标题。

关于您收到的问题的评论，不，使用 ISO5 不好，因为您需要多个 ISO5 系列。在大多数情况下，您必须使用 Unicode 编码，最好是 utf-8。此外，这与您使用哪个 MySQL 库无关，除非该库有一些已知的错误，这些错误对于那么旧的东西来说是不太可能的。:) 您仍然应该使用推荐的最佳实践；但是您当前的问题与您使用的库无关。邪恶在于您输入数据的方式与查看数据的方式之间的差异。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T23:07:58.913

确保您在页面标题中有此元数据

```
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" > 
```

您也可以尝试在连接到 db 后立即执行此查询：

```
"SET NAMES 'utf8'" 
```

希望这可以帮助。干杯

# ios - 带有 renderInContext 的 iPad 3 设备崩溃

> ID：11253972
> 
> 赞同：2
> 
> 时间：2012-06-28T22:47:03.823
> 
> 标签：ios, xcode, ipad, uiview, crash

我一直在我的应用程序中使用以下代码将自定义 UIView 呈现为图像。该代码在模拟器（iPad 和 iPad Retina）以及 iPad 1 和 iPad 2 设备上运行良好。但是，我最近在 iPad 3 设备上对其进行了测试，并且遇到了我似乎无法解决的崩溃问题。相关的代码片段是：

```
UIGraphicsBeginImageContext(CGSizeMake(myUIView.frame.size.width, myUIView.frame.size.height));
CGContextRef context = UIGraphicsGetCurrentContext();
CGContextSaveGState(context);
[myUIView.layer renderInContext:context]; 
```

应用程序在最后一行崩溃。以下是崩溃日志中的内容：

```
Exception Type:  EXC_BAD_ACCESS (SIGSEGV)
Exception Codes: KERN_INVALID_ADDRESS at 0x12311000
Crashed Thread:  5 
```

从后面的日志中：

```
Thread 5 name:  Dispatch queue: com.apple.root.default-overcommit-priority
Thread 5 Crashed:
0   ImageIO                         0x3384bcb4 ImageIO_ABGR_TO_ARGB_8Bit + 68
1   ImageIO                         0x3388761c __copyImageBlockSetPNG_block_invoke_1 +  608
2   libdispatch.dylib               0x348c0c52 _dispatch_call_block_and_release + 6
3   libdispatch.dylib               0x348c3810 _dispatch_worker_thread2 + 252
4   libsystem_c.dylib               0x33145df4 _pthread_wqthread + 288
5   libsystem_c.dylib               0x33145cc8 start_wqthread + 0 
```

我首先认为这是一个内存管理错误，但它只出现在 iPad 3 设备上，而且我使用的是 ARC。这让我很难过。

关于我可能会在哪里进一步解决此问题的任何建议？有没有其他人遇到过这种行为？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T22:55:13.960

尝试

```
UIGraphicsBeginImageContextWithOptions(CGSizeMake(myUIView.frame.size.width, myUIView.frame.size.height), NO, [[UIScreen mainScreen] scale]); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-03T04:20:23.417

终于能够在我试图渲染的视图中追踪到特定 UIImageView 的崩溃源。此视图使用 iPad 3 Retina 的 2x 图形。虽然它显示得很好，但显然证明它在 renderInContext 调用期间消耗了太多内存。我减小了图形的大小，还减小了上下文选项中的渲染比例。这解决了崩溃。

# objective-c - 在 Objective-C 中解压缩 wav 文件（Windows IMA ADPCM 压缩）？

> ID：11253975
> 
> 赞同：-10
> 
> 时间：2012-06-28T22:47:35.960
> 
> 标签：objective-c, macos

我有一些`wav`文件可能是在 Windows 系统上创建的，需要在 Objective-C 应用程序中解压缩（最好是“即时”）。压缩码是17——IMA ADPCM。我找到[了一些 source](http://www.drdobbs.com/database/algorithm-alley/184410326)，但如果可以访问，我更愿意使用内置的东西，特别是因为该算法显然有几种不同的变体。

有没有人知道可以用来解压的 API 或类似的东西？

**更新：**尝试使用扩展音频文件服务，但我无法通过设置“ClientDataFormat”。看到[这个帖子](https://stackoverflow.com/q/11268962/581994)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T01:16:34.200

内置[`AVFoundation`](http://developer.apple.com/library/ios/#DOCUMENTATION/AVFoundation/Reference/AVFoundationFramework/_index.html)框架将播放 .wav 文件。

# javascript - successCallback 不是函数

> ID：11253988
> 
> 赞同：-2
> 
> 时间：2012-06-28T22:48:52.250
> 
> 标签：javascript, binary

有人能告诉我为什么我要进入`successCallback is not a function`我的 js 吗？

这是调用它的代码：

```
function fillData(data){
        this.raw = data;
    }

function AnimatedModel(posx, posy, posz,sx,sy,sz,r,g,b,a, name, yd){
        this.x = posx;
        this.y = posy;
        this.z = posz;
        this.scale = new Array(sx,sy,sz);
        parseBinFile(this, name)
        this.r = r;
        this.g = g;
        this.b = b;
        this.a = a;
        this.yawDeg = yd;
        this.fillData = fillData;
    }

    var zombie = new AnimatedModel(0,0, 0, 0.2,0.2,0.2, 0.0,1.0,0.6,0.2, "zom3.ms3d", 0);

function parseBinFile(model, name){
        getServerFileToArrayBufffer(name, model.fillData)
        console.log(model.raw);

    }

    function getServerFileToArrayBufffer(url, successCallback){
            // Create an XHR object
            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function () {
            if (xhr.readyState == xhr.DONE) {
                if (xhr.status == 200 && xhr.response) {
                        // The 'response' property returns an ArrayBuffer
                        successCallback(xhr.response);
                    } else {
                        alert("Failed to download:" + xhr.status + " " + xhr.statusText);
                    }
                }
            }

            // Open the request for the provided url
            xhr.open("GET", url, true);
            // Set the responseType to 'arraybuffer' for ArrayBuffer response
            xhr.responseType = "arraybuffer";
            xhr.send();
        } 
```

编辑：忘记了 fillData 函数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T23:02:35.530

您`parseBinFile()`在设置属性`AnimatedModel`之前调用构造函数，因此如果这是导致您出现问题的调用，那么您需要在调用之前完全初始化对象。`fillData``AnimatedModel``AnimatedModel``parseBinFile(this, name)`

# css - 1140px 网格对齐问题

> ID：11253994
> 
> 赞同：1
> 
> 时间：2012-06-28T22:49:45.527
> 
> 标签：css, grid

嗨，我正在建立一个画廊风格的网站，我对使用 cssgrid.net 中的 1140px 网格非常感兴趣，因为我觉得 960px 对于这个项目来说太小了。

我想在第一行有 3 张每列四列的图像，然后在下面的其余行中有 4 张每列 3 列的图像。

问题是，一旦我这样做，两行的右边缘就不会对齐，显然画廊看起来不会那么好。我知道这是由于在此网格中使用百分比构建列而导致四舍五入造成的。但是它看起来仍然很糟糕，我想让它们以某种方式对齐。解决方案是什么？

我的索引页面代码：http: [//pastebin.com/c76U7J5g](http://pastebin.com/c76U7J5g)

要看到这种情况发生，您必须下载 cssgrid.net 网格

![在此处输入图像描述](../Images/7b4da7644b88d44a5af082ab9c6340c4.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T19:32:34.380

基于百分比的布局不是像素完美的。我在我的一个项目中使用了 css 框架[http://www.1140px.com/](http://www.1140px.com/)，我很满意。如果您想要像素完美的布局，您可以尝试一下。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T16:42:43.440

如果我了解正在发生的事情，那似乎是一个简单的错误。

您的占位符图像（猫）太小。在这个网格系统中使用占位符图像可能会很棘手，因为您必须声明您希望占位符的大小。实际上，在您的实时页面上，图像不会指定尺寸，因为它会破坏网格系统（网格只会将图像缩小到适合您放入的列中的最大尺寸）。

长话短说，占位符图像太小了！在它们的全尺寸下，它们不会填满网格点，因此会导致您描述的奇怪定位。话虽如此，我总是放置至少 1000 像素的占位符，以便它们可以适当地缩小。

编辑：

尝试做基金会所做的事情：

```
.last {
float: right;
} 
```

将其添加到样式表 - 它应该对齐最后一列的右边缘。

# mysql - MySql 对连接查询的计数非常慢

> ID：11253996
> 
> 赞同：6
> 
> 时间：2012-06-28T22:50:00.390
> 
> 标签：mysql, sql, query-optimization

我对 mysql 有一个看法：

```
CREATE VIEW
    loggingquarantine_quarantine ( id, mail_id, partition_tag, content, rs, subject, sender, TIME,
    spam_level, size, sid, email ) AS
SELECT
    concat(CAST(`mr`.`mail_id` AS CHAR(255) charset utf8),CAST(`mr`.`partition_tag` AS CHAR(255)
    charset utf8))      AS `id`,
    `mr`.`mail_id`       AS `mail_id`,
    `mr`.`partition_tag` AS `partition_tag`,
    `mr`.`content`      AS `content`,
    `mr`.`rs`           AS `rs`,
    `m`.`subject`       AS `subject`,
    `m`.`from_addr`     AS `sender`,
    `m`.`time_num`      AS `TIME`,
    `m`.`spam_level`    AS `spam_level`,
    `m`.`size`          AS `size`,
    `m`.`sid`           AS `sid`,
    `maddr`.`email`          AS `email`
FROM
    (((`msgrcpt` `mr` JOIN `msgs` `m`
ON
    (
                `m`.`partition_tag` = `mr`.`partition_tag`
        AND
                `m`.`mail_id` = `mr`.`mail_id`
    )
)
JOIN `maddr` maddr
ON
    (
        `mr`.`rid` = `maddr`.`id`
    )
)) 
```

当我尝试计算这个视图时，大约需要 13 分钟才能记录 250 万条记录。那慢得令人难以置信。所有字段都有索引。如果我确实计算每张桌子，它不会超过 20 秒。这是mysql解释显示的内容：

```
mysql> explain SELECT COUNT(*) FROM `loggingquarantine_quarantine`;
+----+-------------+-------+--------+-----------------------------------------------------------------------+-------------------------+---------+-----------------------------------------------------------+---------+-------------+
| id | select_type | table | type   | possible_keys                                                         | key                     | key_len | ref                                                       | rows    | Extra       |
+----+-------------+-------+--------+-----------------------------------------------------------------------+-------------------------+---------+-----------------------------------------------------------+---------+-------------+
|  1 | SIMPLE      | maddr | index  | PRIMARY                                                               | maddr_partition_tag_idx | 5       | NULL                                                      | 1016497 | Using index |
|  1 | SIMPLE      | mr    | ref    | PRIMARY,msgrcpt_idx_rid,msgrcpt_mail_id_idx,msgrcpt_partition_tag_idx | msgrcpt_idx_rid         | 8       | mroute_logquar.maddr.id                                   |       2 | Using index |
|  1 | SIMPLE      | m     | eq_ref | PRIMARY,msgs_mail_id_idx,msgs_partition_tag_idx                       | PRIMARY                 | 22      | mroute_logquar.mr.partition_tag,mroute_logquar.mr.mail_id |       1 | Using index |
+----+-------------+-------+--------+-----------------------------------------------------------------------+-------------------------+---------+-----------------------------------------------------------+---------+-------------+ 
```

我怎样才能优化查询/视图，这样计算就不会花费 13 分钟。当前查询有什么问题？

更新。如果我直接在 select 上进行选择计数而不查看它仍然会得到相同的 14 分钟查询。

```
mysql> select count(1) FROM     (((`msgrcpt` `mr` JOIN `msgs` `m` ON     (                  `m`.`partition_tag` = `mr`.`partition_tag`         AND                 `m`.`mail_id` = `mr`.`mail_id`      ) ) JOIN `maddr` maddr ON     (         `mr`.`rid` = `maddr`.`id`     ) ));

+----------+
| count(1) |
+----------+
|  2582227 |
+----------+
1 row in set (14 min 28.96 sec) 
```

这是我在三个单独的查询中进行计数时的结果：

```
mysql> select count(1) from msgrcpt;
+----------+
| count(1) |
+----------+
|  2587307 |
+----------+
1 row in set (46.02 sec)

mysql> select count(1) from msgs;
+----------+
| count(1) |
+----------+
|  2421710 |
+----------+
1 row in set (7.77 sec)

mysql> select count(1) from maddr;
+----------+
| count(1) |
+----------+
|   994880 |
+----------+
1 row in set (0.23 sec) 
```

更新 2。

所有表都是 InnoDB。

```
mysql> SHOW status like 'key_%';                                                                                                                                                                               +------------------------+-------+
| Variable_name          | Value |
+------------------------+-------+
| Key_blocks_not_flushed | 0     |
| Key_blocks_unused      | 26792 |
| Key_blocks_used        | 0     |
| Key_read_requests      | 0     |
| Key_reads              | 0     |
| Key_write_requests     | 0     |
| Key_writes             | 0     |
+------------------------+-------+ 
```

msgs 和 msgrcpt 表具有复合主键（对于 msgs 的 mail_id、partation_tag 和对于 msgrpt 的 ( `partition_tag`, `mail_id`, `rseqnum`)）。更新说明单表：

```
mysql> explain select count(1) from msgs;
+----+-------------+-------+-------+---------------+-------------------+---------+------+---------+-------------+
| id | select_type | table | type  | possible_keys | key               | key_len | ref  | rows    | Extra       |
+----+-------------+-------+-------+---------------+-------------------+---------+------+---------+-------------+
|  1 | SIMPLE      | msgs  | index | NULL          | msgs_idx_time_num | 4       | NULL | 2357360 | Using index |
+----+-------------+-------+-------+---------------+-------------------+---------+------+---------+-------------+
1 row in set (0.00 sec)

mysql> explain select count(1) from msgrcpt;
+----+-------------+---------+-------+---------------+----------------+---------+------+---------+-------------+
| id | select_type | table   | type  | possible_keys | key            | key_len | ref  | rows    | Extra       |
+----+-------------+---------+-------+---------------+----------------+---------+------+---------+-------------+
|  1 | SIMPLE      | msgrcpt | index | NULL          | msgrcpt_rs_idx | 3       | NULL | 2620758 | Using index |
+----+-------------+---------+-------+---------------+----------------+---------+------+---------+-------------+
1 row in set (0.00 sec)

mysql> explain select count(1) from maddr;
+----+-------------+-------+-------+---------------+-------------------------+---------+------+--------+-------------+
| id | select_type | table | type  | possible_keys | key                     | key_len | ref  | rows   | Extra       |
+----+-------------+-------+-------+---------------+-------------------------+---------+------+--------+-------------+
|  1 | SIMPLE      | maddr | index | NULL          | maddr_partition_tag_idx | 5       | NULL | 967058 | Using index |
+----+-------------+-------+-------+---------------+-------------------------+---------+------+--------+-------------+
1 row in set (0.00 sec) 
```

更新。为所有表创建表：

```
mysql> show create table msgrcpt;
| Table   | Create Table                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
| msgrcpt | CREATE TABLE `msgrcpt` (
  `partition_tag` int(11) NOT NULL DEFAULT '0',
  `mail_id` varbinary(16) NOT NULL,
  `rseqnum` int(11) NOT NULL DEFAULT '0',
  `rid` bigint(20) unsigned NOT NULL,
  `is_local` char(1) NOT NULL DEFAULT '',
  `content` char(1) NOT NULL DEFAULT '',
  `ds` char(1) NOT NULL,
  `rs` char(1) NOT NULL,
  `bl` char(1) DEFAULT '',
  `wl` char(1) DEFAULT '',
  `bspam_level` float DEFAULT NULL,
  `smtp_resp` varchar(255) DEFAULT '',
  PRIMARY KEY (`partition_tag`,`mail_id`,`rseqnum`),
  KEY `msgrcpt_idx_rid` (`rid`),
  KEY `msgrcpt_mail_id_idx` (`mail_id`),
  KEY `msgrcpt_rs_idx` (`rs`),
  KEY `msgrcpt_ds_idx` (`ds`),
  KEY `msgrcpt_partition_tag_idx` (`partition_tag`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 |

| msgs  | CREATE TABLE `msgs` (
  `partition_tag` int(11) NOT NULL DEFAULT '0',
  `mail_id` varbinary(16) NOT NULL,
  `secret_id` varbinary(16) DEFAULT '',
  `am_id` varchar(20) NOT NULL,
  `time_num` int(10) unsigned NOT NULL,
  `time_iso` char(16) NOT NULL,
  `sid` bigint(20) unsigned NOT NULL,
  `policy` varchar(255) DEFAULT '',
  `client_addr` varchar(255) DEFAULT '',
  `size` int(10) unsigned NOT NULL,
  `originating` char(1) NOT NULL DEFAULT '',
  `content` char(1) DEFAULT NULL,
  `quar_type` char(1) DEFAULT NULL,
  `quar_loc` varbinary(255) DEFAULT '',
  `dsn_sent` char(1) DEFAULT NULL,
  `spam_level` float DEFAULT NULL,
  `message_id` varchar(255) DEFAULT '',
  `from_addr` varchar(255) DEFAULT '',
  `subject` varchar(255) DEFAULT '',
  `host` varchar(255) NOT NULL,
  PRIMARY KEY (`partition_tag`,`mail_id`),
  KEY `msgs_idx_sid` (`sid`),
  KEY `msgs_idx_mess_id` (`message_id`),
  KEY `msgs_idx_time_num` (`time_num`),
  KEY `msgs_mail_id_idx` (`mail_id`),
  KEY `msgs_partition_tag_idx` (`partition_tag`),
  KEY `msgs_content_idx` (`content`),
  FULLTEXT KEY `ft_from_addr` (`from_addr`),
  FULLTEXT KEY `ft_subject` (`subject`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 |

| maddr | CREATE TABLE `maddr` (
  `partition_tag` int(11) DEFAULT '0',
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
  `email` varbinary(255) NOT NULL,
  `domain` varchar(255) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `part_email` (`partition_tag`,`email`),
  KEY `maddr_email_idx` (`email`),
  KEY `maddr_partition_tag_idx` (`partition_tag`)
) ENGINE=InnoDB AUTO_INCREMENT=3373444 DEFAULT CHARSET=utf8 | 
```

此查询与配置文件：

```
mysql> SET PROFILING=1; SELECT
Query OK, 0 rows affected (0.00 sec)

    -> count(1)
    -> FROM
    ->     (((`msgrcpt` `mr` JOIN `msgs` `m`
    -> ON
    ->     (
    ->                 `m`.`partition_tag` = `mr`.`partition_tag`
    ->         AND
    ->                 `m`.`mail_id` = `mr`.`mail_id`
    ->     )
    -> )
    -> JOIN `maddr` maddr
    -> ON
    ->     (
    ->         `mr`.`rid` = `maddr`.`id`
    ->     )
    -> )); SHOW PROFILE ALL;

+----------+
| count(1) |
+----------+
|  4279394 |
+----------+
1 row in set (23 min 56.61 sec)

+----------------------+------------+-----------+------------+-------------------+---------------------+--------------+---------------+---------------+-------------------+-------------------+-------------------+-------+-----------------------+------------------+-------------+
| Status               | Duration   | CPU_user  | CPU_system | Context_voluntary | Context_involuntary | Block_ops_in | Block_ops_out | Messages_sent | Messages_received | Page_faults_major | Page_faults_minor | Swaps | Source_function       | Source_file      | Source_line |
+----------------------+------------+-----------+------------+-------------------+---------------------+--------------+---------------+---------------+-------------------+-------------------+-------------------+-------+-----------------------+------------------+-------------+
| starting             |   0.000161 |  0.000000 |   0.000000 |                 0 |                   0 |            0 |             0 |             0 |                 0 |                 0 |                 0 |     0 | NULL                  | NULL             |        NULL |
| checking permissions |   0.000030 |  0.000000 |   0.000000 |                 0 |                   0 |            0 |             0 |             0 |                 0 |                 0 |                 1 |     0 | check_access          | sql_parse.cc     |        5043 |
| checking permissions |   0.000019 |  0.000000 |   0.000000 |                 0 |                   0 |            0 |             0 |             0 |                 0 |                 0 |                 0 |     0 | check_access          | sql_parse.cc     |        5043 |
| checking permissions |   0.000020 |  0.000000 |   0.000000 |                 0 |                   0 |            0 |             0 |             0 |                 0 |                 0 |                 0 |     0 | check_access          | sql_parse.cc     |        5043 |
| Opening tables       |   0.000039 |  0.000000 |   0.000000 |                 0 |                   0 |            0 |             0 |             0 |                 0 |                 0 |                 0 |     0 | open_tables           | sql_base.cc      |        5014 |
| System lock          |   0.000026 |  0.000000 |   0.000000 |                 0 |                   0 |            0 |             0 |             0 |                 0 |                 0 |                 0 |     0 | mysql_lock_tables     | lock.cc          |         304 |
| init                 |   0.000040 |  0.000000 |   0.000000 |                 0 |                   0 |            0 |             0 |             0 |                 0 |                 0 |                 0 |     0 | mysql_select          | sql_select.cc    |        1041 |
| optimizing           |   0.000030 |  0.000000 |   0.000000 |                 0 |                   0 |            0 |             0 |             0 |                 0 |                 0 |                 0 |     0 | optimize              | sql_optimizer.cc |         138 |
| statistics           |   0.000063 |  0.000000 |   0.000000 |                 0 |                   0 |            0 |             0 |             0 |                 0 |                 0 |                 0 |     0 | optimize              | sql_optimizer.cc |         358 |
| preparing            |   0.000032 |  0.000000 |   0.000000 |                 0 |                   0 |            0 |             0 |             0 |                 0 |                 0 |                 0 |     0 | optimize              | sql_optimizer.cc |         470 |
| executing            |   0.000021 |  0.000000 |   0.000000 |                 0 |                   0 |            0 |             0 |             0 |                 0 |                 0 |                 0 |     0 | exec                  | sql_executor.cc  |         137 |
| Sending data         | 999.999999 | 97.014251 |  10.376423 |            681167 |               25822 |      5157072 |       1951032 |             0 |                 0 |                 4 |               277 |     0 | execute               | sql_executor.cc  |         758 |
| end                  |   0.000106 |  0.000000 |   0.000000 |                 0 |                   0 |            0 |             0 |             0 |                 0 |                 0 |                 0 |     0 | mysql_select          | sql_select.cc    |        1071 |
| query end            |   0.000017 |  0.000000 |   0.000000 |                 0 |                   0 |            0 |             0 |             0 |                 0 |                 0 |                 0 |     0 | mysql_execute_command | sql_parse.cc     |        4761 |
| closing tables       |   0.000021 |  0.000000 |   0.000000 |                 0 |                   0 |            0 |             0 |             0 |                 0 |                 0 |                 0 |     0 | mysql_execute_command | sql_parse.cc     |        4809 |
| freeing items        |   0.000030 |  0.000000 |   0.000000 |                 0 |                   0 |            0 |             0 |             0 |                 0 |                 0 |                 0 |     0 | mysql_parse           | sql_parse.cc     |        5997 |
| logging slow query   |   0.000059 |  0.000000 |   0.000000 |                 0 |                   0 |            0 |             8 |             0 |                 0 |                 0 |                 0 |     0 | log_slow_statement    | sql_parse.cc     |        1720 |
| cleaning up          |   0.000019 |  0.000000 |   0.000000 |                 0 |                   0 |            0 |             0 |             0 |                 0 |                 0 |                 0 |     0 | dispatch_command      | sql_parse.cc     |        1654 |
+----------------------+------------+-----------+------------+-------------------+---------------------+--------------+---------------+---------------+-------------------+-------------------+-------------------+-------+-----------------------+------------------+-------------+
18 rows in set (0.02 sec) 
```

表上的索引：

```
mysql> show index from msgs;
+-------+------------+------------------------+--------------+---------------+-----------+-------------+----------+--------+------+------------+---------+---------------+
| Table | Non_unique | Key_name               | Seq_in_index | Column_name   | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment |
+-------+------------+------------------------+--------------+---------------+-----------+-------------+----------+--------+------+------------+---------+---------------+
| msgs  |          0 | PRIMARY                |            1 | partition_tag | A         |          16 |     NULL | NULL   |      | BTREE      |         |               |
| msgs  |          0 | PRIMARY                |            2 | mail_id       | A         |     4174440 |     NULL | NULL   |      | BTREE      |         |               |
| msgs  |          1 | msgs_idx_sid           |            1 | sid           | A         |     2087220 |     NULL | NULL   |      | BTREE      |         |               |
| msgs  |          1 | msgs_idx_mess_id       |            1 | message_id    | A         |     4174440 |     NULL | NULL   | YES  | BTREE      |         |               |
| msgs  |          1 | msgs_idx_time_num      |            1 | time_num      | A         |     1391480 |     NULL | NULL   |      | BTREE      |         |               |
| msgs  |          1 | msgs_mail_id_idx       |            1 | mail_id       | A         |     4174440 |     NULL | NULL   |      | BTREE      |         |               |
| msgs  |          1 | msgs_partition_tag_idx |            1 | partition_tag | A         |          16 |     NULL | NULL   |      | BTREE      |         |               |
| msgs  |          1 | msgs_content_idx       |            1 | content       | A         |          16 |     NULL | NULL   | YES  | BTREE      |         |               |
| msgs  |          1 | ft_from_addr           |            1 | from_addr     | NULL      |     4174440 |     NULL | NULL   | YES  | FULLTEXT   |         |               |
| msgs  |          1 | ft_subject             |            1 | subject       | NULL      |     4174440 |     NULL | NULL   | YES  | FULLTEXT   |         |               |
+-------+------------+------------------------+--------------+---------------+-----------+-------------+----------+--------+------+------------+---------+---------------+
10 rows in set (0.97 sec) 
```

MSGRCPT

```
mysql> show index from msgrcpt;
+---------+------------+---------------------------+--------------+---------------+-----------+-------------+----------+--------+------+------------+---------+---------------+
| Table   | Non_unique | Key_name                  | Seq_in_index | Column_name   | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment |
+---------+------------+---------------------------+--------------+---------------+-----------+-------------+----------+--------+------+------------+---------+---------------+
| msgrcpt |          0 | PRIMARY                   |            1 | partition_tag | A         |          29 |     NULL | NULL   |      | BTREE      |         |               |
| msgrcpt |          0 | PRIMARY                   |            2 | mail_id       | A         |     5218535 |     NULL | NULL   |      | BTREE      |         |               |
| msgrcpt |          0 | PRIMARY                   |            3 | rseqnum       | A         |     5218535 |     NULL | NULL   |      | BTREE      |         |               |
| msgrcpt |          1 | msgrcpt_idx_rid           |            1 | rid           | A         |      347902 |     NULL | NULL   |      | BTREE      |         |               |
| msgrcpt |          1 | msgrcpt_mail_id_idx       |            1 | mail_id       | A         |     5218535 |     NULL | NULL   |      | BTREE      |         |               |
| msgrcpt |          1 | msgrcpt_rs_idx            |            1 | rs            | A         |          29 |     NULL | NULL   |      | BTREE      |         |               |
| msgrcpt |          1 | msgrcpt_ds_idx            |            1 | ds            | A         |          29 |     NULL | NULL   |      | BTREE      |         |               |
| msgrcpt |          1 | msgrcpt_partition_tag_idx |            1 | partition_tag | A         |          29 |     NULL | NULL   |      | BTREE      |         |               |
+---------+------------+---------------------------+--------------+---------------+-----------+-------------+----------+--------+------+------------+---------+---------------+
8 rows in set (0.70 sec) 
```

MADDR：

```
mysql> show index from maddr;
+-------+------------+-------------------------+--------------+---------------+-----------+-------------+----------+--------+------+------------+---------+---------------+
| Table | Non_unique | Key_name                | Seq_in_index | Column_name   | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment |
+-------+------------+-------------------------+--------------+---------------+-----------+-------------+----------+--------+------+------------+---------+---------------+
| maddr |          0 | PRIMARY                 |            1 | id            | A         |     1653970 |     NULL | NULL   |      | BTREE      |         |               |
| maddr |          0 | part_email              |            1 | partition_tag | A         |          19 |     NULL | NULL   | YES  | BTREE      |         |               |
| maddr |          0 | part_email              |            2 | email         | A         |     1653970 |     NULL | NULL   |      | BTREE      |         |               |
| maddr |          1 | maddr_email_idx         |            1 | email         | A         |     1653970 |     NULL | NULL   |      | BTREE      |         |               |
| maddr |          1 | maddr_partition_tag_idx |            1 | partition_tag | A         |          19 |     NULL | NULL   | YES  | BTREE      |         |               |
+-------+------------+-------------------------+--------------+---------------+-----------+-------------+----------+--------+------+------------+---------+---------------+
5 rows in set (0.41 sec) 
```

Inno 数据库缓冲区大小

```
mysql> SHOW VARIABLES LIKE 'innodb_buffer_pool_size';
+-------------------------+------------+
| Variable_name           | Value      |
+-------------------------+------------+
| innodb_buffer_pool_size | 2147483648 |
+-------------------------+------------+
1 row in set (0.02 sec) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T18:28:58.500

您是否尝试过使用一些 STRAIGHT_JOIN 而不仅仅是普通的 JOIN 来改变 JOIN 中使用的表的顺序？有时查询优化器不会为特定查询选择理想的顺序。换句话说，你看到了什么样的表现？

```
SELECT
  concat(CAST(`mr`.`mail_id` AS CHAR(255) charset utf8),CAST(`mr`.`partition_tag` AS CHAR(255) charset utf8)) AS `id`,
  `mr`.`mail_id`       AS `mail_id`,
  `mr`.`partition_tag` AS `partition_tag`,
  `mr`.`content`      AS `content`,
  `mr`.`rs`           AS `rs`,
  `m`.`subject`       AS `subject`,
  `m`.`from_addr`     AS `sender`,
  `m`.`time_num`      AS `TIME`,
  `m`.`spam_level`    AS `spam_level`,
  `m`.`size`          AS `size`,
  `m`.`sid`           AS `sid`,
  `maddr`.`email`          AS `email`
FROM
  `msgrcpt` `mr`
    STRAIGHT_JOIN `msgs` `m`
      ON
        `m`.`partition_tag` = `mr`.`partition_tag` AND
        `m`.`mail_id` = `mr`.`mail_id`
    STRAIGHT_JOIN `maddr` maddr
      ON
        `mr`.`rid` = `maddr`.`id` 
```

或者，由于您在 msgrcpt 表上使用了一些重型转换和强制转换，如果您强制它在查询中最后加入会发生什么，像这样？

```
SELECT
  concat(CAST(`mr`.`mail_id` AS CHAR(255) charset utf8),CAST(`mr`.`partition_tag` AS CHAR(255) charset utf8)) AS `id`,
  `mr`.`mail_id`       AS `mail_id`,
  `mr`.`partition_tag` AS `partition_tag`,
  `mr`.`content`      AS `content`,
  `mr`.`rs`           AS `rs`,
  `m`.`subject`       AS `subject`,
  `m`.`from_addr`     AS `sender`,
  `m`.`time_num`      AS `TIME`,
  `m`.`spam_level`    AS `spam_level`,
  `m`.`size`          AS `size`,
  `m`.`sid`           AS `sid`,
  `maddr`.`email`          AS `email`
FROM
  `maddr` `maddr`
    STRAIGHT_JOIN `msgrcpt` `mr`
      ON
        `maddr`.`id` = `mr.`rid`
    STRAIGHT_JOIN `msgs` `m`
      ON
        `m`.`partition_tag` = `mr`.`partition_tag` AND
        `m`.`mail_id` = `mr`.`mail_id` 
```

如果需要，您可以更多地使用订单，可能有一个“魔术订单”会导致您的查询压缩。例如，另一个变体可能是：

```
FROM
  `msgs` `m`
    STRAIGHT_JOIN `msgrcpt` `mr`
      ON
        `m`.`partition_tag` = `mr`.`partition_tag` AND
        `m`.`mail_id` = `mr`.`mail_id`
    STRAIGHT_JOIN `maddr`
      ON
        `maddr`.`id` = `mr`.`rid` 
```

...等等。

此外，在您的 SELECT 列中，所有这些转换势必会降低您的性能，因为无论您选择多少行，它都必须这样做，这可能很多。您是否考虑过只在已计算的 msgrcpt 表中添加一列，以便不必在查询中执行此操作？如果您不想在代码中考虑额外的列，您可以向数据库添加一个触发器以使用计算值有效地自动更新它。通常，使用这种优化有点矫枉过正，但是当对数百万行执行 SELECT 查询时，它可能就可以解决问题。

**编辑：** 这是我建议以更改您的 msgrcpt 表。由于它正在运行触发器来计算新列值，因此它会使插入行的速度变慢一点，但我认为它会在加快您尝试运行的查询方面得到回报。标准免责声明适用**——如果没有先在测试副本上彻底测试，请勿在生产数据库上运行它！**

```
-- The UPDATE command will probably take some time to run since it's updating
-- millions of rows. Be patient!
ALTER TABLE `msgrcpt` ADD COLUMN `friendly_id` TEXT NULL AFTER `rs`;
UPDATE `msgrcpt` SET
  `friendly_id` = CONCAT(CAST(`mail_id` AS CHAR(255) CHARSET utf8),
    CAST(`partition_tag` AS CHAR(255) CHARSET utf8));
DELIMITER $$
CREATE TRIGGER `trig_calc_id` BEFORE INSERT ON `msgrcpt`
  FOR EACH ROW BEGIN
    SET NEW.`friendly_id` =
      CONCAT(CAST(NEW.`mail_id` AS CHAR(255) CHARSET utf8),
        CAST(NEW.`partition_tag` AS CHAR(255) CHARSET utf8));
  END $$
CREATE TRIGGER `trig_update_id` BEFORE UPDATE ON `msgrcpt`
  FOR EACH ROW BEGIN
    SET NEW.`friendly_id` =
      CONCAT(CAST(NEW.`mail_id` AS CHAR(255) CHARSET utf8),
        CAST(NEW.`partition_tag` AS CHAR(255) CHARSET utf8));
  END $$
DELIMITER ; 
```

现在，不要选择那些乱七八糟的 CONCATed CASTed 东西，只需选择 mr.friendly_id （或您选择命名该列的任何名称）。你的表现应该会好很多。

希望这会有所帮助，让我知道它是怎么回事！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T18:58:49.033

打扰一下：我看到您的 maddr 表有一个 partition_tag id，但在构成 VIEW 的最后一个 JOIN 中没有使用该分区标签。这是应该的吗？

无论如何，在我看来，您的查询可能会受益于 maddr 上包含 id 和电子邮件的索引。这应该允许直接从索引中提取具有较少 I/O 的电子邮件（评估各种索引的性能可能会有所帮助 - 在我看来，例如单独使用电子邮件字段的索引很少使用，但它取决于您知道而我不知道的工作流程，所以我很可能会弄错。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T06:51:33.707

好的 :)，所以一方面你说 - 我们有 250 万个条目，另一方面（根据你的说法）计数返回 4279394（略高:)）。可能的原因（对不起，几乎是凌晨 3 点 :)）是 - 您没有指定 msgrcpt 的完整主键（缺少 rseqnum），因此如果优化器选择 maddr 或 msgs 作为主表 - 您最终可能会得到相同的结果msgrcpt 的条目。同样基于 msgrcpt 和 msgs 的计数时间差异，我强烈建议对 msgrcpt 进行碎片整理。我相信在对直接连接进行碎片整理和使用（已经推荐）之后，您的问题将消失（如果没有 - 也许您可以找到一种即时计算的方法 - 无论您需要为 rseqnum / spam_level 计算什么，或者，

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-03T14:05:26.937

我同意 King Skippus 关于两个元素的观点……STRAIGHT_JOIN 帮助推翻优化器执行计划……以及为您保留预聚合的触发器。但是，如果你想应用 WHERE 子句来限制，你就会被击中。

此外，如果您只关心一个 COUNT，那么最好使用 vyegorov 注释来丢弃所有列。通过让所有其他列强制从所有实际数据页中提取数据。

我会将我的查询呈现为

```
SELECT STRAIGHT_JOIN COUNT(*)
   FROM
      msgrcpt mr
         JOIN msgs m
            ON mr.mail_id = m.mail_id
           AND mr.partition_tag = m.partition_tag
         JOIN maddr
            ON mr.rid = maddr.id 
```

我知道你提到了索引，但我会通过 (mail_id, partition_tag) Msgs 表索引通过相同的 (mail_id, partition_tag) MAddr 索引 (id) 获得 MsgRcpt 表索引

现在，为什么在索引上有一种方式与另一种方式？我会尝试根据第一个索引字段中的最小聚合来做。不确切知道您的卷基础是什么（邮件 id、分区标签），但可以对客户订单系统进行抽样。您可能在一天内有 10,000 人订购某样东西，但对于给定的人来说，在给定的一天可能会有一两个订单。首先找到那个人和那个单独的日期而不是一天然后找到一个人会更容易。这可能会对尝试首先通过 LARGE 列表，然后是 small 与 small/small 的查询性能产生影响。

通过只做一个 COUNT(*)，你就得到了一个计数。不需要原始表中的其他列，并且加载每个页面，因为它只需要索引组件来限定结果中的记录。

如果您确实想要所有数据，那么我将执行上述相同的索引注意事项，但将查询设置为...

```
CREATE VIEW
    loggingquarantine_quarantine ( id, mail_id, partition_tag, content, rs, subject, sender, TIME,
    spam_level, size, sid, email ) AS

SELECT STRAIGHT_JOIN
      concat(CAST(mr.mail_id AS CHAR(255) charset utf8), 
             CAST(mr.partition_tag AS CHAR(255) charset utf8)) AS `id`,
      mr.mail_id,
      mr.partition_tag,
      mr.content,
      mr.rs,
      m.subject,
      m.from_addr AS sender,
      m.time_num AS `TIME`,
      m.spam_level,
      m.size,
      m.sid,
      maddr.email
   FROM
      msgrcpt mr
         JOIN msgs m
            ON mr.mail_id = m.mail_id
           AND mr.partition_tag = m.partition_tag
         JOIN maddr
            ON mr.rid = maddr.id 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-04T06:42:15.057

视图查询本身以及代码中视图的使用可能会影响性能。有关更多信息，请阅读文章 - [MySQL VIEW 作为性能麻烦制造者](http://www.mysqlperformanceblog.com/2007/08/12/mysql-view-as-performance-troublemaker)。

解决方法：

*   执行简单查询，不使用视图。
*   如果您不想在另一个 SELECT 语句中将此视图用作数据集，那么您可以尝试创建存储过程而不是视图。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-08T07:50:07.523

加入需要 BIG mysql 负载。以我的经验，创建临时表并从中选择数据，提高数据库查询速度。

这是我的代码，代码 2 显示 100 倍的速度。您可以更改查询代码，如代码 2 样式。对于大型复杂的数据库查询，使用临时表提高数据库查询速度。

1.  制作临时表使查询变得简单并减少 mysql 数据库负载。
2.  从临时表中选择数据也需要较少的数据库负载。

代码 1

```
 $sql = " select distinct wr_parent from $write_table where $sql_search ";
    $result = sql_query($sql);
    $total_count = mysql_num_rows($result); 
```

代码 2

```
 $sql = " select wr_parent from $write_table where $sql_search ";
    $sql_tmp = " create TEMPORARY table list_tmp_count as $sql ";
    $sql_ord = " select distinct wr_parent from list_tmp_count ";

    @mysql_query($sql_tmp) or die("<p>$sql_tmp<p>" . mysql_errno() . " : " .  mysql_error() . "<p>error file : $_SERVER[PHP_SELF]");
    $result = @mysql_query($sql_ord) or die("<p>$sql_ord<p>" . mysql_errno() . " : " .  mysql_error() . "<p>error file : $_SERVER[PHP_SELF]");
    $total_count = mysql_num_rows($result); 
```

[mysql临时表](http://dev.mysql.com/doc/refman/5.0/en/internal-temporary-tables.html)

如果你临时表在 tempfs（内存区域）中的位置速度也翻了一番。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-01T21:54:20.630

数据库执行表连接的方法有[多种。](http://en.wikipedia.org/wiki/Join_%28SQL%29#Join_algorithms)MySQL 仅使用*嵌套[循环](http://en.wikipedia.org/wiki/Nested_loop_join)连接*，如[输出](http://dev.mysql.com/doc/refman/5.5/en/explain-output.html)[部分`EXPLAIN`](http://dev.mysql.com/doc/refman/5.5/en/explain-output.html)所述。嵌套循环的工作方式是理解为什么这个查询需要这么多时间的关键。

根据您的`EXPLAIN`输出，MySQL 首先扫描`maddr`表，因此您有一个`1 016 497`执行循环。在每个执行数据库内部，对一个小表执行两次索引扫描。即使成本：

*   启动新的索引扫描；
*   在索引中搜索条目；
*   完成扫描

真的很小（因为数据*很可能*会在执行这么多的情况下被缓存），无论如何都需要几毫秒。然后你乘以`2`, 因为`msgrcpt`和`msgs`都在内部被扫描。然后乘以外部循环的执行次数，这给了你相当长的时间。

您的视图定义对返回的数据没有过滤器，因此必须扫描和连接所有表。鉴于嵌套循环的工作方式，很明显，当外部查询包含最少数量的循环时，变体是性能最好的变体。考虑到所有表的大小，索引扫描（根据`EXPLAIN`输出对索引扫描所有 3 个表）将检查：

*   `msgrcpt`: 日志[2] (2587307) + 1 = 22 页，
*   `msgs`: 日志[2] (2421710) + 1 = 22 页和
*   `maddr`: log [2] (994880) + 1 = 每次扫描 21 页

在*最坏的情况*下。这表明即使使用索引扫描，表扫描时间也是相当的并且非常重要。不过，`maddr`它更小，这就是 MySQL 选择首先扫描它的原因。

在我看来，数据库选择的计划是给定情况下最好的计划。而且 MySQL 仅支持嵌套循环连接这一事实没有提供优化的可能性，因为外部循环已经是最小的循环。此处可能使用了[哈希连接以获得更好的性能。](http://en.wikipedia.org/wiki/Hash_join)

* * *

那么，如何让事情在这种情况下发挥作用呢？

我建议只使用视图来查询带有过滤器的数据，这将使 MySQL 有更多机会优化查询并快速返回数据。

为了获得行数，我会进行估计（如果可以接受的话），计算`count(*)`每个单独的表并取最大的一个。

另一种方法是重新设计模式，使其中一个表成为主表，以便视图中的行数应始终与主表中的行数匹配。我不确定如何使用给定的设计来做到这一点，抱歉。

如果没有一个选项是可接受的，不幸的是，我看不到其他方法来优化这个查询。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-07-05T13:45:44.957

尝试使用 COUNT(*) insted COUNT(1) 因为 MySQL 优化器有很多错误 [http://www.mysqlperformanceblog.com/2007/04/10/count-vs-countcol/](http://www.mysqlperformanceblog.com/2007/04/10/count-vs-countcol/)

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2012-07-07T13:21:47.973

写入一个主键列`count()`以使其更快。like`count(id)`