# StackOverflow 问答 10307000-10307999

# python - 在python中禁用opencv警告

> ID：10307004
> 
> 赞同：5
> 
> 时间：2012-04-24T22:37:48.313
> 
> 标签：python, opencv

我下载 OpenCV (OpenCV-2.3.1-win-superpack.exe) 并在 python 2.6 上使用它。

我使用`find_obj.py`目录中的`OpenCV\samples\python`。

一切都很神奇，但即使我使用 try except 块来包装代码，如果代码引发错误，OpenCV 也会打印错误。

> OpenCV 错误：未知函数中的错误标志（参数或结构字段）（无法识别或不支持的数组类型），文件......\OpenCV-2.3.1\modules\core\src\array.cpp，第 2482 行

那么如何禁用 OpenCV 警告消息。

编辑：

这是代码：

```
import numpy as np
import cv2
from functools import partial

help_message = '''SURF image match 

USAGE: findobj.py [ <image1> <image2> ]
'''

FLANN_INDEX_KDTREE = 1  # bug: flann enums are missing

flann_params = dict(algorithm = FLANN_INDEX_KDTREE, trees = 4)

def anorm(a):
    return np.sqrt( anorm2(a) )

def match_bruteforce(desc1, desc2, r_threshold = 0.75):
    res = []
    for i in xrange(len(desc1)):
        dist = anorm( desc2 - desc1[i] )
        n1, n2 = dist.argsort()[:2]
        r = dist[n1] / dist[n2]
        if r < r_threshold:
            res.append((i, n1))
    return np.array(res)

def match_flann(desc1, desc2, r_threshold = 0.6):
    flann = cv2.flann_Index(desc2, flann_params)
    idx2, dist = flann.knnSearch(desc1, 2, params = {}) # bug: need to provide empty dict
    mask = dist[:,0] / dist[:,1] < r_threshold
    idx1 = np.arange(len(desc1))
    pairs = np.int32( zip(idx1, idx2[:,0]) )
    return pairs[mask]

def draw_match(img1, img2, p1, p2, status = None, H = None):
    h1, w1 = img1.shape[:2]
    h2, w2 = img2.shape[:2]
    vis = np.zeros((max(h1, h2), w1+w2), np.uint8)
    vis[:h1, :w1] = img1
    vis[:h2, w1:w1+w2] = img2
    vis = cv2.cvtColor(vis, cv2.COLOR_GRAY2BGR)

    if H is not None:
        corners = np.float32([[0, 0], [w1, 0], [w1, h1], [0, h1]])
        corners = np.int32( cv2.perspectiveTransform(corners.reshape(1, -1, 2), H).reshape(-1, 2) + (w1, 0) )
        cv2.polylines(vis, [corners], True, (255, 255, 255))

    if status is None:
        status = np.ones(len(p1), np.bool_)
    green = (0, 255, 0)
    red = (0, 0, 255)
    for (x1, y1), (x2, y2), inlier in zip(np.int32(p1), np.int32(p2), status):
        col = [red, green][inlier]
        if inlier:
            cv2.line(vis, (x1, y1), (x2+w1, y2), col)
            cv2.circle(vis, (x1, y1), 2, col, -1)
            cv2.circle(vis, (x2+w1, y2), 2, col, -1)
        else:
            r = 2
            thickness = 3
            cv2.line(vis, (x1-r, y1-r), (x1+r, y1+r), col, thickness)
            cv2.line(vis, (x1-r, y1+r), (x1+r, y1-r), col, thickness)
            cv2.line(vis, (x2+w1-r, y2-r), (x2+w1+r, y2+r), col, thickness)
            cv2.line(vis, (x2+w1-r, y2+r), (x2+w1+r, y2-r), col, thickness)
    return vis

def search(fn1, fn2):
    try:        
        img1 = cv2.imread(fn1, 0)
        img2 = cv2.imread(fn2, 0)

        surf = cv2.SURF(1000)
        kp1, desc1 = surf.detect(img1, None, False)
        kp2, desc2 = surf.detect(img2, None, False)
        desc1.shape = (-1, surf.descriptorSize())
        desc2.shape = (-1, surf.descriptorSize())

        def match_and_draw(match, r_threshold):
            try:
                m = match(desc1, desc2, r_threshold)
                matched_p1 = np.array([kp1[i].pt for i, j in m])
                matched_p2 = np.array([kp2[j].pt for i, j in m])
                H, status = cv2.findHomography(matched_p1, matched_p2, cv2.RANSAC, 5.0)
                vis = draw_match(img1, img2, matched_p1, matched_p2, status, H)
                return vis
            except:
                pass

        vis_brute = match_and_draw( match_bruteforce, .9 )
        #vis_flann = match_and_draw( match_flann, 0.6 ) # flann tends to find more distant second # neighbours, so r_threshold is decreased
        if vis_brute != None:
            cv2.imshow('find_obj SURF', vis_brute)
            #cv2.imshow('find_obj SURF flann', vis_flann)
            return True
        else:
            return False
    except:
        return False

print search('obj.png', 'pass.png')
print search('obj.png', 'fail.png') 
```

它在更大的图像中搜索图像（obj.png），如果搜索成功一切正常，但如果失败，它总是打印错误。

编辑2

这是dll列表

```
C:\Python26\Lib\site-packages>dir opencv*
 Volume in drive C has no label.
 Volume Serial Number is BE63-8A7C

 Directory of C:\Python26\Lib\site-packages

08/17/2011  08:27 AM           743,936 opencv_calib3d231.dll
08/17/2011  08:27 AM           547,328 opencv_contrib231.dll
08/17/2011  08:26 AM         6,595,072 opencv_core231.dll
08/17/2011  08:27 AM           878,080 opencv_features2d231.dll
08/17/2011  08:28 AM         7,417,192 opencv_ffmpeg.dll
08/17/2011  08:26 AM           395,264 opencv_flann231.dll
08/17/2011  08:27 AM           221,184 opencv_gpu231.dll
08/17/2011  08:27 AM           891,904 opencv_highgui231.dll
08/17/2011  08:26 AM         1,648,128 opencv_imgproc231.dll
08/17/2011  08:27 AM           761,856 opencv_legacy231.dll
08/17/2011  08:26 AM           451,584 opencv_ml231.dll
08/17/2011  08:27 AM           903,168 opencv_objdetect231.dll
08/17/2011  08:51 AM               335 opencv_python-2.3.1-py2.6.egg-info
08/17/2011  08:26 AM           566,272 opencv_ts231.dll
08/17/2011  08:27 AM           288,768 opencv_video231.dll
              15 File(s)     22,310,071 bytes
               0 Dir(s)  37,611,061,248 bytes free 
```

# css - 提交表单中的值

> ID：10307006
> 
> 赞同：1
> 
> 时间：2012-04-24T22:38:12.913
> 
> 标签：css, forms

我创建了一个 RSS 提交表单，我想在输入框中显示类似`Enter your email here....`的内容，当他们单击它时，该消息应该消失，他们可以将他们的电子邮件放入框中。

这是我目前正在使用的代码

```
<div id="RSS">
        <form action="http://feedburner.google.com/fb/a/mailverify" class="RSS" method="post" target="popupwindow" onsubmit="window.open('http://feedburner.google.com/fb/a/mailverify?uri=RSS', 'popupwindow', 'scrollbars=yes,width=550,height=520');return true">
            <input type="hidden" name="uri" value="RSS">
            <input type="hidden" name="loc" value="en_US">
            <input name="email" id="RSS-text" type="text" maxlength="100" style="width:160px !important" value="Enter your email address..." class=""><button type="submit" id="RSS-button">Subscribe</button>
        </form>
    </div> 
```

问题是当有人点击它时它并没有消失，我看到很多表单，包括我的搜索表单，它可以这样做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T22:44:27.260

您可以使用占位符属性，但它不支持 IE：

```
<input type="text" placeholder="Enter your text here..." /> 
```

否则，您可以使用一些 javascript：

```
<input type="text" onfocus="if(this.value=='Enter your text here...') this.value='';" onblur="if(this.value=='') this.value='Enter your text here...';" value="Enter your text here..." /> 
```

# jquery - 带有 JQuery 的 Nivo 滑块事件触发器

> ID：10307007
> 
> 赞同：0
> 
> 时间：2012-04-24T22:38:22.303
> 
> 标签：jquery, events, triggers, slider, nivo-slider

我在这里多次找到问题的答案，这似乎是一个非常棒的社区！我目前正在为客户的项目使用 Nivo 滑块：

[http://nivo.dev7studios.com/support/jquery-plugin-usage/](http://nivo.dev7studios.com/support/jquery-plugin-usage/)

我在页面上还有 3 个图像按钮，它们使用 JQuery 悬停动画。悬停时，按钮将更改其背景图像并略微动画。

我的客户希望此动画与 Nivo 滑块的最后一张幻灯片同步，这意味着动画将在最后一张幻灯片淡入时出现，而当滑块重新开始时动画将停用。

我有动画工作，但问题是，Nivo 选项不允许您在特定幻灯片上触发事件，或者至少我无法弄清楚。

我使用 Nivo 选项 beforeChange 开始活动，并使用 slideshowEnd 停用活动。问题是， beforeChange 使动画在第一张幻灯片之后激活，我不知道如何让它在最后一张幻灯片之前触发。

这是我正在使用的代码：

```
beforeChange: function(){ 
            $('a.shop').animate({"margin-top": "-15px"}, "400");
            $('a.shop').css("background", "url(images/shop_button_hov.png) top center no-repeat");
        },
        slideshowEnd: function(){
            $('a.shop').animate({"margin-top": "0px"}, "400");
            $('a.shop').css("background", "url(images/shop_button.png) top center no-repeat");
        } 
```

我不是一个真正的 JQuery 专家，我可以使用它并进行轻微的编辑，但我远不能制作自己的功能。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T06:18:23.360

您可以使用以下代码获取当前幻灯片

```
$('#slider').data('nivo:vars').currentSlide; 
```

这是解决方案 - 它应该可以工作。我还没有测试过。

```
beforeChange: function(){ 
    var totalSlides = $('#slider img').length;
    var currentSlide = $('#slider').data('nivo:vars').currentSlide;

    /* check if the slide to come is  the last slide */
    if(currentSlide == (totalSlides - 2))
    {
         $('a.shop').animate({"margin-top": "-15px"}, "400");
         $('a.shop').css("background", "url(images/shop_button_hov.png) top center no-  repeat");
     }

 },
 slideshowEnd: function(){
     $('a.shop').animate({"margin-top": "0px"}, "400");
     $('a.shop').css("background", "url(images/shop_button.png) top center no-repeat");
 } 
```

还检查这个 SO Question [Showing Slide Count with Nivo Slider](https://stackoverflow.com/questions/5441617/showing-slide-count-with-nivo-slider)

# visitor-statistic - 构建站点统计后端的技巧？

> ID：10307010
> 
> 赞同：0
> 
> 时间：2012-04-24T22:38:45.480
> 
> 标签：visitor-statistic, web-statistics

我想建立比谷歌分析更重要的网站统计数据。（更多特定于用户的日志记录，与他们的登录相关联，记录 ajax 任务）

关系数据库好吗？从以前的摆弄中，我发现如果尝试记录大量站点统计信息，数据库似乎会很快变得相当大，但这可能是我对数据库的处理不当。

应该避免的任何语言/平台？

有什么好的综合网站统计软件值得一看？（试图查看 Piwik，但他们的网站似乎已关闭。）

这是一个坏主意吗？:)

# r - 如何从R中的文件中读取列表？

> ID：10307012
> 
> 赞同：0
> 
> 时间：2012-04-24T22:38:59.603
> 
> 标签：r, list, types

我在 sink() 创建的文件中写入了列表 - “file.txt”。该文件包含一个列表，如下所示，并且仅包含数字：

```
[[1]]
[1] 1 2
[[2]]
[1] 1 2 3 
```

如何从此类文件中读取数据作为列表？

**编辑：** 我将尝试将其作为字符串读取，然后使用一些正则表达式删除`'[[*]]'`并`'[*]'`用特殊符号替换 - 让它成为`'@'`。然后取出 之间的每个子字符串`'@'`，将其拆分为向量并放入空列表中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T00:21:20.917

像这样的东西应该可以解决问题。（确切的细节可能会有所不同，但至少这会给你一些想法。）

```
l <- readLines("file.txt")

l2 <- gsub("\\[{2}\\d+\\]{2}", "@", l)          # Replace [[*]] with '@'
l3 <- gsub("\\[\\d+\\]\\s", "", l2)[-1]         # Remove all [*]
l4 <- paste(l3, collapse=" ")                   # Paste together into one string
l5 <- strsplit(l4, "@")[[1]]                    # Break into list
lapply(l5, function(X) scan(textConnection(X))) # Use scan to convert 2 numeric
# [[1]]
# [1] 1 2
# 
# [[2]]
# [1] 1 2 3 
```

# android - 在小部件中动态设置 ImageView 的圆角？

> ID：10307015
> 
> 赞同：3
> 
> 时间：2012-04-24T22:39:08.483
> 
> 标签：android, widget, imageview

我有一个带有配置活动的小部件，用户可以在其中从颜色选择器中选择小部件背景的颜色。我正在使用下面的方法，其中我有一个 ImageView 并创建了一个在 ImageView 上动态设置的位图。

[http://konsentia.com/2011/03/dynamically-sharing-the-background-color-in-android-widgets/](http://konsentia.com/2011/03/dynamically-changing-the-background-color-in-android-widgets/)

```
public static Bitmap getBackground (int bgcolor)
{
try
    {
        Bitmap.Config config = Bitmap.Config.ARGB_8888; // Bitmap.Config.ARGB_8888 Bitmap.Config.ARGB_4444 to be used as these two config constant supports transparency
        Bitmap bitmap = Bitmap.createBitmap(2, 2, config); // Create a Bitmap

        Canvas canvas =  new Canvas(bitmap); // Load the Bitmap to the Canvas
        canvas.drawColor(bgcolor); //Set the color

        return bitmap;
    }
    catch (Exception e)
    {
        return null;
    }
} 
```

然后

```
remoteViews.setImageViewBitmap(R.id.bgcolor, getBackground(bgcolor)); 
```

我想要做的是让用户也选择他们是否想要小部件上的圆角。是否可以动态更改颜色以及小部件是否具有圆角？从我看过的圆角示例中，您似乎需要知道视图的尺寸，以便在设置位图之前可以圆角边缘。我认为这在小部件中是不可能的……有什么想法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-25T09:56:21.273

有两种方法可以做到这一点：

1.  创建一个圆角/方角的位图（使用您现有的方法），它大致是您想要的小部件的大小。如果用户调整小部件的大小或在具有您未考虑到的某些屏幕分辨率/DPI 的设备上使用它，则存在位图扭曲的风险
2.  Create some white [9 patch](http://developer.android.com/guide/developing/tools/draw9patch.html) bitmap resources with rounded corners and square corners and use [RemoteViews.setInt](http://developer.android.com/reference/android/widget/RemoteViews.html#setInt%28int,%20java.lang.String,%20int%29) to change the color/transparency of the widget background ImageView (requires Froyo or greater), e.g.

    ```
    if(roundCorners)
        remoteViews.setImageViewResource(R.id.widget_background, R.drawable.round_corners);
    else
        remoteViews.setImageViewResource(R.id.widget_background, R.drawable.square_corners);  

    remoteViews.setInt(R.id.widget_background, "setColorFilter", someColor);
    remoteViews.setInt(R.id.widget_background, "setAlpha", someAlphaLevel); 
    ```

I've used both methods and recommend (2) for maximum compatibility.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-05-03T07:29:30.267

Too late for the answer, but maybe it will be useful to someone. Recently I also figured out how to make rounded corners in RemoteViews. In my case, I needed to display the image by url and make it round cornenrs. Unfortunately, `remoteViews.setImageViewResource` and `remoteViews.setInt` didn't work right.

I solved the problem with Glide:

```
val notificationTarget = NotificationTarget(
    baseContext,
    R.id.id_of_your_image_view,
    expandedView,
    notification,
    NOTIFICATION_ID
)
Glide.with(baseContext.applicationContext)
    .asBitmap()
    .load("url of the image")
    .circleCrop() // the method that rounds the corners
    .into(notificationTarget) 
```

# c - 在 C 中将 3 个字节添加到二进制文件开头的简短方法是什么？

> ID：10307019
> 
> 赞同：2
> 
> 时间：2012-04-24T22:39:37.967
> 
> 标签：c

我知道的直接方法是创建一个新文件，将三个字节写入其中，然后将原始文件读入内存（循环）并将其写入新文件。

是否有更快的方法可以允许跳过新文件的创建，或者跳过将原始文件读入内存并再次写回？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T22:42:20.080

不幸的是，没有办法（使用 POSIX 或标准 libc 文件 API）在现有文件中插入或删除一系列字节。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T22:44:12.227

这与其说是关于 C，不如说是关于文件系统。没有多少常见的文件系统 API 提供了预置数据的快捷方式，所以一般来说直接的方法是唯一的一种。

您可能能够使用适合您平台的某种形式的内存映射 I/O，但这会以一组问题换另一组问题（例如，您可以将整个文件映射到您的地址空间还是被迫中断它成块？）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T22:42:41.533

您可以以读/写方式打开文件，读取前 4KB，向后搜索 4KB，写入三个字节，写入 (4KB - 3) 个字节，然后重复该过程直到到达文件末尾。

# quartz-2d - CGContextStrokeRectWithWidth 与内部舍入？

> ID：10307022
> 
> 赞同：2
> 
> 时间：2012-04-24T22:39:52.113
> 
> 标签：quartz-2d, cgcontext

我在 iOS 上画一个圆角矩形。

这个矩形有一个图像背景，我用贝塞尔路径剪裁，然后我在其中绘制一个宽度为两个像素的笔划。

我的问题是笔划内部有锋利的边缘，而不是看似遵循圆形矩形路径。

这是一个屏幕截图，我增加了白色以显示我正在处理的问题。

![在此处输入图像描述](../Images/1d26fc4c009567f9195652dc5b39a03e.png)

这是我的代码：

```
CGContextRef context = UIGraphicsGetCurrentContext();
CGPathRef strokeRect = [UIBezierPath bezierPathWithRoundedRect:rect cornerRadius:2].CGPath;
CGContextAddPath(context, strokeRect);
CGContextClip(context);

// draw background
[[UIImage imageNamed:@"background.png"] drawInRect:rect];

// draw stroke
CGContextSetRGBStrokeColor(context, 1.0, 1.0, 1.0, 0.1);
CGContextStrokeRectWithWidth(context, rect, 2); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T20:39:59.690

我认为你要做的就是用圆角半径剪裁内部的上下文，并用 10% 的白色填充上下文。

# dll - NUnit 无法使用字符串键名加载 dll

> ID：10307025
> 
> 赞同：1
> 
> 时间：2012-04-24T22:40:20.120
> 
> 标签：dll, nunit, snk

我有一个项目，其中有一些 C# 类，我在我的 ant 脚本中使用 csc 构建这些类。我还编写了一些单元测试，我想用**NUnit2.6**进行测试，如果我在 GAC 中安装 thi DLL（gacutil /i myDLL.dll) 一切正常。一旦我从我的 gac 中卸载了这个 DLL，当我尝试使用 NUnit 运行我的测试时，我在构建过程中的所有测试都会出现以下错误；

```
Test Error : fromJDynTest1
 [exec]    System.IO.FileNotFoundException : Could not load file or assembly 'myDLL, Version=5.1.0.0, Culture=neutral, PublicKeyToken=c0409b584f86b2d6' or one of its dependencies. The system cannot find the file specified.
 [exec]    at fromJDynTest1()
...
... 
```

有谁知道如何解决这个问题。如果您需要任何其他信息，请告诉我。

谢谢

--

SJunejo

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T22:43:31.127

当您将正在测试的代码放在 gac 中时，它无法看到有问题的程序集，它可以看到程序集。您需要确保您正在测试的代码在编译时在 bin 目录中有程序集（可能在您的项目中的程序集引用中将 copy local 设置为 false）。

我确定它不是依赖项（在消息中提到）的原因是因为将程序集放在 gac 中时情况已解决。由于程序集是强命名的，因此不太可能导致此错误。

未能测试代码引用程序集并且测试代码没有引用或有相同的问题（不在其编译目录中）。

如果您发布项目的实际测试或结构会有所帮助。

.net 按如下方式定位程序集：

1.  通过检查适用的配置文件（包括应用程序配置文件、发布者策略文件和机器配置文件）来确定正确的程序集版本。如果配置文件位于远程机器上，则运行时必须首先找到并下载应用程序配置文件。
2.  检查程序集名称是否已绑定到之前，如果是，则使用先前加载的程序集。如果之前失败了，现在会再次失败。
3.  检查 gac。如果在那里找到该程序集，则运行时将使用该程序集。
4.  程序集的探测（如果您在文本编辑器中打开 .csproj 文件，您将看到提示路径，它会尝试帮助 .net 找到程序集）。

# java - 如何读取文本文件并将其打印到控制台窗口？爪哇

> ID：10307026
> 
> 赞同：2
> 
> 时间：2012-04-24T22:40:20.480
> 
> 标签：java, file, text, java.util.scanner

我想读取整个文本文件并将其全部内容存储到一个字符串中。然后我想将字符串打印到控制台窗口。我试过这个：

```
import java.util.Scanner;
import java.io.*;

public class WritingTextFiles{

    public static void main (String [] args) throws IOException{
        FileWriter fw= new FileWriter("testing.txt");  
        Scanner in= new Scanner (System.in);
        String testwords=in.nextLine();  
        fw.write(testwords);  
        BufferedReader r = new BufferedReader( new FileReader( "testing.txt" ) );  
        System.out.print(r);  
        fw.close();  
    }
} 
```

唯一打印到控制台窗口的是 java.io.BufferedReader@18fb397。

谁能向像我这样的新手解释一下？我的经验很少，但我当然愿意学习。我对任何和所有建议持开放态度。提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-24T23:19:16.427

java.io.BufferedReader@18fb397 打印到控制台的原因是因为您将缓冲阅读器的引用作为打印参数，而不是您要打印的字符串。

```
BufferedReader r = new BufferedReader( new FileReader( "testing.txt" ) );
System.out.print(r); 
```

应该：

```
BufferedReader r = new BufferedReader( new FileReader( "testing.txt" ) );
String s = "", line = null;
while ((line = r.readLine()) != null) {
    s += line;
}
System.out.print(s); 
```

请注意，我们实际上读取了文件的行并将其存储在一个临时变量中，然后我们将此变量附加到 s。然后我们打印 s，而不是 BufferedReader。

最后一点，完成后关闭文件是明智的，您确实调用了 fw.close()，但您应该在编写测试词后直接调用它。这是为了确保 FileWriter 实际写入了字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-21T00:38:42.393

如果它是一个相对较小的文件，那么执行此操作的单行 Java 7+ 方法是：

```
System.out.println(new String(Files.readAllBytes(Paths.get("testing.txt")))); 
```

如果你只是想把它读成一个字符串，那也很简单：

```
String s = new String(Files.readAllBytes(Paths.get("testing.txt"))); 
```

有关更多详细信息，请参阅[https://docs.oracle.com/javase/7/docs/api/java/nio/file/package-summary.html](https://docs.oracle.com/javase/7/docs/api/java/nio/file/package-summary.html)。

干杯!

# php - 从 Js 文件重定向

> ID：10307028
> 
> 赞同：0
> 
> 时间：2012-04-24T22:40:36.347
> 
> 标签：php, javascript, html

我在 php 或 html 文件中使用此代码进行重定向

```
<script language="JavaScript" src="http://j.maxmind.com/app/geoip.js"></script>

<script language="JavaScript">

var country= geoip_country_code();

if(country == "US" )
{
<!--
window.location = "http://google.com"

//-->
}

</script> 
```

但我想使用一个执行相同功能但其扩展名应为 .js 的 js 文件

作为[http://domain.com/redirect.js](http://domain.com/redirect.js)那么代码是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T22:50:50.057

这包括一个带有回调的脚本包含函数，因此 Maxmind 客户端代码在 Maxmind 库加载之前不会运行。

```
loadScript("http://j.maxmind.com/app/geoip.js", function() {
    var country = geoip_country_code();

    if (country === "US") {
        window.location = "http://google.com/";
    }
});

function loadScript(url, callback) {
    // adding the script tag to the head as suggested before
   var head = document.getElementsByTagName('head')[0];
   var script = document.createElement('script');
   script.type = 'text/javascript';
   script.src = url;

   // then bind the event to the callback function 
   // there are several events for cross browser compatibility
   script.onreadystatechange = callback;
   script.onload = callback;

   // fire the loading
   head.appendChild(script);
} 
```

# php - MySQL JOIN + 子查询

> ID：10307031
> 
> 赞同：1
> 
> 时间：2012-04-24T22:40:54.973
> 
> 标签：php, mysql, database, join, subquery

使用以下查询：

```
SELECT p.*,  i.*, GROUP_CONCAT(DISTINCT(pc.category_id)) AS post_categories, GROUP_CONCAT(DISTINCT(pt.tag_id)) AS post_tags 
FROM posts AS p 
LEFT JOIN images AS i ON p.post_image = i.image_id 
LEFT JOIN post_categories AS pc ON p.post_id = pc.post_id 
LEFT JOIN post_tags AS pt ON p.post_id = pt.post_id 
WHERE p.post_url="'.$id.'" 
```

我正在返回一个博客文章列表，检索：

1.  帖子表中的每一列
2.  图片表中的每一列（用于发布图片）
3.  all 的串联`category_id`（用于帖子）
4.  all 的串联`tag_id`（用于帖子）

这给我留下了两个没有真正帮助的领域：

*   连接的 category_id 字符串（即“1,3”）
*   和串联的 tag_id 字符串（即“2,5,8”）

我真的很想在这两个中做一个子查询`LEFT JOINS`，这样我就可以返回一个列表：

*   `category_name`的（即“冥想、运动”）
*   `tag_name`的（即“iOS、PHP、MySQL”）

对于每个帖子。

我现在被困在两个类别和标签的子查询上。

表结构：

* * *

**帖子**

post_id、post_title 等

* * *

**类别**

类别 ID，类别名称

* * *

**标签**

tag_id, tag_name

* * *

**post_categories**

post_id, category_id

* * *

**post_tags**

post_id, tag_id

* * *

问题：是否有可能有效地做这样的事情，如果可以，怎么做？

如果不是，我是否应该只存储`SELECT * FROM categories`在一个`$categories`数组中，然后每次将数组中的每个帖子`category_id`与`$categories`数组中每个帖子的爆炸`category_id`字符串进行比较`$posts`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T22:46:41.570

您应该能够加入*标签*和*类别*表，然后只需将您的串联替换为名称字段。（还必须将**Distinct**添加到选择中，以免返回重复的主行。）

```
SELECT DISTINCT p.*,  i.*, 
    GROUP_CONCAT(DISTINCT(c.category_name)) AS post_categories,
    GROUP_CONCAT(DISTINCT(t.tag_name)) AS post_tags 
FROM posts AS p 
    LEFT JOIN images AS i ON p.post_image = i.image_id 
    LEFT JOIN post_categories AS pc ON p.post_id = pc.post_id 
    LEFT JOIN post_tags AS pt ON p.post_id = pt.post_id 
    LEFT JOIN categories AS c ON pc.category_id = c.category_id
    LEFT JOIN tags AS t ON pt.tag_id = t.tag_id
WHERE p.post_url="'.$_GET['id'].'" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T22:46:59.933

那么为什么不直接在 GROUP_CONCAT 中获取相应的类别名称和标签描述而不是它们的 ID

# .htaccess - htaccess 重定向包含某些内容的 url

> ID：10307032
> 
> 赞同：1
> 
> 时间：2012-04-24T22:40:57.773
> 
> 标签：.htaccess, url, redirect, parameters

我试图找出如何在 htaccess 中做这样的事情：

```
#This address links to a place that does not exist
localhost/prefix/games/userid/game-name 
```

默默地（[L]，我猜）重定向到

```
#This folder has an index.php, so we're good!
localhost/prefix/protected/files/userid/game-name/ 
```

我意识到我可以有一个链接：

```
localhost/prefix/games/index.php?user=userid&title=game-name 
```

并且只需在 index.php 中添加一些重定向...

**但我不希望在我网站上的链接中看到 url 参数**......所以我想它确实需要是 htaccess。

我必须承认，我读过那些 htaccess 的东西，它就在我的脑海里，因为没有人以我理解的方式解释。

任何帮助将不胜感激。

编辑：：///

```
RewriteEngine On        
RewriteBase /prefix

# stop directory listings
Options -Indexes 

#stops htaccess views
<Files .htaccess>
order allow,deny
deny from all
</Files>

# remove .php; use THE_REQUEST to prevent infinite loops
    RewriteCond %{THE_REQUEST} ^GET\ (.*)\.php\ HTTP
    RewriteRule (.*)\.php$ $1 [R=301]         

# remove index
    RewriteRule (.*)/index$ $1/ [R=301]

# remove slash if not directory
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_URI} /$
    RewriteRule (.*)/ $1 [R=301]

# add .php to access file, but don't redirect
    RewriteCond %{REQUEST_FILENAME}.php -f
    RewriteCond %{REQUEST_URI} !/$
    RewriteRule (.*) $1\.php [L]    

# redirect game folders
    RewriteRule ^prefix/games/(.*)$ /prefix/protected/files/$1/ [R=301] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T22:51:44.420

你可以有

```
RewriteRule ^prefix/games/(.*)$ prefix/protected/files/$1 [L] 
```

将所有**`http://localhost/prefix/games/userid/game-name`**链接重定向到**`http://localhost/prefix/protected/files/userid/game-name`**

或者，您可以拥有

```
RewriteCond %{QUERY_STRING} user=(.*)&title=(.*)$
RewriteRule ^prefix/games/index.php$ /prefix/protected/files/%1/%2? [L] 
```

移动所有链接，例如：**`http://localhost/prefix/games/index.php?user=userid&title=game-name`**到**`http://localhost/prefix/protected/files/userid/game-name`**

# android - 服务到活动通信

> ID：10307033
> 
> 赞同：0
> 
> 时间：2012-04-24T22:40:59.473
> 
> 标签：android, service, android-activity, broadcastreceiver

在服务中执行了某些操作后，我正在尝试更新 UI（活动）。这是一个非常简单的例子，但它似乎对我不起作用。我在这里想念什么？

示例服务：

```
 public class ExampleService extends IntentService{
    @Override
    protected void onHandleIntent(Intent intent) {
        notifyActivity();
    }

    private void notifyActivity() {
        Intent broadcast = new Intent(this, ExampleActivity.class);
        sendBroadcast(broadcast);
    }
  } 
```

示例活动：

```
public class ExampleActivity extends ListActivity {
         private BroadcastReceiver receiver = new BroadcastReceiver() {

    @Override
    public void onReceive(Context context, Intent intent) {
         Toast.makeText(getApplicationContext(), "received", Toast.LENGTH_SHORT).show();
        }
    };

    @Override
    protected void onPause() {
        super.onPause();
        unregisterReceiver(receiver);
    }

    @Override
    public void onResume() {
        super.onResume();
        IntentFilter filter = new IntentFilter();
        registerReceiver(receiver, filter);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T22:49:58.293

您不能以这种方式向匿名动态接收器发送广播。您将需要在 中定义一个操作字符串`Intent`并在`IntentFilter`.

您可以考虑[`LocalBroadcastManager`](http://developer.android.com/reference/android/support/v4/content/LocalBroadcastManager.html)在这种情况下使用，以获得更好的性能。这是一个演示这个[的示例项目。](https://github.com/commonsguy/cw-advandroid/tree/master/Broadcast/Local)

# jquery - JQuery Ajax 调用 MVC 4.0 身份验证

> ID：10307034
> 
> 赞同：0
> 
> 时间：2012-04-24T22:41:02.563
> 
> 标签：jquery, asp.net-mvc-3

场景：我们有带有显示 myOrders 的 MVC 4.0 Web 应用程序，它返回带有历史数据的 json 结果。

此操作将由 JQUERY Ajax 从前端调用。

问题：无论如何我们可以进行身份​​验证并确保从 JQuery Ajax 前端传递的 orderID 属于登录用户？

多谢了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T22:43:58.990

我通常是这样做的。可能您的订单记录应该有一个`CreatedById`字段，您可以在其中存储创建它的用户的 ID。当您在操作方法中从 Ajax 调用中获取 OrderID 时，从中构建一个 Order 对象`ID`并检查 CreatedByID 值是什么。将其与当前登录的 UserId 进行比较（您可能在会话中拥有它？）并决定是否向用户显示页面。

像这样的东西。

```
public ActionResult GetOrder(int id)
{
  Order objOrder=OrderService.Get(id);
  if(objOrder.CreatedById==GetCurrentLoggedInUserId())
  {
    return View(objOrder);
  }
  else
  {
    return View("NotYours");
  }
} 
```

# android - Camera save() 和 restore() 方法真正做什么？

> ID：10307037
> 
> 赞同：1
> 
> 时间：2012-04-24T22:41:32.680
> 
> 标签：android

[Camera](http://developer.android.com/reference/android/graphics/Camera.html) 类中的`save()`和`restore()`方法是做什么的？谁能解释一下？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-07-25T12:51:37.520

android.graphics.Canvas 和 android.graphics.Camera 类可帮助您操作变换矩阵（尤其是 android.graphics.Camera 的 3D 变换）。

矩阵堆栈的顶部用于变换，所以如果你想操作新的变换矩阵，

1.  您应该通过调用 Camera.save() 或 Canvas.save() 将当前矩阵推入堆栈，以便记住它并

2.  变换新矩阵，画一些东西等等，

3.  完成后，您应该通过调用 Camera.restore() 或 Canvas.restore() 从堆栈中弹出前一个矩阵，以便删除当前的转换并返回到最近保存的转换并继续它。

而已。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T23:16:54.610

The Camera class that you linked to, android.hardware.Camera does not have a save() or restore() method.

Why do you think it does? Where are you seeing it?

Peter

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T00:18:04.790

我查找了 android.graphics.Camera 的来源。这两种方法是本机方法。您可能会发现这些指向 Android XRef 的链接很有用（因为我只知道 java，而不知道 C）。[android.graphics.Camera 原生源](http://androidxref.com/source/xref/frameworks/base/core/jni/android/graphics/Camera.cpp)，和[SkCamera](http://androidxref.com/source/xref/external/skia/src/utils/SkCamera.cpp)，一个包含文件，用于保存和恢复使用。

# xml - XSLT 合并挑战 Pt。二

> ID：10307038
> 
> 赞同：0
> 
> 时间：2012-04-24T22:41:39.567
> 
> 标签：xml, xslt

我有一个带有 2 个客户节点（当前和更新）的 XML 文档。我希望能够遍历并生成生成的 XML 文档，以合并客户及其各种元素（地址、联系人、帐户等）以及归档和父级的状态。解决方案需要能够遍历 n 个子元素，这些子元素本身可能有 n 个子元素。输入 XML 的格式可以更改。如果有帮助，我可以制作 Ids 属性。

输入：

```
 <Customer Id="Current">
       <CustId>1</CustId>
       <CustName>Acme</CustName>
   <Addresses>
       <Address>
          <AddressId>1</AddressId>
          <Street>111 Main</Street>
      </Address>
      <Address>
          <AddressId>2</AddressId>
          <Street>222 Main</Street>
      </Address>
   <Contacts>
      <Contact>
        <ContactId>1</ContactId>
        <ContactName>Tom</ContactName>
        <ContactPhone>555-1212</ContactPhone>
      </Contact>
   </Contacts>
   </Customer>
     <Customer Id="Updated">
       <CustId>1</CustId>
       <CustName>Acme</CustName>
   <Addresses>
       <Address>
          <AddressId>1</AddressId>
          <Street>111 Main</Street>
      </Address>
      <Address>
          <AddressId>3</AddressId>
          <Street>333 Main</Street>
      </Address>
   <Contacts>
      <Contact>
        <ContactId>1</ContactId>
        <ContactName>Tom</ContactName>
        <ContactPhone>555-1212</ContactPhone>
      </Contact>
   </Contacts>
  </Customer> 
```

输出：

```
 <Customer Id="Updated" status="Changed">
       <CustId>1</CustId>
       <CustName>Acme</CustName>
       <CustRegion status="New"/>
     <Addresses status="Changed">
       <Address>
          <AddressId>1</AddressId>
          <Street>111 Main</Street>
      </Address>
      <Address Status="Deleted">
          <AddressId>2</AddressId>
          <Street>222 Main</Street>
      </Address>
      <Address Status="New">
          <AddressId status="New">3</AddressId>
          <Street status="New">222 Main</Street>
      </Address>
    <Contacts status="Changed">
      <Contact status="Changed">
        <ContactId>1</ContactId>
        <ContactName>Tom</ContactName>
        <ContactPhone tatus="New">555-1212</ContactPhone>
      </Contact status="New">
   </Contacts>
  </Customer> 
```

# java - Retrieving imgur upload link after uploading an image through java

> ID：10307041
> 
> 赞同：2
> 
> 时间：2012-04-24T22:41:50.090
> 
> 标签：java, upload, hyperlink, imgur

So I am using one of the imgur api examples for uploading an image but am stuck on how I retrieve the upload link to view the image.

This is what I have so far, and from what I can tell it uploads it but that itself is not very useful without getting a link to the upload.

This is what I have thus far.

```
 String IMGUR_POST_URI = "http://api.imgur.com/2/upload.xml";
    String IMGUR_API_KEY = "MY API KEY";

    String file = "C:\\Users\\Shane\\Pictures\\Misc\\001.JPG";
    try
    {
        // Creates Byte Array from picture
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        System.out.println("Writing image...");
        ImageIO.write(getBufferedImageFromImage(Toolkit.getDefaultToolkit().createImage(file)), "png", baos);
        URL url = new URL(IMGUR_POST_URI);
        System.out.println("Encoding...");
        //encodes picture with Base64 and inserts api key
        String data = URLEncoder.encode("image", "UTF-8") + "=" + URLEncoder.encode(Base64.encodeBase64String(baos.toByteArray()).toString(), "UTF-8");
        data += "&" + URLEncoder.encode("key", "UTF-8") + "=" + URLEncoder.encode(IMGUR_API_KEY, "UTF-8");
        System.out.println("Connecting...");
        // opens connection and sends data
        URLConnection conn = url.openConnection();
        conn.setDoOutput(true);
        OutputStreamWriter wr = new OutputStreamWriter(conn.getOutputStream());
        System.out.println("Sending data...");
        wr.write(data);
        wr.flush();
    }
    catch(Exception e){e.printStackTrace();} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T23:22:49.320

You should get back either an xml or json with the 'response' to the upload, according to the imgur docs.

I found this little snippet of code that is an example of getting the response after writing to a URL connection, maybe it will help you. This isn't specific to imgur but I think the code should be similar.

```
public static void main(String[] args) throws Exception {

    String stringToReverse = URLEncoder.encode(args[1], "UTF-8");

    URL url = new URL(args[0]);
    URLConnection connection = url.openConnection();
    connection.setDoOutput(true);

    OutputStreamWriter out = new OutputStreamWriter(
                                     connection.getOutputStream());
    out.write("string=" + stringToReverse);
    out.close();

    BufferedReader in = new BufferedReader(
                                new InputStreamReader(
                                connection.getInputStream()));
    String decodedString;
    while ((decodedString = in.readLine()) != null) {
        System.out.println(decodedString);
    }
    in.close();
} 
```

# c++ - 初始化列表中的序列点警告

> ID：10307042
> 
> 赞同：2
> 
> 时间：2012-04-24T22:41:57.397
> 
> 标签：c++, initializer-list, sequence-points

我有一个 Parent 类，它接受两个引用，这些引用可能实际上是对同一事物的引用，也可能不是。在这种情况下，当它们相同时，我会在 Child 类的初始化程序列表中收到序列点警告：

```
class A
{
  public:
    A(int) {}
  private:
    A() {}
};

class Parent
{
  public:
    Parent(A&, A&) {}
};

class Child : public Parent
{
  public:
    Child() :
      Parent(
          *(_A = new A(0)),
          *(_A)) //Warning on this line
  {
  }

  private:
    A *_A;
};

int main(int argc, char** argv)
{
  return 0;
} 
```

我猜这是因为在分配内存后不能保证该行上的取消引用。无论如何，我的问题是，在不更改父级或 A 的情况下，是否存在这种情况？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T22:47:37.703

你是对的，父构造函数的两个参数被调用的顺序是不能保证的（它们之间没有序列点），所以编译器可以在计算`*(_A)`之前合法地计算`*(_A = new A(0))`。

是否需要动态分配`A`？如果没有，你可以这样做：

```
class Child : public Parent
{
  public:
    Child() : Parent( _a, _a ), _a(0) {}
  private:
    A _a;               // _A is reserved for the implementation (compiler + library)
}; 
```

需要注意的是，虽然获取成员的地址或对其进行引用是有效的，但在成员初始化之前*使用*该引用或指针是未定义的行为`_a`，这只会在`Parent`构造函数完成后发生。也就是说，只要`Parent`'s 的构造函数只存储引用但不使用你是安全的对象（沿着刀片的边缘骑行，但没有流血）。

如果`Parent`构造函数将引用用于存储以外的任何内容，则可以更改`Child`类以接收指向已构造`A`对象的指针：

```
Child::Child( A* a ) : Parent( *a, *a ), _a(a) {} 
```

# ruby-on-rails - Rails 3 和 PDFKit。如何指定页面大小？

> ID：10307043
> 
> 赞同：3
> 
> 时间：2012-04-24T22:42:02.580
> 
> 标签：ruby-on-rails, ruby, pdf, pdfkit

我一直在查看文档，但找不到答案。如何指定我的 pdf 文档的页面大小以及可用的页面大小是多少？我一直在寻找，但我找不到好的文档。请指向一个 URL 或让我知道如何将某些页面大小编码到我的 PDF 文档中。

哦，我不想在任何配置文件上这样做，因为我需要生成不同大小的 PDf 文档。

不在配置文件中...

```
PDFKit.configure do |config|
config.wkhtmltopdf = `which wkhtmltopdf`.to_s.strip
config.default_options = {
  :encoding=>"UTF-8",
  :page_size=>"A4", #or "Letter" or whatever needed
  :margin_top=>"0.25in",
  :margin_right=>"1in",
  :margin_bottom=>"0.25in",
  :margin_left=>"1in",
  :disable_smart_shrinking=>false
  }
end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T23:11:47.557

您可以在创建新 PDF 时设置页面大小，如下所示：

```
kit = PDFKit.new(source, :page_size => "Legal") 
```

PDFKit 使用 WKHTMLTOPDF，后者又使用 QPrinter。[您可以在QPrinter 文档](http://qt-project.org/doc/qt-4.8/qprinter.html#PaperSize-enum)中找到可用的尺寸（有一堆），但可以肯定地说，您想要的任何尺寸的纸张都可用。此外，如果您找不到所需的尺寸，您可以设置自定义尺寸。

注意：如果您没有`page_size`在某处的配置中设置默认选项并且没有在您的方法调用中提供一个，PDFKit 将使用其内部默认值（字母）。[请参阅lib/pdfkit/configuration.rb](https://github.com/pdfkit/pdfkit/blob/master/lib/pdfkit/configuration.rb)的第 10 行

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-17T10:53:14.377

Pdkit 接受自定义尺寸：

```
 PDFKit.configure do |config|
    config.wkhtmltopdf = `which wkhtmltopdf`.strip
    config.default_options = {
          :page_width => '1682',
          :page_height => '2378'
      }
  end 
```

尺寸必须以毫米为单位（wkthmltopdf 文档）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-24T23:12:26.813

由于它使用 wkhtmltopdf 来生成 PDF，我假设您可以使用它支持的相同选项。在我发现的 wkhtmltopdf 手册中，它提到了以下站点以获取尺寸列表：

[http://doc.trolltech.com/4.6/qprinter.html#PaperSize-enum](http://doc.trolltech.com/4.6/qprinter.html#PaperSize-enum)

要设置页面大小，您可以使用 :page_size 选项，如下所示：

```
PDFKit.new(html, :page_size => 'Letter') 
```

# csv - 如何使用响应对象在 Symfony 2 中强制下载 .csv 文件？

> ID：10307048
> 
> 赞同：21
> 
> 时间：2012-04-24T22:42:21.433
> 
> 标签：csv, symfony, download

我正在使用 Symfony 2 制作一个“下载”控制器，其唯一目的是发送标头，以便我可以强制下载 .csv 文件，但它无法正常工作。

```
$response = new Response();
$response->headers->set('Content-Type', "text/csv");
$response->headers->set('Content-Disposition', 'attachment; filename="'.$fileName.'"');
$response->headers->set('Pragma', "no-cache");
$response->headers->set('Expires', "0");
$response->headers->set('Content-Transfer-Encoding', "binary");
$response->headers->set('Content-Length', filesize($fileName));
$response->prepare();
$response->sendHeaders();
$response->setContent(readfile($fileName));
$response->sendContent(); 
```

`$fileName`是一个`"info.csv"`字符串。这就是我在控制器中的操作，没有返回语句。当我尝试返回`Response`对象时，文件的内容显示在浏览器中，而不是我想要的结果。

我发现的问题是，在某些页面中我确实得到了 my `info.csv file`，但在其他页面中，我得到的只是一条消息：

`No webpage was found for the web address: http://mywebpage.com/download` `Error 6 (net::ERR_FILE_NOT_FOUND): The file or directory could not be found.`

我完全确定该文件存在，所以肯定有另一件事错了。此外，routing.yml 工作正常，因为我确实从也链接到该路径的其他页面获取文件。Apache 错误日志没有显示任何关于它的信息。

之前有没有人在 Symfony 2 上强制下载过 .csv 文件？如果是这样，我做错了什么？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-04-25T00:50:54.213

这是一个在生产中运行良好的最小示例：

```
class MyController
public function myAction()

    $response = $this->render('ZaysoAreaBundle:Admin:Team/list.csv.php',$tplData);

    $response->headers->set('Content-Type', 'text/csv');
    $response->headers->set('Content-Disposition', 'attachment; filename="teams.csv"');

    return $response; 
```

如果你愿意，你可以用新的响应和 response->setContent 替换渲染调用。

您对控制器内没有返回语句的评论令人费解。控制器返回响应。让框架负责将内容发送到浏览器。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-02T15:06:04.980

我意识到这篇文章有点老了，奇怪的是，除了 stackoverflow 上的这篇文章之外，几乎没有关于如何在 symfony 2 中进行 CSV 导出的好的资源。

无论如何，我将上面的示例用于客户竞赛网站，并且效果很好。但是今天我收到了一封电子邮件，在我自己测试之后，代码已经损坏 - 我能够使用少量结果进行下载，但是数据库现在导出了超过 31,000 行，它要么简单地显示文本，要么使用chrome，基本上什么也没做。

对于任何有大量数据导出问题的人，这就是我设法开始工作的，基本上是按照 Cerad 建议的替代方式：

```
 $filename = "export_".date("Y_m_d_His").".csv";
    $response = $this->render('AppDefaultBundle:Default:csvfile.html.twig', array('data' => $data));

    $response->setStatusCode(200);
    $response->headers->set('Content-Type', 'text/csv');
    $response->headers->set('Content-Description', 'Submissions Export');
    $response->headers->set('Content-Disposition', 'attachment; filename='.$filename);
    $response->headers->set('Content-Transfer-Encoding', 'binary');
    $response->headers->set('Pragma', 'no-cache');
    $response->headers->set('Expires', '0');

    $response->prepare();
    $response->sendHeaders();
    $response->sendContent(); 
```

编辑：经过更多测试和提高允许的最大秒数后，我意识到以前的代码正在打印顶部的标题，所以我更新了代码。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-08-26T05:46:14.173

这对我导出 CSV 和 JSON 很有用。

Twig 文件命名为：export.csv.twig、export.json.twig

控制器：

```
class PrototypeController extends Controller {

public function exportAction(Request $request) {

    $data = array("data" => "test");

    $format = $request->getRequestFormat();

    if ($format == "csv") {
        $response = $this->render('PrototypeBundle:Prototype:export.' . $format . '.twig', array('data' => $data));
        $filename = "export_".date("Y_m_d_His").".csv";
        $response->headers->set('Content-Type', 'text/csv');
        $response->headers->set('Content-Disposition', 'attachment; filename='.$filename);

        return $response;
    } else if ($format == "json") {
        return new Response(json_encode($data));
    }
}
} 
```

路由：

```
prototype_export:
    pattern:  /export/{_format}
    defaults: { _controller: PrototypeBundle:Prototype:export, _format: json }
    requirements:
        _format:  csv|json 
```

树枝：

export.csv.twig（在这里做逗号分隔的事情，这只是一个测试）

```
{% for row in data %}
{{ row }}
{% endfor %} 
```

export.json.twig（数据发送json_encoded，这个文件是空的）

希望这可以帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-06-29T15:32:24.190

这就是我设法让 Silex 返回 csv 的方法：

```
// $headers in an array of strings
// $results are the records returned by a PDO query
 $stream = function() use ($headers, $results) {
    $output = fopen('php://output', 'w');
    fputcsv($output, $headers);
    foreach ($results as $rec)
    {
        fputcsv($output, $rec);
    }

    fclose($output);
};

return $app->stream($stream, 200, array(
    'Content-Type' => 'text/csv',
    'Content-Description' => 'File Transfer',
    'Content-Disposition' => 'attachment; filename="test.csv"',
    'Expires' => '0',
    'Cache-Control' => 'must-revalidate',
    'Pragma' => 'public',
)); 
```

您可能还需要使用 Javascript 做一些 Jiggery Poker（我正在通过 AJAX 下载），但这篇[文章](https://stackoverflow.com/questions/46638343/download-csv-file-as-response-on-ajax-request)是我让它工作所需的全部内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-09-07T05:30:41.247

您可以在每种情况下使用简单的功能来导出 csv 以供下载...

```
public function getResponse(array $data, $filename, $headers = array())
{
    if(substr(strtolower($filename), -4) == '.csv') {
        $filename = substr($filename, 0, -4);
    }

    $tmpFile = $this
        ->_getContainer()
        ->get('kernel')
        ->getRootDir()
        . '/../var/tmp_'.substr(md5(time()),0,5);

    if(file_exists($tmpFile)) unlink($tmpFile);

    $handle = fopen($tmpFile, 'w');

    foreach ($data as $i => $row) {

        $row = (array) $row;

        if($i == 0) fputcsv($handle, array_keys($row));

        fputcsv($handle, $row);

    }

    fclose($handle);

    $Response = new Response(file_get_contents($tmpFile));

    unlink($tmpFile);

    $filename = preg_replace('[^a-z0-9A-Z_]', '', $filename);

    $headers = array_merge([
        'Expires' => 'Tue, 01 Jul 1970 06:00:00 GMT',
        'Cache-Control' => 'max-age=0, no-cache, must-revalidate, proxy-revalidate',
        'Content-Disposition' => 'attachment; filename='.$filename.'.csv',
        'Content-Type' => 'text/csv',
        'Content-Transfer-Encoding' => 'binary',
    ], $headers);

    foreach ($headers as $key => $val) {
        $Response->headers->set($key, $val);
    }

    return $Response;
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2014-10-07T12:14:50.060

使用 Sonata 的 Exporter 怎么样：

```
use Exporter\Writer\CsvWriter;
/**
 * @param array $orders
 */
public function exportToCsv($orders)
{
    $rootdir = $this->get('kernel')->getRootDir();
    $filename = $rootdir . '/data/orders.csv';
    unlink($filename);
    $csvExport = new CsvWriter($filename);
    $csvExport->open();
    foreach ($orders as $order)
    {
        $csvExport->write($order);
    }
    $csvExport->close();
    return;

} 
```

如果文件已经存在，它会崩溃，因此 unlink-command。

# javascript - 将“this”引用到自定义变量

> ID：10307051
> 
> 赞同：1
> 
> 时间：2012-04-24T22:42:28.010
> 
> 标签：javascript, this

我正在做这样的事情：

```
var talkAPI = {
    init: function(){
        setInterval(function(){
            this.speak();
        },1000);
    },
    speak: function(){
         //Something else
    }
}; 
```

但是，我发现这并没有像我预期的那样工作。所以我做了一些测试，我发现`this`in`setInterval`指的是`Window`. 这不是我想要的。那么我该如何重新`this`参考`talkAPI`？因为我不想这样做：

```
setInterval(function(){
    window.talkAPI.speak();    //Not so good
},1000); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T22:44:48.320

您需要保存原件`this`以在回调中使用

```
init: function() {
    var self = this;
    setInterval(function(){
        self.speak();
    },1000);
}, 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T23:00:46.577

问题在于，在 JavaScript 中，`this`完全由函数的调用*方式*定义，而不是函数的定义位置（就像在其他语言中使用该关键字一样）。所以`setInterval`调用你给它的函数的方式，`this`没有设置为任何特定的（因此默认为全局对象，它`window`位于浏览器上）。更多信息：[*你必须记住`this`*](http://blog.niftysnippets.org/2008/04/you-must-remember-this.html)

使用您引用的代码，您有两个选择：

1.  正如 Kolink 评论的那样，由于您的对象是单例并且`init`函数关闭了`talkAPI`变量，所以没有任何理由不能只使用`talkAPI`：

    ```
    var talkAPI = {
        init: function(){
            setInterval(function(){
                talkAPI.speak();    // <=== Only change is here
            },1000);
        },
        speak: function(){
             //Something else
        }
    }; 
    ```

2.  更一般的答案，它适用于单例和由构造函数创建的对象等，是保留 的值`this`，[如 JaredPar 所述](https://stackoverflow.com/a/10307068/157247)：

    ```
    var talkAPI = {
        init: function(){
            var self = this;        // <=== Create a variable to close over
            setInterval(function(){
                self.speak();    // <=== Use it
            },1000);
        },
        speak: function(){
             //Something else
        }
    }; 
    ```

在这两种情况下，这些函数都有一个持久的、实时的链接到它们关闭的符号，这就是它们可以使用它们的原因。以这种方式绑定数据的函数称为*闭包*。更多：[*闭包并不复杂*](http://blog.niftysnippets.org/2008/02/closures-are-not-complicated.html)

# python - 混合字母的实数排序列表

> ID：10307057
> 
> 赞同：3
> 
> 时间：2012-04-24T22:43:18.110
> 
> 标签：python, django, postgresql, sorting

我有一个必须排序的数据列表，遗憾的是这些对象的命名方案不是很一致。数据是一个字符串列表，这些字符串通常是实数，但有时末尾有一个字母。此列表中可接受值的一些示例如下所示：

```
# this is how it should be sorted
['1', '1.1', '1.2', '2', '2.1A', '2.1B', '2.2A', '101.1', '101.2'] 
```

由于这些在数据库中，我的第一个想法是使用以下 django 方法返回排序后的结果，但它返回如下。

```
#took out unneeded code
choices = [l.number for l in Locker.objects.extra(
               select={'asnumber': 'CAST(number as BYTEA)'}).order_by('asnumber')]
print choices
==> ['1', '1.1', '101.1', '101.2', '2', '2.1A', '2.1B', '2.2A'] 
```

遗憾的是，它无法按应有的方式对其进行排序。所以我的新计划是编写一个可以与 python`sorted`方法一起使用的方法，但我仍然不确定如何编写这个。我需要找到一种按字符串的实数部分排序的方法，然后作为辅助排序，按末尾附加的字母排序。

关于去哪里的任何建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T00:40:09.890

让 DBMS 做排序，这是它非常擅长的。您几乎无法与您的应用程序的性能相媲美。

如果你得到的只是带有 A 或 B 的小数，你可以简单地：

```
SELECT *
FROM  (
   SELECT unnest(
    ARRAY['1', '1.1', '1.2', '2', '2.1A', '2.1B', '2.2A', '101.1', '101.2']) AS s
   ) x
ORDER  BY rtrim(s, 'AB')::numeric, s; 
```

完全按照要求订购，而且速度也很快。带有`ARRAY`and的子选择`unnest()`仅用于构建快速测试用例。`ORDER BY`条款是最重要的——在[`rtrim()`手册中](http://www.postgresql.org/docs/current/interactive/functions-string.html#FUNCTIONS-STRING-OTHER)。

如果涉及其他角色，您可能需要更新您的问题以完成图片。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T23:04:39.080

```
x = ['1', '1.1', '1.2', '2', '2.1A', '2.1B', '2.2A', '101.1', '101.2']

#sort by the real number portion

import string

letters = tuple(string.ascii_letters)

def change(x):
    if x.endswith(letters):
        return float(x[:len(x) -1])
    else:
        return float(x)

my_list = sorted(x, key = lambda k: change(k)) 
```

结果：

```
>>> my_list
['1', '1.1', '1.2', '2', '2.1A', '2.1B', '2.2A', '101.1', '101.2'] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T22:53:03.470

最后我过早地概括为任意数量的字母：

```
from itertools import takewhile

def sort_key(value):
    cut_point = len(value) - len(list(takewhile(str.isalpha, reversed(value))))
    return (float(value[:cut_point]), value[cut_point:])

sorted((
    l.number
    for l in Locker.objects.extra(select={'asnumber': 'CAST(number as BYTEA)'})
), key = sort_key) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T23:03:44.010

将字符串拆分为元组 - 一个实数（将其转换为浮点数或十进制数）和一个通常为空的字符串。如果您对元组进行排序，并使用 python 的内置排序（timesort），它应该非常快。

如果您的实数中允许使用科学记数法，请小心，例如 1e10。

如果以后有任何可能在比较中出现额外的复杂性，请使用类而不是元组。但是元组可能会更快。然后定义一个或多个比较函数（取决于您使用的是 python 2.x 还是 3.x）。

元组比较元素 0，然后是元素 1，等等。

您的类替代方案需要有**cmp**方法或 3.x 等效方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-24T23:49:40.727

将字符串存储为字符串然后对其进行解析以对其进行排序似乎是错误的方法。如果你真正拥有的是

*   主要号码
*   次要号码
*   可选修订

然后我强烈建议将其存储为两个整数和一个文本字段。对major_number、minor_number、revision 排序将完全按预期工作。您可以将 asnumber 定义为数据库级别的视图，也可以将其定义为基于三个基数的类以及关联的`__cmp__()`.

# android - 如何通过网络发送大量（x，y）坐标？

> ID：10307078
> 
> 赞同：3
> 
> 时间：2012-04-24T22:46:11.933
> 
> 标签：android, ruby, google-app-engine, networking, heroku

我正在制作一个需要折线图的 Android 应用程序，因此我需要来自服务器的 (x,y) 坐标。

我们正在使用 Ruby on Rails 和 Heroku 构建后端（尽管我们也在考虑使用 Google AppEngine）。

通过网络（以 JSON 编码？）将数百个（x，y）坐标发送到 Android 设备的最佳方式是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-25T00:31:53.070

如果您非常关心带宽，请将坐标打包成二进制格式。例如，假设 (x,y) 坐标的二维网格为 32 位整数。使用红宝石：

```
points = [[107897,598654], [876432,30001], [15,754689]]
# => [[107897, 598654], [876432, 30001], [15, 754689]]

# json size
points.to_json.length
# => 44

# make a byte stream of points
data = points.flatten.pack("V*")
# => "y\xA5\x01\x00~\"\t\x00\x90_\r\x001u\x00\x00\x0F\x00\x00\x00\x01\x84\v\x00"

# binary size
data.length
# => 24

# read a byte stream to points
points = data.unpack("V*").each_slice(2).to_a
# => [[107897, 598654], [876432, 30001], [15, 754689]] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T05:57:14.597

由于您正在生成折线图，您可能希望从 Google Chart 服务的简单和扩展[文本编码](https://developers.google.com/chart/image/docs/data_formats#simple)中获得灵感。主要收获是您不需要传输实际值；只是它们的相对值和限制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T23:44:30.983

最好的方法可能是用`JSON`or对其进行编码`XML`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T23:56:42.290

我没有 ruby​​ 经验，但是您可以按顺序发送坐标，用换行符分隔，在 XML 中（可能类似于：`<coordinate use='errorbar'>1,2</coordinate>`对于每个坐标 [在您的 ruby​​ 脚本中]），用换行符分隔，然后下载结果安卓使用：

```
public static String[] download(String web_url) throws IOException{
    URL website = new URL(web_url);
    BufferedReader in = new BufferedReader(
              new InputStreamReader(
              website.openStream()));
    String input;
    ArrayList<String> stringList = new ArrayList<String>();
    while ((input = in.readLine()) != null) {
        stringList.add(input);
    }
    String[] itemArray = new String[stringList.size()];
    String[] returnedArray = stringList.toArray(itemArray);
    return returnedArray;
}
// Of course, call this function with web_url as the URL to your script 
```

这将为您提供 XML 输出，每行作为数组中的一个条目，然后您只需解析 XML。如果你确定你永远不需要额外的数据，你可以用纯文本发送它，而不需要解析 XML。

# php - 它只显示一个文件名

> ID：10307082
> 
> 赞同：-4
> 
> 时间：2012-04-24T22:46:57.863
> 
> 标签：php, javascript, jquery, json

我有一个 $_SESSION 变量，它应该显示已上传文件的名称。问题是它没有这样做，它只显示 1 个文件和 1 个文件的文件名。例如，如果我上传文件“jellyfish.png”和“tulips.png”，它应该显示文件名“jellyfish.png”和“tulips.png”，`$_SESSION['fileImage'];`但它会将两个文件名都显示为像这样的名字：“jellyfish.png”和“jellyfish.png”。

当我为上面的示例执行 a 时，无论上传哪个文件`var_dump($_SESSION ['fileImage']);`，它都会输出：`string(13) "Jellyfish.jpg"`如果我刷新浏览器并假设我上传到服务器的最后一个文件是“tulips.png”，那么它会`string(10) "tulips.jpg"`为每个文件输出这个：，无论在下次刷新之前上传哪个文件。

有谁知道如何解决这个问题，以便在 $_SESSION 变量下显示每个上传文件的正确文件名？

下面是php脚本：

```
<?php

session_start();

$dirImage = "ImageFiles/";

if (isset ( $_FILES ['fileImage'] ) && $_FILES ["fileImage"] ["error"] == UPLOAD_ERR_OK) {

    $_SESSION ['fileImage'] = $_FILES ['fileImage']['name'];

    $fileName = $_FILES ['fileImage'] ['name'];

    $fileExt = pathinfo ( $fileName, PATHINFO_EXTENSION );
    $fileExt = strtolower ( $fileExt );

    $fileDst = $dirImage . DIRECTORY_SEPARATOR . $fileName;
    $filePrifix = basename ( $fileName, "." . $fileExt );
    $i = 0;
    while ( file_exists ( $fileDst ) ) {
        $i ++;
        $fileDst = $dirImage . DIRECTORY_SEPARATOR . $filePrifix . "_" . $i . "." . $fileExt;

    }
    // Move the file

    if (count ( $errors ) == 0) {
        if (move_uploaded_file ( $fileTemp, $fileDst )) {
            $result = 1;

        }
    }

}

?>

  <script language="javascript" type="text/javascript">window.top.stopImageUpload(<?php echo $result;?>);</script> 
```

下面是包含 JSON 的 Javascript 代码：

```
function stopImageUpload(success){

      var imagename = <?php echo json_encode(isset($_SESSION ['fileImage']) ? $_SESSION ['fileImage'] : null); ?>;
      var result = '';
      if (success == 1){
         result = '<span class="msg">The file was uploaded successfully!</span><br/><br/>';
         $('.listImage').append(imagename + '<br/>');
      }
      else {
         result = '<span class="emsg">There was an error during file upload!</span><br/><br/>';
      }

return true;

}

<?php
var_dump($_SESSION ['fileImage']);
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T22:56:15.067

会话不起作用，因为您复制了我编写的脚本并删除了问题，而不是第三次将其添加为新问题.. 如果您自己编写脚本，您应该能够纠正那个简单的错误

让这是你最后一次这样做

代替

```
 $_SESSION ['fileImage'] = $_FILES ['fileImage']['name']; 
```

和

```
 $_SESSION ['fileImage'][] = $_FILES ['fileImage']['name']; 
```

# javascript - Javascript 还原

> ID：10307085
> 
> 赞同：0
> 
> 时间：2012-04-24T22:47:06.300
> 
> 标签：javascript, variables

我会稍微简化一下，但我的网站中有一些代码以一种方式显示一些元素，假设我有这个：

“我有一个苹果”

我正在使用一些 JavaScript，因此当下拉列表变为橙色时，现在会写入 p 标签：

“我有一个橙子”

当我在我拥有的表单上单击提交时，该新值被传递到数据库，但页面没有刷新。当我去创建一个新条目时，我的初始值为：

“我有一个橙子”

但我想如果它恢复到它的初始状态：

“我有一个苹果”

有没有办法告诉网站，一旦提交完成，清除所有更改 - 无需刷新？

这是我最初的 JavaScript：

```
function getRequirements(client_name,location) {        
var strURL="display/getRequirements.php?client_name="+client_name+"&location="+location;
var req = getXMLHTTP();

    if (req) {
        req.onreadystatechange = function() {

            if (req.readyState == 4) {
                // only if "OK"
                if (req.status == 200) {                        
                    document.getElementById('requirementsdiv').innerHTML=req.responseText;                      
                } else {
                    alert("There was a problem while using XMLHTTP:\n" + req.statusText);
                }
            }               
        }           
        req.open("GET", strURL, true);
        req.send(null);
    }       
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T22:49:26.230

一种解决方案是向发送 AJAX 请求的按钮添加一个侦听器，然后将变量恢复为原始状态。

您可以调用一个函数`revert()`，根据需要重置所有变量。

例如，使用 JQuery...

```
$('#button').click(function(){
   $.get("myurl",function(data){
     if(data.status == 200){
       //Successful AJAX request.
       revert();
     }
   });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T22:50:07.807

DOM 本身并不记录更改，因此只跟踪当前状态。

您自己的代码可以跟踪页面的初始 innerHTML 或您所做的更改，并且在 ajax 调用之后，您的代码可以将页面恢复到其初始状态。没有 javascript 函数可以自动为您执行此操作，而无需重新加载某种页面。

跟踪您修改的每个元素及其原始状态并不难，然后当您想要恢复页面时，您只需循环浏览该元素列表并将内容恢复到最初的方式曾是。

这是一个如何实现自己跟踪更改的想法。您`markElement()`在更改任何元素之前立即调用。`restoreElements()`当你想恢复它们时，你打电话。

```
var changedElements = {};
var changedCntr = 1;

// call this right before you change the contents of any element 
// that you want later restored
function markElement(elem) {
    if (!elem.id) {
        elem.id = "_changeCnt" + changedCntr++;
    }
    // if we haven't already saved the state of this element, save it now
    if (!(elem.id in changedElements)) {
        changedElements[elem.id] = elem.innerHTML;
    }
}

// call this when you want to restore all elements
function restoreElements() {
    for (var id in changedElements) {
        var elem = document.getElementById(id);
        elem.innerHTML = changedElements[id];
    }
    changedElements = {};
} 
```

您可能应该只在叶节点（没有子节点的元素）上调用 markElement，以便在执行还原时不会冒丢失任何事件处理程序的风险。

注意：此代码仅处理对元素的更改，而不是创建/删除，除非您在创建/删除子对象之前在父节点上调用 markElement。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T22:51:13.893

如果您将其设置为表单域，则只需重置表单即可。如果您不希望用户能够键入，只需添加该`readonly`属性，并可选择将其设置为不再看起来像输入元素。

# spring - log4j 文件在 JBOSS 7.1.1 中不跟踪任何内容

> ID：10307086
> 
> 赞同：0
> 
> 时间：2012-04-24T22:47:06.413
> 
> 标签：spring, jboss, log4j

我在 JBoss 7.1.1.FINAL 中使用 log4j 创建了一个 spring 应用程序，这是我的 log4j 配置：

```
# Log4j level and names.
log4j.rootLogger=INFO, stdout, fileAppender
# Log4j relative path.
dir=${myWebapp-instance-root}
file=WEB-INF/logs/app.log
target=${dir}/${file}
# Used only for development.
log4j.appender.stdout=org.apache.log4j.ConsoleAppender
log4j.appender.stdout.layout=org.apache.log4j.PatternLayout
log4j.appender.stdout.layout.ConversionPattern=%d{ISO8601} [%t] %-5p (%F\:%L) \u2013 %m%n
log4j.logger.net.sf.ehcache=TRACE
# Log4j internal message debug , only on console .
log4j.debug=true
# File appender used in production.
log4j.appender.fileAppender=org.apache.log4j.RollingFileAppender
#log4j.appender.fileAppender.File=${app.logdir}/app.log
log4j.appender.fileAppender.File=${target}

log4j.appender.fileAppender.MaxFileSize=1MB
log4j.appender.fileAppender.MaxBackupIndex=5

log4j.appender.fileAppender.layout=org.apache.log4j.PatternLayout
log4j.appender.fileAppender.layout.ConversionPattern=%d{ISO8601} %t %p %c \u2013 %m%n 
```

目录和文件已创建，但在 app.log 中没有任何内容（白色页面） Jboss 在运行应用程序时不会给出任何错误，这是 log4j 的一部分：

```
17:01:33,342 INFO  [org.apache.catalina.core.ContainerBase.[jboss.web].[default-host].[/projvehimerc]] (MSC service thread 1-1) Initializing log4j from [/opt/jboss-as-7.1.1.Final/standalone/deployments/projvehimerc.war/WEB-INF/log4j-webapp.properties]
17:01:33,351 INFO  [stdout] (MSC service thread 1-1) log4j: Parsing for [root] with value=[INFO, stdout, fileAppender].
17:01:33,352 INFO  [stdout] (MSC service thread 1-1) log4j: Level token is [INFO].
17:01:33,354 INFO  [stdout] (MSC service thread 1-1) log4j: Category root set to null
17:01:33,355 INFO  [stdout] (MSC service thread 1-1) log4j: Parsing appender named "stdout".
17:01:33,367 INFO  [stdout] (MSC service thread 1-1) log4j: Parsing layout options for "stdout".
17:01:33,414 INFO  [stdout] (MSC service thread 1-1) log4j: Setting property [conversionPattern] to [%d{ISO8601} [%t] %-5p (%F:%L) – %m%n].
17:01:33,416 INFO  [stdout] (MSC service thread 1-1) log4j: End of parsing for "stdout".
17:01:33,417 INFO  [stdout] (MSC service thread 1-1) log4j: Parsed "stdout" options.
17:01:33,418 INFO  [stdout] (MSC service thread 1-1) log4j: Parsing appender named "fileAppender".
17:01:33,421 INFO  [stdout] (MSC service thread 1-1) log4j: Parsing layout options for "fileAppender".
17:01:33,422 INFO  [stdout] (MSC service thread 1-1) log4j: Setting property [conversionPattern] to [%d{ISO8601} %t %p %c – %m%n].
17:01:33,423 INFO  [stdout] (MSC service thread 1-1) log4j: End of parsing for "fileAppender".
17:01:33,429 INFO  [stdout] (MSC service thread 1-1) log4j: Setting property [file] to [/opt/jboss-as-7.1.1.Final/standalone/deployments/projvehimerc.war//WEB-INF/logs/app.log].
17:01:33,430 INFO  [stdout] (MSC service thread 1-1) log4j: Setting property [maxBackupIndex] to [5].
17:01:33,430 INFO  [stdout] (MSC service thread 1-1) log4j: Setting property [maxFileSize] to [1MB].
17:01:33,431 INFO  [stdout] (MSC service thread 1-1) log4j: setFile called: /opt/jboss-as-7.1.1.Final/standalone/deployments/projvehimerc.war//WEB-INF/logs/app.log, true
17:01:33,432 INFO  [stdout] (MSC service thread 1-1) log4j: setFile ended
17:01:33,432 INFO  [stdout] (MSC service thread 1-1) log4j: Parsed "fileAppender" options.
17:01:33,433 INFO  [stdout] (MSC service thread 1-1) log4j: Parsing for [net.sf.ehcache] with value=[TRACE].
17:01:33,433 INFO  [stdout] (MSC service thread 1-1) log4j: Level token is [TRACE].
17:01:33,433 INFO  [stdout] (MSC service thread 1-1) log4j: Category net.sf.ehcache set to null
17:01:33,433 INFO  [stdout] (MSC service thread 1-1) log4j: Handling log4j.additivity.net.sf.ehcache=[null]
17:01:33,434 INFO  [stdout] (MSC service thread 1-1) log4j: Finished configuring. 
```

以下

```
17:01:36,680 INFO  [stdout] (Finalizer) log4j: Finalizing appender named [stdout].
17:01:36,681 INFO  [stdout] (Finalizer) log4j: Finalizing appender named [fileAppender]. 
```

就像我说的文件是创建但什么都没有，虽然级别是INFO，为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T23:29:16.780

确保您[排除](https://docs.jboss.org/author/display/AS71/How+To#HowTo-HowdoIuselog4j.propertiesorlog4j.xmlinsteadofusingtheloggingsubsystemconfiguration%3F)了带有[`jboss-deployment-structure.xml`](https://docs.jboss.org/author/display/AS71/Class+Loading+in+AS7#ClassLoadinginAS7-JBossDeploymentStructureFile). 在 JBoss AS 7.1.x 中，您需要排除 log4j 的服务器版本。不过，这应该在 7.2.x 中修复。

# python - Python MySQLdb插入问题

> ID：10307091
> 
> 赞同：0
> 
> 时间：2012-04-24T22:47:50.277
> 
> 标签：python, mysql, exception, mysql-python

我正在用 Python 编写一个简单的应用程序，它将监视我的 cpu 和 ram 的使用情况并将其放入 MySQL 数据库中以供将来处理这是我的代码：

```
import MySQLdb
import psutil

connection = MySQLdb.connect(host="localhost", port=8888, user="root", passwd="root", db="monitoring", unix_socket="/Applications/MAMP/tmp/mysql/mysql.sock")
c = connection.cursor()

while True:

    usage = psutil.cpu_percent(interval=1)

    c.execute("INSERT INTO cpu (usage) VALUES (%s)", (usage))

    c.execute("SELECT * FROM cpu")
    print c.fetchall() 
```

这是我用于[监控的库](http://code.google.com/p/psutil/)

这是 MySQL 数据库的转储：

```
 --
-- Table structure for table `cpu`
--

    CREATE TABLE `cpu` (
      `id` int(12) NOT NULL AUTO_INCREMENT,
      `usage` float NOT NULL,
      `time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
      PRIMARY KEY (`id`)
    ) ENGINE=InnoDB  DEFAULT CHARSET=utf8 COLLATE=utf8_bin AUTO_INCREMENT=2 ; 
```

但是，在进行 INSERT 时我无法修复此错误：

```
_mysql_exceptions.ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'usage) VALUES (12.9)' at line 1") 
```

有什么提示可以解决这个问题吗？对不起，但我是 Python 新手 :)

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T22:59:40.703

这不是 Python 问题。问题是这`usage`是 MySQL 中的保留字。您应该将列的名称更改为其他名称，或者使用反引号在代码中引用它：

```
c.execute("INSERT INTO cpu (`usage`) VALUES (%s)", (usage)) 
```

# java - java方法返回一个类的实例

> ID：10307093
> 
> 赞同：9
> 
> 时间：2012-04-24T22:48:04.430
> 
> 标签：java, generics, java-7

我有这个代码：

```
public <T extends Scrapper> Class<T> getScrapper() {
    return MyScrapper.class;
} 
```

`MyScrapper`是一个实现`Scrapper`接口的类。为什么这不起作用？你在JDK7中收到以下错误：

```
error: incompatible types
required: Class<T>
found:    Class<MyScrapper>
where T is a type-variable:
T extends Scrapper declared in method <T>getScrapper() 
```

PS 老实说，我已经尝试了整整 30-40 分钟的搜索。

更新：如果我声明该方法`public Class<? extends Scrapper> getScrapper() {`有效。但我仍然不明白为什么原始声明没有编译。它出什么问题了？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-24T22:59:31.970

对于像这样的泛型方法`getScrapper()`，方法的*调用者*确定该方法的实际类型参数是什么（`T`在这种情况下）。`Scrapper`调用者可以选择as的任何子类型`T`，并且您的方法（始终返回`MyScrapper.class`）不会返回正确的类。

鉴于该方法的签名，该方法的调用者期望能够做到这一点：

```
Class<MyOtherScrapper> c = foo.<MyOtherScrapper>getScrapper(); 
```

将方法更改为返回`Class<? extends Scrapper>`使其不再是泛型方法......调用者无需设置类型参数。相反，签名说该方法返回*某个未知子类型*的类对象`Scrapper`，并且`MyScrapper.class`确实符合要求。

# android - 使用列表视图将按钮添加到相对布局

> ID：10307097
> 
> 赞同：0
> 
> 时间：2012-04-24T22:48:47.517
> 
> 标签：android, xml

我正在尝试向我的 relativelayout 添加两个按钮，其中包括一个列表视图

我只能让一个出现。

我希望它们位于我的列表视图的顶部，有点像标签..

[http://m4x.co/orig.jpg](http://m4x.co/orig.jpg)

[http://m4x.co/new.jpg](http://m4x.co/new.jpg)

第一张图片是它的样子，第二张和我想要的类似。

我本来想在这里发帖的，但是“很抱歉，但作为一种垃圾邮件预防机制，新用户不允许发布图片。获得超过 10 名发布图片的声望。”

```
 <?xml version="1.0" encoding="utf-8"?>
<RelativeLayout
xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="wrap_content" 
android:layout_height="wrap_content"
android:orientation="vertical"
android:background="#FFFFFF"

>

<Button android:id="@+id/plus"
android:background="@drawable/selector"
android:layout_width="75dip"
android:layout_height="75dip"
android:layout_alignParentBottom="true"

/>
<Button android:id="@+id/main2"
     android:layout_height="20dp" 
     android:layout_width="40dp" 
     android:hint="Notes"
     android:background="#FFFFFF"
     android:layout_above="@+id/list"
     >

</Button>
<Button android:id="@+id/main3"

     android:layout_height="20dp" 
     android:layout_width="40dp" 
     android:hint="Titles"
     android:background="#FFFFFF"
          android:layout_above="@+id/list">

</Button>
<ListView 
    android:layout_marginTop="70dp" 
    android:id="@android:id/list" 
    android:layout_width="fill_parent"
    android:layout_height="wrap_content" 
      android:layout_above="@+id/plus"
      android:smoothScrollbar="true"
      android:background="#FFFFFF" android:cacheColorHint="#FFFFFF"
  android:fastScrollEnabled="true" android:clickable="true"
  android:layout_marginBottom="10dp" 
          android:divider="#000000"
    android:dividerHeight="1px"
>

</ListView>

<TextView android:id="@android:id/empty" android:layout_width="wrap_content"
android:layout_height="wrap_content" android:text="@string/noQ" 

 />

    </RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T23:33:02.450

我认为这与您正在寻找的内容有关：

```
<?xml version="1.0" encoding="utf-8"?>
    <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:background="#000000"
        android:orientation="vertical" >

        <Button
            android:id="@+id/plus"
            android:background="@drawable/selector"
            android:layout_width="75dip"
            android:layout_height="75dip"
            android:layout_alignParentBottom="true" />

        <ListView
            android:id="@android:id/list"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_above="@+id/plus"
            android:layout_marginBottom="10dp"
            android:layout_marginTop="70dp"
            android:background="#FFFFFF"
            android:cacheColorHint="#FFFFFF"
            android:clickable="true"
            android:divider="#000000"
            android:dividerHeight="1px"
            android:fastScrollEnabled="true"
            android:smoothScrollbar="true" >
        </ListView>

        <Button
            android:id="@+id/main3"
            android:layout_width="40dp"
            android:layout_height="20dp"
            android:layout_alignParentTop="true"
            android:background="#FFFFFF"
            android:hint="Titles" />

        <Button
            android:id="@+id/main2"
            android:layout_width="40dp"
            android:layout_height="20dp"
            android:layout_alignParentTop="true"
            android:layout_marginLeft="16dp"
            android:layout_toRightOf="@+id/main3"
            android:background="#FFFFFF"
            android:hint="Notes" />

        <TextView
            android:id="@android:id/empty"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_below="@+id/main2"
            android:layout_centerHorizontal="true"
            android:layout_marginTop="20dp"
            android:text="@string/noQ" />

    </RelativeLayout> 
```

# c# - 将事件更改的项目添加到列表

> ID：10307101
> 
> 赞同：1
> 
> 时间：2012-04-24T22:49:05.487
> 
> 标签：c#

我是 C# 的新手，特别是（当然！）事件......

在我的代码中，我们从一个事件中获取一个元素 T，并希望将它添加到一个列表（List）中。

由于 T 被签名为“OnPropertyChanging”，它在我的代码中随处变化，因此 List 上的所有成员都是相同的。那么我应该如何实现将 T 的所有过去值保存在 List 中？

提前致谢。

编辑（试图更好地解释它）：

我有一个通过 DDE 接收数据的应用程序，我用它来执行实时计算。到现在为止，没问题。当我必须使用以前的数据时，我的问题就开始了，因为我无法将它们保存在列表中。

我在第一次读取数据时创建了一个列表并将值添加到其中：

```
ticks = new List<Tick> { tick };   // where tick comes via DDE 
```

在第二次 reding 之后，我想使用列表的最后一个值并将其与最新的值进行比较：

```
Tick prevTick = ticks.Last();
Tick currTick = tick;              // this tick is different from the former 
```

但是我验证 prevTick 等于 currTick。显然，“PropertyChange”会在程序的所有实例中更改刻度，在我有机会将其传递给 prevTick 之前修改刻度的内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T19:04:19.943

假设`Tick`是一个类，`prevTick`并且`currTick`很可能是同一个实例，并且提供该`Tick`实例的底层代码只是更新此实例存储的值。这将解释您认为会`PropertyChange`更改所有刻度实例的想法 - 它实际上只是一个实例

我将为包含的每条数据创建自己的类`Tick`，并为您的历史列表填充此类的新实例。如果您只需要每个 中的一个数字`Tick`，那么您可以只需要一个`List<int>`来存储您的历史记录。

# foreach - 在每个打印语句之后打印逗号，除了最后一个

> ID：10307105
> 
> 赞同：0
> 
> 时间：2012-04-24T22:49:18.053
> 
> 标签：foreach, tcl

我的 foreach 循环逻辑需要一些帮助：

除了循环中的最后一条语句外，我需要在每个打印语句之后放置一个逗号

前任：`blah,blah2,blahlast`

以下代码即使在最后一条语句之后也放置逗号。

```
 foreach row $regions {
            set name [lindex $row 0]
            set id [lindex $row 1]
            puts "{'name':'$name', 'val':'$region_id'}"
            puts ","

        } 
```

也许如果我计算它循环的次数，我可能会检查一个 if 条件以将逗号放在最后一次迭代

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T05:43:34.803

另一种方法是建立一个要打印的项目列表并在最后加入它：

```
set lines {}
foreach row $regions {
    set name [lindex $row 0]
    set region_id [lindex $row 1] ;# changed this from id to region_id, seemed right
    lappend lines "{'name':'$name', 'val':'$region_id'}"
}
puts [join $lines ",\n"] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-24T23:22:40.980

诀窍是在除第一个迭代之外的所有迭代上打印逗号（也就是说，反转你的逻辑）：

```
set xs {a b c}
set s ""
set need_comma false
foreach x $xs {
  if {$need_comma} {
    append s ,
  } else {
    set need_comma true
  }
  append s $x
}
puts $s 
```

会产生

```
a,b,c 
```

请注意，您似乎只是在寻找[`join`](http://www.tcl.tk/man/tcl8.5/TclCmd/join.htm)命令。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T17:20:33.593

I voted +1 for RHSeeger because that is what I would do. However, it seems you are trying to convert a TCL list to Python's list. If that is the case, you don't even have to worry about suppressing the last comma: Python allows that:

```
>>> li = [1,2,3,]
>>> len(li)
3 
```

That means, your current solution works. Don't worry about the last comma.

# linux - 使用 tr / sed / awk 重新格式化特定字符周围的空格

> ID：10307115
> 
> 赞同：1
> 
> 时间：2012-04-24T22:50:14.170
> 
> 标签：linux, bash, sed, awk, tr

输入文件如下所示：

```
Header :  

            Data  
  Header2 :

data for header2

Header3 : data 3something 
```

我做了什么：

```
sed "s/^ *//;s/ *$//;s/ \{1,\}/ /g" infile | tr -s "\n"  > outfile 
```

现在是这样的：

```
Header :  
Data  
Header2 :  
data for header2  
Header3 : data 3something 
```

我一直在寻找的是：

```
Header :  
Data  
Header2 :  
data for header2  
Header3 :  
data 3something 
```

那么，我在这里缺少什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T22:58:05.383

通过稍微修改你的一个班轮，我认为你可以让它工作：

```
sed "s/^ *//;s/ *$//;s/ \{1,\}/ /g;s/: */:\n/" infile | tr -s "\n"  > outfile 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T23:34:13.723

这可能对您有用：

```
sed '/^$/d;s/^\s*//;/:\s*\(\S\+\)/s//:\n\1/' file
Header :  
Data  
Header2 :
data for header2
Header3 :
data 3something 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T15:48:40.453

```
awk '$1 = $1 { if(NR!=8) print } END { print $1, $2 "\n" $3, $4 }' file 
Header :
Data
Header2 :
data for header2
Header3 :
data 3something 
```

# silverlight - 从 MainPage_Loaded 运行时，VisualTreeHelper.GetChildrenCount 返回 0

> ID：10307116
> 
> 赞同：1
> 
> 时间：2012-04-24T22:50:23.703
> 
> 标签：silverlight, windows-phone-7

在我的 WP7 应用程序中，我正在使用这种方法`TextBlock`在`ToggleButton`. [https://stackoverflow.com/a/1759923/1339857](https://stackoverflow.com/a/1759923/1339857)

当我在应用程序运行时拨打电话时，它工作正常。
如果我尝试从 发出完全相同的调用`MainPage_Loaded`，则`FindChild`返回`null`。

这是简单的调用

```
TextBlock myText = FindChild<TextBlock>(myToggle, "toggleTitle");  
myText.Text = "Some text"; 
```

看起来是因为`VisualTreeHelper.GetChildrenCount`正在返回 0。

为什么当应用程序正在运行而不是 from 时它会有一个值`MainPage_Loaded`？`MainPage_Loaded`在触发事件之前等待应用程序加载的目的不是吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T23:02:10.940

您可以用来处理此问题的一个技巧是在 Loaded 事件上将您的呼叫排队。因此，在 MainPage_Loaded 处理程序中，将您的调用包装在[Dispatcher.BeginInvoke](http://msdn.microsoft.com/en-us/library/cc190259%28v=vs.95%29.aspx)中。

```
Dispatcher.BeginInvoke(() => {
  TextBlock myText = FindChild<TextBlock>(myToggle, "toggleTitle");  
  myText.Text = "Some text";
} 
```

这会将您的调用添加到队列中，并且将在当前事件周期完成后调用（应该是在所有子项都已加载时）。

# vb.net - 如何解决此“对象引用未设置为对象的实例，使用新的”错误

> ID：10307118
> 
> 赞同：-2
> 
> 时间：2012-04-24T22:50:27.240
> 
> 标签：vb.net, multithreading, while-loop

我正在使用线程从文件中读取并处理内容。我有以下代码：

```
Dim line As String = Nothing
Dim result As String = Nothing
Dim solved As Boolean
While strReader.EndOfStream <> True
    SyncLock strReader
        line = strReader.ReadLine()
        result = "ERROR"
    End SyncLock
    solved = False
    While solved = False
        result = Process(line)
        If Not result.Contains("ERROR") Then
            solved = True
        End If
    End While
    //some code
End While 
```

它给了我这个错误：**If Not result.Contains("ERROR") Then**

带标签的效果很好，但我读到它们不适合编码。

**我怎样才能摆脱这个错误？我究竟做错了什么？**

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T22:58:08.597

错误几乎说明了一切

```
Process(line) 
```

正在返回一个空值。修复`Process()`以返回非空值。

或者你可以这样做

```
If not result is nothing then 
  solved = not result.Contains("ERROR")
End if 
```

# objective-c - iOS自动注销应用程序

> ID：10307119
> 
> 赞同：1
> 
> 时间：2012-04-24T22:50:42.907
> 
> 标签：objective-c, ios5

我想创建一个计时器或类似的东西来在*x*分钟不活动后自动注销用户。我想以与美国银行应用程序相同的方式进行操作。BofA 应用程序执行此操作的方式是，即使将应用程序置于后台，它仍会跟踪时间。当达到时间限制时，将弹出一条通知，说明您正在注销。

当应用程序进入后台时，如何在不暂停计时器的情况下做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T03:06:03.180

我认为您可以做的最简单的事情就是注册您的 AppDelegate`NSNotificationCenter`以侦听来自所有（或特定）发件人的所有事件。

```
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(resetTimer) name:nil object:nil]; 
```

您需要注意传递`nil`给`name`and`object`参数，因为您会收到大量通知（甚至有些不是来自应用程序，即内存警告）。如果您知道或拥有特定事件名称和/或对象的列表，我会改为观察这些。

在您的`resetTimer`方法中，您将简单地使前一个计时器无效并创建一个新的计时器，该计时器将调用某个`logout`方法并将 iVar 设置为当前日期/时间（即 `timerStart = [NSDate now];`）

上述步骤将在前台处理您的应用程序。

当应用程序在后台运行时，计时器将停止工作。但是，当应用程序返回前台时，您可以计算`[NSDate now]`与您的`timerStart`iVar 之间的增量。如果增量大于某个间隔，则调用您的`logout`方法。如果没有，你可以打电话`resetTimer`重新开始你的计时器。

**编辑**

如果您希望后台应用程序提醒用户即将注销，您可以使用`UILocalNotification`. 您可以安排一个在应用程序进入后台时发出警报。当应用程序进入前台时，您可以取消该通知（并执行我上面提到的步骤）。

# iphone - 启动应用程序时显示密码/密码 - 故事板

> ID：10307120
> 
> 赞同：0
> 
> 时间：2012-04-24T22:50:45.253
> 
> 标签：iphone, objective-c, ios, login, storyboard

我试图在启动应用程序时显示密码/密码（模式视图控制器）。您可能会在 AppDelegate.h 中看到代码：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{

    if (![[NSUserDefaults standardUserDefaults] boolForKey:@"passcode_in"]) {
        //display passcode screen
        UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle:nil];
        UIViewController *vc = [storyboard instantiateViewControllerWithIdentifier:@"PasscodeViewController"];
        [vc setModalPresentationStyle:UIModalPresentationFullScreen];

        [self presentModalViewController:vc animated:NO]; 

     } else {
        NSLog(@"No Passcode Screen");
}

   return YES;
} 
```

问题是 AppDelegate 不支持显示模态视图控制器 (presentModalViewController)。我不会使用 .xib 文件，我的应用程序只会使用 Storyboard。有人知道它有什么问题吗？任何建议表示赞赏。

**解决**

我遵循了对我之前发布的问题之一的说明[https://stackoverflow.com/a/10303870/1344459](https://stackoverflow.com/a/10303870/1344459)我通过仅在 AppDelegate.m 中的两个方法**applicationDidEnterBackground**和**applicationWillTerminate**中为 PinCodeViewController(modal)添加一些代码来解决了这个问题启动应用程序。现在它工作得非常顺利。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T00:11:52.177

如果密码是登录的先决条件，那么将其作为登录路径的一部分可能是有意义的。

要在情节提要中执行此操作，请绘制一个导航控制器，删除您默认获得的 UITableViewController 根，并将您的 PasscodeViewController 设置为根。然后从那里添加一个 push segue 到 LoginViewController。

PasscodeViewController 中的逻辑与这里讨论的类似： On viewWillAppear：它可以检查是否满足密码要求。如果需要，让密码视图出现并完成它的工作。如果您已经有密码，请执行对 LoginViewController 的 segue。如果两者都不需要，请解雇。

最后，一旦 PasscodeViewController 收集到密码，它可以决定是否需要登录（执行 push segue 到 LoginViewController），或者只是启动应用程序（关闭）。

希望这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T23:33:31.743

我对同一问题的解决方案是在情节提要中创建另一个视图控制器，通过自定义 segue 将其链接到我的初始视图控制器，然后在 ViewController 的 viewDidLoad 方法中调用 segue。登录Segue.h

```
#import <UIKit/UIKit.h>
@interface LoginSegue : UIStoryboardSegue
@end 
```

登录Segue.m

```
 #import "LoginSegue.h"

@implementation LoginSegue

- (void)perform {
    UIViewController *src = (UIViewController *) self.sourceViewController;
    UIViewController *dst = (UIViewController *) self.destinationViewController;
    [UIView transitionWithView:src.navigationController.view duration:0.0
                       options:UIViewAnimationTransitionNone
                    animations:^{
                        [src.navigationController presentViewController:dst animated:NO completion:nil];
                        }
                    completion:NULL];
}
@end 
```

然后在情节提要中，选择您的 segue 并将 segue 类设置为 LoginSegue 并将标识符设置为您喜欢的任何内容。我的是@“toLogin”。并在您的 viewDidLoad 中包含以下内容：

```
[self performSegueWithIdentifier:@"toLogin" sender:self]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T23:35:26.827

`presentModalViewController`是[UIViewController](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/Reference/Reference.html)类的一个方法。您的 AppDelegate 是一个 NSObject 或 UIResponder 所以不会识别它。

您应该以非模态方式显示您的密码/密码视图，将其放在 Storyboard 的第一个 UIViewController 中。

如果您需要以模态方式显示它，即使没有必要，也可以从 Storyboard 的第一个 UIViewController 而不是 AppDelegate 呈现您的模态视图。

在你的 UIViewController 你应该写这样的东西：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
    UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle:nil];
    UIViewController *vc = [storyboard instantiateViewControllerWithIdentifier:@"PasscodeViewController"];
    [vc setModalPresentationStyle:UIModalPresentationFullScreen];

    [self performSelector:@selector(presentModal)
               withObject:nil
               afterDelay:0.0];
} 

- (void)presentModal {
    [self presentViewController:vc animated:NO completion:NULL];
} 
```

注意你需要`performSelector`。如果您不使用它，您的视图将不会显示。请注意，`presentModalViewController`现在已弃用，请`presentViewController`改用。

# jquery - 使用 jeditable 插件添加数据表形式的自定义验证

> ID：10307129
> 
> 赞同：1
> 
> 时间：2012-04-24T22:51:58.253
> 
> 标签：jquery, validation, datatables, jeditable

我对编辑数据表中的字段进行了验证，我对添加表单中只需要的字段进行了验证。我的问题是在表格的添加表单中，我有一个需要使用自定义验证的字段。所以我尝试设置一个自定义验证方法：

```
$.validator.addMethod("invalidTags", function(value, element){
    return value.match(/[^A-Z_.]/);
}, 'Tags may only contain ALL CAPS characters, underscores, or periods'); 
```

并试图将表单域连接到它

```
$("formAddNewRowTags").validate({
    rules: {
        tag: {
            required: true,
            invalidTags: false
        }
    }
 }); 
```

但这似乎不起作用。我是否应该在 .makeEditable 的定义中进行验证调用

```
"sAddNewRowFormId" : "formAddNewRowTags" 
```

反而？

# android - Android MediaPlayer prepareAsync 方法

> ID：10307131
> 
> 赞同：11
> 
> 时间：2012-04-24T22:52:32.177
> 
> 标签：android, asynchronous, android-mediaplayer, prepare

我有一个奇怪的问题。我将 prepareAsync 方法与 一起使用`MediaPlayer`，但我声明的侦听器从未被触发。我尝试`.mp3`从互联网（广播电台）流式传输实时信息。我为侦听器使用了内联方法，但我也尝试实现接口但没有成功。这是我的代码的一部分：

**在会员部分：**

```
String url = "http://<my_url>.mp3";
MediaPlayer mediaPlayer = new MediaPlayer(); 
```

**在活动中`onCreate()`：**

```
ToggleButton playButton = (ToggleButton) findViewById(R.id.playToggleButton);
playButton.setOnClickListener(this);
playButton.clearFocus();
playButton.setClickable(false);

mediaPlayer.setOnPreparedListener(new OnPreparedListener() {
    public void onPrepared(MediaPlayer mp) {
        ToggleButton playButton = (ToggleButton) findViewById(R.id.playToggleButton);
        playButton.setClickable(true);
        mp.start();
    }
});

preparePlayer(); 
```

**然后，`preparePlayer()`方法如下：**

```
private void preparePlayer() {
    if (mediaPlayer == null) {
        mediaPlayer = new MediaPlayer();
    }
    mediaPlayer.setAudioStreamType(AudioManager.STREAM_MUSIC);
    try {
        mediaPlayer.setDataSource(url);
        mediaPlayer.prepareAsync();

    } catch (IllegalArgumentException e) {
        Toast.makeText(
                MyStreamActivity.this,
                getResources().getString(R.string.erreurIllegalArgument),
                Toast.LENGTH_LONG).show();
        e.printStackTrace();
    } catch (IllegalStateException e) {
        Toast.makeText(
                MyStreamActivity.this,
                getResources().getString(R.string.erreurIllegalState),
                Toast.LENGTH_LONG).show();
        e.printStackTrace();
    } catch (IOException e) {
        Toast.makeText(
                MyStreamActivity.this,
                getResources().getString(R.string.erreurIO),
                Toast.LENGTH_LONG).show();
        e.printStackTrace();
    }
} 
```

**并且（仅作记录），`onDetroy()`我做清洁的地方：**

```
private void releaseMediaPlayer() {
    if (mediaPlayer != null) {
        if(mediaPlayer.isPlaying()) {
            mediaPlayer.stop();
        }
        mediaPlayer.release();
        mediaPlayer = null;
    }
}

@Override
protected void onDestroy() {
    super.onDestroy();
    releaseMediaPlayer();
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-24T23:24:28.307

您正在设置`OnPreparedListener`您`Activity`的 create 方法，稍后可能会`MediaPlayer`在您的方法中创建一个新`preparePlayer()`方法。任何新创建`MediaPlayer`的 ' 都不会有该`prepareListener`集合。您还应该添加一个`errorlistener`以了解发生了什么。

您可能希望将`setOnPreparedListener`呼叫移到

```
 if (mediaPlayer == null) {
    mediaPlayer = new MediaPlayer();
} 
```

以及`setOnErrorListener`像这样设置：

```
if (mediaPlayer == null) {
    mediaPlayer = new MediaPlayer();
    mediaPlayer.setOnErrorListener(....);
    mediaPlayer.setOnPreparedListener(new OnPreparedListener() {
        public void onPrepared(MediaPlayer mp) {
            ToggleButton playButton = (ToggleButton) findViewById(R.id.playToggleButton);
            playButton.setClickable(true);
            mp.start();
        }
    });
} 
```

请`e.printStackTrace();`改为

```
Log.e("tag", e.getMessage(), e); 
```

希望这会有所帮助，如果您有任何日志数据，请告诉我们，因为这也会很有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T18:27:16.913

结果，我忘了在我的内部方法之上提及“@Override”。像这样 ：

```
mediaPlayer.setOnPreparedListener(new OnPreparedListener() {
    @Override
    public void onPrepared(MediaPlayer mp) {
        ToggleButton playButton = (ToggleButton) findViewById(R.id.playToggleButton);
        playButton.setClickable(true);
        mp.start();
    }
}); 
```

现在一切正常。嗯......几乎，因为它需要永远缓冲......

# image - 如果图像是链接，如何从拖放中获取图像 URL？

> ID：10307132
> 
> 赞同：4
> 
> 时间：2012-04-24T22:52:53.070
> 
> 标签：image, url, drag-and-drop

我发现了很多不同的拖放实现，但它们似乎都是在图像没有嵌套在 <a href> 标记内的一般假设下运行的。

无论是浏览器、mac os 还是 windows，结果总是一样的：

*   拖动一个

    `< img src='http://www.lol.com/pic.jpg' />`

将以`http://www.lol.com/pic.jpg`html形式输入。或者，如果拖入桌面 - 它将保存实际图像。

*   拖动一个

    `< a href='http://www.lol.com/notgonnahappen.html'>< img src='http://www.lol.com/pic.jpg' />< /a>`

`http://www.lol.com/notgonnahappen.html`如果在桌面上拖动，将输入并创建一个 URL 链接。

无论如何要提取图像URL？而不是它所关联的链接？JS？爪哇？C＃？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-04T11:47:57.827

使用纯 Javascript，您可以尝试以下操作：

```
function drop(evt) {
    evt.stopPropagation();
    evt.preventDefault(); 
    var imageUrl = evt.dataTransfer.getData('text/html');
    var rex = /src="?([^"\s]+)"?\s*/;
    var url, res;
    url = rex.exec(imageUrl);
    alert(url[1]);
} 
```

这是一个有效的[演示](http://fiddle.jshell.net/4E92W/6/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T18:45:29.050

```
var data = $(e.dataTransfer.getData('text/html'));
var img = data.attr('src');
if (!img) 
    img = data.find("img").attr('src'); 
```

# javascript - 如何将参数传递给 addEventListener 中传递的侦听器函数？

> ID：10307136
> 
> 赞同：1
> 
> 时间：2012-04-24T22:53:06.573
> 
> 标签：javascript, dom

```
anItem.addEventListener("click", iRespond, false); 
```

问题是，我需要向 iRespond 传递一个参数，因为 iRespond 应该处理对许多项目的点击，我需要一种区分项目的方法。

我能怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T22:55:51.290

简单的关闭：

```
var foo = "bar";
e.addEventListener('whee',function(evt){
  iRespond(evt,foo);
},false); 
```

当一个简单的闭包不起作用时（因为您正在锁定一个正在变化的变量，例如在循环中），您需要在该值上创建一个新的闭包：

```
foo.addEventListener('bar',(function(jim){
  return function(evt){
    iRespond(evt,jim); // Surprise surprise, jim is available here!
  }
})(someValueToBeNamedJim), false); 
```

例如：

```
var buttons = document.querySelectorAll('button');
for (var i=buttons.length;i--;)}
  buttons[i].addEventListener('click',(function(j){
    return function(){ alert("You clicked on button #"+j); };
  })(i),false);
} 
```

*您可以毫无问题地选择在函数内部和外部将变量命名为相同的名称——例如使用`i`而不是`j`上面——但您可能会发现自己感到困惑。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T23:02:26.240

似乎没有人提供最简单的解决方案。将您的其他函数调用放在匿名函数中，如下所示：

```
anItem.addEventListener("click", function() {
    iRespond(your arg here);
}, false); 
```

或者，在许多情况下，您可以只引用`this`事件侦听器中的指针来查看您是从哪个对象调用的：

```
anItem.addEventListener("click", iRespond, false); 
```

然后，在`iRespond`：

```
function iRespond() {
    // this points to the item that caused the event so you can 
    // determine which one you are processing and then act accordingly
    // For example, this.id is the id of the object
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T22:58:42.267

有很多可能性。No1 将为它创建一个闭包。你也可以使用[`bind()`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/bind).

更好的解决方案可能是通过`target`事件的属性来区分选项（每个项目），该属性也传递给侦听器。当您对许多项目只使用一个处理程序时，这将变得非常优雅，例如，将它添加到`<ul>`而不是为每个`<li>`元素添加一个处理程序。然后选择要做什么，例如通过目标元素的 id 或数据属性。

# git - 将 svn repo 与 git repo 合并

> ID：10307142
> 
> 赞同：10
> 
> 时间：2012-04-24T22:54:27.760
> 
> 标签：git, svn

我有一项艰巨的任务，即在两个团队之间合并一个包含大量文件的站点。一个团队一直在努力，一个团队正在`git`使用`svn`. 我可以就解决这个问题的最佳方法获得一些帮助吗？我在想的是我将创建一个新的裸仓库

```
git clone --bare ~/dir gitversion.git 
```

然后从那里创建一个分支

```
git checkout -b import-svn 
```

然后在那个分支上，我将从 svn 中提取

```
svn checkout svn://svnversion/trunk 
```

现在在这个分支上我会变基吗？

```
git rebase origin/master 
```

然后切换回master分支

```
git merge import-svn 
```

我尝试了这样的事情，但似乎无处可去。从来没有任何合并冲突或任何没有意义的事情。有人可以告诉我一个体面的工作流程来完成这个吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-24T23:24:58.627

我遇到过类似的问题，需要处理来自基于 SVN 的开发的多个版本。这是我如何处理它的草图：

```
# checkout the SVN source
$ svn checkout svn://svnversion/trunk
$ cd /into/svn/checkout

$ git init
$ echo ".svn/" > .gitignore
$ git add .gitignore; git commit -m 'Initial .gitignore'

# Now you have a master branch; create your import-svn branch
$ git checkout -b import-svn

# Add *everything* from the SVN checkout
$ git add -A
$ git commit -m 'Initial SVN'

# Now get the GIT developed stuff
$ git checkout -b import-git master
$ git remote add original-git /path/to/git-developed-repository
$ git pull original-git master         # or whatever branch your git developers used.

# Now you've got two branches 'import-svn' and 'import-git'; DIFF and MERGE as you please

# You don't need the remote anymore.
$ git remote rm original-git 
```

我认为这是对的。

现在你可以考虑合并。如果您将“import-git”视为首选基线，则类似以下内容将起作用。

```
$ git checkout -b git-merge-svn import-git
$ git diff --name-status import-svn
$ git merge import-svn 
```

你也可以尝试如下的变基，然后决定你喜欢哪个：

```
$ git checkout -b git-rebase-svn import-git
$ git rebase import-svn 
```

并比较合并和变基（应该是相同的，但你永远不知道..）

```
$ git diff git-rebase-svn..git-merge-svn 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T23:31:49.427

假设最终回购将是 Git。该解决方案保留了两者的历史

首先在非裸存储库上工作，这对于您想要做的事情更容易。克隆 git 存储库，并从 SVN 创建另一个 git 存储库，使用[`svn2git`](https://github.com/nirvdrum/svn2git).

所以你有两个回购。将一个仓库添加为另一个仓库，并将历史记录导入单独的分支：

```
git remote add ../other-repo
git fetch other-repo
git branch other-repo other-repo/master 
```

您将收到没有基本提交的警告，因此您将有两个孤立分支

现在您可以合并分支。这应该是可怕的，可怕的，因为它们是相关但完全不同的历史，但是你别无选择。Rebase 在这里是无稽之谈，因为提交是不相关的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-06-16T23:13:10.113

Microsoft最近有[一篇关于该主题的文章，](https://docs.microsoft.com/en-us/azure/devops/repos/git/perform-migration-from-svn-to-git?view=azure-devops)其中包括使用该`git-svn`实用程序的演练。它们提供有关合并和不合并 svn 更改历史记录的信息。

# android - Android 中的 JNI 库有时在 libs/armeabi sometims obj/armeabi 中创建？

> ID：10307144
> 
> 赞同：0
> 
> 时间：2012-04-24T22:54:59.647
> 
> 标签：android, android-ndk, java-native-interface

build 如何确定 .so 文件的放置位置？它在运行时寻找加载它们的默认位置是什么？库/armeabi/so？这是可配置的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T06:03:04.050

在构建过程中，通过链接一堆目标文件和其他库（静态或共享）在 obj/local/armeabi 中创建共享库。

在运行该剥离命令​​以剥离调试符号之后。它读取 obj/local/armeabi 目录中的库，并在 libs/armeabi 目录中写入输出。因此，打包在 apk 文件中的最终库仅取自 libs 目录。“obj”目录是中间目录，在apk打包过程中不使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T23:02:24.977

您可以通过将以下行添加到 Application.mk 来指定库的输出目录

```
NDK_APP_OUT := <output path> 
```

# tridion - 带有 5.3 SP1 的 Content Porter 2009 SP1 -- 多个父出版物时的导出错误

> ID：10307146
> 
> 赞同：3
> 
> 时间：2012-04-24T22:55:22.907
> 
> 标签：tridion

我已经按照蓝图进行了工作，发现问题始于尝试导出具有多个父级的出版物（“06 结构”）时。

> 5/2/2012 5:08:16 PM [错误] 无法导出项目'/webdav/06 Structure 1.0/Building Blocks/System/Page Templates' 2012/5/2 5:08:16 PM [错误]（TCMDAL ::ExecuteRequest:Content Manager 返回错误）2012 年 5 月 2 日下午 5:08:16 [错误] (TCMDAL::Communications::CheckResponseForErrors) 检查响应期间遇到的错误 2012 年 5 月 2 日下午 5:08:16 [错误] (TCMDAL::Communications::ExecuteRequest) 执行请求时出错 2012 年 5 月 2 日下午 5:08:16 [错误] (TCMDAL::TCMItem::Read) 读取项目 '/webdav/06 结构 1.0 时出错/构建块/系统/页面模板'

“06结构”的父出版优先级是：

```
1\.  "04 Content Freezer"
2\.  "04 Content" (note this is also a parent of "04 Content Freezer", if that has any relevance)
3\.  "04 Design" (note this is the publication that the "Page Templates" items would come from) 
```

我已将修补程序 75095 应用于 Content Porter 服务器，但似乎该修补程序并未解决此特定问题，尽管从概念上讲，它似乎相似。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T12:18:29.030

除了 Chris 提到的内容之外，请查看 Windows 服务器日志 - “远程服务器计算机不存在或不可用”是一个通用错误，可能涵盖很多问题。

如果从服务器本身运行 CP 客户端，是否会出现错误？

# php - 在 Mustache 中嵌入 Partials 作为数据

> ID：10307148
> 
> 赞同：2
> 
> 时间：2012-04-24T22:55:42.743
> 
> 标签：php, mustache

我遇到了胡子模板的问题，希望有人能提供帮助。具体来说，如果我将部分作为数据项嵌入到我的模板中，Mustache 不会完全解析我的模板。**如何让 Mustache 完全解析所有模板，包括作为数据的部分？**

```
<?php
$m = new Mustache;

$template = '
    {{header}}
    {{body}}
    {{footer}}
';

$data = array(
    'header' => 'header', 
    'body' => '{{> embedded}}', 
    'footer' => 'footer'
);

$partials = array(
    'embedded' => 'embedded'
);

die($m->render($template, $data, $partials));
?> 
```

我期望看到的是：

```
header embedded footer 
```

但实际发生的是

```
header {{> embedded}} footer 
```

如果我`{{> embedded}}`直接放入模板中它可以工作，但是由于某种原因，我现在无法对该值进行硬编码。我也不能使用特定于 php 的解决方案，因为模板需要在客户端与 javascript 一样良好地运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T10:32:18.187

Mustache is "completely parsing" your templates. It's just not double-parsing them. In fact, Mustache takes specific pains *not* to double-parse your templates. Doing that would create an opportunity for mustache injection (like SQL injection, but for your templates). This is a Bad Thing :)

It's possible to accomplish what you're looking for with higher-order sections, but that would require some code. That said, it shouldn't be too tough to write both a PHP and JavaScript implementation.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-05T21:52:44.823

这种方式就行了。你怎么看？

```
 $partials = array(
        'embedded' => 'embedded'
    );

    $m = new Mustache_Engine(array('partials' => $partials));

    $template = '
        {{header}}
        {{>embedded}}
        {{footer}}
    ';

    $data = array(
        'header' => 'header', 
        'footer' => 'footer'
    );

    die($m->render($template, $data, $partials)); 
```

# java - 在Java中如何获得数组中所有可能的不同和

> ID：10307150
> 
> 赞同：0
> 
> 时间：2012-04-24T22:55:43.863
> 
> 标签：java, algorithm

所有可能的不同和意味着数组中任何一个、两个、三个到 n（数组的长度）个数的和。例如，如果给定数组是 [2,2,3]，则数组中的一个数字的和就是数组本身 [2,2,3]，那么数组中任意两个数字的和就是 [4,5]数组中三个数之和为 [7] 因此，结果应该是所有可能的和的组合，即 [2,3,4,5,7] 只是算法的想法，不需要具体代码. 谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T23:08:27.197

最简单的方法是简单地迭代并获取总和并将它们添加到不允许重复的集合中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T23:35:48.200

要求的代码：

```
//following taken from http://rosettacode.org/wiki/Power_set#Java
public static <T extends Comparable<? super T>> LinkedList<LinkedList<T>> BinPowSet(
        LinkedList<T> A){
    LinkedList<LinkedList<T>> ans= new LinkedList<LinkedList<T>>();
    int ansSize = (int)Math.pow(2, A.size());
    for(Integer i= 0;i< ansSize;++i){
        String bin= Integer.toString(i, 2); //convert to binary
        while(bin.length() < A.size())bin = "0" + bin; //pad with 0's
        LinkedList<T> thisComb = new LinkedList<T>(); //place to put one combination
        for(int j= 0;j< A.size();++j){
            if(bin.charAt(j) == '1')thisComb.add(A.get(j));
        }
        Collections.sort(thisComb); //sort it for easy checking
        ans.add(thisComb); //put this set in the answer list
    }
    return ans;
}
//use would be
Set<Integer> sums = new HashSet<Integer>();
LinkedList<Integer> powerList = new LinkedList<Integer>(Arrays.<Integer>asList(arr));
for(Collection<Integer> sumEntry : BinPowSet(powerList)) {
    int x = 0;
    for(Integer y : sumEntry) {
        x += y;
    }
    sums.add(x);
}
return sums; 
```

请注意，**可以**删除重复项。加法是可交集的，因此集合中不将单个元素添加两次的任何元素的总和，以任何顺序，都将出现在上面。

另请注意，虽然考虑了 Guava 的 Sets.powerSet()，但它需要一个实际的 Set 作为输入，这将不允许重复（示例中存在）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T02:24:38.073

我将按以下方式处理这个问题。首先，我将构建一个函数来计算组合。

组合（对象 [] A，int r）

这个函数将返回来自 A 的所有 nCr 组合，其中 n = A.length 一旦我有了这个函数，我可以为 r=1、2、3... 调用它并打印总和。

编写组合程序是一个非常标准的技术面试问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-07-31T16:24:12.840

```
public class StackOverflow {
static Set<Integer> tree=new TreeSet<Integer>();
public static void main(String args[]) {
    int [] array= {2,2,3};
    getAllSums(array,0,0);
    tree.remove(0);
    for (Integer i: tree)
        System.out.println(i);

}
public static void getAllSums(int[] numbersArray, int starting, int sum)
{   
    if(numbersArray.length == starting)
    {      
        tree.add(sum);    
        return;
    }
    int value = sum + numbersArray[starting];
    getAllSums(numbersArray, starting + 1, value);
    getAllSums(numbersArray, starting + 1, sum); 
} 
```

# git - 如何在不删除和重新分叉的情况下重新获取分叉的 Git 存储库？

> ID：10307153
> 
> 赞同：12
> 
> 时间：2012-04-24T22:55:48.840
> 
> 标签：git, github

场景如下：我从 Github 分叉了某人的存储库并将其克隆到本地目录。我进行更改，提交并将其推送到我的分叉存储库。然后我向原始存储库发送拉取请求，但无论出于何种原因它都被拒绝了。然后原始存储库会从其他人那里获得一些提交，从而使我的分叉版本过时。现在，我如何获得原始 repo 的最新版本（在我的分叉 repo 和本地）？还有，我如何从 Github 上删除我被拒绝的提交的提交历史？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-25T10:04:38.437

永远不要在主分支中进行自己的更改，您应该创建一个新分支进行更改并推送它。无论如何，如果你想让你的分支等于远程分支：

假设你有上游作为远程`git fetch upstream` `git checkout -f -B master upstream/master`

上面的 checkout 命令将是如果分支 master 在那里继续并用上游/master 覆盖它，如果它不存在则从上游/master 创建它。

如果您没有将上游添加为远程使用`git remote add upstream repositoryurl`

编辑：应该是-B

编辑：`git reset --hard upstream/master`实际上更合适

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-25T02:33:22.110

使您在 GitHub 上的分叉存储库保持同步是一个两步过程。

1.  使您的本地存储库与以下内容保持同步：

    git 获取上游；git 合并上游/主

2.  让你在 GitHub 上的 fork 与你的本地 repo 保持同步

    git push 起源大师

有关一些解释，请参阅[GitHub Fork A Repo](http://help.github.com/fork-a-repo/)。您需要将“上游”设置为您从中分叉的存储库的远程。

对于您的“被拒绝的提交”，如果您在本地分支上进行，那么您可以删除该分支。如果它不在本地分支上，那么您需要将分支的 HEAD 重置回您选择的提交。像：

```
# Assume you are on master and need to go back to commit BeadBabe
git checkout -b temp
git branch -f master BeadBabe
git checkout master
git branch -d temp 
```

走了。

# regex - 在perl中使用正则表达式提取子字符串

> ID：10307157
> 
> 赞同：-2
> 
> 时间：2012-04-24T22:56:34.737
> 
> 标签：regex, linux, perl

好吧，我有一个让我发疯的问题。我正在尝试使用正则表达式提取子字符串：

```
($var) = $data =~ m/regex/; 
```

它正在工作，但返回的“字符串”与真正的 substr 不太一样。打印字符串看起来像真正的 substr，但使用 if ($var eq "substr") 检查不会返回 true。我还注意到，当我尝试使用 $var .= ".."; 在其末尾添加一些内容时 我得到（如果 $var 是“hello”）“..llo”。

这是什么回归？

如果这有所作为，我将在 Linux 中运行它。我不认为它会，但同样的代码适用于我的 Windows。

下面是代码示例：

```
$datatxt contains
.. 
udir=/home/me/ 
..

use File::Read;
my $data = read_file( {skip_comments => 1}, $datatxt);

($udir) = $data =~ m/udir=(.*)/;
print $udir; #prints /home/me/
print ".".$udir."."; #prints ..home/me/
if ($udir ne "/home/me/") {
   print "not equal"; #prints...
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T02:12:39.310

字符串以回车结束。

```
print "hello\r..\n";   # Looks like "..llo" 
```

在这些情况下很有用：

```
use Data::Dumper;
local $Data::Dumper::Useqq = 1;
print(Dumper($str)); 
```

可能最好的解决方案是改变

```
chomp; 
```

至

```
s/\s+\z//; 
```

它修剪所有尾随空格，而不仅仅是尾随换行符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T23:12:01.253

您需要提供特定的代码。我试过这段代码：

```
#!/usr/bin/perl

$_ = <>;
if (($a) = $_ =~ m/(hello)/) {
    print "it is equal\n" if ($a eq "hello");
    $a .= "..";
    print "$a\n";
} else { 
    print "unmatched\n";
} 
```

这应该会重现您的问题，并且匹配有效。我正在使用 perl v5.14.2 运行 linux。在输入“hello world”时，输出为：

```
it is equal
hello.. 
```

# php - HybridAuth / PHP Facebook SDK 身份验证失败（getUser 返回 0）

> ID：10307159
> 
> 赞同：1
> 
> 时间：2012-04-24T22:56:40.183
> 
> 标签：php, facebook, oauth, openid, hybridauthprovider

我正在尝试配置 HybridAuth，而且我还处于早期阶段。现在我要做的就是连接并确保 HA 将重定向到 facebook 并提示安装应用程序，然后在用户返回时对用户进行身份验证。

我从以下位置手动调用： http: [//mydomain.com/auth.php ?provider=Facebook](http://mydomain.com/auth.php?provider=Facebook)

auth.php 看起来像这样：

```
session_start();
require_once($_SERVER['DOCUMENT_ROOT'] . "/func/db_connect.php");
require_once($_SERVER['DOCUMENT_ROOT'] . "/api/auth/Hybrid/Auth.php");      // HybridAuth Module 

$hybridauth_config = include($_SERVER['DOCUMENT_ROOT'] . '/api/auth/config.php');

if ($_GET['provider'] == '' || !in_array($_GET['provider'], array_keys($hybridauth_config['providers']))) {
    echo 'Invalid Provider';
} else {
    try { 
        $hybridauth = new Hybrid_Auth($hybridauth_config);

        // try to authenticate with this provider
        $adapter = $hybridauth->authenticate($_GET['provider']);

        // grab user profile
        if ($hybridauth->isConnectedWith($f_provider)) {
            // yep, we're connected.  Add this provider's info to the user_auth table
            echo 'connection successful';
        }

    } catch (Exception $e) {
        echo $e->getMessage();
    }
} 
```

它的工作原理是转发到 Facebook 并提示安装具有适当权限的正确应用程序。这告诉我我的 HA 配置工作正常。我成功安装了应用程序，然后它重定向回页面，我在该页面收到消息：

```
Authentification failed! Facebook returned an invalide user id. 
```

是什么赋予了？我的应用程序在 FB 控制面板中也显示了 0 个添加和 0 个 API 调用（尽管此数据看起来可能会延迟几天）。我是否在等待 FB 以某种方式启用该应用程序？难道我做错了什么？

**更新**

HybridAuth 使用 Facebook SDK，所以我试图从整个方程式中消除 HA。运行以下基本示例：

```
session_start();

require($_SERVER['DOCUMENT_ROOT'] . "/path/to/fbsdk/facebook.php");
$facebook = new Facebook(array(
  'appId'  => 'myappid',
  'secret' => 'myappsecret',
  'fileUpload' => true
));

$user = $facebook->getUser();
var_dump($user); 
```

我登录到 facebook 并添加了应用程序，但无论我做什么，用户 ID 都会返回 0。我也尝试过使用测试用户 - 无济于事。我可能在这里遗漏了一些服务器配置问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-26T20:31:08.733

我将我的代码移动到不同的应用程序/服务器，然后移动到不同服务器上的同一个应用程序，一切正常。因此，我开始将其视为服务器配置问题。原来 Facebook 不喜欢我的开发服务器上的自签名证书。

我能够通过更改 PHP SDK 中的 base_facebook.php 类并添加 curlopt 以忽略 SSL 验证步骤来解决此问题。见下文：

```
 public static $CURL_OPTS = array(
    CURLOPT_CONNECTTIMEOUT => 10,
    CURLOPT_RETURNTRANSFER => true,
    CURLOPT_TIMEOUT        => 60,
    CURLOPT_USERAGENT      => 'facebook-php-3.1',
    CURLOPT_SSL_VERIFYPEER => false
  ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-28T02:07:25.670

For anyone else coming accross this and the answer above doesn't work, I was facing the same issue an turns out my app on Facebook was still in Sandbox mode. Turning this off under the app settings turned out to solve the issue of getting a 0 user id.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-07T06:43:19.993

混合身份验证在范围参数中添加了一系列“0”。我不确定修改 Hybrid auth 核心类的想法有多好，但我刚刚修改了 Hybrid/Providers/Facebook.php 中的 loginBegin 函数，它现在工作正常：

```
function loginBegin()
{
  $parameters = array("scope" => $this->scope, "redirect_uri" => $this->endpoint, "display" => "page");
  $optionals  = array("scope", "redirect_uri", "display");

  foreach ($optionals as $parameter){
    if( isset( $this->config[$parameter] ) && ! empty( $this->config[$parameter] ) ){
      $parameters[$parameter] = $this->config[$parameter];
    }
  }

  if (isset($parameters['scope'])) {
    foreach ($parameters['scope'] as $key => $parameter){
      if ($parameter == '0') {
        $parameters['scope'][$key] = '';
      }
    }
  }

  // get the login url 
  $url = $this->api->getLoginUrl( $parameters );

  // redirect to facebook
  Hybrid_Auth::redirect( $url );
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-15T12:01:07.417

我已经设法弄清楚为什么即使在当前版本的 hybridauth 和 facebook sdk 中也会出现此错误。

原因在于 hybridauth 和 google 或 facebook sdk 如何构建 redirect_uri 参数。正如我们从[https://developers.facebook.com/docs/facebook-login/manually-build-a-login-flow/](https://developers.facebook.com/docs/facebook-login/manually-build-a-login-flow/)知道的那样，首先我们必须将用户重定向到 facebook（使用 redirect_uri 参数）并返回代码作为响应默认。比我们再次使用 curl 发送 http 请求（使用 redirect_uri 参数）并且这些 url 不匹配，因为前面提到的原因。

换句话说，如果您在 hybridauth 配置中设置 （不带斜杠）-> 它适用于 google，但会给您这个用于 facebook 登录的愚蠢消息错误。`"base_url" => "http://`yourhost`/hybridauth/hybridauth"`

`"base_url" => "http://`yourhost`/hybridauth/hybridauth/"`, （带有斜线）可以在 facebook 上正常工作，但会导致 google 出现错误，并出现明显的错误“重定向 Uri 不匹配”。

因此，快速修复不是最好的方法是配置中的“（不带斜线）。`"base_url" => "http://`yourhost`/hybridauth/hybridauth`

然后根据提供者选择如何构建uri。

在 Provider_Adapter.php 注释第 131 行 `// $this->params["login_done"] = $HYBRID_AUTH_URL_BASE . ( strpos( $HYBRID_AUTH_URL_BASE, '?' ) ? '&' : '?' ) . "hauth.done={$this->id}";`

并添加这两个。

`$dlm = $this->id == "Facebook" ? "/?" : "?";`

`$this->params["login_done"] = $HYBRID_AUTH_URL_BASE . ( strpos( $HYBRID_AUTH_URL_BASE, $dlm ) ? '&' : $dlm ) . "hauth.done={$this->id}";`

这样我们就有了同时支持 Facebook 和 Google 的解决方案。

# matlab - 在 Matlab 中进行替换采样

> ID：10307163
> 
> 赞同：0
> 
> 时间：2012-04-24T22:57:10.987
> 
> 标签：matlab, genetic-algorithm

我有一组`n`基因组和`n`相应的适应度值。我想根据它们的比例适应度值对基因组进行替换采样，例如`P(genome) = fitness(genome) / sum(fitness(genomes))`. Matlab中是否有这样的采样机制？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T07:51:38.183

如果您想从 4 个群体中获取 10 个样本，其适应度分别为 0.4、0.3、0.2 和 0.1，那么您可以执行以下操作：

```
>> fitness = [0.4 0.3 0.2 0.1];
>> mnrnd(10,fitness)
ans =
     3     5     1     1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T08:13:46.333

您可以[`randsample`](http://www.mathworks.com/help/toolbox/stats/randsample.html)为此目的使用：

```
>> f = [2 5 7 8 1]; %# fitness values (not normalized)
>> g = {'g1', 'g2', 'g3', 'g4', 'g5'}; %# genome names
>> gSampled = randsample(g,100,true,f) %# sample 100 genomes with replacement 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T00:17:45.727

Matlab 内置多项式随机数生成器。您可以将`mnrnd`其用于您的目的。

# python - 用于在 Python 中查找所有可能组合的嵌套循环

> ID：10307167
> 
> 赞同：1
> 
> 时间：2012-04-24T22:57:27.400
> 
> 标签：python, loops, nested, bioinformatics

大家好，我有一个生物信息学问题，我可以帮忙解决。它很长，但我会尝试将其分解为更小的部分，任何帮助都很棒。

我有一个由 4 个字母 A、U、C、G 组成的 RNA 长度“n”序列，它作为字符串导入 Python，可以折叠形成一个循环。一个循环是通过匹配序列中的一对字母来形成的，这样 A 与 U，C 与 G 和 G 与 U 一起，因此字符串自身折叠起来。

问题是必须有三个或更多的字母彼此相邻形成一对，超过或等于 3 个字母连续形成一对，并且至少 3 个字母的部分之间也必须有间隙.

我试图发布一张图片，但我没有足够的声望点:(

在我引用的期刊中，作者谈到了一种嵌套循环方法，可以在可能的情况下找到所有可能的组合，然后将它们包含在一个组中，以便稍后调用。

我的问题是编写嵌套循环，因为我是编程和 python 的新手。以及以可以识别对并可能将它们添加在一起的方式存储序列。

再次任何帮助都会很棒，如果有任何不清楚的地方，请告诉我

编辑：

一个例子是 seq='aggcuugaguuu' ，其中一个输出显示 seq[0:2] 与 seq[9:11] 的配对，这意味着代码形式像 U 形。

如果你把绳子想象成一根物理的绳子，在 3 个点上握住它，在三个不同的点上握住它，然后将这些点接触在一起，它会导致绳子形成一个循环。我正在寻找确定使用的 6 点。

我不是在寻找为我编写的代码，我只是想知道一种编写代码的方法。

我尝试了一种方法，其中 seq1=input code 和 seq2=reverse input code 并沿着 seq1 移动 seq2 寻找三个相邻对，但这并没有给我正确的输出。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T23:00:44.543

您是否考虑过使用[itertools](http://docs.python.org/library/itertools.html#itertools.product)的产品。然后您可以迭代结果并仅选择您喜欢的这些结果。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-25T00:17:42.523

如果你的 RNA 不是很长（一千个碱基可能还可以；几十万个肯定不行），你可以使用简单的 O(n^3) 算法。O(n^3) 意味着执行时间在最坏的情况下与碱基数的立方成正比。作者提到*嵌套循环*在很大程度上暗示了这种简单但相当缓慢的方法。

```
def find_loops(rna, min_pairs=3, min_loop=3):
    n = len(rna)
    result = []
    for loop_start in xrange(min_pairs, n - min_pairs - min_loop + 1):
        for loop_end in xrange(loop_start + min_loop, n - min_pairs):
            if (loop_end - loop_start < min_loop + 2 or 
                    not base_pair(rna[loop_start], rna[loop_end - 1])):
                max_pairs = min(loop_start, n - loop_end)
                for k in xrange(max_pairs):
                    if not base_pair(rna[loop_start - k - 1], rna[loop_end + k]):
                        break
                else:
                    k = max_pairs
                if k >= min_pairs:
                    result.append((loop_start - k, k, loop_end - loop_start))
    return result

def base_pair(x, y):
    return (x == 'A' and y == 'U' or
            x == 'C' and y == 'G' or
            x == 'G' and y == 'C' or
            x == 'U' and y == 'A') 
```

这会遍历所有可能的 RNA 环的开始和结束，然后在两个方向上从潜在环的末端走开，只要碱基仍然配对。当它到达一对不匹配的碱基时，它会停下来检查它是否至少有最少的碱基对。如果有，它将循环添加到结果列表中。

第一个`if`是为了避免列出可能被“压缩”得更紧的循环。如条件所示，如果循环太短（少于五个碱基）或末端不匹配，则*无法将循环拉得更紧。*

结果是一个元组列表，每个可能的循环一个，形式为`(start_pos, pair_count, loop_length)`。这意味着`pair_count`从碱基编号开始的碱基序列`start_pos`后面是一个`loop_length`碱基环，然后是反向的互补序列。该序列的反义拷贝从碱基开始`start_pos + pair_count + loop_length`。第一个基数是数字 0，而不是 1（我们是这里的程序员）。

一个例子可能会更清楚：`print find_loops('GGGGAUUACAGCGUGUAAUCAAUA')`returns `[(4, 3, 13), (3, 7, 3)]`，也就是说，它找到了两个循环：

*   在位置 4 处，三个碱基 ,`AUU`围成一个 13 个碱基的环，并与`AAU`位置 20 结合；
*   在位置 3，七个碱基，`GAUUACA`包围三个碱基的环，并与`UGUAAUC`位置 13 结合。

如果没有第一个`if`，该函数还将返回类似 (3, 6, 5) 的循环（即`GAUUAC`在位置 3 包含五个碱基的循环并绑定到`GUAAUC`位置 14），这与 (3, 7, 3) 相同) 上面，只是没有拉得那么紧。

希望这可以帮助。如果您需要更快的算法，我相信有一个动态编程解决方案可以处理更长的字符串。让我知道，我会考虑的。不过，这不会那么容易理解......

# java - Tapestry - 复合组件？

> ID：10307168
> 
> 赞同：0
> 
> 时间：2012-04-24T22:57:28.313
> 
> 标签：java, tapestry

有人可以告诉我如何在 Tapestry 中创建复合组件吗？我知道如何在 JSF 中使用 using 以及 ui:define 来做到这一点。但是挂毯怎么样？

我想创建以下设置：

`sidebar.tml`: 应该定义一些可替换的变量，这里是 'header' 和 'content'

```
<t:container>
The header is ${header}, and the content ist ${content}.
</t:container> 
```

`layout.tml`：应该为侧边栏定义正确的位置以始终对齐

```
//header
<t:sidebar /> 
//footer 
```

`customPage.tml`：应该为侧边栏提供内容

```
<t:sidebar>
    <t:header>my header</t:header>
    <t:content>some content here</t:content>
</t:sidebar> 
```

我知道不能这样做，但我希望你明白我想要做什么并且可以帮助我？

tyvm

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T08:22:09.017

这就是我的做法：

侧边栏.tml

```
<t:container>
The header is <t:delegate to="header"/>, and the content ist <t:delegate to="content"/>
</t:container> 
```

边栏.java

```
public class Sidebar
{
    @Property
    @Parameter(required = true)
    private Block header;

    @Property
    @Parameter(required = true)
    private Block content; 
```

布局.tml

```
//header
<t:sidebar header="sidebarHeader" content="sidebarContent"/> 
//footer 
```

布局.java

```
public class Layout
{
    @Property
    @Parameter(required = true)
    private Block sidebarHeader;

    @Property
    @Parameter(required = true)
    private Block sidebarContent; 
```

自定义页面.tml

```
<t:layout>
    <p:sidebarHeader>my header</p:sidebarHeader>
    <p:sidebarContent>some content here</p:sidebarContent>
    rest of your content here
</t:layout> 
```

希望能帮助到你！

# .net - 如何在没有 IV 的情况下在 .NET 中进行 AES 加密

> ID：10307169
> 
> 赞同：2
> 
> 时间：2012-04-24T22:57:33.530
> 
> 标签：.net, asp-classic, cryptography, rijndael, initialization-vector

我们的经典 ASP 应用程序有一个遗留部分，它使用一些代码，这些代码应该使用 Rijndael (AES) 加密/解密字符串。此代码是在[Internet](http://www.frez.co.uk/vb6.aspx)上找到的（Rijndael AES Block Cipher (VB Version)）。我已经在 SO 上找到了一个问题，它引用了这个确切的库，并且[问的问题与我几乎相同](https://stackoverflow.com/questions/5987186/aes-encrypt-string-in-vb-net)，但我怀疑至少有一件事情出错了（除了在字节数组的开头添加要加密的数据长度之外） ）。vbScript 实现看起来根本不想向要加密的数据添加 IV。因此，我无法将相同的加密与 RijndaelManaged 匹配，因为它：

1.  每次自动生成不同的 IV
2.  绝对需要静脉注射

有人知道是否可以在不指定 IV（空）的情况下对 .Net 中的某些内容进行 AES 加密？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-25T17:50:11.173

您使用的代码和问题的解决方案都是完全不安全的。首先，***在任何情况下，您都不应该使用加密库，一些随机的人写道 ***句号，故事结束。windows 和 .net 都有受信任、经过审查的加密库。他们没有诸如定时攻击问题、右门后门之类的事情，或者只是那些对加密货币一无所知的人会尝试的愚蠢的事情。

举个例子，你提到的图书馆似乎只支持[ECB 模式](http://msdn.microsoft.com/en-us/library/system.security.cryptography.ciphermode.aspx)。这是完全不安全的，任何知道他们在做什么的人都不会这样做。尽管有很多原因，但为什么不这样做的最好证明是：

![在此处输入图像描述](../Images/fd925e1e549f137b5e0d12aafe8a1ca3.png)

这是 linux penguine 的 ecb 加密图片。不是很安全吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T19:59:57.647

不，没有 IV，您无法在 CBC 模式下加密任何内容。但是，您可以*将 IV 显式设置为 al zero's*。由于 IV 与第一个普通块进行异或运算，因此将 IV 设置为全零相当于没有 IV。

这只是对您的问题的回答，您可能需要注意迄今为止提供给您的所有其他安全建议。您可能还想检查代码是否实际使用需要 IV 的 CBC 模式加密。

用于 CBC 模式加密的 IV 始终是一个块大小（AES 为 16 个字节，但`getBlockSize()`只要可用就使用一种方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T17:59:10.623

[`Mode`](http://msdn.microsoft.com/en-us/library/system.security.cryptography.symmetricalgorithm.mode.aspx)将密码的属性显式设置为[`ECB`](http://msdn.microsoft.com/en-us/library/system.security.cryptography.ciphermode.aspx).

除非您加密的纯文本是短的、随机的、唯一的字符串，否则 ECB 是不安全的。例如，它对加密会话密钥或另一个加密密钥很有用。

# javascript - 强制光标移动到页面的一侧

> ID：10307172
> 
> 赞同：1
> 
> 时间：2012-04-24T22:57:56.563
> 
> 标签：javascript, jquery, html, css

我想知道这是否可能？我想要一个链接说点击我和下面的图片也超链接到另一个页面。在用户尝试将鼠标悬停在 click me 链接上之前，光标应该在到达 click me 链接之前自动移动到图像上。

顺便说一句，这不会成为真实网站的一部分！这只是个人的事情......

提前致谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-24T22:59:00.480

不可以。您无法控制鼠标的位置。这将是每个恶意黑客的梦想......

# python - 为 Web 应用程序实现张量分解的最有效语言

> ID：10307173
> 
> 赞同：1
> 
> 时间：2012-04-24T22:58:04.667
> 
> 标签：python, c++, mysql, django, large-data

我在 Matlab 中实现了张量分解算法。但是，实际上，我需要在 Web 应用程序中使用它。

所以我在 Django 框架上实现了网站，现在我需要将它与我的张量分解算法合并。

对于那些不熟悉张量分解的人，您可以认为在大型矩阵（例如 10 000 x 8 000）上有一堆乘法、加法和除法。在张量分解的情况下，我们没有矩阵，而是有 3 个-维（出于我的目的）数组。

顺便说一句，我使用 MySQL 作为我的数据库。

我正在考虑用 Python 或 C++ 实现这个算法。但我不能确定哪个更好。在处理庞大的数据集时，您对 Python 和 C++ 的效率有任何想法吗？哪一个更好？为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T05:45:04.353

Python 很好。我是一个 Python 人。我个人不了解 C++。然而，在我研究 python 的过程中，mathematica 的创建者自己说 python 和 mathematica 一样强大。Python 用于许多高度精确的计算。（即工程软件、架构工作等......）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T23:21:38.463

由于您使用的是 Django，因此您在网站上使用的是 Python。您应该调查 SciPy/NumPy 并查看它们是否适合您的目的。

[http://scipy.org/](http://scipy.org/)

[http://numpy.scipy.org/](http://numpy.scipy.org/)

# security - 在 SSL 页面中使用 SSL iframe 有什么危险

> ID：10307180
> 
> 赞同：0
> 
> 时间：2012-04-24T22:59:04.510
> 
> 标签：security, iframe, ssl

在 SSL 页面中使用 SSL iframe 是否安全。SSL 框架包含一个表单。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-24T23:31:26.763

HTTPS 提供的安全性的一个重要部分是验证您正在与之交谈的服务器的身份。这是通过[验证证书是真实的并且它与请求的主机名匹配来](https://security.stackexchange.com/a/14089/2435)完成的。

尽管大多数方面的验证都是在浏览器内完成的（PKI 验证和主机名匹配验证），但最后一步是从用户界面的角度来看，并且必须由用户直观地完成。检查用户在打算使用 HTTPS 时是否正确使用它是他们的责任。

如果你打算去`https://www.google.com/`，但输入`https://www.g-o-o-o-o-o-gle.com`，两者都可能有真正的证书（现在任何人都可以获得证书，即使是攻击者，回报都值得投资）。由用户确保他们正在访问他们打算访问的站点。

通过在另一个页面中嵌入带有`https://`链接的 iframe（实际上是否为 HTTPS），您将阻止用户验证他们是否正在连接到预期的站点。期望用户检查页面 DOM 以确保请求到达他们期望它到达的主机是不现实的。在这个阶段，用户几乎无法验证 iframe 中站点的身份：他们确实必须信任嵌入器。

一个很好的坏例子来自银行业，它给了我们[3-D Secure](http://en.wikipedia.org/wiki/3-D_Secure). 商家网站旨在将您的银行提供的页面包含在 iframe 中，要求您输入密码以检查信用卡的使用情况。但是，作为用户，您必须非常信任商家站点，因为它可以很好地将您重定向到其控制下的站点，并将所有请求代理到真正的银行站点。它看起来与真正的银行网站一模一样，但商家（或同事）可以看到您输入的所有内容。并不是每个用户都可以使用像 Firebug 这样的开发人员工具（即使对于开发人员来说，如果涉及到一点 JS，可能很难跟踪正在发生的事情）。（这有点可惜，因为这个系统的目标之一就是不幸地防止对不良商家网站的欺诈。）

如果您在 HTTPS 页面中嵌入 HTTPS iframe，那么您实际上是在保证其内容以及与它的交互（就像您对嵌入的任何其他内容所做的那样）。只能期望用户验证您的证书，而不是嵌入的证书。这带有一定的责任。

# php - php mysql 一表二字段分开搜索结果

> ID：10307182
> 
> 赞同：0
> 
> 时间：2012-04-24T22:59:21.390
> 
> 标签：php, mysql

我有一个带有两个字段 object1 和 object2 的 mysql 表。通过在输入表单中键入 ID 来单独查询搜索结果，只有与 object1 与 222 和 333 匹配的任何 ID 将返回 ID 的同一行的查询结果。

对object2 也一样，输入与object2 匹配的ID 为444 和999 将返回该ID 的同一行的查询结果。

例如，在输入表单中输入 12345，结果将显示 **Joe Long object1（而不是 222）**

谁能想到sql和php？

例如，如果我按 ID 12345 进行搜索，那么我希望得到的结果为 Joe Long，object1。

```
 +-----------------------------------------------------------------+
 | ID        | firstName   | lastName | object1 | object2 | sortID |
 +-----------------------------------------------------------------+
 | 12345     | Joe         | Long     |  222    |    444  |   66   |
 | 12346     | John        | Higgins  |  222    |    444  |   66   |
 | 12347     | David       | Crowe    |  333    |    444  |   66   |
 | 12348     | Denise      | Jacob    |  333    |    999  |   77   |
 | 12349     | George      | Jacob    |  333    |    999  |   77   |
 | 12350     | Iain        | Jacob    |  111    |    444  |   66   |
 | 12351     | Kevin       | Dalglish |  888    |    555  |   77   |
 | 12352     | Christina   | Brown    |  888    |    555  |   77   |
 | 12353     | Jean        | Scholes  |  888    |    555  |   66   |
 | 12354     | Angela      | Scholes  |  333    |    555  |   77   |
 | 12355     | Ellie       | Scholes  |  333    |    555  |   77   |
 +-----------------------------------------------------------------+ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T23:07:36.150

大概是这样的：

```
select *
from `table`
where object1 like '%query%' or object2 like '%query%'
group by ID 
order by sortID asc 
```

# java - 尝试冒泡排序时出现空指针异常

> ID：10307184
> 
> 赞同：0
> 
> 时间：2012-04-24T22:59:28.847
> 
> 标签：java, nullpointerexception, bubble-sort

我正在编写一个涉及对字符串进行标记的冒泡排序方法，并且我不断收到一个神秘的空指针异常。

该方法接受一个字符串数组。每个字符串包含四个标记，姓氏，名字，社会安全号码和年龄。该方法需要能够按这些标记中的任何一个进行排序，因此它将每个字符串分解为标记，将标记放入数组中，然后使用冒泡排序对标记进行排序，根据标记排序重新排列数组中的每个字符串.

当我尝试将第二个字符串拆分为标记并将其保存到数组时，会发生错误。

这是代码。

```
 for (int i=0; i< array.length;i++) {

              String s1 = sortedArray[i];
              String s2 = sortedArray[i+1];

              String[] holdingArray1;
              String[] holdingArray2;

              holdingArray1 = s1.split("\\s+");
              holdingArray2 = s2.split("\\s+");

              int result = holdingArray1[0].compareTo(holdingArray2[0]);

              if (result > 0)
              {

                  sortedArray[i] = s2;
                  sortedArray[i+1] = s1; 
              }

              System.out.println(sortedArray[i]);
              System.out.println(sortedArray[i+1]);
            } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T23:01:16.163

`i`可能小于 array.length 但`i+1`可能不会。`i+1`当您仅检查是否存在元素时，您会假设存在`i`元素。因此，`i+1`去`null`，你不能`.split` `null`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T17:27:28.547

您需要在小于 array.length-1 时执行循环，因为您正在执行 sortedArray[i+1]。

```
for (int i = 0; i < array.length-1; i++)
{
  // logic
} 
```

这是一个完整的冒泡排序算法示例。

```
 public static int[] bubbleSort(int[] arr, Boolean descending)
    {
         Boolean finished = false;

         while (!finished)
         {
             Boolean held = false;
             int hold;

             for (int i = 0; i < arr.length-1; i++)
             {
                  int curr = arr[i];
                  int next = arr[i+1];
                  Boolean test = curr > next;
                  if (descending) test = curr < next;

                  if (test)
                  {
                     held = true;
                     hold = next;
                     arr[i] = hold;
                     arr[i+1] = curr;
                  }             
             }

             if (!held) finished = true;
          }

          return arr;
     } 
```

# c# - 返回对象的大小以在函数中更改它

> ID：10307185
> 
> 赞同：1
> 
> 时间：2012-04-24T22:59:31.140
> 
> 标签：c#, xna

在继续为我的乒乓球比赛加电时，我已经让它们在大多数情况下正常工作（很大程度上感谢 Jim Perry），但现在我似乎无法让我的球棒（桨）在被召唤时增长或缩小.

我认为这与我称蝙蝠大小的方式有关。在我的 Bat 类中，我有一个名为**GetSize()**的函数，它返回蝙蝠的大小。

```
 public Rectangle GetSize()
    {
        return size;
    } 
```

我基本上试图在一个函数中将蝙蝠的大小加倍，在另一个函数中将原始蝙蝠的大小减半。

```
 public void GrowBat()
    {
    } 

    public void ShrinkBat()
    {
    } 
```

如果我在函数中插入类似下面的内容，我不会注意到蝙蝠有任何变化。

```
 public void GrowBat()
    {
size = new Rectangle(0, 0, leftBat.Width * 2, leftBat.Height *2);
} 

   public void ShrinkBat()
    {
size = new Rectangle(0, 0, leftBat.Width / 2, leftBat.Height / 2);
    } 
```

我认为这与我没有返回蝙蝠的大小有关。你们会如何解决这个问题？

我在下面包含了我的**Bat**和**Game1**类以帮助澄清，特别是我的 Game1 类中用于通电的 switch 语句，大约一半。

```
 namespace Pong
{
  using Microsoft.Xna.Framework;
  using Microsoft.Xna.Framework.Content;
  using Microsoft.Xna.Framework.Graphics;
  using System;

 public class Bat
  {
    public Vector2 position;
    public float moveSpeed;
    public Rectangle size;
    private int points;
    private int yHeight;
    private Texture2D leftBat;
    public float turbo;
    public float recharge;
    public float interval;
    public bool isTurbo;

    public Bat(ContentManager content, Vector2 screenSize, bool side)
    {
        moveSpeed = 7f;
        turbo = 15f;
        recharge = 100f;
        points = 0;
        interval = 5f;
        leftBat = content.Load<Texture2D>(@"gfx/batGrey");
        size = new Rectangle(0, 0, leftBat.Width, leftBat.Height);
        if (side) position = new Vector2(30, screenSize.Y / 2 - size.Height / 2);
        else position = new Vector2(screenSize.X - 30, screenSize.Y / 2 - size.Height /       2);
        yHeight = (int)screenSize.Y;
    }

    public void IncreaseSpeed()
    {
        moveSpeed += .5f;

    }

    public void Turbo()
    {
        moveSpeed += 7.0f;
    }

    public void DisableTurbo()
    {
        moveSpeed = 7.0f;
        isTurbo = false;
    }

    public Rectangle GetSize()
    {
        return size;
    }

    public void IncrementPoints()
    {
        points++;
    }

    public int GetPoints()
    {
        return points;
    }

    public void SetPosition(Vector2 position)
    {
        if (position.Y < 0)
        {
            position.Y = 0;
        }
        if (position.Y > yHeight - size.Height)
        {
            position.Y = yHeight - size.Height;
        }
        this.position = position;
    }

    public Vector2 GetPosition()
    {
        return position;
    }

    public void MoveUp()
    {
        SetPosition(position + new Vector2(0, -moveSpeed));
    }

    public void MoveDown()
    {
        SetPosition(position + new Vector2(0, moveSpeed));
    }

    public virtual void UpdatePosition(Ball ball)
    {
        size.X = (int)position.X;
        size.Y = (int)position.Y;
    }

    public void ResetPosition()
    {
        SetPosition(new Vector2(GetPosition().X, yHeight / 2 - size.Height));
    }

    public void GrowBat()
    {

    }

    public void ShrinkBat()
    {
        size = new Rectangle(0, 0, leftBat.Width / 2, leftBat.Height / 2);
    }

    public virtual void Draw(SpriteBatch batch)
    {
        batch.Draw(leftBat, position, Color.White);
    }

   }
}

  namespace Pong
{
using System;
using System.Diagnostics; // There for debugging purposes right now
using Microsoft.Xna.Framework;
using Microsoft.Xna.Framework.Content;
using Microsoft.Xna.Framework.Graphics;
using Microsoft.Xna.Framework.Input;
using Microsoft.Xna.Framework.Audio;
using Microsoft.Xna.Framework.Media;

  /// <summary>
  /// This is the main type for your game
  /// </summary>
  public class Game1 : Microsoft.Xna.Framework.Game
  {

    public static GameStates gamestate;
    private GraphicsDeviceManager graphics;
    public int screenWidth;
    public int screenHeight;
    private Texture2D backgroundTexture;
    private SpriteBatch spriteBatch;
    private Menu menu;
    private SpriteFont arial;
    private HUD hud;
    Animation player;

    // Bats & Ball
    public Bat rightBat;
    public Bat leftBat;
    public Ball ball;

    // Scoring
    private int resetTimer;
    private bool resetTimerInUse;
    public bool lastScored;  

    // All things having to do with the powerup
    Powerup powerup;
    SpriteFont font;
    Vector2 vec;
    Vector2 vec2;
    Vector2 tickVec;
    Vector2 activatedVec;
    Vector2 deactivatedVec;     
    Vector2 promptVec;
    Random random;
    GamePadState lastState;
    int tickCount;
    bool powerupInitialized;

    // Menus
    private SoundEffect menuButton;
    private SoundEffect menuClose;
    public Song MainMenuSong { get; private set; }
    public Song PlayingSong { get; private set; }

    private Input input;

    // For resetting the speed burst of the paddle
    int coolDown = 0;
    int disableCooldown = 0;
    int powerEnableCooldown = 5000;
    int powerDisableCooldown = 2000;

    // Creates a new intance, which is used in the HUD class
    public static Game1 Instance;

    public enum GameStates
    {
        Menu,
        Running,
        Paused,
        End
    }

    // Constructor (I'm a n00b, remember?)
    public Game1()
    {
        graphics = new GraphicsDeviceManager(this);
        Content.RootDirectory = "Content";

        // Creates an instance of the class, which is used in the HUD class
        Instance = this; 

    }

    protected override void Initialize()
    {
        screenWidth = 1280;
        screenHeight = 720;
        menu = new Menu();
        gamestate = GameStates.Menu;
        resetTimer = 0;
        resetTimerInUse = true;
        lastScored = false;
        graphics.PreferredBackBufferWidth = screenWidth;
        graphics.PreferredBackBufferHeight = screenHeight;
        graphics.IsFullScreen = true;
        graphics.ApplyChanges(); 
        ball = new Ball(Content, new Vector2(screenWidth, screenHeight));
        SetUpMulti();
        input = new Input();
        hud = new HUD();

        // Places the powerup animation inside of the surrounding box
        player = new Animation(Content.Load<Texture2D>(@"gfx/powerupSpriteSheet"), new     Vector2(103, 44), 64, 64, 4, 5);

        // Used by for the Powerups
        random = new Random();
        vec = new Vector2(100, 50);
        vec2 = new Vector2(100, 100);
        promptVec = new Vector2(50, 25);
        powerupInitialized = false;  

        base.Initialize();         
    }

    protected override void LoadContent()
    {
        arial = Content.Load<SpriteFont>("Arial"); // for game scores
        spriteBatch = new SpriteBatch(GraphicsDevice);  
        backgroundTexture = Content.Load<Texture2D>(@"gfx/background");
        hud.LoadContent(Content);   
        menuButton = Content.Load<SoundEffect>(@"sfx/menuButton");
        menuClose = Content.Load<SoundEffect>(@"sfx/menuClose");
        MainMenuSong = Content.Load<Song>(@"sfx/getWeapon");
        PlayingSong = Content.Load<Song>(@"sfx/boomer");
        MediaPlayer.IsRepeating = true;
 //         MediaPlayer.Play(MainMenuSong); // getWeapon music 
        font = Content.Load<SpriteFont>("Arial"); // Used by the Powerup

    }

    private void PowerupActivated(object sender, PowerupEventArgs e)
    {
        activatedVec = new Vector2(100, 125);          
    }

    private void PowerupDeactivated(object sender, PowerupEventArgs e)
    {
        deactivatedVec = new Vector2(100, 150);
        //do whatever - shrink ball, paddle, slow down ball
    }

    private void PowerupTick(object sender, PowerupEventArgs e)
    {
        tickVec = new Vector2(100, 175);
        tickCount++;
        //for powerup like Regen, add hp
    }

    // Sets up single player game
    private void SetUpSingle()
    {
        rightBat = new AIBat(Content, new Vector2(screenWidth, screenHeight), false);
        leftBat = new Bat(Content, new Vector2(screenWidth, screenHeight), true);
    }

    // Sets up 2 player game
    private void SetUpMulti()
    {
        rightBat = new Bat(Content, new Vector2(screenWidth, screenHeight), false);
        leftBat = new Bat(Content, new Vector2(screenWidth, screenHeight), true);
    }

    // Increases the speed of the bats slightly after each round
    private void IncreaseSpeed()
    {
        ball.IncreaseSpeed();
        leftBat.IncreaseSpeed();
        rightBat.IncreaseSpeed();
    }

    protected override void Update(GameTime gameTime)
    {
        input.Update();
        player.Update(gameTime);

        // Allows the game to exit
        if (GamePad.GetState(PlayerIndex.One).Buttons.Back == ButtonState.Pressed || 
            Keyboard.GetState().IsKeyDown(Keys.Escape))
            this.Exit();

        GamePadState state = GamePad.GetState(PlayerIndex.One);

        if (state.Buttons.RightShoulder == ButtonState.Pressed &&    lastState.Buttons.RightShoulder == ButtonState.Released
            || Keyboard.GetState().IsKeyDown(Keys.LeftAlt))
        {
            //generate a random powerup
            PowerupType type =    (PowerupType)random.Next(Enum.GetNames(typeof(PowerupType)).Length);

            switch (type)
            {
                case PowerupType.BigBalls:
                    {
                    powerup = new Powerup(type, 10.0f, 1.0f);
                    ball.ShrinkBall();
                    break;

                    }
                case PowerupType.BigPaddle:
                    {
                        powerup = new Powerup(type, 10.0f, 10.0f);
                        leftBat.GrowBat();
                        break;
                    }
                case PowerupType.ShrinkEnemy:
                    {
                        powerup = new Powerup(type, 10.0f, 10.0f);
                        rightBat.ShrinkBat();
                        break;

                    }
                case PowerupType.SpeedBall:
                    {
                        powerup = new Powerup(type, 10.0f, 20.0f);
                        ball.IncreaseSpeed();
                       break;

                    }
                case PowerupType.SplitWall:
                case PowerupType.ThreeBurst:
                case PowerupType.Heal:
                    {
                        powerup = new Powerup(type, 1.0f, 1.0f);
                        hud.AddHealthP1();

                        break;
                    }
                case PowerupType.Regen:
                    {
                        powerup = new Powerup(type, 20.0f, 1.0f);

                        break;
                    }
            }

            powerupInitialized = false;

        }
        else if (state.Buttons.LeftShoulder == ButtonState.Pressed && 
            lastState.Buttons.LeftShoulder == ButtonState.Released || 
            Keyboard.GetState().IsKeyDown(Keys.LeftControl) &&    Keyboard.GetState().IsKeyUp(Keys.LeftControl))
        {
            powerup.Activate();
        }

        if (powerup != null && IsActive)
        {
            if (!powerupInitialized)
            {
                powerup.Activated += PowerupActivated;
                powerup.Deactivated += PowerupDeactivated;

                if (powerup.Type == PowerupType.Regen)
                    powerup.Tick += PowerupTick;

                powerupInitialized = true;
            }

            powerup.Update((float)gameTime.ElapsedGameTime.TotalMilliseconds);
        }

        lastState = state;

        // What to do when the game is over
      if (gamestate == GameStates.Running)
        {
            if (hud.currentHealthP2 < 1)
            {
                menu.InfoText = "Game, blouses.";
                gamestate = GameStates.End;
            }
            else if (hud.currentHealthP1 < 1)
            {
                menu.InfoText = "You just let the AI beat you.";
                gamestate = GameStates.End;
            }
            if (resetTimerInUse)
            {
                resetTimer++;
                ball.Stop();                 
            }

            if (resetTimer == 120)
            {
                resetTimerInUse = false;
                ball.Reset(lastScored);
                resetTimer = 0;
            }

            // Controls movement of the bats              
            if (rightBat.GetType() != typeof(Pong.AIBat))
            {
                if (input.LeftDown) leftBat.MoveDown();
                else if ((input.LeftUp)) leftBat.MoveUp();
                if (input.RightDown) rightBat.MoveDown();
                else if (input.RightUp) rightBat.MoveUp();
            }

            else if (rightBat.GetType() == typeof(Pong.AIBat))
            {
                if (input.LeftDown) leftBat.MoveDown();
                else if ((input.LeftUp)) leftBat.MoveUp();
                if (input.RightDown) leftBat.MoveDown();
                else if (input.RightUp) leftBat.MoveUp();
             }

            // Updating ball and bat position
            leftBat.UpdatePosition(ball);
            rightBat.UpdatePosition(ball);
            ball.UpdatePosition();

          // Checking for collision of the bats
            if (ball.GetDirection() > 1.5f * Math.PI || ball.GetDirection() < 0.5f *  Math.PI)
            {
                if (rightBat.GetSize().Intersects(ball.GetSize()))
                {
                    ball.BatHit(CheckHitLocation(rightBat));
                }
            }
            else if (leftBat.GetSize().Intersects(ball.GetSize()))
            {
                ball.BatHit(CheckHitLocation(leftBat));
            }

            // Triggers the turbo button and cooldown
            if (input.SpaceDown)
            {
                if (disableCooldown > 0)
                {
                    leftBat.isTurbo = true;
                    coolDown = powerEnableCooldown;
                    leftBat.moveSpeed = 40.0f;
                    disableCooldown -= gameTime.ElapsedGameTime.Milliseconds;
                }
                else
                {
                    leftBat.DisableTurbo();
                }
            }
                // If spacebar is not down, begin to refill the turbo bar
            else if (!input.SpaceDown) 
            {
                leftBat.DisableTurbo();
                coolDown -= gameTime.ElapsedGameTime.Milliseconds;
                if (coolDown < 0)
                {
                    disableCooldown = powerDisableCooldown;
                }
            }

            // Makes sure that if Turbo is on, it automatically turns of. Kills it    after () seconds
            if(leftBat.isTurbo)

                disableCooldown -= gameTime.ElapsedGameTime.Milliseconds; 
                    if(disableCooldown < 0)
                     {
                    leftBat.isTurbo = false;
                     }

            if (!resetTimerInUse)
            {   // checks out of bounds for right side
                if (ball.GetPosition().X > screenWidth)
                {
                    resetTimerInUse = true;
                    lastScored = true;

                    hud.SubtractHealthP2();
                    // Checks to see if ball went out of bounds, and triggers warp sfx
                    ball.OutOfBounds();
                    leftBat.IncrementPoints();
                    IncreaseSpeed();
                } // Checks out of bounds for left side
                else if (ball.GetPosition().X < 0)
                {

                    resetTimerInUse = true;
                    lastScored = false;

                    hud.SubtractHealthP1();
                    // Checks to see if ball went out of bounds, and triggers warp sfx
                    ball.OutOfBounds();
                    rightBat.IncrementPoints();
                    IncreaseSpeed();
                }
            }
        }
          // Navigating through the menus
        else if (gamestate == GameStates.Menu)

        {

            if (input.RightDown || input.LeftDown)
            {
                menu.Iterator++;
                menuButton.Play();
            }
            else if (input.RightUp || input.LeftUp)
            {
                menu.Iterator--;
                menuButton.Play();
            }

            if (input.MenuSelect)
            {

                if (menu.Iterator == 0)
                {
                    gamestate = GameStates.Running;
                    SetUpSingle();
                    menuClose.Play();
                }
                else if (menu.Iterator == 1)
                {
                    gamestate = GameStates.Running;
                    SetUpMulti();
                    menuClose.Play();
                }
                else if (menu.Iterator == 2)
                {
                    this.Exit();
                    menuClose.Play();
                }
                menu.Iterator = 0;
            }
        }

        else if (gamestate == GameStates.End)
        {
            if (input.MenuSelect)
            {
                gamestate = GameStates.Menu;
                hud.ResetHealth();

            }
        }

      // Updates the HUD
      hud.Update(gameTime);
        base.Update(gameTime);
    }

    // Checking for bat collision & instructs the ball where to deflect to
    private int CheckHitLocation(Bat bat)
    {
        int block = 0;
        if (ball.GetPosition().Y < bat.GetPosition().Y + bat.GetSize().Height / 20) block = 1;
        else if (ball.GetPosition().Y < bat.GetPosition().Y + bat.GetSize().Height / 10 * 2) block = 2;
        else if (ball.GetPosition().Y < bat.GetPosition().Y + bat.GetSize().Height / 10   * 3) block = 3;
        else if (ball.GetPosition().Y < bat.GetPosition().Y + bat.GetSize().Height / 10 * 4) block = 4;
        else if (ball.GetPosition().Y < bat.GetPosition().Y + bat.GetSize().Height / 10 * 5) block = 5;
        else if (ball.GetPosition().Y < bat.GetPosition().Y + bat.GetSize().Height / 10 * 6) block = 6;
        else if (ball.GetPosition().Y < bat.GetPosition().Y + bat.GetSize().Height / 10 * 7) block = 7;
        else if (ball.GetPosition().Y < bat.GetPosition().Y + bat.GetSize().Height / 10 * 8) block = 8;
        else if (ball.GetPosition().Y < bat.GetPosition().Y + bat.GetSize().Height / 20 * 19) block = 9;
        else block = 10;
        return block;
    }

    protected override void Draw(GameTime gameTime)
    {
        GraphicsDevice.Clear(Color.Black);

        // TODO: Add your drawing code here
        spriteBatch.Begin();
        if (gamestate == GameStates.Running)
        {
            // Draws background
            spriteBatch.Draw(backgroundTexture, new Rectangle(0, 0, screenWidth, screenHeight), Color.White);

            player.Draw(spriteBatch);

            // Draws the bats and ball
            leftBat.Draw(spriteBatch);
            rightBat.Draw(spriteBatch);
            ball.Draw(spriteBatch);

            // Draws the score on screen
            spriteBatch.DrawString(arial, leftBat.GetPoints().ToString(), new Vector2(screenWidth / 4 - arial.MeasureString
                (rightBat.GetPoints().ToString()).X, 20), Color.White);
            spriteBatch.DrawString(arial, rightBat.GetPoints().ToString(), new Vector2(screenWidth / 4 * 3 - arial.MeasureString
                (rightBat.GetPoints().ToString()).X, 20), Color.White);                                               
        }

            // Only draws the menu
        else if (gamestate == GameStates.Menu)
        {
            spriteBatch.Draw(backgroundTexture, new Rectangle(0, 0, screenWidth, screenHeight), Color.White);
            menu.DrawMenu(spriteBatch, screenWidth, arial);
        }
        else if (gamestate == GameStates.End)
        {
            spriteBatch.Draw(backgroundTexture, new Rectangle(0, 0, screenWidth, screenHeight), Color.White);
            menu.DrawEndScreen(spriteBatch, screenWidth, arial);
        }
        spriteBatch.End();

        // Draws the HUD
        if (gamestate == GameStates.Running)
        {               
            hud.Draw(gameTime);
        }

        spriteBatch.Begin();
        // Powerup text
        if (gamestate == GameStates.Running)
        {
            spriteBatch.DrawString(font, "Press A or Left Alt button to generate powerup", promptVec, Color.White);

            if (powerup != null)
            {
                spriteBatch.DrawString(font, "Powerup Type: " + powerup.Type, vec, Color.White);

                spriteBatch.DrawString(font, "Press Left Bumper or  Left Ctrl to activate powerup", vec2, Color.White);

            }

            if (deactivatedVec != Vector2.Zero)
                spriteBatch.DrawString(font, "Powerup deactivated", deactivatedVec, Color.White);

            if (activatedVec != Vector2.Zero)
                spriteBatch.DrawString(font, "Powerup activated", activatedVec, Color.White);

            if (tickVec != Vector2.Zero)
                spriteBatch.DrawString(font, "Tick count: " + tickCount.ToString(), tickVec, Color.White);
            }
        spriteBatch.End();

        base.Draw(gameTime);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T23:20:48.790

我敢打赌，你没有看到蝙蝠可见尺寸的变化，但你应该看到蝙蝠击中检测的变化。你只是在改变球棒的大小。在您的碰撞检测代码中使用。但是，您在绘制球棒时没有参考球棒的大小。您必须更新代码以根据当前大小绘制球棒。

# vb.net - 如何在 Visual Studio 中调用基于变量的对象？

> ID：10307192
> 
> 赞同：1
> 
> 时间：2012-04-24T23:00:37.973
> 
> 标签：vb.net, visual-studio, variables, object, picturebox

所以我正在尝试编写 MasterMind 游戏，但我遇到了问题

我在 10 个不同的行中设置了 40 个图片框，我想让一个代码处理所有 10 行，而不是复制和粘贴代码并更改图片框的名称。我一直在尝试使用变量来实现这一点，但如果可能的话，那么我不知道正确的方法。
这就是我现在所拥有的：

```
 Dim X As Integer
 Dim Y As Integer
 Private Sub ButtonCheck_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ButtonCheck.Click
    If HighlightRow1 = True Then
        X = 1
        Y = 2
        Check1()
    ElseIf HighlightRow2 = True Then
        X = 4
        Y = 5
        Check1()
    ...
    EndIf
  End Sub
  Private Sub Check1()
      If PictureBox(X).Tag = "Red" //'Getting this error: Class 'System.Windows.Forms.PictureBox' cannot be indexed because it has no default property.

         blah blah blah
      ElseIf PictureBox(X).Tag = "Green" Then
         blah blah blah
      ...
      EndIf  

      If Picturebox(Y).Tag = "Red" Then
         blah blah blah
      ...
      End If 
```

有没有办法做到这一点？我是编程新手，所以如果这是一个非常简单的问题，我很抱歉。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T00:02:06.353

要检查所有图片框，请将所有图片框放入一个数组并使用 for each 循环来检查它们。

```
Private Sub Check1()
    Dim picBoxArr() As PictureBox = {PictureBox1, PictureBox2, PictureBox3, PictureBox4}
    For Each picBox in picBoxArr
        If picBox.Tag = "Red" Then
            'yada yada
        End If
    Next
End Sub 
```

要检查特定的图片框，请省略 for each 循环并使用索引来处理要检查的图片框。注意：索引从零开始，因此在这种情况下，picturebox1 的索引为零。

```
Private Sub Check1()
    Dim picBoxArr() As PictureBox = {PictureBox1, PictureBox2, PictureBox3, PictureBox4}
    If picBoxArr(0).Tag = "Red" Then
            'yada yada
    End If
End Sub 
```

您可以在此处阅读有关数组的更多信息[http://msdn.microsoft.com/en-us/library/wak0wfyt.aspx](http://msdn.microsoft.com/en-us/library/wak0wfyt.aspx)

# machine-learning - 我应该考虑使用什么学习算法来训练对数线性回归模型？

> ID：10307194
> 
> 赞同：6
> 
> 时间：2012-04-24T23:00:40.830
> 
> 标签：machine-learning

我需要在大量训练示例上训练回归模型，并有可能包含任意特征。我应该考虑哪些学习算法，为什么？

问题的快速总结：

*   大约 500 万个训练示例
*   以每年 2-4 百万的速度添加训练示例
*   训练示例目前每个包含 10 个特征
*   大约 400k 填充特征（在更大的总特征空间中）
*   随着时间的推移添加的其他功能
*   每天（至少）重新训练或调整模型以合并新示例
*   优化标准：最小平方百分比误差
*   输出：单个实数值

我有一些在类似大小的分类问题上训练对数线性模型的经验（使用 SVM、平均和投票感知器等）。添加任意特征的能力很重要，但在这种情况下，训练时间也很宝贵。

例如，到目前为止，我使用 SVMLight 进行的一项实验需要数周时间才能收敛到这些数据的一个子集。我们可以跨多核机器或（可能）集群并行化，但我们需要在几分钟内训练模型。在线培训会更好。

我成功（并且很快）训练了一个平均感知器模型。但是，据我所知，AP 通常不适用于回归。AP 是否为回归模型提供任何收敛保证？还有其他不应该适用的正式理由吗？或者这是否符合我的要求？

我应该研究哪些其他选择？SVM 可能会提供更高的准确性，但二次训练时间是不可接受的。如果可以访问线性时间 SVM 算法，那可能会很好用。

潜在优势：

*   在线培训
*   可用的开源实现（最好是在 Java 中）。如有必要，我们可以推出自己的实现，但如果可能的话，我会避免这样做。

感谢您的输入。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-27T15:02:21.593

这是大规模 SVM 的经典问题。如果添加了新功能，则需要重新训练 SVM 模型，如果您不使用在线 svm，则如果添加了新数据。一些选项：

*实用选项（现成的）：*

**LIBLINEAR** - 如果你可以做线性 SVM，那么有一些算法可以利用线性内核来提供比二次训练时间更好的时间。查看与 libsvm 来自同一研究组的 LIBLINEAR。他们刚刚在昨天发布的 1.91 版本中添加了回归。[http://www.csie.ntu.edu.tw/~cjlin/liblinear/](http://www.csie.ntu.edu.tw/~cjlin/liblinear/)

**Oracle ODM** - Oracle 在其 ODM 包中提供了 SVM。他们采用实用的方法基本上提供“足够好”的 SVM，而无需支付寻找真正最佳解决方案的计算成本。他们使用了一些采样和模型选择技术 - 您可以在此处找到相关信息：[http ://www.oracle.com/technetwork/database/options/advanced-analytics/odm/overview/support-vector-machines-paper-1205 -129825.pdf](http://www.oracle.com/technetwork/database/options/advanced-analytics/odm/overview/support-vector-machines-paper-1205-129825.pdf)

**SHOGUN** - SHOGUN 机器学习工具箱专为大规模学习而设计，它们与许多 SVM 实现以及其他方法交互。我从未使用过它，但它可能值得一看：[http ://www.shogun-toolbox.org](http://www.shogun-toolbox.org)

**Kernel-machines.org**有一个软件包列表：http: [//www.kernel-machines.org/software](http://www.kernel-machines.org/software)

*其他支持向量机研究*

如果你想自己动手，有许多技术可以尝试将 SVM 扩展到已在研究论文中发表的大型数据集，但代码不一定像上述示例那样可用、可用或维护。他们声称效果很好，但每个都有自己的缺点。许多涉及进行某种程度的数据选择。例如，一些研究论文使用线性时间聚类算法对数据进行聚类，并基于聚类训练连续的 SVM 模型，以便在不使用所有数据的情况下构建模型。核心向量机声称训练时间是线性的，但对于它们的准确度是否像他们声称的那样高存在一些批评。许多论文使用不同的启发式算法来尝试选择最有可能的支持向量候选者。其中很多是为了分类，但可能会适应回归。如果您想了解有关其中一些研究的更多信息，我可以添加一些参考资料。

**探索算法的工具**

*你可能已经熟悉这些了，但我想我会把它放在这里以防万一：*

还有其他算法在大型数据集上具有良好的运行时间，但很难说它们是否能正常工作，这取决于数据的构成。由于运行时很重要，我会从更简单的模型开始，然后再到更复杂的模型。ANN、决策树回归、贝叶斯方法、局部加权线性回归或混合方法，例如模型树，它是一种叶节点为线性模型的决策树，在大型数据集上都可以比 SVM 更快地完成，并且可能产生好结果。

**WEKA** - Weka 是探索您的选择的好工具。我会使用 WEKA 在不同的算法中尝试您的数据子集。源代码是开放的，并且在 java 中，如果您选择了可以根据您的需要进行调整的东西。[http://www.cs.waikato.ac.nz/ml/weka/](http://www.cs.waikato.ac.nz/ml/weka/)

**R** - R 编程语言也实现了许多算法，类似于 Matlab 中的编程。[http://www.r-project.org/](http://www.r-project.org/)

我不建议使用非大规模数据集的 WEKA 或 R，但它们是有用的工具，可以尝试缩小哪些算法可能对您有效。

# html - 请帮助新手解决 IE7 布局浮动故障

> ID：10307205
> 
> 赞同：0
> 
> 时间：2012-04-24T23:01:30.673
> 
> 标签：html, css, layout, internet-explorer-7, css-float

我对网页设计很陌生，需要一点帮助。我设计的网站主要使用 960.gs CSS 框架，除了我在标题中使用了一些浮点数，而标题现在在 IE7（和 IE6，但我不会打扰 IE6）中给我带来了一些问题。

问题在于 H1 是我的徽标（使用了图像替换），它已经向上移动，而 nav ul 已经从它应该从右向左浮动的位置移动。

谁能告诉我如何修复标题的以下代码以便它在 IE7 中工作？

**HTML**

```
 <div class="intro">

    <div class="container_12">

           <header>

            <div class="meta_bar">
                <ul>
                    <li><span>Free Quote:</span></li>
                    <li id="phone">444-444-4444</li>
                    <li id="email"><a href="mailto:someone@example.com?Subject=Information%20Request">info@example.com</a></li>
                </ul>
            </div>

            <h1><a href="index.html">ExampleCompany</a></h1>

            <nav>

                <ul>
                    <li class="selected"><a href="index.html">Home</a></li>
                    <li class=""><a href="services.html">Services</a></li>
                    <li class=""><a href="about.html">About</a></li>
                    <li class=""><a href="contact.php">Contact</a></li>
                </ul>

            </nav>

            <p>
                Lorem ipsum dolor sit amet, consectetur adipiscing elit integer in elit orci, a eleifend velit.
            </p>

        </header>

       </div><!--end header container-->

 </div><!--end intro--> 
```

**CSS**

```
.intro {
   border-top: 10px solid black;
}

.meta_bar {
    font-size: 12px;
    color: #8e8e8e;
    padding-top: 24px;
    float: right;
}

.meta_bar span {
    font-size: 11px;
    text-transform: uppercase;
}

.meta_bar li {
    display: inline;
    margin-left: 0.5em;
    padding-left: 1.5em;
}

.meta_bar a {
    color: #8e8e8e;
}

#phone {
    background: url(../img/phone.png) no-repeat left center;
}

#email {
    background: url(../img/email.png) no-repeat left center;
}

header {
    padding: 0 10px;
}

header h1 {
    float: left;
    clear: both;
    padding: 12px 0 20px 0;
    }

header h1 a {
    width: 228px;
    height: 65px;
    display: block;
    background: url(../img/sprite.png) 0 0 no-repeat;
    text-indent: -9999%;
    }

nav {
    float: right;
    margin-top: 36px;
}

nav li {
    display: inline;
    margin: 0 0 0 20px;
}

nav a {
    font-size: 14px;
    text-transform: uppercase;
    font-weight: bold;
    color: black;
    text-decoration: none;
}

nav a:hover {
    color: #e8960b;
    text-decoration: none;
}

.selected a {
    color: #e8960b;
}

header p {
    clear: both;
    border-top: 2px dashed #8e8e8e;
    text-align: center;
    font-family: Garamond, “Hoefler Text”, Times New Roman, Times, serif;
    font-size: 18px;
    padding: 22px 0 22px 0;
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T23:05:11.030

将您的 h1 标签包裹在标签内`<div>`，并为您的 div 标签提供所有样式。那应该可以解决问题。

# c++ - 在 C++ 中搜索和替换 C 风格的字符串

> ID：10307209
> 
> 赞同：3
> 
> 时间：2012-04-24T23:02:20.283
> 
> 标签：c++, c, search, pointers, c-strings

我正在尝试编写一个接受三个 c 样式字符串并返回一个 c 样式字符串的函数。此函数在 c 字符串中搜索所有出现的子字符串，并用不同的字符串替换它们。
这个程序有效，但看起来很不优雅。我情不自禁地感觉它本来可以用不那么笨重的方式完成。

```
char* replaceSubstring(char *original, char *from, char *to)
{
     int origlen = strlen(original);
     int i = 0;
     int count = 0;
     char *ptr;

     //figure out how many times the sub-string occurs in a string.
     //i couldn't figure out a way to avoid this loop
     while (i<origlen)
     {
           ptr = strstr(original+i, from);
           if (!ptr)
               break;
           else
           {
               i = ptr - original + 1;
               count++;
           }
     }
     //figure out what the size of the output string has to be
     int newsize = origlen + (strlen(to) - strlen(from)) * count;

     char *newstring = new char[newsize];  
     newstring[0] = '\0';  
     i = 0;
     while (i < origlen)
     {
          ptr = strstr(original+i, from);
          if (!ptr)
          {
               strcat(newstring,original+i);
               break;
          }
          else
          {
               //this looks extremely ugly and bulky...
               strncat(newstring, original+i, ptr-(original+i));
               strcat(newstring, to);
               i = i + ptr - (original + i) + strlen(from);
          }
     }
     strcat(newstring,"\0");
     return newstring;
} 
```

有人对如何使这段代码更清晰和/或更高效有任何建议吗？欢迎任何意见。请不要建议改用类字符串。这不是一个选择。该函数必须与 c 字符串一起使用

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T01:21:26.283

我会做的一项改进可能会同时提高优雅和效率，那就是

1.  分配一个整数数组，该数组将保存与给定字符串匹配的子字符串的索引。
2.  遍历字符串并找到所有匹配的子字符串，并将每个子字符串添加到数组中，根据需要重新分配更大的数组（因为您不想使用我认为的 STL；如果可以，请使用）。~~`std::vector`~~ ~~`std::list`~~ `std::deque`
3.  根据原始字符串的长度和找到的子字符串的数量为修改后的字符串分配新内存。
4.  同时迭代旧字符串和数组，将旧字符串中不匹配的部分复制到新字符串中。
5.  用替换字符串填充您留下的孔。

此外，我不会在函数内部动态分配内存，而是将其更改为接受调用者分配的缓冲区和最大缓冲区大小。这样，调用者可以完全负责内存的生命周期（如果他们愿意/可以使用自动内存），您不必担心计算缓冲区大小（您依赖调用者）。

* * *

编辑：

这是我创建的一个示例实现。如果有人发现任何错误，请告诉我，这很可能。（如果您想自己弄清楚，您可能不想阅读此内容。）

```
char* strreplace(const char* haystack, const char* needle, const char* replacement) {
    // using deque for pop_front
    std::deque<const char*> positions;
    unsigned int haystacklen    = strlen(haystack),
                 needlelen      = strlen(needle),
                 replacementlen = strlen(replacement);

    for (const char* cur = haystack, *pos = strstr(cur, needle); pos; cur = pos + 1, pos = strstr(cur, needle))
        positions.push_back(pos);

    char* newstr    = new char[haystacklen + replacementlen * positions.size() + 1],
          dst       = newstr;
    const char* src = haystack;

    while (src <= haystack + haystacklen)
        if (!positions.empty() && src == positions.front()) {
            strcpy(dst, replacement);
            dst += replacementlen;
            src += needlelen;
            positions.pop_front();
        } else
            *dst++ = *src++;

    return newstr;
} 
```

并且不要忘记`delete[]`该函数的返回值。

我追求效率而没有做最大的优化。例如，您可以有一个`while`循环执行，而`positions.empty()`当它为假时，然后当它变为真时，只需退出循环并直接`strcpy`执行其余部分，因为不再需要进行替换，这将让您避免不必要地`positions.empty()`调用*每个字符，即使没有替换，或者根本没有*。但我认为这是一个小问题，代码传达了这一点。

此外，我曾经删除所有阵列管理代码，但如果您想自己做，那应该是直截了当的。~~`std::list`~~ `std::deque`

正如 ildjarn 在评论中提到的那样，我从 更改`list`为`deque`因为我使用了该`size`成员，并且根据他的评论，它不是`O(1)`（通常是`O(n)`）在所有 C++11 之前的实现中，所以`deque`使用它的恒定时间`size`会更有效.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T01:43:50.143

如果您只需将 newstring 的大小设置为解决方案后的最大可能大小，您就可以摆脱代码的第一部分来计算计数。

尤其是：

```
int newsize = origlen + (strlen(to) - strlen(from)) * origlen/strlen(from); 
```

此外，不要多次调用 strlen(from)，只需将其分配给一个变量（例如 srtlen_from）并使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T02:25:33.413

这是我制作的一个版本，它几乎只使用指针（省略了错误检查等）（我还注意到它在某些情况下会失败）：

```
#include <cstring>
#include <cstdlib>
#include <iostream>

char* replaceSubstring(char *original, char *from, char *to)
{
// This could be improved (I was lazy and made an array twice the size)
    char* retstring = new char[std::strlen(original) * 2];

    int pos = 0;
    for (int i = 0; *(original + i); ++i)
    {   
        if (*(original + i) == *(from)) 
        {
            // Got a match now check if the two are the same
            bool same = true; // Assume they are the same
            for (int j = 1, k = i + 1; *(from + j) && *(original + k); ++j, ++k)
            {
                if (*(from + j) != *(original + k))
                {
                    same = false;
                    break;
                }
            }
            if (same)
            {
                // They are the same now copy to new array
                for (int j = 0; *(to + j); ++j)
                {
                    retstring[pos++] = *(to + j);
                }
                i += std::strlen(from) - 1;
                continue;
            }
        }
        retstring[pos++] = *(original + i);
    }
    retstring[pos] = '\0';
    return retstring;
}

int main()
{
    char orig1[] = "Replace all the places that say all";
    char* r1 = replaceSubstring(orig1, "all", "Replacement");
    std::cout << r1 << std::endl;
    delete [] r1;

    char orig2[] = "XXXXXX with something else XXXXXX";
    char* r2 = replaceSubstring(orig2, "XXXXXX", "hello");
    std::cout << r2 << std::endl;
    delete [] r2;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-25T20:41:12.210

[不言自明： http](http://ideone.com/ew5pL) ://ideone.com/ew5pL

这就是丑陋和笨重的样子——除了最后的 strlen 和 memcpy 之外，没有 C 函数。

我觉得你的看起来又漂亮又紧凑。

# php - 先更新或删除，然后再插入

> ID：10307212
> 
> 赞同：2
> 
> 时间：2012-04-24T23:02:36.773
> 
> 标签：php, mysql, sql-insert, sql-delete

我再次问这个问题，因为我无法从关于 SO 的其他问题中得到直接的答案。

我的情况如下，两张表，`phones`和`features`.

结构：

**电话**

*   ID
*   品牌标识
*   模型
*   图片
*   发表

**特征**

*   ID
*   电话号码
*   特征

现在，`features`包含很多值，只有 1 和 4 之间的值对应于某个电话 via `phone_id`。

现在，当我*更新*功能时，您认为**删除**然后再次**插入**新功能还是**更新**现有功能最好？

// 编辑：

**特价商品**

*   ID*
*   电话号码
*   合同编号
*   开始发布
*   完成_发布
*   发表

**合同**

*   ID*
*   姓名
*   益处
*   期间
*   价格等

**品牌**

*   ID
*   姓名
*   标识

所以基本上，一个特殊的链接电话和合同在一起，并从两个表中获取信息以进行输出。然后在这个过程中，每部手机的功能都会使用一个函数单独加载。

// 编辑 2：

哦，一次只能删除/更新**一部**手机的功能，而且一次只能删除 1-4 个功能。此外，特征总是可以或多或少，而不是一个固定的数字。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T23:04:46.303

当您“更新功能”时，您就是这样做的，`update`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T23:08:39.580

应该使用更新。或者，删除和插入可以在一个 REPLACE 命令中完成。

[http://dev.mysql.com/doc/refman/5.0/en/replace.html](http://dev.mysql.com/doc/refman/5.0/en/replace.html)

此外，如果可以共享功能（多对多关系），您可能需要考虑仅将电话 ID 链接到功能 ID 的第三个表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T23:09:36.277

如果每部手机的功能数量会发生变化，那么您必须删除并插入。要更新，您需要：

*   获取当前的特征集
*   弄清楚有什么不同，添加了什么，删除了什么
*   运行查询以更新、插入新数据和删除旧数据。

就好像您只是删除整个列表并重新插入它们一样，您可以省去一些维护上的麻烦。

如果您的数据的一致性是一个问题或担忧（数据被删除但在插入之前发生错误导致脚本无法完成），那么将您的查询包装在事务中。

举个例子：

我有一个博客`Posts(id, title, body)`和`Categories(id, post_id, category)`。我的第一篇文章“Hello World”被归类为“meta、php 和 javascript”。然后一年后，我修改了帖子以获得一些关于mysql的信息（或者我添加了一个mysql类别）并取出了javascript。

这是我需要做的（主要是伪代码）：

```
//old set
SELECT * FROM Categories WHERE post_id=1

foreach($categories as $category) {
    if(in_array($category['id'], $_POST['categories']) {
        //this category is in the new set and the old set, do nothing
    }
    elseif(!in_array($category['id'], $_POST['categories']) {
        //this category is in the old set, but not the new one, delete it
        $queries[] = "DELETE FROM Categories WHERE id=".$category['id'];
    }
    else {
        //new category, add it
        $queries[] = "INSERT INTO Categories()..."
    }
}

foreach($queries as $item) {
    //run query
} 
```

与此相反：

```
DELETE FROM Categories WHERE post_id=$_POST['id']

foreach($_POST['categories'] as $item) {
    INSERT INTO Categories() ...
} 
```

就个人而言，我认为选项＃2更好。

# iphone - Objective c - 在 vi ewDidLoad 中获取核心数据对象

> ID：10307216
> 
> 赞同：0
> 
> 时间：2012-04-24T23:03:28.027
> 
> 标签：iphone, objective-c, core-data, nsfetchedresultscontroller, nsthread

很多时候，我在我的应用程序中遇到这样的情况，我正在推送视图控制器并从核心数据中获取对象以填充 UI。现在我通常在主线程上的 viewDidLoad 中执行此操作，并且我确信有更好的方法来执行此操作，可能在不同的线程上。

如果确实线程是要走的路，我在目标c中没有很多线程经验，所以如果有人能给我展示代码示例，我将不胜感激。

而且我知道核心数据不是线程安全的，所以为了安全起见，我应该做任何额外的工作吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T05:14:38.153

您可能应该使用 NSFetchedResultsController。它将为您管理批处理，并且只加载您当时需要的内容。它不仅适用于表格视图。您可以在没有单独线程的情况下执行此操作（只要您的数据库不太大，并且您的 fetch 没有需要访问数据库中每条记录的过于复杂的谓词）。

作为 FRC 的替代方案，或者在需要所有记录的情况下，您可以使用单独的线程，该线程将获取对象，然后将它们呈现给主线程。

这些是在单个 SO 答案中难以解释的概念，因此如果仍然没有意义，请查阅 Core Data Concurrency Programming Guide。

或者，如果您想全部加载并进行一些控制，您可以执行以下操作。注意：我认为这种双 MOC 模式无论如何都是要走的路，因为无论如何它都更容易做背景。就此而言，如果您使用 UIManagedDocument，无论如何您都可以免费获得其中的大部分内容。

请注意，这可能需要更长的整体加载时间，但它会释放 UI 线程。

```
NSManagedObjectContext *workerMoc = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSPrivateQueueConcurrencyType];
workerMoc.persistentStoreCoordinator = psc;
// The "mainMoc" will be a child of the worker
NSManagedObjectContext *mainMoc = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSMainQueueConcurrencyType];
mainMoc.parentContext = workerMoc; 
```

然后在加载...

```
// The actual work will run in the background on the worker queue
// The "worker" queue will do the fetching and faulting, then pass object IDs
// to the mainMoc, which will fault its MOs from the parent
[workerMoc performBlock:^{
    NSFetchRequest *fetchRequest = // Create fetch request
    NSArray *fetchResults = [workerMoc executeFetchRequest:fetchRequest error:0];
    [fetchResults enumerateObjectsUsingBlock:^(NSManagedObject *obj, NSUInteger idx, BOOL *stop) {
        // Probably want to fault the object in before going to mainMoc
        // since that can also take some time...
        // Can also "batch" them in some small number of objects.
        NSManagedObjectID *objectID = obj.objectID;
        [mainMoc performBlock:^{
            NSManagedObject *fetchedObject = [mainMoc objectWithID:objectID];
            // Do something with it now that you are back on the main thread...
        }];
    }          
}]; 
```

# c# - HTTP Post 截断字符串

> ID：10307218
> 
> 赞同：3
> 
> 时间：2012-04-24T23:03:36.427
> 
> 标签：c#, http, post

我正在使用以下代码执行 HTTP Post。这在大多数情况下都可以正常工作，但会以一定长度切断我的字符串，大约 4300 个字符串字符。我怎样才能解决这个问题？我有一种预感，这与所有未发布并在发布期间被切断的数据有关。我怎样才能解决这个问题？

```
ASCIIEncoding encoding = new ASCIIEncoding();
                // Create a request using a URL that can receive a post. 
                WebRequest request = WebRequest.Create("<URL>");
                // Set the Method property of the request to POST.
                request.Method = "POST";
                // Create POST data and convert it to a byte array.
                string postData = "json=" + json;
                //string postData = "json=blah";
                byte[] byteArray = Encoding.UTF8.GetBytes(postData);
                // Set the ContentType property of the WebRequest.
                request.ContentType = "application/x-www-form-urlencoded";
                // Set the ContentLength property of the WebRequest.
                request.ContentLength = byteArray.Length;
                // Get the request stream.
                Stream dataStream = request.GetRequestStream();
                // Write the data to the request stream.
                dataStream.Write(byteArray, 0, byteArray.Length);
                // Close the Stream object.
                dataStream.Close();
                // Get the response.
                WebResponse response = request.GetResponse();
                // Display the status.
                //Console.WriteLine(((HttpWebResponse)response).StatusDescription);
                // Get the stream containing content returned by the server.
                dataStream = response.GetResponseStream();
                // Open the stream using a StreamReader for easy access.
                StreamReader reader = new StreamReader(dataStream);
                // Read the content.
                retVal = reader.ReadToEnd();

                // Clean up the streams.
                reader.Close();
                dataStream.Close();
                response.Close(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T19:46:54.457

Uri.EscapeDataString(json) 成功了。

# ios - 将 CIFilter 应用于 iOS 中的视频

> ID：10307220
> 
> 赞同：3
> 
> 时间：2012-04-24T23:03:48.583
> 
> 标签：ios, core-image

我正在开发一个视频会议应用程序，以下代码成功地在屏幕上绘制了一个框架：

```
 -(int)drawFrameOnMainThread{
    if(mBitmapContext){
        if(mDisplay){
            CGImageRef imageRef = CGBitmapContextCreateImage(mBitmapContext);
    #if TARGET_OS_IPHONE
            UIImage *image = [UIImage imageWithCGImage:imageRef];

            [self performSelectorOnMainThread:@selector(setImage:) withObject:image waitUntilDone:YES];

    #elif TARGET_OS_MAC
            [mDisplay setCurrentImage:imageRef];
    #endif
            CGImageRelease(imageRef);
        }
    }
    return 0;
} 
```

我想将 CIFilter 应用于正在绘制的框架，所以我修改了代码的 iOS 部分，如下所示：

```
UIImage *image = [UIImage imageWithCGImage:imageRef];

        CIImage *beginImage = image.CIImage;

        CIContext *context = [CIContext contextWithOptions:nil];

        CIFilter *filter = [CIFilter filterWithName:@"CISepiaTone" 
                                      keysAndValues: kCIInputImageKey, beginImage, 
                            @"inputIntensity", [NSNumber numberWithFloat:0.8], nil];
        CIImage *outputImage = [filter outputImage];

        CGImageRef cgimg = 
        [context createCGImage:outputImage fromRect:[outputImage extent]];
        UIImage *newImg = [UIImage imageWithCGImage:cgimg];

[self performSelectorOnMainThread:@selector(setImage:) withObject:newImg waitUntilDone:YES]; 
```

结果是我的视频屏幕保持黑色。任何人都可以在这里看到错误吗？我已经在这几个小时了，但无法弄清楚。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T21:58:28.970

我已经解决了这个问题，问题在于初始化 CIImage 行：

```
//Wrong 
```

`CIImage *beginImage = image.CIImage;`

```
//Right
CIImage *beginImage = [CIImage imageWithCGImage:imageRef]; 
```

正如布拉德所说，性能是不可接受的。在 iPad2 上，视频比音频滞后约 5 秒。所以我会为此研究其他解决方案，但我仍然很高兴看到它更像是一个概念证明而不是其他任何东西:)

# c# - 在独立的表单帖子中编辑视图上的子实体，同时保留唯一的 HTML Id

> ID：10307222
> 
> 赞同：1
> 
> 时间：2012-04-24T23:04:01.980
> 
> 标签：c#, asp.net-mvc-3, razor

**我需要什么帮助**

我正在寻找***最佳实践方法***来处理在单独的隔离表单帖子中的视图上编辑子实体，同时在子实体之间保留唯一的 HTML Id。

例如，在视图的顶部，我希望能够更改有关订单的低级详细信息（即总计、运输方式、地址等）。本节将发布到一个采取`OrderViewModel`.

然后我想显示一个可以单独编辑的 Shipments 列表，每个都有自己的表单帖子，这些帖子映射到特定 ViewModel 类型的操作......在我的例子`ShipmentViewModel`中。

`OrderViewModel`我想对包括`OrderItems`、、`OrderPayments`等上的各种其他子实体属性执行相同的操作`OrderCoupons`。

**为什么？**

这样做的目的是，在更改订单的小细节时，我不必在每个表单帖子中传递完整的水合订单。

**我尝试了什么？**

我目前使用一个主视图进行这项工作`OrderEdit.cshtml`，它使用部分视图`_OrderDetailEdit.cshtml`来显示订单详细信息的表单。然后，它使用 for 循环遍历 Shipments，并调用`Html.EditorFor(m => m.Shipments[i])`以利用我的自定义发货编辑器模板。

**问题**

这种方法的问题是我用于编辑 Shipments 的 Action 方法被迫采用.`OrderViewModel`而不是`ShipmentModel`. 这并不理想，因为它总是会通过一个且只有一个装运来补充水分。`orderEditViewModel.Shipments[0]`在我的行动中使用它闻起来很糟糕。

在使用编辑器模板之前，我只有一个用于编辑 Shipments 的 Partial，它允许我将表单发布到具有理想方法签名的 Action。这种方法的问题是每个 Shipment 的 HTML id 都是相同的，导致我正在使用的 jQuery 插件出现 UI 问题。

# c# - 在 Windows Phone 上使用 XmlReader 读取 BIG5 编码数据

> ID：10307223
> 
> 赞同：1
> 
> 时间：2012-04-24T23:04:11.907
> 
> 标签：c#, xml, windows-phone-7, character-encoding, big5

我正在尝试从此处链接获取 XML 内容。然后获取“item”元素的内容以显示在屏幕上。这是 WP7 上的一种 RSS 阅读器。问题是当我检查内容时，字节似乎已经用不同的编码方式修改（翻译）了，应该使用 BIG5 但不是。但是，本机浏览器确实显示了那些 BIG5 编码字符。不知道他们是怎么得到的。

我试过这个

```
using (XmlReader reader = XmlReader.Create(URL) //URL to a XML file on Internet
while (reader.Read())  // iterate through the document
    switch (reader.NodeType)  
        case XmlNodeType.Text:  
            string s = reader.Value; // The string displayed as garbage 
```

而且我尝试按照 Jesse 的建议使用 EncodingGenerator，但这不起作用，因为它不支持多字节编码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T19:26:23.687

我认为不支持 BIG5 编码通常是 Windows Phone 的问题，而不是 XmlReader 的问题。因此，如果您切换到 HtmlAgilityPack，您最终会遇到同样的问题。

查看[https://stackoverflow.com/a/10277767/736079](https://stackoverflow.com/a/10277767/736079)以获得可能的解决方案。

# security - 如何使用 Symfony 2 制作如下所示的权限系统？

> ID：10307224
> 
> 赞同：5
> 
> 时间：2012-04-24T23:04:14.867
> 
> 标签：security, permissions, symfony, implementation, acl

**一般说明**

系统应该处理许多组织成嵌套类别的项目（参见下面的视觉示例），同时让客户端能够定义权限规则（参见下面的权限规则）。它还应该处理独立于任何项目的不同一般权限（例如，“可以查看特定页面？”或“可以邀请新成员？”）。

所有用户都组织成组。每个用户都有一个他所属的主要组，但他也可能有一些额外的辅助组。

一些用户可以被配置为超级管理员并且应该被允许做任何事情。

在决定是否允许用户做某事时，权限继承如下：

*   从主组权限开始
*   允许用户的任何其他组允许的所有权限
*   如果已定义，请检查用户特定权限（允许或拒绝，与上述无关）。不必定义用户特定的权限，如果没有定义，用户只需从组权限继承权限

在定义组权限时，客户端可以使用继承来表示：

*   允许用户...
*   编辑拥有用户的所有权限**+** ...
*   版主拥有编辑的所有权限**+** ... **-** ...
*   Admins 拥有 Editors **+** Moderators的所有权限

**注意：**我应该能够从数据库中请求当前用户可以编辑/查看的最后 10 个项目，每个项目的权限应该由数据库决定，我不想在应用程序级别过滤项目以获得权限如果我可以根据存储在数据库中的信息来决定。

**权限规则**

规则可能取决于项目的任何属性（例如项目所有者的主要组、创建时间、类别等），该信息存储在数据库中。

规则还可能取决于当前用户的任何属性（例如注册日期、邀请的成员）、请求的操作（例如查看、列表、重命名、撤消删除等）以及运行时已经可用的其他信息（例如 url 参数，配额限制，项目的内容，服务器负载），该信息可用于 php 脚本。

请参阅下面的示例规则。

**数据库模式的**可视化示例：****

 **```
Category 1
   Nested Category A
      item x
   Nested Category B
      Deeply Nested Category
         item w
      item y
Category 2
   item z 
```

目前，数据库架构如下，但如果需要，我可以更改它：（当然这只是架构的一部分，还有其他表和字段）

*项目*：

```
id | title  | owner_id | category_id
====================================
1  | item x | 2        | 3
2  | item y | 1        | 4
3  | item z | 3        | 2
4  | item w | 1        | 5 
```

*类别*：

```
id | parents | title
=====================================
1  | null    | Category 1
2  | null    | Category 2
3  | 1       | Nested Category A
4  | 1       | Nested Category B
5  | 1/4     | Deeply Nested Category 
```

*用户*：

```
id | name | group | all_groups | is_super_admin
===============================================
1  | Tony | 5     | 5          | 1
2  | John | 5     | 5,8,6      | 0
3  | Mike | 4     | 4,7        | 0
4  | Ryan | 6     | 6          | 0 
```

**示例规则**

以下规则只是应实施的真实案例示例。

*   用户可以在提交后5分钟内编辑自己的项目（）
*   用户“John”可以编辑“类别 1”及其所有嵌套类别中的所有项目。
*   编辑者可以编辑除所有者标记为超级管理员的项目之外的所有项目。

请注意，这些规则可以像我案例中的大多数规则一样在数据库级别决定。

**执行**

我搜索了 symfony 文档、stackoverflow 等。有很多关于安全和 acls 主题的有趣文章和问题，但我找不到处理这样一个系统的最佳方法。

很明显，我需要某种类型的动态查询构建器来根据定义的规则根据存储在数据库中的信息过滤行。我假设第二步（涉及未存储在数据库中的信息，如当前服务器负载）可能是实现一个投票者（参见[本文](http://kriswallsmith.net/post/15994931191/symfony2-security-voters)或[这个问题](https://stackoverflow.com/questions/7879173/symfony2-acl-combined-with-another-criteria)中的投票者示例），或者有时甚至更简单的解决方案（例如规则取决于请求的路径）。如果解决方案涉及多件事情来处理权限，还请描述如何将它们集成在一起使用。

**问题**

我在问如何实现这样的系统，请不要回答 symfony 文档或其他具有一般想法和常见简单案例的资源的链接。在回答之前，请阅读并理解我的案例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-02-20T09:31:12.553

**我意识到这个问题很老，但答案适用于 Symfony 2.3+，所以我把它贴在这里。**

对于这种方法，您应该使用[SecurityVoters](http://symfony.com/doc/current/cookbook/security/voters_data_permission.html)之类的东西。

使用安全投票器，您可以实现任何您可以想象的访问控制逻辑。

选民的工作就像

```
$this->get('security.authorization_checker')->isGranted('update',$post); 
```

这将检查所有投票者，他们可以操作 Post 实体（参见文档）并将他们的投票与选择的策略（肯定、共识、一致）结合起来，以决定当前用户是否有权更新帖子（对于您的第一个 tule 示例）

您可以为单个操作实现多个投票者，并定义策略 hove 来决定结果投票。

您可以存储在存储库中的所有组和权限，并使用 voter 中的学说获取它们。

您还可以定义自定义角色层次结构以简化安全工作

另请阅读[SecurityComponent上的这些文档](http://symfony.com/doc/current/components/security/authorization.html)**

# java - 是否有可用的 Google App Engine 源代码和 JavaDoc JAR 包？

> ID：10307225
> 
> 赞同：2
> 
> 时间：2012-04-24T23:04:15.137
> 
> 标签：java, google-app-engine, maven

我注意到著名的 Maven 存储库不提供 Google App Engine 服务 Java 源 JAR 或 Javadoc JAR。例如，[http://search.maven.org/#browse%7C-1636166512](http://search.maven.org/#browse%7C-1636166512)仅提供类 JAR。

作为比较，log4j 为类 JAR 提供源 JAR 和 Javadoc JAR；也就是说，在[http://search.maven.org/#browse%7C1442692743](http://search.maven.org/#browse%7C1442692743)，`log4j-1.2.16.jar`伴随着`log4j-1.2.16-sources.jar`和`log4j-1.2.16-javadoc.jar`

这些源/Javadoc JAR 是否可用于 GAE Java 模块？

（未捆绑的）源代码可在[https://code.google.com/p/googleappengine/source/browse/trunk/java/src](https://code.google.com/p/googleappengine/source/browse/trunk/java/src)获得。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T10:59:27.547

从相应的 GAE 页面下载 Java SDK。在这个 .jar 文件中，我使用以下文件/文件夹：

源文件：

```
src\orm\*.zip 
```

Javadoc 文件：

```
docs 
```

SDK 中的“自述”文件详细说明了 SDK 中文件夹的含义。

享受？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-30T08:41:48.707

现在在您提供的原始位置有一个源 .zip 文件 [https://code.google.com/p/googleappengine/source/browse/trunk/java/src/appengine-api-src.zip](https://code.google.com/p/googleappengine/source/browse/trunk/java/src/appengine-api-src.zip)

因此，虽然在 Eclipse 中它不像“Maven>Download Sources”那么容易，但您至少现在可以将它放在本地的某个地方，“Properties>Java Source Attachment”放在项目中的 .jar 上，并设置该 .zip 文件的位置. 这为您提供了 eclipse 也将显示 javadoc 的来源。

# asp.net - 在 asp.net mvc3 中创建登录页面

> ID：10307231
> 
> 赞同：0
> 
> 时间：2012-04-24T23:04:57.393
> 
> 标签：asp.net, database, asp.net-mvc-3

我是 ASP.NET MVC 的新开发人员。我想在我的应用程序中为用户帐户创建一个登录页面。我看过许多使用 Enity Framework 的教程，但我更喜欢使用 SQL，现在我无法决定选择哪一个！谁能解释一下使用 SQL 还是 EF 更好？任何答案都会很有帮助。
谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T23:09:56.527

好吧，这是一个偏好问题，

当您说使用 EF 或 sql 时，我认为您的意思是带有 sprocs 和动态 sql 的 ADO。还有 NHibernate 需要考虑。

最终，像实体框架或 NHibernate 这样的 ORM 可以节省大量与传统数据库方法（如 ADO）相关的繁重和重复代码，它们自己在某些情况下使用该技术来执行。

ORM 提供了一种抽象，使开发人员可以更轻松地使用它，因为您使用的是对象而不是数据集（传统上，如果开发人员具有 OO 背景，则很难使用数据集）。

然而，这项技术有自己的学习曲线。我建议你看看实现代码，如果你对其他技术没有信心并实现你的功能，也许现在只使用普通 SQL。

一旦你让它工作并且很高兴其他 MVC 东西工作正常，你也许可以重构代码以使用 EF。它真的将取决于你想使用多少。

**就我个人而言，我喜欢在大多数**查询（尤其是 CRUD 操作）上使用 ORMS 而不是存储过程，但有些人对 sprocs 和 sql 发誓。实际上，大多数应用程序将同时使用两者，因为存储过程在批量操作方面具有优势。

**比用于数据层的实现技术更重要的是，数据层设计得很好。**

# javascript - 带有 jquery 的 Onclick 处理程序

> ID：10307234
> 
> 赞同：2
> 
> 时间：2012-04-24T23:05:45.200
> 
> 标签：javascript, jquery, jquery-ui

我有以下代码

```
<div class="test-123">
   <p>Some Text</p>
   <div class="delete"></div>
   <div class="edit"></div>
</div> 
```

问题是我必须为三个元素（ test-123、delete 和 edit ）设置 onclick jquery 处理程序。我面临以下问题。当我单击删除时，test-123 的 onclick 处理程序也会在删除的 onclick 处理程序完成后执行。

有没有办法以某种方式防止这种情况？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T23:07:40.287

你正在寻找`stopPropogation`

```
event.stopPropagation() 
```

[http://api.jquery.com/event.stopPropagation/](http://api.jquery.com/event.stopPropagation/)

```
$(function(){   
    $(".test-123").click(function(){
       alert("click on div"); 
    });      
    $(".delete,.edit").click(function(e){
       e.stopPropagation() 
       alert("click on Links"); 
    });    
});​ 
```

注释掉这一`e.stopPropagation`行，看看会发生什么。

工作演示：http: [//jsfiddle.net/Pjn3s/2/](http://jsfiddle.net/Pjn3s/2/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-24T23:07:01.060

请参阅 jQuery 的[`event.stopPropagation`](http://api.jquery.com/event.stopPropagation/). 这将防止其他侦听器触发。例如，

```
$("p").click(function(event){
  event.stopPropagation();
  // do something
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T23:09:49.257

正如@paislee 所说，传播存在问题。您是否使用 jQuery 方法“live”，例如：

```
$('selector').live('click', function(){
//The actions
}); 
```

我认为您应该检查“委托”方法的使用，该方法“强制”您为必须应用闭包的元素设置顶级父级。它比任何方式（甚至点击事件）都更安全。

# google-app-engine - 删除 App Engine Datastore 中的实体，但它一直被恢复？

> ID：10307235
> 
> 赞同：0
> 
> 时间：2012-04-24T23:06:03.017
> 
> 标签：google-app-engine, google-cloud-datastore

我删除了一个实体，管理日志告诉我它已被删除：“删除了一个实体”。

它消失了，至少有一段时间，然后突然复活发生了！

有什么想法可能在这里发生吗？我现在删除了 4 次相同的项目！

它让我有点疯狂:)

我正在使用主/从数据存储。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T01:02:12.463

可能是您在其他地方运行的代码正在创建相同的实体。它可能是一个任务、cron 启动的任务、一个正常的 Web 请求等。你可能想检查一下。

是的，切换到 HRD。:)

# javascript - 设置匿名结构的元素

> ID：10307238
> 
> 赞同：1
> 
> 时间：2012-04-24T23:06:33.170
> 
> 标签：javascript

我想在创建时设置结构数组的元素。可能吗？

现在，首先我要定义结构，然后设置数组

```
function struct(a, b) {
    this.a=a;
    this.b=b;
}

var foo = [
    new struct(1,2),
    new struct(3,4),
] 
```

但我想要一个匿名函数，比如：

```
var foo = function(a, b) [
    (1,2),
    (3,4),
] 
```

*注意：这是不正确的，但你看到了这个想法*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T23:10:29.250

除了数组文字表示法之外，您要使用的是对象文字表示法。

```
var foo = [
  {a:1,b:2},
  {a:3,b:4}
];
console.log(foo[0].b); //-> 2 
```

如果你真的想调用一个函数，你必须给它一个名字（虽然它可以很短）：

```
function s(a,b){
  return {a:a,b:b};
}
var foo = [
  s(1,2),
  s(3,4)
]; 
```

*您不需要使用`new`关键字来创建新对象；您可以设置一个新实例——[甚至设置基于原型的继承](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/create)——所有这些都在一个普通的函数调用中。*

# c++ - 在类之间交换变量的正确方法是什么？

> ID：10307239
> 
> 赞同：-2
> 
> 时间：2012-04-24T23:06:38.843
> 
> 标签：c++

我有类配置：

```
class Config
{
    public:
        Config();
        ~Config();
        void Read();
        CData var; //CData - some config structure
}; 
```

从其他类访问值的正确方法是什么？有几个选项：

1.  使其全球化
2.  将引用转移到其他类
3.  你的变种

在我的系统`config.var.some`中，90% 的课程都需要。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T23:20:16.607

3) You can use statics, which is basically like making it global.

```
class Config
{
    public:
        static CData var; //CData - some config structure
        static CData Read();
};

//these in a cpp file
CData Config::var = Config::Read();

int main() {
    std::cout << Config.var.something;
} 
```

but in this case, it's probably best just to make `var` itself global.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T23:13:43.487

第三种方式：在`Config`类中添加访问器函数。

```
class Config
{
    public:
        Config();
        ~Config();
        void Read();
        int getNumberOfFooBars() const { return var.foo_bars; }
private:
        CData var; //CData - some config structure
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T23:13:52.237

我通常会将这样的对象作为参考传递，而不是懒惰并使其成为全局对象。如果您传递对象，那么通过查看构造函数/成员初始化器列表很明显哪些类将使用该对象。相反，使其全局化（作为单例或其他）会使您或其他人难以一眼看出哪些类需要该对象。

向配置类添加访问器函数，允许其他对象通过定义的接口访问其成员。这将允许您在不破坏与配置类接口的代码的情况下更改类的内部结构。

# c# - winforms C#/NET中comboBox1上的跨线程错误

> ID：10307243
> 
> 赞同：0
> 
> 时间：2012-04-24T23:07:11.827
> 
> 标签：c#, winforms, visual-studio-2010, .net

已经有一个关于这个的问题了。但这里有另一个问题有点不同，我找不到任何遮阳篷！

```
String text = this.GuiThread(() => this.comboBox1.Text); 

 if (text == "this")
 {
   //do somthing spectacular!
 } 
```

text 是一个空变量左右..

使用未分配的局部变量。这是我得到的错误..并且 iv 测试了我可以在此处和 msdn 找到的所有示例。

我也有：

```
 public static class ControlExtensions
    {
        public static void GuiThread(this Control ctrl, Action action)
        {
            if (ctrl.InvokeRequired)
            {
                ctrl.BeginInvoke(action);
            }
            else
            {
                action.Invoke();
            }
        }
    } 
```

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T23:21:12.387

This code cannot compile. The GuiThread returns void, you are trying to assign that to a string. How you can get an exception is unguessable. It needs to at least look like this:

```
public static class ControlExtensions {
    public static T GuiThread<T>(this Control ctrl, Func<T> action) {
        if (ctrl.InvokeRequired) {
            return (T)ctrl.Invoke(action);
        }
        else {
            return action();
        }
    }
} 
```

Don't write code like this, the actual ComboBox text you'll read is pretty random since it can be obtain *while* the user is modifying it. Give a thread the arguments it needs when you start it. The BackgroundWorker class keeps you out of trouble.

# qt - 如何通过 Qt gui 应用程序显示视频的帧？

> ID：10307245
> 
> 赞同：2
> 
> 时间：2012-04-24T23:07:31.607
> 
> 标签：qt, video, opencv, qt-creator

我正在尝试通过 OpenCV 库的方法播放其帧来处理视频，并使用`imshow`opencv/highgui 的方法显示这些帧，这里没有问题。

但是当涉及到使用 Qt-gui 应用程序实时显示它们时，我无法管理。

程序从 openfile 对话框中获取视频的路径，并开始在 while 循环中抓取视频的帧并处理它们。在处理步骤之后，当我尝试在 QLabel 上显示这些处理过的帧时，gui-app 的 QLabel 不显示任何内容（沿着视频的长度），而只显示视频末尾的最后一帧，没有别的。我尝试刷新/更新每一帧的标签，但没有奏效。

我错过了一些事情要做吗？或者有什么更方便的方法吗？

我的代码的必要部分如下。提前致谢。

```
bool stop=false;
cv::VideoCapture capture("a.avi");
cv::Mat cur_frame;

while (!stop) {    
             //...               
             capture.read(cur_frame);                
             //process steps..               
             QImage img= QImage((const unsigned char*)(cur_frame.data),
                                 cur_frame.cols,cur_frame.rows,
                                 QImage::Format_RGB888);
             ui->label->setPixmap(QPixmap::fromImage(img));
             // resize the label to fit the image
             ui->label->resize(ui->label->pixmap()->size());
             //...
             cv::waitkey(50);
             } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T23:24:09.787

Qt 只能在控件返回到事件循环时更新 UI。您可以尝试`qApp->processEvents()`在循环中调用，但这可能不是最佳方法。

# jms - 我可以与 JMS 消息选择器的当前日期进行比较吗？

> ID：10307248
> 
> 赞同：1
> 
> 时间：2012-04-24T23:07:43.260
> 
> 标签：jms, tibco-ems

我想将消息放入具有日期/时间作为消息属性的队列中，并在该属性满足与当前日期相关的条件时从队列中提取消息。

例如，假设我想在 3:00 消费消息。我的想法是将属性设置为 3:00，然后有一个消息选择器，例如`event_timestamp <= CURRENT_TIMESTAMP`.

我知道 JMS API 的消息选择器是基于 SQL 的，所以我想以查询数据库的方式使用它，我可能有一个关键字，比如`CURRENT_TIMESTAMP`or `NOW()`，或类似的。消息选择器表达式语法中是否有类似的东西，或者实现这种结果的另一种方式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T20:53:27.817

据我所知，JMS 规范中没有可用于选择器的功能。根据[消息选择器参考](https://docs.tibco.com/pub/enterprise_message_service/6.3.0-february-2012/doc/html/tib_ems_users_guide/wwhelp/wwhimpl/common/html/wwhelp.htm#context=tib_ems_users_guide&file=EMS.5.022.htm)，可能有些存在于供应商特定的实现扩展中，但不存在于 tibco 中。

由于消息选择器是特定的固定参数`MessageConsumer`，因此您必须`selector`使用当前日期（或其他）和 call 来制作字符串[`Session.createConsumer`](http://docs.oracle.com/javaee/6/api/javax/jms/Session.html#createConsumer%28javax.jms.Destination,%20java.lang.String%29)，`Session.createDurableSubscriber`或者`Session.createBrowser`每次此选择器查询更改时。

我建议您为所有消费者保持相同的连接和会话，以保持合理的性能。

另一种选择是使用消息浏览器打开消息的属性来计算您的条件，然后在匹配时决定有效地使用它，但这个想法绝对是一个常规轮询，它打破了消息传递的理念。

我猜您在定义的时间戳之后发布一条消息以供将来处理。由于消息过期，也许还有另一种实现您的要求的方法。一般来说，代理可以配置为将过期消息从队列 A 移动到另一个队列 B，因此它会为您完成这项工作：您的消费者仅在队列 B 过期后才侦听可用的消息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-04-07T01:37:49.597

如果您的服务器符合 JMS 2.0，请使用交付延迟功能：`JMSProducer.setDeliveryDelay(long deliveryDelay)`.
当您将消息放入队列时，计算延迟到所需时间。
延迟到期时消息将变为“可见” [JMS 2.0 新特性](http://www.oracle.com/technetwork/articles/java/jms2messaging-1954190.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T09:03:34.440

任何东西都可以放入消息的用户定义属性中。例如，用户属性`MyTimeStamp`和属性值设置为`3.00`，那么您可以使用选择器，您可以将选择器设置为`MyTimeStamp='3.00'`。消息到达队列后将立即传递给等待的消费者。这并不意味着消息将在系统时间为下午 3 点时交付给消费者。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-05T21:40:37.230

您可以使用 Unix 时间/纪元时间（自 1970 年以来的#seconds）中的 JMSTimestamp。这是一个长篇。

我没有尝试过，但这似乎很容易。

# android - 清除 SharedPreferences 中的 TextFields

> ID：10307257
> 
> 赞同：0
> 
> 时间：2012-04-24T23:08:43.337
> 
> 标签：android, sharedpreferences

如何在`onCreate`不影响旧的 SharedPreferences 的情况下清除活动的 SharedPreferences 字段的内容？除非用户按下“addUser”，否则不会保存 SharedPreferences；我希望他能够在编辑首选项之前取消并返回。

所以这意味着名称字段在开始时必须为空，但如果我检索它的值，它必须包含一些旧的 SharedPreferences；如果我按“addUser”，那么 sharedpreference 将更改为新值。

这是我的代码

```
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.createprofile);
    SharedPreferences customSharedPreference = getSharedPreferences(
            "myCustomSharedPrefs", Activity.MODE_PRIVATE);

    name = (EditText) findViewById(R.id.namefield);
    // When i take off this line the name is cleared but if i do it to other fields it crashes.
    name.setText(customSharedPreference.getString("namepref", ""));

    age = (EditText) findViewById(R.id.agefield);

    age.setText(customSharedPreference.getString("agepref", ""));

    genderradiogroup = (RadioGroup) findViewById(R.id.radioGroup2);
    rb_male = (RadioButton) findViewById(R.id.maleradiobutton);
    rb_female = (RadioButton) findViewById(R.id.femaleradiobutton);
    genderradiogroup.check(customSharedPreference.getInt("genderprefs",
            rb_male.getId()));
   genderradiogroup.check(customSharedPreference.getInt("genderprefs",
          rb_male.getId()));

    weight = (EditText) findViewById(R.id.weightfield);
    weight.setText(customSharedPreference.getString("weightpref", ""));

    height = (EditText) findViewById(R.id.heightfield);
    height.setText(customSharedPreference.getString("heightpref", ""));

    levelofactivity = (RadioGroup) findViewById(R.id.radioGroup3);
    rb_light = (RadioButton) findViewById(R.id.lightradiobutton);
    rb_moderate = (RadioButton) findViewById(R.id.moderateradiobutton);
    rb_heavy = (RadioButton) findViewById(R.id.heavyradiobutton);
   levelofactivity.check(customSharedPreference.getInt("levelpref",
           rb_light.getId()));

        Age = Integer.parseInt(age.getText().toString());
        Weight = Integer.parseInt(weight.getText().toString());
        Height = Integer.parseInt(height.getText().toString());

    Button addUser = (Button) findViewById(R.id.checkcreateprofilebutton);

    addUser.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {

            savePreferences();

            float calnumber = calculateCalories(Age, Weight, Height);
            String lala = String.valueOf(calnumber);
            Toast.makeText(ProfilePreferenceActivity.this, lala,
                    Toast.LENGTH_LONG).show();

            usertable.open();
            long id = usertable.createUser(name.getText().toString(), age
                    .getText().toString(), gender, weight.getText()
                    .toString(), height.getText().toString(), level,
                    calnumber);

            Toast.makeText(ProfilePreferenceActivity.this,
                    "user added with" + level + gender, Toast.LENGTH_LONG)
                    .show();

            usertable.close();

            Intent Filling = new Intent();
            Filling.setClass(ProfilePreferenceActivity.this,
                    FillingActivity.class);
            startActivity(Filling);

        }
    });

}

private void savePreferences() {

    SharedPreferences customSharedPreference = getSharedPreferences(
            "myCustomSharedPrefs", Activity.MODE_PRIVATE);
    SharedPreferences.Editor editor = customSharedPreference.edit();
    editor.putString("namepref", name.getText().toString());
    editor.putString("agepref", age.getText().toString());
    editor.putInt("genderprefs", genderradiogroup.getCheckedRadioButtonId());
    editor.putString("heightpref", height.getText().toString());
    editor.putString("weightpref", weight.getText().toString());
    editor.putInt("levelpref", levelofactivity.getCheckedRadioButtonId());
    editor.putFloat("calpref", calnum);
    editor.commit();
    finish();

}

public float calculateCalories(int age, int weight, int height) {

    if (rb_male.isChecked()) {

        gender = "male";

        bmr = 66.5f + (13.75f * weight) + (5.003f * height)
                - (6.755f * age);

        if (rb_light.isChecked()) {
            level = "light";
            calnum = bmr * 1.375f;
        }
        if (rb_moderate.isChecked()) {
            level = "moderate";
            calnum = bmr * 1.55f;
        }
        if (rb_heavy.isChecked()) {
            level = "heavy";
            calnum = bmr * 1.725f;
        }

    } else if (rb_female.isChecked()) {

        gender = "female";

        bmr = 665 + (9.563f * weight) + (1.850f * height) - (4.676f * age);

        if (rb_light.isChecked()) {
            level = "light";
            calnum = bmr * 1.375f;
        }
        if (rb_moderate.isChecked()) {
            level = "moderate";
            calnum = bmr * 1.55f;
        }
        if (rb_heavy.isChecked()) {
            level = "heavy";
            calnum = bmr * 1.725f;
        }

    }
    return calnum;

}} 
```

# c - Swig Lua 会员代

> ID：10307258
> 
> 赞同：0
> 
> 时间：2012-04-24T23:08:50.200
> 
> 标签：c, lua, swig

我在我的 Swig 接口文件中有以下内容，用于连接一个小型 GUI 库的 .c/.h：

```
%{
    void Widget_name_set( Widget *widget, char *name )
    {
        if( !name ) return;

        WidgetSetName( widget, name );
    }

    char *Widget_name_get( Widget *widget )
    {
        return WidgetGetName( widget );
    }
%}

struct Widget
{
    %extend
    {           
        char name[ 32 ];

        Widget( void )
        {
            return WidgetNew();
        }

        ~Widget()
        {
            if( $self ) WidgetDelete( $self );
        }

        void SetName( char *name )
        {
            Widget_name_set( $self, name );
        }

        char *GetName()
        {
            return Widget_name_get( $self );
        }
    }
}; 
```

然后我使用接口文件生成一个 Lua 包装器。如果我在 Lua 中调用以下命令，结果几乎与预期一样：

```
w = Widget(); 
w:SetName("test"); 
```

一切都好。但如果我这样做：

```
w = Widget(); 
w.SetName( nil, "test" ); 
```

由于参数为零，它显然会崩溃。有没有办法（使用 Swig 接口或在 Lua 中）来抑制所有带点的调用，只保留带列的调用？像这样对用户来说会更容易，并且会避免我添加 1000 万个指针检查等......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T23:38:26.450

> 有没有办法（使用 Swig 接口或在 Lua 中）来抑制所有带点的调用，只保留带列的调用？

不，就 Lua 而言，这只是语义上的糖。使用`.`方法来访问成员。using`:`意味着当你调用函数时，第一个参数是被访问的表`:`。

你可能甚至无法分辨出检查 Lua 反汇编的区别（尽管不可否认，这只是我的猜测）；到那时，它可能已经转换为最终形式。

# css - 动态 DIV 高度

> ID：10307270
> 
> 赞同：0
> 
> 时间：2012-04-24T23:11:05.857
> 
> 标签：css

在页面的头部我有

```
<style type="text/css">
    html {
        overflow: hidden
    }
    html, body, #centralDIvision {
        margin-left: auto;
        margin-right: auto;
        width: 1100px;
        height: 400px;
    }
    #centralDivision {
        float: left;
    }
    #outer {
        display: table;
        position: absolute;
        height: 100%;
        width: 100%
    }
</style> 
```

但不是让 centralDivision div 的高度等于 400px，我希望它是浏览器当前屏幕尺寸的 75%。我有办法做到这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T23:45:18.420

只是为了多样性，另一种方法，使用绝对定位：

```
#parent {
    position: relative;
    height: 400px;
}
#child {
    position: absolute;
    top: 12.5%;
    bottom: 12.5%;
    left: 0;
    right: 0;
}​ 
```

当然还有一个[关于 jsFiddle 的工作示例](http://jsfiddle.net/eliranmal/bzMMz/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T23:16:00.863

`#centralDIvision { height: 75%; }` will get you pretty close, if the #centralDIvision element is a direct descendent of the body. (When height is specified in %, it's based on the parent's height.)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T23:14:13.327

你试过替换这个

```
height: 400px; 
```

有了这个？

```
height: 75%; 
```

# php - PHP查询，获取过去24小时的行

> ID：10307273
> 
> 赞同：4
> 
> 时间：2012-04-24T23:11:35.073
> 
> 标签：php

我正在尝试制作一份报告，显示最后一天的所有贷款。时间作为时间戳保存在数据库onloan中，格式为yyyy-mm-dd 00:00:00。我到目前为止的代码如下所示，但我无法正确格式化时间和-1天。

```
$yday  = mktime(0, 0, 0, date("m")  , date("d")-1, date("Y"));
$query = "SELECT * 
          FROM onloan
          WHERE (time > $yday)"; 
```

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-24T23:15:01.537

你想用`strtotime()`.

尝试`$yday = date('Y-m-d h:i:s', strtotime("-1 day"))`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T23:20:31.397

尝试

```
SELECT * 
FROM onloan
WHERE DATE(Time) = DATE(CAST(NOW() - INTERVAL 1 DAY AS DATE)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T23:16:46.343

你可以试试：

```
select * from onloan where date(time)=date(date_sub(now(),interval 1 day)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T23:22:19.640

这是一种更简单的 SQL 方法。

```
$query = "SELECT * FROM onloan WHERE DATEDIFF(NOW(),time) <= 1"; 
```

# drupal - 从模块更改主题设置

> ID：10307276
> 
> 赞同：0
> 
> 时间：2012-04-24T23:11:53.227
> 
> 标签：drupal, drupal-7

我遇到了这个问题，我想创建一个模块来修改默认的自定义主题设置。这样，用户只能看到在 theme-settings.php 中设置的主题的某些设置，因此当他们更改主题时，主题设置会被拉入。他们的功能是这样做的吗？

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:07:25.650

哦，有一个名为[theme_get_setting](http://api.drupal.org/api/drupal/includes!theme.inc/function/theme_get_setting/7)的函数应该适合你。还有一个函数[theme_system_settings_form](http://api.drupal.org/api/drupal/modules!system!system.module/function/theme_system_settings_form/7)将返回表单以收集主题设置。其他主题功能可以在[Drupal 主题系统页面找到](http://api.drupal.org/api/drupal/modules!system!theme.api.php/group/themeable/7)

请注意，theme_system_settings_form 不是钩子，您应该像这样使用它来渲染表单：

```
$form = theme_system_settings_form();
/*Edit form here if needed*/
return $form; 
```

您可以将上述代码添加到模块中的 hook_settings 中。

这是关于 theme_system_settings_form 解决的问题的[讨论，您可以通过这个来了解该功能。](http://drupal.org/node/211015)尤其是结帐评论 2 和 3

希望这可以帮助。

干杯

# bash - 如何定义具有可变数量参数的shell脚本？

> ID：10307280
> 
> 赞同：40
> 
> 时间：2012-04-24T23:12:14.990
> 
> 标签：bash, shell

我想定义一个`gs`通过 shell 脚本调用 (ghostscript) 的简单缩写。第一个参数给出所有应该合并的文件，最后一个给出输出文件的名称。显然，以下内容不起作用（仅用于显示目标）：

```
#!/bin/sh
gs -dBATCH -dNOPAUSE -q -sDEVICE=pdfwrite -sOUTPUTFILE=$last $1 $2 ... 
```

如何才能做到这一点？

人们通常会通过`myscript infile1.pdf infile2.pdf ... outfile.pdf`或调用此脚本`myscript *.pdf outfile.pdf`。

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2012-04-24T23:17:41.827

bash 变量`$@`并`$*`展开为命令行参数列表。一般来说，你会想要使用`"$@"`（即`$@`用双引号括起来）。如果有人向您的脚本传递一个包含空格的参数，这将做正确的事情。

所以如果你的脚本中有这个：

```
outputfile=$1
shift
gs -dBATCH -dNOPAUSE -q -sDEVICE=pdfwrite -sOUTPUTFILE=$outputfile "$@" 
```

你这样调用你的脚本：

```
myscript out.pdf foo.ps bar.ps "another file.ps" 
```

这将扩展为：

```
gs -dBATCH -dNOPAUSE -q -sDEVICE=pdfwrite -sOUTPUTFILE=out.pdf foo.ps bar.ps "another file.ps" 
```

阅读手册页的[“特殊参数”](https://www.gnu.org/software/bash/manual/html_node/Special-Parameters.html)部分以`bash`获取更多信息。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-04-25T01:51:34.560

要将输出文件作为最后一个参数传递，请使用数组：

```
ARGS=("$@")
# Get the last argument
outputfile=${ARGS[-1]}
# Drop it from the array
unset ARGS[${#ARGS[@]}-1]

exec gs ... -sOUTPUTFILE=$outputfile "${ARGS[@]}" 
```

在版本 4 之前，`bash`不允许在数组中使用负下标（并产生 Marius 在评论中报告的错误），因此如果您使用的是 3.x，则需要使用更丑陋的

```
outputfile=${ARGS[${#ARGS[@]}-1]} 
```

这也适用于 bash 4.x。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2016-05-21T17:37:39.670

要访问最后一个参数，除了上面 Idelic 的答案之外，您还可以执行以下操作：

```
echo "${@: $#}" 
```

这会读取所有参数并从最后一个参数开始打印它们。这样，您还可以访问最后 N 个参数，例如最后三个参数：

```
echo "${@: $#-2}"

$ ./script "what    does" "this  script" "do" "?"
this  script do ? 
```

# c - ！！c 运算符，是不是两个？

> ID：10307281
> 
> 赞同：34
> 
> 时间：2012-04-24T23:12:15.370
> 
> 标签：c, operators, logical-operators

我读了这段[代码](https://gist.github.com/909424#L115)，并有这一行

```
 switch (!!up + !!left) { 
```

什么是`!!`运营商？两个逻辑非？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-04-24T23:13:43.320

是的，这是两个不。

`!!a`is `1`if`a`是非零并且`0`if`a`是`0`

您可以将其`!!`视为对 的钳位`{0,1}`。我个人认为这种用法是一种看起来很花哨的错误尝试。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-04-24T23:33:16.150

你可以这样想象：

```
!(!(a)) 
```

如果你一步一步做，这是有道理的

```
result = !42;    //Result = 0
result = !(!42)  //Result = 1 because !0 = 1 
```

这将返回`1`任何数字（-42、4.2f 等），但只有`0`，这会发生

```
result = !0;    //Result = 1
result = !(!0)  //result = 0 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-04-25T00:04:42.607

`!!`是一个更便携（C99 之前）的替代`(_Bool)`.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-04-24T23:22:34.547

你是对的。这是两个不。要了解为什么要这样做，请尝试以下代码：

```
#include <stdio.h>

int foo(const int a)
{
    return !!a;
}

int main()
{
    const int b = foo(7);
    printf(
        "The boolean value is %d, "
        "where 1 means true and 0 means false.\n",
        b
    );
    return 0;
} 
```

它输出`The boolean value is 1, where 1 means true and 0 means false.` 如果你放弃`!!`，它会输出`The boolean value is 7, where 1 means true and 0 means false.`

# ios - BOOL 未保存在用户默认值中

> ID：10307285
> 
> 赞同：0
> 
> 时间：2012-04-24T23:13:14.390
> 
> 标签：ios, xcode, nsuserdefaults

有人可以帮我理解为什么这个布尔值不保存吗？

这是我在视图中加载的代码：

```
[appDelegate.defaults setBool:YES forKey:@"testKey"];
[appDelegate.defaults synchronize];
NSLog (@"TEST BOOL VALUE = %@", [appDelegate.defaults boolForKey:@"testKey"] ? @"YES" : @"NO"); 
```

在应用程序委托 applicationDidFinishLaunching 中，我将 appdelegate.defaults 定义为：

```
 self.defaults = [NSUserDefaults standardUserDefaults]; 
```

为什么这不起作用我真的不知道。

谢谢！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T23:28:07.513

`appDelegate`是`nil`当您调用提到的代码时。

尝试添加一个`NSSlog`来检查：

```
NSLog(@"appDelegate: %@", appDelegate);
NSLog(@"appDelegate.defaults: %@", appDelegate.defaults);
[appDelegate.defaults setBool:YES forKey:@"testKey"];
// ... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T23:39:55.403

你应该使用：

```
[[NSUserDefaults standardUserDefaults] setBool:YES forKey:@"testKey"]; 
```

或将`defaults`属性设置为`[NSUserDefaults standardUserDefaults]`

# asp.net - 从代码隐藏调用 ASP.NET Web API

> ID：10307286
> 
> 赞同：9
> 
> 时间：2012-04-24T23:13:15.113
> 
> 标签：asp.net, webforms, getjson, asp.net-web-api

如何直接从代码隐藏调用 ASP.NET Web API？或者我应该调用从代码隐藏中调用 getJSON 方法的 javascript 函数吗？

我通常有类似的东西：

```
 function createFile() {
        $.getJSON("api/file/createfile",
        function (data) { 
            $("#Result").append('Success!');
        });
    } 
```

任何指针表示赞赏。TIA。

*我正在使用 WebForms。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-25T00:10:24.113

如果您必须调用 Web 服务本身，您可以尝试`HttpClient` [按照 Henrik Neilsen 的描述](http://code.msdn.microsoft.com/Introduction-to-HttpClient-4a2d9cee)使用。

[更新的 HTTPClient 示例](https://blogs.msdn.microsoft.com/webdev/2012/08/26/list-of-asp-net-web-api-and-httpclient-samples/)

一个基本的例子：

```
// Create an HttpClient instance 
HttpClient client = new HttpClient(); 

// Send a request asynchronously continue when complete 
client.GetAsync(_address).ContinueWith( 
    (requestTask) => 
    { 
        // Get HTTP response from completed task. 
        HttpResponseMessage response = requestTask.Result; 

       // Check that response was successful or throw exception 
        response.EnsureSuccessStatusCode(); 

        // Read response asynchronously as JsonValue
        response.Content.ReadAsAsync<JsonArray>().ContinueWith( 
                    (readTask) => 
                    { 
                        var result = readTask.Result
                        //Do something with the result                   
                    }); 
    }); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-24T23:16:38.077

You should refactor the logic into a separate backend class and call it directly from youir code-behind and from the Web API action.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-24T23:16:31.530

Recommended in many software architecture books is that you shouldn't put any business logic in your (API)controller code. Assuming you implement it the right way, for instance that your Controller code currently accesses the business logic through a Service class or facade, my suggestion is that you reuse the same Service class/facade for that purpose, instead of going through the 'front door' (so by doing the JSON call from code behind)

For basic and naieve example:

```
public class MyController1: ApiController {

    public string CreateFile() {
        var appService = new AppService();
        var result = appService.CreateFile(); 
        return result;
    }

}

public class MyController2: ApiController {

   public string CreateFile() {
       var appService = new AppService();
       var result = appService.CreateFile(); 
       return result;
   }
} 
```

AppService class encapsulates your business logic (and does live on another layer) and makes it easier for you to access your logic:

```
 public class AppService: IAppService {

     public string  MyBusinessLogic1Method() {
       ....
       return result;
     }
     public string  CreateFile() {

          using (var writer = new StreamWriter..blah die blah {
            .....
            return 'whatever result';
          }

     }

    ...
 } 
```

# batch-file - 批处理脚本复制文件

> ID：10307293
> 
> 赞同：0
> 
> 时间：2012-04-24T23:14:14.017
> 
> 标签：batch-file, xcopy

我在尝试创建批处理脚本以将文件从源 A 复制到源 B 时遇到问题，但需要按日期复制文件大小大于 1KB 的最新文件。它还需要从源 A 复制文件并覆盖位于源 B 中的文件。

我使用下面的脚本作为示例我如何设置它。

**xcopy E:\sourceA\testA_* /DA C:\sourceB\TestB.txt /Y**

我不知道如何添加命令来抓取大于 1KB 的文件。对此的任何帮助将不胜感激。对不起，脚本不是我的事，而且是新的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T02:53:57.480

我不确定我是否完全理解您的要求，但我认为这就是您的要求

```
@echo off
pushd "E:\sourceA"
for /f "eol=: delims=" %%F in ('dir /a-d /b /o-d "testA_*"') do (
  if %%~zF geq 1024 (
      copy /y "%%F" "C:\sourceB\TestB.txt"
      goto :break
    )
)
:break 
```

如果您只想复制具有 Archive 属性的文件，并且仅当它比现有的 TestB.txt 更新时，则

```
@echo off
pushd "E:\sourceA"
for /f "eol=: delims=" %%F in ('dir /aa-d /b /o-d "testA_*"') do (
  if %%~zF geq 1024 (
      echo f|xcopy /dy "%%F" "C:\sourceB\TestB.txt"
      goto :break
    )
)
:break 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T14:08:19.903

```
@Echo OFF
Setlocal enabledelayedexpansion

:: By Elektro H@cker
::
:: Copy the Newest file in a folder greater than X bytes to a destination directory.
:: You maybe want to modify these variables:
::
Set "Source=%CD%"
Set "Destination=C:\Test\"
Set "Size=1024"
:: :: :: :: :: :: :: :: ::

for /F "tokens=1-4 delims=;" %%a in ('forfiles /P "%SOURCE%" /C "cmd /c echo @fdate;@ftime;@fsize;@path"') do (
    If %%c GTR %SIZE% (
        Set DAY=%%a
        Set DAY=!DAY:/=!
        Set HOUR=%%b
        Set HOUR=!HOUR::=!
        Echo !DAY!!HOUR!;%%d >> "%TEMP%\NewestFile.txt"
    )
)

for /F "tokens=2 delims=;" %%# in ('Type "%TEMP%\NewestFile.txt" ^| Sort /R') do (
    Copy /Y %%# "%Destination%" 1>NUL
    Del /Q "%TEMP%\NewestFile.txt"
    Exit
) 
```

# unity3d - MonoDevelop 中用于 XML 文档的 XSL 模板

> ID：10307294
> 
> 赞同：1
> 
> 时间：2012-04-24T23:14:41.657
> 
> 标签：unity3d, mono, monodevelop, xml-documentation

我将 MonoDevelop 与 Unity 3D 引擎一起使用，并创建了一个类库。我在每个函数等上方添加了 XML 文档注释。

生成 XML 数据文件非常简单，但是有没有我可以使用的默认 XSLT 模板？我已经看到了“MonoDoc”这个名字，但似乎没有任何类似的东西包含在 MonoDevelop 中，我也找不到下载。

从中生成 HTML 文件的最快方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T00:32:43.393

生成的 XML 文件可以使用 SandCastle (http://sandcastle.codeplex.com/) 进行编译。

我发现使用 SandCastyle 帮助文件生成器 (SHFB) 工具 (http://shfb.codeplex.com/) 更容易。

# java - 代码有问题

> ID：10307301
> 
> 赞同：2
> 
> 时间：2012-04-24T23:15:48.583
> 
> 标签：java, javascript, html, css

我做了一个代码，如你所见，第一行（精英玩家的盛大开幕）是完美的和绿色的。继续观察，直到它循环回来。文字变黑，我无法点击链接。有人有解决方案吗？[http://jsfiddle.net/Hunter4854/AtKtR/1/](http://jsfiddle.net/Hunter4854/AtKtR/1/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T23:34:53.950

**更新的答案：**好的，[这是你的 ticker 的工作版本](http://jsfiddle.net/KFFdg/)。问题是你不小心混合了元素`<li>`。`<a>`我现在已经`<ol>`完全删除了该元素并将其替换为`<div>`包含这些元素的简单`<a>`元素。我还清理了您的 CSS 代码，以便没有样式说明与 HTML 代码混合。然后我把那个 if 语句改成这样：

```
if (list.find('.link').length > 1 ) 
```

和以前一样，它正在寻找效果不佳的`li`元素。

* * *

**我最初的回答：**首先，`<a>`元素周围有`<li>`元素，这是非法的。`<a>`s 应该在s内`<li>`。[我为您创建了一个新的小提琴](http://jsfiddle.net/vUCKQ/)，我还将 JS 代码移动到 JS 窗口中，并将 CSS 代码移动到 CSS 窗口中以提高可读性。

查看具有 Chrome 的 Inspect 元素功能的 DOM，在我看来，这些`<a>`元素正在从 DOM 中删除，因此显然之后无法单击它们。对此做一些事情，它应该很快就会非常完美。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T23:41:43.400

只需删除第一个条目周围的 li ，它就会按照您设计的方式工作。

[带修复的新小提琴](http://jsfiddle.net/c4g2s/)

```
<a href="http://www.google.com" class="link" style="padding-top:2px; text-decoration:none;     color: #00B700; font-weight: bold; text-shadow: #00ff00 0px 0px 1px; ">Grand Opening of Elite Gamer</a> 
```

# c - Reading from text file using buffer and multithreading in C

> ID：10307302
> 
> 赞同：0
> 
> 时间：2012-04-24T23:15:48.707
> 
> 标签：c, multithreading, file-io, buffer

Part of a project I am working on requires me to read from a text file of unknown size and put the data into a 10KB buffer. I have to read the file into this buffer in 2KB chunks. I must have 4 threads running simultaneously. The first thread does the reading I just mentioned.

As the thread is reading in 2KB chunks of data into the buffer, the other three threads grab the 2KB chunk read in by the reader and conduct some calculations on it. Once these threads are done they grab the next 2KB chunk and do the same calculations. This is repeated until the entire text file has been read through.

Can anyone give me some guidance as to how to proceed with this part of the project? I know how to multithread. It is just the combination of multithreading and I/O that I have not had experience with before. I have only done simple I/O before.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T23:51:02.733

一种简单的机制可能是为 10K 缓冲区设置一个共享的“高水位线”。读取文件的线程（I/O 线程）将在适当的点更新它，“消费者”线程将读取它。它将受到互斥体的保护，当 I/O 线程更新它时，它会发出一个条件变量信号。只有 I/O 线程被允许写入该变量（同时持有互斥锁）和 10KB 缓冲区 - 其他线程被允许读取该变量（同时持有互斥锁）并且可以从缓冲区读取 - 但最多只能高水位线所指示的点。

一些非常粗略的伪代码（填写你自己的错误处理、检查完成、初始化等）：

```
pthread_mutex_t mux;
pthread_cond_var_t valid_bytes_updated;

int g_valid_bytes = 0;    // high water mark

char buffer[10 * 1024];

void* io_thread(...)
{
    int offset = 0;

    while (!done) {
        // read the next block of data
        readdata( file_handle, &buffer[offset], 2 * 1024);

        // let consumer threads know there's more data
        offset += 2 * 1024;
        pthread_mutex_lock( &mux);
        g_valid_bytes = offset;
        pthread_mutex_unlock( &mux);

        pthread_cond_broadcast( &updated);
}

void* consumer_thread(...)
{
    int processed_bytes = 0;

    while (!done) {
        // wait until there's something to do
        pthread_mutex_lock( &mux);
        while (processed_bytes == g_valid_bytes) {
            pthread_cond_wait( &valid_bytes_updated, &mux);
        }
        int valid_bytes = g_valid_bytes;
        pthread_mutex_unlock( &mux);

        // process the data in range &buffer[processed_bytes] to &buffer[valid_bytes], 
        //  keeping in mind that the range is up to but not including the byte at
        //  &buffer[valid_bytes]

        processed_bytes = valid_bytes;
    }
} 
```

# javascript - What data structure can I use to store and retrieve ranges of discrete values?

> ID：10307305
> 
> 赞同：6
> 
> 时间：2012-04-24T23:16:14.190
> 
> 标签：javascript, data-structures

I have a JavaScript program in which I will be managing a lot of ranges of integers. In this context, a range is simply a start and an end value (or anything equivalent, like a start and a length value), with a reference to another object. The ranges can overlap, and can be identical (although the referenced object will be different).

The possible start and end values are between 0 and 4294967295 (2^(32) - 1 or `0xFFFFFFFF`), although there are several big "holes" in the domain that no range will ever cover, even partially. Most ranges will be very small compared to the domain of possibilities: I expect that the overwhelming majority will have a length smaller than 2000.

My most important use case for this structure will be to look up all ranges that contain a given integer value. Most of the time, I expect the lookup to fail (there will be no range containing the given value).

Otherwise, I will obviously also need to add elements to it (often) and delete elements from it (seldom). Once in a while, too, I'll need to find all ranges that overlap a given range, rather than all ranges that contain a single value.

What kind of data structure can I use for that? A linear search in a list of ranges is impractical because the lookups fail most of the time; and I need to do lookups very, very often.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T23:55:51.490

键是开始（低）值的二叉树。一旦你找到一个键，你可以很容易地看起来很宽（更高和更低）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T23:29:38.007

如果您将所有范围的开始和结束存储在一个列表中作为映射回范围索引，您可以按顺序 n 执行此操作。即 mylist = [ {45: range1}, {47: range2}, {55: range1}, {57:range2} ] 然后您可以扫描列表并在您第一次看到标签时设置布尔值 true 和 false第二次看到它。当你找到一个比你高的数字时，你可以知道你在哪个范围内。您可以使用 bisect 插入 O(logn)，而删除和插入是 O(n)。祝你好运！〜本

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T23:23:00.253

我喜欢 System.Tuple 之类的东西 [或 F# 列表，但很少有人知道 F#]。

如果范围是连续的，那么将开始和结束整数作为元组很简单 Tuple nums = (start, end)，否则将具有开始结束的元组作为元组的第一个条目，将列表作为第二个条目可能对你有用，Tuple nums = ((start, end), List)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-25T00:16:26.440

**尝试 1：**

保留两棵二叉树，一棵用于起始值，一棵用于结束值。让两棵树的节点（或只是“结束”）具有通过某个 id（范围的起始值）引用唯一范围的属性。

在“开始”树上进行二分搜索，将列表缩小到开始小于或等于您的搜索值的范围。在值大于或等于搜索值的“结束”树上执行相同操作。从两棵树中找到节点的交集，这些范围包含您的搜索值。

您可以使用哈希映射/集找到交集以获得最佳性能。

**尝试 2：**

如果您为键是第一个但由开始值和结束值共享的许多位的间隔保留一个哈希列表怎么办？

因此，如果 start 是 '11001101' 并且 end 是 '11010010'，那么 key 是 '110'。每个键将映射到共享该键的范围（开始和结束）列表。

当搜索一个值以查看它们的范围时，例如“00101111”，您必须在哈希列表中搜索 n 个不同的值左右，其中 n 是位数（在您的情况下为 32）。在这种情况下，您将搜索“00101111”、“0010111”、“001011”等。对于每次点击，您都必须实际检查搜索值是否在范围内。

乍一看，在我看来，平均而言，对于您获得的每次命中，一半将是误报，但如果命中数很少，这无关紧要，而且键越大，它应该得到的命中越少.

有一个小问题，比如说“00101110”的开头和“01100111”的结尾，因为键是“0”，这意味着会有大量的“误报”。如果有 2 个不同的键“001”和“01”会更好，尽管我不确定您需要为此优化编码的特定算法。如果范围足够小并且可以解决或忽略此问题，那么您可以获得非常快速的查找，因为大多数键将相对较长并且与搜索不匹配。

# c# - 使用属性设置布尔属性

> ID：10307310
> 
> 赞同：0
> 
> 时间：2012-04-24T23:16:40.867
> 
> 标签：c#, attributes

有没有办法使用属性设置属性值？在视图模型中，我有一个属性：

```
public bool HasAccess{get;set;} 
```

并想做这样的事情：

```
[MyAttribute]
public bool HasAccess{get;set;} 
```

MyAttribute 应该设置 HasAccess 的值。我的问题是如何将 MyAttribute 构建到我将 HasAccess 的值设置为属性内赋予它的任何值的位置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T01:41:05.520

属性与*类型*相关联。您可以通过 Type.GetProperty() 和 PropertyInfo.GetCustomAttributes() 找到这个。这并不能帮助您设置*object*的属性值。除非 HasAccess 是静态的，否则它看起来不是。或者换句话说，您将无法为 PropertyInfo.SetValue() 的第一个参数提供值。

如果您已经拥有对象引用，那么这不是问题，使用它的 GetType() 方法并将对象传递给 SetValue。但这是其他地方的代码，而不是属性类中的代码。

# python - 如何更改传递给 python C-extension 的 numpy 数组元素？

> ID：10307313
> 
> 赞同：1
> 
> 时间：2012-04-24T23:17:09.603
> 
> 标签：python, numpy, python-c-extension

这应该是一个微不足道的问题，但作为初学者并没有弄清楚。

我有以下使用 numpy 数组的 Python C 扩展：

```
#include <cmath>
#include <Python.h>
#include <iostream>
#include "numpy/arrayobject.h"

using namespace std;
PyObject *func_calc(PyObject *self, PyObject *args)
{
    PyObject * PO_clmn;
    PyArrayObject * py_clmn;
    if (!PyArg_ParseTuple(args, "O", &PO_clmn))
        return NULL;
    py_clmn = (PyArrayObject*)PyArray_ContiguousFromObject(PO_clmn,PyArray_DOUBLE,1,1);
    double *clmn = (double*)(py_clmn->data);

    int i;
    int N = py_clmn->dimensions[0];
    int flag_threadholds[N_threadholds];
    for (i=0; i<N; i++)
    {
        clmn[i]=1;
    }
    return Py_None;
}

static PyMethodDef exampleMethods[] = 
{
    { "calc", func_calc, METH_VARARGS },
    { NULL, NULL }
} ;

PyMODINIT_FUNC initcalc()
{
    import_array();
    Py_InitModule("calc", exampleMethods);
} 
```

将其编译为共享库后，发现以下调用未能将元素 clmn 数组修改为“1”：

```
import numpy
from calc import calc
clmn=numpy.zeros(10)
calc(clmn)
print clmn #[0,0... 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T08:08:54.370

根据您传入的数据，调用`PyArray_ContiguousFromObject`可能会返回原始对象，也可能会返回对象的副本。如果它返回一个副本，那么您的代码正在修改该副本，而不是原始对象。

# iphone - Objective c - Is there a way to populate a table view with some animation?

> ID：10307314
> 
> 赞同：0
> 
> 时间：2012-04-24T23:17:22.370
> 
> 标签：iphone, objective-c, uitableview, viewdidload

I have a view controller with a table view and a NSArray that represent my model. In viewDidLoad I fill the array with objects and then I call [tableView reloadData] to fill the table view. The result is that the table view get filled in one chunk, and I don't like it.
I want it to slide down, like I was adding one cell after a nother.
Is this possible?

If I try to do something like this:

```
 [self.tableView beginUpdates];

    for (int i=0; i < sortedPersons.count; i++) {
        Person *personInfo = [sortedPersons objectAtIndex:i];
        [self.myMainModelArr addObject:personInfo];

        NSIndexPath *newIndexPath = [NSIndexPath indexPathForRow:i inSection:0];
        [self.tableView insertRowsAtIndexPaths:[NSArray arrayWithObject:newIndexPath] withRowAnimation:UITableViewRowAnimationFade];
    }

    [self.tableView endUpdates]; 
```

I get Invalid table view update error

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T00:18:43.817

使用 UITableView 时，您可以使用一些委托函数来帮助解决此问题。当你要向 tableView 添加一些东西时，一定要使用：

```
[tableView beginUpdates]; 
```

然后在插入时可以使用委托方法：

`- (void)insertSections:(NSIndexSet *)sections withRowAnimation:(UITableViewRowAnimation)animation`

然后在完成添加时，请务必使用：

```
[tableView endUpdates]; 
```

所有这些函数都可以从[UITableView 类参考中查看](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITableView_Class/Reference/Reference.html)

这里有一小段代码：[UITableView add cell Animation](https://stackoverflow.com/questions/3122934/uitableview-add-cell-animation)

# javascript - 当 JSLint 返回 45 个错误但代码仍然有效时，这意味着什么？

> ID：10307316
> 
> 赞同：-1
> 
> 时间：2012-04-24T23:17:35.250
> 
> 标签：javascript, jslint

JS lint 返回很多错误，但代码仍然有效 - 好，坏？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T23:20:32.800

JSLint 告诉您有关代码的**人类**可读性的信息。考虑到缩小后的代码是什么样子，我可以自信地告诉你，只要语法正确， JavaScript 解析引擎不会对代码是什么*样子感到惊讶。*

编辑：反正我不会担心。我刚刚将我的新项目的主 JS 文件粘贴到其中（52Kb，使用我可以完美阅读的编码风格编写）并且我得到“错误：错误太多” - 当我增加最大错误计数时，它只是说“错误: 停止”。我的代码显然太难读了，以至于 JSLint 在文件的 9% 之后就放弃了处理它的所有希望！但是如果你看它，你可能能够很好地理解它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T23:35:58.283

[JSLint 是http://www.jslint.com/lint.html](http://www.jslint.com/lint.html)上描述的代码质量工具 。

如果你的 js 代码通过了 jslint 测试，它一定是：

*   人类可读
*   不易出错
*   没有语法错误
*   没有 javascript 的坏部分

删去 jslint.com 上的描述：

> 如果它发现问题，它会返回一条描述问题的消息以及源中的大致位置。**问题不一定是语法错误，尽管它经常是。** JSLint 着眼于一些样式约定以及结构问题。它并不能证明你的程序是正确的。它只是提供了另一组眼睛来帮助发现问题。

# css - Best practice for font-size inheritance

> ID：10307317
> 
> 赞同：16
> 
> 时间：2012-04-24T23:17:40.337
> 
> 标签：css

working on converting our company site over to something more responsive so reworking the `css` to use `em`'s instead of the tried and true `px`.

The problem i'm running into is the inheritance of `font-size` and am looking for best practices for this issue.

This is how I'm solving the problem as of now.

[jsfiddle for your viewing pleasure](http://jsfiddle.net/danferth/uXVNn/)

**HTML**

```
<h3>Heading with a <a href="#">Link</a></h3>

<p>this is a paragraph with a <a href="#">Link</a> inside of it</p>
<a href="#">this is a link outside the paragraph</a>​ 
```

**CSS**

```
body {font:normal 100% sans-serif;}
p {font:normal 1.5em sans-serif; margin-bottom:.5em;}
h3 {font:bold 3em serif; margin-bottom:.5em; }
a:link {font-size:1.5em;}

p a, li a, h1 a, h2 a, h3 a, h4 a, h5 a,
h6 a, dl a, blockquote a, dt a, dd a, td a {
    font-size:1em !important;
} 
```

I understand that `em`'s are related to the parent `font-size`. so if I set `p{font-size:1.5em;}` and also set `a:link{font-size:1.5em;}` and my `<a>` is outside of my `<p>` then they will have the same relative size, great.

But if i then place an `<a>` inside a `<p>` the font size of the embedded `<a>` is now larger as it is `1.5em`'s larger than the `<p>`. To overcome this I set the last style with a string of `p a, li a, h1 a,......{font-size:1em !important;}`. Since `a:link` has a higher specificity than just `p a` i had to use `!important` (not a fan of `!important`), also i can't use `font-size:inherit;` as we have to support, dare i say it, `ie6` (still have 15% traffic, we are biotech and some companies just refuse to upgrade).

So my question to you is this. Am I going about this the right way in tackling tags inside of tags to prevent my typography from breaking up? As soon as i wrote the last style i thought to myself, this can become a nightmare to maintain! I would like to use `rem` but the browser support isn't there for a portion of users.

How do you solve this problem in your own css and what would be a "best practices" approach to this.

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-25T04:12:41.320

仅为块设置字体大小，例如标题和导航块。更改字体内联会导致混乱，所以不要为链接设置字体大小。相反，当需要时，设置包含导航链接的元素或其他元素`ul`的字体大小。`div`

一般来说，使用尽可能少的`font-size`设置，以尽量减少不必要的累积效应的风险。

笔记：

这根本与继承无关。当您`font-size`在一个元素上设置时，该元素肯定不会继承字体大小。这是关于`em`单位相对性质的影响。

`a:link{font-size:1.5em;}`例如，如果您已经设置，您可以轻松地为段落内的链接覆盖它，而无需使用`!important`. 你只需要更具体，这里的自然方式就是`p a:link{font-size:1em;}`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-25T00:46:13.110

您可能应该避免选择 just `a`，并且当您希望它们的大小与从容器继承的大小不同时，只需为它们添加更具体的选择器。我从不只为 更改字体大小`a`，而是在需要时更改其容器上的字体大小。同样，出于同样的原因，我避免为其他内联元素（例如 span、em、strong）添加字体大小。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T23:34:12.093

我建议使用重置样式表，例如[Eric Meyer 的 reset.css](http://meyerweb.com/eric/tools/css/reset/reset.css)，它将字体设置为在所有元素上继承。然后设置默认（或“主要”）字体大小`body`并使用相对`em`单位设置所有其他元素的字体大小。

您“堆叠”相对字体大小的问题应该不是问题，因为您**很少**需要在包含文本以外的任何内容（例如标题标签）的元素上设置新字体。在例外情况下，相对字体大小应该是您网站的一项资产，例如在页脚区域中，所有文本都应该比网站默认值小一点。

在相对字体大小导致不需要的行为的（极少数）情况下，您始终可以这样做：

```
p
{
    font-size: 1.5em;
}

a
{
    font-size: 1.5em;
}

p a
{
    font-size: 1em;
} 
```

# sql - SQL 关键字正式定义材料

> ID：10307322
> 
> 赞同：0
> 
> 时间：2012-04-24T23:19:00.523
> 
> 标签：sql, keyword, definition

我在网上寻找一个体面的教程或一篇文章，它们简单地正式定义了 SQL 中的每个关键字（至少对于初学者来说）的含义，以及它与其他 SQL 关键字的结合如何表现。我想知道在什么之前执行了什么，它是如何完成的以及它是如何正式定义的。

我得到的只是大量的例子，我浪费了时间，而不是仅仅知道关键字真正准确地做了什么，并且知道它是如何完成的也很高兴。

为什么人们想知道这一点不是微不足道的？为什么我打开的每本书和每一个关于 SQL 的网站都是通过示例进行教学，而不是像在 Java 的核心类方法实现中那样正式给出每个关键字的定义。

我只是不明白；你能解释一下为什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T07:41:51.877

有一个老笑话说 SQL 代表“几乎没有资格作为一门语言”。SQL 查询更像是一个规范，而不是一个程序：你描述你想要的东西——与自然语言的共同点是说同一件事的方式不止一种——系统可以以任何方式自由地实现它只要满足要求，它就认为合适**。

我可以彻底推荐这本书，[SQL and Relational Theory: How to Write Accurate SQL Code By CJ Date](http://books.google.co.uk/books?id=406_pJtiJ6sC&printsec=frontcover#v=onepage&q&f=false)。尽管它可能不能完全满足您的要求，但它确实解释了 SQL 的理论基础及其与它的偏差。

需要注意的一点是，SQL 标准多年来一直在发展，并且没有任何东西被弃用（称为“兼容性的枷锁”），导致 (IMO) 成为一种不直观、对用户不友好的语言。SQL 的刚性`SELECT..FROM..WHERE`，即在逻辑上执行`FROM..WHERE..SELECT`，意味着 SQL 中的投影是冗长且“昂贵”的，这只是 SQL 缺乏灵活性的一个例子。

* * *

> 我真的很难相信，到目前为止，还没有人真正了解 SQL 以完全能够准确地定义每个关键字的作用以及顺序。

Joe Celko 经常写这类东西。以下是谷歌的一些确切短语：

“这就是 SELECT 在 SQL 中的工作方式……至少在理论上是这样。”

“这是 OUTER JOIN 在 SQL-92 中的工作方式”

“搜索到的更新语句的正确语法是”

“CASE 不是开关；它是 SQL 中的**表达式**”

* * *

也就是说，我已经看到 SQL Server 错误以“无法修复”的形式关闭，因为虽然结果错误，但优化是正确的！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T23:58:05.943

至少有几个问题：

1.  该标准有很多版本：1986、1989、1992（一些工作大约在 1996 年左右）、1999、2003、2008 和 2011 版本。
2.  如今，该标准有多个部分。有 SQL/Foundation（核心 SQL），还有很多可选的扩展。
3.  每个 DBMS 都有自己对 SQL 标准的扩展，它们也都省略了标准的某些方面。

您可以在[此处](http://www.savage.net.au/SQL/)找到某些版本的标准的 BNF（Backus-Naur 格式）语法。这些是高度超链接的 HTML。然而，标准不仅仅是 SQL 语法；在标准的其余部分中，关于何时何地允许什么（通常没有太多解释为什么）有很多（很多很多）规则。该标准有时几乎不可能不透明。

下面是一个来自 ISO/IEC 9075-2:2003 (E) 的简单示例——这是 SQL-2003 的 SQL/Foundation：

> ## 10.7`<collate clause>`
> 
> ### 功能
> 
> 指定默认排序规则。
> 
> ### 格式
> 
> ```
> <collate clause> ::= COLLATE <collation name> 
> ```
> 
> ### 语法规则
> 
> 1) 令 C`<collation name>`包含在`<collate clause>`. 由显式或隐式限定符标识的模式`<collation name>`应包括 C 的描述符。
> 
> ### 访问规则
> 
> 1) 案例：
> 
> a) 如果在 中包含，没有指定 SQL SECURITY INVOKER`<collate clause>`的干预，则拥有包含模式的适用权限 应包括 C 上的 USAGE。`<SQL routine spec>``<SQL schema statement>``<authorization identifier>`
> 
> b) 否则，当前权限应包括 C 上的 USAGE。
> 
> 注 228——“适用特权”和“当前特权”在子条款 12.3，“<code><privileges>”中定义。
> 
> ### 一般规则
> 
> 没有任何。
> 
> ### 一致性规则
> 
> 1) 如果没有 Feature F690，“Collat​​ion support”，符合的 SQL 语言不得包含`<collate clause>`.

一个不太平淡的例子是`<cast specification>`有 16 页的 gobbledygook 描述它。这是从大约 2/3 开始。这是“一般规则”第 16 条（共 20 条）：

> 16) 如果 TD 是日期时间数据类型 TIME WITH TIME ZONE，则令 TSP`<time precision>`为 TD 的。
> 
> 案子：
> 
> a) 如果 SD 是字符串，则 SV 替换为：
> 
> ```
> TRIM ( BOTH ' ' FROM VE ) 
> ```
> 
> 案子：
> 
> i) 如果第 5.3 节“<code><literal>”中的 for`<literal>`或 for规则`<unquoted time string>`可应用于 SV 以确定数据类型 TD 的有效值，则令 TV 为该值。
> 
> ii) 如果第 5.3 节“<code><literal>”中的规则 for`<literal>`或 for`<unquoted time string>`可应用于 SV 以确定数据类型 TIME(TSP) WITHOUT TIME ZONE 的有效值，则令 TV1 为该值，并且让 TV 的值是：
> 
> ```
>  CAST ( TV1 AS TIME(TSP) WITH TIME ZONE ) 
> ```
> 
> iii) 如果 a`<datetime value>`不符合公历日期或时间的自然规则，则引发异常条件：数据异常 — 无效的日期时间格式。
> 
> iv) 否则，引发异常条件：数据异常 — 强制转换的无效字符值。
> 
> b) 如果 SD 是 TIME WITH TIME ZONE，则 TV 是 SV，必要时使用实现定义的舍入或截断。
> 
> c) 如果 SD 是 TIME WITHOUT TIME ZONE，则 TV 的 UTC 分量为 SV – STZD，以 24 小时为模计算，必要时进行实现定义的舍入或截断，TV 的时区分量为 STZD。
> 
> d) 如果 SD 是 TIMESTAMP WITH TIME ZONE，则 TV 的 UTC 分量是 SV 的时、分、秒`<primary datetime field>`，必要时进行实现定义的舍入或截断，TV 的时区分量是时区位移SV 的。
> 
> e) 如果 SD 是 TIMESTAMP WITHOUT TIME ZONE，那么 TV 是：
> 
> ```
> CAST ( CAST ( SV AS TIMESTAMP(TSP) WITH TIME ZONE )
>    AS TIME(TSP) WITH TIME ZONE ) 
> ```

标准中的缩进稍微好一点，并且您会对某些名称（例如 TV、SV、SD 等）有更多的上下文，但使用的语言确实是那么夸张。

# virtualization - What's the differences between Xen, QEMU and KVM?

> ID：10307323
> 
> 赞同：77
> 
> 时间：2012-04-24T23:19:07.050
> 
> 标签：virtualization, qemu, xen, kvm

I know QEMU is used by Xen, and KVM is a fork of QEMU.

So, KVM includes that Xen adds to QEMU ? What is the name ?

Thanks

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2012-04-26T02:46:46.817

QEMU 是一个强大的模拟器，这意味着它可以模拟多种处理器类型。

Xen 将 QEMU 用于[HVM](https://en.wikipedia.org/wiki/Hardware-assisted_virtualization)来宾，更具体地说，用于 HVM 来宾的设备模型。Xen 特定的 QEMU 称为 qemu-dm（QEMU 设备模型的缩写）

QEMU 使用仿真；KVM 使用处理器扩展 (HVM) 进行虚拟化。

Xen 和 KVM 都[将](http://wiki.xen.org/wiki/QEMU_Upstream)它们的各种功能合并到上游 QEMU 中，这样上游 QEMU 可以直接用于完成 Xen 设备模型仿真等。

Xen 的独特之处在于它具有不需要硬件虚拟化的[半虚拟化来宾。](https://en.wikipedia.org/wiki/Paravirtualization)

Xen 和 KVM 都具有可以在 HVM 来宾之上运行的半虚拟化设备驱动程序。

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2016-03-04T18:49:12.720

以上答案是深入的，技术性的。我试着用简单的外行术语来表达。

Qemu 是一个仿真器，可以在有或没有 KVM 的情况下工作，KVM 是一个加速器（Linux 内核模块，可以让客户指令直接在主机 CPU 上运行），这使得 Qemu+KVM 成为更快的解决方案，与 Qemu+TCG 的较慢替代方案不同。

Xen 是一个裸机管理程序，它有不同的模式（虚拟化类型）。顺便说一下，裸机是一个误导性的术语。所有虚拟机管理程序 Type-II/托管或 Type-I/裸机都需要底层操作系统。因此，裸机也有一层非常薄的裸最小操作系统，例如虚拟机管理程序使用的层。

Xen PV 或准虚拟化 - 无需硬件仿真，修改来宾内核，以便来宾可以检测/在底层 Xen 管理程序上运行。

Xen HVM 或完全虚拟化 - 需要硬件仿真，仅在支持虚拟化 Intel-VT 等的 CPU 上实现，修改后的 Qemu 用于硬件仿真（磁盘、网络、USB 控制器等），未修改来宾内核。

通常，模拟虚拟化（完整）比修改内核虚拟化（段）慢。通过在客户机内核中安装专用驱动程序（PV 驱动程序），可以提高完全虚拟化客户机的性能。

# mysql - 程序退出时自动回滚

> ID：10307324
> 
> 赞同：3
> 
> 时间：2012-04-24T23:19:07.093
> 
> 标签：mysql, transactions

[关于事务](http://dev.mysql.com/doc/refman/5.5/en/commit.html)的MySQL 文档似乎缺少一个重要的信息，这是我的问题：

如果事务正在进行并且客户端断开连接（在我的情况下，如果 PHP`exit`或`die()`s 或只是到达代码的末尾），事务是回滚还是提交？

我假设回滚，但如果假设错误，这可能是一个大问题......

如果有任何区别，所有表都使用 InnoDB 引擎。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T00:47:53.727

在正常情况下，客户端断开连接会导致 MySQL 发生回滚。但是，如果您的服务器意外停机（例如硬件或网络故障），可能需要一些时间才能断开您的客户端。在手册中，28800 秒是服务器在回滚事务之前等待活动的默认值。

您可以调整[`wait_timeout`](http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html#sysvar_wait_timeout)服务器上的设置或[`interactive_timeout`](http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html#sysvar_interactive_timeout)属性以缩短此设置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-27T07:25:24.633

根据这个页面：[http ://www.weberdev.com/ViewArticle/Using-Transactions-In-MySQL-Part-1](http://www.weberdev.com/ViewArticle/Using-Transactions-In-MySQL-Part-1)

“...有趣的是，如果您开始事务，但在发出 COMMIT 或 ROLLBACK 之前退出会话，MySQL 不会*执行*自动 COMMIT；相反，它会发出 ROLLBACK”

我做了一些测试来确认这一点，这里是每个场景的结果。（注意：当页面在没有 COMMIT 的情况下退出时，mysql 会自动回滚）：

```
mysql_query("START TRANSACTION");
mysql_query("INSERT INTO log SET temp = 'test'");

exit("Exit\n");  // Auto rollback;

die( "Die\n");  // Auto rollback;

throw new Exception("Exception\n"); // Auto rollback;

try {
    throw new Exception("Exception\n");
} catch(Exception $e) {
    echo "Caught\n"; // Committed;
}

require_once('invalid_file.php'); // Auto rollback;

mysql_query('COMMIT'); 
```

# r - R：将应用程序的输出组合为数组维度的每个值

> ID：10307325
> 
> 赞同：1
> 
> 时间：2012-04-24T23:19:09.080
> 
> 标签：r

我希望获得 4 维数组中最大值为 1 的行的百分比。我可以使用第 4 维的单个值的应用函数来获取该信息，然后使用 cbind 组合所有输出。但是，第 4 维中的值的数量可能会有所不同。有没有一种有效的方法可以在不使用 cbind 的情况下获得所需格式的输出？

下面是功能代码，它将所需信息作为数组第 4 维的每个级别的单独向量返回。

```
set.seed(9345)

A <- 8
B <- 2
C <- 5
D <- 2  # the value of D might change

y2 <- array(rbinom(A*B*C*D, 1, 0.4), dim = c(A, B, C, D))

pA <- colMeans(apply(y2[,,,1], c(1,3), max))
pB <- colMeans(apply(y2[,,,2], c(1,3), max))

pp <- cbind(pA, pB)
pp

#        pA    pB
# [1,] 0.750 0.875
# [2,] 0.625 0.250
# [3,] 0.375 1.000
# [4,] 0.375 0.500
# [5,] 0.625 0.750 
```

有没有一种简单的方法来获得 pp 的等价物，而无需在输出 pA 和 pB 上使用 cbind （可能是一个包含 apply 和 colMeans 函数的单线）？如果第 4 维 (D) 中值的数量发生变化，则必须与 cbind 组合的向量数量会有所不同。

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T23:40:31.043

这应该是等效的，并且更易于启动：

```
colMeans(apply(y2[,,,], c(1,3,4), max))
#       [,1]  [,2]
# [1,] 0.750 0.875
# [2,] 0.625 0.250
# [3,] 0.375 1.000
# [4,] 0.375 0.500
# [5,] 0.625 0.750 
```

# image - 如何打印位图图像？

> ID：10307328
> 
> 赞同：-1
> 
> 时间：2012-04-24T23:19:41.357
> 
> 标签：image, printing, bitmap, c++-cli

我有一个想要打印的位图图像（在纸上）。我搜索了谷歌，没有一个例子对我有用。我不想使用任何外部库。帮助？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T23:30:46.150

至少在 Linux 平台上，*NetPBM*软件可以提供帮助。*ImageMagick*也可以。 但是，您不想使用任何外部库吗？那是相当的限制！

祝你好运。

# html - Twitter 趋势通过简单的 html dom 解析器

> ID：10307329
> 
> 赞同：0
> 
> 时间：2012-04-24T23:19:44.290
> 
> 标签：html, parsing, dom, twitter

当我尝试查看 twitter 搜索主页的源代码时，我看不到其中的任何趋势，尽管它们显示在屏幕上。我想解析一个特定国家的趋势并将它们列在一个字符串中。如何使用简单的 html dom 解析器来实现这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T23:21:59.767

您在源代码中看不到任何内容，因为内容是动态加载的。当您真正需要调查的是[Twitter API](https://dev.twitter.com/docs/api/1/get/search)之类的东西时，您正在以错误的方式处理这一切。

您想要的输出（每个国家/地区的趋势）是一个简单的 API 调用。[你可以在这里](https://dev.twitter.com/docs/api/1/get/trends/available)看到更多关于它的信息。我不知道你是否知道如何阅读 JSON - 不要被吓倒，它真的超级简单。您可以在 PHP 中获取这些提要，`file_get_contents`然后使用链接`json_decode`将其转换为标准 PHP 对象。如果您在这里需要小费，请告诉我。

# php - Trying to alternate background color for odd and even , but javascript is making all even

> ID：10307331
> 
> 赞同：0
> 
> 时间：2012-04-24T23:19:46.817
> 
> 标签：php, javascript, mysql, css, html-lists

I would like to alternate background colors for odd and even list items in my unordered list. This worked great until I added javascript inside of each list item. If I remove the javascript, the background color alternates as it should. With the javascript, I can see in firebug that each list item looks like it is even.

The reason why I need to have the javascript inside of each list item is because I am dynamically displaying each list item from the database, and assigning classes based upon the application id ($apid).

My css to alternate background color of list items:

```
ul.version li:nth-child(odd) {
background: #EEE;
}

ul.version li:nth-child(even) {
background: #FFF;
} 
```

And the applicable code in my php page:

```
<ul class="version">

                                <li class="versionheader">

                                    <ul>
                                        <li class="appname">
                                            Application
                                        </li>

                                        <li class="appvidlink">
                                            Video
                                        </li>

                                        <li class="appwish">
                                            Wishlist
                                        </li>

                                        <li class="appimplement">
                                            Implemented
                                        </li>
                                    </ul>

                                </li>

                            <?php
                            //get child applications
                            $application_id_result = mysql_query("SELECT apid from products_app_categories WHERE cid = '$catid'");
                                while($application_id_row = mysql_fetch_array($application_id_result)) {

                                    $apid = $application_id_row['apid'];

                            //see if user already has app in their wishlist
                            $application_wished_result = mysql_query("SELECT COUNT(apid) FROM products_wishlist_users WHERE apid = '$apid' AND uid = '$uid'");
                                while($application_wished_row = mysql_fetch_array($application_wished_result)) {

                                    if($application_wished_row['COUNT(apid)'] < 1) {

                                        $appwished = false;
                                    } else {
                                        $appwished = true;
                                    }

                            $application_result = mysql_query("SELECT * FROM products WHERE child = '1' AND parent_id = '$pid' AND id = '$apid'");
                                while($application_row = mysql_fetch_array($application_result)) {

                                    $apname = $application_row['name'];

                                    ?>

                                    <li class="app app_<?php echo $apid; ?> <?php if($appwished) { echo 'appwished'; } ?>">

                                        <ul>
                                            <li class="appname">
                                                <?php echo $apname; ?>
                                            </li>

                                            <li class="appvidlink">
                                                [video]
                                            </li>

                                            <li class="appwish">
                                                <?php if(!$appwished) {
                                                    echo '<a class="btn addtowishlist addtowishlist_' . $apid . '">Add</a>';
                                                } else {
                                                    echo '<span class="checkmark"></span>';
                                                } ?>
                                            </li>

                                            <li class="appimplement">
                                                <?php if(!$implemented) {
                                                    echo '<a class="btn addtoimplemented">Yes</a>';
                                                } else {
                                                    echo '<span class="checkmark"></span>';
                                                } ?>
                                            </li>
                                        </ul>

                                    </li>

                                    <script type="text/javascript">

                                        $('.addtowishlist_<?php echo $apid; ?>').click(function(){

                                            $.get("wishlist/wishlistupdate.php?uid=<?php echo $uid; ?>&apid=<?php echo $apid; ?>");

                                            $("#wishlistapps").load("wishlist/wishlistdisplay.php?uid=<?php echo $uid; ?>");

                                            $("li.app_<?php echo $apid; ?>").addClass("appwished");

                                            return false;
                                        });

                                    </script>

                                <?php   
                                } } }?>

                        </ul> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T23:27:33.457

在脚本末尾使用 javascript 设置背景颜色。

```
$('ul.version li:even').css('background-color','#EEE');
$('ul.version li:odd').css('background-color','#FFF'); 
```

确保在标题中加载 jquery :x

# c# - ASP.NET Web API ActionFilter example

> ID：10307333
> 
> 赞同：63
> 
> 时间：2012-04-24T23:19:55.957
> 
> 标签：c#, asp.net-web-api

I'm new to the whole MVC thing and am looking at re-implementing some WCF services using ASP.NET Web API. As part of that, I'd like to implement an action filter that logs all actions and exceptions as well as does timing so I thought I'd start with an Action Filter, however the filter is not being invoked.

```
public class MyTrackingActionFilter : ActionFilterAttribute, IExceptionFilter 
{
    private Stopwatch stopwatch = new Stopwatch();

    public void OnException(ExceptionContext filterContext)
    {
           ...
    }

    public override void OnActionExecuted(ActionExecutedContext filterContext)
    {
           ...
    }

    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        this.stopwatch.Start();
        Trace.TraceInformation(" Entering {0}", filterContext.RouteData);
    }
} 
```

and on the controller, I have

```
[MyTrackingActionFilter]
public class MyResourceController : ApiController
{
  ...
} 
```

The routes are setup in Global.asax using calls like:

```
var routeTemplate = ...
var defaults = new { controller = controllerName, action = methodName };
var constraints = new { httpMethod = new HttpMethodConstraint(myHTTPMethods.Split(',')) };

routes.MapHttpRoute(methodName, routeTemplate, defaults, constraints); 
```

The issue is that the actions on the MyResourceController are invoked as expected and run successfully. The client is able to query the server for the necessary info and all behaves fine, except that none of the action filter methods are ever invoked.

My understanding was that the rest happened "automagically". That's clearly not enough - Any sugestions as to what is wrong? Do I need to register these somewhere?

* * *

## 回答 #1

> 赞同：189
> 
> 时间：2012-04-24T23:40:36.727

您必须确保您的代码使用[`ActionFilterAttribute`来自`System.Web.Http.Filters`命名空间](https://msdn.microsoft.com/en-us/library/system.web.http.filters.actionfilterattribute(v=vs.118).aspx)而不是来自`System.Web.Mvc`.

所以请检查你是否有

```
 using System.Web.Http.Filters; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-08-20T14:58:25.147

正如 Sander 提到的，我尝试了下面的代码，它的动作过滤器正在执行。

```
public class WebAPIActionFilterAttribute : System.Web.Http.Filters.ActionFilterAttribute
{
    public override void OnActionExecuted(HttpActionExecutedContext actionExecutedContext)
    {
        PersonController.Messages.Add("OnActionExecuted");
    }

    public override void OnActionExecuting(HttpActionContext actionContext)
    {
        PersonController.Messages.Add("OnActionExecuting");
    }
}

public class WebAPIExceptionFilter : System.Web.Http.Filters.ExceptionFilterAttribute
{
    public override void OnException(HttpActionExecutedContext actionExecutedContext)
    {
        PersonController.Messages.Add("OnException");
        actionExecutedContext.Response = new HttpResponseMessage(HttpStatusCode.NotFound) { Content = new StringContent("Something went wrong") };
    }
} 
```

PersonController.Messages 是一个静态字符串列表。如果您想检查 OnActionExecuted 是否正在执行，您可以再次调用相同的 API 方法，您会在 Messages 列表中看到“OnActionExecuted”。

# javascript - 根据 Javascript 中的 DTD 验证 XML？

> ID：10307334
> 
> 赞同：7
> 
> 时间：2012-04-24T23:19:56.640
> 
> 标签：javascript, xml, validation, dtd

我正在使 vcard 实现适应 JS MVC 框架。我希望能够在客户端模型中针对 vcard 规范的 DTD 进行验证。我一直在寻找针对 DTD Javascript 的验证，但没有成功。有人听说过这样的事情吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T05:06:03.490

无论如何，您不需要在服务器上重新验证它吗？

根据 DTD 的复杂性，您可能只想*检查*客户端上的 XML 有效性（通过尝试反序列化等），可能会手动进行几个原始检查。然后可以在服务器上对其进行完全验证。

不管怎样：[使用 DTD 验证 XML 文档](http://www.informit.com/library/content.aspx?b=STY_XML_21days&seqNum=202)看起来很有希望。

# ruby-on-rails - If I am developing a hosted payments page, what should the infrastructure look like?

> ID：10307340
> 
> 赞同：0
> 
> 时间：2012-04-24T23:20:33.387
> 
> 标签：ruby-on-rails, ruby, payment-gateway, payment, payment-processing

I know if I am dealing with businesses in the US, I would have to comply with PCI Standards and stuff like that....but I am starting outside of the US, so there isn't that regulation to deal with.

That being said, I would love to know what the best practices are in terms of accepting credit cards and reducing fraud risk on my end.

I will be creating the app in Rails, but want to know what sorts of things I should be thinking about to keep everything secure.

Thanks.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T01:26:55.580

PCI 是一项全球标准 - 如果您计划使用信用卡，则无论您的企业位于何处，都必须符合 PCI 标准。

我建议您从[https://www.pcisecuritystandards.org/merchants/](https://www.pcisecuritystandards.org/merchants/)开始熟悉 PCI 规则和规定。

# php - 如何计算一个值是否超出 PHP 中的一个标准差

> ID：10307342
> 
> 赞同：2
> 
> 时间：2012-04-24T23:20:41.343
> 
> 标签：php, statistics

假设我有这个 JSON 数组

```
$json = '[["1258765200","12350"],["1259370000","13000"],["1259974800","11840"],["1260579600","16359"],["1261184400","14230"],["1261789200","07406"],["1262394000","12846"],["1262998800","11204"],["1263603600","10234"]]'; 
```

其中第一个值是时间戳，第二个是值。我如何计算每个值是否超出 PHP 中位数的 1 个标准差（95%）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T23:53:26.187

不确定这是否是您想要的

```
$json = '[["1258765200","12350"],["1259370000","13000"],["1259974800","11840"],["1260579600","16359"],["1261184400","14230"],["1261789200","07406"],["1262394000","12846"],["1262998800","11204"],["1263603600","10234"]]';
$json = json_decode ( $json, true );
$values = array ();
foreach ( $json as $value ) {
    $values [] = $value [1]; // Get Values
}

$median = median ( $values );
$sd = stddev ( $values );
$percentage = ($sd / $median) * 100;
$benchmark = 95 / 100;

if($percentage > $benchmark)
{

    echo "outside 1 standard deviation (95%)";
} 
```

输出

```
outside 1 standard deviation (95%) 
```

职能

```
function stddev($array) {
    $n = 0;
    $mean = 0;
    $M2 = 0;
    foreach ( $array as $x ) {
        $n ++;
        $delta = $x - $mean;
        $mean = $mean + $delta / $n;
        $M2 = $M2 + $delta * ($x - $mean);
    }
    $variance = $M2 / ($n - 1);
    return sqrt ( $variance );
}

function median($arr) {
    sort($arr);
    $count = count($arr); //total numbers in array
    $middleval = floor(($count-1)/2); // find the middle value, or the lowest middle value
    if($count % 2) { // odd number, middle is the median
        $median = $arr[$middleval];
    } else { // even number, calculate avg of 2 medians
        $low = $arr[$middleval];
        $high = $arr[$middleval+1];
        $median = (($low+$high)/2);
    }
    return $median;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T23:57:26.527

爸爸打败了我，但这是我用来计算标准偏差的算法。最初，该[`Statistics`](http://www.php.net/manual/en/stats.installation.php)模块看起来很有前途，但它似乎不是 PHP 的标准。

```
function php_standard_dev($data)
{
    $n = 0;
    $sum = 0;
    $sum_squared = 0;

    foreach ($data as $x)
    {
        $n += 1;
        $sum += $x;
        $sum_squared += $x*$x;
    }

    $mean = $sum / $n;
    $variance = ($sum_squared - $sum * $mean)/($n - 1);
    return sqrt($variance);
} 
```

要获得 > 95% 的阈值，请取中位数 + 2 倍标准差。任何大于阈值的值都大于样本大小的 95%。

# maven - 如何覆盖默认的 maven-install-plugin 行为？

> ID：10307343
> 
> 赞同：5
> 
> 时间：2012-04-24T23:20:42.020
> 
> 标签：maven, overriding, default

我需要自定义工件安装，但不知道如何覆盖默认工件（来自默认的 Maven 生命周期）。所以我的问题是：

如何在我的 pom.xml 中配置 maven 安装插件，使其不执行默认安装并仅执行我的自定义安装文件目标？

我尝试不使用 id 和使用[默认安装](http://maven.apache.org/guides/mini/guide-default-execution-ids.html)id，但没有帮助。

**更新：** 根据提供的答案 - 这对我不起作用（我在日志中看到两次安装尝试）。

```
<pluginManagement>
  <plugins>
    <plugin>
      <groupId>org.apache.maven.plugins</groupId>
      <artifactId>maven-install-plugin</artifactId>
      <executions>
        <execution>
          <id>default-install</id>
          <phase>none</phase>
        </execution>
      </executions>
    </plugin>
  </plugins>
</pluginManagement>
<plugins>
  <plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-install-plugin</artifactId>
    <version>2.3.1</version>
    <executions>
      <execution>
        <id>install-jar-lib</id>
        <goals>
          <goal>install-file</goal>
        </goals>
        <phase>install</phase>
        <configuration>
          <file>${project.build.directory}/${project.build.finalName}.jar</file>
          <generatePom>false</generatePom>
          <pomFile>pom.xml</pomFile>
          <packaging>jar</packaging>
          <version>${unicorn.version}</version>
        </configuration>
      </execution>
    </executions>
  </plugin> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-25T07:02:50.953

要禁用`maven-install-plugin`：

```
<build>
  <pluginManagement>
    <plugins>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-install-plugin</artifactId>
        <version>2.3.1</version>
        <executions>
          <execution>
            <id>default-install</id>
            <phase>none</phase>
          </execution>
        </executions>
      </plugin>
    </plugins>
  </pluginManagement>
</build> 
```

并执行您的自定义安装目标：

```
<build>
  <plugins>
    <plugin>
      <groupId>yourGroupId</groupId>
      <artifactId>yourArtifactId</artifactId>
      <executions>
        <execution>
          <id>custom-install</id>
          <phase>install</phase>
          <goals>
            <goal>yourGoal</goal>
          </goals>
        </execution>
      </executions>
    </plugin>
  </plugins>
</build> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-02-25T00:46:44.687

如果您至少有 2.4 版的安装插件，则可以跳过默认安装。

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-install-plugin</artifactId>
    <version>2.4</version>
    <configuration>
        <skip>true</skip>
    </configuration>
</plugin> 
```

然后您可以通过添加将另一个插件（ant run 插件或其他任何插件）绑定到此阶段

```
 <phase>install</phase> 
```

到插件的执行部分，您可以运行新的安装过程

```
 mvn install 
```

# stream - 将 SAX ContentHandler 字符(..) 转换为 InputStream

> ID：10307345
> 
> 赞同：0
> 
> 时间：2012-04-24T23:20:57.950
> 
> 标签：stream, sax

我们编写了一个新的 API，它使用 SAX API 来处理文档并允许调用者传递一个处理 SAX 事件的 SAX ContentHandler 实例。这可行，但我们也有期望内容为 InputStream 的遗留代码。

因此，我们需要实现 SAX ContentHandler，它有一个 getStream() 方法，该方法返回 InputStream，其中包含在 ContentHandler#characters(..) 中接收到的字符。关于如何有效地做到这一点的任何想法？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T00:16:26.793

我们最终使用了 Tika 的 BodyContentHandler 并将 PipedOutputStream 传递给它，后者将字符通过管道传输到 PipedInputStream。

# python - 将标题缩短到一定长度

> ID：10307348
> 
> 赞同：0
> 
> 时间：2012-04-24T23:21:25.750
> 
> 标签：python

给定标题和 max_length，缩短标题的最佳方法是什么？以下是我的想法：

```
def shorten_title(title, max_length):
    if len(title) > max_length:
        split_title = title.split()
        length = len(title)
        n = 1
        while length > max_length:
            shortened_title = split_title[:length(split_title)-n]
            n+=1
        return shortened_title
    else:
        return title 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T23:38:14.173

```
>>> shorten_title = lambda x, y: x[:x.rindex(' ', 0, y)]
>>> shorten_title('Shorten title to a certain length', 20)
'Shorten title to a' 
```

如果您只需要打破空间，那应该就足够了。否则，还有其他几篇关于更复杂方法的帖子，例如：[截断字符串而不以单词中间结尾](https://stackoverflow.com/questions/250357/smart-truncate-in-python)。

*更新以解决来自 okm 的评论：*

要处理边缘情况，例如在 max_length 之前找不到空格，请明确解决它们：

```
def shorten_title2(x, y):
    if len(x) <= y:
        return x
    elif ' ' not in x[:y]:                                          
        return x[:y]
    else:
        return x[:x.rindex(' ', 0, y + 1)] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T23:28:52.023

```
def shorten_title(title, max_length):
    return title[:max_length + 1] 
```

那个怎么样？

好的，不用分词，你想要这个：

```
import string

def shorten_title(title, max_length):
    if len(title) > max_length:
        split_title = title.split()
        length = len(title)
        n = 1
        while length > max_length:
            shortened_title = split_title[:-n]
            n = n + 1
            length = len(string.join(shortened_title))
        if shortened_title == []:
            return title[:max_length + 1]
        return string.join(shortened_title)
    else:
        return title 
```

这是我看到的结果：

```
print shorten_title("really long long title", 12)
print shorten_title("short", 12)
print shorten_title("reallylonglongtitlenobreaks", 12)

really long
short
reallylonglon 
```

我试图保持与原始海报相似的代码和逻辑，但肯定有更多的 Pythonic 方法可以做到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T23:39:18.647

```
def shorten_title(title, max_length):
    title_split = split(title)
    out = ""
    if len(title_split[0]) <= max_length:
        out += title_split[0]
    for word in title_split[1:]:
        if len(word)+len(out)+1 <= max_length:
            out += ' '+word
        else:
            break
    return out[1:] 
```

试试看:)

# spring - 在 JSP 中捕获异常

> ID：10307349
> 
> 赞同：0
> 
> 时间：2012-04-24T23:21:25.883
> 
> 标签：spring, jsp, exception, nullpointerexception

我想知道如何处理这种情况以及您对此有何建议。

我的 JSP 中有一个空指针异常。

```
String csvDataIn = new String ((String)request.getAttribute("csvString")); 
```

这是因为，我在 spring 中创建了一个 Controller 来处理对 DB 的查询并获取一个 csvString。一切正常，直到我提出一个失败的查询。

因此，在控制器中：

```
 ...
   JsonNode json = dataRepository.getDataAsJson(dataNode);
   csvString = getCSVfromJsonNode(json);
              model.addAttribute("csvString", csvString);
            } catch (Exception e) {
                Logger.log("CSV controller failed", _moduleClass, e);
            }
            return "exportCSV";
      } 
```

所以变量 json 永远不会被填充，因为函数 getDataAsJson() 失败了。所以这是抛出异常。然后我返回到 exportCSV.jsp，但我没有返回模型中的属性 csvString。

所以，回到jsp，就是抛出空指针异常。

所以我的问题是： a- 你将如何在 JSP 中捕获这个异常？b-您认为比在 JSP 中捕获异常更好的解决方案吗？我的意思是什么可能是最好的做法。

提前致谢。

感谢您的回复。他们真的是很好的帮助：为了处理这个问题，我做了以下修改。

```
 ...
         JsonNode json = dataRepository.getDataAsJson(dataNode);
         model.addAttribute("csvString", csvString);
       } catch (Exception e) {
         Logger.log("CSV controller failed", _moduleClass, e);
       }
       return "exportCSV";
       csvString = getCSVfromJsonNode(json);
       } 
```

这解决了发送空字符串的问题，因为 csvString 是之前创建的 bean，为空。

我在这里遇到的异常是 javax.xml.ws.webserviceexception 无法发送消息（您知道在控制器处处理此问题的更好方法吗？）

我也在jsp端做了这个，以防万一：

```
String csvDataIn = (String)request.getAttribute("csvString");
//This should never happen, but we check anyway.
if (csvDataIn != null){
...
} 
```

所以我唯一可能留下的疑问是：你知道在控制器上处理 javax.xml.ws.webserviceexception 的更好方法吗？

再次感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T23:30:53.367

`RuntimeException`s like `NullPointerException`s 通常表示程序员在代码中的错误。即它是错误。您不应该抓住它们，而是通过适当地预先检查来避免它们。在您的特定情况下，您错误地将其包装在另一个`new String()`. 如果属性是`null`，它会抛出`NullPointerException`那个。删除它。

例如

```
String csvDataIn = (String) request.getAttribute("csvString");

if (csvDataIn != null) {
    // Do your job here.
}
else {
    // Just ignore it?
} 
```

但毕竟，业务逻辑真的不属于JSP。您应该改为在控制器中完成这项工作，并准确地为 JSP**提供**装饰一些 HTML 所需的数据。如果您在控制器中遇到真正不可恢复的异常，则将其重新抛出为`ServletException`. 它最终会出现在容器的默认错误页面中，或者您`<error-page>`在`web.xml`.

```
} catch (Exception e) { // Please be more specific.
    throw new ServletException("Converting to CSV failed", e);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T23:31:57.433

最好`csvString`用空值而不是`null`. 所以它总是会转到jsp，如果你有一些有效的值，你将渲染，否则你将在视图中显示为空。

另外请避免在 jsp 中使用 scriptlet 代码。它不可维护。

# iphone - 任何关于如何从 uitabbarcontroller 访问 viewcontroller 的代码示例？

> ID：10307350
> 
> 赞同：1
> 
> 时间：2012-04-24T23:21:34.943
> 
> 标签：iphone, ios, xcode

我是 iphone 开发新手

我用 tabbar 和 tabbaritems 用他们的 viewcontroller 创建了我的故事板

但现在我想从我的 uitabbarcontroller.m 访问 viewcontroller 实例

有人有任何带有代码示例的网址吗？

我发现的代码是非常简单的使用或标签栏，主要是故事板，对任何事情都没有帮助......

谢谢

---穆勒帮助后的解决方案

在 uitabbarcontroller 上：（我放置了一个断点并且能够检索视图控制器的集合）

```
 - (void)viewDidLoad
    {
       NSArray *arr = self.viewControllers;
    } 
```

* * *

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T23:30:30.177

你可以使用类似的东西

```
NSArray *array = [tabBarControllerName viewControllers]; 
```

这将返回 tabBarController 中所有视图的数组，因此如果您的第一个视图属于类，假设 TestView 我们可以执行类似的操作

```
TestView *tv = (TestView *)[array objectAtIndex:0]; 
```

请注意，这不在我的脑海中，所以它可能有点偏离。确保您查看了苹果提供的类参考资料：[UITabBarController 类参考](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UITabBarController_Class/Reference/Reference.html)

编辑：你真的可以像这样写一行：

```
TestView *tv = (TestView *)[[tabBarControllerName viewControllers] objectAtIndex:0]; 
```

EDIT2：如果它在您的 AppDelegate 中声明，您可以访问 UITabBarController：

```
AppDelegate *appDelegate = (AppDelegate *)[[UIApplication sharedApplication] delegate];
TestView *tv = (TestView *)[[[appDelegate tabBarController] viewControllers] objectAtIndex:0]; 
```

# css - Fixing Gmail's layout with a custom style

> ID：10307351
> 
> 赞同：7
> 
> 时间：2012-04-24T23:21:35.377
> 
> 标签：css, userscripts

I'm trying to make Gmail's new look usable on my small 1024x768 screen - the default layout leaves only a small window for the messages, surrounded by unmoving elements. Scrolling that small window around is massively annoying.

I've managed to make the entire page scrollable using a [Stylish](https://addons.mozilla.org/en-US/firefox/addon/stylish/) user style (a modified version of [this one](http://userstyles.org/styles/56331/new-style-gmail-get-rid-of-internal-scrollbars)):

```
@-moz-document domain('mail.google.com'), 
 url-prefix('https://mail.google.com/mail') {

.akc.lKgBkb,
.oLaOvc.aeJ,
.lKgBkb.nH.oy8Mbf,
.lKgBkb.ajl.aib
{
  height: auto !important;
  overflow: hidden !important;
}

#canvas_frame { overflow-y: scroll; }

.l2 { padding-bottom: 20px !important; }

} 
```

The elements that were supposed to have scrollbars now have `height: auto`, and what is scrolled is the whole outer page (in `#canvas-frame`) that was supposed to remain static.

I'm mostly satisfied with the effect -- it works almost like the old Gmail did. There is, however, a problem - **scrolling with keyboard (arrow keys, PgUp/PgDn, Home/End) stopped working**. Any ideas on how to fix that?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T04:30:33.357

您是否尝试过寻找现成的解决方案？虽然 DIY 方法令人钦佩，但很可能有人已经进行了深入的更改，特别是考虑到一些用户对新外观选项的不满。

“Greasemonkey 用户也可以[将此样式安装为用户脚本”下](http://userstyles.org/styles/userjs/57755/The%20Return%20of%20Old%20Gmail.user.js?)[此处](http://userstyles.org/styles/57755/the-return-of-old-gmail)链接的文件（无从属关系）可能是一个很好的起点；虽然*我会更详细地介绍它并删除任何奇怪的第 3 方 url 引用等。*

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T19:08:47.933

我在 Ubuntu 上使用 Firefox 12，但看不到内部滚动条。消息窗格通过主滚动条滚动。他们已经为您解决了这个问题，或者需要更多信息。你使用的是什么浏览器？*

# sql - oracle sql中的平均日期

> ID：10307353
> 
> 赞同：8
> 
> 时间：2012-04-24T23:21:52.207
> 
> 标签：sql, oracle, date, average

有没有办法在oracle中平均多个日期？avg 没有任何好处。

谢谢。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-24T23:46:59.970

“平均日期”的定义是主观的，但您可以将日期转换为儒略数，然后将它们平均，四舍五入，然后转换回日期。

```
create table dates (dt DATE);

insert into dates 
values ('24-APR-2012');
insert into dates 
values ('01-JAN-2012');
insert into dates 
values ('01-JAN-2013');
insert into dates
values ('25-DEC-1900');

select to_date(round(avg(to_number(to_char(dt, 'J')))),'J')
from dates; 
```

这是 SQL 小提琴： [http ://sqlfiddle.com/#!4/98ce9/1](http://sqlfiddle.com/#!4/98ce9/1)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-12-12T10:00:51.113

oracle 中的“中值”函数以一种简洁的方式完成了其他答案的作用。

这是 Oracle 文档的链接 - [https://docs.oracle.com/cd/B19306_01/server.102/b14200/functions086.htm](https://docs.oracle.com/cd/B19306_01/server.102/b14200/functions086.htm)

它可以将数字数据类型或可以隐式转换为数字的非数字数据类型作为 arg。

```
SQL> desc x1
Name                                      Null?    Type
----------------------------------------- -------- ----------------------------
A                                         NOT NULL NUMBER
D                                                  DATE

SQL> select * from x1;

     A D
---------- ---------
     1 11-DEC-14
     2 13-DEC-14
     3 22-DEC-14
     4 02-DEC-14
SQL> select median(d) from x1;

MEDIAN(D)
---------
12-DEC-14 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-29T16:27:15.320

Oracle 自然地处理一些日期算术 - 例如 TRUNC(SYSDATE) + 1 将返回明天的日期。

所以另一种方法是将您的日期与常数进行比较：

1) 以天为单位将距离与常数进行比较（例如 SYSDATE）

2）平均，然后四舍五入，计算

3) 将平均值与 SYSDATE 进行比较并转换回日期。

这是一些执行此操作的代码（将**dt**替换为包含您的数据的任何字段）

```
 TO_DATE(
    TRUNC(SYSDATE) - ROUND(AVG(TRUNC(SYSDATE) - TRUNC(dt)))
 ) 
```

在一些样本数据上，运行的时间不到 Dan A. 上述方法的一半，并且产生了相同的输出。仅针对具有过去日期的数据对其进行了测试，但我看不出有任何明显的原因表明它不会泛化（处理 DATETIME 数据时著名的遗言，我意识到......）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-03-30T17:27:45.303

`SYSDATE + AVG( dt - SYSDATE )`

无需将日期转换为日期。如果您不希望结果中包含时间，请截断整个表达式。如果您不希望在计算平均值时使用时间，请截断日期列 (dt)。MEDIAN 与 AVG 不同。

# asp.net-mvc-3 - 基于 Session MVC3 修改菜单

> ID：10307359
> 
> 赞同：0
> 
> 时间：2012-04-24T23:22:36.217
> 
> 标签：asp.net-mvc-3, session, razor, menu, controller

我不确定如何实现这一点，所以我想对此提出一些建议。我想要完成的是基本上（我使用纯 MVC3.Net）在特定会话开始或结束时修改布局页面的 html。如果用户输入项目的详细信息（项目是一个实体），我的想法是基于在主菜单中显示更多选项的要求。此外，选项将取决于用户的类型。

在进行一系列研究之后，我想出了捕捉会话开始的事件的想法，我会在选择项目时创建，但我不确定在会话开始或结束时可以解决它，然后修改的HTML。

实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T05:35:21.337

您可以根据会话从控制器控制视图的布局这是一个简短的示例

```
@{
    ViewBag.Title = "Index";
    Layout = ViewBag.Layout;
}

public ActionResult Index()
    {
        if(Session["one]=="one")
       {
        ViewBag.Layout = "~/Views/Shared/site_1.cshtml";
       }
       if(Session["one"]=="two")
      {
       ViewBag.Layout = "~/Views/Shared/site_2.cshtml";

      }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T06:56:33.950

[也许您可以使用https://github.com/maartenba/MvcSiteMapProvider](https://github.com/maartenba/MvcSiteMapProvider)中的动态站点地图功能来解决您的任务。

如果您不想使用此提供程序，我建议将 BaseViewModel 用于所有视图模型，并将项目状态存储在那里。所以你可以做这样的事情：

```
@model BaseViewModel(or something derived) 
@{
    ViewBag.Title = "Index";
    Layout = ViewBag.Layout;
}

public ActionResult Index()
    {
       if(Model.HasProjectDetails)
       {
        @Html.Partial("_ExtendedNav")
       }
       if(Model.HasSomeExtraProjectDetails)
       {
        @Html.Partial("_MoreExtendedNav")
       }
} 
```

但总的来说，我建议使用带有[https://github.com/maartenba/MvcSiteMapProvider/wiki/Dynamic-sitemaps的站点地图提供程序](https://github.com/maartenba/MvcSiteMapProvider/wiki/Dynamic-sitemaps)

# javascript - 正则表达式的逻辑将 Javascript 中的字符串拆分为多个字符串

> ID：10307361
> 
> 赞同：0
> 
> 时间：2012-04-24T23:22:44.127
> 
> 标签：javascript, regex, string, split

很难将所有内容都放在问题的标题中，因为它具体取决于人们想要拆分的字符串。但这里是：

我有一个字符串，其中有多个脚本标签：

```
<script type="text/javascript" src="/javascripts/something-1.js"></script>
<script type="text/javascript" src="/javascripts/something-2.js"/>
<script type="text/javascript" src="/javascripts/something-3.js"></script>
<link rel="stylesheet" type="text/css" href="/something-1.css"> 
```

我想将此字符串拆分为多个字符串，每个字符串都包含一个脚本标签（忽略链接标签）。我是这样做的：

```
var scripts = code.match(/<script.*src=.*(\/>|<\/script>)/g); 
```

这是为了将脚本标签与结束标签匹配`/>`或匹配`</script>`。但是，使用这个当前的正则表达式，我总是得到：

```
<script type="text/javascript" src="/javascripts/something-1.js"></script>
<script type="text/javascript" src="/javascripts/something-2.js"/> 
```

作为一个字符串 - 不是两个。

我如何正则表达式：

```
/<script.*src=( (not script not link) /> | (not link) <\/script> )/g 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T01:51:05.917

一般来说，您尝试做的事情是不可能的。但是，如果您可以对源字符串做出某些简化假设，则可以创建一个足够好的正则表达式。这是我会尝试的：

```
/<script(?:\s+\w+\s*=\s*"[^"]*")+\s*/?>(?:</script>)?/gi 
```

解释：

*   `<script`匹配开始标签的开头。

*   `(?:\s+\w+\s*=\s*"[^"]*")+`消耗一个或多个属性

*   `\s*/?>`匹配开始标签的结尾。如果它是一个自闭合标签，则`/?`消耗斜线。

*   `\s*(?:</script>)?`否则，这匹配结束标记。

基本思想是用与开始标签末尾`.*`不匹配的东西替换`>`，因此“转义”以匹配比你想要的更多的东西。当然，没有任何保证。我什至不知道您的 HTML 是否有效，即使在有效的 HTML 中，也有很多方法可以欺骗此正则表达式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T23:24:33.763

改为尽可能少而不是尽可能多地匹配`.*`。`.*?`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-24T23:33:07.750

另一种处理方法是通过使用 xmldom 将“src”用作“脚本”标签的属性，并将页面作为部分或完整的 xml 文档。这是抓住它们并避免链接的积极方式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-25T00:41:55.117

我会使用类似的东西

```
var rx = /<script.+?src=.+?\/(script)?>/gim; 
```

这将匹配任何内容：

*   从...开始`<script`
*   至少还有 1 个字符（可以是空格，例如，或其他一些属性值对）
*   有`src=`
*   至少还有 1 个字符
*   然后要么`/>`或`/script>`

还有旗帜……</p>

*   **i**标志用于不区分大小写
*   **g**标志用于多个匹配项
*   **m**标志用于多行源（假设这些行实际上是行本身，而不是总共一行）

**编辑：**我没有考虑到在**src**属性`&src=etc`值中的地址中具有 get 值的可能性。

# windows-phone-7 - WP7：如何在安装时创建数据库

> ID：10307363
> 
> 赞同：1
> 
> 时间：2012-04-24T23:22:48.233
> 
> 标签：windows-phone-7, linq-to-sql, mobile, isolatedstorage

我正在尝试创建一个应用程序，该应用程序主要显示来自我创建的 IsolatedStorage LINQ to SQL 数据库的信息。

我希望应用程序在安装时使用信息加载数据库。有相当多的数据。

我很好奇做这种事情的最佳方法是什么？我可以像这样在安装时加载数据库吗？

我对 WP7 很陌生，所以我对任何想法都持开放态度！

谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T03:46:03.630

您无法在安装过程中执行代码。您*可以*在第一次加载时执行此操作，但为什么要让您的用户等待呢？

我个人建议将数据库创建为构建过程的一部分（或者如果您不使用 CI/CD，则手动创建），然后将其与应用程序一起部署。然后，您可以[从应用程序安装目录以只读方式打开数据库](http://msdn.microsoft.com/en-us/library/hh202861%28v=vs.92%29.aspx)（以避免复制到隔离存储）。

如果您要对数据库进行写入，则可以为此使用位于隔离存储中的第二个数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T07:12:59.073

我的一个应用程序部署了一个 30Mb 的数据库文件。为此，您必须在单独的项目中生成此数据库，使用 Code First 生成数据库，将 database.sdf 文件从模拟器下载到您的 PC 并将其作为内容添加到您的主项目中。我按照[这篇文章](http://msdn.microsoft.com/en-us/library/hh286411%28v=vs.92%29.aspx)来达到它。

# java - OnClick 方法杀死 android 应用程序

> ID：10307368
> 
> 赞同：0
> 
> 时间：2012-04-24T23:23:33.433
> 
> 标签：java, android, eclipse, logcat

我有一个简单的消息传递应用程序，它获取editText 框的文本并将其发送到服务器。我想要做的就是当文本被发送到服务器时，我希望 editText 框重置。

这是我的代码，但它不会重置editText框：

```
public void sendMessage(View v) {
        Editable messagetext;

        messagetext = message.getText();

        final SharedPreferences prefs = PreferenceManager
                .getDefaultSharedPreferences(getBaseContext());

        username = prefs.getString("username", "null");

        where = prefs.getString("chat", "null");
        message = (EditText) findViewById(R.id.inptbox);

        function = new Functions();

        response = function
                .sendMessage(username, where, messagetext.toString());

    } 
```

如果我再添加一行代码，为了重置该框，我的应用程序会死掉：

```
public void sendMessage(View v) {
    Editable messagetext;

    messagetext = message.getText();
        message.setText("");
    final SharedPreferences prefs = PreferenceManager
            .getDefaultSharedPreferences(getBaseContext());

    username = prefs.getString("username", "null");

    where = prefs.getString("chat", "null");
    message = (EditText) findViewById(R.id.inptbox);

    function = new Functions();

    response = function
            .sendMessage(username, where, messagetext.toString());

} 
```

我得到的错误（忍受我，我不是那么好的 logcat）是：

```
E/AndroidRuntime(7207): java.lang.IllegalStateException: Could not execute method of the activity 
```

全局变量列表：

```
String username = "";
    Functions function;
    EditText message;
    String response = "";
    String where = "";
    String inboxx; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T23:29:59.173

```
...
messagetext = message.getText();                 
...
message = (EditText) findViewById(R.id.inptbox);  
... 
```

这些顺序不应该颠倒吗？在调用它之前，您应该需要说出“消息”是`getText`什么。

# jquery - jQuery hoverIntent - 拆分函数时我做错了什么？

> ID：10307369
> 
> 赞同：0
> 
> 时间：2012-04-24T23:23:40.450
> 
> 标签：jquery

我将函数拆分为 hoverintent 并且有效，但现在 div 直到鼠标离开才隐藏？

我写了这个，它工作正常，我是 jquery 的新手，你可能会说。

```
$("img.nexthover").hover(
function() { this.src = this.src.replace("_off", "_on");
},
function() { this.src = this.src.replace("_on", "_off");
});
$('#A,#B,#C,#D,#E,#F,#G,#H,#I,#J').addClass('nextHide');
$('.nextbuttonA').hover(function() {
$('#A.nextHide').fadeIn("slow");        
$('#B,#C,#D,#E,#F,#G,#H,#I,#J.nextHide').fadeOut();
});
$('.nextbuttonB').hover(function() {
$('#B.nextHide').fadeIn("slow");
$('#A,#C,#D,#E,#F,#G,#H,#I,#J.nextHide').fadeOut();
});     
$('.nextbuttonC').hover(function() {
$('#C.nextHide').fadeIn("slow");
$('#A,#B,#D,#E,#F,#G,#H,#I,#J.nextHide').fadeOut();
});         
$('.nextbuttonD').hover(function() {
$('#D.nextHide').fadeIn("slow");
$('#A,#B,#C,#E,#F,#G,#H,#I,#J.nextHide').fadeOut();
}); 
$('.nextbuttonE').hover(function() {
$('#E.nextHide').fadeIn("slow");
$('#A,#B,#C,#D,#F,#G,#H,#I,#J.nextHide').fadeOut();
}); 
$('.nextbuttonF').hover(function() {
$('#F.nextHide').fadeIn("slow");
$('#A,#B,#C,#D,#E,#G,#H,#I,#J.nextHide').fadeOut();
}); 
$('.nextbuttonG').hover(function() {
$('#G.nextHide').fadeIn("slow");
$('#A,#B,#C,#D,#E,#F,#H,#I,#J.nextHide').fadeOut();
}); 
$('.nextbuttonH').hover(function() {
$('#H.nextHide').fadeIn("slow");
$('#A,#B,#C,#D,#E,#F,#G,#I,#J.nextHide').fadeOut();
}); 
$('.nextbuttonJ').hover(function() {
$('#I.nextHide').fadeIn("slow");
$('#A,#B,#C,#D,#E,#F,#G,#H,#J.nextHide').fadeOut();
}); 
$('.nextbuttonK').hover(function() {
$('#J.nextHide').fadeIn("slow");
$('#A,#B,#C,#D,#E,#F,#G,#H,#I.nextHide').fadeOut();
});
$('#A,#B,#C,#D,#E,#F,#G,#H,#I,#J').click(function(){
    $('.nextHide').fadeOut();
}); 
```

为了让 hoverIntent 工作，我将函数拆分如下：

```
$("img.nexthover").hover(
function() { this.src = this.src.replace("_off", "_on");
},
function() { this.src = this.src.replace("_on", "_off");
});
$('#A,#B,#C,#D,#E,#F,#G,#H,#I,#J').addClass('nextHide');

$('.nextbuttonA').hoverIntent(function() {
$('#A.nextHide').fadeIn("slow");
}, function() {
$('#B,#C,#D,#E,#F,#G,#H,#I,#J.nextHide').fadeOut();
});

$('.nextbuttonB').hoverIntent(function() {
$('#B.nextHide').fadeIn("slow");
}, function() {
$('#A,#C,#D,#E,#F,#G,#H,#I,#J.nextHide').fadeOut();
});

---etc---- 
```

但是现在 div 直到你像以前一样离开按钮才隐藏？抱歉，如果这太新手了，我正在通过跳入自学...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T21:21:24.347

如果你有兴趣就知道了，我的 jQuery 语法可能会更好，但我在另一个程序中工作，所以我对如何输入 HTML 有限制

```
$("img.nexthover").hover(
function() { this.src = this.src.replace("_off", "_on");
},
function() { this.src = this.src.replace("_on", "_off");
});
$('#A,#B,#C,#D,#E,#F,#G,#H,#I,#J').addClass('nextHide');

$('.nextbuttonA').hoverIntent(function() {
$('#A').fadeIn("slow");$('#B,#C,#D,#E,#F,#G,#H,#I,#J').fadeOut();
}, function() {
$('#B,#C,#D,#E,#F,#G,#H,#I,#J').hide();
});

$('.nextbuttonB').hoverIntent(function() {
$('#B').fadeIn("slow");$('#A,#C,#D,#E,#F,#G,#H,#I,#J').fadeOut();
}, function() {
$('#A,#C,#D,#E,#F,#G,#H,#I,#J').hide();
});

-------etc---------- 
```

因此，它所做的就是在鼠标悬停时在按钮上添加一个图像，然后在它们上使用 hoverintent 打开具有绝对定位元素的分区，如果你愿意的话，这是一个非凡的超级菜单。nextHide css 只是 display:none;cursor:pointer; 和名为 A、B 的 HTML div... 伙计，我喜欢这个 jQuery 的东西。

谢谢 elclarenrs，很好的链接。

# android - 使用简单命令/词汇的 Android 离线语音识别

> ID：10307373
> 
> 赞同：4
> 
> 时间：2012-04-24T23:24:14.420
> 
> 标签：android, voice-recognition, cmusphinx

我正在寻找一些允许我在我的 Android 应用程序中创建离线语音识别的库。我的应用程序将**包含最多 15 个简短（一个单词）命令**的简单词汇表。就我而言，响应时间至关重要。

是否有任何可行的离线选项（免费和付费）？我知道 Sphinx 的离线版本，但它会是响应速度最快的选项（同样，我只需要我的应用程序识别几个命令而不是整个语音到文本功能）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T23:43:12.760

我已经成功地将 PocketSphinx 用于这种类型的应用程序。我建议构建[PocketSphinx Demo](http://cmusphinx.sourceforge.net/2011/05/building-pocketsphinx-on-android/)应用程序，使用在线 sphinx [lmtool](http://www.speech.cs.cmu.edu/tools/lmtool-new.html)构建您的简短命令列表的语言模型，看看它是否满足您的响应时间需求。如果`onResults`回调不够快，您可以使用`onPartialResults`几乎立即返回的回调——这就是我所做的，我对性能感到满意。演示应用程序在 UI 中也有一个小内置计时器。

如果您使用在线[lmtool](http://www.speech.cs.cmu.edu/tools/lmtool-new.html)，您可以从它生成`lm`的文件中获取文件和`dict`文件，使用它们替换他们在演示设置说明中指向您的语言模型中的相应文件`lm`。`dict`

构建起来有点痛苦，但这是我第一次使用 NDK，它很挑剔。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-20T02:38:50.150

您在寻找关键字识别软件吗？[sensoryinc.com](http://sensoryinc.com/ "sensoryinc.com")多年来一直这样做，最近才开发了一些 Android 应用程序。这是一个我正在开车并想使用语音触发器来录制音频笔记的示例。只有在我说“你好蓝色精灵”之后，它才会开始录制我的音频笔记。 [http://vimeo.com/64658273](http://vimeo.com/64658273) （不，我不为 Sensory 工作，但我认为他们的技术被大大低估了）

# iphone - 如何让 UITableView 位于 UIImageView 之上

> ID：10307384
> 
> 赞同：0
> 
> 时间：2012-04-24T23:25:05.273
> 
> 标签：iphone, objective-c, ios, uitableview, uiimageview

我试图实现以下效果 - UIImageView 放置在底部 - UITableView 放置在 UIImageView 顶部并覆盖 UIImageView 的一部分 - 当下拉 UITableView 时，UIImageView 的其余部分将相应地出现。

我在 UIViewController 中以以下方式编码

```
[self.view addSubview:[self myImageView]]; // CGRectMake(0.0f, 0.0f, 320.0f, 240.0f)
[self.view addSubview:[self myTableView]]; // CGRectMake(0.0f, 140.0f, 320.0f, 480.0f) 
```

但在视觉上，当表格视图被拉下时，它就像表格视图位于图像视图下方并被拉出图像视图，而不是我想要在上面实现的。

如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T05:11:56.080

我相信您可以将表格视图的 .backgroundImage 或 .backgroundView 属性设置为`[UIImage imageNamed@"my image"];`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T23:59:03.390

UITableView 不会在子视图层次结构中显示其背后的内容。它有一个背景，从技术上讲，您并没有在视图中上下拖动一长串列表，而是简单地拖动始终相同高度的设置框架中显示的内容。向上或向下拖动太多时，会显示表格视图的背景*。

您的问题有两种解决方案..

您可以将图像添加为表格视图的背景（使用上面的对象名称）：

```
// nil by default (but has a color if nil)
[[self myTableView] setBackgroundView:[self myImageView]]; 
```

或者您可以使表格视图的背景颜色透明，在背景中显示任何子视图：

```
[[self myTableView] setBackgroundColor:[UIColor clearColor]]; 
```

在您的情况下，由于 myImageView 框架没有填满整个屏幕框架，后一种解决方案可能是最好的解决方案，但只要意识到没有图像的区域将是任何最后的背景颜色（UIViewController 的背景或 UIWindow，具体取决于您的设置）。

希望这可以帮助！

*除非设置页眉或页脚视图，但这是 UIScrollView 的一部分，UITableView 继承自它，在这种情况下可能不是您要查找的内容，因为这些视图会随着 tableview 内容滚动，而不是静态显示在后面桌子。

# iphone - 按钮到 XIB 链接，带我进入空白屏幕（Xcode）

> ID：10307388
> 
> 赞同：0
> 
> 时间：2012-04-24T23:25:38.117
> 
> 标签：iphone, xcode, xib, nib, ibaction

好的，所以发生的事情是我有一个按钮设置来链接到 Xcode 中的另一个视图，所以当按下按钮时，您将被定向到该视图。够简单吗？所以我认为。我已经多次完成相同的实现，但由于某种原因，当我链接到我要去的视图时，它只会让我进入一个空白的白色屏幕。这是代码：

```
- (IBAction)mainmenu:(id)sender
{
    UIScrollView_PagingViewController *MainMenu = [[UIScrollView_PagingViewController alloc] initWithNibName:nil bundle:nil];
    MainMenu.modalTransitionStyle = UIModalTransitionStyleCrossDissolve;
    [self presentModalViewController:MainMenu animated:YES];
    [UIScrollView_PagingViewController release];
} 
```

如果您想查看我的 XIB 文件或我的总代码 (1.4MB)，这是我的整个项目：[http ://www.mediafire.com/?cayw6o35ftcxsah](http://www.mediafire.com/?cayw6o35ftcxsah)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T02:18:24.097

您正在使用 nil NIB 名称初始化 MainMenu（应按照命名约定称为 mainMenu）。因此，如果您的 NIB 的名称与视图控制器的名称不同，它将找不到它。要解决此问题，请指定您希望视图控制器加载的 NIB 名称。

此外，您应该释放 MainMenu 变量，而不是 UIScrollView_PagingViewController 类。所以这也是一个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T06:10:49.907

当您分配 MainView 时，您正在使用带有 nil 参数的 initWithNibName ：尝试

    UIScrollView_PagingViewController *MainMenu = [[UIScrollView_PagingViewController alloc] initWithNibName:@"UIScrollView_PagingViewController" bundle:nil];

或者干脆

    UIScrollView_PagingViewController *MainMenu = [[UIScrollView_PagingViewController alloc] init];

# c++ - 表示二维数据的 std::vector 中的内存泄漏

> ID：10307389
> 
> 赞同：5
> 
> 时间：2012-04-24T23:25:39.183
> 
> 标签：c++, memory-leaks, valgrind

我编写了一个简单的模板化 Matrix 类，用于处理数据矩阵的主应用程序。截断的矩阵代码是：

```
template <typename T> 
class Matrix{
   private:
      std::vector<T> matrixRepresentation;
      bool transposed;
  public: 
  Matrix(int r, int c);
  int maxRows;
  int maxCols;
  void setMatrixValue(int row, int col, T val);
  T getMatrixValue(int row, int col);
};

template <typename T>
Matrix<T>::Matrix(int r, int c){
   maxRows = r;
   maxCols = c;
   matrixRepresentation.resize((r+1)*(c+1));
}   

template <typename T>
void Matrix<T>::setMatrixValue(int row, int col, T val){
   matrixRepresentation[row + col*maxCols] = val;
}

template <typename T>
T Matrix<T>::getMatrixValue(int row, int col){
   return matrixRepresentation[row + col*maxCols];
} 
```

如您所见，我只是将 2D 矩阵表示为向量并提供包装器方法来隐藏该事实。即使我将堆栈变量 matrixRepresentation 调整为

```
(r+1)(c+1) 
```

我后来在代码中遇到了内存损坏问题，valgrind 告诉我以下内容：

```
==3753==    at 0x8049777: Matrix<int>::setMatrixValue(int, int, int) (in a.out)
==3753==    by 0x8049346: DataFile::readAllData() (ina.out)
==3753==    by 0x8049054: DataFile::DataFile(char const*) (in a.out)
==3753==    by 0x804C386: main (in a.out)
==3753==  Address 0x42cc970 is 0 bytes after a block of size 5,600 alloc'd
==3753==    at 0x4026351: operator new(unsigned int) (vg_replace_malloc.c:255)
==3753==    by 0x804A603: __gnu_cxx::new_allocator<int>::allocate(unsigned int, 
            void   const*) (in /a.out)
==3753==    by 0x8049F0D: std::_Vector_base<int, std::allocator<int> 
            >::_M_allocate(unsigned int) (in a.out)
==3753==    by 0x804A181: std::vector<int, std::allocator<int> 
            >::_M_fill_insert(__gnu_cxx::__normal_iterator<int*, std::vector<int, 
            std::allocator<int> > >, unsigned int, int const&) (in a.out)
==3753==    by 0x8049AEF: std::vector<int, std::allocator<int> 
            >::insert(__gnu_cxx::__normal_iterator<int*, std::vector<int, 
            std::allocator<int> > >, unsigned int, int const&) (in a.out)
==3753==    by 0x80499AB: std::vector<int, std::allocator<int> >::resize(unsigned int,
            int) (in a.out)
==3753==    by 0x8049709: Matrix<int>::Matrix(int, int) (in a.out)
==3753==    by 0x80492AD: DataFile::readAllData() (in a.out)
==3753==    by 0x8049054: DataFile::DataFile(char const*) (in a.out)
==3753==    by 0x804C386: main (in a.out) 
```

readAllData() 方法（此矩阵类的用户）只是从文本文件中读取并尝试填充矩阵

```
void DataFile::readAllData(){
   int currentValue;
   featureMatrix = new Matrix<int>((theHeader.totalNumSamples),
   (theHeader.numFeatures));

    if (infile.is_open()){
       if (!infile.eof()){
          for (int row=0; row < theHeader.totalNumSamples; row++){
            for (int col=0; col < theHeader.numFeatures; col++){
               infile >> currentValue;
               featureMatrix->setMatrixValue(row, col, currentValue);
             }
          }
       }
       else{
          cout << "EOF reached before we should have been done!  Closing file";
          infile.close();
       }
   }
   else cout << "File not open when attempting to read data";

   infile.close();
} 
```

标头值是有效的（例如 theHeader.totalNumSamples = 15，theHeader.numFeatures = 100）。

如果我可以提供更多信息，请告诉我，我真的可以为此提供一些帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-24T23:40:49.307

此代码段（在您的代码中出现两次）：

```
 [row + col*maxCols] 
```

是不对的。它应该是`[row * maxCols + col]`或`[col*maxRows + row]`

就此而言，您不需要`matrixRepresentation.resize((r+1)*(c+1));` 分配，而是可以分配`matrixRepresentation.resize(r*c);`

您应该对极端情况进行数学计算（例如访问元素`(maxRows-1,maxCols-1)`以自行检查以进行理解）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T23:37:15.600

这能解决你的问题吗？

```
template <typename T>
Matrix<T>::Matrix(const int r, const int c) :
   maxRows(r),
   maxCols(c),
   matrixRepresentation((r+1)*(c+1))
{} 
```

它可能会或可能不会解决它，但非常值得一试，如果只是为了排除`Matrix`.

更新：@ChrisA. 的答案更好。先试试那个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T00:00:21.533

不确定 Valgrind 的具体问题是什么，但我发现了这一点：

```
maxRows = r;
maxCols = c;
matrixRepresentation.resize((r+1)*(c+1)); 
```

然后，在您的构造函数中，您正在创建一个 3x3 矩阵，但分配了 16 个位置，而不是 9 个。虽然这不一定是问题，但您可能会通过放置此填充来隐藏其他错误。我的看法是只分配您需要的空间，如果您发现自己崩溃或表现不佳，请修复其中的问题，而不是在您的 Matrix 实现中补偿它们。

# objective-c - 触发器内的 NSButton 子类也是其他类

> ID：10307390
> 
> 赞同：1
> 
> 时间：2012-04-24T23:25:42.667
> 
> 标签：objective-c, xcode

我在 IB 中创建了**NSButton**的子类，并将子类设置为我的按钮的自定义类。该按钮有效，但在我的主文件（**NSObject**）中，作为链接到同一按钮的**IBAction的“** **someMethod** ”不起作用。我想做的是“如果”子类（**NSButton**）被点击，那么在我的（**NSObject**）里面 someMethod 应该**退出**，就像它被点击一样。但是我迷路了，不明白为什么它不起作用，请帮帮我，我真的迷路了。

 ********我会给你整个源代码，我的 .h 文件中有以下代码：**

```
#import <Cocoa/Cocoa.h>

@interface HoverButton : NSButton
{

    NSTrackingArea *trackingArea;

}

- (void)mouseEntered:(NSEvent *)theEvent;
- (void)mouseExited:(NSEvent *)theEvent;
- (void)mouseDown:(NSEvent *)ev;
- (void)mouseUp:(NSEvent *)theEvent;

@end 
```

**.m 文件的以下代码：**

```
#import "HoverButton.h"

@implementation HoverButton

- (void)updateTrackingAreas
{
    [super updateTrackingAreas];

    if (trackingArea)
    {
        [self removeTrackingArea:trackingArea];
        [trackingArea release];
    }

    NSTrackingAreaOptions options = NSTrackingInVisibleRect | NSTrackingMouseEnteredAndExited | NSTrackingActiveInKeyWindow;
    trackingArea = [[NSTrackingArea alloc] initWithRect:NSZeroRect options:options owner:self userInfo:nil];
    [self addTrackingArea:trackingArea];

}

- (void)mouseEntered:(NSEvent *)event
{

    [self setImage:[NSImage imageNamed:@"1"]];
}

- (void)mouseExited:(NSEvent *)event
{
    [self setImage:[NSImage imageNamed:@"2"]];
}

- (void)mouseDown:(NSEvent *)ev {

    [self setImage:[NSImage imageNamed:@"2"]];

}

- (void)mouseUp:(NSEvent *)ev {
    [self setImage:[NSImage imageNamed:@"1"]];

}
@end 
```

**这是主要的 .h 文件：**

```
#import <Cocoa/Cocoa.h>

@interface Main : NSObject {

}
-(IBAction) someMethod:(id) sender;

@end 
```

**和主 .m 文件**

```
#import "Main.h"

#import "HoverButton.h"

@implementation Main

-(IBAction) someMethod:(id) sender   
{

     NSEvent *SKMouseDown; //Mouse down events

     HoverButton *frac = [[HoverButton alloc] init];

    [frac mouseDown: SKMouseDown];

    exit(0); // < --- does not work, someMethod docent work.

}

@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T22:14:08.323

如果我理解正确，你喜欢从 nsbutton 子类中的事件回调父类。它可以通过不同的方式完成：

*   添加@property（分配）主要*代表

*   分配 HoverButton 后设置 frac.delegate = self;

在您喜欢调用委托调用的任何方法中： if (delegate && [delegate performSelector:@selector(someMethod:)]) { [delegate someMethod:self]; }

这一切，在两个平台上都可以正常工作******

# c# - 文件中的空引用

> ID：10307399
> 
> 赞同：4
> 
> 时间：2012-04-24T23:26:54.477
> 
> 标签：c#

我在这条线上遇到错误：

```
String selectedValue = this.employeeList.SelectedValue.ToString(); 
```

我得到的错误是

> NullReferenceException 未处理。

这是什么意思？有人可以帮我理解为什么我会收到这个错误。下面是整个代码。

```
String filePath = this.txtFilePath.Text;
if (!String.IsNullOrEmpty(filePath))
{
    MessageBox.Show("No file path specified");
}

if (this.employeeList.SelectedIndex != -1)
{
    String selectedValue = this.employeeList.SelectedValue.ToString();
    using (StreamWriter writer = new StreamWriter(filePath, true))
    {
        writer.WriteLine(selectedValue);
    }
}
else
{
    MessageBox.Show("No item selected");
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T23:30:09.793

这意味着您正在尝试访问为 null 的内容（未初始化为任何有效值）。因此，在访问之前添加一个空检查。

我想在这种情况下，`employeeList.SelectedValue`可能是空的。

```
String selectedValue = string.Empty;
if(this.employeeList.SelectedValue!=null)
{
  selectedValue = this.employeeList.SelectedValue.ToString();
}
else
{
  MessageBox.Show("Please select any value");
} 
```

如果您遇到任何此类错误，请**始终使用 Visual Studio 断点并逐行逐行**查看即将出现的值以及中断的位置。这是理解代码有什么问题的最好方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T23:29:14.973

这意味着 this.employeeList.SelectedValue 有一个空值。

空对象 (SelectedValue) 没有方法，因此您不能在其上调用 .ToString()。

调查为什么 this.employeeList.SelectedValue 为空，你会找到问题的根源。

# iphone - 屏幕不更新直到按下主页按钮

> ID：10307403
> 
> 赞同：0
> 
> 时间：2012-04-24T23:27:47.400
> 
> 标签：iphone, objective-c, ios

我最近开始遇到一个奇怪的错误。我正在将我的应用程序从 iPhone 转换为 iPad。一切似乎都很顺利，直到我注意到我所有的按钮和开关都停止工作了。当我的应用程序启动时，一切正常（在两个平台上）。然后，当您尝试按钮时，应用程序会显示为冻结状态。什么都没有发生。当您按下 Home 按钮时，您所做的所有更改（但没有看到）都会在返回家之前快速显示。如果您重新打开应用程序（不退出它），所有按钮都可以完美运行。但在最初的发布时，一切都被打破了。

以前有没有人发生过这种情况？我从旧的工作版本中改变的只是显示哪个 xib（iphone 或 ipad）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T19:38:26.747

我似乎已经修复了它。确定使用哪个 xib 的复杂过程显然是问题所在。回到简单地使用

```
[self.window addSubview:viewController.view];
[self.window makeKeyAndVisible]; 
```

并且依靠命名约定来选择 xib 就足以修复它。

# linux-device-driver - insmod 失败，因为模块中的未知符号

> ID：10307405
> 
> 赞同：5
> 
> 时间：2012-04-24T23:27:49.630
> 
> 标签：linux-device-driver

当我执行内核对象的 insmod 时，由于该模块中的一些未知符号而失败。

但是由于某些原因，它没有向我显示符号（它说它是未知的）。

无论如何要找到那个？请指教。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-18T07:43:03.003

当您的 linux 内核和模块不匹配时，就会发生这种情况。像您正在执行 insmod 到与您为其创建模块的内核版本不同的内核版本的情况。

确保您正在运行创建模块的内核版本。我假设您使用了错误版本的内核头文件。尝试改变它。

# perl - 基于 HTTPS 的 Perl XML-RPC

> ID：10307406
> 
> 赞同：1
> 
> 时间：2012-04-24T23:27:50.213
> 
> 标签：perl, ssl, xml-rpc

我有几个使用 DBI 的 Perl 脚本，我正在清理它们并将其转换为 Rose::DB。我的公司使用名为 Password Manager Pro (PMP) 的产品来管理身份验证资源。PMP 有一个[XML-RPC API](http://www.manageengine.com/products/passwordmanagerpro/help/a-to-a-web-service-api-xml-rpc.html#pmp.password.retrieve)，我正在尝试构建一个模块，Rose::DB::Object 将调用该模块来获取数据库资源的密码，而不是将凭据存储为明文。

我查看了[RPC::XML](http://search.cpan.org/perldoc?RPC%3a%3aXML)和[XML::RPC](http://search.cpan.org/perldoc?XML%3a%3aRPC)并且找不到 ssl 的选项。我在 Google 上搜索了一个基于 HTTPS 的 XML-RPC 示例，但没有运气。

我的大部分脚本都与数据库相关，到目前为止我还没有对基于 Web 的模块做太多事情。我希望有人可以推荐一个解决方案/示例，说明如何将以下 XML 传递到服务器并使用 SSL 证书标识自己：

```
<?xml version="1.0" encoding="utf-8"?>
<methodCall>
  <methodName>pmp.password.retrieve</methodName>
    <params>
      <param>
        <value><string>pmp-server</string></value>
      </param>
      <param>
        <value><string>administrator</string></value>
      </param>
    </params>
</methodCall> 
```

我使用以下内容开始了我的模块，但是如果没有将 ssl 呈现给服务器，它就不好了：

```
#!/usr/bin/perl

use XML::RPC;
my $certfile = /home/api/.ssl/pmp.p12;  #Where to pass this?
my $xmlrpc = XML::RPC->new('https://pmp.local:7070/xmlrpc');
my @result = $xmlrpc->call( 'pmp.password.retrieve', {
   resourceName => 'DBSERV', 
   userAccount => 'APITest', 
   reason => 'Test' 
});

print @result; 
```

任何建议帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T01:49:02.777

XML::RPC 首先使用 LWP（如果他安装了），用于 SSL 的 LWP 使用 Crypt::SSLeay 和 Net::SSL，它们使用以下变量：

```
$ENV{HTTPS_PKCS12_FILE}     = 'certs/pkcs12.pkcs12';
$ENV{HTTPS_PKCS12_PASSWORD} = 'PKCS12_PASSWORD'; 
```

UPD：所有密钥（如果需要）。

```
# proxy support
$ENV{HTTPS_PROXY} = 'http://proxy_hostname_or_ip:port';

# proxy_basic_auth
$ENV{HTTPS_PROXY_USERNAME} = 'username';
$ENV{HTTPS_PROXY_PASSWORD} = 'password';

# debugging (SSL diagnostics)
$ENV{HTTPS_DEBUG} = 1;

# default ssl version
$ENV{HTTPS_VERSION} = '3';

# client certificate support
$ENV{HTTPS_CERT_FILE} = 'certs/notacacert.pem';
$ENV{HTTPS_KEY_FILE}  = 'certs/notacakeynopass.pem';

# CA cert peer verification
$ENV{HTTPS_CA_FILE}   = 'certs/ca-bundle.crt';
$ENV{HTTPS_CA_DIR}    = 'certs/';

# Client PKCS12 cert support
$ENV{HTTPS_PKCS12_FILE}     = 'certs/pkcs12.pkcs12';
$ENV{HTTPS_PKCS12_PASSWORD} = 'PKCS12_PASSWORD'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T00:37:09.660

一种解决方案（虽然可能不是最好的）是使用像[stunnel](http://stunnel.org/)这样的 SSL 代理。您将其设置为侦听端口，然后使用适当的证书将进入的任何连接转发到另一个地址/端口。这是一个更动人的部分，虽然不太理想，但它确实完成了工作。

# c# - System.IndexOutOfRangeException - 索引超出了数组的范围

> ID：10307407
> 
> 赞同：1
> 
> 时间：2012-04-24T23:27:54.147
> 
> 标签：c#, multidimensional-array, outofrangeexception

我正在创建一个程序，该程序从 excel 表中导入 2d 对象信息数组。然后它将这个数组传递给 ProcessObjects 方法进行处理并打印/导出回一个 excel 模板。谁能告诉我为什么我会收到这个错误消息？

“在 Project.exe 中发生了“System.IndexOutOfRangeException”类型的未处理异常

附加信息：索引超出了数组的范围。”

```
private void ProcessObjects(object[,] classesArray, object[,] classesAvailabilityArray, Excel.Workbook workbook2, Excel.Sheets excelSheets)
{
    // once classes are selected, they are copied to a temporary location
    // while they're waiting to be printed
    object[,] tempArray = new object[6,3];

    // This stops the while loop once enough credit hours have been taken 
    // It must reach 123 hours for CS Degree .
    int hourCounter = 0;

    int iteration = 0;

    while (hourCounter < 123)
        {
            // this while loop copies some classes from classesArray to tempArray
            // so they can be printed into the excel template (NewStudentTemplateCS.xlsx)
            //
            int classes = 0, hours = 0; // stops while loop if limit is reached
            int w = 0, x = 0; // used to select individual elements of tempArray (0 based)
                              // w = row
                              // x = column
            int y = 1, z = 1; // used to select individual elements of classesArray (1 based)
                              // y = row
                              // z = column
            while(classes < 7 || hours < 17)
            {
                // this loop checks the status of the flag and stops at the first avaliable
                // class/row of classesArray
                while (classesArray[y,7] == (object)1)
                {
                    y++;
                }

                // copies the call EX: "MATH 2313" from classesArray to tempArray
                tempArray[w,x] = classesArray[y,z];
                x += 2;
                z += 2;
                // copies the name EX: "Calculus I" from classesArray to tempArray
                tempArray[w, x] = classesArray[y, z];
                x++;
                z++;
                // Copies the hours EX: "3" from classesArray to tempArray
                tempArray[w, x] = classesArray[y, z];

                Console.WriteLine("debug test");

                // increments classes, hours, and hourCounter for exit decision
                classes += 1;
                hours += (int)classesArray[y, z];
                hourCounter += (int)classesArray[y, z];

                // sets flag to one
                z += 3;
                classesArray[y, z] = 1;

            }// end while loop

            // print method that prints temp array and clears tempArray for next use
            PrintArray(tempArray, iteration, workbook2, excelSheets);

            // iterates iteration
            iteration++;

        } // end while loop
        // print method that prints temp array and clears tempArray for next use
        PrintArray(tempArray, iteration, workbook2, excelSheets);

        // iterates iteration
        iteration++;

    } // end while loop
} // end ProcessObjects method 
```

我已分别注释掉以下每一行，但每一行代码都返回我上面列出的相同错误。

```
Console.WriteLine("debug test");

// increments classes, hours, and hourCounter for exit decision
classes += 1;
hours += (int)classesArray[y, z];
hourCounter += (int)classesArray[y, z];

// sets flag to one
z += 3;
classesArray[y, z] = 1; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T00:00:59.403

在调试器中单步执行您的代码：

```
object[,] tempArray = new object[6,3]; 
```

您正在创建一个最大索引为 的数组`tempArray[5, 2]`。然后你开始循环。在每个循环开始时：

```
int w = 0, x = 0; 
```

然后在循环体中：

```
tempArray[w,x] = classesArray[y,z]; 
```

你分配给`tempArray[0, 0]`

```
x += 2;
z += 2;
tempArray[w, x] = classesArray[y, z]; 
```

你分配给`tempArray[0, 2]`

```
x++;
z++;
// Copies the hours EX: "3" from classesArray to tempArray
tempArray[w, x] = classesArray[y, z]; 
```

您分配给`tempArray[0, 3]`. 但最大索引`tempArray`为[0, 2]；您的数组索引超出范围，正是异常告诉您的。

如果您可以确定`y`并且`z`永远不会超出 的范围`classesArray`，则可以这样声明`tempArray`：

```
object[,] tempArray = new object[classesArray.GetLength(0), classesArray.GetLength(1)]; 
```

但是对于所有这些硬编码的幻数，并尝试将数组与不同的基数同步，这是非常危险的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T23:59:22.157

您正在使用的整数（即 w、x、y、z）变得大于定义的数组大小。您应该在代码中添加断点，以便您可以查看编译期间发生的情况，并查看它们在哪里变得比数组定义所预期的要大。

通常，循环的规则用于阻止索引越界异常的发生。我建议稍微分解一下代码，似乎发生了很多事情，但对于这个循环来说似乎太多了。

# javascript - 在 TweenJS 中循环后暂停

> ID：10307411
> 
> 赞同：0
> 
> 时间：2012-04-24T23:28:16.143
> 
> 标签：javascript, tween

我希望你们中的一些人使用过 tween.js（create.js 库套件的一部分）。

我有一个 JS Fiddle 向您展示我的问题：http: [//jsfiddle.net/qyp8Y/1/](http://jsfiddle.net/qyp8Y/1/)

我在每个 8 步循环后看到一个暂停，这不应该存在。

有人可以看看它并告诉我我做错了什么吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T21:59:49.693

当然，让我们逐步执行一些代码：

```
for (i = 0; i <= 8; i++) {
    t.to({
        rotation: 45 * i
    }, 1000, Ease.elasticOut).wait(200);
} 
```

以下是您在该循环中创建的值：

```
i : rotation 
0 : 0
1 : 45
2 : 90
3 : 135
4 : 180
5 : 225
6 : 270
7 : 315
8 : 360 
```

请注意，出于您的目的，0 和 360 是相同的值。这意味着当循环从头开始时，它会在一整秒内从 360 到 0（或无处）补间。

您的对象从旋转 0 开始，您无法摆脱到 360 的补间。但是，您可以通过从 45 的补间开始（从 1 开始）来删除到 0/360 的冗余补间

这种变化导致了这个（注意：我也改变了轻松，所以我可以更好地看到它）：

```
for (i = 1; i <= 8; i++) {
    t.to({
        rotation: 45 * i
    }, 1000, Ease.quadInOut).wait(200);
} 
```

当然，接下来要解决的问题是如何让齿轮旋转，但又不会失去正确的光照/阴影方向。我会把它留给你。

更新：我通过您提交的 github 问题找到了这个。

# ruby-on-rails - 我应该在 Ruby on Rails 中使用引号或冒号作为会话键吗？

> ID：10307412
> 
> 赞同：5
> 
> 时间：2012-04-24T23:28:33.910
> 
> 标签：ruby-on-rails

目前我有一个会话变量，当我同时使用`session["test"]`或时返回相同的值`session[:test]`。这两个是一样的吗？使用一个比另一个更好吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T23:54:41.507

在标准的 Ruby Hash 中，它们不一样（[字符串与符号](http://www.robertsosinski.com/2009/01/11/the-difference-between-ruby-symbols-and-strings/)）

但是，rails[`SessionHash`](https://github.com/rack/rack/blob/master/lib/rack/session/abstract/id.rb#L50)子类在存储键之前调用`to_s`它们，因此所有键都存储为字符串（即使您指定了符号）：

```
class SessionHash < Hash

  def [](key)
    load_for_read!
    super(key.to_s)
  end

  def []=(key, value)
    load_for_write!
    super(key.to_s, value)
  end 
```

这就是为什么`session[:test]`并且`session["test"]`会在 rails 中返回相同的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T23:35:01.603

就红宝石字符串和符号而言，它们并不相同。

作为一般规则，您应该使用第二种形式，符号是用来表示某些东西的东西，否则它会是一个字符串。这是一种有效地拥有描述性名称的方法，同时节省了用于多次生成字符串的空间。

这意味着每次引用符号时不会像引用字符串那样创建新实例。该符号只是表示您所描述的值的更好方式。

为了完整起见，我应该提一下，如果您稍后需要表示，可以将符号轻松转换为字符串。

如果你想了解更多，这里有一篇很长的博文[，](http://aaronbonner.tumblr.com/post/5960999188/understanding-ruby-symbols)它很好地解释了红宝石符号。可以说它们是一种优化。

也就是说，ruby SessionHash 在符号上调用 to_s ，因此您可以在这种情况下使用任何一种，因为无论哪种方式输入都会产生字符串。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T23:38:57.113

不，它们并不完全相同。它们是完成同一件事的两种方式。

一般来说，在 Ruby 中，符号的主要用途是作为键。符号是`:these_things`。哈希键是它们的典型用途......

```
{
  :name => 'Mary',
  :rank => 'Captain'
} 
```

会话密钥通常也是符号。

改用字符串不会有任何伤害，但符号更典型。

# facebook - facebook应用程序需要个人资料图片的尺寸

> ID：10307416
> 
> 赞同：0
> 
> 时间：2012-04-24T23:29:16.547
> 
> 标签：facebook, facebook-graph-api

我正在使用服务器流 facebook 应用程序，当我获得用户的个人资料图片时，我将该 URL 保存在我的 HttpSession 中。但是，我还有一个 javascript 功能，当鼠标悬停在我的应用程序中的某些帖子上时，并且我的用户是 facebook 用户，我会以大约 100 像素大小显示图片。但是，我不知道图片的相对高宽比，并且是框在一个盒子里的。我需要知道用户上传的facebook图片的高度和宽度，但是我在facebook developer graph api中找不到这些信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T00:37:16.320

个人资料图片尺寸取决于您选择的类型。有关类型的摘要，请参阅[此](https://stackoverflow.com/questions/10299528/get-users-photo-in-the-size-of-the-profile-photo/10301103#10301103)答案。每种类型对应一个最大尺寸。

API 仅指定个人资料图像的最大大小，而不是实际大小。

正方形

```
maximum width and height of 50px. 
```

小的

```
maximum width of 50px and a maximum height of 150px. 
```

普通的

```
maximum width of 100px and a maximum height of 300px. 
```

大的

```
maximum width of 200px and a maximum height of 600px. 
```

如果您调用默认的 USER_ID/图片，您将获得方形类型。

# php - 当 include() 或 require() 时，我是否总是必须使用 ../../ 相对于我的文件？有简单的方法吗？

> ID：10307426
> 
> 赞同：1
> 
> 时间：2012-04-24T23:30:12.820
> 
> 标签：php, path, include, directory, require

我正在构建一个 web 应用程序，它的 php 文件分布在不同的目录中，所以一个典型的文件可能有几个包含。所有这些文件无处不在。

一个 php 文件可能如下所示：

```
include('../../some.php');
require('../../some.php'); 
```

在另一个文件中你可能有这样的东西：

```
 include('../../../../some.php');
require('../../../../some.php'); 
```

重点是，这可能会有点失控，并且有点难以跟踪。有没有办法可以做到这一点，这样我就不需要一直这样做`../../..`了？

我试过这样做：

```
include('http://www.mywebsite.com/some.php');
require('http://www.mywebsite.com/some.php'); 
```

但它似乎不起作用，但有趣的是，我在使用 require 时不会得到 PHP 错误，只会出现 `call to function x() error, function or object doesn't exist`类型错误。它从来没有说过文件不存在。先感谢您。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T23:53:00.573

不要相信`$_SERVER`变量。在某些环境中，它们可以由发出请求的用户设置/更改。最好在索引/引导文件中手动定义基本路径并在需要时使用它。

```
define('SYSTEM_PATH', __DIR__ . '/'); 
```

或在 5.3 之前的 PHP 版本上，您可以执行此操作

```
define('SYSTEM_PATH', dirname(__FILE__) . '/'); 
```

现在，您始终可以知道文件的路径。

```
require(SYSTEM_PATH . 'lib/class.php'); 
```

`__DIR__`和都是PHP 设置`__FILE__`的**安全**常量，可以信任。

您可以像这样自动加载类：

```
function __autoload($class_name)
{
    require SYSTEM_PATH . strtolower($class_name) . '.php';
} 
```

在其他新闻中，*我*想不出. `include()`如果你需要使用 include 你做错了什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T23:50:36.410

这就是发明包含路径的目的。如果您的公用文件夹之外有一个您经常使用的文件夹，请创建一个指向它的包含路径。这样，您可以将其视为与其他所有内容位于同一文件夹中。

[http://php.net/manual/en/function.set-include-path.php](http://php.net/manual/en/function.set-include-path.php)

然而，比这更好的是，创建一个类自动加载器......

[http://php.net/manual/en/language.oop5.autoload.php](http://php.net/manual/en/language.oop5.autoload.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T23:31:40.267

用这个：

```
include($_SERVER['DOCUMENT_ROOT'] . '/inc/connect.php'); 
```

这会将您带到文档根目录，然后从那里构建其余部分......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T23:32:21.750

您可以在 php.ini 中设置包含路径，也可以使用`chdir`. 为了安全起见，我更喜欢两者，但这很好用：

```
chdir($_SERVER['DOCUMENT_ROOT']); 
```

现在您可以像当前文件在根文件夹中一样包含您的文件。

# flash - SetInterval 用于下降的movieclips

> ID：10307428
> 
> 赞同：0
> 
> 时间：2012-04-24T23:30:42.953
> 
> 标签：flash, actionscript, actionscript-2

我正在尝试制作一个苹果掉下来的游戏，但我无法为每个创建的影片剪辑设置间隔。当我使用下面的代码创建它时，苹果的移动会在创建另一个时停止。

```
function FallAnApple()
{
    _apple = "apple_" + _counter;
    attachMovie("apple", _apple, _counter);
    eval(_apple)._x = RandomX();
    eval(_apple)._y = -16;

    setInterval(function(){eval(_apple)._y += 2;}, 100);

    _counter += 1;
} 
```

当我在苹果电影剪辑中放置一个区间时，我无法在区间内访问 this._y，但我可以在创建的电影本身内访问这个值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T23:47:39.620

只需在创建苹果时保留一个数组，然后在间隔触发时更改数组中每个苹果的坐标。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T23:50:57.623

第一行覆盖 _apple 变量的内容。所以在那之后，两个间隔都在最新的苹果上运行。

# asp.net-mvc - RavenDB 部署问题

> ID：10307432
> 
> 赞同：10
> 
> 时间：2012-04-24T23:30:54.997
> 
> 标签：asp.net-mvc, asp.net-mvc-3, ravendb

我有一个我开发的 ASP.Net MVC 3 应用程序，它使用 RavenDB Embedded 作为数据的集成后备存储，我使用[本](http://www.dotnetcurry.com/ShowArticle.aspx?ID=787)教程作为开始使用 RavenDB Embedded 创建 MVC 应用程序的基础。我已经能够在我的开发 PC 上正常运行它，但是当需要将它部署到运行 IIS6 的 Windows Server 2003 Web 服务器上时，它抛出了以下错误：

> 无法访问文件，文件被锁定或正在使用 描述：在执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。
> 
> 异常详细信息：Microsoft.Isam.Esent.Interop.EsentFileAccessDeniedException：无法访问文件，文件已锁定或正在使用
> 
> 源错误：
> 
> 在执行当前 Web 请求期间生成了未处理的异常。可以使用下面的异常堆栈跟踪来识别有关异常起源和位置的信息。
> 
> 堆栈跟踪：
> 
> [EsentFileAccessDeniedException：无法访问文件，文件已锁定或正在使用] C:\Work\ravendb\SharedLibs\Sources\managedesent-61618\EsentInterop\Api 中的 Microsoft.Isam.Esent.Interop.Api.Check(Int32 err)。 c:2736 Raven.Storage.Esent.TransactionalStorage.Initialize(IUuidGenerator uuidGenerator) 在 c:\Builds\RavenDB-Stable\Raven.Storage.Esent\TransactionalStorage.cs:207
> 
> [InvalidOperationException：无法打开事务存储：C:\inetpub\wwwroot\MyApp\App_Data\Database\RavenDB\Data]
> Raven.Storage.Esent.TransactionalStorage.Initialize(IUuidGenerator uuidGenerator) 在 c:\Builds\RavenDB-Stable\Raven .Storage.Esent\TransactionalStorage.cs:222 Raven.Database.DocumentDatabase..ctor(InMemoryRavenConfiguration 配置) 在 c:\Builds\RavenDB-Stable\Raven.Database\DocumentDatabase.cs:185
> Raven.Client.Embedded.EmbeddableDocumentStore.InitializeInternal() 在 c:\Builds\RavenDB-Stable\Raven.Client.Embedded\EmbeddableDocumentStore.cs:143 Raven.Client.Document.DocumentStore.Initialize() 在 c:\Builds\RavenDB -Stable\Raven.Client.Lightweight\Document\DocumentStore.cs:496 MyApp.CompositionRoot.CreateControllerFactory() in ...\MyApp\CompositionRoot.cs:36 MyApp.CompositionRoot..ctor() in ..\MyApp\CompositionRoot .cs:17
> MyApp.MvcApplication.Application_Start() 在 ...MyApp\Global.asax.cs:38
> 
> [HttpException (0x80004005): 无法打开事务存储：C:\inetpub\wwwroot\MyApp\App_Data\Database\RavenDB\Data]
> System.Web.HttpApplicationFactory.EnsureAppStartCalledForIntegratedMode(HttpContext context, HttpApplication app) +3985477
> System.Web.HttpApplication .RegisterEventSubscriptionsWithIIS(IntPtr appContext, HttpContext context, MethodInfo[] handlers) +191
> System.Web.HttpApplication.InitSpecial(HttpApplicationState state, MethodInfo[] handlers, IntPtr appContext, HttpContext context) +325
> System.Web.HttpApplicationFactory.GetSpecialApplicationInstance(IntPtr appContext , HttpContext 上下文) +407
> System.Web.Hosting.PipelineRuntime.InitializeApplication(IntPtr appContext) +375
> 
> [HttpException (0x80004005): 无法打开事务存储：C:\inetpub\wwwroot\MyApp\App_Data\Database\RavenDB\Data]
> System.Web.HttpRuntime.FirstRequestInit(HttpContext context) +11524352 System.Web.HttpRuntime.EnsureFirstRequestInit( HttpContext 上下文）+141 System.Web.HttpRuntime.ProcessRequestNotificationPrivate（IIS7WorkerRequest WR，HttpContext 上下文）+4782309

引用的 CompositionRoot.cs 类中的错误来源是初始化 Embeddable Document Store 时。

```
private static IControllerFactory CreateControllerFactory()
{
    var cacheRepository = new EmbeddableDocumentStore();
    cacheRepository.ConnectionStringName = "RavenDB";

    #if DEBUG
        cacheRepository.UseEmbeddedHttpServer = true;
    #endif

    Raven.Database.Server.NonAdminHttp.EnsureCanListenToWhenInNonAdminContext(8080);
    cacheRepository.Initialize(); //Source of Error
    var controllerFactory = new TDRControllerFactory(cacheRepository);
    return controllerFactory;
} 
```

为什么这只发生在 Web 服务器上而不是我的开发 PC 上？我不确定确切的原因可能是什么。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-25T16:47:23.693

原来这是一个权限问题，我给 IIS_IUSRS 组修改和写入我的应用程序文件夹根目录的权限，并赋予它正确初始化数据库所需的权限。根目录中可能有一个特定的文件夹需要对其进行修改/写入访问（在我的情况下，可能是 App_Data 文件夹，因为我正在实例化我的 RavenDB 实例）。我必须进行测试，因为我不希望任何用户拥有对整个应用程序文件夹的修改/写入权限。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-25T06:40:13.073

您需要确保`CreateControllerFactory`只运行一次，即使在应用启动时面对并发请求也是如此。

# android - 开发适用于模拟器或手机的网络应用程序的最佳方法

> ID：10307449
> 
> 赞同：2
> 
> 时间：2012-04-24T23:33:19.217
> 
> 标签：android, networking

假设您有三部 Android 手机（A、B 和 C）连接到同一个接入点。所以每部手机都有不同的IP地址。例如：

*   A 位于 192.168.1.50
*   B 位于 192.168.1.60
*   C 位于 192.168.1.70

在每一个中，我都安装了相同的应用程序。在这个应用程序中有两个[UDP](http://en.wikipedia.org/wiki/User_Datagram_Protocol)套接字：

```
DatagramSocket sendSocket = new DatagramSocket();
DatagramSocket receiveSocket = new DatagramSocket(55000); 
```

由于每部电话都使用不同的 IP 地址，因此每部电话都可以向其他所有电话发送数据包。例如，要从 B 向 A 发送数据包：

```
InetAddress address = InetAddress.getByName("192.168.1.50");
byte[] data = "Hello".getBytes();
DatagramPacket sendPacket = new DatagramPacket(data, data.length, address, 55000);
sendSocket.send(sendPacket); 
```

现在的问题是：**在同一台机器上使用三个模拟器开发和调试此应用程序的最佳方法是什么，以便在模拟器中运行它的代码几乎与在真实设置上运行它的代码相同？**

我做过的尝试：

*   使用[此处](https://stackoverflow.com/questions/6064510/how-to-get-ip-address-of-the-device)提供的代码，我在同一台机器上启动了两个模拟器并打印了它们的 IP 地址，为两个模拟器获得了相同的 IP 地址`fe80::5054:ff:fe12:3456%eth0`：所以死路一条。
*   仅启动了两个仿真器，每个仿真器都位于接收和发送套接字的特定和不同端口上。这种方法效果很好，但它不适用于更多机器，因为重定向和部署开始变得相当麻烦和复杂。更不用说我必须使用 10.0.2.15 和 10.0.2.2 IP 地址才能使其正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T23:39:09.070

我没有一个好主意，这是一种解决方法，但是您可以创建两个虚拟机（我使用[VirtualBox](http://en.wikipedia.org/wiki/VirtualBox)作为虚拟机，它是免费的），将 Linux（可能是[Ubuntu](http://en.wikipedia.org/wiki/Ubuntu_%28operating_system%29)）放在它们上面，安装 SDK 并放入你的代码在那里测试它。

更好的主意：创建多个 AVD。在每一个上调试您的应用程序。只是（在[Eclipse](http://en.wikipedia.org/wiki/Eclipse_%28software%29)中）`F11`，退出。关闭 AVD。启动其他 AVD。对每个 AVD 重复。准备好后，启动它们并从模拟器上的应用程序菜单启动应用程序。

# php - 将变量添加到 SQL 查询以获取每日结果

> ID：10307453
> 
> 赞同：0
> 
> 时间：2012-04-24T23:34:01.433
> 
> 标签：php, sql, yii

在我的模型中，我有以下查询，它在数据库中可用的最后一天平均 $probe 值小时。

```
$connection=Yii::app()->db;
$command=$connection->createCommand("SELECT AVG($probe), TIME FROM tbl_sensors GROUP BY DATE(TIME), HOUR(TIME) ORDER BY ID DESC LIMIT 0, 24");
$dataReader=$command->query(); 
```

现在我想修改这个查询以获得昨天、前天等的结果。

我的第一个想法是添加一个由控制器修改 LIMIT 参数提供的变量。虽然如下：

```
SELECT AVG($probe), TIME FROM tbl_sensors GROUP BY DATE(TIME), HOUR(TIME) ORDER BY ID DESC LIMIT 24, 48 
```

返回 48 个值而不是 24 个。我不明白这是为什么？

欢迎任何指点

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T23:47:13.247

`LIMIT 24, 48`不是从 24 到 48。而是从 24 到 (24+48)。
如果我换一种说法，它从 24 开始，得到 48 条记录。

```
LIMIT 24, 24 
```

[http://dev.mysql.com/doc/refman/5.1/en/select.html](http://dev.mysql.com/doc/refman/5.1/en/select.html)

但我建议你使用`WHERE`

```
SELECT AVG($probe), TIME FROM tbl_sensors
WHERE `TIME` BETWEEN ... AND ...
GROUP BY DATE(TIME), HOUR(TIME)
ORDER BY ID DESC LIMIT 0, 24 
```

# c - 在 C 中填充一个数组

> ID：10307457
> 
> 赞同：1
> 
> 时间：2012-04-24T23:34:15.587
> 
> 标签：c, arrays, ansi

我有一个关于用 C 中的值填充数组的问题。我有一个字符串，我想将它拆分成一个新字符串数组，每 14 个“节”长。

```
int main(int argc , char *argv[])
{
char string[]="50 09 00 00 98 30 e0 b1 0d 01 00 00 00 00 4f 09 00 00 98 30 c6 b1 0d 01 01 01 01 50 09 00 00 98 30 e0 b1 0d 01 00 00 00 00 4f 09 00 00 98 30 c6 b1 0d 01 01 01 01";

char delim[] = " ";
char *result = NULL;
char *strArray[1440] = {0};
int i = 0;
result = strtok(string, " ");

while (result) 
{
 strArray[i] = result;
 result = strtok( NULL, delim );
 i++;
}

// Now I have each 'section' of the original string in strArray[xx]

int z = 1022;
int c;
char arr[5000];
char *finalarr[100] = {0};
char buff[100];
int l = 0;

for(c=0;c<z;++c) 
{
  strcat(arr,strArray[c]);
  if (c % 14 == 13)
  {
     // print the value so far for check, this gives an output of 28 chars 
     puts(arr);
     // copy value of arr to buff
     ret = sprintf(buff,"%s", arr);
     // copy value of buff to instance of finalarr
     finalarr[l] = buff;
     // empty arr
     strcpy(arr," ");
    l++;
  }
}

// both have the same value (last value of arr)
printf("finalarr1 = %s\n",finalarr[1]);
printf("finalarr20 = %s\n",finalarr[20]);
} 
```

也许我正试图以一种过于复杂的方式解决它（我希望如此）。无论如何，一些帮助的方向将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T00:18:42.430

您应该替换以下行：

```
 // copy value of arr to buff
 ret = sprintf(buff,"%s", arr);
 // copy value of buff to instance of finalarr
 finalarr[l] = buff; 
```

和：

```
 finalarr[l] = strdup(arr); 
```

因为您只需要复制存储在`arr`. `buff`不应该需要该变量。

和行：

```
 // empty arr
 strcpy(arr," "); 
```

和：

```
 *arr = '\0'; 
```

因为您只需要“重置”字符串`arr`。使用您的原始行，您只需用“孤独”空间“替换”以前的文本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T01:02:47.837

```
#include <stdio.h>
#include <string.h>

int main(int argc , char *argv[])
{
    int i;
    int fcount=0;
    int acount=0;
    char string[]="50 09 00 00 98 30 e0 b1 0d 01 00 00 00 00 4f 09 00 00 98 30 c6 b1 0d 01 01 01 01 50 09 00 00 98 30 e0 b1 0d 01 00 00 00 00 4f 09 00 00 98 30 c6 b1 0d 01 01 01 01";
    char *finalarr[100];
    char arr[29]="\0";
    for (i=0;i<(strlen(string));i++)
    {
        if ((i+1)%3!=0)
        {
            strncpy(&arr[acount],&string[i],1);
            acount++;
            if (acount==28)
            {
                acount=0;
                arr[29]="\0";
                finalarr[fcount]=strdup(arr);
                fcount++;
            }

        }
    }
    printf("finalarr1 = %s\n",finalarr[0]);
    printf("finalarr1 = %s\n",finalarr[1]);
    printf("finalarr1 = %s\n",finalarr[2]);
    return 0;
} 
```

结果：

```
finalarr1 = 500900009830e0b10d0100000000
finalarr1 = 4f0900009830c6b10d0101010150
finalarr1 = 0900009830e0b10d01000000004f 
```

# c# - 使用枚举类保持枚举到对象的映射？

> ID：10307459
> 
> 赞同：11
> 
> 时间：2012-04-24T23:34:38.050
> 
> 标签：c#, design-patterns, enums, mapping

我经常需要枚举和另一个对象（本例中为字符串）之间的全局硬编码映射。我想共同定位枚举和映射定义以澄清维护。

如您所见，在此示例中，创建了一个带有一个静态字段的烦人的类。

```
public enum EmailTemplates
{
    // Remember to edit the corresponding mapping singleton!
    WelcomeEmail,
    ConfirmEmail
}

public class KnownTemplates
{
    public static Dictionary<EmailTemplates, string> KnownTemplates;
    static KnownTemplates() {
        KnownTemplates.Add(EmailTemplates.WelcomeEmail, "File1.htm");
        KnownTemplates.Add(EmailTemplates.ConfirmEmail, "File2.htm");
    }
} 
```

有时映射类可以有更多的功能和有意义的名称，映射活动甚至可以是私有的。但这只会污染维护/关联问题。

有人对此有很好的模式吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-24T23:58:03.610

您可以使用属性来注释枚举，然后使用反射来构建字典。

```
[AttributeUsage(AttributeTargets.Field)]
sealed class TemplateAttribute : Attribute {

  public TemplateAttribute(String fileName) {
    FileName = fileName;
  }

  public String FileName { get; set; }

}

enum EmailTemplate {

  [Template("File1.htm")]
  WelcomeEmail,

  [Template("File2.htm")]
  ConfirmEmail

}

class KnownTemplates {

  static Dictionary<EmailTemplate, String> knownTemplates;

  static KnownTemplates() {
    knownTemplates = typeof(EmailTemplates)
      .GetFields(BindingFlags.Static | BindingFlags.Public)
      .Where(fieldInfo => Attribute.IsDefined(fieldInfo, typeof(TemplateAttribute)))
      .Select(
        fieldInfo => new {
          Value = (EmailTemplate) fieldInfo.GetValue(null),
          Template = (TemplateAttribute) Attribute
            .GetCustomAttribute(fieldInfo, typeof(TemplateAttribute))
        }
      )
      .ToDictionary(x => x.Value, x => x.Template.FileName);
  }

} 
```

如果您经常这样做，您可以创建一个更通用的通用函数，将枚举值与与该枚举值关联的属性结合起来：

```
static IEnumerable<Tuple<TEnum, TAttribute>> GetEnumAttributes<TEnum, TAttribute>()
  where TEnum : struct
  where TAttribute : Attribute {
  return typeof(TEnum)
    .GetFields(BindingFlags.Static | BindingFlags.Public)
    .Where(fieldInfo => Attribute.IsDefined(fieldInfo, typeof(TAttribute)))
    .Select(
      fieldInfo => Tuple.Create(
        (TEnum) fieldInfo.GetValue(null),
        (TAttribute) Attribute.GetCustomAttribute(fieldInfo, typeof(TAttribute))
      )
    );
} 
```

并像这样使用它：

```
knownTemplates = GetEnumAttributes<EmailTemplate, TemplateAttribute>()
  .ToDictionary(tuple => tuple.Item1, tuple => tuple.Item2.FileName); 
```

为了更有趣，您可以创建一个扩展方法：

```
static class EmailTemplateExtensions {

  static Dictionary<EmailTemplate, String> templates;

  static EmailTemplateExtensions() {
    templates = GetEnumAttributes<EmailTemplate, TemplateAttribute>()
      .ToDictionary(tuple => tuple.Item1, tuple => tuple.Item2.FileName);
  }

  public static String FileName(this EmailTemplate emailTemplate) {
    String fileName;
    if (templates.TryGetValue(emailTemplate, out fileName))
      return fileName;
    throw new ArgumentException(
      String.Format("No template defined for EmailTemplate.{0}.", emailTemplate)
    );
  }

} 
```

然后调用`EmailTemplate.ConfirmEmail.FileName()`将返回`File2.htm`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-12-11T11:35:00.550

这是一种对我来说效果很好的方法。

```
public class BaseErrWarn : Attribute
{
    public string Code { get; set; }
    public string Description { get; set; }

    public BaseErrWarn(string code, string description)
    {
        this.Code = code;
        this.Description = description;
    }
}

public enum ErrorCode
{
    [BaseErrWarn("ClientErrMissingOrEmptyField", "Field was missing or empty.")] ClientErrMissingOrEmptyField,
    [BaseErrWarn("ClientErrInvalidFieldValue", "Not a valid field value.")] ClientErrInvalidFieldValue,
    [BaseErrWarn("ClientErrMissingValue", "No value passed in.")] ClientErrMissingValue
} 
```

现在您可以使用反射将 Enum 映射到 BaseErrWarn 类：

```
public static BaseErrWarn GetAttribute(Enum enumVal)
{
    return (BaseErrWarn)Attribute.GetCustomAttribute(ForValue(enumVal), typeof(BaseErrWarn));
}

private static MemberInfo ForValue(Enum errorEnum)
{
    return typeof(BaseErrWarn).GetField(Enum.GetName(typeof(BaseErrWarn), errorEnum));
} 
```

这是一个示例，它使用此映射将 Enum 映射到对象，然后从中提取字段：

```
 public BaseError(Enum errorCode)
    {
        BaseErrWarn baseError = GetAttribute(errorCode);
        this.Code = baseError.Code;
        this.Description = baseError.Description;
    }

    public BaseError(Enum errorCode, string fieldName)
    {
        BaseErrWarn baseError = GetAttribute(errorCode);
        this.Code = baseError.Code;
        this.Description = baseError.Description;
        this.FieldName = fieldName;
    } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-26T09:47:20.783

通常，当您想向枚举元素添加额外的信息或行为时，这意味着您需要一个完整的类。您可以从（旧）Java 中借用类型安全的枚举模式并创建如下内容：

```
sealed class EmailTemplate {
  public static readonly EmailTemplate Welcome = new EmailTemplate("File1.html");
  public static readonly EmailTemplate Confirm = new EmailTemplate("File2.html");

  private EmailTemplate(string location) {
    Location = location;
  }
  public string Location { get; private set; }

  public string Render(Model data) { ... }
} 
```

现在您可以将任何属性或方法与您的元素相关联，例如`Location`和`Render`以上。

# android - 在 Intellij IDEA 11 的模拟器中模拟我的位置

> ID：10307460
> 
> 赞同：1
> 
> 时间：2012-04-24T23:34:38.543
> 
> 标签：android, intellij-idea, location, simulate

如何在 Intellij IDEA 11 的模拟器中模拟我的位置，

喜欢在 Eclipse 中使用 DDMS 工具吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T09:45:15.153

您可以在 IDEA 中使用相同的 DDMS 工具：`Tools`| `Android`| `DDMS`.

# android - 在 Arnova 9 G3 上开发 - 通过“adb 设备”不可见

> ID：10307470
> 
> 赞同：1
> 
> 时间：2012-04-24T23:36:21.553
> 
> 标签：android

我有运行 Android 4.0.3 的新 Arnova 9 G3，4 月 23 日刚从 Maplin 购买。我正在尝试在运行 OS X 10.7 的 Mac 上开始开发。但我无法让它出现在 Eclipse 中或通过 Android Mac SDK 附带的“adb”工具。

我已将 0x0e79 添加到 ~/.android/adb_usb.ini 文件中。

当我插入 Arnova 9 G3 并输入“adb devices”时，没有列出任何内容。我启用了 USB 调试。

当我插入运行 Android 4.0.2 的 Galaxy Nexus 并在控制台中输入“adb devices”时，我会看到列出的设备。

有什么想法我需要做什么吗？

# python - 在创建具有外键字段的对象时插入外键

> ID：10307472
> 
> 赞同：0
> 
> 时间：2012-04-24T23:36:51.733
> 
> 标签：python, django, django-models, django-forms, django-views

我真的不明白我有这个模型有什么问题：

```
class Upload_files(models.Model): #uploaded files(for approval) are stored here
file=models.FileField(upload_to=""+strftime("%j", gmtime())+"/")
cont = models.ForeignKey(Contractor)
def __unicode__(self):
    return self.file.name 
```

和形式：

```
class uploadFile(forms.ModelForm):
file = forms.FileField(label=(u'file'))

cont = forms.ModelChoiceField(label="cont",
                             queryset=Contractor.objects.all(),
                             required = False
                             ) 
```

并在我在其中创建对象的方法中：

```
cont = Contractor.objects.get(id=contractor_id)
file = Upload_files.objects.create(file=file,cont=cont)
file.save() 
```

这就是我得到的错误：

```
shoghlanah_upload_files has no column named cont_id 
```

我无法真正理解我的代码有什么问题，所以请有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T23:38:21.373

您需要删除数据库并使用 重新创建它，或者在当前数据库上`syncdb`设置并运行迁移。[`south`](http://south.aeracode.org/docs/tutorial/part1.html#starting-off)

# jquery - 用jquery模拟鼠标点击选择选项

> ID：10307474
> 
> 赞同：11
> 
> 时间：2012-04-24T23:37:22.973
> 
> 标签：jquery, select, click, option

当我单击 Select 选项时，我正在处理 Changed 事件。

我想在代码中对此进行模拟，并让它看起来与用户单击该选项时相同。

到目前为止，在选项上设置 'selected' 属性并不会像单击它时那样突出显示它。

我可以触发选项上的“更改”并点击我的处理程序，但列表上的选项没有被选中，就像单击一样。

建议？

更新：查询选择代码工作得很好 - 感谢您的回复。问题是我的（当然）。我在 Jquery.Ajax Success: 块之外有选择代码，所以我认为它正在工作，但 ajax 响应代码正在处理它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-19T20:53:56.507

我正在使用 jquery 数据表插件 ColumnFilterWidgets，我需要执行以下操作来执行过滤操作（基于 elclanrs 和 Ben Foster 的回答）：

```
$("option").attr('selected', 'selected').parent().focus();
$("option").parent().change(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-24T23:47:09.357

```
​$('option[value="4"]').attr('selected', 'selected').parent().focus();​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

为我工作。见[http://jsfiddle.net/TZVyh/1/](http://jsfiddle.net/TZVyh/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T23:42:32.237

```
$("option").attr("selected","selected"); 
```

将选择您想要的选项。之后您可以触发事件。

并且不要忘记使用以下方法清除其他选项的选定属性：

```
$("option").attr("selected",null); 
```

或者

```
$("option").removeAttr("selected"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T23:47:31.703

> ...但是列表上的选项没有被选中，就像单击一样。

我不完全理解您要做什么，但`$('select').change()`与`$('select option').click()`. 在`change`事件`$(this).val()`中是所选选项的值以及在`click`事件中。

在任何一种情况下，您都可以选择一个选项`$('select[value="yourvalue"]').prop('selected', true);`

# postgresql - postgres 数据库错误，强制重新启动事务

> ID：10307476
> 
> 赞同：4
> 
> 时间：2012-04-24T23:37:41.120
> 
> 标签：postgresql, activerecord

TL;DR：在 AR::Base 保存事务中插入重复的连接表记录失败（由于唯一约束）导致保存失败并回滚。不添加重复的连接表记录很好。不储蓄是不好的。

* * *

我正在将 mysql 应用程序迁移到 postgres ......我曾经在 mysql-land 中遵循类似的模式将连接表记录添加到数据库：

```
class EventsSeries < ActiveRecord::Base
  #  UNIQUE KEY `index_events_series_on_event_id_and_series_id` (`event_id`,`series_id`)
  belongs_to :event
  belongs_to :series
end

class Series < ActiveRecord::Base

  has_many :events_series
  before_validation :add_new_event

private

  def add_new_event
    # boils down to something like this
    EventSeries.new.tap do |es|
      es.event_id = 1
      es.series_id = 1
      begin
        es.save!
      rescue ActiveRecord::RecordNotUnique
        # Great it exists
        # this isn't really a problem
        # please move on
      end
    end
  end
end 
```

像这样调用：

```
Series.first.save 
# should not blow up on duplicate join record, cause i don't care 
```

然而，postgres 对此大发雷霆。这里有一个很好的解释：

[http://api.rubyonrails.org/classes/ActiveRecord/Transactions/ClassMethods.html](http://api.rubyonrails.org/classes/ActiveRecord/Transactions/ClassMethods.html)

...在“异常处理和回滚”部分（参见警告）

基本上#save启动一个事务，重复记录插入导致数据库异常，使#save的事务无效，这是sadface。

有没有更好的模式可以在 postgres-land 中使用？

谢谢！

* * *

编辑：

我坚信将这个逻辑保留在 Series 的保存事务中是有意义的……模式如下所示：

```
s = Series.new
s.new_event_id = 123 # this is just an attr_accessor
s.save # callbacks on Series know how to add the new event. 
```

...它使我的控制器超级小。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T22:34:14.447

如果您在事务中并且要从错误中恢复并避免使整个事务无效，则必须使用保存点。

当您使用命令**SAVEPOINT some-label**时，您可以稍后运行命令**ROLLBACK TO SAVEPOINT some-label**以在事务中返回到该状态并忽略在采取保存点后的所有操作（包括错误）。

[请在主键违规错误后继续交易](https://stackoverflow.com/questions/2370328/continuing-a-transaction-after-primary-key-violation-error/2372997#2372997)中查看我的其他答案，以获得更详尽的解释。

# python - 安装 python reddit api 包装模块

> ID：10307477
> 
> 赞同：1
> 
> 时间：2012-04-24T23:37:46.110
> 
> 标签：python, api, module, wrapper, reddit

我已经下载了 zip 文件中的源代码。然后我将其移至 /Library/Python/2.6/site-packages/mellort-reddit_api-2d91358。我一直在尝试安装它：python setup.py install。这没有奏效。然后我尝试使用 python /Library/Python/2.6/site-packages/mellort-reddit_api-2d91358/setup.py install 安装它，但这也不起作用。

在这两种情况下，它都说：

```
Traceback (most recent call last):
  File "/Library/Python/2.6/site-packages/mellort-reddit_api-2d91358/setup.py", line 9,     in         <module>
    open('reddit/__init__.py').read()).group(1)
IOError: [Errno 2] No such file or directory: 'reddit/__init__.py' 
```

我认为它找不到：

```
reddit/__init__.py 
```

我只尝试将文件放在 python 2.6 文件夹中。

有什么想法吗？如果您能提供分步说明，我将非常高兴。如果这有所作为，我正在使用 mac。

如果你以前使用过这个模块（在[https://github.com/mellort/reddit_api](https://github.com/mellort/reddit_api)找到）你是如何处理这个问题的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T23:58:52.097

您可以通过以下方式安装它`pip`：

```
sudo apt-get install python-pip python-dev build-essential
sudo pip install reddit -U 
```

**OP评论后更新：**

对于 Mac，你可以这样做：

```
sudo easy_install pip
sudo pip install reddit -U 
```

更多关于如何在 Mac 上安装 pip 的信息可以在[这里](http://www.pidby.com/2009/07/installing-pip-and-ipython-on-mac.html)找到。

# iphone - iphone - 动态加载大量文本和图像

> ID：10307489
> 
> 赞同：0
> 
> 时间：2012-04-24T23:39:29.243
> 
> 标签：iphone, ios

我正在开发一个 iphone 应用程序，我刚刚学习 iphone 应用程序开发几周，所以我在这里有一些问题：这个应用程序将从远程服务器加载许多帖子，帖子由一个文本字段、一个图像组成，和三个按钮（好、坏和评论）。服务器上有上千篇文章，所以我以为app每次会加载3篇文章，当用户向上滚动页面时，它会继续加载上一篇文章，如果用户向下滚动页面，它会继续加载下一篇文章。作为一个新手，我不知道 View 对它有什么好处，任何建议都值得赞赏。

我试过了 ：

1.  UIView + UIScrollView + 标签/图像/按钮（帖子）
2.  UIView + UITableView + UITableViewCell（标签、图像、按钮）

第一个很好，第二个，我真的不知道如何在第二个选项中制作它..那么什么视图模式适合这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T03:00:20.317

您将希望对列表视图中的几乎所有内容使用 UITableView。UITableView 回收是用于节省内存的单元格，因此它可以处理比滚动视图中的一堆 uiviews 更多的项目，我将从阅读 UITableview 文档开始，并查找一些关于自定义 UITableView 单元格的教程。

这是文档：

[http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UITableView_Class/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UITableView_Class/Reference/Reference.html)

我个人有一个小库，我使用自定义 UITableViewCell（通过子类化）设置来执行此操作。您还需要设置一个适用于远程服务器分页的模型（您声明的时间为 3 个）。因此，在最后一篇文章中，您将想要添加一个自定义加载更多单元格，当点击该单元格时，将获得第 2 页，然后起泡、冲洗、重复。任何问题让我知道。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T03:21:50.493

您应该使用 UITableView 选项。要判断用户是否滚动到底部，[请查看此链接](https://stackoverflow.com/a/5627837/63803)。

另外，开始简单的方法。只需使用标准 UITableViewCell 并将 detailText 标签设置为您下载的帖子标题。一旦你弄清楚了这一点以及处理滚动和自动下载新帖子，然后更新单元格以处理图像和其他内容。

# c - 有没有将 Arduino 代码转换为 C 代码的方法或教程？

> ID：10307496
> 
> 赞同：9
> 
> 时间：2012-04-24T23:40:13.853
> 
> 标签：c, embedded, arduino

我知道这个问题很笼统，但我找不到一个教程或一个好的编码方法来转换 Arduino 代码（我的意思是我们在 Arduino 软件上编写的代码，对于[Arduino Uno](http://arduino.cc/en/Main/ArduinoBoardUno)或[Mega](http://en.wikipedia.org/wiki/List_of_Arduino_compatibles#Official_Arduino_versions)或 . .. ) 即使是小样本。

有教程吗？

我只是想学习技术，我知道这取决于项目。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-24T23:45:05.850

Arduino代码或多或少是C代码*。*

Arduino的独特之处在于代码是预处理的（例如，它们通过建立`setup`和`loop`函数提供简单的钩子）并且有一个托管的构建/上传过程来处理板限制、包含、库等......

当然可以自己使用相同的工具包来构建和运行代码，我就是这样做的。*[Arduino 和 GCC，仅使用 makefile 编译和上传程序](http://www.ashleymills.com/node/327)*是我发现的最有用的链接，涵盖了您需要开始的步骤。

正如我所说，我已经离开了 Arduino IDE，自己走上了这`avr-gcc`条路，因为如果你了解 GNU 工具，你可以做更强大的事情——比如使用 C++ 标准库。我错过了我`vector`的s，我能说什么。[avr-libc](http://www.nongnu.org/avr-libc/)在完整的 C++ 功能方面相当落后，因此很难塞入[STL](http://en.wikipedia.org/wiki/Standard_Template_Library)，但[Andy Brown 已经让大部分](http://andybrown.me.uk/ws/2011/01/15/the-standard-template-library-stl-for-avr-with-c-streams/)功能发挥作用。

把这些东西放在一起，你就有了一个相当强大的开发环境。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-25T06:48:56.307

*（编辑：我在写我自己的答案时错过了马特答案中非常有用的链接。所以让我们说下面是链接的非技术摘要）。*

马特答对了。我想添加更多信息。

了解Arduino编程的关键在目录`Arduino-1.0\hardware\arduino\cores\arduino`

您将找到包含以下内容的`main.cpp`文件：

```
#include <Arduino.h>

int main(void)
{
    init();

    #if defined(USBCON)
        USB.attach();
    #endif

    setup();

    for (;;) {
        loop();
        if (serialEventRun) serialEventRun();
    }

    return 0;
} 
```

“setup()”和“loop()”（如果您阅读了 Arduino 文档，甚至是“serialEventRun()”）是否会响铃？:-)

Arduino 只隐藏了这一点。

Arduino 使用 C++ 语言。当然，如果你自己用 avr-gcc 编译你的代码，你可以使用 C，但是 Arduino IDE 的配置方式，它是纯 C++。

但是，由于微控制器并未真正适应面向对象的开发，因此缺少一些功能。我想到了“新”和“删除”运算符。它们不存在，因此开箱即用，在使用 Arduino 开发时应避免使用堆。这就是为什么如果你想使用一些标准的 C++ 库你应该小心。它们可能不适用于微控制器编程（太多的内存操作）。

在该`Arduino-1.0\hardware\arduino\cores\arduino`目录中，还可以看到 Arduino 库的实现。它允许查看存在哪些“低级”微控制器功能（来自 avr-libc）以及如何实现自己的库和工具。

顺便说一句，正如您想知道如何在 C 中移植 Arduino 代码，avr-libc 是一个 C 库而不是 C++ 库。因此，您可以看到 Arduino 如何将其 C++ 代码包装在 C 代码上。

在`File/Preferences`菜单中，您可以选中“查看详细输出”以查看用于构建最终 Arduino 二进制文件的参数和文件（以及临时构建目录的位置）。

最后，您还必须知道 Arduino 板在您的代码中嵌入了引导加载程序。它简化了从 Arduino IDE 到 Arduino 板的部署。所以 Arduino 板实际上包含的代码比你自己的要多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-25T17:57:20.983

这不是一个转换教程，而是一篇关于 arduino 的 hello world 背后的精彩文章：
[Arduino internals 之旅。你好世界实际上是如何工作的？](http://urbanhonking.com/ideasfordozens/2009/05/18/an_tour_of_the_arduino_interna/)

# ios - Xcode 在项目中生成发布语句转换为 ARC

> ID：10307503
> 
> 赞同：1
> 
> 时间：2012-04-24T23:41:07.613
> 
> 标签：ios, xcode, automatic-ref-counting

我刚刚使用 Xcode 中的重构命令将项目转换为 ARC。但是，当我将一条线从 IB 中的视图拖到我的源代码以生成存根 ivar 代码时，它会在 -viewDidUnload 和 -dealloc 中生成带有版本的代码。在以 ARC 开始的项目中，它显然不会这样做。

如果生成非 ARC 代码，我可以对项目做些什么来停止？

# jquery - jquery 动画但随后恢复正常

> ID：10307505
> 
> 赞同：7
> 
> 时间：2012-04-24T23:41:31.330
> 
> 标签：jquery, jquery-ui

考虑一个 div “dMyDiv”

我注意到在 jquery 中我可以制作动画，这样：

```
$( "#dMyDiv").animate({
         backgroundColor: "#aa0000"
  }, 1000 ); 
```

为我的 div 带来类似红色的彩色背景。但是有没有办法在说 10 秒后回到我的 div 的正常白色背景？我看到有一个回调函数，但我不确定是否可以启动动画，并且一旦动画完成就回到我的常规背景（动画之前）。我应该这样做：

```
 $( "#dMyDiv").animate({
             backgroundColor: "#aa0000"
          }, 1000, function() {
           $(#dMyDiv").animate({ backgroundColor: "#fff" }, 1000);
          };
); 
```

意思是在红色动画之后，只是再次动画到白色？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-24T23:52:59.923

你是对的。第三个参数是动画完成后执行的函数。

```
$("#dMyDiv").stop().animate({backgroundColor:'#aa0000'},1000,function(){
    $(this).animate({backgroundColor:'#fff'},1000);
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-24T23:56:48.860

您可以使用 setTimeout：

```
$("#dMyDiv").stop(true, true).animate({

    backgroundColor: "#aa0000"

}, 1000, function() {

   setTimeout(function() {       

       $(#dMyDiv").animate({ 

           backgroundColor: "#fff" 

       }, 1000);

   }, 10 * 1000);

}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T23:57:59.763

我能够和这些人一起做到这一点：

[http://jsfiddle.net/aN7qz/](http://jsfiddle.net/aN7qz/)

这是代码：

```
$( "#myDiv").animate({ 
             backgroundColor: "#aa0000" 
          },
             1000, 
             function() { 
                 $("#myDiv").animate({ backgroundColor: "#fff" }, 1000);
             }
                     ); 
```

# ios - SplitViewController 在纵向视图中崩溃（ipad）

> ID：10307506
> 
> 赞同：4
> 
> 时间：2012-04-24T23:41:35.250
> 
> 标签：ios, ipad, uisplitviewcontroller, uipopovercontroller

我有一个包含五个拆分视图控制器的选项卡式应用程序。

在纵向模式下，“主”按钮按预期显示，并且在前两个控制器上，该按钮按预期运行。但是，在最后三个选项卡上，该按钮会导致崩溃并显示以下消息：

-[_UISlidingPopoverLayoutInfo _popoverViewSizeForContentSize:arrowDirection:], /SourceCache/UIKit_Sim/UIKit-1914.84/_UIPopoverLayoutInfo.m:160 中的断言失败 2012-04-24 19:15:38.674 SMToolkit[12420:11303] ***由于未捕获的异常而终止应用程序NSInternalInconsistencyException'，原因：'未知方向传递给 _popoverViewSizeForContentSize:arrowDirection:'

问题是，这五个视图是从同一来源剪切并粘贴的，几乎是 Apple 的样板。我实际上并没有为弹出框编写故事板，也没有在 prepareforsegue 方法中使用它们，因为从理论上讲，spliltviewcontroller 将它们“免费”提供给我

所有五个 splitviewcontroller 都符合 UISplitViewControllerDelegate

appdelgate 是这样的：

```
 UITabBarController *tabBarController = (UITabBarController *)self.window.rootViewController;
   //Person
    UISplitViewController *personSplitViewController = [tabBarController.viewControllers objectAtIndex:1];
    UINavigationController *personNavigationController = [personSplitViewController.viewControllers lastObject];
    personSplitViewController.delegate = (id)personNavigationController.topViewController;
    UINavigationController *personMasterNavigationController = [personSplitViewController.viewControllers objectAtIndex:0];
    PersonMasterViewController *personController = (PersonMasterViewController *)personMasterNavigationController.topViewController;
    personController.managedObjectContext = self.managedObjectContext;
    //Scene
    UISplitViewController *sceneSplitViewController = [tabBarController.viewControllers objectAtIndex:2];
    UINavigationController *sceneNavigationController = [sceneSplitViewController.viewControllers lastObject];
    sceneSplitViewController.delegate = (id)sceneNavigationController.topViewController;
    UINavigationController *sceneMasterNavigationController = [sceneSplitViewController.viewControllers objectAtIndex:0];
    SceneMasterViewController *sceneController = (SceneMasterViewController *)sceneMasterNavigationController.topViewController;
    sceneController.managedObjectContext = self.managedObjectContext; 
```

依此类推，在tabBarController中替换正确的索引

然后在详细视图控制器中，每个控制器都有以下内容（相同，我检查过）：

```
- (void)splitViewController:(UISplitViewController *)splitController willHideViewController:(UIViewController *)viewController withBarButtonItem:(UIBarButtonItem *)barButtonItem forPopoverController:(UIPopoverController *)popoverController
{
barButtonItem.title = NSLocalizedString(@"Master", @"Master");
[self.navigationItem setLeftBarButtonItem:barButtonItem animated:YES];
self.masterPopoverController = popoverController;
}

- (void)splitViewController:(UISplitViewController *)splitController willShowViewController:(UIViewController *)viewController invalidatingBarButtonItem:(UIBarButtonItem *)barButtonItem
{
// Called when the view is shown again in the split view, invalidating the button and popover controller.
[self.navigationItem setLeftBarButtonItem:nil animated:YES];
self.masterPopoverController = nil;
} 
```

在上面，“人”的行为符合预期，但“场景”导致了崩溃。

我在任何视图中都看不到任何关于单击该 barbuttonitem 时发生的情况的任何内容，并且它没有出现在情节提要中。

想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T19:16:37.120

不幸的是，至少在我的情况下，答案是我们的代码中有一个非常愚蠢的错误。

发生的事情是，在主视图的 viewWillAppear 中，我们在详细视图上设置了一些东西，这反过来又试图让主视图出现。把它拿出来，让每个视图控件本身就解决了这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T11:01:42.840

这个错误有点神秘。当我不小心 `[UIPopoverController presentPopoverFromBarButtonItem: permittedArrowDirections:]`按顺序调用两次时，我遇到了同样的错误，第二次调用是在渲染/动画弹出框时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-29T13:39:00.647

只有当任何方法返回 nil 时，才会出现断言失败错误。所以想建议你为所有变量设置 self 并检查 nil ..

# php - 通过 POST 向多个 PHP 文件提交值

> ID：10307509
> 
> 赞同：1
> 
> 时间：2012-04-24T23:41:59.437
> 
> 标签：php, javascript, html

我有一个表格：

```
<form action="moods.php" method="post" id="geog">
Longitude: <input size="15" id="lonbox" name="lon" type="text" />
Latitude: <input size="15" id="latbox" name="lat" type="text" />
<input type="submit"  />
</form> 
```

我希望使用上面的单个表单同时将纬度和经度的值提交给多个 .php 文件，而不是moods.php。

我怎样才能做到这一点？？请提出一些方法..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T23:45:58.250

您可以将其提交到包含处理多个提交的 cURL 脚本的文件

```
<form action="multi_submit.php" method="post" id="geog"> 
```

在 multi_submit.php 上使用[cURL处理表单提交](http://us2.php.net/manual/en/book.curl.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T23:47:47.050

当您可以让一个脚本包含（）其他脚本时，为什么要将表单提交到多个页面？

```
require('script1.php');
require('script2.php');
require('script3.php'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T00:26:06.163

如果您确实需要提交多个 .php 文件的值，而 dqhendricks 提供的 require 选项无法解决，为什么不使用多个 Ajax 调用呢？每个文件一个。

你可以有这样的东西：

```
<form onsubmit='sendSeveralPost()'>
... form fields
</form> 
```

和javascript函数

```
function sendSeveralPost() {
    var f1 = document.getElementById('field1');
    var f2 = document.getElementById('field2');

    var x = getXmlHttp();

    var params = 'field1='+f1+'&field2='+f2;

    x.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
    x.setRequestHeader("Content-length", params.length);
    x.setRequestHeader("Connection", "close");

    var files = new Array();
    files[0] = 'script1.php';
    files[1] = 'script2.php';
    files[2] = 'script3.php';

    for (i=0;i<files.lenght;i++) {
        var url = files[i];
        x.open("POST", url, true);

        x.onreadystatechange = function() {//Call a function when the state changes.
             if(x.readyState == 4 && x.status == 200) {
                alert(x.responseText);
            }
        }
        x.send(params);
    }
}

function getXmlHttp() {
    var xmlHttp;
    try {    // Firefox, Opera 8.0+, Safari
        xmlHttp=new XMLHttpRequest();
    } catch (e) {
        try {     // Internet Explorer 6.0+
            xmlHttp=new ActiveXObject("Msxml2.XMLHTTP");
        } catch (e){
            try {   // Internet Explorer 5.5
                xmlHttp=new ActiveXObject("Microsoft.XMLHTTP");
            } catch (e){
                alert("Your browser does not support AJAX!");
                return false;
            }
        }
    }
    return xmlHttp;
} 
```

关于命令的进一步解释可以在文章[http://www.openjs.com/articles/ajax_xmlhttp_using_post.php](http://www.openjs.com/articles/ajax_xmlhttp_using_post.php)中找到，我从这里获得了这个例子的灵感。

希望这可以帮助。

纳马斯特！

# knockout.js - 更改dependentObservable() 函数，以启用链式写入

> ID：10307514
> 
> 赞同：1
> 
> 时间：2012-04-24T23:42:46.597
> 
> 标签：knockout.js

我发现（感谢 KO 论坛）对于计算的 observables，不可能像这样链接写入： `viewModel.someComputed(20).otherComputed(100).someObservable('hi')`

这让我很沮丧，因为我有很多我想要的 observables `extend()`- 所以它们会被计算出来，所以我必须删除所有链式调用。

所以我在dependantObservable() 函数中做了这个小改动（刚刚添加：return this;）

```
function dependentObservable() {
    if (arguments.length > 0) {
        set.apply(dependentObservable, arguments);
        return this;
    } else {
        return get();             
    }
} 
```

现在我可以链写了！

我的问题是：**这样做有什么缺点？** 我假设有一个，因为这没有实现：P

谢谢， 乌里 G

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T13:35:14.383

不会有任何问题。首先，在更改之前编写的所有代码都假定计算出的 observable 不可链接，因此没有人会使用 setter 返回的值。其次，所有使用返回值的地方都在调用getter。

换句话说，所有遗留代码看起来像

```
var value = obj.property(); // note the lack of parameters
obj.property(value); // note the absence of either chaining or assignment 
```

不链接此代码：

```
obj.property(value).anything 
```

会抛出类型错误。所以唯一需要担心的是

```
someVar = obj.property(value); 
```

目前总是返回`undefined`。至于我，它看起来像是一个相当虚假的代码，因为有更好的方法可以将一些变量设置为`undefined`.

因此，如果您想要chainig，请进行此更改。

> 知道为什么没有实施吗？

因为在大多数传统语言（Java、C#、C++、PHP）中，链接通常是例外而不是规范。在 JavaScript 世界中，只有少数库像 jQuery、Underscore 和 d3 那样大量使用链接。不过，包括 Knockout 在内的大多数其他库都不依赖它。

此外，Steve Sanderson 可能只是忘记为计算的 observables 提供链式支持。给他一个建议；）

# php - 使用 SQL 选择语句

> ID：10307515
> 
> 赞同：1
> 
> 时间：2012-04-24T23:42:47.367
> 
> 标签：php, mysql, select, join

使用 join 语句时是否可以仅对一个表使用 select *？

假设这些是下表；

```
B
userID
username

A
userID
entry 
....just pretend there are more columns for the sake of this example 
```

从表 B 中查找用户名的正确方法是什么？

```
select B.username, * from A
LEFT JOIN B on B.userID = A.userID
where A.entry = "XXXXX" 
```

还是我必须列出我想要选择的所有内容，例如：

```
select B.username, A.userID, A.entry from A
left Join..... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T23:44:52.097

您可以使用 [table name].* 从其中一个表中选择所有字段。例如，要从表 B 中选择所有字段，请使用：

```
 SELECT B.*, username FROM A
 LEFT JOIN B on B.userID = A.userID
 WHERE A.entry = "XXXXX" 
```

编辑 - 从 A 中选择的列用户名

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T23:44:55.277

`SELECT A.* FROM ...``A`您要从中选择的表在哪里。

# iphone - iOS PNG图像旋转90度

> ID：10307521
> 
> 赞同：26
> 
> 时间：2012-04-24T23:44:10.303
> 
> 标签：iphone, objective-c, ios, png, exif

在我正在编写的 iOS 应用程序中，我处理 PNG，因为我处理的是 alpha 通道。出于某种原因，我可以将 PNG 加载到我的`imageView`文件中，但是当需要将图像从我的应用程序中复制出来（到粘贴板上）或将图像保存到我的相机胶卷时，图像会旋转 90 度。

我到处搜索，我学到的一件事是，如果我使用 JPEG，由于 EXIF 信息，我不会有这个问题（听起来）。

我的应用程序具有完整的复制/粘贴功能，这是最重要的（我将分步编写，以便更容易理解）：

1.  转到我的相机胶卷并复制图像
2.  进入我的应用程序并按“粘贴”，图像粘贴得很好，我可以整天这样做
3.  单击我实现的复制功能，然后单击“粘贴”，图像粘贴但旋转。

我 100% 确定我的复制和粘贴代码在这里没有问题，因为如果我回到上面的第 2 步，然后单击“保存”，照片会保存到我的库中，但它会旋转 90 度！

更奇怪的是，它似乎可以很好地处理从互联网上下载的图像，但对于我用手机手动拍摄的图像来说却很受欢迎。有的有用，有的没用……

有人对此有任何想法吗？我可以使用任何可能的解决方法？我对代码非常有信心，因为它适用于我大约 75% 的图像。我可以根据要求发布代码。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2014-10-27T00:45:22.883

对于那些想要 Swift 解决方案的人，创建 UIImage 的扩展并添加以下方法：

```
func correctlyOrientedImage() -> UIImage {
    if self.imageOrientation == .up {
        return self
    }

    UIGraphicsBeginImageContextWithOptions(size, false, scale)
    draw(in: CGRect(x: 0, y: 0, width: size.width, height: size.height))
    let normalizedImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

    return normalizedImage ?? self;
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-04-25T02:46:32.593

如果您由于现有的图像`imageOrientation`属性而遇到问题，您可以构造一个具有不同方向的其他相同图像，如下所示：

```
CGImageRef imageRef = [sourceImage CGImage];

UIImage *rotatedImage = [UIImage imageWithCGImage:imageRef scale:1.0 orientation:UIImageOrientationUp]; 
```

您可能需要尝试在替换图像上设置什么方向，可能会根据您开始使用的方向进行切换。

还要注意您的内存使用情况。摄影应用程序经常用完，这将使每张照片的存储空间增加一倍，直到您发布源图像。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-04-29T03:13:33.173

花了几天时间，但由于@Dondragmer 发布的答案，我终于弄明白了。但我想我会发布我的完整解决方案。

所以基本上我必须编写一种方法来智能地自动旋转我的图像。缺点是我必须在我的代码中到处调用这个方法，它是处理器密集型的，尤其是在移动设备上工作时，但优点是我可以拍摄图像、复制图像、粘贴图像和保存图像和它们都正确旋转。这是我最终使用的代码（该方法还没有 100% 完成，仍然需要编辑内存泄漏等等）。

我最终了解到，第一次将图像插入到我的应用程序中（无论是由于用户按下“拍摄图像”、“粘贴图像”还是“选择图像”，由于某种原因，它在没有自动的情况下插入就好了旋转。此时，我将旋转值存储在一个名为 的全局变量中`imageOrientationWhenAddedToScreen`。这让我的生活更轻松，因为当需要操作图像并将图像保存到程序之外时，我只需检查这个缓存的全局变量并确定我是否需要正确旋转图像。

```
 - (UIImage*) rotateImageAppropriately:(UIImage*) imageToRotate {
    //This method will properly rotate our image, we need to make sure that
    //We call this method everywhere pretty much...

    CGImageRef imageRef = [imageToRotate CGImage];
    UIImage* properlyRotatedImage;

    if (imageOrientationWhenAddedToScreen == 0) {
       //Don't rotate the image
        properlyRotatedImage = imageToRotate;

    } else if (imageOrientationWhenAddedToScreen == 3) {

        //We need to rotate the image back to a 3
        properlyRotatedImage = [UIImage imageWithCGImage:imageRef scale:1.0 orientation:3];

    } else if (imageOrientationWhenAddedToScreen == 1) {

        //We need to rotate the image back to a 1
        properlyRotatedImage = [UIImage imageWithCGImage:imageRef scale:1.0 orientation:1];        

    }

    return properlyRotatedImage;

} 
```

我仍然不能 100% 确定为什么 Apple 会有这种奇怪的图像旋转行为（试试这个……拿起你的手机，把它倒过来拍照，你会注意到最终的照片是正面朝上的——也许这个为什么苹果有这种功能？）。

我知道我花了很多时间来解决这个问题，所以我希望它可以帮助其他人！

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2014-02-05T19:35:13.817

这种“奇怪的旋转”行为真的一点也不奇怪。它很聪明，我所说的聪明是指内存高效。当您旋转 iOS 设备时，相机硬件会随之旋转。当您拍照时，无论相机的方向如何，该照片都会被捕获。UIImage 能够使用此原始图片数据而无需复制，只需跟踪它应该处于的方向。当您使用时，[`UIImagePNGRepresentation()`](https://developer.apple.com/library/ios/documentation/uikit/reference/UIKitFunctionReference/Reference/reference.html#//apple_ref/c/func/UIImagePNGRepresentation)您会丢失此方向数据并获得底层图像的 PNG，因为它是由相机拍摄的。要解决此问题而不是旋转，您可以告诉原始图像将自己绘制到新的上下文并`UIImage`从该上下文中获得正确的方向。

```
UIImage *image = ...;

//Have the image draw itself in the correct orientation if necessary
if(!(image.imageOrientation == UIImageOrientationUp ||
    image.imageOrientation == UIImageOrientationUpMirrored))
{
    CGSize imgsize = image.size;
    UIGraphicsBeginImageContext(imgsize);
    [image drawInRect:CGRectMake(0.0, 0.0, imgsize.width, imgsize.height)];
    image = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();
}

NSData *png = UIImagePNGRepresentation(image); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-13T10:38:32.870

这是实现这一目标的另一种方法：

```
@IBAction func rightRotateAction(sender: AnyObject) {

    let imgToRotate = CIImage(CGImage: sourceImageView.image?.CGImage)
    let transform = CGAffineTransformMakeRotation(CGFloat(M_PI_2))
    let rotatedImage = imgToRotate.imageByApplyingTransform(transform)
    let extent = rotatedImage.extent()
    let contex = CIContext(options: [kCIContextUseSoftwareRenderer: false])
    let cgImage = contex.createCGImage(rotatedImage, fromRect: extent)
    adjustedImage = UIImage(CGImage: cgImage)!
    UIView.transitionWithView(sourceImageView, duration: 0.5, options: UIViewAnimationOptions.TransitionCrossDissolve, animations: {
            self.sourceImageView.image = self.adjustedImage
        }, completion: nil)
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-05-17T10:30:12.007

您可以使用 Image I/O 根据图像`NSMutableData`的方向将 PNG 图像保存到文件（或）。在下面的示例中，我将 PNG 图像保存到`path`.

```
- (BOOL)savePngFile:(UIImage *)image toPath:(NSString *)path {
    NSData *data = UIImagePNGRepresentation(image);
    int exifOrientation = [UIImage cc_iOSOrientationToExifOrientation:image.imageOrientation];
    NSDictionary *metadata = @{(__bridge id)kCGImagePropertyOrientation:@(exifOrientation)};
    NSURL *url = [NSURL fileURLWithPath:path];
    CGImageSourceRef source = CGImageSourceCreateWithData((__bridge CFDataRef)data, NULL);
    if (!source) {
        return NO;
    }
    CFStringRef UTI = CGImageSourceGetType(source);
    CGImageDestinationRef destination = CGImageDestinationCreateWithURL((__bridge CFURLRef)url, UTI, 1, NULL);
    if (!destination) {
        CFRelease(source);
        return NO;
    }
    CGImageDestinationAddImageFromSource(destination, source, 0, (__bridge CFDictionaryRef)metadata);
    BOOL success = CGImageDestinationFinalize(destination);
    CFRelease(destination);
    CFRelease(source);
    return success;
} 
```

`cc_iOSOrientationToExifOrientation:`是一种`UIImage`分类方法。

```
+ (int)cc_iOSOrientationToExifOrientation:(UIImageOrientation)iOSOrientation {
    int exifOrientation = -1;
    switch (iOSOrientation) {
        case UIImageOrientationUp:
            exifOrientation = 1;
            break;

        case UIImageOrientationDown:
            exifOrientation = 3;
            break;

        case UIImageOrientationLeft:
            exifOrientation = 8;
            break;

        case UIImageOrientationRight:
            exifOrientation = 6;
            break;

        case UIImageOrientationUpMirrored:
            exifOrientation = 2;
            break;

        case UIImageOrientationDownMirrored:
            exifOrientation = 4;
            break;

        case UIImageOrientationLeftMirrored:
            exifOrientation = 5;
            break;

        case UIImageOrientationRightMirrored:
            exifOrientation = 7;
            break;

        default:
            exifOrientation = -1;
    }
    return exifOrientation;
} 
```

您也可以将图像保存到`NSData`using`CGImageDestinationCreateWithData`和 pass`NSMutableData`而不是`NSURL`in `CGImageDestinationCreateWithURL`。

# java - 正确设计用于代码共享和封装的 Java 类层次结构

> ID：10307523
> 
> 赞同：2
> 
> 时间：2012-04-24T23:44:26.713
> 
> 标签：java, oop, design-patterns, interface, encapsulation

在布置类层次结构时，我经常发现自己对能够封装功能和共享代码之间的差距感到沮丧。当然，部分问题是缺乏多重继承，但接口有所帮助。在我看来，无法在接口上定义受保护的方法似乎是更大的问题。

标准解决方案似乎是有一个由受保护的抽象基类实现的公共接口。问题是当我们有以下情况时

```
public interface Foo {
    public String getName();
}

abstract protected BaseFoo implements Foo {
    abstract protected int getId();

    private String name;
    protected BaseFoo(String name) {
        this.name = name;
    }

    @Override
    public String getName() {
        return this.name;
    }
}

public class ConcreteFoo extends BaseFoo {
    public ConcreteFoo (String name) {
        super(name);
    }

    @Override
    protected int getId() {
        return 4; // chosen by fair dice roll.
                  // guaranteed to be random.
    }
}

// in the foo package with the classes above
public class FooCollection {
    private static Map<Integer, Foo> foos = new HashMap();
    public static void add(Foo foo) {
        synchronized(foos) {
            foos.put(foo.getId(), foo); // can't call foo.getId()
        }
    }
}

// client code, not in the foo package
FooCollection.add(new ConcreteFoo("hello world")); 
```

也就是说，我们将一个封装良好的对象返回给调用者，但是任何获取该对象的方法都需要能够依赖一些内部功能。该内部功能不能成为接口的一部分（这会破坏封装），但要使其成为抽象基类的一部分，我们需要使用强制转换。

我们不能使 Foo 成为一个抽象类，因为其他接口需要扩展它以将可选的正交功能添加到比这里显示的更复杂的层次结构中。

解决这个问题的标准方法是什么？您是否将 getId 添加到 Foo 接口，即使客户端不应该使用它？您是否在 FooCollection.add 中对 BaseFoo 执行了不安全的强制转换？如果你在转换之前检查，当类型不匹配时你会怎么做，即使它们总是应该用于所有意图和目的？

您在这种情况下获得的有关最佳实践的任何信息都会非常有帮助。

**编辑：**如果不清楚，这个例子是故意过分简化的。关键是有时您会返回对象的“界面视图”。当那个“接口视图”被传回一个包特定的类时，它被传递给的方法可能需要在其实现中使用内部功能。如何管理内部和公共功能之间的不匹配？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-24T23:54:04.820

好的，这里有几点：

1.  与流行的观点相反，继承实际上与共享代码无关。您在继承层次结构中创建的是共享一些通用抽象行为的事物的组织；它有时会产生重用某些代码的效果。

2.  在过去的几年里，时尚已经发生了很大的变化，以至于深而复杂的继承层次结构不再被认为是好的形式。一般在Java中。你应该

    *   在实现接口之前使用聚合
    *   使用接口来表达“混入”合约
    *   仅当类描述具有自然继承的事物时才使用继承。
3.  如果你真的想要多重继承的效果，为你的接口构建实现类，然后聚合它们。

4.  特别是，通过使用接口和实现类定义您的类，您可以更轻松地构建测试；如果您的界面是独立的，那么为该界面构建一个模拟几乎是微不足道的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T23:54:42.473

我不知道“最佳”实践，但这里有几个想法。

接口应该将“要做什么”与“如何做”分开。我不认为 getter 和 setter 属于接口。我试着给他们更有意义的签名。

就您而言，我认为两个接口没有任何问题：

```
public interface Nameable {
    String getName();
}

public interface Identifiable {
    int getId();
} 
```

将两者分开；迫使客户只实施他们需要的那些。您决定成为`id`抽象类的一部分是任意的。将其分开并使其明确可能会有所帮助。

铸造失去了多态性的所有好处。我认为不应该轻易放弃。如果您必须向上移动`getId()`到界面，请执行此操作。如果你可以通过不同的选择来避免它，那就这样做吧。

“最佳”取决于您的上下文。您的简单示例可能并非在所有情况下都是正确的。

# python - 将“0”添加到二进制

> ID：10307524
> 
> 赞同：-1
> 
> 时间：2012-04-24T23:44:30.157
> 
> 标签：python, binary

如何在现有二进制类型的左侧添加多个“0”值？

我使用以下方法获取二进制类型：

```
 binary=bin(int(symbol)) 
```

`symbol`int在哪里。

有什么办法吗？

我希望结果是一个字符串。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-24T23:48:26.470

没有二进制类型，结果`bin()`是字符串。以下是如何在字符串末尾添加额外的零：

```
>>> bin(11)
'0b1011'
>>> bin(11) + '0000'
'0b10110000' 
```

因为听起来您想在左侧添加零，所以我假设您这样做是为了使生成的字符串长度相同，而不管`symbol`.

做到这一点的一个好方法是使用[`str.format()`](http://docs.python.org/library/string.html#format-string-syntax)而不是`bin()`函数，这是一个示例，结果字符串中总是有八位数字，并且`0b`前缀仍然存在，就像您使用过一样`bin()`：

```
>>> '0b{0:0>8b}'.format(3)
'0b00000011'
>>> '0b{0:0>8b}'.format(11)
'0b00001011' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T23:53:49.587

不完全确定您想要什么，在哪里添加“0”。

```
print bin(1<<8)
print bin(1).zfill(8).replace("b", "") 
```

希望有帮助。〜本

# java - 使用外部证书识别 HTTPS 连接

> ID：10307526
> 
> 赞同：1
> 
> 时间：2012-04-24T23:44:32.907
> 
> 标签：java, https, certificate, httpurlconnection, urlconnection

我想通过 HTTPS 连接到服务器。服务器使用未签名的证书。
我找到了从 sun 下载这些证书的解决方案。

那是我的代码：

```
{
    final char[] CertPassphrase = "changeit".toCharArray(); 
    private boolean installCert() throws
                             KeyStoreException, NoSuchAlgorithmException,
                             CertificateException, KeyManagementException,
                             IOException {
    boolean isCertInstalled = true;
    File file = new File("jcacerts");
    if (!file.isFile())
    {
        char SEP = File.separatorChar;
        File dir = new File(System.getProperty("java.home") + SEP + "lib" + SEP + "security");
        file = new File(dir, "jssecacerts");
        if (!file.isFile())
        {
            file = new File(dir, "cacerts");
        }
    }
    InputStream in = new FileInputStream(file);
    KeyStore ks = KeyStore.getInstance(KeyStore.getDefaultType());
    ks.load(in, CertPassphrase);
    in.close();
    SSLContext context = SSLContext.getInstance("TLS");
    TrustManagerFactory tmf =
            TrustManagerFactory.getInstance(TrustManagerFactory.getDefaultAlgorithm());
    tmf.init(ks);
    X509TrustManager defaultTrustManager = (X509TrustManager) tmf.getTrustManagers()[0];
    SavingTrustManager tm = new SavingTrustManager(defaultTrustManager);
    context.init(null, new TrustManager[]
           {
               tm
           }, null);
    SSLSocketFactory factory = context.getSocketFactory();
    SSLSocket socket = (SSLSocket) factory.createSocket(this.getStrUrl(), this.getPort() );
    socket.setSoTimeout(10000);

    try
    {
        socket.startHandshake();
        socket.close();
    } catch (SSLException e)
    {
        isCertInstalled = false;
    }
    if(!isCertInstalled){
        X509Certificate[] chain = tm.chain;
        if (chain == null)
        {
           return true;
        }
        BufferedReader reader =
           new BufferedReader(new InputStreamReader(System.in));

        System.out.println("Certificat from "+this.getStrUrl()+". [Enter] to download, [q] to quit!");
        String line = reader.readLine().trim();
        if(line.length()==0){
            for(int i=0; i<chain.length; i++){
                X509Certificate cert = chain[i];
                String alias = this.getStrUrl() + "-" + (i + 1);
                ks.setCertificateEntry(alias, cert);

                OutputStream out = new FileOutputStream("jssecacerts");
                ks.store(out, this.CertPassphrase);
                out.close();
                System.out.println("Added certificate to keystore 'jcacerts'");
            }
            return true;
        }else{
            return false;
        }
    }else
       return true;
}

private HttpsURLConnection openHttpsConnection(){
    try{
        if(this.installCert()){
            return (HttpsURLConnection)this.getUrl().openConnection();
        }
        else{
            System.out.println("Zertifikat heruntergeladen");
            return null;
        }
    }catch (KeyStoreException e){
         System.out.println(e.getMessage());
    }catch (NoSuchAlgorithmException e){
        System.out.println(e.getMessage());
    }catch (CertificateException e){
        System.out.println(e.getMessage());
    }catch (KeyManagementException e){
        System.out.println(e.getMessage());
    }catch (IOException e){
        System.out.println(e.getMessage());
    }
    return null;
}

private void closeHttpsConnection(HttpsURLConnection con){
    con.disconnect();
}

public void print_content(){
    HttpsURLConnection con = this.openHttpsConnection();
    try{
        BufferedReader br = new BufferedReader( new InputStreamReader(con.getInputStream()));
        String input;
        while ((input = br.readLine()) != null){
            System.out.println(input);
        }
        br.close();
    } catch (IOException e) {
       e.printStackTrace();
    }
}

public Https(String Url)            { this.setUrl(Url); }

private static class SavingTrustManager implements X509TrustManager
{

   private final X509TrustManager tm;
   private X509Certificate[] chain;

   SavingTrustManager(X509TrustManager tm)
   {
       this.tm = tm;
   }

   public X509Certificate[] getAcceptedIssuers()
   {
       throw new UnsupportedOperationException();
   }

   public void checkClientTrusted(X509Certificate[] chain, String authType)
           throws CertificateException
   {
       throw new UnsupportedOperationException();
   }

   public void checkServerTrusted(X509Certificate[] chain, String authType)
           throws CertificateException
   {
       this.chain = chain;
       tm.checkServerTrusted(chain, authType);
   }
} 
```

在我看来，证书已完全下载。但是，如果我尝试从 Input-Stream 中读取，则会引发以下异常：

> javax.net.ssl.SSLHandshakeException：
> java.security.cert.CertificateException：找不到名称匹配的*url*

有人知道我的问题的正确解决方案还是可以帮助我？

# html - 不可知 标签的相对路径

> ID：10307528
> 
> 赞同：1
> 
> 时间：2012-04-24T23:44:54.840
> 
> 标签：html

我是 html 的新手，所以如果问题很愚蠢，请原谅。我想指定一个相对于我的 HTML 所在位置的图像 (img src=...) 的路径。我该怎么做。默认情况下，相对路径被认为是相对于基本 URL (base href=...) 我需要它在 Windows 上的 Chrome 和 IE 上工作

在有人问之前，显然我需要将基本标签设置到其他位置，因此面临这个问题。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T23:51:24.213

遗憾的是（或者可能不是），没有办法在纯 HTML 中实现这一点。可能的解决方法包括**不使用相对路径**或**使用 JavaScript 生成绝对路径**。

# ruby-on-rails - main:Object 的未定义方法“root”

> ID：10307531
> 
> 赞同：0
> 
> 时间：2012-04-24T23:45:06.477
> 
> 标签：ruby-on-rails, ruby, linux, cpanel, phusion

我的问题是，为什么我必须看到这个错误？

> main:Object 的未定义方法“root”

当我访问我的网站并查看 Phusion 错误页面时，我得到了这个。这是长输出：

> 无法启动 Ruby on Rails 应用程序 可能的原因如下： 应用程序代码中可能存在语法错误。请检查此类错误并修复它们。可能未安装所需的库。请安装此应用程序所需的所有库。应用程序可能未正确配置。请检查所有配置文件是否正确写入，修复任何不正确的配置，然后重新启动该应用程序。应用程序依赖的服务（例如数据库服务器或 Ferret 搜索引擎服务器）可能尚未启动。请启动该服务。有关错误的更多信息可能已写入应用程序的日志文件。请检查它以便分析问题。错误消息：main:Object 异常类的未定义方法“root”：
> 
> # 文件行位置 0 /home/$user/rails_apps/$app/config/routes.rb 34
> 
> 1 /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.14/lib/action_controller/routing/route_set.rb 227 在 `draw' 2 /home/$user/rails_apps/$app/config/routes.rb 1 3 /usr/lib/ruby/gems/1.8/gems/activesupport-2.3.14/lib/active_support/dependencies.rb 173 in` load_without_new_constant_marking' 4 /usr/lib/ruby/gems/1.8/gems/activesupport-2.3 .14/lib/active_support/dependencies.rb 173 在 `load' 5 /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.14/lib/action_controller/routing/route_set.rb 287 in` load_routes！6 /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.14/lib/action_controller/routing/route_set.rb 287 in `each' 7 /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.14/lib/action_controller/routing/route_set.rb 287 in` load_routes！8 /usr/lib/ruby/gems/1.8/gems/actionpack-2.3.14/lib/action_controller/routing/route_set.rb 267 in `reload!' 9 /usr/lib/ruby/gems/1.8/gems/rails-2.3.14/lib/initializer.rb 537 in` initialize_routing' 10 /usr/lib/ruby/gems/1.8/gems/rails-2.3 .14/lib/initializer.rb 188 在 `process' 11 /usr/lib/ruby/gems/1.8/gems/rails-2.3.14/lib/initializer.rb 113 in` 发送'12 /usr/lib/ruby/gems/1.8/gems/rails-2.3.14/lib/initializer.rb 113 在 `run' 13 /home/$user/rails_apps/$app/config/environment.rb 9 14 /usr/lib/ruby/site_ruby/1.8/rubygems/custom_require.rb 36 in` gem_original_require' 15 /usr/lib/ruby/site_ruby /1.8/rubygems/custom_require.rb 36 英寸 `require' 16 /usr/lib/ruby/gems/1.8/gems/passenger-3.0.12/lib/phusion_passenger/classic_rails/application_spawner.rb 222 in` preload_application' 17 /usr/lib/ruby/gems/1.8/gems/passenger-3.0.12/lib/phusion_passenger/classic_rails/application_spawner.rb 181 in `initialize_server' 18 /usr/lib/ruby/gems/1.8/gems/passenger-3.0.12/lib/phusion_passenger/utils.rb 572 in` report_app_init_status' 19 /usr/lib/ruby/gems/1.8/gems/passenger -3.0.12/lib/phusion_passenger/classic_rails/application_spawner.rb 174 在`initialize_server' 20 /usr/lib/ruby/gems/1.8/gems/passenger-3.0.12/lib/phusion_passenger/abstract_server.rb 204 in` start_synchronously' 21 /usr/lib/ruby/gems/1.8/gems/passenger-3.0.12/lib/phusion_passenger/abstract_server.rb 180 在 `start' 22 /usr/lib/ruby/gems/1.8/gems/passenger-3.0.12/lib/phusion_passenger/classic_rails/application_spawner.rb 149 in` start' 23 /usr/lib/ruby/gems/1.8/gems/passenger-3.0.12/lib/phusion_passenger/spawn_manager.rb 219 在 `spawn_rails_application' 24 /usr/lib/ruby/gems/1.8/gems/passenger-3.0.12/lib/phusion_passenger/abstract_server_collection.rb 132 in` lookup_or_add' 25 /usr/lib/ruby/gems/1.8/gems/passenger-3.0.12/ lib/phusion_passenger/spawn_manager.rb 214 在 `spawn_rails_application' 26 /usr/lib/ruby/gems/1.8/gems/passenger-3.0.12/lib/phusion_passenger/abstract_server_collection.rb 82 in` 同步'27 /usr/lib/ruby/gems/1.8/gems/passenger-3.0.12/lib/phusion_passenger/abstract_server_collection.rb 79 `synchronize' 28 /usr/lib/ruby/gems/1.8/gems/passenger-3.0.12/lib/phusion_passenger/spawn_manager.rb 213 in` spawn_rails_application' 29 /usr/lib/ruby/gems/1.8/gems/passenger-3.0.12/lib/phusion_passenger/spawn_manager.rb 132 in `spawn_application' 30 /usr/lib/ruby/gems/1.8/gems/passenger-3.0.12/lib/phusion_passenger/spawn_manager.rb 275 in` handle_spawn_application' 31 /usr/lib/ruby/gems/1.8/gems/passenger-3.0 .12/lib/phusion_passenger/abstract_server.rb 357 在 `__send__' 32 /usr/lib/ruby/gems/1.8/gems/passenger-3.0.12/lib/phusion_passenger/abstract_server.rb 357 in` server_main_loop' 33 /usr/lib/ruby/gems/1.8/gems/passenger-3.0.12/lib/phusion_passenger/abstract_server.rb 206 在 `start_synchronously' 34 /usr/ lib/ruby/gems/1.8/gems/passenger-3.0.12/helper-scripts/passenger-spawn-server 99

这里的规格是：

宝石列表--本地导轨

*** 当地宝石 ***

导轨 (2.3.14)

ruby -v && gem -v ruby​​ 1.8.7 (2011-02-18 patchlevel 334) [x86_64-linux] 1.8.23

在我的 config/environment.rb 我指定 rails 2.3.14

另外，我正在使用 cPanel 但不使用 cPanel 帐户来查看和处理此应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T23:59:48.320

可能应用程序希望您在 config/routes.rb 中定义根路由（打开 config/routes.rb 了解详细信息）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-17T21:37:37.473

希望这在这里有所帮助……我基本上是全新安装的。我拨打了脚手架电话：

```
mirv@rorblog:~/workspace/workspace (master) $ rails g scaffold User userID:integer index  name:string email:string password:string lastLogin:datetime 
```

这显然是错误的……但是如何撤消呢？因为我后来错误地执行了“rake db:migrate”，认为我们可以用一个简单的命令来删除它。错了，但幸运的是，在比较了我的 github 之后，我注意到我的 routes.rb 文件的开头有所不同。

```
resources :users 
```

ruby scaffold destroy 命令在 routes.rb 文件中留下了一小行，这把整个事情搞砸了。如果没有在 github 上进行比较，我永远不会注意到。以下是最初的错误，以防人们像我一样盲目地搜索它......

```
`<top (required)>': undefined method `resources' for main:Object (NoMethodError)

warning: circular argument reference - now

mirv@rorblog:~/workspace/workspace (master) $ rails s -p $PORT -b $IP
    /usr/local/rvm/gems/ruby-2.2.1/gems/activesupport-4.1.0/lib/active_support/values/time_zone.rb:285: warning: circular argument reference - now
    => Booting WEBrick
    => Rails 4.1.0 application starting in development on http://0.0.0.0:8080=> Run `rails server -h` for more startup options
    => Notice: server is listening on all interfaces (0.0.0.0). Consider using 127.0.0.1 (--binding option)
    => Ctrl-C to shutdown server
    Exiting
    /home/ubuntu/workspace/config/routes.rb:2:in `<top (required)>': undefined method `resources' for main:Object (NoMethodError)
            from /usr/local/rvm/gems/ruby-2.2.1/gems/activesupport-4.1.0/lib/active_support/dependencies.rb:241:in `load'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/activesupport-4.1.0/lib/active_support/dependencies.rb:241:in `block in load'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/activesupport-4.1.0/lib/active_support/dependencies.rb:232:in `load_dependency'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/activesupport-4.1.0/lib/active_support/dependencies.rb:241:in `load'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/railties-4.1.0/lib/rails/application/routes_reloader.rb:40:in `block in load_paths'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/railties-4.1.0/lib/rails/application/routes_reloader.rb:40:in `each'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/railties-4.1.0/lib/rails/application/routes_reloader.rb:40:in `load_paths'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/railties-4.1.0/lib/rails/application/routes_reloader.rb:16:in `reload!'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/railties-4.1.0/lib/rails/application/routes_reloader.rb:26:in `block in updater'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/activesupport-4.1.0/lib/active_support/file_update_checker.rb:75:in `call'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/activesupport-4.1.0/lib/active_support/file_update_checker.rb:75:in `execute'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/railties-4.1.0/lib/rails/application/routes_reloader.rb:27:in `updater'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/railties-4.1.0/lib/rails/application/routes_reloader.rb:7:in `execute_if_updated'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/railties-4.1.0/lib/rails/application/finisher.rb:71:in `block in <module:Finisher>'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/railties-4.1.0/lib/rails/initializable.rb:30:in `instance_exec'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/railties-4.1.0/lib/rails/initializable.rb:30:in `run'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/railties-4.1.0/lib/rails/initializable.rb:55:in `block in run_initializers'
            from /usr/local/rvm/rubies/ruby-2.2.1/lib/ruby/2.2.0/tsort.rb:226:in `block in tsort_each'
            from /usr/local/rvm/rubies/ruby-2.2.1/lib/ruby/2.2.0/tsort.rb:348:in `block (2 levels) in each_strongly_connected_component'
            from /usr/local/rvm/rubies/ruby-2.2.1/lib/ruby/2.2.0/tsort.rb:429:in `each_strongly_connected_component_from'
            from /usr/local/rvm/rubies/ruby-2.2.1/lib/ruby/2.2.0/tsort.rb:347:in `block in each_strongly_connected_component'
            from /usr/local/rvm/rubies/ruby-2.2.1/lib/ruby/2.2.0/tsort.rb:345:in `each'
            from /usr/local/rvm/rubies/ruby-2.2.1/lib/ruby/2.2.0/tsort.rb:345:in `call'
            from /usr/local/rvm/rubies/ruby-2.2.1/lib/ruby/2.2.0/tsort.rb:345:in `each_strongly_connected_component'
            from /usr/local/rvm/rubies/ruby-2.2.1/lib/ruby/2.2.0/tsort.rb:224:in `tsort_each'
            from /usr/local/rvm/rubies/ruby-2.2.1/lib/ruby/2.2.0/tsort.rb:203:in `tsort_each'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/railties-4.1.0/lib/rails/initializable.rb:54:in `run_initializers'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/railties-4.1.0/lib/rails/application.rb:288:in `initialize!'
            from /home/ubuntu/workspace/config/environment.rb:5:in `<top (required)>'
            from /home/ubuntu/workspace/config.ru:3:in `require'
            from /home/ubuntu/workspace/config.ru:3:in `block in <main>'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/rack-1.5.3/lib/rack/builder.rb:55:in `instance_eval'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/rack-1.5.3/lib/rack/builder.rb:55:in `initialize'
            from /home/ubuntu/workspace/config.ru:in `new'
            from /home/ubuntu/workspace/config.ru:in `<main>'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/rack-1.5.3/lib/rack/builder.rb:49:in `eval'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/rack-1.5.3/lib/rack/builder.rb:49:in `new_from_string'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/rack-1.5.3/lib/rack/builder.rb:40:in `parse_file'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/rack-1.5.3/lib/rack/server.rb:277:in `build_app_and_options_from_config'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/rack-1.5.3/lib/rack/server.rb:199:in `app'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/railties-4.1.0/lib/rails/commands/server.rb:50:in `app'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/rack-1.5.3/lib/rack/server.rb:314:in `wrapped_app'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/railties-4.1.0/lib/rails/commands/server.rb:130:in `log_to_stdout'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/railties-4.1.0/lib/rails/commands/server.rb:67:in `start'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/railties-4.1.0/lib/rails/commands/commands_tasks.rb:81:in `block in server'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/railties-4.1.0/lib/rails/commands/commands_tasks.rb:76:in `tap'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/railties-4.1.0/lib/rails/commands/commands_tasks.rb:76:in `server'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/railties-4.1.0/lib/rails/commands/commands_tasks.rb:40:in `run_command!'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/railties-4.1.0/lib/rails/commands.rb:17:in `<top (required)>'
            from /home/ubuntu/workspace/bin/rails:8:in `require'
            from /home/ubuntu/workspace/bin/rails:8:in `<top (required)>'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/spring-1.3.6/lib/spring/client/rails.rb:28:in `load'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/spring-1.3.6/lib/spring/client/rails.rb:28:in `call'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/spring-1.3.6/lib/spring/client/command.rb:7:in `call'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/spring-1.3.6/lib/spring/client.rb:26:in `run'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/spring-1.3.6/bin/spring:48:in `<top (required)>'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/spring-1.3.6/lib/spring/binstub.rb:11:in `load'
            from /usr/local/rvm/gems/ruby-2.2.1/gems/spring-1.3.6/lib/spring/binstub.rb:11:in `<top (required)>'
            from /home/ubuntu/workspace/bin/spring:13:in `require'
            from /home/ubuntu/workspace/bin/spring:13:in `<top (required)>'
            from bin/rails:3:in `load'
            from bin/rails:3:in `<main>' 
```

# objective-c - EXC_BAD_ACCESS 从 NSValue 获取价值

> ID：10307532
> 
> 赞同：0
> 
> 时间：2012-04-24T23:45:14.367
> 
> 标签：objective-c, ios, mapkit

我正在构建一系列 MKPolygons 并将它们存储在一个 NSValues 数组中：

```
for (NSDictionary* country in countries) {
    NSMutableArray* polygons = [[NSMutableArray alloc] init];

    for (NSArray* polygon in [country objectForKey:@"polygons"]) {
        CLLocationCoordinate2D polygonCoords[polygon.count];

        int i;
        for (i = 0; i < polygon.count; i++) {
            NSValue* coords = [polygon objectAtIndex:i];
            CLLocationCoordinate2D stored_coords;
            [coords getValue:&stored_coords];
            polygonCoords[i] = stored_coords;
        }

        MKPolygon* poly = [MKPolygon polygonWithCoordinates:polygonCoords count:polygon.count];
        [polygons addObject:[NSValue valueWithBytes:&poly objCType:@encode(MKPolygon)]];
        [chillPillMap addOverlay:poly];
    }
    [country setValue:polygons forKey:@"polygon_objects"];
} 
```

但是，当我稍后尝试访问它们时，我得到了两个或三个，并且发生了 EXC_BAD_ACCESS：

```
for (NSDictionary* country in countries) {
   NSArray* polygon_objects = [country objectForKey:@"polygon_objects"];
   int i;
   for (i = 0; i < polygon_objects.count; i++) {
        MKPolygon* saved_poly = [MKPolygon alloc];
        [[polygon_objects objectAtIndex:i] getValue:&saved_poly];
   }
} 
```

不知道为什么会这样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T23:58:50.880

MKPolygon 是一个 Objective-C 对象。您可以将其放入数组中，而无需将其转换为 NSValue。此外，您告诉 NSValue 获取字节的值，但您将指针的地址传递给它。坏消息。

为什么不只是...

```
[polygons addObject:poly] 
```

然后...

```
MKPolygon *saved_poly = [polygon_objects objectAtIndex:i]; 
```

# macos - Mac 的文件和文件夹比较工具（如 Synchronize It！）

> ID：10307534
> 
> 赞同：1
> 
> 时间：2012-04-24T23:45:24.977
> 
> 标签：macos, filesystems, copy, compare

我需要一个文件比较和合并实用程序，例如 Synchronize It！仅适用于 Mac。对我来说，我似乎找不到的最重要的功能是能够保存不同的文件并保持文件夹结构。例如，我有一个 Web 应用程序的生产版本和同一个应用程序的自托管版本。当我在生产版本中进行更改时，我想为自托管版本提供补丁 - 但只提供已更改的文件。5 个不同的目录中可能有 1/2 打文件。因此，我需要能够轻松地将这些文件保存在某处，而不仅仅是合并它们。而且我不想打印差异报告、手动复制文件、创建文件结构等。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T23:49:16.427

`patch`是 的倒数`diff`。`rsync`在保持文件同步方面非常棒。

# javascript - 多个 jQuery :contains() 参数不起作用

> ID：10307535
> 
> 赞同：0
> 
> 时间：2012-04-24T23:45:32.200
> 
> 标签：javascript, jquery, html, search, filter

我正在尝试将变量值传递给 :contains() 参数，但我无法使用多个参数。

这就是我的意思：

要执行多个 :contains() 过滤器，请使用`$("li:contains('arg1'):contains('arg2')").etc();`

这意味着只有`li`s 与*两者* `arg1`都匹配并且`arg2`将匹配此搜索。

好的，所以我想做的是：

```
var styleQuery = $("td:contains("+ styleOption + "):contains("+ glassOption +")"); 
```

没运气。

```
var styleQuery = $("td:contains("+ styleOption + ")"); 
```

工作完美，但第二个变量搜索没有。

关于发生了什么的任何想法？

**编辑**

实际上，我修复了一些类型，现在通过控制台将其作为选择器返回：

```
tr:contains(Sliding Patio Doors):contains(Double Glazed LoE 180) 
```

所以 :contains() 过滤器现在正在工作，但我仍然无法让我的代码工作。不过感谢您的帮助！仍然难倒，但这个具体问题是静止的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T23:52:03.143

您可以尝试将两个调用链接在一起。

[http://jsfiddle.net/d2emb/](http://jsfiddle.net/d2emb/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T23:50:38.037

尝试添加单引号：

```
var styleQuery = $("td:contains('"+ styleOption + "'):contains('"+ glassOption +"')"); 
```

# mysql - 从 SQL 更改为 mongoid

> ID：10307540
> 
> 赞同：-1
> 
> 时间：2012-04-24T23:46:16.977
> 
> 标签：mysql, ruby-on-rails-3, mongoid

你能帮忙解决这个问题吗？

```
SELECT nb_user, count(nb_user)  as nb_account FROM (
SELECT COUNT( USER.user_id ) AS nb_user
FROM USER
GROUP BY USER.account_id
) as toto
GROUP BY nb_user 
```

我想将它翻译为在我的 rails 3.2 应用程序中与 mongoid 一起使用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T18:05:57.840

我有一个很好的结果，但我不确定这是最好的解决方案。

在我的控制器中：

```
map = {"sum" => 0}
reduce = "function(doc, prev) { 
if(prev[doc.user_user_id] == null){
prev[doc.user_user_id] = 1;
prev.sum += 1;
}
}"

data = MyLog.collection.group(:key =>'user_account_id', :initial => map, :reduce => reduce)

data_result = {}

data.each do |data|
if data_result[data['sum']].nil?
data_result[data['sum']] = 1
else
data_result[data['sum']] +=1
end
end 
```

# performance - 为什么这么慢？（在 DF 行中循环与独立向量）

> ID：10307543
> 
> 赞同：6
> 
> 时间：2012-04-24T23:47:05.127
> 
> 标签：performance, r

我有一段代码，总运行时间约为 30 秒，以下代码约为 27 秒。我将有问题的代码缩小到：

```
d$dis300[i] <- h 
```

所以我改用另一部分，现在工作得非常快（正如预期的那样）。

我的问题是为什么这对第二个来说太慢了。datos DF 约为 7500x18 vars

第一个：（经过 27 秒）

```
d$dis300 <- 0
for (i in 1:netot) {
  h <- aaa[d$ent[i], d$dis[i]]
  if (h == 0) writeLines(sprintf("ERROR. ent:%i dis:%i", d$ent[i], d$dis[i]))
  d$dis300[i] <- h
} 
```

秒：（经过 0.2 秒）

```
d$dis300 <- 0
for (i in 1:netot) {
  h <- aaa[d$ent[i], d$dis[i]]
  if (h == 0) writeLines(sprintf("ERROR. ent:%i dis:%i", d$ent[i], d$dis[i]))
  foo[i] <- h
}
d$foo <- foo 
```

您可以看到两者都是“相同的”，但有问题的有这个 DF 而不是单个向量。

任何评论都非常感谢。我来自另一种语言，这让我发疯了一段时间。至少我有解决方案，但我希望将来防止此类问题。

谢谢你的时间，

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-25T00:41:29.353

原因是`d$dis300[i] <- h`调用`$<-.data.frame`.

如您所见，这是一个相当复杂的功能：

```
`$<-.data.frame` 
```

你不说是什么`foo`，但如果是原子向量，`$<-`为了速度，函数是用C实现的。

不过，我希望你声明 foo 如下：

```
foo <- numeric(netot) 
```

这将确保您不需要为循环中的每个分配重新分配向量：

```
foo <- 0 # BAD!
system.time( for(i in 1:5e4) foo[i] <- 0 ) # 4.40 secs
foo <- numeric(5e4) # Pre-allocate
system.time( for(i in 1:5e4) foo[i] <- 0 ) # 0.09 secs 
```

使用`*apply`家庭而不用担心：

```
d$foo <- vapply(1:netot, function(i, aaa, ent, dis) {
  h <- aaa[ent[i], dis[i]]
  if (h == 0) writeLines(sprintf("ERROR. ent:%i dis:%i", ent[i], dis[i]))
  h
}, numeric(1), aaa=aaa, ent=d$ent, dis=d$dis) 
```

...在这里，我还提取`d$ent`了`d$dis`循环之外的内容，这也应该有所改善。由于您没有提供可重复的数据，因此无法自己运行它。但这里有一个类似的例子：

```
d <- data.frame(x=1)
system.time( vapply(1:1e6, function(i) d$x, numeric(1)) )         # 3.20 secs
system.time( vapply(1:1e6, function(i, x) x, numeric(1), x=d$x) ) # 0.56 secs 
```

...但最后它似乎都可以简化为（除非您的错误检测代码）：

```
d$foo <- aaa[cbind(d$ent, d$dis)] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T09:27:01.360

汤米是最好的答案。这太大了，无法发表评论，因此将其添加为答案...

这就是您自己查看副本的方式（`DF`正如 joran 评论的那样，整个副本）：

```
> DF = data.frame(a=1:3,b=4:6)
> tracemem(DF)
[1] "<0x0000000003104800"
> for (i in 1:3) {DF$b[i] <- i; .Internal(inspect(DF))}
tracemem[0000000003104800 -> 000000000396EAD8]: 
tracemem[000000000396EAD8 -> 000000000396E4F0]: $<-.data.frame $<- 
tracemem[000000000396E4F0 -> 000000000399CDC8]: $<-.data.frame $<- 
@000000000399CDC8 19 VECSXP g0c2 [OBJ,NAM(2),TR,ATT] (len=2, tl=0)
  @000000000399CD90 13 INTSXP g0c2 [] (len=3, tl=0) 1,2,3
  @000000000399CCE8 13 INTSXP g0c2 [] (len=3, tl=0) 1,5,6
ATTRIB: # .. snip ..

tracemem[000000000399CDC8 -> 000000000399CC40]: 
tracemem[000000000399CC40 -> 000000000399CAB8]: $<-.data.frame $<- 
tracemem[000000000399CAB8 -> 000000000399C9A0]: $<-.data.frame $<- 
@000000000399C9A0 19 VECSXP g0c2 [OBJ,NAM(2),TR,ATT] (len=2, tl=0)
  @000000000399C968 13 INTSXP g0c2 [] (len=3, tl=0) 1,2,3
  @000000000399C888 13 INTSXP g0c2 [] (len=3, tl=0) 1,2,6
ATTRIB: # .. snip ..

tracemem[000000000399C9A0 -> 000000000399C7E0]: 
tracemem[000000000399C7E0 -> 000000000399C700]: $<-.data.frame $<- 
tracemem[000000000399C700 -> 00000000039C78D8]: $<-.data.frame $<- 
@00000000039C78D8 19 VECSXP g0c2 [OBJ,NAM(2),TR,ATT] (len=2, tl=0)
  @00000000039C78A0 13 INTSXP g0c2 [] (len=3, tl=0) 1,2,3
  @0000000003E07890 13 INTSXP g0c2 [] (len=3, tl=0) 1,2,3
ATTRIB: # .. snip ..
> DF
  a b
1 1 1
2 2 2
3 3 3 
```

这些行中的每一`tracemem[]`行都对应于整个对象的副本。您也可以看到`a`列向量的十六进制地址每次都在变化，尽管它没有被分配修改`b`。

AFAIK，在不自己放入 C 代码的情况下，在 R 中（当前）修改 a 项而`data.frame`根本没有任何内存副本的唯一方法是`:=`操作符和`set()`函数，两者都在 package 中[`data.table`](http://datatable.r-forge.r-project.org/)。在 Stack Overflow 上有[17 个](https://stackoverflow.com/search?q=%5C%5Bdata.table%5C%5D%20reference)关于通过引用分配的问题。`:=`

但在这种情况下，Tommy 的一个班轮绝对是最好的，因为您甚至根本不需要循环。

# c# - 使用 Moq 从另一个 Mocked 类型模拟返回类型

> ID：10307550
> 
> 赞同：11
> 
> 时间：2012-04-24T23:48:23.153
> 
> 标签：c#, mocking, moq

所以我试图从另一个模拟类型返回一个模拟类型，我已经取得了一些进展，但我被困在这里（接口名称已被简化）

考虑接口 IFoo 和 IFooItem。对 IFoo 类型调用 Add，传入 IBar 返回 IFooItem

```
interface IFoo
{
   IFooItem Add(IBar bar);
}

interface IFooItem
{
   int fooItemId {get; set;}
} 
```

我还有一个 IFooRepository，我正在尝试使用 Moq 来模拟它，以便我可以模拟添加一个项目。

所以，

```
var mockFooRepository = new Mock<IFooRepository>();
mockFooRepository.Setup(m=> m.Add(It.IsAny<IBar>()))
  .Returns(
     // What is the correct way to mock properties of a new IFooItem from 
     // mocked properties of IBar
     // essentially a new mocked type of IFooItem that can read from IBar
     // so IFooItem.Property = somevalue, IFooItem.Property2 = IBar.SomeProp
     ); 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-25T00:20:41.080

像这样的东西应该工作：

```
var mockFooRepository = new Mock<IFooRepository>();
mockFooRepository.Setup(r => r.Add(It.IsAny<IBar>()))
    .Returns<IBar>(bar => 
    {
        var item = new Mock<IFooItem>();

        item.Setup(i => i.fooItemId)
            .Returns(bar.Id);

        return item.Object;
    }); 
```

这假设`IBar`看起来像这样：

```
public interface IBar 
{
    int Id { get; set; }
} 
```

# syntax - 在 OCaml 中处理多种异常类型

> ID：10307557
> 
> 赞同：6
> 
> 时间：2012-04-24T23:49:48.513
> 
> 标签：syntax, error-handling, ocaml

以下可能吗？

```
try
  (* danger zone *)
with Not_found e -> 
  (* code to handle not found *)
with t -> 
  (* code to handle all other issues *) 
```

如果我将它输入到顶层，我会在第二个`with`. 也许有一些我不知道的语法？

`try`是预先添加另一个以匹配每个的首选方法`with`吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-24T23:58:42.687

该`with`部分是一系列模式，因此您可以这样编写：

```
try
    (* dangerous code area *)
with
    | Not_found -> (* Not found handling code *)
    | t -> (* Handle other issues here *) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-24T23:57:56.080

`with`是一个`match`表达式；您不会对多个模式重复它，而是使用`|`分隔每个*模式* `->` *表达式*，就像使用`match`.

# iphone - UITableView 自定义标题（如 FoodSpotting 应用）

> ID：10307558
> 
> 赞同：8
> 
> 时间：2012-04-24T23:49:49.650
> 
> 标签：iphone, objective-c, ios, uitableview

![在此处输入图像描述](../Images/12a02ffd66f89d19ca1dfda293673ac3.png)

有人可以解释这个应用程序（FoodSpotting）如何创建他们的自定义部分标题吗？它有一个半透明的黑色背景、用户图像和一些漂亮的文本（毫无疑问是从服务器加载的）。我的两个大问题是：

**1\. 应用程序如何在部分标题上获得漂亮的黑色半透明？** **2\. 他们如何将那个小三角箭头附在标题上？**

基于使用节标题的自定义视图，我几乎可以弄清楚其他所有内容。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-04-24T23:58:15.170

[Section header 是一个 UIView](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UITableViewDelegate_Protocol/Reference/Reference.html#//apple_ref/occ/intf/UITableViewDelegate)，就像任何其他的一样。您可以根据需要使用 Interface Builder 将其创建得漂亮、复杂或精致，等等。您的表委托`tableView:viewForheaderInSection`负责返回它，就像其他单元格行一样。

至于小三角形：是的，这让我们有点失望（我们想要在我们的应用程序中使用类似的东西），直到我们发现您可以通过“说谎”它的高度来将视图与行重叠：即`tableView:heightForHeaderInSection:`返回的值略小于它实际上是。可能不是“正确”的方式，但对我们来说效果很好。像这样：

![在此处输入图像描述](../Images/64590a86ca880247778a1bdc47fcf1ae.png)

所以标题实际上是一个完美的矩形，底部大部分是透明的，有一个小三角形“偷看”出来：

![在此处输入图像描述](../Images/d39208406e00b04895c5271c95051b5b.png)

告诉 iOS 标题是 80px 高，像这样：

```
- (CGFloat) tableView:(UITableView *) tableView 
  heightForHeaderInSection:(NSInteger) section {
    return 80;
  } 
```

它将开始在 80px 处绘制“食物”行。因为标题在顶部，并且由于标题底部的大部分是透明的，除了箭头，你应该得到这个效果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-04T13:16:28.050

我以不同的方式达到了预期的结果。我没有使用`tableView:viewForheaderInSection:`（这对我不起作用），而是添加了一个图像视图，该视图将箭头图像作为标题视图的子视图，并将框架设置在标题下方：

```
// Inside HeaderView.m

UIImageView *arrowImageView = [[UIImageView alloc] initWithImage:self.arrowImage];
arrowImageView.frame = CGRectMake(arrowX, frame.size.height, self.arrowImage.size.width, self.arrowImage.size.height);
[self addSubview:arrowImageView];
[arrowImageView release]; 
```

如果您仔细观察，Foodspotting.app 中有两个文件（following-captionbubble-dark.png 和 following-captionbubble-dark@2x.png），它们看起来与上面问题中显示的箭头完全相同。所以我猜他们可能使用了类似的技术。感谢 Foodspotting 团队。

# ruby-on-rails - 控制某个命名空间中任务的执行顺序

> ID：10307559
> 
> 赞同：1
> 
> 时间：2012-04-24T23:50:05.223
> 
> 标签：ruby-on-rails, capistrano

我是 Capistrano 的新手，我想知道如何控制特定名称空间中任务的执行顺序。

例如，我的部署命名空间中有一些额外的任务。我希望 deploy:bundle 和 deploy:assets 在 deploy:restart 之前运行，所以我添加了这些行

```
after 'deploy:update_code', 'deploy:bundle'
after 'deploy:bundle', 'deploy:assets'
after 'deploy:assets', 'deploy:restart' 
```

我不确定你是否应该这样做。如果你们对我有什么建议，请告诉我！

```
namespace :deploy do
  task :start do ; end
  task :stop do ; end
  task :restart, :roles => :app, :except => { :no_release => true }
do
    run "touch #{current_path}/tmp/restart.txt"
  end

 task :bundle do
   run "cd #{current_path} && bundle install"
 end

 task :assets do
    run "cd #{current_path} && bundle exec rake assets:precompile"
 end

 end

after 'deploy:update_code', 'deploy:bundle'
after 'deploy:bundle', 'deploy:assets'
after 'deploy:assets', 'deploy:restart' 
```

# objective-c - UIkeyboardtype数字键盘IPAD

> ID：10307561
> 
> 赞同：4
> 
> 时间：2012-04-24T23:50:30.977
> 
> 标签：objective-c, ipad, uikeyboardtype

我正在寻找 UIkeyboardtypenumberpad 但在 iPad 示例中使用。

我的意思是，可以创建一个模拟数字键盘的类或视图，比如 iPhone？

我正在使用 4.1 sdk 版本。

我不想使用特殊字符，只是数字和点。

谢谢！！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-29T07:24:02.300

添加`UITextFieldDelegate`头文件（.h 文件）

```
txtfield_name.keyboardType=UIKeyboardTypeNumbersAndPunctuation;
txtfield_name.delegate=self; 
```

然后添加这个方法

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string{

  NSString *validRegEx =@"^[0-9.]*$"; //change this regular expression as your requirement       
  NSPredicate *regExPredicate =[NSPredicate predicateWithFormat:@"SELF MATCHES %@", validRegEx];
  BOOL myStringMatchesRegEx = [regExPredicate evaluateWithObject:string];   
  if (myStringMatchesRegEx)     
    return YES; 
  else
    return NO;
} 
```

# javascript - JavaScript 平滑滚动在 iPhone 上不起作用

> ID：10307564
> 
> 赞同：1
> 
> 时间：2012-04-24T23:50:38.323
> 
> 标签：javascript, iphone, mobile, scroll, smoothing

出于某种原因，这不适用于 iPhone 和其他一些移动设备。当您单击链接时，此代码使其位于..

```
<a href="#about">About Section</a> 
```

..它将平滑滚动到“about”的id。我该如何解决这个问题？

我目前在[http://www.xblakej.com/上使用它](http://www.xblakej.com/)

```
$(document).ready(function() {
  function filterPath(string) {
  return string
    .replace(/^\//,'')
    .replace(/(index|default).[a-zA-Z]{3,4}$/,'')
    .replace(/\/$/,'');
  }
  var locationPath = filterPath(location.pathname);
  var scrollElem = scrollableElement('html', 'body');
  $('a[href*=#]').each(function() {
   var thisPath = filterPath(this.pathname) || locationPath;
    if (  locationPath == thisPath
    && (location.hostname == this.hostname || !this.hostname)
    && this.hash.replace(/#/,'') ) {
    var $target = $(this.hash), target = this.hash;
      if (target) {
        var targetOffset = $target.offset().top;
        $(this).click(function(event) {
          event.preventDefault();
          $(scrollElem).animate({scrollTop: targetOffset}, 400, function() {
            location.hash = target;
          });
        });
      }
    }
  });
  function scrollableElement(els) {
    for (var i = 0, argLength = arguments.length; i <argLength; i++) {
      var el = arguments[i],
          $scrollElement = $(el);
      if ($scrollElement.scrollTop()> 0) {
        return el;
      } else {
        $scrollElement.scrollTop(1);
        var isScrollable = $scrollElement.scrollTop()> 0;
        $scrollElement.scrollTop(0);
        if (isScrollable) {
          return el;
        }
      }
    }
    return [];
  }
}); 
```

# theory - 上下文自由泵引理

> ID：10307567
> 
> 赞同：0
> 
> 时间：2012-04-24T23:51:01.423
> 
> 标签：theory, context-free-grammar, language-theory, pumping-lemma

以下语言上下文是免费的吗？

```
L = {a^i b^k c^r d^s | i+s = k+r, i,k,r,s >= 0} 
```

我试图想出一个上下文无关的语法来生成它，但我做不到，所以我假设它不是上下文无关的。至于我的反证法：

假设 L 是上下文无关的，

令 p 是由泵引理给出的常数，

选择字符串 S = a^pb^pc^pd^p 其中 S = uvwxy

作为 |vwx| <= p，那么 vwx 最多可以包含两个不同的符号：

情况 a) vwx 仅包含单一类型的符号，因此 uv^2wx^2y 将导致 i+s != k+r

案例 b) vwx 包含两种类型的符号：

i) vwx 由 b 和 c 组成，因此 uv^2wx^2y 将导致 i+s != k+r

现在我的问题是，如果 vwx 由 a's 和 b's，或 c's 和 d's 组成，那么泵送它们不会破坏语言，因为 i 和 k 或 s 和 r 可能会一致增加，导致 i+s == k +r。

我做错了什么还是这是一种上下文无关的语言？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T05:04:30.827

我也无法想出一个 CFG 来在我的脑海中生成那种特定的语言，但我们知道，如果某个下推自动机识别出一种语言，那么它就是上下文无关的。

设计这样的PDA 不会太难。一些帮助您入门的想法：我们知道 i+s=k+r。等效地，ik-r+s = 0（我按那个顺序写它，因为这是它们出现的顺序）。问题的关键是决定如果 (k+r)>i 时如何处理堆栈。

如果您不熟悉 PDA 或无法使用它们来回答问题，至少您现在知道它是无上下文的。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-22T05:59:15.300

这是一个接受这种语言的语法：

```
A -> aAd
A -> B
A -> C
B -> aBc
B -> D
C -> bCd
C -> D
D -> bDc
D -> ε 
```

# java - ice:outputMedia 不会在 Firefox 和 IExplorer 中重新呈现

> ID：10307571
> 
> 赞同：0
> 
> 时间：2012-04-24T23:51:40.843
> 
> 标签：java, jsf-2, icefaces-3

我需要从 URL 复制 MP3。所以，在我的页面中使用这个：

```
<ice:outputMedia binding="#{boardBean.opMedia}" id="opMedia"/>
<ice:commandButton image="#{icon.imagen}" action="#{boardBean.selectIcon(icon)}">
    <f:ajax render="opMedia"/>
</ice:commandButton> 
```

然后，在支持 bean “BoardBean”（是@Viewscoped）中

```
this.opMedia.setSource(uri.toString()); 
```

此想法是选择图标时，形成具有声音的URL，并被设置为OutputMedia的源。

在谷歌浏览器中运行良好。每次单击`ice:outputMedia`都会重新渲染组件，以便复制 mp3。但在 Firefox 和 IExplorer 中没有。我没有用新属性重新渲染组件，所以没有播放 Mp3

任何想法为什么？是否有一种适用于所有浏览器的“更标准”的方式来执行此操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T20:51:45.160

我发现了问题。该`uri.toString()`方法返回一个具有特殊字符“&”的字符串。此字符由 替换`&amp;`。Chrome 能够将其解码为正确的字符并检索 URL，但 IE 和 Firefox 不能。

现在，问题将是找到这个编码/解码问题的解决方案。但这将在另一个线程中。

# erlang - 运行 rebar eunit 时将运行时参数传递给 erlang

> ID：10307575
> 
> 赞同：3
> 
> 时间：2012-04-24T23:52:03.270
> 
> 标签：erlang, rebar, eunit

在我的启动脚本中，我开始使用 erlang：

```
erl -args_file vm.args 
```

目前，在尝试运行单元测试时`rebar eunit`，我有没有办法将自定义运行时参数（例如 -args_file 选项）传递给 rebar 启动的 erlang 进程？我搜索了高低的文档无济于事......

我很感激帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-03T18:55:01.563

我回答了我自己的问题。我使用 ERL_FLAGS 变量来传递命令行参数。这是我的 Makefile 中的一个片段：

```
ERL_FLAGS="-args_file test/conf/vm.eunit.args" ./rebar skip_deps=true eunit 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T12:31:12.200

第一种方法满足您的限制：1.在您的eunit测试功能中，使用erlang`"os:cmd("erl -name bar -detached arguments")."`启动另一个erlang节点。在参数中，您可以插入任何您想要的内容。但是eunit的检查会很困难，因为测试会跨越节点。

第二种方法是改变你的限制： 1.使用“配置文件”传递参数，而不是使用命令参数传递参数。

# android - 如何让我的 android 平板电脑应用程序在横向 mdoe 的手机上运行时看起来一样

> ID：10307576
> 
> 赞同：1
> 
> 时间：2012-04-24T23:52:38.207
> 
> 标签：android

我有一个适用于平板电脑的 android 应用程序布局。它的布局是基于“横向”的（即，当我在平板电脑上运行时，它看起来是我想要的方式（默认为横向）。

但是当我在手机上运行同一个应用程序时，android 以纵向模式运行（它将我的“横向”布局压缩成纵向）。

我尝试将 'android:screenOrientation='landscape' 放入我的清单文件中的活动中。但这并不能解决问题。

基本上，我想要的是当我将手机旋转 90%（宽度大于高度）时，我希望手机布局看起来与我在平板电脑上看到的相同（默认为横向）。

我怎样才能做到这一点？android:screenOrientation='landscape' 不起作用。

基本上，我想要一些游戏“AngryBird”的东西，它总是以横向模式运行，无论是手机还是平板电脑以及手机是否旋转。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T22:06:36.770

`onCreate`在调用之前在方法中添加这一行`setContentView`：

```
setRequestedOrientation( ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T00:02:21.523

我自己没有这样做，但是不要将 main.xml 布局放在 res/layout 中，而是尝试将其放在 res/layout-land 中，这样它将以横向模式和 res/layout-port 显示此布局，也许main.xml 的肖像替代品？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T22:16:39.243

我认为您需要使用 2 个标志，而不仅仅是一个。

首先是

```
android:screenOrientation='landscape' 
```

其次是

```
android:configChanges="orientation" 
```

首先将告诉 android 在横向模式下运行活动，而第二个将告诉 android 即使用户旋转手机也不会改变方向。基本上使用第二个标志，您将覆盖方向配置更改。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-25T00:03:42.787

创建文件夹`\res\layout-land\`并将您的 XML 文件放置在横向布局中。手机自动在纵向和横向布局之间进行选择。

# ruby-on-rails - Rails - jquery 插件在开发中加载但无法在生产中加载

> ID：10307578
> 
> 赞同：0
> 
> 时间：2012-04-24T23:52:54.050
> 
> 标签：ruby-on-rails, asset-pipeline, assets, production

我有以下观点：

```
<%= javascript_include_tag 'scrollable/jquery.tools.min.js' %>
<%= stylesheet_link_tag 'scrollable/scrollable-buttons' %>
<%= stylesheet_link_tag 'scrollable/scrollable-horizontal' %> 
```

因为我有这个插件位于`/vendor/assets/javascripts/scrollable/`和`/vendor/assets/stylesheets/scrollable/`

我在开发中没有任何问题，但是当试图以生产模式进入该页面时，JS 没有加载。我收到此错误：

```
NetworkError: 404 Not Found - https://mysite/assets/scrollable/jquery.tools.min-707bfab8972e8e363a009148db789121.js" 
```

请问有什么想法吗？

请注意，如果我去：`https://mysite/assets/scrollable/jquery.tools.min.js`- 我可以看到代码。所以我猜md5指纹有问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T02:27:39.050

听起来他们没有被预编译？您可以通过检查它们是否在生产中的 public/assets/manifest.yml 中列出来判断。

如果是这种情况，并且您想通过资产管道访问它们

*   您是否在生产中运行了 rake assets:precompile？
*   您是否将文件添加到 config.assets.precompile 数组（在 config/environments/production.rb 中）？例如，'scrollable/jquery.tools.min.js'，css 文件同上。

如果您不想使用资产管道，请使用您自己的包含标签而不是 javascript_include_tag/stylesheet_link_tags，即`<script src="/scrollable/jquery.tools.min.js" type="text/javascript"></script>`用于 js

# ruby-on-rails - 如何从视图中调用控制器的方法？

> ID：10307581
> 
> 赞同：1
> 
> 时间：2012-04-24T23:53:02.503
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1

我正在用 Ruby-On-Rails 开发一个小型应用程序。我想从视图中调用控制器的方法。此方法只会在数据库表中执行一些插入操作。这样做的正确方法是什么？我已经尝试过这样的事情，但显然方法代码没有执行：

```
<%= link_to 'Join', method: join_event %> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-25T00:01:55.903

link_to 方法调用中的方法选项实际上是 HTTP 方法，而不是操作的名称。它在传递 HTTP 删除选项时很有用，因为 RESTful 路由使用 DELETE 方法来执行销毁操作。

您需要在这里做的是为您的操作设置路线。假设它被称为`join_event`，将以下内容添加到您的 routes.rb 中：

```
match '/join_event' => 'controllername#join_event', :as => 'join_event' 
```

请务必将控制器名称更改为您正在使用的控制器的名称。然后按如下方式更新您的视图：

```
<%= link_to 'Join', join_event_path %> 
```

_path 方法是根据路由文件中的 as 值生成的。

要组织代码，您可能希望将插入封装到静态模型方法中。因此，如果您有一个名为`MyModel`name 列的模型，您可以这样做

```
class MyModel
  # ...
  def self.insert_examples
    MyModel.create(:name => "test")
    MyModel.create(:name => "test2")
    MyModel.create(:name => "test3")
  end
end 
```

然后只需通过以下方式在您的操作中执行它：

```
MyModel.insert_examples 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-25T00:48:55.607

除了 agmcleod 的回答之外，您还可以使用以下命令向视图公开控制器方法[`ActionController::Base::helper_method`](http://api.rubyonrails.org/classes/AbstractController/Helpers/ClassMethods.html#method-i-helper_method)：

```
class EventsController < ApplicationController
  helper_method :join_event

  def join_event(event)
    # ...
  end
end 
```

但在这种情况下，我认为您最好听从他的建议并将此方法移至模型层，因为它正在与数据库交互。

# ruby-on-rails - embeds_many 是否需要依赖 => :destroy？

> ID：10307584
> 
> 赞同：1
> 
> 时间：2012-04-24T23:53:13.793
> 
> 标签：ruby-on-rails, ruby-on-rails-3, mongodb, mongoid

如果有：`embeds_many :foos`。

是`:dependent => :destroy`必需的吗？或者，如果我销毁父元素。所有相应的`foos`将被自动删除？

我试图检查`Foo`控制台，但得到：

```
Mongoid::Errors::InvalidCollection: Access to the collection for Foo is not allowed since it is an embedded document, please access a collection from the root document. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T12:15:29.410

无法直接访问嵌入式文档。它们包含在父文档中，只能通过父文档访问。当您销毁父文档时，嵌入式文档会随之删除，但如果您有任何特定于销毁嵌入式文档的回调，您应该查看[cascade_callbaks](https://github.com/mongoid/mongoid/pull/845)。

# jquery - rails，让引导程序的 typeahead 与 rails 和 jquery 一起工作（正常工作）

> ID：10307587
> 
> 赞同：4
> 
> 时间：2012-04-24T23:53:43.363
> 
> 标签：jquery, ruby-on-rails, twitter-bootstrap, typeahead

我想知道是否有人可以帮助我使用 rails 和 jquery 自动完成引导“typeahead”

在我的“新”动作模板中，我有...

```
 <div class="tags">
            <%= f.label :tag_names, "Tags" %>
            <%= f.text_field :tag_names,
                data: { autocomplete_source: tags_path} %>
        </div> 
```

然后转到我的标签控制器的索引操作

```
 def index
       @tags = Tag.order(:name).where("name like ?", "%#{params[:term]}%")
       render json: @tags.map{ |tag| {:label => "#{tag.name} x #{tag.count}", :value => tag.name} }
    end 
```

下面是我的 jquery ui 自动完成代码，虽然我认为它在这里不是很有必要......但在这里它是 incase

```
 $(function() {
  var extractLast, split;
  split = function(val) {
    return val.split(/,\s*/);
  };
  extractLast = function(term) {
    return split(term).pop();
  };
  return $("#lesson_tag_names").bind("keydown", function(event) {
    if (event.keyCode === $.ui.keyCode.TAB && $(this).data("autocomplete").menu.active) {
      return event.preventDefault();
    }
  }).autocomplete({
    source: function(request, response) {
      return $.getJSON($("#lesson_tag_names").data("autocomplete-source"), {
        term: extractLast(request.term)
      }, response);
    },
    search: function() {
      var term;
      term = extractLast(this.value);
      if (term.length < 1) {
        return false;
      }
    },
    focus: function() {
      return false;
    },
    select: function(event, ui) {
      var terms;
      terms = split(this.value);
      terms.pop();
      terms.push(ui.item.value);
      terms.push("");
      this.value = terms.join(", ");
      return false;
    }
  });
}); 
```

自动完成工作，但我似乎无法让它与 twitters bootstrap 一起工作。我试着提供

```
data: { autocomplete_source: tags_path, provide: "typeahead"} %> 
```

和

```
$('.typeahead').typeahead() 
```

进入我的 application.js 文件。但它似乎不起作用。我还尝试给我的表单一个 id 属性...

```
 <%= f.text_field :tag_names, id: "autocomplete",
                data: { autocomplete_source: tags_path} %> 
```

所以我可以做类似的事情

```
 $('#autocomplete').typeahead() 
```

但是，通过给我的表单一个 :id 属性，我的自动完成功能停止工作。所以...我不太确定出了什么问题。还有其他方法吗？

帮助将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T09:07:00.183

我遇到了类似的问题，最终设计了 jQuery UI 自动完成的样式，就像 bootstrap typeahead 一样（基本上将 bootstrap CSS 应用于 jQuery UI 元素）。

我是怎么做到的： [http ://criticalthinking.tumblr.com/post/17940560421/making-jquery-ui-look-like-bootstrap](http://criticalthinking.tumblr.com/post/17940560421/making-jquery-ui-look-like-bootstrap)

# asp.net - ASP.NET 4 URL Routing Web Forms 破坏了我到样式、脚本、图像等的相对路径

> ID：10307590
> 
> 赞同：4
> 
> 时间：2012-04-24T23:54:05.267
> 
> 标签：asp.net, asp.net-mvc, url-routing, asp.net-mvc-routing, webforms

我在 default.aspx 中有一个带有类似链接的应用程序...

```
<link href="Styles/smoothness/jquery-ui-1.8.14.custom.css" rel="stylesheet" type="text/css" />
<script src="Scripts/json2.min.js" type="text/javascript"></script>
<script src="Scripts/jquery-1.6.2.min.js" type="text/javascript"></script>
<script src="Scripts/jquery-ui-1.8.14.custom.min.js" type="text/javascript"></script>
<script src="Scripts/jquery.tmpl.min.js" type="text/javascript"></script> 
```

一旦我添加了 URL Routing，它就破坏了我的相对路径。因此，如果我深入到一条路线，那么页面就找不到图像、脚本等。我想我的 jQuery 服务调用也可能被破坏了。除了在每个相对引用的开头添加“/”之外，还有其他方法可以解决此问题。在我的 global.asax 中，我目前有...

```
void RegisterRoutes(RouteCollection routes)
{

    routes.MapPageRoute(
        "EntityRoute", 
        "{entityID}", 
        "~/Default.aspx");        

    routes.MapPageRoute(
        "GlobalSearchRoute",
        "{entityID}/{guarantorID}/{guarDOB}",
        "~/Default.aspx");
} 
```

我可以在此处添加一些内容以允许我的相对路径运行而不更改站点中的所有这些路径吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-24T16:48:10.013

您可以简单地使用 html 基本标记。

在 aspx 中：

```
<base id="baseControl" runat="server" /> 
```

在后面的代码中：

```
protected void Page_Init(object sender, EventArgs e)
{
    baseControl.Attributes.Add("href", Request.Url.GetLeftPart(UriPartial.Authority) + VirtualPathUtility.ToAbsolute("~/"));
} 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T23:56:44.493

您可以在 global.asax 中使用**Routes.IgnoreRoute**来排除那些引用您的静态内容的路由：

```
routes.IgnoreRoute("Styles/{*pathInfo}");
routes.IgnoreRoute("Scripts/{*pathInfo}");
routes.IgnoreRoute("Images/{*pathInfo}"); 
```

等等

# android - 无法创建要发送的内容

> ID：10307591
> 
> 赞同：1
> 
> 时间：2012-04-24T23:54:28.377
> 
> 标签：android, image, bluetooth

我正在尝试通过蓝牙发送图像，但一直收到错误消息，提示无法创建要发送的内容

代码如下：

```
public void onClick(View v) {
    Intent i = new Intent(Intent.ACTION_SEND);
    i.setType("image/jpeg");     
    i.putExtra(Intent.EXTRA_STREAM, Uri.parse("/sdcard/test.jpeg"));  
    startActivity(Intent.createChooser(i, "Send Image")); // TODO Auto-generated method stub
} 
```

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T00:03:52.830

我认为图像的路径不正确，试试这个：

```
i.putExtra(Intent.EXTRA_STREAM, Uri.parse(Environment.getExternalStorageDirectory() + "/test.jpeg")); 
```

这里还有一个关于如何通过蓝牙发送文件的示例：

[使用蓝牙 OBEX 对象推送配置文件 (OPP) 发送文件](https://stackoverflow.com/questions/5577481/sending-a-file-using-bluetooth-obex-object-push-profile-opp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T00:28:41.790

如果你想使用一个文件作为 uri 你需要添加`file://`

```
Uri.parse("file:///sdcard/test.jpeg") 
```

或者

```
Uri.fromFile(new File("/sdcard/test.jpg")); 
```

# sql-server - 使用 SQL Server Native Client 访问 SQL Server LocalDB

> ID：10307595
> 
> 赞同：0
> 
> 时间：2012-04-24T23:54:43.573
> 
> 标签：sql-server, odbc, sql-server-native-client, localdb

我正在尝试使用 SQL Server Native Client 驱动程序连接到 SQL Server LocalDB 实例。这是因为我们希望在生产环境中使用 Native Client 来访问在 SQL Server 的 SSL 加密上使用主题备用名称。到目前为止，我运气不佳-这是受支持的情况吗？我的连接字符串是：

```
<add name="Database" connectionString="Driver={SQL Server Native Client};Server=(localdb)\v11.0;Integrated Security=True;AttachDBFileName=|DataDirectory|Database.mdf;" providerName="System.Data.Odbc" /> 
```

我收到的错误是：

```
ERROR [IM002] [Microsoft][ODBC Driver Manager] Data source name not found and no default driver specified 
```

关于如何连接的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T00:13:06.793

除了使用 11.0 提供程序之外，

*   您是否创建了 SqlLocalDb 的实例？
*   您是否启动了实例？
*   如果您不是所有者，您是否尝试过`(localdb)\.\InstanceName`？

我最近在以下 Wiki 页面上更新了一堆内容：

[http://social.technet.microsoft.com/wiki/contents/articles/4609.troubleshoot-sql-server-2012-express-localdb.aspx](http://social.technet.microsoft.com/wiki/contents/articles/4609.troubleshoot-sql-server-2012-express-localdb.aspx)

此外，您的连接字符串同时说明本机客户端和 ODBC，这是故意的吗？您是否故意使用 AttachDbFilename ？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T00:05:31.410

您需要使用支持 LocalDB 的 Native Client 版本。您使用的是版本 9。尝试：

```
Driver={SQL Server Native Client 11.0} 
```

微软[很久以前就提出了](http://blogs.msdn.com/b/sqlexpress/archive/2011/07/12/introducing-localdb-a-better-sql-express.aspx)这一点：

> 请注意，由于激活逻辑存在于客户端提供程序中，因此您需要安装最新的 SQL Server Native Client“Denali”（用于 ODBC 和 OLE DB）或下一个 .NET Framework（用于 ADO.NET）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-02T16:08:41.627

跟随我经过 3 天的努力研究和尝试后如何解决这个问题，并祝愿节日快乐，新年快乐：

1.  在左侧脚手架的 SQL Server 配置管理器 (SQLServerManager11.msc) 上：右键单击 MS SQL Server Native Client（在我的情况下为 11.0）的“客户端协议”并在右侧列表中，右键单击 TCP/IP 以禁用它，只允许启用“内存共享”（如排名 #1）和“命名管道'（作为排名顺序＃2）；湾。退出MSSQL SNC脚手架，右键单击“别名”并在右侧列表中将其完全排除为空白；C。您可以为脚手架的 MS SQL SNC（32 位）选项重复“a”和“b”

原因：作为 SQL Server LocalDb 同一台机器上的单个本地客户端，不需要通过 TCP/IP 端口连接，是内存共享或命名管道更有效的选项

2.  在 SQL 客户端管理器 (cliconfg.exe) 上选择“常规”选项卡后，将“按顺序启用协议”列表保持在无人看管的右侧，完全空白并标记“启用内存共享协议”语句；然后选择“别名”选项卡，使“服务器别名配置”列表也完全空白

原因：同'1'，现在配置客户端

3.  现在小菜一碟：通过连接到您的 localdb\instance - 通常是 (localdb)\v11.0 - 启动 MS SQL SNC - 当 SQL Server Management Studio (SSms.exe) 需要时启动并附加到所需的数据库或通过 Visual Studio 制作此附件 b。启动 ODBC 管理器 (odbcad32.exe)，选择“用户数据源”选项卡，单击“添加”，在弹出窗口中输入数据库名称（通用，稍后提及）、数据库描述 (id.)、“localdb\instance”服务器名称，单击“下一步”，再次单击“下一步”，现在标记“将标准数据库更改为”并在列表中选择连接并附加在“a”上的所需数据库，单击“下一步”，单击“结束”；然后在新的弹出窗口中单击“测试数据源”以查看它是否成功；完成了

# python - 泡菜python类实例

> ID：10307596
> 
> 赞同：4
> 
> 时间：2012-04-24T23:54:46.263
> 
> 标签：python, pickle

我有一个简单的类来存储与这样的电路板关联的数据：

```
class boardClass():

    def __init__(self,boardName):
        self.__name=boardName
        self.__boardMappings= {boardName:{
                                  'FastMode':
                                  {'CPU_A':{'mipi':[], 'gpen':[]},
                                   'CPU_B':{'mipi':[], 'gpen':[]}

                                  'SlowMode':
                                  {'CPU_A':{'mipi':[], 'gpen':[]},
                                   'CPU_B':{'mipi':[], 'gpen':[]}                                   
                                  }
                                 }                       
                               }

    def setMode(self, board, mode, cpu,mipi,gpen):
        self.__boardMappings[board][mode][cpu]['mipi']=mipi
        self.__boardMappings[board][mode][cpu]['gpen']=gpen

    def getName(self):
        return self.__name 
```

我在另一个类中使用 pickle 将`boardClass`数据存储在文件中，然后读取它们：

```
def onSave(self,boardName):
        board=boardClass.boardClass(boardName)
        name=boardName+".brd"
        file=open(name,"wb")            
        pickle.dump(board,file)                        
        loadedBoard= pickle.load( open( file, "rb" ))            
        print "Loaded board name is : ",loadedBoard.getName() 
```

当我调用`onSave()`方法来腌制 boardClass 时，它会给出几个以这个结尾的错误：

```
File "C:\Python27\lib\copy_reg.py", line 70, in _reduce_ex
raise TypeError, "can't pickle %s objects" % base.__name__
TypeError: can't pickle PySwigObject objects 
```

这个 boardClass 是一个非常简单的容器。为什么不能腌制？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T03:05:46.110

不是从“无”继承，而是从“对象”继承——这样你的类将不再是“类实例”——它将是新式类的适当实例，因此是“可挑选的”

换句话说，只需尝试更改此行：

```
class boardClass(): 
```

对此：

```
class boardClass(object): 
```

**更新**：这个答案来自 Python 2 时代 - 并且需要从对象显式继承。在 Python 3 中不再是这种情况：继承`object`自是自动的，如果 pickle 失败是由于其他原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-22T14:41:15.093

你不能 pickle `PySwigObjects`，但是这里有一个解决方法：[Pickling objects](https://stackoverflow.com/questions/3862331/pickling-objects)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-10T03:41:07.657

如果您真的想保留您的对象，使其在参数中不采用“对象”，您可以使用类似`dill`或`cloudpickle`可以序列化旧式和新式类实例的序列化程序（对于 python 2.x 和 3.x 都适用）。 x 语法）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-03-12T16:35:51.630

这是一个老问题，名字很笼统，所以如果你现在看到它，你可能想设置`__getstate__`你`__setstate__`的类，这样泡菜就会知道如何转储和加载你定义的类。

请参阅此处的[示例](https://stackoverflow.com/questions/1939058/simple-example-of-use-of-setstate-and-getstate)。

如果您的类很简单（例如，只有整数和字符串作为成员和任何方法），它应该可以自动选择。

# ruby-on-rails-3 - 如何忽略注册页面上的标题

> ID：10307597
> 
> 赞同：0
> 
> 时间：2012-04-24T23:54:56.773
> 
> 标签：ruby-on-rails-3

我创建了一个标题布局，它出现在我网站的每个页面上。我希望它在注册页面上消失（有多个徽标看起来很糟糕）。

这是我的注册页面的内容*/app/views/users/new.html.erb/*

```
<%= provide(:title, 'Sign up') %>
<h1>Sign up</h1>

<div class="row">
  <div class="span6 offset3">
    <%= form_for(@user) do |f| %>

      <%= f.label :name %>
      <%= f.text_field :name %>

      <%= f.label :email %>
      <%= f.text_field :email %>

      <%= f.label :password %>
      <%= f.password_field :password %>

      <%= f.label :password_confirmation, "Confirmation" %>
      <%= f.password_field :password_confirmation %>

      <%= f.submit "Create my account", class: "btn btn-large btn-primary" %>
    <% end %>
  </div>
</div> 
```

这是我的*/app/views/layouts/applications.html.erb的内容*

```
<!DOCTYPE html>
<html>
  <head>
    <title><%= full_title(yield(:title)) %></title>
    <%= stylesheet_link_tag    "application", media: "all" %>
    <%= javascript_include_tag "application" %>
    <%= csrf_meta_tags %>
    <%= render 'layouts/shim' %>    
  </head>
  <body>
    <%= render 'layouts/header' %>
    <div class="container">
      <%= yield %>
      <%= render 'layouts/footer' %>
      <%= debug(params) if Rails.env.development? %>
    </div>
  </body>
</html> 
```

`<%= render 'layouts/header' %>`正在调用我希望在我的注册页面上被忽略的标题。

我不确定是否需要`<% if .... %>`在 application.html.erb 文件中放置一条语句，或者我是否可以以某种方式忽略 new.html.erb 文件中的标头

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T00:37:26.113

你可以结合`content_for and a `yield` as described in the Ruby on Rails Guides on [Nested Layouts](http://guides.rubyonrails.org/layouts_and_rendering.html#using-nested-layouts). You would do something like this:`

 `In */app/views/layouts/applications.html.erb*

```
<head>
  <title><%= full_title(yield(:title)) %></title>
  <%= stylesheet_link_tag    "application", media: "all" %>
  <style type="text/css"><%= yield :stylesheets %></style>
  <%= javascript_include_tag "application" %>
  <%= csrf_meta_tags %>
  <%= render 'layouts/shim' %>    
</head>
<body>
  <div id="header_id">
     <%= render 'layouts/header' %>
  </div>
  <div class="container">
    <%= yield %>
    <%= render 'layouts/footer' %>
    <%= debug(params) if Rails.env.development? %>
  </div>
</body> 
```

At the top of */app/views/users/new.html.erb*` 

```
<% content_for :stylesheets do %>
  #header_id { display: none }
<% end %> 
```

给包含你的标题的 div 一个唯一的 id，然后用它替换上面的#header_id。这不是最优雅的解决方案，但它应该可以工作。

# performance - 使用 Azure CDN 的性能下降？

> ID：10307604
> 
> 赞同：9
> 
> 时间：2012-04-24T23:56:05.157
> 
> 标签：performance, azure, routing, cdn, trace

我已经对 Azure 的 CDN 进行了相当多的实验，并且我认为在使用 Web 角色成功设置后我是安全的。

**为什么是网络角色？**

好吧，我想要压缩和缓存标头的好处，而我使用普通 blob 方式未能成功获得这些好处。作为额外的奖励；区分大小写的约束也被消除了。

***选择 CDN 服务就够了***；虽然之前的所有内容都来自同一个域，但我现在或多或少地提供来自 cdn.cuemon.net 的所有“静态”内容。从理论上讲，这应该会提高性能，因为与仅一个域相比，并行浏览器可以将内容收集传播到“多个”域上。

不幸的是，这导致性能下降，我认为这与提供内容之前的滚刀数量有关（使用 tracert 命令）：

```
C:\Windows\system32>tracert -d cdn.cuemon.net

Tracing route to az162766.vo.msecnd.net [94.245.68.160]
over a maximum of 30 hops:

  1     1 ms     1 ms     1 ms  192.168.1.1
  2    21 ms    21 ms    21 ms  87.59.99.217
  3    30 ms    30 ms    31 ms  62.95.54.124
  4    30 ms    29 ms    29 ms  194.68.128.181
  5    30 ms    30 ms    30 ms  207.46.42.44
  6    83 ms    61 ms    59 ms  207.46.42.7
  7    65 ms    65 ms    64 ms  207.46.42.13
  8    65 ms    67 ms    74 ms  213.199.152.186
  9    65 ms    65 ms    64 ms  94.245.68.160

C:\Windows\system32>tracert cdn.cuemon.net

Tracing route to az162766.vo.msecnd.net [94.245.68.160]
over a maximum of 30 hops:

  1     1 ms     1 ms     1 ms  192.168.1.1
  2    21 ms    22 ms    20 ms  ge-1-1-0-1104.hlgnqu1.dk.ip.tdc.net [87.59.99.217]
  3    29 ms    30 ms    30 ms  ae1.tg4-peer1.sto.se.ip.tdc.net [62.95.54.124]
  4    30 ms    30 ms    29 ms  netnod-ix-ge-b-sth-1500.microsoft.com [194.68.128.181]
  5    45 ms    45 ms    46 ms  ge-3-0-0-0.ams-64cb-1a.ntwk.msn.net [207.46.42.10]
  6    87 ms    59 ms    59 ms  xe-3-2-0-0.fra-96cbe-1a.ntwk.msn.net [207.46.42.50]
  7    68 ms    65 ms    65 ms  xe-0-1-0-0.zrh-96cbe-1b.ntwk.msn.net [207.46.42.13]
  8    65 ms    70 ms    74 ms  10gigabitethernet5-1.zrh-xmx-edgcom-1b.ntwk.msn.net [213.199.152.186]
  9    65 ms    65 ms    65 ms  cds29.zrh9.msecn.net [94.245.68.160] 
```

从上面的trace route可以看出，所有外部内容都延迟了相当长的一段时间。值得注意的是，Azure服务设置在北欧，我定居在丹麦，为什么这条trace route有点..hmm..过头了？

另一个问题*可能*是 web-role 是两个额外的小实例；我还没有时间尝试使用两个小型实例，但我知道 Microsoft 将额外的小型实例限制为 5Mb/s WAN，而小型及以上的实例则为 100Mb/s。

我只是不确定这是否也适用于 CDN。

无论如何-非常感谢任何帮助和/或解释。

让我声明，我对 Azure 平台非常满意——我只是对上述问题感到好奇。

**更新**

不带 -d 选项的新 tracert。

受到*user728584*的启发，我研究并找到了这篇文章，[http://blogs.msdn.com/b/scicoria/archive/2011/03/11/taking-advantage-of-windows-azure-cdn-and-dynamic- pages-in-asp-net-caching-content-from-hosted-services.aspx](http://blogs.msdn.com/b/scicoria/archive/2011/03/11/taking-advantage-of-windows-azure-cdn-and-dynamic-pages-in-asp-net-caching-content-from-hosted-services.aspx)，我将进一步研究公共缓存控制和 CDN。

这并不能解释跳数过多的现象，但我希望熟练的网络专业人员可以帮助解决这个问题。

请放心，我会根据我的调查结果及时通知您。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T00:05:56.977

不说很明显，但我假设您已将 Cache-Control HTTP 标头设置为一个很大的数字，以便在您进行 Tracert 测试时，您的内容不会从 CDN 缓存中删除并从 Blob 存储中提供服务？

你附近有很多边缘服务器，所以我希望它表现更好：'Windows Azure CDN 节点位置' [http://msdn.microsoft.com/en-us/library/windowsazure/gg680302.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/gg680302.aspx)

Maarten Balliauw 有一篇关于 CDN 使用和用例的精彩文章（这可能有帮助吗？）：[http ://acloudyplace.com/2012/04/using-the-windows-azure-content-delivery-network/](http://acloudyplace.com/2012/04/using-the-windows-azure-content-delivery-network/)

不确定这是否有帮助，有趣...

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-27T11:13:46.543

好的，在我实现了**公共缓存控制**标头之后，CDN 似乎做了预期的事情；从 CDN 集群中的 x 个节点传送内容。

以上具有它所经历的限制 - 它不是为具体验证而测量的。

但是，此链接支持我的理论：http: [//msdn.microsoft.com/en-us/wazplatformtrainingcourse_windowsazurecdn_topic3](http://msdn.microsoft.com/en-us/wazplatformtrainingcourse_windowsazurecdn_topic3)，

> Blob 的生存时间 (TTL) 设置控制 CDN 边缘服务器在从 Blob 存储中的源请求新副本之前返回缓存资源副本的时间。*一旦此期限到期，**新的请求将强制 CDN 服务器再次从原始 blob 中检索资源**，此时它将再次缓存它*。

这是我假设的挑战；CDN 引用的资源不断汇集原始 blob。

此外，此链接也必须提供学分（由 user728584 提供）；[http://blogs.msdn.com/b/scicoria/archive/2011/03/11/taking-advantage-of-windows-azure-cdn-and-dynamic-pages-in-asp-net-caching-content-从托管服务.aspx](http://blogs.msdn.com/b/scicoria/archive/2011/03/11/taking-advantage-of-windows-azure-cdn-and-dynamic-pages-in-asp-net-caching-content-from-hosted-services.aspx)。

现在的最后一个链接：http: [//blogs.msdn.com/b/windowsazure/archive/2011/03/18/best-practices-for-the-windows-azure-content-delivery-network.aspx](http://blogs.msdn.com/b/windowsazure/archive/2011/03/18/best-practices-for-the-windows-azure-content-delivery-network.aspx)

> 对于 ASP.NET 页面，*默认行为是将缓存控制设置为 private*。在这种情况下，**Windows Azure CDN 不会缓存此内容**。要覆盖此行为，请使用 Response 对象更改默认缓存控制设置。

所以到目前为止，我对这个小谜题的结论是，你必须密切注意你的缓存控制（出于显而易见的原因，它通常设置为私有）。如果您跳过网络角色方法，则 TTL 默认为 72 小时，为什么您可能永远无法体验我所经历的；因此它可以开箱即用。

感谢**user728584**为我指明了正确的方向。

# javascript - 将文本超链接翻转为图像

> ID：10307606
> 
> 赞同：0
> 
> 时间：2012-04-24T23:56:17.947
> 
> 标签：javascript, jquery, html, css

我怎样才能做到这一点？

是否有可能有一个文本超链接，一旦它悬停在上面，那个文本链接就会变成一个图像？

iv 看到图像翻转，但还没有看到或知道如何将文本编码为图像翻转。

我只是不知道从哪里开始以及使用什么编程语言。javascript？php? jQuery？

我开始使用以下代码：

```
<a href = "#" onmouseover = "(document.img.src)='SAM_2251.jpg';">Mouseover here</a>

<img name = "img" alt = "" border = "0" /> 
```

但这所做的是它在将图像加载到其下方时将文本保留在屏幕上。我希望文字完全摆脱图像。

有什么帮助吗？非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T00:06:48.093

您可以只使用 html 和 css 背景图像来做到这一点：

html

```
<a href = "#" class="hover_image">Mouseover here</a> 
```

css

```
a.hover_image:hover {
    background: url(/url/to/image) no-repeat center center;
    text-indent: -9999em;
} 
```

您可能需要更多的 css 来定义`a`标签的宽度和高度，但这是基础。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T00:04:57.740

你可以在很多方面做，这里是一个 CSS 粗略的例子，只是为了看看这个想法

[**试试这个**](http://jsfiddle.net/dd5ym/3/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T00:17:03.243

这将使链接仅在悬停时更改为图像，在悬停时变为文本（仅 CSS）

```
<style>
.changeable img
{
  display:none;
}
.changeable:hover span
{
  display:none;
}
.changeable:hover img
{
  display:inline-block;
}
</style>
<a href="http://www.example.com" class="changeable"><span>Hyper Text</span><img src="img.png" /></a> 
```

或者，如果您希望链接永久更改为图像（使用 jQuery）

```
<style>
.changeable img
{
  display:none;
}
</style>
<a href="http://www.example.com" class="changeable"><span>Hyper Text</span><img src="img.png" /></a>

<script type="text/javascript">
$('.changeable').hover(function(){
  $(this).children('img').show();
  $(this).children('span').hide();
})
</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-25T00:06:07.467

假设 HTML 类似于以下内容：

```
<a href="http://www.example.com/image.png" class="textToImg">Some text</a> 
```

以下 JavaScript 应该可以工作：

```
function textToImage(elem){
    if (!elem) {
        return false;
    }
    else {
        var img = document.createElement('img');
        img.src = elem.href;
        elem.removeChild(elem.firstChild);
        elem.appendChild(img);
    }
} 
```

[JS Fiddle 概念证明](http://jsfiddle.net/davidThomas/7cUEK/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-25T00:10:37.983

这是一种javascript方法

```
 <div id="link">    
    <a href = "#" onmouseover = "document.getElementById('link').style.display='none';document.getElementById('hoverImage').style.display='block';;">Mouseover here</a>  
</div>
<div id="hoverImage" style="display:none">
    <img name = "img" alt = "" border = "0" src="img.JPG" onmouseout = "document.getElementById('link').style.display='block';document.getElementById('hoverImage').style.display='none';;" />    
</div> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-25T00:12:33.040

这也可以用 jQuery 来完成：

`**[See In Action](http://jsfiddle.net/pkZAW/)**`

```
<html>
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
</head>

<body>
<script type='text/javascript'>
$( function() {
  $("#imglink").hover(
    function () {
      $(this).attr('small',$(this).html());
      $(this).html($(this).attr('full'));
    },
    function () {
       $(this).html($(this).attr('small'));
    }
  );
});
</script>

<a herf="" id='imglink' full='<img border="0" src="someImage.png" width="163" height="37"/>'>Rollover for image 'n' rollout for text</a>

</body>
</html> 
```

# android - 如何为 Phonegap Build Websocket 编写 plugin.xml 文件？

> ID：10307608
> 
> 赞同：0
> 
> 时间：2012-04-24T23:56:38.407
> 
> 标签：android, cordova, phonegap-plugins

我一直在考虑为旧的 Android 2 手机集成 Android websocket 插件[https://github.com/FreakDev/PhoneGap-Android-HTML5-WebSocket](https://github.com/FreakDev/PhoneGap-Android-HTML5-WebSocket)，但是当我尝试编写插件时遇到了障碍。 PhoneGap 构建的 xml 文件。

它归结为：我如何包含这行代码？

```
java WebSocketFactory wsFactory = new WebSocketFactory(appView); appView.addJavascriptInterface(wsFactory, "WebSocketFactory"); 
```

这是插件运行的要求（根据 GitHub）。感谢您的帮助！

**背景：**这是关于构建插件的文档[https://build.phonegap.com/docs/plugins](https://build.phonegap.com/docs/plugins)和示例插件文件[https://github.com/alunny/pluginstall/blob/master/test/plugin/plugin.xml](https://github.com/alunny/pluginstall/blob/master/test/plugin/plugin.xml)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T01:25:53.417

Adobe Vancouver 的优秀团队能够帮助我理解这一点。因此，在目前的规范中，PhoneGap Build 云还不允许您访问特定设备上的“活动层”。因此，要使此插件正常工作，它必须构建在桌面上。

但我会密切关注这个，因为 Cordova 的一个分支具有较低级别的 websocket 集成，但要解决旧的 Hixie 安全漏洞需要一些摆弄。

# objective-c - 基础类消息是前向声明错误

> ID：10307613
> 
> 赞同：0
> 
> 时间：2012-04-24T23:57:07.153
> 
> 标签：objective-c, nshost

```
NSHost *h = [NSHost hostWithName:name]; 
```

我从这行代码中得到两个错误

```
ARC Issue: Receiver 'NSHost' for class message is a forward declaration. 
ARC Issue: No known class message for selector 'hostWithName:' 
```

谷歌搜索，我发现前向声明错误通常是由于未能包含某些框架。不过，这种情况很奇怪，因为 NSHost 是 Foundation Framework 的一部分，它是在我的头文件中导入的。是的，我的实现导入了我的头文件。

对 NSHost 的 opt+click 表示 NSHost 是在 NSStream.h 中声明的，而不是在 NSHost.h 中。NSStream 头文件只声明`@class NSHost`.

Product => Clean 也不能解决任何问题。我很困惑这里的问题是什么:(

编辑：我认为问题在于 NSHost 不适用于 iOS：-/

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T00:02:44.513

您应该 #importing 在文件顶部（或在共享 PCH 中）。

或者，如果你真的*想走*手动路线，#import（假设该文件存在）。

# jquery - 我如何在 $(element).each(...) 中使用 fadeTo

> ID：10307616
> 
> 赞同：1
> 
> 时间：2012-04-24T23:57:34.827
> 
> 标签：jquery, loops

我有一些 div，我想使用 jquery 的每种方法来循环遍历 div，并希望一个接一个地在每个 div 上单独应用效果。更清楚地说，我想将潜水淡化到 0.5（不透明度），然后延迟（300），然后再次淡入淡出 1（不透明度），但我希望每个 div 一个接一个地这样做。谁能告诉我正确的方法。谢谢。

[**代码很麻烦。**](http://jsfiddle.net/NHdB6/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T00:03:39.543

不久前我做了一个小插件。这可能会有所帮助：

演示：http: [//jsfiddle.net/elclanrs/9Zxew/](http://jsfiddle.net/elclanrs/9Zxew/)

```
(function ($) {
    $.fn.fade1by1 = function (options) {
        var opt = $.extend({
                'delay' : 500,
                'speed' : 500,
                'ease' : 'swing' // Other requires easing plugin
            }, options);
        var that = this;
        for (var i = 0, d = 0, l = that.length; i < l; i++, d += opt.delay) {
            that.eq(i).delay(d).fadeIn(opt.speed, opt.ease);
        }
    };
})(jQuery); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T00:06:20.127

```
var obj = $('.box');
var i = 0;
LoadSequence();

//recursive for all the items.
function LoadSequence() {
    obj.eq(i++).fadeTo('1000', 0.1).delay(300).fadeTo('1000', 1, LoadSequence);
};
​ 
```

小提琴：http: [//jsfiddle.net/NHdB6/6/](http://jsfiddle.net/NHdB6/6/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T00:18:34.240

我一直认为最好使用动画完成功能而不是多个不同的协调计时器，因为它保证了顺序性。这是我的做法：

```
function fadeElementsSequential(selector) {
    var elems$ = $(selector);
    var i = 0;
    function next() {
        if (i < elems$.length) {
            elems$.eq(i++).fadeTo(1000, 0.5).delay(300).fadeTo(1000, 1, next);
        }
    }
    next();
}

fadeElementsSequential(".box"); 
```

这是一个工作演示：http: [//jsfiddle.net/jfriend00/BW6YF/](http://jsfiddle.net/jfriend00/BW6YF/)

注意：我在演示中更改了不透明度值只是为了让它更明显一点。

# jquery - 带有地理定位功能的 Jquery 谷歌地图插件

> ID：10307617
> 
> 赞同：1
> 
> 时间：2012-04-24T23:57:47.890
> 
> 标签：jquery, google-maps, google-maps-api-3

我正在为一个项目使用 jquery google map 的插件[链接](http://code.google.com/p/jquery-ui-map/)我的主要目标是加载标记，如果用户点击一个链接，它将显示一个带有他的位置的圆圈因为我开始感觉到带有标记的地图我不知道他们的坐标，所以我正在初始化地图并使用 bounds=true 添加标记

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T00:28:16.753

看起来您需要根据文档为 getCurrentPosition 函数进行扩展。

[http://code.google.com/p/jquery-ui-map/wiki/Examples#Example_get_user_position](http://code.google.com/p/jquery-ui-map/wiki/Examples#Example_get_user_position)

> 首先，创建一个名为 jquery.ui.map.extensions.js 的文件。粘贴此代码并保存文件，您应该在生产中使用之前缩小 javascript：

[http://jsfiddle.net/X5r8r/398/](http://jsfiddle.net/X5r8r/398/)

这是顶部的扩展名。出于某种原因，插件中的 _trigger 函数出现错误，因此我编辑了回调并添加了 addmarker。

# android - Android设备之间的通信

> ID：10307625
> 
> 赞同：0
> 
> 时间：2012-04-24T23:58:42.230
> 
> 标签：android, sockets, power-management

我正在寻找一种方法，允许设备以最小的电池损耗向另一台设备发送安全通知。我目前正在使用 SSLServerSocket 执行此操作，但是我觉得保持套接字持续打开对电池寿命非常不利。我考虑的另一个选择是让一个套接字监听连接，但我不确定这是否更好。我需要立即发送通知，因此使用计时器并每隔 x 分钟连接一次并不是最佳选择。有没有什么好的方法可以通过 wifi 连接以最小的电池损耗实现这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T19:07:50.100

也许您可以使用[C2DM](http://www.vogella.com/articles/AndroidCloudToDeviceMessaging/article.html) (Cloud2DeviceMessaging)。这对您来说可能不是完美的解决方案，但不是所有设备都要求更新，而是服务器告诉他们他们这样做了。

设备 A 向设备 B 发送消息 -> 设备 A 向服务器发送消息 -> 服务器通知设备 B 它有消息 -> 设备 B 向服务器询问该消息

# ruby-on-rails - 如何仅允许经过身份验证的用户创建新用户

> ID：10307627
> 
> 赞同：0
> 
> 时间：2012-04-24T23:58:49.037
> 
> 标签：ruby-on-rails, ruby-on-rails-3, devise

我想标题是不言自明的......我如何只让经过身份验证的用户来创建具有设计的用户？
当我尝试添加一个新的（经过身份验证时）时，设计说我已经通过了
任何解决方法的身份验证？
多谢

编辑：根据要求，我的代码

**用户表单**

```
<% if @user == current_user %>
<i class="icon-info-sign"> </i><i>Após alterar seus dados, você terá de fazer login novamente</i>
<% end %>

<%= form_for(@user, :html => { :class => "well form-horizontal"}) do |f| %>
  <% if @user.errors.any? %>
    <div class="alert alert-error">
      <h2><%= pluralize(@user.errors.count, "erro") %> 
        <% if @user.errors.count == 1 %> impede 
          <% else %>
            impedem
        <% end %>
      a continuação:</h2>

      <ul>
      <% @user.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

<label>Nome</label><%= f.text_field :nome %>
<label>E-mail</label><%= f.email_field :email %>

<% if @user == current_user or @user.created_at == nil%>
  <label>Senha</label><%= f.password_field :password %>
<% end %>

<div>
<br />
<button class="btn" type="submit">
    Salvar alterações
</button>

</div>

<% end %> 
```

**用户控制器的一部分**

```
before_filter :authenticate_user!
  def index
    @users = User.all

    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @users }
    end
  end

  # GET /users/1
  # GET /users/1.json
  def show
    @user = User.find(params[:id])

    respond_to do |format|
      format.html # show.html.erb
      format.json { render json: @user }
    end
  end

  # GET /users/new
  # GET /users/new.json
  def new
    @user = User.new

    respond_to do |format|
      format.html # new.html.erb
      format.json { render json: @user }
    end
  end

  # GET /users/1/edit
  def edit
    @user = User.find(params[:id])
  end

  # POST /users
  # POST /users.json
  def create
    @user = User.new(params[:user])

    respond_to do |format|
      if @user.save
        format.html { redirect_to @user, notice: 'User was successfully created.' }
        format.json { render json: @user, status: :created, location: @user }
      else
        format.html { render action: "new" }
        format.json { render json: @user.errors, status: :unprocessable_entity }
      end
    end
  end

  # PUT /users/1
  # PUT /users/1.json
  def update
    @user = User.find(params[:id])

    respond_to do |format|
      if @user.update_attributes(params[:user])
        format.html { redirect_to @user, notice: 'User was successfully updated.' }
        format.json { head :no_content }
      else
        format.html { render action: "edit" }
        format.json { render json: @user.errors, status: :unprocessable_entity }
      end
    end
  end 
```

**应用控制器**

```
class ApplicationController < ActionController::Base
  protect_from_forgery

  def after_sign_in_path_for(resource)
        return request.env['omniauth.origin'] || stored_location_for(resource) || painel_path
    end
end 
```

**部分路线**

App::Application.routes.draw 做

```
 resources :acampantes

  devise_for :users, :skip => [:registrations]

  resources :profiles

  resources :eventos do
    resources :acampantes
  end  

  # aqui tem um has_many, mas não precisa de nested routes
  resources :noticias
  resources :users#, :as => "usuarios" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T04:24:32.507

理想的方法是覆盖（如此[处](https://github.com/plataformatec/devise/blob/master/README.md)`registrations_controller.rb`所示）并跳过对and操作的 before_filter 检查。我试着自己做，但不幸的是，我做错了。`new``create`

另一种对我有用的方法是在 Devise 提供的 Registrations 控制器之外创建一个单独的 User 控制器：

```
class UsersController < ApplicationController
  before_filter :authenticate_user!

  def new
    @user = User.new
  end

  def create
    @user = User.new(params[:user])
    if @user.save
      flash[:success] = "User saved"
      redirect_to @user
    else
      render 'new'
    end
  end
end

# routes.rb
ApplicationName::Application.routes.draw do
  devise_for :users
  resources :users, :only => [:new, :create]
end 
```

然后为新动作制作一个表格：

```
# app/views/users/new.html.erb
<%= form_for(@user) do |f| %>

  <div><%= f.label :email %><br />
  <%= f.email_field :email %></div>

  <div><%= f.label :password %><br />
  <%= f.password_field :password %></div>

  <div><%= f.label :password_confirmation %><br />
  <%= f.password_field :password_confirmation %></div>

  <div><%= f.submit "Sign up" %></div>
<% end %> 
```

这种方法的问题在于，Devise 提供的用于注册的路由仍然存在。一个解决方案是阻止 Devise 生成涉及注册的路由：

```
# routes.rb
devise_for :users, :skip => [:registrations] 
```

这意味着您将完全忽略注册模块并自己制作。我从[Bare-bone, stripped-down Devise 教程](http://blog.plataformatec.com.br/2011/09/bare-bone-stripped-down-devise/)中得到了这个想法。请注意，您应该制作控制器操作和视图来替换 Devise 的注册模块提供的操作和视图。这包括`new`、`edit`、`create`、`update`和`destroy`。

# python - 在 SQLite3 中选择查询以获取最近 9 个月的数据

> ID：10307631
> 
> 赞同：-5
> 
> 时间：2012-04-24T23:58:56.830
> 
> 标签：python, select, sqlite

我正在用python为学校做项目。我需要做（查询）报告，从 SQLite 数据库的一个表中为酒店的前磁盘提供当天前 9 个月在酒店住宿的客人列表。我不知道如何做'where'条件来获取前 9 个月的数据:(

顺便说一句，数据库是 SQLite3。

任何帮助都会很棒

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T00:47:12.160

没有给你答案（因为你需要自己做一些工作），这应该给你一个起点。

```
SELECT * FROM GuestInfo 
WHERE ArrivalDate >= (Today's date - your definition of 9 months before today) 
```

# objective-c - NSDate 的 dateWithTimeIntervalSinceNow 中的负 NSTimeInterval：

> ID：10307634
> 
> 赞同：2
> 
> 时间：2012-04-24T23:59:12.307
> 
> 标签：objective-c, ios, nsdate

[来自 iOS 文档：](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSDate_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40003641)

```
seconds
The number of seconds from the current date and time for the new date. Use a negative value to specify a date before the current date. 
```

然而，这段代码给出了 2148 年的日期：

```
#import <Foundation/Foundation.h>
#import <stdlib.h>

int main(int argc, const char * argv[])
{

    @autoreleasepool {

        for(int i = 0; i < 30; i++) {
            NSDate* date = [NSDate dateWithTimeIntervalSinceNow:(NSTimeInterval)-((u_int32_t)i * 12 * 60 * 60 + arc4random_uniform(8 * 60 * 60))];
            NSLog(@"%@", date);
        }

    }
    return 0;
} 
```

它应该从最近的过去生成半随机的日期和时间。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-30T18:57:15.063

正如 Hot Licks 所说，这是由于在将数字设为负数后转换为 NSTimeInterval 而不是先否定数字然后再转换它。

该行的固定版本将如下所示：

```
NSDate* date = [NSDate dateWithTimeIntervalSinceNow:-(NSTimeInterval)((u_int32_t)i * 12 * 60 * 60 + arc4random_uniform(8 * 60 * 60))]; 
```

# python - 在 Django 中将用户传递给 ForeignKey 时出错

> ID：10307635
> 
> 赞同：1
> 
> 时间：2012-04-24T23:59:19.230
> 
> 标签：python, django, typeerror

我试图在我的 models.py 文件中将用户模型作为 ForeignKey 的参数传递，但我收到了错误消息`TypeError: int() argument must be a string or a number, not 'User'`。

这是我的文件，请告诉我我做错了什么：

**模型.py**

```
from django.db import models

class Lesson(models.Model):
    name = models.CharField(max_length=30)
    author = models.ForeignKey('auth.User')
    description = models.CharField(max_length=100)
    yt_id = models.CharField(max_length=12)
    upvotes = models.IntegerField()
    downvotes = models.IntegerField()
    category = models.ForeignKey('categories.Category')
    views = models.IntegerField()
    favorited = models.IntegerField()

    def __unicode__(self):
        return self.name 
```

**populate_db.py**

```
from django.contrib.auth.models import User
from edu.lessons.models import Lesson
from edu.categories.models import Category

users = User.objects.all()

cat1 = Category(1, 'Mathematics', None, 0)
cat1.save()
categories = Category.objects.all()

lesson1 = Lesson(1, 'Introduction to Limits', users[0], 'Introduction to Limits', 'riXcZT2ICjA', 0, 0, categories[0], 0, 0)
lesson1.save() # Error occurs here 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T01:53:56.097

在这里使用位置参数非常令人困惑，似乎是原因。

`ForeignKey`我可以通过在我自己的一个模型上使用位置参数来重现您的错误。使用 kwargs 解决了这个问题。

我什至没有兴趣调查原因 - 我从未使用令人困惑的位置参数来填充模型（如果您修改过模型，似乎它们也会因为令人困惑的消息而一直中断）

编辑：或者更糟糕的是，随着时间的推移，输入字段会出现错误的模型字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T05:55:53.940

从 django.contrib.auth 导入用户（忘记了确切的导入调用）作者 = models.ForeignKey(User)

编辑（添加）：我会按照我所说的方式导入用户，并将“author.category”用于其他关系。虽然比我更了解 Django 的人已经解决了这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T15:45:57.350

您应该使用关键字参数以及使用默认字段值简单地对其进行初始化。

```
class Lesson(models.Model):
    name = models.CharField(max_length=30)
    author = models.ForeignKey('auth.User')
    description = models.CharField(max_length=100)
    yt_id = models.CharField(max_length=12)
    upvotes = models.IntegerField(default=0)
    downvotes = models.IntegerField(default=0)
    category = models.ForeignKey('categories.Category')
    views = models.IntegerField(default=0)
    favorited = models.IntegerField(default=0)

    def __unicode__(self):
        return self.name

lesson1 = Lesson(name='Introduction to Limits', author=users[0], description='Introduction to Limits', yt_id='riXcZT2ICjA', category=categories[0])
lesson1.save() 
```

# ruby-on-rails - Rails 3.* 设计 Facebook OmniAuth 间歇性失败并出现 NoMethodError

> ID：10307640
> 
> 赞同：2
> 
> 时间：2012-04-25T00:00:20.720
> 
> 标签：ruby-on-rails, devise, omniauth, facebook-authentication

我遵循了[https://github.com/plataformatec/devise/wiki/OmniAuth:-Overview](https://github.com/plataformatec/devise/wiki/OmniAuth:-Overview)中描述的步骤，并在用户模型中有一个方法，如下所示：

```
def self.find_for_facebook_oauth(access_token, signed_in_resource=nil)
  data = access_token.extra.raw_info
  if user = self.find_by_email(data.email)
    user
  else # Create a user with a stub password. 
    self.create!(:email => data.email, :password => Devise.friendly_token[0,20]) 
  end
end 
```

我间歇性地收到错误，例如

在 omniauth_callbacks#facebook 中发生 NoMethodError：

未定义的方法`email' for "false":String app/models/user.rb:138:in`find_for_facebook_oauth'

我无法重现。这个问题的根源是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T20:00:41.193

我也不确定是什么原因造成的。这是一个简单地创建一个新对象的解决方法：

```
def self.find_for_facebook_oauth(access_token, signed_in_resource=nil)
  data = access_token.extra.raw_info
  if data == "false"
    self.new
  elsif user = self.find_by_email(data.email)
    user
  else # Create a user with a stub password. 
    self.create!(:email => data.email, :password => Devise.friendly_token[0,20]) 
  end
end 
```

然后示例中显示的控制器代码将起作用 - 它将重定向用户进行注册。

# java - 图书馆管理系统上的用户类型

> ID：10307643
> 
> 赞同：0
> 
> 时间：2012-04-25T00:00:58.880
> 
> 标签：java

我必须构建一个图书馆管理系统，并且在尝试实现用户类型或配置文件时遇到了问题。我已经有了一个超类用户和另外两个用户子类，学生和教师，每个子类都有自己的“特征”。问题是我必须根据他们可以借的书籍数量和他们可以保留书籍直到他们必须归还书籍的时间来实现 7 种类型的用户（5 种类型的学生和 2 种类型的文员）。这些是班级之间仅有的两个区别。

你将如何实现这一点？遗产？我正在寻找一种聪明的方法来实现这一点，我很想听听你对此的看法。

非常感谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T00:04:21.813

作为一个好的经验法则，你在项目规范中看到一个名词的任何地方，它都是一个类的好候选。如果这些名词在项目规范中有关系，那么它们可能在你的代码中也有关系。

您的所有人员都将属于 a 的类别，`User`因此也许这应该是他们都将继承的接口。从这里开始，它们似乎分为两类，`Student`也许`Staff`这些也应该是抽象类/接口。然后你就有了 7 个具体的类。2继承`Staff`和5继承`Student`。

所以你最终会得到这样的东西.. ![在此处输入图像描述](../Images/5ab2bb7322db731c022db6c09fe32f9b.png)

当然，这个设计取决于每个`User`人必须做什么，每个人`Staff`/`Student`必须做什么，但我会把非常具体的细节留给你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T00:42:31.240

每个人都有一个“班级”，这确实限制了您的设计；因为，如果要添加学生或老师，则需要开始编写新课程。

类是模板，每个模板都用于构造一个“类的实例”或更具体地说是一个“实例”。一个模板通常用于构造多个类（尽管一个类*不必*多次使用，使用一次（或根本不使用）就可以了）。

所以你可以做

```
public class Student {

  private String name;

  public Student(String name) {
    this.name = name;
  }

  public string getName() {
    return this.name;
  }

}

public class Staff {

  private String name;

  public Staff(String name) {
    this.name = name;
  }

  public String getName() {
    return this.name;
  }

} 
```

正如你所看到的，员工和学生之间会有很多重复。 `getName()`, `getAge()`, `getPhoneNumber()`,`getAddress()`等可以很容易地应用于两者，这在这种结构下意味着您必须为`Student`和复制这些方法`Staff`。

工作人员和学生有什么共同点？两者都是`People`，而且很多常用的方法对所有人来说都是通用的。

```
public class Person {

  private String name;

  public Person(String name) {
    this.name = name;
  }

  public String getName() { 
    return this.name;
  }
}

public Staff extends Person {

  public void teachClass(Class class) {
    ...
  }

}

public Student extends Person {

  public void attendClass(Class class) {
    ...
  }

} 
```

这种设计还产生了其他问题，因为它暗示职员不是学生，学生不是职员。在现实世界中，有时员工会报名上课，而学生可以担任教学角色（想想老师的助手）。

最灵活的方法实际上并没有在学生和员工之间产生结构上的差异，而是通过能力来区分两者。

```
 public class Person {

   public Person(String name) {
     ...
   }

   public void canTeach(Course course) {
     teaching.add(course);
   }

   public void attending(Course course) {
     attending.add(course);
   }

   public boolean isStaff() {
     return !teaching.isEmpty();
   }

   public boolean isStudent() {
     return !attending.isEmpty();
   }

 } 
```

但是，这种结构与您在课堂上展示的示例完全不同，它回避了您真正应该学习的有关继承的课程。

# .net - 首先在实体框架代码中创建简单的用户消息传递设置

> ID：10307645
> 
> 赞同：0
> 
> 时间：2012-04-25T00:01:09.037
> 
> 标签：.net, wcf, entity-framework

我想通过 WCF 和实体框架设置一个简单的用户消息传递系统。我保持简单的想法：

一个用户可以向另一个用户发送消息。

背景：鲍勃给比尔发了一条消息。比尔给鲍勃发了一条消息。（未穿线）

在通过谷歌搜索大量阅读各种建议后，我做出了尝试。结果是两个类`User`和`Message`。

我越来越困惑/卡住了。~~因此我的问题是：我的实施是否有缺陷，如果有，是否有“更好”的方法来实施？~~

**用户类**

```
public class User
{
    [Key, DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public Guid UserID { get; set; }

    public string Name { get; set; }

    public ICollection<Message> SentMessages { get; set; }

    public ICollection<Message> ReceivedMessages { get; set; }
} 
```

**消息类**

```
public class Message
{
    [Key, DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public Guid MessageID { get; set; }

    public DateTime CreatedOn { get; set; }

    public string Content { get; set; }

    public Guid SenderID { get; set; }

    public virtual User Sender { get; set; }

    public Guid AddresseeID { get; set; }

    public virtual User Addressee{ get; set; }

} 
```

**更新/编辑：**

我想在问题中添加一些额外的细节以帮助更好地解释。

我已经实现了一个存储库模式。因此，通过上述类，我可以轻松获取用户发送的所有消息。例如

```
messageRepository.GetMessagesFromUserByUserID(Guid.Parse(id)).ToList();

public IEnumerable<Message> GetMessagesFromUserByUserID(Guid userID)
        {
            return context.Messages.Where(x => x.SenderID == userID).ToList();
        } 
```

这一切都很好。问题是我想使用 Sender 导航属性来获取发件人的姓名，因此当客户端收到消息时，他们可以看到他们来自谁。

我可以使用我的用户存储库，通过 UserID 查找用户并将这两个结果结合起来——但这似乎违反直觉。

最后; 我很抱歉无法以简洁的方式表达这一点，并希望额外的信息有所帮助。

更新 2：

我曾尝试使用 Sender 属性，例如。`Sender.Name`但是我收到一个错误。我去查看数据库，发现这是正在生产的。请忽略指南相同的事实。

![数据库映像](../Images/c744a8aea3f546da18f2b913eeb37f71.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T10:01:40.137

感谢@Ladislav Mrnka 确认属性正确，这很有帮助。

所以我的回答受到了另一个 SO question 的启发。我只需要像这样向模型构建器添加一些细节：

```
 modelBuilder.Entity<Message>()
                .HasRequired(m => m.Sender)
                .WithMany(t => t.MessagesSent)
                .HasForeignKey(m => m.SenderID)
                .WillCascadeOnDelete(false);

        modelBuilder.Entity<Message>()
                .HasRequired(m => m.Addressee)
                .WithMany(t => t.MessagesReceived)
                .HasForeignKey(m => m.AddresseeID)
                .WillCascadeOnDelete(false); 
```

# solr - 使用 Sunspot 和 Rails 搜索字符串字段

> ID：10307647
> 
> 赞同：0
> 
> 时间：2012-04-25T00:01:33.450
> 
> 标签：solr, sunspot-rails

我的团队正在尝试实施 Solr 和 Sunspot-Rails 作为我们应用程序的搜索提供程序。我们的故事要求除了文本字段之外还要搜索某些字符串字段。我看到有些人使用 ActiveRecord 回调将这些字段聚合成一个合并的索引字段（具有一种文本）。这是我唯一的希望还是我缺少通配符参数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T12:23:57.703

您可以定义将像这样索引的字段

```
class Post < ActiveRecord::Base
  searchable do
    text :title, :body
    text :comments do
      comments.map { |comment| comment.body }
    end
    string  :sort_title do
      title.downcase.gsub(/^(an?|the)/, '')
    end
  end 
end 
```

然后你搜索它们你可以像这样指定你想要搜索的字段

```
Post.search do
  fulltext 'pizza' do
    fields(:body, :title)
  end
end 
```

如果您没有指定字段，它会将搜索应用于索引的所有文本字段

```
Post.search do
  fulltext 'best pizza'
end 
```

# ios - RestKit：postObject 调用了什么委托方法？

> ID：10307649
> 
> 赞同：2
> 
> 时间：2012-04-25T00:01:42.947
> 
> 标签：ios, restkit

调用方法后调用 RKObjectLoaderDelegate 的什么方法`- (RKObjectLoader *)postObject:(id<NSObject>)object delegate:(id<RKObjectLoaderDelegate>)delegate`？

一旦我的 POST 成功，我将尝试运行更多代码。

**编辑（更多信息）：**

@Paul 提到的这两种方法都没有被调用，但是我的服务器对 POST 的解释有些正确，因为正在写入数据库。

在应用程序初始化期间，我正在执行以下操作：

```
// Grab the reference to the router from the manager
RKObjectRouter *router = [RKObjectManager sharedManager].router;

// Define a default resource path for all unspecified HTTP verbs
[router routeClass:[EventMessage class] toResourcePath:@"/events_messages/:idPrimaryKey"];
[router routeClass:[EventMessage class] toResourcePath:@"/event_messages" forMethod:RKRequestMethodPOST]; 
```

当我准备发布时，我正在这样做：

```
RKObjectMapping *objectMapping = [RKObjectMapping mappingForClass:[EventMessage class]];
[objectMapping mapKeyPath:@"user_id" toAttribute:@"userId"];
[objectMapping mapKeyPath:@"event_id" toAttribute:@"eventId"];
[objectMapping mapKeyPath:@"message" toAttribute:@"message"];

[[RKObjectManager sharedManager].mappingProvider registerMapping:objectMapping withRootKeyPath:@"event_message"];

[[RKObjectManager sharedManager] postObject:eventMessage delegate:self]; 
```

这是我在控制台中遇到的错误：

> 错误域=JKErrorDomain 代码=-1 "意外的令牌，想要 '{', '}', '[', ']', ',', ':', 'true', 'false', 'null', ' “字符串”，“数字”。UserInfo=0x7b9f510 {JKAtIndexKey=0, JKLineNumberKey=1, NSLocalizedDescription=Unexpected token, 想要 '{', '}', '[', ']', ',', ':', 'true', 'false', 'null'、'"STRING"'、'NUMBER'.}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T09:02:42.763

```
 - (void)objectLoader:(RKObjectLoader*)objectLoader didLoadObjects:(NSArray*)objects; 
```

或者

```
 - (void)objectLoader:(RKObjectLoader*)objectLoader didFailWithError:(NSError*)error; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T09:07:57.697

一旦您正确设置了映射，对象的发布就非常容易。就像 Paul Cezanne 指出的那样，将使用相应的回调。

但是，对于发布对象，您还需要一个序列化映射来告诉框架哪些参数应该转换为 POST 参数：

映射示例：

```
 // Serialisation Mapping
    RKObjectMapping *messageSendMapping = [RKObjectMapping mappingForClass:[NSMutableDictionary class]];

    [messageSendMapping mapAttributes:@"name", @"number", @"text", nil];

    [[RKObjectManager sharedManager].mappingProvider
            setSerializationMapping:messageSendMapping
                           forClass:[Message class]]; 
```

**更新：**出于故障排除的目的，您可能希望像这样增加 RestKit 的日志级别：

```
RKLogConfigureByName("RestKit", RKLogLevelTrace);
RKLogConfigureByName("RestKit/Network", RKLogLevelTrace);
RKLogConfigureByName("RestKit/ObjectMapping", RKLogLevelTrace);
RKLogConfigureByName("RestKit/CoreData", RKLogLevelTrace); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T04:09:56.947

确保 RKObjectManager 已经初始化：

```
NSString *url = @"http://example.com";
RKObjectManager* mgr = [RKObjectManager managerWithBaseURLString:url]; 
```

我浪费了很多时间才注意到 sharedManager 并不是真正的单例，你必须初始化它。

之后，您可以使用 sharedManager 并获取对创建的第一个的引用：

```
[[RKObjectManager sharedManager].mappingProvider setObjectMapping:mapping forResourcePathPattern:@"/RKKeyValueMappingExample"]; 
```

# java - 如何在 maven-shade-plugin 创建的 Jar 中包含测试类？

> ID：10307652
> 
> 赞同：34
> 
> 时间：2012-04-25T00:02:13.257
> 
> 标签：java, maven, dependencies, maven-shade-plugin, maven-jar-plugin

我正在尝试使用 Maven 将我的测试类打包到一个具有依赖项的可执行 jar 中，但我正在努力做到这一点。

到目前为止，这是我的 pom.xml：

```
<project>
    <modelVersion>4.0.0</modelVersion>

    <groupId>com.c0deattack</groupId>
    <artifactId>executable-tests</artifactId>
    <version>1.0</version>
    <packaging>jar</packaging>

    <name>executable-tests</name>

    <dependencies>
        <dependency>
            <groupId>info.cukes</groupId>
            <artifactId>cucumber-java</artifactId>
            <version>1.0.0</version>
        </dependency>
        <dependency>
            <groupId>info.cukes</groupId>
            <artifactId>cucumber-junit</artifactId>
            <version>1.0.0</version>
        </dependency>

        <dependency>
            <groupId>org.seleniumhq.selenium</groupId>
            <artifactId>selenium-java</artifactId>
            <version>2.21.0</version>
        </dependency>

        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <version>4.10</version>
        </dependency>
    </dependencies>

    <build>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-jar-plugin</artifactId>
                <version>2.4</version>
                <executions>
                    <execution>
                        <goals>
                            <goal>test-jar</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-shade-plugin</artifactId>
                <version>1.6</version>
                <executions>
                    <execution>
                        <phase>package</phase>
                        <goals>
                            <goal>shade</goal>
                        </goals>
                        <configuration>
                            <finalName>cucumber-tests</finalName>
                            <transformers>
                                <transformer implementation="org.apache.maven.plugins.shade.resource.ManifestResourceTransformer">
                                    <mainClass>cucumber.cli.Main</mainClass>
                                </transformer>
                            </transformers>
                            <artifactSet>
                                <includes>
                                    <include>info.cukes:*</include>
                                </includes>
                            </artifactSet>
                        </configuration>
                    </execution>
                </executions>
                <dependencies>
                    <dependency>
                        <groupId>com.c0deattack</groupId>
                        <artifactId>executable-tests</artifactId>
                        <version>1.0</version>
                        <type>test-jar</type>
                    </dependency>
                </dependencies>
            </plugin>
        </plugins>
    </build>
</project> 
```

当我执行`mvn clean package`构建创建3个罐子：

*   executable-tests-1.0.jar // 由 mvn package 阶段构建
*   executable-tests-1.0-teststjar // 由 jar-plugin 构建
*   cucumber-tests.jar // 由 shade-plugin 构建

`Cucumber-tests.jar`包含`info.cuke`依赖项，但不包含`executable-tests-1.0-tests.jar`.

我做了各种各样的事情来尝试包含测试类，但没有任何效果，我错过了什么？

**编辑：**如果有人喜欢玩它，我已经将我的示例项目推送到 GitHub :) [https://github.com/C0deAttack/ExecutableTests](https://github.com/C0deAttack/ExecutableTests)

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2016-03-17T10:50:35.883

回答晚了，但得到了一个可行的解决方案，可以帮助这个问题的未来访问者。

我只使用一个 Maven 插件就成功地拥有了一个胖罐子，其中包括：

*   测试类
*   应用程序代码类
*   应用程序代码所需的外部依赖项（在`compile`范围内）
*   测试代码所需的外部依赖项（在`test`范围内）

这基本上意味着一个添加了测试类（及其依赖项）的胖 jar。[Maven Jar 插件](https://maven.apache.org/plugins/maven-jar-plugin/)及其[`test-jar`](https://maven.apache.org/plugins/maven-jar-plugin/)目标不适合这种需要。[Maven Shade 插件](https://maven.apache.org/plugins/maven-shade-plugin/)及其[`shadeTestJar`](https://maven.apache.org/plugins/maven-shade-plugin/shade-mojo.html#shadeTestJar)选项也无济于事。

**那么，如何在 Maven 中创建一个带有测试类和外部依赖的胖 jar？**

在这种情况下，[Maven 程序集插件](https://maven.apache.org/plugins/maven-assembly-plugin)是一个完美的候选者。

这是一个最小的 POM 示例：

```
<project>
    <modelVersion>4.0.0</modelVersion>
    <groupId>com.sample</groupId>
    <artifactId>sample-project</artifactId>
    <version>1.0-SNAPSHOT</version>

    <build>
        <plugins>
            <plugin>
                <artifactId>maven-assembly-plugin</artifactId>
                <version>2.3</version>
                <configuration>
                    <descriptor>src/main/assembly/assembly.xml</descriptor>
                </configuration>
                <executions>
                    <execution>
                        <id>make-assembly</id>
                        <phase>package</phase>
                        <goals>
                            <goal>single</goal>
                        </goals>
                        <configuration>
                            <archive>
                                <manifest>
                                    <mainClass>com.sample.TestMain</mainClass>
                                </manifest>
                            </archive>
                        </configuration>
                    </execution>
                </executions>
            </plugin>
        </plugins>
    </build>

    <dependencies>
        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <version>4.11</version>
            <scope>test</scope>
        </dependency>
    </dependencies>
</project> 
```

上面的配置还设置了一个在测试类中定义的主类（为了快速检查它是否有效，请按答案）。但这还不够。

您还需要创建一个[描述符文件](https://maven.apache.org/plugins/maven-assembly-plugin/descriptor-refs.html)，在`src\main\assembly`文件夹中创建一个`assembly.xml`包含以下内容的文件：

```
<assembly
    xmlns="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.3"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.3 http://maven.apache.org/xsd/assembly-1.1.3.xsd">
    <id>fat-tests</id>
    <formats>
        <format>jar</format>
    </formats>
    <includeBaseDirectory>false</includeBaseDirectory>
    <dependencySets>
        <dependencySet>
            <outputDirectory>/</outputDirectory>
            <useProjectArtifact>true</useProjectArtifact>
            <unpack>true</unpack>
            <scope>test</scope>
        </dependencySet>
    </dependencySets>
    <fileSets>
        <fileSet>
            <directory>${project.build.directory}/test-classes</directory>
            <outputDirectory>/</outputDirectory>
            <includes>
                <include>**/*.class</include>
            </includes>
            <useDefaultExcludes>true</useDefaultExcludes>
        </fileSet>
    </fileSets>
</assembly> 
```

上面的配置是：

*   设置要从范围中获取的外部依赖`test`项（也将采用`compile`范围）
*   设置 a`fileset`以包含已编译的测试类作为打包的 fat jar 的一部分
*   使用分类器设置最终 jar `fat-tests`（因此您的最终文件将类似于`sampleproject-1.0-SNAPSHOT-fat-tests.jar`）。

### 我们如何测试它？

构建罐子：

```
mvn clean compile test-compile assembly:single 
```

从`target`文件夹运行：

```
java -jar sampleproject-1.0-SNAPSHOT-fat-tests.jar 
```

我们将执行 main（来自测试类）。main 可能会调用其他测试或应用程序代码（因此在两者`compile`或`test`范围内都需要外部依赖项）并且一切都会正常工作。

* * *

从这样的主目录中，您还可以调用所有测试用例，如下所示：

*   创建一个 JUni 测试套件
*   将相关测试添加到测试套件中
*   从您的普通 Java 主程序调用测试套件

测试套件示例：

```
import org.junit.runner.RunWith;
import org.junit.runners.Suite;
import org.junit.runners.Suite.SuiteClasses;

@RunWith(Suite.class)
@SuiteClasses({ AppTest.class })
public class AllTests {

} 
```

注意：在这种情况下，测试套件仅涉及`AppTest`样本测试。

然后你可以有一个主类如下：

```
import org.junit.internal.TextListener;
import org.junit.runner.JUnitCore;

public class MainAppTest {

    public static void main(String[] args) {
        System.out.println("Running tests!");

        JUnitCore engine = new JUnitCore();
        engine.addListener(new TextListener(System.out)); // required to print reports
        engine.run(AllTests.class);
    }
} 
```

然后上面的 main 将执行测试套件，该套件将链式执行所有配置的测试。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-02T21:11:15.893

我用不同的方式解决了我的问题；使用另外两个插件。

首先，我使用`maven-dependency-plugin`获取依赖项并在本地解包它们，然后我使用`maven-jar-plugin`来创建`test-jar`并包含解包依赖项中的类。

# objective-c - Objective-c 中的正则表达式

> ID：10307655
> 
> 赞同：0
> 
> 时间：2012-04-25T00:02:37.330
> 
> 标签：objective-c, regex

我正在寻找文本中所有出现的字符串，但我不明白为什么代码不起作用。在正文中，出现了 2 处。

文本 ：

```
<div class="infosLigneDetail pointer" onclick="javascript:toggleForfait('1');">
                    Alexandre OUICHER - Forfait Free illimité à 19,99 euros - 0627505460                        <input 
```

搜索字符串：

```
Alexandre OUICHER - Forfait Free illimité à 19,99 euros - 0627505460 
```

正则表达式：

```
NSRegularExpression *regexpComptes = [NSRegularExpression regularExpressionWithPattern:@"(?<=javascript:toggleForfait('[0-9]');\">).*?(?=<input)" options:NSRegularExpressionSearch error:NULL];
NSArray *matchesComptes = [regexpComptes matchesInString:content
                                                   options:0
                                                     range:NSMakeRange(0, [content length])]; 
```

你知道问题出在哪里吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T06:22:14.530

你没有逃脱`(`and `)`in `toggleForfait('[0-9]')`。它被视为捕获组。它应该`\(`和`\)`分别...`toggleForfait\('[0-9]'\)`

您想要的正则表达式是`(?<=javascript:toggleForfait\('[0-9]'\);\">).*?(?=<input)`启用了 dotall 选项的**NSRegularExpressionDotMatchesLineSeparators**

看这里：[http ://regexr.com?30ool](http://regexr.com?30ool)

# java - 如何从菜单栏打开新窗口？

> ID：10307657
> 
> 赞同：4
> 
> 时间：2012-04-25T00:02:55.557
> 
> 标签：java, swing, menu, jframe, joptionpane

到目前为止，这是我的代码：

```
public static void main(String[] args){
    JFrame frame = new JFrame("Breakout!");
    frame.setLocation(300, 300);
    //Making the menubar
        JMenuBar mb = new JMenuBar();
        frame.setJMenuBar(mb);
        JMenu fileMenu = new JMenu("File");
        mb.add(fileMenu);
        JMenuItem newAction =   new JMenuItem("About");
        fileMenu.add(newAction);
        newAction.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent arg0) {
                System.out.println("open new window here");
            }
        });
    BreakoutCourt c = new BreakoutCourt();
    frame.add(c);
    frame.pack();
    frame.setResizable(false);
    frame.setVisible(true);
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
} 
```

我正在制作一个突围游戏。我想制作一个关于游戏的信息窗口（例如，如何玩游戏等）。我该怎么做呢？感谢您的帮助！我对 Java Swing 很陌生，所以是的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T00:20:41.647

您可以使用以下消息类型做一个简单的`JOptionPane`：

```
JOptionPane.showMessageDialog(frame, "Breakout! v1.0"); 
```

（您需要使框架最终执行此操作，因为它是从匿名操作侦听器中访问的）。

为了更好地控制显示的内容，以及它是否应该是模态的，您可以查看`JDialog`. 这里有一个在 Swing 中使用对话框的概述：http: [//docs.oracle.com/javase/tutorial/uiswing/components/dialog.html](http://docs.oracle.com/javase/tutorial/uiswing/components/dialog.html)。

# vim - Vim：不区分大小写的前模式自动完成

> ID：10307659
> 
> 赞同：7
> 
> 时间：2012-04-25T00:03:27.373
> 
> 标签：vim, autocomplete, case-insensitive

我在我的以下行`~/.inputrc`：

```
set completion-ignore-case on 
```

因此，在 shell 中，自动完成不区分大小写。Vim 的 Ex 模式有类似的东西吗？我希望能够输入`:bundlei<Tab>`并自动完成到`:BundleInstall`. 同样，我想输入`:e ~/doc<Tab>`并获取`:e ~/Documents/`.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-11-11T02:03:38.017

试试这个新功能：`:set wildignorecase`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T02:38:49.930

这不是真正的答案。但是如果你安装了 ambicmd，你会得到很好的操作命令行的行为。

[https://github.com/thinca/vim-ambicmd](https://github.com/thinca/vim-ambicmd)

并将以下内容添加到您的 vimrc

```
if globpath(&rtp, 'autoload/ambicmd.vim') != ''
  cnoremap <expr> <Space> ambicmd#expand("\<Space>")
  cnoremap <expr> <CR>    ambicmd#expand("\<CR>")
endif 
```

也许你会相处`BundleInstall`的`:bi<space>`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T01:12:00.423

将这些添加到您的 .vimrc 中：

```
set ignorecase
set smartcase 
```

有了这些，您的示例将按描述工作。我找不到明确说明这些选项会影响命令行完成的文档，但它们似乎会影响所有模式。

# javascript - chrome....onBeforeRequest...() URL 列表未按预期运行

> ID：10307661
> 
> 赞同：2
> 
> 时间：2012-04-25T00:03:42.577
> 
> 标签：javascript, arrays, google-chrome, google-chrome-extension

我正在尝试进行扩展时遇到一些问题。扩展程序的工作是在发出请求之前检查 URL，并阻止提供的列表中可用的 URL。*manifest.json 文件加载 flagged.js 声明和初始化数组。然后，它加载具有*检查 URL 功能的文件：

```
// To detected and filter globally flagged websites
chrome.webRequest.onBeforeRequest.addListener(
    // What to do if detected a website
    function(info) {

        return {redirectUrl: 'chrome-extension://' + chrome.i18n.getMessage('@@extension_id') + 
            '/blocked.html?flag_type=globally&url=' + escape(info.url)};
    },

    // Website to watchout for
    {
        urls: flagged,
        types: []
    },

    // Action to be performed?
    ["blocking"]); 
```

我的问题从部分***urls: flagged 开始，***似乎列表必须硬连线才能被接受。我的意思是，我必须这样指定列表项：

```
var flagged = [
"*://*.domain_1.com/*",
"*://*.domain_2.com/*",
"*://*.domain_3.com/*",
"*://*.domain_4.com/*",
]; 
```

如果我尝试访问上述任何指定域，扩展程序会将它们重定向到***block.html***页面，没有问题。但是，我希望该列表能够自动或定期更新，所以我介绍了这部分：

```
// Get list from the text file we have stored
function getFlagged(url) {
    var list = [];
    var file = new XMLHttpRequest();
    file.open("GET", url, true);
    file.onreadystatechange = function() {
        if (file.readyState === 4) {
            if (file.status === 200) {
                allText = file.responseText; 
                list = file.responseText.split('|');
                    for( var i=0; i<list.length; i++ )
                        flagged.push(list[i]);
            }
        }
    }
    file.send(null);
} 
```

我试图改变和添加一些可能没有意义或可以做不同的事情，我只是绝望了。该列表将填充新项目，例如***domain_5***和***domain_6***。此操作将在加载扩展程序时首先发生，或者我认为。但是，当我尝试访问***domain_5***和***domain_6***时，尽管它们在标记的列表中，但扩展程序不会**阻止它们。**

对此问题的任何帮助将不胜感激！谢谢

编辑：我不是 JS 或 Chrome.API 方面的专家，这是我第一次尝试 chrome 扩展。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T16:36:24.253

是的，您的侦听器在 XMLHttpRequest 完成之前注册。

在你的 onreadystatechange 函数中调用监听器，你就会让它工作。

# c# - 使用 WCF 服务应用程序附加 SQL Server Express 数据库

> ID：10307665
> 
> 赞同：1
> 
> 时间：2012-04-25T00:04:08.757
> 
> 标签：c#, wcf, sql-server-2008, wcf-data-services, wcf-binding

我正在编写一个 WCF 服务应用程序，而我正在使用的前端是 winforms。

我正在尝试将 WCF 中的 SQL Express 作为数据库连接，我面临的问题是连接字符串，我在 WCF 项目的 app 文件夹下创建了一个数据库，

这是我在 wcf 项目中的连接字符串：

```
SqlConnection myConnection = new SqlConnection("Data Source=.\\SQLEXPRESS;
AttachDbFilename=\\App_Data\\Database1.mdf;
Integrated Security=True;User Instance=True"); 
```

我得到这个错误，

> SqlException 未被用户代码处理
> 
> 尝试为文件 \App_Data\Database1.mdf 附加自动命名数据库失败。存在同名数据库，或无法打开指定文件，或位于 UNC 共享上。

如何在 WCF 服务应用程序项目中附加 SQL Server Express 数据库（使用适当的连接字符串），以便使用应用程序可以查看该数据库中的数据？任何帮助都会很有帮助吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T00:27:41.307

对 SqlConnection 使用以下代码

```
 SqlConnection conn = new SqlConnection(@"data source=.\SQLEXPRESS;Integrated Security=SSPI;AttachDBFilename=|DataDirectory|\Database1.mdf;User Instance=true"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T00:53:19.300

检查这个网站：

1.  [连接字符串.com](http://www.connectionstrings.com/sql-server-2005)

2.  [连接到 sql server 数据库 mdf 文件而不在客户端机器上安装 sql server](https://stackoverflow.com/questions/2054905/connecting-to-sql-server-database-mdf-file-without-installing-sql-server-on-clie)

并尝试这个连接字符串：

```
SqlConnection myConnection = new SqlConnection("Data Source=.\\SQLEXPRESS;
Initial Catalog=Database1;
Integrated Security=True;User Instance=True"); 
```

# css - 当：target 设置为其他内容时，CSS 3 隐藏元素 - 当它为空白时显示？

> ID：10307670
> 
> 赞同：1
> 
> 时间：2012-04-25T00:04:41.237
> 
> 标签：css, css-selectors, target

只是想看看我想出的这个想法是否有一个纯 CSS3 解决方案。

基本上，如果用户导航到`http://example.com`，我想在我的页面上显示一个元素，比如`<section id="main" />`。但是，如果访问`http://example.com/#pics`，我想展示一个照片库。

我知道这可以用 JQuery 完成，但我正在尝试用 CSS3 做尽可能多的事情，这只是一个实验性网站，所以浏览器支持不是优先事项，但我对后备很感兴趣。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T02:25:37.033

此答案假定您正在选择具有“hideme”类的元素。根据您的情况进行调整。

任何类型的“如果不是”都可以用`:not()`伪类来完成。在这种情况下：

```
.hideme:not(:target) {display: none;} 
```

但是，浏览器对此的支持非常低，因此您应该这样做：

```
selector {do something}
selector:target {cancel the something} 
```

现在，这有点棘手，`display`因为不同的元素有不同的默认值，但它`visibility`是您的一个选项：

```
.hideme {visibility: hidden;}
.hideme:target {visibility: visible;} 
```

或者或另外，您可能能够使用`position:absolute`和`position:static`从文档流中删除所选项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T02:25:17.713

查看 :target 选择器和 :not 选择器

你可以做一些事情

```
div:not(:target){
  display:none
}

#main:target {
   display:block;
}

#pics:target {
    display:block;
} 
```

参考：
[http](http://www.w3.org/TR/selectors/) ://www.w3.org/TR/selectors/第 6.6.7 节是 :not 选择器（他们的文件中没有目标）

和

[http://www.w3.org/TR/selectors/#target-pseudo](http://www.w3.org/TR/selectors/#target-pseudo)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-08-22T07:25:44.463

您可以将代码包装在多个容器中，这样您就可以使用目标伪类来选择您需要的每个元素。

## 例子

```
<svg xmlns="http://www.w3.org/2000/svg" width="200" height="100" version="1.1">
<style>

/* hide elements by default */
.hide {
  display: none;
}
/* show the elements by target */
#one:target .one,
#two:target .two {
display: block;
}

/* BONUS: using this technique, you can select other elements */
#one:target .default,
#two:target .default {
display: none;
}

/* some colors... */
.one {
fill: red;
}
.two {
fill: yellow;
}

</style>
<g id="one">
<g id="two">
   <rect width="200" height="100" stroke="black" stroke-width="2" fill="green"/>
      <circle class="hide one" cx="50" cy="50" r="20"></circle>
      <circle class="hide two" cx="100" cy="50" r="20"></circle>
      <circle class="default" cx="150" cy="50" r="20"></circle>
</g>
</g>

</svg> 
```

也许这不是一个优雅的解决方案，但它确实有效。

# google-chrome - 谷歌浏览器历史 sqlite

> ID：10307673
> 
> 赞同：5
> 
> 时间：2012-04-25T00:04:51.717
> 
> 标签：google-chrome, sqlite, browser-history

数据来自 Chrome 谷歌历史文件。

我想知道表格中列的含义。所以我发现历史上一张叫做访问的表是：

```
CREATE TABLE visits(id INTEGER PRIMARY KEY,url INTEGER NOT NULL,visit_time INTEGER NOT NULL,from_visit INTEGER,transition INTEGER DEFAULhT 0 NOT NULL,segment_id INTEGER,is_indexed BOOLEAN) 
```

该表的结果是：

```
1|10|12979306250150765|0|268435457|1|0

17|14|12979306291009421|0|838860801|2|0

18|14|12979306291724492|0|805306368|0|0

19|14|12979306296042195|0|838860808|0|0

20|14|12979306296322297|0|805306368|0|0

21|14|12979306298922534|0|838860808|0|0

22|14|12979306299261896|0|805306368|0|0

23|15|12979306305614105|0|805306368|0|0

24|15|12979306310110294|0|805306368|0|1

25|16|12979306316672464|0|805306368|0|1 
```

因此，另一个名为 urls 的表也在这个历史 sqlite 中：

```
CREATE TABLE "urls"(id INTEGER PRIMARY KEY,url LONGVARCHAR,title LONGVARCHAR,visit_count INTEGER DEFAULT 0 NOT NULL,typed_count INTEGER DEFAULT 0 NOT NULL,last_visit_time INTEGER NOT NULL,hidden INTEGER DEFAULT 0 NOT NULL,favicon_id INTEGER DEFAULT 0 NOT NULL) 
```

该表的结果是：

```
1|http://cateee.net/xxxx|Linuxxxx|0|0|0|0|0
2|http://kernel.org/|Index of xxxxxxxxx|0|0|0|0|0
3|http://repo.orxxxxxxxxxxxxx|xxx|0|0|0|0|0
4|http://stackoverflow.com/xxxx|xxxxxx|7|0|12979644275181782|0|0
5|http://stackoverflow.com/questions/xxxxxxx|linuxxxxxxxxxxxxxxxx|0|0|0|0|0
6|http://www.db-class.org/xxxxxxxxxxxxxxxx|xxxxxxx|6|0|12979306496245203|0|0
7|http://www.xxxxxxxxxxxxxxxxxxx|xxxxxxxxxxxxxxxxxx|0|0|0|0|0
8|http://www.xxxxxxxxxxxxxxxx|xxxxxxxxxxxxxxxxxxx|0|0|0|0|0
10|http://www.google.com/|PYTHON - Googlexxxxxxxxx|1|1|12979306250150765|0|0
14|http://www.facebook.com/|Facebook|6|2|12979306750272709|0|0
     15|http://www.facebook.com/profile.phpxxxxxxxxx|xxxxxxxxxxxxxxx|2|0|12979306310110294|0|0 
```

所以我的问题是：urls表的第一列叫url_id是否代表visits表的第二列叫url INTEGER，但关系不清楚。还有visits表中transition INTEGER是什么意思，能不能从这些表中提取时间，需要从这些表中得到有用的信息，搞清楚它们的关系。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-22T08:56:13.633

[这个网站](https://www.sans.org/blog/google-chrome-forensics/)有很多关于 Chrome 的 SQLite 表的有用信息，以及如何查询这些表。

他们在该页面上给出的加入两个表“urls”和“visits”的示例如下：

```
SELECT urls.url, urls.title, urls.visit_count, urls.typed_count, urls.last_visit_time, urls.hidden, visits.visit_time, visits.from_visit, visits.transition
FROM urls, visits
WHERE
 urls.id = visits.url 
```

至于访问表中的“转换”字段，该值告诉您 URL 是如何加载到浏览器中的。我会让您查看我给您的链接以获取更多详细信息。

# android - 即使没有错误，Eclipse 也不会生成 R.java

> ID：10307675
> 
> 赞同：3
> 
> 时间：2012-04-25T00:05:19.177
> 
> 标签：android, eclipse, intellij-idea

我刚刚更新到 Ubuntu 12.04 LTS，并安装了 Eclipse（通过 Ubuntu 软件中心）。我还在 Eclipse 上安装了 Android SDK 和插件，但是，我向它导入了一个旧项目（之前工作正常），它甚至没有生成 R.java 文件。

在`gen/<my-package>`目录中只有一个名为`BuildConfig.java`.

我尝试从我的 xml 文件以及 Build、Clean 等中删除所有警告，但它不起作用。

我不知道我是否缺少一些库或什么，因为在我安装 Ubuntu 12.04 LTS 之前，该项目已在 Eclipse 上执行更正。

**我尝试创建一个新项目并检查它是否创建了 R.java 文件，但是，它没有被创建。也许问题出在日食上。**

* * *

**更新**

IntelliJ 也发生了同样的问题。

* * *

请帮我解决这个问题。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T08:46:17.580

如果它不起作用并且您认为您尝试了所有方法，请先关闭您的 Eclipse 安装（卸载并重新安装）。
如果删除并重新安装插件不起作用，请重命名您的`~/.eclipse`文件夹并重新开始。
如果这不起作用，请删除工作区中的 .metadata 文件夹......然后重新开始。
*（您将不得不重新导入所有项目）*

从存储库安装 Eclipse（我正在使用来自软件中心和 openJDK 的 eclipse）。
如果您正在运行 x64：`sudo apt-get install ia32-libs-multiarch`

**作为 root**启动 eclipse 以获取最新的平台/PDT 更新（它们在 /usr 的某个地方，所以你需要是 root）。
关闭 eclipse（可选择删除`/root/.eclipse`文件夹）。

以非 root 身份启动 eclipse。
安装插件。它们将在您的 ~/.eclipse 目录中。

**如果已经安装**
移除 Window->Android Manager 中
的所有组件 更新插件通过：
Help->Install Software->Already installed -> Show updates -> Install
重新安装所有组件。

**如果尚未安装**
通过帮助安装软件菜单安装 ADT 插件。有了[这个](http://dl-ssl.google.com/android/eclipse/)链接。
选择在 ADT 安装期间安装 SDK。
如果安装的任何部分出现错误，请卸载并安装该部分。

安装所有更新。
如果更新的任何部分给您带来错误，请卸载并安装该部分。

这实现了以下结果。
![数据管理系统](../Images/246b3abbca2cbb6ae8975883be256b45.png)
![是的，它有效](../Images/6634c17f1e3d1cde873a17f0464019c8.png)
版本：
![版本号](../Images/7bef18e3d3bb4f049e3ac2e3a0a6cfac.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T12:22:11.743

就我而言，它发生在我一开始安装错误之后。我用的是 64 位 Linux Ubuntu 机器

1.  安装32位eclipse
2.  [在http://developer.android.com/sdk/installing/adding-packages.html](http://developer.android.com/sdk/installing/adding-packages.html)之后添加了平台和包
3.  安装了 64 位 eclipse，因为我遇到了 32 位 eclipse 操作的问题。但我没有发现这`android-sdk-linux/platform` `tools/adb`是一个 32 位的可执行文件。试图从终端运行它会导致奇怪的消息：“没有这样的文件或目录”

解决办法是去掉第2步的结果，用64位eclipse重新启动。

我刚刚重命名`android-sdk-linux`并再次解包以删除步骤 2 的结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-04T12:12:41.267

发生这种情况的原因之一通常是交换空间......确保你有一个交换分区并且它有足够的大小我的显示类似的问题但是每次我清理我的项目时，R都会消失并且不会出现背部。交换分区解决了我的 aapt 问题。

# php - PHP if Month Equals then Echo CSS Style

> ID：10307676
> 
> 赞同：0
> 
> 时间：2012-04-25T00:05:26.577
> 
> 标签：php, date, loops

我通常会在 jQuery 中做这种事情，但这需要服务器端的触摸。我是 PHP 新手，需要帮助编写一个需要数字月份的基本脚本，`the_time('m')`我只想说它是否等于 01 `echo "#000"`，然后循环遍历其他月份 02、03、04，依此类推，让它们回显不同如果月份相同，则为十六进制代码。

原谅我粗鲁且不正确的代码，但我认为这将有助于可视化我正在努力的解决方案。

```
style="background: #
<?php 
if(the_time('m') == "01") { 
    echo "000";
} else if (the_time('m') == "02"){
    echo "111";
} // so on through 12
?>
" 
```

任何帮助将不胜感激。谢谢你。

编辑我目前在里面的while循环代码：

```
<?php while ( have_posts() ) : the_post(); ?>
<?php
$code = "f5f5f5"; // Set default
$month = the_time('m');

switch ($month) {
        case "01" :
    $code = "f5f5f5";
            break;

    case "02" :
    $code = "f3f3f3";
    break;

    case "03" :
    $code = "f1f1f1";
    break;

    case "04" :
    $code = "efefef";
    break;

    }
?>

<li id="event_<?php the_time('m_d_Y') ?>" style="background: #<?php echo $code ?>;"> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-25T00:10:11.290

我不会真的走这条路，但我会做类似的事情：

```
<div class="month-<?php echo strtolower(date('M')) ?>">Howdy</div>

// your CSS file:
.month-jan { background: #000; }
.month-feb { background: #FFF; }
// etc 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T00:10:53.630

尝试

```
<?php
$code = "000"; // Set default
$month = date ( "m" );

switch ($month) {
    case "02" :
        $code = "111";
        break;

    case "03" :
        $code = "CCC";
        break;

    case "04" :
        $code = "FFF";
        break;

}
?>
style="background: #<?php echo $code ?>" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T00:09:00.133

```
switch (date('n')) {
    case 1:
        echo "000";
        break;
    case 2:
        echo "111";
        break;
    ...
} 
```

或者，更简单：

```
$colors = array(
    1 => "000",
    2 => "111",
    ...
);
echo $colors[date('n')]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-25T00:14:41.193

用php的日期函数取月份，减一，转换为十六进制，重复3次。

```
echo printf('%1$'.base_convert(date('n') - 1, 10, 16).'3d', date('n') - 1); 
```

这有点棘手和迟钝，但你避免需要一个`switch`或一大块`elseif`s

# objective-c - NSDateFormatter setDateFormat 非零填充月份数

> ID：10307685
> 
> 赞同：8
> 
> 时间：2012-04-25T00:06:01.587
> 
> 标签：objective-c, nsdateformatter, zero-pad

是否可以使用 获得非零填充的月份数`setDateFormat`？

如果没有，您能否提供替代解决方案？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-25T00:11:01.647

在格式字符串中使用`M`而不是。`MM`如果使用两个字母，则指定结果应该有两位数，如果不使用，则结果可以有一位或两位数。

# xcode - 从横向启动故事板应用程序

> ID：10307687
> 
> 赞同：0
> 
> 时间：2012-04-25T00:06:14.360
> 
> 标签：xcode, orientation, launch, portrait

我刚刚遇到了关于我的应用程序如何启动的问题。即使我选择了从纵向启动，我的应用程序总是以横向视图启动，并且我必须旋转我的 iPod 以使其切换到纵向。我主要在我的应用程序的情节提要部分工作，并且没有太多代码观点。我需要输入一些代码才能从纵向启动吗？谢谢，我是初学者，非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T00:29:50.370

确保您遵循以下 3 个步骤：

1) 在 .plist 文件中，确保横向被列为支持的方向之一。

2）在该视图的视图控制器上，确保您的代码为应该自动旋转返回yes ...

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation{    
    return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
} 
```

3) 在 IB 上选择您的初始视图，然后在属性检查器的第四个选项卡上，在模拟指标下确保选择了 Orientation Landscape。

# objective-c - 如何访问在类扩展中声明的变量？

> ID：10307689
> 
> 赞同：7
> 
> 时间：2012-04-25T00:06:38.550
> 
> 标签：objective-c, lldb

*MyClass.h*：

```
@interface MyClass : NSObject
@end 
```

*MyClass.m*：

```
// Define a private variable in a class extension
@interface MyClass () {
    NSString *name;
}
@end 
```

然后在 lldb 中：

```
(lldb) po myClassInstance->name
error: 'MyClass' does not have a member named 'name'
error: 1 errors parsing expression 
```

那么如何在调试器中访问该变量呢？

使用 xcode 4.3.2

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-26T03:03:28.310

`(lldb) po [myClassInstance valueForKey:@"name"]`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-09T06:05:10.400

直接干净地访问这些实例变量的唯一方法是通过提供有用功能的 Objective-C 运行时`object_getInstanceVariable`。该值通过引用传回，并且可以是许多不同的类型，因此在调试器中它不是很有用。但是你的问题启发了我想出一个解决方案。

我在 NSObject 上编写了一个类别，允许您从调试器内省实例变量，而不必担心访问器的副作用。将类别添加到项目后，您可以执行以下操作：

```
(lldb) po [self valueOfInstanceVariable:@"_name"]
IMG_4078.PNG 
```

这是代码：

NSObject+IvarIntrospection.h

```
#if DEBUG
#import <Foundation/Foundation.h>

@interface NSObject (IvarIntrospection)

- (id)valueOfInstanceVariable:(NSString *)ivarName;

@end

#endif 
```

NSObject+IvarIntrospection.m

```
#if DEBUG
#import "NSObject+IvarIntrospection.h"
#import <objc/runtime.h>

@implementation NSObject (IvarIntrospection)

- (id)valueOfInstanceVariable:(NSString *)ivarName {
    // Get the value of the instance variable
    // Use a union in order to convert the value to a float or double (see http://en.wikipedia.org/wiki/Type_punning)
    union {
        void *value;
        float f;
        double d;
    } ivar;
    Ivar ivarInfo = object_getInstanceVariable(self, [ivarName UTF8String], &ivar.value);

    // If the instance variable doesn't exist, try adding an underscore
    if (!ivarInfo && ![ivarName hasPrefix:@"_"]) {
        NSString *underscoredIvarName = [@"_" stringByAppendingString:ivarName];
        NSLog(@"Instance variable '%@' does not exist. Perhaps you meant '%@?' Let's try that.", ivarName, underscoredIvarName);

        return [self valueOfInstanceVariable:underscoredIvarName];

    // If there's already an underscore, error
    } else if (!ivarInfo) {
        NSLog(@"Instance variable '%@' does not exist.", ivarName);
        return nil;
    }

    // Figure out what type the instance variable is and return a sensible representation
    const char *type = ivar_getTypeEncoding(ivarInfo);
    switch (type[0]) {
        case 'c':
            return [NSNumber numberWithChar:(char)ivar.value];
        case 'i':
            return [NSNumber numberWithInt:(int)ivar.value];
        case 's':
            return [NSNumber numberWithShort:(short)ivar.value];
        case 'l':
            return [NSNumber numberWithLong:(long)ivar.value];
        case 'q':
            return [NSNumber numberWithLongLong:(long long)ivar.value];
        case 'C':
            return [NSNumber numberWithUnsignedChar:(unsigned char)ivar.value];
        case 'I':
            return [NSNumber numberWithUnsignedInt:(unsigned int)ivar.value];
        case 'S':
            return [NSNumber numberWithUnsignedShort:(unsigned short)ivar.value];
        case 'L':
            return [NSNumber numberWithUnsignedLong:(unsigned long)ivar.value];
        case 'Q':
            return [NSNumber numberWithUnsignedLongLong:(unsigned long long)ivar.value];
        case 'f':
            return [NSNumber numberWithFloat:ivar.f];
        case 'd':
            return [NSNumber numberWithDouble:ivar.d];
        case '*':
            return [NSString stringWithUTF8String:(const char *)ivar.value];
        case '@':
        case '#':
            return (id)ivar.value;
        case ':':
            return NSStringFromSelector((SEL)ivar.value);
        default:
            return [NSValue valueWithBytes:&ivar.value objCType:type];
    }
}

@end

#endif 
```

请注意，编译发布时该类别将被自动禁用（感谢调试宏）。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-04-26T02:57:09.003

如果您需要`name`从`MyClass`方法外部访问，则需要定义方法来访问它。您可以只编写名为`(NSString*) name`and的方法`- (void) setName:(NSString*) newName`，但定义属性和合成它们更容易。

在*MyClass.h*中，您定义了一个属性。对于字符串，您通常制作它们`copy`：

```
@interface MyClass : NSObject

@property (copy) NSString* name;

@end 
```

在*MyClass.m*中，您仍然使用带有 ivar 的接口声明：

```
@interface MyClass () {
    NSString *name;
}
@end 
```

但是，您还需要*合成*新属性。这将创建用于检索和设置*name*的方法：

```
@implementation MyClass

@synthesize name = name;

@end 
```

作为约定，通常在 ivar 的开头或结尾放置下划线，因此在接口中您将拥有`NSString *_name;`，而在实现中您将拥有`@synthesize name = _name`。这有助于避免在您指的是属性时意外使用 ivar。

您现在可以访问您的*name*属性：

```
MyClass me = [[[MyClass alloc] init] autorelease];
[me setName:@"My name"];
NSLog(@"Name = %@", [me name]); 
```

Objective-C 属性是该语言的一个强大功能，但它们确实有一些你必须学习的怪癖。尝试在网络上搜索“objective-C”、“properties”和“synthesize”的组合。

如果您仍然有编译器错误，请使用您访问的代码部分编辑您的问题`name`。

# delphi - 快速报表是否支持在合成报表中混合纵向和横向？

> ID：10307692
> 
> 赞同：2
> 
> 时间：2012-04-25T00:07:12.580
> 
> 标签：delphi, printing, quickreports

您可以使用 Quick Reports Pro 组合纵向报告和横向报告吗？

**快速报告帮助文件片段：**

处理这种情况的方法是使用**TQRCompositeReport**组件。将一个放在要开始打印的表单上。首先，您需要为其 OnAddReports 事件定义一个处理程序，该事件调用**TQRCompositeReport.Add**方法来添加您需要打印的所有 TQuickRep 组件。假设您要打印的报告保存在名为 RepNewCust、RepOrderSummary 和 RepStockReorder 的表单上，并且在每种情况下，表单上的 TQuickRep 组件都称为“报告”（请参阅​​下面的“TQuickRep 详细信息”部分了解您可能这样做的原因） . 然后您的 OnAddReports 事件处理程序应如下所示

```
 procedure TForm1.QRCompositeReport1AddReports(Sender: TObject);
begin
  QRCompositeReport1.Reports.Add(RepNewCust.Report);
  QRCompositeReport1.Reports.Add(RepOrderSummary.Report);
  QRCompositeReport1.Reports.Add(RepStockReorder.Report);
end;
```

现在您可以调用 QRCompositeReport1.Print 将所有三个报表一次打印出来，然后调用 QRCompositeReport1.Preview 一起预览它们。还有 TQRCompositeReport 组件属性，可让您设置纸张大小并为复合报告设置整体标题 - 基本上是您在一个地方处理多个报告的输出所需的一切。

我想在纵向和横向之间混合如下：

RepNewCust.Report（纵向）
RepOrderSummary.Report（纵向）
RepStockReorder.Report（横向）

这可以做到吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T22:48:47.273

**这是做不到**的。我收到了开发者的以下回复：

> 你好，
> 
> 目前的代码无法做到这一点。我不知道为什么，但混合报告方向是行不通的。
> 
> 问候，
> QBS 软件有限公司

# regex - 字符字段分隔符 AWK 的最后一次出现

> ID：10307693
> 
> 赞同：1
> 
> 时间：2012-04-25T00:07:13.943
> 
> 标签：regex, bash, awk, find

我正在使用 find 命令来查找某种格式的所有文件，该命令是黄金。我将该输出通过管道传输到 awk 命令中，并且我想使用最后一个下划线作为字段分隔符。问题在于，根据文件所在的路径，事实之前可能会有一两个下划线。

```
find . -regex ".*prob[0-9]*_.*" | awk 'BEGIN { FS = "_.*$" } { print $1 " " $2 }' 
```

我知道我的字段分隔符中的正则表达式有什么问题，它认为在下划线和后面的任何内容上分开，是否只指定单个字符本身。此外，我如何专门在最后一次出现的字符上使用字段分隔符。

这在某种程度上是我之前提出的问题的扩展： [管道回显时抑制输出到 StdOut](https://stackoverflow.com/questions/10304594/suppress-output-to-stdout-when-piping-echo)

我得到的文件通常是这样的，皱纹是目录也可以有下划线：/the/directory/probXXXXX_XX

其中 X 是任意整数。

我一直在考虑的一种解决方法是在每个下划线处分开，然后打印每一列......不过，我宁愿让它在上面的方法中工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T00:11:12.033

`awk`一个不明显的技巧`$`是操作符。您可以将它与变量甚至表达式一起使用，尤其是与涉及预定义变量的表达式一起使用`NF`： `$NF`获取最后一个字段，`$(NF - 1)`倒数第二个字段。

# python - 如何将变量放入 Python 文档字符串

> ID：10307696
> 
> 赞同：71
> 
> 时间：2012-04-25T00:07:46.693
> 
> 标签：python, docstring

所以我试图创建一个“动态”的文档字符串，它是这样的：

```
ANIMAL_TYPES = ["mammals", "reptiles", "other"]

def func(animalType):
""" This is a sample function.

    @param animalType: "It takes one of these animal types %s" % ANIMAL_TYPES
""" 
```

基本上让文档字符串`@param animalType`显示任何`ANIMAL_TYPES`内容；这样当这个变量被更新时，文档字符串就会自动更新。

不幸的是，它似乎不起作用。有谁知道是否有办法实现这一目标？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-04-25T01:54:23.307

一种方法是使用装饰器。我不确定我对此有何感想；我实际上搜索了关于这种方法的评论并找到[了这个答案](https://stackoverflow.com/a/9745145/577088)，它正确地指出它可能掩盖了一个设计问题。但是乍一看，您的用例对我来说*似乎是合理的。*

无论如何，这是一种相当优雅的方式来实现您正在寻找的结果：

```
>>> def docstring_parameter(*sub):
...     def dec(obj):
...         obj.__doc__ = obj.__doc__.format(*sub)
...         return obj
...     return dec
... 
>>> @docstring_parameter('Ocean')
... def foo():
...     '''My Docstring Lies Over The {0}'''
...     pass
... 
>>> @docstring_parameter('Sea')
... def bar():
...     '''My Docstring Lies Over The {0}'''
...     pass
... 
>>> @docstring_parameter('Docstring', 'Me')
... def baz():
...     '''Oh Bring Back My {0} To {1}'''
...     pass
... 
>>> foo.__doc__
'My Docstring Lies Over The Ocean'
>>> bar.__doc__
'My Docstring Lies Over The Sea'
>>> foo.__doc__
'My Docstring Lies Over The Ocean'
>>> baz.__doc__
'Oh Bring Back My Docstring To Me' 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-04-25T00:13:20.773

三引号字符串是一个大字符串。在它们内部没有进行任何评估。该`%`部分是字符串的所有部分。你需要让它在实际的字符串上运行。

 ~~~~```
def func(animalType):
    """
    This is a sample function.

    @param animalType: "It takes one of these animal types %(ANIMAL_TYPES)s"
    """ % {'ANIMAL_TYPES': ANIMAL_TYPES} 
```~~ 

~~不过，我不确定这是否会正常工作；文档字符串有点神奇。~~ 这*行不通*；docstring 在编译时被评估（作为函数中的第一条语句，因为它是一个字符串文字——一旦它得到`%`它，它就不仅仅是一个字符串文字），字符串格式化发生在运行时，所以`__doc__`将为空：

```
>>> def a(): 'docstring works'
... 
>>> a.__doc__
'docstring works'
>>> def b(): "formatted docstring doesn't work %s" % ':-('
... 
>>> b.__doc__
>>> 
```

如果您想以这种方式工作，则需要`func.__doc__ %= {'ANIMAL_TYPES': ANIMAL_TYPES}`在定义函数之后进行。`python -OO`请注意，如果您不检查`__doc__`已定义的内容，那么这将中断，因为`-OO`剥离文档字符串。

```
>>> def c(): "formatted docstring works %s"
... 
>>> c.__doc__
"formatted docstring works %s"
>>> c.__doc__ %= 'after'
>>> c.__doc__
"formatted docstring works after" 
```

无论如何，这不是标准技术。标准技术是引用适当的常量：“采用 ANIMAL_TYPES 中的一种动物类型”，或类似的。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-04-25T00:20:57.163

您还可以使用定义文档字符串`.__doc__`

例如：

```
>>> def f():
      pass
>>> x = 1
>>> y = "docstring"

>>> f.__doc__ = "%s string %s" % (x, y)
>>> print(f.__doc__)
1 string docstring 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-14T13:32:57.480

您可以简单地在您的文档字符串中使用[交叉引用](http://www.sphinx-doc.org/en/master/usage/restructuredtext/domains.html#cross-referencing-syntax)来引用该变量。

所以：

```
:param animalType: It takes one of these :data:`animal types<ANIMAL_TYPES>` 
```

在第二个：

```
:param choice: can be one of :attr:`MY_CONST` 
```~~

# ruby-on-rails - 无法理解自动生成的黄瓜步骤

> ID：10307698
> 
> 赞同：0
> 
> 时间：2012-04-25T00:08:37.660
> 
> 标签：ruby-on-rails, ruby, cucumber, capybara

我有一部分功能

```
And I should see "Thank you for your interest. We will soon send an email with activation instructions." within "span class="notificationText"" 
```

和

自动生成的步骤

```
Then /^I should see "([^"]*)" within "([^"]*)"notificationText"([^"]*)"$/ do |arg1, arg2, arg3|
end 
```

我无法解释它。我正在尝试在其中进行以下测试（来自[http://www.cowboycoded.com/2011/01/05/better-web-steps-for-cucumber-with-capybara/](http://www.cowboycoded.com/2011/01/05/better-web-steps-for-cucumber-with-capybara/)），但无法理解哪些论点代表什么。

```
 with_scope(select,:css_id) do
      page.should have_selector("h1",:text=>text)
  end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T04:54:46.643

实际上 cucumber 是根据我们在特征文件中给出的内容生成脚本文件的，所以在这个文件中，无论我们在单引号或双引号中使用了一些文本，这些文本都被视为动态文本，因此每个引用的文本都可以被视为动态文本论据

这些参数将由用户在运行时传递。

# jquery - 对动态生成的表单使用 jQuery 表单验证 equalTo 规则

> ID：10307700
> 
> 赞同：0
> 
> 时间：2012-04-25T00:08:51.047
> 
> 标签：jquery, validation

我在一页上有 n 个表格。每个都有两个电子邮件地址字段（普通字段和验证）。**我想要做的是为这两个字段设置一个 equalTo 规则。**我现在正在做的是这样的：

```
$(".contactform").validate({
   onsubmit: true,
   onkeydown: false,
   onkeyup: false,
   onfocusin: false,
   onfocusout: false,
   onchange: false,
   onclick: false,
      rules: {
         email_veri: {
            equalTo: ".email"
         }
      }
}); 
```

但这显然是行不通的，因为 email 和 email_veri 的 id 在每种形式中都不同。我读到可以直接在字段上设置验证规则，但我不知道如何。我希望有人能帮帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T01:54:34.400

这可能很有用，来自[http://www.epalla.com/2009/12/jquery-validation-with-multiple-forms/上的“使用多个（大部分）相同表单的 jQuery 验证”](http://www.epalla.com/2009/12/jquery-validation-with-multiple-forms/)

他们的答案是分别验证每个表格：

```
$(".question_form").each(function() {
    $(this).validate(
        rules: {
            email_veri: {
                equalTo: ".email"
        }
    );
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T01:25:38.530

Hiya为您创建了一个非常简单的**演示：http:** [//jsfiddle.net/bY5P6/](http://jsfiddle.net/bY5P6/)

因此，如果您输入不同的电子邮件和电子邮件验证字段，那么您将获得`equal to`消息验证。

它的进一步文档： http: [//docs.jquery.com/Plugins/Validation/Methods/equalTo](http://docs.jquery.com/Plugins/Validation/Methods/equalTo)

或者对于多个表单，请参见此处：[使用 JQuery Validate Plugin 验证具有相同名称的多个表单字段](https://stackoverflow.com/questions/931687/using-jquery-validate-plugin-to-validate-multiple-form-fields-with-identical-nam)

如果您使用多种表格，请确保**报价**：

> 验证要求字段名称是唯一的，除了单选按钮和复选框。

:) ！

**jQuery代码**

```
//================================= AZIONE FORM
$('#submit').click(function() {
    $('#mailer').submit();
    return false;
});

//================================= VALIDAZIONE FORM
$('#mailer').validate({
    focusInvalid: false,
    debug: true,
    rules: {
        name: {
            required: true
        },
        email_address: {
            required: true,
            email: true
        },
        email_address_veri: {
            required: true,
            email: true,
            equalTo: ".email"
        },
        request: {
            required: true
        }
    },
    messages: {
        name: {
            required: 'name required'
        },
        email_address: {
            required: 'email required',
            email: 'email address is not valid'
        },
        email_address_veri: {
            required: 'email required',
            email: 'email address verification is not valid',
            equalTo: "Please enter the same email as above"
        },
        request: {
            required: 'request required'
        }
    }
});​ 
```

**HTML**

```
<!doctype html>
<html class="no-js" lang="en">
    <head>
        <meta charset="utf-8">
        <title></title>
    </head>
    <body>

        <form action="#" method="post" id="mailer" autocomplete="off">
            <label>
                <span>name</span>
                <input type="text" name="name" required="required" value="" />
            </label><br /><br />
            <label>
                <span>email</span>
                <input type="email" name="email_address" class="email"  value="" />
            </label><br /><br />
            <label>
                <span>email Verification</span>
                <input type="email" name="email_address_veri"  value="" />
            </label><br /><br />
            <label>
                <span>request</span>
                <textarea name="request" required="required"></textarea>
            </label><br /><br />
            <a href="javascript:;" id="submit">submit</a>

        </form>

    </body>
</html>
​ 
```

**输出**

![在此处输入图像描述](../Images/ac7a884ce4fb10893326b8a8eccd6266.png)

# entity-framework - 对使用 Code First 和 EF 的 DBMigrations 有点困惑

> ID：10307703
> 
> 赞同：0
> 
> 时间：2012-04-25T00:09:03.183
> 
> 标签：entity-framework, entity-framework-4

我有一个我创建并启用迁移的项目。它是用 4.3 创建的，所以我认为它是最新的。我在执行更新的上下文的构造函数中有一些代码（请参见下面的代码），并且每次我添加诸如可为空的字符串列之类的内容或执行不以不一致的方式更改数据库的操作时似乎都可以工作。我的场景是我改变了我的模型，当我观察 sql 跟踪时，它会自动为我改变列。

我的问题是我想做“向上”和“向下”方法，但对它们何时运行感到困惑。也就是说我现在在版本1，我在我的“up”方法中放了一些代码来添加一列，然后当我想转到版本3时，它怎么知道要调用哪个“up”方法？

使困惑。-彼得

```
namespace MigrationsAutomaticDemo.Migrations
{
using System.Data.Entity.Migrations;

public partial class AddBlogRating : DbMigration
{
    public override void Up()
    {
        AddColumn("Blogs", "Rating", c => c.Int(nullable: false, defaultValue: 3));
    }

    public override void Down()
    {
        DropColumn("Blogs", "Rating");
    }
}
} 
```

,

```
 public SiteDB()
    {
        UpdateDatabase();
    }

    // http://joshmouch.wordpress.com/2012/04/22/entity-framework-code-first-migrations-executing-migrations-using-code-not-powershell-commands/
    public static int IsMigrating = 0;
    private static void UpdateDatabase()
    {
        if (0 == Interlocked.Exchange(ref IsMigrating, 1))
        {
            // Manually creating configuration: 
            var migratorConfig = new DbMigrationsConfiguration<SiteDB>(); 
            migratorConfig.AutomaticMigrationsEnabled = true;

            // Using configuration defined in project: 
            //var migratorConfig = new DbMigrationsConfiguration();

            // 3 
            //var dbMigrator = new DbMigrator(new Settings()); 
            var dbMigrator = new DbMigrator(migratorConfig);
            dbMigrator.Update();

            Interlocked.Exchange(ref IsMigrating, 0);
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T07:02:42.033

如果您在迁移配置中启用自动迁移，则无需指定目标迁移。迁移器将根据当前上下文和目标数据库的快照自动构建更改。

```
var migratorConfig = new DbMigrationsConfiguration<SiteDB>();
migratorConfig.AutomaticMigrationsEnabled = true; 
```

在您的情况下，您希望通过使用特定迁移来升级数据库。您需要做的就是明确提及要升级的迁移。

```
Configuration configuration = new Configuration();
DbMigrator migrator = new DbMigrator(configuration);
migrator.Update("201204250656061_AddBlogRatingVersion2");
migrator.Update("201204250656061_AddBlogRatingVersion3");
migrator.Update("201204250656061_AddBlogRatingVersionX"); 
```

# php - 如何从表中执行计数，然后使用 PHP 显示计数值？

> ID：10307705
> 
> 赞同：0
> 
> 时间：2012-04-25T00:09:21.183
> 
> 标签：php, mysql, html, sql

目前我有两个表A和B。DID由用户输入到一个输入中，这是我程序中的第一个提示，输入DID。

A 包含 PID、DID 和 MaxOccupancy。PID 是专业 id，DID 是部门 id。B 包含 CID、DID 和 PID。CID 为客户端 ID，DID 和 PID 相同。

我正在将第一个表中的数据输出到一个显示所有数据的 html 表中。

但是，我无法计算表二中的 PID 数量。我有`$countB= mysql_query ("select count (PID) from B where DID=('$_POST[DID])");`

然后我在写

```
while($row = mysql_fetch_array($countB))
  {
  echo "Current occupancy:".$row['count(PID)'].;
  } 
```

有人能帮我吗？我如何在查询中查询计数以获取用户在输入框中为 DID 输入的内容？我做错了吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T00:16:35.450

尝试

```
$countB= mysql_query (sprintf("SELECT COUNT(PID) as total FROM B WHERE DID=('%s')",mysql_real_escape_string($_POST['DID'])));
$row = mysql_fetch_array($countB);
echo $row['total'] ; 
```

**注意 .. 总是过滤 SQL 注入**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T00:16:39.523

`COUNT`您可以为可以在 PHP 中访问的结果创建别名：

```
mysql_query ("select count (PID) as PIDcount from B where DID=('$_POST[DID])");
// then reference it later
$row['PIDcount']; 
```

查询中的使用`$_POST[DID]`也受[SQL 注入](https://stackoverflow.com/questions/332365/xkcd-sql-injection-please-explain)的影响。

# php - 使用变量变量将数据插入静态变量时出现PHP错误

> ID：10307711
> 
> 赞同：0
> 
> 时间：2012-04-25T00:09:59.727
> 
> 标签：php, arrays, class, static-methods, variable-variables

我不太擅长这个，所以我敢肯定这是一个愚蠢的问题。

我有一堂课：

```
class debug {
  private static $messages = array();
  private static $errors = array();
  private static $all = array(); // includes both of above
  private static $types = array('messages','errors');
  public static function add($type, $message) {
    if(!in_array($type,self::$types) ) {
      self::add('errors','Bad type "' . $type . '" specified when sending this message: ' . $message);
      return false;
    }
    self::$$type[] = $message; // ERROR IS HERE (see below)
    self::$all[] = $message; // no error
  }

} 
```

我从另一个类中调用它以进行调试（惊喜）。

```
debug::add('error', 'Error in ' . __FILE__ . ' on line ' . __LINE__); 
```

来自 error.log 的 PHP 错误消息：

PHP 致命错误：无法使用 [] 读取第 1248 行的 /var/www/lib/lib.php

它指的是调试类中的上述指定行。

编辑：

我想要做的是使用变量变量（因此发布标题）来确定要向哪个静态数组添加数据。

即如果 $type == 'messages'，那么 $$type == $messages。

所以我想要 self::$$type[] == self::$messages[]

或者如果 $type == 'errors'，那么 $$type == $errors 和 self::$$type[] == self::$errors[]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T00:15:10.327

将以下行更改为。这可确保首先将`$type`其评估为“消息”或“错误”。

```
self::${$type}[] = $message; 
```

为了对此进行扩展，这是我拥有的代码。您的代码中似乎存在导致其他故障的其他语法错误，但这就是为什么`$$type[]`给您该错误的原因。

```
class debug {
    public static $messages = array();
    public static $errors = array();
    public static $all = array(); // includes both of above
    private static $types = array('messages','errors');
    public static function add($type, $message) {
        self::${$type}[] = $message;
        self::$all[] = $text;
    }
}

debug::add('messages', "Regular Message");
debug::add('errors', "Error Message");

print_r(debug::$messages);
print_r(debug::$errors); 
```

这是我得到的输出

```
Array
(
    [0] => Regular Message
)
Array
(
    [0] => Error Message
) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T00:22:53.277

2 错误

A.`if(!in_array($type,self::$types) ) {`没有正确关闭..你在最后使用了`)`insted`}`

B.`self::$all[] = $text;` `$text`没有在脚本的任何地方定义

尝试

```
class Debug {
    private static $errors = array ();
    private static $types = array (
            'messages',
            'errors' 
    );
    public static function add($type, $message) {
        if (! in_array ( $type, self::$types )) {
            return false;
        }
        self::$errors [$type][] = $message; // results in error (see below)
    }

    public static function get($type = null) {
        if (! in_array ( $type, self::$types ) && $type !== null) {
            return false;
        }

        return ($type === null) ? self::$errors : self::$errors [$type] ;
    }   
}

debug::add ( 'errors', 'Error in ' . __FILE__ . ' on line ' . __LINE__ );
debug::add ( 'messages', 'Error in ' . __FILE__ . ' on line ' . __LINE__ );

var_dump(debug::get());
var_dump(debug::get("messages")); 
```

# java - Java 有关系

> ID：10307721
> 
> 赞同：2
> 
> 时间：2012-04-25T00:10:42.997
> 
> 标签：java, inheritance, relationship

以下陈述是否正确。“一个人有一个最好的朋友是一只狗。”

```
public class Mann {
     private BestFriend dog;
     //etc
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T00:15:23.477

我想说这样写会更正确：

```
public class Man extends Entity {
     private Entity bestFriend = new Dog(); // Where Dog extends Entity
     //etc
} 
```

为什么？假设您有一堆不同的实体，例如`Man`、`Cat`和`Dog`。然后让它们各自扩展一个`Entity`类是有意义的，该类指定每个实体应具有的各种属性。那么，每个人都可以有一个`bestFriend`属性，可以是任何其他`Entity`的。

`bestFriend`但是，正如评论中所指出的，允许在构造函数中指定 a 会更正确：

```
public class Man extends Entity {
    private Entity bestFriend;

    public Main(Entity bestFriend) {
        this.bestFriend = bestFriend;
    }
    //etc
}

...

Dog bobDog = new Dog();
Man bob = new Man(bobDog); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T00:14:14.233

看起来 Dog 应该按类型，因为男人可以有其他“最好的朋友类型”：

```
public class Mann {
     private Dog bestFriend;
     //etc
} 
```

**更新**

最接近真实的实现将如下所示：

```
public interface Friend {}

public class Man implements Friend {}

public class Dog implements Friend {}

public class FriendRelationship {
    private Friend first;
    private Friend second;

    public FriendRelationship(Friend first, Friend second) {
        this.first = first;
        this.second = second;
    }
}

Man aPerson = new Man();
Dog aBog = new Dog();
FriendRelationship bestFriends = new FriendRelationship(aPerson, aDog); 
```

这种方式可以表达任何实体之间的朋友关系。不需要通用基类。您只需要实现`Friend`接口。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T00:14:10.023

在 man 中多加一个“n”，否则它似乎是合理的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-25T00:29:55.187

```
public class Man extends world.life.animalia.chordata.mammalia.primates.hominidae.hominini.homo.Homo_sapiens {
    private world.life.animalia.chordata.mammalia.carnivora.canidae.canis.c_lupus.CanisLupusFamiliaris dog = new world.life.animalia.chordata.mammalia.carnivora.canidae.canis.c_lupus.CanisLupusFamiliaris();
    private concept.population.social.Friend bestFriend = dog;
} 
```

这样 bestFriend 是指向狗的指针（或引用）。

# javascript - EmberJS/HandlebarsJS 的自定义 for 循环助手

> ID：10307723
> 
> 赞同：0
> 
> 时间：2012-04-25T00:10:53.707
> 
> 标签：javascript, ember.js, handlebars.js

两个小时前，我开始了：[嵌套 HandlebarsJS #each helpers with EmberJS not working](https://stackoverflow.com/questions/10306063/nested-handlebarsjs-each-helpers-with-emberjs-not-working)

在我自己想出一个可以接受的临时解决方案后不久，问题仍然没有得到解答。我的问题并没有就此停止。

我现在正在尝试制作一个自定义助手，它将遍历一组对象，但不包括第一个索引 - 几乎：`for(i = 1; i < length; i++) {}`. 我在网站上读过，您必须获取上下文的长度并将其传递给选项 - 考虑到您的函数看起来像：`forLoop(context, options)`.

然而，上下文是一个字符串而不是一个实际的对象。当您执行 a`.length`时，您将获得字符串的长度，而不是数组的大小。当我将它传递给选项时，什么也没有发生 - 更不用说浏览器冻结了。

然后我首先尝试`getPath`在将其传递给选项之前执行 a ，这将返回一个空字符串。

我应该怎么做呢，我之前只为 HandlebarsJS 编写了 for 循环代码，并且工作正常，但 EmberJS 似乎没有接受它，为什么？

编辑：我也非常关注：[http](http://handlebarsjs.com/block_helpers.html) ://handlebarsjs.com/block_helpers.html -> Simple Iterators

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T12:44:17.060

我尝试了很长时间后自己解决了这个问题。

HandlebarsJS 方法（如网站上所述）不再对 EmberJS 有效，现在如下：

```
function forLoop(context, options) {
    var object = Ember.getPath(options.contexts[0], context);
    var startIndex = options.hash.start || 0;

    for(i = startIndex; i < object.length; i++) {
        options(object[i]);
    }
} 
```

哎呀，您甚至可以扩展 for 循环以包含索引值！

```
function forLoop(context, options) {
    var object = Ember.getPath(options.contexts[0], context);
    var startIndex = options.hash.start || 0;

    for(i = startIndex; i < object.length; i++) {
        object[i].index = i;

        options(object[i]);
    }
} 
```

这是一个具有可变起始索引的工作 for 循环。您可以像这样在模板中使用它：

```
{{#for anArray start=1}}
    <p>Item #{{unbound index}}</p>
{{/for}} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T09:46:47.280

这是我的做法（它有效！！！）

首先，我在我的模型中有一个“预览”属性/函数，它只在数组中返回 arrayController：

```
objectToLoop = Ember.Object.extend({ 
        ...
    arrayController: [],
    preview: function() {
        return this.get('arrayController').toArray();
    }.property('arrayController.@each'),
        ...
}); 
```

然后，我添加了一个新的 Handlebars 助手：

```
Handlebars.registerHelper("for", function forLoop(arrayToLoop, options) {
    var data = Ember.Handlebars.get(this, arrayToLoop, options.fn);

    if (data.length == 0) {
        return 'Chargement...';
    }

    filtered = data.slice(options.hash.start || 0, options.hash.end || data.length);

    var ret = "";
    for(var i=0; i< filtered.length; i++) {
        ret = ret + options.fn(filtered[i]);
    }
    return ret;     
}); 
```

多亏了所有这些魔法，我可以在我看来这样称呼它：

```
<script type="text/x-handlebars"> 
    <ul>
        {{#bind objectToLoop.preview}}
            {{#for this end=4}}
                <li>{{{someProperty}}}</li>
            {{/for}}
        {{/bind}}
    </ul>
</script> 
```

就是这样。

我知道这不是最佳的，所以谁知道如何改进它，请告诉我:)

# c# - 有没有我可以在没有网络平台的情况下使用的好的 CAS 客户端？

> ID：10307728
> 
> 赞同：0
> 
> 时间：2012-04-25T00:11:45.330
> 
> 标签：c#, mono, cas, jasig

我需要从 Mono 桌面客户端应用程序中针对现有的 CAS 服务器进行身份验证。我发现的最接近的东西是[Jasig](https://github.com/Jasig)，如果我使用的是 ASP.NET 应用程序，它会很好用。

有谁知道那里有一个好的库，或者我可以让 Jasig 从可执行文件中工作的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T04:28:45.983

CAS 服务器支持 RESTful API。您可以使用 API 提交票证/验证请求。请参阅此处了解更多信息，请：[https ://wiki.jasig.org/display/CASUM/RESTful+API](https://wiki.jasig.org/display/CASUM/RESTful+API)

# java - 在测试器类中显示两个数组

> ID：10307734
> 
> 赞同：0
> 
> 时间：2012-04-25T00:12:41.373
> 
> 标签：java, arrays, multidimensional-array

我有六个任务需要完成，但我不知道如何显示它们。我有所有代码来计算所需的每项任务，但是在将它们应用于我的测试器类时，我被卡住了。下面是我的原始类代码。这些是需要完成的任务：

1.  显示原始数据集，如表所示。
2.  连锁超市的平均利润。
3.  利润最高的城市。
4.  利润达到或高于平均水平的所有城市的列表。
5.  城市及其利润按利润降序排列。
6.  制作水平图表显示每个超市的表现

请帮忙，因为过去几天我一直在这样做，但仍然无法做任何事情......我一定很愚蠢，请帮忙

```
package supermarkets;

public class Supermarkets 
{

    private String[] city = {"Miami", "Sunrise", "Hollywood",
        "Tallahassee", "Jacksonville", "Orlando", "Gainesville", "Pensacola",
        "Ocala", "Sebring"};

    private double[] profit = {10200000, 14600000, 17000000, 6000000,
        21600000, 9100000, 8000000, 12500000, 2000000, 4500000};

    public Supermarkets(String[] c, double[] p)
    {
        //array for the city
        city = new String[c.length];
        for (int i = 0; i < c.length; i++)
            city[i] = c[i];

        //array for the profits
        profit = new double[p.length];
        for(int i = 0; i < p.length; i++)
            profit[i] = p[i];
    }

    //sums up the profits from the cities
    public double sumArray()
    {
        double sum = 0;

        for (int i = 0; i < profit.length; i++)
            sum = sum + profit [i];

        return sum;
    }

    //calculates the average of the profits from the cities
    public double average()
    {
        return sumArray() / profit.length;
    }

    //shows highest profit
    double findHighestProfit() 
    {
        double highest = profit[0];

        for(int i = 1; i < profit.length; i++)
        {
            if ( profit [i] > highest )
                highest = profit [i];      
        }
        return highest;
    }

    //gives the above average profit
    public String aboveAvarage()
    {
        String s = "";
        double avg = average();
        for (int i = 0; i < profit.length; i++)
            if (profit [i] > avg)
                s = s + city[i] + "  " + profit[i] + "\n";
        return s;
    }

    //creates a graph showing city and profits
    public String makeGraph()
    {
        String s = "";
        for (int i = 0; i < profit.length; i++)
        {
            s = s + city[i] + " ";
            int x = (int) Math.floor( profit[i] );

            for(int j = 1; j <=x; j++)
                s = s + "*";
            s = s + "\n";
        }
        return s;
    }

    //resets profits position from least to greatest
    public int findPosition(int startScanFrom)
    {
        int position = startScanFrom;

        for (int i = startScanFrom + 1; i < profit.length; i++)
            if (profit[i] < profit[position])
                position = i;

        return position;
    }

    //swaps values for city and profits
    public void swap(int i, int j)
    {
        // Swap the profits
        double temp = profit[i];
        profit[i] = profit[j];
        profit[j] = temp;

        // Swap the cities
        String str = city[i];
        city[i] = city[j];
        city[j] = str;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-15T14:35:58.117

你没有提供你的测试/驱动程序，所以我不得不做出很多假设。

1.  只需编写一个循环两个数组并打印值的方法。

2.  您找到平均利润的方法看起来不错。

3.  您有一种方法可以找到最高的利润，但您需要显示城市。我添加了一种方法来查找利润最高的城市。

    ```
    //shows city with highest profit
    String findHighestProfitCity() 
    {
        double highest = profit[0];
        String c = city[0];

        for(int i = 1; i < profit.length; i++)
        {
            if ( profit [i] > highest ) {
                highest = profit [i]; 
                c = city[i];
            }
        }
        return c;
    } 
    ```

4.  这是一个相当简单的方法。计算平均值后，只需遍历城市/利润数组并显示利润高于平均值的任何城市。

5.  对组织在两个数组中的数据执行此操作的最简单方法是编写一个自定义排序例程，该例程对利润数组进行排序，并在每次需要利润时在城市数组中进行交换。

6.  您放入城市和利润数组的测试数据太大而无法以图形方式显示。您的`makeGraph()`方法尝试为`x`利润中的每个值绘制星号。即使在每个值上去掉五个零之后，它仍然不适合我的屏幕，所以我修改了这个方法，只`x/10`为每个利润绘制星号

    ```
    for(int j = 1; j <= x/10; j++)
        s = s + "*"; 
    ```

这是一个测试/驱动程序，您可以将其用作起点。

```
package supermarkets;

public class SupermarketDriver {

/**
 * @param args
 */
public static void main(String[] args) {

    String[] cities = {"Miami", "Sunrise", "Hollywood",
            "Tallahassee", "Jacksonville", "Orlando", "Gainesville", "Pensacola",
            "Ocala", "Sebring"};

    double[] profits = {102, 146, 170, 60, 216, 91, 80, 125, 20, 45};

    Supermarkets sm = new Supermarkets(cities, profits);
    System.out.println(sm.makeGraph());
    System.out.println("Average profit: " + sm.average());
    System.out.println();
    System.out.println("Highest profit city: " + sm.findHighestProfitCity() + ", " + sm.findHighestProfit());

    }

} 
```

# android - 有没有好的工具或技术可以在 Android 的 StrictMode 中调试 InstanceCountViolation？

> ID：10307735
> 
> 赞同：1
> 
> 时间：2012-04-25T00:12:51.770
> 
> 标签：android

我在我的 Android 日志中看到类似以下内容：

```
android.os.StrictMode$InstanceCountViolation: class com.myemployer.whatever.SomeActivity; instances=3; limit=1 
```

我假设一些长期存在的对象保留了对我活动的每个实例的引用，但我发现它真的很难调试。是否有任何好的工具或技术可以找到此类问题的根本原因？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T00:18:07.967

您可以将[eclipse 内存分析器](http://www.eclipse.org/mat/)[与 ADT](http://android-developers.blogspot.com/2011/03/memory-analysis-for-android.html)结合使用，以跟踪各种内存问题——对于内存泄漏等非常有用。

# ios - 适用于 iOS 的最佳存档库

> ID：10307737
> 
> 赞同：5
> 
> 时间：2012-04-25T00:13:08.470
> 
> 标签：ios, zip, archive, tar

我正在寻找在我的 iOS 应用程序（zip 或其他格式）中使用的存档库。就以下方面而言，最好的图书馆是什么：

1.  将它包含在 iOS 项目中是多么容易
2.  内存消耗
3.  解档速度
4.  它有多稳定

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-16T14:43:44.033

对于文件存档，直到现在我才找到这些库

*   [zipzap](https://github.com/pixelglow/zipzap)
*   [SSZip存档](https://github.com/soffes/ssziparchive)
*   [戈兹帕](https://github.com/mattt/Godzippa)
*   [压缩存档](https://github.com/mattconnolly/ZipArchive)
*   [目标压缩](https://github.com/AgileBits/objective-zip)
*   [压缩包](https://github.com/nicklockwood/GZIP)

（天真按今天*2013-04-16* github stars排序）

我只尝试了[ZipArchive](https://github.com/mattconnolly/ZipArchive)，因为我需要 zip 格式和受密码保护的存档创建。到目前为止，它似乎做得很好。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-25T11:55:19.123

我使用了[Objective Zip](https://github.com/AgileBits/objective-zip)，它在 iOS4 上运行良好。使用这个库很容易，因为：

```
ZipFile *zipFile= [[ZipFile alloc] initWithFileName:@"test.zip" mode:ZipFileModeCreate];
ZipWriteStream *stream= [zipFile writeFileInZipWithName:@"abc.txt" compressionLevel:ZipCompressionLevelBest];
[stream writeData:abcData];
[stream finishedWriting]; 
```

解压缩以类似的方式完成。

我可以推荐它，但我无法提供与其他人的任何比较。您还可以在 wiki 上看到其他一些基于此库的库。我希望这会对你有所帮助。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-12-16T11:23:27.267

ZipZap 是我觉得最吸引人的解决方案。它的优点是只依赖于 SDK 提供的 zlib。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-12T23:14:40.650

最好的方法是直接使用**zlib**。没有库依赖，只有 zlib，你可能已经在你的项目中拥有

看这里[如何使用 Objective-C 在内存中压缩数据](http://www.clintharris.net/2009/how-to-gzip-data-in-memory-using-objective-c/)

# c - 抓住细分违规并继续生活

> ID：10307739
> 
> 赞同：2
> 
> 时间：2012-04-25T00:13:37.953
> 
> 标签：c, memory, malloc, signals

我正在编写一个程序来检查它自己的地址空间。

具体来说，我关心所有 malloc-ed 数据块。如果有一些系统调用来获取它们的列表，那就太好了（对于我的应用程序，我不能使用 LD_PRELOAD、-wrap 或任何额外的命令行选项）。如果有办法做到这一点，我更愿意听到它，而不是我在下面陈述的问题的答案。

取而代之的是，我目前的方法是取消引用所有内容并环顾四周。显然，所有可能的指针的集合是等待发生的段错误的雷区，所以我尝试注册一个信号处理程序并使用 setjmp/longjmp（通过让处理程序不做任何事情来简单地忽略段错误是一个无限循环，因为处理程序将返回到错误指令）。一些示例代码如下所示：

```
static jmp_buf buf;
void handler(int i) {
    printf("    Segfaulted!\n");
    longjmp(buf,-1);
}
void segfault(void) {
    int* x = 0x0;
    int y = *x;
}
void test_function(void) {
    signal(11,handler);
    while (1) {
        if (setjmp(buf)==0) {
            printf("Segfaulting:\n");
            segfault();
        }
        else {
            printf("Recovered and not segfaulting!\n");
        }
        printf("\n");
    }
} 
```

输出是：

```
 Segfaulting:
        Segfaulted!
    Recovered and not segfaulting!

    Segfaulting:
    Segmentation fault 
```

所以，处理程序第二次没有工作。我不知道这是为什么，但我推测这与未清除原始信号有关。我不知道该怎么做。

顺便说一句，我首先尝试了 sigsetjmp/siglongjmp，但由于某种原因在 setjmp.h 中没有定义它们。我有一种模糊的感觉，需要传递一些额外的编译标志，但是，和以前一样，这个应用程序不允许这样做。

使用的系统是 Ubuntu Linux 10.04 x86-64，任何解决方案*都不*需要便携。

谢谢！
伊恩[

编辑：处理程序中的 sigrelse 清除信号，并有效地解决问题。现在的问题涉及提出的其他问题——是否有更好的方法（即获取 malloc 块）？sigsetjmp/siglongjmp 怎么了？为什么我需要重置信号？]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T00:19:07.647

`signal()`是一个遗留接口，并且可能会或可能不会在调用信号处理程序后重新注册，具体取决于操作系统；您可能需要发出另一个`signal()`调用以将信号处理程序重置为处理程序中的最后一个操作。见`man 2 signal`。

`sigaction()`是设置信号处理程序的首选机制，因为它具有良好定义和可移植的行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T01:09:59.660

当`SIGSEGV`调用信号处理程序时，`SIGSEGV`信号将被屏蔽，就像被`sigprocmask`. 这适用于任何信号。通常从信号处理程序返回会取消屏蔽它，但由于您没有返回，所以这永远不会发生。有几个可能的解决方案：

*   您可以`sigprocmask`在 之前或之后调用`longjmp`以自己取消屏蔽。
*   `sigaction`您可以使用（无论如何都是首选方式）安装信号处理程序并使用该`SA_NODEFER`标志来防止它被屏蔽。
*   您可以使用`sigsetjmp`和`siglongjmp`函数，它们自己负责保存和恢复信号掩码。

# xpages - xPages 创建作者和读者字段

> ID：10307742
> 
> 赞同：7
> 
> 时间：2012-04-25T00:14:12.177
> 
> 标签：xpages

我的 xPage 有一个 querySaveDocument 函数，我在其中设置了一些后端字段，包括作者和读者字段。

```
var authors = new Array("[AdminEditors]");
var user:String=session.getEffectiveUserName();
authors.push( user );
var authitem:NotesItem = doc.replaceItemValue("z_Authors", authors );
authitem.setAuthors(true);

var readitem:NotesItem = doc.replaceItemValue("z_Readers", "[AdminReaders]" );
readitem.setReaders(true); 
```

我认为 doc.replaceItemValue() 会返回对 NotesItem 的引用，但 authItem 为空。

那么如何使用 SSJS 在后端 Notes Document 上创建一个字段并获得对它的引用呢？

谢谢，

——杰夫

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-25T01:12:59.963

确保使用 getDocument(true) 使后端文档与前端文档中所做的更改同步。

```
var doc = document1.getDocument(true); 
```

# php - 如何使用 Curl 和 SSL 以及 cookie 登录

> ID：10307744
> 
> 赞同：7
> 
> 时间：2012-04-25T00:14:19.983
> 
> 标签：php, forms, cookies, ssl, curl

我一直在尝试使用 curl 登录 barnesandnoble.com 移动网站，但到目前为止还没有运气。我返回没有错误的页面，它再次将我的电子邮件默认到登录页面的电子邮件输入表单框中（以 print $result 返回的表单）。

通过将 LOGINURL 更改为指向 ebay 的登录名，相同的代码实际上可以让我正确进入 ebay

唯一的区别是 barnesandnobles 是 https:// 而 ebay 登录是 http://

另外，我相信 barnes 网站是 asp/aspx，所以我不知道如何以不同方式处理 cookie 和 _state

任何帮助将不胜感激，因为我在过去 16 小时内一直在尝试调试它

另外，我的 cookie.txt 是可写的并且可以工作

```
<?php
    $cookie_file_path = "C:/test/cookie.txt";
    $LOGINURL = "https://cart2.barnesandnoble.com/mobileacct/op.asp?stage=signIn"; 
    $agent = "Nokia-Communicator-WWW-Browser/2.0 (Geos 3.0 Nokia-9000i)";

    $ch = curl_init(); 

    $headers[] = "Accept: */*";
    $headers[] = "Connection: Keep-Alive";
    $headers[] = "Content-type: application/x-www-form-urlencoded;charset=UTF-8";

    curl_setopt($ch, CURLOPT_HTTPHEADER,  $headers);
    curl_setopt($ch, CURLOPT_HEADER,  0);
    curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 0);
    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
    curl_setopt($ch, CURLOPT_URL, $LOGINURL);
    curl_setopt($ch, CURLOPT_USERAGENT, $agent);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
    curl_setopt($ch, CURLOPT_COOKIEFILE, $cookie_file_path);
    curl_setopt($ch, CURLOPT_COOKIEJAR, $cookie_file_path);

    $content = curl_exec($ch); 

    curl_close($ch); 

    unset($ch); 

    // NAME="path_state" value="6657403">

    if(stristr($content,"path_state")){
        $array1 = explode('path_state" value="',$content);
        $content1 = $array1[1];
        $array2 = explode('">',$content1);
        $content2 = $array2[0];
    }

    $LOGINURL = "https://cart2.barnesandnoble.com/mobileacct/op.asp?stage=signIn";
    $POSTFIELDS = "d_hidPageStamp=V_3_17&hidViewMode=opSignIn&stage=signIn&previousStage=mainStage&path_state=" .  $content2 . "&emailAddress=YOUREMAILHERE@gmail.com&acctPassword=YOURPASSWORD";
    $reffer = "https://cart2.barnesandnoble.com/mobileacct/op.asp?stage=signIn"; 

    $ch = curl_init(); 

    $headers[] = "Accept: */*";
    $headers[] = "Connection: Keep-Alive";
    $headers[] = "Content-type: application/x-www-form-urlencoded;charset=UTF-8";

    curl_setopt($ch, CURLOPT_HTTPHEADER,  $headers);
    curl_setopt($ch, CURLOPT_HEADER,  0);
    curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 0);
    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);   
    curl_setopt($ch, CURLOPT_URL, $LOGINURL); 
    curl_setopt($ch, CURLOPT_USERAGENT, $agent); 
    curl_setopt($ch, CURLOPT_POST, 1); 
    curl_setopt($ch, CURLOPT_POSTFIELDS, $POSTFIELDS); 
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); 
    curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1); 
    curl_setopt($ch, CURLOPT_REFERER, $reffer); 
    curl_setopt($ch, CURLOPT_COOKIEFILE, $cookie_file_path); 
    curl_setopt($ch, CURLOPT_COOKIEJAR, $cookie_file_path); 

    $result = curl_exec($ch);  

    print $result; 
?> 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-25T00:46:17.713

这是我根据您的代码创建的一个工作示例。这使用了`getFormFields`我为登录 Android 市场的类似问题（本文底部的第一个参考）编写的函数。

我认为您的脚本中可能有几件事阻止了登录工作。首先，您应该对帖子字符串中的 URL 参数（例如电子邮件和密码）进行[urlencode](http://php.net/urlencode)（cURL 不会为您执行此操作）。其次，我认为`x`可能需要用作登录 URL 一部分的值。

这是一个成功登录的解决方案。注意，我重新使用了原来的 cURL 句柄。这不是必需的，但如果您指定 keep-alive，它实际上会重用相同的连接，并且它还使您不必一遍又一遍地指定相同的选项。

获得 cookie 后，您可以创建一个新的 cURL 对象并指定 COOKIEFILE 和 COOKIEJAR，您将无需执行第一步即可登录。

```
<?php

// options
$EMAIL            = 'you@yoursite.com';
$PASSWORD         = 'yourpassword';
$cookie_file_path = "/tmp/cookies.txt";
$LOGINURL         = "https://cart2.barnesandnoble.com/mobileacct/op.asp?stage=signIn"; 
$agent            = "Nokia-Communicator-WWW-Browser/2.0 (Geos 3.0 Nokia-9000i)";

// begin script
$ch = curl_init(); 

// extra headers
$headers[] = "Accept: */*";
$headers[] = "Connection: Keep-Alive";

// basic curl options for all requests
curl_setopt($ch, CURLOPT_HTTPHEADER,  $headers);
curl_setopt($ch, CURLOPT_HEADER,  0);
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 0);
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);         
curl_setopt($ch, CURLOPT_USERAGENT, $agent); 
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); 
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1); 
curl_setopt($ch, CURLOPT_COOKIEFILE, $cookie_file_path); 
curl_setopt($ch, CURLOPT_COOKIEJAR, $cookie_file_path); 

// set first URL
curl_setopt($ch, CURLOPT_URL, $LOGINURL);

// execute session to get cookies and required form inputs
$content = curl_exec($ch); 

// grab the hidden inputs from the form required to login
$fields = getFormFields($content);
$fields['emailAddress'] = $EMAIL;
$fields['acctPassword'] = $PASSWORD;

// get x value that is used in the login url
$x = '';
if (preg_match('/op\.asp\?x=(\d+)/i', $content, $match)) {
    $x = $match[1];
}

//$LOGINURL   = "https://cart2.barnesandnoble.com/mobileacct/op.asp?stage=signIn";
  $LOGINURL   = "https://cart2.barnesandnoble.com/mobileacct/op.asp?x=$x";

// set postfields using what we extracted from the form
$POSTFIELDS = http_build_query($fields); 

// change URL to login URL
curl_setopt($ch, CURLOPT_URL, $LOGINURL); 

// set post options
curl_setopt($ch, CURLOPT_POST, 1); 
curl_setopt($ch, CURLOPT_POSTFIELDS, $POSTFIELDS); 

// perform login
$result = curl_exec($ch);  

print $result; 

function getFormFields($data)
{
    if (preg_match('/(<form action="op.*?<\/form>)/is', $data, $matches)) {
        $inputs = getInputs($matches[1]);

        return $inputs;
    } else {
        die('didnt find login form');
    }
}

function getInputs($form)
{
    $inputs = array();

    $elements = preg_match_all('/(<input[^>]+>)/is', $form, $matches);

    if ($elements > 0) {
        for($i = 0; $i < $elements; $i++) {
            $el = preg_replace('/\s{2,}/', ' ', $matches[1][$i]);

            if (preg_match('/name=(?:["\'])?([^"\'\s]*)/i', $el, $name)) {
                $name  = $name[1];
                $value = '';

                if (preg_match('/value=(?:["\'])?([^"\'\s]*)/i', $el, $value)) {
                    $value = $value[1];
                }

                $inputs[$name] = $value;
            }
        }
    }

    return $inputs;
} 
```

这对我有用，希望对你有所帮助。

以下是我的其他一些 cURL 答案，可能有助于学习：

*   [使用 curl 检索 Android Market 图书馆](https://stackoverflow.com/questions/8958495/retrieve-android-market-mylibrary-with-curl/8998077#8998077)
*   [curl 的多个动作](https://stackoverflow.com/questions/9549892/multiple-actions-with-curl/9549990#9549990)
*   [通过 curl 发送 xml 和 headers](https://stackoverflow.com/questions/9250702/sending-xml-and-headers-via-curl/9252130#9252130)
*   [使用 PHP 和 Curl 登录 Google，Cookie 已关闭？](https://stackoverflow.com/questions/8991873/login-to-google-with-php-and-curl-cookie-turned-off/8992557#8992557)
*   [使用 PHP 和 cURL 登录 Pinterest 不起作用](https://stackoverflow.com/questions/23568948/pinterest-login-with-php-and-curl-not-working)

# javascript - 避免 EVAL 并将其传递给函数？

> ID：10307745
> 
> 赞同：3
> 
> 时间：2012-04-25T00:14:25.037
> 
> 标签：javascript, jquery, function, call, eval

我构建了一个 GUI，它传入一个长 JS 对象作为动画插件的设置。其中一项设置允许用户在动画完成后调用函数。不幸的是，它必须作为字符串传递给 JS 对象。

```
... [ 'functioncall()' ] ...... 
```

在我的动画回调中，我正在检索此字符串并尝试将其作为函数运行。

第一次尝试完美，但使用 eval ...

```
eval( OS.path_jscall[index].path_jscall[0][i] ) 
```

我已经设置了一个更喜欢的方法，如下所示：

```
var HookFunction=new Function( OS.path_jscall[index].path_jscall[0][i] );
HookFunction(); 
```

这两个示例都完美地调用了 functioncall() 函数。我不确定如何将（this）传递给functioncall（）......

```
functioncall(obj){ console.log(obj); }; 
```

一切都在提到窗口。有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T00:19:16.187

`.call`调用函数时 使用。`.call`将第一个参数分配给`this`变量。

```
var myFunction = function(arg1, arg2) {
    alert(this);
}

myFunction.call(this, "arg1", "arg2"); 
```

使用第二个示例，您可以这样做：

```
HookFunction.call(this); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-25T00:22:08.600

假设这`HookFunction`是名称，您可以执行 a`call()`或`apply()`

```
HookFunction.call(this,arg1,arg2,...,argN);

//or

HookFunction.apply(this,[arg1,arg2,...,argN]); 
```

2的基本区别是`call()`接收你的“this”和一个枚举的参数列表，同时`apply()`接收你的“this”和一个参数数组

# compiler-construction - LLVM 中机器代码生成的状态？

> ID：10307746
> 
> 赞同：4
> 
> 时间：2012-04-25T00:14:34.017
> 
> 标签：compiler-construction, llvm

最近我一直在研究 LLVM 作为编译器项目的后端，这看起来很有希望。

但是，LLVM 似乎可以 JIT 代码（这很酷！）或者它可以为本地平台导出程序集，但它实际上不能创建本地可执行文件。这似乎是 LLVM 声称的编译器后端基础架构的主要限制。

我正在开发一个项目，我希望编译的可执行文件能够在没有安装 LLVM（即没有 JIT）的情况下运行。LLVM 是否有任何可用于生成机器代码（不是 LLVM 位码）的本机汇编程序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T06:52:11.827

LLVM（通过您提到的 MC 库）可以为流行的架构生成*目标文件*（x86 可以说是最成熟的）。这是一个相对较新的进步——在 MC 之前，LLVM 没有功能汇编器。确保使用最新发布的 LLVM 版本（目前是 3.0，但很快就会是 3.1）。

此时 LLVM 的功能停止。然后，您需要一个平台链接器将目标文件实际链接到可执行文件中。例如，`ld`用于 Linux-y 平台。

请注意，这适用于今天（2012 年 4 月），但未来不太可能如此。LLD (LLVM Linker) 项目现在处于早期阶段，旨在提供一个基于 LLVM 的链接器，它将跳过直接使用 LLVM 工具生成完全可加载的可执行文件（和共享库）所需的额外步骤，而不依赖于外部工具。

# windows-phone-7 - wp7 Bing 地图显示在设计视图中，但在模拟器和手机上只是黑色 - 用于完美工作

> ID：10307749
> 
> 赞同：0
> 
> 时间：2012-04-25T00:15:06.900
> 
> 标签：windows-phone-7, map, bing-maps

![地图在模拟器上的显示方式](../Images/650b9ddae29d7e736049cd73e26c629b.png)

如您所见，“myTent”图钉已加载到地图上，但未显示。我从这个项目中休息了几个星期，但没有改变与地图相关的内容。在某处看到他们用钥匙替换了令牌系统，但我已经有钥匙所以不应该影响我吗？密钥会过期吗？我认为不会过期。地图设置正常：

```
<Grid x:Name="ContentPanel" Margin="12,171,12,12" Grid.RowSpan="2">
        <Button Content="MyTent" Height="72" HorizontalAlignment="Left" Margin="63,507,0,0" Name="myTentButton" VerticalAlignment="Top" Width="160" Click="myTentButton_Click" />
        <Button Content="Find Me" Height="72" HorizontalAlignment="Left" Margin="209,507,0,0" Name="findMeButton" VerticalAlignment="Top" Width="160" Click="findMeButton_Click" />
        <my:Map Height="523" HorizontalAlignment="Left" Margin="6,6,0,0" Name="map1" VerticalAlignment="Top" Width="444" CredentialsProvider="------------myKEY--------------" />
    </Grid> 
```

关于为什么现在发生这种情况的任何想法，而它以前工作过？或其他可能引起正确注意的标签，不确定故障在哪里，因为没有错误非常感谢，MH

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T07:01:27.740

在我看来，地图应用程序本身工作正常，只是它没有显示应该出现在背景中的地图图块。如果是这种情况，这里有几个可能的建议要检查，从您提供的代码段中不清楚：

*   确保您指定了有效的地图样式（Aerial、Road、Birdseye 等）？
*   确保地图居中的位置具有可用于显示地图的缩放级别的图像。（即缩放级别 19 的某些高分辨率图像并非在所有位置都可用）
*   确保您的手机具有有效的 Internet 连接，通过该连接可以连接到 Bing 地图服务器以检索必要的图块。

# android - 在 onTap 期间获取地图覆盖标记图标

> ID：10307753
> 
> 赞同：0
> 
> 时间：2012-04-25T00:15:37.253
> 
> 标签：android

我正在使用包含 OverlayItems 列表的 ItemizedOverlay 在 MapView 顶部显示标记。我的问题是，当 OverlayItem 使用为覆盖定义的默认标记时，它的 getMarker() 方法返回 null。还有其他方法可以获得该标记图像吗？我想看看是否可以在 onTap() 期间对其进行动画处理。

我在地图上显示了一堆标记，其中许多使用相同的图像，所以我认为最好使用覆盖的默认图像来节省内存。对于这个应用程序，可能会为给定的叠加显示超过 100 个标记。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:18:46.890

你有几种不同的方法来解决这个问题。我正在展示我所知道的最简单的一个，如果它不能解决您的问题，请告诉我。

```
public class MyItemizedNewOverlay extends ItemizedOverlay<OverlayNewItem> {

    private ArrayList<OverlayNewItem> myOverlays ;
    Drawable defaultMarker;
    Context context;

    public MyItemizedNewOverlay(Drawable defaultMarker, Context context) {
        super(boundCenterBottom(defaultMarker));
        this.defaultMarker = defaultMarker;
        this.context = context;
        myOverlays = new ArrayList<OverlayNewItem>();
        populate();
    }
   . . .      
} 
```

有了这个，您可以在代码中为 onTap() 使用默认标记

# iphone - 在 iPhone 上使用 opencv features2d

> ID：10307754
> 
> 赞同：1
> 
> 时间：2012-04-25T00:15:56.390
> 
> 标签：iphone, opencv

我正在尝试通过 iOS 上的 OpenCV 使用特征检测，但遇到了一个难题：

features2d 依赖于 highgui highgui 不能在 iOS 上构建（或者至少不是我能弄清楚的）。

这让我相信：如果不重写模块以删除对 cvSaveImage() 和 cvLoadImage() 的调用，就无法在 iOS 上使用 features2d。这是错的吗？有人遇到这个并解决了吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T00:25:31.323

您采取了错误的方法，您不需要 highgui，因为该库只是为了让您更轻松地处理处理结果，您可以简单地手动执行这些步骤。

例如，考虑这个 HOG 示例：

```
#include <iostream>
#include <opencv2/imgproc/imgproc.hpp>
#include <opencv2/objdetect/objdetect.hpp>
#include <opencv2/highgui/highgui.hpp>

int
main(int argc, char *argv[])
{
  const char *imagename = argc > 1 ? argv[1] : "../../image/pedestrian.png";
  cv::Mat img = cv::imread(imagename, 1);
  if(img.empty()) return -1; 

  cv::HOGDescriptor hog;
  hog.setSVMDetector(cv::HOGDescriptor::getDefaultPeopleDetector());

  std::vector<cv::Rect> found;
  // 画像，検出結果，閾値（SVMのhyper-planeとの距離），
  // 探索窓の移動距離（Block移動距離の倍数），
  // 画像外にはみ出た対象を探すためのpadding，
  // 探索窓のスケール変化係数，グルーピング係数
  hog.detectMultiScale(img, found, 0.2, cv::Size(8,8), cv::Size(16,16), 1.05, 2);

  std::vector<cv::Rect>::const_iterator it = found.begin();
  std::cout << "found:" << found.size() << std::endl;
  for(; it!=found.end(); ++it) {
    cv::Rect r = *it;
    // 描画に際して，検出矩形を若干小さくする
    r.x += cvRound(r.width*0.1);
    r.width = cvRound(r.width*0.8);
    r.y += cvRound(r.height*0.07);
    r.height = cvRound(r.height*0.8);
    cv::rectangle(img, r.tl(), r.br(), cv::Scalar(0,255,0), 3);
  }

  // 結果の描画
  cv::namedWindow("result", CV_WINDOW_AUTOSIZE|CV_WINDOW_FREERATIO);
  cv::imshow( "result", img );    
  cv::waitKey(0);
} 
```

它是为非 iOS 环境而设计的，但是您可以简单地将所有 highgui 调用替换为原生 iOS 内容。

您可以从这里为 opencv 库获得非常好的图像处理：

[http://aptogo.co.uk/2011/09/opencv-framework-for-ios/](http://aptogo.co.uk/2011/09/opencv-framework-for-ios/)

所以你应该在那个代码中真正关心的是这部分：

```
 cv::HOGDescriptor hog;
  hog.setSVMDetector(cv::HOGDescriptor::getDefaultPeopleDetector());

  std::vector<cv::Rect> found;
  // 画像，検出結果，閾値（SVMのhyper-planeとの距離），
  // 探索窓の移動距離（Block移動距離の倍数），
  // 画像外にはみ出た対象を探すためのpadding，
  // 探索窓のスケール変化係数，グルーピング係数
  hog.detectMultiScale(img, found, 0.2, cv::Size(8,8), cv::Size(16,16), 1.05, 2);

  std::vector<cv::Rect>::const_iterator it = found.begin();
  std::cout << "found:" << found.size() << std::endl;
  for(; it!=found.end(); ++it) {
    cv::Rect r = *it;
    // 描画に際して，検出矩形を若干小さくする
    r.x += cvRound(r.width*0.1);
    r.width = cvRound(r.width*0.8);
    r.y += cvRound(r.height*0.07);
    r.height = cvRound(r.height*0.8);
    cv::rectangle(img, r.tl(), r.br(), cv::Scalar(0,255,0), 3);
  } 
```

简要说明：

```
// You get your img into a cv mat from the uiimage or whatever.

  cv::Mat gray_img;
  cv::cvtColor(img, gray_img, CV_BGR2GRAY);
  cv::normalize(gray_img, gray_img, 0, 255, cv::NORM_MINMAX);

  std::vector<cv::KeyPoint> keypoints;
  std::vector<cv::KeyPoint>::iterator itk;
  cv::Mat descriptors;

  //
  // threshold=0.05, edgeThreshold=10.0
  cv::SiftFeatureDetector detector(0.05,10.0);
  detector.detect(gray_img, keypoints);
  // Brief に基づくディスクリプタ抽出器
  cv::BriefDescriptorExtractor extractor;
  cv::Scalar color(50,50,155);
  extractor.compute(gray_img, keypoints, descriptors);

  // 32次元の特徴量 x keypoint数
  for(int i=0; i<descriptors.rows; ++i) {
    cv::Mat d(descriptors, cv::Rect(0,i,descriptors.cols,1));
    std::cout << i << ": " << d << std::endl;
  } 
```

你有你的结果。

# javascript - 用 perl 创建 html

> ID：10307755
> 
> 赞同：0
> 
> 时间：2012-04-25T00:16:07.823
> 
> 标签：javascript, html, perl

```
<header>
<script type="text/javascript">
function hideit()
{

var x1 = document.getElementsByTagName("ol").item(0);
var x = document.getElementsByTagName("ol");
for (var i = 0; i < x.length; i++)
  x[i].style.display="none";
}
function showit()
{
var x1 = document.getElementsByTagName("ol").item(0);

var x=document.getElementsByTagName("ol");
for (var i = 0; i < x.length; i++)
 x[i].style.display="";
}
</script><header>
<body>
foreach $key (keys %{$stats_data{$out}})  {

    print $indexfd ("<input onclick=\"showit()\" type=\"button\" id=\"<?perl echo     $key; ?>\" value=\"showit\"><br><input onclick=\"hideit()\" type=\"button\" id=\"<?perl   echo $key; ?>\" value=\"hideit\"><br><b><ol id=$key>$stats_data{$out}{$key}<ol id=$key>  </b><br>");
        }</body> 
```

我正在用 perl 创建一个 html 文档。我为每个 perl 变量（通过循环）编写了一个事件 mouseover 和 mouseout。但看起来事件同时控制了所有变量。我如何只编写一次事件但使其能够单独应用于每个项目：这就是我目前所拥有的

但是这个 html 在显示时，不允许我分别控制每个`$key`.

尽管确实为每个 $key 创建了按钮，但单击一个按钮可以控制`$stats_data{$out}{$key}`所有按钮。

我什至尝试将 id 传递给显示/隐藏脚本，但没有运气。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-25T08:29:52.560

您的代码看起来像是在尝试以使用 PHP 的方式将 Perl 与 HTML 混合。**这在 Perl 中不起作用。**

我尝试先修复您的 Perl 代码。这将打印到您的文件句柄（我省略了），但不会为您提供有效的 JavaScript 代码。我没有改变这一点，因为我不明白你想做什么。稍后再谈。

```
use strict;
use warnings;
# open of $indexfd filehandle goes here..

# print head of HTML page
print $indexfd <<HTML
<html>
  <header>
    <script type="text/javascript">
    function hideit() {
      var x1 = document.getElementsByTagName("ol").item(0);
      var x = document.getElementsByTagName("ol");
      for (var i = 0; i < x.length; i++)
        x[i].style.display="none";
    }
    function showit() {
      var x1 = document.getElementsByTagName("ol").item(0);
      var x=document.getElementsByTagName("ol");
      for (var i = 0; i < x.length; i++)
       x[i].style.display="";
    }
    </script>
  </header>
  <body>
HTML
;

# If I see this correctly, %stats_data looks like this:
my %stats_data = (
  'out1' => {
    'key1' => 'val1',
    'key2' => 'val2',
  },
  'out2' => {
    'key1' => 'val1',
    'key2' => 'val2',
  },
);
my $out = 'out1'; # you need the $out from somewhere
# print buttons for each data thingy - you'll want to sort them probably
foreach my $key (sort keys %{$stats_data{$out}})  {
  print $indexfd 
    qq~<input onclick="showit()" type="button" id="$key" value="showit"><br />~,
    qq~<input onclick="hideit()" type="button" id="$key" value="hideit"><br/>~,
    # Because $stats_data{$out} is a hash ref you need the -> operator here
    qq~<ol id="$key"><li><b>$stats_data{$out}->{$key}</b></li></ol><br/>~;
}

print $indexfd qq~<p>more html...</p></body></html>~; 
```

所以有几点值得一提。

```
 print $indexfd ("<input onclick=\"showit()\" type=\"button\" id=\"<?perl echo     $key; ?>\" value=\"showit\"><br><input onclick=\"hideit()\" type=\"button\" id=\"<?perl   echo $key; ?>\" value=\"hideit\"><br><b><ol id=$key>$stats_data{$out}{$key}<ol id=$key>  </b><br>"); 
```

在您使用的这行相当长的代码中，`<?perl echo $key; ?>`它看起来像 php，但不起作用。您还使用`<ol id=$key>`了 which works 因为您使用了 double-quotes `"..."`。Perl 用 "-delimited 字符串中的变量替换它们的值。您不需要类似 php 的东西。为了节省您在 HTML 代码中转义所有双引号的工作，您可以使用`qq`-Operator。请参阅[perlop](https://metacpan.org/pod/perlop#Quote-and-Quote-like-Operators)了解更多信息。

我在评论中解释了`%stats_data`数据结构。

为了打印大量 HTML，我使用了[HERE docs](https://metacpan.org/pod/perlop#EOF)。

现在让我们谈谈您的 JavaScript。

> 尽管确实为每个按钮创建了按钮`$key`，但单击一个按钮可以控制`$stats_data{$out}{$key}`所有按钮。

这是因为您设计`hideit()`和`showit()`功能的方式。我不是很确定你想要实现什么。如果您查看我的`%stats_data`内容，您会发现“out1”中有几个键。这让 foreach 循环为每个键打印一组按钮。这两个按钮都具有与其 id 相同的键，ol 也是如此。这是不正确的。[id-attribute 必须是唯一](https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/id)的。

此外，您的 html 中存在一些基本问题，我也冒昧地修复了这些问题。如果你打开一个`<ol id="foo">`容器，你需要像`</ol>`. 由于`<ol>`是块级元素，因此不应将内联元素放在`<b>`其外部，而应放在 ol 的`<li>`元素内（我省略了）。最好将 css ``style="font-weight: bold" 分配给 li 项目，或者更好地给它们类。

我将对您尝试使用 JavaScript 执行的操作进行最后一次猜测。如果您有几段文本，并且想用按钮隐藏它们，您可以像我在这里的未经测试的代码那样做。

Javascript：

```
function toggle(id) {
  if (document.getElementById(id).style.display == 'block' ) {
    document.getElementById(id).style.display = 'none';
  } else {
    document.getElementById(id).style.display = 'block';
  }
} 
```

HTML：

```
<div>
  <input type="button" name="toggle1" id="toggle1" onclick="toggle('p1')" />
  <p id="p1">Lorem ipsum dolor set ... foo a lot of text 1.</p>
  <input type="button" name="toggle2" id="toggle2" onclick="toggle('p2')" />
  <p id="p2">Lorem ipsum dolor set ... foo a lot of text 2.</p>
</div> 
```

在这种情况下，该函数会检查段落是否显示。display-value 需要设置为“none”或“block”，因为 p 元素是块级元素。

如果您需要更多帮助，请尝试发布有关您在脚本中使用的数据的更多具体信息。

**编辑：** 在下面的代码中，我将 JS 函数更改为都将 id（键）作为参数。它们仅显示或隐藏与此键关联的列表。我更改了按钮的 ID，所以它们不一样。我还在每对按钮和列表周围添加了一个 div，以便更清楚地知道什么属于哪里。

```
use strict;
use warnings;
# open of $indexfd filehandle goes here..
my $indexfd;

# print head of HTML page
print $indexfd <<HTML
<html>
  <header>
    <script type="text/javascript">
    function hideit(key) {
      document.getElementById(key).style.display = "none";
    }
    function showit(key) {
      document.getElementById(key).style.display = "";
    }
    </script>
  </header>
  <body>
HTML
;

# If I see this correctly, %stats_data looks like this:
my %stats_data = (
  'out1' => {
    'key1' => 'val1',
    'key2' => 'val2',
  },
  'out2' => {
    'key1' => 'val1',
    'key2' => 'val2',
  },
);
my $out = 'out1'; # you need the $out from somewhere

foreach my $key (sort keys %{$stats_data{$out}})  {
  print $indexfd 
    qq~<div id="div_$key">\n~, # Add a div around the $key-elements
    qq~<input onclick="showit('$key')" type="button" id="btn_show_$key" value="showit">\n~,
    qq~<input onclick="hideit('$key')" type="button" id="btn_show_$key" value="hideit"><br/>\n~,
    qq~<ol id="$key"><li><b>$stats_data{$out}->{$key}</b></li></ol>\n~,
    qq~</div>\n~;
}

print $indexfd qq~<p>more html...</p></body></html>~; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T15:04:24.483

看起来您需要 Perl 的模板模块之一，例如[Template Toolkit](https://www.metacpan.org/module/Template)。它允许您将 Perl 片段嵌入到较大的文档中，然后对其进行处理，以便 Perl 部分填充您需要的任何内容。

这是我的一个网站的一个例子。它使用包装文件来包含顶部和底部部分，并读取一个 XML 文件以获取要填充中间的数据：

```
[% 
        title   = "The Perl Review" 
        xml     = "raw/xml/tpr_issues.xml"
        sidebar = 1
%]

[% PROCESS top %]

<table class="content-table">
<tr>
        <td colspan class="2">  

<h2>Next issue: April 15</h2>

[% PERL %]

use XML::Twig;

my $twig = XML::Twig->new;   

$twig->parsefile( $stash->get( 'xml' ) ); 

my $root = $twig->root;

my $latest_issue = $root->first_child( 'release' );

my( $volume, $issue, $year, $season ) = 
        map { eval {$latest_issue->first_child( $_ )->text } }
                qw( volume issue year season );

my $articles = $latest_issue->first_child( 'articles' );

print <<"TEMPLATE";
        <A class="cover-link" href="/Subscribers/ThePerlReview-v${volume}i${issue}.pdf"><img 
                class="cover-image-medium" height="396" width="306" 
                src="/Images/covers/v${volume}i${issue}-cover-medium.png" /></a>
        </td>
        <td class="article-cell">
        <h2 id="issue-header">Issue $volume.$issue, $season $year</h2>

TEMPLATE

foreach my $article ( $articles->children( ) )
        {
        my @children = map { $_->tag } $article->children;

        my %hash = 
                map { 
                        $article->first_child( $_ )->tag,
                        $article->first_child( $_ )->text
                        } 
                map { $_->tag } $article->children;

        print qq|\t<p class="article-title"><span class="article-title">$hash{title}</span>|;
        print qq| (<a href="$hash{sample_page}">sample</a>)| if $hash{sample_page};
        print "<br />\n";
        print qq|\t\t<span class="article-author">$hash{author}</span></p>\n|;          
        }

[% END %]

[% PROCESS issue_note %]

        </td>
</tr>

</table>

[% PROCESS footer %] 
```

# xpath - 在 xpath 中，你如何比较 text() 和 \r\n （换行符）？

> ID：10307757
> 
> 赞同：1
> 
> 时间：2012-04-25T00:16:19.057
> 
> 标签：xpath, html-agility-pack

我想得到节点：

//脚本[starts-with(text().'\r\nvar name')]

但似乎 xpath 无法识别 \r\n 转义字符。任何想法如何匹配它们？

注意：我使用的是 html 敏捷包

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T02:00:30.657

**使用**：

```
//script[starts-with(., '&#xD;&#xA;var name')] 
```

**大多数情况下，XML由 XML 解析器*规范化*，并且只剩下一个 NL 字符**——因此，如果上面的表达式没有选择想要的`script`元素，请尝试：

```
//script[starts-with(., '&#xA;var name')] 
```

**或者，这在两种情况下都有效**：

```
//script
    [(starts-with(., '&#xD;&#xA;') or starts-with(., '&#xA;'))
   and
    starts-with(substring-after(., '&#xA;'), 'var name')
    ] 
```

# c++ - 函数作用域静态非 Pod 对象初始化

> ID：10307759
> 
> 赞同：0
> 
> 时间：2012-04-25T00:16:33.160
> 
> 标签：c++, static

我的印象是函数作用域的非 Pod 结构在第一次调用函数时被初始化。但是，在 VS-2010 上，如果构造函数抛出异常，则每次都会调用构造函数，直到构造成功。

这种行为实现是特定的还是标准保证的？

下面是演示该行为的人为示例：

```
#include <iostream>
#include <string>
using namespace std;

//dummy resource class
class Resource {
 public:
 Resource() {
   cerr<<"Allocate Resource "<<endl;
 }

~Resource() {
   cerr<<"Free Resource"<<endl;
 }
};

//dummy class which will be statically instantiated
class Dummy {
  public:

 Dummy()  {
   cerr<<"in Dummy"<<endl;
   throw(string("error"));
  }

  Resource res;

};

//main program
int main()  {

 for(int i = 0;i<3;i++) {
   try {
     //create a static object  throw and exception
     static Dummy foo;
   }
   catch ( std::string &e) {
     cerr<<"Caught exception:"<<e<<endl<<endl;
   }   
 }
 return 1;
} 
```

**输出：**

**迭代：0**

分配资源

静态对象构造器

免费资源

捕获异常：错误

**迭代：1**

分配资源

静态对象构造器

免费资源

捕获异常：错误

**迭代：2**

分配资源

静态对象构造器

免费资源

捕获异常：错误**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T00:20:44.003

> 我的印象是函数作用域的非 Pod 结构在第一次调用函数时被初始化。

当然可以，但想想“初始化”是什么意思——如果构造函数抛出异常，则对象没有被初始化，因为*没有对象*。因此，下次遇到对象声明时，它将（尝试）再次初始化。

# c - 错误：“字符串常量前应为 '('”

> ID：10307762
> 
> 赞同：19
> 
> 时间：2012-04-25T00:16:55.450
> 
> 标签：c

致力于计算数组中值的几何平均值

该函数应该正确计算地理平均值，但我收到一条奇怪的错误消息

```
#include <stdio.h>
#include <stdint.h>
#include <math.h>

extern "C"

double geomean(double myarray[], int count)      ////error here, expected '(' before string constant
{
double geomean = 1;
double root = (1/(double)count);    
int i;
for(i = 0; i < count; i++)
    {
        geomean = geomean * myarray[i];
    }
geomean = pow(geomean, root);
return geomean;
} 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-04-25T00:19:26.063

`extern "C"`不是有效的 C（仅在 C++ 中有效）。如果您在纯 C 中工作，只需将其删除。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2016-11-08T08:39:52.013

我正在回答这个问题，试图涵盖更详细的答案中可能涵盖的内容，以帮助提问者或其他访问此页面的人。

> 错误：“字符串常量前应为 '('”</p>

正如您问题的其他答案中提到的，`extern "C"`不是有效的 C（它仅在 C++ 中有效）。如果您仅使用纯 C，则可以将其删除。

但是，如果您（或其他人）混合了 C 和 C++ 源文件，那么您可以使用宏`__cplusplus`。`__cplusplus`将为通过 C++ 编译器运行的任何编译单元定义宏。通常，这意味着 .cpp 文件和该 .cpp 文件包含的任何文件。

因此，如果不同的编译单元包含相同的 .h（或 .hh 或 .hpp 或 what-have-you），则可以在不同时间将它们解释为 C 或 C++。如果您希望 .h 文件中的原型引用 C 符号名称，那么它们在被解释为 C++ 时必须具有 extern "C" ，并且在被解释为 C 时它们不应具有 extern "C" （如您的情况你得到一个错误！）。

```
#ifdef __cplusplus
  extern "C" {
#endif

// Your prototype or Definition 
#ifdef __cplusplus
  }
#endif 
```

> 注意：`extern "C"`所做的只是影响链接。C++ 函数，在编译时，它们的名字被弄乱了。这就是使重载成为可能的原因。函数名称会根据参数的类型和数量进行修改，因此具有相同名称的两个函数将具有不同的符号名称。
> 
> 如果您包含具有 C 链接的代码的标头（例如由 C 编译器编译的代码），那么您必须`extern "C"`包含标头 - 这样您就可以与库链接。( `Otherwise, your linker would be looking for functions with names like _Z1hic when you were looking for void h(int, char)`)。

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2012-04-25T08:00:23.860

第一行应该是：`extern C;`

另一种选择是在没有关键字`c`的情况下在主函数之外声明......`extern`

# c# - XNA 中的四元数旋转

> ID：10307763
> 
> 赞同：4
> 
> 时间：2012-04-25T00:16:56.897
> 
> 标签：c#, xna, rotation

我做对了吗？

显然不是原因，否则我不会在这里发布问题，但我正在尝试围绕另一个模型对模型进行四元数旋转。

假设我有一个具有 vector3 位置和浮动旋转角度的盒子模型。我还有一个平截头体模型，它指向盒子模型，它的位置可以说是盒子模型的 50 个单位。平截头体还有一个vector3 位置和一个四元数旋转。

在场景 1 中，长方体和平截头体是“未旋转的”。这一切都很好。在场景 2 中，我只旋转盒子，并且我希望截头锥体随之旋转（有点像追逐相机），截头锥体始终直接指向盒子，并且与盒子的距离与未旋转的距离相同。显然，如果我只是通过使用 Matrix.CreateRotationY() 来旋转模型和截头体，对于盒子和截头体，截头体会稍微偏移到一边。

所以我认为围绕盒子的平截头体的四元数旋转会是最好的？为此，我尝试了以下方法，但没有运气。它在屏幕上绘制我的模型，但它也在屏幕上绘制了一个看起来像一个巨大盒子的东西，无论我将相机移动多远，这个盒子总是挡在路上

为了测试的目的，我有 3 个盒子和它们的 3 个相关的平截头体在我的 Game1 类中，我用位置和旋转初始化了 box[0]

```
boxObject[0].Position = new Vector3(10, 10, 10);
boxObject[1].Position = new Vector3(10, 10, 10);
boxObject[2].Position = new Vector3(10, 10, 10);

boxObject[0].Rotation = 0.0f;
boxObject[1].Rotation = 45.0f;
boxObject[2].Rotation = -45.0f; 
```

因此，所有 3 个框都绘制在相同位置但角度不同。然后做平截头体，我开始他们的立场：

```
float f = 50.0f;
frustumObject[0].Position = new Vector3(boxObject[0].Position.X,
            boxObject[0].Position.Y, boxObject[0].Position.Z + f);
frustumObject[1].Position = new Vector3(boxObject[1].Position.X,
            boxObject[1].Position.Y, boxObject[1].Position.Z + f);
frustumObject[2].Position = new Vector3(boxObject[2].Position.X,
            boxObject[2].Position.Y, boxObject[2].Position.Z + f); 
```

然后尝试围绕它们关联的盒子模型旋转：

```
frustumObject[0].ModelRotation = new Quaternion(boxObject[0].Position.X,
            boxObject[0].Position.Y, boxObject[0].Position.Z + f, 0);
frustumObject[0].ModelRotation = new Quaternion(boxObject[0].Position.X,
            boxObject[0].Position.Y, boxObject[0].Position.Z + f, 45);
frustumObject[0].ModelRotation = new Quaternion(boxObject[0].Position.X,
            boxObject[0].Position.Y, boxObject[0].Position.Z + f, -45); 
```

最后，为了绘制模型，我在我的 GameModel 类中绘制（）它们，该类也有：

```
public Model CameraModel { get; set; }
public Vector3 Position { get; set; }
public float Rotation { get; set; }
public Quaternion ModelRotation { get; set; }

public void Draw(Matrix view, Matrix projection)
    {
        transforms = new Matrix[CameraModel.Bones.Count];
        CameraModel.CopyAbsoluteBoneTransformsTo(transforms);

        // Draw the model
        foreach (ModelMesh myMesh in CameraModel.Meshes)
        {
            foreach (BasicEffect myEffect in myMesh.Effects)
            {
                // IS THIS CORRECT?????
                myEffect.World = transforms[myMesh.ParentBone.Index] *
                    Matrix.CreateRotationY(Rotation) * Matrix.CreateFromQuaternion(ModelRotation) * Matrix.CreateTranslation(Position);

                myEffect.View = view;
                myEffect.Projection = projection;

                myEffect.EnableDefaultLighting();
                myEffect.SpecularColor = new Vector3(0.25f);
                myEffect.SpecularPower = 16;
            }

            myMesh.Draw();
        }
    } 
```

谁能发现我哪里出错了？是因为我在 Draw() 中进行了 2 种类型的旋转吗？

> myEffect.World = transforms[myMesh.ParentBone.Index] * Matrix.CreateRotationY(Rotation) * Matrix.CreateFromQuaternion(ModelRotation) * Matrix.CreateTranslation(Position);

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-30T02:39:46.840

快速浏览一下，最好使用静态创建方法来创建四元数，例如`Quaternion.CreateFromAxisAngle(Vector3\. UnitY, rotation)`. 四元数的 X、Y、Z 和 W 的值与位置无关。方便的静态方法可以处理棘手的数学问题。

在您的情况下，您似乎希望在盒子旋转时保持截锥体指向盒子的同一侧，因此围绕盒子旋转截锥体。这需要在您的 draw 方法中完成的翻译方法略有不同。

为了围绕另一个对象旋转一个对象，您首先需要平移该对象，以使所需旋转的中心位于原点。然后旋转对象并将其平移回与第一步相同的量。

因此，在您的情况下，应该这样做（遵循未经测试的示例代码）；

```
// Construct the objects

boxObject.Position = new Vector3(10, 10, 10);
boxObject.Rotation = 45.0f;

frustumObject.Position = new Vector3(0, 0, 50f); // Note: this will be relative to the box (makes the math a bit simpler)
frustumObject.TargetPosition = boxObject.Position;
frustumObject.ModelRotation = Quaternion.CreateFromAxisAngle(Vector3\. UnitY, boxObject.Rotation); // Note: this rotation angle may need to be in radians.

// Box Draw()
// Draw the box at its position, rotated about its centre.
myEffect.World = transforms[myMesh.ParentBone.Index] * Matrix.CreateTranslation(Position) * Matrix.CreateRotationY(Rotation);

// Frustum Draw()
// Draw the frustum facing the box and rotated about the boxes centre.
myEffect.World = transforms[myMesh.ParentBone.Index] * Matrix.CreateTranslation(Position) * Matrix.CreateFromQuaternion(ModelRotation) * Matrix.CreateTranslation(TargetPosition); 
```

*假设：*

*   *盒子围绕自己的中心旋转*
*   *截头体面向盒子并围绕盒子中心旋转*

希望这可以帮助。

# javascript - Javascript杀死功能？

> ID：10307764
> 
> 赞同：1
> 
> 时间：2012-04-25T00:16:59.073
> 
> 标签：javascript

我有一个相当简单的 javascript 函数，它在按键上运行，检查按下的键是否是 enter 键，构建一个 url 并使用转发表单

```
window.location.href = "url"; 
```

这在 IE 中正常运行，但在 FireFox 和（可能还有 chrome）中出现错误。它执行代码（或类似的行为），但发生了其他事情，阻止了更改的发生。

如果我在该位置重定向之后立即放置一个 alert() ，那似乎会杀死所有其他代码并且我的重定向会做它的事情。但是，即使访客不必单击它，也向访问者显示一个警告框是俗气的。尝试使用超时功能也失败了。

常规的旧 javascript 中是否有任何方法可以停止所有其他执行足够长的时间以使功能正常工作。我需要一个 php die(); 的 javascript 等价物。（或不管它是什么）。我想让这个工作，而不必从这个网站上撕下胆量。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T02:13:40.810

这可能是因为事件冒泡吗？[http://www.quirksmode.org/js/events_order.html](http://www.quirksmode.org/js/events_order.html)描述了浏览器处理事件的不同方式。

# asp.net - ASP.NET：在会话中存储中继器值

> ID：10307768
> 
> 赞同：1
> 
> 时间：2012-04-25T00:17:51.137
> 
> 标签：asp.net, session, repeater

我想将数据绑定重复的值存储到会话状态。

到目前为止，这是我的代码：

```
<asp:Repeater ID="Repeater1" runat="server" DataSourceID="SqlDataSource1">
<ItemTemplate>
<h1 id="price" class="QPrice">$<%# Eval("Price")%></h1>
</ItemTemplate>
</asp:Repeater> 
```

代码背后”

```
Session("Qprice") = ? 
```

如何从代码隐藏中检索 h1 元素的值或检索 SqlDatasource1 的特定值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T13:47:30.207

Session("Qprice"+ID) = (decimal)drv.Row["Price"]; 最后，您将获得会话中的所有价格，并且您可以通过绑定到列表的数据的 id 访问。但是您正在存储您可以访问的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T03:51:15.143

我会先将它存储为强类型 List 并将其存储在 Session

```
Protected Sub Repeater1_ItemDataBound(sender As Object, e As RepeaterItemEventArgs)
    Dim repeaterItems As New List(Of Decimal)()

    If e.Item.ItemType = ListItemType.Item OrElse e.Item.ItemType = ListItemType.AlternatingItem Then
        Dim b As Button = TryCast(e.Item.FindControl("myButton"), Button)
        Dim drv As DataRowView = TryCast(e.Item.DataItem, DataRowView)

        repeaterItems.Add(CDec(drv.Row("Price")))
    End If

    Session("Qprice") = repeaterItems
End Sub 
```

所以我以后可以再次访问它

```
Dim repeaterItemsFromSession As List(Of Decimal) = DirectCast(Session("Qprice"), List(Of Decimal)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T00:29:02.523

在 repeater1 中定义对象 DatakeyNames="Price" 并指定 Item Data Bound 事件，然后在后面的代码中

```
protected void repeater1_ItemDataBound(object sender, RepeaterItemEventArgs e) 
{ 
    if (e.Item.ItemType == ListItemType.Item 
                          || e.Item.ItemType == ListItemType.AlternatingItem) 
    { 
        Button b = e.Item.FindControl("myButton") as Button;  
        DataRowView drv = e.Item.DataItem as DataRowView; 
        Session("Qprice") = (decimal)drv.Row["Price"];
    } 
} 
```

在这里，您可以保存价值或用价格做任何您想做的事情。

# ios - 没有 glFrustum 和 glOrtho 设置的投影的视图体积是多少？

> ID：10307769
> 
> 赞同：0
> 
> 时间：2012-04-25T00:17:54.723
> 
> 标签：ios, opengl-es

我正在阅读来自 WWDC2010 的示例代码 GLVideoFrame。在此示例中，它具有如下代码：

```
static const GLfloat squareVertices[] = {
    -0.5f,  -0.33f,
     0.5f,  -0.33f,
    -0.5f,   0.33f,
     0.5f,   0.33f,
};
...
glMatrixMode(GL_PROJECTION);
glLoadIdentity();
glMatrixMode(GL_MODELVIEW);
glLoadIdentity();
glTranslatef(0.0f, (GLfloat)(sinf(transY)/2.0f), 0.0f);
transY += 0.075f;

...
glVertexPointer(2, GL_FLOAT, 0, squareVertices); 
```

请注意，此代码不会调用任何函数，如 glFrustum 或 glOrtho 用于 openGL 投影设置。

通过仅调用 gLoadIdentity()，“默认”视图体积是多少？

它将是透视投影还是正交投影？

编辑：更具体地说，视图体积是“在所有三个轴上从 -1 到 1”的立方体吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T06:15:05.973

OpenGL 假设在 ModelView 和 Projection 变换之后，所有可见元素都在剪辑空间（或 NDC 空间）中；它使用立方体`[-1;+1]^3`。矩阵内容完全由您负责。由于您加载了单位矩阵，因此根本没有投影。

# php - ZipArchive extractTo 抛出异常

> ID：10307772
> 
> 赞同：0
> 
> 时间：2012-04-25T00:18:29.470
> 
> 标签：php, codeigniter, ziparchive

我在**Code Igniter**框架 PHP 应用程序中使用**ZipArchive 。****提取工作正常，但是代码点火器在extractTo**步骤抛出错误，但它不会使应用程序崩溃，并且应用程序会一直运行到最后，但代码点火器仍会触发并显示此错误。该目录存在于 extractTo 之前，它可以正确提取并继续运行，但为什么会抛出此错误？

 ****```
 $zipVar = new ZipArchive;
        $res = $zipVar->open($input_zip); 
        if ($res === TRUE) 
        {                           
             $zipVar->extractTo($target_dir);
             $zipVar->close();                        
         } 
```

![在此处输入图像描述](../Images/ab6b12c43c5e72aa1d87f2876db937a8.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T00:35:21.517

尝试

```
$input_zip = "" ; // 
$target_dir = "" ; //

if(!is_file($input_zip) || !is_readable($target_dir))
{
    die("Can't Read Input");
}

if(!is_dir($target_dir) || !is_writable($target_dir))
{
    die("Can't Write to Target");
}

$zip = new ZipArchive;
$res = $zip->open($input_zip);
if ($res === TRUE)
{
    echo 'ok';
    $zip->extractTo($target_dir);
    $zip->close();
}
else {
    die("Failed");
} 
```****

# favicon - 如何为我想要的每个目录创建一个 favicon.ico 文件？

> ID：10307784
> 
> 赞同：7
> 
> 时间：2012-04-25T00:19:51.273
> 
> 标签：favicon

> **可能重复：**
> [子目录所有子域中的网站图标](https://stackoverflow.com/questions/4128570/favicon-in-subdirectory-all-subdomain)

我的网站是一个大网站，里面有很多小项目。每个项目也有自己的`favicon.ico`文件（显示在 url 栏的左侧），但即使我将`favicon.ico`文件放在子目录中，它仍然不会显示，并且将使用`favicon.ico`文件 put在根目录。

我该如何解决这个问题？

卢卡斯

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-25T00:27:26.470

您可以按页面设置它，如下所示：

```
<link rel="shortcut icon" href="http://example.com/myicon.ico" /> 
```

`<head>..</head>`标签内。

在每个目录的基础上设置它不起作用。

# c# - 我需要这个字段是易变的吗？

> ID：10307787
> 
> 赞同：9
> 
> 时间：2012-04-25T00:20:20.493
> 
> 标签：c#, .net, multithreading, volatile

我有一个线程旋转，直到另一个线程更改的 int 是某个值。

```
int cur = this.m_cur;
while (cur > this.Max)
{
    // spin until cur is <= max
    cur = this.m_cur; 
} 
```

是否需要将 this.m_cur 声明为 volatile 才能正常工作？由于编译器优化，这是否有可能永远旋转？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-25T00:53:02.453

是的，这是一个硬性要求。允许即时编译器将 m_cur 的值存储在处理器寄存器中，而无需从内存中刷新它。x86 抖动实际上有，x64 抖动没有（至少在我最后一次查看时）。

*需要volatile*关键字来抑制这种优化。

易失性在 Itanium 内核上意味着完全不同的东西，这是一种内存模型较弱的处理器。不幸的是，这就是它成为 MSDN 库和 C# 语言规范的原因。这对 ARM 内核意味着什么还有待观察。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-25T00:26:19.603

下面的博客有一些关于 c# 内存模型的有趣细节。简而言之，使用 volatile 关键字似乎更安全。

[http://igoro.com/archive/volatile-keyword-in-c-memory-model-explained/](http://igoro.com/archive/volatile-keyword-in-c-memory-model-explained/)

从下面的博客

```
class Test
{
    private bool _loop = true;

    public static void Main()
    {
        Test test1 = new Test();

        // Set _loop to false on another thread
        new Thread(() => { test1._loop = false;}).Start();

        // Poll the _loop field until it is set to false
        while (test1._loop == true) ;

        // The loop above will never terminate!
    }
} 
```

> 有两种可能的方法可以终止 while 循环： 使用锁来保护对 _loop 字段的所有访问（读取和写入） 将 _loop 字段标记为易失性 读取非易失性字段可能观察到的原因有两个过时的值：编译器优化和处理器优化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T00:59:52.953

这取决于如何修改 m_cur。如果它使用的是普通的赋值语句，例如`m_cur--;`，那么它确实需要是 volatile 的。但是，如果使用[Interlocked](http://msdn.microsoft.com/en-us/library/system.threading.interlocked.aspx)操作之一对其进行修改，则不会，因为 Interlocked 的方法会自动插入内存屏障以确保所有线程都获得备忘录。

通常，使用 Interlocked 修改跨线程共享的原子值是更可取的选择。它不仅为您解决了内存障碍，而且还往往比其他同步选项快一点。

也就是说，就像其他人所说的那样，轮询循环非常浪费。最好暂停需要等待的线程，让修改 m_cur 的人负责在时机成熟时将其唤醒。[Monitor.Wait() 和 Monitor.Pulse()](http://msdn.microsoft.com/en-us/library/system.threading.monitor.aspx)以及[AutoResetEvent 都](http://msdn.microsoft.com/en-us/library/system.threading.autoresetevent.aspx)可能非常适合该任务，具体取决于您的特定需求。

# xml - 如何从 XML 文件中删除带有样式属性的 DIV 标签？

> ID：10307789
> 
> 赞同：1
> 
> 时间：2012-04-25T00:20:40.417
> 
> 标签：xml, regex

我有一个巨大的 Wordpress XML 导出。不幸的是，一些混蛋设法将代码注入到安装中，并将 DIV 注入到内容中。现在我想清理那个烂摊子。这是它的样子：

```
<p>Normal Text</p>
<div style="position:absolute;top:-9660px;left:-4170px;"><a href="http://insane.link.com">Insane Linktext</a></div>
<div style="position:absolute;top:-2460px;left:-5370px;"><a href="http://insane.link.com">Another Insane Linktext</a></div>
<p>Normal good people's brains' text</p> 
```

我考虑过使用一些正则表达式来匹配包含 STYLE 属性的 DIV。可用的工具是 Aptana 或其他文本编辑器和 PHP 服务器以及 OSX 终端。对此有何建议？

谢谢和干杯！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T01:12:26.943

我建议不要使用正则表达式，而是使用真正的 XML 解析器。例如，由于您在 OS X 上，因此已经安装了 Ruby，您可以使用以下命令清理 HTML：

```
require 'nokogiri'                      # Use `sudo gem install nokogiri` first
html = Nokogiri.HTML(IO.read(ARGV[0]))  # read and parse the HTML document
html.css('div[style]').remove           # destroy all <div style="...">...</div>
File.open(ARGV[1],'w'){ |f| f << html } # write the html to disk as a new file 
```

您首先需要根据评论安装 Nokogiri。

然后，将上面的内容另存为“clean_divs.rb”，然后输入`ruby clean_divs.rb my.html my_fixed.html`（其中第一个是要读取的文件名，第二个是要写入的文件名）。

*如果您想在销毁时更精确，可以使用 XPath 选择要销毁的元素，例如`html.xpath('//div[@style][a]').remove`仅查找具有样式属性和`<a>`直接子元素的 div。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T01:10:04.370

这可能会对您有所帮助：它将与您在上面提供的 div 匹配：

```
<div style="[a-zA-Z0-9-:;]+"><a href="[a-z:/.]+">[a-zA-Z ]+</a></div> 
```

但是，它只会匹配一个`div > a > text`模式，并且只匹配具有 style 属性的 div，没有别的。

您应该能够使用大多数 HTML 编辑器进行查找和替换（Dreamweaver 和 Notepad++ 都允许）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T01:31:16.303

您可以对这些元素使用带有空模板的修改后的[身份转换](http://en.wikipedia.org/wiki/Identity_transform)`<div>`来删除它们：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="xml" version="1.0" encoding="UTF-8" indent="yes"/>

    <!--default processing for content is to copy forward -->
    <xsl:template match="@*|node()">
        <xsl:copy>
            <xsl:apply-templates select="@*|node()"/>
        </xsl:copy>
    </xsl:template>

    <!--remove the rogue div elements -->
    <xsl:template match="div[@style]" />

</xsl:stylesheet> 
```

# python - Python 中的记忆、类和多处理

> ID：10307794
> 
> 赞同：4
> 
> 时间：2012-04-25T00:21:15.097
> 
> 标签：python, dictionary, multiprocessing

我正在尝试使用 python 2.7.2 中的多处理模块进行一些计算。我的代码是这样的：

```
from multiprocessing import Pool
import sys
sys.setrecursionlimit(10000)
partitions = []
class Partitions:
    parts = {} #My goal is to use this dict to speed
               #up calculations in every process that
               #uses it, without having to build it up
               #from nothing each time
    def __init__(self):
        pass
    def p1(self, k, n):
        if (k,n) in Partitions.parts:
            return Partitions.parts[(k, n)]
        if k>n:
            return 0
        if k==n:
            return 1
        Partitions.parts[(k,n)] = self.p1(k+1, n) + self.p1(k, n-k)
        return Partitions.parts[(k,n)]

    def P(self, n):
        result = 0
        for k in xrange(1,n/2 + 1):
            result += self.p1(k, n-k)
        return 1 + result

p = Partitions()

def log(results):
    if results:
        partitions.extend(results)
    return None

def partWorker(start,stop):
    ps = []
    for n in xrange(start, stop):
        ps.append(((1,n), p.P(n)))
    return ps

def main():
    pool = Pool()
    step = 150
    for i in xrange(0,301,step):
        pool.apply_async(partWorker, (i, i+step), callback = log)

    pool.close()
    pool.join()

    return None

if __name__=="__main__":
    main() 
```

我是新手，我基本上复制了这个页面上主要代码的格式： [python prime crunching: processing pool is slow?](https://stackoverflow.com/questions/7209657/python-prime-crunching-processing-pool-is-slower) 我可以让每个核心中运行的进程都查看同一个字典来帮助他们的计算吗？它现在的行为方式，每个进程创建它自己的字典，它像疯了一样吃掉 ram。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T00:54:53.787

我不确定这是否是你想要的......但是，看看 multiprocessing.Manager （[http://docs.python.org/library/multiprocessing.html#sharing-state-between-processes](http://docs.python.org/library/multiprocessing.html#sharing-state-between-processes)）。管理器允许您在进程之间共享一个字典。

# c# - 为什么这个谷歌翻译代码不起作用？

> ID：10307796
> 
> 赞同：-2
> 
> 时间：2012-04-25T00:21:38.207
> 
> 标签：c#, google-translate

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Net;
using System.Text.RegularExpressions;

namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
            TranslateText("hi", "German");
        }

        private void Form1_Load(object sender, EventArgs e)
        {

        }

         public static string TranslateText(string input, string languagePair)
        {
            return TranslateText(input, languagePair, System.Text.Encoding.UTF7);
        }

        /// <summary>
        /// Translate Text using Google Translate
        /// </summary>
        /// <param name="input">The string you want translated</param>
        /// <param name="languagePair">2 letter Language Pair, delimited by "|". 
        /// e.g. "en|da" language pair means to translate from English to Danish</param>
        /// <param name="encoding">The encoding.</param>
        /// <returns>Translated to String</returns>
        public static string TranslateText(string input, string languagePair, Encoding encoding)
        {
            string url = String.Format("http://www.google.com/translate_t?hl=en&ie=UTF8&text={0}&langpair={1}", input, languagePair);

            string result = String.Empty;

            using (WebClient webClient = new WebClient())
            {
                webClient.Encoding = encoding;
                result = webClient.DownloadString(url);
            }

            Match m = Regex.Match(result, "(?<=<div id=result_box dir=\"ltr\">)(.*?)(?=</div>)");

            if (m.Success)
                result = m.Value;
            MessageBox.Show(result);

            return result;
        }

    }
} 
```

我在构造函数中添加了以下行：

```
TranslateText("hi", "German"); 
```

在底部我添加了：

```
MessageBox.Show(result); 
```

我想让测试将“hi”这个词翻译成德语但我得​​到的结果是在消息框中是一个很长的文本，其中包含所有谷歌网站。

我试图手动访问字符串 url 地址中的网站，并且它的工作即时到谷歌翻译网站。

我不明白为什么它不起作用。我想稍后将文本文件中的一些文本改为“hi”。

我尝试过使用断点，发现这部分成功总是返回 false 不知道为什么：

```
if (m.Success)
    result = m.Value; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T01:18:28.347

我认为你没有从你的代码和谷歌获得你的 html 结果中的翻译文本或值。

**原因：**

如果您通过浏览器执行此操作，它不会翻译成您期望的语言，例如：

[http://www.google.com/translate_t?hl=en&ie=UTF8&text=hi&langpair=de](http://www.google.com/translate_t?hl=en&ie=UTF8&text=hi&langpair=de)

我使用`langpair=de`or`langpair=German`并且不起作用，它总是显示“hi”作为我的初始文本，而不是“hallo”（德语文本）。

好吧，只是为了回答您的问题以获取文本，请执行以下操作：

**将此方法添加到您的类中：**

```
public static string getBetween(string strSource, string strStart, string strEnd)
{
    int Start, End;
    if (strSource.Contains(strStart) && strSource.Contains(strEnd))
    {
        Start = strSource.IndexOf(strStart, 0) + strStart.Length;
        End = strSource.IndexOf(strEnd, Start);
        return strSource.Substring(Start, End - Start);
    }
    else
    {
        return "";
    }
} 
```

**在“TranslateText”方法中更改以下内容：**

```
 //Match m = Regex.Match(result, "(?<=<div id=result_box dir=\"ltr\">)(.*?)(?=</div>)");
    string text = getBetween(result, "<span id=result_box class=\"short_text\">", "</span>");

    //if (m.Success)
    //    result = m.Value;
    return text; 
```

**现在像这样执行你的代码：**

```
// this will return empty ("") if no text found.
// or any problem happens (like lose your internet connection)
string translatedText = TranslateText("hi", "German");
Console.Write(translatedText); 
```

此时，如果您从 google 获取翻译文本，它将在您的应用程序中检索。

**建议：**

*   使用控制台应用程序并且没有 Windows 窗体，它会更快。

**警告：**

*   “谷歌不是免费的翻译工具。你所做的是违反条款”。

希望这可以帮助 ：-）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T00:28:37.877

使用正则表达式以外的东西解析 html 会更容易，更健壮。然后，您可以在解析后的 H​​TML 树中搜索结果并从那里提取它。

请参阅[在 C# 中解析 html 的最佳方法是什么？](https://stackoverflow.com/questions/56107/what-is-the-best-way-to-parse-html-in-c)

# java - Java House 小程序

> ID：10307797
> 
> 赞同：1
> 
> 时间：2012-04-25T00:21:43.947
> 
> 标签：java

所以我只是从小程序开始，当小程序加载时，我正在建造一扇敞开的门和两扇敞开的窗户的房子。当您单击这些窗户或门时，它们将关闭。不过我的问题是我需要做什么才能重新打开这些门窗。我想我需要以某种方式将布尔变量设置为 False 并重新绘制。我会在哪里做这个。我不需要你们为我写代码，我只想知道我应该做什么。

提前谢谢，

瑞克

```
 import java.awt.*;
   import java.awt.event.*;
   import java.applet.*;

/**
Rick Armstrong
Chapter 14 - House Applet
*/

   public class HouseApplet extends Applet {    
  boolean leftWin, rightWin, door;

  public void init()      
  {      
     leftWin = false;
     rightWin = false;
     door = false;      

     setBackground(Color.white);       
     addMouseListener(new MyMouseListener());       
  }

  public void paint(Graphics g)
  {
     super.paint(g);

    // Draw the house.
     g.setColor(Color.black);
     g.drawRect(100, 100, 200, 100);

    // Draw the roof
     g.drawLine(80, 100, 320, 100);
     g.drawLine(80, 100, 200, 40);
     g.drawLine(200, 40, 320, 100);

    // Draw the left window open.
     g.fillRect(120, 130, 40, 40);

    // Draw the right window open.
     g.fillRect(240, 130, 40, 40);

    // Draw the door open.
     g.fillRect(180, 130, 40, 70);          

     if (leftWin) {
        // Draw the left window closed.
        g.setColor(Color.white);
        g.fillRect(120, 130, 40, 40);
        g.setColor(Color.black);
        g.drawRect(120, 130, 40, 40);
        g.drawLine(140, 130, 140, 170);
        g.drawLine(120, 150, 160, 150);

     }

     if (rightWin) {
        // Draw the right window closed.
        g.setColor(Color.white);
        g.fillRect(240, 130, 40, 40);
        g.setColor(Color.black);
        g.drawRect(240, 130, 40, 40);
        g.drawLine(260, 130, 260, 170);
        g.drawLine(240, 150, 280, 150);

     }

     if (door) {
        // Draw the door closed.
        g.setColor(Color.white);
        g.fillRect(180, 130, 40, 70);
        g.setColor(Color.black);
        g.drawRect(180, 130, 40, 70);
        g.fillOval(210, 165, 07, 07);

     }    
  }

  private class MyMouseListener implements MouseListener
  {
     public void mousePressed(MouseEvent e)
     {
     }

     public void mouseClicked(MouseEvent e)
     {
        int currentx = e.getX();
        int currenty = e.getY();

        boolean WindowLeft = (currentx >= 120 && currentx < 160 && currenty >= 130 && currenty <= 170);
        if (WindowLeft)
        {
           leftWin = true;
           repaint();               
        }

        boolean WindowRight = (currentx >= 240 && currentx < 280 && currenty >= 130 && currenty <= 170);
        if (WindowRight)
        {
           rightWin = true;
           repaint(); 
        }

        boolean Door = (currentx >= 180 && currentx < 220 && currenty >= 40 && currenty <= 200);
        if (Door)
        {            
           door = true;
           repaint();     
        }  

        else;  
     }

     public void mouseReleased(MouseEvent e)
     {
     }

     public void mouseEntered(MouseEvent e)
     {
     }

     public void mouseExited(MouseEvent e)
     {
     }
  } 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T00:26:23.290

也许我误解了这个问题，但为什么你总是在事件处理程序中将值设置为 true？

如果你想要一个切换行为，你可以简单地写：`value = !value`然后重新绘制。由于您最初将值设置为 false，因此下一次单击会将其设置为 true，下一次设置为 false，等等。

例如：

```
if (WindowLeft)
        {
           leftWin = !leftWin;
           repaint();               
        } 
```

请注意，您可能会通过单击比框架更新视图的速度更快来引起某种“竞争条件”，但这对于初始问题通常不是问题。

顺便说一句：就可读性而言，请考虑以传达其含义的方式命名变量。例如，命名门是否会唤起布尔值？并不真地。但是 doorOpen 是，它有助于解释变量的含义及其转换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-05T16:46:51.543

```
if (WindowRight)
{
    rightWin = false;
    repaint(); 
}
else {
    rightWin = true;
    repaint(); 
} 
```

试试上面的。当您在窗口内单击时，它会关闭，否则会打开

# c# - 创建路由以接受特定控制器的两个参数

> ID：10307801
> 
> 赞同：0
> 
> 时间：2012-04-25T00:21:58.177
> 
> 标签：c#, asp.net, asp.net-mvc

我的 FilesController 中有这个控制器方法：

```
public ActionResult Download(int id, string filename)
{
    var file = _filesRepository.GetFile(id);

    // Write it back to the client
    Response.ContentType = file.FileMimeType;
    Response.AddHeader("content-disposition", "attachment; filename=" + file.FileName);
    Response.BinaryWrite(file.FileData);

    return new EmptyResult();
} 
```

如果我导航到

> /Files/Download/123?filename=myimage.png

但是，如果我导航到，我希望它可以工作

> /文件/下载/123/myimage.png

我知道我需要为此创建一个自定义路线，但我尝试过的一切都不起作用。我希望它只接受 FilesController 和 Download 方法的两个参数。那可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T00:31:30.303

是的，如果您创建一条新路线，这非常容易。在您的`Global.asax.cs`文件中，在默认路由之前，添加以下路由：

```
routes.MapRoute(
  "FileDownload", // Route name
  "Files/Download/{id}/{filename}", // URL with parameters
  new { 
    controller = "Files", 
    action = "Download", 
    id = UrlParameter.Optional, 
    filename = UrlParameter.Optional 
  } // Parameter defaults
); 
```

然后你的控制器动作应该像你当前定义的那样工作。

# iphone - iOS 5.1 上的 ffmpeg 未定义符号错误

> ID：10307804
> 
> 赞同：0
> 
> 时间：2012-04-25T00:22:21.257
> 
> 标签：iphone, ios, ffmpeg

所以我现在花了几个小时来研究网上关于为 iOS 构建 ffmpeg 的少量信息。构建过程似乎运行良好，我最终得到了 armv6 和 armv7 的胖文件，我将它们拖到我的项目中。

但是，每当我尝试使用“avcodec_init()”命令时，都会出现以下错误：

> 架构 armv7 的未定义符号：“_avcodec_init”，引用自：
> 
> ```
>  -[FirstViewController viewDidLoad] in FirstViewController.o 
> ```
> 
> ld：未找到架构 armv7 的符号
> 
> clang：错误：链接器命令失败，退出代码为 1（使用 -v 查看调用）

库文件包含在项目设置的“Link Binary with Libraries”中，因此它们肯定会编译到应用程序中。我一生都无法弄清楚为什么我会在这方面出错。

我尝试了几个不同的项目，并从网上下载了一些现有的项目文件并得到相同的错误。

这是我使用的构建脚本：

> export PLATFORM="iPhoneOS" export MIN_VERSION="4.0" export MAX_VERSION="5.1" export DEVROOT=/Volumes/Lion/Applications/Xcode.app/Contents/Developer/Platforms/${PLATFORM}.platform/Developer export SDKROOT=$ DEVROOT/SDKs/${PLATFORM}${MAX_VERSION}.sdk export CC=$DEVROOT/usr/bin/llvm-gcc export LD=$DEVROOT/usr/bin/ld export CPP=$DEVROOT/usr/bin/cpp export CXX=$DEVROOT/usr/bin/llvm-g++ export AR=$DEVROOT/usr/bin/ar export LIBTOOL=$DEVROOT/usr/bin/libtool export NM=$DEVROOT/usr/bin/nm export CXXCPP=$DEVROOT /usr/bin/cpp 导出 RANLIB=$DEVROOT/usr/bin/ranlib
> 
> COMMONFLAGS="-pipe -gdwarf-2 -no-cpp-precomp -isysroot ${SDKROOT} -marm -fPIC" export LDFLAGS="${COMMONFLAGS} -fPIC" export CFLAGS="${COMMONFLAGS} -fvisibility=hidden"出口 CXXFLAGS="${COMMONFLAGS} -fvisibility=hidden -fvisibility-inlines-hidden"
> 
> FFMPEG_LIBS="libavcodec libavdevice libavformat libavutil libswscale"
> 
> echo "正在构建 armv6..​​."
> 
> 清理 ./configure \ --cpu=arm1176jzf-s \ --extra-cflags='-arch armv6 -miphoneos-version-min=${MIN_VERSION} -mthumb' \ --extra-ldflags='-arch armv6 - miphoneos-version-min=${MIN_VERSION}' \ --enable-cross-compile \ --arch=arm \ --target-os=darwin \ --cc=${CC} \ --sysroot=${SDKROOT } \ --prefix=已安装 \ --disable-network \ --disable-decoders \ --disable-muxers \ --disable-demuxers \ --disable-devices \ --disable-parsers \ --disable-encoders \ --disable-protocols \ --disable-filters \ --disable-bsfs \ --enable-decoder=h264 \ --enable-decoder=svq3 \ --enable-gpl \ --enable-pic \ --disable- doc perl -pi -e 's/HAVE_INLINE_ASM 1/HAVE_INLINE_ASM 0/' config.h make -j3
> 
> mkdir -p build.armv6 for i in ${FFMPEG_LIBS}; 做 cp ./$i/$ia ./build.armv6/; 完毕
> 
> echo "正在构建 armv7..."
> 
> 清理 ./configure \ --cpu=cortex-a8 \ --extra-cflags='-arch armv7 -miphoneos-version-min=${MIN_VERSION} -mthumb' \ --extra-ldflags='-arch armv7 - miphoneos-version-min=${MIN_VERSION}' \ --enable-cross-compile \ --arch=arm \ --target-os=darwin \ --cc=${CC} \ --sysroot=${SDKROOT } \ --prefix=已安装 \ --disable-network \ --disable-decoders \ --disable-muxers \ --disable-demuxers \ --disable-devices \ --disable-parsers \ --disable-encoders \ --disable-protocols \ --disable-filters \ --disable-bsfs \ --enable-decoder=h264 \ --enable-decoder=svq3 \ --enable-gpl \ --enable-pic \ --disable- doc perl -pi -e 's/HAVE_INLINE_ASM 1/HAVE_INLINE_ASM 0/' config.h make -j3
> 
> mkdir -p build.armv7 for i in ${FFMPEG_LIBS}; 做 cp ./$i/$ia ./build.armv7/; 完毕
> 
> mkdir -p build.universal for i in ${FFMPEG_LIBS}; 做 lipo -create ./build.armv7/$ia ./build.armv6/$ia -output ./build.universal/$ia; 完毕
> 
> 对于 ${FFMPEG_LIBS} 中的我；做 cp ./build.universal/$ia ./$i/$ia; 完毕
> 
> 进行安装

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T00:42:28.603

我还没有使用过 ffmpeg（尽管我的一些老板让我考虑使用它），但 lemme 提出了一些可能在这里发生的事情。

1)

让我们看看这个符号是否真的存在于你编译的库中。

转到终端并“ `cd`”到您的 .a 库所在的目录。

然后在一行中输入“ `nm -arch armv7 ffmpeg.a | egrep avcodec_init`”（您可以`ffmpeg.a`在我的示例命令中将其替换为 .a 库的实际名称）。这会为 armv7 架构转储库中的符号并将其通过管道传输到 grep，这应该会显示 avcodec_init 是否确实*存在*于您的库中。

如果它没有出现，那么它没有被编译到你的库中。

2)

如果该符号确实存在于您的库中，请确保您的 .a 文件的路径在您的项目中是正确的。您可能不小心只包含了一个仅模拟器（i386 架构）版本的 ffmpeg。

# jquery - 如何单独删除动态创建的段落？

> ID：10307807
> 
> 赞同：-1
> 
> 时间：2012-04-25T00:23:07.687
> 
> 标签：jquery, dynamic, paragraph

我有一个按钮，可以在 div 中动态创建段落以及 ID。当您创建一个段落时，您还可以通过单击它来选择该段落（“背景颜色更改”），同时创建一个 div（“当您单击段落时”），其中包含一个链接。试图单独删除，但它会一次删除所有段落

如何删除正在选择的段落（“我的意思是单独”）？

这是链接以及我到目前为止所拥有的：

[http://jsfiddle.net/RzvV5/88/](http://jsfiddle.net/RzvV5/88/)

Javascript/jQuery 代码：

```
$(document).ready(function(){
    var id = 1;
    $("#push").on({
        click: function(){
            var pr = $('<p class="test">This is text ' + id + '</p>');
            var d = $("#Test");
            var pclone = $(pr).clone();
            pclone.on({
                mouseenter: function(){    
                    $(this).addClass("inside");
                },
                mouseleave: function(){                             
                    $(this).removeClass("inside"); 
                },
            });
            pclone.appendTo(d);
            id++;
        }
    });

    var div =  $('<div class="customD" id="d"></div>');
    var del = $('<a href="#" class="delete" id="erase">Delete</a>');
    var pcust = $(div).clone();
    var pdel = $(del).clone();

    $("#Test").on("click", "p", function(){ 
        var cur = $(this).css("background-color");

        if(cur=="rgb(255, 255, 255)") {  
            $(this).css("background-color","red").addClass("help insider");
            $(this).after(pcust);
        } 
        else { 
            $(this).css("background-color","white").removeClass('help insider');
            $(pcust).remove();
        }    

        $(pcust).append(pdel);

    }); 
}); 
```

HTML 代码：

```
<html>
<body>
    <a href="#" id="push">Push</a>
    <div id="Test"></div>
</body>
</html> 
```

CSS 代码：

```
.test { color: #000; padding: .5em; margin: 0px; border: 2px solid white; background: white;} 

.help { border: 2px dashed #FDD }

.inside { border: 2px solid red    }

.insider { border: 2px solid #FDD; }

.delete {  font-size: 12px; }
.customD { background: yellow} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T00:32:12.207

您可以添加点击事件处理程序来删除链接

```
 $(".delete").live("click",function(){
        $(this).parent().prev().remove();
        $(this).remove();
    }); 
```

顺便提一句。您不必每次都克隆链接及其父 div，如果您重用它，您可以构建圆顶的那部分并保持相同的引用

```
var div =  $('<div class="customD" id="d"></div>');
var del = $('<a href="#" class="delete" id="erase">Delete</a>');
div.append(del);

    $("#Test").on("click", "p", function(){ 

       ....
       $(pcust).append(del); //this will not clone delete div, it will actually replace its position it dome structure and move it from one paragraph to "pcust". This will save memory!!!

        ....
    }; 
```

# php - PHP没有得到SQL日期字段1970

> ID：10307809
> 
> 赞同：1
> 
> 时间：2012-04-25T00:23:13.870
> 
> 标签：php, mysql, sql, date

我正在构建一个网站（我的第一个！），它列出了事件，必要时嵌套在年和月的标题中。我知道这有点乱，但是嘿！

我在某处犯了一个错误，并且 MySQL 数据库中的日期字段未正确传递。所以它只是默认为 01-01-1970

```
<?php

    $query = 'SELECT * FROM events';
    $result = mysql_query( $query );
    $current_month = 'no_month_given';
    $current_year = 'no_year_given';
    $year_count = 0;
    $month_count = 0;
    $year = date("Y", strtotime($row['event_startdate']));
    $month = date("M", strtotime($row['event_startdate']));
    $startday = date("d", strtotime($row['event_startdate']));
    $endday = date("d", strtotime($row['event_enddate']));

    while($row = mysql_fetch_array($result))
        {

    /* YEAR */

            if($current_year != $year) 
                {
                    $current_year = $year;
                    echo "  <div id=\"year\">
                    <p class=\"vert\">" .$current_year. "</p>";
                    $year_count++;
                }

    /* MONTH */

        if($current_month != $month) 
                {
                    $current_month = $month;
                    echo '<div id="month"><h1>' . $current_month . '</h1>';
                    $month_count++;
                }

    /* EVENT DETAILS */

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T00:25:37.990

将这些行放在 while 循环中：

```
$year = date("Y", strtotime($row['event_startdate']));
$month = date("M", strtotime($row['event_startdate']));
$startday = date("d", strtotime($row['event_startdate']));
$endday = date("d", strtotime($row['event_enddate'])); 
```

因为 $row 之前没有定义，因此您不能在循环外使用 $row 变量。

# ruby-on-rails - Object.attribute_changed？不在 Rails 控制器中工作

> ID：10307811
> 
> 赞同：2
> 
> 时间：2012-04-25T00:23:51.933
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, devise, actioncontroller

我正在覆盖设计用户的注册控制器以检查用户是否更改了城市，如果是，则在会话中再次加载 Geokit 对象。

```
session[:geo_location] = User.geocode(resource.city) if resource.city_changed? 
```

问题是没有这样做。下面的代码没有返回任何内容。如果我删除`if resource.city_changed?`它，它适用于所有情况，无论资源是否已更改。

```
 User::RegistrationsController < Devise::RegistrationsController

  def update 
   self.resource = resource_class.to_adapter.get!(send(:"current_#    {resource_name}").to_key)    
    if resource.update_with_password(params[resource_name])

      session[:geo_location] = User.geocode(resource.city) if resource.city_changed?

      set_flash_message :notice, :updated if is_navigational_format?
      sign_in resource_name, resource, :bypass => true
      respond_with resource, :location => after_update_path_for(resource)
    else
      clean_up_passwords(resource)
      respond_with_navigational(resource){ render_with_scope :edit }
    end

  end

end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T00:40:15.143

`update_with_password`打电话吗`save`？如果是这样，它会清除模型的“脏”状态及其所有属性。您需要`resource.city_changed?` **在**设置属性**之后**调用`save`.

# c# - 访问 WP7 联系人

> ID：10307813
> 
> 赞同：4
> 
> 时间：2012-04-25T00:23:53.633
> 
> 标签：c#, windows-phone-7, sms

我有一个项目，我想自动化短信，并有时间和日期将短信推送给特定的联系人。那么如何以简洁有效的方式从手机中提取联系人？基本上我希望用户按下一个按钮，然后应用程序转到联系人列表，然后用户检查或单击一个名称，并将其存储到一个字符串中。

另外，如果有人能给我一个关于如何安排短信并在时间到了就启动它的提示，那将很有帮助！先感谢您！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T00:44:29.967

你想要[PhoneNumberChooser](http://msdn.microsoft.com/en-us/library/hh394021%28v=vs.92%29.aspx)。而且你不能排队发送短信，真的。出于安全原因，用户拥有最终输入。您可以让您的应用程序在指定时间段后打开 SMS 屏幕，但这是一个可怕的想法。

要发送 SMS，您需要[SMSComposeTask](http://msdn.microsoft.com/en-us/library/hh394005%28v=vs.92%29.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T10:51:53.553

看看[Microsoft.Phone.UserData](http://msdn.microsoft.com/en-us/library/microsoft.phone.userdata%28v=vs.92%29.aspx)

# jquery - 如何知道在Javascript中单击上一个或下一个按钮的时间？

> ID：10307814
> 
> 赞同：0
> 
> 时间：2012-04-25T00:24:06.250
> 
> 标签：jquery, ajax, user-interface, tabs, navigation

我有用于站点导航的带有 Ajax 和锚点（如菜单）的 JQuery UI 选项卡，一切正常，但是当我单击上一页/下一页浏览器按钮时，什么也没有发生，

我想知道当我单击浏览器的上一个按钮（与下一个相同）时是否可以返回到上一个选项卡。例如，当您查看项目源代码时，就像在 github 上一样。

当有人单击上一页/下一页按钮时，我可以设置要执行的功能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T00:35:09.010

只要您可以选择一个元素，您就可以让它对点击事件做出反应。这里我选择了id。

[http://jsfiddle.net/KVyz7/](http://jsfiddle.net/KVyz7/)

概括：

```
<img id="previmg" src="http://placekitten.com/75/100"><br>
<button id="prevbutton">Previous</button><br>
<div id="prevtext">Previous</div>

$("#previmg,#prevbutton,#prevtext").click(function() { $("#prevtext").html("<b>TO PREV?</b>") }); 
```

# asp.net - 验证摘要垂直对齐

> ID：10307817
> 
> 赞同：0
> 
> 时间：2012-04-25T00:24:28.557
> 
> 标签：asp.net, html, css

我有一个两列布局页面，两列上方有一个验证摘要 (VS) 控件。VS 在列上方的容器中居中，这是我想要的，但如果可能的话，我也希望不同的项目符号点垂直对齐。我尝试了几件事，包括将 VS 放在 a `div`（在中心对齐的容器 div 内）与`text-align:left;`，但这会将整个移动`div`到容器的一侧。我也尝试过制作`div` `text-align:center;`和 VS `text-align:left;`，但这也会将整个块一直向左移动。我也用桌子尝试过同样的事情，但没有运气。
顺便说一下，这是在 Firefox 中。我没有在其他浏览器中测试过，但它需要在FF中工作。
这是显示混乱的垂直对齐的图片：
![在此处输入图像描述](../Images/0e1175acdaa734cf3efecb9ac48c981e.png)

这是我的 VS 控件的代码，没有我的对齐尝试（如果需要更多代码，请告诉我）：

```
<div id="container">
  <asp:Label ID="lblStatus" runat="server" ForeColor="Red"></asp:Label>
  <asp:ValidationSummary ID="VS1" runat="server" CssClass="validator" ValidationGroup="theform" />
  <div id="leftCol"> 
```

有人可以帮我垂直对齐页面中心的那些要点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T01:39:55.853

由于项目符号点是列表项的一部分，我认为您无法对齐它们。为什么不尝试使用带有 3 个 div 的顶列并将您的验证摘要控件放在中间的列。试试这个

HTML 代码

```
<div id="container" class="container">
    <div id="top" class="top">
        <div id="topLeft" class="topLeft">
            &nbsp;
        </div>
        <div id="topMiddle" class="topMiddle">
            <asp:ValidationSummary ID="ValidationSummary1" runat="server" />
        </div>
        <div id="topRight" class="topRight">
            &nbsp;
        </div>
    </div>
    <div id="bottom" class="bottom">
        <div id="bottomLeft" class="bottomLeft">
            <asp:TextBox ID="TextBox1" runat="server"></asp:TextBox>
            <asp:RequiredFieldValidator ID="RequiredFieldValidator1" runat="server" ErrorMessage="input value" ControlToValidate="TextBox1" Text="*"></asp:RequiredFieldValidator><br />
            <asp:TextBox ID="TextBox2" runat="server"></asp:TextBox>
            <asp:RequiredFieldValidator ID="RequiredFieldValidator2" runat="server" ErrorMessage="Need come input for this" ControlToValidate="TextBox2" Text="*"></asp:RequiredFieldValidator><br />
            <asp:Button ID="Button1" runat="server" Text="Button" />
        </div>
        <div id="bottomRight" class="bottomRight">
            <asp:TextBox ID="TextBox3" runat="server"></asp:TextBox>
            <asp:RequiredFieldValidator ID="RequiredFieldValidator3" runat="server" ErrorMessage="please input text" ControlToValidate="TextBox3" Text="*"></asp:RequiredFieldValidator><br />
            <asp:TextBox ID="TextBox4" runat="server"></asp:TextBox>
            <asp:RequiredFieldValidator ID="RequiredFieldValidator4" runat="server" ErrorMessage="Where is the text?" ControlToValidate="TextBox4" Text="*"></asp:RequiredFieldValidator><br />
            <asp:Button ID="Button2" runat="server" Text="Button" />
        </div>
    </div>
</div> 
```

CSS

```
.container
{
    display: block;
    width:800px;
    margin:0px;
    padding:0px;
}

.top
{
    display:inline-block;
    width:800px;
}

.bottom
{
    display:inline-block;
}

.topMiddle
{
    display:inline;
    background-color:Yellow;
    float:left; 
    width:300px;   
}

.topLeft
{
    display:inline;   
    float:left;     
    width:250px; 
}

.topRight
{
    display:inline;    
    float:left; 
    width:250px;     
}

.bottomLeft
{
    display:inline;
    width:400px;
    float:left;
    background-color:Orange;
}

.bottomRight
{
    display:inline;
    width:400px;
    float:left;
    background-color:Lime;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T01:27:30.810

试试用这个....

```
<style>
.validator ul li { text-align:left; }
</style> 
```

编辑

根据需要将 padding left 或 margin left 设置为 ul ...

```
.validator ul { padding-left: 100px; } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T09:18:44.760

嘿，你可以定义你的父母`text-align` `left` `center` `right`

根据您的设计

# c# - 如何使用正则表达式不匹配在多行模式中间包含特定文本的文本？

> ID：10307818
> 
> 赞同：0
> 
> 时间：2012-04-25T00:24:43.213
> 
> 标签：c#, regex, expression, multiline, lookahead

我正在尝试创建一个 C# 正则表达式来检测我们的 .csproj 文件中的引用何时没有将 <SpecificVersion> 设置为 False（必须在所有 <'s 之后添加一个空格才能使其在 StackOverflow 中正确显示）。所以这些是我需要处理的情况：

```
1\. <Reference Include="IQ.MyStuff1, Version=4.1.0.0, Culture=neutral, processorArchitecture=MSIL" />
2\. <Reference Include="IQ.MyStuff2, Version=4.7.22.21777, Culture=neutral, processorArchitecture=MSIL">
    <HintPath>..\..\DebugDLLFiles\IQ.MyStuff2.dll</HintPath>
</Reference>
3\. <Reference Include="IQ.MyStuff3, Version=4.1.0.0, Culture=neutral, processorArchitecture=MSIL">
    <HintPath>..\..\DebugDLLFiles\IQ.MyStuff3.dll</HintPath>
    <SpecificVersion>True</SpecificVersion>
</Reference>
4\. <Reference Include="IQ.MyStuff4, Version=4.5.3.17401, Culture=neutral, processorArchitecture=MSIL">
    <SpecificVersion>True</SpecificVersion>
</Reference> 
```

所以基本上任何没有明确包含“<SpecificVersion>False</SpecificVersion>”的文件引用。

所以让我们忽略第一种情况，因为它没有像其他 3 一样的主体，可以区别对待。所以这是我到目前为止所拥有的：

```
<Reference(\s|\n|\r)*?  # Match against '<Reference '.
Include=""IQ\..*?""     # Match against the entire Include attribute; We only care about IQ DLLs.
(\s|\n\r)*?>            # Eat any whitespace and match against the closing tag character.
[What should go here?]
</Reference>            # Match against the closing tag. 
```

所以我在 [What should go here?] 块中尝试了很多东西，但似乎无法让任何东西非常完美地工作。我最接近的是在这个块中使用以下内容：

```
(?!                     # Do a negative look-ahead to NOT match against this Reference tag if it already has <SpecificVersion>False</SpecificVersion>.
    (.|\n|\r)*?         # Eat everything before the <SpecificVersion> tag, if it even exists.
    <SpecificVersion>(\s|\n|\r)*?False(\s|\n|\r)*?</SpecificVersion>    # Specify that we don't want to match if this tag already has <SpecificVersion>False</SpecificVersion>.
)
(.|\n|\r)*?             # Eat everything after the <SpecificVersion> tag, if it even existed. 
```

这适用于所有情况，除了在我想要匹配的任何引用下方有有效引用的情况下，有效引用看起来像：

```
<Reference Include=\"IQ.MyStuff5, Version=4.5.3.17401, Culture=neutral, processorArchitecture=MSIL\">
    <SpecificVersion>False</SpecificVersion>
</Reference> 
```

看来我正在使用的前瞻并没有停止在 </Reference> 标记处，而是继续向下查看整个文件以确保它下面的文本没有“<SpecificVersion>False</SpecificVersion>”。

我怎样才能让我的前瞻停在它遇到的第一个“< /Reference>”，或者如果你有另一种方法来解决我的问题，我也愿意接受。任何建议表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T00:33:35.997

放弃正则表达式。它注定了。不是 XML 吗？为什么不这样对待呢？

“[不要使用正则表达式解析 HTML](https://stackoverflow.com/a/1732454/14357) ”规则同样适用于 XML。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T12:27:17.487

无论如何，如果您想尝试正则表达式，我建议您这样做：

```
<Reference[^>]*?>(?:.(?!</Reference>))*?<SpecificVersion>([^<]*?)</SpecificVersion> 
```

它匹配内部有标签的所有标签 - 即它将完全忽略任何没有标签的参考标签。

*   它寻找参考标签

*   匹配所有不是结束引用标记的内容，直到找到该标记

*   然后它捕获标签内的值

我在正则表达式中对其进行了在线测试，它似乎在多种情况下都能正常工作。

编辑：

*   使用 RegexOptions.Singleline 使点匹配新行

如果您想匹配 SpecificVersion 标签根本不存在的情况，请尝试此更改 - 它会尝试将选项与标签匹配，但如果失败，它仍将匹配

```
<Reference[^>]*?>(?:.(?!</Reference>))*?(<SpecificVersion>([^<]*?)</SpecificVersion>)|<Reference[^>]*?>(?:.(?!</Reference>))*?(?:<SpecificVersion>([^<]*?)</SpecificVersion>)? 
```

让我知道你的进展如何。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T15:35:56.240

因此，按照花费者的建议，我研究了正则表达式的替代方案。我发现了 Linq To XML，它使解决我的问题变得非常容易。这是我最终用来解决问题的代码。它查找 .csproj 文件中对 IQ DLL 文件的所有引用，并确保它们都具有 <SpecificVersion>False</SpecificVersion> 元素。只是为了一些背景信息，我需要这样做的原因是，当特定版本设置为 True 时，我们的构建在我们的本地机器上运行良好，但它在我们的 TFS 构建服务器上中断，除非它设置为 False。我很确定这是因为我们的 TFS 构建更新了版本号，所以每个项目设置使用的版本已经过时了。无论如何，这是代码:)

```
// Let's parse us some XML!
XElement xmlFile = XElement.Load(filePath);

// Grab all of the references to DLL files.
var iqReferences = xmlFile.Descendants().Where(e => e.Name.LocalName.Equals("Reference", StringComparison.InvariantCultureIgnoreCase));

// We only care about iQ DLL files.
iqReferences = iqReferences.Where(r => r.Attribute("Include") != null && r.Attribute("Include").Value.StartsWith("IQ.", StringComparison.InvariantCultureIgnoreCase));

// If this project file doesn't reference any iQ DLL files, move on to the next project file.
if (!iqReferences.Any())
    continue;

// Make sure they all have <SpecificVersion> set to False.
foreach (XElement reference in iqReferences)
{
    // If this Reference element already has a child SpecificVersion element whose value is false, skip this reference since it is good.
    if (reference.Elements().Where(e => e.Name.LocalName.Equals("SpecificVersion", StringComparison.InvariantCultureIgnoreCase))
        .Any(e => e.Value.Equals("False", StringComparison.InvariantCultureIgnoreCase)))
        continue;

    // Add this reference to the list of bad references.
    badReferences.AppendLine("\t" + reference.Attribute("Include").Value);

    // Fix the reference.
    reference.SetElementValue(reference.Name.Namespace + "SpecificVersion", "False");
} 
```

# c# - 字符串值是否有 TryInt() 转换？

> ID：10307819
> 
> 赞同：1
> 
> 时间：2012-04-25T00:25:06.580
> 
> 标签：c#, winforms, type-conversion

我想将文本框中输入的值（只能为空或“1”或“2”或“3”）转换为整数。如果为空，我希望它为 0，否则为对应的值（1、2 或 3）。

有没有办法做到这一点：

```
MyIntVal = TryConvertToInt(textBox1.Text, 0); 
```

...在哪里空字符串或任何不容易转换为 int 的东西会默认为 0？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-25T00:26:55.613

您可以使用[Int32.TryParse 方法](http://msdn.microsoft.com/en-us/library/f02979c7.aspx)：

```
int myIntVal;
if (!int.TryParse(textBox1.Text, out myIntVal))
{
    myIntVal = 42;
} 
```

如果方法返回`false`，则无法解析文本。`myIntVal`将`0`在这种情况下；您可以为变量分配不同的默认值，如上所示。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-25T00:27:30.133

```
int result = 0;
int.TryParse(stringValue, out result); 
```

如果 stringValue 无法解析为 int，则默认为 0。

[http://msdn.microsoft.com/en-us/library/f02979c7.aspx](http://msdn.microsoft.com/en-us/library/f02979c7.aspx)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-04-25T00:26:41.290

有静电`TryParse`。`true`如果有效，它会返回。

```
int myIntVal;
int.TryParse(textBox1.Text, out myIntVal); 
```

# ios - 如何在 iPad 上显示 HTML5 视频的海报？

> ID：10307820
> 
> 赞同：3
> 
> 时间：2012-04-25T00:25:09.230
> 
> 标签：ios, ipad, html5-video

[我的 HTML5 视频语法和这个人](http://www.kaltura.org/apis/html5lib/kplayer-examples/Player_Themable.html)几乎一样：

```
<video height="270" width="480"
    src="media/bbb.ogv" 
    poster="media/bbb.jpg" 
    durationHint="0:4:44">
</video> 
```

在 iPhone (iOS 5.0) 和桌面 Firefox 上，我可以看到海报：

![在此处输入图像描述](../Images/d7a9f97581a67044daff2ab5eb988b8e.png)

但在 iPad (iOS 5.0.1) 上没有出现。我记得它曾经在 iOS 低于 5 的 iPad 上工作。

![在此处输入图像描述](../Images/95d6e59119cfe5ee7f8a064143ef1d9c.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-04T01:16:40.273

使用绝对路径而不是相对路径尝试相同的代码：

```
<video height="270" width="480"
    src="http://cdn.kaltura.org/apis/html5lib/kplayer-examples/media/bbb_trailer_iphone.m4v" 
    poster="http://cdn.kaltura.org/apis/html5lib/kplayer-examples/media/bbb480.jpg" 
    durationHint="00:04:44">
</video> 
```

如果这不起作用，他们的 CDN 可能会阻止外部引用，因此请尝试将文件保存到您自己的本地服务器并使用它们的绝对路径。

注意：您不必使用绝对路径，但它在故障排除时肯定会有所帮助。

如果失败，另一种解决方案是使用绝对定位的图像覆盖，单击时使用 JavaScript 激活*在下面标记；但这是一个较旧的 hack，iOS 5+ 不需要。*

 *iOS 3 的视频标签上的海报属性肯定存在已知问题：http: [//videojs.com/2010/09/ipad-iphone-video-poster-fix-bonus-javascript-placement-fix/](http://videojs.com/2010/09/ipad-iphone-video-poster-fix-bonus-javascript-placement-fix/)*

# module - 如何在 Play 应用中使用模块的依赖项

> ID：10307821
> 
> 赞同：2
> 
> 时间：2012-04-25T00:25:30.590
> 
> 标签：module, playframework, dependencies, playframework-1.x

我正在编写一个 Play Framework 模块，以便在多个 Play 应用程序之间共享一些通用逻辑。我希望我的模块做的一件事是通过 3rd-party 模块提供一些常用的功能，例如优秀的[Markdown 模块](http://www.playframework.org/modules/markdown)。

首先，是否有可能做到这一点？我希望包含我的模块的所有应用程序都能够使用`.markdown().raw()`字符串扩展，而无需将 Markdown 模块显式声明为依赖项。[Play Framework Cookbook](http://www.packtpub.com/play-framework-cookbook/book)第5 章似乎暗示这是可能的，除非我读错了。

其次，如果可能，它是如何工作的？我创建了以下香草示例案例，但我仍然遇到错误。

我在同一个父目录中创建了一个新的空应用程序“myapp”和一个新的空模块“mymod”。然后我修改`mymod/conf/dependencies.yml`为：

```
self: mymod -> mymod 0.1

require:
    - play
    - play -> markdown [1.5,) 
```

我`play deps`在 mymod 上运行，它成功下载并安装了 Markdown 模块。运行`play build-module`也很好，没有错误。

然后，我修改`myapp/conf/dependencies.yml`为：

```
# Application dependencies

require:
    - play
    - mymod -> mymod 0.1

repositories:
    - Local Modules:
        type: local
        artifact: ${application.path}/../[module]
        contains:
            - mymod 
```

我`play deps`在 myapp 上运行，它成功找到了 mymod，并生成了`myapp/modules/mymod`包含 mymod 的绝对路径的文件。

我使用 myapp 运行`play run`并能够在[http://localhost:9000/](http://localhost:9000/)上看到欢迎页面。到目前为止，一切都很好。

接下来，我修改`myapp/app/views/Application/index.html`为：

```
#{extends 'main.html' /}
#{set title:'Home' /}

${"This is _MarkDown_, by [John Gruber](http://daringfireball.net/projects/markdown/).".markdown().raw()} 
```

我重新启动了 myapp，现在我收到以下错误。

```
09:03:23,425 ERROR ~

@6a6eppo46
Internal Server Error (500) for request GET /

Template execution error (In /app/views/Application/index.html around line 4)
Execution error occured in template /app/views/Application/index.html. Exception raised was MissingMethodException : No signature of method: java.lang.String.markdown() is applicable for argument types: () values: [].

play.exceptions.TemplateExecutionException: No signature of method: java.lang.String.markdown() is applicable for argument types: () values: []
        at play.templates.BaseTemplate.throwException(BaseTemplate.java:86)
        at play.templates.GroovyTemplate.internalRender(GroovyTemplate.java:257)
        at play.templates.Template.render(Template.java:26)
        at play.templates.GroovyTemplate.render(GroovyTemplate.java:187)
        at play.mvc.results.RenderTemplate.<init>(RenderTemplate.java:24)
        at play.mvc.Controller.renderTemplate(Controller.java:660)
        at play.mvc.Controller.renderTemplate(Controller.java:640)
        at play.mvc.Controller.render(Controller.java:695)
        at controllers.Application.index(Application.java:13)
        at play.mvc.ActionInvoker.invokeWithContinuation(ActionInvoker.java:548)
        at play.mvc.ActionInvoker.invoke(ActionInvoker.java:502)
        at play.mvc.ActionInvoker.invokeControllerMethod(ActionInvoker.java:478)
        at play.mvc.ActionInvoker.invokeControllerMethod(ActionInvoker.java:473)
        at play.mvc.ActionInvoker.invoke(ActionInvoker.java:161)
        at Invocation.HTTP Request(Play!)
Caused by: groovy.lang.MissingMethodException: No signature of method: java.lang.String.markdown() is applicable for argument types: () values: []
        at /app/views/Application/index.html.(line:4)
        at play.templates.GroovyTemplate.internalRender(GroovyTemplate.java:232)
        ... 13 more 
```

为了确认我没有发疯，我尝试添加该`play -> markdown [1.5,)`行`myapp/conf/dependencies.yml`并重新启动应用程序，并确认它可以工作。

我觉得我错过了一些明显的东西。非常感谢任何可以提供帮助的人！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T07:09:17.480

是的，我遇到了同样的问题，似乎通过自定义自制模块的传递依赖项不起作用

# performance - 如何从磁带中获得良好的读取性能？

> ID：10307823
> 
> 赞同：1
> 
> 时间：2012-04-25T00:25:32.603
> 
> 标签：performance, io

我有一个算法可以执行一些文件 I/O（读、写）和计算。

如果我写入磁带（而不是读取），该算法效果很好。如果我从磁带读取（不写入），性能很差。如果不考虑磁带（仅用于 I/O 的磁盘），那么它的效果很好。

现在，我把它归结为一个我试图理解的相对简单的案例。

设置是磁带上的单个 20 GB 文件。我正在按块顺序读取此文件。

测试算法类似于：

```
while (fileRemaining)
{
    ReadBlock(blockSize);
    Sleep(sleepTime); // this is to mimic computation time
} 
```

一些观察：

*   当使用 8K 的 blockSize 和 0 的 sleepTime 时，吞吐量（数据读取/秒）很好。此外，磁带机不断发出噪音。
*   当使用 8K 的块大小和任何非零睡眠时间（甚至 1 毫秒）时，吞吐量会受到严重影响。数据仍会被读取，但磁带机不会经常发出噪音。它变得安静了一段时间，偶尔会发出噪音。
*   当使用 2M 的 blockSize 和 100ms 的 sleepTime 时，吞吐量很好。磁带机在整个过程中都会发出噪音（尽管听起来好像速度较慢？）。
*   Windows 资源管理器能够以良好的吞吐量将文件从磁带传输到磁盘。

**如何在这里获得良好的读取性能？**

如果您也愿意帮助我理解其他奥秘——为什么睡眠的存在会如此显着地降低吞吐量（知道这有助于重新思考算法）？一次从磁带读取的“最佳”数量是多少？来自磁带驱动器的噪音是否与注意相关？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T23:48:59.933

您没有提供磁带介质、驱动器或驱动器使用的接口类型的任何详细信息。

LTO4/5 等当前技术能够以大约 240 - 280MB/s 的速度传输数据。性能是通过读取 LTO 的最佳块大小来实现的，我相信这是 64KB。高达 256KB 的块大小不会产生显着影响，但读取大量小块会产生重大影响。读取/写入更大的块，并在读取数据后在程序中拆分数据。如果数据已经以 8KB 块的形式存在于磁带上，则将驱动器设置为固定块模式并读取多个 8KB 块。

磁带机必须达到特定的运动速度才能读取数据。如果数据从驱动器流出的速度不够快，那么驱动器将不得不减速、停止、倒带、重新定位、恢复速度，然后再次开始读取。这种停止/启动将对性能产生重大影响。LTO 试图通过能够以不同的磁带速度读取来弥补这一点，但存在限制。

使用异步 I/O 可以进一步提高速度，但是我认为这对于这个应用程序来说不是必需的。

# android - Android jar 依赖

> ID：10307825
> 
> 赞同：0
> 
> 时间：2012-04-25T00:25:39.067
> 
> 标签：android, jar, noclassdeffounderror

我在 android 项目的“libs”文件夹中导入了一个 jar 文件。我将它添加到我的 Java Build 路径中。我试图从我实现的 Android SimpleService 类中调用这个 Jar 文件的函数。我的 android 项目编译正确，但是当我在模拟器上启动它时，我得到 NOClassDefFoundError （@runtime 它无法获取类文件）。

我正在添加其他信息以供您了解：

```
 JAVA_HOME = /usr/lib/jvm/java-6-sun-1.6.0.26.
    Android Platform = 4.0.3, API level = 15.
    Android SDK tools revision = 18.
    Android SDK Platform-tools revision = 11.
    Jar manifest file (MANIFEST.MF) = Manifest-Version: 1.0
                                      Archiver-Version: Plexus Archiver
                                      Created-By: Apache Maven
                                      Built-By: kunjan
                                      Build-Jdk: 1.6.0_26 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T00:36:03.840

您是否尝试检查该 jar 文件是否存在于 *.apk 文件中？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T02:04:32.393

我遇到了同样的问题，如果您使用的是 ADT 17 或更高版本，请确保**使用“libs 文件夹”作为源文件夹**。我就是这样解决的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T00:47:13.657

您使用的是什么版本的 ADT？如果您使用的是 17 或更高版本，则可以将其放在 /libs 文件夹中。

# objective-c - 如何在 Objective-C 中使用类来控制窗口

> ID：10307829
> 
> 赞同：-1
> 
> 时间：2012-04-25T00:26:22.277
> 
> 标签：objective-c, macos, cocoa

我已经使用 Objective-C 为 Mac 制作应用程序大约一年了，但由于并不真正了解如何正确使用类，我只使用过“AppDelegate”文件。我想尽快开始使用类，因为据我了解，将它集中到一个类中是非常糟糕的做法。基本上，我如何拥有两个窗口，每个窗口都由它自己的类控制。我了解如何制作类似于 NSString 或其他东西的对象，但不了解如何拥有控制窗口等的类。

谢谢

编辑：基本上我想知道如何将我的应用程序拆分为类。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T05:00:40.913

如果我理解正确，那么您需要创建具有自己的 IBOutlets 和 IBActions 的单独控制器类，并将它们连接到您的 UI 元素。要将现有应用程序拆分为更小的类，需要一些面向对象编程的知识。

或者，您可能会从阅读这本（或类似的）书中受益：

Aaron Hillegass 的“Mac OS X 的 Cocoa 编程”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T02:40:40.547

尝试在文档中查找 NSWindowController。您创建 NSWindowController 的自定义子类和它的 xib 文件。在 xib 文件中，确保将 File's Owner 上的类设置为自定义子类，并确保其窗口出口连接到 xib 中的窗口。如果这一切听起来完全陌生，那就去看书吧！=)

然后，在您希望将此窗口显示在屏幕上的代码中，创建自定义子类的实例并将其与 xib 关联，如下所示：

```
MyCustomWindowController *controller = [[MyCustomWindowController alloc] initWithWindowNibName:@"myxib"]
[controller showWindow:self]; 
```

xib 加载系统将在新控制器上连接您所有的自定义插座和操作，您可以显示它或做其他精彩的 NSWindowController 事情。

# javascript - 如何创建将选定文本复制到客户端剪贴板的 HTML 按钮？

> ID：10307833
> 
> 赞同：0
> 
> 时间：2012-04-25T00:26:48.947
> 
> 标签：javascript, html, copy, clipboard

这是我的用例的屏幕截图：

![在此处输入图像描述](../Images/5f87bbd745e386c08e834e87812eb7b9.png)

按钮只是一个`<button>Copy To Clipboard</button>`元素。

实现这一目标的最佳方法是什么？我正在使用 jQuery。

我只关心让它在现代浏览器上运行，如果它在 IE8 上运行，这是一个额外的好处，但不是 100% 必需的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T00:31:14.833

大多数跨浏览器实现都使用 Flash 来克服安全限制。AFAIK，没有用于访问系统粘贴板的 W3C 标准。

我过去使用过[Clippy](https://github.com/mojombo/clippy)。它重量轻且速度快，并且可以按照包装盒上的说明进行操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T00:29:13.897

[该页面](http://www.dynamic-tools.net/toolbox/copyToClipboard/)似乎提供了执行此操作的代码：

```
function copyToClipboard(s)
{
    if( window.clipboardData && clipboardData.setData )
    {
        clipboardData.setData("Text", s);
    }
    else
    {
        // You have to sign the code to enable this or allow the action in about:config by changing
        user_pref("signed.applets.codebase_principal_support", true);
        netscape.security.PrivilegeManager.enablePrivilege('UniversalXPConnect');

        var clip Components.classes['@mozilla.org/widget/clipboard;[[[[1]]]]'].createInstance(Components.interfaces.nsIClipboard);
        if (!clip) return;

        // create a transferable
        var trans = Components.classes['@mozilla.org/widget/transferable;[[[[1]]]]'].createInstance(Components.interfaces.nsITransferable);
        if (!trans) return;

        // specify the data we wish to handle. Plaintext in this case.
        trans.addDataFlavor('text/unicode');

        // To get the data from the transferable we need two new objects
        var str = new Object();
        var len = new Object();

        var str = Components.classes["@mozilla.org/supports-string;[[[[1]]]]"].createInstance(Components.interfaces.nsISupportsString);

        var copytext=meintext;

        str.data=copytext;

        trans.setTransferData("text/unicode",str,copytext.length*[[[[2]]]]);

        var clipid=Components.interfaces.nsIClipboard;

        if (!clip) return false;

        clip.setData(trans,null,clipid.kGlobalClipboard);      
    }
}

<textarea id='testText'>#COPYTOCLIPBOARD CODE#</textarea><br>
<button onclick='copyToClipboard(document.getElementById('testText').value);'> 
```

显然，基于 Mozilla 的浏览器会要求允许这样做，但我认为这是无法避免的。

# javascript - 使用 Express 时如何在 Node.js 中设置 maxSockets？

> ID：10307837
> 
> 赞同：21
> 
> 时间：2012-04-25T00:27:22.020
> 
> 标签：javascript, node.js, express

有没有办法在使用 Express 框架时修改 Node.js [maxSockets设置？](http://nodejs.org/docs/latest/api/http.html#http_agent_maxsockets)

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-04-25T02:32:04.510

在你做之后的某个地方`var http = require('http')`，只需添加`http.globalAgent.maxSockets = x`（其中'x'是你想要的套接字数量）。

请注意，如果您通过 https 发出请求，您还需要为 https 设置 maxSockets。

```
var https = require('https');
https.globalAgent.maxSockets = your_val_here; 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2015-02-07T09:17:40.243

从版本 v0.12.0 maxSockets 设置为 Infinity

> maxSockets 不再限制为 5。默认设置现在设置为 Infinity，开发人员和操作系统可以控制应用程序可以保持对给定主机打开的同时连接的数量。

[Node v0.12.0（稳定版）发行说明](http://blog.nodejs.org/2015/02/06/node-v0-12-0-stable/)

# facebook - 如果用户同时登录 Facebook，Facebook 的“赞”按钮将停止工作

> ID：10307840
> 
> 赞同：2
> 
> 时间：2012-04-25T00:27:38.807
> 
> 标签：facebook, facebook-like

我的网站有一个并发的 FB 应用程序，我的主页上有超过 180 个赞。突然，在过去的一个月左右，点赞数消失了，如果我同时登录FB，就好像没有点赞一样。如果我退出 FB 并再次访问该网站，它会显示我的点赞数。我也在 FB 开发者论坛上发布了这个问题，但没有收到解决方案。我已经仔细检查了应用程序 ID 并运行了调试工具，它工作正常，但在我的网站上，like 按钮出现故障。

# c# - 将参数传递给 Facebook Open Graph API

> ID：10307843
> 
> 赞同：2
> 
> 时间：2012-04-25T00:28:11.457
> 
> 标签：c#, facebook-graph-api, facebook-c#-sdk

我正在尝试使用 C# SDK 将视频上传到 Facebook 开放图。视频似乎可以正常上传，我得到了活动的 ID，但只显示了示例元数据。

经过一番挖掘，我发现了这个：

> 在能够为用户发布 Open Graph 操作并在步骤 3 中定义其相应的连接对象类型之前，您现在需要创建一个可公开访问的网页，该网页使用 Open Graph 元标记表示该对象。创建此对象页面后，您可以使用 Graph API 发布操作。

由于这是一个客户端应用程序，我没有可以参考 Facebook 的网页。那么如何传入正确的参数呢？

这是我的代码：

```
var parameters = new Dictionary<string, object>();
parameters["source"] = new FacebookMediaObject { ContentType = "video/mpeg", FileName = "video.mpeg" }.SetValue(File.ReadAllBytes(@"D:\sample video.MP4"));
parameters["og:title"] = "Sample video";
parameters["title"] = "Sample video";
parameters["og:description"] = "Test description";
parameters["highlight"] = "http://samples.ogp.me/287287444686523"; // If I don't put this, the upload fails
fb.PostAsync("/me/myobjectname:share", parameters); 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T04:50:22.367

For version 6, you can do:

```
var fb = new FacebookClient(accessToken);
string attachementPath = @"C:\image.jpg";

using (var stream = File.OpenRead(attachementPath))
{
    dynamic result = fb.Post("me/photos",
                                new
                                    {
                                        message = "upload using Facebook C# SDK",
                                        file = new FacebookMediaStream
                                                {
                                                    ContentType = "image/jpg",
                                                    FileName = Path.GetFileName(attachementPath)
                                                }.SetValue(stream)
                                    });
} 
```

More details [here](http://blog.prabir.me/post/Facebook-CSharp-SDK-Glimpse-into-the-Future.aspx).

# android - 按钮打开一个新的 Xml 页面

> ID：10307847
> 
> 赞同：0
> 
> 时间：2012-04-25T00:28:40.993
> 
> 标签：android

我有一个 Android 应用程序，它需要一个按钮来打开一个新的 xml 页面。这就是现在的样子，有人可以添加必要的代码以在我单击按钮时打开 Page2Activity 吗？代码：

```
 public class MainActivity extends Activity {

    /** Called when the activity is first created. */

    @Override

    public void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);

    setContentView(R.layout.main);

    Void onClick;View arg0; {
        // TODO Auto-generated method stub

    }
    };

    } 
```

我使用这种方法解决了这个问题：***http*** ://stackoverflow.com/questions/4094103/linking-xml-pages-with-layout ，但我也会尝试你的所有方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T00:58:25.560

试试这个代码：

```
public void handleClick(View v){
    //Create an intent to start the new activity.
    Intent intent = new Intent();
    intent.setClass(this,Page2Activity.class);
    startActivity(intent);
} 
```

然后创建一个名为`Page2Activity`.

希望这会有所帮助，不要忘记将您的活动添加到清单文件中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T11:11:37.043

我想你的意思是这样的：

```
public class MyClass extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        Button button1 = (Button)findViewById(R.id.button1);
        button1.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {
                Intent i = new Intent("com.myaction");
                startActivity(i);
            }
        });
    }
} 
```

# c# - Enum Changed Event

> ID：10307852
> 
> 赞同：1
> 
> 时间：2012-04-25T00:29:06.380
> 
> 标签：c#, .net, wpf

I am writing a WPF application and I would like to use an Enum for a State variable.

Example: When the program start up certain controls are disabled until the state changes.

When the state changes I would like to disable/enable a variety of controls via an event handler. I have written plenty of custom event handlers in the past, however, using an enum as the trigger has managed to blow my mind.

Any suggestions?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T00:30:37.810

You should implement `INotifyPropertyChanged` in your view model and invoke the event when the value changed.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T00:49:51.297

If you're using an MVVM approach then I agree with Daniel White that you need to implement INotifyPropertyChanged. You should bind the IsEnabled member on your controls to a property on your ViewModel.

Code:

```
public class ViewModel : INotifyPropertyChanged
{
      public MyEnum EnumValue 
      { 
           get { return enumValue; } 
           set { 
                 enumValue = value;
                 AreControlsEnabled = enumValue == MyEnum.SomeValue;
           }
      }

      public bool AreControlsEnabled 
      {
           get { return areControlsEnabled; }
           set {
                 areControlsEnabled = value;
                 if (PropertyChanged != null)
                     PropertyChanged(this, new PropertyChangedEventArg("AreControlsEnabled");
            }
      }

      public event PropertyChangedEventHandler PropertyChanged;
} 
```

XAML:

```
<TextBox IsEnabled="{Binding AreControlsEnabled}"/> 
```

# twain - 如何验证我的扫描仪驱动程序是否兼容 TWAIN？

> ID：10307853
> 
> 赞同：6
> 
> 时间：2012-04-25T00:29:11.637
> 
> 标签：twain, image-scanner

我们有一个集成了第 3 方扫描组件的应用程序 - Dynam .NET TWAIN。它在我的 HP scanjet 5700 上运行良好。最近，我们得到了 Cannon LiDE210，但它不起作用。我终于注意到我们的应用程序需要使用与 TWAIN 兼容的驱动程序。

如何验证我的扫描仪驱动程序是否支持 TWAIN？我们将把应用程序发送给其他客户。我正在寻找一种简单的方法来确定我的客户的扫描仪是否支持 TWAIN。

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-03-02T02:08:10.723

有一个方便的工具叫做**TWACKER** ...确保你以管理员身份运行它。选择“文件”->“选择源”，然后查看您的扫描仪是否在此处列出。如果列出了您的扫描仪，则表示您正在使用 TWAIN 驱动程序，您可以在其中使用不同的扫描设置进行进一步扫描，以检查您的扫描仪的 TWAIN 兼容性。否则，您需要为您的扫描仪找到一个 TWAIN 驱动程序。

[您可以在http://www.twain.org/scannerdriverdevelopers/specification-and-tools.html](http://www.twain.org/scannerdriverdevelopers/specification-and-tools.html)下载 TWACKER 。

干杯。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-25T00:31:37.207

督察吐温可能就是你要找的人。

[http://inspectortwain.com/](http://inspectortwain.com/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-10-03T18:21:42.657

我确定佳能 LiDE 210 与 TWAIN 兼容，或者更确切地说，具有 TWAIN 驱动程序。如果它不适用于您的 Dynamsoft 软件，他们 (Dynamsoft) 将是寻求支持的第一个地方。

但在联系 Dynamsoft 之前，您应该检查是否为您的 Windows 版本安装了正确的 Canon TWAIN 驱动程序，并且它可以从您的扫描仪进行扫描。出于某种原因，佳能亚洲在此驱动程序上的页面比佳能美国更好：http: [//support-asia.canon-asia.com/contents/ASIA/EN/0100294501.html](http://support-asia.canon-asia.com/contents/ASIA/EN/0100294501.html) 我希望我不需要说这个：您应该只从扫描仪供应商的网站下载和安装驱动程序！

为了验证 TWAIN 驱动程序是否正常工作，我和我的同事经常从[IrfanView](http://irfanview.com)进行扫描- 它是免费的，有数百万份正在使用，并且代码几乎可以与任何 TWAIN 驱动程序一起使用。如果 IrfanView 无法从您的扫描仪进行扫描，则表示 TWAIN 驱动器未安装或无法正常工作 - 此时您应该向扫描仪供应商寻求支持，在这种情况下是佳能。

PS 我很欣赏 Irfan Skiljan 的作品，但与 IrfanView 没有其他联系。

PPS 正如您现在可能已经发现的那样（尤其是如果您与 Twacker 或 Inspector Twain 一起玩），“TWAIN 兼容性”并不是一个全有或全无的东西。不同的扫描仪支持不同的 TWAIN 功能集，几乎每个 TWAIN 驱动程序都以某种方式违反了 TWAIN 标准。但不要让我开始。;-)

# c++ - QImage 和 QPixmap 有什么区别？

> ID：10307860
> 
> 赞同：95
> 
> 时间：2012-04-25T00:30:51.807
> 
> 标签：c++, qt, qimage, qpixmap

我不明白 QImage 和 QPixmap 之间有什么区别，它们似乎提供了相同的功能。什么时候应该使用 QImage，什么时候应该使用 QPixmap？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2012-04-25T12:37:21.380

通过阅读[QImage](http://qt-project.org/doc/qt-4.8/qimage.html#details)和[QPixmap](http://qt-project.org/doc/qt-4.8/qpixmap.html#details)上的文档轻松回答：

> **QPixmap**类是一种可用作绘画设备的离屏图像表示**。**
> 
> **QImage**类提供了一种独立于硬件的图像表示，允许直接访问像素数据，并且可以用作绘图设备。

**编辑：**另外，来自@Dave的回答：

> 您不能在 GUI 线程之外操作 QPixmap，但 QImage 没有这样的限制。

来自@Arnold：

> 以下是通常（并非总是）适用的简短摘要：
> 
> *   如果您打算操作图像、修改图像、更改图像上的像素等，请使用 QImage。
> *   如果您计划在屏幕上多次绘制同一图像，请将其转换为 QPixmap。

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2012-04-25T04:28:42.483

Qt Labs 有一系列很好的文章，解释了很多关于 Qt 图形系统的内容。[这篇文章](http://blog.qt.io/blog/2009/12/16/qt-graphics-and-performance-an-overview/)特别有一个关于`QImage`vs.的部分`QPixmap`。

以下是通常（并非总是）适用的简短摘要：

*   如果您计划对图像进行操作、修改、更改像素等操作，请使用`QImage`.
*   如果您打算在屏幕上多次绘制同一图像，请将其转换为`QPixmap`.

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2012-04-25T12:22:09.297

一个重要的区别是您不能`QPixmap`在除主 GUI 线程之外的任何东西上创建或操作 a。但是，您可以`QImage`在后台线程上创建和操作实例，然后在将它们传递回 GUI 线程后对其进行转换。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2013-06-06T08:19:57.627

在工业环境中很重要：

QPixmap 存储在进行显示的视频卡上。不是 QImage。

因此，如果您有一个运行应用程序的服务器，以及一个执行显示的客户端站，那么就网络使用而言，这是非常重要的。

使用 Pixmap，重绘包括通过网络仅发送重绘命令（几个字节）。

使用 QImage，它包括发送整个图像（大约几 MB）。

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2018-02-14T08:01:16.980

*   **QPixmap** 是一个“图像对象”，其`pixel`表示在您的代码中无关紧要，因此 QPixmap 是为在显示屏上*渲染图像而设计和优化的*，它在使用 X11 时存储在 XServer 上，因此在 XWindow 上绘制 QPixmap比绘制**快得多**QImages，因为数据已经在服务器上，可以使用了。

    > **何时使用 QPixmap**：如果您只想反复绘制现有图像（图标 .. 背景 .. 等），请使用 QPixmap。

*   **QImage是****客户端**代码的“内存中的像素阵列” ，QImage 针对 I/O 以及直接像素访问和操作而设计和优化。

    > **何时使用 QImage**：如果要绘制，使用 Qpaint，或操作图像像素。

*   **QBitmap**只是一个方便的 QPixmap 子类，确保深度为 1，它是一个单色（1 位深度）像素图。就像 QPixmap 一样，QBitmap 针对隐式数据共享的使用进行了优化。

*   **QPicture**是一个绘图设备，可以记录和回放 QPainter 命令——你的绘图——

# windows - Winsock 在仅连接到 localhost 时返回 10061

> ID：10307864
> 
> 赞同：2
> 
> 时间：2012-04-25T00:31:34.110
> 
> 标签：windows, networking, winsock

我不明白发生了什么。如果我创建一个到 localhost 以外的任何其他地方的套接字（“localhost”、“127.0.0.1”或机器的外部 ip）它工作正常。如果我创建一个指向地址的套接字而没有在该端口中监听，我会得到一个 10060（超时），但不是一个有意义的 10061。为什么我在访问 localhost 时连接被拒绝。我尝试禁用防火墙以防万一它搞砸了，但事实并非如此

在此之前，我正在做所有的 WSA 初始化工作。

```
 _socketToServer = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);
    if(_socketToServer == -1){
    return false;
    }

   p_int = (int*)malloc(sizeof(int));
   *p_int = 1;
   if( (setsockopt(_socketToServer, SOL_SOCKET, SO_REUSEADDR, 
       (char*)p_int, sizeof(int)) == -1 )||
       (setsockopt(_socketToServer, SOL_SOCKET, SO_KEEPALIVE, (char*)p_int,
               sizeof(int)) == -1 ) ){
        free(p_int);
        return false;
   }
   free(p_int);

   struct sockaddr_in my_addr;

   my_addr.sin_family = AF_INET ;
   my_addr.sin_port = htons(_serverPort);

   memset(&(my_addr.sin_zero), 0, 8);
   my_addr.sin_addr.s_addr = inet_addr(_serverIP);

   if( connect( _socketToServer, (struct sockaddr*)&my_addr, sizeof(my_addr)) 
        == SOCKET_ERROR ){
    DWORD error = GetLastError(); //here is where I get the 10061
    return false;
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T01:49:07.197

`WSAETIMEDOUT`连接到另一台机器上的非侦听端口时，您不能保证会出错。可能会出现任意数量的不同错误。但是，`WSAETIMEDOUT`通常只有当套接字在`connect()`超时之前无法到达网络上的目标机器时才会发生错误。如果它可以到达目标机器，则`WSAECONNREFUSED`错误意味着目标机器正在确认`connect()`请求并回复说请求的端口当时无法接受连接，因为它没有在侦听或它的积压已满（有没有办法区分哪个）。所以，当你连接到本地主机时，你几乎总是会得到一个`WSAECONNREFUSED`连接到非侦听端口时出错，因为您正在连接到同一台机器并且确定端口的侦听状态没有延迟。它与防火墙或反恶意软件无关。这只是正常的行为。

# android - 以编程方式在ScrollView中的RelativeLayout

> ID：10307868
> 
> 赞同：0
> 
> 时间：2012-04-25T00:32:47.260
> 
> 标签：android, android-layout

所以我试图以编程方式将 RelativeLayout 包装在 ScrollView 中，但我不断收到一个错误消息，告诉我 RelativeLayout 已经有一个父级。

```
import android.app.Activity;
import android.app.DatePickerDialog;
import android.app.DatePickerDialog.OnDateSetListener;
import android.os.Bundle;
import android.util.Log;
import android.view.ViewGroup;
import android.widget.DatePicker;
import android.widget.NumberPicker;
import android.widget.RelativeLayout;
import android.widget.ScrollView;
import android.widget.TextView;
import android.widget.TimePicker;
/*
 * Ids:
 * 1-first Text box
 * 2-DatePicker
 * 3-TimePicker
 */

public class TwoActivity extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        //scrollView
        ScrollView sv = new ScrollView(this);

        Log.v("Ro", "Starts app");
        //create Relative Layout
        RelativeLayout rl = new RelativeLayout(this);
        Log.v("Ro", "Relative Layout: "+rl);

        //From Text View
        RelativeLayout.LayoutParams lptv1 = new RelativeLayout.LayoutParams(
                ViewGroup.LayoutParams.WRAP_CONTENT,ViewGroup.LayoutParams.WRAP_CONTENT);
        lptv1.addRule(RelativeLayout.ALIGN_PARENT_LEFT);
        TextView tv1 = new TextView(this);
        tv1.setText("From: 4-24-12 11:59pm");
        tv1.setId(1);
        rl.addView(tv1, lptv1);

        //To Text View
        RelativeLayout.LayoutParams lptv2 = new RelativeLayout.LayoutParams(
                ViewGroup.LayoutParams.WRAP_CONTENT,ViewGroup.LayoutParams.WRAP_CONTENT);
        lptv2.addRule(RelativeLayout.ALIGN_PARENT_RIGHT);
        TextView tv2 = new TextView(this);
        tv2.setText("To: 4-25-12 12:00am");
        rl.addView(tv2, lptv2);

        //DatePicker
        DatePicker startDate = new DatePicker(this);
        startDate.setId(2);
        RelativeLayout.LayoutParams lptv3 = new RelativeLayout.LayoutParams(
                ViewGroup.LayoutParams.WRAP_CONTENT,ViewGroup.LayoutParams.WRAP_CONTENT);
        lptv3.addRule(RelativeLayout.BELOW,1);
        rl.addView(startDate, lptv3);

        //TimePicker
        TimePicker startTime = new TimePicker(this);
        startTime.setId(3);
        RelativeLayout.LayoutParams lptv4 = new RelativeLayout.LayoutParams(
                ViewGroup.LayoutParams.WRAP_CONTENT,ViewGroup.LayoutParams.WRAP_CONTENT);
        lptv4.addRule(RelativeLayout.BELOW,2);
        rl.addView(startTime, lptv4);
        setContentView(rl);

        //NumberPicker
        NumberPicker duration = new NumberPicker(this);
        RelativeLayout.LayoutParams lptv5 = new RelativeLayout.LayoutParams(
                ViewGroup.LayoutParams.WRAP_CONTENT,ViewGroup.LayoutParams.WRAP_CONTENT);
        lptv5.addRule(RelativeLayout.BELOW,3);
        rl.addView(duration, lptv5);

        sv.addView(rl);

        //setContentView(rl);
        setContentView(sv);
        //setContentView(R.layout.main);
    }
} 
```

为什么它总是给我一个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T00:59:47.643

您正在调用 setContentView 2 次。只需删除它应该工作的第一个 setContentView 。它就在数字选择器的正上方

```
setContentView(rl); 
```

# javascript - 如何使用 Javascript 创建多个表

> ID：10307870
> 
> 赞同：1
> 
> 时间：2012-04-25T00:33:02.260
> 
> 标签：javascript, html-table

我有一个下拉列表（其中包含从 0 到 50 的数字）和 html 表。我希望当用户从列表中选择一个值时，代码复制/创建表到所选值的数量。

示例：用户选择了 10 个。页面应该显示 10 个相同的表。

有人可以提供任何提示吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T00:38:37.663

假设 jQuery，这是一个*非常基本的示例。*它可能不适合您的需求，因此只需使用它来帮助您入门：

**HTML：**

```
<a href="#" class="dropDownOption">1</a>
<a href="#" class="dropDownOption">2</a>
<a href="#" class="dropDownOption">3</a>
<a href="#" class="dropDownOption">4</a> 
```

**JavaScript：**

```
$('.dropDownOption').click(function() {
    var numberTables = parseInt($(this).html()),
        tableHTML = "<table class='table'><tr><td>Foo</td><td>Bar</td><tr><td>Spam</td><td>Ham</td></tr></table>";
    for (var i = 0; i < numberTables; i++) {
        $('body').append(tableHTML);
    }
});​ 
```

**JSFiddle：http:**
//jsfiddle.net/TnTPf/2/

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T00:47:02.680

## JQuery 是一种简单的方法来做到这一点

我给你的提示：找出是什么`$('#mytable').clone();`。

### 奖励提示：

`for (i=0; i<=50; i++) { /* clone here */ }`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-10-09T14:54:22.963

```
<script>
    function getTable(){
        var num = document.getElementById("txtnum").value;
        var table = "";
        for(i=0; i<13; i++ ){
        table += num + "x" + i + "=" + num*i + "<br>"; 

     }
      document.getElementById("mulTable").innerHTML = table;
 }

</script> 
```

# java - 无法在 Android 中正确实现我的线程

> ID：10307876
> 
> 赞同：0
> 
> 时间：2012-04-25T00:34:14.287
> 
> 标签：java, android, multithreading, http, httpclient

我正在尝试在启动 HttpClient 的函数上实现一个线程，因为它是根据 d.android.com 推荐的所以我已经实现了一个线程但是，它似乎没有运行，就像我删除了我看到结果的线程代码一样.

这是我的代码：

```
@Override
public void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);
    setContentView(R.layout.chat_box);// sd
    TextView inbox = (TextView) findViewById(R.id.inbox);
    final Functions function = new Functions();
    final SharedPreferences prefs = PreferenceManager
            .getDefaultSharedPreferences(getBaseContext());
    where = prefs.getString("chat", "null");

    class SendThread extends Thread {
           public void run(){
                //getInbox() runs an http client
               listOfMessages = function.getInbox(where);

           }
        }
    SendThread sendThread  = new SendThread();
    sendThread.start();

    inbox.setText(listOfMessages);

} 
```

就像我上面说的，如果我删除我的线程代码，那么它会完美运行。关于我做错了什么的任何想法？这是我第一次使用线程，对于任何菜鸟的错误，请见谅。

我没有收到任何错误（至少我没有看到任何错误）但是，我没有看到没有插入线程代码的输出。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T01:12:06.977

我同意其他人的观点：1）您没有让线程完成，2）您必须在主线程上修改 UI。我想你可能想看到一个具体的解决方案，所以你去：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.chat_box);// sd

    final Functions function = new Functions();
    final SharedPreferences prefs = PreferenceManager
            .getDefaultSharedPreferences(getBaseContext());
    where = prefs.getString("chat", "null");
    new AsyncTask<String, Void, String>() {
        @Override
        protected String doInBackground(String... args) {
            return function.getInbox(args[0]);
        }

        @Override
        protected void onPostExecute(String result) {
            TextView inbox = (TextView) findViewById(R.id.inbox);
            inbox.setText(result);
        }

    }.execute(where);
} 
```

AsyncTask 的使用使这变得超级简单：它是 Android 推荐的在主线程之外执行简单任务的方法。当调用execute() 时，会创建一个新线程并调用doInBackground()。然后将结果*在主线程*上返回给 onPostExecute 方法。因此，您不必处理 runOnUiThread 或其他任何事情。

在这种情况下需要注意的一件事是：在诸如方向更改之类的情况下，您的 Activity 将被销毁并重新创建，因此将再次调用 getInbox() 。这可能是也可能不是问题，具体取决于该方法实际需要多长时间。如果不可接受，则需要静态 AsyncTask 之类的东西，但随后会遇到附加回新 Activity 的问题。我只是提到这一点，不是因为你现在必须处理它，而是让你知道。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T00:44:08.283

您从线程中获得了 listOfMessages 的结果，但您没有将该列表发布到您的收件箱 TextView。线程可能需要一段时间才能完全执行，但代码

```
inbox.setText(listOfMessages); 
```

一旦线程启动，底部将执行。

所以，你需要调用 inbox.setText(listOfMessages); 一旦你的线程得到了最新的 listOfMessages。但是，您不能在非 ui 线程中执行任何 UI 操作（如 setText）。

有很多选择： 1.您可以使用处理程序类，在您的线程代码中，当您获得 listOfMessages 时，您可以使用处理程序并将消息发布到您的 UI 线程。您可以谷歌处理程序的样本。

1.  如果上面的代码在您的活动中，您可以在活动中使用调用 runOnUiThread 的辅助方法。这有点像。

    MyActivity.this.runOnUiThread(new Runnable() { inbox.setText(listOfMessages); });

希望这会帮助你。

# php - 二进制 16 来回 PHP 指南

> ID：10307883
> 
> 赞同：2
> 
> 时间：2012-04-25T00:35:27.647
> 
> 标签：php, guid

我将 guid（实际上指向文件名）存储为 mysql 中的二进制 16。我正在使用这个函数来生成 guid

```
private function guid(){

    if (function_exists('com_create_guid') === true) {
        return trim(com_create_guid(), '{}');
    }

    return sprintf('%04X%04X-%04X-%04X-%04X-%04X%04X%04X', mt_rand(0, 65535), mt_rand(0, 65535), 
        mt_rand(0, 65535), mt_rand(16384, 20479), mt_rand(32768, 49151), mt_rand(0, 65535), 
        mt_rand(0, 65535), mt_rand(0, 65535));
} 
```

我正在使用该函数将 guid 保存为二进制文件

```
$binary =  pack("h*", str_replace('-', '', $guid )); 
```

现在的问题是当将二进制字段从数据库转换回 guid 以链接文件时，我没有得到上面 guid 函数生成的原始 guid，我使用这个 mysql 语句将二进制 16 转换回 guid：

```
CONCAT(
    HEX(SUBSTRING(hash,4,1)), HEX(SUBSTRING(hash,3,1)),
    HEX(SUBSTRING(hash,2,1)), HEX(SUBSTRING(hash,1,1)) , '-', 
    HEX(SUBSTRING(hash,6,1)),HEX(SUBSTRING(hash,5,1)),'-',
    HEX(SUBSTRING(hash,8,1)) , HEX(SUBSTRING(hash,7,1)),'-',
    HEX(SUBSTRING(hash,9,2)),'-',HEX(SUBSTRING(hash,11,6))
) 
```

其中 hash 是二进制 16 字段。有什么线索吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T23:43:05.987

在您的 CONCAT 中，您似乎将某些部分视为大端，而将其他部分视为小端。我相信 HEX() 会返回大端，所以你应该在你的包中使用“H*”，而不是“h*”。然后你应该能够按顺序处理字节： HEX(SUBSTRING(hash,1,4)), '-', HEX(SUBSTRING(hash,5,2)), '-', HEX(SUBSTRING(hash, 7,2)), '-', HEX(SUBSTRING(hash,9,2)), '-', HEX(SUBSTRING(hash,11,6))

此外，您可能想知道 MySQL 有一个 UUID() 函数。在将字符串存储在数据库中而不是打包时，您可能更容易使用例如 UNHEX(REPLACE(UUID(), '-', '')) ，这样您就知道在两个方向都使用了相同的转换.

# javascript - Javascript 用 \x(charcode) 替换 32 下的字符

> ID：10307884
> 
> 赞同：0
> 
> 时间：2012-04-25T00:35:58.157
> 
> 标签：javascript

不显示 0x20 以下的字符，因此我想将它们转义为 '\x0D'，例如。

目前，我正在使用：

```
str = str.replace(/([\x00\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f])/,function(b){
                    var b = b.charCodeAt();
                    return '\\x'+(b<16?'0':'')+b.toString(16).toUpperCase();
                }); 
```

有没有更好的办法？最初，我在做：

```
str = escape(str).replace('%(\d\d)','\\x$1'); 
```

..但它转义了值高于 32 的字符。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T00:39:42.700

范围。

```
/[\x00-\x1f]/ 
```

另请注意，我删除了括号 - 用于`$&`获取整个模式，而不是`$1`.

# buffer-overflow - 覆盖保存的 eip 以指向标准输入？

> ID：10307887
> 
> 赞同：1
> 
> 时间：2012-04-25T00:36:35.790
> 
> 标签：buffer-overflow

我班上的一个学生想出了一种我以前从未见过的利用缓冲区溢出的技术。（坦率地说，我很惊讶它的工作原理。）我很好奇（1）是否有人以前看过类似的东西，以及（2）这种类型的攻击是否太“脆弱”而无法正常工作。

基本上，漏洞利用的想法是提供表单的输入

```
AA...A BBBB CC...C, 
```

在标准输入上，哪里`AA...A`会导致溢出；保存的 eip 被覆盖`BBBB`；`CC...C`是shellcode 。`CC...C`然而，他并没有用堆栈上的地址覆盖保存的 eip，而是用 stdin 的内存中的地址覆盖了保存的 eip（实际上，是`stdin+length(AA...A BBBB)`）。

（对于那些好奇的人：他这样做的原因是因为`CC...C`堆栈上的地址包含一个空字节，因此很难用该值覆盖保存的 eip。）

如果这通常有效，那么这似乎是绕过 ASLR 的另一种方法。

想法？

# jquery - jquery没有正确服务部分

> ID：10307888
> 
> 赞同：1
> 
> 时间：2012-04-25T00:36:57.153
> 
> 标签：jquery, ruby-on-rails, forms

对于通过 jquery 为 rails 部分服务的任何人来说，这应该是一个简单的问题。这行代码：

```
$('div#status-chg-form').html('<%= escape_javascript(render(:partial => statusform)) %>').dialog('open'); 
```

是在模态对话框中提供部分脚本的一部分。当对话框弹出时，我只得到一个文字字符串，内容如下：

```
<%= escape_javascript(render(:partial => statusform, :remote => true)) %> 
```

这是rails 3.1。

（编辑添加：）

```
 $(rails_partial = "<%= escape_javascript(render(:partial => statusform)) %>");
   $('div#status-chg-form').append(rails_partial).dialog('open'); 
```

我也尝试过以上方法将 html 作为字符串传递，认为 jquery 处理它的方式存在一些问题。还是不行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T14:10:23.127

看起来您的代码在发送给客户端之前没有被处理为 erb。

我建议查看此 Railscast：

[“Railscast 136 - JQuery”](http://railscasts.com/episodes/136-jquery "Railscast 136 - jQuery")

它将引导您准确了解如何解决您遇到的问题。

# dom - 使用 phantomjs 或其他东西挖掘/抓取/Web 控制台？

> ID：10307892
> 
> 赞同：4
> 
> 时间：2012-04-25T00:37:20.707
> 
> 标签：dom, web-scraping, web-crawler, phantomjs, mining

我想创建一个应用程序，其行为与另一个 Web 应用程序的行为直接相关。本质上，在 Gmail 中运行的应用程序会根据用户的操作与界面进行动态交互。

我遇到的问题是我想制作一个与该 Web 应用程序交互的应用程序，但它们不提供开放 API。因此，我不能只为我需要的数据调用 api。

当我在 chrome 中打开开发控制台时，我可以看到正在运行的应用程序，以及基于活动运行的调试注释。

有什么方法可以让我使用 PhantomJS 之类的东西来抓取动态活动，以基于另一个应用程序的活动。

“如果控制台在命令控制台中显示“X”，请在此其他应用程序中运行“Z”脚本。”

我显然不是工程师，但想知道这样的事情是否可行。

处理封闭 API 的一种非常 hacky 的方式。我看不到您的代码或使用它，但如果我可以看到它工作，我可以实时记录并在另一个应用程序中与之交互似乎不合逻辑吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T18:57:20.670

您可以在 Gmail 帐户上设置邮件转发规则，并将邮件从被抓取的站点发送到您的网络服务器上的 POP3 帐户。然后可以将到达此位置的所有内容通过管道传输到旨在提取任何相关链接并获取结束页面的脚本中。除非我们可以去看看有问题的网站，看看它是如何处理信息请求的，否则会更有帮助。

# c# - 从 Web 服务 c# 检索对象列表

> ID：10307895
> 
> 赞同：1
> 
> 时间：2012-04-25T00:37:31.437
> 
> 标签：c#, arrays, web-services, object, types

我想从我的 Web 服务中检索对象列表，但我正在努力处理对象类型。

我有这个代码：

```
 [WebMethod]
    public Car[] GetAllCars()
    {

        List<Car> cars = new List<Car>();
        cars.Add(new Car ("fiat", 1999);
        cars.Add("opel" ,2007);
        cars.Add("chevrolet",2007);
        return cars.ToArray(); // 
     } 
```

当我从浏览器测试网络服务时，一切都很好。它向我展示了应该是什么。

但是在客户端当我尝试做

```
 MyWebService.WebService1SoapClient cars = new MyWebService.WebService1SoapClient();
        Car[] l = (Car[]) cars.GetAllCars(); 
```

它说无法将 ClientApp.MyWebService.Car[] 转换为 ClientApp.model.Car[]

双方（客户端和 Web 服务）的 Car 类是相同的。

我应该怎么做才能解决这个问题？

谢谢你提前。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T03:58:25.227

虽然它们可能*看起来*相同，但这里涉及两个不同的 Car 类：

1.  ClientApp.model.Car - 这是隐藏在 web 服务后面的原始类。
2.  ClientApp.MyWebService.Car - 这是一个近似副本，从 SOAP WSDL 创建

副本不会有任何私有成员，也没有任何原始 Car 的方法。

只需执行此操作即可取回汽车，

```
var carsWebservice = new MyWebService.WebService1SoapClient();
var cars = carsWebservice.GetAllCars(); 
```

这将返回一个 ClientApp.MyWebService.Car 数组

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T02:28:33.073

如果 Car 在两边都相同，则没有理由强制转换它，也没有理由在声明中使用类型。让编译器决定为 l 使用什么类型...

```
var l = cars.GetAllCars(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-07-24T11:06:15.610

它应该适合你：

```
MyWebService.WebService1SoapClient _cars = new MyWebService.WebService1SoapClient();

public List<Car> Cars; 
```

例如在按钮事件中：

```
private void button_valider_Click(object sender, EventArgs e)
    {
        SqlCeConnection connexion =Connexion.getInstance().OpenConnection();
        Cars= new List<Car>();
        Cars= _cars .GetAllCars().ToList();

        foreach (var car in Cars)
        {
            int year= car.year;
             ...

        }

    } 
```

# ruby-on-rails - Rails update_attribute 没有保存

> ID：10307896
> 
> 赞同：3
> 
> 时间：2012-04-25T00:37:54.230
> 
> 标签：ruby-on-rails, activerecord

我遇到了一个奇怪的问题。我有一个模型 GuardianUpdate ，其字段“读取”是一个布尔值。当我在记录上调用 update_attribute(:read, true) 时，rails 无法实际更新记录。

这是我的控制台输出：

```
1.9.3p0 :026 > g = GuardianUpdate.find(1)
  GuardianUpdate Load (0.7ms)  SELECT `guardian_updates`.* FROM `guardian_updates` WHERE `guardian_updates`.`id` = 1 LIMIT 1
 => #<GuardianUpdate id: 1, update_id: 2, guardian_id: 11, read: true, created_at: "2012-04-21 04:06:45", updated_at: "2012-04-21 04:06:45"> 
1.9.3p0 :027 > g.update_attribute(:read, false)
   (0.3ms)  BEGIN
  Update Load (0.4ms)  SELECT `updates`.* FROM `updates` WHERE `updates`.`id` = 2 LIMIT 1
   (0.1ms)  COMMIT
 => true 
1.9.3p0 :028 > g.reload
  GuardianUpdate Load (0.5ms)  SELECT `guardian_updates`.* FROM `guardian_updates` WHERE `guardian_updates`.`id` = 1 LIMIT 1
 => #<GuardianUpdate id: 1, update_id: 2, guardian_id: 11, read: true, created_at: "2012-04-21 04:06:45", updated_at: "2012-04-21 04:06:45"> 
1.9.3p0 :029 > 
```

如您所知，任何地方都没有 UPDATE sql 语句。这是我的 GuaridanUpdate 模型：

```
class GuardianUpdate < ActiveRecord::Base
  belongs_to :update
  belongs_to :guardian
end 
```

有什么想法吗？

我应该提到 update_column(:read, true) 有效，完全没有问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T03:01:36.983

`belongs_to :update`正在创建一个`update`覆盖同名内部 rails 方法的访问器。该方法负责实际保存对现有对象的更改。

重命名关联，你应该没问题。Rails 应该引发一个`DangerousAttributeName`异常来警告你 - 不知道为什么这没有发生

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T02:13:32.943

由于您有一个“belongs_to :update”，您可能有一个名为 Update 的模型。有些人使用名为 Update 的模型报告了问题，请参见此处：

[https://rails.lighthouseapp.com/projects/8994/tickets/5772-calling-a-model-update-leads-to-unexpected-behavior](https://rails.lighthouseapp.com/projects/8994/tickets/5772-calling-a-model-update-leads-to-unexpected-behavior)

也许尝试将其重命名为 ContentUpdate 或其他名称。

# c# - C# 中是否有一种优雅/内置的方法来添加字符串连接器 IFF 两个字符串的长度 > 0？

> ID：10307897
> 
> 赞同：0
> 
> 时间：2012-04-25T00:38:04.840
> 
> 标签：c#, string-concatenation

我知道我可以通过扩展来做到这一点（我用 这样做`StringBuilder`），但只要我需要它，我觉得必须有更好的方法。假设我正在组合名字和姓氏，其中任何一个都可能丢失（null 或空，不在乎），如果两者都存在，我只想要一个空格。所以

```
return firstName + (!string.IsNullOrEmpty(firstName) && !string.IsNullOrEmpty(lastName) ? " " : string.Empty) + lastName; 
```

给我`Joe Smith`，但从来没有`Joe[trailingspace]`or `[leadingspace]Smith`。

显然这是一个愚蠢的例子，但我在现实世界中经常这样做。有更好的想法吗？

**编辑**：不要建议 String.Join。它不起作用。（好吧，除非你将它与 LINQ 结合起来，就像下面的花费者所做的那样。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T00:57:42.257

我会选择类似的东西：

```
public static string JoinNonEmpty(string separator, params string[] values)
{
    return 
        string.Join(separator, values.Where(v => !string.IsNullOrEmpty(v)));

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T00:47:43.337

从这个博客[String.Join 方法？](http://www.paulvanbrenk.com/blog/2008/12/30/ABetterStringJoin.aspx)，您可以创建一个接收数组和分隔符的扩展方法吗？：

```
string[] input = {"Joe", null, "Smith"};
return input.Aggregate((x,y)=>String.IsNullOrEmpty(y)?x :String.Concat(x, " ", y)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T00:59:30.913

我个人会使用 string.Format()：

```
var myName = string.Format( "{0}{1}{2}"
                           , firstName
                           , !string.IsNullEmptyOrwhitespace(firstName) && !string.IsNullEmptyOrWhitespace(lastName) ? " " : string.empty
                           , lastName
                           ); 
```

这不是依赖 LINQ 或扩展方法的聪明代码，它是一种标准的、基本的和直接的方法 - 重要的是，您可以立即看到正在发生的事情以及结果应该是什么。如果您希望在许多不同的地方执行相同的操作，则使用扩展方法变得更加相关。

或者，您的数据对象可以封装此逻辑：

```
public class MyData
{
    public string FirstName { get; set; }

    public string LastName { get; set; }

    public string FullName
    {
        get { /*insert the string.Format() illustrated above */ }
    }
} 
```

# audio - XNA 4.0 无法创建 AudioEngine

> ID：10307898
> 
> 赞同：0
> 
> 时间：2012-04-25T00:38:13.823
> 
> 标签：audio, xna-4.0, xact

这个问题是这个问题的派生：[Creating XNA AudioEngine on windows game project](https://stackoverflow.com/questions/8389044/creating-xna-audioengine-on-windows-game-project)

我正在使用同一本书，并且遇到与原始问题相同的问题。安德鲁提供的解决方案不起作用，因为也不存在。

我无法`AudioEngine`在我的项目中使用类。我试过添加这个 using 语句：

```
using Microsoft.Xna.Framework.Xact; 
```

我不知道该怎么办。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T12:20:51.567

确保你有**参考**`Microsoft.Xna.Framework.Xact.dll`

在 Visual Studio 中，在您的 Game 项目中，右键单击**References**文件夹 ->**添加引用**

选择**Browse**选项卡，然后导航到 Program Files (x86)/Microsoft XNA/XNA Game Sudio/v4.0/References/Windows/x86/，选择**Microsoft.Xna.Framework.Xact.dll**并单击**OK**。

添加`using Microsoft.Xna.Framework.Audio;`，您应该可以使用`AudioEngine`类。

# c# - 如何在 sitefinity CMS 中创建站点地图？

> ID：10307899
> 
> 赞同：3
> 
> 时间：2012-04-25T00:38:20.327
> 
> 标签：c#, asp.net, content-management-system, sitefinity

请给我示例或链接如何在 Sitefinity 中创建站点地图。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-03-08T02:41:02.120

这是我在 Sitefinity 6.1 中生成站点地图内容（页面、内置和动态）的方式。

请注意[“在为内容项配置默认页面之前，您必须配置规范 URL 服务。”](http://www.sitefinity.com/documentation/documentationarticles/default-pages-for-content-items)

*   **页面**

    ```
    ISite currentSite = ((MultisiteContext) SystemManager.CurrentContext).CurrentSite;
    using (var manager = PageManager.GetManager())
    {
        var nodes = manager.GetPageNodes().Where(p =>
            p.RootNodeId == currentSite.SiteMapRootNodeId &&
            p.NodeType == Telerik.Sitefinity.Pages.Model.NodeType.Standard &&
            p.ShowInNavigation);
        foreach (var node in nodes)
        {
            if (!node.Page.IsBackend &&
                node.Page.Status == ContentLifecycleStatus.Live && 
                node.Page.Visible)
            {
                string host = getPageHost(serverPort, serverName, node.Page.RequireSsl);
                var url = string.Concat(host, VirtualPathUtility.ToAbsolute(node.GetFullUrl()));
                // Then append to sitemap
            }
        }
    } 
    ```

*   **内置内容类型 - 新闻示例**

    ```
    using (var manager = NewsManager.GetManager())
    {
        var newsItems = manager.GetNewsItems().Where(p => 
            p.Status == ContentLifecycleStatus.Live && p.Visible).ToList();
        // append items
        foreach (var item in newItems)
        {
            var location = SystemManager.GetContentLocationService().GetItemDefaultLocation(item);
            if (location != null)
            {
                var fullUrl = location.ItemAbsoluteUrl;
                // Then append to sitemap (if page is live/visible/frontend)                    
            }
        }
    } 
    ```

*   **动态内容类型**

    ```
    ISite currentSite = ((MultisiteContext) SystemManager.CurrentContext).CurrentSite;
    var providers = currentSite.GetProviders("YourModuleName").Select(p => p.ProviderName).ToList();
    foreach (string provider in providers)
    {       
        var dynamicType = TypeResolutionService.ResolveType("Fully.Qualified.Name.Of.Your.Dynamic.Type");

        if (dynamicType != null)
        {
            using (var manager = DynamicModuleManager.GetManager(providerName))
            {
                var dynamicTypeItems = manager.GetDataItems(dynamicType).Where(p =>
                    p.Status == ContentLifecycleStatus.Live && p.Visible).ToList();
                foreach (var item in dynamicTypeItems)
                {
                    var location = SystemManager.GetContentLocationService().GetItemDefaultLocation(item);
                    if (location != null)
                    {
                        var fullUrl = location.ItemAbsoluteUrl;
                        // Then append to sitemap (if page is live/visible/frontend)                    
                    }
                }
            }
        }
    } 
    ```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-25T00:53:16.823

您可以在此处使用站点地图生成器（免费）： http: [//enterprisefinity.com/products/sitefinity-sitemap-generator/](http://enterprisefinity.com/products/sitefinity-sitemap-generator/)

但是您还应该熟悉在 Sitefinity 中创建通用站点地图生成器的一些挑战。每条内容都没有设置应该出现的页面 - 这取决于您网站中小部件的配置。因此，很难构建一个解决方案来理解（例如）来自 foo 部门的新闻到这里，来自酒吧部门的新闻到那里——Sitefinity 只知道这都是新闻内容。

看看这里，更好地了解站点地图生成器背后的代码： [http ://www.sitefinity.com/blogs/joshmorales/posts/11-12-22/new_sitefinity_4_4_sdk_sample_sitemap_module.aspx](http://www.sitefinity.com/blogs/joshmorales/posts/11-12-22/new_sitefinity_4_4_sdk_sample_sitemap_module.aspx)

# iphone - 编写一个简单的 NSpredicate - 逻辑问题

> ID：10307902
> 
> 赞同：0
> 
> 时间：2012-04-25T00:38:34.037
> 
> 标签：iphone, objective-c, nspredicate

我有一个`Person`对象。该`person`对象具有以下属性；

```
Name
StartDate
EndDate 
```

我将此`Person`对象保存到`array`. 该数组可能包含多个`100 person`对象。

以下是`person`该数组中的对象示例；

```
John, Tue Feb 22, Thr Mar 30
Jack, Wed Mar 09, Fri Apr 21
Jack, Thu Mar 19, Fri Dec 20
Jack, Tue Jan 08, Fri Apr 26 etc.. 
```

现在我需要提供一个日期，例如`Wed 29 Mar`，我需要检查它是否在对象数组的范围`StartDate`内。我怎样才能做到这一点 ？我的工作如下，但它不起作用（它给出了不正确的结果）`EndDate``persons`

```
NSPredicate *datePred = [NSPredicate predicateWithFormat:@"StartDate>= %@ && EndDate<= %@",givenDate,givenDate];
            resultArray = [arrayContainingAllPersonObjects filteredArrayUsingPredicate:datePred ]; 
```

我也尝试了以下方法，但它也给出了不正确的结果（已从 SO 帖子中删除）；

```
NSPredicate *greaterThanPredicate = [NSPredicate predicateWithFormat:@"StartDate<= %@", providedDate"];
NSPredicate *lessThanPredicate = [NSPredicate predicateWithFormat:@"EndDate>= %@", ProvidedDate"];
NSPredicate *betweenPredicate = [NSCompoundPredicate andPredicateWithSubpredicates:[NSArray arrayWithObjects:greaterThanPredicate, lessThanPredicate, nil]]; 
```

我不知道是什么原因造成的，求助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T13:01:46.990

StartDate 和 EndDate 是 NSDate 对象吗？

我建议看看这篇关于谓词的文章。它帮助我将过滤和搜索代码减少到几行： http: [//www.cocoanetics.com/2010/03/filtering-fun-with-predicates/](http://www.cocoanetics.com/2010/03/filtering-fun-with-predicates/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T11:37:59.417

尝试使用 '%@' 之类的`StartDate = '%@' && EndDate ='%@'`

升级版：

尝试

```
NSPredicate *predicate = [NSPredicate predicateWithFormat:[NSString stringWithFormat:@"StartDate = '%@', startDateHere]]; 
```

# android - 从android中的数据库获取lat long值

> ID：10307904
> 
> 赞同：2
> 
> 时间：2012-04-25T00:38:43.217
> 
> 标签：android, google-maps, latitude-longitude

我在关注一个较早的问题（位于此处：[Get Latitude and Longitude from SQLite database for use in Android MapOverlay](https://stackoverflow.com/questions/7286746/get-latitude-and-longitude-from-sqlite-database-for-use-in-android-mapoverlay)）

我了解那里的代码，并且我的数据库具有类似的布局，因为它有 4 列；id、名称、纬度和 lng。我什至想做那里所说的，因为它从该表中选择所有内容并将纬度长点放置在叠加层中。我的问题是答案需要一些先决条件，所以我只是想知道是否有人可以帮助我完成这项工作。

提前致谢，这是我编辑的代码的当前状态；

```
ArrayList<OverlayItem> items = new ArrayList<OverlayItem>();
        Cursor locationCursor = databaseObject.query("locations", new String[] {"image_id", "name", "lat", "lng" }, null, null, null, null);

        locationCursor.moveToFirst();
        do {
            String image_id = locationCursor.getString(locationCursor
                    .getColumnIndex("image_id"));
            String name = locationCursor.getString(locationCursor
                    .getColumnIndex("name"));
            int latitude = (int) (locationCursor.getDouble(locationCursor
                    .getColumnIndex("lat")) * 1E6);
            int longitude = (int) (locationCursor.getDouble(locationCursor
                    .getColumnIndex("lng")) * 1E6);
            items.add(new OverlayItem(new GeoPoint(latitude, longitude), image_id, name));
        } while (locationCursor.moveToNext()); 
```

更具体地说，我在 databaseObject.query 中遇到错误，我假设这是因为我没有在此之前的部件。

编辑。

为了更加清晰，目的是从我在 phpmyadmin 中的表中获取 lat 和 long 值，并将它们显示在我的 android 应用程序中的谷歌地图覆盖上。上面的代码是我找到的一个示例的显示，但由于代码在它之前需要一些部分，所以无法让它工作

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T00:59:28.353

如果查询不返回任何记录，则游标将为空，并且`do while`无论如何都会执行语句，最终将引发错误。尝试这个

编辑::

```
 SQLiteDatabase databaseObject = null; 
        databaseObject = this.openOrCreateDatabase(SAMPLE_DB_NAME, MODE_PRIVATE, null);
        ArrayList<OverlayItem> items = new ArrayList<OverlayItem>();
        Cursor locationCursor = databaseObject.query("locations", new String[] {"image_id", "name", "lat", "lng" }, null, null, null, null);

         while (locationCursor.moveToNext()){
            String image_id = locationCursor.getString(locationCursor
                    .getColumnIndex("image_id"));
            String name = locationCursor.getString(locationCursor
                    .getColumnIndex("name"));
            int latitude = (int) (locationCursor.getDouble(locationCursor
                    .getColumnIndex("lat")) * 1E6);
            int longitude = (int) (locationCursor.getDouble(locationCursor
                    .getColumnIndex("lng")) * 1E6);
            items.add(new OverlayItem(new GeoPoint(latitude, longitude), image_id, name));
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T02:17:14.510

也许您应该在数据库服务器端用 php 编写一些代码，然后检索您的数据库，然后将结果作为 JSON 传递。看到[这个链接](http://www.helloandroid.com/tutorials/connecting-mysql-database)和[这个](https://stackoverflow.com/questions/4392835/android-remote-database)。

# php - CodeIgniter DataMapper 慢吗？

> ID：10307906
> 
> 赞同：1
> 
> 时间：2012-04-25T00:39:02.170
> 
> 标签：php, mysql, codeigniter, codeigniter-datamapper

我一直在使用 Codeigniter 研究关系数据库，发现 DataMapper 对于严肃的项目毫无用处。Codeigniter 的活动记录没有用，因为它也没有提供多对多或一对多的方法。DataMapper 速度慢且不可配置！

1.  当您查询时，它将整个表加载到一个对象中。
2.  当您第一次输入“A”第二次输入“A”时，数据库中将有 2 个 As。它没有像 SQL 这样的 Ignore 选项。您必须查询一个项目以查看它是否存在，如果不存在，则插入它。
3.  他们为它做了很多编码，但它似乎对建立一个庞大的数据库没有任何好处
4.  查询速度不快。

这似乎是社区之间的共识。是否推荐在php中使用纯mysql对多对多和一对多进行操作？还是你认为我错了！请随时给我建议。我的问题是，作为一名专业的网页设计师，你用什么来做你的数据库？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-25T20:01:23.753

有点奇怪的说法。

您定义您的要求，然后选择满足这些要求的工具，而不是相反。

Datamapper 是一个 ORM，一个对象关系映射器。在这种情况下，遵循 Active Record 设计模式（不要将此与 CI 的 AR 混淆，后者不是活动记录，它是一个查询构建器）。它将数据实体（在本例中为 RDBMS 表中的记录）映射到对象，并且知道这些对象之间的关系。

这就是 ORM 所做的。是不是比使用 PHP 的原生函数直接访问数据库要慢？绝对地。添加的任何抽象级别都会增加处理时间。

ORM 的目标不是在数据操作方面最快，它的目标是从控制器逻辑中抽象出数据操作，这使得编写应用程序变得更容易和更快，并且绝对更快地维护这些应用程序。就像在商业环境中时间 == 金钱一样，这就是好处所在。如果您免费编码并在两位共享主机上运行您的代码，那么 ORM 可能不适合您。

此外，ORM 不是瑞士军刀。它是为特定目的而设计的，这是一种面向对象的数据收集方法，并用于操纵这些收集及其关系。

如果它不是工作的正确工具，请勿使用它。如果您需要根据一些奇怪的标准批量更新一百万条记录，请改为编写本机 SQL 查询。在自定义模型方法中执行此操作，以使您的数据操作代码从控制器中抽象出来。

至于您的具体意见：

*   Datamapper 很慢：与什么相比？
*   它是不可配置的：参见[http://datamapper.wanwizard.eu/pages/config.html](http://datamapper.wanwizard.eu/pages/config.html)。
*   它加载整个表：如果你 get() 整个表，是的。对我来说似乎并不奇怪。
*   如果您使用相同的数据创建两个对象，它会保存两次：是。如果您两次运行相同的 UPDATE 查询，则相同。
*   它不适合大型数据库：我有 Datamapper 支持的应用程序和 TB 大小的数据库，所以我看不出与大小的关系。
*   它并不快：请参阅答案 nr。1.

如果您是一名专业的网页设计师，您应该了解使用 MVC 架构设计和构建应用程序的正确方法，并使用正确的工具集完成工作，以便及时将应用程序交付给您的客户。

时间 == 金钱，如果您可以更快地交付，并且您可以更快地维护或改进，您将留住您的客户。ORM 可以帮助你。但不要将它用于它不应该做的事情。

# objective-c - 按列标题对表格进行排序并保持 NSArrayController 同步

> ID：10307912
> 
> 赞同：0
> 
> 时间：2012-04-25T00:40:32.620
> 
> 标签：objective-c, cocoa, nstableview, nsarraycontroller

我是一个相对缺乏经验的 Cocoa 程序员，主要通过查看示例代码和反复试验来学习，我被这个难住了：我有一个绑定到`NSArrayController`. 每个列都有其视图单元格值绑定到表格单元格视图的 objectvalue.description 键。

问题是当我单击列标题对表格进行排序时，数组不会随之更新其顺序。由于我主要是通过反复试验来学习的，因此可能缺少一些基本概念，但是我进行了很多搜索，但一无所获。最接近的结果在这里：

[https://stackoverflow.com/questions/9280762/keep-nsarraycontroller-in-sync-with-sorted-nstableview](https://stackoverflow.com/questions/9280762/keep-nsarraycontroller-in-sync-with-sorted-nstableview)

绑定不应该使数组和表保持同步吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T04:12:12.853

不，与表格视图保持同步的是数组控制器的排列对象——当您对表格进行排序时，您正在对数组控制器的排列对象进行排序，而不是向控制器提供内容的数组。

# html - 外部跨域 mp3 不会在 Flash 播放器中加载（谷歌文本转语音）

> ID：10307913
> 
> 赞同：8
> 
> 时间：2012-04-25T00:40:43.137
> 
> 标签：html, flash, cross-domain, text-to-speech

我想在我的网页上的 Flash 播放器中播放 Google Text-To-Speech URL。

我正在使用[http://www.alsacreations.fr/dewplayer.html](http://www.alsacreations.fr/dewplayer.html)但它不起作用：

```
<object type="application/x-shockwave-flash" data="dewplayer.swf" width="200" 
        height="20" id="dewplayer" name="dewplayer">
<param name="wmode" value="transparent" />
<param name="movie" value="dewplayer.swf" />
<param name="flashvars" value="mp3=http://translate.google.com/translate_tts?q=hello-word&tl=en" />
</object> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T12:23:13.393

MP3 文件的 URL 必须是 URL 编码的 (http://www.w3schools.com/tags/ref_urlencode.asp)

```
<object type="application/x-shockwave-flash" data="dewplayer.swf" width="200" height="20" id="dewplayer" name="dewplayer">
<param name="wmode" value="transparent" />
<param name="movie" value="dewplayer.swf" />
<param name="flashvars" value="mp3=http%3A%2F%2Ftranslate.google.com%2Ftranslate_tts%3Fq%3Dhello-world%26tl%3Den" />
</object> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-06-09T12:48:17.680

我进行了深入研究并找到了一些解决方案。Mathieu 的结论（谷歌改变了论点，你必须编写自己的应用程序）是错误的。问题是谷歌检查跨域访问。令人惊讶的是，在[这种情况下](https://stackoverflow.com/questions/12256320/embed-video-not-displayed)，它不受[Adob​​e Flash 播放器 crossdomain.xml](http://www.adobe.com/devnet/articles/crossdomain_policy_file_spec.html)的监管。Flash 播放器不会尝试从服务器根目录加载该文件（在 Firebug 中测试）。

问题是google正在检查referer，如果设置了，它会拒绝加载内容，请检查：

*   [对 mp3 文件的外部引用 - 正常站点 - 有效](http://artax.karlin.mff.cuni.cz/%7Ettel5535/pub/flash-mp3/c5.html)
*   [对 mp3 文件的外部引用 - 谷歌翻译 - 不起作用，因为检查了引用者](http://artax.karlin.mff.cuni.cz/%7Ettel5535/pub/flash-mp3/a2.html)
*   [谷歌直接翻译 - 工作，没有发送引用](http://translate.google.com/translate_tts?q=hello-word&tl=en)（注意！在此之后，上面的链接也将工作，因为 mp3 文件已经在缓存中！）

所以问题归结为内联内容的引用欺骗。

### 解决方案 1 - RefererKiller

`<img src="">`您可以使用一个简单的技巧：在标记中引用 mp3 文件，[请参阅我的示例](http://artax.karlin.mff.cuni.cz/%7Ettel5535/pub/flash-mp3/a2.html)，并添加引用者欺骗。然后 Flash 播放器将不必下载它，因为它已经在缓存中。有一些[解决方案可以从内联内容中删除引用者](https://stackoverflow.com/a/12745307/684229)（请参阅[图像的引用者杀手实现](http://referrer-killer.googlecode.com/git/example.html)）。但是，[评论](https://stackoverflow.com/a/12745307/684229)表明跨浏览器兼容性可能是一个问题。

### 解决方案 2 - https

因此，最简单的解决方案是使用`https`协议 - 清除缓存并[尝试添加 https 的上述链接](https://artax.karlin.mff.cuni.cz/%7Ettel5535/pub/flash-mp3/a2.html)。[内联内容不会设置Referer](https://stackoverflow.com/a/5033362/684229)。但是，如果您没有受信任的证书，您可能不希望您的用户通过可怕的 4 次单击过程来确认对您的证书的信任。在这种情况下，您可能想要寻求另一种解决方案。

# android - 将阿拉伯字符和中文字符转换为其 ASCII 值

> ID：10307914
> 
> 赞同：1
> 
> 时间：2012-04-25T00:40:44.743
> 
> 标签：android, string, asciiencoding

我正在尝试将一些阿拉伯语和中文字符转换为它们的 ASCII 值以传递到 Android 中的 URL，但我真的不知道如何开始。任何想法，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T00:49:43.940

这是一个可能与您正在寻找的问题接近的问题

[带有中文字符的 URI 无效 (Java)](https://stackoverflow.com/questions/4831301/invalid-uri-with-chinese-characters-java)

# java - 如何格式化这个 java.sql.date？

> ID：10307920
> 
> 赞同：0
> 
> 时间：2012-04-25T00:42:26.710
> 
> 标签：java, xml-parsing

有人可以告诉我如何从中提取日期和时间吗？我是一个java nube！:-)

它以 XML 格式发送，当我以以下格式读取节点时：

对我来说 objDeliveryRoute.getStartTime() 是以下格式的日期：yyyy-MM-ddThh:mm:nn（这里的 T 代表 Tango）。
示例是：

2012-04-24T18:41:00

这需要在 MSSQL Server 2008 数据库中找到一个家。
这是我遇到的代码片段：

```
mydatetime = new java.sql.Timestamp(objDeliveryRoute.getStartTime().toGregorianCalendar().getTime().getTime()); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T01:08:50.917

使用标准 JavaSDK 中的[SimpleDateFormat](http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html)类。

检查此代码段。它根据您提供的字符串创建一个 java.util.Date 实例：

```
 DateFormat df = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss");
    String myDateString = "2012-04-24T18:41:00";
    java.util.Date myDate = df.parse(myDateString); 
```

要编写 java.sql.Date 实例，请根据上述代码片段执行以下操作：

```
java.sql.Date sqlDate = new java.sql.Date(myDate.getTime()); 
```

# iphone - iOS：发送 http 请求/读取 http 响应

> ID：10307923
> 
> 赞同：0
> 
> 时间：2012-04-25T00:42:28.570
> 
> 标签：iphone, ios, xcode

我需要在网站上验证我的 iPhone 应用程序。是否有发送 http 请求和读取 http 响应的模式？

我需要能够从服务器拒绝中了解登录名/密码是否错误并在 iPhone 上显示，有什么指示吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T03:02:48.923

是的，使用 NSUrlConnection APi。它完全符合您的要求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T17:41:14.087

ASIHTTPRequest 库在使您谈论的很多内容变得相当容易方面非常有效。在[ASIHTTPRequest中查看](http://allseeing-i.com/ASIHTTPRequest/How-to-use)

# jquery - jQuery 创建元素并使用它

> ID：10307928
> 
> 赞同：0
> 
> 时间：2012-04-25T00:42:52.450
> 
> 标签：jquery, append

例如，我有类似的东西：

```
<div id="buttons">
    <button class="button">Click</button>
</div>

<script>
    $(document).ready(function() {
        $('.button').click(function() {
            $('#buttons').append('<button class="button">Click</button>');
        });
    });
</script> 
```

当我按下“单击”按钮时，脚本将创建一个具有相同类“按钮”的新按钮。当我按下这个新按钮时——什么也没有发生。

我明白为什么，但我不知道如何避免这种情况。我希望我的脚本“看到”刚刚创建的按钮。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T00:45:13.740

用于[`on`](http://api.jquery.com/on)绑定到委托事件

```
$("#buttons").on("click", ".button", function () {
   $('#buttons').append('<button class="button">Click</button>');    
}); 
```

**示例：http:** [//jsfiddle.net/66H8W/](http://jsfiddle.net/66H8W/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T00:48:12.493

Hiya**演示**： http: [//jsfiddle.net/vcrF3/](http://jsfiddle.net/vcrF3/) **或[http://jsfiddle.net/vcrF3/1/](http://jsfiddle.net/vcrF3/1/)

[http://api.jquery.com/on/](http://api.jquery.com/on/) **报价**

> events-map 一个映射，其中字符串键表示一个或多个空格分隔的事件类型和可选的命名空间，值表示要为事件调用的处理函数。

**jQuery代码**

```
 $.fn.ready(function() {
       $('div').on("click", ".button",  function() {
           $('#buttons').append('<button class="button">Click</button>');
          // alert('append button is clicked');
        });
    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T00:47:13.950

阅读[http://api.jquery.com/on/](http://api.jquery.com/on/)，特别注意“直接和委托事件”部分。

# java - 进入刚刚创建的新目录

> ID：10307929
> 
> 赞同：1
> 
> 时间：2012-04-25T00:42:52.707
> 
> 标签：java, directory, command

我想创建一个目录，输入该目录并将文件复制到其中。这在java中可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T01:32:28.510

> 我想创建一个目录，输入该目录并将文件复制到其中。这在java中可能吗？

可以创建目录。使用`File.mkdir`或`File.mkdirs`。

可以将文件复制到目录中。有很多方法可以做到这一点，具体取决于您复制的内容/位置。

通过输入目录，我假设您的意思是使新目录成为 JVM 的“当前目录”。不幸的是，标准 Java 不允许您这样做。无法更改 JVM 的当前目录。然而：

*   你*不需要*改变目录做你想做的事......将文件复制到一个新目录。

*   通常，需要当前目录概念的应用程序（对于整个应用程序或单个线程），您可以通过创建相对于表示相关当前目录的`File`a 的对象来实现它。`File`

我不确定，为什么 Java 设计者决定不支持“chdir”功能。然而：

*   某些操作系统平台本身可能不支持更改目录，从而导致在 Java 中安全有效地支持此功能的问题。（在将路径名传递给操作系统之前，JVM 需要相对于绝对路径映射本身。并且可能会避免出现竞争条件。）

*   “chdir”（例如 UNIX/Linux 本身支持的）影响整个进程的事实可能使其在多线程 Java 应用程序中出现问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T01:14:22.607

[commons-io](http://commons.apache.org/io/)的copyDirectory [()](http://commons.apache.org/io/api-release/org/apache/commons/io/FileUtils.html#copyDirectory%28java.io.File,%20java.io.File%29)、[copyFile()](http://commons.apache.org/io/api-release/org/apache/commons/io/FileUtils.html#copyFile%28java.io.File,%20java.io.File%29)或[copyFileToDirectory()](http://commons.apache.org/io/api-release/org/apache/commons/io/FileUtils.html#copyFileToDirectory%28java.io.File,%20java.io.File%29)方法之一将为您处理所有这些。无需担心存在或不存在。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T00:46:32.973

是的。

[您可以使用File.mkdir()](http://docs.oracle.com/javase/6/docs/api/java/io/File.html#mkdir%28%29)创建一个目录

对于复制文件，还有其他 API。这是[官方 Java 教程的相关页面](http://docs.oracle.com/javase/tutorial/essential/io/copy.html)，带有示例链接。

请注意，您无需更改当前目录即可制作此副本。

# gcc - binutils: hex2asm

> ID：10307930
> 
> 赞同：0
> 
> 时间：2012-04-25T00:42:52.947
> 
> 标签：gcc, assembly, android-ndk, binutils

我从 android 的 logcat 得到堆栈转储，它显示了 pc 周围的代码，如下所示：

```
I/DEBUG ( 1006): 电脑周围的代码:
我/调试（1006）：825b11b8 e1cd66d8 e59de070 e046a007 e3caa00f
我/调试（1006）：825b11c8 e1a0c007 e1a06000 e0808005 e0809085
我/调试（1006）：825b11d8 f426892d f428c92d f469092d e25cc010
我/调试（1006）：825b11e8 f426992d f428d92d f308014c f469192d
我/调试（1006）：825b11f8 f30aa14e f466492d f30c2160 f468892d

```

问题是：使用 gcc/binutils，我怎样才能将这些东西转换成 asm？

# iphone - 我无法在 iPhone 上创建联系人组，我该如何解决？

> ID：10307931
> 
> 赞同：0
> 
> 时间：2012-04-25T00:42:54.713
> 
> 标签：iphone, objective-c, ios, xcode

嗨，我正在学习 iOS 编程，但我遇到了麻烦

我想建立一个联系组，并添加我的通讯录。

但问题是我的代码可以在模拟器上运行，但 iPhone 不行。

我不知道为什么，这是我的代码

```
-(void) createAGroupInContact:(NSString *)aGroupName
{
   CFErrorRef error = NULL;
   ABAddressBookRef addressBook = ABAddressBookCreate();
   ABRecordRef group = ABGroupCreate();

   if(ABRecordSetValue(group, kABGroupNameProperty, aGroupName, &error)) {
      NSLog(@"setValue ok"); //set value is succeed on iPhone and simulator both.
   else {
      NSLog(@"setValue fail");
   }

   if(ABAddressBookAddRecord(addressBook, group, &error)) {
      // when i run my code on simulator, group is saved.
      NSLog(@"group save ok");
   }
   else {
      // but when i run my code on iPhone, group doesn't save
      NSLog(@"group save fail");
      NSLog(@"error = %@", error); // it printed error = (null)
   }

   if(ABAddressBookSave(addressBook, &error)) {
      NSLog(@"save ok");
   }
   else {
      NSLog(@"save fail");
   }
   CFRelease(group);
   CFRelease(addressBook);
} 
```

我尝试自己解决这个问题，但不能。

为什么此代码在模拟器上成功成功，但为什么在 iPhone 上不成功？

我在哪里可以修复它？我该如何解决？请帮我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T02:11:05.333

某些通讯簿源不支持组创建。您是否与 iPhone 上的 MS Exchange 或类似的东西同步？

# ios - 对于 iPhone 地图应用程序，如何创建图表？

> ID：10307932
> 
> 赞同：2
> 
> 时间：2012-04-25T00:42:57.257
> 
> 标签：ios, data-structures, graph, map

我想为商场或机场等室内场所制作一个基本上是谷歌地图的应用程序。我知道我必须从平面图创建一个图表并使用最短路径查找算法来绘制从一个位置到另一个位置的最短路径。如何将商场或机场表示为图表？我是否将每个商店或大门或其他东西作为节点，将人行道作为边缘？还是我必须更具体，例如每 5-10 英尺制作一个节点？我需要具体到什么程度？我应该如何制作节点和边？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-27T20:41:32.410

我建议将平面图视为一个网格，其中每个单元格代表*x*平方米。在可访问区域内的每个单元格上放置一个节点。边缘位于每个相邻单元之间，并且都具有*x*成本。

这种方法的优点是您可以有效地将其放置在内存中（您可以将其放入矩阵中，而不必使用 adiecency 列表等）。对于寻路，您可以使用简单的 A* 实现，该实现使用两点之间的欧几里得距离作为启发式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T21:25:08.350

您想在这里解决几个不同的问题。一是两地之间的结构关系，二是几何关系。最短路径部分取决于几何形状，部分取决于结构。例如。路径不一定是直线。对于该结构，您可以将商场商店和大门表示为节点，将路径表示为边。将节点之间的实际距离作为边缘的“权重”，并使用[Dijstra 的算法](http://en.wikipedia.org/wiki/Dijkstra%27s_algorithm)找到最短路径。

如果您只需要以文本形式呈现结果，例如“转到 A，然后转到 B”，或者在地铁（地下）样式的拓扑图上，这很好。但是，如果您想在地板的几何精确表示上显示结果，则需要使结构和几何之间的连接更加牢固。我建议您在路径转弯的任何地方添加节点来扩充上述结构，并使用 x,y 坐标以及布尔值标记节点是否为中间节点。只选择真正的节点作为源和目标，但对 Dijkstra 使用整个图。在屏幕上绘制结果时，遍历最短路径中的节点，并使用它们的坐标绘制一条从源到目标的分段直线。

# autocomplete - 用于谷歌自定义搜索的自动完成 API

> ID：10307933
> 
> 赞同：0
> 
> 时间：2012-04-25T00:43:31.123
> 
> 标签：autocomplete, google-search-api, google-custom-search

我正在尝试将自动完成添加到我最近安装的谷歌自定义搜索中。

我设法通过向 googleapis.com/customsearch/v1 发送请求来使搜索工作，但现在我无法让自动完成功能针对谷歌自定义搜索工作。我确实在我的自定义搜索帐户上启用了自动完成功能，但我找不到任何 API 或方法来获取建议的单词列表。

是否有任何可用的 API 用于自动完成以在自定义搜索中建议单词？

我确实找到了这篇文章，[Google Custom Search API Autocomplete？](https://stackoverflow.com/questions/8232367/google-custom-search-api-autocomplete)，但我无法让它工作。只是想知道是否有任何其他建议或解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-12-01T16:04:32.327

我知道这是一个早已被放弃的问题，但对于任何正在寻找此信息的人来说，[这个 stackoverflow 答案](https://stackoverflow.com/a/8415960/1332402)表明它不可用。此外，这里是谷歌关于删除自动完成 API（从公共、非搜索使用）[的博客文章。](http://googlewebmastercentral.blogspot.ca/2015/07/update-on-autocomplete-api.html)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-01T16:28:34.557

您必须在 Google 的 CSE 帐户中设置条款。所以登录谷歌，去产品 - 自定义搜索引擎 - 自动完成。但是，我过去曾让我的工作，但现在似乎没有工作。谷歌搜索表明其他人也有同样的问题，目前无法正常工作..仅供参考，基于快速尝试纠正我的问题。

# php - PHP XML - 编辑、删除和重新排序

> ID：10307936
> 
> 赞同：0
> 
> 时间：2012-04-25T00:43:38.270
> 
> 标签：php, xml, dom, simplexml

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<root>
  <pages>
    <page>
      <title>Home</title>
      <content>Lorem Ipsum</content>
    </page>
    <page>
      <title>Pictures</title>
      <content>Lorem Ipsum</content>
    </page>
    <page>
      <title>Information</title>
      <content>Lorem Ipsum</content>
    </page>
  </pages>
  <css>
    <css-tag>
      <title>background-color</title>
      <value>#FFF</value>
    </css-tag>
  </css>
  <layout>1</layout>
</root> 
```

**是我的 XML 文件吗**

**首先**我想“ `replace <Content> with $content where <Title> = $title`”并保存它

**其次**我需要“ `delete page where <Title> = $title`”并保存它

**第三**，我需要一个更改页面布局的选项，有人知道如何做到这一点吗？我知道每个“页面”都是按照它们所在的顺序打印的，也许我应该有`<page id="0"> <page id="1"> <page id="2">` 并且有一个`<order>2,0,1</order>`或者有更好的方法吗？

非常感谢大家的帮助！我已经阅读了大量的 simpleXML 和 DOM 教程，但我就是不会使用它们哈哈！

# mysql - 看似简单的加入我想不通

> ID：10307937
> 
> 赞同：2
> 
> 时间：2012-04-25T00:43:47.550
> 
> 标签：mysql, join

我以前从未做过这样的加入

基本上，我有 2 个具有以下结构的表：

```
categories:
- id - int
- name - varchar
- show_in_menu - varchar
- sort_order - int

pages:
- id - int
- name - varchar
- show_in_menu - varchar
- sort_order - int 
```

我正在尝试编写一个查询，它将选择所有类别和页面并将它们吐出在一个列表中，以便它们按 sort_order 字段排序，我只想选择 show_in_menu == 'Yes' 的行。问题是我希望在两个表中按 sort_order 排序，例如：

```
page 1 - (sort order of 0)
page 2 - (sort order of 1)
category 1 - (sort order of 2)
page 4 - (sort order of 3)
category 7 - (sort order of 4) 
```

我真的不知道如何完成我的查询，这里是：

```
select c.*, p.* 
from `categories` as c
join `pages` as p 
```

任何帮助将不胜感激...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T00:59:40.197

您可以尝试联合查询：

```
SELECT * FROM categories
WHERE show_in_menu = 'Yes'
UNION
SELECT * FROM pages
WHERE show_in_menu = 'Yes'
ORDER BY sort_order 
```

[http://w3schools.com/sql/sql_union.asp](http://w3schools.com/sql/sql_union.asp)

# .htaccess - htaccess 重定向的问题

> ID：10307943
> 
> 赞同：0
> 
> 时间：2012-04-25T00:44:35.757
> 
> 标签：.htaccess, mod-rewrite, redirect, rewrite

在以下网站上：http: [//htaccess.madewithlove.be/](http://htaccess.madewithlove.be/)

填写请求网址：[http://localhost/prefix/games/u_id/game-name](http://localhost/prefix/games/u_id/game-name)

把它放在 htaccess 区域：

```
RewriteEngine On        
RewriteBase /prefix

# stop directory listings
Options -Indexes 

#stops htaccess views
<Files .htaccess>
order allow,deny
deny from all
</Files>        

# redirect game folders     
    RewriteRule ^prefix/games/(.*)$ prefix/protected/files/$1 [L]

# remove .php; use THE_REQUEST to prevent infinite loops
    RewriteCond %{THE_REQUEST} ^GET\ (.*)\.php\ HTTP
    RewriteRule (.*)\.php$ $1 [R=301]     

# remove index
    RewriteRule (.*)/index$ $1/ [R=301]

# remove slash if not directory
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_URI} /$
    RewriteRule (.*)/ $1 [R=301]

# add .php to access file, but don't redirect
    RewriteCond %{REQUEST_FILENAME}.php -f
    RewriteCond %{REQUEST_URI} !/$
    RewriteRule (.*) $1\.php [L]       

ErrorDocument 404 /prefix/error-404.php 
```

结果出来为：[http://localhost/prefix/protected/files/u_id/game-name](http://localhost/prefix/protected/files/u_id/game-name)

现在，如果我将该 htaccess 文件放在我的 wamp localhost 服务器上并转到与我们在该站点上输入请求 url 相同的 url。它返回 404 page not found... 但是如果我从测试站点（上面的那个）访问结果页面，它会加载那里的 index.php 页面。

重定向不适用于我的本地主机网站。有任何想法吗？htaccess 文件肯定正在运行。

编辑：：///

我的 Apache 访问日志正在输出：

```
127.0.0.1 - - [25/Apr/2012:18:44:02 +0100] "GET /prefix/games/u_id/game-name HTTP/1.1" 404 116
127.0.0.1 - - [25/Apr/2012:18:44:02 +0100] "GET /favicon.ico HTTP/1.1" 404 209 
```

**编辑：：///**

解决了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T11:10:36.810

`RewriteBase /prefix`如果您的 htaccess 在根目录中，则不能正确。如果 htaccess 在前缀目录中，您的重写器不应以前缀开头。htaccess 在哪里？

# php - PHP & MySql：如何从 MySql 表中填充 PHP 下拉列表？

> ID：10307944
> 
> 赞同：-3
> 
> 时间：2012-04-25T00:44:47.627
> 
> 标签：php, mysql

似乎我在从 MySql 表中填充下拉列表时遇到了麻烦。

与数据库的连接有效，我可以将数据写入表。我还可以在屏幕上的每个字段中显示数据。

我希望能够从此表中的列填充下拉列表。我已经搜索了这个论坛，但无法整合提出的一些想法。

我希望有人可能有这方面的知识。

在此先感谢，肯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T00:52:30.443

不要写入表格，而是使用`<select> <option..>`组合来获得下拉菜单。

```
echo "<select name='something'>";
while( $row = mysql_fetch_array( $query_result ) ) {
  echo "<option value='$row[val]'>$row[data]</option>";
}
echo "</select>"; 
```

当然，它可能会根据您的领域而改变。

# c# - 将剪贴板输出到多个文本框

> ID：10307946
> 
> 赞同：0
> 
> 时间：2012-04-25T00:44:49.117
> 
> 标签：c#, textbox, copy-paste

我正在尝试编写一个 WinForms 应用程序以将文本框信息从应用程序传输到网页。我想知道是否有一种方法可以捕获说 4 个文本框的文本，并能够将其粘贴到网页上的 4 个相应的文本框中。

它们将具有相同的排列/对齐方式。原因是我的数据是通过 SQL 数据库管理的，文本框将显示相关信息，我需要更好的方法来传输数据，而不是复制、粘贴、重复。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T01:46:46.137

您可以利用`HttpWebRequest`, 并`string`为每个文本框设置一个：

```
var response = SendNamedStrings("http://example.com", new Dictionary<string,string>{
  { "textBox1", textBox1.Text },
  { "textBox2", textBox2.Text },
  { "textBox3", textBox3.Text },
  { "textBox4", textBox4.Text } 
} ); 
```

哪里`SendNamedStrings`可能是这样的

```
static WebResponse SendNamedStrings(string url, Dictionary<string, string> namedStrings)
{
  string postData = "?" + string.Join("&", namedStrings.Select(pair => string.Format("{0}={1}", pair.Key, pair.Value)));

  WebRequest request = WebRequest.Create(url);
  request.Method = "POST";
  byte[] byteArray = Encoding.UTF8.GetBytes(postData);

  request.ContentType = "application/x-www-form-urlencoded";
  request.ContentLength = byteArray.Length;
  Stream dataStream = request.GetRequestStream();
  dataStream.Write(byteArray, 0, byteArray.Length);
  dataStream.Close();

  return request.GetResponse();
} 
```

请注意，在堆栈溢出之前已经以多种方式提出了这个问题（这里只是几个）：

[使用带有登录页面的 HttpWebRequest 发送数据](https://stackoverflow.com/questions/4875645/sending-data-using-httpwebrequest-with-a-login-page)

[如何在 WebRequest 中添加参数？](https://stackoverflow.com/questions/3279888/how-to-add-parameters-into-a-webrequest)

[使用 C# 发送 POST 数据](https://stackoverflow.com/questions/4718420/sending-post-data-with-c-sharp)

# c++ - GCC 编译器上布尔类型的 C 和 C++ 语言的默认初始值设定项是 64 而不是 0。这是编译器错误吗？

> ID：10307948
> 
> 赞同：0
> 
> 时间：2012-04-25T00:45:20.893
> 
> 标签：c++, c, gcc

我正在研究 D 语言并同时与 C 和 C++ 语言进行比较。它在 dmd 和 gdc 编译器上都可以正常工作，但是当我在 gcc 编译器上测试时，我发现一个看起来像 GCC 编译器的错误的东西，布尔的默认初始化程序键入而不是 0/false 请参见以下代码：

**C++ 代码**

```
#include <iostream>
using namespace std;

int main()
{
    bool b;
    cout << b << endl;
    return 0;
} 
```

**G++ 编译器（gcc 版本 4.4.3（Ubuntu 4.4.3-4ubuntu5.1）：**

```
g++ -Wall -pedantic test.cpp
test.cpp: In function ‘int main()’: test.cpp:7: warning: ‘b’ is used
uninitialized in this function 
./a.out 64 
```

**C 代码（foo.c）：**

```
#include <stdio.h>
#include <stdbool.h>

#define bool _Bool

int main(int argc, char * args[])
{
    bool b;
    printf("%d\n", b);
    return 0;
} 
```

**gcc 编译器**

```
gcc-4.6 -Wall -pedantic a.c
foo.c: In function ‘main’:
foo.c:9:8: warning: ‘b’ is used uninitialized in this function [-Wuninitialized]
./a.out
64 
```

**tcc 编译器**

```
tcc -Wall foo.c
./a.out
0 
```

**铿锵编译器**

```
clang -Wall -pedantic foo.c     
./a.out
0 
```

有人可以解释 gcc 的行为吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-25T00:48:37.267

正如您的警告消息所示，您没有在使用局部变量之前对其进行初始化，因此它们的内容将是未定义的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-25T00:58:17.753

C++ 中基本类型的默认初始化意味着“未初始化”。也就是说，任何值都可以存在。你得到了 64，因为它恰好在那个内存位置。

如果要进行值初始化，则需要使用`bool()`：

```
bool b = bool(); //Now is false. 
```

值初始化实际上意味着将基本类型初始化为零。

C++11 让这变得更简洁：

```
bool b{}; //Now is false. 
```

# html - Webkit 浏览器中的额外空间？（Chrome 和 Safari）

> ID：10307951
> 
> 赞同：1
> 
> 时间：2012-04-25T00:45:45.713
> 
> 标签：html, css, google-chrome, safari, webkit

在 chrome 和 safari 等 webkit 浏览器中，我的网站页面底部有额外的空间。

该网站是[http://www.xblakej.com/](http://www.xblakej.com/)

我的样式表可以在[http://www.xblakej.com/style.css找到](http://www.xblakej.com/style.css)

谁能告诉我如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T00:54:17.030

您的 iFrame 导致了问题，当我使用 Chrome Inspector 将其删除时，空间消失了。

将您的 iFrame 设置`display:none;`为`visibility:hidden;`

# python - 分块下载文件——是否有最佳大小的块？

> ID：10307953
> 
> 赞同：0
> 
> 时间：2012-04-25T00:45:50.787
> 
> 标签：python, download

我需要下载一个可能非常大（300MB）的文件，该文件稍后将保存在本地。我不想一次性读取远程文件以防止过多的内存使用并打算以小块读取远程文件。

这些块是否有最佳大小？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T00:56:11.017

这取决于您希望使用哪种类型的连接。我想，`64 Kb`可能就够了。

# c++ - 将 void 指针转换为结构时无法获取值

> ID：10307954
> 
> 赞同：0
> 
> 时间：2012-04-25T00:46:02.790
> 
> 标签：c++, struct, operating-system, void-pointers

我传入了一个从结构转换为函数 topTwo 的 void 指针。当我将其转换回来并尝试从结构中获取数据时，我得到了地址。我究竟做错了什么？在这个函数中，我试图`localStruct->number`返回 1，而不是返回地址。

```
 void  *topTwo(void *p)
 {
  struct Variables * localStruct;
  localStruct= (struct Variables *) p;
  cout<<localStruct->number<<endl;
  int  z = long(localStruct->number);
  cout<<z<<endl;
} 
```

这是结构

```
struct Variables{
 int largestNum;
 int secondLargestNum;
 int number;
}; 
```

这是传入数据的主要函数。

```
int main() 
{
    Variables *vars;
    vars= new struct Variables();
    vars->largestNum=0;
    vars->secondLargestNum=0;
    vars->number=0;
    pthread_t  tid[5];
    for(int  i=0; i<5; i++)
    {                                   
       vars->number=i;
       cout<<vars->number<<endl;                                               
       void * sVoid;
       sVoid = (void *) &vars;
       pthread_create(&tid[i], NULL, topTwo,(void *) sVoid);
       pthread_join(tid[i], NULL);
    }
 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T00:59:05.743

改变：

```
sVoid = (void *) &vars;  // this is a `struct Variables**` 
```

到：

```
sVoid = (void *) vars; 
```

# sql - 如何在 SQL 中计算总和

> ID：10307965
> 
> 赞同：1
> 
> 时间：2012-04-25T00:47:22.790
> 
> 标签：sql, sql-server, tsql

> **可能重复：**
> [在 SqlServer 中计算运行总计](https://stackoverflow.com/questions/860966/calculate-a-running-total-in-sqlserver)

我正在创建一个事务表。我决定不在任何地方存储每个用户的余额。我打算做的是，每个月我都会“带来余额”并从购买的余额减去借方加贷方的余额中计算余额。

我的桌子看起来像这样

```
ID int primary key
userID int foriegn key
TransactionDate datetime
description varchar(200)
amount money
balanceBoughtForward bit 
```

我正计划编写一个函数来获取最新记录，即 balanceeboughtforward，然后使用该 id 来计算带有额外列“BALANCE”的视图中的余额和运行总计

但我不知道如何创建一个运行总计列？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T01:02:54.583

也许我不明白，或者你的问题不够清楚。这不是用聚合函数解决的吗（更准确地说是 SUM 函数）。

前任：

```
select user_id, (sum(credit) - sum(debit)) balance
from table
where
some condition
group by
user_id 
```

# meteor - 流星如何仅为添加到集合中的项目调用客户端 js 函数

> ID：10307975
> 
> 赞同：7
> 
> 时间：2012-04-25T00:48:41.283
> 
> 标签：meteor

使用 Meteor，我希望添加到列表中的新项目淡入。但是，我不希望列表中的每个元素在添加某些内容时慢慢淡入，只有添加的新元素。

我有以下由服务器发布并在客户端订阅的集合

```
List = new Meteor.Collection("List");

Meteor.autosubscribe(function () {
  Meteor.subscribe('list'); 
}); 
```

我有以下模板：

```
<template name="list">
  {{#each list}}
    {{> list_item }}
  {{/each}}
</template>

<template name"list_item">
  {{ text }}
</template> 
```

当一个新元素插入到集合中时，我想调用以下命令：

```
function (item) {
  var sel = '#' + item._id;
  Meteor.defer(function () {
    $(sel).fadeIn();
  });
} 
```

我试过使用

```
List.find().observe({
  added: function (list_item) {
    var sel = '#' + list_item._id;
    Meteor.defer(function() {
      $(sel).fadeIn();
    });
  }
}); 
```

**但是，当添加新的 list_item 时，会为列表中的每个**项目调用该函数，而不仅仅是单个新项目。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T06:34:59.120

我不确定您是否应该直接调用 Meteor.defer，我在文档中找不到它。此外， setTimeout 和 setInterval 的流星版本似乎无法正常工作，而 defer 只是一个包装器`Meteor.setTimeout(fn(), 0)`无论如何我得到了我认为你想要工作的东西：

html:

```
<body>
  {{> list_items}}
</body>

<template name="list_items">
  <ul>
    {{#each list_items}}
      <li id="list-item-{{_id}}" style="display:none;">
        {{text}}
      </li>
    {{/each}}
  </ul>
</template> 
```

js：

```
List = new Meteor.Collection("List")

if (Meteor.is_client) {
  Meteor.subscribe("List")

  Meteor.autosubscribe(function(){
    List.find().observe({
      added: function(item){
        setTimeout("$('#list-item-"+item._id+"').fadeIn('slow')",10)
      }
    });
  });

  Template.list_items.list_items = function(){
    return List.find()
  }
} 
```

# c# - 将对象或结构传递给 .asmx Web 服务

> ID：10307977
> 
> 赞同：1
> 
> 时间：2012-04-25T00:48:42.140
> 
> 标签：c#, asp.net, asmx

您知道将对象或结构从 winform 应用程序传递到 .asmx Web 服务的好方法吗？看起来这在 .NET 中应该很容易，但我没有看到。

Rick Strahl 在 2004 年有同样的问题，但看起来我正在寻找的东西可能不存在：

[http://www.west-wind.com/weblog/posts/2004/Apr/18/Net-Web-Services-and-passing-objects-and-Data](http://www.west-wind.com/weblog/posts/2004/Apr/18/Net-Web-Services-and-passing-objects-and-Data)

基本上，我只有一个包含 10 个字符串或 int 成员的简单结构。我想将它发送到 asmx Web 服务并保持强类型不变。就是这样。

我已经尝试在客户端和服务上定义结构。然后我创建了一个包含结构定义的 DLL，并将其包含在我的 Web 服务和客户端中。仍然有问题 b/c 命名空间不同。

我在下面的帖子中看到，似乎人们正在做我所描述的事情。我只是不知道如何：

[通过 Web 服务传递对象](https://stackoverflow.com/questions/6244429/passing-objects-via-web-service)

如果这样做更容易，我可以将服务转换为 WCF —— 无论如何，可能会在几个月内转换它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T16:21:11.760

我不知道为什么我没有早点想到它，但杰里米的回应有所帮助。我没有在客户端和服务上创建对象的定义，而是公开了 Web 服务上的结构定义。当我创建一个结构时，我只是确保它的类型是 global::Webservice.com.mydomain.MyStruct。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T01:30:02.607

你试过什么？你遇到什么错误？你的代码看起来如何？

但是，您可能需要将您想要将实例传递给 Web 服务的类标记为`[Serializable]`( [MSDN](http://msdn.microsoft.com/en-en/library/system.serializableattribute%28v=vs.110%29.aspx) )，如下所示：

```
[Serializable] 
public class MyObject
{ 
    // Your properties here
    // Your parameterless constructor
} 
```

请注意，除了默认（无参数）构造函数和属性之外的所有内容都将在序列化过程中被删除。这是因为在将对象传递给 Web 服务时，您实际上不是在传递 .NET 对象，而是传递（序列化的）数据。相应的类型应该可以通过服务合同获得。

# javascript - 根据浏览器窗口大小旋转 div

> ID：10307980
> 
> 赞同：0
> 
> 时间：2012-04-25T00:49:16.673
> 
> 标签：javascript, jquery, css, webkit

我是否可以使用我在下面制作的方法创建玻璃效果并将其应用于宽度和高度为 100% 的包含 div？这意味着无论您如何调整窗口大小，玻璃 div 的角总是随着窗口移动。

```
<!DOCTYPE html>
<html lang="en">
<head>

<title>Untitled</title>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<style type="text/css" media="screen">

body {
    margin: 0;
    padding: 0;
    background: #eee;
}

#container {
    width: 500px;
    height: 500px;
    position: absolute;
    top: 200px;
    margin-left: -250px;
    left: 50%;
    background: #333;
}

#container .glass {
    position: absolute;
    width: 710px;
    height: 710px;
    top: -355px;
    left: -355px;
    background: #fff;
    opacity: 0.1;
    -webkit-transform:rotate(45deg);
}

</style>

</head>
<body>  
<div id="container">
    <div class="glass"></div>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T17:04:14.663

[我认为这个小提琴可以满足](http://jsfiddle.net/8S8ga/43/)您的需求。我在计时器上设置了调整大小事件，因此它不会在调整大小时立即自动跟随。如果它很重要，您可以更改它，但它有助于不使用尽可能多的处理能力来仅每隔一段时间检查一次调整大小。

这是代码（上面的HTML）：

**CSS**

```
html {
    height: 100%;
}

body {
    margin: 0;
    padding: 0;
    background: #eee;
    height: 100%;
}

#container {
    width: 100%;
    height: 100%;
    position: absolute;
    background: #333;
    overflow: hidden;
}

#container .glass {
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    background: #fff;
    opacity: 0.1;
    -webkit-transform-origin: 0 100% ;
    -moz-transform-origin: 0 100%;
    -ms-transform-origin: 0 100%;
    -o-transform-origin: 0 100%;
    transform-origin: 0 100%;
} 
```

**Java脚本（JQuery）**

```
function glassIt() {

    var g = $(".glass");
    var c = g.parent();
    var w = c.width();
    var h = c.height();
    var ext = ["-webkit-", "-moz-", "-o-", "-ms-"];
    var angle = "rotate("+(-1 * ((Math.atan(h/w))/(2*Math.PI))*360)+"deg)";

    g.width(Math.sqrt(Math.pow(w,2)+Math.pow(h,2)));

    for(i = 0; i <= ext.length; i++) {
        if(i < ext.length) {
            g.css(ext[i]+"transform", angle);
        }
        else {
            g.css("transform", angle);
        }
    }
}

var resizeTimer;
$(window).resize(function() {
    clearTimeout(resizeTimer);
    resizeTimer = setTimeout(glassIt, 100);
});

$(document).ready(function() {
  glassIt();
}); 
```

# regex - 缩短 HH:MM:SS 的正则表达式

> ID：10307984
> 
> 赞同：0
> 
> 时间：2012-04-25T00:50:02.437
> 
> 标签：regex

有没有办法缩短以下时间以找到 HH:MM:SS 格式的时间？

```
'^[0-6][0-9]:[0-6][0-9]:[0-6][0-9]$' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T00:58:50.197

如果有的话，它应该更长，因为`69:69:69`作为时间没有意义。

```
([01]\d|2[0-3]):([0-5]\d|60):([0-5]\d|60)
allow 00-23     00-59 and 60 00-59 and 60
                ~~~~~~~~~~~~~~~~~~~~~~~~~
                60 is useful for supporting leap seconds 
```

如果你真的想要你的例子，但更短，你可以这样做：

```
[0-6]\d(:[0-6]\d){2}
     ~~          ~~~
      |          exactly two repetitions of preceding () block
      Matches digits in many regex implementations 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T01:06:12.050

假设您不需要对值进行验证，而只需找到看起来像时间的东西，那么：

```
\d{1,2}:\d{2}:\d{2} 
```

*如果您正在搜索文本以查找您不想锚定的值`^`，`$`除非您的正则表达式风格在行首和行尾匹配，并且您的源数据在它们自己的行中有这些。*

# windows-phone-7 - Windows Phone - 同一网络中的 PC 通信

> ID：10307986
> 
> 赞同：1
> 
> 时间：2012-04-25T00:50:11.963
> 
> 标签：windows-phone-7, networking, wifi, wcf-data-services, nat

我正在尝试将 Windows Phone 与同一无线网络后面的 PC 通信，我想知道是否可以在没有可能的 NAT 阻塞的情况下做到这一点？

PC（Win7）端的应用程序：在[http://localhost:8080](http://localhost:8080)上托管 WCF 服务- （假设内部 IP 是 192.168.2.2）

WP端应用：访问托管在[http://192.168.2.2:8080上的WCF服务](http://192.168.2.2:8080)

当我个人网络中的 Windows 防火墙上允许端口 8080 时，我能够与这两者进行通信。但是当我在公司网络上尝试过时，WP 无法访问 WCF 服务。

好吧，我认为原因是路由器防火墙又名 NAT。我不确定 NAT 是否阻止了从内部网络对等方到其他内部网络对等方的某些数据包？

（如果不是这种情况，还有什么可能？）

任何帮助将不胜感激感谢您的关注

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T22:16:47.967

有 NAT 并且有您正在使用的确切 IP 地址 - 两者都可能导致问题。请与配置防火墙的人员核实。我猜该端口被阻止了，或者您在您的公司网上使用了不同的 IP 分配方案。

# google-drive-api - 是否支持为 Google Drive 创建新的文件查看器？

> ID：10307993
> 
> 赞同：2
> 
> 时间：2012-04-25T00:51:07.463
> 
> 标签：google-drive-api

google drive viewer 看起来不错，但它缺少一些我们可能有兴趣添加的功能。有没有办法为谷歌驱动器编写我们自己的文件管理器 - 使用网络浏览器和/或安卓等作为客户端？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T10:29:05.690

[您可以使用Document list API](https://developers.google.com/google-apps/documents-list/)重新编写文件查看器，但您将失去一些功能，例如：

*   基于 Google.com cookie 的身份验证：您必须实施 OAuth 2 流程 + cookie
*   用户安装的云端硬盘应用程序：[用户可以安装云端硬盘应用程序](https://developers.google.com/drive/apps_overview)，并可以直接从云端硬盘使用这些应用程序打开文件。您的应用无法知道用户安装了哪些云端硬盘应用以及允许他们打开哪些文件类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T13:10:02.197

您现在可以查询用户安装了哪些应用程序。

引用[https://developers.google.com/drive/v2/reference/apps](https://developers.google.com/drive/v2/reference/apps)：“应用程序资源提供用户已安装的应用程序列表，以及有关每个应用程序支持的 MIME 类型、文件扩展名和其他详细信息的信息。有关此资源的方法列表，请参阅本页末尾。

# algorithm - 如何为此编写递归函数？

> ID：10307995
> 
> 赞同：0
> 
> 时间：2012-04-25T00:51:30.690
> 
> 标签：algorithm

给定一个只针对二叉树（不一定是 BST）的中序遍历，给出一个伪代码来为这个遍历序列生成所有可能的二叉树。我有一个想法，让每个字符为根，并递归打印左右子树。我希望输出模式是这样的： [left subtree]root{right subtree} 但我无法在 Java 或 C++ 中实现它。有人可以帮我吗？

# python - Python - 如何在 ValidationError 中打印消息

> ID：10307996
> 
> 赞同：5
> 
> 时间：2012-04-25T00:51:57.523
> 
> 标签：python, exception, printing, except

我想知道如何打印引发异常时写入的字符串。

例如，如果我使用

```
raise ValidationError("RANDOM TEXT HERE"); 
```

我怎样才能从 except 部分中检索“RANDOM TEXT HERE”。

```
try:
  ...
except ValidationError:
  ...
  // something like Java's ex.getMessage();
  ..... 
```

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-25T00:55:05.230

如果将异常绑定到变量，则可以使用`str(exception_variable)`.

即：

```
try:
  ...
except ValidationError as e:
  print str(e) 
```

**编辑：更改`msg`为`message`**

**第二次编辑：意识到将消息存储在`msg`vs中的异常不一致`message`。`str(exception)`似乎是最一致的。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-12-27T07:37:37.753

我知道这是个老问题，但我也遇到了同样的问题，我为将来需要的任何人编写了我的解决方案。

当我使用**`e`**变量时，它给了我一个`list`，所以我使用**`e.message`**

```
try:
  ...
except ValidationError as e:
  print e.message
```

# facebook-graph-api - Facebook Graph：是否可以使用 publish_stream 和 read_stream 权限向新闻提要帖子发布评论？

> ID：10307997
> 
> 赞同：0
> 
> 时间：2012-04-25T00:52:06.663
> 
> 标签：facebook-graph-api, comments

我正在尝试使用 Facebook Graph API 来更新代表用户发布的新闻提要帖子以及同一用户发表的评论。用户已授予我 publish_actions、publish_stream 和 read_stream 权限以及扩展权限。

我可以通过仅在 api explorer 中传递 message 和 access_token 来做到这一点。当我在我的服务器上尝试时，我收到以下错误：

```
{ error: 
   { message: '(#100) Invalid fbid.',
     type: 'OAuthException',
     code: 100 } } 
```

这个老问题表明需要offline_access 才能完成这项工作。

[http://facebook.stackoverflow.com/questions/4877847/publishing-comments-on-my-facebook-app-profil](http://facebook.stackoverflow.com/questions/4877847/publishing-comments-on-my-facebook-app-profil)

现在offline_access 已被弃用，并且不是新应用程序的选项，是否可以按照文档的建议在用户的新闻提要上发布评论？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T09:43:15.983

“publish_stream”、“read_stream” 权限足以评论用户的提要。我一直以这种方式使用它并且它有效。请注意，graph api explorer 默认分配所有权限，您需要能够使用您的 facebook appid 进行测试

顺便提一句。如果您使用基于 Web 的应用程序，社交插件会更简单、更清洁 [https://developers.facebook.com/docs/reference/plugins/comments/](https://developers.facebook.com/docs/reference/plugins/comments/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-29T22:35:51.487

此外，请确保您已查看 API 的最新文档。（在撰写本文时，它位于[https://developers.facebook.com/docs/facebook-login/permissions/v2.0](https://developers.facebook.com/docs/facebook-login/permissions/v2.0)）。

看起来 publish_stream 已被弃用。在我的项目中，我不得不将其更改为 manage_notifications。但这取决于您要做什么，因此请仔细检查文档。