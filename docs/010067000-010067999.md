# StackOverflow 问答 10067000-10067999

# c++ - 重载 << 操作符来存储数据

> ID：10067000
> 
> 赞同：0
> 
> 时间：2012-04-08T22:14:07.000
> 
> 标签：c++, operator-overloading

首先，我一直在四处寻找我的特定问题，但我还没有找到任何答案。所以，我想做的是重载`<<`运算符，以便我可以这样做：

```
myObj = new MyObj();
unsigned int v = 2; 
myObj << v; 
```

请记住，使用此类：

```
class MyObj{
private:
  char *data;
  int count;

public:
  MyObj(){ data = new char[64]; count = 0; }
  //This "is" the overloaded << method
  template <typename T>
  T& operator<<(T val){
    *(T*)(data + count) = val;
    count += sizeof(T);
  }
} 
```

效果应该和这个一样（假设*data*是公共属性）：

```
myObj << v; 
```

应该是一样的

```
*(unsigned int*)(myObj.data + myObj.count) = v;
myObj.count += sizeof(v); 
```

关于如何做的任何想法？我只找到了重载 I/O 或位运算符的方法，但是像这样。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T22:47:45.473

如果我理解正确，你有

```
MyObj *myObj;
......
myObj = new MyObj();
unsigned int v = 2; 
myObj << v; 
```

为了能够这样使用`<<`，你通常有：

```
MyObj myObj;
......
unsigned int v = 2; 
myObj << v; 
```

或者你可以使用：

```
myObj = new MyObj();
unsigned int v = 2;
(*myObj) << v; 
```

如果您希望能够编写类似的代码`myObj << u << v`，您还需要：

```
....
    template <typename T>
    MyObj& operator<<(T val){
        *(T*)(data + count) = val;
        count += sizeof(T);
        return *this;
    }
.... 
```

# ruby - 如何在 ruby 中迭代这个哈希

> ID：10067001
> 
> 赞同：0
> 
> 时间：2012-04-08T22:14:15.567
> 
> 标签：ruby, arrays, csv, hash

我有一个带有特定数组的哈希：

```
@infodata = {}
@infodata[:titles] = Array.new([]) 
```

我想将它存储在 CSV 文件中，如下所示：

```
CSV.open("infodata.csv", "wb") do |csv|
 @infodata.values
end 
```

我得到的输出是这样的：

```
avancerad,Ingen examen,uh,ArkivvetenskapArchival science,HIA80D,10.300,uoh,"Arkivvetenskap rör villkoren för befintliga arkiv och modern arkivbildning med fokus på arkivarieyrkets arbetsuppgifter: bevara, tillgängliggöra och styra information. Under ett år behandlas bl a informations- och dokumenthantering, arkivredovisning, gallring, lagstiftning och arkivteori. I kursen ingår praktik, där man under handledning får arbeta med olika arkivarieuppgifter.",statlig,60 
```

我想要的输出是这样的：

```
avancerad,Ingen examen,uh,Arkivvetenskap, Archival science,HIA80D,10.300,uoh,"Arkivvetenskap rör villkoren för befintliga arkiv och modern arkivbildning med fokus på arkivarieyrkets arbetsuppgifter: bevara, tillgängliggöra och styra information. Under ett år behandlas bl a informations- och dokumenthantering, arkivredovisning, gallring, lagstiftning och arkivteori. I kursen ingår praktik, där man under handledning får arbeta med olika arkivarieuppgifter.",statlig,60 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-08T22:23:09.337

我不确定你想在这里做什么，但有可能

```
CSV.open("infodata.csv", "wb") do |csv|
  @infodata.values.flatten
end 
```

可以做到这一点。

# c# - 正方体 3 (OCR) - .NET 包装器

> ID：10067002
> 
> 赞同：21
> 
> 时间：2012-04-08T22:15:09.283
> 
> 标签：c#, visual-studio-2010, wrapper, tesseract

[http://code.google.com/p/tesseractdotnet/](http://code.google.com/p/tesseractdotnet/)

我在让 Tesseract 在我的 Visual Studio 2010 项目中工作时遇到问题。我试过控制台和winforms，结果都一样。我遇到了一个声称可以使用它的其他人的 dll `VS2010`：

[http://code.google.com/p/tesseractdotnet/issues/detail?id=1](http://code.google.com/p/tesseractdotnet/issues/detail?id=1)

我正在添加对 dll 的引用，该引用可以在上面网站的 64 号帖子的附件中找到。每次我构建我的项目时，我都会得到一个`AccessViolationException`说法，即试图读取或写入受保护的内存。

```
public void StartOCR()
{
    const string language = "eng";
    const string TessractData = @"C:\Users\Joe\Desktop\tessdata\";

    using (TesseractProcessor processor = new TesseractProcessor())
    {
        using (Bitmap bmp = Bitmap.FromFile(fileName) as Bitmap)
        {
            if (processor.Init(TessractData, language, (int)eOcrEngineMode.OEM_DEFAULT))
            {
                string text = processor.Recognize(bmp);
            }
        }
    }
} 
```

访问冲突异常总是指向`if (processor.Init(TessractData, language, (int)eOcrEngineMode.OEM_DEFAULT))`。我已经看到了一些建议，以确保解决方案平台`x86`在配置管理器中设置为，并且 tessdata 文件夹位置以斜杠结尾，但无济于事。有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-31T15:06:07.557

似乎是导致问题的 tessdata 文件夹的内容。从第一个链接获得 tessdata 文件夹，现在一切正常。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-15T17:57:03.810

我刚刚用 tesseract 引擎 3 完成了一个项目。我认为，引擎中有一个错误，需要纠正。我删除“AccessViolationError”的方法是将“\tessdata”添加到真正的 tessdata 目录字符串中。我不知道为什么，但引擎似乎正在截断 Tessdata 路径中最里面的目录。

刚刚制作了适用于 .net 框架 4 的完整 OCR 包 (Dlls+Tessdata(english))。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-31T15:05:51.550

如果有人有同样的问题，并且斜杠的建议不起作用，请尝试......两个结尾的斜杠！认真的。这个对我有用。

```
if (processor.Init(@".\tessdata\\", "eng", (int)eOcrEngineMode.OEM_DEFAULT)) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-12T20:36:40.083

[似乎您的问题与此处](https://github.com/charlesw/tesseract/issues/231)提到的稳定性问题有关。官方[网站](https://github.com/charlesw/tesseract)上建议使用以前的稳定版本 2.4.1。您可以通过包管理器命令从 nuget.org 安装它：`Install-Package Tesseract -Version 2.4.1`

# nhibernate - NHibernate 未保存一对多列表

> ID：10067008
> 
> 赞同：1
> 
> 时间：2012-04-08T22:15:58.760
> 
> 标签：nhibernate

我对 NHibernate 很陌生，在保存子对象列表时遇到了问题。

**笔记**

```
<class name="Note" table="NOTE">        
     <id name="NoteID" column="NOTE_ID">
          <generator class="identity" />
     </id>          
     ...    
     <list name="Sections" table="NOTE_SECTIONS" cascade="all" lazy="false">
          <key column="NOTE_ID"/>               
          <index column="SORT_ORDER"/>
          <one-to-many class="Section"/>
     </list>
</class> 
```

**注意部分**

```
<class name="Section" table="NOTE_SECTIONS"> 
     <id name="SectionID" column="Section_ID">
          <generator class="identity" />
     </id>      
     <property name="NoteID" column="NOTE_ID"/>
     ...
</class> 
```

映射非常适合读取数据。但是，当我对 进行更改时`Note Section`，它生成的查询似乎正在执行正确的步骤，但随后出现以下错误：

> NHibernate.Exceptions.GenericADOException：无法删除集合：[Domain.Note.Sections#1][SQL：更新 NOTE_SECTIONS SET NOTE_ID = null，SORT_ORDER = null WHERE NOTE_ID = @p0] ---> System.Data.SqlClient.SqlException ：无法将值 NULL 插入到列“NOTE_ID”、表“NOTE_SECTIONS”中；列不允许空值。更新失败。

我*已经*读过，为了像这样保存，它需要是双向的。但我也读过双向映射不适用于列表。保持我的收藏品有序很重要——最好的保存方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T11:45:30.913

`inverse="true"`如果您希望以这种方式保存子对象，则应在集合映射中使用。

```
 <list name="Sections" table="NOTE_SECTIONS" inverse="true" cascade="all" lazy="false">
      <key column="NOTE_ID"/>               
      <index column="SORT_ORDER"/>
      <one-to-many class="Section"/>
 </list> 
```

[NHibernate 中的逆属性](https://stackoverflow.com/questions/713637/inverse-attribute-in-nhibernate)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T02:57:26.403

可能您需要将 Note Section 中的 Note 称为多对一关系。

# python - 是否可以不从 python 中的函数返回任何内容？

> ID：10067013
> 
> 赞同：31
> 
> 时间：2012-04-08T22:17:27.160
> 
> 标签：python, function

使用一个简单的过滤器来测试 0-100 范围内的输入。

```
def foo(foo_input):
    if 0 <= foo_input <= 100:
        return f_input 
```

如果 ，这将返回无`foo_input is > 100`。但它真的可以“不”返回任何东西吗？还是一个函数总是必须返回一些东西？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-04-08T22:18:52.333

函数总是返回一些东西（至少`None`，当在执行过程中没有到达返回语句并且到达函数的末尾时）。

另一种情况是当它们被异常中断时。在这种情况下，异常处理将“支配堆栈”，您将返回适当的`except`或得到一些讨厌的错误:)

关于你的问题，我必须说有两种可能性：要么你有东西要退货，要么你没有。

*   如果你有东西要退货，那就这样做，如果没有，那就不要。
*   如果您依赖于返回的具有某种类型的东西，但您不能返回任何有意义的这种类型，那么`None`将告诉调用者这是这种情况（没有更好的方法来告诉调用者“没有”返回，然后`None`，所以检查一下，你会没事的）

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-04-08T22:19:07.003

否。如果`return`在函数结束之前未到达语句，`None`则返回隐式。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-04-08T22:21:25.770

如果未到达 return 语句，则函数返回`None`。

```
def set_x():
    x = 2 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-04-08T22:33:49.727

我不确定你真正想要做什么。以下是您可能喜欢的几件事：

```
def foo(foo_input, foo_default):
    if 0 <= foo_input <= 100:
        return f_input
    else:
        return foo_default

def foo(foo_input):
    if 0 <= foo_input <= 100:
        return f_input
    raise ValueError, "foo_input was not in range [0, 100]" 
```

等等，你说的是“过滤器”。您是否过滤了一系列值并且只想提取符合条件的值？这在 Python 中很容易：

```
def foo_check(x):
    return 0 <= x <= 100

filtered_list = [x for x in unfiltered_sequence if foo_check(x)] 
```

你说的是“链接功能”。如果我们谈论过滤序列，这很容易：

```
def foo_filter(seq):
    for x in seq:
        if 0 <= x <= 100:
            yield x

def other_filter(seq):
    for x in seq:
        if meets_criterion(x):
            yield x

def do_the_task(seq):
    for x in other_filter(foo_filter(seq)):
        do_something(x) 
```

编辑：这是对 Python 中的迭代器和生成器的一个很好的介绍。 [http://www.learningpython.com/2009/02/23/iterators-iterables-and-generators-oh-my/](http://www.learningpython.com/2009/02/23/iterators-iterables-and-generators-oh-my/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-04-10T22:33:29.430

我有点喜欢隐式`return None`但[pylint](https://www.pylint.org/)将其标记为不良风格，警告：

> 函数中的所有 return 语句都应该返回一个表达式，或者它们都不应该返回。pylint(inconsistent-return-statements)

因此，

```
def foo(foo_input):
    if 0 <= foo_input <= 100:
        return f_input
    return None 
```

可能是更好的风格，即使它们在功能上是相同的。

* * *

更多信息可[在此处](http://pylint.pycqa.org/en/latest/whatsnew/1.8.html)获得，其中 Pylint 更改日志指出：

> 添加了一个新的 Python 检查器来警告不一致的返回语句。如果函数或方法同时返回显式值和隐式值，则它的返回语句不一致...
> 
> 根据[PEP8](https://www.python.org/dev/peps/pep-0008/)，如果任何 return 语句返回一个表达式，则任何没有返回值的 return 语句都应该明确地将其声明为 return None，并且应该在函数的末尾出现一个明确的 return 语句（如果可以访问）。

# iphone - 对象和 NSPredicate

> ID：10067014
> 
> 赞同：2
> 
> 时间：2012-04-08T22:17:32.493
> 
> 标签：iphone, objective-c, ios, nspredicate

在我的应用程序中，我有一个包含大约 12000 个条目的大表。我在tableview上显示它。但是在进行动态搜索时搜索栏太慢了。我已经读过 NSPredicate 方法比 NSRange 更持久。

这是我的旧代码：

```
[self.filteredListContent removeAllObjects];
listContent = [[NSArray alloc] initWithArray:[dbAccess getAllBooks]];

for (Book *book in listContent)
{

    NSRange range = [book.textBook rangeOfString:searchText options:NSCaseInsensitiveSearch];

    if (range.location != NSNotFound) 
    {
        [self.filteredListContent addObject:book];
    }
 } 
```

我的新代码：

```
 [self.filteredListContent removeAllObjects];
 listContent = [[NSArray alloc] initWithArray:[dbAccess getAllBooks]];

 NSPredicate *predicate = [NSPredicate predicateWithFormat:@"SELF like[c] %@",searchText];

 [self.filteredListContent addObject:[listContent filteredArrayUsingPredicate:predicate]]; 
```

当我尝试执行此代码时，我收到此错误：“无法对对象进行正则表达式匹配。”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T01:46:34.740

我会做一些更像...

```
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"%k like[c] %@",propertyIAmLookingFor,searchText]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T00:28:17.630

你的书课是字符串吗？如果没有，那么你不能像 SELF 一样使用。您需要替换要比较的属性的名称。

# java - 使用 mockresourcerequest 进行单元测试

> ID：10067016
> 
> 赞同：1
> 
> 时间：2012-04-08T22:18:11.387
> 
> 标签：java, unit-testing, spring-mvc, jsr286

我有一个服务于 ajax 调用的 serveresource 方法。我正在尝试使用 MockResourceRequest 和 MockResourceResponse 为这个 serverresource 方法编写一个单元测试。如果有人对此有一个例子，我真的需要一些帮助。提前致谢..

请参阅下面的控制器来处理 ajax 调用，这是 JSR 286 中的一种服务资源方法

**[编辑]**

```
@Controller
@RequestMapping("VIEW")
public class Controller {

@ResourceMapping(value = "") 
public String addMethod(ResourceRequest request, ResourceResponse response){
      /* My logic to send the request attributes to Web Service and then push
      the results to the JSP page*/
   }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-01T08:33:33.647

```
@Autowired
Controller controller;

@Test
public void addMethod(){
    MockResourceResponse response = new MockResourceResponse();
    MockResourceRequest request = new MockResourceRequest();
    controller.addMethod(requesr,response);
    assertThat(response.getContentAsString(), equalTo("my xml content"));
} 
```

或更复杂的[单元测试 SPRINGMVC PORTLETS](http://blogs.isostech.com/portlet-development/unit-testing-spring-mvc-portlets/)

# lucene - 在 Lucene 中，在不影响性能的情况下返回近似结果计数的公认方法是什么？

> ID：10067017
> 
> 赞同：2
> 
> 时间：2012-04-08T22:18:11.960
> 
> 标签：lucene

我希望我的用户的搜索结果包含一些关于给定搜索查询有多少匹配项的想法。

但是，在对用户的搜索日志进行一些研究和观察后，我注意到记录的查询速度与总结果数之间存在直接相关性，并确定这是因为我正在访问该`totalHits`属性，这显然必须遍历整个结果集以返回一个值。

我很乐意简单地返回一个近似值，甚至可能只是一个数量级，表明有多少结果可用的粗略概念，但我看不出是否有任何好的方法来计算它而不显着影响性能。我真的不想只是在用户面前转储一个看似无底的结果集，而不向他们提供任何关于他们的搜索匹配多少结果的粗略想法。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T20:12:48.680

使用布尔查询，您可以尝试近似：

*   ~~`|A or B| / |D| = ((|A| / |D|) + (|B| / |D|)) / 2`~~
*   `|A and B| / |D| = (|A| / |D|) * (|B| / |D|)`

其中`A`和`B`是两个术语，和`|D|`是文件的总数。这基本上是对独立性的假设。

您可以使用该`rewrite`方法将任何查询重写为布尔查询。

确实没有更好的方法可以做到这一点，但我发现这种假设在实践中并不算太糟糕。如果您的文档数量很少，它可能会给出错误的答案。

编辑：正如 jpountz 指出的那样，我对 OR 的计算是错误的。应该：

```
P(A U B) = 1 - P(~(AUB)) 
         = 1 - P((~A) & (~B))
         = 1 - P(~A)P(~B)
         = 1 - (1 - P(A))(1 - P(B))
         = 1 - (1 - P(A) - P(B) + P(A)P(B))
         = P(A) + P(B) - P(A)P(B) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-10T07:47:38.460

最新版本的 Lucene 有一个专门用于计算计数的收集器，称为[TotalHitCountCollector](http://lucene.apache.org/core/old_versioned_docs/versions/3_5_0/api/all/org/apache/lucene/search/TotalHitCountCollector.html)。

它通常比其他收集器更快，因为：

*   [它接受乱序的文件](http://lucene.apache.org/core/old_versioned_docs/versions/3_5_0/api/all/org/apache/lucene/search/Collector.html#acceptsDocsOutOfOrder%28%29)，
*   它不需要计算分数，
*   它不会构建顶级匹配的数组。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T19:51:45.007

首先，我们应该知道您要为哪种查询执行此操作。例如，有一种非常快速的方法可以找出有多少文档包含任何具体术语（该术语的*docFreq*）。因此，假设您有三个术语的合取，您可以用三个*docFreqs*中最小的一个来近似。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-10T17:29:51.500

关于`totalHits`：这只是lucene在完成搜索后设置的一个值。访问该属性不会做任何额外的工作，当然也不会迭代所有结果。

Lucene 在进行搜索时总是设置这个（并且知道总共有多少个结果）。它需要这样做才能为您提供请求的前 N ​​个结果（根据您指定的分数或排序字段）。

所以实际上在某些情况下搜索很慢。

你有没有检查过什么样的查询很慢？缓慢和大量结果的组合可能表明存在某种通配符/模糊查询。

可以在[http://wiki.apache.org/lucene-java/ImproveSearchingSpeed找到提高搜索速度的一般信息](http://wiki.apache.org/lucene-java/ImproveSearchingSpeed)

根据您的 lucene-2.9.2 标签，我建议您首先尝试升级到最新版本并再次测量。自 2.9.2 以来有很多变化/改进

# semantic-web - Web 描述资源协议

> ID：10067018
> 
> 赞同：1
> 
> 时间：2012-04-08T22:18:13.170
> 
> 标签：semantic-web, powder

POWDER (http://www.w3.org/TR/powder-dr/) 是否打算用于语义网的信任/证明层？是否有针对相同层制定的其他 w3c 标准？

先感谢您

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T11:18:21.193

好吧，上层几乎还是科幻小说，没有人知道它们是否会完全按照通常的[层蛋糕图](http://en.wikipedia.org/wiki/Semantic_Web_Stack)所建议的方式工作。

有一些标准可以用作支持这些更高层的构建块。POWDER就是其中之一。命名图（在 SPARQL 中标准化，目前正在考虑作为 RDF 1.1 的原生特性）是另一个。[W3C Provenance Ontology](http://www.w3.org/TR/prov-o/)是另一个。

还有很多尚未准备好进行标准化的提案和研究想法。

# android - 从数据库 android 填充单选按钮

> ID：10067019
> 
> 赞同：3
> 
> 时间：2012-04-08T22:18:14.143
> 
> 标签：android, database, radio-button, populate

我正在开发一个驾校考试应用程序，我需要一些帮助。

我有这样的xml文件：

```
<!-- language: lang-xml -->
<?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/widget28"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="#AAC1E2" >

    <LinearLayout
        android:id="@+id/widget29"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical" >

        <ImageView
            android:id="@+id/i1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
             />

        <TextView
            android:id="@+id/e1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Enun"
            android:textAppearance="?android:attr/textAppearanceMedium" />

        <RadioGroup
            android:id="@+id/radioGroup1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content" >

            <RadioButton
                android:id="@+id/radio0"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:checked="true"
                android:text="RadioButton" />

            <RadioButton
                android:id="@+id/radio1"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="RadioButton" />

            <RadioButton
                android:id="@+id/radio2"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="RadioButton" />
        </RadioGroup>

         <ImageView
            android:id="@+id/i2"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
             />

        <TextView
            android:id="@+id/e2"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Enun"
            android:textAppearance="?android:attr/textAppearanceMedium" />

        <RadioGroup
            android:id="@+id/radioGroup2"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content" >

            <RadioButton
                android:id="@+id/radio0"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:checked="true"
                android:text="RadioButton" />

            <RadioButton
                android:id="@+id/radio1"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="RadioButton" />

            <RadioButton
                android:id="@+id/radio2"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="RadioButton" />
        </RadioGroup> 
```

... x 30 次和一个按钮，可以纠正测试并显示您是否通过了。当您未通过 3 个问题或更少时，您通过了测试。

问题以这种方式存储：

Id_question Id_topic Id_test 问题 AnswerA AnswerB AnswerC AnswerOK 图片

*   Id_question Id_topic 和 id_test 是整数字段
*   Question 和 AnswerA-C 是文本字段
*   AnswerOK 是一个整数字段。如果 AnswerA 是 OK = 1, AnswerB = 2, AnswerC = 3
*   图像是相关图像的名称，从资源文件夹中提取。

我使用数据库来填充 xml 中的每个字段。图像和问题以这种方式从数据库中提取：

```
<!-- language: lang-java -->
    Cursor c = adbh.query(bundle.getString("test")); 
    //"test"-->"SELECT question, image FROM table WHERE id_test = 1"

        Integer i = 1;

        if (c.moveToFirst()) {
            do {
                String path = c.getString(index);
                String nimage = "i"+i;
                int idImage = getResources().getIdentifier(nimage, "id", this.getPackageName());
                ImageView image = (ImageView) findViewById(idImage);
                int idDrawable = getResources().getIdentifier(ruta, "drawable", this.getPackageName());
                image.setImageResource(idDrawable);

                String nenun = "e"+i;
                String enun = c.getString(anotherIndex);
                int idEnun = getResources().getIdentifier(nenun, "id", this.getPackageName());
                TextView txtenun = (TextView) findViewById(idEnun);
                txtenun.setText(enun);

                i++;
            } while (c.moveToNext()); 
```

如何填充单选按钮？查询将是“从表 WHERE id_test = 1 中选择 AnswerA、AnswerB、AnswerC”

我的最后一个问题是如何纠正测试。我认为将按下的单选按钮（我不知道如何）存储在数组中，然后与正确答案进行比较。查询将是“SELECT AnswerOK from table WHERE id_test = 1”。

例子：

已回答问题数组：1 1 1 2 2 3 2 3 1 3 2... 正确答案数组：3 2 1 2 2 3 2 3 2 2 2...

```
<!-- language: lang-java -->
    for (int i=0; i<30; i++)
    if (a[i] == b[i])
    numberOfRightAnswers++; 
```

谢谢 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T08:27:07.887

> 如何填充单选按钮？查询将是“从表 WHERE id_test = 1 中选择 AnswerA、AnswerB、AnswerC”

可能希望在第一个查询中直接选择这些值，所以而不是：

```
Cursor c = adbh.query(bundle.getString("test")); 
    //"test"-->"SELECT question, image FROM table WHERE id_test = 1" 
```

将有：

```
Cursor c = adbh.query(bundle.getString("test")); 
    //"test"-->"SELECT question, AnswerA,  AnswerB, AnswerC, image FROM table WHERE id_test = 1" 
```

然后在那个`while`循环中将文本分配给`RadioButton`s 就像你做的那样`TextView txtenun`。

> 我的最后一个问题是如何纠正测试。我认为将按下的单选按钮（我不知道如何）存储在数组中，然后与正确答案进行比较。

将 a 添加`OnCheckedChangeListener()`到您的所有`RadioGroup`s。在该侦听器中，您将获得`RadioGroup`用户检查某些内容的位置和被检查的 id `RadioButton`。使用它来构建正确答案的数组。

**一些建议：**

也许你应该修改你的布局和你当前的方法。让用户滚动您的 30 个问题布局可能不是一个好主意，而且您正在加载许多资源，尽管用户在遇到特定问题之前不会真正看到它们（我不知道您的图像的大小，如果它们很小，这可能不是问题）。您的其他选择是一个`ListView`问题的布局或简单布局，您可以根据用户所在的问题按需填充。我的建议是第二种选择。该选项还将帮助您避免`getIdentifier`方法调用，此方法比该方法慢`findViewById`，应该避免。波纹管是一个布局：

```
<?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="#AAC1E2" >

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical" >

        <ImageView
            android:id="@+id/questionImage"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content" />

        <TextView
            android:id="@+id/questionText"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Enun"
            android:textAppearance="?android:attr/textAppearanceMedium" />

        <RadioGroup
            android:id="@+id/radioGroup1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content" >

            <RadioButton
                android:id="@+id/radio0"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:checked="true"
                android:text="RadioButton" />

            <RadioButton
                android:id="@+id/radio1"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="RadioButton" />

            <RadioButton
                android:id="@+id/radio2"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="RadioButton" />
        </RadioGroup>

        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:weightSum="3" >

            <Button
                android:id="@+id/previousQuestion"
                android:layout_width="wrap_content"
                android:layout_height="fill_parent"
                android:layout_weight="1"
                android:text="previous" />

            <Button
                android:id="@+id/validateTest"
                android:layout_width="wrap_content"
                android:layout_height="fill_parent"
                android:layout_weight="1"
                android:text="validate" />

            <Button
                android:id="@+id/nextQuestion"
                android:layout_width="wrap_content"
                android:layout_height="fill_parent"
                android:layout_weight="1"
                android:text="next" />
        </LinearLayout>
    </LinearLayout>

</ScrollView> 
```

您将对该测试中的所有问题（包括所有数据）进行查询，并从静态字段开始`int counter = 0`。当应用程序启动时，您会将光标移动到计数器值（开始时为 0）：

```
c.moveToPosition(counter); 
```

并使用该行中的值来填充上述问题布局：

```
ImageView questionImage = (ImageView) findViewById(R.id.questionImage);
int idDrawable = getResources().getIdentifier(ruta, "drawable", this.getPackageName());
   questionImage.setImageResource(idDrawable);

String enun = c.getString(anotherIndex);
TextView txtenun = (TextView) findViewById(R.id.questionText);
txtenun.setText(enun);
// will do the same to populate the other parts of the question from the cursor 
```

当用户按下时，`nextQuestion` `Button`您将增加`counter`值（您应该进行一些检查，以免超过 30 个问题），`counter`再次将光标移动到该位置，然后像上面一样填充布局。当用户按下您递减的 previousQuestion 时`counter`，移动光标并再次用数据填充布局。此外，您只需将一个添加`OnCheckedChangeListener`到您的`RadioGroup`. 当该侦听器触发时，您应该存储问题 id（从`counter`您应该能够判断您是哪个问题的值）和`RadioButton`数据结构中选择的（可能是 a `HashMap`），从数据库中检索测试的正确答案并查看如果用户它是一个很好的驱动程序。

您也可以（可能）优化您的数据库。

**编辑：**

```
private ArrayList<Integer> responses = new ArrayList<Integer>(); // this will hold the number of the correct answer. Note that this will work if the user answers question one after the other
// if the user skips question you'll get in trouble, this is one of the reasons why your design is not so good.

String rg = "radioGroup" + i;
int idRg = getResources().getIdentifier(rg, "id", this.getPackageName());
RadioGroup radioGroup = (TextView) findViewById(idRg);
radioGroup.setOnChekedChangeListener(new OnCheckedChangeListener(){
       public void onCheckedChanged (RadioGroup group, int checkedId) {
            if (group.getChildAt(0).getId() == checkedId) {
               responses.add(0); // the first answer was checked
            } else if (group.getChildAt(1).getId() == checkedId) {
               responses.add(1); // the first answer was checked
            } else if (group.getChildAt(2).getId() == checkedId) {
               responses.add(2); // the first answer was checked
            }
      } 
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T16:59:49.407

根据@Luksprog 的回答，这是我最终的工作循环：

```
Cursor c = adbh.query(bundle.getString("test"));

    Integer i = 1;

    if (c.moveToFirst()) {
        do {
            String ruta = c.getString(4);
            String nimage = "i" + i;
            int idImage = getResources().getIdentifier(nimage, "id",
                    this.getPackageName());
            ImageView image = (ImageView) findViewById(idImage);
            int idDrawable = getResources().getIdentifier(ruta, "drawable",
                    this.getPackageName());
            image.setImageResource(idDrawable);

            String rgname = "radioGroup"+i;
            int idRg = getResources().getIdentifier(rgname, "id",
                    this.getPackageName());
            RadioGroup rg = (RadioGroup) findViewById(idRg);
            rg.removeAllViews();
            RadioButton rb1 = new RadioButton(this);
            rb1.setId(i);
            rb1.setText(c.getString(1));
            rg.addView(rb1);
            RadioButton rb2 = new RadioButton(this);
            rb2.setId(i+1);
            rb2.setText(c.getString(2));
            rg.addView(rb2);
            RadioButton rb3 = new RadioButton(this);
            rb3.setId(i+2);
            rb3.setText(c.getString(3));
            rg.addView(rb3);

            String nenun = "e" + i;
            String enun = c.getString(0);
            int idEnun = getResources().getIdentifier(nenun, "id",
                    this.getPackageName());
            TextView txtenun = (TextView) findViewById(idEnun);
            txtenun.setText(enun);

            i++;
        } while (c.moveToNext()); 
```

# postgresql - PostgreSQL 错误：无法从客户端接收数据：尝试对非套接字的操作进行操作

> ID：10067024
> 
> 赞同：1
> 
> 时间：2012-04-08T22:19:11.883
> 
> 标签：postgresql, startup, antivirus

PostgreSQL 版本 9.1.3。操作系统是 Windows XP。防病毒软件是 F-Secure。postgres.exe 的六个实例正在运行。

这是 pg_log 中的内容：

```
2012-04-08 14:58:23 PDT LOG：启动数据包不完整
2012-04-08 14:58:24 PDT LOG：数据库系统已准备好接受连接
2012-04-08 14:58:24 PDT 日志：自动真空启动器已启动
2012-04-08 14:58:25 PDT 日志：无法从客户端接收数据：尝试对非套接字的操作进行操作。

2012-04-08 14:58:25 PDT LOG：不完整的启动数据包
2012-04-08 14:58:27 PDT 日志：无法从客户端接收数据：尝试对不是套接字的东西进行操作。

```

我禁用了 F-Secure，但没有任何区别。知道为什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T02:46:12.903

即使在停止或禁用时，防病毒产品也会引起问题并不少见。有时必须完全卸载它们以避免它们妨碍正常的数据库操作。另一种可能的可能性是需要配置防火墙以允许打开 TCP 服务器套接字或各种 PostgreSQL 进程使用的 UDP 套接字就统计信息进行通信。

# algorithm - 找到与平面中所有其他点不共线的点

> ID：10067028
> 
> 赞同：0
> 
> 时间：2012-04-08T22:19:59.060
> 
> 标签：algorithm

给定平面中大致位置的 N 个点的列表（没有三个点共线），找到一个与 N 个原始点中的任何对都不共线的新点 p。

我们显然无法搜索平面上的每个点，我从找到可以与给定点形成的所有线的重合点开始，或者用它们做一个圆圈。我不知道如何检查所有的点。

[在http://introcs.cs.princeton.edu/java/42sort/](http://introcs.cs.princeton.edu/java/42sort/)中发现的问题

我在一本著名的算法书中发现了这个问题，这意味着它是可以回答的，但我想不出一个最佳解决方案，这就是为什么我在这里发布它，以便如果有人知道他/她可以回答它

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-06T15:47:04.607

您实际上可以使用简单的 O(nlogn) 算法解决它，然后我们将其改进为 O(n)。将 A 命名为最底部的点（如果出现平局，请选择 x 坐标较小的点）。您现在可以使用 CCW 按顺时针顺序对其余点进行排序。现在，当您从排序顺序处理每个点时，您可以看到在与点 A 和底轴具有不同角度的任意两个连续点之间（让这些点为 U，V），没有角度为 c 的点，且 U <= c <= V. 所以我们可以在本节中添加任何点，并保证它不会与集合中的任何其他点共线。所以，你只需要找到一对相邻的点就可以了。因此，在 O(n) 时间内找到与 A 的最小和第二个最小角度（这些应该不同），并选择它们之间的任何点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T18:33:36.663

我能想到的最好的算法是 N^2 算法。开始：

1.  选择容差*e*来控制您愿意接近由集合中的点形成的线的距离。
2.  计算一组点的[凸包](http://en.wikipedia.org/wiki/Convex_hull_algorithms)。
3.  选择一条平行于凸包边之一的直线 L，在凸包**外距离为***3e* 。
***   在L上选择一个点P，使得P在凸包在L上的投影之外。凸包在L上的投影是L的一个区间。P必须放在这个区间之外。*   测试集合中的每一对点。对于由 2 个测试点形成的特定线 M 与围绕 P 的半径为*2e*的圆盘相交，将 P 沿 L 进一步移出，直到 M 不再与圆盘相交。通过 L 的构造，不可能有与 L 平行的圆盘相交的直线，所以这总是可以做到的。*   如果 M 越过 P 越过 L，则将 P 移出该交叉点，再次移动到足以使 M 不穿过圆盘的距离。*   完成所有这些之后，选择距离*e*处的点，在 P 处与 L 垂直。它可以与集合中的任何一条线共线。**

 **步骤5中如何选择P沿L的下一个位置的细节留给你，

您可以进行一些明显的微不足道的拒绝测试，以便仅在测试线 M 与 L“足够平行”的情况下进行更昂贵的检查。

最后，我应该提一下，有可能将 P 推得足够远，以至于出现数值问题。在这种情况下，我可以建议的最好方法是在凸包之外尝试另一条线，距离至少为*3e*。**

# php - 如何使用 php 拆分 cookie

> ID：10067029
> 
> 赞同：-1
> 
> 时间：2012-04-08T22:20:01.060
> 
> 标签：php, cookies, split

我有一个我正在尝试拆分的 cookie。cookie 采用以下格式：

key = val1,val2,val3（每个值用逗号分隔）

有没有办法让我把它分成一个循环，以便我可以直接访问 val3？

我试过使用explode() 函数没有成功。

```
for ($i = 0; $i < count($_COOKIE); $i++)
{
    $ind = key($_COOKIE);
    $data = $_COOKIE[$ind];

    //I try and slit the cookie here
    $cookie_temp = explode(",",$_COOKIE[$ind]);

    //Here is where I wanted to display Val3 from the cookie
    print $cookie_temp[2];

    next($_COOKIE);
} 
```

我的代码工作正常，但我最终将我所有的 Val3 放在一个大数组中。例如，我的 val3 是数字，它们被放入一个数组中。我可以进一步拆分吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-08T22:24:20.000

首先，我希望您知道要获取其值的 cookie 的名称。让我们在我的其余答案中调用它`mycookie`。

其次，只需废弃整个循环内容并直接访问`$_COOKIE['mycookie']`即可。

然后，您现在可以调用`explode(",",$_COOKIE['mycookie'])`以获取单独的值。

接下来，只需`[2]`在当前代码中使用索引 2 即可。

作为一种快捷方式，如果第二个是您唯一需要的：

```
list(,,$val) = explode(",",$_COOKIE['mycookie']); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-08T22:24:33.130

假设您正在循环，因为您有多个逗号分隔的 cookie 键/值组，请改用 a`foreach()`并且`list()`您可以通过直接分配检索第三个值。

```
foreach ($_COOKIE as $key=>$value) {
  list($v1, $v2, $v3) = explode("," $value);
  echo $v3;
} 
```

如果你只有一个cookie值可以访问，则不需要循环，直接调用即可`explode(",", $_COOKIE['key'])`

PHP 5.4 允许数组解引用，因此您可以在调用后直接访问数组元素`explode()`，但这在早期的 PHP 版本中不起作用。

```
echo explode(",", $_COOKIE['key'])[2]; 
```

# c# - 使用 Graph# 绘制图形

> ID：10067031
> 
> 赞同：2
> 
> 时间：2012-04-08T22:20:11.447
> 
> 标签：c#, winforms, graph, draw

我想画一个像我在这里附上的图表：

![在此处输入图像描述](../Images/15ab0810df68cd4589aae110a1161cca.png)

我不想重新发明轮子并开始画圆圈等等，所以我用谷歌搜索了图书馆，我发现的是 Graph#。不幸的是，没有文档/教程，所以我有点困惑，这是否是我需要的！

我需要的是能够为顶点选择颜色、设置字体和大小、边缘的厚度以及与根的距离。任何人都可以帮助我吗？图#的任何例子？任何其他图书馆？

任何帮助表示赞赏，谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-18T10:21:09.820

您可以使用基于 Graph# ( [http://graphx.codeplex.com](http://graphx.codeplex.com) ) 的 GraphX 库来实现这一点，尽管需要进行一些修改，例如模板更改或算法自定义。如果您有任何问题，请随时在网站的讨论页面中提问。干杯。

# git - git push heroku master 失败，因为密钥未经授权

> ID：10067037
> 
> 赞同：2
> 
> 时间：2012-04-08T22:21:40.977
> 
> 标签：git, heroku

几分钟前我在 Heroku 上注册并尝试部署我的第一个 Rails 应用程序。一切正常，直到我犯了从 Web 界面更改应用程序名称的错误。

就是这样，现在两者

```
heroku rename 
```

和

```
git push heroku master 
```

失败，因为“您的带有指纹 blahblah 的密钥无权访问应用程序”。

我尝试从heroku中删除我的密钥并注销然后再次登录（从命令行），但没有任何效果。我也没有 git 的经验，所以我认为我的密钥可能搞砸了，但我可以添加、提交和推送到 git 就好了。

有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-08T22:27:25.000

尝试这样的事情：

```
git remote rm heroku
git remote add heroku NEW_GIT_REPO_URL 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-08T22:27:46.770

您需要为 heroku 更改 git 的名称。

为此，当您在应用程序中时，请执行此操作

```
cd .git
vim config 
```

现在你有

```
[remote "heroku"]
    url = git@heroku.com:old_name.git 
```

更改：

```
[remote "heroku"]
    url = git@heroku.com:new_name.git 
```

祝你好运

# asp.net-mvc - 如何将多个 Html.DropDownList 选定值从 View(.aspx) 传递给 MVC 控制器的操作？

> ID：10067042
> 
> 赞同：1
> 
> 时间：2012-04-08T22:22:11.040
> 
> 标签：asp.net-mvc, model-view-controller, view, drop-down-menu, selectedvalue

我需要将多个数据（可能是 2 个 Html.DropDownList 的选定值）从 MVC 视图（.aspx）传递给 MVC 控制器操作方法。我认为它会以某种方式来自 Html.Hidden 形式，但如何？

我无法从 Html.DropDownList 中获取所选值并将其作为 Html.Hidden("paramName", MvcStringSelectedValue) 传递给控制器​​的操作。

我的代码是：

```
 based on<br />

        <%: Html.DropDownList("Semester")%>
        <%= Html.Hidden("strSemesterToBaseOn",returnedValueFromAbove)%>

        <%: Html.ValidationSummary(true) %>           
        <input type="submit" value="Clone" />

    <% } %>
<br/><br/> 
```

我需要写“提交”的输入标签2次还是只写一次？

## 编辑（额外代码）

控制器的动作方法：

```
[HttpPost]
public ActionResult CloneSemesterData(string strSemesterToOrganize, string strSemesterToBaseOn)
{

     .............................................................
     ..............................      
} 
```

这里（另一个控制器的方法）是填充学期值的下拉列表

```
 public ActionResult DepartmentAdministration()
   {
      // Get list of semesters
      var lr = new ListRepository();
      ViewData["Semester"] = new SelectList(lr.ListSemester(3));  //this ListSemester(3) will generate the list with 3 strings ( e.g "WS 2012", "SS2010")

      return View();
   } 
```

我在 .aspx 文件中的查看代码是：

//当radioButton =“Clone”被选中时执行

```
 <% using (Html.BeginForm("CloneSemesterData", "CourseNeededHours")) 
    {%>
        <%= Html.DropDownList("Semester")%> // this is First drop down list box , from which selected value , I want to transfer as 1st parameter of controller's action method

        <%: Html.ValidationSummary(true) %>           

        based On 

        <%= Html.DropDownList("Semester")%> //this is Second drop down list box, from which selected value, I want to transfer as 2nd parameter of controller's action method.
          <input type="submit" value="Clone" />

    <% } %> 
```

## 错误：

现在，在使用 Edit 2 修复后：它在下面给出红线

因为它以某种方式无法识别 ViewData["SemesterList"]...

**“System.Web.Mvc.HtmlHelper 不包含 'DropDownList' 的定义和重载的最佳扩展方法 'System.Web.Mvc.Html.SelectExtensions.DropDownList(System.Web.Mvc.HtmlHelper, string,System.Collections. Generic.IEnumerable') 有一些无效参数”。**

希望现在它会清楚，仍然模棱两可，然后让我知道。

问候乌斯曼

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T23:30:34.867

我不确定你在这里问什么。您不需要任何类型的隐藏字段来发布下拉列表的选定值。您的下拉列表代码一开始就无效。

通常你有这样的事情：

```
<%= Html.DropDownList("SemesterToOrganize", GetSemesterToOrganize()) %>
<%= Html.DropDownList("SemesterToBaseOn", GetSemesterToBaseOn()) %> 
```

在你的控制器中：

```
[HttpPost]
public ActionResult MyAction(string SemesterToOrganize, string SemesterToBaseOn) {
    // your code.
} 
```

编辑：

根据你告诉我们的。您依赖于 MVC 填充 DropDownList 的行为，因为您将列表添加到与下拉列表同名的 ViewData 中。这对你不起作用。您必须分别填充每个下拉列表。

在您的控制器中，执行以下操作：

```
public ActionResult MyAction ()
{
    ViewData["SemesterList"] = // list of semesters

    return View();
} 
```

然后，在您看来，您有：

```
<%= Html.DropDownList("SemesterToOrganize", ViewData["SemesterList"]) %> 
<%= Html.DropDownList("SemesterToBaseOn", ViewData["SemesterList"]) %> 
```

然后你的帖子方法

```
[HttpPost] 
public ActionResult MyAction(string SemesterToOrganize, string SemesterToBaseOn) { 
    // your code. 
} 
```

如果你想继续争辩说你可以按照自己的方式去做，那你就解决不了你的问题。每个下拉菜单都必须有自己的唯一 ID，否则将无法正确发布。解决这个问题的唯一方法是给每个它自己的唯一 ID。这打破了下拉自动获取数据的行为，因此您必须明确指定数据列表。

所以不要再争论这是问题的一个不重要的部分。它不是。这是问题的关键。

编辑2：

根据您上面的代码：

```
<%= Html.DropDownList("strSemesterToOrganize", (SelectList)ViewData["Semester"]) %>
<%= Html.DropDownList("strSemesterToBaseOn", (SelectList)ViewData["Semester"]) %> 
```

这就是你所需要的

如果你刚刚给我们这个，并且没有争论，这会更容易解决。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T16:27:09.083

```
 // Try this. Change names and put in the appropriate namespace. 
    //Your view
    @model MvcApplication2.Models.CloneSemesterDataViewModel 
    @Html.LabelFor(x => x.SemesterToOrganize)
    @Html.DropDownListFor(x => x.SemesterToOrganize, Model.ListofSemestersToOrganize)
    --------
    @Html.LabelFor(x => x.SemesterToBaseOn)
    @Html.DropDownListFor(x => x.SemesterToBaseOn, Model.ListofSemestersToBaseOn)

    //view model
    namespace MvcApplication2.Models
    {
        public class CloneSemesterDataViewModel
        {
            public string SemesterToOrganize { get; set; }
            public IEnumerable<SelectListItem> ListofSemestersToOrganize
            {
                get
                {
                    return new List<SelectListItem> { new SelectListItem { Text = "SS2012" , Value = "SS2012"} };
                }
            }

            public string SemesterToBaseOn { get; set; }
            public IEnumerable<SelectListItem> ListofSemestersToBaseOn
            {
                get
                {
                    return new List<SelectListItem> { new SelectListItem { Text = "SS2012", Value = "SS2012" } };
                }
            }
        }
    }

    ----------
    Controller.

    [HttpPost]
    public ActionResult CloneSemesterData(CloneSemesterDataViewModel viewModel)
    {
       //viewModel.SemesterToBaseOn
       //viewModel.SemesterToOrganize
    }

   // This should do the trick. 
```

# oauth-2.0 - 恢复 OAuth 2 认证的会话

> ID：10067047
> 
> 赞同：1
> 
> 时间：2012-04-08T22:23:10.977
> 
> 标签：oauth-2.0, google-docs-api

我成功地使用 OAuth 2 针对 Google 的 Doc 服务验证了我的控制台应用程序（感谢此列表中的好心人）。问题显然是用户每次使用该应用程序时都必须进行身份验证。

是否可以保存授权令牌（我已经使用三足 OAuth 完成了此操作）并恢复它以供我的应用程序后续使用？

我在这里记录我的经历，以防有人正在寻找解决我遇到的问题的方法 [http://code.google.com/p/gdatacopier/wiki/DevelopmentNotes30](http://code.google.com/p/gdatacopier/wiki/DevelopmentNotes30)

谢谢你的时间。

关于这方面的 PS 文档在 Googleverse 中非常稀少。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T13:46:59.083

当您授权用户时，您应该请求[`offline`访问权限](https://developers.google.com/accounts/docs/OAuth2WebServer#offline)。这为您提供了一个刷新令牌，您以后可以使用它来[恢复访问令牌](https://developers.google.com/accounts/docs/OAuth2WebServer#refresh)以在 API 中使用。您应该存储此刷新令牌。

# java - 选择了哪个 JRadioButton

> ID：10067053
> 
> 赞同：4
> 
> 时间：2012-04-08T22:25:11.463
> 
> 标签：java, swing, jradiobutton, buttongroup

我在一个 ButtonGroup 中有几个 JRadioButtons。

```
 private ButtonGroup radioGroup= new ButtonGroup();
   private JRadioButton radio1= new JRadioButton("Red");
   private JRadioButton radio2= new JRadioButton("Green");
   private JRadioButton radio3= new JRadioButton("Blue");

   radioGroup.add(radio1);
   radioGroup.add(radio2);
   radioGroup.add(radio3); 
```

如何检查选择了哪一个？

我`System.out.println(radioGroup.getSelection())`只得到类似的东西`javax.swing.JToggleButton$ToggleButtonModel@32b3714`。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-08T22:33:03.040

从选定的 ButtonModel 中，您可以获得 actionCommand 字符串（如果您记得设置它！）。

```
// code not compiled, run, nor tested in any way
ButtonModel model = radioGroup.getSelection();
String actionCommand = (model == null) ? "" : model.getActionCommand():
System.out.println(actionCommand); 
```

但这只有在您首先设置 actionCommand 时才有效。例如，：

```
// code not compiled, run, nor tested in any way
String[] colors = {"Red", "Green", "Blue"};
JRadioButton[] radioBtns = new JRadioButton[colors.length];
for (int i = 0; i < radioBtns.length; i++) {
   radioBtns[i] = new JRadioButton(colors[i]);
   radioBtns[i].setActionCommand(colors[i]);
   radioGroup.add(radioBtns[i]);
   somePanel.add(radioBtns[i]);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-08T22:31:30.493

您看到的是该`toString`方法的默认实现。并将`ButtonGroup#getSelection`返回`ButtonModel`选定的`JRadioButton`.

另请参阅[如何获取从 ButtonGroup 中选择的 JRadioButton](https://stackoverflow.com/questions/201287/how-do-i-get-which-jradiobutton-is-selected-from-a-buttongroup)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-08T22:51:48.690

如果附加了侦听器，确定源的简单方法是调用[`ActionEvent.getSource()`](http://docs.oracle.com/javase/7/docs/api/java/util/EventObject.html#getSource%28%29).

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-20T17:52:51.710

这将从按钮组返回所选单选按钮的文本

```
 Enumeration<AbstractButton> allRadioButton=radioGroup.getElements();  
    while(allRadioButton.hasMoreElements())  
    {  
       JRadioButton temp=(JRadioButton)allRadioButton.nextElement();  
       if(temp.isSelected())  
       {  
          JOptionPane.showMessageDialog(null,"You select : "+temp.getText());  
       }  
    } 
```

# c - 对函数的未定义引用，尽管在 c 中给出了引用

> ID：10067054
> 
> 赞同：0
> 
> 时间：2012-04-08T22:25:22.757
> 
> 标签：c, undefined

我正在学习教程，但是在编译和链接代码时出现以下错误：

```
/tmp/cc8gRrVZ.o: In function `main':
main.c:(.text+0xa): undefined reference to `monitor_clear'
main.c:(.text+0x16): undefined reference to `monitor_write'
collect2: ld returned 1 exit status
make: *** [obj/main.o] Error 1 
```

这告诉我的是我还没有定义“monitor_clear”和“monitor_write”。但是我在头文件和源文件中都有。

它们如下：

监视器.c：

```
// monitor.c -- Defines functions for writing to the monitor.
//             heavily based on Bran's kernel development tutorials,
//             but rewritten for JamesM's kernel tutorials.

#include "monitor.h"

// The VGA framebuffer starts at 0xB8000.
u16int *video_memory = (u16int *)0xB8000;
// Stores the cursor position.
u8int cursor_x = 0;
u8int cursor_y = 0;

// Updates the hardware cursor.
static void move_cursor()
{
    // The screen is 80 characters wide...
    u16int cursorLocation = cursor_y * 80 + cursor_x;
    outb(0x3D4, 14);                  // Tell the VGA board we are setting the high cursor byte.
    outb(0x3D5, cursorLocation >> 8); // Send the high cursor byte.
    outb(0x3D4, 15);                  // Tell the VGA board we are setting the low cursor byte.
    outb(0x3D5, cursorLocation);      // Send the low cursor byte.
}

// Scrolls the text on the screen up by one line.
static void scroll()
{

    // Get a space character with the default colour attributes.
    u8int attributeByte = (0 /*black*/ << 4) | (15 /*white*/ & 0x0F);
    u16int blank = 0x20 /* space */ | (attributeByte << 8);

    // Row 25 is the end, this means we need to scroll up
    if(cursor_y >= 25)
    {
        // Move the current text chunk that makes up the screen
        // back in the buffer by a line
        int i;
        for (i = 0*80; i < 24*80; i++)
        {
            video_memory[i] = video_memory[i+80];
        }

        // The last line should now be blank. Do this by writing
        // 80 spaces to it.
        for (i = 24*80; i < 25*80; i++)
        {
            video_memory[i] = blank;
        }
        // The cursor should now be on the last line.
        cursor_y = 24;
        }
    }

    // Writes a single character out to the screen.
    void monitor_put(char c)
    {
        // The background colour is black (0), the foreground is white (15).
        u8int backColour = 0;
        u8int foreColour = 15;

        // The attribute byte is made up of two nibbles - the lower being the 
        // foreground colour, and the upper the background colour.
        u8int  attributeByte = (backColour << 4) | (foreColour & 0x0F);
        // The attribute byte is the top 8 bits of the word we have to send to the
        // VGA board.
        u16int attribute = attributeByte << 8;
        u16int *location;

        // Handle a backspace, by moving the cursor back one space
        if (c == 0x08 && cursor_x)
        {
            cursor_x--;
        }

        // Handle a tab by increasing the cursor's X, but only to a point
        // where it is divisible by 8.
        else if (c == 0x09)
        {
              cursor_x = (cursor_x+8) & ~(8-1);
        }

        // Handle carriage return
        else if (c == '\r')
        {
            cursor_x = 0;
        }

       // Handle newline by moving cursor back to left and increasing the row
       else if (c == '\n')
       {
            cursor_x = 0;
            cursor_y++;
       }
       // Handle any other printable character.
       else if(c >= ' ')
       {
           location = video_memory + (cursor_y*80 + cursor_x);
           *location = c | attribute;
           cursor_x++;
       }

       // Check if we need to insert a new line because we have reached the end
       // of the screen.
       if (cursor_x >= 80)
       {
           cursor_x = 0;
           cursor_y ++;
       }

       // Scroll the screen if needed.
       scroll();
       // Move the hardware cursor.
       move_cursor();

}

// Clears the screen, by copying lots of spaces to the framebuffer.
void monitor_clear()
{
    // Make an attribute byte for the default colours
    u8int attributeByte = (0 /*black*/ << 4) | (15 /*white*/ & 0x0F);
    u16int blank = 0x20 /* space */ | (attributeByte << 8);

    int i;
    for (i = 0; i < 80*25; i++)
    {
         video_memory[i] = blank;
    }

    // Move the hardware cursor back to the start.
    cursor_x = 0;
    cursor_y = 0;
    move_cursor();
}

// Outputs a null-terminated ASCII string to the monitor.
void monitor_write(char *c)
{
    int i = 0;
    while (c[i])
    {
        monitor_put(c[i++]);
    }
}

void monitor_write_hex(u32int n)
{
    s32int tmp;

    monitor_write("0x");

    char noZeroes = 1;

    int i;
    for (i = 28; i > 0; i -= 4)
    {
        tmp = (n >> i) & 0xF;
        if (tmp == 0 && noZeroes != 0)
        {
            continue;
        }

        if (tmp >= 0xA)
        {
            noZeroes = 0;
            monitor_put (tmp-0xA+'a' );
        }
        else
        {
            noZeroes = 0;
            monitor_put( tmp+'0' );
        }
    }

    tmp = n & 0xF;
    if (tmp >= 0xA)
    {
         monitor_put (tmp-0xA+'a');
    }
    else
    {
        monitor_put (tmp+'0');
    }

}

void monitor_write_dec(u32int n)
{

    if (n == 0)
    {
        monitor_put('0');
        return;
    }

    s32int acc = n;
    char c[32];
    int i = 0;
    while (acc > 0)
    {
        c[i] = '0' + acc%10;
        acc /= 10;
        i++;
    }
    c[i] = 0;

    char c2[32];
    c2[i--] = 0;
    int j = 0;
    while(i >= 0)
    {
         c2[i--] = c[j++];
    }
    monitor_write(c2);

} 
```

监视器.h：

```
// monitor.h -- Defines the interface for monitor.h
//              From JamesM's kernel development tutorials.

#ifndef MONITOR_H
#define MONITOR_H

#include "common.h"

// Write a single character out to the screen.
void monitor_put(char c);

// Clear the screen to all black.
void monitor_clear();

// Output a null-terminated ASCII string to the monitor.
void monitor_write(char *c);

#endif // MONITOR_H 
```

常见的.c：

```
// common.c -- Defines some global functions.
//             From JamesM's kernel development tutorials.

#include "common.h"

// Write a byte out to the specified port.
void outb ( u16int port, u8int value )
{
        asm volatile ( "outb %1, %0"  : : "dN" ( port ), "a" ( value ) );
}

u8int inb ( u16int port )
{
    u8int ret;
asm volatile ( "inb %1, %0" : "=a" ( ret ) : "dN" ( port ) );
return ret;
}

u16int inw ( u16int port )
{
u16int ret;
asm volatile ( "inw %1, %0" : "=a" ( ret ) : "dN" ( port ) );
return ret;
}

// Copy len bytes from src to dest.
void memcpy(u8int *dest, const u8int *src, u32int len)
{
const u8int *sp = ( const u8int * ) src;
u8int *dp = ( u8int * ) dest;
for ( ; len != 0; len-- ) *dp++ =*sp++;
}

// Write len copies of val into dest.
void memset(u8int *dest, u8int val, u32int len)
{
u8int *temp = ( u8int * ) dest;
for ( ; len != 0; len-- ) *temp++ = val;
}

// Compare two strings. Should return -1 if 
// str1 < str2, 0 if they are equal or 1 otherwise.
int strcmp(char *str1, char *str2)
{
int i = 0;
int failed = 0;
while ( str1[i] != '\0' && str2[i] != '\0' )
{
    if ( str1[i] != str2[i] )
    {
        failed = 1;
        break;
    }
    i++;
}
// Why did the loop exit?
if ( ( str1[i] == '\0' && str2[i] != '\0' || (str1[i] != '\0' && str2[i] =='\0' ) )
    failed =1;

return failed;
}

// Copy the NULL-terminated string src into dest, and
// return dest.
char *strcpy(char *dest, const char *src)
{
do
{
    *dest++ = *src++;
}
while ( *src != 0 );
}

// Concatenate the NULL-terminated string src onto
// the end of dest, and return dest.
char *strcat(char *dest, const char *src)
{
while ( *dest != 0 )
{
    *dest = *dest++;
}

do 
{
    *dest++ = *src++;
}
while ( *src != 0 );

return dest;
} 
```

常见的.h：

```
// common.h -- Defines typedefs and some global functions.
//             From JamesM's kernel development tutorials.

#ifndef COMMON_H
#define COMMON_H

// Some nice typedefs, to standardise sizes across platforms.
// These typedefs are written for 32-bit x86.
typedef unsigned    int     u32int;
typedef         int         s32int;
typedef unsigned    short           u16int;
typedef         short       s16int;
typedef unsigned    char        u8int;
typedef         char            s8int;

void outb ( u16int port, u8int value );
u8int inb ( u16int port );
u16int inw ( u16int port );

#endif //COMMON_H 
```

主.c：

```
// main.c -- Defines the C-code kernel entry point, calls initialisation routines.
//           Made for JamesM's tutorials <www.jamesmolloy.co.uk>

#include "monitor.h"

int main(struct multiboot *mboot_ptr)
{
    monitor_clear();

monitor_write ( "hello, world!" );

return 0;
} 
```

这是我的makefile：

```
C_SOURCES=  main.c monitor.c common.c
S_SOURCES= boot.s
C_OBJECTS=$(patsubst %.c, obj/%.o, $(C_SOURCES))
S_OBJECTS=$(patsubst %.s, obj/%.o, $(S_SOURCES))
CFLAGS=-nostdlib -nostdinc -fno-builtin -fno-stack-protector -m32 -Iheaders
LDFLAGS=-Tlink.ld -melf_i386 --oformat=elf32-i386
ASFLAGS=-felf

all: kern/kernel

.PHONY: clean
clean:
-rm -f kern/kernel

kern/kernel: $(S_OBJECTS) $(C_OBJECTS)
ld $(LDFLAGS) -o $@ $^

$(C_OBJECTS): obj/%.o : %.c 
gcc $(CFLAGS) $< -o $@

vpath %.c source

$(S_OBJECTS): obj/%.o : %.s
    nasm $(ASFLAGS) $< -o $@

vpath %.s asem 
```

希望这将帮助您了解出了什么问题以及如何解决它：L

提前致谢。

杰米。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T22:53:40.213

从您的制作文件中，您似乎需要将`-c`标志添加到`CFLAGS`：

```
CFLAGS=-c -nostdlib -nostdinc -fno-builtin -fno-stack-protector -m32 -Iheaders 
```

使每个编译单元都有一个目标文件。目前您尝试从 main.c 中生成可执行文件（当然它不包含所有功能）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-08T23:00:46.953

顺便提一句：

```
char *strcpy(char *dest, const char *src)
{
do
{
    *dest++ = *src++;
}
while ( *src != 0 );
} 
```

这看起来不对。当 src 指针命中 '\0' 时，dst 指针还没有被写入。更好地使用 K&R 方法：

```
char *strcpy(char *dest, const char *src)
    {
        char *org = dest;
        while (*dest++ = *src++) {;}

        return org;
    } 
```

下一个：

```
// Compare two strings. Should return -1 if 
// str1 < str2, 0 if they are equal or 1 otherwise.
int strcmp(char *str1, char *str2)
{
    size_t i;

    for (i=0; str1[i] || str2[i]; i++ )
    {
        if ( str1[i] != str2[i] return str1[i] - str2[i] ;
    }
    return 0;
} 
```

下一个：

```
// Concatenate the NULL-terminated string src onto
// the end of dest, and return dest.
char *strcat(char *dest, const char *src)
{

    char *org = dst;

    for ( ;*dest; dst++; ) {;}

    while (*dest++ = *src++) {;}

return org;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-08T23:22:17.250

首先，您的代码中有一些错误。

`)`您在第 58 行缺少`common.c`：

```
if ( ( str1[i] == '\0' && str2[i] != '\0' || (str1[i] != '\0' && str2[i] =='\0' ) ) 
```

在 中`main.c`，您定义`main`为：

```
int main(struct multiboot *mboot_ptr)
{
/* ... */
} 
```

但你还没有`struct multiboot`在任何地方定义。

一旦你解决了这些问题，这里有一个简单的例子来说明你遇到的“未定义符号”问题：

**函数.h：**

```
#ifndef FUNC_H

void func(void);

#endif /* FUNC_H */ 
```

**函数.c：**

```
#include "func.h"

#include <stdio.h>

void func(void) {
    puts("In func");
} 
```

**主.c：**

```
#include "func.h"

int main(void) {
    func();
    return 0;
} 
```

`func.h` *声明*函数`func`（即，它告诉编译器如何生成对它的调用）。

`func.c` *定义*函数`func`（即，它告诉编译器如何生成实际实现行为的代码）。当您 compile`func.c`时，生成的代码将被写入`func.o`（至少对于 gcc；其他编译器可能会以不同的方式执行此操作）。

`main.c`是主程序，它*调用*.`func`

当编译器处理`main.c`时，`#include "func.h"`它会告诉它如何生成对 的调用`func`，但这只是您需要的一部分。最终程序不仅要包含对 的调用`func`，还要包含实现其行为的机器代码；该代码在 中`func.o`，生成自`func.c`。

所以如果你这样做：

```
gcc main.c -o main 
```

它相当于这两个命令：

```
gcc -c main.c        # generates main.o
gcc main.o -o main   # invokes the linker to generate main from main.o 
```

这不起作用，因为您没有告诉链接器在哪里可以找到`func.o`：

```
main.o:main.c:(.text+0xc): undefined reference to `_func' 
```

如果将其分解为各个步骤，则可以执行以下操作：

```
gcc -c func.c        # generates func.o
gcc -c main.c        # generates main.o
gcc main.o func.o -o main   # invokes the linker to combine main.o and func.o into main 
```

现在运行`./main`将打印`In func`.

gcc 还可以让您以各种方式组合其中一些步骤，例如：

```
gcc -c func.c
gcc main.c func.o -o main # As above, but combining the last two steps 
```

甚至：

```
gcc func.c main.c -o main  # Combines all three steps 
```

如果您在 a`Makefile`而不是直接指定这些命令，通常最好将它们分解为单独的编译和链接命令。这允许`make`重新使用以前生成的文件；例如，如果您修改`func.c`，则不必重新编译`main.c`，只需重新链接即可。

# javascript - Javascript 私有变量 + Object.create（引用闭包变量）

> ID：10067055
> 
> 赞同：2
> 
> 时间：2012-04-08T22:25:27.047
> 
> 标签：javascript, closures, private, object-create

我想知道如何通过 clojure 在 javascript 中创建私有变量。**但是在使用Object.create**时仍然会克隆它们。

```
var point = {};
(function(){
  var x, y;
  x = 0;
  y = 0;
Object.defineProperties(point, {
    "x": {
      set: function (value) {
        x = value;
      },
      get: function() {
        return x;
      }
    },
    "y": {
      set: function (value) {
        y = value;
      },
      get: function () {
        return y;
      }
    }
  });
}());

var p1 = Object.create(point);
p1.x = 100;
console.log(p1.x); // = 100
var p2 = Object.create(point);
p2.x = 200;
console.log(p2.x); //= 200
console.log(p1.x); //= 200 
```

我从[http://ejohn.org/blog/ecmascript-5-objects-and-properties/](http://ejohn.org/blog/ecmascript-5-objects-and-properties/)获得了这种技术，但它有这个限制，即所有对象的闭包变量都是相同的。我知道 javascript 上的这种行为是应该的，但我怎样才能创建真正的私有变量？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-08T22:55:39.093

> 我知道 javascript 上的这种行为是应该的，但我怎样才能创建真正的私有变量？

你不能，ES5 中没有私有的。如果需要，您可以使用 ES6 私有名称。

您可以使用 ES6 WeakMaps 模拟 ES6 私有名称，该名称可以在 ES5 中填充。这是一个昂贵且丑陋的仿真，这不值得。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-05T18:53:58.280

当您需要将私有变量添加到使用 Object.create 创建的一个对象时，您可以这样做：

```
var parent = { x: 0 }
var son = Object.create(parent)
son.init_private = function()
{
    var private = 0;
    this.print_and_increment_private = function()       
    {
        print(private++);
    } 
}
son.init_private()
// now we can reach parent.x, son.x, son.print_and_increment_private but not son.private 
```

如果你愿意，你甚至可以避免像这样不必要的公共函数 init_private：

```
(function()                                                                                                                                                                                                    
{                                                                                                                                                                                                              
    var private = 0;
    this.print_and_increment = function()
    {
        print(private++);
    }
}
).call(son) 
```

坏事是你不能用几个电话*附加*私人成员。好在我认为这种方法非常直观。

*此代码已使用 Rhino 1.7 release 3 2013 01 27 测试*

# c++ - wxHTTP & 线程

> ID：10067056
> 
> 赞同：5
> 
> 时间：2012-04-08T22:25:30.713
> 
> 标签：c++, multithreading, wxwidgets, wxhttp

我在线程中使用 wxHTTP 时遇到了一些问题。我在下面创建了从 wxThread 派生的类以使用 wxHTTP。

```
class Thread : public wxThread {
private:
wxHTTP get;

public:
Thread()
{
}
~Thread()
{
}

virtual ExitCode Entry()
{

    get.SetHeader(wxT("Content-Type"), wxT("text/html; charset=utf-8"));
    get.Connect(wxT("www.mysite.com"));

    get.SetTimeout(1);

    wxInputStream *httpStream = get.GetInputStream(wxT("/script.php?name=aaa&text=blabla"));
    wxDELETE(httpStream);
    get.Close();

    return 0;
}
}; 
```

我创建了这个线程并运行它（线程被创建，运行并且一切都很好）。不幸的是，wxHTTP 似乎无法与线程一起正常工作（甚至我的防火墙也没有询问我有关连接的问题）。有没有办法在线程内创建 wxHTTP 连接？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-09-29T07:37:55.013

这是答案（根据@bluefeet 的要求） wxHTTP 继承自 wxSocketBase 并且在 wxSocketBase 中我们有这个引用

> 当从多个线程使用 wxSocket 时，即使是隐式的（例如，通过在另一个线程中使用 wxFTP 或 wxHTTP），您必须在创建其他套接字之前通过调用 Initialize() 从主线程初始化套接字。

有关更多说明，请参见[此处](http://docs.wxwidgets.org/trunk/classwx_socket_base.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-21T14:08:07.110

称呼

wxSocketBase::Initialize();

在您的应用程序中，OnInit 函数和 wxurl/wxhttp 函数应该在线程中工作。

# mysql - 需要在MySql或Access中将多行合并为一行

> ID：10067057
> 
> 赞同：0
> 
> 时间：2012-04-08T22:26:00.373
> 
> 标签：mysql, ms-access, ms-access-2007

我有一个包含 sku 编号、attribute_name 和属性值的表。每个 sku 都可以有许多属性。

现在桌子看起来像这样。

```
SKU、ATT_NM、ATT_VAL
TOST3580，供应型，碳粉
TOST3580，消费前回收含量百分比 [标称]，0 %
TOST3580，消费后回收含量百分比 [标称]，0 %
TOST3580，总回收含量百分比 [标称]，0 %
TOST3580, OEM/兼容, OEM

```

我需要他们更像这样。

```
SKU,ATT_NM,ATT_VAL,ATT_NM1,ATT_VAL1
TOST3580,Supply,Type,Toner,Pre-Consumer Recycled Content Percent,0 %

```

添加每个属性值。因此，例如上面的示例将具有 5 个不同的属性。每个 SKU 都有 2-20 个属性。任何帮助都是极好的。抱歉格式不好。

这可以在 Access 或 MySQL 中完成

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-08T22:58:42.163

您可以尝试这样的事情（使用 MySQL）-

```
SELECT
    SKU,
    GROUP_CONCAT(IF(ATT_NM = 'Supply Type', ATT_VAL, NULL)) AS `Supply Type`,
    GROUP_CONCAT(IF(ATT_NM = 'Pre-Consumer Recycled Content Percent [Nom]', ATT_VAL, NULL)) AS `Pre-Consumer Recycled Content Percent [Nom]`,
    ...
FROM table
GROUP BY SKU 
```

您可以使用 - 检索属性列表 -

```
SELECT DISTINCT ATT_NM
FROM table 
```

然后使用返回的值来构建上一个查询。

# c# - WP7 中的 DatePicker/TimePicker 格式

> ID：10067058
> 
> 赞同：0
> 
> 时间：2012-04-08T22:26:17.360
> 
> 标签：c#, silverlight, windows-phone-7, controls

我有 DatePicker 和 TimePicker 的漂亮 UI，但我需要更改它们提供的变量的最终外观。

日期看起来像这样：28/02/2012 时间看起来像这样：09:18

我希望它采用 SQL DateTime 格式，所以我有两个问题：

1）如何更改日期分隔符？2）如何转换成SQL格式：2012-02-28 09:18

我现在唯一的想法是采取每个部分（年，月..等）并手动创建新的日期时间变量。我也在这里有疑问。如果我有好的格式，我可以将它作为字符串发送到数据库吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-08T23:56:06.473

您可以将[System.Threading.Thread.CurrentUICulture](http://msdn.microsoft.com/en-us/library/system.threading.thread.currentuiculture%28v=vs.95%29.aspx)和/或[System.Threading.Thread.CurrentCulture](http://msdn.microsoft.com/en-us/library/system.threading.thread.currentculture%28v=vs.95%29.aspx)设置为自定义 Culture 实例，该实例以您需要的格式返回日期和时间！

# ios - 为什么在UIWindow中添加UIGestureRecognizer后iPad无响应？

> ID：10067059
> 
> 赞同：0
> 
> 时间：2012-04-08T22:26:28.697
> 
> 标签：ios, ipad, uigesturerecognizer

背景：我需要查看应用程序中发生的每个 UITouch，并查看 UITouch 是否不在某个 UIImageView 内。

WildcardGestureRecognizer 看起来很有前途，我试了一下。（代码在这里）： [如何拦截 MKMapView 或 UIWebView 对象上的触摸事件？](https://stackoverflow.com/questions/1049889/how-to-intercept-touches-events-on-a-mkmapview-or-uiwebview-objects)

它非常适合沙盒/快速创建的应用程序。然而，该应用程序并未反映实际目标项目的复杂性。目标项目有一个 Table View Controller 等等。

在将 WildcardGestureRecognizer 添加到更多涉及的 iPad 应用程序后，我发现在添加手势识别器并且单击发生后，其他控件都不起作用。

这是我正在玩这个想法的一些代码。同样，沙盒代码上还没有控件（例如 Table View Controller 甚至 UIButton），以便在将手势识别器添加到 UIWindow 后查看它们是否工作。

我应该选择 UIWindow 以外的其他东西来添加手势识别器，还是无论如何我都会遇到同样的问题？有没有更好的办法？

沙箱代码：[https ://github.com/finneycanhelp/GestureKata](https://github.com/finneycanhelp/GestureKata)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T22:39:00.873

您可能想尝试另一种方法：创建一个`UIWindow`子类，在您的 XIB 中使用它并覆盖[`hitTest:withEvent:`](http://developer.apple.com/library/ios/documentation/uikit/reference/uiview_class/uiview/uiview.html#//apple_ref/occ/instm/UIView/hitTest%3awithEvent%3a)。它返回已“选择”以接收触摸事件的视图。

```
- (UIView *)hitTest:(CGPoint)point withEvent:(UIEvent *)event
{
    UIView *v;

    v = [super hitTest:point withEvent:event];
    if (v == myImageView) {
        // Do something. Maybe return nil to prevent the touch from getting
        // sent to the image view.
    }

    return v;
} 
```

在调试时覆盖此方法也很有帮助。

# java - 如何在单元格编辑后维护 JTable 单元格渲染

> ID：10067060
> 
> 赞同：8
> 
> 时间：2012-04-08T22:26:34.280
> 
> 标签：java, swing, jtable, tablecellrenderer, tablecelleditor

你们在我最后一个问题上为我指明了正确的方向真是太棒了，我在这里对我的原始问题进行了扩展：

[如何将 JTable 列设置为 String 并排序为 Double？](https://stackoverflow.com/questions/10054688/how-to-set-a-jtable-column-as-string-and-sort-as-double)

由于我现在使用自定义单元格渲染器将价格列格式化为 $###,##0.00，因此我现在也为单元格设置了 JTextField 编辑器。单元格的编辑工作得很好，除了当值更新时，我的自定义渲染器中设置的数字格式似乎不再格式化单元格（我在提交编辑后丢失了 $）。即使在数据的初始显示之后，这个渲染器是否不应该渲染单元格？

我尝试使用以下方法，但没有成功：

```
((AbstractTableModel) table.getModel()).fireTableDataChanged(); 
```

我希望这会强制表格重新验证并使用自定义渲染器重新绘制单元格以呈现新值，但不幸的是这不起作用......

我错过了什么......显然，但是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-08T23:59:40.077

当您的编辑器结束时，表的`editingStopped()`方法通过收集新值`getCellEditorValue()`并将其用于`setValueAt()`模型中。反过来，模型应该 `fireTableCellUpdated()`调用指定的渲染器。扩展[默认值](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html#renderer)应该足以处理`Number`格式。在其他情况下，使用渲染器的实例作为编辑器组件可能会很方便；这个[例子](http://sites.google.com/site/drjohnbmatthews/table)展示了一个典型的实现。

附录：这是一个使用默认编辑器和渲染器实现的基本示例。

附录：感谢@mKorbel 的有用评论，我更新了示例以选择单元格的文本进行编辑，如@camickr 的文章[*表全选编辑器*](http://tips4java.wordpress.com/2008/10/20/table-select-all-editor/)中所述。

![渲染编辑编号](../Images/35113c69d4b3697ad0156d3cd23e99e7.png)

```
package overflow;

import java.awt.Component;
import java.awt.Dimension;
import java.awt.EventQueue;
import java.awt.event.MouseEvent;
import java.text.NumberFormat;
import java.util.EventObject;
import javax.swing.DefaultCellEditor;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.JTextField;
import javax.swing.table.DefaultTableCellRenderer;
import javax.swing.table.DefaultTableModel;
import javax.swing.text.JTextComponent;

/** @see http://stackoverflow.com/a/10067560/230513 */
public class RenderEditNumber extends JPanel {

    private NumberFormat nf = NumberFormat.getCurrencyInstance();

    public RenderEditNumber() {
        DefaultTableModel model = new DefaultTableModel(
            new String[]{"Amount"}, 0) {

            @Override
            public Class<?> getColumnClass(int columnIndex) {
                return Double.class;
            }
        };
        for (int i = 0; i < 16; i++) {
            model.addRow(new Object[]{Double.valueOf(i)});
        }
        JTable table = new JTable(model) {

            @Override // Always selectAll()
            public boolean editCellAt(int row, int column, EventObject e) {
                boolean result = super.editCellAt(row, column, e);
                final Component editor = getEditorComponent();
                if (editor == null || !(editor instanceof JTextComponent)) {
                    return result;
                }
                if (e instanceof MouseEvent) {
                    EventQueue.invokeLater(new Runnable() {

                        @Override
                        public void run() {
                            ((JTextComponent) editor).selectAll();
                        }
                    });
                } else {
                    ((JTextComponent) editor).selectAll();
                }
                return result;
            }
        };
        table.setPreferredScrollableViewportSize(new Dimension(123, 123));
        table.setDefaultRenderer(Double.class, new CurrencyRenderer(nf));
        table.setDefaultEditor(Double.class, new CurrencyEditor(nf));
        this.add(new JScrollPane(table));
    }

    private static class CurrencyRenderer extends DefaultTableCellRenderer {

        private NumberFormat formatter;

        public CurrencyRenderer(NumberFormat formatter) {
            this.formatter = formatter;
            this.setHorizontalAlignment(JLabel.RIGHT);
        }

        @Override
        public void setValue(Object value) {
            setText((value == null) ? "" : formatter.format(value));
        }
    }

    private static class CurrencyEditor extends DefaultCellEditor {

        private NumberFormat formatter;
        private JTextField textField;

        public CurrencyEditor(NumberFormat formatter) {
            super(new JTextField());
            this.formatter = formatter;
            this.textField = (JTextField) this.getComponent();
            textField.setHorizontalAlignment(JTextField.RIGHT);
            textField.setBorder(null);
        }

        @Override
        public Object getCellEditorValue() {
            try {
                return new Double(textField.getText());
            } catch (NumberFormatException e) {
                return Double.valueOf(0);
            }
        }

        @Override
        public Component getTableCellEditorComponent(JTable table,
            Object value, boolean isSelected, int row, int column) {
            textField.setText((value == null)
                ? "" : formatter.format((Double) value));
            return textField;
        }
    }

    private void display() {
        JFrame f = new JFrame("RenderEditNumber");
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        f.add(this);
        f.pack();
        f.setLocationRelativeTo(null);
        f.setVisible(true);
    }

    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable() {

            @Override
            public void run() {
                new RenderEditNumber().display();
            }
        });
    }
} 
```

# android - 如何通过在android中使用日期从数据库（Sqlite）中检索值？

> ID：10067061
> 
> 赞同：0
> 
> 时间：2012-04-08T22:26:48.513
> 
> 标签：android, android-date

我已将日期作为字符串存储在 sqlite 数据库表中。我需要什么 ii 必须检索过去 7 天内存储的值。我已经尝试使用以下但它没有显示任何值。

我的数据库功能

```
 public Cursor paymentWeek(Activity activity)
     {

       String[] from = { _PAYMENTID, NAME, REQUESTEDDATE, FROMAD, TOADD, EMAILBODYPAYMENT, AMOUNT};  

       SQLiteDatabase db = getReadableDatabase(); 

       String orderby = REQUESTEDDATE+" DESC";  

       Cursor cursor = db.rawQuery("select * from " + PAYMENTTABLE + " where " + REQUESTEDDATE + " BETWEEN "
       + "date('now')" + " AND " + "date('now','-7 days')", null);

       activity.startManagingCursor(cursor);

       return cursor;  
    }

Calling function

    Cursor week = db.paymentWeek(this);
               String[] weekly = new String[] { PaymentAppDataBase.REQUESTEDDATE,PaymentAppDataBase.PAYMENTNAME,PaymentAppDataBase.AMOUNT };
               int[] sevendays = new int[] { R.id.Date,R.id.Name,R.id.Amount };

               SimpleCursorAdapter weekcursor =
                    new SimpleCursorAdapter(this, R.layout.listview, week, weekly, sevendays);
                setListAdapter(weekcursor);
               db.close(); 
```

如果你们解决这个问题会很有帮助。我被困在这里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T04:35:01.207

try Following query to get records for last week(7 days):

```
"select * from " + PAYMENTTABLE + " where " + REQUESTEDDATE + "DATE_SUB( CURDATE( ) ,INTERVAL 7 DAY ) AND CURDATE( )"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-10T07:05:50.463

您不必更改数据库设计。

只需编写您自己的从 dateString 转换为 long 方法，并将其放在 DateUtil.java 之类的类中，然后在您想要对日期类型执行某些操作的任何地方调用它。

该方法应如下所示：

```
 public static long convertStringDateToLong(String date, String yourDateFormat) {
    Long time = 0L;
    try {
        SimpleDateFormat df = new SimpleDateFormat(yourDateFormat);
        Date d = null;
        try {
            d = df.parse(date);
        } catch (ParseException e) {
            e.printStackTrace();
        }
        time = d.getTime();
    } catch (Exception e) {
        e.printStackTrace();
    }
    return time;
} 
```

你的日期格式应该是这样的：“MM/dd/yyyy”

# mysql - 经典 ASP - 我可以失去我的嵌套循环以换取加入吗？

> ID：10067062
> 
> 赞同：2
> 
> 时间：2012-04-08T22:27:03.647
> 
> 标签：mysql, sql, asp-classic

我正在尝试优化其中一个脚本。它用于库存照片网站，并使用 WHILE WEND 循环显示大量图像，循环通过我的 DB (MySQL) 照片表。

在这个循环中，我有另一个 WHILE END 循环，它从我的人物表中获取每张照片中人物的姓名。

我的问题是，我可以通过向主查询添加 JOIN 来丢失第二个 WHILE WEND 循环吗？

我的困惑来自于返回多个人。我不知道如何用逗号分隔一个或多个名称，我只是不知道。也许我的脚本本来就很好，但我确信没有嵌套循环它会更快，因为在某些时候，我正在考虑添加另一个查询，它返回每张照片的前 5 个关键字，并且不要不想添加另一个循环！

**截屏**

![在此处输入图像描述](../Images/1c7d8c7016cc79fa93b2d3d08d7d250d.png)

**我的伪代码**

```
Set rsPhotos = Conn.Execute(" " _
& "SELECT photoID, setID, caption, dateCreated, dateUploaded " _
& "FROM photos ORDER BY dateCreated DESC;)"

While NOT rsPhotos.EOF
    Response.Write "<div>"
        Response.Write "<img src=""photo.jpg"">"
        Response.Write "<p>"
            people_str = ""
            Set rsPeople = Conn.Execute("SELECT p.person FROM photoPeople AS pp " _
            & "LEFT JOIN people AS p USING (personID) " _
            & "WHERE pp.photoID = "&rsPhotos.Fields("photoID")&" " _
            & "ORDER BY p.person ASC;")
            While NOT rsPeople.EOF
                people_str = people_str & ", " & rsPeople.Fields("person")
            rsPeople.MoveNext
            Wend
            rsPeople.Close
            Response.Write Mid(people_str,3)
        Response.Write "</p>"
    Response.Write "<div>"
rsPhotos.MoveNext
Wend

rsPhotos.Close 
```

**数据库架构**

```
PHOTOS tbl
photoID        |   INT 9
setID          |   INT 9
caption        |   VARCHAR2000
dateCreated    |   DATETIME
dateUploaded   |   DATETIME

PHOTOPEOPLE tbl
photoID        |   INT 9
personID       |   INT 7

PEOPLE tbl
personID       |   INT 7
person         |   VARCHAR 100 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-08T22:37:13.860

这应该这样做 -

```
SELECT photos.photoID, photos.setID, photos.caption, photos.dateCreated, photos.dateUploaded, GROUP_CONCAT(p.person ORDER BY p.person ASC SEPARATOR ', ')
FROM photos
LEFT JOIN photoPeople AS pp
    ON photos.photoID = pp.photoID
LEFT JOIN people AS p
    ON pp.personID = p.personID
GROUP BY photos.photoID
ORDER BY dateCreated DESC 
```

[GROUP_CONCAT()](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)

# c# - 程序不包含适合入口点的静态“main”方法

> ID：10067063
> 
> 赞同：3
> 
> 时间：2012-04-08T22:27:11.243
> 
> 标签：c#, .net, wpf, exception-handling, entry-point

我知道这个问题被问了很多，但似乎没有一个解决方案对我有用。那或者我只是无能，需要帮助解决这个问题（最有可能的解决方案）。我查看了所有类，所有构建操作都设置为编译，所以我不知道可能出了什么问题。有什么帮助吗？

附加详细信息：我一直在编写游戏开始时的代码，一切都很顺利，直到出现此错误：

> 程序不包含适用于入口点的静态“Main”方法

自从出现此错误以来，该项目的所有进展都已停止，我无法找到任何方法来修复它。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-14T21:35:26.510

我开始在 WPF4/VS2010/MVVMLight 应用程序上收到此错误。所有的建议都没有结果，直到我提出创建一个新应用程序并比较项目和 XAML 文件的建议。这听起来像是在黑暗中绝望的刺伤，但我继续尝试。

在查看了其他几个文件后（感谢天堂的 BeyondCompare！），我发现我的 App.xaml 获得了一个额外的资源字典：

```
 <Application.Resources>
      <!--Global View Model Locator-->
      <vm:ViewModelLocator x:Key="Locator" d:IsDataSource="True" />
      <ResourceDictionary>
        <vm:ViewModelLocator x:Key="Locator" d:IsDataSource="True" />
        <ResourceDictionary.MergedDictionaries></ResourceDictionary.MergedDictionaries>
      </ResourceDictionary>
    </Application.Resources> 
```

删除 ResourceDictionary 块解决了这个问题。我仍然不知道这是怎么发生的（开始时我没有编辑 app.xaml），并且不清楚为什么 VS 将其报告为“静态‘主要’方法”错误。很奇怪。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-19T07:13:16.240

刚遇到同样的问题，以下解决方案解决了我的问题：如果您使用的是多层项目，右键单击项目抛出错误并转到属性转到应用程序选项卡并将输出类型设置为类库，然后问题将得到解决。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-11-17T16:41:26.257

有同样的问题。解决方案：确保 app.xaml 属性“构建操作”设置为 ApplicationDefinition

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-08T22:48:50.893

在这里试试这个答案，它与你所拥有的很接近，而且提到的东西很少，

[程序不包含适用于入口点的静态“Main”方法](https://stackoverflow.com/questions/577298/program-does-not-contain-a-static-main-method-suitable-for-an-entry-point)

简而言之，您的 WPF 设置、App.xaml 或 MainWindow 等或您如何构建项目等方面“不同步”。

（注意：主要入口点应该是`auto-generated`，这就是我在评论中谈到的临时文件 - 如果一切正常，如果某些东西发生了变化等等，那么它不会生成并且它会失败）

遍历所有内容并确保 - 或构建一个空的 WPF 项目，尝试使用它然后比较不同之处，最小化差异，缩小范围。

希望这可以帮助

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-12T09:34:33.273

面临同样的问题。但就我而言，我必须创建一个`WPFApplication`但正在创建一个类库。在构建相同的内容时出现此错误。尝试创建 WPF 应用程序。希望能帮助到你。

# mysql - 来自子查询的mysql多个字段

> ID：10067070
> 
> 赞同：1
> 
> 时间：2012-04-08T22:27:51.027
> 
> 标签：mysql, sql, subquery

```
SELECT 
  (SELECT date FROM forums WHERE topic_id=f.id OR id=f.id ORDER BY id DESC LIMIT 1) as last_reply, 
  f.*, p.id as pid, p.name FROM forums f 
      INNER JOIN players p ON p.id = f.author 
  WHERE f.topic_id=0 ORDER BY f.id DESC 
```

在子查询中，我不仅要返回`date`字段，还要返回`author`字段。我怎样才能做到这一点？

看了一个类似的帖子，但无法将其应用于我的帖子。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-08T22:35:48.240

我会这样做：

```
SELECT 
  (SELECT date FROM forums WHERE topic_id=f.id OR id=f.id ORDER BY id DESC LIMIT 1) as last_reply,
  (SELECT author FROM forums WHERE topic_id=f.id OR id=f.id ORDER BY id DESC LIMIT 1) as last_author,
  f.*, p.id as pid, p.name FROM forums f 
      INNER JOIN players p ON p.id = f.author 
  WHERE f.topic_id=0 ORDER BY f.id DESC 
```

我实际上会再次重复子查询

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-08T22:39:33.627

也许这样的事情可以帮助你：

```
SELECT MAX(f.date), f.author
FROM forums f
    INNER JOIN players p ON
        p.id = f.author
WHERE f.tpoic_id = 0
GROUP BY f.author
ORDER BY f.id DESC 
```

但是没有表格结构就很困难。

祝你好运。

# perl - 使用perl修剪文件中的多列

> ID：10067073
> 
> 赞同：-4
> 
> 时间：2012-04-08T22:28:17.687
> 
> 标签：perl, variables, multiple-columns, trim

我正在尝试修剪这个特定文件，并且只需要突出显示的部分，因为它包含数据。我查看了其他一些脚本，但它们是为了删除常量值的列而编写的。

数据是：

```
id=69 rna=**5_8S_rRNA** ntax=61
id=58 rna=**U1** ntax=100
id=56 rna=**U2** ntax=211
id=37 rna=**tRNA** ntax=967
id=75 rna=**Vault** ntax=75
id=53 rna=**RNaseP_nuc** ntax=117
id=57 rna=**RNaseP_bact_a** ntax=306
id=62 rna=**RNaseP_bact_b** ntax=114
id=41 rna=**U3** ntax=26
id=50 rna=**6S** ntax=154
id=84 rna=**DsrA** ntax=5
id=48 rna=**U4** ntax=178
id=46 rna=**SRP_euk_arch** ntax=102
id=46 rna=**U5** ntax=181
id=65 rna=**GcvB** ntax=26
id=71 rna=**Telomerase-vert** ntax=37
id=50 rna=**Telomerase-cil** ntax=20
id=49 rna=**U6** ntax=200
id=43 rna=**Intron_gpI** ntax=30
id=51 rna=**RNase_MRP** ntax=67
id=33 rna=**SECIS** ntax=61
id=90 rna=**Histone3** ntax=64
id=86 rna=**OxyS** ntax=5
id=98 rna=**RRE** ntax=65
id=54 rna=**IRE** ntax=39
id=73 rna=**rne5** ntax=6
id=88 rna=**snoR9** ntax=5
id=91 rna=**GlmZ_SraJ** ntax=21
id=77 rna=**HDV_ribozyme** ntax=33
id=72 rna=**U8** ntax=49
id=87 rna=**7SK** ntax=45
id=78 rna=**VA** ntax=54
id=79 rna=**RNAI** ntax=10
id=98 rna=**FinP** ntax=6
id=82 rna=**Vimentin3** ntax=19
id=74 rna=**S15** ntax=79 
```

我只是希望将项目保留在星号中，其他所有内容都必须删除。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-08T22:59:24.423

如果这是在 Linux 系统上，这个 Perl 单行程序将产生您需要的结果。

```
perl -ne '/rna=(\S+)/ and print "$1\n"' myfile 
```

如果您在 Windows 上，请使用

```
perl -ne "/rna=(\S+)/ and print qq($1\n)" myfile 
```

**输出**

```
5_8S_rRNA
U1
U2
tRNA
Vault
RNaseP_nuc
RNaseP_bact_a
RNaseP_bact_b
U3
6S
DsrA
U4
SRP_euk_arch
U5
GcvB
Telomerase-vert
Telomerase-cil
U6
Intron_gpI
RNase_MRP
SECIS
Histone3
OxyS
RRE
IRE
rne5
snoR9
GlmZ_SraJ
HDV_ribozyme
U8
7SK
VA
RNAI
FinP
Vimentin3
S15 
```

# vb.net - 如何使用基于数据子集的系列创建 .net 图表对象？

> ID：10067076
> 
> 赞同：0
> 
> 时间：2012-04-08T22:28:53.913
> 
> 标签：vb.net, winforms, visual-studio-2010, ms-access-2010

我正在使用 VS2010 开发一个 Visual Basic 应用程序。它接收串行端口数据，将其写入访问数据库，然后绘制数据图表。数据每分钟只有一次，所以这不像我在构建示波器。现在，只要我将数据库中的记录数保持在较低水平，该图表就可以使用表格适配器从数据库中读取并绘制图形。

问题：如果我向数据库中添加了太多记录，图表会通过它显示一个红色的“X”。我玩过改变轴，但这仍然是一个问题。我真的不需要绘制整个数据库。最近的二十条记录就足够了。

如何制作一个图表系列，其中只有一小部分数据库。也许用查询填充它很冷？一般来说，我对数据库很陌生，所以也许这很容易。

谢谢，卡斯巴尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T03:18:21.950

您每分钟只需要返回最新的 20 条记录，因此例如使用计时器控件并在其滴答事件中获取插入数据库的最后 20 条记录。

在 Microsoft Access 中，创建一个查询以确认您应该在 .Net 应用程序中返回的结果。这是在 MS Access 中运行的 SQL 查询：

```
SELECT TOP 20 * FROM tblData ORDER BY DateCreated 
```

或者

```
SELECT TOP 20 * FROM tblData ORDER BY tblID DESC 
```

现在在您的 .net 应用程序中，您需要使用以下命名空间：

```
Imports System.Data.OleDb 
```

然后从 Access 数据库中读取最后 20 个值：

```
Private Xvalues as New List(Of Integer)
Private Yvalues as New List(Of Integer)

Private Sub GetData()

Dim con As OleDbConnection
Dim sql As String 
str = "Provider=Microsoft.Jet.oledb.4.0;Data Source=C:\yourAccessDB.mdb;"
con = New OleDbConnection(str)       
sql = "SELECT TOP 20 * FROM tblData ORDER BY DateCreated"
Dim cmd As OleDbCommand  
Dim r As OleDbDataReader  
Try  
   con.Open() 
   cmd = New OleDbCommand(sql, con)  
   r = cmd.ExecuteReader() 
   While dr.Read() 
     XValues.Add(Convert.ToInt32(r("chartX")))
     YValues.Add(Convert.ToInt32(r("chartY")))
   End While   
   r.Close()      
   con.Close()    
Catch ex As OleDbException 
     MsgBox(ex.Message, MsgBoxStyle.Critical, “Oledb Error”)   
Catch ex As Exception   
     MsgBox(ex.Message, MsgBoxStyle.Critical, “General Error”)
End Try   
End Sub 
```

然后挂钩上面的 GetData() 方法和要在 Timers Tick 事件中调用的图表函数。我想您还需要删除/存档旧记录并清除 X 和 Yvalue 变量。 *请注意未经测试。*

# c# - 验证 XML 模式注释/appinfo 中的 XML 内容

> ID：10067079
> 
> 赞同：-1
> 
> 时间：2012-04-08T22:29:29.637
> 
> 标签：c#, xsd

我对 XML 的理解并不完全令人惊叹，但我对 annotation/appinfo 中的内容的理解是，您可以使用任何格式正确的 XML，而这是未经验证的。我对宽松验证的理解是，如果可以获得相关的架构信息，就会验证元素和属性。

我的情况是我有一个 XML 模式，其中包含本节中需要验证的一些内容。我有相关的模式来验证内容。

我采用了一个完全简单的 XML 模式并向其中添加了一个 appinfo 元素，如下所示。appinfo 的内容是另一个元素声明，纯粹是为了不引用另一个模式的简单性。我试图验证的架构显然引用了不同的东西。

```
<?xml version="1.0"?>
<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema"
        targetNamespace="http://www.demo.org"
        xmlns="http://www.demo.org"
        elementFormDefault="qualified">
<xsd:annotation>
    <xsd:appinfo>
        <xsd:element name="Demo">
            <xsd:complexType>
                <xsd:sequence>
                    <xsd:element name="A" type="xsd:iteger"/>
                    <xsd:element name="B" type="xsd:integer"/>
                </xsd:sequence>
            </xsd:complexType>
        </xsd:element>    
    </xsd:appinfo>
</xsd:annotation>
<xsd:element name="Demo">
    <xsd:complexType>
        <xsd:sequence>
            <xsd:element name="A" type="xsd:integer"/>
            <xsd:element name="B" type="xsd:integer"/>
        </xsd:sequence>
    </xsd:complexType>
</xsd:element> 
```

请注意，在 appinfo 部分中，我故意在元素 A 上拼错了“整数”。如果我在架构的主体中执行此操作，`XmlSchemaSet.Compile()`则会告诉我此架构无效。

但是，如果我使用上面写的模式，它告诉我没有问题。在我开始使用的更复杂的文件中，我通过以下方式将外部架构提供给 XmlSchemaSet`XmlSchemaSet.Add()`

我还尝试从[http://www.w3.org/2001/XMLSchema.xsd](http://www.w3.org/2001/XMLSchema.xsd)加载 XML 模式，并将要验证的模式加载到一个`XmlDocument`并运行`XmlDocument.Validate()`但没有乐趣。

在花了几个小时之后，我觉得我完全错过了一些完全基本的东西。任何指针表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T14:38:53.330

这不是我的理解`lax`：如果你有一个声明

```
<any
  namespace=". . . " 
  processContents="lax">
</any> 
```

正在验证的 XML 中相应元素的内容将根据与`namespace`（如果有的话）指定的命名空间相对应的模式进行验证，而不是根据它可能使用的任何模式进行验证。的声明`appInfo`是

```
<xs:element name="appinfo" id="appinfo">
  <xs:complexType mixed="true">
    <xs:sequence minOccurs="0" maxOccurs="unbounded">
      <xs:any processContents="lax"/>
    </xs:sequence> 
    <xs:attribute name="source" type="xs:anyURI"/> 
    <xs:anyAttribute namespace="##other" processContents="lax"/> 
  </xs:complexType> 
 </xs:element> 
```

没有任何`namespace`规范，对应于`namespace="##any"`，这意味着没有针对任何模式的验证。

# javascript - 使用 $.get 打印页面元素

> ID：10067083
> 
> 赞同：0
> 
> 时间：2012-04-08T22:29:42.007
> 
> 标签：javascript, jquery

我正在尝试使用以下代码打印页面的元素：

```
$('#some_button').click(function(){
    var url = window.location.href;
    var contents = $.get(url);
    alert(contents.responseText);
}); 
```

但这会返回一个空白字符串，并且尝试打印`contents.status`会给我错误：

```
Uncaught Error: INVALID_STATE_ERR: DOM Exception 11 
```

这段代码在浏览器控制台上运行得很好，所以看起来这是一个加载状态问题。但是因为这是在点击监听器中，所以我不知道如何解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-08T22:32:09.373

`$.get`默认情况下是异步的，所以像这样使用它：

```
$('#some_button').click(function(){
    var url = window.location.href;
    $.get(url, function(r){
        alert(r);
    });
}); 
```

如果要同步使用，则`async : false`在参数中使用：

```
var contents = $.get(url, {
    async : false
}); 
```

请注意，这会占用浏览器。

# javascript - 这个“延迟”功能是如何工作的

> ID：10067094
> 
> 赞同：5
> 
> 时间：2012-04-08T22:32:12.153
> 
> 标签：javascript

我正在使用此代码将部分代码包装在其中，就像这样使用，

```
var delay = (function() {
    // SET TIMER
    var timer = 0;
    // RETURN SET TIMEOUT FUNCTION
    return function(callback, ms) {
        clearTimeout(timer);
        timer = setTimeout(callback, ms);
    };
})();​ 
```

我这样称呼它

```
delay(function() {
     .......
}, 1000); 
```

它会延迟 1000 毫秒，但我不明白发生了什么谢谢 :)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-08T22:44:10.937

延迟是一个将返回另一个函数的函数。计时器变量位于延迟函数的闭包内，因此返回函数仍然可以访问它。功能。你也可以这样写

```
var delay;
var timer = 0;
delay = function(callback, ms) {
    clearTimeOut(timer);
    timer = setTimeout(callback, ms);
} 
```

您现在遇到的问题是，如果您两次调用延迟，它将覆盖计时器变量，因此第二次延迟将覆盖计时器变量。我对此进行了测试，看来您的功能也已损坏，应该是：

```
var delay = function(){
// SET TIMER
    var timer = 0;
// RETURN SET TIMEOUT FUNCTION
    return function(callback, ms){
        clearTimeout(timer);
        timer = setTimeout(callback, ms);
    };
};

delay()(function(){console.log("hello1");}, 5000);
delay()(function(){console.log("hello2");}, 5000); 
```

如果您的代码执行相同操作，它只会跟踪 hello2，因为第一个代码将覆盖 timer 变量。

除非您的意图是第二次延迟将停止第一次延迟，否则您应该使用不同的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-08T22:39:34.133

这段代码做的第一件事是执行这个函数（感谢`()`您发布的代码的最后）：

```
function() {
    // SET TIMER
    var timer = 0;
    // RETURN SET TIMEOUT FUNCTION
    return function(callback, ms) {
        clearTimeout(timer);
        timer = setTimeout(callback, ms);
    };
}​ 
```

并将结果存储在`delay`. `timer`执行时，此函数使用作为本地计数器的局部变量创建一个闭包。然后该函数返回内部函数：

```
function(callback, ms) {
   clearTimeout(timer);
   timer = setTimeout(callback, ms);
} 
```

由于它是闭包的，因此这个内部函数可以访问该`timer`变量。没有其他外部代码可以访问`timer`. 此方法用于允许多个计时器同时运行，而不必担心多个`timer`变量。

想象它是这样的：`delay`现在包含一个可以`function(callback, ms) {...`访问局部变量的函数 () `timer`。`timer`就任何外部代码而言，该变量是不可见的。只有`delay`包含的函数才能访问它。

然后，您通过调用来调用该内部函数`delay(callback, timeout)`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-08T22:39:49.260

在第一段代码中，你创建了一个延迟变量，并将 if 分配给函数的返回值。这反过来又返回了一个函数，该函数是

```
return function(callback, ms) {
        clearTimeout(timer);
        timer = setTimeout(callback, ms);
    } 
```

所以这实际上是你的延迟变量。nw 所以当你这样称呼它时

```
delay(function() {
     .......
}, 1000); 
```

这个 wud 可以按预期工作..
还要注意`()`最后你在哪里 assing`delay`变量.. 在 javascript 中意味着一旦遇到它就运行一个函数.. 所以当我看到它的第一部分代码运行时`delay`变量被分配了一个函数..你在第二段代码中调用它

# jquery - 使用jquery，动态和按比例调整img

> ID：10067097
> 
> 赞同：0
> 
> 时间：2012-04-08T22:32:35.983
> 
> 标签：jquery, image, plugins, dynamic-resizing

问题：要使插件内的图像在窗口调整大小时变短的 div 内动态调整大小（H&W，按比例）（基本上有三个区域：顶部 - 静态、底部 - 静态、中间 - 动态），使用`width:100%`和`top:#px` `bottom:#px`. 图像还必须最终仅调整其设定高度（603x427）

这是页面：

[我目前的困境](http://66.147.244.242/~happymas/enginethree/print.php)

我非常接近，但是下面的代码会发生什么：

```
<script type="text/javascript">
            $(window).resize(function() {
                var hgt = $(window).height() - 427;
                var wid = $(window).width() - 633;
                $('.slides_container img').height(hgt);
                $('.slides_container img').width(wid);
                $('.slides_container').height(hgt-30);
                $('.slides_container').height(hgt);
                $('.vid').width($(window).width());
            });
</script> 
```

是图像的高度变化，宽度也是如此，但它们不会按比例变化。相反，宽度正确更改，高度正确更改，但彼此独立。我希望图像保持成比例。

图例：`.slides_container`是插件的一部分，包含图片，`.slides_container img`是图片，`.vid`包含`.container`用于居中。对于上面的代码，`$('.slides_container').height(hgt-30);`就是允许分页。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T22:38:54.947

请改用 css() 函数：

```
$(window).resize(function() {
    var hgt = $(window).height() - 427;
    var wid = $(window).width() - 633;
    $('.slides_container img').css({
        width:wid,
        height:hgt
    });
    $('.slides_container').height(hgt);
    $('.vid').width($(this).width());
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-08T23:32:37.970

如果可以妥协，没有 img 元素你可以把它作为背景，那么我认为这就是你正在寻找的[http://css-tricks.com/how-to-resizeable-background-image/](http://css-tricks.com/how-to-resizeable-background-image/)

否则，只要您具有原始比率（比率 = orgWidth/orgHeight），您就可以将其反映在宽度/高度上。在调整大小时，`height = org_height * ratio`. 以前完成，它非常简单： [如何按比例调整图像大小/保持纵横比？](https://stackoverflow.com/questions/3971841/how-do-i-resize-images-and-keep-the-proportion-aspect-ratio-with-jquery)

# android - android JUnit 测试的 Emma 代码覆盖率

> ID：10067101
> 
> 赞同：5
> 
> 时间：2012-04-08T22:32:59.393
> 
> 标签：android, testing, junit

如何为 android Junit 测试运行 Eclemma 代码覆盖工具，而不是用于 Junit 测试？任何人都可以帮忙。

![在此处输入图像描述](../Images/56d7d4730acee7a9d94234fa2ae11f02.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T04:11:53.497

最简单的方法是将**ant**构建文件添加到两个项目（主要和测试）中，然后使用特定的 ant 目标生成覆盖率报告。然后您可以将覆盖率报告导入 EclEmma。

要添加 ant 构建，您首先需要在 Eclipse 中禁用***Project -> Build Automatically***以避免冲突。

这些步骤在[http://dtmilano.blogspot.ca/2011/07/eclipse-android-and-emma-code-coverage.html](http://dtmilano.blogspot.ca/2011/07/eclipse-android-and-emma-code-coverage.html)中有描述。

# javascript - 尝试在 Javascript SDK 中删除 apprequest 时出现“加载错误：未知”

> ID：10067110
> 
> 赞同：1
> 
> 时间：2012-04-08T22:35:21.287
> 
> 标签：javascript, facebook, facebook-javascript-sdk, facebook-php-sdk, facebook-app-requests

当我尝试使用 Javascript SDK 删除应用程序请求时，它会向 FireBug 返回一个错误对象：“加载错误：未知”。

这是一个使用 PHP 和 JS SDK 的测试应用程序。

```
<?php

// This loads the PHP SDK and pulls a user's apprequests
require 'fb-sdk/facebook.php';
$facebook = new Facebook(array(
  'appId'  => 'APP_ID',
  'secret' => 'APP_SECRET',
));
$user = $facebook->getUser();
if ($user) {
  try {
    $user_profile = $facebook->api('/me');
    $user_requests = $facebook->api('/me/apprequests');
    $apprequests = $user_requests['data'];
  } catch (FacebookApiException $e) {
    echo '<pre>'.htmlspecialchars(print_r($e, true)).'</pre>';
    $user = null;
  }
}
?>

// This spits out a table of requests with links to delete them.
// The table doesn't reload when you delete a request so you have to refresh.
<table>
<?php foreach ($apprequests as $apprequest) { ?>
  <tr>
  <td><a href="" onClick="deleteRequest('<?php echo $apprequest['id']; ?>')">Delete</a></td>
  </tr>
<?php } ?>
</table>

// This loads the JS SDK and makes a function to delete requests.
<script>
function deleteRequest(requestId) {
  FB.api('/' . requestId, 'delete', function (response) {
    console.log(response);
    // Will have a function to reload the table...
  });
}
window.fbAsyncInit = function() {
  FB.init({
    appId: '<?php echo $facebook->getAppID() ?>',
    cookie: true,
    xfbml: true,
    oauth: true
  });
};
(function() {
  var e = document.createElement('script'); e.async = true;
  e.src = document.location.protocol +
    '//connect.facebook.net/en_US/all.js';
  document.getElementById('fb-root').appendChild(e);
}());
</script> 
```

我知道 deleteRequest 有效，因为我可以使用此网络表单手动删除请求：

```
<input type="text" name="manReqId"></text>
<input type="button"
  onClick="manDelRequest(); return false;"
  value="Delete request"
/>
<script>
function manDelRequest () {
  deleteRequest(document.getElementsByName("manReqId")[0].value);
}
</script> 
```

此方法向 FireBug 返回“true”。

我假设我编写 onClick 值的方式有问题。有人能帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T15:39:06.557

与 JavaScript SDK 交谈：[Facebook 的文档](http://developers.facebook.com/docs/reference/javascript/FB.login/%20FB)指出应该从点击事件中触发操作，以便所有浏览器都能正确显示任何弹出窗口（文档引用了该`FB.login`函数，但该警告可能适用于其他调用）。我想知道他们的 API 是否足够挑剔，以至于它需要一个有效的`href`属性（甚至像 . 一样短`#`）。

当多个异步请求针对 Facebook 的服务器挂起时，我也看到了确切的错误。您的代码是否有可能正在处理另一个请求，并且删除调用会干扰它？

# asp.net - ASP.net 中的邮件附件

> ID：10067111
> 
> 赞同：0
> 
> 时间：2012-04-08T22:35:46.913
> 
> 标签：asp.net, vb.net

我正在尝试在 asp.net VB 中添加邮件附件。

在添加附件代码之前，我可以正常发送邮件，

```
Dim attch As Attachment = New Attachment("http://sitehere.com/Documents/file.jpg")
mail.Attachments.Add(attch) 
```

我收到错误 URI 格式不受支持。

任何想法为什么会这样以及我能做些什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-08T22:41:54.107

该类`Attachment`需要文件系统上文件的路径，或`Stream`.

尝试：

```
Dim data As Byte() = New WebClient().DownloadData("http://sitehere.com/Documents/file.jpg")
Dim attachment As New Attachment(New MemoryStream(data), "file.jpg") 
```

那是我尽我所能将 C# 转换为 VB.NET，因此语法可能不是 100% 正确，但这是一般的想法。这会将数据下载到一个字节数组中，然后从这些字节创建一个内存流并将其传递给附件构造函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-08T22:41:31.007

您不能直接从 URL 添加附件。您需要先下载文件，然后将其添加为附件。

您可以使用`HttpWebRequest`将文件作为流获取，然后附加流。这样就不必将文件存储在磁盘上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-08T23:16:29.997

如果您在服务器本地和知道路径的文件夹中有文件，请不要使用 uri，

```
 Dim eMessage As New MailMessage

 Dim attachLabel As Attachment
 Dim location As String
 loction= Server.MapPath("Documents\\file.jpg")
 attachLabel = New Attachment(loction)

 eMessage .Attachments.Add(attachLabel); 
```

如果您真的想从另一个 url 发送文件，您可以`HttpWebRequest`先下载该文件，然后以 Colin 和 Davy8 的名称发送。

# ios - 如何“重启”应用程序 ios

> ID：10067113
> 
> 赞同：1
> 
> 时间：2012-04-08T22:35:56.060
> 
> 标签：ios, xcode, viewcontroller

所以我有一个应用程序，用户通过 3 个视图控制器然后向 Facebook 提交图片。在他们将其提交到 Facebook 后，我希望他们能够选择重新启动该过程，就好像他们重新启动了该应用程序一样。

我怎么能这样做？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T00:00:48.640

好的，因为您还不清楚您的导航模式，所以我将展示两种转换及其对立面：

**Push-Pop**：通过将新的 UIViewController 推送到导航堆栈上来创建

```
[self.navigationController pushViewController:exampleController animated:YES]; 
```

它被抵消了

```
[self popToRootViewControllerAnimated:YES]; 
```

**模态视图**：通过在当前视图上显示一个新的 UIViewController 来创建。

```
[self presentModalViewController:exampleController animated:YES]; 
```

它不在导航堆栈上，因此无法在第一个模态视图中呈现另一个模态视图。它通过调用来抵消

```
[self dismissModalViewControllerAnimated:YES]; 
```

从模态视图本身。

# java - 将 JButton 改回原来的“金属”颜色

> ID：10067114
> 
> 赞同：2
> 
> 时间：2012-04-08T22:36:08.943
> 
> 标签：java, swing, colors, jbutton, background-color

我正在编写一个程序，当单击按钮时，它会变成蓝色。我已经使用：

```
button.setBackground(Color.BLUE) 
```

但是，当它被第二次点击时，我想把它改回原来的“金属”外观。我已经用谷歌搜索和谷歌搜索，但无法弄清楚如何在任何地方执行此操作。如何将 JButton 改回原来的“金属”颜色？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-08T22:38:28.383

试试[`Component#setBackground(null)`](http://docs.oracle.com/javase/7/docs/api/java/awt/Component.html#setBackground%28java.awt.Color%29)。这样，组件将继承其父级的背景颜色。

# forms - 是否有必要验证表单的选择元素？

> ID：10067115
> 
> 赞同：0
> 
> 时间：2012-04-08T22:36:32.120
> 
> 标签：forms, validation

是否真的有必要过滤或清理表单，`select element`因为输入实际上不是由用户输入的，而是用户从已经输入的选项中选择的？ **Note**表单提交方式是`POST`. 谢谢回复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T22:38:47.730

是的。您假设用户无法更改它，而实际上他们可以。任何 DOM 检查器都允许用户简单地进入并更改选项的值，甚至添加新选项。**始终，始终**在服务器端验证用户输入，对于*所有内容*。

# ios - 从 RemoteIO 录制：生成的 .caf 音调变慢 + 失真

> ID：10067117
> 
> 赞同：4
> 
> 时间：2012-04-08T22:36:39.150
> 
> 标签：ios, core-audio

所以我根据这里的一些帖子拼凑了一些录制音频的例程。我引用的帖子在[这里](https://stackoverflow.com/questions/8615358/can-anybody-help-me-in-recording-iphone-output-sound-through-audio-unit)和[这里](https://stackoverflow.com/questions/6930609/write-audio-to-disk-from-io-unit)，以及阅读他们引用的网站。

我的设置：我有一个现有的 AUGraph：（几个 AUSamplers -> Mixer -> RemoteIO）。AUSampler 连接到 MusicPlayer 实例中的轨道。一切正常，但我想添加录音。

录音工作正常，但生成的 .caf 音调/速度变慢 + 音质差。我指定的格式一定有问题吗？

有人可以关注这个并告诉我我在哪里设置格式不正确吗？

**编辑：**这可能是立体声/单声道问题吗？我的意思是单声道录音。

我将 RemoteIO 实例上的流格式设置为：

```
 AudioStreamBasicDescription audioFormat;

audioFormat.mSampleRate         = 44100.00;
audioFormat.mFormatID           = kAudioFormatLinearPCM;
audioFormat.mFormatFlags        = kAudioFormatFlagIsSignedInteger | kAudioFormatFlagIsPacked;
audioFormat.mFramesPerPacket    = 1;
audioFormat.mChannelsPerFrame   = 1;
audioFormat.mBitsPerChannel     = 16;
audioFormat.mBytesPerPacket     = 2;
audioFormat.mBytesPerFrame      = 2;

// Apply format
result = AudioUnitSetProperty(ioUnit, 
                              kAudioUnitProperty_StreamFormat, 
                              kAudioUnitScope_Output, 
                              kInputBus, 
                              &audioFormat, 
                              sizeof(audioFormat)); 
```

然后从一个按钮操作我创建一个 fileRef 并将一个 renderCallback 附加到 RemoteIO 实例：

```
- (void)startRecording
{

OSStatus result;

AudioStreamBasicDescription audioFormat;

audioFormat.mSampleRate         = 44100.00;
audioFormat.mFormatID           = kAudioFormatLinearPCM;
audioFormat.mFormatFlags        = kAudioFormatFlagIsSignedInteger | kAudioFormatFlagIsPacked;
audioFormat.mFramesPerPacket    = 1;
audioFormat.mChannelsPerFrame   = 1;
audioFormat.mBitsPerChannel     = 16;
audioFormat.mBytesPerPacket     = 2;
audioFormat.mBytesPerFrame      = 2;

NSArray  *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0];
NSString *destinationFilePath = [[NSString alloc] initWithFormat: @"%@/output.caf", documentsDirectory];
CFURLRef destinationURL = CFURLCreateWithFileSystemPath(kCFAllocatorDefault, 
                                                        (__bridge CFStringRef)destinationFilePath, 
                                                        kCFURLPOSIXPathStyle, 
                                                        false);

result = ExtAudioFileCreateWithURL(destinationURL, 
                                   kAudioFileWAVEType, 
                                   &audioFormat, 
                                   NULL, 
                                   kAudioFileFlags_EraseFile, 
                                   &extAudioFileRef);  

CFRelease(destinationURL);
NSAssert(result == noErr, @"Couldn't create file for writing");

result = ExtAudioFileSetProperty(extAudioFileRef, 
                                 kExtAudioFileProperty_ClientDataFormat, 
                                 sizeof(AudioStreamBasicDescription), 
                                 &audioFormat);

NSAssert(result == noErr, @"Couldn't create file for format");

result =  ExtAudioFileWriteAsync(extAudioFileRef, 0, NULL);
NSAssert(result == noErr, @"Couldn't initialize write buffers for audio file");   

printf("Adding render to remoteIO     \n");
result = AudioUnitAddRenderNotify(ioUnit, renderCallback, (__bridge void*)self);
if (result) {[self printErrorMessage: @"AudioUnitAddRenderNotify" withStatus: result]; return;}
 } 
```

最后，在我的 rendercallback 中，我在 postRender 阶段写出数据：

```
static OSStatus renderCallback (void *                       inRefCon,
                            AudioUnitRenderActionFlags * ioActionFlags,
                            const AudioTimeStamp *       inTimeStamp,
                            UInt32                       inBusNumber,
                            UInt32                       inNumberFrames,
                            AudioBufferList *            ioData) 
{

OSStatus result;
   if (*ioActionFlags == kAudioUnitRenderAction_PostRender){
    double timeInSeconds = inTimeStamp->mSampleTime / kSampleRate;
    printf("%fs inBusNumber: %lu inNumberFrames: %lu \n", timeInSeconds, inBusNumber, inNumberFrames);

    MusicPlayerController* THIS = (__bridge MusicPlayerController *)inRefCon;

   result =  ExtAudioFileWriteAsync(THIS->extAudioFileRef, inNumberFrames, ioData);
    if(result) printf("ExtAudioFileWriteAsync %ld \n", result);

  }

return noErr; 
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T15:42:07.627

好的 - 找到了一些解决这个问题的代码 - 虽然我不完全理解为什么。

我一直将`mBitsPerChannel`RemoteIO 输出流和 ExtFileRef 的值都设置为 16。结果放慢了速度和沙哑的音频。将 ExtFileRef 设置`mBitsPerChannel`为 32 并添加`kAudioFormatFlagsNativeEndian`标志可以解决问题：.caf 音频非常完美（同时将 RemoteIO 输出流设置保留为原来的设置）。

但也可以设置 RemoteIO 输出流设置以匹配我的新设置。所以我很困惑。只要`AudioStreamBasicDescription`RemoteIO 实例和 ExtFileRef 的设置是对称的，这不应该有效吗？

无论如何......工作设置如下。

```
size_t bytesPerSample = sizeof (AudioUnitSampleType);

AudioStreamBasicDescription audioFormat;
audioFormat.mSampleRate= graphSampleRate;
audioFormat.mFormatID=kAudioFormatLinearPCM;
audioFormat.mFormatFlags=kAudioFormatFlagsNativeEndian|kAudioFormatFlagIsSignedInteger|kAudioFormatFlagIsPacked;
audioFormat.mBytesPerPacket=bytesPerSample;
audioFormat.mBytesPerFrame=bytesPerSample;
audioFormat.mFramesPerPacket=1;
audioFormat.mChannelsPerFrame=1;
audioFormat.mBitsPerChannel= 8 * bytesPerSample;
audioFormat.mReserved=0; 
```

# algorithm - 如何计算分类错误率

> ID：10067118
> 
> 赞同：4
> 
> 时间：2012-04-08T22:36:51.293
> 
> 标签：algorithm, classification, cluster-analysis, confusion-matrix

好的。现在这个问题很难。我给你举个例子。

现在左边的数字是我的算法分类，右边的数字是原始的类号

```
177 86
177 86
177 86
177 86
177 86
177 86
177 86
177 86
177 86
177 89
177 89
177 89
177 89
177 89
177 89
177 89 
```

所以在这里我的算法将 2 个不同的类合并为 1 个。如您所见，它将 86 和 89 类合并为一个类。那么上面示例中的错误是什么？

或者这里是另一个例子

```
203 7
203 7
203 7
203 7
16 7
203 7
17 7
16 7
203 7 
```

在上面的例子中，左边的数字是我的算法分类，右边的数字是原始类 ID。如上所示，它错过了分类 3 种产品（我正在对相同的商业产品进行分类）。那么在这个例子中，错误率是多少？你会怎么计算。

这个问题非常困难和复杂。我们已经完成了分类，但我们无法找到计算成功率的正确算法：D

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T13:17:11.160

这是一个较长的示例，一个真正的混淆矩阵，具有 10 个输入类别“0”-“9”（手写数字）和 10 个标记为 A-J 的输出簇。

```
Confusion matrix for 5620 optdigits:

True 0 - 9 down, clusters A - J across
-----------------------------------------------------
      A    B    C    D    E    F    G    H    I    J
-----------------------------------------------------
0:    2         4         1       546    1
1:   71  249        11    1    6            228    5
2:   13    5        64    1   13    1       460
3:   29    2       507        20         5    9
4:        33  483         4   38         5    3    2
5:    1    1    2   58    3            480   13
6:    2    1    2       294         1         1  257
7:    1    5    1            546         6    7
8:  415   15    2    5    3   12        13   87    2
9:   46   72    2  357        35    1   47    2
----------------------------------------------------
    580  383  496 1002  307  670  549  557  810  266  estimates in each cluster

y class sizes: [554 571 557 572 568 558 558 566 554 562]
kmeans cluster sizes: [ 580  383  496 1002  307  670  549  557  810  266] 
```

例如，簇A有580个数据点，其中415个是“8”；簇 B 有 383 个数据点，其中 249 个是“1”；等等。

问题是输出类被打乱、排列；它们按此顺序对应，计数：

```
 A    B    C    D    E    F    G    H    I    J
      8    1    4    3    6    7    0    5    2    6
    415  249  483  507  294  546  546  480  460  257 
```

*可以*说“成功率”是 75 % = (415 + 249 + 483 + 507 + 294 + 546 + 546 + 480 + 460 + 257) / 5620但这
会丢掉有用的信息——在这里，E 和 J说“6”，没有集群说“9”。

因此，将混淆矩阵每一列中最大的数字相加，然后除以总数。
但是，如何计算重叠/缺失的簇，比如 2 个“6”，这里没有“9”？
我不知道一种普遍认可的方式（怀疑[匈牙利算法](http://en.wikipedia.org/wiki/Hungarian_algorithm) 是否在实践中使用）。

底线：不要丢弃信息；查看整个混淆矩阵。

NB这样的“成功率”会看好新数据！
通常将数据分成 2/3 的“训练集”和 1/3 的“测试集”，仅在 2/3 上训练例如 k-means，
然后在测试集上测量混淆/成功率——通常比仅在训练集上。
可以说的更多；参见例如 [交叉验证](http://en.wikipedia.org/wiki/Cross-validation_%28statistics%29)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-08T22:50:04.303

如果你想评估算法的性能，你必须定义错误标准，所以我不确定你到底在问什么。在某些聚类和机器学习算法中，您可以定义错误度量并将其最小化。

看看这个 [https://en.wikipedia.org/wiki/Confusion_matrix](https://en.wikipedia.org/wiki/Confusion_matrix) 以获得一些想法

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-08T23:08:18.740

您必须定义一个错误指标来衡量自己。在您的情况下，一个简单的方法应该是找到您的产品的属性映射为

```
p = properties(id) 
```

其中`id`是产品 id，并且`p`很可能是具有不同属性的每个条目的向量。然后您可以将两个产品之间的误差函数`e`（或距离）定义为

```
e = d(p1, p2) 
```

当然，每个属性都必须在此函数中计算为一个数字。然后这个误差函数可以用于分类算法和学习。

在您的第二个示例中，您似乎将 (203 7) 对视为成功分类，因此我认为您自己已经有了一个指标。您可能会更具体以获得更好的答案。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2014-11-18T21:07:24.457

分类错误率 (CER) 为 1 - 纯度 ( [http://nlp.stanford.edu/IR-book/html/htmledition/evaluation-of-clustering-1.html](http://nlp.stanford.edu/IR-book/html/htmledition/evaluation-of-clustering-1.html) )

```
ClusterPurity <- function(clusters, classes) {
    sum(apply(table(classes, clusters), 2, max)) / length(clusters)
} 
```

@john-colby 的代码或

```
CER <- function(clusters, classes) {
    1- sum(apply(table(classes, clusters), 2, max)) / length(clusters)
} 
```

# matlab - MATLAB如何保存图像？

> ID：10067119
> 
> 赞同：4
> 
> 时间：2012-04-08T22:37:00.817
> 
> 标签：matlab, autosave

我尝试了以下命令：

```
 imshow(originalImage);
 imsave; 
```

它可以工作，但我希望 matlab 自动将图像保存为 bmp 格式（在当前文件夹中）。我尝试使用：

```
 save('myimage.bmp','originalImage'); 
```

图片已保存，但在图片本身而不是图片上，我看到了以下消息：“Windows 照片查看器无法打开此图片，因为文件似乎已损坏、损坏或太大”。（图片大小为5kb）。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-08T22:40:40.950

使用该功能`imwrite`来做到这一点：

```
imwrite(image_matrix, 'myimage.bmp', 'bmp') 
```

[imwrite 关于 mathworks 的文档](http://www.mathworks.com/help/techdoc/ref/imwrite.html)

# c++ - C++：文件与自身冲突

> ID：10067129
> 
> 赞同：0
> 
> 时间：2012-04-08T22:38:27.043
> 
> 标签：c++, file, header, include, conflict

我创建了自定义随机数生成器，并将它们的全局函数放在一个名为 SamRandom.h 的文件中。该文件如下所示：

```
#ifndef _SAM_RANDOM_H
#define _SAM_RANDOM_H

#include <cstdlib>
#include <ctime>

void InitialiseRandomSeed()
{
    //...
}

//...

#endif 
```

我正在一个非常复杂的面向对象程序中工作，该程序具有许多不同的组件。每次我添加一个无论如何都与该文件相关的文件时，我都会收到以下冲突消息：

```
LaserBase.obj:-1: error: LNK2005: "void __cdecl InitialiseRandomSeed(void)" (?InitialiseRandomSeed@@YAXXZ) already defined in main.obj
error: LNK1169: one or more multiply defined symbols found 
```

在 MSVC 和 MinGW 上，我得到：

```
In function `Z20InitialiseRandomSeedv':
SamRandom.h:8: multiple definition of `InitialiseRandomSeed()'
error: first defined here
:-1: error: collect2: ld returned 1 exit status 
```

为什么会这样？我认为预处理器指令应该防止这个问题发生......这真的让我发疯了！

PS：问题与函数名无关。

感谢您的任何努力

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-08T22:46:47.737

当您将文件包含在 .cpp 文件中时，预处理器会直接将其复制到该文件中。因此，当您编译该 .cpp 文件时，目标文件（即使您不认识，编译器也会执行此步骤）将包含该函数。如果您将它包含在多个 .cpp 文件中，则每个目标文件都将包含该函数。当链接器尝试将所有目标文件链接到可执行文件时，它会找到函数 x 次并给出该错误。“找到一个或多个多重定义的符号”表示它不止一次地找到了您的一个函数（或变量）并且不知道如何处理它。

为了避免这种情况，您应该只放置您的功能签名，例如

```
//whatever.h
#ifndef _SAM_RANDOM_H
#define _SAM_RANDOM_H

void InitialiseRandomSeed();

#endif 
```

在头文件中并将实现放入单独的 .cpp 文件中：

```
//whatever.cpp
#include "whatever.h"
#include <cstdlib>
#include <ctime>

void InitialiseRandomSeed()
{
    //...
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-08T22:54:02.120

标头保护确保函数不会在单个编译单元（.cpp 文件）中多次定义。但是，它们不会阻止函数在多个编译单元中被定义一次。这是因为 header 包含函数的定义，所以每个包含 header 的 .cpp 都有自己的函数定义。

您可以将定义移动到 SamRandom.cpp 并改为在标头中声明函数，如下所示：

```
void InitialiseRandomSeed(); 
```

或者，您可以指定该函数是内联的，这将使多个定义可接受：

```
inline void InitialiseRandomSeed()
{
    //...
} 
```

假设该函数不是性能关键的并且不会被频繁调用，我会采用前一种方法。这使标头更具可读性，并且（通常）减少了编译时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-08T22:43:21.833

您可以将定义分离到一个 .cpp 文件中，然后在标头中声明该函数。

# ruby-on-rails - 在 Rails 中，使用 Mongoid，如何找到所有具有有效（非零）has_one 引用的模型？

> ID：10067139
> 
> 赞同：8
> 
> 时间：2012-04-08T22:39:24.940
> 
> 标签：ruby-on-rails, mongoid, has-one

所以我有两个这样的模型

```
class ModelParent
  include Mongoid::Document
  field :name, :type => String
  has_one :model_child
end

class ModelChild
  include Mongoid::Document
  field :name, :type => String
  belongs_to :model_parent
end 
```

假设我在 rails 控制台中有一个名为 mp 的 ModelParent 持久实例

```
mc = mp.create_model_child(:name=>"child") 
```

然后做

```
mp.model_child 
```

它返回一个有效的对象

但是，如果我像这样搜索它：

```
ModelParent.where(:model_child.ne => nil).length 
```

它返回 0

我已经尝试创建model_child，然后分配它，也使用build_model_child（），并且每个方法都显示model_child清楚地在父级中，但是查询not nil（.ne）无法找到所有有孩子的ModelParents。

我究竟做错了什么？

更新：

回答我自己的问题。我仍然不确定为什么 :model_child.ne => nil 不起作用，但是......

我通过编写如下代码解决了这个问题：

```
 def self.with_child
    user_ids = ModelChild.all.only(:model_parent_id).map(&:model_parent_id)
    return ModelParent.where(:_id.in => user_ids).all
  end 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-09T10:15:43.703

它不起作用，因为外键存储在属于关系的一侧。因此，在您的案例中，`ModelChild`集合将有一个字段`model_parent_id`，而不是相反。我想你已经想通了，但不是像你那样解决它，我建议你切换`has_one`and`belongs_to`关联，然后使用：

```
 ModelParent.where(:model_child_id.ne => nil) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-12T12:37:59.433

我找到了另一种方法，但我不知道效率更高还是更低：您可以使用拒绝方法。例如：

```
ModelParent.all.reject{ |r| r.model_child.nil?} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-12T22:46:39.943

在这种情况下，我不会依赖 .ne，我发现 .ne 方法并不总是有效：例如，尝试放置一个名为“false”的字符串并尝试使用 .ne 搜索它；-)

我发现对于这种情况，可靠地找到合适模型的最佳方法是按本机 Mongo 过滤**`$type`**

```
ModelParent.where(:model_child_id => { :$type => 7 }) 
```

在已知类型列表下方，发现查找格式错误的字段效率更高

*   双1
*   字符串 2
*   对象 3
*   阵列 4
*   二进制数据 5
*   未定义（已弃用） 6
*   **对象 ID 7**
*   布尔值 8
*   日期 9
*   空 10
*   正则表达式 11
*   JavaScript 13
*   符号 14
*   JavaScript（带作用域） 15
*   32 位整数 16
*   时间戳 17
*   64 位整数 18
*   最小键 255
*   最大键 127

# c - 整数列表的 C 语言中的 ADT 实现

> ID：10067147
> 
> 赞同：0
> 
> 时间：2012-04-08T22:40:31.443
> 
> 标签：c, abstract-data-type

我需要在 VC++ 中做一个 home assignment，它使用 ADT 在一个整数列表上做几个操作。目前，我们不允许使用类，所以我需要使用`struct`.

我不太了解 ADT 是如何工作的，所以我不确定从哪里开始，因为互联网上的所有教程都使用类，我不想这样做。

那么网上是否有任何教程：1.解释抽象数据类型的概念和2.提供实现示例（最好用C++而不是使用`class`，`struct`而是）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T23:01:49.350

我会尝试一个更符合我理解的答案。

1.  什么是抽象数据类型？总是我的第一枪：看看[http://en.wikipedia.org/wiki/Abstract_data_type](http://en.wikipedia.org/wiki/Abstract_data_type)

我对此的“实际”理解是：有一些由对象、其变量（或数据）以及在该对象上定义的操作定义的对象的概念。对于您的情况，对象是整​​数列表。操作类似于`insert a new integer`、`remove an integer`等`get the number of integers stored in the list`。实现此数据类型时，您必须将此操作编写为函数。要提供此功能，您必须构建一些结构来保存要操作的数据。

1.  提供一个实施的例子。

好吧，我不会做你的作业，所以我会做一些伪代码：

```
struct ListElement {
   int value;
   type NextElement; //i leave the type to you
};

void insertBehind(ListElement &element, int newValue)//this is one way to do this
{
  ListElement newElement(newValue); //create the new element (use new instead, don't want to "spoiler" the type to you)
  newElement.nextElement = element.nextElement; //set the next element of this new one
  element.NextElement = newElement; //set the new element
}

... 
```

# php - 使用 opendir 列出父目录的文件夹不起作用

> ID：10067152
> 
> 赞同：0
> 
> 时间：2012-04-08T22:41:18.960
> 
> 标签：php, parent, opendir

以下脚本适用于当前目录：

```
<?php    
$ignore = array ('.', '..', '.DS_Store', 'index.php');
    $num_ordnernamen = array ();
    if ($handle = opendir('./')) {
    while (false !== ($entry = readdir($handle))) {
        if (!in_array($entry, $ignore) && is_dir($entry)) {
        array_push($num_ordnernamen, $entry);
        }
    }
    }
    print_r ($num_ordnernamen); 
?> 
```

，它按应有的方式返回数组：

```
Array ( [0] => firstfolder [1] => secondfolder ) 
```

但是，它确实不适用于

```
if ($handle = opendir('../')) //or
if ($handle = opendir('..')) //or
if ($handle = opendir('../..')) 
```

……或者其他任何我试图提升一级的东西。我在这里想念什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-08T23:03:33.863

*   您是否有权读取父目录？
*   你有错误报告活动吗？
*   您的父目录中有目录吗？（您的代码仅打印目录）

# c# - 两个线程调用同一个方法时线程同步的困惑

> ID：10067158
> 
> 赞同：0
> 
> 时间：2012-04-08T22:43:51.533
> 
> 标签：c#, asynchronous, synchronization, blocking, messenger

我创建了一个 Messenger 库，并使其成为线程安全的，因此它可以在线程之间共享而无需担心。我主要使用 Monitor 类来实现这一点。

我有一个 Logout 例程，它可能需要一些时间才能完成，因为它会在关闭套接字等之前尝试等待事务发生。它是异步的并且具有 Begin/End 方法，但对于这个示例，我们将假装它是同步的。

如果两个线程一个接一个地调用 Logout 怎么办？我应该用第二个线程做什么？

目前我阻塞（使用 Monitor.Wait 等待来自第一个线程的脉冲）直到第一次注销完成，然后抛出 AlreadyLoggedOutException。

如果调用 Logout 但已经发生注销，我还玩弄了一个 LogoutInProgress 异常。

两者似乎都有优点和缺点，但我想知道其他人认为什么是最好的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-08T22:53:19.310

您提到的两个中最好的选择是什么，取决于您希望库的行为方式。

我不会向消费者抛出异常，而只是在实际注销完成时为两个线程触发结束注销异步事件/方法。您应该使用哪种同步原语来实现这一点取决于您的方法/库的设计。也许如果您分享有关您提到的 Begin End 方法的更多详细信息，我将能够提出更好的建议。

这个选项会更容易编程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-08T23:45:43.233

还有第三个选项：尝试注销的第二个线程可以检测到，注销已经发生并且什么也不做。如果“注销”的约定是“要么确保用户注销，要么抛出”，那么您确实应该使注销具有幂等性。

但是，如果您不能容忍多次注销，因为这将是一个逻辑错误，您应该抛出异常。

# android - 新手Android架构查询

> ID：10067161
> 
> 赞同：0
> 
> 时间：2012-04-08T22:43:58.287
> 
> 标签：android

我是一名 C# Windows Phone 7 开发人员，希望将一些应用程序移植到 Android 上，而且我对 Java 和 android 都是新手......

我已经完成了 Android 应用程序基础知识，并开发了一些“查看”应用程序示例，并且有几个问题......

1 - 在 WP7 中，当我们的应用程序未运行时，我们可以在“后台”运行代码。操作系统每半小时左右唤醒一次我们的后台程序，这样我们就可以快速完成一些任务。这是如何在 Android 中完成的？

2 - 在 WP7 中，我们可以将信息发布到我们的“Tiles”，例如，用户可以通过查看手机来查看特定距离内的朋友数量。我知道 Android 没有“磁贴”，但我们可以发布应用程序图标的信息吗？或类似的东西？

显然，我必须先能够做到#1，然后才能做到#2

谢谢，加里

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-08T22:51:47.133

对于第一个问题，请查看[AlarmManager](http://developer.android.com/reference/android/app/AlarmManager.html)。您可以将其设置为定期调用您的代码来完成一些工作。您甚至可以告诉它唤醒/不唤醒待机状态的手机来​​完成您的工作。因此，例如，如果您的应用正在更新天气信息，您可以选择不唤醒手机来执行此操作（因为用户无论如何都不会看到更新）并节省电池电量。

其次，为了在 Android 上提供一目了然的信息，您可以使用用户可以根据需要将其添加到主屏幕的[小部件。](http://developer.android.com/guide/topics/appwidgets/index.html)您可以将它们视为一种特殊的视图。

# arrays - 数组中的差异总和

> ID：10067163
> 
> 赞同：4
> 
> 时间：2012-04-08T22:44:25.200
> 
> 标签：arrays, performance, algorithm, complexity-theory

有没有更有效的方法来实现这一点：给定一个`A`大小数组`n`和两个正整数`a`和`b`，找到`floor(abs(A[i]-A[j])*a/b)`所有对的总和，`(i, j)`其中`0 <= i < j < n`。

```
int A[n];
int a, b; // assigned some positive integer values
...
int total = 0;
for (int i = 0; i < n; i++) {
    for (int j = i+1; j < n; j++) {
        total += abs(A[i]-A[j])*a/b; // want integer division here
    }
} 
```

为了稍微优化这一点，我对数组 ( `O(nlogn)`) 进行了排序，然后没有使用`abs`函数。此外，我在内部 for 循环之前缓存了该值`a[i]`，因此我可以`A`按顺序读取内容。我正在考虑预先计算`a/b`并将其存储在一个浮点数中，但是额外的转换只会让它变慢（特别是因为我想占用结果的地板）。

我想不出比`O(n^2)`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T12:52:54.083

是的，有一个更有效的算法。它可以在 O(n*log n) 中完成。我不希望有一种渐近更快的方法，但我对证明的想法还很遥远。

## 算法

首先在 O(n*log n) 时间内对数组进行排序。

现在，让我们看看条款

```
floor((A[j]-A[i])*a/b) = floor ((A[j]*a - A[i]*a)/b) 
```

为`0 <= i < j < n`. 对于每一个`0 <= k < n`，写`A[k]*a = q[k]*b + r[k]`上`0 <= r[k] < b`。

对于`A[k] >= 0`，我们有`q[k] = (A[k]*a)/b`和`r[k] = (A[k]*a)%b`整数除法，对于`A[k] < 0`，我们有`q[k] = (A[k]*a)/b - 1`和`r[k] = b + (A[k]*a)%b`除非`b`除法，`A[k]*a`在这种情况下，我们有`q[k] = (A[k]*a)/b`和`r[k] = 0`。

现在我们重写条款：

```
floor((A[j]*a - A[i]*a)/b) = floor(q[j] - q[i] + (r[j] - r[i])/b)
                           = q[j] - q[i] + floor((r[j] - r[i])/b) 
```

每个`q[k]`出现`k`次数为正号 (for `i = 0, 1, .. , k-1`) 和`n-1-k`次数为负号 (for `j = k+1, k+2, ..., n-1`)，因此其对总和的总贡献为

```
(k - (n-1-k))*q[k] = (2*k+1-n)*q[k] 
```

其余部分仍需计算。现在，因为`0 <= r[k] < b`，我们有

```
-b < r[j] - r[i] < b 
```

并且`floor((r[j]-r[i])/b)`是 0 时`r[j] >= r[i]`和`-1`时`r[j] < r[i]`。所以

```
 n-1
 ∑ floor((A[j]-A[i])*a/b) =  ∑ (2*k+1-n)*q[k] - inversions(r)
i<j                         k=0 
```

其中一个*反转*是一对具有和`(i,j)`的索引。`0 <= i < j < n``r[j] < r[i]`

计算`q[k]`和`r[k]`求和`(2*k+1-n)*q[k]`是在 O(n) 时间内完成的。

它仍然有效地计算`r[k]`数组的反转。

对于每个索引`0 <= k < n`，让`c(k)`是`i < k`这样的数量`r[k] < r[i]`，即`k`作为较大索引出现的反转次数。

那么显然反转的次数是`∑ c(k)`。

另一方面，是在稳定排序`c(k)`中被移到后面的元素的数量（稳定性在这里很重要）。`r[k]`

计算这些移动，因此数组的反转很容易在合并排序时完成。

因此，反演也可以计算在 O(n*log n) 中，给出 O(n*log n) 的整体复杂度。

## 代码

具有简单不科学基准的示例实现（但朴素二次算法与上述算法之间的差异如此之大，以至于不科学的基准足以决定性）。

```
#include <stdlib.h>
#include <stdio.h>
#include <time.h>

long long mergesort(int *arr, unsigned elems);
long long merge(int *arr, unsigned elems, int *scratch);
long long nosort(int *arr, unsigned elems, long long a, long long b);
long long withsort(int *arr, unsigned elems, long long a, long long b);

int main(int argc, char *argv[]) {
    unsigned count = (argc > 1) ? strtoul(argv[1],NULL,0) : 1000;
    srand(time(NULL)+count);
    long long a, b;
    b = 1000 + 9000.0*rand()/(RAND_MAX+1.0);
    a = b/3 + (b-b/3)*1.0*rand()/(RAND_MAX + 1.0);
    int *arr1, *arr2;
    arr1 = malloc(count*sizeof *arr1);
    arr2 = malloc(count*sizeof *arr2);
    if (!arr1 || !arr2) {
        fprintf(stderr,"Allocation failed\n");
        exit(EXIT_FAILURE);
    }
    unsigned i;
    for(i = 0; i < count; ++i) {
        arr1[i] = 20000.0*rand()/(RAND_MAX + 1.0) - 2000;
    }
    for(i = 0; i < count; ++i) {
        arr2[i] = arr1[i];
    }
    long long res1, res2;
    double start = clock();
    res1 = nosort(arr1,count,a,b);
    double stop = clock();
    printf("Naive:   %lld in %.3fs\n",res1,(stop-start)/CLOCKS_PER_SEC);
    start = clock();
    res2 = withsort(arr2,count,a,b);
    stop = clock();
    printf("Sorting: %lld in %.3fs\n",res2,(stop-start)/CLOCKS_PER_SEC);
    return EXIT_SUCCESS;
}

long long nosort(int *arr, unsigned elems, long long a, long long b) {
    long long total = 0;
    unsigned i, j;
    long long m;
    for(i = 0; i < elems-1; ++i) {
        m = arr[i];
        for(j = i+1; j < elems; ++j) {
            long long d = (arr[j] < m) ? (m-arr[j]) : (arr[j]-m);
            total += (d*a)/b;
        }
    }
    return total;
}

long long withsort(int *arr, unsigned elems, long long a, long long b) {
    long long total = 0;
    unsigned i;
    mergesort(arr,elems);
    for(i = 0; i < elems; ++i) {
        long long q, r;
        q = (arr[i]*a)/b;
        r = (arr[i]*a)%b;
        if (r < 0) {
            r += b;
            q -= 1;
        }
        total += (2*i+1LL-elems)*q;
        arr[i] = (int)r;
    }
    total -= mergesort(arr,elems);
    return total;
}

long long mergesort(int *arr, unsigned elems) {
    if (elems < 2) return 0;
    int *scratch = malloc((elems + 1)/2*sizeof *scratch);
    if (!scratch) {
        fprintf(stderr,"Alloc failure\n");
        exit(EXIT_FAILURE);
    }
    return merge(arr, elems, scratch);
}

long long merge(int *arr, unsigned elems, int *scratch) {
    if (elems < 2) return 0;
    unsigned left = (elems + 1)/2, right = elems-left, i, j, k;
    long long inversions = 0;
    inversions += merge(arr, left, scratch);
    inversions += merge(arr+left,right,scratch);
    if (arr[left] < arr[left-1]) {
        for(i = 0; i < left; ++i) {
            scratch[i] = arr[i];
        }
        i = 0; j = 0; k = 0;
        int *lptr = scratch, *rptr = arr+left;
        while(i < left && j < right) {
            if (rptr[j] < lptr[i]) {
                arr[k++] = rptr[j++];
                inversions += (left-i);
            } else {
                arr[k++] = lptr[i++];
            }
        }
        while(i < left) arr[k++] = lptr[i++];
    }
    return inversions;
} 
```

# android - 在eclipse中将jar移动到libs文件夹

> ID：10067164
> 
> 赞同：1
> 
> 时间：2012-04-08T22:44:47.947
> 
> 标签：android, adt

在新的 ADT 17 之后，我试图将导入的 jar 文件从“引用库”移动到“库”。好像我做错了什么。我创建了一个新的（常规）文件夹并将其命名为“libs”。当我尝试拖动/复制粘贴 jar 时，它显示“无法将剪贴板内容粘贴到所选元素中”。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-08T22:57:21.977

就像一个想法。不要使用 Eclipse 来复制文件。使用我们的文件浏览器复制它们。完成后转到 Eclipse，单击项目的根目录并按 F5。

# spring-data - 在 Spring Repository 接口中使用 sort() 和 limit() 进行查询

> ID：10067169
> 
> 赞同：22
> 
> 时间：2012-04-08T22:45:25.760
> 
> 标签：spring-data, mongodb-java

我是 MongoDB 的 Spring Data 新手，希望在我的 MongoRepository 扩展接口中有一个自动生成的查询方法，需要过滤、排序和限制。

查询如下所示：

```
// 'created' is the field I need to sort against

find({state:'ACTIVE'}).sort({created:-1}).limit(1) 
```

存储库界面如下所示：

```
public interface JobRepository extends MongoRepository<Job, String> {
    @Query("{ state: 'ACTIVE', userId: ?0 }")
    List<Job> findActiveByUserId(String userId);

    // The next line is the problem, it wont work since
    // it's not in the format @Query expects
    @Query("find({state:'ACTIVE'}).sort({created:-1}).limit(1)")
    Job findOneActiveOldest();

    ...
} 
```

我知道可以将 Sort 参数添加到查询方法中以进行排序，但问题是将结果限制为单个对象。这是否可以在不必编写自定义 JobRepositoryImpl 的情况下完成？

谢谢

编辑：

我正在寻找的示例：

```
@Query("{ state:'ACTIVE', $orderby: {created:-1}, $limit:1 }")
Job findOneActiveOldest(); 
```

或者

```
@Query("{ state:'ACTIVE' }")
@Sort("{ created:-1 }")
@Limit(1)
Job findOneActiveOldest(); 
```

但这显然不起作用:(

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-04-09T18:02:20.880

有什么问题：

```
public interface JobRepository extends MongoRepository<Job, String> {

  @Query("{ state : 'ACTIVE' }")
  Page<Job> findOneActiveOldest(Pageable pageable);
} 
```

并使用它：

```
// Keep that in a constant if it stays the same
PageRequest request = new PageRequest(0, 1, new Sort(Sort.Direction.DESC, "created"));
Job job = repository.findOneActiveOldest(request).getContent().get(0); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-07-30T14:23:30.680

只需对 Oliver 的答案进行更正，它是`Direction.DESC`和不是`Directions.DESC`，并且参数的顺序是错误的。

改变 ：

```
PageRequest request = new PageRequest(0, 1, new Sort("created", Directions.DESC)); 
```

到：

```
PageRequest request = new PageRequest(0, 1, new Sort(Direction.DESC, "created")); 
```

# python - 在 Django 中检查 M2M 关系中的多个值

> ID：10067171
> 
> 赞同：0
> 
> 时间：2012-04-08T22:45:45.980
> 
> 标签：python, django, django-models, django-views, django-queryset

在英语中，我想检查用户的类型是查看者、版主还是管理员。

这是我的相关部分`models.py`

```
class UserType( models.Model ) :
    name = models.CharField( max_length = 135 )

    # id |       name
    #----+------------------
    #  1 | tenant
    #  2 | property manager
    #  3 | property owner
    #  4 | vendor manager
    #  5 | vendor
    #  6 | viewer
    #  7 | moderator
    #  8 | administrator

class UserProfile( models.Model ) :
    user       = models.OneToOneField( User )
    user_types = models.ManyToManyField( UserType, null = True, blank = True ) 
```

顺便说一句，我设置`user.profile`为与`user.get_profile()`.

在我的`views.py`代码中，我想做检查。我发现

```
[ user_type.pk for user_type in user.profile.user_types.all() ] 
```

会给我一个`pk`'s for the `user`'s的列表`user_type`，就像这样`[ 1, 2, 6 ]`。这意味着该特定用户是租户 (1)、物业经理 (2) 和查看者 (6)。

如果我只想检查一个`user_type`，那么我可以简单地做

```
if 6 in [ user_type.pk for user_type in user.profile.user_types.all() ] :
    # This user is a viewer 
```

但是如何检查多个 user_types/pks？我想做类似的事情

```
# This won't work
if [ 6, 7, 8 ] in [ user_type.pk for user_type in user.profile.user_types.all() ] :
    # This user is either a viewer, moderator, or administrator 
```

我的列表理解方法也是检查`user_types`Django**方式**吗？看起来不像，但我不知道如何在 Django 中*干净地查询它。*

欢迎任何提示和建议。提前致谢！

**编辑：**

我刚刚发现我可以用更多的 Django 方式列出 pks[`values_list`](https://docs.djangoproject.com/en/dev/ref/models/querysets/#values-list)

```
user_types = user.profile.user_types.values_list( 'pk', flat = True )
# [ 1, 2, 6 ] 
```

我还发现我*可以*像这样检查多个值

```
if len( set( [ 1, 9 ] ).intersection( set( user_types ) ) )
    # True because of 1 is in user_types (don't care about 9)

if len( set( [ 4, 99 ] ).intersection( set( user_types ) ) )
    # False because 4 nor 99 is in user_types 
```

但即使这种`set`方法似乎也不是对 Django 非常友好。一定有更简单的方法吧？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T00:24:57.457

只需这样做：

```
def has_roles(user, roles):
    return user.profile.user_types.filter(pk__in=roles).count() == len(roles)

print has_roles(user, [6,7,8]) 
```

PS 我会回避使用硬编码的 PK ID 号码作为您的标识符。太多的事情可能会出错。而是在运行时定义映射并按名称引用它们。多方面会有所改善：

*   您的代码将更容易阅读
*   Django将第一个项目卸载模型实例匹配到数据库
*   从那时起，您可以缓存 ID 而无需再次询问数据库

然后你可以这样做：

```
class UserType( models.Model ):
    TYPES = (( 'tenant', 'Tenant'),
             ( 'propman', 'Property Manager'),
             ( 'propown', 'Property Owner'),
             ( 'vendman', 'Vendor Manager'),
             ( 'vendor', 'Vendor'),
             ( 'viewer', 'Viewer'),
             ( 'moderator', 'Moderator'),
             ( 'admin', 'Administrator'))

    name = models.CharField( max_length = 135, choices=TYPES )

def has_role(user, role):
    return user.profile.user_types.filter(name=role).count() == 1

def has_roles(user, roles):
    return user.profile.user_types.filter(name__in=roles).count() == len(roles)

print has_roles(user, ['viewer','moderator','admin']) 
```

最后，您可以将上面的两个函数添加到：

```
class UserProfile( models.Model ) :
    user       = models.OneToOneField( User )
    user_types = models.ManyToManyField( UserType, null = True, blank = True )

    def has_role(self, role):
        return self.user_types.filter(name=role).count() == 1

    def has_roles(self, roles):
        return self.user_types.filter(name__in=roles).count() == len(roles) 
```

然后在将来像这样使用它：

```
u = User.objects.get(username='me')
if u.userprofile.has_role('admin'):
    print 'I have the powah!' 
```

# backbone.js - 学习单元测试和 Jasmine

> ID：10067175
> 
> 赞同：4
> 
> 时间：2012-04-08T22:46:32.513
> 
> 标签：backbone.js, tdd, bdd, jasmine, sinon

我是前端开发人员，是 TDD 和 BDD 的新手。

我有这个任务。使用从 AJAX 调用接收到的 json 对象填充表。我将如何在套件和规范中描述这一点？

提前致谢

**编辑**

我将 BackboneJS 用于 MVC，将 sinon.js 用于间谍、存根等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T11:01:49.797

你没有提到很多关于你使用的库，所以我将继续假设你的 ajax 请求由使用 jQuery 的 GET 请求组成。

通常这会是这样的：

```
$.ajax({
    url: 'http://server/populate_table',
    data: {foo: 'bar'},
    success: populate_table
}); 
```

此外，我将假设服务器将返回以下对象`{row: [1, 2, 3]}` 。对于初学者，您需要模拟 ajax 响应，因为您不想依赖可用的服务器。可以通过使用*间谍*来实现模拟，检查参数和虚假返回数据：

```
var ajaxMock = spyOn($, 'ajax').andCallFake(function (options) {
    expect(options.url).toEqual('http://server/populate_table');
    expect(options.data.foo).toEqual('bar');
    options.success({row: [1, 2, 3]};
}); 
```

请注意，您在上面如何定义在调用带有结果的回调之前服务器应该接收的 url 和数据的期望。

最后，您需要查看您的表是否已填充。您没有提供有关数据或表格的任何信息，但再次猜测您使用 jQuery，您应该尝试[jasmine-jquery](http://github.com/velesin/jasmine-jquery)。有了它，您可以轻松地描述对 DOM 的期望，查看扩展文档。一旦确定了要测试的内容，您的完整测试将类似于：

```
it('populates the table making a JSON call', function () {
    var ajaxMock = spyOn($, 'ajax').andCallFake(function (options) {
        expect(options.url).toEqual('http://server/populate_table');
        expect(options.data.foo).toEqual('bar');
        options.success({row: [1, 2, 3]};
    });  

    $.ajax({
        url: 'http://server/populate_table',
        data: {foo: 'bar'},
        success: populate_table
    });

    expect($('#mytable')).toExist();
    // DOM specific expectations go here...

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-08T22:59:13.817

您想查看jasmine 中内置的[异步测试工具。](https://github.com/pivotal/jasmine/wiki/Asynchronous-specs)

具体`waitFor`和`run`。

快速解释一下：您可以运行 Ajax 查询并让它在成功时返回 true。您等待该功能，然后运行您的测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T13:10:02.600

由于您已经在使用 sinon.js，我认为最好的方法是使用 fakeServer 来测试从 ajax 调用接收到的对象。这里有很好的描述（假 Ajax 和假服务器部分）：

[http://tinnedfruit.com/2011/03/03/testing-backbone-apps-with-jasmine-sinon.html](http://tinnedfruit.com/2011/03/03/testing-backbone-apps-with-jasmine-sinon.html)

# java - Java：将二进制数位0更改为1，将1更改为0

> ID：10067176
> 
> 赞同：1
> 
> 时间：2012-04-08T22:46:43.433
> 
> 标签：java

我想知道您将如何更改二进制数并反转 1 和 0？我已经知道如何将整数转换为二进制

```
Example 1: 5 as a parameter would return 2
Steps: 5 as a binary is 101
          The complement is 010
          010 as an integer is 2 
```

将整数更改为二进制数的代码

```
import java.io.*;
public class DecimalToBinary{
  public static void main(String args[]) throws IOException{
  BufferedReader bf = new BufferedReader(new InputStreamReader(System.in));
  System.out.print("Enter the decimal value:");
  String hex = bf.readLine();

  int i = Integer.parseInt(hex);  

  String bynumber = Integer.toBinaryString(i);

  System.out.println("Binary: " + bynumber);
  }
} 
```

如果有人代码请帮忙，谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-08T22:48:32.040

您不需要将其显式转换为二进制。您可以为此使用[**按位运算符**](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/op3.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-08T22:48:51.373

使用按位非函数`~`。

```
int num = 0b10101010;
System.out.println(Integer.toBinaryString(num));         // 10101010
System.out.println(Integer.toBinaryString((byte) ~num)); //  1010101 (note the absent leading zero) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-08T22:51:30.327

```
int i = Integer.parseInt(numString);
i = ~i; 
```

那应该这样做。

# java - 从网格断开线

> ID：10067178
> 
> 赞同：0
> 
> 时间：2012-04-08T22:46:55.707
> 
> 标签：java, loops, grid, awt, paint

网格看起来像这样。 [http://a4.sphotos.ak.fbcdn.net/hphotos-ak-prn1/s320x320/532063_426018057411895_100000111130260_1879195_1266764275_n.jpg](http://a4.sphotos.ak.fbcdn.net/hphotos-ak-prn1/s320x320/532063_426018057411895_100000111130260_1879195_1266764275_n.jpg)

我在循环中插入了 if 语句来绘制线条以换行。但是，程序的功能就好像 if 语句不存在一样。if 语句还不够吗？

```
import java.awt.*;
import java.awt.Color;
import java.awt.Component;
import java.awt.Graphics;
import javax.swing.*;

public class Grid extends Canvas{

    Cell[][] maze;
    int rows;
    int cols;
    int pathSize;
    double width, height;

    public Grid(int rows, int cols, int h, int w) {
        this.rows = rows;
        this.cols = cols;
        maze = new Cell[rows][cols];
        setPreferredSize(new Dimension(h,w));
    }

    public static void main(String[] args){
    JFrame y = new JFrame();
    y.setLayout(new BorderLayout());
    Grid f = new Grid(25,25,400,400);
    y.add(f, BorderLayout.CENTER);
    y.setSize(450,450);
    y.setVisible(true);
    y.setDefaultCloseOperation(y.EXIT_ON_CLOSE);

    }
    public void paint(Graphics g) {
        int k,j,z=0;
        width = getSize().width;
        height = getSize().height;

        double htOfRow = height / (rows);
        for (k = 0; k < rows; k++)
            for(j=0; j< rows+1; j++){
            if(j!=3){
            g.drawLine(z, (int) (k * htOfRow) , (int) (j*(width/rows)) , (int) (k * htOfRow) );
            z=(int)(j*(width/rows));
            }}
        double wdOfRow = width / (cols);
        for (k = 0; k < cols; k++)
            for(j=0; j< cols+1; j++){
            if(j!=3){
            g.drawLine((int) (k*wdOfRow) , z,(int) (k*wdOfRow) , (int) (j*(height/cols)));
            z=(int)(j*(height/cols));}}
        }
}

class Cell{} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T23:02:53.703

您的绘图循环中有一些逻辑错误。我认为这应该有效：

```
import java.awt.*;
import java.awt.Color;
import java.awt.Component;
import java.awt.Graphics;
import javax.swing.*;

public class Grid extends Canvas {

    Cell[][] maze;
    int rows;
    int cols;
    int pathSize;
    double width, height;

    public Grid(int rows, int cols, int h, int w) {
        this.rows = rows;
        this.cols = cols;
        maze = new Cell[rows][cols];
        setPreferredSize(new Dimension(h, w));
    }

    public static void main(String[] args) {
        JFrame y = new JFrame();
        y.setLayout(new BorderLayout());
        Grid f = new Grid(40, 25, 400, 400);
        y.add(f, BorderLayout.CENTER);
        y.setSize(450, 450);
        y.setVisible(true);

    }

    public void paint(Graphics g) {
        int k, j, z = 0;
        width = getSize().width;
        height = getSize().height;

        double htOfRow = height / (rows);
        double wdOfRow = width / (cols);

        for (j = 0; j < rows; j++) {
            for (k = 0; k < cols; k++) {
                g.drawLine((int) (k * wdOfRow), (int) (j * htOfRow), (int) (k * wdOfRow), (int) ((j+1) * htOfRow));
            }
        }
        for (j = 0; j < rows; j++) {
            for (k = 0; k < cols; k++) {
                g.drawLine((int) (k * wdOfRow), (int) (j * htOfRow), (int) ((k+1) * wdOfRow), (int) (j * htOfRow));
            }
        }
    }

    class Cell {
    }
} 
```

# javascript - 使用 javascript 在 IE9 中获取用户访问次数最多的网站？

> ID：10067180
> 
> 赞同：0
> 
> 时间：2012-04-08T22:47:11.877
> 
> 标签：javascript, internet-explorer, internet-explorer-9, browser-history

我正在制作一个在本地运行的 html 文件，以防万一。它只需要在IE9上运行，但如果它可以在其他浏览器上运行就更好了。我需要获取用户最常访问的网站，这样我就可以像 IE9 中的默认新标签页一样显示它们。如果我也能得到最近的历史，那就太好了。这些是可能的还是我必须使用插件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-08T23:01:02.323

您可以使用 javascript 获取一些历史信息，但这基本上仅限于该站点是否被访问过，并且不会为您提供日期或频率。它也已在一些现代浏览器中被阻止。更多信息在这里：

[http://blog.mozilla.com/security/2010/03/31/plugging-the-css-history-leak/](http://blog.mozilla.com/security/2010/03/31/plugging-the-css-history-leak/)

[http://blogs.msdn.com/b/ieinternals/archive/2009/06/17/csshistoryprobing.aspx](http://blogs.msdn.com/b/ieinternals/archive/2009/06/17/csshistoryprobing.aspx)

即使是本地 html 文件也不会为您提供其他信息，javascript 沙箱和 api 限制仍然适用于本地文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-08T23:24:05.977

虽然你不能得到“访问量最大的”，但你可以得到那些已经访问过的。

该过程是您需要准备一长串域。然后在您的页面中，加载一个 iframe，将这些链接放在 DOM 上。iframe 是必需的，这样您就可以在没有任何样式的情况下加载页面，远离您的主页。这样我们就可以看到我们将使用的默认链接颜色。

现在您在 iframe 中有一个带有一堆链接的空白文档，下一步是什么？你让 JavaScript 遍历链接，检查它们是*蓝色还是紫色*，明白我的意思吗？这意味着如果该链接的颜色为蓝色，则表示尚未访问过。如果它是紫色的，那么它是被访问过的。并且由于您的 iframe 和父页面属于同一域，因此父页面可以在 iframe 中获取“统计信息”。

这种方法的缺点是：

1.  如果用户更改浏览器本身中已访问和未访问链接的默认颜色。您正在对颜色进行硬编码。如果该用户发生变化，您将无法获得任何好的统计数据。

2.  您仅限于您的链接列表。虽然可以加。

3.  它耗尽了 DOM。假设您有 1000 个要检查的 url，您必须将 1000 个`<a>`标签附加到空白处`<iframe>`，然后让 JavaScript 遍历所有这些标签。

4.  确切的链接。如果您在 中阅读新闻`yahoo.com/news/etc....`，则与`yahoo.com`不会被拾取的新闻不同。理想情况下，您只需要列出顶级域。

5.  你没有得到“访问次数”。您只知道访问了哪些域，但不知道访问频率。但是，您可以做的是，在“新标签页”中，您可以将用户点击的链接存储在 cookie 中。例如，如果您`google.com`在“新标签页”中有用户点击它，则在 cookie 中增加 Google 的计数，然后转到 google。下次加载“新标签页”时，请阅读该 cookie 并继续计数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-08T22:52:47.800

您正在寻找的功能不存在，并且将是一个危险的功能，不应该成为任何浏览器的一部分。如果您能够阅读用户最近的历史记录，那么任何其他网站都可以这样做。出于隐私原因，您访问的网站会隐藏您的历史记录。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-06-19T16:05:02.450

万一有人遇到这个问题，我可以通过使用 JS History Objects 来实现提问者正在寻找的东西。它提供了一系列用户历史记录，计数排序可以返回网站列出的频​​率，为您提供用户访问次数最多的网站。

# objective-c - NSIndexPath 的内存管理问题

> ID：10067183
> 
> 赞同：0
> 
> 时间：2012-04-08T22:47:51.887
> 
> 标签：objective-c, ios, xcode, memory-management

所以目前我正在尝试保存 indexPath 并访问它，但我一直收到 EXC_BAD_ACCESS 错误，当我在 xcode 中使用分析工具时，它说在初始化期间存储到我的 indexPath 的值永远不会被读取。有人可以帮忙告诉我这里出了什么问题吗？

设置 indexPath 的方法：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{

NSURL *requestURL = [[NSURL alloc] initWithString:@"URL"];

//The request
ASIHTTPRequest *request = [ASIHTTPRequest requestWithURL:requestURL];

request.userInfo = [NSDictionary dictionaryWithObjectsAndKeys:indexPath,@"indexPath", nil];

[request setDelegate:self];    

[request startAsynchronous];   
[requestURL release];
[request release];
} 
```

访问 indexPath 的方法：

```
-(void)requestFinished:(ASIHTTPRequest *)request{

UIImage *foodImage = [[UIImage alloc] initWithData:[request responseData]];

NSIndexPath *indexPath = [request.userInfo objectForKey:@"indexPath"];

FoodDescription *detailViewController = [[FoodDescription alloc] initWithNibName:@"FoodDescription" bundle:nil];

// pass the food
detailViewController.aFood = [[NSMutableDictionary alloc] initWithDictionary:[_foodArray objectAtIndex:indexPath.row]];
detailViewController.foodPicture = foodImage;
detailViewController.restaurantName = _restaurantName;

// Pass the selected object to the new view controller.
[self.navigationController pushViewController:detailViewController animated:YES];
[detailViewController release];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-08T22:53:50.293

你正在分配一个 NSIndexPath，然后用你的下一条语句覆盖它。更糟糕的是，您泄露了在第一条语句中分配的内存。这可能是静态分析器正在接受的。导致崩溃的原因是您试图释放从第一条语句覆盖对象的对象。由于它已经自动发布，这*将*导致崩溃。

只需使用：

```
NSIndexPath *indexPath = [request.userInfo objectForKey:@"indexPath"]; 
```

并摆脱发布声明。你应该很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-08T22:51:34.430

好吧，首先您分配一个新对象，并将其存储到`indexPath`. 然后，您*使用*之前存储在`didSelectRowAtIndexPath`. 因此，您新分配的索引路径会丢失，并且会出现错误。

更重要的是，然后您尝试释放您存储在 中的这个对象`didSelectRowAtIndexPath`，而不是首先“拥有”它，因此您的应用程序崩溃了。

# python - 如何更改需要“其他”权限才能导入 csv 文件的 postgresql

> ID：10067184
> 
> 赞同：2
> 
> 时间：2012-04-08T22:48:01.050
> 
> 标签：python, postgresql, ubuntu, psycopg2

我最近从 Windows 更改为 ubuntu，并且在尝试重新创建我的 postgresql 数据库的权限时遇到了困难。

我的问题如下：我有一个将 csv 文件导入 postgresql 数据库的脚本。数据位于多个 csv 文件中，我正在使用 psycopg2 处理带有包装器的导入。

但是，用户权限存在问题。

要运行该文件，我需要手动更改每个 csv 文件的权限（可以批量执行），以便将“其他”权限设置为读取和写入。

这与我最初设置数据库的方式有关吗？如果是这样，我该如何纠正它。

澄清：

> > > 我想知道如何将我的数据库设置更改为不需要手动更改“其他”设置的权限以允许导入。

请求添加的脚本

```
import psycopg2 as psy
import sys

conn = psy.connect("dbname = 'name' host='localhost' user = 'postgres' password ='password')
curs = conn.cursor()
tablename = 'tabname'
filename  = 'filename'

Input = "COPY %s FROM %s WITH CSV HEADER" % (tablename, filename)
curs.copy_expert(Input, sys.stdin)

conn.commit()
curs.close()
conn.close() 
```

然后它周围有一个包装器，可以简单地在文件和表之间移动

我知道它有效，但是，它需要我手动更改 csv 文件的权限，以便“其他人”可以读取和写入它们。

我想知道为什么会这样

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T00:03:05.000

一种解决方法 - 替换[`copy_expert`](http://initd.org/psycopg/docs/cursor.html#cursor.copy_expert)为[`copy_from`](http://initd.org/psycopg/docs/cursor.html#cursor.copy_from)：

```
f = open(filename)
curs.copy_from(f, tablename, ...) 
```

这样，您的脚本将读取 CSV 文件而不是服务器进程，因此无需调整权限。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-08T23:11:02.907

Unix 系统强制执行文件系统权限。*除非数据的权限允许*访问，否则任何用户进程都不能访问其他用户拥有的数据。唯一不受这些约束的用户是`root`帐户；但是因为`root`它*非常*`root`强大，除非绝对必要，否则您不应运行任何进程。

有几个选项，具体取决于您希望保留数据的限制程度：

*   您可以使文件归`postgres`用户所有。这有点生硬，如果您还必须以用户身份定期使用 CSV 文件，这可能会变得很烦人。它与您当前的方法大致相同，但*需要*调用。（您不能在现代系统上泄露文件。）`root``chown(1)`

    这类似于`find /path/to/top -type f -print0 | xargs -0 chown postgres`

*   您可以创建一个新组；将该组添加到 PostgreSQL 运行的补充组列表中，使该组成为文件的组所有者，并确保该组对这些文件具有读取权限。这可能非常简单，特别是如果所有文件都位于一个目录或一个层次结构中。（BSD 组行为可以巧妙地设置文件的组所有权。）

    这种方法需要几个步骤：

    *   使用`groupadd(8)`或类似的命令来添加组。
    *   修改 PostgreSQL 配置以将组添加到补充组列表。
    *   `find /path/to/top -print0 | xargs -0 chgrp group_name`
    *   如果你想使用 BSD 组：
        *   阅读`mount(8)`手册页上有关该`bsdgroups` `mount(8)`选项的部分。
        *   根据需要将`bsdgroups`挂载选项添加到您的`/etc/fstab`文件中。
        *   重新挂载文件系统以包含`bsdgroups`挂载选项：`mount -oremount,bsdgroups /path/to/mount/point`
        *   在您的目录上设置`setgid`位：`find /path/to/top -type d -print0 | xargs -0 chmod g+s`

*   *您可以向系统上的每个*用户授予对文件的读取权限。这需要使用数据信任计算机上的每个进程——如果计算机托管不相关的服务，例如 web、ftp、邮件、无关客户端或系统的数据库服务等，这可能不是一个好的决定。

    您可以修改*创建*CSV 文件`umask(2)`的程序的设置。创建文件时应用此掩码，并且大多数程序不会尝试覆盖该设置。大多数 shell 可以很容易地更改for 自身和所有子进程 - 尝试在用于创建 CSV 文件的 shell 中运行，看看会发生什么。（它关闭了group 和 other 的权限。除非 PostgreSQL 也更新了这些文件，否则您不需要该权限，但您只说您需要导入它们。）*`umask(2)``umask(2)``umask 0022``write``write`*

 *尝试选择最简单*且*尊重[最小特权原则](http://en.wikipedia.org/wiki/Principle_of_least_privilege)的解决方案——尽可能少地授予系统上每个服务所需的权限，以限制不安全的程序或配置的潜在后果。*

# python - 忘记从函数返回结果：如何防止这个错误？

> ID：10067185
> 
> 赞同：2
> 
> 时间：2012-04-08T22:48:09.723
> 
> 标签：python, coding-style, python-3.x, static-analysis

我有时会忘记`return result`从一个函数：

```
def f(*args):
  # do stuff
  result = # an expression
  # oops forgot to return result 
```

由于`None`在我的应用程序中是一个有效值，因此这不会在调用者中引发任何异常甚至任何警报。当然，我尽量小心。但我想知道是否有一些巧妙的方法可以警告我任何没有明确返回值的函数。

也许我可以通过我的代码运行一个正则表达式来找到这种情况。或者一些代码检查工具（希望在Windows环境下可用）。

我什至在考虑使用这样的装饰器：

```
def requires_return(func):
  def new_func(*args, **kwargs):
    result = func(*args, **kwargs)
    if result is None:
      print('Warning: {} may be missing a return statement'.format(func.__name__))
    return result 
```

但这行不通，因为：

1.  许多误报：每次函数实际返回`None`. `None`如果不在其他地方创建非常丑陋的代码，我就无法停止在我的应用程序中使用。

2.  无论如何，为每个函数添加一个装饰器看起来超级丑陋。

请注意，我确实有故意没有`return`声明的功能。我倾向于保持一定的命名约定，这让我很容易区分它们。（具体来说，每个以 开头的函数都`get_`必须有一个 return 语句。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-08T22:51:25.300

我建议不要养成这样做的习惯

```
def something():
    ...
    result = ...
    return result 
```

相反，只需执行以下操作：

```
def something():
    ...
    return ... 
```

除此之外，`None`默认返回是 99% 的有用功能。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-08T23:33:16.063

## 简答

一言以蔽之：[**unittest**](http://docs.python.org/py3k/library/unittest.html)。

这不是您应该尝试使用生产代码解决的问题。一套好的测试将解决您的问题。

## 单元测试 101

您应该真正了解什么是单元测试，作为快速参考，请记住单元测试是关于测试您的 API。

还有一种称为[TDD](http://en.wikipedia.org/wiki/Test-driven_development)（测试驱动开发）的做法，即在实际代码之前编写测试的做法。所以程序员为一段不存在的代码编写测试，测试显然失败了，程序员去生产代码，编写他的函数，运行测试，如果测试通过，他继续。

一开始养成编写测试的习惯有点困难，但它确实有回报。

## 为什么在这里进行单元测试

我看不出通过正确的测试集怎么可能错过回报。

> “由于`None`在我的应用程序中是一个有效值，这不会在调用者中引发任何异常甚至任何警报。”

返回`None`的作用是破坏您的 API。单元测试是解决这个问题的确切方法。

> 如何防止这个错误？

*防止*此错误的方法是使用[TDD](http://en.wikipedia.org/wiki/Test-driven_development)。

如果你先编写测试，你有 99.9% 的把握在这个 bug 变成 bug 之前就发现它。

**注意：**我知道这不是您要寻找的答案，但单元测试是这里的正确工具。不使用`result`变量或将装饰器附加到每个函数都不会解决您的问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-08T22:58:20.037

Pylint 有时会捕捉到这种错误。特别是如果您分配给`result`但从不使用它：

```
pylint zorg.py
************* Module zorg
W0612:  5:zorg: Unused variable 'result' 
```

但是，它不会捕获您分段构建`result`然后忘记返回它的情况（因为那时变量不是“未使用”）。

但是，根据许多其他事情，pylint 通过其静态类型分析可能会捕获返回值的失败。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-08T22:52:35.417

预防胜于治疗——这意味着你应该真正学会在必要时返回值的习惯。您也可以`return statement`直接使用而不是`result = statement; return result`.

# ios - iOS 从 BLOB 创建图库照片

> ID：10067187
> 
> 赞同：1
> 
> 时间：2012-04-08T22:48:27.820
> 
> 标签：ios

两个简单的问题： 1\. 是否可以在 iOS 上创建图库相册并以编程方式命名？2\. 是否可以从 blob（从服务器下载）创建图库照片并使其成为相册的一部分？

如果系统提示用户授予访问画廊的权限，那很好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-08T23:20:30.890

执行此操作的方式是通过 iOS 5 添加的 ALAssetsLibrary API。仅查看 API 并不清楚您是如何进行此操作的，但 Marin Todorov 在 ALAssetsLibrary 上编写了一个不错的类别，使其变得微不足道。

[http://www.touch-code-magazine.com/ios5-saving-photos-in-custom-photo-album-category-for-download/](http://www.touch-code-magazine.com/ios5-saving-photos-in-custom-photo-album-category-for-download/)

链接页面包括一个关于如何使用他的代码的教程，以及一个下载代码本身的链接。

# registry - 从程序员的角度来看注册表清理器

> ID：10067189
> 
> 赞同：2
> 
> 时间：2012-04-08T22:48:50.610
> 
> 标签：registry

时不时我会听到“注册表清理器”、“孤立的注册表项”和其他类似的东西。我是一名 C#/.NET 程序员，我了解有关注册表的基本知识，我一直在我的应用程序中使用注册表等等。问题是我无法在 Windows 注册表上连接这两个“观点”。

谁能解释什么是“孤立的注册表项”，该软件如何检测它们，这对 Windows 性能有什么影响？

长话短说：那些注册表清理器值钱吗？或者这只是一个骗局——“高级用户”的陷阱？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T23:15:12.373

“孤立的注册表项”将是注册表中不再使用的东西，或者因为它所依赖的东西不存在而不起作用。例如，它可能是一个条目，告诉 Windows 在启动时运行应用程序，并且不再安装该应用程序。

注册表清理器的有用性在很大程度上取决于您的注册表状态。如果您安装了许多滥用注册表或在卸载时无法正确清理的糟糕程序，那么您可能需要进行清理。例如，如果注册表包含一个不再存在的程序的启动条目，那么清除该条目将使您的计算机启动速度稍快一些。如果注册表中有很多垃圾，清理肯定会产生显着差异。

如果您对安装的内容很小心，那么注册表清洁器的使用就会减少。您可能不会得到任何明显的性能差异。

当然，注册表清理程序删除它不应该删除的内容也存在很小的风险，因此在选择要使用的注册表清理程序时应该小心。

# javascript - 小型网络应用程序的网络框架

> ID：10067193
> 
> 赞同：0
> 
> 时间：2012-04-08T22:49:38.240
> 
> 标签：javascript, jquery, python, django, web-frameworks

也许你们可以帮助我我这里有一个小问题：

我已将嵌入式设备连接到 Internet。他们将数据永久记录到文件中。这些文件被发送到我的网络服务器。它们有大约 10k 行，每行看起来像：（时间戳；数据）。数据块包含 8 个字节等于 64 个 ON/OFF 值..

现在我想创建一个网络应用程序，它允许我：

-管理/控制嵌入式设备（打开 ssh 连接并发送命令）

- 在时间轴上可视化日志文件（我想可视化这些值，例如通过按时间戳分组的绿色/红色 LED，我可以在其中滚动和加速）

所以我的POV的技术要求：

*   用户认证
*   用于可视化日志文件的 javascript 集成
*   表单映射器

我更喜欢 python 作为业务逻辑的编程语言，但我不害怕尝试新的东西。

现在我要问的问题是： **我应该使用什么框架？**

我的意思是我已经看过 django 和 web2py，但我认为这些框架对于这个小项目来说是非常重要的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-08T22:54:55.333

对于 Python 中的小型 webapps，我通常使用[Flask](http://flask.pocoo.org/)。由于您似乎在进行原始数据处理，因此我会避免使用 ORM，而只是使用 SQLAlchemy 直接查询值（尽管如果您坚持使用 SQLAlchemy，则附带 ORM）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T02:59:00.350

我推荐[bottle.py](http://bottlepy.org/docs/dev/)。超级简单。但是，它是开箱即用的单线程，这意味着不能很好地支持多个用户。 [Cherrypy](http://cherrypy.org/)是多线程的，有点麻烦。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T01:45:08.170

我在小型应用程序中使用[http://webpy.org/有很好的体验。](http://webpy.org/)它更像是一个反框架而不是框架本身。一种极简主义的 Web 开发方法。

这是对我来说最能定义它的报价：

> “Django 让你可以用 Django 编写网络应用程序。TurboGears 让你可以用 TurboGears 编写网络应用程序。Web.py 让你可以用 Python 编写网络应用程序。” — 亚当阿特拉斯

正如@mensi 所说，我将使用 SQLAlchemy 作为 ORM 映射器

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-08T22:57:25.783

[Ruby 上的Sinatra](http://www.sinatrarb.com/)可能是您正在寻找的。

在持久性级别上，我会使用 MongoDB。这是[快速入门](http://www.garrensmith.com/2010/09/11/Mongoid-sinatra.html)。

就安全性而言，有很多选择，这里是[sinatra security](https://github.com/sinefunc/sinatra-security)。

OAuth 也是一个不错的选择，所以这里有一个链接，可以将[Gmail 的身份验证](https://github.com/nfo/gmail-oauth-sinatra)与一些草莓奶油一起使用。

# c++ - 关于尊重常量同时避免在堆上重新分配

> ID：10067194
> 
> 赞同：0
> 
> 时间：2012-04-08T22:49:44.523
> 
> 标签：c++, map, constants

我扩展了一个 const 函数，每次调用该 const 函数时，我都必须创建一个映射。如在

```
int foo() const {
  map<int, int> bar;
  // setup bar
  ...

  return utility::eval(bar);
} 
```

但是申报酒吧非常昂贵。我可以通过声明 bar 是一个实例变量来将我的 CPU 占用量减少一半，但这样做不尊重 constess。有没有一种非hacky的方法可以两全其美？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-08T22:51:20.290

您可以将其定义为`mutable`成员变量。

但是`mutable`，对于将自己设计为 const 角落的情况，您不应该将其用作 hacky 解决方法。你应该只在修改变量不会改变类的逻辑状态的情况下使用它（即它对成员函数产生的结果没有明显的影响）。你的听起来像这样的情况，所以应该没问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-08T22:51:47.317

是的。

```
class Foo {
    mutable map<int, int> bar;
    ...
} 
```

另请参阅[http://www.highprogrammer.com/alan/rants/mutable.html](http://www.highprogrammer.com/alan/rants/mutable.html)`mutable`并三重检查您在此处实际使用是否有意义。

# performance - 测量从应用程序到远程主机上的服务器的数据

> ID：10067216
> 
> 赞同：0
> 
> 时间：2012-04-08T22:54:01.953
> 
> 标签：performance, distributed-computing, traffic-measurement

测量从本地主机上的应用程序到远程主机上的服务器的数据量的最佳方法是什么？

我知道使用wireshark之​​类的东西，您可以嗅探数据并了解传输的内容，但是有没有一种好的方法来衡量部署和执行期间数据交换的大小？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-08T22:58:18.857

Wireshark*会*告诉你传输的数据的大小，它应该很容易过滤掉你的对话。

一个更简单的解决方案是将日志记录添加到您的程序中：每次发送或接收时简单地增加一个计数器，并定期输出计数器值。

另一种非常粗略的方法可能是读取您的接口统计信息，假设您的进程是机器上唯一运行的进程。

# windows-8 - 如何确定文件是否已在 StorageFolder 中创建

> ID：10067220
> 
> 赞同：5
> 
> 时间：2012-04-08T22:55:37.393
> 
> 标签：windows-8, microsoft-metro, windows-runtime

如果我有 Metro StorageFolder，我可以使用 GetFileAsync(fileName) 获取文件。

但是，我怎么知道文件是否存在呢？现在，我发现了一个异常，但这似乎不是正确的做法。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-09T15:25:33.880

根据微软的说法，他们希望我们捕获异常。他们给我的理由是，他们提供 File.Exists API 会使您面临竞争条件，在这种条件下，文件的存在可能在您检查和尝试使用文件之间发生变化。由于这种竞争条件，无论如何您都必须编写异常处理代码，一旦完成，调用 File.Exists API 几乎没有什么好处。我不同意这个论点，但这就是我们所坚持的。

# python - NameError：未定义名称“N_TOKENS”

> ID：10067223
> 
> 赞同：8
> 
> 时间：2012-04-08T22:55:59.950
> 
> 标签：python, python-2.7, pycharm

我是 Python 新手，刚开始为 Windows 安装 PyCharm。从 Skype 下载了一些示例代码，用于测试他们的 SkypeKit API。但是......只要我点击调试按钮，我就会得到这个：（我安装了 Python 2.7 和 Django 1.4）

```
Traceback (most recent call last):
  File "C:\Program Files (x86)\JetBrains\PyCharm 2.0.2\helpers\pydev\pydevd.py", line 2, in <module>
    from django_debug import DjangoLineBreakpoint
  File "C:\Program Files (x86)\JetBrains\PyCharm 2.0.2\helpers\pydev\django_debug.py", line 1, in <module>
    import inspect
  File "C:\Program Files (x86)\Python27\lib\inspect.py", line 39, in <module>
    import tokenize
  File "C:\Program Files (x86)\Python27\lib\tokenize.py", line 38, in <module>
    COMMENT = N_TOKENS
NameError: name 'N_TOKENS' is not defined

Process finished with exit code 1 
```

这是什么意思，我能做些什么来解决它？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-09T08:22:58.013

tokenize.py 模块可能加载了错误的 token.py 模块。请参阅[导入 numpy 时出错](https://stackoverflow.com/questions/7414504/error-importing-numpy)。解决方案 1) 重命名新的 token.py (token2.py) 并在 tokenize.py 等中更新对它的引用。解决方案 2) 如果新的 token.py 在 python 包中，您可以消除导入语句的歧义：

```
import CorrectPythonPackage.token as token2

#or 

from CorrectPythonPackage.token import * 
```

其中 CorrectPythonPackage 是包含 token.py 文件的文件夹名称。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-06-05T18:28:21.353

在我的例子中，我创建了一个名为 token.py 的文件作为解析练习，它导致了初始命名空间冲突。但是，简单地重命名 Eclipse 项目中的文件并不总是能解决问题。有时在运行 python 时会创建一个带有 *.pyc 结尾的编译字节码文件。您可能还必须使用文件系统命令查找并删除它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-08-07T21:02:26.200

它对我有用。

1.  将文件 /usr/lib/python2.7/token.py 重命名为 /usr/lib/python2.7/token2.py
2.  打开 /usr/lib/python2.7/tokenize.py
3.  更改`from token import *`为`from token2 import *`

完毕。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-08-08T04:52:34.550

也许您已将程序的一个模块命名为“令牌”。重命名它并更改您的导入语句，您可能会解决您的问题。如果是开发人员的错，请指出我的答案。我在尝试在 sourceforge 上修复 pylaga 时遇到了同样的错误，并以这种方式解决了它。在那种情况下，python 的导入路径也被操纵了，这可能迫使 python 导入程序的 token.py 而不是自己的，并且无法对事物进行标记（实际上，N_TOKENS 是在 Python 自己的 token.py 中定义的，例如/usr/lib64/python2.7/token.py)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-06-18T06:22:22.493

我在激活 virtualenv 时看到了这一点，但没有更改为 venv 目录。尝试导入 tokenize（从系统模块的 zip 文件）失败。

将我的工作目录更改为虚拟环境的根目录解决了这个问题（可能是相对路径问题）。

# java - Java 输出文件不将 \n 识别为换行符

> ID：10067224
> 
> 赞同：0
> 
> 时间：2012-04-08T22:56:38.850
> 
> 标签：java

对于大学课程的 Java 项目，我有一个将 ASCII 图像保存为单行字符串的方法，另一个名为 toString 的方法重建了这个 ASCII 图像并作为字符串返回。当我在 Eclipse 上运行我的程序时，我的输出在控制台上看起来很好并且是多行的，并且在它们应该存在的地方有换行符。但是当我使用带有重定向输出文件的命令行运行它时

java myprogram <输入>输出

输出中的文本是单行的，没有换行符

这是方法的代码

```
public String toString(){

    String output = "";

    for(int i=0; i<height; i++){
        output=output+image.substring(i*width, i*width+width)+"\n";

        }
    return output;  
} 
```

我应该怎么做才能获得多行输出文本文件

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-08T23:04:33.403

`\n`对于您正在运行的操作系统，可能不是正确的行分隔符。对于 Java，最好`System.getProperty("line.separator");`用于创建换行符，因为[这将确保您使用正确的平台](http://docs.oracle.com/javase/tutorial/essential/environment/sysprop.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-08T23:16:27.307

在 Windows 时使用 \r\n 的更快解决方案：

```
public String toString() {
    final String EOL = System.getProperty("line.separator");
    final int EOL_LENGTH = EOL.length();
    StringBuilder output = new StringBuilder(image.length() + EOL_LENGTH * height);
    output.append(image);
    for (int i = 0; i < height; i++) {
        output.insert(i*(width + EOL_LENGTH) + width, EOL);
    }
    return output.toString();  
} 
```

# java - Android .apk 大小翻倍取决于自 v17 工具以来用于部署的开发盒

> ID：10067225
> 
> 赞同：1
> 
> 时间：2012-04-08T22:56:43.253
> 
> 标签：java, android, eclipse, build, apk

更新到 ADT r17 工具后，我们遇到了一些开发框的问题，其中 .apk 中的 classes.dex 文件为 3.2MB 与 700KB。除了膨胀的 dex 文件外，无法从设备启动应用程序。它吐出一个 ClassNotFoundException。

我们不知所措，因为所有项目/eclipse 设置在开发框中似乎都是相同的。

该项目本身由两个库项目和带有 supportv4.jar 的主项目和一个内部 jar 组成。

*更新*

我选择了导出库项目和 jars（在主项目中），当它部署到设备上时它可以工作，.apk 仍然是两倍大小。另一个有趣的部分是（在它不起作用的盒子上）我们在启动时有 50% 的失败率（即 eclipse 冻结）。所以它基本上仍然无法使用。在 r16 工具中，构建和启动任何机器都没有问题。

*更新 v0.2*

我有库项目 1 依赖于库项目 2，并且只将必要的 jar 添加到 lib1。它启动并运行，但每次更改源仍需要 3-4 分钟以重新编译/构建/部署，并且 apk 仍然是正常大小的 x2。

*更新 v0.3*

更有趣的是，它将通过命令行快速编译，而不是通过 eclipse。我仍然得到一个非常大的 .apk（7.16MB vs 3.xxMB 对于以前的“正常”apk）。

*更新 v0.4*

事实证明，即使更新了 sdk/adt，某些盒子的 eclipse 也使用 adt 15/16（帮助-> 关于 eclipse -> 灌输细节），没有任何抱怨。那些是功能盒....

**更新 V0.5**

他们今天发布了“解决”问题的工具 r18，但 apk 仍然是“原始”大小的两倍，并且构建需要相当长的时间才能完成。我们最终将项目合并为一个项目，从长远来看不是一个令人满意的答案，但我们不能再浪费任何周期来调试我们的工具。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T01:43:58.000

除了 Nikolays 的回答，您可能还想查看 proguard 设置。现在不同了，当您使用 r17 与旧版本时，可能会删除一大堆东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T01:35:29.117

如果您将 jars 添加到每个项目（它在 ADT16 中的工作方式等），您可能会得到这个。此外，ADT17 会自动在 libs/ 下添加 jar，因此如果您有旧版本的 jar，您可能会遇到问题。将 jar 放在库项目的 lib/ 下，删除您添加到主项目构建类路径中的所有 jar。

# php - 将日期和时间添加到 MySQL 数据库

> ID：10067234
> 
> 赞同：-1
> 
> 时间：2012-04-08T22:58:31.003
> 
> 标签：php, mysql, datetime

我有一个 MySQL 字段`DATETIME`... 我有一个 PHP 页面，它生成一个查询，该查询将在包含`DATETIME`字段的表中添加一些数据。

问题是，我怎样才能将`DATETIME`PHP 添加到 MySQL？

我想以 GMT/UTC 24H 格式添加时间

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-08T23:03:38.260

```
mysql> create table t1 (id int, blah datetime);
Query OK, 0 rows affected (0.01 sec)

mysql> insert into t1 values (1, '2008-01-01 12:32');
Query OK, 1 row affected (0.00 sec)

mysql> select * from t1;
+------+---------------------+
| id   | blah                |
+------+---------------------+
|    1 | 2008-01-01 12:32:00 |
+------+---------------------+
1 row in set (0.00 sec) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-08T23:07:01.643

```
$current_time = date ('Y-m-d h:m'); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-08T23:07:36.867

```
$time = date ('Y-m-d h:m'); 
```

然后将 $time 插入到你的mysql表中

有关更多信息，请参见[http://php.net/manual/en/class.datetime.php](http://php.net/manual/en/class.datetime.php)

# javascript - 编写 javascript 库时一起使用 CoffeeScript 和 Node.js 的最佳方式是什么？

> ID：10067238
> 
> 赞同：1
> 
> 时间：2012-04-08T22:58:50.027
> 
> 标签：javascript, node.js, coffeescript, client-side

我正在编写一个 javascript 库，并希望在编写代码时使用 CoffeeScript 的强大功能来保持代码整洁，但我也想主要使用 Node 之类的东西来实现它的`require`功能。这个想法是将我的子对象命名在一个全局对象下，并将每个子对象定义在自己的文件中以便于开发。

也许我正在以错误的方式解决这个问题，我只需要一种干净的方式来使用 CoffeeScript 编写客户端 JavaScript 库吗？

谢谢！下面的示例文件结构...

### ./twtmore.coffee

```
twtmore =
    a: require('./twtmore/a.coffee').a
    b: require('./twtmore/b.coffee').b
    c: require('./twtmore/c.coffee').c 
```

### ./twtmore/a.coffee

```
class a
    ...

exports.a = a 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-08T23:07:49.377

是的，你正在以错误的方式解决这个问题。Node.js 是一种服务器端技术。您正在寻找的是在浏览器的咖啡脚本中使用诸如[RequireJS](http://requirejs.org/)或[CommonJS](http://wiki.commonjs.org/wiki/CommonJS)模块（这是节点使用的模块）之类的东西。

有一个将[CoffeeScript 与 RequireJS](http://requirejs.org/docs/download.html#cs)一起使用的插件，它似乎可以满足您的需求，但我没有使用它，也不能保证它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-08T23:08:02.717

## 浏览器的 CommonJS

至于使用 node.js 编写客户端 JavaScript 库，只需使用 modul8 或 browserify 编译成单个 JavaScript 文件即可。

## 咖啡脚本

如果您重视使用您的图书馆的人，那么不，不要这样做。

JavaScript 社区会讨厌你发布一个开源的 JavaScript 库，它的源代码是用 CoffeeScript 编写的

`<aside>`CoffeeScript 是一种可怕的语言`</aside>`

不过说真的

*   您将失去人气，因为人们完全拒绝使用您的代码，因为它不是 javascript
*   人们不会修补或阅读它，因为 CoffeeScript 不可读
*   [你正在分裂社区](http://news.ycombinator.com/item?id=2689973)

# sql - SQL XML - 存在：有没有更好的方法？

> ID：10067239
> 
> 赞同：1
> 
> 时间：2012-04-08T22:58:53.250
> 
> 标签：sql, xml, rdbms

我们在 SQL Server 2008 R2 数据库的几个表中使用 XML 列和传统列，其结构如下：

```
<bridging>
  <project id="43" source="true" />
  <project id="48" source="false" />
  <project id="99" source="false" />
  <project id="123" source="false" />
</bridging> 
```

然后，我们在 WHERE 子句中使用带有 .exist XPath 查询的存储过程从这些表中选择数据，如下所示：

```
SELECT  
    e.ID, 
    e.ProjectsBridge,
    e.Quantity, 
    e.Rate, 
    e.UOMID, 
    u.Name as UOM
FROM    
    tblEstimator e LEFT OUTER JOIN
    tblUnitOfMeasure u ON u.ID = e.UOMID
WHERE   
    (e.ProjectsBridge.exist('//bridging/project/@id[. = sql:variable("@ProjectID")]') = 1 OR 
     @ProjectID IS NULL) 
```

这在较小的数据集上效果很好，但数据集越大，速度越慢 - 上面的示例在一百万条记录的数据集上运行超过 2 分钟。

所以问题是是否有更好、更快的方法来做这个查询？

将 XML 模式应用于列会产生显着差异吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T22:01:45.403

您可以尝试几件事：

*   向您的 XML 列添加索引：[XML 数据类型列上的索引](http://msdn.microsoft.com/en-us/library/ms191497%28v=sql.105%29.aspx "XML 数据类型列的索引")
*   使用计算列：[在计算列中使用 XML](http://msdn.microsoft.com/en-us/library/bb510426%28v=sql.105%29.aspx)

在您的上下文中，CROSS APPLY 也可能更有效：

```
SELECT e.ID 
FROM tblEstimator e
CROSS APPLY e.ProjectsBridge.nodes('/bridging/project') AS T(c)
WHERE T.c.value('@id', 'INT') = @ProjectId 
```

# javascript - HTML，编译还是不编译......外部？

> ID：10067242
> 
> 赞同：2
> 
> 时间：2012-04-08T22:59:04.383
> 
> 标签：javascript, json, compilation

这不是一个特别有问题的编程查询，因为它是一个最佳实践问题。

当我编写 JavaScript 时，有时我会发出 ajax 请求，无论是简单的真/假请求还是一些 JSON。但是，有时，我需要编译 HTML，例如，如果 JavaScript 要为页面加载数据，它将通过 JSON 编译数据。然而，我对是否应该在我的 PHP 中预先编译 HTML 有一些想法？这样我就可以将 HTML 转储到页面上，而不会使 JavaScript 本身过热。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T23:02:04.110

除非你有大量的 DOM 节点要操作，否则我建议你使用 ajax 来移动数据并使用 JavaScript 来处理 DOM。JavaScript 不会过热 :)

我使用了一些简单的技术，比如在我复制的 HTML 中使用隐藏模板（例如，使用 jQuery）、更新和插入到 DOM 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-08T23:51:49.473

就我个人而言，我通常返回数据而不是预格式化的 HTML。它节省了带宽，它让我可以在该页面上按照我需要的方式格式化数据，并且我可以在不触及生成数据的代码的情况下更改布局，我可以在另一个页面上重用数据并以不同的方式格式化。（这也使其他人更容易（ab）使用您的数据）

# sql-server - 在sqlserver中加入3个非常复杂的表

> ID：10067248
> 
> 赞同：-1
> 
> 时间：2012-04-08T22:59:38.680
> 
> 标签：sql-server, join, inner-join

```
 i have 3 tables (employee,structure,District)

 1_employee table contains  empid,workid  and actuallwork  fks to structid 
 2_ structure table contains structid , districtId fk to district
 3_District table contains districtid , districtname 
```

我想得到

```
empid  ,  work 
```

, 实际工作（来自外键实际工作的地区名称）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T23:22:32.267

您可以在查询中多次使用同一个表，前提是您为每次出现都提供了不同的别名。结构和地区列出了两次，第一次是工作/地区，第二次是实际工作/实际地区。这就是在处理对同一个表的多个引用时区分列的来源的方式。

```
select employee.empid,
       district.districtname,
       actualdistrict.districtname acturaldistrictname
  from employee
    inner join structure work
       on employee.workid = work.structid
    inner join district
       on work.districtfk = district.districtid
    inner join structure actualwork
       on employee.actuallworkfk = actualwork.structid
    inner join district actualdistrict
       on actualwork.districtfk = actualdistrict.districtid 
```

# jquery - HTML/JQuery 从指定的 facebook 页面检索墙贴

> ID：10067249
> 
> 赞同：0
> 
> 时间：2012-04-08T22:59:41.683
> 
> 标签：jquery, html, facebook-opengraph

我已经尝试并试图让 Open Graph 自己工作，但没有任何运气。我还尝试过其他选项，例如[ajax 调用在 Chrome、Firefox 中有效，但在 IE 中无效？](https://stackoverflow.com/questions/10059837/ajax-call-works-in-chrome-firefox-but-not-in-ie#comment12874258_10059837)，但这有严重的问题。

我想要的是一个完整的解决方案，用于使用 Open Graph 检索给定指定 Facebook 个人资料 ID 的所有墙帖。它需要在不让用户登录 facebook 的情况下获取访问令牌。**编辑**：我有一个带有 App ID 和 App Secret 的应用程序。我不应该能够使用它来获取 Access_token 吗？我希望*没有*facebook 帐户的用户能够看到这个儿童页面的墙贴（这是建立一个单独网站的重点）。

对于它的价值，这是一个为患有晚期脑瘤的孩子提供的网站......这让我处于无法提出要求的位置（比如花 50 美元购买 SSL 或“只使用 facebook”） .

**编辑**我认为我*唯一*需要的是获取access_token。这不可能那么难。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T01:46:24.770

> *   [AJAX - 引入跨域请求 (XDR)](http://msdn.microsoft.com/en-us/library/dd573303%28v=vs.85%29.aspx#api_docs)
> *   [XDomainRequest - 限制、限制和解决方法](http://blogs.msdn.com/b/ieinternals/archive/2010/05/13/xdomainrequest-restrictions-limitations-and-workarounds.aspx)

* * *

> *   **注意：** 这回答了您的问题和 peraph 有人应该至少关闭其中一个

所以我对这个问题的解决方案很简单；您仍然继续使用 AJAX 执行对 facebook 的请求，但不是直接执行。

所以你的代码看起来像这样：

```
 $(function() {
            $.ajax({
                url : 'ajax-handler.php',
                data : 'action=get_access_token',
                type : 'GET',
                dataType : 'json',
                success : function(json) {

                }
            });
        }); 
```

然后在`ajax-handler.php`文件上，您将放置检索`access_token`和其他信息所需的所有内容。

服务器端伪代码（我在这里使用 php）看起来像这样，但您需要使用 php sdk 以获得更好的编码......

```
<?php
$action = $_GET['action'];
if (isset($action)) {
    switch($action) {
        case 'get_access_token' :
            $query = array('client_id' => '####', 'client_secret' => '####', 'grant_type' => 'client_credentials');

            $access_token = file_get_contents('https://graph.facebook.com/oauth/access_token?' . http_build_query($query));

            //$access_token will be like access_token=asdas8dd98sada...
            //but we don't use it here...

            $app =   file_get_contents('https://graph.facebook.com/######');

            echo $app;
            break;
    }
}
?> 
```

这是结果：

> *   **演示**：[http ://bit.ly/JO59mO](http://bit.ly/JO59mO)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-29T05:54:13.880

我没有交钥匙解决方案（抱歉没有足够的时间），但我可以提供一种解决跨域请求的方法：

> easyXDM 是一个 Javascript 库，使您作为开发人员能够轻松解决同源策略设置的限制，从而使跨域边界的通信和公开 javascript API 变得容易。

示例： [http ://easyxdm.net/wp/2010/03/17/cross-domain-ajax/](http://easyxdm.net/wp/2010/03/17/cross-domain-ajax/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-24T22:49:05.920

您的 Facebook 帐户是他帐户的朋友吗？如果是这样，您可以为自己的帐户生成自己的访问令牌，并使用[https://graph.facebook.com/id-or-alias/feed使用您自己的令牌查看孩子的提要](https://graph.facebook.com/id-or-alias/feed)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-19T22:32:20.330

在没有有效访问令牌的情况下，只能访问 Graph 上的公共数据。可以在[此处](https://developers.facebook.com/docs/reference/api/)找到这些可用公共数组的列表。可以使用`/me/feed`API 调用查看用户的墙帖，但此操作**特别**需要访问令牌。

# android - 使用 ViewPager 和 PagerAdapter，如何删除位置为“0”且当前项目为“0”的项目？

> ID：10067251
> 
> 赞同：3
> 
> 时间：2012-04-08T23:00:04.780
> 
> 标签：android, position, android-viewpager

我正在使用来自 android.support.v4.view.ViewPager 库的 ViewPager 和 PagerAdapter，如果我的当前项目也是零号，我想删除零号项目如果列表。我可以删除它而不会出现任何错误，但屏幕不会立即刷新。如果我转到第 2 项并返回，则第 0 项将被更新。任何人都可以解决这个问题吗？

我正在使用下面的删除功能：

```
public View removePage(int position) {
        if ((position < 0) || (position >= getSize()) || (getSize()<=1)) {
            return null;
        } else {
            if (position == mPager.getCurrentItem()) {
                if(position == (getSize()-1)) {
                    mPager.setCurrentItem(position-1);
                } else if (position == 0){
                    mPager.setCurrentItem(1);
                }
            }
            View tempView = myPagerAdapter.mListViews.remove(position);
            myPagerAdapter.notifyDataSetChanged();
            return tempView;
        }
    } 
```

我猜这个问题应该发生在函数调用中

```
setCurrentItemInternal(newCurrItem, false, true); 
```

在 ViewPager.java 中，newCurrItem 的参数为“0”，mCurItem 的参数为“0”。此外，问题应该出在 completeScroll(); 或 scrollTo(destX, 0); 在 setCurrentItemInternal() 结束时；

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T15:55:21.583

来自[http://developer.android.com/reference/android/support/v4/view/ViewPager.html#setOffscreenPageLimit(int](http://developer.android.com/reference/android/support/v4/view/ViewPager.html#setOffscreenPageLimit(int) )

> 公共无效 setOffscreenPageLimit (int 限制)
> 
> 设置应保留到处于空闲状态的视图层次结构中当前页面的任一侧的页面数。超出此限制的页面将在需要时从适配器重新创建。
> 
> 这是作为优化提供的。如果您事先知道需要支持的页面数量或在页面上设置了延迟加载机制，则调整此设置可以提高分页动画和交互的感知流畅度。如果您有少量页面 (3-4) 可以同时保持活动状态，那么在用户页面来回切换时，新创建的视图子树的布局将花费更少的时间。
> 
> 您应该将此限制保持在较低水平，尤其是在您的页面具有复杂布局的情况下。此设置默认为 1。
> 
> 参数 limit 在空闲状态下将保留多少页屏幕外。

将**OffScreenPageLimit**设置为零，然后删除该项目。您可以再次将**OffScreenPageLimit**设置为 1（默认值）。

# java - Gradle - 公司存储库需要 ssl 客户端证书

> ID：10067257
> 
> 赞同：6
> 
> 时间：2012-04-08T23:00:44.063
> 
> 标签：java, ssl, gradle

我们正在尝试切换到 gradle。一切正常，但我有一个内部存储库的问题，它只能通过驻留在 pkcs#11 令牌上的客户端证书访问。

使用 maven，我只有一个 .mavenrc 文件，如下所示：

```
#!/bin/bash
MAVEN_OPTS=" $MAVEN_OPTS \
        -Djava.security.debug=sunpkcs11 \
            -Djavax.net.ssl.trustStore=NONE \
            -Djavax.net.ssl.trustStoreType=pkcs11 \
            -Djavax.net.ssl.keyStore=NONE \
            -Djavax.net.ssl.keyStoreType=pkcs11 \
" 
```

所以我在开始时将这些 java 选项放入我的 gradlew 包装脚本中：

```
# Add default JVM options here. You can also use JAVA_OPTS and GRADLE_OPTS to pass JVM options to this script.
DEFAULT_JVM_OPTS=" \
-Djava.security.debug=sunpkcs11 \
-Djavax.net.ssl.trustStore=NONE \
-Djavax.net.ssl.trustStoreType=pkcs11 \
-Djavax.net.ssl.keyStore=NONE \
-Djavax.net.ssl.keyStoreType=pkcs11 \
" 
```

当我运行 ./gradlew build 时，我被要求输入我的令牌的 pin，但随后工件的请求失败并出现 401。在服务器上没有客户端证书到达。

$ ./gradlew --stacktrace 编译Java

```
:compileJava
SunPKCS11 loading /etc/opensc/opensc-java.cfg
sunpkcs11: Initializing PKCS#11 library /usr/lib/opensc-pkcs11.so
Information for provider SunPKCS11-OpenSC
[lots of debugging infos from sub pkcs11]
sunpkcs11: getting provider callback handler
sunpkcs11: getting default callback handler
[ entering PIN ]
sunpkcs11: login succeeded
sunpkcs11: user already logged in
sunpkcs11: user already logged in
sunpkcs11: user already logged in
sunpkcs11: user already logged in

FAILURE: Build failed with an exception.

* What went wrong:
Could not resolve all dependencies for configuration ':compile'.
> Could not resolve group: ....
  Required by: ...
   > Could not GET 'https://nexus/PATH...'. Received status code 401 from server: Authorization Required
   > Could not GET 'https://nexus/PATH...'. Received status code 401 from server: Authorization Required

* Try:
Run with --info or --debug option to get more log output.

* Exception is:
[...]
Caused by: org.gradle.api.UncheckedIOException: Could not GET 'https://nexus/PATH...'. Received status code 401 from server: Authorization Required
    at org.gradle.api.internal.artifacts.repositories.transport.http.HttpResourceCollection.processHttpRequest(HttpResourceCollection.java:145)
    at org.gradle.api.internal.artifacts.repositories.transport.http.HttpResourceCollection.initGet(HttpResourceCollection.java:121)
    at org.gradle.api.internal.artifacts.repositories.transport.http.HttpResourceCollection.getResource(HttpResourceCollection.java:81)
    at org.gradle.api.internal.artifacts.repositories.transport.http.HttpResourceCollection.getResource(HttpResourceCollection.java:54)
    at org.gradle.api.internal.artifacts.repositories.ResourceCollectionResolver.getResource(ResourceCollectionResolver.java:304)
    at org.gradle.api.internal.artifacts.repositories.ResourceCollectionResolver.findStaticResourceUsingPattern(ResourceCollectionResolver.java:248)
    at org.gradle.api.internal.artifacts.repositories.ResourceCollectionResolver.findResourceUsingPattern(ResourceCollectionResolver.java:234)
    at org.gradle.api.internal.artifacts.repositories.ResourceCollectionResolver.findResourceUsingPatterns(ResourceCollectionResolver.java:136)
    at org.gradle.api.internal.artifacts.repositories.MavenResolver.findIvyFileRef(MavenResolver.java:117)
    at org.apache.ivy.plugins.resolver.BasicResolver.getDependency(BasicResolver.java:223)
    at org.gradle.api.internal.artifacts.ivyservice.ivyresolve.DependencyResolverAdapter.getDependency(DependencyResolverAdapter.java:84)
    at org.gradle.api.internal.artifacts.ivyservice.ivyresolve.CacheLockingModuleVersionRepository$1.create(CacheLockingModuleVersionRepository.java:53)
    at org.gradle.api.internal.artifacts.ivyservice.ivyresolve.CacheLockingModuleVersionRepository$1.create(CacheLockingModuleVersionRepository.java:51)
    at org.gradle.cache.internal.DefaultCacheAccess.longRunningOperation(DefaultCacheAccess.java:172)
    at org.gradle.cache.internal.DefaultPersistentDirectoryStore.longRunningOperation(DefaultPersistentDirectoryStore.java:107)
    at org.gradle.api.internal.artifacts.ivyservice.DefaultCacheLockingManager.longRunningOperation(DefaultCacheLockingManager.java:57)
    at org.gradle.api.internal.artifacts.ivyservice.ivyresolve.CacheLockingModuleVersionRepository.getDependency(CacheLockingModuleVersionRepository.java:51)
    at org.gradle.api.internal.artifacts.ivyservice.ivyresolve.CachingModuleVersionRepository.resolveModule(CachingModuleVersionRepository.java:150)
    at org.gradle.api.internal.artifacts.ivyservice.ivyresolve.CachingModuleVersionRepository.findModule(CachingModuleVersionRepository.java:88)
    at org.gradle.api.internal.artifacts.ivyservice.ivyresolve.CachingModuleVersionRepository.getDependency(CachingModuleVersionRepository.java:79)
    at org.gradle.api.internal.artifacts.ivyservice.ivyresolve.IvyContextualiser$1.invoke(IvyContextualiser.java:44)
    at $Proxy34.getDependency(Unknown Source)
    at org.gradle.api.internal.artifacts.ivyservice.ivyresolve.UserResolverChain.findLatestModule(UserResolverChain.java:71)
    at org.gradle.api.internal.artifacts.ivyservice.ivyresolve.UserResolverChain.resolve(UserResolverChain.java:52)
    ... 91 more 
```

似乎 gradle (groovy) 支持标准的 java ssl 属性，因为它要求输入 PIN，但它没有成功。

如果我使用这样的简单 java 类运行它，一切正常：

```
 java URL url = new URL("...");
 InputStreamReader is = new InputStreamReader(url.openStream());
 BufferedReader in = new BufferedReader(is);
 String inputLine;
 while ((inputLine = in.readLine()) != null)
    System.out.println(inputLine);
 in.close(); 
```

像这样调用它可以正常工作：

```
java -Djava.security.debug=sunpkcs11 -Djavax.net.ssl.trustStore=NONE  -Djavax.net.ssl.trustStoreType=pkcs11 -Djavax.net.ssl.keyStore=NONE -Djavax.net.ssl.keyStoreType=pkcs11 jget/JGet 
```

ssl.keyStoreType=pkcs11\"

这是我的 build.gradle

```
task wrapper(type: Wrapper) { gradleVersion = "1.0-milestone-9" }
apply plugin: "java"
repositories {   maven { url "https://developer/nexus/content/repositories/thirdparty" }  }
dependencies { compile "org.projectx:tools:1.0" } 
```

有谁能够帮助我？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T09:49:17.670

[我在http://issues.gradle.org/browse/GRADLE-2234](http://issues.gradle.org/browse/GRADLE-2234)打开了一个问题，因为它似乎是一个错误，因为里程碑 6 它适用于里程碑 5，所以如果有人需要这个功能，请使用里程碑 5 和等待修复此错误。

# python - 自动装饰类中的每个实例方法

> ID：10067262
> 
> 赞同：12
> 
> 时间：2012-04-08T23:01:08.157
> 
> 标签：python, class, python-3.x, decorator

我想将相同的装饰器应用于给定类中的每个方法，除了那些以`__`.

在我看来，使用类装饰器应该是可行的。有什么陷阱需要注意吗？

理想情况下，我还希望能够：

1.  通过使用特殊装饰器标记某些方法来禁用此机制
2.  也为子类启用此机制
3.  即使对于在运行时添加到此类的方法也启用此机制

[注意：我使用的是 Python 3.2，所以如果这依赖于最近添加的功能，我很好。]

这是我的尝试：

```
_methods_to_skip = {}

def apply(decorator):
  def apply_decorator(cls):
    for method_name, method in get_all_instance_methods(cls):
      if (cls, method) in _methods_to_skip:
        continue
      if method_name[:2] == `__` and method_name[-2:] == `__`:
        continue
      cls.method_name = decorator(method)
  return apply_decorator

def dont_decorate(method):
  _methods_to_skip.add((get_class_from_method(method), method))
  return method 
```

以下是我遇到的问题：

*   如何实现`get_all_instance_methods`功能
*   不确定我的`cls.method_name = decorator(method)`线路是否正确
*   如何对运行时添加到类的任何方法执行相同的操作
*   如何将此应用于子类
*   如何实施`get_class_from_method`

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-08T23:19:46.713

我认为最好使用元类来完成，以便处理运行时和子类方法装饰。我没有看到使用类装饰器自动处理子类的优雅方法。

```
from types import FunctionType

# check if an object should be decorated
def do_decorate(attr, value):
    return ('__' not in attr and
            isinstance(value, FunctionType) and
            getattr(value, 'decorate', True))

# decorate all instance methods (unless excluded) with the same decorator
def decorate_all(decorator):
    class DecorateAll(type):
        def __new__(cls, name, bases, dct):
            for attr, value in dct.iteritems():
                if do_decorate(attr, value):
                    dct[attr] = decorator(value)
            return super(DecorateAll, cls).__new__(cls, name, bases, dct)
        def __setattr__(self, attr, value):
            if do_decorate(attr, value):
                value = decorator(value)
            super(DecorateAll, self).__setattr__(attr, value)
    return DecorateAll

# decorator to exclude methods
def dont_decorate(f):
    f.decorate = False
    return f 
```

以及它的使用示例（Python 2，但针对 Python 3 进行了简单修改）：

```
def printer(f):
    print f
    return f

class Foo(object):
    __metaclass__ = decorate_all(printer)
    def bar(self):
        pass
    @dont_decorate
    def baz(self):
        pass
    @classmethod
    def test(self):
        pass
# prints
# <function bar at 0x04EB59B0>

class AnotherName(Foo):
    def blah(self):
        pass
# prints
# <function blah at 0x04EB5930>

Foo.qux = lambda: 1
# prints
# <function <lambda> at 0x04EB57F0> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-08T23:28:12.260

你可以这样做（虽然不确定这是否是最优雅的方式）：

```
def get_all_instance_methods(x):
    return filter(callable, map(lambda d: getattr(x, d), dir(x))) 
```

至于`cls.method_name`，你将不得不使用`getattr(cls, method_name)`.

# mysql - 根据日期列中的日期获取季度

> ID：10067263
> 
> 赞同：0
> 
> 时间：2012-04-08T23:01:14.920
> 
> 标签：mysql, sql

我必须找到特定日期到来的季度。

目前我正在使用如下`if /else`结构执行此操作：

```
select if(month(s_date) < 4,Q1,if(month(s_date) >3 && month(s_date) < 7,Q2,.....) 
```

我这样做是对的还是有另一种简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-08T23:03:05.153

无需手动计算。Mysql 已经具有`QUARTER()`返回特定日期所在季度的函数

下面将使其简单：

```
SELECT QUARTER(s_date) as quarter FROM tablename 
```

# linux - 我什么时候应该在 shell 变量周围加上引号？

> ID：10067266
> 
> 赞同：247
> 
> 时间：2012-04-08T23:02:08.417
> 
> 标签：linux, bash, shell, unix, quotes

我应该还是不应该在 shell 脚本中为变量加上引号？

例如，以下是否正确：

```
xdg-open $URL
[ $? -eq 2 ] 
```

或者

```
xdg-open "$URL"
[ "$?" -eq "2" ] 
```

如果是这样，为什么？

* * *

## 回答 #1

> 赞同：200
> 
> 时间：2012-04-08T23:08:37.420

一般规则：如果它可以为空或包含空格（或任何空格）或特殊字符（通配符），请引用它。不使用空格引用字符串通常会导致 shell 将单个参数分解为多个参数。

`$?`不需要引号，因为它是一个数值。是否`$URL`需要它取决于您在那里允许的内容，以及如果它是空的，您是否仍然想要一个参数。

我倾向于总是出于习惯引用字符串，因为这样更安全。

* * *

## 回答 #2

> 赞同：137
> 
> 时间：2014-12-30T07:58:12.860

简而言之，在不需要 shell 执行分词和通配符扩展的地方引用所有内容。

单引号逐字保护它们之间的文本。当您需要确保外壳完全不接触琴弦时，它是合适的工具。通常，当您不需要变量插值时，它是首选的引用机制。

```
$ echo 'Nothing \t in here $will change'
Nothing \t in here $will change

$ grep -F '@&$*!!' file /dev/null
file:I can't get this @&$*!! quoting right. 
```

当需要变量插值时，双引号是合适的。通过适当的调整，当您需要在字符串中使用单引号时，它也是一个很好的解决方法。（没有直接的方法可以在单引号之间转义单引号，因为单引号内没有转义机制——如果有，它们不会完全逐字引用。）

```
$ echo "There is no place like '$HOME'"
There is no place like '/home/me' 
```

当您特别需要 shell 执行分词和/或通配符扩展时，不适合使用引号。

[分词](https://www.gnu.org/software/bash/manual/html_node/Word-Splitting.html)（又名分词）；

```
 $ words="foo bar baz"
 $ for word in $words; do
 >   echo "$word"
 > done
 foo
 bar
 baz 
```

相比之下：

```
 $ for word in "$words"; do echo "$word"; done
 foo bar baz 
```

（循环仅在单个带引号的字符串上运行一次。）

```
 $ for word in '$words'; do echo "$word"; done
 $words 
```

（循环仅在文字单引号字符串上运行一次。）

通配符扩展：

```
$ pattern='file*.txt'
$ ls $pattern
file1.txt      file_other.txt 
```

相比之下：

```
$ ls "$pattern"
ls: cannot access file*.txt: No such file or directory 
```

（没有按字面意思命名的文件`file*.txt`。）

```
$ ls '$pattern'
ls: cannot access $pattern: No such file or directory 
```

（也没有名为 的文件`$pattern`！）

更具体地说，任何包含文件名的内容通常都应该被引用（因为文件名可以包含空格和其他 shell 元字符）。任何包含 URL 的内容通常都应该被引用（因为许多 URL 包含 shell 元字符，如`?`and `&`）。通常应引用任何包含正则表达式的内容（同上）。需要引用除非空白字符之间的单个空格之外的任何包含重要空格的内容（否则，shell 会将空格有效地转换为单个空格，并修剪任何前导或尾随空格）。

当您知道一个变量只能包含一个不包含 shell 元字符的值时，引用是可选的。因此，一个不带引号`$?`的基本上没问题，因为这个变量只能包含一个数字。然而，`"$?"`它也是正确的，并且推荐用于一般的一致性和正确性（尽管这是我个人的建议，而不是广泛认可的政策）。

不是变量的值基本上遵循相同的规则，尽管您也可以转义任何元字符而不是引用它们。举一个常见的例子，一个带有 a 的 URL`&`将被 shell 解析为后台命令，除非元字符被转义或引用：

```
$ wget http://example.com/q&uack
[1] wget http://example.com/q
-bash: uack: command not found 
```

（当然，如果 URL 位于未引用的变量中，也会发生这种情况。）对于静态字符串，单引号最有意义，尽管此处可以使用任何形式的引用或转义。

```
wget 'http://example.com/q&uack'  # Single quotes preferred for a static string
wget "http://example.com/q&uack"  # Double quotes work here, too (no $ or ` in the value)
wget http://example.com/q\&uack   # Backslash escape
wget http://example.com/q'&'uack  # Only the metacharacter really needs quoting 
```

最后一个例子还暗示了另一个有用的概念，我喜欢称之为“跷跷板报价”。如果需要混合使用单引号和双引号，可以相邻使用。例如，以下引用的字符串

```
'$HOME '
"isn't"
' where `<3'
"' is." 
```

可以背靠背粘贴在一起，在标记化和引号删除后形成一个长字符串。

```
$ echo '$HOME '"isn't"' where `<3'"' is."
$HOME isn't where `<3' is. 
```

这不是很清晰，但它是一种常见的技术，因此很高兴知道。

顺便说一句，脚本[通常不应该`ls`用于任何事情。](http://mywiki.wooledge.org/ParsingLs) 要扩展通配符，只需...使用它。

```
$ printf '%s\n' $pattern   # not ``ls -1 $pattern''
file1.txt
file_other.txt

$ for file in $pattern; do  # definitely, definitely not ``for file in $(ls $pattern)''
>  printf 'Found file: %s\n' "$file"
> done
Found file: file1.txt
Found file: file_other.txt 
```

（在后一个示例中，循环完全是多余的；`printf`特别适用于多个参数`stat`。但循环通配符匹配是一个常见问题，并且经常不正确。）

包含要循环的标记列表或要扩展的通配符的变量不太常见，因此我们有时缩写为“引用所有内容，除非您确切知道自己在做什么”。

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2017-02-08T04:18:46.730

以下是一般报价的三点公式：

**双引号**

在我们想要抑制分词和通配符的上下文中。同样在我们希望将文字视为字符串而不是正则表达式的上下文中。

**单引号**

在我们想要抑制插值和反斜杠特殊处理的字符串文字中。换句话说，使用双引号的情况是不合适的。

**没有引号**

在我们绝对确定不存在分词或通配问题的情况下，或者我们*确实想要分词和通配*问题。

* * *

**例子**

**双引号**

*   `"StackOverflow rocks!"`带有空格 ( , `"Steve's Apple"`)的文字字符串
*   变量扩展 ( `"$var"`, `"${arr[@]}"`)
*   命令替换 ( `"$(ls)"`, `"`ls`"`)
*   目录路径或文件名部分包含空格 ( `"/my dir/"*`)的 glob
*   保护单引号 ( `"single'quote'delimited'string"`)
*   Bash 参数扩展 ( `"${filename##*/}"`)

**单引号**

*   包含空格的命令名称和参数
*   需要抑制插值的文字字符串 ( `'Really costs $$!'`, `'just a backslash followed by a t: \t'`)
*   保护双引号 ( `'The "crux"'`)
*   需要抑制插值的正则表达式文字
*   对涉及特殊字符 ( `$'\n\t'`)的文字使用 shell 引用
*   在需要保护多个单引号和双引号 ( `$'{"table": "users", "where": "first_name"=\'Steve\'}'`)的地方使用 shell 引用

**没有引号**

*   围绕标准数值变量（`$$`,`$?`等`$#`）
*   在算术上下文中，如`((count++))`, `"${arr[idx]}"`,`"${string:start:length}"`
*   内部`[[ ]]`表达，没有分词和通配问题（这是一个风格问题，意见可能会有很大差异）
*   我们想要分词的地方 ( `for word in $words`)
*   我们想要通配的地方 ( `for txtfile in *.txt; do ...`)
*   我们希望`~`被解释为`$HOME`(`~/"some dir"`但不是`"~/some dir"`)

* * *

也可以看看：

*   [Bash中单引号和双引号的区别](https://stackoverflow.com/a/42082956/6862601)
*   [什么是特殊的美元符号 shell 变量？](https://stackoverflow.com/q/5163144/6862601)
*   [引用和转义 - Bash Hackers' Wiki](http://wiki.bash-hackers.org/syntax/quoting)
*   [什么时候需要双引号？](https://unix.stackexchange.com/q/68694/201820)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2018-01-16T17:14:26.353

为了安全起见，我通常使用quoted like `"$var"`，除非我确定`$var`不包含空格。

我确实使用`$var`了一种简单的方法来加入行：

```
lines="`cat multi-lines-text-file.txt`"
echo "$lines"                             ## multiple lines
echo $lines                               ## all spaces (including newlines) are zapped 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-02-02T15:34:56.753

每当您的编辑器的[https://www.shellcheck.net/](https://www.shellcheck.net/)插件告诉您时。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2018-09-21T03:47:09.113

对于在shell脚本中使用变量，使用“”引用变量作为引用变量意味着变量可能包含不会影响shell脚本执行的空格或特殊字符。否则，如果您确定变量名中没有任何空格或特殊字符，那么您可以在没有“”的情况下使用它们。

例子：

```
echo "$url name"  # (Can be used at all times)

echo "$url name"  # (Cannot be used at such situations so take precaution before using it) 
```

# sql-server-2005 - 消息文件参数 SQL Server 2000 / 2005

> ID：10067267
> 
> 赞同：2
> 
> 时间：2012-04-08T23:02:47.687
> 
> 标签：sql-server-2005

SQL 专家，

我使用 SQL Server 2000`xp_smtp_sendmail`过程的 messagefile 参数来使用外部文本文件作为我的邮件正文。我们最近迁移到 SQL Server 2005 并且此参数不存在于`sp_send_dbmail`.

在 SQL Server 2005 中是否有一种简单的方法可以做到这一点。

谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T23:48:15.397

不，没有消息文件`sp_send_dbmail`。

我一直在阅读有关该主题的一些文章，并且您有一些选择。使用 CLR 函数获取文件[以读取和写入文本文件](http://www.mssqltips.com/sqlservertip/2341/use-the-sql-server-clr-to-read-and-write-text-files/)，然后将返回值放入邮件正文中。然后是这样的：

```
DECLARE @text VARCHAR(MAX)
EXEC @text=ReadTextFile 'C:\YourFile.txt'

EXEC msdb.dbo.sp_send_dbmail
@profile_name = 'something',
@recipients = 'someuser@somemail.com',
@body = @text,
@subject = 'Hello my friend' ; 
```

或者您可以使用`OPENROWSET`并在 varchar 中加载文件（更多信息[在这里](http://msdn.microsoft.com/en-us/library/ms190312%28v=sql.105%29.aspx)）：

```
DECLARE @LotsOfText VARCHAR(MAX)
SELECT  @LotsOfText = BulkColumn
FROM    OPENROWSET(BULK 'C:\YourFile.txt', SINGLE_BLOB) AS x 

EXEC msdb.dbo.sp_send_dbmail
@profile_name = 'something',
@recipients = 'someuser@somemail.com',
@body = @LotsOfText,
@subject = 'Hello my friend' ; 
```

[Text Files 的 TSQL](http://www.simple-talk.com/sql/t-sql-programming/the-tsql-of-text-files/)是 sql 读取文件的一个很好的参考。

我希望这个能帮上忙

# android - 当引用库的颜色属性与父项目的颜色属性同名时，如何访问它

> ID：10067272
> 
> 赞同：1
> 
> 时间：2012-04-08T23:03:04.700
> 
> 标签：android, android-library

我在父项目中使用引用库（属性/Android/库）。引用的库在其屏幕/布局文件之一中使用颜色/透明。父项目也有颜色/透明，但与引用库的颜色/透明中使用的值不同。引用库的代码使用父项目中的值。我必须通过 android:background="#000000" 将引用库的值硬编码为特定值。有没有办法让引用的库使用自己的颜色值，而不是继承父项目的相同命名属性的值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-08T23:20:02.897

这就是 Android 库项目设计为在 Android SDK 中工作的方式。Android Library Project 永远不会直接构建，它总是在构建依赖的 Main Project 时间接构建，当 SDK 编译/构建 Main Project 时，来自 Library Project 的源和资源被过滤并合并到 Main Project 中。当主项目和库项目中定义相同的资源名称时，主项目中的资源名称始终具有第一优先级。

查看[官方开发指南](http://developer.android.com/guide/developing/projects/index.html#LibraryProjects)：

> 但是，库项目与标准 Android 应用程序项目的不同之处在于，您不能将其直接编译为自己的 .apk 并在 Android 设备上运行。同样，您不能将库项目导出到自包含的 JAR 文件，就像对真正的库所做的那样。相反，您必须通过在依赖应用程序中引用库并构建该应用程序来间接编译库。
> 
> 当您构建依赖于库项目的应用程序时，SDK 工具会将库编译为临时 JAR 文件并在主项目中使用，然后使用结果生成 .apk。如果在应用程序和库中都定义了资源 ID，这些工具会确保应用程序中声明的资源获得优先级，并且库项目中的资源不会编译到应用程序 .apk 中。这使您的应用程序可以灵活地使用或重新定义在任何库中定义的任何资源行为或值。

解决方案是将主项目中的资源名称重命名为 color/transparent2 之类的其他名称。希望这有帮助。

# apache - 标头添加内容处置“附件”导致内部服务器错误

> ID：10067276
> 
> 赞同：3
> 
> 时间：2012-04-08T23:03:43.973
> 
> 标签：apache, .htaccess, download

由于我的电子书阅读器（Sony PRS-T1）的内置浏览器非常愚蠢，并且想将 .epub 文件作为文本文件打开而不是下载它们，我试图强制浏览器使用这个 .htaccess 下载 .epub 文件文件：

```
<FilesMatch "\.(?i:epub)$">
  ForceType application/octet-stream
  Header add Content-Disposition "attachment"
</FilesMatch> 
```

但是，这会导致内部服务器错误：

> 内部服务器错误
> 
> 服务器遇到内部错误或配置错误，无法完成您的请求。
> 
> 请联系服务器管理员 webmaster@localhost 并告知他们错误发生的时间，以及您所做的任何可能导致错误的事情。
> 
> 服务器错误日志中可能提供有关此错误的更多信息。

当我离开时`Header add Content-Disposition "attachment"`没有错误 - 但是，浏览器不会下载文件:(

难道我做错了什么？内部服务器错误来自哪里？

**[编辑 2013-04-11]**

我刚刚为这个帖子赢得了“热门问题徽章”，这让我想起了添加一些信息。

我终于设法使用以下 php 函数在索尼的 PRS-T1 浏览器上强制下载

```
function startDownload($path, $mimeType) {
if(!file_exists($path)) {
// File doesn't exist, output error
exit('file not found');
} else {
$size = filesize($path);
$file = basename($path);

// Set headers
header("Pragma: public"); // required
header("Expires: 0");
header("Cache-Control: must-revalidate, post-check=0, pre-check=0");
header("Cache-Control: private",false); // required for certain browsers
header("Content-Description: File Transfer");
header("Content-Disposition: attachment; filename=\"$file\"");
header("Content-Type: $mimeType");
header("Content-Transfer-Encoding: binary");
header("Content-Length: $size");
// Read the file from disk
readfile($path);
}

exit();
} 
```

希望有一天能对某人有所帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T08:27:30.337

这可能是答案：

[http://diogomelo.net/node/24](http://diogomelo.net/node/24)

> 默认情况下，Apache 上未启用模块标头。因此，我们必须手动启用它。
> 
> 要启用此模块，请以 root 身份登录，并创建一个从 mods-available/headers.load 到 mods-enabled 的符号链接。之后，重新加载 apache 就完成了。为此，我使用了这个命令。
> 
> ```
> su - cd
> /etc/apache2/mods-enabled/ ln -s ../mods-available/headers.load
> headers.load sh /etc/init.d/apache2 force-reload 
> ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T21:35:12.530

在您的 htaccess 文件中使用它之前，您可能还需要确保已启用 headers 模块。如果未启用 headers 模块，以下行将生成错误：

```
Header set Content-Disposition "attachment" 
```

这是一个示例，仅在启用 headers 模块时才强制下载 mp3 文件：

```
<IfModule mod_headers.c>
    <FilesMatch "\.(mp3|MP3)$">
        ForceType audio/mpeg
        Header set Content-Disposition "attachment"
        Allow from all
    </FilesMatch>
</IfModule> 
```

注意：它不会启用模块，如果模块未启用，它只会忽略 IfModule 标记内的任何内容。

要启用 apache 模块，您需要编辑 httpd.conf 文件或在 wamp 服务器中单击 wamp 托盘图标并选择“Apache -> Apache Modules -> headers_module”或确保选中它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-26T14:28:36.740

对于 ubuntu，有一个启用 apache2 headers 模块的快捷方式，使用：

```
sudo a2enmod headers 
```

问题解决了^_^

# c++ - Eclipse C++。包含带有类的 .h 文件。“符号 '[class]' 无法解析”

> ID：10067277
> 
> 赞同：0
> 
> 时间：2012-04-08T23:03:50.133
> 
> 标签：c++, eclipse, class, include

我有两个 .h 文件：List.h 包含结构节点和链接列表类，而 SkipList.h 包含“List.h”，定义了一个类 SkipList 并使用 List.h 中的类实例。我正在使用 Eclipse IDE。这些源代码从终端使用 g++ 编译，但在 Eclipse 中，它在 SkipList.h 文件中出现错误，即“无法解析符号‘节点’”和“无法解析符号‘链接列表’”。有人可以告诉我你认为这可能是什么问题吗？

重新编辑：当我遇到问题时，我已经发布了一个代码，但我不得不删除链接，因为它是大学作业的一部分，我不想冒险让其他同事找到我的工作并复制它，而不是那是任何杰作:)）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T04:58:18.577

您是否将 Node 定义为 List 的成员？您是否在 SkipList 中未使用的命名空间中定义了 Node 和 ListNode？您是否尝试过使用尖括号导入包含文件而不向项目包含路径添加相关路径？

基本上，除非您提供一些我们可以复制错误的相关示例代码，否则可能无法回答您的问题。

（也就是说，根据我的经验，Eclipse在处理 C++ 代码时*非常*不稳定。我经常会遇到编译问题，这些问题可以通过重建项目索引来解决，或者令人震惊的是，关闭然后重新打开项目。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T08:03:46.173

我通常如下声明模板。

```
template <class T> struct Node ; 
```

你用过

```
template class LinkedList<int> ; 
```

# java - Java 中的 AWS DynamoDB 和 MapReduce

> ID：10067280
> 
> 赞同：7
> 
> 时间：2012-04-08T23:05:10.223
> 
> 标签：java, amazon-web-services, mapreduce, amazon-dynamodb, elastic-map-reduce

我有一个巨大的 DynamoDB 表，我想对其进行分析以聚合存储在其属性中的数据。然后应由 Java 应用程序处理聚合数据。虽然我了解 MapReduce 背后的真正基本概念，但我以前从未使用过它。

就我而言，假设我在每个 DynamoDB 项目中都有一个`customerId`and`orderNumbers`属性，并且我可以为同一个客户拥有**多个项目。**喜欢：

```
customerId: 1, orderNumbers: 2
customerId: 1, orderNumbers: 6
customerId: 2, orderNumbers: -1 
```

基本上我想对每个 customerId 的 orderNumbers 求和，然后在 Java 中使用聚合执行一些操作。

AWS Elastic MapReduce 可能对我有帮助，但我不明白如何将自定义 JAR 与 DynamoDB 连接。我的自定义 JAR 可能需要同时公开 a`map`和`reduce`函数，我在哪里可以找到正确的接口来实现？

另外，我对文档有点困惑，看来我应该先将数据导出到 S3，然后再运行我的自定义 JAR。这个对吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T17:07:24.767

注意：我还没有建立一个有效的 EMR，只是阅读它。

首先，[将 Amazon EMR 与 Amazon DynamoDB 集成的先决条件](http://docs.amazonwebservices.com/ElasticMapReduce/latest/DeveloperGuide/EMRforDynamoDB_PreRequisites.html)

您可以直接在 DynamoDB 上工作：[用于在 Amazon DynamoDB 中导出、导入和查询数据的 Hive 命令示例](http://docs.amazonwebservices.com/ElasticMapReduce/latest/DeveloperGuide/EMR_Hive_Commands.html)，如您所见，您可以通过这种方式执行“类似 SQL”的查询。

如果您对 Hadoop 的了解为零，您可能应该阅读一些介绍材料，例如：[什么是 Hadoop](http://www.capgemini.com/technology-blog/2012/01/what-is-hadoop/)

本教程是另一个很好的阅读 [使用 Amazon Elastic MapReduce 和 DynamoDB](http://aws.typepad.com/aws/2012/01/aws-howto-using-amazon-elastic-mapreduce-with-dynamodb.html)

关于您的自定义 JAR 应用程序，您需要将其上传到 S3。使用本指南：[如何使用自定义 JAR 创建作业流](http://docs.amazonwebservices.com/ElasticMapReduce/latest/DeveloperGuide/CLI_JobFlowUsingCustomJAR.html)

我希望这会帮助你开始。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-08T04:01:36.987

另请参阅：[http](http://aws.amazon.com/code/Elastic-MapReduce/28549) : //aws.amazon.com/code/Elastic-MapReduce/28549 - 它也使用 Hive 访问 DynamoDB。这似乎是从 Hadoop 访问 DynamoDB 的官方 AWS 方式。

如果您需要在自定义 JAR 中编写自定义代码，我发现：[DynamoDB InputFormat for Hadoop](https://stackoverflow.com/questions/13020104/dynamodb-inputformat-for-hadoop)

但是，我找不到有关为此 InputFormat 设置的与 Hive 参数相对应的 Java 参数的文档。根据这篇文章，它不是亚马逊发布的：http: [//www.newvem.com/amazon-dynamodb-part-iii-mapreducin-logs/](http://www.newvem.com/amazon-dynamodb-part-iii-mapreducin-logs/)

另请参阅： [包含 org.apache.hadoop.hive.dynamodb 的 jar](https://stackoverflow.com/questions/17077774/jar-containing-org-apache-hadoop-hive-dynamodb)

因此，使用自定义 MapReduce 作业中的 DynamoDB 数据的官方记录方法是将数据 DynamoDB 导出到 S3，然后让 Elastic MapReduce 从 S3 中获取数据。我猜这是因为 DynamoDB 被设计为作为键/值“NoSQL”存储随机访问，而 Hadoop 输入和输出格式用于大块大小的顺序访问。亚马逊未记录的代码可能是弥补这一差距的一些技巧。

由于导出/重新导入会占用资源，因此最好在 Hive 内完成任务。

# javascript - d3：从嵌套数据中为多行着色

> ID：10067284
> 
> 赞同：4
> 
> 时间：2012-04-08T23:05:38.757
> 
> 标签：javascript, d3.js

我目前正在从格式如下的 JSON 对象数组的数据点组装一些带有圆圈的折线图：

```
var data = [{
    "name": "metric1",
    "datapoints": [
        [10.0, 1333519140],
        [48.0, 1333519200]
    ]
}, {
    "name": "metric2",
    "datapoints": [
        [48.0, 1333519200],
        [12.0, 1333519260]
    ]
}] 
```

我想为每个指标设置一种颜色，因此我尝试根据数组数据中对象的索引为它们着色。我目前用于放置圆圈的代码如下所示：

```
// We bind an svg group to each metric.
var metric_groups = this.vis.selectAll("g.metric_group")
  .data(data).enter()
  .append("g")
    .attr("class", "metric_group");

// Then bind a circle for each datapoint.
var circles = metric_groups.selectAll("circle")
.data(function(d) { return d.datapoints; });

circles.enter().append("circle")
  .attr("r", 3.5); 
```

现在，如果我将最后一点更改为：

```
circles.enter().append("circle")
  .attr("r", 3.5);
  .style("fill", function(d,i) { return i%2 ? "red" : "blue"; } 
```

正如所料，我得到交替的红色和蓝色圆圈。
从[Nested Selections : 'Nesting and Index'](http://bost.ocks.org/mike/nest/#index)中得到一些建议，我尝试了：

```
circles.enter().append("circle")
  .attr("r", 3.5);
  .style("fill", function(d,i,j) { return j%2 ? "red" : "blue"; } 
```

哪个不起作用（j 未定义），大概是因为我们在命名属性数据点中，而不是在数组元素中。我如何在不改变数据结构的情况下进行我想要的着色？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-10T14:50:09.807

这里最简单的做法是让圆圈从父 G 元素继承填充样式：

```
var color = d3.scale.category20();

var metricGroup = vis.selectAll(".metric-group")
    .data(data)
  .enter().append("g")
    .attr("class", "metric-group")
    .style("fill", function(d) { return color(d.name); });

var circle = metricGroup.selectAll("circle")
    .data(function(d) { return d.datapoints; })
  .enter().append("circle")
    .attr("r", 3.5); 
```

如果您将分类颜色定义为 CSS 类，您还可以使用动态类名并以这种方式继承：

```
var metricGroup = vis.selectAll(".metric-group")
    .data(data)
  .enter().append("g")
    .attr("class", function(d) { return "metric-group " + color(d.name); }); 
```

使用相应的 CSS：

```
.metric1 circle { fill: red; }
.metric2 circle { fill: blue; } 
```

另一种方法是使用[each](https://github.com/mbostock/d3/wiki/Selections#wiki-each)来访问父数据：

```
metricGroup.each(function(p, j) {
  d3.select(this).selectAll("circle")
      .data(p.datapoints)
    .enter().append("circle")
      .attr("r", 3.5)
      .style("fill", color(p.name));
}); 
```

我也认为使用组索引`j`会起作用；我不确定为什么它对您来说是未定义的，但是您的代码示例（in `.attr("r", 3.5);`）中有一个虚假的分号，所以可能还有其他事情发生。无论如何，从数据而不是组索引中获取分类颜色更为惯用，因此我将使用上述技术之一。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T21:30:20.190

在我的一个可视化中，我遇到了同样的问题。我的解决方案如下（适用于您的示例）：

```
var count = 0;

var color = d3.scale.category20();

var metric_groups = this.vis.selectAll("g.metric_group")
  .data(data).enter()
  .append("g")
    .attr("class", "metric_group");

var circles = metric_groups.selectAll("circle")
  .data(function(d) {return d.datapoints;});

circles.enter().append("circle")
  .attr("r", 3.5)
  .style("fill", function(d,i){
    d.number = count;
    count++;
    return color(d.number);
  }); 
```

关键是为每个数据赋予一个独特的属性，该属性可用于为不同组的相应元素赋予独特的颜色。

我希望这可以帮助或支持您找到类似的解决方案！

# javascript - Update subviews from Ember.View

> ID：10067287
> 
> 赞同：0
> 
> 时间：2012-04-08T23:06:40.550
> 
> 标签：javascript, ember.js

I'm doing an ajax form with a server API calls. The server can returns errors messages for specific fields (example: url => 'This url is incorrect').

So I've created a specific view for my form Textfield :

```
(textfield.handlebars)
{{view Ember.TextField valueBinding="value"}}
{{#if hasError}}
    <div class="error">{{errorMessage}}</div>
{{/if}}

(textfield.js)
App.TextField = Ember.View.extend({
    hasError: false,
    errorMessage: "",
    templateName:     "textfield",
}); 
```

And In my form view template I have:

```
(form.handlebars)
<div class="form-row">
    <div class="form-element"><div class="input-wrapper">{{view App.TextField valueBinding="skill.job"}}</div></div>
</div>

(new.js)
submit: function() {
    var skill = this.get("skill");

    skill.saveResource()
    .fail( function(e) {
        //how could I set the errorMessage in my App.TextField
    });
} 
```

When the user click on the submit button, I'm sending all form datas to the server and retrieving errors messages.

My question is how can I do to update the "subview" App.TextField to set the error messages ?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T07:46:53.927

You could use a custom `App.Error` object which holds the error messages. Also, if you are planning to use ember-data there is a discussion about validation [https://github.com/emberjs/data/pull/130](https://github.com/emberjs/data/pull/130). And there's a validation extension in the excellent Ember.js addons: [https://github.com/capitainetrain/ember-addons/tree/master/packages/ember-validators/lib](https://github.com/capitainetrain/ember-addons/tree/master/packages/ember-validators/lib).

Here's what I have in mind, see [http://jsfiddle.net/pangratz666/kQJ2t/](http://jsfiddle.net/pangratz666/kQJ2t/):

**Handlebars**:

```
<script type="text/x-handlebars" data-template-name="edit" >
    name: {{view App.TextField valueBinding="content.name" propertyName="name" }}</br>
    age: {{view App.TextField valueBinding="content.age" propertyName="age" }}</br>
    <button {{action "save"}}>save</button>
</script>​ 
```

**JavaScript**:

```
App.Error = Ember.Object.extend({
    isError: function(propertyName) {
        return !Ember.empty(this.getErrorMessage(propertyName));
    },
    getErrorMessage: function(propertyName) {
        return this.get(propertyName);
    }
});

App.ErrorMixin = Ember.Mixin.create({
    classNameBindings: ['isError:error'],
    errorBinding: 'parentView.error',

    template: Ember.Handlebars.compile('{{#if isError}}{{errorMessage}}{{/if}}'),

    isError: function() {
        var error = this.get('error');
        return error && error.isError(this.get('propertyName'));
    }.property('error', 'propertyName'),

    errorMessage: function() {
        var error = this.get('error');
        if (error) {
            var propertyName = this.get('propertyName');
            return error.getErrorMessage(propertyName);
        }
    }.property('error', 'propertyName')
});

App.TextField = Ember.TextField.extend(App.ErrorMixin); 
```

The error object is then constructed like this:

```
Ember.View.create({
    templateName: 'edit',
    contentBinding: 'App.obj',
    save: function() {
        var content = this.get('content');
        var error = this.get('error');
        if (error) {
            error.destroy();
        }

        error = App.Error.create();

        if (content.get('age') <= 100) {
            error.set('age', 'sorry, you are not wise enough');
        }

        if ('Chuck Norris' === content.get('name')) {
            error.set('name', 'yeah, and i am the queen of england');
        }

        this.set('error', error);
    }
}).append();​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-08T23:27:10.250

On form.handlebars set an id for it manually (so it will override the one that ember generates automatically):

```
<div class="form-row">
  <div class="form-element"><div class="input-wrapper">{{view App.TextField id="skill_job" valueBinding="skill.job"}}</div></div>
</div> 
```

And then:

```
submit: function() {
    var skill = this.get("skill");

    skill.saveResource()
    .fail( function(e) {
        Ember.View.views["skill_job"].set('errorMessage', 'blah');
        Ember.View.views["skill_job"].set('hasError', true);
        // of course you will probably want to handle this message from the request or whatever, hope you get the idea
    });
} 
```

# html - 百分比宽度和固定内部宽度问题

> ID：10067289
> 
> 赞同：0
> 
> 时间：2012-04-08T23:07:08.007
> 
> 标签：html, css

好吧，长话短说，我的一个客户让我做了一个项目，他特别想要的设计要求 100% 宽度的标题包装器，包含徽标的内部 div 是 1300px 宽度。

问题是，例如，在我的 23 in 屏幕上，它很好，显示了它应该如何，但在较小的屏幕上，有一个巨大的差距，并且包装 div 的内部 div 都未对齐。

例如，假设我们有两个 div，内部 div 是红色，外部 div 是深蓝色，背景是绿色，在大屏幕上，我得到了这个（这就是我想要的）

```
 -------------------------------------------------------------------
   |      -----------------------------------|                         |
   |      |                                  |          end Of window->|         
   |      |red centered in the middle(1300px wide)   green **not** seen|
   |      -----------------------------------                          |
   |        wrapper header div @ 100% (DARKBLUE)                       |
   | ------------------------------------------------------------------ 
```

现在，在上面的示例中，在标题上，您看不到绿色，因为标题包装器 div 是 100%

现在在较小的屏幕上，例如 my13'mac/iphone/sammy 平板电脑

我明白了

```
------------------------------------------------------------------------------|
-----------------------------------|      |                                   |
|                                  |      |     endOf parent header div       |  
|      red                         |      |  <--pushed all the way left       |
-----------------------------------       |                                   |
  wrapper header div @ 100% (DARKBLUE)    |            GREEN                  |                                   
------------------------------------------------------------------------------| 
```

所以我试图说明的是，在较小的屏幕上，中心 div 一直向左推，并显示绿色....

关于为什么的任何想法？再次在所有大屏幕上它都很好，在较小的屏幕上，它打破了......

我应用于这些的CSS非常简单。

红色 div 是：

```
#topRow{
    width:100%;
    height:120px;

    background-image:url(../../images/menuStripBg.png);
    background-repeat:repeat-x; 

} 
```

内部 div (DARKBLUE) 是：

```
#topRowInner{
    min-width:1300px;
    margin:0px auto;    
} 
```

现在我假设问题在于，在较小的屏幕上，因为内部（深蓝色）div 的宽度是 1300px **；**较小的屏幕分辨率小于 1300，屏幕处于 100% 时会将其扔掉，本质上，如果父包装器 100% 小于 1300，它不能将 1300 居中.....

不知道这是否有意义....

无论如何，如果这是问题所在，知道如何解决这个问题吗？

如果它不是问题，那么任何提示/提示等我都很高兴。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T01:31:59.173

假设您的 ascii 示例并忽略对问题的进一步描述，我认为您正在寻找类似**[这种解决方案](http://jsfiddle.net/aRaAS/)**的东西（扩大和缩小窗口）。

您还可以将div中的`position`,`left`​​ 和`margin-left`样式替换为您自己的 css 中的样式，但是当窗口小于 1300 像素时，它不会居中。`topRowInner``margin: 0 auto;`

# wordpress - Wordpress 网站中的邮件功能

> ID：10067290
> 
> 赞同：0
> 
> 时间：2012-04-08T23:07:20.977
> 
> 标签：wordpress, feed, mailchimp, mailing

我正在做一个星座网站项目，该项目需要在 wordpress 网站中实现邮件功能。它需要这些功能。

1.  它要求用户注册每日星座通讯
2.  应自动从客户端查找每日 RSS 提要，其中包含当天所有生肖的星座。应该从中提取数据。
3.  根据用户的星座发送给用户的每日星座运势电子邮件。（从 xml Feed 中提取）

客户更喜欢从 mailchimp api 完成。

现在我对如何实现它一无所知。谁能帮我找出实现它的最佳和最简单的方法。

在这方面的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T20:14:24.987

对于我一直在做的事情，我和你有同样的疑问。[您可以使用此工具](http://www.rss-info.com/en_rssinclude.html)生成提要的 HTML 代码并将其粘贴到时事通讯电子邮件中（当然，前提是它允许嵌入 HTML），然后使用 MailChimp 将其邮寄。

您可能还想改用[时事通讯插件](http://wordpress.org/extend/plugins/newsletter/)。我使用了一个时事通讯插件，它允许选择加入，也可以导入地址，具体取决于您的客户想要的方式。该插件还具有编辑电子邮件 HTML 的功能，因此您可以根据需要向某人发送整个帖子/rss 或仅一些文本。您也可以自动执行这些功能，以便根据您选择的内容尽可能频繁地邮寄它们。我不记得确切的名称，但我怀疑这会引起关注。其中相当一部分与 MailChimp 集成，如果您愿意，它们都可以使用电子邮件 cron。

当然，你自己写的东西会更适合，但我想你可以使用这个建议得到同样的东西。

# go - 如何在 Ubuntu 中启动 Go 程序作为守护进程？

> ID：10067295
> 
> 赞同：45
> 
> 时间：2012-04-08T23:08:31.827
> 
> 标签：go

在 Ubuntu 中启动 Go 程序作为守护进程的正确方法是什么？然后我会用Monit监控它。我应该做类似的事情：

```
go run myapp.go & 
```

我应该考虑哪些特定于 Go 的事情？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-04-09T04:38:27.440

你应该为你的程序构建[一个](http://software.clapper.org/daemonize/)[可执行](https://launchpad.net/upstart)`go build`文件（我更喜欢后一种解决方案，因为它不依赖于依赖系统的新贵。使用 daemonize 你可以启动你的应用程序

```
daemonize -p /var/run/myapp.pid -l /var/lock/subsys/myapp -u nobody /path/to/myapp.exe 
```

这将为您提供一个行为良好的 unix 守护进程，并由 daemonize 完成所有必要的守护进程准备工作。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-09T00:55:29.850

有一个关于从 Go 程序中守护进程的能力的错误报告：[http ://code.google.com/p/go/issues/detail?id=227](http://code.google.com/p/go/issues/detail?id=227)

但是，如果您所追求的只是脱离流程，我已经看到建议执行以下操作之一：

```
nohup go run myapp.go 
```

或者

```
go run myapp.go & disown 
```

您还可以使用流程管理器，例如编写`init.d`,`Startup`或使用我个人非常喜欢的[Supervisor之类的东西。](http://supervisord.org/)

# python - 听不到 pygame 的声音

> ID：10067296
> 
> 赞同：0
> 
> 时间：2012-04-08T23:08:35.483
> 
> 标签：python, pygame

我正在使用以下代码在 python 中使用 pygame 库播放歌曲。它播放歌曲，如果我直接单击我的 python 文件，我可以听到声音。但是，如果我使用 python（命令行）或 python（GUI）运行我的程序，我听不到声音。我检查了 python 2.6 和 2.7。我正在使用 Windows 7 操作系统。

**我的代码：**

```
import pygame,time,sys

pygame.init()

pygame.mixer.init(frequency=22050, size=-16, channels=2, buffer=4096)

print "Mixer settings", pygame.mixer.get_init()

print "Mixer channels", pygame.mixer.get_num_channels()

pygame.mixer.music.set_volume(1.0)

pygame.mixer.music.load("2.mp3")

while 1:

    selection = raw_input()

    if selection == "play":

        print "Playing"

        pygame.mixer.music.play()

    elif selection == "rewind":

        pygame.mixer.music.rewind()

    elif selection == "pause":

        pygame.mixer.music.pause()

    elif selection == "stop":

        pygame.mixer.music.stop()

    elif selection == "queue":

        inputqueue = raw_input()

        pygame.mixer.music.queue(inputqueue)

    else:

        print "invalid selection"

        sys.stdout.flush() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T02:12:18.517

您需要制作一个 pygame 循环，以便您可以听音乐。您应该使用[http://www.pygame.org/docs/ref/key.html](http://www.pygame.org/docs/ref/key.html)密钥库来获取输入

```
import pygame,time,sys

#pygame.init()
pygame.mixer.init(frequency=22050, size=-16, channels=2, buffer=4096)
print "Mixer settings", pygame.mixer.get_init()
print "Mixer channels", pygame.mixer.get_num_channels()
pygame.mixer.music.set_volume(1.0)
pygame.mixer.music.load("2.mp3")
pygame.mixer.music.play()

clock = pygame.time.Clock()
while pygame.mixer.music.get_busy():
   # check if playback has finished
   clock.tick(30) 
```

# whitespace - 根据子级宽度扩展 div 宽度

> ID：10067298
> 
> 赞同：10
> 
> 时间：2012-04-08T23:08:37.680
> 
> 标签：whitespace, css, nowrap

这是我的小问题（此处的值仅用于示例）：

假设我有一个宽度约为 500 像素的窗口。在我的文档中，我有一个没有指定宽度的外部 div，但有以下 css：

```
.outer{
  white-space:nowrap;
  background:blue;
} 
```

在这个 div 中还有 3 个其他 div，它们具有以下属性：

```
.t1{
  display:inline-block;
  width:400px;
} 
```

（注意 . 的宽度`400px`。这就是问题所在，线比窗口宽，并且外部 div 没有延伸。HTML 看起来像这样：

```
<div class="outer">
    <div class="t1">1</div>
    <div class="t1">2</div>
    <div class="t1">3</div>
</div> 
```

我想要实现的是让 3 个内部 div 具有蓝色背景，而不为`t1`类设置它。这个例子将产生一个蓝色背景，限制在窗口的宽度。

在此处查看完整示例：http: [//jsfiddle.net/sjCTR/](http://jsfiddle.net/sjCTR/)（如果您的屏幕太大，您必须调整左下角）

我想知道是否可以仅通过 css/html 以某种方式实现，而无需设置外部 div 宽度/内部 div 背景？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-04-08T23:28:47.407

添加[`float: left`](http://jsfiddle.net/thirtydot/sjCTR/1/)或[`display: inline-block`](http://jsfiddle.net/thirtydot/sjCTR/2/)到`.outer`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-08T23:45:59.400

添加溢出：隐藏；宽度：100%；向外

# php - php函数不会工作不止一次

> ID：10067304
> 
> 赞同：3
> 
> 时间：2012-04-08T23:09:47.650
> 
> 标签：php, mysql

我制作了一个函数，可以根据用户 ID 为我提供用户名。不同的用户 id 将处于一个 while 循环中，因此该函数将被多次使用。它适用于一个用户 ID，但如果有多个用户 ID，则会给我一个错误。错误是“警告：mysql_select_db()：提供的参数不是有效的 MySQL-Link 资源”

代码是

```
<?php 

function user_details($user_id) {

require_once('../Connections/runner.php'); 

if (!function_exists("GetSQLValueString")) {
function GetSQLValueString($theValue, $theType, $theDefinedValue = "", $theNotDefinedValue = "") 
{
  $theValue = get_magic_quotes_gpc() ? stripslashes($theValue) : $theValue;

  $theValue = function_exists("mysql_real_escape_string") ? mysql_real_escape_string   ($theValue) : mysql_escape_string($theValue);

  switch ($theType) {
    case "text":
      $theValue = ($theValue != "") ? "'" . $theValue . "'" : "NULL";
      break;    
    case "long":
    case "int":
      $theValue = ($theValue != "") ? intval($theValue) : "NULL";
      break;
    case "double":
      $theValue = ($theValue != "") ? "'" . doubleval($theValue) . "'" : "NULL";
      break;
    case "date":
      $theValue = ($theValue != "") ? "'" . $theValue . "'" : "NULL";
      break;
    case "defined":
      $theValue = ($theValue != "") ? $theDefinedValue : $theNotDefinedValue;
      break;
  }
  return $theValue;
}
}

$colname_users = $user_id;
$first_name = "";
$last_name = "";
mysql_select_db($database_runner, $runner);
$query_users = sprintf("SELECT first_name, last_name, profile_img_small FROM sign_up WHERE   user_id = %s", GetSQLValueString($colname_users, "int"));
$users = mysql_query($query_users, $runner) or die(mysql_error());
$row_users = mysql_fetch_assoc($users);
$totalRows_users = mysql_num_rows($users);
$first_name = $row_users['first_name'];
$last_name = $row_users['last_name'];
$profile_sml = $row_users['profile_img_small'];

echo "$first_name $last_name";
}

?>

<?php
$user_id = 10;
?>

<a href="*"><?php user_details("$user_id"); ?></a>

<?php
$user_id = 9;
?>

<a href="*"><?php user_details("$user_id"); ?></a> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-08T23:14:57.400

每次运行该函数时，您都试图只要求该文件一次。既然你说如果之前已经需要它就不需要它，它会看到它之前*已经*被需要，因此忽略它。因此，这些变量在您第二次调用它时不存在，并且该函数不可避免地什么都不做。我非常惊讶它不会产生其他错误，因为整个文件都丢失了。它一定不是非常重要。

# c# - XNA 和从文件中加载图像

> ID：10067310
> 
> 赞同：1
> 
> 时间：2012-04-08T23:10:57.320
> 
> 标签：c#, image, xna, loading, texture2d

我找到了直接从文件加载图像的方法，但是我加载的图像是蓝色的（原始图像是绿色的）。我坚持认为它的保存方式很糟糕，所以我用 Photoshop 保存了它，但没有任何改变。我猜我的程序运行不好。我该如何更改它，这是从文件加载图像的好方法吗？位图到 texture2d 方法：

```
 public static Texture2D GetTexture2DFromBitmap(GraphicsDevice device, Bitmap bitmap)
    {
        Texture2D tex = new Texture2D(device, bitmap.Width, bitmap.Height);
        System.Drawing.Imaging.BitmapData data = bitmap.LockBits(new System.Drawing.Rectangle(0, 0, bitmap.Width, bitmap.Height), System.Drawing.Imaging.ImageLockMode.ReadOnly, bitmap.PixelFormat);
        int bufferSize = data.Height * data.Stride;
        byte[] bytes = new byte[bufferSize];
        System.Runtime.InteropServices.Marshal.Copy(data.Scan0, bytes, 0, bytes.Length);
        tex.SetData(bytes);
        bitmap.UnlockBits(data);
        return tex;
    } 
```

加载图像行：

```
 backgroundTexture = Tools.GetTexture2DFromBitmap(device, (System.Drawing.Bitmap)System.Drawing.Image.FromFile(@"1.bmp", false)); 
```

绘制纹理方法：

```
 spriteBatch.Begin();
        Rectangle screenRectangle = new Rectangle(0, 0, screenWidth, screenHeight);
        spriteBatch.Draw(backgroundTexture, screenRectangle, Color.White);
        spriteBatch.End(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-08T23:43:49.157

嗯......我认为通过 Texture2D.FromStream 方法加载图像文件更容易......

纹理 = Texture2D.FromStream(Device, File.OpenRead(path));

是的，它只加载 jpg、png 和 gif 图像，但这是怎么回事？...转换bmp很容易..

# perl - 如何在 WWW::Mechanize 中处理一个简单的循环以提高效率

> ID：10067311
> 
> 赞同：0
> 
> 时间：2012-04-08T23:10:58.133
> 
> 标签：perl, parsing, loops, text-parsing, www-mechanize

我试图弄清楚为什么某些东西不起作用是学习 Perl 的好方法。有时您会发现一个错误，并希望能够找到解决方法。

我认为 Perl 是一种学习方式的好方法——通过第一种方法和现实世界的问题进行试验。

目前我正在做一个简单的网站爬虫，从法国餐馆的一些页面中提取信息——更准确地说是从巴黎地区的餐馆

我在巴黎寻找餐馆，我想拿出他们拥有的菜单......这只是一种通过脚本获得有用信息的方法。我的女朋友对新的食谱和菜单很感兴趣，所以我试着从世界上最好的厨房里得到一些意见；-)

**更新：**由于我们在 Google 的帮助和互动下编写了这个小脚本，因此我试图防止违反 Google 的 TOS。所以我认为我们需要在代码中有一个睡眠功能。脚本必须每十个结果就入睡。所以我们把事情整理好，尽量保存谷歌服务器，只使用一点谷歌的性能。你说什么！- 注意我是初学者.. oalders 建议看看 WWW::Mechanize::Cached - 这显然是一个伟大的胜利 - 使用 www::mechanize::cached 非常有帮助 - 它有助于保存资源，因为它会缓存结果并避免我们一遍又一遍地进行搜索。

***想要**什么***：* * 我在寻找一些**关键字*餐厅*、*巴黎*、*菜单*****

 **使用这些关键字，我尝试进行谷歌搜索。**注意**- 我认为有必要首先获取餐馆的页面，然后解析链接“菜单”的所有结果页面这只是一个示例，表明我们首先获得了餐馆的结果页面 - 可能使用搜索词：“巴黎”和“餐厅”。下一步是获取我们获得的页面 - 例如以下页面。我们必须用关键字“menu”解析它们，然后我需要拥有页面上包含的所有文本..- 请参阅此处的一些示例

[http://www.bouillon-chartier.com/index.php/en/menu](http://www.bouillon-chartier.com/index.php/en/menu) http://www.letrois.com/menu.php

我在这里有第一步 - 这里有一个：这是执行谷歌搜索的脚本

```
use WWW::Mechanize;
use 5.10.0;
use strict;
use warnings;

my $mech = new WWW::Mechanize;
my $option = $ARGV[$#ARGV];

# we may customize the google search by editing this url (always end it with "q=" though)
my $google = 'http://www.google.co.uk/search?q=';
my @dork = ("inurl:", "restaurant", "paris","menu");

#declare necessary variables
my $max = 0;
my $link;
my $sc = scalar(@dork);

#start the main loop, one itineration for every google search
for my $i ( 0 .. $sc ) {

    #loop until the maximum number of results chosen isn't reached
    while ( $max <= $option ) {
        $mech->get( $google . $dork[$i] . "&start=" . $max );

        #get all the google results
        foreach $link ( $mech->links() ) {
            my $google_url = $link->url;
            if ( $google_url !~ /^\// && $google_url !~ /google/ ) {
                say $google_url;
            }
        }
        $max += 10;
    }
} 
```

虽然这是一个很好的方法 - 它只是一个非常非常第一个方法：我们还有艰巨的任务：

如何获得大巴黎地区的所有餐厅 - 以及如何存储所有菜单！？这有点棘手 - 但我敢肯定。对我来说是学习 Perl 的重要一课。好吧，我从这里开始：好吧，我明白了-任务可以这样说明：如何在 WWW::Mechanize 中处理一个简单的循环以提高效率

但比上面提到的脚本更好，它会是这种方式（见下文） - 我想这项工作必须是两个折叠 - 如上所述......因为我们首先需要有结果页面餐厅 - 可能使用搜索词巴黎和餐厅，我们接下来会执行下一步以获取我们获得的页面 - 例如以下页面。我们必须用关键字“menu”来解析它们——我想我们可以用下面的这个脚本更好地做到这一点......

然后我需要页面上包含的所有文本..-

-http://www.bouillon-chartier.com/index.php/en/menu -http://www.letrois.com/menu.php

```
#call the mechanize object, with autocheck switched off
#so we don't get error when bad/malformed url is requested
my $mech = WWW::Mechanize->new(
   autocheck => 0
);
my %comments;
my %links;
my @comment;

my $target = "http://google.com";

#store the first target url as not checked
$links{$target} = 0;

#initiate the search
my $url = &get_url();

#start the main loop
while ( $url ne "" ) {

    #get the target url
    $mech->get($url);

    #search the source for any html comments
    my $res = $mech->content;
    @comment = $res =~ /<!--[^>]*-->/g;

    #store comments in 'comments' hash and output it on the screen, if there are any found
    $comments{$url} = "@comment" and say "\n$url \n---------------->\n $comments{$url}" if $#comment >= 0;

    #loop through all the links that are on the current page (including only urls that are contained in html anchor)

    foreach my $link ( $mech->links() ) {
        $link = $link->url();

        #exclude some irrelevant stuff, such as javascript functions, or external links
        #you might want to add checking domain name, to ensure relevant links aren't excluded

        if ( $link !~ /^(#|mailto:|(f|ht)tp(s)?\:|www\.|javascript:)/ ) {

            #check whether the link has leading slash so we can build properly the whole url
            $link = $link =~ /^\// ? $target . $link : $target . "/" . $link;

            #store it into our hash of links to be searched, unless it's already present
            $links{$link} = 0 unless $links{$link};
        }
    }

    #indicate we have searched this url and start over
    $links{$url} = 1;
    $url = &get_url();
}

sub get_url {
    my $key, my $value;

    #loop through the links hash and return next target url, unless it's already been searched
    #if all urls have been searched return empty, ending the main loop

    while ( ( $key, $value ) = each(%links) ) {
        return $key if $value == 0;
    }

    return "";
} 
```

好吧，我认为我首先必须获得餐厅所有网址的列表 - 然后我必须解析它们。因此 - 对于这两个折叠的任务，我必须重新设计脚本。

*   收集网址是第一步
*   解析它们 - 使用特殊目标“菜单”是第二步
*   第三个将是最困难的 - 我需要对菜单进行故事 - 带有标识符 - 餐厅的名称，

像这样

**1\.** [http://www.bouillon-chartier.com/index.php/en/menu](http://www.bouillon-chartier.com/index.php/en/menu)

**餐厅名称：** bouillon-chartier.com **菜单：** coq au vin, lorem ipsum

**2\.** [http://www.letrois.com/menu.php](http://www.letrois.com/menu.php)

**餐厅名称**letrois **菜单：**薄饼、炸薯条、lorem ipsum

所有菜单都应该存储在某种数据库中，或者至少应该以 csv 格式存储。但这将是最简单的部分。目前我试图弄清楚我们如何将第一步（获取网址）与第二步分开......即解析菜单的目标网址 - 并打开菜单并解析这个...... .

我们可以这样指定问题：如何在 WWW::Mechanize 中处理一个简单的循环以提高效率？**

# c# - 向 ASP.NET Dictionary 类添加项的哪种方法更有效？

> ID：10067315
> 
> 赞同：1
> 
> 时间：2012-04-08T23:11:37.247
> 
> 标签：c#, asp.net, performance, dictionary

我在 ASP.NET 中使用 C# 将逗号分隔的字符串列表转换为字典（通过省略任何重复项）：

```
string str = "1,2, 4, 2, 4, item 3,item2, item 3"; //Just a random string for the sake of this example 
```

我想知道哪种方法更有效？

1 - 使用 try/catch 块：

```
Dictionary<string, string> dic = new Dictionary<string, string>();

string[] strs = str.Split(',');
foreach (string s in strs)
{
    if (!string.IsNullOrWhiteSpace(s))
    {
        try
        {
            string s2 = s.Trim();
            dic.Add(s2, s2);
        }
        catch
        {
        }
    }
} 
```

2 - 或使用 ContainsKey() 方法：

```
string[] strs = str.Split(',');
foreach (string s in strs)
{
    if (!string.IsNullOrWhiteSpace(s))
    {
        string s2 = s.Trim();
        if (!dic.ContainsKey(s2))
            dic.Add(s2, s2);
    }
} 
```

**编辑。**感谢所有参与的人！

一个非常有趣的发现。如果你看下面dtb提供的答案，他提出了两种使用hashSet的方法。我会在这里给他们配音：

方法一：

```
var hashSet = new HashSet<string>(from s in str.Split(',')
                           where !string.IsNullOrWhiteSpace(s)
                           select s.Trim()); 
```

方法二：

```
var hashSet = new HashSet<string>();
foreach (string s in str.Split(','))
{
     if (!string.IsNullOrWhiteSpace(s))
     {
         hashSet.Add(s.Trim());
     }
} 
```

我问他哪种方法在性能方面更快，有趣的是，方法 2 更快。这是使用 Stopwatch 类完成的计时，方法是在一个循环中运行发布版本中的每个方法 1,000,000 次：

```
Method 1: 1,440 ms average
Method 2: 1,124 ms average 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-08T23:14:42.873

如果您需要一个集合而不是字典，我建议您使用[HashSet<T> 类](http://msdn.microsoft.com/en-us/library/bb359438.aspx)：

> *HashSet<T> 类*
> 
> 表示一组值。
> 
> 集合是不包含重复元素且其元素没有特定顺序的集合。

* * *

```
var hashSet = new HashSet<string>(from s in str.Split(',')
                                  where !string.IsNullOrWhiteSpace(s)
                                  select s.Trim()); 
```

或同样

```
var hashSet = new HashSet<string>();
foreach (string s in str.Split(','))
{
    if (!string.IsNullOrWhiteSpace(s))
    {
        hashSet.Add(s.Trim());
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-08T23:14:46.437

看起来您不需要字典：一个简单的 LINQ 表达式应该为您提供一个没有重复项的列表：

```
var res = str
    .Split(',')
    .Where(s => !string.IsNullOrWhitespace(s))
    .Select(s => s.Trim())
    .Distinct()
    .ToList(); 
```

如果你坚持要有字典，你可以`ToDictionary`改用：

```
var res = str
    .Split(',')
    .Where(s => !string.IsNullOrWhitespace(s))
    .Select(s => s.Trim())
    .Distinct()
    .ToDictionary(s=>s, s=>s); 
```

强烈建议不要在正常程序流中使用`try/catch`，因为它隐藏了您的意图：C# 中的异常是为异常情况保留的，而不是您可以安全地用`if / then / else`条件捕获的常规事物。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-08T23:14:19.453

方法 2 使用`.ContainsKey`,比抑制异常更符合*语义*，并且很可能更有效。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-08T23:16:25.930

使用异常来控制预期的执行流程通常是不受欢迎的，而且捕获异常的成本很高，所以我会选择 v2。如果它对你来说真的很重要，为什么不建立一个基准呢？我猜 2 是“更有效率”，但你可以很容易地确认这一点。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-08T23:22:56.910

如果您没有使用字典中的值，则可以使用 a`HashSet<string>`代替，并且将项目添加到哈希集中会自动删除重复项：

```
HashSet<string> set = new HashSet<string>(
  str.Split(',')
  .Select(s => s.Trim())
  .Where(s => s.Length > 0)
); 
```

# mysql - 从数据库中获取新闻项目的文件路径的最佳解决方案是什么？

> ID：10067316
> 
> 赞同：0
> 
> 时间：2012-04-08T23:11:37.467
> 
> 标签：mysql, sql, database

我有两张桌子：`news`和`news_files`。该`news`表包含`newsId`和其他一些列，`news_files`包含`newsId`和`filePath`。作为`news`记录，您至少可以拥有 5 个文件。

在一个查询中检索此特定记录的所有列`news`和所有文件而不重复的最佳解决方案是什么？`news`

到目前为止，我有以下查询，但是对于每个`news_files`它都返回相同的记录（每个记录相同的`news`一行）。`filePath``news`

```
select n.* from news n 
left outer join news_files nf on n.Id = nf.newsid 
where n.Id = 1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T23:46:48.257

对于一对多的关系，`news`喜欢`news_files`，为了将它们全部放入一个查询中，正如您所发现的，您需要为“many”表中的每个相关行从“one”中检索重复的列值。

但是，我质疑是否需要在单个查询中执行此操作。`news_files`对于一对一的关系，如果每行只有`news`一行，那么尝试在一个查询中生成它们是有意义的。但是对于一对多，您不妨只查询主表，然后从“多”关系表中查询相关行。

```
/* Returns duplicate column values for each news_files row */
/* and all columns from both tables */
SELECT
  n.*,
  nf.*
FROM 
  news n
  LEFT OUTER JOIN news_files nf ON n.Id = nf.newsid
WHERE n.Id = 1 
```

但是，您可以使用逗号分隔的列表从列表中检索*一*列，但这与仅检索所有行并不完全相同。虽然 MySQL 允许未出现在列表中的列存在，但其他 RDBMS 不允许，因此为了可移植性，将其放置在子查询中以连接主表并检索所有列。`news_files``GROUP_CONCAT()``GROUP BY``SELECT``GROUP_CONCAT()`

```
/* Comma-separated list of filePath and all cols from news */
SELECT 
  n.*,
  nf.files
FROM
  news 
  LEFT OUTER JOIN (
    SELECT newsid, GROUP_CONCAT(filePath) AS files FROM news_feeds
    GROUP BY newsid
  ) nf ON n.Id = nf.newsid 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T03:33:40.287

这是假设您在 news 中有 2 列，在 news_files 中有 2 列...用 null 填充，但是您需要它们。

```
select n.Id, n.someothercolumn, null as newsId, null as filepath
from news n
where Id = 1

union

select null, null, nf.newsId, nf.filepath
from new_files nf
where newedId = 1

order by isnull(Id, newsId) 
```

不是最优雅的，但如果你需要一些快速和肮脏的东西，应该可以工作！

# c++ - 随机游走 - 布朗运动

> ID：10067325
> 
> 赞同：2
> 
> 时间：2012-04-08T23:12:53.897
> 
> 标签：c++, random

我被分配了创建一个简单控制台应用程序的项目。在 2D 平面上模拟布朗运动。我没有得到太多关于如何做到这一点的信息（我希望这是一个非常受欢迎的任务，以便我能得到一些见解），只是它依赖于随机数生成。我研究了一点布朗运动，看到了一些看起来很复杂的公式，但根据描述，似乎只是在一定的数字区间内随机移动。谁能澄清一下？我是要创建一个程序，在一个区间内不断创建一个随机数，然后修改粒子“x”和“y”坐标，还是还有更多？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-08T23:19:08.707

布朗运动是随机空气分子撞击小粒子的结果。由于一堆随机力的总和不太可能正好为 0，而且粒子的质量如此之小，它似乎在左右摇晃，因此是布朗运动。所以你会得到一个看起来随机的运动，但并不统一。

建模它的愚蠢方法是获得数百个空气分子的方向的均匀分布和动量的高斯分布，对粒子应用碰撞，然后得到总和。多次这样做，你会得到布朗型运动。（单个空气分子的平均动量取决于温度，空气分子的数量取决于压力。）

请注意，由此产生的运动不是高斯运动，而是来自高斯分布的许多样本的总和。不知道叫什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-08T23:19:51.363

请记住，随机运动不是“均匀的”，而是如果您绘制运动频率与运动距离的关系图，您会发现大多数都很短，有些较长，有些很长，产生类似于指数的东西衰退。

我不记得运动观察到的统计曲线是什么，但是您可能可以弄清楚，然后您需要制作一个随机数生成器来生成适合该曲线的值。

我要做的是使用这个 RNG 计算距离，然后使用统一的 RNG 来计算从零到 2*pi 的角度，并使运动为极坐标。您可以分别计算随机 X 和随机 Y，但我不确定您是否会得到相同的分布。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T05:11:17.837

你的问题非常不恰当。这几乎肯定不是你的错，因为你的导师应该已经向你指出，布朗运动的正确实现需要大量非常复杂的规范和问题域分析，甚至在你开始编码之前。

除非你学过测度论的相关课程，否则布朗运动的精确定义可能对你来说是不透明的。然而，网上有大量资源可以充分描述伊藤过程（布朗运动就是一个例子）。

如果您有兴趣编写这样的过程，这里有一个不错的提示。在某个阶段，您将需要生成随机数。几乎可以肯定，您会对从正态分布生成绘图感兴趣。值得庆幸的是，C++ 程序员有一些很好的方法可以做到这一点。我最喜欢的是使用 Boost.Random 库（或 C++11 中的相关库）。最聪明的策略是使用函数对象来生成随机变量，可能是使用 variate_generator：

```
#include <iostream>
#include <vector>
using namespace std;

#include <boost/random/mersenne_twister.hpp>
#include <boost/random/normal_distribution.hpp>
#include <boost/random/variate_generator.hpp>

int main()
{
  // Some typedefs to help keep the code clean
  // Always a good idea when using Boost!
  typedef boost::mt19937                                      T_base_prng;
  typedef boost::normal_distribution<>                        T_norm_varg;
  typedef boost::variate_generator<T_base_prng&, T_norm_dist> T_norm_varg;

  unsigned int base_seed = 42;  // Seed for the base pseudo-random number generator
  double       mean      = 0.0; // Mean of the normal distribution
  double       stdev     = 1.0; // Standard deviation of the normal distribution
  T_base_prng  base_prng(base_seed); // Base PRNG
  T_norm_dist  norm_dist(mean, stdev); // Normal distribution
  T_norm_varg  norm_varg(base_prng, norm_dist); // Variate generator

  // Generate 1000 draws from a standard normal distribution
  vector<double> drawVec(1000);
  for (vector<double>::iterator iter = drawVec.begin(); 
       iter != drawVec.end(); ++iter)
  {
    *iter = norm_varg();
  }

  // More stuff...

  return 0;
} 
```

一旦你掌握了布朗运动是什么，那么使用 Boost.Random 中的功能构建一些示例应该是微不足道的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-08T23:20:03.383

是的，您只需在每个时间步将随机数添加到`x`和`y`坐标中，如下所示：

```
int x=0, y=0;

for (int t=0; t<N; t++) {
    x += distribution(gen);
    y += distribution(gen);
    display(x, y);
} 
```

其中分布可以简单为`{0,1}`、区间或高斯分布。

**编辑：**对于非常大的 N，您可以测量平均距离`R = d(x,y)`并检查它是否像`t ~ R^2`. 当然，上面的代码只产生一个布朗运动，为了保持关系，你必须重复很多次。自己做实验。

# c++ - 我无法在 Visual Studio 2010 中编译

> ID：10067326
> 
> 赞同：6
> 
> 时间：2012-04-08T23:13:07.143
> 
> 标签：c++, visual-studio-2010

我总是在 Visual Studio 2010 中编译程序时遇到很多问题。我为我的绿色表示歉意。我收到 LNK 错误，不确定是什么原因造成的。我希望有人能够从构建日志中发现一些东西。大概是什么傻事……

```
Build started 4/8/2012 3:22:37 PM.
 1>Project "c:\Users\Donald\documents\visual studio 2010\Projects\ClientServer\myClient\myClient.vcxproj" on node 2 (build target(s)).
 1>InitializeBuildStatus:
     Touching "Debug\myClient.unsuccessfulbuild".
   ClCompile:
     c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\bin\CL.exe /c /ZI /nologo /W3 /WX- /Od /Oy- /D WIN32 /D _DEBUG /D _CONSOLE /D _UNICODE /D UNICODE /Gm /EHsc /RTC1 /MDd /GS /fp:precise /Zc:wchar_t /Zc:forScope /Fo"Debug\\" /Fd"Debug\vc100.pdb" /Gd /TP /analyze- /errorReport:prompt mySocket.cpp
     mySocket.cpp
 1>c:\users\donald\documents\visual studio 2010\projects\clientserver\myclient\mysocket.cpp(1191): warning C4996: 'sprintf': This function or variable may be unsafe. Consider using sprintf_s instead. To disable deprecation, use _CRT_SECURE_NO_WARNINGS. See online help for details.
             c:\program files (x86)\microsoft visual studio 10.0\vc\include\stdio.h(371) : see declaration of 'sprintf'
   ManifestResourceCompile:
     C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\bin\rc.exe /nologo /fo"Debug\myClient.exe.embed.manifest.res" Debug\myClient_manifest.rc 
   Link:
     c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\bin\link.exe /ERRORREPORT:PROMPT /OUT:"c:\users\donald\documents\visual studio 2010\Projects\ClientServer\Debug\myClient.exe" /INCREMENTAL /NOLOGO kernel32.lib user32.lib gdi32.lib winspool.lib comdlg32.lib advapi32.lib shell32.lib ole32.lib oleaut32.lib uuid.lib odbc32.lib odbccp32.lib /MANIFEST /ManifestFile:"Debug\myClient.exe.intermediate.manifest" /MANIFESTUAC:"level='asInvoker' uiAccess='false'" /DEBUG /PDB:"c:\users\donald\documents\visual studio 2010\Projects\ClientServer\Debug\myClient.pdb" /SUBSYSTEM:CONSOLE /TLBID:1 /DYNAMICBASE /NXCOMPAT /IMPLIB:"c:\users\donald\documents\visual studio 2010\Projects\ClientServer\Debug\myClient.lib" /MACHINE:X86 Debug\myClient.exe.embed.manifest.res
     Debug\myClient.obj
     Debug\myException.obj
     Debug\myHostInfo.obj
     Debug\myLog.obj
     Debug\mySocket.obj
     Debug\stdafx.obj
 1>myClient.obj : error LNK2019: unresolved external symbol __imp__inet_ntoa@4 referenced in function "public: char * __thiscall myHostInfo::getHostIPAddress(void)" (?getHostIPAddress@myHostInfo@@QAEPADXZ)
 1>mySocket.obj : error LNK2001: unresolved external symbol __imp__inet_ntoa@4
 1>myHostInfo.obj : error LNK2019: unresolved external symbol __imp__gethostbyname@4 referenced in function "public: __thiscall myHostInfo::myHostInfo(void)" (??0myHostInfo@@QAE@XZ)
 1>myHostInfo.obj : error LNK2019: unresolved external symbol __imp__gethostname@8 referenced in function "public: __thiscall myHostInfo::myHostInfo(void)" (??0myHostInfo@@QAE@XZ)
 1>myHostInfo.obj : error LNK2019: unresolved external symbol __imp__gethostbyaddr@12 referenced in function "public: __thiscall myHostInfo::myHostInfo(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > &,enum hostType)" (??0myHostInfo@@QAE@AAV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@W4hostType@@@Z)
 1>myHostInfo.obj : error LNK2019: unresolved external symbol __imp__inet_addr@4 referenced in function "public: __thiscall myHostInfo::myHostInfo(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > &,enum hostType)" (??0myHostInfo@@QAE@AAV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@W4hostType@@@Z)
 1>mySocket.obj : error LNK2001: unresolved external symbol __imp__inet_addr@4
 1>myHostInfo.obj : error LNK2019: unresolved external symbol __imp__WSAGetLastError@0 referenced in function "private: void __thiscall myHostInfo::detectErrorGethostbyname(int *,class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > &)" (?detectErrorGethostbyname@myHostInfo@@AAEXPAHAAV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@@Z)
 1>mySocket.obj : error LNK2001: unresolved external symbol __imp__WSAGetLastError@0
 1>mySocket.obj : error LNK2019: unresolved external symbol __imp__htons@4 referenced in function __catch$??0mySocket@@QAE@H@Z$0
 1>mySocket.obj : error LNK2019: unresolved external symbol __imp__htonl@4 referenced in function __catch$??0mySocket@@QAE@H@Z$0
 1>mySocket.obj : error LNK2019: unresolved external symbol __imp__socket@12 referenced in function "public: __thiscall mySocket::mySocket(int)" (??0mySocket@@QAE@H@Z)
 1>mySocket.obj : error LNK2019: unresolved external symbol __imp__closesocket@4 referenced in function "public: virtual __thiscall mySocket::~mySocket(void)" (??1mySocket@@UAE@XZ)
 1>mySocket.obj : error LNK2019: unresolved external symbol __imp__setsockopt@20 referenced in function "public: void __thiscall mySocket::setDebug(int)" (?setDebug@mySocket@@QAEXH@Z)
 1>mySocket.obj : error LNK2019: unresolved external symbol __imp__ioctlsocket@12 referenced in function "public: void __thiscall mySocket::setSocketBlocking(int)" (?setSocketBlocking@mySocket@@QAEXH@Z)
 1>mySocket.obj : error LNK2019: unresolved external symbol __imp__getsockopt@20 referenced in function "public: int __thiscall mySocket::getDebug(void)" (?getDebug@mySocket@@QAEHXZ)
 1>mySocket.obj : error LNK2019: unresolved external symbol __imp__WSACleanup@0 referenced in function "public: virtual __thiscall myTcpSocket::~myTcpSocket(void)" (??1myTcpSocket@@UAE@XZ)
 1>mySocket.obj : error LNK2019: unresolved external symbol __imp__WSAStartup@8 referenced in function "public: static void __cdecl myTcpSocket::initialize(void)" (?initialize@myTcpSocket@@SAXXZ)
 1>mySocket.obj : error LNK2019: unresolved external symbol __imp__bind@12 referenced in function "public: void __thiscall myTcpSocket::bindSocket(void)" (?bindSocket@myTcpSocket@@QAEXXZ)
 1>mySocket.obj : error LNK2019: unresolved external symbol __imp__connect@12 referenced in function "public: virtual void __thiscall myTcpSocket::connectToServer(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > &,enum hostType)" (?connectToServer@myTcpSocket@@UAEXAAV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@W4hostType@@@Z)
 1>mySocket.obj : error LNK2019: unresolved external symbol __imp__accept@12 referenced in function "public: class myTcpSocket * __thiscall myTcpSocket::acceptClient(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > &)" (?acceptClient@myTcpSocket@@QAEPAV1@AAV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@@Z)
 1>mySocket.obj : error LNK2019: unresolved external symbol __imp__listen@8 referenced in function "public: void __thiscall myTcpSocket::listenToClient(int)" (?listenToClient@myTcpSocket@@QAEXH@Z)
 1>mySocket.obj : error LNK2019: unresolved external symbol __imp__send@16 referenced in function "public: int __thiscall myTcpSocket::sendMessage(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > &)" (?sendMessage@myTcpSocket@@QAEHAAV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@@Z)
 1>mySocket.obj : error LNK2019: unresolved external symbol __imp__recv@16 referenced in function "private: int __thiscall myTcpSocket::XPrecieveMessage(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > &)" (?XPrecieveMessage@myTcpSocket@@AAEHAAV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@@Z)
 1>c:\users\donald\documents\visual studio 2010\Projects\ClientServer\Debug\myClient.exe : fatal error LNK1120: 21 unresolved externals
 1>Done Building Project "c:\Users\Donald\documents\visual studio 2010\Projects\ClientServer\myClient\myClient.vcxproj" (build target(s)) -- FAILED.

Build FAILED.

Time Elapsed 00:00:03.54 
```

任何帮助，将不胜感激。代码之前已经编译好了。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-08T23:37:48.573

上面发布的错误说，链接器找不到包含在**Ws2_32**库中的符号，该库包含与网络相关的函数。

将此库添加到链接器参数：

1.  打开项目的属性页对话框。有关详细信息，请参阅设置 Visual C++ 项目属性。
2.  单击链接器文件夹。
3.  单击输入属性页。
4.  修改 Additional Dependencies 属性，添加**Ws2_32.lib**

# ruby-on-rails - config.assets.precompile 不添加供应商/宝石资产

> ID：10067327
> 
> 赞同：13
> 
> 时间：2012-04-08T23:13:17.677
> 
> 标签：ruby-on-rails, asset-pipeline, assets, precompile

我无法将供应商化的资产编译为根文件。

我想让以下资产独立可用（不与其他资产打包_：

```
vendor/gems/neo-viz/app/assets/stylesheets/neo-viz.css.scss
vendor/gems/neo-viz/app/assets/javascripts/neo-viz.js.coffee
vendor/gems/neo-viz/app/assets/javascripts/lib/jQuery/jquery-1.6.1.min.js
vendor/gems/neo-viz/app/assets/javascripts/lib/arbor/arbor.js 
```

使用以下行：

```
config.assets.precompile += %w( jquery-1.6.1.min.js arbor.js neo-viz.js neo-viz.css ) 
```

只有 css 文件被预编译并可用。为什么？

另外，在看到这个问题（[在 Rails 中使用 config.assets.precompile 包括子目录中的资产](https://stackoverflow.com/questions/10038867/including-assets-in-subdirectories-with-config-assets-precompile-in-rails)）后，我尝试了：

```
config.assets.precompile += %w( jquery-1.6.1.min.js arbor.js neo-viz.js neo-viz.css lib/arbor/arbor.js arbor/arbor.js lib/jQuery/jquery-1.6.1.min.js jQuery/jquery-1.6.1.min.js   ) 
```

但这并没有什么不同。想法？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-27T17:13:30.583

默认情况下，Rails 只查看 3 个位置`app/assets`：`lib/assets`或`vendor/assets`. Sprockets 在子目录中寻找 JS 资产`javascripts`。例如

```
app/assets/javascripts/arbor.js
lib/assets/javascripts/arbor.js
vendor/assets/javascripts/arbor.js 
```

如果你想查看 Rails 在哪里寻找你可以在控制台中使用它：`Rails.application.config.assets.paths`

您可以做的是将您的自定义路径添加到管道：

```
 # @file: config/application.rb
 config.assets.paths << Rails.root.join("vendor", "gems", "neo-viz", "app", "assets", "javascripts") 
```

然后创建一个清单，其中包含您的 JS 文件：

```
# @file: /vendor/gems/neo-viz/app/assets/javascripts/neo-viz.js
//= require lib/jQuery/jquery-1.6.1.min
//= require lib/arbor/arbor
//= require neo-viz 
```

最后添加您的清单：

```
config.assets.precompile += %w( neo-viz.js )' 
```

如果您仍然想单独添加它们，我没有看到这一点，为什么不将它们包含在清单中，那么您必须添加**所有**可能的路径前缀，以便 Rails 知道在哪里查找：

```
 # @file: config/application.rb
 config.assets.paths << Rails.root.join("vendor", "gems", "neo-viz", "app", "assets", "stylesheets")
 config.assets.paths << Rails.root.join("vendor", "gems", "neo-viz", "app", "assets", "javascripts")
 config.assets.paths << Rails.root.join("vendor", "gems", "neo-viz", "app", "assets", "javascripts", "lib", "jQuery")
 config.assets.paths << Rails.root.join("vendor", "gems", "neo-viz", "app", "assets", "javascripts", "lib", "arbor") 
```

然后你可以像这样添加它们，因为清单之外的资产必须添加到预编译数组中：

```
config.assets.precompile += %w( jquery-1.6.1.min.js arbor.js neo-viz.js neo-viz.css ) 
```

资料来源：[2.1 资产组织](http://guides.rubyonrails.org/asset_pipeline.html#asset-organization)

# database - 如何构建Referer统计数据库表？

> ID：10067331
> 
> 赞同：0
> 
> 时间：2012-04-08T23:14:25.083
> 
> 标签：database, database-design, statistics, database-schema

我想知道推荐人统计表的良好结构是什么。我的意思是，我有很多用户。我给他们一个推荐系统并希望向他们展示适当的统计数据（例如每月/每天的点击量和推荐用户）。你会怎么做？

最好的问候， .wired

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-08T23:18:32.513

创建一个包含原始数据的表。然后，为不同的聚合级别创建物化视图。如果您的 RDBMS 不支持它们，请手动创建聚合表。

如果性能不是问题，请不要费心创建聚合表。在这种情况下，您可以使用简单的视图，这将节省您的开发工作量。

# spring - 如何将 spring 控制器 URL 配置为没有扩展名？

> ID：10067336
> 
> 赞同：1
> 
> 时间：2012-04-08T23:14:57.037
> 
> 标签：spring, spring-mvc, controller, spring-3

我的控制器目前被映射为[http://example.com/fix.go](http://example.com/fix.go)之类的东西，当然，我认为这很愚蠢，想要更好的东西，比如[http://example.com/fix](http://example.com/fix)或[http://example。 com/mmm/fix](http://example.com/mmm/fix)没有扩展名。但是，当我尝试配置它时，我无法让它工作。我显然错过了理解整个映射的关键部分。我正在为控制器使用 Spring 3.x、tomcat 和注释。

我的 web.xml 如下：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app
    version="2.4"
    xmlns="http://java.sun.com/xml/ns/j2ee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd">

    <servlet>
        <servlet-name>BooBoo</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet-mapping>
        <servlet-name>BooBoo</servlet-name>
        <url-pattern>*.*</url-pattern>   <!-- was *.go when it worked -->
    </servlet-mapping>

    <welcome-file-list>
        <welcome-file>index.jsp</welcome-file>
    </welcome-file-list>

</web-app> 
```

BooBoo-servlet.xml 是：

```
<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:p="http://www.springframework.org/schema/p" 
    xmlns:context="http://www.springframework.org/schema/context"
    xsi:schemaLocation="
        http://www.springframework.org/schema/mvc
            http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd
        http://www.springframework.org/schema/beans 
            http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
        http://www.springframework.org/schema/context 
            http://www.springframework.org/schema/context/spring-context-3.0.xsd">

    <context:component-scan base-package="com.foofoo.booboo"/>

    <bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver">
        <property name="viewClass" value="org.springframework.web.servlet.view.JstlView"/>
        <property name="prefix" value="/jsp/"/>
        <property name="suffix" value=".jsp"/>
    </bean>

</beans> 
```

我的一个控制器配置如下：

```
@Controller
public class BangBangController extends BaseController {

            // Used to be fix.go when it worked
    @RequestMapping( value="fix", method=RequestMethod.GET )
    public ModelAndView choose(
            HttpSession session,
            @RequestParam( value="fixId", required=false, defaultValue="-1" ) Integer fixId,
            @RequestParam( value="forkId", required=false, defaultValue="-1" ) Integer forkId 
    )
    throws Exception { ... }
} 
```

我已经尝试将 web.xml 中的映射更改为 /mmm/* 期望像[http://example.com/mmm/fix](http://example.com/mmm/fix)这样的 URL可以工作，但这也没有奏效。当我在浏览器中输入我认为正确的 URL 时，出现“缺少资源”错误。

我在这里胡闹什么？我缺乏什么关键的理解？我已经尝试让无扩展的东西在另一个工作项目上工作，但也无法让它去那里。我显然错过了一些东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T23:18:17.157

问题是您的调度程序 servlet 匹配任何带有“.”的内容。在里面。

将其更改为

```
 <url-pattern>/*</url-pattern> 
```

但是，这也很糟糕，因为您将无法提供静态内容。

你真正应该做的是：

```
 <url-pattern>/webapp/*</url-pattern> 
```

其中“webapp”是一些前缀。您的所有 URL 都需要以它为前缀，但这仍然允许您提供静态内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T03:27:40.540

答案是我弄乱了 spring-servlet.xml 文件，没有指定我使用的是 Spring MVC 的东西。我感谢克里斯在诊断问题方面的帮助。我需要确认我尝试过的一些事情（但由于这个错误而失败）是正确的。

我添加了

```
xmlns:mvc="http://www.springframework.org/schema/mvc" 
```

和

```
<mvc:annotation-driven /> 
```

到那个文件，然后繁荣，它开始工作了。让我摸不着头脑的是，“没有它怎么办？” 因为它适用于 *.go 模式。

这是完整的结果文件：

```
<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:p="http://www.springframework.org/schema/p" 
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:mvc="http://www.springframework.org/schema/mvc"
    xsi:schemaLocation="
        http://www.springframework.org/schema/mvc
            http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd
        http://www.springframework.org/schema/beans 
            http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
        http://www.springframework.org/schema/context 
            http://www.springframework.org/schema/context/spring-context-3.0.xsd">

    <context:component-scan base-package="com.barbar.foofoo"/>

    <!-- Enables the Spring MVC @Controller programming model -->
    <mvc:annotation-driven />

    <!--
    Declare View Resolver: when view 'view_name' is called (from the Controller), 
    the file '/jsp/view_name.jsp' will be used.
    -->
    <bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver">
        <property name="viewClass" value="org.springframework.web.servlet.view.JstlView"/>
        <property name="prefix" value="/jsp/"/>
        <property name="suffix" value=".jsp"/>
    </bean>

</beans> 
```

# prolog - 为什么重复不起作用？

> ID：10067341
> 
> 赞同：1
> 
> 时间：2012-04-08T23:16:22.120
> 
> 标签：prolog

```
genVertex(List,Row,Col,Result) :-
   Col1 is Col,
   repeat,
   (Col \= Row ->   
   calculateSum(List,List,Row,Col1,Y),write(Y),write('\n'),
   Result = [Y|Tail]
   ;Result = Tail
   ),
   Col1 is Col1 + 1,
   Col1 == 5. 
```

我想以 Col + 1 的增量调用 calculateSum 直到 Col1 为 5？

或任何其他方式来实现这一目标？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-08T23:30:29.117

`repeat/0`可能不会像您认为的那样做。`repeat/0`创造了无限的选择点。基本上使用的`repeat/0`只是副作用谓词。我建议您在正确理解 Prolog 执行之前不要使用它（即使那样，它也是一种无用的习语）。

尝试实现适当的递归（如果需要，请参阅[教程](http://www.learnprolognow.org/lpnpage.php?pagetype=html&pageid=lpn-htmlch3)）。另一个好的解决方案是使用高阶谓词，但在获得基本 Prolog 之前我不会这样做。

# android - Android：如果一行没有足够的空间，如何让两个TextViews放在不同的行中

> ID：10067347
> 
> 赞同：1
> 
> 时间：2012-04-08T23:17:42.173
> 
> 标签：android, user-interface, textview

我正在尝试组织两个 TextView 的行为：

![例子](../Images/cc7079c43b379bfae16f2f69d4f97e3e.png)

因此，如果两个 TextView 有足够的空间放在一行中，android 应该将它们放在一行中。

如果没有足够的空间，第二个 TextView 必须放在右对齐的下一行。

```
 <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="horizontal" >

        <TextView
            android:id="@+id/takeoffCity"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            style="@style/flightItem" />

        <TextView
            android:id="@+id/landingCity"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            style="@style/flightItem" />
    </LinearLayout>

<style name="flightItem" parent="@android:style/TextAppearance">
    <item name="android:textSize">14dip</item>
    <item name="android:textColor">@color/flightItemFont</item>
    <item name="android:scrollHorizontally">true</item>
    <item name="android:textStyle">bold</item>
</style> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T23:51:03.390

要完成您正在寻找的内容，您可以将您的布局更改为 a`RelativeLayout`并添加`android:layout_alignParentLeft="true"`到您的`TextViews`，**但是**，这不会将这些设置`TextViews`为动态操作。这意味着如果它们可以并排放置，那么它们应该是`TextView`对齐的，但底部仍然会向右对齐。

我认为您正在寻找的东西在技术上是不可能的。但是，这可能是一个不错的选择：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal" >

    <TextView
        android:id="@+id/takeoffCity"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        style="@style/flightItem" />

    <TextView
        android:id="@+id/landingCity"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        style="@style/flightItem" />

</RelativeLayout> 
```

# java - 从对象的数组列表中调用方法

> ID：10067349
> 
> 赞同：2
> 
> 时间：2012-04-08T23:17:54.583
> 
> 标签：java, methods, static, arraylist, non-static

我刚开始使用 Java，但在使用以下代码时遇到了问题。我正在使用这样的东西从静态方法调用非静态应用方法，但我认为它不是很有效。我设置了需要应用的规则的数组列表，但我无法让它工作。

```
 ClassificationRule rules = new RuleFirstOccrnc();
    ClassificationRule rules1 = new RuleOccrncCount();
    rules.apply(aUserInput);
    rules1.apply(aUserInput); 
```

尝试从 ClassificationRule 调用 apply() 方法时出现此错误“方法 apply(String) 未定义用于类型 ArrayList”。任何帮助将不胜感激！

```
package tweetClassification;

import java.util.ArrayList;

public class PrioritRuls {

    //Set of rules to be applied
    final static ArrayList<ClassificationRule> rulesA
        = new ArrayList<ClassificationRule>();

    static{
        rulesA.add( new RuleFirstOccrnc() );
        rulesA.add( new RuleOccrncCount() );
    }

    // ******************************************* 
    public static void prioritize( final String aUserInput ){

        rulesA.apply(aUserInput); //ERROR
       // The method apply(String) is undefined
       // for the type ArrayList<ClassificationRule>
        }
} 
package tweetClassification;

public class ClassificationRule {

     // *******************************************
     public void apply (final String aUserInput) {  

        apply( aUserInput );
        }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-08T23:20:42.603

对，因为您调用的`apply`是数组列表对象的方法，而不是数组列表的内容。

将其更改为类似

```
rulesA.get(0).apply() 
```

或者，如果你想在每个元素上调用它，你需要遍历列表。

```
for (ClassificationRule rule:rulesA){
  rule.apply(aUserInput);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-08T23:20:56.610

**您正在尝试在`apply()``ArrayList``ClassificationRule`**对象**上调用。**`ArrayList`没有这种方法，所以正如预期的那样 - 你得到一个编译错误。

您可能希望使用[for-each 循环](http://docs.oracle.com/javase/1.5.0/docs/guide/language/foreach.html)在每个对象上**迭代**`ArrayList`and ：`apply()``ClassificationRule`

```
for (ClassificationRule rule : rulesA) rule.apply(aUserInput) 
```

或`apply()`在**特定元素**上：

```
rulesA.get(someIndex).apply(aUserInput) 
```

**还有一件事：**

```
public void apply (final String aUserInput) {  
   apply( aUserInput );
} 
```

将导致**无限递归**调用`apply()`[嗯，不完全是无限的，它最终会抛出异常]。这不是您当前遇到的错误，因为这是运行时错误，而您仍然陷入编译时错误。

# ruby-on-rails - ActiveRecord中的PostgreSQL继承？

> ID：10067354
> 
> 赞同：14
> 
> 时间：2012-04-08T23:18:28.793
> 
> 标签：ruby-on-rails, postgresql, inheritance, activerecord

所以我们都知道 Rails 的 STI（单表继承）是 icky，因为它会导致数据模型混乱和数据库不理想。

然而 PostgreSQL 似乎非常漂亮地处理继承！

有没有办法在利用 Postgres 继承而不是痛苦的宽表和“类型”列的同时获得 rails 干净的 STI API？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-18T17:29:04.040

> 然而 PostgreSQL 似乎非常漂亮地处理继承！

真的吗？你仔细看[说明书上的小字了](http://www.postgresql.org/docs/current/interactive/ddl-inherit.html#DDL-INHERIT-CAVEATS)吗？例如：

*   唯一约束（因此也是主键）在继承级别上是不可能的*。*
*   对继承表和基表的引用不混合。即（大致取自手册）：`capitals`extends `cities`。您的`address`表要引用`cities`. 它可以。`capital`但是可以使用带有a的no地址。

这两件事在小型“Hello World”项目之外的任何事情中都*非常*重要。所以我无法想象，任何有成效的事情都可以使用 PostgreSQL 继承来实现。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-18T16:07:27.333

简而言之 - 没有漂亮干净的 STI API 可以用于您现在尝试完成的工作。

实际上，大约一年前我对此进行了研究，并得出结论认为这不是一个好主意，原因如下：

1.  如果您想利用 PostgreSQL 的特定功能 - 您基本上就是将自己嫁给了那个数据库。不要误会我的意思，PostgreSQL 是一个很棒的数据库，我已经用过很多次了，但是你会被那个数据库和应用程序设计所困。
2.  最有可能的是，如果您开始使用 DB 特定功能，您最终要么手动实现它们（在 DB 上运行某种命令或使用 GUI），要么编写某种脚本，当您运行 db:migrate 时必须调用这些脚本（如果你想进行适当的测试，你必须这样做）。一段时间后，它变得繁琐和烦人。
3.  如果你发现你越来越恼火，引用你**“痛苦的宽表和”类型“列”** 然后：
    *   您的餐桌设计需要重新考虑和重做
    *   您的模型可能不适合 STI
    *   你只需要忍受它。

大多数 IT 问题实际上都归结为：**努力与收益。**

在您的情况下，您应该问自己这个问题：

*   如果它只会将原始 SQL 查询速度提高几秒钟，那么您想花多少时间来实现更好的 STI 结构？也许写一个更明确的 SQL 查询会更好？大多数应用程序不会增长到真正成为问题的大小。但在你的情况下可能会有所不同。

**PS：**

还有一个关于在您的应用程序中构建 STI 的快速提示：如果您发现有很多使用 STI 的模型，例如 ProductCategory、CommentCategory、PhoneCategory、ClientCategory，它们都继承自 Cateogory - 我倾向于将它们组织在模型目录内的文件夹中。然后在**application.rb**中添加一行：`config.autoload_paths += Dir[Rails.root.join('app', 'models', '{**/**}')]`

# html - Dojox 手机后退按钮

> ID：10067357
> 
> 赞同：0
> 
> 时间：2012-04-08T23:19:10.247
> 
> 标签：html, javascript-framework, dojo, dojox.mobile

请帮忙，这真的让我发疯了。我对 Javascript 有点陌生，正在尝试使用 Dojox.mobile 框架......

基本上，我想要做的是有一个按钮，它转到一个 <div> ，单击时它位于当前按钮*之前。*这需要是普通的 html <button> 或 <div>，并且不能是 ul、li、heading 或类似的，因为它位于视图的中间，而不是顶部或任何类型的边框（确切的位置在样式标签中给出）.. 我尝试实现 dojo.back 框架，但我似乎无法正确加载应该加载的内容或应该去哪里。我尝试使用 OnClick 属性实现它（这就是我实现所有其他按钮的*方式*)，但它会导致所有 div 之间完全重叠。我尝试使用 moveTo 属性实现它，但我认为这仅适用于 ul 和 li 元素，而不适用于普通按钮或列表元素（如果它们可用于普通 div，我不知道如何实现它们）。

老实说，我不知道我还能做什么，请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T15:13:26.027

对于[dojox.mobile.View](http://dojotoolkit.org/api/)，有一个名为 performTransition 的函数可以从一个视图切换到另一个视图。这是您可以使用的快速示例：

HTML：

```
<div id="first_view" data-dojo-type="dojox.mobile.View">
    <p>First view you see</p>
    ...
</div>
<div id="second_view" data-dojo-type="dojox.mobile.View">
    <p>Second view</p>
    <button data-dojo-type="dojox.mobile.Button" 
        data-dojo-props='onClick:function(e){goBackToFirstView();}'>
        Back
    </button>
</div> 
```

JavaScript：

```
function goBackToFirstView () {
    // load the view that should be visible
    var secondView = dijit.registry.byId("second_view");
    // transition slides back one
    secondView.performTransition("first_view", -1, "slide");
} 
```

# javascript - Heroku “我们很抱歉，但出了点问题。” 由于 javascript_include_tag

> ID：10067359
> 
> 赞同：2
> 
> 时间：2012-04-08T23:19:12.653
> 
> 标签：javascript, ruby-on-rails, jquery-mobile, heroku

将我的 ruby​​ on rails 应用程序上传到 heroku 会导致以下错误：

> 我们很抱歉，但有些不对劲。

这不会发生在我的本地机器上。

经过一些调试，我想我可能已经发现了错误，但不知道如何修复它。

在我的文件 application.html.erb 中，删除以下行解决了问题，但随后我的应用程序丢失了它的 jquery 移动主题。有什么想法可以解决这个问题吗？

**导致问题的行：**

```
<%= javascript_include_tag "application" %> 
```

**application.html.erb 文件：**

```
<!DOCTYPE html>
<html>
<head>
  <title>Washapp</title>
  <meta name="viewport" content="width=device-width">
  <link rel="stylesheet" href="http://code.jquery.com/mobile/1.0.1/jquery.mobile-1.0.1.min.css" />
  <%= javascript_include_tag "application" %>

  <script src="http://code.jquery.com/mobile/1.0.1/jquery.mobile-1.0.1.min.js"></script>
  <%= csrf_meta_tags %>

  <script>
    if (window.location.hash == "#_=_")
        window.location.hash = "";
  </script>

</head>
<body>
  <div data-role="page">
    <%= yield %>
  </div>
</body>
</html> 
```

**Heroku 日志：**

```
2012-04-08T23:28:41+00:00 heroku[nginx]: 78.105.51.57 - - [08/Apr/2012:23:28:41 +0000] "GET / HTTP/1.1" 500 643 "-" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_3) AppleWebKit/535.19 (KHTML, like Gecko) Chrome/18.0.1025.151 Safari/535.19" washappdelete2.heroku.com
2012-04-08T23:28:43+00:00 app[web.1]: 
2012-04-08T23:28:43+00:00 app[web.1]: Started GET "/" for 78.105.51.57 at 2012-04-08 16:28:43 -0700
2012-04-08T23:28:43+00:00 app[web.1]: 
2012-04-08T23:28:43+00:00 app[web.1]: Processing by HomeController#index as HTML
2012-04-08T23:28:43+00:00 app[web.1]:   Rendered home/routa_list.html.erb within layouts/application (0.1ms)
2012-04-08T23:28:43+00:00 app[web.1]: Completed 500 Internal Server Error in 34ms
2012-04-08T23:28:43+00:00 app[web.1]: 
2012-04-08T23:28:43+00:00 app[web.1]:     4:   <title>Washapp</title>
2012-04-08T23:28:43+00:00 app[web.1]: ActionView::Template::Error (application.js isn't precompiled):
2012-04-08T23:28:43+00:00 app[web.1]:     5:   <meta name="viewport" content="width=device-width">
2012-04-08T23:28:43+00:00 app[web.1]:     6:   <link rel="stylesheet" href="http://code.jquery.com/mobile/1.0.1/jquery.mobile-1.0.1.min.css" />
2012-04-08T23:28:43+00:00 app[web.1]:     7:   <%= javascript_include_tag "application" %>
2012-04-08T23:28:43+00:00 app[web.1]:     9:   <script src="http://code.jquery.com/mobile/1.0.1/jquery.mobile-1.0.1.min.js"></script>
2012-04-08T23:28:43+00:00 app[web.1]:     8:   
2012-04-08T23:28:43+00:00 app[web.1]:     10:   <%= csrf_meta_tags %>
2012-04-08T23:28:43+00:00 app[web.1]:   app/views/layouts/application.html.erb:7:in `_app_views_layouts_application_html_erb__2373145142857118006_42724320'
2012-04-08T23:28:43+00:00 app[web.1]:   app/controllers/home_controller.rb:4:in `index'
2012-04-08T23:28:43+00:00 app[web.1]: cache: [GET /] miss
2012-04-08T23:28:43+00:00 app[web.1]: 
2012-04-08T23:28:43+00:00 app[web.1]: 
```

**应用程序/资产/javascripts/application.js**

```
// This is a manifest file that'll be compiled into application.js, which will include all the files
// listed below.
//
// Any JavaScript/Coffee file within this directory, lib/assets/javascripts, vendor/assets/javascripts,
// or vendor/assets/javascripts of plugins, if any, can be referenced here using a relative path.
//
// It's not advisable to add code directly here, but if you do, it'll appear at the bottom of the
// the compiled file.
//
// WARNING: THE FIRST BLANK LINE MARKS THE END OF WHAT'S TO BE PROCESSED, ANY BLANK LINE SHOULD
// GO AFTER THE REQUIRES BELOW.
//
//= require jquery
//= require jquery_ujs
//= require_tree . 
```

**存储库**： [https ://github.com/karangb/herokuProblem](https://github.com/karangb/herokuProblem)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-09T00:53:42.233

问题解决了！

这很简单 -[当我尝试将我的应用推送到 Heroku 时出现 500 个内部服务器错误](https://stackoverflow.com/questions/10046697/500-internal-server-error-when-i-try-to-push-my-app-onto-heroku)

> 因此，根据您提供的 heroku 信息，我看到您在竹堆栈上，并且该堆栈不支持 Rails 3.1+。只有 cedar 堆栈支持 Rails 3.1+。您需要使用以下命令在 cedar 堆栈上创建一个新应用程序：
> 
> heroku create --stack cedar

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-24T06:42:20.447

在 config/application.rb 中，添加

```
config.assets.initialize_on_precompile = false 
```

并推送到 git，然后是 heroku 推送。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-08T23:33:49.733

尝试添加

`//= require jquery.mobile`

在你的

`app/assets/stylesheets/application.js`

AMD 集

`config.assets.compile = tue`

在你的

`config/enviroments/production.rb`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-08T23:23:12.260

尝试在 config/enviroments/production.rb 中将以下行设置为 false：

```
config.assets.compile = false 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-08T23:38:37.647

如果你有类似*java*之类的东西`app/assets`，这会抛出链轮。将其命名为类似*小程序*的名称将允许`javascripts`编译目录的内容。[来源](https://stackoverflow.com/a/8546327/1090438)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-08T23:58:58.100

你也设置

```
config.assets.initialize_on_precompile = false 
```

这是 Rails 3.2 的一个新变化（参见[Docs](http://guides.rubyonrails.org/asset_pipeline.html#precompiling-assets)）

尽管如此，您应该能够在 slug 编译期间看到错误（如下例所示，如果您未设置上述标志）

```
-----> Preparing app for Rails asset pipeline
       Running: rake assets:precompile
       rake aborted!
       could not connect to server: Connection refused
       Is the server running on host "127.0.0.1" and accepting
       TCP/IP connections on port 5432? 
```

您还可以尝试在本地运行 rake 预编译任务，然后查看错误（再次，正如文档所建议的那样）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-05-27T23:57:38.140

确保没有未跟踪的文件，执行`git status`

也许试试，`heroku run rake db:migrate`

# java - 找不到输入文件

> ID：10067370
> 
> 赞同：3
> 
> 时间：2012-04-08T23:20:38.717
> 
> 标签：java

我只是在用java读取输入文件，直到我被最基本的步骤难住了......找到输入文件！

input.txt 文件与调用它的类文件位于同一目录中，但 eclipse 仍然给我一个无法找到的错误：

“线程“主”java.lang.Error 中的异常：未解决的编译问题：未处理的异常类型 FileNotFoundException”

我的代码：

```
package pa;
import java.util.Scanner; 

public class Project {
 public static void main(String[] args) {
    java.io.File file = new java.io.File("input.txt");
    System.out.println(file.getAbsolutePath());
    Scanner input = new Scanner(file);
 }
} 
```

input.txt 位于同一个包、同一个文件夹和所有内容中。我很困惑 ：（

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-08T23:24:35.243

我不知道 eclipse，但在 netbeans 中，路径不是从您的类所在的包（文件夹）开始，而是从项目的根文件夹开始。要在 netbeans 中找到该文件，您必须将`new File("src/pa/input.txt")`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-08T23:22:43.053

尝试使用文件的绝对路径，例如：

```
java.io.File file = new java.io.File("C:\\My Documents\\User\\input.txt"); 
```

另外，`main()`像这样声明方法：

```
public static void main(String[] args) throws FileNotFoundException { 
```

通常你会想要捕获并处理异常，但现在只是抛出它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-08T23:22:48.310

使用eclipse时，工作目录是项目目录，而不是类的目录。

您可以通过以下方法获取工作目录：

```
File f = new File(".");
System.out.println(f.getAbsolutePath()); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-08T23:34:43.647

错误“未处理的异常类型 FileNotFoundException”可以通过 main() 方法中的异常处理来解决。在您的代码中添加以下命令。

```
public static void main(String[] args) throws FileNotFoundException 
```

运行程序，你应该得到 input.txt 文件的位置。

您可以在此处了解有关异常处理的更多信息[。](http://www.tutorialspoint.com/java/java_exceptions.htm "这里。")

干杯

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-08T23:25:14.740

查看生成类文件的文件夹。如果 input.txt 文件不在该文件夹中，则将其放在那里并尝试再次运行您的代码。

# java - 如何在 JSP MVC 应用程序中将信息从数据库持久显示到视图？

> ID：10067376
> 
> 赞同：0
> 
> 时间：2012-04-08T23:21:55.213
> 
> 标签：java, model-view-controller, jsp

对于我的大学项目，我必须构建一个自定义 JSP/Servlet MVC 应用程序，因此我不能使用诸如 Struts 或 Spring 之类的框架。我已经有了 FrontController、Command、Service、DAO、业务层。

假设我想创建一个带有侧边栏的网站，并且在侧边栏中有以下小部件：`Members`, `Who's Online`, `Recent Comments`. 每个小部件通过`Command`-> `Service`->访问数据库`Dao`。

我希望信息在整个应用程序中不断显示在侧边栏中。问题是我不知道该怎么做。我知道如何通过处理 GET/POST 请求来显示信息，但如果有意义的话，我不知道如何在没有 GET/POST 请求的情况下显示信息（来自数据库）？

我尝试过的几种方法不起作用：

1）在加载`homepage`和调用`HomeCommand`调用`ListUsers`时`UserDao`，然后将它们存储到会话中。**但是**如果用户从不同的 URL 进入站点，ListUsers 将不会被存储到会话中。

2) 创建一个单独的`Command`: `MembersCommand`, `WhosOnlineCommand`, `RecentCommentsCommand`. 然后使用`JSTL` `include`to include`FrontController`并让它调用`Command`. **但**包括想要一个`.jsp`

```
<jsp:include page="FrontController/members" /> 
Fragment "FrontController/members" was not found at expected path /MyApplication/WebContent/WEB-INF/FrontController/memmbers 
```

`.jsp's`3) 使用 Java 代码为每个小部件 ( `members.jsp`, ) 创建个人`whosonline.jsp`以访问`Dao`. 然后使用`JSTL include`. **但是**我怎样才能让它通过`FrontController`jsp中的Java不是一个很大的禁忌吗？

4）使用`<jsp:forward page="" />` **，但这**给了我一个空白页？

我没主意了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-08T23:46:23.183

我不明白您要说的所有内容，但也许 servlet 设计模式可以提供帮助。通常使用前端控制器，您可以访问持久存储，然后将需要存储的内容存储在“会话”或“请求”范围的区域中。但是，由于您谈到“另一个网站”，我认为您可能需要将数据存储在“应用程序”类型区域中。如果您使用 servlet 作为前端控制器，则该区域由 getServletContext().setAttribute() 访问，稍后您的 JSP 页面可以像访问会话范围的变量一样访问该变量。我无法判断您的前端控制器是 servlet 还是 JSP，但这并不重要，因为两者都能够存储应用程序范围的变量。

在真实的业务环境中，这还不够，因为 servlet 经常在多台机器之间共享，并且可以多次重启和停止；因此，任何持久性信息都必须直接从数据库中检索。但是，对于一个项目，将数据存储在应用程序范围的变量中就足够了。

我知道我错过了您所解释的大部分内容，但我的观点是前端控制器访问（几个）持久存储，将返回的 jsp 页面所需的所有数据加载到会话或请求或应用程序变量中（在这种情况下）并且可以编写 jsp 文件以利用已存储在这些变量中的所有数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T10:27:16.487

查看本教程以了解 Java Web 应用程序的 MVC 架构。希望你能有所了解

[http://www.javaranch.com/journal/200603/frontman.html](http://www.javaranch.com/journal/200603/frontman.html)

[设计模式基于 Web 的应用程序](https://stackoverflow.com/questions/3541077/design-patterns-web-based-applications/)

[http://balusc.blogspot.com/2008/07/dao-tutorial-data-layer.html](http://balusc.blogspot.com/2008/07/dao-tutorial-data-layer.html)

[使用 MVC 和 DAO 模式在 JSP 页面的 HTML 中显示 JDBC ResultSet](https://stackoverflow.com/questions/5003142/jsp-using-mvc-and-jdbc)

# markup - 为双语文本创建自定义标记

> ID：10067388
> 
> 赞同：0
> 
> 时间：2012-04-08T23:23:46.093
> 
> 标签：markup

我需要创建一个包含两个版本的短篇小说的文件——一个是原始语言版本，一个是英语翻译版本——并逐句显示两个版本之间的对应关系。例如，标记需要表明

```
Esto es el texto de la oracion 1. 
```

对应于

```
This is the text of sentence 1\. 
```

构建它的最佳方法是什么？我可以使用现有的标记语言（如 XML）或为此目的编写新的东西。任何想法，将不胜感激。

# ios - 为 Framesetter 提供正确的行距调整

> ID：10067389
> 
> 赞同：3
> 
> 时间：2012-04-08T23:23:49.690
> 
> 标签：ios, objective-c, uifont, ctfontref

有几篇文章指出了从 CTFramesetterSuggestFrameSizeWithConstraints 中获得精确高度的困难，在这里，[（framesetter post）](https://stackoverflow.com/questions/3374591/ctframesettersuggestframesizewithconstraints-sometimes-returns-incorrect-size)，@Chris DeSalvo 给出了看起来像是最终修复的方法：添加具有正确行距调整的段落样式设置。

DeSalvo 通过从其 lineHeight 中删除 UIFont 的上升器和下降器来获得他的“领先”。我想知道这将如何比较`CTFontGetLeading`。

我使用这样创建的字体：

```
CTFontRef fontr = CTFontCreateWithName((CFStringRef)@"Helvetica Neue", 16.0f, NULL);
UIFont *font = [UIFont fontWithName:@"Helvetica Neue" size:16.0f]; 
```

价值观完全不同：

*   0.448 CTFontGetLeading
*   2.360 DeSalvo 的公式：UIFont lineHeight - assender + descender

以下是一些其他 UIFont 值：

*   21.000 UIFont 的 lineHeight
*   15.232 UIFont 的上升器（基线的 Y 坐标）
*   -3.408 UIFont 的下降器（从基线的 Y 坐标）
*   08.368 UIFont 的 xHeight

以下是 Ken Thomases 询问的 CTFont 值：

*   11.568001 CTFontGetCapHeight
*   08.368 CTFontGetXHeight
*   -15.216001、-7.696001、38.352001、24.928001 CTFontGetBoundingBox
*   15.232 CTFontGetAscent
*   03.408 CTFontGetDescent （参考类说“根据字体参考的点大小和矩阵缩放的缩放字体下降度量”——这显然意味着它是 Y 坐标相对于基线的绝对值？）

我注意到 UIFont 以前有一个专门用于“领先”的属性，但它已被弃用，建议我们`lineHeight`改用它。所以 UIFont 认为leading 是**21**和 CTFontRef .448**对于**相同的字体？有什么不对劲。

三个问题：

1.  “领先”真的是 kCTParagraphStyleSpecifierLineSpacingAdjustment 的意思吗？
2.  如果是这样，我应该使用哪种方法/公式来获取它？
3.  如果没有，我应该使用什么来调整行距？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-28T22:12:30.127

我也遇到了这个问题，这里是在一个真实项目中工作的代码：

```
// When you create an attributed string the default paragraph style has a leading 
// of 0.0\. Create a paragraph style that will set the line adjustment equal to
// the leading value of the font. This logic will ensure that the measured
// height for a given paragraph of attributed text will be accurate wrt the font.

- (void) applyParagraphAttributes:(CFMutableAttributedStringRef)mAttributedString
{
  CGFloat leading = CTFontGetLeading(self.plainTextFont);

  CTParagraphStyleSetting paragraphSettings[1] = {
    kCTParagraphStyleSpecifierLineSpacingAdjustment, sizeof (CGFloat), &leading
  };

  CTParagraphStyleRef  paragraphStyle = CTParagraphStyleCreate(paragraphSettings, 1);

  CFRange textRange = CFRangeMake(0, [self length]);

  CFStringRef keys[] = { kCTParagraphStyleAttributeName };
  CFTypeRef values[] = { paragraphStyle };

  CFDictionaryRef attrValues = CFDictionaryCreate(kCFAllocatorDefault,
                                                  (const void**)&keys,
                                                  (const void**)&values,
                                                  sizeof(keys) / sizeof(keys[0]),
                                                  &kCFTypeDictionaryKeyCallBacks,
                                                  &kCFTypeDictionaryValueCallBacks);

  BOOL clearOtherAttributes = FALSE;
  CFAttributedStringSetAttributes(mAttributedString, textRange, attrValues, (Boolean)clearOtherAttributes);
  CFRelease(attrValues);

  CFRelease(paragraphStyle);

  self.stringRange = textRange;

  return;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T17:11:28.983

回答我上面的3个问题：

1.  是的，“领先”实际上是 kCTParagraphStyleSpecifierLineSpacingAdjustment 的意思。或者无论如何，它按预期工作。
2.  用于`CTFontGetLeading(fontRef)`获取字体的正常前导，或插入您选择的任何值（作为 CGFloat）。
3.  不适用。

答案 1 和 2 有效：在属性字符串的段落样式属性中指定前导值将使 Core-Text 框架设置器能够*准确*计算其高度。

有两个警告：

1.  如果您尝试增量计算高度，一次一个字符串，每个字符串包含一个初始换行符，framesetter 将认为该换行符代表一整行，而不仅仅是前导。如果您想要连接字符串的高度，则必须将该连接提供给框架设置器。当然，您可以跟踪增量的高度差，但无法避免让 framesetter 重新计算早期的字符串尺寸。
2.  CATextLayer 忽略间距调整（和其他属性）。如果按确切的字符串高度取景是个问题，您必须直接绘制到 CALayer。

还有一个谜团：UIFont 被弃用的领先是怎么回事？前导和 lineHeight 是两个不同的东西。

# windows - 为 OS X 和 Windows 创建既是音频单元又是 VST 的音频插件 UI 的“最佳”方法是什么？

> ID：10067392
> 
> 赞同：2
> 
> 时间：2012-04-08T23:24:27.237
> 
> 标签：windows, macos, core-audio, audiounit, vst

我正在开发几个音频插件。现在，它们是音频单元。虽然“DSP”代码在实现/端口之间的大部分情况下都不会改变，但我不确定如何处理 GUI。

例如，我在 Lion 中查看 Apple 提供的 AU。有谁知道他们是如何处理 UI 的？比如，旋钮和控件只是 Cocoa 控件的子类吗？他们是在使用一些单独的框架还是从头开始编码这些旋钮等？

然后，我正在开发的插件也将作为 Windows 的 VST 提供。我已经使用通用接口启动并运行它们。但是我想知道我是否应该克服它并使用 Steinberg 提供的 vstgui 代码重新创建我的所有界面，或者是否有更实用的方法来使界面跨平台。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T07:54:39.223

VSTGUI 使用起来不是很有趣，尤其是当您的界面变得更加复杂时。源代码一团糟，您最终会得到一个非常硬编码的 GUI，这变得难以重构。

我建议查看[Juce](http://rawmaterialsoftware.com/juce)，其中包括一个不错的 GUI 构建器。如果你的 DSP 代码模块化得很好，那么切换到它的架构就不会那么痛苦了。作为一个额外的好处，它将使 x-platform（其中“平台”意味着操作系统和底层插件平台）对您来说更容易跳跃。

# directx - 哪个更快：在执行或镶嵌之前创建详细的网格？

> ID：10067396
> 
> 赞同：1
> 
> 时间：2012-04-08T23:25:29.673
> 
> 标签：directx, gpu, directx-11, tesselation, tessellation

为简单起见，让我们考虑球体。假设我有一个球体，在执行之前我知道半径、位置和三角形计数。假设三角形数量足够大（例如~50k 三角形）。

事先创建这个球体网格并将所有 50k 三角形流式传输到显卡会更快，还是发送单个点（表示球体的中心）并使用曲面细分和几何着色器构建球体会更快在 GPU 上？

如果我在不同的位置有 100 个这样的球体，它还会更快吗？我可以使用船体/几何着色器来创建可以与实例化结合的东西吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T21:18:29.997

镶嵌当然是有价值的。尤其是与高度图的位移相结合时。您的问题中描述的孤立环境不一定能完全回答您的问题。

在使用曲面细分之前，您需要知道您将成为 CPU 多边形/三角形绑定，因此需要开始使用 GPU 来帮助您增加游戏/场景的整体三角形。GPU 上的计算速度非常快，所以是的，如果你打算这样做的话，建议使用曲面细分多个细分级别……尽管有时我很高兴只从 200 个三平面上细分 3-4 次。

镶嵌主要用于环境/静态网格场景对象，这样您就可以在角色和其他移动/动画模型上花费您的 tri's，而不会受到 CPU 的限制。

Unity3D 和 CryEngine 等检查引擎用于曲面细分示例以帮助学习曲线。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T16:24:28.297

我恰好同时在处理这个问题。

***就 FPS 而言，在这种情况下***，预先计算的方法会更快，因为您可以转储一个巨大的 50K 三角形球体有效载荷（与任何其他模型一样）并从那里在多个位置绘制它。

镶嵌方法会更慢，因为所有的三角形都是从一个公式生成的，每帧多次。

# java - 将.getText() 字符串传递给另一个类

> ID：10067399
> 
> 赞同：4
> 
> 时间：2012-04-08T23:25:50.867
> 
> 标签：java, swing, reflection, awt, jtextfield

我目前正在从事大学一年级的项目，我有一个问题，虽然我怀疑这是一个非常复杂的问题，但我一直在寻找，但我找不到合适的答案。

问题涉及两个类。一个gui类（class1）和另一个类（class2），当我运行代码时，第二个类在尝试从class1中检索class2中的getText（）字符串时给了我一个nullpointerexception。

我在 class1 中有一个 JTextField 并试图将 .getText() 值传递给 class2 并将其存储在 String 类型变量中。

我试图实现这一点的当前代码如下（简化）：

```
 public class Class1 {

    private JTextField textField = new JTextField("Something");

      public Class1() {}
    ...
    public String getTextFieldString() {
      return textField.getText();
  }
}

 public class Class2 {

   public Class2(Class1 class1) {
    c1=class1
   }
    private c1 Class1 = new Class1();
    private String s = new String();
    ...
    s = c1.getTextFieldString();
} 
```

我对编码很陌生，我读过也许我需要在某个地方传递一个参数，我认为这是因为 textField 本身不是静态的，当有人输入新值时它会改变。（很抱歉在那里陈述显而易见的事情。）

无论如何，感谢您的帮助。非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T01:24:28.243

我可能会帮助查看 Java 中[*规定的*](http://docs.oracle.com/javase/specs/jls/se7/html/jls-12.html#jls-12.4) [*初始化顺序*](http://norvig.com/java-iaq.html#init)。特别是，`textField`实例变量初始化程序应该在有效`Class1`实例存在时完成。违反此顺序的一种方法是在不同的线程上构造`Class1`和。`Class2`为了排除这种情况，Swing GUI 对象应该*只*在[事件调度线程](http://download.oracle.com/javase/tutorial/uiswing/concurrency/initial.html)上构建和操作，如下面的[sscce](http://sscce.org/)所示。

```
import java.awt.EventQueue;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JTextField;

/** @see http://stackoverflow.com/q/10067399/230513 */
public class NewJavaGUI extends JPanel {

    public NewJavaGUI() {
        Class1 class1 = new Class1();
        Class2 class2 = new Class2(class1);
        this.add(class1.textField);
        this.add(new JLabel(class2.s));
    }

    private static class Class1 extends Object {

        private final JTextField textField = new JTextField("Something");

        public Class1() {} // implicit

        public String getTextFieldString() {
            return textField.getText();
        }
    }

    private static class Class2 extends Object {

        private final Class1 c1;
        private final String s;

        public Class2(Class1 class1) {
            c1 = class1;
            s = c1.getTextFieldString();
        }
    }

    private void display() {
        JFrame f = new JFrame("NewJavaGUI");
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        f.add(this);
        f.pack();
        f.setLocationRelativeTo(null);
        f.setVisible(true);
    }

    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable() {

            @Override
            public void run() {
                new NewJavaGUI().display();
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-08T23:30:47.520

好吧，您可以`Class1`在构造函数中传递一个引用`Class2`并将其保存在属性中，并且每次`Class2`需要文本时，只需调用`getText()`属性上的方法即可。

```
public class Class2 {
    private Class1 class1;
    public Class2(Class1 reference) {
        class1 = reference;
    }
    public void someMethod() {
        String s = class1.getTextFieldString();
    }
} 
```

现在，当您实例化一个`Class2`对象时：

```
Class1 c1 = new Class1();
Class2 c2 = new Class2(c1); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-08T23:29:28.657

听起来您很想知道何时有人修改了文本字段中的文本。我的第一条建议是，当您对 Swing 组件有特定问题时，请查看 Java 教程。[具体来说，请查看JTextField 教程](http://docs.oracle.com/javase/tutorial/uiswing/components/textfield.html)中的 addActionListener 方法，包括[Text Demo](http://docs.oracle.com/javase/tutorial/displayCode.html?code=http://docs.oracle.com/javase/tutorial/uiswing/examples/components/TextDemoProject/src/components/TextDemo.java)示例。

# reporting-services - 班级 ' ' 不能被索引，因为它没有默认属性

> ID：10067400
> 
> 赞同：0
> 
> 时间：2012-04-08T23:26:24.813
> 
> 标签：reporting-services, ssrs-2008

我第一次在报告中创建了一个自定义代码块。

预览报告时会显示此错误：

```
Class '<classname>' cannot be indexed because it has no default property 
```

我正在尝试使用值填充报告字段。这是自定义块中的代码：

```
Sub PopulateSubTotal

    Fields!HeaderSubTotal.Value = Fields!TextboxSubTotal.Value
End Sub 
```

请告诉我我做错了什么，因为这是我第一次尝试在报告中使用自定义代码块。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2019-02-13T20:46:48.793

如果你得到这个错误并且类名是`ReportExprHostImpl.CustomCodeProxy`，你可能写了一个表达式，`Code!MyFunction(...)`而不是`Code.MyFunction(...)`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T22:08:34.780

找到了解决方案。

我发现这不能在自定义代码块中完成，所以我使用了一个变量。

请参考这篇帖子以获得答案：

[在报表的其他部分显示文本框的值](https://stackoverflow.com/questions/10063196/displaying-the-value-of-a-textbox-in-other-parts-of-a-report/10063368#comment12899732_10063368)

# bash - 如何改进此脚本？

> ID：10067402
> 
> 赞同：2
> 
> 时间：2012-04-08T23:26:28.640
> 
> 标签：bash, shell

我正在学习 shell 脚本，并且发现很难找到一个好的学习方法。我在下面创建了一个脚本，让用户可以通过选项搜索各种不同的 Internet 引擎。如果有人能仔细阅读并指出我做错了什么，如何改进它等，我将不胜感激。

```
#!/bin/bash

## Get user search-engine option
while getopts aegwy: OPTIONS ; do
  case "$OPTIONS" in 
    a) ENGINE="http://www.amazon.com/s/ref=nb_sb_noss/?field-keywords";;
    e) ENGINE="http://www.ebay.com/sch/i.html?_nkw";;
    g) ENGINE="http://www.google.com/search?q";;
    w) ENGINE="http://en.wikipedia.org/wiki/?search";;
    y) ENGINE="http://www.youtube.com/results?search_query";;
    ?) ERRORS=true;;
  esac
done &>/dev/null

## Ensure correct command usage
[ $# -ne 2 ] || [ $ERRORS ] && printf "USAGE: $(basename $0) [-a Amazon] [-e eBay] [-g Google] [-w Wikipedia] [-y YouTube] \"search query\"\n" && exit 1

## Ensure user is connected to the Internet
ping -c 1 209.85.147.103 &>/dev/null ; [ $? -eq 2 ] && printf "You are not connected to the Internet!\n" && exit 1

## Reformat the search query
QUERY=`printf "$2" | sed 's/ /+/g'`

## Execute the search and exit program
which open &>/dev/null ; [ $? -eq 0 ] && open "$ENGINE"="$QUERY" &>/dev/null && exit 0 || xdg-open "$ENGINE"="$QUERY" &>/dev/null && exit 0 || printf "Command failed!\n" && exit 1 
```

在此先感谢大家，意义重大！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T20:43:12.350

最好在 codereviews 中发布，如上所述，但这里有一些主要是文体评论。我应该强调的是，该脚本原样非常好；这些只是我认为将有助于使代码更易于阅读/维护，在某些情况下更健壮等的小改进。

您不需要仅仅因为环境变量是全大写，就对变量名使用全大写；shell变量和环境变量不是一回事。

由于您的`$OPTIONS`变量一次只包含一个选项，因此单数名称会更好（例如`$option`）。或者你可以选择`$opt`，这在这里有点传统。

您的`:`getopts 字符串 ( `aegwy:`) 中的 表明该`-y`选项需要一个参数，就像在`-y`*某些东西*中一样，而不仅仅是`-y`其本身。由于您没有对 做任何事情`$OPTARG`，我猜这不是故意的。

正如其他人所说， an `if`/ `then`/ `elif`/`else`可能比 and 的链更`&&`清晰`||`。

测试`[ $ERRORS ]`有点不清楚，因为它可能意味着很多不同的东西，具体取决于`$ERRORS`参数的内容。一个更明确的指示，表明您只关心它是否设置为`[ -n "$ERRORS" ]`.

喜欢`[ -ne ]`和朋友的比较大多是在 shell 内置整数运算之前的遗留物；更现代的成语将是`(( $# != 2 ))`。

您的使用消息暗示 -a、-e、-g、-w 和 -y 选项采用 Amazon、eBay、Google 等形式的参数。如果没有这些添加，命令的实际语法会更清楚; 您可以在帮助文本中包含一个额外的段落，列出每个选项的含义。

通常，错误消息应该发送到 stderr 而不是 stdout ( `>&2`)。

`basename $0`使用它来保持输出的一致性很好，但有一些事情要说不要管`$0`，因为它会反映用户实际调用命令的方式。需要考虑的事情。

`printf`如果您不使用格式字符串，则使用意义不大；只需使用`echo`，它会自动附加换行符。使用消息传统上也不包含引号。是否需要引用 arg 取决于用户。

检查命令是否成功正是工作原理，因此除非您真的关心确切的退出值，否则`if`无需进行显式检查。`$?`在连接 ping 的情况下，您可能不关心它失败的原因，只关心它确实：

```
 if ! ping -c 1 209.85.147.103 >/dev/null; then 
     echo >&2 "$0: You are not connected to the Internet!"
     exit 1
  fi 
```

您的搜索查询重新格式化可能需要做的不仅仅是将空格变成加号；如果它有一个＆符号怎么办？但是，如果您只是在做空格到加号的事情，您可以使用 bash 参数扩展来完成，而无需 sed：`QUERY="${QUERY// /+}"`

如果你的程序依赖于 open/xdg-open 等，你应该在顶部检查它的可用性；如果您知道无论如何都无法执行请求的操作，那么做任何其他事情都没有意义。你可以使用一个变量，这样你就不会在多个子句中重复自己：

```
open=
for cmd in open xdg-open; do
   if type -p "$cmd" >/dev/null; then
     open="$cmd"
     break
   fi
done
if [ -z "$open" ]; then
   echo >&2 "$0: open command not found."
   exit 1
fi 
```

然后你就可以完成这一行：

"$open" "$ENGINE=$QUERY" &>/dev/null

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T07:06:51.837

[http://linuxcommand.org/](http://linuxcommand.org/)是提高 bash 脚本技能的绝佳资源。

[http://tldp.org/LDP/abs/html/](http://tldp.org/LDP/abs/html/)是另一个很棒的文档。

希望这可以帮助。

# javascript - 使用 onclick() 调用嵌套函数

> ID：10067403
> 
> 赞同：-1
> 
> 时间：2012-04-08T23:26:34.837
> 
> 标签：javascript

我有两个按钮：`<button onclick="check()">Check</button>`和`<button onclick="newGame()">New</button>`。我只想在单击**New按钮后运行****检查**功能，所以我将它嵌套在**newGame**函数中。

 ****我的问题是，当我点击相应的按钮时，如何调用**检查功能？**我不想在一个连续的流程中执行它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T23:31:51.960

默认禁用“检查”按钮。单击“新建”按钮后，在事件处理程序中启用“检查”按钮。

```
<button id="chkBtn" onclick="check()" disabled>Check</button>
<button onclick="newGame()">New</button>

function newGame()
{
  // on success
  document.getElementById('chkBtn').disabled = false;  
  // can't remember if it's enabled | disabled
} 
```****

# java - 开源的android图像大小调整库

> ID：10067409
> 
> 赞同：0
> 
> 时间：2012-04-08T23:28:30.117
> 
> 标签：java, android, image-processing

我需要一个用于 android 的 java 库（开源）。有人可以给我推荐一个吗？

我需要它来调整图像大小（主要原因），但我可能也需要它来进行其他一些图像处理。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T07:53:23.240

你可以试试安卓的 OpenCV

[在这里试试](https://docs.google.com/viewer?a=v&q=cache%3afFdP49HBv1QJ%3awww.stanford.edu/class/ee368/Android/Tutorial-2-OpenCV-for-Android-Setup-Windows.pdf%20&hl=en&gl=in&pid=bl&srcid=ADGEEShmVCBFhS3U_hOocTHvzlQHwinx26bK4MsAipfiKZnZolava6NecwJUrjLZNACzqM2j-1La2NX-vp8fwL_upop2m2P4m4zB952XyvmbgUqK1qTP_Hsx3D-bGjErhKa463vkFKzr&sig=AHIEtbSeT28pGVZKyQzEfvlMqQ0EVXfjVg)

[也可以在这里试试](http://code.opencv.org/projects/opencv/wiki/OpenCV4Android)

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2012-04-21T18:37:19.610

对于缩略图，请尝试[http://code.google.com/p/thumbnailator](http://code.google.com/p/thumbnailator)

# php - opencart - 如何将商店标志添加到贝宝的结帐页面？

> ID：10067411
> 
> 赞同：-1
> 
> 时间：2012-04-08T23:29:07.077
> 
> 标签：php, paypal, opencart

我想在 paypal 的结帐页面上显示我的商店徽标，但我不知道该怎么做。我搜索了论坛，但仍然找不到任何东西。有什么线索吗？

这是我想要的地方-靠近标题（或替换）：http: [//i43.tinypic.com/2hhni54.jpg](http://i43.tinypic.com/2hhni54.jpg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T23:42:42.047

[检查此链接](https://cms.paypal.com/es/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_html_Appx_websitestandard_htmlvariables)

表 7。`image_url`

# c++ - 受保护数据成员的替代方案，具体案例研究

> ID：10067412
> 
> 赞同：0
> 
> 时间：2012-04-08T23:29:13.820
> 
> 标签：c++, protected, data-members

似乎普遍认为使用受保护的数据成员是一个坏主意。我想知道在特定情况下会有什么好的选择。

以下面的名为 CModule 的类为例，它代表一个音频模块（Amiga 风格的跟踪器音乐）。存在许多不同的模块格式，但它们之间的唯一区别在于文件格式（加载）和音频效果处理。CModule 包含所有通用功能，派生类实现每种特定格式的加载和效果。

```
class CModule
{
public: 
        CModule(string Filename); //Song file name to load.

        //Common methods...
        void Play();
        void Stop(); //Etc...

protected:

        //Derived class should implement these with format specific code.
        //Base class code calls these when needed.
        virtual void Load()=0;
        virtual void Effects()=0;

        //Song information/data.
        vector<CInstrument> Instruments;
        vector<CPattern> Patterns;
        //And much, MUCH more...
}; 
```

几乎所有数据成员都受到保护，因为派生类的 Load() 函数需要全部填充它们。这被认为是不好的，因为如果有人从派生类派生类，它可能会破坏封装。解决这个问题的正确方法是什么？我已经发现使用 getter/setter 也被认为是不好的。

非常感谢任何花时间阅读本文的人:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-08T23:40:48.743

如果使用私有数据成员对您的解决方案不起作用，那么使用受保护的数据成员没有任何问题，但是使用公共数据成员几乎从来都不是一个好主意（但有时也可以）。

在这种情况下，我可能会将您的向量设为私有，但只需创建 getter 和 setter 方法。类似于以下内容：

```
class CModule
{
public: 
        CModule(string Filename); //Song file name to load.

        //Common methods...
        void Play();
        void Stop(); //Etc...

protected:

        //Derived class should implement these with format specific code.
        //Base class code calls these when needed.
        virtual void Load()=0;
        virtual void Effects()=0;

        void AddInstrument(CInstrument instrument)
        {
            Instruments.push_back(instrument);
        }

        Instrument GetInstrument(int index)
        {
            return Instruments[index];
        }

        int InstrumentCount()
        {
            return Instruments.size();
        }
private:
        //Song information/data.
        vector<CInstrument> Instruments;
        vector<CPattern> Patterns;
        //And much, MUCH more...
}; 
```

这只是乐器的开始，您还必须对模式采取类似的方法。或者，您也可以只传回向量，但这有点封装。

另请注意，我正在做这件事，并没有针对任何拼写错误进行测试，但希望它传达了这个想法。

# c# - HasMany 映射但获取一个元素或获取一些

> ID：10067414
> 
> 赞同：0
> 
> 时间：2012-04-08T23:29:55.317
> 
> 标签：c#, linq, nhibernate

```
public class Category
{
    public virtual int Id { set; get; }
    public virtual string Name { set; get; }
    public virtual int CategoryOrder { set; get; }
    public virtual IEnumerable<News> LatestNews { set; get; }
}

public sealed class CategoryMap :ClassMap<Category>
{

    public CategoryMap()
    {
        LazyLoad();
        Id(x => x.Id);
        Map(x => x.Name);
        Map(x => x.CategoryOrder);
        HasMany(x => x.LatestNews);
    }

}

        IRepository<Category> newsRepo = new NHibernateRepository<Category>();

        using(var session = newsRepo.GetSessionFactory().OpenSession())
        using(var transaction = session.BeginTransaction())
        {
            var result = session.Query<Category>().OrderBy(x => x.CategoryOrder);
            transaction.Commit();
        } 
```

我有这个类别类，我想为每个类别显示一个（只有一个）新闻。这是正确的映射吗？或者我应该把它改成`Map`

当我运行它时，它会获取每个类别的所有新闻。但我想要每个类别的最新消息（只有一个）。我可以通过查询获得最新消息`News.DateUpdated`。

我应该如何更改查询以获取每个类别的一条新闻？

或者我如何获得一些新闻？即：限制我可以查询的新闻数量？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T03:14:55.850

你可以额外使用惰性模式来实现这一点，

```
public News GetLatestNews(Category cat)
{
    var session = SessionFactory.CurrentSession;
    var news = session.CreateFilter(cat.LatestNews , "order by categoryorder").SetFirstResult((page - 1)  * pageSize).SetFirstResult(0).SetMaxResults(1).List().FirstOrDefault();

    return news;
} 
```

但是，如果您尝试直接访问 LatestNews 集合，这将没有任何用处，因为它将从 db 加载与 Category 关联的所有新闻对象，这会降低性能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T19:00:26.627

我想你也可以吃蛋糕。你有一个新闻项目列表，所以就留下它。但是添加另一个属性，它只获取您想要的新闻项目。

```
public class Category
{
    public virtual int Id { set; get; }
    public virtual string Name { set; get; }
    public virtual int CategoryOrder { set; get; }
    public virtual IEnumerable<News> AllNews { set; get; }
    public virtual News LatestNews 
    {
        get
        {
            // probably needs some work
            return this.AllNews.OrderByDescending(n => n.SomeDateField).Take(1);
        }
    }
}

public sealed class CategoryMap :ClassMap<Category>
{

    public CategoryMap()
    {
        LazyLoad();
        Id(x => x.Id);
        Map(x => x.Name);
        Map(x => x.CategoryOrder);
        HasMany(x => x.AllNews);
    }

} 
```

# python - sorl-thumbnail 的模板标签什么都不做

> ID：10067415
> 
> 赞同：3
> 
> 时间：2012-04-08T23:30:11.870
> 
> 标签：python, django, sorl-thumbnail

我正在使用 sorl-thumbnail 来裁剪一些图像。

我有一个看起来像这样的模型

```
from django.db import models
from sorl.thumbnail import ImageField

class Photo(models.Model):
    image = models.ImageField(upload_to="uploads") 
```

在我的模板里面我有

```
{% load thumbnail %}

{% thumbnail photo.image "200x100" as im %}
    <img src="{{ im.url }}">
{% endthumbnail %} 
```

这不会输出任何东西。如果我这样做`<img src='{{photo.image.url}}'>`，图像在浏览器中显示良好。我的 INSTALLED_APPS 中也有 sorl-thumbnail，我同步了数据库并设置了 thumbnail_kvstore 表。

有人能帮助我吗。什么可能导致图像无法裁剪甚至显示？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-08T23:56:13.677

~~您的代码看起来不错，所以问题应该来自其他部分。~~

您可以做的第一件事是设置并`THUMBNAIL_DEBUG = True`查看`settings.py`错误发生的原因。

您正在使用`virualenv`和`PIL`图像库吗？确保您`PIL`已编译和安装`jpeg`并`png/gif`支持需要`libjpeg`和`zlib`.

编辑：正如@DanielRoseman 在评论中指出的那样，你实际上是在使用`django.db.models.ImageField`，改变

```
image = models.ImageField(upload_to="uploads") 
```

至

```
image = ImageField(upload_to="uploads") 
```

改为使用`sorl.thumbnail.ImageField`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T02:14:05.317

尝试进行清理，或者如果失败，请清除。[文档](http://thumbnail.sorl.net/management.html#thumbnail-clear "文档")

当我得到意外的输出时，这解决了我的问题。也许它会为你工作。

# perl - perl 日期计算，日期格式为 2012-02-03 00:00:00

> ID：10067425
> 
> 赞同：3
> 
> 时间：2012-04-08T23:33:13.740
> 
> 标签：perl, date

我需要一些关于 perl 中日期计算的帮助，日期格式为“2012-02-03 00:00:00”。特别是有没有一种工具可以用来增加天数并正确切换到月份和年份？谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-09T00:01:29.467

请参阅[日期时间](http://search.cpan.org/perldoc/DateTime)。

```
#!/usr/bin/env perl
use strict; use warnings;

use DateTime;

my $ts = '2012-02-03 00:00:00';
my ($y, $m, $d) = ($ts =~ /([0-9]{4})-([0-9]{2})-([0-9]{2})/);
my $dt = DateTime->new(year => $y, month => $m, day => $d);
$dt->add( months => 2, days => 3 );

print $dt->strftime('%Y-%m-%d %H:%M:%S'), "\n"; 
```

* * *

使用 DateTime::Format 类实际上更简洁一些，并且您可以免费进行错误检查。

```
use DateTime::Format::Strptime qw( );

my $format = DateTime::Format::Strptime->new(
   pattern   => '%Y-%m-%d %H:%M:%S',
   time_zone => 'local',
   on_error  => 'croak',
);

my $ts = '2012-02-03 00:00:00';
my $dt = $format->parse_datetime($ts);
$dt->add( months => 2, days => 3 );
print $format->format_datetime($dt), "\n"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-15T15:20:05.587

`POSIX`使用时间处理功能，这在核心内完全可以实现。

标准`POSIX::mktime`函数已经处理了非规范化的值，并且可以纠正超出范围的天/月。此外，`POSIX::strftime`在格式化之前实际调用给定值，因此它会正确调整。

```
use POSIX qw( strftime mktime );
use POSIX::strptime qw( strptime );

my $format = "%Y-%m-%d %H:%M:%S";

my @t = strptime( "2012-02-03 00:00:00", $format );
@t = @t[0..5]; # Throw away wday and yday

$t[3] += 3; # mday
$t[4] += 2; # mon

say strftime $format, @t;

$t[3] += 400; # mday

say strftime $format, @t; 
```

给

```
2012-04-06 00:00:00
2013-05-11 00:00:00 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T01:59:14.887

该[`Time::Piece`](https://metacpan.org/module/Time%3a%3aPiece)模块是 Perl 安装的标准部分，可能满足您的所有需求。

该程序使用您的示例日期并增加两个月零三天，然后再增加 400 天。显示了两种显示值的替代方式

```
use strict;
use warnings;

use Time::Piece;
use Time::Seconds 'ONE_DAY';

my $format = '%Y-%m-%d %H:%M:%S';

my $dt = Time::Piece->strptime('2012-02-03 00:00:00', $format);
$dt = $dt->add_months(2);
$dt += 3 * ONE_DAY;

print $dt->strftime($format), "\n";

$dt += 400 * ONE_DAY;

printf "%s %s\n", $dt->ymd, $dt->hms; 
```

**输出**

```
2012-04-06 00:00:00
2013-05-11 00:00:00 
```

# java - 类继承和强制转换

> ID：10067428
> 
> 赞同：2
> 
> 时间：2012-04-08T23:33:27.390
> 
> 标签：java, inheritance, object, methods, casting

所以我在一个零碎的文件夹中得到了这段代码，这些代码将用于一个已经停止开发的项目。但是，作为 Java 新手，我有几个问题（我知道代码无法编译，但这适用于我的问题之一）。

```
interface Executable { 
   public int execute (Object o); 
} 

public class Biv implements Executable { 

   public int execute (String s) { 
     System.out.println (s); 
     return s.length(); 
   } 

   public static void main (String[] args) { 
     Executable e = new Biv(); 
     System.out.println( 
         e.execute ("Hello World!")); 
   }

} 
```

**1）**我的第一个问题是关于变量 e。它是用 Executable 对象类型声明的，但是我不明白为什么它可以用新的 Biv 对象实例化。这是怎么回事，这是什么意思？

**2)**错误出现在 Biv 类中的执行方法中。这似乎是因为它需要一个对象而不是字符串。但是，不能因为 String 是 Object 的子类，就不能用 String 替换 Object 吗？我可以理解，如果您将 String 替换为 Object ，它会出现错误（我认为），但不是当前的完成方式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-08T23:38:07.100

> 我不明白为什么它可以用新的 Biv 对象实例化

因为`Biv`实现`Executable`了，所以任何实例`Biv`也是 的实例`Executable`。

> 错误出现在 Biv 类中的执行方法中

是的，它 [ `Biv`] 没有实现`execute(Object)`. 该方法`execute(String)`只是碰巧具有相同名称的不同方法，因为它们没有相同的签名。任何实现该接口的类都`Executable`必须重写该方法`execute(Object)`。

java中重写方法的参数没有[协](http://en.wikipedia.org/wiki/Covariance_and_contravariance_%28computer_science%29)变，因为它是不安全的。如果你调用了`e.execute(new Object())`怎么办？[在哪里`e`引用`Biv`对象]`Biv`将不知道如何处理它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-08T23:43:55.297

1) 变量 e 被声明为 Executable，它是 Biv 实现的接口。这意味着您可以实例化 Biv，但将其存储为 Executable 并将其作为 Executable 传递。该变量现在只能被视为可执行文件。这就是多态性。

2）这是因为您试图覆盖一个函数并为签名添加额外的限制。这违反了 Liskov 替换原则。对于函数，原则基本上是“承诺不少，要求不多”。当接口说它可以是一个对象时，你正在做的是通过强制参数是一个字符串来“要求更多”。然后，将其与 (1) 联系起来，如果 main 中的 Executable 对象调用了它的 execute() 方法，它不应该限制你只向它传递一个 String （因为 Executable 接口说 execute() 可以接受一个 Object ）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-08T23:37:42.923

您正在查看的是[多态性](http://docs.oracle.com/javase/tutorial/java/IandI/polymorphism.html)，它是面向对象程序中的基本概念之一。要回答您的具体问题 #2，您需要匹配接口中方法的类型签名（它需要一个对象作为参数），然后将其转换为字符串。但是，在 Java 中，这种（强制转换）是一种[不好的做法](https://stackoverflow.com/questions/4167304/why-should-casting-be-avoided)，应尽可能避免。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-08T23:42:02.933

您没有*覆盖*方法 from `Executable`（这是必需的），而是*重载*了它（相同的名称，不同的参数类型）。

使用[`@Override`](http://docs.oracle.com/javase/6/docs/api/java/lang/Override.html)注释，这将有助于突出显示错误：

```
public class Biv implements Executable { 

   @Override // This will cause an error to be highlighted saying this isn't overriding any method
   public int execute (String s) { 
     System.out.println (s); 
     return s.length(); 
   }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-08T23:50:03.897

Object 类实现了一个 toString() 方法，因此不需要强制转换。更改 Biv 以接收对象而不是字符串，并在方法中首先调用对象的 toString()，然后获取字符串的长度：

```
interface Executable { 
   public int execute (Object o); 
} 

public class Biv implements Executable { 

   public int execute (Object s) { 
      System.out.println (s); 
      return s.toString().length(); 
   } 

   public static void main (String[] args) { 
      Executable e = new Biv(); 
      System.out.println( 
          e.execute ("Hello World!")); 
   }

} 
```

然而，使用 Object 来实现命令设计模式通常是不好的做法，以便拥有一个接受多种类型可能参数的方法。最好将参数封装在 Parameter 接口后面。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-08T23:53:22.613

首先让我们考虑这一行：

`public class Biv implements Executable`

`implements Executable`表示该类`Biv`可以扮演一个`Executable`. 或者换句话说，`Biv`实现了`Executable`.

这解释了为什么稍后您可以这样做：

`Executable e = new Biv();`

我有一个类型的变量，`Executable`这次我将使用它的`Biv`实现。如果`Biv`实现了该`Executable`接口（并且它在您的示例中声明了它），那么这没关系。

现在让我们来看看这个例子开始出错的地方。可执行文件中的接口包含此方法声明：

`public int execute (Object o);`

这就是说，你可以随意调用`execute`和传入任何`Object`你喜欢的东西。但是你能把你喜欢的任何对象传递给`execute`in 的方法`Biz`吗？不，你只能通过一个`String`. 所以 Biz 并没有完全满足界面。

[圆椭圆问题] 可能是很好的延伸阅读。[1](http://en.wikipedia.org/wiki/Circle-ellipse_problem)

# javascript - 严格模式：argument.callee.length 的替代方案？

> ID：10067429
> 
> 赞同：6
> 
> 时间：2012-04-08T23:33:27.387
> 
> 标签：javascript

Javascript：权威指南（2011）有这个例子（p.186）在严格模式下不起作用，但没有展示如何在严格模式下实现它——我能想到要尝试的事情，但想知道最佳实践/security/performance--在严格模式下做这类事情的最佳方法是什么？这是代码：

```
// This function uses arguments.callee, so it won't work in strict mode.
function check(args) {
    var actual = args.length;          // The actual number of arguments
    var expected = args.callee.length; // The expected number of arguments
    if (actual !== expected)           // Throw an exception if they differ.
        throw Error("Expected " + expected + "args; got " + actual);
}

function f(x, y, z) {
    check(arguments);  // Check that the actual # of args matches expected #.
    return x + y + z;  // Now do the rest of the function normally.
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-08T23:41:32.817

你可以通过你正在检查的功能。

```
function check(args, func) {
    var actual = args.length,
        expected = func.length;
    if (actual !== expected)
        throw Error("Expected " + expected + "args; got " + actual);
}

function f(x, y, z) {
    check(arguments, f);
    return x + y + z;
} 
```

* * *

`Function.prototype`或者，如果您处于允许它的环境中，请扩展...

```
Function.prototype.check = function (args) {
    var actual = args.length,
        expected = this.length;
    if (actual !== expected)
        throw Error("Expected " + expected + "args; got " + actual);
}

function f(x, y, z) {
    f.check(arguments);
    return x + y + z;
} 
```

* * *

或者您可以创建一个装饰器函数，该函数返回一个将自动进行检查的函数......

```
function enforce_arg_length(_func) {
    var expected = _func.length;
    return function() {
        var actual = arguments.length;
        if (actual !== expected)
            throw Error("Expected " + expected + "args; got " + actual);
        return _func.apply(this, arguments);
    };
} 
```

...并像这样使用它...

```
var f = enforce_arg_length(function(x, y, z) {
    return x + y + z;
}); 
```

# ruby-on-rails - 我需要做什么才能使此链接在 Rails 中工作

> ID：10067430
> 
> 赞同：1
> 
> 时间：2012-04-08T23:33:32.210
> 
> 标签：ruby-on-rails

我正在尝试学习 ruby​​ 并学习如何处理一段时间的请求往返。

在我的 index.html.erb 页面上，我添加了这一行：

```
<%= link_to "Alex Link", test_path(@test) %> 
```

但我得到一个错误：

```
undefined method `test_path' for #<#<Class:0x4064e80>:0x3c0b5c8> 
```

据我了解，我需要向 routes.rb 添加一条记录，然后添加一个控制器。正确的？我怎么做？

[我在Rails Guides](http://guides.rubyonrails.org/routing.html)中阅读了对此的解释，但第一次这样做有点令人困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T23:55:53.447

如果可以的话，出于您的目的（学习）`resources tests`。

它还免费为您提供其他路线，请参阅 RESTful 路线。

# java - 人们说后端 Java 和前端 PHP 什么的是什么意思？

> ID：10067434
> 
> 赞同：3
> 
> 时间：2012-04-08T23:34:30.807
> 
> 标签：java, php, mysql

我已经编程了一段时间，我对 Java 和 PHP 以及网站非常熟悉。我感到困惑的是程序员如何一起使用它们。我听说 Facebook 和 Google 如何将 Python、C、Java、PHP 等各种语言用于一个产品，但我只是对这怎么可能感到困惑。

另外，另一个问题是：在为 Twitter 和 Facebook 等大型在线公司工作时，软件工程师到底做什么工作？大部分代码都处理数据库和信息，那么除了可以通过一些教程在线学习的内容之外，还需要在服务器端完成哪些主要级别的编程？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-08T23:39:31.610

这是一个非常广泛的问题，但这里有一个模糊的答案。很多时候，大型应用程序会有许多组件。例如，您可能有某种报告引擎、业务逻辑、Web 界面、桌面界面、Web 服务 API、移动界面等。理论上，这些中的每一个都可以用不同的语言编写并通过数据库或类似 Web 服务的东西。

对于你的第二个问题。在大公司，需要做大量工作来保持稳定性、开发新功能、修复发现的错误以及努力提高效率等。例如，Facebook（和谷歌）雇佣了大量的软件工程师来帮助他们处理每天收到的大量交易量。

**编辑**这里有更多的澄清和对您问题的直接回答。

> 大部分代码都处理数据库和信息，那么除了可以通过一些教程在线学习的内容之外，还需要在服务器端完成哪些主要级别的编程？

事实是，在大多数情况下，高层负责人是相同的。在网络上完成一些基本的 PHP/MySQL 教程后，您可以很容易地构建 Facebook 克隆。区别在于：你的克隆人在它到达 Facebook 每天看到的一小部分用户之前就会死掉。这会很慢，不可靠，人们会离开，因为他们的数据会不断地通过 SQL 注入和其他恶意攻击被黑客入侵。这甚至还没有讨论分布式计算。所以，是的，从高层次来看，这就是你需要知道的全部。实施和现实要复杂得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-08T23:45:14.203

如您所料，大型“网站”并不是按照传统意义上构建的，即您拥有一些 PHP 代码、一些 HTML 模板和一个数据库，因为这种架构在扩展到数千个并发用户时存在严重问题。

为了缓解这种情况，您可以将网站分成几个组件：

1.  将请求分发到多个应用服务器的负载均衡器
2.  生成 UI 并处理用户操作的应用服务器
3.  处理业务逻辑并将其分布在数据库服务器之间的中间件服务器
4.  以某种方式存储数据的数据库服务器

该系统的每个组件都可能以不同的语言实现，您甚至可能根据请求类型（例如移动设备）拥有不同的应用服务器。

这种类型的系统称为[多层架构](http://en.wikipedia.org/wiki/Multitier_architecture)。您还可以找到有关该主题的学术书籍。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T06:33:00.013

这是您正在寻找的实际答案
你很困惑，因为你看不到如何在网站上使用 C 和 C++ 应用程序，但我想告诉你，它们被用于很多事情......比如，当你在 facebook 中上传包含色情内容的图像时，php 不会验证该图像，他们将做的是通过通过参数传递该图像的地址来执行程序，并且该应用程序将验证该图像......并且应该存储一些数据以供将来使用，以便应用程序使用公共数据库网站正在使用，如果我们在googleplus中上传图片，那么它会将标签建议加载到可以看到人脸的某些部分，这是由该应用程序完成的，它将图像数据保存到google正在使用的公共数据库和php从那里获取信息，这是开发更多功能网站的技术......比如，我制作了一个程序来在本地主机上工作时关闭我的家用电脑：

```
<?php
$command="shutdown -s -f -t 5";
shell_exec($command);
?> 
```

这个脚本一旦在 apache 中运行将关闭服务器类似地你可以将参数传递到一些应用程序中，比如如果你想在命令行中为你自己的没有安装 Cpanel 的服务器创建电子邮件帐户......
以及第二部分的答案你的问题：
实际上聘请了软件工程师，以便他们开发一些可以在服务器上运行的应用程序以增加网站的功能......就像如果网站只有网页脚本语言，那么谷歌也无法识别这张脸facebook，并且网站无法进行人工智能..
这篇文章可能会消除您的困惑...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-08T23:52:40.233

大多数复杂的产品由许多部件组成。例如，StackExchange 具有在您的浏览器中运行的代码，这些代码是用 JavaScript 编写的，因此它可以在您的浏览器中运行。但是构建网页的代码不在浏览器中运行，因此也不是用 JavaScript 编写的。如果需要复杂的数据库查询，它们很可能在 SQL 中。以此类推。这个大难题的每一个部分都以最适合该部分的功能和运行环境的语言实现。

感谢GMail。有一个用 JavaScript 编写的浏览器内片段。还有一个 Web 服务器、一个数据库、一个邮件服务器、一个大容量存储系统、索引以及许多其他部分。

# ruby-on-rails - 如何在控制器中使用“验证”方法？

> ID：10067435
> 
> 赞同：2
> 
> 时间：2012-04-08T23:34:30.837
> 
> 标签：ruby-on-rails, controller, ruby-on-rails-3.2

我正在使用 Ruby on Rails 3.2.2，在我的控制器中我想以这种方式使用该`verify`方法：

```
class UsersController < ApplicationController
  verify :params      => "user",
         :only        => :update,
         :redirect_to => {:action => 'settings'}

  ...
end 
```

但是，当我访问调用`update`控制器操作（或任何其他控制器操作）的浏览器页面时，我收到以下错误：

```
Routing Error
undefined method `verify' for UsersController:Class 
```

我该如何解决这个问题？在哪里可以找到有关该`verify`方法的一些文档？

* * *

*注意*：该`verify`方法在Obie Fernandez 编写的“ *The Rails 3 Way* ”一书（*第 111 页）中进行了描述。*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-08T23:55:52.830

很抱歉`verify`，Rails 3.2 中不再提供该方法。它最后一次用于 Rails v2.3.8

一些验证是 [http://api.rubyonrails.org/files/activesupport/lib/active_support/message_verifier_rb.html](http://api.rubyonrails.org/files/activesupport/lib/active_support/message_verifier_rb.html)

或者您在 Active_support/Multibyte/utils.rb 中找到一些有用的验证和有效方法

[https://github.com/rails/rails/blob/67d8b9743add53f908ca417c641c4a54dd326c7d/activesupport/lib/active_support/multibyte/utils.rb](https://github.com/rails/rails/blob/67d8b9743add53f908ca417c641c4a54dd326c7d/activesupport/lib/active_support/multibyte/utils.rb)

希望这可以帮助。

# c - Oracle Pro*C：处理提取游标结束

> ID：10067438
> 
> 赞同：0
> 
> 时间：2012-04-08T23:35:28.760
> 
> 标签：c, oracle, error-handling, cursor, oracle11g

我无法弄清楚我的代码中的问题：

```
/* Declare a cursor for the FETCH statement. */
EXEC SQL DECLARE customer_cursor CURSOR FOR
SELECT CUSTOMER_ID, CUSTOMER_NAME
FROM CUSTOMER_TABLE 
WHERE CUSTOMER_CARD_NUM = :argv[1];

if ( sqlca.sqlcode != 0 )
{
        printf("Declare cursor failed\n");
        return( sqlca.sqlcode );
}
EXEC SQL OPEN customer_cursor;
if ( sqlca.sqlcode != 0 )
{
        printf("Open cursor failed\n");
        return( sqlca.sqlcode );
}
EXEC SQL WHENEVER NOT FOUND GOTO no_match;

for ( ;; )
{
    /* Fetching data */
    EXEC SQL FETCH customer_cursor 
        INTO :var_customer_id, :var_customer_name;
    if ( sqlca.sqlcode != 0 )
    {
            EXEC SQL CLOSE cust_data_cursor;
            return ( sqlca.sqlcode );
    }

    /* Doing some stuff here */
    processing_customer();

}
EXEC SQL CLOSE customer_cursor;

/* Handling the no data found here */    
no_match:

      printf("NO CUSTOMER MATCHING THIS CARD_NUM\n");
      /* Some stuff */
      ......
      return 1; 
```

我的查询应该只返回一行或什么都不返回，当什么都不返回时一切正常，**但是当匹配时，函数 processing_customer 被执行，奇怪的是 no_match 也被执行**。

谢谢你帮我解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T10:28:45.363

As @Roger Cornejo suggests, you need a way to *not* execute the 'no match' section if there is a match. `no_match:` is just a label so there's nothing to tell your code not to execute that section. You either need to return before that label, or `goto` something after it. You also need to close the cursor in the no-match scenario.

But this seems unnecessarily messy and as @Arion hinted you don't need an explicit cursor for this - just do a `select into` and catch the exception.

```
EXEC SQL SELECT CUSTOMER_ID, CUSTOMER_NAME
    INTO :var_customer_id, :var_customer_name
    FROM CUSTOMER_TABLE 
    WHERE CUSTOMER_CARD_NUM = :argv[1];

if (sqlca.sqlcode == 1403)
{
    printf("NO CUSTOMER MATCHING THIS CARD_NUM\n");
    /* Some stuff */
    ......
    return 1;
}
if (sqlca.sqlcode != 0)
{
    return ( sqlca.sqlcode );
}

/* Doing some stuff here */
processing_customer(); 
```

You've said there will be zero or one rows; if there are more than one you'll get a too-many-rows error (ORA-02112).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-05T18:58:26.223

将您的标签“no_match”更改为“no_more_records”，您就会明白为什么它会运行 2 次：

a) 当没有记录时，FETCH 立即引发 NOT FOUND 条件，因此将转到标签“no_more_records”

b) 当有一个（或多个）记录时，执行 FETCH 返回第一个记录。

然后

> 如果 ( sqlca.sqlcode != 0 )

评估为假（实际上，仅对捕获其他问题有用），然后

> 处理_客户（）；

之后，FETCH 再次运行（通过无穷大）并表现如（a）： no_more_records 条件到达。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T13:19:32.650

在“EXEC SQL CLOSE customer_cursor;”之后添加 GOTO

# c - 在 C 中开始使用 http 媒体流

> ID：10067440
> 
> 赞同：2
> 
> 时间：2012-04-08T23:36:19.587
> 
> 标签：c, http, http-streaming

好吧，我想学习 C 有一段时间了，现在我有了一个与我想要建立的网站实际上相关的项目想法，但我有一些关于如何开始的初步问题。这不是一个真正的“如何编程”问题或任何问题，我可以很好地开始 C 编程，只要我有文档等，我就知道如何阅读各种 API 和协议并与之通信。我只是在寻找作为一个起点，我猜。

该程序类似于ice 或shoutcast，因此基本上是音频流。有没有人认为他们可以对所需内容进行简要的高级概述？正如我所说，最终产品将是您在 .pls 文件中弹出的 url，您可以将其流式传输到所需的 w/e 客户端。我应该查看哪些协议、库和文档？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-08T23:49:15.977

如果您希望它成为学习的玩具，您可能希望自己完成所有工作；这是一个复杂的问题，把它做*对*肯定是有教育意义的。[Advanced Programming the Unix Env​​ironment, 2nd edition](http://www.apuebook.com/)或TCP [/IP Illustrated, Vol 1](http://en.wikipedia.org/wiki/TCP/IP_Illustrated#Volume_1%3a_The_Protocols)会有所帮助，但并非绝对必要。

如果您也希望这也有用，我建议您从[`libev`](http://software.schmorp.de/pkg/libev.html)or开始[`libevent`](http://libevent.org/)。`libevent`有一些内置的 HTTP 处理，这可能很好，但[有报告称`libevent`HTTP 处理并不完美](http://blog.gevent.org/2011/04/28/libev-and-libevent/)。`libev`不提供内置的 HTTP 处理，但它应该`libev`比手动执行所有工作更容易编写。与手动编写整个程序相比，使用这些预先编写的基于事件的库将提高程序的稳定性和可靠性，尽管它们并没有做任何你自己做不到的事情。

# java - GSON 转换为 LinkedHashMap 而不是我的对象

> ID：10067441
> 
> 赞同：11
> 
> 时间：2012-04-08T23:37:07.897
> 
> 标签：java, gson

我有这段代码：

```
public abstract class Repository<Entity extends BaseObject> {

...

public void readFromJson(){
    String content = "JSON content here";
    Gson gson = new Gson();
    Type entityType = new TypeToken<JSONObject<Entity>>(){}.getType();

    jsonObject = gson.fromJson(content, entityType);

    for (Entity ent : jsonObject.getEntities()) ;
    }
} 
```

当我尝试执行 foreach 时，我的实体对象不再是 Entity 类型，而是 LinkedHashMap 并且我得到了这个异常：java.lang.ClassCastException: java.util.LinkedHashMap cannot be cast to com.tranca.bookstore.domain.shared.BaseObject

这是 JSONObject 类（由我创建）

```
public class JSONObject<Entity> {

private List<Entity> entities = new ArrayList<Entity>();
private long lastId = -1;
public List<Entity> getEntities() {
    return entities;
}
public void setEntities(List<Entity> entities) {
    this.entities = entities;
}
public long getLastId() {
    return lastId;
}
public void setLastId(long lastId) {
    this.lastId = lastId;
}

public void incrementLastId() {
    this.lastId++;
} 
```

}

也许基础对象是相关的，所以我将代码放在这里：

```
public abstract class BaseObject implements Serializable {

protected long id = (long) -1;
protected int version = 0;

protected BaseObject(){}

public long getId() {
    return id;
}
public void setId(long id) {
    this.id = id;
}
public int getVersion() {
    return version;
}
public void setVersion(int version) {
    this.version = version;
}

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-11-06T07:40:51.827

我有同样/类似的问题。在稍微不同的上下文中给出更明确的答案：

我有以下方法产生错误“com.google.gson.internal.LinkedTreeMap 无法转换为 MyType”：

```
/**
   * Reads a LinkedHashMap from the specified parcel.
   * 
   * @param <TKey>
   *          The type of the key.
   * @param <TValue>
   *          The type of the value.
   * @param in
   *          The in parcel.
   * @return Returns an instance of linked hash map or null.
   */
  public static <TKey, TValue> LinkedHashMap<TKey, TValue> readLinkedHashMap(Parcel in) {
    Gson gson = JsonHelper.getGsonInstance();
    String content = in.readString();
    LinkedHashMap<TKey, TValue> result = gson.fromJson(content, new TypeToken<LinkedHashMap<TKey, TValue>>(){}.getType());
    return result;
  } 
```

我想要一种简单的通用方法来读/写链接的哈希图。上述解决方案不起作用，因为据我了解，编译后带有 TKey 和 TValue 的 TypeToken 的类型信息将丢失。这就是问题所在。如果您将代码更改为以下示例，那么它可以工作，因为现在我们明确定义了类型标记。我不太喜欢java，所以我理解为什么在这种情况下可以在运行时读取类型信息。

```
/**
   * Reads a LinkedHashMap from the specified parcel.
   * 
   * @param <TKey>
   *          The type of the key.
   * @param <TValue>
   *          The type of the value.
   * @param in
   *          The in parcel.
   * @return Returns an instance of linked hash map or null.
   */
  public static <TKey, TValue> LinkedHashMap<TKey, TValue> readLinkedHashMap(Parcel in, TypeToken<LinkedHashMap<TKey, TValue>> typeToken) {
    Gson gson = JsonHelper.getGsonInstance();
    Type type = typeToken.getType();
    String content = in.readString();
    LinkedHashMap<TKey, TValue> result = gson.fromJson(content, type);
    return result;
  } 
```

现在你可以像这样调用上面的函数：

```
readLinkedHashMap(in, new TypeToken<LinkedHashMap<UUID, MyObject>>(){}); 
```

旁注 1：编写链接哈希映射时，您根本不需要指定任何类型标记。toJson(map) 就足够了。

旁注 2（我遇到的一个问题）：默认情况下，gson 使用 toString() 来序列化密钥。如果您为可能是更复杂类型的键类型注册类型适配器，则在序列化时不会应用此类型适配器，而是在反序列化时应用。这会导致不一致并因此失败的过程。以下选项激活[复杂的映射键序列化](https://google-gson.googlecode.com/svn/trunk/gson/docs/javadocs/com/google/gson/GsonBuilder.html#enableComplexMapKeySerialization)。

```
gsonBuilder.enableComplexMapKeySerialization() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T21:33:40.383

终于明白了！

问题是：

> 新 TypeToken< JSONObject< Entity>>(){}.getType();

返回 JSONObject<T> 的类型，而不是扩展 Repository 的子类的特定实体（例如，UserRepository 扩展 Repository<User>）。

诀窍是创建一个抽象方法来强制子类设置反序列化的类型。

总之，如果您收到此错误，请确保您拥有正确的类类型（如果您使用子类，请确保它返回您的子类而不是超类的类型）。

# android - 在android中指定项目的顺序

> ID：10067446
> 
> 赞同：1
> 
> 时间：2012-04-08T23:38:01.270
> 
> 标签：android, input

我有一个项目列表，例如“a”、“b”、“c”。作为用户的输入，我想为这些项目指定一个顺序，例如 {a, c, b} 或 {b, c, a} 等。在 android 中是否有标准的方式来获取这些类型输入，或者如果有人能提出一种方法来实现这一点，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T23:47:03.357

这是一个过于宽泛的问题。诸如列表有多长之类的问题可能很重要，但是：

我建议用户[使用 android 通过拖放来重新排序列表视图项目的拖放](https://stackoverflow.com/questions/3141144/reordering-of-listview-items-by-drag-and-drop-using-android)功能，因为这对于用户用于重新排序来说非常自然和流畅。

然后您可以保存您的列表视图状态：[保存 Android 列表视图的高级状态](https://stackoverflow.com/questions/7566206/saving-advanced-state-of-an-android-listview)如果您想将其保存到数据库或由于过于广泛的问题而我不知道的东西，但您也可以这样做。

# ios - OpenGL ES 2.0 如何在 iOS 中使用不同的着色器程序绘制多个 VBO

> ID：10067447
> 
> 赞同：4
> 
> 时间：2012-04-08T23:38:01.380
> 
> 标签：ios, ios5, opengl-es, opengl-es-2.0

我正在尝试破解通用 Xcode iOS OpenGL 游戏模板以绘制两个顶点缓冲区对象并使用不同的 GLSL 着色器渲染它们。我“认为”我正确渲染了两个 VBO？（因为我在通过第一个着色器程序运行两个 VBO 时都看到了它们）但是，我的第二个着色器似乎根本没有渲染我的第二个对象。

这是两个正方形的顶点数据：

```
GLfloat gCubeVertexData[36] = 
{
    // Data layout for each line below is:
    // positionX, positionY, positionZ,     normalX, normalY, normalZ,

    0.5f, 0.5f, 0.5f,          0.0f, 0.0f, 1.0f,
    -0.5f, 0.5f, 0.5f,         0.0f, 0.0f, 1.0f,
    0.5f, -0.5f, 0.5f,         0.0f, 0.0f, 1.0f,
    0.5f, -0.5f, 0.5f,         0.0f, 0.0f, 1.0f,
    -0.5f, 0.5f, 0.5f,         0.0f, 0.0f, 1.0f,
    -0.5f, -0.5f, 0.5f,        0.0f, 0.0f, 1.0f

};

GLfloat fooVertexData[36] = 
{
    // Data layout for each line below is:
    // positionX, positionY, positionZ,     normalX, normalY, normalZ

    0.5f, 0.5f, 0.5f,          0.0f, 0.0f, 1.0f,
    -0.5f, 0.5f, 0.5f,         0.0f, 0.0f, 1.0f,
    0.5f, -0.5f, 0.5f,         0.0f, 0.0f, 1.0f,
    0.5f, -0.5f, 0.5f,         0.0f, 0.0f, 1.0f,
    -0.5f, 0.5f, 0.5f,         0.0f, 0.0f, 1.0f,
    -0.5f, -0.5f, 0.5f,        0.0f, 0.0f, 1.0f
}; 
```

这是我试图生成两个 VBO 并将它们绑定到数据的地方。不知道'glBindVertexArrayOES（0）'的目的到底是什么？：

```
- (void)setupGL
{
    [EAGLContext setCurrentContext:self.context];

    [self loadShaders];

    //---- First Vertex Array Object --------
    glGenVertexArraysOES(1, &_vertexArray1);
    glGenBuffers(1, &_vertexBuffer1);   

    glBindVertexArrayOES(_vertexArray1);

    glBindBuffer(GL_ARRAY_BUFFER, _vertexBuffer1);
    glBufferData(GL_ARRAY_BUFFER, sizeof(gCubeVertexData), gCubeVertexData, GL_STATIC_DRAW);

    glEnableVertexAttribArray(GLKVertexAttribPosition);
    glVertexAttribPointer(GLKVertexAttribPosition, 3, GL_FLOAT, GL_FALSE, 24, BUFFER_OFFSET(0));
    glEnableVertexAttribArray(GLKVertexAttribNormal);
    glVertexAttribPointer(GLKVertexAttribNormal, 3, GL_FLOAT, GL_FALSE, 24, BUFFER_OFFSET(12));

    //----- Second Vertex Array Object ----------
    glGenVertexArraysOES(1, &_vertexArray2);
    glGenBuffers(1, &_vertexBuffer2);

    glBindVertexArrayOES(_vertexArray2);

    glBindBuffer(GL_ARRAY_BUFFER, _vertexBuffer2);
    glBufferData(GL_ARRAY_BUFFER, sizeof(fooVertexData), fooVertexData, GL_STATIC_DRAW);

    glEnableVertexAttribArray(GLKVertexAttribPosition);
    glVertexAttribPointer(GLKVertexAttribPosition, 3, GL_FLOAT, GL_FALSE, 24, BUFFER_OFFSET(0));
    glEnableVertexAttribArray(GLKVertexAttribNormal);
    glVertexAttribPointer(GLKVertexAttribNormal, 3, GL_FLOAT, GL_FALSE, 24, BUFFER_OFFSET(12));

    glBindBuffer(GL_ARRAY_BUFFER,0);
    glBindVertexArrayOES(0);
} 
```

我正在使用此更新代码为模型视图投影矩阵设置动画：

```
- (void)update
{
    _rotation += self.timeSinceLastUpdate * 0.2f;

    float aspect = fabsf(self.view.bounds.size.width / self.view.bounds.size.height);

    GLKMatrix4 projectionMatrix = GLKMatrix4MakeOrtho(-1.0f, 1.0f, -1.0f / aspect, 1.0f / aspect, -10.0f, 10.0f);
    GLKMatrix4 modelViewMatrix = GLKMatrix4MakeTranslation(0.5f, 0.0f, 0.0f);
    modelViewMatrix = GLKMatrix4Multiply(modelViewMatrix, GLKMatrix4MakeZRotation(0.0 - _rotation));
    _modelViewProjectionMatrix = GLKMatrix4Multiply(projectionMatrix, modelViewMatrix);

    GLKMatrix4 modelViewMatrix2 = GLKMatrix4MakeTranslation(-0.5f, 0.0f, 0.0f);
    modelViewMatrix2 = GLKMatrix4Multiply(modelViewMatrix2, GLKMatrix4MakeZRotation(_rotation));
    _modelViewProjectionMatrix2 = GLKMatrix4Multiply(projectionMatrix, modelViewMatrix2);
} 
```

当我调用“_program2”着色器时，我看不到第二个正方形：

```
- (void)glkView:(GLKView *)view drawInRect:(CGRect)rect
{
    glClearColor(0.65f, 0.65f, 0.65f, 1.0f);
    glClear(GL_COLOR_BUFFER_BIT);

    glBindVertexArrayOES(_vertexArray1);
    glBindBuffer(GL_ARRAY_BUFFER, _vertexBuffer1);

    glUseProgram(_program);
    glUniformMatrix4fv(uniforms[UNIFORM_MODELVIEWPROJECTION_MATRIX], 1, 0, _modelViewProjectionMatrix.m);
    glDrawArrays(GL_TRIANGLES, 0, 6);

    ///////// second object and shader program:
    glBindVertexArrayOES(_vertexArray2);
    glBindBuffer(GL_ARRAY_BUFFER, _vertexBuffer2);

    glUseProgram(_program2);
    glUniformMatrix4fv(uniforms[UNIFORM_MODELVIEWPROJECTION_MATRIX2], 1, 0, _modelViewProjectionMatrix2.m);
    glDrawArrays(GL_TRIANGLES, 0, 6);

} 
```

我基本上尝试复制加载第一个着色器的代码，以加载第二个。我怀疑我可能在这里做错了什么..但我不确定是什么：

```
- (BOOL)loadShaders
{
    GLuint vertShader, fragShader, vertShader2, fragShader2;
    NSString *vertShaderPathname, *fragShaderPathname, *vertShaderPathname2, *fragShaderPathname2;

    // Create shader program.
    _program = glCreateProgram();

    // Create and compile vertex shader.
    vertShaderPathname = [[NSBundle mainBundle] pathForResource:@"Shader" ofType:@"vsh"];
    if (![self compileShader:&vertShader type:GL_VERTEX_SHADER file:vertShaderPathname]) {
        NSLog(@"Failed to compile vertex shader");
        return NO;
    }

    // Create and compile fragment shader.
    fragShaderPathname = [[NSBundle mainBundle] pathForResource:@"Shader" ofType:@"fsh"];
    if (![self compileShader:&fragShader type:GL_FRAGMENT_SHADER file:fragShaderPathname]) {
        NSLog(@"Failed to compile fragment shader");
        return NO;
    }

    // Attach vertex shader to program.
    glAttachShader(_program, vertShader);

    // Attach fragment shader to program.
    glAttachShader(_program, fragShader);

    // Bind attribute locations.
    // This needs to be done prior to linking.
    glBindAttribLocation(_program, ATTRIB_VERTEX, "position");

    // Link program.
    if (![self linkProgram:_program]) {
        NSLog(@"Failed to link program: %d", _program);

        if (vertShader) {
            glDeleteShader(vertShader);
            vertShader = 0;
        }
        if (fragShader) {
            glDeleteShader(fragShader);
            fragShader = 0;
        }
        if (_program) {
            glDeleteProgram(_program);
            _program = 0;
        }

        return NO;
    }

    // Get uniform locations.
    uniforms[UNIFORM_MODELVIEWPROJECTION_MATRIX] = glGetUniformLocation(_program, "modelViewProjectionMatrix");

    // Release vertex and fragment shaders.
    if (vertShader) {
        glDetachShader(_program, vertShader);
        glDeleteShader(vertShader);
    }
    if (fragShader) {
        glDetachShader(_program, fragShader);
        glDeleteShader(fragShader);
    }

    ///////////////// the second shader:

    _program2 = glCreateProgram();

    vertShaderPathname2 = [[NSBundle mainBundle] pathForResource:@"Shader2" ofType:@"vsh"];
    if (![self compileShader:&vertShader2 type:GL_VERTEX_SHADER file:vertShaderPathname2]) {
        NSLog(@"Failed to compile vertex shader2");
        return NO;
    }

    fragShaderPathname2 = [[NSBundle mainBundle] pathForResource:@"Shader2" ofType:@"fsh"];
    if (![self compileShader:&fragShader2 type:GL_FRAGMENT_SHADER file:fragShaderPathname2]) {
        NSLog(@"Failed to compile fragment shader2");
        return NO;
    }

        glAttachShader(_program2, vertShader2);
        glAttachShader(_program2, fragShader2);

        glBindAttribLocation(_program2, ATTRIB_VERTEX2, "position2");

    if (![self linkProgram:_program2]) {
        NSLog(@"Failed to link program: %d", _program2);

        if (vertShader2) {
            glDeleteShader(vertShader2);
            vertShader2 = 0;
        }
        if (fragShader2) {
            glDeleteShader(fragShader2);
            fragShader2 = 0;
        }
        if (_program2) {
            glDeleteProgram(_program2);
            _program2 = 0;
        }

        return NO;
    }

        uniforms[UNIFORM_MODELVIEWPROJECTION_MATRIX2] = glGetUniformLocation(_program2, "modelViewProjectionMatrix2");
    if (vertShader2) {
        glDetachShader(_program2, vertShader2);
        glDeleteShader(vertShader2);
    }
    if (fragShader2) {
        glDetachShader(_program2, fragShader2);
        glDeleteShader(fragShader2);
    }    

    return YES;
}

- (BOOL)compileShader:(GLuint *)shader type:(GLenum)type file:(NSString *)file
{
    GLint status;
    const GLchar *source;

    source = (GLchar *)[[NSString stringWithContentsOfFile:file encoding:NSUTF8StringEncoding error:nil] UTF8String];
    if (!source) {
        NSLog(@"Failed to load vertex shader");
        return NO;
    }

    *shader = glCreateShader(type);
    glShaderSource(*shader, 1, &source, NULL);
    glCompileShader(*shader);

#if defined(DEBUG)
    GLint logLength;
    glGetShaderiv(*shader, GL_INFO_LOG_LENGTH, &logLength);
    if (logLength > 0) {
        GLchar *log = (GLchar *)malloc(logLength);
        glGetShaderInfoLog(*shader, logLength, &logLength, log);
        NSLog(@"Shader compile log:\n%s", log);
        free(log);
    }
#endif

    glGetShaderiv(*shader, GL_COMPILE_STATUS, &status);
    if (status == 0) {
        glDeleteShader(*shader);
        return NO;
    }

    return YES;
}

- (BOOL)linkProgram:(GLuint)prog
{
    GLint status;
    glLinkProgram(prog);

#if defined(DEBUG)
    GLint logLength;
    glGetProgramiv(prog, GL_INFO_LOG_LENGTH, &logLength);
    if (logLength > 0) {
        GLchar *log = (GLchar *)malloc(logLength);
        glGetProgramInfoLog(prog, logLength, &logLength, log);
        NSLog(@"Program link log:\n%s", log);
        free(log);
    }
#endif

    glGetProgramiv(prog, GL_LINK_STATUS, &status);
    if (status == 0) {
        return NO;
    }

    return YES;
}

- (BOOL)validateProgram:(GLuint)prog
{
    GLint logLength, status;

    glValidateProgram(prog);
    glGetProgramiv(prog, GL_INFO_LOG_LENGTH, &logLength);
    if (logLength > 0) {
        GLchar *log = (GLchar *)malloc(logLength);
        glGetProgramInfoLog(prog, logLength, &logLength, log);
        NSLog(@"Program validate log:\n%s", log);
        free(log);
    }

    glGetProgramiv(prog, GL_VALIDATE_STATUS, &status);
    if (status == 0) {
        return NO;
    }

    return YES;
} 
```

我的顶点和片段着色器很简单：

```
// vert shader1:
attribute vec4 position;
uniform mat4 modelViewProjectionMatrix;

void main()
{
    gl_Position = modelViewProjectionMatrix * position;
}

// vert shader2:
attribute vec4 position2;
uniform mat4 modelViewProjectionMatrix2;

void main()
{
    gl_Position = modelViewProjectionMatrix2 * position2;
}

// frag shader(s):
void main()
{
    gl_FragColor = vec4(0.12,0.32,0.54,1.0);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T18:10:19.723

使用 OpenGL ES 时要记住的最重要的事情是，您在 OOP 语言中使用了过程语言。

一次只能将**一个顶点数组**绑定到顶点缓冲区。

将两个顶点数组一个接一个地绑定到 VBO，然后应用变换，只会变换附加到 VBO 的最后一个顶点数组。

在您的主循环中，您必须遍历您的顶点数组列表。对于每个顶点数组，将其绑定到 VBO，然后执行任何转换。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T16:25:40.410

主要问题是我为第二个顶点着色器绑定了“位置”属性位置。我一直在我的枚举中使用“单独的”ATTRIB_VERTEX2。一旦我将“位置”属性位置绑定到 ATTRIB_VERTEX，我就能够看到应用了其他着色器程序的第二个 VBO……这是为有相同问题/问题的任何人整理的代码：

```
// Uniform index.
enum
{
    UNIFORM_MODELVIEWPROJECTION_MATRIX,
    UNIFORM_MODELVIEWPROJECTION_MATRIX2,    
    NUM_UNIFORMS
};
GLint uniforms[NUM_UNIFORMS];

// Attribute index.
enum
{
    ATTRIB_VERTEX,
    NUM_ATTRIBUTES
};

GLfloat square1Data[18] = 
{
    // Data layout for each line below is:
    // positionX, positionY, positionZ

    0.5f, 0.5f, 0.5f,  
    -0.5f, 0.5f, 0.5f, 
    0.5f, -0.5f, 0.5f, 
    0.5f, -0.5f, 0.5f, 
    -0.5f, 0.5f, 0.5f, 
    -0.5f, -0.5f, 0.5f

};

GLfloat square2Data[18] = 
{
    // Data layout for each line below is:
    // positionX, positionY, positionZ

    0.5f, 0.5f, 0.5f,   
    -0.5f, 0.5f, 0.5f,  
    0.5f, -0.5f, 0.5f,  
    0.5f, -0.5f, 0.5f,  
    -0.5f, 0.5f, 0.5f,  
    -0.5f, -0.5f, 0.5f
};

- (void)setupGL
{
    [EAGLContext setCurrentContext:self.context];

    [self loadShaders];

    //---- First Vertex Array Object --------
    glGenVertexArraysOES(1, &_vertexArray1);
    glGenBuffers(1, &_vertexBuffer1);   

    glBindVertexArrayOES(_vertexArray1);

    glBindBuffer(GL_ARRAY_BUFFER, _vertexBuffer1);
    glBufferData(GL_ARRAY_BUFFER, sizeof(square1Data), square1Data, GL_STATIC_DRAW);

    glEnableVertexAttribArray(GLKVertexAttribPosition);
    glVertexAttribPointer(GLKVertexAttribPosition, 3, GL_FLOAT, GL_FALSE, 12, BUFFER_OFFSET(0));
//    glEnableVertexAttribArray(GLKVertexAttribNormal);
//    glVertexAttribPointer(GLKVertexAttribNormal, 3, GL_FLOAT, GL_FALSE, 24, BUFFER_OFFSET(12));

    //----- Second Vertex Array Object ----------
    glGenBuffers(1, &_vertexBuffer2);

    glBindBuffer(GL_ARRAY_BUFFER, _vertexBuffer2);
    glBufferData(GL_ARRAY_BUFFER, sizeof(square2Data), square2Data, GL_STATIC_DRAW);

    glEnableVertexAttribArray(GLKVertexAttribPosition);
    glVertexAttribPointer(GLKVertexAttribPosition, 3, GL_FLOAT, GL_FALSE, 12, BUFFER_OFFSET(0));
//    glEnableVertexAttribArray(GLKVertexAttribNormal);
//    glVertexAttribPointer(GLKVertexAttribNormal, 3, GL_FLOAT, GL_FALSE, 24, BUFFER_OFFSET(12));

    glBindBuffer(GL_ARRAY_BUFFER,0);
    glBindVertexArrayOES(0);
}

- (void)update
{
    _rotation += self.timeSinceLastUpdate * 0.2f;

    float aspect = fabsf(self.view.bounds.size.width / self.view.bounds.size.height);

    GLKMatrix4 projectionMatrix = GLKMatrix4MakeOrtho(-1.0f, 1.0f, -1.0f / aspect, 1.0f / aspect, -10.0f, 10.0f);

    GLKMatrix4 modelViewMatrix = GLKMatrix4MakeTranslation(0.5f, 0.0f, 0.0f);
    modelViewMatrix = GLKMatrix4Multiply(modelViewMatrix, GLKMatrix4MakeZRotation(0.0 - _rotation));
    _modelViewProjectionMatrix = GLKMatrix4Multiply(projectionMatrix, modelViewMatrix);

    GLKMatrix4 modelViewMatrix2 = GLKMatrix4MakeTranslation(-0.5f, 0.0f, 0.0f);
    modelViewMatrix2 = GLKMatrix4Multiply(modelViewMatrix2, GLKMatrix4MakeZRotation(_rotation));
    _modelViewProjectionMatrix2 = GLKMatrix4Multiply(projectionMatrix, modelViewMatrix2);

}

- (void)glkView:(GLKView *)view drawInRect:(CGRect)rect
{
    glClearColor(0.65f, 0.65f, 0.65f, 1.0f);
    glClear(GL_COLOR_BUFFER_BIT);

    glBindVertexArrayOES(_vertexArray1);

    glBindBuffer(GL_ARRAY_BUFFER, _vertexBuffer1);
    glUseProgram(_program);
    glUniformMatrix4fv(uniforms[UNIFORM_MODELVIEWPROJECTION_MATRIX], 1, 0, _modelViewProjectionMatrix.m);
    glDrawArrays(GL_TRIANGLES, 0, 6);

    ///////// second VBO and shader program:
    glBindBuffer(GL_ARRAY_BUFFER, _vertexBuffer2);
    glUseProgram(_program2);
    glUniformMatrix4fv(uniforms[UNIFORM_MODELVIEWPROJECTION_MATRIX2], 1, 0, _modelViewProjectionMatrix2.m);
    glDrawArrays(GL_TRIANGLES, 0, 6); 
}

- (BOOL)loadShaders
{
    GLuint vertShader, fragShader, vertShader2, fragShader2;
    NSString *vertShaderPathname, *fragShaderPathname, *vertShaderPathname2, *fragShaderPathname2;

    // Create shader program.
    _program = glCreateProgram();
    _program2 = glCreateProgram(); 

    // Create and compile vertex shader.
    vertShaderPathname = [[NSBundle mainBundle] pathForResource:@"Shader" ofType:@"vsh"];
    if (![self compileShader:&vertShader type:GL_VERTEX_SHADER file:vertShaderPathname]) {
        NSLog(@"Failed to compile vertex shader");
        return NO;
    }

    // Create and compile fragment shader.
    fragShaderPathname = [[NSBundle mainBundle] pathForResource:@"Shader" ofType:@"fsh"];
    if (![self compileShader:&fragShader type:GL_FRAGMENT_SHADER file:fragShaderPathname]) {
        NSLog(@"Failed to compile fragment shader");
        return NO;
    }

    // Create and compile vertex shader.
    vertShaderPathname2 = [[NSBundle mainBundle] pathForResource:@"Shader2" ofType:@"vsh"];
    if (![self compileShader:&vertShader2 type:GL_VERTEX_SHADER file:vertShaderPathname2]) {
        NSLog(@"Failed to compile vertex shader");
        return NO;
    }

    // Create and compile fragment shader.
    fragShaderPathname2 = [[NSBundle mainBundle] pathForResource:@"Shader2" ofType:@"fsh"];
    if (![self compileShader:&fragShader2 type:GL_FRAGMENT_SHADER file:fragShaderPathname2]) {
        NSLog(@"Failed to compile fragment shader");
        return NO;
    }

    // Attach vertex shader to program.
    glAttachShader(_program, vertShader);
    glAttachShader(_program2, vertShader2);

    // Attach fragment shader to program.
    glAttachShader(_program, fragShader);
    glAttachShader(_program2, fragShader2);

    // Bind attribute locations.
    // This needs to be done prior to linking.
    glBindAttribLocation(_program, ATTRIB_VERTEX, "position");
    glBindAttribLocation(_program2, ATTRIB_VERTEX, "position");

    // Link program.
    if (![self linkProgram:_program]) {
        NSLog(@"Failed to link program: %d", _program);

        if (vertShader) {
            glDeleteShader(vertShader);
            vertShader = 0;
        }
        if (fragShader) {
            glDeleteShader(fragShader);
            fragShader = 0;
        }
        if (_program) {
            glDeleteProgram(_program);
            _program = 0;
        }

        return NO;
    }
    if (![self linkProgram:_program2]) {
        NSLog(@"Failed to link program: %d", _program2);

        if (vertShader2) {
            glDeleteShader(vertShader2);
            vertShader2 = 0;
        }
        if (fragShader2) {
            glDeleteShader(fragShader2);
            fragShader2 = 0;
        }
        if (_program2) {
            glDeleteProgram(_program2);
            _program2 = 0;
        }

        return NO;
    }    

    // Get uniform locations.
    uniforms[UNIFORM_MODELVIEWPROJECTION_MATRIX] = glGetUniformLocation(_program, "modelViewProjectionMatrix");
    uniforms[UNIFORM_MODELVIEWPROJECTION_MATRIX2] = glGetUniformLocation(_program2, "modelViewProjectionMatrix2");

    // Release vertex and fragment shaders.
    if (vertShader) {
        glDetachShader(_program, vertShader);
        glDeleteShader(vertShader);
    }
    if (fragShader) {
        glDetachShader(_program, fragShader);
        glDeleteShader(fragShader);
    }

    if (vertShader2) {
        glDetachShader(_program2, vertShader2);
        glDeleteShader(vertShader2);
    }
    if (fragShader2) {
        glDetachShader(_program2, fragShader2);
        glDeleteShader(fragShader2);
    }    

    return YES;
} 
```

# r - 使用 ggplot2 使用预先汇总的数据创建条形图

> ID：10067452
> 
> 赞同：4
> 
> 时间：2012-04-08T23:38:57.713
> 
> 标签：r, ggplot2

*我在名为binFile*的文件中有以下数据

 *```
78 1
79 4
80 33
81 150
82 714
83 2663
84 8834
85 25679
86 63654
87 139731
88 265909
89 441686
90 639773
91 803736
92 879616
93 832181
94 682584
95 480228
96 290093
97 149299
98 65443
99 24487
100 7487
101 1835
102 402
103 59
104 10 
```

如何从该数据创建一个简单的**条形图**，其中第一列沿 x 轴，条形的高度应与第二列中的相应值成比例。

到目前为止，我已经尝试了以下方法：

```
binData <- read.table("binFile")
costBars = ggplot(binData,aes(x=V1,y=V2))
finalPlot2 = costBars + geom_bar()
finalPlot2 
```

但是这些命令会产生以下错误？

```
stat_bin: binwidth defaulted to range/30\. Use 'binwidth = x' to adjust this.
Error in pmin(y, 0) : object 'y' not found 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-08T23:58:12.587

你需要的是`stat="identity"`

例如，这一行

```
ggplot(data=binfile, aes(x=V1, y=V2)) + geom_bar(stat="identity") 
```

给了我这个情节

![在此处输入图像描述](../Images/a9bb715a73fba2929765226e7294ec85.png)

这就是你所追求的吗？*

# c# - Rabbitmq 消息未出现在 c# 的队列中

> ID：10067454
> 
> 赞同：3
> 
> 时间：2012-04-08T23:39:22.547
> 
> 标签：c#, .net, queue, rabbitmq

我正在成功执行下面的代码，没有任何错误，但是当我执行 list_queue 命令时，它没有给我任何队列。不知道问题出在哪里。

下面的代码根本没有给出错误。我的机器是 windows 7 64x，安装 AMPQ runtime 64bit 并使用 32x RabbitMq server v.2.8.1 。

```
private void createExchange(string message)
        {
            var queName = Convert.ToString(ConfigurationManager.AppSettings["clientQueue"]);
            var exchangeName = Convert.ToString(ConfigurationManager.AppSettings["clientExchange"]);
            var hostName = Convert.ToString(ConfigurationManager.AppSettings["host"]);

            _logger.Info("entered in create exchange");
            _logger.Info("queName: " + queName);
            _logger.Info("exchangeName: " + exchangeName);
            _logger.Info("hostName: " + hostName);
            try
            {
                var connectionFactory = new ConnectionFactory();
                connectionFactory.HostName = "localhost";
                connectionFactory.UserName = "user1";
                connectionFactory.Password = "userpassword";

                using (IConnection connection =
                    connectionFactory.CreateConnection())
                {
                    _logger.Info("Conncection created");
                    using (IModel model = connection.CreateModel())
                    {
                        _logger.Info("Model is created");
                        model.ExchangeDeclare(exchangeName, ExchangeType.Fanout, true);
                        model.QueueDeclare(queName, true, true, false, null);
                        model.QueueBind(queName, exchangeName, "", new Dictionary<string, object>());

                        IBasicProperties basicProperties = model.CreateBasicProperties();
                        model.BasicPublish(exchangeName, "", false, false,
                                           basicProperties, Encoding.UTF8.GetBytes(message));
                        _logger.Info("message: " + message);
                        _logger.Info("message published");

                    }
                }
            }
            catch(Exception ex)
            {
                _logger.Info("Error in create exchange");
                _logger.Info("InnerException:" + ex.InnerException);
                _logger.Info("Message:" + ex.Message);
                _logger.Info("StackTrace:" + ex.StackTrace);
            }
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T06:57:46.453

看起来好像您正在声明一个“独占”队列。独占队列对连接是独占的，因此不能从另一个连接操作（包括被列出）。

尝试

```
Model.QueueDeclare(queName, true, **false**, false, null) 
```

如果您希望能够列出它或对来自另一个连接的 if 执行任何其他操作。

# semantics - 查询以显示 DBpedia 的所有类和所有谓词

> ID：10067459
> 
> 赞同：4
> 
> 时间：2012-04-08T23:39:44.987
> 
> 标签：semantics, sparql, semantic-web, dbpedia

如何在 dbpedia.org/snorql 中使用 sparql 显示 DBpedia 的所有类和所有谓词

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T11:22:16.950

怎么样：

```
SELECT * { ?x a owl:Class } 
```

和：

```
SELECT * { ?x a rdf:Property } 
```

我不知道这些是否*都是*类/属性。

# .net - 从 .Net 应用程序引用测试和实时服务器上的 Web 服务

> ID：10067460
> 
> 赞同：1
> 
> 时间：2012-04-08T23:39:57.947
> 
> 标签：.net, visual-studio-2010, web-services

我有一个 .net Web 应用程序，它引用了 Web 服务。

我将 Web 服务发布到[http://myTestServer/service1.asmx](http://myTestServer/service1.asmx)，然后添加了对 .net 应用程序的引用。

Web 服务访问 myTestServer 上的测试数据库。

当我想将 Web 应用程序发布到 myLiveServer - 已经将访问“实时数据库”的 Web 服务版本发布到[http://myLiveServer/service1.asmx](http://myLiveServer/service1.asmx) - 我该如何更改它以便 Web 应用程序引用正确的 Web服务 - 取决于我是发布到测试服务器还是实时服务器？

对于连接字符串之类的东西，很容易更改键以引用正确的服务器/数据库。但是您如何为 Web 服务参考执行此操作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-08T23:43:45.480

您更改它的方式与连接字符串的方式相同——也就是说，在 web.config 中，或者如果您愿意，也可以通过编程方式进行更改。在 web.config 中，地址位于 system.serviceModel/client/endpoint 下。

```
<system.serviceModel>
    <client>
        <endpoint address="service URL" name="MyService" />
    ... 
```

以编程方式，您可以修改客户端代理类的 Endpoint.Address 属性。

```
var client = new ServiceReference.MyServiceSoapClient();
client.Endpoint.Address = new EndpointAddress("service URL"); 
```

# c++ - C++：构造函数的麻烦

> ID：10067462
> 
> 赞同：5
> 
> 时间：2012-04-08T23:40:20.703
> 
> 标签：c++, constructor

我正在尝试自学 C++，并且正在学习有关构造函数的基本练习。我有一个行为异常的程序：

分数.h：

```
#include <iostream>

#ifndef FRACTION_H
#define FRACTION_H

using namespace std;

class Fraction
{
private:
    int num;
    int denom;
    static int gcd(int a, int b);
    void reduce();
public:
    Fraction(int n=0, int d=1);
    Fraction(Fraction& f);
    ~Fraction();

    Fraction& operator=(const Fraction& f);

    friend Fraction operator+(const Fraction& f1, const Fraction& f2);

    friend ostream& operator<<(ostream& out, const Fraction& f);
};

#endif // FRACTION_H 
```

Fraction.cpp（省略了一些实现）：

```
#include "../include/Fraction.h"

#include <cassert>
#include <iostream>

using namespace std;

int Fraction::gcd(int a, int b) {
    // implementation omitted
}

void Fraction::reduce() {
    // implementation omitted
    // this just reduces fractions to lowest terms, like 3/6 to 1/2
}

Fraction::Fraction(int n, int d) {
    cout << "new fraction, n=" << n << ", d=" << d << endl;
    assert(d != 0);
    if (d < 0) {
        num = -n;
        denom = -d;
    } else {
        num = n;
        denom = d;
    }
    reduce();
}

Fraction::Fraction(Fraction& f) {
    cout << "copy fraction " << f << " at " << &f << endl;
    num = f.num;
    denom = f.denom;
}

Fraction::~Fraction() {
}

Fraction& Fraction::operator=(const Fraction& f) {
    cout << "assign fraction to " << f << " at " << &f << endl;
    if (this == &f)
        return *this;
    num = f.num;
    denom = f.denom;
    return *this;
}

Fraction operator+(const Fraction& f1, const Fraction& f2) {
    cout << "adding " << f1 << " and " << f2 << endl;
    return Fraction(f1.num * f2.denom + f2.num * f1.denom,
                    f1.denom * f2.denom);
}

ostream& operator<<(ostream& out, const Fraction& f) {
    out << f.num << "/" << f.denom;
    return out;
} 
```

主.cpp：

```
#include "include/Fraction.h"

#include <iostream>

using namespace std;

int main()
{
    Fraction f1(1, 3);
    Fraction f2(1, 2);
    cout << f1 << endl;
    cout << f2 << endl;
    cout << (f1 + f2) << endl;
    return 0;
} 
```

当我运行它时，前两个打印语句按预期输出`1/3`，`1/2`但第三个打印`0/1`而不是`5/6`. 从我拥有的调试语句中，我通过`Fraction(int, int)`构造函数创建了 5/6，但由于某种原因，它随后被 0/1 调用。当我删除复制构造函数时，代码会打印出来`5/6`。这里发生了什么，如何在不删除复制构造函数的情况下修复它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-08T23:48:30.907

您的复制构造函数的签名应该是

```
Fraction(const Fraction&); 
```

*不是*

```
Fraction(Fraction&); 
```

当你这样做`return Fraction(...);`时，编译器必须调用`Fraction(const Fraction&)`，因为返回的分数是临时的，但由于你没有定义它，你的编译器会发生一些奇怪的事情。您的编译器行为怪异，并允许您以某种方式使用默认构造函数，当它应该踢出错误时。在 gcc 上按原样编译代码不起作用，您必须进行我提到的修改，这应该可以解决它。

此外，您的编译器没有在该函数上使用 RVO 的事实暗示您使用的是非常旧和/或糟糕的编译器。

# java - 扫描仪与 InputStreamReader

> ID：10067465
> 
> 赞同：14
> 
> 时间：2012-04-08T23:40:32.257
> 
> 标签：java, file, input

有谁碰巧知道下面两种读取输入文件的方法在性能方面是否有任何区别？谢谢。

1) 使用 Scanner 和 File 读取文件

```
Scanner input = new Scanner(new File("foo.txt")); 
```

2) 使用 InputStreamReader 和 FileInputStream 读取文件

```
InputStreamReader input = new InputStreamReader(new FileInputStream("foo.txt")); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-09T00:53:14.967

第一点是这些代码示例**都没有**读取文件。这听起来可能很愚蠢或不正确，但这是真的。他们实际上做的是打开一个文件进行阅读。就他们实际所做的而言，他们各自的效率可能没有太大差异。

在实际读取文件时，使用的最佳方法将取决于文件包含的内容、内存中算法的数据必须采用何种形式等。这将决定使用它还是更好`Scanner`用raw `Reader`，从性能的角度来看，**更重要**的是从使您的代码可靠和可维护的角度来看。

最后，这可能不会对代码的整体性能产生重大影响。我的意思是你过早地优化了你的应用程序。您最好暂时忽略性能并选择使其余代码更简单的版本。当应用程序工作时，使用一些代表性的输入数据对其进行分析。分析将告诉您读取文件所花费的时间，绝对值，以及相对于应用程序其余部分的时间。这将告诉您尝试优化文件读取是否*值得。*

我要给出的唯一一点性能建议是从无缓冲的输入流或读取器中逐个字符地读取效率低下。如果需要以这种方式读取文件，则应将 BufferedReader 添加到堆栈中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-09T00:13:13.347

一个区别，我猜，主要是使用 BufferedReader/InputStreamReader，如果你愿意，你可以逐个字符地读取整个文档。使用扫描仪，这是不可能的。这意味着使用 InputStreamReader 您可以更好地控制文档的内容。;)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-09T00:28:35.417

就性能而言，Scanner 绝对是最慢的，至少从我的经验来看是这样。它是为解析而不是读取大量数据而设计的。InputStreamReader 具有足够大的缓冲区，可以与 BufferedReader 媲美，我记得它从字典列表中读取比 Scanner 快几倍。[这是 BufferedReader 和 InputStreamReader 之间的比较](http://recursor.blogspot.ca/2006/09/bufferedreader-vs-inputstream.html)。请记住，BufferedReader 比 Scanner 快几倍。

# c# - 使用操作将条件参数传递给方法

> ID：10067467
> 
> 赞同：1
> 
> 时间：2012-04-08T23:40:38.333
> 
> 标签：c#, delegates

我在 Silverlight 4.0 项目中使用 MVVM 模式。此项目正在从 WCF 服务获取数据。

以下是获取运输方式集合的示例：

**界面：**

```
void GetShippingMethods(Action<ObservableCollection<ShipVia>, Exception> completed); 
```

**服务代理：**

```
 public void GetShippingMethods(Action<ObservableCollection<ShipVia>, Exception> completed)
    {
      InvoiceServiceClient client = new InvoiceServiceClient();
      client.GetShippingMethodsCompleted += (s, ea) =>
      {
        if (ea.Error != null)
        {
          completed(null, ea.Error);
        }
        else
        {
          completed(ea.Result, null);
        }
      };

      client.GetShippingMethodsAsync();

      client.CloseAsync();

} 
```

ea.Result 将按服务获取运输方式的列表。

我的问题是当我想获取发票项目列表时，我需要传入一个 InvoiceID，因此返回的结果只会给我一个特定发票的发票项目集合。

有什么方法可以传入可以传递给我的 WCF 服务的输入参数吗？

更新：事实证明，这很简单：我需要做的就是添加一个条件参数

```
void GetShippingMethods(Action<ObservableCollection<ShipVia>, Exception> completed, int MethodID); 
```

# c - 同一个指针怎么可能有不同的类型？

> ID：10067471
> 
> 赞同：1
> 
> 时间：2012-04-08T23:41:02.473
> 
> 标签：c

`"str"`当您使用or`&"str"[0]`并`&"str"`获得相同的指针但类型不同时，您会明白我的意思。

注意：我在一个字符串文字没有区别的系统上。

```
printf("%p\n", "str");
printf("%p\n", &"str"[0]);
printf("%p\n", &"str");

// hypothetical output:
// 0xADD12E550  (ptr to char)
// 0xADD12E550  (ptr to char)
// 0xADD12E550  (ptr to arr of char) 
```

所以理论上，当我取消引用时`&"str"`，我应该能够获得字符串的第一个字符，因为我取消引用了同一个指针。奇怪的是，情况并非如此，我必须取消引用两次。一次获取数组，然后再次获取第一个字符常量：

```
// &"str" = 0xADD12E550
// *(0xADD12E550) = 0xADD12E550
// *(0xADD12E550) = 's'

// **(&"str") == 's' 
```

也许那么这个问题也可以回答这是怎么可能的：

```
#include <stdio.h>

void dafunk() {
  printf("dadftendirekt\n");
}

main() {
  void (*dafunkptr)() = dafunk;
  (***************dafunkptr)();

  return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-08T23:54:38.520

该对象`"str"`的类型为数组 4 `char`。

的值`"str"`是指向 的类型的指针`char`。

的值`&"str"[0]`是指向 的类型的指针`char`。

的值 `&"str"`是指向数组 4 的指针类型`char`。

**编辑**：

因此，现在要访问例如字符串的第一个字符，`"str"`您必须取消引用表达式一次：

```
char s = *"str";  // or s = "str"[0] 
```

或者从表达式中`&"str"`您必须取消引用表达式两次，因为它的类型是指向数组的指针：

```
char s = **&"str";   // or s = *(&"str")[0] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T01:09:27.347

表达式`"str"`的类型是`char[4]`。（在 C++ 中，它会是`const char[4]`.）

在大多数情况下，任何数组类型的表达式都会隐式转换为指向数组对象第一个元素的指针。这种转换通常被称为“衰减”。例外情况是：

*   当它是一元运算符的操作数时`sizeof`（`sizeof "str"`产生数组的大小，而不是指针的大小）。
*   当它是一元运算符的操作数时`&`（`&"str"`产生 type 的结果`char(*)[4]`， not `char*`）。
*   当它是用于初始化数组对象的初始化程序中的字符串文字时（此处不适用）。

在这三种情况下，数组表达式保持其数组类型。

字符串文字是指隐式创建的具有静态存储持续时间的数组对象，其大小足以容纳文字的字符加上终止的`'\0'`空字符。在这种情况下，`"str"`指的是类型为 的匿名静态对象`char[4]`。

所以：

```
printf("%p\n", "str"); 
```

`"str"`被隐式转换为一个`char*`值，指向`'s'`的`"str"`。

```
printf("%p\n", &"str"[0]); 
```

如上所述`"str"`， in`"str"[0]`衰减`char*`为 。 `"str"[0"`产生一个`char*`值，指向`'s'`. 所以`"str"`和`"str"[0]`具有相同的类型和价值。

```
printf("%p\n", &"str"); 
```

在这里，由于`"str"`是 的操作数`&`，因此不会发生衰减，因此`&"str"`产生匿名`char[4]`对象的地址，而不是其第一个字符的地址。这个表达式的类型是`char(*)[4]`，或“指向 4 个字符数组的指针”。

表达式`&"str"[0]`和`&"str"`两者都产生指针值，它们都指向内存中的同一位置，但它们的类型不同。

在所有三种情况下，计算表达式的结果都作为参数传递给`printf`. `printf`使用`"%p"`格式需要类型的参数`void*`。在前两种情况下，您传递了 a`char*`和语言的要求，`char*`并`void*`暗示它将按预期工作。`char*`在第三种情况下， vs.没有这样的规则`char(*)[4]`，所以

```
printf("%p\n", &"str"); 
```

未定义。

碰巧的是，在大多数实现中，所有指针类型都具有相同的大小和表示形式，因此您可以将任意类型的指针传递给`printf`with `"%p"`。

在所有三种情况下，您可以（并且可能应该）将表达式显式转换为`void*`，避免未定义的行为：

```
printf("%p\n", (void*)"str");
printf("%p\n", (void*)&"str"[0]);
printf("%p\n", (void*)&"str"); 
```

您问题的第二部分涉及一个不同的问题；它是关于指向函数的指针。指针类型表达式的规则与数组类型的规则类似：函数类型的表达式（例如函数名）被隐式转换为指向函数的指针，除非它是`sizeof`(这是非法的) 或`&`(这会产生函数的地址）。这就是为什么应用`*`or`&`到一个函数就像一个无操作一样。在`*func`中，`func`首先衰减为指向函数的指针，`*`解除对指针的引用，结果再次衰减为指向函数的指针。在`&func`中，`&`抑制了衰减，但它产生了指向函数`func`本身会产生的相同指针。

# r - 将不平衡数据扩展到每月面板

> ID：10067478
> 
> 赞同：1
> 
> 时间：2012-04-08T23:43:03.327
> 
> 标签：r

我有一个如下所示的数据集，我想将其扩展到每月面板数据集。

```
ID | start_date | end_date | event_type |
 1 |   01/01/97 | 08/01/98 |          1 |
 2 |   02/01/97 | 10/01/97 |          1 |
 3 |   01/01/96 | 12/01/04 |          2 | 
```

有些案件比其他案件持续时间更长。我已经想出了如何通过从每个日期中提取年份然后使用以下方法将数据扩展为年度配置：

```
year <- ddply(df, c("ID"), summarize, year = seq(startyear, endyear)) 
```

其次是：

```
month <- ddply(year, c("ID"), summarize, month = seq(1, 12)) 
```

这种方法的问题在于它没有为月份分配正确的数字，即一月 = 1，因此它不能很好地与我想最终将其合并的事件数据集一起使用，我会在`year`,`ID`和上匹配`month`。帮助将不胜感激。这是我要扩展的数据集（.xls）的直接链接：http: [//db.tt/KeLRCzr9](http://db.tt/KeLRCzr9)。希望我已经包含了足够的信息，但如果需要任何其他信息，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T00:10:41.570

你可以尝试更多这样的东西：

```
ddply(df,.(ID),transform,dt = seq.Date(as.Date(start_date,"%m/%d/%Y"),as.Date(end_date,"%m/%d/%Y"),by = "month")) 
```

可能会有很多与行名有关的警告，我不能保证这会起作用，因为您链接到的数据集与您提供的示例不匹配。对于初学者，我假设您清理了开始日期和结束日期，因为它们以各种格式出现在 .xls 文件中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T13:59:26.413

```
ddply(df, .(ID), summarize, dt = seq.Date(start_date, end_date, by = "month")) 
```

假设 start_date 和 end_date 已经是日期对象。不过，乔兰让我很亲近，所以再次感谢您的帮助。

# entity-framework - 实体框架代码优先：DbSets 和导航属性

> ID：10067479
> 
> 赞同：1
> 
> 时间：2012-04-08T23:43:04.920
> 
> 标签：entity-framework, ef-code-first, associations

对 EF 来说有点新，所以如果这个问题的答案很明显，请多多包涵。我正在做一个使用 EF 的教程，两个 DbSet 的定义如下：

```
 public DbSet<BrokerageAccount> BrokerageAccounts { get; set; }
    public DbSet<Customer> Customers { get; set; } 
```

客户类看起来像这样——它是一个 POCO（为简洁起见，一些代码被删减）：

```
public class Customer
{
    public Customer()
    {
        BrokerageAccounts = new HashSet<BrokerageAccount>();
    }

    // Primitive properties
    public int Id { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }

    // Navigation properties
    public ICollection<BrokerageAccount> BrokerageAccounts { get; set; }
} 
```

}

BrokerageAccount 类也是一个 POCO，在设计上与 Customer 非常相似。

到现在为止还挺好。我有疑问的代码如下。我没有遵循 Customer 和 BrokerageAccount 之间的主程序中的关联。代码如下所示：

```
 public Customer GetCustomer(string custId)
    {
        using (var context = DataContext)
        {
            return context.Customers
                .Include("BrokerageAccounts").SingleOrDefault(c => c.CustomerCode == custId);
        }
    } 
```

我不知道如何在客户和 BrokerageAccount 之间建立关联/加入。在我的 VS 2010 项目中，我没有看到任何配置或其他文件来说明两个 DbSet 关联的内容、要使用的外键列等。

也许我遗漏了一些明显的东西或某种映射文件，但仅仅因为客户有一个 BrokerageAccount 的 ICollection 以及上面写着“导航属性”的评论，并没有做到这一点。在 EF 中，这些关联是如何建立的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T01:31:23.090

设置导航属性的常规方法是使用模型构建器，这为您提供了一个流畅的 api 来设置关联，请查看此内容以了解有关如何进行此操作的一些深入内容。

[http://xhalent.wordpress.com/2011/01/21/configuring-entity-framework-4-codefirst/](http://xhalent.wordpress.com/2011/01/21/configuring-entity-framework-4-codefirst/)

如果您不手动设置导航属性，实体框架会猜测您的意思，在上述情况下，它可能会按预期设置您的导航属性，因为您在客户和 BrokerageAccount 之间只有一个 1-* 关系，这似乎是明智地命名。

还有一个属性方法可用于设置导航属性。

# winforms - 如何在 C++/CLI/Windows 窗体中以 25 FPS 的速度更新面板上的图形？

> ID：10067480
> 
> 赞同：0
> 
> 时间：2012-04-08T23:43:04.930
> 
> 标签：winforms, c++-cli

我的应用程序正在从外部硬件接收数据并将其绘制到面板上（实际上可以是“控制”的任何其他子项）。绘画当前发生在“OnPaint”回调中。列表用于存储最近收到的数据，以允许在 OnPaint 中重绘整个图形，以在调整窗口大小时获得正确的比例。

图形本身是`e->Graphics`使用两个数据点之间的线与元素一起绘制的。

这工作正常，但是当我每 50 毫秒收到新数据（= 重新绘制整个图表）时，图表很快开始闪烁。需要绘制的数据越多，闪烁越强（当到达控件的右侧时，数据缓存被清除，因此图中的最大数据点数是有限的）。

我的代码的主要部分：

```
void Paint(System::Object^ sender, System::Windows::Forms::PaintEventArgs^ e)
{
    Size^ s = m_Control->Size;
    Bitmap^ bmp = gcnew Bitmap(s->Width, s->Height);
    Graphics^ g = Graphics::FromImage(bmp);

    for each(double y in m_Data)
    {
        /* ...calculations etc... */
        g->DrawLine(Pens::Blue, recentX, recentY, currentX, currentY);
    }           

    e->Graphics->DrawImageUnscaled(bmp, 0, 0);
} 
```

有什么建议可以优化绘画以消除闪烁吗？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T00:01:34.510

独立于您的平台或语言，这是一种主要使用称为控制帧速率的方法解决的问题。

您将调用您的绘画方法，然后估计花费在绘画上的时间。现在您知道在一个步骤中花费了多少时间以及您的刷新间隔有多长 - 在您的情况下是 40 毫秒 -。您可以让线程休眠 (intervals - timespent) 毫秒。

顺便说一句，这是我的第一个答案，我知道我在解释东西方面很糟糕。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T00:15:48.840

闪烁来自 WinForms 在调用您的 Paint 处理程序之前擦除背景。

您需要编写自己的继承自 Panel 的自定义控件，并重写`OnPaintBackground`以不执行任何操作（尤其是不要调用基类版本）。

# knockout.js - 2路绑定不起作用

> ID：10067482
> 
> 赞同：0
> 
> 时间：2012-04-08T23:43:44.343
> 
> 标签：knockout.js

当我单击新博客主题的保存链接时，控制台输出是主题对象的空值。当我单击现有博客主题的保存链接时，输出是主题对象的旧值。

为什么单击保存链接时没有为属性分配值？

```
 var viewModel = function(topics){
        var self = this;
        self.topics = ko.observableArray(topics);
        self.editing_topic = ko.observable("");

        self.new_topic = function(){
            self.edit_topic({});
        }

        self.edit_topic = function(topic){
            self.editing_topic(topic);
            form.dialog({width:800, height:600, modal:true});

        };

        self.save_topic = function(){
            console.log(self.topic());
        };
    };
   ko.applyBindings(new viewModel(jsondata));

<fieldset class="blog_topic_form" title="New Blog Entry">
    <div>
        <label for="topic_title">
            Title:
        </label>
        <input type="text" id="topic_title" data-bind="value: topic().topic_title"/>
    </div>
    <div>
        <label for="message_contents">
            Message:
        </label>
        <textarea id="message_contents" class="message_contents" data-bind="value: topic().message_contents"/>
    </div>
    <footer>
        <a class="save_link" data-bind="click: save_topic"></a>
        <a class="cancel_link"></a>
    </footer>
</fieldset> 
```

编辑：这里是 jsfiddle：http: [//jsfiddle.net/jLkxG/3/](http://jsfiddle.net/jLkxG/3/)

当您运行它时，它将分配默认值。但是，如果您编辑文本框并单击保存链接，它将输出原始（初始）值，而不是在文本框中输入的值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T00:26:04.803

您提供的代码没有完全意义。

我假设您提供的字段集标记是对话框的内容？如果是这种情况，那么您的输入绑定到什么？

目前，文本框绑定到 viewModel 上的主题属性，但不存在这样的属性。您还期望此主题对象具有属性 topic_title 和 message_contents 但这些不在您的模型中。如果您现有的值绑定来创建属性，这不是它的工作方式。

我认为您需要向我们展示更多代码或提供小提琴。我冒昧地在 jsfiddle 中复制了您的代码。

[http://jsfiddle.net/madcapnmckay/jLkxG/](http://jsfiddle.net/madcapnmckay/jLkxG/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T02:07:09.317

请更新您的代码以匹配 jsfiddle 中的代码。

在 jsfiddle 中，您的 editing_topic 属性（topic_title 和 message_contents）应该被定义为可观察的，而不是 editing_topic 属性本身。

我已经更新了您的 jsfiddle 以使其正常工作：http: [//jsfiddle.net/jLkxG/4/](http://jsfiddle.net/jLkxG/4/)

# android - 如何从使用库项目的应用程序中删除广告

> ID：10067485
> 
> 赞同：1
> 
> 时间：2012-04-08T23:43:51.733
> 
> 标签：android

美好的一天，我有一个库项目，我用它来创建应用程序的付费和免费版本。现在我不编写任何代码或在不同的项目中进行任何活动，除了库项目（便于维护）。我已按照以下链接中的建议进行[操作](https://stackoverflow.com/questions/6517558/on-android-how-to-use-code-to-distinguish-free-app-vs-paid-app-using-the-same-l)

尝试在付费应用中安装无广告应用，但由于某种原因，广告不断出现。这可能意味着付费的某些功能也不起作用..我做错了什么？:(我是否必须手动将库项目中的活动复制到付费应用程序的项目中，并手动删除广告代码和其他代码？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T00:17:58.827

广告必须在您的库中的某处进行初始化——如果没有别的，创建广告视图并将其添加到主视图。如果您想要不同的行为，那么您可能希望以不同方式初始化库 - 比如说在初始化时将布尔值（或枚举）传递给库，库使用该布尔值（或枚举）来了解是否调用创建广告视图的代码行并添加它到主视图。然后您的付费应用程序可以在没有广告的情况下进行初始化，而您的免费应用程序可以使用广告进行初始化。

# objective-c - 如何在 iOS 中制作可点击的地图

> ID：10067487
> 
> 赞同：-2
> 
> 时间：2012-04-08T23:44:22.403
> 
> 标签：objective-c, ios, cocos2d-iphone

我已经使用 Flash 和 Actionscript 完成了这项工作，但有人知道我是如何开始在 iOS 中制作可点击地图的吗？

使用 cocos2d 是个好方法吗？

我想将一个可点击的国家地图制作成一个小游戏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T15:27:08.390

您知道您可以使用 Flash 5.5 创建 iOS 应用程序吗？

[http://www.adobe.com/devnet/logged_in/abansod_iphone.html](http://www.adobe.com/devnet/logged_in/abansod_iphone.html)

其他一些不错的资源：

[http://www.gotoandlearn.com/play.php?id=116](http://www.gotoandlearn.com/play.php?id=116)

只是一些思考的食物。

到目前为止，我已经做了一些简单的事情，比如没有问题的 Rss 阅读器。没做过大型游戏。

# flash - 在 TWebbrowser 和 EmbeddedWB 中与 WebAssign calcpad 通信

> ID：10067488
> 
> 赞同：1
> 
> 时间：2012-04-08T23:44:29.350
> 
> 标签：flash, delphi, browser, web, axshockwaveflash

所以我一直在用delphi 2009制作自己的浏览器来适应它，我遇到了一个问题。webassign.net 有这些问题，使用 calcpad 或 mathpad 或 physpad（都一样/ex [http://www.webassign.net/manual/student_guide/t_s_answering_calcpad.htm](http://www.webassign.net/manual/student_guide/t_s_answering_calcpad.htm)）来回答家庭作业问题。使用 TWebbrowser 时，我可以看到我输入答案的框，但我无法与之交互。我还收到类似“错误 in- [http://www.webassign.net/wastatic/wacachef033ab37c30201f73f142449d037028d/pads/js/pad.js](http://www.webassign.net/wastatic/wacachef033ab37c30201f73f142449d037028d/pads/js/pad.js)你想继续在这个页面上运行脚本吗？”之类的脚本错误。当我使用 EmbeddedWB 时，我没有收到脚本错误，但同样的问题仍然存在，我无法与需要输入答案的框进行交互。这是盒子的一个例子。

```
 <object width="110" height="40" type="application/x-shockwave-flash" id="calcpad_obj_RQ_1255772_0_0_1255827" name="calcpad_obj_RQ_1255772_0_0_1255827" data="/v4swf/calcpad/calcpad-1.11.swf"><param name="allowScriptAccess" value="always"><param name="wmode" value="opaque"><param name="flashvars" value="padid=RQ_1255772_0_0_1255827&amp;xml=%3C%3Fxml%20version%3D%221.0%22%3F%3E%3Cp%20v%3D%221.0%22%3E%3Cme%3E%3Cabs%3E%3Ca%3E%3C/a%3E%3C/abs%3E%3C/me%3E%3C/p%3E&amp;enabled=1&amp;showresp=1"></object> 
```

[http://www.webassign.net/v4swf/calcpad/calcpad-1.11.swf](http://www.webassign.net/v4swf/calcpad/calcpad-1.11.swf)

有一个很好的例子说明我有什么问题。在 delphi 浏览器中访问该站点，我可以输入内容，但是当我完成真正的任务时，情况会发生变化。

我真的不知道发生了什么，我不能使用这个盒子。

# java - Java：组合数组中的计数以获得百分比

> ID：10067489
> 
> 赞同：0
> 
> 时间：2012-04-08T23:45:07.380
> 
> 标签：java

我正在编写一个读取给定文件的频率计数器，它返回文件中每个字母的频率（百分比）。到目前为止，我的代码会读取文件并列出文件中出现的每个字母的计数。我无法弄清楚如何组合所有计数以生成百分比。以下是我的代码，如果我没有正确使用代码块，请原谅。还在学习所有这些东西。

```
import java.io.File;
import java.util.*;

public class FrequencyCounter
{

    public static void main(String[] args )
    {
        char[] capital = { 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J','K', 'L', 'M', 'N',
                'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'};

        char[] small =   { 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n',
                'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z' };

        Scanner scan;
        try 
        {
            scan = new Scanner(new File("c://Users//Mikel//Desktop//School Work//CIS407//Week1//mary.txt"));
        } 

        catch (Exception e) 
        {
            System.out.println("File not found");
            return;
        }

        int[] count = new int[26];

        while(scan.hasNextLine()) 
        {
            String line = scan.nextLine();
            System.out.println("Line read: " + line);
            char[] digit = line.toCharArray();

            for(int i = 0; i < digit.length; i++) 
            {
                for(int j = 0; j < 26; j++) 
                {
                    if(digit[i] == capital[j] || digit[i] == small[j]) 
                    {
                        count[j]++;
                        break;
                    }
                }
            }
        }

        for (int i = 0; i < 26; i++)
        {
            System.out.print("  " + capital[i]);
            System.out.println("          " + (count[i]));

        }

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T23:50:35.107

`ch - 'a'`通过观察返回小写字母索引的整数表达式，可以大大简化您的代码，`ch - 'A'`并对大写字母执行相同的操作。所以嵌套循环和大小写数组是不必要的。`Char.isUpperCase(ch)`你可以通过调用or来判断一个字符是大写还是小写`Char.isLowerCase(ch)`。

您可以通过将所有计数相加并以通常的方式计算百分比来获得百分比：

```
double pct = (count[i]*100.0) / total; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-08T23:48:09.643

有很多方法可以做到这一点。正如您所指出的，下一步是计算总数。这意味着遍历两个数组并将总数存储在一个单独的变量中。从那里您可以将每个计数除以总数得出一个百分比。

换句话说，您还需要两个循环才能完成任务。

您也可以考虑将代码分解为方法。每个循环说一个，这样它看起来更像：

```
countLetters();
calculateTotal();
printPercentages(); 
```

此外，您可以使代码更简单。您可以调用 Character.toLowerCase(digit[i]) 来获取小写字母，而不是从 0 循环到 25 并检查它是否相等[因此您只需处理一个]。然后你可以从你的字母中减去 - 'a' 来获得索引，而不需要使用 26 个字符的数组。

# python - python中的负函数

> ID：10067493
> 
> 赞同：1
> 
> 时间：2012-04-08T23:46:11.097
> 
> 标签：python, mathematical-optimization

我定义了一个函数来计算像 x^2 这样的函数的最小值。我想定义一个函数，通过乘以负数来计算类似函数的最小值，从而计算函数的最大值。

```
def myf(g):
        return -(g+1.3)**2+5
def maximize(f,low,high,tol):
        return minimize(-1*f,low,high,tol) 
```

有没有办法做到这一点？当我尝试我所拥有的时，我收到以下错误：

```
TypeError: unsupported operand type(s) for *: 'int' and 'function' 
```

最小化定义如下：

```
def minimize(f,low,high, tol):
    if low>high:
        c=low; a=high
        a=float(a); c=float(c);
    else:
        a=float(low); c=float(high);
    b=a+(c-a)*.618033
    fa=f(a); fc=f(c)
    fb=f(b);
    if fb>fa or fb>fc: return maximize(f,low,high,tol)
    while abs(a-c)>tol:
        d=a+(c-b);
        fd=f(d);
        if d<b:
            if fb<fd:
                a=d; fa=fd;
            else:
                c=b; b=d
                fc=fb; fb=fd
        else:           
            if fd<fb:
                a=b; fa=fb; 
                b=d; fb=fd
            else:
                c=d; fc=fd
    return (a+c)/2. 
```

寻找仅 python 代码的解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-08T23:50:13.313

您不能将函数与数字相乘。相反，构造一个使用旧函数并将*结果*（而不是函数本身）与数字相乘的新函数：

```
def maximize(f,low,high,tol):
    return minimize(lambda x: -f(x),low,high,tol) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T00:01:57.530

也许你应该使用`scipy.optimize`？

[http://docs.scipy.org/doc/scipy/reference/tutorial/optimize.html](http://docs.scipy.org/doc/scipy/reference/tutorial/optimize.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-08T23:50:04.983

有几种方法可以做到这一点。最直接的是将你的函数“包装”到另一个函数中。您可以使用 lambda: `new_f = lambda x: -f(x)`。如果您不熟悉 lambda，这是一个快捷方式

```
def new_f(x):
    return -f(x) 
```

# c - GTK+/GCC 在启动时崩溃

> ID：10067499
> 
> 赞同：4
> 
> 时间：2012-04-08T23:47:03.793
> 
> 标签：c, windows, gcc, gtk, mingw

我正在尝试学习如何在 C 中使用 GTK。

我正在使用 Eclipse CDT 进行开发。我从示例网站复制了以下代码：

```
#include <gtk/gtk.h>
#include <stdlib.h>

void displayUI()
{
GtkWidget* mainWindow = gtk_window_new(GTK_WINDOW_TOPLEVEL);

gtk_window_set_default_size(GTK_WINDOW(mainWindow), 400, 300);
gtk_window_set_title(GTK_WINDOW(mainWindow), "GTK Simple Example");
gtk_window_set_position(GTK_WINDOW(mainWindow), GTK_WIN_POS_CENTER_ALWAYS);

gtk_signal_connect(GTK_OBJECT(mainWindow), "destroy", G_CALLBACK(gtk_main_quit), NULL);

gtk_widget_show_all(mainWindow);
}

int main(int argc, char *argv[]) {

gboolean b = gtk_init_check(&argc, &argv);

if(b == 0) {
    puts("Failed to init");
    exit(0);
}

gtk_init(&argc, &argv);

displayUI();

gtk_main();

return EXIT_SUCCESS;
} 
```

每次我尝试运行这个程序（或其他任何涉及 GTK 的程序时，Windows 都会立即显示“InsertProgramNameHere.exe 已崩溃”消息。

我已经正确安装了 MinGW、MinSYS、PKG-CONFIG 和 MAKE。该程序编译得很好......它只是不会运行。

有任何想法吗？

**更新**

我找到了这个错误日志。似乎存在依赖问题。

```
Faulting application TestRun.exe, version 0.0.0.0, time stamp 0x4f839a6a, faulting

module libgtk-win32-2.0-0.dll, version 6.0.6002.18541, time stamp 0x4ec3e39f, exception 

code 0xc0000135, fault offset 0x0006f52f, process id 0x1674, application start time 

0x01cd16c174d3df90. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-13T01:58:41.487

> 异常代码 0xc0000135

那是 STATUS_DLL_NOT_FOUND。Gtk+ 有大量的依赖 DLL。开始的最佳选择可能是使用[一体式捆绑包](http://ftp.gnome.org/pub/gnome/binaries/win32/gtk+/2.24/gtk+-bundle_2.24.10-20120208_win32.zip)并将存档中 bin 目录的全部内容复制到程序的 EXE 目录中。粗鲁，但[文档](http://www.gtk.org/download/win32.php)对此毫无歉意：

> 许多开发人员文件相对无关紧要。如果您打算重新分发 GTK+ 运行时，您需要弄清楚哪些文件可以自己忽略

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T10:45:11.720

你确定你的 GTK 安装目录在你的 PATH 中吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T06:21:40.650

您需要在环境变量中添加（MinGW、MinSYS 和 gtk-dev）的 bin 文件夹的路径。

# php - 搜索结果链接到单个页面 PHP

> ID：10067500
> 
> 赞同：-2
> 
> 时间：2012-04-08T23:47:32.540
> 
> 标签：php, mysql, sqlite, search

我目前正在制作两个网站并且已经停止。

基本上我在网站上执行搜索，它返回所有结果，但说我想点击其中一个结果，它会将我带到该结果的网页，所以如果我点击 RESULT NUMBER 2001，URL 将结束是这样的：

www.mysite.com/?2001

或一些变体，无论它在 PHP 中是什么。

提前致谢; 将在早上接受答案！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T00:10:18.963

如果我正确理解您的问题，那么我相信您将能够构建这样的网址......

```
www.mysite.com/?url=2001 
```

不是...

```
www.mysite.com/?2001 
```

撇开这一点，您将能够通过使用...在您的代码中访问该数字（2001）。

```
$url = $_GET['url']; 
```

有了它，您可以通过执行以下操作轻松地将用户重定向到该页面（或任何页面 2001）...

```
if($url == 2001)
{
   header("location:http://new-website.com/");
} 
```

希望这就是您要寻找的东西，下次请更具体地说明您的问题。;)

# jquery - 是否可以使用 JQuery Mobile 在辅助 div 类中包含可折叠的内容？

> ID：10067501
> 
> 赞同：1
> 
> 时间：2012-04-08T23:47:53.280
> 
> 标签：jquery, html, jquery-mobile

我正在使用 Jquery Mobile 创建一个 iPad 应用程序，并想使用创建一个导航栏`<div class="content-secondary">`，并且在该导航栏中有可扩展的内容

就目前而言，我可以在辅助 div 中创建一个基于简单`<li>`的导航，但是当我尝试添加可扩展内容时，它不会按预期呈现 - 只是显示扩展的内容而没有任何标题或折叠它的方式。试图创建一个 JSFiddle 来说明（[Fiddle Link](http://jsfiddle.net/vinomarky/xfcdF/)），但似乎 JSFiddle 不支持辅助导航窗格，因为无论我扩展多少宽度，它都只是呈现为连续的页面内容..

如果您按照上面的 Fiddle 链接，您将看到附加到主要内容底部的导航栏。可折叠的内容渲染得很好。但是，如果您使用相同的代码构建一个 JQuery Mobile 网页，您就会发现问题。

下面的一些屏幕截图以突出显示；

屏幕窄时 - 导航栏跟随主体，折叠效果很好 ![屏幕窄时 - 导航栏跟随主体，折叠效果很好](../Images/5da239b4241ad9f8784f6f10829f85d3.png)

当屏幕变宽时，导航栏变为活动状态，但可折叠内容的行为类似于列表 ![当屏幕变宽时，导航栏变为活动状态，但可折叠内容的行为类似于列表](../Images/cc4772946c9bd8faa2eed2a65152b005.png)

有什么建议或想法吗？这是一个已知问题还是设计功能？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T02:05:19.973

Listview 的边距为 -15px。我建议您使用放置在 JQM 之后的自己的样式表覆盖此 css 并使用此代码段：

```
.ui-content .ui-listview{margin:-15px -15px 0 -15px;}​ 
```

或使用插入列表，因为它不使用 -15px 边距，如下所示：

```
<ul data-role="listview" data-theme="c" data-dividertheme="d" data-inset="true">
    <li><a href="#Link1">Link1</a></li>
    <li><a href="#Link2">Link2</a></li>
    <li><a href="#Link3">Link3</a></li>
</ul> 
```

我希望这会有所帮助。让我知道是否有任何方法可以为您改进此答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T11:50:14.787

我假设您已经使用演示文档中的 CSS 创建了主要的辅助视图，因此有一个文件定义了两个内容块的行为（jquery.mobile-1.1.0.css 中没有“content-secondary” ）。您会在这样的媒体查询中找到一些内容：

```
/* fix up the collapsibles - expanded on desktop */
.content-secondary .ui-collapsible-heading {
    display: none;
}
.content-secondary .ui-collapsible-contain {
    margin:0;
}
.content-secondary .ui-collapsible-content {
    display: block;
    margin: 0;
    padding: 0;
} 
```

此部分隐藏标题（防止您折叠它），并展开可折叠的内容。

通过在媒体片段之前包含此部分，您可以覆盖正常的“折叠”行为并强制它始终打开。同样，通过从媒体段中删除它，您可以强制它在所有宽度/方向上再次折叠。

但是，您需要启用“标题”才能看到它们（因为默认情况下它是隐藏的，如果它的子项是隐藏的，则无法单击任何内容来显示它。您可以通过删除段来执行此操作;

```
.content-secondary .ui-collapsible-heading {
    display: none;
} 
```

来自所有随后的媒体询问

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-29T09:23:03.613

非常感谢 AssidiousBlue。有同样的问题，并通过注释掉整个部分来解决它：

```
.content-secondary .ui-collapsible-heading {
    display: none;
}
.content-secondary .ui-collapsible-contain {
    margin:0;
}
.content-secondary .ui-collapsible-content {
    display: block;
    margin: 0;
    padding: 0; 
} 
```

干杯，亚历克斯

# objective-c - 如何推送表格视图并能够将数据从 segue 中放入单元格中？

> ID：10067502
> 
> 赞同：0
> 
> 时间：2012-04-08T23:47:56.240
> 
> 标签：objective-c, uitableview, segue

我有一个第一个表视图和一个推送到另一个表视图的 segue。当用户从第一个表视图中触摸一个单元格时，我已经能够推送第二个表视图，但我不能在第二个表视图中显示数据。我的第二个表格视图使用的是继承自 UITableViewController 的自定义控制器。我使用方法“cellForRowAtIndexPath:(NSIndexPath *)indexPath”将文本放入我的单元格中，但代码永远不会到达该方法。我不明白问题是什么。

这是我的自定义类：

```
 #import "TableViewControllerTop.h"

    @interface TableViewControllerTop ()

    @end

    @implementation TableViewControllerTop
    @synthesize tableView;
    @synthesize cells;

    - (id)initWithStyle:(UITableViewStyle)style
    {
        self = [super initWithStyle:style];
        if (self) {
            // Custom initialization
        }
        return self;
    }

    - (void)viewDidLoad
    {
        [super viewDidLoad];

        // Uncomment the following line to preserve selection between presentations.
        // self.clearsSelectionOnViewWillAppear = NO;

        // Uncomment the following line to display an Edit button in the navigation bar for this view controller.
        self.navigationItem.rightBarButtonItem = self.editButtonItem;
    }

    - (void)viewDidUnload
    {
        [self setTableView:nil];
        [self setCells:nil];
        [super viewDidUnload];
        // Release any retained subviews of the main view.
        // e.g. self.myOutlet = nil;
    }

    - (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
    {
        return (interfaceOrientation == UIInterfaceOrientationPortrait);
    }

    #pragma mark - Table view data source

    - (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
    {
    #warning Potentially incomplete method implementation.
        // Return the number of sections.
        return 0;
    }

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
#warning Incomplete method implementation.
    // Return the number of rows in the section.
    return 6;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Top 50 list";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:CellIdentifier];
    }

    // Configure the cell...

    cell.textLabel.text = @"Test";

    return cell;
}

#pragma mark - Table view delegate

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    NSLog(@"selected");
}

@end 
```

谢谢你的帮助。如有必要，我可以发布更多代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T00:47:39.040

看起来您的代码返回的部分数量为 0。因此，它认为没有什么可显示的。

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
#warning Potentially incomplete method implementation.
    // Return the number of sections.
    return 0;
} 
```

# java - 如何更改 File.createTempFile 中的临时目录？

> ID：10067504
> 
> 赞同：2
> 
> 时间：2012-04-08T23:48:09.923
> 
> 标签：java

我基本上只是在做一些测试，以找出将大量数据写入文件的好方法。我找到了这个很好的答案[在文本文件 Java 中写入大量数据的最快方法，](https://stackoverflow.com/questions/1062113/fastest-way-to-write-huge-data-in-text-file-java)我正在使用脚本，但它似乎正在写入 /tmp 而不是我实际运行程序的目录。

这通常不会打扰我，但我使用的是 EC2，并且我读到引导存储不如临时存储快，但因为它写入引导驱动器我无法测试临时存储是否确实更快。

关于如何更改文件的临时目录的任何建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-08T23:51:34.023

查看 java.io.File 的这个方法的 Javadocs：

```
public static File createTempFile(String prefix,
                                  String suffix,
                                  File directory)
                           throws IOException 
```

# php - 如何插入选定的单选按钮？

> ID：10067505
> 
> 赞同：0
> 
> 时间：2012-04-08T23:48:15.137
> 
> 标签：php, javascript, jquery

我在[这里](http://jsfiddle.net/fPtMq/40/)有一个 jsfiddle 。发生的情况是，如果您选择一个单选按钮并单击“添加问题”，它将添加一个表格行，显示您选择的单选按钮。您可以更改行内的选择。

现在我想要做的是我想通过使用 INSERT VALUES 方法在数据库中的每个单选按钮中插入选定的单选按钮。

所以我想知道的是我怎样才能正确地做到这一点，以便 $_POST 为每一行选择的单选按钮，然后能够使用 INSERT VALUES 插入它们？

下面是我目前拥有的php代码：（'questionText'是'Question'列，即使我没有在jsfiddle中包含'questionText'并且'gridValues'不在jsfiddle中但是它实际上选择了每一行这是针对“选项”列中每一行中的每个文本框值，所以想象一下表格中还有另外两列，即“问题”和“选项”列）

```
$i = 0;
$c = count($_POST['gridValues']);

$insertquestion = array();

for($i = 0;  $i < $c; $i++ ){

    switch ($_POST['gridValues'][$i]){

    case "3": 
    $selected_option = "A-C";
    break;

    case "4": 
    $selected_option = "A-D";
    break;

    default:
    $selected_option = "";
    break;

    }     

    foreach($_POST['reply'] as $reply) {

     switch ($_POST['reply']){

    case "Single": 
    $selected_reply = "Single";
    break;

    case "Multiple": 
    $selected_reply = "Multiple";
    break;

    default:
    $selected_reply = "";
    break;    
}
} 

    $optionquery = "SELECT OptionId FROM Option_Table WHERE (OptionType = '". mysql_real_escape_string($selected_option)."')";
    $optionrs = mysql_query($optionquery);
    $optionrecord = mysql_fetch_array($optionrs);
    $optionid = $optionrecord['OptionId'];  

    $replyquery = "SELECT ReplyId FROM Reply WHERE (ReplyType = '". mysql_real_escape_string($selected_reply)."')";
    $replyrs = mysql_query($replyquery);
    $replyrecord = mysql_fetch_array($replyrs);
    $replyid = $replyrecord['ReplyId'];   

    $insertquestion[] = "'".  
                    mysql_real_escape_string( $_POST['questionText'][$i] ) ."','".  
                    mysql_real_escape_string( $optionid ) ."','".  
                    mysql_real_escape_string( $replyid ) ."'";

}

 $questionsql = "INSERT INTO Question (QuestionContent OptionId, ReplyId) 
    VALUES (" . implode('), (', $insertquestion) . ")";

echo($questionsql); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T01:33:27.600

我在您的 jsfiddle 中注意到，每个新创建的单选框都会像回复 1 和回复 2 一样创建。

但是在您的 php 代码中，看起来您正在循环，就好像它是一个数组一样。

如果你对你的帖子值进行 print_r ，你会得到类似的东西

```
Array ( [reply1] => Single [reply2] => Multiple ) 
```

所以它们不是数组格式。如果您在 POST 请求中拥有的唯一值是单选按钮，那么您可以循环遍历 POST 数组值。

无论如何，这是一个可能的解决方案，供您遍历您的帖子请求。我只是基于您在 jsfiddle 中的示例。您可能必须适应您的实际代码。但他们的关键是要注意单选按钮的名称命名为`reply[0]`和`reply[1]`。PHP 知道将名为 like 的值放入数组中。

```
<?php

//This is what your values will look like. Notice that they are in array format now
print_r($_POST);

foreach($_POST['reply'] as $reply) {
    //Now you can loop through your replies correctly.
}

?>

<!-- Quick Example of how to name the radio buttons -->
<html>
<head></head>
<body>
<form method="post">
Row 1<br />
<input type="radio" value="Single" name="reply[0]" /> Single 
<input type="radio" value="Multiple" name="reply[0]" /> Multiple

<br />Row 2<br />
<input type="radio" value="Single" name="reply[1]" /> Single 
<input type="radio" value="Multiple" name="reply[1]" /> Multiple
<br />
<input type="submit" value="Submit" />
</form>
</body> 
```

* * *

这是您为仅回复而重写的上述代码。因为我不确定数据是如何格式化的或者数据实际上是什么，所以我把其他的东西都放在了外面。我想知道为什么您不只是将 id 用于单选框值而不是文本。这样您就不必一直查询数据库。您可以只查询所有回复类型，然后像这样匹配 id。

```
<?php

$insertquestion = array();

foreach($_POST['reply'] as $reply) {

    switch ($reply){

    case "Single": 
    $selected_reply = "Single";
    break;

    case "Multiple": 
    $selected_reply = "Multiple";
    break;

    default:
    $selected_reply = "";
    break;

    $replyquery = "SELECT ReplyId FROM Reply WHERE (ReplyType = '". mysql_real_escape_string($selected_reply)."')";
    $replyrs = mysql_query($replyquery);
    $replyrecord = mysql_fetch_array($replyrs);
    $insertquestion[] = $replyrecord['ReplyId'];       
}

$questionsql = "INSERT INTO Question (ReplyId) 
    VALUES (" . implode('), (', $insertquestion) . ")";

echo($questionsql); 
```

* * *

除了使用 for 循环之外，这基本上是相同的。我猜你不熟悉 foreach 循环。但在这种情况下，for 循环也可以为您提供更好的服务。

```
<?php

$insertquestion = array();

for($i = 0; $i < count($_POST['reply']), $i++) {

    switch ($_POST['reply'][$i]){

    case "Single": 
    $selected_reply = "Single";
    break;

    case "Multiple": 
    $selected_reply = "Multiple";
    break;

    default:
    $selected_reply = "";
    break;

    $replyquery = "SELECT ReplyId FROM Reply WHERE (ReplyType = '". mysql_real_escape_string($selected_reply)."')";
    $replyrs = mysql_query($replyquery);
    $replyrecord = mysql_fetch_array($replyrs);
    $insertquestion[] = $replyrecord['ReplyId'];       
}

$questionsql = "INSERT INTO Question (ReplyId) 
    VALUES (" . implode('), (', $insertquestion) . ")";

echo($questionsql); 
```

# c - C 编程中的定点算术

> ID：10067510
> 
> 赞同：35
> 
> 时间：2012-04-08T23:48:44.210
> 
> 标签：c, fixed-point

我正在尝试创建一个以高精度存储股票价格的应用程序。目前我正在使用双重这样做。为了节省内存，我可以使用任何其他数据类型吗？我知道这与定点算术有关，但我无法弄清楚。

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2012-08-05T13:54:02.083

定点算术背后的想法是，您存储乘以一定数量的值，将乘积的值用于所有微积分，并在需要结果时将其除以相同的数量。这种技术的目的是在能够表示分数的同时使用整数算术（int、long ...）。

在 C 中执行此操作的常用且最有效的方法是使用位移运算符（<< 和 >>）。移位对于 ALU 来说是一种非常简单和快速的操作，并且这样做具有在每次移位时将整数值乘以 (<<) 和除以 (>>) 2 的属性（此外，可以对完全相同的值进行多次移位）单价）。当然，缺点是乘数必须是 2 的幂（这本身通常不是问题，因为我们并不真正关心确切的乘数值）。

现在假设我们想使用 32 位整数来存储我们的值。我们必须选择 2 的乘数。让我们把蛋糕一分为二，比如 65536（这是最常见的情况，但您可以根据您的精度需求真正使用 2 的任何幂）。这是 2 ^(16)，这里的 16 意味着我们将使用 16 个最低有效位 (LSB) 作为小数部分。其余 (32 - 16 = 16) 用于最高有效位 (MSB)，即整数部分。

```
 integer (MSB)    fraction (LSB)
           v                 v
    0000000000000000.0000000000000000 
```

让我们把它放在代码中：

```
#define SHIFT_AMOUNT 16 // 2^16 = 65536
#define SHIFT_MASK ((1 << SHIFT_AMOUNT) - 1) // 65535 (all LSB set, all MSB clear)

int price = 500 << SHIFT_AMOUNT; 
```

这是您必须存储的值（结构、数据库等）。请注意， int 在 C 中不一定是 32 位，即使现在大多数情况下也是如此。同样无需进一步声明，默认情况下已签名。您可以将 unsigned 添加到声明中以确保。比这更好的是，如果您的代码高度依赖于整数位大小（您可能会引入一些关于它的技巧），您可以使用 uint32_t 或 uint_least32_t（在 stdint.h 中声明）。有疑问，为您的定点类型使用 typedef 会更安全。

当您想对该值进行微积分时，可以使用 4 个基本运算符：+、-、* 和 /。您必须记住，在添加和减去一个值（+ 和 -）时，该值也必须移动。假设我们想在 500 的价格上加 10：

```
price += 10 << SHIFT_AMOUNT; 
```

但是对于乘法和除法（* 和 /），乘数/除数不得移动。假设我们要乘以 3：

```
price *= 3; 
```

现在让我们通过将价格除以 4 来让事情变得更有趣，这样我们就可以弥补一个非零的小数部分：

```
price /= 4; // now our price is ((500 + 10) * 3) / 4 = 382.5 
```

这就是规则。当您想在任何时候检索实际价格时，您必须右移：

```
printf("price integer is %d\n", price >> SHIFT_AMOUNT); 
```

如果您需要小数部分，则必须将其屏蔽：

```
printf ("price fraction is %d\n", price & SHIFT_MASK); 
```

当然，这个值并不是我们所说的小数，实际上是[0-65535]范围内的整数。但它与小数范围 [0 - 0.9999...] 完全对应。换句话说，映射看起来像：0 => 0, 32768 => 0.5, 65535 => 0.9999...

将其视为小数的一种简单方法是此时使用 C 内置的浮点运算：

```
printf("price fraction in decimal is %f\n", ((double)(price & SHIFT_MASK) / (1 << SHIFT_AMOUNT))); 
```

但是，如果您没有 FPU 支持（硬件或软件），您可以像这样以完整的价格使用您的新技能：

```
printf("price is roughly %d.%lld\n", price >> SHIFT_AMOUNT, (long long)(price & SHIFT_MASK) * 100000 / (1 << SHIFT_AMOUNT)); 
```

表达式中 0 的数量大致是您想要的小数点后的位数。给定分数精度，不要高估 0 的数量（这里没有真正的陷阱，这很明显）。不要使用简单的 long，因为 sizeof(long) 可以等于 sizeof(int)。如果 int 为 32 位，则使用*long long ，只要保证**long long*最小为 64 位（或使用 int64_t、int_least64_t 等，在 stdint.h 中声明）。换句话说，使用两倍于定点类型大小的类型，这很公平。最后，如果您无法访问 >= 64 位类型，也许是时候练习模拟它们了，至少对于您的输出而言。

这些是定点算术背后的基本思想。

小心使用负值。有时它会变得很棘手，尤其是在显示最终值的时候。此外，C 是关于有符号整数的实现定义的（即使现在存在这个问题的平台非常少见）。您应该始终在您的环境中进行最少的测试，以确保一切按预期进行。如果没有，如果你知道你在做什么，你可以绕过它（我不会对此进行开发，但这与算术移位与逻辑移位和 2 的补码表示有关）。但是，对于无符号整数，无论​​您做什么都是安全的，因为无论如何行为都是明确定义的。

另请注意，如果 32 位整数不能表示大于 2 ^(32 - 1 的值，则使用 2) ^(16)的定点算术将您的范围限制为 2 ^(16) - 1！（并用有符号整数将所有这些除以 2，在我们的示例中，可用范围为 2 ^(15) - 1）。然后目标是选择适合情况的 SHIFT_AMOUNT。这是整数部分幅度和小数部分精度之间的折衷。

现在是真正的警告：这种技术绝对不适合精度是重中之重的领域（金融、科学、军事......）。通常的浮点 (float/double) 通常也不够精确，尽管它们总体上比定点具有更好的属性。无论值是多少，定点都具有相同的精度（在某些情况下这可能是一个优势），其中浮点精度与值大小成反比（即，大小越低，您获得的精度越高……嗯，这比这更复杂，但你明白了）。浮点数也比等效的（位数）整数（定点或非定点）具有更大的幅度，以损失高值的精度为代价（您甚至可以达到加 1 或什至的幅度点更大的值根本没有影响，

如果您在这些敏感领域工作，最好使用专用于任意精度的库（去看看[gmplib](http://gmplib.org/)，它是免费的）。从本质上讲，在计算科学中，获得精度与您用于存储值的位数有关。你想要高精度？使用位。就这样。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-15T19:30:35.607

我看到你有两个选择。如果您在金融服务行业工作，您的代码可能应该遵守一些标准以确保精确度和准确性，因此您只需要遵守这些标准，而不管内存成本如何。我知道该业务通常资金充足，因此支付更多内存应该不是问题。:)

如果这是供个人使用，那么为了获得最大精度，我建议您在存储之前使用整数并将所有价格乘以一个固定因子。例如，如果您想要精确到一分钱（可能不够好），请将所有价格乘以 100，这样您的单位实际上是美分而不是美元，然后从那里开始。如果您想要更高的精度，请乘以更多。例如，要精确到百分之一（我听说的标准很常用），请将价格乘以 10000（100 * 100）。

现在使用 32 位整数，乘以 10000 几乎没有空间容纳大量美元。20 亿的实际 32 位限制意味着只能表示高达 20000 美元的价格：2000000000 / 10000 = 20000。如果将 20000 乘以某个值，情况会变得更糟，因为可能没有空间容纳结果。出于这个原因，我建议使用 64 位整数 ( `long long`)。即使您将所有价格乘以 10000，仍然有足够的空间来容纳较大的值，即使是在乘法中也是如此。

定点的诀窍在于，无论何时进行计算，您都需要记住每个值实际上是一个基础值乘以一个常数。在添加或减去之前，您需要将具有较小常数的值相乘以匹配具有较大常数的值。乘法后，您需要除以某个值才能将结果乘以所需的常数。如果您使用 2 的非幂作为常数，则必须进行整数除法，这在时间上很昂贵。许多人使用 2 的幂作为常数，因此他们可以移动而不是除法。

如果这一切看起来很复杂，那就是。我认为最简单的选择是使用双打并在需要时购买更多 RAM。它们有 53 位精度，大约是 9 万亿，或几乎 16 个十进制数字。是的，当你与数十亿人一起工作时，你仍然可能会损失几分钱，但如果你关心这一点，那么你就不是以正确的方式成为亿万富翁了。:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-12-26T20:26:56.123

@Alex 在[这里](https://stackoverflow.com/a/11816993/4561887)给出了一个绝妙的答案。但是，我想对他所做的事情进行一些改进，例如，通过演示如何进行仿真浮点（使用整数像浮点数一样）四舍五入到任何所需的小数位。我在下面的代码中证明了这一点。不过，我走得更远，最后写了一个完整的代码教程来教自己定点数学。这里是：

**我的 fixed_point_math 教程：类似于教程的练习代码，用于学习如何进行定点数学、仅使用整数的手动“浮点”式打印、“浮点”式整数舍入以及大整数的小数定点数学。**

如果你真的想学习定点数学，我认为这是值得仔细阅读的有价值的代码，但是我花了整个周末来编写，所以预计它可能会花费你几个小时来彻底完成所有内容。*然而，四舍五入的基础知识可以在顶部找到，并且只需几分钟即可学会。*

我在 GitHub 上的完整代码：[https](https://github.com/ElectricRCAircraftGuy/fixed_point_math) ://github.com/ElectricRCAircraftGuy/fixed_point_math 。

或者，下面（截断，因为堆栈溢出不允许那么多字符）：

```
/*
fixed_point_math tutorial
- A tutorial-like practice code to learn how to do fixed-point math, manual "float"-like prints using integers only,
  "float"-like integer rounding, and fractional fixed-point math on large integers. 

By Gabriel Staples
www.ElectricRCAircraftGuy.com
- email available via the Contact Me link at the top of my website.
Started: 22 Dec. 2018 
Updated: 25 Dec. 2018 

References:
- https://stackoverflow.com/questions/10067510/fixed-point-arithmetic-in-c-programming

Commands to Compile & Run:
As a C program (the file must NOT have a C++ file extension or it will be automatically compiled as C++, so we will
make a copy of it and change the file extension to .c first):
See here: https://stackoverflow.com/a/3206195/4561887\. 
    cp fixed_point_math.cpp fixed_point_math_copy.c && gcc -Wall -std=c99 -o ./bin/fixed_point_math_c fixed_point_math_copy.c && ./bin/fixed_point_math_c
As a C++ program:
    g++ -Wall -o ./bin/fixed_point_math_cpp fixed_point_math.cpp && ./bin/fixed_point_math_cpp

*/

#include <stdbool.h>
#include <stdio.h>
#include <stdint.h>

// Define our fixed point type.
typedef uint32_t fixed_point_t;

#define BITS_PER_BYTE 8

#define FRACTION_BITS 16 // 1 << 16 = 2^16 = 65536
#define FRACTION_DIVISOR (1 << FRACTION_BITS)
#define FRACTION_MASK (FRACTION_DIVISOR - 1) // 65535 (all LSB set, all MSB clear)

// // Conversions [NEVERMIND, LET'S DO THIS MANUALLY INSTEAD OF USING THESE MACROS TO HELP ENGRAIN IT IN US BETTER]:
// #define INT_2_FIXED_PT_NUM(num)     (num << FRACTION_BITS)      // Regular integer number to fixed point number
// #define FIXED_PT_NUM_2_INT(fp_num)  (fp_num >> FRACTION_BITS)   // Fixed point number back to regular integer number

// Private function prototypes:
static void print_if_error_introduced(uint8_t num_digits_after_decimal);

int main(int argc, char * argv[])
{
    printf("Begin.\n");

    // We know how many bits we will use for the fraction, but how many bits are remaining for the whole number, 
    // and what's the whole number's max range? Let's calculate it.
    const uint8_t WHOLE_NUM_BITS = sizeof(fixed_point_t)*BITS_PER_BYTE - FRACTION_BITS;
    const fixed_point_t MAX_WHOLE_NUM = (1 << WHOLE_NUM_BITS) - 1;
    printf("fraction bits = %u.\n", FRACTION_BITS);
    printf("whole number bits = %u.\n", WHOLE_NUM_BITS);
    printf("max whole number = %u.\n\n", MAX_WHOLE_NUM);

    // Create a variable called `price`, and let's do some fixed point math on it.
    const fixed_point_t PRICE_ORIGINAL = 503;
    fixed_point_t price = PRICE_ORIGINAL << FRACTION_BITS;
    price += 10 << FRACTION_BITS;
    price *= 3;
    price /= 7; // now our price is ((503 + 10)*3/7) = 219.857142857.

    printf("price as a true double is %3.9f.\n", ((double)PRICE_ORIGINAL + 10)*3/7);
    printf("price as integer is %u.\n", price >> FRACTION_BITS);
    printf("price fractional part is %u (of %u).\n", price & FRACTION_MASK, FRACTION_DIVISOR);
    printf("price fractional part as decimal is %f (%u/%u).\n", (double)(price & FRACTION_MASK) / FRACTION_DIVISOR,
           price & FRACTION_MASK, FRACTION_DIVISOR);

    // Now, if you don't have float support (neither in hardware via a Floating Point Unit [FPU], nor in software
    // via built-in floating point math libraries as part of your processor's C implementation), then you may have
    // to manually print the whole number and fractional number parts separately as follows. Look for the patterns.
    // Be sure to make note of the following 2 points:
    // - 1) the digits after the decimal are determined by the multiplier: 
    //     0 digits: * 10^0 ==> * 1         <== 0 zeros
    //     1 digit : * 10^1 ==> * 10        <== 1 zero
    //     2 digits: * 10^2 ==> * 100       <== 2 zeros
    //     3 digits: * 10^3 ==> * 1000      <== 3 zeros
    //     4 digits: * 10^4 ==> * 10000     <== 4 zeros
    //     5 digits: * 10^5 ==> * 100000    <== 5 zeros
    // - 2) Be sure to use the proper printf format statement to enforce the proper number of leading zeros in front of
    //   the fractional part of the number. ie: refer to the "%01", "%02", "%03", etc. below.
    // Manual "floats":
    // 0 digits after the decimal
    printf("price (manual float, 0 digits after decimal) is %u.", 
           price >> FRACTION_BITS); print_if_error_introduced(0);
    // 1 digit after the decimal
    printf("price (manual float, 1 digit  after decimal) is %u.%01lu.", 
           price >> FRACTION_BITS, (uint64_t)(price & FRACTION_MASK) * 10 / FRACTION_DIVISOR); 
    print_if_error_introduced(1);
    // 2 digits after decimal
    printf("price (manual float, 2 digits after decimal) is %u.%02lu.", 
           price >> FRACTION_BITS, (uint64_t)(price & FRACTION_MASK) * 100 / FRACTION_DIVISOR); 
    print_if_error_introduced(2);
    // 3 digits after decimal
    printf("price (manual float, 3 digits after decimal) is %u.%03lu.", 
           price >> FRACTION_BITS, (uint64_t)(price & FRACTION_MASK) * 1000 / FRACTION_DIVISOR); 
    print_if_error_introduced(3);
    // 4 digits after decimal
    printf("price (manual float, 4 digits after decimal) is %u.%04lu.", 
           price >> FRACTION_BITS, (uint64_t)(price & FRACTION_MASK) * 10000 / FRACTION_DIVISOR); 
    print_if_error_introduced(4);
    // 5 digits after decimal
    printf("price (manual float, 5 digits after decimal) is %u.%05lu.", 
           price >> FRACTION_BITS, (uint64_t)(price & FRACTION_MASK) * 100000 / FRACTION_DIVISOR); 
    print_if_error_introduced(5);
    // 6 digits after decimal
    printf("price (manual float, 6 digits after decimal) is %u.%06lu.", 
           price >> FRACTION_BITS, (uint64_t)(price & FRACTION_MASK) * 1000000 / FRACTION_DIVISOR); 
    print_if_error_introduced(6);
    printf("\n");

    // Manual "floats" ***with rounding now***:
    // - To do rounding with integers, the concept is best understood by examples: 
    // BASE 10 CONCEPT:
    // 1\. To round to the nearest whole number: 
    //    Add 1/2 to the number, then let it be truncated since it is an integer. 
    //    Examples:
    //      1.5 + 1/2 = 1.5 + 0.5 = 2.0\. Truncate it to 2\. Good!
    //      1.99 + 0.5 = 2.49\. Truncate it to 2\. Good!
    //      1.49 + 0.5 = 1.99\. Truncate it to 1\. Good!
    // 2\. To round to the nearest tenth place:
    //    Multiply by 10 (this is equivalent to doing a single base-10 left-shift), then add 1/2, then let 
    //    it be truncated since it is an integer, then divide by 10 (this is a base-10 right-shift).
    //    Example:
    //      1.57 x 10 + 1/2 = 15.7 + 0.5 = 16.2\. Truncate to 16\. Divide by 10 --> 1.6\. Good.
    // 3\. To round to the nearest hundredth place:
    //    Multiply by 100 (base-10 left-shift 2 places), add 1/2, truncate, divide by 100 (base-10 
    //    right-shift 2 places).
    //    Example:
    //      1.579 x 100 + 1/2 = 157.9 + 0.5 = 158.4\. Truncate to 158\. Divide by 100 --> 1.58\. Good.
    //
    // BASE 2 CONCEPT:
    // - We are dealing with fractional numbers stored in base-2 binary bits, however, and we have already 
    //   left-shifted by FRACTION_BITS (num << FRACTION_BITS) when we converted our numbers to fixed-point 
    //   numbers. Therefore, *all we have to do* is add the proper value, and we get the same effect when we 
    //   right-shift by FRACTION_BITS (num >> FRACTION_BITS) in our conversion back from fixed-point to regular
    //   numbers. Here's what that looks like for us:
    // - Note: "addend" = "a number that is added to another".
    //   (see https://www.google.com/search?q=addend&oq=addend&aqs=chrome.0.0l6.1290j0j7&sourceid=chrome&ie=UTF-8).
    // - Rounding to 0 digits means simply rounding to the nearest whole number.
    // Round to:        Addends:
    // 0 digits: add 5/10 * FRACTION_DIVISOR       ==> + FRACTION_DIVISOR/2
    // 1 digits: add 5/100 * FRACTION_DIVISOR      ==> + FRACTION_DIVISOR/20
    // 2 digits: add 5/1000 * FRACTION_DIVISOR     ==> + FRACTION_DIVISOR/200
    // 3 digits: add 5/10000 * FRACTION_DIVISOR    ==> + FRACTION_DIVISOR/2000
    // 4 digits: add 5/100000 * FRACTION_DIVISOR   ==> + FRACTION_DIVISOR/20000
    // 5 digits: add 5/1000000 * FRACTION_DIVISOR  ==> + FRACTION_DIVISOR/200000
    // 6 digits: add 5/10000000 * FRACTION_DIVISOR ==> + FRACTION_DIVISOR/2000000
    // etc.

    printf("WITH MANUAL INTEGER-BASED ROUNDING:\n");

    // Calculate addends used for rounding (see definition of "addend" above).
    fixed_point_t addend0 = FRACTION_DIVISOR/2;
    fixed_point_t addend1 = FRACTION_DIVISOR/20;
    fixed_point_t addend2 = FRACTION_DIVISOR/200;
    fixed_point_t addend3 = FRACTION_DIVISOR/2000;
    fixed_point_t addend4 = FRACTION_DIVISOR/20000;
    fixed_point_t addend5 = FRACTION_DIVISOR/200000;

    // Print addends used for rounding.
    printf("addend0 = %u.\n", addend0);
    printf("addend1 = %u.\n", addend1);
    printf("addend2 = %u.\n", addend2);
    printf("addend3 = %u.\n", addend3);
    printf("addend4 = %u.\n", addend4);
    printf("addend5 = %u.\n", addend5);

    // Calculate rounded prices
    fixed_point_t price_rounded0 = price + addend0; // round to 0 decimal digits
    fixed_point_t price_rounded1 = price + addend1; // round to 1 decimal digits
    fixed_point_t price_rounded2 = price + addend2; // round to 2 decimal digits
    fixed_point_t price_rounded3 = price + addend3; // round to 3 decimal digits
    fixed_point_t price_rounded4 = price + addend4; // round to 4 decimal digits
    fixed_point_t price_rounded5 = price + addend5; // round to 5 decimal digits

    // Print manually rounded prices of manually-printed fixed point integers as though they were "floats".
    printf("rounded price (manual float, rounded to 0 digits after decimal) is %u.\n", 
           price_rounded0 >> FRACTION_BITS); 
    printf("rounded price (manual float, rounded to 1 digit  after decimal) is %u.%01lu.\n", 
           price_rounded1 >> FRACTION_BITS, (uint64_t)(price_rounded1 & FRACTION_MASK) * 10 / FRACTION_DIVISOR); 
    printf("rounded price (manual float, rounded to 2 digits after decimal) is %u.%02lu.\n", 
           price_rounded2 >> FRACTION_BITS, (uint64_t)(price_rounded2 & FRACTION_MASK) * 100 / FRACTION_DIVISOR); 
    printf("rounded price (manual float, rounded to 3 digits after decimal) is %u.%03lu.\n", 
           price_rounded3 >> FRACTION_BITS, (uint64_t)(price_rounded3 & FRACTION_MASK) * 1000 / FRACTION_DIVISOR); 
    printf("rounded price (manual float, rounded to 4 digits after decimal) is %u.%04lu.\n", 
           price_rounded4 >> FRACTION_BITS, (uint64_t)(price_rounded4 & FRACTION_MASK) * 10000 / FRACTION_DIVISOR); 
    printf("rounded price (manual float, rounded to 5 digits after decimal) is %u.%05lu.\n", 
           price_rounded5 >> FRACTION_BITS, (uint64_t)(price_rounded5 & FRACTION_MASK) * 100000 / FRACTION_DIVISOR); 

    // =================================================================================================================

    printf("\nRELATED CONCEPT: DOING LARGE-INTEGER MATH WITH SMALL INTEGER TYPES:\n");

    // RELATED CONCEPTS:
    // Now let's practice handling (doing math on) large integers (ie: large relative to their integer type),
    // withOUT resorting to using larger integer types (because they may not exist for our target processor), 
    // and withOUT using floating point math, since that might also either not exist for our processor, or be too
    // slow or program-space-intensive for our application.
    // - These concepts are especially useful when you hit the limits of your architecture's integer types: ex: 
    //   if you have a uint64_t nanosecond timestamp that is really large, and you need to multiply it by a fraction
    //   to convert it, but you don't have uint128_t types available to you to multiply by the numerator before 
    //   dividing by the denominator. What do you do?
    // - We can use fixed-point math to achieve desired results. Let's look at various approaches.
    // - Let's say my goal is to multiply a number by a fraction < 1 withOUT it ever growing into a larger type.
    // - Essentially we want to multiply some really large number (near its range limit for its integer type)
    //   by some_number/some_larger_number (ie: a fraction < 1). The problem is that if we multiply by the numerator
    //   first, it will overflow, and if we divide by the denominator first we will lose resolution via bits 
    //   right-shifting out.
    // Here are various examples and approaches.

    // -----------------------------------------------------
    // EXAMPLE 1
    // Goal: Use only 16-bit values & math to find 65401 * 16/127.
    // Result: Great! All 3 approaches work, with the 3rd being the best. To learn the techniques required for the 
    // absolute best approach of all, take a look at the 8th approach in Example 2 below.
    // -----------------------------------------------------
    uint16_t num16 = 65401; // 1111 1111 0111 1001 
    uint16_t times = 16;
    uint16_t divide = 127;

    printf("\nEXAMPLE 1\n");

    // Find the true answer.
    // First, let's cheat to know the right answer by letting it grow into a larger type. 
    // Multiply *first* (before doing the divide) to avoid losing resolution.
    printf("%u * %u/%u = %u. <== true answer\n", num16, times, divide, (uint32_t)num16*times/divide);

    // 1st approach: just divide first to prevent overflow, and lose precision right from the start.
    uint16_t num16_result = num16/divide * times;
    printf("1st approach (divide then multiply):\n");
    printf("  num16_result = %u. <== Loses bits that right-shift out during the initial divide.\n", num16_result);

    // 2nd approach: split the 16-bit number into 2 8-bit numbers stored in 16-bit numbers, 
    // placing all 8 bits of each sub-number to the ***far right***, with 8 bits on the left to grow
    // into when multiplying. Then, multiply and divide each part separately. 
    // - The problem, however, is that you'll lose meaningful resolution on the upper-8-bit number when you 
    //   do the division, since there's no bits to the right for the right-shifted bits during division to 
    //   be retained in.
    // Re-sum both sub-numbers at the end to get the final result. 
    // - NOTE THAT 257 IS THE HIGHEST *TIMES* VALUE I CAN USE SINCE 2^16/0b0000,0000,1111,1111 = 65536/255 = 257.00392.
    //   Therefore, any *times* value larger than this will cause overflow.
    uint16_t num16_upper8 = num16 >> 8; // 1111 1111
    uint16_t num16_lower8 = num16 & 0xFF; // 0111 1001
    num16_upper8 *= times;
    num16_lower8 *= times;
    num16_upper8 /= divide;
    num16_lower8 /= divide;
    num16_result = (num16_upper8 << 8) + num16_lower8;
    printf("2nd approach (split into 2 8-bit sub-numbers with bits at far right):\n");
    printf("  num16_result = %u. <== Loses bits that right-shift out during the divide.\n", num16_result);

    // 3rd approach: split the 16-bit number into 2 8-bit numbers stored in 16-bit numbers, 
    // placing all 8 bits of each sub-number ***in the center***, with 4 bits on the left to grow when 
    // multiplying and 4 bits on the right to not lose as many bits when dividing. 
    // This will help stop the loss of resolution when we divide, at the cost of overflowing more easily when we 
    // multiply.
    // - NOTE THAT 16 IS THE HIGHEST *TIMES* VALUE I CAN USE SINCE 2^16/0b0000,1111,1111,0000 = 65536/4080 = 16.0627.
    //   Therefore, any *times* value larger than this will cause overflow.
    num16_upper8 = (num16 >> 4) & 0x0FF0;
    num16_lower8 = (num16 << 4) & 0x0FF0;
    num16_upper8 *= times;
    num16_lower8 *= times;
    num16_upper8 /= divide;
    num16_lower8 /= divide;
    num16_result = (num16_upper8 << 4) + (num16_lower8 >> 4);
    printf("3rd approach (split into 2 8-bit sub-numbers with bits centered):\n");
    printf("  num16_result = %u. <== Perfect! Retains the bits that right-shift during the divide.\n", num16_result);

    // -----------------------------------------------------
    // EXAMPLE 2
    // Goal: Use only 16-bit values & math to find 65401 * 99/127.
    // Result: Many approaches work, so long as enough bits exist to the left to not allow overflow during the 
    // multiply. The best approach is the 8th one, however, which 1) right-shifts the minimum possible before the
    // multiply, in order to retain as much resolution as possible, and 2) does integer rounding during the divide
    // in order to be as accurate as possible. This is the best approach to use.
    // -----------------------------------------------------
    num16 = 65401; // 1111 1111 0111 1001 
    times = 99;
    divide = 127;

    printf("\nEXAMPLE 2\n");

    // Find the true answer by letting it grow into a larger type.
    printf("%u * %u/%u = %u. <== true answer\n", num16, times, divide, (uint32_t)num16*times/divide);

    // 1st approach: just divide first to prevent overflow, and lose precision right from the start.
    num16_result = num16/divide * times;
    printf("1st approach (divide then multiply):\n");
    printf("  num16_result = %u. <== Loses bits that right-shift out during the initial divide.\n", num16_result);

    // 2nd approach: split the 16-bit number into 2 8-bit numbers stored in 16-bit numbers, 
    // placing all 8 bits of each sub-number to the ***far right***, with 8 bits on the left to grow
    // into when multiplying. Then, multiply and divide each part separately. 
    // - The problem, however, is that you'll lose meaningful resolution on the upper-8-bit number when you 
    //   do the division, since there's no bits to the right for the right-shifted bits during division to 
    //   be retained in.
    // Re-sum both sub-numbers at the end to get the final result. 
    // - NOTE THAT 257 IS THE HIGHEST *TIMES* VALUE I CAN USE SINCE 2^16/0b0000,0000,1111,1111 = 65536/255 = 257.00392.
    //   Therefore, any *times* value larger than this will cause overflow.
    num16_upper8 = num16 >> 8; // 1111 1111
    num16_lower8 = num16 & 0xFF; // 0111 1001
    num16_upper8 *= times;
    num16_lower8 *= times;
    num16_upper8 /= divide;
    num16_lower8 /= divide;
    num16_result = (num16_upper8 << 8) + num16_lower8;
    printf("2nd approach (split into 2 8-bit sub-numbers with bits at far right):\n");
    printf("  num16_result = %u. <== Loses bits that right-shift out during the divide.\n", num16_result);

    /////////////////////////////////////////////////////////////////////////////////////////////////
    // TRUNCATED BECAUSE STACK OVERFLOW WON'T ALLOW THIS MANY CHARACTERS.
    // See the rest of the code on github: https://github.com/ElectricRCAircraftGuy/fixed_point_math
    /////////////////////////////////////////////////////////////////////////////////////////////////

    return 0;
} // main

// PRIVATE FUNCTION DEFINITIONS:

/// @brief A function to help identify at what decimal digit error is introduced, based on how many bits you are using
///        to represent the fractional portion of the number in your fixed-point number system.
/// @details    Note: this function relies on an internal static bool to keep track of if it has already
///             identified at what decimal digit error is introduced, so once it prints this fact once, it will never 
///             print again. This is by design just to simplify usage in this demo.
/// @param[in]  num_digits_after_decimal    The number of decimal digits we are printing after the decimal 
///             (0, 1, 2, 3, etc)
/// @return     None
static void print_if_error_introduced(uint8_t num_digits_after_decimal)
{
    static bool already_found = false;

    // Array of power base 10 values, where the value = 10^index:
    const uint32_t POW_BASE_10[] = 
    {
        1, // index 0 (10^0)
        10, 
        100, 
        1000, 
        10000, 
        100000,
        1000000,
        10000000,
        100000000,
        1000000000, // index 9 (10^9); 1 Billion: the max power of 10 that can be stored in a uint32_t
    };

    if (already_found == true)
    {
        goto done;
    }

    if (POW_BASE_10[num_digits_after_decimal] > FRACTION_DIVISOR)
    {
        already_found = true;
        printf(" <== Fixed-point math decimal error first\n"
               "    starts to get introduced here since the fixed point resolution (1/%u) now has lower resolution\n"
               "    than the base-10 resolution (which is 1/%u) at this decimal place. Decimal error may not show\n"
               "    up at this decimal location, per say, but definitely will for all decimal places hereafter.", 
               FRACTION_DIVISOR, POW_BASE_10[num_digits_after_decimal]);
    }

done:
    printf("\n");
} 
```

**输出：**

> ```
> gabriel$ cp fixed_point_math.cpp fixed_point_math_copy.c && gcc -Wall -std=c99 -o ./bin/fixed_point_math_c > fixed_point_math_copy.c && ./bin/fixed_point_math_c  
> Begin.  
> fraction bits = 16\.  
> whole number bits = 16\.  
> max whole number = 65535\.  
>   
> price as a true double is 219.857142857\.  
> price as integer is 219\.  
> price fractional part is 56173 (of 65536).  
> price fractional part as decimal is 0.857132 (56173/65536).  
> price (manual float, 0 digits after decimal) is 219\.  
> price (manual float, 1 digit  after decimal) is 219.8\.  
> price (manual float, 2 digits after decimal) is 219.85\.  
> price (manual float, 3 digits after decimal) is 219.857\.  
> price (manual float, 4 digits after decimal) is 219.8571\.  
> price (manual float, 5 digits after decimal) is 219.85713\. <== Fixed-point math decimal error first  
>     starts to get introduced here since the fixed point resolution (1/65536) now has lower resolution  
>     than the base-10 resolution (which is 1/100000) at this decimal place. Decimal error may not show  
>     up at this decimal location, per say, but definitely will for all decimal places hereafter.  
> price (manual float, 6 digits after decimal) is 219.857131\.  
>   
> WITH MANUAL INTEGER-BASED ROUNDING:  
> addend0 = 32768\.  
> addend1 = 3276\.  
> addend2 = 327\.  
> addend3 = 32\.  
> addend4 = 3\.  
> addend5 = 0\.  
> rounded price (manual float, rounded to 0 digits after decimal) is 220\.  
> rounded price (manual float, rounded to 1 digit  after decimal) is 219.9\.  
> rounded price (manual float, rounded to 2 digits after decimal) is 219.86\.  
> rounded price (manual float, rounded to 3 digits after decimal) is 219.857\.  
> rounded price (manual float, rounded to 4 digits after decimal) is 219.8571\.  
> rounded price (manual float, rounded to 5 digits after decimal) is 219.85713\.  
>   
> RELATED CONCEPT: DOING LARGE-INTEGER MATH WITH SMALL INTEGER TYPES:  
>   
> EXAMPLE 1  
> 65401 * 16/127 = 8239\. <== true answer  
> 1st approach (divide then multiply):  
>   num16_result = 8224\. <== Loses bits that right-shift out during the initial divide.  
> 2nd approach (split into 2 8-bit sub-numbers with bits at far right):  
>   num16_result = 8207\. <== Loses bits that right-shift out during the divide.  
> 3rd approach (split into 2 8-bit sub-numbers with bits centered):  
>   num16_result = 8239\. <== Perfect! Retains the bits that right-shift during the divide.  
>   
> EXAMPLE 2  
> 65401 * 99/127 = 50981\. <== true answer  
> 1st approach (divide then multiply):  
>   num16_result = 50886\. <== Loses bits that right-shift out during the initial divide.  
> 2nd approach (split into 2 8-bit sub-numbers with bits at far right):  
>   num16_result = 50782\. <== Loses bits that right-shift out during the divide.  
> 3rd approach (split into 2 8-bit sub-numbers with bits centered):  
>   num16_result = 1373\. <== Completely wrong due to overflow during the multiply.  
> 4th approach (split into 4 4-bit sub-numbers with bits centered):  
>   num16_result = 15870\. <== Completely wrong due to overflow during the multiply.  
> 5th approach (split into 8 2-bit sub-numbers with bits centered):  
>   num16_result = 50922\. <== Loses a few bits that right-shift out during the divide.  
> 6th approach (split into 16 1-bit sub-numbers with bits skewed left):  
>   num16_result = 50963\. <== Loses the fewest possible bits that right-shift out during the divide.  
> 7th approach (split into 16 1-bit sub-numbers with bits skewed left):  
>   num16_result = 50963\. <== [same as 6th approach] Loses the fewest possible bits that right-shift out during the divide.  
> [BEST APPROACH OF ALL] 8th approach (split into 16 1-bit sub-numbers with bits skewed left, w/integer rounding during division):  
>   num16_result = 50967\. <== Loses the fewest possible bits that right-shift out during the divide,   
>   & has better accuracy due to rounding during the divide. 
> ```

## 参考：

*   [我的回购] [https://github.com/ElectricRCAircraftGuy/eRCaGuy_analogReadXXbit/blob/master/eRCaGuy_analogReadXXbit.cpp](https://github.com/ElectricRCAircraftGuy/eRCaGuy_analogReadXXbit/blob/master/eRCaGuy_analogReadXXbit.cpp) - 请参阅底部的“整数数学舍入注释”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T00:03:23.207

如果您的唯一目的是节省内存，我不建议您这样做。价格计算中的错误可以累积，你会搞砸它。

如果你真的想实现类似的东西，你可以只取价格的最小区间，然后直接使用 int 和 integer 操作来操作你的数字吗？您只需在显示时将其转换为浮点数，让您的生活更轻松。

# hash - 正确实现 Zobrist 散列

> ID：10067514
> 
> 赞同：3
> 
> 时间：2012-04-08T23:49:22.160
> 
> 标签：hash, chess

我目前正在我的国际象棋引擎中添加转置表，并且在增量更新 Zobrist 键时遇到了问题。我[做了一些研究](http://chessprogramming.wikispaces.com/Zobrist+Hashing)并实现了基本想法，但它的表现并不像我预期的那样。我遇到的问题是等效的棋盘位置并不总是具有相同的键。例如，在起始位置，如果两个玩家都移动了一个马然后将其移回，那么关键将与起始位置的不同。但是，再次执行此操作（移动骑士）并返回起始位置*将*导致原始密钥。因此，这种序列的周期似乎是每个玩家 4 步，而它应该只是 2。

有没有人遇到过这样的问题或可以想到解决方案？我已经包含了我的制作/取消制作方法的相关部分。我不包括边移动、易位权等；它们不应该影响我提出的具体案例。HashValue 存储随机值，第一个索引是棋子类型，第二个索引是正方形。

```
void Make(Move m) {
    ZobristKey ^= HashValue[Piece[m.From].Type][m.From];
    ZobristKey ^= HashValue[Piece[m.From].Type][m.To];
    ZobristKey ^= HashValue[Piece[m.To].Type][m.To];
    //rest of make move
}

void Unmake(Move m) {
    ZobristKey ^= HashValue[m.Captured.Type][m.To];
    ZobristKey ^= HashValue[Element[m.To].Type][m.To];
    ZobristKey ^= HashValue[Element[m.To].Type][m.From];
    //rest of unmake
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T00:21:10.457

```
Make_a_move() {
    hashval ^= Zobrist_array[oldpos][piece];
    hashval ^= Zobrist_array[newpos][piece];
    /* if there is a capture */
    hashval ^= Zobrist_array[otherpos][otherpiece];
    }

Undo_a_move() {
    hashval ^= Zobrist_array[oldpos][piece];
    hashval ^= Zobrist_array[newpos][piece];
    /* if there was a capture */
    hashval ^= Zobrist_array[otherpos][otherpiece];
    } 
```

Castling 可以看作是两个动作的总和（显然没有捕获）

升级可以被视为从棋盘上移除一个棋子（从 2 或 7 位置）并添加新棋子（在 1 或 8 位置）

# javascript - 如何将字符串转换为对象？

> ID：10067522
> 
> 赞同：0
> 
> 时间：2012-04-08T23:50:47.517
> 
> 标签：javascript

我在我的 javascript 文件顶部预加载了两个不同的图像。

```
var imgColor = new Image();
var imgLoadedColor = false;
imgColor.src = 'color/progress.png';

imgColor.onload = function(){
  imgLoadedColor = true;
}   

var imgBlackWhite = new Image();
var imgLoadedColor = false;
imgBlackWhite.src = 'blackWhite/progress.png';

imgBlackWhite.onload = function(){
  imgLoadedColor = true;
} 
```

中的字符串`this.options.type`是`imgColor`or `imgBlackWhite`。

当我尝试将参数传递`this.options.type`给函数时，我收到一个错误，因为 in 的值`this.options.type`是一个字符串，而不是一个对象。但是，如果我传递参数`imgColor`，它会加载彩色图像，如果我传递参数`imgBlackWhite`，它会加载黑白图像，因为`imgColor`和`imgBlackWhite`是对象。

如何创建对对象的引用`imgColor`以及`imgBlackWhite`从 in 中字符串的值`this.options.type`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T23:55:33.773

为什么不直接使用 if 语句？

```
if (arg == "imgColor") return imgColor;
else return imgBlackWhite; 
```

编辑：您还可以使用新的 windowtypename 来实例化一个对象（根据这个线程：[Instantiate a JavaScript Object Using a String to Define the Class Name](https://stackoverflow.com/questions/1366127/instantiate-a-javascript-object-using-a-string-to-define-the-class-name)）。所以，而不是上面的：

```
return new window[arg](); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T00:01:10.713

传递参数：

```
this[this.options.type] 
```

# php - Jquery自动完成不使用选择更新输入值

> ID：10067526
> 
> 赞同：2
> 
> 时间：2012-04-08T23:51:59.957
> 
> 标签：php, jquery, mysql, input, autocomplete

我正在尝试使用 jquerys 著名的自动完成功能并通过从 mysql 数据库创建一个数组来创建一个自动完成字段。它工作得很好，但是当进行选择时，输入字段值不会更新，因此我无法从表单中传递值。有人可以在这里帮助我吗？

查询：

```
<link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.11/themes/base/jquery-ui.css " type="text/css" media="all" />
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js " type="text/javascript"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.11/jquery-ui.min.js " type="text/javascript"></script>
<script>
$(document).ready(function() {
  $("#keywords").autocomplete({
    source: keywordList
  });
});

</script>
<?php echo keywordArray(); ?> 
```

PHP：（为自动完成创建数组列表）

```
<?php
include 'admin/dbconn-dest.php';

function keywordArray()
{
  $rsKeywords = mysql_query("SELECT Destination FROM Destinations WHERE Country = 'Mexico'");

  $output = '<script>'."\n";
  $output .= 'var keywordList = [';

  while($row_rsKeywords = mysql_fetch_assoc($rsKeywords))
  {
    $output .= '"'.$row_rsKeywords['Destination'].'",';
  }

  $output = substr($output,0,-1); //Get rid of the trailing comma
  $output .= '];'."\n";
  $output .= '</script>';
  return $output;
}
?> 
```

HTML：

```
<input id="keywords" name="keywords" type="text" autocomplete="off" size="40" > 
```

任何帮助将不胜感激！！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T00:08:44.003

使用select`event`设置输入框的值

```
$("#keywords").autocomplete({
    source: keywordList,
    select: function (event, ui) {
                         $("#keywords").val(ui.item.value);                       
                     }  
  }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T00:02:24.603

这是一个已知的问题。尝试使用[Select First](http://forum.jquery.com/topic/autocomplete-automatically-select-first-item-in-dropdown-or-add-item-into-drop-down-menu)插件。这应该为您完成工作（至少在我的情况下它工作得很好）

希望有帮助。

# django - Django - 如何以高效并保留顺序的方式链接两个查询集

> ID：10067527
> 
> 赞同：2
> 
> 时间：2012-04-08T23:52:03.753
> 
> 标签：django, django-queryset

将两个查询集链接在一起的最佳方法是什么？我试过使用 itertools.chain() 和按位或。

我对 chain() 的问题是它不能很好地与分页配合使用。因为chain() 返回一个列表，当与Django 的分页一起使用时，我得到“异常值：'list' 对象没有属性'_clone'”。

按位或是可以的，但它似乎并没有保留顺序。这两个查询集似乎只是组合在一起。我需要将第一个查询集的项目放在第二个查询集的项目之前。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T15:19:47.780

我不知道这个问题是否有简单的解决方案。以下解决方案将像一个魅力，但它并不简单。

通过以下方式定义您自己的 QuerySum 类：

```
class QuerySum(object):
    def __init__(self, queries):
        self.queries = queries

    def _clone(self, queries):
        return QuerySum(q._clone() for q in self.queries)

    def __len__(self, queries):
        return sum(len(q) for q in self.queries)

    # you should define rest of the methods that paginator uses in similar manner 
```

使用此实现链接查询。

# ruby-on-rails - BSON::InvalidObjectId 非法 ObjectId 格式

> ID：10067528
> 
> 赞同：1
> 
> 时间：2012-04-08T23:52:29.503
> 
> 标签：ruby-on-rails, elasticsearch, tire

尝试`if`在控制器中插入简单条件后出现此错误：

```
def index
  if params[:query].present?
    @blog_posts = BlogPost.search(params[:query])
  else
    @blog_posts = BlogPost.all
  end 
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T21:25:40.543

取决于你的模型是如何设置的。正如[轮胎自述](https://github.com/karmi/tire)文件所说，Mongoid 的 ID 有点奇怪，你可能必须`to_indexed_json`自己定义：

```
def to_indexed_json
  self.as_json
end 
```

# html - CSS 样式列表 UL LI - ( sprites ) loading jumpy

> ID：10067530
> 
> 赞同：0
> 
> 时间：2012-04-08T23:52:48.997
> 
> 标签：html, css, html-lists, css-sprites

感谢大家花时间阅读本文。

我使用列表在我的网站上设置了导航栏和其他一些东西的样式。例如...

```
<ul>
    <li id="n1"><a href="http://www.beaconrecords.com/index.php"></a></li>
    <li id="n2"><a href="artists"></a></li>
    <li id="n3"><a href="lifestyle.php"></a></li>
    <li id="n4"><a href="events.php"></a></li>
    <li id="n5"><a href="shop.php"></a></li>
    <li id="n6"><a href="contact.php"></a></li>
    <li id="n7"><a href="about.php"></a></li>
</ul> 
```

它工作得很好，但是当它加载时，它有点像呼吸。它开始时会收缩一点，然后在一秒钟后扩展到适当的位置。我不知道是什么导致了这个问题，我不认为这是由于我设置列表样式的方式，正如我将展示的那样。

这是有问题的网站。 [http://beaconrecords.com/](http://beaconrecords.com/)

这是一个没有问题的测试链接。 [http://beaconrecords.com/wp-content/themes/br/test.php](http://beaconrecords.com/wp-content/themes/br/test.php)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T00:06:17.967

我个人并不认为这有那么大的问题，但是，我觉得将“闪电”垫片分成两个图像，解决这个问题很可能也能解决你的另一个问题。我会扩展每个图像`li`以包含一个分隔符（或者甚至更好，使用单词图像作为链接的背景，并将分隔符用作除最后一个{或第一个}列表项之外的所有内容的背景）。

现在闪电对我来说没有正确显示（在 Chrome 中），这将是确保这一点的一种方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T19:31:20.490

在 Google PageSpeed 上测试您的网站：[https](https://developers.google.com/speed/pagespeed/insights#url=http_3A_2F_2Fbeaconrecords.com&mobile=false) ://developers.google.com/speed/pagespeed/insights#url=http_3A_2F_2Fbeaconrecords.com&mobile=false - 也许您会发现一些可以改进的地方。在我看来，您的网站在我的 1M 连接上加载速度通常很慢。

# javascript - 如何使用 AJAX 从外部网页获取未命名元素？

> ID：10067531
> 
> 赞同：0
> 
> 时间：2012-04-08T23:53:02.557
> 
> 标签：javascript, html, ajax

目前，我正在尝试使用 AJAX 从外部网站上获取元素，到目前为止，我（希望）设法获取了该页面：

```
var xmlhttp;
var version;
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    version=xmlhttp.innerHTML;
    }
  }
xmlhttp.open("GET","http://www.minecraftwiki.net/wiki/Minecraft_Wiki",true);
xmlhttp.send(); 
```

现在我只需要找到一种获取内容的方法：

```
<dd> Current PC version: 
<b>
<a href="/wiki/Version_history#1.2.5" title="Version history">
1.2.5
</a>
</b>
</dd> 
```

我已经检查了 url 的源代码，遗憾的是我想要的元素是未命名的（没有 id=""），所以仍然可以这样做吗？如果是这样，怎么办？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T00:02:42.293

首先，您正在发出跨域请求，因此除非您使用允许跨域 AJAX 的浏览器，否则如果不使用服务器端代理，这很可能对您不起作用。

但是，要回答您的原始问题，您不需要 id 属性来访问元素。虽然有帮助，但您可以通过多种方式访问​​元素。

**类选择器**

```
var col = document.getElementsByClassName("the-class"); 
```

然后循环遍历集合，直到找到所需的元素。

**jQuery 选择器：**

[jQuery 选择器](http://api.jquery.com/category/selectors/)可能是处理 DOM 操作和访问您感兴趣的元素的最简单方法：

```
// example of an attribute selector:

var exampleHTML = $('div[title="example"]).html(); 
```

还有 XPath，但根据我的经验，jQuery CSS 选择器更现代、更健壮，并且有助于加快开发过程。

# html - 图像/文本的 CSS 垂直对齐

> ID：10067536
> 
> 赞同：0
> 
> 时间：2012-04-08T23:53:52.617
> 
> 标签：html, css

我基本上是在尝试创建一个带有液体的 2 列 div`<h1>`和另一个跨越整个高度的 div `<h1>`，但我希望垂直对齐居中。我基本上是在尝试将图像放在页面标题的左侧：

```
<div class="outer">
   <div><img src="pound.png" /></div>
   <h1>This is text that is really long. This is text that is really long.  This is text that is really long.  This is text that is really long.  This is text that is really long.</h1>
</div> 
```

这是一个例子；我真的不想使用表格，因为我希望能够在某些情况下将图像浮动到右侧。我也不关心边界，我只是为了说明对齐方式。

```
------------------------------------------------------
        |  This is text that is really long. This is 
######  |  text that is really long. This is text that
######  |  is really long. This is text that is really
######  |  long. This is text that is really long. This 
        |  is text that is really long.
------------------------------------------------------ 
```

我的主要问题是让图像垂直占据整个空间，以便我可以使用 margin: 50% 或 auto 或它的一些变体垂直对齐它。我可以让图像垂直居中，然后文本环绕它，或者我可以让文本不换行，但图像垂直对齐。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T02:01:32.327

这个主题在网上被广泛讨论：http: [//goo.gl/hmTsW](http://goo.gl/hmTsW)

我发现这是一个很好的技术总结，选择适合你的。[http://blog.themeforest.net/tutorials/vertical-centering-with-css/](http://blog.themeforest.net/tutorials/vertical-centering-with-css/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T02:43:13.133

浏览器支持目前有点有限，但您可以尝试使用`box-align`css 属性来垂直对齐图像和文本。更多[在这里](http://www.w3schools.com/cssref/css3_pr_box-align.asp)。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-09T00:05:01.403

尝试使用行高。此外，如果可能的话，使用差异会更容易

# css - 谷歌地图不会全屏呈现整个地图

> ID：10067537
> 
> 赞同：2
> 
> 时间：2012-04-08T23:54:21.257
> 
> 标签：css, google-maps-api-3, fullscreen

我在调整 Google Maps JavaScript API v3 的大小时遇到​​了一些问题。如果我在加载时正确设置 CSS“参数”（仅在[文档](https://developers.google.com/maps/documentation/javascript/tutorial#HelloWorld)中），地图将显示 100% 的高度和宽度 - 没问题。但是，当我尝试通过单击链接来获得相同的结果时，它并没有显示整个地图。

![这是地图在单击链接以切换全屏时显示的方式](../Images/6c5a7b3073dd395ab47b9db49097cfd6.png)

我已经在这个事件上测试了 jQuery`css()`和jQuery。使用以下代码使地图不可见（完全隐藏地图而不是使其全屏显示）：`toggleClass()``toggleClass()`

```
// jQuery
$('#weather-map').toggleClass('test');

// CSS
#weather-map.test {
    height : 100%;
    width : 100%;
    top : 0;
    left : 0;
    position : absolute;
    z-index : 200;
} 
```

`css()`有效（地图全屏显示），但上图显示了地图在全屏时的呈现方式：

```
$('#weather-map').css({
                       'height' : '100%',
                       'width' : '100%',
                       'top' : '0',
                       'left' : '0',
                       'position' : 'absolute',
                       'z-index' : '200'
                      }); 
```

我现在想知道，为什么它会这样？我是否遗漏了什么，或者这种方法不适合切换地图的全屏？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T00:01:27.017

这只是因为 Google 的映射 Javascript 是如何工作的。它根据容器的大小进行渲染，并且不会添加任何类型的处理程序来重新渲染，以防容器此后重新调整大小。我想在上面的示例中，您必须再次调用地图初始化代码才能在调整大小的 div 中再次呈现地图。

# xslt - 如何在 XSLT 2.0 中使用 xpath 函数？

> ID：10067551
> 
> 赞同：3
> 
> 时间：2012-04-08T23:57:28.977
> 
> 标签：xslt, xpath, xslt-1.0, xslt-2.0

为了使用[xpath-functions](http://www.w3.org/TR/xpath-functions/#namespace-prefixes)（特别是`fn`部分），我将相应的命名空间包含到我的 xslt 样式表中，如下所示：

```
<xsl:stylesheet
  version="2.0"
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:fn="http://www.w3.org/2005/xpath-functions"
> 
```

由W3C[指定。](http://www.w3.org/TR/xpath-functions/#namespace-prefixes)

但是，当我使用 时`fn:document-uri`，我的 XSLT 引擎告诉我我调用了一个未知函数/扩展：

```
 <xsl:variable name="uri" select="fn:document-uri()" /> 
```

歌剧 说：

> 此文档包含无效的 XSLT 样式表。来自 XSLT 引擎的错误消息：
> 错误：XPath 表达式编译失败：fn:document-uri()
> 详细信息：编译错误（字符 1-17，“fn:document-uri()”）：未知函数调用：'{ [http: //www.w3.org/2005/xpath-functions](http://www.w3.org/2005/xpath-functions)，文档-uri }'

火狐 说：

> XSLT 转换期间出错：调用了未知的 XPath 扩展函数。

并`xsltproc`拒绝转换，因为 xslt 2.0。

那么，如何`fn`正确指定命名空间呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T00:20:47.660

**问题是您使用的是 XSLT 1.0 处理器，而 XSLT 1.0 处理器对 XPath 2.0 函数一无所知（也一定不知道）**。

如果您使用真正的 XSLT 2.0 处理器，您甚至不必指定函数名称空间——它是任何无前缀函数名称的默认名称空间。

**例如，这个 XSLT 2.0 转换**：

```
<xsl:stylesheet version="2.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output method="text"/>

 <xsl:template match="/">
    <xsl:sequence select="document-uri(.)" />
    <xsl:text>&#xA;</xsl:text>
    <xsl:sequence select="document-uri(document(''))" />
 </xsl:template>
</xsl:stylesheet> 
```

**在 XSelerator 下使用 Saxon 9.1.5 执行时，会正确生成源 XML 文档的 URL 和样式表本身**：

```
file:/C:/Program%20Files/Java/jre6/bin/marrowtr.xml
file:/C:/Program%20Files/Java/jre6/bin/marrowtr.xsl 
```

# java - libgdx - 删除 Box2d CircleShape 上呈现的圆形轮廓

> ID：10067552
> 
> 赞同：1
> 
> 时间：2012-04-08T23:57:38.453
> 
> 标签：java, libgdx

```
CircleShape circle = new CircleShape();
circle.setRadius(1f);
...
using 
...
batch.draw(textureRegion, position.x - 1, position.y - 1, 
                            1f, 1f,
                            2, 2, 
                            1, 1, 
                            angle); 
```

我使用它来设置 Box2d 碰撞的主体，但我在 libGdx 中的纹理周围得到了一个愚蠢的圆形，即我的纹理精灵（球）在它的顶部有一个圆圈，一条从中心沿着半径延伸的线。

关于如何删除重叠的圆圈线的任何想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-09T21:45:52.057

不是 100% 肯定，有一段时间没有使用 Box2d 和 libgdx。但是看看你是否有任何`Box2DDebugRenderer`渲染 box2d 世界的东西。如果是这样，请不要调用它的`render()`方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-24T09:56:16.367

是的，取消注释以下行。

```
debugRenderer.render(world, viewport.getCamera().combined); 
```

# c# - 停止 WP7 模拟器在 Windows 版本调试时启动

> ID：10067556
> 
> 赞同：2
> 
> 时间：2012-04-08T23:58:44.137
> 
> 标签：c#, windows-phone-7, xna, emulation

目前我有一个包含 Windows 和 WP7 XNA 项目的解决方案。

每当我尝试仅调试 Windows 项目时，它认为它需要 WP7 模拟器并决定启动它。我打开了配置管理器并为 Windows 调试创建了一个新配置，并取消了我所有 WP7 项目的构建和部署，但它仍然坚持让 WP7 模拟器打开。

有没有办法阻止这种行为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T18:42:30.083

在配置管理器中，取消选中 windows phone 项目旁边的部署

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T16:30:21.110

我敢打赌，无论正在调试什么项目，都会[加载多个 ASP.NET 开发服务器实例，这与此问题](http://blog.geocortex.com/2010/06/04/always-start-when-debugging-preventing-multiple-visual-studio-development-servers-from-starting/)非常相似。我现在无法确定这一点，但我敢打赌，模拟器的“调试时始终启动”选项可能有类似的设置。

因此打开属性窗口（视图-> 属性窗口，而不是视图-> 属性页之一），然后在解决方案资源管理器中单击项目，然后寻找与“调试时始终启动”类似的设置。

*或者*，您是否尝试将目标设置为设备而不是模拟器？这也可能是一种解决方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T00:16:19.523

可能是因为它被设置为启动项目：

[如何：设置启动项目](http://msdn.microsoft.com/en-us/library/a1awth7y.aspx)

# xcode - 当使用带有多个视图控制器的情节提要时，我无法使用控件拖动功能将按钮连接到 .h 中的操作

> ID：10067559
> 
> 赞同：1
> 
> 时间：2012-04-08T23:59:21.703
> 
> 标签：xcode, controls, storyboard, drag

当使用带有多个视图控制器的情节提要时，为什么我不能使用控件拖动功能将按钮连接到 .h 中的操作？还有另一种方法可以做到这一点吗？

非常感谢事先！

安东

# ruby-on-rails - Ruby 错误 - #<# 的未定义方法“test_path” :0x4028ee0>

> ID：10067562
> 
> 赞同：-1
> 
> 时间：2012-04-09T00:00:18.547
> 
> 标签：ruby-on-rails

我收到了这个错误：

```
undefined method `test_path' for #<#<Class:0x4022a00>:0x4028ee0> 
```

我做了这个链接：

```
<%= link_to "Alex Link", test_path(@test) %> 
```

我做了这个控制器：test_controller.rb

```
class TestController < ApplicationController
  def test
  end
end 
```

我将此添加到 routes.rb

```
root :to => 'test_path#hello' 
```

我哪里做错了？

我只是想学习如何手动路由 ruby​​ 控制器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T00:28:38.160

第一部分：`resources :test`代替您在 routes.rb 文件中的内容

第二个答案：因为您没有与控制器关联的模型，所以您会收到该错误。

希望能帮助到你。

# ruby-on-rails-3 - Rails 3，作为可标记的宝石 - 如何获得最常用的标签？

> ID：10067566
> 
> 赞同：1
> 
> 时间：2012-04-09T00:01:00.593
> 
> 标签：ruby-on-rails-3, tags, count, acts-as-taggable-on

我使用[acts-as-taggable-on](https://github.com/mbleigh/acts-as-taggable-on) gem 并想获取 5 个最常用的标签，我该如何获取它们？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T22:55:11.820

我认为您的控制器必须是：

```
class PostController < ApplicationController
    def tag_cloud
        @tags = Post.tag_counts_on(:tags).limit(5).order('count desc')
    end
end 
```

# android - 在 Eclipse/Android 上使用多个按钮

> ID：10067567
> 
> 赞同：1
> 
> 时间：2012-04-09T00:01:10.127
> 
> 标签：android, eclipse, button

我是编程新手，但有一些空闲时间，刚买了一个新的安卓平板电脑，所以我想是时候学习了。我玩一个棋盘游戏，它有很多套牌，你可以在整个游戏过程中从中抽取，我决定最好有一个显示 21 套套牌的应用程序，然后你点击其中一个，它会随机显示其中一个套牌中的一张牌. 你阅读卡片，采取行动，点击卡片，它就会消失。

因此，我的布局包含所有 21 个卡座 (7x3)，每个卡座都有一个单独的按钮。因此，我在 1 个屏幕上有 21 个按钮。根据我一直在关注的教程，我需要在 .java 文件**button1 = (Button) findViewById(android.R.id.button1)**上声明按钮。但它只能选择声明 3 个按钮，然后我得到厄运的小红色 x。

我该如何声明所有 21 个按钮？或者我不需要声明这些按钮？

任何帮助都会很棒！（可能还需要帮助找到一种方法来随机化“绘制”功能，所以再次见到我不要感到惊讶）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T00:28:20.173

您确实需要定义每个按钮。使用以下：

```
Button button1 = (Button)findViewById(R.id.idofbutton1);
Button button2 = (Button)findViewById(R.id.idofbutton2);
Button button3 = (Button)findViewById(R.id.idofbutton3);
Button button4 = (Button)findViewById(R.id.idofbutton4); 
```

以此类推

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T00:28:43.730

如果您在 XML（main.xml 或类似的东西）中布置每个按钮，那么是的，如果您希望它们做任何事情，您必须按照您所说的声明按钮。

```
Button button1 = (Button) findViewById(R.id.button1); 
```

通过以这种方式输入，我假设您没有将代码中较高的按钮声明为类范围的字段。另外，您是否运行了 setContentView(R.layout.main); 方法？

所以让我们明确一点：除非你输入 Button b1; 按钮 b2; 按钮 b3 就在你的类线下方 (public class YourClassName() {，每次你尝试实例化一个按钮时，你必须说 Button b1 = (Button) findViewById(R.id.button1);。如果你确实做了类-宽字段（在类行的正下方）然后您可以拥有像您在原始问题中显示的代码，它只是 button1 = (Button) findViewById(R.id.button1)。这种区别有意义吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T00:33:10.267

此外，如果您想在循环中执行此操作，您也可以这样做。可能会让事情变得容易一些。这是一个链接：[https ://stackoverflow.com/a/8687807/1231943](https://stackoverflow.com/a/8687807/1231943)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T00:52:28.290

任何时候你声明一个 Button （它是一个对象）：

```
Button button1 = (Button)findViewById(R.id.idofbutton1);
Button button2 = (Button)findViewById(R.id.idofbutton2); 
```

确保将“id”添加到 XML 布局中：

```
 <Button
   android:id="@+id/idofbutton1"
   android:layout_width="wrap_content"
   android:layout_height="wrap_content"
   android:text="Button1"
   android:textSize="20px" >
</Button>

<Button
   android:id="@+id/idofbutton2"
   android:layout_width="wrap_content"
   android:layout_height="wrap_content"
   android:text="Button2"
   android:textSize="20px" >
</Button> 
```

# .net - 装配中每个 NetModule 的 PE 标头

> ID：10067575
> 
> 赞同：3
> 
> 时间：2012-04-09T00:02:20.897
> 
> 标签：.net, assemblies, clr

众所周知，我们可以将网络模块存储在程序集中，而不是将它们放入不同的文件中并在程序集中将它们链接起来。但是由于每个托管模块都有自己的 PE 标头、CLR 标头、元数据，我想知道当它们被嵌入到一个程序集中时，这些标头是否会成为一个完整的标头来描述程序集中的每个托管模块，或者它们仍然是分开的？

![在此处输入图像描述](../Images/00e9009515f627be737eb742467296d9.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T12:54:03.720

.netmodules 必须通过链接`al.exe`才能创建可用的程序集。在程序集中生成元数据的最终版本是链接器的工作。唯一的。

# jqgrid - jqgrid日期列，只显示日期

> ID：10067578
> 
> 赞同：0
> 
> 时间：2012-04-09T00:03:00.387
> 
> 标签：jqgrid, jqgrid-formatter

我试图在我的 jqgrid 列中只显示日期部分

列定义为

```
{name:'Ingreso',formatter:"date",formatoptions:{srcformat:"d/m/Y H:i A",newformat:"ShortDate"} 
```

数据类型是本地的

语言环境是“es”，jqgrid 版本是 4.3.1

日期显示为 08/04/2012 08:42 pm（第 8 天，第 4 个月），我喜欢显示 08/04/2012

我使用这个链接作为参考：[http ://www.trirand.com/jqgridwiki/doku.php?id=wiki:predefined_formatter](http://www.trirand.com/jqgridwiki/doku.php?id=wiki:predefined_formatter)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T00:30:42.123

抱歉，我无法重现您的问题。请参阅[演示](http://www.ok-soft-gmbh.com/jqGrid/ShortDate.htm)。此外，我建议您在输入数据中使用[ISO 8601](http://en.wikipedia.org/wiki/ISO_8601)格式的日期。

# database - 一个大规模的、修改过的网页档案

> ID：10067580
> 
> 赞同：1
> 
> 时间：2012-04-09T00:03:09.320
> 
> 标签：database, full-text-search, archive, large-files

我想测试我的基于 html 的搜索引擎，并且我想要一组相对较大的修订文档。是否有存档可以下载并放入我的系统中？我已经阅读了有关 Wikipedia 转储的信息，但我不确定它们是如何格式化的。Intenet Archive 的 Wayback Machine 很好，但服务器很慢。我正在寻找一个档案：

*   很大但不是很大。像 1000 个文档和 1000 个修订版之类的东西会满足我的项目。我不是在寻找 5 TB 的数据库。
*   已修订。一个静态的、单一的修订档案是不够的。
*   我正在寻找 HTML 或可以轻松转换为 HTML 的文档。

# android - 在android中的屏幕上交换图像

> ID：10067581
> 
> 赞同：1
> 
> 时间：2012-04-09T00:03:20.733
> 
> 标签：android, image, screen, swap, viewflipper

我在做一个学校项目，这是我第一次做安卓开发。我搜索了整个网络，但找不到任何问题的答案。我有一个图像列表，我想把它们放在一个屏幕上，用户可以在不改变整个屏幕的情况下浏览这些图像。我还试图放置一个自动完成搜索框来调用同一屏幕上列表中的任何图像。我尝试使用 viewFlipper 方法但没有成功。还有其他方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T01:02:50.353

您可以将 onClick 侦听器添加到 ImageView。像这样的东西：

```
ImageView imgFavorite = (ImageView) findViewById(R.id.favorite_icon);
imgFavorite.setClickable(true);
imgFavorite.setOnClickListener(new OnClickListener() {
            @Override
            public void onClick(View v) {
                //Change the image here.
            }
        }); 
```

来源：[Android ImageView 的 onClickListener 不起作用](https://stackoverflow.com/questions/6083641/android-imageviews-onclicklistener-does-not-work)

# parsing - Bison 解析器不会提前获取令牌

> ID：10067583
> 
> 赞同：0
> 
> 时间：2012-04-09T00:03:34.900
> 
> 标签：parsing, bison, lookahead

我有以下解析器语法（这是一个小示例）：

```
expr:
        ident assignop expr
        {
            $$ = new NAssignment(new NAssignmentIdentifier(*$1), $2, *$3);
        } |
        STAR expr %prec IDEREF
        {
            $$ = new NDereferenceOperator(*$2);
        } |
        STAR expr assignop expr %prec IDEREF
        {
            $$ = new NAssignment(new NAssignmentDereference(*$2), $3, *$4);
        } |
        ... ;

...

assignop:
        ASSIGN_EQUAL |
        ASSIGN_ADD |
        ASSIGN_SUBTRACT |
        ASSIGN_MULTIPLY |
        ASSIGN_DIVIDE ; 
```

现在我正在尝试解析以下任何一行：

```
*0x8000 = 0x7000;
*mem = 0x7000; 
```

但是，Bison 一直看到“*mem”并减少了“STAR expr”规则，并且没有执行前瞻来查看“STAR expr assignop...”是否匹配。据我了解野牛，它应该做这个前瞻性。我最接近的猜测是 %prec 正在关闭前瞻或类似的奇怪东西，但我不明白为什么会这样做（因为 prec 值是相等的）。

在这种情况下，如何让它执行前瞻？

**编辑：**

遇到'STAR expr'时进入的状态是：

```
state 45

   28 expr: STAR expr .
   29     | STAR expr . assignop expr
   35     | expr . binaryop expr

    $default  reduce using rule 28 (expr)

    assignop  go to state 81
    binaryop  go to state 79 
```

所以我不明白为什么它可以选择 assignop 时选择 $default （请注意，在这种情况下，parser.y 文件中规则的顺序不会影响它选择哪一个；我已经尝试重新排序 assignop 一个高于标准的'STAR expr'）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T01:40:38.043

如果`IDREF`优先级高于`ASSIGN_EQUAL`,等，就会发生这种情况。具体来说，在这种情况下，使用原始解析器（在应用优先级之前），您在规则和各种XXX 标记`ASSIGN_ADD`之间存在移位/减少冲突。您拥有的优先规则解决了所有有利于减少的冲突。`expr: STAR expr``ASSIGN_`

in 状态是 goto，而`assignop`不是 shift 或 reduce，因此根本不进入前瞻或令牌处理 - goto 仅在某些令牌被移动然后减少到有问题的非终端后才会发生。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T05:32:48.957

我最终通过创建另一个规则“deref”来解决这个问题，如下所示：

```
deref:
        STAR ident
        {
            $$ = new NDereferenceOperator(*$<ident>2);
        } |
        STAR numeric
        {
            $$ = new NDereferenceOperator(*$2);
        } |
        STAR CURVED_OPEN expr CURVED_CLOSE
        {
            $$ = new NDereferenceOperator(*$3);
        } |
        deref assignop expr
        {
            if ($1->cType == "expression-dereference") // We can't accept NAssignments as the deref in this case.
                $$ = new NAssignment(new NAssignmentDereference(((NDereferenceOperator*)$1)->expr), $2, *$3);
            else
                throw new CompilerException("Unable to apply dereferencing assignment operation to non-dereference operator based LHS.");
        } ; 
```

用单个“deref”替换“expr”中的两个规则。

# javascript - 更新 Web 应用程序代码而不重新加载它

> ID：10067585
> 
> 赞同：-1
> 
> 时间：2012-04-09T00:04:29.977
> 
> 标签：javascript, web-applications

是否有任何方法或可能性来更新应用程序代码并让客户在不重新加载应用程序/网站的情况下采用它？我的意思是更新实时应用程序代码，例如添加或删除功能。

iPad 每隔 24 小时就全屏 Web 应用程序请求用户许可，而对于原生应用程序则不需要。一旦您授予权限，它就不会再次询问，但如果您重新加载应用程序（您通常在推送更新时必须这样做），它会再次询问 24 小时是否已过。

我们正在将 iPad 安装到出租车上，并希望使用地理位置数据跟踪城市周围的连接情况，但我们无法可靠地做到这一点，因为该应用程序会征求客人的许可。我们还想提供一些基于位置的功能，但我们不能这样做，因为如果一位客人说“不”，它将影响所有下一位客人，因为 iPad 只允许询问两次，然后您必须等待一段时间才能使用再次要求使用地理位置，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T00:10:39.400

通过更新代码，我认为您的意思是实时代码重新加载或更改页面上加载的模块而不更改它。

这需要你有一个基础设施库，允许你重新加载或添加代码模块到你的应用程序。[ncore](https://github.com/raynos/ncore)允许这样做

接下来，您将需要来自服务器或其他远程端点的通信通道，以将新模块或模块重新加载命令发送到客户端浏览器。

概念是您打开了一个 websocket 并发送了两个命令之一

*   添加模块：网址
*   重新加载模块：名称

然后，浏览器中的应用程序将从 url 加载并添加该模块或重新加载该模块。

这基本上是对用户浏览器中应用程序状态的远程控制。

# php - Creating/Saving an inline base64 encoded image

> ID：10067588
> 
> 赞同：0
> 
> 时间：2012-04-09T00:05:23.550
> 
> 标签：php, image, base64, gd

I am trying to create & save images from data in an email from the base64 data of an actual image that was in the html body that appears inline such as:

```
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAE=="> 
```

But i'm trying to create them sequentially, as there could be more than one image tag in the html body, where the variable $html_part is the html body of the email. I just need some assistance in coming to a solution on what i'm doing wrong.

```
 $img_tags = preg_match('/<img\s+(.*)>/', $html_part, $num_img_tags);
    $num_img_tags = count($num_img_tags);

    echo $html_part;
    for ($i = 1; $i <= $num_img_tags; $i++) {       
    preg_match('/<img\s+(.*)\s+src="data:image\/(.*);(.*),(.*)"\s+(.*)>/i', $html_part, $srcMatch);
{   
    foreach($srcMatch[4] as $im_data)
    {
        $ufname = "image0".$num_img_tags.".jpg";
        echo "<h1>$ufname</h1>";
            $im_data = base64_decode($im_data);
            $im = imagecreatefromstring($im_data);
            if ($im !== false) {
            header('Content-Type: image/jpeg');
            imagejpeg($im, $ufname);
            imagedestroy($im);
            }
            else {
            echo 'An error occurred.';
            }
    }

}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T00:24:04.760

Pretty sure you want to use a preg_match_all, not a preg_match

[http://php.net/manual/en/function.preg-match-all.php](http://php.net/manual/en/function.preg-match-all.php)

Also, solution using the above.

```
<?php

$html_part=<<<END
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAVFBMVEWcZjTcViTMuqT8/vzcYjTkhhTkljT87tz03sRkZmS8mnT03tT89vTsvoTk1sz86uTkekzkjmzkwpT01rTsmnzsplTUwqz89uy0jmzsrmTknkT0zqT3X4fRAAAAbklEQVR4XnXOVw6FIBBAUafQsZfX9r/PB8JoTPT+QE4o01AtMoS8HkALcH8BGmGIAvaXLw0wCqxKz0Q9w1LBfFSiJBzljVerlbYhlBO4dZHM/F3llybncbIC6N+70Q7OlUm7DdO+gKs9gyRwdgd/LOcGXHzLN5gAAAAASUVORK5CYII=">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAVFBMVEWcZjTcViTMuqT8/vzcYjTkhhTkljT87tz03sRkZmS8mnT03tT89vTsvoTk1sz86uTkekzkjmzkwpT01rTsmnzsplTUwqz89uy0jmzsrmTknkT0zqT3X4fRAAAAbklEQVR4XnXOVw6FIBBAUafQsZfX9r/PB8JoTPT+QE4o01AtMoS8HkALcH8BGmGIAvaXLw0wCqxKz0Q9w1LBfFSiJBzljVerlbYhlBO4dZHM/F3llybncbIC6N+70Q7OlUm7DdO+gKs9gyRwdgd/LOcGXHzLN5gAAAAASUVORK5CYII=">
END;

preg_match_all('/<img.*?src="data:image\/.*;.*,(.*)".*?>/i', $html_part, $img_tags, PREG_PATTERN_ORDER);

echo $html_part;
$img_num = 0;
foreach($img_tags[1] as $im_data)
{
    $ufname = "image0".$img_num.".jpg";
    echo "<h1>$ufname</h1>";
    $im_data = base64_decode($im_data);
    $im = imagecreatefromstring($im_data);
    if ($im !== false) {
        imagejpeg($im, $ufname);
        imagedestroy($im);
    }
    else {
        echo 'An error occurred.';
    }
    $img_num++;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T00:39:30.470

Your code is impossible - you cannot do a header() call after you've performed **ANY** output. You can also not output multiple images in the same 'document'. You also cannot output html (the `<h1>` stuff), images (`header('Content-type:...')`, etc... all within the same document.

As well, parsing/processing HTML with regexes is dangerous. A single malformation of the source document and your regexes will happily feast on garbage and produce garbage for you. Do not use regexes on html... every time you do, Alan Turing kills a kitten. Use a [DOM parser](http://php.net/dom) instead.

# r - 图例中的分数，多种颜色

> ID：10067590
> 
> 赞同：7
> 
> 时间：2012-04-09T00:05:57.703
> 
> 标签：r, graph

我需要创建一个复杂的图例，其中包括一个分数，并且分子和分母的颜色不同![传奇](../Images/ed3383a0cbfeef454eebeee80b56a51c.png)。

是否可以用（基础）R 创建这样的图例？

由于我必须在几个不同的图中添加这个图例，我不想手动编写文本，但能够自动将它添加为图例。它不一定是图例（虽然它会很方便），但是我不想手动输入每个元素的坐标。

有任何想法吗？！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-09T18:01:36.730

假设你有类似的东西：

```
d=1:10
plot(d,type="l") 
```

并且您不需要为分子和分母使用不同的颜色，您可以使用单线（包括@CarlWitthoft 的文本位置提示）来做到这一点：

```
text(0.5*max(d), 0.9*max(d), expression(Result == frac(Green, Blue)), cex=1.5) 
```

![在此处输入图像描述](../Images/a54f7904a3f51745450011b40a0f6556.png)

但是没有直接的方法来改变分子和分母的颜色。所以笨拙的方法是分别自定义每个元素：

```
text(0.4*max(d), 0.9*max(d), "Result =", cex=1.5)
text(0.55*max(d), 0.93*max(d), "Green", col="green", cex=1.5)
text(0.55*max(d), 0.87*max(d), "Blue", col="blue", cex=1.5)
segments(0.5*max(d), 0.9*max(d), 0.6*max(d), 0.9*max(d)) 
```

![在此处输入图像描述](../Images/8085dab2141395633ba8c2642be26aab.png)

我知道这不是你真正想要的，但以防万一没有更好的黑客出现......

# ruby - Sinatra 查询集合

> ID：10067598
> 
> 赞同：1
> 
> 时间：2012-04-09T00:08:21.430
> 
> 标签：ruby, sinatra

我是 Sinatra 的新手，我正试图弄清楚如何在模板中查询集合。在这个特定的例子中，我试图找出在一个特定的对象集合（`c`在这个例子中）中是否有一个具有特定值的对象。

```
<% if c.votes #then filter by an id for example through all of the objects...  %>
    yes, it exists
<% else %>
    nope, doesn't exist
<% end %> 
```

另外，我习惯了 django 的过滤器，是否有类似的在线文档概述了 Sinatra 的各种查询功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T01:25:55.513

它只是一个标准集合吗？您可以使用 any?，如果提供的块找到匹配项，则返回 true。然后，您将测试每个对象在该块中查找的值。

```
<% if c.votes.any? { |a| a.id == whatever } %>
 ...
<% else %>
 ...
<% end %> 
```

这实际上取决于“投票”是什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T01:19:37.230

在 rails 你会使用`<% if c.votes.present? %>`which 是有帮助的，因为否则如果 c.votes 是一个空数组，则条件将评估为真。

在 Sinatra 中，您没有 .present?，但您有两个选择：`<% unless c.vote.empty? %>`或`<% if !c.votes.empty %>`. 我不喜欢任何一个选项的可读性，所以我会重新创建添加礼物？数组方法：

```
class Array
  def present?
    !empty?
  end
end 
```

你在哪里添加这个取决于你如何设置你的 Sinatra 应用程序。一种选择是将它直接添加到您的主应用程序文件中。

# php - 不引用脚本而是引用方法的 Html 操作

> ID：10067600
> 
> 赞同：1
> 
> 时间：2012-04-09T00:08:52.053
> 
> 标签：php, html

通常，当我处理表单时，在“action”参数中，我通常必须引用完整的 PHP 脚本，如下所示：

```
<form method="post" action="foo.php"></form> 
```

有没有办法告诉表单使用函数或方法而不必提及整个脚本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T00:15:01.427

不是我知道的，但我很确定你可以做这样的事情......

```
action="foo.php?fromForm=yes" 
```

然后在你的php代码中，你可以有这个......

```
if($_GET['fromForm'] == "yes") {
//put your function here, or call it here
}
else {
//rest of code goes here
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T00:22:50.220

想象你的表格看起来像：

```
<form name="form1" method="post" action="">
    <p>
        <label></label>
        <input type="text" name="textfield" id="textfield" />
    </p>
    <p>
        <label></label>
        <input type="submit" name="button" id="button" value="Submit" />
    </p>
</form> 
```

那么你可以把它放在 php 的顶部：

```
if (isset($_POST['textfield'])) {
    foo();
} 
```

替换`foo();`为您要执行的函数的名称。

这只是检查是否有任何表单数据发布到带有`name="textfield"`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T00:12:38.010

不，您指定的不是*脚本*，而是**URL**。HTML/浏览器不知道服务器端的功能或方法，只知道 URL。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T00:13:37.713

您可以使用该`onsubmit`属性来调用 javascript 方法：

```
<form method="post" onsubmit="doSomething()"></form> 
```

您还可以在将表单传递给脚本之前使用它来验证表单，例如：

```
<form method="post" action="foo.php" onsubmit="canSubmit()"></form> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-09T00:15:18.573

**注意：我假设您询问是否可以在服务器端访问 PHP 代码中的方法或函数，而不是在客户端调用 JavaScript 函数！**

客户端不能随意调用服务端的方法。资源的 URL 或路径用于标识服务器上的资源。

如果您想在同一个脚本中执行不同的功能，您可以使用 if/else 阻止并使用查询参数来区分您的 URL。

**HTML：**

```
 <form method="post" action="foo.php?method=saveData"></form> 
```

**PHP：**

```
<? /* foo.php */
    if($_REQUEST['method'] == "saveData") {

        // do stuff

    } else if($_REQUEST['method'] == "doSomethingElse") {
        // do other stuff

    }
?> 
```

这是一个非常基本的例子。对于更复杂的需求，许多框架可以执行这种级别的分支，开箱即用，并且更加复杂。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-09T00:15:23.180

如果你的 PHP 脚本是这样写的：

```
<?php
switch ($_GET ['f']) { 
  case 'do_one':
    // do something
    break;
  case 'do_two':
    // or use a callback
    do_two_callback ();
    break;
  default:
    // ...
}
?> 
```

...你总是可以做到这一点

```
<form method="post" action="foo.php?f=do_one"></form> 
```

# ruby-on-rails - 这个rails调用如何从一个id中获取一个对象？

> ID：10067602
> 
> 赞同：0
> 
> 时间：2012-04-09T00:09:46.607
> 
> 标签：ruby-on-rails

我有一个 User 模型和一个 UserMessage 模型（用于保存两个用户之间的私人消息的模型）

在我看来我有..

```
<% if @message_items.any? %>
    <ol class="messages">
        <%= render partial: 'message_item', collection: @message_items%>
    </ol>
    <%= will_paginate @message_items %>
<% end %> 
```

我用...渲染

```
<li id="<%= message_item.id %>">
    <span class="user">
        <%= link_to message_item.user.name, message_item.user %>
    </span>
    <span>
        <%= message_item.title %>
    </span>
    <span>
        <%= message_item.body %>
    </span>
</li> 
```

对象 UserMessage（来自 message_item）如何能够呈现 User 对象？我对 UserMessage 的设计只有以下属性“id、user_id、from_id、title、body、created_at、updated_at”。

我猜它来自user_id，并且rails以某种方式建立连接并能够从user_id中找到用户对象。那是对的吗？

但我真正想要的是来自 from_id 的用户（发送消息的人）。有没有办法找回它？我知道做类似的事情.. message_item.user.from_id 不起作用。

我能想到的唯一方法就是做

```
<%= User.find(id= message_item.from_id).name %> 
```

但这在我看来似乎不正确。抱歉，我被卡住了。帮助将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T00:47:22.733

您需要以下型号

```
class User < ActiveRecord::Base
  has_many :received_user_messages, 
             :class_name => "UserMessage", :foreign_key => :receiver_id

  has_many :sent_user_messages, :class_name => "UserMessage", 
             :class_name => "UserMessage", :foreign_key => :sender_id
end

class UserMessage < ActiveRecord::Base

  # should have sender_id and receiver_id columns
  # make sure you index these columns

  belongs_to :sender, :class_name => "User"   
  belongs_to :receiver, :class_name => "User"

end 
```

执行以下操作，列出用户**收到**的消息：

```
current_user.received_messages(:include => :sender).each do |message|
  p "[#{message.sender.name}]: #{message.content}"
end 
```

执行以下操作，列出用户**发送**的消息：

```
current_user.sent_messages(:include => :receiver).each do |message|
  p "[#{message.receiver.name}]: #{message.content}"
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T00:24:50.440

尝试这个：

在您的 UserMessage 类中，创建两个名为`sender`并`recipient`执行您想要的复杂查询的类方法。然后在您的视图中使用这些方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T00:24:56.863

首先，您需要设置关联。我猜一个用户有很多消息，一个消息属于一个用户。

添加到模型：

*应用程序/模型/user.rb*

```
has_many :user_messages 
```

*app/models/user_messages.rb*

```
belongs_to :user 
```

您可能需要在 user_messages 表中添加一列，称为`user_id`

当您在控制器中获取消息时，告诉 rails 立即加载关联的用户，因此 rails 以后不必这样做：

```
@message_items = UserMessage.includes( :user ).all 
```

现在您可以非常轻松地访问“拥有”消息的用户对象：

```
<%= message_item.user.name %> 
```

如果您需要用户拥有的所有消息，现在这也很容易：

```
@user = User.find( some_id )
@user.messages # this returns an array with all the message objects 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-09T00:26:04.397

我认为您正在为模型中的 belongs_to 寻找 foreign_key 选项。因此，您需要在 UserMessage 消息中指定类似于 sender/from 与 from_id 的关系

```
belongs_to :sender, foreign_key: :from_id, class_name: "User" 
```

然后在模板中，您只需在视图中调用此关系。

```
message_item.sender 
```

它应该与`message_item.user`.

如需进一步参考，请访问[协会文档](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#method-i-belongs_to-label-Options)

另外我建议你不要`.name`在模板中调用方法，而是在你的模型中指定 to_s 方法。klump 在他的回答中指出的好方法是使用`.include`方法来获得更好的性能。它将在加载数据时加载用户数据`UserMessage`，而不是在另一个查询中。

```
Article.find :all, :include => :revisions 
```

代码来自另一个答案[——Rails ActiveRecord：是否可以组合 :include 和 :conditions 查询？](https://stackoverflow.com/questions/2304766/rails-activerecord-is-a-combined-include-and-conditions-query-possible#answer-2304846)

# java - java.lang.RuntimeException：存根！- Android 代码覆盖率？

> ID：10067605
> 
> 赞同：6
> 
> 时间：2012-04-09T00:10:20.067
> 
> 标签：java, android, testing, code-coverage, android-testing

我正在使用 EclEmma 覆盖率工具来测试我的代码覆盖率。但是每当我运行我的测试用例时，它都会给我以下错误。你能告诉我如何解决这个错误。

![在此处输入图像描述](../Images/186953398c4c48439f05a2e2c319e437.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-11T13:53:49.707

我遇到了一个类似的问题：

```
java.lang.RuntimeException: Stub!

at junit.runner.Version.id(Version.java:5)
    at org.powermock.modules.junit4.PowerMockRunner.getJUnitVersion(PowerMockRunner.java:32)
    at org.powermock.modules.junit4.PowerMockRunner.<init>(PowerMockRunner.java:27 
```

我修复它的方法是在我的 Eclipse 项目的类路径中`junit.jar`前进。`android.jar`原因是`junit`和都`android`包含相同的包和类 for `junit.runner.Version`，所以当`android.ja`r 领先时，类加载器将从 加载这个类，`android.jar`但它应该从 下载它`junit.jar`，从而抛出异常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T09:11:36.830

我遇到了类似的问题。似乎是因为您将一个 android Jar 添加到您的项目中，而该项目不是一个 Android 项目。就我而言，我将我的项目更改为 Android 项目，它运行良好。

# c# - 如何接受来自文本框的输入

> ID：10067607
> 
> 赞同：0
> 
> 时间：2012-04-09T00:10:28.167
> 
> 标签：c#, winforms, mvp

我正在尝试在 C# windows 窗体中实现模型视图演示者模式。我尝试了几种不同的方法，但还没有弄清楚。当用户单击文本框时，是否有“接受”来自文本框的用户输入？如果没有，将数据传递给演示者的典型方法是什么？我可以使用文本框的 on_text_changed 事件，但是我对如何验证数据感到困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T09:25:48.683

我知道这个线程太旧了，但仍然。

```
public interface IProjectView
{
    string textBoxText{get;}
} 
```

在 ProjectView 中实现

```
public class ProjectView : IProjectView
{
    ProjectPresenter _presenter;

    public ProjectView()
    {
        _presenter = new ProjectPresenter(this);
    }

    string textBoxText
    {
        get
        {
            // Do validation if you want
            return textBox1.Text;
        }
    }
}

class ProjectPresenter
{
    IProjectView _view;
    public ProjectPresenter(IProjectView view)
    {
        _view = view;
    }

    public void AnyMethod()
    {
        // Access value of textbox as _view.txtTextBoxText
    }
} 
```

代码未经测试，但应该可以正常工作。

关于验证，在 ProjectView 中实现属性时，在返回值之前进行验证。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T00:45:28.553

我认为这里很容易使用**MSDN**`TextBox`链接，这些链接用代码说明了类的功能。

[**TextBoxBase.Text 属性**](http://msdn.microsoft.com/en-us/library/k6w057xy.aspx)

& 验证使用： [**Control.Validated 事件**](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.validated.aspx)

希望能帮助到你！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T01:20:43.287

你会想听`Leave` [事件](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.leave.aspx)。当文本框失去焦点时会发生这种情况；之后，您可以进行验证。

# spring - spring mvc 应用程序的 beans 标签下的属性

> ID：10067610
> 
> 赞同：1
> 
> 时间：2012-04-09T00:10:41.633
> 
> 标签：spring, spring-mvc

我在下面阅读了一个bean代码`spring-app.xml`

```
<bean id="mySessionFactory"
            class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
        <property name="dataSource" ref="myDataSource" />
        <property name="annotatedClasses">
            <list>
                <value>com.mmi.education.dao.User</value>
            </list>
        </property>
        <property name="hibernateProperties">
            <props>
                <prop key="hibernate.dialect">org.hibernate.dialect.MySQLDialect</prop>
                <prop key="hibernate.show_sql">true</prop>
                <prop key="hibernate.hbm2ddl.auto">create</prop>
            </props>
        </property>
    </bean> 
```

而不是属性**annotatedClasses**，我想指定包。

是否可以？

还有哪些可以在 bean 标签下指定的有效属性？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T00:49:59.163

```
<property name="packagesToScan">
        <list>
            <value>com.mmi.education.dao</value>
        </list>
    </property> 
```

[在此处](http://static.springsource.org/spring/docs/2.5.x/api/org/springframework/orm/hibernate3/annotation/AnnotationSessionFactoryBean.html)查看 Spring 的文档以获取其他属性。

# ios - 使用坐标验证像素 (iOS)

> ID：10067616
> 
> 赞同：0
> 
> 时间：2012-04-09T00:12:47.277
> 
> 标签：ios, uiimage, cgimage

在我看来，我的子视图很少。这是 UIImageView。

每个 UIImageView 都包含带有 alpha 通道的图像。

这是一张图片： ![在此处输入图像描述](../Images/b592a802ce26111e3ef4dfab7b9c4bf2.png)

我使用下面的这种方法来检测我在位置视图中的触摸：

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{   

    UITouch *touch = [[event allTouches] anyObject];
    CGPoint touchLocation = [touch locationInView:self.view];

    NSArray *views = [self.view subviews];

    for (UIView *v in views) {
        if([v isKindOfClass:[Piece class]]){
            if (CGRectContainsPoint(v.frame, touchLocation) && ((Piece *)v).snapped == FALSE) { 

                UITouch* touchInPiece = [touches anyObject]; 
                CGPoint point = [touchInPiece locationInView:(Piece *)v];
                BOOL solidColor = [self verifyAlphaPixelImage:(Piece *)v atX:point.x atY:point.y];

                if (solidColor) {                    
                    dragging = YES;
                    oldX = touchLocation.x;
                    oldY = touchLocation.y;
                    piece = (Piece *)v;
                    [self.view bringSubviewToFront:piece];
                    break;
                }              

            }
        }
    }
} 
```

以及这种验证 alpha 像素的方法

```
- (BOOL)verifyAlphaPixelImage:(Piece *)image atX:(int)x atY:(int)y{

    CGImageRef imageRef = [image.image CGImage];
    NSUInteger width = CGImageGetWidth(imageRef);
    NSUInteger height = CGImageGetHeight(imageRef);
    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();
    unsigned char *rawData = malloc(height * width * 4);
    NSUInteger bytesPerPixel = 4;
    NSUInteger bytesPerRow = bytesPerPixel * width;
    NSUInteger bitsPerComponent = 8;
    CGContextRef context = CGBitmapContextCreate(rawData, width, height,
                                                 bitsPerComponent, bytesPerRow, colorSpace,
                                                 kCGImageAlphaPremultipliedLast | kCGBitmapByteOrder32Big);
    CGColorSpaceRelease(colorSpace);    
    CGContextDrawImage(context, CGRectMake(0, 0, width, height), imageRef);
    CGContextRelease(context);    
    // Now your rawData contains the image data in the RGBA8888 pixel format.
    int byteIndex = (bytesPerRow * y) + x * bytesPerPixel;
    //    CGFloat red   = (rawData[byteIndex]     ) ;
    //    CGFloat green = (rawData[byteIndex + 1] ) ;
    //    CGFloat blue  = (rawData[byteIndex + 2] ) ;
    CGFloat alpha = (rawData[byteIndex + 3] ) ;   
    NSLog(@"%f", alpha);
    free(rawData);    
    if(alpha==255.0) return NO;
    else return YES;

} 
```

如果创建了 alpha 像素，我需要触摸 UIImageView 下面的其他 UIImageView，我之前有 tapp 的。

例如，如果我堆叠了 UIImageView 并且我先触摸：

现在我应该先验证 UIImageView

如果我触及 alpha 像素 - > 我应该使用这个坐标移动到下一个 UIImageView 并验证它是否为 alpha 像素。

如果第二个 3、4 或 5 没有我的坐标的 alpha 像素，我应该选择这个 UIImageView。

现在我验证我的像素 - 但我的方法返回错误值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T04:27:45.710

1.  在讨论[如何从 UIImage (Cocoa Touch) 或 CGImage (Core Graphics) 获取像素数据？](https://stackoverflow.com/a/1262893/1318452)，对您正在使用的例程进行了更正。使用 calloc 而不是 malloc，否则您将开始得到任意结果。
2.  如果您的`Piece`班级曾经缩放图像，您将需要按图像显示的比例缩放其 x 和 y 输入。
3.  该`touchesBegan`方法奇怪地查看了它包含的其他视图，而不是它本身。是否有一个原因？上什么课`touchesBegan`？
4.  子视图以从后到前的绘制顺序存储，因此当您遍历子视图时，您将首先查看（并可能选择）最后面的对象。而是从 的最后一个元素`subviews`向前迭代。
5.  即使在这个工作之后，它也会非常低效，每次用户点击时都会渲染每个 Piece 图像。您最终会希望缓存每个 Piece 的像素数据以便快速查找。

# datatable - 如何将参数从数据表传递给嵌入式音乐播放器？VB.net

> ID：10067618
> 
> 赞同：1
> 
> 时间：2012-04-09T00:13:08.230
> 
> 标签：datatable, media-player, audio-player, playlists

我有一个小型音乐网站，您可以在网格视图中查看歌曲并播放/下载它们。现在我想通过嵌入式音乐播放器播放。当我用谷歌搜索时，有很多嵌入式音乐播放器和示例，但其中大多数只是说要播放的歌曲的固定 URL。我无法从我目前拥有的 gridview 中找出如何将参数传递给嵌入式音乐播放器。

我现在拥有的。Song_Name 表示数据表中 Uploads 文件夹中 mp3 文件的名称。

```
 <asp:GridView ID="gridview1" runat="server" AutoGenerateColumns="False" >
        <Columns>
         <asp:HyperLinkField DataNavigateUrlFields="Song_Name" Target="_blank"
            DataNavigateUrlFormatString='~/Uploads/{0}' Text="&lt;img src='Images/play.png' border='0'/&gt;" >             
         </asp:HyperLinkField>          
         </Columns>                
        </asp:GridView> 
```

代码背后

```
 On PageLoad
           Dim dtable = GetSong()
            gridview1.datasource = dtable
             gridview1.databind() 
```

我可能会使用的简单嵌入式播放器代码。

```
 <embed type=”application/x-shockwave-flash” flashvars=”audioUrl=MP3_FILE_URL”
          src=”http://www.google.com/reader/ui/3523697345-audio-player.swf” width=”400″ height=”27″ 
         quality=”best”&gt;</embed> 
```

在此示例中，我必须将 gridview 中的 Song_Name 文件名 + 固定 URL（例如[http://www.mysite.com/uploadds/Song_Name](http://www.mysite.com/uploadds/Song_Name)）传递给嵌入式播放器的 audioUrl。我该怎么做 ？基本上，如果用户单击每首歌曲的网格视图上的播放按钮，我想使用嵌入式音乐播放器来播放歌曲。请参阅 girdview 示例。Playbutton 是上面代码中的超链接字段。抱歉英语不好。:D

非常感谢。

大号

![网格视图示例](../Images/638209f95f31e5cf1158894c7cc55bc5.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T09:07:21.980

没有人回答我的问题。我不确定我的问题是否不够清楚，人们无法理解。好吧，我终于找到了解决问题的方法。所以我想分享我的解决方案。希望它对需要大量使用 Gridview 的其他人有所帮助。

为此，我必须在 gridview 中放置一个隐藏标签字段

```
 <ItemTemplate>
    <asp:Label ID="lblSongNam" Visible="false" runat="server" Text='<%#Eval("Song_Name") %>'></asp:Label>
    </ItemTemplate> 
```

而且您还需要一个空的 Div，您希望嵌入式音乐播放器在其中显示为

```
 <div id="musicplayer"  runat="server"></div> 
```

必须为 Div 放置 runat="server" 属性。

在 Gridview rowcommand 后面的代码中

```
 Dim indexx As Integer = Convert.ToInt32(e.CommandArgument)
        Dim roww As GridViewRow = GridView1.Rows(indexx)
        Dim usernamee As String = Page.User.Identity.Name
        Dim Song_Namee As String = (DirectCast(roww.FindControl("lblSongNam"), Label)).Text
        Dim str As New StringBuilder()
        str.Append("<embed type='application/x-shockwave-flash'    flashvars='audioUrl=http://www.mysite.com/songs/")
        str.Append(Song_Namee)
        str.Append("&autoPlay=true' src='http://www.google.com/reader/ui/3523697345-audio-player.swf'")
        str.Append(" width='700' height='27' quality='best'></embed>")
        musicplayer.InnerHtml = str.ToString 
```

在这个例子中，我使用了 google flash 音频播放器，但播放器当然可以是任何东西。使用 StringBuilder 和服务器端 Div 使用 Div 的 InnerHtml 属性并在运行时更改内容，这是从 asp.net 代码后面操作 HTML 或 Javascript 代码的非常方便的方法。

谢谢大家，

大号

# wpf - 找不到 EventTrigger.SourceName

> ID：10067621
> 
> 赞同：2
> 
> 时间：2012-04-09T00:14:14.160
> 
> 标签：wpf, animation, storyboard, eventtrigger

```
<Canvas>
    <Button Name="b1" Content="Button"/>
    <Rectangle Name="Mr1" Fill="Black">
        <Rectangle.Triggers>
            <EventTrigger SourceName="b1" RoutedEvent="Button.Click">
                <BeginStoryboard>
                 <code.../>
                </BeginStoryboard>
            </EventTrigger>
        </Rectangle.Triggers>
    </Rectangle>
</Canvas> 
```

* * *

错误：找不到b1。

请帮帮我，谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2017-03-01T00:52:46.743

我只是面临同样的问题..为其他感兴趣的人发布解决方案。

```
<Canvas>

    <Canvas.Resources>
        <Storyboard x:Key="MyAwesomeAnimation" Storyboard.TargetName="Mr1" Storyboard.TargetProperty="Height">
            <!-- Some Awesome animation here..-->
        </Storyboard>
    </Canvas.Resources>

    <Button Name="b1" Content="Button">
        <Button.Triggers>
            <!--The key is to define the click trigger on the button. Why should the rectangle know about the button?-->
            <EventTrigger RoutedEvent="Button.Click">
                <BeginStoryboard Storyboard="{StaticResource MyAwesomeAnimation}"></BeginStoryboard>
            </EventTrigger>
        </Button.Triggers>
    </Button>

    <Rectangle Name="Mr1" Fill="Black" />

</Canvas> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T00:17:07.120

> 您可以将此属性设置为应用触发器集合（此触发器所属的集合）范围内的任何元素的名称。这通常是**包含此 Trigger 的模板中**的命名元素。

# google-app-engine - 如何从 Google App Engine (Python) NDB/Datastore 中的子实体查询父实体？

> ID：10067624
> 
> 赞同：12
> 
> 时间：2012-04-09T00:15:14.150
> 
> 标签：google-app-engine, google-cloud-datastore, python-2.7, app-engine-ndb

我的问题非常基础，我想知道在 App Engine Python 中从子实体访问父实体属性值的直接和正确方法。例如，我有以下模型架构。我正在使用 Python 2.7 和 NDB。

```
class Gallery(ndb.Model):
    category    = ndb.StringProperty()
    title       = ndb.StringProperty()
    subtitle    = ndb.StringProperty()

class Image(ndb.Model):
    blob_key    = ndb.BlobKeyProperty()
    title       = ndb.StringProperty()
    gallery     = ndb.StringProperty()
    is_slider   = ndb.StringProperty() 
```

这里“Gallery”是“Image”的父级。它们形成了一个实体组展览=>画廊=>图像。我想显示图像模型中的图像以及它们所属的画廊细节。我可以从父实体（图片来自画廊）访问子实体，但反之则不行。我不想在 Gallery 模型中使用 Image 模型作为 StructuredProperty。我大部分时间都在基于画廊以外的其他标志显示所有图像的图像（一种情况是如果 is_slider="yes" 从所有图像生成幻灯片。所以直接从图像查询）但仍然想显示相关画廊的信息为什么我想知道如何访问父数据。

我觉得这是一个非常普遍的问题，寻找一个简单的解决方案，比如直接访问父级，而不是回到实体组的顶部并使用一些复杂的逻辑查询 Gallery 模型。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-04-09T00:36:34.787

采用：`image_instance.key.parent().get()`

[https://developers.google.com/appengine/docs/python/ndb/keyclass#Key_parent](https://developers.google.com/appengine/docs/python/ndb/keyclass#Key_parent)

# c++ - 面向对象的类设计 - Mixin 类 - 确定有效的类结构

> ID：10067628
> 
> 赞同：0
> 
> 时间：2012-04-09T00:15:44.747
> 
> 标签：c++, oop

我正在为我的公司设计一个库存类型系统，我有几种不同类型的产品。其中一些是两种或多种类型的组合：

**基础类型**：项目

**Mixin 类**：MA、MB、MC、MAB

**派生类型**：

一个（MA+项目），

B (MB+项目),

C (MC+物品)

**和包装的零件，它们是**：

A+B（MAB + 项目）

A+B+C (单克隆抗体 + C)

*我将来需要能够在这个层次结构中添加更多内容。

我正在考虑使用 Mixin 类，其中每个单独的部分都派生自 Item 和一个 Mixin 类。我以前从未真正成功地编写过层次结构。我真的很想知道是否有人认为这是设计这样一个系统的好方法？如果没有，还有其他想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T01:06:25.797

多重继承可能会导致不太复杂的代码。

由您决定哪个更简单：

```
class MyItem : public MA<MB<C> > {}; // I'm not sure how your mixin syntax works. 
```

或者：

```
class MyItem: public A, public B, public C {}; // multiple inheritance 
```

# ruby-on-rails - Git bisect rails 应用程序

> ID：10067632
> 
> 赞同：0
> 
> 时间：2012-04-09T00:16:25.407
> 
> 标签：ruby-on-rails, git

可以`git bisect`在带有导轨的自动模式下使用吗？

的文档`git bisect`展示了它如何与 Linux 内核一起使用`git bisect run make`

对于导轨，这应该是`git bisect bundle exec rake spec`. 但是如何知道 bisect 何时出现错误？由于 RSpec 最终包含在 Bundler 中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T01:57:43.157

当 rake 没有成功运行时，它会返回一个非零的退出代码，这就是 git bisect 用来确定是否存在错误的方法。

现在，如果您的测试没有发现错误，那么 git bisect 将无济于事 --- 因为每次运行时，rake 都会返回干净。

因此，您可能想要编写一个在源代码控制之外运行的测试，并找出它第一次开始失败的时间。

# scheme - 方案中的 n 位 ALU

> ID：10067633
> 
> 赞同：1
> 
> 时间：2012-04-09T00:16:28.353
> 
> 标签：scheme, racket, alu

我在方案中制作 n 位 ALU，到目前为止我有一个 1 位 ALU。有人可以告诉我如何解决这个问题吗？以下是它的说明：

> 程序的格式是
> 
> ```
>  (ALUn selection x1 x2 n) 
> ```
> 
> 其中第一个参数`selection`可以采用任何值：`'add`, `'sub`, `'and`, `'or`, 或`'xor`. 第二个和第三个参数`x1`和`x2`是列表格式的两个 n 位二进制数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T12:31:31.297

这是与或异或的代码：

```
(define (ALUn selection x1 x2 n)
  (cond
    [(or (not (= (length x1) n)) (not (= (length x2) n))) (error "Wrong register length!")]
    [(equal? selection 'and) (map bitwise-and x1 x2)]
    [(equal? selection  'or) (map bitwise-ior x1 x2)]
    [(equal? selection 'xor) (map bitwise-xor x1 x2)])) 
```

您应该弄清楚如何自己添加和子！

# php - 在同一页面上而不是在另一页面上输出

> ID：10067634
> 
> 赞同：0
> 
> 时间：2012-04-09T00:17:03.830
> 
> 标签：php, phpmyadmin

伙计们很抱歉这么菜鸟，但我仍然从我的 php 开始，我想做的是将结果放在同一页面上。

```
<html>

<body>

<?php

error_reporting(E_ALL ^ E_NOTICE);

$button=$_POST['button_validate'];

if(isset($button)){

   error_reporting(E_ALL ^ E_NOTICE);
   $text=$_POST['text_validate'];

   if(empty($text)){
       echo "your email must have at least 1 number";
   } else {
       echo "this is valid";
   }
} else {
?>
<form action="validate.php" method="post">

Validate text<input type="text" name="text_validate">

<input type="submit" value="Validate" name="button_validate">

</form>

<?php } ?>

</body>

</html> 
```

但不是在同一页面上显示输出，而是在创建一个新页面..是否有关于如何在同一页面上输出它的代码或它只是在逻辑中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T01:41:22.917

我认为在您的表单中，您已将操作指定为 validate.php。

```
<form action="validate.php" method="post"> 
```

这意味着当您提交表单时，您的页面将由页面 validate.php 处理

如果您可以删除 action 属性，您的页面将由当前页面处理。

```
<form method="post"> 
```

看起来您已经在该页面上设置了一些验证，所以现在当您提交表单时，您的 php 逻辑将被处理。

* * *

同样正如 Sheikh Heera 所提到的，如果您将表单移出条件标签，则可以在发布后显示您的表单。在下面的示例中，我只是删除了 else 子句，因此即使您提交表单，它们也会显示出来。不确定你是否想要这个。

```
<body>

<?php

error_reporting(E_ALL ^ E_NOTICE);

$button=$_POST['button_validate'];

if(isset($button)){

   error_reporting(E_ALL ^ E_NOTICE);
   $text=$_POST['text_validate'];

   if(empty($text)){
       echo "your email must have at least 1 number";
   } else {
       echo "this is valid";
   }
}
?>

<form method="post">

Validate text<input type="text" name="text_validate">

<input type="submit" value="Validate" name="button_validate">

</form>

</body> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T06:11:50.320

尝试在您的表单标签中执行此操作：

```
<form method="post" action=""> 
```

那么您的数据将被提交到同一页面。我希望这有帮助。

# php - 第 9 行出现意外的 T_ELSE

> ID：10067636
> 
> 赞同：-3
> 
> 时间：2012-04-09T00:17:22.977
> 
> 标签：php, session

**我的 php 文件的片段**

```
session_start(); // Bring in old sessionID
$sess_id = session_id(); // assign old session variable to $sess_id var

if(empty($sess_id)){    # If no sessionID redirect back home.
    header('Location: ../index.php');
}

else(!empty($sess_id)){ 
```

**文件中的第 9 行：** `else(!empty($sess_id)){`

为什么要扔这个？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T00:18:57.633

语句的 if 和 else 之间不能有任何内容：

```
if ($condition) {
    doSomething();
}
// Nothing can go here!
else {
    doSomethingElse();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T00:19:19.447

和`echo`之间不能有一个。把它拿出来。`if``else`

```
if(empty($sess_id)) {    # If no sessionID redirect back home.
    header('Location: ../index.php');
} else { 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T00:28:24.647

```
session_start(); // Bring in old sessionID
$sess_id = session_id(); // assign old session variable to $sess_id var

if(empty($sess_id)){    # If no sessionID redirect back home.
    header('Location: ../index.php');
}

else(!empty($sess_id)){ 
```

将其更改为

```
else if(!empty($sess_id)){ 
```

简单的修复:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T00:39:26.247

或者使用多个带有 die() 的 if 语句，例如：

```
session_start(); // Bring in old sessionID
$sess_id = session_id(); // assign old session variable to $sess_id var

if(empty($sess_id)){    # If no sessionID redirect back home.
    die(header('Location: ../index.php')); #Stop script and go to ../index.php
}

if(!empty($sess_id)){
....
die('some.php');
}

....other statements..... 
```

# spring - 我可以在创建节点时在 neo4j 图中手动设置 nodeId 吗？

> ID：10067638
> 
> 赞同：1
> 
> 时间：2012-04-09T00:17:39.157
> 
> 标签：spring, generator, neo4j, spring-data-graph

我正在开发一个 Facebook 应用程序，在该应用程序中我使用我的 Facebook 帐户登录，Facebook 将我的 Facebook 数据作为 JSON 返回给我一个 JSON，我将其投影到 User.class（我）中，如下所示：

```
@NodeEntity public class User{ @GraphId Long NodeId; String facebook_id; String facebook_name; } 
```

然后我这样做了，`template.save(me);` 这在图中创建了一个具有 2 个属性的节点： Example:`facebook_id="1000023453464"`并且`name="John Smith"`nodeId 由 neo4j: Example 自动设置`nodeId:1`。

问题是当我再次登录时，它会创建另一个具有相同属性和 nodeId:2 的节点。

我通过在将用户保存在图表中之前检查用户是否已经存在于图表中来避免这种情况，如下所示：

```
User retrieved_user = userRepository.findByFacebook_id(me.getFacebook_id()); 
if(retrieved_user != null) { me.setNodeId(retrieved_user.getNodeId()); } 
```

现在，每当我登录时，它都不会创建重复节点，它只会更新现有节点上的属性。

但这不是我要寻找的，因为当我导入其他数据（例如可以创建大约 1000 个节点的朋友列表）时，我不希望我的应用程序在它之前检查每个单独的节点是否存在于数据库中保存它。

我的观点是：如果有一种方法可以在我`template.save(me)`解决问题之前手动设置 nodeId，并且我的应用程序不必检查节点是否存在于图中。因此，如果这是可行的，请帮助我实现它。我尝试了例如`setHighId(215431323)`，但我得到了例外。我尝试`@Override`了 IdGenerator、EntityIdGenerator 等但没有成功。

如果有另一种方法可以保存用户而无需检查它们是否存在并避免重复节点，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T10:09:36.117

我认为没有办法手动设置 id。但即使有，您仍然必须检查您的节点是否存在。反正检查一个节点的存在并没有那么昂贵，它只是一个索引检查，所以它应该是 O(log n)。

# objective-c - NSNotifications 的最佳实践

> ID：10067640
> 
> 赞同：1
> 
> 时间：2012-04-09T00:18:31.027
> 
> 标签：objective-c, ios, design-patterns

在我正在编程的游戏中，我为游戏中的所有实体使用复合对象。实体由组件对象组成，这些组件对象定义了小块功能，例如健康或运动。

我的问题是：

是否可以从组件发布通知，但将其父实体引用为发送通知的对象？

我很想这样做，因为向实体添加观察者更容易，而不是在实体中找到正确的组件。

有人告诉我，您永远不应该为另一个对象发布通知。

优缺点都有什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T00:27:26.833

通常你认为通知是“来自”一个对象。因此，如果您正在调试并且想要查找通知的来源，您可以在该对象本身中查找代码。

违反这种期望并不违法，但是当他们不得不更加努力地寻找通知的真正来源时，它可能会让某人有点诅咒你。

此外，如果您有很多单独的组件都发布通知，那么如果您想更改通知（例如，其中的 userInfo），重构代码会变得更加困难。

如果您可以保证您的组件始终具有指向其父级的有效指针，那么最好的解决方案是让组件要求其父级发布通知：

```
@implementation ComponentA

- (void)someMethod
{
     [self.parent pleasePostSomethingChangedNotification];
}

@end

@implementation Parent

- (void)pleasePostSomethingChangedNotification
{
     // Parent may post the notification immediately,
     // or may selectively post the notification based on some other condition,
     // or post it later on after coalescing changes from several components, 
     // or ...
}

@end 
```

# algorithm - 坚持我的作业来证明或反驳 h(f(n)) = O (h(g(n)))

> ID：10067642
> 
> 赞同：0
> 
> 时间：2012-04-09T00:18:34.973
> 
> 标签：algorithm, big-o, big-theta

我理解大哦和theta。问题如下，证明或反证： f(n) = theta(g(n) => h(f(n)) = O(h(g(n))) 如果 h(n) 是一个递增函数. h(n1) > h(n2) 当 n1 > n2

所以，在上面的问题中，我停留在理解递增函数的点上。如果我试图找到一些函数来反驳它，例如，n 和 2n 这可以接受吗？becos big-oh 代表快速增长，而不仅仅是一个常数因子，但没有定义 h(n) 函数的这种条件（我的意思是，我认为 > 字面上比这里大，这是错误的吗？）

另外，即使我发现像 h(f(n)) 这样的东西以与 h(g(n)) 相同的速度增长，这意味着它们本质上是 theta，它们仍然很大吗？因为 theta 的松散界限很大，在这种情况下，我永远无法反驳上述说法。

如果我的理解在通过序列时的某个时刻出现偏差，请纠正我。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T17:26:58.397

我找到了一个矛盾的例子来解决这个问题，通过采用`f(n) = 2n`并且`g(n) = n`满足给定的`f(n) = theta(g(n))`.

现在，让`h(x) = 2^x`，这意味着`h(f(n)) = 2^2n = 4^n`和`h(g(n)) = 2^n`。

根据定义，这意味着`h(g(n)) = O(h(f(n)))`. 因此被反驳。

我从来不知道矛盾的例子足以反驳。我正在尝试一种更正式的方式来证明这一点，但我却搞砸了细节。

谢谢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T04:42:42.157

我总是通过重新阅读然后写下 Theta(f) 和 O(f) 的定义来开始这样的问题。如果你能找到一个反驳这个断言的简单例子，你就不需要证明任何东西。我喜欢快速增长的 h(x) 的想法，例如 h(x) = 2^x。那么如果你有例如 f(x) = 2x, g(x) = x, h(f(x)) = 2^(2x), h(g(x)) = 2^x 和 h(f(x )) / h(g(x)) = 2^x - 尝试将这些插入到您的定义中，看看会发生什么。请注意，由于 f(x) = 2g(x)，至少根据我的定义，你有 f(x) = Theta(g(x)) 和 g(x) = Theta(f(x))

# jquery - 通过 AJAX 加载图像滑块

> ID：10067647
> 
> 赞同：0
> 
> 时间：2012-04-09T00:19:20.193
> 
> 标签：jquery, ajax, slider

我正在尝试通过 AJAX 加载图像滑块。输入包含滑块的页面的直接 url 时，它可以正常工作。但是当尝试通过 AJAX 加载它时，它不会加载。

```
$('.ajaxed').live('click', function(event) { // loading page via AJAX
    event.preventDefault();
    var link = $(this).attr('href')+' #content'; // jQuery address variables
    var rewritepath = link.replace($url,'').replace(' #content',''); // jQuery address variables
    $('#board').load(link,'', function(){   
        $('html,body').delay(500).animate({scrollTop: 0}, 300, function() {
            $('#board').slideDown('slow');
        });
    });
    $.address.state($path).crawlable(true).value(rewritepath); // jQuery address
    return false;
});
$slider.royalSlider({
    captionShowEffects:["fade"],
    controlNavThumbs:true,  
    controlNavThumbsNavigation:true,        
    imageAlignCenter:true,
    imageScaleMode: "fill",
    welcomeScreenEnabled:false,
    hideArrowOnLastSlide:true,
    autoScaleSlider: true,
    autoScaleSliderWidth: 980,
    autoScaleSliderHeight: 650
}); 
```

如果我将滑块代码放入 .ajaxed 部分，它只能使用 AJAX 而不是直接加载页面时。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T01:36:59.630

你可以把滑块初始化代码放在一个函数中，然后你可以从任何你想要的地方调用它。例如：

```
$('.ajaxed').live('click', function(event) { // loading page via AJAX
    event.preventDefault();
    var link = $(this).attr('href')+' #content'; // jQuery address variables
    var rewritepath = link.replace($url,'').replace(' #content',''); // jQuery address variables
    $('#board').load(link,'', function(){   
        $('html,body').delay(500).animate({scrollTop: 0}, 300, function() {
            $('#board').slideDown('slow');
        });
        init_slider();
    });
    $.address.state($path).crawlable(true).value(rewritepath); // jQuery address
    return false;
});

init_slider();

function init_slider() {
    $slider.royalSlider({
        captionShowEffects:["fade"],
        controlNavThumbs:true,  
        controlNavThumbsNavigation:true,        
        imageAlignCenter:true,
        imageScaleMode: "fill",
        welcomeScreenEnabled:false,
        hideArrowOnLastSlide:true,
        autoScaleSlider: true,
        autoScaleSliderWidth: 980,
        autoScaleSliderHeight: 650
    });
} 
```

# c - 有人能澄清一下我对 C 字符串、数组与指针的混淆吗

> ID：10067650
> 
> 赞同：0
> 
> 时间：2012-04-09T00:19:48.323
> 
> 标签：c, arrays, string, char

只是一个快速的问题。

我可以写

```
char string[] = "Hello world";
char *p = string;

printf("%s", p); 
```

并将其打印`Hello world`为输出。但是指针在这里是如何工作的呢？

数组中的每个点都有一个单独的内存位置，对吧？所以字符串数组长度为 12，将占用 12 个内存空间。我认为指针只能指向一个内存位置，而不是 12。指针 p 是如何实现这一点的？

使用普通数组和指针，如果你想缩放你做 *p++ 的数组，因为你正在遍历每个内存位置并打印它的值。为什么你必须在那里一个一个地遍历数组，但在这里它只是指向整个事物？

在我看来，就像使用一个（int 数组）一样，您正在递增指针，因为每个指针只能指向一个内存位置，但是对于 char 数组，它可以以某种方式指向所有这些位置。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T00:22:14.640

没错，指针只能指向一个内存位置。处理数组时，指针指向第一个元素的位置。当您使用`printf`时，它基本上采用指针（指向字符串的第一个元素），并打印直到到达空终止字符`\0`.

这是c中指针与数组的一个很好的解释：

[http://www.cs.bu.edu/teaching/cpp/string/array-vs-ptr/](http://www.cs.bu.edu/teaching/cpp/string/array-vs-ptr/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T00:24:07.897

> 我认为指针只能指向一个内存位置，而不是 12。指针 p 是如何实现这一点的？

`p`是指向数组的指针，`char`而不是指向数组的指针。它指向`string`数组的第一个元素。

现在数组的值是指向它的第一个元素的指针，所以这个声明：

```
 char *p = string; 
```

实际上相当于：

```
 char *p =  &string[0]; 
```

如果增加指针：

```
 p++; 
```

`p`将指向数组的下一个元素，即`string[1]`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T00:26:21.793

指向数组的指针实际上是指向第一个地址的指针...并且 printf 将从该地址开始扫描，直到找到空字符... %c 和 %s 在该行为上有所不同

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-09T00:28:37.630

你使用`%s`所以它打印直到它`'\0'`。

> 为什么你必须在那里一个一个地遍历数组，但在这里它只是指向整个事物？

在这里，您使用指向 char 的指针，并且想要打印字符串。所以没关系。假设，如果您使用指向 int 或其他类型的指针，这将不太有效。所以使用了类似的指针算术`p++`。

# c++ - 为什么 Graphics::DrawString 绘制杂项字符？

> ID：10067657
> 
> 赞同：1
> 
> 时间：2012-04-09T00:21:32.057
> 
> 标签：c++, gdi+, gdi

我正在尝试使用 GDI+ 将文本绘制到图像上，但是，我注意到使用 DrawString(...) 有我的文本，然后是几个杂项字符（看起来可能是日语）。这些字符仅在使用 DrawString 时出现，我注意到通过将位图保存到文件中。有谁知道可能是什么原因造成的？我的 GDI 代码是

```
#include <windows.h>
#include <Gdiplus.h>
using namespace Gdiplus;

int main(void)
{
    GdiplusStartupInput gdiplusStartupInput;
    ULONG_PTR           gdiplusToken;
    GdiplusStartup(&gdiplusToken, &gdiplusStartupInput, NULL);

    Font* myFont = new Font(L"Times New Roman", 10);
    Bitmap* characterBitmap = new Bitmap(256, 256, PixelFormat32bppARGB);
    Graphics* g = new Graphics(characterBitmap);

    g->Clear(Color::Transparent);

    SolidBrush* myBrush = new SolidBrush(Color::Black);
    g->DrawString(L"TEST", 48, myFont, PointF(0, 0), myBrush);

    CLSID pngClsid;
    GetEncoderClsid(L"image/png", &pngClsid);
    characterBitmap->Save(L"test.png",  &pngClsid, NULL);

    GdiplusShutdown(gdiplusToken);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T01:16:35.197

您应该阅读该[`Graphics::DrawString`](http://msdn.microsoft.com/en-us/library/ms535993%28v=vs.85%29.aspx)函数的文档。

第二个参数应该是：

> 指定字符串数组中字符数的整数。如果字符串以空字符结尾，则长度参数可以设置为 –1。

# django - Django 如何过滤评估的查询集？

> ID：10067659
> 
> 赞同：3
> 
> 时间：2012-04-09T00:21:50.640
> 
> 标签：django, django-queryset

我缓存了一个常见的查询集，我想根据情况根据不同的字段进行过滤。我想知道如果我首先失去了缓存它的优势，是否通过过滤评估的查询集；Django 是否只是从头开始创建另一个查询集，它是创建缓存查询集和我之后应用的过滤器所涉及的查询集的集合？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-09T00:41:15.980

是的，结果被扔掉了。

您可以从源代码中看到这一点：[`filter()`](https://github.com/django/django/blob/master/django/db/models/query.py#L616)调用[`_filter_or_exclude()`](https://github.com/django/django/blob/master/django/db/models/query.py#L630)，它调用[`_clone()`](https://github.com/django/django/blob/master/django/db/models/query.py#L853)然后添加到它的查询中。`_clone`，可以看到，没有设置`_result_cache`属性。

一般来说，目前还不清楚它可以做些什么来保持共同的结果。如果它是一个带有小结果集的复杂查询，则可以通过发出 SQL 来检查主键是否是您找到的结果之一，但这并不总是更有效，在某些情况下它会混淆语义（如果数据库在缓存和执行附加过滤器之间的时间以影响查询结果的方式发生变化）。

如果你想强制这种手动保存 ID 的行为，你可以这样做：

```
pks = SomeObject.objects.filter(...).values_list('pk', flat=True)
some_of_them = SomeObject.objects.filter(pk_in=pks).filter(...)
others = SomeObject.objects.filter(pk_in=pks).filter(...) 
```

您当然也可以在 Python 中进行过滤，例如通过

```
 common = SomeObject.objects.filter(...)
 some_of_them = [m for m in common if m.attribute == 'foo']
 others = [m for m in common if m.other_attribute == 'bar'] 
```

（如果您愿意，也可以使用，或者将in`filter(lambda m: m.attribute == 'foo', common)`的定义包装起来更明确。）`common``list`

是其中之一还是重新发出查询在很大程度上取决于所涉及的集合的大小、过滤器的复杂性以及存在的索引。

# c - for循环，将起始值留空？

> ID：10067664
> 
> 赞同：1
> 
> 时间：2012-04-09T00:22:30.753
> 
> 标签：c, for-loop, styles

我正在为一个变量编写一个 for 循环，该变量`start`的值已经在程序的其他地方计算过。

做`for(start; start<end; start++)`给出一个警告，并且

`for(start=start; start<end; start++)`似乎是一个不必要的任务。

我能想到的另一个选择是以下 - 这可以吗，或者您会将其归类为糟糕的编码风格？

```
for(; start<end; start++){
    //do stuff
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T00:25:07.413

恕我直言，这不是糟糕的编码风格，但也许您想改用 a `while`？

```
while (start < end)
{
  //do stuff
  ++start;
} 
```

这只是口味问题，真的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T00:26:30.967

`for`离开循环的任何部分都可以。省略所有部分也可以——事实上，这是表达无限循环的惯用方式，如[K&R 书中所示。](http://en.wikipedia.org/wiki/The_C_Programming_Language)

不过，您应该仔细考虑其他选择；a`while`或`do`/`while`循环可能会提供更易读的替代方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T00:24:51.903

是的，你可以这样做。但是，我建议将 start 分配给类似`i`或其他变量，因为现在您在迭代时更改了 start 的值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T00:29:49.657

您可以按以下方式编写代码以获得所需的结果：

```
while(start++<end){
    // your code
} 
```

您可以利用在变量名后添加“++”在条件语句中检查后递增它的事实。

# .net - 将 altchunk 内容合并到 docx 源中

> ID：10067669
> 
> 赞同：3
> 
> 时间：2012-04-09T00:22:58.330
> 
> 标签：.net, ms-office, openxml, office-automation

**简而言之：**如何将 altchunk 的内容合并到 docx 源文件中，以防止打开具有太多 altchunk 的 docx 时出现问题？

**背景：**我有一个 docx 文件，其中包含在创建文件时动态插入的 5,000 个 altchunk。因为有很多 altcunks，每个都有至少 1 页的内容，文件将无法在 Word 中打开 - Word 2010 报告“Word 无法创建工作文件”，Word 2007 报告“打开的窗口太多” ，而 Office 互操作报告“文件似乎已损坏”。

我认为问题的根源在于 altchunk 内容存储在 docx 文件结构中的不同文件中，并且必须打开这么多文件超出了一些限制。在这种情况下，我最好将 altchunk 内容合并到 docx 的实际源中。我怎样才能做到这一点？

如果我在过程中丢失了 altchunk 或者它的定义被修改了，只要内容*看起来*没有改变就可以了。

下面是一个如何创建单个 altchunk 的示例，给定一个 HTML 片段`htmlText`：

```
''// add a part to the document for the HTML chunk
Const snippetChunkID As String = "HtmlSnippetChunk"
Dim snippetChunkPart As AlternativeFormatImportPart = currentDocument.MainDocumentPart.AddAlternativeFormatImportPart(AlternativeFormatImportPartType.Html, snippetChunkID)

''// feed HTML into new chunk
Dim stream As New MemoryStream(Encoding.Default.GetBytes("<html><body>" & htmlText & "</body></html>"))
snippetChunkPart.FeedData(stream)
stream.Close()
stream.Dispose()

''// insert chunk after the placeholder element
Dim snippetAltChunk As New AltChunk() With {.Id = snippetChunkID}
placeholderElement.InsertAfter(snippetAltChunk, placeholderElement) 
```

# php - Codeigniter -> 使用 empty_table 的函数

> ID：10067671
> 
> 赞同：2
> 
> 时间：2012-04-09T00:23:09.563
> 
> 标签：php, mysql, codeigniter

我正在尝试清空表格，但我想知道我的功能是否正确？

**模型：**

```
public function removeQuote()
    {
        $this->db->empty_table('companyDetails,hostingDetails,layoutDetails');
    } 
```

**控制器：**

```
public function submit()
{
        $data['companyContact'] = $this->quote->getCompanyDetails()->companyContact;

        $this->load->view('submit',$data);

        $this->quote->removeQuote();
} 
```

**错误：**

```
Table '_quote.companyDetails,hostingDetails,layoutDetails' doesn't exist

DELETE FROM `companyDetails,hostingDetails,layoutDetails` 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-09T00:48:49.727

```
/**
 * Empty Table
 *
 * Compiles a delete string and runs "DELETE FROM table"
 *
 * @param   string  the table to empty
 * @return  object
 */
public function empty_table($table = '') 
```

显然你不能这样做

```
$this->db->empty_table('companyDetails,hostingDetails,layoutDetails'); 
```

相反，您将不得不调用`empty_table`3 次：

```
$this->db->empty_table('companyDetails');
$this->db->empty_table('hostingDetails');
$this->db->empty_table('layoutDetails'); 
```

您可以随时破解 CodeIgniter DB_active_rec.php 文件，使其符合您的需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T00:32:34.073

在您的控制器中，您必须先加载模型（如果它没有自动加载）

```
$this->load->model('quote'); // Assuming your model name is 'quote' 
```

在您使用该模型中的功能之前，就像您在控制器中使用的那样，如下所示

```
$data['companyContact'] = $this->quote->getCompanyDetails()->companyContact; 
```

最后加载视图，即使在下一行之后也执行了所有代码

```
$this->quote->removeQuote(); 
```

刚刚签入的`CI`文档`empty_table`不接受多个表名。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-05-06T19:16:18.367

**解决方案一**

```
$this->db->truncate('companyDetails');
$this->db->truncate('hostingDetails');
$this->db->truncate('layoutDetails'); 
```

**解决方案二**

```
 function emptytablesbycomma($stringoftables) {
            $array_tablenames = explode(",", $stringoftables);
            if (!empty($array_tablenames)) {
                foreach ($array_tablenames as $tablename) {
                    $this->db->truncate($tablename);
                }
            }
        } 
```

> 用法

```
$stringoftables='companyDetails,hostingDetails,layoutDetails';
$this->emptytablesbycomma($stringoftables); 
```

# asp.net - 如何让服务从 global.asax 开始而无需调用它？

> ID：10067672
> 
> 赞同：3
> 
> 时间：2012-04-09T00:23:16.333
> 
> 标签：asp.net, wcf, c#-4.0, wcf-client

我有一个简单的应用程序，我使用 global.asax 通过 Application_Start 中的自定义 servicehostfactory 将 serviceroute 映射到 wcf 服务。该服务的构造函数会进行一些初始处理来设置需要一些时间的服务。

我需要这个构造函数在它的 serviceroute 被自动添加时触发。我尝试从 global.asax 创建一个客户端通道并进行虚拟调用以启动该服务，但发现该服务尚未启动 - 似乎 application_start 必须返回？

那么，如何在第一次通过 global.asax 映射时触发服务的构造函数，而无需手动点击服务？不幸的是 AppFabric 不是我们的选择，所以我不能只使用它的内置自动启动..

**更新**

我被要求提供更多细节；

这就像一个路由管理服务。所以我有 Service1——它被添加为 global.asax 中的服务路由。现在我有[http://localhost/Service1](http://localhost/Service1)

在 Service1 中，我有一个名为“addServiceRoute”的方法。调用时，它还会为 Service2 注册一个路由。现在我有[http://localhost/Service1/Service2](http://localhost/Service1/Service2)。

我最初的 global.asax 解决方案是为[http://localhost/service1](http://localhost/service1)构建一个 channelfactory ，但这不起作用。Service1 尚未启动，并且在 Application_Start 返回之前不会出现（仍然不确定为什么？）。所以我想我会作弊并将最初的 addserviceroute 调用移动到 service1 的构造函数。也没有工作。

有人提到这不应该在构造函数中——我同意，这只是测试代码。

还提到了一个单例，这可能没问题，但我打算在一台机器上（在同一个应用程序池中）拥有多个 Service1 实例，所以我认为这行不通？

** 更新 #2 ** 我被要求提供示例代码.. 这里来自 global.asax（为简洁起见，稍微修剪了一下）.. 所以[http://localhost/Test](http://localhost/Test)确实出现了.. 但如果我必须使用appfabric 来预热 Test 并让它的构造函数触发，那么我不需要 Test.svc 什么的吗？我如何让 appfabric 甚至看到此服务存在？

```
protected void Application_Start(object sender, EventArgs e)
        {
            RouteTable.Routes.Ignore("{resource}.axd/{*pathInfo}");
            RouteTable.Routes.Add(
                new ServiceRoute("Test", new MyServiceHostFactory(ITestService, BindingType.BasicHttpBinding, true), TestService)); 
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T13:40:47.460

我会推荐 AppFabric 自动启动——即使你说你不能使用它——这就是它要解决的问题（*预热你的服务*）。

作为 AppFabric 存在之前的替代方案，您必须使用计划任务（*又名 cron 作业*）和调用您要初始化的服务的可执行文件。AppFabric 自动启动的工作方式是[使用命名管道 ( `net.pipe`) 来触发预热](http://msdn.microsoft.com/en-us/library/ee677285.aspx)- 但它只是在服务回收时执行此操作。计划任务方法和 AppFabric 自动启动之间的区别在于计划任务不知道您的应用程序池何时被回收 - 您需要定期轮询您的服务以使其保持温暖。

或者，您可以考虑通过自托管在 IIS 之外托管您的 WCF 应用程序。这将避免预热问题，但您不会获得 IIS 托管容器的许多好处。[`HttpSelfHostServer`在新的 MVC Web API 中](http://www.asp.net/web-api/overview/hosting-aspnet-web-api/self-host-a-web-api)查看或[使用标准查看`ServiceHost`](http://msdn.microsoft.com/en-us/library/ms731758.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T09:33:17.060

您所描述的需要单例服务（您应该避免这样做），因为通常每个调用或会话都会获得一个新实例 = 对构造函数的新调用。在自托管 WCF 服务中，您可以实例化单例服务实例并将其传递给`ServiceHost`构造函数。如果与您一起使用 IIS 托管服务，`ServiceRoute`您可以尝试创建自己的派生类`ServiceHostFactory`，并将创建的服务实例作为参数传递给其构造函数。在这个工厂类中实现`CreateServiceHost`方法并将现有的服务实例传递给`ServiceHost`构造函数。要完成这项工作，您的服务类仍必须[通过服务行为作为单例](https://stackoverflow.com/questions/5372222/specify-a-singleton-service-in-a-wcf-self-hosted-service/5372284#5372284)处理。

顺便提一句。构造函数不应该做任何耗时的操作。构造函数用于构造对象而不是用于初始化基础设施。首先，使用构造函数进行此类初始化是不好的做法。

# sql-server - 是否可以使用 SQL Server Reporting Services、SSRS 2008 来托管 Intranet 站点？

> ID：10067673
> 
> 赞同：0
> 
> 时间：2012-04-09T00:23:16.817
> 
> 标签：sql-server, iis, ssrs-2008, sql-server-2008-r2, http.sys

我正在进行的项目有一个同时运行 SQL Server 2008 R2 数据库和 SSRS Reporting Services 的服务器。我可以利用 SSRS 托管一个简单的 Intranet 站点，允许用户通过我创建的 Web 应用程序修改引用表数据吗？

我知道 SSRS 不再直接绑定到 IIS。是否可以使用 SSRS 的托管设施，或者我是否会被迫安装 IIS？

我已阅读有关如何利用报告参数进行简单 CRUD 操作的文章 (http://www.sqlservergeeks.com/articles/sql-server-bi/26/using-sql-server-reporting-services-to-manage-数据），但我更喜欢另一种解决方案，因为在某些时候，数据条目将用于做更多的事情，而不仅仅是管理查找表数据。

有什么建议么？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T01:07:05.827

> 我可以利用 SSRS 托管一个简单的 Intranet 站点，允许用户通过我创建的 Web 应用程序修改引用表数据吗？

是的，你可以这样做。从 SSRS 报告中的不同元素，您可以链接到网页，因此报告可以链接到您的网络应用程序，然后将网络应用程序链接回报告。

此外，一个报表可以链接到另一个报表，并且您可以使用仪表板页面来完成一个内部网，该仪表板页面链接到许多其他报表。

> 我知道 SSRS 不再直接绑定到 IIS。是否可以使用 SSRS 的托管设施，或者我是否会被迫安装 IIS？

为了只运行报告，您需要安装 IIS，但为了运行其他 Web 应用程序，您需要一个 Web 服务器，而 IIS 将完成这项工作。

就数据输入而言，您最好使用 Web 应用程序，而不是尝试在报表中实现数据输入。从技术上讲，您可以使用报表上的参数进行数据输入，但这是一个非常丑陋的解决方案。

仍然使用带有 SSRS 的 Sharepoint 可能会满足您的需求。另一种选择是将 OneNote 用于某些 Intranet 页面，并将 OneNote 文件放在共享的网络位置。您仍然需要您的网络应用程序来输入数据。

我希望这能回答你的问题。

# c# - Keys.Down 与其他箭头键的作用不同？

> ID：10067674
> 
> 赞同：0
> 
> 时间：2012-04-09T00:23:17.660
> 
> 标签：c#, listview, scroll

我创建了一个 listView ，当用户单击一个元素并按下向上或向下箭头键时，该元素应该移动到那里并且该元素应该保持选中状态。它非常适合向上箭头键，但是当我在“case Keys.Down”开关下粘贴相同的代码时，只有 listView 中的 TOP 元素保持选中状态。这很奇怪！我还在 Keys.Left 和 Keys.Right 开关下粘贴了相同的代码，并且代码在那里完美运行，但是一旦我将开关更改为 Keys.Down，只有顶部元素保持选中状态。有谁知道为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T01:00:03.730

在向下的情况下，偏移量应该不同。您使用相同的（ -1 ）。在向下它应该是 +1 像这样：

```
newSpot = listOrderNames.IndexOf(listView.SelectedItems[0].Text) + 1;
index = listOrderNames.IndexOf(listView.SelectedItems[0].Text) + 1; 
```

另外，你可以把它写得更干净

```
int offset = 0;
case Keys.Up:
    offset = -1; 
    break;
case Keys.Down:
    offset = 1;
    break;
if (listView.SelectedItems.Count > 0) 
{
    int newSpot = 0;
    int index = 0;
    if (listOrderNames.IndexOf(listView.SelectedItems[0].Text) == 0) 
    {
        reorder(0, true);
        newSpot = listOrderNames.Count + offset;
    }
    else 
    {
        newSpot = listOrderNames.IndexOf(listView.SelectedItems[0].Text) + offset;
        index = listOrderNames.IndexOf(listView.SelectedItems[0].Text) + offset;
        swap(listOrderNames.IndexOf(listView.SelectedItems[0].Text), newSpot);
    }
    for (int i = 0; i < listView.Items.Count; i++) 
    {
        listView.Items[i].Selected = false;
    }
    listView.Items[newSpot].Selected = true;
} 
```

# language-agnostic - 计算相机在飞机上能看到的面积

> ID：10067675
> 
> 赞同：1
> 
> 时间：2012-04-09T00:23:24.467
> 
> 标签：language-agnostic, geometry

我有一个坐标为 x,y 的相机，高度为 h，它以特定的角度看 xy 平面，具有特定的视野。我想计算相机在飞机上可以看到的 4 个角。

可能有某种公式，但我似乎无法在谷歌上找到它。

编辑：我可能应该提到我的意思是 3D 图形意义上的相机。具体来说，我正在使用 XNA。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T00:28:27.950

忽略镜头畸变并假设镜头几乎在焦点处，那么您只有一个由传感器尺寸和镜头形成的三角形，然后是镜头到主体 - 类似的三角形可以为您提供主体平面的大小。

如果你想要一个倾斜的物体平面，它只是垂直物体平面上的投影

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T20:53:18.480

我不得不做类似的事情来调试 3D 游戏中的图形代码。我发现考虑它的最简单方法是创建表示屏幕角的向量，然后计算与任何相关对象（在本例中为平面）的交集。

看看您的视图投影（或任何您的相机矩阵堆栈看起来像相乘的东西）并意识到它们输出到的屏幕空间具有同质化坐标的角`(-1, -1), (-1, 1), (1, -1), (1, 1)`。知道了这一点，您就剩下一个自由变量，并且可以求解表示相机角的向量。

虽然，这是一种痛苦。为每个角构造一个向量要容易得多，就好像相机没有旋转或平移一样，然后通过视图矩阵对其进行转换以提供世界空间向量。然后你可以计算向量和平面之间的交点来得到你的四个角。

我有一份日常工作，所以我把数学留给你。但是，一些可能对此有所帮助的链接：

[角度/视野计算](http://en.wikipedia.org/wiki/Angle_of_view)

[线平面交点](http://en.wikipedia.org/wiki/Line-plane_intersection)

# r - 为什么不建议在 R 中使用 attach()，我应该改用什么？

> ID：10067680
> 
> 赞同：59
> 
> 时间：2012-04-08T04:10:03.347
> 
> 标签：r, dataframe, r-faq

假设我们有一个`x`包含列`job`和的数据框`income`。引用框架中的数据通常需要`x$job`针对`job`列中的数据和列`x$income`中的数据的命令`income`。

但是，使用该命令`attach(x)`允许`$`在引用相同数据时取消数据框的名称和符号。因此，在 R 代码中`x$job`成为`job`和`x$income`成为。`income`

问题是许多 R 专家建议在 R 中`attach()`编码时不要使用该命令。

主要原因是什么？应该改用什么？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-04-08T07:09:40.123

**何时使用它：**

`attach()`当我想要在大多数统计数据包（例如，Stata、SPSS）中获得的环境时，我会使用一次处理一个矩形数据集的环境 。

**什么时候不使用：**

然而，当你有几个不同的数据集时，它会变得非常混乱，代码很快变得不可读，特别是如果你实际上使用 R 作为一个粗略的关系数据库，其中不同的矩形数据，都与手头的问题相关，并且可能被用于匹配来自不同矩形的数据的各种方式，具有相同名称的变量。

该`with()`函数或许多函数的参数是许多具有诱惑力`data=`的实例的绝佳替代品。`attach()`

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-04-09T19:52:06.390

不使用的另一个原因`attach`：它允许访问数据框列的值，仅用于读取（访问），并且与附加时一样。它不是该列当前值的简写。两个例子：

```
> head(cars)
  speed dist
1     4    2
2     4   10
3     7    4
4     7   22
5     8   16
6     9   10
> attach(cars)
> # convert stopping distance to meters
> dist <- 0.3048 * dist
> # convert speed to meters per second
> speed <- 0.44707 * speed
> # compute a meaningless time
> time <- dist / speed
> # check our work
> head(cars)
  speed dist
1     4    2
2     4   10
3     7    4
4     7   22
5     8   16
6     9   10 
```

`cars`即使`dist`并`speed`分配给数据集，也没有对数据集进行任何更改。

如果明确分配回数据集...

```
> head(cars)
  speed dist
1     4    2
2     4   10
3     7    4
4     7   22
5     8   16
6     9   10
> attach(cars)
> # convert stopping distance to meters
> cars$dist <- 0.3048 * dist
> # convert speed to meters per second
> cars$speed <- 0.44707 * speed
> # compute a meaningless time
> cars$time <- dist / speed
> # compute meaningless time being explicit about using values in cars
> cars$time2 <- cars$dist / cars$speed
> # check our work
> head(cars)
    speed   dist      time     time2
1 1.78828 0.6096 0.5000000 0.3408862
2 1.78828 3.0480 2.5000000 1.7044311
3 3.12949 1.2192 0.5714286 0.3895842
4 3.12949 6.7056 3.1428571 2.1427133
5 3.57656 4.8768 2.0000000 1.3635449
6 4.02363 3.0480 1.1111111 0.7575249 
```

计算中引用的`dist`和是原始（未转换）值；附加的值和时间。`speed``time``cars$dist``cars$speed``cars`

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2012-04-08T09:04:24.427

我认为使用`attach`. 我自己不使用它（再说一次，我喜欢动物，但也不要养动物）。当我想到 时`attach`，我认为是长期的。当然，当我使用脚本时，我对它了如指掌。但是在一周、一个月或一年的时间里，当我回到脚本时，我发现搜索某个变量来自哪里的开销，太贵了。许多方法都有`data`参数，这使得调用变量非常容易（sensu `lm(x ~ y + z, data = mydata)`）。如果没有，我对使用`with`感到满意。

简而言之，在我的书中，附加对于简短的快速数据探索来说是很好的，但对于开发我或其他人可能想要使用的脚本，我会尽量保持我的代码可读（和可转移）。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2016-12-12T04:31:46.263

如果您执行`attach(data)`多次，例如 5 次，那么您可以看到（在 的帮助下`search()`）您的数据已在工作空间环境中附加了 5 次。因此，如果您将其取消附加 ( `detach(data)`) 一次，环境中仍然会`data`出现 4 次。因此，`with()/within()`是更好的选择。它们有助于创建包含该对象的本地环境，您可以使用它而不会造成任何混淆。

# javascript - 为什么 jQuery 将它们的 ajax 请求对象绑定到一个窗口？

> ID：10067684
> 
> 赞同：2
> 
> 时间：2012-04-09T00:24:30.963
> 
> 标签：javascript, jquery, ajax

为什么 JQuery（[最新来源](http://code.jquery.com/jquery-latest.js)）将 Ajax 请求对象绑定到这样的窗口？

```
 return new window.XMLHttpRequest(); 
```

我在我的消息来源中问我不这样做。

我只是做

```
return new XMLHttpRequest(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-09T00:36:50.980

因为`XMLHttpRequest`对象是对象的子`window`对象。

您可以将它作为一个单独的对象引用，因为它`window`是浏览器中的父范围；即全局范围。如果引用不在本地范围内（闭包），JavaScript 会继续沿着范围链向上移动，直到找到引用。Using`window.XMLHttpObject`通过告诉浏览器确切的位置来防止所有查找。

# c++ - 为什么不能从派生类对象访问父类的赋值运算符

> ID：10067686
> 
> 赞同：6
> 
> 时间：2012-04-09T00:24:43.903
> 
> 标签：c++, inheritance, assignment-operator

例子：

```
class C
{
  public:
    void operator =(int i) {}
};

class SubC : public C
{
}; 
```

以下给出编译错误：

```
SubC subC;
subC = 0; 
```

“'subC = 0'中的'operator ='不匹配”

一些消息来源指出这是因为赋值运算符不是继承的。但这不只是因为默认构造的复制分配`SubC`掩盖了它们吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-09T00:31:02.387

复制赋值运算符是在派生类中自动生成的。由于 C++ 的常规名称隐藏规则，这会导致基类的赋值运算符被隐藏。您可以通过“使用”指令取消隐藏基类中的名称。例如：

```
class C
{
  public:
    void operator =(int i) {}
};

class SubC : public C
{
  public:
    using C::operator=;
}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T00:27:52.763

基类的复制赋值运算符没有派生类的复制赋值运算符所需的签名。它由派生类继承，但不构成其中的复制赋值运算符。因此，即使赋值运算符是继承的，就像其他成员函数一样，它不提供复制赋值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T00:36:02.743

我还没有这样做，但是根据[The Man Himself](http://www2.research.att.com/~bs/C++0xFAQ.html#inheriting) (Stroustrup) 的说法，使用构造函数来实现它是 C++11 的一个特性，但自 C++98 以来就一直在使用其他方法来实现它。

这是直接从链接中提取的：

> 人们有时会对普通范围规则适用于类成员这一事实感到困惑。特别是，基类的成员与派生类的成员不在同一范围内：
> 
> ```
> struct B {
>     void f(double);
> };
> 
> struct D : B {
>     void f(int);
> };
> 
> B b;   b.f(4.5);  // fine
> D d;   d.f(4.5);  // surprise: calls f(int) with argument 4 
> ```
> 
> 在 C++98 中，我们可以将一组重载函数从基类“提升”到派生类中：
> 
> ```
> struct B {
>     void f(double);
> };
> 
> struct D : B {
>     using B::f;     // bring all f()s from B into scope
>     void f(int);    // add a new f()
> };
> 
> B b;   b.f(4.5);  // fine
> D d;   d.f(4.5);  // fine: calls D::f(double) which is B::f(double) 
> ```

所以你去。即使在 C++11 之前，您也可以“随心所欲地接受它”，尽管我自己没有尝试过。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T01:00:25.753

除复制赋值运算符外，其他重载运算符都可以被继承。

我同意这样的观点，即 SubC 的默认构造复制分配掩盖了 C 的重载赋值运算符。

如果 SubC 不提供复制赋值操作符，Compiler 会合成复制赋值操作，如下：

```
class SubC : public C
{ 
public:
    SubC & operator=( const SubC & other );
} 
```

那么 'SubC & operator=( const SubC & other )' 掩盖了 C 的赋值运算符，导致编译错误。

如果

```
SubC other;
SubC subC;

subC = other; 
```

那么，这种情况下，编译就ok了。

# django - Django + mod_wsgi =>“没有名为模型的模块”错误

> ID：10067689
> 
> 赞同：0
> 
> 时间：2012-04-09T00:24:53.453
> 
> 标签：django, apache, django-models, mod-wsgi, wsgi

我需要一些关于无法解决的 Django 错误的帮助。

当我“python manage.py runserver”时，我的网站运行良好，但是当我尝试使用 wsgi 部署它时，它不断出现未知错误。我尽力用谷歌搜索这些错误，但我无法解决。谁能告诉我的错误是什么？

阿帕奇错误日志

```
[error] /usr/local/lib/python2.6/dist-packages/django/middleware/csrf.py:262: DeprecationWarning: CsrfResponseMiddleware and CsrfMiddleware are deprecated; use CsrfViewMiddleware and the template tag instead (see CSRF documentation).
[error]   DeprecationWarning
[error] [client 76.191.24.242] mod_wsgi (pid=21082): Exception occurred processing WSGI script '/srv/www/myapp/wsgi.py'.
[error] [client 76.191.24.242] Traceback (most recent call last):
[error] [client 76.191.24.242]   File "/usr/local/lib/python2.6/dist-packages/django/core/handlers/wsgi.py", line 250, in __call__
[error] [client 76.191.24.242]     self.load_middleware()
[error] [client 76.191.24.242]   File "/usr/local/lib/python2.6/dist-packages/django/core/handlers/base.py", line 47, in load_middleware
[error] [client 76.191.24.242]     raise exceptions.ImproperlyConfigured('Error importing middleware %s: "%s"' % (mw_module, e))
[error] [client 76.191.24.242] ImproperlyConfigured: Error importing middleware backends: "No module named models" 
```

wsgi.py

```
import os
import sys

sys.path.append('/srv/www')
sys.path.append('/srv/www/myapp')

os.environ['DJANGO_SETTINGS_MODULE'] = 'myapp.settings'

import django.core.handlers.wsgi
application = django.core.handlers.wsgi.WSGIHandler() 
```

阿帕奇

```
<VirtualHost *:80>

    ServerName www.myapp.com
    DocumentRoot /srv/www/myapp

    RewriteEngine On
    RewriteCond %{HTTP_HOST} !^www.myapp.com$ [NC]
    RewriteRule ^(.*)$ http://www.myapp.com$1 [R,L]

    Alias /static/ /srv/www/myapp/static/

    <Directory /srv/www/myapp>
        Order allow,deny
        Allow from all
    </Directory>

    <Directory /srv/www/myapp/static>
        Order allow,deny
        Allow from all
    </Directory>

    WSGIDaemonProcess myapp.djangoserver processes=2 threads=15 display-name=%{GROUP}
    WSGIProcessGroup myapp.djangoserver
    WSGIScriptAlias / /srv/www/myapp/wsgi.py

</VirtualHost> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T10:34:19.797

错误消息看起来您使用 Django 1.3 系列，并且您自定义了 MIDDLEWARE_CLASSES `backends.SomeClass`（在某些名为 的模块中定义的某个类`backends`），该类位于当前目录或 python 路径中的开发服务器上，但如果由 mod_wsgi 启动，则不是这样。

应使用中间件类的全名，并验证是否在生产服务器上添加了必要的 python 路径。最终在 wsgi.py 文件中使用 sys.path.append。看起来，在开发服务器上，您将某个包的目录添加到 python 路径并编写了短名称（'backends'），而您应该将此包的父目录添加到 sys.path 并写入全名。

（当然 - 如果你使用它：如果你使用 virtualenv，请确认 sys.executable 是来自该 virtualenv 目录的 python 可执行文件，而不是来自普通 Python。不应该尝试通过添加路径来修复被遗忘的 virtualenv。）

# r - R 选项隐含增量计算

> ID：10067693
> 
> 赞同：2
> 
> 时间：2012-04-09T00:25:39.317
> 
> 标签：r, options

我有一些历史期权价格，我正在尝试确定隐含增量。

我有：

```
1) strike
2) call/put
3) stock price
4) dividend
5) interest rate
6) option price 
```

我很难在 R 中找到一个包/函数来做到这一点。

我查看了`fOptions`包装，但似乎没有任何东西可以用来计算隐含的希腊语。

有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T01:09:38.423

您可以使用 RQuantLib 计算隐含波动率，然后计算其他希腊变量。

```
library(RQuantLib)
value <- 9.15
type  <- "call"
underlying    <- 100
strike        <- 100
dividendYield <- 0
riskFreeRate  <- 0.03
maturity      <- .5

# Compute the implied volatility
volatility <- EuropeanOptionImpliedVolatility(
  type  = type, 
  value = value, 
  underlying = underlying,
  strike     = strike, 
  dividendYield = dividendYield,
  riskFreeRate  = riskFreeRate,
  maturity      = maturity,
  volatility    = .01
)$impliedVol

# Compute all the greeks
EuropeanOption(
  type  = type, 
  underlying = underlying,
  strike     = strike, 
  dividendYield = dividendYield,
  riskFreeRate  = riskFreeRate,
  maturity      = maturity,
  volatility    = volatility
)

# Concise summary of valuation for EuropeanOption 
#   value    delta    gamma     vega    theta      rho   divRho 
#  9.1500   0.5702   0.0185  27.7721  -9.7682  23.9330 -28.5080 
```

# jquery - 增加高度时图像会消失。为什么？

> ID：10067696
> 
> 赞同：3
> 
> 时间：2012-04-09T00:26:14.197
> 
> 标签：jquery, css, image, html, background

我正在尝试制作视差页面，但是当我将占位符图像更改为要使用的图像时，新的图像消失了。

两个图像的宽度相同，只是高度不同。我需要更改样式表或源代码吗？

样式表代码为：

```
#intro .story{
    background: url (images/LAYER2 TEXT RIGHT.png) 50% -0px no-repeat fixed;
    height: 3798px;
    position: relative;
    width: 1024px; 
```

在源代码中，它只是放置为：

```
</head>
<body>
<div id="intro"> 
```

所以那里没有什么特别的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T00:50:53.690

您应该从图像名称中删除额外的空格。

```
#intro .story{
    background: url("images/LAYER2-TEXT-RIGHT.png") 50% 0px no-repeat fixed;
    height: 3798px;
    position: relative;
    width: 1024px; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T00:34:36.410

问题可能出在您的 CSS 中。`#intro .story`是类名为“story”的元素的选择器，该元素是 id 为“intro”的元素的子元素。

由于您没有显示 intro 的孩子，我假设您可能打算将图像应用于 div#intro 。

如果这不是问题，那么如果您直接访问该图像 url，是否能够在浏览器中加载新图像？换句话说，您确定名称拼写正确并且图片位于您指定的位置吗？

由于您的其他占位符已加载，这表明可能未正确引用新占位符。您可以尝试加载一些不同大小的不同图像以了解有关该问题的更多信息。

# git - Git：将不同的变更集推送到heroku

> ID：10067700
> 
> 赞同：4
> 
> 时间：2012-04-09T00:27:18.830
> 
> 标签：git, heroku, changeset

我想推送我的存储库的以前版本。如何将以前的变更集推送到 heroku？

就像是：

> git push heroku 07226c49428354b09349ec45078122ce7c​​d410c8

谢谢！

**编辑：一些试验**

git branch -a 产生

```
master
remotes/heroku/master
remotes/origin/HEAD -> origin/master
remotes/origin/master 
```

尝试类似的东西

```
git push heroku 07226c49428354b09349ec45078122ce7cd410c8:master 
```

给我吗：

```
To prevent you from losing history, non-fast-forward updates were rejected
Merge the remote changes (e.g. 'git pull') before pushing again.  See the
'Note about fast-forwards' section of 'git push --help' for details. 
```

我猜这是因为我当前的 heroku 部署是 HEAD，并且由于我想部署以前的变更集，git 会引发错误。所以我重新创建了新的heroku 堆栈（删除当前的heroku，删除它的引用，并创建一个新的heroku cedar 堆栈），并尝试再次推送特定的变更集。这一次，在一个空的 heroku 部署中，我得到：

> 错误：无法推送到不合格的目标：master 目标 refspec 既不匹配远程上的现有 ref，也不以 refs/ 开头，我们无法根据源 ref 猜测前缀。错误：未能将一些参考推送到 'git@heroku.com:empty-waterfall-8460.git'

任何想法如何在没有任何这些问题的情况下推动不同的变更集？或者我是否必须每次从特定变更集开始创建一个分支，重新创建 heroku 堆栈并推送该分支？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T00:34:42.713

```
git push heroku 07226c49428354b09349ec45078122ce7cd410c8:master 
```

您可能希望为此提交创建一个分支或标签，以供将来参考。

编辑：我认为应该是：

```
git push -f heroku 07226c49428354b09349ec45078122ce7cd410c8:master 
```

它解决了第一个错误。我不确定您重新创建堆栈后发生了什么。

# certificate - 将 Apple 推送证书从 .pem 转换为 .p12 (PKCS12)

> ID：10067701
> 
> 赞同：1
> 
> 时间：2012-04-09T00:27:25.090
> 
> 标签：certificate, apple-push-notifications

我正在尝试在 Windows 机器上将 Apple 推送证书（以 .pem 格式从[https://identity.apple.com/pushcert/](https://identity.apple.com/pushcert/)接收）转换为 PKCS12。我安装了 OpenSSL。

以下是我正在尝试的步骤：

1.  产生企业社会责任

    ```
    openssl req -out d:\cert\request.csr -new -newkey rsa:2048 -nodes -keyout d:\cert\csrPrivateKey.pem 
    ```

2.  将签名的 CSR 上传到 Apple 并下载颁发的证书 (pushCert.pem)

3.  将 .pem 证书转换为 pkcs12

    ```
    openssl pkcs12 -export -in d:\cert\pushCert.pem -inkey d:\cert\csrPrivateKey.pem -out d:\cert\pushCert.p12 -name "apns-cert" 
    ```

当我尝试这最后一步时，我收到一个错误“没有证书与私钥匹配”，并创建了一个空文件。如果有人有任何建议，将不胜感激。

谢谢！

# r - 根据字符串选择data.frame中的行

> ID：10067704
> 
> 赞同：7
> 
> 时间：2012-04-09T00:27:52.883
> 
> 标签：r

我有一个`data.frame`与`row.names`测试中的一样。

```
test <-
c("Env_1990:trait_KPS", "Env_1990:trait_SPSM", "Env_1990:trait_TKW",
"Env_1990:trait_Yield", "Env_1991:trait_KPS", "Env_1991:trait_SPSM",
"Env_1991:trait_TKW", "Env_1991:trait_Yield", "Env_1992:trait_KPS",
"Env_1992:trait_SPSM", "Env_1992:trait_TKW", "Env_1992:trait_Yield",
"Env_1993:trait_KPS", "Env_1993:trait_SPSM", "Env_1993:trait_TKW",
"Env_1993:trait_Yield", "Env_1994:trait_KPS", "Env_1994:trait_SPSM",
"Env_1994:trait_TKW", "Env_1994:trait_Yield", "Env_1995:trait_KPS",
"Env_1995:trait_SPSM", "Env_1995:trait_TKW", "Env_1995:trait_Yield",
"Gen_B88:Env_1990:trait_KPS", "Gen_B88:Env_1990:trait_SPSM",
"Gen_B88:Env_1990:trait_TKW", "Gen_B88:Env_1990:trait_Yield",
"Gen_B88:Env_1991:trait_KPS", "Gen_B88:Env_1991:trait_SPSM",
"Gen_B88:Env_1991:trait_TKW", "Gen_B88:Env_1991:trait_Yield",
"Gen_B88:Env_1992:trait_KPS", "Gen_B88:Env_1992:trait_SPSM",
"Gen_B88:Env_1992:trait_TKW", "Gen_B88:Env_1992:trait_Yield",
"Gen_B88:Env_1993:trait_KPS", "Gen_B88:Env_1993:trait_SPSM",
"Gen_B88:Env_1993:trait_TKW", "Gen_B88:Env_1993:trait_Yield") 
```

我只想选择那些以`Env_`. 我试过这段代码`R`

```
grep(pattern="[Env_]", x=test). 
```

这段代码给了我所有的行，因为`Env_`出现在每一行的名称中。我想知道如何选择仅以`Env_`. 在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-09T00:36:09.087

您想为*行/字符串*`^`的开头添加字符：

 *```
> grep("^Env_", test)
 [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
> grep("^Env_", test, value = TRUE)
 [1] "Env_1990:trait_KPS"   "Env_1990:trait_SPSM"  "Env_1990:trait_TKW"  
 [4] "Env_1990:trait_Yield" "Env_1991:trait_KPS"   "Env_1991:trait_SPSM" 
 [7] "Env_1991:trait_TKW"   "Env_1991:trait_Yield" "Env_1992:trait_KPS"  
[10] "Env_1992:trait_SPSM"  "Env_1992:trait_TKW"   "Env_1992:trait_Yield"
[13] "Env_1993:trait_KPS"   "Env_1993:trait_SPSM"  "Env_1993:trait_TKW"  
[16] "Env_1993:trait_Yield" "Env_1994:trait_KPS"   "Env_1994:trait_SPSM" 
[19] "Env_1994:trait_TKW"   "Env_1994:trait_Yield" "Env_1995:trait_KPS"  
[22] "Env_1995:trait_SPSM"  "Env_1995:trait_TKW"   "Env_1995:trait_Yield" 
```*

# opengl-es - GopenGL 将纹理坐标与世界对齐，而不是面对

> ID：10067716
> 
> 赞同：0
> 
> 时间：2012-04-09T00:29:21.930
> 
> 标签：opengl-es, coordinates, textures

我目前拥有的：在给定矩形的宽度和高度以及纹理的比例因子的情况下生成纹理坐标。这很好：

```
vertices = new float[] {
                    0,          0,              0, this.height / (this.texture.height * this.texScaleHeight),
                    this.width, 0,              this.width / (this.texture.width * this.texScaleWidth), height / (this.texture.height * this.texScaleHeight),
                    this.width, this.height,    this.width / (this.texture.width * this.texScaleWidth), 0,
                    0,          this.height,    0, 0 }; 
```

我现在想要做的是，一些具有不同位置（即彼此相邻）的矩形具有无缝的纹理渐变。我尝试了以下但没有好的结果。

```
vertices = new float[] {
                    0,          0,              -this.getPosition().x * this.texScaleWidth, this.height / (this.texture.height * this.texScaleHeight) -this.getPosition().y * this.texScaleHeight,
                    this.width, 0,              this.width / (this.texture.width * this.texScaleWidth) -this.getPosition().x * this.texScaleWidth, height / (this.texture.height * this.texScaleHeight)-this.getPosition().y * this.texScaleHeight,
                    this.width, this.height,    this.width / (this.texture.width * this.texScaleWidth) -this.getPosition().x * this.texScaleWidth, -this.getPosition().y * this.texScaleHeight,
                    0,          this.height,    -this.getPosition().x * this.texScaleWidth, -this.getPosition().y * this.texScaleHeight }; 
```

我怎样才能实现纹理“与世界对齐”而不是它们所在的矩形？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T05:39:39.440

*这种*技术可能过于笼统，但在这里：您可以*将纹理坐标投影到几何体上*。

整个工作流程与处理几何本身相同，但在这里，所有世界点都分配了纹理坐标。将几何中的每个点推入另一个 MVP 矩阵（代表投影仪）并获取该`(x, y)`点的纹理坐标的结果（假设正交投影）；透视需要`w`事后除。

我希望你能明白。搜索它，我找不到*像样的*描述或教程。*阴影映射*使用相同的技术，但它的目标是确定一个点是否有阴影；在这里，目标是找到通用投影仪的纹理坐标。

# objective-c - OpenGLView 无法显示

> ID：10067719
> 
> 赞同：-1
> 
> 时间：2012-04-09T00:30:30.060
> 
> 标签：objective-c, opengl, nsopenglview

我已遵循[本指南](https://developer.apple.com/library/mac/#documentation/graphicsimaging/conceptual/OpenGL-MacProgGuide/opengl_drawing/opengl_drawing.html)。

虽然我真的无法理解它在第 13 点所说的内容，但我只是打开了检查器的窗格，但它没有说明要设置哪些属性。但是，我已将代码复制并粘贴到适当的类中。但它看起来是一个普通的窗口，没有三角形的绘制，就像我在 Objective-C 中制作一个有一个空窗口的普通程序一样。

编辑：

我还以为是窗口初始化的问题，所以写了一个awakeFromNib方法来让drawRect方法启动：

```
- (void) awakeFromNib
{
    NSRect rect=NSMakeRect(100.0, 100.0, 100.0, 100.0);
    [self drawRect: rect];
} 
```

但是在drawRect的第一条指令我得到一个EXC_BAD_ACCESS异常

```
glClearColor(0, 0, 0, 0); 
```

也许窗口没有正确初始化？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T18:00:49.803

您可能会出现段错误，因为 OpenGL 尝试在没有当前上下文的情况下更改当前上下文中的某些状态（因为您在`-drawRect:`没有先设置当前上下文的情况下发送了）。

**你永远不应该发送`-drawRect:`自己。**相反，使用`-setNeedsDisplay`并让 Cocoa 设置当前上下文并`-drawRect:`为您发送：

```
- (void)awakeFromNib {
  self.needsDisplay = YES;
} 
```

# python - 我可以在 IGraph-Python 中更改包含特定顶点的边的颜色吗

> ID：10067721
> 
> 赞同：2
> 
> 时间：2012-04-09T00:30:42.637
> 
> 标签：python, igraph

我创建了一个有向图，并通过一个程序找出它包含的所有循环。创建图形后，我想更改包含循环中涉及的顶点的边的颜色。

我正在使用python igraph。

请帮忙

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T10:03:18.527

像这样的东西：

```
vertex_set = set(vertices_in_cycle)
g.es["color"] = "black"
red_edges = g.es.select(_source_in=vertex_set, _target_in=vertex_set)
red_edges["color"] = "red" 
```

解释：

1.  `g.es`表示图中所有边的集合。（同样，`g.vs`是所有顶点的集合）。

2.  `g.es["color"]`*允许您为图中所有*边的`color`属性分配一个值。绘图仪使用此边缘属性来确定边缘应具有的颜色。因此，在第 2 行中，您将所有边缘的颜色设置为黑色。（注意：您也可以在此处使用列表而不是简单的字符串，或者您可以使用 HTML 颜色符号来自定义颜色）。

**   您可以将`g.es`其用作列表，在这种情况下，您将获得图形的特定边；例如，`g.es[2]`会给你 id=2 的优势。这在这里没有使用，但很高兴知道。

    *   `g.es.select`是一种根据某些标准选择边缘子集的方法。`help(EdgeSeq.select)`为您提供有关此的更多信息；这里的要点是，在第 3 行中，您正在选择所有边，其两个端点都位于您感兴趣的顶点集中。所选边存储在变量中，该变量与(ie )`red_edges`具有相同的类型。`g.es``EdgeSeq`

    *   在最后一行中，您将所有边缘的颜色设置`red_edges`为`red`，覆盖您在第 2 行中设置的黑色。* 

 *请注意，上面的代码不仅将循环的边缘绘制为红色，还将循环的所有和弦绘制为红色。

**更新**：如果上面代码中的第 3 行由于某种原因对您不起作用，您可以将第 2 行和第 3 行替换为以下内容：

```
g.es["color"] = ["red" if (edge.source in vertex_set and \
                           edge.target in vertex_set) else "black" \
                 for edge in g.es] 
```*

# c - 是否有 strcpy_s 和/或 TR24731-1 的免费实现？

> ID：10067728
> 
> 赞同：16
> 
> 时间：2012-04-09T00:32:20.377
> 
> 标签：c, string, security, cross-platform, tr24731

我有一个混合 C 和 C++ 的旧项目。它广泛使用 C 字符串和`strcpy`, `strcat`,`strncpy`等`strncat`。我发现了许多缓冲区溢出，我想使用更安全的函数，例如`strcpy_s`. MSVC 包括这些功能，但我需要一些可以在各种平台上运行的东西——至少是 linux、osx 和 windows。

我确实知道`strlcpy`，但正如很多人所指出的（[示例](http://lwn.net/Articles/333934/)），这确实不是一种改进。

* * *

`strcpy_s`那么： ,`strcat_s`等或整个 ,是否有任何免费实现[`TR24731-1`](http://www.open-std.org/JTC1/SC22/WG14/www/projects#24731-1)？

我需要的东西是`public domain`or `BSD`，但如果您知道其他许可证下的实现，请继续列出它们 - 我相信其他人会受益。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-09T00:37:19.363

尝试使用[Safe C](http://sourceforge.net/projects/safeclib/)库。它在[MIT 许可](http://www.opensource.org/licenses/MIT)下，并根据此[列表](http://www.openwatcom.org/index.php/Safer_C_Library)实现您正在寻找的功能：

> Safe C 库根据 ISO/IEC TR24731 提供边界检查内存和字符串函数。这些函数是现有标准 C 库的替代函数，可促进更安全、更安全的编程

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-09T00:38:18.497

您可以使用`memcpy`等`memset`，它们比字符串函数更便携且更安全。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T00:54:59.487

为什么不使用`strncpy`and `strncat`？与`strlcpy`and相反`strlcat`，它们是标准的 C 函数。这些功能并不完美，但您可以安全地使用它们。

还要注意，边界检查`_s`功能在当前标准中是可选的。

# apache - 使用 Apache 进行快速 SHA-2 身份验证，有可能吗？

> ID：10067729
> 
> 赞同：0
> 
> 时间：2012-04-09T00:32:27.027
> 
> 标签：apache, sha256, sha2, mod-auth

好吧，我花了几天时间研究这个，我不敢相信 Apache 原生支持的散列函数已经过时了。

我发现了几种方法来做到这一点，它们是 mod_perl 和 mod_authnz_external，它们都太慢了，因为只要调用受保护目录中的任何对象，apache 就会运行它。这意味着用户可能必须在单个会话中进行数百次身份验证。

有没有人设法让 Apache 使用比 MD5 和 SHA-1 更安全的东西，而无需将身份验证从 Apache 移开？Salted SHA-2 将是一个真正的奖励。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-15T01:36:32.807

如果你在 GNU/Linux 系统上使用过去 5 年左右发布的 glibc2 版本，你可以修改 htpasswd 的 crypt() 实现，在 salt 前面加上“$6$”，然后就很简单了作为：

```
 # htpasswd -d -c .htpasswd someusername 
```

当 salt 以“$6$”开头时，glibc2 将使用 salted SHA-512，之后最多 16 个字符是 salt，范围为 [a-zA-Z0-9./]。

见 man 3 地穴。

我不知道有任何补丁可以支持这一点，但它应该是一个简单的补丁。

编辑：我还想提一下，如果您的攻击者足够坚定，那么一轮甚至加盐的 SHA-512 是易碎的。我建议并且在我能够编辑的大多数事情中使用 128000 轮带有 HMAC-SHA512 的 PBKDF2，但这将是一个非常广泛的编辑，除非您想将 htpasswd 与具有 PKCS5_PBKDF2_HMAC 的 openssl 链接起来（） 功能。

编辑 2：此外，如果您有兴趣，使用 openssl 进行强散列并不难：

```
abraxas ~ # cat pbkdf2.c 

#include <string.h>
#include <stdio.h>
#include <openssl/evp.h>
#include <openssl/sha.h>

#define PBKDF2_SALT_PREFIX          "$pbkdf2sha512$"
#define PBKDF2_SALT_PREFIX_LENGTH   strlen(PBKDF2_SALT_PREFIX)
#define PBKDF2_PRF_ALGORITHM        EVP_sha512()
#define PBKDF2_DIGEST_LENGTH        SHA512_DIGEST_LENGTH
#define PBKDF2_SALT_LENGTH          32
#define PBKDF2_RESULT_LENGTH        PBKDF2_SALT_PREFIX_LENGTH + (2 * PBKDF2_DIGEST_LENGTH) + PBKDF2_SALT_LENGTH + 2
#define PBKDF2_ROUNDS               128000

void hash_password(const char* pass, const unsigned char* salt, char* result)
{
    unsigned int i;
    static unsigned char digest[PBKDF2_DIGEST_LENGTH];
    memcpy(result, PBKDF2_SALT_PREFIX, PBKDF2_SALT_PREFIX_LENGTH);
    memcpy(result + PBKDF2_SALT_PREFIX_LENGTH, salt, PBKDF2_SALT_LENGTH);
    result[PBKDF2_SALT_PREFIX_LENGTH + PBKDF2_SALT_LENGTH] = '$';
    PKCS5_PBKDF2_HMAC(pass, strlen(pass), salt, PBKDF2_SALT_LENGTH, PBKDF2_ROUNDS, PBKDF2_PRF_ALGORITHM, PBKDF2_DIGEST_LENGTH, digest);
    for (i = 0; i < sizeof(digest); i++)
        sprintf(result + PBKDF2_SALT_PREFIX_LENGTH + PBKDF2_SALT_LENGTH + 1 + (i * 2), "%02x", 255 & digest[i]);
}

int main(void)
{
    char result[PBKDF2_RESULT_LENGTH];
    char pass[] = "password";
    unsigned char salt[] = "178556d2988b6f833f239cd69bc07ed3";
    printf("Computing PBKDF2(HMAC-SHA512, '%s', '%s', %d, %d) ...\n", pass, salt, PBKDF2_ROUNDS, PBKDF2_DIGEST_LENGTH);
    memset(result, 0, PBKDF2_RESULT_LENGTH);
    hash_password(pass, salt, result);
    printf("Result: %s\n", result);
    return 0;
}

abraxas ~ # gcc -Wall -Wextra -O3 -lssl pbkdf2.c -o pbkdf2
abraxas ~ # time ./pbkdf2 

Computing PBKDF2(HMAC-SHA512, 'password', '178556d2988b6f833f239cd69bc07ed3', 128000, 64) ...
Result: $pbkdf2sha512$178556d2988b6f833f239cd69bc07ed3$3acb79896ce3e623c3fac32f91d4421fe360fcdacfb96ee3460902beac26807d28aca4ed01394de2ea37b363ab86ba448286eaf21e1d5b316149c0b9886741a7

real    0m0.320s
user    0m0.319s
sys 0m0.001s

abraxas ~ # 
```

# php - 如何使用 PHP 检索特定的重复数组值

> ID：10067731
> 
> 赞同：-2
> 
> 时间：2012-04-09T00:32:30.497
> 
> 标签：php, arrays, unique

```
$array = array(
array(
    'id' => 1,
    'name' => 'John Doe',
    'upline' => 0
),
array(
    'id' => 2,
    'name' => 'Jerry Maxwell',
    'upline' => 1
),
array(
    'id' => 3,
    'name' => 'Roseann Solano',
    'upline' => 1
),
array(
    'id' => 4,
    'name' => 'Joshua Doe',
    'upline' => 1
),
array(
    'id' => 5,
    'name' => 'Ford Maxwell',
    'upline' => 1
),
array(
    'id' => 6,
    'name' => 'Ryan Solano',
    'upline' => 1
),
array(
    'id' =>7,
    'name' => 'John Mayer',
    'upline' => 3
), 
```

); 我想做一个像这样的功能：

```
function get_downline($userid,$users_array){
} 
```

然后我想返回一个包含所有用户上线键的数组，其值为 $userid。我希望任何人都可以提供帮助。请...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T00:53:50.987

你可以用一个简单的循环来完成，但让我们利用这个机会来演示 PHP 5.3 的匿名函数：

```
function get_downline($id, array $array) {
    return array_filter($array, function ($i) use ($id) { return $i['upline'] == $id; });
} 
```

顺便说一句，我不知道这是否是你想要的，因为你的问题不是很清楚。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T00:59:27.280

如果你需要通过 $id 搜索你的数组：

```
foreach($array as $value)
{
   $user_id = $value["id"];
   $userName = $value["name"];
   $some_key++;

   $users_array[$user_id] = array("name" => $userName, "upline" => '1');
}

function get_downline($user_id, $users_array){
     foreach($users_array as $key => $value)
     {
         if($key == $user_id)
         {
              echo $value["name"];
              ...do something else.....
         }
     }
} 
```

或按“上线”搜索：

```
function get_downline($search_upline, $users_array){
         foreach($users_array as $key => $value)
         {
             $user_upline = $value["upline"];
             if($user_upline == $search_upline)
             {
                  echo $value["name"];
                  ...do something else.....
             }
         }
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T00:59:43.273

**代码 ：**

```
function get_downline($userid,$users_array) 
{
    $result = array();

    foreach ($users_array as $user)
    {
        if ($user['id']==$userid)
            $result[] = $user['upline'];
    }
    return result;
}
?> 
```

**示例用法：**

```
get_downline(4,$array); 
```

# c# - ThreadPool.QueueUserWorkItem NullReferenceException

> ID：10067733
> 
> 赞同：3
> 
> 时间：2012-04-09T00:32:40.557
> 
> 标签：c#, asp.net, threadpool, nullreferenceexception, httpcontext

为什么我会收到此错误。我的变量从请求中获取名称，我也尝试了“data.qext”，但视觉工作室给了我错误。

我的 WebsiteRoot/uploads/files/test.pdf 中有“test.pdf”文件，但仍然有错误。也许我错过了什么？

查看图片了解详细描述： http: [//prntscr.com/7wnid](http://prntscr.com/7wnid)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T00:48:02.893

你可以试试这个方法，而不是`HttpContext.Current.Server.MapPath`：

```
System.Web.Hosting.HostingEnvironment.MapPath() 
```

这样做，就不需要`HttpContext`.

# c++ - 朋友功能是否必须在同一个文件中？

> ID：10067734
> 
> 赞同：2
> 
> 时间：2012-04-09T00:33:04.733
> 
> 标签：c++, inheritance, friend, protected, access-specifier

我实际上正在测试一个文件并且我有一种情况，我需要从 main.cpp 访问该类的一些受保护成员。我尝试添加`main()`为朋友，但没有成功，并得知它不起作用，所以我将所有内容`main()`移至 a`test ()`并`test()`成为朋友。它仍然显示错误。

例子是

```
 //--File.hpp

 namespace Files {

 class File {
          public:
                File(long word_):word(word_) {}
          protected:
                long word;
          private:
                friend int test();
 };
 }//ns:Files

 //--List_File.hpp

 namespace Files {
 class List_File :public File {
         public:
               List_File() : File(sizeof(int) + sizeof(long)) {}
         private:
              friend int test();
 };  
 }//ns:Files 

//--main.cpp

  using namespace Files;

  int test() {

       File *pd = new List_File();
       assert(pd->word == 12); //LINE 34
       return 0;
  }

  int main() {
       test();
       return 0;
  } 
```

//它在第 34 行显示错误：Base::value 受到保护。请指教。

```
 g++ -O -Wall -Wno-unused -o a.out File.cpp List_File.cpp Data_File.cpp               
    Free_List_File.cpp main.cpp
    File.hpp: In function ‘int test()’:
    File.hpp:30:7: error: ‘long int Files::File::word’ is protected
    main.cpp:34:16: error: within this context
    make: *** [a.out] Error 1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T00:45:54.907

不，它绝对不必在同一个文件中，但它显然必须“知道”类是什么，即：具有类定义的头文件应该包含在实现函数的文件中。如评论所述，您的代码应该没问题。

**在你添加了一些上下文之后**

您的`test`函数不在`Files`命名空间中。如果您希望它位于全局上下文中，则应将其视为`::test`命名空间中的“”，否则编译器可能会认为“ `Files::test`”是友元函数，而不是`::test`您的情况中的“”。找不到正式的标准参考，但我很确定是这样。请注意，您在此处执行前向声明，因此没有默认回退到名称解析的上层范围。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T00:49:59.367

也许您在 Derived 类中缺少继承声明？

```
 class Derived : public Base { 
```

我已经测试了您的代码（包括继承声明）并且没有产生错误

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-30T16:31:35.007

littedev 是对的！根据littedev的评论更新了代码。。

```
//--File.hpp   
namespace Files {   
    class File {
        public:
            File(long word_):word(word_) {}
        protected:
            long word;
        private:
            friend int test();
    };  
}//ns:Files    

//--List_File.hpp   

namespace Files {
    class List_File :public File {
        public:
            List_File() : File(sizeof(int) + sizeof(long)) {}          \
        private:
            friend int test();  
    };    
}//ns:Files     

//--main.cpp    

namespace Files{    
    int test() {         
        File *pd = new List_File();
        assert(pd->word == 12); //LINE 34
        return 0;
    }

    int main() {
        Files::test();
        return 0;
    } 
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-09T01:47:17.220

我猜您正在尝试访问 Files 类定义范围之外的受保护变量。我会推荐一个函数，它在被调用时返回变量 word 并使用它而不是尝试访问类定义之外的受保护变量。我可能是错的，因为我不确定受保护变量的范围是什么（它是否仅限于类声明或是否可以在类定义之外访问），但我很确定我是对的，因为受保护的变量就像私有变量。它们只能在类范围内访问。如果我错了，请纠正我。

编辑：哦，对不起，我没有意识到你在做什么。littleadv 是对的，您的函数声明不在文件命名空间内。

# google-docs-api - 如何按名称获取文件夹？

> ID：10067743
> 
> 赞同：1
> 
> 时间：2012-04-09T00:34:38.457
> 
> 标签：google-docs-api

抱歉，如果这已经在[https://groups.google.com/forum/embed/?place=forum/google-documents-list-api#!forum/google-documents-list-api](https://groups.google.com/forum/embed/?place=forum/google-documents-list-api#!forum/google-documents-list-api)得到解决，但我是那里没有看到搜索工具，可能是因为论坛已关闭。

我可能遗漏了一些东西，但基于[https://developers.google.com/google-apps/documents-list/#getting_a_list_of_documents_and_files](https://developers.google.com/google-apps/documents-list/#getting_a_list_of_documents_and_files)似乎无法将 ?title=blah 或 ?q=blah 与任何以下内容并获得预期结果： - ?showfolders=true - /contents/-/folder - /-/folder

另一种方法是使用 ?showfolders=true 获取所有文件和文件夹，然后确定哪些是文件夹： - 是否有一个元素将资源标识为文件夹而不是文件？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-13T02:58:16.297

您还可以查看 Cloudward 通过 ID 和名称发布 Google 文档的方法。以下是您可以使用的两个云片段：

按名称发布 Google 文档： [https ://snippets.cloudward.com/app_listing.espx?template_id=1bbba611a85b3b6b4a3ea274f9ad3796&account_id=](https://snippets.cloudward.com/app_listing.espx?template_id=1bbba611a85b3b6b4a3ea274f9ad3796&account_id=)

按 ID 发布 Google 文档： [https ://snippets.cloudward.com/app_listing.espx?template_id=51925e7ed2166d7d83a8c32fa1ee88dd&account_id=](https://snippets.cloudward.com/app_listing.espx?template_id=51925e7ed2166d7d83a8c32fa1ee88dd&account_id=)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T02:57:46.030

您可以通过检查资源是否具有`scheme="http://schemas.google.com/g/2005#kind"`和的类别来检查资源是否为文件夹`term="http://schemas.google.com/docs/2007#folder"`：

例如：

```
<category scheme="http://schemas.google.com/g/2005#kind"
  term="http://schemas.google.com/docs/2007#folder"/> 
```

# c++ - 通用等效于 std 函数对象

> ID：10067745
> 
> 赞同：4
> 
> 时间：2012-04-09T00:34:58.140
> 
> 标签：c++, templates, generics, boost, stl

boost 中是否有任何函数对象是 std::equal_to、std::greater 等函数对象族的通用等价物？

本质上， std::equal_to 应该变成类似

```
struct generic_equal_to
{
    template <class T, class U>
    bool operator()(const T& t, const U& u) const
    {
        return t == u;
    }
}; 
```

我可以看到 std::plus 等的通用版本由于返回类型的问题可能会变得更加棘手（尽管`decltype`可以解决这个问题）。不过，我看不出 std::equal_to 函数对象本身需要模板参数的任何可能原因。

这些版本肯定存在于 boost 或 STL 中的某个地方吗？当然，它们写起来很简单，但我非常不喜欢复制库代码，尤其是对于像这样看似微不足道的东西。

**编辑**：

关于为什么我想要这个而不是使用 lambdas 或其他函数对象生成方法的一些上下文：

因此，我正在编写一个通用的`boost::fusion`序列比较函数：

```
template <class T>
bool sequence_equal(const T& left, const T& right)
{
    return fusion::all(
        fusion::zip(left, right),
        fusion::fused<generic_equal_to>());
} 
```

请注意这`fusion::fused<generic_equal_to>`部分，这会导致您实际上无法按类型指定一个`boost::lambda`或`boost::phoenix`函数对象。我想一种解决方案可能是 decltype：

```
fusion::fused<decltype(_1 == _2)>() 
```

不过，这似乎很尴尬，甚至可能不起作用，具体取决于实施方式`boost::lambda`或`boost::phoenix`实施方式-我真的不确定。

我知道你可以用`fusion::make_fused`它来解决整个问题，但是你必须实例化函数对象。那么，我想到的解决方案将是一个非模板`equal_to`结构——我称之为 mine `generic_equal_to`。

我知道这是一个非常微不足道的问题 - 毕竟，它`make_fused(_1 == _2)`可能会内联到与`fused<generic_equal_to>`. 我简直不敢相信`generic_equal_to`在任何地方的 boost 或 STL 中都没有函数对象，因此提出了这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T03:00:24.090

我认为没有任何东西像您要求的那样直接，但是有一些实用程序不仅涵盖了您的用例，而且还超越了您的用例。它们是[Boost.Lambda](http://www.boost.org/libs/lambda)和[Boost.Phoenix](http://www.boost.org/libs/spirit/phoenix/)（后者是 lambda 库的更通用的继承者）。

使用 Boost.Lambda 进行泛型相等的示例：

```
#include <boost/lambda/lambda.hpp>
#include <iomanip>
#include <iostream>

struct foo {};

bool operator==(foo, foo) { return true; }
bool operator==(foo, int) { return false; }

template <typename T, typename U, typename Func>
void f(const T& x, const U& y, Func func)
{
    std::cout << func(x, y) << std::endl;
}

int main()
{
    using namespace boost::lambda; // for placeholders
    std::cout << std::boolalpha;

    foo a, b;
    int i = 0;

    f(a, b, _1 == _2);
    f(a, i, _1 == _2);
} 
```

同样，对于凤凰：

```
#include <boost/phoenix.hpp>
#include <iomanip>
#include <iostream>

struct foo {};

bool operator==(foo, foo) { return true; }
bool operator==(foo, int) { return false; }

template <typename T, typename U, typename Func>
void f(const T& x, const U& y, Func func)
{
    std::cout << func(x, y) << std::endl;
}

int main()
{
    using namespace boost::phoenix::arg_names; // for placeholders
    std::cout << std::boolalpha;

    foo a, b;
    int i = 0;

    f(a, b, arg1 == arg2);
    f(a, i, arg1 == arg2);
} 
```

这些中的每一个都可以以明显的方式扩展以支持其他运算符（更一般地，扩展到其他表达式）。我个人会选择 Phoenix，因为如果你发现你需要的功能比 lambda 提供的更多，你最终不会同时包含两者。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-12-27T00:34:00.840

现在在 C++14 中有`std::equal_to<void>`（也可以用作`std::equal_to<>`）

> `std::equal_to<>`是`std::equal_to`推导参数和返回类型的特化。

```
template< class T, class U>
constexpr auto operator()( T&& lhs, U&& rhs ) const
  -> decltype(std::forward<T>(lhs) == std::forward<U>(rhs)); 
```

> 返回 lhs 和 rhs 之间相等比较的结果。

[文档](http://en.cppreference.com/w/cpp/utility/functional/equal_to_void)

# jquery - 从 Phonegap 和 jQuery 中调用 JSONP 时出现未知错误

> ID：10067752
> 
> 赞同：1
> 
> 时间：2012-04-09T00:37:22.080
> 
> 标签：jquery, jquery-mobile, cordova

我有以下html代码：

```
<!DOCTYPE html> 
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
        <meta name="viewport" content="width=device-width, initial-scale=1"> 
        <script src="js/jq.js"></script>
        <script src="js/jqm.js"></script>
        <script src="js/jstore.js"></script>
        <script src="js/progressbar.js"></script>
        <script src="js/sql.js"></script>
        <script src="js/phonegap-1.4.1.js"></script>
        <script src="js/sha512.js"></script>
    </head>
    <body>
        <!-- Start of first page: #one -->
        <div data-role="page">
            <!-- header -->
            <div data-role="header">
                <table width="100%" border="0" cellpadding="0" cellspacing="0">
                    <tr>
                        <td>

                        </td>
                        <td>
                        </td>
                    </tr>
                </table>
            </div>
            <!-- /header -->
            <div data-role="content" data-theme="a">
                <center>
                    <span class="progressBar" id="pb1"></span>
                    <br />
                    Initial Syncronisation in progress!
                </center>
            </div>  
            <!-- footer -->
            <div data-role="footer">

            </div>
            <!-- /footer -->
            <script lang="text/javascript">
                document.addEventListener("deviceready", onDeviceReady, false);
                function onDeviceReady() {
                   $("#pb1").progressBar();
                   $("#pb1").progressBar(5);
                   $.ajax({
                        url: 'https://url/user/'+$.jStorage.get("username","false")+'/modeSet/'+$.jStorage.get("password","false")+'/subSequence/'+hex_md5(new Date().getTime())+'.html',
                        dataType:'jsonp',
                        jsonp:'jsonp_callback',
                        jsonpCallback:'infoData',
                         success: function (data) {
                                alert('success');
                       },
                       error:function (xhr, ajaxOptions, thrownError){
                            alert(xhr.status);
                            alert(thrownError);
                        } 
                   });
                }
            </script>
        </div>
    </body>
</html> 
```

当我调用该页面时，我收到一个错误代码 200 和一个包含以下内容的附加警报框：

```
Error: infoData was not called! 
```

它在搭载 Android 4.0.4 的真正三星 Galaxy S2 上运行。我有互联网连接，但我不知道哪里出错了。

服务器返回的文档：

```
infoData({"validJsonDocument":"yes"}); 
```

我将 Phonegap 1.4.1 与 jQuery 1.7.1 和 jQuery mobile up2date 一起使用

其他库实际上没有被使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T00:51:04.173

JSONP 代表 JSON with Padding。填充表示将 JSON 响应发送回客户端时包裹在其周围的函数名称。

当收到结果时，它实际上被视为纯 JavaScript，并按原样处理。因此，将调用包裹在 JSON 周围的函数。

这意味着，为了让 JSONP 正常工作，您的 DOM 中必须存在一个加载的函数，该函数与包装 JSON 响应的函数的名称相匹配。

此外，您已使用[“jsonCallback”jQuery AJAX 属性](http://api.jquery.com/jQuery.ajax/)将“infoData”指定为回调函数的名称：

```
jsonpCallback    String, Function 
```

> 指定 JSONP 请求的回调函数名称。将使用此值代替 jQuery 自动生成的随机名称。最好让 jQuery 生成一个唯一的名称，因为这样可以更轻松地管理请求并提供回调和错误处理。当您想要启用更好的 GET 请求浏览器缓存时，您可能需要指定回调。从 jQuery 1.5 开始，您还可以为此设置使用函数，在这种情况下，jsonpCallback 的值设置为该函数的返回值。

尝试在页面上定义一个名为“infoData”的函数，该函数采用单个参数，这将使您摆脱此错误。

```
function infoData(jsonObj) {
    alert(JSON.stringify(jsonObj));  // print the raw JSON object
    alert(jsonObj.validJsonDocument); // access the property in your JSON object.
} 
```

或者，您可以接受 jQuery 文档的建议并完全删除 jsonpCallback 选项，并依赖您已经定义的成功回调。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T10:49:47.237

我将代码修改为以下内容：

```
<script lang="text/javascript">
            document.addEventListener("deviceready", onDeviceReady, false);
            function onDeviceReady() {
               $("#pb1").progressBar(5);
               $.ajax({           
                    url: 'http:url/jsonp.html', 
                    dataType: 'jsonp',
                    jsonp: 'callback',
                    jsonpCallback: 'jsonpCallback',
                    success: function (data) {
                            $("#pb1").progressBar(25);
                            alert(data.version);
                    },
                    error:function (xhr, ajaxOptions, thrownError){
                        alert(xhr.status);
                        alert(thrownError);
                    }                       
                }); 

            }
            function jsonpCallback(data){
                alert(data.message);
            }
        </script> 
```

如果我在谷歌浏览器中打开页面，它可以正常工作。如果我在 android 浏览器中打开它，它会做同样的事情。给我一个错误 200 并说我没有调用 jsonpCallback。我真的不知道为什么剧本让我这么难过。克里斯

# json - 在 Grails 中编组 Joda LocalTime

> ID：10067755
> 
> 赞同：0
> 
> 时间：2012-04-09T00:37:54.207
> 
> 标签：json, grails, groovy, jodatime

我正在尝试编组一个包含 LocalTime joda 类型时间的对象。如果您尝试返回晚于上午 12 点的时间，则会出现问题，因此在下面的示例中，如果课程开始时间是 14:00（下午 2 点），那么时间将转换为 02:00 而不是 14:00指定的格式 (hh:mm)。

所以我的 BootStrap.groovy 文件包含以下代码：

```
 JSON.registerObjectMarshaller(Lesson) {
    def returnArray = [:]
    returnArray['start'] = it.start.toString("hh:mm")
    return returnArray
   } 
```

知道如何解决吗？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T16:36:10.673

好吧，要获得 24 小时格式，您需要 HH:mm，这就是您获得 02:00 而不是 14:00 的原因

# iphone - xcode 4.2 循环通过 XML 数据元素

> ID：10067759
> 
> 赞同：1
> 
> 时间：2012-04-09T00:39:25.953
> 
> 标签：iphone, objective-c, parsing, xcode4.2, nsxmlparser

我对我应该如何为我当前的 iPhone 应用程序项目循环遍历 XML 元素感到非常困惑。我将展示我的代码，然后澄清我的问题。

这是我正在使用的示例 XML：

```
<restaurant_details>
    <total_results>90</total_results>
    <restaurant>
        <name>Through the Garden</name>
        <distance_from_current_location>0.55</distance_from_current_location>
        <restaurant_id>123</restaurant_id>
        <longitude>-84.373734</longitude>
        <latitude>39.258606</latitude>
        <address>10738 Kenwood Rd  | cincinnati ,OH | 45242</address>
        <phone_number>513-791-2199</phone_number>
        <restaurant_type>General</restaurant_type>
    </restaurant>
</restaurant_details> 
```

获取我的表的数据：

```
- (void)get_table_data {
    NSString *day = [self dateInFormat:@"%A"];

    NSLog (@"At get_table_data");

    NSURLRequest *theRequest = [NSURLRequest requestWithURL:[NSURL URLWithString:@"http://www.url.com"] cachePolicy:NSURLRequestUseProtocolCachePolicy timeoutInterval:60.0];
    NSURLConnection *theConnection = [[NSURLConnection alloc] initWithRequest:theRequest delegate:self];

    if (theConnection) {
        NSLog (@"At connection");
        receivedData = [NSMutableData data];
    }
}

- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response {
    [receivedData setLength:0];
}

- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data {
    [receivedData appendData:data];
}

- (void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error {

}

-(void)connectionDidFinishLoading:(NSURLConnection *)connection {
    //      NSString *theXML = [[NSString alloc] initWithBytes: [myWebData mutableBytes] length:[myWebData length] encoding:NSUTF8StringEncoding];
    //      NSLog(@"%@",theXML);[theXML release];   
    if(parser){
        parser = nil;
    }

    parser = [[NSXMLParser alloc] initWithData: receivedData];
    [parser setDelegate: self];
    [parser setShouldResolveExternalEntities: YES];
    [parser parse];
} 
```

我的解析器代码：

```
- (void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qualifiedName attributes:(NSDictionary *)attributeDict{
    NSLog (@"At parser");
    currentElement = elementName;

    if ([currentElement isEqualToString:@"restaurant_details"]) {
        if ([currentElement isEqualToString:@"total_results"]) {
            //NSLog(@"Element: %@", currentElement);
        }else if ([currentElement isEqualToString:@"restaurant"]) {
            restaurantObj = [[DOR_RestaurantClass alloc]init];
        }
    }
}

- (void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string{
    if([currentElement isEqualToString:@"name"]) {
        restaurantObj.name=[NSString stringWithFormat:@"%@",string];
        //NSLog(@"Name to be saved in Array :- %@",string);
    }
    if([currentElement isEqualToString:@"distance_from_current_location"]) {
        restaurantObj.distance=[NSString stringWithFormat:@"%@",string];
        //NSLog(@"Name to be saved in Array :- %@",string);
    }
    if([currentElement isEqualToString:@"restaurant_id"]) {
        restaurantObj.restId=[NSString stringWithFormat:@"%@",string];
        //NSLog(@"Name to be saved in Array :- %@",string);
    }
    if([currentElement isEqualToString:@"address"]) {
        NSArray *stringArray = [string componentsSeparatedByString:@" | "];
        restaurantObj.address=[stringArray objectAtIndex:0];
        restaurantObj.address2=[stringArray objectAtIndex:1];
        restaurantObj.address3=[stringArray objectAtIndex:2];
        //NSLog(@"Name to be saved in Array :- %@",string);
    }
    if([currentElement isEqualToString:@"phone_number"]) {
        restaurantObj.phone=[NSString stringWithFormat:@"%@",string];
        //NSLog(@"Name to be saved in Array :- %@",string);
    }
    if([currentElement isEqualToString:@"description"]) {
        restaurantObj.description=[NSString stringWithFormat:@"%@",string];
        //NSLog(@"Name to be saved in Array :- %@",string);
    }
    if([currentElement isEqualToString:@"image_url"]) {
        restaurantObj.image=[NSString stringWithFormat:@"%@",string];
        //NSLog(@"Name to be saved in Array :- %@",string);
    }
    if([currentElement isEqualToString:@"restaurant_type"]) {
        //restaurantObj.Name=[NSString stringWithFormat:@"%@",string];
        //NSLog(@"Name to be saved in Array :- %@",string);
    }
    NSLog (@"At parser2");
    if(!currentElementValue)
        currentElementValue=[[NSMutableString alloc] initWithString:string];
    else
        [currentElementValue appendString:string];
    NSLog(@"the parser just found this text in a tag:%@",string);
}

-(void)parser:(NSXMLParser*)parser didEndElement:(NSString*)elementName namespaceURI:(NSString*)namespaceURI qualifiedName:(NSString*)qualifiedName {
    NSLog(@"Current element in End Element Category:- %@",currentElement);
    if([elementName isEqualToString:@"restaurant"]) {
        [listItems addObject:restaurantObj];
        NSLog(@"Array: %@", listItems);
    }else{
        currentElementValue=nil;
    }

} 
```

这是我的餐厅课程的 .h：

```
#import <Foundation/Foundation.h>

@interface DOR_RestaurantClass : NSObject

@property (nonatomic, retain) NSString *restId;
@property (nonatomic, retain) NSString *image;
@property (nonatomic, retain) NSString *name;
@property (nonatomic, retain) NSString *description;
@property (nonatomic, retain) NSString *distance;
@property (nonatomic, retain) NSString *address;
@property (nonatomic, retain) NSString *address2;
@property (nonatomic, retain) NSString *address3;
@property (nonatomic, retain) NSString *phone;
@property (nonatomic, retain) NSString *expires;

@end 
```

我的.m：

```
#import "DOR_RestaurantClass.h"

@implementation DOR_RestaurantClass
@synthesize restId;
@synthesize image;
@synthesize name;
@synthesize description;
@synthesize distance;
@synthesize address;
@synthesize address2;
@synthesize address3;
@synthesize phone;
@synthesize expires;

@end 
```

我正在获取我的数据等等，所以这不是问题。我的问题是：在我的 XML 数据中有多个“餐厅”标签，我如何对 XML 进行排序以便将餐厅数据保存在一起？我来自 PHP，所以我会在餐厅标签上做一个 foreach，但我不确定 NSXMLParser 应该如何保持数据分离。最后，我会将这些信息放入 NSMutableArray 中。我只是不知道从哪里开始，也找不到任何这样做的好例子。非常感谢任何和所有帮助。

**这已更新**

我的数组`listItems`(NSMutableArray) 是`null`当我将它打印到`NSLog`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T06:13:05.330

首先创建一个仅包含 .h 和 .m 文件的 Obj c 类。并在其中创建一些具有名称、距离、经度、纬度等属性的 NSString 变量。

现在，代码部分：-

在 didStartElement

在餐厅标签中创建一个我刚刚告诉你创建的类的对象（初始化对象）：-

```
currentElement = elementName;

    if([currentElement isEqualToString:@"restaurant"]) {
        classObj = [[MyRestaurentClass alloc]init];
    } 
```

现在在 foundCharacters 中找到像这样的其他标签：-

```
if([currentElement isEqualToString:@"name"]) {
        classObj.Name=[NSString stringWithFormat:@"%@",string];
        NSLog(@"Name to be saved in Array :- %@",string);
    }
    if ( [currentElement isEqualToString:@"longitude"])
    {
        classObj.longitude =[NSString stringWithFormat:@"%@",string];            
    }
} 
```

现在是 didEneElement 的最后一部分：-

在 Parser Class 中创建一个 MutubaleArray 并在 didEndElement 中的该数组中添加 classObj ：-

```
if([elementName isEqualToString:@"restaurent"]) {
        NSLog(@"Current element in End Element Category:- %@",currentElement);
        [ObjectsMutableArray addObject:classObj];

    } 
```

就这样。你完成了解析..

**更新**

首先，您不必在 If 循环中这样写，即：-

```
- (void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qualifiedName attributes:(NSDictionary *)attributeDict{
    NSLog (@"At parser");
    currentElement = elementName;

    if ([currentElement isEqualToString:@"restaurant_details"]) {
        if ([currentElement isEqualToString:@"total_results"]) {
            //NSLog(@"Element: %@", currentElement);
        }else if ([currentElement isEqualToString:@"restaurant"]) {
            restaurantObj = [[DOR_RestaurantClass alloc]init];
        }
    }
} 
```

我为 didStartElement 写的答案足够了，因为每个标签都调用了 didStartElement。

请参阅一旦您创建了一个具有符合您的 XML 的 NSStrings 的类。只需创建该类的对象并在 didStartElement 中对其进行初始化。在 foundCharacters 中，您将根据 If 条件循环在 classObject 变量中添加所需数据。每当 XMlParser 进入`</restaurent>`Tag 时，它就会进入 didEndElement 方法，您只需像在 didEndElement 中那样将该类对象（对象）放入该数组中。

**好的关于您的 NSMutableArray，您是否像这样在 didStartDocument 中初始化了数组：-**

*   (void)parserDidStartDocument:(NSXMLParser *)parser{ listItems = [[NSMutableArray alloc]init]; }

我已更改上述代码，因此请再次仔细阅读整个答案。如果你还有任何疑问给我发短信...

# iphone - ALAsset 图像大小

> ID：10067765
> 
> 赞同：4
> 
> 时间：2012-04-09T00:41:18.590
> 
> 标签：iphone, objective-c, ios, cocoa-touch, alassetslibrary

给定一个代表照片的 ALAsset，是否可以在不将图像加载到 UIImageView 并且也不使用 aspectRationThumnail 方法的情况下检索照片的大小（高度和宽度）？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-10T10:39:03.067

请注意：iOS 5.1 为 ALAssetRepresentation 实例引入了新的属性维度。这将返回具有原始图像尺寸的 CGSize 结构，并且可能是将来解决此问题的最佳解决方案。

干杯，

亨德里克

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-06-16T13:18:11.943

```
float width = asset.defaultRepresentation.dimensions.width;
float height = asset.defaultRepresentation.dimensions.height; 
```

它快速，稳定，并给出了实际尺寸。我已经将它与 ALAsset 视频一起使用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-09T23:36:18.587

访问图像大小的更简单方法是通过`[ALAssetRepresentation metadata]`. 在我测试的图像上，它`NSDictionary`包含名为`PixelWidth`and的键`PixelHeight`，它们是`NSNumber`具有您期望值的对象。

但是，对于您将找到的确切键似乎没有特别的保证，因此请确保您的应用程序可以处理这些键不在元数据中的情况。另请参阅[iOS ALAsset 图像元数据](http://sarofax.wordpress.com/2011/07/10/alasset-image-metadata/)，了解有关速度和线程安全的一些注意事项。

## 比较

我在 iPad 的整个资产库上测试了这两种方法——在 CGImageSourceRef 中加载图像数据或读取元数据。两种方法都在 FLT_EPSILON 中返回相同的大小。除了需要双倍时间的 2 个异常值外，16 次重复的运行时间非常相似：

```
方法 | 平均时间 +/- 95% 置信度
来自 CGImageSourceRef 的大小 | 0.1787 +/- 0.0004
元数据的大小 | 0.1789 +/- 0.0015

```

因此，这两种方法都没有性能优势。元数据字典完全可以通过读取图像数据按需构建。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-09T02:30:32.707

**更新**

正如评论中所指出的，这不像最初提供的那样工作。我已经修复了它，但它现在加载了 OP 试图避免的所有图像数据。它仍然避免了将数据解压缩为图像的额外且更糟糕的步骤。

1.  获取`defaultRepresentation`ALAsset 的。
2.  获取 ALAssetRepresentation 的数据。
3.  使用[这个方便的 sizeOfImageAtURL](https://gist.github.com/1744633)函数的改编版。谢谢你，什帕科夫斯基。

下面的代码代表上面的步骤。

```
// This method requires the ImageIO.framework
// This requires memory for the size of the image in bytes, but does not decompress it.
- (CGSize)sizeOfImageWithData:(NSData*) data;
{
    CGSize imageSize = CGSizeZero;
    CGImageSourceRef source = CGImageSourceCreateWithData((__bridge CFDataRef) data, NULL);
    if (source)
    {
        NSDictionary *options = [NSDictionary dictionaryWithObject:[NSNumber numberWithBool:NO] forKey:(NSString *)kCGImageSourceShouldCache];

        NSDictionary *properties = (__bridge_transfer NSDictionary*) CGImageSourceCopyPropertiesAtIndex(source, 0, (__bridge CFDictionaryRef) options);

        if (properties)
        {
            NSNumber *width = [properties objectForKey:(NSString *)kCGImagePropertyPixelWidth];
            NSNumber *height = [properties objectForKey:(NSString *)kCGImagePropertyPixelHeight];
            if ((width != nil) && (height != nil))
                imageSize = CGSizeMake(width.floatValue, height.floatValue);
        }
        CFRelease(source);
    }
    return imageSize;
}

- (CGSize)sizeOfAssetRepresentation:(ALAssetRepresentation*) assetRepresentation;
{
    // It may be more efficient to read the [[[assetRepresentation] metadata] objectForKey:@"PixelWidth"] integerValue] and corresponding height instead.
    // Read all the bytes for the image into NSData.
    long long imageDataSize = [assetRepresentation size];
    uint8_t* imageDataBytes = malloc(imageDataSize);
    [assetRepresentation getBytes:imageDataBytes fromOffset:0 length:imageDataSize error:nil];
    NSData *data = [NSData dataWithBytesNoCopy:imageDataBytes length:imageDataSize freeWhenDone:YES];

    return [self sizeOfImageWithData:data];
}

- (CGSize)sizeOfAsset:(ALAsset*) asset;
{
    return [self sizeOfAssetRepresentation:[asset defaultRepresentation]];
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-04-10T20:28:46.243

```
float width = CGImageGetWidth(asset.defaultRepresentation.fullResolutionImage);
float height = CGImageGetHeight(asset.defaultRepresentation.fullResolutionImage); 
```

或相同的`asset.defaultRepresentation.fullScreenImage`...

# javascript - RequireJS 在加载/解析依赖项之前执行文件代码

> ID：10067766
> 
> 赞同：1
> 
> 时间：2012-04-09T00:41:30.550
> 
> 标签：javascript, backbone.js, require, requirejs, amd

Requirejs 似乎允许 rels.js 在加载 Rel 之前运行。[https://github.com/yedi/Avalon/blob/backbone_rewrite/avalon/static/app/modules/collections/rels.js](https://github.com/yedi/Avalon/blob/backbone_rewrite/avalon/static/app/modules/collections/rels.js) 所以当我在 initialize() 函数中调试它时，Rel 是未定义的。模型也没有被定义，因为 Rel 没有被定义。

我似乎无法理解为什么会这样。其他需要相同 Rel 模型的文件似乎没有这个问题。（在[https://github.com/yedi/Avalon/blob/backbone_rewrite/avalon/static/app/modules/views/node.js](https://github.com/yedi/Avalon/blob/backbone_rewrite/avalon/static/app/modules/views/node.js)和[https://github.com/yedi/Avalon/blob/backbone_rewrite/avalon /static/app/modules/views/child.js](https://github.com/yedi/Avalon/blob/backbone_rewrite/avalon/static/app/modules/views/child.js) , Rel 是在我调试时定义的。我需要 Rel 的方式与我在 rels.js 中所做的完全相同）

我的 items.js 集合也有同样的问题。

关于如何调试此问题的任何帮助/建议？（我什至不知道我将如何解决它，而且我已经在这个问题上敲了几天。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T12:55:38.960

你只是有一个循环依赖。您的[集合](https://github.com/yedi/Avalon/blob/backbone_rewrite/avalon/static/app/modules/collections/rels.js)需要[子](https://github.com/yedi/Avalon/blob/backbone_rewrite/avalon/static/app/modules/models/rel.js)模型，反之亦然。杀死`"modules/collections/rels"`子模型中的需求，它不需要知道它将如何包含在集合中。

# php - 编写不断变化的每日消息

> ID：10067767
> 
> 赞同：-1
> 
> 时间：2012-04-09T00:41:52.283
> 
> 标签：php, javascript, mysql, html

我将如何在我的网站上编写每天更改的每日消息？我正在考虑将所有消息预加载到 MySQL 数据库中。

任何帮助，将不胜感激！

谢谢，

我试过了

```
$msg_sql = "SELECT * FROM ".TABLE_PREFIX."quotes ORDER BY rand(curdate()) LIMIT 3";
$msg_res = mysqli_fetch_assoc(mysqli_query($link, $msg_sql)); 
```

但这只是获取第一个 MySQL 结果？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T01:04:15.767

如果您想要每天更改真实消息，您实际上不需要依赖数据库或任何花哨的东西。一个简单的想法可能是创建一个目录（例如 /var/www/motds）并用名为 YYYY-MM-DD.txt 的文件填充它（其中 YYYY 是 4 位数字年份，MM 是两位数字月份数字和 DD是一个 2 位数的日期编号）。

然后，为了显示你的 motd，你唯一需要做的就是：

> ```
> $filename = '/var/www/motds/'.date("Y-m-d").'.txt';
> if (file_exists($filename)) {
>     echo file_get_contents($filename);
> } 
> ```

如果您希望从条目池中获取您的每日消息（您可以预加载），您可以执行以下操作：

```
$files = scandir('/var/www/motds'); // put files into an array
$messagecount = count($files) - 2;  // .. and . shall not be considered
$day = date("z");  // what day do we have today? 
echo file_get_contents('/var/www/motds/' . $files[($day % $messagecount) + 2]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T00:46:42.803

有很多方法可以完成这项工作。您在标签中列出了 PHP，所以可以在这里查看：

[PHP 脚本：今日行情](http://blazonry.com/php/quoteoftheday.php)

或者也许[在这里](http://px.sklar.com/code.html/id=789)

# stata - 如何循环遍历stata中的文件名

> ID：10067768
> 
> 赞同：2
> 
> 时间：2012-04-08T22:16:43.480
> 
> 标签：stata

1）是否可以在stata中创建字符串向量？2）如果是，那么是否可以遍历该向量中的元素，对每个元素执行命令？

要在 stata 中创建单个字符串，我知道你这样做：

```
 local x = "a string" 
```

但是我有大约 200 个数据文件需要循环访问，并且它们不方便以连续后缀命名，如“_2000”“_2001”“_2002”等。事实上，文件名没有押韵或理由，但我这样做了有一个它们的列表，我可以轻松地将其剪切并粘贴到一个字符串向量中，然后像在 MATLAB 中所做的那样，一个一个地调用这个向量的元素。

有没有办法在stata中做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-09T04:18:57.613

在基思的回答之上：您还可以获取目录中的文件列表

```
 local myfilelist    : dir . files "*.dta" 
```

或更一般地说

```
 local theirfilelist : dir <directory name> files <file mask> 
```

见`help extended_fcn`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-09T00:17:35.870

当然——您只需使用典型的本地呼叫创建一个列表。如果你不对整件事加上引号，你的清单可能会很长。

```
local mylist aaa bbb "cc c" dd ee ff 
```

然后你只需使用`foreach`.

```
foreach filename of local mylist {
  use `"`filename'"'
} 
```

使用双引号 ( ``" "'`) 是因为其中一个文件名由于空格而在其周围加上引号。这比放在 `foreach filename in `mylist' {`第一行要快一点。

如果您想操作您的列表，请参阅[`help macrolists`](http://www.stata.com/help.cgi?macrolists)。

相关问题已在stackoverflow上提出> 1次：

*   [在 Stata 中，如何将一长串变量名分配给本地宏？](https://stackoverflow.com/questions/3701823/in-stata-how-do-you-assign-a-long-list-of-variable-names-to-a-local-macro/7827048#7827048)
*   [Stata的R的“％in％”的等效函数](https://stackoverflow.com/questions/5091426/equivalent-function-of-rs-in-for-stata/5093094#5093094)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-06-02T13:12:29.970

许多人可能像我一样想要将两者结合起来。这里是：

```
* Create a local containing the list of files. 
local myfilelist : dir "." files "*.dta"

* Or manually create the list by typing in the filenames.
local myfilelist "file1.dta" "file2.dta" "file3.dta"

* Then loop through them as you need.
foreach filename of local myfilelist {
  use "`filename'"
} 
```

我希望这会有所帮助。请注意，本地/宏被限制为[67,784 个字符](http://www.stata.com/statalist/archive/2004-06/msg00330.html)——当您有一个非常长的文件列表或非常长的文件名时，请注意这一点。

# java - 这个错误代码是什么意思（附代码）

> ID：10067770
> 
> 赞同：1
> 
> 时间：2012-04-09T00:42:10.963
> 
> 标签：java, android

```
@Override
    public void onCancel() {
        // TODO Auto-generated method stub 
```

错误：SoftKeyboard 类型的 onCancel() 方法必须覆盖超类方法 SoftKeyboard.java /EmotePractice/src/com/emote 第 691 行 Java 问题

超一流？？我以为@Override 是为了捕捉语法错误，为什么这么说？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T00:49:55.593

您确定要覆盖的超类有一个名为 的方法`onCancel()`，没有参数和`void`返回类型吗？如果答案是否定的，请尝试删除`@Override`注释并查看它是否适合您。

`@Override`注释用于指示该方法正在覆盖超类中相同声明的方法。从[javadocs](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Override.html)：

> @Override 表示方法声明旨在覆盖超类中的方法声明。如果使用此注解类型对方法进行注解但未覆盖超类方法，则编译器需要生成错误消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T00:44:34.033

您放置的代码块可能有一些错误。例如，此 SoftKeyboard 可能具有必须覆盖或可能首先定义的其他功能，因此一旦满足其他条件，这将是一个自动消失的错误。无论哪种方式，请粘贴更多上下文代码，以便我们更好地隔离问题。

顺便说一句，@Override 不会捕获语法错误，而是从字面上覆盖超类的预定义方法。

# c# - 将 Interactive Brokers C++ API 设置为控制台应用程序

> ID：10067774
> 
> 赞同：-3
> 
> 时间：2012-04-09T00:43:10.397
> 
> 标签：c#, c++

有没有一种方法可以将 C++ api 设置为不作为 Windows 窗体应用程序，而是作为控制台应用程序。这是如何工作的一个例子：

```
if(AAPL.price == 250)
{
    AAPL.buy(500);
} 
```

我会将它作为控制台应用程序运行，并让它每隔几秒刷新一次，这样我就不必每 2 秒调试一次。

我不介意您建议以不同的编程语言存在的东西，我更喜欢 C++ 或 C#，但其他任何东西都会有帮助。感谢：D ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-03-03T20:06:27.417

您可以考虑将 [https://github.com/JanBoonen/TwsApiCpp](https://github.com/JanBoonen/TwsApiCpp) 和 [https://github.com/rudimeier/twsapi](https://github.com/rudimeier/twsapi)作为起点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T01:46:40.913

Kangaroo Software 提供 C++ 控制台应用程序和源代码来访问 Interactive Brokers API。您可以使用 XML 设置条件或编辑代码并创建自己的逻辑。

[http://www.kangaroosoftware.com/StockBot.aspx](http://www.kangaroosoftware.com/StockBot.aspx)

# c# - //@attrib 与 //name/@attrib 在 C# 中

> ID：10067778
> 
> 赞同：1
> 
> 时间：2012-04-09T00:44:12.533
> 
> 标签：c#, xpath, xmldocument, selectsinglenode

在下面的 XML 中，我使用`SelectSingleNode`of`XmlDocument`来提取结果值。

```
evtASxml.SelectSingleNode(@"//@value").Value 
```

返回第一个“值”的值。

```
evtASxml.SelectSingleNode(@"//Result/@value").Value 
```

引发空异常。

有人可以解释发生了什么吗？

```
 <Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
 <System>
  <Provider Name="Microsoft-Windows-CAPI2" Guid="{f00f00-f00-f00f00-f00-f00f00f00}" /> 
  <EventID>30</EventID> 
  <Version>0</Version> 
  <Level>2</Level> 
  <Task>30</Task> 
  <Opcode>0</Opcode> 
  <Keywords>0x4000000000000001</Keywords> 
  <TimeCreated SystemTime="2012-04-08T23:43:37.573242200Z" /> 
  <EventRecordID>4828</EventRecordID> 
  <Correlation ActivityID="{f00f00-f00-f00-f00-f00f00f00f00}" /> 
  <Execution ProcessID="7512" ThreadID="3220" /> 
  <Channel>Microsoft-Windows-CAPI2/Operational</Channel> 
  <Computer>Matt-Seven</Computer> 
  <Security UserID="S-f00-f00-f00-f00f00f00-f00f00f00-f00f00f00-f00f00" /> 
  </System>
 <UserData>
 <CertVerifyCertificateChainPolicy>
  <Policy type="CERT_CHAIN_POLICY_SSL" constant="4" /> 
  <Certificate fileRef="f00f00f00f00f00f00f00f00f00f00f00.cer" subjectName="www.example.com" /> 
  <CertificateChain chainRef="{f00f00-f00-f00-f00-f00f00f00f00}" /> 
  <Flags value="0" /> 
 <SSLAdditionalPolicyInfo authType="server" serverName="example.com">
  <IgnoreFlags value="0" /> 
  </SSLAdditionalPolicyInfo>
  <Status chainIndex="0" elementIndex="0" /> 
  <EventAuxInfo ProcessName="iexplore.exe" /> 
  <CorrelationAuxInfo TaskId="{f00f00-f00-f00-f00-f00f00f00f00}" SeqNumber="4" /> 
  <Result value="800B010F">The certificate's CN name does not match the passed value.</Result> 
  </CertVerifyCertificateChainPolicy>
  </UserData>
  </Event> 
```

我的事件日志中的数值替换为 f00。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T00:51:48.273

只是猜测，但我认为你想要`//*[@value]`，而不是`//@value`

![在此处输入图像描述](../Images/32ad56d22994d93bff302759289e3afa.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T13:12:38.503

**此问题的原因是 XML 文档位于默认名称空间**中。

在默认命名空间中按名称选择元素是 XPath 中最常见的问题。

Xpath 将任何无前缀的元素名称视为属于“无命名空间”。在您的情况下`Result`，“无命名空间”中不存在任何元素（所有元素都在“http://schemas.microsoft.com/win/2004/08/events/event”命名空间中），因此没有选择节点。

**在 C# 中，建议您提供 XmlNamespaceManager 作为第二个参数`SelectSingleNode()`- 只需使用[适当的重载](http://msdn.microsoft.com/en-us/library/h0hw012b.aspx)**。

采用：

```
evtASxml.SelectSingleNode(@"//x:Result/@value", yourXmlNamespaceManager).Value 
```

其中与`"x"`“http://schemas.microsoft.com/win/2004/08/events/event”命名空间的关联已添加到`yourXmlNamespaceManager`使用该**[`AddNamespace()`](http://msdn.microsoft.com/en-us/library/system.xml.xmlnamespacemanager.addnamespace.aspx)**方法。

# javascript - 5级相互依赖的选择列表

> ID：10067780
> 
> 赞同：4
> 
> 时间：2012-04-09T00:44:40.317
> 
> 标签：javascript, jquery

我很高兴有这样的地方可以让人们解决他们的问题，即使是像我这样的初学者！我不知道要离开这里。

我正在尝试创建一个相互依赖的列表，其中列出了汽车制造商、汽车型号、年份、驱动程序和规模。

我已经创建了字段，我可以根据所做的选择填充汽车品牌和汽车型号。我被困在如何根据前面框中的选择填充“年份”字段。我知道第一个盒子需要一个功能。这是我的代码”

HTML：

```
<form name="selectionForm">
    <select name="makes" id="makes" size="3" style="width:125px">
        <option selected>Select a Make>></option>
    </select>
    <select name="models" id="models" size="3" style="width:125px"></select>
    <select name="years" id="years" size="3" style="width:125px"></select>
    <select name="drivers" id="drivers" size="3" style="width:125px"></select>
    <select name="scales" id="scales" size="3" style="width:125px"></select>
</form> 
```

JavaScript：

```
jQuery(function($) {
    initModels();

    function initModels() {
        var makesAndModels = {
            'Ford': ['Fiesta', 'Focus', 'Mondeo'],
            'Vauxhall': ['Astra', 'Cavalier', 'Vectra']
        };

        // Populate makes
        $.each(makesAndModels, function (k, v) {
            $('#makes').append('<option>' + k + '</option>');
        });

        // Populate models
        $('#makes').change(function() {
            var $models = $('#models');

            $models.html("");

            var models = makesAndModels[$(this).val()];

            $.each(models, function (k, v) {
                $models.append('<option>' + v + '</option>');
            });
        });
    }
}); 
```

我非常感谢你们自己的一些指导，因为我不知道从这里去哪里。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-10T10:29:30.637

Ok, so this is a long answer, and has taken me a long time to prepare, so bear with me (and get ready). Also, there is a [jsFiddle](http://jsfiddle.net/8FHZK/) below if you don't want to read this essay.

You'll be much better off storing each car as an individual object. If you have a database (or plan to have on in the future), this is how your data will be stored. Nested arrays also get exponentially painful, so it's best to stay clear of them. So to begin, we'll change your data structure to this:

```
var vehicles = [
    { make: 'Ford', model: 'Fiesta', year: '2001', driver: 'me', scale: '1:43' },
    { make: 'Ford', model: 'Fiesta', year: '2005', driver: 'me', scale: '1:33' },
    { make: 'Ford', model: 'Focus', year: '1999', driver: 'you', scale: '1:18' },
    { make: 'Ford', model: 'Modeo', year: '1998', driver: 'Nigel Mansell', scale: '1:43' },
    { make: 'Vauxhall', model: 'Astra', year: '2002', driver: 'James Thompson', scale: '1:43' },
    { make: 'Vauxhall', model: 'Vectra', year: '2000', driver: 'Jason Plato', scale: '1:18' }
]; 
```

First thing's first, pre-propuate the initial makes select box:

```
var makes = get_distinct(vehicles, 'make');
$.each(makes, function(index, value) {
   $('select#make').append('<option value="' + value + '">' + value + '</option>')
}); 
```

Once you've that, you need to set up a way to filter the data. You'll need functions for filtering the vehicles by the selected options, and getting distinct values. The below `filter_vehicles()` is *horrible*, but I'm tired and it's late, so it'll have to do. You'd be better off making this dynamic, and there'll be an easy solution, but my brain is fried right now.

```
function filter_vehicles() {
    return $.grep(vehicles, function(n, i) {
        if ($('#driver').val() != '')
            return n.make == $('#make').val() && n.model == $('#model').val() && n.year == $('#year').val() && n.driver == $('#driver').val();
        if ($('#year').val() != '')
            return n.make == $('#make').val() && n.model == $('#model').val() && n.year == $('#year').val();
        if ($('#model').val() != '')
            return n.make == $('#make').val() && n.model == $('#model').val();
        else
            return n.make == $('#make').val();
    });
}

// returns distinct properties from an array of objects
function get_distinct(array, property) {
   var arr = [];

   $.each(array, function(index, value) {
       if ( $.inArray(value[property], arr) == -1 ) {
           arr.push(value[property]);
       }
   });

   return arr;
} 
```

Then you'll need to update the select boxes. You can do it manually by targeting the change event on each individual select box, but you can also do it dynamically by attaching an event to all select boxes. I prefer this method, because it adds no overhead when adding additional fields.

```
$('select').change(function() {
    // don't execute if this is the last select element
    if ($(this).is(':last')) return;

    // clear all of the following select boxes, leaving a blank option
    $(this).nextAll().html('<option></option>');

    // get list of vehicles filtered by all the previous parameters
    var filtered_vehicles = filter_vehicles();

    // get the next select element
    var next = $(this).next();

    // get the distinct values from our list of filtered vehicles
    var values = get_distinct(filtered_vehicles, next.attr('id'));

    // append our options
    $.each(values, function(index, value) {
        next.append('<option value="' + value + '">' + value + '</option>')
    });
}); 
```

All in all, you'll get something like this jsFiddle: [http://jsfiddle.net/8FHZK/](http://jsfiddle.net/8FHZK/)

This is all easier in SQL. So if you do have a database, you'd execute queries on the server to return the filtered set, which cuts out a bit of the yucky code above.

I have no idea why I wrote all this manually, because there's probably a jQuery plugin that already does it all (and better). But hey, it's done, I had fun, and all the code is commented to assist in your learning :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T05:17:27.820

```
$('#years').change(function() {
  //do something like Populate models....
} 
```

So, what's the difference?

# php - PHP/PDO 将当前日期加一个月插入 MYSQL

> ID：10067782
> 
> 赞同：0
> 
> 时间：2012-04-09T00:45:36.337
> 
> 标签：php, mysql, date, insert

我正在尝试将当前日期（如果我有选项，则不是时间）以及一个月后的日期添加到我的 MYSQL 数据库中，并且我不断出现以下错误：

```
Parse error: syntax error, unexpected T_LNUMBER in *myfile* on line 45 
```

我插入数据的功能如下：

```
function add_zipcode($zip, $adminID, $email)
{
    global $db;
    $query = '

        INSERT INTO zip_owners (zip, email, adminID, started, transferred, expires)
        VALUES (:zip, :email, :adminID, :started, :transferred, :expires)';
    try{
        $statement = $db->prepare($query);
        $statement->bindValue(':zip', $zip);
        $statement->bindValue(':email', $email);
        $statement->bindValue(':adminID', $adminID);
        $statement->bindValue(':started', now());

        $statement->bindValue(':transferred', now());
        $statement->bindValue(':expires', DATE_ADD(now(), INTERVAL 1 MONTH));
        $statement->execute();
        $statement->closeCursor();
    }
    catch (PDOexception $e) 
    {
        $error_message = $e->getMessage();
        echo "<p>Database Error: $error_message </p>";
        exit();
    }
} 
```

问题线是这一行：

```
$statement->bindValue(':expires', DATE_ADD(now(), INTERVAL 1 MONTH)); 
```

我不太确定为什么该语法不起作用。

我的目标是能够在选择行时比较日期，以返回在当前日期一周内提交的过期行。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-09T00:47:36.763

引用您的 MySQL 语句，它们是 PHP 中的字符串：

```
$statement->bindValue(':expires', 'DATE_ADD(now(), INTERVAL 1 MONTH)'); 
```

# objective-c - 旋转后缩放图像

> ID：10067784
> 
> 赞同：3
> 
> 时间：2012-04-09T00:45:37.853
> 
> 标签：objective-c, ios, uiscrollview, uiimage, rotation

我在 UIScrollView 中有一个可以放大和缩小的图像。我有一个按钮可以让用户将图像旋转 90 度：

```
(void)RotateImage {
    CGAffineTransform rotateTrans = CGAffineTransformMakeRotation(-90.0 / 180.0 * 3.14);
    BaseImg.transform = rotateTrans;
} 
```

图像旋转后，我无法放大和缩小..图像在屏幕上变得疯狂并回到未旋转状态。

我究竟做错了什么？代码示例会很棒！谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T01:47:52.617

UIScrollView 喜欢接管它包含的视图的转换。有两种解决方案：

1.  旋转图像而不更改包含视图。
2.  创建一个在子层中显示图像的 UIView 子类。

要**旋转图像**，请参阅[如何将 UIImage 旋转 90 度？](https://stackoverflow.com/questions/1315251/how-to-rotate-a-uiimage-90-degrees). 如果您总是且仅进行 90 度旋转，请参阅[@Peter Sarnowski 的解决方案](https://stackoverflow.com/a/7721814/1318452)。为了适应你在这里所做的事情，假设`BaseImg`是`UIImageView`：

```
- (void) rotateImage
{
    UIImage *sourceImage = [baseImg image];
    UIImage *rotatedImage = [UIImage imageWithCGImage:[sourceImage CGImage] scale:1.0 orientation:UIImageOrientationRight];
    [baseImg setImage:rotatedImage];
} 
```

这只会旋转一次。要让 rotateImage 重复工作，请读取现有`orientation`属性并按顺时针或逆时针顺序将其移至下一个。

如果图像不是方形的，您可能还需要调整大小`baseImg`以反映其新的纵横比。

要**创建 UIView 子类**，您需要将其存储`CALayer`为视图层的子层。将图像存储在子层中，并随意变换子层。这更快，并且允许任意旋转，但您需要计算自己的缩放以防止旋转图像超出视图边界。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T05:35:53.917

要简单地旋转图像，代码是完美的，但要添加放大和缩小然后添加旋转，您需要保留其变换。这是一个可以帮助您的示例代码。

[https://github.com/elc/iCodeBlogDemoPhotoBoard](https://github.com/elc/iCodeBlogDemoPhotoBoard)

# visual-studio-2010 - STL 和谷歌测试？

> ID：10067785
> 
> 赞同：1
> 
> 时间：2012-04-09T00:45:41.447
> 
> 标签：visual-studio-2010, stl, googletest

有谁知道如何在 Visual Studio 上设置 STL 和 Google 测试？（我正在使用 Visual C++ Express 10）

我找到了一个设置 Google 测试的教程 (http://blog.feabhas.com/2012/03/setting-up-googletest-with-visual-c-2010-express-edition/) 和另一个 STL (http ://www.shoup.net/ntl/doc/tour-win.html），我可以毫无问题地设置谷歌测试（“运行时库”设置为“多线程调试（/MTd）”）；对于 STL，我需要将“运行时库”选项更改为“多线程 DLL 调试 (/MDd)”。如果我尝试同时设置两者，我最终会遇到很多链接器错误（LNK2005 等）

我在网上看了一段时间，似乎这个“运行时库”选项肯定有问题，但我不知道为什么！任何人都会好心解释我（或那些教程）做错了什么？非常感谢！！

# ruby-on-rails - 默认使用 MongoDB 的 Rails 身份验证 Gem

> ID：10067786
> 
> 赞同：0
> 
> 时间：2012-04-09T00:45:46.070
> 
> 标签：ruby-on-rails, authentication, mongodb

我知道 Devise 可以做到这一点，但我不是 devise 的忠实粉丝，因为使用 Devise 进行定制非常困难（我通常使用 AuthLogic）。我想使用 MongoDB 作为我的主数据库我只是想知道是否已经有一个 gem 使用 MongoDB 作为其默认存储。我试过用谷歌搜索，但最有可能的解决方案是设计的定制版本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T19:01:30.633

John Nunemaker 在这里整理了一个非常基本的： [https ://gist.github.com/147427](https://gist.github.com/147427)

# amazon-s3 - Amazon S3 是否适合提供视频？

> ID：10067794
> 
> 赞同：15
> 
> 时间：2012-04-09T00:47:09.430
> 
> 标签：amazon-s3, amazon-web-services

我正在一个主要功能是播放视频的网站上工作，通常一个接一个。

**将 MP4 和 WebW 文件存储在 Amazon S3 上，然后使用 HTML5/Flash 完成播放是否合适？**

通过 Amazon S3 提供视频是否会对速度产生影响？或者我是否会更好地从用于运行该站点的同一 Amazon EC2 服务器中提供视频？

**我真的在寻找优点/缺点。谢谢你。**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-09T01:02:09.683

我无法想象使用亚马逊进行流媒体。老实说，他们的流量成本对于这种应用程序来说太高了。无论如何，如果您仍然想使用它，S3 似乎不是一个好的选择，因为它是为存档而不是流式传输而设计的集群存储，它具有每秒请求数的限制以及它的并发性。对于流媒体，您需要尽可能快的存储，而亚马逊的任何服务都远非如此，当然 S3 和 EBS 也不是太快。您可以考虑带 SSD 驱动器和正常带宽价格的服务器。我有 10 台流媒体服务器，每天处理 100TB 的流量，每台都有 8 个 SSD 驱动器和 10Gbps 接口以及 64GB RAM 和 16 个内核。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-09T01:04:36.687

我过去曾使用 Amazons CloudFront 来传输内容而没有太多问题 (http://aws.amazon.com/cloudfront/)，但肯定有更快的方法。

但是，我相信这是一个很好的起点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-11T12:56:35.853

[Amazon CloudFront](http://aws.amazon.com/about-aws/whats-new/2009/12/15/announcing-cloudfront-streaming/)自 2009 年 12 月起支持流式传输：

> 我们设计了 Amazon CloudFront，让任何拥有媒体内容的人都可以访问流媒体。使用 Amazon CloudFront 进行流式传输非常简单：只需单击几下 AWS 管理控制台或一个简单的 API 调用，您就可以使用运行 Adob​​e 的 Flash® Media Server 的全球边缘站点网络来流式传输您的内容。而且，与所有 AWS 服务一样，Amazon CloudFront 流式传输不需要预先承诺或长期合同。使用 Amazon CloudFront 进行流式传输不收取额外费用；您只需为使用该服务传输的数据支付正常费用。

最近[Amazon CloudFront 引入了 Live Smooth Streaming](http://aws.amazon.com/about-aws/whats-new/2012/04/01/amazon-cloudfront-announces-support-for-smooth-streaming/)：

> 我们很高兴地宣布推出适用于 Amazon CloudFront 的 Live Smooth Streaming。Smooth Streaming 是 Internet 信息服务 (IIS) 媒体服务的一项功能，可将实时媒体自适应流式传输到 Microsoft Silverlight 客户端。您还可以使用此解决方案通过 Apple HTTP Live Streaming (HLS) 格式将您的直播流传输到 Apple 的 iOS 设备。在交付实时 Smooth Streams 时，您可以从 Amazon CloudFront 提供的规模和低延迟中受益。

# prolog - 如何编写程序来查找完全封闭的瓷砖？

> ID：10067802
> 
> 赞同：4
> 
> 时间：2012-04-09T00:48:16.407
> 
> 标签：prolog, graph-theory

我正在尝试编写一个 prolog 程序，该程序可以在二维数组中找到完全被 b 或 w 包围的图块。

例如，给定这样的数据集：

```
[
    [b, w, +, +],
    [w, +, w, b],
    [+, w, b, +],
    [+, +, +, b],
] 
```

它将返回另一个变量，其中包含：

```
[
    [-, -, -, -],
    [-, w, -, -],
    [-, -, -, b],
    [-, -, -, -],
] 
```

也就是说，它用 a 替换了所有被`+`完全包围的内容，被 a 包围的所有内容也一样，并用 a 替换了其他所有内容。`b``b``w``-`

任何人都可以就如何构建一个程序来做到这一点提供任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T02:11:53.430

这可能会有所帮助：它采用您给出的表示，并返回一个列表，其元素是 [ColumnIndex, RowIndex, Value] 形式的每个元素。然后，您可以使用 member 在特定行/列中查找元素。

```
encodearray( A, AA ) :- ( A, 0, 0, AA ).
encodearray( [], _, _, [] ).
encodearray( [[]|A], _, R, AA ) :- R1 is R+1, encodeArray( A, 0, R1, AA ).
encodearray( [[A|B]|X], C, R, [[C,R,A]|AA] ) :- C1 is C+1, encodeArray( [B|X], C1, R, AA ). 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T09:07:20.793

有了这个 rep/2 谓词

```
rep(L0, L1) :-
    rep(b, L0, L1) ;
    rep(w, L0, L1).

rep(E, [E|Ps], [-|Rs]) :-
    rep1(E, Ps, Rs).
rep(E, [X|Ps], [-|Rs]) :-
    E \= X,
    rep(Ps, Rs).

rep1(E, [+|Ps], [E|Rs]) :-
    rep2(E, Ps, Rs).

rep2(E, [+|Ps], [E|Rs]) :-
    rep2(E, Ps, Rs).
rep2(E, [E|Ps], [-|Rs]) :-
    dash(Ps, Rs).

dash([], []).
dash([_|Ps], [-|Rs]) :- dash(Ps, Rs). 
```

以这种方式执行

```
?- rep([b,+,b,b],L).
L = [-, b, -, -] ;
false.

?- rep([b,+,+,+,+,+,b,+,b],L).
L = [-, b, b, b, b, b, -, -, -] .

?- rep([w,+,+,+,+,+,w,+,b],L).
L = [-, w, w, w, w, w, -, -, -] .

?- rep([b,+,+,+,+,+,w,+,b],L).
false.

?- rep([b,+,+,+,+,+,+,b],L).
L = [-, b, b, b, b, b, b, -] .

?- rep([b,+,+,+,+,+,+,+,b],L).
L = [-, b, b, b, b, b, b, b, -] .

?- rep([b,+,+,w,+,+,w,+,b],L).
L = [-, -, -, -, w, w, -, -, -] . 
```

和一个转置谓词，使 rep/2 能够在列上工作

```
transpose_col_row([], []).
transpose_col_row([U], B) :- gen(U, B).
transpose_col_row([H|T], R) :- transpose_col_row(T, TC), splash(H, TC, R).

gen([H|T], [[H]|RT]) :- gen(T,RT).
gen([], []).

splash([], [], []).
splash([H|T], [R|K], [[H|R]|U]) :-
    splash(T,K,U). 
```

你可以结合它们来解决你的问题。高温高压

# ruby-on-rails - Rails 3 join table article_categories 只允许一个类别

> ID：10067809
> 
> 赞同：0
> 
> 时间：2012-04-09T00:49:56.247
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我想知道如何建立一个连接表articles_categories，但是每篇文章只能有一个类别。我知道进行分类的典型方法是使用 has_and_belongs_to_many 为每篇文章允许多个分类，但我希望每篇文章只允许一个分类。我已经使用 has_and_belongs_to_many 关联设置了我的articles_categories 连接表。我遵循了 Apress Starting Rails 3 中的一个示例，该示例还建议设置articles_categories 表：id => false。我是否还必须更新表格以获得 id？谢谢！

到目前为止，我已将文章模型更新为 has_one :category 并将类别模型更新为 has_many :articles，但在 irb 中进行测试时出现错误：

```
a = Article.first
a.category 
```

错误是：

```
Category Load (0.7ms)  SELECT "categories".* FROM "categories" WHERE "categories"."article_id" = 1500 LIMIT 1
PG::Error: ERROR:  column categories.article_id does not exist
LINE 1: SELECT  "categories".* FROM "categories"  WHERE "categories"... 
```

有人可以告诉我如何更好地设置它吗？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T00:55:51.303

`Article`模型应该有一个`belongs_to :category`关联而不是`has_one :category`. 也不要忘记在表中添加一`category_id`列`articles`（如果您还没有添加迁移，您可以添加）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T00:59:42.557

如果您希望每篇文章只有一个类别，则不应使用交叉表。只需在迁移中使用引用 — [http://guides.rubyonrails.org/migrations.html#highlighter_472212](http://guides.rubyonrails.org/migrations.html#highlighter_472212)

```
rails g migration ArticleHasCategory category:references 
```

然后你指定文章在模型中有类别

```
belongs_to :category 
```

当你打电话时`article.category`。它会自动寻找`<relation name>_id`应该指向记录的列`<relation name>`

# python - 临时 Numpy 数组的数据库或表解决方案

> ID：10067813
> 
> 赞同：3
> 
> 时间：2012-04-09T00:50:16.167
> 
> 标签：python, numpy, scipy, pytables

我正在创建一个 Python 桌面应用程序，它允许用户选择不同的分布形式来对农业产量数据进行建模。我有时间序列农业数据 - 接近一百万行 - 保存在 SQLite 数据库中（尽管如果有人知道更好的选择，这并不是一成不变的）。一旦用户选择了一些数据，比如伊利诺伊州 1990-2010 年的玉米产量，我希望他们从下拉列表中选择一种分布形式。接下来，我的函数将分布拟合到数据中，并从 Numpy 数组中的拟合分布形式中输出 10,000 个点。我希望这些数据在程序执行期间是临时的。

为了提高效率，我只想对指定的区域和分布进行一次拟合和随后的数字绘制。我一直在研究 Python 中的临时文件，但我不确定这是保存许多不同 Numpy 数组的最佳方法。PyTables 看起来也是一种有趣的方法，并且似乎与 Numpy 兼容，但我不确定它是否适合处理临时数据。这些天似乎没有像 MongoDB 这样的 SQL 解决方案非常流行，从简历构建的角度来看，这也让我感兴趣。

编辑：阅读下面的评论并对其进行研究后，我将使用 PyTables，但我正在尝试找到解决此问题的最佳方法。是否可以创建一个像下面这样的表，而不是 Float32Col 我可以使用 scikits 时间序列类中的 createTimeSeriesTable() 或者我是否需要为日期创建一个日期时间列和一个用于掩码的布尔列，除了下面的 Float32Col 来保存数据。还是有更好的方法来解决这个问题？

```
class Yield(IsDescription):
    geography_id = UInt16Col()
    data = Float32Col(shape=(50, 1)) # for 50 years of data 
```

任何有关此事的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T20:59:33.303

临时数据的用例是什么？您是否只想一次阅读所有内容（并且不想只阅读一个子集）？

如果是这样，只需将数组保存到一个临时文件（例如，使用`numpy.save`，或等效`pickle`地使用二进制协议）。在这种情况下，不需要更高级的解决方案。

在旁注中，我强烈推荐使用 PyTables 而不是 SQLite 来存储您的原始时间序列数据。

根据您正在做的事情，您将不需要关系数据库的“关系”部分（例如连接）。如果您不需要连接或关联表，只需要快速简单的查询，并且希望内存中的数据为 numpy 数组，那么 PyTables 是一个很好的选择。PyTables 使用 HDF 存储数据，它在磁盘上比 SQLite 数据库更紧凑。PyTables 将大块数据作为 numpy 数组加载到内存中的速度也相当快。

# pointers - 为什么字符串有返回类型的指针？

> ID：10067814
> 
> 赞同：1
> 
> 时间：2012-04-09T00:50:21.520
> 
> 标签：pointers

我知道指针是什么，但是当涉及到字符串/数组时，我真的很困惑。如果有人有答案或解释它的网站，那就太好了。例如：

```
char * strncopy (char*dest, char * source, size_t); 
```

为什么是指针？它指向什么？它是指针通常存储地址吗？

在我的教科书中说，每个字符串构建函数都是指针 char* 类型。

此外，我试图看看我是否可以编写一个可以清除问题的程序，但它没有用。有人可以告诉我如何解决它，或者我做错了什么。

```
#include <stdio.h>
#include <string.h>    

char * getname ()
{
    char name [10];
    scanf ("%s", name);
    return (name);
}    

int main (void)
{
    char name[10];
    printf ("Enter your name\n");
    name[] = getname();
    printf ("Hi %s", name);
    return (0);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T00:57:19.097

在您的 getname 函数内部，当您返回指向名称数组的指针时，因为它是在堆栈上分配的，它会被销毁，从而为您留下无效的指针。取消引用这样的指针会导致很多很多问题。

您应该使用 malloc/calloc 在堆上的 getname 内分配名称数组，以便在返回指针时不会破坏数据。

对于 strncpy 之类的函数，它们倾向于返回指向结果字符串的指针；例如：strncpy 返回一个指向目的地的指针。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T01:12:07.483

指针本身代表一个地址，例如，如果你有一个指针类型`char *pstr`，你可以随时检查底层地址`printf("address of my pointer %p\n", pstr);`

在 C 编程语言中，字符串是`char`. 如果你对数组及其内存布局有很好的了解，那么理解 c 风格的字符串对你来说并不难。一般来说，C 中的数组是一块连续的内存，数组的名称表示数组中第一个元素的地址。字符串也是如此，它是一块内存，名称为`char`第一个字符的数组地址。此外，c 风格的字符串以 character 结尾`\0`，因此如果您想自己管理字符串的内存，请记住为 tailing 多留一个字节`\0`。

至于你的第二个问题，你的`name`in 函数`getname`是一个局部变量，它的生命周期在函数返回时结束。但是，您仍然想在`name`不合适的功能之外访问。您可以像在 dasblinkenlight 和其他人的帖子中那样动态分配内存来解决这个问题。

祝你好运。

# google-maps - Fusion Tables + Google Maps + 标记重叠

> ID：10067820
> 
> 赞同：1
> 
> 时间：2012-04-09T00:52:19.000
> 
> 标签：google-maps, google-fusion-tables

我正在使用带有数千个标记的 Fusion Tables，但在几个位置，我在一个小地方有数千个标记（例如：带有 4000 个标记的街区），但是放大时标记没有重叠......看起来像谷歌组织标记，以免彼此重叠。

问题图片.. [http://img560.imageshack.us/img560/7267/70124074.png](http://img560.imageshack.us/img560/7267/70124074.png)

无论如何要使用 Fusion+Google Maps API 来解决这个问题？

谢谢。

# qt - QDockWidget 停靠在主窗口右侧时大小错误

> ID：10067821
> 
> 赞同：3
> 
> 时间：2012-04-09T00:52:19.697
> 
> 标签：qt, qdockwidget

我是 Qt 的新手，我正在尝试创建一个停靠在窗口右侧的 DockWidget。我为扩展坞设置了最大和最小宽度（您将在下面的代码中看到）。如果停靠小部件添加了 ，则此方法有效`Qt::LeftDockWidgetArea`，但是当添加 时`Qt::RightDockWidgetArea`，停靠“填充”到窗口的中心，如下所示： ![红色区域显示停靠小部件边界。](../Images/cc7da14b5ba19bf214b5d911da695f40.png)

我可能没有以正确的方式调整扩展坞的大小。这是此窗口的代码：

```
int main(int argv, char** args)
{
    QApplication app(argv, args);
    QMainWindow window;
    QDesktopWidget* desktop = QApplication::desktop();
    //Docks
    QDockWidget* propertyDock = new QDockWidget("",&window);
    QWidget* propertyDockContents = new QWidget;

    //This sets the window in the center of the screen.
    int wWidth = 800; int wHeight = 600;
    window.setGeometry(QRect( (desktop->width()-wWidth)/2 , (desktop->height()-wHeight)/2 ,wWidth,wHeight));

    propertyDock->setAllowedAreas(Qt::RightDockWidgetArea);
    propertyDockContents->setMaximumWidth(200);
    propertyDockContents->setMinimumWidth(20);

    propertyDock->setWidget(propertyDockContents);
    window.addDockWidget(Qt::RightDockWidgetArea,propertyDock);

    window.show();

    return app.exec();
} 
```

有没有“正确”的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T02:31:52.080

如文档中所述：

> 注意：不支持创建没有中央小部件的主窗口。即使它只是一个占位符，您也必须有一个中央小部件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-08-23T03:28:19.307

是的！您无法创建没有中央小部件的主窗口，但您可以将中央小部件的高度设置为零。 [主窗口.cpp](https://github.com/blab-liuliang/echo/blob/master/editor/echo/Base/UI/MainWindow/MainWindow.cpp)

```
centralWidget()->setMaximumHeight(0); 
```

# c++ - 创建表头？

> ID：10067825
> 
> 赞同：0
> 
> 时间：2012-04-09T00:53:28.647
> 
> 标签：c++

好的，在这个程序中，我需要根据用户输入制作一个表格。问题是我无法弄清楚如何让表头与显示的信息正确对齐。如果用户输入 Michael 作为球员 1 和 Michael Jordan 作为球员 2 输入，表格标题不会对齐。任何关于允许标题与显示的输入正确对齐的建议，无论字符长度如何，将不胜感激，谢谢。

这是我的代码：

```
#include <iostream>
#include <string>
#include <iomanip>
#include <cstdlib>
using namespace std;

//struct of Basketball Player info
struct BasketballPlayerInfo
{
    string name; //player name

    int playerNum, //player number
        pointsScored; //points scored

};

int main()
{
    int index, //loop count
        total = 0; //hold total points
    const int numPlayers = 5; //nuymber of players
    BasketballPlayerInfo players[numPlayers]; //Array of players

    //ask user for Basketball Player Info
    cout << "Enter the name, number, and points scored for each of the 5 players.\n";

    for (index = 0; index < numPlayers; index++)
    {
        //collect player name
        cout << " " << endl;
        cout << "Enter the name of player # " << (index + 1);
        cout << ": ";

        //input validation
        if(!(getline(cin, players[index].name)))
        {
            cout << "Player Name must be alphabetical characters only!\n";
            cout << "Program terminating please start over." << endl;
            system("pause");
            exit(0);
        }

        //getline(cin, players[index].name);

        //collect players number
        cout << "Enter the number of player # " << (index + 1);
        cout << ": ";

        //input validation
        if(!(cin >> players[index].playerNum))
        {
            cout << "Player Name must be numeric characters only!\n";
            cout << "Program terminating please start over." << endl;
            system("pause");
            exit(0);
        }
        //collect points scored
        cout << "Enter points scored for player # " << (index + 1);
        cout << ": ";

        //input validation
        if(!(cin >> players[index].pointsScored))
        {
            cout << "Player Name must be numeric characters only!\n";
            cout << "Program terminating please start over." << endl;
            system("pause");
            exit(0);
        }

        cin.ignore();
    }

    //display
    cout << "\n";
    cout << "Here is the information for each player: \n";
    cout << fixed << showpoint << setprecision(2);
    cout << "\n";
    cout << "          \tName\tNumber\tPoints\n";
    cout << "------------------------------------------------" << endl;

    for(index = 0; index < numPlayers; index++)
    {
        cout << "Player # " << (index + 1);
        cout << ": \t" << players[index].name << "\t" << players[index].playerNum << "\t" << players[index].pointsScored << endl;
        cout << "------------------------------------------------" << endl;

    }

    //display total points scored by all players
    for(index = 0; index < numPlayers; index++)
    {
        //hold total
        total += players[index].pointsScored;
    }

    cout << "Total Points scored are: " << total << endl;

 system("pause");
return 0;

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T01:01:45.583

您可以使用`setw`.io 下的 io 操纵器`#include <iomanip>`。

```
cout << setw(20) << "Column1"
     << setw(20) << "Column2"
     << setw(8) << "Column3"; 
```

或者你可以使用[Boost 库](http://www.boost.org/)

// 使用 Boost.Format

```
cout << format("%-20s %-20s %-8s\n")  % "Column1" % "Column2" % "Column3"; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T01:01:49.667

看一下[setw](http://www.cplusplus.com/reference/iostream/manipulators/setw/)和[setfill](http://www.cplusplus.com/reference/iostream/manipulators/setfill/)函数。您可以使用它们为列分配最小宽度，这将使输出格式比制表符更清晰。

# linux - 从 bash 脚本替换文件中的字符串

> ID：10067828
> 
> 赞同：1
> 
> 时间：2012-04-09T00:54:32.470
> 
> 标签：linux, bash, shell, scripting, ssh

我需要在一个小 bash 脚本中替换文件中的一个字符串，但是......我得到了奇怪的结果。

假设我要替换：

```
<tag><![CDATA[text]]></tag> 
```

和：

```
<tag><![CDATA[replaced_text]]></tag> 
```

我应该使用`sed`吗？我认为由于`/`并且`[` `]`我得到了奇怪的结果......

解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T02:29:26.333

带有 -p 选项的 Perl 几乎与 sed 一样工作，并且它的正则表达式具有 \Q （引号）开关：

```
perl -pe 's{\Q<tag><![CDATA[text]]></tag>}
           {<tag><![CDATA[replaced_text]]></tag>}' YOUR_FILE 
```

在 Perl 中，您可以使用不同的标点符号来分隔表达式（在我的示例中为 s{...}{...}）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T01:05:40.693

是的，您需要转义括号，转义斜杠或使用不同的分隔符。

```
sed 's,<tag><!\[CDATA\[text\]\]></tag>,<tag><!\[CDATA\[replaced)text\]\]></tag>,' 
```

也就是说，在使用正则表达式时，SGML 和 XML 实际上并不比[HTML好。](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags/1732454#1732454)不要指望这会一概而论。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T17:28:24.037

这应该足够了：

```
$ echo '<tag><![CDATA[text]]></tag>' | sed 's/\[text\]/\[replaced_text\]/'
<tag><![CDATA[replaced_text]]></tag> 
```

您还可以将`/`sed 中的分隔符更改为不同的字符，例如`,`,`|`或`%`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T09:52:12.200

只需使用 / 以外的分隔符，这里我使用 #：

```
sed -i 's#<tag><!\[CDATA\[text\]\]></tag>#<tag><![CDATA[replaced_text]]></tag>#g' filename 
```

`-i`让 sed 更改文件而不是打印出来。 `g`用于匹配不止一次（全局）。

但是您是否知道要匹配的确切字符串，包括标签和文本？例如，如果您想用您的replaced_text 替换所有文本：

```
perl -i -pe 's#(<tag><!\[CDATA\[)(.*?)(\]\]></tag>)#\1replaced_text\3#g' filename 
```

切换到 perl 因为 sed 不支持非贪婪乘数（*？）。

# javascript - JavaScript 一段代码解释

> ID：10067829
> 
> 赞同：2
> 
> 时间：2012-04-09T00:54:47.910
> 
> 标签：javascript, jquery

查看这段 JavaScript 代码：

```
(function (w, d) {
    var loader = function () {
        var s = d.createElement("script"), tag = d.getElementsByTagName("script")[0];
        s.src = "https://example.org/script.js";
        tag.parentNode.insertBefore(s,tag);
    };
    w.addEventListener ? w.addEventListener("load", loader, false) :
                         w.attachEvent("onload", loader);
}) (window, document); 
```

为什么这段代码的作者使用这种方法在文档中包含一个脚本？该行的用处是什么：

```
w.addEventListener ? w.addEventListener("load", loader, false) :
                     w.attachEvent("onload", loader); 
```

最后一点：我是一个JavaScript初学者，最后是什么`(window, document)`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T01:00:24.840

第一个问题，代码检查是否`window.addEventListener`已定义。如果是，则使用它，否则使用`window.attachEvent`. 这是为了浏览器兼容性。

第二个问题，这段代码是一个匿名函数，它有两个参数，w 和 d。立即调用此函数，传递参数`window`和`document`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T01:01:33.070

首先`w.addEventListener ?`确定浏览器是否支持window的addEventListener方法

其次，`(window, document)`只是他之前写的匿名函数的参数调用`function(w,d) {}`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-09T01:16:15.330

下面的 addEventListener 行是注册函数，以便在页面完成加载时调用它。Internet Explorer 和 Firefox (et al) 使用不同的函数来执行此操作。

```
w.addEventListener ? w.addEventListener("load", loader, false) :
                 w.attachEvent("onload", loader); 
```

在 javascript 中，函数本身就是一个对象。因此，它的“值”可以分配给变量或立即使用。要立即使用它，它必须用括号括起来（否则它不会做你想要的），然后像普通函数一样调用它。

```
(function (w, d) { ... }) (window, document); 
```

如果我们把它分成两条线，情况会更明显。

```
var a = function(w, d){ ... };
a(window, document); 
```

这样做是为了不让临时值或函数污染全局范围。更不用说不破坏其他任何变量。这可以分为两部分：

1.  通过将代码封装在闭包中，任何在内部显式声明的内容都在闭包的范围内，而不是全局范围内。`var loader`在闭包的范围内。
2.  通过立即使用闭包，它不会存储在全局范围内的变量中。由于它是匿名声明的，因此它不会作为命名函数存在于全局范围内。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-09T01:00:43.933

看起来作者在附加脚本标记之前正在等待页面完全加载。addEventListener（DOM 级别 2）和 attachEvent（微软的东西）是更灵活的附加事件的方式。代码类似于说`w.onload = loader`。

最后一点是将参数传递给匿名函数，它们被命名为`w`and `d`。通过将 () 放在末尾，匿名函数立即被调用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-09T01:01:18.483

所以这个函数被包裹在一个闭包中。这又意味着`w = window`和`d = document`。

当该方法被调用时，它会创建一个被调用的函数，该函数`loader`是两个可能的事件侦听器触发器之一的回调（意思是，在窗口上调用`load`or事件时将调用该函数）。`onload`

`x ? y : z`语法是速记`if then else`调用。

如果我们扩展它，它看起来像这样：

```
if (w.addEventListener) {
  w.addEventListener("load", loader, false);
} else {
  w.attachEvent("onload", loader);
} 
```

该语句用于满足 IE 和其他浏览器的方法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-09T01:02:07.000

这实际上与以下内容相同：

```
function RegisterEventListener(w, d) {
    var loader = function () {
        var s = d.createElement("script"), tag = d.getElementsByTagName("script")[0];
        s.src = "https://example.org/script.js";
        tag.parentNode.insertBefore(s,tag);
    };
    if (w.addEventListener) {
       w.addEventListener("load", loader, false);
    } else {
       w.attachEvent("onload", loader);
    }
}

RegisterEventListener(window, document); 
```

唯一真正的区别是：

1.  如果您定义匿名函数（使用`function () {};`）而不将其分配给任何东西，则它只能用于有限的使用（因为无法引用它）。同时，匿名函数也允许立即执行（就像你的问题代码中的那个`function(a, b) {}(a, b);`。
2.  (`condition ? true : false`三级运算符) 只是编写简单`if`语句的简写，因此它需要更少的输入来写出，但有些人也认为它的可读性较差。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-04-09T01:05:52.433

我可能错了，但这是 Google 使用他们的分析脚本的实现。

这称为闭包，这是一个自动执行的函数并将变量包含在其中，因此它们不会与您的代码混淆。

这段代码实质上创建了一个脚本标签，并将其附加到 DOM 中它在文档中找到的第一个脚本标签之前。

第一个问题的答案是关于浏览器兼容性。一些浏览器使用`addEventListener`和其他浏览器`attachEvent`将事件附加到页面中的元素（在本例中为窗口），它会在窗口的加载事件上启动（当所有内容加载时，文档准备好后）。看看这个以获得更详细的答案：[window.onload vs $(document).ready()](https://stackoverflow.com/questions/3698200/window-onload-vs-document-ready)

第二个答案很简单。这是闭包（自动调用函数）中使用的参数，可以这样读取：

```
function anonymous(w, d) {
    ...
}
anonymous(window, document); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-04-09T01:06:06.257

这段代码的作者使用了一个封装在闭包中的匿名函数来触发该函数，该函数注册了一个加载事件。在窗口的 onload 事件触发之前，页面上的脚本实际上不会被加载。

作者可能会延迟脚本加载的原因可能是在实际加载其他脚本之前给网页更多时间来呈现。这是一种很好的技术，可以快速加载页面内容，同时延迟加载不需要的资源。

作者使用的技术是一个封装在闭包中的匿名函数。想象一下：

```
myFunction (window, document); 
```

现在，我将用匿名函数替换函数调用：

```
function(w, d) {
    // do stuff
    alert("w = " + w); 
    alert("d = " + d);
} 
```

现在我要让这个函数立即运行，而不是给它一个名字。我还将向该匿名函数传递两个参数：

```
( function(w, d) {
      // do stuff
      alert("w = " + w);
      alert("d = " + d);
})  ("1234", "5678"); 
```

此示例中的输出将是：

```
w = 1234
d = 5678 
```

如果你观察括号并将它们匹配起来，第一个外括号匹配最后一行字符 2 处的右括号，即函数名称，下面的一组括号将作为参数传递给函数的两个值包装起来。

一开始这可能是一个很难掌握的概念。在你看到它做了几次之后，它开始变得更有意义了。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-04-09T01:06:08.140

1.  以这种方式添加脚本允许作者将该脚本包含在文档中，而无需直接编辑 HTML 文件。也可用于仅在需要时动态加载脚本。（即，如果您有一堆代码来编辑页面上的某些内容，则在用户实际单击编辑按钮之前您不想下载它，因此您不会在不需要时浪费带宽）。

2.  addEventListener 和 attachEvent 是在页面完成加载时触发要调用的函数的方法。在这种情况下，有一个函数名为`loader` The 两者的原因是有些浏览器支持一个，有些支持另一个。我已经使用 jQuery 足够长的时间了，以至于我不记得哪个是哪个。

3.  (window, document) 是一种将这些变量封装在范围内和/或通过简写 w 和 d 引用它们的方法。作者正在创建一个需要这些参数的函数，然后将 window 和 document 作为参数传递给它们。

关闭还有助于作者避免他的脚本与页面上的其他脚本发生冲突。将其中声明的每个变量想象成其他语言中的私有变量。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-04-09T01:14:10.807

第`window, document`一个代码块末尾的 是代码块其余部分中定义的匿名函数的参数。由于 Javascript 几乎是一种函数式语言，因此允许程序员定义这些匿名函数，甚至可以在不给它们命名的情况下使用它们。

您粘贴的带有问号的代码块是中缀表示法的一个示例，一种适合这种模式的语言结构：`condition ? ifTrueExpression : ifFalseExpression`. 如果`condition`为真，则整个表达式将等于`ifTrueExpression`。否则，整个表达式将等于`ifFalseExpression`。

您粘贴的中缀符号的使用在检测正在使用哪种类型的 Internet 浏览器时很常见。虽然，我不确定这段代码试图检测哪个浏览器，但它的目的是以浏览器特定的方式实现事件处理程序。

# .htaccess - htaccess 重定向问题 mod rewrite

> ID：10067832
> 
> 赞同：0
> 
> 时间：2012-04-09T00:55:17.147
> 
> 标签：.htaccess, rewrite

嘿，我正在尝试使用 htaccess 文件更改 url 结构，并且我正在将旧结构重写为新结构，尽管我遇到了一些问题。

我正在使用以下代码

```
RewriteRule video-(.*)-(.*).html?$ http://mysite.com/download-$2-video-$1.html [R=301,L] 
```

现在我遇到的问题是，当我尝试重定向类似

```
http://mysite.com/video-1-this-is-the-title.html 
```

它正在将其重定向到

```
http://mysite.com/download-this-video-1.html 
```

代替

```
http://mysite.com/download-this-is-the-title-video-1.html 
```

如果有人可以提供帮助，那就太好了！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T01:01:30.543

如果第一个反向引用总是数字，您可以尝试将正则表达式更改为：

```
RewriteRule video-([0-9]+)-(.+).html?$ http://mysite.com/download-$2-video-$1.html [R=301,L] 
```

# lua - 暂停迭代

> ID：10067834
> 
> 赞同：0
> 
> 时间：2012-04-09T00:55:33.477
> 
> 标签：lua

我有 Lua 表，`t`我对其进行了迭代：

```
for k, v in pairs(t) do
    b = false
    my_func(v)
end 
```

并希望迭代暂停，直到`b`全局变量更改为`true`

有可能是Lua吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-09T01:13:52.327

除非您在协程中，否则*没有*您的代码执行 Lua 变量更改值的概念。所以你会暂停，直到不可能发生的事情发生。Lua 本质上是单线程的。

如前所述，您可以使用协程来执行此操作，但您必须相应地修改您的代码：

```
function CoIterateTable(t)
  for k, v in pairs(t) do
    b = false
    my_func(v)

    while(b == false) do coroutine.yield() end
  end
end

local co = coroutine.create(CoIterateTable)

assert(co.resume(t))
--Coroutine has exited. Possibly through a yield, possibly returned.
while(co.running()) do
  --your processing between iterations.
  assert(co.resume(t))
end 
```

请注意，`t`在迭代之间更改引用的表不会做任何有用的事情。

# joomla - 将 Joomla 1.5.20 版升级到 Joomla 2.5.4 版

> ID：10067835
> 
> 赞同：0
> 
> 时间：2012-04-09T00:55:47.153
> 
> 标签：joomla

我正在尝试将 Joomla 版本 1.5.20 升级到 Joomla 版本 2.5.4。

我过去升级了其他 CMS，但 Joomla 似乎有点不同。有人对升级的最佳方式有任何建议吗？

到目前为止，我已经：

*   下载了整个网站
*   通过 phpMyAdmin 导出数据库

我已经在本地安装了 MAMP 和 Joomla，我正在尝试在我的机器上复制他们的站点，以尝试在本地升级之前进行本地升级。我已经加载了模板，但还不能加载内容。

1.5.20和2.5.4之间好像有很多版本，让我有点紧张。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T02:07:36.897

您不能直接从 Joomla 升级！1.5.x 版本到 2.5.x 行，这是一个迁移。

由于 2.5 版本对 Joomla 来说是一个很大的变化！你必须找到 2.5 版本的：

*   您正在使用的模板
*   任何自定义扩展（即组件、插件、模块等）

[2.5 版具有新的技术要求](http://www.joomla.org/technical-requirements.html)，因此您需要检查您的服务器是否满足这些要求。

一旦你解决了所有问题。

您应该做的第一件事是将 1.5.x 站点的备份升级到最新版本，即。[1.5.26，因为它修复了一些安全问题](http://www.joomla.org/announcements/release-news/5419-joomla-1526-released.html)，并且最近的版本包括 1 或 2 个有助于迁移的错误。

完成该工作后，您将需要使用[本文档](http://docs.joomla.org/Migrating_from_Joomla_1.5_to_Joomla_2.5)中讨论的迁移工具。请注意，虽然本文档引用了 JUpgrade，但您可能最好查看[其他转换工具](http://extensions.joomla.org/extensions/migration-a-conversion/joomla-migration)之一，尤其是商业产品（根本不贵）。

我们迁移了 200 多个客户网站大约已经完成了一半，虽然我们开始使用免费的“推荐”组件，但我们现在使用商业[SP 升级](http://extensions.joomla.org/extensions/migration-a-conversion/joomla-migration/15609)（*除了购买并愉快地使用它之外，我与该产品没有任何关系*）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-24T04:18:09.030

要升级 joomla，插件**JUpgrade**是选项之一。它非常简单的工具。更新只需要点击几下。这是步骤。

**步骤1**

您需要做的第一件事是将您的 Joomla 1.5 网站更新到最新的安全更新（在撰写本文时为 1.5.25）。单击此处获取有关如何更新站点的教程。

**第2步**

创建您网站的备份。

**第 3 步**

我们将使用 jUpgrade 来迁移我们的网站。您可以从上面的链接下载 jUpgrade。

**第4步**

下载 jUpgrade 后，使用扩展管理器（扩展 -> 安装/卸载）将其安装在现有的 joomla 中。

![](../Images/b60fc0d226ee2d9a608ddf90f2aa50c7.png)

确保您已使用超级管理员登录。（迁移数据库和媒体需要超级管理员权限。）

**第 5 步**

在使用 jUpgrade 之前，您需要启用 System - Mootools 升级插件，因此导航到扩展，然后是插件管理器，搜索插件并启用它。（扩展 -> 插件管理器）

**第 6 步**

单击开始升级，它现在将自动升级如下，直到完成弹出窗口。

现在点击管理员，您将看到 Joomla 更新版本登录页面并确保所有内容传输成功（它只会传输新 Joomla 版本支持的内容） JUpgrade 将创建新目录。下载并安装 Joomla 较新版本到新目录，并在较新目录中传输媒体和内容。

[点击这里=](http://spjoshis.blogspot.in/2014/04/how-to-upgrade-joomla-from-15to-25.html)阅读更多。

# asp.net-mvc-3 - 使用 @FileUpload.GetHtml 助手设置文本框宽度

> ID：10067837
> 
> 赞同：0
> 
> 时间：2012-04-09T00:56:01.460
> 
> 标签：asp.net-mvc-3, razor

@FileUpload 帮助器渲染的文本框的宽度如何设置？什么是正确的语法？默认宽度约为 20 个字符，如果文件路径较长，则在文本框中看不到文件名。或者，如果有人知道如何让文本框内容默认完全向右滚动，那将是一个可以接受的解决方案。

谢谢，

乔

```
@using (Html.BeginForm("Upload", "FileUpload", FormMethod.Post,
                      new { @encType = "multipart/form-data" }))
{ <br/>
    @FileUpload.GetHtml(allowMoreFilesToBeAdded: false, initialNumberOfFiles: 1,
          includeFormTag: false, uploadText: "Upload File")<br/>
    <input type="submit" name="submit"  value="Upload" />
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T06:53:15.113

文件输入的外观取决于您使用的浏览器。您甚至没有在 Google Chrome 中获得文本框：

![在此处输入图像描述](../Images/ff868fb26a0e5fa8cadfc293452da718.png)

所以谈论设置这个元素的宽度几乎没有意义。

您可以查看[以下文章](http://www.quirksmode.org/dom/inputfile.html)，该文章讨论了涉及隐藏原始文件输入（因为您无法控制其呈现方式）并使用自定义 div 替换它的问题和可能的解决方法。

# git - 从 git/GitHub 的历史记录中删除文件夹及其内容

> ID：10067848
> 
> 赞同：414
> 
> 时间：2012-04-09T00:58:05.563
> 
> 标签：git, github, rebase, git-rebase

我在我的 GitHub 帐户上开发一个存储库，这是我偶然发现的一个问题。

*   Node.js 项目的文件夹中安装了一些 npm 包
*   包裹在`node_modules`文件夹中
*   将该文件夹添加到 git 存储库并将代码推送到 github（当时没有考虑 npm 部分）
*   意识到您实际上并不需要该文件夹成为代码的一部分
*   删除那个文件夹，推送它

在那种情况下，总 git repo 的大小约为**6MB**，而实际代码（除该文件夹外的所有代码）仅为**300 KB**左右。

现在我最终要寻找的是一种从 git 历史记录中删除该包文件夹详细信息的方法，因此如果有人克隆它，他们不必下载 6mb 的历史记录，他们将获得的唯一实际文件截至最后一次提交将是 300KB。

我为此查找了可能的解决方案并尝试了这两种方法

*   [从 git 存储库中删除文件（历史记录）](https://stackoverflow.com/questions/2164581/remove-file-from-git-repository-history)
*   [http://help.github.com/remove-sensitive-data/](http://help.github.com/remove-sensitive-data/)
*   [https://gist.github.com/1588371](https://gist.github.com/1588371)

Gist 似乎在运行脚本后有效，它显示它摆脱了该文件夹，然后它显示修改了 50 个不同的提交。但它并没有让我推送那个代码。当我尝试推送它时，它说`Branch up to date`但显示 50 个提交在`git status`. 其他两种方法也没有帮助。

现在，即使它显示它已经摆脱了该文件夹的历史记录，但当我在本地主机上检查该存储库的大小时，它仍然在 6MB 左右。（我也删除了该`refs/original`文件夹，但没有看到 repo 大小的变化）。

我想要澄清的是，如果有一种方法不仅可以摆脱提交历史（这是我认为唯一发生的事情），而且 git 一直假设想要回滚的那些文件。

可以说为此提出了一个解决方案并应用于我的本地主机但无法复制到该 GitHub 存储库，是否可以克隆该存储库，回滚到第一个提交执行技巧并推送它（或者这是否意味着 git 将仍然有所有这些提交的历史吗？ - 又名 6MB）。

我的最终目标是基本上找到从 git 中删除文件夹内容的最佳方法，这样用户就不必下载 6MB 的东西，并且仍然可能有其他从未触及模块文件夹的提交（这很漂亮很多）在 git 的历史中。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：650
> 
> 时间：2013-07-24T03:28:27.743

**警告：**[官方不再推荐](https://git-scm.com/docs/git-filter-branch#_warning)git filter-branch

如果您在这里复制粘贴代码：

这是一个`node_modules`从历史中删除的例子

```
git filter-branch --tree-filter "rm -rf node_modules" --prune-empty HEAD
git for-each-ref --format="%(refname)" refs/original/ | xargs -n 1 git update-ref -d
echo node_modules/ >> .gitignore
git add .gitignore
git commit -m 'Removing node_modules from git history'
git gc
git push origin master --force 
```

**git 实际上做了什么：**

第一行遍历`--tree-filter`与 HEAD（您的当前分支）相同的树（）上的所有引用，运行命令`rm -rf node_modules`。此命令删除 node_modules 文件夹（`-r`，没有`-r`，`rm`不会删除文件夹），不给用户提示（`-f`）。添加的`--prune-empty`删除无用（不改变任何东西）递归提交。

第二行删除对该旧分支的引用。

其余命令相对简单。

* * *

## 回答 #2

> 赞同：299
> 
> 时间：2015-10-01T11:26:03.487

我发现`--tree-filter`其他答案中使用的选项可能非常慢，尤其是在具有大量提交的大型存储库中。

这是我使用该`--index-filter`选项从 git 历史记录中完全删除目录的方法，该选项运行得更快：

```
# Make a fresh clone of YOUR_REPO
git clone YOUR_REPO
cd YOUR_REPO

# Create tracking branches of all branches
for remote in `git branch -r | grep -v /HEAD`; do git checkout --track $remote ; done

# Remove DIRECTORY_NAME from all commits, then remove the refs to the old commits
# (repeat these two commands for as many directories that you want to remove)
git filter-branch --index-filter 'git rm -rf --cached --ignore-unmatch DIRECTORY_NAME/' --prune-empty --tag-name-filter cat -- --all
git for-each-ref --format="%(refname)" refs/original/ | xargs -n 1 git update-ref -d

# Ensure all old refs are fully removed
rm -Rf .git/logs .git/refs/original

# Perform a garbage collection to remove commits with no refs
git gc --prune=all --aggressive

# Force push all branches to overwrite their history
# (use with caution!)
git push origin --all --force
git push origin --tags --force 
```

您可以在使用之前和之后检查存储库的大小`gc`：

```
git count-objects -vH 
```

* * *

## 回答 #3

> 赞同：95
> 
> 时间：2020-05-01T14:58:23.503

似乎对此的最新答案是**不**直接使用`filter-branch`（至少 git 本身不再推荐它），并将该工作推迟到外部工具。特别是，目前推荐使用[git-filter-repo 。](https://github.com/newren/git-filter-repo/)该工具的作者提供了关于为什么直接使用会导致问题的[论点。](https://github.com/newren/git-filter-repo/#filter-branch)`filter-branch`

上面要从历史记录中删除的大多数多行脚本`dir`可以重写为：

```
git filter-repo --path dir --invert-paths 
```

显然，该工具比这更强大。您可以按作者、电子邮件、参考名称等应用过滤器（[此处为完整手册页](https://htmlpreview.github.io/?https://github.com/newren/git-filter-repo/blob/docs/html/git-filter-repo.html)）。此外，它**很快**。安装很容易 - 它[以多种格式分发](https://github.com/newren/git-filter-repo/blob/master/INSTALL.md)。

* * *

## 回答 #4

> 赞同：56
> 
> 时间：2015-11-03T06:57:13.650

除了上面的流行答案[之外，](https://stackoverflow.com/a/17824718/4090370)我还想为**Windows 系统**添加一些注释。命令

```
git filter-branch --tree-filter 'rm -rf node_modules' --prune-empty HEAD 
```

*   **无需任何**修改即可完美运行！因此，**您不能**使用`Remove-Item`,`del`或其他任何东西来代替`rm -rf`.

*   如果您需要指定文件或目录的路径，请使用**斜杠**，例如`./path/to/node_modules`

* * *

## 回答 #5

> 赞同：26
> 
> 时间：2017-01-30T19:05:40.863

我发现最好和最准确的方法是下载 bfg.jar 文件： [https ://rtyley.github.io/bfg-repo-cleaner/](https://rtyley.github.io/bfg-repo-cleaner/)

然后运行命令：

```
git clone --bare https://project/repository project-repository
cd project-repository
java -jar bfg.jar --delete-folders DIRECTORY_NAME
git reflog expire --expire=now --all && git gc --prune=now --aggressive
git push --mirror https://project/new-repository 
```

如果要删除文件，请改用 delete-files 选项：

```
java -jar bfg.jar --delete-files *.pyc 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2015-01-22T18:12:34.480

完整的复制粘贴配方，只需在评论中添加命令（用于复制粘贴解决方案），经过测试：

```
git filter-branch --tree-filter 'rm -rf node_modules' --prune-empty HEAD
echo node_modules/ >> .gitignore
git add .gitignore
git commit -m 'Removing node_modules from git history'
git gc
git push origin master --force 
```

在此之后，您可以从 .gitignore 中删除“node_modules/”行

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2019-03-18T19:42:35.280

对于 Windows 用户，如果另一个备份已经存在，请注意使用`"`而不是`'` Also added以强制执行该命令。`-f`

```
git filter-branch -f --tree-filter "rm -rf FOLDERNAME" --prune-empty HEAD
git for-each-ref --format="%(refname)" refs/original/ | xargs -n 1 git update-ref -d
echo FOLDERNAME/ >> .gitignore
git add .gitignore
git commit -m "Removing FOLDERNAME from git history"
git gc
git push origin master --force 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2018-01-04T21:58:27.340

我在 Windows 上使用 git 从旧 C# 项目中删除了 bin 和 obj 文件夹。小心

```
git filter-branch --tree-filter "rm -rf bin" --prune-empty HEAD 
```

它通过删除 git install 文件夹中的 usr/bin 文件夹来破坏 git 安装的完整性。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-09-02T20:50:32.067

对于复制粘贴（从[这里](https://docs.github.com/en/github/authenticating-to-github/keeping-your-account-and-data-secure/removing-sensitive-data-from-a-repository)）：

```
git filter-repo --invert-paths --path PATH-TO-YOUR-FILE-WITH-SENSITIVE-DATA
echo "YOUR-FILE-WITH-SENSITIVE-DATA" >> .gitignore
git add .gitignore
git commit -m "Add YOUR-FILE-WITH-SENSITIVE-DATA to .gitignore"
git push origin --force --all 
```

# java - 为什么不能在重写方法中放宽参数类型？

> ID：10067850
> 
> 赞同：1
> 
> 时间：2012-04-09T00:58:20.047
> 
> 标签：java, overriding, design-rationale

此代码无效：

```
interface Foo
{
    public void foo(final String string);
}

public class Bar implements Foo
{
    // Error: does not override.
    @Override public void foo(final Object object)
    {
    }
} 
```

因为 every`String`显然是 an ，`Object`所以我希望这段代码非常好：任何依赖于在实际使用.`foo()``String``foo()``Object`

但是，似乎方法签名必须与它们覆盖的方法的签名相同。为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T01:01:10.827

如果什么

```
interface Foo
{
    void foo(String string);
    void foo(Object string);
} 
```

那么哪个方法被 Bar 覆盖了呢？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T01:23:17.433

正如您所说，“松动”不应影响期望以特定方式使用您的接口定义方法的人，因为您在该对象上调用的任何方法理论上都应该可以在指定对象上调用，但 Eugene 的观点是站得住脚的，因为会有如果您只是模糊地想要坚持接口规范，那么在确定您实际打算覆盖的方法时可能会有点编译器头痛。此外，如果您要坚持向上移动继承层次结构，为什么这会是可取的，因为您肯定能够对层次结构更靠下的事物做所有您想做的事情，例如“对象”？可能在您的方法中进行投射会解决您的问题吗？如果可以做自己想做的事，

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T01:27:34.667

我认为这是一个经典的逆变问题。您的接口需要一个字符串作为参数传递，您需要一个接受对象的实现（因为毕竟字符串也是对象）。

问题是，如果您允许这样做，那么您将无法再保证接口所需的参数是字符串或其任何一个祖先。您也可以将任何对象传递给您的实现，这样您就会违反接口的约定，从而危及您设计的类型安全和类型一致性。

但是，您确实有选择：

```
public class Bar implements Foo
{

    @Override public void foo(final String object)
    {
    }

    public void foo(final Object object)
    {
       foo((String) object);
    }
} 
```

这样，您将确保对象实际上是一个字符串，从而使类型系统可以检查您是否真正遵守方法签名中建立的接口契约。

是否存在特定情况下您会认为逆变示例是必需的？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-09T01:58:12.893

它只是 Java 编程语言的结构。Java 程序的结构会随着你的成长而发展。所以现在只是尝试调整。

# povray - 使用povray导出数据

> ID：10067852
> 
> 赞同：2
> 
> 时间：2012-04-09T00:58:57.503
> 
> 标签：povray

POVRay 中是否有任何机制可以导出数据？我使用了一些 SDL 代码来创建一长串渲染场景所需的点，令我震惊的是，如果我可以导出那些一旦创建，它将加快我的渲染速度。我想我可以使用#debug 语句来输出格式化的字符串，我可以用于我的数组初始化和直接输出到未来的包含文件，但我想知道我是否错过了更好的方法？

谢谢，BBB

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T15:20:08.243

如果不去摆弄 POVRay 源代码，我无法想象你会怎么做。除了 SDL 之外，没有其他选项可以加载任何形式的数据，而且 POVRay 从不输出 SDL - 它只读取它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-25T01:28:43.930

是的，povray 输出各种格式。请参阅：[http](http://wiki.povray.org/content/Reference:File_I/O_Directives) : //wiki.povray.org/content/Reference:File_I/O_Directives 也可能有一些示例文件随 povray 一起提供。

# ios - UITextView：如何真正禁用编辑？

> ID：10067853
> 
> 赞同：12
> 
> 时间：2012-04-09T00:59:25.443
> 
> 标签：ios, objective-c, uitextview

我正在尝试禁用我的`UITextView`. 我试过`[aboutStable setUserInteractionEnabled: NO]`了，但它会导致页面无法访问。

这是当前代码。

```
- (void)loadTextView1 {
    UITextView *textView1 = [[UITextView alloc] init];
    [textView1 setFont:[UIFont fontWithName:@"Helvetica" size:14]];
    [textView1 setText:@"Example of editable UITextView"];
    [textView1 setTextColor:[UIColor blackColor]];
    [textView1 setBackgroundColor:[UIColor clearColor]];
    [textView1 setTextAlignment:UITextAlignmentLeft];
    [textView1 setFrame:CGRectMake(15, 29, 290, 288)];
    [self addSubview:textView1];
    [textView1 release];
} 
```

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-04-09T01:15:09.703

首先，当您只能使用属性时，您正在使用 setter 方法。其次，您正在设置一大堆非常接近默认值的不必要属性。这是一个更简单的，也许是您对代码的意图：

### Objective-C

```
- (void)loadTextView1 {
    UITextView *textView1 = [[UITextView alloc] initWithFrame:CGRectMake(15, 29, 290, 288)];
    textView1.text = @"Example of non-editable UITextView";
    textView1.backgroundColor = [UIColor clearColor];

    textView1.editable = NO;

    [self addSubView:textView1];
    [textView1 release];
} 
```

### 迅速

```
func loadTextView1() {
    let textView1 = UITextView(frame: CGRect(x: 15, y: 29, width: 290, height: 288))
    textView1.text = "Example of non-editable UITextView"
    textView1.backgroundColor = .clear

    textView1.isEditable = false

    addSubView(textView1)
} 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-04-09T01:04:38.673

您可以使用该物业`editable`

```
textView.editable = NO; 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-09-01T18:28:40.093

## 斯威夫特 2.0 版本

```
self.textView.editable = false 
```

更多细节可以在苹果[UIKit 框架参考](https://developer.apple.com/library/prerelease/ios/documentation/UIKit/Reference/UITextView_Class/)中找到。

* * *

**要考虑的其他 UITextView 属性：**

*   文本
*   属性文本
*   字体
*   文字颜色
*   可编辑
*   允许编辑文本属性
*   数据检测器类型
*   文本对齐
*   打字属性
*   链接文本属性
*   textContainerInset

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2017-11-29T08:09:01.453

**对于 Swift 3.0 和 Swift 4.0：**

```
textView.isEditable = false 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-02-14T13:19:06.080

如果您使用的是界面生成器，您可以在属性检查器中取消选中“可编辑”。

[![属性检查器](../Images/a01030d4d4dd073037e12c158931e3e3.png)](https://i.stack.imgur.com/7ER5S.png)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-02-18T17:05:07.770

哇，这个肯定是被干死了！很抱歉添加另一个，但我应该提到您可以通过以下方式消除任何用户不确定性：

```
commentTextView.isUserInteractionEnabled = false 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-12-14T07:26:16.603

**斯威夫特 3.0**

```
func loadTextView1()
 {
    let textView1 = UITextView()
    textView1.text = "Example of non-editable UITextView"
    textView1.backgroundColor = UIColor.clear
    textView1.frame = CGRect(x: 15, y: 29, width: 290, height: 288)
    textView1.isEditable = false
    addSubView(textView1)
} 
```

否则，在 Xcode 的 Interface Builder 中，取消选中 Attributes Inspector 中文本视图的“Editable”。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-07-06T20:03:48.400

如果要阻止所有用户交互，则需要执行以下 2 件事：

```
 self.commentText.isEditable = false
    self.commentText.isSelectable = false 
```

# android - 使用动画图像，将代码从 OnCreat 函数替换为 setOnClickListener 函数

> ID：10067855
> 
> 赞同：0
> 
> 时间：2012-04-09T00:59:30.920
> 
> 标签：android

我正在尝试为图像制作动画，这是我在 xml 文件中的代码

```
<animation-list xmlns:android="http://schemas.android.com/apk/res/android" 
android:oneshot="false" >
<item android:drawable="@drawable/father11" android:duration="200" />
<item android:drawable="@drawable/father22" android:duration="200" />
<item android:drawable="@drawable/father33" android:duration="200" />
<item android:drawable="@drawable/father44" android:duration="200" />
<item android:drawable="@drawable/father55" android:duration="200" />
</animation-list> 
```

但是在我的应用程序中，我必须在单击按钮时运行动画图像，但我收到了 sentax 错误

```
btn_father.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
            // TODO Auto-generated method stub
             SignImage = (ImageView) findViewById(R.id.Sign);
             SignImage.setImageResource(R.drawable.fatherr);
             lightsAnimation=(AnimationDrawable) SignImage.getDrawable();

            }
        public void onWindowFocusChanged(boolean hasFocus) {
              super.onWindowFocusChanged(hasFocus);
              lightsAnimation.start();

            }

    }); 
```

我在链接中阅读了这个句子，但不理解它“（如果可以很容易地用按钮或其他类型的输入开始）。用这个类替换 src 树中 main.java 文件中的主类”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T12:00:24.527

好的，View.OnClickListener 只有一种方法 onClick，所以如果你想在点击时开始动画，请执行以下操作：

```
btn_father.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
            // TODO Auto-generated method stub
             SignImage = (ImageView) findViewById(R.id.Sign);
             SignImage.setImageResource(R.drawable.fatherr);
             lightsAnimation=(AnimationDrawable) SignImage.getDrawable();
             lightsAnimation.start();

            }

    }); 
```

如果您希望动画也应用于焦点更改，请在 View 上应用 onFocusChanged 侦听器。

# ruby - 我应该如何重新创建第一次在 Fiddler in Ruby 中看到的 POST？

> ID：10067867
> 
> 赞同：1
> 
> 时间：2012-04-09T01:01:12.997
> 
> 标签：ruby, http, post, fiddler, wireshark

这看起来很简单：

*   在 Fiddler 中捕获 POST（Windows，因为我发现它比 WireShark 更容易使用）
*   获取发布的数据
*   `Net::Http`在 Ruby 中使用类似的 POST

但是。每次我运行帖子时，它都会得到 500。真的可以在这里使用一个建议。

原始帖子（原始）：

```
POST http://www.example.com/products/ajax HTTP/1.1
Host: www.example.com
Connection: keep-alive
Content-Length: 154
Origin: http://www.example.com
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.19 (KHTML, like Gecko) Chrome/18.0.1025.142 Safari/535.19
Content-Type: application/x-www-form-urlencoded
Accept: application/json, text/javascript, */*; q=0.01
Referer: http://www.example.com/products
Accept-Encoding: gzip,deflate,sdch
Accept-Language: en-US,en;q=0.8
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.3

q=getProducts&page=52&type=leaf_blowers 
```

但是当我在 Rails 控制台中得到这个时：

```
>> res = http.post_form URI.parse(the_url), {'a' => 'getProducts', 'page'=> '52', 'type'=> 'leaf_blowers'}
=> #<Net::HTTPInternalServerError 500 Internal Server Error readbody=true> 
```

第一个（提琴手）导致返回 HTML。第二个只是一个 500 错误。**我在这里有什么明显的遗漏吗？**如果您想查看 Wireshark 捕获，请告诉我如何让它看起来像 Fiddler 原始捕获——我不知道如何从 Wireshark 中获取这些细节。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T02:04:58.470

当您发布问题时，也许这是一个错字，但原始帖子有

```
q=getProducts 
```

然后你提出请求：

```
'a' => 'getProducts' 
```

如果您使用**'q' => 'getProducts'**发出请求会发生什么？

# c++ - C++ Visual Studio Express - 分配返回值失败函数

> ID：10067871
> 
> 赞同：0
> 
> 时间：2012-04-09T01:01:45.363
> 
> 标签：c++, visual-studio

我的程序有一个非常奇怪的问题，希望您能提供帮助。我有一对非常基本的功能。一个调用另一个并需要返回 int。

由于完全未知的原因，如果将变量的返回值分配给变量，即使条件为真，第一个函数也无法打印出匹配项，即：

功能一：

```
int function1(int posX, int posY){
    int x=1;
    int y=1;
    if (posX == X && posY == Y){        
        printf("Match");
        return 1;
    }
} 
```

功能二：

```
int i = function1(1, 1); 
```

是否有效：

```
function1(1,1); 
```

所以为了澄清，我说如果我收到“匹配”消息，它就可以工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T01:04:51.583

```
(posX == X && posY == Y) 
```

C/C++*区分大小写*。“X”和“Y”分别代表什么？

也许尝试将它们更改为小写？

*`return`此外，即使没有匹配项，也要始终尝试一个值（该函数`function1`应该返回一个`int`值，对吗？）*

* * *

**代码：（**更正）

```
int function1(int posX, int posY){
    int x=1;
    int y=1;

    if ((posX == x) && (posY == y)){     
        printf("Match");
        return 1;
    }

    return 0;
} 
```

# matlab - 在Matlab中将符号分解的输出转换为矩阵表示

> ID：10067880
> 
> 赞同：3
> 
> 时间：2012-04-09T01:03:15.960
> 
> 标签：matlab, symbolic-math

的输出

> > 因子（符号（'12345678901234567890'））

是

```
ans =

2*3^2*5*101*3541*3607*3803*27961 
```

有没有一种简单的方法可以将输出更改为：

```
[2 3 5 101 3541 3607 3803 27961; 1 2 1 1 1 1 1 1]? 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T14:50:31.280

试试这个代码：

```
aux = char(factor(sym('12345678901234567890'))); % convert to string
aux = regexprep(aux, {'*'}, ''',''');            % replace '*' with '',''
result = eval( ['{''',aux,'''}']);               % evaluate string expression

% Separate each string into tokens around the '\^' character
factor = cell(1,length(result));
exponent = cell(1,length(result));
for i=1:length(result)
    factor{i} = regexpi(result{i}, '(\w*)\^', 'tokens');
    if isempty(factor{i})
        factor{i} = result{i};
    else
        factor{i} = char(factor{i}{1});
    end
    exponent{i} = regexpi(result{i}, '\^(\w*)', 'tokens');
    if isempty(exponent{i})
        exponent{i} = '1';
    else
        exponent{i} = char(exponent{i}{1});
    end
end

% Converting the cellstr to normal matrices
factors = zeros(length(factor),1);
exponents = zeros(length(exponent),1);
for i=1:length(factor)
    factors(i) = str2num(factor{i});
    exponents(i) = str2num(exponent{i});
end

clear result factor exponent i aux; 
```

实际上，解决方案类似于 Kokbira 的建议。

希望能帮助到你，

# algorithm - 查找第 k 个最小元素数据结构

> ID：10067881
> 
> 赞同：5
> 
> 时间：2012-04-09T01:03:26.007
> 
> 标签：algorithm, data-structures, heap

我这里有一个问题，需要设计一个数据结构，该结构在以下三个操作中采用 O(lg n) 最坏情况：

```
 a) Insertion: Insert the key into data structure only if it is not already there.
  b) Deletion: delete the key if it is there!
  c) Find kth smallest : find the ݇k-th smallest key in the data structure 
```

我想知道我是否应该使用堆，但我仍然没有一个明确的想法。
我可以很容易地得到 O(lg n) 的前两部分，甚至更快，但不知道如何处理 c) 部分。

任何人有任何想法请分享。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-09T03:24:54.550

想到了两个解决方案：

*   使用平衡的二叉搜索树（红黑、AVG、Splay，......任何都可以）。您已经熟悉操作 (1) 和 (2)。对于操作 (3)，只需在每个节点存储一个额外的值：该子树中的节点总数。您可以轻松地使用此值找到 O(log(n)) 中的第 k 个最小元素。例如，假设你的树如下 - 根 A 有 10 个节点，左孩子 B 有 3 个节点，右孩子 C 有 6 个节点（3 + 6 + 1 = 10），假设你想找到第 8 个最小的元素，你知道你应该去右边。

*   使用跳过列表。它还平均支持所有 O(logn) 的 (1)、(2)、(3) 操作，但实现时间可能要长一些。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-09T01:09:09.840

好吧，如果您的数据结构保持元素排序，那么很容易找到第 k 个最低的元素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T01:23:54.237

用于搜索和插入的二叉搜索树的最坏情况成本是 O(N)，而平均情况成本是 O(lgN)。

因此，我建议使用红黑二叉搜索树，它保证搜索和插入的最坏情况复杂度为 O(lgN)。

您可以在此处阅读有关红黑树的更多信息，并[在此处](http://en.wikipedia.org/wiki/Red%E2%80%93black_tree)[查看](http://algs4.cs.princeton.edu/33balanced/RedBlackBST.java.html)Java 中红黑 BST 的实现。
因此，就使用上述红黑 BST 实现查找第 k 个最小元素而言，您只需调用*select*方法，传入*k*的值。*select*方法还保证了最坏情况的O(lgN)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-22T15:54:32.673

解决方案之一可能是使用快速排序策略。

步骤 1：选择第一个元素作为枢轴元素并将其带到正确的位置。（最多 n 次检查）现在，当您到达此元素的正确位置时，您将进行检查

步骤 2.1：如果 location >k 您的元素位于第一个子列表中。所以你对第二个子列表不感兴趣。

步骤 2.2 如果位置

步骤 2.3 如果 location == k 你已经让元素破坏了外观/递归

第 3 步：使用适当的子列表重复第 1 步到第 2.3 步

该解决方案的复杂度为 O(n log n)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-19T09:06:27.287

堆不是查找数组中第 K 个最小元素的正确结构，因为您必须从堆中删除 K-1 个元素才能找到第 K 个元素。

找到第 K 个最小元素的方法要好得多，它依赖于中位数算法。基本上任何分区算法平均来说都足够好，但是中位数的中位数伴随着最坏情况 O(N) 时间的证明来找到中位数。通常，该算法可用于查找任何特定元素，而不仅仅是中位数。

下面是这个算法在C#中的分析和实现：**[Finding Kth Smallest Element in an Unsorted Array](http://www.sysexpand.com/?path=exercises/kth-smallest)**

PS 在相关说明中，您可以使用数组就地执行许多操作。数组是一种奇妙的数据结构，只有当您知道如何在特定情况下组织其元素时，您才能非常快速地获得结果并且无需额外的内存使用。

堆结构就是一个很好的例子，快速排序算法也是如此。这是一个有效使用数组的非常有趣的例子（这个问题来自编程奥运会）：**[Finding a Majority Element in an Array](http://www.sysexpand.com/?path=exercises/majority-element)**

# php - FPDF包括一个php文件？

> ID：10067883
> 
> 赞同：0
> 
> 时间：2012-04-09T01:04:34.347
> 
> 标签：php, pdf-generation, fpdf

我想使用 Fpdf 发送一个用于打印到标签的动态页面，但是我不完全确定如何让 Fpdf 显示我的 php 文件的内容。

php 文件在文件中呈现包含用户 url、头像、自定义用户背景和名称的页面`contactcard.php`。

我将如何使用 Fpdf 将其发送到 PDF？

我尝试创建一个函数，但它不会在 PDF 中打印图像。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T22:00:45.697

我对房地产清单做了类似的事情。我已将文本和图像输出到 pdf 以使用 fpdf 和 php 保存或打印。

我使用了一个带有隐藏字段的表单。单击表单按钮，然后转到 fpdf 页面。该表单使用 Post，因此我可以使用类似...的内容检索 fpdf 页面上的数据。

```
$username = $_POST(username); 
```

我包含图像的方式是直接链接到图像，很好。我有一个从数据库中检索到的 ID，我将其包含在文件名中以显示正确的图像，例如

```
$image = "http://www.yourdomain.com/img/avatar_$id.jpg"; 
```

然后你会用 fpdf 来显示它们，比如......

```
$pdf->Cell(10,0,$username,0,0);
$pdf->Image($image,30,36); 
```

您可以使用会话，因此您不必包含表单。这也应该有效。可能更适合您的情况。

我希望这就是你所追求的。

# ruby - 如何对 .erb 文件中的两个变量执行内联计算？

> ID：10067889
> 
> 赞同：0
> 
> 时间：2012-04-09T01:05:41.757
> 
> 标签：ruby

我在 Sinatra 应用程序中有以下 .erb 视图：

```
<% sessions.each do |session| %>
    <%= session.balance_beginning %>
    <%= session.balance_ending %>
<% end %> 
```

它按预期工作，显示每个会话记录的期初余额和期末余额。我想从 .erb 文件中计算净余额，但我不知道该怎么做。我已经尝试过这种变化：

```
<% sessions.each do |session| %>
    <%= session.balance_ending - session.balance_beginning %>
<% end %> 
```

那是行不通的。我在 Sinatra 中收到以下错误：

```
undefined method `-' for nil:NilClass 
```

我该如何做我想做的事？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T01:27:15.583

对@Zabba，在这种情况下，我认为您会在会话模型中添加一个方法，以便您可以调用 session.net_balance。

然后在您的 balance_ending 和 balance_beginning 方法中，您希望处理 nil，如果有效，则引发错误或返回零。

# python - Python 正则表达式边界

> ID：10067891
> 
> 赞同：0
> 
> 时间：2012-04-09T01:05:48.567
> 
> 标签：python, regex

python处理'.'的方式是否有错误？或'\ b'？我不确定为什么这会产生不同的结果。

```
import re

regex1 = r'\.?\b'
print bool(re.match(regex1, '.'))

regex2 = r'a?\b'
print bool(re.match(regex2, 'a')) 
```

输出：

```
False

True 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T01:09:08.493

`\b`，单词边界，单词字符和非单词元素之间的匹配。因此，它将匹配单词字符 like`a`和字符串的结尾，但不会匹配非单词字符 like`.`和字符串的结尾。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T01:47:03.453

正如 geekosaur 指出的那样，`\b`这只是一种简短的写作方式

```
(?:(?<=\w)(?!\w)|(?<!\w)(?=\w)) 
```

在您的情况下，您可能想要使用

```
(?!\w) 
```

或者

```
(?!\S) 
```

而不是`\b`.

# c++ - VS 2010中返回值的编译器优化

> ID：10067892
> 
> 赞同：6
> 
> 时间：2012-04-09T01:05:49.633
> 
> 标签：c++, optimization, inline, compiler-optimization, return-value-optimization

使用 VS 2010 进行全面优化 /Ox 查看以下两个函数调用：

```
static string test1(const string& input)
{
    return input;
}

static void test2(const string& input, string& output)
{
    output = input;
} 
```

如果我使用后者 test2 那么函数总是被优化出来并且代码内联。但是，除非我关闭异常，否则 test1 不会内联。有人知道为什么是这样吗？

此外，如果编译器使用返回值优化，我希望编译器能够在 test1 中像 test2 一样高效地完成工作，但它似乎没有这样做。这也让我很困惑。

我想使用第一个函数签名的原因是我有两个可编译的函数版本。我希望调用代码始终调用 test1 并且当设置了某个编译标志时，我希望它将输入附加到副本并返回它，当未设置编译标志时，我希望它尽可能接近否-op 尽可能。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-09T01:19:18.597

Visual Studio 不能内联返回具有非平凡析构函数的对象的函数：

> 在某些情况下，编译器出于机械原因不会内联特定函数。例如，编译器不会内联：
> 
> *   一个函数，如果它会导致混合 SEH 和 C++ EH。
> *   当 -GX/EHs/EHa 开启时，某些具有按值传递的复制构造对象的函数。
> *   **当 -GX/EHs/EHa 开启时，函数按值返回可展开的对象。**
> *   在没有 -Og/Ox/O1/O2 的情况下编译时使用内联汇编的函数。
> *   具有可变参数列表的函数。
> *   带有 try（C++ 异常处理）语句的函数。

[http://msdn.microsoft.com/en-us/library/a98sb923.aspx](http://msdn.microsoft.com/en-us/library/a98sb923.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T07:34:34.780

当返回值是函数的参数时，标准明确禁止编译器使用返回值优化 (12.8/31)：

> 这种复制/移动操作的省略，称为复制省略，在以下情况下是允许的（可以结合起来消除多个副本）：
> 
> — 在具有类返回类型的函数的 return 语句中，当表达式是具有与函数返回类型相同的 cv 非限定类型的非易失性自动对象（**函数或 catch 子句参数**除外）的名称时, 可以通过将自动对象直接构造到函数的返回值中来省略复制/移动操作
> 
> — ...

# asp.net-mvc-3 - 无法将文件上传功能添加到生成的 MVC3 页面

> ID：10067893
> 
> 赞同：2
> 
> 时间：2012-04-09T01:05:52.287
> 
> 标签：asp.net-mvc-3

我是 MCV 新手，正在学习 MVC3。我创建了一个模型和一个控制器，并为我生成了视图。生成的代码对我来说非常有意义。我想修改生成的视图和控制器，以便在“创建”新记录时可以上传文件。有很多关于如何做到这一点的好信息。具体来说，我试过这个：[http ://haacked.com/archive/2010/07/16/uploading-files-with-aspnetmvc.aspx](http://haacked.com/archive/2010/07/16/uploading-files-with-aspnetmvc.aspx)

问题是即使我选择了一个文件（不大）并提交，请求中也没有文件。也就是说，Request.Files.Count 为 0。

如果我在同一个项目（无模型）中创建控制器并从头开始查看，则该示例可以正常工作。我只是无法将该功能添加到生成的页面中。基本上，我正在尝试让 Create 操作也发送文件。例如，创建一个新的产品条目并将图片与它一起发送。

示例创建视图：

```
@model Product.Models.Find

@{
    ViewBag.Title = "Create";
}

<h2>Create</h2>

<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>

@using (Html.BeginForm("Create", "Find", FormMethod.Post, new { enctype = "multipart/form-data" }))
{
@Html.ValidationSummary(true)
<fieldset>
    <legend>Find</legend>

        <input type="file" id="file" /> 

    <div class="editor-label">
        @Html.LabelFor(model => model.Title)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.Title)
        @Html.ValidationMessageFor(model => model.Title)
    </div>

    <div class="editor-label">
        @Html.LabelFor(model => model.Description)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.Description)
        @Html.ValidationMessageFor(model => model.Description)
    </div>

    <p>
        <input type="submit" value="Create" />
    </p>
</fieldset>
}

<div>
    @Html.ActionLink("Back to List", "Index")
</div> 
```

示例控制器：

```
 [HttpPost]
    public ActionResult Create(Product product)
    {
        if (ModelState.IsValid)
        {
            if (Request.Files.Count > 0 && Request.Files[0] != null)
            {
                //Not getting here
            }

            db.Products.Add(product);
            db.SaveChanges();
            return RedirectToAction("Index");  
        }

        return View(find);
    } 
```

这将很好地创建记录，但没有与请求关联的文件。

我也尝试过这样的控制器操作：

```
 [HttpPost]
    public ActionResult Create(HttpPostedFileBase file)
    {
        if (file.ContentLength > 0)
        {
            //Not getting here
        }

        return RedirectToAction("Index");
    } 
```

我想知道您是否不能在发布表单字段的同时发布文件？如果是这种情况，创建新记录并将图片（或其他文件）与之关联的模式是什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T01:12:13.163

您将必须为`Product`(maybe `ProductViewModel`) 创建一个 ViewModel 并添加一个`HttpPostedFileBase`与表单字段同名的字段，并`Product`在控制器的操作中使用它而不是。

ViewModel 只不过是用于特定视图的模型。大多数时候，使用额外的数据来生成视图或在控制器动作上分解和形成模型。

```
public ProductViewModel
{
    public string Cod { get; set; }
    // All needed fields goes here

    public HttpPostedFileBase File{ get; set; }

    /// Empty constructor and so on ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T01:26:05.493

创建一个具有处理图像和产品细节的属性的 ViewModel

```
public class ProductViewModel
{
 public string ImageURL { set;get;}
 public string Title { set;get;}
 public string Description { set;get;}
} 
```

在您的 HTTPGET Action 方法中，将此 ViewModel 对象返回到您的强类型视图

```
 public ActionResult Create()
 {
        ProductViewModel objVM = new ProductViewModel();
        return View(objVM);
 } 
```

在你看来

```
@model ProductViewModel 
<h2>Add Product</h2>
 @using (Html.BeginForm("Create", "Home", FormMethod.Post, new { enctype = "multipart/form-data" }))
{
  @Html.TextBoxFor(m => m.Title) <br/>
  @Html.TextBoxFor(m => m.Description ) <br/>
  <input type="file" name="file" />
  <input type="submit" value="Upload"  />
  @Html.HiddenFor(m => m.ImageURL )
} 
```

现在在您的 HttpPost 操作方法中，接受此 ViewModel 和 File

```
[HttpPost]
public ActionResult Create(HttpPostedFileBase file, ProductViewModel objVM)
{
  if(file==null)
  {
     return View("Create",objVM);
  }
 else
 {
    //You can check ModeState.IsValid if you have to check any model validations and do further processing with the data here.
    //Now you have everything here in your parameters, you can access those and save
 }        
} 
```

# azure - 什么可能导致我的 WebRole 永远无法启动？

> ID：10067895
> 
> 赞同：0
> 
> 时间：2012-04-09T01:05:54.803
> 
> 标签：azure

我有一个作为 Web 角色托管在 azure 上的 Web 服务。在这个 Web 角色中，我重写了 Run() 方法并按以下顺序执行一些数据库操作，以基本上充当工作角色。

1.  转到 blob 存储以提取一小组数据。

2.  缓存此数据以备将来使用。

3.  杀死一些太旧的 blob。

4.  > ```
    > Thread.Sleep(900000); 
    > ```

基本上，该操作在后台每 15 分钟重复一次。当我在 DevFabric 上运行时它运行良好，但是在部署 azure 门户时会陷入稳定角色然后准备节点的循环中。

从来没有真正启动任何一个实例。我启用了诊断，但它没有显示任何提示存在问题的信息。我不知道为什么会发生这种情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T01:16:10.747

听起来像是在 OnStart 中引发了错误。您是否有任何方法可以尝试/捕获整个函数并将错误转储到 EventViewer 中？从那里您将能够远程进入实例并调查错误

您部署到云的配置很可能与在模拟器中运行的配置不同（SQL Azure 防火墙权限、指向本地开发存储而不是 ATS 的指针等）。此外，请确保您的诊断程序指向真实的 Azure 帐户，而不是本地开发存储。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T03:19:35.270

我建议将此代码移至`Run()`. 在`OnStart()`中，您的角色实例对负载均衡器尚不可见，并且由于您在 中引入了很长（好的，无限延迟）`OnStart()`，这可能就是您看到有关角色试图稳定的消息的原因（更多有关这些消息的信息在[这里](http://msdn.microsoft.com/en-us/library/windowsazure/hh127564.aspx)。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T21:31:42.137

当其他人努力帮助我时，我通常不喜欢回答我自己的问题，但是我觉得应该记录我用来解决这个问题的方法。

我在部署到 Azure 时启用了 Intellitrace，我能够看到所有抛出的异常并调查异常的原因。

Intellisense 对解决我的部署问题至关重要。我会向任何看到部署 devfabric 和部署到 azure 之间不一致的人推荐它。

# visual-c++ - 用 ABC 和 123 查找三个字母字符串的排列数

> ID：10067907
> 
> 赞同：1
> 
> 时间：2012-04-09T01:09:20.357
> 
> 标签：visual-c++, permutation

我从代数课上知道，使用 ABC 和 123，我们可以对三个字母的字符串进行 216 种不同的排列，对吧？(6 x 6 x 6) 我想在 C++ 中创建一个控制台程序，以显示上述示例的所有可能排列。问题是，我什至如何开始尝试计算它们。也许：

AAA BAA CAA 1BA 2BA 3CA 1AB 2BC 3CA

等等

这真的很难问，但是我必须做些什么来确保我包含每个排列？我知道有 216 个，但我不知道如何真正经历所有这些。

任何建议将不胜感激！！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T01:14:28.423

如果您需要固定数量的字符串，则可以使用`N`嵌套循环（在您的情况下为三个）。

```
string parts = "ABC123";
for (int i = 0 ; i != parts.size() ; i++)
    for (int j = 0 ; j != parts.size() ; j++)
        for (int k = 0 ; k != parts.size() ; k++)
            cout << parts[i] << parts[j] << parts[k] << endl; 
```

如果`N`不固定，则需要更通用的递归解决方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T01:24:29.323

使用递归真的很容易。如果您有一个包含所有六个元素的数组，那么这里是执行此操作的 java 代码。我相信您可以轻松地将其翻译成 C++。

```
void getAllCombinations(List<String> output, char[] chrs, String prefix, int length) {
    if (prefix.length() == length) {
        output.add(prefix);
    } else {
        for (int i = 0;i < chrs.length;i++) {
            getAllCombinations(output, chrs, prefix + chrs[i], length);
        }
    }
    return;
} 
```

这并不完美，但它应该给你一个大致的想法。使用参数运行它：空列表、可用字符数组、空字符串和所需字符串的长度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T01:15:32.533

使用三个嵌套循环（每个字符位置一个）迭代 6 个允许字符中的每一个，很难*不*看到每个可能的组合都有一组相应的循环索引，并且每组合法循环索引都有一个对应的 3 个字母字符串。我收集到，循环索引和字符串之间的 1-1 对应就是您要寻找的。

# swing - 根据 Prefuse 中的数据更改矩形大小

> ID：10067912
> 
> 赞同：0
> 
> 时间：2012-04-09T01:10:53.530
> 
> 标签：swing, prefuse

我想使用 Prefuse 可视化散点图。与典型散点图的区别在于我想使用矩形而不是圆形或点。原因是我想同时可视化时间和持续时间。有谁知道如何根据表格中的数据设置矩形的长度或宽度？在网上搜索后我没有得到正确的答案。

我最初想使用此参数绘制矩形。

```
 ShapeAction shape = new ShapeAction(group, Constants.SHAPE_RECTANGLE); 
```

但我没有找到只改变它的长度而是改变整个尺寸的方法。谁能给我一些指示？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T22:30:09.950

假设您要创建类似于[LifeLines](http://www.cs.umd.edu/hcil/lifelines/)或 GANTT 图表的可视化。

为了实现这一点，prefuse 必须在几个点上扩展 prefuse。这是一个大纲：

1.  向 中添加一个字段以`VisualTable`存储矩形末尾的 x 坐标
2.  扩展`AxisLayout`以确定矩形的另外末端。
3.  `AbstractShapeRenderer`使用结束坐标扩展绘制一个矩形

# objective-c - 使用 Objective-c 执行 PHP 脚本或单向请求

> ID：10067916
> 
> 赞同：0
> 
> 时间：2012-04-09T01:11:26.903
> 
> 标签：objective-c, ios, cocoa, post

> **可能重复：**
> [使用objective-c执行PHP脚本](https://stackoverflow.com/questions/10060152/executing-a-php-script-using-objective-c)

有人可以使用 ASIHTTPRequest 库或 NSURLConnection 在 Objective-C 中如何执行单向请求（我不需要任何响应）。是否可以使用 ASIHTTPRequest 异步执行此操作？

另外，这会被视为 HTTP POST 请求吗？例如，url 类似于 myURL.com/performThisScript.php?specialID=1

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T01:19:11.597

**代码 ：**

```
 NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:@"http://www.yourdomain.com/script.php"];
    NSString *result = (NSString *) CFURLCreateStringByAddingPercentEscapes(kCFAllocatorDefault, (CFStringRef)yourData, NULL, CFSTR("?=&+"), kCFStringEncodingUTF8);
    [request setValue:@"application/x-www-form-urlencoded" forHTTPHeaderField:@"Content-Type"];
    [request setHTTPBody:[result dataUsingEncoding:NSUTF8StringEncoding]];
    [request setHTTPMethod:@"GET"];
    NSURLConnection *theConnection=[[NSURLConnection alloc] initWithRequest:request delegate:self]; 
```

**暗示 ：**

由于`myURL.com/performThisScript.php?specialID=1`URL 中隐含参数，因此您应该`GET`.

# c# - EnumerateFiles 关于子文件夹的内存效率

> ID：10067921
> 
> 赞同：1
> 
> 时间：2012-04-09T01:12:51.107
> 
> 标签：c#, .net, ienumerable

我有 200 万个文件分布在按年和月划分的子文件夹中。我正在使用以下方法遍历文件：

```
foreach (string file in Directory.EnumerateFiles(data_path, "*.*", SearchOption.AllDirectories)) 
```

我是否应该期望使用嵌套构造对枚举集进行分区：

```
foreach (string year_folder in Directory.EnumerateDirectories(data_path))
    foreach (string month_folder in Directory.EnumerateDirectories(year_folder))
        foreach (string file in Directory.EnumerateFiles(month_folder)) 
```

内存效率会更高吗？

另请参阅下面的评论。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T01:32:14.650

**你的稍微小一点**

您提出的解决方案将*稍微*提高内存效率，即使只是因为您可以硬编码以下事实，即恰好存在三个嵌套级别，前两个仅是目录，最后一个仅包含文件。

**他们的更一般**

另一方面，`Directory.EnumerateFiles()`必须为具有任意目录嵌套的一般情况实施解决方案（这将涉及其自己的内部堆栈以跟踪它在枚举中的位置）。

**任何一个都可以，这是权衡取舍**

您的实现将您的代码绑定到您当前的特定目录结构。我有点*喜欢*能够浏览您的 foreach 循环并可视化它期望在磁盘上找到的文件夹结构。

另一方面，如果您或您团队中的某个人想要更改目录布局，那将是一件麻烦事。如果更改目录结构的可能性极小，或者如果您*确实*更改了目录结构就可以简单地更新代码，那么使用您的方法似乎是安全的。

# javascript - 在 SlickGrid 的 dataView 的顶行添加一个新项目，如 JavaScript 的 unshift

> ID：10067923
> 
> 赞同：1
> 
> 时间：2012-04-09T01:13:21.867
> 
> 标签：javascript, slickgrid

我刚刚学会了如何向 SlickGrid 的 dataView 添加新条目；但是，每个条目都作为最后一行“推入”到网格中。

如何使新行出现在网格顶部？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-11T17:58:49.720

DataView.insertItem(insertBefore, item)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T21:54:56.203

DataView 使用一个 JS 数组来存储它的数据。因此，如果您生成一个新数组，或者按照您想要的顺序对其进行排序，SlickGrid 应该按照该顺序显示它。

```
data[0] = {id:id_0,...};
data[1] = {id:id_1,...};
.
.
.
dataView.setData(data); 
```

重新排序您的数据数组，更新您的 dataView，使网格无效并渲染，它应该可以工作。请记住，“id”字段必须是唯一的，dataView 才能正常工作。

希望有帮助！

# jquery - 如何在“拖动”功能处于活动状态时将 .gif 替换为 .jpg？

> ID：10067925
> 
> 赞同：0
> 
> 时间：2012-04-09T01:13:39.613
> 
> 标签：jquery, ipad, safari, gif, lag

我正在准备我的高级项目画廊，准备在本周末举办一场展览。

它针对 iPad 进行了优化。您应该能够用鼠标拖动框架和 gif。在 iPad 的情况下，它们也可以通过触摸来拖动。

然而，令人恼火的事情正在发生。

当我将网页导出到我的主屏幕上时，它变成了一个“本机”应用程序。即使拖动功能在 iPad 上的 Safari 和计算机上完美运行，在这种“应用程序”格式中，拖动也是滞后的。

由于某种原因，gif 中的帧变化无法跟上拖动的速度，这使得移动在 50% 的时间里非常滞后。有时它工作得很好，有时它非常缓慢。

所以。我希望有一些 jquery 脚本可以让我在 draggable() 脚本发生时用 .jpgs 切换 .gif 图像。

有任何想法吗？我擅长遵循指示，但可能需要

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T01:28:55.403

您可以使用 jquery 来切换图像的属性。我不确定可拖动功能是什么样的，但它应该具有某种活动状态，您可以将开关置于其中，并在它处于非活动状态时将其切换回来。[http://api.jquery.com/attr/](http://api.jquery.com/attr/)

$('#greatphoto').attr('src', 'yourphoto.jpg');

# javascript - 在画布中为图像着色？

> ID：10067927
> 
> 赞同：1
> 
> 时间：2012-04-09T01:14:07.873
> 
> 标签：javascript, canvas

我想知道是否有一种方法可以绘制图像但给它一个彩色效果。

如果您考虑游戏，当您想放置一个精灵但有一个对象挡住时，您尝试放置的对象通常会染上红色，表示它无法放置，这是我试图实现的目标。

我目前在这里用不透明度绘制它：

```
ctx.globalAlpha = 0.5                   
ctx.drawImage(image,abposx,abposy); 
```

这可以在没有图书馆的情况下实现吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T01:30:07.993

你可以在它上面画一个半透明的矩形。例如：

```
ctx.fillStyle = 'rgba(255, 0, 0, 0.5)'; // 1/2 opacity red
ctx.fillRect(0, 0, 30, 30); // Draw this over top of your image 
```

[这是一个演示。](http://jsfiddle.net/minitech/5TAuK/)

~~对于等距图像，您所要做的就是创建适当的路径。这是一个例子：~~

您可以将叠加层设置`globalCompositeOperation`为`source-atop`：

```
ctx.globalCompositeOperation = 'source-atop';
ctx.fillStyle = 'rgba(255, 0, 0, 0.5)'; // 1/2 opacity red
ctx.fillRect(0, 0, 30, 30); // Draw this over top of your image
ctx.globalCompositeOperation = 'source-over'; 
```

[这是一个演示。](http://jsfiddle.net/minitech/5TAuK/3/)但是，如果您尝试绘制的区域也有内容，您可能还必须使用阴影画布。

# actionscript-3 - 将未评估的变量作为参数传递

> ID：10067929
> 
> 赞同：0
> 
> 时间：2012-04-09T01:14:19.957
> 
> 标签：actionscript-3, function, variables, parameters

如何使用未评估（和/或可能未定义）的变量作为函数的参数？例如：

```
function myFun(a:int):void {
    a = 5;
} 
```

如果您熟悉 Mathematica，则相当于：

```
f[a_Integer]:=a=5
Attributes[f]={HoldAll}; 
```

核心思想是我想传递给函数的是变量名本身，而不是当前与变量名相关联的值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T03:07:18.100

你可以传递一个字符串。

```
private function my_fun(name:String):void {
    trace(this[name]);
} 
```

使用示例：

```
public class Main extends Sprite {

public var a:int = 5;
    ....
    public function Main():void {
            my_fun("a");
    } 
```

根据这些人的说法：如果它是一个类，则[在 as3 中获取变量名称的字符串表示形式，](https://stackoverflow.com/questions/8437580/get-string-representation-of-a-variable-name-in-as3)您可以获得它的名称。如果它是你不能的局部变量，原因可能与效率有关（名称在编译阶段丢失）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T13:33:32.660

解决问题的另一种方法是使用闭包来更改评估范围。

```
public class A {
    public static function myFun(setter:Function):void {
        setter(5);
    }
}

public class B {
    function someOtherFunction() {
        var val:Number;
        A.myFun(function(v:Number):void { val = v; });
        trace(val); // 5
    }
} 
```

我没有传递一个值，而是传递了一个绑定在调用范围内的函数，该函数在被调用方的范围内进行评估。

# git - 为什么 Git 拒绝我的 pull 仅仅是因为我在本地分支上有一个提交？

> ID：10067930
> 
> 赞同：14
> 
> 时间：2012-04-09T01:14:26.083
> 
> 标签：git

服务器上有一个 Git 存储库，我和我的同事都可以从中推送和拉取。只要我们在提交之前拉动它就可以正常工作。

但是，如果他已经推送到主分支，同时我已经进行了本地提交，当我尝试拉取时，我会得到：

```
! [rejected]        master    -> master  (non-fast-forward) 
```

但我知道不应该有冲突。

我解决它的方法是拉入一个新的临时分支，然后将其合并到我的主人中，如下所示：

```
% git pull origin master:temp
From ssh://example.com/home/my/remote/repo
 * [new branch]      master    -> temp
Already up-to-date.
% git merge temp
Already up-to-date.
% git push origin master:master 
```

请注意，Git 表现得好像我什么都没做，但实际上我已经动摇它提交了。

最近我意识到，与其试图“说服”Git 我可以拉动。我可以假装我还没有提交`git reset --soft HEAD^`，`git stash`然后在此之上进行拉取和提交。

什么可能导致这种奇怪的挑剔行为？

我能够在我的本地机器上重现这个问题。这是我所做的：

首先，我创建了第一个“本地”存储库并添加了一个文件。

```
% cd
% mkdir local-1
% cd local-1/
% mkdir website
% cd website/
% git init
Initialized empty Git repository in /Users/jason/local-1/website/.git/
% touch file
% git add .
% git commit -m 'added file'
[master (root-commit) 6d4b322] added file
 0 files changed, 0 insertions(+), 0 deletions(-)
 create mode 100644 file 
```

然后我创建了“远程”存储库。

```
% cd
% mkdir remote
% cd remote
% mkdir website.git
% cd website.git/
% git init --bare
Initialized empty Git repository in /Users/jason/remote/website.git/ 
```

然后我回到本地，创建一个 ref 并推送到远程。

```
% cd ~/local-1/website/
% git remote add web ~/remote/website.git
% git push web +master:refs/heads/master
Counting objects: 3, done.
Writing objects: 100% (3/3), 207 bytes, done.
Total 3 (delta 0), reused 0 (delta 0)
Unpacking objects: 100% (3/3), done.
To /Users/jason/remote/website.git
 * [new branch]      master -> master 
```

之后，我将遥控器克隆到第二个本地。

```
% cd
% mkdir local-2
% cd local-2
% git clone ~/remote/website.git
Cloning into website...
done. 
```

然后我从第二个本地创建了一个对远程的引用并推送（这是我认为我正在创建问题的地方）。

```
% cd website/
% git remote add web ~/remote/website.git
% git push web +master:refs/heads/master
Everything up-to-date 
```

然后我对 local-2 进行了更改，提交并推送。

```
% touch another
% git add .
% git commit -m 'added another'
[master be91180] added another
 0 files changed, 0 insertions(+), 0 deletions(-)
 create mode 100644 another
% git push web
Counting objects: 3, done.
Delta compression using up to 4 threads.
Compressing objects: 100% (2/2), done.
Writing objects: 100% (2/2), 238 bytes, done.
Total 2 (delta 0), reused 0 (delta 0)
Unpacking objects: 100% (2/2), done.
To /Users/jason/remote/website.git
   6d4b322..be91180  master -> master 
```

最后，我对 local-1 进行了不同的更改，提交并尝试推送。

```
% cd ~/local-1/website/
% touch something
% git add .
% git commit -m 'added something'
[master 3984529] added something
 0 files changed, 0 insertions(+), 0 deletions(-)
 create mode 100644 something
% git push web
To /Users/jason/remote/website.git
 ! [rejected]        master -> master (non-fast-forward)
error: failed to push some refs to '/Users/jason/remote/website.git'
To prevent you from losing history, non-fast-forward updates were rejected
Merge the remote changes (e.g. 'git pull') before pushing again.  See the
'Note about fast-forwards' section of 'git push --help' for details. 
```

爆破！拉一下怎么样？

```
% git pull web master:master
From /Users/jason/remote/website
 ! [rejected]        master     -> master  (non-fast-forward) 
```

好的，那么问题就来了。我如何解决它？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-04-18T06:05:49.907

您可能打算这样做：

```
git pull web master 
```

使用`master:master`正在尝试`master`在导致非快进错误的拉取阶段直接更新您的本地分支。

如果您在设置为跟踪的分支上，`web/master`那么您只需要`git pull web`并且这也将更新您的远程跟踪分支。

# android - Android 从数组列表中获取正确的值

> ID：10067934
> 
> 赞同：0
> 
> 时间：2012-04-09T01:15:18.067
> 
> 标签：android

好的，我会尽力描述这一点。

我有一个聊天应用程序，我正在发送一个接收公共频道列表的请求。我从服务器收到的字符串是：

```
RESP_PUBLICCHANNELLIST, channelID 1, channelName 1, channelID 2, channelName 2 
```

当我将此列表添加到我的 AlertDialog 时，它会将每个频道和频道 ID 显示为单独的频道。我只想在 AlertDialog 中使用频道名称，并在地图中使用频道 ID 并为其提供键值。这可能吗？

这是我当前遇到的问题的代码：

```
 public void ShowPublicChannelList(){

     String PublicChannelsPost = "";
     PublicChannelsPost = ExecuteCommand(_chatProtocol.ShowPublicChannelList());
     System.out.println("Public Channels: " + PublicChannelsPost);
     _publicChannels.add("New..");

     List <String> responseList = Arrays.asList(PublicChannelsPost.split(","));
        if (responseList.contains("RESP_PUBLICCHANNELLIST")){
            for (int i = 1; i < responseList.size(); i++) {
                _publicChannels.add(responseList.get(i));
                System.out.println("Channels: " + _publicChannels);
            }   
                SetPublicChannelList(_publicChannels);
                } 
```

任何帮助都会很棒！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T02:45:48.673

如果我正确理解您的问题，您不确定如何将服务器响应解析为通道 ID 和名称的映射？您可以简单地用两个步骤遍历您的分隔字符串列表，并将每一对填充到一个映射条目中。这确实假设通道 id 后面总是跟着一个通道名称（反之亦然：每个名称前面都有一个 id）。

```
if (responseList.contains("RESP_PUBLICCHANNELLIST")) {
    Map<String, String> channelMap = new HashMap<String, String>();
    for (int i=1; i<responseList.size(); i+=2) {
        if (i+1 >= responseList.size()) break; // this only happens if not every id has name
        channelMap.put(responseList.get(i), responseList.get(i+1));
    }

    // print values to check correct mapping
    for (Map.Entry<String, String> channel : channelMap.entrySet()) System.out.println(channel.getKey() + " | " +channel.getValue());
} 
```

如您所见，如果源列表的长度“意外”，我只是中断循环。您可能想要考虑实施更强大的东西，除非您绝对确定永远不会发生非法案件。

# c++ - 这个for循环的条件什么时候会变为假？

> ID：10067935
> 
> 赞同：1
> 
> 时间：2012-04-09T01:15:19.430
> 
> 标签：c++, logic

我正在研究我的 C++ 练习题，为即将到来的测试做准备，我正在努力解决我以前从未见过的 for 循环条件。

```
 for (int i = 0; s[i]; i++) 
```

从主发送的字符串`s`是`"Two roofs to fix"`

问题是 for 循环的条件何时会变为假？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-09T01:16:19.767

当字符串的终止零`'\0'`被命中时，循环条件变为假。（`if (0)`评估为假）

请注意：如果字符串不是以空值结尾的，这种形式的测试可能会等待发生错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T02:34:25.993

只是为了澄清@MitchWheat 的答案，如果用作条件的表达式仅指定一个值，例如`if (x)`，那么它本质上等同于`if (x != 0)`. 如果该值是一个指针类型，那么它等价于`if (x != NULL)`instead（尽管这并不是真正的“instead”，因为 NULL == 0）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T02:40:43.450

```
#include<iostream>
#include<string>

using namespace std;

int main()
{
    string s = "Two roofs to fix";
    int i;
    for (i = 0; s[i]; i++);
    cout<<"i = "<<i<<endl;
} 
```

我用上面的代码测试了这个问题。它返回错误“字符串下标超出范围”。因此，如果字符串 s 的长度是 Len，则 s[Len] 是非法的。在您的代码中， s 不是指针 char*，而是一个字符串。所以这样编码是不合适的。

# ios - iOS - ASIHTTPRequest - 试图通过 responseString 解析

> ID：10067936
> 
> 赞同：0
> 
> 时间：2012-04-09T01:15:20.437
> 
> 标签：ios, asihttprequest

我花了大约 16 个小时研究和尝试不同的代码更改，但无法弄清楚这一点。我有一个使用 ASIHTTPrequest 使用网站的 iOS 应用程序：

```
-(void)refresh{
    NSURL *url = [NSURL URLWithString@"http://undignified.podbean.com/"];
    ASIHTTPRequest *request = [ASIHTTPRequest requestWithURL:url];
    [request startSynchronous];
    NSString *response = [request responseString];
    NSLog(@"%@",response];
 } 
```

上面的代码返回网站源代码并通过 NSLog 将其输出到控制台。我试图实现的目标是通过“responseString”搜索以 *.mp3 结尾的 URL，将它们加载到数组中，最后将 mp3 URL 加载到 UITableView 中。

总结一下：

1.  使用 ASIHTTPRequest 消费网站数据
2.  尝试在 responseString 中搜索具有 *.mp3 扩展名的所有链接并将它们加载到数组中。
3.  将解析后的链接添加到 UITableView。

我想在这个路口我已经尝试了太多的事情来做出任何合理的判断。任何朝着正确方向提出的建议或推动都将不胜感激。

以下是响应 (HTML) 的示例。请注意，这只是一个片段，因为整个 HTML 源代码相当大，但这包括 mp3 文件的一部分：

```
a href="http://undignified.podbean.com/mf/web/ih2x8r/UndignifiedShow01.mp3"         target="new"><img src="http://www.podbean.com/wp-content/plugins/podpress/images/audio_mp3_button.png" border="0" align="top" class="podPress_imgicon" alt="icon for podbean" /></a> &nbsp;Standard Podcasts [00:40:24m]: <a href="javascript:void(null);" onclick="podPressShowHidePlayerDiv('podPressPlayerSpace_2649518', 'mp3Player_2649518_0', '300:30', 'http://undignified.podbean.com/mf/play/ih2x8r/UndignifiedShow01.mp3'); return false;"><span id="podPressPlayerSpace_2649518_label_mp3Player_2649518_0">Play Now</span></a> | <a href="javascript:void(null);" onclick="window.open ('http://undignified.podbean.com/wp-content/plugins/podpress/podpress_backend.php?podPressPlayerAutoPlay=yes&amp;standalone=yes&amp;action=showplayer&amp;pbid=0&amp;b=458211&amp;id=2649518&amp;filename=http://undignified.podbean.com/mf/play/ih2x8r/UndignifiedShow01.mp3', 'podPressPlayer', 'toolbar=0,scrollbars=0,location=0,statusbar=0,menubar=0,resizable=1,width=660,height=360'); return false;">Play in Popup</a> | <a href="http://www.podbean.com/podcast-download?b=458211&f=http://undignified.podbean.com/mf/web/ih2x8r/UndignifiedShow01.mp3" target="26108">Download</a> | <a href="http://www.podbean.com/podcast-players?b=458211&p=2649518&f=http://undignified.podbean.com/mf/play/ih2x8r/UndignifiedShow01.mp3" target="38148">Embeddable Player</a> | <a>Hits (214)</a><br/ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T03:46:00.530

我真的不喜欢说“*不要那样做”的答案。*但是......不要那样做。

可以从您发布**的**`mp3`地址中提取 html 中指向 s 的所有链接。但这几乎总是错误的处理方式，本案也不例外。

本质上，您似乎正在尝试做的是创建一个播客客户端。您应该考虑一下其他人以前如何处理此类用例。通常，播客将有一个关联的`RSS`提要，它准确地概述了您正在寻找的数据，您的播客也不例外。如果一个人只是导航到您的问题中提供的链接，然后在页面周围寻找“ `subscribe to podcast`”或“ `RSS`”，他们会找到指向`RSS`提要的链接：`http://undignified.podbean.com/feed/`. 该地址指向`XML`包含`item`播客的 s 的地址。

与您的原始地址返回的文档不同，此文档是有效的，`XML`这意味着它可以使用`NSXMLParser`. `NSXMLParser`非常强大和灵活。但是上手有点困难。这是一个`NSXMLParser`子类的一些示例代码，它充当它自己的委托。

**UnDigParser.h**

```
#import <Foundation/Foundation.h>
@interface UnDigParser : NSXMLParser <NSXMLParserDelegate>
@property (readonly) NSArray *links;
@end 
```

**UnDigParser.m**

```
#import "UnDigParser.h"
@implementation UnDigParser{
    NSMutableArray *_links;
}
@synthesize links = _links;
-(void)parserDidStartDocument:(NSXMLParser *)parser{
    _links = [[NSMutableArray alloc] init];
}
-(void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName attributes:(NSDictionary *)attributeDict{
    if ([elementName isEqualToString:@"enclosure"]){
        NSString *link = [attributeDict objectForKey:@"url"];
        if (link){
            [_links addObject:link];
        }
    }
}
-(BOOL)parse{
    self.delegate = self;
    return [super parse];
}
@end 
```

可以像这样测试此代码：

```
dispatch_async(dispatch_get_global_queue(0, 0), ^{
    NSURL *url = [NSURL URLWithString:@"http://undignified.podbean.com/feed/"];
    // This is a sync call thus the background thread
    UnDigParser *parser = [[UnDigParser alloc] initWithContentsOfURL:url];
    [parser parse];
    NSLog(@"links:%@",parser.links);
}); 
```

记录的输出是：

```
links:(
    "http://undignified.podbean.com/mf/feed/cfdayc/UndignifiedShow03.mp3",
    "http://undignified.podbean.com/mf/feed/wbbpjw/UndignifiedShow02Final.mp3",
    "http://undignified.podbean.com/mf/feed/ih2x8r/UndignifiedShow01.mp3",
    "http://undignified.podbean.com/mf/feed/t4x54d/UndignifiedShow00.mp3"
) 
```

这应该足以让你开始。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T18:09:36.760

使用 requestDidReceiveResponseHeadersSelector 并从标题中获取文件名，尝试从 NSDictionary 标题中打印所有键和值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T13:51:42.260

我将分两步执行此操作：

1.  获取所有 href 值

2.  使用正则表达式检查以 .mp3 结尾的有效 url

顺便说一句，我认为 ASIHTTPRequest 已经过时了。如果你只用它来获取 HTML，我建议你查看 iOS 框架的内置方法来做到这一点。

# scroll - 一个用于整个 Dijit BorderContainer 的垂直滚动条

> ID：10067938
> 
> 赞同：0
> 
> 时间：2012-04-09T01:15:34.093
> 
> 标签：scroll, dojo, border-container

这是我的 HTML 正文的结构。

```
 <body class="claro">
<div id="BorderContainerMain" data-dojo-type="dijit.layout.BorderContainer" data-dojo-props="design:'headline'" style="width: 100%; border:0; padding:0; margin:0;">
    <div data-dojo-type="dijit.layout.ContentPane" data-dojo-props="region:'top'" style="border: 0;">
        <div id="topBanner" data-dojo-type="core.widget.GeneralMainHeader" ></div>
    </div>
    <div data-dojo-type="dijit.layout.ContentPane" data-dojo-props="region:'left'" style="border: 0;">
        <div id="leftNav" data-dojo-type="core.widget.GeneralLeftNavigation"></div>
    </div>
    <div id="contentStackContainer" data-dojo-type="dijit.layout.StackContainer" data-dojo-props="region:'center', style: 'border: 0; padding: 0; margin: 0;'"></div>
</div> 
```

现在，我的愿望是让整个屏幕根据中心区域的内容自动增加高度，并让视口处理垂直滚动。我对 dijit 布局相当陌生，我正在使用 DOJO 1.6。我已经知道我必须编写代码来实现这一点。因此，我正在尝试获得一些经验指导。

谢谢，里希

因此，我为我的目的编写了一个自定义调整大小，但它不起作用。有什么原因它不起作用。这是代码：

```
dojo.provide("core.widget.ClientBorderContainer");
dojo.require("dijit.layout.BorderContainer");
dojo.declare("core.widget.ClientBorderContainer", [dijit.layout.BorderContainer], {

totalHeight: 0,

_setupChild: function(/*dijit._Widget*/ child){
    // Override BorderContainer._setupChild().

    var region = child.region;
    console.debug("region :: "+region);
    if(region){
        this.inherited(arguments);

        dojo.addClass(child.domNode, this.baseClass+"Pane");

        var ltr = this.isLeftToRight();
        if(region == "leading"){ region = ltr ? "left" : "right"; }
        if(region == "trailing"){ region = ltr ? "right" : "left"; }

        // Create draggable splitter for resizing pane,
        // or alternately if splitter=false but BorderContainer.gutters=true then
        // insert dummy div just for spacing
        if(region != "center" && (child.splitter || this.gutters) && !child._splitterWidget){
            var _Splitter = dojo.getObject(child.splitter ? this._splitterClass : "dijit.layout._Gutter");
            var splitter = new _Splitter({
                id: child.id + "_splitter",
                container: this,
                child: child,
                region: region,
                live: this.liveSplitters
            });
            splitter.isSplitter = true;
            child._splitterWidget = splitter;

            dojo.place(splitter.domNode, child.domNode, "after");

            // Splitters aren't added as Contained children, so we need to call startup explicitly
            splitter.startup();
            console.debug("Should not be printed as there is no splitter");
        }
        child.region = region;  // TODO: technically wrong since it overwrites "trailing" with "left" etc.
    }
},

resize: function(newSize, currentSize){
    // Overrides BorderContainer.resize().

    // resetting potential padding to 0px to provide support for 100% width/height + padding
    // TODO: this hack doesn't respect the box model and is a temporary fix
    if(!this.cs || !this.pe){
        var node = this.domNode;
        this.cs = dojo.getComputedStyle(node);
        this.pe = dojo._getPadExtents(node, this.cs);
        this.pe.r = dojo._toPixelValue(node, this.cs.paddingRight);
        this.pe.b = dojo._toPixelValue(node, this.cs.paddingBottom);

        dojo.style(node, "padding", "0px");
    }

    //Following section calculates the desired height of the BorderContainer
    console.debug(this.id+" contentBox height ::: "+dojo.contentBox(this.domNode).h);
    this.totalHeight = 0;
    dojo.forEach(this.getChildren(), this.calculateHeight, this);
    console.debug("this.totalHeight ::: "+this.totalHeight);
    console.debug("newSize "+newSize);
    console.debug("currentSize "+currentSize);

    ////////////////////////////////////////////////
    // summary:
    //      Call this to resize a widget, or after its size has changed.
    // description:
    //      Change size mode:
    //          When changeSize is specified, changes the marginBox of this widget
    //          and forces it to relayout its contents accordingly.
    //          changeSize may specify height, width, or both.
    //
    //          If resultSize is specified it indicates the size the widget will
    //          become after changeSize has been applied.
    //
    //      Notification mode:
    //          When changeSize is null, indicates that the caller has already changed
    //          the size of the widget, or perhaps it changed because the browser
    //          window was resized.  Tells widget to relayout its contents accordingly.
    //
    //          If resultSize is also specified it indicates the size the widget has
    //          become.
    //
    //      In either mode, this method also:
    //          1\. Sets this._borderBox and this._contentBox to the new size of
    //              the widget.  Queries the current domNode size if necessary.
    //          2\. Calls layout() to resize contents (and maybe adjust child widgets).
    //
    // changeSize: Object?
    //      Sets the widget to this margin-box size and position.
    //      May include any/all of the following properties:
    //  |   {w: int, h: int, l: int, t: int}
    //
    // resultSize: Object?
    //      The margin-box size of this widget after applying changeSize (if
    //      changeSize is specified).  If caller knows this size and
    //      passes it in, we don't need to query the browser to get the size.
    //  |   {w: int, h: int}

    var node = this.domNode;

    // set margin box size, unless it wasn't specified, in which case use current size
    if(newSize){
        dojo.marginBox(node, newSize);

        // set offset of the node
        if(newSize.t){ node.style.top = newSize.t + "px"; }
        if(newSize.l){ node.style.left = newSize.l + "px"; }
    }

    // If either height or width wasn't specified by the user, then query node for it.
    // But note that setting the margin box and then immediately querying dimensions may return
    // inaccurate results, so try not to depend on it.
    var mb = currentSize || {};
    dojo.mixin(mb, {h: this.totalHeight}); // calculated height overrides currentSize
    if( !("h" in mb) || !("w" in mb) ){
        mb = dojo.mixin(dojo.marginBox(node), mb);  // just use dojo.marginBox() to fill in missing values
    }
    // Compute and save the size of my border box and content box
    // (w/out calling dojo.contentBox() since that may fail if size was recently set)
    var cs = dojo.getComputedStyle(node);
    var me = dojo._getMarginExtents(node, cs);
    var be = dojo._getBorderExtents(node, cs);
    console.debug("mb.w "+mb.w);
    console.debug("mb.h "+mb.h);
    var bb = (this._borderBox = {
        w: mb.w - (me.w + be.w),
        h: mb.h - (me.h + be.h)
    });
    var pe = dojo._getPadExtents(node, cs);
    console.debug("bb.w "+bb.w);
    console.debug("bb.h "+bb.h);
    this._contentBox = {
        l: dojo._toPixelValue(node, cs.paddingLeft),
        t: dojo._toPixelValue(node, cs.paddingTop),
        w: bb.w - pe.w,
        h: bb.h - pe.h
    };
    // Callback for widget to adjust size of its children
    this.layout();
    ///////////////////////////////////////////////
    console.debug(this.id+" contentBox height ::: "+dojo.contentBox(this.domNode).h);
},

calculateHeight: function(/*dijit._Widget*/ child){
    var region = child.region;
    console.debug("region :: "+region);
    if(region && (region == "top" || region == "center" || region == "bottom")){
        var childHeight = 0;
        if(child instanceof dijit.layout.StackContainer){
            console.debug("selectedChildWidget "+child.selectedChildWidget);
            if(child.selectedChildWidget)
                childHeight = dojo.contentBox(child.selectedChildWidget.domNode).h;
            else
                childHeight = dojo.contentBox(child.domNode).h;
        }else{
            childHeight = dojo.contentBox(child.domNode).h;
        }
        this.totalHeight = this.totalHeight+childHeight;
        console.debug("childHeight = "+childHeight+" child.declaredClass"+child.declaredClass);
    }
},

_layoutChildren: function(/*String?*/ changedChildId, /*Number?*/ changedChildSize){
    // summary:
    //      This is the main routine for setting size/position of each child.
    // description:
    //      With no arguments, measures the height of top/bottom panes, the width
    //      of left/right panes, and then sizes all panes accordingly.
    //
    //      With changedRegion specified (as "left", "top", "bottom", or "right"),
    //      it changes that region's width/height to changedRegionSize and
    //      then resizes other regions that were affected.
    // changedChildId:
    //      Id of the child which should be resized because splitter was dragged.
    // changedChildSize:
    //      The new width/height (in pixels) to make specified child

    if(!this._borderBox || !this._borderBox.h){
        // We are currently hidden, or we haven't been sized by our parent yet.
        // Abort.   Someone will resize us later.
        return;
    }
    console.debug("custom lay out children called");
    // Generate list of wrappers of my children in the order that I want layoutChildren()
    // to process them (i.e. from the outside to the inside)
    var wrappers = dojo.map(this.getChildren(), function(child, idx){
        return {
            pane: child,
            weight: [
                child.region == "center" ? Infinity : 0,
                child.layoutPriority,
                (this.design == "sidebar" ? 1 : -1) * (/top|bottom/.test(child.region) ? 1 : -1),
                idx
            ]
        };
    }, this);
    wrappers.sort(function(a, b){
        var aw = a.weight, bw = b.weight;
        for(var i=0; i<aw.length; i++){
            if(aw[i] != bw[i]){
                return aw[i] - bw[i];
            }
        }
        return 0;
    });

    // Make new list, combining the externally specified children with splitters and gutters
    var childrenAndSplitters = [];
    dojo.forEach(wrappers, function(wrapper){
        var pane = wrapper.pane;
        childrenAndSplitters.push(pane);
        if(pane._splitterWidget){
            childrenAndSplitters.push(pane._splitterWidget);
        }
    });

    // Compute the box in which to lay out my children
    console.debug("this._borderBox.h :: "+this._borderBox.h);
    var dim = {
        l: this.pe.l,
        t: this.pe.t,
        w: this._borderBox.w - this.pe.w,
        h: this._borderBox.h - this.pe.h
    };

    // Layout the children, possibly changing size due to a splitter drag
    dijit.layout.layoutChildren(this.domNode, dim, childrenAndSplitters,
        changedChildId, changedChildSize);
}    
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T02:22:20.120

BorderContainer 被编写为获取一个大小的盒子并根据剩余的内容计算中心，这与您尝试做的相反。AFAIK它不会支持这个。

# mysql - 如何在 MySQL 中将持续时间值存储为 TIME 数据类型？

> ID：10067939
> 
> 赞同：3
> 
> 时间：2012-04-09T01:15:51.723
> 
> 标签：mysql, sql, time, duration

我需要以分钟/秒为单位存储歌曲持续时间，我需要使用 TIME，但是在编写 INSERT 语句时如何引用某个持续时间？我在表中的数据类型已经是 TIME，我应该只是 STR_TO_DATE 字符串值“4:29”吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-09T01:31:09.283

首先，看看这里：[http ://dev.mysql.com/doc/refman/5.0/en/time.html](http://dev.mysql.com/doc/refman/5.0/en/time.html)

> 为 TIME 列分配缩写值时要小心。MySQL 将带有冒号的缩写 TIME 值解释为一天中的时间。也就是说，“11:12”表示“11:12:00”，而不是“00:11:12”。MySQL 使用最右边的两个数字表示秒（即，作为经过的时间而不是一天中的时间）的假设来解释不带冒号的缩写值。例如，您可能认为 '1112' 和 1112 表示 '11:12:00'（11 点后 12 分钟），但 MySQL 将它们解释为 '00:11:12'（11 分 12 秒） . 类似地，“12”和 12 被解释为“00:00:12”。

所以，如果你想插入一首持续时间 = 05:55 的歌曲，只需这样写：

```
insert into songs (duration) values('0555'); 
```

# oracle - Oracle Number 数据类型及其严格性

> ID：10067945
> 
> 赞同：1
> 
> 时间：2012-04-09T01:16:39.667
> 
> 标签：oracle

我对 oracle 很陌生，但我一直在课堂上学习它，最近我遇到了`number`数据类型。我已经阅读了有关比例和精度 (s,p) 的文档，但我仍然对该类型的正确使用不持肯定态度。

假设我想将百分比值存储为小数。小数点可以是 0 到 1 之间的任意值，并且小数点后最多可以有 3 个数字。

要存储的一些可能的小数可能包括：

```
.66
.553
1.00 
```

如果我要创建这个专栏`NUMBER(4,3)`，即使只有两个数字，它也会起作用吗？见下文

```
.22
.10
.35
etc... 
```

简而言之，数字类型是否要求满足 EXACT 大小？例如。NUMBER(4,3) 是否绝对要求插入的数据是 4 个数字，其中 3 个在小数点后？

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T01:27:22.587

列的数据类型限制了可以存储的值的范围。但是他们没有做任何事情来强制特定的长度或精度。

就像您可以在`VARCHAR2(100)`列中存储单个字符或 NULL 一样，您可以存储小于 3 位精度和小于 4 位小数位数的数字。例如，值 0 和 6.1 对于`NUMBER(4,3)`列都是完全有效的。如果您插入的值的精度位数过多，则该值将静默四舍五入到列定义中指定的精度。

```
SQL> create table foo (
  2    col1 number(4,3)
  3  );

Table created.

SQL> insert into foo values( 9.999 );

1 row created.

SQL> insert into foo values (0);

1 row created.

SQL> insert into foo values( 6.1 );

1 row created.

SQL> insert into foo values( 1.2345 );

1 row created.

SQL> select * from foo;

      COL1
----------
     9.999
         0
       6.1
     1.235 
```

# ios - iOS 等价于 Pulse 和 Wait for Threading

> ID：10067949
> 
> 赞同：0
> 
> 时间：2012-04-09T01:18:01.403
> 
> 标签：ios, multithreading

我正在寻找 iOS 中多线程的等效模式，因为 .NET 中有用于脉冲和等待的模式。本质上，我希望一个后台线程处于休眠状态，直到设置一个标志，这基本上“踢”线程进入行动。

它是 loop+thr​​ead.sleep() 的替代方案。该标志可以设置在与执行处理的实际后台线程不同的线程上。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T01:26:01.347

iOS 和 OS X 上提供了多种不同的混合搭配线程 API。您使用什么来创建线程？

最简单的建议是使用[Grand Central Dispatch (GCD) 信号量](https://developer.apple.com/library/ios/documentation/Performance/Reference/GCD_libdispatch_Ref/Reference/reference.html#//apple_ref/c/func/dispatch_semaphore_create)。

设置代码：

```
dispatch_semaphore_t semaphore = dispatch_semaphore_create(0);
// Then make sure your thread has access to this semaphore 
```

线程代码：

```
dispatch_semaphore_wait(semaphore, DISPATCH_TIME_FOREVER);
// Will block forever until the semaphore is triggered 
```

触发代码：

```
dispatch_semaphore_signal(semaphore); 
```

一个更好的建议：GCD 已经管理了自己的线程池，所以只需利用它而不是启动自己的线程。`dispatch_async`在后台线程中运行一些代码非常容易使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T01:41:02.897

我不熟悉 .NET 中的这种模式，但故意锁定线程通常是一个坏主意（除非该线程无法继续，但听起来您希望它在大部分时间或至少长时间等待时间）。

这对调度程序不利，对系统资源不利。

你可以使用 NSThread 的 +detachNewThreadSelector:... 方法来创建一个新线程。你可以使用各种想法来尝试管理你的逻辑，以便在一个地方创建和维护这样一个线程，比如 NSObject 的 -performSelectorOnMainThread:...

# spring - spring mvc3中的数据绑定，验证，异常

> ID：10067950
> 
> 赞同：1
> 
> 时间：2012-04-09T01:18:34.147
> 
> 标签：spring, spring-mvc

我用的是spring mvc3，发现有些概念搞糊涂了，做个总结，贴在这里。

1.  **数据绑定。**

如果我在操作中有一个 bean（即，命名为“Person”），那么在请求以下 url 时，我使用 struct2：

[http://localhost:8080/app/form?person.id=1&person.name=xxx&pet.name=yy](http://localhost:8080/app/form?person.id=1&person.name=xxx&pet.name=yy)

然后将创建一个新的 Person 实例，并将参数“1”和“xxx”填充到该实例中。并且将创建一个新的 Pet 实例，并将名称“yy”填充到此 bean。

这是 struct2 中数据绑定的唯一方法：您在请求中指定 beanname.property。

现在在 spring mvc3 中，我知道一种绑定数据的方法：

[http://localhost:8080/app/form?id=1&name=xxx&other=yy](http://localhost:8080/app/form?id=1&name=xxx&other=yy)

```
@RequestMapping('form')
public String form(Person person,BindingResult result){
    //now I get the person  
} 
```

即使它有效，但我有一些问题：

1）我在请求url“name”，'pass'，'other'中有三个参数，spring如何知道应该将哪些参数填充到我的bean（模型）中。

2) 如果我想将参数绑定到多个模型，如 struct2 中的示例（人和宠物），该怎么办？

此外，spring标签“form”中的`modelAttribute`and属性是什么意思？`commandName`

**2\. 验证**

对于 bean（忽略示例中的 getter 和 setter）：

```
import javax.validation.constraints.NotNull;

public class Bean {
    @NotNull(message="id can not be null")
    private int     id;
} 
```

我使用这个控制器：

```
@RequestMapping("val")
public @ResponseBody
String validate(@Valid Bean bean, BindingResult result) {
    if (result.hasErrors()) {
        return result.getAllErrors() + "";
    } else
        return "no error";
} 
```

我发现只有“NotEmpty”有效。因为如果我使用这个网址：

```
/val?name=xxx   ==> no error !! // id is null now,why it does not has error? 
```

**3.类型转换。**

以这个网址为例：

[http://localhost:8080/app/form?id=1&name=xxx&other=yy](http://localhost:8080/app/form?id=1&name=xxx&other=yy)

显然，如果我将 id 设置为字符串值，它会抛出“NumberFormatException”。

那么在哪里捕获这个异常呢？如果在控制器中，那么我必须在每个控制器中编写这么多的 try-catch 块。

此外，类型转换异常不仅限于'NumberFormatException'，还可能是'dataformaterrorexception'等。

但是它们都属于类型转换，使用通用解决方案如何处理？

# mysql - 为什么向这个 MySQL 查询添加特定的 where 子句会成为性能瓶颈？

> ID：10067954
> 
> 赞同：3
> 
> 时间：2012-04-09T01:19:22.973
> 
> 标签：mysql, sql, performance, optimization

抱歉篇幅太长，想给出完整的描述！我需要显示一份报告，其中显示有关另一个表中的 id 的一些信息，以及当有人在 x 天内从一个国家/地区更改国家/地区时。请注意我如何可以在表中多次输入相同的国家/地区条目（因为信息会定期查询多次，但在此期间它们可能没有移动），并且还可以有不同的国家/地区条目（因为它们改变国家）。

数据的快速解释：我有下表：

```
CREATE TABLE IF NOT EXISTS `country` (
`id` mediumint(8) unsigned NOT NULL,
`timestamp` datetime NOT NULL,
`country` varchar(64) DEFAULT NULL,
PRIMARY KEY (`id`,`timestamp`),
KEY `country` (`country`),
KEY `timestamp` (`timestamp`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8; 
```

条目是这样的：

```
41352   2012-03-26 15:46:01     Jamaica
41352   2012-03-05 22:49:41     Jamaican Applicant
41352   2012-02-26 15:46:01     Jamaica
41352   2012-02-16 12:11:19     Jamaica
41352   2012-02-05 23:00:30     Jamaican Applicant 
```

该表目前大约有大约 214,590 行，但一旦将测试数据替换为真实数据，就会有数百万行。

我想要的是关于从 y 时间离开 x 国家的每个人的一些信息。假设它是在上面的数据上运行的，我希望它是这样输出的：

```
id  name    last    country     TIMESTAMP   o_timestamp
41352 Sweet Mercy   Jamaica     2012-03-26 15:46:01     2012-03-05 22:49:41
41352 Sweet Mercy   Jamaica     2012-02-16 12:11:19     2012-02-05 23:00:30 
```

其中 o_timestamp 比某个日期（假设为 100）更新，国家是他们搬到的地方，他们来自的旧国家（未显示）是我传入查询的任何内容（牙买加申请人基于上述数据）。

我开发了以下查询来满足要求，并使用某个 id 进行测试：

```
SELECT a.id,
       c.name,
       c.last,
       a.country,
       a.timestamp,
       b.timestamp AS o_timestamp
FROM   country a
       INNER JOIN user_info c
         ON ( a.id = c.id )
       LEFT JOIN country AS b
         ON ( a.id = b.id
              AND a.timestamp != b.timestamp
              AND a.country != b.country )
WHERE  b.timestamp = (SELECT c.timestamp
                      FROM   country c
                      WHERE  a.id = c.id
                             AND a.timestamp > c.timestamp
                      ORDER  BY c.timestamp DESC
                      LIMIT  1) 
       AND a.id = 965 
```

我完成了这个（总共 7 个，查询耗时 0.0050 秒）

一个解释扩展揭示了以下内容：

```
id  select_type     table   type    possible_keys   key     key_len     ref     rows    filtered    Extra
1   PRIMARY     c   const   PRIMARY     PRIMARY     3   const   1   100.00  
1   PRIMARY     a   ref     PRIMARY     PRIMARY     3   const   16  100.00  
1   PRIMARY     b   eq_ref  PRIMARY,timestamp   PRIMARY     11  const,func  1   100.00  Using where
2   DEPENDENT SUBQUERY  c   index   PRIMARY,timestamp   timestamp   8   NULL    1   700.00  Using where; Using index 
```

所以我觉得我很好，然后突然出现：

```
SELECT a.id,
       c.name,
       c.last,
       a.country,
       a.timestamp,
       b.timestamp AS o_timestamp
FROM   country a
       INNER JOIN user_info c
         ON ( a.id = c.id )
       LEFT JOIN country AS b
         ON ( a.id = b.id
              AND a.timestamp != b.timestamp
              AND a.country != b.country )
WHERE  b.timestamp = (SELECT c.timestamp
                      FROM   country c
                      WHERE  a.id = c.id
                             AND a.timestamp > c.timestamp
                      ORDER  BY c.timestamp DESC
                      LIMIT  1) 
       AND b.country = "whatever" AND timestamp > DATE_SUB(NOW(), INTERVAL 7 DAY) 
```

在一个有 200 条记录但从未完成的国家（在下午和晚上外出之后，

回家总共大约 8 小时）对于一个在数据库中有 9000 条记录的国家/地区。在真实数据中，一个国家可能会轻松 10000 倍。100k不会不合理。

所以我确实解释了扩展，并得到了这个：

```
id  select_type     table   type    possible_keys   key     key_len     ref     rows    filtered    Extra
1   PRIMARY     <derived2>  ALL     NULL    NULL    NULL    NULL    3003    100.00  
1   PRIMARY     c   eq_ref  PRIMARY     PRIMARY     3   b.id    1   100.00  
1   PRIMARY     a   ref     PRIMARY     PRIMARY     3   b.id    7   100.00  Using where
3   DEPENDENT SUBQUERY  c   index   PRIMARY,timestamp   timestamp   8   NULL    1   700.00  Using where; Using index
2   DERIVED     country     range   country,timestamp   country     195     NULL    474     100.00  Using where; Using index 
```

所以它看起来更大，但并非不合理。

[删除了空间的配置变量，如果需要，请告诉我以及性能信息，因为它可能是一个查询。]

如果我错过了什么，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T02:20:07.673

问题不在于添加标准；它正在掉一个造成伤害的东西。在原始查询中，您有：

```
AND a.id = 965 
```

这意味着查询执行不需要读取整个`a`( `country`) 表。在您的第二个性能被杀死的查询中，您将该标准更改为：

```
AND b.country = "whatever"
AND timestamp > DATE_SUB(NOW(), INTERVAL 7 DAY) 
```

你不再有一个真正限制性的标准`a`，所以事情的工作速度要慢得多。

当意识到这`b`是对`country`. 然而，从一个条件到`a`到`b`（其中`b`在外连接的外侧）的变化并不是微不足道的。处理查询条件需要更长的时间。

* * *

> 这是否意味着因为我不是在寻找特定的 ID，所以我不走运？

对于给定的查询结构，答案似乎是“是”，但我们可以说，给定的查询结构可能是次优的。

您的“处理一个 ID 时足够快”查询是：

```
SELECT a.id,
       c.name,
       c.last,
       a.country,
       a.timestamp,
       b.timestamp AS o_timestamp
FROM   country a
       INNER JOIN user_info c
         ON ( a.id = c.id )
       LEFT JOIN country AS b
         ON ( a.id = b.id
              AND a.timestamp != b.timestamp
              AND a.country != b.country )
WHERE  b.timestamp = (SELECT c.timestamp
                      FROM   country c
                      WHERE  a.id = c.id
                             AND a.timestamp > c.timestamp
                      ORDER  BY c.timestamp DESC
                      LIMIT  1) 
       AND a.id = 965 
```

我不完全理解这个查询以及它试图做什么。您需要注意外连接比内连接更昂贵，外连接表上的条件如

```
b.timestamp = (...correlated sub-query...) 
```

非常昂贵。`b`一个问题是在包括 的列中可能有一个 NULL `timestamp`，但是子查询被浪费了，因为除非值不为空，否则条件不会得到满足，所以我们最终想知道“为什么要使用外部连接” ?

添加修改后的条件时，您应该收到“不明确的列名”错误，因为该时间戳可能来自`a`或`c`。此外，条件是另一种仅在值不为空`b.country = "whatever"`时才有意义的条件，因此，OUTER 连接也是可疑的。`b`

据我了解，该`country`表包含有关谁进入哪个国家以及何时进入的记录。另外，FWIW，我可以肯定的是，与`user_info`表的连接是一个可以忽略不计的性能问题；问题全部归结为对`country`表的三个引用。

* * *

从一些澄清来看，您可以逐步建立查询，也许是这样的。

1.  查找每对相同的国家记录，`id`其中记录按时间顺序相邻，其中较旧的记录用于给定国家（“牙买加申请人”），较新的记录用于不同的国家。

    最简单的部分是：

    ```
    SELECT a.id, a.country, a.timestamp, b.country, b.timestamp
      FROM country AS a
      JOIN country AS b
        ON a.id = b.id
       AND b.timestamp > a.timestamp
       AND a.country = 'Jamaica Applicant'
       AND b.country != a.country 
    ```

    这完成了大部分工作，但不能确保条目的邻接性。为此，我们必须坚持在两个`country`时间戳`id` 之间（但不包括）`a.timestamp`和`b.timestamp`. 这是一个额外的 NOT EXISTS 条件：

    ```
    SELECT a.id,
           a.country   AS o_country,
           a.timestamp AS o_timestamp,
           b.country   AS n_country,
           b.timestamp AS n_timestamp
      FROM country AS a
      JOIN country AS b
        ON a.id = b.id
       AND b.timestamp > a.timestamp
       AND a.country = 'Jamaica Applicant'
       AND b.country != a.country
     WHERE NOT EXISTS
           (SELECT *
              FROM country AS c
             WHERE c.timestamp > a.timestamp
               AND c.timestamp < b.timestamp
               AND c.id = a.id
           ) 
    ```

    请注意，BETWEEN AND 表示法不适用。它包括范围内的端点，但我们明确需要排除端点。

2.  鉴于上面的国家条目列表，我们现在只需要选择... 嗯，标准是什么？我认为您可以选择，但结果可以很容易地与`user_info`表格连接：

    ```
    SELECT e.id, u.name, u.last, e.o_country, e.o_timestamp, e.n_country, e_n_timestamp
      FROM (SELECT a.id,
                   a.country   AS o_country,
                   a.timestamp AS o_timestamp,
                   b.country   AS n_country,
                   b.timestamp AS n_timestamp
              FROM country AS a
              JOIN country AS b
                ON a.id = b.id
               AND b.timestamp > a.timestamp
               AND a.country = 'Jamaica Applicant'
               AND b.country != a.country
             WHERE NOT EXISTS
                   (SELECT *
                      FROM country AS c
                     WHERE c.timestamp > a.timestamp
                       AND c.timestamp < b.timestamp
                       AND c.id = a.id
                   )
           ) AS e
      JOIN user_info AS u ON e.id = u.id
     WHERE e.o_timestamp > DATE_SUB(NOW(), INTERVAL 7 DAY); 
    ```

我不打算保证性能会更好（或者甚至它在语法上是正确的；它还没有通过 SQL DBMS）。但我认为获取相邻日期的复杂查询结构比原始代码更简洁，性能可能更好。请特别注意，它不使用任何外连接、（显式）排序或限制子句。那应该有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T02:33:26.320

你应该检查这个参考：[http ://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_now](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_now)

和[http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date-add](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date-add)

它说的是 NOW() 函数可以返回一个字符串（取决于上下文），而 date_add 可以返回一个字符串（取决于参数）。我的猜测是，您正在获取字符串，然后仅在比较时转换为日期（这发生在每条记录上）。您可以尝试 AND 时间戳 > cast(DATE_SUB(NOW(), INTERVAL 7 DAY) as datetime)，这可能会提高性能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T02:57:21.537

我不建议将其作为一个完成的解决方案，但这是我将回到的开始。请让我知道这对您的测试数据集的执行情况 -

```
SELECT ui.*, c1.*, MAX(c2.timestamp)
FROM country c1
INNER JOIN user_info ui
    ON c1.id = ui.id
INNER JOIN country c2
    ON c1.id = c2.id
    AND c1.timestamp > c2.timestamp
    AND c1.country <> c2.country
WHERE c2.timestamp > DATE_SUB(NOW(), INTERVAL 7 DAY)
AND c2.country = 'somewhere'
GROUP BY c1.id 
```

下一步是添加一个 LEFT JOIN 以确保两者之间没有其他记录 -

```
SELECT ui.*, c1.*, c2.timestamp
FROM country c1
INNER JOIN user_info ui
    ON c1.id = ui.id
INNER JOIN country c2
    ON c1.id = c2.id
    AND c1.timestamp > c2.timestamp
    AND c1.country <> c2.country

LEFT JOIN country c3
    ON c1.id = c3.id
    AND c1.timetsamp > c3.timestamp
    AND c2.timestamp < c2.timetsamp

WHERE c2.timestamp > DATE_SUB(NOW(), INTERVAL 7 DAY)
AND c2.country = 'somewhere'
AND c3.id IS NULL 
```

# flash - 如何从 AIR 调用 AppleScript 进程？

> ID：10067955
> 
> 赞同：0
> 
> 时间：2012-04-09T01:19:24.767
> 
> 标签：flash, apache-flex, air, applescript

如何从 AIR 本机进程调用 AppleScript 进程？

背景：我创建了一个 script.scpt 文件并将其放在项目的根 src 目录中。

我遇到了这个错误：

```
Error: Error #3219: The NativeProcess could not be started. 'launch path not accessible' 
```

是）我有的：

```
var nativeProcessStartupInfo:NativeProcessStartupInfo = new NativeProcessStartupInfo();
var file:File = File.applicationDirectory.resolvePath("MyScript.scpt");
var processArgs:Vector.<String>;

nativeProcessStartupInfo.executable = file;
nativeProcessStartupInfo.workingDirectory = File.applicationDirectory;

processArgs = new Vector.<String>();
processArgs[0] = "foo";

nativeProcessStartupInfo.arguments = processArgs;

process = new NativeProcess();
process.start(nativeProcessStartupInfo); 
```

**解决**
了为了让它工作，我需要“osascript”的绝对路径，这是运行脚本的命令。在这种情况下，可以在（以及大量其他好东西）
Macintosh HardDrive > usr > bin > osascript中找到该命令

注意：“usr”目录是隐藏的。路径是“/usr/bin/osascript”

```
var file:File = File.applicationDirectory.resolvePath("/usr/bin/osascript"); 
```

之后，我将脚本文件名作为参数传递。它还需要将工作目录设置为脚本的目录，否则您会得到：

```
 ERROR - osascript: script.scpt: No such file or directory 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T17:03:11.413

答案添加到原帖。

# ruby-on-rails - Rails 和 Rspec - 不能批量分配受保护的属性

> ID：10067958
> 
> 赞同：0
> 
> 时间：2012-04-09T01:19:49.213
> 
> 标签：ruby-on-rails, rspec

我正在使用 rspec 创建一个带有 TDD 的 Rails 应用程序。我收到一个无法删除的错误：

```
Failure/Error: invalid_user = User.new(@attr.merge("provider" => ""))
 ActiveModel::MassAssignmentSecurity::Error:
   Can't mass-assign protected attributes: uid, info 
```

这是我的用户规格：

`user_spec.rb`

```
require 'spec_helper'

describe User do
  before(:each) do
  @attr = {"provider" => "providerexample", "uid" => "uidexample", "info" => {"name" =>     "Example"}}
 end

it "should create a new instance given valid attributes" do
  user = User.create_with_omniauth(@attr)
end

it "should require a provider" do
  invalid_user = User.new(@attr.merge("provider" => ""))
  invalid_user.should_not be_valid
end 

it "should require a uid" do
  invalid_user = User.new(@attr.merge("uid" => ""))
  invalid_user.should_not be_valid
end
end 
```

和我的`user.rb`

```
class User < ActiveRecord::Base
  attr_accessible :name, :credits, :email, :provider

  validates :name, :provider, :uid, :presence => true

  def self.create_with_omniauth(auth)
    create! do |user|
    user.provider = auth["provider"]
    user.uid      = auth["uid"]
    user.name     = auth["info"]["name"]
  end
 end 
```

结尾

`mass-assign`如果我通过添加`uid`和`info`来调试错误`attr_accessible`，我仍然会收到以下错误`unknown attribute: info`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T02:04:28.193

如果你将你作为@attr 的内容与信息合并，那么它会存在于 create_with_omniauth 调用中，但不是常规的 create 方法。

```
describe User do
  let(:user_attributes) { {"provider" => "providerexample", "uid" => "uidexample"} }

  it "should create a new instance given valid attributes" do
    expect {
      User.create_with_omniauth(user_attributes.merge({"info" => {"name" => "example"}))
    }.to not_raise_error
  end
end 
```

# php - 通过后台 URL 链接发送 php 变量

> ID：10067961
> 
> 赞同：1
> 
> 时间：2012-04-09T01:21:47.493
> 
> 标签：php, html

我想要一个显示用户位置的谷歌地图作为 div 的背景。

我告诉我使用我的 MAXMIND Geo-ip 安装`<? echo $_SERVER["GEOIP_CITY"];?>,<? echo $_SERVER["GEOIP_COUNTRY_NAME"];?>`来显示“美国旧金山”。

所以，我正在使用以下代码，但它不起作用。

```
<div id="main-body-map" style="background-image:url(http://maps.googleapis.com/maps/api/staticmap?center=<?php echo$_SERVER["GEOIP_CITY"];?>,<? echo $_SERVER["GEOIP_COUNTRY_NAME"];?>&zoom=14&size=245x252&sensor=false);background-repeat: no-repeat;background-position:center center;"> 
```

我不确定是否需要设置每个 $_SERVER[""]; 作为像 $city 这样的变量？如果您只是在谷歌地图链接中输入城市、国家/地区，它会正确显示地图。例如

[http://maps.googleapis.com/maps/api/staticmap?center=Seattle,USA&zoom=14&size=245x252&sensor=false](http://maps.googleapis.com/maps/api/staticmap?center=Seattle,USA&zoom=14&size=245x252&sensor=false)

另外，使用 IP 来提高准确性会更好吗？我还可以访问 IP 地址查找变量。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T04:03:40.167

使用 goolge maps api 不是很熟悉，但尝试：

```
<?php 
```

$url = "http://maps.googleapis.com/maps/api/staticmap?center=".$_SERVER["GEOIP_CITY"].$_SERVER["GEOIP_COUNTRY_NAME"]."&zoom=14&size=245x252&sensor=false"; ?>

```
<div id="main-body-map" style="background-image:url(<?php echo $url; ?>);background-repeat: no-repeat;background-position:center center;"> 
```

# java - 在java中循环使用数组

> ID：10067962
> 
> 赞同：0
> 
> 时间：2012-04-09T01:22:22.173
> 
> 标签：java, arrays, loops

我正在尝试使用主要是数组来编写此代码。我试图在每个问题之后显示“正确”或“不正确”，并在最后得到正确/不正确的答案。目标是使用数组来完成此任务，但我不知道如何使用数组在每个问题后显示正确/错误。

```
//Declarations
String rightAnswer[] = { "B", "C", "A" };
String userAnswer[] = new String [3];
String answer;
int counter;
int finalInt = 3;
int index = 0;
int correct = 0;
int incorrect = 0;

// detailedLoop
for(index = 0; index < finalInt; index++) {
    do {
        answer = JOptionPane.showInputDialog("What planet has the largest rings? \n\nA. Neptune \nB. Saturn \nC. Jupiter");
        userAnswer[index] = answer;
    } while(!(answer.equals("A")|| answer.equals("B") || answer.equals("C")));

    index++;
    do {    
        answer = JOptionPane.showInputDialog("What planet has a large redspot? \n\nA. Neptune \nB. Saturn \nC. Jupiter");
        userAnswer[index] = answer; 
    } while(!(answer.equals("A")|| answer.equals("B") || answer.equals("C")));

    index++;
    do {
        answer = JOptionPane.showInputDialog("What planet is farthest from the sun? \n\nA. Neptune \nB. Saturn \nC. Jupiter");
        userAnswer[index] = answer;
    } while(!(answer.equals("A")|| answer.equals("B") || answer.equals("C")));

    if(userAnswer[index].equals(rightAnswer[index])) {
        System.out.println("Correct!");
        correct++;
        index++;
    }
    if(!(userAnswer[index].equals(rightAnswer[index]))) {
        System.out.println("Incorrect. The right answer is " + rightAnswer[index] + ".");
        incorrect++;
        index++;
    }
}
System.out.println("Total correct:" + correct + ". Total incorrect: " + incorrect + "."); 
```

任何帮助表示赞赏，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T01:31:15.497

在遍历收到的答案之前，您永远不会将索引值重置为 0。因此，我相信您的程序正在尝试访问不存在的数组点，例如 3,4,5，因为您为仅 3 个字符串创建了一个数组

1 对您的程序进行修改以使其更加用户友好且更易于调试，这也是接受小写字母的答案。

此外，该程序不会告诉用户他们告诉他们的哪个问题是错误的或正确的，如果更改可以帮助您理解程序中的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T01:42:50.853

本节：

```
if(userAnswer[index].equals(rightAnswer[index]))
    {
    System.out.println("Correct!");
    correct++;
    index++;
    }
if(!(userAnswer[index].equals(rightAnswer[index])))
    {
    System.out.println("Incorrect. The right answer is " + rightAnswer[index] + ".");
    incorrect++;
    index++;
    } 
```

需要处于某种 for 循环中。从*技术上讲*，它在 for 循环中，但是您正在增加`index`自己，因此它在 for 循环中*无效*。

如果您执行以下操作，它应该可以工作：

```
int correct = 0;
int incorrect = 0;
for(i = 0; i < 3; i++) {
  if(userAnswer[i].equals(rightAnswer[i])) {
      System.out.println("Correct!");
      correct++;
    }   

  if(!(userAnswer[i].equals(rightAnswer[i]))) {
      System.out.println("Incorrect. The right answer is " + rightAnswer[i] + ".");
      incorrect++;
    }   
} 
```

***编辑***

此外，作为一般规则，您不应该在 for 循环中增加计数器变量。for循环已经做到了。请注意我没有`i`在我的代码中增加自己。每次执行for循环时，`i`都会在`i < 3`评估之前递增。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T01:45:45.560

似乎您在收集用户答案后没有重置索引，因此在您到达验证答案索引的块时，索引已经为 2，因此验证您的答案的代码仅检查数组的最后一个元素。基本上发生的事情是这样的：

*   开始循环（索引从 0 开始）
*   得到你的第一个答案（索引现在等于 1）
*   得到你的第二个答案（索引现在等于 2）
*   得到你的第三个答案（索引仍然等于 2）
*   index 的输出结果（index 还是 2，所以只处理最后一个答案）
*   递增索引，返回循环开始（索引变为 3，终止循环）

循环的目的是遍历数组的索引，但每次收集答案后手动递增索引会导致意外行为。简单的解决方法是将测试您的答案的代码分成自己的循环，这样您就可以重新开始索引。如果这不能帮助您解决问题，我将在答案中添加代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-09T01:53:43.410

这可能是你想要做的，再次，我不完全理解这个问题：

```
String questions[] = {
    "What planet has the largest rings? \n\nA. Neptune \nB. Saturn \nC. Jupiter",
    "What planet has a large redspot? \n\nA. Neptune \nB. Saturn \nC. Jupiter",
    "What planet is farthest from the sun? \n\nA. Neptune \nB. Saturn \nC. Jupiter"
};
String rightAnswer[] = { "B", "C", "A" };
String answer = null; // the user's answer
for (int i = 0; i < questions.length; i++) {
    do {
        answer = JOptionPane.showInputDialog(questions[i]);
    } while (!(answer.equals("A")|| answer.equals("B") || answer.equals("C")));
    String x = (answer.equals(rightAnswer[i])) ? "correct" : "incorrect.\nThe correct answer was " + rightAnswer[i];
    JOptionPane.showMessageDialog(null, "Your answer was " + x + ".");
} 
```

请原谅我的风格。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-09T02:16:17.077

我相信大多数早期的海报都回答了你并勾勒出（在其他答案中）类似的东西。自从我点击后，我就发布这个。

```
public class AstroQuiz {

    final public void run () {
        String[] questions = {
            "What planet has the largest rings? \n\nA. Neptune \nB. Saturn \nC. Jupiter",
            "What planet has a large redspot? \n\nA. Neptune \nB. Saturn \nC. Jupiter",
            "What planet is farthest from the sun? \n\nA. Neptune \nB. Saturn \nC. Jupiter"
        }
        String rightAnswers[] = { "B", "C", "A" };
        String validChoices[] = {"A", "B", "C"}

        int i = 0;
        int correct = 0;
        for (String question : questions) {
            String choice = askQuestionAndGetAnswer(question, validChoices);
            if(isCorrectAnswer(rightAnswers, i, choice)) {
                correct++;
                /* display "you got it!" here .. */
            } else {
                /* display "wrong answer!" here ... */
            }
            i++
        }
        System.out.format("Total correct:%d. Total incorrect: %d.\n", correct, questions.length - correct;)
    }

    final private String askQuestionAndGetAnswer(String question, String[] validAnswers) {
        String answer = null;
        boolean haveValidResponse = false;
        while (!haveValidResponse){
            answer = JOptionPane.showInputDialog(question);
            haveValidResponse = isValidResponse(answer, validAnswers)
        }
        return answer;
    }

    final private boolean isValidResponse(String response, String[] validAnswers) {
        for (String s : validAnswers) {
            if(response.equals(s))
                return true;
        }
        return false;
    }

    final private boolean isCorrectAnswer (String[] correctionAnswers, int questionIndex, String answer) {
        return correctionAnswers[questionIndex].equals(answer);     
    }
} 
```

# javascript - 找到一个正则表达式来检查字母，汉字和斜杠（/）

> ID：10067963
> 
> 赞同：1
> 
> 时间：2012-04-09T01:22:58.323
> 
> 标签：javascript, regex, expression

我想检查用户输入姓名时的输入值，如果他输入的是英文姓名，则姓名只包含字母，必须用斜杠（/）分隔，例如： `GeorgeBush, George Bush,GeorgeBush/, dsfsdf/`是错误的；`George/Bush, fdfd/fdfd/sds`是对的。我找到了这样的正则表达式：`/^[a-zA-Z\u4E00-\u9FA5\/]{1,20}/`。但它无法检查`fsfd/`或`/fdsf`。请给我一些建议。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T01:40:19.793

不清楚你想要什么，也许是这样：

```
^(?=.{1,20}$)[a-zA-Z\u4E00-\u9FA5]+(?:\/[a-zA-Z\u4E00-\u9FA5]+)?$ 
```

# php - Facebook PHP SDK - 'next' 参数与 getLogoutUrl 一起使用，但不与 getLoginURL() 一起使用

> ID：10067967
> 
> 赞同：1
> 
> 时间：2012-04-09T01:23:56.233
> 
> 标签：php, facebook, redirect, login, sdk

'next' 参数与 getLogoutUrl() 一起使用，但不与 getLoginUrl() 一起使用，我做错了什么？

```
getLogoutUrl(array('next' => site_url()))

getLoginUrl(array('next' => site_url(), 'scope' => 'email')) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T04:50:44.230

应该是 loginurl 的 redirect_uri：

```
 $params = array(
  scope => 'your_permissions_here',
  redirect_uri => 'Redirect_URL' //user will be redirected to this URL on both success or failure
);
  $loginUrl = $facebook->getLoginUrl($params); 
```

# python - int 对象不可迭代？

> ID：10067976
> 
> 赞同：-3
> 
> 时间：2012-04-09T01:24:41.860
> 
> 标签：python, typeerror

该程序确实会迭代，但只会迭代到某一行代码。然后它开始将开始和停止变量读取为 7 和 9 之类的东西？！？！我不明白这里有什么问题。更奇怪的是，它从 7,9 跳到 48, 51（开始、停止值）。这是代码的主要部分：http: [//pastebin.com/S0FZ3Jk7](http://pastebin.com/S0FZ3Jk7) ，这是我使用的数据：http: [//pastebin.com/rchNJGBq](http://pastebin.com/rchNJGBq)

```
"""
Qualifiers_2.py

"""

#from Qualifier_classes import Qualifier

file_path = 'C:\\Users\\Neo\\My Documents\\Python Scripts\\FTC Scouting\\sample.txt'
file = open(file_path, 'r')

Data = []
all_teams = []
Teams_list = []
keys = ['Team Number: ', 'Name: ','Qualifier: ']
qualifier_keys = ['Qualifier: ', 'QP: ', 'RP: ', 'HS: ', 'Matches: ']
team_attr = ['name','number']
UI_options = [1,2]

class Qualifier(object):
    def __init__(self):
        self.name           = 'Qualifier Name'
        self.rp             = 0
        self.qp             = 0
        self.hs             = 0
        self.num_of_matches = 0
        self.data = [self.name,self.rp,self.qp,self.hs,self.num_of_matches]
    def __repr__(self):
        self.data = [self.name,self.rp,self.qp,self.hs,self.num_of_matches]
        return repr((self.data))

class Team:    
    def __init__(self,name,number):
        self.name = name
        self.number = number

    def __repr__(self):
        return repr((self.name,self.number))    

def list_teams(n):
    tTeams = []
    for line in Data:
        check = line.find(keys[n])
        if not check == -1:
            team = line.partition(keys[n])[2]
            if team not in tTeams:
                tTeams.append(team)
    return tTeams

#@param:    team_number , team to find
#@output:   gives back line number in raw Data list
def find_start_team(team_number):
    tcount = 0

    if str(team_number) in list_teams(0):
        for line in Data:
            if not line.find(str(team_number)) == -1:
                return tcount
            else:
                tcount += 1
    else:
        return 'not a valid team number'

#@param:    Start_team_number , the previous team next number
#@output:   the line number for the start and end of the team's acquired info
def find_team(start_team_number):
    try:        
        start_search = find_start_team(start_team_number)
        tcount = start_search
        for line in Data[start_search+1:]:
            if not line.find(keys[0]) == -1:
                return start_search, tcount
            else:
                tcount += 1
    except ValueError:
        return 'not a team number'

def team_data(start,stop):
    temp_data = []
    for line in Data[start:stop]:
        temp_data.append(line)
    return temp_data

#@param: qualifier_key , the name of the category you wish to find
#@param: data , the qualifier info for some team
#@output: returns back the data for the category 
def get_data(qualifier_key, data):
    for line in data:
        if not line.find(qualifier_key) == -1:
            return line.partition(qualifier_key)[2]

#@param: data , the qualifier data for some team
#@output: remaining_data , the remaining data after the first qualifier
#               note: will return -1 if there is no more qualifiers
def just_qualifiers(data):
    tcount = 0
    for line in data:
        if not line.find(qualifier_keys[0]) == -1:
            return data[tcount:]
        tcount += 1
    return -1

#@param: data , array of values for a single qualifier
def update_qualifier(data):
    tqual = Qualifier()
    tqual.name = data[0]
    tqual.rp = data[1]
    tqual.hs = data[2]
    tqual.num_of_matches = tdata[3]
    return tqual

#@param: data , the block of data for the team
#@output: the qualifier data and remainind data
def get_qualifier(data):
    temp_data = []
    for key in range(len(qualifier_keys)):
        temp_data.append(get_data(qualifier_keys[key],data))
    temp_qual = update_qualifier(temp_data)
    data = data[len(temp_data):]
    return temp_qual, data

#Turns our txt file into usable data
for line in file:
    line = line[:-1]
    Data.append(line)

#Creates a tuple for holding the ID of all the teams
all_teams.append(list_teams(0))
all_teams.append(list_teams(1))

#Makes an organized list of the ID for all the teams in a 2-tuple
for team in range(len(list_teams(0))):
    Teams_list.append(Team(all_teams[1][team],int(all_teams[0][team])))

"""*******************
NEW CODE
*******************"""

Qualifiers = []

for team in range(len(all_teams[0])):
    start , stop = find_team((all_teams[0][team]))

    tdata = []
    tqual = []

    #maps the specific teams block of data to tdata
    for line in team_data(start, stop):
        tdata.append(line)
    tdata = just_qualifiers(tdata)
    while True:
        if not just_qualifiers(tdata) == -1:
            tqual , tdata = get_qualifier(tdata)
            Qualifiers.append(tqual)        
        else:
            break    

print Qualifiers

"""*******************
END NEW CODE
*******************"""

file.close() 
```

和我的追溯：

```
Traceback (most recent call last):
  File "C:/Users/Neo/Documents/Python Scripts/FTC Scouting/Qualifiers_3.py", line 152, in <module>
    if not just_qualifiers(tdata) == -1:
  File "C:/Users/Neo/Documents/Python Scripts/FTC Scouting/Qualifiers_3.py", line 96, in just_qualifiers
    for line in data:
TypeError: 'int' object is not iterable 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T03:09:18.583

我不打算审查你的整个程序来解决这个问题，但作为你的回溯的一部分，我确实一目了然：

```
def update_qualifier(data):
    tqual = Qualifier()
    tqual.name = data[0]
    tqual.rp = data[1]
    tqual.hs = data[2]
    tqual.num_of_matches = tdata[3]
    return tqual 
```

你的意思是在`tdata[3]`这里引用一个全局变量，而不是你的 local`data`吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T05:38:59.993

您的`just_qualifiers`方法返回一个列表或 -1（哎呀！为什么不是一个空列表？）。

您调用它一次，获取值 -1，将其分配给 tdata，然后立即调用`just_qualifiers`AGAIN（为什么？），如下所示：`if not just_qualifiers(tdata) == -1:`这等同于`if not just_qualifiers(-1) == -1:`导致函数内部观察到的错误 - 它正在尝试执行`for line in -1:`

我强烈建议您重写该函数，以便在没有限定符的情况下返回一个空列表。同上任何其他类似的功能。遍历空列表是非常安全的，即`for line in data:`如果为空，则不会优雅地执行任何操作`data`。如果您需要检查它是否为空，您可以简单地做`if data:`或`if not data:`根据需要。

# c++ - 将 GUI 添加到 c++ win32 控制台

> ID：10067978
> 
> 赞同：0
> 
> 时间：2012-04-09T01:25:05.477
> 
> 标签：c++, user-interface, console

我有一个现有的 C++ win32 控制台应用程序。此应用程序包含一个主程序，该程序实时连续处理来自硬件的一些数据，并具有一个服务器组件（线程）将数据流式传输到客户端。

我在想是否可以为用户创建一个 GUI，以便在运行此控制台程序之前输入一些程序参数。GUI 我打算只显示控制台程序的状态，例如。运行时，用户单击开始按钮后不需要用户交互。

有什么建议吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T01:37:46.893

当然，只需创建一个带有[窗口消息循环](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644928%28v=vs.85%29.aspx)的线程就可以了。这可能需要一个单独的线程来描述您所描述的内容，尽管可以设想其他方式，具体取决于您现有代码的确切细节。

反过来也是如此：GUI 应用程序也可以创建一个控制台并输出到它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T01:48:54.237

快速而肮脏的方式 - 在您希望的任何工具包中创建 GUI（例如 Qt、Gtk、Windows API...）并使用标准[系统（const char *）](http://www.cplusplus.com/reference/clibrary/cstdlib/system/)函数。

Nmap 是一个很棒的话题，因为存在[许多前端](http://en.wikipedia.org/wiki/Nmap#Graphical_interfaces)，所以你可能有兴趣深入研究源代码，看看它们是如何将前端变成控制台应用程序的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-09T02:04:20.067

控制台应用程序通常使用文本文件进行配置，这样它们就可以从批处理脚本运行而无需用户交互。可以使用参数指定配置文件。

一旦你有了这个，编写一个 GUI 配置编辑器和启动器就很简单了。监控程序可能最好制作成通知区域图标，当进程终止或控制台输出中出现某些内容时将报告该图标。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-27T19:44:39.153

我实现 GUI 进程的方式（不幸的是，当我没有考虑过包含 GUI 的设计时）是使用 posix 线程进程，一个运行应用程序的代码，一个用于 GUI，带有全局变量（hacky）由父进程（父进程运行两个子进程）以单向方式共享（以避免出现竞争条件），因此一个变量将为进程写入，为 GUI 读取，另一个变量将为过程，为 GUI 编写。

我不得不重新编写处理 coe 以使用忙等待（坏）来等待信息和状态更改以在每个忙等待循环之间跳跃。忙碌等待状态的改变并没有花费太多时间来实现。

这并不是真正的最佳方式（这很 hacky），应该从一开始就将 GUI 设计到代码中，而不是稍后“添加”。但这确实对我有用，而且 GUI 在最后一分钟的表现出奇地好。

# php - 将多个文件上传到 FTP 和 HTTP 链接到 MySQL 数据库的文件

> ID：10067979
> 
> 赞同：1
> 
> 时间：2012-04-09T01:25:25.713
> 
> 标签：php, jquery, mysql, file-upload

我在问如何将多个文件（使用 jquery.Multifile）上传到 FTP 并将文件链接到 MySQL 数据库？我已经有一个 HTML 表单，可以使用 PHP 将多个文件上传到我的 FTP。

假设我有两个表（这些表中还有其他字段，但将它们添加到我的问题中并不相关）：

**消息 -> 消息 ID(pk)、标题、日期、消息**

**文件 -> 文件 ID(pk)、消息 ID(fk)、文件链接**

当用户写消息时，他可以选择许多文件作为 jquery.Multifile 的附件。然后当用户发送消息时，文件被发送到 FTP，文件的 http 链接被发送到数据库。每个文件都应该有自己的 ID（fileID），并且这两个表使用字段 messageID 作为消息表中的主键和文件表中的外键链接在一起。

这就是我现在所拥有的，但我不知道如何做数据库部分：

HTML 表单：

```
<form name="uploader" action="file_upload2.php" method="post" enctype="multipart/form-data">
<fieldset>
    <label for="file">Upload file:</label>
    <br />
        <input type="file" class="multi, remove" name="file[]" value="Upload file" />
        <input type="submit" value="submit"/>
</fieldset> 
```

这是 PHP 部分（$filepath 是我试图在 FTP 中创建文件的链接）：

```
<?php
include('db.php');

mysql_connect("$hostname", "$username", "$password")or die("cannot connect"); 
mysql_select_db("$database")or die("cannot select DB");
mysql_query("SET names 'UTF8'");

$heading=$_POST['heading'];
$date=$_POST['date'];
$message=$_POST['message'];

$conn = ftp_connect("mysite.org") or die("Cannot connect");
ftp_login($conn,"username","password");
$uploaddir = 'httpdocs/folder1/folder2/files/';

foreach ($_FILES["file"]["error"] as $key => $error)
{
        if ($error == UPLOAD_ERR_OK)
        {
                $tmp_name = $_FILES["file"]["tmp_name"][$key];
                $name = $_FILES["file"]["name"][$key];
                $uploadfile = $uploaddir . basename($name);
                ftp_put($conn,$uploadfile,$tmp_name,FTP_BINARY);

            if (move_uploaded_file($tmp_name, $name))
            {
                    echo "Success: File ".$name." uploaded to server.<br/>";
            }
            else
            {
                    echo "Error: File ".$name." can not be uploaded to server.<br/>";
            }
    }
}

ftp_close($conn);

$filepath = "http://mysite.org/folder1/folder2/files/".$name;

$sql="INSERT INTO message(
heading, 
date, 
message)
VALUES
(
 '$heading',
 '$date',
 '$message')";

$result=mysql_query($sql);

if($result){
header("Location: ../index.php");

}
else {
    echo $sql . ("Adding message failed <br />" . mysql_error());
}
mysql_close();
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T06:08:35.743

尝试这个

```
<?php

include('db.php');

mysql_connect("$hostname", "$username", "$password")or die("cannot connect"); 
mysql_select_db("$database")or die("cannot select DB");
mysql_query("SET names 'UTF8'");

$heading=$_POST['heading'];
$date=$_POST['date'];
$message=$_POST['message'];

$conn = ftp_connect("mysite.org") or die("Cannot connect");
ftp_login($conn,"username","password");
$uploaddir = 'httpdocs/folder1/folder2/files/';

$sql="INSERT INTO message(messageid,heading, date, message) VALUES('Null' , '$heading', '$date', '$message')";
$result=mysql_query($sql);
$lastinsertid = mysql_insert_id($sql);

foreach ($_FILES["file"]["error"] as $key => $error)
{
        if ($error == UPLOAD_ERR_OK)
        {
                $tmp_name = $_FILES["file"]["tmp_name"][$key];
                $name = $_FILES["file"]["name"][$key];
                $uploadfile = $uploaddir . basename($name);
                ftp_put($conn,$uploadfile,$tmp_name,FTP_BINARY);

            if (move_uploaded_file($tmp_name, $name))
            {
                    echo "Success: File ".$name." uploaded to server.<br/>";
                    $filepath = "http://mysite.org/folder1/folder2/files/".$name;
                    $sql="INSERT INTO File (fileid, messageid, link) VALUES( Null, '$lastinsertid', '$filepath')";
                    $result=mysql_query($sql);

            }
            else
            {
                    echo "Error: File ".$name." can not be uploaded to server.<br/>";
            }
    }
}

ftp_close($conn);

if($result){
header("Location: ../index.php");

}
else {
    echo $sql . ("Adding message failed <br />" . mysql_error());
}
mysql_close();
?> 
```

# objective-c - 定义方法时，我在 Objective-C 中的语法有什么问题？

> ID：10067981
> 
> 赞同：0
> 
> 时间：2012-04-09T01:25:38.997
> 
> 标签：objective-c, cocoa, implementation

```
-(NSMutableArray *) forwardInterfaceList: (networkInterface *) i; 
```

我在“networkInterface”之前收到错误“Expected ')'”

整个实现部分在这里：

```
@interface device : NSObject{

    NSString *hostname;
    NSMutableArray *intList;
}

-(NSMutableArray *) forwardInterfaceList: (networkInterface *) i;
-(NSMutableArray *) intList;
@end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T01:37:07.427

您应该为您的类名使用大写字母...但除此之外，您可能在范围内没有名称，这将通过导入其声明或进行前向声明来修复...

```
@class NetworkInterface; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T01:29:16.707

请记住已声明`import`的标题。`networkInterface`

**例如**

```
#import "networkInterface.h" 
```

*在您文件的顶部。*

# android - 异步任务重置我的微调器

> ID：10067984
> 
> 赞同：0
> 
> 时间：2012-04-09T01:26:02.203
> 
> 标签：android, asynchronous, spinner

新手在这里。在贴代码之前，先简单说明一下。

1.  我有一个小应用程序，它通过 http 加载数据，将其存储在 SQL Lite 数据库中并显示它 - 设置两个微调器，一个带有名称，一个带有星期几。选择姓名和星期几的组合会显示指示该人当天正在做什么的文本。当组合为选择时，它使用 SharedPreferences 保存。这一切都很好。

2.  我在“刷新”按钮下设置了一个异步任务，以从服务器获取新数据。这会消失并获取数据，重新填充数据库并刷新显示。其中大部分工作正常，除了名称微调器始终重置为第一个条目，就好像它正在以某种方式重新初始化一样。

3.  在调试它时，一切正常，直到异步任务结束在 Looper 类中。我不确定这是做什么的，但看起来像是在清理，并且在那里的某个地方，微调器被重置。

4.  下面是异步任务，精简。

有任何想法吗？

```
private class GetDataAsyncTask extends AsyncTask<String, Void, String> {
    String response = "";
ProgressBar pb=(ProgressBar)findViewById(R.id.progressBar2);
Spinner spinner1 = (Spinner) findViewById( R.id.spinner1 );

    @Override
    protected void onPreExecute() {
        pb.setVisibility(View.VISIBLE);
        pb.setMax(100);
        super.onPreExecute();
    }
    @Override
    protected String doInBackground(String... mystring) {
        //get database
       response=get_data_from_PMS();
       Load_Arrays_with_stored_data();
       return response;
    }
    @Override
    protected void onPostExecute(String result) {
        // display new updated consultant list
        ArrayAdapter adapter_cons = new ArrayAdapter(whereisthatconsultantActivity.this,android.R.layout.simple_spinner_item, cons_spinner);
        spinner1.setAdapter(adapter_cons);
        adapter_cons.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
        //
       spinner1.setSelection(GetDisplayVal("selconspos"));

    //
    textView2.setText(display_stored_data());
    //
    pb.setVisibility(View.INVISIBLE);

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T02:41:55.367

不确定这是否会为您做这件事，但它可能与您在每次执行 onPostExecute 时创建一个新适配器这一事实有关。您可以将以下行从 onPostExecute 删除到其他地方（可能是 onCreate）：

```
ArrayAdapter adapter_cons = new ArrayAdapter(whereisthatconsultantActivity.this,android.R.layout.simple_spinner_item, cons_spinner);
spinner1.setAdapter(adapter_cons);
adapter_cons.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item); 
```

然后将您的 onPostExecute 更改为以下内容：

```
@Override
protected void onPostExecute(String result) {

   adapter_cons.notifyDataSetChanged();
   spinner1.setSelection(GetDisplayVal("selconspos"));
   textView2.setText(display_stored_data());
   pb.setVisibility(View.INVISIBLE);

} 
```

这应该会更新您的适配器，因为我很难从代码中确定您在 doInBackground() 中将新数据分配给您的适配器。每次更新适配器中的数据时，都必须调用 notifyDataSetChanged() 以使适配器更新。

希望有帮助！

# audio - NAudio Asio 和 ieeefloat 格式

> ID：10067988
> 
> 赞同：1
> 
> 时间：2012-04-09T01:26:54.183
> 
> 标签：audio, asio, pcm, naudio, trigonometry

我试图让[正弦波示例](http://mark-dot-net.blogspot.com/2009/10/playback-of-sine-wave-in-naudio.html)在 AsioOut 上运行，但它听起来更像是一个失真的方波。AsioOut 是否可能仅支持 PCM 格式？asio .wav 文件播放效果很好...

如果是这样，我怎样才能用 ieee 浮点数填充我的缓冲区并转换为 PCM？或者在 ASIO 上回馈 Ieee 的最佳方式是什么？我很想避免不必要的样本转换..

到目前为止，在我的代码中，我试图生成一个适合缓冲区大小的正弦波，以确保我有连续的值，我用采样率 44100 和 1 个通道对其进行初始化。然后我将类的一个实例传递给我的 AsioOut 的 Init()：

```
public class SineWaveProvider32 : IWaveProvider
{
    private WaveFormat waveFormat;
    public WaveFormat WaveFormat
    {
        get
        {
            return this.waveFormat;
        }
    }

    public SineWaveProvider32() : this(44100, 1)
    {
    }

    public SineWaveProvider32(int sampleRate, int channels)
    {
        this.SetWaveFormat(sampleRate, channels);
    }

    public void SetWaveFormat(int sampleRate, int channels)
    {
        this.waveFormat = WaveFormat.CreateIeeeFloatWaveFormat(sampleRate, channels);
    }

            public unsafe int Read(byte[] buffer, int offset, int count)
    {
        var samples = count/4;
        fixed(byte* buff = buffer)
        {
            for (int n = 0; n < samples; n++)
            {
                var num = (float)(Math.Sin( (2 * Math.PI * n)/ samples ));
                ((float*)buff)[n] = num;
            }
        }

        return count;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T02:13:07.033

好的，我发现了错误。Asio 在某种程度上是立体声设计。所以这段代码有效：

```
public class SineWaveProvider32 : IWaveProvider
{
    private WaveFormat waveFormat;
    public WaveFormat WaveFormat
    {
        get
        {
            return this.waveFormat;
        }
    }

    public SineWaveProvider32() : this(44100, 2)
    {
    }

    public SineWaveProvider32(int sampleRate, int channels)
    {
        this.SetWaveFormat(sampleRate, channels);
    }

    public void SetWaveFormat(int sampleRate, int channels)
    {
        this.waveFormat = WaveFormat.CreateIeeeFloatWaveFormat(sampleRate, channels);
    }

    public unsafe int Read(byte[] buffer, int offset, int count)
    {
        var samples = count/4;
        fixed(byte* buff = buffer)
        {
            for (int n = 0; n < samples; n+=2)
            {
                var num = (float)(Math.Sin( (2 * Math.PI * n * 3)/ samples ));
                ((float*)buff)[n] = 0;
                ((float*)buff)[n+1] = num;
            }
        }

        return count;
    }

} 
```

# iphone - 如何在 Xcode 4.3.1 上显示 nslog 输出内容

> ID：10067989
> 
> 赞同：0
> 
> 时间：2012-04-09T01:27:12.050
> 
> 标签：iphone

我刚刚升级到 Xcode 4.3.1

对于旧版本的Xcode，很容易显示nslog内容

但 Xcode 它显示

![在此处输入图像描述](../Images/4b4f3def34133ea413f0697471be5d80.png)

我更喜欢文本输出！可能吗？

欢迎任何评论

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-09T01:29:54.577

查看 - 调试 Aera - 激活控制台，或`Command+Shift+C`.

# iphone - 将表视图中的项目存储在数组中

> ID：10067997
> 
> 赞同：-1
> 
> 时间：2012-04-09T01:28:00.550
> 
> 标签：iphone

我目前有一个 iPhone 应用程序，其中设置了一个充满练习的表格视图。我想要做的是在单击这些练习后将它们存储在一个数组（或类似的东西）中，以便它们可以用来形成一个锻炼，可以在以后保存和访问？

我确实希望永久存储这些信息，所以我应该使用数据库吗？如果有人能指出我正确的方向，我将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T01:32:52.043

添加一个可变数组属性，在 tableView:didSelectRowAtIndexPath: 中添加 nsindexpath 的实例/从中删除它们，将数组序列化为 NSUserDefaults。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T07:28:09.603

@顶级厨师

是的，你当然可以使用 sqlite 数据库。下载 mozilla firefox 并下载 mozilla 的附加组件，然后您可以为您的应用程序创建数据库。现在，大多数开发人员都在使用数据库来满足此类需求。即使我也有相同的要求并使用这种技术。:-) 所以要开心..

# python - 类型错误：+ 不支持的操作数类型：尝试“打印”时的“int”和“str”

> ID：10067998
> 
> 赞同：0
> 
> 时间：2012-04-09T01:28:16.413
> 
> 标签：python

```
def findLongRepeats(strToSearch):
"""Search strTosearch to find the first location of longest repeated string 
of a single digit e.g '1111'. Do this for each digit from 0 to 9"""
numbers = ['0','1','2','3','4','5','6','7','8','9']
for number in numbers: #reads a number line one at time
    number_count = 0 #sets the count to 0
    number = int(number)
    longrepeats = []  #creates a new list
    for x in strToSearch: #reads each digit one by one
        if x == number: #if x is true it will add 1 to the number count
            number_count += 1
        if x != number: # if x is not flase it will add number count into the long repeat list
            longrepeats.append(number_count)
            number_count = 0
    print "Found", max(longrepeats), number+'\'s in a row at character position', strToSearch.index(number*max(longrepeats))

def main():
    """DocT"""
    File = open("pidigits.txt","rU") #opens file for reading
    Thousand_String = 0
    strLine =''
    for line in File: #reads each line
        line = line.strip()
        if '3.' in line:
            line = line.replace('3.','')
        Thousand_String += len(line)
        strLine += str(line)
        #print line
    #File.close()

    print
    print "Number of pi digits to process:",Thousand_String
    print
    findLongRepeats(strLine)
    print line
main() 
```

“当我运行 findLong Repeats 函数时 - 出现此错误：

```
File "PA5_.py", line 53, in main
    findLongRepeats(strLine)
  **File "PA5_.py", line 18, in findLongRepeats
    print "Found", max(longrepeats), number+'\'s in a row at character position', strToSearch.index(number*max(longrepeats))
TypeError: unsupported operand type(s) for +: 'int' and 'str' 
```

我无法弄清楚如何修复错误，请帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-09T01:44:14.693

您不能将字符串 ( `'\'s in a row at character position'`) 添加到数字`number`。将数字插入字符串的正确方法是使用[字符串格式](http://docs.python.org/library/string.html#formatstrings)而不是加法：

```
print "Found {0} {1}'s in a row at character position {3}".format(max(longrepeats), number, strToSearch.index(number * max(longrepeats))) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-05-10T10:27:57.757

正确的方法是使用上面提到的字符串格式，这里是文档：[http ://docs.python.org/library/string.html#formatstrings](http://docs.python.org/library/string.html#formatstrings)

解决这个问题的另一种简单方法是不使用“+”添加，而是独立打印以逗号分隔的 int 和 string 变量：

```
print "Found", max(longrepeats), number,'\'s in a row at character position', strToSearch.index(number*max(longrepeats)) 
```

# jquery-mobile - jQuery Mobile 和 Phonegap 页面更改事件问题

> ID：10067999
> 
> 赞同：0
> 
> 时间：2012-04-09T01:28:32.577
> 
> 标签：jquery-mobile, cordova

我正在开发一个使用 Phoengap、jQuery Mobile 和 Phonegap 的新 Facebook 插件[https://github.com/davejohnson/phonegap-plugin-facebook-connect](https://github.com/davejohnson/phonegap-plugin-facebook-connect)的移动应用程序。

第一页是统计内容和一个连接 Facebook 的按钮：

```
<a data-role="button" data-theme="b" href="#home-page" data-icon="facebook" id="fb_connect">
    Connect with Facebook
</a> 
```

我只提供对触摸设备的支持，所以代码是在点击时触发的：

```
 $('#fb_connect').live('tap',function(event) {
            FB.login(function(response) {
           if (response.authResponse) {
               console.log('login(): Logged in');
           } else {
               console.log('User cancelled login or did not fully authorize.');
           }
         }, {scope: 'email, user_likes, user_status, friends_status, user_checkins, friends_checkins'});

            $.mobile.changePage($('#map-page'), {transition: 'slideright', showLoadMsg: 'true'});

            return false;
        }); 
```

页面更改后，我想用显示附近 Facebook 地点的图钉的谷歌地图填充页面。我想动态地执行此操作，因此我需要使用页面事件并在页面加载后立即调用负责此操作的函数。唯一给出任何结果的事件是 JQM 的“pageshow”事件，但它仅在我以某种方式与页面交互（例如单击）后触发。

其他一切都按预期工作。关于我应该使用什么事件的任何想法？此外，当地图页面加载时，在点击之前，我仍然可以从按钮中看到“使用 Facebook 登录”文本，但页面上没有其他内容。由于我使用的是 Apache Cordova Facebook 插件，因此我无法在浏览器中进行真正的测试，因此我无法使用 Firebug 或 Chrome 检查...

谢谢，欢迎任何指点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-15T18:43:50.107

如果您需要更早的东西，您可以尝试使用`pageinit`而不是。`pageshow`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-12T09:57:28.420

`"pagecreate"`事件在初始化页面之前执行，所以我认为它应该可以工作。